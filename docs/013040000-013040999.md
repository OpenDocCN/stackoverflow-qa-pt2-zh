# StackOverflow 问答 13040000-13040999

# ios - NSParameterAssert 可以留在生产代码中吗？

> ID：13040001
> 
> 赞同：1
> 
> 时间：2012-10-23T21:59:49.423
> 
> 标签：ios, xcode, app-store, app-store-connect

带有 NSParameterAsserts 的代码会导致苹果拒绝你的应用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-27T06:45:58.040

> 如果定义了预处理器宏 NS_BLOCK_ASSERTIONS，则禁用断言。所有断言宏都返回 void。

`Release`它是在配置中默认定义的。所以留`NSParameterAsserts`在生产中是可以的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-13T15:10:41.037

NSParameterAsserts 默认不在发布模式下运行。我有过让代码在 NSParameterAsserts([obj method]) 中执行的糟糕经历，这导致应用程序在发布时崩溃并在调试模式下完美运行。

# sql-server - 每个月向sql server添加一些数据

> ID：13040002
> 
> 赞同：0
> 
> 时间：2012-10-23T21:59:53.380
> 
> 标签：sql-server, tsql

我希望每个月自动将数据插入表中。

例如有一张桌子`Cost`。如果本月没有新数据（例如在一个月的某天之前），则脚本应插入上个月的数据。我是说

```
 1234 1.10.1992
 1334 1.11.1992
 *no data 1.12 was added*
 1334 1.12.1992 
```

我决定使用 sql server 作业。我创建了一个工作

```
exec sp_add_job
     @job_name = 'Add land cost automatic' 
```

然后我创建了一个时间表并将其附加到工作中

```
use msdb;
go

exec sp_add_schedule
    @schedule_name = 'Add',
    @freq_type = 16,
    @freq_interval = 2,
    @freq_recurrence_factor = 1;
go

exec sp_attach_schedule
    @job_name = 'Add land cost automatic',
    @schedule_name = 'Add';
go 
```

但是如何添加作业步骤以及写什么作为命令？

# expressionengine - 在 ExpressionEngine 中使用存储、上下文和类别

> ID：13040006
> 
> 赞同：4
> 
> 时间：2012-10-23T22:00:19.100
> 
> 标签：expressionengine, categories, expressionengine-stash

我希望有一种方法可以将 Stash Context 与类别一起使用，例如，如下所示：

```
{exp:channel:entries channel="channel-name" dynamic="no" disable="member_data|pagination"}
    {exp:stash:append_list name='list' parse_tags="yes" save="yes" scope="site" context='{categories}{category_name}{/categories}'}
        {stash:this_title}{title}{/stash:this_title}
        {categories}
            {stash:this_category_name}
                {category_name}
            {/stash:this_category_name}
        {/categories}
    {/exp:stash:append_list}
{/exp:channel:entries}

{exp:stash:get_list name="list" parse_tags="yes" parse_conditionals="yes" context="{this_category_name}"}                   
    <div>
        all my stash variables and html etc.
    </div>
{/exp:stash:get_list} 
```

我知道我可以执行以下操作，这意味着每次添加类别时都必须有人编辑模板。

```
{exp:stash:get_list name="list" parse_tags="yes" parse_conditionals="yes" context="category1"}                  
    <div>
        all my stash variables and html etc.
    </div>
{/exp:stash:get_list}

{exp:stash:get_list name="list" parse_tags="yes" parse_conditionals="yes" context="category2"}                  
    <div>
        all my stash variables and html etc.
    </div>
{/exp:stash:get_list} 
```

话虽如此，我的问题是：无论如何动态使用 Stash 上下文和 ExpressionEngine 类别？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T23:10:16.873

您遇到的问题归结为 exp:channel:entries 循环运行多次迭代，然后使用 Stash 设置关联的值数组。一旦 channel:entries 竞争，你就有一个 {this_category_name} 变量数组，所以它实际上从来没有像常规变量那样设置。

所以你真的有几个选择：

1.  使用 URI 段，因为这些是早期解析的。
2.  使用 exp:stash:set 标记设置片段类型变量，该变量可以稍后在页面上解析。
3.  硬编码值

这是我的代码，我已经对其进行了测试，并且可以确认 100% 可以正常工作。1 警告，如果您的条目有多个类别，这将中断。我相信这将使用迭代中的第一个类别集。

注意，一定要使用 process="end" 参数来操作解析顺序，否则你会得到一个空白屏幕。

```
{exp:channel:entries channel="your-channel" dynamic="no" disable="member_data|pagination"}
    {exp:stash:append_list name='list' parse_tags="yes" save="yes" scope="site" context='{categories}{category_name}{/categories}'}
        {stash:this_title}{title}{/stash:this_title}
        {categories}
            {stash:this_category_name}
                {category_name}
            {/stash:this_category_name}

            {exp:stash:set name="test_var" type="snippet"}{category_name}{/exp:stash:set}
        {/categories}
    {/exp:stash:append_list}
{/exp:channel:entries}

{exp:stash:parse process="end"}

    {exp:stash:get_list name="list" parse_tags="yes" parse_conditionals="yes" context="{test_var}" process="end"}
        <div>
            all my stash variables and html etc.
        </div>
    {/exp:stash:get_list}

{/exp:stash:parse} 
```

我要补充一点，可能有更好的方法来解决您的问题。您尝试做的事情的逻辑并没有真正加起来。我只是试图回答你关于 Stash 的问题，以及它是否*可以*做到，而不是最好的方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-23T22:55:58.037

为什么需要使用上下文？我想我不清楚您如何尝试使用 get_list 来输出数据。[这样的事情会实现你需要做的吗？](http://devot-ee.com/add-ons/support/stash/viewthread/7518#25397)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T22:46:34.960

也许您需要将整个 append_list 标签包装在 {categories}{/categories} 中，而不是将其作为 stash 标签的参数运行？

也就是说，它也可能是解析顺序问题，因此您可能也需要 exp:stash:parse 在那里的某个地方。

# php - 从 PHP 读取服务器端 JavaScript

> ID：13040007
> 
> 赞同：1
> 
> 时间：2012-10-23T22:00:26.227
> 
> 标签：php, javascript

我有一个*服务器端*JavaScript 使用的变量（标题字符串）的 JS 库文件。我可以从 PHP 中读取/解释它吗？

数据的路径不是问题，而是 PHP 是否可以读取/使用 JS 变量。目前，我在 JS 文件和 PHP 文件中都存储了相同的变量，其中包含明显的不同步更改范围。我已经尝试从*服务器端*JS 读取 PHP，但我想知道是否 - 通过适当的解析 - PHP 是否可以提取/使用 JS 变量。

我再说一遍，*所有*涉及的数据都是同一服务器上的服务器*端*。抱歉，如果我之前错过了这个回答，但是 PHP/JS 问题（即使标题错误）似乎都是关于在客户端和服务器端进程之间传递数据的——这不是我的场景。

稍后 - 澄清：

s/s JavaScript 是图像数据库 Web 界面的一部分，我无法在其中更改 API。它不支持创建电子邮件（用于文件请求），因此我必须通过 PHP 来完成。工作范围/预算排除了重新编写新的 d/b 界面，而是我们“只需要”能够发送电子邮件。IOW，我意识到如果从头开始，您不会选择尝试这样做！另外，我不认为我可以做 s/side AJAX 来获取变量或做 PHP smtp 邮件，因为 JS 环境似乎不是为那种程度的 s/s 处理预 HTML 页面交付而设计的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:01:53.143

PHP 可以通过[V8js 库与 JavaScript 交互](http://php.net/manual/en/book.v8js.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:07:42.263

听起来您在 JS 代码中有配置值（即标题）。

如果您想保持这种方式，我的建议是将配置本身拆分为一个离散的 .JS 文件，该文件仅包含变量定义，但不包含实际的 JS 代码。

然后你应该能够简单地在 PHP 中使用`json_decode()`. 任务完成。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T22:07:47.083

取决于格式。如果您的文件接近 JSON 并且可以公开访问（或至少在与 PHP 相同的服务器上），您可以执行以下操作：

文件`test.js`：

```
var data = {
    'Hello': 'L-ghodwa it-tajba',
    'Bye':   'Caw',
} 
```

文件`reader.php`：

```
<?php

    $data = file_get_contents('test.js'); // or http://url.to/test.js
    $data = str_replace('var data = ', '', $data);
    $data = json_decode($data);
    print_r($data);

?> 
```

该系统也非常有效；它是关于稍微操作一个字符串并将其解析为 JSON，而不是拥有一个成熟的 JS 解析器。但是，您必须强制执行 js 文件的格式。

**编辑：**是的，好吧，Spudley 似乎比我的领先几秒钟。基本上，我正在按照他的建议去做。

**编辑 2：** 我一直在想，您可以简单地使用 JSON 文件。这些*必须*包含 JSON，因此格式已经存在；并且您可以通过 JS 和 PHP 使用相同的文件，而不会出现问题或事后诸葛亮。顺便说一下， JSON 文件以`.json`扩展名结尾。您可能需要使用 (Apache/htaccess) 告诉您的网络服务器 mimetype json 是什么：

```
AddType application/json .json 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-23T22:09:22.747

我想客户端/服务器案例中的大多数答案都涉及 JSON。是什么阻止您使用相同的方法，尽管 js 脚本在服务器上运行？

您可以将这些变量存储在 JSON 文件中，并让 JS 脚本和 PHP 脚本加载它们。当然，您的 PHP 安装必须首先支持 JSON。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-23T22:30:41.360

如果您尝试在 PHP 中解析 JS 文件，您应该使用非常复杂的正则表达式，或者您应该创建一个 API，允许 JS 脚本（例如在 Node 中）和 PHP 之间进行通信。

问题是，为什么您需要以这种方式执行此操作？为什么不能以 JS 和 PHP 都可以使用的格式共享数据？例如，JSON。

# ruby-on-rails - 如何使用 Capistrano 获取远程宝石路径？

> ID：13040010
> 
> 赞同：1
> 
> 时间：2012-10-23T22:00:46.460
> 
> 标签：ruby-on-rails, gem, capistrano, remote-debugging

嗨，我想用 capistrano 在远程机器上获取 gem 的路径。

我有以下内容：

```
namespace :stanford do

  desc "Copy language assets"
  task :copy, :roles => :app  do
    puts Gem::Specification.find_by_name("ruby-opencv").gem_dir   
  end
end 
```

这将返回我本地机器上 gem 的路径..

我尝试通过 capistrano 的运行（运行“#{Gem::Specification.find_by_name("ruby-opencv").gem_dir}"）但效果相同。

有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-14T14:03:32.760

使用`capture`命令从远程机器获取结果。如果你的项目使用捆绑器，试试这个（仅在 Capistrano 3 上测试过）：

```
namespace :stanford do

  desc "Copy language assets"
  task :copy, :roles => :app  do
    puts capture(:bundle, 'show', 'ruby-opencv')   
  end
end 
```

如果不使用捆绑器，以下可能会起作用：

```
namespace :stanford do

  desc "Copy language assets"
  task :copy, :roles => :app  do
    puts capture(%(ruby -e "puts Gem::Specification.find_by_name('ruby-opencv').gem_dir"))
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T00:17:33.390

尝试这个：

```
namespace :stanford do
  desc "Copy language assets"
  task :copy, :roles => :app  do
    run %(ruby -e "puts Gem::Specification.find_by_name('ruby-opencv').gem_dir")
  end
end 
```

还有一种方法是直接通过gem shell命令：

```
gem contents ruby-opencv |head -1 |sed 's,/*[^/]\+/*$,,' 
```

但这可能不是 100% 可靠的。

# ios6 - 我在 iOS6 中的 MFMailComposeViewController 不再工作

> ID：13040017
> 
> 赞同：4
> 
> 时间：2012-10-23T22:01:26.047
> 
> 标签：ios6, mfmailcomposeviewcontroller

注意到我用来模态弹出对话框以发送电子邮件的 MFMailComposeViewController 在 iOS6 中不再有效。它仍然会弹出对话框，但我无法设置正文，或在视图中输入任何内容。我所能做的就是按取消。

该类实现了 MFMailComposeViewControllerDelegate 接口，下面是一些代码：

```
//h file
@interface ASEmailSender : NSObject

//m file
@implementation MyEmailSender () <MFMailComposeViewControllerDelegate>
@end

@implementation MyEmailSender
...

- (void)emailFile:(ASFile *)file inController:(UIViewController *)viewController {
    MFMailComposeViewController *mailController = [[MFMailComposeViewController alloc] init];
    if ([MFMailComposeViewController canSendMail]) {
        mailController.mailComposeDelegate = self;
        [mailController setSubject:@"my subject"];
        [mailController setMessageBody:@"msg body here" isHTML:NO];

        [viewController showIsLoading:YES];
        self.viewController = viewController
        [viewController presentModalViewController:mailController animated:YES];
    }   
}

- (void)mailComposeController:(MFMailComposeViewController *)controller didFinishWithResult:(MFMailComposeResult)result error:(NSError *)error {
    [self.viewController dismissModalViewControllerAnimated:YES];
} 
```

它在 iOS5 中运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T15:31:19.617

我通过将 MyEmailSender 更改为 UIViewController 而不是 NSObject 来解决此问题。出于某种原因，这解决了在 iOS6 中运行时的问题。新代码如下所示：

```
//h file
@interface ASEmailSender : UIViewController <MFMailComposeViewControllerDelegate>

//m file
@implementation MyEmailSender
...
(same functions as before) 
```

现在它适用于 iOS5 和 iOS6。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T15:39:48.037

我修复了完全相同的问题（在 iOS6 中：空白作曲家屏幕，只有取消按钮有效。而在 iOS5 中，相同的代码可以正常工作。）

我确实导入了：

```
#import <MessageUI/MFMailComposeViewController.h> 
```

但我忘记了这一点：

```
#import <MessageUI/MessageUI.h> 
```

添加 MessageUI.h 的导入后，iOS 6 上不再出现问题。

# c++ - 带有 try catch 和异常抛出的方法

> ID：13040018
> 
> 赞同：0
> 
> 时间：2012-10-23T22:01:25.923
> 
> 标签：c++, loops, types, try-catch

所以我有以下方法：

```
template <class DT> //needs testing
DT& LinkedSortedArrays<DT>::find (const DT& key)
{
    list<SortedArray<DT>>::iterator it = SAList.begin();
    for( ; it != SAList.end(); ++it){
        try{
            if (it == SAList.begin() && key < (*it)[0]) throw Exception();
            return (*it).find(const_cast<DT&> (key));
        } catch (ArrayException e) {

        }
    }
    throw Exception();
} 
```

我之前已经定义了类`Exception`和`ArrayException`. 每次在当前搜索的特定 Array 类中找不到时`(*it).find(const_cast<DT&> (key))`都会抛出 ArrayException 。是一个。代码编译得很好。但是我还没有在我的程序中尝试过。为什么？我需要有人根据我所做的以下假设来确认或更正我：`key``SAList``STL List`

1.  每当`if (it == SAList.begin() && key < (*it)[0]) throw Exception();`抛出异常，就意味着它会抛出for循环之外，甚至是方法之外，对吧？
2.  我几乎可以肯定最后一行`throw Exception();`会在方法之外抛出异常。
3.  for循环的排列方式，不会跳过SAList的第一个元素吧？我的意思是，我在整个互联网上都看到了这个特定的代码，它用于迭代列表的所有元素，就好像它是标准的或完美的一样，但是……这让`++it`我的大脑有些扭曲。帮助？
4.  我收到一个错误`can't convert const int to int&`（因为`find()`in`(*it).find(const_cast<DT&> (key))`不是属于的`LinkedSortedArrays`那个，而是另一个需要 DT& 变量并且`LinkedSortedArrays`'s`find()`具有 const DT& 类型的参数的错误），我发现一个可能的解决方案可能是将它写为`const_cast<DT&> (key)`. 我需要对此发表第二意见。

最后，我了解这是否不是一个具体问题，因此我会被否决和/或问题被关闭。我真的不知道还能去哪里问。如果是我在错误的地方问的情况。我很抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:07:05.797

1.  是的，它将向上堆栈，直到找到合适的`catch`处理程序。如果它没有找到这样的处理程序，程序将终止。

2.  是的，它会。

3.  不，它不会，因为`end`应该将迭代器返回到末尾，而不是最后一个元素。除非该容器的设计也很糟糕，但您必须查阅文档以确定。

4.  那是一个糟糕的设计，`find`应该通过`const`引用来获取它的参数。既然你不能，除非你想冒未定义的行为风险，否则你必须制作一个副本：

    ```
    DT nonconstkey = key;
    return it->find(nonconstkey); 
    ```

# sql-server - 将引用的csv数据导入sql server

> ID：13040019
> 
> 赞同：1
> 
> 时间：2012-10-23T22:01:29.283
> 
> 标签：sql-server, import

我有一个 CSV 文件中的数据，如下所示：

```
"2745","00","8824","02/15/99","-850.00","-144.20","0.00","0.00","0.00","0.00","-994.20","0.00","" 
```

我正在尝试使用 SSMS 的导入向导将其导入 SQL Server 中的表中，但我认为我遇到了转换错误。

例如，第 2 列（第三列）在表格中设置为数字，第 3 列设置为日期，导入向导抱怨在转换中丢失数据。我可以理解它正在尝试从字符串转换为数字或字符串到日期，但是我如何告诉它转换数据？导入向导可以吗？

如果没有，推荐的方法是什么？让它导入到自己的表中，然后将数据复制到目标表中，在复制期间进行转换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:10:51.823

如果您使用的是平面文件源，则可以通过选择`Advanced`然后指定每列的类型来选择传入列的数据类型。

![在此处输入图像描述](../Images/ab204ac808982b5f893ba50abf723873.png)

# c - mkfifo() 错误--->“创建命名管道时出错。：文件存在”

> ID：13040021
> 
> 赞同：7
> 
> 时间：2012-10-23T22:01:53.693
> 
> 标签：c, systems-programming, mkfifo

mkfifo 函数有 2 个参数，路径和模式。但我不知道它使用的路径格式是什么。我正在编写一个小程序来创建命名管道并作为`mkfifo`. 使用`/home/username/Documents`例如，但它总是返回 -1 和 message `Error creating the named pipe.: File exists`。

我检查了这个目录很多次，里面没有管道。所以我想知道是什么问题。我在 mkfifo 中使用的模式是 0666 或 0777。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-23T22:07:01.410

您给出[`mkfifo()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/mkfifo.html)了*现有*目录的名称，因此出现了错误。您必须给它一个不存在的文件的名称，例如

```
mkfifo("/home/username/Documents/myfifo", 0600); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T22:08:21.727

'path' 参数`mkfifo()`必须指定完整路径、目录和文件名。

因此，它将是：

```
char *myfifo="/home/username/Documents/mypipe";

mkfifo(myfifo, 0777); 
```

作为旁注，您应该避免使用八进制权限位并改用命名常量（来自`sys/stat.h`），所以：

```
mkfifo(myfifo, S_IRWXU | S_IRWXG | S_IRWXO); 
```

# javascript - 如何在JS中将事件分配给变量

> ID：13040025
> 
> 赞同：1
> 
> 时间：2012-10-23T22:02:17.017
> 
> 标签：javascript

您好，我有一个关于 JS 事件的非常基本的问题。

我可以做类似的事情：

```
var myobj = { };
document.getElementById("myid").onmousemove = function (e) {
  myobj.e = e;
}

...

// called from function which will occure after onmousemove guaranteed
document.getElementById("info").innerHTML = myobj.e.type; 
```

我的游戏需要这个。我想保存事件数据并稍后在我的游戏循环的更新功能中发送它。

好的。这是jsfiddle。

```
<p id="info"></p><canvas id="can" width="400px" height="400px" style="border: 2px solid red"></canvas>

var my = { };
document.getElementById("can").onclick = function(e, custom) {
    my.e = e;
}
document.getElementById("can").onmouseover = function(e, custom) {
    my.e = e;
}
document.getElementById("can").onmouseout = function(e, custom) {
    my.e = e;
}
document.getElementById("can").oncontextmenu = function(e, custom) {
    my.e = e;
}
document.getElementById("info").innerHTML = my.e.type; 
```

[http://jsfiddle.net/cMPSS/3/](http://jsfiddle.net/cMPSS/3/)

它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:06:14.000

啊哈，您的编辑使事情变得更加清晰。这是您应该使用的：

```
<p id="info"></p><canvas id="can" width="400px" height="400px" style="border: 2px solid red"></canvas>

var can = document.getElementById('can'), info = document.getElementById('info');
function eventHandler(e) {
    info.innerHTML = e.type;
}
can.onclick = can.onmouseover = can.onmouseout = can.oncontextmenu = eventHandler; 
```

基本上，您在事件处理程序中进行分配`myobj.e`，但在事件处理程序之外使用它。`myobj.e`将`undefined`一直持续到事件触发。您想要的只是在事件回调中执行*所有*与事件相关的功能。

您可能想了解一些关于异步编程的知识。事件异步触发——您不知道用户何时会移动鼠标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T22:11:44.920

是的，你可以做这样的事情

```
var myEvents = [];
var myDiv = document.getElementById("myDiv");
var infoDiv = document.getElementById("info");

function logEvent(e)
{
    e.preventDefault(); // prevent default behaviour if needed
    myEvents.push(e); // Store event info
}

myDiv.onmousemove = myDiv.onmousedown = myDiv.onmouseup = logEvent; 

// Set a timer for looping through the events
gameTimer = setInterval(function() {
    // Loop through events
    while (myEvents.length>0)
    {
        ev = myEvents.shift();
        // Display event info
        infoDiv.innerHTML = ev.type + " " + infoDiv.innerHTML; 
    }
}, 100)​
​ 
```

[演示](http://jsfiddle.net/q97hh/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:06:24.470

当导致其分派的因素发生时，该事件将被异步分派。您需要在事件处理程序中更新 DOM (HTML)。

```
var myobj = {};

document.getElementById('myid').onmousemove = function (e) {
  document.getElementById('info').innerHTML = e.type;

  myobj.e = e; // not sure if you need this, not required for the update
}; 
```

**更新：**

我看到你听各种各样的事件。为了保持你的代码干燥（不要重复自己），创建一个更新“信息”元素的函数，并将其用作所有事件的处理程序。

```
var updateInfo = function (e) {
  document.getElementById('info').innerHTML = e.type;
};

var target = document.getElementById('can');
target.onmouseover = updateInfo;
target.onmousemove = updateInfo;
target.onmouseout = updateInfo;
// ... 
```

# php - 使用 JQuery 加载动态生成的表单字段

> ID：13040028
> 
> 赞同：-1
> 
> 时间：2012-10-23T22:02:41.780
> 
> 标签：php, jquery, json, forms

我正在使用 PHP 在表单中动态生成一些字段（这里是带有完整代码的 jsFiddle [http://jsfiddle.net/KBYC5/1/](http://jsfiddle.net/KBYC5/1/)）。

```
<?php 
            $contacts= array('CONTRACT MANAGER', 'MEDICAL DIRECTOR', 'UTILIZATION MANAGER', 'QUALITY IMPROVMENT MANAGER ', 'CHIEF MEDICAL DIRECTOR', 'CMO', 'AUTHORIZATION MANAGER', 'CUSTOMER SERVICE MANAGER');
            foreach ($contacts as $contact) //TODO add something to check if contact already exists and don't show checkbox if it does
            {
                echo "<li>
                        <label>" . ucwords(strtolower($contact)) . "</label>" . inp_return('contact[]', 45) . " <input type='hidden' value='$contact' name='title' /> 
                        <ul>
                            <li><label> Rating: </label>" .  inp_return('rating[]',3) . "</li>
                            <li><label>Phone: </label>" . inp_return('contact_phone[]',13, 'phone'). "</li>
                            <li><label>Ext: </label>" . inp_return('ext[]', 8) . "</li>
                            <li><label>Create Referral Contact</label> " . cbox_return('create_contact[]') . "</li> 
                        </ul>
                        <div class='clear'></div>
                    </li>
                ";
            }
        ?> 
```

如您所见，每个都有一个隐藏的输入，其值来自 $contacts。然后我要做的是使用 jQuery 检查隐藏输入字段中的值，将其与 JSON 对象的“标题”属性进行比较，然后，如果它们相同，则填写所有表单值. 我的脚本部分在这里：

```
<script type='text/javascript'>
var contacts = $.parseJSON('[{"id":1,"name":"TEST CONTACT","title":"CONTRACT MANAGER","rating":5,"phone":"(000)000-0000","ext":"1111","rfcode":"0000"},
{"id":2,"name":"TEST2 CONTACT","title":"MEDICAL DIRECTOR","rating":2,"phone":"(111)111-1111","ext":"2222","rfcode":"0000"}]');
$(document).ready(function () {$("#contracting_info ul li").each(function (){
    for (var i in contacts)
        {
            alert($(this).children("input[name='title']").val()); die;
            var title = contacts[i].title
            if (title == $(this).children("input[name='title']").val())
                alert('made it here');
        }
    });
}); 
```

如何使用 JSON 数组中的值加载每个列表项中的 contact[] 元素（其中标题与隐藏的标题元素匹配）？例如，我希望 Contract Manager 的 contact[] 字段中包含 TEST CONTACT。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:00:45.957

这是解决我的问题的脚本部分。

```
<script type='text/javascript'>
var contacts = $.parseJSON('<?php echo json_encode(sql::results("SELECT * FROM crm.dbo.managed_care_contacts where rfcode =" . hexstr($referral->get_id())));?>');
$(document).ready(function () {

    $("#contracting_info li").each(function (){
        for (var i in contacts)
        {
            alert(contacts[i].title + ' ' + $(this).children("input[name='title']").val());
            var title = contacts[i].title
            if (title == $(this).children("input[name='title']").val())
                {
                        $(this).children("input[name='contact[]']").val(contacts[i].name);
                        $(this).find("input[name='contact_phone[]']").val(contacts[i].phone);
                        $(this).find("input[name='ext[]']").val(contacts[i].ext);
                        $(this).find("input[name='rating[]']").val(contacts[i].rating);

                }
        }
    });//close .each (for autofilling form
});

</script> 
```

不幸的是，这意味着我必须遍历每个列表项元素，然后遍历所有联系人（所以我最终会遍历每个 li 的联系人）。它虽然工作正常。

希望这可以帮助其他试图用来自 json 对象（表单字段发布到数组）的信息动态填充表单字段的人。

# html - 表单布局的 HTML 列或行？

> ID：13040031
> 
> 赞同：4
> 
> 时间：2012-10-23T22:02:55.070
> 
> 标签：html, css, forms, formatting

我正在构建一堆具有标签和相应字段（输入元素或更复杂的元素）的表单。

标签在左边，字段在右边。给定表单中的标签都应具有特定宽度，以便字段全部垂直排列。

有两种方法（也许更多？）来实现这一点：

1.  ***Rows***：向左浮动每个标签和每个字段。将每个标签和字段放在字段行 div/容器中。将标签宽度设置为某个特定数字。使用这种方法，不同表单上的标签将具有不同的宽度，因为它们将取决于最长标签中文本的宽度。

2.  ***Columns***：将所有标签放在一个向左浮动的 div/容器中，将所有字段放在另一个带有 padding-left 设置的浮动左侧容器中。这样标签甚至标签容器都不需要设置它们的宽度，因为列布局和 padding-left 将统一处理垂直排列所有字段。

所以方法＃2似乎更容易实现（因为不需要一直设置宽度），但我认为它也不太面向对象，因为标签和与该标签一起的字段没有组合在一起，因为他们在方法#1中。此外，如果动态构建表单，方法#2 不适用于类似的函数`addRow(label, field)`，因为它必须知道标签和字段容器，而不仅仅是创建/添加一个字段行元素。

您认为哪种方法更好？还有比这两个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T22:52:19.300

方法 #1 的效果要好得多，原因有很多，主要涉及灵活性和 Kevin Boucher 提到的其他观点，以及您自己关于动态创建的观点。

我不建议不要包含元素——即使它很有可能——你否认自己在填充、定位和溢出处理方面有很多额外的能力。它还使动态创建更加棘手。

考虑到您可以通过类为 CSS 中的标签容器设置一个宽度，您使用方法 #2 的论点也不一定有好处，这可以轻松更改或设计为响应式。基本上意味着您只有一个地方可以再次更改标签尺寸。

同样使用＃2，虽然使您的水平标签布局更加自动化 - 考虑到您必须为标签和字段容器提供相同的高度才能对齐，垂直布局将变得更加手动和棘手*（因为它们不能依赖共同父母）*。我猜你会有比列更多的行，所以这只会增加工作；）

CSS：

```
.field-row {
  overflow: hidden;
}

.field-row label {
  display: block;
  width: 30%;
  float: left;
}

.field-row .field-container {
  width: 70%;
  float: left;
} 
```

标记：

```
<div class="field-row">
  <label>Label Text</label>
  <div class="field-container">
    <input type="text" />
  </div>
</div> 
```

我自己可能会选择上述内容，因为这将涵盖我曾经需要的大部分内容，但是如果您想要对应用程序中可能发生的未来更改进行更多控制，您可以执行以下操作：

CSS 2：

```
.field-row {
  overflow: hidden;
}

.field-row .label-container {
  width: 30%;
  float: left;
}

.field-row .field-container {
  width: 70%;
  float: left;
} 
```

标记2：

```
<div class="field-row">
  <div class="label-container"><label>Label Text</label></div>
  <div class="field-container">
    <input type="text" />
  </div>
</div> 
```

只需添加一个额外的包装器，您就可以使用更复杂的标签*（即隐藏文本并用图像替换，或使用 js 添加解释性文本）* - 您还可以在居中或右对齐方面给予自己更多的控制权。

无论如何只是我的想法:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T22:25:06.583

两者都不。用 CSS 来做 - 不需要包含 div。例如：

```
<style>
  form { width: 28em; margin: 5px; padding: 5px; border: solid #000 1px; }
  label { width: 6em; float: left; text-align: right; margin: .5em 1em; clear: both; border: dashed #666 1px; }
  input, textarea { margin: .5em 0; width: 17em; }
</style>

<form>
  <label for="first">First Name:</label>
  <input type="text" name="first_name" id="first" size="20" maxlength="50" />
  <label for="last">Last:</label>
  <input type="text" name="last_name" id="last" size="20" maxlength="50" />
</form> 
```

[http://jsfiddle.net/k4xEG/](http://jsfiddle.net/k4xEG/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:36:43.790

***仅使用 div 的行***方法。jsFiddle在这里：http: [//jsfiddle.net/v7R8j/1/](http://jsfiddle.net/v7R8j/1/)

**HTML：**

```
<form>
<div class="label">Type text:</div>
<div class="field"><input type="text"/></div>
<div class="clear"></div>

<!-- ... -->

<div class="label">Submit button:</div>
<div class="field"><input type="submit"/></div>
<div class="clear"></div>
</form> 
```

**CSS：**

```
.label {
    width: 150px;
}
.field, .label {
    float: left;
    border: 1px solid orange;   
    padding: 4px;
    margin: 4px;
}

.clear {
    clear:both;   
} 
```

# templates - Magento 新页面模板

> ID：13040034
> 
> 赞同：1
> 
> 时间：2012-10-23T22:03:13.563
> 
> 标签：templates, magento

我正在尝试添加一个新模板，以便可以并排放置两个内容块。例如：content_left 和 content_right。问题是新字段是空的，我无法在其中显示任何内容。目标是同时登录和创建帐户，每个都有自己的块。

这是新模板 2columns.phtml（修剪了一些）：

```
<?php echo $this->getChildHtml('head') ?>
</head>
<body<?php echo $this->getBodyClass()?' class="'.$this->getBodyClass().'"':'' ?>>
<?php echo $this->getChildHtml('after_body_start') ?>
<div class="wrapper">
    <?php echo $this->getChildHtml('global_notices') ?>
    <div class="page">
        <?php echo $this->getChildHtml('header') ?>
        <div class="main-container col2-right-layout">
            <div class="main">
                <?php echo $this->getChildHtml('breadcrumbs') ?>
                <div class="col-main1">
                    <?php echo $this->getChildHtml('global_messages') ?>
                    <?php echo $this->getChildHtml('content_left') ?>
                </div>
                <div class="col-main2"><?php echo $this->getChildHtml('content_right') ?></div>
            </div>
        </div>
        <?php echo $this->getChildHtml('footer') ?>
        <?php echo $this->getChildHtml('before_body_end') ?>
    </div>
</div>
<?php echo $this->getAbsoluteFooter() ?> 
```

这是我尝试使用的 XML：

```
<customer_account_login translate="label">
        <label>Customer Account Login Form</label>
        <!-- Mage_Customer -->
        <remove name="right"/>
        <remove name="left"/>

        <reference name="root">
            <action method="setTemplate"><template>page/2columns.phtml</template></action>
       </reference>
        <reference name="content_left">
            <block type="customer/form_register" name="customer_form_register" template="customer/form/register.phtml">
                <block type="page/html_wrapper" name="customer.form.register.fields.before" as="form_fields_before" translate="label">
                    <label>Form Fields Before</label>
                </block>
            </block>
       </reference>
        <reference name="content_right">
            <block type="customer/form_login" name="customer_form_login" template="customer/form/login.phtml" />
        </reference>
    </customer_account_login> 
```

除了 content_left 和 content_right 之外，一切似乎都正常。不幸的是，这需要展示所有重要的东西。我尝试更新 CSS，并在模块中定义了它。问题是使用“content_left/right”而不是“content”和其他已经使用过的东西吗？请帮忙，我整天都在这个页面上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T00:35:29.753

您需要做几件事：

1.  创建**content_left**和**content_right**块而不是引用它们。它们实际上并不存在于布局文件中的任何位置，这就是引用它们不起作用的原因。这需要在您向它们添加其他块之前完成。
2.  确保在正确的位置创建创建的**content_left**和**content_right**块。通过简单地更改对块的引用，您将在与根块相同的级别创建它们......如果它们被放置在这里，它们将不会呈现。所以你需要将它们添加到根块中。

这是我能够开始工作的布局：

```
<customer_account_login translate="label">
    <label>Customer Account Login Form</label>
    <!-- Mage_Customer -->
    <remove name="right"/>
    <remove name="left"/>

    <reference name="root">
        <action method="setTemplate"><template>page/2column-contact.phtml</template></action>

        <block type="core/text_list" name="content_left" as="content_left" translate="label">
            <block type="customer/form_register" name="customer_form_register" template="customer/form/register.phtml">
                <block type="page/html_wrapper" name="customer.form.register.fields.before" as="form_fields_before" translate="label">
                    <label>Form Fields Before</label>
                </block>
            </block>
        </block>

        <block type="core/text_list" name="content_right" as="content_right" translate="label">
            <block type="customer/form_login" name="customer_form_login" template="customer/form/login.phtml" />
        </block>
    </reference>
</customer_account_login> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T00:11:34.567

您遇到此问题的原因是因为您需要添加“**块**”而不是“**参考**”。

**堵塞**

这附在每个模板上，为它提供了完成工作所需的功能。

**参考**

这是一种将块（或其他规则）附加到特定页面的方法（例如，将特殊块添加到产品视图页面）。

要解决此问题，请替换此行：

```
<reference name="content_left"> 
```

和：

```
<block type="catalog/product" template="path/to/your/template.phtml"> 
```

如果在手边，您的意图是将所有内容放在一列中 - （即您希望将“customer_form_register”和“customer.form.register.fields.before”输出到一列，并将“customer_form_login”输出到到另一列）

然后执行以下操作：

1) 删除您添加的 2 'references>。

2）在 phtml 文件中创建一个 div（对于您想要的每个部分）。

3) 在这些 div 中回显块名称（即 customer_form_login）并添加必要的 CSS 规则。

# c - 制作变量参数列表函数

> ID：13040037
> 
> 赞同：1
> 
> 时间：2012-10-23T22:03:59.507
> 
> 标签：c

我在 C 中制作了一个简单的变量参数列表函数。但它不起作用。当我用一个参数调用该函数，然后在该函数中检查该参数时，该参数丢失了它的值。例如，在下面的代码中，当我检查“格式”的值时，它始终保持为 NULL。即，它始终显示“格式为 NULL”。在调试消息中。请指导我，这个原因的可能性是什么。

```
Calling the function:    lcdPrintf( "Change" );

int lcdPrintf( char * format, ... ) 
{
    if ( *format ) {
        printf("format is not NULL.\r\n");
    }
    else {
        printf("format is NULL.\r\n");
    }

     return -1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:08:03.747

使用 时，您正在测试 format 指向的第一个字符的值`if ( *format )`，`if ( format )`如果要检查指针的有效性，请使用。但是通过你写的电话，它应该无论如何都可以工作。

变量参数的使用需要`stdarg.h`和宏的使用`va_start`，`va_arg`并`va_end`使用它。

变量参数处理需要知道你使用的每个参数的类型。这就是格式字符串在 printf 中有用的地方。你们每个人的参数都有某种类型（`%s`是 a `char *`，`%d`是整数），它有助于`va_arg`宏知道它必须读取多少字节才能获得下一个参数值。

下面是一个简单的使用 va_args 的例子

```
#include <stdarg.h>

void printIntegers(int count, ...)
{
    va_list ap;
    int i;

    va_start(ap, count);
    for (i = 0; i < count; i++) {
        int v = va_arg(ap, int);

        printf("%d\n", v);
    }
    va_end(ap);                      
}

int main()
{
    printIntegers(2, 12, 42);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:09:17.933

我已经使用下面的代码测试了你的函数，它似乎可以工作。问题是否可能源于代码中的其他地方？

```
#include <stdio.h>

int lcdPrintf( char * format, ... ) 
{
    if ( *format ) {
        printf("format is not NULL.\r\n");
    }
    else {
        printf("format is NULL.\r\n");
    }   
    return 1;
}

int main(){ 
    lcdPrintf("Test"); // Prints "format is not NULL."  
    return (0);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:11:20.087

> 请指导我，这个原因的可能性是什么。

您的代码包含一个错误，这使您检查格式字符串的第一个字符，在本例中为“C”（表示“更改”）。

因此，有*一种*可能性：您传递的格式字符串的第一个字符为零，即它是空的。

```
#include <stdio.h>

int lcdPrintf( char * format, ... )
{
    /* if you want to check whether format is null, the test ought to be */
    /* if (format) ..., not if (*format) ... */

    if ( *format ) {
        printf("format is not NULL.\r\n");
    }
    else {
        printf("format is NULL.\r\n");
    }
    return 0;
}

int main(void)
{
        lcdPrintf("");
        return 0;
} 
```

这将返回“格式为 NULL”。*如果*您按照指定的方式调用该代码，我看不到其他方法（如果没有，所有赌注都将关闭:-)）

# performance - MKMapView iOS6 - 滚动和缩放时出错且缓慢

> ID：13040044
> 
> 赞同：2
> 
> 时间：2012-10-23T22:04:16.433
> 
> 标签：performance, ipad, ios6, mkmapview

使用 iOS5 MKMapView（谷歌地图），我可以在任何设备上很好地缩放和滚动。现在使用 iOS6 MKMapView（苹果地图），当我开始滚动应用程序时，每次都会挂起。这在 iOS5 下运行良好

问题 - 与谷歌地图相比，苹果地图的新内存占用是 15 倍 - 如果您滚动足够多（20 秒），MKMapView 在我的 ipad2 上全屏无响应 - 注释开始跳来跳去，并且开始变得无响应

有没有人在 ipad2 上有一个很好的工作示例，带有全屏 MKMapView，可以让您滚动和缩放而不会崩溃？

谢谢

# python - 使用 Python 抓取新闻网站

> ID：13040048
> 
> 赞同：2
> 
> 时间：2012-10-23T22:04:35.570
> 
> 标签：python, json, reddit

我对 Python 非常陌生，阅读了大约一半的 Python3 初学者书籍。我认为这样做会让我开始学习我真正想做的事情，而不是通过一些“无聊”的练习。

我想构建一个应用程序，它会从 Reddit 中获取顶级 URL，然后将它们发布到我自己的页面上。它每天只会检查几次，所以这里根本没有锤击。

我想将 Reddit json (http://www.reddit.com/.json) 和其他 subreddit json 解析为 URL，我可以将它们组织到我自己的顶部列表中，并且在我的页面上也有我自己的类别，所以我不不必继续访问 Reddit。

该网站将是一个 Wordpress 模板，其数据库托管在它自己的服务器 (mysql) 上。我将在 AWS 上使用 RDS、ELB、Auto-scaling 和 EC2 实例在 Web 服务器上托管它。

我的问题是：

- 让 Python 抓取应用程序在它自己的服务器上运行是否有意义，然后将抓取的 URL 写入数据库？

-我听说拆分应用程序可能有意义，一个读，另一个写，这是怎么回事？

- Python 代码的流程会是什么样子？我可以摸索着写它，但我只是不完全确定它应该如何流动。

-还有什么我没有想到的，有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:35:50.013

> 让 Python scraper 应用程序在它自己的服务器上运行，然后将抓取的 URL 写入数据库是否有意义？

是的，这是个好主意。我会设置一个 cron 作业来经常运行该程序。根据您期望的负载，它不一定需要在自己的服务器上。我会把它作为自己的应用程序。

> 我听说拆分应用程序可能有意义，一个读，另一个写，这是怎么回事？

我假设说这句话的人意味着你应该有一个应用程序来写入你的数据库（你的 python 脚本）和一个应用程序来从数据库中读取 URL（你的 WordPress 包装器，或者可能是另一个 Python 脚本来编写 WordPress 可以理解的东西）。

> Python 代码的流程会是什么样子？我可以摸索着写它，但我只是不完全确定它应该如何流动。

这在程序员之间有点宗教问题。但是我觉得你的程序应该足够简单。如果条目尚不存在，我将简单地获取 JSON 并有一个插入数据库的查询。

> 还有什么我没有想到的，任何提示？

我个人会为 Python 脚本使用 urllib2 和 MySQLdb 模块。祝你好运！

# applescript - 在Applescript中将数字转换为等效的字母字符

> ID：13040049
> 
> 赞同：0
> 
> 时间：2012-10-23T22:04:36.387
> 
> 标签：applescript

如何将数字转换为等效字母？像这样？

```
0 => a
1 => b
2 => c
3 => d 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:59:07.780

这不需要查找列表...

```
set aNum to 0
set theChar to character id (aNum + 97) 
```

如果你也对大写字母感兴趣，这样的事情会......

```
set aNum to 0
set lowerCaseNum to 97
set upperCaseNum to 65

set lowercaseChar to character id (aNum + lowerCaseNum)
set uppercaseChar to character id (aNum + upperCaseNum)
return {lowercaseChar, uppercaseChar} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:07:45.310

尝试：

```
property letters : "abcdefghijklmnopqrstuvwxyz"

set myNumber to 0
return text (myNumber + 1) of letters
-- returns a 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-07-14T09:02:11.603

```
on coerceNumToTime(theNum)
    set x to date ("0" as string)
    set hours of x to theNum div hours
    set minutes of x to theNum mod hours div minutes
    set seconds of x to theNum mod hours mod minutes
    return time string of x
end coerceNumToTime

set myNumber to 28
if myNumber < 26 then

    set lowerCaseNum to 97
    set upperCaseNum to 65
    set uppercaseChar to character id (myNumber + upperCaseNum)
else if myNumber > 27 then
    set myNumber to myNumber - 28

    set lowerCaseNum to 97
    set upperCaseNum to 65
    set uppercaseChar to character id (myNumber + upperCaseNum)
    set uppercaseChar to ("A" & uppercaseChar) as text

end if

return {uppercaseChar} 
```

# mathematical-optimization - Matlab，优化中算法的选择被忽略

> ID：13040050
> 
> 赞同：0
> 
> 时间：2012-10-23T22:04:41.940
> 
> 标签：mathematical-optimization, matlab, quadprog

Matlab 的 quadprog 什么时候忽略我选择的算法？我选择interior-point-convex，但它为我使用了活动集算法。它说明了什么？

顺便说一句，我的目标是二次和凸的，除非我的代码中有一些未知的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T06:04:54.360

我找不到类似的东西`quadprog`，但在它[的文档](http://www.mathworks.nl/help/optim/ug/lsqnonlin.html)中`lsqnonlin`说：

> 算法选项指定使用哪种算法的首选项。这只是一种偏好，因为必须满足某些条件才能使用每种算法。对于信赖域反射算法，非线性方程组不能欠定；也就是说，方程的数量（fun 返回的 F 的元素数量）必须至少与 x 的长度一样多。Levenberg-Marquardt 算法不处理有界约束。

我怀疑类似的情况与`quadprog`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:36:18.623

告诉我们您是如何调用代码的，因为几乎总是发生这种情况时，用户根本没有正确调用代码。您是否传递了选项结构？简单地调用 optimset 什么都不做。您必须将选项传递到代码中。

# django - 如何按外部值对 Django QuerySet 进行排序？

> ID：13040052
> 
> 赞同：6
> 
> 时间：2012-10-23T22:05:11.717
> 
> 标签：django, django-queryset

我有一个由 (id, rank) 对组成的字典。我想对 id 执行 Django 查询，以便生成的查询集按排名（降序）排序。

获取查询集很容易：

```
rankings = {...}
result = MyModel.objects.filter(id__in=rankings.keys()) 
```

似乎答案应该涉及某种注释，我可以将其用作 order_by 的一部分，但我不知道如何到达那里。

编辑：我没有提到我需要结果是一个 QuerySet，因为这是一个美味的 API 管道的一部分。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2019-04-12T11:21:35.087

我对 Django > 1.10 和 PostgreSQL > 9.5 的解决方案

```
from django.db.models import Func, Value, IntegerField, CharField
from django.contrib.postgres.fields import ArrayField

class ArrayPosition(Func):
    function = 'array_position'

    def __init__(self, items, *expressions, **extra):
        if isinstance(items[0], int):
            base_field = IntegerField()
        else:
            base_field = CharField(max_length=max(len(i) for i in items))
        first_arg = Value(list(items), output_field=ArrayField(base_field))
        expressions = (first_arg, ) + expressions
        super().__init__(*expressions, **extra)

pk_list = [234,12,23]
queryset = SomeModel.objects.filter(pk__in=pk_list, ...)\
    .annotate(ordering=ArrayPosition(pk_list, F('pk'), output_field=IntegerField()))\
    .order_by('ordering') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T22:24:29.683

像这样的东西？

```
rankings = { 1 : 2, 2: 1, ... } # i.e. { 'id' : 'ranking', ... }
objects = list(MyModel.objects.filter(id__in=rankings.keys()))
objects.sort(key=lambda obj: rankings[obj.id]) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T01:45:43.650

我能想出解决这个问题的唯一方法是创建一个与主模型相关的新排名模型。在每个查询中，我将排名项目插入该模型，然后能够通过关系执行 order_by。（使用注释将排名添加到学校记录中。）

```
class UserSchoolRanking(models.Model):
    user = models.ForeignKey(User)
    school = models.ForeignKey(School)
    rank = models.IntegerField()

bulk_user_school_rank = [UserSchoolRank(user=user, school_id=k, rank=v)
                                         for k, v in rankings.iteritems()]
UserSchoolRank.objects.bulk_create(bulk_user_school_rank)

schools = School.objects.filter(userschoolrank__user=user)\
                .annotate(rank=Min('userschoolrank__rank'))\
                .order_by('-userschoolrank__rank') 
```

# javascript - 在 Javascript 中存储前一周的日期数组，getDate

> ID：13040053
> 
> 赞同：0
> 
> 时间：2012-10-23T22:05:13.873
> 
> 标签：javascript, date, getdate

我要做的是构建一个包含前 7 天日期的数组。下面的代码为我做了这个。但是，当 (now.getDate() - index) 小于 1 时，它不会将日期跳回上个月，它只会使值变为负数。

我尝试将其替换为 (now.setDate(now.getDate() - index)) 希望修复它，但我似乎得到了 UNIX 时间，而且绝对不是正确的时间。

```
var bars = new Array();
    var index = 0;
    var NumFields = data.length - 2;
    var now = new Date();
    var date = new Array();

    for(var i=0;i<NumFields;i++) {
        $('.graph').append("<div class=\"bar\"></div>");
    }

    $('.graph > .bar').each(function() {
        var currentData = data[index];
        $(this).attr('value', currentData);
        bars.push(currentData);
        date.push(now.getDate() - index);
        index++;        
    }); 
```

如果您想查看问题（请记住，它看起来不会损坏，因为当前日期减去 7 天大于零），然后转到 habitic.com 并单击“运行”。

谢谢你的帮助！我非常困惑，这是第一个让我感到困惑以至于需要寻求帮助的问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:19:17.617

不，`now.setDate(now.getDate() - index)`实际上是正确的方法。然而，它不会返回新的一天，而是返回`now`Date 实例的新 [内部] 时间戳。做两步：

```
now.setDate(now.getDate() - 1); // sets the date to the previous day each time
date.push(now.getDate()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:34:29.067

//**先**设置日期，然后将 Date 对象的 getDate 值压入数组。

```
function pastweek(d){
    var now= d || new Date(),
    i= 6,
    dates= [now.getDate()];
    while(i--){
        now.setDate(now.getDate()-1);
        dates.push(now.getDate());
    }
    return dates.reverse();
} 
```

/*

```
pastweek(new Date(2012,9,5))
returned value: (Array)
29,30,1,2,3,4,5 
```

*/

/*

```
pastweek()
returned value: (Array)
17,18,19,20,21,22,23 
```

*/

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-23T22:18:02.630

尝试使用这个：

```
day = 24*60*60*1000
new Date(now.getTime()-index * day); 
```

`now.getTime()`以自纪元（格林威治标准时间 1970 年 1 月 1 日午夜）以来的毫秒数返回时间。 `day = 24*60*60*1000`计算一天中的毫秒数（24 小时、60 分钟/小时、60 秒/分钟、1000 毫秒/秒）。将它乘以天数的偏移量（`index`如果我没记错的话），你会得到以毫秒为单位的偏移量。从 getTime() 中减去它，您将获得自所需日期的纪元以来的毫秒数，然后您可以在 Date() 构造函数中使用它来获取该日期和时间的实际 Date() 对象。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-23T22:35:47.433

`now`我会留给你来利用它来适应你的上下文，但是假设今天 ( ) 是 2012 年 1月 3 日，你可以在这里获得最后一周的日期：

```
var now = new Date(2012, 0, 3),
    DAY_MS = 86400000,  // 1 day in milliseconds
    dates = [];

for (var i = 0; i < 7; i++) {
    dates.push(new Date(now.getTime() - (i * DAY_MS)));
}

console.log(dates);

// outputs:
// [Tue Jan 03 2012 00:00:00 GMT-0800 (PST),
//  Mon Jan 02 2012 00:00:00 GMT-0800 (PST),
//  Sun Jan 01 2012 00:00:00 GMT-0800 (PST),
//  Sat Dec 31 2011 00:00:00 GMT-0800 (PST),
//  Fri Dec 30 2011 00:00:00 GMT-0800 (PST),
//  Thu Dec 29 2011 00:00:00 GMT-0800 (PST),
//  Wed Dec 28 2011 00:00:00 GMT-0800 (PST)] 
```

# ruby - gem install buildr 失败

> ID：13040056
> 
> 赞同：0
> 
> 时间：2012-10-23T22:05:32.850
> 
> 标签：ruby, windows, gem, buildr

我正在尝试安装一些依赖项以在 Windows 7 上构建项目。我已经安装了 Cygwin 以及我认为需要的 Ruby 依赖项。

当我运行时，`gem install buildr`我收到以下错误。有什么建议么？

```
$ gem install buildr
Building native extensions.  This could take a while...
ERROR:  Error installing buildr:
        ERROR: Failed to build gem native extension.

        /usr/bin/ruby.exe extconf.rb
checking for jni.h... *** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
        --with-opt-dir
        --without-opt-dir
        --with-opt-include
        --without-opt-include=${opt-dir}/include
        --with-opt-lib
        --without-opt-lib=${opt-dir}/lib
        --with-make-prog
        --without-make-prog
        --srcdir=.
        --curdir
        --ruby=/usr/bin/ruby
/usr/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate
an executable file. (RuntimeError)
You have to install development tools first.
        from /usr/lib/ruby/1.9.1/mkmf.rb:506:in `try_cpp'
        from /usr/lib/ruby/1.9.1/mkmf.rb:931:in `block in have_header'
        from /usr/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'
        from /usr/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'
        from /usr/lib/ruby/1.9.1/mkmf.rb:254:in `open'
        from /usr/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'
        from /usr/lib/ruby/1.9.1/mkmf.rb:254:in `open'
        from /usr/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'
        from /usr/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'
        from /usr/lib/ruby/1.9.1/mkmf.rb:930:in `have_header'
        from extconf.rb:58:in `create_rjb_makefile'
        from extconf.rb:77:in `<main>'

Gem files will remain installed in /usr/lib/ruby/gems/1.9.1/gems/rjb-1.4.0 for inspection.
Results logged to /usr/lib/ruby/gems/1.9.1/gems/rjb-1.4.0/ext/gem_make.out 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T03:05:30.327

仅 Windows 上的 JRuby 支持 Buildr。您可以在 Windows 上安装 rjb，但这是一个痛苦的过程。JRuby 非常快（在 JDK7 上甚至更快，对团队表示敬意），这样你可能会很好。

# php - 使用 ' ' 时 SQL 语法错误

> ID：13040060
> 
> 赞同：-1
> 
> 时间：2012-10-23T22:05:50.093
> 
> 标签：php

> **可能重复：**
> [为什么带单引号的字符串在插入数据库时​​会引发错误？](https://stackoverflow.com/questions/5125785/why-string-with-single-quotes-raises-error-when-inserted-in-db)
> [插入包含撇号（单引号）的数据时出现 MySQL 错误？](https://stackoverflow.com/questions/7600661/mysql-error-when-inserting-data-containing-apostrophes-single-quotes)

每当我将单引号（''）放在文本区域中时，我总是会收到错误消息

`You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'test'','1351029587','10/23/2012','0','0','1492815560','0')' at line 1`

我插入了一个 html 删除功能：

```
$title = html_remove($title);
$body = html_remove($body);

function html_remove($input) {
    $old = array('<','>');
    $new = array('&lt;','&gt;');
    $input = str_replace($old, $new, $input);
    return $input;
    } 
```

是的，$title 和 $body 是有效的工作变量。

```
$body = $_POST['body'];
$title = $_POST['title']; 
```

不确定这是否正是你这样做的方式，但这几乎就是我所得到的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:13:29.293

您应该立即停止使用您的代码。它容易受到 SQL 注入的攻击。此外，`mysql_`功能正在被[弃用](http://www.deprecatedphp.com)。您应该使用带有绑定变量的准备好的语句，使用`mysqli_`or`PDO`函数。

您可能想要研究`strip_tags`从字符串中去除 HTML 和 PHP 标记或`htmlentities`将所有适用字符转换为 HTML 实体的函数。[阅读此处](https://stackoverflow.com/a/5788375/679449)了解差异和示例。

这是一个让您走上正确道路的示例：

```
<?php

$link = mysqli_connect('localhost', 'my_user', 'my_password', 'world');

/* check connection */
if (!$link) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$stmt = mysqli_prepare($link, "INSERT INTO myTable (body, title) VALUES (?, ?)");
mysqli_stmt_bind_param($stmt, 'ss', $_POST[body], $_POST[title]);

/* execute prepared statement */
mysqli_stmt_execute($stmt);

printf("%d Row inserted.\n", mysqli_stmt_affected_rows($stmt));

/* close statement and connection */
mysqli_stmt_close($stmt);

/* close connection */
mysqli_close($link);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:14:53.230

在准备好的语句中使用以下变量：

```
$body=htmlentities($_POST['body']);
$title=htmlentities($_POST['title']); 
```

`htmlentities()`将 and 转换`<`为`>`and`&lt;`并且`&gt;`执行的准备好的语句将用 a 转义`'`and`"`字符`\`

# python - 用另一个 Python 程序更改正在运行的 Python 程序的全局变量

> ID：13040062
> 
> 赞同：2
> 
> 时间：2012-10-23T22:05:52.653
> 
> 标签：python, global-variables

假设我在 Python 中有一个像这样的程序（**first.py**）：

```
GLOBALVAR = "pineapple"

def changeVAR(newValue):
     global GLOBALVAR
     GLOBALVAR = newValue

while(True):
   print GLOBALVAR 
```

我想在第一个运行时用另一个 python 程序唱出全局变量**GLOBALVAR 。**例如（**second.py**）：

```
from second import changeVAR

#do something
first.changeVAR("banana") 
```

有可能做这样的事情吗？意思是，用另一个程序更改正在运行的程序的全局变量？

先感谢您！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T22:27:09.360

您所描述的（程序共享相同的变量）只能在不同的[线程](http://docs.python.org/library/threading.html)（共享相同的 python 解释器和数据）之间，而不是在不同的进程之间。

现代操作系统不允许一个程序访问另一个程序的内存。所以你不能仅仅进入另一个进程的内存并在那里改变一些东西。允许这样做会产生各种错误和安全问题。

可以使用进程间通信与另一个程序进行通信。这可以通过例如[套接字](http://docs.python.org/library/socket.html)、[内存映射文件](http://docs.python.org/library/mmap.html)或写入彼此的标准输入和输出来完成。在类 UNIX 操作系统上还支持[信号量、共享内存和消息队列。](http://semanchuk.com/philip/sysv_ipc/)

该`multiprocessing`模块提供[`Queue`和`Pipe`](http://docs.python.org/library/multiprocessing.html#exchanging-objects-between-processes)对象以允许相关的处理相互交谈。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-29T11:34:00.007

我正在使用的解决方法。是在某处创建一个空文件。然后是一个编。如果它是空的，可以从这个文件中读取（比如每 2 秒左右），然后什么也不做。如果需要，另一个可以写入此文件。在 WRITE 之后，其他程序将从文件中读取写入的数据，并将其用作新的 VAR。然后清除文件，准备重新读取。我在从文件读取的服务器上使用它，然后从另一个程序我可以向服务器发送“命令”（使用它来语音控制照明），打开/关闭灯等！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:13:42.323

是的，但这是动态变化，所以如果你稍后再次静态加载模块，变化将不会持续。但是，无论何时您在更改后使用该模块，它都会一直存在。

您甚至可以简单地调用`first.GLOBALVAR = 'banana'`来实现相同的结果。

# apache-flex - Flex for mobile 中的 UIComponent 替换

> ID：13040063
> 
> 赞同：0
> 
> 时间：2012-10-23T22:05:54.767
> 
> 标签：apache-flex, mobile, air

我目前正在解析一个在 Flex 4.6 上制作的 Web 项目，客户想看看它是否可以在 iOS 上运行。但是我有一些 UIComponents 不起作用。据我了解 flex for mobile 它与 Halo 组件不太兼容。该应用程序就像一个游戏，由精灵和动画组成，但使用了一些弹性组件。所以我真的需要类似于 UIComponent 的东西。那么，我能用那个 UIComponent 做什么呢？我应该改用 Canvas，还是有更好的选择？

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:17:22.640

> 据我了解 flex for mobile 它与 Halo 组件不太兼容。

如果您使用的是 Flash Builder，则默认情况下，MX.swc 不会放置在您的移动项目的库路径中。您可以手动添加它；这应该有效。 [有关详细信息，请参阅我的答案](https://stackoverflow.com/questions/13022577/flex-mobile-project-does-not-support-mxcanvas/13022776#13022776)。添加后，您必须进行测试以确定实际设备上的性能是否可以接受。

但是，每个 Spark 组件的父级都是 SkinnableComponent，而 SkinnableComponents 的父级是 UIComponent。如果您只有通用 UIComponent 实例或具有扩展 UIComponent 的组件，那么您应该没有问题。

还有许多与移动优化皮肤一起提供的 MX 组件的 spark 等效项。列表和按钮应该可以正常工作，没有问题。

MX Canvas 是一个容器，因此通常没有真正的视觉部分。Spark 并行将是一个组；或者可能是一个 SkinnableContainer。

# mongodb - MongoDb v.1.8+：如何在临时集合中运行 Map-Reduce

> ID：13040067
> 
> 赞同：0
> 
> 时间：2012-10-23T22:06:17.190
> 
> 标签：mongodb, mapreduce

“ *v1.8+：输出选项已更改。Map-reduce 不再生成临时集合...* ”。这是否意味着我必须手动删除 map-reduce 生成的集合，或者还有一种说法是 map-reduce：我只需要这个输出作为临时中间存储，完成后立即删除？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T23:16:26.077

是的，您需要手动删除在输出选项中标识的命名集合（一旦完成），或者使用`{ inline: 1 }`从 RAM 返回输出的输出选项（并接受该输出选项的限制）。

# coldfusion - 使用 Coldfusion 和 MSSQL 2005 进行令牌替换

> ID：13040069
> 
> 赞同：0
> 
> 时间：2012-10-23T22:06:21.407
> 
> 标签：coldfusion

我遇到了 Raymond Camden 的博客[http://www.raymondcamden.com/index.cfm/2010/11/2/Building-a-simple-ColdFusion-TokenTemplate-System](http://www.raymondcamden.com/index.cfm/2010/11/2/Building-a-simple-ColdFusion-TokenTemplate-System)，它几乎是我想做的完美之选用它。我被困在如何动态创建这行代码：

`<cfset s = {name="Luke Skywalker", newslettertype="Lightsabers", producttype="swords", source="The Empire", rate="18"}>`

我的表包含 TERM 和 REPLACEMENTTERM，如下所示：

```
SELECT     TERM, REPLACEMENTTERM
FROM       REPLACEMENTTEXT 
```

我知道这行不通，但是为了直观地了解我要完成的工作：

```
<cfset s = {<cfoutput query="data">#data.term#="#data.replacementterm#"<cfif data.currentrow lt data.recordcount>,</cfoutput></cfif>}> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:18:16.650

试试这个：

```
<cfset s = {} />
<cfloop query="data">
    <cfset s[term] = replacementterm />
</cfloop> 
```

那应该完成您正在尝试做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T12:36:15.937

严重地？？？当最流行的模板语言已经有两个移植到 CFML 时，为什么还要重新发明轮子？他们甚至有针对他们的测试。

液体：[主页](http://liquidmarkup.org/)| [CFML 端口](https://github.com/rip747/cfml-liquid)

小胡子：[主页](http://mustache.github.com/)| [CFML 端口](https://github.com/rip747/Mustache.cfc)

# c - 而在 C 中使用 EOF

> ID：13040075
> 
> 赞同：-1
> 
> 时间：2012-10-23T22:06:35.250
> 
> 标签：c, file, eof

我正在尝试使用以下代码从 txt 文件中读取数据，但它只打印文件的第一行。

```
int main() {
    int chave;
    char ordem[5];
    struct tTree *arvore = (struct tTree*)malloc(sizeof(struct tTree));
    arvore->raiz = NULL;
    scanf("%s", ordem); 
    printf("%s\n", ordem);
    setbuf(stdin, NULL);  
    do {
        scanf("%d", &chave);
        insere(criaItem(chave), arvore);
        setbuf(stdin, NULL); 
    } while(chave != EOF);

    if(strcmp(ordem, "PRE") == 0) {
        pre(arvore->raiz);
    }
    else if(strcmp(ordem, "POS") == 0){
        pos(arvore->raiz);
    }
    else if(strcmp(ordem, "IN") == 0){
        in(arvore->raiz);
    }
    printf("%d\n", altura(arvore->raiz)-1);
    system("pause");   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:18:29.157

```
while (scanf("%d", &chave) == 1)
{
    insere(criaItem(chave), arvore);
    printf("Read: %d\n", chave);  // Debugging
    // setbuf(stdin, NULL);  // Pointless once there's been an I/O operation on stdin
} 
```

这会正确测试 EOF 和其他错误，并预先进行测试。几乎总是，最好在循环开始时执行读取操作并测试它是否成功。

您编写的内容存在大量问题，其中最重要的是键入`-1`作为输入值会终止您的循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T04:23:56.380

**scanf()**将*返回*EOF，但不会将其放入**chave**。你的代码不应该看起来更像这样吗？

```
int ret;
do {
    ret = scanf("%d", &chave);
    if ( ret == 1) {
        insere(criaItem(chave), arvore);
        setbuf(stdin, NULL); 
    }
} while( ret != EOF); 
```

# arrays - 在函数中对数组进行排序无法给出正确的结果

> ID：13040078
> 
> 赞同：0
> 
> 时间：2012-10-23T22:06:45.957
> 
> 标签：arrays, actionscript-3, function, sorting

我正在尝试对数组进行排序并找到哪个更大。所以我有原始数组（CurMobRM），一个具有相同值但经过排序和反转（Ary）的数组，最后是一个具有原始数组值位置的数组（检查）。

一个简单的例子是，假设原始具有值 (3,8,5,2,7)，我们对它们进行排序，因此我们有一个具有相同值但位置不同的数组 (8,7,5,3,2 ) 和具有每个值 (3,0,2,4,1) 的原始位置的最终数组。

```
var CurMobRM:Array = new Array (3,8,5,2,7);
var checking:Array= new Array;
putattackorder();

function putattackorder() {
    var Ary:Array = CurMobRM;
    var lo:Number;
    Ary.sort ();
    Ary.reverse ();
    trace (Ary)
    for (lo = 0; lo < 5; lo++) {
        for (loop = 0; loop < 5; loop++) {
            if (Ary[lo] == CurMobRM[loop]) {
                checking[lo] = loop
            }
        }
    }
    trace (checking)
    trace (Ary)
    trace (CurMobRM)
} 
```

问题是当我对 Ary 进行排序时，CurMobRM 似乎也在同时排序......我不明白为什么。跟踪（检查）总是给出 0,1,2,3,4

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T22:23:42.003

发生这种情况是因为在 ActionScript 3中，`array`对象是**按引用**而不是按**值**分配的。为了克服这个问题，您可以使用`slice`不带参数的方法（切片完整数组）。

例如，在您的代码中：

```
var CurMobRM:Array = new Array (3,8,5,2,7);
var checking:Array= new Array;
putattackorder();

function putattackorder()
{
    //perform a copy by value of array
    var Ary:Array = CurMobRM.slice();

    var lo:uint;
    var loop:uint;

    Ary.sort();

    //not necessary?
    //Ary.reverse();
    //trace (Ary)

    for (lo = 0; lo < 5; lo++) {
        for (loop = 0; loop < 5; loop++)
        {
            if (Ary[lo] == CurMobRM[loop])
            {
                checking[lo] = loop
            }
        }
    }

    trace (checking)
    trace (Ary)
    trace (CurMobRM)
} 
```

输出是：

3,0,2,4,1

2,3,5,7,8

3,8,5,2,7

我相信这是您正在寻找的。希望有所帮助！

# jquery - 查找下一个 TD 的输入元素

> ID：13040080
> 
> 赞同：5
> 
> 时间：2012-10-23T22:06:49.523
> 
> 标签：jquery, input, next

在 next 中找不到`input`元素`td`。我需要在 tblCashSum 的文本框的 td 类中放置一个值。

但是，如果我执行以下操作：

```
alert(formElement.nextAll('td.tblCashSum').find('input.cashSum').val()); 
```

它读取未定义。

HTML：

```
<tr>
    <td class='tblCashType'>100</td>
    <td class='tblCashAmount'><asp:TextBox class="inputBox" ID="noteAmount100" runat="server"></asp:TextBox></td>
    <td class='tblCashSum'><asp:TextBox class="inputBoxDisabled cashSum" ReadOnly="true" runat="server" ID="cashSum100"></asp:TextBox></td>
</tr> 
```

查询：

```
$("noteAmount").blur(function(){
 calc($(this));
});

function calc(formElement)
{
    a = formElement.val();
    b = formElement.closest('td').siblings('td.tblCashType').text();
    x = a * b;
    formElement.nextAll('td.tblCashSum').find('input.cashSum').val(x);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T22:12:48.813

您正在传递一个作为输入元素值的字符串，您应该首先传递对象，请注意您错过了`#`ID 选择器。

```
$("#noteAmount").blur(function(){
     calc($(this));
}); 
```

然后你可以使用`parent`和`next`方法：

```
function calc($formElement) {
    a = parseInt($formElement.val(), 10);
    b = parseInt($formElement.closest('td').siblings('td.tblCashType').text(), 10);
    x = a * b;
    $formElement.parent().next().find('input.cashSum').val(x);
} 
```

请注意，如果您的元素具有 ID 属性，您可以直接选择它们，这比遍历 DOM 更快。

* * *

我在您的标记中找不到 ID 为*noteAmount*的元素，如果您有多个具有相同 ID 的元素，您的标记将变为无效并且您会得到意想不到的结果，您还可以尝试以下操作：

```
$('.inputBox').blur(function(){
    a = this.value
    $this = $(this);
    b = $this.parent().prev().text();
    x = parseInt(a, 10) * parseInt(b, 10);
    $this.parent().next().find('input.cashSum').val(x);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:15:13.297

您需要`.next()`在`.parent()` 输入上使用

尝试`formElement.closest('td').next('td.tblCashSum')`

或者

```
formElement.parent().next('td.tblCashSum') 
```

//

也`$("noteAmount")`没有任何意义......应该是 `$('[id*="noteAmount"]')`

```
$('[id*="noteAmount"]').blur(function(){
 calc($(this));
});

function calc(formElement)
{
    a = formElement.val();
    b = formElement.closest('td').siblings('td.tblCashType').text();
    x = a * b;
    formElement.closest('td').next('td.tblCashSum').find('input.cashSum').val(x);
} 
```

# build - 什么是好的 RPM 构建工具？

> ID：13040087
> 
> 赞同：5
> 
> 时间：2012-10-23T22:07:36.533
> 
> 标签：build, makefile, rpm, scons

我负责构建多个 RPM。对于我需要制作的每个 RPM 包，我都有原始的 SPEC 文件，并且我有 BASH 脚本来设置必要的环境并构建 RPM。

我想使用实际的构建工具（例如 make）来构建这些 RPM。通过这样做，我希望消除对自定义的、混淆的 BASH 脚本的需要，以支持清晰、可维护的配置文件（类似于 make 的 Makefile）。但是，使用[POSIX make](http://pubs.opengroup.org/onlinepubs/009695399/utilities/make.html)并保持 make 文件集是最新的可能与维护我目前用来构建 RPM 包的 BASH 脚本一样多。像 cmake 和 automake 这样的程序包含 make 命令的功能是有原因的 - 这些工具更具表现力，允许更小、更清晰的配置文件。

然而，使用[autoconf](http://www.gnu.org/software/autoconf/) / [automake](http://www.gnu.org/software/automake/)似乎也是一个糟糕的选择，因为它们似乎是专门为 C 和 C++ 开发而构建的。也有人建议我使用[scons](http://www.scons.org/)，但尽管这似乎是最佳选择（由于其配置文件是实际的 Python 脚本），但它也适用于特定语言。

将我的 SPEC 文件用作“源代码”，将环境用作“依赖项”（例如设置制作 RPM 所需的 rpmbuild 的目录树结构），是否有一个好的构建工具可以用来替换我的 BASH 脚本以获得更清洁、更多可维护的 RPM 构建解决方案？

编辑：当我说“构建工具”时，我似乎不清楚我需要什么。我已经使用 rpmbuild 作为“编译器”，我使用 SPEC 文件（以及二进制文件的相关源代码）作为“源代码”来“编译”RPM。我要求一种可以协调该过程的工具。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-24T05:27:53.457

根据您需要做的事情的复杂性，SCons 确实是一个不错的选择。我总是发现用 Python 编写脚本比用 Bash 编写脚本要容易得多。但这也是个人喜好。

这是在 SCons 中生成 RPM 的相关 Python/SCons 代码：

```
env = Environment(tools=['default', 'packaging'])

rpmSourceFiles = ['file1', 'file2'] # This is a Python list
rpmTargetFile = 'yourRpmFile'

env.Package( source         = rpmSourceFiles,
             target         = rpmTargetFile,
             NAME           = 'foo',
             VERSION        = '1.2.3',
             PACKAGEVERSION = 0,
             PACKAGETYPE    = 'rpm',
             LICENSE        = 'gpl',
             SUMMARY        = 'balalalalal',
             DESCRIPTION    = 'this should be really really long',
             X_RPM_GROUP    = 'Application/fu',
             SOURCE_URL     = 'http://foo.org/foo-1.2.3.tar.gz'
        ) 
```

[您可以在此处](http://www.scons.org/doc/production/HTML/scons-user/a8580.html)找到记录的 Package() 构建器。关于`rpmSourceFiles`，它是一个 Python 列表，应该列出 RPM 输入文件。如果您使用 SCons 安装这些源文件，那么您可以只列出简单的名称，否则您将需要提供绝对路径。

如果您只想使用 Python，另一种选择是直接使用 Python 对 RPM 进行编程，如此[处](http://docs.fedoraproject.org/en-US/Fedora_Draft_Documentation/0.1/html/RPM_Guide/ch-rpm-programming-python.html)所述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:41:33.210

正如@Serge 所提到的， rpmbuild 是您要使用的工具。它在所有基于 RPM 的发行版中都带有 rpm 包（或子包）。对于基于 RPM 的发行版，还有很多可用的辅助命令，例如对于 fedora 或基于 RH 的 rpmdevtools 包有很多有用的脚本/命令。

如果您正在寻找构建器，Fedora 项目使用构建器 koji。它托管在 fedorahosted.org 中。您可以设置 koji 服务器并使用 koji 的命令行工具来构建 RPM。Builder 可能无法完全解决您的问题，但如果您有空闲时间，不妨看看。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-24T07:14:36.260

我已经使用 scons 来构建 RPM 和 Debian 软件包，因此作为 Package 的集成工具是最差的，并且具有的最小功能还不够。根据我的经验，我建议您在 bash 或 python 或其他脚本语言上创建构建脚本，并使用自定义操作从 scons 调用它以使用子进程调用脚本并设置来自二进制文件/库/其他工件的依赖项，这些工件需要使用 Depends 函数来打包这个命令。

当然，如果您使用 scons 作为构建系统，它适用，否则忽略。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-12T08:44:54.117

我想这可能是您找不到结果 RPM。默认值应为`<YOUR_RPMBUILD_DIR>/RPMS/<ARCH>`

取决于您的架构。`ARCH`可能在`x86_64`,`i586`或`noarch`.

你可以有以下`~/.rpmmacros`

```
%home %(echo $HOME)
%packager NAME OF PACKAGER
%vendor NAME OF VENDER
%_topdir ${home}/rpmbuild 
```

否则，您只需要像下面这样的 Makefile 来编译、构建、打包 tarball 并生成 RPM。

```
SRCS = LIST OF SOURCE FILES
DATA = LIST OF DATA FILES TO BE PACKED
BINARY = LIST OF FILES AS RESULT OF BUILD
TARBALL = FILENAME_OF_THE_SOURCE_ARCHIVE

all: rpm

rpm: build pack
   rpmbuild -ba <PATH_TO_SPEC>

pack: TARBALL

TARBALL: BINARY DATA
    COMMAND TO PACK TARBALL

build: BINARY

BINARY: SRCS
   BUILD COMMANDS 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-08-04T14:09:12.903

绝对是一个老问题，但你可能对多哥感兴趣。

[https://github.com/genereese/togo](https://github.com/genereese/togo)

它专注于使您的构建环境更加健全和易于管理

# javascript - 有谁知道带有分页的动态表的js库？

> ID：13040088
> 
> 赞同：1
> 
> 时间：2012-10-23T22:07:39.777
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3

我创建了一个返回 JSON 数据的 rails 控制器。因此，我无法像往常一样使用 rails 在服务器上呈现数据。

我可以创建一个简单的 JS，它可以只获取 JSON 并创建一个表。但我支持分页。我从 jquery 插件中查看了一些这样的表，但它们不使用 Bootstrap css，所以在我的布局中看起来很讨厌。

有没有人遇到过这样的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:10:27.007

我建议您使用[Backbone](http://backbonejs.org/)和[Backbone.Paginator](https://github.com/addyosmani/backbone.paginator)。完美满足您的需求！

# android - 如何设置列表视图？

> ID：13040093
> 
> 赞同：1
> 
> 时间：2012-10-23T22:07:48.323
> 
> 标签：android, android-layout, listview, android-listview

好的，这是一个菜鸟问题。我将如何设置一个列表视图，单击该列表视图时最好在新页面上显示描述。截至目前，该应用程序仅打开并显示一个菜单，每次更改标题部分时，它都会更改页码。

```
package com.example.test;

import android.app.ActionBar;
import android.app.FragmentTransaction;
import android.content.Context;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.support.v4.app.FragmentActivity;
import android.support.v4.app.FragmentManager;
import android.support.v4.app.NavUtils;
import android.view.Gravity;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.TextView;

public class MainActivity extends FragmentActivity implements ActionBar.OnNavigationListener {

private static final String STATE_SELECTED_NAVIGATION_ITEM = "selected_navigation_item";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Set up the action bar.
    final ActionBar actionBar = getActionBar();
    actionBar.setDisplayShowTitleEnabled(false);
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);

    // Set up the dropdown list navigation in the action bar.
    actionBar.setListNavigationCallbacks(
            // Specify a SpinnerAdapter to populate the dropdown list.
            new ArrayAdapter(
                    actionBar.getThemedContext(),
                    android.R.layout.simple_list_item_1,
                    android.R.id.text1,
                    new String[]{
                            getString(R.string.title_section1),
                            getString(R.string.title_section2),
                            getString(R.string.title_section3),
                            getString(R.string.title_section4),
                    }),
            this);
}

@Override
public void onRestoreInstanceState(Bundle savedInstanceState) {
    if (savedInstanceState.containsKey(STATE_SELECTED_NAVIGATION_ITEM)) {
        getActionBar().setSelectedNavigationItem(
                savedInstanceState.getInt(STATE_SELECTED_NAVIGATION_ITEM));
    }
}

@Override
public void onSaveInstanceState(Bundle outState) {
    outState.putInt(STATE_SELECTED_NAVIGATION_ITEM,
            getActionBar().getSelectedNavigationIndex());
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

@Override
public boolean onNavigationItemSelected(int position, long id) {
    // When the given tab is selected, show the tab contents in the container
    Fragment fragment = new DummySectionFragment();
    Bundle args = new Bundle();
    args.putInt(DummySectionFragment.ARG_SECTION_NUMBER, position + 1);
    fragment.setArguments(args);
    getSupportFragmentManager().beginTransaction()
            .replace(R.id.container, fragment)
            .commit();
    return true;
}

/**
 * A dummy fragment representing a section of the app, but that simply displays dummy text.
 */
public static class DummySectionFragment extends Fragment {
    public DummySectionFragment() {
    }

    public static final String ARG_SECTION_NUMBER = "section_number";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        TextView textView = new TextView(getActivity());
        textView.setGravity(Gravity.CENTER);
        Bundle args = getArguments();
        textView.setText(Integer.toString(args.getInt(ARG_SECTION_NUMBER)));
        return textView;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T22:33:58.827

由于您还没有实现任何东西，我建议您从默认适配器实现开始。

看看[这个](http://www.vogella.com/articles/AndroidListView/article.html#listview_overview)，它会对你有所帮助。

**编辑：**

首先，您必须`ListView`在 *activity_main.xml* 文件中添加一个视图。

```
<ListView
        android:id="@+id/mylist"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" /> 
```

在此之后，您可以访问列表，这意味着您可以用一些项目填充它。

1.  “找到你的`View`”

    ```
    ListView list = (ListView) findViewById(R.id.myList) 
    ```

2.  定义数据数组以绑定和设置适配器（我将使用示例中的相同数组）

    ```
    final String[] values = new String[] { "Android", "iPhone", "WindowsMobile",
    "Blackberry", "WebOS", "Ubuntu", "Windows7", "Max OS X",
    "Linux", "OS/2" }; // You have the necessary data to bind the list.

    final ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
    android.R.layout.simple_list_item_1, android.R.id.text1, values); // You have set     the previous array to an adapter that can be now setted to a list.

    listView.setAdapter(adapter); //Set adapter and that's it. 
    ```

好吧，这是开始了解如何填充列表视图的简单方法。如果您希望列表项包含多个文本，则必须构建自己的自定义适配器类。但这将受到另一个问题的影响：D

让我知道它是否有帮助！

# c# - 分析某些内容后，将结果持久保存到 mvc mini profiler 数据库

> ID：13040094
> 
> 赞同：2
> 
> 时间：2012-10-23T22:07:50.187
> 
> 标签：c#, mvc-mini-profiler

我知道我可以调用 MiniProfiler.Settings.Storage.Save(MiniProfiler); 将响应时间持久化到数据库。但我在这里有一个更棘手的问题。我们围绕 mvc mini profiler 构建了一个小框架，这样我们也可以在没有 Web 上下文的情况下使用它，它还具有回归报告功能。

但长话短说，这就是问题所在 -

我必须实现一个 Step 方法来调用 mini profiler 的 Step 方法（并做一些其他的事情）。这样做是因为我们没有直接向我们的开发人员公开迷你分析器的功能。我们将为他们提供不同的方法，例如您可以使用“迷你分析器方法”，也可以使用“秒表方法”。所以，这是我的 Step 方法的代码 -

```
public IDisposable Step(Profiler profiler, String operationName, Int32 numofInvocations = 1, Action operation = null) //
    {
        if (profiler == Profiler.MVCMiniProfiler)
        {
            return MiniProfiler.Step(operationName);  //This is statement to note in this code
        }
        else if (profiler == Profiler.MyStopWatch)
        {
            return new MyStopWatch(operationName, numofInvocations, operation);
        }
        else
        {
            return null;
        }
    } 
```

现在的问题是 MiniProfiler 的 Step 方法返回一个一次性对象（它的代码中的 Timing 对象）并且 Timing 对象的 Dispose() 停止秒表并返回经过的时间。我需要做的是在分析任何内容后立即调用 Save() 方法。但我也不想更改 MiniProfiler 源代码。

有什么简单的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:24:48.710

您可以制作一个也实现该`IDisposable`接口的包装器。就像是：

```
public class MiniProfilerStep : IDisposable
{
    private readonly MiniProfiler _profiler;
    private readonly IDisposable _step;

    public MiniProfilerStep(MiniProfiler profiler, string operation)
    {
        _profiler = profiler;
        _step = _profiler.Step(operation);
    }

    public void Dispose()
    {
        _step.Dispose();
        MiniProfiler.Settings.Storage.Save(_profiler);
    }
} 
```

然后返回包装器的一个实例，而不是迷你探查器步骤：

```
 if (profiler == Profiler.MVCMiniProfiler)
    {
        return new MiniProfilerStep(MiniProfiler, operationName); 
    } 
```

# c - 最后通过一个循环，在函数调用中表现出奇怪和隐含的错误？

> ID：13040095
> 
> 赞同：0
> 
> 时间：2012-10-23T22:07:59.527
> 
> 标签：c, for-loop

我的代码：

```
#define RUNS 4

int main (int argc, char *argv[])
{
    srand(time(NULL));

    int i;
    int _length;
    float _totalTimeToReachLength;
    float _arrayOfTimes[RUNS - 1];
    float _sumDev = 0.0;

    for (i = 0; i < RUNS; i++)
    {
        float localHopNumber = GenerateHops(_length); //pass length into hops method.

        _arrayOfTimes[i] = localHopNumber; //add hop number generated to array.
        _sumDev = (_sumDev + (_arrayOfTimes[i]-(_totalTimeToReachLength / RUNS)) * (_arrayOfTimes[i]-(_totalTimeToReachLength / RUNS))); //work out sd.
        _totalTimeToReachLength = _totalTimeToReachLength + _arrayOfTimes[i];

        printf("Current increment for average: %f\n", _totalTimeToReachLength);
        printf("Item added to array: %f\n", _arrayOfTimes[i]);
    }

    printf("The standard deviation of times is: %f\n", sqrt(_sumDev/RUNS));
    printf("The standard average of times is: %f\n", _totalTimeToReachLength / RUNS);

    return 0;
} 
```

为什么它在最后一个循环中搞砸了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T22:09:45.193

数组声明需要是：

```
float _arrayOfTimes[RUNS]; 
```

OP using 中的`RUNS-1`声明将其声明为 3 个元素的数组（但您在其中存储 4 个值）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:10:19.693

您已经声明`arrayOfTimes`了 3 个浮点数。但是在您的循环中，您最多可以访问 4 个。因此调用*未定义的行为*。

将条件更改为： `for (i = 0; i < RUNS -1; i++)`

或`float _arrayOfTimes[RUNS-1];`_`float _arrayOfTimes[RUNS];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:12:03.817

你超出了_arrayOfTimes。您使用 3 个元素声明它，但分配给元素 4。

```
float _arrayOfTimes[RUNS - 1];  

_arrayOfTimes[i] = localHopNumber; 
```

# ruby-on-rails - 多态关联会影响 Rails 应用程序的性能吗？

> ID：13040099
> 
> 赞同：0
> 
> 时间：2012-10-23T22:08:16.893
> 
> 标签：ruby-on-rails

假设我有 3 个模型音乐家、开发人员和医生，每个人都有一些共同的属性，例如姓名、姓氏、生日和电子邮件，但他们有一些特定的属性，例如音乐家（乐器、乐队）、开发人员（语言、SO）和医生（执照、诊所）。

我的方法是这样的：

```
class Person < ActiveRecord::Base
    belongs_to :general, :polymorphic => true
end

class Musician < ActiveRecord::Base
    has_one :person, :as => general
end

class Developer < ActiveRecord::Base
    has_one :person, :as => general
end

class Doctor < ActiveRecord::Base
    has_one :person, :as => general
end 
```

问题是，这种模型关系会因为多态关联而影响性能？还是有更好的解决方案可以考虑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:36:27.813

是的，多态关联确实会影响性能。有时是积极的，有时是消极的，都取决于您的应用程序的使用方式。

就您提出的情况而言，我不会使用多态关联。我将只有 3 个模型，在三个模型中具有共同的属性，如姓名、姓氏、生日和电子邮件。这更有利，因为如果您想找出音乐家的名字，您只需要在 Musician 表中进行 1 次数据库调用。在多态关联情况下，您需要在 Musician 表和 Person 表中进行 2 次数据库调用。

# unit-testing - Symfony2 在单元测试中获取配置参数

> ID：13040104
> 
> 赞同：15
> 
> 时间：2012-10-23T22:08:30.967
> 
> 标签：unit-testing, symfony

我有一个 Symfony2 服务，它是使用依赖注入的 config.yml 中的参数构建的。我现在正在尝试对其进行单元测试，发现单元测试无法访问容器，因此无法访问服务。所以我应该使用模拟数据自己构建一个。如果我现在可以读取 config 参数（先到 config_test.yml 然后是 config.yml 等），这对我来说是有意义的，但似乎这也是不可能的。这似乎使单元测试服务变得繁琐，因为我需要将初始化参数编码到测试而不是配置文件中。

如果在单元测试期间确实无法使用来自 config.yml 的参数构建服务，那么有人知道为什么它是 Bad Thing™ 的逻辑吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-12-03T15:36:50.103

这对我有用：

```
class MyServiceTest extends WebTestCase
{
    public function testCookies()
    {
        $client = static::createClient();

        $myParams = $client->getKernel()->getContainer()->getParameter('my_params');
    }
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-28T08:14:23.190

我找到了这篇文章，因为我自己在测试中需要配置参数。这是谷歌的第一次成功。

但是，这是一个可行的解决方案。可能有更好的。

```
<?php

...

require_once(__DIR__ . "/../../../../../app/AppKernel.php");

class MediaImageTest extends WebTestCase
{
    private $_application;
    private $storagePath;

    public function setUp() {  
         $kernel = new \AppKernel('test', true);
         $kernel->boot();
         $this->_application = new \Symfony\Bundle\FrameworkBundle\Console\Application($kernel);
         $this->_application->setAutoExit(false)

         $this->storagePath = $this->_application->getKernel()->getContainer()->getParameter('media_path');
    }

    ...
} 
```

你也可以看看这个：[Access Symfony 2 container via Unit test?](https://stackoverflow.com/questions/8972737/access-symfony-2-container-via-unit-test) 是在单元测试中访问内核的更清洁的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-23T22:28:34.337

单元测试是将一个类与其他类隔离开来进行测试。要对您的服务进行单元测试，您不需要从配置中读取任何内容。只需在测试中传递一个值。最后，它可能会与其他值一起使用，对吧？

当然，如果围绕接受的值有一些逻辑/验证，您可能应该通过测试来覆盖它。想想如果你从配置中获取这个值你会怎么做。您根本无法使用不同的值测试行为。

如果您想验证您的应用程序是否正常工作（您的类以您期望的方式协作），请使用功能测试或验收测试工具（如 Behat）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-01-17T18:27:34.550

我正在使用 Symfony 3.2.2，但我认为这也适用于你。

这只是一行：

```
$export_dir = static::$kernel->getContainer()->getParameter('export_dir'); 
```

# jquery - 为什么这个 jQuery 函数不返回任何东西？

> ID：13040105
> 
> 赞同：1
> 
> 时间：2012-10-23T22:08:35.360
> 
> 标签：jquery, function, null, return

我已经搜索了几个小时试图修复这个 jQuery/JS 代码，但它似乎不想返回任何东西。

```
var result = getURLS(); // this is always blank

function getURLS() {
    var urls = [];
    var URL_record = Parse.Object.extend("URL_record");
    var query = new Parse.Query(URL_record);

    query.equalTo("user", Parse.User.current());
    query.ascending("date");

    query.find({
        success : function(results) {
            var tempURLS = [];
            $.each(results, function(index, record) {
                urls.push(record.get("shortURL") + " " + record.get("longURL"));
            });
        },
        error : function(error) {

        }
    });
    return urls;
} 
```

虽然如果我从这个特定功能创建一个警报功能：

```
success : function(results) {
    var tempURLS = [];
    $.each(results, function(index, record) {
        urls.push(record.get("shortURL") + " " + record.get("longURL"));
    });
        alert(urls);
}, 
```

它似乎很好地提醒。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:24:40.020

query.find 是异步的，您需要在成功函数中设置变量，然后调用使用结果的代码。

```
var result;
getURLS();

function getURLS() {
    var urls = [];
    var URL_record = Parse.Object.extend("URL_record");
    var query = new Parse.Query(URL_record);

    query.equalTo("user", Parse.User.current());
    query.ascending("date");

    query.find({
        success : function(results) {
            var tempURLS = [];
            $.each(results, function(index, record) {
                urls.push(record.get("shortURL") + " " + record.get("longURL"));
            });
            result = urls;
            // call code that uses result here
            processResults(result);
        },
        error : function(error) {

        }
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T18:49:25.823

我发现 query.get 在被难住了几个小时后是异步的。直到我从我的 $(function () {}); 块并在控制台上看到查询在块之后触发。最终的想法是将模型和视图加载到 Facebook 应用程序中，该应用程序也具有异步初始化功能。我没想到 Parse 查询也是异步的。

# c# - 如果 const int 没有唯一值，让编译器抛出错误

> ID：13040110
> 
> 赞同：0
> 
> 时间：2012-10-23T22:09:16.840
> 
> 标签：c#, constants

我在 C# 类中定义了一堆`public const int`变量，它们的值也被初始化。如果每个变量的值不唯一，有没有办法让编译器抛出编译器错误？如果变量之间存在值冲突，我不希望我的项目编译。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:12:47.527

您必须创建一个自定义的[Fx Cop 规则](http://www.thescarms.com/dotnet/FxCop1.aspx)，该规则将查看`public const int`您班级中的成员并检查分配给他们的值。然后，您可以将此规则添加到您的代码分析规则集中，并将其设置为失败时**出错**（而不是警告）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T22:15:29.143

switch 语句中的 case 必须是唯一的，因此您可以`switch`对要确保不会与其他变量重叠的每个变量使用带有 case 的语句。

```
static class ColorSwatches
{
    public const int Red = 0, Gray = 1, Blue = 2, Yellow = 3, Grey = 1;

    static ColorSwatches()
    {
        switch (0) {
            case Red:     break;
            case Gray:    break;
            case Blue:    break;
            case Yellow:  break;
            case Grey:    break;
        }
    }
} 
```

不幸的是，这确实需要在`switch`.

（边栏：这也适用于 C++，在添加之前我已将其用于编译时断言`static_assert`。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:20:50.050

在枚举中定义它们。如果您不希望它们从零单调增加，您仍然可以指定值，但如果有任何重复值，编译器会出错。

# java - 从数据库检索时，日期字段的时区设置不正确

> ID：13040111
> 
> 赞同：0
> 
> 时间：2012-10-23T22:09:17.787
> 
> 标签：java, datetime

我们有一个用例，我们从数据库中读取日期，将其转换为 UTC，然后使用它。现在插入的日期在 FC 的本地 org 时区，但是当我阅读它时，日期保持不变，并且它的时区作为 UTC 获得。结果，我无法将其转换为 UTC，因为转换器发现它已经在那个时区。

关于如何解决这个问题的任何提示？

# r - 如何接受不带引号的文本/字符参数

> ID：13040120
> 
> 赞同：3
> 
> 时间：2012-10-23T22:09:53.267
> 
> 标签：r, function, text, character, quotes

抱歉，如果问题不清楚。随意改变它。

所以基本上我试图找到一种方法，使函数的文本/字符串参数不需要引号。

```
foo  = function(x, y, data){
    n1 = length(data[,x])
    n2 = length(data[,y])
    cat(n1, n1)
 } 
```

如果我使用以下代码

```
data(survey)
foo(Sex, Fold, survey) 
```

我会收到一条错误消息。但如果我使用以下内容：

```
foo("Sex", "Fold", survey) 
```

或者

```
foo(1, 5, survey) 
```

该功能会给我我想要的。所以我想知道是否有任何方法可以构造函数，这样我就不需要在列名周围使用引号。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-23T22:33:38.623

好吧，这将适用于符号：

```
foo  = function(x,y, data){
    n1 <- length(eval(substitute(x),data))
    n2 <- length(eval(substitute(y),data))
    cat(n1,n2)  
} 
```

如果您希望它也适用于带引号的变量名称和整数索引，您可以简单地检查`x`并`y`在开始时进行一些简单的`if-else`分支。

但它带有标准警告，即该`eval(substitute())`成语使用起来可能很危险。（在某些情况下，您可能并不总是能够预料到它是如何*不起作用的，并且您可能没有**意识到*它什么时候不起作用。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:35:48.280

这与`[]`数据帧的索引参数有关。

当您说 DF[,x] 时，它是在告诉 R 从 DF 中选择哪一列。如果 x 是来自 DF 的文字列“Sex”，它将告诉 R 你想要 vector 中的所有列`DF$Sex`。

因此，如果您使用 "Sex"/"Fold" 或`1,5`，那么您的功能应该是原样。如果你想使用`Sex`and `Fold`，那么你的功能应该是：

```
foo = function(x,y,data){
n1 <- length(x)
n2 <- length(y)
cat(n1,n2)
} 
```

# php - PHP SDK不返回ID

> ID：13040129
> 
> 赞同：1
> 
> 时间：2012-10-23T22:10:42.410
> 
> 标签：php, facebook, sdk

我在 Facebook 画布应用程序上使用以下代码来获取用户 ID。它一直工作到今晚，现在它给了我“0”。我能做些什么不同的事情？

```
require_once("facebook-php-sdk/src/facebook.php");
$config = array();
$config[‘appId’] = '***';
$config[‘secret’] = '****';
$config[‘fileUpload’] = false; // optional

$facebook = new Facebook($config);

$userid = $facebook->getUser();

echo $userid; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T12:29:29.683

如果用户没有通过 getLoginUrl 或其他方式登录*到您的应用程序，您将始终得到 0。*

还可以考虑将您的 SDK 更新到最新版本[https://github.com/facebook/facebook-php-sdk/](https://github.com/facebook/facebook-php-sdk/)

# magento - 站点根目录不在域根目录中时无法访问 Magento Admin

> ID：13040131
> 
> 赞同：2
> 
> 时间：2012-10-23T22:10:51.973
> 
> 标签：magento, admin

我不认为这个问题是重复的。

有类似的问题，但没有一个解决这个特定的原因。

服务器是 CentOS Apache，PHP 5.3.10

我有同一个 Magento 站点的 2 个副本。管理员在一个工作，但不是另一个。

在它工作的地方，Magento 安装在站点根目录中：

例如`www.example.com`，将您带到网站，并将`www.example.com/admin`您带到管理员。

但另一个副本在：

`www.example.com/othersite/`

因此，我尝试通过访问管理员，`www.example.com/othersite/admin`但出现 404 错误。

我尝试编辑 app/etc/local.xml 以便它读取“othersite/admin”而不仅仅是“admin”，但这并没有解决问题。我已经重新启动了 apache 几次，尽管这不应该做任何事情。

我见过一个解决方案，它涉及在 4 个不同的表（例如 in `core_store`）中将数据库中的某个值设置为“0”。这些值已经是 0，所以我没有运行任何查询。

谢谢

编辑：

另请注意，我尝试将工作站点上的管理员访问权限更改`test/admin`为. 它没有用。将其更改为确实有效。Magento 不允许管理员位于子文件夹中吗？这是一个url重写问题吗？`admin``local.xml``test`

# gnome - 在没有 GNOME 的情况下使用 glib gio GVolumeMonitor

> ID：13040138
> 
> 赞同：2
> 
> 时间：2012-10-23T22:11:33.127
> 
> 标签：gnome, system-calls, glib, gio

我对 glib / gio GVolumeMonitor 有疑问。当我运行这段代码

```
g_type_init();
GVolumeMonitor *vmon = g_volume_monitor_get();
GList *drives = g_volume_monitor_get_connected_drives(vmon);
printf("DRIVES: %p\n", drives); 
```

在 gnome 中我得到一个有效的条目。

在 gnome 之外（例如在没有 gnome 会话的终端中）我得到一个 NIL。

有没有人提示如何正确使用 GVolumeMonitor？也许 gio 需要初始化，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:52:33.353

你需要 dbus 和 gvfsd。要对其进行测试，您可以在 TTY 中尝试以下操作：

```
$ dbus-launch screen
$ ipython
>>> import gio
>>> vmon = gio.volume_monitor_get()
>>> vmon.get_connected_drives()
[...] 
```

# c++ - c++11中的命名空间问题？

> ID：13040139
> 
> 赞同：8
> 
> 时间：2012-10-23T22:11:38.673
> 
> 标签：c++, gcc, c++11, glibc

有人可以解释以下内容：

```
$ cat test.cpp 
#include <string>
std::string div;
$ g++ -c test.cpp 
$ g++ -std=c++11 -c test.cpp 
test.cpp:2:13: error: 'std::string div' redeclared as different kind of symbol
In file included from /usr/include/c++/4.7.1/cstdlib:66:0,
                 from /usr/include/c++/4.7.1/ext/string_conversions.h:37,
                 from /usr/include/c++/4.7.1/bits/basic_string.h:2814,
                 from /usr/include/c++/4.7.1/string:54,
                 from test.cpp:1:
/usr/include/stdlib.h:787:14: error: previous declaration of 'div_t div(int, int)'
$ 
```

对于 C++11 模式，`div`符号不应该也在命名空间中吗？`std`还是我的系统特有的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T22:25:30.383

> /usr/include/stdlib.h

C stdlib 标头中的每个名称都`.h`驻留在全局命名空间中（显然）。

此外，任何C++ stdlib 标头都将在命名空间中`cHEADER`定义相应的名称，但也允许将它们放在全局命名空间中（所以他们可以这样做`HEADER.h``std`

```
// cHEADER
#include <HEADER.h>

namespace std{
using ::one_name_from_HEADER;
using ::another_name_from_HEADER;
// and so on...
} 
```

并完成它）。

`§D.5 [depr.c.headers]`

> p2 每个 C 标头，每个都有一个名为 form 的名称，其`name.h`行为就好像每个由相应`cname`标头放置在标准库命名空间中的名称都放置在全局命名空间范围内一样。未指定这些名称是否首先在命名空间 std 的命名空间范围 (3.3.6) 内声明或定义，然后通过显式使用声明 (7.3.3) 注入全局命名空间范围。
> 
> p3 [*示例：*标头`<cstdlib>`确实在命名空间 std 中提供了它的声明和定义。它还可以在全局命名空间中提供这些名称。头文件`<stdlib.h>`在全局命名空间中确实提供了相同的声明和定义，就像在 C 标准中一样。它还可以在命名空间 std 中提供这些名称。*—结束示例*]

如您所见，反过来也是如此 (`<HEADER.h>`可能会在命名空间中引入名称`std`，就好像

```
// HEADER.h
#include <cHEADER>

using std::one_name_from_HEADER;
using std::another_name_from_HEADER;
// and so on...
} 
```

)，这使得这些标头之间的整个区别相当...无用，真的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T22:21:50.067

`div`是来自 的函数`<stdlib.h>`。

在 C++11 中，`<c`*blah*`>`头文件被允许在全局命名空间中放置东西。

> C++11 **§17.6.1.2/4**：
> “除了第 18 到 30 条和附件 D 中的说明外，每个头文件的内容应与C 标准库 (1.2) 中规定的相应头文件的内容相同或 C Unicode TR，视情况而定，就好像通过包含一样。然而，在 C++ 标准库中，声明（在 C 中定义为宏的名称除外）在 namespace 的命名空间范围 (3.3.6) 内。*未指定这些名称是否首先在全局命名空间范围内声明，然后通过显式using 声明*(7.3.3)注入命名空间 std 。”`c*name*``*name*.h``std`

 *反映常见 C++ 实现的现实。

因此，除了正式的情况外，实际上没有任何改变：您看到的行为现在受到标准的认可，而不是成为必须考虑的实现工件。

此外，正式的更改更容易争论 SO 应该更好地包含`.h`标头而不是`c`*xxx*标头......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T22:54:02.387

17.6.4.3.3/1 规定：

> 在标头中声明为具有外部链接的对象的每个名称都保留给实现以指定具有外部链接的库对象，在名称空间和全局名称空间中均为^(182 。)`std`

`div`是在头文件 cstdlib 中声明为具有外部链接的函数的名称，因此是全局命名空间中的保留名称。你不能使用这个名字。*

# java - Java 6 中对 ISO 8601 格式的通用支持

> ID：13040143
> 
> 赞同：8
> 
> 时间：2012-10-23T22:11:53.750
> 
> 标签：java, regex, date, simpledateformat, java-6

Java 7 通过字符（而不是小写或大写）在类中引入了`SimpleDateFormat`对 ISO 8601 格式的支持。在 Java 6 中支持这种格式需要预处理，所以最好的方法就是问题。`X``Z`

这种新格式是`Z`（大写 Z）的超集，还有 2 个附加变体：

1.  “分钟”字段是可选的（即，2 位而不是 4 位时区是有效的）
2.  冒号字符 (':') 可用于将 2 位数“小时”字段与 2 位数“分钟”字段分开）。

因此，从[Java 7 的文档中`SimpleDateFormat`](http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html)可以看出，以下 3 种格式现在是有效的（而不仅仅是`Z`Java 6 中涵盖的第二种格式），当然，它们是等效的：

1.  -08
2.  -0800
3.  -08:00

正如[前面](https://stackoverflow.com/questions/10614771/java-simpledateformat-pattern-for-w3c-xml-dates-with-timezone)关于支持这种“扩展”时区格式的特殊情况（始终使用“：”作为分隔符）的问题中所讨论的，将 Java 7 功能反向移植到 Java 6 的最佳方法是子类化`SimpleDateformat`该类并覆盖其`parse()`方法， IE：

```
public Date parse(String date, ParsePosition pos)
{
    String iso = ... // Replace the X with a Z timezone string, using a regex

    if (iso.length() == date.length())
    {
        return null; // Not an ISO 8601 date
    }

    Date parsed = super.parse(iso, pos);

    if (parsed != null)
    {
        pos.setIndex(pos.getIndex()+1); // Adjust for ':'
    }

    return parsed;
} 
```

请注意，`SimpleDateFormat`上面的子类对象必须使用相应`Z`的基于模式进行初始化，即如果子类是`ExtendedSimpleDateformat`并且您想要解析符合模式的日期`yyyy-MM-dd'T'HH:mm:ssX`，那么您应该使用实例化为的对象

```
new ExtendedSimpleDateFormat("yyyy-MM-dd'T'HH:mm:ssZ"); 
```

在上述[较早的问题](https://stackoverflow.com/questions/10614771/java-simpledateformat-pattern-for-w3c-xml-dates-with-timezone)中，建议使用正则表达式`:(?=[0-9]{2}$)`来删除“：”，并且在[类似的问题](https://stackoverflow.com/questions/12951875/parsing-java-dates-with-truncated-timezone-information)中，建议使用正则表达式`(?<=[+-]\d{2})$`在需要时将“分钟”字段附加为`00`。

显然，成功运行 2 个替换可用于实现全部功能。因此，`iso`覆盖`parse()`方法中的局部变量将设置为

```
iso = date.replaceFirst(":(?=[0-9]{2}$)",""); 
```

或者

```
iso = iso.replaceFirst("(?<=[+-]\\d{2})$", "00"); 
```

在两者之间进行`if`检查，以确保`pos`稍后也正确设置了该值，并且也用于`length()`较早的比较。

问题是：我们是否可以使用**单个正则表达式**来实现相同的效果，包括不需要检查长度和`pos`稍后正确设置几行所需的信息？

该实现适用于读取大量可以采用任何格式（甚至完全非日期）的字符串字段的代码，仅选择符合格式并返回已解析的 Java`Date`对象的代码。

因此，**准确性**和**速度**都至关重要（即，如果使用 2 次传球速度更快，则这种方法更可取）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-05T22:33:43.787

似乎你可以使用这个：

```
import java.util.Calendar;
import javax.xml.bind.DatatypeConverter;

public class TestISO8601 {
    public static void main(String[] args) {
        parse("2012-10-01T19:30:00+02:00"); // UTC+2
        parse("2012-10-01T19:30:00Z");      // UTC
        parse("2012-10-01T19:30:00");       // Local
    }
    public static Date parse(final String str) {
        Calendar c = DatatypeConverter.parseDateTime(str);
        System.out.println(str + "\t" + (c.getTime().getTime()/1000));
        return c.getTime();
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-08-25T13:29:47.387

您可以在 Java 6 中使用 java.time，这是现代 Java 日期和时间 API。在我看来，这似乎是一个不错且面向未来的解决方案。它对 ISO 8601 有很好的支持。

```
import org.threeten.bp.OffsetDateTime;
import org.threeten.bp.format.DateTimeFormatter;

public class DemoIso8601Offsets {
    public static void main(String[] args) {
        System.out.println(OffsetDateTime.parse("2012-10-01T19:30:00+0200", 
                DateTimeFormatter.ofPattern("uuuu-MM-dd'T'HH:mm:ssXX")));
        System.out.println(OffsetDateTime.parse("2012-10-01T19:30:00+02", 
                DateTimeFormatter.ofPattern("uuuu-MM-dd'T'HH:mm:ssX")));
        System.out.println(OffsetDateTime.parse("2012-10-01T19:30:00+02:00"));
        System.out.println(OffsetDateTime.parse("2012-10-01T19:30:00Z"));
    }
} 
```

该程序的输出是：

> ```
> 2012-10-01T19:30+02:00
> 2012-10-01T19:30+02:00
> 2012-10-01T19:30+02:00
> 2012-10-01T19:30Z 
> ```

它要求您将 ThreeTen Backport 库添加到您的项目设置中。

*   在 Java 8 及更高版本以及更新的 Android 设备（从 API 级别 26 开始）中，现代 API 是内置的。
*   在 Java 6 和 7 中获得 ThreeTen Backport，即新类的后向端口（对于 JSR 310，ThreeTen；请参阅底部的链接）。
*   在（较旧的）Android 上使用 ThreeTen Backport 的 Android 版本。它被称为 ThreeTenABP。并确保从`org.threeten.bp`子包中导入日期和时间类。

正如您从代码中看到的那样，`+02`需要`+0200`一个格式化程序，您可以在其中指定偏移量的格式，而`+02:00`（`Z`也）符合默认格式并且不需要指定。

## 我们可以使用相同的格式化程序解析所有偏移格式吗？

读取混合数据时，您不想专门处理每种偏移格式。最好在格式模式字符串中使用可选部分：

```
 DateTimeFormatter allInOne 
            = DateTimeFormatter.ofPattern("uuuu-MM-dd'T'HH:mm:ss[XXX][XX][X]");
    System.out.println(OffsetDateTime.parse("2012-10-01T19:30:00+0200", allInOne));
    System.out.println(OffsetDateTime.parse("2012-10-01T19:30:00+02", allInOne));
    System.out.println(OffsetDateTime.parse("2012-10-01T19:30:00+02:00", allInOne));
    System.out.println(OffsetDateTime.parse("2012-10-01T19:30:00Z", allInOne)); 
```

输出与上面相同。中的方括号`[XXX][XX][X]`表示 format`+02:00`或`+0200`可能`+02`存在。

## 链接

*   [Oracle 教程：日期时间](https://docs.oracle.com/javase/tutorial/datetime/)解释如何使用`java.time`.
*   [Java 规范请求 (JSR) 310](https://jcp.org/en/jsr/detail?id=310)，`java.time`第一次描述的地方。
*   [ThreeTen Backport 项目](http://www.threeten.org/threetenbp/)，`java.time`Java 6 和 7 的反向移植（ThreeTen for JSR-310）。
*   [ThreeTenABP](https://github.com/JakeWharton/ThreeTenABP) , ThreeTen Backport 的 Android 版
*   [问题：如何在Android项目中使用ThreeTenABP](https://stackoverflow.com/questions/38922754/how-to-use-threetenabp-in-android-project)，有非常详尽的解释。

# php - 回显收音机或复选框，当它在其中时被调用

> ID：13040148
> 
> 赞同：-1
> 
> 时间：2012-10-23T22:12:25.127
> 
> 标签：php, input, checkbox, radio-button, echo

我只是想问一个关于输入“收音机”和“复选框”的问题。当该字段中有信息时，我如何才能学习如何回显或任何您称之为的仅呼出收音机或复选框。

如果我想制作一个表格并回显

```
 <input type="radio" name="" value=""> 
```

或者

```
<input type="checkbox" name="" value=""> 
```

但我在该字段中只有 2 个输入或 4 个。

例子：

```
2 input

<input type="radio" name="" value="">

<input type="radio" name="" value="">

4

<input type="radio" name="" value="">

<input type="radio" name="" value="">

<input type="radio" name="" value="">

<input type="radio" name="" value=""> 
```

如果我的数据库中有 2 0r 4 个字段，或者我想让它两者都做。

只是问，所以我可以学习。感谢您的帮助，如果我在论坛的错误部分发布此内容，我们深表歉意。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:24:35.700

我不确定我是否理解你的正确，但如果我是正确的，你应该这样称呼它或类似于：

```
 <form action="php.php" method="post">
      <input type="radio" name="radio" id="radio" value="1" />
      <input type="radio" name="radio" id="radio" value="2" />
      <input type="radio" name="radio" id="radio" value="3" />
      <input type="radio" name="radio" id="radio" value="4" />
      <input type="submit" value="submit" />
   </form> 
```

并回应它

```
 if (isset($GET_['radio'])){
        $radio= $GET_['radio'];
        echo $radio;
    } 
```

这将打印选中的收音机的值。

# java - Spring WS 和 MultiThreadedHttpConnectionManager

> ID：13040150
> 
> 赞同：1
> 
> 时间：2012-10-23T22:12:43.033
> 
> 标签：java, multithreading, spring, tomcat7, httpconnection

我在 Spring WS 2.1.0 上有一个 Web 服务。Web 服务在 Tomcat 7 上运行，并使用一种事务方法实现端点，该方法从数据库读取数据并生成不同的报告。Tomcat 7 通过 JServ 协议在 Apache 服务器后面运行。

在通过 Apache JMeter 进行压力测试期间，我得出结论，同时请求是串行处理的。起初我尝试调整数据库连接池（commons-dbcp 和后来的 tomcat-jdbc），但结果是一样的。Endpoint 方法只读取数据，因此没有 read-after-write 或 write-after-read 依赖关系，事务可以并行处理。因此，问题在于 HTTP 连接处理。

经过一番搜索（当然还有谷歌搜索）后，我发现 Spring WS 带有默认的单线程连接管理器（SimpleHttpConnectionManager）。好的做法是将 SimpleHttpConnectionManager 替换为 MultiThreadedHttpConnectionManager。我找到了如下示例代码：

```
<bean id="httpClient" class="org.apache.commons.httpclient.HttpClient">
    <constructor-arg>
        <bean class="org.apache.commons.httpclient.MultiThreadedHttpConnectionManager>
            <property name="maxConnectionsPerHost" value="20"/>
            <property name="maxTotalConnections" value="100"/>
        </bean>
    </constructor-arg>
</bean> 
```

但是这个例子对我来说不是很清楚，因为我不明白 Spring 如何使用 HttpClient （指的是 ID 或自动装配它）。那么在我的情况下，如何将 MultiThreadedHttpConnectionManager 与 Spring 一起使用？我应该在哪里注入这个类的配置实例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T17:50:32.557

您误解了`HttpClient`. 仅在 Spring WS**客户端**模块中用于发起 HTTP 连接，见[*6.2.1.1.1。HTTP 传输*](http://static.springsource.org/spring-ws/site/reference/html/client.html)：

> `WebServiceMessageSender`通过 HTTP 发送消息的接口有两种实现。[...] 替代方案是`CommonsHttpMessageSender`使用 Jakarta Commons HttpClient。

`HttpClient`在服务器端使用 Spring WS 时根本不需要。在这种情况下，它是提供 HTTP（服务器）抽象的 servlet 容器。看看你的Tomcat配置，可能是线程池太小，有些请求排队了？`HttpClient`在这里绝对没有什么可做的。很抱歉，您必须在其他地方寻找问题。

* * *

为了保持答案完整，当您使用 Spring WS 访问其他计算机上的 SOAP 服务时，`HttpClient`应用以下设置：

*   `maxConnectionsPerHost`- 允许多少个并发连接`HttpClient`保持到同一主机（请参阅：`Keep-Alive`标题）？大多数浏览器将与同一主机的并发连接数限制为 2/4/8。`HttpClient`遵循该行为，因此原则上您不能有超过 2/4/8（无论您在此处设置什么）与同一主机的并发连接。

*   `maxTotalConnections`- 像上面一样，但对所有主机都是如此。`HttpClient`如果您要连接到不同服务器上的数百个不同 Web 服务，这是可以保持的打开连接总数

# c#-4.0 - 如何为可选参数设置默认参数值为 null？

> ID：13040164
> 
> 赞同：0
> 
> 时间：2012-10-23T22:14:14.390
> 
> 标签：c#-4.0, parameters, dbnull

所以我有一大段这样的代码：

```
public List<DynamicBusinessObject> GetSearchResultList(Search search, List<CategoryAttribute> listCatAttrib, string sortBy, int startRow, int pageSize, [Optional, DefaultParameterValue("")] string state, [Optional, DefaultParameterValue("")] string condition, [Optional, DefaultParameterValue("")] string manufacturer) 
```

我想知道如何代替默认值“”（空字符串）将其设置为空？尝试使用 DBNull.value 但它不喜欢那样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:16:23.183

使用 = null

```
public List<DynamicBusinessObject> GetSearchResultList(Search search, List<CategoryAttribute> listCatAttrib, string sortBy, int startRow, int pageSize, string state = null, string condition = null, string manufacturer = null) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-09T14:01:36.140

应该可以像这样简单地用 null 替换空字符串：

```
[Optional, DefaultParameterValue(null)] string state 
```

# php - PHP MySQL 用户 ID

> ID：13040166
> 
> 赞同：2
> 
> 时间：2012-10-23T22:14:24.580
> 
> 标签：php, mysql

此代码应该从我的数据库中获取用户 ID，但它返回：资源 ID #6

那么我将如何编写代码以使其返回用户 ID？这是我的代码到目前为止，我知道 mysql_query 已经过时了：

```
<?php
include("login_check.php");
include("dbconnect.php");
mysql_select_db("maxgee_close2");
$username = $_COOKIE['maxgee_me_user']; 
$user_id = mysql_query("select user_id from users where username = '$username'");
echo "$user_id";
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:17:17.413

[从`mysql_query()`文档中：](http://php.net/manual/en/function.mysql-query.php)

> 对于 SELECT、SHOW、DESCRIBE、EXPLAIN 和其他返回结果集的语句，mysql_query() 成功时返回资源，错误时返回 FALSE。
> 
> ...
> 
> 返回的结果资源应该传递给 mysql_fetch_array() 和其他处理结果表的函数，以访问返回的数据。

**tl;dr** mysql_query 返回一个资源，您必须将其传递给另一个函数，例如 mysql_fetch_array()。资源本身不包含您的行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T22:17:46.910

该代码不应该返回 ID，而是返回资源！然后您需要访问该资源中的数据，在此处阅读：[http](http://www.tizag.com/mysqlTutorial/mysqlfetcharray.php) ://www.tizag.com/mysqlTutorial/mysqlfetcharray.php （或者可能是官方 PHP 文档）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-23T22:18:52.120

```
mysql_connect("localhost", "mysql_user", "mysql_password") or 
  die("Could not connect: " . mysql_error());
mysql_select_db("maxgee_close2");
$result = mysql_query("select user_id from users where username = '$username'");
$row = mysql_fetch_array($result);
echo $row['user_id'];    
mysql_free_result($result); 
```

# javascript - QUnit 不会运行测试

> ID：13040167
> 
> 赞同：7
> 
> 时间：2012-10-23T22:14:26.413
> 
> 标签：javascript, unit-testing, qunit, typescript

我刚开始使用 QUnit 并遇到问题。

我目前正在使用 TypeScript，它是一个 JavaScript 编译器。我的测试与我的主要课程的结构平行。

在每个类中，我都有一个名为 runTests() 的函数。

为了执行这些测试，我遍历并获取所有以“Test”结尾的类，然后调用它们的 runTests() 函数。

runTests() 函数的一个示例是：

```
runTests = function() {
  QUnit.test("5 = 5", function() {
    QUnit.ok(5 == 5, "okay");
  });
} 
```

我知道所有的 runTests() 工作（因为它们被称为，由于控制台输出而得到确认），但它最多只向我显示一个测试。它似乎总是最后一个调用的测试（即使在同一个 runTests() 中有多个测试）。

QUnit 自我重置是否有一些奇怪的事情，这就是为什么我只看到一个，还是我错过了更基本的东西？

谢谢。

* * *

我使用的 HTML 在这里，以防万一：

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>QUnit Example</title>
    <link rel="stylesheet" href="qunit-git.css">
</head>
<body>
<div id="qunit"></div>
<script src="qunit-1.10.0.js"></script>
<script src="mycode.js"></script>
<script type="text/javascript">
    function runTest() {
        var testClasses = getClassesRecurse(Test, []);

        function getClassesRecurse(target, testClasses) {
            if (typeof target == 'function' && /Test$/.test(target.name)) {
                testClasses.push(target);
            } else if (typeof target == 'object') {
                for (var i in target) {
                    getClassesRecurse(target[i], testClasses);
                }
            }

            return testClasses;
        }

        for (var i in testClasses) {
            var testObj = new testClasses[i]();

            if (testObj.runTests) {
                console.log('Testing: ' + testClasses[i].name, testObj);
                testObj.runTests();
            }
        }
    }

    runTest();
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-23T22:16:36.460

所以，回答我自己的问题：看起来我在测试中点击了“重新运行”，它只显示了一个测试。删除查询字符串，一切都很好。

给 QUnit 的建议：用大字体添加一条消息：“只运行一个测试，单击此处运行所有测试。” =p

# installation - Restler RC3 安装

> ID：13040171
> 
> 赞同：7
> 
> 时间：2012-10-23T22:14:47.710
> 
> 标签：installation, restler

有没有一种方法可以将 RC3 复制并粘贴到我的主机上，而无需运行“make composer-install”？不幸的是，我的主人很糟糕，不允许这样做。

Restler 2 就像将文件放入目录并进行一些配置更改一样容易安装。情况似乎不再如此。我喜欢 Restler 2，但需要 RC3 中提供的功能。

非常感谢任何见解！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T05:14:12.800

使用 Restler3，是的！你可以这样做，它仍然适用于 JSON 和 XML 格式。`make composer-install`仅对 Plist、Yaml 和 AMF 格式是必需的，因为它们依赖于一些第三方库（您将能够在 composer 的帮助下独立于 Restler 3 自动更新），它还安装了最新版本的[Restler API Explorer](https://github.com/Luracast/Restler-API-Explorer)。

如果您需要这些格式和/或 API Explorer，您可以在您的机器上下载 restler 并在`make composer-install`本地运行（它不需要 Web 服务器），然后将生成的文件夹上传到您的服务器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T04:58:16.553

在本地主机或虚拟主机上安装系统，然后将所有文件传输到您的主机:)

# mysql - 主外键减慢 InnoDB 插入

> ID：13040173
> 
> 赞同：0
> 
> 时间：2012-10-23T22:14:57.200
> 
> 标签：mysql

我正在导入很多（仅约 10,000 名）员工，然后一次将他们全部设为用户帐户。插入我的 user_profile 表会减慢一切，因为表的主键也是外键，而不是通常的自动增量 ID。

有什么办法可以加快这个速度吗？或者我是否需要返回并以某种方式向 user_profile 添加一个自动增量 ID？

编辑：

```
user:
  id
  username
  salt
  password

user_profile:
  user_id -> Primary Key and Foreign Key to user table
  first_name
  last_name
  email
  ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T19:59:58.530

我的建议是向表中添加一个`id`字段`user_profile`，使其成为主键（无符号和 auto_increment）。然后将该字段设为用户 ( ) 表`user_id`的外键。`id`我从未见过一个字段充当另一个表的主键和外键。

# ios - CFBundleURLName 必须与 CFBundleIdentifier 匹配吗？

> ID：13040175
> 
> 赞同：6
> 
> 时间：2012-10-23T22:15:03.047
> 
> 标签：ios, iphone, ipad

如果我希望 iOS App App1 在设备上启动 App2，那么 CFBundleURLName 是否需要匹配 Info.plist 中 CFBundleURLTypes 中的 CFBundleIdentifier？

例如，如果我在 App1

```
<key>CFBundleIdentifier</key>
<string>com.foo.App1</string>
...
<key>CFBundleURLTypes</key>
<array>
<key>CFBundleURLTypes</key>
<array>
    <dict>
        <key>CFBundleURLSchemes</key>
        <array>
            <string>fooscheme</string>
        </array>
        <key>CFBundleURLName</key>
        <string>com.foo.App1</string>
    </dict>
</array> 
```

在上述情况下，App2 可以在 App1 中启动“fooscheme:”url。但是，如果我将 App1 的 Info.plist 更改为包含

```
<key>CFBundleURLTypes</key>
<array>
    <dict>
        <key>CFBundleURLSchemes</key>
        <array>
            <string>fooscheme</string>
        </array>
        <key>CFBundleURLName</key>
        <string>com.foo.xyz</string>
    </dict>
</array> 
```

即，CFBundleURLName != CFBundleIdentifier，则 App2 不能再在 App1 中启动“fooscheme:”url。

任何想法为什么？

我没有看到任何 CFBundleIdentifier 必须匹配 CFBundleURLName 的 Apple 文档，但在实践中似乎就是这种情况。还是我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T13:37:22.837

不，这两个属性不需要匹配，我没有像你那样遇到问题，我的应用标识符 -`CFBundleIdentifier`设置为**com.djp.myapp**并且 url 方案设置`CFBundleURLName`为nothing.like **。 the.identifier**和一`CFBundleURLSchemes`组**abcd**。

我可以通过调用打开这个应用程序：`abcd://`

我认为可能会给您带来问题的一件事是，如果您在设置 url 方案的情况下运行您的应用程序，并且在测试期间您更改了捆绑标识符 ( `CFBundleIdentifier`)，因此实际上导致系统中存在 2 个应用程序。在这种情况下，您将遇到 url 方案冲突，并且 Apple 声明没有任何流程可以确定哪个应用程序优先。

> **注意**：如果多个第三方应用程序注册处理相同的 URL 方案，目前没有确定哪个应用程序将获得该方案的过程。

同样据我测试和体验，如果您有 2 个相互冲突的应用程序，它似乎是第一个安装的应用程序，当这个应用程序被删除时，第二个应用程序现在是唯一支持特定 url 方案的应用程序仍然没有使用。

这表明 url 方案在安装时已在系统中注册，并且需要重新安装此应用程序才能使其按预期在这些方案上工作。

有关 URL 方案的更多信息，请查看[Apple Advances App Tricks](https://developer.apple.com/library/IOs/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW18)文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-09T14:43:32.100

我认为原因是您没有特别指定 CFBundleTypeRole 键，它表明您的应用程序是查看器、编辑器、shell 或其他。自定义 URL 方案中需要此密钥。

注意：当您将其设置为无时，osx 将不会启动您的应用程序。

您可以从这里获取信息[Apple Developer Document](http://developer.apple.com/library/ios/#documentation/general/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html#//apple_ref/doc/uid/TP40009249-DontLinkElementID_49)

# android - 带有左右轨道图像的 Android 自定义 ProgressBar

> ID：13040180
> 
> 赞同：1
> 
> 时间：2012-10-23T22:15:37.483
> 
> 标签：android, android-progressbar

我正在将 iOS 应用程序移植到 Android，iOS 应用程序中的一项功能是自定义 UISlider，它使用左右轨道图像（如下图所示），但到目前为止，我似乎无法在安卓端。

![在此处输入图像描述](../Images/ca03d80ae37025350a75acdb895cc955.png)

从图像中，您可以看到右侧轨道图像使用白色图像，然后左侧轨道图像将是红色或绿色图像（基于人与目标的距离）。下面是 ProgressBar 的 XML（顺便说一下，我似乎无法确定 ProgressBar 或 SeekerBar 是否是这里的最佳选择，因为没有交互，并且条在显示后不会改变，因为它更像是条图像的图形类型）

```
<ProgressBar
            android:id="@+id/MTDMainBar"
            android:indeterminate="true"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:maxHeight="44dip"
            android:minHeight="44dip"
                style="?android:attr/progressBarStyleHorizontal"
                android:max="100"
                android:progress="50"
                android:background="@drawable/whitetrack"
                android:indeterminateDrawable="@drawable/greentrack"/> 
```

但是当我这样做时，绿色轨道图像会填满整个栏，而不仅仅是栏的进度侧。我也尝试了progressDrawable，但得到了相同的结果，所以我对接下来要尝试什么有点迷茫。对于这种行为的正确设置组合有什么帮助吗？

- - -新的信息 - - - - - - -

好的，所以我现在大约一半了，但困扰我的一件事是 ProgressBar 似乎没有填充它在里面的 TableRow 除非我硬编码我知道我不想真的这样做的宽度值Android 设备的屏幕宽度可能会有所不同。

下面是到目前为止我得到的 Android 显示器的屏幕截图 ![在此处输入图像描述](../Images/c6c98162e6e406c9d442688a1be56ddd.png)

下面是我一直在使用的代码

```
//this is the code in the Fragment Class
@Override
public void onActivityCreated (Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    Drawable greentrack = getResources().getDrawable(R.drawable.green_progress_clip);
    greentrack.setLevel(35);

    Drawable whitetrack = getResources().getDrawable(R.drawable.white_progress_clip);
    whitetrack.setLevel(100);

    MTDProgressbar = (ProgressBar)getActivity().findViewById(R.id.MTDMainBar);
    MTDProgressbar.setProgressDrawable(greentrack);
    MTDProgressbar.setProgress(35);
    MTDProgressbar.setMax(100);

    MTDBackgroundbar = (ProgressBar)getActivity().findViewById(R.id.MTDBackgroundBar);
    MTDBackgroundbar.setProgressDrawable(whitetrack);
    MTDBackgroundbar.setProgress(100);
    MTDBackgroundbar.setMax(100);
} 
```

这是我的进度条的 XML 数据

```
<TableRow
            android:id="@+id/MTDRow"
            android:layout_width="match_parent"
              android:layout_height="55dip">
        <RelativeLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent" >
        <ProgressBar
                android:id="@+id/MTDBackgroundBar"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:maxHeight="44dip"
            android:minHeight="44dip"
            android:paddingLeft="10dip"
            style="?android:attr/progressBarStyleHorizontal" />

        <ProgressBar
            android:id="@+id/MTDMainBar"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:paddingLeft="10dip"
            style="?android:attr/progressBarStyleHorizontal"
            android:maxHeight="44dip"
            android:minHeight="44dip"/>

        </RelativeLayout>
              </TableRow> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:21:15.147

我很确定你不能用内置的 UI 元素做到这一点，你必须制作自己的自定义 UI 元素，可能会扩展 ProgressBar。

# java - BufferedReader read(char[], int, int) 被阻塞了？

> ID：13040181
> 
> 赞同：0
> 
> 时间：2012-10-23T22:15:54.687
> 
> 标签：java, bufferedreader

我正在阅读 a `BufferedReader`，它正在包装 a `InputStreamReader`。流来自一个 URL`myURL.openStream();`

我正在尝试将流的一部分（和之间的字符`startPos`）`endPos`读入 a`String`然后将其存储在文本文件中。

```
 char[] buffer = new char[endPos-startPos];
    reader.skip(startPos);
    int i = 0;
    while(i < (endPos-startPos)){
        buffer[i] = (char) reader.read();
        i++;
    } 
```

上面的代码有效，但似乎很慢。我正在尝试使用该`read(char[], int, int)`方法 - 我假设 Java 人员已经更快地实现了它！

但是 - 它通过将所需字符添加到字符串中大约一半然后完成，给我留下一个半满的 char 数组。

根据 Javadoc，它仅在达到 EOF 或“底层流的就绪方法返回 false，表明进一步的输入请求将阻塞”时才会这样做。谁能告诉我这是什么意思？如果一个一个地读取字符可以正常工作，为什么会发生这种情况？（不能是EOF！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T03:23:26.487

它很慢，因为数据到达缓慢。在接收代码中您无能为力。`read(char[] ...)`过早返回，因为在第一次读取阻塞后只有那么多字节到达。如果要读取特定数量的字符，则必须循环，调用`read()`或`read(char[], ...)`. 照原样`BufferedReader`，错误，缓冲，你打电话给哪个没有任何区别。

# selenium - Selenium 和不断变化的前端

> ID：13040185
> 
> 赞同：0
> 
> 时间：2012-10-23T22:16:12.247
> 
> 标签：selenium

我正在运行 Selenium 测试。由于 DOM 更改，测试经常中断，因此我最终不得不进入代码并更改选择器。

还有其他人遇到同样的问题吗？你做了什么来减轻这种头痛（除了删除魔术字符串、使用变量和实现编程模式来测试代码）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T13:12:19.993

heh）我在当前项目中使用以下解决方案：

`selenium-config.properties`我在文件中包含所有定位器 ：

![在此处输入图像描述](../Images/1975f740ac97887e5d447db7fb3c7345.png)

在我的 BaseSeleniumTest.java 我有以下内容：

```
import org.springframework.beans.factory.annotation.Value;
import org.springframework.beans.factory.config.PropertyPlaceholderConfigurer;
import org.springframework.core.io.support.PropertiesLoaderUtils;
....
public class BaseSeleniumTest extends SeleneseTestBase {
    static WebDriver driver;

 @Before
    public void homePageRefresh() throws IOException {
        driver.manage().deleteAllCookies();
//usage example of loading value by key from .properties file
        driver.get(propertyKeysLoader("login.base.url"));
    }

......
......
public String propertyKeysLoader(String key) throws IOException {
        Properties props = PropertiesLoaderUtils.loadAllProperties("selenium-config.properties");
        PropertyPlaceholderConfigurer props2 = new PropertyPlaceholderConfigurer();
        props2.setProperties(props);
        return (String)props.get(key)          ;
    }

} 
```

因此，如果 DOM 发生变化——你只需在 .properties 文件中更改定位器——就是这样。希望它可以帮助你。

# python - 使用 gviz_api.py 的日期格式

> ID：13040186
> 
> 赞同：5
> 
> 时间：2012-10-23T22:16:17.743
> 
> 标签：python, google-visualization

我正在使用 gviz_api (google-visualization-python) 来构建一些折线图。 [http://code.google.com/p/google-visualization-python/](http://code.google.com/p/google-visualization-python/)

我编辑了一个取自谷歌文档的折线图示例。
但是，我不确定如何将日期传递到 DataTable

这是我一直在使用的编辑示例。 [https://gist.github.com/3941946](https://gist.github.com/3941946)

这是我有疑问的代码

```
 # Creating the data
 description = {"year": ("string", "Year"),
             "sales": ("number", "Sales"),
             "expenses": ("number", "Expenses")}

 data = [{"year": '2004', "sales": 1000, "expenses": 300}, 
      {"year": '2005', "sales": 1200, "expenses": 400}, 
      {"year": '2006', "sales": 1300, "expenses": 500}, 
      {"year": '2007', "sales": 1400, "expenses": 600}, 
      {"year": '2008', "sales": 1500, "expenses": 800}]
  # Loading it into gviz_api.DataTable
  data_table = gviz_api.DataTable(description)
  data_table.LoadData(data) 
```

如何使用 gviz_api 将日期加载到 DataTable 中？

谷歌文档描述了如何使用 javascript 创建一个新的 Date()，但是，我想继续使用 gviz_api.py。

**来自[https://developers.google.com/chart/interactive/docs/dev/implementing_data_source#jsondatatable](https://developers.google.com/chart/interactive/docs/dev/implementing_data_source#jsondatatable)**的 google 文档的注释****

 ***JSON 修改 Google 的帮助程序库以及发送给 Google 的所有查询都返回稍微不标准的 JSON/JSONP 版本。如果您不自己解析返回的代码，这对您来说应该无关紧要。可视化 API 客户端支持 JSON 的标准版本和修改版本。以下是差异的摘要：

JSON 不支持 JavaScript 日期值（例如，“new Date(2008,1,28,0,31,26)”；API 实现支持。但是，API 现在支持自定义的有效 JSON 日期表示形式以下格式的字符串： Date(year, month, day[,hour, minute, second[, millisecond]]) 其中 day 之后的所有内容都是可选的，而月份是从零开始的。

JSON 使用双引号作为字典键；API 实现使用不带引号的键。

JSON 需要双引号围绕字符串值；API 实现使用单引号。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T23:15:34.393

您实际上可以像在标准 Python 中一样处理创建日期 - API 为您处理转换为 JS。您所要做的就是`import datetime`在脚本的开头，更改`year`from `string`to的列类型`date`，然后像在标准 Python 中一样创建日期：

```
# This is the first modification - importing the library
import datetime
import gviz_api

# page_template stays the same
# ...

def main():
  # Creating the data
  # Here we change the type of column "year" to "date"
  description = {"year": ("date", "Year"),
                 "sales": ("number", "Sales"),
                 "expenses": ("number", "Expenses")}

  # Here we switch out the string dates with an actual Python datetime.date
  # The conversion happens in the the subsequent functions, giving you a 
  # date that is usable in the JS
  data = [{"year": datetime.date(2007,3,7), "sales": 1000, "expenses": 300},
          {"year": datetime.date(2009,6,11), "sales": 1200, "expenses": 400},
          {"year": datetime.date(2009,3,1), "sales": 1300, "expenses": 500},
          {"year": datetime.date(2010,8,6), "sales": 1401, "expenses": 600},
          {"year": datetime.date(2011,7,13), "sales": 1500, "expenses": 800}]
  # Loading it into gviz_api.DataTable
  data_table = gviz_api.DataTable(description)
  data_table.LoadData(data)

  # Creating a JavaScript code string
  jscode = data_table.ToJSCode("jscode_data",
                               columns_order=("year", "sales", "expenses"),
                               order_by="year")
  # Creating a JSon string
  json = data_table.ToJSon(columns_order=("year", "sales", "expenses"),
                           order_by="year")

  # Putting the JS code and JSon string into the template
  print "Content-type: text/html"
  print
  print page_template % vars()

if __name__ == '__main__':
  main() 
```**

# ios - 输入货币时如何让第一响应者辞职

> ID：13040190
> 
> 赞同：0
> 
> 时间：2012-10-23T22:16:40.687
> 
> 标签：ios, uitextfield, nsnumberformatter, uitextfielddelegate, resignfirstresponder

在输入货币的文本字段中输入美分后，我想让我的文本字段辞职第一响应者。我正在使用`UIKeyboardTypeDecimalPad`，所以只输入数字。当输入小数点后的第二个数字时，我希望文本字段退出第一响应者。

1

12

123

123.4

123.45*现在请辞第一响应者*。

我是否让代表将文本与`*\...`每个`textDidChange`通知的正则表达式进行比较？输入时开始计数`.`？

有没有办法应用`NSNumberFormatter`到`setMaximumFractionDigits:2`文本输入字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:43:47.610

我相信如果您在小数点后 2 位数字后关闭键盘，这将是一个糟糕的用户体验。（也不适用于小数货币，例如日元）。

要像这样关闭键盘，最简单的选择是在用户触摸键盘区域之外时关闭键盘。你可以通过在键盘后面的视图上应用“UITapGestureRecognizer”来做到这一点，然后在键盘关闭时将其移除。

# unix - 多行 grep 命令（不是多行 grep）

> ID：13040193
> 
> 赞同：0
> 
> 时间：2012-10-23T22:16:57.400
> 
> 标签：unix, grep

试图弄清楚如何跨多行编写命令，因为真正的命令是很长的提示符（4200个字符），所以我尝试了这个例子：

制作了一个包含以下 3 行的测试文件：

`some thing`
`some`
`thing`

当我这样做时：
`grep "some thing" test`

我得到了预期的结果：
`some thing`

但是当我做这个 grep 时：
`grep "some \`
`thing" test`

我得到了意想不到的结果：
`some thing`
`thing`

几乎就好像它运行了两次 grep，一次用于“some”，一次用于“thing”。有什么方法可以正确使用`\`将 2 组合到结果类似于第一个 grep 的位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T22:25:17.577

而不是**grep**，您必须使用**pcregrep**，然后您将能够通过**-M**选项在模式中使用新行。

在您的示例中，它将类似于：

```
pcregrep -M 'some\nthing' test 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-12T19:30:09.687

使用 -zPo 你可以使 grep 表现多语言：

```
grep -zPo 'some\nthing' test 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T15:05:48.200

所以看起来是这样的：
`grep "some \`
`|thing" test.txt`

出品：`some thing`

如同：`grep "some thing" test.txt`

# java - Java Swing：自己创建的可调整大小的 GUI 中的 NullPointerException

> ID：13040197
> 
> 赞同：1
> 
> 时间：2012-10-23T22:17:26.527
> 
> 标签：java, swing, nullpointerexception

首先，我知道使用`setLayout(null)`不是最好的方法，但该程序的目标是尝试编写一个我自己可调整大小的 GUI。

首先是三个类（拆分的原因`GroundFrame.java`是`HomeScreen.java`以后会有多个windows）：

**启动.java**

```
public class Start {

    public static void main(String[] arg){
        new GroundFrame();  
    }
} 
```

**GroundFrame.java**

```
public class GroundFrame extends JFrame{

    static final long       serialVersionUID = 0;
    Container               contentPane;
    HomeScreen              homeScreen;

    public GroundFrame(){
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                createAndShowGUI();
            }
        });
    }

    private void createAndShowGUI(){
        createBasicFrame();
        createPaneAndAddHome();
        setVisible(true);
    }

    private void createBasicFrame(){
        addComponentListener(new ComponentListener() {
            public void componentShown(ComponentEvent e) {}
            public void componentResized(ComponentEvent e) {
                homeScreen.resizeHome(getContentPane().getSize());
            }
            public void componentMoved(ComponentEvent e) {}
            public void componentHidden(ComponentEvent e) {}
        });

        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        contentPane = getContentPane();
        contentPane.setPreferredSize(new Dimension(600, 400));
        contentPane.setLayout(null);
        pack();
    }

    private void createPaneAndAddHome(){
        homeScreen = new HomeScreen(contentPane.getSize());
        contentPane.add(homeScreen);
    }
} 
```

**HomeScreen.java**

```
public class HomeScreen extends JPanel{

    static final long       serialVersionUID = 0;
    private JLabel          labelHeader, labelFooter;
    private JTextField      textField;
    private int             x, y;

    public HomeScreen(final Dimension dimension){
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                createAndShowPanel(dimension);
            }
        });
    }

    private void createAndShowPanel(Dimension dimension){
        labelHeader = new JLabel("HEADER");
        textField = new JTextField();
        labelFooter = new JLabel("FOOTER");
        setupPanel(dimension);
    }

    private void setupPanel(Dimension dimension){
        x = dimension.width;
        y = dimension.height;
        setBounds(0,0,x,y);
        setLayout(null);
        setupTitle(new Dimension(x,y));
    }

    private void setupTitle(Dimension dimension){
        x = dimension.width;
        y = dimension.height;
        labelHeader.setBounds((int)(x*0.1), (int)(y*0.1), (int)(x*0.8), (int)(y*0.3));
        labelHeader.setOpaque(true);
        labelHeader.setBackground(Color.cyan);
        labelHeader.setFont(new Font("Arial", Font.PLAIN, (int)(y*0.25)));

        textField.setBounds((int)(x*0.25), (int)(y*0.45), (int)(x*0.5), (int)(y*0.1));
        textField.setFont(new Font("Arial", Font.PLAIN, (int)(y*0.08)));

        labelFooter.setBounds((int)(x*0.1), (int)(y*0.6), (int)(x*0.8), (int)(y*0.3));
        labelFooter.setOpaque(true);
        labelFooter.setBackground(Color.cyan);
        labelFooter.setFont(new Font("Arial", Font.PLAIN, (int)(y*0.25)));

        add(labelHeader);
        add(labelFooter);
        add(textField);
    }

    public void resizeHome(Dimension dimension){
        setupPanel(dimension);
    }
} 
```

现在一切都按照我的想法进行，但我得到了一个`NullpointerException`后续行`HomeScreen.java`

```
labelHeader.setBounds((int)(x*0.1), (int)(y*0.1), (int)(x*0.8), (int)(y*0.3)); 
```

这是错误信息

```
Exception in thread "AWT-EventQueue-0" java.lang.NullPointerException
    at gui.HomeScreen.setupTitle(HomeScreen.java:45)
    at gui.HomeScreen.setupPanel(HomeScreen.java:39)
    at gui.HomeScreen.resizeHome(HomeScreen.java:64)
    at gui.GroundFrame$2.componentResized(GroundFrame.java:43)
    at java.awt.AWTEventMulticaster.componentResized(AWTEventMulticaster.java:159)
    at java.awt.Component.processComponentEvent(Component.java:6331)
    at java.awt.Component.processEvent(Component.java:6285)
    at java.awt.Container.processEvent(Container.java:2229)
    at java.awt.Window.processEvent(Window.java:2022)
    at java.awt.Component.dispatchEventImpl(Component.java:4861)
    at java.awt.Container.dispatchEventImpl(Container.java:2287)
    at java.awt.Window.dispatchEventImpl(Window.java:2719)
    at java.awt.Component.dispatchEvent(Component.java:4687)
    at java.awt.EventQueue.dispatchEventImpl(EventQueue.java:703)
    at java.awt.EventQueue.access$000(EventQueue.java:102)
    at java.awt.EventQueue$3.run(EventQueue.java:662)
    at java.awt.EventQueue$3.run(EventQueue.java:660)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:87)
    at java.awt.EventQueue$4.run(EventQueue.java:676)
    at java.awt.EventQueue$4.run(EventQueue.java:674)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(ProtectionDomain.java:76)
    at java.awt.EventQueue.dispatchEvent(EventQueue.java:673)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(EventDispatchThread.java:244)
    at java.awt.EventDispatchThread.pumpEventsForFilter(EventDispatchThread.java:163)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(EventDispatchThread.java:151)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:147)
    at java.awt.EventDispatchThread.pumpEvents(EventDispatchThread.java:139)
    at java.awt.EventDispatchThread.run(EventDispatchThread.java:97) 
```

尽管如此，程序继续运行，什么也没发生。毕竟，错误是在程序启动时出现的，因此在没有执行手动调整大小的地方（错误消息表明错误是从`HomeScreen`s中调用的`resizeHome()`）。为什么会这样？为什么程序继续运行？GUI 本身的构建是否可能是`ComponentListener`s的第一次调用`componentResized()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T22:30:41.643

这是因为您`SwingUtilities#invokeLater`在构造函数中使用

```
SwingUtilities.invokeLater(new Runnable() {
    public void run() {
        createAndShowGUI();
    }
}); 
```

您创建的是 UI 中的竞争条件。

基本上，`homeScreen.resizeHome`在被调用`componentResized`之前（从）`HomeScreen#createAndShowPanel`被调用，因此意味着`lablelHeader`尚未被初始化......

您当前的事件顺序看起来像...

*   主要的
*   `new GrounFrame()`
*   `invokeLater` `GroundFrame#createAndShowGUI`
*   ...（返回主目录）
*   `GroundFrame#createBasicFrame`(加`ComponentListener`, `pack`)
*   `GroundFrame#createPaneAndAddHome`
*   `new HomeScreen`
*   `invokeLater` `HomeScreen#createAndShowPanel`...立即返回...
*   `GrounFrame#setVisible(true)`
*   `GrounFrame#ComponentListener#componentResized`
*   `HomeScreen#resizeHome`
*   `HomeScreen#setupPanel`
*   `Null Pointer Exception`
*   `HomeScreen#createAndShowPanel`

您应该将您的 UI 与您的 EDT 同步`main`

```
public static void main(String[] args) {
    SwingUtilities.invokeLater(new Runnable() {
        public void run() {
            new GroundFrame();
        }
    });
} 
```

并删除其他引用`SwingUtilities#invokeLater`

# r - 我如何计算没有异常值的组的平均值？

> ID：13040199
> 
> 赞同：-2
> 
> 时间：2012-10-23T22:17:30.250
> 
> 标签：r

我有两组数据，例如

```
> data.frame(group=rep(1:2,each=4),value=c(102,104,107,45,204,199,217,77))

  group value
1     1   102
2     1   104
3     1   107
4     1    45
5     2   204
6     2   199
7     2   217
8     2    77 
```

我想获得没有异常值的两组的平均值（值> 50的第1组平均值和值> 100的第2组平均值）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:59:00.883

获取数据：

```
test <- data.frame(group=rep(1:2,each=4),value=c(102,104,107,45,204,199,217,77)) 
```

一个相当可扩展的解决方案，使用`by`and `switch`：

```
by(test,test$group,
    function(x) {
        switch(
            x$group[1],
            #group 1
            mean(x$value[x$value > 50]),
            #group 2
            mean(x$value[x$value > 100])
        )
    }
) 
```

结果：

```
test$group: 1
[1] 104.3333
------------------------------------------------------------ 
test$group: 2
[1] 206.6667 
```

# javascript - 玉空白去除

> ID：13040200
> 
> 赞同：1
> 
> 时间：2012-10-23T22:17:34.607
> 
> 标签：javascript, html, pug

**玉**

```
 .foo
 .foo 
```

**结果**

```
 <div class="foo"></div>
 <div class="foo"></div> 
```

**期望的结果**

```
 <div class="foo"></div><div class="foo"></div> 
```

在haml中，我会做类似的事情，`.foo><`但这在jade中不起作用。我已经搜索并空手而归，如何处理这个问题。我如何达到预期的效果？我正在为玉使用 codekit。谢谢各位！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T22:29:43.850

将选项设置`pretty`为`false`，取决于您如何将翡翠应用于源文件。应该`false`默认吗？

# c# - 小数，javascript vs C#

> ID：13040204
> 
> 赞同：12
> 
> 时间：2012-10-23T22:18:13.033
> 
> 标签：c#, javascript, decimal, data-conversion

我正在尝试将 JavaScript 散列函数转换为 C# 散列以执行完全相同的操作。我在那里 99%，但我遇到了这个自定义函数中使用的小数的障碍。
不知道为什么，但是这个函数出于某种奇怪的原因将散列值转换为小数，我的问题是生成的小数并不总是相同的长度。C# 中的小数点要长一些，但长度一致。我遇到的问题是因为 C# 中的舍入与 JavaScript 的工作方式不同，我不确切知道要舍入多少小数来创建等效长度的字符串。

这是两个生成的十进制字符串相互附加的示例。都从 4,4 和 3 个字符串开始：

```
4 char 字符串生成 79957.88183577501
4个字符字符串生成160933.02806113224
3 char 字符串生成 609.9111294990053

```

使用完全相同的代码 C# 使用完全相同的输入生成：

```
79957.88183577500452161331162
160933.02806113221197323204919
609.91112949900524507144149035

```

如果所有字符串的长度相同，那将不是问题，但我不知道如何确定 JS 何时会生成更长的小数。有什么线索吗？注释？意见？

不幸的是，接收代码仍然是原始 JS，它只是简单地反转了过程，因此我必须为所有输入完美地复制最终结果。

编辑：

这是有问题的部分。不要问我为什么会这样，不是我写的。

```
// oString is a full string to be encoded
// oKey is a key to be used for encoding
function completeHash(oString,oKey) {
    if( oKey.length < 5 ) {
        window.alert( 'The key must be at least 5 characters long' );
        return oString;
    }
    var oKeyNum = new Array(), oOutStr = '', oOp = new Array('+=','/=','-=','*= 0.01 *');
    for (var x = 0; x < oKey.length; x++) {
        oKeyNum[x] = parseInt('0x' + completeEscape(oKey.charAt(x)));
    }

    for( var x = 0, y = ''; x < oString.length; x += Math.round( oKey.length / 2 ), y = 'O.O' ) {
        var theNum = parseInt( '0x' + completeEscape( oString.substr( x, Math.round( oKey.length / 2 ) ) ) );

        // next two lines are problematic with decimals not having equal length
        for( var z = 0; z < oKey.length; z++ ) {
            eval( 'theNum ' + oOp[z % 4] + ' ' + oKeyNum[z] + ';' );
            alert('theNum:' + theNum);
        }

        oOutStr += y + theNum;
    }
    return oOutStr;
} 
```

`completeEscape()`函数只返回每个字符的 ASCII int 代码。

除了小数的长度外，我让整个事情运行良好。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T08:01:29.697

如果您`Number`在 javascript 中使用，则`double`在 C# 中使用。两者都是 64 位 IEEE 754 数字（双精度）。您得到相同的值（验证后更新）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T04:28:16.647

我认为您的问题与双精度十进制数的 javascript 限制有关。这为您提供了大约 16 位的精度。您将需要考虑使用基于字符串的解决方法。可以在此处找到其他详细信息，包括解决方法[如何在 Firefox/IE7 中处理大于 17 位的数字？](https://stackoverflow.com/questions/1086575/how-can-i-handle-numbers-bigger-than-17-digits-in-firefox-ie7)

# r - 如何使用列表/向量元素作为 R 中函数的对象参数？

> ID：13040206
> 
> 赞同：5
> 
> 时间：2012-10-23T22:18:22.850
> 
> 标签：r, call, expression, eval

我以编程方式评估了几个模型，它们的名称在 vector 中`models`。然后，我怎样才能将函数`mtable`与它们一起使用，以编程方式调用它们？

这是一个例子：

```
library(memisc)
a <- rnorm(100,0,1)
b <- rnorm(100,0,1)
c <- rnorm(100,0,1)
d <- rnorm(100,0,1)
mod1 <- lm(a ~ b)
mod2 <- lm(c ~ d)
models <- c("mod1", "mod2")
mtable(mget(models,envir=globalenv())) 
```

然后我得到一个错误：`"no method available for 'getSummary' for an object of class 'list'"`。

我能做些什么？我试过`call`但`do.call`没有成功。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T22:26:37.097

没有`mget()`：

```
do.call(mtable, lapply(models, as.symbol)) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T22:23:49.973

使用`do.call`：

```
do.call(mtable, mget(models,envir=globalenv())) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T19:04:51.757

其他答案对我也有帮助，但焦点乔尔的特定例子掩盖了我通过实验发现的一般观点。是这样的：

给定一个接受可变数量参数的函数：

```
fvar <- function(...) {do something} 
```

假设您要传递的参数已经包含在一个列表中：

```
myargs <- list(a=1:3, b=c(2, 3, 4)) 
```

您可以单独传递它们，例如：

```
fvar(myargs[[1]], myargs[[2]]) 
```

但这只有在您的代码知道列表的结构时才有效。

`do.call()`允许您将列表中的任何内容作为给函数的一系列参数传递：

```
do.call(fvar, myargs) 
```

这是更通用的，因为您的代码不必弄清楚列表的特定结构是什么，只要您可以假设它适合该函数即可。

（顺便说一下，`do.call`与 Common Lisp 的基本相同`apply`。）

# java - 如何为带有图标的java程序制作exe

> ID：13040207
> 
> 赞同：2
> 
> 时间：2012-10-23T22:18:24.230
> 
> 标签：java, icons, exe

我制作了一个不错的 Java 小文件。我确信我已经将它开发到了我可以编码的最大程度。所以，我在想，Minecraft 是用 java 编写的，它有一个 exe，而不是 jar 的快捷方式（我就是这样做的......），那么我该如何为我的程序制作一个 exe？另外，我有一个图标，我将它放入垃圾箱并运行程序，它就可以工作了。我现在会把它放在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:26:14.820

我以前做过这个，效果不是很好。但这是一个开始为自己弄清楚的好地方：[http ://www.excelsior-usa.com/articles/java-to-exe.html](http://www.excelsior-usa.com/articles/java-to-exe.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:30:35.850

看看[Launch4J](http://sourceforge.net/projects/launch4j/)，这是我用来制作`.exe`Java`.jar`安装程序的工具。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:40:21.393

就个人而言，我使用[exe4j](http://www.ej-technologies.com/products/exe4j/overview.html)，它不是免费的，但它会做你想做的事。

大多数这种性质的可执行文件只是代表您调用 Java 的某种包装器。

# android - 为动态创建的 TextView 定义 OnClickListener 方法

> ID：13040210
> 
> 赞同：0
> 
> 时间：2012-10-23T22:18:35.150
> 
> 标签：android, touch-event, onclicklistener

我在我的 GUI 中动态创建了新的 TextViews，并将它们收集在一个 TextViews 数组中，但我无法设置 OnClickListeners（它们在一个数组内）......

所以我现在要做的是评估是否单击 TextView 并处理该事件，但我不知道该怎么做......

如果我不想澄清，请告诉我，这样我就可以写下所有细节的问题......

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:24:58.407

所以你的 TextViews 在一个数组中，比如`TextView[] textViews`？

只要打电话`textViews[0].setOnClickListener()`。

如果您使用 ArrayList，那么它将是`textViews.get(0).setOnClickListener()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:26:11.503

即使在动态创建行时，您仍然可以引用 TextView。只需将 OnClickListener 添加到此引用中，如下所示：

```
TextView tv1 = new TextView(this);
tv1.setText(string);
tv1.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.WRAP_CONTENT));
tv1.setOnClickListener(new OnClickListener() {
    public void onClick(View view) {
        // Do something
    }
});
row.addView(tv1); 
```

# c++ - 错误“xxxx”没有命名类型

> ID：13040212
> 
> 赞同：13
> 
> 时间：2012-10-23T22:18:46.650
> 
> 标签：c++, types

尝试编译以下代码时遇到问题：

```
#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
#include <map>

using namespace std;

map<char, int> mapDial;

mapDial['A'] = 2;

int main()
{

  cout << mapDial['A'] << endl;
  return 0;
} 
```

编译器给了我一个错误：“mapDial”没有命名类型错误。我是 C++ 新手，真的不知道这里发生了什么。这里有人可以帮我解决这个问题吗？谢谢！！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-23T22:21:12.843

您不能在全局范围内执行任意表达式，因此

```
mapDial['A'] = 2; 
```

是非法的。如果你有 C++11，你可以做

```
map<char, int> mapDial {
    { 'A', 2 }
}; 
```

但如果你不这样做，你将不得不调用一个初始化函数`main`来设置你想要的方式。您还可以查看`map`带有迭代器的构造函数，并将其与函数中的数组一起使用来初始化映射，例如

```
map<char, int> initMap() {
    static std::pair<char, int> data[] = {
        std::pair<char, int>('A', 2)
    };

    return map<char, int>(data, data + sizeof(data) / sizeof(*data));
}

map<char, int> mapDial = initMap(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-24T00:19:06.230

在全局范围内声明变量时，您只能进行初始化。例如，

```
int a = 0; 
```

你不能做正常的陈述，比如：

```
a = 9; 
```

所以我会修复代码：

```
#include <iostream>
#include <cstdio>
#include <cstring>
#include <algorithm>
#include <map>

using namespace std;

map<char, int> mapDial;

int main()
{
  mapDial['A'] = 2;
  cout << mapDial['A'] << endl;
  return 0;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-23T22:22:31.300

你不能有像`mapDial['A'] = 2;`在全球范围内的陈述。它们必须在函数内部。

# css - CSS 浮点数和嵌套列表

> ID：13040214
> 
> 赞同：0
> 
> 时间：2012-10-23T22:18:50.157
> 
> 标签：css, drop-down-menu

在 CSS 中，我浮动嵌套列表集以创建下拉菜单。但是，标题并不像下拉菜单中的许多项目那么宽，因此标题最终会不成比例地间隔开（因为它们的每个下拉组件都有不同的宽度——显然列表与其最宽的组件一样宽）。有没有人对如何解决这个问题有任何建议？

这是我的代码：

```
<body>

    <ul id="navigation">

     <li><a href="#">Header A</a></li>
     <li class="sub">

      <a href="#">Header B</a>

      <ul>

       <li><a href="#">Item AAAAAAAAAAAA</a></li>
       <li><a href="#">Item BBBBBBBBBBBB</a></li>
       <li><a href="#">Item CCCCCCCCCCCC</a></li>
       <li><a href="#">Item DDDDDDDDDDDD</a></li>
       <li><a href="#">Item EEEEEEEEEEEE</a></li>
      </ul>

     </li>

     <li>
      <a href="#">Header C</a>
     </li>

    </ul>

</body> 
```

这是CSS：

```
 body {

    padding: 0;
    margin: 0;

    }

 #navigation {
 margin: 0;
 padding: 0 1em;
 background: #000;
 height: 3em;
 list-style: none;
 font-family: "Helvetica Neue";
    } 

#navigation > li {
 float: left;
 height: 100%;
 margin-right: 0.5em;
 padding: 0 1em;
}

#navigation > li > a {
 color: #7A7A7A;
 text-decoration: none;
 line-height: 3;
 font-weight: bold;
}

#navigation > li > a:hover {
    color: #FFFFFF;
}

#navigation > li.sub ul {
 margin: 0;
 padding: 0.5em 0;
 list-style: none;
 background: rgba(12,13,69,1);
 position: relative;
 top: 10000px;
}

#navigation > li.sub ul li a {
 height: 100%;
 display: block;
 padding: 0.4em;
 color: #fff;
 font-weight: bold;
 text-decoration: none;
}

#navigation > li.sub ul li a:hover {
 background: #00F2FF;
 text-decoration: none;
}

#navigation > li.sub:hover ul {
 display: block;
 top: 0px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:29:35.340

如果没有看到您的代码，就不可能说出您的具体情况发生了什么。

但这是一个工作示例：http: [//jsfiddle.net/kboucher/nrAPu/](http://jsfiddle.net/kboucher/nrAPu/)

HTML

```
<nav>
    <ul>
        <li>
            Menu One
            <ul>
                <li>
                    <a href="#">Menu One Item One</a>
                    <ul>
                        <li><a href="#">Menu One Item One Submenu Item One</a></li>
                        <li><a href="#">Menu One Item One Submenu Item Two</a></li>
                        <li><a href="#">Menu One Item One Submenu Item Three</a></li>
                        <li><a href="#">Menu One Item One Submenu Item Four</a></li>
                    </ul>
                </li>
                <li><a href="#">Menu One Item Two</a></li>
                <li><a href="#">Menu One Item Three</a></li>
                <li><a href="#">Menu One Item Four</a></li>
            </ul>
        </li>
        <li>
            Menu Two
            <ul>
                <li><a href="#">Menu Two Item One</a></li>
                <li><a href="#">Menu Two Item Two</a></li>
                <li><a href="#">Menu Two Item Three</a></li>
                <li><a href="#">Menu Two Item Four</a></li>
            </ul>
        </li>
    </ul>
</nav> 
```

CSS

```
body { font-family: Helvetica, Arial, Sans-serif; line-height: 1.5em; }
a:hover { color: #cc0000; }

/* Hide submenu */
nav ul > li > ul,
nav ul > li > ul > li > ul { display:none; }

/* Layout menubar and menus */
nav { background:#ddd; padding:0.25em 0.5em; }
nav > ul > li { cursor: pointer; display:inline-block; padding:0 1em; }
nav > ul > li > ul { background: #ddd; padding:0.5em; position: absolute; z-index: 1000; }
nav > ul > li > ul > li > ul { background: #ccc; padding:0.5em; position: absolute; left: 90%; top: 0; z-index: 1001; }

/* show submenu on hover */
nav ul > li:hover > ul,
nav ul > li > ul > li:hover > ul { display:block; width:10em; } 
```

# jquery - 如何修复 Joomla aiContactSafe 上的 Mootools 和 jQuery 冲突

> ID：13040218
> 
> 赞同：0
> 
> 时间：2012-10-23T22:19:26.147
> 
> 标签：jquery, joomla, mootools

**概述**

我有一个安装了[**AiContactSafe**](http://extensions.joomla.org/extensions/contacts-and-feedback/contact-forms/7901)联系表格的 Joomal 2.5 网站。标准`AiContactSafe`的工作`component`方式是，我不能在文章中包含联系表，它在我的网站上占据整个页面。

AiContactSafe 有一个名为[AiContactSafeForm](http://www.algisinfo.com/en/tutorials/aicontactsafe/6-aicontactsafeform.html)的插件，它允许用户使用`{aicontactsafeform pf=3}`. Number`3`是表单的 ID。它的作用是，它使用户能够将表单添加到文章中。这个插件使用 MooTools。

**问题**

只要我的页面上没有 jQuery，它就可以正常工作。当我有 jQuery 时，它与阻止我的网站的 MooTools 库发生冲突。

**问题**

如何修复 jQuery 冲突。我尝试在脚本`$.noConflict()`之后添加到页面顶部，`jQuery.1.8`但这并不能解决它。有没有人遇到过同样的问题？有人可以帮我解决这个问题吗？多谢你们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:47:33.553

尝试通过以下代码添加 noConflict：

```
$document = JFactory::getDocument();
$document->addScript( '[path to jquery]' );
$noconflict = 'jQuery.noConflict();';
$document->addScriptDeclaration( $noconflict ); 
```

# javascript - Backbones 使用原型定义类

> ID：13040221
> 
> 赞同：2
> 
> 时间：2012-10-23T22:19:41.780
> 
> 标签：javascript, backbone.js

查看 Backbones 源代码，我注意到类的定义如下：

`var Model = Backbone.Model = function(...`

为什么 Model 定义了两次我问自己，对 Model 的搜索表明 Model 的原型随后被扩展如下：

`_.extend(Model.prototype, Events, {`

我做了一个小测试，似乎如果'Model.prototype'被扩展，更改会自动影响Backbone.Model，这背后的原因是什么，为什么不写成这样：

```
Backbone.Model = function(...
Backbone.Model.prototype.extend(... 
```

希望这将使我对原型继承的理解更上一层楼

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T22:24:03.773

这只是一个捷径，有一个名为的局部变量`Model`，它比`Backbone.Model`. Javascript没有引用的概念，因此两者都`Model`指向`Backbone.Model`完全相同的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:24:00.623

对象在 JavaScript 中通过引用传递。当您将对象分配给多个变量时，您不会创建对象的副本。

```
var a = {};

var b = a;
a === b // both variables point to (reference) the same object

b.x = 5;
a.x === 5
// updates through one of the variables are thus automatically
// propagated to the other variables that reference the same object. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:25:53.550

因为 Backbone 的`extend`方法正是通过扩展函数原型来完成的。

# c - C 编程复制子字符串

> ID：13040222
> 
> 赞同：0
> 
> 时间：2012-10-23T22:19:47.593
> 
> 标签：c, string, char, substring, strcpy

我试图将子字符串从一个 char* 复制到另一个，当我 printf(%c) 显示字符打印时，但在 add 方法结束时，我使用 printf(%s) 打印整个字符串并且没有打印出来。任何帮助表示赞赏 - 也可能是 C 中的子字符串比 char by char 更好的方法？

下面的代码：

```
int aliasCount;

typedef struct Alias {
  char* alias;
  char* actual;
  struct Alias* next;
}Alias;

Alias* aliasHead;

void addAlias(char* new); 
```

addAlias 方法

```
void addAlias(char* new)
{
  strip(new);
  Alias* newAlias = (Alias*)malloc(sizeof(Alias));

  //Get start-end position for alias
  int start=0; int end=0; int countSpace=0;
  for(int i = 0; i < strlen(new); i++)
  {
    //Check for space
    if(new[i]==' ')
    {
        printf("found space %d\n",i);
        countSpace++;
        if(countSpace==1)
        {
          start=i;
        }
        else if(countSpace==2)
        {
          end=i;
          break;
        }
    }
  }

  //malloc memory
  newAlias->next=NULL;
  newAlias->alias=(char*)malloc(sizeof(char)*(end-start));
  newAlias->actual=(char*)malloc(sizeof(char)*(strlen(new)-end+1));

  //Get substring, 
  //Copy char by char from alias to node
  for(int i = 0; i < strlen(new); i++)
  {
    if(i>start && i<end) //Alias
    {
        newAlias->alias[i] = new[i];printf("'%c'",newAlias->alias[i]);
    }
    else if(i>end) //Actual command
    {
        newAlias->actual[i] = new[i];printf("'%c'",new[i]);
    }
  } 
  printf("%s\n%s\n",newAlias->alias,newAlias->actual);

  if(aliasCount==0)
  {
    aliasHead = newAlias;
  }
  else
  {
      Alias* curr = aliasHead;
      for(int i = 0; i < aliasCount; i++)
      {
        curr=curr->next;
      }
      curr->next = newAlias;
  }
  aliasCount++;
  printf("%s\n%s\n",aliasHead->alias,aliasHead->actual);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:26:28.200

你的指数是错误的；当您实际上需要将其复制到范围 from to 中时，您将范围 from to 复制到范围`new[start+1]`from to中：`new[end-1]``alias[start+1]``alias[end-1]``alias[0]``alias[end-start-2]`

```
 newAlias->alias[i-start-1] = new[i];printf("'%c'",newAlias->alias[i]); 
```

和类似地（*比照*了）`actual`。

# android - 突然我的android应用程序崩溃了

> ID：13040223
> 
> 赞同：0
> 
> 时间：2012-10-23T22:19:49.533
> 
> 标签：android, android-layout

对不起，新手问题。我是 android 新手，正在努力在新应用程序中设置一些登录系统。一切正常（过了很长一段时间），我从主页的菜单中获得了一个登录按钮，这只是一个空的“hello world”默认活动。然后我决定删除“hello world”文本视图，我尝试立即运行它，应用程序因空异常而崩溃。我正在疯狂地按 ctrl+z，但应用程序不断崩溃。我对 LogCat 完全一无所知：

> 10-24 00:10:17.982: I/ActivityManager(59): 开始活动: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] flg=0x10200000 cmp=com.application。 mySoSpecialApplication/.MainActivity } 10-24 00:10:18.002: W/WindowManager(59): HistoryRecord{4505f618 com.application.mySoSpecialApplication/.MainActivity} 未能创建启动窗口 10-24 00:10:18.002: W/WindowManager( 59): java.lang.RuntimeException: Binary XML file line #25: 你必须提供一个 layout_height 属性。10-24 00:10:18.002: W/WindowManager(59): 在 android.content.res.TypedArray.getLayoutDimension(TypedArray.java:491) 10-24 00:10:18.002: W/WindowManager(59): 在android.view.ViewGroup$LayoutParams.setBaseAttributes(ViewGroup.java:3593) 10-24 00:10:18.002: W/WindowManager(59): 在 android.view.ViewGroup$MarginLayoutParams。MainActivity} 10-24 00:10:21.322: I/Process(463): 发送信号。PID: 463 SIG: 9 10-24 00:10:21.352: I/ActivityManager(59): 进程 com.application.mySoSpecialApplication (pid 463) 已经死亡。10-24 00:10:21.383：W/InputManagerService(59)：窗口已经聚焦，忽略焦点增益：com.android.internal.view.IInputMethodClient$Stub$Proxy@44fc1780 10-24 00:10:29.087：W /ActivityManager(59)：HistoryRecord{4505f618 com.application.mySoSpecialApplication/.MainActivity} 的活动销毁超时

也许你们中的一个人会弄清楚问题出在哪里。非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:25:36.400

这里有一些有趣的东西：

W/WindowManager(59)：java.lang.RuntimeException：二进制 XML 文件第 25 行：您必须提供 layout_height 属性。1

您必须在布局视图中指定 layout_height，这是强制性的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:26:13.943

我猜你错过了一个你应该为 some 定义的属性`View`。

`setConentView(R.layout.this_one)`因此，对于膨胀的 XML 布局（我猜是在方法的某个地方膨胀的那个`onCreate()`），只需检查是否缺少`android:layout_height="wrap_content"`. 如果有，请添加。这应该可以解决您的问题。

> 二进制 XML 文件第 25 行：您必须提供 layout_height 属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T02:30:46.170

如果出现运行时错误，请在 logcat 中查找单词 **Caused by :。**这将帮助您轻松定位错误。

在你的情况下 - 看看下面的 logCat ......

```
00:10:18.292: E/AndroidRuntime(463): Caused by: java.lang.NullPointerException 
10-24 00:10:18.292: E/AndroidRuntime(463): at android.content.ContextWrapper.getContentResolver(ContextWrapper.java:90) 
10-24 00:10:18.292: E/AndroidRuntime(463): at com.application.mySoSpecialApplication.mySoSpecialApplicationApplication.(mySoSpecialApplicationApplication.java:14) 
```

**Ypu 会在(mySoSpecialApplicationApplication.java:14)** 的第 14 行发现由**getContentResolver**引起的运行时错误， 所以在这里您成功定位了错误。

 **之后看看**yugidroid**的解释， 这将对你有所帮助。

我猜你错过了你应该为某些视图定义的属性。因此，对于膨胀的 XML 布局（我猜是在 onCreate() 方法的某处设置了 setConentView(R.layout.this_one) 时膨胀的那个），只需检查是否缺少 android:layout_height="wrap_content"。如果有，请添加。这应该可以解决您的问题。二进制 XML 文件第 25 行：您必须提供 layout_height 属性。**

# ios - 我应该开发针对旧版 iOS 的新应用还是使用旧版 Facebook SDK？

> ID：13040225
> 
> 赞同：0
> 
> 时间：2012-10-23T22:20:03.153
> 
> 标签：ios, facebook

我有一个新的 iOS 应用程序，想添加 facebook 集成。出现的一个问题是我们应该坚持使用 Facebook 3.0 还是使用 Facebook 3.1。据我了解，Facebook 3.1 需要 iOS 6（这是正确的吗？）。老实说，如果 20% 的人仍然使用 iOS 5，那么我们最好还是继续使用那个版本。目前对 FB 3.0 与 FB 3.1 有什么强烈的看法吗？即使是简单的 3 或 3.1 也可以。

提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:43:55.543

大约[一年前，Matt Gemmell 发表了一篇关于此的帖子](http://mattgemmell.com/2011/12/05/latest-version/)，谈到了为旧版 iOS 开发的好处和坏处。他关于仅最新的基本论点归结为：

*   少麻烦
*   更少的代码
*   更好的客户
*   免费营销

根据Instapaper[的 Marco Arment 统计](http://www.marco.org/2011/11/30/more-ios-device-and-os-version-stats-from-instapaper)，近 50% 的人在 iOS4+ 发布后的 50 天内使用，98% 的人在 9 个月内使用。因此，对于现有的应用程序，您可能需要支持旧版本 9 个月左右，**但对于全新的应用程序，请选择最新最好的**.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:31:58.250

Facebook SDK 3.1 支持他们网站上的 4.3+：“iOS 版本之间的无缝 Facebook 登录：让您的应用程序在所有 iOS 4.3+ 版本上无缝运行，并轻松与 iOS 6 中的本机登录支持集成。” - [https://developers.facebook.com/features/whats-new-ios-sdk-3.1/](https://developers.facebook.com/features/whats-new-ios-sdk-3.1/)

只有当你有 ios6 但优雅地回退时，它才会使用 os 集成。

# java - Proguard 找不到引用的类 com.google.ads.internal.state.AdState

> ID：13040226
> 
> 赞同：15
> 
> 时间：2012-10-23T22:20:09.303
> 
> 标签：java, android, eclipse, admob, proguard

好的，所以这变得非常烦人，试图让我的项目在导出时工作/

Progaurd 不断给我这个错误：

```
Proguard returned with error code 1\. See console 
```

这是我在控制台中得到的完整错误：

```
 Warning: com.google.ads.m: can't find referenced class com.google.ads.internal.state.AdState
[2012-10-23 18:14:20 - com.fttech.monkey_toss.Menu] Warning: com.google.ads.m: can't find referenced class com.google.ads.internal.state.AdState

[2012-10-23 18:14:20 - com.fttech.monkey_toss.Menu]       You should check if you need to specify additional program jars.

[2012-10-23 18:14:20 - com.fttech.monkey_toss.Menu] Warning: there were 2 unresolved references to classes or interfaces.

[2012-10-23 18:14:20 - com.fttech.monkey_toss.Menu]          You may need to specify additional library jars (using '-libraryjars').

[2012-10-23 18:14:20 - com.fttech.monkey_toss.Menu] java.io.IOException: Please correct the above warnings first.

[2012-10-23 18:14:20 - com.fttech.monkey_toss.Menu]     at proguard.Initializer.execute(Initializer.java:321)
[2012-10-23 18:14:20 - com.fttech.monkey_toss.Menu]     at proguard.ProGuard.initialize(ProGuard.java:211)
[2012-10-23 18:14:20 - com.fttech.monkey_toss.Menu]     at proguard.ProGuard.execute(ProGuard.java:86)
[2012-10-23 18:14:20 - com.fttech.monkey_toss.Menu]     at proguard.ProGuard.main(ProGuard.java:492) 
```

有谁知道如何解决这个问题？？

编辑：

这是我的 proguarg-project.txt

```
# To enable ProGuard in your project, edit project.properties
# to define the proguard.config property as described in that file.
    #
# Add project specific ProGuard rules here.
# By default, the flags in this file are appended to flags specified
# in ${sdk.dir}/tools/proguard/proguard-android.txt
# You can edit the include path and order by changing the ProGuard
# include property in project.properties.
#
# For more details, see
#   http://developer.android.com/guide/deve ... guard.html

# Add any project specific keep options here:

# If your project uses WebView with JS, uncomment the following
# and specify the fully qualified class name to the JavaScript interface
# class:
#-keepclassmembers class fqcn.of.javascript.interface.for.webview {
#   public *;
#}
#admob, uncomment if using:
-keep public class com.admob.android.ads.** {*;}

# google analytics, uncomment if using:
#-keep class com.google.android.apps.analytics.PipelinedRequester$Callbacks

# google inapp billing, uncomment if using:
#-keep class com.android.vending.billing.**

# Box2D
-keep public class com.badlogic.** {*;} 
```

编辑：

这是我的新错误：

```
 java.io.IOException: Can't read [C:\Users\a\workspace2\AndEngine\bin\andengine.jar] (Can't process class [org/andengine/ui/activity/SimpleBaseGameActivity.class] (Unexpected end of ZLIB input stream))
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.InputReader.readInput(InputReader.java:230)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.InputReader.readInput(InputReader.java:200)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.InputReader.readInput(InputReader.java:178)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.InputReader.execute(InputReader.java:78)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.ProGuard.readInput(ProGuard.java:196)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.ProGuard.execute(ProGuard.java:78)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.ProGuard.main(ProGuard.java:492)
[2012-10-23 23:47:02 - Monkey Toss_New] Caused by: java.io.IOException: Can't process class [org/andengine/ui/activity/SimpleBaseGameActivity.class] (Unexpected end of ZLIB input stream)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.io.ClassReader.read(ClassReader.java:112)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.io.FilteredDataEntryReader.read(FilteredDataEntryReader.java:87)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.io.JarReader.read(JarReader.java:65)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.io.DirectoryPump.readFiles(DirectoryPump.java:65)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.io.DirectoryPump.pumpDataEntries(DirectoryPump.java:53)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.InputReader.readInput(InputReader.java:226)
[2012-10-23 23:47:02 - Monkey Toss_New]     ... 6 more
[2012-10-23 23:47:02 - Monkey Toss_New] Caused by: java.lang.RuntimeException: Unexpected end of ZLIB input stream
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.classfile.io.RuntimeDataInput.readInt(RuntimeDataInput.java:136)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.classfile.io.ProgramClassReader.visitProgramClass(ProgramClassReader.java:77)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.classfile.ProgramClass.accept(ProgramClass.java:346)
[2012-10-23 23:47:02 - Monkey Toss_New]     at proguard.io.ClassReader.read(ClassReader.java:91)
[2012-10-23 23:47:02 - Monkey Toss_New]     ... 11 more 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-10-29T12:57:22.927

此问题始于 AdMob SDK 6.1.0 和 6.2.1（适用于 Android）。要修复错误，请将其添加到您的 proguard.cfg 文件中：

```
-dontwarn com.google.ads.** 
```

来源：[https ://groups.google.com/d/msg/google-admob-ads-sdk/JllLSIXWtBk/ioXzTWKoYgMJ](https://groups.google.com/d/msg/google-admob-ads-sdk/JllLSIXWtBk/ioXzTWKoYgMJ)

# python - 根据文件名创建文件夹并在python中将文件复制到它们

> ID：13040236
> 
> 赞同：1
> 
> 时间：2012-10-23T22:21:15.667
> 
> 标签：python, file, move

我在这个文件夹结构中有很多文件：

```
test[dir]
  -test1 - 123.avi
  -video[dir]
     -test2 - 123.avi 
```

我想根据目标目录中的文件名（例如 test1、test2）创建文件夹，并将文件移动到相应的文件夹中。

我根据另一个线程的代码尝试了这个：

```
#!/usr/bin/env python

import os, shutil

src = "/home/koogee/Code/test"
dest = "/home/koogee/Downloads"

for dirpath, dirs, files in os.walk(src):
    for file in files:
        if not file.endswith('.part'):
            Dir = file.split("-")[0]
            newDir = os.path.join(dest, Dir)
            if (not os.path.exists(newDir)):
                os.mkdir(newDir)

            shutil.move(file, newDir) 
```

我收到此错误：

```
Traceback (most recent call last):
  File "<stdin>", line 8, in <module>
  File "/usr/lib/python2.7/shutil.py", line 299, in move
    copy2(src, real_dst)
  File "/usr/lib/python2.7/shutil.py", line 128, in copy2
    copyfile(src, dst)
  File "/usr/lib/python2.7/shutil.py", line 82, in copyfile
    with open(src, 'rb') as fsrc:
IOError: [Errno 2] No such file or directory: 'test1' 
```

奇怪的是在 /home/koogee/Downloads 中创建了一个名为“test1”的文件夹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:24:14.753

当您尝试这样做时`shutil.move()`，您的`file`变量只是没有目录上下文的文件名，因此它正在脚本的当前目录中寻找该名称的文件。

要获取绝对路径，`os.path.join(dirpath, file)`请用作源：

```
shutil.move(os.path.join(dirpath, file), newDir) 
```

# css - 创建文本渐变时，移动设备上出现奇怪的渐变出血

> ID：13040239
> 
> 赞同：0
> 
> 时间：2012-10-23T22:21:31.233
> 
> 标签：css, webkit

我一直在创建 css3 文本渐变。它们可以在浏览器中完美找到，但是当您在网络上查看它们时。文本周围总是有一条线或一个框。类似于此页面上发生的情况：http: [//www.paulund.co.uk/playground/demo/css_text_gradient/](http://www.paulund.co.uk/playground/demo/css_text_gradient/)

这是一个 webkit 错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T18:55:52.233

感谢 Michael 的建议，使用 svg bg 而非 css3 生成的解决了移动问题。

这是css的代码：

```
background:url(../img/grad.svg) 0 -116px;
background-size: 100% 100%;
-webkit-background-clip: text;
-webkit-text-fill-color: transparent; 
```

然后是 grad.svg：

```
<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="60">
  <linearGradient id="normal" x1="0%" y1="0%" x2="0%" y2="100%">
     <stop offset="0%" stop-color="#ffffff"/>
     <stop offset="100%" stop-color="#000000"/>
  </linearGradient>
  <rect x="0" y="0" width="100%" height="60" fill="url(#normal)" />
</svg> 
```

# java - 在 Java 中对 3 个值进行排序的最快方法

> ID：13040240
> 
> 赞同：0
> 
> 时间：2012-10-23T22:21:33.233
> 
> 标签：java, sorting

我必须按正确的顺序输入 3 个值并将它们打印到控制台。

一个解决方案是将它们放入一个数组中，然后对它们进行排序，但我记得（从学校时代起）比较和排序它们的速度更快，但是我找不到正确的比较顺序。

您能否告诉我如何将 3 个值与最少的`if`语句数进行比较？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-23T22:46:39.733

冒泡排序在最坏的情况下只有 3 个比较操作和 6 个分配（如果与这种情况下的插入排序的行为不同，它将非常相似）：

```
if (a > b)
   swap(a,b)
if (b > c)
   swap(b,c)
if (a > b)
   swap(a,b)
print a,b,c 
```

**它不能在少于 3 次比较中完成，**因为`n!=6`数组可能存在排列，并且`ceil(log_2(n!)) = 3`

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-23T22:23:24.307

优化这个没有意义。它不会获得任何速度。3 的 O(n!) 仍然只有 3*2 = 6 次操作。甚至 O(2^n) 也将是 8。您真的可以尽一切努力对这 3 个值进行排序，而不会看到性能差异。

*编辑*

```
int a, b, c, min, max, med;//assume values are there for a b c
if( a > b ){
 if( a > c ){
  max = a;
  if( b > c ){
   med = b;
   min = c;
  }else{
   med = c;
   min = b;
  }
 }else{
  med = a;
  max = c;
  min = b;
 }
}else{
 if( b > c ){
  max = b;
  if( a > c ){
   med = a;
   min = c;
  }else{
   med = c;
   min = a;
  }
 }else{
  med = b;
  max = c;
  min = a;
 }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-03T15:26:28.440

据我所知，Java 使用**Quicksort**算法进行排序——一种已经优化的方法。这里没有收获的速度！

# cuda - 批量纹理上传

> ID：13040245
> 
> 赞同：2
> 
> 时间：2012-10-23T22:22:02.920
> 
> 标签：cuda, jpeg, textures

我有一个专门的渲染应用程序，需要从 pdf 加载任意数量的 jpeg，然后将图像写到内核内的渲染页面中。这过于简单了，但关键是我想找到一种方法将“n”个图像作为纹理共同发送，然后在内核中为 tex2d() 调用索引到这个纹理集合。欢迎任何想法优雅地做到这一点。

作为一个附带问题，我还没有找到一种方法来解码内核中的 jpeg 图像，迫使我在 CPU 上解码，然后（慢慢地）发送一个大位图。我可以改进吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:35:50.763

第一：如果纹理上传性能不是瓶颈，请考虑不要批量上传。这里有一些建议，每一个都有不同的权衡。

1.  对于不同大小的纹理，请考虑创建[纹理图集](http://en.wikipedia.org/wiki/Texture_atlas)。这是一种在游戏开发中流行的技术，它将许多纹理打包到一个 2D 图像中。这需要将纹理坐标偏移到相关图像的角落，并且排除了使用纹理坐标钳制和环绕。因此，您需要存储每个子纹理角的偏移量而不是其 ID。有多种工具可用于创建纹理图集。

2.  对于固定大小的纹理，或者您不介意浪费不同大小的纹理的情况，您可以考虑使用[分层纹理](http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#layered-textures)。这是一个具有多个独立层的纹理，可以在纹理提取时使用单独的层索引对其进行索引。从上面的链接引用：

    > 一维或二维分层纹理（在 Direct3D 中也称为纹理数组，在 OpenGL 中也称为数组纹理）是由一系列层组成的纹理，所有层都是具有相同维度、大小和数据类型的常规纹理.
    > 
    > 使用整数索引和浮点纹理坐标来寻址一维分层纹理；索引表示序列中的层，坐标表示该层中的纹素。使用整数索引和两个浮点纹理坐标来寻址二维分层纹理；索引表示序列中的层，坐标表示该层中的纹素。
    > 
    > 分层纹理只能是一个 CUDA 数组，方法是使用 cudaArrayLayered 标志调用 cudaMalloc3DArray()（一维分层纹理的高度为零）。
    > 
    > 使用 tex1Dlayered() 和 tex2Dlayered() 中描述的设备函数获取分层纹理。纹理过滤（请参阅纹理提取）仅在层内完成，而不是跨层。
    > 
    > 分层纹理仅在计算能力 2.0 及更高版本的设备上受支持。

3.  您可以考虑一种混合方法：将纹理分类为相同大小的组，并为每个组使用分层纹理。或者使用分层纹理图集，其中组被打包，使得每层包含来自每个组的一个或几个纹理，以最大程度地减少浪费。

关于你的附带问题：[谷歌搜索“cuda jpeg decode”会出现很多结果](https://www.google.com.au/search?q=CUDA+jpeg+decode&oq=CUDA+jpeg+decode&sugexp=chrome,mod=0&sourceid=chrome&ie=UTF-8)，包括[至少一个开源项目](http://sourceforge.net/projects/cudajpegdecoder/)。

# sql - 从具有加权行概率的 PostgreSQL 表中选择随机行

> ID：13040246
> 
> 赞同：21
> 
> 时间：2012-10-23T22:22:27.057
> 
> 标签：sql, postgresql, statistics, probability

示例输入：

```
从测试中选择*；
 编号 | 百分   
----+------------
  1 | 50
  2 | 35   
  3 | 15   
(3 行)

```

**你将如何编写这样的查询，平均 50% 的时间我可以获得 id=1 的行，35% 的时间行 id=2，以及 15% 的时间行 id=3？**

我尝试了类似的东西`SELECT id FROM test ORDER BY p * random() DESC LIMIT 1`，但它给出了错误的结果。运行 10,000 次后，我得到一个分布，例如：`{1=6293, 2=3302, 3=405}`，但我预计分布接近：`{1=5000, 2=3500, 3=1500}`。

有任何想法吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-23T23:11:48.667

这应该可以解决问题：

```
WITH CTE AS (
    SELECT random() * (SELECT SUM(percent) FROM YOUR_TABLE) R
)
SELECT *
FROM (
    SELECT id, SUM(percent) OVER (ORDER BY id) S, R
    FROM YOUR_TABLE CROSS JOIN CTE
) Q
WHERE S >= R
ORDER BY id
LIMIT 1; 
```

子查询`Q`给出以下结果：

```
1  50
2  85
3  100 
```

然后，我们只需在 [0, 100) 范围内生成一个随机数，然后选择等于或超过该数字的第一行（`WHERE`子句）。我们使用公用表表达式 ( `WITH`) 来确保随机数只计算一次。

*顺便说一句，这`SELECT SUM(percent) FROM YOUR_TABLE`允许你有任何权重`percent`——它们并不一定是百分比（即加起来为 100）。*

[[SQL 小提琴]](http://sqlfiddle.com/#!12/525f9/21)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-10-10T11:02:21.267

> ORDER BY random() ^ (1.0 / p)

来自 Efraimidis 和 Spirakis 描述的算法。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2020-05-23T08:39:09.203

Branko 接受的解决方案很棒（谢谢！）。但是，我想提供一个性能相同的替代方案（根据我的测试），并且可能更易于可视化。

让我们回顾一下。最初的问题也许可以概括如下：

> 给定一个 id 和**相对权重**的映射，创建一个查询，该查询在映射中返回一个随机 id，但概率与其相对权重成正比。

注意强调相对权重，而不是百分比。正如布兰科在他的回答中指出的那样，使用相对权重适用于任何事情，包括百分比。

现在，考虑一些测试数据，我们将把它们放在一个临时表中：

```
CREATE TEMP TABLE test AS
SELECT * FROM (VALUES
    (1, 25),
    (2, 10),
    (3, 10),
    (4, 05)
) AS test(id, weight); 
```

请注意，我使用的示例比原始问题中的示例*更复杂，因为它**不能*方便地加起来为 100，并且*相同的权重*(20) 被*多次*使用（对于 id 2 和 3），这一点很重要，稍后您会看到。

我们要做的第一件事就是将权重变成从 0 到 1 的概率，这无非是一个简单的归一化（权重 / 总和（权重））：

```
WITH p AS ( -- probability
    SELECT *,
        weight::NUMERIC / sum(weight) OVER () AS probability
    FROM test
),
cp AS ( -- cumulative probability
    SELECT *,
        sum(p.probability) OVER (
            ORDER BY probability DESC
            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ) AS cumprobability
    FROM p
)
SELECT
    cp.id,
    cp.weight,
    cp.probability,
    cp.cumprobability - cp.probability AS startprobability,
    cp.cumprobability AS endprobability
FROM cp
; 
```

这将导致以下输出：

```
 id | weight | probability | startprobability | endprobability
----+--------+-------------+------------------+----------------
  1 |     25 |         0.5 |              0.0 |            0.5
  2 |     10 |         0.2 |              0.5 |            0.7
  3 |     10 |         0.2 |              0.7 |            0.9
  4 |      5 |         0.1 |              0.9 |            1.0 
```

诚然，上面的查询所做的工作超出了我们的需要，但我发现**以这种方式可视化相对概率很有帮助**，并且它确实使选择 id 的最后一步变得微不足道：

```
SELECT id FROM (queryabove)
WHERE random() BETWEEN startprobability AND endprobability; 
```

现在，让我们将它们与一个测试放在一起，以**确保**查询返回具有预期分布的数据。我们将用于`generate_series()`生成一个随机数一**百万次**：

```
WITH p AS ( -- probability
    SELECT *,
        weight::NUMERIC / sum(weight) OVER () AS probability
    FROM test
),
cp AS ( -- cumulative probability
    SELECT *,
        sum(p.probability) OVER (
            ORDER BY probability DESC
            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ) AS cumprobability
    FROM p
),
fp AS ( -- final probability
    SELECT
        cp.id,
        cp.weight,
        cp.probability,
        cp.cumprobability - cp.probability AS startprobability,
        cp.cumprobability AS endprobability
    FROM cp
)
SELECT *
FROM fp
CROSS JOIN (SELECT random() FROM generate_series(1, 1000000)) AS random(val)
WHERE random.val BETWEEN fp.startprobability AND fp.endprobability
; 
```

这将导致类似于以下的输出：

```
 id | count  
----+--------
 1  | 499679 
 3  | 200652 
 2  | 199334 
 4  | 100335 
```

如您所见，它完美地跟踪了预期分布。

## 表现

上面的查询非常高效。即使在我的普通机器上，PostgreSQL 在 WSL1 实例中运行（太可怕了！），执行速度也相对较快：

```
 count | time (ms)
-----------+----------
     1,000 |         7
    10,000 |        25
   100,000 |       210
 1,000,000 |      1950 
```

## 适应生成测试数据

在为单元/集成测试生成测试数据时，我经常使用上述查询的变体。这个想法是生成近似于跟踪现实的概率分布的随机数据。

**在这种情况下，我发现计算一次**开始和结束分布并将结果存储在表中很有用：

```
CREATE TEMP TABLE test AS
WITH test(id, weight) AS (VALUES
    (1, 25),
    (2, 10),
    (3, 10),
    (4, 05)
),
p AS ( -- probability
    SELECT *, (weight::NUMERIC / sum(weight) OVER ()) AS probability
    FROM test
),
cp AS ( -- cumulative probability
    SELECT *,
        sum(p.probability) OVER (
            ORDER BY probability DESC
            ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
        ) cumprobability
    FROM p
)
SELECT
    cp.id,
    cp.weight,
    cp.probability,
    cp.cumprobability - cp.probability AS startprobability,
    cp.cumprobability AS endprobability
FROM cp
; 
```

然后我可以重复使用这些预先计算的概率，从而获得额外的性能和更简单的使用。

我什至可以将它全部包装在一个函数中，我可以在任何时候调用它来获取随机 id：

```
CREATE OR REPLACE FUNCTION getrandomid(p_random FLOAT8 = random())
RETURNS INT AS
$$
    SELECT id
    FROM test
    WHERE p_random BETWEEN startprobability AND endprobability
    ;
$$
LANGUAGE SQL STABLE STRICT 
```

## 窗口功能框架

值得注意的是，上面的技术是使用带有非标准 frame 的窗口函数`ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW`。这是处理某些权重可能重复的事实所必需的，这就是为什么我首先选择具有重复权重的测试数据！

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-23T22:44:09.187

您提出的查询似乎有效；请参阅[此 SQLFiddle 演示](http://sqlfiddle.com/#!12/3039b/3)。但是，它会产生错误的分布；见下文。

为了防止 PostgreSQL 优化子查询，我将它包装在一个`VOLATILE`SQL 函数中。PostgreSQL 无法知道您是否打算为外部查询的每一行运行一次子查询，因此如果您不强制它变为 volatile，它只会执行一次。另一种可能性 - 尽管查询计划器将来可能会优化 - 是让它看起来是一个相关的子查询，就像这个使用永远为真 where 子句的黑客一样，像这样：[http ://sqlfiddle.com/# !12/3039b/9](http://sqlfiddle.com/#!12/3039b/9)

猜测一下（在您更新以解释它*为什么*不起作用之前）您的测试方法有问题，或者您将其用作外部查询中的子查询，而 PostgreSQL 注意到它不是相关的子查询并执行它一次，就像在[这个例子](http://sqlfiddle.com/#!12/3039b/4)中一样。.

**更新：**产生的分布不是你所期望的。这里的问题是您通过获取*多个样本*来扭曲分布`random()`; 你需要一个*样本*。

此查询产生正确的分布（[SQLFiddle](http://sqlfiddle.com/#!12/2dbeb/2)）：

```
WITH random_weight(rw) AS (SELECT random() * (SELECT sum(percent) FROM test))
 SELECT id
FROM (                   
  SELECT 
    id,
    sum(percent) OVER (ORDER BY id),
    coalesce(sum(prev_percent) OVER (ORDER BY id),0) FROM (
      SELECT 
        id,
        percent,
        lag(percent) OVER () AS prev_percent
      FROM test
    ) x
) weighted_ids(id, weight_upper, weight_lower)
CROSS JOIN random_weight
WHERE rw BETWEEN weight_lower AND weight_upper; 
```

不用说，性能是可怕的。它使用两组嵌套的窗口。我正在做的是：

*   创建 (id, percent, previous_percent) 然后使用它创建两个运行的权重总和，用作范围括号；然后
*   取一个随机值，将其缩放到权重范围，然后选择一个权重在目标括号内的值

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-23T22:52:09.503

这里有一些东西供你玩：

```
select t1.id as id1
  , case when t2.id is null then 0 else t2.id end as id2
  , t1.percent as percent1
  , case when t2.percent is null then 0 else t2.percent end as percent2 
from "Test1" t1 
  left outer join "Test1" t2 on t1.id = t2.id + 1
where random() * 100 between t1.percent and 
  case when t2.percent is null then 0 else t2.percent end; 
```

本质上执行左外连接，以便您有两列来应用 between 子句。

请注意，只有当您以正确的方式订购餐桌时，它才会起作用。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-08-31T02:40:19.147

根据 Branko Dimitrijevic 的回答，我编写了这个查询，通过使用分层窗口函数的总和`percent`（与 a 不同`ROLLUP`），它可能会更快，也可能不会更快。

```
WITH random AS (SELECT random() AS random)
SELECT id FROM (
    SELECT id, percent,
    SUM(percent) OVER (ORDER BY id) AS rank,
    SUM(percent) OVER () * random AS roll
    FROM test CROSS JOIN random
) t WHERE roll <= rank LIMIT 1 
```

如果排序不重要，`SUM(percent) OVER (ROWS UNBOUNDED PRECEDING) AS rank,`则可能更可取，因为它避免了必须先对数据进行排序。

我还尝试了 Mechanic Wei 的回答（[显然如本文所述](http://utopia.duth.gr/~pefraimi/research/data/2007EncOfAlg.pdf)），这在性能方面似乎很有希望，但经过一些测试，[分布似乎已关闭](http://sqlfiddle.com/#!17/e8eb2/1/0)：

```
SELECT id
FROM test
ORDER BY random() ^ (1.0/percent)
LIMIT 1 
```

# google-maps - 如何使用地址栏居中和缩放谷歌地图

> ID：13040254
> 
> 赞同：0
> 
> 时间：2012-10-23T22:23:11.380
> 
> 标签：google-maps, google-maps-api-3

我有一个生成谷歌地图的页面。我希望能够使用地址栏来更改缩放和中心点。例如：

```
www.example.com/mymap?zoom=10&center=10,15
www.example.com/mymap?zoom=10&lat=10&lng=15 
```

我记得有一个类似的组合有效，但现在我无法得到任何结果。

这是我的功能：

```
function initialize() {
// create the map
var myOptions = {
zoom: 5,
center: new google.maps.LatLng(10,15),
mapTypeControl: true,
mapTypeControlOptions: {style: google.maps.MapTypeControlStyle.DROPDOWN_MENU},
navigationControl: true,
mapTypeId: google.maps.MapTypeId.ROADMAP
}
map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

var defaultBounds = new google.maps.LatLngBounds(
new google.maps.LatLng(8, 12),
new google.maps.LatLng(12, 18));

var options = {
bounds: defaultBounds
};

google.maps.event.addListener(map, 'click', function() {
infowindow.close();
});

var infowindow = new google.maps.InfoWindow(
{ size: new google.maps.Size(150,50)}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:54:04.120

您是否正在寻找这样的东西（从[Mike Williams 的 v2 教程](http://econym.org.uk/gmap/linktothis.htm)翻译成 Google Maps API v3 ）：

[http://www.geocodezip.com/v3_MW_example_linktothis.html?lat=42.359783&lng=-71.092800&zoom=18&type=h](http://www.geocodezip.com/v3_MW_example_linktothis.html?lat=42.359783&lng=-71.092800&zoom=18&type=h)

# css - CSS3背景加透明无图像

> ID：13040267
> 
> 赞同：-4
> 
> 时间：2012-10-23T22:24:05.843
> 
> 标签：css

我在按钮上有一个纯色的背景颜色，我正在寻找一些 CSS(3?)，它会在颜色顶部覆盖一个半透明的白色，但只在它的前 50% 上。我正在寻找一种非渐变、非基于图像的光泽效果。

不使用图像如何实现？如果解决方案不支持旧版浏览器也没关系。

**编辑：** bookcasey 下面的答案似乎有效，除了字体也变得透明......

```
<!DOCTYPE html>
<html>
<head>
<style>
a
{
    display: inline-block;
    padding:30px;
    background: salmon;
    position: relative;
    text-align: center;
    text-decoration:none;
    color:#000;
    font-size:20pt;
    font-weight:bold;
}

a:before
{
    content: '';
    width: 100%;
    height: 50%;
    background: rgba(255,255,255,0.5);
    position: absolute;
    top: 0;
    left:0;
}
</style>
</html>
<body>

<div>
    <a href="#">Test Link</a>
</div>

</body>
</html> 
```

谢谢，

安迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:32:10.247

在相对父级上使用绝对定位的伪元素。

[演示](http://jsfiddle.net/E6FhW/)

```
a {display: block; width: 100px; height: 50px; background: salmon; position: relative;}
a:before {
    content: '';
    width: 100%;
    height: 50%;
    background: rgba(255,255,255,.5);
    position: absolute;
    top: 0;
    left:0;
} 
```

​</p>

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T00:44:51.753

另一种完全不同的技术（提到，但未在评论中解释）是使用带有硬色标的 CSS3 渐变。

```
a {display: block; width: 100px; height: 50px; position: relative;
  background: -webkit-gradient(linear, 50% 100%, 50% 0%, color-stop(50%, rgba(255, 255, 255, 0)), color-stop(50%, rgba(255, 255, 255, 0.5))), salmon;
  background: -webkit-linear-gradient(bottom, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0.5) 50%), salmon;
  background: -moz-linear-gradient(bottom, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0.5) 50%), salmon;
  background: -o-linear-gradient(bottom, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0.5) 50%), salmon;
  background: linear-gradient(bottom, rgba(255, 255, 255, 0) 50%, rgba(255, 255, 255, 0.5) 50%), salmon;}​ 
```

[演示](http://jsfiddle.net/DuMt8/)

# cakephp - cakephp 应用程序作为静态站点的一部分

> ID：13040273
> 
> 赞同：0
> 
> 时间：2012-10-23T22:24:39.077
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.1

我有一种独特的情况。我已经开发了一个 cakephp 应用程序，需要将其部署到具有内容的共享服务器上。我知道通常我们应该在 webroot 中有静态内容，但不允许这样做，因为这个应用程序需要稍后删除。

它是一个共享主机，我无法更改 DocumentRoot 或任何与管理员相关的设置。但是，我可以添加 .htacces 文件。

我的文件按以下顺序排列：

```
    /webapp
       /应用程序
       /lib
       ...
       /webroot

```

我想你明白了。我打算将整个“webapp”文件夹与静态站点一起部署并拥有登录链接，这样人们就可以以[http://mysite.com/webapp/users/login](http://mysite.com/webapp/users/login)的身份访问该站点。不幸的是，我不知道这样做的正确方法。我希望保持原样的目录结构，以便后面的人可以轻松地修改和删除它。

任何帮助表示赞赏。

更新：我忘了提到我在本地访问该网站的方式是

```
http://localhost/webapp
```

，它基于 DocumentRoot/VirtualHost 设置。我可能无法在 prod 上做到这一点，那么如何使用路由进行翻译呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T00:44:12.513

如果您想使用 Apache 从子目录中为 CakePHP 提供服务，那么您正在寻找[RewriteBase](http://httpd.apache.org/docs/current/mod/mod_rewrite.html#rewritebase)指令。将指令添加到三个`.htaccess`文件中的每一个（在 CakePHP 根目录、in`app`和 in 中`app/webroot`）。例如，根目录最终看起来像：

```
<IfModule mod_rewrite.c>
    RewriteEngine  on
    RewriteBase    /webapp
    RewriteRule    ^$ app/webroot/    [L]
    RewriteRule    (.*) app/webroot/$1 [L]
</IfModule> 
```

现在 Cake 会很高兴在您的`webapp`子目录中提供服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T13:34:24.990

您需要更新`.htaccess`要引用的文件`/webapp/app/webroot/`而不是`/app/webroot/`.

虽然我很想将 CakePHP 应用程序安装在 Web 服务器的公共可访问目录的根目录中，但使用 CakePHP 的内置功能`PagesController`来提供静态文件，并在需要时删除控制器。

# wolfram-mathematica - 在mathematica中将数字转换为变量基数

> ID：13040281
> 
> 赞同：1
> 
> 时间：2012-10-23T22:25:20.120
> 
> 标签：wolfram-mathematica, integer-division

让*n*是一个整数和*A* = {2,3,...,10} 我想做如下：

1.  将*n*除以2，因此有一个提醒*r* [2]和一个商*q* [2]。
2.  将*q* [2]除以3，因此有一个提示*r* [3]和一个商*q* [3]。
3.  我们重复这个直到商小于下一个数字。
4.  将最后一个商与之前的提醒写在一起。

例如 n=45

```
45/2 .......    r_2=1, q_2=22
22/3 .......    r_3=1, q_3=7
 7/4 .......    r_4=3, q_4=1 
```

因为*q* [4] = 1 小于下一个数字，即 5，所以我们打破。

结果是*q* [4] *r* [4] *r* [3] *r* [2]等于 1311。

感谢您的帮助。

我这样做了，但它不起作用

```
n = 45;
i = 2;
list = {Mod[n, i]};

While[Quotient[n, i] >= i + 1, n == Quotient[n, i]; i++; 
   AppendTo[list, Mod[n, i]];
   If[Quotient[n, i] < i + 1, Break[]]; AppendTo[list, Quotient[n, i]]];

list
Row[Reverse[list]] 
```

这使

```
{1, 0, 15, 1, 11, 0, 9, 3, 7, 3}
Row[{3, 7, 3, 9, 0, 11, 1, 15, 0, 1}] 
```

这不是我想要的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T15:16:19.637

你可能会使用这样的东西：

```
f[n_Integer] := 
 NestWhileList[
   {QuotientRemainder[#[[1, 1]], #[[2]] + 1], #[[2]] + 1} &,
   {{n}, 1},
   #[[1, 1]] != 0 &
 ] // Rest

f[45] 
```

> ```
> {{{22, 1}, 2}, {{7, 1}, 3}, {{1, 3}, 4}, {{0, 1}, 5}} 
> ```

您可以使用`Part`来获得所需的任何输出。

如果您可以处理语法，这是一种更高级的方法：

```
f2[n_Integer]    := Reap[f2[{n, 0}, 2]][[2, 1, 2 ;;]] // Reverse

f2[{q_, r_}, i_] := f2[Sow @ r; QuotientRemainder[q, i], i + 1]

f2[{0, r_}, i_]  := Sow @ r

f2[45] 
```

> ```
> {1, 3, 1, 1} 
> ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-26T22:56:20.300

这是代码：

```
A = Table[i, {i, 2, 10}]; (* array of numbers *)
n = 45; (* initial value *)
ans = {}; (* future answer which is now empty list *)
For[i = 1, i <= Length[A], i++, (* looping over A *)
 If[n < A[[i]], (* exit condition *)
  ans = Append[ans, n]; (* appending last n when exit *)
  Break[]
  ];
 qr = QuotientRemainder[n, A[[i]]]; (* calculating both quotient and reminder *)
 ans = Append[ans, qr[[2]]]; (* adding second member to the answer *)
 Print[qr]; (* printing *)
 n = qr[[1]]; (* using first member as new n to process *)
 ];
ans (* printing result in Mathematica manner *) 
```

它给

```
{1, 1, 3, 1} 
```

# mysql - 将变量的值设置为 MySQL 中 SELECT 语句的结果

> ID：13040285
> 
> 赞同：1
> 
> 时间：2012-10-23T22:25:34.623
> 
> 标签：mysql

我想在 Mysql 中创建以下函数，但该函数未创建但失败并出现错误

```
DELIMITER $$
CREATE FUNCTION MapAccountType(AccountTypeID INT) 
RETURNS VARCHAR(50)
DETERMINISTIC
BEGIN
    DECLARE @AccountType varchar(50);
    SELECT AccountType INTO @AccountType 
            FROM AccountType 
            WHERE AccountTypeID = AccountTypeID);
    RETURN AccountType;
END $$
DELIMITER ; 
```

我的桌子的描述

```
CREATE TABLE AccountType(
    AccountTypeID INT AUTO_INCREMENT PRIMARY KEY,
    AccountType varchar(100) UNIQUE NOT NULL
); 
```

我得到的错误是

```
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that
corresponds to your MySQL server version for the right syntax to use
near '@AccountType varchar(50); 
```

我似乎无法找出我做错了什么。有人可以帮忙吗。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:28:05.567

这应该有效：

```
DELIMITER $$
CREATE FUNCTION MapAccountType(AccountTypeID INT) 
RETURNS VARCHAR(50)
DETERMINISTIC
BEGIN
    SELECT AccountType INTO @AccountType FROM AccountType
    WHERE AccountTypeID = AccountTypeID;

    RETURN @AccountType;
END $$
DELIMITER ; 
```

这也将起作用：

```
DELIMITER $$
CREATE FUNCTION MapAccountType(AccountTypeID INT) 
RETURNS VARCHAR(50)
DETERMINISTIC
BEGIN
    DECLARE v_AccountType varchar(50) DEFAULT NULL;

    SELECT AccountType INTO v_AccountType FROM AccountType
    WHERE AccountTypeID = AccountTypeID;

    RETURN v_AccountType;
END $$
DELIMITER ; 
```

第一个示例使用“全局”变量（以“@”符号开头的变量）。第二个示例使用“本地”变量。

# jquery - 如何检查动画是否在其他动画回调函数中完成？

> ID：13040287
> 
> 赞同：2
> 
> 时间：2012-10-23T22:25:36.650
> 
> 标签：jquery, animation

```
$("#IMAGE1").animate({"left": "+=1050px", queue: false}, "slow", function()
{
   // Want this to happen when the image2 animation is completed as well.
   $("#IMAGE1").css('left', $('#IMAGE2').position().left);
}

$("#IMAGE2").animate({"left": "+=1050px", queue: false}, "slow"); 
```

如何在 image1.animation 的回调函数体内检查 image2.animation 何时完成？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T22:27:31.250

您可以使用`:animated`选择器：

```
if ($('#IMAGE1').is(':animated')) {
    // it's animating...
} 
```

参考：

*   [`:animated`选择器](http://api.jquery.com/animated-selector/)。

# image-processing - 使用任意旋转角度的翘曲透视

> ID：13040288
> 
> 赞同：5
> 
> 时间：2012-10-23T22:25:38.703
> 
> 标签：image-processing, opencv

我有一张从某个角度拍摄的棋盘图像。现在我想扭曲透视图，使棋盘图像再次看起来好像是直接从上方拍摄的。

我知道我可以尝试在匹配点之间使用“findHomography”，但我想避免它并使用例如来自移动传感器的旋转数据来自己构建单应矩阵。我校准了我的相机以获得内在参数。然后假设以下图像是围绕 x 轴以约 60 度角拍摄的。我认为我所要做的就是将相机矩阵与旋转矩阵相乘以获得单应矩阵。我尝试使用以下代码，但看起来我没有正确理解某些内容，因为它没有按预期工作（结果图像完全是黑色或白色。

![在此处输入图像描述](../Images/3ffa26fbfa70ee9eaaa4ce65fadd5c25.png)

```
import cv2
import numpy as np
import math 

camera_matrix = np.array([[ 5.7415988502105745e+02, 0., 2.3986181527877352e+02],
                           [0., 5.7473682183375217e+02, 3.1723734404756237e+02], 
                           [0., 0., 1.]])

distortion_coefficients = np.array([ 1.8662919398453856e-01, -7.9649812697463640e-01,
   1.8178068172317731e-03, -2.4296638847737923e-03,
   7.0519002388825025e-01 ])

theta = math.radians(60)

rotx = np.array([[1, 0, 0],
               [0, math.cos(theta), -math.sin(theta)],
               [0, math.sin(theta), math.cos(theta)]])   

homography = np.dot(camera_matrix, rotx)

im = cv2.imread('data/chess1.jpg')
gray = cv2.cvtColor(im,cv2.COLOR_BGR2GRAY)

im_warped = cv2.warpPerspective(gray, homography, (480, 640), flags=cv2.WARP_INVERSE_MAP)
cv2.imshow('image', im_warped)
cv2.waitKey()
pass 
```

校准后我也有失真系数。如何将这些合并到代码中以改善结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-26T17:08:35.063

*This answer is awfully late by several years, but here it is ...*

*(Disclaimer: my use of terminology in this answer may be imprecise or incorrect. Please do look up on this topic from other more credible sources.)*

* * *

Remember:

*   Because you only have one image (view), you can only compute 2D homography (perspective correspondence between one 2D view and another 2D view), not the full 3D homography.
*   Because of that, the nice intuitive understanding of the 3D homography (rotation matrix, translation matrix, focal distance, etc.) are ***not available*** to you.
*   What we say is that with 2D homography you ***cannot factorize*** the 3x3 matrix into those nice intuitive components like 3D homography does.
*   You have one matrix - (which is the product of several matrices unknown to you) - and that is it.

However,

OpenCV provides a `getPerspectiveTransform` function which solves the 3x3 perspective matrix (using homogenous coordinate system) for a 2D homography between two planar quadrilaterals.

[Link to documentation](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#getperspectivetransform)

To use this function,

*   Find the four corners of the chessboard on the image. These will be your source coordinates.
*   Supply four rectangle corners of your choice. These will be your destination coordinates.
*   Pass the source coordinates and destination coordinates into the `getPerspectiveTransform` to generate a 3x3 matrix that is able to dewarp your chessboard to an upright rectangle.

Notes to remember:

*   Mind the ordering of the four corners.

    *   If the source coordinates are picked in clockwise order, the destination also needs to be picked in clockwise order.
    *   Likewise, if counter-clockwise order is used, do it consistently.
    *   Likewise, if z-order (top left, top right, bottom left, bottom right) is used, do it consistently.
    *   Failure to order the corners consistently will generate a matrix that executes the point-to-point correspondence exactly (mathematically speaking), but will not generate a usable output image.
*   The aspect ratio of the destination rectangle can be chosen arbitrarily. In fact, it is not possible to deduce the "original aspect ratio" of the object in world coordinates, because *"this is 2D homography, not 3D"*.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:41:09.377

一个问题是，要乘以相机矩阵，您需要一些 az 坐标的概念。在考虑畸变系数之前，您应该首先在给定欧拉角的情况下获得基本的图像变形。查看[这个](https://stackoverflow.com/a/12293128/852487)答案以获得更详细的解释，并尝试复制我的结果。将图像沿 z 轴移动然后用相机矩阵投影的想法可能会令人困惑，如果其中任何部分没有意义，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T13:43:07.520

您不需要校准相机或估计相机方向（但是，后者在这种情况下非常容易：只需找到那些正交线束的消失点，然后取它们的叉积来找到飞机，详见 Hartley & Zisserman 的圣经）。

您唯一需要做的就是估计将棋子映射到正方形的单应性，然后将其应用于图像。

# vim - 如何在vim的quickfix中忽略Make输出？

> ID：13040289
> 
> 赞同：4
> 
> 时间：2012-10-23T22:25:40.000
> 
> 标签：vim, gcc, makefile

vim 的快速修复功能的期望行为是什么？快速修复窗口 (:copen) 应该只包含编译器错误/警告还是应该显示整个输出？我想要前者，因为 make 的输出可能很长，但我得到后者，即使编译器设置为 gcc 和 g:compiler_gcc_ignore_unmatched_lines 设置。但是，quickfix 窗口中带有警告/错误的行会突出显示，并且 :cnext 会正确跳转到下一个问题。此外，没有问题的行有一个双管道符号前缀，因此 vim 似乎正确解析了 make 输出。

除了警告/错误之外，这些行是否显示并且可以隐藏，或者错误格式字符串与 make 输出不完全匹配？

我以 avrdude 5.11.1 源代码为例，但在许多其他项目中我得到了相同的结果。

设置编译器会自动调整错误格式字符串还是我必须始终手动设置该字符串？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T05:21:27.113

这真的是你希望它工作的方式。我经常通过将 grep 添加到我的 makeprg 来过滤掉一些我不感兴趣的构建输出，但我也想要一些构建输出，即使它不是错误。

我认为 vim 不会从 quickfix 中删除非错误行。如果您不希望它们在那里，您需要自己过滤它们（或修改`efm`以将它们包含在错误中）。

# jquery - 绑定集合更改以查看渲染

> ID：13040305
> 
> 赞同：2
> 
> 时间：2012-10-23T22:27:19.007
> 
> 标签：jquery, backbone.js

尽管在 StackOverflow 和其他地方有很多关于同一主题的问题/答案，但我仍然不明白如何继续。我想更改我的收藏以在我的视图中触发渲染功能。View 有一个集合，而不是一个模型——所以我看到的许多 model.bind 示例都不适用。显然 collection.bind 不是合法的绑定。这是我的视图代码。我应该在初始化中添加什么，以便在orderedPrefs（集合）发生更改时调用视图的渲染函数？

```
headerView = Backbone.View.extend({

        el: $('#' + targetdiv),
        collection: orderedPrefs,
        events: {
            "click .scheduleheader": "clicked"                               // dependency here on scheduler.js class naming .scheduleheader

        },
        initialize: function () {
            _.bindAll(this, "render");

        },
        render: function () {
            alert('render!!');
        }, 
```

…………

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T07:26:27.780

这些应该在初始化函数中工作：

```
this.collection.on("add", this.render);
this.collection.on("remove", this.render);
this.collection.on("reset", this.render); 
```

如果他们不这样做，则附加到视图的集合有问题。您不应该使用全局“orderedPrefs”。

骨干文档状态：

*创建新视图时，您传递的选项作为 this.options 附加到视图，以供将来参考。有几个特殊选项，如果通过，将直接附加到视图：模型、集合、el、id、className、tagName 和属性。*

实例化视图时，您需要像这样传递集合：

```
new headerView({ collection: orderedPrefs }); 
```

如果你想跟踪集合模型的变化，你应该在不同的视图中进行：

```
var ModelView = Backbone.View.extend({
    initialize: function() {
        _.bindAll(this, "render");
        this.render();
        this.model.on("change",this.render);
    },
    render: function() {
        $(this.el).html("model view markup"); // you should use templating
        return this;
    }
});

var headerView = Backbone.View.extend({
    el: $('#' + targetdiv),
    initialize: function () {
        _.bindAll(this, "render");
        this.collection.on("add", this.render);
        this.collection.on("remove", this.render);
        this.collection.on("reset", this.render);
    },
    render: function () {
        var self = this;
        this.collection.each(function(collectionModel){
            var view = new ModelView({ model : collectionModel });
            $(self.el).append(view.el);
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:46:18.907

您可以使用绑定`collection.on`到“添加”和“删除”事件。有关使用示例，请参阅[**添加**](http://backbonejs.org/#Collection)[下的文档。](http://backbonejs.org/#Collection)

 **```
this.collection.on("add", this.render); 
```

如果您使用的是 Backbone 0.9.0 或更高版本，则可以在同一语句中绑定多个事件：

```
this.collection.on("add remove", this.render); 
```

还要注意“bind”应该和“on”一样工作：

> 为了清楚起见，bind 和 unbind 已重命名为 on 和 off，遵循 jQuery 的领导。旧名称也仍受支持。**

# php - 没有设置安全标志和 HttpOnly 标志的 Cookie

> ID：13040309
> 
> 赞同：0
> 
> 时间：2012-10-23T22:27:34.600
> 
> 标签：php, html, cookies

最近在我们的一个应用程序上运行了一次扫描，它返回了以下 1 个安全威胁：

1.Cookies NotMarked As Secure::Cookie without Secure flag set

2.没有设置HttpOnly标志的Cookie::Cookiewithout HttpOnly标志设置

```
$this->cache_ptr = new CACHE($_COOKIE["sess"], 0, 0); 
```

CACHE 是一个用户构建的库，它使用 Sessions 等。

我不确定将 cookie 标记为安全并使用 HttpOnly 标志设置 cookie 的正确语法。此外，这是一个在 php 4 中运行的遗留应用程序。有人可以帮我解决这个问题或指向我的资源吗？

编辑：我实施了斯文的建议。有没有办法可以测试安全功能？

另外，由于我使用的是 php4（必须更新），所以我不能在 setcookie 函数中使用 httponly。那么这是否意味着，我需要在 setcookie 函数之前添加以下行？

```
header("Set-Cookie: hidden=value; httpOnly"); 
```

它会干扰我的 setcookie 功能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:30:20.793

使用`setcookie()`. [在这里](http://php.net/manual/en/function.setcookie.php)阅读它。将第六个参数设置为 true 以使 cookie 安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:33:27.517

您显示的代码没有设置 cookie。它可能会触发设置 cookie，但本质上您必须查看`CACHE`该类并查看那里发生了什么。

您正在寻找 的函数调用`setcookie()`，如果未找到，则为`header('Set-Cookie...')`.

您必须更改 setcookie() 以包含可选参数的所有默认值，直到最后您将最后两个设置为 true 以实现安全和 httponly。

看看手册：[http ://de1.php.net/setcookie](http://de1.php.net/setcookie)

# python - 使用 pandas TimeSeries 选择某个时间戳后的第一个索引

> ID：13040312
> 
> 赞同：5
> 
> 时间：2012-10-23T22:27:37.680
> 
> 标签：python, pandas, lazy-evaluation

这是一个由两部分组成的问题，一个是直接的问题，一个是更一般的问题。

我有一个熊猫时间序列，ts。知道一定时间后的第一个值。我可以做这个，

```
ts.ix[ts[datetime(2012,1,1,15,0,0):].first_valid_index()] 
```

a) 有没有更好、更简洁的方法来做到这一点？

b) 来自 C，在处理这些有点不透明、可能可变但通常不会、可能懒惰但并不总是类型时，我有某种恐惧症。所以要清楚，当我这样做时

```
ts[datetime(2012,1,1,15,0,0):].first_valid_index() 
```

ts[datetime(2012,1,1,15,0,0):] 是 pandas.TimeSeries 对象，对吗？我可能会改变它。

这是否意味着每当我分片时，都会在内存中分配 ts 的副本？这是否意味着这行无害的代码实际上可以触发一千兆字节的 TimeSeries 的副本只是为了获取索引值？

或者，如果其中一个对象发生突变，它们可能会神奇地共享内存并完成惰性复制？但是，您如何知道哪些特定操作触发了副本？也许不是切片，但重命名列怎么样？文档中似乎没有这样说。那会麻烦你吗？它应该困扰我还是我应该学会不用担心并使用分析器发现问题？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-23T23:16:18.527

一些设置：

```
In [1]: import numpy as np
In [2]: import pandas as pd
In [3]: from datetime import datetime
In [4]: dates = [datetime(2011, 1, 2), datetime(2011, 1, 5), datetime(2011, 1, 7), datetime(2011, 1, 8), datetime(2011, 1, 10), datetime(2011, 1, 12)]

In [5]: ts = pd.Series(np.random.randn(6), index=dates)

In [6]: ts
Out[6]: 
2011-01-02   -0.412335
2011-01-05   -0.809092
2011-01-07   -0.442320
2011-01-08   -0.337281
2011-01-10    0.522765
2011-01-12    1.559876 
```

好的，现在回答您的第一个问题，a）是的，根据您的意图，有一些不那么笨重的方法。这很简单：

```
In [9]: ts[datetime(2011, 1, 8):]
Out[9]: 
2011-01-08   -0.337281
2011-01-10    0.522765
2011-01-12    1.559876 
```

这是一个*切片*，包含您选择的日期之后的所有值。您可以根据需要选择第一个，方法是：

```
In [10]: ts[datetime(2011, 1, 8):][0]
Out[10]: -0.33728079849770815 
```

对于您的第二个问题，(b) - 这种类型的索引是原始索引的一部分，就像其他 numpy 数组一样。它不是原件的副本。请参阅此问题或许多类似问题： [Bug or feature: cloning a numpy array w/ slicing](https://stackoverflow.com/questions/4555431/bug-or-feature-cloning-a-numpy-array-w-slicing)

为了演示，让我们修改切片：

```
In [21]: ts2 = ts[datetime(2011, 1, 8):]
In [23]: ts2[0] = 99 
```

这会更改原始时间序列对象 ts，因为 ts2 是切片而不是副本。

```
In [24]: ts
Out[24]: 
2011-01-02    -0.412335
2011-01-05    -0.809092
2011-01-07    -0.442320
2011-01-08    99.000000
2011-01-10     0.522765
2011-01-12     1.559876 
```

如果您确实想要一个副本，您可以（通常）使用 copy 方法，或者（在这种情况下）使用 truncate：

```
In [25]: ts3 = ts.truncate(before='2011-01-08')

In [26]: ts3  
Out[26]: 
2011-01-08    99.000000
2011-01-10     0.522765
2011-01-12     1.559876 
```

更改此副本不会更改原件。

```
In [27]: ts3[1] = 99

In [28]: ts3
Out[28]: 
2011-01-08    99.000000
2011-01-10    99.000000
2011-01-12     1.559876

In [29]: ts                #The january 10th value will be unchanged. 
Out[29]: 
2011-01-02    -0.412335
2011-01-05    -0.809092
2011-01-07    -0.442320
2011-01-08    99.000000
2011-01-10     0.522765
2011-01-12     1.559876 
```

这个例子直接来自 Wes 的“Python for Data Analysis”。看看这个。这很棒。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:54:33.180

我不知道熊猫，一个一般的答案：

你可以在 python 中重载任何东西，他们必须在那里完成。如果你[`__getitem__`](http://docs.python.org/reference/datamodel.html#object.__getitem__)在你的类上定义了一个特殊的方法，它会在你使用`obj[key]`or时被调用`obj[start:stop]`（在前一种情况下只用键作为参数，在后一种情况下用一个特殊的[`slice`对象](http://docs.python.org/library/functions.html#slice)）。然后，您可以返回任何您想要的东西。

下面是一个展示如何`__getitem__`工作的示例：

```
class Foo(object):
    def __getitem__(self, k):
        if isinstance(k, slice):
            return k.start + k.stop # properties of the slice object
        else:
            return k 
```

这给了你：

```
>>> f = range.Foo()
>>> f[42]
42
>>> f[23:42]
65 
```

我假设在您的示例中，该`__getitem__`方法返回一些特殊对象，其中包含日期时间对象以及对原始`ts`对象的引用。`first_valid_index`然后，当调用该方法或类似方法时，该特殊对象可以使用该信息来获取所需的信息。（它甚至不必修改原始对象，就像您提出的问题一样。）

*TL;DR：*学会不要担心:-)

**另外：**我很好奇，所以我自己实现了你上面描述的行为的一个最小示例：

```
class FilterableList(list):
    def __init__(self, *args):
        list.__init__(self, *args)
        self.filter = FilterProxy(self)

class FilterProxy(object):
    def __init__(self, parent):
        self.parent = parent

    def __getitem__(self, sl):
        if isinstance(sl, slice):
            return Filter(self.parent, sl)

class Filter(object):
    def __init__(self, parent, sl):
        self.parent = parent
        self.sl = sl

    def eval(self):
        return [e for e in self.parent if self.sl.start <= e <= self.sl.stop]

>>> l = FilterableList([4,5,6,7])
>>> f = l.filter[6:10]
>>> f.eval()
[6, 7]
>>> l.append(8)
>>> f.eval()
[6, 7, 8] 
```

# c++ - Trac 不会解析谷歌测试 xml 输出文件

> ID：13040313
> 
> 赞同：1
> 
> 时间：2012-10-23T22:27:57.530
> 
> 标签：c++, junit, trac, googletest

我已经运行了使用带有 --gtest_output="xml:test-results.xml" 标志的 google test 1.6.0 框架编写的单元测试，并获得了如下所示的测试结果文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<testsuites tests="8" failures="0" disabled="0" errors="0" time="81.396" name="AllTests">
  <testsuite name="TestSuite1" tests="8" failures="0" disabled="0" errors="0" time="81.396">
    <testcase name="Test1" status="run" time="6.391" classname="Class1" />
    <testcase name="Test2" status="run" time="6.1" classname="Class1" />
    <testcase name="Test3" status="run" time="7.146" classname="Class1" />
    <testcase name="Test4" status="run" time="16.164" classname="Class1" />
    <testcase name="Test5" status="run" time="25.145" classname="Class1" />
    <testcase name="Test6" status="run" time="6.099" classname="Class1" />
    <testcase name="Test7" status="run" time="6.162" classname="Class1" />
    <testcase name="Test8" status="run" time="8.187" classname="Class1" />
  </testsuite>
</testsuites> 
```

根据我在其他帖子中读到的内容，gtest xml 输出应该与 junit 解析器兼容。相关文章：[无法让 hudson 解析 JUnit 测试输出 XML](https://stackoverflow.com/questions/428553/unable-to-get-hudson-to-parse-junit-test-output-xml)

错误的另一种可能性是在我被咬的脚本中。在 Trac 0.12.2 上运行。这是我使用 java:junit 解析器解析 XML 文件的常用方法：

```
<build xmlns:java="http://bitten.edgewall.org/tools/java">

   <step id="parse_results" description="Gather Results" onerror="fail">  
     <java:junit file="/home/user/temp/test-results.xml" />
   </step>

</build> 
```

在trac中，它说构建成功，但是测试结果是空白的。0 次运行，0 次失败，0 次忽略，0 次错误

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T18:40:19.443

我能够解决这个问题。事实证明，Trac 的 JUnit 解析器有一个错误。它不喜欢 testsuites 标签，也不喜欢有多个 testsuite 部分。PHP 允许使用 testsuites 标签，但不会做多个文件。我选择在 Python 中创建一个解析器，它从 Gtest 输出文件创建多个 XML 文件。

```
def move_results(results, results_dir):
    # Moves all results into a temp folder to be consumed by Bitten
    # Files with multiple test suite sections, split into individual files
    for files in results:
        fin = open(files)
        test_id = 0
        split_line = files.split('/')
        file_name = split_line[len(split_line)-1].split('.xml')
        for line in fin:
            if not 'testsuites' in line:
                if '<testsuite ' in line:
                    output_file = results_dir + file_name[0] + '-' + str(test_id) + '.xml'
                    test_id = test_id + 1
                    fout = open(output_file, 'w')
                    fout.write('<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n')
                    fout.write(line)
                elif '<testsuite\\>' in line:
                    fout.write(line)
                    fout.close()
                elif not '<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n' in line:
                    fout.write(line)
        fin.close()
        os.remove(files) 
```

或者，您可以使用 Bitten 使用 XSLT 进行转换。您还可以将输出文件组合成单个输出（使用类似鼻子的 XUnit 输出）并用于`php:phpunit`解析文件。

# jersey - 缺少带有 Jersey 的 HttpServletRequest 的依赖项

> ID：13040315
> 
> 赞同：6
> 
> 时间：2012-10-23T22:28:00.263
> 
> 标签：jersey

我在 JunitTest 开始时运行了一个独立的 Jersey 服务器。我正在测试我的[JaxRS 控制器](https://github.com/nicolas-zozol/robusta-web-library/blob/master/robusta/library/src/main/java/com/robustaweb/library/rest/controller/implementation/JaxRsResourceController.java)以及我的自定义 HttpClient 是否有效。请注意，我一直能够使用嵌入 glassfish 中的这个 JaxRsResourceController。

这是 JaxRsController（轻量版）

```
@Path("root")
public class JaxRsResourceController implements
        ResourceController<HttpServletRequest> {

    @Context
    private UriInfo context;
    @Context
    HttpServletRequest request;
    @Context
    HttpServletResponse response;

    @GET
    public String hello(){
        System.out.println("Uri is "+this.context.getBaseUri().toString());
        return "Hello "+peoples;
    }

} 
```

我的客户端没有问题，但是当我启动服务器时，我有：

```
GRAVE: The following errors and warnings have been detected with resource and/or provider classes:
  SEVERE: Missing dependency for field: javax.servlet.http.HttpServletRequest com.robustaweb.library.rest.controller.implementation.JaxRsResourceController.request
  SEVERE: Missing dependency for field: javax.servlet.http.HttpServletResponse com.robustaweb.library.rest.controller.implementation.JaxRsResourceController.response

    at com.sun.jersey.api.container.httpserver.HttpServerFactory.create(HttpServerFactory.java:172)
    at com.robustaweb.library.rest.server.JerseyServer.startServer(JerseyServer.java:44) 
```

基本上它说在@Context 注入时，不依赖于 HttpServletRequest。但是，如果我在请求和响应中删除 @Context 注释，但保留它`UriInfo context`，没关系，我可以读取 Uri.

我更改了几次 Maven pom，现在是强制库：

```
<dependencies>
    <dependency>
        <groupId>com.sun.jersey</groupId>
        <artifactId>jersey-server</artifactId>
        <version>1.14</version>
    </dependency>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>servlet-api</artifactId>
        <version>2.5</version>
    </dependency>
    <dependency>
        <groupId>javax.ws.rs</groupId>
        <artifactId>jsr311-api</artifactId>
        <version>1.1.1</version>
    </dependency>
    <dependency>
        <groupId>javax.servlet.jsp</groupId>
        <artifactId>jsp-api</artifactId>
        <version>2.1</version>
    </dependency>
 </dependencies> 
```

任何的想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T05:52:05.293

servlet 依赖项被分离到另一个模块，尝试添加

```
<dependency>
    <groupId>com.sun.jersey</groupId>
    <artifactId>jersey-servlet</artifactId>
    <version>1.14</version>
</dependency> 
```

到你的 pom。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T09:39:17.333

这并不容易，但我发现了。问题是在我的 JUnit 测试中，我正在创建这样的服务器：

```
HttpServer server = HttpServerFactory.create(url); 
```

但是这样一来，您创建了一个没有 servlet 容器的轻量级容器，失败的原因也是如此。所以为了拥有这一切，我使用了 jersey-test-framework 允许使用 Grizzly web 容器（甚至是 Embedded glassfish）。

这是行家：

```
<dependencies>
    <dependency>
        <groupId>javax.ws.rs</groupId>
        <artifactId>jsr311-api</artifactId>
        <version>1.1.1</version>
    </dependency>
    <!-- Unit test are using jersey server directly -->        
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.8.1</version>
        <scope>test</scope>
    </dependency>        
    <dependency>
        <groupId>com.sun.jersey.test.framework</groupId>
        <artifactId>jersey-test-framework</artifactId>
        <version>1.0.3</version>
        <scope>test</scope>
    </dependency>    
</dependencies> 
```

这是 JerseyServerTest ：注意它扩展了 JerseyTest

```
public class JerseyServerTest extends JerseyTest {

    protected String baseUri = "http://localhost:" + TestConstants.JERSEY_HTTP_PORT + "/";

    public JerseyServerTest() throws Exception {
        super("com.robustaweb.library.rest.controller");

        /*
        It's possible to NOT call the super() but to manually do :
        1)  ApplicationDescriptor appDescriptor = new ApplicationDescriptor()
                .setRootResourcePackageName(resourcePackageName) // resource packages
                .setContextPath(contextPath) //context of app
                .setServletPath(servletPath); // context of spi servlet
        2)setupTestEnvironment(appDescriptor);
         */
    }

    @Test
    public void testHelloWorldRequest() {
        SunRestClient client = new SunRestClient(baseUri + "root");
        String result = client.GET("", null);
        System.out.println(result);
    }

    @Test
    public void testDeleteRequest() {
        SunRestClient client = new SunRestClient(baseUri + "root");
        String result = client.DELETE("john", null);
        System.out.println(result);
    }
} 
```

最后是包含@GET 和@DELETE 的资源文件

```
@Path("root")
public class JaxRsController extends JaxRsResourceController{

    List<String> peoples = new ArrayList<String>();

    @GET
    public String hello(){
        System.out.println("Uri is "+getUri());
        return "Hello "+peoples;
    }   

    @DELETE
    @Path("{name}")
    public String deletePeople(@PathParam("name") String name){
        System.out.println("deleting "+name);
        this.peoples.remove(name);
        return String.valueOf(peoples.size());
    }
} 
```

现在它起作用了！我在[这篇文章](https://blogs.oracle.com/naresh/entry/jersey_test_framework_makes_it)中得到了一些帮助，并且有一个[关于文档的小章节](http://jersey.java.net/nonav/documentation/latest/test-framework.html)。Beeing 能够附加 Jersey 框架的源代码真的很有帮助，所以也感谢 IntelliJ。

# vb.net - 应用程序设置...我应该选择“漫游”还是不选择？

> ID：13040319
> 
> 赞同：1
> 
> 时间：2012-10-23T22:28:15.653
> 
> 标签：vb.net

我正在 VB.NET (2010) 项目中创建一些应用程序设置，具有“用户”范围。我想弄清楚的是......我应该将这些应用程序设置的“漫游”属性设置为真还是假？

在对该主题进行了一些在线研究之后，我仍然不明白为什么我会选择一个选项而不是另一个选项。那么任何人都可以对此有所了解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-14T15:07:34.427

我的想法是这样的：如果设置是 1) 适合漫游（不大）和 2) 可能对确实有漫游配置文件的用户有用，那么它们应该被存储用于漫游。您的程序用户拥有漫游配置文件的可能性有多大是无关紧要的。如果您的程序永远不会被具有漫游配置文件的用户使用，那么存储漫游没有任何不利之处。对于没有漫游配置文件的用户而言，唯一的区别是设置存储在哪个目录中。但是，如果您不为漫游而存储，然后有一天具有漫游配置文件的用户使用您的系统，那么他们将从您的明智之举中受益选择。

# sql - 找到每个可能的组合的更有效的方法

> ID：13040320
> 
> 赞同：0
> 
> 时间：2012-10-23T22:28:23.813
> 
> 标签：sql, math, cartesian

这对我来说有点难以解释，我试图获得所有可能的数字组合，而只使用一次数字，例如，如果我有数字 1 到 10 并且想要 3 个一组的唯一组合：

```
1,2,3
4,5,6
7,8,9 
```

这些很好，但我目前正在一些表上进行笛卡尔连接，所以对于我得到的第一组：

```
1,2,3
3,2,1
1,3,2
2,3,1
2,1,3 
```

等等......因为我已经使用过 1,2,3 一次，所以我不想要它的所有其他组合。

这是我目前正在使用的代码，我不太确定如何在 SQL 中执行我想要的操作。id1,id2,id3 是我试图找到所有可能组合的 3 个数字。

```
INSERT INTO recipe_index
SELECT distinct '3' as nummeals, t1.id as id1, t2.id as id2, t3.id as id3,   
t1.calories+t2.calories+t3.calories as calories, t1.protein+t2.protein+t3.protein as  
protein, t1.carbohydrate+t2.carbohydrate+t3.carbohydrate as carbohydrate, 
t1.fat+t2.fat+t3.fat as fat from recipes t1, recipes t2, recipes t3 
```

我希望我在这里试图完成的事情是有道理的..

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T22:39:22.370

```
INSERT INTO recipe_index
SELECT t1.Id as t1Id, t2.id as t2Id, t3.id as T3id
   t1.calories+t2.calories+t3.calories as calories, 
   t1.protein+t2.protein+t3.protein as protein, 
   t1.carbohydrate+t2.carbohydrate+t3.carbohydrate as carbohydrate, 
   t1.fat+t2.fat+t3.fat as fat 
FROM recipes t1
JOIN recipes t2 on T2.id < t1.Id
JOIN recipes t3 on t3.id < t2.id 
```

这将产生所有配方 ID 中的三个 ID 的所有组合，而不会产生任何重复（如果我们认为重复也包括相同 ID 但顺序不同的序列）。

现在，如果我理解了这个问题，我们想从 recipe_index 中提取所有使用所有 Id 一次且仅一次的行组合。（注意，只使用一次*所有*id，这意味着配方的数量是 3 的倍数）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:40:37.160

我不知道这有多好，但可以完成这项工作：

```
INSERT INTO recipe_index
SELECT distinct '3' as nummeals, t1.id as id1, t2.id as id2, t3.id as id3,   
t1.calories+t2.calories+t3.calories as calories, t1.protein+t2.protein+t3.protein as  
protein, t1.carbohydrate+t2.carbohydrate+t3.carbohydrate as carbohydrate, 
t1.fat+t2.fat+t3.fat as fat from recipes t1 inner join  recipes t2  on t1.Id < t2.Id inner join  recipes t3  on t2.Id < t3.Id 
```

# php - use php fb application on more than one website

> ID：13040326
> 
> 赞同：-1
> 
> 时间：2012-10-23T22:29:33.267
> 
> 标签：php, facebook, facebook-graph-api

Hi alla i developed a facebook application with php and I use it on my website. A customer of mine tried this application and wants to integrate it into his website. Is there a way to share my fb app from my website without create a new app and clone the existing one ?

If possible I prefer to avoid javascript

Thanks in advance

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:19:57.540

No. But just create a new fb app for your customer, copy the code to his site, and change the app_id and app_secret. And then you'll have a clone of the app on his site with his own app_id.

If you try to run the same app_id on different domains, you'll get this error message from FB when you attempt to init the SDK:

"Given URL is not allowed by the Application configuration.: One or more of the given URLs is not allowed by the App's settings. It must match the Website URL or Canvas URL, or the domain must be a subdomain of one of the App's domains."

Note that the website's domain (example.com) is defined in your app settings in the FB [App Dashboard](https://developers.facebook.com/apps).

If you try to configure his-domain.com in the Basic section of your app settings, you'll get this error: "Error: his-domain.com must be derived from one of: Site URL, Mobile Site URL, Canvas URL, Secure Canvas URL, Page Tab URL or Secure Page Tab URL"

# php - 如何更改日期上的此查询以以 mysql 典型以外的格式显示

> ID：13040329
> 
> 赞同：0
> 
> 时间：2012-10-23T22:29:59.623
> 
> 标签：php, mysql

我从查询结果中得到以下回声（在购买产品时显示），但更希望显示它，而不是***2013-01-30***到简单的***0130***。

如何重新编码以产生所需的结果？

**注意：** 这只是一行回显的结果；所以，我不想改变 mysql 查询本身。

```
echo htmlspecialchars(stripslashes($row['bookdate'])),'</u>'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:33:41.590

只需选择约会的适当部分：

```
$parts = explode('-', $row['bookdate']);
echo htmlspecialchars(stripslashes($parts[1] . $parts[2])),'</u>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:32:10.220

`DATE_FORMAT`选择日期时可以使用：

```
SELECT DATE_FORMAT(bookdate, '%m%d') AS myDate ... 
```

[文档](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_date-format)

# android - Android 应用程序如何在 Web URL 上检索、缓存和呈现自定义横幅图像？

> ID：13040330
> 
> 赞同：0
> 
> 时间：2012-10-23T22:30:01.357
> 
> 标签：android, url, caching, imageview

我有一个 Android 应用程序，在用户登录后，它会在每个布局的顶部显示一个自定义横幅，其中该横幅图像根据用户的登录组织而有所不同。（例如，一旦登录，整个应用程序中都会出现相同的横幅图像）。

登录时，我在用户的首选项中捕获了三个字母的 orgID。基于此 orgID，横幅图像使用 URL 约定存储在 Internet 上......（其中 YYY 是三个字母的 orgID）

[http://www.domain.com/customimage/YYY-banner.png](http://www.domain.com/customimage/YYY-banner.png)

此横幅将在整个应用程序中使用 - 我不想每次用户加载页面时都上传图像 - 我想上传和缓存图像并在每个应用程序页面上使用它。

最好的方法是什么？（例如只上传一次图像）。代码赞赏​​。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T05:15:52.790

因此，您可以将图像下载到用户设备上的目录中。当您启动应用程序时，首先清除该目录（这样您就不会意外使用上次运行期间下载的图像）。然后将图像下载到目录中。现在，每次应用页面更改时，无需再次从 Web 获取它，只需检查图像是否已经存在于目录中并使用它，如果是这样的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T02:59:20.713

我不确定您为什么一直提到“上传”，因为听起来您正在下载图像。我会将图像下载到您的手机上并像自定义 ActionBar 一样使用它。您可以为操作栏设置自定义视图，因此只需创建一个图像视图，为其提供横幅并将其设置在操作栏上。

如果您没有使用 Honeycomb+ 或 ABS 之类的库，您可以将布局包装在线性布局中，该布局在顶部有一个用于横幅的图像视图，在其下方有一个内容。

# multithreading - 哪些 perl 内置函数是原子的？

> ID：13040333
> 
> 赞同：8
> 
> 时间：2012-10-23T22:30:25.870
> 
> 标签：multithreading, perl

我正在编写一些线程代码，我想知道 Perl 内置的函数和运算符是原子的并且可以安全地在共享变量上使用而无需锁定。例如，有人告诉我`++`,`--`等`+=`不是因为它们是作为两个操作实现的。

某处有清单吗？特别是`push`, `pop`, `shift`,`unshift`和`splice`在共享数组上是原子的吗？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T23:17:02.423

指导原则：如果是 tie 支持的操作，它是原子的。否则，它不是。

控制：

```
use strict;
use warnings;
use feature qw( say );
use threads;
use threads::shared;

use constant NUM_THREADS => 4;
use constant NUM_OPS     => 100_000;

my $q :shared = 0;

my @threads;
for (1..NUM_THREADS) {
   push @threads, async {
      for (1..NUM_OPS) {
         ++$q;
      }
   };
}

$_->join for @threads;

say "Got:      ", $q;
say "Expected: ", NUM_THREADS * NUM_OPS;
say $q == NUM_THREADS * NUM_OPS ? "ok" : "fail"; 
```

输出：

```
Got:      163561
Expected: 400000
fail 
```

`push @a, 1;`而不是`++$q`：

```
Got:      400000
Expected: 400000
ok 
```

# c - While 循环不会按 C 中的预期中断

> ID：13040340
> 
> 赞同：0
> 
> 时间：2012-10-23T22:30:51.470
> 
> 标签：c, loops, while-loop

我正在尝试学习如何用 C 编程并偶然发现了一个似乎应该是一个简单的解决方法的问题，但它给了我比我预期的更多的问题。我正在尝试创建一个数字猜谜游戏，您有 3 次猜测数字的机会，但我的问题是，当猜到正确答案时，Do While 循环不会中断。这是功能：

```
void Win_Search(int lucky[],const int MAX, int user_entry, int i)
{
    int j=0;

    do {
        j++;
        printf("Please enter a number between 0 and 100\n");
        scanf("%d",&user_entry);

        for(i = 0; i < MAX; i++)
        {
            if(user_entry==lucky[i])
            {
                printf("winner\n");
            }
        }
    } while(user_entry==lucky[i]||j<3);

} 
```

基本上它应该遍历数组 lucky[i] 并检查 user_entry 是否等于数组中的 20 个数字中的任何一个。截至目前，它循环通过，识别是否已从数组中选择了中奖号码，但不会从数组中中断。

当我将其更改为

```
}while(user_entry!=lucky[i]||j<3); 
```

它完全忽略了计数器，只是永远循环。

我不想使用 break 因为我读到的所有关于它的内容都在谈论它是糟糕的编程实践。有没有另一种方法可以打破，或者只是犯了一个导致这个问题的错误。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T22:37:49.467

考虑一下您的索引变量“i”的来源。找到正确的用户条目后会发生什么？控制流去哪儿了？

我建议看一下“break”关键字。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T22:38:38.733

你写`while (user_entry == lucky[i]..)`的翻译成`as long as user_entry is equal to lucky[i] keep on looping`. 这显然不是你打算做的。

将您的条件转换为`} while (user_entry != lucky[i] && j < 3);`，您应该会没事的。这将用简单的英语翻译成`as long as user_entry is different of lucky[i] AND j is inferior to 3, keep looping`.

但是使用它，您可以测试`lucky[i]`即使`i`没有任何意义的值（当 i 等于 max 时，您不想测试它，这属于[未定义行为](http://en.wikipedia.org/wiki/Undefined_behavior)的领域）。

但是，如果您真的不想使用`break`关键字，一种解决方案是使用标志。在开始循环之前将其设置为 1，并在找到好的答案时将其更改为 0。您的代码将变为

```
void Win_Search(int lucky[],const int MAX, int user_entry, int i)
{
    int j=0;
    char flag = 1;

    do {
        j++;
        printf("Please enter a number between 0 and 100\n");
        scanf("%d",&user_entry);

        for(i = 0; i < MAX; i++)
        {
            if(user_entry==lucky[i])
            {
                printf("winner\n");
                flag = 0;
            }
        }
    } while(flag&&j<3);

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:36:32.053

`}while(user_entry!=lucky[i]||j<3);`

这是一个糟糕的逻辑 - 当用户输入的不是幸运数字或 j 低于三时循环？当然你真的想要这个：

`}while(user_entry!=lucky[i]&&j<3);`

这只是您忽略计数器的第二个问题的解决方案 - 主要问题已在其他答案中解决。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T22:55:38.497

唯一独立的条件是用户还有更多的猜测。试试这个”

```
while(j <= 3); 
```

小于应该是显而易见的，但等于属于那里，因为你在循环之前增加你的 j 所以它将是

j = 1 => 第一个猜测

j = 2 => 第二次猜测

j = 3 => 第三次猜测

在那之后，用户应该没有更多的猜测

您应该会发现这不起作用，那是因为如果用户猜对了，我们想退出循环。为此，您可以将 int 用作 bool（0-false，1-yes）。

```
void Win_Search(int lucky[],const int MAX, int user_entry, int i)
{
    int j=0;
    int exitCase = 0;
    do {
        j++;
        printf("Please enter a number between 0 and 100\n");
        scanf("%d",&user_entry);

        for(i = 0; i < MAX; i++)
        {
            if(user_entry==lucky[i])
            {
                exitCase = 1;
                printf("winner\n");
            }
        }
    } while(exitCase == 0 || j <= 3);

} 
```

# python - 如何使用python mechanize设置Referer？

> ID：13040341
> 
> 赞同：1
> 
> 时间：2012-10-23T22:31:00.497
> 
> 标签：python, mechanize, referer

我正在编写 python 程序以编程方式登录网站。现在我在处理 cookie 时遇到了问题。以下是我的代码：

```
import mechanize
cj = mechanize.CookieJar()
browser = mechanize.Browser()
browser.set_cookiejar(cj)
opener = mechanize.build_opener(*browser.handlers) 
```

它给了我这样的错误：

```
Traceback (most recent call last):
File "/usr/local/lib/python2.7/site-  packages/django/core/handlers/base.py", line 111, in get_response

response = callback(request, *callback_args, **callback_kwargs)
File "/home/test/testEnv/apps/arachni/views.py", line 983, in handle_request
content = opener.open(req, data).read()
File "build/bdist.linux-i686/egg/mechanize/_opener.py", line 188, in open
req = meth(req)
File "build/bdist.linux-i686/egg/mechanize/_http.py", line 316, in http_request
self.rfp.read()
File "build/bdist.linux-i686/egg/mechanize/_http.py", line 242, in read
f = self._opener.open(req)
File "build/bdist.linux-i686/egg/mechanize/_opener.py", line 204, in open
response = meth(req, response)
File "build/bdist.linux-i686/egg/mechanize/_urllib2_fork.py", line 457, in http_response
'http', request, response, code, msg, hdrs)
File "build/bdist.linux-i686/egg/mechanize/_opener.py", line 221, in error
result = apply(self._call_chain, args)
File "build/bdist.linux-i686/egg/mechanize/_urllib2_fork.py", line 332, in _call_chain
result = func(*args)
File "build/bdist.linux-i686/egg/mechanize/_urllib2_fork.py", line 571, in http_error_302
return self.parent.open(new)
File "build/bdist.linux-i686/egg/mechanize/_opener.py", line 188, in open
req = meth(req)
File "build/bdist.linux-i686/egg/mechanize/_mechanize.py", line 71, in http_request
request = self.parent._add_referer_header(
AttributeError: OpenerDirector instance has no attribute '_add_referer_header' 
```

好像我没有正确处理“推荐人”。任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T00:01:38.587

```
# Browser
br = mechanize.Browser()
br.set_handle_referer(False)    # allow everything to be written to
br.set_handle_robots(False)   # no robots
br.set_handle_refresh(True)  # can sometimes hang without this
br.set_handle_redirect(True)
br.addheaders = [('User-Agent', 'Mozilla/5.0 (Linux; U; Android 2.3.4; en-us; T-Mobile myTouch 3G Slide Build/GRI40) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1'),
                    ('Accept', 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8'),
                    ('Accept-Language', 'en-gb,en;q=0.5'),
                    ('Accept-Encoding', 'gzip,deflate'),
                    ('Accept-Charset', 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'),
                    ('Keep-Alive', '115'),
                    ('Connection', 'keep-alive'),
                    ('Cache-Control', 'max-age=0'),
                    ('Referer', 'http://yahoo.com')] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:40:54.713

您可以尝试创建这样的开瓶器吗？

```
opener = mechanize.build_opener(
    mechanize.HTTPCookieProcessor(cj),
    mechanize.HTTPRefererProcessor,
    mechanize.HTTPEquivProcessor,
    mechanize.HTTPRefreshProcessor) 
```

# vb.net - 修改 Excel 工作表时随机出现 COM 异常

> ID：13040342
> 
> 赞同：3
> 
> 时间：2012-10-23T22:31:02.120
> 
> 标签：vb.net, excel, com

我正在构建一个生成一些数据然后将其输出到 Excel 工作表的应用程序。有时这张表格有数千行长，所以我使用 BackgroundWorker 来处理它（请注意，我使用了一个进度条来阻止编辑以阻止用户在生成电子表格时对其进行修改）。

不幸的是，当发生这种情况时，程序由于 COM 异常而随机崩溃。随机是指异常发生在执行过程中的不同时间，有时根本不会发生。这是导致问题的代码，总是在使用`sheet`变量的行上调用异常。

```
Public Sub modifyCell(ByRef sheet As Worksheet, ByVal row As Integer, ByVal column As Integer, ByRef value As String)

    sheet.Cells(row, column) = value

End Sub

Public Sub colorRange(ByRef sheet As Worksheet, ByVal iRow As Integer, ByVal iCol As Integer, ByVal fRow As Integer, ByVal fCol As Integer, ByVal color As Integer, ByRef type As String)

    If type Is "Interior" Then
        sheet.Range(sheet.Cells(iRow, iCol), sheet.Cells(fRow, fCol)).Interior.ColorIndex = color
    ElseIf type Is "Font" Then
        sheet.Range(sheet.Cells(iRow, iCol), sheet.Cells(fRow, fCol)).Font.ColorIndex = color
    End If

End Sub 
```

异常以不同的形式显示，包括“返回参数的类型无效。”、“来自 HRESULT 的异常：0x800A03EC”和其他一些 HRESULT 代码。

另一个可能很重要的奇怪之处 - 如果我捕捉到该异常然后立即执行同一行，它就可以工作。（即以下允许程序成功完成）

```
Try
    modify sheet code
Catch ex As Exception
    identical modify sheet code
End Try 
```

我已经做了很多狩猎，但我不知道如何阻止这种情况发生。异常的随机性使我认为它可能类似于在不可预测的时间运行的垃圾收集器，但我不知道如何去测试该理论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-29T16:43:37.360

我之前在 Excel 电子表格中遇到过奇怪的 COM 异常，我的解决方案是禁用 Excel 的自动恢复功能。Interop 似乎对能够随时访问 Excel 非常挑剔，对我来说，只要有任何中断它就会抛出异常。

您可以这样禁用自动恢复：

```
xlApp.Autorecover.Enabled = False 
```

但请记住在最后再次启用它，否则它将永远关闭。

不确定这是否能解决您的问题，但可能值得一试。

# wcf - 为 WCF 文件上传创建 CXF 代理客户端

> ID：13040343
> 
> 赞同：1
> 
> 时间：2012-10-23T22:31:14.103
> 
> 标签：wcf, file-upload, cxf

我正在尝试为文件上传创建一个 WCF 服务（VS2012 中的 .Net 4.5），该服务可由其他语言的客户端使用，尤其是 Java（使用 CXF）。我已经从 .Net 客户端获得了 WCF 方面的出色工作，但在 CXF 方面遇到了一些问题。

当我尝试通过 Eclipse（4.2/Juno）从 WSDL 生成 CXF 中的代理时，我遇到了一个阻止创建代理的异常：

```
wsdl2java -client -d C:\Users\Ryan\workspace\WcfProxy\.cxftmp/src -classdir C:\Users\Ryan\workspace\WcfProxy\build\classes -p http://tempuri.org/=org.tempuri -impl -validate -exsh false -dns true -dex true -wsdlLocation http://localhost:10186/UploadFile.svc?wsdl -verbose -defaultValues -fe jaxws -db jaxb -wv 1.1 http://localhost:10186/UploadFile.svc?wsdl
wsdl2java - Apache CXF 2.7.0

WSDLToJava Error: Schema Error : src-resolve: Cannot resolve the name 'ns0:StreamBody' to a(n) 'type definition' component.

org.apache.cxf.tools.common.ToolException: Schema Error : src-resolve: Cannot resolve the name 'ns0:StreamBody' to a(n) 'type definition' component.
at org.apache.cxf.tools.wsdlto.databinding.jaxb.JAXBDataBinding.validateSchema(JAXBDataBinding.java:914)
at org.apache.cxf.tools.wsdlto.databinding.jaxb.JAXBDataBinding.addSchemas(JAXBDataBinding.java:586)
at org.apache.cxf.tools.wsdlto.databinding.jaxb.JAXBDataBinding.initialize(JAXBDataBinding.java:392)
at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.generateTypes(WSDLToJavaContainer.java:603)
at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.processWsdl(WSDLToJavaContainer.java:248)
at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.execute(WSDLToJavaContainer.java:142)
at org.apache.cxf.tools.wsdlto.WSDLToJavaContainer.execute(WSDLToJavaContainer.java:300)
at org.apache.cxf.tools.common.toolspec.ToolRunner.runTool(ToolRunner.java:103)
at org.apache.cxf.tools.wsdlto.WSDLToJava.run(WSDLToJava.java:113)
at org.apache.cxf.tools.wsdlto.WSDLToJava.run(WSDLToJava.java:86)
at org.apache.cxf.tools.wsdlto.WSDLToJava.main(WSDLToJava.java:184)
Caused by: org.xml.sax.SAXParseException; src-resolve: Cannot resolve the name 'ns0:StreamBody' to a(n) 'type definition' component.
at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(Unknown Source)
at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.error(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.reportSchemaErr(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.reportSchemaError(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.getGlobalDecl(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDElementTraverser.traverseNamedElement(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDElementTraverser.traverseLocal(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.traverseLocalElements(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.xs.traversers.XSDHandler.parseSchema(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaLoader.loadSchema(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaLoader.loadGrammar(Unknown Source)
at com.sun.org.apache.xerces.internal.impl.xs.XMLSchemaLoader.loadGrammar(Unknown Source)
at com.sun.org.apache.xerces.internal.jaxp.validation.XMLSchemaFactory.newSchema(Unknown Source)
at javax.xml.validation.SchemaFactory.newSchema(Unknown Source)
at org.apache.cxf.tools.wsdlto.databinding.jaxb.JAXBDataBinding.validateSchema(JAXBDataBinding.java:909)
... 10 more 
```

我的 WCF 服务合同如下：

```
<ServiceContract()>
Public Interface IUploadFile

    <OperationContract()>
    Sub UploadFile(ByVal remoteFile As RemoteFile)

    <OperationContract()>
    Function DownloadFile() As RemoteFile

End Interface 
```

我的 WCF 消息契约 ( `RemoteFile`) 如下：

```
<MessageContract()> _
Public Class RemoteFile
    Implements IDisposable

    <MessageHeader(MustUnderstand:=True)> _
    Public FileName As String

    <MessageHeader(MustUnderstand:=True)> _
    Public Length As Long

    <MessageBodyMember(Order:=1)> _
    Public FileByteStream As System.IO.Stream

    Public Sub Dispose() Implements IDisposable.Dispose
        If FileByteStream IsNot Nothing Then
            FileByteStream.Close()
            FileByteStream = Nothing
        End If
    End Sub
End Class 
```

我的 WCF 服务配置如下：

```
...
<system.serviceModel>
  <bindings>
    <basicHttpBinding>
      <binding name="FileTransferServicesBinding"
        transferMode="Streamed"
        messageEncoding="Mtom"
        maxReceivedMessageSize="10067108864">
      </binding>
    </basicHttpBinding>
  </bindings>
  <services>
    <service behaviorConfiguration="UploadServiceBehavior" name="Server.UploadFile">
      <endpoint address=""
            binding="basicHttpBinding"
            bindingConfiguration="FileTransferServicesBinding"
            contract="Server.IUploadFile" />
    </service>
  </services>
    <behaviors>
        <serviceBehaviors>
            <behavior name="UploadServiceBehavior">
                <serviceMetadata httpGetEnabled="true" httpsGetEnabled="true" />
                <serviceDebug includeExceptionDetailInFaults="false" />
            </behavior>
        </serviceBehaviors>
    </behaviors>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="true" />
</system.serviceModel>
... 
```

我的 WSDL 如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<wsdl:definitions name="UploadFile" targetNamespace="http://tempuri.org/">
<wsp:Policy wsu:Id="BasicHttpBinding_IUploadFile_policy">
    <wsp:ExactlyOne>
        <wsp:All>
            <wsoma:OptimizedMimeSerialization/>
        </wsp:All>
    </wsp:ExactlyOne>
</wsp:Policy>
<wsdl:types>
    <xsd:schema targetNamespace="http://tempuri.org/Imports">
        <xsd:import schemaLocation="http://localhost:10186/UploadFile.svc?xsd=xsd1" namespace="http://tempuri.org/"/>
        <xsd:import schemaLocation="http://localhost:10186/UploadFile.svc?xsd=xsd0" namespace="http://schemas.microsoft.com/Message"/>
        <xsd:import schemaLocation="http://localhost:10186/UploadFile.svc?xsd=xsd2" namespace="http://schemas.microsoft.com/2003/10/Serialization/"/>
    </xsd:schema>
</wsdl:types>
<wsdl:message name="RemoteFile">
    <wsdl:part name="parameters" element="tns:RemoteFile"/>
</wsdl:message>
<wsdl:message name="RemoteFile_Headers">
    <wsdl:part name="FileName" element="tns:FileName"/>
    <wsdl:part name="Length" element="tns:Length"/>
</wsdl:message>
<wsdl:message name="IUploadFile_DownloadFile_InputMessage"/>
<wsdl:portType name="IUploadFile">
    <wsdl:operation name="UploadFile">
        <wsdl:input wsaw:Action="http://tempuri.org/IUploadFile/UploadFile" name="RemoteFile" message="tns:RemoteFile"/>
    </wsdl:operation>
    <wsdl:operation name="DownloadFile">
        <wsdl:input wsaw:Action="http://tempuri.org/IUploadFile/DownloadFile" message="tns:IUploadFile_DownloadFile_InputMessage"/>
        <wsdl:output wsaw:Action="http://tempuri.org/IUploadFile/DownloadFileResponse" name="RemoteFile" message="tns:RemoteFile"/>
    </wsdl:operation>
</wsdl:portType>
<wsdl:binding name="BasicHttpBinding_IUploadFile" type="tns:IUploadFile">
    <wsp:PolicyReference URI="#BasicHttpBinding_IUploadFile_policy"/>
    <soap:binding transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsdl:operation name="UploadFile">
        <soap:operation soapAction="http://tempuri.org/IUploadFile/UploadFile" style="document"/>
        <wsdl:input name="RemoteFile">
            <soap:header message="tns:RemoteFile_Headers" part="FileName" use="literal"/>
            <soap:header message="tns:RemoteFile_Headers" part="Length" use="literal"/>
            <soap:body use="literal"/>
        </wsdl:input>
    </wsdl:operation>
    <wsdl:operation name="DownloadFile">
        <soap:operation soapAction="http://tempuri.org/IUploadFile/DownloadFile" style="document"/>
        <wsdl:input>
            <soap:body use="literal"/>
        </wsdl:input>
        <wsdl:output name="RemoteFile">
            <soap:header message="tns:RemoteFile_Headers" part="FileName" use="literal"/>
            <soap:header message="tns:RemoteFile_Headers" part="Length" use="literal"/>
            <soap:body use="literal"/>
        </wsdl:output>
    </wsdl:operation>
</wsdl:binding>
<wsdl:service name="UploadFile">
    <wsdl:port name="BasicHttpBinding_IUploadFile" binding="tns:BasicHttpBinding_IUploadFile">
        <soap:address location="http://localhost:10186/UploadFile.svc"/>
    </wsdl:port>
</wsdl:service>
</wsdl:definitions> 
```

显然，异常表明它在创建消息的流主体类型时遇到问题，但是有没有人看到我做错了什么或需要更改才能为此 WCF 服务生成 CXF 代理？

**编辑**在原始帖子中添加了 WSDL。

# mongodb - 对数组字段执行更新时，无法使用字符串字段名称 [$] 追加到数组

> ID：13040344
> 
> 赞同：6
> 
> 时间：2012-10-23T22:31:15.460
> 
> 标签：mongodb, mongodb-update

行我正在尝试对记录数组中的每个字段执行 mongodb 更新。

示例架构如下：

```
{
    "_id" : ObjectId("508710f16dc636ec07000022"),
    "summary" : "",
    "uid" : "ABCDEF",
    "username" : "bigcheese",
    "name" : "Name of this document",
    "status_id" : 0,
    "rows" : [
        {
            "score" : 12,
            "status_id" : 0,
            "uid" : 1
        },
        {
            "score" : 51,
            "status_id" : 0,
            "uid" : 2
        }
    ]
} 
```

到目前为止，我已经能够像这样执行单个更新：

```
db.mycollection.update({"uid":"ABCDEF","rows.uid":1}, {$set:{"rows.$.status_id":1}},false,false) 
```

但是，我正在努力解决如何执行将所有数组记录更新`status_id`为 1 的更新（例如）。

以下是我想象它应该如何工作：

```
db.mycollection.update({"uid":"ABCDEF"}, {$set:{"rows.$.status_id":1}},false,true) 
```

但是我得到了错误：

> 无法使用字符串字段名称 [$] 附加到数组

我已经尝试了很长一段时间没有运气。任何指针？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T23:07:49.477

您不能对正在寻找的数组元素进行那种“通配符”更新。我认为你能做的最好的就是同时设置每个元素的`status_id`值，如下所示：

```
db.mycollection.update(
    {"uid":"ABCDEF"},
    {$set:{
        "rows.0.status_id":1,
        "rows.1.status_id":1
    }}, false, true); 
```

# android - 如果我更改我的应用程序的包名称......当我上传到 googleplay 时，用户可以更新他们的应用程序吗？

> ID：13040347
> 
> 赞同：0
> 
> 时间：2012-10-23T22:31:30.980
> 
> 标签：android, publish, google-play

嗨，我在 googleplay 上有一个应用程序，我更新了应用程序的代码。

我将我的应用程序的主要活动移动到另一个包，从 com.myapp 到 com.myapp.activities。所以我必须将清单上的包名更改为 com.myapp.activities。

现在，我想将我的应用程序的更新上传到 googleplay。当用户将应用程序更新到此较新版本时，包名称更改是否会给用户带来问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:43:34.327

将应用程序上传到 Google Play 后，标签的`package`属性无法更改。这是应用程序的唯一 ID，不能更改它已发布的 ID。`manifest``AndroidManifest.xml`

但是，您*可以*移动主要活动本身；只需将其移动到新包中（就像您所做的那样），然后更改：

```
<activity android:name=".MyActivity" ... /> 
```

... 至：

```
<activity android:name="com.myapp.activities.MyActivity" ... /> 
```

# actionscript-3 - Flash As3：处理并从子类返回数据

> ID：13040351
> 
> 赞同：2
> 
> 时间：2012-10-23T22:31:38.553
> 
> 标签：actionscript-3

我被困在这里。我有一个子类，我想主要使用它来格式化一个名为 mystring 的字符串变量，其值会根据单击的对象而变化。我需要将 mystring 传递给子类并在那里格式化。然后将格式化的字符串返回给父类进行放置。我只是无法正确获取代码。有人可以帮忙吗？

```
Main Class: package {   public class parentclass extends Sprite{
        public var mystring:String="";

        public function parentclass () {
            mysting="good"
                         ---
                 }
           } 
```

儿童班：

```
package {
    public class childclass extends Sprite{

        public function childclass () {
            var mycapstring:String=
                        //do these 3 things: 
                        //1\. get the value of mystring from parentclass 
                        //2\. format mystring 
                        //3\. return formatted string to parentclass 
                }

         }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:42:28.740

首先，当您将某些内容引用为 a`child class`时，它意味着它扩展了`parent class`. 在您的情况下，您只是在另一个（组合）中使用一个类。

您是否有理由不想只拥有一个作为父类的一部分为您执行此操作的函数？

```
package {   
    public class ParentClass extends Sprite{

        protected var mystring:String = "";

         public function ParentClass () { 
             this.mysting = "good"
         }

         public function format():String {
             return this.mystring + " | " + this.mystring;
         }
    }
} 
```

这里还有其他事情吗？为什么`childclass`需要延长`Sprite`，是`DisplayObject`吗？您将需要提供更多背景信息，说明您要为我做的事情以进一步提供帮助。

# c# - RequireHttpsAttribute 和加密的请求数据

> ID：13040352
> 
> 赞同：1
> 
> 时间：2012-10-23T22:31:43.320
> 
> 标签：c#, .net, asp.net-mvc-routing, mvcroutehandler

我有一个接受敏感数据的控制器操作。

```
public ActionResult TakeSensitiveData(SensitiveData data){
 data.SaveSomewhere();
} 
```

为确保数据安全，我希望确保某些请求是使用 HTTPS（SSLv3、TLS 1）发出的。我考虑使用的方法之一是我的操作中的 RequireHttpsAttribute：

```
[RequireHttps]  
public ActionResult TakeSensitiveData(SensitiveData data){
     data.SaveSomewhere();
} 
```

但是，在对此进行测试时，我的提琴手透露，对该操作发出的 HTTP 请求是 302 重定向到 HTTPS。我的问题是这样的：

如果我发出了一个 302 重定向到 HTTPS 的请求，我是否已经在重定向之前通过 HTTP 发送了敏感数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:59:43.807

您需要将数据直接发布到 HTTPS。

注意：如果您有敏感数据，则无论如何都必须在 HTTPS 页面上输入。所以回发将是 HTTPS（或者你会从 Firefox 收到关于将 HTTPS 数据发布到 HTTP 的讨厌警告）。

# javascript - 使用 JS Raphael 创建导航栏。馊主意？好主意？

> ID：13040353
> 
> 赞同：2
> 
> 时间：2012-10-23T22:31:47.977
> 
> 标签：javascript, user-interface, svg, navigation, raphael

我正在尝试创建一个导航栏，该导航栏将位于我所有页面的网站顶部。

我对 Raphael 库使用的代码更加熟悉，而且它比创建一堆图块和相应的 JavaScript 对我来说要简单得多。

将画布用于这些目的有什么问题吗？

有没有人有更好的主意？

提前感谢您的任何建议。

**更新：**渲染速度有问题？同样，我完全愿意接受其他建议！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:00:07.220

简短的回答：可能不是最好的主意。

更长的答案：正如 Chimp 所暗示的那样，将画布用作关键元素肯定是个坏主意，因为不支持 javascript 和/或不支持画布的浏览器（包括网络蜘蛛和用于各种感知差异（失明等）的浏览器)) 什么也看不见。（对于人们来说，这意味着他们不会找到您的子页面。对于网络蜘蛛（Google 等）来说，这意味着没有人会找到您的子页面。）

如果你想使用 Raphael 或其他基于画布的解决方案，为了可访问性，你应该从一个基于 html 的导航元素开始（就像多年来一直在做的那样 div 中的 ul li），然后你将在页面时通过 javascript 替换它加载（有关如何执行此操作的示例，请参阅[HTML5 Canvas replace to <div> （包括 jsfiddle 链接）](https://stackoverflow.com/questions/6266456/html5-canvas-replace-to-div)

这不是最好的主意的原因是，您需要确保您的 html nav 元素与基于画布的元素保持同步 - 尽管我猜如果它是由服务器端进程（例如 wordpress）生成的，它不会太多更多的工作来构建 html nav 元素，然后你只需要定期测试它以确保它正常工作。

# ios - IOS 幻灯片菜单，如 facebook 和 path 2.0，适用于情节提要

> ID：13040356
> 
> 赞同：2
> 
> 时间：2012-10-23T22:31:55.363
> 
> 标签：ios, cocoa

我尝试到处寻找开源但找不到具有以下组合的可可控件。

1.  幻灯片菜单
2.  故事板。
3.  导航控制器。
4.  标签栏控制器。

我发现一个开源控件可以与 1,2,3 一起使用，但不能与 uitabbarcontroller 一起使用。 [http://www.cocoacontrols.com/platforms/ios/controls/saslidemenu](http://www.cocoacontrols.com/platforms/ios/controls/saslidemenu)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T23:44:43.813

我在一个涉及您列出的所有内容的项目中使用了[IIViewDeckController 。](http://www.cocoacontrols.com/platforms/ios/controls/iiviewdeckcontroller)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-13T22:51:47.043

我在 youtube 上制作了一个视频（3 部分），介绍如何制作您正在寻找的滑动菜单。我将向您展示如何设置项目并将所有内容联系起来。

[http://www.youtube.com/watch?v=tJJMyzdB9uI](http://www.youtube.com/watch?v=tJJMyzdB9uI)

按照这种设置方式，在从第一个视频创建文件时，您应该能够只选择 UINavigationController 而不是 UIViewController。

我使用 ECSlidingViewController 因为它最容易定制。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-27T06:57:58.583

这是我写的一个简单的。它建立在 UINavigationController 之上，因此您可以使用所有 UINavigationcontroller 功能以及滑动功能。无需像其他库那样为您的 ViewController 继承任何基类。适用于 Storyboard 和代码。

我没有尝试过，但我很确定如果您将标签栏控制器设置为这个自定义导航控制器的根视图控制器，它应该可以按预期工作。

[https://github.com/aryaxt/iOS-Slide-Menu](https://github.com/aryaxt/iOS-Slide-Menu)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-24T20:39:12.443

[https://github.com/arturdev/AMSlideMenu](https://github.com/arturdev/AMSlideMenu) 你可以使用这个简单的库。只需使用 AMSlideMenuContentSegue 类型的自定义 segue 将您的菜单 (tableViewController) 连接到您的 tabBarController。

# sql - jdbc.BadSqlGrammarException 表或视图不存在。在数据库中测试查询，有效。但是网络应用程序错误

> ID：13040363
> 
> 赞同：3
> 
> 时间：2012-10-23T22:32:17.187
> 
> 标签：sql, oracle, spring, jdbc

> **编辑：修复！往下看**

所以我在 SQL Developer 中测试了查询，它工作正常。但是，在我的实现中，运行不会将数据加载到列表中并吐出此错误：

> org.springframework.jdbc.BadSqlGrammarException: PreparedStatementCallback; 错误的 SQL 语法 [select columnname,displayname, viewsortorder,capsdisind,window, DIS FIELDID , (select 1 from WEB_CUSTDISABLEDFIELDS where custid =? AND A.DISFIELD ID = WEB_CUSTDISABLEDFIELDS.DISFIELDID) from web_DISABLEDFIELDS A ]; 嵌套异常是 java.sql.SQLSyntaxErrorException: ORA-00942: 表或视图不存在
> 在 org.springframework.jdbc.support.SQLErrorCodeSQLExceptionTranslator.d oTranslate(SQLErrorCodeSQLExceptionTranslator.java:220) 在 org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslat or.translate(AbstractFallbackSQLExceptionTranslator.java:72) 在 org.springframework.jdbc.core.JdbcTemplate .execute(JdbcTemplate.java: 607) at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:64 1) at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:67 0) at org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:67 8) 在 org.springframework.jdbc.core.JdbcTemplate.query(JdbcTemplate.java:71 0) 在 sun.reflect.NativeMethodAccessorImpl。sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) at sun.reflect.Native Method.invoke0(Native Method) at java.lang.reflect.Method.invoke(Unknown Source) at flex.messaging.services。 remoting.adapters.JavaAdapter.invoke(JavaAdap ter.java:421) 在 flex.messaging.services.RemotingService.serviceMessage(RemotingServic e.java:183) 在 flex.messaging.MessageBroker.routeMessageToService(MessageBroker.java :1503) 在 flex .messaging.endpoints.AbstractEndpoint.serviceMessage(AbstractEndp oint.java:884) 在 flex.messaging.endpoints.amf.MessageBrokerFilter.invoke(MessageBroker Filter.java:121) 在 flex.messaging.endpoints.amf.LegacyFilter.invoke(LegacyFilter .java：15 8) 在 flex.messaging.endpoints.amf.SessionFilter.invoke(SessionFilter.java: 44) 在 flex.messaging.endpoints.amf.BatchProcessFilter.invoke(BatchProcessFi lter.java:67) 在 flex.messaging.endpoints.amf .SerializationFilter.invoke(Serialization Filter.java:146) at flex.messaging.endpoints.BaseHTTPEndpoint.service(BaseHTTPEndpoint.ja va:278) at flex.messaging.MessageBrokerServlet.service(MessageBrokerServlet.java :322) at javax.servlet。 http.HttpServlet.service(HttpServlet.java:722) 在 org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Appl icationFilterChain.java:304) 在 org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationF ilterChain.java:210) 在 org.apache.catalina.core.StandardContextValve.invoke(StandardContextV alve.java:175) 在 org.apache.catalina.authenticator 的 org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperV alve.java:224) .AuthenticatorBase.invoke(Authentica torBase.java:472) at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.j ava:164) at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.j ava: 100）在 org.apache.catalina.core.StandardEngineValve.invoke（StandardEngineVal ve.java:118）在 org.apache.catalina.connector 的 org.apache.catalina.valves.AccessLogValve.invoke（AccessLogValve.java：929）。 CoyoteAdapter.service（CoyoteAdapter.java 一个：405) 在 org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:515) 在 org.apache.tomcat.util 的 org.apache.coyote.http11.Http11NioProcessor.process(Http11NioProcesso r.java:316)。 net.NioEndpoint$SocketProcessor.run(NioEndpoint t.java:1544) at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.lang。 Thread.run(Unknown Source) 原因：java.sql.SQLSyntaxErrorException: ORA-00942: oracle.jdbc.driver.SQLStateMapping.newSQLException(SQLStateMapping.ja va:91) at oracle.jdbc.driver 中不存在表或视图.DatabaseError.newSQLException（DatabaseError.java：1 12) 在 oracle.jdbc.driver.DatabaseError.throwSqlException(DatabaseError.java :173) 在 oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer.java:455) 在 oracle.jdbc.driver.T4CTTIoer.processError(T4CTTIoer. java:413) 在 oracle.jdbc.driver.T4C8Oall.receive(T4C8Oall.java:1030) 在 oracle.jdbc.driver.T4CPreparedStatement.doOall8(T4CPreparedStatement.java:194) 在 oracle.jdbc.driver.T4CPreparedStatement.executeForDescribe(T4CPrepare dStatement.java:785) 在 oracle.jdbc.driver.T4CPreparedStatement.executeMaybeDescribe(T4CPrepa redStatement.java:860) 在 oracle.jdbc.driver.OracleStatement.doExecuteWithTimeout(OracleStatement.java:1186) 在 oracle.jdbc.driver.OraclePreparedStatement .在 org.springframework 的 oracle.jdbc.driver.OraclePreparedStatementWrapper.executeQuery(Oracle PreparedStatementWrapper.java:1490) 的 oracle.jdbc.driver.OraclePreparedStatement.executeQuery(OraclePrepare dStatement.java:3425) 的 executeInternal(OraclePrep aredStatement.java:3381)。 jdbc.core.JdbcTemplate$1.doInPreparedStatement(Jd bcTemplate.java:648) at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java: 591) ... 还有 39 个jdbc.core.JdbcTemplate$1.doInPreparedStatement(Jd bcTemplate.java:648) at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java: 591) ... 39 更多jdbc.core.JdbcTemplate$1.doInPreparedStatement(Jd bcTemplate.java:648) at org.springframework.jdbc.core.JdbcTemplate.execute(JdbcTemplate.java: 591) ... 39 更多

我已经搜索了这个错误的多个问题，但它们似乎都没有解决与地雷相同的问题。我正在使用 Oracle SQL。

也许有人以前遇到过这个问题？任何帮助表示赞赏。谢谢！

**修复了问题**

问题是桌子。他们只需要访问数据库中的权限即可。

我所做的是这样的：

```
grant all on sa.table to public
/
create public synonym table for sa.table
/
grant all on sa.table2 to public
/
create public synonym table2 for sa.table2
/ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T23:00:40.013

您的 Web 应用程序很可能登录到与您的表不同的架构

尝试在 sql 语句中明确指定模式。IE ：

```
SELECT a, b FROM user.TABLE 
```

# javascript - 在对象初始化器中设置属性时不再调用设置器：这是什么意思？

> ID：13040367
> 
> 赞同：5
> 
> 时间：2012-10-23T22:33:22.977
> 
> 标签：javascript

在这个[JS MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Working_with_Objects?redirectlocale=en-US&redirectslug=Core_JavaScript_1.5_Guide/Working_with_Objects#Defining_getters_and_setters)页面上它说：

> **JavaScript 1.8.1 注意**
> 
> 从 JavaScript 1.8.1 开始，在对象和数组初始值设定项中设置属性时不再调用 setter。

我只是想不通这是想告诉我什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T22:50:23.520

此代码片段：

```
var o = {};
o.seven = 7; 
```

这个代码片段：

```
var o = { seven: 7 }; 
```

通常是等价的；但如果它们前面有这个代码片段：

```
Object.prototype.__defineSetter__('seven', function(x) { alert(x); }); 
```

那么只有前者会发出警报`7`（因为 setter 是由 调用的`o.seven = 7`，而不是由调用的`o = { seven: 7 }`），并且只有后者会实际设置`o.seven`为`7`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-23T23:15:52.877

我认为这是指 JSON 劫持的问题。看一下

*   [是否可以在现代浏览器上进行“JSON 劫持”？](https://stackoverflow.com/q/8587567/1048572)
*   [http://incompleteness.me/blog/2007/03/05/json-is-not-as-safe-as-people-think-it-is/](http://incompleteness.me/blog/2007/03/05/json-is-not-as-safe-as-people-think-it-is/)
*   [http://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx，http://haacked.com/archive/2009/06/25/json-hijacking](http://haacked.com/archive/2008/11/20/anatomy-of-a-subtle-json-vulnerability.aspx) [。](http://haacked.com/archive/2009/06/25/json-hijacking.aspx) _ [aspx](http://haacked.com/archive/2009/06/25/json-hijacking.aspx)
*   [http://hackademix.net/2009/01/13/you-dont-know-what-my-twitter-leaks/](http://hackademix.net/2009/01/13/you-dont-know-what-my-twitter-leaks/)

要从[这个已删除](https://stackoverflow.com/q/12734377/1048572)的问题中重新发布我的答案：

> 根据规范，数组（[EcmaScript 5.1 §11.1.4](http://es5.github.com/#x11.1.4)）和对象文字（[EcmaScript 5.1 §11.1.5](http://es5.github.com/#x11.1.5)）都不应该被劫持：
> 
> *   他们称“*具有该名称的标准内置构造函数*”，而不是您可能在`window.Array`或`window.Object`
> *   他们使用 [[defineOwnProperty]]，它绝对不会处理`Object.prototype`.

如今，这在 ES 5.1 兼容的浏览器中应该不再是问题。

# asp-classic - ASP：阻止我的宽带提供商

> ID：13040376
> 
> 赞同：1
> 
> 时间：2012-10-23T22:34:11.667
> 
> 标签：asp-classic

这是关于经典 ASP 的。我发现了一些严重的问题：几秒钟后，我访问了我网站中的一些页面（ASP、txt、html），我的宽带提供商将访问相同的页面。你知道任何 ASP 代码来阻止它吗？

我知道我可以放一些 ASP 代码来阻止宽带提供商的 IP，但我不知道它的所有 IP。

我将不胜感激任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T06:40:30.800

猜猜如果您阻止互联网提供商的 IP 范围会发生什么，您自己对网页的访问也将被阻止。

您的 ISP 可能会通过机器人或其他东西自动访问您的页面以创建缓存。在这种情况下，您可能会做的是扫描访问者的用户代理，并仅向那些通过实际浏览器访问您的页面的人提供页面，例如：Chrome 或 Firefox 等。但请记住，您将阻止访问合法的机器人，例如 Googlebot 等搜索引擎爬虫。

无论如何，如果您有一个只希望您自己访问的管理部分，我建议您通过会话、Cookie 和/或 SSL 连接来保护它。

祝你好运...

# javascript - 由于 JQUERY 或 HTML，ImageMapper 无法正常工作

> ID：13040378
> 
> 赞同：-4
> 
> 时间：2012-10-23T22:34:22.650
> 
> 标签：javascript, jquery, html, css

我正在关注这个 jsfiddle：http: [//jsfiddle.net/nYkAG/396/](http://jsfiddle.net/nYkAG/396/)它运行良好。

下面的代码：

```
<img id="beatles" src="http://www.outsharked.com/imagemapster/examples/images/beatles_basic.jpg" 
style="width:400px;height:240px;" usemap="#beatles-map">
  <map name="beatles-map">
    <area shape="rect" data-name="paul,all" coords="36,46,121,131" href="#" />
    <area shape="rect" data-name="ringo,all" coords="113,76,198,161" href="#" />
    <area shape="rect" data-name="john,all" coords="192,50,277,135" href="#" />
    <area shape="rect" data-name="george,all" coords="262,60,347,145" href="#" />
  </map>

<div id="beatles-caption" style="clear:both;border: 1px solid black; width: 400px; padding: 6px; display:none;">
 <div id="beatles-caption-header" style="font-style: italic; font-weight: bold; margin-bottom: 12px;"></div>
 <div id="beatles-caption-text"></div>
</div>​ 
```

但是，为什么这个 index1.html （测试）不起作用？

[http://nina-naustdal.com/index1.html](http://nina-naustdal.com/index1.html)

感谢你的协助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:40:34.983

查看您的页面，我看不到 jsFiddle 附带的 JavaScript。

我看到一个名为“imagemapster”的插件，但它似乎与您的小提琴示例中的代码无关。

进一步调查确认您没有在小提琴中包含来自 JS 窗口的相关 JavaScript。

您需要添加此脚本：

```
// javascript
// Set up some options objects: 'single_opts' for when a single area is selected, which will show just a border
// 'all_opts' for when all are highlighted, to use a different effect - shaded white with a white border
// 'initial_opts' for general options that apply to the whole mapster. 'initial_opts' also includes callbacks
// onMouseover and onMouseout, which are fired when an area is entered or left. We will use these to show or
// remove the captions, and also set a flag to let the other code know if we're currently in an area.
var inArea, map = $('#beatles'),
    captions = {
        paul: ["Paul McCartney - Bass Guitar and Vocals",
                                                                                            "Paul McCartney's song, Yesterday, recently voted the most popular song "
                                                                                              + "of the century by a BBC poll, was initially composed without lyrics. "
                                                                                              + "Paul used the working title 'scrambled eggs' before coming up with the final words."],
        ringo: ["Ringo Starr - Drums",
                                                                                          "Dear Prudence was written by John and Paul about Mia Farrow's sister, Prudence, "
                                                                                            + "when she wouldn't come out and play with Mia and the Beatles at a religious retreat "
                                                                                            + "in India."],
        john: ["John Lennon - Guitar and Vocals",
                                                                                          "In 1962, The Beatles won the Mersyside Newspaper's biggest band in Liverpool "
                                                                                            + "contest principally because they called in posing as different people and voted "
                                                                                            + "for themselves numerous times."],
        george: ["George Harrison - Lead Guitar and Vocals",
                                                                                         "The Beatles' last public concert was held in San Francisco's Candlestick "
                                                                                            + "Park on August 29, 1966."]
    },
    single_opts = {
        fillColor: '000000',
        fillOpacity: 0,
        stroke: true,
        strokeColor: 'ff0000',
        strokeWidth: 2
    },
    all_opts = {
        fillColor: 'ffffff',
        fillOpacity: 0.6,
        stroke: true,
        strokeWidth: 2,
        strokeColor: 'ffffff'
    },
    initial_opts = {
        mapKey: 'data-name',
        isSelectable: false,
        onMouseover: function(data) {
            inArea = true;
            $('#beatles-caption-header').text(captions[data.key][0]);
            $('#beatles-caption-text').text(captions[data.key][1]);
            $('#beatles-caption').show();
        },
        onMouseout: function(data) {
            inArea = false;
            $('#beatles-caption').hide();
        }
    };
opts = $.extend({}, all_opts, initial_opts, single_opts);

// Bind to the image 'mouseover' and 'mouseout' events to activate or deactivate ALL the areas, like the
// original demo. Check whether an area has been activated with "inArea" - IE<9 fires "onmouseover"
// again for the image when entering an area, so all areas would stay highlighted when entering
// a specific area in those browsers otherwise. It makes no difference for other browsers.
map.mapster('unbind').mapster(opts).bind('mouseover', function() {
    if (!inArea) {
        map.mapster('set_options', all_opts).mapster('set', true, 'all').mapster('set_options', single_opts);
    }
}).bind('mouseout', function() {
    if (!inArea) {
        map.mapster('set', false, 'all');
    }
}); 
```

# c# - 如何跟踪最后一个对 DDD 中的对象进行更改的用户？

> ID：13040380
> 
> 赞同：5
> 
> 时间：2012-10-23T22:34:30.550
> 
> 标签：c#, design-patterns, domain-driven-design, n-tier-architecture

我正在尝试实施 DDD，感觉我已经掌握了窍门，但我也遇到了一些问题。

在我 90% 的域对象中，我想知道最后一个对其进行更改的用户。我不需要完整的审计跟踪——这对我的需求来说太过分了。

我所有的类都实现了一个抽象基类，其中包含：

```
 public abstract class Base
    {
       public User LastChangedBy { get; set; }
       public DateTime LastChangedDate { get; set; }
    } 
```

**选项 1：遵循 DDD 原则，但不那么优雅**

*永远不要让对象进入无效状态*

```
public abstract class Base
{
   public User LastChangedBy { get; protected set; }
   public DateTime LastChangedDate { get; protected set; }
}

public SomeObject
{
   .....
   SomeBehaviorThatChangesObject(User changedBy, ...)
   AnotherBehaviorThatChangesObject(User changedBy, ...)
} 
```

我必须将我所有的设置器设为私有，将基类设置器设为受保护的。对对象所做的每一次更改都需要通过一个将 (User changedBy) 作为参数的方法来完成。

非常安全，但是由于用户可能会对对象进行 6 次更改，因此我必须为每个更改提供 User 对象。好吧，实际上，我必须为我的领域模型中的几乎所有方法提供这个......

**选项2：不是最好的，但我读过它**

引入一个 bool IsValid 字段。在所有设置器中，我将 IsValid 设置为 false。创建了一个将此字段设置为 true 的方法 AcceptChanges(User changesAcceptedBy)。请记住在持久化对象之前始终检查对象是否有效。

```
public abstract class Base
    {
       public bool IsValid {get; protected set;}
       public User LastChangedBy { get; protected set; }
       public DateTime LastChangedDate { get; protected set; }
    }

public SomeObject
{
   public Object Propery{get; set{IsValid = false; ...}}
   .....
   SomeBehaviorThatChangesObject(...)
   {
     //change the object
     IsValid = false;
   }
} 
```

**选项3：我认为最实用但不是很DDD**

在 UnitOfWork 的持久层或 repository.SaveChanges(User changedBy) 等存储库中执行此操作。我，或者任何实现这部分的人，可能会忘记这一点，这会使对象处于无效状态......

```
public SomeRepository
    {
       public void Update (User changedBy)
       {...}
    } 
```

*能够看到谁最后更改了实体是很正常的，但我还没有看到任何实现 DDD 的好例子。你怎么做到这一点？*

**更新** 作为对 jgauffins 解决方案的回应：谢谢，Base 实际上实现了一个接口，并且我非常简化，以免信息过载。我觉得这并不优雅，因为每种方法都需要我的用户对象作为每次更改的参数，而且我突然不得不将所有 setter 设为私有...

把它放在回购中可以完成这项工作，但上面的论点是有效的，我没有想到这一点，所以这正是我问的原因。我实际上正在计划一项可能需要更改某些对象的服务。

这是一个很大的变化，改变了数百种方法和属性，所以我想保持舒尔。而且我最终会用很多方法来设置一个字段，就像我在[这篇文章](https://stackoverflow.com/questions/12978381/is-lots-of-add-change-methods-and-constructor-overloads-a-consequence-of-ddd)中提到的那样，我不需要一个方法，因为“set”描述得足以让用户知道更改做了什么......我的直觉但是说你是对的，只是想看看是否有其他方法可以做同样的事情。

**最终更新：**

阅读所有评论、问题和建议的解决方案后，我意识到我可能不得不重新考虑如何看待 LastChangedBy 和 LastChangedDate 字段。对于某些对象，这实际上与我认为属于该领域的事物有关。对于许多其他人来说，我正在寻找真正的审计。我没有意识到区别。

即 Document 对象可以由创建者以外的其他人更改，并且会与某些行为（通知创建者等）相关联。在这些情况下，实际上并不是最后一个更改我感兴趣的文档对象的人，而是最后一个编辑文档内容的人。

我没有将它与 LastChangedBy 混合，而是为 LastEditedBy 创建字段。如果我需要跟踪每个更改，这甚至可以是编辑列表。

当然，大部分时间这将是 LastChangedBy 的同一用户，但请查看创建者进入并更改属性以锁定文档以进行进一步编辑的场景。然后文档并没有真正编辑，而是更改了，出于审计原因我想跟踪一些内容。如果我使用相同的字段来跟踪编辑，那就错了。我可以这样做，因为现在的要求是创建者可以进去查看上次更改文档的人，但这并不是真正正确的解决方案。

为了实施审计，我做了以下工作：

首先，我将我的基类划分为需要实现的接口。lastChangedBy 和 LastChangedDate 定义在 IAuditable 接口中，需要审计的对象必须实现。

然后像这样覆盖 DbContext.SaveChanges() ：

```
 public override int SaveChanges()
    {
        if(ChangeTracker.Entries<IAuditable>().Any())
            throw new InvalidOperationException
                (
                "Tried to save changes on an object that is needs to be Audited. Please provide the User that makes the changes!"
                );
        return base.SaveChanges();
    }

    public int SaveChanges(User changedBy)
    {
        var entries = ChangeTracker.Entries<IAuditable>().Where(entry=>entry.State == EntityState.Modified);
        foreach (var dbEntityEntry in entries)
        {
            dbEntityEntry.Entity.Audit(DateTime.Now, changedBy);
        }
        return base.SaveChanges();
    } 
```

当然还有其他方法可以做到这一点，但这似乎至少是一个开始。

现在，我意识到我的问题本来可以更好，但老实说，我没有意识到问题的一部分是我想跟踪不同对象的不同原因的变化。上面文档的示例只是 LastChangedBy 不是我*真正*需要在我的域中设置或跟踪的对象之一，但可以将其重写为像上面那样更具体。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T07:01:31.830

我从`Thread.CurrentPrincipal`. 但是，如果您稍后要切换到异步处理（例如使用我[在此处](http://blog.gauffin.org/2012/10/writing-decoupled-and-scalable-applications-2/)描述的命令），则无法使用`Thread.CurrentPrincipal`.

但首先有一个基本问题：

```
public abstract class Base
{
   public User LastChangedBy { get; protected set; }
   public DateTime LastChangedDate { get; protected set; }
} 
```

那不是基类。它不添加任何功能。您应该改为将其更改为一个名为类似`ITrackChanges`或类似的界面。

```
public SomeObject
{
   .....
   SomeBehaviorThatChangesObject(User changedBy, ...)
   AnotherBehaviorThatChangesObject(User changedBy, ...)
} 
```

这就是我做事的方式。为什么你认为它不优雅？管理员或后台服务可以使用该方法代表用户执行操作。

**更新**

> 我觉得这并不优雅，因为每个方法都需要我的用户对象作为每次更改的参数

好。这是业务需求，对吧？您必须更改`LastChangedBy`属性。因此必须提供。

DDD 中不禁止公共设置器。您可以使用它们，但在这种情况下，每次更改都必须更新`LastChangedBy`和。`LastChangedDate`并且该逻辑应该由模型本身而不是调用代码来执行。因此，不可能使用公共设置器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T22:39:11.563

...或者您可以将用户设置为[`Thread.CurrentPrincipal`](http://msdn.microsoft.com/en-us/library/system.threading.thread.currentprincipal.aspx)而不是使其成为任何界面的一部分。

这适用于任何值得称道的身份模型，无论是在网站上还是在具有自定义或 AD 身份验证的桌面应用程序上。

为了扩展，如果未设置用户，您的存储库等可能会抛出，并且您仍然可以实现基于角色或声明的权限，以根据您的意愿防止/允许基于用户身份的特定类型的更新。

# java - 使用数据报 UDP 发送和接收确认

> ID：13040381
> 
> 赞同：1
> 
> 时间：2012-10-23T22:34:38.873
> 
> 标签：java, multithreading, sockets, networking, udp

我是套接字编程和编写 Java UDP 简单客户端-服务器应用程序的新手。我正在编写一个时间/日期服务器客户端。客户端可以向服务器询问时间和日期并等待响应。此外，服务器每分钟都会用当前时间更新所有客户端。客户需要

1.  能够发起与服务器的联系并等待消息返回

2.  监听来自服务器的定期更新

如何使用单个 DatagramSocket 做到这一点？

我正在考虑创建两个线程：一个听，一个写。问题是在客户端发起与服务器的联系的情况下，它需要等待接收来自服务器的确认。因此，写入线程有时也需要监听来自服务器的数据包。但在这种情况下，我有两个线程在监听，错误的线程会得到确认。

有没有办法指定哪个线程获取输入？或者有没有其他方法可以解决这个问题？

我一直在寻找这个答案，但找不到。我发现的最接近的是[Java 套接字：您可以从一个线程发送并在另一个线程上接收吗？](https://stackoverflow.com/questions/8449064/java-sockets-can-you-send-from-one-thread-and-receive-on-another)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:40:56.470

如果只有一个写入器线程，那么它可以发送请求并进入等待循环。然后侦听器线程将获取响应，将其添加到共享变量（可能是`AtomicReference`），然后通知编写器已收到响应。

```
 // both write and listener threads will need to share this
  private final AtomicReference<Response> responseRef =
     new AtomicReference<Response>();
  ...
  // writer-thread
  writeRequest(request);
  synchronize (responseRef) {
     while (responseRef.get() == null) {
        // maybe put a timeout here
        responseRef.wait();
     }
  }
  processResponse(response);
  ...

  // listener-thread
  Response response = readResponse();
  synchronize (responseRef) {
     responseRef.set(response);
     responseRef.notify();
  } 
```

如果您有多个作者或同时发送多个请求，那么它会变得更加复杂。您需要为每个请求发送某种唯一 id 并在响应中返回它。然后响应线程可以将请求与响应匹配。您需要一个`ConcurrentHashMap`或其他共享集合，以便响应者可以匹配特定请求、添加响应并通知适当的等待线程。

# ruby-on-rails - Rails + 亚马逊 API + 集成

> ID：13040383
> 
> 赞同：1
> 
> 时间：2012-10-23T22:34:59.340
> 
> 标签：ruby-on-rails, ruby, api

我是一个 Rails 新手 - 有点过头了，可以使用一些帮助。

我有一个现有的 Rails 应用程序，我正在尝试将 Amazon Products API 与 gem“ruby-aaws”集成......即将项目放在模型中，在视图中显示它们等。

我以前从未使用过外部 API，所以我不确定从哪里开始集成。任何帮助都非常感谢！

以下是我用来通过 API 提取数据的一些代码：

```
require 'amazon/aws'
require 'amazon/aws/search'

include Amazon::AWS
include Amazon::AWS::Search

is = ItemSearch.new( 'Watches', { 'Keywords' => 'Gucci' } )
rg = ResponseGroup.new( 'Large' )

req = Request.new
req.locale = 'us'

resp = req.search( is, rg )

items = resp.item_search_response[0].items[0].item

# Available properties for first item:
#
puts items[0].properties

items.each do |item|
  attribs = item.item_attributes[0]
  puts attribs.label
  if attribs.list_price
    puts attribs.title, attribs.list_price[0].formatted_price, item.medium_image, ''
  end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T00:55:26.730

我也是一个新手，正在尝试做类似的事情。我在 GitHub 上发现了这个看起来很有前途的例子。

[https://github.com/hundredwatt/Amazon-Product-Search-Example](https://github.com/hundredwatt/Amazon-Product-Search-Example)

但是这里也有一些很好的相关问题可以为您解答：

[Ruby 亚马逊图书搜索](https://stackoverflow.com/questions/393234/ruby-amazon-book-search)

祝你好运！

# html - 在 HTML 中，url 包含#，滚动页面到标题？

> ID：13040388
> 
> 赞同：6
> 
> 时间：2012-10-23T22:35:41.907
> 
> 标签：html, url, hyperlink, header

如果我的网址是这样的：[http](http://www.thisisawebsite.com/page.php#about)
://www.thisisawebsite.com/page.php#about 我是 如何做到的，所以当点击链接时，它会转到标题“关于”，或者其他任何地方欲望？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-23T22:46:01.180

只需在目标页面上使用 id “about”标记标题，即

```
<h1 id="about>About</h1> 
```

这样，您在链接页面[http://www.thisisawebsite.com/page.php#about](http://www.thisisawebsite.com/page.php#about)上的链接将直接转到“about”标题 - 在本例中为 h1，但它可能是您给出的任何 id “关于”。请记住，您应该只在页面上使用一次 id “about”。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-23T22:36:49.777

您需要在标记中定义锚点（靠近“关于”标题）：

```
<a name="about"></a> 
```

任何对此有疑问的人都应该探索`ID`在他们想要链接到的实际元素上使用属性：

```
<h1 id="about">About</h1> 
```

# c# - 需要帮助将函数从 c# 转换为 vb.net

> ID：13040402
> 
> 赞同：3
> 
> 时间：2012-10-23T22:36:48.843
> 
> 标签：c#, vb.net

我需要一些帮助将此代码从 c# 转换为 vb.net：

```
 private static Action<int, int> TranslateOrigin(Action<int, int> f, int x, int y)
    {
        return (a, b) => f(a + x, b + y);
    } 
```

我在互联网上找到的自动翻译器把它弄得一团糟，产生：

```
Private Shared Function TranslateOrigin(f As Action(Of Integer, Integer), x As Integer, y As Integer) As Action(Of Integer, Integer)
    Return Function(a, b) f(a + x, b + y)
End Function 
```

哪个不会编译，抱怨“表达式不产生值”。我一直在戳它一段时间，但没有任何运气翻译它，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T22:56:21.917

我认为这更接近一点，因为它不返回一个值，而是一个动作。使用单行。

```
Public Shared Function TranslateOrigin(f As Action(Of Integer, Integer), x As Integer, y As Integer) As Action(Of Integer, Integer)
    Return Sub(a, b) f(a + x, b + y)
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:51:34.323

这应该这样做：

```
Private Shared Function TranslateOrigin(ByVal f As Action(Of Integer, Integer), ByVal x As Integer, ByVal y As Integer) As Action(Of Integer, Integer)
     Return Function (ByVal a As Integer, ByVal b As Integer) 
               f.Invoke((a + x), (b + y))
            End Function
End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:59:53.100

您知道[`Action(Of T1, T2)`委托](http://msdn.microsoft.com/en-us/library/bb549311.aspx)不返回值吗？如果它无论如何都是你想要的（虽然我没有看到太多的意义，有值类型），你可以使用 Sub.

> 封装具有两个参数且不返回值的方法。

有了一个子，这将给出以下代码：

```
Private Shared Function TranslateOrigin(f As Action(Of Integer, Integer), x As Integer, y As Integer) As Action(Of Integer, Integer)
    Return Sub(a, b) f(a + x, b + y)
End Function 
```

您可能想要返回一个值，因此您需要一个[`Func(Of T1, T2, TResult)`delegate](http://msdn.microsoft.com/en-us/library/bb534647.aspx)。在您的情况下，这将使：

```
Private Shared Function TranslateOrigin(f As Func(Of Integer, Integer, Integer), x As Integer, y As Integer) As Func(Of Integer, Integer, Integer)
    Return Function(a, b) f(a + x, b + y)
End Function 
```

如下调用它，将返回值`6`（正如我所料）：

```
TranslateOrigin(Function(x, y) x + y, 1, 2)(1, 2) 
```

# php - 我应该将 bindParam 用于没有用户输入的查询吗？

> ID：13040404
> 
> 赞同：0
> 
> 时间：2012-10-23T22:36:56.037
> 
> 标签：php, mysql, pdo

我相当新，并且被告知准备查询的关键原因是安全性。

我的程序中有一个不接收用户输入的查询 - 它全部使用内部变量。`bindParam`在 PDO 查询中使用而不是简单地按原样提交查询字符​​串是否仍有实质性好处？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:57:02.723

如果将来的更新更改了变量，使其从用户输入中分配，但没有人费心更改查询怎么办？

应该避免将*变量*连接到 SQL 中，并*始终*将它们作为参数发送到 RDBMS。

# code-coverage - 向 OpenCover 添加多个排除过滤器

> ID：13040405
> 
> 赞同：2
> 
> 时间：2012-10-23T22:36:59.857
> 
> 标签：code-coverage, instrumentation, opencover

我知道如何添加 1 个排除过滤器，但是，如果我想同时排除多个项目怎么办？我是否重复“-”语句？还是逗号分隔？特别是，我试图从覆盖率计算中排除测试和安装程序：

```
<property name="coverage.report.filter" value="+[${product}*]* -[${product}*Installer.Designer*]* -[${product}*Tests]* " /> 
```

抱歉，OpenCover 的新手 :)

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T11:04:00.167

如果您`OpenCover.Console.exe`在命令行上键入，我想您会看到它接受空格分隔的过滤器。这在应与 OpenCover 一起安装的所提供文档中也有详细说明 - 假设您使用的是从 GitHub 下载的内容。

该信息也可在[WIKI上获得](https://github.com/sawilde/opencover/wiki/Usage)

# c++ - 在类中创建回调映射时出错

> ID：13040406
> 
> 赞同：1
> 
> 时间：2012-10-23T22:37:11.997
> 
> 标签：c++, boost

编码：

```
class Base{
  enum eventTypes{ EVENT_SHOW };
  std::map<int, boost::function<bool(int,int)> > m_validate;
  virtual void buildCallbacks();
  bool shouldShowEvent(int x, int y);
};
void Base::buildCallbacks(){
   m_validate[ EVENT_SHOW ] = boost::bind(&Base::shouldShowEvent,this);
} 
```

我收到以下错误：

```
 In base.cxx
  return (p->*f_);
  Error: a pointer to a bound function may only be used to call
      the function (boundfuncalled) 
```

我得到了错误的意思，除了调用有界成员函数之外，我不能做任何其他事情，但是我该如何规避这个问题呢？我不确定为什么这不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T22:40:36.463

```
m_validate[ EVENT_SHOW ] = boost::bind(&Base::shouldShowEvent,this); 
```

调用`bind()`产生一个不带参数的函数对象。您不能使用这样的对象来调用`Base::shouldShowEvent`，因为它需要两个参数。所以你必须把函数对象变成一个接受两个参数的对象：

```
m_validate[ EVENT_SHOW ] = boost::bind(&Base::shouldShowEvent,this, _1, _2); 
```

（未测试...）

# python - Python - Matplotlib FuncAnimation - Mac - 不返回点

> ID：13040408
> 
> 赞同：0
> 
> 时间：2012-10-23T22:37:29.477
> 
> 标签：python, matplotlib

使用以下代码，我试图将点迭代地添加到图表中。因为我在 OSX 上，所以我没有使用 blit=True。我可以在原始点上得到一个点来绘制，并且可以看到我的更新函数的输出（从生成器馈送）。我还可以看到我的坐标被附加到要绘制的坐标数组中。在可视化生成/更新的点时我缺少什么？

由 data_gen() 调用的 stromboli 函数返回一对坐标。对于所有意图和目的，它可能是一个随机的 x,y。

```
#Visualization Imports
import matplotlib.pyplot as plt
import matplotlib.animation as animation

def update(coord):
    print coord[0], coord[1]
    pt.set_xdata(numpy.append(pt.get_xdata(),coord[0]))
    pt.set_ydata(numpy.append(pt.get_ydata(),coord[1]))
    print pt.get_xdata()
    return pt,

def data_gen():
   while True:
        yield stromboli(args.velocity)

#Visualization
fig = plt.figure()
ax = plt.axes()
pt, = ax.plot([], [],'ro')

ani = animation.FuncAnimation(fig, update, data_gen, interval=100)

plt.plot(0,0,'b*')
plt.show() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T02:11:25.110

我怀疑你可能会通过有效的闭包得到一些有趣的东西（你是在交互式环境中运行它吗？），因为`pt`它将从之前的代码执行中定义，这就是`def update`运行时被抓取的东西。然后，您制作了一个新版本，`pt`但这不是更新的内容`update`

要么移动到定义`pt, = ax.plot([],[],'ro')` *之上*`update`，要么尝试`pt`作为参数传入。

前任：

```
def update(coord,pt):
    print coord[0], coord[1]
    pt.set_xdata(numpy.append(pt.get_xdata(),coord[0]))
    pt.set_ydata(numpy.append(pt.get_ydata(),coord[1]))
    print pt.get_xdata()
    return pt,

....

ani = animation.FuncAnimation(fig, update, data_gen, fargs = (pt,),interval=100) 
```

# javascript - 内联事件处理程序中的变量“未定义”？

> ID：13040413
> 
> 赞同：0
> 
> 时间：2012-10-23T22:38:14.487
> 
> 标签：javascript, javascript-events, google-chrome-extension

我正在开发一个 chrome 扩展程序，它将 HTML 注入到页面中，并对某些按钮具有 onClick 功能。这是示例代码。

命名空间.js

```
/**
 * Namespace for this content script.
 * @const
 */
var namespace = {};

/**
 * HTML text to be injected.
 */
namespace.HTML = '<input type="text" size="2" placeholder="0.50"' +
                 'onkeyup="namespace.enable(event)" />';

document.body.insertAdjacentHTML('afterbegin', namespace.HTML);

namespace.enable = function() {
  alert('Hello World!')
}; 
```

HTML 被正确注入，但命名空间未被识别。这是错误

```
Uncaught ReferenceError: namespace is not defined 
onkeyup 
```

任何解决方法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T06:17:28.630

正如@zhzhour 所提到的，内容脚本在一个孤立的世界中运行，页面中的 JavaScript 无法访问您的内容脚本定义的变量。

如果要执行此操作，则需要在页面中注入 JavaScript 文件，正如我在此处的其他答案中所述：[https ://stackoverflow.com/a/13037307/315562](https://stackoverflow.com/a/13037307/315562)

也就是说，使用下面的`content.js`文件来注入`namespace.js`.

### 内容.js

```
injectScript( chrome.extension.getURL( "/" ), "namespace.js" );
function injectScript ( aBasePath, aScriptURL ) {
  var scriptEl = document.createElement( "script" );
  scriptEl.src = aBasePath + aScriptURL;
  scriptEl.async = false;

  (document.body || document.head || document.documentElement)
  .appendChild( scriptEl );
} 
```

您可以以此为起点。如果您需要与 Chrome 扩展程序通信，那么您需要`window.postMessage`在注入的 JavaScript 文件中使用来发送消息并在内容脚本中接收它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T04:18:00.523

内容脚本在所谓的[孤立世界](http://developer.chrome.com/extensions/content_scripts.html#execution-environment)中运行。它不能

> 使用由其扩展页面定义的变量或函数
> 
> 使用由网页或其他内容脚本定义的变量或函数

因此，您可能还需要将命名空间作为另一段 js 注入 HTML 页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:10:33.720

它在 Firefox、Chrome 和 IE 9 中运行时调用如下：

```
window.onload = function() {
  document.body.insertAdjacentHTML('afterbegin', namespace.HTML);
}; 
```

# sql-server - SQL 查询模板的分页

> ID：13040414
> 
> 赞同：0
> 
> 时间：2012-10-23T22:38:19.183
> 
> 标签：sql-server

对于我的应用程序，我创建了一个**SQL 查询构建器**，其中包含**Where**和**Order By**子句。我想知道如何对结果进行分页，即我想获得一个关于如何对 SQL 查询的结果进行分页的模板。这个描述可能有点混乱，所以举个例子可能会更容易：

考虑**测试表**

```
CREATE TABLE [dbo].[TestTable](
    [RecordID] [int] NOT NULL,
    [ID] [nvarchar](1000) NULL,
    [Name] [nvarchar](1000) NULL,
    [Dept] [nvarchar](1000) NULL
)
INSERT [dbo].[TestTable] 
    SELECT 1, N'1', N'Andy', N'IT'
UNION ALL
    SELECT 2, N'2', N'Bob', N'IT'
UNION ALL
    SELECT 3, N'3', N'Camila', N'Sales'
UNION ALL
    SELECT 4, N'4', N'Drew', N'IT'
UNION ALL
    SELECT 5, N'5', N'Elsie', N'Sales'
UNION ALL
    SELECT 6, N'6', N'Frank', N'IT'
UNION ALL
    SELECT 7, N'7', N'Gaby', N'Sales'
UNION ALL
    SELECT 8, N'8', N'Hank', N'IT'
UNION ALL
    SELECT 9, N'9', N'Iris', N'Sales'
UNION ALL
    SELECT 10, N'8', N'John', N'IT' 
```

假设我有一个**Where**子句：

```
WHERE  ([Dept] = 'IT') 
```

以及按条款**订购：**

```
ORDER BY [Name] DESC 
```

我试图通过使用类似的东西来进行分页：

```
SELECT [RECORDID], [ID], [Name], [Dept], RowNum  
    FROM (
            SELECT [RECORDID], [ID], [Name], [Dept], 
                    ROW_NUMBER() OVER (ORDER BY [RecordID]) AS RowNum 
            FROM [TestTable] WHERE  ([Dept] = 'IT') 
        ) AS [TestTable_DerivedTable] 
WHERE [TestTable_DerivedTable].RowNum BETWEEN 3 AND 6 ORDER BY [Name] DESC 
```

这不起作用，因为我无法`ORDER BY [Name] DESC`进入`[TestTable_DerivedTable]`. 如果我只有**WHERE**子句，它将返回名称：

> 安迪、鲍勃、德鲁、弗兰克、汉克和约翰。

如果我输入分页，即**BETWEEN 3 AND 6**，我正确地得到：

> 德鲁、弗兰克、汉克和约翰

如何添加`ORDER BY [Name] DESC`以便获得*（首先是反转，然后是分页）*：

> 弗兰克、德鲁、鲍勃和安迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T00:28:12.670

如果将 移到`ORDER BY [Name] DESC`Window 函数中，您将得到您想要的：

```
SELECT [RECORDID], [ID], [Name], [Dept], RowNum  
FROM
(
   SELECT [RECORDID], [ID], [Name], [Dept]
      , ROW_NUMBER() OVER (ORDER BY [Name] DESC) AS RowNum 
   FROM [TestTable] WHERE  ([Dept] = 'IT') 
) AS [TestTable_DerivedTable] 
WHERE [TestTable_DerivedTable].RowNum BETWEEN 3 AND 6 
```

# css - 我可以从居中的包装器中将元素拉伸到浏览器窗口的右侧吗？

> ID：13040421
> 
> 赞同：3
> 
> 时间：2012-10-23T22:39:04.627
> 
> 标签：css

我在弄清楚如何做到这一点时遇到了一些麻烦。我想要一个包装器，使我的网站居中，但其中一个标题元素需要一直延伸到页面的右边缘，但不扩大页面的宽度并添加滚动条。

见这里： http: [//i49.tinypic.com/6rkaxc.jpg](http://i49.tinypic.com/6rkaxc.jpg)（新海报所以不能添加图片）

蓝色轮廓代表居中的包装器，橙色框是我试图使其适合页面右侧的标题 div。我已经让它使用 100% 宽度工作，但它创建了一个水平页面滚动，因为它使它的宽度与它的父级相同。我希望它为具有更高分辨率的用户扩展，因此它始终适合右侧。我希望这是有道理的。

我的代码看起来像......

```
<body>
<div id="wrapper">
   <div id="header">
   </div>

   <div id="left">
   </div>

   <div id="right">
   </div>
</div>
</body> 
```

CSS：

```
div#wrapper {
 margin: 0 auto;
 width: 1020px;
 position: relative;
}

div#header {
 height: 150px;
 position: absolute;
 left: 510px;
 width: 100%;
}

div#left {
 width: 510px;
 float: left;
}

div#right {
 width: 100%;
 float: left;
} 
```

我对这些东西很陌生，所以如果您发现这里有任何错误或不良做法，请指出！谢谢您的帮助！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:02:23.130

由于您希望内容的宽度固定，因此策略是为左右内容提供容器。这允许您使用`width: 100%`将延伸到末尾而没有滚动条的标题。然后，您使标题相对于正确的容器。[这](http://jsfiddle.net/uLLJt/3/)是一个你可以玩的jsfiddle。

注意我把宽度变小了，所以它适合我的 jsfiddle 窗口。

HTML：

```
<body>
    <div id="wrapper">
       <div id="leftContainer">
           <div id="left">
               This is left
           </div>
       </div>
       <div id="rightContainer">              
           <div id="header">
              This is a header
           </div>   
           <div id="right">
              This is right
           </div>        
       </div>
   </div>
</body>          ​ 
```

CSS：

```
div#wrapper {
 text-align: center;
 width: 100%;
 position: relative;
 white-space: nowrap;    
 overflow-x: scroll;  
}

div#header {
 z-index: 1000;
 height: 150px;
 position: absolute;
 left: 0;
 width: 100%;
 background: green;    
}

div#leftContainer {
 float: left;
 width: 50%;
 height: 500px;
 display: inline-block; 
}

div#left {
 float: right;
 width: 260px;
 height: 300px;
 background-color: purple;
}

div#rightContainer {
 position: relative;
 float: right;
 width: 50%;
 height: 500px;    
 display: inline-block;  
}

div#right {
 width: 260px;
 height: 300px;
 background-color: yellow;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:41:11.210

试试这个。我将包装器宽度更改为 80%。不确定这是否可以。但是我在扩展页面时效果很好。将标题移到包装器之外，并为清晰起见添加了背景颜色。

注 1：右 DIV 的 margin-top 与标题 DIV 的高度大小相同。

HTML

```
<div id="outerWrapper">
    <div id="header">
            Header
    </div>
    <div id="wrapper">

        <div id="left">
            Left
        </div>

        <div id="right">
            Right
        </div>
    </div>
</div> 
```

CSS

```
div#wrapper {
 margin: 0 auto;
 width: 80%;
 height: 100%;
 position: relative;
 background-color: #CCCCCC;
}

div#header {
 height: 150px;
 float: right;
 position: absolute; 
 left: 50%;
 width: 50%;
 background-color: yellow;
}

div#left {
 width: 50%;
 height: 100%;
 float: left;
 background-color: red;
}

div#right {
 width: 50%;
 height: 100%;
 float: left;
 margin-top: 150px;
 background-color: blue;
} 
```

希望这可以帮助。

# scala - Scala 的 N-Tree 遍历导致堆栈溢出

> ID：13040422
> 
> 赞同：10
> 
> 时间：2012-10-23T22:39:10.310
> 
> 标签：scala, recursion, tree, traversal

我正在尝试从 N-tree 数据结构返回小部件列表。在我的单元测试中，如果我有大约 2000 个小部件，每个小部件都有一个依赖项，我会遇到堆栈溢出。我认为正在发生的是 for 循环导致我的树遍历不是尾递归的。在scala中写这个更好的方法是什么？这是我的功能：

```
protected def getWidgetTree(key: String) : ListBuffer[Widget] = {
  def traverseTree(accumulator: ListBuffer[Widget], current: Widget) : ListBuffer[Widget] = {
    accumulator.append(current)

    if (!current.hasDependencies) {
      accumulator
    }  else {
      for (dependencyKey <- current.dependencies) {
        if (accumulator.findIndexOf(_.name == dependencyKey) == -1) {
          traverseTree(accumulator, getWidget(dependencyKey))
        }
      }

      accumulator
    }
  }

  traverseTree(ListBuffer[Widget](), getWidget(key))
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-23T23:51:23.410

它不是尾递归的原因是您在函数内部进行了多次递归调用。要尾递归，递归调用只能是函数体中的最后一个表达式。毕竟，重点在于它的工作方式类似于 while 循环（因此，可以转换为循环）。循环不能在一次迭代中多次调用自身。

要进行这样的树遍历，您可以使用队列将需要访问的节点结转。

假设我们有这棵树：

```
//        1
//       / \  
//      2   5
//     / \
//    3   4 
```

用这个简单的数据结构表示：

```
case class Widget(name: String, dependencies: List[String]) {
  def hasDependencies = dependencies.nonEmpty
} 
```

我们有这张地图指向每个节点：

```
val getWidget = List(
  Widget("1", List("2", "5")),
  Widget("2", List("3", "4")),
  Widget("3", List()),
  Widget("4", List()),
  Widget("5", List()))
  .map { w => w.name -> w }.toMap 
```

现在我们可以将您的方法重写为尾递归：

```
def getWidgetTree(key: String): List[Widget] = {
  @tailrec
  def traverseTree(queue: List[String], accumulator: List[Widget]): List[Widget] = {
    queue match {
      case currentKey :: queueTail =>        // the queue is not empty
        val current = getWidget(currentKey)  // get the element at the front
        val newQueueItems =                  // filter out the dependencies already known
          current.dependencies.filterNot(dependencyKey => 
            accumulator.exists(_.name == dependencyKey) && !queue.contains(dependencyKey))
        traverseTree(newQueueItems ::: queueTail, current :: accumulator) // 
      case Nil =>                            // the queue is empty
        accumulator.reverse                  // we're done
    }
  }

  traverseTree(key :: Nil, List[Widget]())
} 
```

并测试一下：

```
for (k <- 1 to 5)
  println(getWidgetTree(k.toString).map(_.name)) 
```

印刷：

```
ListBuffer(1, 2, 3, 4, 5)
ListBuffer(2, 3, 4)
ListBuffer(3)
ListBuffer(4)
ListBuffer(5) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-24T00:43:29.010

对于与@dhg 的答案相同的示例，没有可变状态的等效尾递归函数（the `ListBuffer`）将是：

```
case class Widget(name: String, dependencies: List[String])

val getWidget = List(
  Widget("1", List("2", "5")),
  Widget("2", List("3", "4")),
  Widget("3", List()),
  Widget("4", List()),
  Widget("5", List())).map { w => w.name -> w }.toMap

def getWidgetTree(key: String): List[Widget] = {
  def addIfNotAlreadyContained(widgetList: List[Widget], widgetNameToAdd: String): List[Widget] = {
    if (widgetList.find(_.name == widgetNameToAdd).isDefined) widgetList
    else                                                      widgetList :+ getWidget(widgetNameToAdd)
  }

  @tailrec
  def traverseTree(currentWidgets: List[Widget], acc: List[Widget]): List[Widget] = currentWidgets match {
    case Nil                                => {
      // If there are no more widgets in this branch return what we've traversed so far
      acc 
    }
    case Widget(name, Nil) :: rest          => {
      // If the first widget is a leaf traverse the rest and add the leaf to the list of traversed
      traverseTree(rest, addIfNotAlreadyContained(acc, name)) 
    }
    case Widget(name, dependencies) :: rest => {
      // If the first widget is a parent, traverse it's children and the rest and add it to the list of traversed
      traverseTree(dependencies.map(getWidget) ++ rest, addIfNotAlreadyContained(acc, name))
    } 
  }

  val root = getWidget(key)
  traverseTree(root.dependencies.map(getWidget) :+ root, List[Widget]())
} 
```

对于同一个测试用例

```
for (k <- 1 to 5)
  println(getWidgetTree(k.toString).map(_.name).toList.sorted) 
```

给你：

```
List(2, 3, 4, 5, 1)
List(3, 4, 2)
List(3)
List(4)
List(5) 
```

请注意，这是后序而不是前序遍历。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-24T20:56:03.677

惊人的！谢谢。我不知道@tailrec 注释。那是一个很酷的小宝石。我不得不稍微调整一下解决方案，因为带有自引用的小部件会导致无限循环。当对 traverseTree 的调用需要一个 List 时，newQueueItems 也是一个 Iterable，所以我不得不 toList 那个位。

```
def getWidgetTree(key: String): List[Widget] = {
  @tailrec
  def traverseTree(queue: List[String], accumulator: List[Widget]): List[Widget] = {
    queue match {
      case currentKey :: queueTail =>        // the queue is not empty
        val current = getWidget(currentKey)  // get the element at the front
        val newQueueItems =                  // filter out the dependencies already known
          current.dependencies.filter(dependencyKey =>
            !accumulator.exists(_.name == dependencyKey) && !queue.contains(dependencyKey)).toList
        traverseTree(newQueueItems ::: queueTail, current :: accumulator) //
      case Nil =>                            // the queue is empty
        accumulator.reverse                  // we're done
    }
  }

  traverseTree(key :: Nil, List[Widget]())
} 
```

# scite - SciTe 和 VS2012 编译器

> ID：13040425
> 
> 赞同：0
> 
> 时间：2012-10-23T22:39:39.977
> 
> 标签：scite

目前似乎 SciTe 正在尝试使用 g++ 进行编译，但我需要它来使用 vs 编译器进行编译。我怎样才能做到这一点？它给了我这个编译器错误：

'g++' 不是内部或外部命令、可运行程序或批处理文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T20:08:22.547

您需要打开**cpp.properties**文件（菜单 > 选项 > 打开 cpp.properties）然后更改`command.compile.$(file.patterns.cplusplus)`属性以匹配您的环境，默认情况下设置为 gcc/g++。

# msbuild - msdeploy 未运行 dbDacFx 提供程序

> ID：13040426
> 
> 赞同：0
> 
> 时间：2012-10-23T22:39:43.253
> 
> 标签：msbuild, msdeploy, webdeploy

我正在尝试将我的 dacpac 文件嵌入到包中，并在部署时运行 dbDacFx 提供程序。

在我的项目中使用以下带有 Azure 发布工具的 Visual Studio 2010 和带有 wpp.targets 文件的 SSDT SQl Server 2008 R2。

文件看起来像这样...

```
 <AfterAddIisAndContentDeclareParametersItems>
      $(AfterAddIisAndContentDeclareParametersItems);
      AddAdditionalAclsDeclareParameterItems;
      DeployUIConfigDatabase;
    </AfterAddIisAndContentDeclareParametersItems>
<Target Name="DeployUIConfigDatabase">
    <ItemGroup>
      <MsDeploySourceManifest Include="dbDacFx">
        <Description>Add dbDacFx $(_MSDeployDirPath_FullPath)\Database\%(CopyAdditionalFilesToDeploy.Identity) to Folder</Description>
        <Path>$(_MSDeployDirPath_FullPath)\Database\%(CopyAdditionalFilesToDeploy.Identity)</Path>
        <Dest>{UIConfigContext-Web.config Connection String</Dest>
        <IncludeTransactionalScripts>True</IncludeTransactionalScripts>
        <IncludeData>True</IncludeData>
        <AdditionalProviderSettings>IncludeData;IncludeTransactionalScripts</AdditionalProviderSettings>
      </MsDeploySourceManifest>
    </ItemGroup>
  </Target> 
```

我可以看到 .zip 包有 dacpac 文件，但是当我部署它时，提供程序永远不会被调用......非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T18:25:11.063

对于任何面临类似问题的人，看起来您还必须声明一个在部署阶段由 msdeploy 使用的参数。在我的 wpp 文件中添加以下内容会生成正确的参数文件，现在一切正常。

```
<Target Name="AddAdditionalDeployUIConfigDatabase">
    <ItemGroup Condition="'@(CopyAdditionalFilesToDeploy)' != ''">
      <MsDeployDeclareParameters Include="Add dbDacFx Provider Parameter %(CopyAdditionalFilesToDeploy.Identity)">
        <Kind>ProviderPath</Kind>
        <Scope>dbDacFx</Scope>
        <Description>Run dbDacFx provider on %(CopyAdditionalFilesToDeploy.Identity)</Description>
        <DefaultValue>{UIConfigContext-Web.config Connection String}</DefaultValue>
        <DestinationContentPath>$(_MsDeployParameterNameForContentPath)/@(CopyAdditionalFilesToDeploy)</DestinationContentPath>
        <Tags>Hidden</Tags>
        <ExcludeFromSetParameter>True</ExcludeFromSetParameter>
      </MsDeployDeclareParameters>
    </ItemGroup> 
```

# c# - 使用反射和属性名称作为字符串更新类属性

> ID：13040427
> 
> 赞同：2
> 
> 时间：2012-10-23T22:39:44.980
> 
> 标签：c#, reflection, properties

我有一个示例课程

```
public class sampleClass
{
    public string givenName { get; set; }
    public string familyName { get; set; }
} 
```

以及包含在 中的该类的一组值`IDictionary<string, object> dataModel`。我可以使用反射来遍历`dataModel`并使用`dataModel`键来获取值。

我想做类似的事情：

```
void UpdateValues(IDictionary<string, object> dataModel)
{
    Type sourceType = typeof(sampleClass);
    foreach (PropertyInfo propInfo in (sourceType.GetProperties()))
    {
        if (dataModel.ContainsKey(propInfo.Name))
        {
            //  set propInfo value here
            propInfo.Value = dataModel[propInfo.Name];
        }
    }
} 
```

但我不知道该怎么做

```
propInfo.Value = dataModel[propInfo.Name]; 
```

帮助！谢谢 ！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T22:45:45.490

你需要一个 sampleClass 的实例来设置属性，然后你可以使用 SetValue 函数来做到这一点：

```
propInfo.SetValue(yourinstance, dataModel[propInfo.Name], null); 
```

看到这个网址：http: [//msdn.microsoft.com/en-us/library/axt1ctd9.aspx](http://msdn.microsoft.com/en-us/library/axt1ctd9.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:54:05.803

```
propInfo.SetValue(sampleClass, dataModel[propInfo.Name], null) 
```

# c# - OperationCanceledException 和 TaskCanceledException 的区别？

> ID：13040428
> 
> 赞同：106
> 
> 时间：2012-10-23T22:39:54.257
> 
> 标签：c#, exception, asynchronous, task

`OperationCanceledException`和 和有什么不一样`TaskCanceledException`？如果我使用 .NET 4.5 并使用`async`/`await`关键字，我应该寻找哪一个？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2012-10-23T22:46:49.827

[`OperationCanceledException`](http://msdn.microsoft.com/en-us/library/system.operationcanceledexception.aspx)只是基类[`TaskCanceledException`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskcanceledexception.aspx)- 所以如果你抓住前者，你仍然会抓住后者。

并发集合上的某些操作会抛出 just `OperationCanceledException`，因为不涉及任何实际*任务*（至少就公共 API 而言）。参见[`BlockingCollection.TryTake`](http://msdn.microsoft.com/en-us/library/dd381899.aspx)示例。

我会抓住`OperationCanceledException`以防万一任务由于本身刚刚抛出的操作而被取消`OperationCanceledException`- 你可能仍然希望将其视为“只是取消”。

# java - 获取重复事件：CQRS 还是复杂查询？

> ID：13040429
> 
> 赞同：1
> 
> 时间：2012-10-23T22:40:08.273
> 
> 标签：java, hibernate, jpa, recurrence, timetable

**模型**

在我的应用程序的当前模型中，**事件**可以以**几个**不可组合的频率发生，其值枚举如下：ONCE、DAILY、WEEKLY、MONTHLY、YEARLY，并且（即事件发生）从某个日期开始，并且**可选地**在稍后结束（当它们没有结束时，它们的值为 NULL）。

例如，一个事件：

*   每年和每周发生
*   **在这两种情况下都是在****n**周前开始的
***   并且其结束日期为空**

 **有：

*   现在每周发生一次
*   在 (52 - n%52) 周内每年发生一次

**用法**

这些数据可以通过后台非常频繁地更新。在我们的公共页面上需要它来显示所有事件发生的 3 天时间表，按 1 小时时段收集。

时间表的默认开始时间是今天的午夜。时间表开始时间可以下降到当前日期之前的 1 个月和之后的 2 个月。

**我需要的**

所有事件数据都通过后台插入，没有任何问题。当我需要以时间表的方式组织它们时，棘手的部分就来了。我尝试了一种粗暴的方法（选择所有事件，并自己复制事件），但我有点失败（这引发了每当数据发生变化时更新复制事件的大缓存的问题！）。

我真正想要的这个漂亮的模型（愚蠢的我：我没有同时考虑写入和读取查询）是在开始日期和结束日期之间发生所有事件，按 1 小时时段组织。

你有什么建议？

1.  非规范化我的模型并找到一个自动将我的“主”模型同步到重新组织的模型的工具？那么，我如何首先对其进行非规范化呢？我如何同步它？
2.  找到一个 JPQL（或 HQL，或原始 SQL）查询，该查询可以在提供的时间间隔内获取所有复制的事件发生（+ 可能进行一些后处理以按 1 小时时隙对它们进行索引）？如果你能提供给我，我会非常高兴:-)
3.  别的东西？

顺便说一句，模型是开放的，因此可以更改它以更好地解决问题。一切都可以在这里讨论。

此致，

罗尔夫

PS：当前（有趣的部分）模型看起来像：

```
mysql> describe occurrences;
+----------------+-------------+------+-----+---------+----------------+
| Field          | Type        | Null | Key | Default | Extra          |
+----------------+-------------+------+-----+---------+----------------+
| id             | bigint(20)  | NO   | PRI | NULL    | auto_increment |
| start_date     | datetime    | NO   |     | NULL    |                |
| end_date       | datetime    | YES  |     | NULL    |                |
| frequency_type | varchar(50) | NO   | MUL | NULL    |                |
| event_id       | bigint(20)  | NO   | MUL | NULL    |                |
+----------------+-------------+------+-----+---------+----------------+

mysql> describe frequency_types;
+-------+-------------+------+-----+---------+-------+
| Field | Type        | Null | Key | Default | Extra |
+-------+-------------+------+-----+---------+-------+
| value | varchar(50) | NO   | PRI | NULL    |       |
+-------+-------------+------+-----+---------+-------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T11:15:26.727

您可以查询开始在请求的结束之前且结束为空或在请求的开始之后发生的所有事件，然后从结果集中复制/计算所有事件。**

# linux - 管道将输入拆分为命令

> ID：13040430
> 
> 赞同：0
> 
> 时间：2012-10-23T22:40:08.887
> 
> 标签：linux, bash, unix, pipe

我试图找出管道问题。我的目标是这样的

```
replace $1 $2 index.html | split -d ':' | minify main.css 
```

main.css 的输出在哪里

```
main.css:main.min.css 
```

index.html 将从这里开始：

```
<link href="main.css" /> 
```

对此：

```
<link href="main.min.css" /> 
```

这是一个简单的例子，我知道，但我认为它说明了我的问题。

*   编辑 1

好吧，我把管道弄错了，但我仍然无法弄清楚。

这是一个更简单的例子

```
echo 'foo:bar' | split -d ':' | replace $1 $2 -- index.html 
```

这种命令可能吗？

*   编辑 2

很近！

```
minify css/main.css | replace $(cut -f1 -) $(cut -f2 -) index.html 
```

这会起作用，除了由于某种原因 cut 无法读取 STDIN :( 它们在正常运行时返回正确的值，但我需要它们作为替换命令的参数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:18:01.663

我不认为你可以用单线做到这一点，因为你试图从两个不同的来源（管道以及输入文件）读取输入。不过，这样的事情可能会奏效：

```
IFS_SAVE=$IFS
IFS=: a=( `echo "foo:bar"` )
sed -i "s/${a[0]}/${a[1]}/g" index.html
IFS=$IFS_SAVE 
```

该`IFS=:`指令将以下命令的[字段分隔符](http://tldp.org/LDP/abs/html/internalvariables.html#IFSREF)`:`从换行符更改为，以便嵌套`echo`将两个字段放入 bash 数组`( ... )`中。可以像这样访问数组元素：`${varname[index]}`

`sed -i`在文件中进行就地替换`index.html`。如果您不希望这样，请删除`-i`并将输出重定向到新文件：

```
sed "s/${a[0]}/${a[1]}/g" index.html > output.html 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T07:43:18.370

```
IFS=: read -ra a <<<'foo:bar'
ed -s index.html <<EOF
g/${a}/s,,${a[1]}
w
EOF 
```

# asp.net - 拥有一个完整 https 的网站的含义

> ID：13040442
> 
> 赞同：1
> 
> 时间：2012-10-23T22:41:21.120
> 
> 标签：asp.net, performance, security, https, asp.net-mvc-4

我目前正在为电子商务开发一个 MVC4 Web 应用程序。该网站将包含一个登录名，用户可以访问该网站，输入他们的详细信息并提交订单等。这是一个传统的电子商务网站。

为了提高站点的安全性，我希望在 https 中设置整个站点。由于用户将提供他们的登录凭据并将个人信息存储在 cookie 中，因此我希望网站得到完全保护。

不过我有一些顾虑，如果我在 https 中设置网站，会损害性能吗？它会对搜索引擎优化产生负面影响吗？在 https 中拥有整个站点是否还有其他含义？

我使用输出缓存来缓存我的视图的内容 - 使用 https 这些仍然会被缓存吗？

我一直在查看安全指南和文档，例如来自 OWASP 的文档，他们建议这样做[。](http://asafaweb.com/OWASP%20Top%2010%20for%20.NET%20developers.pdf)此外，我看到诸如 twitter 之类的网站完全是 https。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:49:07.347

一般来说，no - 全站点加密对于性能来说不是问题。

（只要确保在服务器上禁用 SSL 2.0，因为它容易受到 BEAST 攻击；您应该使用自 2000 年以来几乎所有浏览器都支持的 TLS 1.0 或 SSL3.0）。

性能问题在几年前是个问题，但现在不是了。现代服务器有能力处理每秒数百个请求和响应的加密。

您没有提到部署负载平衡器或故障转移系统，这意味着您的网站不会受到每秒数千次浏览量的影响。那是您需要开始使用 SSL 卸载程序的时候——但您现在还好。

输出缓存不受加密的影响——只需确保您没有将一个人的输出提供给另一个人（即`Session`在密钥中或使用密钥中的会话 ID缓存购物车或银行详细信息`Cache`）。

# google-app-engine - App Engine 备份永远不会完成唯一的线索是 map reduce worker_callback 失败

> ID：13040445
> 
> 赞同：4
> 
> 时间：2012-10-23T22:41:33.703
> 
> 标签：google-app-engine, mapreduce, google-cloud-datastore, database-backups

在过去的几周里，我们使用数据存储管理工具对数据存储进行完整备份一再失败。我们认为问题与我们遇到的配额错误有关，因此我们将应用程序从免费应用程序切换到付费应用程序，但我们仍然遇到问题。

每次我们尝试备份到 blobstore 时，都会发生该过程永远不会完成的情况。我们在 Pending Backups 列表中看到了备份，但它从未真正完成。我们现在总共只有 43MB 的数据，所以我们不认为这是一个数据传输问题。查看我们的默认任务队列，它显示我们有两个待处理任务，一个是对 /_ah/mapreduce/controller_callback 的调用，另一个是对 /_ah/mapreduce/worker_callback 的调用

worker_callback 累积了它的重试计数，我们唯一的错误线索是在 Previous Run 选项卡上，它显示最后一个 http 响应代码为 500。没有错误消息，我们的错误日志中没有任何内容，它只是不断尝试一遍又一遍。

我们已经能够将备份问题缩小到特定命名空间的特定实体类型，但我们无法弄清楚为什么该实体类型失败而其他实体类型失败。主要区别在于实体类型具有大量嵌入式实体，但如果应用引擎能够读取/放置这些实体，我们无法理解为什么它似乎在备份它时出现问题。与我们设置的其他命名空间相比，发生错误的特定命名空间具有为该实体类型存储的最大数据。

我们认为，如果我们可以看到 worker_callback 中发生了什么错误，我们可能能够找出备份失败的原因，或者我们的数据有什么问题阻止了备份。我们是否需要通过设置/配置文件来设置/启用，以便为我们提供有关备份的更详细信息？还是我们应该探索其他途径来弄清楚如何调查/解决这个问题？

我应该提到我们正在使用 Java SDK 以及 Objectify V3 来处理数据存储。我们还将数据备份到 Blobstore。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T17:13:33.597

好吧，在应用引擎团队的帮助下，我们找出了问题所在，并解决了这个问题。我想提供详细信息，以防其他人遇到此问题。

从[issue 8363](http://code.google.com/p/googleappengine/issues/detail?id=8363)开始，应用引擎团队指出，从他们的日志中他们可以看到 map reduce 失败，因为我们的实体类型具有大量属性。导致失败的特定实体类型具有大量变量属性，当 map reduce 尝试写出模式时会生成错误。他们表示，他们的解决方案是忽略备份中这样的实体，以便备份成功。

我们为解决这个问题和使备份工作所做的工作是改变我们告诉 objectify 存储数据的方式。由于我们在 HashMap() 类成员字段上使用了 @embedded 关键字，因此创建了大量属性。由于 Embedded 关键字将类分解为单独的组件，因此它会生成大量属性。我们将成员字段切换为@serialized，然后运行转换过程以使其使用新的序列化属性。这使备份/恢复再次工作。

[您可以在objectify 的网站](http://code.google.com/p/objectify-appengine/wiki/IntroductionToObjectify#@Embedded)上阅读有关嵌入式和序列化之间差异的更多信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T20:42:40.260

snielson，你介意在我们的公共问题跟踪器上打开一个问题[吗](http://code.google.com/p/googleappengine/issues/entry)？请记住添加您的应用程序 ID，以便我们可以进一步调试此特定场景。

谢谢！

# php - 通过索引获取 PHP $_POST 值？

> ID：13040448
> 
> 赞同：1
> 
> 时间：2012-10-23T22:41:59.643
> 
> 标签：php, post, indexing

我很好奇，最重要的是 - 是否可以发布 PHP 值？即`$_POST['foo']`通过某种索引？即`$_POST[0]`？

（`$_POST[0]`顺便说一句不起作用）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-23T22:44:26.103

不，这是不可能的：您不能通过数字索引从关联数组中获取值（因为，正如[doc 中明确指出的](http://www.php.net/manual/en/language.types.array.php)那样，PHP 不区分索引数组和关联数组）。

这就是为什么返回数组的某些函数（例如[PDOStatement::fetch](http://php.net/manual/en/pdostatement.fetch.php)及其兄弟函数）需要一个额外的参数来控制返回数组中索引的“类型”：数字（`FETCH_NUM`）、字符串（`FETCH_ASSOC`）或两者（`FETCH_BOTH`默认值） ）。)

重新索引可能会得到最接近的结果：

```
$myPost = array_values($_POST); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-23T22:44:34.380

不是我知道的，请查看 print_r($_POST) 以查看您可以访问的所有好东西。您可以使用以下**方法迭代**这些值：

```
foreach($_POST as $key=>$value){
    echo $key.' '.$value."\n";
} 
```

`$i++`如果您想跟踪计数，您可以输入一个 ....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:45:23.257

您可以获取存储在 $_POST 变量中的数据并将它们存储到索引元素中。但它们最初并未存储为索引元素。

# google-apps-script - Google App Script - WebAPP - 在 doPost 上返回 HTML 不起作用。doGet 很好

> ID：13040453
> 
> 赞同：0
> 
> 时间：2012-10-23T22:42:32.230
> 
> 标签：google-apps-script

这是我的简单应用脚本。doPost 什么也不返回。但是，如果要发布代码以返回 UIApplication，那么它可以工作文件。

关于如何从 doPost 发送 HTML 输出的任何想法？

```
function doGet() {
   var app = UiApp.createApplication(); 
   var form = app.createFormPanel();
   var flow = app.createFlowPanel();
   flow.add(app.createTextBox().setName("textBox"));
   flow.add(app.createSubmitButton("Submit"));
   form.add(flow);
   app.add(form);

   return app;
 }

 function doPost(eventInfo) {
   /* if i uncomment UiApp section then it works fine, But i want to send HTML, then the reponse is blank */
   /*var app = UiApp.getActiveApplication(); 

   app.add(app.createLabel("Form submitted. The text box's value was '" +
       eventInfo.parameter.textBox + "'"));
   return app;*/
   /* the following returns just blank page */
   outText = "<html><body><h1> Received Text = " + eventInfo.parameter.textBox+"</h1></body></html>";
   return HtmlService.createHtmlOutput(outText);
 } 
```

所以问题是如何通过 doPost 发送 HTML ？看起来如果 doGet retuns UiApp 然后 doPost 必须返回 UiApp。这是限制还是我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:45:09.583

你的怀疑是正确的；没有办法像这样在一个脚本中混合 HtmlService 和 UiApp。

编辑：让我进一步解释。当 UiApp 调用 doPost 时，它不尊重响应，除非它是 UiApp。但是，如果您将表单的操作显式设置为脚本 url，它将尊重响应，无论是 UiApp 还是 HtmlService，并完全替换页面。但是，无法同时在浏览器中同时显示 UiApp 和 HtmlService。

# python - 为什么`gevent.spawn`与猴子补丁`threading.Thread()`不同？

> ID：13040458
> 
> 赞同：8
> 
> 时间：2012-10-23T22:43:25.647
> 
> 标签：python, multithreading, gevent

在仔细检查`threading.Condition`猴子补丁是否正确时，我注意到猴子补丁的`threading.Thread(…).start()`行为与`gevent.spawn(…)`.

考虑：

```
from gevent import monkey; monkey.patch_all()
from threading import Thread, Condition
import gevent

cv = Condition()

def wait_on_cv(x):
    cv.acquire()
    cv.wait()
    print "Here:", x
    cv.release()

# XXX: This code yields "This operation would block forever" when joining the first thread
threads = [ gevent.spawn(wait_on_cv, x) for x in range(10) ]

"""
# XXX: This code, which seems semantically similar, works correctly
threads = [ Thread(target=wait_on_cv, args=(x, )) for x in range(10) ]
for t in threads:
    t.start()
"""

cv.acquire()
cv.notify_all()
print "Notified!"
cv.release()

for x, thread in enumerate(threads):
    print "Joining", x
    thread.join() 
```

请特别注意，以 . 开头的两条注释`XXX`。

使用第一行 (with `gevent.spawn`) 时，第一行`thread.join()`会引发异常：

```
通知！
加入 0
回溯（最近一次通话最后）：
  文件“foo.py”，第 30 行，在
    线程.join()
  文件“…/gevent/greenlet.py”，第 291 行，加入
    结果 = self.parent.switch()
  文件“…/gevent/hub.py”，第 381 行，在交换机中
    返回 greenlet.switch(self)
gevent.hub.LoopExit：此操作将永远阻塞

```

但是，`Thread(…).start()`（第二个块），一切都按预期工作。

为什么会这样？`gevent.spawn()`和有什么区别`Thread(…).start()`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T23:28:20.753

在您的代码中发生的情况是，您在列表中创建的**greenlets**`threads`还没有机会执行，因为`gevent`不会触发上下文切换，除非您在代码中使用`gevent.sleep()`等或通过调用函数显式执行此操作该块例如`semaphore.wait()`或通过屈服等等...，以查看您可以在之前插入打印`cv.wait()`并查看仅在调用之后才`cv.notify_all()`调用它：

```
def wait_on_cv(x):
    cv.acquire()
    print 'acquired ', x
    cv.wait()
    .... 
```

**因此，对您的代码的一个简单修复是在您创建greenlets**列表后插入将触发上下文切换的内容，例如：

```
...
threads = [ gevent.spawn(wait_on_cv, x) for x in range(10) ]
gevent.sleep()  # Trigger a context switch
... 
```

**注意：**我还是新手，`gevent`所以我不知道这是否是正确的方法:)

这样，所有的**greenlets**都有机会被执行，并且每个greenlets在调用时都会触发上下文切换，`cv.wait()`同时他们会将自己注册到条件服务员，以便在`cv.notify_all()`调用时通知所有**greenlets** .

高温下，

# php - PHP 获取页面 iframe 的 URL 位于 iframe 内部

> ID：13040460
> 
> 赞同：1
> 
> 时间：2012-10-23T22:43:32.407
> 
> 标签：php, url, iframe

我一直在网上四处寻找，但找不到解决问题的方法。

让我们在下一页说我有一个 iframe。

```
http://www.mysite.com/cakes.php - this is the url of the page the iframe is on 
```

这是该页面上的 iframe 代码

```
<iframe src = "http://www.mysite.com/secret_frame.php"></iframe> 
```

在 iframe（文件 secret.php）中，我将如何获取 iframe 所在页面的 URL，所以在这种情况下它将是[http://www.mysite.com/cakes.php](http://www.mysite.com/cakes.php)。

谢谢

坦率

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T22:46:57.517

iframed 页面 ,可以通过变量`secret_frame.php`访问包含它的父页面。`$_SERVER['HTTP_REFERER']`

正如@Sven 的回答中提到的，您不能完全信任发送到页面的推荐人。直接来自[手册](http://php.net/manual/en/reserved.variables.server.php)：

> 将用户代理引向当前页面的页面地址（如果有）。这是由用户代理设置的。不是所有的用户代理都会设置这个，有些提供修改 HTTP_REFERER 作为一个特性的能力。简而言之，它不能真正被信任。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:46:37.487

它通常在推荐人中 - 但请记住推荐人不能被信任，它们可能会被更改或完全丢失。

# awesomium - 将 Awesomium SDK 1.6.6 升级到 1.7

> ID：13040463
> 
> 赞同：0
> 
> 时间：2012-10-23T22:43:43.010
> 
> 标签：awesomium

我安装了 Awesomium SDK 1.6.6，我想将它升级到 1.7 候选版本，我该怎么做。因为当我下载 1.7 时，我发现它只包含一些文件，并且没有包含安装文件（比如 1.6 的）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T00:34:53.033

我们尚未为 1.7 版的候选发布版本创建安装程序。RC 不是稳定版本。当 1.7 稳定下来时，还会有一个，然后 1.6.6 安装将能够自动升级到 1.7。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T14:06:35.310

您是否希望使用 .NET 包装器？如果是这样，您应该可以在任何地方下载和提取文件，然后在您的项目中，只需添加对 Awesomium.Core.dll 和 Awesomium.Windows.Forms.dll 或 Awesomium.Windows.Controls.dll 的引用，具体取决于是否您正在使用 Winforms 或 WPF。dll 位于存档中的 awesomium_1_7_rc3_v3_sdk_win\wrappers\AwesomiumNET\Assemblies\ 中。

我相信您希望看到的 setup.exe 仅用于将文件提取到特定位置并在开始菜单中为您提供一些有用的链接，因此您不会因为没有它而错过太多。

# android - 如何将 R.ids 链接到实际的按钮 android 测试

> ID：13040467
> 
> 赞同：0
> 
> 时间：2012-10-23T22:44:06.027
> 
> 标签：android, eclipse, testing, robotium

现在我正在测试`Android 4.1.1`。使用`Robotium`并尝试使用 id 单击图像按钮，因为`solo.clickonImage`或`solo.clickonImageButton`不起作用。

问题是，我不知道如何导入或包含`R.java`文件以获取 ID。我可以从层次结构查看器中看到它，但是当我将变量放在代码中时它仍然给我一个错误。

在我的测试脚本中，我`R.java`没有太多内容，因此无法读取 id。

我应该如何将开发人员 ID 导入我的测试项目？

编辑：实际上我发现这个[以编程方式将 id 添加到 R.id](https://stackoverflow.com/questions/3216294/android-programatically-add-id-to-r-id)。现在我的问题是，我的程序如何知道 id 指向的内容。我创建的示例：

> < 项目名称 = "camera_menu_upload" type="id"/>

我的脚本如何知道屏幕上的 camera_menu_upload 是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T15:10:40.533

要获取按钮、视图、文本视图、复选框...使用此示例：

```
Button buttonview = (Button) solo.getCurentActivity().findViewById(R.id.mybutton);
solo.clickOnView(buttonview); 
```

如果您不知道 id，请使用 Hierarchy Viewer 查看按钮 id。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T23:11:37.877

您可能导入了错误的 R 文件。检查您的导入并确保它正在导入`com.yourcompany.yourapp.R`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:47:32.437

查看[AndroidManifest 文件中的包名称](http://developer.android.com/guide/topics/manifest/manifest-element.html#package)：

```
<manifest package="com.example.project" . . . > 
```

您需要从您的应用程序主包中导入 R 类，例如：com.companyname.appname.R

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-02T07:54:24.837

如果您在那里使用 actionbarsherlock 并尝试单击一个按钮，该按钮是 actionbarsherlock 的一部分，则必须导入其 r.java 文件才能使用该按钮的 id。即来自应用程序（gen）的r.java。
r.java 文件为不同的 id 存储不同的值，因此它会在屏幕上搜索要重新发送的值。当它找到它时，它会对其执行所需的操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-23T23:04:08.170

我不太明白你的问题，但这是你要找的吗？

```
imageButton IB = (imageButton)findViewById(R.id.blablablabla); 
```

# javascript - 当我显示其他人时需要隐藏显示的 div

> ID：13040476
> 
> 赞同：0
> 
> 时间：2012-10-23T22:45:02.650
> 
> 标签：javascript, html, hide, show

我被困住了。我有一个带有 3 个按钮的页面，这 3 个按钮做了几件事——它们改变了 div 的样式，它们还显示/隐藏了一个内容 div。div 样式的更改效果很好，但我遇到了内容 div 的问题。如果您登陆页面并单击“我们的品牌”选项卡，然后单击其他 2 个选项卡，它工作正常。如果您登陆该页面并首先单击“最新消息”或“关于我们”，则显示/隐藏无法正常工作 - 直到您实际单击“我们的品牌”。

[http://www.adriancollins.net/clients/kennys/](http://www.adriancollins.net/clients/kennys/)

任何帮助将不胜感激，我首先是一名设计师，大约是 9000 名开发人员。

显示/隐藏代码

```
<script type="text/javascript">

var _hidediv = null;
function showdiv(id) {
if(_hidediv)
    _hidediv();
var div = document.getElementById(id);
div.style.display = 'block';
_hidediv = function () { div.style.display = 'none'; };
}
</script> 
```

选项卡 div

```
<div id="brand_button"><a href="#" onClick="showdiv('brands_content');     lower.className='blue';angle.className='blue_angle';return false"><img src="wp-content/uploads/2012/10/brands_button.png"></a></div>

<div id="whatsnew_button"><a href="#" onClick="showdiv('new_content');lower.className='black';angle.className='black_angle';return false"><img src="wp-content/uploads/2012/10/whatsnew_button.png"></a></div>

<div id="about_button"><a href="#" onClick="showdiv('about_content');lower.className='green';angle.className='green_angle';return false"><img src="wp-content/uploads/2012/10/about_button.png"></a></div> 
```

内容分区

```
<div id="brands_content">Content...</div>
<div id="new_content">Content...</div>
<div id="about_content">Content...</div> 
```

CSS

```
#brands_content

{
position: relative;
display: block;
width: 990px;
top: 10px;
height: auto;
min-height: 800px;
margin-left: auto;
margin-top: 0px;
margin-right: auto;
border: 0px;
padding: 0px 0px 0px 0px;
z-index: 12;

}

#new_content

{
position: relative;
display: none;
width: 990px;
top: 10px;
height: auto;
min-height: 800px;
margin-left: auto;
margin-top: 0px;
margin-right: auto;
border: 0px;
padding: 0px 0px 0px 0px;
z-index: 999;
color: #fff;

}

#about_content

{
position: relative;
display: none;
width: 990px;
top: 10px;
height: auto;
min-height: 800px;    
margin-left: auto;
margin-top: 0px;
margin-right: auto;
border: 0px;
padding: 0px 0px 0px 0px;
z-index: 999;

} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:08:26.703

```
You can change your body tag to be:

<body class="home page page-id-5 page-template page-template-home-php">

to

<body class="home page page-id-5 page-template page-template-home-php" onload="showdiv('brands_content')"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:01:49.573

一个快速的解决方案是调用 showdiv('brands_content'); 加载完所有 html 后，您就有效地单击了“我们的品牌”，一切都按预期运行。

```
<div id="brand_button"><a href="#" onClick="showdiv('brands_content');     lower.className='blue';angle.className='blue_angle';return false"><img src="wp-content/uploads/2012/10/brands_button.png"></a></div>

 <div id="whatsnew_button"><a href="#" onClick="showdiv('new_content');lower.className='black';angle.className='black_angle';return false"><img src="wp-content/uploads/2012/10/whatsnew_button.png"></a></div>

<div id="about_button"><a href="#" onClick="showdiv('about_content');lower.className='green';angle.className='green_angle';return false"><img src="wp-content/uploads/2012/10/about_button.png"></a></div>
showdiv('brands_content'); 
```

# asp.net - 混合 ASP.NET 站点表单身份验证重定向到错误的位置

> ID：13040477
> 
> 赞同：0
> 
> 时间：2012-10-23T22:45:09.450
> 
> 标签：asp.net, asp-classic, forms-authentication

在我的网络配置中

```
<authorization>
    <deny users="?" />
    <allow roles="Employee" />
</authorization>
<authentication mode="Forms">
  <forms loginUrl="~/Account/LogOn" timeout="2880" />
</authentication> 
```

然后当我转到页面时

```
 HTTP/1.1 302 Found
    Cache-Control: private
    Content-Type: text/html; charset=utf-8
    Location: /Account/Login?ReturnUrl=%2f
    Server: Microsoft-IIS/7.5
    X-AspNet-Version: 4.0.30319
    X-Powered-By: ASP.NET
    Date: Tue, 23 Oct 2012 22:34:55 GMT
    Content-Length: 145

    <html><head><title>Object moved</title></head><body>
    <h2>Object moved to <a href="/Account/Login?ReturnUrl=%2f">here</a>.</h2>
    </body></html> 
```

为什么 LogOn 不给我那个，而是给我登录？

IIS 7.5

网站是

*   经典ASP
*   ASP.NET

使用表单 auth "hack"

[http://weblogs.asp.net/scottgu/archive/2007/03/04/tip-trick-integrating-asp-net-security-with-classic-asp-and-non-asp-net-urls.aspx](http://weblogs.asp.net/scottgu/archive/2007/03/04/tip-trick-integrating-asp-net-security-with-classic-asp-and-non-asp-net-urls.aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T00:55:29.727

将此密钥添加到您的 web.config：

```
<appSettings>
  <add key="loginUrl" value="~/Account/LogOn" />
</appSettings> 
```

显然，在 DLL 中可能会发生一些重定向到不同的“loginUrl”，尤其是当 WebMatrix dll 在路径中时。

# javascript - 在 {{each items}} 期间主干更改类名称

> ID：13040483
> 
> 赞同：0
> 
> 时间：2012-10-23T22:45:30.497
> 
> 标签：javascript, backbone.js, handlebars.js

我想在每个循环期间更改类名；使它看起来像这样；

```
<div class="active">
  // do somthing
</div>
<div class="static">
  //do
</div> 
```

我的代码看起来像这样

```
{{#each pages}}
  <div class="active">
    //do
  </div>
{{/each}} 
```

没有类的标识符。所以第一个将是活动的，其余的项目将是静态的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T01:47:15.020

如果您想在模板中执行此操作，您可以添加自己的助手。像这样的东西：

```
Handlebars.registerHelper('each_with_class', function(ary, first, rest, options) {
    if(!ary || ary.length == 0)
        return options.inverse(this);

    var result  = [ ];
    var context = null;
    var cls     = { cls: first };
    for(var i = 0; i < ary.length; ++i) {
        context = _({}).extend(ary[i], cls);
        result.push(options.fn(context));
        cls.cls = rest;
    }
    return result.join('');
}); 
```

然后你的模板可以这样说：

```
{{#each_with_class pages "active" "static"}}
    <div class="{{cls}}">
        Same stuff you're doing now.
    </div>
{{/each_with_class}} 
```

如果您不介意`ary[i]`在此过程中进行修改，那么您可以直接分配给`ary[i].cls`而不是使用`_.extend`来制作副本。

演示：http: [//jsfiddle.net/ambiguous/ZMSQh/1/](http://jsfiddle.net/ambiguous/ZMSQh/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:03:21.073

据我所知，没有`{{#each}}`可以检查提供的索引..

一种解决方法是将此类存储在您的`pages`项目中，然后使用类似

```
{{#each pages}}
  <div class="{{this.classname}}">
    //do
  </div>
{{/each}} 
```

# php - 我收到未定义索引 tmp_name 通知

> ID：13040486
> 
> 赞同：0
> 
> 时间：2012-10-23T22:45:46.300
> 
> 标签：php

我正在尝试将文件名插入“音频”表中的“音频文件”列。问题是它一直给我一个未定义的索引错误：tmp_name 第 45 行。这意味着当我尝试插入文件名时，而不是执行以下操作：

声音的

```
AudioId (auto)  AudioFile
1               AudioFiles/cat.png
2               AudioFiles/cat_2.png
3               AudioFiles/cat_3.png 
```

它在下面这样做：

声音的

```
AudioId (auto)  AudioFile
1               AudioFiles/_2.png
2               AudioFiles/_2.png
3               AudioFiles/_2.png 
```

所以我的问题是为什么它找不到 tmp 名称并因此在表中插入不正确的文件名：

```
$result = 0;

if( file_exists("AudioFiles/".$_FILES['fileAudio']['name'])) {
    $parts = explode(".",$_FILES['fileAudio']['name']);
    $ext = array_pop($parts);
    $base = implode(".",$parts);
    $n = 2;

    while( file_exists("AudioFiles/".$base."_".$n.".".$ext)) $n++;
    $_FILES['fileAudio']['name'] = $base."_".$n.".".$ext;

    move_uploaded_file($_FILES["fileAudio"]["tmp_name"],  //line 45 notice appears
    "AudioFiles/" . $_FILES["fileAudio"]["name"]);
    $result = 1;

}
    else
      {
      move_uploaded_file($_FILES["fileAudio"]["tmp_name"],
      "AudioFiles/" . $_FILES["fileAudio"]["name"]);
      $result = 1;
  }

    $audiosql = "INSERT INTO Audio (AudioFile) 
    VALUES (?)";

        if (!$insert = $mysqli->prepare($audiosql)) {
      // Handle errors with prepare operation here
    }

            //Dont pass data directly to bind_param store it in a variable
$insert->bind_param("s",$aud);

//Assign the variable
$aud = 'AudioFiles/'.$_FILES['fileAudio']['name'];

 $insert->execute();

        if ($insert->errno) {
          // Handle query error here
        }

        $insert->close(); 
```

下面是表格：

```
 var $fileAudio = $("<form action='audioupload.php' method='post' enctype='multipart/form-data' target='upload_target_audio' onsubmit='return audioClickHandler(this);' class='audiouploadform' >" + 

    "<p class='audiof1_upload_process' align='center'>Loading...<br/><img src='Images/loader.gif' /><br/></p>" +

    "<p class='audiof1_upload_form' align='center'><br/><span class='audiomsg'></span><label>" + 

    "Audio File: <input name='fileAudio' type='file' class='fileAudio' /></label><br/><br/><label class='audiolbl'>" + 

    "<input type='submit' name='submitAudioBtn' class='sbtnaudio' value='Upload' /></label>" + 

    "<iframe class='upload_target_audio' name='upload_target_audio' src='#' style='width:300px;height:300px;border:0px;solid;#fff;'></iframe></form>"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:50:03.083

很难确定哪一行是 45，但这里的经验法则是，如果它说索引未定义，那么它确实是。有两个常见的原因：您在尝试读取它时在索引名称中输入了拼写错误，或者它根本不存在。`print_r()`您可以通过使用或什至打印数组内容来轻松检查存在哪些索引`var_dump()`。然后你要么修正你的错字，要么试着找出它不在这里的原因（如果它真的应该是无条件的）。我还会检查你的元素`<FORM>`，看看你的`<input type="file"... />`元素是否真的被命名并且它的名字是“fileAudio”。

# plone - 如何使用 z3cform 为多个字段引发 WidgetActionExecutionError？

> ID：13040487
> 
> 赞同：1
> 
> 时间：2012-10-23T22:45:51.987
> 
> 标签：plone, z3c.form

我正在使用一种表单，我希望根据另一个字段的值，在许多字段上出现必填字段缺失错误。

用例：用户必须在两种运输方式（邮政或印刷）之间进行选择。如果选择了邮政但尚未填写有关地址的字段，我想提出错误。

这是一些代码

```
class ILivraisonForm(interface.Interface):
    livraison = schema.Choice(title=_(u"Mode de livraison"),
                              vocabulary=vocabulary.livraison)

    livraison_civility = schema.Choice(title=_(u"Civility (livraison)"),
                                       vocabulary=userdata.gender_vocabulary,
                                       required=False)
    livraison_name = schema.TextLine(title=_(u"Name (livraison)"),
                                        required=False)
    livraison_firstname = schema.TextLine(title=_(u"Firstname (livraison)"),
                                        required=False)
    livraison_add1 = schema.TextLine(title=_(u"Address line 1 (livraison)"),
                                        required=False)
    livraison_add2 = schema.TextLine(title=_(u"Address line 2 (livraison)"),
                                        required=False)
    livraison_pc = schema.TextLine(title=_(u"Postal code (livraison)"),
                                        required=False)
    livraison_city = schema.TextLine(title=_(u"City (livraison)"),
                                        required=False)

    livraison_phone = schema.TextLine(title=_(u"Phone"),
                                        required=False)

    accepted = schema.Bool(title=_(u"Accept CGV"),
                           description=_(u"Click here to read the CGV"),
                           required=True)

class LivraisonForm(form.Form):
    fields = field.Fields(ILivraisonForm)

    @button.buttonAndHandler(_(u"Valider"))
    def handleApply(self, action):
        data, errors = self.extractData()
        message = IStatusMessage(self.request)
        if errors:
            self.status = _(u"Please fix errors")
            return
        if not data['accepted']:
            self.status = _(u'You must accept')
            raise WidgetActionExecutionError('accepted',
                                     interface.Invalid(_(u'You must accept')))

        if data['livraison'] == 'mail' \
          and ( not data['livraison_name'] or not data['livraison_firstname'] \
          or not data['livraison_add1'] or not data['livraison_pc'] \
          or not data['livraison_city']):
            self.status = _(u'You must add your postal address')
            raise ??? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T14:21:23.540

你不需要提出任何东西；只需在您所在的位置添加 a`return`而不是`raise`正确的。

此外，您可以在操作处理程序中的各个小部件上设置错误消息，前提是您创建了一个`zope.schema.ValidationError`子类：

```
from zope.schema import ValidationError

class AddressMissing(ValidationError):
    __doc__ = _(u'error_noaddress', u'Please provide an address') 
```

然后在处理程序中：

```
from z3c.form.interfaces import IErrorViewSnippet
from zope import component

def handleApply(self, action):
    # ....

    widget = self.widgets['livraison_add1']
    error = component.getMultiAdapter(
        (AddressMissing(), self.request, widget, widget.field,
         self, self.context), interfaces.IErrorViewSnippet)
    error.update()
    widget.error = error 
```

您可以对所有受影响的小部件执行此操作。

或者，您可以使用不变量来处理此问题：

```
from zope.interface import invariant, Invalid

class ILivraisonForm(interface.Interface):
    # ....

    @invariant
    def validatePostalAddress(data):
        if data.livraison. != 'mail':
            return
        for field in ('name', 'firstname', 'add1', 'pc', 'city'):
            if not data['livraison_' + field]:
                raise Invalid(_(u'error_noaddress', u'Please provide an address')) 
```

并且在您调用时会设置错误`self.extractData()`。

# c# - 以单独的表单 C# 访问表单类对象

> ID：13040488
> 
> 赞同：0
> 
> 时间：2012-10-23T22:45:53.313
> 
> 标签：c#, .net, forms, class, object

> **可能重复：**
> [在另一个类中使用一个类对象？](https://stackoverflow.com/questions/8572206/use-of-one-class-object-in-another-class)

这将是我的第一篇文章，因为我通常可以通过一些网络搜索找到我的答案。我主要是一名 C++ 程序员，但我目前正在为我的一个朋友使用 .NET/C# 编写一个程序。

我创建了一个包含一些成员和一个列表的类。

我以我的主要形式宣布了我的班级。现在我需要以我必须创建的所有其他形式访问该类对象，以便我可以存储和访问我保存的所有信息。

所以我的问题是我不知道如何使该对象在所有创建的表单中都可以访问。

我只是没有足够的 C# 和 .NET 经验来真正解决这个问题，所以任何帮助都将不胜感激。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:03:29.387

您可以通过 ref.. 将您的对象传递给其他形式。

```
//constructor of main form
public Form1()
{
    MyClass foo = new MyClass();
    OtherForm form = new OtherForm(foo);
}

//overload the other forms constructor
public OtherForm(MyClass foo)
{

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:50:19.490

您将按照与 C++ 中相同的方式（基本上）执行此操作：您可以将对象带到所有表单都可以看到的范围内，或者`public`如果您想将对象保留在表单中，您可以创建该对象。

# json - FaceBook 用户工作职位名称解析问题

> ID：13040489
> 
> 赞同：-1
> 
> 时间：2012-10-23T22:45:54.037
> 
> 标签：json, facebook, facebook-graph-api

嗨，我在尝试在 Facebook 图表上获取工作职位名称时遇到问题。我尝试过的（在json中）：

```
    https://graph.facebook.com/me?access_token=ABCDEFGHIJKABCDEFGHIJKABCDEFGHIJKABCDEFGHIJK

    {
    "id":"123456789",
    “名字”：“我我”，
    “工作”： [
    {
    “位置”： {
    "id":"987654321",
    “名称”：“管理员”
            }
    }
    ]
    }

```

在这里，我尝试使用“user_work_history”，它的权限似乎已被授权。

```
    echo json_decode(file_get_contents('https://graph.facebook.com/'.$useid))->work->position->name

```

我需要做什么来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:22:29.143

出色地。简短的回答是工作对象是一个对象数组，因此您需要访问适当的数组元素。以下应该可以解决问题：

```
 echo json_decode(file_get_contents('https://graph.facebook.com/'.$useid))->work[0]->position->name 
```

更长的答案包括一些风格的挑剔——我个人会将代码分成至少两行，主要是为了可读性，我通常更喜欢从 json_decode 而不是对象获取 assoc 数组，但无论哪种方式都可以。这是我如何重写它的近似值（暂时忽略您没有使用 PHP SDK，您可能应该使用它）。不一定是最佳实践（我不声称自己是权威：p），但是，恕我直言，更容易快速阅读、理解、调试和调整：

```
$json = file_get_contents('https://graph.facebook.com/' . $user_id);
$user = json_decode($json, true);
$job_title = $user['work'][0]['position']['name']; 
```

# cakephp - cakephp 和加载引擎

> ID：13040494
> 
> 赞同：2
> 
> 时间：2012-10-23T22:46:17.473
> 
> 标签：cakephp, pdf, routes

大家好，我目前正在使用 cake 2.1，我正在尝试让一个页面在浏览器中呈现为 pdf，但是我相信我没有正确加载引擎。我相信这是因为我没有在`routes.php`.

这是相关的代码`routes.php`

```
 Router::connect('/', array('controller' => 'pages', 'action' => 'display', 'home'));
/**
 * ...and connect the rest of 'Pages' controller's urls.
 */
        Router::connect('/pages/*', array('controller' => 'pages', 'action' => 'display'));

/**
 * Load all plugin routes.  See the CakePlugin documentation on
 * how to customize the loading of plugin routes.
 */
        CakePlugin::routes();
        Router::mapResources(array('Invoices'));

/**
 * Load the CakePHP default routes. Remove this if you do not want to use
 * the built-in default routes.
 */
        require CAKE . 'Config' . DS . 'routes.php'; 
```

这是`boostrap.php`

```
<?php CakePlugin::load('DebugKit');
    CakePlugin::load('CakePdf', array('bootstrap' => true, 'routes' => true));
     CakePlugin::loadAll(); 
```

这是控制器中的功能

```
 public function view($id = null) {
    $this->set('title_for_layout', 'Invoices');
    $this->set('stylesheet_used', 'homestyle');
    $this->set('image_used', 'eBOXLogoHome.png');
    $this->layout='adminpdf';

    Configure::write('CakePdf', array(
        'engine' => 'CakePdf.WkHtmlToPdf',
        'download'=>true,
        'binary'=>'C:\Program Files (x86)\wkhtmltopdf\wkhtmltopdf.exe'));
    $this->pdfConfig = array('engine' => 'CakePdf.WkHtmlToPdf');

            $this->Invoice->id = $id;
            if (!$this->Invoice->exists()) {
                throw new NotFoundException(__('Invalid invoice'));
            }
            $this->pdfConfig = array(
                'orientation' => 'potrait',
                'filename' => 'Invoice_' . $id
            );

            $this->set('invoice', $this->Invoice->read(null, $id));
        //Retrieve Account Id of current User       
        $accountid=$this->Auth->user('account_id');

        //Find all Invoices where $conditions are satisfied
        $invoicedetails=$this->Invoice->find('first', array(
        'conditions' => array('Invoice.id'=>$id)));

        //prints fieldsInvoice details, including invoice and field information
        $invoices=$this->FieldsInvoice->find('all',array(
        'conditions'=>array(
        'invoice_id'=>$id)));

        $itemInvoice=$this->InvoicesItem->find('all',array('conditions'=>array('invoice_id'=>$id)));

        //Set variables
        $this->set('invoicedetails', $invoicedetails);  
        $this->set('invoice', $invoices);   
        $this->set('accountid', $accountid);
        $this->set('itemInvoice', $itemInvoice);

    } 
```

我正在使用这种加载 pdf 的方法 - [https://github.com/ceeram/CakePdf/](https://github.com/ceeram/CakePdf/)

我正在使用这个引擎[wkhtmltopdf](http://code.google.com/p/wkhtmltopdf/)

我已经坚持了几天，所以任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-11T09:58:10.533

您使用 WkHtmlToPdf 您需要下载该引擎，因为它不是默认的。在这里检查：app/plugin/cakepdf/Vendor。您会看到默认值：dompdf、mpdf 和 tcpdf。

我使用 DomPdf。在你的 bootstrap.php 中像这样加载引擎：

```
 Configure::write('CakePdf', array(
        'engine' => 'CakePdf.DomPdf',

       'pageSize'=>'A4',

        'orientation' => 'landscape',

    )); 
```

并在您的控制器内部使用：

```
$this -> pdfConfig = array (
            'orientation' => 'landscape',
            'download' => true,
            'filename' => 'Invoice_' . $id
        ); 
```

你也可以看看：[http ://www.slideshare.net/jellehenkens/building-php-documents-with-cakepdf-cakefest-2012](http://www.slideshare.net/jellehenkens/building-php-documents-with-cakepdf-cakefest-2012)

祝你好运，我希望这会有所帮助。

# facebook - Facebook按钮不扩展容器div

> ID：13040495
> 
> 赞同：0
> 
> 时间：2012-10-23T22:46:17.923
> 
> 标签：facebook, html, facebook-like, expand

我在获取包含 facebook 喜欢/发送按钮的 div 以在单击按钮时展开时遇到问题。我已经搜索并尝试过并试图解决这个问题，但我正在碰壁。我相信这与按钮如何呈现 iframe 有关，但我不确定。

这是代码，简单明了（带有 og 数据的示例链接）。

```
<div id="fb_btns">
<fb:like href="http://www.imdb.com/title/tt0117500/" data-send="true" layout="button_count" width="450" show_faces="false" ></fb:like>
</div> 
```

并且可以在这里看到非扩展的 div

[http://spadeballink.com/GALLOWS/TheGoddamnGallows.html](http://spadeballink.com/GALLOWS/TheGoddamnGallows.html)

任何帮助都很重要！提前致谢！

*此外，没有 css 声明此 div 的高度，声明的唯一高度是 html 和 body 为 100%（需要背景图像）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T06:24:28.790

您使用的是 XFBML 还是 Iframe 版本的like 按钮？对于 iframe 版本，您需要使用 layout=standard 以便人们能够看到弹出的评论框。

# git - 可以在实时站点的 Web 根目录中拥有 git 存储库吗？

> ID：13040504
> 
> 赞同：5
> 
> 时间：2012-10-23T22:46:52.697
> 
> 标签：git, version-control

我使用 git 将源代码更改（从 GitHub 推送后`dev`）拉到实时网站上的 Web 应用程序。我的 .git 目录/repo 位于我的 web 根目录中（不能公开访问），就像大多数项目在构建 web 应用程序并开始使用带有 ' `git init`' 等的 git 时一样。**这个可以吗？**

通过“好的”，我的意思是我知道可能有也可能没有更好的位置来将 .git 存储库放在`production`服务器上并使用构建脚本进行部署或其他东西，但在你的回答中，我首先想知道它是否是“好的”，从安全、最佳实践等角度来看，我目前正在这样做。这似乎是将更改部署到实时站点并维护 git 存储库的最简单、直接的方法，并且它一直在为我工作。

如果它是“好的，但有更好的方法”，我也对这些建议感到好奇。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-24T02:10:36.577

这很好，但更好的方法是确保您的历史记录不在 Web 根目录的文件夹中。您可以使用 git 级别选项来解决此问题，让 git 知道工作目录在哪里：

```
git --git-dir=some/path/.git --work-tree=my/web/root/projectX pull 
```

会更新。如果您正在编写脚本并且不想重复这些选项，您可以设置 2 个环境变量，然后您可以跳过这些选项。

您也可以将 git repo 放在其他地方，然后使用 archive 命令取出工作文件夹：

```
git archive | tar -xzvf 
```

还要考虑在您的历史记录中没有任何东西，例如连接字符串或密码。让部署脚本在部署时操作这些文件。

# java - 处理中的标准 (processing.org)

> ID：13040508
> 
> 赞同：1
> 
> 时间：2012-10-23T22:47:12.073
> 
> 标签：java, input, processing

这个简单的代码在处理过程中从未对我有用：

```
try {
  BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
  String str = "";
  while (str != null) {
    System.out.print("> prompt ");
    str = in.readLine();
    println(str);
  }
} 
catch (IOException e) {
} 
```

可能是因为控制台输出框不能用于输入，这与 Eclipse 不同。是否有一个简单的解决方法，或者我是否被迫为标准输入执行诸如对话框（或按键处理）之类的操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T18:52:51.267

如果您使用的是 Processing IDE，Processing 本身不支持此行为。如果您导出草图并编辑 java 文件，或使用[Eclipse、Proclipsing、core.jar](http://wiki.processing.org/w/Eclipse_Plug_In)等，您可以像任何其他 java 应用程序一样访问 System.in，但是，这会破坏处理的目的，因为它没有t 通常从命令行运行并且本质上是图形的。

最佳做法是使用按键方法捕获按键。例如：

```
String str = "";

void keyPressed() {
    str += key;
} 
```

然后在您的 draw() 循环/方法中，您可以处理 str 上的文本输入并在需要时将其清除。

如果你想要更复杂的东西来获得更好的用户体验，我建议使用[ControlP5 的](http://www.sojamo.de/libraries/controlP5/)TextField 或 TextArea 之类的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T22:02:54.980

您的程序运行良好（我将其命名为 test）并将其导出为 Applet。我用 cygwin 以及 windows 命令提示符进行了测试：

```
$ cd test/applet
$ java -jar test.jar 
```

输出（我输入“hello”并回车）：

```
prompt> hello
hello
prompt> 
```

我通过 ssh 在 Ubuntu 终端上进行了非常快速的尝试。我在将它连接到 x11 服务器时遇到了问题。如果这是一个问题，请考虑：[http ://en.wikipedia.org/wiki/Xvfb。](http://en.wikipedia.org/wiki/Xvfb)

只是为了确认一下，我能够运行 Library->Network 中包含的 SharedCanvasServer 示例，我在其中添加了一个 System.out.println 以将调试转储到正在执行的终端。

```
java -cp "core.jar;net.jar;SharedCanvasServer.jar" SharedCanvasServer 
```

# javascript - 如何在延迟的情况下将标记添加到谷歌地图

> ID：13040509
> 
> 赞同：0
> 
> 时间：2012-10-23T22:47:20.310
> 
> 标签：javascript, google-maps

我有一个从另一个函数接收到的 JS 数组；我需要遍历它并向地图添加延迟标记。然而，它似乎跳到最后一个标记。我测试了数组大小，很好我在循环中测试了数组值，它们是很好的标记函数（当在循环中没有设置超时函数调用时）工作正常

```
<script>
var map;
var PlayDatesArray=new Array();

function playAllHistoryFunction(){   
    timeDelay1=1;       
    for(i=0; i<PlayDatesArray.length; i++) {
        pddtArray = PlayDatesArray[i].split("|"); //split String using | delimiter[date]|[lat]|[lon]   
        lt1=pddtArray[1];
        ln1=pddtArray[2];
        tstamp1= pddtArray[0];
        oldtimeDelay1=timeDelay1;
        newTimeDelay=1500;
        timeDelay1=oldtimeDelay1+newTimeDelay;        
        setTimeout(function(){            
        centerMap(lt1, ln1);
        map.setZoom(14);
        addMarker(lt1, ln1, tstamp1);                
            }, timeDelay1);        
    }
}

function centerMap(lat1, lon1){
    var latlngbounds1 = new google.maps.LatLngBounds(); 
    latlngbounds1.extend(new google.maps.LatLng(lat1, lon1)); 
    map.fitBounds(latlngbounds1);  
}

function addMarker(lat, lng, name){
    var image = new google.maps.MarkerImage('images/icon-home.gif');\
    var mn = new google.maps.Marker({
        map: map,
        icon: image,
        position: new google.maps.LatLng(lat, lng),
        title: name
    });  
    map.setCenter(new google.maps.LatLng(lat, lng));     
}

</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T02:01:09.513

正如最初在我的评论中发布的那样，这是一个“循环关闭”问题。这已经在这里讨论过，[这里](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)是一个非常决定性的回应。

# xml - 片段输入 xhtml 以使用祖先节点分离 xhtml 文件

> ID：13040516
> 
> 赞同：1
> 
> 时间：2012-10-23T22:48:17.153
> 
> 标签：xml, xslt-2.0, xpath-2.0

有人可以帮我解决这个问题。非常感谢。

**要求：**

1.  要为每个 pal:fragment 元素生成单独的 html 文件，对于附加的源文档，文件的名称基于 pal:fragment 元素上的@fragment-id。
2.  'pal:fragment' 可以嵌套，用 'div' 元素包裹。
3.  分片文件不仅应包含 pal:fragment 的所有子元素，还应包含其祖先 'div' 元素。从 'pal:fragment' 生成的每个单独文件不应包含其后代 'pal:fragment 内容的内容。

请参阅以下示例以了解需求

*示例 1：*如果为 'pal:fragment' fragment-id="DLM3989039" 生成片段文件，内容应如下所示（删除 html 标记以便于理解）

```
<div class="bill" id="DLM3988900">
    <div class="schedule-group">
        <div class="schedule" id="DLM3989039">
            <p>DLM3989039 dummy text </p>
            <div class="schedule-provisions"></div>
        </div>
    </div>
</div> 
```

*示例 2*：如果为 'pal:fragment' fragment-id="DLM3989044" 生成片段文件，则内容应如下所示。（为了便于理解，去掉了 html 标记）

```
<div class="bill" id="DLM3988900">
    <div class="schedule-group">
        <div class="schedule" id="DLM3989039">
            <div class="schedule-provisions">
                <div class="part" id="DLM3989044">
                    <p>DLM3989044 dummy content</p>
                </div>
            </div>
        </div>
    </div>
</div> 
```

# **我使用的**XML 文档****

 **```
<?xml version="1.0" encoding="UTF-8"?>
<div class="bill" id="DLM3988900" xmlns:pal="http://www.google.nz/rendition-info"
    xmlns="http://www.w3.org/1999/xhtml">
    <div class="billdetail">
        <pal:fragment fragment-id="DLM3988901" fragment-type="explnote">
            <div class="explnote" id="DLM3988901">
                <p>DLM3988901 dummy text</p>
            </div>
        </pal:fragment>
    </div>
    <pal:fragment fragment-id="DLM3988906" fragment-type="contents">
        <div class="cover" id="DLM3988906">
            <p>DLM3988906 dummy text</p>
        </div>
        <div class="body" id="DLM3988910">
            <pal:fragment fragment-id="DLM3988963" fragment-type="part">
                <div class="part" id="DLM3988963">
                    <p>DLM3988963 dummy text</p>
                    <pal:fragment fragment-id="DLM3988965" fragment-type="prov">
                        <div class="prov" id="DLM3988965">
                            <p>DLM3988965 dummy text</p>
                        </div>
                    </pal:fragment>
                </div>
            </pal:fragment>
            <pal:fragment fragment-id="DLM3989003" fragment-type="part">
                <div class="part" id="DLM3989003">
                    <p>DLM3989003 dummy text</p>
                    <pal:fragment fragment-id="DLM3989004" fragment-type="subpart">
                        <div class="subpart" id="DLM3989004">
                            <p>DLM3989004 dummy text</p>
                            <pal:fragment fragment-id="DLM3989005" fragment-type="prov">
                                <div class="prov" id="DLM3989005">
                                    <p>DLM3989005 dummy text</p>
                                </div>
                            </pal:fragment>
                        </div>
                    </pal:fragment>
                </div>
            </pal:fragment>
        </div>
    </pal:fragment>
    <div class="schedule-group">
        <pal:fragment fragment-id="DLM3989039" fragment-type="schedule">
            <div class="schedule" id="DLM3989039">
                <p>DLM3989039 dummy text </p>
                <div class="schedule-provisions">
                    <pal:fragment fragment-id="DLM3989044" fragment-type="part">
                        <div class="part" id="DLM3989044">
                            <p>DLM3989044 dummy content</p>
                            <pal:fragment fragment-id="DLM3989057" fragment-type="subpart">
                                <div class="subpart" id="DLM3989057">
                                    <p>DLM3989057 dummy content</p>
                                    <pal:fragment fragment-id="DLM3989059" fragment-type="prov">
                                        <div class="prov" id="DLM3989059">
                                            <p> DLM3989059 dummy coent</p>
                                        </div>
                                    </pal:fragment>
                                </div>
                            </pal:fragment>
                        </div>
                    </pal:fragment>
                </div>
            </div>
        </pal:fragment>
    </div>
</div> 
```

==============

# **我创建的 XSLT 样式表：**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns:foo="http://www.google.nz/rendition-info"
    xmlns:html="http://www.w3.org/1999/xhtml" exclude-result-prefixes="xs foo html" version="2.0">

    <xsl:strip-space elements="*"/>

    <xsl:param name="target_directory" select="''" as="xs:string"/>
    <xsl:param name="input_doc_loc"
        select="xs:anyURI(substring-before(document-uri(/),$input_file_name))" as="xs:anyURI"/>
    <xsl:param name="output_dir" as="xs:anyURI">
        <xsl:choose>
            <xsl:when test="$target_directory = ''">
                <xsl:value-of select="$input_doc_loc"/>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="concat($target_directory, '/')"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:param>

    <xsl:param name="input_file_name" as="xs:anyURI">
        <xsl:variable name="filename">
            <xsl:call-template name="get_file_name">
                <xsl:with-param name="file_name" select="document-uri(/)" as="xs:anyURI"/>
            </xsl:call-template>
        </xsl:variable>
        <xsl:value-of select="$filename"/>
    </xsl:param>

    <xsl:template name="get_file_name">
        <xsl:param name="file_name" as="xs:anyURI"/>
        <xsl:choose>
            <xsl:when test="contains($file_name, '/')">
                <xsl:call-template name="get_file_name">
                    <xsl:with-param name="file_name"
                        select="xs:anyURI(substring-after($file_name, '/'))"/>
                </xsl:call-template>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="$file_name"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:template>

    <xsl:param name="frag_file_ext" select="'.html'" as="xs:string"/>

    <xsl:output media-type="text/html" method="html"/>

    <xsl:template name="generate_output_doc">
        <xsl:variable name="fragment_name" as="xs:anyURI"
            select="xs:anyURI(concat(@fragment-id,$frag_file_ext))"/>
        <xsl:variable name="fragment_file" as="xs:anyURI"
            select="xs:anyURI(concat($output_dir,$fragment_name))"/>

        <xsl:variable name="child-content" select="node()"/>

        <xsl:variable name="ancestor-divs" as="node()*">
            <xsl:apply-templates select="parent::html:div[1]" mode="div-content"/>
            <xsl:apply-templates select="node()"/>
        </xsl:variable>
        <xsl:variable name="reverse-ancestor-divs" as="node()*">
            <xsl:sequence select="reverse($ancestor-divs)"/>
        </xsl:variable>

        <xsl:result-document href="{$fragment_file}">
            <html xmlns="http://www.w3.org/1999/xhtml">
                <head>
                    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
                </head>
                <body>
                    <xsl:sequence select="$ancestor-divs"/>
                </body>
            </html>
        </xsl:result-document>
    </xsl:template>

    <xsl:template match="foo:fragment">
        <xsl:call-template name="generate_output_doc"/>
    </xsl:template>

    <xsl:template match="html:div">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="html:div" mode="div-content">
        <xsl:copy>
            <xsl:apply-templates select="@*"/>
            <xsl:apply-templates select="ancestor::html:div[1]" mode="div-content"/>
        </xsl:copy>
    </xsl:template>

    <!-- The standard identity template -->
    <xsl:template match="*| @*">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

</xsl:stylesheet> 
```

=============

虽然使用上面附加/提到的示例文件，但生成的单独 html 文件的数量为“11”，这（文件数量）符合预期。我的 XSLT 样式表有问题。生成的输出如下所示（以下提及）：

1.  'foo:fragment' 的祖先节点未正确嵌套，并且不包含片段内容作为其子/后代，而是作为兄弟节点写入。

获取由“DLM3989039”“pal:fragment”元素生成的 html 单独文件

```
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
   </head>
   <body>
      <div class="schedule-group">
         <div class="bill" id="DLM3988900"></div>
      </div>
      <div xmlns:foo="http://www.google.nz/rendition-info" class="schedule" id="DLM3989039">
         <p>DLM3989039 dummy text </p>
         <div class="schedule-provisions"></div>
      </div>
   </body>
</html> 
```

谢谢和问候，苏雷什。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T09:45:49.243

我不确定我是否完全理解您的要求，但这是我认为您想要实现的目标的实现：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns:pal="http://www.google.nz/rendition-info"
    xmlns:html="http://www.w3.org/1999/xhtml" exclude-result-prefixes="xs pal html" version="2.0"
    xmlns="http://www.w3.org/1999/xhtml">

<xsl:param name="frag_file_ext" select="'.html'" as="xs:string"/>

<xsl:output method="xhtml" indent="yes" media-type="text/html" omit-xml-declaration="yes"/>
<xsl:strip-space elements="*"/>

<xsl:template match="/">
  <xsl:apply-templates select="//pal:fragment" mode="doc"/>
</xsl:template>

<xsl:template match="pal:fragment" mode="doc">
  <xsl:result-document href="{@fragment-id}{$frag_file_ext}">
      <html>
          <head>
          </head>
          <body>
              <xsl:apply-templates select="ancestor::html:div[last()]">
                <xsl:with-param name="doc-frag" as="element(pal:fragment)" select="current()" tunnel="yes"/>
              </xsl:apply-templates>
          </body>
      </html>
  </xsl:result-document>
</xsl:template>

<xsl:template match="@* | node()">
  <xsl:copy>
    <xsl:apply-templates select="@* , node()"/>
  </xsl:copy>
</xsl:template>

<xsl:template match="html:*">
  <xsl:param name="doc-frag" as="element(pal:fragment)" tunnel="yes"/>
  <xsl:variable name="doc-anc" as="element()*" select="$doc-frag/ancestor-or-self::*"/>
  <xsl:choose>
    <xsl:when test="$doc-anc[. is current()]">
      <xsl:element name="{name()}">
        <xsl:apply-templates select="@* , *[descendant-or-self::*[. is $doc-frag]]"/>
      </xsl:element>
    </xsl:when>
    <xsl:when test="ancestor::pal:fragment[. is $doc-frag]">
      <xsl:element name="{name()}">
        <xsl:apply-templates select="@* , node()"/>
      </xsl:element>
    </xsl:when>
  </xsl:choose>
</xsl:template>

<xsl:template match="pal:fragment">
  <xsl:param name="doc-frag" as="element(pal:fragment)" tunnel="yes"/>
  <xsl:if test="$doc-frag/ancestor-or-self::pal:fragment[. is current()]">
    <xsl:apply-templates/>
  </xsl:if>
</xsl:template>

</xsl:stylesheet> 
```

当我将带有 Saxon 9.4 HE 的样式表应用于输入时

```
<?xml version="1.0" encoding="UTF-8"?>
<div class="bill" id="DLM3988900" xmlns:pal="http://www.google.nz/rendition-info"
    xmlns="http://www.w3.org/1999/xhtml">
    <div class="billdetail">
        <pal:fragment fragment-id="DLM3988901" fragment-type="explnote">
            <div class="explnote" id="DLM3988901">
                <p>DLM3988901 dummy text</p>
            </div>
        </pal:fragment>
    </div>
    <pal:fragment fragment-id="DLM3988906" fragment-type="contents">
        <div class="cover" id="DLM3988906">
            <p>DLM3988906 dummy text</p>
        </div>
        <div class="body" id="DLM3988910">
            <pal:fragment fragment-id="DLM3988963" fragment-type="part">
                <div class="part" id="DLM3988963">
                    <p>DLM3988963 dummy text</p>
                    <pal:fragment fragment-id="DLM3988965" fragment-type="prov">
                        <div class="prov" id="DLM3988965">
                            <p>DLM3988965 dummy text</p>
                        </div>
                    </pal:fragment>
                </div>
            </pal:fragment>
            <pal:fragment fragment-id="DLM3989003" fragment-type="part">
                <div class="part" id="DLM3989003">
                    <p>DLM3989003 dummy text</p>
                    <pal:fragment fragment-id="DLM3989004" fragment-type="subpart">
                        <div class="subpart" id="DLM3989004">
                            <p>DLM3989004 dummy text</p>
                            <pal:fragment fragment-id="DLM3989005" fragment-type="prov">
                                <div class="prov" id="DLM3989005">
                                    <p>DLM3989005 dummy text</p>
                                </div>
                            </pal:fragment>
                        </div>
                    </pal:fragment>
                </div>
            </pal:fragment>
        </div>
    </pal:fragment>
    <div class="schedule-group">
        <pal:fragment fragment-id="DLM3989039" fragment-type="schedule">
            <div class="schedule" id="DLM3989039">
                <p>DLM3989039 dummy text </p>
                <div class="schedule-provisions">
                    <pal:fragment fragment-id="DLM3989044" fragment-type="part">
                        <div class="part" id="DLM3989044">
                            <p>DLM3989044 dummy content</p>
                            <pal:fragment fragment-id="DLM3989057" fragment-type="subpart">
                                <div class="subpart" id="DLM3989057">
                                    <p>DLM3989057 dummy content</p>
                                    <pal:fragment fragment-id="DLM3989059" fragment-type="prov">
                                        <div class="prov" id="DLM3989059">
                                            <p> DLM3989059 dummy coent</p>
                                        </div>
                                    </pal:fragment>
                                </div>
                            </pal:fragment>
                        </div>
                    </pal:fragment>
                </div>
            </div>
        </pal:fragment>
    </div>
</div> 
```

我得到 11 个`DMLxxx.html`结果文件

```
Mode                LastWriteTime     Length Name
----                -------------     ------ ----
-a---        24.10.2012     11:38        387 DLM3988901.html
-a---        24.10.2012     11:38        375 DLM3988906.html
-a---        24.10.2012     11:38        393 DLM3988963.html
-a---        24.10.2012     11:38        468 DLM3988965.html
-a---        24.10.2012     11:38        393 DLM3989003.html
-a---        24.10.2012     11:38        471 DLM3989004.html
-a---        24.10.2012     11:38        552 DLM3989005.html
-a---        24.10.2012     11:38        447 DLM3989039.html
-a---        24.10.2012     11:38        549 DLM3989044.html
-a---        24.10.2012     11:38        639 DLM3989057.html
-a---        24.10.2012     11:38        731 DLM3989059.html 
```

例如在`DLM3988901.html`哪里

```
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   </head>
   <body>
      <div class="bill" id="DLM3988900">
         <div class="billdetail">
            <div class="explnote" id="DLM3988901">
               <p>DLM3988901 dummy text</p>
            </div>
         </div>
      </div>
   </body>
</html> 
```

并且`DLM3989044.html`是

```
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   </head>
   <body>
      <div class="bill" id="DLM3988900">
         <div class="schedule-group">
            <div class="schedule" id="DLM3989039">
               <div class="schedule-provisions">
                  <div class="part" id="DLM3989044">
                     <p>DLM3989044 dummy content</p>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </body>
</html> 
```**

# variables - actionscript 2.0 输入文本框

> ID：13040518
> 
> 赞同：1
> 
> 时间：2012-10-23T22:48:33.960
> 
> 标签：variables, input, textbox, actionscript-2, response

所以，这就是我想要做的，坦率地说，我相信这应该是显而易见的，但我无法弄清楚。我正在创建一个非常简单的人工智能模拟。在这个模拟中，屏幕底部有一个输入框（精确地称为“输入”）。“输入”在其属性中有一个变量，称为“收件箱”（确切地说）。使用按键侦听器，脚本在按下回车按钮时调用一个函数。该函数有 2 个 if 语句和一个 else 语句，它们指示 AI 的响应（名为“nistra”）。问题是，当我输入我想说的话，然后按回车键时，它总是使用第二个响应（下面代码中的“lockpick”）。我已经尝试了代码的变体，但我仍然没有看到解决方案。我认为问题在于“typein”变量包含来自文本框以及变量的所有格式信息，但我可能错了，该​​信息也在这里，位于代码本身的下方。我能得到的任何帮助将不胜感激。

```
var typein = ""; //copies the text from inbox into here, this is what nistra responds to
var inbox = ""; //this is where the text from the input text box goes
var respond = ""; //nistra's responses go here
my_listener = new Object(); // key listener
my_listener.onKeyDown = function()
{
    if(Key.isDown(13)) //enter button pressed
    {
        typein = inbox; // moves inbox into typein
        nistraresponse(); // calles nistra's responses
    }
    //code = Key.getCode();
    //trace ("Key pressed = " + code);
}

Key.addListener(my_listener); // key listener ends here

nistraresponse = function() // nistra's responses
{
    trace(typein); // trace out what "typein" holds
    if(typein = "Hello") // if you type in "Hello"
    {
        respond = "Hello, How are you?";
    }
    if(typein = "lockpick") // if you type in "lockpick"
    {
        respond = "Affirmative";
    }
    else // anything else
    {
        respond = "I do not understand the command, please rephrase";
    }
    cntxtID = setInterval(clearnistra, 5000); // calls the function that clears out nistra's response box so that her responses don't just sit there
}

clearnistra = function() // clears her respond box
{
    respond = "";
    clearInterval(cntxtID);
} 
```

// "typein" 跟踪以下内容

```
<TEXTFORMAT LEADING="2"><P ALIGN="CENTER"><FONT FACE="Times New Roman" SIZE="20" COLOR="#FF0000" LETTERSPACING="0" KERNING="0">test</FONT></P></TEXTFORMAT> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:53:53.183

由于 ActionScript 基于 ECMAScript，我很确定您需要使用`==`而不是`=`进行相等比较。

现在你的代码是这样工作的：

```
if(typein = "Hello") { // assign "Hello" to typein. always true.
    respond = "Hello, How are you?";
}
if(typein = "lockpick") { // assign "lockpick" tot ypein. always true.
    respond = "Affirmative";
}
// the else block is always false for obvious reasons 
```

所以你只需要像这样更改代码：

```
if(typein == "Hello") {
    respond = "Hello, How are you?";
}
else if(typein == "lockpick") {
    respond = "Affirmative";
}
else {
    respond = "I do not understand the command, please rephrase";
} 
```

# java - ArrayBlockingQueue 超出给定容量

> ID：13040521
> 
> 赞同：4
> 
> 时间：2012-10-23T22:49:11.360
> 
> 标签：java, concurrency, java.util.concurrent, capacity

我编写了解决有界生产者和消费者问题的程序。在构建时`ArrayBlockingQueue`，我定义了容量 100。我正在使用方法 take 和 put 内部线程。而且我注意到，有时我会看到 102 次 put ，它们之间有任何 take 。为什么会这样？

生产者运行方法：

```
public void run() {
    Object e = new Object();
    while(true) {
        try {
            queue.put(e);
        } catch (InterruptedException w) {
                System.out.println("Oj, nie wyszlo, nie bij");
        }
        System.out.println("Element added");

    }
} 
```

消费者运行方法：

```
public void run() {
    while(true) {
        try {
            queue.take();
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        System.out.println("Element removed");
    }
} 
```

带有输出的文件中的 uniq -c 的一部分：

```
102 Element removed
102 Element added
102 Element removed
102 Element added
102 Element removed
102 Element added
102 Element removed
102 Element added
102 Element removed
102 Element added
102 Element removed
102 Element added
  2 Element removed
  2 Element added
102 Element removed
102 Element added 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T22:51:33.553

> 我定义了容量 100。我正在使用方法 take 和 put 内部线程。而且我注意到，有时我会看到 102 次 put ，它们之间有任何 take 。为什么会这样？

这很可能是输出中竞争条件的副产品，而不是暗示阻塞队列在队列中曾经有超过 100 个条目。在将元素放入队列*后*，线程可能会从队列中删除某些内容，但会在推杆显示`"removed"`消息*之前*`"added"`显示消息 - 反之亦然。队列调用之间没有锁定，`System.out.println(...)`因此无法保证顺序。

如果有任何问题，打印出来`queue.size()`看看它是否超过 100。`ArrayBlockingQueue`永远不会告诉你。

# xml - src/main/resources 读/写 xml 文件

> ID：13040522
> 
> 赞同：1
> 
> 时间：2012-10-23T22:49:14.453
> 
> 标签：xml, file

我要疯了 ！我的项目是基于 maven 的 web 项目。所以我有一个名为“defter.xml”的 xml 文件，它位于 src/main/resources 下。我想读写这个 xml 文件。首先，要检查xml文件的相对路径是什么，我曾经

```
String path=getClass().getResource("/defter.xml").getPath(); 
```

但它抛出了“java.lang.NullPointerException”。如何读取和写入此文件？请帮我 ！

# php - 如何在不实际离开 PHP 站点的情况下将帖子提交到站点

> ID：13040524
> 
> 赞同：-4
> 
> 时间：2012-10-23T22:49:38.710
> 
> 标签：php, javascript

所以我有这个链接器，您可以从我的应用程序登录到您的帐户（它是一个投标网站）。问题是它会将您发送到该页面并让您登录。有没有办法让我`$_POST[]`提交并登录到站点，而无需实际离开链接器所在的站点。

如果你需要看什么，请告诉我。

非常感谢！

更新---------------使用jquery

```
<div class="linkdimesAccount">
<form name="aspnetForm" method="post" action="http://1betvegas.com/default.aspx" onkeypress="javascript:return WebForm_FireDefaultButton(event, 'ctl00_MainContent_ctlLogin_BtnSubmit')" id="aspnetForm" style="margin: 0 0 0 0;">
            <script type="text/javascript">
                //<![CDATA[
                var theForm = document.forms['aspnetForm'];
                if (!theForm) {
                    theForm = document.aspnetForm;
                }
                function __doPostBack(eventTarget, eventArgument) {
                    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
                        theForm.__EVENTTARGET.value = eventTarget;
                        theForm.__EVENTARGUMENT.value = eventArgument;
                        theForm.submit();
                    }
                }
                //]]>
                </script>
             <div>
            <input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="">
            <input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="">
            <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="eYjk1H7gGdxNJmuevBY9L0vo1lS2NWgmApCJFEQznQr+AwZaPf/hYV4iGSnPCSknyHjESN/BgHueeChVuGgmN4wtWFCdUaYPJRItirNF0nIBHe9Q">
            </div>
            <script src="/WebResource.axd?d=FrT3YL7-WvrI_DKD4vsDo2d0Al_8j_u_HUym76C9Z5ggdJlIe1yu5cWI_jZDYcizjTU0SkefrocS8ATa0&amp;t=634604245351482412" type="text/javascript"></script>
            <div>

                <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="yepc3zJ4Kjr5ru/aXm+s9SqYXyFoM+cwIlWPI69lDMnO4eybZJ1cM1pfzowM47Ggezne5505JNUx/VGe3XO8OCmvZnghqv8ZCuJm+yffjs4inz2n6ctjK/0F/qER0ARSznB8iJsMIZ7HxPXA/Stv+0ubH0U=">
            </div>
            <h2>Link your 5dimes account</h2>

                <table>
                    <tr>
                    <?php
                    if ($dimesaccount == 1){
                    echo "<h2 style='color:red;'> Please note your account is already linked.  If password or other information has changed please re-enter your username and password";
                    }
                    ?>
                        <td>
                        Username:
                        </td>
                         <td>
                            <input name="ctl00$MainContent$ctlLogin$_UserName" type="text" size="15" id="ctl00_MainContent_ctlLogin__UserName" accesskey="u" tabindex="60" class="login_input">
                        </td>
                    </tr>
                    <tr>
                     <td>
                        Password:
                        </td>
                    <td>
                        <input name="ctl00$MainContent$ctlLogin$_IdBook" type="hidden" id="ctl00_MainContent_ctlLogin__IdBook">
                        <input name="ctl00$MainContent$ctlLogin$Redir" type="hidden" id="ctl00_MainContent_ctlLogin_Redir" value="wager/welcome.aspx">
                        <input name="ctl00$MainContent$ctlLogin$_Password" type="password" size="15" id="ctl00_MainContent_ctlLogin__Password" accesskey="p" tabindex="61" class="login_input">
                    </td>
                    </tr>
                    <tr>
                    <td>
                        <input type="submit" name="ctl00$MainContent$ctlLogin$BtnSubmit" value="Link" id="ctl00_MainContent_ctlLogin_BtnSubmit" class="login_input" style="text-transform: uppercase;">
                    </td>
                    </tr>

                </table>

        </div><!-------.linkdimesAccount ------>
        </form>
        <div id="result"></div>
        <script>
  /* attach a submit handler to the form */
  $("#aspnetForm").submit(function(event) {

    /* stop form from submitting normally */
    event.preventDefault(); 

    /* get some values from elements on the page: */
    var $form = $( this ),
        term = $form.find( 'input[name="__EVENTTARGET"]' ).val(),
        term1 = $form.find( 'input[name="__EVENTARGUMENT"]' ).val(),
        term2 = $form.find( 'input[name="__VIEWSTATE"]' ).val(),
        term3 = $form.find( 'input[name="ctl00$MainContent$ctlLogin$_UserName"]' ).val(),
        term4 = $form.find( 'input[name="ctl00$MainContent$ctlLogin$_IdBook"]' ).val(),
        term5 = $form.find( 'input[name="ctl00$MainContent$ctlLogin$Redir"]' ).val(),
        term6 = $form.find( 'input[name="ctl00$MainContent$ctlLogin$_Password"]' ).val(),
        term7 = $form.find( 'input[name="ctl00$MainContent$ctlLogin$BtnSubmit"]' ).val(),

        url = $form.attr( 'action' );

    /* Send the data using post and put the results in a div */
    $.post( url, { s: term, s: term1, s: term2, s: term3, s: term4, s: term5, s: term6, s: term7 },
      function( data ) {
          var content = $( data ).find( '#content' );
          $( "#result" ).empty().append( content );
      }
    );
  });
</script> 
```

因此，当运行它时，它会将我带到登录页面，即使它应该随着 eh 事件停止而停止。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:55:31.540

如果您不想使用 javascript/jquery，您可以发布到 iframe：

[http://css-tricks.com/snippets/html/post-data-to-an-iframe/](http://css-tricks.com/snippets/html/post-data-to-an-iframe/)

This has the added ability of being able to handle file uploads. It's a good way of not leaving the page upon submission of a form. If you want jquery, see the other guys answer, it's fine too.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:52:59.527

试试 jQuery`$.post(url, data, function(a,b){..manage success result..})`

# linux - 清理 iframe 恶意软件

> ID：13040532
> 
> 赞同：1
> 
> 时间：2012-10-23T22:51:02.087
> 
> 标签：linux, sed, malware

我正在帮助某人清理网站上的恶意软件感染，但我很难正确匹配 sed 中的某些字符串，因此我可以创建一个脚本来批量搜索并替换/删除它。

字符串是：

```
<script>document.write('<style>.vb_style_forum {filter: alpha(opacity=0);opacity: 0.0;width: 200px;height: 150px;}</style><div class="vb_style_forum"><iframe height="150" width="200" src="http://www.iws-leipzig.de/contacts.php"></iframe></div>');</script>

<script>document.write('<style>.vb_style_forum {filter: alpha(opacity=0);opacity: 0.0;width: 200px;height: 150px;}</style><div class="vb_style_forum"><iframe height="150" width="200" src="http://vidintex.com/includes/class.pop.php"></iframe></div>');</script>

<script>document.write('<style>.vb_style_forum {filter: alpha(opacity=0);opacity: 0.0;width: 200px;height: 150px;}</style><div class="vb_style_forum"><iframe height="150" width="200" src="http://www.iws-leipzig.de/contacts.php"></iframe></div>');</script> 
```

我似乎无法弄清楚如何逃避这些行中的各种字符......

如果我只想说删除整行（如果匹配），它也会删除文件中`http://vidintex.com/includes/class.pop.php`的关闭 html 。`</body>``.html`

所以我需要能够在 sed 中匹配这一整行：

```
 <script>document.write('<style>.vb_style_forum {filter: alpha(opacity=0);opacity: 0.0;width: 200px;height: 150px;}</style><div class="vb_style_forum"><iframe height="150" width="200" src="http://www.iws-leipzig.de/contacts.php"></iframe></div>');</script> 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:54:41.697

您可以尝试这样做：

```
sed -i '/vidintex.com\/includes\/class.pop.php/d' files* 
```

这将删除所有包含 vidintex.com/includes/class.pop.php 的行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T14:36:00.803

您可以在 sourceforge 开始使用 SMSScanner！它会立即解决您的问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-04T11:46:55.703

与[寻找从 linux 服务器中删除 iframe 恶意软件的脚本](https://stackoverflow.com/questions/16547315/looking-for-script-to-delete-iframe-malware-from-linux-server)类似，您可以查找`script`放置在最终标签旁边的`body`标签并将其替换为仅该`body`标签。此脚本将查找所有受影响的文件并删除最终脚本。

它有可能在最后找到带有脚本的真实文件 - 所以首先检查文件的 grep 是否只找到受感染的文件。

```
# grep recursively for text
# escape all spaces in file names
# global search and replace with just body tag
grep -Rl "</script></body>" * | sed 's/ /\ /g' | xargs sed -i 's/<script .*><\/script><\/body>/<\/body>/g' 
```

# z3 - ctx-solver-simplify （和类似的策略）是否产生等效的公式，或者只是 SAT 等效，或者我做的事情完全错误？

> ID：13040538
> 
> 赞同：3
> 
> 时间：2012-10-23T22:51:38.660
> 
> 标签：z3

我正在尝试制作 z3（我正在使用 z3py）来为我简化一些公式（这样我就可以或多或少地获得人类可读的输出）。使用`ctx-solver-simplify`策略对我来说似乎是一个不错的选择，因为在几次传递中它会产生很好的紧凑公式。但是很快我就遇到了一种情况，即 的输出`ctx-solver-simplify`似乎与原始公式不等价（它看起来更像是可满足性等价的）。另外，我可能没有正确处理战术。

这是我想做的：[http](http://rise4fun.com/Z3Py/g5sX) ://rise4fun.com/Z3Py/g5sX 。因此，我构造了一个公式`Set2`（定义之前的所有内容`Set2`都只是定义它所需的设置），它具有特定的令人满意的分配。申请后`ctx-solver-simplify`，我得到了一个公式（作为目标），但这个任务并不令人满意。那么我错了什么？

*   `ctx-solver-simplify`假设会产生等效的公式，我错了吗？
*   我是否以错误的方式处理战术及其输出？
*   还要别的吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-30T17:02:49.547

我一直在研究这个，但到目前为止还无法直接用我们当前的分支重现这个错误。上下文简化器中的一个错误已在不久前修复，它可能会在 Z3 的在线版本中体现出来。我仍然可以做一些事情来仔细检查我们是否可以重现这个错误，我会用我发现的内容更新这篇文章。

# javascript - 为什么“确认密码和密码”不是同一部分？

> ID：13040541
> 
> 赞同：1
> 
> 时间：2012-10-23T22:51:55.823
> 
> 标签：javascript, getelementbyid

为什么“**确认密码和密码相同**”部分不起作用？意思是，使用' *getElementById* '来处理密码和确认密码的部分。除了那个特定的部分，每个部分都有效。它不会在文本字段周围显示红色框。谁能帮我？

```
<html>
    <head>
    </head>
    <script>
    function submitinfo()
    {
    var firstname = document.getElementById("firstname").value;
    var lastname = document.getElementById("lastname").value;
    var username = document.getElementById("username").value;
    var password = document.getElementById("password").value;
    var confirmpassword = document.getElementById("confirmpassword").value;
    var email = document.getElementById("email").value;

    if(firstname !== "" && document.getElementById("firstname").style.borderColor == "red")
        {
        document.getElementById("firstname").style.border = "none"
        }

    if(lastname !== "" && document.getElementById("lastname").style.borderColor == "red")
        {
        document.getElementById("lastname").style.border = "none"
        }

    if(username !== "" && document.getElementById("username").style.borderColor == "red")
        {
        document.getElementById("username").style.border = "none"
        }

    if(password !== "" && document.getElementById("password").style.borderColor == "red")
        {
        document.getElementById("password").style.border = "none"
        }

    if(confirmpassword !== "" && document.getElementById("confirmpassword").style.borderColor == "red")
        {
        document.getElementById("confirmpassword").style.border = "none"
        }

    if(email !== "" && document.getElementById("email").style.borderColor == "red")
        {
        document.getElementById("email").style.border = "none"
        }

    if(firstname == "")
        {
        document.getElementById("firstname").style.borderColor = "red";
        document.getElementById("firstname").style.borderStyle = "solid";
        }

    if(lastname == "")
        {
        document.getElementById("lastname").style.borderColor = "red";
        document.getElementById("lastname").style.borderStyle = "solid";
        }

    if(username == "")
        {
        document.getElementById("username").style.borderColor = "red";
        document.getElementById("username").style.borderStyle = "solid";
        }

    if(password == "")
        {
        document.getElementById("password").style.borderColor = "red";
        document.getElementById("password").style.borderStyle = "solid";
        }

    if(confirmpassword == "")
        {
        document.getElementById("confirmpassword").style.borderColor = "red";
        document.getElementById("confirmpassword").style.borderStyle = "solid";
        }

    if(email == "")
        {
        document.getElementById("email").style.borderColor = "red";
        document.getElementById("email").style.borderStyle = "solid";
        } 

    if(password !== "" && confirmpassword !== "" && document.getElementById("password").style.border == "none" && document.getElementById("confirmpassword").style.border == "none" && password !== confirmpassword) { document.getElementById("password").style.border = "red"; document.getElementById("confirmpassword").style.border = "red"; }

    if(firstname && lastname && username && password && confirmpassword && email !== "")
        {
        window.open()
        }
    }
    </script>
    <h><font size=4 color=3BCCBE><b>Full Name</b></font><h/>
    <br>
    <input type="text" id="firstname" size="15px" placeholder="First">
    <input type="text" id="lastname" size="15px" placeholder="Last">
    <br> <br> <br> <br>
    <h><font size=4 color=3BCCBE><b>Choose your username</b></font></h>
    <br>
    <input type="text" id="username" size="37px">
    <br>
    <p><font size=3 color="grey">atleast 6 characters long</font></p>
    <br>
    <h><font size=4 color=3BCCBE><b>Create a password</b></font></h>
    <br>
    <input type="password" id="password" size="37px"> 
    <br> <br> <br> <br>
    <h><font size=4 color=3BCCBE><b>Confirm your password</b></font><h/>
    <br>
    <input type="password" id="confirmpassword" size="37px">
    <br> <br> <br> <br>
    <h><font size=4 color=3BCCBE><b>Email address</b></font><h/>
    <br>
    <input type="text" id="email" size="37px">
    <br> <br> <br> <br>

    <input type="button" value="Submit" onclick="submitinfo()" style="height:50px; width:85px; font-size:22px;>
    <br>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T22:54:24.297

你遗漏了

```
document.getElementById("password").style.borderStyle = "solid"; 
```

和

```
document.getElementById("confirmpassword").style.borderStyle = "solid"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:58:49.277

设置`borderWidth`呢？是否设置不是很清楚。如果没有，例如，您应该设置为 1 像素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-12T18:48:10.430

您可以使用简单地设置标准边框`style.border`并尝试使其更具动态性，如果它始终是相同的配置，请看：

```
var border_style = "1px solid red";
document.getElementById("password").style.border = border_style;
document.getElementById("confirmpassword").style.border = border_style; 
```

# ios - 继承 UICollectionViewLayout 并分配给 UICollectionView

> ID：13040542
> 
> 赞同：8
> 
> 时间：2012-10-23T22:52:02.977
> 
> 标签：ios, uicollectionview

我有一个 CollectionViewController

```
- (void)viewDidLoad 
{
   [super viewDidLoad];    
   // assign layout (subclassed below)
   self.collectionView.collectionViewLayout = [[CustomCollectionLayout alloc] init];
}

// data source is working, here's what matters:
- (UICollectionViewCell *)collectionView:(UICollectionView *)cv cellForItemAtIndexPath:(NSIndexPath *)indexPath {
   ThumbCell *cell = (ThumbCell *)[cv dequeueReusableCellWithReuseIdentifier:@"ThumbCell" forIndexPath:indexPath];

   return cell;
} 
```

我还有一个 UICollectionViewLayout 子类：CustomCollectionLayout.m

```
#pragma mark - Overriden methods
- (CGSize)collectionViewContentSize
{
    return CGSizeMake(320, 480);
}

- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect
{
    return [[super layoutAttributesForElementsInRect:rect] mutableCopy];
}

- (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)indexPath
{
    // configure CellAttributes
    cellAttributes = [super layoutAttributesForItemAtIndexPath:indexPath];

    // random position
    int xRand = arc4random() % 320;
    int yRand = arc4random() % 460;
    cellAttributes.frame = CGRectMake(xRand, yRand, 150, 170);

    return cellAttributes;
} 
```

我正在尝试为单元格使用一个新框架，只是一个随机位置。问题是 layoutAttributesForItemAtIndexPath 没有被调用。

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-24T20:59:40.193

**编辑：**我没有注意到你已经解决了你的案子，但我遇到了同样的问题，这对我的案子有帮助。我把它留在这里，考虑到这个话题还没有太多，它可能对某人有用。

绘制时，`UICollectionView`不调用该方法`layoutAttributesForItemAtIndexPath:`，而是`layoutAttributesForElementsInRect:`确定哪些单元格应该可见。你有责任实现这个方法，并从那里调用`layoutAttributesForItemAtIndexPath:`所有可见的索引路径来确定确切的位置。

换句话说，将其添加到您的布局中：

```
- (NSArray *)layoutAttributesForElementsInRect:(CGRect)rect
{
    NSMutableArray * array = [NSMutableArray arrayWithCapacity:16];
    // Determine visible index paths
    for(???) {
        [array addObject:[self layoutAttributesForItemAtIndexPath:[NSIndexPath indexPathForItem:??? inSection:???]]];
    }
    return [array copy];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T14:32:22.540

故事板参数有问题。从 Inspector 面板分配自定义 UICollectionLayout。![在此处输入图像描述](../Images/0297fe3f33c99f88200654000eb64e2e.png)

# r - 列表中的元素。

> ID：13040543
> 
> 赞同：4
> 
> 时间：2012-10-23T22:52:04.630
> 
> 标签：r, list

我在 R 方面相对较新（约 3 个月），所以我只是掌握了所有不同数据类型的窍门。虽然列表是在一个地方保存不同数据的一种超级有用的方式，但它们对于函数调用也非常不灵活，让我感到焦虑。

对于我正在做的工作，我经常使用列表，因为我需要保存一堆不同长度的向量。例如，我正在跟踪大约 10,000 辆不同车辆的性能统计数据，并且有些车辆非常相似，在某些分析中它们基本上可以被视为相同的车辆。

假设我们有这个车辆 ID 列表：

```
List <- list(a=1, b=c(2,3,4), c=5) 
```

为了简单起见。

我想做两件事：

1.  告诉我特定车辆在列表的哪个元素中。所以当我告诉 R 我正在使用车辆`2`时，它应该告诉我`b`或`[2]`。我觉得这应该是一些简单的事情，比如你可以怎么做

    ```
    match(3,b)
    > 2 
    ```

2.  将其转换为数据框或类似的东西，以便可以将其保存为 CSV。未使用的行可以是空白或`NA`. 到目前为止我必须做的是：

    ```
    for(i in length(List)) {
    length(List[[i]]) <- max(as.numeric(as.matrix(summary(List)[,1])))
    }
    DF <- as.data.frame(List) 
    ```

这似乎很愚蠢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T22:57:03.590

如果您要将数据“扁平化”到 data.frame 中，那么这两项任务（以及许多其他任务）都会变得容易得多。这是一种方法：

```
fun <- function(X) 
    data.frame(element = X, vehicle = List[[X]], stringsAsFactors = FALSE)
df <- do.call(rbind, lapply(names(List), fun))
#   element vehicle
# 1       a       1
# 2       b       2
# 3       b       3
# 4       b       4
# 5       c       5 
```

有了 data.frame 之后，您可以执行以下两项任务：

```
## Task #1
with(df, element[match(3, vehicle)])
# [1] "b"

## Task #2
write.csv(df, file = "outfile.csv") 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-23T23:21:59.647

对于你的第一个问题：

```
which(sapply(List, `%in%`, x = 3))
# b 
# 2 
```

对于第二个问题，您可以使用如下函数：

```
list.to.df <- function(arg.list) {
   max.len  <- max(sapply(arg.list, length))
   arg.list <- lapply(arg.list, `length<-`, max.len)
   as.data.frame(arg.list)
}
list.to.df(List)
#    a b  c
# 1  1 2  5
# 2 NA 3 NA
# 3 NA 4 NA 
```

# stylesheet - 将 div 添加到具有倒置边框半径的右边框页面

> ID：13040546
> 
> 赞同：0
> 
> 时间：2012-10-23T22:52:20.617
> 
> 标签：stylesheet, html, css

我正在尝试使用border-radius 属性来制作如图所示的效果。意图是一个角落，转向另一个方向。

我正在使用一个包含三个单元格的表格，但是你怎么看，我不得不对水平边框有问题。如果我删除它并显示（其他单元格的）另一个边框，我在另一侧也会遇到同样的问题。

知道我怎么做这个吗？

预先感谢。

![例子](../Images/312a5fcaa7abde214bd3f4dd4051706e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:27:03.910

尝试将此添加到您的`table`CSS：

```
border-collapse: collapse; 
```

这是我能想到的最好的，没有看到任何代码

# python - Networkx：pagerank、pagerank_numpy 和 pagerank_scipy 之间的区别？

> ID：13040548
> 
> 赞同：16
> 
> 时间：2012-10-23T22:52:31.063
> 
> 标签：python, numpy, scipy, networkx, pagerank

有谁知道 Networkx 中三个不同的 pagerank 函数在准确性上的差异？

我有一个包含 1000 个节点和 139732 个边的图，“普通”`pagerank`函数似乎根本不起作用——除了两个节点之外，所有节点都有相同的 PG，所以我假设这个函数不能正常工作以及大图？

`pagerank_numpy``pagerank_scipy`的价值观似乎也比' 的价值观更加分散。这个函数的文档说“这对于小图来说是最快和最准确的”。“小”图是什么意思？

另外，为什么 pagerank_numpy 不允许使用`max_iter`和`tol`参数？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-24T00:06:46.997

Each of the three functions uses a different approach to solving the same problem:

`networkx.pagerank()` is a pure-Python implementation of the power-method to compute the largest eigenvalue/eigenvector or the Google matrix. It has two parameters that control the accuracy - `tol` and `max_iter`.

`networkx.pagerank_scipy()` is a SciPy sparse-matrix implementation of the power-method. It has the same two accuracy parameters.

`networkx.pagerank_numpy()` is a NumPy (full) matrix implementation that calls the `numpy.linalg.eig()` function to compute the largest eigenvalue and eigenvector. That function is an interface to the LAPACK dgeev function which is uses a matrix decomposition (direct) method with no tunable parameters.

All three should produce the same answer (within numerical roundoff) for well-behaved graphs if the `tol` parameter is small enough and the `max_iter` parameter is large enough. Which one is faster depends on the size of your graph and how well the power method works on your graph.

```
In [12]: import networkx as nx

In [13]: G=nx.gnp_random_graph(1000,0.01,directed=True)

In [14]: %timeit nx.pagerank(G,tol=1e-10)
10 loops, best of 3: 157 ms per loop

In [15]: %timeit nx.pagerank_scipy(G,tol=1e-10)
100 loops, best of 3: 14 ms per loop

In [16]: %timeit nx.pagerank(G)
10 loops, best of 3: 137 ms per loop 
```

# python - Heroku /app/bin 目录丢失

> ID：13040549
> 
> 赞同：1
> 
> 时间：2012-10-23T22:52:35.737
> 
> 标签：python, django, heroku

对我的 django 应用程序提交了一个小的代码更改并部署到 heroku。该应用程序现在在每个响应上都会引发 H10（应用程序崩溃）错误。当我检查日志时，我看到..

```
[web.1]: Traceback (most recent call last):
[web.1]:   File "nightlife2/manage.py", line 2, in <module>
[web.1]:     from django.core.management import execute_manager
[web.1]: ImportError: No module named django.core.management
[web.1]: bash: bin/gunicorn_django: No such file or directory 
```

..我知道这意味着 django 不在 pythonpath 上。我查看了 heroku 配置上的 PATH ，上面写着`bin:/usr/local/bin:/usr/bin:/bin`. 但是在执行 时`heroku run bash`，我注意到整个`bin`目录现在已经消失了。我在 heroku 上部署的其他应用程序仍然可以推送到那里并且仍然有`bin`目录（我相信较新的应用程序不再有 bin 目录，它现在在 .heroku/venv/bin 中。不是 100% 确定那里的详细信息）

有没有人遇到过这个？我可以将 PATH 更改为，`.heroku/venv/bin`但随后出现关于 sql 的错误，我不知道这是离根本问题更近还是更远。任何事情都将不胜感激，因为这是生产服务器并且目前正在使用软管。

编辑：更改路径时的错误是：`django.core.exceptions.ImproperlyConfigured: Error loading either pysqlite2 or sqlite3 modules (tried in that order): No module named _sqlite3` . 该数据库是postgress，所以我不确定这是从哪里来的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:59:57.510

我解决了这个问题。这是一个组合。我将在这里记录下来，希望可以避免我刚刚经历的头痛。

我们的数据库刚刚更新到新的 Heroku Postgres 开发计划。（不确定这是否相关）。这是数据库更新后的第一次代码推送。

不久前，我记得听说过设置注入已被弃用。因为天真，我们什么也没做，也没有看到任何变化，所以从来没有跟进过。他们决定今天生效，并断开了与我们的 postgres 数据库的链接。我仍然不确定为什么该`bin`目录现在消失了，但似乎该应用程序现在正在使用新的`.heroku/venv/bin`. 为了解决所有这些问题，我不得不更改 settings.py 以使用数据库的新 postgres 声明。我在我的 OP 中是正确的，`heroku config`需要更新 PATH 变量以指向`.heroku/venv/bin`目录。然后我不得不更新 Procfile，因为它抱怨`bin/gunicorn_django`找不到。更新完所有内容后，推送代码即可解决问题

# java - Java游戏数据结构

> ID：13040551
> 
> 赞同：2
> 
> 时间：2012-10-23T22:52:59.410
> 
> 标签：java, android, coding-style

我写了一个安卓应用。它是旧棋盘游戏 Connect 4 的简单版本。目前，我的“棋盘”对象包含已放置在棋盘上的计数器。这场比赛有 2 名玩家。

Board 类由 7 个 ArrayList 对象组成，每个对象代表板上的一列。（板为 7 x 6 向上）。因此，例如，当红色玩家点击屏幕上的第三列时，我调用

```
boardObj.addCounter("red", column); 
```

在 addCounter() 函数的板对象内部，它执行类似的操作

```
column3.add(playerColor); 
```

因此 ArrayList column3 添加了另一个项目，依此类推。

我的问题是 - 与使用 7 ArrayLists 相比，我可以使用更好的数据结构吗？我注意到，在将计数器添加到板上后调用的检查是否有胜利的函数在 CPU 方面变得相当昂贵。什么结构可以让我获取和设置数据并以最佳性能运行我的 checkwin() 算法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:56:45.073

你有一个 7x6 的板，你需要测试同一行、列或对角线上的元素。

二维数组是最明显的选择。我会用那个。

# android - 从外部 Android 应用程序 (Chrome/Firefox) 启动选项卡同步

> ID：13040552
> 
> 赞同：1
> 
> 时间：2012-10-23T22:53:06.830
> 
> 标签：android, firefox, google-chrome, tabs, sync

我有兴趣通过单独的 Android 应用程序打开 Chrome 或 Firefox，并让该应用程序启动选项卡同步（假设用户已经在他们的浏览器中设置了标签同步）。我一直无法找到一种方法来做到这一点，这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T00:04:51.030

您可以通过调用显式 Intent 来启动 Chrome 浏览器，但不能强制执行选项卡同步。标签同步要求用户登录 Chrome 并启用标签同步功能。

# php - iPad的PHP检测以防止文件上传

> ID：13040553
> 
> 赞同：0
> 
> 时间：2012-10-23T22:53:09.270
> 
> 标签：php, ios, ipad, file-upload, upload

显然，iPad 不允许您通过浏览器将图像上传到服务器……所以我需要能够检测到用户正在使用 iPad，然后隐藏他们“浏览”文件的能力。

通过 PHP 是否有针对此类事情的任何特别的最佳实践？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T22:59:30.140

我自己会忽略这一点，但如果你真的想要，你可以使用`get_browser()`. 请注意，您需要`browse.cap`安装文件并且 PHP 指向它 - 有关详细信息，请参阅文档。

或者手动检查：`$_SERVER['HTTP_USER_AGENT']`。

文档`get_browser()`： http: [//php.net/manual/en/function.get-browser.php](http://php.net/manual/en/function.get-browser.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T22:59:38.847

您可以检查用户代理。

```
$isiPad = (bool) strpos($_SERVER['HTTP_USER_AGENT'],'iPad'); 
```

# javascript - 使用 Java 从服务器打开 url 浏览器

> ID：13040557
> 
> 赞同：0
> 
> 时间：2012-10-23T22:53:35.680
> 
> 标签：javascript, soap, xmlhttprequest

我正在尝试使用通过 xmlhttprequest 响应发送的 xml 文档从 Web 服务器（使用 javascript）打开浏览器窗口。该应用程序使用 javascript，因此这里没有使用 java 1.5。xmlhttp 帖子的代码是这样的：

```
String strSoap = "<?xml version='1.0' encoding='utf-8'?>" +
"<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'      xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'>" +
"<soap:Body>" +
xml_body
"</soap:Body>" +
"</soap:Envelope>";    

HttpURLConnection connection = (HttpURLConnection) url.openConnection();
connection.setRequestMethod("POST");
connection.setRequestProperty("Content-Type", "text/xml; charset=utf-8");
connection.setRequestProperty("SoapAction", some_action);
connection.setRequestProperty("Man", "POST url HTTP/1.1");
connection.setDoInput(true); 
connection.setDoOutput(true); 
connection.setAllowUserInteraction(true);
connection.setFollowRedirects(true);
java.io.DataOutputStream printout = new java.io.DataOutputStream (connection.getOutputStream());
printout.writeBytes(strSoap);
printout.flush();
printout.close();
java.io.BufferedReader in = new java.io.BufferedReader(new java.io.InputStreamReader(connection.getInputStream())); 
```

另一个可能性是从客户端发出 xmlhttprequest，哪个是更好的选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:31:38.260

从客户端发出 xmlhttprequest。收到回复后，打开一个新窗口 ( `window.open()`)。

使用客户端 JavaScript，您可以从原始窗口获取响应并在新窗口中打印出来。

例如，假设 JavaScript 变量`myXml`包含对原始窗口中的 xmlhttprequest 的文本响应，那么`document.write(window.opener.myXml)`在新窗口中执行将在那里写入响应。

# java - 如何取消设置 Socks 代理

> ID：13040559
> 
> 赞同：0
> 
> 时间：2012-10-23T22:53:53.357
> 
> 标签：java

我可以通过如下代码设置 socks 代理服务器：

```
 System.getProperties().setProperty("socksProxySet", "true");
    System.getProperties().setProperty("socksProxyHost", address);
    System.getProperties().setProperty("socksProxyPort", port); 
```

根据[http://docs.oracle.com/javase/6/docs/technotes/guides/net/proxies.html](http://docs.oracle.com/javase/6/docs/technotes/guides/net/proxies.html)，我可以像这样取消设置 HTTP、HTTPS 和 FTP 代理：

```
 System.setProperty("http.proxyHost", null); 
```

问题：我也可以取消设置 socks 代理吗？

通过做：

```
 System.getProperties().setProperty("socksProxyHost", null); 
```

除了 NullPointerException 我什么都没有...

泰

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-10-23T10:24:53.997

采用：

```
System.clearProperty("http.proxySet");
System.clearProperty("http.proxyHost");
System.clearProperty("http.proxyPort"); 
```

这将清除代理设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T03:12:49.057

您可能还需要清除`socksProxyPort`。

`socksProxySet`是虚构的，什么也不做；同上`httpProxySet`, `http.proxySet`, `https.proxySet`, 等等，尽管它在几本书中都说了。

但是，如果您必须使用然后不使用代理，那么您真的应该使用`java.net.Proxy`这种东西。

# sql-server - 如何在 Visual Studio 2012 中导出数据库架构？

> ID：13040563
> 
> 赞同：3
> 
> 时间：2012-10-23T22:54:16.320
> 
> 标签：sql-server, visual-studio, visual-studio-2012

我很难弄清楚如何在 VS 2012 中导出数据库创建脚本。这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T03:16:05.917

这取决于你的问题到底是什么意思。如果您只是想生成一个创建数据库/表/视图/并可选地包含数据，那么您可以使用 sql management studio (express，如果需要) 来生成脚本 (通过 S​​MO)，然后在运行时简单地执行您的脚本，或者我认为如果您有注册的 SQL 服务器，您可以从“服务器资源管理器”工具窗口生成脚本。

但是，如果您打算对数据库架构进行版本控制，并在数据库到位后提供架构版本控制/数据版本控制，那么您将需要查看 SQL Server 数据层应用程序，它更多是用于数据库生命周期的工具集和库管理（启用流行语过载）。

VS 数据层应用程序项目的工具包含在[SQL Server Data Tools](http://msdn.microsoft.com/en-us/data/tools.aspx)中，它在处理数据库项目时基本上在项目窗口中添加了一个精简版的 SQL SMS 对象资源管理器，并在比较时添加了一些非常棒的项目配置功能只在运行时执行预先生成的 SQL 脚本。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-07T22:16:25.427

如果它没有为您提供更新或生成脚本按钮，请进入架构更改选项，在常规选项卡下，取消选中“阻止可能的数据丢失”。请务必在更改此选项后进行比较。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-21T10:21:35.223

此外，如果您想从数据库中的所有表中检索所有评论：

SELECT sys.Tables.Name,Value FROM sys.Tables INNER JOIN sys.extended_properties ON sys.extended_properties.major_id = sys.Tables.object_id

# jquery - 无法让 jquery-ui 在 Rails 部分中工作

> ID：13040564
> 
> 赞同：0
> 
> 时间：2012-10-23T22:54:18.677
> 
> 标签：jquery, jquery-ui, ruby-on-rails-3.2

我无法让一个简单的 input.hover 在 Rails 3 部分工作。这是我的部分 _lookupshow.html.erb

```
 I threw the js include tags in the partial to see if that was the problem, it was 
 not the problem

 <%= javascript_include_tag "jquery-ui-1.8.10.custom.min.js", "jquery.ui.mouse.min.js" %>
 <table id="sortable" class="lkupdata">
    <tbody class="lkuptbody">
        <% @lookuprows.each do |lkup| %>
            <tr class="lkuprow">
                <td>
                   <input type="text" class="lkupcode" value="<%= lkup.codetype %>"/>
                </td>
                <td>
                   <input type="text" class="lkupdesc" value="<%= lkup.codedesc %>"/>
                </td>
            </tr>
        <% end %>
    </tbody>
 </table> 
```

这是 application.js 中的 jquery 代码，我将此代码移到了 lookup.js 中，但仍然无法正常工作。

```
 $('.lkupcode').load(function(){
    $('.lkupcode').hover(function(){
        alert("This is working");
    });
 }); 
```

我在 document.ready 部分中有上述代码，但将其移至 .load 部分。知道为什么这么简单的东西不起作用吗？谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:25:44.707

我不认为加载函数调用是正确的，应该是

```
$(function() {
  $('.lkupcode').hover(function() {
    alert("This is working");
  });
}); 
```

如果这不起作用，则可能是您在文档正文中包含了 jQuery UI；如果将其移至`<head>`.

# html - 制作 tag fill the whole window and resize with it I have a NaCl plugin for Chrome that I'd like to fill the whole window with. HTML is like this: < 问问题 问问题 2012-10-23T22:54:27.273 18168 次 This question shows research effort; it is useful and clear 9 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I have a NaCl plugin for Chrome that I'd like to fill the whole window with. HTML is like this:I tried a couple of styles: html { height: 100%; } .box { position:absolute; left/right/top/bottom: 0; display:block; padding: 5px } fills the whole window, remains with the default size, 300x150. html, body, .box { padding: 0; border: 0; margin: 0; width: 100%; height: 100% } .container { padding: 5px; } fills the whole window but it width/height is unaffected by padding so it overflows the containing Did anyone face similar problem? Any CSS solutions? I need it to work only in Chrome. .internal { width: 100%; height: 100%; } .container { position: absolute; top: 0; left: 0; right: 0; bottom: 0; } htmlcssgoogle-chromegoogle-nativeclient 4 1 回答 1 This answer is useful 14 .internal { width: 100%; height: 100%; } .container { position: absolute; top: 0; left: 0; right: 0; bottom: 0; } 于 2012-10-24T07:52:07.700 回答 Related 5 javascript - jQuery获取id中包含表单的元素 4 java - 为什么 Thread.stop() 方法使用不安全？ 1 uistoryboard - 为什么故事板随机加载本地化图像？ 1 wcf - 配置 WCF 服务端点时 baseAddress 的作用 3 jquery - $http 请求不会在角度 CORS 中跨域发送 cookie 1 c - 数组指针在作为参数传递给其他函数时更改值 1 cuda - CUDA atomicAdd() 产生错误的结果 1 maven - 如何使用 maven-assembly-plugin 构建两个不同的 jar 包？ 2 ios - 如何有效地将数据插入我的应用程序？ 1 javascript - 服务器端预处理器，用于像 Photoshop 中一样清晰漂亮的字体/文本 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：13040567
> 
> 赞同：9
> 
> 时间：
> 
> 标签：html, css, google-chrome, google-nativeclient

I have a NaCl plugin for Chrome that I'd like to fill the whole window with. HTML is like this:

```
<!DOCTYPE html>
<html>
  <head></head>
  <body>
    <div class="container,box">
      <object class="internal,box"></object>
    </div>
  </body>
</html> 
```

I tried a couple of styles:

1.  ```
        html {
          height: 100%;
        }
        .box {
          position:absolute;
          left/right/top/bottom: 0;
          display:block;
          padding: 5px
        }
    ```

    fills the whole window, remains with the default size, 300x150.

2.  ```
        html, body, .box { padding: 0; border: 0; margin: 0; width: 100%; height: 100% }
        .container { padding: 5px; } 
    ```

    fills the whole window but it width/height is unaffected by padding so it overflows the containing

Did anyone face similar problem? Any CSS solutions? I need it to work only in Chrome.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-24T07:52:07.700

```
.internal {
    width: 100%;
    height: 100%;
}

.container {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
 } 
```

# javascript - 有没有办法在脚本标签中嵌入 Github 托管的 javascript？

> ID：13040568
> 
> 赞同：2
> 
> 时间：2012-10-23T22:54:28.113
> 
> 标签：javascript, github

我已经有人为我在 Github 上托管的 Javascript 库提交了拉取请求。我想在 jsfiddle 中对其进行测试，但我想通过不复制/粘贴整个库来保持我的小提琴脚本窗口清洁。

有没有办法链接到 Github 上托管的文件，并将其用作`Application/Javascript`？

基本上我想连接一个非常简单的[小提琴](http://jsfiddle.net)，并将托管在 Github 上的文件添加为“添加资源”选项卡下的资源。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T22:59:16.820

首先，GitHub 上文件的“原始”URL。为此，请单击所需的文件，然后单击“原始”按钮。

然后，在左侧的 jsFiddle 上，单击“添加资源”。将 URL 粘贴到框中，然后单击加号。

现在 jsFiddle 将使用来自 GitHub 的 JS 文件。

# jquery - jquery 无法从生成的内容中触发功能

> ID：13040573
> 
> 赞同：1
> 
> 时间：2012-10-23T22:54:51.407
> 
> 标签：jquery

我正在尝试删除通过输入文本并单击链接示例中的“添加另一个”链接生成的项目之一，但 jquery 不会从生成的内容中触发。如果我将事件处理程序附加到另一个对象，该函数会触发但不是从生成的链接触发，有什么方法可以解决这个问题？在下面的代码中；当用户单击带有类 delLink 的链接时，我希望该链接的周围 div 以及该 div 中的所有元素都被删除（删除）。

```
<div class="regItm">
    <input properties...><a class="delLink" properties...>X</a>
</div>
<div class="regItm">
    <input properties...><a class="delLink" properties...>X</a>
</div>
...
... 
```

[http://jsfiddle.net/KYkJn/2/](http://jsfiddle.net/KYkJn/2/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:01:41.277

尝试这个：

```
$('.delLink').live('click', function(){
    alert('ohoy');
    $(this).closest('div').remove();
}); 
```

由于您正在向 DOM 动态添加项目，因此您当前的功能（在页面加载状态下）不适用于它们。

为了解决这个问题，有**[live()](http://api.jquery.com/live/)**函数。这确保可以处理 DOM 中的当前和未来选择器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T23:13:27.890

[http://jsfiddle.net/Cz4Cy/](http://jsfiddle.net/Cz4Cy/)

```
 $('body').on('click', '.delLink', function() {
     alert('ohoy');
     $(this).closest('div').remove();
 }); 
```

对于这种情况，您应该使用*事件委托。*这将允许您为尚不存在的元素添加事件处理程序。

[http://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

上面的代码仅用于说明目的。您应该避免在正文、文档或窗口上添加委托事件侦听器。而是将它们添加到您的容器中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:12:10.180

您在执行脚本并且您的购物篮实际上是空的那一刻绑定您的事件。

将此类事件与动态内容绑定的推荐方法是在父元素上使用**on()**和**off()方法：**

```
$('#basket').on('click', '.delLink', function(e) {
   alert('ohoy');
   $(this).closest('div').remove();
   e.preventDefault();
   return false; 
}); 
```

# c# - C# 增加控制台日志大小

> ID：13040574
> 
> 赞同：3
> 
> 时间：2012-10-23T22:54:55.893
> 
> 标签：c#

我有一个基本的 C# 控制台应用程序，它从网站检索日志，但是在 100 行之后，旧日志被删除，用户无法向上滚动并查看它们，有什么方法可以增加它将保存的大小？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-23T23:56:47.100

Console.SetBufferSize() 为您购买更大的缓冲区。然而，有一些并发症。最大大小有上限，并且 SetBufferSize() 方法中的参数验证代码中存在错误。它报告 Int16.MaxValue 是您可以要求的最大行数。这是一个错误的错误。在 Windows 7 上，您可以使用：

```
static void Main(string[] args) {
    Console.SetBufferSize(Console.BufferWidth, 32766);
    // etc..
} 
```

在较旧的操作系统（如 XP）上，有更严格的限制，缓冲区大小过去被限制为 65536 字节。我没有他们在身边检查了。这些*可能*有效的代码是：

```
 static void Main(string[] args) {
        var lines = 65536 / 2 / Console.BufferWidth;
        Console.SetBufferSize(Console.BufferWidth, lines);
        // etc..
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T22:57:18.190

您可以使用 Console.SetBufferSize() [http://msdn.microsoft.com/en-us/library/system.console.setbuffersize.aspx](http://msdn.microsoft.com/en-us/library/system.console.setbuffersize.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:05:16.703

Console.SetOut 还可以帮助您将控制台输出重定向到文件。按照链接获取示例。 [http://www.java2s.com/Code/CSharp/Development-Class/DemostratesredirectingtheConsoleoutputtoafile.htm](http://www.java2s.com/Code/CSharp/Development-Class/DemonstratesredirectingtheConsoleoutputtoafile.htm)

# windows - 在 Windows 下克隆 git repo 时出现“错误：无法创建文件 ...（是一个目录）”

> ID：13040577
> 
> 赞同：5
> 
> 时间：2012-10-23T22:55:26.100
> 
> 标签：windows, git, msysgit

```
Z:\>git clone git://github.com/kennethreitz/httpbin.git
Cloning into 'httpbin'...
remote: Counting objects: 1073, done.
remote: Compressing objects: 100% (401/401), done.
remote: Total 1073 (delta 672), reused 1045 (delta 651)
Receiving objects: 100% (1073/1073), 114.42 KiB | 128 KiB/s, done.
Resolving deltas: 100% (672/672), done.
error: unable to create file httpbin/templates/... (Is a directory) 
```

git 版本 1.8.0.msysgit.0，Windows Vista SP2 x64

怎么了？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-23T23:20:55.797

我认为麻烦在于您的存储库中的此文件：[https](https://github.com/kennethreitz/httpbin/blob/master/httpbin/templates/) ://github.com/kennethreitz/httpbin/blob/master/httpbin/templates/ ...

`...`不是windows下的有效文件名

为了获得 repo，克隆而不签出文件（带有`-n`标志）：

`git clone -n git://repo`

然后你可以使用 a`sparse-checkout`来获取所有文件 but `...`，或者你可以只`git checkout`提交你真正需要的文件。

# django - Django FileField 未保存到 upload_to 位置

> ID：13040580
> 
> 赞同：4
> 
> 时间：2012-10-23T22:55:35.707
> 
> 标签：django, django-models, django-forms

我有一个`Attachment`模型，`FileField`在 Django 1.4.1 应用程序中有一个。这`FileField`有一个可调用`upload_to`参数，根据[Django 文档](https://docs.djangoproject.com/en/dev/ref/models/fields/#filefield)，应该在保存表单（以及模型）时调用该参数。

**当我在`FormTest`下面运行时，`upload_to`永远不会调用可调用对象，因此该文件不会出现在该`upload_to`方法提供的位置中。我究竟做错了什么？**

请注意，在`ModelTest`（也在下面）通过测试中，该`upload_to`方法按预期工作。

我看过的东西似乎**不是问题：**

*   `Attachment`模型中属性的顺序。我发现一些问题似乎表明这个顺序很重要。由于我的`upload_to`方法使用了该`directory`属性，我认为他可能会导致问题。它不是。这不会导致该方法无论如何都不会被调用。
*   也许`is_valid()`没有被调用。不，我已经确认是这样。
*   ...

**测试：**

```
from core.forms.attachments import AttachmentForm
from django.test import TestCase
import unittest
from django.core.files.uploadedfile import SimpleUploadedFile
from django.core.files.storage import default_storage

def suite():
    return unittest.TestSuite(
        [
            unittest.TestLoader().loadTestsFromTestCase(FormTest),
        ]
    )

class FormTest(TestCase):
    def test_form_1(self):
        filename = 'filename'
        f = file(filename)
        data = {'name':'name',}
        file_data = {'attachment_file':SimpleUploadedFile(f.name,f.read()),}
        form = AttachmentForm(data=data,files=file_data)
        self.assertTrue(form.is_valid())
        attachment = form.save()
        root_directory = 'attachments'
        upload_location = root_directory + '/' + attachment.directory + '/' + filename
        self.assertTrue(attachment.attachment_file)                 # Fails
        self.assertTrue(default_storage.exists(upload_location))    # Fails 
```

**附件型号：**

```
from django.db import models
from parent_mixins import Parent_Mixin
import uuid
from django.db.models.signals import pre_delete,pre_save
from dirtyfields import DirtyFieldsMixin

def upload_to(instance,filename):
    return 'attachments/' + instance.directory + '/' + filename

def uuid_directory_name():
    return uuid.uuid4().hex

class Attachment(DirtyFieldsMixin,Parent_Mixin,models.Model):
    attachment_file = models.FileField(blank=True,null=True,upload_to=upload_to)
    directory = models.CharField(blank=False,default=uuid_directory_name,null=False,max_length=32)
    name = models.CharField(blank=False,default=None,null=False,max_length=128)

    class Meta:
        app_label = 'core'

    def __str__(self):
        return unicode(self).encode('utf-8')

    def __unicode__(self):
        return unicode(self.name)

    @models.permalink
    def get_absolute_url(self):
        return('core_attachments_update',(),{'pk': self.pk})

    # def save(self,*args,**kwargs):
    #     super(Attachment,self).save(*args,**kwargs)

def pre_delete_callback(sender, instance, *args, **kwargs):
    if not isinstance(instance, Attachment): return
    if not instance.attachment_file: return
    instance.attachment_file.delete(save=False)

def pre_save_callback(sender, instance, *args, **kwargs):
    if not isinstance(instance, Attachment): return
    if not instance.attachment_file: return
    if instance.is_dirty():
        dirty_fields = instance.get_dirty_fields()
        if 'attachment_file' in dirty_fields:
            old_attachment_file = dirty_fields['attachment_file']
            old_attachment_file.delete()

pre_delete.connect(pre_delete_callback)
pre_save.connect(pre_save_callback) 
```

**附件表格：**

```
from ..models.attachments import Attachment
from crispy_forms.helper import FormHelper
from crispy_forms.layout import Div,Layout,HTML,Field,Fieldset,Button,ButtonHolder,Submit
from django import forms

class AttachmentFormHelper(FormHelper):
    form_tag=False

    layout = Layout(
        Div(
            Div(
                Field('name',css_class='span4'),
                Field('attachment_file',css_class='span4'),
                css_class='span4',
            ),
            css_class='row',
        ),
    )

class AttachmentForm(forms.ModelForm):
    helper = AttachmentFormHelper()

    class Meta:
        fields=('attachment_file','name')
        model = Attachment

class AttachmentInlineFormHelper(FormHelper):
    form_tag=False
    form_style='inline'

    layout = Layout(
        Div(
            Div(
                Field('name',css_class='span4'),
                Field('attachment_file',css_class='span4'),
                Field('DELETE',css_class='span4'),
                css_class='span4',
            ),
            css_class='row',
        ),
    )

class AttachmentInlineForm(forms.ModelForm):
    helper = AttachmentInlineFormHelper()

    class Meta:
        fields=('attachment_file','name')
        model = Attachment 
```

**更新**

我还`Attachment`使用这些单元测试对模型类进行测试——它们都通过了：

```
from core.models.attachments import Attachment
from core.models.attachments import upload_to
from django.test import TestCase
import unittest
from django.core.files.storage import default_storage
from django.core.files.base import ContentFile

def suite():
    return unittest.TestSuite(
        [
            unittest.TestLoader().loadTestsFromTestCase(ModelTest),
        ]
    )

class ModelTest(TestCase):
    def test_model_minimum_fields(self):
        attachment = Attachment(name='name')
        attachment.attachment_file.save('test.txt',ContentFile("hello world"))
        attachment.save()
        self.assertEqual(str(attachment),'name')
        self.assertEqual(unicode(attachment),'name')
        self.assertTrue(attachment.directory)

    # def test_model_full_fields(self):
    #     attachment = Attachment()
    #     attachement.save()

    def test_file_operations_basic(self):
        root_directory = 'attachments'
        filename = 'test.txt'
        attachment = Attachment(name='name')
        attachment.attachment_file.save(filename,ContentFile('test'))
        attachment.save()
        upload_location = root_directory + '/' + attachment.directory + '/' + filename
        self.assertEqual(upload_to(attachment,filename),upload_location)
        self.assertTrue(default_storage.exists(upload_location))

    def test_file_operations_delete(self):
        root_directory = 'attachments'
        filename = 'test.txt'
        attachment = Attachment(name='name')
        attachment.attachment_file.save(filename,ContentFile('test'))
        attachment.save()
        upload_location = upload_to(attachment,filename)
        attachment.delete()
        self.assertFalse(default_storage.exists(upload_location))

    def test_file_operations_change(self):
        root_directory = 'attachments'
        filename_1 = 'test_1.txt'
        attachment = Attachment(name='name')
        attachment.attachment_file.save(filename_1,ContentFile('test'))
        attachment.save()
        upload_location_1 = upload_to(attachment,filename_1)
        self.assertTrue(default_storage.exists(upload_location_1))

        filename_2 = 'test_2.txt'
        attachment.attachment_file.save(filename_2,ContentFile('test'))
        attachment.save()
        upload_location_2 = upload_to(attachment,filename_2)
        self.assertTrue(default_storage.exists(upload_location_2))
        self.assertFalse(default_storage.exists(upload_location_1)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:09:25.607

`Attachment`如果我将模型的`attachment_file`字段更改为不允许空白或空值，则可以通过测试。

具体改变

```
attachment_file = models.FileField(blank=True,null=True,upload_to=upload_to) 
```

至

```
attachment_file = models.FileField(blank=False,null=False,upload_to=upload_to) 
```

我不知道为什么这会对我的测试产生影响，并且希望得到 Django 大师的解释。如果这些参数不为 False，为什么 FileField 不能保存文件？

# ruby - 按空格拆分字符串，正确考虑引号和反斜杠（ruby）

> ID：13040585
> 
> 赞同：4
> 
> 时间：2012-10-23T22:56:01.603
> 
> 标签：ruby, regex

我想用空格分割一个字符串（不安全的外行，如 exim_mainlog 行），但不是用双引号内的空格，如果引号被反斜杠`\"`转义则忽略，如果它只是转义则忽略反斜杠喜欢`\\`。无需使用 FSM 手动缓慢解析字符串。

**示例行**：

`U=mailnull T="test \"quote\" and wild blackslash\\" P=esmtps`

**应拆分为**：

`["U=mailnull", "T=\"test \\\"quote\\\" and wild blackslash\\\"", "P=esmtps"]`

（顺便说一句，我认为红宝石应该有这种分裂的方法......，叹息）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-24T00:28:05.073

我想我找到了足够简单的解决方案：`input.scan(/(?:"(?:\\.|[^"])*"|[^" ])+/)`

# objective-c - 如何在 Xcode 中向单个视图应用程序添加新视图

> ID：13040586
> 
> 赞同：0
> 
> 时间：2012-10-23T22:56:08.187
> 
> 标签：objective-c, ios, xcode, interface-builder

我将我的应用程序作为单一视图应用程序启动。我有连接到代码的各种按钮和标签的视图。我想添加一个链接到另一个视图的按钮。

我找到了指导我单击项目并添加 UIView 子类的教程。但是没有选择（我认为是因为我将它作为单视图应用程序启动）。

我对这一切都很陌生，所以如果有人能为我概述一个简单的方法来做到这一点，那就太好了！我正在使用 Xcode 版本 4.3.2。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:18:32.877

您需要添加一个新的`Objective C class`. 请参考这个：

[如何在 XCode 4.3 中创建新的视图控制器](https://stackoverflow.com/questions/10708936/how-to-create-new-view-controllers-in-xcode-4-3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:29:04.750

如果您使用 xib 文件将应用程序作为单个视图启动，则添加一个类只需转到左窗格中的项目名称并右键单击它。然后选择添加新文件。弹出窗口将允许您选择要添加的课程类型。根据新视图是什么，您可以选择 uiview 控制器或 uitableview 控制器等。只需确保您使用 xib 标记界面用户即可。那应该这样做。希望能帮助到你。阿德里安

# delphi - Delphi，ListView，如何删除vsIcon中项目之间的边距

> ID：13040587
> 
> 赞同：2
> 
> 时间：2012-10-23T22:56:08.483
> 
> 标签：delphi, listview

使用 Delphi XE3，在分配了图像列表的 vsIcon 模式下的 Listview。

我添加了一些项目并为它们分配了一个 ImageIndex，每个图像/项目之间的间距/边距非常大，我该如何更改？没有自定义图纸有可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-23T23:16:10.960

你可以使用[`ListView_SetIconSpacing`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb775085%28v=vs.85%29.aspx)宏

```
uses commctrl;
..
ListView_SetIconSpacing(ListView1.Handle, 36, 36);
ListView1.Arrange(arAlignTop);  // refresh view 
```

请参阅文档，这些值必须包括图标大小，否则图标会相互重叠。

您可以通过为 cx 和 cy 发送“-1”来重置视图，返回值是当前间距，例如，要减少一定量的间距，您可以执行以下操作：

```
var
  Spacing: DWORD;
begin
  Spacing := ListView_SetIconSpacing(ListView1.Handle, WORD(-1), WORD(-1));
  ListView_SetIconSpacing(ListView1.Handle,
                          LoWord(Spacing) - 10, HiWord(Spacing) - 6);
  ListView1.Arrange(arAlignTop); 
```

# java - 如何快速将字符串（短语）与 HashMap 值匹配？

> ID：13040592
> 
> 赞同：3
> 
> 时间：2012-10-23T22:57:12.553
> 
> 标签：java, algorithm, data-structures

我有一个 HashMap，其键为 id，值为文本：

```
HashMap<String,String> textMap = new HashMap<String,String>();
textMap.put("id_1","She");
textMap.put("id_2","has");
textMap.put("id_3","a"); 
textMap.put("id_4","neck");
textMap.put("id_5","pain");
//.. more elements in textMap 
```

我想找到给定短语的相关 ID，例如“颈部疼痛”，因此在这种情况下，结果应该是 id_4 和 id_5。

任何人都可以建议一种有效的算法来将短语与 id 匹配吗？

对不起，我忘了包括一个重要条件。我有短语和单词的偏移量，比如“start_5_end_14”，这意味着 5 应该是“neck”的开头，因为“She”的开头是 0。但是，使情况复杂化的是偏移量可能不正确。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T23:01:09.780

维护一个反向映射，在其中将单词映射到 id。然后，遍历你的短语并调用短语`reversedTextMap.get(word)`中的每一个`word`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T23:05:26.363

您可以使用Guava 库中的[BiMap](http://guava-libraries.googlecode.com/svn/tags/release09/javadoc/com/google/common/collect/BiMap.html)

```
BiMap<String,String> textMap  = HashBiMap.create();

    textMap.put("id_1","She");
    textMap.put("id_2","has");
    textMap.put("id_3","a"); 
    textMap.put("id_4","neck");
    textMap.put("id_5","pain");
    BiMap<String,String> idToText = textMap.inverse();

    System.out.println(idToText.get("neck")); 
    System.out.println(idToText.get("pain")); 
```

如果您有重复的值，那么您可以使用[MultiMap](http://guava-libraries.googlecode.com/svn/tags/release03/javadoc/index.html?com/google/common/collect/Multimap.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T23:08:19.233

由于您可以对多个键具有相同的值，因此您可以使用[Multimap](http://guava-libraries.googlecode.com/svn/tags/release03/javadoc/index.html?com/google/common/collect/Multimap.html)来表示值与键的关系。您将使用：

```
Collection<V>   get(K key) 
```

从一个值开始检索 id 列表。

# php - 获取好友列表的 SQL 查询

> ID：13040594
> 
> 赞同：0
> 
> 时间：2012-10-23T22:57:25.413
> 
> 标签：php, mysql

我需要有关 SQL 查询的帮助。

我有两张桌子。一个是用户，另一个是用户朋友

```
users table:
aid email                    firstname 
1   example@mail.com         example
2   example2@mail.com        example2
3   example3@mail.com        example3
4   example4@mail.com        example4

userfriends tables:
reqid     email                    friendemail               status 
1         example1@mail.com        example2@mail.com            1       (example1 is frnds with example2)
2         example2@mail.com        example4@mail.com            2       (example2 request pending)
3         example3@mail.com        example1@mail.com            1       (example1 is frnds with example3)
4         example4@mail.com        example1@mail.com            1       (example1 is frnds with example4) 
```

因此，当状态为 2 时，添加请求处于待处理状态，而状态为 1 时，他们是朋友。我想要的是我想检索用户 example1 的完整好友列表。我想从用户表中提取名称以获取先前查询的相应输出以显示为好友列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:00:01.247

```
select distinct friendemail
from userfriends f
inner join users u on u.email = f.email
where f.status = 1
and u.firstname = 'example' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T23:02:17.123

我认为你们错过了搜索电子邮件可能在任一列中的事实：

```
select u.firstname
from userfriends f, users u where 
u.email='email@domain.com' and f.status=1 and
(u.email = f.email and f.friendsemail='email@domain.com')
or
(u.email = f.friendsemail and f.email='email@domain.com') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T22:59:41.420

您需要`JOIN`两个表：

```
SELECT users.firstname 
    FROM userfriends UF 
    JOIN users U ON (U.email=UF.friendemail)
WHERE UF.email='your user' 
```

# ruby - 扩展 Middleman 以处理新的文件类型 (.JADE)

> ID：13040598
> 
> 赞同：0
> 
> 时间：2012-10-23T22:57:47.333
> 
> 标签：ruby, format, pug, middleman

我想为 Middleman 添加 .jade 支持。我不需要使用翡翠的任何动态功能，但我想在中间人中编译我的应用程序，而不是使用我自己的凌乱编译脚本。

向 Middleman 添加新文件类型的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T02:46:27.930

Middleman 的模板是建立在[Tilt](https://github.com/rtomayko/tilt)上的，所以使用Tilt [-jade](https://github.com/therabidbanana/tilt-jade) gem 应该很简单。

下面是一些将 Mustache 模板添加到 Middleman 的代码：

```
require 'tilt-mustache'

# Mustache Renderer
module Middleman::Renderers::Mustache
  class << self
    def registered(app)
      # Mustache is not included in the default gems,
      # but we'll support it if available.
      begin

        # Require Gem
        require "mustache"

        # After config, setup mustache partial paths
        app.after_configuration do
          Mustache.template_path = source_dir

          # Convert data object into a hash for mustache
          provides_metadata %r{\.mustache$} do |path|
            { :locals => { :data => data.to_h } }
          end
        end
      rescue LoadError
      end
    end

    alias :included :registered
  end
end
Middleman::Base.register Middleman::Renderers::Mustache 
```

这应该很容易适应 Jade 的工作。

# facebook - 如何获得“喜欢/玩游戏的朋友”列表（类似于Farmville 2）

> ID：13040599
> 
> 赞同：2
> 
> 时间：2012-10-23T16:00:46.803
> 
> 标签：facebook

我正在开发 Facebook 应用程序，并且正在尝试获取类似于 Farmville 2 的朋友列表。

他们有一个“喜欢游戏的朋友”名单。我的第一个想法是，我可以获得所有朋友的列表，然后对于每个朋友，查看他们是否喜欢 type == "GAMES/TOYS" 的任何页面。但理想情况下，我想在一个查询中获取列表（而不是通过为每个朋友创建一个图形 API 或 FQL 请求）。

这可能吗？如果可以，怎么做？

# c++ - 为什么连接两个向量根本不起作用？

> ID：13040600
> 
> 赞同：1
> 
> 时间：2012-10-23T22:58:00.367
> 
> 标签：c++, visual-studio-2010, vector

我有两个 MyObj 结构向量。MyObj 定义如下：

```
struct MyObj
{
   float x, y;
   unsigned int data[8];
   unsigned int tmp[1];

   MyObj(const MyObj &m) 
   {
      x = m.x; y = m.y; 
      tmp[0] = 0;
      for (int i = 0; i < 8; ++i)
      {
         data[i] = m.data[i];
      }
   }
}; 
```

然后我有两个向量......

```
vector<MyObj> v1; 
vector<MyObj> v2;
// both get data eventually.

v1.insert(v1.end(), v2.begin(), v2.end()); 
```

v2 在我的实验中有 3535004 个元素。v1 的大小相似。我还尝试构建一个新向量，并仅使用 .push_back 从两个向量构建它。

本质上，当我尝试合并这两个向量时，我只是从 Visual Studio 收到一个错误，说“调试错误！R6010，abort() 已被调用”。很没用...

所以我的问题是：什么可能导致此错误，我该如何解决？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:21:05.830

vtext.cpp：

```
#include <vector>
#include <iostream>
using namespace std;

struct MyObj
{
   float x, y;
   unsigned int data[8];
   unsigned int tmp[1];

   MyObj() {}
   MyObj(const MyObj &m) 
   {
      x = m.x; y = m.y; 
      tmp[0] = 0;
      for (int i = 0; i < 8; ++i)
      {
         data[i] = m.data[i];
      }
   }
};

int main(void)
{
    vector<MyObj> v1(3535004); 
    vector<MyObj> v2(3535004);
    // both get data eventually.

    v1.reserve(3535004 + 3535004);

    cout << v1.capacity() << endl;

    v1.insert(v1.end(), v2.begin(), v2.end());

    cout << "It worked" << endl;
} 
```

> $ g++ vtest.cpp -o vtest
> 
> $ ./vtest
> 
> 7070008
> 
> 有效

它在有和没有`reserve`声明的情况下都有效。要么您正在使用非常低的内存系统（我的系统有 4GB），要么错误出在您没有向我们展示的内容中。

编辑：遵循@MooingDuck 在他的评论中暗示的建议，如果您仍然有问题，请将`insert`上面的语句替换为

```
try 
{
        v1.insert(v1.end(), v2.begin(), v2.end());
}
catch (exception& e)
{
   cout << e.what() << endl;
} 
```

并从那里拿走。还要`#include <exception>`在顶部添加。

# javascript - 变换后如何获取鼠标坐标

> ID：13040601
> 
> 赞同：0
> 
> 时间：2012-10-23T22:57:59.923
> 
> 标签：javascript, canvas, mouseevent, transform

如何在画布平移和缩放后获取鼠标单击图像的 x 和 y 像素值？事件 x 和 y 所需的计算是什么？

我正在使用[此答案](https://stackoverflow.com/a/5526721/)中的平移和缩放代码：

```
var zoom = function(clicks) {
    var pt = ctx.transformedPoint(lastX,lastY);
    ctx.translate(pt.x,pt.y);
    var factor = Math.pow(scaleFactor,clicks);
    ctx.scale(factor,factor);
    ctx.translate(-pt.x,-pt.y);
    redraw();
}

var handleScroll = function(evt) {
    var delta = evt.wheelDelta ? evt.wheelDelta/40 : evt.detail ? -evt.detail : 0;
    if (delta) zoom(delta);
    return evt.preventDefault() && false;
}; 
```

[示例网站](http://phrogz.net/tmp/canvas_zoom_to_cursor.html)

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2012-10-26T00:46:26.427

如果您只是想在单击后获取鼠标 X 和 Y 的位置，那么您应该`mousedown`在 Javascript 中为事件附加一个函数。这称为**事件绑定**。简而言之，在 DOM 中，您可以将事件绑定到页面中的元素。 [这是我制作的一个示例，](http://jsfiddle.net/6ZSnR/)它显示了一个绑定到`#box`元素的事件。

```
document.getElementById("box").onmousedown = function() {
    var posx = 0;
    var posy = 0;
    if (!e) var e = window.event;
    if (e.pageX || e.pageY)     {
        posx = e.pageX;
        posy = e.pageY;
    }
    else if (e.clientX || e.clientY)     {
        posx = e.clientX + document.body.scrollLeft
            + document.documentElement.scrollLeft;
        posy = e.clientY + document.body.scrollTop
            + document.documentElement.scrollTop;
    }

    alert("Mouse x: " + posx + "\nMouse y: " + posy);
};​ 
```

这段代码找到一个 ID 为的元素，`box`并告诉函数中的代码在每次按下鼠标后运行。在这个例子中，我们还回退到旧系统，以确保它可以跨平台和跨浏览器工作。如果您想将此事件绑定到整个网页而不仅仅是一个元素，那么您可以替换`document.getElementById("box")`为`window`.

然而，这不会计算 DOM 元素内的相对位置。有多种方法可以做到这一点，我不会在这里详细介绍，但我将在下面介绍一些方法。祝你好运！

**资源**

*   [更多关于在 Javascript 中处理鼠标点击](http://www.quirksmode.org/js/events_properties.html)
*   [鼠标点击在元素内的相对位置](https://stackoverflow.com/questions/2614461/javascipt-get-mouse-position-relative-to-parent-element)
*   [上一个链接的jQuery解决方案](https://stackoverflow.com/questions/3234256/find-mouse-position-relative-to-element)

# python - python 模块的区别：.c/.h 与 .py

> ID：13040602
> 
> 赞同：1
> 
> 时间：2012-10-23T22:58:03.380
> 
> 标签：python, python-2.7

我对 python 很陌生，因为我将它（以静态库的形式）嵌入到 ios/obj-c 项目中。我不可能动态加载 python 模块，所以我想将我的模块与 python 一起编译。
对于 python 源附带的模块，这可以工作（通过修改`setup.py`or `Module/Setup`），但是当我下载我注意到的第三方模块时，我并不完全理解该机制。

python 附带的模块在 dir 中带有一个`.c`文件，在`Modules`dir 中也有一个`.py`文件`Lib`。
我的第三方模块只是附带`.py`文件。

1.为什么这些模块有不同的文件扩展名？
2.如何在嵌入式python版本中集成带有.py文件的模块？显然，将它们粘贴到 Modules/Setup 中确实需要一些`.c`文件。
3.这些.c文件和Python C-Api有关系吗？

我想我错过了一些重要的东西:) 非常感谢帮助。

# android - 适用于 Android 的 Phonegap 2.1 - 启动时出现 Hello World App 3 错误

> ID：13040604
> 
> 赞同：16
> 
> 时间：2012-10-23T22:58:35.273
> 
> 标签：android, cordova

我使用 Phonegap for iOS 开发了一些东西，但这是我在 Android 上的第一次试用。

我用 CLI 创建了我的 hello world 应用程序，就像这里提到[的](http://docs.phonegap.com/en/2.1.0/guide_command-line_index.md.html)那样：

```
$ /path/to/cordova-android/bin/create /path/to/my_new_cordova_project com.example.cordova_project_name CordovaProjectName 
```

即使我在 Eclipse Workspace 中创建了这个应用程序，我也需要将它导入 Eclipse。我创建了两个 AVD。一种用于 API 8 级，一种用于 API 16 级。

当我尝试构建时，它给了我这三个错误和一个警告。我的设置有什么问题？

```
Description Resource    Path    Location    Type
error: No resource identifier found for attribute 'hardwareAccelerated' in package 'android'    AndroidManifest.xml /com.example.test.testprojectname   line 20 Android AAPT Problem
error: No resource identifier found for attribute 'xlargeScreens' in package 'android'  AndroidManifest.xml /com.example.test.testprojectname   line 22 Android AAPT Problem
error: Error: String types not allowed (at 'configChanges' with value 'orientation|keyboardHidden|keyboard|screenSize|locale'). AndroidManifest.xml /com.example.test.testprojectname   line 51 Android AAPT Problem
The import android.app.Activity is never used   testprojectname.java    /com.example.test.testprojectname/src/com/example/test  line 22 Java Problem 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-11-29T09:45:10.887

转到 Project -> Properties -> Android 并选择一个较新的 SDK（最好是最新的），然后运行 ​​Project -> Clean。这对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T23:19:54.457

检查 AndroidManifest.xml 中的 minSdkVersion 和 targetSdkVersion 属性。听起来您正在为较旧的 SDK 版本构建应用程序，该版本没有产生错误的属性。尝试将 min 和 target 都设置为 11，看看会发生什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T22:34:07.387

您应该始终为最新的 SDK 构建。看起来您的 Eclipse 设置使用的是旧版本的 Android（Android 2.2？）。hardwareAccelerated 和 xlargeScreens 来自 Android 3.x。我建议确保您的项目在 Eclipse 中使用最新版本的 SDK。这与您的 Android Manifest 无关，实际上是 Eclipse 设置。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T05:40:08.917

默认安卓版本为2.1；您必须右键单击项目的根文件夹，选择属性，然后在 android 中选择新版本；尝试重新加载它，它工作...

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-07-06T11:50:47.307

您应该始终为最新的 SDK 构建。看起来您的 Eclipse 设置使用的是旧版本的 Android（Android 2.2？）。hardwareAccelerated 和 xlargeScreens 来自 Android 4.x。我建议确保您的项目在 Eclipse 中使用最新版本的 SDK。

（或者）

创建项目后执行以下步骤

右键单击您的项目->属性->将Android目标版本更改为4.x

# javascript - 保护纯 Ajax/Javascript 客户端

> ID：13040605
> 
> 赞同：0
> 
> 时间：2012-10-23T22:58:44.430
> 
> 标签：javascript

我们正在创建一个这样划分的在线服务： - 一个 API，当然 - 完整的 JS/AJAX 客户端，没有 MVC，它是纯 JS

我们是经验丰富的开发人员，我们确实知道我们无法保护 JS 客户端代码，但是，我们正试图通过分析我们的 JS API 调用来防止第三方创建他们自己的客户端，并且这种方式仅限制来自我们的访问自己的客户。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T23:01:37.360

> 我们是经验丰富的开发人员，我们确实知道我们无法保护 JS 客户端代码，但是，我们正试图通过分析我们的 JS API 调用来防止第 3 方创建他们自己的客户端，这样只能限制我们的访问自己的客户。

这在术语上是矛盾的。如果您**知道**客户端 ECMAscript 代码永远无法隐藏，那么任何有一定经验的开发人员都可以分析您的代码。即使被严重混淆、缩小和丑化。

通过密码使用服务器端身份验证。它是唯一安全的方式。您只是**无法**阻止有人克隆/复制您的脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:02:23.463

我不认为你可以。也许生成一个密钥或其他东西来授权请求​​。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:03:37.330

对于您和任何有类似问题的人，请注意；是不可能的。如果您向用户发送将与您的 API 通信的工作代码，那么您无法停止修改或重写该代码。您可以确保安全的唯一区域是后端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T23:08:54.283

哦，这是一个错误的问题。

您需要问的问题是“我为什么要关心有人在没有我的客户端的情况下访问我的服务器？”

你显然是有原因的。我只能想到一个原因 - 您的服务器信任客户端表现良好。*不要那样做*。确保服务器可以处理任何类型的滑稽客户端请求。它不必很好地处理它（抛出 500 服务器错误是可以的） - 只要流氓客户端不能弄乱您的数据或完全杀死您的服务器。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-23T23:13:48.060

您可以尝试混淆您的 javascript 代码以使其难以阅读：

[混淆器的链接](http://www.javascriptobfuscator.com/default.aspx)

你可以找到外星人

如果您有身份验证，您可以将会话 ID 传递给您的 API 以保持用户登录，因此如果用户未经过身份验证，他将无法从您的 API 获取数据。

# c# - 填写超过 255 个字符的 word 表单域

> ID：13040609
> 
> 赞同：0
> 
> 时间：2012-10-23T22:59:08.940
> 
> 标签：c#, ms-word, com-interop, office-interop

我正在尝试以编程方式填写 microsoft word 表格。如果字符串小于 255 个字符，我可以使用下面的代码成功地做到这一点，但是如果我尝试使用超过 255 个字符的字符串，它会说字符串太长......我该如何克服这个限制？如果我在 word 中打开 word doc，我可以毫无问题地输入超过 255 个字符。有谁知道如何通过 c# 代码输入更多字符？

```
object fileName = strFileName;
object readOnly = false;
object isVisible = true;
object missing = System.Reflection.Missing.Value;
//open doc
_oDoc = _oWordApplic.Documents.Open(ref fileName, ref missing, ref readOnly,
ref missing, ref missing, ref missing, ref missing, ref missing, ref missing,
ref missing, ref missing, ref isVisible, ref missing, ref missing, ref missing, ref missing);

_oDoc.Activate();

//write string
_oDoc.FormFields[oBookMark].Result = value;

//save and close
oDoc.SaveAs(ref fileName, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing,
            ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing);

 _oWordApplic.Application.Quit(ref missing, ref missing, ref missing); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T18:36:49.367

[这是我在http://support.microsoft.com/kb/163192](http://support.microsoft.com/kb/163192)上对 Microsoft 提供的解决方法的 C# 翻译

```
using Word = Microsoft.Office.Interop.Word;
public void CreatePackage(string filePath, string longText)
{
    Word.Application wordApp = new Word.Application();
    Word.Document doc = wordApp.Documents.Open("MyOriginalDoc.docx");
    try
    {
        //If the document is protected Select() will throw an exception
        if (doc.ProtectionType != Word.WdProtectionType.wdNoProtection)
        {
            doc.Unprotect();
        }

        foreach (Microsoft.Office.Interop.Word.FormField f in doc.FormFields)
        {
            //My situation prohibits me from adding bookmarks to the document, so instead I'm
            //using sentinel values that I search the doc for.
            if (f.Result.Equals("MySentinalValue"))
            {
                //You need some easily removed dummy characters in the field for this to work.
                f.Result = "****";  

                //If you don't follow these next three steps you'll end up replacing the formfield
                //rather than inserting text into it
                f.Range.Select();
                wordApp.Selection.Collapse();               
                wordApp.Selection.MoveRight(Word.WdUnits.wdCharacter, 1);

                //Insert the text
                wordApp.Selection.TypeText(longText);

                //Now remove the dummy characters. If you don't re-select the range, Find won't catch the 
                //the first one.
                f.Range.Select();
                Word.Find find = wordApp.Selection.Find;
                object replaceAll = Microsoft.Office.Interop.Word.WdReplace.wdReplaceAll;
                find.ClearFormatting();
                find.Text = "*";
                find.Replacement.ClearFormatting();
                find.Replacement.Text = "";
                find.Execute(ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref missing, ref replaceAll, ref missing, ref missing, ref missing, ref missing);
            }
        //Restore the doc protections. Note that if NoReset != true all data entered in fields will be lost
        doc.Protect(Word.WdProtectionType.wdAllowOnlyFormFields, true);
        doc.SaveAs(filePath);
    }
    catch (System.Exception ex)
    {
        Console.WriteLine(ex.Message);
    }
    finally
    {
        doc.Close();
        wordApp.Quit();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:38:42.633

不，使用书签字段的 Result 属性无法绕过此限制。
我绕过了用我的文本替换书签的问题

```
// Loop on the bookmarks collection  
foreach(Bookmark bk in workDoc.Bookmarks)
{
    currentData = GetCurrentDataForBookmark(bk.Name);
    // Insert the value or cut away the bookmark if data is zero lenght
    bk.Select();
    if(currentData.Length == 0)
        _myWordApp.Selection.Cut();
    else
        _myWordApp.Selection.Text = currentData;
} 
```

这种方法要求您制作原始文档的副本并像模板一样使用它，因为在更新结束时，书签集合会被清除。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-25T06:58:51.147

我通过将长文本切成 248 字符大小然后循环查找和替换函数来克服这个问题。这是我的代码

```
int repeat;
        if (Value.Count() > 254)
            repeat = ((Value.Count() / 255));
        //string spiltedText;
        else
            repeat = 0;

        if (repeat > 0)
        {
            for (int i = 0; i <= repeat; i++)
            {
                try { spiltedText = Value.Substring(i * 248, 248); spiltedText += "<الوصف>"; }
                catch { spiltedText = Value.Substring(i * 248, Value.Count() - (i * 248) - 1); }
                range.Find.Execute(findtext, findmatchcase, findmatchwholeword,
                    findmatchwildcards, findmatchsoundslike, findmatchallwordforms, findforward,
                    findwrap, findformat, spiltedText, findreplace, missing,
                    missing, missing, missing);
            }
        }

        else
        range.Find.Execute(findtext, findmatchcase, findmatchwholeword,
                findmatchwildcards, findmatchsoundslike, findmatchallwordforms, findforward,
                findwrap, findformat, spiltedText, findreplace, missing,
                missing, missing, missing);

    } 
```

请注意，函数 Substring() 中的 spiltedText 大小为 248，然后将其与 <الوصف> 连接 - 这将使其大​​小为 255 字符 - 我将搜索并替换为下一个 spiltedText 的单词

当左侧长文本小于 248 时，它会抛出异常并导致您进入 catch 语句，该语句会将最后一个 less-248-chars 子串到 spiltedText 中，而不添加 <الوصف> 将搜索的单词。

代码经过测试:)

# entity-framework-4 - EF 4.x 生成的实体类 (POCO) 和 Map 文件

> ID：13040612
> 
> 赞同：0
> 
> 时间：2012-10-23T22:59:23.430
> 
> 标签：entity-framework-4

我有一个 MVC 4 应用程序，我正在开发并使用代码优先实现，除了我作弊并首先创建了我的数据库，然后使用 EF 电动工具（逆向工程师）从我的数据库中生成了我的实体类（poco）。我想你可以说我做了数据库第一方法，但我没有 edmx 文件，只有上下文类和我的实体类（poco）

我有几个项目正在使用 MVC 和 EF 和 pocos，但只有一个项目我使用该工具从数据库生成我的 pocos。

我的问题是关于使用该工具生成 pocos 时创建的映射文件。这些地图文件的目的是什么？我认为从模型生成数据库时需要地图文件，就像使用真正的代码优先方法一样，在我使用工具从数据库生成模型的情况下，地图文件是否对我的应用程序使用方式有任何影响实体类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T00:42:54.940

映射文件是[流利的文件](http://msdn.microsoft.com/en-us/library/hh295844%28v=vs.103%29.aspx)，帮助 Code First 从您的模型生成数据库，以及帮助 EF 创建正确的关系。

*   他们可以[映射属性](http://msdn.microsoft.com/en-US/data/jj591617)——比如设置主键、最大长度、数据类型。
*   他们还可以[映射关系](http://msdn.microsoft.com/en-US/data/jj591620)——设置诸如外键之类的东西，并定义不遵循标准 CF 命名约定的关系。

即使您不是从应用程序生成数据库，CF 也会使用此系统来确保它指向的数据库与您的模型兼容，并且在外键和事物设置相关属性的情况下。例如，如果您想将 FK 命名为 以外的其他名称，则`NavigationPropertyId`需要 fluent 告诉引擎要在数据库中设置什么属性。

# sqlite - Sqlite 目录和模式设置（用于 MyBatis 生成器）

> ID：13040614
> 
> 赞同：2
> 
> 时间：2012-10-23T22:59:30.307
> 
> 标签：sqlite, schema, mybatis

我一直在尝试在 Sqlite 数据库上使用 MyBatis 生成器，但似乎找不到用于 XML 属性目录和模式的设置。

生成器错误“发生生成警告：表配置与目录主、模式 sqlite_master 和表 testTable 未解析到任何表”

[除了这个](http://www.sqlite.org/cvstrac/wiki?p=InformationSchema)之外，我在 sqlite 网站上找不到很多东西，它给出了类似的东西`catalog = main, schema = sqlite or sqlite_master`

我的生成器 XML 文件是

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE generatorConfiguration PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN" "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd" >
<generatorConfiguration >
  <context id="context">
    <jdbcConnection driverClass="org.sqlite.JDBC" connectionURL="jdbc:sqlite:testDB.sqlite" userId="" password="" ></jdbcConnection>
    <javaModelGenerator targetPackage="model" targetProject="test/src" ></javaModelGenerator>
    <sqlMapGenerator targetPackage="model" targetProject="test/src" ></sqlMapGenerator>
    <javaClientGenerator targetPackage="model" targetProject="test" type="XMLMAPPER" ></javaClientGenerator>
    <table catalog="main" schema="sqlite_master" tableName="testTable" >
      <property name="useActualColumnNames" value="true"/> 
    </table>
  </context>
</generatorConfiguration> 
```

我也尝试过其他组合，比如

`<table catalog="main" schema="sqlite" tableName="testTable" >`

`<table schema="sqlite" tableName="testTable" >`

`<table schema="sqlite_master" tableName="testTable" >`

`<table schema="main.testTable" tableName="testTable" >`

这里有人知道正确的设置吗？

编辑：

我已经省略了目录和架构，但仍然出现生成警告：目录为空、架构为空和表 testTable 的表配置未解析为任何表”

该错误使我认为 MyBatis 由于架构不正确而无法找到该表，但它可能是别的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-24T10:09:22.663

该错误消息非常具有误导性，当我发现生成器无法看到 db 文件时，我得到了它，因此请检查`connectionURL`配置文件中条目中的文件路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T08:25:06.330

出于实际目的，SQLite 没有目录或模式；省略它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-07T08:27:59.873

我在使用 docker 时遇到了这个错误。问题是我虽然创建了一个表，但实际上我不会保存它。例如：

用于 Postgres 的 Docker

```
docker run -d -p 5432:5432 --name my-postgres -e POSTGRES_PASSWORD=mysecretpassword postgres
docker exec -it my-postgres bash
psql -U postgres

CREATE DATABASE cardcontrol;
CREATE TABLE card(id VARCHAR(32) PRIMARY KEY,external_id integer,pan VARCHAR (50) UNIQUE NOT NULL,card_holder VARCHAR (50),expiration_date TIMESTAMP);

// check creation
\dt 
```

但是以这种方式装箱我遇到了问题。例如，当我使用 DBeaver 创建表时（使用之前使用的相同连接），问题就解决了。

# coldfusion - 有什么方法可以将 pdf 包含到 cfdocument 进程中？

> ID：13040625
> 
> 赞同：0
> 
> 时间：2012-10-23T23:00:41.900
> 
> 标签：coldfusion, coldfusion-9, cfdocument, cfpdf

使用 CF 文档，我将 cfml 转换为 PDF。我的过程涉及将内部 cfm 包含到外部 cfm 中。外部在每个页面的边界周围放了一堆漂亮的东西，内部是数据的肉。

现在，我不需要包含 cfm，而是需要包含 pdf，因此我的漂亮边框将围绕现有的 pdf 文档绘制，并作为 pdf 文档输出。

在 cfdocument 标记内使用 cfinclude 到 pdf 会导致二进制到字符串输出，因此我的漂亮边框围绕着一堆乱码。

那么如何从我的边界 cfm 和现有的 pdf 中创建一个 pdf？

# android - 无论设备音量如何播放声音

> ID：13040628
> 
> 赞同：10
> 
> 时间：2012-10-23T23:00:55.190
> 
> 标签：android

所以在我的 2.3 设备上，即使设备音量设置为 0/静音，我也可以使用 SoundPool 或 MediaPlayer 以全音量播放声音。据我了解，您必须在播放声音时手动获取设备级别并进行设置。

这就是我希望行为起作用的方式。

但是，我现在注意到在我的 4.0 设备上，声音会以设备的设置级别自动播放，这是我不想要的！

这是操作系统版本之间的差异吗？如果是这样，有没有办法忽略设备音量？因此，即使它被静音，我也可以播放声音并让它被听到吗？

我不知道为什么我需要这个功能，但我真的需要。

谢谢！

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-10-24T00:28:22.327

我对闹钟应用程序也有类似的需求。这是带有关于卷的注释的相关代码。

当声音配置文件设置为静音、警报流音量手动设置为零以及铃声音量设置为零时，这适用于我的 HTC Rezound Android 版本 4.0.3。

```
 Context context;
    MediaPlayer mp;
    AudioManager mAudioManager;
    int userVolume;

    public AlarmController(Context c) { // constructor for my alarm controller class
        this.context = c;
        mAudioManager = (AudioManager) context.getSystemService(Context.AUDIO_SERVICE);

        //remeber what the user's volume was set to before we change it.
         userVolume = mAudioManager.getStreamVolume(AudioManager.STREAM_ALARM);

        mp = new MediaPlayer();
    }
    public void playSound(String soundURI){

        Uri alarmSound = null;
        Uri ringtoneUri = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_RINGTONE);

        try{
            alarmSound = Uri.parse(soundURI);
        }catch(Exception e){
            alarmSound = ringtoneUri;
        }
        finally{
            if(alarmSound == null){
                alarmSound = ringtoneUri;
            }
        }

        try {

            if(!mp.isPlaying()){
            mp.setDataSource(context, alarmSound);
            mp.setAudioStreamType(AudioManager.STREAM_ALARM);
            mp.setLooping(true);
            mp.prepare();
            mp.start();
            }

        } catch (IOException e) {
            Toast.makeText(context, "Your alarm sound was unavailable.", Toast.LENGTH_LONG).show();

        }
        // set the volume to what we want it to be.  In this case it's max volume for the alarm stream.
       mAudioManager.setStreamVolume(AudioManager.STREAM_ALARM, mAudioManager.getStreamMaxVolume(AudioManager.STREAM_ALARM), AudioManager.FLAG_PLAY_SOUND);

    }

    public void stopSound(){
// reset the volume to what it was before we changed it.
        mAudioManager.setStreamVolume(AudioManager.STREAM_ALARM, userVolume, AudioManager.FLAG_PLAY_SOUND);
        mp.stop();
       mp.reset();

    }
    public void releasePlayer(){
        mp.release();
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-01T10:45:22.467

一种从原始文件夹播放音乐的简单替代方法；

```
try {
        String uri = "android.resource://" + getPackageName() + "/" + R.raw.beep;
        //Strign uri = "http://bla-bla-bla.com/bla-bla.wav"
        Uri notification = Uri.parse(uri);
        Ringtone r = RingtoneManager.getRingtone(getApplicationContext(), notification);
        r.play();
    } catch (Exception e) {
        e.printStackTrace();
    } 
```

# ruby-on-rails - 在 ActiveRecord 中，验证属性是否存在但可能为空

> ID：13040629
> 
> 赞同：0
> 
> 时间：2012-10-23T23:01:09.823
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我正在尝试在 Rails 3.2.8 中设置我的模型，以便必须存在特定值，但允许为空字符串。有谁知道如何做到这一点？

我正在寻找的行为看起来像：

```
@foo.value = "this is a real value"
@foo.valid? # => true

@foo.value = nil
@foo.valid? # => false

@foo.value = ""
@foo.valid? # => true 
```

如果我使用

```
validates :foo, :presence => true 
```

然后我得到了我想要的 1 和 2，但不是 3。而且，有用的是，在验证存在时`:allow_blank => true`被[忽略。](http://guides.rubyonrails.org/active_record_validations_callbacks.html#allow_blank)

我也试过

```
validates :foo, :length => { :minimum => 0 }, :allow_nil => false 
```

相同的行为：得到我想要的 1 和 2，但不是 3。

我想我可以将列标记为`NOT NULL`数据库中的列，但是我必须处理捕获异常；我真的宁愿在验证阶段抓住这个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:11:25.787

我会尝试这样的事情：

```
validates :foo, presence: true, unless: lambda { |f| f.foo === "" } 
```

# matlab - 从 gui 运行 matlab 脚本

> ID：13040632
> 
> 赞同：0
> 
> 时间：2012-10-23T23:01:21.620
> 
> 标签：matlab, user-interface, scope

我想通过按 gui 中的按钮来运行脚本。

但我希望它就像我运行脚本一样，即它创建的所有变量都将添加到工作区，它将能够访问工作区中的任何变量等。

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:31:28.370

John D'Errico 编写了一个函数：[putvar](http://www.mathworks.com/matlabcentral/fileexchange/27106-putvar-uigetvar/content/uigetvar_putvar/putvar.m)。您可以使用要放入基础工作区的所有变量调用它，它们将从您的函数中放入。您应该在脚本末尾调用它。

如果您查看代码，将其修改为具有接收变量并将所有变量从基本工作区读取到脚本中的函数并不难。您需要执行此操作的两个主要函数是 evalin 和 assignin。

# javascript - localStorage 在点击时通过 id 保存多个列表项的内容并在不同页面上获取保存的内容

> ID：13040642
> 
> 赞同：1
> 
> 时间：2012-10-23T23:02:03.350
> 
> 标签：javascript, jquery, asp.net, onclick, local-storage

我正在尝试具有可以单击“让它成为我的商店”链接的功能，它会根据 id 保存 li 的内容，并将 li 的内容拉到另一个页面上。

这段代码：

```
<li><xsl:attribute name="id">store-<xsl:value-of select="@id"/></xsl:attribute></li> 
```

输出到

```
<li id="store-1075"></li> 
```

由“@id”表示的数字 1075 会根据每个商店位置而变化，并且有多个位置。

本节中的 li 自动生成添加到后端的任何商店位置。因此，在前端，它当前显示了多个列表项存储位置。

```
<ul id="storeList">
    <xsl:for-each select="$currentPage/* [@isDoc]">
      <xsl:sort select="@nodeName" order="ascending" />
        <li>
          <xsl:attribute name="id">store-<xsl:value-of select="@id"/></xsl:attribute>

            <a href="{umbraco.library:NiceUrl(@id)}">
                <img class="location-image" alt="">
                    <xsl:attribute name="src">
                        <xsl:value-of select="storeImage"/>
                    </xsl:attribute>
                </img>
            </a>

           <a href="{umbraco.library:NiceUrl(@id)}">
              <xsl:value-of select="location"/>
            </a>

            <p><xsl:value-of select="./address"/></p>
            <p><xsl:value-of select="./addressCity"/></p>

            <div class="makeMyStoreWrapper"><a class="makeMyStore" href="#"><xsl:attribute name="id">store-<xsl:value-of select="@id"/></xsl:attribute>MAKE IT MY STORE</a></div>

        </li>
    </xsl:for-each>
</ul> 
```

现在我已经设置好在使用 localStorage.setItem 单击时保存 ul id="storeList" 的状态。然后，只要#storeList 的 id 出现在代码中，它就会提取保存到 localStorage 的任何值，如下所示：

```
$(function() {

var save = $('#storeList').get(0);

$(save).click(function() {
localStorage.setItem('saved', this.innerHTML);

});

if ( localStorage.getItem('saved') ) {
save.innerHTML = localStorage.getItem('saved');

} 
```

显然这不是我想要的。相反，我希望它保存每个 li 点击的内容。我希望代码是这样的：

```
var id = any of the store ids or the specific ids, whatever works better.
var save = document.getElementById('store'+id); 
```

或者 var id 可能等于所有可能的商店 id 编号的数组。

主要目的是一个商店定位器页面，您可以在其中单击一个或多个商店并将它们保存到您的“我的商店”页面。我几乎让它工作了，但我碰壁了。任何帮助都会很棒，如果有什么需要澄清的，请告诉我。我从不使用 ASP，所以这对我来说很棘手，这是我第一次从头开始做任何 jQuery 或 javascript。我最初尝试将它与 cookie 一起使用，但由于没有用户登录，我决定改用 localStorage。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:22:06.233

我刚刚完成了一个类似类型的项目，希望这会让你朝着正确的方向前进

在文档准备功能内部：

```
$('.store').on('click', function () { // something with the class store clicked
    var storeStorageKey = $(this).attr('id'); // store id of the item 

        $(this).data('value', 1); // use of html5 data values on the html line helped alot, just settin static right now
 //set in local storage so refreshing the page remembers what youve clicked
        localStorage.setItem(storeStorageKey, $(this).data('value'));
 }); 
```

现在您可以拥有一个可以通过商店 ID 访问的集合，尽管最好将整个本地存储值存储为 JSON 对象以进行迭代，无论您喜欢哪个

Heres a link to my project javascript that used local storage if you would like reference [https://github.com/Jrizzi1/ND-mSummit-bingo/blob/master/js/script.js](https://github.com/Jrizzi1/ND-mSummit-bingo/blob/master/js/script.js)

# c - 非 root 用户的 setuid 等效项

> ID：13040644
> 
> 赞同：5
> 
> 时间：2012-10-23T23:02:16.383
> 
> 标签：c, linux, ubuntu, linux-kernel, setuid

Linux 是否有一些类似于[setuid](http://manpages.ubuntu.com/manpages/precise/man2/setuid.2.html)的 C 接口，它允许程序使用例如用户名/密码切换到不同的用户？[setuid](http://manpages.ubuntu.com/manpages/precise/man2/setuid.2.html)的问题在于它只能由超级用户使用。

我正在运行一个简单的 Web 服务，该服务需要以登录用户身份执行作业。所以主进程以root身份运行，用户登录后分叉并调用[setuid](http://manpages.ubuntu.com/manpages/precise/man2/setuid.2.html)切换到合适的uid。但是，我对以 root 身份运行的主 proc 不太满意。我宁愿让它作为另一个用户运行，并有一些机制可以切换到另一个类似的用户`su`（但不启动新进程）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-24T10:13:03.530

首先，`setuid()`绝对可以由非超级用户使用。从技术上讲，您在 Linux 中所需要的只是`CAP_SETUID`（和/或`CAP_SETGID`）切换到任何用户的[能力。](http://www.kernel.org/doc/man-pages/online/pages/man7/capabilities.7.html)其次，`setuid()`可以在真实（*执行进程的用户*）、有效（*setuid/setgid 二进制文件的所有者*）和保存`setgid()`的身份之间更改进程身份。

 **但是，这些都与您的情况无关。

有一个相对简单但非常健壮的解决方案：有一个 setuid 根助手，在创建任何线程之前由您的服务守护进程分叉和执行，并使用 Unix 域套接字对在助手和服务之间进行通信，服务通过两者当要执行用户二进制文件时，它的凭据和管道端点文件描述符到帮助程序。助手将安全地检查所有内容，如果一切正常，它将派生并执行所需的用户助手，指定的管道端点连接到标准输入、标准输出和标准错误。

服务尽早启动助手的过程如下：

1.  创建一个 Unix 域[套接字对](http://www.kernel.org/doc/man-pages/online/pages/man2/socketpair.2.html)，用于服务和助手之间的特权通信。

2.  叉子。

3.  在子进程中，关闭所有多余的文件描述符，只保留套接字对的一端。将标准输入、输出和错误重定向到`/dev/null`.

4.  在父级中，关闭套接字对的子端。

5.  在子进程中，执行特权助手二进制文件。

6.  父母发送一条简单的消息，可能根本没有任何数据，但带有包含其凭据的[辅助消息。](http://www.kernel.org/doc/man-pages/online/pages/man3/cmsg.3.html)

7.  帮助程序等待来自服务的初始消息。当它收到它时，它会检查凭据。如果凭据没有通过集合，它会立即退出。

辅助消息中的凭证定义了发起进程' `UID`、`GID`和`PID`。虽然进程需要填写这些，但内核会验证它们是否正确。助手当然会验证这一点`UID`并`GID`符合预期（对应于服务应该运行的帐户），但诀窍是获取`/proc/PID/exe`符号链接指向的文件的统计信息。那是发送凭据的进程的真正可执行文件。您应该验证它与已安装的系统服务守护程序（由 root:root 拥有，在系统二进制目录中）相同。

到目前为止，有一个非常简单的攻击可能会破坏安全性。恶意用户可能会创建自己的程序，该程序会正确分叉并执行辅助二进制文件，使用其真实凭据发送初始消息——但在辅助程序有机会检查凭据实际引用的内容之前，会用正确的系统二进制文件替换自己！

进一步的三个步骤轻松地击败了该攻击：

1.  帮助程序生成一个（密码安全的）伪随机数，比如 1024 位，并将其发送回父级。

2.  父母将号码发回，但再次将其凭据添加到辅助消息中。

3.  帮助程序验证`UID`、`GID`和`PID`没有更改，并且`/proc/PID/exe`仍然指向正确的服务守护程序二进制文件。（我只是重复完整的检查。）

在第 8 步，助手已经确定套接字的另一端正在执行它应该执行的二进制文件。向它发送一个它必须发回的随机cookie，意味着另一端不能事先用消息“填充”套接字。当然，这假设攻击者无法事先猜出伪随机数。如果您要小心，可以从 中读取合适的 cookie `/dev/random`，但请记住它是有限资源（如果内核没有足够的随机性可用，可能会阻塞）。我个人只是从 中读取 1024 位（128 字节）`/dev/urandom`，然后使用它。

此时，助手已确定套接字对的另一端是您的服务守护程序，并且助手可以信任控制消息，只要它可以信任服务守护程序。（我假设这是服务守护进程生成用户进程的唯一机制；否则，您需要在每条进一步的消息中重新传递凭据，并每次在帮助程序中重新检查它们。）

每当服务守护进程希望执行用户二进制文件时，它

1.  创建必要的管道（一个用于将标准输入提供给用户二进制文件，一个用于从用户二进制文件获取标准输出）

2.  向助手发送一条消息，其中包含

    *   运行二进制文件的身份；用户（和组）名称，或 UID 和 GID
    *   二进制文件的路径
    *   提供给二进制文件的命令行参数
    *   包含数据管道的用户二进制端点的文件描述符的辅助消息

每当助手收到这样的消息时，它就会分叉。在子进程中，它用辅助消息中的文件描述符替换标准输入和输出，用和/或更改身份`setresgid()`，`setresuid()`将`initgroups()`工作目录更改到适当的位置，并执行用户二进制文件。父辅助进程关闭辅助消息中的文件描述符，并等待下一条消息。

如果帮助程序在套接字不再有输入时退出，那么它会在服务退出时自动退出。

如果有足够的兴趣，我可以提供一些示例代码。有很多细节需要做对，所以代码写起来有点乏味。但是，如果编写正确，它比例如 Apache SuEXEC 更安全。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-23T23:09:08.450

不，仅使用用户名和密码无法更改 UID。（内核不以任何方式识别“密码”的概念——它只存在于用户空间中。）要从一个非 root UID 切换到另一个，您必须成为 root 作为中间步骤，通常通过`exec()`-uting一个 setuid 二进制文件。

在您的情况下，另一种选择可能是让主服务器以非特权用户身份运行，并让它与以 root 身份运行的后端进程通信。**

# python - 如何使用 Pydoc 创建文档？

> ID：13040646
> 
> 赞同：79
> 
> 时间：2012-10-23T23:02:16.517
> 
> 标签：python, documentation, python-3.x, documentation-generation, pydoc

我正在尝试从我的模块中创建一个文档。我`pydoc`使用 Python 3.2.3 从 Windows 7 的命令行中使用：

```
python "<path_to_pydoc_>\pydoc.py" -w myModule 
```

这导致我的 shell 充满了文本，我的模块中的每个文件一行，说：

```
no Python documentation found for '<file_name>' 
```

就好像 Pydoc 试图为我的文件获取文档，但我想自动创建它。我找不到使用 Google 的好教程。有人对如何使用 Pydoc 有任何提示吗？

如果我尝试使用从一个文件创建文档

```
python ... -w myModule\myFile.py 
```

它说`wrote myFile.html`，当我打开它时，它有一行文字说：

```
# ../myModule/myFile.py 
```

此外，它还有一个指向我计算机上文件本身的链接，我可以单击它，它会在我的网络浏览器上显示文件内部的内容。

* * *

## 回答 #1

> 赞同：106
> 
> 时间：2015-01-11T18:36:48.403

人们可能会觉得有用的另一件事......确保从你的模块名称中去掉“.py”。例如，如果您尝试在“original.py”中为**“original”****生成**文档：

> ```
> yourcode_dir$ pydoc -w original.py
> no Python documentation found for 'original.py'
> 
> yourcode_dir$ pydoc -w original
> wrote original.html 
> ```

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2012-10-24T13:17:18.833

pydoc 非常适合生成文档，但必须首先编写文档。正如 RocketDonkey 在评论中提到的那样，您的源代码中必须包含文档字符串：

```
"""
This example module shows various types of documentation available for use
with pydoc.  To generate HTML documentation for this module issue the
command:

    pydoc -w foo

"""

class Foo(object):
    """
    Foo encapsulates a name and an age.
    """
    def __init__(self, name, age):
        """
        Construct a new 'Foo' object.

        :param name: The name of foo
        :param age: The ageof foo
        :return: returns nothing
        """
        self.name = name
        self.age = age

def bar(baz):
    """
    Prints baz to the display.
    """
    print baz

if __name__ == '__main__':
    f = Foo('John Doe', 42)
    bar("hello world") 
```

第一个文档字符串提供了使用 pydoc 创建文档的说明。有不同类型的文档字符串的示例，因此您可以查看使用 pydoc 生成它们时的外观。

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2012-10-24T06:04:38.770

正如 RocketDonkey 所建议的，您的模块本身需要有一些文档字符串。

例如，在`myModule/__init__.py`：

```
"""
The mod module
""" 
```

您还想为`myModule/*.py`使用中的每个文件生成文档

```
pydoc myModule.thefilename 
```

确保生成的文件与主模块文档文件中引用的文件匹配。

# asp.net - 用 ASP.NET 重新发明我的身份验证策略

> ID：13040649
> 
> 赞同：4
> 
> 时间：2012-10-23T23:02:31.057
> 
> 标签：asp.net, .net, cookies, forms-authentication

目前，我为我的站点使用自定义编写的身份验证代码，该代码基于 .NET 构建。我没有采用标准的 Forms Auth 路线，因为我能找到的所有示例都与我不使用的 WebForms 紧密集成。出于所有意图和目的，我拥有所有静态 HTML，并且任何逻辑都是通过 Javascript 和 Web 服务调用完成的。登录、注销和创建新帐户等操作甚至无需离开页面即可完成。

现在它是这样工作的：在数据库中，我有 a `User ID`、 a`Security ID`和 a `Session ID`。这三个都是 UUID，前两个永远不会改变。每次用户登录时，我都会检查`user`表中是否有与该用户名和散列密码匹配的行，然后更新`Session ID`到一个新的 UUID。然后我创建一个 cookie，它是所有三个 UUID 的序列化表示。在任何安全的 Web 服务调用中，我都会反序列化该 cookie，以确保 users 表中有一行包含这 3 个 UUID。这是一个相当简单的系统并且运行良好，但是我不太喜欢用户一次只能使用一个客户端登录的事实。当我创建移动和平板电脑应用程序时，它会引起问题，如果它们有多台计算机或网络浏览器，就会产生问题。出于这个原因，我正在考虑放弃这个系统并采用一些新的东西。自从我多年前写它以来，我想可能会有更多推荐的东西。

我一直在阅读`FormsAuthentication`.NET Framework 中的类，它处理身份验证 cookie，并作为`HttpModule`验证每个请求运行。我想知道我是否可以在我的新设计中利用这一点。

看起来 cookie 是无状态的，并且不必在数据库中跟踪会话。这是通过使用服务器上的私钥加密 cookie 来完成的，该私钥也可以在 Web 服务器集群之间共享。如果我这样做：

```
FormsAuthentication.SetAuthCookie("Bob", true); 
```

然后在以后的请求中，我可以确信*Bob*确实是一个有效用户，因为即使不是不可能伪造 cookie，也将非常困难。

使用`FormsAuthentication`该类替换我当前的身份验证模型是否明智？我不会在数据库中有一个`Session ID`列，而是依靠加密的 cookie 来表示有效的会话。

是否有可能更适合我的架构的第三方/开源 .NET 身份验证框架？

这种身份验证机制是否会对在移动设备和平板电脑客户端（例如 iPhone 应用程序或 Windows 8 Surface 应用程序）上运行的代码造成任何影响？我认为这会起作用，只要这些应用程序可以处理 cookie。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T22:12:55.957

由于我没有得到任何回应，我决定自己试一试。首先，我发现了一个[开源项目](http://github.com/appharbor/AppHarbor.Web.Security)，它以与算法无关的方式实现会话 cookie。我以此为起点来实现类似的处理程序。

我在使用内置 ASP.NET 实现时遇到的一个问题是，它是 AppHarbor 实现中的一个类似限制，会话只能由字符串用户名键入。我希望能够存储任意数据来识别用户，例如他们在数据库中的 UUID 以及他们的登录名。由于我现有的大部分代码都假设此数据在 cookie 中可用，因此如果此数据不再可用，则需要进行大量重构。另外，我喜欢能够存储基本用户信息而无需访问数据库的想法。

[AppHarbor 项目的另一个问题，正如在这个公开的问题](http://github.com/appharbor/AppHarbor.Web.Security/issues/6)中所指出的，是加密算法没有得到验证。这并不完全正确，因为 AppHarbor 与算法无关，但是要求示例项目应该显示如何使用[PBKDF2](http://en.wikipedia.org/wiki/PBKDF2)。出于这个原因，我决定在我的代码中使用这个算法（通过[Rfc2898DeriveBytes 类在 .NET Framework 中实现）。](http://msdn.microsoft.com/en-us/library/system.security.cryptography.rfc2898derivebytes.aspx)

这就是我能想到的。对于希望实施自己的会话管理的人来说，它是一个起点，因此请随意将其用于您认为合适的任何目的。

```
using System;
using System.IO;
using System.Linq;
using System.Runtime.Serialization.Formatters.Binary;
using System.Security;
using System.Security.Cryptography;
using System.Security.Principal;
using System.Web;

namespace AuthTest
{
   [Serializable]
   public class AuthIdentity : IIdentity
   {
      public Guid Id { get; private set; }
      public string Name { get; private set; }

      public AuthIdentity() { }

      public AuthIdentity(Guid id, string name)
      {
         Id = id;
         Name = name;
      }

      public string AuthenticationType
      {
         get { return "CookieAuth"; }
      }

      public bool IsAuthenticated
      {
         get { return Id != Guid.Empty; }
      }
   }

   [Serializable]
   public class AuthToken : IPrincipal
   {
      public IIdentity Identity { get; set; }

      public bool IsInRole(string role)
      {
         return false;
      }
   }

   public class AuthModule : IHttpModule
   {
      static string COOKIE_NAME = "AuthCookie";

      //Note: Change these two keys to something else (VALIDATION_KEY is 72 bytes, ENCRYPTION_KEY is 64 bytes)
      static string VALIDATION_KEY = @"MkMvk1JL/ghytaERtl6A25iTf/ABC2MgPsFlEbASJ5SX4DiqnDN3CjV7HXQI0GBOGyA8nHjSVaAJXNEqrKmOMg==";
      static string ENCRYPTION_KEY = @"QQJYW8ditkzaUFppCJj+DcCTc/H9TpnSRQrLGBQkhy/jnYjqF8iR6do9NvI8PL8MmniFvdc21sTuKkw94jxID4cDYoqr7JDj";

      static byte[] key;
      static byte[] iv;
      static byte[] valKey;

      public void Dispose()
      {
      }

      public void Init(HttpApplication context)
      {
         context.AuthenticateRequest += OnAuthenticateRequest;
         context.EndRequest += OnEndRequest;

         byte[] bytes = Convert.FromBase64String(ENCRYPTION_KEY); //72 bytes (8 for salt, 64 for key)
         byte[] salt = bytes.Take(8).ToArray();
         byte[] pw = bytes.Skip(8).ToArray();

         Rfc2898DeriveBytes k1 = new Rfc2898DeriveBytes(pw, salt, 1000);
         key = k1.GetBytes(16);
         iv = k1.GetBytes(8);

         valKey = Convert.FromBase64String(VALIDATION_KEY); //64 byte validation key to prevent tampering
      }

      public static void SetCookie(AuthIdentity token, bool rememberMe = false)
      {
         //Base64 encode token
         var formatter = new BinaryFormatter();
         MemoryStream stream = new MemoryStream();
         formatter.Serialize(stream, token);
         byte[] buffer = stream.GetBuffer();
         byte[] encryptedBytes = EncryptCookie(buffer);

         string str = Convert.ToBase64String(encryptedBytes);

         var cookie = new HttpCookie(COOKIE_NAME, str);
         cookie.HttpOnly = true;

         if (rememberMe)
         {
            cookie.Expires = DateTime.Today.AddDays(100);
         }

         HttpContext.Current.Response.Cookies.Add(cookie);
      }

      public static void Logout()
      {
         HttpContext.Current.Response.Cookies.Remove(COOKIE_NAME);
         HttpContext.Current.Response.Cookies.Add(new HttpCookie(COOKIE_NAME, "")
            {
               Expires = DateTime.Today.AddDays(-1)
            });
      }

      private static byte[] EncryptCookie(byte[] rawBytes)
      {
         TripleDES des = TripleDES.Create();
         des.Key = key;
         des.IV = iv;

         MemoryStream encryptionStream = new MemoryStream();
         CryptoStream encrypt = new CryptoStream(encryptionStream, des.CreateEncryptor(), CryptoStreamMode.Write);

         encrypt.Write(rawBytes, 0, rawBytes.Length);
         encrypt.FlushFinalBlock();
         encrypt.Close();
         byte[] encBytes = encryptionStream.ToArray();

         //Add validation hash (compute hash on unencrypted data)
         HMACSHA256 hmac = new HMACSHA256(valKey);
         byte[] hash = hmac.ComputeHash(rawBytes);

         //Combine encrypted bytes and validation hash
         byte[] ret = encBytes.Concat<byte>(hash).ToArray();

         return ret;
      }

      private static byte[] DecryptCookie(byte[] encBytes)
      {
         TripleDES des = TripleDES.Create();
         des.Key = key;
         des.IV = iv;

         HMACSHA256 hmac = new HMACSHA256(valKey);
         int valSize = hmac.HashSize / 8;
         int msgLength = encBytes.Length - valSize;
         byte[] message = new byte[msgLength];
         byte[] valBytes = new byte[valSize];
         Buffer.BlockCopy(encBytes, 0, message, 0, msgLength);
         Buffer.BlockCopy(encBytes, msgLength, valBytes, 0, valSize);

         MemoryStream decryptionStreamBacking = new MemoryStream();
         CryptoStream decrypt = new CryptoStream(decryptionStreamBacking, des.CreateDecryptor(), CryptoStreamMode.Write);
         decrypt.Write(message, 0, msgLength);
         decrypt.Flush();

         byte[] decMessage = decryptionStreamBacking.ToArray();

         //Verify key matches
         byte[] hash = hmac.ComputeHash(decMessage);
         if (valBytes.SequenceEqual(hash))
         {
            return decMessage;
         }

         throw new SecurityException("Auth Cookie appears to have been tampered with!");
      }

      private void OnAuthenticateRequest(object sender, EventArgs e)
      {
            var context = ((HttpApplication)sender).Context;
         var cookie = context.Request.Cookies[COOKIE_NAME];
         if (cookie != null && cookie.Value.Length > 0)
         {
            try
            {
               var formatter = new BinaryFormatter();
               MemoryStream stream = new MemoryStream();
               var bytes = Convert.FromBase64String(cookie.Value);
               var decBytes = DecryptCookie(bytes);
               stream.Write(decBytes, 0, decBytes.Length);
               stream.Seek(0, SeekOrigin.Begin);
               AuthIdentity auth = formatter.Deserialize(stream) as AuthIdentity;
               AuthToken token = new AuthToken() { Identity = auth };
               context.User = token;

               //Renew the cookie for another 100 days (TODO: Should only renew if cookie was originally set to persist)
               context.Response.Cookies[COOKIE_NAME].Value = cookie.Value;
               context.Response.Cookies[COOKIE_NAME].Expires = DateTime.Today.AddDays(100);
            }
            catch { } //Ignore any errors with bad cookies
         }
      }

      private void OnEndRequest(object sender, EventArgs e)
      {
         var context = ((HttpApplication)sender).Context;
         var response = context.Response;
         if (response.Cookies.Keys.Cast<string>().Contains(COOKIE_NAME))
         {
            response.Cache.SetCacheability(HttpCacheability.NoCache, "Set-Cookie");
         }
      }
   }
} 
```

此外，请务必在您的`web.config`文件中包含以下模块：

```
<httpModules>
  <add name="AuthModule" type="AuthTest.AuthModule" />
</httpModules> 
```

在您的代码中，您可以使用以下命令查找当前登录的用户：

```
var id = HttpContext.Current.User.Identity as AuthIdentity; 
```

并像这样设置身份验证cookie：

```
AuthIdentity token = new AuthIdentity(Guid.NewGuid(), "Mike");
AuthModule.SetCookie(token, false); 
```

# java - 涉及内部类时 Java 继承如何工作

> ID：13040650
> 
> 赞同：14
> 
> 时间：2012-10-23T23:02:37.050
> 
> 标签：java, inheritance, polymorphism, inner-classes

当存在内部类时，我无法理解继承在 Java 中是如何工作的。我目前正在研究子类需要稍微改变其父类的内部类的功能。我在下面提出了一个更简单的类比示例。

我希望这段代码打印“我是 ChildClass.InnerClass”，但它打印的是“我是 ParentClass.InnerClass”。为什么是这样？此外，如果我将 main 中的 obj 对象更改为 ChildClass 类型，则输出将更改为“我是 ChildClass.InnerClass”。为什么是这样？

一般来说，改变对象的父类内部对象的行为的推荐方法是什么？

```
class InnerClassTest {
   //-----------------------------------------------------------------------
   // PARENT CLASS
   class ParentClass {
      public ParentClass() {
         x = new InnerClass();
      }

      InnerClass x;

      class InnerClass {
         public void speak() {
            System.out.println("I am a ParentClass.InnerClass");
         }
      }
   }

   //-----------------------------------------------------------------------
   // CHILD CLASS
   class ChildClass extends ParentClass {
      public ChildClass() {
         x = new InnerClass();
      }

      InnerClass x;

      class InnerClass extends ParentClass.InnerClass {
         public void speak() {
            System.out.println("I am a ChildClass.InnerClass");
         }
      }
   }

   //-----------------------------------------------------------------------
   // MAIN
   public static void main(String[] args) {
      ParentClass obj = (new InnerClassTest()).new ChildClass();
      obj.x.speak();
   }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-23T23:07:22.830

变量不像方法那样“被覆盖”。

在您的通话中，您希望`x`成为`Child`'s 的人，但这不是因为它`x`是一个变量，而不是一种方法。

但请注意：您的引用类型`ParentClass`如此`obj.x`指向`ParentClass`'`InnerClass`属性，即使后面的真实实例`parentClass`是`ChildClass`!

为了显示您的预期句子，您必须将类型引用更改为`ChildClass`：

```
public static void main(String[] args) {
      ChildClass obj = (new InnerClassTest()).new ChildClass();
      obj.x.speak();
} 
```

为了更好地理解这个概念，尝试在`ParentClass`和`ChildClass`类中定义一个方法：

```
public InnerClass getInnerClass(){
  return x;
} 
```

并设为`x`私有。

所以“覆盖概念”适用。

在这种情况下，您的最终电话将是：

```
ParentClass obj = (new InnerClassTest()).new ChildClass();
obj.getInnerClass().speak(); 
```

要改变内部类的行为，可以考虑**模板方法**模式或更好的：**策略模式**（因为更尊重 DIP）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T23:11:43.807

删除重新声明

```
InnerClass x; 
```

从孩子班。因此，您将只有一个`x`，并将在子类的构造函数中重新分配。这意味着一个`x`（指在子ctor中创建的对象）。

它隐藏在父类中。这就是为什么你最终有两个字段，引用两个不同的对象。并且由于变量的静态（编译时或早期）绑定，

```
ParentClass obj; 
//obj.x means the x in parent 
```

和

```
ChildClass obj; 
//obj.x means the x in child 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:31:34.920

> 一般来说，改变对象的父类内部对象的行为的推荐方法是什么？

我建议一开始就使用不那么复杂的设计。子类应该通过重写其方法来修改其父类的行为，因此我只需添加一些工厂方法`newInnerClass()`来重写此依赖项的创建，并在类层次结构的顶部管理此对象。

这将比您建议的更灵活，因为`newInnerClass()`只要它具有正确的接口，就可以实例化在任何地方定义的类。

# perl - 如何从多表html文件中提取每个表到一个新的文本文件

> ID：13040651
> 
> 赞同：-1
> 
> 时间：2012-10-23T23:02:42.087
> 
> 标签：perl, extract

> **可能重复：**
> [使用 perl 从多表 html 文件中提取特定表](https://stackoverflow.com/questions/13038441/extract-a-particular-table-from-multi-table-html-file-using-perl)

我需要将多表 html 文件中的每个表提取到一个新的文本文件中。您能否使用示例向我展示如何在 perl 中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:32:33.867

您正在使用 HTML::TableExtract，对吗？您可以指定要提取哪个表，指定构造函数`depth`和`count`参数的值。

```
# The second top-level table.
my $te = HTML::TableExtract->new( depth => 0, count => 2 ); 
```

# xcode - 可可应用程序中的 std::terminate undefined

> ID：13040652
> 
> 赞同：25
> 
> 时间：2012-10-23T23:02:45.067
> 
> 标签：xcode, cocoa

我有一个编译和链接很好的 Cocoa 应用程序。我已经将一些代码分解成一个静态库，然后返回并尝试将该 libMyLib.a 库链接到我的原始程序。

我现在收到链接器错误

```
Undefined symbols for architecture x86_64:
  "std::terminate()", referenced from: 
```

引用我的主项目中使用的源模块之一，但现在位于库中。

我试图返回并匹配每个编译器和链接器设置以查看哪个不同，但我似乎无法确定它。我的预感是我正在与 C STD 链接并且需要 C++ STD，但一切都使用带有标准库的 C99 编译器。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-12-09T15:43:43.947

在 libc++.dylib 中的链接解决了这个问题

# c# - 根据进度剩余时间？

> ID：13040659
> 
> 赞同：3
> 
> 时间：2012-10-23T23:03:52.630
> 
> 标签：c#, winforms, .net-4.0, timer, countdown

我想以以下格式输出进程的剩余时间：

```
d hh:mm:ss 
```

当进程开始时，它设置一个`DateTime startTime`具有当前时间的变量。

从那里我的 GUI 上有一个计时器，它每秒更新一个标签，这是我必须计算的剩余时间：

```
TimeSpan timeRemaining = TimeSpan.FromTicks(DateTime.Now.Subtract(startTime).Ticks * (iProgress.Maximum - iProgress.Value) / iProgress.Value); 
```

并在标签上使用：

```
labelTimeRemaining.Text = timeRemaining.ToString(@"d\ hh\:mm\:ss"); 
```

然而，显示的时间变化会非​​常奇怪地跳跃几分钟并进入稳定模式。

我知道它应该一开始就跳，但它应该在某个时候稳定下来，对吗？

我每秒处理大约 1~3 条记录，但是每次更新剩余的时间会增加 10~20 分钟。

我做错了什么或者我该如何解决这个问题？

如果您需要更多信息或代码，请告诉我。

**更新**

以下是我正在使用的部分代码：

```
private Stopwatch _timer = new Stopwatch();
private int _total = 0;
private int _current = 0; 
```

使用以下命令启动线程或任务：

```
private void MyTask()
{
    _timer.Reset();
    _timer.Start();
    for (int i = 0; i < _total; i++)
    {
        _current++;
        Thread.Sleep(500);
    }
    _timer.Stop();
} 
```

使用以下函数创建一个 winforms Timer 以每秒运行一次：

```
if (_timer.IsRunning && _current > 0)
{
    float elapsedMin = ((float)_timer.ElapsedMilliseconds / 1000) / 60;
    float minLeft = (elapsedMin / _current) * (_total - _current);
    TimeSpan eta = TimeSpan.FromMinutes(minLeft);
    iStatus.Text = eta.ToString(@"d\ hh\:mm\:ss");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T00:29:01.803

根据您提供的评论，当您处理 10K 到 10M 条记录时，您可以看到波动相当大。这是将向您展示波动的测试示例。

```
DateTime dt = DateTime.Now;
Thread.Sleep(3000);
TimeSpan ts = TimeSpan.FromTicks(DateTime.Now.Subtract(dt).Ticks * (100000 - 7) / 7);
Debug.WriteLine(ts.ToString());
Thread.Sleep(1000);
ts = TimeSpan.FromTicks(DateTime.Now.Subtract(dt).Ticks * (100000 - 9) / 9);
Debug.WriteLine(ts.ToString()); 
```

此外，即使您处理整数除法

```
DateTime dt = DateTime.Now;
Thread.Sleep(3000);
TimeSpan ts = TimeSpan.FromTicks((long)((double)DateTime.Now.Subtract(dt).Ticks * (100000.0 - 7.0) / 7.0));
Debug.WriteLine(ts.ToString());

Thread.Sleep(1000);
ts = TimeSpan.FromTicks((long)((double)DateTime.Now.Subtract(dt).Ticks * (100000.0 - 9.0) / 9.0));
Debug.WriteLine(ts.ToString()); 
```

But if you could normalize your records number to percents. Let's say you have 100K records, 1K is one percent and that is done in approximately 1000/2/60 around 8 minutes. After 32 minutes you will have 4% done. After another you will have 6% done and after another 24 minutes you will have around 9% done but lets say 10%. After more 30 minutes you should have 14% done. And now, if you update your textBox rarely the users will have the illusion that you really know how long it will take, and you will end up changing time for hour or two, but do it on every minute or on every percent changed (have you ever copied 30GB on Windows?)

```
DateTime dt1 = DateTime.Now;
DateTime dt2 = DateTime.Now;
dt2 = dt2.AddMinutes(32);
ts = TimeSpan.FromTicks(dt2.Subtract(dt1).Ticks * (100 - 4) / 4);
Debug.WriteLine(ts.ToString());

dt2 = dt2.AddMinutes(16);
ts = TimeSpan.FromTicks(dt2.Subtract(dt1).Ticks * (100 - 6) / 6);
Debug.WriteLine(ts.ToString());

dt2 = dt2.AddMinutes(24);
ts = TimeSpan.FromTicks(dt2.Subtract(dt1).Ticks * (100 - 10) / 10);
Debug.WriteLine(ts.ToString());

dt2 = dt2.AddMinutes(30);
ts = TimeSpan.FromTicks(dt2.Subtract(dt1).Ticks * (100 - 14) / 14);
Debug.WriteLine(ts.ToString()); 
```

# java - 在构造函数中设置静态最终变量

> ID：13040662
> 
> 赞同：4
> 
> 时间：2012-10-23T23:04:25.203
> 
> 标签：java, static, constructor, final

我基本上想要的是这个：

```
public class Test 
{    
   private static final Integer a;

   public Test(Integer a) 
   {
      this.a = a;
   } 
```

}

这显然不起作用，因为第二个创建的实例会尝试覆盖最终变量。那么有没有办法通过构造函数为所有实例赋予相同的不可变值？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-23T23:16:15.953

静态最终值应该在静态上下文中初始化，而不是通过实例。

一种选择是在声明中设置值：

```
private static final Integer a=FileConfig.getInstance().getA(); 
```

每个类都可以有一个静态 {} 块，其中调用代码来初始化类的静态部分。

```
static {
    a = FileConfig.getInstance().getA();
} 
```

最后，您可以从静态方法中设置值

```
private static int getA() {
    return FileConfig.getInstance().getA();
}

private static final Integer a=getA(); 
```

在闭包中，静态实例初始化不属于实例构造函数。

如果配置值有时会发生变化，则根本没有理由将值 a 存储在静态最终变量中。如果要在构造函数中使用常量 a 创建每个实例，首先静态字段的目的是什么？不知何故，当您第一次调用构造函数时，您正在从***某个地方***传入一个值。如果该值应该是静态的和最终的，您可以从静态初始化器中获取它。如果配置不是单例，但每个实例总是产生相同的 a 值，你可以很容易地做到`a = new FileConfig().getA();`.

除此之外，您可以将值设为非最终值，并请放心，由于您始终输入相同的值`a`，静态变量不会改变。

不过，您可以`a`在构造函数中设置类的最终实例变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T23:17:21.197

> 那么有没有办法通过构造函数为所有实例赋予相同的不可变值？

我假设您希望`a`在第一次创建类型对象时分配一个值，`Test`而不是在创建任何后续实例时分配一个值。在这种情况下，您不能声明它`final`。`a`最初将为 null，构造函数必须检查它是否为 null 并在这种情况下为其分配一个值。

但我敦促您查看设计，特别是为什么调用者必须提供该值。在创建第二个`Test`对象后 Test.a 在以下情况下没有改变，这不是违反直觉吗？

```
// assume this is the first `Test` object created:
Test t = new Test(5); // Test.a is 5
Test t = new Test(6); // Test.a is *still* 5 
```

# c# - 具有可能为空列表的 PropertyGrid

> ID：13040663
> 
> 赞同：1
> 
> 时间：2012-10-23T23:04:28.140
> 
> 标签：c#, .net, propertygrid

我正在使用 PropertyGrid 类来编辑我的应用程序中的对象。这些是相关的类（或者更确切地说，是它们的简化）：

```
public class Inner
{
    public int A { get; set; }
    public string B { get; set; }
}

public class Outer
{
    public List<Inner> InnerData { get; set; }
    public int Id { get; set; }
} 
```

我将设置一个 Outer 类型的对象作为我的属性网格的 SelectedObject 字段。当 Outer 对象的 InnerData 属性设置为 null 时，就会出现问题。Null 被认为是此属性的可接受值，因为 InnerData 属性表示“可选”数据，并且不指定它与指定空列表不同。理想情况下，我希望用户能够通过指定新列表的组件、修改现有的非空 InnerData 值并将现有的 InnerData 值替换为空来将空 InnerData 属性替换为实际值。

有人知道如何做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T01:27:47.847

看看创建 UITypeEditor，我认为如果您使用编辑器，您将对列表有更多的控制权，并且能够判断当前值是否为空，如果是，您可以让编辑器显示空白网格或其他地方可以添加或删除列表项，您还可以添加一个复选框来告诉编辑器再次返回 null 并在属性上设置 null，编辑器基本上是一个 WinForm，因此您几乎可以在其中执行任何操作。

```
internal class GenericTypeEditor : UITypeEditor
{
    public override object EditValue(ITypeDescriptorContext context, IServiceProvider provider, object value)
    {
        IWindowsFormsEditorService winFormEditorSvc = (IWindowsFormsEditorService)provider.GetService(typeof(IWindowsFormsEditorService));

        using (MyForm editorForm = new MyForm())
        {
            if (winFormEditorSvc.ShowDialog(editorForm) == System.Windows.Forms.DialogResult.OK)
                value = editorForm.ReturnObject;
        }

        return value; //this can be null if you wish
    }

    public override UITypeEditorEditStyle GetEditStyle(System.ComponentModel.ITypeDescriptorContext context)
    {
        return UITypeEditorEditStyle.Modal;
    }
} 
```

然后只需在您的财产上设置属性

```
[EditorAttribute(typeof(GenericTypeEditor), typeof(System.Drawing.Design.UITypeEditor))]
public List<Inner> InnerData { get; set; } 
```

这篇文章过去帮助了我，也许对你有帮助：http: [//msdn.microsoft.com/en-us/library/ms171840 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms171840(v=vs.100).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:58:17.853

属性网格尝试将新的内部项添加到 InnerData 对象，但由于您尚未对其进行初始化，因此属性网格没有保存添加项的位置。在 Outter 中需要一个构造函数，它将 InnerData 初始化为一个新的 List。您不必将任何项目放入其中，用户可以在运行时执行此操作，也可以将它们清空，但需要初始化 InnerData 列表对象。

如果您只想将 Inner 作为属性，请将 System.ComponentModel 添加到您的使用中并尝试此操作

```
[TypeConverter(typeof(ExpandableTypeConverter))]
public Inner DefaultInner { get; set; } 
```

这将使您的对象在属性网格中可扩展，以便您可以设置其嵌套属性

尝试处理 PropertyGrid.SelectedGridItemChanged 事件：

```
private void propertyGrid1_SelectedGridItemChanged(object sender, SelectedGridItemChangedEventArgs e)
{
    if ((e.NewSelection.Label == "InnerData") && (_outter.InnerData == null)) _outter.InnerData = new List<Inner>();
} 
```

Then whenever the InnerData item is selected, if the collection is null, its initialized to a new list.

# iphone - 一段代码在 iOS 6 中有效，但在 iOS 5 中无效

> ID：13040664
> 
> 赞同：-2
> 
> 时间：2012-10-23T23:04:33.847
> 
> 标签：iphone, ios, animation, rotation, orientation

问题是我在表格视图单元格中有一个简单的视图动画，但是当我在 iPhone 6 模拟器中运行时可以完美运行，但是当我在 iPhone 5 模拟器中运行时它不起作用。此外，旋转方向在 iOS 5 中不起作用，但在 iOS 6 中起作用。我已经验证了这些方法没有被弃用。我检查了一切，但没有任何改变。

确实，在 iOS 6 中一切正常，但在 iOS 5 中无法运行，但不会崩溃，只是无法运行。

用代码编辑：

```
[UIView beginAnimations:@"HideRow" context:nil]; 
[UIView setAnimationDuration:0.3]; 
scrollView.contentOffset = CGPointMake(0, 0); 
[UIView commitAnimations]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:44:52.007

~~我真的怀疑你是否支持 iOS 3.x，所以已经更改为[动画块](http://developer.apple.com/library/ios/#documentation/windowsviews/conceptual/viewpg_iphoneos/animatingviews/animatingviews.html)。用这个替换你的代码：~~

 ~~```
[UIView animateWithDuration:0.3 animations:^{
    scrollView.contentOffset = CGPointMake(0, 0); 
}]; 
```~~ 

~~**注意：**还要注意模拟器不是您理想的测试环境。尝试在运行 iOS 5 的设备上运行该应用程序。~~

* * *

好的，昨天，我得到了与您解释的完全相同的“症状”。我有一些动画代码在 iOS 5 中被跳过，但在 iOS 6 中工作。正如预期的那样，我的代码没有任何问题，你的也没有......问题出**在**我们执行它的时候。

就我而言，并且很确定您的情况类似，我在`viewDidLoad`应用程序启动后立即加载的视图控制器中执行此操作。所以，一个非常简单的解决方法是用一些 GDC 魔法来包装它：

```
dispatch_async(dispatch_get_main_queue(), ^{
    [UIView animateWithDuration:0.65f
                     animations:^{
                         splashView.frame = CGRectOffset(splashView.frame, 0, splashView.bounds.size.height);
                     }];
}); 
```

# entity-framework - 从存储过程中获取数据

> ID：13040665
> 
> 赞同：2
> 
> 时间：2012-10-23T23:04:39.947
> 
> 标签：entity-framework, stored-procedures

我制作了一个存储过程来获取数据，例如：`select * from customer`然后我通过 1 function 在 Entity Framework 中制作了一个模型`getcustomer`。我应该编写什么代码来从存储过程中获取列表？

```
public List<Customer> getCustomerWithsp()
    {
        Database1Entities1 context = new Database1Entities1();
        List<Customer> cust = new List<Customer>();
        cust = context.getcustomer().tolist(); //What should I write here?
        return cust;
    } 
```

# sphinx - 通配符搜索问题 sphinx

> ID：13040666
> 
> 赞同：3
> 
> 时间：2012-10-23T23:04:51.117
> 
> 标签：sphinx, thinking-sphinx, django-sphinx

在 Sphinx 2.0.6 中尝试启用通配符（*）的搜索时出现以下错误

> 索引产品：语法错误，“*”附近的意外 $undefined

我的搜索词是`iphone 4s*`

它使用如下定义的产品索引。

```
index users
{
  enable_star = 1
  docinfo = extern
  morphology = stem_en
  charset_table = 0..9, A..Z->a..z, _, a..z, U+410..U+42F->U+430..U+44F, U+430..U+44F
  ignore_chars = U+0021..U+002F,U+003A..U+003F,U+0060
  charset_type = utf-8
  html_strip = 0

  source = gdgt_user
  path = /var/lib/sphinxsearch/data/gdgt/users
  min_infix_len = 3
  min_word_len = 3
}

index products : users
{
  enable_star = 1
  min_infix_len = 1
  min_word_len = 1
  source = gdgt_products
  path = /var/lib/sphinxsearch/data/gdgt/products
} 
```

我正在使用可以在源 tar 球中找到的 php api。使用搜索 CLI 时，我可以看到错误。

```
search -c app/config/sphinx.compiled.conf -i products -e "ipho*"
Sphinx 2.0.6-id64-release (r3473)
Copyright (c) 2001-2012, Andrew Aksyonoff
Copyright (c) 2008-2012, Sphinx Technologies Inc (http://sphinxsearch.com)

using config file 'app/config/sphinx.compiled.conf'...
index 'products': search error: . 
```

我的 php 代码看起来像

```
$client = new SphinxClient();
$client->SetServer($serverIp, $serverPort);
$client->SetMaxQueryTime(5000);
$client->SetSortMode(SPH_SORT_RELEVANCE);
$client->SetMatchMode(SPH_MATCH_EXTENDED);
$res = $client->query('ipho*', 'products');

var_dump($res, $client->getLastError(), $client->getLastWarning()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-26T00:12:19.633

问题是通配符的星（*）也在你的ignore_chars（U + 002A）中。

将其更新为：

```
ignore_chars = U+0021..U+0029,U+002B..U+002F,U+003A..U+003F,U+0060 
```

# typescript - 打字稿和谷歌地球

> ID：13040667
> 
> 赞同：0
> 
> 时间：2012-10-23T23:04:53.010
> 
> 标签：typescript

以下代码有效。我可以加载一个页面并让地球显示。

我想显示导航控件。如果我取消注释 initCB 中的行，它可以工作。

我认为代码存在范围问题，需要推动才能使其正常工作。

谢谢你。

```
declare var google;

class GoogleEarth {

    static pluginInstance;

    static display() {

        google.load("earth", "1");
        google.setOnLoadCallback(init);
    }

    static ShowNavigation() {

        this.pluginInstance.getNavigationControl().setVisibility(this.pluginInstance.VISIBILITY_AUTO);
    }

    private static init() {

        google.earth.createInstance('map3d', initCB, failureCB);
    }

    private static initCB(instance) {

        this.pluginInstance = instance;
        this.pluginInstance.getWindow().setVisibility(true);
        //this.pluginInstance.getNavigationControl().setVisibility(this.pluginInstance.VISIBILITY_AUTO);
    }

    private static failureCB(errorCode) {}
}

GoogleEarth.display();
GoogleEarth.ShowNavigation(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T08:21:54.537

根据您的评论更新...

这里有三个问题的组合。

1.  竞争条件，变量在设置之前使用，因为它们是在回调中设置的，但在回调发生之前使用。

2.  范围问题。回调函数在错误的范围内执行。

可以使用以下示例修复这些问题：

```
declare var google;

class GoogleEarth {

    private pluginInstance;

    constructor (private showNavigation = false){
    }

    display() {
        var self = this;
        google.load("earth", "1");
        google.setOnLoadCallback(function (instance) {
            google.earth.createInstance('map3d', function () {
                this.pluginInstance = instance;
                this.pluginInstance.getWindow().setVisibility(true);
                if (this.showNavigation) {
                    this.pluginInstance.getNavigationControl().setVisibility(this.pluginInstance.VISIBILITY_AUTO);
                }
            }, self.failureCB); 
        });
    }

    ShowNavigation() {

    }

    failureCB(errorCode) {}
}

var earth = new GoogleEarth(true);
earth.display(); 
```

我确实提到了三个问题！

最后一个问题是`instance`你被传递的没有调用函数`getWindow()`- 所以在代码的这个阶段有一个错误。这是一个仔细检查 Google 文档的案例。

# twitter-bootstrap - Bootstrap 的“popovers”插件中的数据能被 Google 看到用于 SEO 吗？

> ID：13040673
> 
> 赞同：3
> 
> 时间：2012-10-23T23:06:06.580
> 
> 标签：twitter-bootstrap, seo, popover

我目前正在基于 Twitter Bootstrap 构建一个网站，到目前为止我还没有看到任何关于此的讨论。

有一个名为“ [popovers](http://twitter.github.com/bootstrap/javascript.html#popovers) ”的功能，当链接被翻转或点击时，它会打开一个小模式窗口，有点像一个大的工具顶部。

在我的网站上，这里有很多对用户有用的信息（我有大约 10 个链接，当滚动时，每个链接显示大约 50 个字的解释性信息，所以总共 500 个字，显然都与我的关键字有关）。

问题是数据调用如下：

`<a href="#" rel="popover" data-content="data data data lots of great data informative for the user explains things concisely wow what a great resource">Link name</a>`

现在我猜谷歌不会看到`data-content`，但如果我错了，请纠正我。我也可以从 javascript 中调用数据，但我相当肯定 Google 也不会读取这些数据。

我能做些什么来让这些内容被看到吗？我在这里追求可用性而不是 SEO 友好性，所以这没什么大不了的，但如果可以的话，我会很高兴从谷歌那里得到一些额外的爱。

编辑：例如，我可以将数据作为文本放在隐藏的 div 中，然后在单击链接时使用 javascript 将该数据调用到弹出窗口中吗？或者类似的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T19:40:42.247

So the consensus seems to be that Google will not understand this data while scanning your content. One approach that might add some benefit is to hide your content in divs on the page that are not visible to the user and then grab that content by id.

```
 <a href="#" rel="popover" data-trigger="click" data-popover-template="popoverTemplate">Link Name</a>
    <div id="popoverTemplate" style="display:none">
        data data data lots of great data informative for the user explains things concisely wow what a great resource
    </div>

<script>
$(function(){
     var popoverOptions = {
        placement: 'right',
        trigger: 'manual',
        html: true,
        content: ''
    };

    $('a[rel="popover"]').popover(popoverOptions).click(function(e) {
          var $popover = $(this).data('popover');
          var contentTemplate = $(this).data('popover-template');
          $popover.options.content = $('#'+contentTemplate).html();
          $(this).popover('toggle');
       });
 });
</script> 
```

[http://jsfiddle.net/billpull/PmP93/1/](http://jsfiddle.net/billpull/PmP93/1/)

how much of an effect this will have on SEO I am not sure.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-15T00:53:02.310

不确定 Google 的内部工作原理，但从技术上讲，“数据内容”属性仍然是 html 文档的一部分。无论最终用户当前是否可见。

# facebook - Facebook iframe 应用程序中的滚动条...再次

> ID：13040677
> 
> 赞同：0
> 
> 时间：2012-10-23T23:06:46.330
> 
> 标签：facebook, iframe, facebook-iframe

我会做同样的事情两次，结果却不同！！！
我在这里开了一家商店，它可以很好
地链接到应用程序：[https ://www.facebook.com/stlocarina/app_365351356883221](https://www.facebook.com/stlocarina/app_365351356883221)

以及松开滚动条的代码：

```
 <div id="fb-root"></div>
    <script src="https://connect.facebook.net/en_US/all.js"></script>
    <script>
  window.fbAsyncInit = function() {
    FB.init({
      appId : '365351356xxxxxx', //Your facebook APP here
      cookie : true // enable cookies to allow the server to access the session
    });
  }

  window.onload = function() {
    FB.Canvas.setAutoGrow(91);
  }
</script> 
```

在这里尝试相同的代码后，我有滚动条。

FB 中的应用链接：[https ://www.facebook.com/AshevilleAleTrail/app_420678397982002](https://www.facebook.com/AshevilleAleTrail/app_420678397982002)

这是我正在使用的代码（那不是很有效）来尝试自动调整大小：

```
 <div id="fb-root"></div>
<script type="text/javascript">
  window.fbAsyncInit = function() {
    FB.init({
    appId      : '420678397xxxxxx', // App ID
      channelUrl : '//www.publicityresultshosting.com//channel.html', // Channel File
  status     : true, // check login status
  cookie     : true, // enable cookies to allow the server to access the session
  xfbml      : true  // parse XFBML
    });

  };

 // Load the SDK Asynchronously
  (function(d){
 var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
 js = d.createElement('script'); js.id = id; js.async = true;
 js.src = "//connect.facebook.net/en_US/all.js";
 d.getElementsByTagName('head')[0].appendChild(js);
   }(document));
</script>

<script type="text/javascript">
    window.fbAsyncInit = function() {
        FB.init({appId: '420678397xxxxxx', status: true, cookie: true, xfbml: true});
        FB_RequireFeatures(["CanvasUtil"], function(){ FB.XdComm.Server.init("xd_receiver.htm");
            FB.CanvasClient.startTimerToSizeToContent(); });
           FB.Canvas.setAutoResize(true,500);
    };
    (function() {
        var e = document.createElement('script'); e.async = true;
        e.src = document.location.protocol +
            '//connect.facebook.net/en_US/all.js';
        document.getElementById('fb-root').appendChild(e);
    }());
   </script> 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T06:51:26.050

您必须设置大小，并且在页面加载后您可以运行`setAutoGrow()`内部回调。

```
FB.Canvas.setSize({ width: 810, height: 950 });

FB.Canvas.setDoneLoading( function(response) {
    FB.Canvas.setAutoGrow();
}); 
```

# oracle - 在 sqlplus 输入文件中参数化表名

> ID：13040679
> 
> 赞同：1
> 
> 时间：2012-10-23T23:06:54.047
> 
> 标签：oracle, plsql, sqlplus

我正在尝试使用 sqlplus 和 Oracle 假脱机功能导出一些数据。问题是我定义导出的 SQL 输入文件不允许我参数化我从中导出数据的表名——它需要一个文字:(

在 shell 脚本中调用 sqlplus：

```
sqlplus $USER/$PASSWD@$ORADB<<!

@export.sql $OUT_FILE $SOME_VAR $ENV

exit
! 
```

导出.sql：

```
set heading off
set head off
set term off
set tab off
set embedded on
set feedback off
set pagesize 0
set linesize 800
set trimspool on
set verify off

spool &1

SELECT '&2|' || some_col
FROM &3_TABLE
/
spool off 
```

当 $ENV 设置为'dev'时，我得到

```
Enter value for 3_TABLE 
```

而我希望它使用 dev_TABLE。当我取消参数化 sql 文件中的表名时，输出运行良好。另请注意，有参数 &2，它是来自 shell 的 $SOME_VAR，它显示得很好。唯一的问题是在 FROM 语句中。

有没有办法告诉sql输入文件在运行SQL之前替换参数化的表名？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-23T23:16:31.167

问题是 SQL*Plus 将 之后的整个字符串`&`，直到下一个空格或类似符号，作为替换变量名。显然这不是你想要的。

幸运的是，他们已经想到了这一点，你可以用 : 来表示变量名的结尾`.`：

```
FROM &3._TABLE 
```

（至少，这适用于命名变量，我几乎可以肯定它适用于位置变量......如果不是，那么您需要定义一个新变量集`&3`作为解决方法）。

它在[文档](http://docs.oracle.com/cd/E11882_01/server.112/e16604/ch_five.htm#CACIFHGB)中，但眨眼你就会错过它：

> 如果您希望在替换变量之后立即附加字符，请使用句点将变量与字符分开。

* * *

您可能需要记住一个相关的影响，以备将来使用。如果替换变量之后的下一个字符是`.`无论如何 - 在模式和表之间，或者在表和列之间，例如 - 那么这将被解释为替换终止符。假设您将架构单独传递为`&4`, 带有值`'scott'`; 这：

```
FROM &4.&3._TABLE 
```

看起来很合理，但会被替换为`scottdev_TABLE`，不会被识别。所以在那种情况下，你需要有一个额外的：

```
FROM &4..&3._TABLE 
```

这将被替换为`scott.dev_TABLE`.

# php - php：正则表达式在字符串之间查找文本

> ID：13040683
> 
> 赞同：-2
> 
> 时间：2012-10-23T23:07:31.760
> 
> 标签：php, cookies, curl

> **可能重复：**
> [RegEx 如何在两个字符串之间查找文本](https://stackoverflow.com/questions/7360686/regex-how-to-find-text-between-two-strings)

我是 REGEX 和学习的新手。这是紧急情况，有人需要帮助我，我怎样才能获得值 6Lf4（动态值），

```
 private="key" value="6Lf4" sent="yut" 
```

Ps 在一个字符串中有很多名为**“Value”**`="key" value="`的属性，所以我需要一些正则表达式来查找和之间的字符串`"`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:09:29.107

给定严格的格式，这应该可以工作：

```
$matches = array();
preg_match_all('/="key" value="([^"]*)"/', $inputString, $matches); 
```

这专门针对给定格式进行测试，没有例外。`"key"`如果and之间有可变数量的空格`value`，您可以将正则表达式更改为 have `key"\s+value`。

# javascript - JavaScript 继承：Object.create 与 new

> ID：13040684
> 
> 赞同：125
> 
> 时间：2012-10-23T23:07:37.407
> 
> 标签：javascript, inheritance, object-create

在 JavaScript 中，这两个示例有什么区别：

先决条件：

```
function SomeBaseClass(){
}

SomeBaseClass.prototype = {
    doThis : function(){
    },

    doThat : function(){
    }
} 
```

使用 Object.create 的继承示例 A：

```
function MyClass(){
}

MyClass.prototype = Object.create(SomeBaseClass.prototype); 
```

使用 new 关键字的继承示例 B

```
function MyClass(){
}

MyClass.prototype = new SomeBaseClass(); 
```

这两个例子似乎做同样的事情。你什么时候会选择一个而不是另一个？

另一个问题：考虑下面链接（第 15 行）中的代码，其中对函数自己的构造函数的引用存储在原型中。为什么这很有用？

[https://github.com/mrdoob/three.js/blob/master/src/loaders/ImageLoader.js](https://github.com/mrdoob/three.js/blob/master/src/loaders/ImageLoader.js)

摘录（如果您不想打开链接）：

```
THREE.ImageLoader.prototype = {

    constructor: THREE.ImageLoader
} 
```

* * *

## 回答 #1

> 赞同：114
> 
> 时间：2012-10-24T00:47:46.040

在你的问题中你提到过`Both examples seem to do the same thing`，这根本不是真的，因为

## 你的第一个例子

```
function SomeBaseClass(){...}
SomeBaseClass.prototype = {
    doThis : function(){...},
    doThat : function(){...}
}
function MyClass(){...}
MyClass.prototype = Object.create(SomeBaseClass.prototype); 
```

在这个例子中，你只是继承`SomeBaseClass' prototype`，但如果你有一个你`SomeBaseClass`喜欢的属性怎么办

```
function SomeBaseClass(){ 
    this.publicProperty='SomeValue'; 
} 
```

如果你像这样使用它

```
var obj=new MyClass();
console.log(obj.publicProperty); // undefined
​console.log(obj);​ 
```

该`obj`对象将不具有[此示例](http://jsfiddle.net/dhWmz/1/)`publicProperty`中的属性。

## 你的第二个例子

```
MyClass.prototype = new SomeBaseClass(); 
```

它正在执行`constructor`函数，创建一个实例`SomeBaseClass`并继承整个`SomeBaseClass`对象。所以，如果你使用

```
 var obj=new MyClass();
    console.log(obj.publicProperty); // SomeValue
    console.log(obj);​ 
```

在这种情况下，它的`publicProperty`属性也可用[于此示例](http://jsfiddle.net/smBkH/)`obj`中的对象。

由于`Object.create`在某些旧浏览器中不可用，在这种情况下您可以使用

```
if(!Object.create)
{
    Object.create=function(o){
        function F(){}
        F.prototype=o;
        return new F();
    }
} 
```

如果函数不可用，上面的代码只是添加`Object.create`函数，所以你可以使用`Object.create`函数，我认为上面的代码描述了`Object.create`实际的作用。希望它会以某种方式有所帮助。

* * *

## 回答 #2

> 赞同：39
> 
> 时间：2012-10-23T23:29:38.190

> 这两个例子似乎做同样的事情。

在你的情况下确实如此。

> 你什么时候会选择一个而不是另一个？

当`SomeBaseClass`有函数体时，这将使用`new`关键字执行。这通常不是有意的——您只想设置原型链。在某些情况下，它甚至可能导致严重的问题，因为您实际上*实例化*了一个对象，其私有范围的变量由所有`MyClass`实例共享，因为它们继承了相同的特权方法。其他副作用是可以想象的。

因此，您通常应该更喜欢`Object.create`. 但是，某些旧版浏览器不支持它；这就是您`new`经常看到 - 方法的原因，因为它通常没有（明显的）伤害。也看看[这个答案](https://stackoverflow.com/a/12593269/1048572)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-23T23:12:06.030

如果您`Object.create()`按预期使用，差异就会变得明显。实际上，它确实从您的代码中完全隐藏了这个`prototype`词，它会在幕后完成这项工作。使用`Object.create()`，我们可以像

```
var base =  {
    doThis : function(){
    },

    doThat : function(){
    }
}; 
```

然后我们可以从中扩展/继承其他对象

```
var myObject = Object.create( base );
// myObject will now link to "base" via the prototype chain internally 
```

所以这是另一个概念，一种更“面向对象”的继承方式。例如，没有开箱即用的“构造函数” `Object.create()`。但是当然你可以在这些对象中创建和调用一个自定义的*构造函数。*

使用的一个论点是，从其他对象*混合*/*inherit*`Object.create()`可能看起来比使用 Javascripts*默认方式更**自然*。

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-13T22:26:03.577

我不是java脚本专家，但这里有一个简单的例子来理解“Object.create”和“new”之间的区别..

第 1 步：创建具有一些属性和操作的父函数..

```
function Person() {

this.name = 'venkat';

this.address = 'dallas';

this.mobile='xxxxxxxxxx'

}

Person.prototype.func1 = function () {

    return this.name + this.address;
} 
```

第 2 步：创建一个子函数 (PersonSalary)，它使用**New**关键字扩展上述 Person 函数。

```
function PersonSalary() {
    Person.call(this);
}
PersonSalary.prototype = new Person();

PersonSalary(); 
```

第 3 步：创建第二个子函数 (PersonLeaves)，它使用**Object.create**关键字扩展上述 Person 函数。

```
function PersonLeaves() {
 Person.call(this);
}
PersonLeaves.prototype = Object.create(Person.prototype);

PersonLeaves(); 
```

// 现在检查两个子函数原型。

```
PersonSalary.prototype
PersonLeaves.prototype 
```

这两个子函数都将链接到 Person(父函数) 原型并可以访问它的方法，但是如果您使用 new 创建子函数，它将返回一个全新的对象，其中包含我们不需要的所有父属性，并且当您创建任何使用“新”的对象或函数执行我们不想执行的父函数。

这是外卖

> 如果您只想委托给父函数中的某些方法并且不想创建新对象，则使用 Object.create 是最好的方法。**

# d3.js - 查找 SVG 元素的偏移位置

> ID：13040685
> 
> 赞同：23
> 
> 时间：2012-10-23T23:07:43.863
> 
> 标签：d3.js

我在 D3 上经常遇到这个问题。很多时候我喜欢在我的 SVG 上覆盖 HTML 对象。

我当前的策略是在名为 .html-overlay 的 SVG 元素旁边创建一个空 DIV。我根据我在 SVG 中为主图形设置的内部填充来定位它（例如：20px）。然后我使用以下函数（使用 jQuery）来确定 HTML 元素的位置：

```
//element is the object returned by D3 .append()
var getOffset: function(element) {
        var $element = $(element[0][0]);
        return {
            left: $element.offset().left - $('.html-overlay').offset().left,
            top: $element.offset().top - $('.html-overlay').offset().top
        };
    } 
```

我想知道，必须有一些内部（不依赖于 jQuery）的方法来快速获取元素的偏移量。它非常有用（尤其是在元素经过多次平移、旋转、缩放等之后）

具有计算元素“中心”的偏移量、元素的最高点、最底部、最左边、最右边等的函数也很棒。

笔记：

getBoundingClientRect() 由于某种原因没有给出正确的数字：

```
var $element = $(element[0][0]);

            console.log($element.offset(), element[0][0].getBoundingClientRect())
Object
left: 328
top: 248.8333282470703
__proto__: Object

ClientRect
bottom: 376.83331298828125
height: 139.99998474121094
left: 328
right: 478
top: 236.8333282470703
width: 150 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-24T01:14:06.083

你试过了吗

```
var xywh =element[0][0].getBoundingClientRect(); 
```

似乎拥有一切？（原始解决方案在[这篇文章](https://stackoverflow.com/questions/9627005/svg-getting-the-position-of-an-element-relative-to-the-page)中）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-12-05T18:02:08.750

问题在于`getBoundingClientRect`，它不考虑滚动位置或元素相对于文档的容器位置。它只会报告**该**项目相对于文档顶部和左侧坐标的确切位置。

我创建了一个 d3 方法，它将报告元素的位置。它的工作原理是遍历父元素，直到找到容器 SVG，然后考虑该项目在计算中的位置。它返回您通常会从`getBoundingClientRect`.

这是方法：

```
d3.selection.prototype.position = function() {

    var el = this.node();
    var elPos = el.getBoundingClientRect();
    var vpPos = getVpPos(el);

    function getVpPos(el) {
        if(el.parentElement.tagName === 'svg') {
            return el.parentElement.getBoundingClientRect();
        }
        return getVpPos(el.parentElement);
    }

    return {
        top: elPos.top - vpPos.top,
        left: elPos.left - vpPos.left,
        width: elPos.width,
        bottom: elPos.bottom - vpPos.top,
        height: elPos.height,
        right: elPos.right - vpPos.left
    };

}; 
```

你可以像这样使用它：

`d3.select(element).position()`

请注意，我实际上并没有在此处添加代码来考虑滚动位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-25T19:06:18.733

扩展 James Lai 的答案以支持现代版本的 IE：

```
function getVpPos(el) {
    if(el.parentNode.nodeName === 'svg') {
        return el.parentNode.getBoundingClientRect();
    }
    return getVpPos(el.parentNode);
} 
```

注意：**parentElement**更改为**parentNode** ，**tagName**更改为**nodeName**。

# iphone - 是否可以从远程浏览器连接到我的 CocoaHttpServer？

> ID：13040689
> 
> 赞同：0
> 
> 时间：2012-10-23T23:08:17.220
> 
> 标签：iphone, ios, ipad, cocoahttpserver

我一直在尝试找到在 iOS 设备上运行 http 服务器的解决方案，只要包含的应用程序打开并运行，就可以从任何地方访问它。

在搜索解决方案时，我遇到了几个库，其中之一是 Cocoahttpserver [https://github.com/robbiehanson/CocoaHTTPServer](https://github.com/robbiehanson/CocoaHTTPServer)

虽然我看到很多人使用它来设置本地 httpserver 并从同一个应用程序访问它，但我不确定是否可以从远程浏览器访问它——例如我的桌面浏览器。所以这是我的问题：

1.  这可能吗？（运行一个可以从任何地方访问的 iOS Web 服务器，而不仅仅是本地网络）
2.  如果可能，是否可以设置一个将重定向到我的 iOS 服务器的静态域？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:16:34.047

1）是的，可以实现。要么使用 CocoaHTTPServer，它是一个很棒的库 - 或者你可以看看网上的一些教程，比如这个[http://www.cocoawithlove.com/2009/07/simple-extensible-http-server-in-cocoa .html](http://www.cocoawithlove.com/2009/07/simple-extensible-http-server-in-cocoa.html)

2) 不幸的是，不能，因为设备会根据互联网连接具有不同的 IP，并且域名只能与一个定义的 IP 地址一起使用。您也可以使用 Bonjour 名称，但使用 IP 地址可能更容易。

# vba - Excel - 通过 VBA 显示 ComboBox DropDown

> ID：13040694
> 
> 赞同：4
> 
> 时间：2012-10-23T23:08:55.660
> 
> 标签：vba, excel

我需要一个工作簿来在打开时显示组合框列表下拉菜单。

工作簿中的组合框是一个表单控件，所以是一个形状。

似乎无法找到相关的属性。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-24T03:01:33.660

如果您使用的是 ActiveX 控件，请参阅下面的内容，否则，如果您使用的是表单控件，则如果您希望通过代码进行下拉，请将它们替换为 ActiveX 控件。下面的代码适用于表单和工作表中的 ActiveX 控件。如果控件在工作表上，则更`ComboBox1.SetFocus`改为`ComboBox1.Activate`

我能想到的两种方法...

*   使用简单的命令

**久经考验**

```
Private Sub CommandButton1_Click()
   ComboBox1.DropDown
End Sub 
```

*   使用发送键。如果使用不当，Sendkeys 是不可靠的。

**久经考验**

```
Private Sub CommandButton1_Click()
   ComboBox1.SetFocus
   SendKeys "%{Down}"
End Sub 
```

**截图**

![在此处输入图像描述](../Images/966c6f99c6cb1a13ecc0b81c862a3178.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-28T06:03:25.510

我认为最好的 UserForm 组合框是 Siddharth Rout ComboBox1.SetFocus SendKeys "%{Down}"

对于工作表上的某些组合框 CB.DropDown 就足够了..就像它们没有 setfocus 或 activate

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-25T11:16:51.237

我在 .dropdown 上遇到过很多崩溃，但在 SendKeys 上发现了一些成功......

# php - 在 PHP/MySQL 中按天分组列出日记事件

> ID：13040695
> 
> 赞同：1
> 
> 时间：2012-10-23T23:09:00.120
> 
> 标签：php

我正在尝试从 MySQL 数据库中列出 PHP 中的日记事件，但按天分组。我会解释的。

这是我到目前为止的截图：

![在此处输入图像描述](../Images/ff1cc1b18f626292196d3c130f8d7d4f.png)

如您所见，2012 年 10 月 23 日有两个日记事件，并显示了两个日历图标/表示/任何内容。我实际上希望它在左侧显示一个日历图标，但在右侧列出所有当天的事件，直到第二天 - 正如我在下面的 a̶r̶t̶i̶s̶t̶s̶ idiots 印象中所见：

![在此处输入图像描述](../Images/d7aeca603bebab7de32f6ccad16c2fea.png)

这是我刚刚编写的代码，有人可以指出我正确的方向：

```
$SQL = "SELECT entry_id, entry_title, entry_body, entry_date, entry_day, entry_month, entry_year ";
$SQL .= "FROM pages_diary WHERE entry_month = :this_month AND entry_year = :this_year ";
$SQL .= "ORDER BY entry_date DESC;";
// PDO stuff
if ($STH->rowCount() > 0) {
    while($row = $STH->fetch()):
        $this_db_month_word = mktime(0, 0, 0, $row['entry_month']);
        $this_db_month_word = strftime("%b", $this_db_month_word);
        echo '<div class="diary_events_item" id="diary_events_item_'.$row['entry_id'].'">';
            echo '<div class="diary_events_item_left">';
                echo '<div class="calendar_wrap">';
                    echo '<div class="calendar_wrap_top">';
                        echo $this_db_month_word;
                    echo '</div>';
                    echo '<div class="calendar_wrap_bottom">';
                        echo str_pad($row['entry_day'],2,'0',STR_PAD_LEFT);;
                    echo '</div>';
                echo '</div>';
            echo '</div>';
            echo '<div class="diary_events_item_right">';
                echo '<strong>'.htmlspecialchars($row['entry_title']).'</strong><br>';
                echo '<p>'.htmlspecialchars($row['entry_body']).'</p>';
            echo '</div>';
            echo '<div class="clear"></div>';
        echo '</div>';
    endwhile;
} else {
    echo '<p>There are no diary entries logged for <strong>'.$this_month_word.' '.$this_year.'</strong>.</p>';  
} 
```

不寻找确切的代码（虽然那会很麻烦），只是一个解释就可以了，我相信我可以从中解决。

**修复**

在 WHILE 循环结束时，我添加了：

```
$last_db_day = $row['entry_day']; 
```

然后将日历项包装在：

```
if ($last_db_day != $row['entry_day']) {
    echo '<div class="calendar_wrap_top">';
        echo $this_db_month_word;
    echo '</div>';
    echo '<div class="calendar_wrap_bottom">';
        echo str_pad($row['entry_day'],2,'0',STR_PAD_LEFT);;
    echo '</div>';
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:10:15.063

当您从数据库中遍历您的结果集时，请跟踪`entry_date`您看到的最后一个，如果当前记录是针对不同日期的，则仅输出一个新的日历图标。

我通常这样做如下：

```
if ($STH->execute()) {

  // output headers

  $row = $STH->fetch();
  while ($row) {
    $current_date = $row['entry_date'];

    // output $current_date initialisation
    do {
      // output event $row
    } while ($row = $STH->fetch() and $row['entry_date'] == $current_date);
    // output $current_date termination
  }

  // output footers

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:30:50.583

虽然我会反其道而行之，将 PHP 嵌入 HTML 中，而不是反过来，但我将使用您的代码执行以下操作：

```
$SQL = "SELECT entry_id, entry_title, entry_body, entry_date, entry_day, entry_month, entry_year ";
$SQL .= "FROM pages_diary WHERE entry_month = :this_month AND entry_year = :this_year ";
$SQL .= "ORDER BY entry_date DESC;";
// PDO stuff
if ($STH->rowCount() > 0) {
    $loopDay = '';

    while($row = $STH->fetch()):

        if ($row['entry_day'] != $loopDay) {
            $loopDay = $row['entry_day'];
            $changed = true;
        }

        $this_db_month_word = mktime(0, 0, 0, $row['entry_month']);
        $this_db_month_word = strftime("%b", $this_db_month_word);
        echo '<div class="diary_events_item" id="diary_events_item_'.$row['entry_id'].'">';
            echo '<div class="diary_events_item_left">';

                if ($changed) {
                    echo '<div class="calendar_wrap">';
                        echo '<div class="calendar_wrap_top">';
                            echo $this_db_month_word;
                        echo '</div>';
                        echo '<div class="calendar_wrap_bottom">';
                            echo str_pad($row['entry_day'],2,'0',STR_PAD_LEFT);;
                        echo '</div>';
                    echo '</div>';
                } else {
                    echo '&nbsp;';
                }

            echo '</div>';
            echo '<div class="diary_events_item_right">';
                echo '<strong>'.htmlspecialchars($row['entry_title']).'</strong><br>';
                echo '<p>'.htmlspecialchars($row['entry_body']).'</p>';
            echo '</div>';
            echo '<div class="clear"></div>';
        echo '</div>';

    $changed = false;
    endwhile;
} else {
    echo '<p>There are no diary entries logged for <strong>'.$this_month_word.' '.$this_year.'</strong>.</p>';
} 
```

# php - HTML5 拖放拖放区

> ID：13040697
> 
> 赞同：3
> 
> 时间：2012-10-23T23:09:13.253
> 
> 标签：php, javascript, css, html, drag-and-drop

我在拖放时遇到问题。

我的问题是，当一个元素被放入 dropzone 时，它​​有时会被插入另一个元素而不是 dropzone div。

jsFiddle：http: [//jsfiddle.net/kMbPF/](http://jsfiddle.net/kMbPF/)

在示例中，您可以看到我将表格制作得非常大，因此很容易看到这一点。当一个表被放置在另一个表的顶部时，它不会与其他元素一起进入放置区，而是插入到另一个表中。

我有几个想法，但我不知道它们是否可行。一个是如果可以以某种方式在 dropzones 上插入一个大 div 以确保元素总是被放入其中。我认为这几乎是一个透明层，它捕获元素然后将它们放置在拖放区中。

我的另一个想法是尝试从 div 中获取所有数据，将它们全部放入一个字符串中，然后尝试解析它，然后将所有数据替换回 dropzone。

此外，您会注意到，排序有效，但似乎只在 Firefox 中有效，而不是在 Safari 中。这不是我最关心的问题，但如果你碰巧看到了一个很棒的修复程序！（排序只适用于上部 dropzone）我不想使用 jQuery。

代码：

```
<!DOCTYPE html>

<html lang="en">
<head>
    <title>Basic drag and drop example</title>

    <style>
    @CHARSET "UTF-8";
table.draggable-word {
    background-color: red;
    padding: 0px;
    border: 1px solid green;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    -khtml-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    border-collapse: collapse;
    border-spacing: 0;
    padding: 0;
    margin: 0;
    line-height: 1;
    width: 100%;
    height:50px;
}

.drop-div {
    width: 150px;
    height: 150px;
    border: 3px solid #224163;
    background-color: #AABACC;
    margin-top: 15px;
    text-align: center;
    overflow: auto;
}

[draggable=true] {
    cursor: default;
    margin-top: 0px;
    margin-bottom: 0px;
    margin-top: 0px;
}

table {
     border-color: #600;
    border-width: 0 0 1px 1px;
    border-style: solid;
}
    </style>

    <script>

var user ="";
var multiples = false;
var data;

function dragStartHandler(event,id) {
    event.dataTransfer.setData('Object', event.target.id);
    user = id;
    multiples = true;
     data = event.dataTransfer.getData('Object');
    //multipleDrag(data,"false");

}
function dropHandler(event) {
    preventDefaults(event);
    if (!event.target) {
        alert('we');
        event.target = event.srcElement
    }
    data = event.dataTransfer.getData('Object');
    event.target.appendChild(document.getElementById(data));
    document.getElementById(data).selectedIndex = -1;
    //alert(user);

}
function dragOverHandler(event) {
    preventDefaults(event);
}

function preventDefaults(event) {
    if (event.preventDefault) {
        event.preventDefault();
    }

    try {
        event.returnValue = false;
    }
    catch (exception) {}
}

function dragend(event) {
//    multipleDrag(data,"true");

}

function multipleDrag(data,state){
    document.getElementById(data).setAttribute("draggable", state);
}

function sort(uList)
{
    var listItem = document.getElementById(uList).getElementsByTagName('td');
    var listLength = listItem.length;
    var list = [];

    for(var i=0; i<listItem.length; i++){
        list[i] = listItem[i].id.substring(1,listItem[i].id.length);         
        list.sort(function(a,b) {return parseInt(a) > parseInt(b)})
    }
    for(var i=0; i<listLength; i++){
        listItem[i].firstChild.nodeValue = list[i];
    }

}   

        </script>

</head>

<body>

<div class="drop-div"
     ondragover="dragOverHandler(event);"
     ondrop="dropHandler(event)"
     id="drop-div1" ondragend="sort('drop-div1')"></div>

     <div class="drop-div"
     ondragover="dragOverHandler(event);"
     ondrop="dropHandler(event)"
     id="drop-div2">
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'3');"
     class="draggable-word"id="d3" ondragend="dragend(event);"
     ><tr><td id="d3">3</td></tr></table>
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'4');"
     class="draggable-word"
     id="d4" ondragend="dragend(event);"><tr><td id="d4">4</td></tr></table>
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'4');"
     class="draggable-word"
     id="d5" ondragend="dragend(event);"><tr><td id="d5">5</td></tr></table>
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'4');"
     class="draggable-word"
     id="d6" ondragend="dragend(event);"><tr><td id="d6">6</td></tr></table>
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'4');"
     class="draggable-word"
     id="d7" ondragend="dragend(event);"><tr><td id="d7" >7</td></tr></table>
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'4');"
     class="draggable-word"
     id="d8" ondragend="dragend(event);"><tr><td id="d8" >8</td></tr></table>
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'4');"
     class="draggable-word"
     id="d9" ondragend="dragend(event);"><tr><td id="d9">9</td></tr></table>
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'4');"
     class="draggable-word"
     id="d10" ondragend="dragend(event);"><tr><td id="d10">10</td></tr></table>
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'4');"
     class="draggable-word"
     id="d11" ondragend="dragend(event);"><tr><td id="d11">11</td></tr></table>
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'4');"
     class="draggable-word"
     id="d12" ondragend="dragend(event);"><tr><td id="d12">12</td></tr></table>
     <table  draggable="true"
     ondragstart="dragStartHandler(event,'4');"
     class="draggable-word"
     id="d13" ondragend="dragend(event);"><tr><td id="d13">13</td></tr></table>
</div>
 <div id="print"></div>
</body>
</html>​ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T01:11:03.793

drop 事件在子元素上被触发，所以你`event.target`是子元素。这是正常的[事件冒泡](https://stackoverflow.com/q/4616694/8655)，只是可以预料的。

而不是立即附加到`event.target`这样的：

```
event.target.appendChild(document.getElementById(data)); 
```

您需要首先找到父 dropzone 元素。这很简单，如果你有类似 jQuery 的东西，你可以简单地使用[`closest`方法](http://api.jquery.com/closest/)。如果你不这样做，那么这样的事情会起作用（未经测试，你可能需要消除一些错误）：

```
var dropzone = event.target;
while (dropzone.id != 'drop-div1') {
    dropzone = dropzone.parentNode;
}
dropzone.appendChild(document.getElementById(data)); 
```

# asp.net-mvc - 在 ApiController 中生成 T4MVC url

> ID：13040703
> 
> 赞同：2
> 
> 时间：2012-10-23T23:10:08.807
> 
> 标签：asp.net-mvc, t4mvc

有没有办法使用 T4MVC 在 ApiController 内生成不属于 ApiController 的 Url？我没有选择这样做。 `controller.Url`当我运行下面的代码时为空。

```
var controller = new UrlController();

                foreach (var e in @event.Event.Reports)
                {
                    e.Url = controller.Url.Action(EventReportTypes.GetTypes(e.ReportType, @event.Event.Id, AssetOutput.Html, false));
                } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T06:23:45.933

我通过这样做让它工作。

```
 var url = new UrlHelper(HttpContext.Current.Request.RequestContext);
                if (url != null)
                {
                    e.Url = url.ActionAbsolute(EventReportTypes.GetTypes(e.ReportType, @event.Id, AssetOutput.Html, false)).Split('&')[0];
                } 
```

# php - 根据值添加和定位 XML 节点以生成 XML 文档

> ID：13040709
> 
> 赞同：0
> 
> 时间：2012-10-23T23:10:36.053
> 
> 标签：php, xml

我正在开发一个应用程序，它将采用 2 个 XML 文件并合并为 1 个。目前我可以生成一个 XML 文件，但它的格式不是我想要的，而且我现在已经碰壁了。

1.  应用程序读取 2 个 XML 文件，然后从其中一个 XML 文件中检查每个员工记录。
2.  对于第一个 XML 文件中的每个员工记录
    1.  它在第二个 XML 中查找相应的记录
    2.  一旦被发现，它会生成一系列新节点并使用第二个 XML 文件中的信息填充它

我想将这些新节点放置在特定点的相关人员记录中（目前它只是将它们全部转储到 XML 文档的底部）

我遇到的问题是从第二个 xml 中获取相应的数据，以便与第一个 xml 文件中的数据一起放置。如您所见，它只是放在文档的底部，并没有链接到相关记录（生成的输出），数据应该出现在上面，我目前不知道如何做到这一点，任何建议都将不胜感激。谢谢

# PHP的

```
<?php

$schoolExtract = new DOMDocument;
$schoolExtract->load('schoolExtract.xml');

$kcsExtract = new DOMDocument;
$kcsExtract->preserveWhiteSpace = false;
$kcsExtract->load('kcsFinalExtract.xml');
$xp = new DOMXPath($kcsExtract);

header("Content-Type: text/plain");

$kcsUserRecord = $kcsExtract->getElementsByTagName( "StaffDetails" ); 

$schoolRecord = $schoolExtract->getElementsByTagName( "StaffDetails" );

$schoolRecordCount = $schoolExtract->getElementsByTagName( "SchoolWorkforceMember" );

$noRecords = $schoolRecordCount->length;

set_time_limit(0);

$i = 0;

foreach($schoolRecord as $row2)
{

    $foundRecord = 0;

    $NationalInsuranceSE = $row2->getElementsByTagName("NINumber")->item(0)->nodeValue;
    $StaffMemberNameSE = $row2->getElementsByTagName("PersonFamilyName")->item(0)->nodeValue;
    $PersonGivenNameSE = $row2->getElementsByTagName("PersonGivenName")->item(0)->nodeValue;
    $DOBSE = $row2->getElementsByTagName("PersonBirthDate")->item(0)->nodeValue;

    $newDOBSE = date("d/m/Y", strtotime($DOBSE));

    foreach($kcsUserRecord as $row4)
    {
        $NationalInsuranceKCS = $row4->getElementsByTagName("NationalInsurance")->item(0)->nodeValue;
        $StaffMemberNameKCS = $row4->getElementsByTagName("StaffMemberName")->item(0)->nodeValue;
        $DOBKCS = $row4->getElementsByTagName("PersonBirthDate")->item(0)->nodeValue;

        if($NationalInsuranceSE == $NationalInsuranceKCS && $StaffMemberNameSE == $StaffMemberNameKCS){

            $foundRecord = 1;

            $xpQuery = $xp->query('/KCSExtract/StaffRecord[StaffDetails/NationalInsurance="'. $NationalInsuranceKCS . '"]');

            foreach ($xpQuery as $item)
            {

                $newItem = $schoolExtract->documentElement->appendChild(
                        $schoolExtract->createElement('ContractOrServiceGroup')
                    );

                foreach (array('ContractType', 'ContractStart', 'ContractEnd','Post', 'SchoolArrivalDate', 'DestinationCode', 'Origin', 'LASchoolLevel', 'Estab', 'PostLevelDetails', 'Roles') as $elementName) {
                    $newItem->appendChild(
                        $schoolExtract->importNode(
                            $item->getElementsByTagName($elementName)->item(0),
                            true
                        )
                    );
                }

            }

            $i++;               
        }           

    }

    if($foundRecord == 1){

        /*No Handlers in place yet*/
    }
    else if($foundRecord == 0){
        /*No Handlers in place yet*/

    }

}

$schoolExtract->formatOutput = true;

echo $schoolExtract->saveXml();

?> 
```

# schoolExtract.xml

```
<Members>
    <SchoolWorkforceMembers>
        <SchoolWorkforceMember>
            <StaffDetails>
                <TeacherNumber>123456</TeacherNumber>
                <StaffMemberName>
                  <PersonFamilyName>Wayne</PersonFamilyName>
                  <GivenNames>
                    <GivenName>
                      <PersonGivenName>Bruce</PersonGivenName>
                    </GivenName>
                  </GivenNames>
                </StaffMemberName>
                <NINumber>BW123456</NINumber>
                <GenderCurrent>2</GenderCurrent>
                <PersonBirthDate>1974-08-07</PersonBirthDate>
                <Ethnicity>WBRI</Ethnicity>
                <Disability>NOBT</Disability>
                <QTStatus>true</QTStatus>
                <HLTAStatus>false</HLTAStatus>
          </StaffDetails>
           <Absences>
                <Absence>
                  <FirstDayOfAbsence>2011-09-05</FirstDayOfAbsence>
                  <LastDayOfAbsence>2011-10-30</LastDayOfAbsence>
                  <WorkingDaysLost>033.0</WorkingDaysLost>
                  <AbsenceCategory>SIC</AbsenceCategory>
                  <Estab>6905</Estab>
                </Absence>
                <Absence>
                  <FirstDayOfAbsence>2012-01-17</FirstDayOfAbsence>
                  <LastDayOfAbsence>2012-01-17</LastDayOfAbsence>
                  <AbsenceCategory>OTH</AbsenceCategory>
                  <Estab>6905</Estab>
                </Absence>
              </Absences>
        </SchoolWorkforceMember> 
        <SchoolWorkforceMember>
            <StaffDetails>
                <TeacherNumber>123456</TeacherNumber>
                <StaffMemberName>
                  <PersonFamilyName>Parker</PersonFamilyName>
                  <GivenNames>
                    <GivenName>
                      <PersonGivenName>Peter</PersonGivenName>
                    </GivenName>
                  </GivenNames>
                </StaffMemberName>
                <NINumber>SM123456</NINumber>
                <GenderCurrent>2</GenderCurrent>
                <PersonBirthDate>1974-08-07</PersonBirthDate>
                <Ethnicity>WBRI</Ethnicity>
                <Disability>NOBT</Disability>
                <QTStatus>true</QTStatus>
                <HLTAStatus>false</HLTAStatus>
          </StaffDetails>
           <Absences>
                <Absence>
                  <FirstDayOfAbsence>2011-09-05</FirstDayOfAbsence>
                  <LastDayOfAbsence>2011-10-30</LastDayOfAbsence>
                  <WorkingDaysLost>033.0</WorkingDaysLost>
                  <AbsenceCategory>SIC</AbsenceCategory>
                  <Estab>6905</Estab>
                </Absence>
                <Absence>
                  <FirstDayOfAbsence>2012-01-17</FirstDayOfAbsence>
                  <LastDayOfAbsence>2012-01-17</LastDayOfAbsence>
                  <AbsenceCategory>OTH</AbsenceCategory>
                  <Estab>6905</Estab>
                </Absence>
              </Absences>
        </SchoolWorkforceMember>
    </SchoolWorkforceMembers>   
</Members> 
```

# kcsFinalExtract.xml

```
<KCSExtract>
  <StaffRecord>
    <StaffDetails>
      <NationalInsurance>BW123456</NationalInsurance>
      <PersonBirthDate>1974-08-07</PersonBirthDate>
      <StaffMemberName>Wayne</StaffMemberName>
      <PersonGivenName>Bruce</PersonGivenName>
    </StaffDetails>
    <ContractOrServiceGroup>
      <ContractOrService>
        <ContractType>PRM</ContractType>
        <ContractStart>01/09/2003</ContractStart>
        <ContractEnd></ContractEnd>
        <Post>TCH</Post>
        <SchoolArrivalDate>01/12/2007</SchoolArrivalDate>
        <DestinationCode>TU</DestinationCode>
        <Origin>NOTKNW</Origin>
        <LASchoolLevel></LASchoolLevel>
        <Estab></Estab>
        <PostLevelDetails>
          <Payments>
            <Scale>TU</Scale>
            <RegionSpine>EW</RegionSpine>
            <SpinePoint>U2</SpinePoint>
            <TotalPay>35,447.00</TotalPay>
            <SafeguardedSalary>FALSE</SafeguardedSalary>
          </Payments>
          <Hours>
            <Hours>32.5</Hours>
            <FTEHours>32.5</FTEHours>
            <WeeksPerYear>52</WeeksPerYear>
          </Hours>
        </PostLevelDetails>
        <Roles>
          <Role>
            <RoleIdentifier>TCHR</RoleIdentifier>
          </Role>
        </Roles>
      </ContractOrService>
    </ContractOrServiceGroup>
  </StaffRecord>
    <StaffRecord>
    <StaffDetails>
      <NationalInsurance>SM123456</NationalInsurance>
      <PersonBirthDate>03/01/1971</PersonBirthDate>
      <StaffMemberName>Parker</StaffMemberName>
      <PersonGivenName>Peter</PersonGivenName>
    </StaffDetails>
    <ContractOrServiceGroup>
      <ContractOrService>
        <ContractType>PRM</ContractType>
        <ContractStart>01/09/2003</ContractStart>
        <ContractEnd></ContractEnd>
        <Post>TCH</Post>
        <SchoolArrivalDate>01/12/2007</SchoolArrivalDate>
        <DestinationCode>TU</DestinationCode>
        <Origin>NOTKNW</Origin>
        <LASchoolLevel></LASchoolLevel>
        <Estab></Estab>
        <PostLevelDetails>
          <Payments>
            <Scale>TU</Scale>
            <RegionSpine>EW</RegionSpine>
            <SpinePoint>U2</SpinePoint>
            <TotalPay>35,447.00</TotalPay>
            <SafeguardedSalary>FALSE</SafeguardedSalary>
          </Payments>
          <Hours>
            <Hours>32.5</Hours>
            <FTEHours>32.5</FTEHours>
            <WeeksPerYear>52</WeeksPerYear>
          </Hours>
        </PostLevelDetails>
        <Roles>
          <Role>
            <RoleIdentifier>TCHR</RoleIdentifier>
          </Role>
        </Roles>
      </ContractOrService>
    </ContractOrServiceGroup>
  </StaffRecord>
  </KCSExtract> 
```

# 生成的输出

```
<?xml version="1.0"?>
<Members>
    <SchoolWorkforceMembers>
        <SchoolWorkforceMember>
            <StaffDetails>
                <TeacherNumber>123456</TeacherNumber>
                <StaffMemberName>
                  <PersonFamilyName>Wayne</PersonFamilyName>
                  <GivenNames>
                    <GivenName>
                      <PersonGivenName>Bruce</PersonGivenName>
                    </GivenName>
                  </GivenNames>
                </StaffMemberName>
                <NINumber>BW123456</NINumber>
                <GenderCurrent>2</GenderCurrent>
                <PersonBirthDate>1974-08-07</PersonBirthDate>
                <Ethnicity>WBRI</Ethnicity>
                <Disability>NOBT</Disability>
                <QTStatus>true</QTStatus>
                <HLTAStatus>false</HLTAStatus>
          </StaffDetails>
           <Absences>
                <Absence>
                  <FirstDayOfAbsence>2011-09-05</FirstDayOfAbsence>
                  <LastDayOfAbsence>2011-10-30</LastDayOfAbsence>
                  <WorkingDaysLost>033.0</WorkingDaysLost>
                  <AbsenceCategory>SIC</AbsenceCategory>
                  <Estab>6905</Estab>
                </Absence>
                <Absence>
                  <FirstDayOfAbsence>2012-01-17</FirstDayOfAbsence>
                  <LastDayOfAbsence>2012-01-17</LastDayOfAbsence>
                  <AbsenceCategory>OTH</AbsenceCategory>
                  <Estab>6905</Estab>
                </Absence>
              </Absences>
        </SchoolWorkforceMember> 
        <SchoolWorkforceMember>
            <StaffDetails>
                <TeacherNumber>123456</TeacherNumber>
                <StaffMemberName>
                  <PersonFamilyName>Parker</PersonFamilyName>
                  <GivenNames>
                    <GivenName>
                      <PersonGivenName>Peter</PersonGivenName>
                    </GivenName>
                  </GivenNames>
                </StaffMemberName>
                <NINumber>SM123456</NINumber>
                <GenderCurrent>2</GenderCurrent>
                <PersonBirthDate>1974-08-07</PersonBirthDate>
                <Ethnicity>WBRI</Ethnicity>
                <Disability>NOBT</Disability>
                <QTStatus>true</QTStatus>
                <HLTAStatus>false</HLTAStatus>
          </StaffDetails>
           <Absences>
                <Absence>
                  <FirstDayOfAbsence>2011-09-05</FirstDayOfAbsence>
                  <LastDayOfAbsence>2011-10-30</LastDayOfAbsence>
                  <WorkingDaysLost>033.0</WorkingDaysLost>
                  <AbsenceCategory>SIC</AbsenceCategory>
                  <Estab>6905</Estab>
                </Absence>
                <Absence>
                  <FirstDayOfAbsence>2012-01-17</FirstDayOfAbsence>
                  <LastDayOfAbsence>2012-01-17</LastDayOfAbsence>
                  <AbsenceCategory>OTH</AbsenceCategory>
                  <Estab>6905</Estab>
                </Absence>
              </Absences>
        </SchoolWorkforceMember>
    </SchoolWorkforceMembers>   
<ContractOrServiceGroup><ContractType>PRM</ContractType><ContractStart>01/09/2003</ContractStart><ContractEnd/><Post>TCH</Post><SchoolArrivalDate>01/12/2007</SchoolArrivalDate><DestinationCode>TU</DestinationCode><Origin>NOTKNW</Origin><LASchoolLevel/><Estab/><PostLevelDetails><Payments><Scale>TU</Scale><RegionSpine>EW</RegionSpine><SpinePoint>U2</SpinePoint><TotalPay>35,447.00</TotalPay><SafeguardedSalary>FALSE</SafeguardedSalary></Payments><Hours><Hours>32.5</Hours><FTEHours>32.5</FTEHours><WeeksPerYear>52</WeeksPerYear></Hours></PostLevelDetails><Roles><Role><RoleIdentifier>TCHR</RoleIdentifier></Role></Roles></ContractOrServiceGroup><ContractOrServiceGroup><ContractType>PRM</ContractType><ContractStart>01/09/2003</ContractStart><ContractEnd/><Post>TCH</Post><SchoolArrivalDate>01/12/2007</SchoolArrivalDate><DestinationCode>TU</DestinationCode><Origin>NOTKNW</Origin><LASchoolLevel/><Estab/><PostLevelDetails><Payments><Scale>TU</Scale><RegionSpine>EW</RegionSpine><SpinePoint>U2</SpinePoint><TotalPay>35,447.00</TotalPay><SafeguardedSalary>FALSE</SafeguardedSalary></Payments><Hours><Hours>32.5</Hours><FTEHours>32.5</FTEHours><WeeksPerYear>52</WeeksPerYear></Hours></PostLevelDetails><Roles><Role><RoleIdentifier>TCHR</RoleIdentifier></Role></Roles></ContractOrServiceGroup></Members> 
```

# 期望的输出

```
<Members>
  <SchoolWorkforceMembers>
    <SchoolWorkforceMember>
      <StaffDetails>
        <TeacherNumber>123456</TeacherNumber>
        <StaffMemberName>
          <PersonFamilyName>Wayne</PersonFamilyName>
          <GivenNames>
            <GivenName>
              <PersonGivenName>Bruce</PersonGivenName>
            </GivenName>
          </GivenNames>
        </StaffMemberName>
        <NINumber>BW123456</NINumber>
        <GenderCurrent>2</GenderCurrent>
        <PersonBirthDate>1974-08-07</PersonBirthDate>
        <Ethnicity>WBRI</Ethnicity>
        <Disability>NOBT</Disability>
        <QTStatus>true</QTStatus>
        <HLTAStatus>false</HLTAStatus>
      </StaffDetails>
      <ContractOrServiceGroup>
        <ContractOrService>
          <ContractType>PRM</ContractType>
          <ContractStart>01/09/2003</ContractStart>
          <ContractEnd></ContractEnd>
          <Post>TCH</Post>
          <SchoolArrivalDate>01/12/2007</SchoolArrivalDate>
          <DestinationCode>TU</DestinationCode>
          <Origin>NOTKNW</Origin>
          <LASchoolLevel></LASchoolLevel>
          <Estab></Estab>
          <PostLevelDetails>
            <Payments>
              <Scale>TU</Scale>
              <RegionSpine>EW</RegionSpine>
              <SpinePoint>U2</SpinePoint>
              <TotalPay>35,447.00</TotalPay>
              <SafeguardedSalary>FALSE</SafeguardedSalary>
            </Payments>
            <Hours>
              <Hours>32.5</Hours>
              <FTEHours>32.5</FTEHours>
              <WeeksPerYear>52</WeeksPerYear>
            </Hours>
          </PostLevelDetails>
          <Roles>
            <Role>
              <RoleIdentifier>TCHR</RoleIdentifier>
            </Role>
          </Roles>
        </ContractOrService>
      </ContractOrServiceGroup>
      <Absences>
        <Absence>
          <FirstDayOfAbsence>2011-09-05</FirstDayOfAbsence>
          <LastDayOfAbsence>2011-10-30</LastDayOfAbsence>
          <WorkingDaysLost>033.0</WorkingDaysLost>
          <AbsenceCategory>SIC</AbsenceCategory>
          <Estab>6905</Estab>
        </Absence>
        <Absence>
          <FirstDayOfAbsence>2012-01-17</FirstDayOfAbsence>
          <LastDayOfAbsence>2012-01-17</LastDayOfAbsence>
          <AbsenceCategory>OTH</AbsenceCategory>
          <Estab>6905</Estab>
        </Absence>
      </Absences>
    </SchoolWorkforceMember>
    <SchoolWorkforceMember>
      <StaffDetails>
        <TeacherNumber>123456</TeacherNumber>
        <StaffMemberName>
          <PersonFamilyName>Parker</PersonFamilyName>
          <GivenNames>
            <GivenName>
              <PersonGivenName>Peter</PersonGivenName>
            </GivenName>
          </GivenNames>
        </StaffMemberName>
        <NINumber>SM123456</NINumber>
        <GenderCurrent>2</GenderCurrent>
        <PersonBirthDate>1974-08-07</PersonBirthDate>
        <Ethnicity>WBRI</Ethnicity>
        <Disability>NOBT</Disability>
        <QTStatus>true</QTStatus>
        <HLTAStatus>false</HLTAStatus>
      </StaffDetails>
      <ContractOrServiceGroup>
        <ContractOrService>
          <ContractType>PRM</ContractType>
          <ContractStart>01/09/2003</ContractStart>
          <ContractEnd></ContractEnd>
          <Post>TCH</Post>
          <SchoolArrivalDate>01/12/2007</SchoolArrivalDate>
          <DestinationCode>TU</DestinationCode>
          <Origin>NOTKNW</Origin>
          <LASchoolLevel></LASchoolLevel>
          <Estab></Estab>
          <PostLevelDetails>
            <Payments>
              <Scale>TU</Scale>
              <RegionSpine>EW</RegionSpine>
              <SpinePoint>U2</SpinePoint>
              <TotalPay>35,447.00</TotalPay>
              <SafeguardedSalary>FALSE</SafeguardedSalary>
            </Payments>
            <Hours>
              <Hours>32.5</Hours>
              <FTEHours>32.5</FTEHours>
              <WeeksPerYear>52</WeeksPerYear>
            </Hours>
          </PostLevelDetails>
          <Roles>
            <Role>
              <RoleIdentifier>TCHR</RoleIdentifier>
            </Role>
          </Roles>
        </ContractOrService>
      </ContractOrServiceGroup>
      <Absences>
        <Absence>
          <FirstDayOfAbsence>2011-09-05</FirstDayOfAbsence>
          <LastDayOfAbsence>2011-10-30</LastDayOfAbsence>
          <WorkingDaysLost>033.0</WorkingDaysLost>
          <AbsenceCategory>SIC</AbsenceCategory>
          <Estab>6905</Estab>
        </Absence>
        <Absence>
          <FirstDayOfAbsence>2012-01-17</FirstDayOfAbsence>
          <LastDayOfAbsence>2012-01-17</LastDayOfAbsence>
          <AbsenceCategory>OTH</AbsenceCategory>
          <Estab>6905</Estab>
        </Absence>
      </Absences>
    </SchoolWorkforceMember>
  </SchoolWorkforceMembers>
</Members> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T00:31:21.983

您正在创建一个新的容器元素`ContractOrServiceGroup`，然后将其附加到文档的根元素，然后在其上附加更多元素。

```
 $newItem = $schoolExtract->documentElement->appendChild(
                    $schoolExtract->createElement('ContractOrServiceGroup')
                ); 
```

相反，您应该做的是创建新元素及其所有子元素，然后将其附加到文档的适当位置。

例如：

```
 $newItem = $schoolExtract->createElement('ContractOrServiceGroup');

           foreach (array('ContractType', 'etc')) {
               // build $newItem tree
           }

           // $row2 I think is the StaffDetails element in schoolExtract.xml?

           // If so, this will add to the end of StaffDetails's parent:
           $row2->parentNode->appendChild($newItem);

           // This will add to the beginning:
           $row2->parentNode->insertBefore($newItem, $row2->parentNode->firstChild);

           // This will add it before StaffDetails:
           $row2->parentNode->insertBefore($newItem, $row2);

           // This will add it after:
           $row2->parentNode->insertBefore($newItem, $row2->nextSibling); 
```

这段代码很难理解。您是否考虑过改用[SimpleXML](http://php.net/manual/en/book.simplexml.php)？对于您正在使用的数据 XML，它是一个更清晰的 API。

# android - 我可以知道字符串本地化语言吗？

> ID：13040711
> 
> 赞同：0
> 
> 时间：2012-10-23T23:10:59.603
> 
> 标签：android

我从 sms 消息中获取字符串，有任何选项可以知道我需要选择什么 lang\local。我需要它来检查文本到语音选项是否可用。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T23:13:36.653

取决于语言，它可能容易或困难。查找一个字符串是希伯来语还是英语*非常*容易，字符都是不同的。查找字符串是英语还是法语更难，因为您需要确定单词是英语还是法语。在短字符串上查找字符串是西班牙语还是加泰罗尼亚语是不可能的。

# c# - 用户控件中的 WPFToolkit Datagrid 覆盖？请子类帮助

> ID：13040712
> 
> 赞同：0
> 
> 时间：2012-10-23T23:11:02.857
> 
> 标签：c#, wpf, wpfdatagrid, wpftoolkit

我在自定义 WPF 控件中对 WPFToolkit DataGrid 事件进行子类化和覆盖时遇到了一些麻烦。**这一切都适用于 .NET Framework 3.5 上的 WPF**

我的 XAML 类似于以下内容

```
<UserControl x:Class="MyGUI.EM.DocChecklistView"
    xmlns:toolkit="clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit">

<Grid>
        <toolkit:DataGrid  ItemsSource="{Binding Source={StaticResource DocVS}}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False" Name="_dgDoc" Margin="0,0,0,46"> 
```

代码类似于

```
public partial class DocChecklistView:  UserControl, IDataModuleView {     

        protected override System.Windows.Automation.Peers.AutomationPeer OnCreateAutomationPeer()
        {
            return null;
        }

        public CDocumentChecklistView() {
            InitializeComponent();
        } 
```

但是，请注意代码中的第一个覆盖——它永远不会触发。这是有道理的，因为我没有继承 DataGrid (WPFToolkit)。如何修改此代码以包含 DataGrid 的子类并确保覆盖触发？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T00:27:31.300

您可以创建自定义 DataGrid 控件。

```
public class CustomDataGrid:  DataGrid
{   
    protected override System.Windows.Automation.Peers.AutomationPeer OnCreateAutomationPeer()
    {
        return null;
    }
} 
```

然后在视图中使用该控件而不是 DataGrid。

```
<UserControl x:Class="MyGUI.EM.DocChecklistView"
    xmlns:toolkit="clr-namespace:Microsoft.Windows.Controls;assembly=WPFToolkit"
    xmlns:yourControl="clr-namespace:YourNamespace">

    <Grid>
        <yourControl:CustomDataGrid  ItemsSource="{Binding Source={StaticResource DocVS}}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False" Name="_dgDoc" Margin="0,0,0,46"> 
```

# sql - Sql Server 2012 上出现意外的断字结果

> ID：13040713
> 
> 赞同：2
> 
> 时间：2012-10-23T23:11:16.507
> 
> 标签：sql, full-text-search, sql-server-2012

```
SELECT occurrence, display_term 
FROM sys.dm_fts_parser ('"ROBIX 156 DM"', 1033, null, 0) 
```

不返回预期结果（display_term）：

```
robix
156
nn156
dm 
```

但

```
robix
156 dm
nn156dm 
```

什么是“DM”，为什么它会导致断词的意外结果，以及如何避免它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T16:05:22.027

这里可能发生的情况是 DM 被识别为一种货币（德国马克），这导致断字器与前导数值相关联。我尝试用美元替换 DM 并最终得到相同的结果 -

```
SELECT occurrence, display_term  
FROM sys.dm_fts_parser ('"ROBIX 156 USD"', 1033, null, 0)

occurrence  display_term
1   robix
2   156 usd
2   nn156usd 
```

目前我不知道解决方法，但如果我确实找到了解决方案，我会更新线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-30T18:12:01.973

解析器正在识别货币，您可以使用以下方式确认：

```
SELECT occurrence, display_term 
FROM sys.dm_fts_parser ('"ROBIX 156 euro"', 1033, null, 0) 
```

```
occurrence  display_term
1           robix
2           156 euro
2           nn156eur 
```

# rspec - 以默认顺序运行一些 RSpec 文件

> ID：13040718
> 
> 赞同：3
> 
> 时间：2012-10-23T23:11:55.437
> 
> 标签：rspec, continuous-integration

我让我们的 RSpec 套件以随机顺序运行，以确保独立性和稳健性。但是，在某些情况下，我想按顺序运行规范。我知道我只能`--order default`在命令行上使用，但我想将它与 CI 集成。我们使用 TDDium 进行 CI，我想尝试继续在 CI 服务器上随机运行，但要确保特定的规范文件按顺序运行。

## 问题

有没有办法在逐个文件的基础上指定 RSpec 应该以默认顺序运行该文件？我看到似乎有[一些定制的订购策略支持合并到 rspec-core](https://github.com/rspec/rspec-core/issues/547)中，但这似乎并没有完全成熟（我不确定它是否支持`before :all`），我仍在努力解决它.

## 讨论

而且，由于还有[另一个问题](https://stackoverflow.com/questions/10321166/run-rspec-tasks-in-a-specific-order)因为“规范应该是独立的”而被否决，所以让我陈述我的用例，试图先发制人地避免“你不应该这样做”的论点。

我们有一个复杂的模型，其中系统状态的各个方面会随着时间而变化。我有一个分析系统，它正在监视该系统以跟踪各种事物随时间的状态变化。多亏了[Timecop gem](https://github.com/travisjeffery/timecop)，我可以回到过去，创建一堆交互模型，然后逐步查看，比如 5 天，在已知条件下，每天查看分析系统所看到的系统。具体来说，在系统中嵌入假设的情况下，确保某些计算是正确的。

现在，我意识到我可以有 5 个单独的描述块，每个都经历为历史上 5 天中的每一天设置单独条件的过程，但是对我来说，逐步穿越时间并观察条件变化更有意义在那个状态。更高效，更贴近系统中实际发生的事情。我知道我可以在这里和那里模拟各种响应，我们这样做，但我有兴趣逐步完成基础系统和分析系统之间的“实时”交互。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T00:34:13.797

我应该只阅读规范，而不是[rspec core 中合并功能](https://github.com/rspec/rspec-core/commit/d79960bb6ebf63d005c2ed8d74f5a8f31bcc8e3b)的代码。[鉴于此规范](https://github.com/rspec/rspec-core/blob/d79960bb6ebf63d005c2ed8d74f5a8f31bcc8e3b/spec/command_line/order_spec.rb#L113)，这很清楚。

给定一个 custom_ordered_spec.rb：

```
 RSpec.configure do |config|
      config.order_groups_and_examples do |list|
        list.sort_by { |item| item.description }
      end
    end

    describe 'group B' do
      specify('group B example D')  {}
      specify('group B example B')  {}
      specify('group B example A')  {}
      specify('group B example C')  {}
    end

    describe 'group A' do
      specify('group A example 1')  {}
    end 
```

组和组内的示例都将按描述排序。此外，看起来您可以调用`config.order_groups`and `config.order_examples`。

这是我的[博客文章](http://mettadore.com/analysis/using-rspec-with-mixed-random-and-ordered-tests/)，其中有更详细的描述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-23T12:54:29.160

当前 (3.5) Rspec 不再具有 order_groups_and_examples 方法。相反，您可以[注册订购](http://rspec.info/documentation/3.5/rspec-core/RSpec/Core/Configuration.html#register_ordering-instance_method)：

```
RSpec.configure do |config|
  config.register_ordering :alphabetical do |list|
    list.sort_by { |item| item.description }
  end
end
RSpec.context "Test in alphabetic order", :order => :alphabetical  do
  describe 'group B' do
    specify('group B example D')  {}
    specify('group B example B')  {}
    specify('group B example A')  {}
    specify('group B example C')  {}
  end

  describe 'group A' do
    specify('group A example 1')  {}
  end
end 
```

# button - css 选择器上的 click() 在 Selenium webdriver 中不起作用

> ID：13040719
> 
> 赞同：11
> 
> 时间：2012-10-23T23:12:00.963
> 
> 标签：button, selenium, click, css-selectors, webdriver

HTML

```
<input class="button" type="button" onclick="$.reload('results')" value="Search"> 
```

我没有这个的 id 或名称。因此我在写

```
FirefoxDriver driver = new FirefoxDriver();
driver.get("http://....");
driver.findElement(By.cssSelector("input[value=Search]")).click(); 
```

但是 click() 没有发生。

试过 driver.findElement(By.cssSelector(".button[value=Search]")).click();

尝试值='搜索'（单引号）。

这些选择器正在工作

```
.button[value=Search] {
padding: 10px;
}
input[value=Search] {
padding: 10px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T12:49:50.200

我会注入一段js来有信心解决这个问题：

首先使用 DOM 定位元素（在 firebug 中验证）： ![定位](../Images/4363faea276caeb3d0df497bd6387ce1.png)

```
public void jsClick(){

        JavascriptExecutor js = (JavascriptExecutor) driver;
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append("document.getElementsByTagName('button')[0].click();");
        js.executeScript(stringBuilder.toString());
    }
jsClick(); 
```

从你的元素的回顾来看，它就像：

```
....
stringBuilder.append("document.getElementsByTagName('input')[0].click();");
.... 
```

请注意：`document.getElementsByTagName('input')` 返回一个 DOM 元素数组。并正确索引它，例如 document.getElementsByTagName('input')[0], document.getElementsByTagName('input') [1](https://i.stack.imgur.com/q6TiC.png) , document.getElementsByTagName('input')[2].... 等，您将能够找到你的元素。

希望这对您有所帮助。问候。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-16T09:53:01.053

请使用以下代码。

driver.findElement(By.cssSelector("input[value=\"Search\"]")).click();

这个对我有用。并确保名称是“搜索”，因为它区分大小写。

谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T13:35:19.557

你确定`input[value=Search]`在你的页面上使用这个 CSS 选择器 ( ) 你只有一个结果吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-16T11:11:07.333

您的代码中缺少单引号，应将**[value=Search]替换为****[value='Search']**。

首先，您必须检查您正在使用的选择器是否有效..

如果您使用的是 chrome 或 FF，您可以按照以下步骤操作，

1.  转到存在按钮（要单击）的页面，

2.  打开 web 控制台并输入以下内容，然后单击 enter..

    **$("输入[值='搜索']")**

或者

```
$("input[value='Search'][type='button']") 
```

或者

```
$("input[value='Search'][type='button'].button") 
```

您将获得可以使用此选择器访问的元素列表，如果该列表仅包含一个元素（您要单击的按钮），则此选择器对您的使用有效..否则您必须尝试其他选择器..

如果上述任何选择器有效，则必须相应地更改您的代码..

```
driver.findElement(By.cssSelector("input[value='Search'][type='button'].button")).click(); 
```

# ios - 当我的 masterview 控制器尝试启动我的详细视图时，为什么我的应用程序会崩溃？

> ID：13040725
> 
> 赞同：0
> 
> 时间：2012-10-23T23:12:26.280
> 
> 标签：ios

在做了一些教程之后，我正在尝试制作我的第一个 iOS 应用程序。我正在制作一个简单的标题/新闻阅读器，它从 ESPN API 将新奥尔良圣徒队的标题和故事作为 json 提取，在表格视图中显示标题，然后在用户点击标题时在详细视图中显示故事的文本.

该应用程序编译并运行，没有错误或警告。prepareForSegue 方法在用户点击顶部表格视图中的标题时执行。我可以在调试器中逐步执行此代码。如果我单步执行 prepareForSegue 方法，它会调用 detailViewController 的 setStory 方法，该方法又会调用 configureview 方法。但随后它带我进入 main.m，应用程序关闭，没有显示详细视图。

我是菜鸟。我错过了什么？为什么我看不到详细视图？也许我需要一个 IBAction 来加载 IBOutlet？

SaintsMasterViewController.m

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([[segue identifier] isEqualToString:@"showDetail"]) {
        saintsDetailViewController *detailViewController = [segue destinationViewController];
        saintsNewsStory* displayThisStory =[self.dataController objectInListAtIndex:[self.tableView indexPathForSelectedRow].row];
        [detailViewController setStory:displayThisStory];
    }
} 
```

SaintsDetailViewController.m

```
- (void)setStory:(saintsNewsStory *)newStory
{
 //   if (_story != newStory) {
        _story = newStory;
        // Update the view.
     //   [self configureView];
  //  }
}

- (void)configureView
{
    self.storyText.text = self.story.storyText;
}

- (void)viewDidLoad     //the app never gets here. if i put a breakpoint here it never gets here
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [self configureView];
} 
```

saintsDetailViewController.h

```
@class saintsNewsStory;
@interface saintsDetailViewController : UIViewController
@property (weak, nonatomic) IBOutlet UITextView *storyText;
@property (retain, nonatomic) saintsNewsStory *story;
@end 
```

控制台显示此错误：

SaintsHeadlineReader[9608:11303] *** 由于未捕获的异常“NSUnknownKeyException”而终止应用程序，原因：“[setValue:forUndefinedKey:]：此类不符合键 detailDescriptionLabel 的键值编码。” *** First throw call stack: (0x1c90012 0x10cde7e 0x1d18fb1 0xb7a711 0xafbec8 0xafb9b7 0xb26428 0x2320cc 0x10e1663 0x1c8b45a 0x230bcf 0xf5e37 0xf6418 0xf6648 0xf6882 0x102235 0x3013d2 0xff4f3 0xff777 0xff7b7 0x46afe2 0x45cad9 0x45cb54 0xc4899 0xc4b3d 0xacbe83 0x1c4f376 0x1c4ee06 0x1c36a82 0x1c35f44 0x1c35e1b 0x1bea7e3 0x1bea668 0x1565c 0x204d 0x1f75 0x1) libc++abi. dylib：终止调用抛出异常

似乎 textview 有一个详细标签，也许我需要一个出口？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:39:25.670

测试我的理论。在您当前使用的行之前或之后立即放入`NSLog(@"%d", [self.yourTableView indexPathForSelectedRow].row);`您当前的方法，并查看它在您的控制台中返回的内容。大概是0。`prepareForSegue``indexPathForSelectedRow`

不要将 UITableViewCell Prototype 的 segue 连接到 DetailViewController，而是将其从 UITableViewController 连接到 DetailViewController，然后使用以下方法：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    SaintsDetailViewController *detailViewController = [[SaintsDetailViewController alloc] init];
    saintsNewsStory* displayThisStory =[self.dataController objectAtIndex:indexPath.row];
    [detailViewController setStory:displayThisStory];
    [self performSegueWithIdentifier:@"showDetail" sender:indexPath];
} 
```

和你的`prepareForSegue:`方法：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
    if ([[segue identifier] isEqualToString:@"showDetail"]) {
        saintsDetailViewController *detailViewController = [segue destinationViewController];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:22:22.017

更改此行：

```
saintsDetailViewController *detailViewController = [segue destinationViewController]; 
```

对此：

```
saintsDetailViewController *detailViewController = (saintsDetailViewController *)[segue destinationViewController]; 
```

* * *

编辑：您应该首先显示您的视图，然后调用该`configureView`方法。尝试调用`configureView`该`viewDidLoad`ViewController。

```
- (void)setStory:(saintsNewsStory *)newStory
{
 //   if (_story != newStory) {
        _story = newStory;
        // Update the view.
       // [self configureView];
  //  }
}

-(void) viewDidLoad {
      [self configureView];
}

- (void)configureView
{
    self.storyText.text = self.story.storyText; //the app gets to here but does not show the view. why?
} 
```

# php - PHP URL /?val=something

> ID：13040726
> 
> 赞同：0
> 
> 时间：2012-10-23T23:12:35.080
> 
> 标签：php, .htaccess, url

我今天在[WolframAlpha.com](http://www.wolframalpha.com)上搞砸了，注意到您从 wolframalpha.com/index.html 页面开始，然后当您点击时，`enter`您会被重定向到 wolframalpha.com/input/?i=YourSearch

我知道如何设置它，但是对于我正在处理的项目，如果我可以重定向到而不是重定向到一个文件，但像 WA 一样隐藏页面名称`<form action="newpage.php" method="GET" />`，那会很酷吗？这会是 .htacess 的工作吗？`example.com/?val=something``example.com/newpage.php?val=something`

**编辑：** 我需要从 index.php 直接指向 pages/file.php，而不会在浏览器的 url 中显示“file.php”。所以如果我说：

```
<form action="pages/file.php" method="GET">
    <input type="text" name="foo" />
</form> 
```

那么如果将我引导到 example.com/?foo=blah 而不是 example.com/pages/file.php?foo=blah

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:21:42.723

如果`index.php`您访问时加载了脚本，则`www.example.com/`在此页面上有一个表单`<form action="">`将执行此操作。

# jquery - jquery计算器错误？

> ID：13040727
> 
> 赞同：0
> 
> 时间：2012-10-23T23:12:51.417
> 
> 标签：jquery, jquery-plugins, calculator

我正在使用 jquery 计算器插件，但遇到了问题，想知道是否有解决方法。我有一个要计算超过 8 次迭代的表格。一旦我到达＃9，它就会中断，不会显示错误。

```
$(function() {
      $('input[name^=sum]').keyup(function() {
            var sum1 = parseFloat($('input[name=sum1]').val()); // Or parseInt if integers only
            var sum2 = parseFloat($('input[name=sum2]').val());
            var sum3 = parseFloat($('input[name=sum3]').val());
            var sum4 = parseFloat($('input[name=sum4]').val());
            var sum5 = parseFloat($('input[name=sum5]').val());
            var sum6 = parseFloat($('input[name=sum6]').val());
            var sum7 = parseFloat($('input[name=sum7]').val());
            var sum8 = parseFloat($('input[name=sum8]').val());
            var sum9 = parseFloat($('input[name=sum9]').val());
            var sum10 = parseFloat($('input[name=sum10]').val());
            $('#totalSum').val(sum1 + sum2 + sum3 + sum4 + sum5 + sum6 + sum7 + sum10);
      });
});
$(function() {
        $('input#totalSum').blur(function() {
            var amt = parseFloat(this.value);
            $(this).val('' + amt.toFixed(2));
        });
    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T00:10:58.927

这不是一个错误。确保将您的输入默认为`0`，否则`parseFloat`将尝试解析返回的空字符串`NaN`（不是数字）。您可以通过`value="0"`为输入设置属性来执行此操作，或者执行以下操作：

```
var sum1 = parseFloat($('input[name=sum1]').val(), 10)  || 0; 
```

这是一个演示这个概念的小提琴：http: [//jsfiddle.net/fqfyL/](http://jsfiddle.net/fqfyL/)

另一方面，您可以通过迭代输入来大大简化逻辑，而不必为每个输入编写一行代码。这是另一个演示该概念的小提琴：http: [//jsfiddle.net/fqfyL/1/](http://jsfiddle.net/fqfyL/1/)

最后，我不确定您使用的是哪个“jQuery 计算器插件”（大约只有无数个），但我在任一小提琴中发布的代码都没有使用插件。这一切都只是简单的 jQuery/JavaScript。如果您的“jQuery 计算器插件”仍有问题，请发布指向作者网站的链接，以便我们知道哪个可以帮助您。

# networking - 在交替比特协议中，为什么我们需要一个确认号和一个序列号？

> ID：13040728
> 
> 赞同：0
> 
> 时间：2012-10-23T23:13:12.073
> 
> 标签：networking, wait

在课堂上，我们正在学习可靠数据传输的原则。当我们检查交替比特协议时，我们了解到该段有一个类型字段（seq 或 ack）、一个序列号和一个确认号字段。我想知道同时拥有序列号和确认号的目的是什么？难道我们不能只有一个字段是序列号，除非类型字段表示一个确认，然后我们知道这个数字是一个确认号吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T21:07:33.617

序列号用于传出数据包；确认号确认传入数据包的序列号。

# php - 带有 zend 的资产抓取器，大文件仅下载为 229 或 228 字节

> ID：13040731
> 
> 赞同：0
> 
> 时间：2012-10-23T23:13:18.230
> 
> 标签：php, windows, apache, zend-framework

我的服务器有以下问题，有很多变量在起作用。所以这就是发生的事情。当我在 fedora 的桌面上使用 zend 开发一个小型 web 应用程序时，一切都运行良好。然后我将应用程序传输到 Dreamhost 上的服务器，一切正常。
所以问题出现在需要中国服务器的客户端上，因为他们位于强大的防火墙后面，他们希望更快地传输文件。他们有巨大的文件，大约 3.4 GB。所以他们给了我windows 2003机器虚拟机，他们不能把它换成linux，那就是一切都在螺旋式下降的时候。

基本上，我的应用程序在 documentroot 之外有一个文件夹，所有文件都将通过 ftp 上传。我的应用程序读取文件，只允许登录用户下载文件。

这是我的插件 - 控制器

```
<?php

class Mapache_Controller_Plugin_AssetGrabber
 extends Zend_Controller_Plugin_Abstract
{

    public function dispatchLoopStartup (Zend_Controller_Request_Abstract $request)
    {
        if ($request->getControllerName() != 'assets')
            return;

        $auth = Zend_Auth::getInstance();
        if (!$auth->hasIdentity()) 
            throw new Exception('Not authenticated!');

        //$file = APPLICATION_PATH . '/../assets/' . $request->getActionName();
        $file = APPLICATION_PATH . '/..' . $_SERVER['REQUEST_URI'];

        $file = str_replace("_", " ", $file);
//      echo $file;
        if (file_exists($file)) {
            header("Content-type: ".$this->new_mime_content_type($file));
            header('Content-disposition: attachment;');
            //header('Content-type: '.$this->new_mime_content_type($file));
            //readfile('$file');
            echo file_get_contents($file);
        }
    }

    function new_mime_content_type($filename){
        $result = new finfo();

        if (is_resource($result) === true){
            return $result->file($filename, FILEINFO_MIME_TYPE);
        }

        return false;
    }

} 
```

我为它在 Windows 上工作所做的唯一更改是添加 $file="d:/"。$_SERVER['REQUEST_URI'];，所以它知道在服务器的 D: 驱动器上查找。

所以基本上我有另一个 php 文件，它执行 scandir 并列出所有文件和目录并创建指向 URL/assets/folder/file 的链接，即使有大文件，它也可以在我的测试服务器上正常工作。但是当我尝试从 Windows 服务器下载 200 mb 的 zip 文件时，我得到一个 228 或 229 字节的损坏的 zip 文件，就像标题一样。
服务器安装了 zend 的 xammp，我快疯了。

迁移回我的 Dreamhost 服务器需要几天时间，我在服务器上安装了一个 rsync 客户端并开始复制文件，但在最后 4 个中它只有 400mb 的副本，所以我的 30 Gb 数据需要几天时间。

当我使用 rdesktop 登录服务器并尝试下载文件时，我仍然得到 228 字节的文件，而不是 200mb 甚至 3.4Gb。它有 Windows 2003。
我是否必须在 apache 服务器上配置一些东西，在 httpd.conf 或 php.ini 上配置一些东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T14:38:25.637

I found the answer, I need to properly download the file

```
header('Content-Disposition: attachment;filename="'.basename($file).'"');
                        header('Content-Description: File Transfer');
                        //header('Content-Type: application/octet-stream');
                        header('Content-type: '.$this->new_mime_content_type($file));
                        header('Content-Disposition: attachment; filename='.basename($file));
                        header('Content-Transfer-Encoding: binary');
                        header('Expires: 0');
                        header('Cache-Control: must-revalidate');
                        header('Pragma: public');
                        header('Content-Length: ' . filesize($file));
                        set_time_limit(0);
                        $filex = @fopen($file,"rb");
                        while(!feof($filex))
                        {
                                print(@fread($filex, 1024*8));
                                ob_flush();
                                flush();
                        }

                        //ob_clean();
                        //flush();
                        //readfile($file); 
```

# visual-studio - 跳过函数输入参数的复制构造函数的调试？

> ID：13040733
> 
> 赞同：5
> 
> 时间：2012-10-23T23:13:29.137
> 
> 标签：visual-studio, debugging, visual-c++

当一个人进入带有多个输入参数的调试函数时，进入和离开每个输入参数的复制构造函数是相当浪费时间的。通常情况下，这些复制构造函数是微不足道的（增加引用计数器），开发人员真正想要的是“直接进入*函数*”，并跳过输入参数创建的调试，无论是对复制 ctor 的调用，或调用创建参数对象实例的函数。

**在 Visual Studio 中有没有办法以这种方式配置调试，以避免调试参数的构造/复制构造并直接进入函数体？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T23:17:47.760

Visual Studio 10 或更高版本中的 alt-shift-F11 会显示将调用的所有函数的列表，您可以选择要直接转到的函数。我发现这非常有用，但不确定您使用的是 VS10 还是早期版本。

# android - youtube 视频在任何密度设置为 false 的 Webview 中不起作用

> ID：13040736
> 
> 赞同：0
> 
> 时间：2012-10-23T23:13:46.640
> 
> 标签：android

在 jelly beans android 设备（我相信也是 ICS）上，android WebView 内框架中的 youtube 视频在我们的应用程序中停止工作数周前：没有视频（黑屏），但可以听到声音并看到视频控件。我终于找到了一条关于是什么阻止它们工作的线索。似乎需要在清单中设置以下内容才能使视频正常工作：

```
android:targetSdkVersion="8"
android:hardwareAccelerated="true"
supports-screens android:anyDensity="false" 
```

另外，在我们单击全屏 youtube 按钮后，视频可以正常工作（但我不想使用全屏）。

1）和2）对我们来说不是问题，我们可以在清单中设置它们（但我想知道为什么需要硬件加速）。但是3）我们不能（出于不同的原因）。

有谁知道为什么 anyDensity 设置为假休息视频以及是否有任何解决方法？

有关重现问题的 apk 的一些信息： apk 是使用 清单的
android 3.0密钥提取构建的：

```
<uses-sdk android:minSdkVersion="1" android:targetSdkVersion="8"/>
<!-- android:hardwareAccelerated="true" -->
<application android:icon="@drawable/icon" android:label="@string/app_name" android:hardwareAccelerated="true">
    <activity android:name=".TestHTML5WebView"
              android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

</application>

<supports-screens android:anyDensity="false"/>

... 
```

用于 youtube 视频的 html 代码：

```
<!DOCTYPE html>
<html>
<head>
<title>Test</title>
<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, target-densityDpi=device-dpi"/>

<script type="text/javascript" charset="utf-8">
            window.onerror = function(errorMsg) {
                    try {
                            alert(errorMsg);
                    }
                    catch(err) {
                            alert('An expected error occurred. please try again later!');
                    }
            }
</script>

<style type="text/css" media="screen">
            body {
                    background: #000;
                    margin: 0;
                    padding: 0;
            }

            .video1 {
                    width: 90%;
                    height: 90%;
                    margin: 0 auto;
            }
</style>
</head>
<body>
    <div class="video1">
            <iframe width="560" height="315" src="http://www.youtube.com/embed/hH9Kx06oO_0" frameborder="0" allowfullscreen></iframe>
    </div>
</body>
</html> 
```

要重现该问题，您可以使用[http://code.google.com/p/html5webview/source/checkout](http://code.google.com/p/html5webview/source/checkout)中的源代码（只需确保使用本文顶部指示的值更新 manifest.xml， targetSdkVersion、hardwareAccelerated、android:anyDensity）。

谢谢。

洛朗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T09:56:28.220

Youtube 最近发布的安卓播放器：

[https://developers.google.com/youtube/android/player/](https://developers.google.com/youtube/android/player/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T20:42:20.653

对于嵌入式视频，应用程序需要表面纹理类。这需要将 android:hardwareAccelerated="true" 设置为 true。根据[http://developer.android.com/guide/topics/manifest/supports-screens-element.html](http://developer.android.com/guide/topics/manifest/supports-screens-element.html)， android:anyDensity="false" 不应设置为 false。全屏视频使用surfaceview，surfaceview对硬件加速没有要求。

# python - 如何在 python 中创建自己的数据类型以便覆盖算术运算符？

> ID：13040738
> 
> 赞同：5
> 
> 时间：2012-10-23T23:14:15.703
> 
> 标签：python, numpy, gps, latitude-longitude, user-defined-types

我目前正在使用 Python/Numpy 处理地理/GPS 数据（喜欢它！），并且我面临着计算由坐标对定义的地理点之间的距离的重复任务`pn = [lon, lat]`。

我有一个这样使用的函数：`dist = geodistance(p1, p2)`它类似于线性代数中的欧几里得距离（向量减法/差），但发生在测地线（球形）空间而不是矩形欧几里得空间中。

以编程方式，欧几里得距离由下式给出

```
dist = ((p2[0] - p1[0])**2 + (p2[1] - p1[1])**2)**0.5 
```

在数学上，这相当于“惯用的”（因为没有更好的词）句子

```
dist = p1 - p1   # the "norm" of the vector difference, subtraction. 
```

目前，我的距离是这样的：

```
p1 = [-51.598354,-29.953363]
p2 = [-51.598701,-29.953045]
dist = geodistance(p1, p2)
print dist

>> 44.3904032407 
```

我想这样做：

```
print p2 - p1  # these points now are from some fancy datatype

>> 44.3904032407 
```

以及最终目标：

```
track = numpy.array([[-51.203018 -29.996149]
                     [-51.203018 -29.99625 ]
                     [-51.20266  -29.996229]
                     [-51.20229  -29.996309]
                     [-51.201519 -29.99416 ]], dtype=fancy)  # (**) or something like

print numpy.diff(track)

>> ndarray([[   0\.        ]
            [   7.03531252]
            [  39.82663316]
            [  41.50958596]
            [ 172.49825765]]) 
```

类似的事情是：如果您将两个`datetime`对象相减，则该操作返回一个`timedelta`对象。我想减去两个坐标并得到一个测地距离作为结果。

我想知道一个类是否可以工作，但是 dtype（例如 float32 的“子类型”）对从列表创建数组有很大帮助（** 这是我从 xml 文件中读取内容的方式）。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:27:38.807

Python 语言参考，第 3.4.8 节，[“模拟数字类型”](http://docs.python.org/reference/datamodel.html#emulating-numeric-types)

具体来说，`__sub__()`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-23T23:32:00.757

`__add__`您可以通过创建类并编写or`__sub__`方法来定义自己的类型。

例如：

```
class P(object):
    def __init__(self, lon, lat):
        self.lon = lon
        self.lat = lat

    def __sub__(self, other):
        dist = ((other.lon - self.lon)**2 + (other.lat - self.lat)**2)**0.5
        return dist 
```

鉴于您当前正在使用列表索引语法获取点的坐标，您还可以实现这些：

```
class P(object):
    def __init__(self, lon, lat):
        self.lon = lon
        self.lat = lat

    def __sub__(self, other):
        dist = ((other[0] - self[0])**2 + (other[1] - self[1])**2)**0.5
        return dist

    def __getitem__(self, key):
        if key == 0:
            return self.lon
        elif key == 1:
            return self.lat
        else:
            raise IndexError

    def __setitem__(self, key, value):
        if key == 0:
            self.lon = value
        elif key == 1:
            self.lat = value
        else:
            raise IndexError 
```

（我意识到上述可能不是最优雅的方式）。

这样，您的新课程就可以替代您当前使用的列表。

[Python 文档](http://docs.python.org/reference/datamodel.html)包含有关创建用户定义类型所需编写的双下划线方法的更多信息。（您要查找的信息大约从页面的一半开始）

# java - Heroku 上的 Java TCP/UDP 服务器和客户端

> ID：13040742
> 
> 赞同：1
> 
> 时间：2012-10-23T23:15:07.263
> 
> 标签：java, rest, heroku, tcp, udp

我是 Heroku 的新手，我正在考虑构建一个 java RESTful Web 服务，它可以启动 TCP/UDP 服务器/客户端来处理基于 RESTful 调用的数据流。又名，RESTful 调用是为流数据创建 TCP/UDP 服务器的触发器。那可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T23:13:57.840

Heroku 只能处理 HTTP 上的流量。我对您的用例并不完全清楚，但是如果您希望启动的服务器处理传入的 UDP 流量，那么您将无法在 Heroku 上执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-01-03T07:33:52.867

这个答案是在提出问题很久之后才出现的，但我可以确认今天你可以在 Heroku 上托管一个 UDP 服务器，刚刚构建了一个概念证明 Node WebRTC 应用程序。

# regex - haproxy ACL 正则表达式和逻辑或

> ID：13040744
> 
> 赞同：1
> 
> 时间：2012-10-23T23:15:33.193
> 
> 标签：regex, haproxy

如果我有`/q/a/1234`or `/q/b/456`or`/q/c/987`和`/q/x/abc`or形式的 URL `/q/y/3455`。

我想将表单的任何 URL 路由，`/q/[a|b|c]/.*`即任何用于队列 a 或 b 或 c 的内容到一个后端，以及任何用于`/q/[x|y]/.*` 不同后端的内容，我将如何实现这一点？

我尝试过：

```
acl use_server_1 path_reg /a|b|c/
use backend server1 if user_server_1

acl use_server_2 path_reg /x|y/
use backend server2 if user_server_2 
```

这与路线不正确匹配....有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-03-07T05:33:39.803

您有语法错误。您将正则表达式定义为`use_server_1`and `use_server_2`，但您的“使用”语句正在尝试与`useR_server_1`and进行比较`useR_server_2`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T08:59:25.377

尝试这个：

```
acl use_server_1 path_reg ^/q/[abc]/?.*$
use backend server1 if use_server_1

acl use_server_2 path_reg ^/q/[xy]/?.*$
use backend server2 if use_server_2 
```

# mysql - 带有否定和/或多个条件的mysql一对多查询

> ID：13040746
> 
> 赞同：5
> 
> 时间：2012-10-23T23:15:34.270
> 
> 标签：mysql, database, relational-database, one-to-many

由于关系数据库的性质，我认为这样的查询会很容易，但它似乎让我很合适。我也四处搜寻，但没有发现任何真正有帮助的东西。情况如下：

假设我对产品和产品标签有一个简单的关系。这是一对多的关系，所以我们可以有以下内容：

```
productid  |  tag
========================
1          |  Car
1          |  Black
1          |  Ford
2          |  Car
2          |  Red
2          |  Ford
3          |  Car
3          |  Black
3          |  Lexus
4          |  Motorcycle
4          |  Black
5          |  Skateboard
5          |  Black
6          |  Skateboard
6          |  Green 
```

查询 all的**最有效**`(Ford OR Black OR Skateboard) AND NOT (Motorcycles OR Green)`方法是什么？我需要做的另一个查询是 all `(Car) or (Skateboard) or (Green AND Motorcycle) or (Red AND Motorcycle)`。

products 表中有大约 150k 条记录，tags 表中有 600k 条记录，因此查询需要尽可能高效。这是我一直在搞乱的一个查询（示例＃1），但它似乎需要大约 4 秒左右。任何帮助将非常感激。

```
SELECT p.productid
FROM   products p
       JOIN producttags tag1 USING (productid)
WHERE  p.active = 1
       AND tag1.tag IN ( 'Ford', 'Black', 'Skatebaord' )
       AND p.productid NOT IN (SELECT productid
                               FROM   producttags
                               WHERE  tag IN ( 'Motorcycle', 'Green' )); 
```

# 更新

到目前为止我发现的最快的查询是这样的。它需要 100-200 毫秒，但它看起来非常不灵活和丑陋。基本上我会抓住所有匹配`Ford`,`Black`或的产品`Skateboard`。他们我将这些匹配产品的所有标签连接到一个冒号分隔的字符串中，并删除所有与`:Green:`AND匹配的产品`:Motorcycle:`。有什么想法吗？

```
SELECT p.productid,
       Concat(':', Group_concat(alltags.tag SEPARATOR ':'), ':') AS taglist
FROM   products p
       JOIN producttags tag1 USING (productid)
       JOIN producttags alltags USING (productid)
WHERE  p.active = 1
       AND tag1.tag IN ( 'Ford', 'Black', 'Skateboard' )
GROUP  BY tag1.productid
HAVING ( taglist NOT LIKE '%:Motorcycle:%'
         AND taglist NOT LIKE '%:Green:%' ); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-29T22:06:17.617

我会编写没有子查询的排除连接：

```
SELECT p.productid
FROM   products p
INNER JOIN producttags AS t ON p.productid = t.productid
LEFT OUTER JOIN producttags AS x ON p.productid = x.productid 
       AND x.tag IN ('Motorcycle', 'Green')
WHERE  p.active = 1
       AND t.tag IN ( 'Ford', 'Black', 'Skateboard' )
       AND x.productid IS NULL; 
```

确保您按该顺序在两列（活动，productid）上具有产品索引。

您还应该按该顺序在两列（productid、tag）上的 producttags 上建立索引。

*我需要做的另一个查询是 all (Car) or (Skateboard) or (Green AND Motorcycle) or (Red AND Motorcycle)。*

有时这些复杂的条件对于 MySQL 优化器来说是困难的。一种常见的解决方法是使用 UNION 来组合更简单的查询：

```
SELECT p.productid
FROM   products p
INNER JOIN producttags AS t1 ON p.productid = t1.productid
WHERE  p.active = 1
   AND t1.tag IN ('Car', 'Skateboard')

UNION ALL

SELECT p.productid
FROM   products p
INNER JOIN producttags AS t1 ON p.productid = t1.productid
INNER JOIN producttags AS t2 ON p.productid = t2.productid 
WHERE  p.active = 1
   AND t1.tag IN ('Motorcycle')
   AND t2.tag IN ('Green', 'Red'); 
```

PS：您的标记表不是实体-属性-值表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-26T02:11:54.547

我将获取所有唯一 ID 匹配项和要过滤掉的唯一 ID，然后 LEFT JOIN 那些列表（根据tigeryan）并过滤掉任何匹配的 ID。通过将所有查询分开，查询也应该更易于阅读和修改。它也应该相当快，尽管它可能看起来不像。

```
SELECT * FROM products p
WHERE 
p.active=1 AND
productid IN (
SELECT matches.productid FROM (
  SELECT DISTINCT productid FROM producttags 
  WHERE tag IN ('Ford','Green','Skatebaord')
) AS matches
LEFT JOIN (
  SELECT DISTINCT productid FROM producttags 
  WHERE tag IN ('Motorcycles','Green')
) AS filter ON filter.productid=matches.productid
WHERE filter.productid IS NULL
) 
```

有时 JOIN 比 IN 快，这取决于 mysql 如何优化查询：

```
SELECT p.* FROM (
SELECT matches.productid FROM (
  SELECT DISTINCT productid FROM producttags 
  WHERE tag IN ('Ford','Green','Skatebaord')
) AS matches
LEFT JOIN (
  SELECT DISTINCT productid FROM producttags 
  WHERE tag IN ('Motorcycles','Green')
) AS filter ON filter.productid=matches.productid
WHERE filter.productid IS NULL
) AS idfilter
    JOIN products p ON p.productid=idfilter.productid AND p.active=1 
```

第二个查询应该强制连接顺序，因为必须首先完成内部选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T02:49:43.577

我通常会通过尝试消除来自...的记录来解决这个问题

```
select p.productid 
from product p 
left join producttags tag1 
    on p.productid = tag1.productid and tag1.tag NOT IN ('Motorcycles','Green')
where tag1.tag IN ('Ford','Black','Skateboard') and p.active = 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-29T21:57:39.630

这个如何：

```
SELECT DISTINCT p.id FROM products AS p
JOIN producttags AS included ON (
    included.productid = p.id
    AND included.tag IN ('Ford', 'Black', 'Skatebaord') 
)
WHERE active = 1
AND p.id NOT IN (
    SELECT DISTINCT productid FROM producttags
    WHERE tag IN ('Motorcycle', 'Green')
) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-03-23T16:15:07.903

CONCAT/LIKE 解决方案的替代方案：

```
SELECT p.productid
FROM products p
JOIN producttags USING (productid)
WHERE p.active = 1
AND tag IN ('Ford', 'Black', 'Skateboard')
GROUP BY p.productid
HAVING SUM(IF(tag IN ('Motorcycle','Green'), 1, 0)) = 0; 
```

# java - 在框架调整大小 Java 上调整组件大小

> ID：13040747
> 
> 赞同：3
> 
> 时间：2012-10-23T23:15:37.077
> 
> 标签：java, swing, user-interface, resize, gridbaglayout

当我调整 GUI 大小时，我在尝试调整 GUI 中的组件大小时遇到​​了一些麻烦。现在，当我调整 GUI 大小时，组件的大小不会改变，它们保持我设置的静态大小。当我调整 GUI 的大小通过显示它们所需的最小尺寸时，它们不再显示。我希望他们在调整 GUI 大小时调整大小并保持纵横比。

这是我的 GUI 代码：

```
import java.applet.*;
import java.awt.*;
import java.awt.event.*;
import java.awt.image.BufferedImage;
import java.awt.image.ImageObserver;
import java.io.*;
import java.net.*;

import javax.imageio.ImageIO;
import javax.swing.*;
import javax.swing.border.Border;
import javax.swing.text.*;
import javax.swing.text.html.*;

public class DraftGUI implements MouseListener {

private JPanel jpPack;
private JPanel jpCards;
private JPanel jpInfo;
private JPanel jpChat;
private TextField tf;
private StyledDocument doc;
private JTextPane tp;
private JScrollPane sp;

public void mousePressed(MouseEvent e) {
}

public void mouseReleased(MouseEvent e) {
}

public void mouseEntered(MouseEvent e) {
    }

    public void mouseExited(MouseEvent e) {
    }

public void mouseClicked(MouseEvent e) {
    e.getComponent().setVisible(false);
}

private Client client;

public GUI(Client client) throws IOException {

    JFrame frame = new JFrame("Draft");

    //set the size to fullscreen to start
    frame.setSize(Toolkit.getDefaultToolkit().getScreenSize().width, Toolkit.getDefaultToolkit().getScreenSize().height);

    //set the content pane, we'll add everything to it and then add it to the frame
    JPanel contentPane = new JPanel();
    contentPane.setSize(Toolkit.getDefaultToolkit().getScreenSize().width, Toolkit.getDefaultToolkit().getScreenSize().height);
    contentPane.setLayout(new GridBagLayout());

    //creates some panels with some default values for now
    JPanel jpCards = new JPanel(new BorderLayout());
    jpCards.setOpaque(true); //ensures it paints every pixel
    jpCards.setBackground(Color.BLUE);

    JPanel jpInfo = new JPanel();
    jpInfo.setOpaque(true);
    jpInfo.setBackground(Color.GREEN);

    JPanel jpPack = new JPanel(new GridBagLayout());
    jpPack.setOpaque(true);
    jpPack.setBackground(Color.RED);

    //grab some info to make the JTextPane and make it scroll
    this.client = client;
    tf = new TextField();
    doc = new DefaultStyledDocument();
    tp = new JTextPane(doc);
    tp.setEditable(false);
    tf.addActionListener(this.client);
    sp = new JScrollPane(tp);

    //adding the quantities to the chat panel
    JPanel jpChat = new JPanel();
    jpChat.setLayout(new BorderLayout());
    jpChat.add("North", tf);
    jpChat.add("Center", sp);

    //a new GridBagConstraints used to set the properties/location of the panels
    GridBagConstraints c = new GridBagConstraints(); 

    //adding some panels to the content pane
    //set it to start from the top left of the quadrant if it's too small
    c.anchor = GridBagConstraints.FIRST_LINE_START; 
    c.fill = GridBagConstraints.BOTH; //set it to fill both vertically and horizontally
    c.gridx = 0; //set it to quadrant x=0 and
    c.gridy = 0; //set it to quadrant y=0
    c.weightx = 0.7;
    c.weighty = 0.3;
    contentPane.add(jpCards, c);

    c.gridx = 1;
    c.gridy = 0;
    c.weightx = 0.3;
    c.weighty = 0.3;
    contentPane.add(jpInfo, c);

    c.gridx = 0;
    c.gridy = 1;
    c.weightx = 0.7;
    c.weighty = 0.7;
    contentPane.add(jpPack, c);

    c.gridx = 1;
    c.gridy = 1;
    c.weightx = 0.3;
    c.weighty = 0.7;
    contentPane.add(jpChat, c);

    //set some necessary values 
    frame.setContentPane(contentPane);
    frame.setLocationByPlatform(true);
    frame.setVisible(true);

    //This code works for adding an Image
    //need to learn how to specify a path not dependent on the specific users's machine
    //this is not a high priority for now though
    GridBagConstraints d = new GridBagConstraints();
    d.gridx = 0;
    d.gridy = 0;

    ImageLabel imageLabel1 = new ImageLabel("path-to-file");

    imageLabel1.setPreferredSize(new Dimension(223, 310));
    jpPack.add(imageLabel1, d);

    ImageLabel imageLabel2 = new ImageLabel("path-to-file");
    imageLabel2.setPreferredSize(new Dimension(223, 310));
    ImageLabel imageLabel3 = new ImageLabel("path-to-file");
    imageLabel3.setPreferredSize(new Dimension(223, 310));
    d.gridx = 1;
    jpPack.add(imageLabel2, d);
    d.gridy = 1;
    jpPack.add(imageLabel3, d);

    imageLabel1.addMouseListener(this);
    imageLabel2.addMouseListener(this);
    imageLabel3.addMouseListener(this);

    //223, 310 are the aspect values for a card image, width, height
    //these need to be maintained as the GUI size changes

    }

}

class ImageLabel extends JLabel {
   Image image;
   ImageObserver imageObserver; 

   // constructor with filename     
   ImageLabel(String filename) {
      ImageIcon icon = new ImageIcon(filename);
      image = icon.getImage();
      imageObserver = icon.getImageObserver();
   }

   // constructor with icon
   ImageLabel(ImageIcon icon) {
      image = icon.getImage();
      imageObserver = icon.getImageObserver();
   }

   // overload setIcon method
   void setIcon(ImageIcon icon) {
      image = icon.getImage();
      imageObserver = icon.getImageObserver();
   }

   // overload paint()
   public void paint( Graphics g ) {
       super.paint( g );
       g.drawImage(image,  0 , 0 , getWidth() , getHeight() , imageObserver);

   }

} 
```

出于某种原因，框架组件没有默认的调整大小属性，因此当框架调整大小时，组件不会做任何事情。我不确定我做错了什么或错过了什么，但显然我遗漏了一些东西。

另外，如果有人知道的话，ImageLabels 会占用它们周围的额外空间。默认情况下，填充设置为 0，所以我不确定为什么它会像围绕它们的边框一样创建。

谢谢。

纪尧姆的编辑：

我知道如果我想将它作为独立运行它是必要的，它当前是另一个应用程序的一部分，并且在它内部被单独调用。为了完整起见，在没有 main 的情况下发布它可能不是最好的决定，但无论如何，这不是什么大问题。

您的代码取出了实际显示图片的部分。“路径到文件”应该被实际的图像文件路径替换，因此您将显示图像。当它只是文本时，很难真正看到手头的问题。

当您正确显示图像并尝试调整整个 GUI 的大小时，您会注意到图像没有缩小。它保持其首选大小，并且当它变得小于它时会出现问题。在我的代码中，当它至少不能显示首选尺寸时，它会完全停止显示图片。在您的代码中，它会在缩小时切断部分图片。

我想要的是它实际调整包含图片的 JLabel 的大小，以便 GUI 调整大小时，图像也会调整大小。对于我的程序，图像有必要相应地缩小。用户最终将获得基于单击图像的功能，因此仅显示某些图像或其中的一部分根本行不通。

请再次尝试您的代码/我的代码并重现我遇到的问题，用图片进行测试，以便我们找到正确的解决方案。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T07:27:36.520

1.  `JFrame.setVisible(true)`应该是您调用的最后一行。
2.  `GridBagLayout`可以根据框架大小调整组件的大小，只要您使用`weightx/weighty`和`fill`

更新：

1.  忘记设置首选大小，这只是在解决 GUI 问题
2.  如果您使用 LayoutManager（这是一个非常好的主意），忘记调用 setSize()/setBounds()/setLocation()，LayoutManager 无论如何都会覆盖它们
3.  您需要注意调整图像大小以保持原始图像比例
4.  如果你使用 weightx/weighty，你也应该使用`anchor`和/或`fill`
5.  用于`frame.pack()`正确调整框架的大小
6.  用于`setExtendedState()`最大化框架

顺便说一句，[SSCCE](http://sscce.org)意味着您为其他人制作了一个可运行的示例，这包括将图像的本地路径更改为在线 URL（参见下面的示例）。

使用以下代码段，一切似乎都正常：

```
import java.awt.BorderLayout;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;
import java.awt.TextField;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.net.MalformedURLException;
import java.net.URL;

import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextPane;
import javax.swing.SwingUtilities;
import javax.swing.text.DefaultStyledDocument;
import javax.swing.text.StyledDocument;

public class DraftGUI implements MouseListener {

    private static final String IMAGE_URL = "http://images.paramountbusinessjets.com/space/spaceshuttle.jpg";
    private JPanel jpPack;
    private JPanel jpCards;
    private JPanel jpInfo;
    private JPanel jpChat;
    private TextField tf;
    private StyledDocument doc;
    private JTextPane tp;
    private JScrollPane sp;

    @Override
    public void mousePressed(MouseEvent e) {
    }

    @Override
    public void mouseReleased(MouseEvent e) {
    }

    @Override
    public void mouseEntered(MouseEvent e) {
    }

    @Override
    public void mouseExited(MouseEvent e) {
    }

    @Override
    public void mouseClicked(MouseEvent e) {
    }

    public DraftGUI() throws MalformedURLException {

        final JFrame frame = new JFrame("Draft");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        // set the content pane, we'll add everything to it and then add it to the frame
        JPanel contentPane = new JPanel();
        contentPane.setLayout(new GridBagLayout());

        // creates some panels with some default values for now
        JPanel jpCards = new JPanel(new BorderLayout());
        jpCards.setBackground(Color.BLUE);

        JPanel jpInfo = new JPanel();
        jpInfo.setBackground(Color.GREEN);

        JPanel jpPack = new JPanel(new GridBagLayout());
        jpPack.setBackground(Color.RED);

        // grab some info to make the JTextPane and make it scroll
        tf = new TextField();
        doc = new DefaultStyledDocument();
        tp = new JTextPane(doc);
        tp.setEditable(false);
        sp = new JScrollPane(tp);

        // adding the quantities to the chat panel
        JPanel jpChat = new JPanel();
        jpChat.setLayout(new BorderLayout());
        jpChat.add("North", tf);
        jpChat.add("Center", sp);

        // a new GridBagConstraints used to set the properties/location of the panels
        GridBagConstraints c = new GridBagConstraints();

        // adding some panels to the content pane
        // set it to start from the top left of the quadrant if it's too small
        c.anchor = GridBagConstraints.FIRST_LINE_START;
        c.fill = GridBagConstraints.BOTH; // set it to fill both vertically and horizontally
        c.gridx = 0; // set it to quadrant x=0 and
        c.gridy = 0; // set it to quadrant y=0
        c.weightx = 0.7;
        c.weighty = 0.3;
        contentPane.add(jpCards, c);

        c.gridx = 1;
        c.gridy = 0;
        c.weightx = 0.3;
        c.weighty = 0.3;
        contentPane.add(jpInfo, c);

        c.gridx = 0;
        c.gridy = 1;
        c.weightx = 0.7;
        c.weighty = 0.7;
        contentPane.add(jpPack, c);

        c.gridx = 1;
        c.gridy = 1;
        c.weightx = 0.3;
        c.weighty = 0.7;
        contentPane.add(jpChat, c);

        // set some necessary values
        frame.setContentPane(contentPane);
        frame.setLocationByPlatform(true);

        // This code works for adding an Image
        // need to learn how to specify a path not dependent on the specific users's machine
        // this is not a high priority for now though
        GridBagConstraints d = new GridBagConstraints();
        d.weightx = 1.0;
        d.weighty = 1.0;
        d.fill = GridBagConstraints.BOTH;
        d.gridx = 0;
        d.gridy = 0;
        ImageLabel imageLabel1 = new ImageLabel(new ImageIcon(new URL(IMAGE_URL)));
        jpPack.add(imageLabel1, d);
        ImageLabel imageLabel2 = new ImageLabel(new ImageIcon(new URL(IMAGE_URL)));
        d.gridx++;
        jpPack.add(imageLabel2, d);

        ImageLabel imageLabel3 = new ImageLabel(new ImageIcon(new URL(IMAGE_URL)));
        d.gridy++;
        jpPack.add(imageLabel3, d);

        imageLabel1.addMouseListener(this);
        imageLabel2.addMouseListener(this);
        imageLabel3.addMouseListener(this);
        frame.pack();
        // 223, 310 are the aspect values for a card image, width, height
        // these need to be maintained as the GUI size changes
            frame.setExtendedState(frame.getExtendedState() | JFrame.MAXIMIZED_BOTH);
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    new DraftGUI();
                } catch (MalformedURLException e) {
                    e.printStackTrace();
                }
            }
        });
    }

    public static class ImageLabel extends JPanel {
        private static int counter = 1;
        private ImageIcon icon;
        private int id = counter++;

        public ImageLabel(ImageIcon icon) {
            super();
            setOpaque(false);
            this.icon = icon;
        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(icon.getIconWidth(), icon.getIconHeight());
        }

        @Override
        protected void paintComponent(Graphics g) {
            super.paintComponent(g);
            double zoom = Math.min((double) getWidth() / icon.getIconWidth(), (double) getHeight() / icon.getIconHeight());
            int width = (int) (zoom * icon.getIconWidth());
            int height = (int) (zoom * icon.getIconHeight());
            g.drawImage(icon.getImage(), (getWidth() - width) / 2, (getHeight() - height) / 2, width, height, this);
            g.setFont(g.getFont().deriveFont(36.0f));
            g.drawString(String.valueOf(id), getWidth() / 2, getHeight() / 2);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-23T21:59:28.623

我建议这种方式来调整窗口的内容

```
JPanel jPanel = new JPanel(new BorderLayout()); // Create a panel that contains the elements you want to resize, in this example I use BorderLayout as the layout manager
jPanel.add(somePanel, BorderLayout.NORTH);
        // this will resize the con
        this.addComponentListener(new ComponentAdapter() {
            @Override
            public void componentResized(ComponentEvent e) {
                somePanel.setSize(e.getComponent().getSize());
                jPanel.paintComponents(getGraphics());
            }
        }); 
```

# performance - WebSockets、UDP 和基准测试

> ID：13040752
> 
> 赞同：70
> 
> 时间：2012-10-23T23:16:12.190
> 
> 标签：performance, html, udp, websocket

HTML5 websockets 当前使用一种 TCP 通信形式。然而，对于实时游戏来说，TCP 就无法解决问题（这也是使用其他平台的一个很好的理由，比如原生平台）。因为我可能需要 UDP 来继续一个项目，所以我想知道 HTML6 的规范是否支持 UDP？

此外，是否有任何可靠的 WebSocket 基准可以将 WS 协议与低级直接套接字协议进行比较？

* * *

## 回答 #1

> 赞同：216
> 
> 时间：2012-10-24T07:26:34.910

在 LAN 上，您可以获得 200 微秒的 WebSocket 消息往返时间（从浏览器 JS 到 WebSocket 服务器并返回），这类似于原始 ICMP ping。在 MAN 上，大约 10 毫秒，WAN（通过住宅 ADSL 到同一国家的服务器）大约 30 毫秒，依此类推，通过 3.5G 达到大约 120-200 毫秒。关键是：基于网络，WebSocket 确实不会给你无论如何都会得到的延迟增加任何延迟。

WebSocket 的线路级开销（与原始 TCP 相比）在每条消息 2 个八位字节（长度 < 126 个八位字节的未屏蔽有效负载）和 14 个八位字节（长度 > 64k 的屏蔽有效负载）之间（前面的数字假设消息没有分段成多个WebSocket 帧）。非常低。

**有关 WebSocket 线级开销的更详细分析，请参阅此[博客文章](https://crossbario.com/blog/Dissecting-Websocket-Overhead/)**- 这也包括涵盖 WebSocket 之外的层的分析。

更重要的是：使用能够进行流处理的 WebSocket 实现，您可以（在初始 WebSocket 握手之后）在每个方向上启动单个 WebSocket 消息和帧，然后发送最多 2^63 个八位字节而完全没有开销。从本质上讲，这使 WebSocket 成为原始 TCP 的花哨前奏。警告：中介可能会根据自己的决定分割流量。但是，如果您运行 WSS（即安全的 WS = TLS），则没有中介可以干扰，您就是：原始 TCP，带有 HTTP 兼容的前奏（WS 握手）。

WebRTC 使用 RTP（= 基于 UDP）进行媒体传输，但还需要一个信令通道（可以是 WebSocket 即）。RTP 针对容损实时*媒体*传输进行了优化。“实时游戏”通常意味着传输的不是媒体，而是玩家位置等东西。WebSocket 将为此工作。

注意：WebRTC 传输可以通过 RTP 或通过 SRTP 进行保护。[请参阅此处](https://datatracker.ietf.org/doc/html/draft-ietf-rtcweb-rtp-usage-10)的“RTP 配置文件” 。

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2012-10-24T14:52:56.797

我建议在本地有线网络上使用 WebSockets 开发您的游戏，然后在 WebRTC 数据通道 API 可用后转移到它。正如@oberstet 正确指出的那样，WebSocket 平均延迟基本上相当于原始 TCP 或 UDP，尤其是在本地网络上，所以它应该适合您的开发阶段。WebRTC 数据通道 API 的设计与 WebSockets 非常相似（一旦建立连接），因此一旦广泛可用，集成应该相当简单。

您的问题暗示 UDP 可能是您想要的低延迟游戏，这是事实。自从您正在编写游戏时，您可能已经意识到这一点，但对于那些尚未意识到的人，这里有一个关于实时游戏的**TCP 与 UDP 的快速入门：**

TCP 是一种有序、可靠的传输机制，而 UDP 是尽力而为。TCP 将按照发送的顺序传递所有发送的数据。UDP 数据包在到达时发送，可能是无序的，并且可能有间隙（在拥塞的网络上，UDP 数据包在 TCP 数据包之前被丢弃）。TCP 听起来像是一个很大的改进，它适用于大多数类型的网络流量，但这些功能是有代价的：延迟或丢弃的数据包也会导致所有后续数据包延迟（以保证按顺序交付）。

实时游戏通常不能容忍 TCP 套接字可能导致的延迟类型，因此它们使用 UDP 处理大部分游戏流量，并具有处理丢失和乱序数据的机制（例如，将序列号添加到有效载荷数据）。如果您错过了敌方玩家的一次位置更新，这没什么大不了的，因为几毫秒后您会收到另一次位置更新（甚至可能不会注意到）。但是，如果您在 500 毫秒内没有获得位置更新，然后突然将它们全部取出一次，那将导致糟糕的游戏玩法。

话虽如此，在本地有线网络上，数据包几乎从不延迟或丢弃，因此 TCP 作为初始开发目标非常合适。一旦 WebRTC 数据通道 API 可用，您可能会考虑转向该 API。当前提案具有基于重试或计时器的可配置可靠性。

以下是一些参考资料：

*   [WebRTC简介](http://www.html5rocks.com/en/tutorials/webrtc/basics/)
*   [WebRTC 常见问题](http://www.webrtc.org/faq-recent-topics)
*   [WebRTC 数据通道提案](https://datatracker.ietf.org/doc/html/draft-jesup-rtcweb-data-protocol-03)

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-11-21T18:07:50.203

长话短说，如果你想在多人游戏中使用 TCP，你需要使用我们所说的*自适应流技术*。换句话说，您需要确保为在客户端之间同步游戏世界而发送的实时数据量由每个客户端当前可用的带宽和延迟控制。

动态节流、合并、增量传递和其他机制是自适应流技术，它们不会神奇地使 TCP 像 UDP 一样高效，但使其足以用于多种类型的游戏。

我试图在一篇文章中解释这些技术：**Optimizing Multiplayer 3D Game Synchronization Over the Web** ( [http://blog.lightstreamer.com/2013/10/optimizing-multiplayer-3d-game.html](http://blog.lightstreamer.com/2013/10/optimizing-multiplayer-3d-game.html) )。

上个月，我还在旧金山举行的**HTML5 开发者大会上就这个话题发表了演讲。**该视频刚刚在 YouTube 上发布：[http ://www.youtube.com/watch?v=cSEx3mhsoHg](http://www.youtube.com/watch?v=cSEx3mhsoHg)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-04-06T11:27:36.337

没有对 Websockets 的 UDP 支持（确实应该有），但是您显然可以使用 WebRTC 的 RTCDataChannel API 进行类似 UDP 的通信。这里有一篇很好的文章：

[http://www.html5rocks.com/en/tutorials/webrtc/datachannels/](http://www.html5rocks.com/en/tutorials/webrtc/datachannels/)

RTCDataChannel 实际上使用了具有可配置可靠性和有序交付的 SCTP。你可以让它像 UDP 一样工作，告诉它无序地传递消息，并将最大重传次数设置为 0。

我还没有尝试过这些。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-24T00:51:30.437

> 我想知道 HTML6 的规格是否支持 UDP？

WebSockets 不会。WebSockets 的好处之一是它[搭载了现有的 HTTP 连接](https://datatracker.ietf.org/doc/html/draft-ietf-hybi-thewebsocketprotocol-17#section-1.7)。这意味着对于代理和防火墙，WebSockets 看起来像 HTTP，因此它们不会被阻止。

[出于安全考虑](https://www.w3.org/Bugs/Public/show_bug.cgi?id=13322#c5)，任意 UDP 连接可能永远不会成为任何 Web 规范的一部分。最接近您所追求的东西可能会成为[WebRTC](http://www.w3.org/TR/webrtc/)的一部分，并且它是相关的[JSEP 协议](https://datatracker.ietf.org/doc/html/draft-ietf-rtcweb-jsep-02)。

> 是否有任何可靠的基准……将 WS 协议与低级的直接套接字协议进行比较？

不是我知道的。我将四处走动并预测 WebSockets 会更慢；）

# javascript - javascript / jquery - 获取并保存元素的初始 html 内容

> ID：13040763
> 
> 赞同：2
> 
> 时间：2012-10-23T23:16:38.840
> 
> 标签：javascript, jquery

这可能是非常基本的，但我正在拖延......

在页面加载时，我需要将元素的 html 内容保存到变量中。我在页面中有其他代码将更改元素的 html 内容。所以我需要能够将值恢复为默认值（页面加载时的值）。问题是我的变量值正在更改为最新值。

如何使分配给变量“stick”的初始值？

```
currentElementsHTML = $("#myDOMElement"),
currentElementsHTMLDefaultValue = currentElementsHTML.html()
... do stuff that changes currentElementsHTML 
... revert to currentElementsHTMLDefaultValue whenever i need to 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:44:59.557

有很多方法可以存储一些数据并在以后使用，其中一些需要了解 JavaScript 作用域的工作方式 - 其他的只是依赖 jQuery 方法。

## 首先想到的事情

### 全局变量

这样做的坏方法是将值存储为全局变量：

```
function at_the_start(){
   /// notice there is no var keyword, this means the variable will be global
   global_html = $('element').html();
}

function later_on(){
   $('element').html( global_html );
} 
```

你不应该这样做，因为你的数据会“污染全局命名空间”——这基本上意味着其他代码可以很容易地访问你的变量*（并弄乱它）*，并且你可能会无意中覆盖一些其他代码的全局数据——特别是如果您使用相当通用的变量名称。

### 局部变量保持在范围内

一个更好的方法是使用 JavaScript 的力量来实现自己的目的，即它的作用域能力，这里有一些好点要阅读—— [JavaScript 中变量的作用域是什么？](https://stackoverflow.com/questions/500431/javascript-variable-scope)：

```
function my_code(){

  var html = $('element').html();

  /* Do stuff here */

  $('element').html( html );

} 
```

以上依赖于一个局部变量以及您必须将所有内容保存在同一个函数调用中的事实。由于您很可能会依赖用户触发事件的混合，因此您不能真正使用上述内容。这是因为您将在不同的位置使用许多函数，并且它们不能都共享相同的局部变量。或者他们可以吗？

以下是我所说的“全局局部”变量——很可能不是它的真实名称，但它描述了我所看到的事物：

```
function my_code(){

  /// this variable is local, due to the var keyword
  /// but it will be accessible in both the functions below
  var html_local = '';

  var my_function_to_start = function(){
    html_local = $('element').html();
  }

  var after_other_things_have_happened = function(){
    $('element').html( html_local );
  }

  /// you can even apply these functions to say an event handler
  /// and the variable will be remembered because it exists within
  /// the "after_other_things_have_happened" function's scope.
  $('another.element').click(after_other_things_have_happened);

} 
```

上面的工作是因为 JavaScript 函数总是可以访问在以前的父块/父范围或父函数中定义的变量。

### jQuery 数据

考虑到您正在使用 jQuery，jQuery 提供了一种非常简单的方法来存储任意数据，您无需了解有关范围或本地和全局变量的任何信息。我花了一段时间来写这篇文章，所以很明显，此时其他海报已经正确地指出以下是一个好主意 - [jQuery Data](http://api.jquery.com/jQuery.data/ "jQuery 数据")：

```
$('element').data( 'old_html', $('element').html() ); 
```

然后可以随时使用以下命令访问它：

```
$('element').data( 'old_html' ); 
```

所以...

```
$('element').html( $('element').data( 'old_html' ) ); 
```

将值放回去 - 它与元素一起存储，因此无论您可以访问何处，都可以获取`$('element')`分配给它的数据。

## 其他一些不太相关的方式（但仍然是数据存储的方法）

### 作为对象的属性存储

有时，另一个有用的功能是 JavaScript 几乎将所有数据类型都视为对象。这意味着您可以为几乎任何东西添加属性。如果有点奇怪，以下实际上是很有可能的。

```
var a = new String('This is a string');
    a.withAProperty = 'another string';

alert(a);
alert(a.withAProperty); 
```

我偶尔会使用它在函数上创建伪静态属性，如下所示：

```
var my_function = function(){
  if ( ! my_function.staticProp ) {
    my_function.staticProp = 'abc';
  }
  /* use my_function.staticProp for something here */
}

var another_function(){
  /* you can also access my_function.staticProp here
     but only after my_function has been called once */
}

/* and my_function.staticProp here, but only 
   after my_function has been called once  */ 
```

这几乎与使用全局 var 具有相同的效果（特别是如果您将其应用于全局函数），但意味着您的值存储在您的函数命名空间之上，从而大大减少了与其他代码冲突的可能性。它仍然意味着外部代码可以影响您的 var 的内容——这实际上可能是一个好处，具体取决于您想要做什么。

### 将内容存储在 dom 中

根据您希望存储的内容，有时将这些数据记录在 DOM 中可能会有所帮助。其中最明显的是将数据写入隐藏输入或隐藏元素。后者的好处是，如果它碰巧采用标记信息的形式*（就像你的那样） ，你仍然可以导航这些数据**（使用 jQuery 或 document.getElementById*之类的） 。这也是避免循环引用引起的内存泄漏的有益方法——如果你正在处理大量数据——只要你确保清空数据传输中涉及的变量。

 *```
$.ajax('request_html.php').done(function(data){
  $('<div id="hidden_html" />').hide().html(data).appendTo('body');
  data = null;
  /// you only need mullify data if you were to have other
  /// sub/child functions within this callback, mainly being wary
  /// of closures - which are functions that are defined in a certain
  /// scope chain, but are then returned or put to use outside of
  /// that chain - i.e. like event listeners. 
  /// nullify vars and removing large properties is still good practice though.
}); 
```

然后当你想检索时：

```
$('#hidden_html').html(); 
```

同时在这两点之间，您显然仍然可以遍历数据：

```
$('#hidden_html h1 > a[name=first]'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T23:19:42.717

您将原始 HTML 与相同的 DOM 元素相关联，这样它就不会消失：

```
$("#myDOMElement").data("initial-html", $("#myDomElement").html()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-23T23:21:16.187

类似的东西，但尚未测试：

```
$(function() {

  $('#id').data('store', $('#id').html());

});

...

$('#id').html(data('store')); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-23T23:21:02.593

### 设置它并忘记它。

如果您将 的内容推[`.html()`](http://api.jquery.com/html/)送到变量中，除非您对该变量执行某些操作以将其删除，否则它将保留在那里：

```
var original = $("#foo").html(); // original HTML is now in 'origina' 
```

这不会改变，除非你改变它。

### 使用 $.data() 在元素上存储数据

不过，将它作为数据（使用 jQuery 的[`.data`](http://api.jquery.com/data/)方法）存储在元素本身上可能对您更有利：

```
var element = $("#foo");
element.data( "original", element.html() ); 
```

这样您就可以在以后随时访问它：

```
console.log( element.data( "original" ) ); 
```

录制、重置和恢复演示：http: [//jsfiddle.net/ft8M9/](http://jsfiddle.net/ft8M9/)

### 也适用于许多项目

```
// Access all elements to restore
var restore = $(".restore");

// Save original HTML, and set new HTML
restore.each(function(i,o){
    var that = $(this);
    that.data("original", that.html())
        .html("Changed " + i);
});

// After 2 seconds, restore original HTML, remove stored data
setTimeout(function(){
    restore.each(function(i,o){
        var that = $(this);
        that.html( that.data("original") )
            .removeData( "original" );
    });
}, 2000); 
```

演示：http: [//jsfiddle.net/ft8M9/1/](http://jsfiddle.net/ft8M9/1/)*

# twitter-bootstrap - 如何调用 Bootstrap 的 LESS 渐变混合

> ID：13040765
> 
> 赞同：21
> 
> 时间：2012-10-23T23:16:57.853
> 
> 标签：twitter-bootstrap, less

Bootstrap 垂直梯度 mixin 定义如下：

```
#gradient {
  .vertical (@start-color, @end-color) when (@disable-filters)  {
    /* code */
  }
} 
```

我打电话给`.#gradient > .vertical(#fff, #ddd);`我的LESS。但是编译给了我以下错误。

```
ParseError: Syntax Error on line 104 in front.less:104:8
103         border-bottom: 2px solid white;
104         .#gradient > .vertical(#fff, #ddd);
105       } 
```

注释掉上面的行可以解决这个问题。调用 Bootstrap 的垂直渐变混合的正确方法是什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-08-19T16:39:02.547

这个想法在 Bootstrap 3 中是相同的（正如 David Taiaroa 建议的那样），此外还有两个额外的参数可以传入来控制渐变的外观：

```
.vertical(@start-color; @end-color; @start-percent; @end-percent) 
```

因此，例如，您可以在`custom.less`文件中执行以下操作：

```
@import '../less/bootstrap.less';

.promo-content{
  #gradient.vertical(#fff; #c3c3c3; 0%; 10%);
  height:100px;
  .text-center;
  padding-top: 25px;
  margin-bottom: 10px;
  border:1px solid #e2e2e2;
}

.promo-content2{
  #gradient.vertical(#fff; #c3c3c3; 0%; 90%);
} 
```

你会得到以下结果：

![在此处输入图像描述](../Images/fc010904c38761764223f3153625c8c4.png)

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-12-17T01:18:33.947

我认为某些渐变混合的 Bootstrap v2.2.2 文档中可能存在拼写错误。如果您检查 mixins.less 文件，看起来在调用渐变混合时不需要前导点，即 #gradient > .vertical(#999, #fff);

我有这个工作。

在 html 页面上，我有一个 ID=gradient-test 的 div

在我的自定义 mixin 中，我有：

```
#gradient-test{  
#gradient > .vertical(#999, #fff);  
} 
```

祝你好运！

# orm - Kohana ORM JOIN 与 OR 语句

> ID：13040767
> 
> 赞同：0
> 
> 时间：2012-10-23T23:17:11.563
> 
> 标签：orm, kohana

我需要像这样创建查询

```
JOIN users
        ON dialogs.`user_id` <> '.$this->user->id.'
        AND dialogs.user_id=users.id
        OR dialogs.`to` <> '.$this->user->id.'
        AND dialogs.`to`=users.id 
```

但是每次我使用 on() 方法时，ORM 都会添加“AND”语句。是否可以添加 OR 而不是 AND？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T06:29:50.473

你`user_id <> '.$this->user->id.'`和`dialogs.to <> '.$this->user->id.'`必须在`where`条款中。在那里你可以使用[or_where](http://kohanaframework.org/3.0/guide/api/Database_Query_Builder_Update#or_where)。

# php - 显示来自公用文件夹外部的多个图像

> ID：13040773
> 
> 赞同：0
> 
> 时间：2012-10-23T23:18:23.267
> 
> 标签：php, image, image-processing

我正在做一个项目，出于版权原因，我想将照片存储在安全的位置。用户可以将他们的照片上传到公共路径（“www”）之外的文件夹。

对于已登录的用户，我想允许浏览这些照片。我想使用“imagecreatefromjpeg”和“imagejpeg”，但它们只能填满整个网页。如果我想将图像打开到弹出窗口中，那就太好了。而不是这样做，我想在我的屏幕上放上小缩略图（上传时生成，也存储在私人文件夹中）。

有没有办法做到这一点？我会朝着这个方向发展吗？

谢谢你的协助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:47:03.610

您可以使用 php gd 缓存提交图像的缩略图

[http://www.fliquidstudios.com/2009/05/07/resizing-images-in-php-with-gd-and-imagick/](http://www.fliquidstudios.com/2009/05/07/resizing-images-in-php-with-gd-and-imagick/)

然后创建一个 image.php 文件，该文件将提供以`imagejpg($im)`.

然后在您的 html 中，只需输入以下内容：

`<img src="images/image.php?id=123" width="100" height="100">`

# objective-c - lldb 错误：变量不可用

> ID：13040777
> 
> 赞同：30
> 
> 时间：2012-10-23T23:18:48.777
> 
> 标签：objective-c, ios, xcode, lldb

这是我的两行代码：

```
NSString *frontFilePath = [[NSBundle mainBundle] pathForResource:[self.bookendFileNames objectAtIndex:self.randomIndex] ofType:@"caf"];
NSLog(@"frontFilePath = %@", frontFilePath ); 
```

我在第二行放了一个断点，在那里，我尝试打印它：

```
(lldb) po frontFilePath 
```

但我收到以下错误：

```
error: variable not available 
```

我很困惑，因为如果我跳过 NSLog 语句，该变量确实会打印到控制台。

对于它的价值，我正在尝试调试第一行，因为*有时*它会返回 NULL，但到目前为止我还无法弄清楚原因。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-24T01:27:56.390

这是调试优化代码的神器。在构建设置中启用编译器优化时，它会在内存和寄存器之间移动变量，因为它认为是最好的。在您检查 lldb 中的变量时，它可能根本不存在于寄存器或内存中——即使它看起来应该仍然可以显示。

有可能是编译器输出的调试信息有缺陷。有时编译器会将变量复制到寄存器中以供其使用，并且仅在调试信息中列出该寄存器位置。后来，该寄存器被重新用于其他用途；value 仍然存在于堆栈中，但编译器没有告诉调试器该值可以在那里找到。

真正判断调试信息是否不足或者该特定指令中是否确实不存在该值的唯一方法是手动检查汇编代码。一旦您使用编译器打开优化，源代码就变成了以任何特定顺序实际执行的内容的弱视图。

如果可能的话，我强烈建议您关闭构建的优化（构建设置中的优化级别）并以这种方式进行调试，而不是在优化代码调试的古怪世界中徘徊太远。如果您确实需要通过优化来调试您的应用程序，请确保您使用 Xcode 支持的最新 Apple LLVM 编译器进行构建——总是有工作在改进优化代码调试，您希望充分利用自己迄今为止的工具，你可以。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-09-02T15:13:58.433

诊断中的“Address Sanitizer”似乎也使变量的值不可用。

[方案 > 运行 > 诊断 > 地址清理程序](https://i.stack.imgur.com/Np6uI.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-11-12T11:29:58.473

在 Swift 中，可能从 Xcode 9 开始，但在 Xcode 10 中仍然存在问题，甚至在构建设置中关闭代码优化时也会出现这种情况。正如@carlos_ms 在这里指出的那样，临时解决方案是将变量定义为可变的，即

转动

```
let foo = Bar().string 
```

进入

```
var foo = Bar().string 
```

为了使优化跳过这个变量。请注意，这可能不适用于所有情况。

在这种情况下，一个好人`debugPrint()`可能会帮助你。

# java - 调用方法时如何触发我的自定义注释？

> ID：13040780
> 
> 赞同：3
> 
> 时间：2012-10-23T23:19:24.033
> 
> 标签：java, reflection, annotations

我想为网络编写自己的安全模块库，但我没有解决问题。例子; 我有一个班级，有一个方法。方法有我的自定义注释。

```
class example{
  @Admin
  public void go(){
    syso("working");
  }
 } 
```

当调用此方法时，我如何触发我的注释。

（示例；休眠验证器。我们在方法上编写休眠注释，它只工作调用的方法）

顺便说一句，我的英语不好:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:39:03.237

注释不是“触发”的……您必须编写代码来查找它们的存在并采取行动。

“代码”可以在运行时执行，但更常见的是在*编译*时使用[注释处理工具](http://docs.oracle.com/javase/1.5.0/docs/guide/apt/index.html)来更改源以注入额外的，通常是[横切的](http://en.wikipedia.org/wiki/Cross-cutting_concern)，适合注释的代码。

# asp.net-mvc - ASP.NET MVC Web.Api 路由 - 真实世界示例

> ID：13040781
> 
> 赞同：3
> 
> 时间：2012-10-23T23:19:24.903
> 
> 标签：asp.net-mvc, asp.net-web-api, asp.net-mvc-routing, asp.net-web-api-routing

我一直在研究 Web.Api 中的路由，并研究了表示端点的各种方式。我遇到了[Instagram 的 REST 端点](http://instagram.com/developer/endpoints/users/)。（其中有一些可爱的文档）使用 Web.Api 为 Instagram 用户端点等情况设置路由和控制器的最佳方法是什么？

```
User Endpoints
GET/users/user-id                  Get basic information about a user.
GET/users/self/feed                See the authenticated user's feed.
GET/users/user-id/media/recent     Get the most recent media published by a user.
GET/users/self/media/liked         See the authenticated user's list of liked media.
GET/users/search                   Search for a user by name. 
```

如果我想在我的应用程序中复制这些端点，我将如何去做。我是否只需要一个具有 5 种方法的控制器“用户”，我需要什么样的路由来将 REST 调用定向到这些方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T00:24:34.547

我会以不同的方式构建它。

```
GET/user
GET/user/user-id
GET/user?q=user-name

GET/media
GET/media/user-id
GET/media/user-id?selection=recent
GET/media/user-id?selection=liked

GET/feed
GET/feed/user-id 
```

通过这种方式，您可以为特定目标保留控制器，就像为单一职责保留类一样。

*   用户
*   媒体
*   喂养

当您使用这种方法时，用户更容易“猜测”路径。而且我认为您已经可以猜到每条路径的作用，而无需任何解释。对我来说，这是我设计 API 时最重要的。

```
GET/controller            - always returns a item list
GET/controller/id         - always returns a specific item
GET/controller?q=         - always queries the controller
GET/controller?selection= - always selects a subset from the list off items 
```

当然，这是开放的解释，但它让你知道我将如何解决这个特定问题，也许还有一些想法需要考虑。还可以看看这本很棒的书`Apigee - Web Api Designs`

[http://info.apigee.com/Portals/62317/docs/web%20api.pdf](http://info.apigee.com/Portals/62317/docs/web%20api.pdf)

**编辑：**

要制作您命名的路线，我认为您有 2 个（不是很理想）选项。

1.  为每个 url 映射一个特定的路由
2.  制作通配符路由

**选项 1** 我没有尝试过，也没有自己使用过，但您可以在此处找到更多信息：

[ASP.NET Web API 中具有多个 GET 方法的单个控制器](https://stackoverflow.com/questions/9499794/single-controller-with-multiple-get-methods-in-asp-net-web-api)

**选项 2** 如果您使用通配符路由，所有带有附加参数的请求都将被路由到您的默认`Get()`方法。在您的获取中，您必须查看使用的参数`ControllerContext.Request.RequestUri.AbsolutePath`或类似的东西，然后选择您对它的操作。

```
config.Routes.MapHttpRoute(
     name: "MyApi",
     routeTemplate: "api/{controller}/{id}/{*wildcard}",
     defaults: new { controller = "index", id = RouteParameter.Optional }
 ); 
```

# macos - 调整 NSView 中间动画的大小

> ID：13040782
> 
> 赞同：5
> 
> 时间：2012-10-23T23:19:26.433
> 
> 标签：macos, cocoa, nsview, appkit

我有一个普通的 NSView 可以通过拖动窗口边缘来调整大小。

如果在 [NSView animator] 动画期间调整视图大小，它会继续动画到原始动画的最终大小，但不考虑新的窗口大小。

[这是一个简单的示例项目。](http://supercrazyawesome.com/jump/ResizingViewAnimation.zip)双击开始动画，然后在结束前调整窗口大小。

使动画考虑新帧大小的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T11:20:37.290

恕我直言，最好的方法是在调整大小阶段开始后立即停止动画。在调整大小阶段，用户可以控制并手动设置窗口的大小。当调整大小阶段结束时，窗口已经设置为所需的大小，因此无需做更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-22T11:22:34.047

这种问题最好用 NSTimer 而不是 animator 函数来解决：

让定时器重复调用一个函数，直到动画“完成”。完成后，结束计时器（无效）。

在每个循环中重复调用的函数会获取窗口的实际帧大小和视图的实际帧大小，并简单地将两者差异的三分之一添加到视图的框架中，例如：

```
frame.size.height += diffHeight/3.0; 
```

因此，无论发生什么，视图都会越来越接近其目的地。一旦abs（差异）小于例如0.2，您就可以将视图直接设置为所需的大小并结束计时器。这是直接的，只使用很少的代码，你不需要监听任何事件，而它执行得很好。:-)

以下是初始化动画的关键代码（计时器必须是您的类的实例）：

```
if(timer)return;
timer = [NSTimer scheduledTimerWithTimeInterval:0.05 target:self selector:@selector(resizeView:) userInfo:[NSNumber numberWithBool:status] repeats:YES];
[timer setTolerance:0.02]; 
```

我使用单词状态而不是关闭单词，重复调用的函数可能看起来有点像：

```
- (void)resizeView:(id)userInfo;
{
    BOOL status = [(NSNumber *)[userInfo userInfo] boolValue];
    double startwid,stopwid;
    NSRect newSizeRect = [[self window] frame];
    stopwid = newSizeRect.size.width;
    if(status){
        stopwid -= 100.0;
    }
    NSRect cbgRect = [self frame];
    startwid = cbgRect.size.width;
    double diff = stopwid-startwid;
    if(fabs(diff)<0.2){
        diff = 0;
        startwid = stopwid;
        [timer invalidate];
        timer = nil;
        //NSLog(@"stop");
    }
    //NSLog(@"%f - %f = %f /10 = %f",stopwid,startwid,diff,diff/3.0);
    cbgRect.size.width = startwid+diff/3.0;

    [self setFrame:cbgRect];
} 
```

# eclipse - 如何消除eclipse的“maven-enforcer-plugin（目标“enforce”）被m2e忽略”警告？

> ID：13040788
> 
> 赞同：46
> 
> 时间：2012-10-23T23:20:03.613
> 
> 标签：eclipse, maven, maven-3, m2eclipse, m2e

我正在使用 maven 和 eclipse m2e 配置一个多模块父子 maven 项目，我正在使用来自 eclipse Juno SR1 的最新内容，即 m2e 1.2.0

父 pom 使用强制插件，因此父 pom.xml 在其插件部分中有以下内容

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-enforcer-plugin</artifactId>
    <version>1.1.1</version>
    <executions>

        <!-- Enforce that all versions of a transative dependency must converge. -->
        <execution>
            <id>enforce</id>
            <configuration>
                <rules>
                    <DependencyConvergence />
                </rules>
            </configuration>
            <goals>
                <goal>enforce</goal>
            </goals>
        </execution>

        <!-- Black list certain jars -->
        <execution>
            <id>enforce-banned-dependencies</id>
            <goals>
                <goal>enforce</goal>
            </goals>
            <configuration>
                <rules>
                    <bannedDependencies>
                        <excludes>
                            <exclude>
                                commons-logging:commons-logging
                            </exclude>
                        </excludes>
                    </bannedDependencies>
                </rules>
                <fail>true</fail>
            </configuration>
        </execution>

    </executions>
</plugin> 
```

每个子项目都有一条错误消息说`maven-enforcer-plugin (goal "enforce") is ignored by m2e.`

*   这条消息的含义是什么？
*   如何配置以消除此消息？
*   我需要配置 eclipse 项目设置或 pom.xml 设置吗？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-10-24T06:14:16.680

eclipse maven 插件运行项目 pom.xml 文件，以了解如何配置 maven 项目并将 maven pom.xml 配置转换为 eclipse 配置。一个 pom.xml 可以引用任意数量的 maven 插件，每个插件都有可能泄漏内存，或者做一些对 eclipse 有害的事情。所以默认情况下，m2e eclipse 插件会忽略任何 maven 插件，除非这些 maven 插件有一个特殊的 m2e 插件连接器，告诉 m2e 如何将 maven 插件集成到 eclipse 中。总之，m2e 正在保护 eclipse JVM 进程免受有问题的 maven 插件的侵害，因为每个 maven 插件都需要一个 m2e 连接器来桥接 maven 和 eclipse。

因此，为了摆脱警告，我将以下内容添加到父 pom.xml 的插件管理部分

```
<build>
  <pluginManagement>
    <plugins>
      <plugin>
        <groupId>org.eclipse.m2e</groupId>
        <artifactId>lifecycle-mapping</artifactId>
        <version>1.0.0</version>
        <configuration>
          <lifecycleMappingMetadata>
            <pluginExecutions>
              <pluginExecution>
                <pluginExecutionFilter>
                  <groupId>org.apache.maven.plugins</groupId>
                  <artifactId>maven-enforcer-plugin</artifactId>
                  <versionRange>[1.0.0,)</versionRange>
                  <goals>
                    <goal>enforce</goal>
                  </goals>
                </pluginExecutionFilter>
                <action>
                  <ignore />
                </action>
              </pluginExecution>
            </pluginExecutions>
          </lifecycleMappingMetadata>
        </configuration>
      </plugin>
    </plugins>
  </pluginManagement>
</build> 
```

这似乎`org.eclipse.m2e:lifecycle-mapping`是一个 maven 插件，旨在在处理 maven pom.xml 时保存元数据以与 eclipse m2e 插件通信，并且此信息用于告诉 eclipse 在 eclipse 运行时如何处理 pom.xml 中定义的 maven 插件pom.xml 作为 Eclipse UI 的一部分。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-10-10T16:34:06.360

从 m2e 版本 1.4 及更高版本开始：您可以在 pom（父 pom 或 project-pom）中集成所需的生命周期配置，或者您可以将信息集成到 eclipse 中的全局 m2e 配置中。此外，您还有一些用于应用此更改的快速修复操作。

最后一个选择是寻找 m2e 连接器或切换到具有集成 m2e 支持的不同 maven 插件的新版本（例如，对于 jaxb 插件）。

在这里（对于enforcer-plugin）我认为，pom中的定义是最简单的方法。

另见：[https ://www.eclipse.org/m2e/documentation/m2e-execution-not-covered.html](https://www.eclipse.org/m2e/documentation/m2e-execution-not-covered.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-20T18:40:47.640

对于那些在构建模型中配置 IDE 有问题的人，仅供参考。密切关注当前针对 Kepler 版本的增强请求：

**错误 350414：在项目 pom.xml** [https://bugs.eclipse.org/bugs/show_bug.cgi?id=350414之外存储忽略的 m2e 连接器](https://bugs.eclipse.org/bugs/show_bug.cgi?id=350414)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-05T17:45:59.190

对我来说这是类似的问题

我有 maven 3.0.3 和 java 1.5

我的pom有

```
<executions>
                    <execution>
                        <id>enforce-versions</id>
                        <goals>
                            <goal>enforce</goal>
                        </goals>
                        <configuration>
                            <rules>
                                <requireMavenVersion>
                                    <version>[3.0.3,2.2.1,)</version>
                                </requireMavenVersion>
                                <requireJavaVersion>
                                    <version>[1.7, 1.8)</version>
                                </requireJavaVersion>
                            </rules>
                        </configuration>
                    </execution>
                </executions>
            </plugin> 
```

正如你所看到的，我并没有真正遵守规则，因此我更新了 Java 并开始使用 mvn，我已经准备好了。希望这可以帮助某人。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-11T16:38:51.977

当有多个 pluginExecutionFilters 时存在另一个陷阱。这些必须在 pom.xml 中的正确位置！对我来说，发现不存在位移的错误或警告是很困难的。

这是拥有多个 pluginExecutionFilters 的正确代码：

```
<build>
  <pluginManagement>
    <plugins>
      <plugin>
        <groupId>org.eclipse.m2e</groupId>
        <artifactId>lifecycle-mapping</artifactId>
        <version>1.0.0</version>
        <configuration>
        <lifecycleMappingMetadata>
            <pluginExecutions>
                <pluginExecution>
                    <pluginExecutionFilter>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-enforcer-plugin</artifactId>
                        <versionRange>[1.0.0,)</versionRange>
                        <goals>
                           <goal>enforce</goal>
                        </goals>
                    </pluginExecutionFilter>
                    <action><ignore/></action>
                </pluginExecution>
<!-- now here follows the new filter -->
                <pluginExecution>
                    <pluginExecutionFilter>
                        <groupId>com.googlecode.maven-java-formatter-plugin</groupId>
                        ... 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-01T16:35:04.003

> 如何消除eclipse的“maven-enforcer-plugin（目标“enforce”）被m2e忽略”警告？

尽管 eclipse`lifecycle-mapping`插件在其他项目中对我有用，但我无法更改，`pom.xml`因为我目前在 IntelliJ 商店使用我的 Eclipse 隐蔽实例工作，我不想通过将所有 pom 文件更改为来暴露自己包括来自 group 的任何内容`org.eclipse.m2e`。

经过一些实验，我发现您可以通过更改 Maven 首选项中的生命周期映射来获得此警告，使其不显示。坦率地说，我不是 100% 确定这是在做什么，但我没有看到任何副作用，所以......

1.  在 Eclipse 中，转到：首选项 → Maven → 生命周期映射。
2.  单击`Open workspace lifecycle mappings metadata`哪个将`lifecycle-mapping-metadata.xml`在后台的选项卡中打开文件。我假设这与您的工作区子目录下的以下文件相对应：

    ```
    .metadata/.plugins/org.eclipse.m2e.core/lifecycle-mapping-metadata.xml 
    ```

3.  接下来将以下节添加到`<pluginExecutions>...</pluginExecutions>`.

    ```
    <pluginExecution>
        <pluginExecutionFilter>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-enforcer-plugin</artifactId>
            <versionRange>[1.0.0,)</versionRange>
            <goals>
                <goal>enforce</goal>
            </goals>
        </pluginExecutionFilter>
        <action>
            <ignore />
        </action>
    </pluginExecution> 
    ```

4.  保存 XML 文件后，您需要返回首选项窗口并按`Reload workspace lifecycle mappings metadata`哪个以某种方式编译文件。

5.  最后，您需要对所有项目执行 maven update-project 以查看警告消失。

希望这可以帮助。

# hibernate - 休眠如果行退出映射到布尔属性

> ID：13040791
> 
> 赞同：0
> 
> 时间：2012-10-23T23:20:22.657
> 
> 标签：hibernate, criteria

我有一个休眠域类，比如说产品，它被映射到产品表。我有另一张表叫 Order。每个表都有一个 linkId 字段，这些表可以通过该字段连接。在产品类中，我有一个布尔属性，但它没有映射到产品表中的任何列。如果订单表中存在匹配的行，是否可以创建一个标准来连接这两个表，并将 porduct 上的布尔字段填充为 true，如果不存在匹配的行，则填充为 false。

我需要一个例子。谢谢

# typescript - Visual Studio 2012 TypeScript 项目在编译期间忽略两个文件

> ID：13040793
> 
> 赞同：3
> 
> 时间：2012-10-23T23:20:51.000
> 
> 标签：typescript

我有一个 Visual Studio 2012 TypeScript 项目。当我第一次制作项目时，我添加了 2 个新的 .ts 文件，它们是 Framework.ts 和 Graphics.ts。我最近添加了两个 TypeScript 文件作为声明文件，并将它们命名为 .d.ts，例如 Framework.d.ts 和 Graphics.d.ts。有趣的是，所有 4 个文件都将 Build Action 属性设置为 TypeScriptCompile，但其中只有 2 个构建（Framework.ts 和 Graphics.ts），其他 .d.ts 文件仍然具有关于 a 的原始 .js 构建代码形状模块。我认为.d.ts 扩展名可能存在问题，并将这些文件重命名为 Framework_d.ts 和 Graphics_d.ts。这也没有建造它们！

在这一点上，我不知所措。我查看了 csproj 文件：

```
<TypeScriptCompile Include="Framework\Framework.d.ts" />
<Content Include="Framework\Framework.d.js">
  <DependentUpon>Framework.d.ts</DependentUpon>
</Content>
<Content Include="Graphics\Graphics.d.js">
  <DependentUpon>Graphics.d.ts</DependentUpon>
</Content>
<Content Include="TestPages\SpriteBatch.html" />
<TypeScriptCompile Include="Framework\Framework.ts" />
<Content Include="Framework\Framework.js">
  <DependentUpon>Framework.ts</DependentUpon>
</Content>
<Content Include="Graphics\Graphics.js">
  <DependentUpon>Graphics.ts</DependentUpon>
</Content>
<TypeScriptCompile Include="Graphics\Graphics.d.ts" />
<TypeScriptCompile Include="Graphics\Graphics.ts" /> 
```

然后是打字稿编译器的执行命令：

```
<Target Name="BeforeBuild">
  <Exec Command="&quot;$(PROGRAMFILES)\Microsoft SDKs\TypeScript\0.8.0.0\tsc&quot; @(TypeScriptCompile ->'&quot;%(fullpath)&quot;', ' ')" />
</Target> 
```

这确实也应该构建这些文件。我只是不知道它为什么拒绝。有谁知道如何解决这一问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T01:07:17.253

如果它们是您所说的声明文件，那么它们将没有 javascript 输出。我认为您不需要将这些“添加”到项目中，或者至少不需要对它们应用 TypeScriptCompile 构建操作。您可以使用将它们包含在其他源文件中

```
///<reference path="Framework\Framework.d.ts" 
///<reference path="Graphics.d.ts" 
```

所以他们看到了声明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T20:28:53.130

我不确定这是否是您的情况，但是 .ts 文件编码存在一些问题。

不幸的是，TypeScript 无法编译**带有**签名的 UTF-8。您可以通过“文件”-->“高级保存选项”--> 选择“不带签名的 UTF-8”来选择另一个保存选项。

检查当前问题。 [http://typescript.codeplex.com/workitem/85](http://typescript.codeplex.com/workitem/85)

谢谢

# linux - 如何列出当前活动的 systemtap 探针

> ID：13040802
> 
> 赞同：5
> 
> 时间：2012-10-23T23:21:19.090
> 
> 标签：linux, systemtap, probe

谁能告诉我如何列出系统中当前活动的 systemtap 探针？

我想可能有一些来自“/proc”的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T02:17:08.153

`sysfs`有一个活动探针的注册表：

```
cat /sys/kernel/debug/kprobes/list 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T14:12:24.183

*在 kprobes (kernel. , kprobe.* )的范围内，Brian 是正确的。没有可能正在使用的所有其他类型的探针（定时器、性能计数器、用户空间探针……）的运行时目录。如果这样的工具有用，请考虑在[http://sourceware.org/bugzilla上提出增强请求](http://sourceware.org/bugzilla)

# javascript - Backbonejs：如何使用原型为模型的每个实例附加构造函数？

> ID：13040805
> 
> 赞同：0
> 
> 时间：2012-10-23T23:21:43.177
> 
> 标签：javascript, backbone.js, prototype

如何使用原型为模型的每个实例附加构造函数？创建 Backbone.Model 的实例时，我一直在尝试修改构造函数方法。但是我不想将构造函数方法附加到我单独创建的每个模型上。添加初始化作品的原型；唯一的问题是，如果初始化与模型一起传递，它会通过下划线扩展方法覆盖它。

我试过这个

```
Backbone.Model.prototype.constructor = function(attributes, opts) {
        console.log('hi');
        Backbone.Model.prototype.constructor.call(this, attributes);
}; 
```

唯一的问题是，它在扩展之外不起作用；只有当构造函数位于您在创建新实例时扩展模型的对象内时，它才会被调用。

我只需要在创建每个模型的实例时运行一些代码。我想使用节点的 socket.io 框架执行一些自动绑定工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T11:17:40.257

It's not recommended to mess with the internals of backbone inheritance and use the provided methods and flow to achieve model manipulation on initialization. To do that - in a similar fashion as with collections, views or routers you have an [initialization](http://backbonejs.org/#Model-constructor) method that you should override that takes the role of a constructor.

If you need to alter all your models just create a new base class that you will later use as a super class for all your models and then if you need to overwrite the initialization method of subclasses remeber to call the super class initializer using the built in backbone class `__super__` property.

```
initialize: function() {
    this.constructor.__super__.initialize.call(this);
    // whatever
}, 
```

Altering the core of backbone will never do good for you in the long run as it my prevent you from being able to easily update to new version if they would introduce conflicting changes.

I've been there and done that - and after doing it I'd recommend not following this path to anybody!

# ruby-on-rails - Rails Generate Scaffold 只显示了我的一小部分帖子

> ID：13040808
> 
> 赞同：0
> 
> 时间：2012-10-23T23:21:52.470
> 
> 标签：ruby-on-rails

我生成了一个脚手架，以便我可以将博客条目发布到我的网站中。

我已经为按我想要的方式工作的文章制作了一篇……

但是，我生成了另一个评论，但是当我发布评论时，只显示了几句话而不是整个评论。当我回去编辑评论时，我的大部分评论都消失了，只有几句话出现......

由于某种原因，我似乎只能添加几句话......

它与 CSS 无关，因为我关闭了所有样式，但我仍然得到相同的结果

这是显示页面

```
 <div class="container">
 <div class="row">
<div class="span4">
  <%= image_tag @comic_review.photo %>
</div>

<div class="span8 comic_review_content">
  <h3>
    <b><%= @comic_review.title %></b>
  </h3>
<br />

<p>
  <b>Synopsis:</b>
  <%= @comic_review.content %>
</p>

<p>
  <b>Credits:</b>
  <%= @comic_review.credits %>
</p>

<h3>Review</h3>
<div class="line_section"></div>
<p><%= simple_format @comic_review.review %></p>

<%= link_to 'Edit', edit_comic_review_path(@comic_review) %> |
<%= link_to 'Back', comic_reviews_path %> 
```

```
<div class="comment_count">
  All Comments (<%= @comic_review.comments.count %>) 
</div>
<%= render "comments/comments" %>

<%= render "comments/form" %>
</div> 
```

这是实际的形式

```
 <%= form_for @comic_review, :html => { :multipart => true } do |f| %>
   <% if @comic_review.errors.any? %>
  <div id="error_explanation">
    <h2><%= pluralize(@comic_review.errors.count, "error") %> prohibited this article from         being  saved:</h2>

  <ul>
  <% @comic_review.errors.full_messages.each do |msg| %>
    <li><%= msg %></li>
  <% end %>
  </ul>
</div>
<% end %>

<div class="field">
<b>Title</b>
<br />
<%= f.text_field :title, class: 'form_field1' %>
</div>
<br />
<div class="field">
<b>Author</b>
<br />
<%= f.text_field :credits, class: 'form_field1'  %>
</div>  
 <br />
<div class="field">
<b>Date</b>
<br />
<%= f.text_field :content, class: 'form_field1'  %>
</div>  
<br />
<%= f.file_field :photo, class: "photo_upload" %>
<br />
<br />
<div class="field">
<b>Content</b>
<br />
<%= f.text_field :review, rows: 25, class: 'form_field' %>
</div>
<div class="actions">
  <%= f.submit %>
 </div>
<% end %> 
```

我不知道发生了什么任何帮助将不胜感激提前谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:31:50.783

在您的数据库中，`review`列的类型是`VARCHAR(255)`什么？如果是这样，那是因为您`review:string`在生成脚手架时就这样做了；`string`转换为`VARCHAR(255)`，并且至少在 MySQL 中，如果您将超过 255 个字符的字符串插入到该类型的列中，它将截断前 255 个字符之后的所有内容。

解决方法是更改​​列类型。登录到 mysql 控制台 unser 数据库，然后运行：

```
ALTER TABLE comic_reviews CHANGE review review TEXT; 
```

# printing - ZPL 打印机上的 Unicode 字符

> ID：13040822
> 
> 赞同：21
> 
> 时间：2012-10-23T23:24:19.643
> 
> 标签：printing, zpl, zpl-ii

我的任务是使用联网的 Zebra GK420T 重新设计一个打印运输标签的系统。我已经能够很好地向它发送 ZPL 打印作业，但我似乎无法让它打印 unicode 字符，例如西里尔字母。我已使用 Seagull Scientific 驱动程序将 lucida sans unicode 字体下载到打印机，并且我正在使用以下 ZPL 代码进行测试：

```
^XA
^LH100,150
^CI28
^FT0,0^A@N,50,50,R:LUCIDASR.FNT^CI28^FDTesting 1 2 3^FS
^FT0,50^A@N,50,50,R:LUCIDASR.FNT^CI28^FDДо свидания^FS
^FT0,100^B3^FDAAA001^FS
^XZ 
```

它将打印“Testing 1 2 3”和条形码，但会留下空格而不是西里尔字符。

我还尝试使用 Zebra swiss unicode 字体，现在它将俄语字符打印为问号：

```
^XA
^LH100,150
^CWT,E:TT0003M_.FNT
^CFT,30,30
^CI28
^FT0,0^FDTesting 1 2 3^FS
^FT0,50^FDДо свидания^FS
^FT0,100^B3^FDAAA001^FS
^XZ 
```

我做错了什么，比如没有转义字符或其他什么，还是打印机有问题？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-24T01:17:01.463

`^FH`我刚刚发现您需要通过首先将任何可能包含 utf 字符的字段放在前面来转义 ASCII 以上`^FD`的字符，并且您需要在 utf-8 十六进制代码前加上下划线

`_D0_94`将打印为 Д。我最终的 ZPL 代码如下：

```
^XA
^LH100,150
^CWT,E:TT0003M_.FNT
^CFT,30,30
^CI28
^FT0,0^FH^FDTesting 1 2 3^FS
^FT0,50^FH^FD_D0_94_D0_BE _D1_81_D0_B2_D0_B8_D0_B4_D0_B0_D0_BD_D0_B8_D1_8F^FS
^FT0,100^B3^FDAAA001^FS
^XZ 
```

我只需要找到一种方法来生成转义序列，这应该会容易得多！

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-01-26T19:26:48.680

我有同样的问题，你应该`^FH`在任何包含特殊字符的（字段数据）命令之前添加一个（字段十六进制指示符）`^FD`，在我的情况下，我需要西班牙语字符，所以我不得不使用`^CI28`（更改国际字体/编码）

[UTF 8 HEX 代码列表](http://www.utf8-chartable.de/)

示例：要打印`Alvaro Jesús Pérez Peñaranda` ，我们需要将这些特殊字符转换为 UTF 8 Hex 代码并在每个代码前添加一个 _，结果如下：`Alvaro Jes_c3_bas P_c3_a9rez Pe_c3_b1aranda`

```
^XA

^CI28
^FO60,75
^ASN,36,20^FH^FDAlvaro Jes_c3_bas P_c3_a9rez Pe_c3_b1aranda^FS

^XZ 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-02-13T14:27:47.230

我正在使用 Zebra ZM400 打印机并使用 TT0003M_ 字体。

此字体不打印哈萨克西里尔文。

如果要打印cryillic + kazakh cyrillic + latin字母，请使用ARI000.FNT（arial字体）

我正在使用以下方法将字符转换为十六进制代码

我希望这有帮助

```
stringConverTextToHex(stringtext)
{
stringnewText="";
char[]charArray=text.ToCharArray();
foreach(charcincharArray)
{
switch(c)
{
case'й':
newText+="_D0_B9";
break;
case'Й':
newText+="_D0_99";
break;
case'ц':
newText+="_D1_86";
break;
case'Ц':
newText+="_D0_A6";
break;
case'у':
newText+="_D1_83";
break;
case'У':
newText+="_D0_A3";
break;
case'к':
newText+="_D0_BA";
break;
case'К':
newText+="_D0_9A";
break;
case'е':
newText+="_D0_B5";
break;
case'Е':
newText+="_D0_95";
break;
case'н':
newText+="_D0_BD";
break;
case'Н':
newText+="_D0_9D";
break;
case'г':
newText+="_D0_B3";
break;
case'Г':
newText+="_D0_93";
break;
case'ш':
newText+="_D1_88";
break;
case'Ш':
newText+="_D0_A8";
break;
case'щ':
newText+="_D1_89";
break;
case'Щ':
newText+="_D0_A9";
break;
case'з':
newText+="_D0_B7";
break;
case'З':
newText+="_D0_97";
break;
case'х':
newText+="_D1_85";
break;
case'Х':
newText+="_D0_A5";
break;
case'ъ':
newText+="_D1_8A";
break;
case'Ъ':
newText+="_D0_AA";
break;
case'ф':
newText+="_D1_84";
break;
case'Ф':
newText+="_D0_A4";
break;
case'ы':
newText+="_D1_8B";
break;
case'Ы':
newText+="_D0_AB";
break;
case'в':
newText+="_D0_B2";
break;
case'В':
newText+="_D0_92";
break;
case'а':
newText+="_D0_B0";
break;
case'А':
newText+="_D0_90";
break;
case'п':
newText+="_D0_BF";
break;
case'П':
newText+="_D0_9F";
break;
case'р':
newText+="_D1_80";
break;
case'Р':
newText+="_D0_A0";
break;
case'о':
newText+="_D0_BE";
break;
case'О':
newText+="_D0_9E";
break;
case'л':
newText+="_D0_BB";
break;
case'Л':
newText+="_D0_9B";
break;
case'д':
newText+="_D0_B4";
break;
case'Д':
newText+="_D0_94";
break;
case'ж':
newText+="_D0_B6";
break;
case'Ж':
newText+="_D0_96";
break;
case'э':
newText+="_D1_8D";
break;
case'Э':
newText+="_D0_AD";
break;
case'я':
newText+="_D1_8F";
break;
case'Я':
newText+="_D0_AF";
break;
case'ч':
newText+="_D1_87";
break;
case'Ч':
newText+="_D0_A7";
break;
case'с':
newText+="_D1_81";
break;
case'С':
newText+="_D0_A1";
break;
case'м':
newText+="_D0_BC";
break;
case'М':
newText+="_D0_9C";
break;
case'и':
newText+="_D0_B8";
break;
case'И':
newText+="_D0_98";
break;
case'т':
newText+="_D1_82";
break;
case'Т':
newText+="_D0_A2";
break;
case'ь':
newText+="_D1_8C";
break;
case'Ь':
newText+="_D0_AC";
break;
case'б':
newText+="_D0_B1";
break;
case'Б':
newText+="_D0_91";
break;
case'ю':
newText+="_D1_8E";
break;
case'Ю':
newText+="_D0_AE";
break;
case'ӑ':
newText+="_D3_91";
break;
case'Ӑ':
newText+="_D3_90";
break;
case'ӓ':
newText+="_D3_93";
break;
case'Ӓ':
newText+="_D3_92";
break;
case'ә':
newText+="_D3_99";
break;
case'Ә':
newText+="_D3_98";
break;
case'ӛ':
newText+="_D3_9B";
break;
case'Ӛ':
newText+="_D3_9A";
break;
case'ӕ':
newText+="_D3_95";
break;
case'Ӕ':
newText+="_D3_94";
break;
case'ґ':
newText+="_D2_91";
break;
case'Ґ':
newText+="_D2_90";
break;
case'ѓ':
newText+="_D1_93";
break;
case'Ѓ':
newText+="_D0_83";
break;
case'ғ':
newText+="_D2_93";
break;
case'Ғ':
newText+="_D2_92";
break;
case'ӷ':
newText+="_D3_B7";
break;
case'Ӷ':
newText+="_D3_B6";
break;
case'ҕ':
newText+="_D2_95";
break;
case'Ҕ':
newText+="_D2_94";
break;
case'ђ':
newText+="_D1_92";
break;
case'Ђ':
newText+="_D0_82";
break;
case'ѐ':
newText+="_D1_90";
break;
case'Ѐ':
newText+="_D0_80";
break;
case'ӗ':
newText+="_D3_97";
break;
case'Ӗ':
newText+="_D3_96";
break;
case'ҽ':
newText+="_D2_BD";
break;
case'Ҽ':
newText+="_D2_BC";
break;
case'ҿ':
newText+="_D2_BF";
break;
case'Ҿ':
newText+="_D2_BE";
break;
case'є':
newText+="_D1_94";
break;
case'Є':
newText+="_D0_84";
break;
case'ӂ':
newText+="_D3_82";
break;
case'Ӂ':
newText+="_D3_81";
break;
case'җ':
newText+="_D2_97";
break;
case'Җ':
newText+="_D2_96";
break;
case'ӝ':
newText+="_D3_9D";
break;
case'Ӝ':
newText+="_D3_9C";
break;
case'ҙ':
newText+="_D2_99";
break;
case'Ҙ':
newText+="_D2_98";
break;
case'ӟ':
newText+="_D3_9F";
break;
case'Ӟ':
newText+="_D3_9E";
break;
case'ӡ':
newText+="_D3_A1";
break;
case'Ӡ':
newText+="_D3_A0";
break;
case'ѕ':
newText+="_D1_95";
break;
case'Ѕ':
newText+="_D0_85";
break;
case'ѝ':
newText+="_D1_9D";
break;
case'Ѝ':
newText+="_D0_8D";
break;
case'ӥ':
newText+="_D3_A5";
break;
case'Ӥ':
newText+="_D3_A4";
break;
case'ӣ':
newText+="_D3_A3";
break;
case'Ӣ':
newText+="_D3_A2";
break;
case'і':
newText+="_D1_96";
break;
case'І':
newText+="_D0_86";
break;
case'ї':
newText+="_D1_97";
break;
case'Ї':
newText+="_D0_87";
break;
case'Ӏ':
newText+="_D3_80";
break;
case'ҋ':
newText+="_D2_8B";
break;
case'Ҋ':
newText+="_D2_8A";
break;
case'ј':
newText+="_D1_98";
break;
case'Ј':
newText+="_D0_88";
break;
case'қ':
newText+="_D2_9B";
break;
case'Қ':
newText+="_D2_9A";
break;
case'ҟ':
newText+="_D2_9F";
break;
case'Ҟ':
newText+="_D2_9E";
break;
case'ҡ':
newText+="_D2_A1";
break;
case'Ҡ':
newText+="_D2_A0";
break;
case'ӄ':
newText+="_D3_84";
break;
case'Ӄ':
newText+="_D3_83";
break;
case'ҝ':
newText+="_D2_9D";
break;
case'Ҝ':
newText+="_D2_9C";
break;
case'ӆ':
newText+="_D3_86";
break;
case'Ӆ':
newText+="_D3_85";
break;
case'љ':
newText+="_D1_99";
break;
case'Љ':
newText+="_D0_89";
break;
case'ӎ':
newText+="_D3_8E";
break;
case'Ӎ':
newText+="_D3_8D";
break;
case'ӊ':
newText+="_D3_8A";
break;
case'Ӊ':
newText+="_D3_89";
break;
case'ң':
newText+="_D2_A3";
break;
case'Ң':
newText+="_D2_A2";
break;
case'ӈ':
newText+="_D3_88";
break;
case'Ӈ':
newText+="_D3_87";
break;
case'ҥ':
newText+="_D2_A5";
break;
case'Ҥ':
newText+="_D2_A4";
break;
case'њ':
newText+="_D1_9A";
break;
case'Њ':
newText+="_D0_8A";
break;
case'ӧ':
newText+="_D3_A7";
break;
case'Ӧ':
newText+="_D3_A6";
break;
case'ө':
newText+="_D3_A9";
break;
case'Ө':
newText+="_D3_A8";
break;
case'ӫ':
newText+="_D3_AB";
break;
case'Ӫ':
newText+="_D3_AA";
break;
case'ҩ':
newText+="_D2_A9";
break;
case'Ҩ':
newText+="_D2_A8";
break;
case'ҧ':
newText+="_D2_A7";
break;
case'Ҧ':
newText+="_D2_A6";
break;
case'ҏ':
newText+="_D2_8F";
break;
case'Ҏ':
newText+="_D2_8E";
break;
case'ҫ':
newText+="_D2_AB";
break;
case'Ҫ':
newText+="_D2_AA";
break;
case'ҭ':
newText+="_D2_AD";
break;
case'Ҭ':
newText+="_D2_AC";
break;
case'ћ':
newText+="_D1_9B";
break;
case'Ћ':
newText+="_D0_8B";
break;
case'ќ':
newText+="_D1_9C";
break;
case'Ќ':
newText+="_D0_8C";
break;
case'ў':
newText+="_D1_9E";
break;
case'Ў':
newText+="_D0_8E";
break;
case'ӳ':
newText+="_D3_B3";
break;
case'Ӳ':
newText+="_D3_B2";
break;
case'ӱ':
newText+="_D3_B1";
break;
case'Ӱ':
newText+="_D3_B0";
break;
case'ӯ':
newText+="_D3_AF";
break;
case'Ӯ':
newText+="_D3_AE";
break;
case'ү':
newText+="_D2_AF";
break;
case'Ү':
newText+="_D2_AE";
break;
case'ұ':
newText+="_D2_B1";
break;
case'Ұ':
newText+="_D2_B0";
break;
case'ҳ':
newText+="_D2_B3";
break;
case'Ҳ':
newText+="_D2_B2";
break;
case'һ':
newText+="_D2_BB";
break;
case'Һ':
newText+="_D2_BA";
break;
case'ҵ':
newText+="_D2_B5";
break;
case'Ҵ':
newText+="_D2_B4";
break;
case'ӵ':
newText+="_D3_B5";
break;
case'Ӵ':
newText+="_D3_B4";
break;
case'ҷ':
newText+="_D2_B7";
break;
case'Ҷ':
newText+="_D2_B6";
break;
case'ӌ':
newText+="_D3_8C";
break;
case'Ӌ':
newText+="_D3_8B";
break;
case'ҹ':
newText+="_D2_B9";
break;
case'Ҹ':
newText+="_D2_B8";
break;
case'џ':
newText+="_D1_9F";
break;
case'Џ':
newText+="_D0_8F";
break;
case'ӹ':
newText+="_D3_B9";
break;
case'Ӹ':
newText+="_D3_B8";
break;
case'ҍ':
newText+="_D2_8D";
break;
case'Ҍ':
newText+="_D2_8C";
break;
case'ӭ':
newText+="_D3_AD";
break;
case'Ӭ':
newText+="_D3_AC";
break;
case'A':
newText+="_41";
break;
case'a':
newText+="_61";
break;
case'B':
newText+="_42";
break;
case'b':
newText+="_62";
break;
case'C':
newText+="_43";
break;
case'c':
newText+="_63";
break;
case'D':
newText+="_44";
break;
case'd':
newText+="_64";
break;
case'E':
newText+="_45";
break;
case'e':
newText+="_65";
break;
case'F':
newText+="_46";
break;
case'f':
newText+="_66";
break;
case'G':
newText+="_47";
break;
case'g':
newText+="_67";
break;
case'H':
newText+="_48";
break;
case'h':
newText+="_68";
break;
case'I':
newText+="_49";
break;
case'i':
newText+="_69";
break;
case'J':
newText+="_4A";
break;
case'j':
newText+="_6A";
break;
case'K':
newText+="_4B";
break;
case'k':
newText+="_6B";
break;
case'L':
newText+="_4C";
break;
case'l':
newText+="_6C";
break;
case'M':
newText+="_4D";
break;
case'm':
newText+="_6D";
break;
case'N':
newText+="_4E";
break;
case'n':
newText+="_6E";
break;
case'O':
newText+="_4F";
break;
case'o':
newText+="_6F";
break;
case'P':
newText+="_50";
break;
case'p':
newText+="_70";
break;
case'R':
newText+="_52";
break;
case'r':
newText+="_72";
break;
case'S':
newText+="_53";
break;
case's':
newText+="_73";
break;
case'T':
newText+="_54";
break;
case't':
newText+="_74";
break;
case'U':
newText+="_55";
break;
case'u':
newText+="_75";
break;
case'V':
newText+="_56";
break;
case'v':
newText+="_76";
break;
case'Y':
newText+="_59";
break;
case'y':
newText+="_79";
break;
case'Z':
newText+="_5A";
break;
case'z':
newText+="_7A";
break;
case'':
newText+="";
break;
default:
newText+=c;
break;
}
}
returnnewText;
} 
```

这是示例代码

* * *

^SP ^XA ^PON^FS ^FPH^FO102,63,0 ^A@N,60,60,E:ARIOOO_.FNT ^FH^FD_42_75_72_61_6B _D0_A8_D3_99 ^FS ^XZ

* * *

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2015-06-12T13:24:04.947

可以使用免费的[Zebra swiss unicode 字体](https://km.zebra.com/kb/index?page=content&id=SO6820&actp=RSS)打印俄语和许多其他字符。它已作为 TT0003M_ 包含在大多数打印机中，并支持罗马、西里尔、东欧、土耳其、阿拉伯语、希伯来语。

* * *

要打印具有数千个字符的日语或中文等语言，您需要一台至少有 23 MB 可用内存的打印机和一个可以上传的 TrueType 字体文件（他们称之为下载）。

这个文件可以从 Zebra 购买（他们说你需要 64 MB），但我也非常成功地在我的 Windows 7 系统的字体文件夹中找到了一个非常旧的 TTF 文件：ARIALUNI.TTF 1.01（23.275.812 字节） ，[宋体Unicode MS](https://www.microsoft.com/typography/fonts/font.aspx?FMID=1081)。它是由 MS Office 安装安装的，可能未获得此用途的许可。

很可能您也可以使用其他 TTF 文件，但我只尝试了这个。

虽然在此 Zebra 打印机上进行 ZPL 打印时无需任何原始驱动程序（仅通用文本），但字体安装需要驱动程序。如果有人知道如何在没有驱动程序的情况下将 TTF 文件发送到打印机，请发表评论。

我安装了 Zebra Setup Utilities，其中包括一个字体下载器。点击新建，然后添加字体（必须在系统中安装），忽略包含226个字符的消息。还要忽略，如果您使用 Unicode 字符配置测试字符串，它将无法正确显示。有人问您是否要立即下载，这需要很长时间。

您可以通过列出目录内容（管理网页或打印输出）来检查安装。在我的例子中，字体显示为 ARI000.TTF。

* * *

要打印，您需要以 UTF-8 格式发送 ZPL 文本。您可以将此示例复制到记事本并在保存对话框中选择 UTF-8：

```
^XA
^LH100,150
^CWT,E:ARI000.FNT
^CFT,30,30
^CI28
^FT0,0^FH^FDyour unicode characters here^FS
^XZ 
```

然后，为了测试，您可以使用简单的复制命令将其发送到打印机：

如果是 USB，您需要先在网络中共享这台打印机。

然后`net use lpt1: \\localhost\sharename` 和`copy file.txt lpt1`

我们用许多常见的日文和中文符号进行了测试，它在具有 32 MB 闪存的 ZT230 打印机上运行良好，质量上乘。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-12T19:41:50.310

您的“До свидания”可能在 cp1251 中。用实际的 UTF-8 对其进行编码，然后重试。空格是一个很好的指标，表明您有编码问题。

通过 v56.17.112 固件和 ^A@N,,,E:TT0003M_.FNT 验证

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-07-15T17:53:49.160

您可以将大于一个字节的字符替换为带有下划线的 UTF-8 十六进制字符串，例如“ћ => _D1_9B”。下面的示例代码；

```
 var zpl_code = "^XA" +
        "^LH100,150" +
        "^CWT,E:TT0003M_.FNT" +
        "^CFT,30,30" +
        "^CI28" +
        "^FT0,0^FDTesting 1 2 3^FS" +
        "^FT0,50^FDДо свидания^FS" +
        "^FT0,100^B3^FDAAA001^FS" +
        "^XZ";
        var unicodeCharacterList = zpl_code.Distinct()
            .Select(c => c.ToString())
            .Select(c => new { key = c, UTF8Bytes = Encoding.UTF8.GetBytes(c) })
            .Where(c => c.UTF8Bytes.Length > 1);

        foreach (var character in unicodeCharacterList)
        {
            var characterHexCode = string.Join("", character.UTF8Bytes.Select(c => "_" + BitConverter.ToString(new byte[] { c }).ToLower()).ToArray());

            zpl_code = zpl_code.Replace(character.key, characterHexCode);
        } 
```

此代码将 zpl_code 变量设置为低于输出

```
^XA
^LH100,150
^CWT,E:TT0003M_.FNT
^CFT,30,30
^CI28
^FT0,0^FDTesting 1 2 3^FS
^FT0,50^FD_d0_94_d0_be _d1_81_d0_b2_d0_b8_d0_b4_d0_b0_d0_bd_d0_b8_d1_8f^FS
^FT0,100^B3^FDAAA001^FS
^XZ 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-10-11T13:34:25.720

在最新固件版本（自 v x.16.x 起）中，您可以将 ^CI33 用于代码页 Windows-1251 编码文本（和其他代码页），而无需 ^FH。见[手册](https://www.zebra.com/content/dam/zebra/manuals/printers/common/programming/zpl-zbi2-pm-en.pdf)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-11-05T14:21:27.640

如果您想使用 打印俄语西里尔字母`:TT0003M_.FNT`，您应该使用 UTF-8 编码将命令保存到文件中！

```
^XA
^LH100,150
^CWT,E:TT0003M_.FNT
^CFT,30,30
^CI28
^FT0,0^FH^FDTesting 1 2 3^FS
^FT0,30^FH^FDДо свидания^FS
^FT0,100^B3^FDAAA001^FS
^XZ 
```

然后，使用命令行，您可以将其发送到打印机端口。一个例子：复制 C:\Users\xxx\Desktop\test_ru.txt com1

我希望这会有所帮助...

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2019-05-29T05:27:55.910

正如其他人所指出的，请确保使用`^CI28`(Change International Font/Encoding) 和`^FH`(Field Hexadecimal Indicator) 并使用下划线及其十六进制值转义任何非 ascii utf8 字符。

然而，另一个答案包括使用巨大的 switch-case 块格式化 utf8 字符串的代码。这是我用于编码为 utf8 的方法，它应该能够格式化任何有效的 utf8 字节数组。

要从字符串中获取字节数组，请使用`Encoding.UTF8.GetBytes(content)`.

```
// From the wikipedia page on utf8 encoding - https://en.wikipedia.org/wiki/UTF-8
    private const int _Last1ByteCodePointByte1 = 0x7F;
    private const int _First2ByteCodePointByte1 = 0xC0;
    private const int _Last2ByteCodePointByte1 = 0xDF;
    private const int _Last3ByteCodePointByte1 = 0xEF;
    private const int _Last4ByteCodePointByte1 = 0xF7;
    private const int _FirstMultiByteCodePointByte2 = 0x80;
    private const int _LastMultiByteCodePointByte2 = 0xBF;
    private const char _ZplMultiByteEscapeCharacter = '_';

/// <summary>
/// Encodes a sequence of utf8 bytes for printing with the ZPL language, this means escaping multi-byte characters with an underscore ('_') followed by the hex code
/// for each byte in the multi-byte characters.
/// </summary>
/// <param name="utf8Bytes">The bytes that make up the entire string, including bytes that need to be encoded and bytes that can be printed as-is.</param>
/// <returns>A string for printing with the ZPL language. Ie all multi-byte characters escaped with an underscore ('_') followed by the hex code for each byte.</returns>
/// <throws><see cref="ArgumentException"/> when <paramref name="utf8Bytes"/> isn't a valid utf8 encoding of a string.</throws>
/// <remarks>
/// Plan is to figure out how many bytes this character (code point) takes up, and if it's a 1 byte character, just use the character, but otherwise since it's a multi-byte 
/// character then use an underscore ('_') followed by the hex encoded byte and each other byte in this code point will also be encoded. If we start the loop but have bytes 
/// remaining in the current code point we know to hex encode this byte and continue.
/// </remarks>
private static string EncodeUtf8BytesForZPLIIPrinting(byte[] utf8Bytes)
{
    var contentWithMultiByteCharsEscaped = new List<char>();

    var multiByteCodePoint = new List<char>();
    var remainingBytesInCurrentCodePoint = 0;
    string errorMessage = null;

    foreach (byte utf8Byte in utf8Bytes)
    {
        if (remainingBytesInCurrentCodePoint > 0)
        {
            if (utf8Byte < _FirstMultiByteCodePointByte2 || utf8Byte > _LastMultiByteCodePointByte2)
            {
                errorMessage = $"The byte {utf8Byte.ToString("X2")} is not a valid as the second or later byte of a multi-byte utf8 character (codepoint).";
                break;
            }

            multiByteCodePoint.Add(_ZplMultiByteEscapeCharacter);
            AddHexValuesToListFromByte(multiByteCodePoint, utf8Byte);
            remainingBytesInCurrentCodePoint--;
            continue; // continue since we've dealt with this byte and don't want to flow on.
        }

        if (multiByteCodePoint.Any())
        {
            foreach (char c in multiByteCodePoint) contentWithMultiByteCharsEscaped.Add(c);
            multiByteCodePoint.Clear();
            // flow on to loop to see what to do with the current byte.
        }

        if (utf8Byte <= _Last1ByteCodePointByte1)
        {
            // 1 byte - no escaping
            contentWithMultiByteCharsEscaped.Add((char)utf8Byte);
        }
        else if (utf8Byte >= _First2ByteCodePointByte1 && utf8Byte <= _Last2ByteCodePointByte1)
        {
            // 2 bytes
            multiByteCodePoint.Add(_ZplMultiByteEscapeCharacter);
            AddHexValuesToListFromByte(multiByteCodePoint, utf8Byte);
            remainingBytesInCurrentCodePoint = 1;
        }
        else if (utf8Byte <= _Last3ByteCodePointByte1)
        {
            // 3 bytes
            multiByteCodePoint.Add(_ZplMultiByteEscapeCharacter);
            AddHexValuesToListFromByte(multiByteCodePoint, utf8Byte);
            remainingBytesInCurrentCodePoint = 2;
        }
        else if (utf8Byte <= _Last4ByteCodePointByte1)
        {
            // 4 bytes
            multiByteCodePoint.Add(_ZplMultiByteEscapeCharacter);
            AddHexValuesToListFromByte(multiByteCodePoint, utf8Byte);
            remainingBytesInCurrentCodePoint = 3;
        }
        else
        {
            errorMessage = $"The byte {utf8Byte.ToString("X2")} is not a valid as the first byte of a utf8 character.";
            break;
        }
    }

    // if the last char was multiByte add it now.
    if (multiByteCodePoint.Any())
    {
        foreach (var c in multiByteCodePoint) contentWithMultiByteCharsEscaped.Add(c);
        multiByteCodePoint.Clear();
    }

    if (remainingBytesInCurrentCodePoint != 0 && errorMessage == null)
    {
        errorMessage = $"The last character didn't have enough bytes to finish the codepoint. It was a multi-byte character that needed {remainingBytesInCurrentCodePoint}" + 
            $" more byte{(remainingBytesInCurrentCodePoint == 1 ? null : "s")}.";
    }

    if (errorMessage != null)
    {
        throw new ArgumentException($"The byte array was not a valid byte array for a utf8 string: {errorMessage}", nameof(utf8Bytes));
    }

    return new string(contentWithMultiByteCharsEscaped.ToArray());

    void AddHexValuesToListFromByte(List<char> list, byte @byte)
    {
        // A byte is <= 255 so will always fit in a 2-digit hex number, hence the 2 in "X2". The X means hex.
        foreach (char c in @byte.ToString("X2"))
        {
            list.Add(c);
        }
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-08-12T11:58:31.943

当我们使用 CP1251 作为系统编码时，如果我们在 ZPL 代码中编写 Cyrillic，它会导致标签中出现空符号。CP1251 用户可以先强制将“До свидания”转换为 UTF-8 并获得：

Р”Рѕ СЃРІРёРґР°РЅРёСЏ

将 ZPL 代码中的 До свидания 替换为这些奇怪的符号，并在标签上显示“До свидания”。它适用于 tt0003m_.fnt 和 ^CI28，但恕我直言，最好使用十六进制代码。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-06-09T19:08:56.913

我接受了[Dysnomin 的](https://stackoverflow.com/a/56353649/186750)回答并将某些内容转换为 Javascript。他的答案是用 C#

要运行它，只需获取您的字符串对象并调用`variable.zplHexEncode()` 变量是您的字符串的位置。这默认为 _ 用于转义字符。您仍然必须使用该命令为所有`^FD`字段添加前缀。`^FH`就个人而言，我使用类似[doT](https://github.com/olado/doT)模块的东西来创建我的 ZPL，并使用带有转义字符的值填充字段。YMMV。

```
 const _Last1ByteCode = 0x7E;
   const _First2ByteCode = 0xA0;
   const _Last2ByteCode = 0xBF;
   const _Last3ByteCode = 0xFF;
   const _3ByteOffset = 0x40;
   const _ZplEscapeCharacter = '_';
   const _2BytePre = 'c2';
   const _3BytePre = 'c3';

String.prototype.zplHexEncode  = function(){
    var hex, i, escHex;
    var result = "";
    for (i=0; i< this.length; i++) {
        var charCode = this.charCodeAt(i);

        if (charCode <= _Last1ByteCode)
            result += String.fromCharCode(charCode);
        else if (charCode >= _First2ByteCode && charCode <=_Last2ByteCode) {
            hex = charCode.toString(16);
            escHex =  ("0"+hex).slice(-2);
            result += _ZplEscapeCharacter+_2BytePre+_ZplEscapeCharacter+escHex; 
        }
        else if (charCode > _Last2ByteCode && charCode <=_Last3ByteCode) {
            charCode = charCode - _3ByteOffset;
            hex = charCode.toString(16);
            escHex =  ("0"+hex).slice(-2);
            result += _ZplEscapeCharacter+_3BytePre+_ZplEscapeCharacter+escHex; 
        }
        else
            result += '';
    }
    return result
}

var str = "This is a test with a unicode character¿";

console.log(str.zplHexEncode());
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-10-12T09:48:55.597

对于西里尔文，将 ^CI28 更改为 ^CI33 就足够了

```
^XA
^LH100,150
^CWT,E:TT0003M_.FNT
^CFT,30,30
^CI33
^FT0,0^FDTesting 1 2 3^FS
^FT0,50^FDДо свидания^FS
^FT0,100^B3^FDAAA001^FS
^XZ 
```

# windows-runtime - WinRT：如何将 WriteableBitmap 保存到本地文件夹

> ID：13040824
> 
> 赞同：2
> 
> 时间：2012-10-23T23:24:31.430
> 
> 标签：windows-runtime, writeablebitmap

如何在 WinRT 中使用 C# 将 WriteableBitmap 保存到本地文件夹？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T08:07:00.457

您可以检查 WinRT XAML 工具包以获取一组扩展方法来完全满足您的需要：[http ://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/0657c67a93d5#WinRTXamlToolkit%2fImaging%2fWriteableBitmapSaveExtensions.cs](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/0657c67a93d5#WinRTXamlToolkit%2fImaging%2fWriteableBitmapSaveExtensions.cs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T00:01:11.520

这是答案的点点滴滴

```
var bitmap = new WriteableBitmap(width,height);
var stream = bitmap.PixelBuffer.AsStream(); 
```

比您可以将`IOutputStream`数据`Stream`写入本地文件夹。

[这篇](https://stackoverflow.com/questions/221925/creating-a-byte-array-from-a-stream)文章解释了如何转换`Stream`为`byte[]`

[这](https://stackoverflow.com/questions/10290820/how-write-a-file-using-streamwriter-in-windows-8)解释了如何将`byte[]`数组写入本地文件夹。

# php - 大选择减慢页面加载 - 缓存 php

> ID：13040827
> 
> 赞同：0
> 
> 时间：2012-10-23T23:24:55.557
> 
> 标签：php, caching

我正在构建一个 Web 应用程序，我启动该应用程序以进行测试的方式是将大量数据从我的数据库加载到会话数组中，这样我就可以在整个页面中轻松使用这些值。我有一个页面，上面有很多选择，每次 php 页面循环遍历所有变量，选择选定的一个，然后输出下拉列表。我的一个数组虽然只有不到 3000 个值，但加载这个下拉列表会使页面从大约 300 毫秒减慢到 1-1.2 秒。并不可怕，但很容易看出它的响应速度较慢。因此，我想知道是否有任何方法可以提高加载速度，或者对替代下拉菜单有什么想法。

到目前为止我已经尝试过：

1.  会话数组保存所有值，当页面通过 jquery ajax 方法加载时，php 页面循环遍历这些值并回显下拉列表。

2.  PHP 包含 - 创建预先编写为选择的所有值的 php 或 html 页面，这将为问题下拉列表创建一个约 100kb 的页面，然后将其包含在`include`. 需要大致相同的数量加上我必须使用 javascript 来设置值，但如果可以改进，我会这样做。我想也许一些缓存可以在这里提供改进。html 和 php 页面之间似乎没有显着差异，但我认为 html 会更好。我还假设我不能使用常规缓存，因为我正在使用 php 函数来包含这些页面。

3.  我试过只加载 html 页面，第一次加载大约需要 1 秒，在浏览器缓存之后它又回到了 100-350 毫秒，所以我想缓存可以极大地提高性能。

我考虑过：

1.  创建整个页面的缓存版本，但这实现起来会很痛苦，所以我只会在人们认为这是正确的方法时才这样做。我将不得不使用 ajax 来检索我最初使用 php echos 进行的输入的一些数据。

2.  只需删除问题下拉列表。

只是为了澄清一些我从未澄清过的事情，我认为 php 页面永远不会被浏览器缓存是否正确，因此通过扩展任何 php 包含的文件也不能。但是，为什么可以缓存链接到 php 文件中的 javascript 文件，因为它使用的是 html 方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:39:36.933

我怀疑问题出在您传输的数据的原始大小上，基于“到目前为止我已经尝试过什么”中的数字 2 的结果。我认为您不能依赖浏览器缓存，并且服务器端缓存不会改变传输数据的大小。

以下是一些减少页面加载期间传输的数据量的想法：

1.  在交付主页后，使用异步 javascript 调用单独加载选择框。
2.  将选择分解为一系列层次结构的选择。用户选择顶级类别，然后另一个选择框填充匹配的子类别。当他们选择一个子类别时，第三个框会填充该子类别中的实际选项。像 [这样](http://www.pengoworks.com/qforms/docs/examples/n-related_selectboxes.htm)的东西。当然，这仅在使用异步 javascript 调用填充第二和第三控件时才有效。

无论哪种方式，请确保在您的服务器上启用 gzip 压缩。

**编辑：关于浏览器缓存**
的更多信息 浏览器缓存单个文件，您通常不会要求它缓存 PHP 页面，因为下次它们可能会有所不同。（单个 php 包含对浏览器是不可见的，因为 PHP 将它们的内容组合到 HTML 流中。）如果您使用浏览器的开发人员控制台（例如，在 Chrome 上按 f12 并转到网络），您可以看到大多数页面会导致多个从浏览器到服务器的请求，您甚至可能会看到其中一些文件（js、css、图像）来自缓存。

浏览器缓存的内容和缓存时间由各种 HTTP 响应标头控制，例如`Cache-Control`和`Expires`. 如果您不通过调用`header`函数在 php 中覆盖这些，它们将由 Web 服务器 (Apache) 配置控制。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T23:50:31.303

返回并解析为下拉列表的数据可能是您的瓶颈。但是，如果瓶颈实际上是 PHP 代码，您可以尝试在[http://php.net/manual/en/book.apc.php](http://php.net/manual/en/book.apc.php)安装类似 APC 的 optcode 缓存。它会加速你的PHP。（Zend Optimizer 也可在以下网址获得：[http](http://www.zend.com/en/products/guard/runtime-decoders) ://www.zend.com/en/products/guard/runtime-decoders ）

如果您的瓶颈是下拉列表中的项目来自的数据库，您可能需要尝试设置 MySQL 以缓存结果。

您可能还想尝试使用 AJAX 在用户向下滚动时填充下拉列表的替代下拉列表，一次填充几条记录。您还可以将其创建为文本字段，在用户键入时提示可能的匹配项。这些事情可能会更快。

# python - 带有 TimedRotatingFileHandler 后缀的 Python 每日记录器

> ID：13040831
> 
> 赞同：2
> 
> 时间：2012-10-23T23:25:40.003
> 
> 标签：python, logging, python-2.6

我是 Python 和编程的新手，我正在尝试制作一个简单的日常记录器。我想使用`TimedRotatingFileHandler`它，因为它适合我的需要，尽管我不能更改后缀，这很重要。我需要我的日志才能使用“.csv”扩展名。所以我找到了一个`MyTimedRotatingFileHandler`应该添加后缀的类，但不幸的是，我不知道我在哪里做错了。

这是我试图实现的代码，由从网络上获取的几个片段组成。

```
# -*- coding: utf-8 -*-
import serial
import os
import time
import logging
from logging.handlers import TimedRotatingFileHandler

ser = serial.Serial('/dev/ttyACM0', 38400, timeout=15)

class MyTimedRotatingFileHandler(logging.handlers.TimedRotatingFileHandler):
  def __init__(self,dir_log):
  self.dir_log = dir_log
  filename =  self.dir_log+time.strftime("%m%d%Y")+".csv"
  logging.handlers.TimedRotatingFileHandler.__init__(self,filename, 
                        when='S', interval=5, backupCount=0, encoding=None)

def doRollover(self):

   line = ser.readline()
   self.baseFilename = self.dir_log+time.strftime("%d/%m/%Y %H:%M:%S")+".csv"
   self.stream = open(self.baseFilename, 'w')
   self.rolloverAt = self.rolloverAt + self.interval
   a="%s,%s,%s,%s" % (self.baseFileName,'Température :',line,"\n")
#a =  "{0},{1},{2},{3}".format(self.baseFileName,'Température :',line,"\n")
print a 
self.info(a)
#    logger.flush()
ser.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T08:40:06.400

您的缩进似乎不正确，因为`self`(in`self.info(a)`未定义。您可能应该缩进`doRollOver`，因此它是一种方法，`MyTimedRotatingFileHandler`然后在某处实例化该类，调用该方法并检查是否`print a`按预期工作。

# html - 如何在 HTML5 中旋转对象以使其保持原位

> ID：13040833
> 
> 赞同：2
> 
> 时间：2012-10-23T23:25:49.690
> 
> 标签：html

作为主题。我想旋转一个对象，但我不想让它移动到任何地方，只需旋转它并将其留在原处。函数 draw 只是绘制矩形。

```
 <!DOCTYPE html>
    <html>
        <head>
            <script>
            var ctx, canvas;

                window.onload = function(){
                    canvas = document.getElementById('myCanvas');
                    ctx = canvas.getContext('2d');
                    //sciana

                        draw();

                }
            function draw() {
                    //ctx.scale(0.5,0.5);
                    ctx.rotate(Math.PI /6);//here I rotate but it moves...
                    ctx.fillRect( 100, 100, 50, 50);

                    }

            </script>
        </head>
        <body>
            <canvas id="myCanvas" width="600" height="600" style="background-color:#D0D0D0">
                Twoja przeglądarka nie obsługuje elementu Canvas.
            </canvas>
        </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:52:56.703

```
Draw - with shape centered at 0,0
Rotate
Translate - to cx,cy , where cx,cy is the center of the shape, where it is to be located. 
```

为了达到这种效果，您必须以完全相反的顺序对 2D 上下文进行函数调用，如下所示：

```
context.translate(cx, cy);
context.rotate   (radians);
context.fillRect (x, y, width, height); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:28:13.577

只需使用 CSS3 的`rotate`属性。

```
 -webkit-transform: rotate(7.5deg); 
     -moz-transform: rotate(7.5deg); 
      -ms-transform: rotate(7.5deg); 
       -o-transform: rotate(7.5deg); 
          transform: rotate(7.5deg); 
```

通过[CSS 请](http://css3please.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:34:52.933

画布上的旋转功能围绕原点旋转，为了围绕形状的中心旋转，您需要转换到您要绘制的形状的中心，然后旋转，然后绘制形状。

您的最终代码可能如下所示：

```
<!DOCTYPE html>
<html>
    <head>
        <script>
        var ctx, canvas;

            window.onload = function(){
                canvas = document.getElementById('myCanvas');
                ctx = canvas.getContext('2d');
                //sciana

                draw();

            }
            function draw() {
            //ctx.scale(0.5,0.5);
                ctx.translate(125, 125);
                ctx.rotate(Math.PI /6);//here I rotate but it moves...
                ctx.fillRect(-25, -25, 50, 50);

            }

        </script>
    </head>
    <body>
        <canvas id="myCanvas" width="600" height="600" style="background-color:#D0D0D0">
            Twoja przegladarka nie obsluguje elementu Canvas.
        </canvas>
    </body>
</html> 
```

# python - 将原始 IP 数据写入接口 (linux)

> ID：13040834
> 
> 赞同：3
> 
> 时间：2012-10-23T23:25:54.627
> 
> 标签：python, linux, networking, packet

我有一个文件，其中包含二进制形式的原始 IP 数据包。文件中的数据包含完整的 IP 标头、TCP\UDP 标头和数据。我想使用任何语言（最好是 python）来读取这个文件并将数据转储到行上。

在 Linux 中，我知道您可以直接写入某些设备（echo "DATA" > /dev/device_handle）。使用 python 在 /dev/eth1 上打开会达到相同的效果（即我可以做 echo "DATA" > /dev/eth1）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T23:35:17.597

不; 没有`/dev/eth1`设备节点——网络设备与终端和硬盘驱动器等字符/块设备位于不同的命名空间中。您必须创建一个`AF_PACKET`套接字来发送原始 IP 数据包。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T23:35:27.030

就像是：

```
#!/usr/bin/env python
import socket
s = socket.socket(socket.AF_PACKET, socket.SOCK_RAW)
s.bind(("ethX", 0))

blocksize = 100;
with open('filename.txt') as fh:
    while True:
        block = fh.read(blocksize)
        if block == "": break  #EOF
        s.send(block) 
```

应该可以，但是没有测试过。

*   `ethX`需要更改为您的界面（例如`eth1`, `eth2`,`wlan1`等）
*   您可能想玩弄`blocksize`. 一次 100 字节应该没问题，您可以考虑增加，但我会保持在 1500 字节以太网 PDU 以下。
*   为此，您可能需要 root/sudoer 权限。我以前从原始套接字读取时需要它们，从未尝试过简单地写入一个。
*   前提是您确实将数据包（并且只有数据包）转储到文件中。也不是任何类型的编码（例如十六进制）。如果一个字节是 0x30，它在你的文本文件中应该是“0”，而不是“0x30”、“30”或类似的东西。如果不是这种情况，您需要`while`用一些处理替换循环，但`send`仍然是一样的。
*   因为我刚刚读到您正在尝试发送 IP 数据包——在这种情况下，您也可能需要一次构建整个数据包，然后将其推送到套接字。简单的`while`循环是不够的。

# file - 为什么 WQL LIKE 运算符不能在驱动器 c 上工作，但在驱动器 d 上工作正常？

> ID：13040835
> 
> 赞同：0
> 
> 时间：2012-10-23T23:26:19.027
> 
> 标签：file, wmi, monitoring, wildcard, wql

我正在学习文件系统监控以加快我的邮件服务器的第三和第四次备份。我有一个很好的 VB 脚本，可以在驱动器 D 上完美运行，但是当我查询对驱动器 C 的更改时，如果我使用通配符，则不会返回任何内容。

这是我的查询：

这适用于 c:\sc，但不返回子文件夹更改：

```
     Select * From __InstanceOperationEvent Within 10 Where TargetInstance Isa 'CIM_DataFile' And (((TargetInstance.Drive='c:' And TargetInstance.Path = '\\sc\\'))
```

这适用于 d:\sc，并且确实返回子文件夹更改：

```
     Select * From __InstanceOperationEvent Within 10 Where TargetInstance Isa 'CIM_DataFile' And ((TargetInstance.Drive='d:' And TargetInstance.Path LIKE '\\sc\\%'))
```

这个完全没有返回任何变化。没有返回错误消息，脚本继续运行：

```
     Select * From __InstanceOperationEvent Within 10 Where TargetInstance Isa 'CIM_DataFile' And ((TargetInstance.Drive='c:' And TargetInstance.Path LIKE '\\sc\\%'))
```

双括号是为了让我可以添加与“OR”相关的类似查询。

我的系统驱动器是驱动器 C。
驱动器 D 是可移动 USB 驱动器。

我是否更改了系统驱动器上的某些设置以阻止其工作？
或者查询返回的结果太多？

我已经搜索了几个小时。任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T02:55:29.017

这是因为当您`LIKE`在带有[`CIM_DataFile`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa387236%28v=vs.85%29.aspx)类的 WQL 语句中使用运算符时，WMI 会扫描整个驱动器以找到匹配项，现在由于您的 USB 驱动器具有更小（和简单）的树形文件夹结构，WMI 可以返回结果更快速。但是当您使用 C 驱动器时，WMI 仍在运行查询，直到找到所有匹配项。所以建议不要将 LIKE 运算符与 一起使用`CIM_DataFile`，而应`=`像这样使用运算符：

```
Select * From __InstanceOperationEvent Within 1 Where TargetInstance ISA 'CIM_DataFile' And ((TargetInstance.Drive='c:' And TargetInstance.Path = '\\sc\\')) 
```

PD：如果您使用`LIKE`运算符是因为您希望监控多个文件夹中的更改，那么这是不可能的，相反您必须为每个文件夹使用一个 WQL 和事件观察器。

# mod-rewrite - Mod-Rewrite：需要帮助来优化重写规则

> ID：13040836
> 
> 赞同：0
> 
> 时间：2012-10-23T23:26:41.420
> 
> 标签：mod-rewrite, url-rewriting

在更改我的 .htaccess 链接中的某些内容之前，如下所示：

*   [http://www.domain.tld/index.php](http://www.domain.tld/index.php)
*   [http://www.domain.tld/index.php?page=start](http://www.domain.tld/index.php?page=start)
*   [http://www.domain.tld/index.php?page=blog](http://www.domain.tld/index.php?page=blog)

现在我用这段代码做了一个.htaccess：

```
RewriteEngine on
RewriteRule ^index.php / [R,L,QSA] 
```

现在上面的链接在浏览器地址栏中看起来像这样：

*   [http://www.domain.tld](http://www.domain.tld)
*   [http://www.domain.tld/?page=start](http://www.domain.tld/?page=start)
*   [http://www.domain.tld/?page=blog](http://www.domain.tld/?page=blog)

这几乎是我想要的，但我怎样才能让它看起来像这样？

*   [http://www.domain.tld](http://www.domain.tld)
*   [http://www.domain.tld/start](http://www.domain.tld/start)
*   [http://www.domain.tld/blog](http://www.domain.tld/blog)

我尝试了很多不同的东西，但 mod_rewriting 还不是我的强度。我也希望像谷歌这样的搜索引擎使用新的 URL (SEO)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:45:53.977

以下是将链接更改为的解决方案`http://www.domain.tld/index.php?page=blog`是`http://www.domain.tld/blog`：

```
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^\w+$ index.php?page=$0 [L]
RewriteCond %{THE_REQUEST} index\.php
RewriteCond %{QUERY_STRING} ^page=(\w+)$
RewriteRule ^index\.php$ /%1? [R=301,L] 
```

以及以下链接：`http://www.domain.tld/index.php?page=single_news&id=1&headline=This%20Is%20A%Headline`

解决方案是：

```
RewriteRule ^blog/(\d+)-([\w-]+)$ index.php?page=single_news&id=$1&headline=$2 
```

After using this code, links looks like this: `http://www.domain.tld/blog/2-this-is-a-headline`

# javascript - 如何更改占位符的属性和样式？

> ID：13040837
> 
> 赞同：0
> 
> 时间：2012-10-23T23:26:54.293
> 
> 标签：javascript, attributes, styles, placeholder

> **可能重复：**
> [使用 CSS 更改输入的 HTML5 占位符颜色](https://stackoverflow.com/questions/2610497/change-an-inputs-html5-placeholder-color-with-css)
> [在输入焦点上更改占位符跨度的字体颜色](https://stackoverflow.com/questions/8046040/change-font-color-of-placeholder-span-on-input-focus)

**占位符属性和样式**

如何更改占位符的样式？

例如：（字体系列、大小、颜色等）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:33:08.463

其他 CSS 属性的jQuery `$('.class').css('color', '#334455');`相同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:39:54.547

这可以用css来完成。看看这里的答案。[使用 CSS 更改 HTML5 输入的占位符颜色](https://stackoverflow.com/questions/2610497/change-an-inputs-html5-placeholder-color-with-css)

或多或少使用

```
input:-webkit-input-placeholder {
    color:    #999;
}
input:-moz-placeholder {
    color:    #999;
}
input:-ms-input-placeholder {
    color:    #999;
} 
```

# ios - 参考 armv6 验证失败，但 armv6 不在项目中

> ID：13040838
> 
> 赞同：2
> 
> 时间：2012-10-23T23:26:55.577
> 
> 标签：ios, xcode, app-store, armv6

我正在尝试更新 Apple App Store 的应用程序，当我尝试验证它时失败并出现错误“iPhone/iPod Touch：应用程序可执行文件缺少所需的架构。必须至少存在以下架构之一：armv6”。问题是我没有引用我能找到的 armv6 并且我的 ios 部署目标是 4.3。我正在使用 xcode 4.5.1。

Settings:Architectures -> "armv7, armv7s" 适用于所有配置。

我已经尝试过这里推荐的信息以及其他没有成功的东西。 [iOS 6 - “应用程序可执行文件缺少所需的架构：armv6”](https://stackoverflow.com/questions/12608395/ios-6-application-executable-is-missing-required-architecture-armv6)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T01:28:55.567

必须为项目和目标应用程序设置 ios 部署目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T07:29:46.177

如果您的部署目标低于 4.3，请将 armv6 添加到架构中

# mongodb - MongoDB常驻内存峰值，映射内存消失

> ID：13040842
> 
> 赞同：3
> 
> 时间：2012-10-23T23:27:46.123
> 
> 标签：mongodb, memory

我试图了解我在[MMS](https://mms.10gen.com/)日志中看到的 MongoDB 内存使用模式。

通常，常驻内存约为 3GB，虚拟内存稳定在 84GB，映射内存约为 41GB。然后在一系列高峰和低谷中，通常只持续几分钟，映射内存完全消失，虚拟内存下降到 41GB 左右，常驻内存 41GB 或峰值达到 84GB。然而，在最近的一集中，高峰和低谷持续了 3.5 小时。

![mongodb内存高峰和低谷](../Images/5aed8d9a4295e1c878b0ed07f5926ccf.png) ![mongodb内存峰谷详解](../Images/0cb34da1c2e85257c063418ff2789552.png)

MongoDB 似乎运行正常，其他指标（如操作计数器和网络）也正常，但是当负载不太可能发生显着变化时，图表突然发生了巨大变化，这让我......很好奇。

这是一个运行 MongoDB 1.8.3 的独立实例。

典型的内存使用情况，而不是在一集期间（我只发现了较长的一集，因为它正在结束）：

```
$ free -m
             total       used       free     shared    buffers     cached
Mem:         32176      31931        245          0        628      29449
-/+ buffers/cache:       1854      30322
Swap:         1983          0       1983 
```

这是什么原因造成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:40:00.243

MMS 通过读取 /proc/$PID/stat 从操作系统获取内存统计信息。虚拟内存和常驻内存的波动正在报告错误，可以放心地忽略。

（如果您将鼠标悬停在尖峰上，您会注意到它们有时会在 3 个统计数据中的 1 个或 2 个 - 虚拟内存、映射内存或常驻内存 - 丢失时发生......）

# magento - 以编程方式应用多个购物车价格规则 Magento

> ID：13040845
> 
> 赞同：3
> 
> 时间：2012-10-23T23:28:09.557
> 
> 标签：magento

我试图找出一种将多个购物车价格规则应用于 Magento 中的单个购物车的方法。这些规则将是适用于一个客户的独特购物车的“一次性”规则。

[我在这里](https://stackoverflow.com/questions/2798069/creating-a-shopping-cart-price-rule-in-magento-automatically)使用 Allan 的帖子创建规则没有问题，但我一次只能将一个优惠券代码应用于报价对象：

```
Mage::getSingleton('checkout/cart')
->getQuote()
->setCouponCode('foobar')
->collectTotals()
->save(); 
```

我可以将所有自定义价格规则合并到一个规则中，但我仍然面临阻止客户在前端输入他们自己的代码的问题。

数据库中的表`sales_flat_quote`有一个字段`applied_rule_ids`，我猜该字段包含由于在前端输入优惠券代码而未应用的触发购物车规则。有没有办法捎带这个自动过程？

我正在尝试查看是否有一种方法可以优雅地执行此操作，而无需创建自定义总计收集器并向报价和订单对象添加其他属性。

关于攻击路线的任何想法？

# javascript - 如何将对象从 jquery 传递到 javascript

> ID：13040851
> 
> 赞同：0
> 
> 时间：2012-10-23T23:28:28.057
> 
> 标签：javascript, jquery, function, parameter-passing

我想使用选择器将一个对象从 jquery 传递给一个 javascript 函数，如下所示。

```
flash($("#something span"), "#fff", 250); 
```

但它似乎没有工作。

而且我不确定在javascript函数中放什么。我现在做的是：

```
function flash(obj,color1,color2,duration) {
    obj.animate({backgroundColor:color1},duration);
    setTimeout(function(){this.animate({backgroundColor:color2},duration);},duration);
} 
```

还是有另一种方法而不是传递一个对象？例如，在 jquery 中： $("this").flash("#f79999", "#eee", 250);

但是那么如何定义javascript函数呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:30:36.110

您有一个简单的语法错误。

```
ojb.animate({backgroundColor:color},duration); 
```

应该

```
obj.animate({backgroundColor:color},duration); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:51:13.983

您必须包含[jQuery.Color](https://github.com/jquery/jquery-color)插件来为`background-color`.

来自“[*动画属性和值*](http://api.jquery.com/animate/#animation-properties)：”

> 所有动画属性都应该被动画化为*单个数值*，除非下面提到；大多数非数字属性不能使用基本的 jQuery 功能进行动画处理（例如，`width`，`height`，或者`left`可以动画**但`background-color`不能，除非使用 jQuery.Color() 插件**）。[...]

* * *

> 有没有另一种方法而不是传递一个对象？例如，在 jquery 中： $("this").flash("#fff",250);

jQuery 的[插件/创作](http://docs.jquery.com/Plugins/Authoring)应该对此有所帮助。但是，您可以将其定义为：

```
jQuery.fn.flash = function (color, duration) {
    return this.animate({ backgroundColor: color }, duration);
};

$('#something span').flash('#fff', 250); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T00:27:24.490

*在页面中安装了[jQuery.Color](https://github.com/jquery/jquery-color)插件（ack。@Jonathan Lonowski）......*

您可以避免使用 javascript`.call()`或`.apply()`.

这是一个例子：

```
$(function() {
    function flash(color, duration) {
        this.animate({backgroundColor:color}, duration);
    }
    $("#something span").on('click', function() {
        flash.call($(this), "#fff", 250);
    });
    $("#something_else span").on('click', function() {
        flash.apply($(this), ["#fff", 250]);
    });
}); 
```

`.call()`并且`.apply()`在这里不是必需的；常规函数调用就足够了。

`.call()`并且`.apply()`通常用于需要调用一个对象的方法但为其提供另一个对象的上下文的情况。通过这样做，该方法可以在不同的`this`.

# ruby - 运行 gem env 时出错

> ID：13040852
> 
> 赞同：1
> 
> 时间：2012-10-23T23:28:33.660
> 
> 标签：ruby, rubygems

当我运行时`gem env`，我收到以下错误：

```
Error loading RubyGems plugin "/home/chenge/.rvm/gems/ruby-1.9.2-p320@global/gems/rubygems-bundler-0.9.2/lib/rubygems_plugin.rb": undefined method `first' for #<String:0x8ec8670> (NoMethodError) 
```

谁能帮我理解这意味着什么？谢谢。

```
gem clean

Cleaning up installed gems...
Attempting to uninstall rvm-1.11.3.3
Unable to uninstall rvm-1.11.3.3:
    Gem::InstallError: gem "rvm" is not installed
Attempting to uninstall rubygems-bundler-0.9.2
Unable to uninstall rubygems-bundler-0.9.2:
    Gem::InstallError: gem "rubygems-bundler" is not installed
Attempting to uninstall bundler-1.1.3
Unable to uninstall bundler-1.1.3:
    Gem::InstallError: gem "bundler" is not installed

Clean Up Complete 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T02:51:15.920

您`rubygems-bundler`已过时（0.9.2），安装最新版本（[1.1.0](http://rubygems.org/gems/rubygems-bundler/versions/1.1.0)）将解决该问题。

```
$ gem clean
$ gem install rubygems-bundler 
```

我尝试了我的 EC2 实例，它可以工作。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-24T02:28:30.413

问题可能是由以下原因引起的：

*   Ruby 安装不正确
*   RubyGem 安装不正确
*   错误安装的 RVM

我建议您完全删除 ruby​​gem。( `rm /home/chenge/.rvm/gems -rf`) 然后下载最新的 ruby​​gem 然后重新安装。

# r - 计算 R 中的出现次数

> ID：13040854
> 
> 赞同：2
> 
> 时间：2012-10-23T23:28:38.087
> 
> 标签：r

我想计算一个字符在字符串中出现的次数，

我试过了

```
length(grep("3", "987654332")[[1]]) 
```

`[1] 1`

它不计算“3”的第二次出现。

我也试过

```
length(gregexpr("0", "98765432")[[1]]) 
```

`[1] 1`

这可以很好地计算多次出现，但对于未出现的值返回 1。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-23T23:32:22.597

因为当没有匹配时`gregexpr`返回，你可以这样做：`-1`

```
> sum(gregexpr("3", "3398765432")[[1]] != -1)
[1] 3
> sum(gregexpr("0", "3398765432")[[1]] != -1)
[1] 0 
```

# r - 是否可以将一个函数定义为 R 中另一个函数的参数？

> ID：13040856
> 
> 赞同：2
> 
> 时间：2012-10-23T23:29:32.457
> 
> 标签：r, statistics

例如：

```
method1 <- function(alpha,beta,ff) 
```

R允许吗？？？

我试图实现的是：我有一个通用的方法，`method1`. 我还有其他方法：`f2,f3,f4`. 我希望它像`method1 <- function(a,b, ff)`，其中`a`&`b`是常量，最重要的是，`ff`可以是`f2`or`f3`或`f4`，具体取决于我在控制台上调用函数的方式。理想情况下`f2, f3, f4`计算一个矩阵。

使用下面答案中的示例，我想知道为什么我不能有这个？

```
f1 <- function(a,b,ff(a,b))
{
    solve(ff(a,b))
}
f2 <- function (x,y){
    Diag(x*y)
} 
```

这是一个非常糟糕的例子。但我想知道为什么我不能在参数中包含 ff(a,b) ??? 写作的逻辑是什么？

f1 <- 函数(a,b,ff){ ff(a,b) }

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-23T23:31:40.877

取决于你的意思。您可以将函数作为参数传递给另一个函数，并且可以将默认参数设为函数：

```
f <- function(a,b,f2=function(x,y) { x+y}) {
   f2(a,b)
}
f(1,2) ## 3 
```

您可以传递函数调用的结果：

```
f <- function(a,b,c) { a + b + c }
f3 <- function(x,y) { x*y }
f(1,2,f3(3,4)) 
```

但是您不能*完全按照*您指定的方式进行操作：参数必须按照标准的变量命名约定命名（请参阅 参考资料`?make.names`）。

```
f <- function(a,b,f2(1,3)) { ... ## error 
```

您可以通过使用反引号或分配来做到这一点`names(formals(f))[3] <- "f2(1,3)"`，但这很危险，可能不是您想要的。

```
function(a,b,`f2(1,3)`) { } 
```

如果您多解释一下您正在尝试做的事情的背景，您可能会得到更有意义的答案......

**编辑**：根据您的描述进行猜测，您想要我上面描述的第一件事。

```
f1 <- function(a,b,ff) {
   ff(a,b) 
}
f2 <- function(x,y) diag(x)*y
f3 <- function(x,y) matrix(runif(x*y),nrow=x,ncol=y)
f4 <- function(x,y) outer(seq(x),seq(y))
f1(2,2,f2)
##      [,1] [,2]
## [1,]    2    0
## [2,]    0    2
f1(2,2,f3)
##             [,1]       [,2]
## [1,] 0.773723089 0.09640121
## [2,] 0.006206349 0.84351541
f1(2,2,f4)
##      [,1] [,2]
## [1,]    1    2
## [2,]    2    4 
```

# ios - ios6如何播放视频

> ID：13040862
> 
> 赞同：3
> 
> 时间：2012-10-23T23:30:23.377
> 
> 标签：ios, xcode, video, ios6

我很困惑：

MPMoviePlayerViewController 和 MPMoviePlayerController

在 ios6 本地播放视频的最佳方式是什么？

这是我的代码

```
NSURL * url = [NSURL fileURLWithPath: [[NSBundle mainBundle] pathForResource: @ "17" OfType: @ "mov"]];

     MoviePlayer = [[MPMoviePlayerViewController alloc]
                     initWithContentURL: url];
     [self presentMoviePlayerViewControllerAnimated: MoviePlayer];
     [moviePlayer.moviePlayer play];
     [[NSNotificationCenter defaultCenter] addObserver: self selector: @ selector (moviePlayerPlaybackStateChanged :) name: MPMoviePlayerPlaybackStateDidChangeNotification object: nil];
}

-(void)moviePlayerPlaybackStateChanged:(NSNotification *)notification {

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-24T04:03:34.290

MPMoviePlayerViewController 用于播放全屏视频，主要用于手机。

MPMoviePlayerController 可用于嵌入视频，即不能在任何 iPad 上全屏显示。您需要在情节提要中将一个空视图拉到您的场景中，并为其提供所需的大小。然后，在代码中，将电影播放器​​放在该子视图中。您的代码的第一部分应该在 viewDidLoad 中；

```
//movieplayer initialization
NSString *path = [[NSBundle mainBundle] pathForResource:@"videoName" ofType:@"m4v"];
NSURL *videoURL = [NSURL fileURLWithPath:path];
moviePlayer = [[MPMoviePlayerController alloc] initWithContentURL:videoURL];
[moviePlayer setControlStyle:MPMovieControlStyleNone]; // for custom controls, for default controls you can leave this line out. 
```

这部分进入 viewWillAppear；

```
moviePlayer.repeatMode = MPMovieRepeatModeOne; // for looping
[moviePlayer.view setFrame: self.videoSuper.bounds]; 
[self.videoSuper addSubview: moviePlayer.view];
[moviePlayer prepareToPlay];
[moviePlayer play]; 
```

其中 videoSuper 是故事板中添加的子视图。确保正确连接；

```
//in .h
@property (weak, nonatomic) IBOutlet UIView *videoSuper; 
```

# python - 正则表达式将文本放在双引号中，除非以特定单词结尾

> ID：13040865
> 
> 赞同：0
> 
> 时间：2012-10-23T23:30:34.203
> 
> 标签：python, regex

所以我试图在文件出现在双引号中时从文件中获取文本，除非引号中的文本以某个后缀结尾。

例如下面，我希望解析引号中不以 VER 结尾的所有内容。

示例输入：

```
"GameVER": ["GM435615-IQR", "LG-QR435", "HG145-IR9", "WUT828-PQR10"] "VERIZON": ["GKSL42375834-45", "DG-67498", "GF4564", "HFJ-88.8.98"] 
```

输出：

```
GM435615-IQR
LG-QR435
HG145-IR9WUT828-PQR10
VERIZON
GKSL42375834-45
DG-67498
GF4564
HFJ-88.8.98 
```

在python中，我试过这个：

```
re.findall(r'(\"\b.+?)(?!VER)\b\"',text) 
```

但它仍然抓住最后带有 VER 的单词。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T23:49:01.967

这是因为`VER`被困在了`.+?`（这`?`使得`.+`非贪婪，但在这种情况下`....VER`，被抓住的唯一方法是将它放在 中`.+?`）。不要说“匹配后面没有'VER'的东西”，而是尝试“匹配最后3个字符不是VER的单词”（即结尾引号*前面*没有'VER'）。

此外，不要使用`.+`try `[^"]`，这将避免您`.+`在多个单词之间进行匹配。

```
re.findall(r'\"(\b[^"]+)(?<!VER)\b\"',text) 
```

例子：

```
>>> text='"GameVER": ["GM435615-IQR", "LG-QR435", "HG145-IR9", "WUT828-PQR10"] "VERIZON": ["GKSL42375834-45", "DG-67498", "GF4564", "HFJ-88.8.98"]'
>>> re.findall(r'\"(\b[^"]+)(?<!VER)\b\"',text)
['GM435615-IQR', 'LG-QR435', 'HG145-IR9', 'WUT828-PQR10', 'VERIZON', 'GKSL42375834-45', 'DG-67498', 'GF4564', 'HFJ-88.8.98'] 
```

（顺便说一下，您在上面的输出中错过了“HG145-IR9”和“WUT828-PQR10”，尽管它们不以 VER 结尾并且用双引号括起来？）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T00:35:31.767

1.  步骤 1\. 添加逗号。

    ```
    with_commas = "],".join(text.split("]")) 
    ```

2.  步骤 2\. 创建字典。

    ```
    my_dict = eval("{%(text)s}" % {"text": with_commas}) 
    ```

3.  ？？？

    ```
    results = [item for sublist in my_dict.values() for item in sublist]
    for item in my_dict.keys():
        if item[-3:].lower() != "ver":
            results.append(item) 
    ```

4.  利润。

    ```
    print results 
    ```

# java - 处理异常

> ID：13040869
> 
> 赞同：2
> 
> 时间：2012-10-23T23:30:52.213
> 
> 标签：java, exception, exception-handling

我对此代码有疑问，它与异常有关：

```
public class MTest {
    public static void main(String args[]) {
        try {
            m1();
            m2();
        } catch (Exception e1) {
            System.out.println("e");
        }
    }

    static void m1() throws Exception {
        try {
            throw new Exception();
        } catch (Exception e2) {
            System.out.println("m1catch");
        }
    }

    static void m2() throws Exception {
        try {
            throw new Exception();
        } finally {
            System.out.println("Finally");
        }       
    }
} 
```

所以根据上面的代码，教科书告诉我`m2()`方法不处理自己的异常，而是传递给main。这是什么意思？我怎么能从上面的代码中看出？是否`m1()`处理自己的异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:54:51.113

任何可以在方法内抛出的已检查异常都必须在 try/catch 块中进行处理，或者必须声明该方法以抛出该异常。当您尝试编译违反这些规则的代码时，Java 编译器会报错。

`m1()`捕获唯一的已检查异常，因此它处理自己的异常。如果您`throws Exception`从`m1()`的声明中删除，它将正确编译，这意味着它确实处理了所有已检查的异常。

`m2()`不处理它的异常。如果你`throws Exception`从`m2()`'s 声明中删除，你会得到一个编译错误，因为抛出了一个异常但没有被捕获或检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T23:59:40.657

在这种情况下，m1 将处理它自己的异常，而 m2 将把异常传递或“抛出”到 main。这是因为您在 m1 函数中有 catch 语句。基本上，从 try 块抛出的任何异常都将首先搜索是否将此异常作为 try 的一部分处理（在您的代码中）：

`catch (Exception e2){ System.out.println("m1catch"); }`

如果没有 catch 块，就像在 m2 中一样，该函数将假定异常被更高层处理，可能由调用 m2 的函数处理。因为 main() 调用了 m2，所以它是下一个要查看的地方，catch 块将在那里处理异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-09T13:30:47.667

`m1()`使用`try{}`and处理异常`catch`。抛出的异常在***catch block()***中被捕获。

即使 throws Exception 被移除，编译器也不会抛出任何异常。

`m2()`没有捕捉到异常。只有`try{}`块用于抛出异常。异常不在方法内处理。它设置为 throw 到 main 方法。只有在 main 方法中，才会捕获异常。如果从 中删除 throws Exception `m2()`，编译器将抛出“未报告的异常；必须捕获或声明为抛出”

# javascript - 在 jQuery Isotope 或 Masonry 中，我可以忽略一个项目吗？

> ID：13040870
> 
> 赞同：3
> 
> 时间：2012-10-23T23:30:55.717
> 
> 标签：javascript, jquery, jquery-isotope, masonry

我有这个要过滤的项目列表：

```
<ul id="container">
    <li class="item filter">This is where I'd put my filters</li>
    <li class="item">Item 1</li>
    <li class="item">Item 2</li>
    <li class="item">Item 3</li>
</ul> 
```

那么我想像这样执行它......

```
 $container.isotope({
    itemSelector : '.item'
  }); 
```

...但我想要一个像`ignore: '.filter'`. 这样的事情可行吗？

整个目标是将过滤器放在容器内，采用相同的样式和过渡。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-23T23:32:24.997

```
$container.isotope({
    itemSelector : '.item:not(.filter)'
}); 
```

只需使用`:not()`选择器。

**编辑：**

您建议将其包含在初始同位素选择中，并将其作为同位素的一个项目，但不可*过滤*- 至少这是我对您的理解。
因此，要实现这一点，请保留您的原件：

```
$container.isotope({
    itemSelector : '.item'
}); 
```

稍后，当您执行过滤器时，只需始终包含`, .filter`
示例：

```
//Assume something got clicked, which had a data-filter attribute.
var filters = $(this).data('filter');
$container.isotope({
    filter: filters +', .filter'
}); 
```

# javascript - 来自返回 JSON 的新 javascript 数组

> ID：13040875
> 
> 赞同：3
> 
> 时间：2012-10-23T23:31:34.143
> 
> 标签：javascript, jquery, arrays, json

我从 REST 调用返回了一些 JSON 数据，我想对其进行解析、添加总计，然后用新数据输出数组。我已经弄清楚了解析、循环和添加，并且可以将结果写在页面上**（参见帖子：[json 兄弟数据](https://stackoverflow.com/questions/13016304/json-sibling-data)）**，但我想进一步分解总数。这是我开始的 JSON：

```
{“结果集”：{

    “结果”：[

    {
        "file_size":"722694",
        “描述”：“描述1”，
        “格式”：“GIF”
    },

    {
        "file_size":"19754932",
        “描述”：“描述1”，
        “格式”：“JPEG”
    },

    {
        "file_size":"778174",
        “描述”：“描述2”，
        “格式”：“GIF”
    },

    {
        "file_size":"244569996",
        “描述”：“描述1”，
        “格式”：“PNG”
    },

    {
        "file_size":"466918",
        “描述”：“描述2”，
        “格式”：“TIFF”
    }

  ]

}}

```

我已经让它返回每个不同“desc”的总数（**请参阅答案**：[https](https://stackoverflow.com/a/13016615/1766026) ://stackoverflow.com/a/13016615/1766026 ），但现在我想进一步分解它并显示每个“ desc” 与每个“格式”，所以新的输出看起来像：

**描述1：444MB（222MB TIFF、111MB GIF、111MB JPEG）**

**描述2：333MB（111MB PNG、111MB TIFF、111MB JPEG）**

并非所有返回的项目都具有相同类型的文件格式。

*（是的，我知道这些数字不是从 JSON 中加起来的——这只是一个例子）*

我认为这可以通过将结果推送到基于匹配元素的新数组然后迭代并吐出到页面来完成。

也许新的数组/对象看起来像这样？

```
{
    “描述”：“描述1”，
    "TIFF":"222",
    "GIF:"111",
    "JPEG:"111"
},
{
    “描述”：“描述2”，
    "PNG":"111",
    "TIFF:"111",
    “JPEG”：“111”
}

```

我刚刚看到这个：[如何动态创建 JavaScript 数组（JSON 格式）？](https://stackoverflow.com/questions/2250953/how-do-i-create-javascript-arrayjson-format-dynamically)我想这将是一个开始的地方？

*（请原谅可能的不当术语——我主要做前端工作，这种东西对我来说很新——礼貌的建设性批评很乐意接受）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:40:05.813

是的。迭代数组并从中构建您的对象。

```
var arr = parsedObj.ResultSet.Result;

var byDesc = {}; // an object as a key-value-map
for (var i=0; i<arr.length; i++) {
    var desc = arr[i].desc,
        format = arr[i].format;
    if (! (desc in byDesc))
        byDesc[desc] = {};
    if (! (format in byDesc[desc]))
        byDesc[desc][format] = 0;
    byDesc[desc][format] += (+arr[i].file_size); // parseInt
} 
```

现在我们有一个按格式和描述文件大小的对象：

```
{"description1":{"GIF":722694,"JPEG":19754932,"PNG":244569996},"description2":{"GIF":778174,"TIFF":466918}} 
```

要获得所需的输出，我们只需枚举此对象：

```
var output = [];
for (var desc in byDesc) {
    var total = 0,
        formats = [];
    for (var format in byDesc[desc]) {
        formats.push(Math.round(byDesc[desc][format]/1000)+"MB "+format);
        total += byDesc[desc][format];
    }
    output.push(desc+": "+Math.round(total/1000)+"MB ("+formats.join(", ")+")");
}
return output.join("\n"); 
```

我们得到

```
description1: 265048MB (723MB GIF, 19755MB JPEG, 244570MB PNG)
description2: 1245MB (778MB GIF, 467MB TIFF) 
```

# c++ - 在不使用 lambda 的情况下，如何巧妙地创建给定表达式的函数？

> ID：13040880
> 
> 赞同：0
> 
> 时间：2012-10-23T23:31:55.297
> 
> 标签：c++

希望能够做类似的事情

```
std::map<EventType, boost::function<bool(int,int)>  callbackMap;
callbackMap[EVENT1] = boost::bind( magic_creator( this->m_isHerp && !this->m_isDerp ) , _1, _2 ); 
```

基本上给magic_creator一个计算结果为真或假的表达式，它返回一个我可以用boost绑定的函数。因此，在上述情况下，magic_creator 将创建一个函数，该函数将返回 true，而与 _1 和 _2 无关。我无法使用 lamdas，因为它对我没有用。有人为此得到什么吗？

PS 假设 callbackMap 是某个类的一部分，上述代码的当前范围也是如此。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T00:27:04.587

这实际上是可能的，而且对于[Boost Lambda 库](http://www.boost.org/libs/lambda/)、[Boost.Bind](http://www.boost.org/libs/bind/bind.html)或[Boost.Phoenix 来说](http://www.boost.org/libs/spirit/phoenix/)都不是*那么*难看。[`bind`](http://www.boost.org/doc/libs/1_51_0/libs/spirit/phoenix/doc/html/phoenix/composite.html#phoenix.composite.bind)

从任何这些库的调用返回的所有占位符和绑定器类型`bind`都将重载各种运算符，因此您可以轻松地使用它们“动态”创建表达式。使用 Boost.Bind：

```
#include <iostream>
#include <boost/bind.hpp>

struct X{ bool a, b; };

int main(){
  using boost::bind;
  auto op = bind(&X::a, _1) && !bind(&X::b, _1);
  X x{true, false};
  auto test = bind(op, x);
  if(test())
    std::cout << "Yay\n";
} 
```

[活生生的例子。](http://liveworkspace.org/code/add3187bebb79c8d42ba40d6748bcfa3)

当然，这具有通过成员指针的明显缺点。此外，在 C++03 中，您在写出这种“lambda”的类型时遇到了很大的问题，因为它是一个巨大的模板混乱。上面的小例子将产生一个巨大的名字，正如可以在[这里](http://liveworkspace.org/code/90be9bbfaa890856e10ecc598714f1df)看到的那样。由于库解决方案不是“最好的”，标准委员会在语言中添加了 lambdas。耶。

请注意，虽然 C++11`std::bind`表面上看起来很相似，但它是一个*纯粹的 binder*。它不允许您即时创建表达式，因为它不会为任何相关类型重载任何运算符。

# xcode4.5 - 在寄存器分配期间用尽寄存器

> ID：13040882
> 
> 赞同：1
> 
> 时间：2012-10-23T23:32:12.580
> 
> 标签：xcode4.5, neon, clang-static-analyzer

我刚刚更新到 Xcode 4.5.1。现在，当我“分析”我的代码时，我得到了这个错误。请注意，它编译并运行得很好。知道这是为什么吗？

更新 10/25 实际上，我的代码在发布配置中编译并运行良好。但是，在调试配置中，我收到“寄存器用尽...”错误，就像我使用 clang-static-analyzer 进行“分析”时一样。任何帮助表示赞赏。

![在此处输入图像描述](../Images/d59848ea206ef7df21c7b981a5879dac.png)

# python - Python交换数字中的两位数？

> ID：13040891
> 
> 赞同：2
> 
> 时间：2012-10-23T23:32:41.273
> 
> 标签：python, performance, swap

在 Python 中交换数字中两位数的最快方法是什么？我得到了字符串形式的数字，所以如果我能得到一样快的东西就好了

```
string[j] = string[j] ^ string[j+1] 
string[j+1] = string[j] ^ string[j+1]
string[j] = string[j] ^ string[j+1] 
```

我所看到的一切都比 C 语言中的要贵得多，并且涉及制作一个列表，然后将列表转换回来或其一些变体。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T01:32:11.373

这比您想象的要快，至少比 Jon Clements 在我的计时测试中的当前答案快：

```
i, j = (i, j) if i < j else (j, i) # make sure i < j
s = s[:i] + s[j] + s[i+1:j] + s[i] + s[j+1:] 
```

如果您想比较您得到的任何其他答案，这是我的测试平台：

```
import timeit
import types

N = 10000
R = 3
SUFFIX = '_test'
SUFFIX_LEN = len(SUFFIX)

def setup():
    import random
    global s, i, j
    s = 'abcdefghijklmnopqrstuvwxyz'
    i = random.randrange(len(s))
    while True:
        j = random.randrange(len(s))
        if i != j: break

def swapchars_martineau(s, i, j):
    i, j = (i, j) if i < j else (j, i) # make sure i < j
    return s[:i] + s[j] + s[i+1:j] + s[i] + s[j+1:]

def swapchars_martineau_test():
    global s, i, j
    swapchars_martineau(s, i, j)

def swapchars_clements(text, fst, snd):
    ba = bytearray(text)
    ba[fst], ba[snd] = ba[snd], ba[fst]
    return str(ba)

def swapchars_clements_test():
    global s, i, j
    swapchars_clements(s, i, j)

# find all the functions named *SUFFIX in the global namespace
funcs = tuple(value for id,value in globals().items()
            if id.endswith(SUFFIX) and type(value) is types.FunctionType)

# run the timing tests and collect results
timings = [(f.func_name[:-SUFFIX_LEN],
            min(timeit.repeat(f, setup=setup, repeat=R, number=N))
           ) for f in funcs]
timings.sort(key=lambda x: x[1])  # sort by speed
fastest = timings[0][1]  # time fastest one took to run
longest = max(len(t[0]) for t in timings) # len of longest func name (w/o suffix)

print 'fastest to slowest *_test() function timings:\n' \
      ' {:,d} chars, {:,d} timeit calls, best of {:d}\n'.format(len(s), N, R)

def times_slower(speed, fastest):
    return speed/fastest - 1.0

for i in timings:
    print "{0:>{width}}{suffix}() : {1:.4f} ({2:.2f} times slower)".format(
                i[0], i[1], times_slower(i[1], fastest), width=longest, suffix=SUFFIX) 
```

**附录：**

对于以字符串形式给出的正十进制数交换数字字符的特殊情况，以下方法也有效，并且比我答案顶部的一般版本快一点。

使用该`format()`方法在结尾处转换回字符串有点涉及到处理零被移动到字符串前面的情况。我主要把它作为一种好奇心来呈现，因为除非你掌握它在数学上的作用，否则它是相当难以理解的。它也不处理负数。

```
n = int(s)
len_s = len(s)
ord_0 = ord('0')
di = ord(s[i])-ord_0
dj = ord(s[j])-ord_0
pi = 10**(len_s-(i+1))
pj = 10**(len_s-(j+1))
s = '{:0{width}d}'.format(n + (dj-di)*pi + (di-dj)*pj, width=len_s) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T23:50:44.867

它必须是某种可变类型，我能想到的最好的是（虽然不能对性能做出任何声明）：

```
def swapchar(text, fst, snd):
    ba = bytearray(text)
    ba[fst], ba[snd] = ba[snd], ba[fst]
    return ba

>>> swapchar('thequickbrownfox', 3, 7)
bytearray(b'thekuicqbrownfox') 
```

您仍然可以将结果用作`str`/ `list`- 或将其显式转换为`str`if 需要。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T08:49:44.630

```
 >>> int1 = 2
    >>> int2 = 3
    >>> eval(str(int1)+str(int2))
    23 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-24T20:41:55.827

我知道你已经接受了一个答案，所以我不会费心用 Python 编写它，但是你可以在 JavaScript 中这样做，它也有不可变的字符串：

```
function swapchar(string, j)
{
    return string.replace(RegExp("(.{" + j + "})(.)(.)"), "$1$3$2");
} 
```

显然，如果`j`不在适当的范围内，那么它只会返回原始字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-05T12:28:19.583

给定一个整数`n`和两个（从零开始的）索引`i`和`j`要交换的数字，这可以使用 10 的幂来定位数字、除法和模运算来提取它们，以及减法和加法来执行交换。

```
def swapDigits(n, i, j):
    # These powers of 10 encode the locations i and j in n.
    power_i = 10 ** i
    power_j = 10 ** j

    # Retrieve digits [i] and [j] from n.
    digit_i = (n // power_i) % 10
    digit_j = (n // power_j) % 10

    # Remove digits [i] and [j] from n. 
    n -= digit_i * power_i
    n -= digit_j * power_j

    # Insert digit [i] in position [j] and vice versa.
    n += digit_i * power_j
    n += digit_j * power_i

    return n 
```

例如：

```
>>> swapDigits(9876543210, 4, 0)
9876503214
>>> swapDigits(9876543210, 7, 2)
9826543710 
```

# debugging - 调试潮汐应用程序

> ID：13040893
> 
> 赞同：1
> 
> 时间：2012-10-23T23:33:31.583
> 
> 标签：debugging, breakpoints, tidesdk

期待 TideSDK 1.3 的发布。我已经扩展了提供的示例应用程序，但我无法弄清楚如何断点我的代码并单步执行它以进行调试。当然，在浏览器中运行时，我可以使用 chrome 调试工具，但在 Tide 沙箱中，我该如何实现呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T00:38:12.717

实现此目的的一种方法是在应用程序中打开检查器并使用 webkit 检查器来断点并单步执行您的源代码。

# firefox - Firefox 滚动条重置不正确

> ID：13040897
> 
> 赞同：1
> 
> 时间：2012-10-23T23:33:47.293
> 
> 标签：firefox, scrollbar

我在 Firefox 浏览器中遇到了问题。这可能是一个错误，但也许有人知道解决方法。该问题在以下 JSFiddle 中进行了演示：http: [//jsfiddle.net/F5tdB/](http://jsfiddle.net/F5tdB/)这已在 Firefox 12.0、15.0.1、16.0.1 上进行了测试。

用文字来解释......你必须遵循以下事件序列：

1.  获取一个包含`overflow:auto`溢出内容的元素，然后滚动一下；
2.  隐藏元素 ( `display: none`);
3.  删除内容
4.  显示元素（现在是空的）
5.  重新添加相同的内容（现在滚动，就像以前一样）
6.  通过 Javascript 将 scrollTop/scrollLeft 重置为 0。

结果，内容确实滚动到了正确的位置，但滚动条保持原样，这显然是错误的。

是否有任何解决方法来删除/重新添加元素而不是仅仅隐藏它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:45:33.830

在测试中，我发现如果将 scrollTop 设置为 0 以外的任何值（或其当前值），那么它会正确更新滚动条。然后您可以立即将 scrollTop 设置为 0。

特别是当您有一个测试用例时，您当然应该在[Bugzilla](https://bugzilla.mozilla.org/)中提交一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-13T15:07:41.670

解决方案是添加 animate 方法，因此使用：

```
function resetScroll(){
    $(document).scrollTop(1); // removes the impression of animation
    $('html,body').animate({scrollTop:0},'fast','linear');
} 
```

# objective-c - 在调试时，我们如何知道 UIView 的框架或它是如何存储的？

> ID：13040902
> 
> 赞同：0
> 
> 时间：2012-10-23T23:34:39.580
> 
> 标签：objective-c, xcode4.5

看看下面的图片

![在此处输入图像描述](../Images/9dec66ef5c28ad4934a339fa99c106cb.png)

我正在寻找 UIView，但我找不到这个所谓的 _frame 结构。

苹果内部究竟如何存储 UIView 框架？在调试过程中找出这一点的最简单方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:38:37.877

A`UIView`不存储它的框架；它只是返回其图层的框架。

A`CALayer`也不存储它的帧。当您向图层询问其帧时，图层会根据图层的`bounds`、`position`、`anchorPoint`和计算帧`transform`。（可能它缓存了 computed `frame`，但如果你反汇编该`-[CALayer frame]`方法，你会发现从其他属性计算它的代码。）

并且 a`CALayer`不会将任何这些属性存储在实例变量中。相反，它有一个指向`CA::Layer`实例的指针，该实例是一个私有 C++ 对象。该 C++ 对象存储层的属性。该`view->_layer->_attr.layer`字段是指向私有`CA::Layer`实例的指针。

如果你想在调试器中看到一个视图的框架，你必须给它发送一条消息。您可以询问它的描述：

```
po _topBubble 
```

或者你可以询问它的框架：

```
p (CGRect)[_topBubble frame] 
```

# python - 如何使用javascript在Qt（PyQt）应用程序中捕获文件从桌面拖放到QWebView的事件

> ID：13040903
> 
> 赞同：1
> 
> 时间：2012-10-23T23:34:40.790
> 
> 标签：python, qt, pyqt, qtwebkit, qwebview

我正在开发 PyQt 中的应用程序。我用 QWebView 制作了 UI，它加载了一个 HTML 页面。

此 HTML 页面包含一个 javascript 代码，用于检测文件是否被放置在某个 DIV 上。

```
 $(document).ready(function() {
        jQuery.event.props.push('dataTransfer');

        $('.input').bind('drop', function(e) {
            var files = e.dataTransfer.files;
            alert(files[0].name);
        });
    }); 
```

如果我在 Chrome 中加载 HTML 代码，这可以正常工作。

如果我在 QWebView 中运行我的应用程序并 D&D 一个文件，则不会执行 JavaScript 代码。

我扩展了 QWebView 并添加了事件，因此我可以使用 python 捕获 D&D 事件。

```
class BrowserWindow(QtWebKit.QWebView):
def __init__(self, parent):
    super(BrowserWindow, self).__init__(parent)
    self.setAcceptDrops(True)

def dragEnterEvent(self, event):
    if event.mimeData().hasUrls:
        event.accept()
    else:
        event.ignore()

def dragMoveEvent(self, event):
    if event.mimeData().hasUrls:
        event.setDropAction(QtCore.Qt.CopyAction)
        event.accept()
    else:
        event.ignore()

def dropEvent(self, event):
    if event.mimeData().hasUrls:
        event.setDropAction(QtCore.Qt.CopyAction)
        event.accept()
        urls = event.mimeData().urls()
        print str(urls[0].toLocalFile())
    else:
        event.ignore() 
```

是否可以选择在 QWebView 中直接使用 javascript 捕获此类事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T07:03:44.520

如果您的意思是说不用费心实现 D&D 事件并让 javascript 直接捕获它，那么*没有*. 因为 QWebView 必须接受 D&D，然后向 javascript 发出任何此类事件的信号。D&D 仅通过实现 JS 在 chrome 上工作的原因是 chrome 已经启用并实现了 D&D 事件，然后将其发送给 JS。

这类似于将`viewport`任何 QtGui 元素的设置为，`acceptDrop`否则不会触发该元素的 D&D 事件。

# jquery - jQuery noConflict 与 replaceWith 冲突

> ID：13040904
> 
> 赞同：0
> 
> 时间：2012-10-23T23:34:46.747
> 
> 标签：jquery

**我的 HTML**

```
<div class="item-page">
  <div class="Introduction">
    <div class="FrTxtLoans">
      <h1 class="uppercase"> home-mortgage </h1>
    </div>
  </div>
  <div id="main_content">
    <div class="landing_wrapper"> </div>
  </div>
</div> 
```

**我的问题**

我想要做的是移除所有的潜水`<div class="landing_wrapper"> </div>`

**我的脚本**

我正在使用 `$('.item-page').replaceWith($('.landing_wrapper'));`它，它就像一个魅力。

在这里查看[jsFiddle](http://jsfiddle.net/Dt4Au/)

**我的问题**

由于我的网站上有 MooTools 和 jQuery 冲突，我`jQuery.noConflict();`在网站顶部使用并重命名

```
$('.item-page').replaceWith($('.landing_wrapper')); 
```

和

```
jQuery('.item-page').replaceWith($('.landing_wrapper')); 
```

然后 replaceWith 停止工作。[jQuery Conflct jsFiddle 在这里](http://jsfiddle.net/7EadK/)

你们能告诉我这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:35:46.140

您的原始代码实际上是两次调用 jQuery 对象（the `$`），因此在您的第二个示例中，您必须将两个实例替换`$`为`jQuery`

```
jQuery('.item-page').replaceWith(jQuery('.landing_wrapper')); 
```

# javascript - 单个 ASP 文本框上的 jquery 验证

> ID：13040906
> 
> 赞同：-1
> 
> 时间：2012-10-23T23:35:00.777
> 
> 标签：javascript, jquery, validation

我的 Default.aspx 页面上有许多文本框，类似于下面的内容。

`<asp:TextBox ID="myTextbox" runat="server"></asp:TextBox>`

当用户单击按钮提交时，会执行以下 javascript：

```
 $(function () {
            $('#<%= myButton.ClientID %>').click(function (clickToExecuteMyMethod) {
                var userWantsToSubmit = window.confirm("Are you sure you want to press the button?");
                if (userWantsToSubmit) {
                    $.blockUI({ overlayCSS: { backgroundColor: '#00f' }, message: '<h1>Please wait a while...</h1>' });
                }
                if (!userWantsToSubmit) {
                    clickToExecuteMyMethod.preventDefault();
                }
            });
        }); 
```

但是，一旦按下相同的按钮，我还想使用 jquery 来验证是否已在 myTextbox 中输入了某些内容（任何内容）。如果验证成功，那么我希望触发其他 javascript。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T00:11:26.680

对于检查单个文本框的简单情况，只需获取文本框的值`.val()`

```
$('#<%= myButton.ClientID %>').click(function (clickToExecuteMyMethod) {
    var userWantsToSubmit = window.confirm("Are you sure you want to press the button?");

    // Check to see if the textbox is empty
    var isValid = $('#<%= myTextbox.ClientID %>').val() != "";

    if (userWantsToSubmit && isValid) {
        $.blockUI({ overlayCSS: { backgroundColor: '#00f' }, message: '<h1>Please wait a while...</h1>' });
    } else {
        clickToExecuteMyMethod.preventDefault();
    }
}); 
```

不过，这不会是一个非常可扩展的解决方案。我建议您看一下[jquery 验证插件](http://docs.jquery.com/Plugins/Validation)之类的东西，或者尝试使用谷歌搜索其他验证解决方案，周围有很多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T00:18:50.270

如果您使用任何 ASP.Net 页面验证控件，则只需调用客户端验证例程：

```
$(function () {
    $('#<%= myButton.ClientID %>').click(function (clickToExecuteMyMethod) {
        var userWantsToSubmit = window.confirm("Are you sure you want to press the button?");
        Page_ClientValidate('validationGroup'); //validate using ASP.Net validator controls.
        if (userWantsToSubmit && Page_IsValid) {
            $.blockUI({
                "overlayCSS": {
                    "backgroundColor": "#00f"
                },
                "message": "<h1>Please wait a while...</h1>"
            });
        }
        if (!userWantsToSubmit || !Page_IsValid) {
            clickToExecuteMyMethod.preventDefault();
        }
        return Page_IsValid;
    });
}); 
```

# jpa - QueryInvalidParametersException：查询在执行时提供了参数“surveyId”，但查询未使用此参数

> ID：13040907
> 
> 赞同：0
> 
> 时间：2012-10-23T23:35:01.880
> 
> 标签：jpa, datanucleus, createquery

```
@NamedQueries({
    @NamedQuery(name="surveyResponse.getAverageRatings", query="SELECT AVG(ratings) FROM SurveyResponse surveyResponse WHERE surveyResponse.customerSurvey.surveyId = :surveyId"),
    @NamedQuery(name="surveyResponse.getBySurvey",  query = "SELECT FROM SurveyResponse surveyResponse WHERE surveyResponse.customerSurvey.surveyId = :surveyId")})
public class SurveyResponse implements Serializable {
    @Id @GeneratedValue(strategy=GenerationType.SEQUENCE,  
    generator="SURVEY_RESPONSE_SEQUENCE") 
    @Column(name="SURVEYRESPONSEID")
    private long surveyResponseId; 

    @ManyToOne(fetch=FetchType.EAGER, cascade=CascadeType.DETACH)
    @JoinColumn(name="QNo", referencedColumnName="qNo")
    private Questionair questionair;

    @ManyToOne(fetch=FetchType.EAGER)
    @JoinColumn(name="SURVEYID", referencedColumnName="surveyId")
    private CustomerSurvey customerSurvey;

    @Column(name="RATINGS")
    private int ratings;

    .....
} 
```

持久性类：

```
 public void submitSurveyResponse(List<CustomerSurvey> surveys) throws WorkServiceException {
    EntityManager em = entityManagerFactory.createEntityManager();
    EntityTransaction tx = em.getTransaction();
    tx.begin();

    for (CustomerSurvey survey : surveys) {
        survey.setRespondedOn(Calendar.getInstance().getTime());
        String surveyId = survey.getSurveyId();
        Query query = em.createNamedQuery("surveyResponse.getAverageRatings").setParameter("surveyId", surveyId);

        Double avgRating = (Double) query.getSingleResult();
        BigDecimal bd = BigDecimal.valueOf(avgRating);
        bd = bd.setScale(2, RoundingMode.HALF_UP);
        avgRating = bd.doubleValue();

        survey.setAvgRatings(avgRating);
        CustomerSurvey mSurvey = em.merge(survey);
        em.flush();
    }
    tx.commit();
    em.clear();
    em.close();
} 
```

原因 ：

```
2012-10-24 11:33:57,042[SpringOsgiExtenderThread-34]|DEBUG|DataNucleus.Transaction|147-org.datanucleus-3.1.1|Object "com.ge.dsp.iwork.entity.SurveyResponse@3a45cd18" (id="com.ge.dsp.iwork.entity.SurveyResponse:290") being evicted from transactional cache
2012-10-24 11:33:57,043[SpringOsgiExtenderThread-34]|DEBUG|DataNucleus.Transaction|147-org.datanucleus-3.1.1|Object "com.ge.dsp.iwork.entity.SurveyResponse@3a45cd18" (id="com.ge.dsp.iwork.entity.SurveyResponse:290") is not transactional
2012-10-24 11:33:57,043[SpringOsgiExtenderThread-34]|DEBUG|DataNucleus.Datastore|147-org.datanucleus-3.1.1|Closing PreparedStatement "org.datanucleus.store.rdbms.ParamLoggingPreparedStatement@3c9c008b"
2012-10-24 11:33:57,100[SpringOsgiExtenderThread-34]|DEBUG|DataNucleus.Transaction|147-org.datanucleus-3.1.1|Transaction created [DataNucleus Transaction, ID=Xid=   ', enlisted resources=[]]
2012-10-24 11:33:57,101[SpringOsgiExtenderThread-34]|DEBUG|DataNucleus.Transaction|147-org.datanucleus-3.1.1|Transaction begun for ObjectManager org.datanucleus.ObjectManagerImpl@1326f1a6 (optimistic=true)
2012-10-24 11:33:57,104[SpringOsgiExtenderThread-34]|DEBUG|com.ge.dsp.kernel.bootloader.impl.DspServiceListener|153-dsp.kernel-0.8.0|MODIFIED
2012-10-24 11:33:57,104[SpringOsgiExtenderThread-34]|DEBUG|com.ge.dsp.kernel.bootloader.impl.DspServiceListener|153-dsp.kernel-0.8.0|ServiceReference [cxf-dosgi-ri-topology-manager] {org.osgi.service.remoteserviceadmin.EndpointListener}={endpoint.listener.scope=[(&(objectClass=org.apache.aries.blueprint.NamespaceHandler)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.aries.proxy.ProxyManager)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=javax.management.MBeanServer)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.features.FeaturesService)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.admin.AdminService)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.jaas.config.JaasRealm)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.jaas.config.KeystoreInstance)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.diagnostic.core.DumpProvider)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.features.FeaturesListener)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.jaas.config.KeystoreManager)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.jaas.modules.BackingEngineFactory)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.geronimo.osgi.registry.api.ProviderRegistry)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=javax.persistence.spi.PersistenceProvider)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.shell.commands.info.InfoProvider)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=com.ge.dsp.kernel.spi.DspServiceManagerService)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(&(component=jetty)(objectClass=org.apache.camel.spi.ComponentResolver))(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(&(component=bean)(objectClass=org.apache.camel.spi.ComponentResolver))(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(&(component=direct)(objectClass=org.apache.camel.spi.ComponentResolver))(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(&(component=log)(objectClass=org.apache.camel.spi.ComponentResolver))(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(&(language=simple)(objectClass=org.apache.camel.spi.LanguageResolver))(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.camel.spi.TypeConverterLoader)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=com.ge.dsp.kernel.spi.DspKernelPluggable)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=com.ge.dsp.dsi.clustering.DspClusterManager)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=com.ge.dsp.kernel.spi.DspWebServiceEnabler)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=com.ge.dsp.dsi.config.ConfigurationServiceFactory)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44)))],service.id=127}
2012-10-24 11:33:57,104[SpringOsgiExtenderThread-34]|DEBUG|com.ge.dsp.kernel.bootloader.impl.DspServiceListener|153-dsp.kernel-0.8.0|Found activities of NON-DSP services: ServiceReference [cxf-dosgi-ri-topology-manager] {org.osgi.service.remoteserviceadmin.EndpointListener}={endpoint.listener.scope=[(&(objectClass=org.apache.aries.blueprint.NamespaceHandler)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.aries.proxy.ProxyManager)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=javax.management.MBeanServer)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.features.FeaturesService)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.admin.AdminService)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.jaas.config.JaasRealm)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.jaas.config.KeystoreInstance)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.diagnostic.core.DumpProvider)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.features.FeaturesListener)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.jaas.config.KeystoreManager)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.jaas.modules.BackingEngineFactory)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.geronimo.osgi.registry.api.ProviderRegistry)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=javax.persistence.spi.PersistenceProvider)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.karaf.shell.commands.info.InfoProvider)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=com.ge.dsp.kernel.spi.DspServiceManagerService)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(&(component=jetty)(objectClass=org.apache.camel.spi.ComponentResolver))(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(&(component=bean)(objectClass=org.apache.camel.spi.ComponentResolver))(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(&(component=direct)(objectClass=org.apache.camel.spi.ComponentResolver))(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(&(component=log)(objectClass=org.apache.camel.spi.ComponentResolver))(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(&(language=simple)(objectClass=org.apache.camel.spi.LanguageResolver))(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=org.apache.camel.spi.TypeConverterLoader)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=com.ge.dsp.kernel.spi.DspKernelPluggable)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=com.ge.dsp.dsi.clustering.DspClusterManager)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=com.ge.dsp.kernel.spi.DspWebServiceEnabler)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44))), (&(objectClass=com.ge.dsp.dsi.config.ConfigurationServiceFactory)(!(endpoint.framework.uuid=eae78622-cdca-4196-ab13-f298ac516e44)))],service.id=127}
2012-10-24 11:33:57,177[SpringOsgiExtenderThread-34]|ERROR|org.springframework.osgi.extender.internal.activator.ContextLoaderListener|61-org.springframework.osgi.extender-1.2.1|Application context refresh failed (OsgiBundleXmlApplicationContext(bundle=dsp.dsp-iwork, config=osgibundle:/META-INF/spring/*.xml))
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'testSubmitSurveyResponse' defined in URL [bundle://170.45:0/META-INF/spring/module-context.xml]: Invocation of init method failed; nested exception is java.lang.IllegalArgumentException: Query has parameter "surveyId" supplied at execution yet the query doesnt make use of this parameter
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1455)[54:org.springframework.beans:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)[54:org.springframework.beans:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)[54:org.springframework.beans:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)[54:org.springframework.beans:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)[54:org.springframework.beans:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)[54:org.springframework.beans:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193)[54:org.springframework.beans:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:609)[54:org.springframework.beans:3.1.2.RELEASE]
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:918)[56:org.springframework.context:3.1.2.RELEASE]
    at org.springframework.osgi.context.support.AbstractDelegatedExecutionApplicationContext.access$1600(AbstractDelegatedExecutionApplicationContext.java:69)[60:org.springframework.osgi.core:1.2.1]
    at org.springframework.osgi.context.support.AbstractDelegatedExecutionApplicationContext$4.run(AbstractDelegatedExecutionApplicationContext.java:355)[60:org.springframework.osgi.core:1.2.1]
    at org.springframework.osgi.util.internal.PrivilegedUtils.executeWithCustomTCCL(PrivilegedUtils.java:85)[60:org.springframework.osgi.core:1.2.1]
    at org.springframework.osgi.context.support.AbstractDelegatedExecutionApplicationContext.completeRefresh(AbstractDelegatedExecutionApplicationContext.java:320)[60:org.springframework.osgi.core:1.2.1]
    at org.springframework.osgi.extender.internal.dependencies.startup.DependencyWaiterApplicationContextExecutor$CompleteRefreshTask.run(DependencyWaiterApplicationContextExecutor.java:132)[61:org.springframework.osgi.extender:1.2.1]
    at java.lang.Thread.run(Thread.java:662)[:1.6.0_34]
Caused by: java.lang.IllegalArgumentException: Query has parameter "surveyId" supplied at execution yet the query doesnt make use of this parameter
    at org.datanucleus.api.jpa.JPAQuery.setParameter(JPAQuery.java:440)
    at org.datanucleus.api.jpa.JPAQuery.setParameter(JPAQuery.java:56)
    at com.ge.dsp.iwork.persistence.JpaWorkPersistence.submitSurveyResponse(JpaWorkPersistence.java:402)
    at com.ge.dsp.iwork.impl.WorkServiceImpl.submitSurveyResponse(WorkServiceImpl.java:239)
    at com.ge.dsp.iwork.test.WorkServiceTest.testSubmitSurveyResponse(WorkServiceTest.java:264)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)[:1.6.0_34]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)[:1.6.0_34]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)[:1.6.0_34]
    at java.lang.reflect.Method.invoke(Method.java:597)[:1.6.0_34]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeCustomInitMethod(AbstractAutowireCapableBeanFactory.java:1581)[54:org.springframework.beans:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1522)[54:org.springframework.beans:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1452)[54:org.springframework.beans:3.1.2.RELEASE]
    ... 14 more
Caused by: org.datanucleus.store.query.QueryInvalidParametersException: Query has parameter "surveyId" supplied at execution yet the query doesnt make use of this parameter
    at org.datanucleus.store.query.Query.applyImplicitParameterValueToCompilation(Query.java:881)
    at org.datanucleus.store.query.AbstractJPQLQuery.compileInternal(AbstractJPQLQuery.java:310)
    at org.datanucleus.store.rdbms.query.JPQLQuery.compileInternal(JPQLQuery.java:202)
    at org.datanucleus.store.query.Query.setImplicitParameter(Query.java:799)
    at org.datanucleus.store.rdbms.query.JPQLQuery.setImplicitParameter(JPQLQuery.java:147)
    at org.datanucleus.api.jpa.JPAQuery.setParameter(JPAQuery.java:436)
    ... 25 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T04:04:47.107

我想，没关系。但有一件事`referencedColumnName`是`CustomerSurvey`。

更改`referencedColumnName="surveyId"`为`referencedColumnName="SERVEYID"`。使用大写字母，因为您在`CustomerSurvey`实体（[Previous Post](https://stackoverflow.com/questions/13039252/jdodetachedfieldaccessexception-you-have-just-attempted-to-access-field-attach)）中使用大写字母。

你可以参考[这里](https://stackoverflow.com/questions/6277858/jpa-one-to-many-unidirectional-relationship-using-a-join-table)。

**更新答案：**

当我检查您的查询`surveyResponse.getAverageRatings`时，缺少`AVG(ratings)`. 我认为，应该`AVG(surveyResponse.ratings)`。

```
SELECT AVG(surveyResponse.ratings) FROM SurveyResponse surveyResponse WHERE surveyResponse.customerSurvey.surveyId = :surveyId 
```

# flash - Flash SWF Audio Microphone 发送二进制数据？

> ID：13040914
> 
> 赞同：0
> 
> 时间：2012-10-23T23:36:21.153
> 
> 标签：flash, audio, actionscript, flex4, streaming

我有一个关于 Flash 的问题。是否可以通过 Flash 获取麦克风数据并将其作为二进制流/数据发送？

我只知道 NetStream 方法并将 Mic 与 Streaming Server 连接，但我想尝试其他方法。是否有可能从闪存中获取二进制麦克风数据？

非常感谢 ！

# jquery - $.getJSON 和 $.ajax 在 IE 中不起作用

> ID：13040917
> 
> 赞同：0
> 
> 时间：2012-10-23T23:36:46.840
> 
> 标签：jquery, ajax, internet-explorer

惊喜，惊喜……我的代码在 Chrome 和 FF 中运行良好，但在 IE 中却不行。以下代码正在执行跨域 JSON 请求。如果 JSON 结果的长度大于 1，则假设使用单选按钮显示所有结果。否则，它会采用返回的单个地址并继续进行重定向。在 IE 中，它总是用单选按钮显示结果，就好像它总是 > 1。我在这里做错了什么？感谢您的帮助。

```
var url="http://clvplaces.appspot.com/maptools/rest/services/geocode?address=";
var address = someStreetNumber + " " + someStreetName;
var city = ", Las Vegas, NV";
var score = "&score=50";
var jsonCB = "&format=json&jsonCallback=?";

$.getJSON(url+address+city+score+jsonCB, function(results){
    if(results.response.length > 1) {
        $.each(results.response, function(i, item) {
            showAddresses(item)
        });
   }
   else {
        var busAdd = results.response[0].streetno + " " + results.response[0].streetname;
        busAdd += ", " + results.response[0].city + ", " + results.response[0].zip;
            var latLong = results.response[0].latlng;
        getJurisdiction(latLong, address);
      }
}); 
```

我读过 IE 中的 $.getJSON 倾向于缓存结果，因此改用 $.ajax。所以，我把 $.getJSON 块换成了：

```
$.ajax({
  url: url+address+city+score+jsonCB,
  cache: false,
  dataType: "json",
  success: function(results) {
    // same if - else statements here
}}); 
```

这种变化完全没有解决这个问题。此外，做任何这个服务器端对我来说不是一个选择......不幸的是。

编辑/更新：

单次退货的结果如下所示。IE 总是显示来自我的 IF 语句的单个或多个结果，而 Chrome 和 FF 将显示来自 ELSE 语句的单个结果，因为它们应该：

```
?({ 
    errormsg: '',
    response: [
        {
            latlng:'36.167352999999999,-115.148408',
            score:'50',
            streetno:'495',
            streetname:'S Main St',
            city:'Las Vegas',
            state:'NV',
            zip:'89101'
        },
    ]
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T00:40:46.367

您需要添加

```
type : 'GET' 
```

为了让您的 Ajax 请求在 IE 中工作...

在某些版本中缺少类型会引发错误

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:44:29.930

尝试将其添加到 url：

```
var randomNum = Math.random() * 1000  | 1;
url = url + "?randomNum=" + randomNum; 
```

# android - 在 Google 的 CTS 中，名为 cts-tradefed 的脚本代表什么？

> ID：13040918
> 
> 赞同：0
> 
> 时间：2012-10-23T23:37:08.260
> 
> 标签：android, android-testing, cts

我刚刚开始使用 Google 的 CTS，遇到了一个脚本，它对它的解释很少 - cts-tradefed。我在网上搜索并找到了一些提到它的资源，例如[CDD](http://static.googleusercontent.com/external_content/untrusted_dlcp/source.android.com/en/us/compatibility/4.1/android-4.1-cdd.pdf)和[CTS 手册](http://static.googleusercontent.com/external_content/untrusted_dlcp/source.android.com/en/us/compatibility/android-cts-manual-r5.pdf)，但没有任何地方说明它代表什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:43:49.243

它的意思是“贸易联盟”……你知道，[来自*《星球大战》*](http://en.wikipedia.org/wiki/Trade_Federation)的东西。至于*为什么*这么叫？谁知道。

# c# - 我们可以将自定义对象从 Excel 传递到 C# ExcelDNA 吗？

> ID：13040919
> 
> 赞同：3
> 
> 时间：2012-10-23T23:37:16.630
> 
> 标签：c#, excel, vba, excel-dna

我有一个对象：

```
public class Shampoo
{
public string Name {get;set;}
public string Id {get;set;}
public string PriceRegion {get;set;}
} 
```

我可以通过 Excel DNA 将此对象传递给 C# 中的方法吗：

C#方法是：

```
public static string PassShampoo(Shampoo shampoo)
{
//Some Code...
} 
```

这可以通过 Excel DNA 从 VBA 到 C# 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T13:28:52.360

您的 .NET 库可以将该`Shampoo`类导出并注册为 COM 可见类型，然后您可以从 VBA 将其实例化为`Dim sh = New Shampoo()`. 类似地，可以定义其他类型，例如

```
public class Shopper()
{
    public string ReadLabel(Shampoo shampoo)
    {
        return shampoo.Name;
    }
} 
```

然后 a`New Shopper()`可以通过`shampoo`：

```
Dim anne As Shopper = New Shopper()
Dim dove As Shampoo = New Shampoo()

Dim label As String
label = anne.ReadLabel(dove) 
```

使用`Shampoo`(`Shopper.ReadLabel`上面) 的方法不会`static`也不会作为 UDF 或任何东西对 Excel 可用 - 就像通过 VBA 的 COM 互操作调用的 .NET 对象上的方法一样。

到目前为止 - 没有涉及[Excel-DNA 。](http://exceldna.coodeplex.com)您可以使用标准的 .NET 程序集来完成所有这些工作，该程序集使用正确的标志和属性进行编译，并在您的计算机上注册了 COM 互操作。

但是，Excel-DNA 还允许您的加载项成为 COM 服务器。这意味着 .xll 可以托管您在库中定义的 COM 类，您的加载项可以进行 COM 注册（而不是安装程序）而无需管理员访问权限，并且您的 COM 对象将与加载项的其余部分。所以 Excel-DNA 有助于粘合，但 VBA 代码和您的 .NET 程序集之间的实际交互是标准的 .NET-to-COM 互操作，一旦您稍微爬上学习曲线，它就可以很好地工作.

# objective-c - 解析 Twitter 获取状态目标 C

> ID：13040923
> 
> 赞同：1
> 
> 时间：2012-10-23T23:37:51.650
> 
> 标签：objective-c, ios, twitter, ios6

我目前正在一个 iOS 应用程序中解析来自 Twitter 的推文。我的应用程序目前可以使用 API 调用执行搜索`search.twitter.com/search.json?...`，并且我的应用程序可以解析这些推文并为每条推文选择我想要的所有数据。我现在正处于尝试获取用户时间线的阶段，但我似乎无法找到一种稳定的方法来解析从用户的时间线 API 调用返回的对象。

[使用搜索功能（例如： https](https://dev.twitter.com/docs/api/1/get/search) ://dev.twitter.com/docs/api/1/get/search底部的返回对象），我可以通过选择`valueForKey:(@"results")`并遍历所有这些结果来解析，如下所示：

```
 //jSONText is the returned result from the API in NSDictionary format
    NSArray *resultTweetsJSON = [jSONText valueForKey:(@"results")];

    for (int tweetIndex=0; tweetIndex<[resultTweetsJSON count]; tweetIndex++) {

        //Loop through and pull out raw tweet content for a specific tweet
        NSString *rawTweetContent = [resultTweetsJSON objectAtIndex:tweetIndex];

        //Build a custom tweet object using that content
        Tweet *singleTweet = [[Tweet alloc] initWithResultsContent:rawTweetContent];
    } 
```

我希望我可以执行相同或相似的事情，但我似乎无法找到用于从时间线返回的数据的好键（示例返回的数据靠近底部：[https://dev.twitter。 com/docs/api/1/get/statuses/user_timeline](https://dev.twitter.com/docs/api/1/get/statuses/user_timeline)）。

如您所见，`user_time`结果集不包含`results`我可以从中查询的漂亮“”键。

如何轻松地从对`Get/Statuses/User_Timeline`Twitter API 的调用中选择和解析数据并将其转换为 NSArray 以便我可以循环并提取推文？网上的一切似乎都使用了旧技术。我找到[了本教程](http://blog.merrycode.com/simplest-way-to-do-json-parsing-in-objective-c-using-nsjsonserialization/)，但它似乎将 Twitter 的响应作为 NSData 对象而不是 NSDictionary 对象，我相信 NSDictionary 是最新的方法。

这是我认为*可能*有用的东西：

```
 //No valueForKey to use, so perhaps use ""?
    NSArray *timeline = [jSONText valueForKey:(@"")];

    for (int i=0; i<[timeline count]; i++) {
     //Looping through each "object" of the timeline, grab the tweet content then fill user content

        //Grab the "user" object from the timeline object we're looking at
        NSString *rawUserContent = [[timeline objectAtIndex:i] valueForKey:(@"user")];
        //NSString *rawUserContent = [timeline valueForKey:(@"user")]; - Maybe this?

        //Do whatever else I need to do here...

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-29T19:00:55.497

几天后，我发现我只是把问题复杂化了。我需要做的就是转换为数组并进行相应的解析。

```
 //The above code was taken out for brevity.  
    //userTimeline = the returned result from the API call to Get User Timeline
    NSDictionary *userTimeline = [NSJSONSerialization JSONObjectWithData:responseData options:0 error:&jsonParsingError];

    //convert the NSDictionary to an array
    NSArray *timeline = (NSArray*)userTimeline;

    //loop through the timeline array object
    for (int i=0; i<[timeline count]; i++) {
        //Looping through each "object" of the timeline, grab the tweet content then fill user content

        //Grab the "User" section of the tweet we're looking at
        NSString *rawUserContent = [[timeline objectAtIndex:i] valueForKey:(@"user")];

        //Fill singleTweet with user content
        //initWithUserContent is a custom method I wrote to parse apart the User data
        //Tweet is a custom class I wrote to hold data about a particular tweet
        Tweet *singleTweet = [[Tweet alloc] initWithUserContent:rawUserContent];

        //At this point singleTweet will be filled with user content, so now fill with tweet content (text and created_at for now)
        singleTweet.text = [[timeline objectAtIndex:i] valueForKey:(@"text")];
        singleTweet.created_at = [[timeline objectAtIndex:i] valueForKey:(@"created_at")]; 
```

然后，我将所有上述代码包装在一个 if 语句中。如果用户正在执行搜索（使用 Twitter 的搜索 API），我将执行上述问题中的所有代码，如果用户正在从用户的时间线中执行选择，我将执行此答案中的所有代码。

像魅力一样工作，我现在可以正确解析两个 JSON 返回的结果，我需要做的就是将字典转换为数组。

# playframework - Greenscript 可以/是否更改内容更改时生成的文件名？

> ID：13040925
> 
> 赞同：0
> 
> 时间：2012-10-23T23:38:08.200
> 
> 标签：playframework, greenscript

我们在 Play 1.2.5 上使用 Greenscript 1.2.8b 来缩小和合并 JavaScript 和 CSS 文件。我正在调查我们遇到的一些缓存问题，并注意到 Greenscript 生成的文件名在我们部署新版本时似乎没有改变。

当内容发生变化时，我们有什么办法可以强制它为组合的 JS 或 CSS 文件生成一个新的文件名？

编辑：我接受了下面的答案，因为它应该适用于大多数人。但是，它弄乱了我的 CSS 中的路径，所以我最终得到了一些稍微不同的东西。我在 application.conf 中添加了以下行：

```
greenscript.url.minimized=/gs/VERSION 
```

在我的构建脚本中，我将 VERSION 替换为源代码管理中的最新版本号。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T00:54:28.890

根据[https://groups.google.com/forum/#!msg/play-framework/1saij-OP1go/grzGIoBXSTAJ](https://groups.google.com/forum/#!msg/play-framework/1saij-OP1go/grzGIoBXSTAJ)，您可以尝试以下方法：

1.  将名为“.version”的文件添加到您的项目主页，每次部署项目更改时更新该文件
2.  将以下行添加到路由文件中：

    `GET /public/%{out.write(play.getVirtualFile(".version").contentAsString())}%/ staticDir:public`

3.  将以下配置添加到`application.conf`：

    `greenscript.router.mapping=true`

# c# - 使用命名空间 C# 解析 XML

> ID：13040926
> 
> 赞同：2
> 
> 时间：2012-10-23T23:38:10.293
> 
> 标签：c#, .net, xml, xml-parsing, xml-namespaces

我整天都在致力于解析这些 XML 数据。看来我的问题是名称空间。[我认为我的上一个网站http://www.codeproject.com/Articles/30965/Read-XML-with-Namespace-resolution-using-XLinq-XEl](http://www.codeproject.com/Articles/30965/Read-XML-with-Namespace-resolution-using-XLinq-XEl)有一线希望，但它也失败了。每次我运行下面的代码时，我都会得到“对象引用未设置为对象的实例”。似乎有很多用 C# 解析 XML 的方法，但是这些命名空间让我很生气。我究竟做错了什么？

请记住，我是 XML 和 C# 的新手，并且习惯于解析 JSON 数据。是的，我用谷歌搜索了几种解析 XML 数据的方法，在这种情况下没有任何用处。我可以在没有命名空间的情况下获得 XML，但使用它们总是会出现该错误。

C#代码：

```
 XElement element = XElement.Parse(xml);

 XNamespace ns2 = "http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd";
 string val = element.Element(ns2 + "ItemDimensions").Element(ns2 + "Heigth").Value;
                                Console.WriteLine(val); 
```

XML 数据：

```
<ns2:ItemAttributes xml:lang="en-US" xmlns:ns2="http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd">
  <ns2:Author>Troelsen, Andrew</ns2:Author>
  <ns2:Binding>Paperback</ns2:Binding>
  <ns2:Brand>Apress</ns2:Brand>
  <ns2:Edition>5</ns2:Edition>
  <ns2:ItemDimensions>
    <ns2:Height Units="inches">9.21</ns2:Height>
    <ns2:Length Units="inches">7.48</ns2:Length>
    <ns2:Width Units="inches">2.52</ns2:Width>
    <ns2:Weight Units="pounds">5.80</ns2:Weight>
  </ns2:ItemDimensions>
  <ns2:IsAutographed>false</ns2:IsAutographed>
  <ns2:IsEligibleForTradeIn>true</ns2:IsEligibleForTradeIn>
  <ns2:IsMemorabilia>false</ns2:IsMemorabilia>
  <ns2:Label>Apress</ns2:Label>
  <ns2:Languages>
    <ns2:Language>
      <ns2:Name>english</ns2:Name>
      <ns2:Type>Unknown</ns2:Type>
    </ns2:Language>
    <ns2:Language>
      <ns2:Name>english</ns2:Name>
      <ns2:Type>Original Language</ns2:Type>
    </ns2:Language>
    <ns2:Language>
      <ns2:Name>english</ns2:Name>
      <ns2:Type>Published</ns2:Type>
    </ns2:Language>
  </ns2:Languages>
  <ns2:ListPrice>
    <ns2:Amount>59.99</ns2:Amount>
    <ns2:CurrencyCode>USD</ns2:CurrencyCode>
  </ns2:ListPrice>
  <ns2:Manufacturer>Apress</ns2:Manufacturer>
  <ns2:NumberOfItems>1</ns2:NumberOfItems>
  <ns2:NumberOfPages>1752</ns2:NumberOfPages>
  <ns2:PackageDimensions>
    <ns2:Height Units="inches">2.60</ns2:Height>
    <ns2:Length Units="inches">9.20</ns2:Length>
    <ns2:Width Units="inches">7.50</ns2:Width>
    <ns2:Weight Units="pounds">5.80</ns2:Weight>
  </ns2:PackageDimensions>
  <ns2:PartNumber>9781430225492</ns2:PartNumber>
  <ns2:ProductGroup>Book</ns2:ProductGroup>
  <ns2:ProductTypeName>ABIS_BOOK</ns2:ProductTypeName>
  <ns2:PublicationDate>2010-05-14</ns2:PublicationDate>
  <ns2:Publisher>Apress</ns2:Publisher>
  <ns2:SmallImage>
    <ns2:URL>http://ecx.images-amazon.com/images/I/51h9Sju5NKL._SL75_.jpg</ns2:URL>
    <ns2:Height Units="pixels">75</ns2:Height>
    <ns2:Width Units="pixels">61</ns2:Width>
  </ns2:SmallImage>
  <ns2:Studio>Apress</ns2:Studio>
  <ns2:Title>Pro C# 2010 and the .NET 4 Platform</ns2:Title>
</ns2:ItemAttributes> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T23:58:48.380

首先：元素名称是`Height`而不是`Heigth`。

您可以使用此代码来获取`Height`价值：

```
var doc = XDocument.Load(path);

XNamespace ns2 = "http://mws.amazonservices.com/schema/Products/2011-10-01/default.xsd";

string val = doc.Document.Descendants(ns2 + "ItemDimensions")
    .FirstOrDefault().Element(ns2 + "Height").Value;

Console.WriteLine(val); 
```

# c - 关于创建共享内存并提供父/子进程之间的通信

> ID：13040927
> 
> 赞同：2
> 
> 时间：2012-10-23T23:38:10.913
> 
> 标签：c, process, ipc, shared-memory

您好，我正在尝试实现一个在子进程和父进程之间使用共享内存的示例。目的是子进程必须计算给定大小的斐波那契数列作为用户的输入，并将每个数字写为数组的一个元素。在该过程之后将打印出这个数组。问题是，如果我创建此内存段并在操作之前附加它，`fork()`它工作正常，在我进行`fork()`操作后，子进程可以到达该内存段并正确生成数组，最后父进程可以在子进程完成其工作后打印出数组。代码是这样的；

```
create memory segment
attach memory segment
initialize the array elements to zero
fork()
if(pid==0)// Child Process
call the child function and send the pointer of a structure which includes the array and array size
return to parent and printout the array properly 
```

这是我实施的第一个例子。但是，我正在尝试使用另一种方式，您可以在下面看到完整的代码；

```
#include <stdlib.h>
#include <stdio.h>
#include <sys/shm.h>
#include <sys/types.h>
#include <sys/ipc.h>
#include <string.h>

#define MAX_SEQUENCE 10

typedef struct {

long fib_sequence[MAX_SEQUENCE];
int sequence_size;

} shared_data;

void child_func(shared_data* dataPtr);

void main(int argc,char *argv[]){

    int shmID,size,status,i;
    shared_data* dataPtr;
    pid_t pid;

            if((pid=fork())<0){
                printf("Error while fork()\n");
                exit(0);
            }

            else if(pid>0){ // Parent Process

                if((shmID = shmget(IPC_PRIVATE, MAX_SEQUENCE*sizeof(long), IPC_CREAT | 0666))<0){
                    printf("Allocation process was unsuccesfull\n");
                    exit(0);
                }

                dataPtr = (shared_data*) shmat(shmID,NULL,0);

                for(i=0; i<MAX_SEQUENCE; i++)
                    dataPtr->fib_sequence[i]==0;

                dataPtr->sequence_size = atoi(argv[1]);

                if((dataPtr->sequence_size) < 0){
                    printf("You entered an invalid(negative) size number\n");
                    exit(0);
                }

                else if((dataPtr->sequence_size) > MAX_SEQUENCE){
                    printf("Please enter a value less than MAX_VALUE\n");
                    exit(0);
                }

                wait(status); // Wait untill child finishes its job

                for(i=0; i<dataPtr->sequence_size; i++)
                    printf("%ld ", dataPtr->fib_sequence[i]);

                printf("\n");
                shmdt((void *) dataPtr);
                shmctl(shmID,IPC_RMID,NULL);
            }

            else{ // Child Process
                child_func(dataPtr);
                exit(0);
                }
} 

void child_func(shared_data* dataPtr){

    int index;

    printf("I am in Child Process\n");
    printf("Size of array %d\n", dataPtr->sequence_size);

    dataPtr->fib_sequence[0];

    if((dataPtr->sequence_size) > 0){

        dataPtr->fib_sequence[1]=1;

        for(index=2; index < dataPtr->sequence_size; index++)
            dataPtr->fib_sequence[index] = dataPtr->fib_sequence[index-1] + dataPtr->fib_sequence[index-2];

    }

} 
```

当我在进入子进程时运行第二个示例时，它会打印出无意义的`dataPtr->fib_sequence`. 我对以下几个问题感到好奇；

*   在第二个示例中，为什么它在 child 中打印错误的 dataPtr->size 值
*   在第一个示例中，我们可以承认我们确实在父进程中创建和附加内存段，因为我们在`fork()`操作之前正在做这些事情

# xml - 如何调试 Schematron 规则？

> ID：13040932
> 
> 赞同：2
> 
> 时间：2012-10-23T23:38:58.883
> 
> 标签：xml, schematron

我有一个带有各种嵌入式 Schematron 规则的 XSD 模式。我还有一个应该是有效的 XML，但它不是，所以我需要修复规则。

如何有效地调试每个断言的评估方式？

（我目前正在使用氧气，但任何可以完成这项工作的工具对我都有好处。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T22:38:17.163

通常使用标准实现作为 XSLT 样式表来验证 Schematron。这意味着实际的验证是应用从 Schematron 模式生成（分几个步骤）的最终样式表。如果您有用于验证实例文档的样式表，您可以通过任何 XSLT 调试器运行它。我知道的唯一可以让您将验证样式表保存为单独文件的工具是[XML ValidatorBuddy](http://www.xml-tools.com/ValidatorBuddy.htm)。也许这有帮助

（注：根据要求从评论复制为答案）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-04T15:52:13.407

您还可以在本机 schematron 引擎中使用逐步调试。您还没有提到您的开发堆栈，但是当我想做您所说的事情时，我在调试器中运行我的 schematron 引擎并使用断点检查相关规则/模式/断言的状态 -为上下文节点提供了什么？断言 xpath 在监视窗口中返回什么？等等……等等……

[这](https://github.com/gap777/SchemaTron)是一个 C# schematron 引擎。

# java - 图论 - 寻找子图

> ID：13040934
> 
> 赞同：1
> 
> 时间：2012-10-23T23:39:12.117
> 
> 标签：java, graph, graph-theory

我正在编写一个程序，该程序需要输入一些名称并查看以下结构的树：

```
 John
                                                    /           \
                                                  Chris         Bob
                                                /   |   \        |  \
                                               Tom Ben  Anna    Jade  Ed
                                               /  \      |           /  \
                                            Will  Mark  Ant        Andy  Dan 
```

程序应该返回根节点是输入名称之间最低关系/链接的子树。

如果我输入 Mark 和 Ant，程序应该返回以下树：

```
 Chris 
                                                /       \   
                                               Tom     Anna     
                                                  \      |         
                                                  Mark  Ant 
```

如果我输入 Will、Mark 和 Andy，那么程序应该返回以下树：

```
 John
                                                    /           \
                                                  Chris         Bob
                                                /                   \
                                               Tom                   Ed
                                               /  \                  /  
                                            Will  Mark             Andy 
```

我正在为我的树节点和连接使用以下类：

```
import java.util.ArrayList;
import java.util.List;

public class Person {
    private String name; 
    private List<Person> children;

    public Person(String name) { 
        this.name = name; 
        children = new ArrayList<Person>();
    }

    public String getName() {
        return name;
    }
    public List<Person> getChildren() {
        return children;
    }
    public void setName(String name) {
        this.name = name;
    }
    public void setChildren(List<Person> children) {
        this.children = children;
    }
    public void addChild(Person c) { 
        children.add(c);
    }
} 
```

我的问题是如何解决确定公共节点的问题（首先是 Chris，其次是 John）以及如何使用该名称来获取子树（公共节点和下面的节点）。

我也在考虑对此进行扩展以使用 Neo4j 数据库，但想先在这种情况下解决它。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:44:25.000

您正在寻找的是最低的共同祖先：

[http://en.wikipedia.org/wiki/Lowest_common_ancestor](http://en.wikipedia.org/wiki/Lowest_common_ancestor)

我可以尝试详细解释它，但我永远不会比本教程做得更好、更全面，它教给你许多不同的算法来解决这个问题：

[http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=lowestCommonAncestor)

# asp.net - 在 ASP.NET/VB.NET 中通过 OpenXML 创建 Excel 文件并通过响应发送

> ID：13040936
> 
> 赞同：0
> 
> 时间：2012-10-23T23:39:18.203
> 
> 标签：asp.net, vb.net, excel, openxml, openxml-sdk

试图基于[http://www.codeproject.com/Articles/371203/Creating-basic-Excel-workbook-with-Open-XML](http://www.codeproject.com/Articles/371203/Creating-basic-Excel-workbook-with-Open-XML)创建一个简单的 OpenXML 文档， 我将它移到我的 asp.net（下） dev 服务器，但创建的文件已损坏且无法打开。我在做一些明显愚蠢的事情吗？

```
Private Sub Button2_Click(ByVal sender As Object, ByVal e As System.EventArgs) Handles Button2.Click
    Response.Clear()
    Response.Buffer = False
    Dim myoutputstream As New MemoryStream
    Dim myPackage As SpreadsheetDocument = CreateWorkbook(myoutputstream)

    AddWorksheet(myPackage, "Test")
    myPackage.WorkbookPart.Workbook.Save()

    Response.AddHeader("Content-Disposition", ("attachment") & "; filename=Report.xlsx")
    Response.ContentType = "application/octet-stream"
    Response.AddHeader("Accept-Header", myoutputstream.Length.ToString())
    Response.AddHeader("Content-Length", myoutputstream.Length.ToString())
    Response.BinaryWrite(myoutputstream.GetBuffer())
    Response.End()

End Sub

Public Shared Function CreateWorkbook(ByVal MyMemoryStream As MemoryStream) As SpreadsheetDocument
    Dim spreadSheet As SpreadsheetDocument = Nothing
    Dim sharedStringTablePart As SharedStringTablePart
    Dim workbookStylesPart As WorkbookStylesPart

    Try
        ' Create the Excel workbook
        spreadSheet = SpreadsheetDocument.Create(MyMemoryStream, SpreadsheetDocumentType.Workbook, False)

        ' Create the parts and the corresponding objects
        ' Workbook
        spreadSheet.AddWorkbookPart()
        spreadSheet.WorkbookPart.Workbook = New DocumentFormat.OpenXml.Spreadsheet.Workbook()
        spreadSheet.WorkbookPart.Workbook.Save()

        ' Shared string table
        sharedStringTablePart = spreadSheet.WorkbookPart.AddNewPart(Of SharedStringTablePart)()
        sharedStringTablePart.SharedStringTable = New DocumentFormat.OpenXml.Spreadsheet.SharedStringTable()
        sharedStringTablePart.SharedStringTable.Save()

        ' Sheets collection
        spreadSheet.WorkbookPart.Workbook.Sheets = New DocumentFormat.OpenXml.Spreadsheet.Sheets()
        spreadSheet.WorkbookPart.Workbook.Save()

        ' Stylesheet
        workbookStylesPart = spreadSheet.WorkbookPart.AddNewPart(Of WorkbookStylesPart)()
        workbookStylesPart.Stylesheet = New DocumentFormat.OpenXml.Spreadsheet.Stylesheet()
        workbookStylesPart.Stylesheet.Save()
    Catch exception As System.Exception

    End Try

    Return spreadSheet
End Function

Public Shared Function AddWorksheet(ByVal spreadsheet As SpreadsheetDocument, ByVal name As String) As Boolean
    Dim sheets As DocumentFormat.OpenXml.Spreadsheet.Sheets = spreadsheet.WorkbookPart.Workbook.GetFirstChild(Of DocumentFormat.OpenXml.Spreadsheet.Sheets)()
    Dim sheet As DocumentFormat.OpenXml.Spreadsheet.Sheet
    Dim worksheetPart As WorksheetPart

    ' Add the worksheetpart
    worksheetPart = spreadsheet.WorkbookPart.AddNewPart(Of WorksheetPart)()
    worksheetPart.Worksheet = New DocumentFormat.OpenXml.Spreadsheet.Worksheet(New DocumentFormat.OpenXml.Spreadsheet.SheetData())
    worksheetPart.Worksheet.Save()

    ' Add the sheet and make relation to workbook
    sheet = New DocumentFormat.OpenXml.Spreadsheet.Sheet With {
       .Id = spreadsheet.WorkbookPart.GetIdOfPart(worksheetPart),
       .SheetId = (spreadsheet.WorkbookPart.Workbook.Sheets.Count() + 1),
       .Name = name}

    sheets.Append(sheet)
    spreadsheet.WorkbookPart.Workbook.Save()

    Return True
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T16:31:38.297

您是否将任何数据填写到电子表格中？我生成的 excel 文件损坏的主要原因非常简单：excel 从 1 开始计数，而不是从 0 开始计数，记住这一点非常重要。

这是我的示例，但在 c#

```
 public void GetTemplate(Page page, DownloadExcelTemplateModel model)
    {
        // generating file
        byte[] bytes = GetFile(model);
        PutExcelFileToResponce(page, bytes);
    }

    private static void PutExcelFileToResponce(Page page, byte[] bytes)
    {
        // do clear
        page.Response.Clear();
        page.Response.ClearHeaders();
        page.Response.ClearContent();

        // add headers
        page.Response.AddHeader("Content-Length", bytes.Length.ToString(CultureInfo.InvariantCulture));
        page.Response.AddHeader("Content-Disposition", string.Format("attachment; filename={0}", "Template.xlsx"));
        page.Response.AddHeader("Content-Type", "application/Excel");

        // set content type
        page.Response.ContentType = "application/vnd.xls";

        // do write binary data to responce stream
        page.Response.BinaryWrite(bytes);

        // finish process
        page.Response.Flush();
        page.Response.End();
    }

    private byte[] GetFile(DownloadExcelTemplateModel model)
    {
        return WebService.GetData(model.Id);
    } 
```

# jquery - 向上滑动/向下滑动

> ID：13040938
> 
> 赞同：0
> 
> 时间：2012-10-23T23:39:35.623
> 
> 标签：jquery, slidedown, slideup

我的两个页面都有上滑和下滑效果，问题是一旦关于幻灯片向上，如果我点击联系人链接，它会在向下滑动之前闪烁到联系人页面。出于某种原因，两张幻灯片的 jquery 格式相同，但是如果我在联系幻灯片打开时单击关于链接，似乎不会发生这种情况。不知道是什么问题，希望各位大神帮忙解决。

我把它上传到我的主机，所以你们可以自己看看。 [http://maximsiebert.com/unamed/Untitled-1.html](http://maximsiebert.com/unamed/Untitled-1.html)

这是我的 jQuery

```
 $(document).ready(function() {
 $('.contact').click(function () {
      if ($('#aboutpage').is(":visible")) {
        $('#aboutpage').slideUp(800)
        $('#portfolio').slideDown(800)  
        $('#portfolio').slideUp(800)
        $('#contactpage').slideDown(800)   
      }
      else if ($('#contactpage').is(":visible")) { 
      $('#contactpage').slideUp(1000) 
      $('#portfolio').slideDown(1000) 
      }
       else if ($('#contactpage').is(":hidden")) { 
      $('#portfolio').slideUp(1000) 
      $('#contactpage').slideDown(1000) 
      $('html, body').animate({scrollTop:0}, 'slow');
      }
      }); 
```

});

```
 $(document).ready(function() {
 $('.about').click(function () {
      if ($('#contactpage').is(":visible")) {
        $('#contactpage').slideUp(800)
        $('#portfolio').slideDown(800)  
        $('#portfolio').slideUp(800)
        $('#aboutpage').slideDown(800)   
      }
      else if ($('#aboutpage').is(":visible")) { 
      $('#aboutpage').slideUp(1000) 
      $('#portfolio').slideDown(1000) 
      }
       else if ($('#aboutpage').is(":hidden")) { 
      $('#portfolio').slideUp(1000) 
      $('#aboutpage').slideDown(1000) 
      $('html, body').animate({scrollTop:0}, 'slow');
      }
      }); 
```

});

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:53:54.453

通常，您应该等待显示的页面向下滑动，然后再向上滑动新页面。

所以你应该使用以下方法：

```
$('.about').click(function () {
  .... if contact page is shown ...

  $('#aboutpage').slideDown(800, function() {
     $('#aboutpage').slideUp(800);
  });
  .....

}); 
```

# java - 程序输出完成后返回命令行

> ID：13040946
> 
> 赞同：0
> 
> 时间：2012-10-23T23:40:06.580
> 
> 标签：java, multithreading, command-line, command-prompt

写了一个多线程程序，依次打印出奇偶数，直到序列达到30。

```
import java.util.concurrent.Executor;
import java.util.concurrent.Executors;
import java.util.concurrent.atomic.AtomicInteger;

public class NumPrintTX
{
public static void main(String[] args)
{
    final int max = 31;
    final AtomicInteger i = new AtomicInteger(0);
    Executor dd = Executors.newFixedThreadPool(2);

    final Object lock = new Object();

    dd.execute(new Runnable()
    {
        @Override
        public void run()
        {
            while (i.get() < max)
            {
                if (i.get() % 2 == 0)
                {
                    System.out.print(" " + i.getAndAdd(1));

                    synchronized(lock)
                    {
                        lock.notify();
                    }
                }
                else
                {
                    synchronized(lock)
                    {
                        try
                        {
                            lock.wait();
                        }
                        catch (InterruptedException e)
                        {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }
                    }
                }
            }
        }
    });
    dd.execute(new Runnable()
    {
        @Override
        public void run()
        {
            while (i.get() < max)
            {
                if (i.get() % 2 != 0)
                {
                    System.out.print(" " + i.getAndAdd(1));

                    synchronized(lock)
                    {
                        lock.notify();
                    }
                }
                else
                {
                    synchronized(lock)
                    {
                        try
                        {
                            lock.wait();
                        }
                        catch (InterruptedException e)
                        {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }
                    }
                }
            }
        }
    });
    do
    {
        try 
        {
            Thread.currentThread().sleep(1000);
            }
        catch (InterruptedException e)
        {
            e.printStackTrace();
        }
    }
    while (i.get() != max);
}
} 
```

当程序运行时，结果很好，但它不会转到下一行，所以我可以输入另一个命令来执行我接下来想做的任何事情。任何想法为什么会这样以及我能做些什么来解决它？

修改代码：import java.util.concurrent.Executor；导入 java.util.concurrent.Executors；导入 java.util.concurrent.atomic.AtomicInteger；

```
public class NumPrintTX
{
public static void main(String[] args)
{
    final int max = 31;
    final AtomicInteger i = new AtomicInteger(0);
    Executor dd = Executors.newFixedThreadPool(2);

    final Object lock = new Object();

    dd.execute(new Runnable()
    {
        @Override
        public void run()
        {
            while (i.get() < max)
            {
                if (i.get() % 2 == 0)
                {
                    System.out.print(" " + i.getAndAdd(1));

                    synchronized(lock)
                    {
                        lock.notify();
                    }
                }
                else
                {
                    synchronized(lock)
                    {
                        try
                        {
                            lock.wait();
                        }
                        catch (InterruptedException e)
                        {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }
                    }
                }
            }
        }
    });
    dd.execute(new Runnable()
    {
        @Override
        public void run()
        {
            while (i.get() < max)
            {
                if (i.get() % 2 != 0)
                {
                    System.out.print(" " + i.getAndAdd(1));

                    synchronized(lock)
                    {
                        lock.notify();
                    }
                }
                else
                {
                    synchronized(lock)
                    {
                        try
                        {
                            lock.wait();
                        }
                        catch (InterruptedException e)
                        {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }
                    }
                }
            }
        }
    });
    do
    {
        try 
        {
            Thread.currentThread().sleep(1000);
            }
        catch (InterruptedException e)
        {
            e.printStackTrace();
        }
    }
    while (i.get() != max);
}
public void close()
{
System.exit(0);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:49:58.260

你没有停止你的线程池，所以它不会让你的主程序结束。

考虑以下代码：

```
import java.util.concurrent.Executors;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.atomic.AtomicInteger;

class Worker implements Runnable {
    private AtomicInteger i;
    private Object lock;
    private int max;
    private int mod;

    Worker(AtomicInteger i_, Object lock_, int max_, int mod_){ 
        this.i   = i_;
        this.lock = lock_;
        this.max  = max_;
        this.mod  = mod_; 
    }

    @Override
    public void run(){
        while (i.get() < max)
        {
            if(i.get() % 2 == mod)
            {
                System.out.print(" " + i.getAndAdd(1));

                synchronized(lock){ lock.notify(); }
            }
            else
            {
                synchronized(lock)
                {
                    try { lock.wait(); }
                    catch (InterruptedException e) { e.printStackTrace(); }
                }
            }
        }
    }
}

public class NumPrintTX
{
   public static void main(String[] args)
    {
        final int max = 31;
        final AtomicInteger i = new AtomicInteger(0);
        ExecutorService dd = Executors.newFixedThreadPool(2);

        final Object lock = new Object();

        dd.execute(new Worker(i, lock, max, 0));
        dd.execute(new Worker(i, lock, max, 1));

        dd.shutdown();
    }    
} 
```

如果没有`dd.shutdown()`，您的程序将挂起，尽管已经结束。

主要的 do-while 循环`System.exit(0)`将起作用，但似乎有点“蛮力”。

此外，此代码简化了您的线程代码，并使其更具可读性，而无需更改底层逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:43:12.223

您需要通过调用`System.exit(0);`where`0`是“正常”退出的退出状态代码来退出程序。应该在打印出数字的循环完成后进行调用。

[System.exit(int status) 的 Java 文档](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#exit%28int%29)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-24T00:00:56.600

您需要明确关闭您的程序。所以，像这样：

```
public void close() {
    // Put any closing code here, like joining Threads or whatever
    System.exit(0); // 0 means it is a normal exit, i.e. there are no errors
} 
```

# c# - 如何检测正在使用的垃圾收集器？

> ID：13040947
> 
> 赞同：2
> 
> 时间：2012-10-23T23:40:24.003
> 
> 标签：c#, mono

我想在我的单声道服务中检测运行时正在运行的垃圾收集器。这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T23:49:05.593

对的，这是可能的：

```
public static bool IsRunningWithSGen ()
{
    return System.GC.MaxGeneration > 0;
} 
```

和 Boehm 的替代方案：

```
public static bool IsRunningWithBoehm ()
{
    return System.GC.MaxGeneration == 0;
} 
```

# android - JNI：将作业映射到本机 C++ 对象

> ID：13040949
> 
> 赞同：2
> 
> 时间：2012-10-23T23:40:29.183
> 
> 标签：android, c++, android-ndk, java-native-interface

我使用常规 std::map 将 jobject 映射到 c++ 对象。这种方法的问题在于它可能对其他类型的引用失败，例如全局引用实际上是不同于常规局部引用的指针，即使它们引用同一个对象。比较两个引用是否引用同一个对象的正确方法是：

```
env->IsSameObject(jobj1, jobj2); 
```

所以，我的问题是：将 jobject 映射到 c++ 对象的正确方法是什么？将 jobject 包装到重载 operator== 并调用 IsSameObject 的某个 c++ 类中的明显回复不是我正在寻找的回复。我想知道是否有办法做到这一点，而无需在每次比较操作中在 JVM 和本机 c/c++ 之间来回切换。

**编辑：**全局引用是一个 jni 全局引用，与 c++ 引用无关。

**EDIT2：**我想澄清一下这段代码有什么问题：

```
std::map<jobject, void *> jobjs;
jobject obj1, obj2;
... some code that sets these obj1 and obj2 to some Java objects.

jobjs[obj1] = new CppPeer;
CppPeer * = jobjs[obj1]; //OK...
if(objs.find(obj2) == objs.end()){
   assert(obj2 != obj1);
   //Here's the problem: here a new c++ CppPeer
   //created for obj2, but the problem is that 
   //even if obj1 != ob2 it doesn't mean that
   //they actually reference different java objects
   //On the next line error might happen
   jobjs[obj2] = new CppPeer; //maybe not OK here...
} 
```

IsSameObject 的另一个问题是它使事情变得非常讨厌和混乱。不仅现在我需要保留一个指向 JVM 的指针，而且每当我需要比较作业时，我都需要附加线程等以获取指向 JNIEnv 的指针，以便能够检查作业

**EDIT3：**请注意，根据 android 文档，如果它们相等，您甚至不能假设两个引用引用同一个对象。我不知道这怎么可能，但Android的JNI提示页面中有一部分：

> 这样做的一个后果是，您不能假设对象引用在本机代码中是恒定的或唯一的。表示一个对象的 32 位值可能与一个方法的调用不同，并且**有可能两个不同的对象在连续调用时可能具有相同的 32 位值。不要使用 jobject 值作为键**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T01:57:19.310

免责声明：它闻起来。

在 Android 上，指针 和`jint`大小相同。考虑向您的 Java 类添加一个 int 字段来存储指向本机 conterpart 的指针。在 JNI 方法中，将其类型转换回指针。

为了稍微安全一点，对数据类型匹配做一个静态断言：

```
{char a[sizeof(void*) == sizeof(jint) ? 1 : -1]}; 
```

如果它是在一个不是它的系统上编译的，你会得到一个编译错误。

为了稍微减少气味，使用静态/全局`map`从 int 到您的对象，使用 ID 生成器，而不是对象指针，在 Java 对象中存储相对唯一的（在进程生命周期内）对象 ID。

# performance - 时间复杂度，二叉（搜索）树

> ID：13040950
> 
> 赞同：0
> 
> 时间：2012-10-23T23:40:39.557
> 
> 标签：performance, time-complexity, asymptotic-complexity

假设我有一个完整的二叉树，直到一定深度*d*。遍历（前序遍历）这棵树的时间复杂度是多少。

我很困惑，因为我知道树中的节点数量是 2^d，所以时间复杂度是`BigO(2^d)`？因为这棵树呈指数增长。

但是，在互联网上的研究中，每个人都说遍历是`BigO(n)`其中 n 是元素的数量（`2^d`在这种情况下是），而不是`BigO(2^d)`，我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-23T23:52:24.677

n 定义为节点数。

2^d 只是该深度的每个可能节点都已满时的节点数

IE。

```
 o
   /   \
  o     o
 / \   
o   o 
```

当 2^d 为 8 时只有 5 个节点

完整的二叉树除了最后一行之外的所有节点都被填充，并且所有节点都填充到左侧。你可以在维基百科上找到定义

[http://en.wikipedia.org/wiki/Binary_tree#Types_of_binary_trees](http://en.wikipedia.org/wiki/Binary_tree#Types_of_binary_trees)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:56:51.240

即使您可以将时间复杂度表示为 O(2^d)，这也没什么用，因为您无法将其与任何其他集合的时间复杂度进行比较。

另一方面，将时间复杂度表示为 O(n) 非常有用。它准确地告诉您当您增加项目数量时集合如何反应，而无需确切知道集合是如何实现的，并且您可以将其与其他集合的时间复杂度进行比较。

# parsing - 使用 Unix 解析和打印 $PATH

> ID：13040954
> 
> 赞同：8
> 
> 时间：2012-10-23T23:41:21.037
> 
> 标签：parsing, unix, path, awk

我已将我的 PATH 放在一个文本文件中，并希望在 UNIX 中使用一个简单的命令在换行符上打印每个路径。

我找到了很长的路要走，就像这样......

```
cat Path.txt | awk -F\; '{print $1"\n", $2"\n", ... }' 
```

然而，这似乎效率低下，所以我知道必须有一种方法可以每次在新行上快速打印出我的结果，而不必手动调用由分隔符分隔的每个字段。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-23T23:45:18.523

还有一种方式：

```
echo $PATH | tr : '\n' 
```

或者：

```
tr : '\n' <Path.txt 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T03:26:40.553

tr 解决方案是正确的，但如果您要使用 awk 则不需要循环：

```
$ echo "$PATH"
/usr/local/bin:/usr/bin:/cygdrive/c/winnt/system32:/cygdrive/c/winnt

$ echo "$PATH" | awk -F: -v OFS="\n" '$1=$1'
/usr/local/bin
/usr/bin
/cygdrive/c/winnt/system32
/cygdrive/c/winnt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:43:42.813

对于`Perl`UNIX/UNIX-likes ：

```
echo $PATH | perl -F: -ane '{print join "\n", @F}' 
```

使用任何操作系统（在 Windows XP、Linux、Minix、Solaris 上测试）：

```
my $sep;
my $path;

if ($^O =~ /^MS/) {
    $sep = ";";
    $path = "Path";
}
else {
     $sep = ":";
     $path = "PATH";
}

print join "\n", split $sep, $ENV{$path} . "\n"; 
```

如果在 Unix 上使用[bash](/questions/tagged/bash "显示标记为“bash”的问题")，请尝试以下代码：

```
printf '%s\n' ${PATH//:/ } 
```

这个使用`bash` [参数扩展](http://wiki.bash-hackers.org/syntax/pe)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-24T00:13:53.670

我有一个用于此目的的 Perl 脚本：

```
#!/usr/bin/env perl
#
#   "@(#)$Id: echopath.pl,v 1.8 2011/08/22 22:15:53 jleffler Exp $"
#
#   Print the components of a PATH variable one per line.
#   If there are no colons in the arguments, assume that they are
#   the names of environment variables.

use strict;
use warnings;

@ARGV = $ENV{PATH} unless @ARGV;

foreach my $arg (@ARGV)
{
    my $var = $arg;
    $var = $ENV{$arg} if $arg =~ /^[A-Za-z_][A-Za-z_0-9]*$/;
    $var = $arg unless $var;
    my @lst = split /:/, $var;
    foreach my $val (@lst)
    {
        print "$val\n";
    }
} 
```

我像这样调用它：

```
echopath $PATH
echopath PATH
echopath LD_LIBRARY_PATH
echopath CDPATH
echopath MANPATH
echopath $CLASSPATH 
```

等你可以指定变量名，或者变量的值；它是双向的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-24T04:54:33.343

awk：

```
echo $PATH|awk -F: '{gsub(/:/,"\n");print}' 
```

perl:

```
echo $PATH|perl -F: -lane 'foreach(@F){print $_}' 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-24T05:00:08.480

对于 AWK，除了：

```
echo $PATH | awk -vFS=':' -vOFS='\n' '$1=$1' 
```

你可以：

```
echo $PATH | awk -vRS=':' '1' 
```

# google-chrome-extension - 我可以默认隐藏我的扩展程序的图标吗？

> ID：13040955
> 
> 赞同：37
> 
> 时间：2012-10-23T23:41:32.333
> 
> 标签：google-chrome-extension

我的 Chrome 扩展程序不需要图标 - 它是一个单行扩展程序，不想占用您的扩展程序栏上的空间。

如何默认隐藏图标？

* * *

## 回答 #1

> 赞同：86
> 
> 时间：2016-05-30T08:49:35.670

由于[Google 率先进行的更改](https://blog.google/products/chrome/new-year-new-chrome/)，所有扩展现在必须在工具栏区域或菜单中具有“溢出”图标。

即使您没有`browser_action`，您的扩展程序也会显示一个图标（否则，会显示一个带有扩展程序名称第一个字母的图块）。如果您不声明 a `browser_action`，它将显示为灰色且非交互式，但仍会存在。

此更改的想法是提供其他潜在隐蔽扩展的可见性（“嘿，用户，您甚至知道您已经安装了这些扩展吗？”）。让我们说，这是否是最好的方法*值得商榷*，但那是谷歌的决定。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-10-28T07:40:01.357

要抑制此行为，请添加`"converted_from_user_script": true`到扩展的`manifest.json`. 这适用于 Chrome 61。

过去，访问用户脚本的链接（以 结尾`.user.js`）会导致 Chrome 将用户脚本打包为内容脚本扩展，并生成包含`converted_from_user_script`密钥的清单。当然，这不再有效，因为所有扩展（开发者模式除外）现在都必须来自 Chrome 网上应用店。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-08-23T02:41:39.723

Google 认为最好强制使用图标，我也这么认为，原因 Xan 已经指出。

现在你当然是对的，当你说许多扩展程序不需要图标时，一个的要求仍然给你的扩展程序一个身份，谷歌仍然让用户有机会从工具栏中删除它。他只需**右键单击**扩展程序的图标，然后选择**Hide in Chrome menu**。

我知道，许多用户并没有真正费心阅读右键单击下的所有选项，甚至根本没有右键单击它。但他们中的大多数人仍然会单击左键，看看他们添加的新扩展中是否有任何选项。您可以通过制作一个简单的窗口来利用这一点，您可以在其中**指出他们隐藏图标的选项**。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-10-23T23:46:30.630

如果你不想要一个图标，你可以省略你的`browser_action`参数`manifest.json`（这个`default_icon`选项是你通常指定图标的地方）。该`browser_action`部分控制您在工具栏中看到的内容。

# git - 合并两个 Git 存储库而不破坏文件历史记录

> ID：13040958
> 
> 赞同：261
> 
> 时间：2012-10-23T23:41:43.173
> 
> 标签：git, git-subtree

我需要将两个 Git 存储库合并到一个全新的第三个存储库中。我发现了许多关于如何使用子树合并来执行此操作的描述（例如[Jakub Narębski](https://stackoverflow.com/a/1426163)关于[如何合并两个 Git 存储库的答案？](https://stackoverflow.com/questions/1425892/how-do-you-merge-two-git-repositories)）并且遵循这些说明大部分都有效，除了当我提交子树时合并所有文件来自旧存储库的文件被记录为新添加的文件。当我这样做时，我可以从旧存储库中看到提交历史记录`git log`，但如果这样做，`git log <file>`它只会显示该文件的一个提交 - 子树合并。从对上述答案的评论来看，我并不是唯一一个看到这个问题的人，但我没有找到任何已发布的解决方案。

有什么方法可以合并存储库并使单个文件历史记录完好无损？

* * *

## 回答 #1

> 赞同：306
> 
> 时间：2013-01-22T23:57:18.230

事实证明，如果您只是尝试将两个存储库粘合在一起并使其看起来一直都是这样，而不是管理外部依赖项，那么答案会简单得多。您只需将遥控器添加到旧存储库，将它们合并到新主库，将文件和文件夹移动到子目录，提交移动，然后重复所有其他存储库。子模块、子树合并和花哨的变基旨在解决稍微不同的问题，并不适合我想要做的事情。

这是一个将两个存储库粘合在一起的示例 Powershell 脚本：

```
# Assume the current directory is where we want the new repository to be created
# Create the new repository
git init

# Before we do a merge, we have to have an initial commit, so we'll make a dummy commit
git commit --allow-empty -m "Initial dummy commit"

# Add a remote for and fetch the old repo
# (the '--fetch' (or '-f') option will make git immediately fetch commits to the local repo after adding the remote)
git remote add --fetch old_a <OldA repo URL>

# Merge the files from old_a/master into new/master
git merge old_a/master --allow-unrelated-histories

# Move the old_a repo files and folders into a subdirectory so they don't collide with the other repo coming later
mkdir old_a
dir -exclude old_a | %{git mv $_.Name old_a}

# Commit the move
git commit -m "Move old_a files into subdir"

# Do the same thing for old_b
git remote add -f old_b <OldB repo URL>
git merge old_b/master --allow-unrelated-histories
mkdir old_b
dir –exclude old_a,old_b | %{git mv $_.Name old_b}
git commit -m "Move old_b files into subdir" 
```

显然，如果您愿意，您可以将 old_b 合并到 old_a 中（这将成为新的组合存储库）——修改脚本以适应。

如果您还想引入正在进行的功能分支，请使用以下命令：

```
# Bring over a feature branch from one of the old repos
git checkout -b feature-in-progress
git merge -s recursive -Xsubtree=old_a old_a/feature-in-progress 
```

这是该过程中唯一不明显的部分——这不是子树合并，而是正常递归合并的一个参数，它告诉 Git 我们重命名了目标并帮助 Git 正确排列所有内容。

[我在这里](http://saintgimp.org/2013/01/22/merging-two-git-repositories-into-one-repository-without-losing-file-history/)写了一个更详细的解释。

* * *

## 回答 #2

> 赞同：168
> 
> 时间：2014-01-07T14:48:18.637

这是一种不会重写任何历史记录的方法，因此所有提交 ID 都将保持有效。最终结果是第二个 repo 的文件最终会放在一个子目录中。

1.  将第二个 repo 添加为远程：

    ```
    cd firstgitrepo/
    git remote add secondrepo username@servername:andsoon 
    ```

2.  确保您已下载所有 secondrepo 的提交：

    ```
    git fetch secondrepo 
    ```

3.  从第二个 repo 的分支创建一个本地分支：

    ```
    git branch branchfromsecondrepo secondrepo/master 
    ```

4.  将其所有文件移动到子目录中：

    ```
    git checkout branchfromsecondrepo
    mkdir subdir/
    git ls-tree -z --name-only HEAD | xargs -0 -I {} git mv {} subdir/
    git commit -m "Moved files to subdir/" 
    ```

5.  将第二个分支合并到第一个 repo 的 master 分支：

    ```
    git checkout master
    git merge --allow-unrelated-histories branchfromsecondrepo 
    ```

您的存储库将有多个根提交，但这不应该造成问题。

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2018-10-22T15:42:35.070

几年过去了，有一些基于良好的投票解决方案，但我想分享我的，因为它有点不同，因为**我想将 2 个远程存储库合并到一个新的存储库中，而不删除以前存储库中的历史记录。**

1.  在 Github 中创建一个新的存储库。

    [![在此处输入图像描述](../Images/3e9487f189ac33a91b30555aa1839d5f.png)](https://i.stack.imgur.com/OP8Zc.png)

2.  下载新创建的存储库并添加旧的远程存储库。

    ```
    git clone https://github.com/alexbr9007/Test.git
    cd Test
    git remote add OldRepo https://github.com/alexbr9007/Django-React.git
    git remote -v 
    ```

3.  从旧仓库中获取所有文件，以便创建一个新分支。

    ```
    git fetch OldRepo
    git branch -a 
    ```

    [![在此处输入图像描述](../Images/f0688e92f1cf5dc01ab9bd93041bc9bc.png)](https://i.stack.imgur.com/GxDy3.png)

4.  在 master 分支中，进行合并以将旧的 repo 与新创建的 repo 合并。

    ```
    git merge remotes/OldRepo/master --allow-unrelated-histories 
    ```

    [![在此处输入图像描述](../Images/1bd3583639675ae6edb325cfdb9ec254.png)](https://i.stack.imgur.com/8f76t.png)

5.  创建一个新文件夹来存储从 OldRepo 添加的所有新创建的内容，并将其文件移动到这个新文件夹中。

6.  最后，您可以从合并的 repos 上传文件并从 GitHub 安全地删除 OldRepo。

希望这对任何处理合并远程存储库的人有用。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2020-05-30T01:05:26.767

假设您要将存储库合并`a`到`b`（我假设它们彼此并排）：

```
cd b
git remote add a ../a
git fetch a
git merge --allow-unrelated-histories a/master
git remote remove a 
```

如果您想放入`a`子目录，请在上述命令之前执行以下操作：

```
cd a
git filter-repo --to-subdirectory-filter a
cd .. 
```

为此，您需要[`git-filter-repo`](https://github.com/newren/git-filter-repo)安装（`filter-branch`不[鼓励](https://git-scm.com/docs/git-filter-branch#_warning)）。

合并 2 个大存储库的示例，将其中一个放入子目录：[https ://gist.github.com/x-yuri/9890ab1079cf4357d6f269d073fd9731](https://gist.github.com/x-yuri/9890ab1079cf4357d6f269d073fd9731)

更多关于它[的信息](https://gist.github.com/x-yuri/6161d90d1af8ebac6e560bcef548c1c3)。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2012-10-24T01:56:22.507

请看看使用

```
git rebase --root --preserve-merges --onto 
```

在他们生命的早期将两个历史联系起来。

如果您有重叠的路径，请使用

```
git filter-branch --index-filter 
```

当您使用日志时，请确保您“更难找到副本”

```
git log -CC 
```

这样，您将在路径中找到文件的任何移动。

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2016-09-06T09:24:11.447

我将@Flimm的[解决方案](https://stackoverflow.com/a/20974621/803002)`git alias`变成了这样的（添加到我的`~/.gitconfig`）：

```
[alias]
 mergeRepo = "!mergeRepo() { \
  [ $# -ne 3 ] && echo \"Three parameters required, <remote URI> <new branch> <new dir>\" && exit 1; \
  git remote add newRepo $1; \
  git fetch newRepo; \
  git branch \"$2\" newRepo/master; \
  git checkout \"$2\"; \
  mkdir -vp \"${GIT_PREFIX}$3\"; \
  git ls-tree -z --name-only HEAD | xargs -0 -I {} git mv {} \"${GIT_PREFIX}$3\"/; \
  git commit -m \"Moved files to '${GIT_PREFIX}$3'\"; \
  git checkout master; git merge --allow-unrelated-histories --no-edit -s recursive -X no-renames \"$2\"; \
  git branch -D \"$2\"; git remote remove newRepo; \
}; \
mergeRepo" 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-04-11T08:24:06.847

此函数会将远程仓库克隆到本地仓库目录中：

```
function git-add-repo
{
    repo="$1"
    dir="$(echo "$2" | sed 's/\/$//')"
    path="$(pwd)"

    tmp="$(mktemp -d)"
    remote="$(echo "$tmp" | sed 's/\///g'| sed 's/\./_/g')"

    git clone "$repo" "$tmp"
    cd "$tmp"

    git filter-branch --index-filter '
        git ls-files -s |
        sed "s,\t,&'"$dir"'/," |
        GIT_INDEX_FILE="$GIT_INDEX_FILE.new" git update-index --index-info &&
        mv "$GIT_INDEX_FILE.new" "$GIT_INDEX_FILE"
    ' HEAD

    cd "$path"
    git remote add -f "$remote" "file://$tmp/.git"
    git pull "$remote/master"
    git merge --allow-unrelated-histories -m "Merge repo $repo into master" --edit "$remote/master"
    git remote remove "$remote"
    rm -rf "$tmp"
} 
```

如何使用：

```
cd current/package
git-add-repo https://github.com/example/example dir/to/save 
```

注意。此脚本可以重写提交，但会保存所有作者和日期，这意味着新提交将有另一个哈希值，如果您尝试将更改推送到远程服务器，它只能使用强制密钥，它也会重写服务器上的提交。所以请在启动前做好备份。

利润！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-12-06T11:30:36.820

按照步骤将一个 repo 嵌入到另一个 repo 中，通过合并两个 git 历史记录来拥有一个单一的 git 历史记录。

1.  克隆您要合并的两个存储库。

> git clone git@github.com:user/parent-repo.git
> 
> git clone git@github.com:user/child-repo.git

2.  转到儿童回购

> cd子回购/

3.  运行以下命令，将路径`my/new/subdir`（3 次出现）替换为您想要拥有子存储库的目录结构。

> git filter-branch --prune-empty --tree-filter ' 如果 [ ！-e 我的/新的/子目录]; 然后 mkdir -p my/new/subdir git ls-tree --name-only $GIT_COMMIT | xargs -I 文件 mv 文件 my/new/subdir fi'

4.  转到父仓库

> cd ../parent-repo/

5.  将远程添加到父仓库，指向子仓库的路径

> git 远程添加子远程 ../child-repo/

6.  获取子仓库

> git 获取子远程

7.  合并历史

> git merge --allow-unrelated-histories child-remote/master

如果您现在检查父 repo 中的 git log，它应该合并子 repo 提交。您还可以看到来自提交源的标记。

下面的文章帮助我将一个 repo 嵌入到另一个 repo 中，通过合并两个 git 历史来拥有一个单一的 git 历史。

[http://ericlathrop.com/2014/01/combining-git-repositories/](http://ericlathrop.com/2014/01/combining-git-repositories/)

希望这可以帮助。快乐编码！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-21T18:02:39.370

还有另一种更简单的方法，只需在本地分支主分支并将所有文件移动到您喜欢的新路径结构中并提交。之后，将您的旧仓库添加为远程，如上所示进行合并。

与这里看到的所有其他解决方案不同，您现在已经完成，因为现在所有文件都已移动。

我有[这方面的要点](https://gist.github.com/Devp00l/5023ff4a2a2651995eae1777d71868e1)。

# c# - 在服务器上反序列化 WCF 消息

> ID：13040959
> 
> 赞同：0
> 
> 时间：2012-10-23T23:41:47.980
> 
> 标签：c#, wcf, deserialization

我实现了一个自定义消息检查器（通过 IDispatchMessageInspector）来拦截在 WCF 服务的服务器端接收到的消息，因此我可以尝试反序列化消息并应用一些特定的业务逻辑。我遇到的问题是，当我将 MessageBuffer 的内容写入新的 MemoryStream 然后尝试反序列化时，我收到一条错误消息，提示“根级别的数据无效。第 1 行，第 1 行。” 我确实知道传入的数据是有效的，因为跳过检查器会使一切正常。

示例代码：

```
public object AfterReceiveRequest(ref System.ServiceModel.Channels.Message request, System.ServiceModel.IClientChannel channel, System.ServiceModel.InstanceContext instanceContext)
    {
        MessageBuffer buffer = request.CreateBufferedCopy(Int32.MaxValue);
        request = buffer.CreateMessage();
        string msg = buffer.CreateMessage().ToString();

        var dc = new DataContractSerializer(typeof(Adder));

        using (var stream = new MemoryStream())
        {
            buffer.WriteMessage(stream);

            stream.Position = 0;

            //deserializing error occurs here
            var c = dc.ReadObject(stream);
        }

        return null;
    } 
```

这是 Adder 类/接口：

```
 [DataContract(Name = "adder", Namespace = "http://test.com")]
public class Adder
{
    [DataMember(Name = "first")]
    public int First { get; set; }

    [DataMember(Name = "second")]
    public int Second { get; set; }
}

    [ServiceContract(Namespace = "http://test.com")]
public interface ITestSvc
{
    [OperationContract(Name = "add")]
    int Add(Adder adder);
} 
```

有什么建议或有更好的选择吗？我的主要目标是读取进入我服务的每个 WCF 请求的 XML（在反序列化对象中）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T01:39:06.690

请求对象包含 WCF 消息标头以及有效负载。您需要去掉标头，然后您应该能够反序列化消息正文。

例如，一条 SOAP 消息将具有：

```
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
               xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
               xmlns:xsd="http://www.w3.org/2001/XMLSchema">
<soap:Header>

</soap:Header>
<soap:Body>
  <!-- your payload -->
</soap:Body> 
```

您可以使用 XML 导航来访问 body 元素，然后单独反序列化该元素。

编辑：实际上只是偶然发现了这种我认为应该为您解决问题的方法：

[Message.GetReaderAtBodyContents](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.message.getreaderatbodycontents.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T17:30:27.180

我只是这样做了。只需将以下所有代码粘贴到您的类中，然后调用**DeserializedResponse()**。您需要将**MyResponseObject**更改为您尝试反序列化的任何对象的名称。此外，您需要将“ **_requestInspector.Response** ”替换为您自己的响应 xml 字符串变量。**GetSoapBodyInnerXml()**方法将剥离 Soap Envelope，并仅返回您希望反序列化的响应 xml。

```
 private MyResponseObject DeserializedResponse()
    {
        var rootAttribute = new XmlRootAttribute("MyResponseObject ");
        rootAttribute.Namespace = @"http://www.company.com/MyResponseObjectNamespace";

        XmlSerializer serializer = new XmlSerializer(typeof(MyResponseObject ), rootAttribute);
        string responseSoapBodyInnerXml = GetSoapBodyInnerXml(_requestInspector.Response);
        AddXmlDeclaration(ref responseSoapBodyInnerXml);
        MemoryStream memStream = new MemoryStream(Encoding.UTF8.GetBytes(responseSoapBodyInnerXml));
        MyResponseObject resultingResponse = (MyResponseObject )serializer.Deserialize(memStream);

        return resultingResponse;
    }

    private string GetSoapBodyInnerXml(string soapMessage)
    {
        XDocument xDoc = XDocument.Parse(soapMessage);
        XNamespace nsSoap = @"http://schemas.xmlsoap.org/soap/envelope/";
        return xDoc.Descendants(nsSoap + CONST_SoapBody).Descendants().First().ToString();
    }

    private void AddXmlDeclaration(ref string xmlString)
    {
        XmlDocument doc = new XmlDocument();
        doc.LoadXml(xmlString);

        //Create an XML declaration. 
        XmlDeclaration xmldecl;
        xmldecl = doc.CreateXmlDeclaration("1.0", "UTF-8", null);

        //Add the new node to the document.
        XmlElement root = doc.DocumentElement;
        doc.InsertBefore(xmldecl, root);

        //Return updated xmlString with XML Declaration
        xmlString = doc.InnerXml;
    } 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2012-10-27T03:22:02.273

就像 Mike Parkhill 建议的那样，我最终选择了消息头路由。

# ember.js - Ember 数据验证和关联

> ID：13040960
> 
> 赞同：1
> 
> 时间：2012-10-23T23:41:53.270
> 
> 标签：ember.js, ember-data

这对我来说似乎一遍又一遍地出现，我想要关于如何处理它的建议。请原谅我在咖啡脚本中编写示例。

```
App.Post = DS.Model.extend
    title: DS.attr('string')
    author: DS.belongsTo('App.Author')

App.Author = DS.Model.extend
    name: DS.attr('string')
    posts: DS.hasMany('App.Post') 
```

我想同时创建一个作者和相关的帖子。

`author = App.Author.createRecord({name: 'waldo'});`

`author.get('posts').createRecord({title: 'how to do the Ember'})`

或者

`post = App.Post.createRecord({author: author})`

问题是，我服务器上的 Post 模型验证了 author_id 的存在。所以当我打电话时`store.commit()`，`author`提交成功，但`post`被拒绝，因为`post.get('author.id') //=> undefined`

**更新**：作者模型还在服务器上进行了验证，表明它至少需要创建一个帖子，因此在创建帖子之前我无法调用`store.commit()`。

我搞砸了交易，但没有成功。我会继续搞砸它，但这似乎是一个很好的问题，可以在 S/O 上回答以供将来参考。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T06:00:41.970

你需要在交易中这样做吗？如果没有，您可以`App.store.commit()`在将帖子记录添加给作者之前致电。如果这不能解决您的问题，您可能会遇到异步问题。在这种情况下，您可以连接到您的 Author-model 上的[didCreate事件。](https://github.com/emberjs/data#record-lifecycle)当该事件触发时，记录已在服务器上创建，您的模型应该有一个 id。如果您在此阶段添加帖子，您的服务器不应该抱怨。

# javascript - 通过另一个函数访问动态数组中的值

> ID：13040961
> 
> 赞同：0
> 
> 时间：2012-10-23T23:41:56.000
> 
> 标签：javascript

我有一个设置一堆功能的`setTimeout`功能。所有函数都添加到 Array `funcs`；然而，当我尝试使用`stopplay().clearTimeout`数组来阻止它们时，没有值。

如何访问这些功能以及`clearTimeout`它们？

```
var funcs = new Array();    

function playWithDelay(){   
    for (var i = 0; i < PlayDatesArray.length; i++) { 
        funcs[i] = createfunc(i); 
    } 

    for (var j = 0; j < PlayDatesArray.length; j++) { 
        funcs[j]();
    } 
}

function createfunc(i) { 
    return function() {        
        setTimeout(function(){            
        //my function
      }, i*1500);        
    }; 
}

function stopplay(){    
    alert(this.funcs.count);
    for (var i = 0; i< funcs.count; i++){ 
        //things I tried
        var tmpFunction = funcs[i]; 
        //funcs[i].splice(i, 1);
        clearTimeout(tmpFunction);
        clearTimeout(funcs[i]);
        funcs[i]=tmpFunction;
    }    
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T00:21:48.400

`clearTimeout`接受 id 返回的 id `setTimeout`，而不是对函数本身的引用。

所以你想要的是（在 ES5 代码中）

```
var timeouts = [];

function createfunc(i) { 
  return function() {        
      return setTimeout(function(){            
      //my function
    }, i*1500);        
  }; 
}

// code to create the functions
function playWithDelay(){   
  for (var i = 0; i < PlayDatesArray.length; i++) { 
    timeouts.push(createfunc(i)());
  }
} 

// code to stop them
function stopplay(){ 
  timeouts.forEach(clearTimeout);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-23T23:59:27.740

您正在`this.funcs`从访问`stopplay()`，但 funcs 被定义（至少在本例中）为全局变量。根据调用 stopplay() 的调用代码是什么，`this`与创建的全局范围不同`funcs`。

更新停止播放，更改`this.funcs.count`为`funcs`查看您在上面创建的数组是否会发出警报。

另外，你确定你的 funcs 数组有`count`吗？我会尝试`length`改用。

```
function stopplay(){    
    alert(funcs.length);
    for (var i = 0; i< funcs.length; i++){ 
    ....
    }    
} 
```

编辑：

您没有保存 setTimeout 的返回值，因此无法清除超时。使用函数传递 clearTimeout 不会清除超时。

你可以这样做：

```
var timers = new Array();

function createfunc(i) { 
   return function() {        
      timers.push( setTimeout(function(){            
        //my function
      }, i*1500)) ;        
   }; 
}

function stopplay(){    
    for (var i = 0; i< timers.length; i++){ 
        clearTimeout(timers[i]);
    }    
} 
```

# eclipse - 如何避免在eclipse中点击三下进入src/main/webapp？

> ID：13040962
> 
> 赞同：5
> 
> 时间：2012-10-23T23:42:03.610
> 
> 标签：eclipse, maven, m2eclipse, m2e, eclipse-wtp

我在 Eclipse 中设置了一个 maven web 应用程序项目，maven 喜欢将 webapp 资源放入`src/main/webapp`其中，因为我必须单击三次才能访问 webapp 内容。

*   点击 1 展开 src
*   点击 2 展开主要
*   点击 3 展开 webapp

![导航到 webapp 所需的三个级别的点击示例](../Images/b0934dc3bd41e5ca4a463166605704e6.png)

在典型的 WTP eclipse 项目中，只有 WebContent 并且是顶级文件夹，因此只需单击一下即可进入。

是否有 eclipse 或 m2e 技巧使 webapp 显示为项目下的顶级元素。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T00:37:37.490

如果它让你的生活更轻松，你可以覆盖 webapp 目录位置直接挂掉`${basedir}`

```
 <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-war-plugin</artifactId>
    <version>2.3</version>
    <configuration>
      <warSourceDirectory>${basedir}/webapp</warSourceDirectory>
    </configuration>
  </plugin> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-29T20:37:46.267

右键单击 webapp 文件夹并选择`Build Path -> Use as Source Folder`. 该文件夹将显示在顶部（在分层包演示中）。它应该对最后的战争没有副作用。

![在此处输入图像描述](../Images/6bb146ae8a9d949022b35c8d7317b566.png)

# apache-flex - 标签字段询问

> ID：13040964
> 
> 赞同：0
> 
> 时间：2012-10-23T23:42:27.060
> 
> 标签：apache-flex, flash-builder, labelfield

大家好，我有xml数据库如何拨打电话并在标签中显示？我已经有标签字段，但我想在字段中拨打电话

如何 ？

这是我的鳕鱼

```
<s:List id="lst" x="73" y="197" width="295" height="214" change="lst_changeHandler(event)"
            dataProvider="{arr}" fontSize="30" fontWeight="bold" 
             textAlign="right">
        <s:labelField>RestaurantsKuwaiti</s:labelField> 
```

[http://www.mlfnt.com/lives6/13510357301.png](http://www.mlfnt.com/lives6/13510357301.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T07:47:11.040

首先，您的 xml 不像列表：

```
 <RestaurantsKuwaiti>
   ...
   <RestaurantsOther>
   ...
I think it should be like:
   <Restaurants>
     <name>Kuwaiti</name>
   </Restaurants>
   <Restaurants>
     <name>Syria</name>
   </Restaurants>
   ... 
```

使用 labelFunction 可以解决您的问题：

```
 <fx:Script>
    <![CDATA[
      import mx.collections.XMLListCollection;

      private var xml:XML = 
        <dataroot>
          <alldata>
            <ID>1</ID>
            <Main>2</Main>
            <RestaurantsKuwaiti>
              <phone>55555555</phone>
            </RestaurantsKuwaiti>
          </alldata>
        </dataroot>;

      [Bindable]
      private var dataList:XMLListCollection = new XMLListCollection(xml.alldata);

      private function labelFunc(item:Object):String {
        return item.RestaurantsKuwaiti.phone;
      }
    ]]>
  </fx:Script>

  <s:List dataProvider="{dataList}" labelFunction="labelFunc"/> 
```

正如我上面提到的，“dataList”只有一项：“alldata”。

# visual-studio - 如何将 Visual Studio 2010 运行时与我的 .exe 和 .dll 文件打包？

> ID：13040966
> 
> 赞同：0
> 
> 时间：2012-10-23T23:42:33.237
> 
> 标签：visual-studio

作为一种你好世界的尝试，我正在编译一个简单的 EXE，它仅使用 C++ 文件动态加载 DLL（我也编写过），使用 Visual Studio 2010 构建。但是，在新机器上运行时，出现错误VS2010 运行时不存在。

有没有办法将运行时打包到我的应用程序或 DLL 中，这样就不会发生这种情况？不使用安装程序。

或者，有没有办法完全排除需要运行时？

（我使用的是 Visual Studio 2010，但这可能对所有版本都很感兴趣）

# javascript - jQuery .hover() 自动返回之前的状态

> ID：13040967
> 
> 赞同：0
> 
> 时间：2012-10-23T23:42:38.120
> 
> 标签：javascript, jquery

我想知道是否有一个简单的解决方案，在用户取消悬停后，数据将恢复到其原始状态？我目前的解决方案是保存原始状态，并在用户取消悬停后加载此数据。这可能会变得乏味，因为每次悬停都会更改大量文本字段，并且存储所有这些信息很麻烦。

我基本上想知道JavaScript / jQuery中是否有类似CSS的东西`:hover`会自动返回到原始状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T01:05:19.247

一种解决方案是通过在 DOM 中隐藏但不改变原始状态来“存储”原始状态。

而不是更改原始文本字段：

*   **onmouseover**：创建克隆并根据需要进行修改；隐藏原始文本字段。
*   **onmousout**：删除（或隐藏）克隆并显示原始文本字段。

在下一次鼠标悬停时，您可以再次执行相同操作，或者只是重新显示隐藏的克隆，具体取决于先前的克隆是否仍然相关。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T00:43:33.683

也许这可能会有所帮助，但您需要向我们提供更多信息和一些示例代码。

无论如何，您可以在用户悬停之前存储选择器的整个 HTML，然后在之后恢复它。

```
$('#button').hover(
    function(){
        var oldData = $('#data').html();        
    },
    function(){
        $('#data').html(oldData);

    }
); 
```

这会对你有帮助吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-24T00:48:15.667

我相信这已经是默认行为：http:
[//api.jquery.com/hover/](http://api.jquery.com/hover/)

如果不是，那么您可能应该使用`.mouseover`and `.mouseout`： [http://api.jquery.com/mouseover/](http://api.jquery.com/mouseover/)
[http://api.jquery.com/mouseout/](http://api.jquery.com/mouseout/)

您只需计算出逻辑，以便更改这些事件的内容。;)

希望这可以帮助。:)

# javascript - jQuery .val() 只返回表单中的第一个值？如何获取所有值？

> ID：13040969
> 
> 赞同：1
> 
> 时间：2012-10-23T23:42:57.000
> 
> 标签：javascript, jquery

仅出于 UX 增强目的尝试执行简单的表单验证预提交。我遇到的问题`.val()`是只返回第一个表单字段值而忽略其余部分。

# jQuery

```
 $('#pForm').submit(function(){
            var print = $(".option:checked").val();
            var design = $(".option:checked").val();
            var error = "Please select a design service...";

            if(print == 'p10','p20','p30','p40','p90','p00'
            && design == 'd10','d20','d30','d40','d00') {

               alert(print);
               alert(design);

               return true;

            } else {

               alert(error);
               return false;

            }

        }); 
```

# HTML（示例代码）

每个无线电都标记如下：

```
<label><input type="radio" name="design" class="option" data-number="<?php echo $var ?>" value="d40"/></label>
<label><input type="radio" name="design" class="option" data-number="<?php echo $var ?>" value="d30"/></label>
<label><input type="radio" name="design" class="option" data-number="<?php echo $var ?>" value="d20"/></label>

<label><input type="radio" name="print" class="option" data-number="<?php echo $var ?>" value="p40"/></label>
<label><input type="radio" name="print" class="option" data-number="<?php echo $var ?>" value="p30"/></label>
<label><input type="radio" name="print" class="option" data-number="<?php echo $var ?>" value="p20"/></label> 
```

最终结果是我不希望提交表单，除非从打印单选字段和设计单选字段中选择一个值。如果检查失败，我想向`error`用户显示一条消息。

*上面的一些代码可能是*半伪*代码感谢您的帮助！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T23:45:38.723

好的，现在你要做什么更清楚了，那么只需执行此操作以确保每个组中都检查了一个项目：

```
if (!$(".design:checked").length || !$(".print:checked").length) {
   // something is not selected
} 
```

一旦您确保两者都有一个选定的值，那么您可以获取使用此代码检查的第一个项目的值：

```
 var print = $(".print:checked").val();
 var design = $(".design:checked").val(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-23T23:46:22.800

val() 总是只返回第一个元素的值。 [http://api.jquery.com/val/](http://api.jquery.com/val/)

请参阅此问题以获得使用地图的良好解决方案： [Getting array of values from jQuery object](https://stackoverflow.com/questions/5550220/getting-array-of-values-from-jquery-object)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-23T23:47:15.360

你很近。尝试这个。

```
if((print == '') || (design == '')) {

       //error 
} 
```

# android - android.os.Message 和/或 Handler.removeCallback 中的内存泄漏？

> ID：13040971
> 
> 赞同：6
> 
> 时间：2012-10-23T23:43:14.047
> 
> 标签：android

我有一个如下所示的活动：

```
class MyActivity extends Activity {
    Runnable refreshTimer = new Runnable() {
        public void run() {
            refresh();
        }
    };

    protected onCreate(...) {
        handler.postAtTime(refreshTimer, ...);
    }

    protected onDestroy() {
        handler.removeCallbacks(refreshTimer);
    }

    protected void refresh() { ... }
} 
```

调用 onDestroy 后，由于某种原因，活动的 MessageQueue 中仍有消息包含对 MyActivity$0（刷新 Runnable）的引用。因为 MyActivity$0 具有对 MyActivity 的隐式引用，这会导致 MyActivity 上下文的内存泄漏。

android.app.Activity 的 merge_shortest_paths 的结果，不包括使用 Eclipse Memory Analyzer Tool 的 phantom、soft、weak 等引用： ![在此处输入图像描述](../Images/ae5d68dfea80737beda1235d0caf6478.png)

（上面的源代码是对MAT转储中显示的实际对象关系的简化）

不应该调用 removeCallbacks 从队列中删除对可运行对象的任何引用吗？为什么我要泄露上下文？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-27T02:01:50.957

可以尝试的东西：

根据 android 文档：

[OnDestroy](http://developer.android.com/reference/android/app/Activity.html#onDestroy%28%29)：在您的活动被销毁之前收到的最后一个调用。这可能是因为 Activity 正在完成（有人在其上调用了 finish()，或者因为系统正在临时销毁该 Activity 实例以节省空间。您可以使用 isFinishing() 方法区分这两种情况。

当您退出活动时，看起来仍然有一堆排队的消息，并且取消注册的上下文没有调用取消回调。

您应该做的是在[onPause](http://developer.android.com/reference/android/app/Activity.html#onPause%28%29)中取消注册您的可运行对象：此回调主要用于保存活动正在编辑的任何持久状态，向用户呈现“就地编辑”模型并确保在没有足够资源时不会丢失任何内容开始新的活动而不首先杀死这个活动。这也是一个很好的地方来做一些事情，比如停止动画和其他消耗大量 CPU 的事情，以便尽快切换到下一个活动，或者关闭诸如相机之类的独占访问资源。

通常，Receiver 或“Scheduled”Runnable 将在 onResume 中注册，并在 onPause 中取消注册以实现更好的生命周期配对

如果没有看到您在刷新中所做的事情，很难说它可能由于活动引用而泄漏，这些活动引用是在刷新方法中引用的活动范围。

# java - 如何让输入决定使用哪个类？

> ID：13040974
> 
> 赞同：1
> 
> 时间：2012-10-23T23:43:22.613
> 
> 标签：java, class, conditional-statements

基本上我希望程序采用输入 A 或 L 来实例化不同的类。我已经准备好接收这些变量等的结构，我只需要知道如何实际创建一个条件或开关，以在给定输入的情况下初始化一个类。代码如下：

```
public constructor(char choice){
    if(choice == 'A'){
        classa<String> baga = new classa<String>();
        classa<String> bagb= new classa<String>();
    }
    else if(choice== 'L'){
        classb<String>  baga = new classb<String>();
        classb<String> bagb = new classb<String>();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-23T23:47:54.033

如果您希望这些变量具有不同的类型，并且您仍然希望从中获得一些用处，那么它们必须具有一些共同的操作。这些操作可以分解为一个`Bag`接口：

```
public ConsonantCounter(char bagImplementationClass){
    Bag vowels;
    Bag consonants;
    if (bagImplementationClass == 'A'){
        vowels = new ResizableArrayBag<String>();
        consonants = new ResizableArrayBag<String>();
    } else if (bagImplementationClass == 'L'){
        vowels = new LinkedListBag<String>();
        consonants = new LinkedListBag<String>();
    }
    // ...
} 
```

顺便说一下， a`char`在这里并不是真正的类型安全的；我会使用枚举。此外，我不喜欢使用突变，所以也许我会沿着这些路线寻求更多的东西：

```
final Bag vowels = makeLetterBag(type);
final Bag consonants = makeLetterBag(type);

private static IBag makeLetterBag(BagType type) {
    switch (type) {
    case RESIZABLE:
        return new ResizableArrayBag<String>();
    case LINKED_LIST:
        return new LinkedListBag<String>();
    }
} 
```

# javascript - jQuery：找到 对于 a 中的选定值 element I have a dropdown menu with different option groups. If someone selects an option, how can I check which optgroup it belongs to? For example if 'ferrari' were selected, how would you determine which optgroup i

> ID：13040979
> 
> 赞同：11
> 
> 时间：2012-10-23T23:44:10.163
> 
> 标签：javascript, jquery, html, option

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-23T23:48:29.797

您可以使用 jQuery 执行此操作：

```
$('select').change(function() {
    var selected = $(':selected', this);
    alert(selected.closest('optgroup').attr('label'));
});​ 
```

在此处查看一个实时示例：http: [//jsfiddle.net/jkeyes/zjLCp/1/](http://jsfiddle.net/jkeyes/zjLCp/1/)

**更新：**是的，您可以使用`parent` [http://jsfiddle.net/jkeyes/zjLCp/2/](http://jsfiddle.net/jkeyes/zjLCp/2/)

```
selected.parent() 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-10-24T02:38:24.453

好吧，在纯js中：

```
this.options[this.selectedIndex].parentNode.label 
```

没有一个函数调用和更少的启动代码。:-)

# java - 尝试在 Tomcat 中将 LDAP 配置为 JNDI 资源

> ID：13040980
> 
> 赞同：8
> 
> 时间：2012-10-23T23:44:13.533
> 
> 标签：java, tomcat, ldap, jndi

我有一个 ldap 服务器，用于在 tomcat Web 应用程序中对用户进行身份验证。我正在使用 JNDIRealm，它是在上下文文件中配置的，效果很好。

我还需要在 ldap 中搜索用户信息。我已经想出了如何使用“jndi 方法”来做到这一点，并且通过使用哈希表创建我自己的 jndi 上下文，我让它在 tomcat 之外正常工作。但是，我不想在代码中配置 jndi 属性，而是想在 Realm 配置旁边的上下文文件中创建一个 JNDI Rsource。

我想我会做这样的事情：

```
<Resource 
  name="ldap"
  auth="Container"
  type="com.sun.jndi.ldap.LdapCtxFactory"
  java.naming.factory.initial="com.sun.jndi.ldap.LdapCtxFactory"
  java.naming.provider.url="ldap://localhost:389"
  java.naming.security.authentication="simple"
  java.naming.security.principal="uid=rjcarr,dc=example"
  java.naming.security.credentials="abc123"
/> 
```

但是要么tomcat告诉我无法创建资源，要么当我尝试使用以下内容对其进行初始化时：

```
Context initctx = new InitialContext();
DirContext ctx = (DirContext) initctx.lookup("java:comp/env/ldap"); 
```

Tomcat 告诉我“无法创建资源实例”。我还在 web.xml 文件中添加了正确的资源引用，所以我认为这不是问题所在。

由于 LDAP 与 JNDI 方法一起使用，我假设它应该能够配置为资源，对吗？我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-25T12:52:15.663

这个答案有点晚了，但可能对其他用户有用。它基于[EJP 的回答](https://stackoverflow.com/a/13113318/1426227)。

以下解决方案在[Apache Tomcat 7](http://tomcat.apache.org/download-70.cgi)上进行了测试。
如果需要，可以替换[`LdapContext`](https://docs.oracle.com/javase/7/docs/api/javax/naming/ldap/LdapContext.html)为[`DirContext`](https://docs.oracle.com/javase/7/docs/api/javax/naming/directory/DirContext.html).

## 创建对象工厂

创建一个实现[`ObjectFactory`](https://docs.oracle.com/javase/7/docs/api/javax/naming/spi/ObjectFactory.html)实例化 a的类[`LdapContext`](https://docs.oracle.com/javase/7/docs/api/javax/naming/ldap/LdapContext.html)：

```
public class LdapContextFactory implements ObjectFactory {

    public Object getObjectInstance(Object obj, Name name, Context nameCtx, 
        Hashtable<?, ?> environment) throws Exception {

        Hashtable<Object, Object> env = new Hashtable<Object, Object>();
        Reference reference = (Reference) obj;
        Enumeration<RefAddr> references = reference.getAll();

        while (references.hasMoreElements()) {

            RefAddr address = references.nextElement();
            String type = address.getType();
            String content = (String) address.getContent();

            switch (type) {

            case Context.INITIAL_CONTEXT_FACTORY:
                env.put(Context.INITIAL_CONTEXT_FACTORY, content);
                break;

            case Context.PROVIDER_URL:
                env.put(Context.PROVIDER_URL, content);
                break;

            case Context.SECURITY_AUTHENTICATION:
                env.put(Context.SECURITY_AUTHENTICATION, content);
                break;

            case Context.SECURITY_PRINCIPAL:
                env.put(Context.SECURITY_PRINCIPAL, content);
                break;

            case Context.SECURITY_CREDENTIALS:
                env.put(Context.SECURITY_CREDENTIALS, content);
                break;

            default:
                break;
            }
        }

        LdapContext context = new InitialLdapContext(env, null);
        return context;
    }
} 
```

## 定义你的资源

将以下内容添加到您的`context.xml`中，引用工厂并定义值以创建[`LdapContext`](https://docs.oracle.com/javase/7/docs/api/javax/naming/ldap/LdapContext.html)实例：

```
<?xml version="1.0" encoding="UTF-8"?>
<Context>
    ...
    <Resource name="ldap/LdapResource" auth="Container"
        type="javax.naming.ldap.LdapContext"
        factory="com.company.LdapContextFactory"
        singleton="false" 
        java.naming.factory.initial="com.sun.jndi.ldap.LdapCtxFactory"
        java.naming.provider.url="ldap://127.0.0.1:389"
        java.naming.security.authentication="simple"
        java.naming.security.principal="username"
        java.naming.security.credentials="password" />
</Context> 
```

如果您需要向资源添加更多属性/值，请考虑更新您[`ObjectFactory`](https://docs.oracle.com/javase/7/docs/api/javax/naming/spi/ObjectFactory.html)在上面创建的以读取这些新属性/值。

## 使用你的资源

在需要的地方注入资源：

```
@Resource(name = "ldap/LdapResource")
private LdapContext bean; 
```

或者查一下：

```
Context initialContext = new InitialContext();
LdapContext ldapContext = (LdapContext)
    initialContext.lookup("java:comp/env/ldap/LdapResource"); 
```

## 看更多

Apache Tomcat 的文档解释了[如何添加自定义资源工厂](http://tomcat.apache.org/tomcat-7.0-doc/jndi-resources-howto.html)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-28T21:44:55.073

你在弥补。Tomcat 资源的类型必须是实现 javax.naming.spi.ObjectFactory 的类。有关自定义资源，请参阅 Tomcat 文档。

# javascript - 如何在 window.onload 函数中使用 javascript 和 php 上传图像

> ID：13040989
> 
> 赞同：0
> 
> 时间：2012-10-23T23:45:12.253
> 
> 标签：javascript, jquery, upload

好的，我是 Javascript（以及一般的 Web 开发）的新手，我想做以下事情：

*   上传图像并将其保存到目录（图像）
*   以某种方式将服务器中的图像路径获取到 onload 函数内的变量。

我知道这是相当具体的，但我真的很感激任何意见。让我知道是否需要更具体。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T00:18:49.370

我想你想说的是，

如何将图像上传到服务器上的文件，然后在需要显示图像时将该路径发送到浏览器？

如果是这样，

```
<form method="post" enctype="multipart/form-data" action="path/to/php/script">
    <input type="file" name="myImage" />Upload Photo:
    <input type="submit" value="Submit">
</form> 
```

您可以使用 JavaScript 提交表单或提交输入。

接下来，您将在服务器上拥有一个 php 脚本，该脚本将图像存储在文件中，并将图像路径保存到数据库或平面文件中。当您想将此图像发送回客户端时，您必须使用 PHP（或另一种更有声望的语言）。我会向您的客户端发送一个 JSON 对象，以便您可以在 JavaScript 中正常工作。但是，如果您想在 php 中执行此操作，您可以随时尝试，

```
window.onload(<?php echo imageVariable; ?>); 
```

有些人会认为我猜这是不好的做法。

让我知道我是否可以提供进一步的帮助。

# math - 处理 T(n) 运行时问题时遇到问题

> ID：13040991
> 
> 赞同：0
> 
> 时间：2012-10-23T23:45:22.223
> 
> 标签：math, time, recurrence

我今天要去见我的助教，但只是没有时间。我在一个算法分析课上，我们开始做递归关系，我不能 100% 确定我做这个问题是否正确。我到了一个地步，我只是卡住了，不知道该怎么办。也许我做错了，谁知道呢。这个问题不关心上限或下限，它只需要一个 theta。

问题是这样的：

```
T(n) = T(n-1) + cn^(2) 
```

这是我到目前为止所拥有的......

```
=T(n-2) + (n-1)^(2) + cn^(2)
=T(n-3) + (n-2)^(2) + 2cn^(2)
=T(n-4) + (n-3)^(2) + 3cn^(2) 
```

因此，在这一点上，我将概括并将 K 代入等式。

```
T(n-k) + (n-k+1)^(2) + c(K-1)^(2) 
```

现在，我开始将 1 的基本情况带入图片。在之前的几个更简单的问题上，我能够将我的广义 k 方程设置为 1，然后求解 K。然后将 K 放回方程中以获得我的最终答案。

但我完全停留在 (n-k+1)^(2) 部分。我的意思是，我真的应该阻止这一切吗？我做到了，得到了 k^(2)-2kn-2k+n^(2) +2n +1 = 1。在这一点上，我想我一定是做错了什么，因为我以前从未见过这个问题。

谁能帮我解决这个问题？我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:52:48.400

即使在“我到目前为止所拥有的”的第一行，你所拥有的也不完全正确。继续做完整的替换，看看：

```
T(n-1) = T(n-2) + c(n-1)^2 
```

所以

```
T(n) = T(n-2) + c(n-1)^2 + c(n)^2
T(n) = T(n-3) + c(n-2)^2 + c(n-1)^2 + c(n)^2 
```

总体运行时间看起来像是为从 0 到基本情况的每个 i 值添加“c(ni)^2”。希望这能让你走上正确的轨道。

# jquery - jQuery Mobile：全宽s fieldgroup 我有一个水平放置的日期选择器：

<fieldset data-role="controlgroup" data-type="horizo ntal"><legend>Your Birth Date:</legend> <select name="cboMonth" id="c</h1>
<blockquote>
        <p>ID：13040993</p>
        <p>赞同：4</p>
        <p>时间：2012-10-23T23:45:34.340</p>
        <p>标签：jquery, jquery-mobile</p>
        </blockquote>

            <hr/>
            <h2>回答 #1</h2>
            <blockquote>
            <p>赞同：4</p>
            <p>时间：2012-10-24T01:56:18.217</p>
            </blockquote>

<p>也许导航栏是一种选择？</p>

<ul>
<li>http://jquerymobile.com/demos/1.2.0/docs/toolbars/docs-navbar.html 例子： http://jsfiddle.net/DjsWv/ 代码： <div data-role="navbar"> <ul> <li><select name="cboDay" id="cboDay" data-corners="false" data-shadow="false"><option>Day</option><option value="1">1</option></select></li> <li><select name="cboMonth" id="cboMonth" data-corners="false" data-shadow="false"><option>Month</option><option value="1">1</option></select></li> <li><select name="cboYear" id="cboYear" data-corners="false" data-shadow="false"><option>Year</option><option value="1">1</option></select></li> </ul> </div><a href=" http:="" jquerymobile.com="" demos="" 1.2.0="" docs="" toolbars="" docs-navbar.html"="" rel="nofollow"></select></fieldset>

# php - 按价格对 PHP 生成的表单进行排序

> ID：13040995
> 
> 赞同：1
> 
> 时间：2012-10-23T23:45:48.837
> 
> 标签：php

我正在尝试按价格对 PHP 生成的表单进行排序。我收到一条错误消息“注意：未定义的索引：PriceDesc/Asc”。我了解错误消息，但无法通过搜索找到任何相关信息，所以我想问一下。我是 PHP 新手，到目前为止，这是我拥有的代码：

```
<!DOCTYPE html>
<html lang="en">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <!--[if IE]>
  <link href="blueprint/ie.css" type="text/css" rel="stylesheet">
  <![endif]-->
  <link href="blueprint/screen.css" type="text/css" rel="stylesheet">
  <link href="style.css" type="text/css" rel="stylesheet">

  <title>Enygma Peripherals</title>
</head>

<body>
<div id="wrapper" class="container">
    <div id="top" class="span-24">
        <div id="logo" class="span-5">
            <a href="index.php"><img src="images/logo.png" alt="Enygma"></a>
        </div>
        <div id="nav" class="span-11 last">
            <ul>
                <li><a href="index.php">HOME</a></li>
                <li><a href="products.php">PRODUCTS</a></li>
                <li><a href="about.php">ABOUT</a></li>
                <li><a href="contact.php">CONTACT</a></li>
            </ul>
        </div>

    </div>
    <div id="mainContent" class="span-24">
        <h2>Products</h2>
        <div id="left" class="span-8">
        </div>
        <div id="right" class="span-15 last">
            <form method="get" name="sort">
                <select name="sort" id="sort">
                    <option value="">--Select--</option>
                    <option value='PriceAsc'>Price: Highest First</option>
                    <option value='PriceDesc'>Price: Lowest First</option> 
                </select>
                <input type="submit" value="Sort"/>
            </form>
            <?php
                include("connection.php");

                $data = mysql_query("SELECT * FROM products");
                IF ($_GET['PriceAsc']){
                    $orderby=" ORDER BY price ASC";
                } 
                IF ($_GET['PriceDesc']){
                    $orderby=" ORDER BY price DESC";
                }
                Print "<table border cellpadding=10>"; 
                while($info = mysql_fetch_array( $data )) 
                { 
                Print "<tr>"; 
                Print "<th>Product Number:</th> <td>".$info['product_no'] . "</td> "; 
                Print "<th>Product:</th> <td>".$info['product_name'] . "</td> "; 
                Print "<th>Type:</th> <td>".$info['type'] . "</td> "; 
                Print "<th>Price:</th> <td>".$info['price'] . "</td> "; 
                Print "<th>Availability:</th> <td>".$info['availability'] . " </td></tr>"; 
                } 
                Print "</table>"; 
                ?>
        </div>      
    </div>
    <div id="footer" class="span-24">
        <a href="acknowledgements.html">Acknowledgments</a>
    </div>
</div> 
```

作为记录，我将 PhpMyAdmin 用于我的后端 d/b，并且初始表格数据工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-23T23:49:16.450

您从未将`$orderby`变量附加到查询中。试试这个：

```
 $data1 ="SELECT * FROM products";
            IF ($_GET['PriceAsc']){
                $data1 .=" ORDER BY price ASC";
            } 
            IF ($_GET['PriceDesc']){
                $data1 .=" ORDER BY price DESC";
            $data = mysql_query($data1); 
```

将`.=`字符串附加到末尾`$data`

你得到未定义索引错误的原因是因为没有`PriceAsc`可用的！你正在尝试`$_GET`一些不存在的东西。

你需要做的是：

```
 IF ($_GET['sort'] == 'Price: Highest First'){
                    $data1 .=" ORDER BY price ASC";
                } else { 
                    $data1 .=" ORDER BY price DESC";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:54:19.410

代替

```
$data = mysql_query("SELECT * FROM products");
            IF ($_GET['PriceAsc']){
                $orderby =" ORDER BY price ASC";
            } 
            IF ($_GET['PriceDesc']){
                $orderby =" ORDER BY price DESC";
            } 
```

和

```
if ( !empty($_GET['sort']) && $_GET['sort'] == 'PriceAsc' ) {
    $orderby=" ORDER BY price ASC";
} 
if ( !empty($_GET['sort']) && $_GET['sort'] == 'PriceDesc' ) {
    $orderby=" ORDER BY price DESC";
}

$data = mysql_query("SELECT * FROM products".$orderby); 
```

注意更改，您需要使用 empty() 检查表单是否已提交并检查其值。并执行一次查询 Order by 附加到 SQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:55:58.507

是的，如上所述将 $sort 附加到 $data

并且您需要将这些查询字符串与 url 一起正确输入

```
http://www/mypage.php?PriceAsc=true 
```

你需要正确比较它

```
 if ($_GET['PriceAsc']=='true'){ 
```

# php - php：字符串之间的正则表达式无法正常工作

> ID：13040996
> 
> 赞同：-1
> 
> 时间：2012-10-23T23:45:52.333
> 
> 标签：php, regex

我需要检索值**6Lf4**，但它只是返回数组..我做错了什么？

```
 <?php
    $inputString = 'private="key" value="6Lf4" sent="yut"';
    $matches = array();
    preg_match_all('/key" value="(.*?)"/', $inputString, $matches);
    echo $matches[1];
    ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-23T23:50:49.990

基于[http://ideone.com/vDV7yE](http://ideone.com/vDV7yE)，您将希望使用它`$matches[1][0]`来获取您的字符串：

```
Array
(
    [0] => Array
        (
            [0] => key" value="6Lf4"
        )

    [1] => Array
        (
            [0] => 6Lf4
        )

) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-23T23:48:39.843

试试这个模式，

```
(?<=(value=")).*?(?=") 
```

请参阅**[Lookahead 和 Lookbehind 零宽度断言。](http://www.regular-expressions.info/lookaround.html)**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T23:48:40.803

在这里查看：http: [//php.net/manual/en/function.preg-match-all.php](http://php.net/manual/en/function.preg-match-all.php)

你会想做：

```
echo $matches[1][0]; 
```

这是因为您正确使用键 1 来获取带括号的子模式，但是您想获取此类型的第一个匹配项，因此您需要获取索引 0 处的 THAT 子数组的值。

所以你已经完成了一半，但你需要在你返回的数组中获取实际值。