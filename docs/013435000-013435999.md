# StackOverflow 问答 13435000-13435999

# javascript - 如何在 IE8 中触发自定义 javascript 事件？

> ID：13435008
> 
> 赞同：11
> 
> 时间：2012-11-17T21:36:32.860
> 
> 标签：javascript, jquery, internet-explorer, jquery-mobile, requirejs

我试图在 IE8 上触发一个自定义事件，并从[这里](http://dean.edwards.name/weblog/2009/03/callbacks-vs-events/)和[这里](https://stackoverflow.com/questions/5342917/custom-events-in-ie-without-using-libraries)一起摆弄一个解决方案。但我无法让它工作......

我正在将 jquery mobile 与 requireJS 和谷歌分析一起使用。所以我正在跟踪 JQM`pageshow`事件。但是，由于 requireJS 异步加载脚本，我对 pageshow 的绑定需要在 javascript“包装器”中进行，否则会产生错误，因为在解析代码段时，jquery 和 jquery mobile 都不会被加载。

所以我在每一页的末尾都包含了这个：

```
if (document.addEventListener) {
    document.addEventListener("jqmReady",function(){trigAnalytics("jqmReady");alert("FF detected")},false); 
} else if ( document.attachEvent ) {
    document.attachEvent("jqmReady", function(){trigAnalytics("jqmReady");alert("IE detected")}); 
} 
```

当检测到时，我正在使用 pageshow 绑定触发我的分析片段：

```
var trigAnalytics = function( trigger ){ 
    $(document).on('pageshow','div:jqmData(role="page").basePage', function (event, ui) {
        var url = location.href; 
        try { 
            hash = location.hash; 
            if (hash && hash.length > 1) {
                 _gaq.push(['_trackPageview', hash.substr(1)]);
                 _gaq.push(['_setCustomVar', 1, 'id_external', ########, 1 ]);
            } else {
                _gaq.push(['_trackPageview', url]);
                _gaq.push(['_setCustomVar', 1, 'id_external', ########, , 1 ]);
                _gaq.push(['b._trackPageview', url]);
            } 
        } catch(err) { } 
    }); 
    if (typeof _gaq !== "undefined" && _gaq !== null) { 
        $(document).ajaxSend(function(event, xhr, settings){ 
            _gaq.push(['_trackPageview', settings.url]); 
            _gaq.push(['b._trackPageview', settings.url]);
        }); 
    } 
}; 
```

所以要启动事件链，我需要`jqmReady`在 JQM 准备好时触发。JQM 使用他们的`mobileinit`事件来表明这一点。所以在我的应用程序控制器初始化中，我像这样绑定到它：

```
$(document).bind("mobileinit", function () {

    // non-IE OK
    if (document.createEvent) {
        evt = document.createEvent("Event");
        evt.initEvent("jqmReady", true, true);
        document.dispatchEvent(evt);

    } else if (document.createEventObject) { 
    // MSIE (NOT WORKING)

        document.documentElement.evt = 0; // an expando property
        document.documentElement.attachEvent("jqmReady", function () {
            document.documentElement.evt = document.documentElement.evt + 1;
            });
    }
}); 
```

我试过只触发 $(window).trigger('jqmReady')，因为当`mobileinit`触发时，jquery 可用。但是，似乎`addEventListener`无法像这样触发中创建的事件，所以我需要一个纯 JavaScript 的解决方案来触发 IE 中的自定义事件。

**问题：**
有人可以告诉我如何正确触发 IE8 的 javascript 自定义事件吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-18T12:00:38.247

好的，我终于明白了......这是它的工作原理：

1）在正在加载的页面上设置jqmReady的监听器

```
// non-IE: just create a listener for the custom event "jqmReady"
if (document.addEventListener) {
    document.addEventListener("jqmReady",function(){trigAnalytics("jqmReady");alert("FF detected")},false); 
// IE8
} else if ( document.attachEvent ) {

    // create a custom property name jqmReady and set it to 0
    document.documentElement.jqmReady = 0;
    // since IE8 does not allow to listen to custom events, 
    // just listen to onpropertychange
    document.documentElement.attachEvent("onpropertychange", function(event) {

        // if the property changed is the custom jqmReady property
        if (event.propertyName == "jqmReady") {
            trigAnalytics("jqmReady");
            alert("gotcha")
            // remove listener, since it's only used once
            document.documentElement.detachEvent("onpropertychange", arguments.callee);
        }
    });
} 
```

所以在 IE8 上我不听 custom `jqmReady`。相反，我监听`onpropertychange`我的自定义属性`jqmReady`

2）然后在mobileinit我触发是这样的：

```
 // non-IE
 if (document.createEvent) {
      evt = document.createEvent("Event");
      evt.initEvent("jqmReady", true, true);
      document.dispatchEvent(evt);
 } else if (document.createEventObject) { // MSIE
      // just change the property 
      // this will trigger onpropertychange
      document.documentElement.jqmReady++;
 }; 
```

好主意（归功于[http://dean.edwards.name/weblog/2009/03/callbacks-vs-events/](http://dean.edwards.name/weblog/2009/03/callbacks-vs-events/)），也许其他人可以找到它的用途。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-10-03T13:02:09.300

对于其他感兴趣的人，我已将此代码包装成一个静态 javascript 对象

```
function Event () {
}

Event.listen = function (eventName, callback) {
    if(document.addEventListener) {
        document.addEventListener(eventName, callback, false);
    } else {    
        document.documentElement.attachEvent('onpropertychange', function (e) {
            if(e.propertyName  == eventName) {
                callback();
            }            
        });
    }
}

Event.trigger = function (eventName) {
    if(document.createEvent) {
        var event = document.createEvent('Event');
        event.initEvent(eventName, true, true);
        document.dispatchEvent(event);
    } else {
        document.documentElement[eventName]++;
    }
} 
```

用法：

```
Event.listen('myevent', function () {
    alert('myevent triggered!');
});

Event.trigger('myevent'); 
```

演示：http: [//jsfiddle.net/c5CuF/](http://jsfiddle.net/c5CuF/)

# java - Netflix风格的java程序

> ID：13435016
> 
> 赞同：-2
> 
> 时间：2012-11-17T21:37:36.253
> 
> 标签：java, queue, netflix

所以我的任务是创建一个非常简单的基于 Netflix 的程序。所以本质上它必须有几个不同的类。一个电影类（带有基本电影信息，虽然已经这样做了）和一个用户类（这必须有基本的用户信息，如姓名和帐号。但还必须有一个显示最近观看的五部电影的电影列表，以及一个播放列表或本质上是一个队列，其中包含他们将要观看的下一部电影）这是我目前陷入困境的地方，因为我对队列的了解不足，无法为这个项目制作一个。那么我将如何为此创建一个队列呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T21:39:54.820

A`Queue`是[先进先出 (FIFO)](http://en.wikipedia.org/wiki/FIFO)数据结构。您可以将您的`Movie`类的对象添加到`Queue`并根据需要检索它们。查看[队列 API](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Queue.html)。

此外，这里是使用队列[的 Oracle/Sun 教程](http://docs.oracle.com/javase/tutorial/collections/interfaces/queue.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:24:36.773

队列是一种使用 FIFO 格式的数据结构。在 Java API 中，队列是一个接口，您可以自己实现它，也可以使用诸如 LinkedList 之类的对象来为您完成它。这是一些示例代码，它应该向您展示一种将 ArrayDeque 用作队列的方法。

```
import java.util.ArrayDeque;
import java.util.Queue;

public class QueueTest {

    public static void main(String args[]){

        Queue myQ = new ArrayDeque();

        myQ.add("movie one");
        myQ.add("movie two");
        myQ.add("movie three");

        while(myQ.peek() != null){
            //Movies will be printed in the order they were inserted
            System.out.println(myQ.remove());
        }
    }
} 
```

# debugging - Visual Studio 2012 Ultimate 中的反汇编窗口未显示

> ID：13435018
> 
> 赞同：2
> 
> 时间：2012-11-17T21:37:59.220
> 
> 标签：debugging, visual-studio-2012, disassembly

我刚刚开始使用我的 Visual Studio 的调试器并遇到以下问题：当我启动调试器时，反汇编窗口不存在！

这是我的调试菜单的 Windows 部分的图像：

[截屏](http://i46.tinypic.com/2dw6cme.png)

我想知道这是否不是可选安装？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T21:46:04.147

我无法粘贴图片，但是如果您在断点处右键单击源，您将`goto disassembly`在菜单选项中看到。

# iphone - SDWebImage 始终加载占位符图像而不是来自 URL 的图像

> ID：13435019
> 
> 赞同：5
> 
> 时间：2012-11-17T21:38:09.533
> 
> 标签：iphone, objective-c, ios, uiimageview, sdwebimage

[嗯，这里](https://github.com/rs/SDWebImage)使用 SDWeb 图像

这些我的代码：

```
 UIImageView *sellerImage = [[UIImageView alloc]init];            
[sellerImage setImageWithURL:[NSURL URLWithString:[NSString stringWithFormat:productPicture]]
                        placeholderImage:[UIImage imageNamed:@"placeholder.png"]]; 
```

但它总是只加载占位符图像而不是来自 URL 的图像，我尝试使用块来确保它是否加载图像并进入成功块，这意味着 SDWebImage 可以从 URL 加载图像但是它不会更改占位符图像。

这些是我尝试使用块时的代码：

```
 [sellerImage setImageWithURL:[NSURL URLWithString:[NSString stringWithFormat:productPicture]]
                placeholderImage:[UIImage imageNamed:@"placeholder.png"]
                         success:^(UIImage *image, BOOL cached) 
        {
            NSLog(@"success Block");
        }
                         failure:^(NSError *error) 
        {
            NSLog(@"failure Block");
        }]; 
```

正如我所说，它总是进入成功块，这意味着它可以从 URL 加载图像，但不会更改占位符图像。

这些是我的问题的一个屏幕。

![在此处输入图像描述](../Images/ca6204f4077b42b4b6ed416520472a99.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:27:00.493

也尝试以下

```
[sellerImage setImageWithURL:[NSURL URLWithString:[productPicture stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]
                placeholderImage:[UIImage imageNamed:@"placeholder.png"]
                         success:^(UIImage *image, BOOL cached) 
        {
            dispatch_async(dispatch_get_main_queue(), ^{
                sellerImage.image = image;
            });
            NSLog(@"success Block");
        }
                         failure:^(NSError *error) 
        {
            NSLog(@"failure Block");
        }]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:14:59.007

try the following

```
UIImageView *sellerImage = [[UIImageView alloc]init];            
[sellerImage setImageWithURL:[NSURL URLWithString:[NSString stringWithFormat:
[productPicture stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]]
placeholderImage:[UIImage imageNamed:@"placeholder.png"]]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-03T09:21:35.283

正确分配占位符图像..我的问题是错误的图像扩展名彼此不匹配，即 placeholder.jpeg 和 palceholder@2x.jpg

# sql - 在多个数据库表中具有相同的数据值

> ID：13435020
> 
> 赞同：0
> 
> 时间：2012-11-17T21:38:20.610
> 
> 标签：sql, database, database-design, relational-database

我有一个包含 20 万学生记录的数据库，每个学生都有一个可扩展的个人资料。

`Students`是主键表，

`StudentProfiles`是存储 Profiles 元素：

```
[ProfileID],[StudentID],[PropertyDefinitionID],[PropertyValue] 
```

每个配置文件包含大约 120 个属性，因此`StudentProfiles`我有 20 万学生 * 120 个配置文件属性 = 2400 万行。

一些重要的 Profile 元素喜欢`Count(StudentSiblings)`或`GuardianEmail`在许多外部操作中使用，而其他 Profile 元素很少使用。

为了获得更好的性能，如果我们也将这 3 个或 4 个 Profile Properties 保存为主表中的列，会有什么问题`Students`吗？

这只是一个示例，我还有另一种情况，我想将一个表的聚合函数的结果保存在另一个表中以便更轻松快捷地访问，例如将学生表中的学生付款总和存储为列，是那种非规范化打破了数据库设计标准。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T06:35:58.683

如果这些常用的配置文件元素是原子的——即每个学生只有一个 GuardianEmail 值——那么我认为没有理由不将这些值存储在学生表中，就像将学生的电子邮件或姓氏存储在学生表。

# continuous-integration - 我应该在哪里安装我的持续集成服务器？

> ID：13435021
> 
> 赞同：0
> 
> 时间：2012-11-17T21:38:26.113
> 
> 标签：continuous-integration

我是一家初创公司的首席开发人员，我们目前有以下设置：

```
- Development Server
- Staging Server
- Production Server
- Paid Subversion Hosting

- My local machine
- 2 other developers' local machines 
```

托管 CI 服务器的最佳位置在哪里？在全新的服务器上？或者我的本地机器是否足够？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T21:41:34.840

绝对不是你的本地机器。除非您不介意减慢开发服务器的速度，否则我建议您使用单独的服务器。

我说不是您的本地机器，因为您最不想受到阻碍的是构建。没有什么比一台缓慢的机器更令人沮丧的了。而且您通常应该保留从单独的服务器生成的官方版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T22:28:43.727

通常不是本地机器（当其他选项可用时），因为您最希望在构建服务器上安装（或未安装）与生产服务器上相同的“东西”，以便构建服务器上运行的任何内容在尽可能真实的场景中运行。

从 .NET 的角度来看，这意味着我不希望（例如）Visual Studio 在构建服务器上运行，从而排除了我的本地计算机。

确保您团队中的某个人可以访问该机器并可以对其执行操作也是一个好主意，从而可能排除托管解决方案。

除此之外，只要它是在一个具有一半像样规格的盒子上，我认为这并不重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T22:14:18.407

I would put it at the development server, staging server, or the paid subversion hosting instance, if possible.

# algorithm - 动态规划：城市遍历

> ID：13435023
> 
> 赞同：3
> 
> 时间：2012-11-17T21:38:53.780
> 
> 标签：algorithm, dynamic-programming

我遇到了这个问题：

有两个人。有n个城市的有序序列，每对城市之间的距离是给定的。您必须将城市划分为两个子序列（不一定是连续的），使得 A 人访问第一个子序列中的所有城市（按顺序），人 B 访问第二个子序列中的所有城市（按顺序），并且使得A 和 B 的总距离最小化。假设人 A 和人 B 最初从他们各自子序列中的第一个城市开始。

我寻找它的答案，答案是：
让 c[i,j] 是如果第一个人停在城市 i 和第二个人停在城市 j 的最短距离。假设 i< j

c[0,j]= k 从 1 到 j-1 的 (d[k,k+1]) 之和
c[i,j] = min(c[k,j]+ d[k,i])如果 i!=0 其中 0

解决方案也可以在[这里的问题 10 中看到](http://courses.csail.mit.edu/6.006/fall10/handouts/dpproblems-sol.pdf)

现在，我的问题是：
1\. 这个解决方案没有 i=1 的定义（因为 k 没有价值）。
2\. 现在，假设我们正在寻找 c[2,3]。它将是 c[1,3]+ d[1,2]。现在 c[1,3] 表示 B 访问了 0、2 和 3，而 A 保持在 1 或 B 访问了 2 和 3，A 访问了 0 和 1。此外，c[2,3] 表示 A 仅访问了 2/ 0,1,2 /0,2 /1,2。所以，

```
 c[1,3] = min(d[0,1]+ d[2,3], d[0,2]+ d[2,3])
 c[2,3] = min(d[0,1]+ d[1,2], d[0,2]+ d[1,3], d[1,2]+d[0,3], d[0,1]+d[1,3]) 
```

可以看出，解决方案没有重叠。

换句话说，2 已经被 c[1,3] 中的 B 覆盖。因此，如果我们在 c[2,3] 中包含 c[1,3]，则意味着 A 和 B 都访问了 2，这不是必需的，因为它只会增加成本。

如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-04T10:23:04.363

Q:: Two-Person Traversal of a Sequence of Cities: You are given an ordered sequence of n cities, and the distances between every pair of cities. Design an algorithm to partition the cities into two subsequences (not necessarily contiguous) such that person A visits all cities in the first subsequence (in order), person B visits all cities in the second subsequence (in order), and the sum of the total distances travelled by A and B is minimised. Assume that person A and person B start initially at the first city in their respective subsequences.

Here is how I understood the solution ::

Let us say the cities are number from 1 to n. We recurse on C(i, j), the minimum distance traveled if person A ends at city i and person B ends at city j. Assume without loss of generality i < j.

Let C(0, n) denote that person A does not visit any city, while person B visits all the cities from [1, n].

Hence, C(0, j) = d(1,2) + d(2,3) + .... + d(j-1, j) (B starting from city 1, going in order till city j).

C(i, j), where i is not 0 = minimum of following two cases :

case 1 : person A starts and stops at city i. In which case, C(i, j) = distance travelled by person B, travelling to all cities from 1 to j in order, skipping city i = d(1,2) + d(2,3) + ... + d(i-1, i+1) + d(i+1, i+2) + ... + d(j-1, j)

case 2 : person A starts at some city before i, and hence there is a city k which he travels just before going to city i (second last city in his traversal). In this case, C(i, j) = minimum {C(k, j) + d(k, i)} where k can vary from 1 to i-1\.

The solution to the problem is minimum { C(i,n) } where i varies from 0 to n-1\.

We can fill the DP matrix in row major order, as each calculation of C(i,j) requires either the distances d, or C(k,j) where k < i.

The running time of the algorithm will be O(n^3), as there are O(n^2) entries for which we do the calculation, and each calculation takes O(n) time.

Edit :: I think the solution given in the handout is missing case1\.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T17:06:59.310

您说得对，建议的解决方案有些混乱且不正确。

思考问题的方法一如既往地归纳：如果我需要解决大小为 n 的问题，我如何将其简化为更小的问题（0，...，n-1）。如果您想解决大小为 n 的问题，请注意其中一名玩家需要将节点 n 带入他们的路径。

C[i, j] 函数是一个辅助函数，表示如您所描述的“A 停在 i 和 B 停在 j 的最小成本”。

为了到达状态 C[i,j]，玩家 B 必须从 j-1 到 j，当然除非 j-1 = i。在 j-1 = i 的情况下，j 必须来自某个 k < i。因此函数 C[i, j] 可以描述如下：

```
C[i,j] = {
   C[i,j-1] + d[j-1,j]                   (if i < j-1)
   min C[k,i] + d[k,j] for 0 <= k < i    (if i = j-1)
} 
```

使用此设置，您的基本情况就是 C[0, 1] = d[0,1]。

那么你的最终答案是 min C[k, n] for 0 <= k < n。

# c++ - 使用 cout 打印一个（浮点）小数

> ID：13435024
> 
> 赞同：0
> 
> 时间：2012-11-17T21:39:05.033
> 
> 标签：c++, floating-point, iostream, css-position, cout

我有一个浮点数，我想在小数点后打印一位。我怎样才能做到这一点`cout`？我尝试了以下代码，但显示错误。

```
#include <iostream>

using namespace std;

int main()
{
    float time = 2.2;
    cout.precision(1);
    cout << time << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T21:41:06.763

您需要将 tge 精度设置为 1，并将格式标志浮动为`fixed`：

```
std::cout << std::fixed << std::setprecision(1); 
```

顺便说一句，不要使用`std::endl`. 要获得换行符`'\n'`，并且如果您真的要刷新流，请使用`std::flush`.

# .net - 单线程应用程序的重入

> ID：13435028
> 
> 赞同：1
> 
> 时间：2012-11-17T21:39:27.123
> 
> 标签：.net, asynchronous, com, thread-safety, activex

通过 .NET 4.0（使用 VB2010）编写 Winforms 应用程序。它有一个单一的形式，包括一个异步引发事件的 ActiveX COM 控件。这些事件由表单代码文件上的钩子函数处理。应用程序不会启动任何线程（当然除了主线程）。

我应该防止事件处理程序重入吗？**事件A**的钩子函数正在执行时是否可以调用事件**B的钩子函数？**

 **{ 搜索网络提出了几个相互矛盾的答案。我在这里感到困惑......}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T21:58:47.627

ActiveX 控件与 .NET 控件没有任何不同。无论您在事件中做什么 影响控件的事件处理程序肯定会引发另一个事件。或者可能会再次引发事件 A。另一个事件很少引起麻烦，但后一种情况通常会导致该站点的名称异常。你用同样的方法修复它，一个防止重新进入的布尔字段。

基本机制是相同的。ActiveX 控件也可以在属性设置器中触发事件。这与线程或单线程单元没有任何关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T21:46:13.337

在不知道涉及哪个 ActiveX 控件和事件的情况下，答案只能是相当笼统的：

您应该始终以优雅的方式处理任何重入。
您可以“丢弃”任何重新进入，也可以并行处理它们，或者您可以“排队”它们并一个接一个地处理它们......

没有更多细节，我看不到更具体的方法:-(**

# javascript - Javascript：ReferenceError：未定义 MyClass

> ID：13435029
> 
> 赞同：3
> 
> 时间：2012-11-17T21:39:35.427
> 
> 标签：javascript, coffeescript

这是非常基本的。我尝试实例化在嵌入的外部 .js 文件中定义的类。.js 的代码就是这样。

```
(function() {
  var MyClass;

  MyClass = (function() {

    function MyClass() {}

    MyClass.prototype.name = function(name) {};

    return MyClass;

  })();

}).call(this); 
```

HTML是这样的

```
<!DOCTYPE html>
<html>

  <head>
    <title>Sample Page</title>
    <script src="file.js" type="text/javascript"></script>
  </head>

  <body>

  </body>
</html> 
```

如果我尝试在控制台上实例化该类，但我看到`ReferenceError: MyClass is not defined`：

```
var myVar
myVar = new MyClass
> ReferenceError: MyClass is not defined 
```

如果我尝试`MyClass`直接从控制台调用，我会得到同样的错误

```
> ReferenceError: MyClass is not defined 
```

我确定我在这里遗漏了一些明显的可怕东西，但我可以弄清楚是什么。

**更新**：要创建我使用 CoffeScript 编码的 javascript，代码就是这样。

```
class MyClass
  acc: (name) -> 
```

[当使用http://js2coffee.org](http://js2coffee.org)转换回 CoffeScript 时，建议的答案代码呈现为不同的代码，但它仍然不起作用。想知道 CoffeScript 是否有提示将 MyClass 从本地范围弹出到外部范围。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T21:44:01.997

我的类是在闭包中定义的。相反，您想要做的是通过将其设置为窗口对象将其“弹出”到外部范围：

```
(function() {

    var myClass = ...

    window.myClass = myClass;

}).call( this ); 
```

**更新**：您似乎想要在 CoffeeScript 中使用它。干得好：

```
(->

  myClass = (->
    myClass = ->
    myClass::name = (name) ->

    myClass
  )()

  window.myClass = myClass

).call this 
```

**[JSBin 演示](http://jsbin.com/uyebeb/2/edit)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T21:43:24.107

`MyClass`被定义到自调用函数的本地范围内。您可以尝试`MyClass`在自调用函数之外进行初始化：

```
var MyClass;
(function() {

  MyClass = (function() {

    function MyClass() {}

    MyClass.prototype.name = function(name) {};

    return MyClass;

  })();

}).call(this); 
```

您可以做的另一件事是：

```
(function() {
  this.MyClass = (function() {

    function MyClass() {}

    MyClass.prototype.name = function(name) {};

    return MyClass;

  })();

}).call(window); 
```

在上面的代码中，您只是使用`window`上下文调用匿名函数并将值设置为`MyClass`窗口的属性（这使得`MyClass`全局）。

另一个解决方案（在我看来更不清楚）是：

```
(function() {

  window.MyClass = (function() {

    function MyClass() {}

    MyClass.prototype.name = function(name) {};

    return MyClass;

  })();

}).call(this); 
```

唯一的区别是您明确地说`MyClass`window 的属性将等于函数的执行结果。

您的 CoffeeScript 可能类似于：

```
MyClass = undefined
(->
  MyClass = (->
    MyClass = ->
    MyClass::name = (name) ->

    MyClass
  )()
).call this 
```

# unit-testing - 带有 MS 假货的 TDD

> ID：13435034
> 
> 赞同：3
> 
> 时间：2012-11-17T21:40:00.497
> 
> 标签：unit-testing, tdd, microsoft-fakes

我将尝试 TDD，并且正在为此研究合适的工具。在工作中，我们使用的是 MS Fakes，因此最好不要更改它并使用带有 TDD 的 MS Fakes。但我有一个严重的问题。在我看来，MS Fakes 旨在用于场景：**编写代码**->**为其编写单元测试**。如何在 TDD 期间使用 MS Fakes 模拟某些界面？

例如，我在**一个**文件中有以下代码（稍后将进行重构）

```
[TestClass]
public class MyTests
{
    [TestMethod]
    public void ShouldReturnSomeResultIfEmptyCollectionOfCustomersWasReturned()
    {
        // arrange
        ICustomerRepository customerRepository = null;
        var targetService = new MyTargetService(customerRepository);

        // act
        int result = targetService.MyMethod();

        // assert
        Assert.AreEqual(1, result);

    }
}

public class MyTargetService : IMyTargetService
{
    private readonly ICustomerRepository customerRepository;

    public MyTargetService(ICustomerRepository customerRepository)
    {
        this.customerRepository = customerRepository;
    }

    public int MyMethod()
    {
        if (customerRepository.GetCustomers().Any())
        {
            return 0;
        }

        return 1;
    }
}

public interface IMyTargetService
{
}

public interface ICustomerRepository
{
    Customer[] GetCustomers();
}

public class Customer
{
} 
```

在我的 TDD 过程中，我将所有内容都放在一个文件中，然后将对其进行重构并移至不同的程序集。但我需要在这个地方模拟内联`ICustomerRepository customerRepository = null;`。例如，我可以使用 NSubstitute 轻松完成。但是，如果我使用 MS Fakes，我首先需要将此界面移动到另一个项目，请从单元测试所在的项目中引用该项目，然后按“添加假程序集”。这似乎是非常复杂的工作流程，这使得 TDD 变得不那么快速和高效。我希望在没有所有这些奇怪操作的情况下就可以编写这样的代码：

```
ICustomerRepository customerRepository = new StubBase<ICustomerRepository>
                {
                    GetCustomers = () => Enumerable.Empty<Customer>().ToArray(),
                }; 
```

而是`StubBase<>`抽象的。那么有没有办法用 MS Fakes 做这样的事情呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T12:45:25.920

冒着引发一场激烈战争的风险，这对于 MS 套件中的大多数测试工具都是如此。简短回答：使用这些工具时，您应该就是否要使用它们做出明智的决定。如果您选择“是”，则您必须总体上遵守 MS 对 TDD 或单元测试的定义——即使它看起来违反直觉。

*   编码 UI 要求您在开始编写测试之前生成 UI 地图。这要求您在开始编写脚本测试之前完成 UI。
*   MSTest 强制您编写无法共享（创建成本高）状态的测试，即使它们属于同一个测试夹具。这意味着必须一遍又一遍地运行昂贵的设置以保持测试独立/并行友好。
*   借助 PEX，MS 承诺通过自动生成测试用例对已经编写的代码进行测试覆盖。然而，它与 TDD 没有任何关系。

MS Fakes 似乎规定您需要右键单击包含您的接口的程序集并生成一个 Fakes 程序集。然后学习命名约定（这对我来说似乎有点奇怪）并将 lambda 表达式或委托映射到您的代码可能使用的每个接口成员。我担心结果测试不可读/重构友好。

对于在抽象层（接口）后面有依赖项的推荐情况，Rhino、Moq、NSubstitute 等常见的嫌疑人可以正常工作而不会妨碍您。我为 MS Fakes 找到的唯一地方是遗留代码或第三方代码，您无法访问源代码以解耦/注入依赖项。在这种情况下，MS Fakes 可能会很有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T16:49:58.697

Fakes 依赖于构建时代码生成，目前需要您在单独的项目中定义要存根的接口/类。与在运行时生成存根的其他框架（例如 NSubstitute）相比，这需要一个额外的重构步骤才能编译新测试 - 将您刚刚创建的新接口从测试项目移动到目标项目。使用 Resharper 只需几次击键即可完成此重构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-23T03:40:52.297

我不建议使用 MS Fakes。它会妨碍您并导致您编写糟糕的测试代码，并迫使您使用 xml 文件。对于 TDD 来说，这不是一个好的测试框架时期。罗伊·奥舍罗夫（Roy Osherove）会为此作担保，他在书中做了。

保持简单对吗？MS Fakes 会导致您并要求您做相反的事情，如果您使用该工具，您最终会一团糟。

# javascript - 仅在未调用特定函数时才调用构造函数行为

> ID：13435036
> 
> 赞同：1
> 
> 时间：2012-11-17T21:40:15.100
> 
> 标签：javascript, oop

道歉 - 我不知道如何描述这一点。例子：

```
function OutputNumber(number) {
    this.outputThisInstead = function (otherNumber) {
        console.log(otherNumber);
    }
    console.log(number);
} 
```

所需用途：

* * *

`new OutputNumber(1);`

控制台输出：`1`

* * *

`new OutputNumber(1).outputThisInstead(2);`

控制台输出：`2`

* * *

自然，`1`将始终写入控制台，而不管对象上还调用了什么。

我追求这种特殊的语法以及行为——将一个函数附加到初始化上。感觉不可能，因为必须在调用任何函数之前构造对象，但是这可以通过其他方式实现吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T21:44:50.933

可能有时间延迟（例如，在浏览器环境`setTimeout`或类似环境中）和标志。不可取*，*但可能。

没有它，不，你不能将构造函数的动作建立在尚未发生的事情上。相反，您必须将某些内容传递给构造函数以让它知道发生了什么。

浏览器示例（同样，我不推荐这个）：

```
function OutputNumber(number) {
    var handle = 0;
    this.outputThisInstead = function (otherNumber) {
        if (handle) {
            clearTimeout(handle);
            handle = 0;
        }
        console.log(otherNumber);
    }
    handle = setTimeout(function() {
        console.log(number);
    }, 0);
} 
```

* * *

根据您对问题的评论：

> 这是我正在试验的一系列链接对象/函数的结尾。例如：
> 
> ```
> Assert.that(1).is.not(2).because('output this message if fails'); 
> ```
> 
> 这里 not(2) 返回一个对象，因为可以选择调用该对象。对象的行为将取决于被调用。

与其让链中较早函数的行为依赖于链中较晚的函数，我可能会`.end()`在某些内容的末尾添加一个：

```
Assert.that(1).is.not(2).because('output this message if fails').end(); 
```

`end`将输出先前函数存储的任何消息/消息。不需要黑魔法。显然，这会受到人们可能无法打开的事实的影响，但是如果您希望输出基于可选的后续函数调用而更改，则`.end()`您需要*某种触发器来执行输出是可以的。*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T21:47:32.880

不可能。到您执行此操作时，`new OutputNumber(1)`该函数已被调用。链式方法将无法访问其先前的调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T21:53:14.910

可以声明`outputThisInstead`为“静态”：

```
function OutputNumber(number) {
    console.log(number);
}

OutputNumber.outputThisInstead = function (otherNumber) {
    console.log(otherNumber);
}

new OutputNumber(1); //1
OutputNumber.outputThisInstead(2); //2 
```

但是，如果您想使用`new`操作符创建一个对象，该函数将始终记录`number`参数。

[您还可以通过部分应用该功能（此处](https://en.wikipedia.org/wiki/Currying)）实现与您想要的类似的行为。这也称为 Currying 或 Schönfinkeling。这个想法是你可以一个接一个地填充函数的参数，当全套参数可用时，函数正在执行。[你可以在这里](http://ejohn.org/blog/partial-functions-in-javascript/)看到一个柯里化的例子。

# r - 将 R 中的 model.matrix 转换为组向量

> ID：13435038
> 
> 赞同：1
> 
> 时间：2012-11-17T21:40:27.997
> 
> 标签：r

在 R 中，我们可以使用`model.matrix()`来构造设计矩阵，例如，

```
grp.ids = as.factor(c(rep(1,8), rep(2,4), rep(3,2)))
x = model.matrix(~grp.ids) 
```

给出设计矩阵`x`：

```
 (Intercept) grp.ids2 grp.ids3
1            1        0        0
2            1        0        0
3            1        0        0
4            1        0        0
5            1        0        0
6            1        0        0
7            1        0        0
8            1        0        0
9            1        1        0
10           1        1        0
11           1        1        0
12           1        1        0
13           1        0        1
14           1        0        1
attr(,"assign")
[1] 0 1 1
attr(,"contrasts")
attr(,"contrasts")$grp.ids
[1] "contr.treatment" 
```

但是，如果现在给我一个`x`如上所述的设计矩阵，并希望`grp.ids`通过某种方式操作来获得“分组向量” `x`。我怎样才能做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:07:33.610

我不相信您可以完全按照最初创建的方式恢复 grp.id，因为无法判断 id 的原始值是什么。您可以创建一个导致相同 model.maxtrix 的向量。

```
factor(apply(x, 1, paste, collapse = "."), labels = seq(ncol(x))) 
```

但是，在这种特殊情况下，这非常接近。

* * *

前一个标签的顺序为 1、3、2（而不是所需的 1、2、3），这是因为我们得到“1.0.0”、“1.1.0”、“1.0.1”为我们的实际输出并按字母数字排序，这些给出的顺序是 1、3、2。如果我们反转输入字符串，所以我们有“0.0.1”、“0.1.1”和“1.0.1”，那么这将给出所需的顺序，所以以下应该工作

```
factor(apply(x, 1, function(x){paste(rev(x), collapse = ".")}), labels = seq(ncol(x))) 
```

# java - java代码格式

> ID：13435039
> 
> 赞同：0
> 
> 时间：2012-11-17T21:40:35.220
> 
> 标签：java

对于一个非常愚蠢的问题，我真的很抱歉。我没有完全接受过 Java 的正式培训，而且很多时候，在查看代码时，我可能会看到如下内容：

```
(  ) ?   : 
```

就像这样：

```
for (str == null) ? getString(this) : dontGetit(nope.this); 
```

老实说，我什至不知道它到底是什么，或者它是否离得很近，但希望有人能认出这个计划。我希望有人可以链接一些关于此的文档，因为我什至无法搜索它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T21:42:46.397

它是Java中的三元运算符。在这里阅读：[http ://www.janeg.ca/scjp/oper/ternary.html](http://www.janeg.ca/scjp/oper/ternary.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T21:43:00.287

它是一个用于评估**布尔表达式的****三元运算符**。它相当于 if-else 语句。

 ****句法：**

```
 variable_name= (boolean expression) ? value to assign if true : value to assign if false 
```

**使用三元运算符：**

```
 boolean isHappy = true;
    String mood = (isHappy == true)?"I'm Happy!":"I'm Sad!"; 
```

**使用 if-else：**

```
 if(isHappy) {
     mood="I'm Happy";
  }
  else {
     mood = "I'm, Sad!";
   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T21:42:21.113

这是java中的条件或三元运算符

```
( a ) ? b  : c; 
```

if`a`为 true`b`将被执行或运行

if`a`为 false`c`将被执行或运行

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-17T21:42:48.410

这是三元运算符。它在集合中很好，并且是迭代的捷径

[java 三元运算符](https://stackoverflow.com/questions/3181217/java-ternary-operator)

这是一个简单的例子：

```
boolean isObese = true;

 String mood = (isObese == true)?"I need to quit fast-food!":"I'm healthy!"; 
```

[..来源](http://java.about.com/b/2009/06/06/java-term-of-the-week-ternary-operator.htm)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-17T21:43:18.943

它被称为三元运算符，它可以分配给一个变量，它相当于一个 if-then-else 语句。

查看[本教程](http://alvinalexander.com/java/edu/pj/pj010018)并注意其他答案没有充分强调的内容：三元运算符*是一个可以分配给变量或可以直接由方法返回的表达式*。它有一种功能性的感觉。**

# mysql - MySQL (Wordpress) - 更新时的内连接

> ID：13435040
> 
> 赞同：2
> 
> 时间：2012-11-17T21:40:36.483
> 
> 标签：mysql, sql, wordpress

我正在尝试将可以找到重复 post_title 的任何“新”记录的字段发布状态更新为“草稿”。以下选择查询按预期工作并显示我要更新的记录 -

```
select a.* FROM wp_posts AS a INNER JOIN (SELECT Greater1.post_title, Titles.ID, 
Greater1.MinID FROM (SELECT post_title, MIN(ID) AS 'MinID', MAX(ID) AS 'MaxID' FROM 
wp_posts WHERE post_type = 'post' AND post_status = 'publish' GROUP BY post_title 
HAVING COUNT(post_title)>1) AS Greater1 LEFT JOIN (SELECT post_title, ID FROM 
wp_posts) AS Titles ON Greater1.post_title = Titles.post_title WHERE ID > MinID) AS 
b ON a.ID = b.ID WHERE a.ID = b.ID 
```

但是下面的更新查询给出了语法错误。有什么帮助吗？

```
update a.wp_posts set a.post_status='draft' FROM wp_posts AS a INNER JOIN (SELECT 
Greater1.post_title, Titles.ID, Greater1.MinID FROM (SELECT post_title, MIN(ID) AS 
'MinID', MAX(ID) AS 'MaxID' FROM wp_posts WHERE post_type = 'post' AND post_status = 
'publish' GROUP BY post_title HAVING COUNT(post_title)>1) AS Greater1 LEFT JOIN 
(SELECT post_title, ID FROM wp_posts) AS Titles ON Greater1.post_title = 
Titles.post_title WHERE ID > MinID) AS b ON a.ID = b.ID WHERE a.ID = b.ID 
```

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T21:47:25.750

试试下面：

```
UPDATE wp_posts AS a,
 (SELECT Greater1.post_title,
  Titles.ID, Greater1.MinID 
  FROM 
    (SELECT post_title, 
            MIN(ID) AS 'MinID', 
            MAX(ID) AS 'MaxID' 
      FROM wp_posts 
      WHERE post_type = 'post' AND post_status = 'publish' 
      GROUP BY post_title HAVING COUNT(post_title)>1) AS Greater1 
      LEFT JOIN (
            SELECT post_title, ID 
            FROM wp_posts) AS Titles 
       ON Greater1.post_title = Titles.post_title 
       WHERE ID > MinID) AS b
  SET a.post_status='draft'
  WHERE a.ID = b.ID; 
```

句法：

```
UPDATE TABLE1, TABLE2..
SET COLUMN1 = ..., COLUMN2 = ...
WHERE TABALE1.FOREIGN_KEY_ID= TABLE2.ID  //<--joining condition
AND TABLE1.COLUMN1=... //<--filter condition 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T21:42:54.807

您使用的语法是 for `MSSQL`，这是 for`MySQL`

```
UPDATE wp_posts AS a
        INNER JOIN 
        (
            SELECT Greater1.post_title,
                    Titles.ID,
                    Greater1.MinID
            FROM 
            (
                    SELECT post_title,
                            MIN(ID) AS 'MinID',
                            MAX(ID) AS 'MaxID'
                    FROM wp_posts
                    WHERE post_type = 'post'
                            AND post_status = 'publish'
                    GROUP BY post_title
                    HAVING COUNT(post_title) > 1
            ) AS Greater1
                LEFT JOIN 
                (
                    SELECT post_title,
                            ID
                    FROM wp_posts
                ) AS Titles
                    ON Greater1.post_title = Titles.post_title
            WHERE ID > MinID
        ) AS b ON a.ID = b.ID
SET a.post_status = 'draft'
WHERE a.ID = b.ID 
```

*   [使用 JOIN 语法更新](http://blog.ookamikun.com/2008/03/mysql-update-with-join.html)

# c++ - Ref 计数智能指针的赋值运算符

> ID：13435042
> 
> 赞同：2
> 
> 时间：2012-11-17T21:40:39.917
> 
> 标签：c++, shared-ptr, smart-pointers

尽管存在大量智能指针问题，但我似乎又遇到了一个问题。我正在尝试实现一个引用计数的智能指针，但是当我在以下情况下尝试它时，引用计数是错误的。这些评论是我认为应该是正确的参考计数。

```
Sptr<B> bp1(new B);       // obj1: ref count = 1
Sptr<B> bp2 = bp1;        // obj1: ref count = 2
bp2 = new B;              // obj1: ref count = 1, obj2: rec count = 1 **problem** 
```

在我的实现中，我的 obj2 引用计数为 2，因为这段代码：

```
protected:
    void retain() { 
        ++(*_rc);
        std::cout << "retained, rc: " << *_rc << std::endl;
    }
    void release() {
        --(*_rc);
        std::cout << "released, rc: " << *_rc << std::endl;
        if (*_rc == 0) {
            std::cout << "rc = 0, deleting obj" << std::endl;
            delete _ptr;
            _ptr = 0;
            delete _rc;
            _rc = 0;
        }
    }

private:
    T *_ptr;
    int *_rc;

    // Delegate private copy constructor
    template <typename U>
    Sptr(const Sptr<U> *p) : _ptr(p->get()), _rc(p->rc()) {
        if (p->get() != 0) retain();
    }

    // Delegate private assignment operator
    template <typename U>
    Sptr<T> &operator=(const Sptr<U> *p) {
        if (_ptr != 0) release();
        _ptr = p->get();
        _rc = p->rc();
        if (_ptr != 0) retain();
        return *this;
    }

public:
    Sptr() : _ptr(0) {}
    template <typename U>
    Sptr(U *p) : _ptr(p) { _rc = new int(1); }

    // Normal and template copy constructors both delegate to private
    Sptr(const Sptr &o) : Sptr(&o) {
        std::cout << "non-templated copy ctor" << std::endl;
    }
    template <typename U>
    Sptr(const Sptr<U> &o) : Sptr(&o) {
        std::cout << "templated copy ctor" << std::endl;
    }

    // Normal and template assignment operator
    Sptr &operator=(const Sptr &o) {
        std::cout << "non-templated assignment operator" << std::endl;
        return operator=(&o);
    }
    template <typename U>
    Sptr<T> &operator=(const Sptr<U> &o) {
        std::cout << "templated assignment operator" << std::endl;          
        return operator=(&o);
    }
    // Assignment operator for assigning to void or 0
    void operator=(int) {
        if (_ptr != 0) release();
        _ptr = 0;
        _rc = 0;
    } 
```

构造函数使用 ref count = 1 进行初始化，但在我的赋值运算符中，我保留了对象，使 ref count = 2。但在这种情况下它应该只是 1，因为 bp2 = new B 只是一个指向那个物体。我查看了各种智能指针实现示例，但我似乎无法弄清楚它们如何处理我遇到的这种情况。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T21:54:38.667

无论如何，赋值运算符充满了小错误和不必要的复杂性。例如，当您分配`Sptr<T>`给它自己时，它会产生有趣的效果。大多数手动编写的赋值运算符应如下所示：

```
T& T::operator= (T const& other) {
    T(other).swap(*this);
    return *this;
} 
```

... 或者

```
T& T::operator= (T other) {
    other.swap(*this);
    return *this;
} 
```

一旦有状态的分配器进入游戏，事情就会发生一些变化，但我们可以在这里忽略这个细节。主要思想是利用为复制构造函数和析构函数所做的现有工作。请注意，如果右侧不是 ，则此方法也有效`T`，即您仍然可以利用相应的构造函数、析构函数和`swap()`。无论如何，唯一潜在的额外工作是可取的，并且实现起来微不足道：`swap()`成员。在您的情况下，这也很简单：

```
template <typename T>
void Sptr<T>::swap(Sptr<T>& other) {
    std::swap(this->_ptr, other._ptr);
    std::swap(this->_rc,  other._rc);
} 
```

只需注意您的赋值运算符采用`int`: 这是一个非常糟糕的主意！要重置指针，您最好有一个`reset()`方法。不过，在 C++ 2011 中，您可以合理地使用一种方法来`std::nullptr_t`实现此目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T21:47:40.260

为原始指针类型定义赋值运算符。否则，它将构造一个引用计数为 1 的新智能指针，然后将其增加到 2。

例子：

```
template <typename U>
Sptr<T> &operator=(U *p) 
{
    if (_ptr != 0)
    {
      _ptr = p;
      _rc = new int(1);
    }
    return *this;
} 
```

这东西是出了名的棘手，而且可能还有更多的错误在等待。我会让构造函数显式以防止其他无意的构造。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T22:10:54.973

根据我对您的代码的了解，您需要在智能指针类中使用适当的析构函数来调用`release`和修复计数器。您至少需要进行修改才能使计数器正常工作。

我没有`Sptr(T *)`在您的代码中看到构造函数，您是否忽略了它？

作为旁注，我可能会使用 a`std::pair`来存储计数器和`T`指针，但您的数据布局可以正常工作。正如另一个答案指出的那样，您应该注意自我分配案例。

这是遵循您的数据布局和接口选择的最小实现：

```
#include <iostream>
#include <string>

using namespace std;

template <typename T>
class Sptr {

protected:
  T *_ptr;
  int *_rc;

  virtual void retain() {
    if (_rc)   // pointing to something
      ++(*_rc);
    clog << "retain : " << *_rc << endl;
  }
  virtual void release() {
    if (_rc) {
      --(*_rc);
      clog << "release : " << *_rc << endl;
      if (*_rc == 0) {
        delete _ptr;
        _ptr = NULL;
        delete _rc;
        _rc = NULL;
      }
    }
  }

public:
  Sptr() : _ptr(NULL), _rc(NULL) {} // no reference

  virtual ~Sptr() { release(); }  // drop the reference held by this

  Sptr(T *p): _ptr(p) {  // new independent pointer
     _rc = new int(0); 
     retain();
  }

  virtual Sptr<T> &operator=(T *p) {
    release();
    _ptr = p;
    _rc = new int(0);
    retain();
    return *this;
  }

  Sptr(Sptr<T> &o) : _ptr(o._ptr), _rc(o._rc) {
    retain();
  }

  virtual Sptr<T> &operator=(Sptr<T> &o) {
    if (_rc != o._rc){  // different shared pointer
      release();
      _ptr = o._ptr;
      _rc = o._rc;
      retain();
    }
    return *this;
  }
};

int main(){
  int *i = new int(5);

  Sptr<int> sptr1(i);
  Sptr<int> sptr2(i);
  Sptr<int> sptr3;

  sptr1 = sptr1;
  sptr2 = sptr1;
  sptr3 = sptr1;

} 
```

`_rc`是您的类中指针是否与另一个实例共享的指示器。

例如，在这段代码中：

```
 B *b = new B;
 Sptr<B> sptr1(b);
 Sptr<B> sptr2(b); 
```

`sptr1`并且`sptr2`不共享指针，因为分配是单独完成的，因此`_rc`应该不同，这在我的小型实现中实际上就是这种情况。

# c# - itextsharp / MCV 使用字节将多种形式组合成一个 PDF

> ID：13435050
> 
> 赞同：1
> 
> 时间：2012-11-17T21:42:20.270
> 
> 标签：c#, asp.net-mvc, itextsharp

嗨，我的应用是 MVC3 c#，我正在使用 itextsharp 为预定义表单生成 PDF 文件。在这个应用程序中，我必须使用不同的形式。要生成我使用的表单：

```
public ActionResult TestPDF(long learnerID = 211, long courseID = 11)
{
    var caseList = _studyCaseSvc.ListStudyCases().Where(x => x.Course_ID == courseID);
    try
    {
        MemoryStream memoryStream = new MemoryStream();
        PdfConcatenate whole = new PdfConcatenate(memoryStream);
        foreach (var ca in caseList)
        {
            byte[] part = null;
            if (ca.CaseType == "CTA")
            {
                part = GenerateEvaluationCAT_PDF(learnerID, ca.ID);
            }
            else if (ca.CaseType == "CTAH")
            {
                part = GenerateEvaluationCATH_PDF(learnerID, ca.ID);
            }
            else
            {
                part = null;
            }
            if (part != null)
            {
                PdfReader partReader = new PdfReader(part);
                whole.AddPages(partReader);
                partReader.Close();
            }
        }

        whole.Close();
        byte[] byteInfo = memoryStream.ToArray();
        SendPdfToBrowser(byteInfo);
    }
    catch (Exception ex)
    {
    }
    return null;
} 
```

我收到此错误：已添加具有相同密钥的项目。错误发生在 AddPages。所以我开发了这个更简单的测试：

```
private void merge()
    {
        try
        {
            FileStream output = new FileStream("p3.pdf", FileMode.Create);
            PdfConcatenate pdfConcatenate = new PdfConcatenate(output, true);

            PdfReader r1 = new PdfReader("p2.pdf");

            MemoryStream memoryStream = new MemoryStream();
            PdfStamper pdfStamper = new PdfStamper(r1, memoryStream);

            pdfStamper.FormFlattening = true;
            pdfStamper.Close();
            PdfReader r2 = new PdfReader(memoryStream.ToArray());

            //pdfConcatenate.AddPages(tempReader);

            pdfConcatenate.Open();
            int n = r1.NumberOfPages;
            for (int i = 1; i <= n; i++)
            {
                PdfImportedPage imp = pdfConcatenate.Writer.GetImportedPage(r1, i);
                pdfConcatenate.Writer.AddPage(imp);
            }
            pdfConcatenate.Writer.FreeReader(r1);

            pdfStamper.Close();
            r1.Close();
            pdfConcatenate.Close();
        }
        catch (Exception ex)
        {
        }
    } 
```

同样的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T06:12:32.817

好吧，问题在于您可以通过简单地连接多个 PDF 文件将它们合并为一个的误解。这对于 PDF 是错误的（就像大多数二进制文件格式是错误的一样）。

因此，您应该更新 GenerateAllEvaluation_PDF 方法以具有 PdfConcatenate 实例而不是整个字节数组，参见。[http://api.itextpdf.com/itext/com/itextpdf/text/pdf/PdfConcatenate.html](http://api.itextpdf.com/itext/com/itextpdf/text/pdf/PdfConcatenate.html)，在 PdfReader 中打开 GenerateEvaluationCATH_PDF 方法返回的每个字节数组，将这些阅读器的所有页面添加到 PdfConcatenate 并最终返回该类生成的字节。

**编辑**（我更喜欢Java而不是C#，因此请原谅小错误）

```
PdfConcatenate whole = new PdfConcatenate(...);
foreach (var ca in caseList)
{
    byte[] part = null;
    if (ca.CaseType == "CTA")
    {
        part = GenerateEvaluationCAT_PDF(learnerID, ca.ID);
    }
    else if (ca.CaseType == "CTAH")
    {
        part = GenerateEvaluationCATH_PDF(learnerID, ca.ID);
    }
    else
    {
        part = ???;
    }
    PdfReader partReader = new PdfReader(part);
    whole.AddPages(partReader);
    partReader.Close();
} 
```

PdfConcatenate 可以使用 MemoryStream 构建，您可以从中检索最终字节 []。

**PS**：`PdfConcatenate`可能还不是 iTextSharp 4.x 版的一部分，但它只是 PdfCopy 和 PdfSmartCopy 的便捷包装器。因此，您可能只需查看 iTextSharp 的来源（毕竟是 OSS）并受到启发：[PdfConcatenate.cs](http://sourceforge.net/p/itextsharp/code/455/tree/tags/iTextSharp_5_3_3/src/core/iTextSharp/text/pdf/PdfConcatenate.cs)。

# php - PHP中的相对嵌套命名空间

> ID：13435051
> 
> 赞同：0
> 
> 时间：2012-11-17T21:42:21.093
> 
> 标签：php, namespaces

我将尝试描述我遇到问题的情况：

我有一个主文件夹。我将所有文件都保存在那里（出于某种原因，空类）和一个包含相同文件的子文件夹，所有实现都在这里（空类扩展它们）。

主文件夹的命名空间声明为`Project/Folder`，子文件夹声明为`Project/Folder/Subfolder`. 这些是类的声明：

```
namespace Project\Folder;
class Foo extends Subfolder\Foo {  }

namespace Project\Folder\Subfolder;
class Foo {  } 
```

我想要实现的是能够`Project\Folder\Subfolder\Foo`通过较低级别的这些空类从内部调用其他类，只有它的名称，例如：

```
namespace Project\Folder\Subfolder;
class Foo {
     function bar() {
        Another_Class::do_something();
     }
} 
```

默认情况下，会`Another_Class`从`Project\Folder\Subfolder`命名空间调用。我希望它使用相同的语法从 Project\Folder 命名空间中引用 Another_Class - 这可能吗？

我希望我解释得足够清楚，如果没有，请写一个表扬，我会尽量让它更清楚。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T21:45:16.037

您可以使用该`use`语句来实现。

```
use Project\Folder\Subfolder\Another_Class as SomeAlias;

// ...

SomeAlias::doSomething();

// or

$object = new SomeAlias();
$object->doSomething(); 
```

或者，您必须引用整个命名空间：

```
\Project\Folder\Subfolder\Another_Class::doSomething();

// or

$object = new \Project\Folder\Subfolder\Another_Class();
$object->doSomething(); 
```

[更多信息在这里。](http://php.net/manual/en/language.namespaces.importing.php)

# ios - 从 iOS 通知面板激活应用程序时，是否可以处理选定的本地通知？

> ID：13435053
> 
> 赞同：0
> 
> 时间：2012-11-17T21:42:37.383
> 
> 标签：ios, notifications, center, local

从本地通知启动应用程序时，您可以使用 ApplicationDelegate 的 application:didFinishLaunchingWithOptions: 方法来处理通知，但是当您在通知面板中选择通知并且应用程序处于后台时，不会调用此方法。

在这种情况下有没有办法处理通知？

当应用程序因此原因变得活跃时，我想显示一个特殊的视图控制器。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T21:52:17.827

您是否检查了以下委托方法

```
- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification 
```

# python - Python：比较列表并在常用字段中组合

> ID：13435059
> 
> 赞同：1
> 
> 时间：2012-11-17T21:43:01.483
> 
> 标签：python, list

我有以下两个列表：

```
ISO3166_CountryCodes_NO = [["NO","Norge"],["SE","Sverige"],["GR","Hellas"]]
ISO3166_CountryCodes_EN = [["NO","Norway"],["SE","Sweden"],["GR","Greece"]] 
```

如您所见，国家代码始终相同，但国家名称不同（不同的翻译）如何创建这样的列表：

```
ISO3166_CountryCodes = [["NO","Norge","Norway"],["SE","Sverige","Sweden"],["GR","Hellas","Greece"]] 
```

我可以在第一个列表中使用 for 循环来做到这一点，对于每个元素，我可以搜索第二个元素以找到常见的国家代码。然后将翻译附加到一个新列表中，但我觉得这种方式有点笨拙。

有没有更好的方法在 Python 中实现这一点？例如，在我更熟悉的 Perl 中，我会使用哈希表。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T21:58:28.880

在 python 中，字典是一个哈希表。首先，创建两个字典：

```
NO_dict = {x[0]: x[1] for x in ISO3166_CountryCodes_NO}
EN_dict = {x[0]: x[1] for x in ISO3166_CountryCodes_EN} 
```

这给了你：

```
{'GR': 'Hellas', 'NO': 'Norge', 'SE': 'Sverige'}
{'GR': 'Greece', 'NO': 'Norway', 'SE': 'Sweden'} 
```

然后，您可以像这样创建一个列表：

```
final_list = [[k, NO_dict[k], EN_dict[k]] for k in NO_dict] 
```

给你：

```
[['GR', 'Hellas', 'Greece'],
 ['SE', 'Sverige', 'Sweden'],
 ['NO', 'Norge', 'Norway']] 
```

稍后您可能会发现将数据保存在字典中更容易，名称存储在元组中，例如：

```
final_dict = {k:(NO_dict[k], EN_dict[k]) for k in NO_dict} 
```

这样您就可以使用缩写作为键来获取项目，例如`final_dict['NO']`会产生`('Norge', 'Norway')`

**编辑：OrderedDict**

如果您的 python >= 2.7，并且您担心顺序，您仍然可以通过 using 使用字典`OrderedDict`，例如：

```
from collections import OrderedDict

# A list of lists can be used as input for an OrderedDict, so don't need to loop
NO_dict = OrderedDict(ISO3166_CountryCodes_NO)
EN_dict = OrderedDict(ISO3166_CountryCodes_EN)

# Assumes you want the result in the same order as the Norwegian list
# Iterate over the English list if it has a preferred order

final_dict = OrderedDict([(k, (NO_dict[k], EN_dict[k])) for k in NO_dict]) 
```

（有关另一种实现，请参见 AshwiniChaudhary 的回答）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T21:50:00.690

像这样的东西，使用`unique_everseen`来自[itertools 食谱](http://docs.python.org/2/library/itertools.html#recipes)和[`chain()`](http://docs.python.org/2/library/itertools.html#itertools.chain)：

```
In [26]: from itertools import *

In [27]: lis1=[["NO","Norge"],["SE","Sverige"],["GR","Hellas"]]

In [28]: lis2=[["NO","Norway"],["SE","Sweden"],["GR","Greece"]]

In [29]: from itertools import *

In [30]: def unique_everseen(iterable, key=None):
        seen = set()
        seen_add = seen.add
        if key is None:
                for element in ifilterfalse(seen.__contains__, iterable):
                        seen_add(element)
                        yield element
                else:
                        for element in iterable:
                                k = key(element)
                                if k not in seen:
                                        seen_add(k)
                                        yield element
   ....:                         

In [31]: [list(unique_everseen(chain(*x))) for x in izip(lis1,lis2)]
Out[31]: 
[['NO', 'Norge', 'Norway'],
 ['SE', 'Sverige', 'Sweden'],
 ['GR', 'Hellas', 'Greece']] 
```

**或：**您可以[`groupby`](http://docs.python.org/2/library/itertools.html#itertools.groupby)从 itertools 中使用，并结合`operator.itemgetter()`：

```
In [42]: from operator import *

In [43]: [[k]+list(map(itemgetter(1),g)) for x in zip(lis1,lis2) for k,g in groupby(x,itemgetter(0))]
Out[43]: 
[['NO', 'Norge', 'Norway'],
 ['SE', 'Sverige', 'Sweden'],
 ['GR', 'Hellas', 'Greece']] 
```

或 using [`collections.OrderedDict`](http://docs.python.org/2/library/collections.html#collections.OrderedDict)，它是一个子类，`dict`并且也保持顺序：

```
In [47]: from collections import OrderedDict

In [48]: dic=OrderedDict()

In [49]: for x in lis1:
   ....:     dic.setdefault(x[0],[]).append(x[1])
   ....:     

In [50]: for x in lis2:
    dic.setdefault(x[0],[]).append(x[1])
   ....:     

In [51]: dic
Out[51]: OrderedDict([('NO', ['Norge', 'Norway']), ('SE', ['Sverige', 'Sweden']), ('GR', ['Hellas', 'Greece'])])

In [52]: [[x]+y for x,y in dic.items()]
Out[52]: 
[['NO', 'Norge', 'Norway'],
 ['SE', 'Sverige', 'Sweden'],
 ['GR', 'Hellas', 'Greece']]

#or directly access the names using the short-name
In [53]: dic['NO']
Out[53]: ['Norge', 'Norway']

In [54]: dic['GR']
Out[54]: ['Hellas', 'Greece'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T21:53:42.897

您可以使用列表理解：

```
>>> [[s]+
     [n for (c,n) in ISO3166_CountryCodes_NO if c==s]+
     [n for (c,n) in ISO3166_CountryCodes_EN if c==s]
     for s in set([c for (c,n) in ISO3166_CountryCodes_NO] + 
                  [c for (c,n) in ISO3166_CountryCodes_EN])]

[['GR', 'Hellas', 'Greece'], ['SE', 'Sverige', 'Sweden'], ['NO', 'Norge', 'Norway']] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-18T15:39:55.387

使用 Python 3.2。

第一种方式：

```
[[i[0],i[1],v[1]] for i in list1 for v in list2  if i[0]==v[0]] 
```

第二种方式：

```
res=[]
for i,v in list(zip(list1,list2):
    tem=[i[0]]
    if i[0]==v[0]: tem.extend([i[1],v[1]])
res.append(tem) 
```

# jakarta-ee - 无法使用嵌入式 glassfishv3.1.2 进行测试

> ID：13435061
> 
> 赞同：1
> 
> 时间：2012-11-17T21:43:20.097
> 
> 标签：jakarta-ee, junit, glassfish-3

我正在通过 Antonio Goncalves 的一本书“Beginning JavaEE 6 with Glassfish 3”来学习 JavaEE 6。我遇到了一个问题，我无法在 Glassfish 3+ (glassfish-3.1.2.2) 上部署远程无状态 Java Bean，以下代码段代表一个：

```
...
@Stateless
@LocalBean
public class UserEJB implements UserEJBRemote {
    public User createUser(User anUser) throws IllegalArgumentException,
                                               IllegalStateException,
                                               PersistenceException {
        ...
    }

public List<User> findAll() throws IllegalArgumentException,
                                   PersistenceException {
    ...
} 

public User findById(Long anId) throws IllegalArgumentException {
    return em.find(User.class, anId);
} 

public void removeByMail(String aUserMail) throws IllegalArgumentException, 
                                                  TransactionRequiredException {

    ...
}

public User update(User anUser) throws IllegalArgumentException, 
                                           TransactionRequiredException {

    return em.merge(anUser);                    
}

@PersistenceContext(unitName = "NotebookUsers")
    private EntityManager em;
}
... 
```

我的`@Remote`接口声明是：

```
...
@Remote
public interface UserEJBRemote {
    public User createUser(User anUser) throws IllegalArgumentException,
                                               IllegalStateException,
                                               PersistenceException;
public List<User> findAll() throws IllegalArgumentException,
                                   PersistenceException;

public List<User> findByName(String aUserName) throws IllegalArgumentException,
                                                      PersistenceException;

public User findById(Long Id) throws IllegalArgumentException;

public void removeByMail(String aUserMail) throws IllegalArgumentException, 
                                                  TransactionRequiredException ;

    public User update(User anUser) throws IllegalArgumentException, 
                                           IransactionRequiredException ;
}
... 
```

我也有一个简单的 JUnit 测试，但失败了：

```
public class TestUserEJB {
    @BeforeClass
    public static void initialize() throws Exception {
        Map<String,Object> properties = new HashMap<String,Object>();
        properties.put(EJBContainer.MODULES, new File("target/classes"));
        properties.put("org.glassfish.ejb.embedded.glassfish.installation.root",
                       "/home/ilya/glassfishv3.1.2/"); 
        ec = EJBContainer.createEJBContainer(properties); 
        ctx = ec.getContext();
    }

    @AfterClass
    public static void close() throws Exception {
        if(null != ec) {
            ec.close();
        }
    }

    @Test 
    public void testCreateAnUser() throws Exception {
        User testUser0 = new User();
        testUser0.setFirstname("Vova");
        testUser0.setSurname("Puchkov");
        testUser0.setMail("vasya.puchkov@gmail.com");
        testUser0.setPhoneNumber("8(777)6769990");

        UserEJB userEJB = (UserEJB) ctx.lookup("java:global/classes/UserEJB!" + 
            "beginning.javaee.notebook.UserEJB");           

        userEJB.createUser(testUser0);
        assertNotNull("ID should not be null", testUser0.getId());

        List<User> allUsers = userEJB.findAll();
        assertNotNull("Can't find users", allUsers);        
    }

    private static EJBContainer ec;
    private static Context ctx;
} 
```

我创建的所有必要的 jdbc-data-source 和 jdbc-connection-pool `glassfish-resources.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE resources PUBLIC "-//GlassFish.org//DTD GlassFish Application Server 3.1 Resource Definitions//EN" "http://glassfish.org/dtds/glassfish-resources_1_5.dtd">
<resources>
<jdbc-connection-pool name="jdbc_notebookusers_pool" res-type="javax.sql.DataSource"
datasource-classname="org.postgresql.ds.PGSimpleDataSource"
pool-resize-quantity="1" max-pool-size="5" steady-pool-size="0"
statement-timeout-in-seconds="60" >
   <property name="serverName" value="localhost" />
   <property name="portNumber" value="5432" />
   <property name="dataBaseName" value="javaee-db" />
   <property name="User" value="postgres" />
   <property name="Password" value="12345678" />
   <property name="connectionAttributes" value=";create=true" />
 </jdbc-connection-pool>

 <jdbc-resource jndi-name="jdbc_notebookusers_ds" pool-name="jdbc_notebookusers_pool" />
</resources> 
```

并使用以下命令：

```
 asadmin add-resources glassfish-resources.xml 
```

当我使用命令构建应用程序时，`mvn -X package`我收到以下大部分错误：

```
Nov 18, 2012 12:22:34 AM org.glassfish.api.ActionReport failure
SEVERE: Exception while invoking class org.glassfish.persistence.jpa.JPADeployer prepare method
java.lang.RuntimeException: javax.naming.NamingException: Lookup failed for 'jdbc_notebookusers_ds' in SerialContext  [Root exception is javax.naming.NameNotFoundException: jdbc_notebookusers_ds not found]
    at org.glassfish.persistence.jpa.PersistenceUnitInfoImpl.<init>(PersistenceUnitInfoImpl.java:111)
    at org.glassfish.persistence.jpa.PersistenceUnitLoader.loadPU(PersistenceUnitLoader.java:130)
    at org.glassfish.persistence.jpa.PersistenceUnitLoader.<init>(PersistenceUnitLoader.java:96)
    at org.glassfish.persistence.jpa.JPADeployer.prepare(JPADeployer.java:121)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.prepareModule(ApplicationLifecycle.java:644)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:296)
    at org.glassfish.kernel.embedded.EmbeddedDeployerImpl.deploy(EmbeddedDeployerImpl.java:214)
    at org.glassfish.kernel.embedded.EmbeddedDeployerImpl.deploy(EmbeddedDeployerImpl.java:144)
    at org.glassfish.ejb.embedded.EJBContainerImpl.deploy(EJBContainerImpl.java:128)
    at org.glassfish.ejb.embedded.EJBContainerProviderImpl.createEJBContainer(EJBContainerProviderImpl.java:120)
    at javax.ejb.embeddable.EJBContainer.createEJBContainer(EJBContainer.java:102)
    at beginning.javaee.notebook.TestUserEJB.initialize(TestUserEJB.java:26)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
    at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:175)
    at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:107)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:68)
Caused by: javax.naming.NamingException: Lookup failed for 'jdbc_notebookusers_ds' in SerialContext  [Root exception is javax.naming.NameNotFoundException: jdbc_notebookusers_ds not found]
    at com.sun.enterprise.naming.impl.SerialContext.lookup(SerialContext.java:442)
    at javax.naming.InitialContext.lookup(InitialContext.java:392)
    at javax.naming.InitialContext.lookup(InitialContext.java:392)
    at com.sun.enterprise.connectors.service.ConnectorResourceAdminServiceImpl.lookup(ConnectorResourceAdminServiceImpl.java:203)
    at com.sun.enterprise.connectors.ConnectorRuntime.lookupPMResource(ConnectorRuntime.java:429)
    at org.glassfish.persistence.jpa.JPADeployer$ProviderContainerContractInfoImpl.lookupDataSource(JPADeployer.java:228)
    at org.glassfish.persistence.jpa.PersistenceUnitInfoImpl.<init>(PersistenceUnitInfoImpl.java:108)
    ... 33 more
Caused by: javax.naming.NameNotFoundException: jdbc_notebookusers_ds not found
    at com.sun.enterprise.naming.impl.TransientContext.doLookup(TransientContext.java:197)
    at com.sun.enterprise.naming.impl.TransientContext.lookup(TransientContext.java:168)
    at com.sun.enterprise.naming.impl.SerialContextProviderImpl.lookup(SerialContextProviderImpl.java:58)
    at com.sun.enterprise.naming.impl.LocalSerialContextProviderImpl.lookup(LocalSerialContextProviderImpl.java:101)
    at com.sun.enterprise.naming.impl.SerialContext.lookup(SerialContext.java:430)
    ... 39 more
Nov 18, 2012 12:22:34 AM org.glassfish.api.ActionReport failure
SEVERE: Exception while preparing the app
java.lang.RuntimeException: javax.naming.NamingException: Lookup failed for 'jdbc_notebookusers_ds' in SerialContext  [Root exception is javax.naming.NameNotFoundException: jdbc_notebookusers_ds not found]
    at org.glassfish.persistence.jpa.PersistenceUnitInfoImpl.<init>(PersistenceUnitInfoImpl.java:111)
    at org.glassfish.persistence.jpa.PersistenceUnitLoader.loadPU(PersistenceUnitLoader.java:130)
    at org.glassfish.persistence.jpa.PersistenceUnitLoader.<init>(PersistenceUnitLoader.java:96)
    at org.glassfish.persistence.jpa.JPADeployer.prepare(JPADeployer.java:121)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.prepareModule(ApplicationLifecycle.java:644)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:296)
    at org.glassfish.kernel.embedded.EmbeddedDeployerImpl.deploy(EmbeddedDeployerImpl.java:214)
    at org.glassfish.kernel.embedded.EmbeddedDeployerImpl.deploy(EmbeddedDeployerImpl.java:144)
    at org.glassfish.ejb.embedded.EJBContainerImpl.deploy(EJBContainerImpl.java:128)
    at org.glassfish.ejb.embedded.EJBContainerProviderImpl.createEJBContainer(EJBContainerProviderImpl.java:120)
    at javax.ejb.embeddable.EJBContainer.createEJBContainer(EJBContainer.java:102)
    at beginning.javaee.notebook.TestUserEJB.initialize(TestUserEJB.java:26)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
    at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:175)
    at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:107)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:68)
Caused by: javax.naming.NamingException: Lookup failed for 'jdbc_notebookusers_ds' in SerialContext  [Root exception is javax.naming.NameNotFoundException: jdbc_notebookusers_ds not found]
    at com.sun.enterprise.naming.impl.SerialContext.lookup(SerialContext.java:442)
    at javax.naming.InitialContext.lookup(InitialContext.java:392)
    at javax.naming.InitialContext.lookup(InitialContext.java:392)
    at com.sun.enterprise.connectors.service.ConnectorResourceAdminServiceImpl.lookup(ConnectorResourceAdminServiceImpl.java:203)
    at com.sun.enterprise.connectors.ConnectorRuntime.lookupPMResource(ConnectorRuntime.java:429)
    at org.glassfish.persistence.jpa.JPADeployer$ProviderContainerContractInfoImpl.lookupDataSource(JPADeployer.java:228)
    at org.glassfish.persistence.jpa.PersistenceUnitInfoImpl.<init>(PersistenceUnitInfoImpl.java:108)
    ... 33 more
Caused by: javax.naming.NameNotFoundException: jdbc_notebookusers_ds not found
    at com.sun.enterprise.naming.impl.TransientContext.doLookup(TransientContext.java:197)
    at com.sun.enterprise.naming.impl.TransientContext.lookup(TransientContext.java:168)
    at com.sun.enterprise.naming.impl.SerialContextProviderImpl.lookup(SerialContextProviderImpl.java:58)
    at com.sun.enterprise.naming.impl.LocalSerialContextProviderImpl.lookup(LocalSerialContextProviderImpl.java:101)
    at com.sun.enterprise.naming.impl.SerialContext.lookup(SerialContext.java:430)
    ... 39 more
Nov 18, 2012 12:22:34 AM org.glassfish.ejb.embedded.EJBContainerProviderImpl createEJBContainer
INFO: [EJBContainerProviderImpl] Cleaning up on failure ...
Nov 18, 2012 12:22:34 AM org.glassfish.admin.mbeanserver.JMXStartupService shutdown
INFO: JMXStartupService and JMXConnectors have been shut down.
Nov 18, 2012 12:22:34 AM com.sun.enterprise.v3.server.AppServerStartup stop
INFO: Shutdown procedure finished
Nov 18, 2012 12:22:34 AM AppServerStartup run
INFO: [Thread[GlassFish Kernel Main Thread,5,main]] exiting
Nov 18, 2012 12:22:34 AM org.glassfish.ejb.embedded.EJBContainerProviderImpl createEJBContainer
SEVERE: ejb.embedded.exception_instantiating
javax.ejb.EJBException: Failed to deploy EJB modules - see log for details
    at org.glassfish.ejb.embedded.EJBContainerImpl.deploy(EJBContainerImpl.java:135)
    at org.glassfish.ejb.embedded.EJBContainerProviderImpl.createEJBContainer(EJBContainerProviderImpl.java:120)
    at javax.ejb.embeddable.EJBContainer.createEJBContainer(EJBContainer.java:102)
    at beginning.javaee.notebook.TestUserEJB.initialize(TestUserEJB.java:26)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:27)
    at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
    at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
    at org.apache.maven.surefire.junit4.JUnit4TestSet.execute(JUnit4TestSet.java:53)
    at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:123)
    at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:104)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:164)
    at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:110)
    at org.apache.maven.surefire.booter.SurefireStarter.invokeProvider(SurefireStarter.java:175)
    at org.apache.maven.surefire.booter.SurefireStarter.runSuitesInProcessWhenForked(SurefireStarter.java:107)
    at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:68)
Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 7.255 sec <<< FAILURE! 
```

我的`persistence.xml`：

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="1.0" xmlns="http://java.sun.com/xml/ns/persistence" 
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
  xsi:schemaLocation="http://java.sun.com/xml/ns/persistence                                       
                      http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
  <persistence-unit name="javaee-db" transaction-type="JTA">
    <provider>org.hibernate.ejb.HibernatePersistence</provider>
    <jta-data-source>jdbc_notebookusers_ds</jta-data-source>
    <class>beginning.javaee.notebook.User</class>
    <properties>
<!--       <property name="hibernate.connection.username" value="postgres"/>
      <property name="hibernate.connection.driver_class" value="org.postgresql.Driver"/>
      <property name="hibernate.connection.password" value="12345678"/>
      <property name="hibernate.connection.url" value="jdbc:postgresql://localhost:5432/postgres"/> -->
      <property name="hibernate.hbm2ddl.auto" value="create-drop"/>
      <property name="hibernate.show_sql" value="true"/>
    </properties>
  </persistence-unit>
</persistence> 
```

和`pom.xml`

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>beginning.javaee.notebook</groupId>
  <artifactId>simple-ee-notebook</artifactId>
  <version>0.0.1</version>
  <packaging>jar</packaging>

  <name>simple-ee-notebook</name>
  <url>http://maven.apache.org</url>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
  </properties>

  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.10</version>
      <scope>test</scope>
      <type>jar</type>
    </dependency>

    <dependency>
      <groupId>org.hibernate.javax.persistence</groupId>
      <artifactId>hibernate-jpa-2.0-api</artifactId>
      <version>1.0.1.Final</version>
    </dependency>

    <dependency>
      <groupId>org.hibernate</groupId>
      <artifactId>hibernate-entitymanager</artifactId>
      <version>3.6.10.Final</version>
      <scope>test</scope>
    </dependency>

    <dependency>
      <groupId>org.slf4j</groupId>
      <artifactId>slf4j-api</artifactId>
      <version>1.6.1</version>
    </dependency>

    <dependency>
      <groupId>org.slf4j</groupId>
      <artifactId>slf4j-log4j12</artifactId>
      <version>1.6.1</version>
    </dependency>            

    <dependency>
      <groupId>org.glassfish</groupId>
      <artifactId>javax.ejb</artifactId>
      <version>3.0.1</version>
    </dependency>

    <dependency>
      <groupId>org.glassfish.extras</groupId>
      <artifactId>glassfish-embedded-all</artifactId>
      <version>3.0.1</version>
      <scope>test</scope>
    </dependency>
  </dependencies>

  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-jar-plugin</artifactId>
        <version>2.2</version>
        <configuration>
          <archive>
            <manifest>
              <mainClass>beginning.javaee.notebook.App</mainClass>
            </manifest>
          </archive>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <inherited>true</inherited>
        <configuration>
          <source>1.6</source>
          <target>1.6</target>
        </configuration>
      </plugin>
    </plugins>
  </build>
</project> 
```

# python - Python for 循环列表理解

> ID：13435064
> 
> 赞同：5
> 
> 时间：2012-11-17T21:43:27.897
> 
> 标签：python, for-loop, list-comprehension

我是 Python 的初学者，正在自学列表理解。我一直在处理几乎所有我一直在翻译为列表理解的 for 循环代码，但我非常坚持我认为是一个相当简单的循环。

```
n = 10000

def sim(y):
  count = 0
  for i in range(10000):
    if 0.9 <= y[i] <= 1.8:
        count += 1
  probability = count/10000.0
  print("P(a < x <= b) : {0:8.4f}".format(probability))

print ("\t case: \n"),sim([0.25 if random() < 0.8 else 1.5 for r in range(n)]) 
```

到目前为止，我一直在尝试以下变体，但都遇到了与使用列表相关的错误，例如“'int' object is unsubscriptable”和“unsupported operand type(s) for +: 'int' and 'list' ”。

```
def sim(y):
  c4 = sum([y for range(y) in range(len(y)) if 0.9 < y[i] <= 1.8])/10000
  print("P(a < x <= b) : {0:8.4f}".format(c4)) 
```

目的是基本上采用传递给 sim() 的参数并迭代它的长度，同时仅对那些在 0.9 和 1.8 之间的条件下发现为真的值递增 1。我正在尝试检查 n 个随机数中的每一个是否符合该条件。然后只对那些正确的相加。

顺便说一句，答案应该在 0.2 左右——如果你想检查它，只需考虑 1.5 是适合 0.9 和 1.8 之间的唯一方法。

感谢您在我学习过程中的耐心等待。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T21:46:58.307

您仍然需要为每个循环提供一个表达式，并且您的`for y in`部分相当失控。以下作品：

```
c4 = sum(1 for i in y if 0.9 < i <= 1.8) / 10000.0 
```

这相当于：

```
count = 0
for i in y:
    if 0.9 < i <= 1.8:
        count += 1
c4 = count / 10000.0 
```

也许`10000.0`应该是`float(len(y))`，但从你的例子中并不完全清楚。

我们使用`1000.0`或`float(len(y))`避免使用整数除法，这将导致`0`作为答案。或者，您可以使用`from __future__ import division`使`/`除法运算符默认使用浮点除法，请参阅[PEP 238](http://www.python.org/dev/peps/pep-0238/)。

请注意，我为您制作了生成器表达式，无需先存储列表。

# java - 请帮助我使用自引用指针

> ID：13435074
> 
> 赞同：2
> 
> 时间：2012-11-17T21:44:41.457
> 
> 标签：java, pointers, parameters, parameter-passing, bluej

我写了两个类，第一个是会员，第二个是商店。我编写了一个可以从成员类创建对象的方法，我试图在成员类中编写一个 Store 类型的字段存储，我希望它存储对成员输入的存储的引用。有些人告诉我这样做： memberRegister() 需要作为参数传递，指向您当前所在的 Store 对象的指针。

实际上，Store 对象需要能够告诉 Member 对象“指向我”。也就是说，Store 对象需要一个指向自身的指针。但我没明白

这是会员类

```
private int pinNumber;
private String name, id; 
private Store store;

/**
 * Constructor for objects of class Member
 */
public Member(String name, String id, int pinNumber, Store store)

{
    // initialise instance variables
    this.name = name;
    this.id = id;
    this.pinNumber = pinNumber;
    checkId();
    checkPinNumber();
}

/**
 * An example of a method - replace this comment with your own
 * 
 * @param  y   a sample parameter for a method
 * @return     the sum of x and y 
 */
private void checkId()
{
    // put your code here
    int length; 
     length = id.length();
    if (length > 10 ){
        System.out.println("lentgh must be at 10 ");
    }
}
private void checkPinNumber()
{
    int length; 
     length = id.length();
    if ((length > 4) && (length < 4 )){
        System.out.println("lentgh must be at 4"); 
} 
```

类商店

```
 private String storeName;
private int total; 
private  Member member;

/**
 * Constructor for objects of class Store
 */
public Store(String storeName, int total)
{
    // initialise instance variables
    this.storeName = storeName;
    this.total = total;
}

/**
 * 
 */
public String getStoreName() 
{
return storeName;
}

/**
 * An example of a method - replace this comment with your own
 * 
 * @param  y   a sample parameter for a method
 * @return     the sum of x and y 
 */
public Member memberRegister(String name, String id, int pinNumber)
{
    // put your code here
   Member member;
   member = new Member(name, id, pinNumber)
   return member;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T21:58:57.947

您的 memberRegister 方法没有正确调用您的 Member 构造函数：

```
public Member memberRegister(String name, String id, int pinNumber)
{
    // put your code here
   Member member;
   member = new Member(name, id, pinNumber, this) //this passes in a reference to your store
   return member;
} 
```

然后在 Member 构造函数中分配引用：

```
public Member(String name, String id, int pinNumber, Store store)

{
    // initialise instance variables
    this.name = name;
    this.id = id;
    this.store = store //where this.store is a Store
    this.pinNumber = pinNumber;
    checkId();
    checkPinNumber();
} 
```

希望有帮助。顺便说一句，以某种方式更新注释，使其与您的代码相匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:00:55.947

使用关键字`this`是获得自引用指针的方法。您应该能够按照@Kerrek SB 的建议并`return new Member(name, id, pinNumber, this)`从`memberRegister`方法内部进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T21:59:38.357

请参阅在您的情况下将`this`关键字传递给方法`memberRegister`是`useless`

`returning` `this`关键字是`useful`。

要了解有关此关键字的更多信息，[请查看此](http://docs.oracle.com/javase/tutorial/java/javaOO/thiskey.html)

# database - 功能依赖

> ID：13435078
> 
> 赞同：0
> 
> 时间：2012-11-17T21:45:01.650
> 
> 标签：database, functional-dependencies

```
 if  x->a  and y-> b 
        then 
        from  x->a  ==   xy-->ay   [ir2]   xy-->a [ir4]
        from  y->b  ==   xy-->xb   [ir2]   xy-->b [ir4] 
        therefore xy-->ab  [ir5] 
```

![在此处输入图像描述](../Images/054c4fa619ad54b70a4775518ba87acc.png) 但是 elmasri navathe 说，x-->a 和 y-->b 并不意味着 xy-->ab 我只是从功能依赖开始，所以有人能指出我缺少什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:42:56.220

虽然我对函数依赖的了解并不完整，但我看不出你的想法有任何错误。

你能提供一段文本的摘录吗？

我在网上找到了这本书的副本：http: [//cecfoces.files.wordpress.com/2010/09/elmasri-navathe-fundamentals-of-database-systems-3rd-ed1.pdf](http://cecfoces.files.wordpress.com/2010/09/elmasri-navathe-fundamentals-of-database-systems-3rd-ed1.pdf)

您能否指出他们在哪里说 x-->a 和 y-->b 并不意味着 xy-->ab？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T14:34:08.290

我刚刚检查了 CJ DATE ，在第 11 章，第 339 页它列出了一个名为 composition 的规则，如果 a->b ， c->d 然后 ac->bd ，这样可以回答我的部分查询，但很好奇为什么它在 navathe 中另有说明。

# java - '%' 的 Tomcat 中的字符解码异常

> ID：13435081
> 
> 赞同：0
> 
> 时间：2012-11-17T21:45:35.297
> 
> 标签：java, exception, tomcat, encoding

我得到了这个例外

```
Character decoding failed. Parameter [updatedLocalInfo] with value 

org.apache.tomcat.util.buf.UDecoder$DecodeException: isHexDigit 
```

我将请求发布数据作为 JSON 字符串传递，其中一个值包含'%' 因为这个 '%' 我得到了这个异常。

我无法弄清楚为什么会出现这个异常以及如何解决它。

有关信息，我传递的 json 是

```
[{"taxInformation":"Applicable Taxes Extra","happyHourDesc":"40%  off","happyHourTime":"4 to 8 PM","offer":"No Offers"}] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T21:51:51.493

> 我将请求发布数据作为 JSON 字符串传递

我的猜测是你在没有正确编码的情况下传递 JSON 字符串。当您通过 HTTP GET 或 POST 从客户端向服务器发送信息时，必须对信息进行正确编码。最常见的方法是通过 URL 编码（即使它是 POST 数据）。

您尚未说明如何发送数据，但听起来您可能需要`encodeURIComponent`在生成从客户端发送到服务器的数据期间的某个阶段使用。

# ios - 用于在 iOS 中启动 Notes 应用程序的 URL 架构

> ID：13435084
> 
> 赞同：0
> 
> 时间：2012-11-17T21:46:03.227
> 
> 标签：ios

是否有用于在 iOS 6 中启动内置 Notes 应用程序的 URL 架构？我看到的工作比这里提供的要多得多：

[https://developer.apple.com/library/archive/featuredarticles/iPhoneURLScheme_Reference/Introduction/Introduction.html](https://developer.apple.com/library/archive/featuredarticles/iPhoneURLScheme_Reference/Introduction/Introduction.html)

具体来说，整个设置应用程序似乎都有每个页面的 URL 架构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T13:12:34.517

可悲的事实是，如果 Apple 不发布一种方法来做到这一点，那么任何黑客攻击都肯定会在未来被打破。过去可以通过黑客打开设置，但有一天它停止工作。

最好的办法是在 bug Reporter.apple.com 上输入错误报告并请求此功能 - 表示除非收到大量此类请求，否则苹果不会这样做。

# ruby-on-rails - PATH 中的其他脚本

> ID：13435091
> 
> 赞同：2
> 
> 时间：2012-11-17T21:46:59.073
> 
> 标签：ruby-on-rails, macos, path, homebrew

我正在尝试使用 Homebrew 在 OS X 10.7.5 上安装 Rails，并继续收到以下警告。我曾多次尝试更改 PATH 以排除 Python 目录（修改 .bash_profile，但我什至不确定这是导致警告的原因。抱歉，如果这是严重的菜鸟领域，但经过数小时后我找不到任何有用的东西正在搜索。自制警告：

```
Warning: "config" scripts exist outside your system or Homebrew directories. 
```

`./configure`脚本经常查找 *-config 脚本以确定是否安装了软件包，以及在编译和链接时要使用哪些附加标志。

如果配置脚本覆盖系统或 Homebrew 提供的同名脚本，则在路径中包含其他脚本可能会混淆通过 Homebrew 安装的软件。我们发现了以下“配置”脚本：

```
/Library/Frameworks/Python.framework/Versions/Current/bin/python-config
/Library/Frameworks/Python.framework/Versions/Current/bin/python2.5-config
/opt/sm/pkg/active/bin/curl-config
/opt/sm/pkg/active/bin/ncurses5-config
/opt/sm/pkg/active/bin/ncursesw5-config
/opt/sm/pkg/active/bin/pkg-config
/opt/sm/pkg/active/bin/xml2-config
/opt/sm/pkg/active/bin/xslt-config 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T21:55:04.037

我认为您应该使用 gem tool 安装 Rails。Rails 只是一个 gem，不应由 homebrew 安装。先安装最新版的Ruby，然后google一下gem管理系统，试一试。这是关于这个主题的一个不错的[Railscast](http://railscasts.com/episodes/310-getting-started-with-rails?view=asciicast)。

# c# - 如何在不旋转局部轴的情况下旋转模型？

> ID：13435093
> 
> 赞同：0
> 
> 时间：2012-11-17T21:47:03.080
> 
> 标签：c#, matrix, xna, rotation

我只需要在模型启动时将其旋转 90 度，而无需编辑其局部轴。我有一枚导弹在隧道中以 90 度横向飞行，我需要它面向隧道下方，同时仍保持其运动方向。我试过了：

```
virtual public void setOrientationWorld(float x, float y, float z)
{
    mOrientation *= Matrix.CreateRotationX(MathHelper.ToRadians(x));
    mOrientation *= Matrix.CreateRotationY(MathHelper.ToRadians(y));
    mOrientation *= Matrix.CreateRotationZ(MathHelper.ToRadians(z));
} 
```

setOrientationWorld(0, -90, 0);

我试过了：

```
virtual public void setOrientationLocal(float x, float y, float z)
{                                                                  
    mOrientation *= Matrix.CreateFromAxisAngle(mOrientation.Right, MathHelper.ToRadians(x));
    mOrientation *= Matrix.CreateFromAxisAngle(mOrientation.Up, MathHelper.ToRadians(y));
    mOrientation *= Matrix.CreateFromAxisAngle(mOrientation.Forward, MathHelper.ToRadians(z));
} 
```

setOrientationLocal(0, -90, 0);

但他们都毁了一切。当我这样做时，导弹会旋转，所有轴都会改变。即使只是去 setPosition(0,0,-1) 使它沿着世界 X 轴而不是 Z 轴移动。

我曾尝试在本地和全球范围内移动导弹，但无济于事，如下所示：

```
virtual public void moveLocal(float x, float y, float z)
{
    mPosition += mOrientation.Right * x;
    mPosition += mOrientation.Up * y;
    mPosition += mOrientation.Forward * z;
} 
```

和

```
virtual public void moveWorld(float x, float y, float z)
{
    mPosition.X += x;
    mPosition.Y += y;
    mPosition.Z += z;
} 
```

我能想到的唯一其他相关的事情是绘图功能，这可能与它有关：

```
 foreach (BasicEffect effect in mesh.Effects)
        {
            effect.EnableDefaultLighting();
            effect.World = Matrix.Identity *
                Matrix.CreateScale(mScale) *
                transforms[mesh.ParentBone.Index] *
                Matrix.CreateTranslation(mPosition) *
                mOrientation;
            effect.View = game1.getView();
            effect.Projection = game1.getProjection();
        } 
```

请哈普！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:36:34.930

应用平移和旋转的顺序很重要。如果您在全局范围内应用旋转，那么当您将对象从其旋转中心移开时，首先平移会导致问题。在这种情况下，您需要旋转*然后*平移。

在导弹的局部空间中应用旋转时，应用旋转的顺序也很重要。以“Roll”、“Pitch”、“Yaw”的顺序应用它们将产生与所有六种组合以“Pitch”、“Yaw”、“Roll”等顺序应用它们不同的结果。顺序取决于您要达到的目标，因此您可能必须创建一个可以完成所有六项的方法，并根据参数选择哪一个。

# jquery - 弹出窗口不适用于 Jquery/Ajax

> ID：13435094
> 
> 赞同：1
> 
> 时间：2012-11-17T21:47:08.273
> 
> 标签：jquery, html, ajax, django

我对 Ajax 完全陌生，但试图获得一个用于 django 工作的反馈模块，这是一个可供用户提交反馈的选项卡。

这是模板：

```
<div id="feedback_button" class="white left normal"><a href="/feedback/">feedback</a></div>
<div class="hiding">
<div id="feedback_popup" class="colorbox" style="width: 500px">
    <h1>Feedback</h1>
    {% if not feedback_text %}
        <p style="margin-bottom: 0">We would be happy to consider any feedback you have.</p>
    {% else %}
        {{feedback_text}}
    {% endif %}
    <form class="feedback" action="{% url feedback.views.handle_ajax %}" method="POST" style="margin: 0">{% csrf_token %}
        <div style="display: none"><input name="body" value="..."/></div>
        <label for="email">email (optional)</label>
            <input name="email" value="{{user.email}}"/>
             <div class="email error"> </div>
        <label for="subject">subject (optional)</label>
            <input name="subject"/>
             <div class="subject error"> </div>
        <label for="text">message</label>
            <textarea name="text"></textarea>
            <div class="text error"> </div>
        <div class="buttons">
            <button>Send</button>
        </div>
    </form>
    <div class="thanks hiding">Thank you for your feedback!</div>
    <div class="general error hiding"></div>
</div>
</div>
<script>
    $(function(){
        feedback.init({
            'button':$('#feedback_button'),
            'drop':$('#feedback_drop'),
            'popup':$('#feedback_popup')
        });
        if (document.cookie == "") {
            // CSRF protection requires a cookie to be set already.
            $('#feedback_button').hide();
        }
    });
</script> 
```

我看到了反馈按钮，但是当我单击它时，什么也没有发生。因为我是 jquery/ajax 的新手，不太确定从哪里开始调试这个......有什么提示吗？

这是我在`base.html`模板中调用它的地方：

```
<body class="{% block body_class %}{% endblock %}">
    {% include "feedback/button.html" %}
        <div id="wrapper"> 
```

这是相关的jQuery：

```
var feedback = {};
feedback.init = function(config) {
    if (!(config.button && config.drop && config.popup))
        throw "invalid params";
    config.popup.find('form.feedback').ajaxSubmit({
        'onstart':function(){
            config.popup.addClass('loading');
        },
        'onend':function(){
            config.popup.removeClass('loading');
        },
        'onerror':function(why){
            alert('Error! '+why);
        },
        'onsuccess':feedback.done(config)
    });

    config.button.click(function(){
        config.drop.removeClass('hiding');
        config.popup.removeClass('hiding');
        config.popup.find('input[name=email]').focus();
    });
    config.popup.find('.close').click(feedback.closeit(config));
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T15:13:00.673

ajaxSubmit() 将立即提交表单。使用 ajaxForm() 和：提交按钮，或连接按钮单击事件以执行 submit()。或者在按钮单击事件期间执行 ajaxSubmit()。像这样的东西应该可以工作（没有尝试过）......

```
feedback.init = function(config) {
    if (!(config.button && config.drop && config.popup))
        throw "invalid params";
    config.popup.find('form.feedback').ajaxForm({
        'onstart':function(){
            config.popup.addClass('loading');
        },
        'onend':function(){
            config.popup.removeClass('loading');
        },
        'onerror':function(why){
            alert('Error! '+why);
        },
        'onsuccess':feedback.done(config)
    });

    config.button.click(function(){
        config.drop.removeClass('hiding');
        config.popup.removeClass('hiding');
        config.popup.find('input[name=email]').focus();
        config.popup.find('form.feedback').ajaxSubmit();
    });
    config.popup.find('.close').click(feedback.closeit(config));
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T15:07:09.083

*   您的 JS 附件`/static/uni_form/uni-form.jquery.js`未加载 - 返回 403 Forbidden

*   在 main.js 中的`config.popup.find('form.feedback').ajaxSubmit({`ajaxSubmit 行返回一个错误。也许您会将`feedback.init`main.js 或所有 main.js 放在一个`$(document).ready(function(){...});`etc 之间......但是请确保 ajaxSubmit 在该执行点可用。

# wordpress - 如何通过 github 将最新的稳定分支克隆到目录？

> ID：13435095
> 
> 赞同：8
> 
> 时间：2012-11-17T21:44:10.377
> 
> 标签：wordpress, git, github, installation

我想通过 shell 脚本从 Github 克隆最新的稳定版 WordPress。获取不稳定的master分支很简单：

```
git clone git://github.com/WordPress/WordPress.git 
```

但是我怎样才能*通过脚本*获得最高编号的稳定版本，而不是手动检查代码。例如，使用部署 shell 脚本或 Fabric 等部署工具。

编辑：我澄清了文本以更好地表明我的意思是如何从脚本而不是手动执行此操作。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-17T22:12:07.773

从 git 克隆并切换到 WordPress 目录

```
git clone git://github.com/WordPress/WordPress.git 
cd WordPress 
```

然后列出分支..

```
git branch -r 
```

这给出了类似...

```
origin/1.5-branch   
origin/2.0-branch   
...
origin/3.4-branch  
origin/HEAD -> origin/master   
origin/master 
```

查看您想要的分支...

```
git checkout 3.4-branch
Branch 3.4-branch set up to track remote branch 3.4-branch from origin.
Switched to a new branch '3.4-branch' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-03T21:16:47.700

这是我最终做的事情，它包含在[我在 Github 上的 Fabric fabfile 中](https://github.com/dangayle/nginx-wp-mysql-fabfile/blob/master/fabfile.py#L132)：

```
git clone git://github.com/WordPress/WordPress.git .
git checkout $(git describe --tags $(git rev-list --tags --max-count=1)) 
```

它像往常一样克隆 repo，然后执行一些 shell 魔术来找到 WordPress 的最新标记版本（这是稳定分支所在的位置。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T21:59:43.827

你可以试试`git checkout master`吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T22:06:25.747

`git branch -r`将向您显示所有远程分支

`git checkout --track <local_branch> <remote>/<remote_branch>`将设置一个跟踪远程分支的本地分支，以便推送或获取新的更新。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-08T04:28:20.203

你可以在 git clone 之后使用这个命令

```
git checkout stable 
```

# django - 尝试通过模型访问用户时的 self.field.rel.to.DoesNotExist

> ID：13435096
> 
> 赞同：2
> 
> 时间：2012-11-17T21:47:09.200
> 
> 标签：django, django-models

我正在尝试扩展我的模型以包含 User 但运气不佳。

```
from django.db import models
from django.contrib.auth.models import User

class TestModel(models.Model):
    user = models.OneToOneField(User)

    def __unicode__(self):
        return "Value[" + self.user + "];" 
```

但是，当我尝试对此进行测试时，我得到以下信息：

```
>>> t = TestModel()
>>> t
Traceback (most recent call last):
  File "<console>", line 1, in <module>
  File "/Library/Python/2.7/site-packages/django/db/models/base.py", line 373, in __repr__
    u = unicode(self)
  File "/Users/lkatz/tmp/private/Projects/Web/rcos_portal/driver/models.py", line 39, in __unicode__
    return "Value[" + self.user + "];"
  File "/Library/Python/2.7/site-packages/django/db/models/fields/related.py", line 343, in __get__
    raise self.field.rel.to.DoesNotExist
DoesNotExist 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:30:47.840

您没有将 User 实例传递给您的类 TestModel：

做这样的事情：

```
from django.contrib.auth.models import User

us = User.objects.all()[0]
t = TestModel(user=us)
t.save()
print t 
```

# android - 使用 AsyncTask onPostLoad 加载位图

> ID：13435111
> 
> 赞同：-1
> 
> 时间：2012-11-17T21:48:51.563
> 
> 标签：android, button, android-asynctask, progress-bar, visibility

我有一组按钮，我希望它们仅在加载图像时可见..并且要隐藏进度条，我该怎么做..无论何时使用 onPreExecute() 或编写

```
 buttonname.setVisibility(View.VISIBLE); 
```

在执行后它停止加载图像..这是我正在使用的..请帮帮我我被卡住了

```
 public class Main extends Activity{

    ImageView image,next,back;
    Button a;
    static int fullWidth;
    static int fullHeight;
     ProgressBar progressbar;
     Button setWallpaper;

     private class BackgroundTask extends AsyncTask <String, Void, Bitmap> {
            protected Bitmap doInBackground(String...url) {
                //--- download an image ---
               Bitmap bitmap = DownloadImage(url[0]);
                return bitmap;
            }
            protected void onPostExecute(Bitmap bitmap) {

                ImageView image = (ImageView) findViewById(R.id.imageView1);
                bitmaptwo=bitmap;
                image.setImageBitmap(bitmap);
                image.setScaleType(ScaleType.FIT_CENTER);

            }
        }
    private InputStream OpenHttpConnection(String urlString)
    throws IOException
    {InputStream in = null;
    int response= -1;
    URL url = new URL(urlString);
    URLConnection conn = url.openConnection();
   if (!(conn instanceof HttpURLConnection ))
   throw new IOException("Not an HTTP connection");
    try{
        HttpURLConnection httpConn = (HttpURLConnection) conn;
        httpConn.setAllowUserInteraction(false);
        httpConn.setInstanceFollowRedirects(true);
        httpConn.setRequestMethod("GET");
        httpConn.connect();
        response = httpConn.getResponseCode();
        if (response == HttpURLConnection.HTTP_OK){
            in = httpConn.getInputStream();
        }
        }
    catch (Exception ex)
    {
        throw new IOException("Error connecting");
    }
    return in;
    }
    private Bitmap DownloadImage(String URL)
    {
        Bitmap bitmap = null;
        InputStream in = null;
        try {
            in = OpenHttpConnection(URL);
            bitmap = BitmapFactory.decodeStream(in);
            in.close();
        }
        catch (IOException e1){
            Toast.makeText(this,e1.getLocalizedMessage(),
            Toast.LENGTH_LONG).show();

            e1.printStackTrace();
        }
        return bitmap;
    }
    public static Bitmap bitmaptwo;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.activity_main);

        try
        {
        new BackgroundTask().execute("http://meluha.in/wp-content/uploads/1.jpg");
        }
        catch(Exception e)
        {
            e.printStackTrace();
        }

        setWallpaper = (Button) findViewById(R.id.abcd);
        ImageView next = (ImageView) findViewById(R.id.next);
        ImageView back = (ImageView) findViewById(R.id.back);

        setWallpaper.setOnClickListener(new View.OnClickListener() {
            public void onClick(View view) {
                WallpaperManager wManager;

                try {

                //  Bitmap bitmap = ((BitmapDrawable)imageView1.getDrawable()).getBitmap();
                    wManager = WallpaperManager.getInstance(getApplicationContext());
                    fullWidth = wManager.getDesiredMinimumWidth();
                    fullHeight = wManager.getDesiredMinimumHeight(); 
                    Bitmap bitmapResized = Bitmap.createScaledBitmap(bitmaptwo, fullWidth, fullHeight,true);
                    wManager.setBitmap(bitmapResized);

                } catch (IOException e) {
                    e.printStackTrace();
                }
            }

        });
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:09:43.263

将此代码添加到您的`onPostExecute`方法中：

```
button1.setVisibility(View.VISIBLE);
button2.setVisibility(View.VISIBLE);
//....
progressbar.setVisibility(View.INVISIBLE); 
```

# android - 数据库覆盖后光标返回 null

> ID：13435112
> 
> 赞同：0
> 
> 时间：2012-11-17T21:49:11.763
> 
> 标签：android, android-listview, listadapter, android-sqlite, android-cursor

我的应用程序有一个静态数据库，我需要使用新内容进行更新。架构不会改变。我已将数据库放入`assets/`应用程序启动它时，它会将数据库（在`SQLiteOpenHelper`构造函数中）复制到应用程序的`databases/`目录中。复制代码如下：

```
private void importAssets(boolean overWrite) throws IOException
{
    AssetManager am = mCtx.getAssets();
    InputStream in = am.open(DB_NAME);
    FileOutputStream out;
    byte[] buffer = new byte[1024];
    int len;
    File dir, db;

    dir = new File(DB_DIR);
    dir.mkdirs();
    db = new File(dir, DB_NAME);

    // if not first run return
    if (!overWrite && db.exists())
    {
        Log.i(TAG, DB_DIR + "/" + DB_NAME + " exists, do nothing");
        in.close();
        return;
    }

    // copy the DB from assets to standard DB dir created above
    out = new FileOutputStream(db);
    while ((len = in.read(buffer)) > 0)
    {
        out.write(buffer, 0, len);
    }

    out.flush();
    out.close();
    in.close();

    if (!db.exists())
    {
        Log.e(TAG, DB_DIR + "/" + DB_NAME + " does not exist");
    }

} 
```

该变量`overWrite`是指示`importAssets()`是否覆盖现有数据库的标志。`true`仅当在 中匹配适当的条件时才设置为`SQLiteOpenHelper.onUpgrade()`。在这种情况下，`FileOutputStream`截断现有文件并用来自`assets/`.

我这样做的原因是我有很多记录，我不想将它们硬编码到 Java 源代码中。我只想将数据库放在那里供用户访问。用户不能修改数据库，仅供查看。

主要活动是`ListActivity`. 它从数据库中读取数据并使用 a`Cursor`和 a将其显示在列表中`ListArray`。这是`onResume()`按如下方式完成的：

```
protected void onResume()
{
    super.onResume();

    mContent = new PocketbookContent(this);
    mDB = mContent.getReadableDatabase();

    mRows = mDB.query("book_content",
        new String[] { "id", "title" },
        null,
        null,
        null,
        null,
        "id", 
        null);

    String[] chapters = new String[mRows.getCount()];
    mRows.moveToFirst();
    for (int i = 0; i < mRows.getCount(); i++)
    {
        // assume title is in column 1
        chapters[i] = mRows.getString(1);
        mRows.moveToNext();
    }

    // set the adapter & insert data into view
    mAdapter = new ArrayAdapter<String>(this,
        R.layout.toc_row, chapters);
    setListAdapter(mAdapter);
} 
```

`mRows`,`mDB`并且`mContent`都封闭在`onPause()`.

新安装应用程序时，没有问题。一切运行良好。数据库被复制`assets/`到`databases/`目录中，应用程序运行。升级时出现问题。当它将表中的数据加载`Cursor`到.`null``NullPointerException`

通过调试，我已经确认`Cursor`第一行的结果是`null`，而所有其他行都很好。我还确认数据库完好无损，所有数据都在那里。我通过添加代码来`importAssets()`将数据库的另一个副本从`databases/`目录（不是直接从`assets/`）复制到我可以检查它的 SD 卡。我得出的结论是，该`null`行正在传递给`ArrayAdapter`构造函数，然后它崩溃了。这是堆栈跟踪的顶部：

```
D/AndroidRuntime( 6058): Shutting down VM
W/dalvikvm( 6058): threadid=1: thread exiting with uncaught exception (group=0x40015560)
E/AndroidRuntime( 6058): FATAL EXCEPTION: main
E/AndroidRuntime( 6058): java.lang.NullPointerException
E/AndroidRuntime( 6058):        at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:355)
E/AndroidRuntime( 6058):        at android.widget.ArrayAdapter.getView(ArrayAdapter.java:323)
E/AndroidRuntime( 6058):        at android.widget.AbsListView.obtainView(AbsListView.java:1430)
E/AndroidRuntime( 6058):        at android.widget.ListView.makeAndAddView(ListView.java:1745)
E/AndroidRuntime( 6058):        at android.widget.ListView.fillDown(ListView.java:670)
E/AndroidRuntime( 6058):        at android.widget.ListView.fillFromTop(ListView.java:727)
E/AndroidRuntime( 6058):        at android.widget.ListView.layoutChildren(ListView.java:1598)
E/AndroidRuntime( 6058):        at android.widget.AbsListView.onLayout(AbsListView.java:1260)
E/AndroidRuntime( 6058):        at android.view.View.layout(View.java:7175) 
```

为什么我的第一行是`Cursor null`？我认为数据库复制/覆盖没有问题，因为它在全新安装时工作正常，并且在升级时复制的数据库在使用`sqlite3`.

目标 API 级别是`10`.

**编辑**：这里是`toc_row.xml`

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#000000"
    android:padding="3px"
    android:textSize="27dp"
    android:textColor="#ffffff" /> 
```

**编辑**：当我将调试打印放在`while()`循环中时，它显示来自`Cursor`is的数据`null`，但仅针对第一行：

```
V/RenderScript_jni(  195): surfaceDestroyed
I/TableOfContents( 6058): NUMROWS: 5
I/TableOfContents( 6058): 0: null
I/TableOfContents( 6058): 1: Introduction
I/TableOfContents( 6058): 2: The Police and Arrest
I/TableOfContents( 6058): 3: Being Detained
I/TableOfContents( 6058): 4: When You are Arrested
D/AndroidRuntime( 6058): Shutting down VM 
```

注意，`TableOfContents`是主要活动，从`ListActivity`.

**编辑**：`onUpgrade()`方法。它调用set to `importAsssets()`。`overWrite``true`

```
public void onUpgrade(SQLiteDatabase db, int oldVer, int newVer)
{  
    if (ORIG_REL_SCHEMA_VER == oldVer &&
        DB_SCHEMA_VER == newVer)
    {  
        try
        {  
            importAssets(true);
        }
        catch (IOException ioe)
        {  
            Log.e(TAG, "importAssets() exception" + ioe.getMessage());
        }
    }
} 
```

**编辑（发现一个杂物）**：我发现了一种解决方法，可以防止崩溃并允许数据库升级。它实际上并没有解决问题，但至少对用户来说并不难看。我`importAssets()`通过添加`File.delete()`调用进行了修改：

```
if (!overWrite && db.exists())
{
    Log.i(TAG, DB_DIR + "/" + DB_NAME + " exists, do nothing");
    in.close();
    return;
}
else if (overWrite)
{
    db.delete();
} 
```

因为只有当从 this 调用时才为`overWrite`真，只会发生一次。它删除现有数据库并从. 根据我的测试，在对象被销毁之前实际上不会生效，因此事件并没有按照代码的建议实际发生。第一次调用时，会显示旧数据，但在下一次调用时，它将显示新数据。`importAssets()``onUpgrade()``assets/``File.delete()``TableOfContents.onResume()``ArrayAdapter`

无论如何，这是我的难题，因为似乎没有解释为什么在实际上有数据的情况下获得第 1 行`Cursor`的值。`null`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:08:44.780

> 上面输出中显示 null 的行确实有数据。这不是幻影行。应显示为“导入通知...”的值

那么最简单的解决方案是跳过带有`null`标题的行：

```
mRows = mDB.query("book_content",
    new String[] { "id", "title" },
    "WHERE title IS NOT NULL",
    null,
    null,
    null,
    "id", 
    null); 
```

这样它就不会使您的应用崩溃，并且您可以保留通知。

# matlab - Matlab：带替换的随机样本

> ID：13435116
> 
> 赞同：0
> 
> 时间：2012-11-17T21:49:41.980
> 
> 标签：matlab, replace, random-sample

从数据集中替换随机样本的最佳方法是什么？我使用 316 * 34 作为我的数据集。我想将数据分成**三个**桶，但要替换。我是否应该使用 randperm，因为我需要确保索引完好无损，因为该索引可以方便地识别标签数据。我是 matlab 新手，我看到有几个随机样本方法，但它们看起来不像我正在寻找的那样，奇怪的是认为 matlab 中不存在类似的东西，但我做了以下操作：

我的问题是当我这样做时，`row_idx = round(rand(1)*316)`有时我会得到零，这会导致两个问题

1.  我应该怎么做才能避免zeor？
2.  用替换进行随机样本的最佳方法是什么。

    ```
     shuffle_X = X(randperm(size(X,1)),:);
        lengthOf_shuffle_X = length(shuffle_X)
        number_of_rows_per_bucket = round(lengthOf_shuffle_X / 3)
        bucket_cell = cell(3,1)
        bag_matrix = []
        for k = 1:length(bucket_cell)
            for i = 1:number_of_rows_per_bucket
                row_idx = round(rand(1)*316)
                bag_matrix(i,:) = shuffle_X(row_idx,:)
            end
            bucket_cell{k} = bag_matrix
        end 
    ```

我可以做到以下几点：

```
 if row_idx == 0
                row_idx = round(rand(1)*316) 
```

假设随机数不会在连续两轮中给出两个零值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:01:45.180

`randi`是获取整数索引以进行替换采样的好方法。假设你想用相同数量的样本填充三个桶，那么你可以写

```
data = rand(316,34); %# create some dummy data
number_of_data = size(data,1);
number_of_rows_per_bucket = 50;
bucket_cell = cell(1,3);

idx = randi([1,number_of_data],[number_of_rows_per_bucket,3]);

for iBucket = 1:3
   bucket_cell{iBucket} = data(idx(:,iBucket),:);
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T00:07:07.547

问题：如果你使用`randperm`它会给你一个没有替换的抽奖顺序，因为你可以抽一次任何项目。

如果您使用`randi`它来替换您，那就是您可能多次绘制一个项目。

如果你想“分割”一个数据集，这通常意味着你将数据集分成三个不同的集合。为此，您使用 draw 无需替换（您不会将物品放回原处；使用`randperm`）。如果你用替换来做（使用`randi`），它会非常慢，因为一段时间后你绘制一个你以前没有的项目的机会非常低。（[优惠券收集器](http://en.wikipedia.org/wiki/Coupon_collector%27s_problem)中的详细信息）。

**如果您需要一个 split 的分段**，您可以检查元素并独立决定放置它的位置。（也就是说，您为每个有替换的项目选择一个桶——也就是说，您将任何选择的桶放回游戏中。）

为了那个原因：

```
% if your data items are vectors say data = [1 1; 2 2; 3 3; 4 4]
num_data = length(data);
bucket_labels = randi(3,[1,num_data]); % draw a bucket label for each item, independently.
for i=1:3
  bucket{i} = data(bucket_labels==i,:); 
end

%if your data items are scalars say data = [1 2 3 4 5]    
num_data = length(data);
bucket_labels = randi(3,[1,num_data]);
for i=1:3
  bucket{i} = data(bucket_labels==i); 
end 
```

我们去吧。

# android - 在Android上将值从Dialog传回Activity的可靠方法？

> ID：13435118
> 
> 赞同：8
> 
> 时间：2012-11-17T21:49:49.373
> 
> 标签：android, dialog, android-alertdialog

这个问题已经出现了好几次，我已经阅读了所有的答案，但我还没有看到一个真正强大的方法来处理这个问题。在我的解决方案中，我正在使用来自调用`Activity`的侦听器，`AlertDialog`如下所示：

```
public class MyDialogFragment extends DialogFragment {

    public interface MyDialogFragmentListener {
        public void onReturnValue(String foo);
    }

    public void init(boolean someValue)
    {
        sSomeValue = someValue;
        listeners = new ArrayList<MyDialogFragmentListener>();
    }
    static boolean sSomeValue;
    private static ArrayList<MyDialogFragmentListener> listeners;

    public void addMyDialogFragmentListener(MyDialogFragmentListener l)
    {
        listeners.add(l);
    }

    public void removeMyDialogFragmentListener(MyDialogFragmentListener l)
    {
        listeners.remove(l);
    }

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState) {
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(R.string.title)
           .setPositiveButton(R.string.ok, new DialogInterface.OnClickListener() {
               @Override
               public void onClick(DialogInterface dialog, int id) {
                   for (MyDialogFragmentListener listener : listeners) {
                       listener.onReturnValue("some value");
                   }
               }
           })
           .setNegativeButton(R.string.cancel, new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                   // User cancelled the dialog
                   // Nothing to do but exit
               }
           });
        if (sSomeValue) {
            builder.setMessage(R.string.some_value_message);
        } else {
            builder.setMessage(R.string.not_some_value_message);
        }
        // Create the AlertDialog object and return it
        return builder.create();
    }
} 
```

然后在调用`Activity`中，我正常实例化对象，传递任何参数`init`并设置我的监听器。

这就是问题所在：当您在对话框打开时旋转设备并更改方向时，会重新创建`Activity`和对象。`MyDialogFragment`为了确保输入值不会搞砸，我将初始化值设置为`static`. 这对我来说感觉很奇怪，但由于一次只会有一个这样的对话，我可以接受。问题出在返回值上。原始侦听器将被调用。这很好，因为对象仍然存在，但如果需要更新`Activity`（存在）上的 UI，它不会被更新，因为*新* `Activity`实例现在正在控制 UI。

我正在考虑的一种解决方案是`getActivity()`将对话框类强制转换为 my`Activity`并强制对话框本身添加一个侦听器，而不是让调用`Activity`来执行它。但这只是感觉就像黑客滚雪球一样。

优雅地处理这个问题的最佳实践是什么？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-17T22:00:49.853

你在正确的轨道上，我按照[Android 开发者推荐的方法 - 使用 DialogFragments 文章](http://android-developers.blogspot.com/2012/05/using-dialogfragments.html)。

您创建 DialogFragment 并定义 Activity 将实现的接口，就像您在上面所做的那样：

```
public interface MyDialogFragmentListener {
    public void onReturnValue(String foo);
} 
```

然后在 DialogFragment 中，当您想将结果返回给 Activity 时，您将 Activity 投射到界面：

```
@Override
public void onClick(DialogInterface dialog, int id) {
    MyDialogFragmentListener activity = (MyDialogFragmentListener) getActivity();
    activity.onReturnValue("some value");
} 
```

然后在`Activity`你实现该接口并获取值：

```
public class MyActivity implements MyDialogFragmentListener {
    ...
    @Override
    public void onReturnValue(String foo) {
        Log.i("onReturnValue", "Got value " + foo + " back from Dialog!");
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T22:00:06.933

您可以从 Dialog 的 onClickListner 中触发 Activity 将监听的 Intent。

看看这个关于[广播和接收意图的教程](http://www.techotopia.com/index.php/Android_Broadcast_Intents_and_Broadcast_Receivers)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-24T19:45:33.580

很老的帖子但是...

我在对话框类中有适当的变量：

```
int selectedFooStatus = 0; 
```

在与对话框交互时操纵它们：

```
.setSingleChoiceItems(FOO_CHOICES, -1, new DialogInterface.OnClickListener() {
                   @Override
                   public void onClick(DialogInterface dialog, int which) {

                       selectedFooStatus = which; 

                   }}) 
```

在 onclick 回调方法中，我适当地转换了返回片段并使用 getter 来返回值。

```
 public void onDialogPositiveClick(DialogFragment dialog) {

                ChangeFooStatusDialog returnedDialog = (ChangeFooStatusDialog) dialog;

                this.fooStatus = returnedDialog.getSelectedFooStatus();

} 
```

# qt - Qt 模型/视图架构 - 如何处理更复杂的模型

> ID：13435119
> 
> 赞同：4
> 
> 时间：2012-11-17T21:49:50.550
> 
> 标签：qt, model

Qt 中的模型是否应该或多或少地适应模型——因此最终由列表、表格或树来表示？如果您的模型要复杂得多并且不能用列表、表格或树表示怎么办？

如果是这种情况，我认为这只会使模型成为数据；类似于 XML 文件或电子表格的东西。

示例：如果所讨论的应用程序中的模型是更复杂的东西，比如汽车怎么办？我会假设汽车的模型将包括关于汽车的所有类型的数据和业务规则。将有一个引擎、车轮、一个框架和许多其他不同的组件，它们都一起工作来创造整个汽车。每个组件都有自己独特的一组行为：框架有颜色，引擎有温度，立体声有音量设置，等等。每个组件也会有行为：如果踩下油门踏板，车轮就会转动，发动机就会升温。显然，一个`QStringListModel`或其他一些内置的简化模型不能适当地解决汽车中的所有复杂性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T18:28:54.090

模型不是数据，而是一组回调。事实上，模型后面不需要有真实数据。它更像是一个被查询的服务器。

这就像这之间的区别：

```
int data[5] = { 0, 2, 4, 6, 8 };
void viewer(int *data, int n) {
    for (int ii = 0; ii < n; ii++)
        printf("%d, ", data[ii]);
}
int main() {
    viewer(data, 5);
} 
```

还有这个：

```
int model(int index) {
    return index * 2;
}
typedef int (*model_function)(int);
void viewer(model_function model, int n) {
    for (int ii = 0; ii < n; ii++)
        printf("%d, ", model(ii));
}
int main() {
    viewer(model, 5);
} 
```

两者都会给你`0, 2, 4, 6, 8`，但模型实际上并不需要一个数组来提供相同的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T16:32:15.213

尝试在这里阅读关于 Qt 中的 MV：[关于 SO 的类似问题](https://stackoverflow.com/questions/5543198/why-qt-is-misusing-model-view-terminology)，当然还有[http://qt-project.org/ 上的 Model/View Programming](http://doc.qt.nokia.com/qt/model-view-programming.html)等资源。此外，VoidRealms 还有很多有趣的视频，包括这个主题 - [VoidRealms: C++ Qt 47 - Intro to model view programming](http://www.youtube.com/watch?v=uDC9L4T59bM)。

尝试从总体上理解它，尤其是在特定情况下——它在 Qt 中的情况，所有的问题和你的误解都会消失。

# c++ - 更改文件名

> ID：13435125
> 
> 赞同：0
> 
> 时间：2012-11-17T21:51:05.830
> 
> 标签：c++, visual-c++, mfc

我已将标头和 cpp 文件从一个项目复制到另一个项目。我现在需要更改文件名。头文件有以下我看不懂的代码。如果我更改文件名，我应该如何更改此代码？感谢您的帮助。

```
#if !defined(AFX_MSELCFLCOMPDLG_H__8687FD1A_777D_4967_A331_42C8536DE2DE__INCLUDED_)
#define AFX_MSELCFLCOMPDLG_H__8687FD1A_777D_4967_A331_42C8536DE2DE__INCLUDED_

#if _MSC_VER > 1000
#pragma once
#endif 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T21:52:55.517

你不需要，但你可能应该。

此代码作为标头保护存在。它阻止内容被多次包含到单个源文件中。

更改它是维护和良好实践的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T21:53:46.233

这称为包含保护，它可以防止文件被多次包含。如果更改文件名，则无需更改它。名称后面的一长串数字将是唯一的。如果您想保持名称和常量同步，请将“MSELCFLCOMPDLG_H”部分更改为您的新文件名。

# java - JMenuItem ActionListener 工作不正常

> ID：13435127
> 
> 赞同：1
> 
> 时间：2012-11-17T21:51:23.767
> 
> 标签：java, swing, actionlistener, jmenuitem

我已经使用 Jmenulist 制作了 JAVA 代码并尝试通过 actionlistener 调用它，但 ActionListner 不起作用。尽管它正在另一个代码中工作。但它在程序中产生了问题。

```
import javax.swing.*;
import java.awt.*;
import java.io.*;
import java.awt.event.*;

public class Submit {

public static void main(String[] args) 
{

JFrame frame = new JFrame();
JMenuBar menuBar = new JMenuBar();
JMenu fileMenu = new JMenu("Graph");

JMenuItem closeMenuItem = new JMenu("Close");
 closeMenuItem.addActionListener(new Close());

fileMenu.add(closeMenuItem);

menuBar.add(fileMenu);

frame.setJMenuBar(menuBar);

frame.setSize(500,500);
frame.setVisible(true);
}

}

 class Close implements ActionListener {
public void actionPerformed(ActionEvent ev) {
    System.out.println("Selected: ");

}} 
```

当我遵守它

```
public void actionPerformed(ActionEvent ev) {
    System.out.println("Selected: ");

} 
```

此部分不起作用。虽然几乎相同的代码

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package in.ac.iiitd.cse201.rachit11084.hw3.q2;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;

import javax.swing.JFrame;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;

class MenuActionListener implements ActionListener {
  public void actionPerformed(ActionEvent e) {
    System.out.println("Selected: " + e.getActionCommand());

  }
}

public class ContructMenuActionListener {
  public static void main(final String args[]) {
    JFrame frame = new JFrame("MenuSample Example");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    JMenuBar menuBar = new JMenuBar();

    JMenu fileMenu = new JMenu("File");
    fileMenu.setMnemonic(KeyEvent.VK_F);
    menuBar.add(fileMenu);

    JMenuItem newMenuItem = new JMenuItem("New");
    newMenuItem.addActionListener(new MenuActionListener());
    fileMenu.add(newMenuItem);

    frame.setJMenuBar(menuBar);
    frame.setSize(350, 250);
    frame.setVisible(true);
  }
} 
```

工作正常。我应该如何解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:03:24.010

`JMenuItem closeMenuItem = new JMenuItem("Close");`

不是

`JMenuItem closeMenuItem = new JMenu("Close");`

创建一个新的`new JMenu`子菜单，因此它不能关联一个动作，它只提供子菜单项。

# windows - Windows 7 CoreAudio Media Foundation - IID_IAudioStreamVolume 的 uuidof

> ID：13435133
> 
> 赞同：0
> 
> 时间：2012-11-17T21:52:42.470
> 
> 标签：windows, audio, ms-media-foundation

我收到以下代码的链接错误：

hr = pPlaybackClient->GetService(IID_IAudioStreamVolume, (void **)&pStreamVolume);

链接错误是“未解析的外部符号_IID_IAudioStreamVolume”

IID_IAudioStreamVolume 是在 Audioclient.h 中定义的，我正在 #include 那个文件。如果我声明：

常量 IID IID_IAudioStreamVolume = __uuidof(IID_IAudioStreamVolume);

我收到“错误：__uuidof 的操作数必须具有已指定 __declspec(uuid('...')) 的类或枚举类型。

我确定这是一个小问题，但我没有看到答案 - 将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:48:38.170

找到了。使用 __uuidof(IAudioStreamVolume) 而不是 IID_IAudioStreamVolume 可以正确编译和链接。如果有人知道我在哪里可以找到关于 MS 在这里所做的一些文档，我将不胜感激。

# c - #include 其他 C 程序

> ID：13435134
> 
> 赞同：0
> 
> 时间：2012-11-17T21:52:43.987
> 
> 标签：c, include

我需要将 file_1.c 包含到 main.c 中。在 file_1.c 中，我目前有多个功能。如果我想在main.c中调用这些函数，我需要做什么？我的主程序中有#include“file_1.c”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T21:55:19.263

通过制作头文件使用标准方法

`#include"file_1.h"`

您必须将其与`"file_1.c"`一起编译`main.c`并使一个可执行文件，因为在运行时需要函数调用。

尝试这个 ：

创建头文件`file_1.h`

```
#ifndef _FILE_H
#define _FILE_H

void foo(int );
#endif 
```

给出函数和结构定义（如果有）或任何全局变量的所有声明

然后 in`file_1.c`将包含函数的实际定义

```
//file_1.c

    #include "file_1.h"
    #include <stdio.h>
    void foo(int x)
    {
      printf("%d\t",x);
    }

//main.c
    #include "file_1.h"

    int main()
    {
    int x=10;
    foo(x);
    return 0;
    } 
```

`file_1.h`在 (`main.c`和`file_1.c`)文件中包含头`c`文件

在`gcc`

`gcc -Wall main.c file_1.c -o myexe.out`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T21:54:27.090

为什么你认为你需要这样做？

通常，您会将 file_1.c 中的函数声明添加到 file_1.h 中，并将其包含在 main.c 中。

当您链接程序时，您只需要在命令行中包含 main.c 和 file_1.c（然后包含函数的定义）。

# list - Prolog - 添加到每个列表元素

> ID：13435137
> 
> 赞同：1
> 
> 时间：2012-11-17T21:53:04.963
> 
> 标签：list, recursion, prolog

我正在学习 swi Prolog，我想创建为每个元素添加 +2 的谓词。

所以我写了这样的东西：

```
addUp([],_).
addUp([H|T],R):-addUp(T,R),is_list(R)->append([H+2],R,R);R=[H+2|[]].

addUp([1,2],X). 
```

但它总是返回 false。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:00:49.613

首先是一个建议：学习使用[maplist](http://www.swi-prolog.org/pldoc/doc_for?object=section%282,%27A.2%27,swi%28%27/doc/Manual/apply.html%27%29%29) /3：你将使用它来编写

```
addUp(Xs, Ys) :- maplist(addUp2, Xs, Ys).
addUp2(X, Y) :- Y is X + 2. 
```

或者更好，一个更可重用的片段......

```
addUp(Xs, Ys) :- maplist(addUp(2), Xs, Ys).
addUp(N, X, Y) :- Y is X + N. 
```

无论如何，Prolog 中的算术必须“明确地”评估，并且您的代码必须简化很多才能工作

```
addUp([], []).
addUp([H|T], [H1|T1]) :- H1 is H+2, addUp(T, T1). 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T23:57:12.970

> 但它总是返回 false。为什么？

您的定义并不总是失败：

```
?- addUp([1],X)。
X = [1+2]。

```

所以有时它会成功。看来这种情况或多或少是您想要的。它还能在哪里成功？在其他编程语言中，您将不得不猜测，或者，天堂禁止，阅读程序。在 Prolog 中，不需要这样做。只需找到一个好的查询。一个好的候选者是**最一般的查询**：

```
?- addUp(Xs,Ys)。
Xs = [] ...

```

所以你的定义成功了`Xs`equal to`[]`和`Ys`equal to ... 好吧，equal to **anything**。因此，这个答案太笼统了。

另一个目标引起了我的注意：`is_list(R)->append([H+2],R,R)`. 让我们想象一下，这将是真的。不为`R = []`，也不为`R = [_]`。事实上，没有长度，这将是真实的。

*现在*，我们可以开始修复您的程序了。请参阅 chac/CapelliC 的建议。

# mysql - 按收入排序交易，这是 MySQL 中订单表行的总和

> ID：13435139
> 
> 赞同：3
> 
> 时间：2012-11-17T21:53:13.767
> 
> 标签：mysql, sql

好吧，我一直对此提出质疑，但直到今天才真正需要它。

通常，我会抓取所有交易，逐个浏览它们，然后从与该交易相关的所有订单中找到 SUM（金额）。(PHP)

然后我会做一个简单的 uasort() 工作正常。

但现在我需要用一个 sql 查询来完成这一切。

这是我尝试过的：

```
SELECT deals.ID, SUM(orders.amount) AS revenue FROM deals
JOIN orders ON (orders.deal_id = deals.id)
ORDER BY revenue DESC 
```

现在这给了我一行，带有“随机”交易 ID，以及更大的收入数字。

我怀疑这个收入数字是所有金额列的总和，而不是这个特定的交易 ID。

我想要的是每个交易 ID 的一行，并且在列收入中使用正确的数字，所有行都按 DESC 排序。

这将如何完成？从交易的收入（自定义列）中对交易进行排序 - 这是相应交易 ID 的行中所有金额列的总和。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T21:54:45.757

你缺少`GROUP BY`条款

```
SELECT  deals.ID, SUM(orders.amount) AS revenue 
FROM    deals
        INNER JOIN orders 
            ON orders.deal_id = deals.id
GROUP BY deals.ID
ORDER BY revenue DESC 
```

*   [**GROUP BY 条款**](http://www.techonthenet.com/sql/group_by.php)
*   [**按聚合函数**分组](http://www.tutorialspoint.com/mysql/mysql-group-by-clause.htm)

# assembly - 为什么 INC 和 DEC 指令*不*影响进位标志 (CF)？

> ID：13435142
> 
> 赞同：26
> 
> 时间：2012-11-17T21:53:39.833
> 
> 标签：assembly, x86, increment, flags, decrement

为什么x86指令`INC`（递增）和`DEC`（递减）不影响`CF`FLAGSREGISTER中的（进位标志）？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-17T22:57:47.620

要了解为什么您可能需要记住当前具有 32 位和 64 位值的“x86”CPU 的生命开始于更有限的 8 位机器，可以追溯到 Intel 8008。（我在 1973 年在这个世界上编码，我仍然记住（呃）它！）。

在那个世界里，寄存器既珍贵又小。您需要`INC`/`DEC`用于各种目的，最常见的是循环控制。许多循环涉及执行“多精度算术”（例如，16 位或更多！）通过设置`INC`/`DEC`设置零标志 ( `Z`)，您可以使用它们很好地控制循环；通过坚持循环控制指令不改变进位标志`CF`（

一旦你习惯了丑陋的指令集，这工作得很好。

在具有更大字数的更现代的机器上，您不需要太多，因此`INC`并且`DEC`可以在语义上等同于`ADD`...,1 等。事实上，这就是我在需要进位集时使用的：-}

大多数情况下，我现在远离`INC`，`DEC`因为他们会进行部分条件代码更新，这可能会导致管道中的有趣停顿，并且`ADD`/`SUB`不会。因此，在无关紧要的地方（大多数地方），我使用`ADD`/`SUB`来避开摊位。我仅在保持代码小问题时才使用`INC`/ `DEC`，例如，适合一个或两个指令的大小产生足够差异的高速缓存行。这可能是毫无意义的纳米[字面意思！]-优化，但我的编码习惯相当老派。

我的解释告诉我们为什么`INC`/`DEC`设置零标志 ( `Z`)。`INC`对于为什么/`DEC`设置符号（和奇偶校验标志），我没有特别令人信服的解释。

编辑 2016 年 4 月：似乎在现代 x86 上可以更好地处理失速问题。请参阅[INC 指令与 ADD 1：这有关系吗？](https://stackoverflow.com/q/36510095/120163)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-24T16:28:21.357

当你有由 inc/dec 设置的*零*标志时为什么要签名的问题*最好*用问题来解决：你宁愿没有选项***a***吗？

 ***```
a) for (n=7;n>=0;n--)   // translates to   `dec + jns`
b) for (n=8;n>0;n--)    // translates to   `dec + jnz` 
```

正如[Ira Baxter](https://stackoverflow.com/a/13435633/1716339)已经澄清的那样，进位标志用于许多算法——不仅是多精度算术，而且还用于单色/cga/EGA 时代的位图处理：这会将 80 像素宽的行向右移动一个像素......

```
 mov cx, 10
begin:  lodsb
        rcr al,1   // this is rotate though carry:
        stosb      // for the algorithm to work, carry must not be destroyed
        LOOP begin // 
```

但后来：为什么要平价？

我相信答案是为什么不。该指令集来自 70 年代后期，当时晶体管稀缺。拒绝为某些特定指令计算奇偶校验标志没有任何意义，只会增加 CPU 的复杂性。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-07-08T16:58:23.533

1.  指令**inc**和**dec**通常用于维护迭代或循环计数。使用 32 位，迭代次数可高达 4,294,967,295。这个数字对于大多数应用来说已经足够大了。如果我们需要比这更大的计数怎么办？我们必须使用 add 而不是 inc 吗？这就引出了第二个也是主要的原因。

2.  进位标志检测到的条件也可以通过零标志检测。为什么？因为 inc 和 dec 仅将数字更改 1。例如，假设 ECX 寄存器已达到其最大值 4,294,967,295 (FFFFFFFFH)。如果我们然后执行

    ```
     inc ECX 
    ```

    我们通常期望进位标志设置为 1。但是，我们可以通过注意 ECX = 0 来检测这种情况，这会设置零标志。因此，设置进位标志对于这些指令来说确实是多余的。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-17T23:12:50.677

因为不需要影响。检查零标志就足够了。因此，在 inc 和 dec 指令之后，进位标志保持不变，在某些情况下这很有用。***

# xcode - 折叠 UITable 部分

> ID：13435147
> 
> 赞同：0
> 
> 时间：2012-11-17T21:53:50.923
> 
> 标签：xcode, uitableview

我有一个 UITable 可以在标题部分单击时折叠。我需要标题部分在其中包含唯一的文本。

我可以使用 cell.textlabel.text = @""; 这很好用，但是我想在单元格中添加更多标签并定位它们，即

```
 lbl123 = [[UILabel alloc] initWithFrame:CGRectMake(10, 0, 290, 20)];
            lbl123.font = [UIFont fontWithName:@"Trebuchet MS" size:12.0f];
            lbl123.textColor = [UIColor blackColor];
            lbl123.backgroundColor = [UIColor clearColor];
            lbl123.highlightedTextColor = [UIColor whiteColor];
            lbl123.opaque = NO;
            lbl123.adjustsFontSizeToFitWidth = TRUE;
            lbl123.numberOfLines = 0;
            lbl123.lineBreakMode = UILineBreakModeWordWrap;
            [cell addSubview:lbl123];
            lbl123.text = @"test"; 
```

但是当我将它添加到“cellforindexpath”部分时，它会在表格下方的单元格上复制自身。

任何想法为什么会这样？

下面的完整代码： -

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    NSString *cellValue = 0;

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"MyIdentifier"];
    if (cell == nil)
    {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                       reuseIdentifier:@"MyIdentifier"];
    }

    if (tableView.tag == 2)
    {
        UILabel *lbl123;
        if ([self tableView:tableView canCollapseSection:indexPath.section])
        {
            cell.textLabel.font = [UIFont fontWithName:@"Trebuchet MS" size:12.0f];

            if (!indexPath.row)
            {
                cell.textLabel.backgroundColor = [UIColor clearColor];
                UIView *bgView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 320, 60)];
                [bgView setBackgroundColor:[UIColor blackColor]];
                [bgView setAlpha:0.3];
                [cell setBackgroundView:bgView];
                lbl123 = [[UILabel alloc] initWithFrame:CGRectMake(10, 0, 290, 20)];
                lbl123.font = [UIFont fontWithName:@"Trebuchet MS" size:12.0f];
                lbl123.textColor = [UIColor blackColor];
                lbl123.backgroundColor = [UIColor clearColor];
                lbl123.highlightedTextColor = [UIColor whiteColor];
                lbl123.opaque = NO;
                lbl123.adjustsFontSizeToFitWidth = TRUE;
                lbl123.numberOfLines = 0;
                lbl123.lineBreakMode = UILineBreakModeWordWrap;
                [cell addSubview:lbl123];
                lbl123.text = @"";

                if(indexPath.section == 1)
                {
                    cell.textLabel.font = [UIFont fontWithName:@"Trebuchet MS-Bold" size:15.0f];
                    cell.textLabel.text = [NSString stringWithFormat:@"My Results Overview:"];
                    cell.textLabel.textColor = [UIColor whiteColor];
                    cell.textLabel.numberOfLines = 3;
                    cell.textLabel.opaque = YES;

                    UIImageView *av = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 294, 80)];
                    av.backgroundColor = [UIColor clearColor];
                    av.opaque = NO;
                    av.image = [UIImage imageNamed:@"Blue bar 720x115.png"];
                    cell.backgroundView = av;
                }

                if(indexPath.section == 2)
                {
                    cell.textLabel.font = [UIFont fontWithName:@"Trebuchet MS-Bold" size:15.0f];
                    cell.textLabel.text = [NSString stringWithFormat:@"Result1:"];
                    cell.textLabel.textColor = [UIColor blackColor];
                    cell.textLabel.numberOfLines = 3;
                    cell.textLabel.opaque = YES;

                    UIImageView *av = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 294, 120)];
                    av.backgroundColor = [UIColor clearColor];
                    av.opaque = NO;
                    if ([confidenceCOL isEqualToString:@"Red"])
                    {
                        av.image = [UIImage imageNamed:@"redPanel.png"];
                    }
                    if ([confidenceCOL isEqualToString:@"Green"])
                    {
                        av.image = [UIImage imageNamed:@"greenPanel.png"];
                    }
                    if ([confidenceCOL isEqualToString:@"Purple"])
                    {
                        av.image = [UIImage imageNamed:@"purplePanel.png"];
                    }
                    cell.backgroundView = av;

                    lbl123.text = @"Test";
                }
                if(indexPath.section == 3)
                {
                    cell.textLabel.font = [UIFont fontWithName:@"Trebuchet MS-Bold" size:15.0f];
                    cell.textLabel.text = [NSString stringWithFormat:@"Result2:"];
                    cell.textLabel.textColor = [UIColor blackColor];
                    cell.textLabel.numberOfLines = 3;
                    cell.textLabel.opaque = YES;

                    UIImageView *av = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 294, 120)];
                    av.backgroundColor = [UIColor clearColor];
                    av.opaque = NO;
                    if ([ambitionCOL isEqualToString:@"Red"])
                    {
                        av.image = [UIImage imageNamed:@"redPanel.png"];
                    }
                    if ([ambitionCOL isEqualToString:@"Green"])
                    {
                        av.image = [UIImage imageNamed:@"greenPanel.png"];
                    }
                    if ([ambitionCOL isEqualToString:@"Purple"])
                    {
                        av.image = [UIImage imageNamed:@"purplePanel.png"];
                    }
                    cell.backgroundView = av;

                    lbl123.text = @"TestING!";
                }

                if ([expandedSections containsIndex:indexPath.section]){}
                else{}

            }
            else
            {
                if(indexPath.section == 2)
                {
                    cellValue = Result1Moretext;
                }
                if(indexPath.section == 3)
                {
                    cellValue = Result2Moretext;
                }

                static NSUInteger const k1 = 1;

                // Declare references to the subviews which will display the data.
                UILabel *lbl1 = nil;

                static NSString *kCellID = @"CellID";

                UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:nil];
                if (cell == nil) {
                    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:kCellID];

                    lbl1 = [[UILabel alloc] initWithFrame:CGRectMake(10, 0, 290, 300)];
                    lbl1.font = [UIFont fontWithName:@"Trebuchet MS" size:12.0f];
                    lbl1.tag = k1;
                    lbl1.textColor = [UIColor blackColor];
                    lbl1.backgroundColor = [UIColor clearColor];
                    lbl1.highlightedTextColor = [UIColor whiteColor];
                    lbl1.opaque = NO;
                    lbl1.adjustsFontSizeToFitWidth = TRUE;
                    lbl1.numberOfLines = 0;

                    lbl1.lineBreakMode = UILineBreakModeWordWrap;
                    [cell.contentView addSubview:lbl1];

                }else {
                    lbl1 = (UILabel *)[cell.contentView viewWithTag:k1];
                }

                cell.accessoryView.tag = indexPath.row;

                lbl1.text = [NSString stringWithFormat:@"%@", cellValue];
                return cell;

            }

        }

        else
        {

        }

    } 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:30:34.440

不要忘记在 UITableViews 中重用单元格以保持较低的内存使用率。所以发生的事情是你正在制作一个单元格，并向其中添加标签，然后在该单元格滚动屏幕后，它进入一个重用池，被重新添加为更下方的新单元格，*并且其中仍然有标签*。

您应该做的是**仅**在创建新单元格时创建所有标签等（在 cell==nil 部分，这是一个单元格未出列的地方），并在其余代码中设置所有标签。

您可以稍后使用视图标签再次查找标签视图。

例如。

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"MyIdentifier"];
if (cell == nil)
{
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault
                                   reuseIdentifier:@"MyIdentifier"];
    lbl123 = [[UILabel alloc] initWithFrame:CGRectMake(10, 0, 290, 20)];
    lbl123.font = [UIFont fontWithName:@"Trebuchet MS" size:12.0f];
    lbl123.textColor = [UIColor blackColor];
    lbl123.backgroundColor = [UIColor clearColor];
    lbl123.highlightedTextColor = [UIColor whiteColor];
    lbl123.opaque = NO;
    lbl123.adjustsFontSizeToFitWidth = TRUE;
    lbl123.numberOfLines = 0;
    lbl123.lineBreakMode = UILineBreakModeWordWrap;
    [cell addSubview:lbl123];
    lbl123.text = @"";
    lbl123.tag=123;
} else {
    lbl123 = (UILabel *)[cell viewWithTag:123];
}

if(indexPath.section == 2)
{
    lbl123.text = @"Test";
} 
```

# c# - 如何以编程方式使用 Wikipedia 中的超链接制作 html 文本？

> ID：13435149
> 
> 赞同：5
> 
> 时间：2012-11-17T21:54:13.420
> 
> 标签：c#, regex, string

我有字符串数组，我必须将超链接添加到数组和给定字符串中的每个匹配项。主要是类似维基百科的东西。

就像是：

```
private static string AddHyperlinkToEveryMatchOfEveryItemInArrayAndString(string p, string[] arrayofstrings)

{            } 
```

`string p = "The Domesday Book records the manor of Greenwich as held by Bishop Odo of` `Bayeux; his lands were seized by the crown in 1082\. A royal palace, or hunting lodge, has` `existed here since before 1300, when Edward I is known to have made offerings at the chapel of the Virgin Mary.";`

```
arrayofstrings = {"Domesday book" , "Odo of Bayeux" , "Edward"}; 
```

`returned string = @"The <a href = "#domesday book">Domesday Book</a> records the manor of` `Greenwich as held by Bishop <a href = "#odo of bayeux">Odo of Bayeux</a>; his lands were` `seized by the crown in 1082\. A royal palace, or hunting lodge, has existed here since` `before 1300, when <a href = "#edward">Edward<a/> I is known to have made offerings at the` `chapel of the Virgin Mary.";`

最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T22:00:11.947

你可能很容易这样做：

```
foreach(string page in arrayofstrings)
{
    p = Regex.Replace(
        p, 
        page, 
        "<a href = \"#" + page.ToLower() + "\">$0</a>", 
        RegexOptions.IgnoreCase
    );
}
return p; 
```

如果锚的大小写可以和匹配的文本一样，你甚至可以去掉for循环：

```
return Regex.Replace(
    p,
    String.Join("|", arrayofstrings),
    "<a href = \"#$0\">$0</a>",
    RegexOptions.IgnoreCase
); 
```

现在模式变为`Domesday book|Odo of Bayeux|Edward`，无论大小写如何都可以找到匹配项，找到的任何内容都会放回链接文本和`href`属性中。

# scala - 实现观察者模式

> ID：13435151
> 
> 赞同：3
> 
> 时间：2012-11-17T21:54:29.720
> 
> 标签：scala

我最近开始学习 Scala 并开始了一个小项目来创建一个简单的 roguelike 游戏。但是，我一直在尝试实现观察者模式。 [这个](https://stackoverflow.com/a/3755647/879114)答案触及了主题，但我不知道如何让它发挥作用。以下是上面链接的答案中的代码。我对代码中的“ **this: S =>** ”部分感到困惑，我想我应该在那里有某种函数，但我不确定。我想让它从将扩展 Subject 特征的类中返回一个元组。

```
trait Observer[S] {
 def receiveUpdate(subject: S);
}

trait Subject[S] {
 this: S =>
 private var observers: List[Observer[S]] = Nil
 def addObserver(observer: Observer[S]) = observers = observer :: observers

 def notifyObservers() = observers.foreach(_.receiveUpdate(this))
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T06:57:50.650

请参阅史蒂夫关于类型的回答`self`和另一个代码示例。

这是一些使用观察者的示例代码。`ObservedAccount`是观察者`Subject`观察到的`AccountReporter`。

```
trait Observer[S] {
    def receiveUpdate(subject: S);
}

trait Subject[S] { 
    this: S =>
    private var observers: List[Observer[S]] = Nil
    def addObserver(observer: Observer[S]) = observers = observer :: observers

    def notifyObservers() = observers.foreach(_.receiveUpdate(this))
}

class Account(initialBalance: Double) {
    private var currentBalance = initialBalance
    def balance = currentBalance
    def deposit(amount: Double)  = currentBalance += amount
    def withdraw(amount: Double) = currentBalance -= amount
}

class ObservedAccount(initialBalance: Double) extends Account(initialBalance) with Subject[Account] {
    override def deposit(amount: Double) = {
        super.deposit(amount)
        notifyObservers()
    }
    override def withdraw(amount: Double) = {
        super.withdraw(amount)
        notifyObservers()
    }
}

class AccountReporter extends Observer[Account] {
    def receiveUpdate(account: Account) =
        println("Observed balance change: "+account.balance)
} 
```

让我们看看它的实际效果：

```
scala> val oa = new ObservedAccount(100.0)
oa: ObservedAccount = ObservedAccount@3f947e20

scala> val ar = new AccountReporter
ar: AccountReporter = AccountReporter@6ea70a98

scala> oa.addObserver(ar)

scala> oa.deposit(40.0)
Observed balance change: 140.0

scala> oa.withdraw(40.0)
Observed balance change: 100.0 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-19T10:11:41.133

以布赖恩的回答为基础：我发现没有必要有一个单独的`Observer[S]`特征，就`S => Unit`足够了：

```
trait Subject[S] {
  this: S =>
  private var observers: List[S => Unit] = Nil
  def addObserver(observer: S => Unit) = observers = observer :: observers
  def notifyObservers() = observers.foreach(_.apply(this))
}

class Account(initialBalance: Double) {
  private var currentBalance = initialBalance
  def balance = currentBalance
  def deposit(amount: Double) = currentBalance += amount
  def withdraw(amount: Double) = currentBalance -= amount
}

class ObservedAccount(initialBalance: Double) extends Account(initialBalance)
  with Subject[Account] {

  override def deposit(amount: Double) = {
    super.deposit(amount)
    notifyObservers()
  }
  override def withdraw(amount: Double) = {
    super.withdraw(amount)
    notifyObservers()
  }
}

class AccountReporter {
  def receiveUpdate(account: Account) =
    println("Observed balance change: " + account.balance)
}

object Main extends App {
  println("start app")
  val oa = new ObservedAccount(100.0)
  val ar = new AccountReporter
  oa.addObserver(ar.receiveUpdate _)
  oa.deposit(40.0)
  oa.deposit(60.0)
  println("stop  app")
}

/**
      a copy paste observer pattern scala mini-app
      sbt run should produce:
      [info] Running app.Main
      start app
      Observed balance change: 140.0
      Observed balance change: 200.0
      stop  app
  */ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T01:58:03.253

很抱歉用问题来回答问题。您是否在这里阅读过[您](http://infoscience.epfl.ch/record/176887)的[答案](http://lampwww.epfl.ch/~odersky/papers/ScalableComponent.pdf)或[更有趣的答案](http://lampwww.epfl.ch/~imaier/pub/DeprecatingObserversTR2010.pdf)？有人应该编制一个阅读清单，如果他们没有。Coursera 有阅读清单吗？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-17T22:20:51.427

这是一个 Scala 自类型（参见[http://www.scala-lang.org/node/124](http://www.scala-lang.org/node/124)）。它表达了一个要求，即特征 Subject[S] 的所有具体实现也必须符合类型 S。也就是说，每个可观察的 Subject[S] 本身就是一个 S。

这对于观察者模式来说是合理的——它是可观察的主体本身应该具有注册和通知方法，因此与 S 的观察者一致的主体应该本身就是一个 S。

# c# - 一次对 SyntaxTree 进行多次修改

> ID：13435168
> 
> 赞同：8
> 
> 时间：2012-11-17T21:56:38.423
> 
> 标签：c#, .net, roslyn

我想一次对 Roslyn 语法树进行几处修改，全部围绕同一代码区域

```
tree = tree.ReplaceNodes(oldNode, newNode).RemoveNode(toRemove); 
```

但是，只有第一次修改成功。似乎第一个更改更改了它周围的所有节点，因此该`RemoveNodes`方法不再`toRemove`在结果树中找到。我真的，真的，不想重新做工作以`toRemove`在新树中重新计算，并且使用单个 SyntaxRewriter 来执行所有工作（覆盖`DefaultVisit`方法）非常慢。

我怎样才能做我想做的事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T00:49:32.130

在我提供一些替代方案之前，您对 SyntaxRewriter “慢得离谱”的评论有点令人惊讶。当您说“慢”时，您的意思是“要编写很多代码”还是“性能非常糟糕”？这是进行多次替换的最快（执行时间）方法，并且 ReplaceNodes 和 RemoveNode 在内部都使用重写器。如果您遇到性能问题，请确保在实现 DefaultVisit 时，仅当您感兴趣的节点位于调用它的节点下时才访问子类型。简单的技巧是比较跨度并确保传递的节点的跨度与您正在处理的节点相交。

无论如何，SyntaxAnnotations 提供了一种有用的方法来在修改后定位树中的节点。您可以只创建该类型的实例，然后使用 WithAdditionalAnnotations 扩展方法将其附加到节点。您可以使用 GetAnnotatedNodesOrTokens 方法再次定位该节点。

因此，解决您的问题的一种方法是注释您的 toRemove，然后当您调用 ReplaceNodes 时，在同一个调用中执行两次替换 - 一次执行 oldNode -> newNode 替换，然后一个执行 toRemove -> toRemoveWithAnnotation 替换。然后在结果树中找到带注释的节点并调用 RemoveNode。

如果您知道 oldNode 和 toRemove 不是彼此的祖先（即它们在树的不相关部分中），另一种选择是颠倒排序。获取 toRemove 的父节点（称为 oldNodeParent）并调用 RemoveNode，这意味着您将获得更新的父节点（称为 oldNodeParentRewritten）。然后，调用 ReplaceNodes 进行两次替换：oldNode -> newNode 和 oldNodeParent -> oldNodeParentRewritten。无需注释。

# python - 保存信号处理程序返回的变量？

> ID：13435171
> 
> 赞同：0
> 
> 时间：2012-11-17T21:56:52.013
> 
> 标签：python, textview, pygtk, gtktreeview, signal-handling

我正在使用 PyGTK 2 在 Python 2.7 中编写应用程序。基本上我创建 TreeView 小部件，用内容填充它，然后检查选择是否更改。如果是真的，我希望在 TextView 框中打印选择。我的想法是获取选定的值、更新文本和刷新小部件。这是我获得所选值的方式：

定义：

```
class SomeClass:
    def __init__(self):
        ...
        someTextView = build_textview("some text")
        ...
        tree_selection = someTreeView.get_child().get_selection()
        tree_selection.connect("changed", self.selection_changed())
        ...

    # Signal handler: 
    def selection_changed(self, widget, data=None):
        (model, pathlist) = widget.get_selected_rows()
        for path in pathlist :
            tree_iter = model.get_iter(path)
            value = model.get_value(tree_iter,0)
            return value 
```

如您所见， selection_changed 处理程序返回值。问题是在调用处理程序后如何保存该值？我知道我可以使用全局变量或类属性，但这不是一个选项。我希望代码看起来整洁。即这样：

```
tree_selection.connect("changed", value=self.selection_changed()) 
```

但当然它不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:14:58.380

信号处理程序*返回值*没有意义，将它返回到哪里？

信号处理程序应该是一个类的方法，其中将值存储为属性是有意义的，即：

```
class SomeClass:
    def __init__(self):
        self.value = None
        ...
        someTextView = build_textview("some text")
        ...
        tree_selection = someTreeView.get_child().get_selection()
        tree_selection.connect("changed", self.selection_changed)
        ...

    def selection_changed(self, widget, data=None):
        (model, pathlist) = widget.get_selected_rows()
        for path in pathlist :
            tree_iter = model.get_iter(path)
            value = model.get_value(tree_iter,0)
            this.value = value
            return 
```

笔记：

*   `__init__`方法声明值属性
*   在 connect 方法更改`self.selection_changed()`中，`self.selection_changed`因此您传递方法本身而不是方法的结果。
*   `selection_changed`方法将值存储在属性中并且不返回任何内容。

希望能帮助到你。

**更新**

如果你仍然觉得你的代码如果明确显示它存储值的位置会更好看，你可以做这样的事情：

```
def __init__(self):
    self.value = None
    ...
    someTextView = build_textview("some text")
    ...
    def selection_changed_handler(widget, data):
        value = self.selection_changed(widget, data)

    tree_selection = someTreeView.get_child().get_selection()
    tree_selection.connect("changed", selection_changed_handler)
    ... 
```

但我认为第一个是标准方法。

# typescript - TypeScript – 什么是“导出导入”？

> ID：13435175
> 
> 赞同：8
> 
> 时间：2012-11-17T21:57:16.553
> 
> 标签：typescript, obsolete

[显然](http://typescript.codeplex.com/SourceControl/changeset/a8e13a9837ee)，你可以在 TypeScript 中说 'export import xx = module("xx")'。

但是，这是什么意思？我在规范中没有看到。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-17T22:46:30.180

良好的观察力。

这是一种组合技术，它使整个导入的模块就像在封闭模块中创建的外部模块一样。这是一个简短的示例：

```
module MyModule {
    export class MyClass {
        doSomething() {

        }
    }
}

declare module EnclosingModule {
    export import x = module(MyModule);
}

var y = new EnclosingModule.x.MyClass(); 
```

export 关键字本身使模块成为外部模块。在这种情况下，它正在制作`MyModule`封闭模块的外部模块，即使它最初不是在封闭模块内部定义的。

为什么？

我想这是一种重用模块的便捷方式，而不是在不同的上下文中重复它们 - 使它们可以在多个看起来合乎逻辑的地方访问。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-07T21:53:29.317

从 0.8.1.1 开始，当您导出扩展在其他模块中声明的类的类时，您显然需要使用此语法。

例如，在 0.8.1 中，您可以这样说：

```
import mUiBase = module("../UiBase");

export class BaseViewModel extends mUiBase.UiBase {
} 
```

但是在 0.8.1.1 中，这会给您一个错误“导出的类从私有模块扩展类”，因此您需要这样做：

```
export import mUiBase = module("../UiBase");

export class BaseViewModel extends mUiBase.UiBase {
} 
```

大概这是故意的，而不仅仅是一个错误。

# c - 解析 tar 标头时值错误

> ID：13435178
> 
> 赞同：1
> 
> 时间：2012-11-17T21:57:58.980
> 
> 标签：c, tar

我正在尝试对 tar 函数进行编程，但我遇到了一些问题。我想读取我的 tar 文件并解析头数据。这是我的结构

```
struct header { 
    char nom[100];
    char droits[3];
    char taille[12];
    char date_modif[12];
    char type[1];
}; 
```

现在我的代码来解析标题数据：

```
while ( fread(head.nom, 100, 1, archive) != 0 ){

    printf("NOM : %s\n", head.nom);

    //droits
    fread(head.droits, 3, 1, archive);

    printf("DROITS : %s\n", head.droits);

    //taille
    fread(head.taille, 12, 1, archive);

    printf("TAILLE : %s\n", head.taille);

    //last modif
    fread(head.date_modif, 12, 1, archive);

    printf("MODIF : %s\n", head.date_modif);

    //type
    fread(head.type, 1, 1, archive);

    printf("TYPE : %s\n", head.type);

    printf("NOM : %s\n", head.nom);

    exit(1);
    // on se place a la fin du premier fichier
    fseek(archive, oct2dec(atoi(head.taille)), SEEK_CUR);

    //fprintf(stdout, "%s %d \n", head.nom, oct2dec(atoi(head.taille)));        

    i++;
} 
```

结果是：

```
NOM : a.txt...............................................................................................
DROITS : 664
TAILLE : 936.........
MODIF : 1352910882..
TYPE : 1
NOM : a.txt...............................................................................................664936.........1352910882..1 
```

我的问题是最后一行显示了我的所有数据，而我只想显示 a.txt.... （就像第一行一样）。我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:09:40.267

这是缓冲区溢出问题。您应该增加 的大小`nom`以便能够容纳空字符。我不知道 tar 函数，但是一个例子，

```
struct header { 
    char nom[200];
    char droits[10];
    char taille[20];
    char date_modif[20];
    char type[5];
}; 
```

您应该始终将 char 字符串的大小声明为比最大预期长度大 1 以允许空字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:10:02.093

例如，您可以将 printf 显示的字符串长度限制为 10

```
printf("NOM : %.10s\n", head.nom); 
```

有关 printf 格式字符串的更多信息，请参见`man 3 printf`

# mysql - 将数据存储在 blob 中与存储指向文件的指针有什么区别？

> ID：13435187
> 
> 赞同：29
> 
> 时间：2012-11-17T21:58:57.860
> 
> 标签：mysql, blob, sqldatatypes

`blob`我对MySQL 中的数据类型有疑问。

我读到该数据类型可用于存储文件。我还读到另一种方法是将文件存储在磁盘上并包含指向其在数据库中位置的指针（通过 varchar 列）。

但我有点困惑，因为我读过 blob 字段没有存储在行内，需要单独查找来检索其内容。那么这与在文件系统上存储指向文件的指针有什么不同吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-17T22:38:49.027

> 我读到该数据类型可用于存储文件。

根据Blob 上的[MySQL 手册](http://dev.mysql.com/doc/refman/5.0/en/blob.html)页，A`BLOB`是一个二进制大对象，可以容纳可变数量的数据。

由于它是一种特定于存储二进制数据的数据类型，因此通常使用它来以二进制格式存储文件，存储图像文件在 Web 应用程序中非常常见。

对于 Web 应用程序，这意味着您首先需要将文件转换为二进制格式，然后将其存储，并且每次需要检索文件时，您都需要执行将它们转换回原始格式的相反过程。

除此之外，在您的数据库中存储大量数据**可能**会减慢它的速度。特别是在不仅仅用于托管数据库的系统中。

> 我还读到另一种方法是将文件存储在磁盘上并包含指向其在数据库中的位置的指针

牢记以上所有考虑因素，Web 应用程序的常见做法是将文件存储在 MySQL 以外的其他位置，然后简单地将其路径存储在数据库中。在处理大量数据时，这种方法**可能会加速您的数据库。**

> 但我有点困惑，因为我读过 blob 字段没有存储在行内，需要单独查找来检索其内容。

实际上，这取决于您使用的存储引擎，因为每个引擎都处理数据并以不同的方式存储它。对于适用于关系数据库的 InnoDB 引擎，您可能需要阅读[MySQL 性能博客](http://www.mysqlperformanceblog.com/2010/02/09/blob-storage-in-innodb/)中关于 blob 如何存储在 MySQL 中的这篇文章。

但抽象地说，在 MySQL 5 及更高版本上，blob 存储如下：

> Innodb 将整个 blob 存储在行页面上或仅 20 字节的 BLOB 指针优先存储在页面上的较小列，这是合理的，因为您可以存储更多它们。

所以你现在可能在想，正确的做法是将它们存储为单独的文件，但是使用 blob 存储数据有一些优点，第一个（在我看来）是备份。我管理着一台小型服务器，我不得不创建另一个子例程，只是为了将作为路径存储的文件复制到另一个存储磁盘（我们买不起像样的磁带备份系统）。如果我将我的应用程序设计为使用 blob `mysqldump`，那么备份整个数据库所需的一切都将是简单的。

[在这篇文章](https://stackoverflow.com/questions/4654004/mysql-binary-storage-using-blob-vs-os-file-system-large-files-large-quantities)中更好地讨论了为备份存储 blob 的优势，其中回答的人遇到了与我类似的问题。

另一个优点是安全性和易于管理权限和访问。MySQL 服务器中的所有数据都受密码保护，您可以轻松地为用户管理权限，了解谁访问什么，谁不访问。

在依赖 MySQL 权限系统进行身份验证和使用的应用程序中。这肯定是一个加分项，因为假设入侵者从您的磁盘或没有访问权限的用户检索图像（或压缩文件之类的二进制文件）会有点困难。

所以我会这么说

如果您要管理 MySQL 和其中的所有数据并且必须定期备份或打算更改甚至考虑将来更改操作系统，并且拥有不错的硬件并针对它优化了 MySQL，请选择 BLOB。

如果您**不会**管理您的 MySQL（例如在 web 主机中）并且不打算更改操作系统或进行备份，请坚持使用`varchar`指向您的文件的列。

我希望它有所帮助。干杯

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-17T23:15:43.237

如果您将数据存储为 BLOB 字段，那么您就是将其作为对象抽象的一部分。

**BLOB 优势：**

1.  如果您想删除带有 BLOB 的行，或者将其作为主/从表关系的一部分或整个表层次结构删除，您的 BLOB 将自动处理并且与数据库中的任何其他对象具有相同的生命周期。

2.  您的脚本不需要访问任何东西，只需访问数据库即可获得所需的一切。在许多情况下，直接文件访问会打开整个蠕虫病毒，了解如何绕过访问或安全限制。例如，通过文件访问，他们可能必须挂载包含实际文件的文件系统。但是使用数据库中的 BLOB，您只需能够连接到数据库，无论您身在何处。

3.  如果您将其存储在文件中并且文件被替换、删除或不再可访问，您的数据库将永远不会知道 - 实际上，您无法保证完整性。此外，在使用文件时很难可靠地支持多个版本。如果您使用并依赖交易，那几乎是不可能的。

**档案优势：**

1.  一些数据库对 BLOB 的处理相当差。例如，虽然 MySQL 中的官方 BLOB 限制为 4GB，但实际上默认配置仅为 1MB。您可以通过调整客户端和服务器配置以增加 MySQL 命令缓冲区来将其增加到 16-32MB，但这在性能和安全性方面还有很多其他影响。

2.  即使数据库没有一些奇怪的大小限制，与存储文件相比，它在存储 BLOB 方面总是会有一些开销。此外，如果 BLOB 很大，则某些数据库不提供逐个访问 blob 的接口，或者`stream`它，这可能是您工作流程的一大障碍。

最后，这取决于你。我通常会尝试将其保留在 BLOB 中，除非这会产生不合理的性能问题。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-17T23:07:55.167

是的，与行不适合在同一页面中的 MySQL blob 将存储在溢出页面上 请注意，某些 blob 足够小，以至于它们与行的其余部分一起存储，就像任何其他列一样。blob 页面与存储其行的页面不相邻，因此它们可能会导致额外的 I/O 来读取它们。

另一方面，就像任何其他页面类型一样，blob 页面可以占用 InnoDB 缓冲池中的内存，因此即使它们位于单独的页面上，随后读取 blob 也非常快。文件可以由操作系统缓存，但通常是从磁盘读取的。

以下是可能影响您的决定的其他一些因素：

*   Blob 以一行在逻辑上存储。这意味着如果您删除该行，关联的 blob 将被自动删除。但是，如果您将 blob 存储在数据库之外，那么在从数据库中删除行后，您最终会得到孤立的 blob 文件。您必须执行手动步骤来查找和删除这些文件。

*   存储在行中的 Blob 也遵循事务语义。例如，在您提交之前，新的 blob 或更新的 blob 对其他事务是不可见的。您也可以回滚更改。将 blob 存储在数据库外部的文件中会使这变得更加困难。

*   当您备份包含 blob 的数据库时，该数据库当然要大得多，但是当您备份时，您可以一步获得所有数据*和相关联的 blob。*如果在外部存储 blob，则必须备份数据库并备份存储 blob 文件的文件系统。如果您需要确保从某一瞬间捕获数据和 blob，您几乎需要使用某种文件系统快照。

*   如果使用复制，确保 blob 自动复制到复制从属设备的唯一自动方法是将 blob 存储在数据库中。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-17T22:11:44.583

文件系统访问将比通过数据库更快。Blobs 列在索引/排序等方面有一些缺点，如果您希望将来可以使用您的文件名列，您可以这样做。

数据库也可以通过大 blob 快速增长，然后像备份这样的任务变得更慢。我会使用文件系统上的物理存储在数据库中的文件位置。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-17T22:05:25.583

更好的方法是将文件存储在文件系统文件夹中，并通过数据库中的 varchar 字段指向它们的路径。在数据库中保存文件的缺点之一是减慢或降低其性能。

# node.js - 全局安装的 node-dev 导致错误“找不到命令”

> ID：13435188
> 
> 赞同：2
> 
> 时间：2012-11-17T21:58:59.873
> 
> 标签：node.js, npm, node-dev

这样我就不必[在开发过程中不断重新启动 node.js](https://stackoverflow.com/a/6310968/61654)我正在尝试使用[node-dev](https://github.com/fgnass/node-dev)。不幸的是，当我尝试从终端运行 node-dev 时，我收到错误：

> $ node-dev server.js
> -bash: node-dev: 找不到命令

我已经通过`npm install node-dev -g`命令全局安装了 node-dev。此命令的输出是：

```
npm http GET https://registry.npmjs.org/node-dev
npm http 304 https://registry.npmjs.org/node-dev
npm http GET https://registry.npmjs.org/growl
npm http 304 https://registry.npmjs.org/growl
/usr/local/share/npm/bin/node-dev -> /usr/local/share/npm/lib/node_modules/node-dev/node-dev
node-dev@0.2.9 /usr/local/share/npm/lib/node_modules/node-dev
└── growl@1.6.1 
```

为了确保 node-dev 已全局安装，我运行`npm ls -g`了它返回：

```
/usr/local/share/npm/lib
└─┬ node-dev@0.2.9
  └── growl@1.6.1 
```

其他一些帖子表明我全局安装的 npm 模块应该在`/usr/local/lib/node_modules`文件夹中，而不是`/usr/local/share/npm/lib/`. 我不知道这是否适用于旧版本的 npm 或真正重要的东西。

我是 Mac OS X 和 Node 开发的新手，所以我忽略了一些微不足道的事情并不会让我感到惊讶。在尝试使用 node-dev 时，我没有做什么导致“找不到命令”错误？我忽略了某种 $PATH 环境问题吗？

一个注释我没有安装 Growl，但 node-dev 文档表明它是可选的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T07:24:43.043

我认为这可能是您的问题，[这里有一个](http://hadihariri.com/2012/02/26/automating-testing-with-mocha-and-webstorm/)解决它的演练。它专门用于 WebStorm 和 Mocha，但似乎可能是相关的。我认为您可能需要设置别名。

> **env：节点：没有这样的文件或目录**
> 
> 原因是在 MacOSX 下运行 GUI 应用程序时，环境变量与从终端运行 a 时的环境变量不同。特别是，例如节点不在路径上。要克服这个问题，您可以从终端启动 WebStorm（糟糕！）或解决它。幸运的是，这并不像以前那么难。这是我们论坛上的 RubyMine 提示，但它适用于所有 IDE，包括 WebStorm。本质上，它在 ~/.MacOSX 中创建了一个 environment.plist 文件，其中包含您的完整路径。如果你想下载，我的就在这里。确保在执行此步骤后重新启动计算机。
> 
> **设置别名**
> 
> 现在一切都应该工作了，但不必每次都输入这个，让我们在 WebStorm 中为它设置一个别名。单击首选项（CMD+，在 MacOSX 下）并输入命令以访问命令行工具。单击 + 按钮创建新条目并确认对话框以创建新的自定义框架。
> 
> ![在此处输入图像描述](../Images/3e9661d2777bb008a6fdf77f218c0ead.png)

# objective-c - YouTube Objective-C HTTP POST 请求评论

> ID：13435192
> 
> 赞同：1
> 
> 时间：2012-11-17T21:59:28.510
> 
> 标签：objective-c, http, post, youtube, request

我正在尝试通过我的应用程序向 YouTube 视频添加评论，但显然它不起作用。然后我去了 Api v2 站点，看到了这个：

> POST /feeds/api/videos/VIDEO_ID/comments HTTP/1.1
> 主机：gdata.youtube.com
> 内容类型：application/atom+xml
> 内容长度：CONTENT_LENGTH
> 授权：Bearer ACCESS_TOKEN
> GData-Version：2
> X-GData-Key：键=DEVELOPER_KEY

但它没有给我任何回报，也没有发表评论。那么我必须将发布请求发送到哪里，我必须在其中写什么？

到目前为止，这是我的代码：

```
SBJsonParser *parser = [[SBJsonParser alloc] init];

NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];

NSString *requestString = [NSString stringWithFormat:@"<?xml version='1.0' encoding='UTF-8'?><entry xmlns='http://www.w3.org/2005/Atom'xmlns:yt='http://gdata.youtube.com/schemas/2007'><content>%@</content></entry>", [textField text]];

NSData *postData = [requestString dataUsingEncoding:NSASCIIStringEncoding allowLossyConversion:YES];
NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];
NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];

[request setURL:[NSURL URLWithString:@"https://gdata.youtube.com/feeds/api/videos/FejWBVt7jtk/comments"]];
[request setHTTPMethod:@"POST"];
[request setValue:postLength forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/atom+xml" forHTTPHeaderField:@"Content-Type"];
[request setValue:[NSString stringWithFormat:@"Bearer %@", [defaults objectForKey:@"accessToken"]] forHTTPHeaderField:@"Authorization"];
[request setValue:@"key=DEVELOPER KEY" forHTTPHeaderField:@"X-GData-Key"];

[request setHTTPBody:postData];

NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:nil error:nil];

NSString *content = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];

NSDictionary *dict = [parser objectWithString:content];
NSLog(@"%@", dict); 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:19:16.760

不完全确定您的问题是什么，但使用[Google 的 Objective-C 库](http://code.google.com/p/google-api-objectivec-client/)可能会更好。

# dynamics-crm-2011 - 当按下功能区按钮时，我如何知道哪个表单控件具有焦点？

> ID：13435199
> 
> 赞同：3
> 
> 时间：2012-11-17T22:00:09.077
> 
> 标签：dynamics-crm-2011, dynamics-crm-online

有一个自定义 JS 函数，当在表单上下文中按下功能区按钮时调用该函数。在我的自定义 JS 函数中，我需要知道在按下功能区按钮之前哪个表单字段具有焦点。我尝试了两种方法（如下）但没有成功。有没有办法可靠地做到这一点？

方式#1

据此[，](http://msdn.microsoft.com/en-us/library/gg309332.aspx)我可以得到我想要作为参数传递给我的 JS 的控件。我试过同时使用`PrimaryControlId`和`PrimaryControl`参数。

```
<JavaScriptFunction FunctionName="OnCustomBtnFunc" 
                    Library="$webresource:myJSfile.js">
   <CrmParameter Value="PrimaryControlId" />
   <CrmParameter Value="PrimaryControl" />
</JavaScriptFunction> 
```

对于这两者，我得到一个传递给 OnCustomBtnFunc() 的对象，但它似乎无法让我确定在按下功能区按钮之前哪个表单控件具有焦点。

方式#2

我打电话给[Xrm.Page.ui.getCurrentControl()](http://msdn.microsoft.com/en-us/library/gg327828.aspx#BKMK_getCurrentControl)。这适用于某些类型的表单字段，但不适用于其他类型，例如，如果它是一个字符串字段，它可以工作，但我得到 null 进行查找。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-19T14:55:41.347

您不会喜欢这个答案，但您可以使用 JQuery 快速获取表单中的每个控件并为其分配一个 OnBlur 事件。此事件可以将 ID 或控件本身分配给全局变量，您将可以访问您的功能区（从不同的范围触发）。

人们不喜欢这种方法，因为变量的上下文范围不同，并且因为它涉及使用纯 HTML 的“不支持”特性。但是，如果您只问“如何”而不是“我们应该”，那么这是“如何”执行此操作的简单方法。

# assembly - 汇编语言蛮力

> ID：13435202
> 
> 赞同：2
> 
> 时间：2012-11-17T22:00:31.033
> 
> 标签：assembly, brute-force, motorola, 68000

所以我正在编写一个汇编语言程序来确定封闭圆柱形罐的最佳尺寸，例如用于罐装食品的那些。有三个输入变量，我已经在汇编语言代码中创建了微积分部分：

最终材料的成本以美元/cm2 为单位。

边料成本以美元/cm2计。

罐的体积，以毫升为单位。

给定这三个输入变量，我已经确定了罐子的尺寸（高度和直径），以使罐子的成本最小化。`do`我再次提出了解决这个程序的微积分部分，但很好奇使用or`while`循环的蛮力会是什么样子。如何创建一种蛮力，产生与微积分答案几乎相同的输出，例如：

```
Enter the cost of end material per square cm: 
.001
Enter the cost of the side material per square cm: 
.003
Enter the desired volume in milliliters: 
100

Calculus Answer:

Can cost:  0.24
Diameter:  7.25
Height:    2.41  

Brute Force Answer:

Can cost:  0.24
Diameter:  7.25
Height:    2.41 
```

我提出的导致微积分答案输出的微积分部分是：

```
********** CONSTANTS **********
TWO:           EQU    $40000000        
PI:            EQU    $40490FDA
ONE_THIRD:     EQU    $3EAAAAAb
START_R:       EQU    $3C23D70A
*******************************

start:  initIO                  * Initialize (required for I/O)
        initF
        setEVT
        lineout  p1
        floatin  buffer
        cvtaf    buffer,D5   * END cost
        lineout  p2
        floatin  buffer
        cvtaf    buffer,D6   * SIDE cost
        lineout  p3
        floatin  buffer
        cvtaf    buffer,D7   * VOLUME

**********************************************************************
** Calculus Answer
** Formula for the radius of the optimum can:
** radius = (((volume*side_cost)/(2*PI*end_cost))^(1/3)      

** numerator, volume*side_cost:
        move.l      D7,D1       * VOLUME
        fmul        D6,D1       * VOLUME*SIDE_COST 

** denominator, 2*PI*end_cost        
        move.l      D5,D2       * END_COST
        fmul        #TWO,D2     * END_COST * 2.0
        fmul        #PI,D2      * END_COST * 2.0 * PI

** now take result to 1/3 power
        fdiv        D2,D1        * numerator/denominator
        move.l      #ONE_THIRD,D0              
        fpow        D1,D0       *(numerator/denominator) ^ (1/3)

** Calulus answer done, now calculate diameter, height, cost
        move.l      D0,D1       * D1 has radius
        fmul        #TWO,D0     * D0 has diameter        
        cvtfa       diameter,#2

** calculate height = (volume / PI*r^2)
        move.l      D1,D2       * radius
        fmul        D2,D2       * radius^2
        fmul        #PI,D2      * radius^2*PI
        move.l      D7,D3       * copy of volume
        fdiv        D2,D3       * vol / PI*radius^2  HEIGHT --> D3
        move.l      D3,D0      
        cvtfa       height,#2

** calculate cost = SIDE_COST*SIDE_SURFACE + 2*END_COST*END_SURFACE
        *** side cost:
        move.l      #PI,D2
        fmul        #TWO,D2     * 2*PI
        fmul        D1,D2       * 2*PI*radius
        fmul        D3,D2       * 2*PI*radius*height  = side surface area
        fmul        D6,D2       * side surface area * SIDE_COST

        *** end cost:
        move.l      #PI,D0
        fmul        #TWO,D0     * 2*PI
        fmul        D1,D0       * 2*PI*radius
        fmul        D1,D0       * 2*PI*radius*radius
        fmul        D5,D0       * 2*PI*radius*radius*END_COST
        fadd        D2,D0
        cvtfa       cost,#2

** DONE, print the  calculus answer

        lineout     ans1
        lineout     ans2
        lineout     ans3 
```

如果有人想使用如下所示的“do”或“while”循环为该程序创建一个蛮力，那会怎样。有人能帮我吗。

```
radius = 0.01
lastCost = Calculate

do:
    radius = radius+0.01
    newCost = Calculate
    if(newCost  lastCost)
        goto print
    lastCost = newCost
    goto loop
print lastcost 
```

**只是好奇这种蛮力方法可能是什么样子，我很确定它基本上是相同的代码，只是添加了几行代码。我只想知道我可以在哪里添加这些代码行。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T23:59:07.957

假设您有一个范围（最初是 0 到最大值）并在此范围内（包括最小值和最大值）等距离选择 N 个点。在这 N 个点中找到价格最优的点，其左右两侧的点成为新的范围（如果是旧的最小值或最大值，则为点本身）。当然，当你达到所需的精度时，你会停下来，不管那是什么。

对于您的情况，“N = 4”就足够了；并且您可以记住上一次迭代的值（例如，使用“N = 4”，您每次迭代只需计算 2 个点，因为您已经知道最小值和最大值的值）。对于 N = 4，每次迭代的范围将减少 25%，并且在 17 次迭代之后，范围将小于原始范围的 1%（并且您只会计算 36 个价格）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:22:49.347

好吧，如果我对您的理解正确，您只需要计算高度和宽度的所有组合并采用最低成本。这里的问题是找到一个包含最佳答案的区间，以及一个对您当前问题可行的步长（否则您将有太多的可能性）您还需要使用 height*width²*pi = 固定体积来设置侧面条件，因为如果体积较小（可能由某些组合发生），那么成本也会更小

# php - Zend 框架 2 debug_backtrace()

> ID：13435206
> 
> 赞同：0
> 
> 时间：2012-11-17T22:00:55.907
> 
> 标签：php, zend-framework2, debug-backtrace

我很难使用 ZF2，因为我不能像正常使用它那样使用 debug_print_backtrace()。

它向我展示了来自 Zend\Mvc\MvcEvent 对象的大量数据。输出看起来像这样：

```
#1  Zend\Mvc\Controller\AbstractActionController->onDispatch(Zend\Mvc\MvcEvent Object ( .... A LOT OF DATA
,[SERVER_SOFTWARE] => Apache/2.2.20 (Ubuntu),[SERVER_NAME] => zf.localhost.com,[SERVER_ADDR] => 127.0.0.1,[SERVER_PORT] => 80, .... SOME SERVER PARAMETERS
Apache/2.2.20 (Ubuntu) Server at zf.localhost.com Port 80
... 
```

有没有办法不显示所有这些 MvcEvent 内容但仍然看到带有参数的回溯？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T11:33:56.087

你有安装 XDebug 吗？我发现 XDebug 在调试 ZF2 问题时非常有用，因为您可以使用 var_dump 和其他一些命令来限制显示的对象深度。

可以在[http://xdebug.org/docs/display找到这方面的示例和更多信息](http://xdebug.org/docs/display)

然后，您可以使用`var_dump(debug_backtrace())`不太详细的输出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T22:03:21.080

如果您只是想删除第一行（即 MvcEvent），请记住 - debug_backtrace() 返回一个数组。没有什么能阻止您转移或弹出您不想要的数据！

（array_shift() - 删除数组的第一个元素。array_pop() - 删除最后一个元素。在这些情况下它们非常方便:-)）

# .net - 将 ColdFusion 计划作业转换为 .net

> ID：13435207
> 
> 赞同：0
> 
> 时间：2012-11-17T22:01:02.873
> 
> 标签：.net

下面是对在 ColdFusion 中运行计划作业非常有效的系统的描述。如果你要在 .net 中构建一些至少和它一样好的东西，如果不是更好的话，你会怎么做？请注意，我正在寻找概念、想法和结构——而不是代码。

我们目前对 ColdFusion 中的计划作业有一个“即插即用”的概念。代替几十个单独的预定作业，有一些预定作业容器。在 ColdFusion 中实际调度的是容器。每个容器都计划在一天中的不同时间运行。开发人员根据他们希望他们的工作运行的时间将他们的个人工作插入最合适的容器中。容器文件的名称类似于 ScheduledJobs_0600.cfm。它们位于 Web 浏览器无法访问的目录中。每个都有一个单独的日志文件。

一旦准备好安排单个作业，开发人员将其插入到容器文件中，如下所示：

翻译为每月的第 5 天，ColdFusion 文件 /DWsystem/jobs/AdultPsych.cfm 将运行。

cf_RunJob 是一个 ColdFusion 自定义标签。它 • 尝试运行该作业。• 如果成功，则会将一行写入日志文件，指示作业何时开始以及运行所需的毫秒数。• 如果不成功，catch 块将错误消息写入日志文件

try/catch 方法可以防止一个编码错误阻止后续的单个作业运行。

还有另外两个计划的作业，看看其他作业的进展情况。具体来说，他们读取日志文件中的最新条目并查找错误。如果找到，则该特定文件中的所有日常事件都会通过电子邮件发送到某些地址组。当事情不顺利时，还有两个网页可供跟进。一个列出所有“容器”作业，并允许用户运行其中的任何一个或全部。容器作业是硬编码的，但由于它们位于同一目录中，因此可以通过编程方式获取它们。

第二页稍微详细一点。它读取所有容器文件和所有日志文件。然后向用户显示所有单个作业的列表，每个作业都带有一个复选框。任何在前一次尝试中失败的作业都会预先选中该复选框。还显示了每个作业的执行时间。提交表单时，每个选定的作业都使用 cf_RunJob 标记运行。

你会如何在.net中做到这一点？

# c++ - cv::Mat 到 QImage 的奇怪行为

> ID：13435210
> 
> 赞同：0
> 
> 时间：2012-11-17T22:02:01.443
> 
> 标签：c++, qt, opencv, qimage

我正在使用（[如何将 opencv cv::Mat 转换为 qimage](https://stackoverflow.com/questions/5026965/how-to-convert-an-opencv-cvmat-to-qimage)`cv::Mat` ）中建议的代码在我的 Qt 应用程序中显示 a 。但是，我得到了奇怪的结果。黑色部分显示为黑色，但所有其他值都被反转。

转换代码：

```
QImage ImgConvert::matToQImage(Mat_<double> src)
{
    double scale = 255.0;

    QImage dest(src.cols, src.rows, QImage::Format_ARGB32);
    for (int y = 0; y < src.rows; ++y) {
            const double *srcrow = src[y];
            QRgb *destrow = (QRgb*)dest.scanLine(y);
            for (int x = 0; x < src.cols; ++x) {
                    unsigned int color = srcrow[x] * scale;
                    destrow[x] = qRgba(color, color, color, 255);
            }
    }
    return dest;
} 
```

显示代码：

```
void MainWindow::redraw()
{
    static QImage image = ImgConvert::matToQImage(im);

    static QGraphicsPixmapItem item( QPixmap::fromImage(image));
    static QGraphicsScene* scene = new QGraphicsScene;
    scene->addItem(&item);

    ui->graphicsView->setScene(scene);
    ui->graphicsView->repaint();
} 
```

现在我正在使用`if(color>0) color = 255-color;`来纠正这种效果，但我更愿意了解它的来源。

另外，第二个小问题：如果我删除 中的`static`声明`redraw()`，当方法退出时，图像会立即从内存中删除。这是解决此问题的最佳方法吗？如果我显示多个帧，是否会产生任何意外的副作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T00:27:00.153

我不知道。对我来说，首先设置一个数组听起来像是一种更简洁的方式，请参阅[https://stackoverflow.com/a/3387400/1705967](https://stackoverflow.com/a/3387400/1705967)，这可以给你一些想法。

虽然我也使用 Ypnos 的解决方案在彩色图像上取得了巨大成功。:)

啊，关于第二个问题，不要担心QPixmap。正如我所经历的那样，它使图像数据私有（必要时克隆），因此您不会错误地覆盖它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T01:41:23.797

万一有人遇到这个问题，我通过将像素值减去来快速而肮脏地修复它`256`：

```
QImage ImgConvert::matToQImage(Mat_<double> src)
{
    double scale = 255.0;

    QImage dest(src.cols, src.rows, QImage::Format_ARGB32);
    for (int y = 0; y < src.rows; ++y) {
            const double *srcrow = src[y];
            QRgb *destrow = (QRgb*)dest.scanLine(y);
            for (int x = 0; x < src.cols; ++x) {
                    unsigned int color = 256 - (srcrow[x] * scale);
                    destrow[x] = qRgba(color, color, color, 255);
            }
    }
    return dest;
} 
```

但是，这会稍微损坏图像，将其亮度修改为 1。我的目的是可视化，因此肉眼可以忽略不计，但是对于图像处理中的某些应用程序，这种损坏可能是至关重要的。我不知道为什么会发生这种情况，因为我很着急，所以我没有再看下去。

# javascript - jquery mobile 没有实现样式

> ID：13435214
> 
> 赞同：1
> 
> 时间：2012-11-17T22:02:14.453
> 
> 标签：javascript, jquery, html, jquery-ui, jquery-mobile

我创建了一个简单的移动网页，我不知道为什么，但我创建的按钮不像这个[链接](http://jquerymobile.com/test/docs/buttons/buttons-icons.html)那样风格化。这是代码：

```
<!DOCTYPE HTML>
<html>
<head>
    <meta name="viewport" content = "width=device-width ,  user-scalable=no">
    <meta http-equiv="Content-type" content="text/html; charset=utf-8">

    <link type="text/css" href="jquery.mobile/jquery.mobile-1.1.0.css"/>
    <link type="text/css" href="themes/theme.min.css"/>
    <link type="text/css" href="CSS/main.css"/>

    <script type="text/javascript" src="cordova/cordova-2.2.0.js"></script>
    <script type="text/javascript" src="jquery/jquery-1.8.3.js"></script>
    <script type="text/javascript" src="jquery.mobile/jquery.mobile-1.1.0.js"></script>

    <title>page</title>
</head>

<body>
    <div data-role="page">
        <div data-role="content">
            <a href="index.html" data-role="button" data-icon="delete">Delete</a>
        </div>
    </div>
</body>

</html> 
```

我哪里错了？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:09:52.873

确保您的本地库可用并且路径正确...请参阅最新库的
[工作示例](http://jsfiddle.net/5pt6b/)

```
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Test</title>
  <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
  <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
  <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
</head>

<body>
    <div data-role="page">
        <div data-role="content">
            <a href="index.html" data-role="button" data-icon="delete">Delete</a>
        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:11:18.667

我相信问题出在您的样式表链接上。您需要包含`rel="stylesheet"`而不是设置`type`。

例如

`<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css"/>`

# android - 使用 Virgin Mobile Chaser 手机进行测试

> ID：13435215
> 
> 赞同：1
> 
> 时间：2012-11-17T22:02:20.473
> 
> 标签：android, testing, device

我刚刚购买了一部 Virgin Mobile “Chaser” Android 手机，以便用真机测试我的应用程序。我无法让 Eclipse（在我的 Windows 7 系统上运行）查看手机。

我：

*   放入`android:debuggable="true"`我的清单文件中。
*   在手机上启用USB调试。
*   安装了`Chaser_Driver_Setup_V1.2.1`.

手机在设备管理器中显示为`android Composite ADB Interface`。

该条目的驱动程序详细信息是：

*   `C:\Windows\system32\drivers\winusb.sys`
*   `C:\Windows\system32\WdfCoInstaller01007.dll`
*   `C:\Windows\system32\WinUSBCoInstaller.dll`

当我安装 Chaser 驱动程序时，安装了最后两个驱动程序（我怀疑）。

Eclipse 看不到该设备。

`adb devices`当我从`android-sdk\platform-tools directory`没有列出任何内容运行命令提示符时。

PS：如果这个论坛的管理员觉得这个问题不合适，请告诉我应该在哪里发布？谢谢。

加里

# python - 是否可以将 google 模块从其 /lib 复制到 python27/lib？

> ID：13435216
> 
> 赞同：0
> 
> 时间：2012-11-17T22:02:23.540
> 
> 标签：python, export, remote-access, google-cloud-datastore

我在 localhost 和 ceemee11111.appspot.com 上运行了留言簿应用程序，但是当我尝试从 python 运行 remote-api 时，找不到一些模块。我希望从 python 运行与从谷歌运行相同的模块。

所以我已经安装了 pip 应用程序并尝试运行

```
$ pip freeze -E [env1] > requirements.txt 
```

在 google /lib 中并得到“拒绝访问”错误。如果有人有这方面的经验，我将不胜感激。根据我的阅读，我运行

```
$ pip freeze -E [env1] > requirements.txt 
```

在 google /lib 目录中，然后运行

```
$ pip install -E [env2] -r /path/to/requirements.txt 
```

在 python /lib 目录中。

# html - 按 T ab 时跳过输入

> ID：13435217
> 
> 赞同：46
> 
> 时间：2012-11-17T22:02:28.273
> 
> 标签：html

我有一个表单，其中有三个输入框，旁边有三个下拉选择标签。我希望能够按 Tab 键并从一个输入转到另一个，但是您必须按两次，因为它会进入输入框之后的下拉菜单。有没有一种方法可以让它“跳过”下拉菜单并在您按 Tab 时直接进入下一个输入框？

* * *

## 回答 #1

> 赞同：162
> 
> 时间：2012-11-17T22:31:03.347

`tabindex=0`当其他输入的 tabindex 值大于零时，属性使输入可跳过。

`tabindex="-1"`完全可以`input`跳过

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-11-17T22:03:45.167

[`[tabindex]`您可以通过设置属性](http://dev.w3.org/html5/spec/editing.html#sequential-focus-navigation-and-the-tabindex-attribute)显式指定跳格顺序：

[没有`[tabindex]`：]

```
<input type="text" />     <!-- first -->
<input type="checkbox" /> <!-- second -->
<select>...</select>      <!-- third --> 
```

[与`[tabindex]`：]

```
<input type="text" tabindex="1" />      <!-- first -->
<input type="checkbox" tabindex="3" /> <!-- third -->
<select tabindex="2">...</select>      <!-- second --> 
```

# javascript - 在 CoffeScript 中为外部范围定义类

> ID：13435225
> 
> 赞同：1
> 
> 时间：2012-11-17T22:04:20.937
> 
> 标签：javascript, coffeescript

[这是我之前的问题Javascript: ReferenceError: MyClass is not defined](https://stackoverflow.com/questions/13435029/javascript-referenceerror-myclass-is-not-defined)的后续。

将此转换为 .js 的 .coffee 文件将`MyClass`在其范围内创建一个可用的文件。

```
class MyClass
    name: (name) -> 
```

CoffeScript 中有没有办法使该类可用于外部范围？我应该能够`<script src..`将文件放在 HTML 页面上并从控制台实例化该类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:21:58.147

不管你怎么做，你都会“污染全球范围”。这只是你如何做的问题。

CoffeeScript 中的`@`符号用于表示“这个范围”。因此，您甚至可以在 Class 定义中使用它。类声明的结果是该类是在`window`对象的范围内定义的（除非有其他一些情况，但这不太可能在您在此处描述的内容中）。

```
class @CustomClassName
    constructor: -> 
        # constructor stuff goes down... 
```

* * *

但是，我个人更喜欢使用命名空间来执行此操作。想想`google.maps.Map`或者你是否曾经写过 Actionscript 3: `flash.display.MovieClip`。

在您的 CoffeeScript 文件的顶部放置类似以下内容的内容：

```
window.customnamespace = window.customnamespace || {} 
```

现在，当您创建课程时，您可以说：

```
class customnamespace.ClassName
    constructor: (container) ->
        # set the container
        @container = container
        # etc...

class customnamespace.OtherClassName
    constructor: ->
        # Another class... 
```

在您的`document.ready`（如果您使用 jQuery）中，您将可以全局访问该命名空间及其所有类。

例子：

```
$(document).ready(function(e) {
    var c = new customnamespace.ClassName($('#container'));

    var other = new customnamespace.OtherClassName(); 
```

有道理？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:09:45.913

[这个 stackoverflow](https://stackoverflow.com/questions/4214731/coffeescript-global-variables)提供了一个非常全面的使用咖啡脚本创建全局对象的概述，其中包括一些非常好的示例。

对于此示例，咖啡脚本：

```
window.MyClass = class MyClass
    name: (name) -> 
```

将编译为：

```
var MyClass;

window.MyClass = MyClass = (function() {

  function MyClass() {}

  MyClass.prototype.name = function(name) {};

  return MyClass;

})(); 
```

这将给出与您之前问题的答案相同的行为。

# wordpress - 使用 WordPress 的 Walker_Nav_Menu 在父 li 的 div 中添加子菜单

> ID：13435226
> 
> 赞同：4
> 
> 时间：2012-11-17T22:04:23.760
> 
> 标签：wordpress, menu

我正在尝试将子菜单项添加到父 li 的 div 内部。

这是我得到的...

```
<nav class="menu-main-menu-container">
<ul id="nav" class="">
    <li id="menu-item-26" class="visit menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-24 current_page_item">
        <div>
            <a title="Locations | Traditions" href="#">Visit</a>
            <span>Locations | Traditions</span>
            <div class="arrow"></div>
        </div>
        <div class="main_sub_nav_wrap">
            <h2>Visit</h2>
        </div>
        <ul class="sub-menu">
            <li id="menu-item-82" class="menu-item menu-item-type-custom menu-item-object-custom">
                <a href="#">Sub Link 1</a>
            </li>
            <li id="menu-item-83" class="menu-item menu-item-type-custom menu-item-object-custom">
                <a href="#">Sub Link 2</a>
            </li>
            <li id="menu-item-84" class="menu-item menu-item-type-custom menu-item-object-custom">
                <a href="#">Sub Link 3</a>
            </li>
        </ul>
    </li>
</ul> 
```

我想要的是让它像这样放入“main_sub_nav_wrap”。

```
<nav class="menu-main-menu-container">
<ul id="nav" class="">
    <li id="menu-item-26" class="visit menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-24 current_page_item">
        <div>
            <a title="Locations | Traditions" href="#">Visit</a>
            <span>Locations | Traditions</span>
            <div class="arrow"></div>
        </div>
        <div class="main_sub_nav_wrap">
            <h2>Visit</h2>
            <ul class="sub-menu">
                <li id="menu-item-82" class="menu-item menu-item-type-custom menu-item-object-custom">
                    <a href="#">Sub Link 1</a>
                </li>
                <li id="menu-item-83" class="menu-item menu-item-type-custom menu-item-object-custom">
                    <a href="#">Sub Link 2</a>
                </li>
                <li id="menu-item-84" class="menu-item menu-item-type-custom menu-item-object-custom">
                    <a href="#">Sub Link 3</a>
                </li>
            </ul>
        </div>
    </li>
</ul> 
```

这是我通过扩展 walker 类来制作导航的内容......

```
<?php
class My_Walker extends Walker_Nav_Menu {
  function start_el(&$output, $item, $depth, $args) {
     global $wp_query;
     $indent = ( $depth ) ? str_repeat( "\t", $depth ) : '';

     $class_names = $value = '';

     $classes = empty( $item->classes ) ? array() : (array) $item->classes;

     $class_names = join( ' ', apply_filters( 'nav_menu_css_class', array_filter( $classes ), $item ) );
     $class_names = ' class="' . esc_attr( $class_names ) . '"';

     $output .= $indent . '<li id="menu-item-'. $item->ID . '"' . $value . $class_names .'>';

     $attributes  = ! empty( $item->attr_title ) ? ' title="'  . esc_attr( $item->attr_title ) .'"' : '';
     $attributes .= ! empty( $item->target )     ? ' target="' . esc_attr( $item->target     ) .'"' : '';
     $attributes .= ! empty( $item->xfn )        ? ' rel="'    . esc_attr( $item->xfn        ) .'"' : '';
     $attributes .= ! empty( $item->url )        ? ' href="'   . esc_attr( $item->url        ) .'"' : '';

     $item_output = $args->before;
     $item_output .= '<div><a'. $attributes .'>';
     $item_output .= $args->link_before . apply_filters( 'the_title', $item->title, $item->ID ) . $args->link_after;
     $item_output .= '</a><span>' . $item->attr_title . '</span><div class="arrow"></div></div><div class="main_sub_nav_wrap"><div class="main_sub_nav"><div class="container"><div class="main_sub_nav_text"><h2>' . $item->title . '</h2></div></div></div></div>';
     $item_output .= $args->after;

     $output .= apply_filters( 'walker_nav_menu_start_el', $item_output, $item, $depth, $args );
  }
}
?> 
```

我用它来添加到我的模板中......

```
<?php
    $walker = new My_Walker;
    wp_nav_menu(array(
        'echo'           => true,
        'container'      => '',
        'theme_location' => 'header_menu',
        'container'      => 'nav',
        'menu_class'     => '',
        'menu_id'        => 'nav',
        'depth'          => 0,
        'walker'         => $walker
    ));
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-12T07:21:24.280

我已经有一段时间没有使用这个代码了，如果它有点偏离，请原谅我。在这里，我为我的一个菜单项（ID 63）添加了一个自定义`<ul>`子菜单，并将菜单的其余部分保持原样。您可以修改该`if ($isCategoryItem){ ... }`部分以满足您的输出需求。

```
// Add product category menu as sub menu
class My_Walker extends Walker_Nav_Menu{        

function start_el(&$output, $item, $depth, $args) {
    global $wp_query;
    $indent = ( $depth ) ? str_repeat( "\t", $depth ) : '';

    $class_names = $value = '';

    $classes = empty( $item->classes ) ? array() : (array) $item->classes;

    $class_names = join( ' ', apply_filters( 'nav_menu_css_class', array_filter( $classes ), $item ) );
    $class_names = ' class="' . esc_attr( $class_names ) . '"';

    $output .= $indent . '<li id="menu-item-'. $item->ID . '"' . $value . $class_names .'>';

    $attributes  = ! empty( $item->attr_title ) ? ' title="'  . esc_attr( $item->attr_title ) .'"' : '';
    $attributes .= ! empty( $item->target )     ? ' target="' . esc_attr( $item->target     ) .'"' : '';
    $attributes .= ! empty( $item->xfn )        ? ' rel="'    . esc_attr( $item->xfn        ) .'"' : '';
    $attributes .= ! empty( $item->url )        ? ' href="'   . esc_attr( $item->url        ) .'"' : '';

    $item_output = $args->before;
    $item_output .= '<a'. $attributes .'>';
    $item_output .= $args->link_before . apply_filters( 'the_title', $item->title, $item->ID ) . $args->link_after;
    $item_output .= '</a>';
    $item_output .= $args->after;

// $item_output is the actually outputted variable - add to it here as needed.
    // Or modify the previous 5 lines if you need to change the link itself

// Add category list to Category menu item
    $isCategoryItem = $item->ID == "63";
    if ($isCategoryItem){
        $terms = get_prod_cats();

        if (count($terms) > 0) {
            $cat_out .= '<ul class="sub-menu">';
            foreach ($terms as $term) {
                $cat_out .= '<li>'
                                . '<a href="'. esc_url(home_url('/')) . 'category/' . $term->slug
                                . '">' . $term->name . '</a>'
                            . '</li>';    
            }
            $cat_out .= '</ul>';
        }
    // Here we actually modify it. The lines before set up the custom output
        $item_output = $item_output . $cat_out;
    }

// Send it off to the next menu item!
    $output .= apply_filters( 'walker_nav_menu_start_el', $item_output, $item, $depth, $args );
}

} 
```

# iphone - 保留的自我在块语句中不起作用

> ID：13435227
> 
> 赞同：0
> 
> 时间：2012-11-17T22:04:25.830
> 
> 标签：iphone, objective-c, ios, c, objective-c-blocks

我正在尝试在块语句中设置标签的 alpha，因此我调用 self. 据我了解，我不能直接从块语句中调用self，所以我必须先引用self。

这是我拥有的代码，但它不起作用：

```
 self.accountStore = [[ACAccountStore alloc] init];
    __weak UILabel *weakSelf = self.errorLabel;
    [self.accountStore requestAccessToAccountsWithType:twitterType options:NULL completion:^(BOOL granted, NSError *error) {
         if (!granted) {
             [weakSelf setAlpha:0.0f];
         } 
     }]; 
```

关于可能是什么问题的任何想法？

**更新 1**

我也尝试只引用自我，但没有运气：

```
self.accountStore = [[ACAccountStore alloc] init];
    __weak FrontPageViewController *weakSelf = self;
    [self.accountStore requestAccessToAccountsWithType:twitterType options:NULL completion:^(BOOL granted, NSError *error) {
         if (!granted) {
             [weakSelf.errorLabel setAlpha:0.0f];
         } 
     }]; 
```

**更新 2**

刚刚检查了错误标签是否为 nil 并且似乎不是：

```
if (self.errorLabel != nil) {
    NSLog(@"Errorlabel is not nil"); //Errorlabel is not nil
} 
```

**错误原因**

错误是我想淡出标签后立即拥有此代码：

```
[UIView animateWithDuration:0.2f animations:^{
    //self.errorLabel.alpha = 0.0f;
} completion:^(BOOL success){
}]; 
```

我不完全明白为什么这会造成麻烦？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:40:57.937

您需要确保**所有 UI 调用**都是从主线程进行的。这包括任何`animateWith...`调用。最快的方法是将它们简单地包装在一个调度块中，如下所示：

```
dispatch_async(dispatch_get_main_queue(), ^{
    [UIView animateWithDuration:0.2f
                     animations:^{
                         self.errorLabel.alpha = 0.0f;
                     }
                     completion:nil];
}); 
```

如果您不确定您的代码是否在主线程上运行，您可以使用以下语句进行调试。

```
NSLog(@"Is main thread = %@",(dispatch_get_main_queue() == dispatch_get_current_queue())?@"YES":@"NO"); 
```

始终注意异步网络 API 上的完成处理程序。确保他们的文档说完成处理程序将在主线程上调用。如果没有，请放心，并将任何与 UI 相关的工作转移到主线程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:33:13.107

```
__block __weak UILabel *weakSelf = self.errorLabel; 
```

# java - ListView#addHeaderView(View, Object data, boolean isSelectable) - 数据参数

> ID：13435228
> 
> 赞同：0
> 
> 时间：2012-11-17T22:04:31.980
> 
> 标签：java, android, android-listview

当我尝试[这个](https://stackoverflow.com/questions/12480762/how-to-make-the-header-or-footer-of-a-listview-not-clickable/12481083#12481083)时- 它不起作用。为什么？这是我的代码：

```
ListView list = (ListView) findViewById(R.id.workers_list);

View headersView = getLayoutInflater().inflate(R.layout.listview_row, null);
HashMap<String, String> map = createWorkerHashMap(workerTypes.WORKER, "Імена", "Прізвище", "Стаж", "Дата народження", "Місце роботи", "Наукова ступінь", "Вчене звання", "Розряд");
list.addHeaderView(headersView, (Object) map, false);

List<> workersArrayList = new ArrayList<HashMap<String, String>>();

SimpleAdapter workersListAdapter = new SimpleAdapter(this, workersArrayList, R.layout.listview_row,
            new String[] {"first_name", "last_name", "experience", "birthday", "job", "academic_degree", "academic_title", "operative_rank"}, new int[] {R.id.first_name, R.id.last_name, R.id.experience, R.id.birthday, R.id.job, R.id.academic_degree, R.id.academic_title, R.id.operative_rank});
list.setAdapter(workersListAdapter); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:34:52.837

没有魔法绑定。您必须自己设置视图（设置标签等）。

# boost - 无法初始化 boost::multi_array 除非 T 有无参数构造函数

> ID：13435229
> 
> 赞同：2
> 
> 时间：2012-11-17T22:04:48.890
> 
> 标签：boost, copy-constructor, boost-multi-array

似乎`boost::multi_array<T, n>`需要`T`有一个无参数的构造函数。考虑以下示例。

```
#include <boost/multi_array.hpp>

class ConstructorHasArguments {
    ConstructorHasArguments(int arg) {};
}

int main() {
    boost::multi_array<ConstructorHasArguments, 1> foo;
    return 0;
} 
```

这会导致编译错误。

```
no matching function for call to ‘ConstructorHasArguments::ConstructorHasArguments() 
```

问题是，当复制构造函数`boost::multi_array<T,n>`尝试为复制分配空间时，它会尝试调用`T()`. 当然，我可以在我的类中添加一个无参数构造函数。但是，如果我有一个无参数构造函数没有意义的类怎么办？

**当 T 没有无参数构造函数时，是否有一种简单的方法来使用 boost::multi_array ？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T10:14:28.393

它不仅是复制构造函数——实际上所有的构造函数`boost::multiarray`都会调用`allocate_space()`，然后依次调用`std::uninitialize_fill_n(base, allocated_elements_, T());`。因此这里需要一个没有参数的构造函数。如果您仍想使用`boost::multi_array`. （我指的是源代码`boost-1.46.0`。）

另一种选择可能是这样的：您自己分配和初始化空间。然后将地址传递给`boost::multi_array_ref`. 在这种情况下，您将不得不管理内存。

# sql - SQL ALTER TABLE 默认

> ID：13435230
> 
> 赞同：5
> 
> 时间：2012-11-17T22:04:53.457
> 
> 标签：sql, oracle

我正在尝试更改 Oracle 中的表。我必须为表中的列指定默认值`1`。制作表格时这很简单，但我必须使用该`ALTER TABLE`功能来完成，这就是我所拥有的：

```
 ALTER TABLE Stock_Qty
 ADD CONSTRAINT Qty_DEFAULT_Value DEFAULT (Qty 1); 
```

它似乎不起作用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-17T22:10:51.887

这是正确的语法：

```
ALTER TABLE Stock_Qty
MODIFY Qty DEFAULT 1 
```

# javascript - 循环所有输入框并清除它们

> ID：13435231
> 
> 赞同：10
> 
> 时间：2012-11-17T22:05:06.253
> 
> 标签：javascript, html, dom

如何使用 javascript 循环浏览页面上的所有输入框并清除其中的数据（使它们全部为空白）？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-17T22:07:17.950

试试这个代码：

```
​$('input').val(''); 
```

它循环遍历所有`input`元素，并将它们的值设置为空字符串。这是一个演示：http: [//jsfiddle.net/maqVn/1/](http://jsfiddle.net/maqVn/1/)

当然，如果你没有 jQuery：

```
var inputs = document.getElementsByTagName('input');
for (var i = 0; i < inputs.length; i += 1) {
    inputs[i].value = '';
}​​​​ 
```

由于我更喜欢​​功能风格，您可以使用：

```
Array.prototype.slice.call(
  document.getElementsByTagName('input'))
  .forEach(function (el) {
    el.value = '';
}); 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-17T22:08:56.647

```
[].forEach.call(document.getElementsByTagName('input'), function(e){
  e.value = '';
}); 
```

**编辑：**如果你想获取 textareas 和其他元素，你可以使用`querySelectorAll`：

```
[].forEach.call(
  document.querySelectorAll('input, textarea'), 
  function(e) { e.value = ''; }
); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-26T15:45:20.123

```
var inputs = document.getElementsByTagName("input"), 
    clearTypes = { "text" : 1, "password" : 1, "email" : 1 }, // etc. you fill this in
    i = inputs.length, 
    input;

while (i) {
    if (clearTypes[(input = inputs[--i]).type]) {
        input.value = "";
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-17T22:10:52.480

没有jQuery：

```
var list = document.getElementsByTagName('input');
for(var i = 0; i < list.length; i++) {
  if(list[i].type == 'text' || list[i].type == 'password')
    list[i].value = '';
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-17T22:12:12.313

只是为了注册一个没有 JavaScript 的替代方案，HTML 元素会`<input type="reset" />`清除`form`. 在某些情况下，这可能就足够了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-17T22:09:12.593

您可以执行以下操作：

```
<script>   
 e = document.getElementsByTagName('input');

    for (i = 0; i < e.length; i++){
    if (e[i].type != 'text') continue;

    e[i].value = '';
    }
</script> 
```

**已编辑：为输入类型不是文本的输入添加了排除！**

# php - 使用 MySQLi 的 real_escape_string 作为静态函数

> ID：13435232
> 
> 赞同：4
> 
> 时间：2012-11-17T22:05:16.987
> 
> 标签：php, mysqli, static-methods

我想知道是否可以在不首先创建对象实例来应用函数的情况下转义字符串（使用 real_escape_string）？

即，我们可以这样做：

```
$database = new mysqli(DB_HOST,DB_USER,DB_PASS,DB_NAME);
$database->real_escape_string($query);
$database->query($query) 
```

等等

但是，为了在我的应用程序中保持一致性，我试图做的是拥有一个主要是静态的数据库类，它是 MySQLi 类的扩展，这样我就可以调用：`database::real_escape_string($query)`，一个静态方法。

我确实意识到我可以构建一个在没有 MySQL 的情况下手动转义字符串的函数。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-17T22:11:40.553

最简洁的答案是不。

长答案是：嗯，不推荐，原因很简单——MySQLi 的真正转义考虑了字符编码，因为某种 SQL 注入技术使用和滥用字符编码来绕过常见的过滤器。这要求代码知道原始 (PHP) 字符集和接收 (MySQL) 字符集配置。这就是为什么它不能被静态调用（并且在你拥有到服务器的有效链接之前不能被调用）！

我也会避免它的程序版本，因为它只是通过有效地获取您连接到的最后一个服务器来完成“charset”位，一旦您处理多个数据库，这可能会导致有趣的东西同时连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:10:55.970

mysql_real_escape_string() 可能会对您有所帮助，但您必须在两个版本中建立连接。原因是应用程序不知道如何为数据库转义字符串。当连接到数据库时，该函数会询问数据库如何转义以及转义什么。

# c++ - 模板参数中的 const

> ID：13435235
> 
> 赞同：20
> 
> 时间：2012-11-17T22:05:48.540
> 
> 标签：c++, templates, constants

`const`这个模板中关键字的作用是什么？

```
template <class T, int const ROWNUM, int const COLNUM> 
class Matrix 
```

这是否意味着这个模板只接受一个`const`作为参数？如果是这样，有没有办法将变量作为`COLNUM`and传递`ROWNUM`？

（当我尝试将变量作为模板的 COLNUM 传递时，它会给出错误：“IntelliSense：表达式必须具有常量值”）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-17T22:15:24.390

它被忽略：

> `[C++11: 14.1/4]:`非类型*模板参数*应具有以下类型之一（可选*cv-qualified*）：
> 
> *   整数或枚举类型，
> *   指向对象的指针或指向函数的指针，
> *   对对象的左值引用或对函数的左值引用，
> *   指向成员的指针，
> *   `std::nullptr_t`.
> 
> `[C++11: 14.1/5]:`[*注意：其他类型在下面明确或由管理**模板参数*形式的规则（14.3）隐式禁止。*—end note* ]***模板参数*****上的顶级*cv 限定符*在***确定其类型时**会被忽略。***

 *在 C++03 中的相同位置存在相同的措辞。

这部分是因为模板参数必须在编译时知道。所以，不管你有`const`没有，[你*可能不会*传递一些变量值](http://ideone.com/VFpoLr)：

```
template <int N>
void f()
{
    N = 42;
}

template <int const N>
void g()
{
    N = 42;
}

int main()
{
    f<0>();
    g<0>();

    static const int h = 1;
    f<h>();
    g<h>();
} 
```

> prog.cpp：在函数'<strong>void f() [with int N = 0]'中：
> prog.cpp：15：从这里实例化
> prog.cpp：4：错误：**需要左值作为赋值**
> prog.cpp的左操作数：在函数'<strong>void g() [with int N = 0]'中：
> prog.cpp：16：从这里实例化
> prog.cpp：10：错误：**需要左值作为赋值**
> prog.cpp的左操作数：在函数中'<strong>void f() [with int N = 1]':
> prog.cpp:19: 从这里实例化
> prog.cpp:4: 错误:**需要左值作为赋值**
> prog.cpp 的左操作数: 在函数'<strong >void g() [with int N = 1]':
> prog.cpp:20: 从这里实例化
> prog.cpp:10: 错误：**左值需要作为赋值的左操作数**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T22:24:11.080

`const`在您的情况下不需要

例如，从编译器*的角度来看*`Matrix_A`，两个类和`Matrix_B`下面的类都是相同的。这只是为了强制执行这一事实，并且对于人类*的观点来说*是恒定的，但不是必需的。*`const``ROWNUM``COLNUM`*

 **```
template <class T, int const ROWNUM, int const COLNUM> 
class Matrix_A 
{
};

template <class T, int       ROWNUM, int       COLNUM> 
class Matrix_B
{
}; 
```

此外，以下类还以另一种方式`Matrix_C`指定了类似的常量变量：`ROWNUM``COLNUM`

```
template <class T> 
class Matrix_C
{
   static int const ROWNUM = 5;
   static int const COLNUM = 20;
};

// the following three objects use constant variables ROWNUM and COLNUM
Matrix_A<bool,5,20> a;
Matrix_B<bool,5,20> b;
Matrix_C<bool>      c; 
```***

# php - Mysql结果数组搜索

> ID：13435242
> 
> 赞同：0
> 
> 时间：2012-11-17T22:07:32.063
> 
> 标签：php, mysql

我在这个 bd 中得到这个专栏

```
$result = mysql_query("SELECT short FROM textos"); 
```

我试图根据它返回的数组只回显一个结果：

```
$col = mysql_fetch_assoc($result);

echo "<b>Short:</b>".$col[1]."<br/>"; 
```

显然这个 $col 数组不能以这种方式访问​​。应该怎么做？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:17:32.027

要访问第一个元素，请使用`$col[0]['short']`.
如果你只想输出一个元素，你可以添加`LIMIT 1`到 MySQL 查询中。
查询后，您应该检查结果数组是否已设置，否则 php 将抛出错误，说明`$col[0]['short']`未设置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:17:53.800

这已经在上面的评论中说明了，所以这里只是一点解释。

`mysql_fetch_assoc`为您检索结果行，以关联数组的形式呈现（键是字段名称，值是字段值的数组）。您的查询仅返回一个字段（即`short`），但它仍然不会使您的行成为单个标量值 - 它仍然是一个数组，只有一个元素。

因此，您需要将其称为`$row['short']`, 或在您的示例中`$col['short']`。

请记住，查询可能不返回任何结果 - 您可以通过检查返回的值是否不是数组而是标量来了解这一点`false`，例如

```
if ($col === false) {
    echo 'Error occured<br/>';
} else {
    echo "<b>Short:</b>".$col['short']."<br/>";
} 
```

像评论建议的那样将`LIMIT`查询放入您的查询也是一个好主意，因为当您实际上只需要一行时，您不会返回潜在的大量数据。结果仍然会以多维数组的形式出现，因此该部分不会改变。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T23:15:04.973

有三个获取行的 mysql_fetch 函数：

*   **mysql_fetch_array()**获取具有两个索引（数字和关联）的数组
*   **mysql_fetch_num()**获取具有数字索引的数组
*   **mysql_fetch_assoc()**获取具有关联索引的数组

在您的示例中，您将获得一个类似于函数 mysql_fetch_array() 的数组：

```
array(2) {
  [0]=>
  string(3) "foo"
  ["short"]=>
  string(3) "foo"
} 
```

```
$statement = 'SELECT short FROM textos';
$result = mysql_result($statement);
if ($result) {
    while ($row = mysql_fetch_assoc($result)) {
        var_dump($row); // or echo "<b>Short:</b>".$row['short']."<br/>"; or something else you like to do with rows of the above statement
    }
} 
```

# r - R XML错误请求php

> ID：13435244
> 
> 赞同：1
> 
> 时间：2012-11-17T22:07:33.940
> 
> 标签：r

我想使用 XML 包和 htmlParse 抓取此网页的内容：http: [//www.interactivebrokers.com/en/p.php](http://www.interactivebrokers.com/en/p.php?f=products) ?f=products 。但是，我传递给 htmlParse 的链接给了我一个 Bad Request 错误。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T00:22:43.023

```
require(RCurl)
require(XML)
iburl<-'http://www.interactivebrokers.com/en/p.php?f=products'
ua<-'Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:16.0) Gecko/20100101 Firefox/16.0'
ibdata<-getURL(iburl,useragent=ua)
htmlParse(ibdata)
readHTMLTable(ibdata) 
```

看起来它正在检查用户代理。

# sql - 将月份添加到日期 SQL

> ID：13435245
> 
> 赞同：1
> 
> 时间：2012-11-17T22:07:36.167
> 
> 标签：sql, oracle, date-arithmetic

我正在尝试将月份添加到 SQL 中的现有日期。显示的新列将有一个后续列，而不是天数列。我在选择语句中遇到错误。你能帮忙吗？

```
Create table auctions(
item varchar2(50),
datebought date,
datesold date,
days number
);
Insert into auctions values (‘Radio’,’12-MAY-2001’,’21-MAY-2001’,9);
Select item,datebought,datesold,ADD MONTHS(datesold,3)”followup” from auctions; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-17T23:02:29.423

您对 add_months() 函数的使用不正确。这不是两个词，它只是一个（带下划线）

```
add_months(datesold, 1) 
```

注意和`_`之间的下划线。它是函数调用而不是运算符。`ADD``MONTHS`

或者，您可以使用：

```
datesold + INTERVAL '1' month 
```

尽管值得注意的是，具有间隔的算术是有限的（如果没有破坏），因为它只是“增加”日期值的月份值。这可能导致无效日期（例如从一月到二月）。尽管这是记录在案的行为（见下面的链接），但我认为这是一个错误（SQL 标准要求这些操作“*算术遵守与日期和时间相关的自然规则，并根据公历产生有效的日期时间或间隔结果*”）

详见手册：http:
[//docs.oracle.com/cd/E11882_01/server.112/e26088/functions011.htm#i76717](http://docs.oracle.com/cd/E11882_01/server.112/e26088/functions011.htm#i76717)
[http://docs.oracle.com/cd/E11882_01/server.112/e26088 /sql_elements001.htm#i48042](http://docs.oracle.com/cd/E11882_01/server.112/e26088/sql_elements001.htm#i48042)

另一件事：

> *我正在尝试将月份添加到 SQL 中的现有日期。*

那你为什么要使用`INSERT`语句？要更改现有行的数据，您应该使用`UPDATE`. 所以看起来你真正追求的是这样的：

```
update auctions
   set datesold = add_months(datesold, 1)
where item = 'Radio'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:13:14.327

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T22:14:53.337

This can be used to add months to a date in SQL:

```
select DATEADD(mm,1,getdate()) 
```

This might be a [useful link](http://www.dotnetfunda.com/interview/exam2243-adding-months-to-a-date-in-sql.aspx).

# c++ - 神秘的 C++ 语法

> ID：13435247
> 
> 赞同：3
> 
> 时间：2012-11-17T22:08:18.630
> 
> 标签：c++

我试图通过并理解一个使用内在速度的卡方程序。在这个过程中，我遇到了一行我看不懂的代码。

我试过复习教科书、谷歌和搜索这个网站，但没有成功。我认为问题在于，在对语法一无所知的情况下，我无法用术语或关键字来充分描述搜索以获得任何相关结果。

这是我不明白的代码行：

```
float (*chi2_float)(const int, const float*, const float*) = chi2_baseline_float; 
```

这是包含它的函数：

```
float chi2_float(const int dim, const float* const x, const float* const y) {
    float (*chi2_float)(const int, const float*, const float*) = chi2_baseline_float;
#ifdef __SSE__
    chi2_float = chi2_intrinsic_float;
#endif
    return chi2_float(dim, x, y);
} 
```

在我看来，它可能是在声明和定义一个函数，当我注释掉该行并重新编译时，我得到：

错误 C2659：“=”：在 chi2_float = chi2_intrinsic_float 行上用作左操作数；

如果需要，我可以发送包含此函数的 .h 文件，但这与您对参数的期望一样。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-17T22:10:43.337

有问题的行是根据 的值将函数指针类型的变量设置为其他两个函数之一`__SSE__`。

然后调用 chi2_float 指向的函数并返回结果。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-17T22:15:04.717

This:

```
float (*chi2_float)(const int, const float*, const float*)= chi2_baseline_float; 
```

declares a function pointer names `chi2_float` and assigned to it a pointer to the function named `chi_baseline_float`.

Then, if the `__SSE__` macro is defined, the pointer is reassigned with a pointer to the function `chi2_intrinsic_float`.

The net effect of all this is something similar to:

```
float chi2_float(const int dim, const float* const x, const float* const y) 
{
#ifdef __SSE__
    return chi2_intrinsic_float(dim, x, y);
#else
    return chi2_baseline_float(dim, x, y);
#endif
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T22:19:45.497

您的问题代码和一些评论：

```
// beginning of the definition of function chi2_float 
float chi2_float(const int dim, const float* const x, const float* const y) {
    // declare the variable chi2_float as a function pointer
    // set variable chi2_float to the address of the function chi2_baseline_float
    float (*chi2_float)(const int, const float*, const float*) = chi2_baseline_float;
// if macro __SSE__ is defined (if the compiler enables SSE instructions set)
// [this is your case because you got an error in the below line when you have commented the above line] 
#ifdef __SSE__
    // then preprocessor adds the following line that sets again the variable chi2_float (but to another function) 
    chi2_float = chi2_intrinsic_float;
#endif
    // call the function pointed by the variable chi2_float
    return chi2_float(dim, x, y);
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-17T23:54:52.990

```
float chi2_float(const int dim, const float* const x, const float* const y) {
   float (*chi2_float)(const int, const float*, const float*) = chi2_baseline_float;
#ifdef __SSE__
   chi2_float = chi2_intrinsic_float;
#endif
   return chi2_float(dim, x, y);
} 
```

丑陋的。

修复此代码要做的第一件事是使用函数名称以外的其他名称作为函数指针变量的名称。我认为，这个变量掩盖了函数的名称是 James Crow 困惑的根源。

修复此代码的第二件事是完全摆脱函数指针，从而导致 Michael Burr 在他的答案中发布的代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-18T01:48:15.217

Michael Burr 提出以下建议：

```
float chi2_float(const int dim, const float* const x, const float* const y) 
{
#ifdef __SSE__
    return chi2_intrinsic_float(dim, x, y);
#else
    return chi2_baseline_float(dim, x, y);
#endif
} 
```

暂时忽略编译器的优化器；这可能会得到改善。Burr 先生的解决方案使用两个函数调用： main() （或其他）调用 chi2_float() 然后调用适当的实现。这可以简化为一个函数调用，如下所示：

```
#ifdef __SSE__
    #define chi2_float(dim, x, y) chi2_intrinsic_float(dim, x, y)
#else
    #define chi2_float(dim, x, y) chi2_baseline_float(dim, x, y)
#endif 
```

通过将 Burr 先生的 chi2_float() 声明为“内联”，可能会获得相同的结果。

然而，回到现实世界（编译器积极优化代码），你会期望一个好的优化器删除额外的函数调用，从而使 Burr 先生的解决方案同样快。

为了完整起见，我发布了这个讨论。尽管这并没有改进 Burr 先生的解决方案，但它增加了更多的上下文。从技术上讲，它应该是一个评论，而不是一个新的答案，但不可能在评论中格式化源代码。这就是生活。

# statements - PHP if / else 语句似乎不适用于通过电子邮件联系我们

> ID：13435252
> 
> 赞同：-1
> 
> 时间：2012-11-17T22:08:48.787
> 
> 标签：statements

我创建了一些 if / else 语句来在用户点击但不工作时获取下载，因为您可以直接下载而无需字段名称或电子邮件，请帮助我联系。php 为我的网站 [http://my-easy-woodworking-projects.com](http://my-easy-woodworking-projects.com)

```
<?php
$field_name = $_POST['cf_name'];
$field_email = $_POST['cf_email'];
$field_message = $_POST['cf_message'];

$mail_to = 'lulu@yahoo.com';
$subject = 'Message from a site visitor '.$field_name;

$body_message = 'From: '.$field_name."\n";
$body_message .= 'E-mail: '.$field_email."\n";
$body_message .= 'Message: '.$field_message;

$headers = 'From: '.$field_email."\r\n";
$headers .= 'Reply-To: '.$field_email."\r\n";

$mail_status = mail($mail_to, $subject, $body_message, $headers);

if ($mail_status) { ?>
    <script>

var str = "download";
document.write(str.link("http://www.myshedplans.com/12BY8SHED.pdf"));

</script>
<?php
}
else { ?>
    <script language="javascript" type="text/javascript">
        alert('Message failed. Please, send an email to gordon@template-help.com');
        window.location = 'contact_page.html';
    </script>
<?php
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:39:01.913

我不太确定为什么 if/else 对您不起作用，但可能发生的一件事是解释器在遇到 else 时忘记了 if 语句。解决此问题的一种方法是在条件块中回显您的 html 代码，如下所示：

```
<?php
    if ($mail_status) {
        echo "<script>";
        echo "var str = \"download\";";
        echo "document.write(str.link(\"http://www.myshedplans.com/12BY8SHED.pdf\"));";
        echo "</script>";
    }
    else {
        echo "<script language=\"javascript\" type=\"text/javascript\">";
        echo "alert('Message failed. Please, send an email to gordon@template-help.com');";
        echo "window.location = 'contact_page.html';";
        echo "</script>";
    }
?> 
```

# php - Codeigniter Routes，意外行为，不知道为什么

> ID：13435253
> 
> 赞同：1
> 
> 时间：2012-11-17T22:08:51.637
> 
> 标签：php, codeigniter, routes

所以，我不知道过去在少数几个网站上我用代码点火器做过多少次类似的事情。但是，只是给自己一个新副本，并在新站点上开始重建我已经遇到了一个我无法弄清楚的扭曲的小问题，我不知道我在这个等式中缺少什么..

所以这是我目前的路线：

```
$route['default_controller'] = "home";
$route['404_override'] = 'home/unknown';

$route['post/(:any)/(:any)'] = 'post/$1/$2';
//$route['post/(:any)'] = 'post/$1';
//$route['post'] = 'post';

$route['host-hotel'] = 'host_hotel';
$route['floor-plan'] = 'floor_plan';
$route['wine-facts'] = 'wine_facts';
$route['exhibitor-application'] = 'exhibitor_application';

$route['photo-gallery'] = 'photo_gallery';
$route['video-gallery'] = 'video_gallery'; 
```

现在问题出在这个人身上。

```
$route['post/(:any)/(:any)'] = 'post/$1/$2'; 
```

我什至尝试将片段命名为文章而不是帖子，认为它可能是 CI 中某种受保护的名称。如果您注意到这一行上方，我还尝试添加 URL 的变体，以便它可以只处理第一个片段或之后的一个或两个片段。授予它他们在这个例子中被注释掉，但没有工作。

如果我去`domain.com/post`行为是预期的。之后的任何事情都是问题的开始。如果我在那里做了任何数字或字母或组合......

即：`domain.com/post/s2hj`或者`domain.com/post/s2hj/avd`页面开始表现得像 404 行为，找不到页面，这对我来说毫无意义，正如我所说，我过去做过这样的路线。对我来说，这条路线看起来合适吗？所以有人有任何想法/建议要寻找什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:32:11.150

`:any`从字面上匹配**任何**字符，包括斜线。这将在 CodeIgniter 3.0 中进行更改，但目前您可以使用 ([^/]) 来捕获单个段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T11:48:07.630

另一种尝试方法是通过 Good ol' regexp：

```
$route['post/([^/]+)/([^/]+)'] = 'post/$1/$2'; 
```

如果您还需要能够处理总共 2 个 uri 段，请考虑：

```
$route['post/([^/]+)(?:/([^/]+))'] = 'post/$1/$2'; 
```

**正则表达式解释：**

`()`简单地捕获和处理里面的字符串。在另一端也给了我们`$1`，等等。`$2`

`(?:)`与上面相同，但不捕获`$1`

`[]`是里面允许的东西组合。`[0-9]`只会寻找数字。

`[^]`是颠倒的逻辑。一切除了给定的迹象。

`[^/]`是除了 之外的一切`/`，因此给了我们想要的结果。

# lex - lex 程序：错误：在数字常量之前需要 ';'、',' 或 ')'？

> ID：13435256
> 
> 赞同：1
> 
> 时间：2012-11-17T22:09:27.050
> 
> 标签：lex

我检查了其他类似的帖子，但我认为我只需要第二双眼睛。此文件用于 lex Unix 实用程序。

我创建了一个makefile，这是我收到的错误：

```
gcc -g -c lex.yy.c
cxref.l:57: error: expected ‘;’, ‘,’ or ‘)’ before numeric constant
make: *** [lex.yy.o] Error 1 
```

`Line 57`就在`void inserID()`顶部附近的函数内部。

这是代码：

```
%{
#include <stdio.h>
#include <string.h>
char identifier[1000][82];
char linesFound[100][100];
void insertId(char*, int);
int i = 0;
int lineNum = 1;
%}

%x comment
%s str

%%
"/*"                        BEGIN(comment);

<comment>[^*\n]*        /* eat anything that's not a '*' */
<comment>"*"+[^*/\n]*   /* eat up '*'s not followed by '/'s */
<comment>\n             ++lineNum;
<comment>"*"+"/"        BEGIN(INITIAL);

"\n"                              ++lineNum;

auto                        ;
break                       ;
case                        ;
char                        ;
continue                    ;
default                     ;
do                          ;
double                      ;
else                        ;
extern                      ;
float                       ;
for                         ;
goto                        ;
if                          ;
int                         ;
long                        ;
register                    ;
return                      ;
short                       ;
sizeof                      ;
static                      ;
struct                      ;
switch                      ;
typedef                     ;
union                       ;
unsigned                    ;
void                        ;
while                       ;
[*]?[a-zA-Z][a-zA-Z0-9_]*   insertId(yytext, lineNum);
[^a-zA-Z0-9_]+              ;
[0-9]+                      ;
%%
void insertId(char* str, int nLine)
{
    char num[2];
    sprintf ( num, "%d", nLine);

    int iter;
    for(iter = 0; iter <= i; iter++)
    {
        if ( strcmp(identifier[iter], str) == 0 )
        {
            strcat( linesFound[iter], ", " );
            strcat( linesFound[iter], num );
            return;
        }
    }

    strcpy( identifier[i], str );
    strcat( identifier[i], ": " );
    strcpy( linesFound[i], num );

    i++;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T01:08:54.903

你的问题是：

```
%s str 
```

用大写字母写条件名称是正常的，这是有原因的：它使它们看起来像宏，这*正是它们的本质*。

所以

```
void insertId(char* str, int nLine) 
```

将宏扩展为：

```
void insertId(char* 2, int nLine) 
```

并且编译器抱怨`2`在声明中当时并没有真正预期到这一点。

# java - 牛顿多项式的典型系数

> ID：13435257
> 
> 赞同：3
> 
> 时间：2012-11-17T22:09:39.707
> 
> 标签：java, interpolation, polynomial-math

不久前，我为我编写的游戏实现了多项式近似。

我正在使用牛顿的金字塔方法。我花了很长时间才弄明白，但我的解决方案需要计算二项式系数，而且我还必须对每个幂的最终系数的所有系数求和（因为解决这个问题类似于平方、立方......项和计算二项式系数）

例如：从 n 个仿生术语中挑选 k 并将它们
相加 一个选择乘以
a*(x+b) *(x+c)* (x+d) ==> a*x^3 + a*x^2 *(b+c+d) + a*x(bc+bd+cd) +a*b*c*d
所以 b*c*d 也是 b*c 和 b*d 的一个选择

我现在的问题是：有没有办法用牛顿方案计算多项式插值，而不必计算所有的仿生系数？

我的代码： [https ://github.com/superphil0/Polynominterpolation/blob/master/PolynomInterpolation.java](https://github.com/superphil0/Polynominterpolation/blob/master/PolynomInterpolation.java)

它工作得很好，虽然如果一个人给出的分数太多，它会相当慢，因为选择的术语都已经总结出来了

（我真的不擅长用英语解释这个，我希望有人能理解我想知道的）

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:47:41.263

从[这个描述](http://homepages.gac.edu/~hvidsten/courses/MC355/Textbooks/numerical%20analysis%20course%20notes.pdf)来看，我认为你的“金字塔方案”生成系数*c [i]*使得多项式*p* ( *x* ) 可以写为
*p* ( *x* ) = *c* [0] + ( *x* ‒ *x* [0] )( *c* [1] + ( *x* ‒ *x* [1] )( *c* [2] + ( *x* ‒ *x* [2] )( *c* [3] + ( *x* ‒ *x* [3] )( ... ( *c* [*n* -1]+ ( *x* ‒ *x* [*n* ‒1] ) *c* [*n*] ) ... ))))

现在您可以从后面递归地计算规范系数。从
*p [n]* = *c [n开始]*

在每一步中，当前多项式可以写为
*p [k]* = c [k] + ( *x* ‒ *x [k]* ) *p* [*k* +1] = c [k] + ( *x* ‒ *x [k]* )( *b* [0] + *b* [1] *x* + *b* [2] *x* ² + ...)
假设下一个较小的多项式已经转换为规范系数。

现在您可以使用*p* [*k*] [+1]的系数*b* *[i]*计算*p* *[k]**的系数a [i]*。以严格的正式方式，我必须使用索引而不是*a*和*b*，但我相信这种方式更清楚。那么下一个多项式的典型系数是多少？

 ****   *一个*[0] = *c [k]* - *x [k] b* [0]
*   *一*[1] = *b* [0] - *x [k] b* [1]
*   *a* [2] = *b* [1] - *x [k] b* [2]
*   …</li>

您可以在循环中编写它，使用和重用单个数组`a`来保存系数：

```
double[] a = new double[n + 1]; // initialized to zeros
for (int k = n; k >= 0; --k) {
    for (int i = n - k; i > 0; --i)
        a[i] = a[i - 1] - x[k]*a[i];
    a[0] = c[k] - x[k]*a[0];
} 
```***

# php - Mysql搜索查询顺序的重要性

> ID：13435259
> 
> 赞同：-1
> 
> 时间：2012-11-17T22:09:42.687
> 
> 标签：php, mysql, sql

我有一个搜索查询，它动态地将搜索参数 LIKE "%keyword%" 添加到查询中。我的问题是：搜索参数的顺序重要吗？

假设我的数据库中有 4 条记录。

```
1\. 2012 bmw 335,
2\. 2013 bmw x3,
3\. 2012 audi a4,
4\. 2012 Benz clk 
```

当我搜索 2012 bmw x3 时，结果返回记录 1、3 和 4，但没有记录 2。除了搜索之外，我会返回所有 4 条记录。为什么会这样？我使用“OR”来链接每个搜索参数。

这是我的查询：

```
SELECT * 
FROM for_sale 
WHERE message LIKE "%2012%" OR "%bmw%" OR "%x3%" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:15:02.353

```
SELECT * 
FROM for_sale 
WHERE message LIKE "%2012%" OR message LIKE "%bmw%" OR message LIKE "%x3%" 
```

This is what you're after - remember that OR doesn't bind to LIKE possibilities!

# c++ - Qt 用户自定义热键

> ID：13435262
> 
> 赞同：5
> 
> 时间：2012-11-17T22:09:51.573
> 
> 标签：c++, qt, qt4

我正在尝试设计一个带有用户可自定义热键的 Qt GUI 应用程序。我遇到的主要问题是如何在应用程序中同步热键，因为多个小部件/组件可能使用特定的热键（例如，复制）。

我目前的策略是使用一个引用类，它`QKeySequence`为每个不同的热键保存一个对象列表。每个小部件都必须有一种方法来引用这个主列表，并具有低级的自定义实现`keyPressEvent`，它将比较输入的键和热键。不过，我并不特别喜欢这种策略，因为它需要在每个小部件中进行大量的重新实现，并且感觉就像我正在尝试重新发明轮子。

我还尝试使用`QAction`可以在内部保存`QKeySequence`快捷方式的对象，然后使用它们来触发我可以使用插槽和信号处理的更高级别的事件。但是，我在这里遇到的主要问题是如何管理将信号路由到哪些插槽。

例如，假设我有 2 个打开的小部件，它们都可以接收`copy`动作信号。我可以将这两个的插槽连接到同一个信号，并利用单个更新点的快捷方式，但是事情变得混乱，因为只有活动的小部件应该作用于复制信号，而不是两个小部件。我可以重新实现`focusOutEvent`and`focusInEvent`处理程序以手动连接/断开插槽，但这似乎也遇到了上面我试图重新发明轮子并做比必要的更多工作的相同问题。

有没有更简单的方法解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T03:52:35.480

我认为这个问题没有特别简单/不乏味的解决方案，但是当我需要向我的应用程序添加用户可自定义的热键时，我是这样做的：

1) 从具有硬编码快捷键的应用程序开始，例如这样的代码：

```
QMenu * editMenu = new QMenu;
QAction * copyItem = menu->addAction(tr("Copy"), this, SLOT(CopyData()));
copyItem->setShortcut(tr("Ctrl+C")); 
```

2) 创建一个如下所示的 GetKeySequence() 函数：

```
static QHash<QString, QKeySequence> _usersKeyPreferences;
static bool _usersKeyPreferencesLoaded = false;

QKeySequence GetKeySequence(const QString & keySequence, const QString & contextStr)
{
   if (_usersKeyPreferencesLoaded == false)
   {
      // Oops, time to load in the user's saved custom-key settings from a file somewhere
      _usersKeyPreferences = LoadUsersKeyPreferencesFromFile();
      _usersKeyPreferencesLoaded = true;  // so we'll only try to load the file once
   }
   if (_usersKeyPreferences.contains(contextStr)) 
   {
      return _usersKeyPreferences[contextStr];
   }
   else 
   {
      // No user preference specified?  Okay, fall back to using the 
      // hard-coded default key sequence instead.
      return QKeySequence(qApp->translate(contextStr, keySequence));
   }
} 
```

3) 现在是乏味的部分：对所有代码以及任何你明确指定键序列的地方（如步骤 1 所示代码的第三行），用调用 GetKeySequence() 来包装它，像这样：

```
copyItem->setShortcut(GetKeySequence(tr("Ctrl+C"), tr("Edit_Menu|Copy"))); 
```

4）此时，您的程序的键序列将是可定制的；只需确保在 GUI 创建代码运行之前磁盘上存在密钥设置文件即可。这是我程序的键映射文件（我将其存储为简单的 ASCII 文本文件）的摘录：

```
Edit_Menu|Copy   = Ctrl+C
Edit_Menu|Cut    = Ctrl+X
Edit_Menu|Paste  = Ctrl+V
[... and so on for all other menu items, etc...] 
```

...当然，这种方法的一个缺点是，一旦创建了 GUI，就不能“即时”修改键绑定（至少，在没有大量额外编码的情况下）。我的程序只需在用户单击“编辑键绑定”对话框中的“保存并应用”后关闭并重新创建所有窗口即可解决此问题。

5) 一个可选的进一步步骤（这是一些额外的工作，但从长远来看可以节省时间）是编写一个程序（或脚本），对程序代码库中的所有 .cpp 文件进行 greps 查找调用 GetKeySequence()代码。当它找到 GetKeySequence() 调用时，它会解析出调用的两个参数，并将它们打印为具有默认设置的键绑定文件中的一行。这很有用，因为您可以将此脚本作为自动构建的一部分，此后您将永远不必记住在向您添加新菜单项（或其他键序列说明符）时手动更新默认键设置文件程序。

无论如何，这对我来说效果很好。优点是您根本不必重构现有程序；您可以根据需要插入 GetKeySequence() ，同时保持程序的更大逻辑/结构完好无损。

# linq-to-sql - C# linq to sql 默认连接字符串

> ID：13435266
> 
> 赞同：1
> 
> 时间：2012-11-17T22:10:06.443
> 
> 标签：linq-to-sql, c#-3.0, app-config

在现有的 C# 2010 应用程序中，我想将 linq 添加到 sql 语句以连接到 sql server 2008 数据库。当我将此 linq 设置为 sql 数据库时，我希望能够使用 app.config 文件设置与数据库的连接。

我已经读过，当您以这种方式设置数据库连接时，将使用默认数据库。基本上，当您在同一个数据库上进行数据库时，这是可以的。但是，当您从单元测试数据库转移到用户接受和/或生产数据库时，会出现问题，因为数据库连接在 aqpplication 中是硬编码的。

因此，您能告诉我和/或向我展示如何防止发生此问题的代码吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:17:36.380

[您必须像这样](http://www.foliotek.com/devblog/using-the-web-config-connection-string-with-linq-to-sql/)创建部分类

# javascript - 如何从 .each() 内部删除对象

> ID：13435270
> 
> 赞同：0
> 
> 时间：2012-11-17T22:10:17.787
> 
> 标签：javascript, jquery

> **可能重复：**
> [如何从对象中删除属性？](https://stackoverflow.com/questions/4178123/how-to-remove-a-property-from-an-object)

我正在比较两个 JSON 对象，然后使用以下代码从列表中删除旧项目：

```
dangerousPeople = ({1:{title:"Jackie Chan", user:"Jackie"}, 2:{title:"Chuck Norris", user:"Chuck"}, 3:{title:"Britney spears", user:"Britney"}});
newDangerousPeople = ({1:{title:"Jackie Chan", user:"Jackie"}, 3:{title:"Britney spears", user:"Britney"}});

$.each(dangerousPeople, function(index)
{
    if(!newDangerousPeople[index]){

         $('#dangerousPeople #id'+index).slideUp("normal", function() { $(this).remove(); } );

         delete dangerousPeople.index;
    }
}); 
```

滑动元素的脚本部分有效，但从对象中删除元素我无法使其工作。

我尝试过`delete dangerousPeople.index`但不起作用，也尝试过删除`$(this)`但也没有运气。

那么我应该如何从自身中删除元素呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:17:20.857

尝试：

```
...

delete dangerousPeople[ index ];

... 
```

# javascript - 在对象文字中调用 jQuery 切换方法

> ID：13435277
> 
> 赞同：0
> 
> 时间：2012-11-17T22:10:56.240
> 
> 标签：javascript, jquery

我正在努力让下面的代码工作。问题是，当我将这两个函数包装在`editItems`括号内的属性中`()`时，代码的行为很奇怪，并将`display: none`内联 css 属性分配给编辑按钮。

如果我不将这两个函数包含在括号内，我会收到一个 javascript syntax error `function statement requires a name`。

```
var shoppingList = {
    // Some code ...

    'init' : function() {

    // Capture toggle event on Edit Items button
    (shoppingList.$editButton).toggle(shoppingList.editItems);
    },

    'editItems' : function() {
        (function() {
            $(this).attr('value', 'Finish editing');
            (shoppingList.$ingrLinks).unbind('click', shoppingList.ingredients) // disable highlighting items
                                     .removeAttr('href');
            $('.editme').editable("enable");
            $('.editme').editable('http://localhost:8000/edit-ingredient/', {
                indicator : 'Saving...',
                tooltip   : 'Click to edit...',
                submit    : 'OK',
                cancel    : 'Cancel'
            });
        }), (function() {
            $(this).attr('value', 'Edit item');
            (shoppingList.$ingrLinks).attr('href', '#');
            $('.editme').editable("disable");
            (shoppingList.$ingrLinks).bind('click', shoppingList.ingredients) // re-enable highlighting items
        })
    }
}

$(document).ready(shoppingList.init); 
```

`toggle`但是，如果我像这样“直接”调用事件，**它会起作用**：

```
var shoppingList = {
    // Some code ...

    'init' : function() {
        // Toggle event on Edit Items button
        (shoppingList.$editButton).toggle(
            function() {
            $(this).attr('value', 'Finish editing');
            (shoppingList.$ingrLinks).unbind('click', shoppingList.ingredients) // disable highlighting items
                                     .removeAttr('href');
            $('.editme').editable("enable");
            $('.editme').editable('http://localhost:8000/edit-ingredient/', {
                indicator : 'Saving...',
                tooltip   : 'Click to edit...',
                submit    : 'OK',
                cancel    : 'Cancel'
            });
        }, function() {
            $(this).attr('value', 'Edit item');
            (shoppingList.$ingrLinks).attr('href', '#');
            $('.editme').editable("disable");
            (shoppingList.$ingrLinks).bind('click', shoppingList.ingredients) // re-enable highlighting items
        });
    }
};

$(document).ready(shoppingList.init); 
```

有没有办法可以将切换事件存储在`editItems`对象文字中并仍然按预期工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:43:06.470

`editItems`功能看起来很奇怪。我猜你只需要定义 2 个函数：`startEdit`和`endEdit`. 并在偶数和奇数点击上使用`toggle`.

```
 var shoppingList = {
    // Some code ...

    init : function() {
        // Bind on edit button click
        this.$editButton.toggle(this.startEdit, this.endEdit);
    },

    startEdit : function() {
            $(this).attr('value', 'Finish editing');
            shoppingList.$ingrLinks.unbind('click', shoppingList.ingredients) // disable highlighting items
                                     .removeAttr('href');
            $('.editme').editable("enable");
            $('.editme').editable('http://localhost:8000/edit-ingredient/', {
                indicator : 'Saving...',
                tooltip   : 'Click to edit...',
                submit    : 'OK',
                cancel    : 'Cancel'
            }),
    endEdit: function() {
            $(this).attr('value', 'Edit item');
            (shoppingList.$ingrLinks).attr('href', '#');
            $('.editme').editable("disable");
            (shoppingList.$ingrLinks).bind('click', shoppingList.ingredients) // re-enable highlighting items
        })
};

$($.proxy(shoppingList, 'init')); 
```

# objective-c - Mac cancelUserAttentionRequest 不起作用？

> ID：13435283
> 
> 赞同：0
> 
> 时间：2012-11-17T22:11:40.620
> 
> 标签：objective-c, macos

我似乎无法让 cancelUserAttentionRequest 工作。我有以下...

.mm 文件

```
void SetNotify()
{
    this->notify = [NSApp requestUserAttention:NSCriticalRequest];
}

void RemoveNotify()
{
    if (!this->notify) {
        return;
    }

    [NSApp cancelUserAttentionRequest:this->notify];
} 
```

标题

```
protected:
    int notify; 
```

我正在使用一个计时器来调用 SetNotify，然后是另一个在 5 秒后运行的计时器。图标弹跳得很好，但它不会停止弹跳。我错过了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:28:00.547

删除`if (!this->notify)`检查。

的文档`requestUserAttention:`没有说明它返回的整数的性质（它可以是*任何*有效的整数），并且当前实现返回`0`第一个请求。如果您需要确保`SetNotify()`在之前调用过`RemoveNotify()`，请使用单独的布尔标志。

（此外，您应该将返回值存储在 中`NSInteger`，而不是`int`。）

# ios - iOS上的Facebook登录使我的应用程序崩溃

> ID：13435286
> 
> 赞同：1
> 
> 时间：2012-11-17T22:11:47.043
> 
> 标签：ios, facebook, login, safari, crash

我正在尝试将 Facebook SDK 集成到我的 iOS 应用程序中。要登录，我打电话：

```
return [FBSession openActiveSessionWithReadPermissions:nil
                                          allowLoginUI:YES
                                     completionHandler:^(FBSession *session, FBSessionState state, NSError *error) {
                                         [self sessionStateChanged:session state:state error:error];
                                 }]; 
```

在 iOS 6.0 模拟器中，它会打开 Safari，在我单击“确定”后，它会返回我的应用程序并返回到完成处理程序，但是当我尝试在我的设备（也是 iOS 6.0）上运行它时，它会打开 Safari 并让我的应用程序崩溃，所以当我在 Safari 中单击“确定”它会从头开始重新启动应用程序，因此需要再次登录。

有趣的是，当我在我的设备上运行 Scrumptious 示例时，它以相同的方式登录，它工作得很好。我已经检查了这两个项目的配置，但我找不到它在 Scrumptious 中有效但在我的应用程序中无效的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T11:10:47.373

事实证明，我的应用程序并没有因为 facebook 而崩溃。我的应用程序是一个 OpenGL 游戏，当应用程序进入后台时我没有正确停止 OpenGL，导致当 facebook 打开 Safari 时 OpenGL 导致游戏崩溃。

# opengl - 为什么这个四边形不渲染？或者如果是为什么我看不到它？

> ID：13435288
> 
> 赞同：1
> 
> 时间：2012-11-17T22:12:01.710
> 
> 标签：opengl, glut, visual-c++-2010

我正在使用 Visual C++ 和 GLUT。我错过了这样一个正常的东西吗？这是我正在使用的确切代码。我试图插入 glNormal3f(0, 0, 1); 在顶点语句之前，但这并没有改变任何东西。glutSolidSphere 的渲染与我预期的一样，但不是四边形。

```
#include "stdafx.h"
#include <stdlib.h>
#include <GL/glut.h>

float spin = 0.0f;
float zDir = 0;
GLfloat diffuseIntensity[] = {.75, .75, .75, 1};
GLfloat specularHue[] = {0, 0, .5f, 1};
GLfloat shininess[] = {5};

void moveCamera();
void checkKeys(int, int, int);
void setUpLighting();
void changeSize(int w, int h) {

    if (h == 0)
        h = 1;

    float ratio =  w * 1.0 / h;

    glMatrixMode(GL_PROJECTION);    
    glLoadIdentity();   
    glViewport(0, 0, w, h); 
    gluPerspective(45,ratio,1,1000);    
    glMatrixMode(GL_MODELVIEW);
}

void renderScene(void) {

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    glLoadIdentity();
    moveCamera();
    glTranslatef(0, 0, zDir-5);
    glEnable(GL_COLOR_MATERIAL);
    glShadeModel(GL_FLAT);
    glMaterialfv(GL_FRONT, GL_SHININESS, shininess);
    glMaterialfv(GL_FRONT, GL_SPECULAR, specularHue);
    glPushMatrix();
    glRotatef(90, 1, 0, 0);
    glRotatef(spin, 0, 0, 1);
    glutSolidSphere(.5f, 24, 24);
    glPopMatrix();
    spin += .01f;
    if(spin > 360) spin -= 360;

    glBegin(GL_QUADS);
    glVertex3f(-10, 0, -10);
    glVertex3f(-10, 0, 10);
    glVertex3f(10, 0, 10);
    glVertex3f(10, 0, -10);
    glEnd();
    glutSwapBuffers();
    glutPostRedisplay();
}

int main(int argc, char **argv) {

    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_DEPTH | GLUT_DOUBLE | GLUT_RGBA);
    glutInitWindowPosition(100,100);
    glutInitWindowSize(800,600);
    glutCreateWindow("Lighthouse3D - GLUT Tutorial");

    glutDisplayFunc(renderScene);
    glutReshapeFunc(changeSize);
    glutSpecialFunc(checkKeys);
    glEnable(GL_DEPTH_TEST);
    setUpLighting();

    glutMainLoop();

    return 1;
}
void moveCamera(){

    glTranslatef(0, 0, zDir);

}

void checkKeys(int key, int x, int y){
    switch(key){

    case GLUT_KEY_UP:
        zDir += .1f;
        glutPostRedisplay();
        break;

    case GLUT_KEY_DOWN:
        zDir += -.1f;
        glutPostRedisplay();
        break;

    case GLUT_KEY_END:
        exit(0);
    }
}

void setUpLighting(){
    GLfloat position0[] = {3, 1, 0, 1};
    glEnable(GL_LIGHTING);
    glEnable(GL_LIGHT0);
    glLightfv(GL_LIGHT0, GL_POSITION, position0);
    glLightfv(GL_LIGHT0, GL_DIFFUSE, diffuseIntensity);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T04:21:01.893

试一试：

```
#include <GL/glut.h>

float zDir = 12;
void checkKeys(int key, int x, int y)
{
    switch(key)
    {
    case GLUT_KEY_UP:
        zDir += -.5f;
        glutPostRedisplay();
        break;

    case GLUT_KEY_DOWN:
        zDir += .5f;
        glutPostRedisplay();
        break;

    case GLUT_KEY_END:
        exit(0);
    }
}

float spin = 0;
void renderScene(void)
{
    glEnable(GL_DEPTH_TEST);

    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    double w = glutGet( GLUT_WINDOW_WIDTH );
    double h = glutGet( GLUT_WINDOW_HEIGHT );
    gluPerspective(45,w/h,0.1,100);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    glTranslatef(0, 0, -zDir);

    // set up light
    glEnable(GL_LIGHTING);
    glEnable(GL_LIGHT0);
    GLfloat diffuseIntensity[] = {.75, .75, .75, 1};
    glLightfv(GL_LIGHT0, GL_DIFFUSE, diffuseIntensity);

    // draw sphere at light position
    glDisable( GL_LIGHTING );
    glPushMatrix();
    // spin light position around the y axis
    glRotatef( -spin, 0, 1, 0 );
    GLfloat position0[] = {3,3,3, 1};
    glLightfv(GL_LIGHT0, GL_POSITION, position0);
    glTranslatef( position0[0], position0[1], position0[2] );
    glColor3ub(255,255,255);
    glutSolidSphere(0.1,8,8);
    glPopMatrix();
    glEnable( GL_LIGHTING );

    // draw sphere
    glEnable(GL_COLOR_MATERIAL);
    glShadeModel(GL_FLAT);
    GLfloat specularHue[] = {0, 0, .5f, 1};
    GLfloat shininess[] = {5};
    glMaterialfv(GL_FRONT, GL_SHININESS, shininess);
    glMaterialfv(GL_FRONT, GL_SPECULAR, specularHue);

    spin += .01f;
    if(spin > 360) spin -= 360;

    glPushMatrix();
    glRotatef(spin, 0, 1, 0);
    glutSolidSphere(2, 24, 24);
    glPopMatrix();

    // draw quad
    glColor3ub(255,0,0);
    glPushMatrix();
    glScalef( 3, 3, 3 );
    glBegin(GL_QUADS);
    glNormal3f( 0, 0, 1 );
    glVertex2f( -1, -1 );
    glVertex2f(  1, -1 );
    glVertex2f(  1,  1 );
    glVertex2f( -1,  1 );
    glEnd();
    glPopMatrix();

    glutSwapBuffers();

    glutPostRedisplay();
}

int main(int argc, char **argv)
{
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_DEPTH | GLUT_DOUBLE | GLUT_RGBA);
    glutInitWindowPosition(100,100);
    glutInitWindowSize(800,600);
    glutCreateWindow("Lighthouse3D - GLUT Tutorial");

    glutDisplayFunc(renderScene);
    glutSpecialFunc(checkKeys);
    glutMainLoop();
    return 1;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T23:40:07.617

渲染了四边形，但您看不到它，因为它绘制得非常像**桌子的表面，而且您的眼睛与桌子处于同一水平面。** 因此，效果就像什么都没有画出来一样。否则你会看到一条线。

上面的旋转被包裹在 PushMatrix/PopMatrix 中仅适用于实心球体。

# forms - 将带有额外字段的多对多关系呈现到表单中

> ID：13435292
> 
> 赞同：9
> 
> 时间：2012-11-17T22:12:19.630
> 
> 标签：forms, symfony, doctrine-orm

我想知道创建一个处理与 symfony2 中的额外字段的多对多关系的表单的最佳方法是什么。

例如，假设我想为用户创建一个通知功能。我有`User`和`Notification`实体。另外为了能够在实体之间的多对多关系中添加额外的参数，我创建了第三个实体`UserNotification`。额外参数指示用户是否已阅读通知。

```
* @ORM\Entity() */
class Notification
{
    /** @Id @Column(type="integer") */
    private $id;

    /** @OneToMany(targetEntity="UserNotification", mappedBy="notification") */
    private $usernotifications;

    /** @Column() */
    private $message;

    ...
}

* @ORM\Entity() */
class User
{
    /** @Id @Column(type="integer") */
    private $id;

    /** @OneToMany(targetEntity="UserNotification", mappedBy="user") */
    private $usernotifications;

    /** @Column() */
    private $name;

    ...
}

* @ORM\Entity() */
class UserNotification
{
    /** @ManyToOne(targetEntity="User", inversedBy="usernotifications")
    private $user;

    /** @ManyToOne(targetEntity="Message", inversedBy="usernotifications")
    private $message;

    /** @Column(type="boolean") */
    private $isRead;

    ...
} 
```

这样我就可以得到这种数据

```
 User
+----+---------+
| id | name    |
+----+---------+
|  1 | John    |
|  2 | Paul    |
+----+---------+

      Notification
+----+----------------------+
| id | message              |
+----+----------------------+
|  1 | Cool stuff           |
|  2 | Lorem ipsum          |
+----+----------------------+

      UserNotification
+---------+-----------------+---------+
| user_id | notification_id | isRead  |
+---------+-----------------+---------+
|  1      |              1  |       1 |
|  2      |              1  |       0 |
|  1      |              2  |       0 |
|  2      |              2  |       1 | 
+---------+-----------------+---------+ 
```

好的，现在问题来了，如何制作一个允许向某些用户发送通知的表单？对于经典的多对多关系，这不是问题。我有`NotificationType`以下内容`builder`：

```
 $builder->add('users', 'entity', array(
                'class' => 'User',
                'property' => 'name',
                'multiple' => 'true',
            ))
            ->add('message', 'text'); 
```

但由于我必须创建中间`UserNotification`实体，我不知道该怎么做。谢谢你的帮助 ;）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T10:59:07.083

I did exactly the same. My `InternalMessage` entity is your `Notification`. In the form, `users` field is not mapped (`property_path` is `false`) and it's validated using a subscriber:

```
public function buildForm(FormBuilder $builder, array $options)
{
    $builder
        ->add('title', 'text', array(
            'label' => 'Titolo *'
        ))
        ->add('content',  'textarea', array(
            'label' => 'Contenuto *'
        ))
        ->add('priority', new PriorityType(), array(
            'label' => 'Priorità *'
        ))
        ->add('users', 'entity', array(
            'label'         => 'Destinatari *',
            'class'         => 'Acme\HelloBundle\Entity\User',
            'property'      => 'select_label',
            'multiple'      => true,
            'expanded'      => true,
            'property_path' => false,
        ));
    ;

    $builder->addEventSubscriber(new AddUsersValidationSubscriber());
} 
```

While in my controller, the only thing i have to do (assuming that form is valid) is to create one `InternalMessageFeedback` entity (the same as your `UserNotification`) fore each user in form model:

```
$message = new InternalMessage();
$form    = $this->createForm(new InternalMessageType(), $message);

// ...

// The sender
$message->setUser($this->getSecurityContext()->getToken()->getUser());

// Persist the inverse side
$em = $this->getEntityManager();
$em->persist($message);

// One feedback for each user
/** @var $user \Acme\HelloBundle\Entity\User */
foreach($form->get('users')->getData() as $user) {
    $feedback = new InternalMessageFeedback();

    // Se the message and user for current feedback
    $feedback->setInternalMessage($message);
    $feedback->setUser($user);

    // Persist the owning side
    $em->persist($feedback);

    // Sync the inverse side
    $message->addInternalMessageFeedback($feedback);
}

$em->flush(); 
```

Hope this helps :)

# ruby-on-rails - 太阳黑子的部分搜索

> ID：13435293
> 
> 赞同：0
> 
> 时间：2012-11-17T22:12:21.020
> 
> 标签：ruby-on-rails, solr, sunspot

鉴于我有一个模型

```
class Firm < ActiveRecord::Base
  searchable do
    text :name
  end
end 
```

而 solr 的 schema.xml 包含

```
<fieldType name="text" class="solr.TextField" omitNorms="false">
  <analyzer>
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.StandardFilterFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
    <filter class="solr.NGramFilterFactory" minGramSize="2" maxGramSize="30"/>
  </analyzer>
  <analyzer type="query">
    <tokenizer class="solr.StandardTokenizerFactory"/>
    <filter class="solr.StandardFilterFactory"/>
    <filter class="solr.LowerCaseFilterFactory"/>
  </analyzer>
</fieldType> 
```

我有一家名为 == 'Ойл-М (Oil-M)' 的公司

当我尝试搜索

```
Sunspot.search(Firm) do
  fulltext 'Ойл-М'
end 
```

然后我什么也得不到

当我尝试搜索

```
Sunspot.search(Firm) do
  fulltext 'Ойл'
end 
```

然后我需要坚定

我应该如何设置 Solr 和/或搜索才能通过这两个查询找到这家公司？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T01:48:51.653

您的 NGramFilter 正在切断最后的“M”，因为您有`minGramSize=2`. 设置`minGramSize=1`会起作用，但这会大大增加 Solr 必须存储的数据大小，并且还会增加噪音。

在 Solr 中索引和查询字段时，会发生两件事：

1.  该字段被分成更小的部分（标记化），
2.  然后过滤每个令牌。

这对于索引和查询*分别发生。*

在这种情况下，您将使用 StandardTokenizerFactory、StandardFilter、LowercaseFilter 和 NGramFilter 对字段进行索引，并使用除 NGramFilter 之外的所有内容查询该字段。

这是将“Ойл-М (Oil-M)”索引到 Solr 时发生的情况。

```
StandardTokenizerFactory: ['Ойл', 'М', 'Oil', 'M']
StandardFilter: ['Ойл', 'М', 'Oil', 'M']
LowerCaseFilter: ['ойл', 'м', 'oil', 'm']
NGramFilter: ['ой', 'йл', 'ойл', 'oi', 'il', 'oil'] 
```

'm' 完全消失了。搜索 "Ойл-М" 不会返回任何内容，因为*没有* `M` *要搜索*的内容。

删除 NGramFilter 除非您有充分的理由使用它，并坚持使用标准的俄语 fieldType。

```
<fieldType name="text_ru" class="solr.TextField" positionIncrementGap="100">                                                            
  <analyzer>                                                                                                                            
    <tokenizer class="solr.StandardTokenizerFactory"/>                                                                                  
    <filter class="solr.LowerCaseFilterFactory"/>                                                                                       
    <filter class="solr.StopFilterFactory" ignoreCase="true" words="lang/stopwords_ru.txt" format="snowball" enablePositionIncrements="~
    <filter class="solr.SnowballPorterFilterFactory" language="Russian"/>                                                               
  </analyzer>                                                                                                                           
</fieldType> 
```

注意：请注意，索引分析器和查询分析器之间没有区别。每个查询都以与索引时完全相同的方式进行转换。

# android - Android Gingerbread 没有从外部内存中捕获堆（即不是 Dalvik 堆内存）？

> ID：13435294
> 
> 赞同：1
> 
> 时间：2012-11-17T22:12:25.373
> 
> 标签：android, unit-testing, out-of-memory, dalvik, robolectric

更新——请原谅我在下面的冗长。尽可能简洁，它的行为是：

```
try {
    mArrowBitmap = BitmapFactory.decodeFile(nam);
} catch(OutOfMemoryError e) {
    Log.e(TAG, "OUT OF MEMORY ERROR!!! ["+e+"]");
} 
```

这意味着当外部堆耗尽时它会抛出 OOME。我可以抓住它，并在单元测试中使用它。

然而，这行为不端：

```
try {
    mArrowDrawable = new BitmapDrawable(mContext.getResources(), mArrowBitmap);
} catch(OutOfMemoryError e) {
    Log.e(TAG, "OUT OF MEMORY ERROR!!! ["+e+"]");
} 
```

这意味着它执行了一个非常令人印象深刻的 suppuku。那时我所能做的就是翻遍它的口袋寻找零钱。

对于那些有更多时间的人来说。. .

问题：我有很多位图，一些来自资源，一些从外部加载。我在设备上做了一些不可避免的操作（即我不能提前做的事情，或者做服务器端的事情）。在加载过程中的某个地方，我至少有一次内存泄漏。我正在追求这一点，并假装有能力（并且花费大量时间盯着 DDMS/MAT）。感谢对 SO 的大量评论，我至少对位图进行了基础研究，尤其是在蜂窝出现之前的位置。我的应用程序运行良好 Honeycomb 和转发。它在姜饼上运行得不太好。我可以

(a) 忽略内存泄漏，因为 Honeycomb 和 forward 最终将回收堆内存，而是尝试让地球上的每个人停止使用 Gingerbread，或者

(b) 隔离并消除内存泄漏。

选项（b）似乎更好。

在 Gingerbread 上，我了解我的位图（包括系统在我加载`.xml`或时神秘地为我创建的位图）的本机“支持”内存`Drawables`都位于 Dalvik 堆之外。我进一步理解，Dalvik 堆上唯一的东西是一个（相对）小的指向本机后备内存的指针。当我试图释放资源时，我必须找到我创建的所有位图，并对它们进行同步`recycle`。我的方案，fwiw，是在我创建它们时将我所有的位图“注册”到一个简单的向量中，然后迭代向量以在本机后备内存中回收任何类似于位图的东西。

出于这个原因，我对来自 Dalvik 堆的各种报告表示手头有大量内存，但我的`decode`调用因内存不足而失败，我并不感到不安。事实上，我已经将我的一些单元测试活动用于将边界推向边缘，以验证我没有行为不端（并且希望将来不要这样做）。我使用“标准”Android 单元测试类进行这些单元测试，因为 Robolectric 无法“看到”我上面提到的堆。忏悔：我真的更喜欢 Robolectric，因为它的速度快了无数倍。

到达这里还有很长的路要走：

当我通过创建太多位图故意运行本机“支持”内存时，*大多数*时候，我得到了我的期望：`OutOfMemoryError.` 我抓住了那个错误并负责任地采取行动（对于非常小的“负责任”值）。

当我胜过`Drawable`调用时（而不是`BitmapFactory`调用，但有时两者都这样做），而不是错误或异常，我在`logcat:`

```
11-17 16:22:39.372: I/dalvikvm-heap(15069): Clamp target GC heap from 33.916MB to 32.000MB
11-17 16:22:39.372: D/dalvikvm(15069): GC_CONCURRENT freed 5K, 39% free 3701K/6023K, external 26854K/27965K, paused 2ms+2ms
11-17 16:22:39.402: D/dalvikvm(15069): GC_EXTERNAL_ALLOC freed 5K, 39% free 3696K/6023K, external 26854K/27965K, paused 36ms
11-17 16:22:39.442: E/dalvikvm-heap(15069): 81796-byte external allocation too large for this process.
11-17 16:22:39.442: E/dalvikvm(15069): Out of memory: Heap Size=6023KB, Allocated=3696KB, Bitmap Size=26854KB, Limit=32768KB
11-17 16:22:39.442: E/dalvikvm(15069): Trim info: Footprint=6023KB, Allowed Footprint=6023KB, Trimmed=404KB
11-17 16:22:39.442: E/GraphicsJNI(15069): VM won't let us allocate 81796 bytes
11-17 16:22:39.462: I/dalvikvm-heap(15069): Clamp target GC heap from 33.912MB to 32.000MB
11-17 16:22:39.462: D/dalvikvm(15069): GC_CONCURRENT freed <1K, 39% free 3696K/6023K, external 26854K/27965K, paused 3ms+2ms 
```

我摸索着夹紧零件。我似乎无法解开的是如何检测中间的部分：

```
11-17 16:22:39.442: E/dalvikvm(15069): Out of memory: Heap Size=6023KB, Allocated=3696KB, Bitmap Size=26854KB, Limit=32768KB 
```

当然，这似乎不是一个`Error`或一个`Exception.` 我可以通过观看 DDMS 手动查看这种不良行为。但是我不知道如何以编程方式隔离它，以便我可以将它合并到我的单元测试中。当然，在我的应用程序中捕捉到这种行为也会很好，这样如果一个错误确实滑过了我的单元测试挑战（它发生（经常发生）），我可能会避免应用程序毫不客气地吐槽它的鞋子。

非常感谢这里的热心人士，他们泰然自若地解释了 Android 内存的奥秘。对于仍在阅读的任何人，并且像我一样对 Android 有趣的内存结构感到困惑，我衷心推荐从这里开始，从[Dubroy 先生的出色演示](http://dubroy.com/blog/google-io-memory-management-for-android-apps/)开始——非常值得一看，尤其是在观众提问的最后。最后是一个离机的人，他就这些同样令人费解的记忆位提出了一些非常见多识广的问题。

我们将不胜感激地接受这里的任何指导。

# powershell - Powershell - 删除两个变量之间的空格

> ID：13435295
> 
> 赞同：5
> 
> 时间：2012-11-17T22:12:30.963
> 
> 标签：powershell

我有两个数组，其中包含一系列字符串，其中包含从文本文件中获取的信息。然后我使用 For 循环遍历两个数组并一起打印出字符串，这恰好创建了文件夹目标和文件名。

```
Get-Content .\PostBackupCheck-TextFile.txt | ForEach-Object { $a = $_ -split ' ' ; $locationArray += "$($a[0]):\$($a[1])\" ; $imageArray += "$($a[2])_$($a[3])_VOL_b00$($a[4])_i000.spi" } 
```

以上获取一个文本文件，将其拆分为单独的部分，将一些信息存储到 中`locationArray`和其他信息中`imageArray`，如下所示：

`locationArray[0]`将会`L:\Place\`

`imageArray[0]`将会`SERVERNAME_C_VOL_b001_i005.spi`

然后我运行一个 For 循环：

```
for ($i=0; $i -le $imageArray.Length - 1; $i++) 
    {Write-Host $locationArray[$i]$imageArray[$i]} 
```

但它在 the`L:\Place\`和 the之间放置了一个空格`SERVERNAME_C_VOL_b001_i005.spi`

所以它变成：`L:\Place\ SERVERNAME_C_VOL_b001_i005.spi`

相反，它应该是：`L:\Place\SERVERNAME_C_VOL_b001_i005.spi`

我该如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T22:22:01.550

**选项 #1** - 为了获得最佳可读性：

```
{Write-Host ("{0}{1}" -f $locationArray[$i], $imageArray[$i]) } 
```

**选项 #2** - 有点混乱，可读性较差：

```
{Write-Host "$($locationArray[$i])$($imageArray[$i])" } 
```

**选项 #3** - 比 #2 更具可读性，但行数更多：

```
{
  $location = $locationArray[$i];
  $image = $imageArray[$i];
  Write-Host "$location$image";
} 
```

# javascript - 获取 jQuery 移动弹出窗口的触发元素

> ID：13435296
> 
> 赞同：2
> 
> 时间：2012-11-17T22:12:39.107
> 
> 标签：javascript, jquery, jquery-mobile

我有一个简单的 jQuery Mobile 弹出窗口，如下所示：

```
<section data-role="popup" data-overlay-theme="a" id="eat">
    Are you sure you want to eat?
</section> 
```

而且我有多个链接触发相同的弹出窗口：

```
<a href='#eat' data-role='button' data-rel='popup' data-position-to='window' data-food="pizza">Pizza</a>
<a href='#eat' data-role='button' data-rel='popup' data-position-to='window' data-food="sandwich">Sandwich</a> 
```

我想知道是否有任何方法可以确定单击了哪个链接以打开弹出窗口。我努力了：

```
$('#eat').on('popupafteropen', function(event) {
    console.log(event);
}); 
```

但是我收到的控制台输出并没有给我任何触发元素的对象（除非我遗漏了一些东西）。有没有办法做到这一点？

**附加信息：**我正在尝试使用链接上的 data-food 属性的值填充其他内容。因此我需要引用`<a>`元素，而不是`<section>`元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T21:28:01.403

我为每个链接添加了一个 id

```
 <a href='#eat' id="pizza"    data-role='button' data-rel='popup' data-position-to='window' data-food="pizza">Pizza</a>
     <a href='#eat' id="sandwich" data-role='button' data-rel='popup' data-position-to='window' data-food="sandwich">Sandwich</a> 
```

并使用了这个脚本

```
<script>
  $('#pizza').on( "click", function() {
    console.log(this);
  });

  $('#sandwich').on( "click", function() {
    console.log(this);
  });
</script> 
```

要使其正常工作，另请参阅[jsfiddle](http://jsfiddle.net/Quxfu/)

点击“披萨”后的控制台 ![在此处输入图像描述](../Images/91245a712ce668617ffe0f42ff51ded8.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T23:47:44.740

```
$('#eat').on('popupafteropen', function(event) {
    console.log(this); // should give you the anchor element
    console.log($(this)); // should give you the jquery anchor element 
}); 
```

你也可以说`event.target`获取 dom 元素。

# c++ - 使用 conio.h 更改文本颜色时出错

> ID：13435298
> 
> 赞同：1
> 
> 时间：2012-11-17T22:13:02.603
> 
> 标签：c++, text, colors

嘿，刚刚找到了一个我想使用的名为 coni.h 的库来更改文本颜色。但是我在其中一个功能中遇到了错误： textcolour(RED); 它说它是未定义的。

```
#include <iostream>
#include <string>
#include <conio.h>
#include "Storyline.h"

using namespace std;

int main()
{

    Storyline story;
    story.Story("Title.txt");
    textcolor(MAGENTA+BLINK);
    cout << "Hello";

    getchar();
    getchar();
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T02:47:23.717

我只是使用了 system("color 0a"); 从**"Windows.h"**。我现在有了我需要的东西。

# java - Which jars do I need to use hibernate 3.5 and hibernate-validator? I'm use Websphere 8.0

> ID：13435300
> 
> 赞同：2
> 
> 时间：2012-11-17T22:13:26.007
> 
> 标签：java, hibernate

I have searched everywhere for a list of jars necessary and they don't seem to be available all in one bundle as they are in 4.x. This is my first go at setting it up. Also, does it matter which version of hibernate validator I use if I'm using Hibernate 3.5? I would like to use 4.x, but I cannot solve this problem:

[Unexpected UnsupportedOperationException on Hibernate validation failure](https://stackoverflow.com/questions/13388069/unexpected-unsupportedoperationexception-on-hibernate-validation-failure/13412563#comment18339301_13412563)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:46:56.277

如果您不使用 maven 进行构建，您应该从[SourceForge](http://sourceforge.net/projects/hibernate/files/hibernate3/3.5.5-Final/)下载 Hibernate 包。它包含您需要的所有依赖项。

另外，我一直在使用 Hibernate Validator 4.3.0.Final 和 Hibernate 3.5.6 final 所以我认为应该没有问题。

[您也可以在SourceForge](http://sourceforge.net/projects/hibernate/files/hibernate-validator/)下载 Hibernate Validator 包。

# symfony - 未找到 PUT /api/users/id 的路由

> ID：13435309
> 
> 赞同：4
> 
> 时间：2012-11-17T22:14:24.750
> 
> 标签：symfony

我正在尝试通过从我的 sencha touch 2 前端调用 put 方法来更新我的 mysql 数据库中的记录。我正在调用这个 url /api/users/id 但我不断收到 Symfony 错误：

```
No route found for "PUT /api/users/1 
```

这就是我的 routing.yml 文件中的内容

```
users:
    resource: "Acme\MainBundle\Controller\UsersController"
    prefix:   /api
    type:     rest 
```

另外，我的 User* *s* *Controller中有 putUsersAction 设置

```
public function putUsersAction($id, Request $request)
{
    $values['birthdate'] = $request->get('birthdate');
    $values['clubid'] = $request->get('clubid');

    $em = $this->getDoctrine()->getEntityManager();

    $user = $this->getDoctrine()
        ->getRepository('AcmeMainBundle:User')
        ->find($id);

    $club = $this->getDoctrine()
        ->getRepository('AcmeMainBundle:Club')
        ->find($values['clubid']);

    $user->setBirthdate($values['birthdate']);
    $user->addClub($club);

    $em->flush();

    $view = View::create()
        ->setStatusCode(200)
        ->setData($user);

    return $this->get('fos_rest.view_handler')->handle($view);
} 
```

为什么 Symfony 告诉我没有 PUT /api/users/id 路由？

编辑 1：路由器：调试输出

```
[router] Current routes
Name                     Method Pattern
_wdt                     ANY    /_wdt/{token}
_profiler_search         ANY    /_profiler/search
_profiler_purge          ANY    /_profiler/purge
_profiler_info           ANY    /_profiler/info/{about}
_profiler_import         ANY    /_profiler/import
_profiler_export         ANY    /_profiler/export/{token}.txt
_profiler_phpinfo        ANY    /_profiler/phpinfo
_profiler_search_results ANY    /_profiler/{token}/search/results
_profiler                ANY    /_profiler/{token}
_profiler_redirect       ANY    /_profiler/
_configurator_home       ANY    /_configurator/
_configurator_step       ANY    /_configurator/step/{index}
_configurator_final      ANY    /_configurator/final
get_users                GET    /api/users.{_format}
post_users               POST   /api/users.{_format}
get_clubs                GET    /api/clubs.{_format}
post_clubs               POST   /api/clubs.{_format}
put_users                PUT    /api/users.{_format} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-17T23:36:32.370

首先，您应该调试路由并查看路由是否正确注册。您发布的路由被剪断缺乏正确的意图。它应该是：

```
user:
    resource: "Acme\MainBundle\Controller\UserController"
    prefix:   /api
    type:     rest 
```

之后，您可以使用控制台命令调试路由：

```
php app/console router:debug 
```

此外，您可以使用 grep (Unix) 或 findstr (Windows) 在输出中搜索您的路线：

```
php app/console router:debug | grep /api 
```

或者

```
php app/console router:debug | findstr /api 
```

接下来确保 FOSRestBundle 的**自动路由**按预期工作，将控制器命名为 User* *s* *Controller 和文件 User* *s* *Controller.php。

请参阅：[FOSRestBundle 文档](https://github.com/FriendsOfSymfony/FOSRestBundle/blob/master/Resources/doc/5-automatic-route-generation_single-restful-controller.md#implicit-resource-name-definition)

请注意，您忘记在刷新之前调用persist($user)，并且您不能在您的用户实体上调用flush，而是在您的EntityManager 上调用。请参阅下面的示例。

您可以通过使用 DependencyInjection 、 symfony2 **ParamConverter**、[隐式资源名称定义](https://github.com/FriendsOfSymfony/FOSRestBundle/blob/master/Resources/doc/5-automatic-route-generation_single-restful-controller.md#implicit-resource-name-definition)和FOSRestBundle提供的**@View Annotation 来大大精简您的控制器。**

然后，您的控制器将读取如下内容：

```
<?php

namespace Acme\MainBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Request;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\ParamConverter;
use JMS\DiExtraBundle\Annotation as DI;
use Acme\MainBundle\Entity\User;
use FOS\RestBundle\Controller\Annotations\View;

/**
 * @DI\Service
 */
class UserController
{

    /** @DI\Inject("doctrine.orm.entity_manager") */
    private $em;

    // ...

    /**
     * @View()
     */
    public function putAction(User $user, Request $request)
    {

        $club = $this->em
            ->getRepository('AcmeMainBundle:Club')
            ->findOneById($request->get('clubid'));

        $user
            ->setBirthdate($request->get('birthdate')
            ->addClub($club);

        // you should add some validation here 

        $this->em->persist($user);
        $this->em->flush();

        return $user;
   }

   // ...
} 
```

说明：

我使用了 JMSDiExtraBundle 的注解。您需要此捆绑包才能使它们工作。

否则，您应该将控制器声明为服务并在服务容器中手动注入 EntityManager（例如在您的包的 Resources/config/services.xml 中）。

使用 @DI\Service 注释将您的控制器声明为服务。

在此处注入您的 EntityManager，以便能够使用带有 @DI\Inject 注释的 $this->em 在整个类中访问它。

使用 FOSRest 的 @View 注释。如果您的应用程序中有 SensioFrameworkExtraBundle，请不要忘记在使用之前设置 sensio_framework_extra.view: { annotations: false }。

确保你有 return $this; 在您的用户实体的 setBirthdate(...) 和 addClub(...) 函数的末尾。

请注意我在示例中使用了 [JMSDiExtraBundle 的属性注入][3]。必须安装捆绑包才能使用。

您可以使用 NoxLogicMultiParamBundle 进一步精简控制器。

**我不能发布超过 2 个链接，因为我是新来的……**

*   请在 google 上查找以下资源：
*   NoxLogicMultiParamBundle
*   FOSRestBundle 文档
*   JMSDiExtraBundle 文档

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:28:36.943

```
user:
    pattern:   /api/user/{id}
    defaults:  { _controller: AcmeMainBundle:User:putUsers, id: 1 } 
```

或者您可以使用 FQCN：

```
defaults:  { _controller: Acme\MainBundle\Controller\UserController::putUsersAction, id: 1 } 
```

并且只匹配 PUT 请求使用下面的代码，虽然有些浏览器不支持 PUT 和 DELETE 看到[这个链接](http://symfony.com/doc/2.0/cookbook/routing/method_parameters.html)

```
user:
    pattern:   /api/user/{id}
    defaults:  { _controller: Acme\MainBundle\Controller\UserController::putUsers, id: 1 }
    requirements:
        _method:  PUT 
```

...当然要查看您的所有路线，请从您的项目文件夹中运行它：

```
php app/console router:debug 
```

# google-apps-script - Google Docs 电子表格表单条目添加记录

> ID：13435317
> 
> 赞同：1
> 
> 时间：2012-11-17T22:15:04.473
> 
> 标签：google-apps-script, google-sheets

我有一个主要由表单维护的 Google 文档表。我有几个函数可以作用于同一个电子表格中的这张表和另一张表。我想让我的一个函数将记录添加到通常输入表单的同一工作表中，但需要这些行中的每一行来保持它们在工作表中的位置。

我注意到，当我通过工作表底部的脚本添加记录时，然后通过表单添加另一条记录，我的脚本记录被向下移动到电子表格的下一行。我能做些什么来防止这种情况（导致表单将下一条记录放在底部，而不仅仅是在最后一个表单输入记录的下方）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T23:26:15.450

我相信您需要将“添加脚本”记录吸收到由浅灰色区域定义的表单响应中。我[在这里](https://stackoverflow.com/questions/10569224/google-apps-script-appendrow-doesnt-increase-form-record-count)提供了一个解决方法，它只是在添加最后一行后“就地”复制它，这会导致它被吸收到浅灰色区域（只要它紧邻它）。

因此，假设您有一个变量`range`用于在脚本末尾设置值，然后使用如下内容：

```
range.setValues(values);
range.copyTo(range); 
```

# jquery - 使用 Jquery 检索列表中的一些 div

> ID：13435321
> 
> 赞同：0
> 
> 时间：2012-11-17T22:15:40.370
> 
> 标签：jquery, list, html, toggle

我的问题看起来很简单：假设我有一个共享同一类“myClass”的 div 列表。使用 Jquery，我想将第一个第一个 div（其中 i 是任意整数）存储在一个变量中，以便一次操作它们（添加类，切换到所有这些）。我怎样才能做到这一点 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:21:36.700

尝试这个：

```
var i=6;
$(".myClass").slice(0,i).each(function(){
       //do whatever you want here. 
       //`this` is a jQuery object of the div element. For example:
       $(this).addClass("newClass");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:28:10.547

如果你想对几个元素采取行动，你有几个选择，假设`$(selector)`返回一个有效的元素选择，并`i`持有相关的数字：

```
// hides all divs greater than the `i`-th
$(selector + ':gt(' + i + ')').hide(); 
```

[通用 JS Fiddle 演示](http://jsfiddle.net/davidThomas/SWRbz/)。或者：

```
// hides all divs less than the `i`-th
$(selector + ':lt(' + i + ')').hide(); 
```

[通用 JS Fiddle 演示](http://jsfiddle.net/davidThomas/SWRbz/1/)。

显然使用您需要的任何 jQuery 方法来代替`hide()`.

参考：

*   [`:gt()`选择器](http://api.jquery.com/gt-selector/)。
*   [`:lt()`选择器](http://api.jquery.com/lt-selector/)。

# java - 在做笛卡尔积时遇到问题

> ID：13435322
> 
> 赞同：0
> 
> 时间：2012-11-17T22:15:41.060
> 
> 标签：java, cartesian-product

我搜索了整个论坛，找不到我要找的东西。我正在为学校做作业，我需要实施一些方法。我做了大部分，得到了我需要的输出。但是，我在实现笛卡尔积 (xproduct) 方法时遇到了麻烦。

到目前为止，这是我的代码：

```
import java.util.*;

public class Set 
{

private ArrayList<String>elements;

/**
 * creates an empty set
 */

public Set()
{
    elements = null;
}

/**
 * creates a set using the elements of the ArrayList s.
 * @param s the ArrayList whose elements are used to create this set.
 * @throws IllegalArgumentException if s contains duplicity.
 */    

public Set(ArrayList<String> s)
{
    int i;
    elements = new ArrayList<String>();

    for(i=0;i<s.size();i++)
    {
        if(elements.contains(s.get(i)))
        {throw new IllegalArgumentException("Set(ArrayList<String>)duplicity not allowed in sets");}

        elements.add(s.get(i));

    }
}

/**
 * creates a set using the elements of the array s.
 * @param s the array whose elements are used to create this set.
 * @throws illegalArgumentException if s contains duplicity.
 */    

public Set(String[] s)
   {
       int i;
       elements = new ArrayList<String>();
       for(i=0; i<s.length; i++)
       {
          if (elements.contains(s[i]))
          {throw new IllegalArgumentException("Set(String[]):duplicity not allowed in sets");}
          elements.add(s[i]);
       }
   }

   /**
    * determines whether a set contains the specified element
    * @param elt an element
    * @return true if elt is an element of this set; otherwise, false
    */

   public boolean isElement(String elt)
   {
       return elements.contains(elt);
   }

   /**
    * determines the size of this set.
    * @return the size of this set.
    */

   public int cardinality()
   {
       return elements.size();
   }

   /**
    * computes the intersection of this set and the
    * specified set.
    * @param s a set
    * @return a set representing the intersection of this set
    *         and s.
    */

   public Set intersect(Set s)
   {
       int i;
       ArrayList<String> result = new ArrayList<String>();
       for (i=0;i<s.cardinality();i++)
       {
           if (this.isElement(s.elements.get(i)))
           {result.add(s.elements.get(i));}
       }  
       return new Set(result);           
   }

    /**
    * computes the union of this set and the specified set.
    * @param s a sets
    * @return a set representing the union of this set
    *         and s.
    */

  public Set union(Set s)
   {
       int i;
       ArrayList<String> result = new ArrayList<String>();
       result.addAll(this.elements);
       result.addAll(s.elements);
       for(i=0;i<s.cardinality();i++)
       {
           if (this.isElement(s.elements.get(i)))
           {result.remove(s.elements.get(i));}
       }
       return new Set(result);
   }

   /**
    * computes the difference between this set and the
    * specified set.
    * @param s a set
    * @return a set representing the difference between
    *         this set and s.
    */

   public Set diff(Set s)
   {
       int i;
       ArrayList<String> result = new ArrayList<String>();
       result.addAll(this.elements);
       for(i=0;i<s.cardinality();i++)
       {
           if (this.isElement(s.elements.get(i)))
           {result.remove(s.elements.get(i));}
       }
       return new Set(result);
   }

   /**
    * computes the symmetric difference between this set
    * and the specified set.
    * @param s a set
    * @return a set representing the symmetrical difference
    *         between this set and s.
    */

   public Set symDiff(Set s)
   {
       int i;
       ArrayList<String> result = new ArrayList<String>();
       result.addAll(this.elements);
       result.addAll(s.elements);
       for(i=0;i<s.cardinality();i++)
       {
           if (this.isElement(s.elements.get(i)) && s.isElement(this.elements.get(i)))
           {result.remove(this.elements.get(i));
            result.remove(s.elements.get(i));}
       }
       return new Set(result);
   }

   /**
    * computes the Cartesian product for this set
    * and the specified set.
    * @param s a set
    * @return a set representing the Cartesian product
    *         of this set and s.
    */

   public Set xProduct(Set s)
   {
       int i;
       ArrayList<String> result = new ArrayList<String>();
       result.addAll(this.elements);
       result.addAll(s.elements);

   }

   /**
    * determines whether a set is empty
    * @return true if this set is empty; otherwise, false
    */

   public boolean isEmpty()
   {
       return elements.isEmpty();
   }

   /**
    * determines whether this set is equal to the specified
    * set.
    * @param s a set
    * @return true if this set is equal to s; otherwise, false
    */

   public boolean equals(Set s)
   {
       return elements.equals(s.elements);
   }

   /**
    * determines whether this set is a subset of the specified set.
    * @param s a set
    * @return true if this set is a subset of s; otherwise, false
    */

   public boolean subset(Set s)
   {
        return elements.containsAll(s.elements);
   }

   /**
    * determines whether this set is a proper subset of the specified set.
    * @param s a set
    * @return true if this set is a proper subset of s; otherwise, false
    */

   public boolean properSubset(Set s)
   {
       if(elements.equals(s.elements) && elements.containsAll(s.elements))
       {return false;}
       else{
           return true;
       }

   }

   /**
    * returns a string {x1,x2,...,xn} representing this set,
    * where x1,x2,...,xn are elements of this set.
    * @return a string representation of this set formatted
    *         as specified.
    */

    @Override
   public String toString()
   {
       return "{"+this.elements+"}";          
   }     

    public static void main(String[] args)
    {
       String[]a1 = {"2","4","6","8"};
       String[]a2 = {"2","3","5","7"};
       String[]a3 = {"1","3","5"};
    Set s1 = new Set(a1);
    Set s2 = new Set(a2); 
    Set s3 = new Set(a3); 

        System.out.print("S1 ="); System.out.printf("%s",s1);
        System.out.println();
        System.out.print("S2 ="); System.out.printf("%s",s2);
        System.out.println();
        System.out.print("S3 ="); System.out.printf("%s",s3);
        System.out.println();System.out.println();

       System.out.println("(S1 \u222A S2:)");
       System.out.printf("%s \u222A %s = %s%n",s1,s2,s1.union(s2));
       System.out.println();

       System.out.println("(S1 \u2296 S2) \u222a (S1 \u2229 S2) \u222a (S2 \u2296 S1)");
       System.out.printf("%s \u2296 %s \u222a %s \u2229 %s \u222a %s \u2296 %s = %s%n",s1,s2,s1,s2,s2,s1,s1.diff(s2).union(s1.intersect(s2).union(s2.diff(s1))));

       //Cartesian Product of s1 and s2
       //Cartesian product of s2 and s1

    }
} 
```

任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:35:38.437

我不明白你为什么有困难，但 Set1 x Set2 的笛卡尔积可以这样计算：

```
Product = {}
Set1\. iterate with i
    Set2.iterate with j
        Product.append (pair(i,j)) 
```

如果您仍然有困难，请告诉我用 Java 编写代码。现在我只发布了伪代码。

# java - 二叉搜索树的字符串表示

> ID：13435323
> 
> 赞同：5
> 
> 时间：2012-11-17T22:15:41.453
> 
> 标签：java, string, recursion, binary-tree, binary-search-tree

我一直在尝试为二叉搜索树编写递归字符串方法，该方法返回具有预排序路径信息的树的多行表示。

每个节点应以一系列 < 和 > 字符开头，显示从根到该节点的路径。我不确定如何使用字符串前缀参数，该参数在每次连续调用时扩展一个字符。

该方法应该能够重现此示例：

树：

```
 15
    /  \
   12  18
  /   /  \
 10  16  20
   \   \
   11  17 
```

预期打印输出：

```
15
<12
<<10
<<>11
>18
><16
><>17
>>20 
```

我是递归的新手，到目前为止，经过数小时的代码弄乱后，我的实际打印输出还不够接近：

```
18
<17
<10
>15
<11
>12
16
20 
```

这是我的正常工作的树节点类：

```
/**
 * A single binary tree node.
 * <p>
 * Each node has both a left or right child, which can be null.
 */
public class TreeNode<E> {

  private E data;
  private TreeNode<E> left;
  private TreeNode<E> right;

  /**
   * Constructs a new node with the given data and references to the
   * given left and right nodes.
   */
  public TreeNode(E data, TreeNode<E> left, TreeNode<E> right) {
    this.data = data;
    this.left = left;
    this.right = right;
  }

  /**
   * Constructs a new node containing the given data.
   * Its left and right references will be set to null.
   */
  public TreeNode(E data) {
    this(data, null, null);
  }

  /** Returns the item currently stored in this node. */
  public E getData() {
    return data;
  }

  /** Overwrites the item stored in this Node with the given data item. */
  public void setData(E data) {
    this.data = data;
  }

  /**
   * Returns this Node's left child.
   * If there is no left left, returns null.
   */
  public TreeNode<E> getLeft() {
    return left;
  }

  /** Causes this Node to point to the given left child Node. */
  public void setLeft(TreeNode<E> left) {
    this.left = left;
  }

  /**
   * Returns this nodes right child.
   * If there is no right child, returns null.
   */
  public TreeNode<E> getRight() {
    return right;
  }

  /** Causes this Node to point to the given right child Node. */
  public void setRight(TreeNode<E> right) {
    this.right = right;
  }
} 
```

这是我的二叉搜索树类，底部附近有 toFullString() 方法：

```
import java.util.*;

/**
 * A binary search tree (BST) is a sorted ADT that uses a binary
 * tree to keep all elements in sorted order.  If the tree is
 * balanced, performance is very good: O(n lg n) for most operations.
 * If unbalanced, it performs more like a linked list: O(n).
 */
public class BinarySearchTree<E extends Comparable<E>> {

  private TreeNode<E> root = null;
  private int size = 0;

  /** Creates an empty tree. */
  public BinarySearchTree() {
  }

    public BinarySearchTree(Collection<E> col) {
        List<E> list = new ArrayList<E>(col);
        Collections.shuffle(list);
        for (int i = 0; i < list.size() ; i++) {
            add(list.get(i));
        }
    }

  /** Adds the given item to this BST. */
  public void add(E item) {
    this.size++;
    if (this.root == null) {
      //tree is empty, so just add item
      this.root = new TreeNode<E>(item);
    }else {
      //find where to insert, with pointer to parent node
      TreeNode<E> parent = null;
      TreeNode<E> curr = this.root;
      boolean wentLeft = true;
      while (curr != null) {  //will execute at least once
        parent = curr;
        if (item.compareTo(curr.getData()) <= 0) {
          curr = curr.getLeft();
          wentLeft = true;
        }else {
          curr = curr.getRight();
          wentLeft = false;
        }
      }

      //now add new node on appropriate side of parent
      curr = new TreeNode<E>(item);
      if (wentLeft) {
        parent.setLeft(curr);
      }else {
        parent.setRight(curr);
      }
    }
  }

  /** Returns the greatest (earliest right-most node) of the given tree. */
  private E findMax(TreeNode<E> n) {
    if (n == null) {
      return null;
    }else if (n.getRight() == null) {
      //can't go right any more, so this is max value
      return n.getData();
    }else {
      return findMax(n.getRight());
    }
  }

  /**
   * Returns item from tree that is equivalent (according to compareTo)
   * to the given item.  If item is not in tree, returns null.
   */
  public E get(E item) {
    return get(item, this.root);
  }

  /** Finds it in the subtree rooted at the given node. */
  private E get(E item, TreeNode<E> node) {
    if (node == null) {
      return null;
    }else if (item.compareTo(node.getData()) < 0) {
      return get(item, node.getLeft());
    }else if (item.compareTo(node.getData()) > 0) {
      return get(item, node.getRight());
    }else {
      //found it!
      return node.getData();
    }
  }

  /**
   * Removes the first equivalent item found in the tree.
   * If item does not exist to be removed, throws IllegalArgumentException().
   */
  public void remove(E item) {
    this.root = remove(item, this.root);
  }

  private TreeNode<E> remove(E item, TreeNode<E> node) {
    if (node == null) {
      //didn't find item
      throw new IllegalArgumentException(item + " not found in tree.");
    }else if (item.compareTo(node.getData()) < 0) {
      //go to left, saving resulting changes made to left tree
      node.setLeft(remove(item, node.getLeft()));
      return node;
    }else if (item.compareTo(node.getData()) > 0) {
      //go to right, saving any resulting changes
      node.setRight(remove(item, node.getRight()));
      return node;
    }else {
      //found node to be removed!
      if (node.getLeft() == null && node.getRight() == null) {
        //leaf node
        return null;
      }else if (node.getRight() == null) {
        //has only a left child
        return node.getLeft();
      }else if (node.getLeft() == null) {
        //has only a right child
        return node.getRight();
      }else {
        //two children, so replace the contents of this node with max of left tree
        E max = findMax(node.getLeft());  //get max value
        node.setLeft(remove(max, node.getLeft())); //and remove its node from tree
        node.setData(max);
        return node;
      }
    }
  }

  /** Returns the number of elements currently in this BST. */
  public int size() {
    return this.size;
  }

  /**
   * Returns a single-line representation of this BST's contents.
   * Specifically, this is a comma-separated list of all elements in their
   * natural Comparable ordering.  The list is surrounded by [] characters.
   */
  @Override
  public String toString() {
    return "[" + toString(this.root) + "]";
  }

  private String toString(TreeNode<E> n) {
    //would have been simpler to use Iterator... but not implemented yet.
    if (n == null) {
      return "";
    }else {
      String str = "";
      str += toString(n.getLeft());
      if (!str.isEmpty()) {
        str += ", ";
      }
      str += n.getData();
      if (n.getRight() != null) {
        str += ", ";
        str += toString(n.getRight());
      }
      return str;
    }
  }

    public String toFullString() {
        StringBuilder sb = new StringBuilder();
        toFullString(root, sb);
        return sb.toString();
    }

  /**
   * Preorder traversal of the tree that builds a string representation
   * in the given StringBuilder.
   * @param n root of subtree to be traversed
   * @param sb StringBuilder in which to create a string representation
   */
  private void toFullString(TreeNode<E> n, StringBuilder sb)
  {

    if (n == null)
    {
      return;
    }

sb.append(n.getData().toString());
    sb.append("\n");

        if (n.getLeft() != null) {
        sb.append("<");
    } else if (n.getRight() != null) {
        sb.append(">");
    }

    if (n.getLeft() != null || n.getRight() != null)
    {
      toFullString(n.getLeft(), sb);   
      toFullString(n.getRight(), sb);
    }
  }

  /**
   * Tests the BST.
   */  
    public static void main(String[] args) {
    Collection collection = new ArrayList();
    collection.add(15);
    collection.add(12);
    collection.add(18);
    collection.add(10);
    collection.add(16);
    collection.add(20);
    collection.add(11);
    collection.add(17);
    BinarySearchTree bst = new BinarySearchTree(collection);
    //System.out.println(bst);      
    String temp = bst.toFullString();
    System.out.println(temp);
    }
} 
```

任何有关递归 toFullString 方法的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:49:15.867

在设计递归解决方案时，您需要考虑两个级别。

1.  如何处理递归中的当前项？
2.  我如何从这个项目转到下一个项目，以及传递哪些信息？

由于我们打印出树中的每个项目，因此每个递归调用内部都会有一个打印语句。但是，打印在每一行中的字符串包含有关为到达当前节点而遍历的先前步骤的信息。我们如何处理这些信息？它需要从以前的递归调用传递到下一个。

以下是一组可能的规则：

1.  如果当前项目是叶子，则打印出当前结果。
2.  如果当前项有左节点，则添加`<`，并递归地作用于左节点。
3.  如果当前项有右节点，则添加`>`，并递归地作用于右节点。

我们要添加`<`什么`>`？我们需要一个参数来执行从递归调用到调用的递归中发生的当前先前步骤。您不想在遍历树时简单地打印出来`<`，`>`因为您需要记住当前的一组步骤来打印出每个节点的前缀。可能有第二个辅助方法，它采用与原始相同的参数`toFullString()`，但有一个自定义的第三个参数来承载当前的先前步骤集。

所以逻辑可能看起来像这样：

*   如果没有当前前缀，则将前缀初始化为`""`，因为根最初没有到达它的步骤。
*   如果当前节点是叶子，则添加一行带有当前前缀+叶子值的输出。
*   如果当前节点有左节点，`toFullString()`则递归调用左节点，并添加`<`到当前前缀字符串，传下来。
*   如果当前节点有右节点，`toFullString()`则递归调用右节点，并添加`>`到当前前缀字符串，传下来。

# database - 如何处理单个数据库列中的多个固定值（数据库设计）

> ID：13435324
> 
> 赞同：0
> 
> 时间：2012-11-17T22:16:04.817
> 
> 标签：database, database-design

我有一张桌子来保留航班，我想保留该航班在一周中的哪几天运行。不需要日期，因为我只需要日期名称。

首先，我想在飞行表中有一个列，它将保留一个包含日期名称的字符串，并使用我的应用程序逻辑来解开信息。这似乎没问题，因为当天唯一的操作就是检索它们。

问题是，我觉得这不够“干净”，所以我想制作一个单独的表来保存所有 7 天的名称和一个多对多（自动生成的）表来保存 flight_id 和 day_id。

尽管如此，days 表上只有 7 个设置值，我也不太确定第二种方法。

我想要的是关于如何处理这个问题的一些其他意见。

*   一个航班可以在一周中的许多不同天运行
*   只需要日期名称 - 因此，总共 7 个。

抱歉英语不好，如果这对某些人来说是一个微不足道的问题。我在英语和数据库方面都不是很有经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:49:19.767

一些数据库支持数组。例如 PostgreSQL 支持[数组](http://www.postgresql.org/docs/9.2/static/arrays.html)。

您可以将日期存储在整数数组中，并使用函数将整数转换为日期名称。您还可以使用自定义枚举类型的数组（[PostgreSQL 示例](http://www.postgresql.org/docs/9.2/static/datatype-enum.html)）。

# c# - Linq-to-SQL gridview 添加总和列

> ID：13435325
> 
> 赞同：0
> 
> 时间：2012-11-17T22:16:12.913
> 
> 标签：c#, asp.net, linq-to-sql, gridview

我在 GridView 中有这个 linq 查询

```
 var table = from ll in dbo.Workers
                    join p in dbo.WorkDays on ll.Id equals p.Id
                    orderby p.Enter
                    select new
                    {
                        ll.Id,
                        ll.Name,
                        ll.Salary,
                        p.Enter,
                        p.ExitT,
                        p.Place,
                        WorkTime = Math.Round(getWorkTime(p.Enter, p.ExitT), 2),
                        Earned = Math.Round(getEarned(p.Enter, p.ExitT, ll.Salary), 2),
                    }; 
```

如何将总和列添加到表中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:24:58.413

创建将保存数据并根据该数据提供计算的类：

```
public class WorkerInfo
{
    // I don't know exact type of fields, but its enough for you to get the idea
    public int Id { get; set; }
    public string Name { get; set; }
    public decimal Salary { get; set; }
    public DateTime Enter { get; set; }
    public DateTime ExitT { get; set; }
    public string Place { get; set; }

    public int WorkTime
    {
       get { return (ExitT - Enter).TotalDays; }
    }

    public decimal Earned
    {
       get { return WorkTime * Salary; }
    }
} 
```

用数据填充这些实体：

```
var workers = from ll in dbo.Workers
              join p in dbo.WorkDays on ll.Id equals p.Id
              orderby p.Enter
              select new WorkerInfo
              {
                 Id = ll.Id,
                 Name = ll.Name,
                 Salary = ll.Salary,
                 Enter = p.Enter,
                 ExitT = p.ExitT,
                 Place = p.Place
              }; 
```

* * *

*用于返回所有日期的聚合数据的*更新示例：**

 *```
var query = from w in dbo.Workers
            join d in dbo.WorkDays on w.Id equals d.Id into days
            let WorkTime = days.Sum(d => d.ExitT - d.Enter)
            select new 
              {
                 w.Id,
                 w.Name,
                 w.Salary,
                 WorkTime,
                 Earned = WorkTime * w.Salary
              }; 
```*

# php - JavaScript 对象共享局部变量

> ID：13435326
> 
> 赞同：3
> 
> 时间：2012-11-17T22:16:39.607
> 
> 标签：php, javascript, jquery

所以我在一些 JavaScript 代码中有一个错误，这让我有些发疯。我一直在尝试模仿 JavaScript 中的经典继承（我知道，我知道，我在这里读到的一半帖子都说不要将 JavaScript 扭曲成这样的框架，但我的应用程序需要有一个映射到我的服务器端 php 代码的继承结构）。大多数情况下，看起来一切正常。这是我用来扩展类的函数：

```
Function.prototype.inheritsFrom = function(parentClass) {
//:: Ordinary Classes
if (parentClass.constructor == Function) {
    this.prototype             = new parentClass();
    this.prototype.constructor = this;
    this.prototype.parent      = parentClass.prototype;

//:: Abstract Classes
} else {
    this.prototype             = parentClass;
    this.prototype.constructor = this;
    this.prototype.parent      = parentClass;
}
return this;
} 
```

不是我自己的创作，我在网上找到的，但效果很好。我唯一需要添加的是一个“超级”函数来搜索原型链的父方法；上述代码中的父结构并非在所有情况下都有效。

无论如何，由于我一直在解决我的代码中的一些错误，我发现我的基“类”中的一种方法是访问/修改从其所有子类创建的所有实例的相同变量。换句话说，每当一个实例修改这个应该是其对象上下文本地的变量时，它实际上修改了一些在所有实例之间共享的变量。这是基类：

```
 function DataManipulatorControl() {
    //|| Private Members ||//

    var that = this;

    //|| Properties ||//

    //|| Root ID
    this.rootID = function(value) {
        if (value !== undefined) {
            if (_root_id !== null) {
                alert('@ ' + _root_id);
                $('#' + _root_id).prop('js_object', null);
            }
            _root_id = value;
            $('#' + _root_id).prop('js_object', this);
        }
        return _root_id;
    }
    var _root_id = null;

    // other properties/methods
}

//|| Class: DataManipulatorContainerControl
function DataManipulatorContainerControl() {
    //|| Private Members ||//

    var that = this;

    // subclass properties/methods
}
DataManipulatorContainerControl.inheritsFrom(DataManipulatorControl); 
```

正如我所提到的，当我创建这些原型的新实例时，我发现更改一个实例的 rootID 会改变所有实例。我的第一个想法是我在某处忘记了“var”，而我的函数正在访问全局上下文。不过，情况似乎并非如此，所以我的下一个想法是它使用了原型本地的变量。不过，这对我来说也没有多大意义，因为原型构造函数调用的本地变量不应该在它之外访问，除非由已经在范围内的方法访问。当然，rootID() 函数确实在范围内，但我的印象是它将使用调用对象的对象上下文而不是原型来运行。

所以，我很困惑。任何可以在这个问题上阐明的观点都会唤起我们的感激之情。

编辑： PRB 提供的文章描述了一个干净地解决这个问题的解决方案 - 主要是。文章指出，您还需要从子类构造函数中调用父类的构造函数以正确初始化所有内容。结果，所有的方法都是新创建的，它们自己的父类局部变量版本都在闭包中。

这种方法似乎确实存在一个缺点（除了在每个实例中复制函数的效率问题）。如果一个人试图从原型链中调用“覆盖”的函数来尝试超级功能，那么这个问题将再次出现。和以前一样，原型是单个对象的实例，尝试调用它们的函数版本将导致它们尝试访问其实例的局部变量。

仍然是我见过的最好的解决方案，除了公开所有数据:-)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:28:20.427

使用这条线可能是问题所在：

```
this.prototype             = new parentClass(); 
```

这意味着该函数的所有实例共享同一个由 parentClass() 定义的内存 blob。这就是为什么当您将值更改为一个时，它会影响所有这些值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T23:15:58.403

好的，所以我在吃晚饭时一直在考虑它，我想我可能对正在发生的事情有所了解。我认为我混淆了由于对象上下文的变化而对函数可用的变量，以及由于闭包而对函数可用的变量。

正如 PRB 指出的那样，我的 rootID() 函数总是从实例化的原型访问内存块。_root_id 被创建为我的基类的构造函数的本地变量，因此当该基类被实例化为原型时，所有使用原型函数的子类将因此读取/写入构造函数中创建的一个变量.

因此，虽然这是创建原型的有效方法，但使用构造函数本地变量隐藏对象的数据在子类中将无法正常工作。相反，我需要读取/写入“this”中的变量，以便它随着对象上下文的变化而变化。如果有人知道更好的方法来处理这个问题 - 一种遵守数据隐藏的方法，请随时发表评论；与我一起工作的许多开发人员都对直接访问数据成员而不是通过访问器感到不安。使代码难以维护：-/。

无论如何，感谢 PRB 的澄清！〜内特

# perl - Perl/DBI/FreeTDS/SQLAzure 一些插入被忽略

> ID：13435327
> 
> 赞同：4
> 
> 时间：2012-11-17T22:16:40.473
> 
> 标签：perl, azure-sql-database, dbi, freetds

我在使用 DBI 和 FreeTDS（在 Ubuntu 上）将一些数据插入 SQL Azure 时遇到了 Perl 的间歇性问题。可能会出现问题并且忽略某些行，然后我可以再次运行它而不会出现问题。

脚本：

```
print "Importing File $file: to Staging Table\n";
    open my $info, $file or die "Could not open $file: $!";

$dbh->do("EXEC DWTOOLS.InitStage;") or die $DBI::errstr ; #truncates the table

    my $sth = $dbh->prepare("INSERT INTO DWSTAGE.CDRImport (LINE) VALUES(?);") or die $DBI::errstr ;
    my $counter = 0;
    while( my $line = <$info>)  {
            $line =~ s/\r?\n$//;
            $counter++;
    print "Loading line $counter: $line\n" ;
            my $rc = $sth->execute($line) or die $DBI::errstr ;
            print "Result: $rc\n";
    }
    close $info;

print "\nChecking Data Warehouse: $counter lines expected\n" ;
my $checksth = $dbh->prepare("EXEC DWTOOLS.CheckStage ?;") or die $DBI::errstr ;
    my $checkrc = $checksth->execute($counter) or die $DBI::errstr ;

my @row;
while ( @row = $checksth->fetchrow_array(  ) ) {
    print "Row: @row\n";
} 
```

给出输出：

```
Importing File filename: to Staging Table
Loading line 1: data redacted
Result: 1
Loading line 2: data redacted
Result: 1
etc. etc. with no indication of errors
Loading line 165: data redacted
Result: 1
Loading line 166: data redacted
Result: 1

Checking Data Warehouse: 166 lines expected
Row: 35 166
Row: 35 166
Loading to Data Warehouse 
```

因此，当我查看表格时，它显示所有开始的行在它开始工作时一直丢失到某个点 - 可靠 - 直到结束 - 所以基本上，文件的最后 35 行被加载并且它们从 1 开始上升到 35，其中第 1 行实际上是第 (166-35+1) 行或其他。Azure 中的表有一个 PK 集群 IDENTITY 列，它从 1 开始并且没有间隙，所以就像第一个这么多插入已被删除而没有任何错误指示。这发生在各种文件、各种大小和文件中的各种位置。

文件被循环处理，每个文件都被打开、处理和关闭，以防与这种奇怪的行为有任何关系。该语句为每个文件重新准备一次，但如果这可能导致问题，SQL Azure 连接将在程序的整个生命周期内保持。如果连接失败，我仍然希望程序会死掉，但从执行返回的错误代码的缺乏来看，我不确定我会得到任何错误指示。

如果我继续并重新运行程序，所有的行都进来了，一切都很好。

我不确定要得出什么结论。现在，我的结论是 FreeTDS 有缺陷且不可靠。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-04T19:06:35.777

看起来数据库在截断过程完成之前正在执行插入。如果这是一个存储过程，您可以添加某种标志它已完成并在继续之前检查它。或者最好还是将整个数据库调用集合到一个事务中。

# java - 如何在（libgdx）阶段检测对图像透明区域的触摸？

> ID：13435338
> 
> 赞同：1
> 
> 时间：2012-11-17T22:18:22.633
> 
> 标签：java, android, libgdx

有人可以帮助检测我在舞台上作为演员使用的图像上的触摸吗？图像实际上是一个长的对角线刷，有很多透明区域。问题是当我触摸画笔图像的透明区域时，它也会触发`ClickListener`图像。我只希望在`ClickListener`触摸可见图像时调用，而不是图像的透明部分。

我正在使用 libgdx-0.9.4 库。这是我的简单代码。

```
import com.badlogic.gdx.scenes.scene2d.ui.Image;
import com.badlogic.gdx.scenes.scene2d.ui.ClickListener;

Image brushImg = new Image(ImageCache.getTexture("brush"));
brushImg.width = mStage.width()*0.75f;
brushImg.height = mStage.height()*0.75f;

brushImg.setClickListener(new ClickListener() {
    @Override
    public void click(Actor actor, float x, float y) {          
        SoundFactory.play("brush");   
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T17:04:50.513

我不认为 libGDX Stage 代码对为 Actor 设置不同的边界框/边界区域有任何特定的支持。但是，您可以做一些其他的事情来解决这个问题。

首先，`ClickListener`如果它们是“无效的”，你可以丢弃它们。例如，如果您有一个简化的边界区域（在对角笔刷的情况下，您可能会使用有角度的矩形）。或者，如果您想要超精确，您可以将触摸区域映射回底层纹理并检查像素是否清晰。

从 libGDX API 文档看来，您可以覆盖`hit`Actor 上的方法来更改触摸的计算方式（并且大概只有在点击成功时才会调用 ClickListener）。这将允许您在调用 ClickListener 之前测试交叉点（这可以允许将触摸转发到舞台上的其他对象）。

# python - 发布到 Wordpress 博客时出现 xmlrpclib 错误

> ID：13435341
> 
> 赞同：1
> 
> 时间：2012-11-17T22:18:45.223
> 
> 标签：python, wordpress, xmlrpclib

几周前，我编写了一个 Python 脚本，该脚本将一些内容发布到了 Wordpress 博客，但自从上周它停止工作（我没有更改任何内容），现在当我运行脚本时，我收到了这个错误：

```
File "C:\Python27\lib\xmlrpclib.py", line 557, in feed
    self._parser.Parse(data, 0)
ExpatError: junk after document element: line 2, column 0 
```

我用来将所需内容发布到 Wordpress 的功能是：

```
post_id = server.wp.newPost(blog_id, user, passw, content) 
```

它曾经工作过，因为它（显然）无缘无故开始崩溃。

¿ 您现在知道导致此错误的原因是什么吗？¿ 我的 Wordpress 可能已被感染（我已经检查过）？

谢谢，如果您需要更多代码来检查我会发布的内容，并为我糟糕的英语感到抱歉。

**重要编辑**：我之前没有提到这一点，但是该脚本与其他 wordpress 博客完美配合，它只会在我尝试发布到我为其编写脚本的 WP 博客时崩溃（这就是我认为该网站可能被感染的原因） .

当代码工作时，`data`使用的变量`self._parser.Parse(data, 0)`具有以下内容：

```
<?xml version="1.0"?>
<methodResponse>
  <params>
    <param>
      <value>
      <string>90</string>
      </value>
    </param>
  </params>
</methodResponse>

<?xml version="1.0"?>
<methodResponse>
  <params>
    <param>
      <value>
      <int>90</int>
      </value>
    </param>
  </params>
</methodResponse> 
```

**编辑**：库使用数据变量，我不知道它应该包含什么，但调试我发现当脚本崩溃时它具有以下内容：

```
<br />
<b>Warning</b>:  strpos() [<a href='function.strpos'>function.strpos</a>]: Empty delimiter in <b>/PATH/wp-includes/class-wp-xmlrpc-server.php</b> on line <b>3954</b><br />
<br />
<b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /PATH/wp-includes/class-wp-xmlrpc-server.php:3954) in <b>/PATH/wp-includes/class-IXR.php</b> on line <b>471</b><br />
<br />
<b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /PATH/wp-includes/class-wp-xmlrpc-server.php:3954) in <b>/PATH/wp-includes/class-IXR.php</b> on line <b>472</b><br />
<br />
<b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /PATH/wp-includes/class-wp-xmlrpc-server.php:3954) in <b>/ANOTHER_PATH/public_ht 
```

正如我所说，我不知道“数据”应该包含什么，当代码工作时，我从未检查过它的内容是什么。

# java - Netty 处理程序的调用顺序是什么？

> ID：13435342
> 
> 赞同：3
> 
> 时间：2012-11-17T22:19:12.420
> 
> 标签：java, networking, asynchronous, netty

我是 Netty 的新手，对 ChannelPipelines 有点困惑。这个概念看起来相当优雅，但我在两点上苦苦挣扎：

1.  处理程序调用的顺序是如何定义的？

2.  框架如何处理向编码器的上游发送？或下游发送到解码器？他们只是被传递吗？它们甚至会发生吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T15:20:01.657

1）处理程序的调用如下：

上游 => 从第一个到最后一个

下游 => 从最后一个到第一个

2）上游永远不会传递给编码器，下游永远不会传递给解码器

# actionscript-3 - 在 Flex 的 HGroup 中动态创建单选按钮

> ID：13435349
> 
> 赞同：0
> 
> 时间：2012-11-17T22:20:26.327
> 
> 标签：actionscript-3, apache-flex, dynamic, radio-button, flex-spark

我正在用 Flex 4 编写一个应用程序。

我像这样创建了一个 HGroup：

```
<s:HGroup id="hgMods">
</s:HGroup> 
```

然后，在 Actionscript 中，我循环遍历一个集合并将单选按钮动态添加到 RadioButtonGroup。然后，我想将该 RadioButtonGroup 添加到 HGroup。

这是我当前的代码：

```
var rbg:RadioButtonGroup = new RadioButtonGroup();

for each (var obj:[some object] in [some collection]) {             

    var rbGroupName:RadioButton = new RadioButton()
    rbGroupName.label = obj.[some named value].toString()
        rbGroupName.group = rbg;

} 
```

现在，如何将 RadioButtonGroup 添加到 HGroup？

我试过`hgMods.AddChild(rbg);`

当我这样做时，我得到了错误：

> 1067：将 spark.components:RadioButtonGroup 类型的值隐式强制转换为不相关的 flash.display:DisplayObject 类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:39:29.930

正如错误消息所说：[RadioButtonGroup](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/components/RadioButtonGroup.html) is not a `DisplayObject`，这意味着它不是视觉元素，因此您无法将其添加到显示列表中。`RadioButtonGroup`s 的功能是在`RadioButton`逻辑上而不是视觉上将 s 组合在一起。

解决方案是将每个 RadioButton 直接添加到 HGroup。您可以保持其余代码不变。只需在循环中添加这一行：

```
hgMods.addElement(rbGroupName); 
```

# django - 从表单访问用户信息

> ID：13435350
> 
> 赞同：0
> 
> 时间：2012-11-17T22:20:28.933
> 
> 标签：django, django-models, django-forms

我有一个包含用户对象的模型，以及基于此模型的扩展表单。
如何访问表单中用户对象的字段？如果这不是这样做的方法，那么推荐的方法是什么？

**模型.py**

```
class Driver(models.Model):
    user = models.OneToOneField(User)
    phone = models.CharField(max_length=200)
    mobile = models.CharField(max_length=200) 
```

**表格.py**

```
class DriverRegistrationForm(ModelForm):
    class Meta:
        model = Driver 
```

**page.html**（我本来想做的……）

```
<label for="id_username">Username<span class="small">Add your name</span></label>{{form.user.username}}<!-- Not like this... -->
<label for="id_password">Password <span class="small">Small and big letters</span></label>{{form.user.password}}<!-- Not like this... -->
<label for="id_phone">Phone <span class="small">Your phone number</span></label>{{form.phone}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T12:19:22.707

在这种情况下，您还可以扩展默认的用户创建表单

```
from django.contrib.auth.forms import UserCreationForm
from django.contrib.auth.models import User

class DriverRegistrationForm(UserCreationForm):
    phone = models.CharField(max_length=200)

    class Meta:
        model = User
        fields = ("username", "phone", "password1", "password2") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T11:05:24.577

您的用户详细信息存储在`User`django 的 default 类中`django.contrib.auth.models`。这意味着您希望用户输入的“用户名”和“密码”的值分别存储在`User`数据库的该表中，但与您的自定义`Driver`类相关。

我不会`forms.ModelForm`在这种情况下使用，但我会改为使用`forms.Form`。

像这样：-

```
from django import forms

class DriverRegistrationForm(forms.Form):
    username = forms.CharField(label='Username')
    password = forms.CharField(label='Password', widget=forms.PasswordInput)
    phone = forms.IntegerField(label='Phone')
    mobile = forms.IntegerField(label='Mobile') 
```

在`view function`处理此`form`实例提交的您中，您现在将有 4 个值来自您的`form.cleaned_data`字典。

然后，您可以处理用户对象的创建，因为您的字典中有一个`username`和。`password``form.cleaned_data`

一旦你有了你的用户对象，你现在可以`Driver`通过分配来创建你的对象：-

```
def register_driver(request):

    form = DriverRegistrationForm()

    if request.method == 'POST':

        form = DriverRegistrationForm(request.POST or None)

        if form.is_valid():
            cd = form.cleaned_data

            # Creating your user object
            user = User.objects.create_user(username=cd['username'], password=cd['password'])

            # Creating the driver object that is related to your user object above.
            Driver.objects.create(user=user, phone=cd['phone'], mobile=cd['mobile'])

   #  .... Finish your view function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T13:10:22.010

尝试

```
{{ form.instance.user.username }} 
```

# jquery - 单击 div 时其他功能被禁用？

> ID：13435354
> 
> 赞同：0
> 
> 时间：2012-11-17T22:20:58.353
> 
> 标签：jquery, function, onclick

```
<div id="element1" onclick="change();">1</div>
<div id="element2" onclick="change();">2</div>
<div id="element3" onclick="change();">3</div> 
```

当单击 element1 进程更改功能和其他 onclick 功能不起作用。我怎么能用jquery做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:22:56.160

[`.one()`](http://api.jquery.com/one/)一种解决方案是使用只运行一次的 jQuery函数。

前任：

```
$('#element1,#element2,#element3').one("click", function() {
  console.log("This will be displayed only once.");
}) 
```

这也将允许您删除您拥有的内联 JavaScript 以获得更简洁的代码。

# java - 重力方程 - 速度方程 | 为什么它只适用于某些 FPS？

> ID：13435355
> 
> 赞同：1
> 
> 时间：2012-11-17T22:21:01.147
> 
> 标签：java, gravity

这些方程的跳跃大小随着每秒更新量的下降而减小。使用 delta 值乘以重力和 jumpspeed 力减小的量，以及每次迭代都通过 delta 增加经过的时间（delta 值是自上次更新以来经过的毫秒数），人们会认为它可以正常工作。

```
//d is delta
...
if(isFalling||isJumping){

        elapsedTime +=d;
//the elapsed time is the total amount of time passed since one started jumping,
//so that's logical to add the amount of time since last update.

        long tesquared = (long) Math.pow(elapsedTime, 2);
//amount of time elapsed squared.

        jumpSpeed+=-0.0000005*elapsedTime*d;
//this is the amount that jumpspeed is taken down by every time. 

        if(jumpSpeed > 0){
            isJumping = true;
        } else {
            isJumping = false;
        }
        double fGravity = 0.0000001*tesquared*d;

// this is the equation for gravity, the amount that the player goes down

        yRend += jumpSpeed - fGravity;
    //the amount it goes up, minus the amount it goes down.
        xRend -= strafeSpeed;
        oldyRend = yRend;

    } 
```

要开始跳跃，可以将 jumpSpeed 增加任意数量。

问题在于，当每秒更新量减少时，跳跃的持续时间和幅度都会减少。我相当肯定这里的 delta 值很好，这意味着问题必须出在方程本身。

我认为当增量较大时，它`fGravity`会`jumpSpeed`更快地超出。

所以我的问题。如果问题真的出在方程本身，那么模拟玩家向上的力减去向下的重力的正确方法是什么？

`jumpSpeed+=-0.0000005*elapsedTime*d;`

和

`double fGravity = 0.0000001*tesquared*d;`?

如果问题在于未正确应用 delta 值，那么应用它的正确方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:36:47.907

玩家没有“向上的力量”（除非在他们跳跃的那一刻）。力赋予*动量*产生*速度*。一旦在空中，它们确实会感受到*向下*的力（即重力），导致它们减速，最终产生负速度，使它们返回地面。

如果玩家开始以速度向上跳跃`u`，那么在跳跃`t`开始后的时间，计算位置的经典方程为`y = ut + 0.5 * at^2`。

在这种情况下，`a`是重力（如果`y`是“向上”，则为负数），给出`y = u * t - 0.5 * g * t ^ 2`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:39:30.663

基本上跳跃的方程是这样的：

重力垂直施加并向下产生恒定的力。所以垂直速度是 vy = vy0 - elapsedTime * g 其中 g 是重力常数， vy0 是跳跃开始时的初始速度。

您不必计算经过的时间。只需在每一帧，您都这样做：

```
vy -= g * dt; // dt is the elapsed time since last frame

y += vy * dt;
x += vx * dt; // vx doesn't change in the jump 
```

# php - 通过 Ajax 加载图像时没有获得滑动效果

> ID：13435357
> 
> 赞同：0
> 
> 时间：2012-11-17T22:21:26.077
> 
> 标签：php, jquery

我需要从每个部分加载不同的图像并为每个部分使用图像滑块。

例如：部分选项卡：IT-信息安全-周三开发...等。

然后，当用户单击任何部分时，将显示与该部分相关的图像滑块。

所以我用 Ajax 创建了它。

主页 ：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>test </title>
<link rel="stylesheet" type="text/css" href="demo.css" />
<script type="text/javascript" src="jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="newscript.js"></script>
    <link href="themes/2/js-image-slider.css" rel="stylesheet" type="text/css" />
    <script src="themes/2/js-image-slider.js" type="text/javascript"></script>
    <link href="generic.css" rel="stylesheet" type="text/css" />
</head>

<body>

<div id="rounded">
<img src="img/top_bg.gif" alt="top" /><div id="main" class="container">
    <ul id="navigation">
    <?php
       include("samiloxide.php");
       $sql=mysql_query(" select * from  section ");

       while($r=mysql_fetch_array($sql)){
           echo "<li><a  onclick='loadpage($r[id])' >$r[section]</a></li>" ;
       }
    ?>

    <li><img id="loading" src="img/ajax_load.gif" alt="loading" /></li>
    </ul>

    <div class="clear"></div>        
    <div id="pageContent">
  </div>   
........... 
```

JavaScript 文件：

```
 var section;
    function loadpage(section){ 
       var section = section.toString();      
       $.ajax({
          type: "POST",
          url: "get.php",
          dataType: "script",
          data: ({section : section}),
          success: function(html){
             $("#pageContent").empty();
             $("#pageContent").append(html);
          }
       });
     }

------- 
```

获取.php 文件：

```
 <div id="sliderFrame">
        <div id="slider">

           <?php
        include("samiloxide.php");
        //if(!$_POST['page']) die("0");

        $section = (int)$_POST['section'];

        $sql=mysql_query(" select * from images   where section='$section'");

        while($rr=mysql_fetch_array($sql)){
           echo " <img src='$rr[image]' alt='text..' />";
                }
           ?>

        </div>
..... 
```

滑块不起作用只是加载没有滑动效果的图像！但是如果我从浏览器调用 get.php ......等等它的工作??!! 我的 Ajax 代码有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:30:55.343

这个滑块脚本似乎不喜欢/支持动态生成的 img 标签，而是映射/绑定到 DOMLoad 上的标签。

在 DOM 中插入图像完成后，调用 imageSlider.reload()。因此，在您的情况下，它将在 AJAX 完成回调中的 .html() 调用之后。

# java - Java并发修改异常：如何处理？

> ID：13435359
> 
> 赞同：-2
> 
> 时间：2012-11-17T22:21:28.070
> 
> 标签：java, exception, concurrentmodification

我正在编写一个文本文件爬虫程序并不断收到 ConcurrentModificationException。我知道这与使用 Iterator 有关，但我不确定如何修复它。请帮忙！

例外是：

```
Exception in thread "main" java.util.ConcurrentModificationException
        at java.util.LinkedHashMap$LinkedHashIterator.nextEntry(unknown Source)
        at java.util.LinkedHashMap$KeyIterator.next(Unknown Source)
        at TextCrawler.main(TextCrawler.java:112) 
```

代码：

```
while(it1.hasNext() && wordCount2 < wordCountToFind2) { //while there are more files to be searched and the wordCount is less than max occurrences 
           wordCount2 = 0;
           Iterator it3 = occurrencesVector.iterator();
           while(it3.hasNext()) { //get current wordCount
             wordCount = (Integer)it3.next();
             wordCount2 += wordCount;
             System.out.println("WordCount2...." + wordCount2); //Test
           }
           String nextFile = (String)it1.next(); //this is line 112
           System.out.println("nextFile...." + nextFile + "\n" + "\n"); //Test
           if(i > 0) { //skips the initial input filename (which is at the start of filenameSet) so it's not checked twice
             System.out.println("Start searchFile method"); //Test
             try{txtCr2.searchFile(nextFile, wordToFind2, wordCountToFind, caseSensitive);} //call searchFile method
             catch(IOException e){System.out.println("txtCr2 exception, searchFile method didn't happen!"); e.printStackTrace();};
           }
           i++;
           System.out.println("i = " + i);
         } 
```

searchFile 方法的完整代码：

```
public void searchFile(String filename, String wordTF, String wordCountTF, String caseS) throws IOException
 {
    FileReader aFileReader = new FileReader(new File(filename)); //make the file readable
    BufferedReader aBufferedReader = new BufferedReader(aFileReader);
    String newFile, lineFromFile, updatedLine = "", filePattern = "\\([a-zA-Z0-9]{1,32}.txt\\)", outputMessage = "";
    char aChar;
    int wordCount = 0, occurrencesToFind;
    occurrencesToFind = Integer.parseInt(wordCountTF); //convert passed down String to int
    filenameSet.add(new String(filename)); //add the filename to the LindedHashSet

    while((lineFromFile = aBufferedReader.readLine()) != null) { //while lineFromFile is not empty
      for(int i = 0; i < lineFromFile.length(); i++) { 
        aChar = lineFromFile.charAt(i); //go through each line character by character
        if(Character.isLetterOrDigit(aChar) || Character.isWhitespace(aChar) || aChar == '(' || aChar == ')' || aChar == '.') 
          if(aChar == '(') //if the character is ( then add a space in front of it
            updatedLine = updatedLine +  " " + aChar;  
          else
          if(aChar == ')') //if the character is ) then add a space after it
            updatedLine = updatedLine + aChar + " ";
          else
            updatedLine = updatedLine + aChar; //if the character is a letter, digit or whitespace just add it to the updatedLine
      }    //all unwanted punctuation is removed
    } 
    aFileReader.close();
    aBufferedReader.close();

    String [] fileArray = updatedLine.toLowerCase().split(" "); //split the updatedLine into an array at the whitespaces.

    //for(int i = 0; i < fileArray.length; i++) //Test
      //System.out.println(fileArray[i]);

    boolean fileSearched = false;

    while(wordCount < occurrencesToFind && !fileSearched) { //while the wordCount is less than the required wordCount and the file hasn't been completely searched.
      if(caseS.equals("1")) { //if the word to be checked is case sensitive
        for(int j = 0; j < fileArray.length; j++) { //for the length of the array
          if(fileArray[j].equals(wordTF)) //if a word in the fileArray exactly equals the word to be searched
            wordCount++; //add a count of one to the wordCount
          if(fileArray[j].matches(filePattern)) { //if a word in the fileArray matches the filePattern e.g. (filename.txt)
            newFile = fileArray[j].substring(1,fileArray[j].length() -1); //newFile is equal to the filePattern with round brackets removed.
            System.out.println("New File found..." + newFile); //Test
            filenameSet.add(new String(newFile)); //add it to the LinkedHashSet
          }
        }
        fileSearched = true; //file has been searched
      }
      else { //else if the word to be checked isn't case sensitive
        for(int j = 0; j < fileArray.length; j++) { //for the length of the array
          if(fileArray[j].toLowerCase().equals(wordTF.toLowerCase())) //not case sensitive so make both search word and fileArray word lower case
            wordCount++; //if they are equal add a count of one to the word count
          if(fileArray[j].matches(filePattern)) { //if a word in the fileArray matches the filePattern e.g. (filename.txt)
            newFile = fileArray[j].substring(1,fileArray[j].length() -1); //newFile is equal to the filePattern with round brackets removed.
            System.out.println("New File found...." + newFile); //Test
            filenameSet.add(newFile); //add it to the LinkedHashSet
          }
        }
        fileSearched = true; //file has been searched
      }
    }
    occurrencesVector.addElement(new Integer(wordCount)); //add the wordCount to the occurrences LinkedHashSet
    System.out.println("occurrencesVector contains.." + occurrencesVector); //Test
    System.out.println("filenameSet contains.." + filenameSet);  //Test
    System.out.println("End of searchFile method.\n\n"); //Test
 } 
```

发生向量：

```
public class TextCrawler
{
 static LinkedHashSet<String> filenameSet = new LinkedHashSet<String>();
 static Vector<Integer> occurrencesVector = new Vector<Integer>(); 
```

它1：

```
System.out.println("\nStarting initial file search in..." + startFile2);
         try{txtCr.searchFile(startFile2, wordToFind2, wordCountToFind, caseSensitive);}
         catch(IOException e){System.out.println("txtCr exception");};

         boolean nextFileSearched = false;
         int wordCount, wordCount2 = 0, wordCount3, wordCount4 = 0; 
         Iterator it1 = filenameSet.iterator();
         Iterator it2 = occurrencesVector.iterator();
         int i = 0;

         while(it2.hasNext()) { //get current wordCount
           wordCount = (Integer)it2.next();
           wordCount2 += wordCount;
         }

         while(it1.hasNext() && wordCount2 < wordCountToFind2) { //while there are more files to be searched and the wordCount is less than max occurrences 
           wordCount2 = 0; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T23:35:27.313

ConcurrentModificationException 意味着您正在使用“过期”迭代器。

迭代器已“过期”，因为它当前正在抓取的集合已更改。

这是一个很好的代码示例来演示：

```
public static void main(String[] ar) {
    LinkedList<Integer> l = new LinkedList<Integer>();

    l.add(1);
    l.add(2);
    l.add(3);

    Iterator<Integer> i1 = l.iterator();

    System.out.println(i1.next());
    System.out.println(i1.next());

    // Here we modify the content of "l"
    l.add(4);

    // After modifying the content of "l" we try to get the next element of the iterator: this will throw an exception
    System.out.println(i1.next());
} 
```

# c# - 在 WPF 和类之间传递数据

> ID：13435361
> 
> 赞同：0
> 
> 时间：2012-11-17T22:21:51.723
> 
> 标签：c#, wpf

我面临一个我不知道如何实现 WPF 的问题。我承认对 WPF 很陌生。

我有一个复杂的项目，我在这里抽象了很多。该项目是管理许多不同的 USB 设备。该设备在一个类（“管理器类”）中进行管理，该类处理连接、断开连接、设备设置、接收数据和更自动化的例程。

我创建了一个 WPF，但我不确定如何将数据导入 WPF，因为我需要在 WPF 上实时显示很多事情（连接/断开/更新）。我首先在 WPF 的 C# 代码中创建了一些停靠面板。这是为了建立启动结构。我面临的问题是向 WPF 发送“管理器类”已更新的信号，我还必须更新 WPF（添加面板、设置复选框等）。

我很感激任何提示，因为我真的没有实现这一点的起点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:37:53.743

在 WPF 的上下文中查看数据绑定、INotifyPropertyChanged 和可观察对象和集合（google 或 bing）。你会发现吨......这是一个简单的数据绑定示例[http://blogs.msdn.com/b/wpfsdk/archive/2006/10/19/wpf-basic-data-binding-faq.aspx](http://blogs.msdn.com/b/wpfsdk/archive/2006/10/19/wpf-basic-data-binding-faq.aspx)

当您对此感到足够节省时，我建议您研究 MVVM。这种模式有助于在基于 XAML 的语言中构建和分离代码的关注点......

高温高压

# mysql - 存储在 VARCHAR mysql 中的长字符串输出为一行

> ID：13435371
> 
> 赞同：2
> 
> 时间：2012-11-17T22:22:57.547
> 
> 标签：mysql

我一直在寻找这个问题的答案，但似乎无法在任何地方找到它。我的问题是我有一个带有列名的表，`description`它也设置了`VARCHAR(1000)`我有几个很长的字符串要输入到该列中，但是当我`MySQL`从命令行使用并希望查看所有值`SELECT * FROM EXAMPLE_TABLE`时，它将输出`description`列作为一个长字符串并使整个屏幕不可读，除非我明智地拉伸终端窗口宽度。有没有办法防止这种情况，使其仅与终端窗口一样宽，所以我不必拉伸窗口？我可以添加换行符吗？我希望我提供了足够的信息

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T22:29:27.547

您可以使用 \G 而不是 ; 在查询结束时。这样，结果将垂直显示，并且更具可读性。

```
SELECT * FROM EXAMPLE_TABLE\G 
```

# java - 以一定比例将随机值均匀分布在二维数组中

> ID：13435372
> 
> 赞同：3
> 
> 时间：2012-11-17T22:23:13.230
> 
> 标签：java, arrays, multidimensional-array, random

假设我有一个百分比列表。

```
Map<Integer, Integer> ratio = new HashMap<Integer, Integer>();
ratio.put(0, 10);
ratio.put(1, 50);
ratio.put(3, 40); 
```

然后我有一个二维数组。

```
int[][] arr = new int[50][50]; 
```

现在我想随机但均匀地分配定义的值`0`，`1`并`3`以它们各自的比率`10`,`50`和`40`在该数组中。

我怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:29:37.957

用第一个零、第二个 1 和 3 填充一维数组。

就像是：

```
int arr[N][M] = //;
int array[N*M] = //;
int total_array_2D_size = N * M;
int j = 0;
Set<Map.Entry<Integer, Integer>> set = ratio.entrySet();  

for (Map.Entry<Integer, Integer> entry : set)
{
    int k = entry.getKey();        // Take the number
    int ratio = entry.getValue();  // Take the ratio
    int N = (total_array_2D_size * ratio) / 100; // The number of times 'k' should
                                                 // appear on the finally 2D array

    for(int i = 0; i < N; i++,j++) array[j] = k; // Fill the 1D array
} 
```

比采用[Shuffle 算法](http://www.vogella.com/articles/JavaAlgorithmsShuffle/article.html)并打乱你的一维数组。最后填满你的二维数组。

```
for(int i = 0,k = 0; i < N; i++)
  for(int j = 0; j < M; j++,k++)
     arr[i][j] = array[k]; 
```

由于您的二维数组有 2500 个位置 (50^2)，最后您应该有 250 个 '0' (0.10 * 50^2)、1250 个 '1' (0.50 * 50^2) 和 1000 个 '3' (0.4 * 50^2)。

# c - 为什么 malloc 返回 NULL 并具有大量内存并且总是在同一点？

> ID：13435374
> 
> 赞同：6
> 
> 时间：2012-11-17T22:23:47.847
> 
> 标签：c, memory, null, malloc, heap-memory

我对一个我无法克服的错误感到非常绝望。

对于我在大学的 C 编程课，我必须为 GML（图形建模语言）输入流实现解析器。

成功时，解析器向调用者返回一个抽象数据类型，它是一个作为图形表示的邻接矩阵。

好的，解析器完美地工作，在过去的几天里让我感到绝望不会有问题。在解析器中，有一个函数调用又调用 malloc。malloc 在扫描器将逐个符号传递给解析器期间经常被调用。但是在离开扫描程序例程之前，总是通过调用 free() 来释放 malloc 的内存块。

但是在解析器的深处有一个致命的函数调用，它又调用了一个函数，该函数使用 malloc 保留 12 个字节的内存（三个整数属性）以保存结构。需要该结构来存储有关图中单个边的信息（源节点、目标节点、权重）。

该调用进行了两次。第一次，一切顺利。然后，由于根据 gml 语法可能出现 1 到 n 条边，代码进入一个 while 循环，只要在输入流中找到边，相同的指针就会被分配一个指向新边结构的指针。循环内的边缘识别例程的第一次调用，总共是第二次（第一次发生在进入循环之前，参见 ma），由于 malloc 返回 NULL 而不断失败。

我根本不知道为什么。

这与内存短缺问题无关，因为当我在该程序的 main() 函数中 malloc 1000 字节时，只是为了好玩，它工作正常。

我使用 Code::Blocks 和 DevCPP 作为 IDE。在这两种情况下，程序都会遇到同样的问题。

这是我的主要解析例程：

```
DirectedGraph Graph(char* sourceString, int*currentPosition){

 int sym;
 int restartPosition = 0;
 int* backupPosition;
 char* backupString;
 int nodeCount = 0;

 int currentSrc = -1;
 int currentTgt = -1;
 int currentWgt = -1;
 EdgeDescription e;
 DirectedGraph correctMatrix;
 MatrixStruct* errorMatrix = NULL;

 /*begin parsing*/
 bool isGraphHeader = GraphHdr(sourceString, currentPosition);

 if(isGraphHeader == true){

  bool isNode = Node(sourceString, currentPosition);

  if(isNode == true){

     while(isNode == true){

        nodeCount++;
        restartPosition = *currentPosition;
        isNode = Node(sourceString, currentPosition);

     }

     *currentPosition = restartPosition;

     /*now get edge information (from-to-weight)*/
     /*as we have already read the next symbol, we have to reset*/
     /*our read position by one symbol backwards*/
     e = Edge(sourceString, &restartPosition);  /*<======== HERE I CALL THE FATAL ROUTINE FOR THE FIRST TIME - EVERYTHING´s JUST FINE, PROGRAM PROCEEDS*/
     restartPosition = 0;

     /*just for clearer coding in if statement*/
     currentSrc = e->source;
     currentTgt = e->target;
     currentWgt = e->weight;
     destroyEdge(e);

     if(currentSrc != -1 && currentTgt != -1 && currentWgt != -1){

        /*initialize matrix with counted number of nodes*/
        correctMatrix = CreateNewGraph(nodeCount);

        /*the edge is inserted only when it lies within the boundaries*/
        /*of our graph. but we do not interrupt the whole processing, we just skip it.*/
        while(currentSrc != -1 && currentTgt != -1 && currentWgt != -1){

           if(currentSrc <= nodeCount && currentTgt <= nodeCount){

              InsertEdge(correctMatrix, currentSrc, currentTgt, currentWgt);
              restartPosition = *currentPosition;
           }

           e = Edge(sourceString, currentPosition); /* <============== THIS IS THE CALL THAT FAILS*/
           currentSrc = e->source;
           currentTgt = e->target;
           currentWgt = e->weight;

        }

        /*as we have read over the next symbol in the loop, reset the position to read*/
        *currentPosition = *currentPosition - 1;
        sym = GetNextSymbol(sourceString,currentPosition);

        if(sym == rightBrace){

           sym = GetNextSymbol(sourceString, currentPosition);

           if(sym == eot){

              return correctMatrix;
           }
           else{
              return errorMatrix;
           }
        }
        else{
           return errorMatrix;
        }
     }
     else{
        return errorMatrix;
     }
  }
  else{
     return errorMatrix;
  }
 }
 else{
    return errorMatrix;
 } 
```

}

这里是 GetNextSymbol（扫描仪，将符号传递给解析器）：

```
/**
* DOCUMENTATION
* ============================
* This is the main scanning function
* which is used by the parser to recognize
* terminal symbols and valid literals.
*
* RETURNS: the enum code for the recognized symbol.
* or an error code, when invalid symbol encountered.
*/

int GetNextSymbol(char* sourceString, int* currentPosition){

   int symbolCode;
   int loopCounter = 0;
   char* currentIdentifier = (char*)malloc(10);
   char* currentNumber = (char*)malloc(10);
   int identifierPosition = 0;
   int numberPos = 0;
   int numericVal = 0;
   char currentChar;

   currentChar = getNextChar(sourceString, currentPosition);

    /*skip all blanks, empty chars,
    linefeeds, carriage returns*/
   while(currentChar == ' '
         || currentChar == 11
         || currentChar == 10
         || currentChar == 13
         || currentChar == '\t')
   {
      currentChar = getNextChar(sourceString, currentPosition);
   }

   /*=====================================*/
   /*Section 1: scan for terminal symbols */
   /*====================================*/

   if(currentChar == '['){
      symbolCode = leftBrace;
   }
   else if(currentChar == ']'){
      symbolCode = rightBrace;
   }

   /*=====================================*/
   /*Section 2: scan for valid literals  */
   /*====================================*/

   else if(isdigit(currentChar)){

      /*here we calculate the numeric value of a number expression*/
      /*when calculated, we assign the numeric value to the symCode variable*/
      /*this works out because the values for a real symbol are always negative*/
      symbolCode = digit;
      while(isdigit(currentChar)){

         currentNumber[numberPos] = currentChar;
         currentChar = getNextChar(sourceString, currentPosition);
         loopCounter++;
         numberPos++;
      }

      currentNumber[numberPos] = '\0';
      numericVal = atoi(currentNumber);
      symbolCode = numericVal;

      /*when identifier or braces follow number without space: reset currentPos*/
      /*to the position of the previous char*/
      if(isalpha(currentChar)){
         *currentPosition = *currentPosition - loopCounter;
      }
      else if(currentChar == ']'){
         *currentPosition = *currentPosition - loopCounter;
      }
      else if(currentChar == '['){
         *currentPosition = *currentPosition - loopCounter;
      }

   }
   else if(isalpha(currentChar)){

      while(isalpha(currentChar)){

         currentIdentifier[identifierPosition] = currentChar;
         currentChar = getNextChar(sourceString, currentPosition);
         loopCounter++;
         identifierPosition++;
      }

      /*check wether we have found a valid identifying label*/
      /*and deallocate the reserved mem space*/
      currentIdentifier[identifierPosition] = '\0';
      symbolCode = recognizeIdentifier(currentIdentifier);

      /*when number or braces follow identifier without space: reset currentPos*/
      /*to the position of the previous char*/
      if(isdigit(currentChar)){
         *currentPosition = *currentPosition - 1;
      }
      else if(currentChar == ']'){
         *currentPosition = *currentPosition - 1;
      }
      else if(currentChar == '['){
         *currentPosition = *currentPosition - 1;
      }

   }
   else if(currentChar=='\0'){

      symbolCode = eot;
   }
   /*neither terminal symbol nor end of text found on current position --> illegal symbol*/
   else{
      symbolCode = error;
   }

   free(currentIdentifier);
   free(currentNumber);
   return symbolCode;

} 
```

现在是“边缘”识别程序中的致命呼叫。首先，结构的标头

```
#ifndef GML_EDGE_STRUCT_H_INCLUDED
#define GML_EDGE_STRUCT_H_INCLUDED

typedef struct EdgeStruct* EdgeObj;

typedef struct EdgeStruct {

   int source;
   int target;
   int weight;

} EdgeStruct;

typedef EdgeObj EdgeDescription;

EdgeDescription createNewEdge(int src, int tgt, int wgt);
void destroyEdge(EdgeObj);

#endif // GML_EDGE_STRUCT_H_INCLUDED 
```

实施

```
#include "GML_EDGE_STRUCT.h"
#include <stdio.h>
#include <stdlib.h>
EdgeDescription createNewEdge(int source, int target, int weight){

   EdgeDescription e;
   int bytesRequested = sizeof(EdgeStruct);

   e = malloc(bytesRequested);
   e->source = source;
   e->target = target;
   e->weight = weight;
   return e;
} 
```

我知道，这几乎是代码；）只是为了表明，所有可以释放的东西，我都释放了。

在过去的两天里，我在谷歌上搜索了我的问题，当然也在这里堆栈溢出，并且有数百个网站、帖子等关于 malloc 返回 null 的问题。他们都说基本相同：没有足够的内存（也就是说，我们称之为不太可能），或者碎片堆，所以没有足够大小的内存块可用。

但是：我要求的只是 12 个（字面意思是：十二个）字节来存储三个 int 属性。这似乎太多了。

我是否超出了一些我不知道的内部限制？

帮助将不胜感激。

提前感谢罗兰

编辑 2012-11-24：

谢谢你的回答。但。这个问题必须具有更基本的性质。

因为：当我测试我的程序的其他部分（文件 I/O）等时，它们远没有解析器复杂，并且只从 main() 深入调用一次，我也不能 malloc。我读的文件大约有 140 个字节。即使我测试与所有其他部分隔离的 I/O 部分，即使我将它们外包到不同的项目中，我也没有从系统中获得内存。绝不。我已经重新启动计算机，一切。绝对地。不。改变。

有任何想法吗？与此同时，我在这个项目上投入了太多时间，其中大部分时间都在跟踪那些该死的内存错误...... :-(((

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-02T22:04:00.057

如果您怀疑您的应用程序使用了太多内存或将所有可用内存碎片化，那么您可以在运行时检查应用程序的内存使用情况。如果它吃掉所有系统内存，那么 malloc 会因此返回 NULL。

如果上述情况不是您的情况，那么我会检查您的应用程序是否存在堆损坏。通常，当您覆盖堆结构时，会发生非常糟糕的事情。在调试模式下，编译器为堆损坏检测添加了一些额外的检查和红色区域。在发布模式下，破坏堆结构通常会导致访问冲突。我可以想象，在极少数情况下，堆结构可能会损坏，并且损坏可以解释为空间不足，因此 malloc 返回 NULL。

我会采用一种或另一种方式使用内存调试器。Valgrind 救了我很多次，但在你的环境中可能不可用。stackoverflow 上有很多关于内存调试器的主题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:31:57.530

我不能说太多，只是一个观察。在`GetNextSymbol()`中，我看不到读取的位数没有限制，因此存在缓冲区溢出的可能性。读取标识符也是如此。

中的另一个`Graph()`，失败的`Edge(sourceString, currentPosition)`调用在一个while循环中，结果永远不会被释放，AFAICS。

# opengl - 在 OpenGL 中渲染 B 样条曲线

> ID：13435375
> 
> 赞同：2
> 
> 时间：2012-11-17T22:23:57.300
> 
> 标签：opengl, 3d, rendering, curves, bspline

我一直在研究一个 OpenGL 项目，该项目本质上是绘制 b 样条曲线的练习。我的程序没有返回错误，但曲线不会显示。

给定一个名为“coords”的长度为 13 的控制点数组（控制点本身都在屏幕上可见），这是我的代码：

```
glBegin(GL_LINE_STRIP);

float x=0;
float y=0;
float z=0;
for (double u = 3; u <= 14; u+=0.1){

    for (int i = 1; i <=13; i++){
        x += NofU(u,i)*coords[i].x;
        y += NofU(u,i)*coords[i].y;
        z += NofU(u,i)*coords[i].z;
    }//for

}//for

glVertex3f(x, y, z);

glEnd(); 
```

其中“NofU”代表混合函数：

```
double NofU(double u, int i){

if (u < i)
    return 0;
else if (u < i+1)
    return (1/6)*pow(u,3);
else if (u < i+2)
    return (1/6)*((-3)*pow(u,3)+3*pow(u,2)+3*u+1);
else if (u < i+3)
    return (1/6)*(3*pow(u,3)-6*pow(u,2)+4);
else if (u < i+4)
    return (1/6)*pow((1-u),3);
else
    return 0;

}//NofU 
```

当我尝试打印语句时，我会得到非常大或非常小的坐标值，或者只是 0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T01:02:40.987

呃，glBegin/End 块内只有一个 glVertex3f 调用。所以你试图画一条只有一个点的线带，这实际上是做不到的。（不确定 OpenGL 是否真的会为此报告错误。）

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T22:28:11.747

我还要检查你的 B 样条计算函数。我的参考资料（Advanced Animation and Rendering Techniques, Watt & Watt）有**两个**u 值。有大写的全局 U，范围从 0 .. n - 2。这对应于您的小写 u。但是对于基函数（小写），u 必须在 0 .. 1 范围内。在您的代码中，这将是 fmod(u, 1)。我认为如果你在所有 NoFu 返回语句中使用它，你会得到更好的答案。

# ios - 在静态 UIPickerView 中拦截触摸

> ID：13435377
> 
> 赞同：0
> 
> 时间：2012-11-17T22:24:05.407
> 
> 标签：ios, uipickerview, uitapgesturerecognizer

我有 5 个组件 UIPickerView 需要禁用正常的用户交互（即：没有旋转/单击来旋转它们）。但是，我需要检测它们内部的触摸并根据按下的组件做出反应。

我尝试了 UIGestureRecognizer 和 UITapGestureRecognizer 并将 cancelsTouchesInView 设置为 YES：它会启动并阻止单击，但不会阻止拖动。我尝试了 didSelectRow:inComponent 但它仅在选择器旋转时才会启动，这是我不想要的行为。如上所述，卷轴绝不能在用户交互上旋转。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T20:59:33.233

通过将 UIGestureRecognizer 添加到背景图像（启用用户交互）并查看点击的位置以确定点击是否在 UIPickerView 组件的区域内来解决此问题。

# c - 结构成员访问的性能

> ID：13435379
> 
> 赞同：-1
> 
> 时间：2012-11-17T22:24:15.833
> 
> 标签：c, performance, optimization, struct

我有一个高性能的关键代码部分，需要访问结构的多个字段。将结构本身分配给变量是否更快，或者使用指针来获取结构的成员，例如

```
struct A* = A_arr + n;
int a = A->t - A->s; 
```

对比

```
struct A = A_arr[n];
int a = A.t - A.s; 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T22:26:50.773

理想情况下，您应该自己测量以找出答案。从理论上讲，一个好的编译器将为两者创建相同的程序集。

第二个版本更自然，因此更具可读性，所以我更喜欢它，直到它被测量并发现它不是最优的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T22:25:59.993

他们很可能是一样的。如果编译器生成的代码在一个版本中表现得非常慢，那么它就是一个糟糕的编译器。

# c# - 事件期间 DataContext 间歇性地为空

> ID：13435381
> 
> 赞同：3
> 
> 时间：2012-11-17T22:24:34.600
> 
> 标签：c#, wpf, mvvm

我遇到了从我的视图模型引发的问题事件，有时在服务视图中将数据上下文显示为空。我开始认为这是弱绑定模式问题，并且我没有使用它或者我误解了它（一般来说是设计模式的新手，几个月前开始 WPF）。

相关 MainWindow.xaml

```
<Grid Tree:TreeView.ItemSelected="DisplayRequested"
      Tree:TreeView.PoolCategoriesChanged="PoolContentChanged">
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="200"/>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition />
    </Grid.ColumnDefinitions>
    <GridSplitter Grid.Column="0" VerticalAlignment="Stretch"/>
    <GridSplitter Grid.Column="1" VerticalAlignment="Stretch"
                  Background="Gray" ShowsPreview="True" Width="5"
                  HorizontalAlignment="Center"/>
    <GridSplitter Grid.Column="2" VerticalAlignment="Stretch"/>
    <Tree:TreeView Name="poolTree" Grid.Column="0" Focusable="True" />
    <ScrollViewer Grid.Column="2" VerticalScrollBarVisibility="Auto">
        <Details:DetailsView Name="detailsDisplay" Focusable="True"/>
    </ScrollViewer>
</Grid> 
```

后面的相关代码

```
public partial class MainWindow
{
    public MainWindow()
    {
        InitializeComponent();
    }

    private void OnDataContextChanged(object sender, DependencyPropertyChangedEventArgs e)
    {
        var vm = (CLUViewModel)e.NewValue;
        if (vm == null) return;
        vm.OwnerCleanupStarted += OnOwnerCleanupStarting;
        vm.OwnerCleanupEnded += OnOwnerCleanupEnding;
    }

    #region Event Handlers
    private void OnOwnerCleanupEnding(object sender, EventArgs e)
    {
        ViewServices.CloseProgressDialog();
    }

    private void OnOwnerCleanupStarting(object sender, EventArgs e)
    {
        var vm = DataContext as CLUViewModel;
        if (vm == null) return;
        var progressDialogViewModel = vm.ProgressDialogVM;
        ViewServices.ShowProgressDialog(GetWindow(this), progressDialogViewModel);
    }
    #endregion
} 
```

我有几个`RoutedEvents`似乎没有问题的功能。不过，该`OnOwnerCleanupStarting`事件似乎在 var 上返回了很多 null `vm = DataContext as CLUViewModel;`。这是因为它绑定得太强并且没有使用WPF框架吗？

如果我把它放在调试和跟踪中，它总是可以工作的，并且在正常使用过程中很多时候都可以正常工作。这是一种竞争条件，我在视图中使用内存中的侦听器，当焦点到子组件时，该视图未初始化？

来自VM的调用逻辑：

```
public class CLUViewModel : ViewModelBase
{
    #region Properties
    private RelayCommand _manageOwnersDialogCommand;

    public ProgressDialogViewModel ProgressDialogVM;
    #endregion

    public CLUViewModel()
    {
        ProgressDialogVM = new ProgressDialogViewModel(string.Empty);
    }

    #region ManageOwnersDialogCommand
    public ICommand ManageOwnersDialogCommand
    {
        get
        {
            return _manageOwnersDialogCommand ??
                   (_manageOwnersDialogCommand = new RelayCommand(param => OnManageOwnersDialogShow()));
        }
    }

    private void OnManageOwnersDialogShow()
    {
        var dialog = new ManageOwnersDialog();
        var vm = new ManageOwnersViewModel();
        dialog.DataContext = vm;

        if (!dialog.ShowDialog().Value) return;

        var ownersRequiringCleanup = GetOwnersRequiringCleanup(vm);

        if(ownersRequiringCleanup.Count < 1) return;

        ProgressDialogVM.ClearViewModel();
        ProgressDialogVM.TokenSource = new CancellationTokenSource();
        ProgressDialogVM.ProgressMax = ownersRequiringCleanup.Count*2;

        RaiseOwnerCleanupStartedEvent();

        var taskOne = Task.Factory.StartNew(() => OwnerCleanupService.DoOwnerCleanup(ownersRequiringCleanup, ProgressDialogVM));

        taskOne.ContinueWith(t => RaiseOwnerCleanupEndedEvent(), TaskScheduler.FromCurrentSynchronizationContext());
    }

    private List<Owner> GetOwnersRequiringCleanup(ManageOwnersViewModel vm)
    {
        var ownersRequiringCleanup = new List<Owner>();

        // using DB to determine cleanup
        // Proprietary code removed for this discussion

        return ownersRequiringCleanup;
    }
    #endregion

    #region Events
    public event EventHandler OwnerCleanupStarted;
    public event EventHandler OwnerCleanupEnded;

    public void RaiseOwnerCleanupStartedEvent()
    {
        if (OwnerCleanupStarted == null) return;            
        OwnerCleanupStarted(this, new EventArgs());
    }

    public void RaiseOwnerCleanupEndedEvent()
    {
        if (OwnerCleanupEnded == null) return;
        OwnerCleanupEnded(this, new EventArgs());
    }
    #endregion
} 
```

我对其他几个控件也有同样的问题，它们的各种 VM 调用父级（在树视图中）并且父级引发事件。

我一直在学习这一点，我在 VM 端使用的一些事件是我早期对事物如何工作的理解。这是我应该在哪里调用一个引发到我的视图的事件，然后`RountedEvent`将气泡启动到适当的级别？我是否陷入了强绑定与弱绑定的陷阱？

编辑：解决了正在看到的父/子 TreeView 问题。Master-Detail 模式意味着我一直在访问不可见或从未加载的详细视图。现在最初的问题仍然是出现空值。对于 View DataContext 不会遇到困难的 UI 相关问题，是否有更好的方法从 VM 回调到 View？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T04:29:07.543

我建议不要在 WPF 中使用基于事件的编程模型。因为进入这样的事情太容易了。基于事件的编程强制紧密耦合。所以这是一个双重禁忌

不是在 View 中抛出事件，而是使用[DelegateCommand](http://wpftutorial.net/DelegateCommand.html)来执行在 ViewModel 级别中定义的动作，而不是在 ViewModel 中抛出事件，只需使用常规属性和[INotifyPropertyChanged](http://wpftutorial.net/INotifyPropertyChanged.html)来表示事物的状态。

这当然需要从 winforms 或其他任何非 wpf 思维方式进行重大转变，但是当您意识到这一点时，您会产生更少和更清晰的代码。

# php - 如何在不使用 Google Translator's Kit 的情况下翻译多个 HTML 文件

> ID：13435389
> 
> 赞同：1
> 
> 时间：2012-11-17T22:25:20.590
> 
> 标签：php, localization, internationalization, translation

我需要将几个 PHP 文件（HTML 代码 + PHP 标签）翻译成另一种语言。Google Translator's Kit 允许这样做，但会清除 PHP 标签，删除 class="" 属性（？！）并添加 html、head 标签等等。完全没用。

我如何（最好是批量）使用任何类型的自动翻译服务翻译这些文件？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:34:46.823

您需要国际化代码。您需要将所有可翻译的字符串移出到一个单独的文件中，以便您可以通过 Google 将其推送，然后轻松放入结果中。

研究 PHP I18N 的主题将证明是有益的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:44:58.233

bmargulies 是最明确的方法。然而，这需要时间。

如果您处于紧要关头，或者想偷工减料，一个相对简单的方法是使用正则表达式自己过滤掉您的*代码*。匹配多行（preg 中的 /s 标志），存储匹配，并用哈希替换。任何哈希。只要确保它不映射到任何语言的任何内容。如果 HTML 标记被证明对 Google 来说很烦人，请对它们执行相同的操作。

用谷歌翻译。

替换回哈希值。瞧！任务完成！如果您感觉更大胆，与其将哈希替换回去，不如用适合 l18n 的结构替换它们可能会更值得。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T17:34:48.183

谷歌翻译工具包是用于文档的 - 而不是源代码。您可以将程序的字符串组织为文档并在 Google 翻译工具包中进行翻译，事实上，有软件项目可以做到这一点，但这是人为的。正如这里的其他人所说，使用不同的方法会更好。

将可翻译的字符串放在单独的文件中 - 例如，您可以使用 YAML 或 JSON 之类的东西，或者将字符串组织为 PHP 数组（例如，在 MediaWiki 中就是这样做的）。每条消息都应该有一个密钥。对每种语言使用一个文件，或者使用一个包含所有语言的文件，以及按语言分组的字符串。（顺便说一句，使用 ISO 639-3 语言代码 - 不要自己编造。然后您将能够在 HTML 语言属性中重用它们。）

像这样组织字符串之后，编写函数，通过消息键和语言代码从这些文件中加载字符串，并使用这些函数来显示消息 - 永远不要使用硬编码的字符串。

最后，使用 Pootle、Transifex、Zanata 或 MediaWiki Translate 扩展等软件将您的文件进行翻译。

（免责声明：我是 MediaWiki 翻译扩展的开发人员。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T14:54:14.750

使用[Gettext](https://en.wikipedia.org/wiki/Gettext)（即[php-gettext](https://launchpad.net/php-gettext/)）之类的东西是恕我直言的最佳方法。另一个广泛使用的选项是简单地将字符串提取到单独的文件（无论是 PHP 还是 JSON）并翻译这些文件。但是，我建议您使用 Gettext，因为您将使用标准格式和各种可用工具。

# css - 如何在 CSS Button 中将背景图像显示为悬停效果？

> ID：13435391
> 
> 赞同：0
> 
> 时间：2012-11-17T22:25:55.343
> 
> 标签：css, button, background, hover, gradient

我有一个 CSS3 Gradient 按钮，我试图在我的按钮内显示一个背景图像（确切地说是小径向发光）作为悬停状态。由于我的按钮正常状态已经占用了“背景”标签，所以当我在悬停中链接背景图像时，当我悬停在它上面时 CSS3 渐变效果消失了。我尝试使用 background-image 标签进行悬停，但它不起作用。

有没有一种方法可以在悬停时在正常状态之上显示悬停背景图像？

CSS：

```
 .submit {
    background: rgb(254,219,130); /* Old browsers */
    background: -moz-linear-gradient(top,  rgba(254,219,130,1) 0%, rgba(255,183,50,1) 24%, rgba(255,164,10,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(254,219,130,1)), color-stop(24%,rgba(255,183,50,1)), color-stop(100%,rgba(255,164,10,1))); /* Chrome,Safari4+ */
    background: -webkit-linear-gradient(top,  rgba(254,219,130,1) 0%,rgba(255,183,50,1) 24%,rgba(255,164,10,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-linear-gradient(top,  rgba(254,219,130,1) 0%,rgba(255,183,50,1) 24%,rgba(255,164,10,1) 100%); /* Opera 11.10+ */
    background: -ms-linear-gradient(top,  rgba(254,219,130,1) 0%,rgba(255,183,50,1) 24%,rgba(255,164,10,1) 100%); /* IE10+ */
    background: linear-gradient(to bottom,  rgba(254,219,130,1) 0%,rgba(255,183,50,1) 24%,rgba(255,164,10,1) 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#fedb82', endColorstr='#ffa40a',GradientType=0 ); /* IE6-9 */
}

.submit:hover {
    background-image: url(images/glow.png) center no-repeat;
} 
```

HTML：

```
<button class="submit">Button</button> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:45:02.270

与`input`元素不同，该`button`元素可以包含其他元素，因此最简单的方法是简单地将 a 嵌套`span`在`button`该元素中并将“发光”应用于该元素：

```
<button class="submit"><span>Button</span></button>​

.submit:hover span {
    background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPHJhZGlhbEdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY3g9IjUwJSIgY3k9IjUwJSIgcj0iNzUlIj4KICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmZmZmZmYiIHN0b3Atb3BhY2l0eT0iMSIvPgogICAgPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjZmZmZmZmIiBzdG9wLW9wYWNpdHk9IjAiLz4KICA8L3JhZGlhbEdyYWRpZW50PgogIDxyZWN0IHg9Ii01MCIgeT0iLTUwIiB3aWR0aD0iMTAxIiBoZWlnaHQ9IjEwMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
    background: -moz-radial-gradient(center, ellipse cover, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 100%);
    background: -webkit-gradient(radial, center center, 0px, center center, 100%, color-stop(0%,rgba(255,255,255,1)), color-stop(100%,rgba(255,255,255,0)));
    background: -webkit-radial-gradient(center, ellipse cover, rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%);
    background: -o-radial-gradient(center, ellipse cover, rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%);
    background: -ms-radial-gradient(center, ellipse cover, rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%);
    background: radial-gradient(ellipse at center, rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%);
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#00ffffff',GradientType=1 );
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/xJ8Bu/)。

我无法访问您自己的图像，因此我使用[了 CSS 渐变图像生成器](http://www.colorzilla.com/gradient-editor/)作为替代。显然，将您自己的相关图像替换回去。

* * *

使用第二个`background-image`：

随着 CSS3 的引入，一个元素可以使用逗号分隔的列表（例如，`font-face`声明）有多个背景，这允许以下操作：

```
.submit:hover {
    /* IE9 SVG, needs conditional override of 'filter' to 'none' */
    background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgdmlld0JveD0iMCAwIDEgMSIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSI+CiAgPHJhZGlhbEdyYWRpZW50IGlkPSJncmFkLXVjZ2ctZ2VuZXJhdGVkIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgY3g9IjUwJSIgY3k9IjUwJSIgcj0iNzUlIj4KICAgIDxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiNmZmZmZmYiIHN0b3Atb3BhY2l0eT0iMSIvPgogICAgPHN0b3Agb2Zmc2V0PSIxMDAlIiBzdG9wLWNvbG9yPSIjZmZmZmZmIiBzdG9wLW9wYWNpdHk9IjAiLz4KICA8L3JhZGlhbEdyYWRpZW50PgogIDxyZWN0IHg9Ii01MCIgeT0iLTUwIiB3aWR0aD0iMTAxIiBoZWlnaHQ9IjEwMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
background: -moz-radial-gradient(center, ellipse cover, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 100%), -moz-linear-gradient(top,  rgba(254,219,130,1) 0%, rgba(255,183,50,1) 24%, rgba(255,164,10,1) 100%); /* FF3.6+ */
    background: -webkit-gradient(radial, center center, 0px, center center, 100%, color-stop(0%,rgba(255,255,255,1)), color-stop(100%,rgba(255,255,255,0))), -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(254,219,130,1)), color-stop(24%,rgba(255,183,50,1)), color-stop(100%,rgba(255,164,10,1))); /* Chrome,Safari4+ */
    background: -webkit-radial-gradient(center, ellipse cover, rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%), -webkit-linear-gradient(top,  rgba(254,219,130,1) 0%,rgba(255,183,50,1) 24%,rgba(255,164,10,1) 100%); /* Chrome10+,Safari5.1+ */
    background: -o-radial-gradient(center, ellipse cover, rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%), -o-linear-gradient(top,  rgba(254,219,130,1) 0%,rgba(255,183,50,1) 24%,rgba(255,164,10,1) 100%); /* Opera 12+ */
    background: -ms-radial-gradient(center, ellipse cover, rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%), -ms-linear-gradient(top,  rgba(254,219,130,1) 0%,rgba(255,183,50,1) 24%,rgba(255,164,10,1) 100%); /* IE10+ */
    background: radial-gradient(ellipse at center, rgba(255,255,255,1) 0%,rgba(255,255,255,0) 100%), linear-gradient(to bottom,  rgba(254,219,130,1) 0%,rgba(255,183,50,1) 24%,rgba(255,164,10,1) 100%); /* W3C */
    filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#ffffff', endColorstr='#00ffffff',GradientType=1 ); /* IE6-8 fallback on horizontal gradient */
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/xJ8Bu/1/)。

我没有在`filter`属性下定义第二个背景，因为老实说我不知道​​微软的旧浏览器是否会理解第二个值，或者干脆放弃整个规则。

# java - 爪哇。我怎样才能提高性能？

> ID：13435392
> 
> 赞同：1
> 
> 时间：2012-11-17T22:25:55.920
> 
> 标签：java, performance, if-statement

我有以下锻炼：

> 开发回合制策略 Losers-V 的 Lavin Interactive Company 通过将游戏本地化为尽可能多的语言，不断扩展其目标市场。特别是，他们有兴趣在 Anindilyakwa 中创建游戏版本，这是澳大利亚土著人使用的语言之一。然而，由于 Anindilyakwa 没有数字，本地化变得复杂。“你有七条黑龙，你的敌人有四十条黑龙”这样的短语如何翻译成这种语言？本地化人员决定将其翻译如下：“你的黑龙很少，你的敌人有很多黑龙。” 他们编制了一张表格，显示了用 Anindilyakwa 单词替换怪物数量的规则。

我的实现如下：

```
import java.util.Scanner;

public class Localization {

    public static void main(String[] args) {

        Scanner s = new Scanner(System.in);
        int number;
        String designation;

        number = s.nextInt();

        if (number >= 1 && number <= 4) {
        designation = "few";
        }else if(number >= 5 && number <= 9){
            designation = "several";
        }else if(number >= 10 && number <= 19){
            designation = "pack";
        }else if(number >= 20 && number <= 49) {
            designation = "lots";
        }else if(number >= 50 && number <= 99){
            designation = "horde";
        }else if(number >= 100 && number <= 249){
            designation = "throng";
        }else if(number >= 250 && number <= 499){
            designation = "swarm";
        }else if(number >= 500 && number <= 999){
            designation = "zounds";
        }else{
            designation = "legion";
        }
        System.out.println(designation);

    }
} 
```

我在比赛服务器上加载了我的代码。我看到了下一个统计数据：

执行时间：**0.109**

使用的内存：**1 434 KB**

在此之后，我检查了顶级结果和我所看到的：

排名 1：

执行时间：**0.062**

使用的内存：**78 KB**

结论：

*我的代码慢了两倍；我的代码使用了 20 倍的内存。*

我的问题：如何？如何？这怎么可能？为什么我的代码如此愚蠢？我需要更改什么来改进我的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:30:50.047

您可以像这样在**if-else**语句中取消检查。代替：

```
if (number >= 1 && number <= 4) {
    designation = "few";
}else if(number >= 5 && number <= 9){
    // .... 
```

您只能检查上限：

```
if (number >= 1 && number < 5) {
    designation = "few";
}else if(number < 10){
    // ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:46:19.087

不确定内存问题。时间和内存可能由库代码（println、scanner）支配。例如，我认为 println 会刷新流，这很昂贵。

为了减少比较的平均和最大数量，您可以尝试利用数字的分布方式。在不知道这一点的情况下，您可以使用二进制搜索（这里在桶上完成，您也可以在会产生不同树的数字空间上完成）：

```
if (number < 50) {
  if (number < 10) {
    if (number < 5) {
      designation = "few";
    } else {
      designation = "several";
    }
  } else {
    if(number < 20) {
      designation = "pack";
    } else {
      designation = "lots";
  }
} else {
  if (number < 250) {
    if (number < 100) {
      designation = "horde";
    } else {
      designation = "throng";
    }
  } else {
    if (number number < 500) {
      designation = "swarm";
    } else if (number number < 1000) {
      designation = "zounds";
    } else{
      designation = "legion";
    }
  }
} 
```

此代码需要 4 次比较才能达到 1000 而不是 8。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T22:32:05.707

您可以通过避免使用扫描仪来减少内存。只需通过 InputStreamReader 读取一行并使用 Integer 类对其进行解析。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T22:41:24.087

如果您想提高执行时间，您应该在条件内执行 System.out.println，然后返回。此外，您不需要创建名称 var。

```
}else if(number >= 5 && number <= 9){
        System.out.println("several");
        return; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-17T22:33:33.717

假设您正在使用另一个答案中的 BufferedStream 输入思想，而不是使用 try-catch 块将输入安全地转换为整数，您可以从 main 方法抛出异常。这可以防止您加载任何专门的异常。

我想出了 0.078 秒和 366 kb 的内存。我看到的最好的是 0.062，内存为 18kb。那简直是疯了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-17T23:36:39.597

我用这段代码把它缩小到 370 KB，0.78 秒。有点无聊，想更进一步……

```
import java.io.IOException;

public class Localization {
    public static void main (String[] args) {
        short s = 0;
        while (true) {
            int next = 0;
            try {
                next = System.in.read();
            } catch (IOException e) {

            }
            if (next < '0' || next > '9') break;

            s = (short) (s * 10);
            s = (short) (s + ((short) (next - '0')));
        }

        if (s >= 100) {
            if (s >= 500) {
                if (s >= 1000) {
                    System.out.print('l');
                    System.out.print('e');
                    System.out.print('g');
                    System.out.print('i');
                    System.out.print('o');
                    System.out.print('n');
                } else {
                    System.out.print('z');
                    System.out.print('o');
                    System.out.print('u');
                    System.out.print('n');
                    System.out.print('d');
                    System.out.print('s');
                }
            } else {
                if (s >= 250) {
                    System.out.print('s');
                    System.out.print('w');
                    System.out.print('a');
                    System.out.print('r');
                    System.out.print('m');
                } else {
                    System.out.print('t');
                    System.out.print('h');
                    System.out.print('r');
                    System.out.print('o');
                    System.out.print('n');
                    System.out.print('g');
                }
            }
        } else {
            if (s >= 10) {
                if (s >= 50) {
                    System.out.print('h');
                    System.out.print('o');
                    System.out.print('r');
                    System.out.print('d');
                    System.out.print('e');
                } else if (s >= 20) {
                    System.out.print('l');
                    System.out.print('o');
                    System.out.print('t');
                    System.out.print('s');
                } else {
                    System.out.print('p');
                    System.out.print('a');
                    System.out.print('c');
                    System.out.print('k');
                }
            } else {
                if (s >= 5) {
                    System.out.print('s');
                    System.out.print('e');
                    System.out.print('v');
                    System.out.print('e');
                    System.out.print('r');
                    System.out.print('a');
                    System.out.print('l');
                } else {
                    System.out.print('f');
                    System.out.print('e');
                    System.out.print('w');
                }
            }
        }

        System.out.println();
        System.out.flush();
    }
} 
```

# django - 通过精确的 M2M 值获取实例

> ID：13435394
> 
> 赞同：0
> 
> 时间：2012-11-17T22:26:01.723
> 
> 标签：django, django-models

我有一个带有`members`M2M 字段的对话线程模型给用户。

我需要做的是获取只有特定成员相关的 Thread 实例，不多也不少。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:38:47.963

我认为你正在尝试做这样的事情：

```
class Thread(models.Model):
    members = models.ManyToManyField(User, related_name='threads')

>> user_threads = user.threads.filter(any_condition) 
```

编辑：

你需要的看起来像这样：

```
>> exact_users = [user1, user2, ...]
>> ts = Thread.objects.filter(members__in = exact_users) 
```

# c++ - 多项式运算符重载

> ID：13435395
> 
> 赞同：-4
> 
> 时间：2012-11-17T22:26:02.083
> 
> 标签：c++, operator-overloading

我的代码有问题。

我需要使用 输入多项式作为系数-指数对的列表`operator>>`，然后我需要按以下方式打印它：

```
coefficient*x**exponent+coefficient*x**exponent... 
```

我认为我的代码是正确的，但没有打印任何内容。

## 标题

```
#ifndef POLYNOMIAL_H
#define POLYNOMIAL_H

#include <cctype>
#include <iomanip>
#include "Element.h"

class Polynomial
{
    public:
        Polynomial ( int size = 0) // initializes size of the polynomial
        {
            this->size = size;
            ptr_array = new Element[size] ;
        }

        static void InitializePolynomial ( Polynomial * );
        friend istream &operator>>( istream &, Polynomial & );
        friend ostream &operator<<( ostream &, const Polynomial & );

        int Getsize ( );
        Element GetElement (int);

    private:
        int size; // numbers of the terms in a polynomial
        Element *ptr_array; // A pointer array that stores pointers to the objects of Element
};

#endif 

#ifndef ELEMENT_H
#define ELEMENT_H

#include <iostream>
#include <sstream>
using namespace std;

class Element
{
    public:
        Element( int exponent = 0, double coefficient = 0 )
        {
            this->exponent = exponent;
            this->coefficient = coefficient;
        }

    void SetCoefficient ( double );
    void SetExponent ( int );
    double GetCoefficient ( );
    int GetExponent ( );

    private:
        int exponent;
        double coefficient;
};

#endif 
```

## CPP

```
#include "Polynomial.h"

void Polynomial :: InitializePolynomial ( Polynomial * Poly )
{
    int size;
    cout << "Initialisation of the polynomial" << endl;
    cout << "What is the size of your polynomial ? ";
    cin >> size;
    Poly = new Polynomial (size);
}

Element Polynomial :: GetElement(int i)
{
    return ptr_array[i];
}

istream &operator>>( istream &input, Polynomial &Poly )
{
    int i;

    for (i=0; i<12; i++)
    {
        double tempcoef;
        int tempexp;

        input>>tempcoef; 
        Poly.ptr_array[i].SetCoefficient(tempcoef);
        input.ignore(1,',');

        input>>tempexp; 
        Poly.ptr_array[i].SetExponent(tempexp);
        input.ignore(1,',');
    }

    return input;
}

/*
ostream &operator<<( ostream &output , Polynomial const &Poly )
{
    int i;
    for (i=0; i<12;i++)
    {
        if (i != 0) output<<setfill('+')<<setw(1);
        output<<Poly.ptr_array[i].GetCoefficient();
        output<<setfill('*')<<setw(1);
        output<<Poly.ptr_array[i].GetExponent();
        output<<setfill('*')<<setw(2);
    }

    return output;
}*/

ostream &operator<<(ostream &output, const Polynomial &polynom)
{

    for(int i=0; i< polynom.size ; i++)
    {
        if(pow(polynom.ptr_array[i].GetCoefficient(), polynom.ptr_array[i].GetExponent()) != 0)
        {
            if(i > 0 && (polynom.ptr_array[i].GetCoefficient() >= 0))
            {
                output<<"+";
            }

            if(polynom.ptr_array[i].GetExponent() == 0)
            {
                output<<polynom.ptr_array[i].GetCoefficient();
            }

            else if(polynom.ptr_array[i].GetExponent() == 1)
            {
                output<<polynom.ptr_array[i].GetCoefficient()<<"x";
            }

            else
            {
                output<<polynom.ptr_array[i].GetCoefficient()<< "*x**" << polynom.ptr_array[i].GetExponent();
            }
        }
    }
    output << endl;
    return output;
}

#include "Element.h"

void Element :: SetCoefficient ( double Coeff )
{
    coefficient = Coeff;
}

void Element :: SetExponent ( int Expo )
{
    exponent = Expo;
}

double Element :: GetCoefficient ( )
{
    return coefficient;
}

int Element :: GetExponent ( )
{
    return exponent;
} 
```

## 主要的

```
#include "Element.h"
#include "Polynomial.h"

int main ( )
{
    Polynomial FirstPolynomial;

    Polynomial :: InitializePolynomial( &FirstPolynomial );

    cout << "You are creating your polynomial" << endl;
    cout << "Please enter the coefficient et exponent like that " << endl;
    cout << "(Coefficient, Exponent, Coefficient, Exponent ...)" << endl;
    cout << "--> ";

    cin >> FirstPolynomial;
    cout << FirstPolynomial;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:37:02.220

问题很可能出现在`InitializePolynomial`：您传递了一个指向该函数的指针，但在函数内部它仍然是一个局部变量，这意味着一旦函数返回，对变量所做的更改（如分配给该指针）将反映在参数上。您必须将参数作为*参考*传递：

```
static void InitializePolynomial ( Polynomial *& ); 
```

* * *

实际上，再次阅读您的代码，您遇到的问题比函数中的问题要大得多：您尝试为*已经分配的对象分配内存！*

当您`FirstPolynomial`在`main`函数中声明变量时，编译器将为您分配该对象。您应该`main`改为正确初始化它：

```
int main()
{
    int size;
    cout << "Initialisation of the polynomial" << endl;
    cout << "What is the size of your polynomial ? ";
    cin >> size;

    Polynomial FirstPolynomial(size);

    // ...
} 
```

不需要有单独的初始化函数。

# java - 用 64 位 Java 编写服务器会受到 JVM 堆大小/内存的阻碍吗？

> ID：13435397
> 
> 赞同：1
> 
> 时间：2012-11-17T22:26:04.373
> 
> 标签：java, memory-management, heap-memory

看起来 32 位 java 程序只能使用 1-2 gigs 的内存？

[http://publib.boulder.ibm.com/infocenter/javasdk/tools/index.jsp?topic=%2Fcom.ibm.java.doc.igaa%2F_1vg00014884d287-11c3fb28dae-7ff6_1001.html](http://publib.boulder.ibm.com/infocenter/javasdk/tools/index.jsp?topic=%2Fcom.ibm.java.doc.igaa%2F_1vg00014884d287-11c3fb28dae-7ff6_1001.html)

我可以期望在 64 位操作系统中运行的 java 程序没有这个限制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:28:10.800

> 我可以期望在 64 位操作系统中运行的 java 程序没有这个限制吗？

是的，应该没问题。但是，检查您实际要运行的系统是有意义的。没有什么比确定...

# python - 分配取自表达式的对象名称

> ID：13435401
> 
> 赞同：2
> 
> 时间：2012-11-17T22:26:32.237
> 
> 标签：python

我需要从外部源中提取数据。我建立了一个具有某种结构的基类。我需要具有 myBase 类类型的对象，但其名称会自动描述我对源进行迭代的次数。我构建了一个类来存储这个数字，并使用一个返回我需要的对象的调用方法。我找不到将字符串作为对象名称的方法，但每次构建新对象时都会自动不同。我简化了这个例子的代码：

```
class myBase:
    def __init__(self):
        iteratedValue = None

class myIterator:
    def __init__(self):
        self.k = 0
    def __call__(self, s):
        self.k += 1
        self.name = 'myData' + str(self.k)
        # create an object named myData1, myData2 ...
        self.name = myBase() 
        self.name.iteratedValue = s 
        print '%s name is %s for k = %i' % (self.name, self.name.iteratedValue, self.k)

        # return object named myData1 type of myBase
        return self.name

def DataExtraction():
    # function to extract data form external source
    data = myIterator()
    data('Alice') 
    data('Ben') 

DataExtraction() 
```

我的输出是：

```
<__main__.myBase instance at 0x7f261b6dc6c8> name is Alice for k = 1
<__main__.myBase instance at 0x7f261b6dc6c8> name is Ben for k = 2 
```

我需要返回一个具有特定名称的对象，并且我希望得到一个输出：

```
myData1 name is Alice for k = 1
myData2 name is Ben for k = 2 
```

原来的问题要复杂得多。我有外部数据，每次他们来时，我都想从这些数据中提取一些值。每次我这样做时，我都需要一个对象来处理它，但我需要这个具有不同名称的对象，因为最后我将它们存储在 dict 中以供其他方法使用。换句话说，我使用数据并将结果存储在对象中`myData1`，当原始数据发生更改时，我再次使用它并将结果存储在`myData2`等中。毕竟我需要所有`myData`对象并对它们进行统计以查看变化如何。我无法再访问原始数据。我需要自动命名约定，`myData`如果它会表达迭代器，最好。

我怎样才能用字符串代替`self.name`对象的名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T23:00:20.630

看起来你最好使用生成器。这是一些读取数据的示例代码（实际上它是硬编码的，就像在您的示例中一样），然后使用索引名称构造 Datum 对象。

```
class Datum(object):
    def __init__(self, index, value):
        self.name = 'myData%d' % (index + 1)
        self.value = value

def read_data():
    yield 'Alice'
    yield 'Ben'

def enumerate_data():
    for i, value in enumerate(read_data()):
        yield Datum(i, value)

for d in enumerate_data():
    print d.name, d.value 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T22:31:23.843

您已经在使用`self.name = 'myData' + str(self.k)`. 问题是你立即用`self.name = myBase()`. 我不确定您要对此做什么`myBase()`，但您可能想将其与名称分开。 `self.name`可以是字符串或`myBase`对象，但不能同时是两者。

也许你可以这样做：

```
 self.name = 'myData' + str(self.k)
    self.base= myBase() 
    self.base.iteratedValue = s 
    print '%s name is %s for k = %i' % (self.name, self.baseiteratedValue, self.k) 
```

这样，您可以同时拥有名称和“基础”，作为单独的属性`self.name`和`self.base`.

或者，您可以给`myBase`类一个`__str__`方法。这将影响您`print`在`myBase`对象上使用时显示的内容。但是，要做到这一点，您必须在实例化时传入所需的名称`myBase`，例如：

```
class myBase(object):
    def __init__(self, name, iteratedValue):
        self.name = name
        iteratedValue = iteratedValue
    def __str__(self):
        return self.name

class myIterator(object):
    def __init__(self):
        self.k = 0
    def __call__(self, s):
        self.k += 1
        name = 'myData' + str(self.k)
        self.name = myBase(name, s) 
        print '%s name is %s for k = %i' % (self.name, self.name.iteratedValue, self.k)

        # return object named myData1 type of myBase
        return self.name 
```

我不确定这些方式中的哪一种（或者可能是其他方式）是您正在寻找的。令人费解的是，您正在使对象的“名称”成为一个`myBase`实例。我不确定您希望对象的“名称”代表什么，但我通常不希望对象的名称是其他对象。

顺便说一句，看起来您使用的是 Python 2，在这种情况下，您应该使用`class someClass(object)`. 包括`object`使您的课程成为新型课程，这基本上是您一直想要的。

编辑：如果你想要做的实际上是创建一个`myData1`基于字符串调用的变量，那么你可以这样做`myData('Alice')`，然后以某种方式神奇地让变量`myData1`引用该对象，答案是“不要那样做”。如果您想创建一堆对象并通过数字或其他标签以结构化方式访问它们，请使用列表或字典。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T22:37:42.807

为什么要担心命名你的对象，为什么不把它们放在一个`dict`?

```
myObjects = {1:Alice(), 2:Bob()} 
```

# php - 在 PHP ( PDO ) 中访问私有变量

> ID：13435405
> 
> 赞同：-1
> 
> 时间：2012-11-17T22:26:53.143
> 
> 标签：php, mysql, string, pdo

我在 PHP 中使用 PDO ...我有以下问题。

以下代码不起作用。

```
class A {
 private $getUsersQuery = "SELECT * FROM users";      
 ...
 public function getUsers() {       
   $DBH = A::getDatabaseConnection();           
   try {
      $query = $DBH->prepare($this->getUsersQuery); 
      ...
   } catch(PDOException $e) {}
 }
} 
```

但是，如果我使用字符串，它就可以工作。

```
$DBH->prepare("SELECT * FROM users"); 
```

即使我在 prepare() 之外使用 echo 它也可以工作......

```
echo $this->getUsersQuery;   // Outputs the sql string. 
```

有人可以指出问题可能是什么。

更新 ：

错误 ：

SQLSTATE [42000]：语法错误或访问冲突：1065 查询为空

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T22:45:09.763

正如您在评论中提到的，您对非静态方法进行了静态调用。

`$this`在这样调用的方法中使用是没有意义的：

```
$results = A::getUsers(); 
```

实例化您的类，然后在类对象上调用该方法。

```
$a = new A();
$a->getUsers(); 
```

或者使您的方法和 SQL 查询静态化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:45:04.893

尝试

```
$a = new A();
$result = $a->getUsers(); 
```

当你调用 A::getUsers() 时，$getUsersQuery 的值可能没有被初始化。静态方法被称为喜欢。

# data-structures - 具有 N 个节点和深度 M 的树的数量

> ID：13435406
> 
> 赞同：2
> 
> 时间：2012-11-17T22:26:58.713
> 
> 标签：data-structures, tree

N 节点和深度 M 存在多少棵树？我想知道可以用 N 个节点和深度 M 制作的任何类型的树（简单树、二叉树等）的数量。

我一直在努力寻找它的公式，但到目前为止我还没有成功。有什么建议么？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:00:23.500

改变从根到深度“m”的节点数，只考虑一条路径，您可以有“m”个节点，因此可以有“m”个不同的树——如果你从根级别排除任何第 i 个节点到级别“m”。您将排除从 i 到 m 的整个路径。

现在，考虑到您可以以广度优先方式插入“n”个节点，您将拥有“n”个节点的组合，因为每个节点可能彼此不同。这为您提供了“n”个节点的所有组合，“k”乘“k”，对于每个可能的“k”，whick 与 2^n 相同。

混合具有不同级别数量的组合，每个级别都有不同的组合，因为每个树结构可能代表不同的树。所有组合将涉及每个“m”级的“n”个节点的组合数量。

我真的不知道如何从中得出最终公式，但我会说你想要的值接近 (2^n . m!)，考虑到这一点，对于 a 中“n”节点的每个可能组合给定级别，在m个不同级别中也有一组这些节点的组合。

只是为了说明清楚，我不确定如何精确计算，这是我直觉上能达到的最远距离。

[对所有 k 求和的确认 k 组合的](http://en.wikipedia.org/wiki/Binomial_coefficient#Sum_of_coefficients_row)引用。

# applescript - Spotify 的“播放器状态”在编辑器中可用，但在打包的应用程序中，它只能获得“«constant ****kPSP»”

> ID：13435412
> 
> 赞同：3
> 
> 时间：2012-11-17T22:27:34.170
> 
> 标签：applescript, spotify

这是一个测试代码：

```
tell application "Spotify"
    set playerState to player state as string
end tell
display dialog playerState 
```

在 AppleScript 编辑器中工作正常。但是，当我将脚本导出为应用程序时，我得到的只是： ![在此处输入图像描述](../Images/01509b9e9ad5314d5130d186cce3761b.png)

为什么会这样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T00:31:49.833

似乎 Spotify 并没有将常量强制转换为字符串。由于编辑器无法像在 AppleScript Editor 中运行脚本时那样从 applet 强制它，因此返回四字母常量代码。由于您无法将播放器状态的值作为字符串进行测试，因此请尝试根据常量本身对其进行测试。

```
property spotPause : «constant ****kPSp»
property spotPlay : «constant ****kPSP»

tell application "Spotify" to set playerState to player state

if playerState = spotPause then
    display dialog "paused"
else if playerState = spotPlay then
    display dialog "playing"
end if 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-04-09T09:53:26.087

最好使用此代码来获取播放器状态。您不需要知道确切的常数值。适用于 OS X 10.13

```
tell application "Spotify"
    if player state is playing then
        display dialog "Player running"
    else if player state is paused then
        display dialog "Player paused"
    else if player is stopped then
        display dialog "Player is stopped"
    else
        display dialog "Unknow state"
    end if
end tell 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-11T14:13:36.040

我无法评论*adayzdone*的答案，但这里有一个替代方案：

```
if player state is playing or player state is paused then 
```

例如

```
if application "Spotify" is running then

    tell application "Spotify"

        if player state is playing or player state is paused then

            set trackID to (get id of current track)

        end if

    end tell

end if 
```

在我自己的 Spotify-Applescript 项目上工作时，这至少适用于 Catalina (10.15.7)。

这个想法的来源来自[这个线程](https://community.spotify.com/t5/Spotify-for-Developers/Apple-OSA-script-not-returning-playback-information-for-new/m-p/4940507/highlight/true#M54)。

# python - 用于查找 Eulerian Tour 的 Python 代码在一种情况下不起作用。为什么？

> ID：13435413
> 
> 赞同：2
> 
> 时间：2012-11-17T22:27:39.540
> 
> 标签：python, recursion

我正在尝试解决 Udacity 上的一个问题，如下所述：

```
# Find Eulerian Tour
#
# Write a function that takes in a graph
# represented as a list of tuples
# and return a list of nodes that
# you would follow on an Eulerian Tour
#
# For example, if the input graph was
# [(1, 2), (2, 3), (3, 1)]
# A possible Eulerian tour would be [1, 2, 3, 1] 
```

我写的代码如下。它不是超级优雅，但似乎可以完成这项工作。

```
def getCurPoint(points, curPoint):
    for pair in range(len(points)):
        if curPoint in points[pair]:
            for i in points[pair]:
                if i != curPoint:
                    points.pop(pair)
                    return [curPoint] + getCurPoint(points, i)
    return []

def takeTour(graph):
    point = graph[0][0]
    criticals = []
    points = []
    for pair in range(len(graph)):
        if point in graph[pair] and len(criticals) <= 1:
            criticals.append(graph[pair])
        else:
            points.append(graph[pair])

    stops = [point]

    curPoint = criticals[0][1]

    stops += getCurPoint(points, curPoint)

    for x in criticals[1]:
        if x != point:
            stops.append(x)

    stops.append(point)

    return stops 
```

问题是，当我提交代码时，它通过了每个测试用例，除非`graph = [(0, 1), (1, 5), (1, 7), (4, 5), (4, 8), (1, 6), (3, 7), (5, 9), (2, 4), (0, 4), (2, 5), (3, 6), (8, 9)]`

知道为什么它会通过测试吗？（如果你有关于如何使这段代码更优雅的提示，我很想听听！）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-17T23:47:09.907

你没有回溯机制`getCurPoint()`。这意味着您的算法正在使用找到的第一条在图中行进的边，构建一条可能导致死胡同的路径，而无需遍历所有节点。

这正是您的示例所发生的情况。您的算法将从 node 开始`0`到 node `1`。此节点提供 3 条边来继续您的旅行（分别是`(1, 5)`、`(1, 7)`、`(1, 6)`），但其中一条边会导致死胡同，而无法完成欧拉之旅。不幸的是，您的图形定义中列出的第一条边`(1, 5)`是错误的路径，不会让您有任何机会到达节点`6`、`3`和`7`。

要检查我的确认，您可以尝试更改图的给定定义以用 反转边`(1, 5)`，`(1, 7)`然后查看您的算法将如何正确列出所有节点。

**我该如何帮助**

首先，为了帮助您自己解决这些问题，*您应该始终制作图表*（不仅是为了让费曼开心），并尝试在图表上遵循您的算法。这些案例很容易得出，很明显算法不正确，您可能会发现原因。

其次，*这个练习是关于回溯*的。你知道这是什么吗 ？如果没有，你可以尝试用谷歌搜索这个词，甚至在 stackoverflow 搜索框中搜索它，维基百科也有一篇很好的文章。

最后，我可以给你*一些关于你的编码风格的建议*。请将它们视为个人信息，并采取似乎适合您当前需求的方式：

如果可能：

*   `for x in range(len(graph)):`如果您以后才使用，请避免使用`graph[x]`。Python 提供了一个非常优雅的替换解决方案`for edge in graph:`。如果你真的需要你正在迭代的元素的索引，你可以选择优雅的： `for i, edge in enumerate(graph):`
*   避免你的 3 行构造（你已经使用过两次）涉及 a`if`中 的孤独`for`：

    ```
    for x in criticals[1]:
        if x != point:
            stops.append(x) 
    ```

    更喜欢显式和更小：

    ```
    node_a, node_b = critical_edges[1] 
    stops += [node_a] if node_b == node else [node_b] 
    ```

*   不太重要的代码装饰风格备注：

    *   避免 java CamelCase 用于变量、函数名和方法名，python 在样式上有一个 [PEP8](http://www.python.org/dev/peps/pep-0008/#prescriptive-naming-conventions)，它更喜欢变量名使用带下划线的小写字母。
    *   将“point”重命名为“node”以坚持图形上更广泛使用的词汇
    *   将 'pair' 重命名为 'edge' 以获得对变量含义而不是其类型的描述性命名（尽管您可以考虑将这两种信息混合在所谓的[Hungarian Notation](http://www.joelonsoftware.com/articles/Wrong.html)中）

应用装饰性备注，例如，我们将`getCurPoint`重命名为`get_next_nodes`，其中：

*   variable_with_underscore 而不是 CamelCase 和`Point`->`nodes`如前所述，
*   复数，因为它将返回节点列表
*   'cur' 被重命名为'next'，因为它是关于获取下一个节点。

**以更 Python 的方式重写代码的示例**

请注意，这只是一个重写，并且之前的错误始终存在。看看`get_next_nodes()`函数是如何变化的：

```
def get_next_nodes(edges, cur_node):
    connected_edges = [x for x in edges
                       if cur_node in x]
    if connected_edges:
        a, b = connected_edges[0]
        next_node = b if a == cur_node else a
        edges.remove(connected_edges[0])
        return [cur_node] + get_next_nodes(edges, next_node)
    return []

def take_tour(graph):
    start_node = graph[0][0]
    critical_edges = []
    nodes = []
    for edge in graph:
        if start_node in edge and len(critical_edges) < 2:
            critical_edges.append(edge)
        else:
            nodes.append(edge)

    second_node = critical_edges[0][1]
    stops = [start_node] + get_next_nodes(nodes, second_node)

    a, b = critical_edges[1]
    stops += [a] if b == start_node else [b]
    return stops + [start_node] 
```

**现在，您的算法还有更多问题**

*   您的脚本应该如何对非欧拉图做出反应？您的算法将输出各种各样的结果，从错误的节点列表到令人困惑的异常。如果要避免异常，则应引发适当的非混淆异常。用这些图试试你的算法：

    *   非欧拉：

        [(0, 1), (1, 5), (1, 7), (4, 5), (4, 8), (1, 6), (3, 7), (5, 9), ( 2, 4), (2, 5), (3, 6), (8, 9)]

    *   非欧拉：`[(0, 1), (0, 3)]`

    *   欧拉：`[(0, 0)]`
    *   非欧拉：`[]`
*   您在列表中手动添加 3 个节点`take_tour`。有一个更优雅的解决方案，代码更少！

*   你为什么选择一个结束边`take_tour`和起始边？你可能选错了！您看到选择多项选择中的第一个可能是错误的。试试这个图表：

    *   欧拉：`[(0, 1), (0, 1), (0, 2), (0, 2)]`，正确的结果应该是`[0, 1, 0, 2, 0]`。

**最后，让遇见给你一个正确的答案**

这个简单的递归代码将回答您尝试解决的初始问题。

请注意初始`getCurPoint`位置离做一些回溯不远。唯一的补充是引入了`for`循环，它将解析所有可能的解决方案，而不是盲目地采用第一个解决方案。

但要允许回溯，该函数必须能够退出当前路径计算。这是通过`False`在找不到路径的情况下允许返回值来完成的。`False`然后将从子函数调用到父函数重新执行，有效地解开递归，直到它可以尝试另一个边缘，这要归功于`for`循环。

您会注意到您可以合并`getCurPoint`和`take_tour`。这增加了在 new 中隐藏 2 个功能的好处`take_tour`：

*   它将能够向您展示欧拉路径（这与必须在同一节点上开始和结束的欧拉之旅不同）。
*   如果您足够好奇以强制另一个起始节点查看路径，您可以提供一个起始节点。

这是代码：

```
def take_tour(graph, node_start=None, cycle_only=True):
    if len(graph) == 0:
        if node_start is None:
            return []
        return [node_start]

    node_start = graph[0][0] if node_start is None else node_start

    for chosen_edge in [x for x in graph if node_start in x]:
        (node_a, node_b) = chosen_edge
        path = take_tour([e for e in graph if e != chosen_edge],
                         node_b if node_start == node_a else node_a,
                         cycle_only=False)
        if path is not False and (not cycle_only or node_start == path[-1]):
            return [node_start] + path
    return False 
```

如果您正在寻找其他一些简单的练习，这里有 2 个简单到中等的问题，这些问题都悬而未决，可以一口气回答：

*   您将如何修改`take_tour`以返回所有可能的游览/路径的列表？
*   并且您能否`take_tour`在所有可能的游览/路径的迭代器中进行转换？（一个聪明的迭代器，只根据请求计算下一条路径）。

我希望这已经足够具有教育意义了。

# jquery - 只运行一次函数

> ID：13435415
> 
> 赞同：1
> 
> 时间：2012-11-17T22:27:48.473
> 
> 标签：jquery, animation, slider

我希望这种情况只发生一次，而不是每次第三张幻灯片都等于当前幻灯片时。我该怎么做？.once() 会为此工作吗？

```
var currentSlide = current - 1;
var firstSlide = $('#slide1').index();
var secondSlide = $('#slide2').index();
var thirdSlide = $('#slide3').index();
if (thirdSlide == currentSlide) {
    $('img.joyceAnim').flipbook({
        'end': 4,
        'loop': false,
        'fps': 8,
        'mobileStep': 1,
        'images': 'anim/bench/%d.png'
    });
}​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:30:13.393

`.data()`当您已经为元素设置一次动画时，您可以在元素上设置一个指示器，然后在再次设置动画之前检查该指示器：

```
var currentSlide = current-1; 
var firstSlide = $('#slide1').index();
var secondSlide = $('#slide2').index();
var thirdSlide = $('#slide3').index();
var flip = $('img.joyceAnim');
var alreadyFlipped = flip.data("flipped");

if(thirdSlide == currentSlide && !alreadyFlipped){
    flip.data("flipped", true).flipbook({
        'end': 4,
        'loop': false,
        'fps': 8,
        'mobileStep': 1,
        'images': 'anim/bench/%d.png'
    });   

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:30:07.923

```
var currentSlide = current-1; 
var firstSlide = $('#slide1').index();
var secondSlide = $('#slide2').index();
var thirdSlide = $('#slide3').index();
var doIt = true;

if((thirdSlide == currentSlide) && doIt){
    doIt = false;
    $('img.joyceAnim').flipbook({
        'end': 4,
        'loop': false,
        'fps': 8,
        'mobileStep': 1,
        'images': 'anim/bench/%d.png'
    });   

} 
```

只需进行切换，看看您是否应该这样做。

# haskell - wxHaskell 库中的嵌套 Lambda

> ID：13435417
> 
> 赞同：1
> 
> 时间：2012-11-17T22:28:01.780
> 
> 标签：haskell, wxwidgets, wxhaskell

我一直在试图弄清楚如何使 staticText 元素调整大小以适应 wxHaskell 的内容。据我所知，这是 wxWidgets 中的默认行为，但 wxHaskell 包装器专门禁用了此行为。但是，创建新元素的库代码让我很困惑。谁能解释这段代码的作用？

```
staticText :: Window a -> [Prop (StaticText ())] -> IO (StaticText ())
staticText parent props
  = feed2 props 0 $
    initialWindow $ \id rect ->
    initialText   $ \txt -> \props flags ->
    do t <- staticTextCreate parent id txt rect flags {- (wxALIGN_LEFT + wxST_NO_AUTORESIZE) -}
       set t props
       return t 
```

我知道`feed2 x y f = f x y`，并且 initialWindow 的类型签名是

```
initialWindow :: (Id -> Rect -> [Prop (Window w)] -> Style -> a) -> [Prop (Window w)] -> Style -> a 
```

并且 initialText 的签名是

```
initialText :: Textual w => (String -> [Prop w] -> a) -> [Prop w] -> a 
```

但我就是无法理解所有的 lambdas。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T22:47:59.987

在 Haskell 中，一切都是嵌套的 lambda！`\txt -> \props flags -> do {...}`与 相同`\txt props flags -> do {...}`，两者实际上都是

```
\txt -> \props -> \flags -> do {...} 
```

这里有点令人困惑的是，这`\txt props flags`似乎是许多论点：

```
initialText :: ...=> (String -> [Prop w] -> a) -> ... 
```

似乎采用 2 参数函数，我们给它一个三参数 lambda。但请记住：*实际上*，每个函数只接受**一个**参数，其他一切都是通过柯里化完成的。在这种情况下，`a`又是一个函数类型，所以它实际上应该改为

```
initialText :: Textual w => (String -> [Prop w] -> b -> c) -> [Prop w] -> b -> c 
```

这不是乐趣的结束。to 的参数`initialWindow`似乎只有*很少的*参数，2 而不是 4，但事实并非如此：我们只给出`initialWindow`了它的第一个参数，结果是一个函数首先接受更多参数`[Prop w]`（在这种情况下，`[Prop(Window w)]`在`initialWindow`签名）。然后它返回`a`，我们将其重写为`b->c`; 在这种情况下，`initialWindow`需要的是`Style -> a`.

所以`initialText`这个应用程序中的实际签名是

```
(String -> [Prop(Window w)] -> Style -> c) -> [Prop w] -> Style -> c 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:38:14.747

我没用过的 WX 库，内部似乎使用了奇怪的回调或延续传递样式。这个阴影`props`以一种令人困惑的方式，让我重命名那个傻瓜：

```
staticText1 :: Window a -> [Prop (StaticText ())] -> IO (StaticText ())
staticText1 parent propsTopLevel
  = feed2 propsTopLevel 0 $
    initialWindow $ \id rect ->
    initialText   $ \txt -> \propsParam flags ->
    do t <- staticTextCreate parent id txt rect flags
       set t propsParam
       return t 
```

没有 ($) 我可以使用括号：

staticText2 :: Window a -> [Prop (StaticText ())] -> IO (StaticText ()) staticText2 parent propsTopLevel = feed2 propsTopLevel 0 (initialWindow (\id rect -> initialText (\txt -> \propsParam flags -> do t <- staticTextCreate parent id txt rect flags set t props return t)))

诸如此类的 lambda`\text -> \props flags ->`可以命名为：

```
staticText3 :: Window a -> [Prop (StaticText ())] -> IO (StaticText ())
staticText3 parent propsTopLevel = initialWindow myWindow propsTopLevel 0
  where makeWindow id rect = initialText myText
          where myText txt propsParam flags = do
                  t <- staticTextCreate parent id txt rect flags
                  set t propsParam
                  return t 
```

在`staticText3`我使用嵌套词法范围作为参数名称。让我更明确一点：

```
staticText4 :: Window a -> [Prop (StaticText ())] -> IO (StaticText ())
staticText4 = makeWindowTextStatic where
  makeWindowTextStatic parent propsTopLevel = initialWindow (makeTextStatic parent) propsTopLevel 0
  makeTextStatic parent id rect = initialText (makeStatic parent id rect)
  makeStatic parent id rect txt propsParam flags = do
    t <- staticTextCreate parent id txt rect flags
    set t propsParam
    return t 
```

这是否足够清楚以跟随流程？我还没有尝试去理解`initialWindow`和`initialText`他们自己。

# jquery - 如何使 DIV 显示在其他 Div 之上

> ID：13435430
> 
> 赞同：4
> 
> 时间：2012-11-17T22:29:33.013
> 
> 标签：jquery, html, css, positioning

我在 jsFiddle 上上传了我的代码，你可以在那里看到它。

[http://jsfiddle.net/SrT2U/2/](http://jsfiddle.net/SrT2U/2/)

当你点击链接时，隐藏的 FAQ 部分会显示出来，它会向下推其他 div。但这不是我想要的，我需要所有其他 div 留在原处，而我隐藏的常见问题解答部分只是浮在顶部。不知道该怎么做。甚至不确定这是否应该在 HTML、CSS 或 jQuery 中完成。

我的 jQuery 代码：

```
$(function(){
    $(".OpenTopMessage").click(function () {
        $("#details").slideToggle("slow");
    });
}); 
```

HTML 代码：

```
<div style="border: 1px solid #000;">
    <span>link</span>
    <span>&nbsp;&nbsp;|&nbsp;&nbsp;</span>
    <span>link</span>
    <span>&nbsp;&nbsp;|&nbsp;&nbsp;</span>
    <span>link</span>
    <span>&nbsp;&nbsp;|&nbsp;&nbsp;</span>
    <span>link</span>
    <span>&nbsp;&nbsp;|&nbsp;&nbsp;</span>
    <span>link</span>
    <span>&nbsp;&nbsp;|&nbsp;&nbsp;</span>
</div>

<div id="faqBox">
   <table width="100%">
<tr><td><a href="#" id="openFAQ" class="OpenTopMessage">this is hte faq section</a></td>
</tr>
    </table>

    <div id="details" style="display:none">
    <br/><br/><br/><br/><br/><br/><br/><br/>
 the display style property is set to none to ensure that the element no longer affects the layout of the page
 <br/><br/><br/><br/><br/><br/><br/><br/>
    </div>
</div>
<br/><br/>
<div style="background:#c00;">other stuff heren the height reaches 0 after a hiding animation, the display style property is set to </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:31:41.507

一个简单的解决方法是添加`position:absolute`到您的 faqBox div。

**[jsFiddle 示例](http://jsfiddle.net/j08691/SrT2U/3/)**

`Position:absolute`将元素从文档流中取出，在这种情况下，允许它出现在您的其他元素之上而不是向下推。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T22:32:38.600

您可以`position:absolute`在`#details`div 上使用。

**示例：http:** [//jsfiddle.net/SrT2U/9/](http://jsfiddle.net/SrT2U/9/)

你需要摆弄`margin`它才能让它排队。

* * *

**编辑：**注意到您正在使用`margin:0 auto;`将常见问题解答框居中。您可能需要找到另一种方法来排列盒子。

* * *

**编辑2：**

我注意到如果您将 FAQ div 放在表格中`#faqbox`，然后更改`margin:0 auto;`为div 并且一切正常。`margin-top: 20px; margin-left:-16px;``#details`

**示例 2：http:** [//jsfiddle.net/SrT2U/13/](http://jsfiddle.net/SrT2U/13/)

注意：将类似的放在`div`里面`table`不是规范的代码，但它确实可以重新集中常见问题解答。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T22:34:44.667

如果您希望 div 显示在其他元素之上而不改变其他元素的位置，则需要将其 CSS 位置属性设置为绝对。

在您的 css 文件中指定以下内容：

```
#details{
    position: absolute;
    left: 100px;//your desired position as regard to the left of your window
    top: 100px;//your desired position as regard to the top of your window
} 
```

您也可以使用 jQuery 执行此操作，如下所示：

```
$(".OpenTopMessage").click(function () {
    $("#details").slideToggle("slow");
    $("#details").css("position", "absolute");
    $("#details").css("left", "40px/*some value*/");
    $("#details").css("top", "40px/*some value*/");
}); 
```

如果您仍想将弹出框定位在窗口的中心，可以使用 jQuery 将其居中，如下所示。

```
$(".OpenTopMessage").click(function () {
    $("#details").slideToggle("slow");
    $("#details").css("position", "absolute");
    window_width = $(window).width(); //Get the user's window's width
    window_height = $(window).height(); //Get the user's window's height
    $("#details").css("left", (window_width-$("#details").width())/2);
    $("#details").css("top", (window_height-$("#details").height())/2);
}); 
```

然后你的盒子就会居中。

此外，您可能会发现您的按钮“这是 hte faq 部分”被您的 div 覆盖，但您可以通过添加关闭按钮或添加以下代码轻松启用关闭弹出框：

```
$("body:not(#details)").click(function() {
    $("#details").slideToggle("slow");
}); 
```

这使您可以单击页面的任何部分以关闭目标 div #details，div 本身除外。

通常，如果您尝试制作弹出框或对话框，您可以尝试使用其他预先设计的插件，包括 jQuery UI ( [http://jqueryui.com/dialog/](http://jqueryui.com/dialog/) ) 或 blockUI ( [http://www .malsup.com/jquery/block/](http://www.malsup.com/jquery/block/)），其中前者只支持对话框，后者支持各种弹出框。

# c - 如何检查内核是否对线程进行本地或全局调度

> ID：13435433
> 
> 赞同：0
> 
> 时间：2012-11-17T22:29:58.550
> 
> 标签：c, multithreading, process, linux-kernel, scheduler

`kernel/sched/core.c`我看到代码的哪一部分来告诉内核正在使用哪种类型的调度来调度线程。还是我在寻找正确的地方？一个多进程可以有多个线程，这些单独的线程是如何调度的？基于进程（本地）或线程池（全局）

**编辑：**

我目前正在记录文件`context_switch`中发生的情况，`core.c`以查看进程是如何切换的。但是当我尝试分析这些数据时，它变得太复杂了。任何人都可以提出一个更简单的方法吗？

我在[http://lxr.linux.no/linux+v3.6.6/include/linux/sched.h#L36找到了这个](http://lxr.linux.no/linux+v3.6.6/include/linux/sched.h#L36)

```
 /*
   * Scheduling policies
  */
  #define SCHED_NORMAL            0
  #define SCHED_FIFO              1
  #define SCHED_RR                2
  #define SCHED_BATCH             3
  /* SCHED_ISO: reserved but not implemented yet */
  #define SCHED_IDLE              5 
```

但我没有看到它以我能理解的方式在任何地方使用。

# c# - WP7 上的间歇性 Sqlite 错误

> ID：13435436
> 
> 赞同：1
> 
> 时间：2012-11-17T22:30:22.217
> 
> 标签：c#, windows-phone-7, sqlite

我正在使用 Sqlite 为 WP7 创建一个数据库驱动的应用程序。我已经从[Google Code](http://code.google.com/p/csharp-sqlite/)和[Codeplex](http://wp7sqlite.codeplex.com/)下载并编译了库，但两者都有相同的问题。

在执行过程中看似随机的时间，我会收到“SQL 逻辑错误或缺少数据库”、“磁盘 I/O 错误”或“没有这样的表”。大多数情况下，这发生在 SELECT 语句上，偶尔发生在 UPDATE 上，较少发生在 INSERT 上。有时查询执行没有问题，而有时相同的查询会抛出这些错误。

我已经在市场上有一个使用 Sqlite 的现有应用程序，它运行没有问题；大多数代码以及 Community.CsharpSqlite DLL 都是从该项目中复制的。

该数据库是在[Sqlit Administrator](http://sqliteadmin.orbmu2k.de/)中创建的，并作为资源添加到项目中，与现有的正常运行的应用程序相同。在调试模式下失败的查询在 Sqlite Administrator 中运行良好。我还从头开始重新创建了空白数据库，因为它可能已损坏，但同样的随机错误。

我已经搜索了解决方案，但最终还是会继续访问相同的论坛主题。我已经运行`PRAGMA journal_mode = OFF`，验证了[编译符号](http://code.google.com/p/csharp-sqlite/wiki/CompilerOptions)，[调整了 FileStream.HandleTracker](https://stackoverflow.com/questions/5594661/windows-phone-7-sqlite)，谁知道此时还有什么。

我怀疑这可能是我使用后台线程来填充 UI，但不仅现有应用程序与线程一起工作正常，当我将代码移出后台线程并进入 UI 线程时，错误仍然发生。

我相当确定问题出在数据库文件本身，但我不知道还要寻找什么。

# java - 有没有办法从 JVM 中判断某个特定方法是否已被 JIT 编译？

> ID：13435438
> 
> 赞同：6
> 
> 时间：2012-11-17T22:30:28.120
> 
> 标签：java, performance, jvm, jit, microbenchmark

在编写微基准测试时，可以观察到运行时的巨大差异，具体取决于方法是否已编译。有没有办法从程序中判断特定方法是否已编译？或者，有没有办法请求它，或者知道如何在没有任何额外信息的情况下充分预热它，例如传递给 JVM 的标志？显然，这不一定是完美的（例如，可能存在一些导致 JVM 回退到解释代码的条件），但这肯定是一种改进。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:50:24.193

对于 Sun/Oracle JVM，您可以使用该`-XX:CompileThreshold=1000`设置。

这 - 正如[官方文档](http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html)所述 - 定义：

> 编译前的方法调用/分支数

然后，只需使用该数字来“预热”JVM。

您还可以使用`-XX:-PrintCompilation`with`-XX:CompileThreshold`以便在编译方法时（在控制台中）收到通知。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:14:30.283

我很确定您可以打开日志记录，该日志记录将在方法被 JITCed 时显示。但我不知道从 Java 内部有什么方法可以告诉我。

请记住，JIT 编译不是一个事件，而是一个过程——一个方法可能会被重新编译多次，因为有关其特征的更多信息变得可用。

最后，请注意“热身”在一般情况下是不确定的。虽然您通常可以可靠地“预热”单个方法，但由于许多因素，即使是规模不大的应用程序也更难。

（虽然我不知道为什么无法将读取某种方法的某种 JITC 状态的能力添加到嵌入式调试工具中。）

**补充：**在对代码“片段”进行基准测试时要注意的一件事是，执行所有循环的最外层方法通常不是 JITC 可用的（取决于 JITC 的实现方式），因为它永远不会返回因此永远不能调用 JITCed 版本。因此，应始终将要进行基准测试的代码的“肉”放在重复调用的单独方法中，而不是将循环和要进行基准测试的代码放在同一方法中。

# javascript - 这个 javascript ajax 代码有什么问题？

> ID：13435444
> 
> 赞同：0
> 
> 时间：2012-11-17T22:30:54.860
> 
> 标签：javascript, jquery, ajax

> **可能重复：**
> [$ 未在 JavaScript 中定义](https://stackoverflow.com/questions/5421910/not-defined-in-javascript)

萤火虫告诉我：

> `ReferenceError: $ is not defined [Break On This Error]`
> 
> >`$.ajax({`

但我不知道为什么，或者我将如何纠正这个？

这应该将数据从 facebook auth 写入 url 或其他东西，以便我以后可以使用 java 检索它。

```
 <script>
      function login() {
            FB.login(function(response) {
                if (response.authResponse) {
                    // connected
                    console.log((response));
                    console.log((response.session));
                    $.ajax({
                        url: "fbReceiver.html", 
                        data: response,
                        type: "POST",
                        success: function() {}
                    });

                } else {
                    // cancelled
                }
            });
        }
 </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:33:21.117

确保 jQuery 文件加载到您在此处的代码*之上。*

```
<script src="jQuery file here"></script>

<script> your code here <script> 
```

您可以在此处获取 jQuery 文件的 URL：http: [//jquery.com/](http://jquery.com/)

# python - 有没有办法用python将文本输入网站？

> ID：13435451
> 
> 赞同：4
> 
> 时间：2012-11-17T22:31:41.380
> 
> 标签：python

基本上，我需要制作一个可以访问网站并输入文本的 python 程序。
例如，去 google 并在搜索框中输入文本，然后按 enter。
这甚至可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:03:35.987

Zack 是正确`urllib`的，可以胜任。问题是网站如何接受输入没有通用的方法。

例如：谷歌搜索：

'http://www.google.com/search?q=looking+for+something'

雅虎搜索：'http://search.yahoo.com/search?p=looking+for+something'

查看此操作指南以了解有关 urllib 的更多[信息](http://docs.python.org/dev/howto/urllib2.html)

# facebook - 批处理图 - 计算众多页面的点赞数

> ID：13435452
> 
> 赞同：3
> 
> 时间：2012-11-17T22:31:46.703
> 
> 标签：facebook, batch-processing

我目前通过调用下面的代码来获取单个页面上的点赞数，但是我想同时获取多个页面的点赞数。似乎找不到任何关于 BATCH 是否允许这样做的文档。

$like_result = file_get_contents('http://graph.facebook.com/?id=http://www.myadd.com/page1.php);
$like_array = json_decode($like_result, true);
$like_no = $like_array['shares'];

即需要喜欢的数量：
ahttp://graph.facebook.com/?id=http://www.myadd.com/page1.php
ahttp://graph.facebook.com/?id=http:/ /www.myadd.com/page2.php
ahttp://graph.facebook.com/?id=http://www.myadd.com/page3.php

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T22:47:12.827

[Graph API 文档](https://developers.facebook.com/docs/graph-api/using-graph-api/v2.2#multirequests)解释了如何使用同时`ids`选择多个对象：

`/<API VERSION>/?ids=http://www.myadd.com/page1.php,http://www.myadd.com/page2.php,http://www.myadd.com/page3.php`

您还可以使用[Batch Requests](https://developers.facebook.com/docs/reference/api/batch/) API（在文档中有使用示例）或两者的组合（批量调用请求多个对象的请求）

# c# - WPF 中的 Cookie 操作

> ID：13435457
> 
> 赞同：1
> 
> 时间：2012-11-17T22:32:09.340
> 
> 标签：c#, wpf, http, cookies, browser

我正在考虑编写我的第一个 WPF 应用程序。在开始之前，我想知道是否可以操纵现有的浏览器 cookie。

我需要检查是否存在特定的 cookie（我有 cookie 名称）。如果它确实存在，我想修改它的值。

我会很感激任何意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-20T14:50:14.367

设置 Cookie：

Uri u = new Uri(@"C:\Paths");

Application.SetCookie(u, file.FileName);

获取存储在 Cookie 中的值： Uri u = new Uri(@"C:\Paths"); 字符串值 = Application.GetCookie(u);

# android - 在 Windows 上使用 Android ADT 构建 NDK 应用

> ID：13435467
> 
> 赞同：3
> 
> 时间：2012-11-17T22:34:04.343
> 
> 标签：android, c++, windows, android-ndk, adt

尽管有大量关于该主题的信息，但没有关于如何在 ADT 中编译 C++ 代码的明确指南。是否需要 Cygwin？构建工件去哪里了？如何配置构建包的目标文件夹？是否有调试和发布版本？是否可以在 ADT 中调试和单步执行 C++ 代码？也许这一切都在一个资源中进行了描述，那么欢迎提供链接！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T15:45:28.430

[只需在http://developer.android.com/sdk/index.html](http://developer.android.com/tools/sdk/ndk/index.html)下载全新的 ADT 包，在[http://developer.android.com/tools/sdk/ndk/index.html](http://developer.android.com/sdk/index.html)下载NDK r8c 。您不需要 cygwin，您的 NDK 构建与正常的 Android 开发完全集成（即二进制文件被复制到文件夹并由 APK 构建器自动获取）。`lib/armeabi`

可以调试本机代码（如果您的应用程序是可调试的），您可以通过运行为您的本机代码选择发布或调试配置

```
ndk-build NDK_DEBUG=1      --> force a debuggable build
ndk-build NDK_DEBUG=0      --> force a release build 
```

我强烈建议您在开始自己动手之前阅读 NDK 文档并使用作为 NDK 一部分提供的示例。实际上 NDK 构建系统是 GNU make 的一个包装器，滥用这些工具很容易使事情变得非常复杂。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T11:30:45.443

请注意，在 Windows 上，您有一个完全不同的选项将 Android 开发与 Visual Studio 2010 集成：[http](http://code.google.com/p/vs-android/) ://code.google.com/p/vs-android/ 。

有一个可视化调试的解决方案，Visual Studio 风格：http: [//visualgdb.com/](http://visualgdb.com/?features=android) ?features=android （但这不是免费的）。

似乎还有另一种选择：[http://www.wingdb.com/wgMobileEdition.htm](http://www.wingdb.com/wgMobileEdition.htm)，它适用于 VS 2008。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T22:57:39.840

好的，这是一个有很多帮助的页面[http://tools.android.com/recent/usingthendkplugin](http://tools.android.com/recent/usingthendkplugin) 我稍后可能会在此处添加更多信息以帮助其他人了解该主题。

# magento - 如何在 magento 中进行第二个根类别导航？

> ID：13435468
> 
> 赞同：2
> 
> 时间：2012-11-17T22:34:05.867
> 
> 标签：magento

除了将子类别添加到主根类别时获得的正常导航之外，我希望能够创建一个新的根类别，为其分配子类别并将其显示为单独的菜单。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T09:26:57.503

希望这可以帮助您：
[链接 1](http://www.magentocommerce.com/knowledge-base/entry/managing-root-categories)
[链接 2](http://www.magentocommerce.com/wiki/3_-_store_setup_and_management/catalog/creating_and_assigning_root_categories)

检索另一个根类别

```
<?php 
echo '<pre>';
$id=9; 
    $catagory_model = Mage::getModel('catalog/category');
    $categories = $catagory_model->load($id); // where $id will be the known category id
    if(!empty($categories))
    {
        echo 'category name->'.$categories->getName(); //get category name
        echo '<br>';
        echo 'category image url->'.$categories->getImageUrl(); //get category image url
        echo '<br>';
        echo 'category url path->'.$categories->getUrlPath(); //get category url path
        echo '<br>'; 
    }
    ?> 
```

现在`$id=9;`是我的新根类别 ID。
要检索这些新根类别的子类别，`($id=9;)`下面是以下参考代码。
根据您的要求定制它。

```
<?php $helper = $this->helper('catalog/category') ?>
 <?php $categories = $this->getStoreCategories() ?>
  <?php foreach($categories as $category): ?>
    <?php $subcategories = $category->getChildren() ?>
      <?php foreach($subcategories as $subcategory): ?>
        <?php $subsubcategories = $subcategory->getChildren() ?>
         <?php foreach($subsubcategories as $subsubcategory): ?>
         <?php endforeach; ?><!-- end foreach subsubcategories -->
      <?php endforeach; ?><!-- end foreach subcategories -->
  <?php endforeach; ?><!-- end foreach categories --> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-10T01:40:51.080

在一个理想的世界里，你现在已经找到了答案，但如果你没有修改 Nikhil 的答案，让我基本上按照你的描述去做，完全没有任何便利......

```
$id=9; 
$catagory_model = Mage::getModel('catalog/category');
$categories = $catagory_model->load($id);
if(!empty($categories))
{
    $cats = explode(",", $categories->getChildren());
    foreach($cats AS $c)
    {
        $cat = $catagory_model->load(trim($c));
        echo '<a href="/'.$cat->getUrlKey().'">'.$cat->getName().'</a>';
    }
} 
```

我只是粘贴我用过的东西。现实情况是，您必须构建 html 才能使其执行您想要执行的任何操作。如果循环中有子类别，则必须在 foreach 部分中运行另一个 fetch。我对 magento 不够熟悉，不知道可以在 $cat 对象上运行哪些方法。我做了一个`print_r($cat)`检查对象并幸运地猜测 getUrlKey 将可用。

Magento...噗！你会认为 ebay 会有比这更高的标准。

# django - 如何使用 django admin 更改模板中的 css 项？

> ID：13435469
> 
> 赞同：0
> 
> 时间：2012-11-17T22:34:29.067
> 
> 标签：django, django-templates

我想知道是否有某种方法可以使用 django admin 从模板页面更改 css 类。我想将 django 标签放在 css 文件中。

例子：

```
body {
    background-color: {{ body.color }};
    width: {{ body.width }};
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T10:03:41.597

您还可以使用模板标签包含您的 CSS 文件。这需要一个样式标签，但考虑到这里的动态方法，这真的不是什么大问题：

```
<html>
    <head>
        <style type="text/css">
        {% include 'templates/mytemplate.css' %}
        </style>
    </head>
    <body></body>
</html> 
```

然后，模板可以是您上面描述的。然后 CSS 模板也可以访问您的基本模板可以访问的任何数据。

根据您的用例，您也可以使用块做一些事情，但我不确定此时是否值得探索。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:54:31.593

就在我的脑海中：

*   创建一个模型来存储你想要的 CSS 值
*   注册模型以显示在管理屏幕中
*   在您的视图中，将这些值作为字典返回
*   在模板中，使用您建议的值

# scala - 如何使用 Scaladoc 生成类型层次图？

> ID：13435474
> 
> 赞同：12
> 
> 时间：2012-11-17T22:35:00.280
> 
> 标签：scala, scaladoc

我希望 Scaladoc 为以下代码片段生成类型层次图：

```
trait A
trait B extends A 
```

但是当我执行时`scaladoc <file>.scala`，没有显示类型层次结构——既不是 in`A`也不是`B`. 我怎样才能生成这样的图表？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-17T22:35:00.280

首先，为此需要 Scaladoc2，它是 Scala 2.10 的一部分。

如果安装了 2.10，还需要将`-diagrams`选项传递给 Scaladoc 以生成图表。但是，如果您这样做，则可能会出现以下错误消息：

```
Graphviz dot encountered an error when generating the diagram for:
_root_
These are usually spurious errors, but if you notice a persistant error on
a diagram, please use the -diagrams-debug flag and report a bug with the output.
Graphviz will be restarted... 
```

发生错误是因为 Scaladoc 不会自行生成图表，而是尝试调用[Graphviz](http://www.graphviz.org/)来完成这项工作。当我们添加`-diagrams-debug`标志时，我们会得到确切的错误消息：

```
The following is the log of the failure:
  Main thread in _root_: Exception: java.io.IOException: Cannot run program "dot": java.io.IOException: error=2, No such file or directory 
```

要解决这个问题，需要安装程序`dot`，它是 Graphviz 的一部分。这样做之后，应该能够`scaladoc -diagrams <file>.scala`成功执行并在生成的文档中看到成员搜索栏上方的标签“Type Hierarchy”。

执行`scaladoc -help`显示图表选项的更多信息：

```
 -diagrams                                   Create inheritance diagrams for classes, traits and packages.
  -diagrams-dot-path <path>                   The path to the dot executable used to generate the inheritance diagrams. Eg: /usr/bin/dot
  -diagrams-dot-restart <n>                   The number of times to restart a malfunctioning dot process before disabling diagrams (default: 5)
  -diagrams-dot-timeout <n>                   The timeout before the graphviz dot util is forcefully closed, in seconds (default: 10)
  -diagrams-max-classes <n>                   The maximum number of superclasses or subclasses to show in a diagram
  -diagrams-max-implicits <n>                 The maximum number of implicitly converted classes to show in a diagram 
```

# opengl - 关于OpenGL坐标系的困惑

> ID：13435476
> 
> 赞同：-1
> 
> 时间：2012-11-17T22:35:08.413
> 
> 标签：opengl, matrix, glsl, hierarchy, transformation

我无法理解 OpenGL 中空间的核心概念。几个星期以来，我一直在阅读一本关于现代 3D 图形的在线书籍，我经常发现自己对程序中使用的所有空间感到困惑。具体来说，空间如：模型空间、世界空间、相机空间、剪辑空间。我似乎无法理解我应该将矩阵转换为的顺序，这是我的一个教程程序中的一个示例：

```
//.vert shader of a program
#version 330

layout(location = 0) in vec4 position;

uniform mat4 cameraToClipMatrix;
uniform mat4 worldToCameraMatrix;
uniform mat4 modelToWorldMatrix;

void main()
{
    vec4 temp = modelToWorldMatrix * position;
    temp = worldToCameraMatrix * temp;
    gl_Position = cameraToClipMatrix * temp;
} 
```

cameraToClip、worldToCamera、XtoY、ZtoQ，我如何才能了解 OpenGL、网站中的这些空间？视频？参考？或者我应该回去重新阅读教程中这些空间的信息，直到它附着在我的大脑上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:51:36.533

我真的不知道如何解释它比我做得更好。尤其是当矩阵被尽可能清晰地命名时。

把矩阵想象成一个函数。函数有输入并返回一个值。您必须传递正确的输入，否则您的编译器会报错。

考虑这些函数：

```
Float intToFloat(Int i);
Double floatToDouble(Float f);
Real doubleToReal(Double d); 
```

其中`Int`、`Float`、`Double`和`Real`是用户定义的 C++ 类型。

假设我需要编写这个函数：

```
Real intToReal(Int i); 
```

所以我只有一个`Int`. 在上述函数中，我可以调用的函数*只有一个*`intToFloat`： . 这个名字说明了一切：它需要一个 int 并将其转换为 float。因此，给定一个`Int`，我*唯一*能做的就是 call `intToFloat`。

```
Int i = ...;
Float f = intToFloat(i); 
```

好吧，现在我有一个`Float`. 我只能调用一个函数：`floatToDouble`.

```
Double d = floatToDouble(d); 
```

有了这个，我只能打电话`doubleToReal`。这意味着我们的`intToReal`功能是：

```
Real intToReal(Int i)
{
  Int i = ...;
  Float f = intToFloat(i);
  Double d = floatToDouble(d);
  return doubleToReal(d);
} 
```

就像矩阵示例一样。

顶点着色器所做的最重要的事情是将位置从其原始空间（称为模型空间）转换到 OpenGL 定义的称为剪辑空间的空间。这是大多数顶点着色器的工作#1。

矩阵就像那些函数一样，将位置转换为中间空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T14:44:19.620

这个问题在解决之前是没有答案的。对某些人来说足够好，让他们理解概念的东西，不会对每个人都有同样的效果。我最好的建议是在成为 3D 程序员之前先学习成为 3D 建模师。这就是我所做的。一旦您对数据的可视化非常熟悉，那么您就可以更轻松地形成心智模型，并牢记它们的编码。当您需要进一步的可视化来帮助您创建算法时，您将能够在不使用代码的情况下创建它们。

# jsoup - 使用 JSoup 解析 HTML

> ID：13435479
> 
> 赞同：1
> 
> 时间：2012-11-17T22:35:30.307
> 
> 标签：jsoup

我想解析出[这个](http://photojournal.jpl.nasa.gov/catalog/PIA16465)Nasa 页面上的描述，页面底部的文本

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T23:59:56.633

首先，您需要连接到页面并将其解析为一个`Document`（确保您导入 Jsoup 的），然后您可以使用[Selector API](http://jsoup.org/cookbook/extracting-data/selector-syntax)来选择您需要的任何内容。

**这是一个例子：**

```
// Connect to page and parse html into a 'Document'
Document doc = Jsoup.connect("http://photojournal.jpl.nasa.gov/catalog/PIA16465").get();

for( Element element : doc.select("p") )    // Select all 'p'-Tags and loop over them
{
    if( element.hasText() )                 // Check if the element has text (since there are some empty too)
    {
        System.out.println(element.text()); // print the element's text
    }
} 
```

* * *

## - 编辑 -

```
for( Element element : doc.select("dd p") ) // Or: "dd > p"
{
    if( element.hasText() )
    {
        System.out.println(element.text());
        break;
    }
} 
```

而不是循环，你可以使用这样的东西：

```
Element firstTag = doc.select("dd p").first(); 
```

这将为您提供 dd-Tag 之后的第一个 p-Tag。但是在这里它不起作用，因为有很多空的 p-tags 匹配它。但是，您可以使用正则表达式选择器（参见上面的链接）来解决这个问题，但首先循环更容易理解。

# php - mysqli 无法获取数据库？

> ID：13435482
> 
> 赞同：1
> 
> 时间：2012-11-17T22:35:49.847
> 
> 标签：php

显然我的数据库功能无法获取数据库？

警告：mysqli::real_escape_string()：无法获取数据库

我创建了一个扩展 MySQLi 的自定义数据库类。

这是我构建它的方式。

```
public function __construct(){
    $db = new mysqli(
        DB_HOST, DB_USER, DB_PASS, DB_NAME);

    $db->select_db(DB_NAME);
    return $db;
} 
```

我正在选择数据库，不是吗？

发生这种情况的代码在这里：

```
 private static function readSession($sessionId)
    {
    global $database;
    $sessionId = session_id();
    $sessionId = $database->real_escape_string($sessionId);
    $time = time();
    $result = $database->query("SELECT sessiondata FROM sessions WHERE sessionid='$sessionId' AND expiry > $time");
    if ($result->num_rows > 0) {
        $row = $result->fetch_array();
        return $row['sessiondata'];
    }
    return "";
} 
```

在调用会话管理功能之前启动数据库。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:44:25.660

你说你的自定义类扩展了 mysqli。如果是这种情况，您需要`__construct()`在扩展构造函数中调用 mysqli，而不返回任何内容：

```
class YourDatabase extends mysqli {
  public function __construct() {
    // Call the mysqli constructor explictly
    parent::__construct(DB_HOST, DB_USER, DB_PASS, DB_NAME);
    // No need to call select_db() again, since default db was selected in the 
    // parent constructor

    // Don't return anything
    // the constructor returns $this, which extends mysqli
    return;
  }
}

// Use as:
$database = new YourClass();
$database->query("SELECT * FROM atable"); 
```

扩展类意味着您正在使用父类的后代。您不需要实例化父类的实例，但如果您需要使用其构造函数并扩展其功能，则必须显式调用`parent::__construct(...)`子类的`__construct()`.

# asp.net - ASP.NET 中面板的递归性

> ID：13435485
> 
> 赞同：3
> 
> 时间：2012-11-17T22:36:32.930
> 
> 标签：asp.net

我有一个带有名为“类别”的表的数据库。该表有 3 列：1\. ID 2\. Name 3\. ParentID。

```
id | Name    |ParentID
_____________________
1  | John    | 0
2  | Charlie | 1
3  | Vasily  | 1
4  | David   | 2
5  | Edward  | 3 
```

所以约翰是查理和瓦西里的父母，大卫是查理的孩子，爱德华是瓦西里的孩子。问题是：考虑到子面板必须位于其父面板内，我如何为每个类别创建和填充一些面板？[这个问题与这里](https://stackoverflow.com/questions/2572721/recursive-treeview-in-asp-net)的问题几乎相同，但是我真的需要它与面板而不是树视图一起使用。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:36:15.543

**you should change the code as it is**

```
public class MyObject
{
    public int Id;
    public int ParentId;
    public string Name;
}

protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack) {
        List<MyObject> list = new List<MyObject>();
        list.Add(new MyObject() { Id = 1, Name = "Alice", ParentId = 0 });
        list.Add(new MyObject() { Id = 2, Name = "Bob", ParentId = 1 });
        list.Add(new MyObject() { Id = 3, Name = "Charlie", ParentId = 1 });
        list.Add(new MyObject() { Id = 4, Name = "David", ParentId = 2 });

        BindTree(list, null);
    }
}

private void BindTree(IEnumerable<MyObject> list, Panel parentPanel)
{

    var nodes = list.Where(x => parentPanel == null ? x.ParentId == 0 : x.ParentId == int.Parse(parentPanel.ID));
    foreach (var node in nodes) {
        Panel newPanel = new Panel() { ID = node.Id.ToString() };
        if (parentPanel == null) {
            Panel1.Controls.Add(newPanel);
        } else {
            parentPanel.Controls.Add(newPanel);
        }
        BindTree(list, newPanel);
    }
} 
```

# wpf - Visual Studio 2010/2012 WPF 设计器扩展

> ID：13435490
> 
> 赞同：20
> 
> 时间：2012-11-17T22:36:53.157
> 
> 标签：wpf, visual-studio-2010, visual-studio, visual-studio-2012, designer

当我使用 Blend 4/5 时，我可以像这样为 Blend WPF 设计器创建扩展：

```
using System.ComponentModel.Composition;

using Microsoft.Expression.DesignModel.Metadata;
using Microsoft.Expression.Extensibility;
using Microsoft.Expression.Platform;
using Microsoft.Expression.WpfPlatform;

namespace Elysium.Extension
{
    [Export(typeof(IPackage))]
    public class Package : IPackage
    {
        private IServices _services;

        public void Load(IServices services)
        {
            _services = services;

            var platformService = _services.GetService<IPlatformService>();
            platformService.PlatformCreated += Register;
        }

        private void Register(object sender, PlatformEventArgs e)
        {
            var wpf = e.Platform as WpfPlatform;
            if (wpf != null)
            {
                wpf.Metadata.AddAssemblyGroupMapping(AssemblyGroup.ExtendedControls, "Elysium.Extension");
                wpf.InstanceBuilderFactory.Register(new CustomWindowInstanceBuilder());
            }
        }

        public void Unload()
        {
        }
    }
} 
```

在这段代码中，我订阅了 IPlatform 服务，当它更新时，我通过 WPFPlatform 对象注册了我的自定义 WindowInstanceBuilder。

我如何为 Visual Studio 2010/2012 设计器做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T15:47:52.330

有关 Visual Studio 可扩展性的一些提示，请参阅[“Visual Studio 2010 插件编写文章/教程？”](https://stackoverflow.com/questions/1146776/visual-studio-2010-addin-writing-articles-tutorials) . Visual Studio SDK 可能包含您需要的信息。

如果这对您有用，您可以将解决方案扩展到 Visual Studio 2012。

# android - 游戏，碰撞视图

> ID：13435492
> 
> 赞同：1
> 
> 时间：2012-11-17T22:37:19.683
> 
> 标签：android, view

我正在设计一个弓箭手游戏。当箭头击中目标时，它停止移动。我想要完成的是定义一个公式来预测/获取目标和箭头在视图上相遇的位置。

当箭头的速度随初始速度变化并且箭头也有角度时，就会出现问题。另外，屏幕上的图像按`x - bitmapt.getWidth/2`（高度相同，h/2..）放置

如果箭头移动得太快，那么我需要计算一个错误，以便箭头不会错过目标，即使它们应该与我们所拥有的 x 和 y 相同，箭头也会像`X + speed`像素一样移动。所以我来到了这样的事情！

```
if(arrow[i].getX() + v0x[i] / 2 >= target.getTarget().getX() && arrow[i].getX() <= target.getTarget().getX() + v0x[i] / 2) 
```

我使用 x/2 的速度来指定误差范围。

```
arrowX + velocity/2 >= collision point >= targetX + velocity/2 
```

但是，它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:00:08.683

这是一个纯粹的数学问题，关于碰撞检测有很多文献。我建议你使用图书馆。对于 2D，我推荐[JBox2D](http://www.jbox2d.org/)。它是一个物理引擎（例如在愤怒的小鸟中使用）。你会得到碰撞检测等等:)

# c# - HttpWebRequest 图像加载延迟

> ID：13435496
> 
> 赞同：-1
> 
> 时间：2012-11-17T22:38:00.060
> 
> 标签：c#, httpwebrequest

所以我正在向特定网站发送 httpwebrequest，我需要来自该网站的图像，但是该图像在请求完成后 3-5 秒加载，因此源不包含图像，我想进行某种延迟所以我可以在几秒钟后得到响应，这是我的代码：

```
HttpWebRequest req1 = (HttpWebRequest)WebRequest.Create("url");            
            using(var httpResponse = req1.GetResponse())
            {
                using (var ResponseStream = httpResponse.GetResponseStream())
                {
                    if (ResponseStream != null)
                    {
                        using (StreamReader sr = new StreamReader(ResponseStream))
                        {

                            string response = sr.ReadToEnd();                            
                            var doc = new HtmlAgilityPack.HtmlDocument();
                            doc.Load(ResponseStream);

                            foreach(HtmlNode node in doc.DocumentNode.SelectNodes("src"))//it's not working because the source does not contain the image
                            {
                                pictureBox1.ImageLocation = node.ToString();
                            }
                        }
                    }
                }
            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T22:45:02.243

可能发生的情况是页面已加载，然后触发 Javascript 事件并单独调用服务器以加载图像。延迟你的 HTTP 请求不会帮助你实现你想要的。

我会建议

1.  在 Google Chrome 中打开该页面，然后按 Ctr-Shift-J 调出开发者工具。
2.  单击网络选项卡。
3.  点击开发者工具底部的“图片”。
4.  单击网络选项卡。
5.  导航到包含您的图像的页面。您将在开发人员工具中看到对图像的请求。
6.  尝试找出在 Javascript 中创建该请求的位置。

如果您提供指向您正在谈论的页面的链接，我自己或其他人可能能够进一步澄清。

# c++ - 如何将事件处理程序添加到桌面窗口？

> ID：13435501
> 
> 赞同：3
> 
> 时间：2012-11-17T22:38:46.043
> 
> 标签：c++, windows, winapi, dialog, window

我正在尝试制作一个程序，该程序将使用鼠标下的颜色值更新另一个窗口文本输入。问题是我不知道我把这个检查放在哪里`WM_MOUSEMOVE`，因为我自己没有创建桌面窗口。

我尝试创建自己的 DialogBox 来显示值，但`WM_MOUSEMOVE`唯一的工作是在该 DialogBox 内，而不是在它之外。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T23:00:39.080

我不是这方面的专家，但根据我的阅读，您需要收听 WM_INPUT 消息。为了开始接收该消息，您的应用程序需要注册监听鼠标。

阅读： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms645543 (v=vs.85).aspx#_win32_Reading_Raw_Input](http://msdn.microsoft.com/en-us/library/windows/desktop/ms645543(v=vs.85).aspx#_win32_Reading_Raw_Input)

# .net - 如何防止由于应用程序终止而中止线程？

> ID：13435505
> 
> 赞同：-1
> 
> 时间：2012-11-17T22:38:56.457
> 
> 标签：.net, multithreading, timer

如果例程通过 a 定期运行`System.Threading.Timer`，可以做些什么来防止该例程由于主机应用程序的终止而中途中止？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:51:15.343

好吧，如果应用程序终止，您将无法做任何事情；但是，如果您打开非后台线程，则*可以*通过退出（关闭主窗口等）来防止*隐式应用程序终止。*`main`

您可以使计时器在该线程上运行，但是您不能使用 来执行此操作`System.Threading.Timer`，因为它在线程池线程（后台线程）上运行。例如，您可以在该线程上启动一个调度程序并运行一个`DispatcherTimer`（如果您使用的是 WPF）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T03:41:56.603

没有办法保证你的线程不会被异常终止。任何数量的事情都可能出错：意外的电源故障、用户使用任务管理器终止应用程序或程序中的错误导致线程崩溃只是三种可能性。

如果您正在进行多阶段数据库更新，如果被中断，会使您的数据库处于损坏或不一致的状态，那么您应该使用事务。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T14:15:47.983

此代码应导致主线程阻塞 10 秒，等待任何排队的计时器回调完成。这可以在宿主应用程序的出口点运行。

```
Dim waitHnd As WaitHandle = New AutoResetEvent(False)
Timer1.Dispose(waitHnd)
waitHnd.WaitOne(10000) 
```

# jquery - 绑定点击，除非滑块已经打开

> ID：13435507
> 
> 赞同：0
> 
> 时间：2012-11-17T22:39:05.217
> 
> 标签：jquery, function, click

在这个问题之前，我建议您访问该站点并尝试在篮子中添加一些东西，这样您就可以看到它的作用。

如果你去[这里](http://www.rubytuesdaycreative.co.uk/gracie.html)添加一些东西到篮子里，你会看到滑出标签显示你添加到篮子里。

这是通过绑定添加购物篮按钮的功能和点击 .trigger（一起滑出的手柄）的功能来生成的，这样点击“添加到购物篮”就可以模拟点击“触发”。

```
simpleCart.bind( "afterAdd" , function(){
    $('.trigger').click();
}); 
```

添加第二个项目时会出现此问题。因为篮子滑出已经处于“退出”状态，第二次点击“添加到篮子”时它再次调用该函数，这会在触发器上创建一个“点击”，这一次关闭篮子滑出.

我将如何实现一行代码来测试篮子滑出是否处于“退出”状态，然后不执行此功能......或者有更好的方法吗？

控制滑出的代码在这里：

```
 var settings = {
        objSlideTrigger: '.trigger',
        objSlidePanel: '.panel'
    } 
```

滑出功能是：[http ://www.rubytuesdaycreative.co.uk/js/slideout.js](http://www.rubytuesdaycreative.co.uk/js/slideout.js)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:49:25.037

```
simpleCart.bind( "afterAdd" , function() {
    var isHidden = !$('.panel').is('.out');
    if(isHidden) {
        $('.trigger').click();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:46:06.260

在滑出div的功能中，在滑出之前检查它是否隐藏。

```
if ($(div:hidden).length > 0) {
    //slide out div
} 
```

添加到当前代码添加：

```
$('.trigger').is(':hidden').click(); 
```

# c# - 使用html敏捷包从c#中的html中提取图像url并将它们写入xml文件

> ID：13435508
> 
> 赞同：5
> 
> 时间：2012-11-17T22:39:21.553
> 
> 标签：c#, html-agility-pack, xml

我是 c# 新手，我真的需要帮助解决以下问题。我希望从具有特定模式的网页中提取照片网址。例如，我希望提取所有具有以下模式 name_412s.jpg 的图像。我使用以下代码从 html 中提取图像，但我不知道如何适应它。

```
public void Images()
    {
        WebClient x = new WebClient();
        string source = x.DownloadString(@"http://www.google.com");

        HtmlAgilityPack.HtmlDocument document = new HtmlAgilityPack.HtmlDocument();
        document.Load(source);

        foreach(HtmlNode link in document.DocumentElement.SelectNodes("//img")
        {
          images[] = link["src"];
       }
} 
```

我还需要将结果写入 xml 文件。你也可以帮我吗？

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T23:42:20.183

要限制查询结果，您需要向 XPath 添加条件。例如，`//img[contains(@src, 'name_412s.jpg')]`将结果限制为仅`img`具有`src`包含该文件名的属性的元素。

至于将结果写入 XML，您需要创建一个新的 XML 文档，然后将匹配的元素复制到其中。由于您无法将 HtmlAgilityPack 节点直接导入 XmlDocument，因此您必须手动复制所有属性。例如：

```
using System.Net;
using System.Xml;

// ...

public void Images()
{
    WebClient x = new WebClient();
    string source = x.DownloadString(@"http://www.google.com");
    HtmlAgilityPack.HtmlDocument document = new HtmlAgilityPack.HtmlDocument();
    document.Load(source);
    XmlDocument output = new XmlDocument();
    XmlElement imgElements = output.CreateElement("ImgElements");
    output.AppendChild(imgElements);
    foreach(HtmlNode link in document.DocumentElement.SelectNodes("//img[contains(@src, '_412s.jpg')]")
    {
        XmlElement img = output.CreateElement(link.Name);
        foreach(HtmlAttribute a in link.Attributes)
        {
            img.SetAttribute(a.Name, a.Value)
        }
        imgElements.AppendChild(img);
    }
    output.Save(@"C:\test.xml");
} 
```

# node.js - 获取渲染名称jade

> ID：13435512
> 
> 赞同：1
> 
> 时间：2012-11-17T22:40:42.583
> 
> 标签：node.js, express, render, pug

我正在尝试在我的玉中使用渲染名称

我可以做：

```
app.render('email', { render: 'email' }, function(err, html){
  // ...
}); 
```

但我想知道是否有自动获取它的解决方案

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T02:45:24.350

我发现围绕渲染编写一个包含响应对象、视图名称和任何其他选项的包装函数很有帮助。然后我专门使用这个函数而不是`res.render`. 我的实现做了一些事情，比如自动装饰标题，为所有视图分配一个唯一的视图 ID，等等。我使用它像：

```
render(res, 'user.new', {title: 'sign up'}); 
```

在此示例中，该函数获取视图名称`'user.new'`并为其赋予唯一的 id：`'user_new_view'`分配给 body 元素。在您的情况下，您可以简单地将值传递给您的模板。

这种模式的好处是单个函数充当所有视图的接口（假设您始终使用它），因此如果您需要更改传递给视图的信息，您不必编辑您的视图中的每个端点应用。

# php - 使用正则表达式自动上标序数后缀

> ID：13435515
> 
> 赞同：0
> 
> 时间：2012-11-17T22:42:11.470
> 
> 标签：php, regex

我试过这样做，但我只是不喜欢正则表达式。我需要的是有一个正则表达式，将 1st、3rd 和 9th 替换为 1st、3rd 和 9th，^(方法)是^在任何前面有数字但不后面的 'rd' 'th' 和 'st' 周围^(添加)和`<sup>`包围`</sup>`通过字母或数字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T22:45:08.967

这是微不足道的，所以我只会给你你需要的组件。

`(?<=\d)`检查当前位置之前是否存在数字。

`(A|B|C)`检查当前位置的任何正则表达式 A、B 或 C。

这就是你所需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:51:26.497

试试这个代码：

```
$string = "bla 1st bla 2nd bla 3rd bla 5th 9thSomethingNotToBeReplaced ";
echo preg_replace('/(\d)+(st|nd|rd|th)([^\w\d]|$)/', '$1<sup>$2</sup>$3', $string); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T22:50:44.937

我假设你也想处理'2nd'：

```
$string = '1st, 2nd, 3rd and 9th';
echo preg_replace_callback('/1st|2nd|3rd|[4-9]th/', function($m){
    return $m[0]{0} . '<sup>' . substr($m[0], 1) . '</sup>';
  }, $string);

// 1<sup>st</sup>, 2<sup>nd</sup>, 3<sup>rd</sup> and 9<sup>th</sup> 
```

# java - KeyListener 中出现意外的 StackOverflowError

> ID：13435516
> 
> 赞同：2
> 
> 时间：2012-11-17T22:42:16.760
> 
> 标签：java, swing, keylistener, event-listener, stack-overflow

我正在编写一个程序，该程序可以将一组问题写入​​文件以供另一个程序读取。可能的答案输入到底部的 JTextFields 中。它有代码确保最后不会有超过一个空白 JTextField。当我输入答案时，它会在不同的点抛出 StackOverflowError。

堆栈跟踪：

```
Exception in thread "AWT-EventQueue-0" java.lang.StackOverflowError
    at java.awt.AWTEventMulticaster.keyPressed(AWTEventMulticaster.java:232)
    at java.awt.AWTEventMulticaster.keyPressed(AWTEventMulticaster.java:232)
    at java.awt.AWTEventMulticaster.keyPressed(AWTEventMulticaster.java:232)
    at java.awt.AWTEventMulticaster.keyPressed(AWTEventMulticaster.java:232) 
```

和代码：现在缩短了！！！

```
package writer;

import java.awt.BorderLayout;
import java.awt.GridLayout;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.util.ArrayList;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JSplitPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;

public class MyPanel extends JPanel implements KeyListener
{
    private MutableQuestion current;
    private WriterPanel writer;
    private JPanel top=new JPanel(new BorderLayout()),answerPanel=new JPanel(new GridLayout(0,1));
    private JSplitPane split;
    private JTextField title=new JTextField();
    private JTextArea question=new JTextArea();
    private ArrayList<JTextField> answers=new ArrayList<JTextField>();
    public MyPanel()
    {
    super(new BorderLayout());
        this.add(title,BorderLayout.PAGE_START);
        split=new JSplitPane(JSplitPane.VERTICAL_SPLIT,true,new JScrollPane(question),new JScrollPane(answerPanel));
    split.setDividerLocation(150);
    this.add(split,BorderLayout.CENTER);
    answers.add(new JTextField());
    answerPanel.add(answers.get(0));
    answers.get(0).addKeyListener(this);
}
private void back(){}
private void fitTitle(){}
private void fixAnswers()
{
    //System.out.println(answers);
    while(answers.get(answers.size()-1).getText().equals("")&&answers.size()>1&&answers.get(answers.size()-2).getText().equals(""))
        removeAnswer(answers.size()-1);
    if(!answers.get(answers.size()-1).getText().equals(""))
    {
        answers.add(new JTextField());
        answerPanel.add(answers.get(answers.size()-1));
        answers.get(answers.size()-2).removeKeyListener(this);
        //answers.get(answers.size()-1);
        answerPanel.revalidate();
    }
    answers.get(answers.size()-1).addKeyListener(this);
}
private void removeAnswer(int i){}
public void keyTyped(KeyEvent e) 
{
    fixAnswers();
}
public void keyPressed(KeyEvent e) {}
public void keyReleased(KeyEvent e) {}
public void newQuestion(){}
public void loadQuestion(int i){}
public void saveQuestion(){}
public void loadQuestion(MutableQuestion q){}
public static void main(String[] args)
{
    JFrame j=new JFrame();
    j.setSize(600,600);
    j.add(new MyPanel());
    j.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    j.setVisible(true);
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-14T01:19:33.113

每次键入一个键时，都会调用初始侦听器的 (this') keyTyped 方法，该方法调用 fixAnswers，最后一步，它会向您的 JTextField 添加另一个侦听器。您永远不会删除任何侦听器，因此最终您将拥有比 Java 堆栈可以处理的更长的字符串。

你只需要一个听众。不要继续添加它们，我怀疑你的问题会消失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T22:56:23.087

无限递归`AWTEventMulticaster`通常是由您在自身内部添加组件引起的。我无法从您粘贴的代码中看到这是如何发生的，但该错误可能在您代码的其他部分。

请参阅[是什么导致 AWTEventMulticaster.mouseEntered() 中的无限递归？](https://stackoverflow.com/questions/6090775/what-causes-an-endless-recursion-in-awteventmulticaster-mouseentered).

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-18T09:23:55.083

A piece of advice the next time you post a question: provide an [SSCCE](http://sscce.org). If we now wanted to run your code, we had to fix a bunch of compile errors due to missing classes and provide a main method ourself. The `WriterPanel` class seems to be completely unrelated to the error.

Further, strip down your code. You already came to the conclusion that the error was in the `fixAnswers` method. Then there is no need to provide us with code for the `top` panel and for the `question`. See below for a stripped down version which can reproduce the problem. Uncomment that one line to fix the error.

```
package writer;

import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTextField;
import javax.swing.WindowConstants;
import java.awt.BorderLayout;
import java.awt.EventQueue;
import java.awt.GridLayout;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.util.ArrayList;

public class SetPanel extends JPanel implements KeyListener {
  private JPanel answerPanel = new JPanel( new GridLayout( 0, 1 ) );
  private ArrayList<JTextField> answers = new ArrayList<JTextField>();

  public SetPanel(  ) {
    super( new BorderLayout() );
    this.add( new JScrollPane( answerPanel ), BorderLayout.CENTER );
    answers.add( new JTextField() );
    answerPanel.add( answers.get( 0 ) );
    answers.get( 0 ).addKeyListener( this );
  }

  private void fixAnswers() {
    while ( answers.get( answers.size() - 1 ).getText().equals( "" ) && answers.size() > 1 && answers.get( answers.size() - 2 ).getText().equals( "" ) )
      removeAnswer( answers.size() - 1 );
    if ( !answers.get( answers.size() - 1 ).getText().equals( "" ) ) {
      answers.add( new JTextField() );
      answerPanel.add( answers.get( answers.size() - 1 ) );
      answers.get( answers.size() - 2 ).removeKeyListener( this );
      answerPanel.revalidate();
    }
//    answers.get( answers.size() - 1 ).removeKeyListener( this );
    answers.get( answers.size() - 1 ).addKeyListener( this );
  }

  private void removeAnswer( int i ) {
    answers.remove( i );
    answerPanel.remove( i );
    answerPanel.revalidate();
  }

  @Override
  public void keyTyped( KeyEvent e ) {
  }

  @Override
  public void keyPressed( KeyEvent e ) {
    fixAnswers();
  }

  @Override
  public void keyReleased( KeyEvent e ) {

  }

  public static void main( String[] args ) {
    EventQueue.invokeLater(new Runnable() {
      @Override
      public void run() {
        JFrame testFrame = new JFrame( "TestFrame" );
        testFrame.add( new SetPanel() );
        testFrame.pack();
        testFrame.setDefaultCloseOperation( WindowConstants.EXIT_ON_CLOSE );
        testFrame.setVisible( true );
      }
    });
  }
} 
```

# c# - 绑定对象和取消按钮

> ID：13435517
> 
> 赞同：0
> 
> 时间：2012-11-17T22:42:23.430
> 
> 标签：c#, wpf, entity-framework, mvvm

我刚刚阅读了这个问题： [如何使用 MVVM 取消对对象的编辑？](https://stackoverflow.com/questions/1091036/wpf-mvvm-cancel-edit)

我有完全相同的问题，并希望有一个简单的解决方案。第一个看起来很有希望，但是，我正在使用实体框架并且我的类是自动生成的，所以这不是一个选项。

如何使用 EF 轻松做到这一点？

编辑：我的视图模型：

```
public List<Player> Players
{
    get { return repository.Players.OrderBy(x => x.Firstname).ToList(); }
}

public Player CurrentPlayer
{
    get { return currentPlayer;  }
    set
    {
        if (currentPlayer != value)
        {
            currentPlayer = value;
            RaisePropertyChanged("CurrentPlayer");
        }
    }
} 
```

Players 绑定到一个数据网格，CurrentPlayer 绑定到该选定项。在数据网格下方，我有文本框，用户可以在其中编辑玩家信息。

当用户按下保存按钮时，将执行以下代码：

```
private void SaveExecute(object parameter)
{
    repository.SavePlayer(currentPlayer);

    Editing = false;
} 
```

很容易。当用户按下取消按钮时，执行以下操作：

```
private void CancelExecute(object parameter)
{
    if (currentPlayer.Id == 0) // id = 0 when a new player is being added
    {
        CurrentPlayer = null;
    }
    else
    {
        // here, the CurrentPlayer should be set back to it's previous state.
    }

    Editing = false;
} 
```

CurrentPlayer 是 Player 的一个对象，是 EF 生成的实体类。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T04:14:25.520

我不明白这个问题。如果用户正在编辑一个新项目（`State == ObjectState.Added`），那么您将其丢弃，（并且可能将其设置`CurrentPlayer`为按下“新建”按钮之前的状态？），否则只需再次从数据库中检索实体，就是这样......

解决此问题的更好方法是让您的 CRUD 和您的列表 VM 具有单独的实体实例。

例如，当我创建一个列表视图（Datagrid 或其他）时，通常其中显示的数据只是完整 CRUD 视图中显示的整个数据的一个子集。因此，为了在 CRUD 中显示实体，我需要`Get()`再次使用必要的`Includes`. 这解决了整个取消问题，因为您正在修改的实体实例实际上与列表视图中显示的不同。如果用户按下保存，您可以将列表视图中显示的实例替换为已编辑的实例，如果用户按下取消，则不执行任何操作。

编辑：另外请注意，如果您的实体是由 T4 模板（例如实体框架 STE 模板）生成的，您可以修改 .tt 文件并对其进行自定义以生成您在实体中需要的任何代码。

# c# - XamDataChart 绘图颜色和标记选项

> ID：13435521
> 
> 赞同：0
> 
> 时间：2012-11-17T22:42:54.520
> 
> 标签：c#, wpf, colors, infragistics, marker

我正在使用 WPF 和 c# 测试来自 Infragistics 的最新 XamDataChart。有谁知道如何更改折线图上绘制的数据点之间的线条颜色？

我还想仅在某些绘制点上放置标记。我可以使用 MarkerType=”None” 打开和关闭整个系列的标记，但还没有找到一种方法来标记基于数据绑定到布尔值的某些数据点，该布尔值也可作为用于绘图的集合的一部分.

这似乎是相当基本的东西，但到目前为止我很茫然。

任何想法或建议将不胜感激。

* * *

我已经尝试了我能想到的一切来让它发挥作用，但没有任何乐趣。

在下面的代码中，我试图在不丢失问题本质的情况下尽可能地简化。它看起来相当简单，除了 MarkerType 数据绑定之外一切正常。我已将错误的类型从 bool 更改为 MarkerType。我在 AbcDataSources 集合中有大量 AbcData 对象。数据上下文设置在网格上。LineSeries 的数据正常，图表显示线条。

奇怪的是我已将所有错误属性设置为枚举 MarkerType.Circle 类型，并且在 Xaml 设计器中显示了圆圈。当程序运行时，它们不会。

其他信息：我正在使用 VS2012、.NET 4.5、Infragistics WPF 2012 V2

再次感谢任何有助于理解这一点的帮助。

```
public class AbcData : BindableBase
{
    private Single _dataValue;
    private MarkerType _error;

    public Single DataValue
    {
        get { return _dataValue; }
        set { SetProperty(ref _dataValue, value); }
    }

    public MarkerType Error
    {
        get { return _error; }
        set { SetProperty(ref _error, value); }
    }
}

public class AbcDataSource
{
    private readonly ObservableCollection<AbcData> _rawMDP = new ObservableCollection<AbcData>();

    public ObservableCollection<AbcData> RawMDP
    {
        get { return _rawMDP; }
    }
}

<Grid>
    <Grid.DataContext>
    <Data:AbcDataSource/>
    </Grid.DataContext>

    <Grid.RowDefinitions>
        <RowDefinition Height="*" />
        <RowDefinition Height="16" />
    </Grid.RowDefinitions>

    <ig:XamDataChart x:Name="RTChart" Grid.Row="0" HorizontalZoomable="True" WindowScaleHorizontal="0.25"
            WindowPositionHorizontal="1" HorizontalZoombarVisibility="Visible" VerticalZoomable="True"
            VerticalZoombarVisibility="Visible" PlotAreaBackground="Black" CrosshairVisibility="Visible" Background="Black">

        <ig:XamDataChart.Axes>
            <ig:NumericYAxis x:Name="YAxis" Interval="1" Label="{}{:n2}" >
                <ig:NumericYAxis.LabelSettings>
                    <ig:AxisLabelSettings Location="OutsideRight" Foreground="White" FontSize="10"
                            Extent="45" />
                </ig:NumericYAxis.LabelSettings>
            </ig:NumericYAxis>
            <ig:CategoryXAxis x:Name="XAxis" Label="{}{XDateTime:HH:mm}" ItemsSource="{Binding RawMDP}" >
                <ig:CategoryXAxis.LabelSettings>
                    <ig:AxisLabelSettings Foreground="White" FontSize="10" />
                </ig:CategoryXAxis.LabelSettings>
            </ig:CategoryXAxis>
        </ig:XamDataChart.Axes>

        <ig:XamDataChart.Series>

            <ig:LineSeries x:Name="DataValue"
                                MarkerType="{Binding RawMDP/Error}"
                                XAxis="{Binding ElementName=XAxis}"
                                YAxis="{Binding ElementName=YAxis}"
                                ItemsSource="{Binding Path=RawMDP}"
                                ValueMemberPath="DataValue" />

        </ig:XamDataChart.Series>

    </ig:XamDataChart>

</Grid> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T19:28:46.327

您可以通过指定自定义标记模板使标记的可见性取决于关联的数据。如果在系列的 MarkerTemplate 属性上设置 DataTemplate，则可以通过数据上下文中的“项目”引用基础项目上的值。例如，如果您想将椭圆的可见性绑定到底层数据项的可见性属性，它可能看起来像这样：

Visibility="{绑定项.Visibility}"

如果您的数据项上有一个名为 Visibility 类型的 Visibility 属性。

至于让线在点之间改变颜色，线系列专门设计为不做这样的事情，因为如果你想要一条也有几百万个点的多色线，它可能会产生可怕的后果。

但是，如果您只想做一些简单的事情，例如，将低于某个点的线的任何部分涂成红色，那么我的建议是将这部分数据分成一个单独的系列，使用“UnknownValuePlotting " 设置为 "DontPlot"。然后，如果您有任何高于阈值的值报告为 null 或 NaN，则当值超过该值时，您的线将具有不连续性，因此仅显示目标值以下的线部分。通过这种方式，您可以将一行拆分为您想要显示的不同颜色。

这里需要注意的是，如果您想要拥有 20 万条不同颜色的不同线段，您可能会遇到性能限制。

另一种选择是实现一个自定义系列（从系列继承），允许每个线段具有不同的颜色。

# osgi - Eclipse RCP 4 通过声明式服务使用包

> ID：13435524
> 
> 赞同：6
> 
> 时间：2012-11-17T22:43:35.647
> 
> 标签：osgi, eclipse-rcp, declarative-services

我已经编写了一个 OSGi 包以在我的 eclipse 4 rcp 应用程序中使用它。如果我添加依赖项，在我的激活器中注册这些服务并将其注入我的类中，则服务的使用工作正常。

在活化剂中

```
IUserService service = new TestUserService();
context.registerService(IUserService.class.getName(), service, null); 
```

在我的课上

```
@Inject
IUserService service;

service.getSth(); 
```

我读到通过声明性服务使用捆绑包应该是更好的方法。所以改变了我的实现。我在我的包中创建了一个组件定义来提供我的服务：

```
<?xml version="1.0" encoding="UTF-8"?>
<scr:component xmlns:scr="http://www.osgi.org/xmlns/scr/v1.1.0" name="usermanagement.test">
   <implementation class="usermanagement.test.TestUserService"/>
   <service>
      <provide interface="usermanagement.IUserService"/>
   </service>
</scr:component> 
```

然后我从我的激活器中删除了服务注册并创建了一个服务消费者类：

```
public class UserServiceConsumer {

    private IUserService service;

    public synchronized void setQuote(IUserService service) {
        this.service = service;
    }

    public synchronized void unsetQuote(IUserService service) {
        if (this.service == service) {
            this.service = null;
        }
    }

} 
```

和另一个组件定义：

```
<?xml version="1.0" encoding="UTF-8"?>
<scr:component xmlns:scr="http://www.osgi.org/xmlns/scr/v1.1.0" name="UserServiceConsumer">
   <implementation class="services.UserServiceConsumer"/>
   <reference bind="setService" cardinality="1..1" interface="usermanagement.IUserService" name="IUserService" policy="static" unbind="unsetService"/>
</scr:component> 
```

在这些修改之后，我的服务注入不再起作用。问题是注入的服务引用每次都是 NULL。

有谁知道为什么？我忘了什么吗？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T07:16:47.663

我可以建议一些你可以做的事情来调试。

1.  你真的在运行时实现了 scr 吗？SCR（声明式服务的另一个名称）不包含在 Equinox 核心中，因此您需要包含它。大多数人使用 Felix SCR 捆绑包 - 它会非常高兴地放在 Equinox 之上。

2.  由于声明式服务只使用服务，您可以一次更改一半的应用程序，以确定是服务消费还是注册不起作用。

3.  您还可以使用 Equinox 控制台检查您的服务注册。使用 'ss' 来标识您的捆绑包，然后使用 'bundle [no]' 来查看注册和使用的服务。如果您使用的是 Felix SCR，还有 Equinox 控制台扩展，因此您可以使用“scr list”查看捆绑包尝试注册的所有服务（及其状态），并使用“scr info”查看特定服务的更多详细信息服务。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T12:48:36.943

我找到了解决方案。

在我的服务的清单文件中，我添加了以下行：

```
Bundle-ActivationPolicy: lazy 
```

之后，我的应用程序中的 userServiceConsumer 和组件定义就不再需要了。

在视图类中，我现在可以执行以下操作：

```
public class MyPart {

    private IUserService uServ;

    @Inject
    public MyPart(IUserService uServ) {
        this.uServ = uServ;
        if (uServ != null)
            System.out.println("UserService available");
        else
            System.out.println("UserService == null");
    } 
```

通过 DI，我的服务被注入到视图的构造函数中。这对我行得通！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T08:25:32.540

我认为声明性服务在您的 UI 类中不起作用，因为它不是由 SCR 创建的，而是由 Eclipse 创建的。因此，您可以尝试保持 UI`@Inject`不变，仅更改提供服务的捆绑包以使用 DS。

基本上我什至不会尝试改变 UI 方面。符号的`@Inject`开销比声明式服务要少得多。

# java - 这个 Java 类型层次结构正确吗？

> ID：13435525
> 
> 赞同：3
> 
> 时间：2012-11-17T22:43:36.567
> 
> 标签：java, object, wildcard, subtyping

鉴于类型`List<?>`、`List<Object>`、`List<? super Number>`、`List<Number>`、`List<Integer>`和`List<? extends Number>`，我试图理解它们的层次结构。

我知道它`List<Integer>`不是 的子类型`List<Number>`，即使`Integer`它确实是 的子类型`Number`，所以我认为它是 的子类型`List<? extends Number>`。

但从`List<? extends Number>`直觉上看，它似乎是 的子类型，毕竟`List<Number>`它是`List<Integer>`的后代，正如我的想法所示：`List<Number>`

![在此处输入图像描述](../Images/9d0bae1548db9c1291a724884c763d41.png)

那么，如果一个类型是另一个类型的后代，但不是直接的，它是否仍然是其祖先的子类型（或者我在图中只是错了）？这个练习也让我对`?`vs.有点困惑`Object`......实际上，看起来我可能有`List<Object>`并且`List<? super Number>`混淆了。我想最大的问题之一是，“‘一切’都是`Object`……还是一切都是…… `?`？” 或者两者都有……或者两者都没有？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:04:20.417

为什么`List<Integer>`不是`List<Number>`.

让我们考虑一个`List<Number>`接受的场景`List<Integer>`（这实际上是行不通的）。

```
 List<Integer> listI =new ArrayList<Integer>();
  List<Double>  listD = new ArrayList<Double>();
  method(listI);
  method(listD); 
```

你有一个方法可以`List<Number>`作为参数。

```
 public void method(List<Number> list) {
    list.add(new Double()); // would fail if you pass an List<Integer> as Integer is not a super type of Integer.
    list.add(new Integer()); //would fail if you pass an List<Double> as Double is not a subtype of Integer       
    } 
```

因此，如果您的方法参数声明为`List<number>`接受`List<Double>`并且您尝试将**Integer**添加到**Double 列表中**，这是错误的，因为**Double**不是**Integer****的超类型**，因此不是子类型。**`List<Number>``List<Integer>`**

 **现在考虑相同的场景，其中`List<? extends Number>`是方法参数而不是`List<Number>`

```
 public void method(List<? extends Number> list) {
                      // list.add(new Double()); 
                      // list.add(new Integer());       
               } 
```

现在你将一个传递`List<Integer>`给这个方法。如果它接受它并且您尝试将一个添加`Double`到**Integers 列表中**。**BOOM** ...您刚刚在 Integer 列表中添加了**一个****Double**。

 **举个**非正式的例子**。考虑以**Cat**和**Dog**作为子类型的**Animal**超类型。现在，您有一个接受的方法，并将**Dog**传递给此方法。并在您尝试添加**Cat**的方法中。**它向您的Dog**添加了错误的类型（CAT），因此 不是 ****`<? extends Animal>`******`**List<Dog>**``List<? extends Animal>`**********

 ******如果这不够表达，请告诉我。谢谢:)**********

# php - Drupal 7 错误：无法创建文件

> ID：13435527
> 
> 赞同：7
> 
> 时间：2012-11-17T22:43:53.417
> 
> 标签：php, drupal-7

我将 drupal 7 从服务器（实时站点）移动到我的本地主机（xampp）。我更改`settings.php(files/defualt/settings.php)`数据库连接并从 mysql 数据库中删除缓存。现在在加载索引中，我看到我的网站没有 css 设计（只有文本）并看到这个错误：

```
**Error message**:
The file could not be created.
The file could not be created.
The file could not be created.
The file could not be created.
The file could not be created. 
```

我认为 drupal 不会创建 css/js 压缩文件。如何修复此错误？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-07T14:51:12.727

运行 MAMP 时

从这里找到答案：http: [//drupal.org/node/581558#comment-6202892](http://drupal.org/node/581558#comment-6202892)

前往：admin/config/media/file-system

将“/tmp/php”更改为“tmp/php”，问题就解决了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-18T07:50:16.367

与其他答案类似，这是我的文件系统设置的问题。我的实时站点中的 tmp 目录位于 public_html 文件夹之外的文件夹中。

*   所以我刚刚在我的目录结构中创建了一个新的 tmp 目录
*   去 admin/config/media/file-system 和
*   将 tmp 文件夹设置为指向该新的 tmp 文件夹。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T23:23:58.867

似乎是权限问题，清除drupal缓存后，需要在sites/default/files（或sites/yourdomain/files）中重新创建所有css和js文件，检查web用户是否有权在此目录中写入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-14T07:24:35.530

首先检查临时文件夹是否在您的站点/默认/文件目录中可用。

如果临时文件夹不可用，则创建该文件夹并授予对该文件夹的正确访问权限。

如果临时文件夹在那里已经可用，则检查该文件夹的权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-15T06:46:39.150

你需要给你的“临时目录”写权限。从管理员-> 配置-> 文件系统

[![在此处输入图像描述](../Images/67699e7cde129ef94ad3cc659c429c14.png)](https://i.stack.imgur.com/5IAzx.png)

# c++ - C++ 类中的成员变量对于该类的所有对象始终是常量？

> ID：13435528
> 
> 赞同：2
> 
> 时间：2012-11-17T22:44:20.763
> 
> 标签：c++

我正在构建一个类，其中我有三个成员变量，我希望它们始终是相同的值，无论什么。

我有

```
class foo{

public:
    double var_1, var_2, var_3;
    double x=1, y=2, z=3;

[functions go here]

}; 
```

这给了我一个错误，因为我无法初始化这样的变量。但我希望 x、y 和 z 始终分别为 1、2 和 3。我尝试在类之外定义它们，但这不起作用，因为我希望它们成为类的成员变量。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T22:46:00.570

将这些值设为类的静态值，这样所有对象都将继承这些相同的值。

```
static const int x = 1;
static const int y = 2;
static const int z = 3; 
```

从技术上讲，这并没有定义变量。如果静态数据成员是 const 整数或 const 枚举类型，则可以在静态数据成员的声明中指定常量初始值设定项。这个常量初始化器必须是一个整数常量表达式。请注意，常量初始值设定项不是定义。您仍然需要在封闭的命名空间中定义静态成员。

```
#include "foo.h"
#include <//libs....>
int foo::x;
int foo::y;
int foo::z;
//class functions down below 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T22:49:33.213

您还可以在构造函数中使用初始化列表来设置这些字段的初始值，就像任何其他成员一样：

```
class foo {
public:
    const double x;
    const double y;
    const double z;

    foo() : x(1), y(2), z(3) {
    }
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T22:50:10.077

您不必*使*它们成为静态的。你可以这样声明它们：

```
class foo{

public:
    double var_1, var_2, var_3;
    const double x=1.0;
    const double y=2.0;
    const double z=3.0;

[functions go here]

}; 
```

虽然如果它们是整数值，那么将它们声明为`int`s 会更好。

# css - CSS中的多个冒号

> ID：13435530
> 
> 赞同：2
> 
> 时间：2012-11-17T22:44:32.273
> 
> 标签：css

我在 CSS 中看到一行代码如下所示：

```
[icon]:not([focused]):not([pressed]):not([disabled]){ background-position-y:-0px;  } 
```

在这种情况下，多个冒号是什么意思？它们仍然是伪选择器吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T23:03:03.120

它不是伪选择器——它是伪类的选择器。引用[W3C Selectors Level 3 文档](http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#negation)：

> **6.6.7\. 否定伪类** 否定伪类`:not(X)`是一个以简单选择器（不包括否定伪类本身）作为参数的函数表示法。它表示其参数未表示的元素。[...]
> 
> 以下选择器匹配 HTML 文档中未禁用的所有按钮元素。
> 
> `button:not([DISABLED])`
> 
> 下面的选择器组代表除了链接之外的所有 HTML 元素。
> 
> `html|*:not(:link):not(:visited)`

最后一个示例（以及[此答案](https://stackoverflow.com/questions/5684160/multiple-not-selector)）表明`:not`，如果您想要为某些不是上述几种类型中*的任何一种的元素设置规则，则使用多个伪类选择器链是非常有效的。*

在您的情况下，选择器会捕获所有具有`icon`属性集（任何值）的元素 - 除了那些具有`focused`,`pressed`或`disabled`set （同样，任何值）的元素。

# ubuntu - ARM Ubuntu：如何在特权模式下运行代码？

> ID：13435532
> 
> 赞同：0
> 
> 时间：2012-11-17T22:44:45.207
> 
> 标签：ubuntu, arm, elevated-privileges

我有一台运行 Ubuntu (chrUbuntu 12.04) 的 ARM 三星 Chromebook。

在 ARM“特权”状态下运行某些代码的最简单方法是什么？我不是在寻找 sudo，而是在寻找 Supervisor、IRQ、FIQ 等的 ARM 处理器模式。在某个地方我可以探测/修改协处理器寄存器。

进入 priv 模式很容易：只需进行 SVC 调用。问题是，将我自己的一些代码插入操作系统以便在某个 SVC 调用上调用它的最简单方法是什么？

我不是 Linux 黑客。大多数情况下，我正在寻找关于最简单的总体方向的通用指针（重建内核？获取一些驱动程序源并挂钩修改后的驱动程序？一些简单的命令行选项来运行某些东西？），然后我会从那里开始。

* * *

如果我的上述方法没有意义并且有更简单的方法，我的总体目标是：

*   编写一些低级汇编程序
*   看看它们在 Cortex-A15 内核的各种硬件配置下的表现如何

提前致谢，

保罗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T00:14:46.593

如果不允许从用户区访问协处理器寄存器，最简单的方法是在内核启动序列中运行一些初始化代码，如 board-init 或编写内核模块来执行您想要的操作。看到这个[答案](https://stackoverflow.com/a/3250835/1163019)。另外，如果有兴趣，这个[问题](https://stackoverflow.com/q/12314072/1163019)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T19:36:00.617

对于你的问题的第二个版本：听起来你想要性能工具，而不是尝试实现你自己的性能测量：[https ://perf.wiki.kernel.org/index.php/Tutorial](https://perf.wiki.kernel.org/index.php/Tutorial)

另一种方法是通过实现一个可加载的内核模块。如果您创建一个模块，作为驱动程序或通过 /proc 或 /sys 访问的东西，该模块将在超级用户模式下执行。

# clojure - 在 Clojure 中读取无缓冲的键盘输入

> ID：13435541
> 
> 赞同：9
> 
> 时间：2012-11-17T22:45:10.543
> 
> 标签：clojure

如何从 Clojure 中的终端（不是 Swing）读取单个按键？

我尝试了一些东西，包括[各种](http://jline.sourceforge.net/) [版本](https://github.com/jline/jline2)的 JLine 库，但没有让它工作（见下面的例子）。

我很乐意接受一个工作的、仅适用于 Unix 的（Mac、Linux、...）示例。理想情况下，我想知道如何关闭标准输入和标准输出的缓冲。

这是接近的东西：

```
;; project.clj dependencies:
;; [[org.clojure/clojure "1.4.0"]
;;  [jline/jline "2.8"]])

(ns slosh.core
  (:import [jline.console ConsoleReader])
  (:gen-class))    

(defn -main []
  (println "start")
  (let [cr (ConsoleReader.)]
    (.readCharacter cr)
    (println "done"))) 
```

这将打印“开始”，但不响应除 control-C 之外的任何输入。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T02:54:49.897

我不确定你是如何运行它的，但如果你使用`lein run`，你会遇到问题。尝试使用`lein trampoline run`.

我会[在 java/clojure 中链接单字符控制台输入，](https://stackoverflow.com/questions/3225025/single-character-console-input-in-java-clojure) 但我似乎没有足够的 Internet 点来做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T19:17:08.293

也许也看看[clojure-lanterna](https://clojars.org/clojure-lanterna)。

# html - 优化流体网格布局

> ID：13435542
> 
> 赞同：0
> 
> 时间：2012-11-17T22:45:10.713
> 
> 标签：html, css, grid, responsive-design

我最近刚刚添加了一个网格布局，但我不知道如何使我的链接工作。我使用的网格是[http://cssgrid.net/](http://cssgrid.net/)上的 1140 网格。我研究了那个网站的源代码，并试图让我的页面像他们的一样，但是当我把所有的东西都放进去时，我的情况变得更糟了，甚至网格都不起作用。这就是我的网站应该看起来的样子[http://spencedesign.netau.net/singaporehome.html](http://spencedesign.netau.net/singaporehome.html) 这就是它 的样子[http://spencedesign.netau.net/home.html](http://spencedesign.netau.net/home.html) 当你缩小尺寸时，它看起来不像它应该的那样。当您最小化它时，我希望图片（链接）每行两个，然后每行一个，具体取决于页面的大小。当报价太小时，我还希望报价变成不同的行。但我不知道如何让页面看起来正常，更不用说用较小的浏览器让它看起来不错了。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:56:28.357

[http://goldengridsystem.com/](http://goldengridsystem.com/)可能有你要找的东西。折叠效果对我有用。

# php - 如何在处理中将 PImage 转换为 Byte []

> ID：13435546
> 
> 赞同：0
> 
> 时间：2012-11-17T22:45:38.340
> 
> 标签：php, web, save, processing

有没有办法将 PImage 变量转换为字节数组？我需要这样做以将数组发送到 PHP 脚本并上传文件。我已经看到了将文件保存到网络：[http](http://wiki.processing.org/w/Saving_files_to_a_web_server) ://wiki.processing.org/w/Saving_files_to_a_web_server 但是有一些处理说不存在的功能：bufferImage()

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T15:47:07.603

Processing.org 用户[PhilHo](https://forum.processing.org/user/philho)发布了这段代码，它应该可以工作：要访问 PImage 的 int 数组，您只需调用`myPimage.loadPixels(); int[] data = myPImage.pixels[];`

```
 import java.nio.*;

 void setup()
 {

   int[] data = { 100, 200, 300, 400 };

   ByteBuffer byteBuffer = ByteBuffer.allocate(data.length * 4);       
   IntBuffer intBuffer = byteBuffer.asIntBuffer();
   intBuffer.put(data);

   byte[] array = byteBuffer.array();

   println(array);

 } 
```

# java - 构造函数在自定义 ArrayAdapter 中未定义

> ID：13435555
> 
> 赞同：0
> 
> 时间：2012-11-17T22:46:54.890
> 
> 标签：java, android, constructor, android-arrayadapter

我知道这已经解决了一百万次，是的，我已经搜索过了，但它对我不起作用。

问题是方法**super**不需要正确的参数。

编码：

```
public class QuotesArrayAdapter extends ArrayAdapter<Map<Integer,List<String>>> {
private Context context;
Map<Integer,List<String>> Values;
static int textViewResId;
Logger Logger;

public QuotesArrayAdapter(Context context, int textViewResourceId, Map<Integer,List<String>> object) {
    super(context, textViewResourceId, object);   //<---- ERROR HERE
    this.context = context;
    this.Values = object;
    Logger = new Logger(true);
    Logger.l(Logger.TAG_DBG, "ArrayAdapter Inited");
} 
```

什么 Eclipse 说：

```
Multiple markers at this line
- The constructor ArrayAdapter<Map<Integer,List<String>>>(Context, int, Map<Integer,List<String>>) 
 is undefined
- The constructor ArrayAdapter<Map<Integer,List<String>>>(Context, int, Map<Integer,List<String>>) 
 is undefined 
```

它想要**super(Context, int)**而这不是我想要的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T22:49:24.273

查看可用于[`ArrayAdapter`](http://developer.android.com/reference/android/widget/ArrayAdapter.html).

```
ArrayAdapter(Context context, int textViewResourceId)
ArrayAdapter(Context context, int resource, int textViewResourceId)
ArrayAdapter(Context context, int textViewResourceId, T[] objects)
ArrayAdapter(Context context, int resource, int textViewResourceId, T[] objects)
ArrayAdapter(Context context, int textViewResourceId, List<T> objects)
ArrayAdapter(Context context, int resource, int textViewResourceId, List<T> objects) 
```

*这些都不*符合你的论点。

你打算调用哪一个？您的`T`here is `Map<Integer,List<String>>`，但您的构造函数的`object`参数正是该类型。如果您想使用需要*集合*的构造函数之一，则需要从您拥有的单个对象构建该集合。

最简单的方法可能只是使用：

```
public QuotesArrayAdapter(Context context, int textViewResourceId,
                          Map<Integer,List<String>> object) {
    super(context, textViewResourceId);
    add(object);
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T22:50:20.297

[很简单，在ArrayAdapter](http://developer.android.com/reference/android/widget/ArrayAdapter.html)中没有构造函数接受 Map ...

您需要将其转换为列表或原始数组，如果这些选项都不起作用，那么您将不得不扩展[BaseAdapter](http://developer.android.com/reference/android/widget/BaseAdapter.html)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T22:58:34.563

此外，您可以使用`Arrays.asList(..)`

```
public QuotesArrayAdapter(Context context, int textViewResourceId, Map<Integer,List<String>> object) {
    super(context, textViewResourceId,  Arrays.asList(object));   
.... 
```

# python - 什么会导致python中的内存泄漏？

> ID：13435558
> 
> 赞同：7
> 
> 时间：2012-11-17T22:47:25.900
> 
> 标签：python, garbage-collection

> **可能重复：**
> [Python：由于您的代码，Python 中是否可能存在实际的内存泄漏？](https://stackoverflow.com/questions/2017381/python-is-it-possible-to-have-an-actual-memory-leak-in-python-because-of-your-c)

由于python垃圾收集器处理循环引用的检测（对象A引用对象B和对象B引用对象A），我想知道什么可能导致python代码中的内存泄漏？您能否提供具体的代码示例，这些代码会创建垃圾收集器无法处理的不可访问的内存区域，或者这样的事情是不可能的？

任何例子表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T22:52:50.523

您可以使用 [gc — 垃圾收集器接口](https://docs.python.org/2/library/gc.html)模块，

> ### [`gc.garbage`](http://docs.python.org/2/library/gc.html#gc.garbage)：
> 
> **收集器发现无法访问**但无法释放的对象列表（无法收集的对象）。默认情况下，此列表仅包含具有`__del__()`方法的对象。[[1]](https://docs.python.org/2/library/gc.html#id2) 具有`__del__()`方法并且是引用循环一部分的对象会导致整个引用循环无法收集，包括不一定在循环中但只能从循环中访问的对象。Python 不会自动收集此类循环，因为通常 Python 无法猜测运行循环的安全顺序 `__del__()`方法。如果您知道安全顺序，则可以通过检查垃圾列表来强制执行该问题，并由于列表中的对象而显式中断循环。请注意，由于位于垃圾列表中，这些对象仍然保持活动状态，因此它们也应该从垃圾中删除。例如，在中断循环后，`del` `gc.garbage[:]`清空列表。通常最好通过不创建包含带有`__del__()`. 方法，并且在这种情况下可以检查垃圾以验证没有创建这样的循环。

# java - Android，立即模糊位图？

> ID：13435561
> 
> 赞同：9
> 
> 时间：2012-11-17T22:48:14.227
> 
> 标签：java, android, algorithm, bitmap, blur

所以我试图尽可能快地模糊图像（即时感觉），因为当我按下模糊按钮时需要更新活动。

我遇到的问题是，我找不到足够快的模糊效果...... **注意：模糊，最好是高斯模糊，根本不需要是最好的质量......**

我尝试了以下内容，但需要几秒钟，无论如何，这段代码是否可以在牺牲质量的情况下更快地运行？或者还有其他选择吗？我会研究 GPU 的东西，但这种模糊实际上只是与 UI 相关的一种效果，只有当我按下打开一个大小为小盒子的透明活动时才会发生......

有任何想法吗？

```
static Bitmap fastblur(Bitmap sentBitmap, int radius, int fromX, int fromY,
    int width, int height) {

// Stack Blur v1.0 from
// http://www.quasimondo.com/StackBlurForCanvas/StackBlurDemo.html
//
// Java Author: Mario Klingemann <mario at quasimondo.com>
// http://incubator.quasimondo.com
// created Feburary 29, 2004
// Android port : Yahel Bouaziz <yahel at kayenko.com>
// http://www.kayenko.com
// ported april 5th, 2012

// This is a compromise between Gaussian Blur and Box blur
// It creates much better looking blurs than Box Blur, but is
// 7x faster than my Gaussian Blur implementation.
//
// I called it Stack Blur because this describes best how this
// filter works internally: it creates a kind of moving stack
// of colors whilst scanning through the image. Thereby it
// just has to add one new block of color to the right side
// of the stack and remove the leftmost color. The remaining
// colors on the topmost layer of the stack are either added on
// or reduced by one, depending on if they are on the right or
// on the left side of the stack.
//
// If you are using this algorithm in your code please add
// the following line:
//
// Stack Blur Algorithm by Mario Klingemann <mario@quasimondo.com>

Bitmap bitmap = sentBitmap.copy(sentBitmap.getConfig(), true);

if (radius < 1) {
    return (null);
}

int w = width;
int h = height;

int[] pix = new int[w * h];

bitmap.getPixels(pix, 0, w, fromX, fromY, w, h);

int wm = w - 1;
int hm = h - 1;
int wh = w * h;
int div = radius + radius + 1;

int r[] = new int[wh];
int g[] = new int[wh];
int b[] = new int[wh];
int rsum, gsum, bsum, x, y, i, p, yp, yi, yw;
int vmin[] = new int[Math.max(w, h)];

int divsum = (div + 1) >> 1;
divsum *= divsum;
int dv[] = new int[256 * divsum];
for (i = 0; i < 256 * divsum; i++) {
    dv[i] = (i / divsum);
}

yw = yi = 0;

int[][] stack = new int[div][3];
int stackpointer;
int stackstart;
int[] sir;
int rbs;
int r1 = radius + 1;
int routsum, goutsum, boutsum;
int rinsum, ginsum, binsum;

int originRadius = radius;
for (y = 0; y < h; y++) {
    rinsum = ginsum = binsum = routsum = goutsum = boutsum = rsum = gsum = bsum = 0;
    for (i = -radius; i <= radius; i++) {
        p = pix[yi + Math.min(wm, Math.max(i, 0))];
        sir = stack[i + radius];
        sir[0] = (p & 0xff0000) >> 16;
        sir[1] = (p & 0x00ff00) >> 8;
        sir[2] = (p & 0x0000ff);
        rbs = r1 - Math.abs(i);
        rsum += sir[0] * rbs;
        gsum += sir[1] * rbs;
        bsum += sir[2] * rbs;
        if (i > 0) {
            rinsum += sir[0];
            ginsum += sir[1];
            binsum += sir[2];
        } else {
            routsum += sir[0];
            goutsum += sir[1];
            boutsum += sir[2];
        }
    }
    stackpointer = radius;

    for (x = 0; x < w; x++) {

        r[yi] = dv[rsum];
        g[yi] = dv[gsum];
        b[yi] = dv[bsum];

        rsum -= routsum;
        gsum -= goutsum;
        bsum -= boutsum;

        stackstart = stackpointer - radius + div;
        sir = stack[stackstart % div];

        routsum -= sir[0];
        goutsum -= sir[1];
        boutsum -= sir[2];

        if (y == 0) {
            vmin[x] = Math.min(x + radius + 1, wm);
        }
        p = pix[yw + vmin[x]];

        sir[0] = (p & 0xff0000) >> 16;
        sir[1] = (p & 0x00ff00) >> 8;
        sir[2] = (p & 0x0000ff);

        rinsum += sir[0];
        ginsum += sir[1];
        binsum += sir[2];

        rsum += rinsum;
        gsum += ginsum;
        bsum += binsum;

        stackpointer = (stackpointer + 1) % div;
        sir = stack[(stackpointer) % div];

        routsum += sir[0];
        goutsum += sir[1];
        boutsum += sir[2];

        rinsum -= sir[0];
        ginsum -= sir[1];
        binsum -= sir[2];

        yi++;
    }
    yw += w;
}

radius = originRadius;

for (x = 0; x < w; x++) {
    rinsum = ginsum = binsum = routsum = goutsum = boutsum = rsum = gsum = bsum = 0;
    yp = -radius * w;
    for (i = -radius; i <= radius; i++) {
        yi = Math.max(0, yp) + x;

        sir = stack[i + radius];

        sir[0] = r[yi];
        sir[1] = g[yi];
        sir[2] = b[yi];

        rbs = r1 - Math.abs(i);

        rsum += r[yi] * rbs;
        gsum += g[yi] * rbs;
        bsum += b[yi] * rbs;

        if (i > 0) {
            rinsum += sir[0];
            ginsum += sir[1];
            binsum += sir[2];
        } else {
            routsum += sir[0];
            goutsum += sir[1];
            boutsum += sir[2];
        }

        if (i < hm) {
            yp += w;
        }
    }
    yi = x;
    stackpointer = radius;
    for (y = 0; y < h; y++) {
        pix[yi] = 0xff000000 | (dv[rsum] << 16) | (dv[gsum] << 8)
                | dv[bsum];

        rsum -= routsum;
        gsum -= goutsum;
        bsum -= boutsum;

        stackstart = stackpointer - radius + div;
        sir = stack[stackstart % div];

        routsum -= sir[0];
        goutsum -= sir[1];
        boutsum -= sir[2];

        if (x == 0) {
            vmin[y] = Math.min(y + r1, hm) * w;
        }
        p = x + vmin[y];

        sir[0] = r[p];
        sir[1] = g[p];
        sir[2] = b[p];

        rinsum += sir[0];
        ginsum += sir[1];
        binsum += sir[2];

        rsum += rinsum;
        gsum += ginsum;
        bsum += binsum;

        stackpointer = (stackpointer + 1) % div;
        sir = stack[stackpointer];

        routsum += sir[0];
        goutsum += sir[1];
        boutsum += sir[2];

        rinsum -= sir[0];
        ginsum -= sir[1];
        binsum -= sir[2];

        yi += w;
    }
}

bitmap.setPixels(pix, 0, w, fromX, fromY, w, h);

return (bitmap); 
```

}

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-17T23:03:01.543

尝试将图像缩小 2、4、8... 倍，然后再次放大。那很快。否则在渲染脚本中实现它。

如果你想要的不仅仅是缩放，你可以在 renderscript 中查看这个代码片段。它与另一个答案中给出的模糊相同。相同的算法可以在 Java 中实现，并且是对另一个答案的优化。这段代码模糊了一行。要模糊位图，您应该对所有行调用它，然后对所有列调用它（您需要重新实现它来处理列）。要快速模糊，只需执行一次。如果你想要一个更好看的模糊做几次。我通常只做两次。

做一行的原因是我试图并行化算法，这给出了一些改进并且在renderscript中非常简单。我为所有行并行调用了以下代码，然后对所有列都调用了相同的代码。

```
int W = 8;
uchar4 *in;
uchar4 *out;    

int N;
float invN;    

uint32_t nx;
uint32_t ny;    

void init_calc() {
  N = 2*W+1;
  invN = 1.0f/N;    

  nx = rsAllocationGetDimX(rsGetAllocation(in));
  ny = rsAllocationGetDimY(rsGetAllocation(in));
}    

void root(const ushort *v_in) {
  float4 sum = 0;    

  uchar4 *head = in + *v_in * nx;
  uchar4 *tail = head;
  uchar4 *p = out + *v_in * nx;    

  uchar4 *hpw = head + W;
  uchar4 *hpn = head + N;
  uchar4 *hpx = head + nx;
  uchar4 *hpxmw = head + nx - W - 1;    

  while (head < hpw) {
      sum += rsUnpackColor8888(*head++);
  }    

  while (head < hpn) {
      sum += rsUnpackColor8888(*head++);
      *p++ = rsPackColorTo8888(sum*invN);
  }    

  while (head < hpx) {
    sum += rsUnpackColor8888(*head++);
    sum -= rsUnpackColor8888(*tail++);
    *p++ = rsPackColorTo8888(sum*invN);
  }    

  while (tail < hpxmw) {
      sum -= rsUnpackColor8888(*tail++);
      *p++ = rsPackColorTo8888(sum*invN);
  }
} 
```

这是垂直模糊：

```
int W = 8;
uchar4 *in;
uchar4 *out;    

int N;
float invN;    

uint32_t nx;
uint32_t ny;    

void init_calc() {
  N = 2*W+1;
  invN = 1.0f/N;    

  nx = rsAllocationGetDimX(rsGetAllocation(in));
  ny = rsAllocationGetDimY(rsGetAllocation(in));
}    

void root(const ushort *v_in) {
  float4 sum = 0;    

  uchar4 *head = in + *v_in;
  uchar4 *tail = head;
  uchar4 *hpw = head + nx*W;
  uchar4 *hpn = head + nx*N;
  uchar4 *hpy = head + nx*ny;
  uchar4 *hpymw = head + nx*(ny-W-1);    

  uchar4 *p = out + *v_in;    

  while (head < hpw) {
      sum += rsUnpackColor8888(*head);
      head += nx;
  }    

  while (head < hpn) {
      sum += rsUnpackColor8888(*head);
      *p = rsPackColorTo8888(sum*invN);
      head += nx;
      p += nx;
  }    

  while (head < hpy) {
      sum += rsUnpackColor8888(*head);
      sum -= rsUnpackColor8888(*tail);
      *p = rsPackColorTo8888(sum*invN);
      head += nx;
      tail += nx;
      p += nx;
  }    

  while (tail < hpymw) {
      sum -= rsUnpackColor8888(*tail);
      *p = rsPackColorTo8888(sum*invN);
      tail += nx;
      p += nx;
  }
} 
```

这是调用 rs 代码的 Java 代码：

```
private RenderScript mRS;
private ScriptC_horzblur mHorizontalScript;
private ScriptC_vertblur mVerticalScript;
private ScriptC_blur mBlurScript;

private Allocation alloc1;
private Allocation alloc2;

private void hblur(int radius, Allocation index, Allocation in, Allocation out) {
    mHorizontalScript.set_W(radius);
    mHorizontalScript.bind_in(in);
    mHorizontalScript.bind_out(out);
    mHorizontalScript.invoke_init_calc();
    mHorizontalScript.forEach_root(index);
}

private void vblur(int radius, Allocation index, Allocation in, Allocation out) {
    mHorizontalScript.set_W(radius);
    mVerticalScript.bind_in(in);
    mVerticalScript.bind_out(out);
    mVerticalScript.invoke_init_calc();
    mVerticalScript.forEach_root(index);
}

Bitmap blur(Bitmap org, int radius) {
    Bitmap out = Bitmap.createBitmap(org.getWidth(), org.getHeight(), org.getConfig());

    blur(org, out, radius);

    return out;
}

private Allocation createIndex(int size) {
    Element element = Element.U16(mRS);
    Allocation allocation = Allocation.createSized(mRS, element, size);
    short[] rows = new short[size];
    for (int i = 0; i < rows.length; i++) rows[i] = (short)i;
    allocation.copyFrom(rows);

    return allocation;
}

private void blur(Bitmap src, Bitmap dst, int r) {
    Allocation alloc1 = Allocation.createFromBitmap(mRS, src);
    Allocation alloc2 = Allocation.createTyped(mRS, alloc1.getType());

    Allocation hIndexAllocation = createIndex(alloc1.getType().getY());
    Allocation vIndexAllocation = createIndex(alloc1.getType().getX());

    // Iteration 1
    hblur(r, hIndexAllocation, alloc1, alloc2);
    vblur(r, vIndexAllocation, alloc2, alloc1);
    // Iteration 2
    hblur(r, hIndexAllocation, alloc1, alloc2);
    vblur(r, vIndexAllocation, alloc2, alloc1);
    // Add more iterations if you like or simply make a loop
    alloc1.copyTo(dst);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-18T01:50:49.487

高斯模糊的精确度很高。只需迭代地平均像素，就可以完成更快的近似。大量模糊图像仍然很昂贵，但是您可以在每次迭代之间重新绘制，以至少提供即时反馈和图像模糊的漂亮动画。

```
static void blurfast(Bitmap bmp, int radius) {
  int w = bmp.getWidth();
  int h = bmp.getHeight();
  int[] pix = new int[w * h];
  bmp.getPixels(pix, 0, w, 0, 0, w, h);

  for(int r = radius; r >= 1; r /= 2) {
    for(int i = r; i < h - r; i++) {
      for(int j = r; j < w - r; j++) {
        int tl = pix[(i - r) * w + j - r];
        int tr = pix[(i - r) * w + j + r];
        int tc = pix[(i - r) * w + j];
        int bl = pix[(i + r) * w + j - r];
        int br = pix[(i + r) * w + j + r];
        int bc = pix[(i + r) * w + j];
        int cl = pix[i * w + j - r];
        int cr = pix[i * w + j + r];

        pix[(i * w) + j] = 0xFF000000 |
            (((tl & 0xFF) + (tr & 0xFF) + (tc & 0xFF) + (bl & 0xFF) + (br & 0xFF) + (bc & 0xFF) + (cl & 0xFF) + (cr & 0xFF)) >> 3) & 0xFF |
            (((tl & 0xFF00) + (tr & 0xFF00) + (tc & 0xFF00) + (bl & 0xFF00) + (br & 0xFF00) + (bc & 0xFF00) + (cl & 0xFF00) + (cr & 0xFF00)) >> 3) & 0xFF00 |
            (((tl & 0xFF0000) + (tr & 0xFF0000) + (tc & 0xFF0000) + (bl & 0xFF0000) + (br & 0xFF0000) + (bc & 0xFF0000) + (cl & 0xFF0000) + (cr & 0xFF0000)) >> 3) & 0xFF0000;
      }
    }
  }
  bmp.setPixels(pix, 0, w, 0, 0, w, h);
} 
```

# java - 如何使用 Ant 执行 JUnit 测试的子集？

> ID：13435563
> 
> 赞同：0
> 
> 时间：2012-11-17T22:48:34.243
> 
> 标签：java, ant, junit

我们有一个大型项目，执行所有单元测试需要很多时间。我们也在使用 Ant。哪些策略可用于仅使用 Ant 执行我们的一部分测试？我们在逻辑 Java 包组中进行了测试，所以这可能会有所帮助......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:57:13.420

您应该使用`batchtest`junit ant 任务的标签。在这里检查：http: [//ant.apache.org/manual/Tasks/junit.html](http://ant.apache.org/manual/Tasks/junit.html)

下面给出了该链接的简化示例：

```
<junit printsummary="yes" haltonfailure="yes">
  <classpath>
    <pathelement location="${build.tests}"/>
    <pathelement path="${java.class.path}"/>
  </classpath>

  <formatter type="plain"/>

  <batchtest fork="yes" todir="${reports.tests}">
    <fileset dir="${src.tests}">
      <include name="**/*Test*.java"/>
      <exclude name="**/AllTests.java"/>
    </fileset>
  </batchtest>
</junit> 
```

# php - PHP jQuery 长轮询聊天应用程序

> ID：13435565
> 
> 赞同：2
> 
> 时间：2012-11-17T22:48:50.673
> 
> 标签：php, javascript, jquery, ajax, long-polling

我用短轮询（AJAX 刷新）制作了一个简单的 PHP jQuery 聊天应用程序。就像，每 2 - 3 秒它会询问新消息。但是，我读到长轮询对于聊天应用程序来说是一种更好的方法。所以，我浏览了一些长轮询脚本。我做了这样的：

## Javascript：

```
$("#submit").click(function(){
    $.ajax({
        url: 'chat-handler.php',
        dataType: 'json',
        data: {action : 'read', message : 'message'}
    });
});

var getNewMessage = function() {
    $.ajax({
        url: 'chat-handler.php',
        dataType: 'json',
        data: {action : 'read', message : 'message'},
        function(data){
            alert(data);
        }
    });

    getNewMessage();
}

$(document).ready(getNewMessage); 
```

## PHP

```
<?php
    $time = time();
    while ((time() - $time) < 25) {
        $data = $db->getNewMessage ();

        if (!empty ($data)) {
            echo json_encode ($data);
            break;
        }

        usleep(1000000); // 1 Second
    }
?> 
```

问题是，一旦`getNewMessage()`启动，它就会执行，除非它得到一些响应（来自 chat-handler.php）。它递归执行。但是，如果有人想在两者之间发送消息，那么实际上该函数`($("#submit").click())`永远不会像`getNewMessage()`仍在执行中那样执行。那么有什么解决方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T22:55:48.290

我强烈建议您阅读两件事：长轮询背后的想法和 jQuery 回调。我将快速介绍两者，但仅在此框允许的范围内详细介绍。

**长轮询**

长轮询背后的想法是让网络服务器在返回请求时人为地“减慢”速度，以便它等待直到事件出现，然后立即提供信息并关闭连接。这意味着您的服务器将闲置一段时间（好吧，不是闲置，但您知道我的意思），直到它最终获得消息通过的信息，将其发送回客户端，然后继续下一个一。

在 JS 客户端，效果是延迟了 Ajax**回调**（这是重要的一点）。

**jQuery .ajax()**

`$.ajax()`立即返回。情况不妙。您有两种选择来解决这个问题：

*   在成功和错误回调函数中绑定您的递归调用（这很重要。错误函数很可能由于超时而出现）
*   （见下文）：

用这个：

```
var x = $.ajax({blah});
$.when(x).done(function(a) { recursiveCallHere(); }); 
```

两者最终都等同于同一件事。您在回调而不是在启动时触发递归。

PS：怎么了`sleep(1)`？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-17T22:53:59.397

在长轮询中，当您收到前一个请求的数据时，应该启动新请求。否则，您将在浏览器冻结中无限递归。

```
var getNewMessage = function() {
    $.ajax({
        url: 'chat-handler.php',
        dataType: 'json',
        data: {action : 'read', message : 'message'},
        success: function(data) {
            alert(data);

            getNewMessage();   // <-- should be here
        }
    });
} 
```

# regex - MATLAB中的正则表达式奇怪

> ID：13435566
> 
> 赞同：-1
> 
> 时间：2012-11-17T22:49:03.070
> 
> 标签：regex, matlab

我想使用正则表达式来挑选以 . 结尾的文件名`_x.txt`。我以为我可以使用正则表达式`*_x.txt`，但 MATLAB 是顽固的。

```
>> regexp( 'asdfg_x.txt', '*_x.txt' )
ans =
     []
>> regexp( 'asdfg_x.txt', '_x.txt' )
ans =
     6 
```

为什么'*_x.txt'不起作用？我意识到这不是我想要完成的最佳正则表达式，但它*应该可以*工作。我知道我已经在 Linux 中完成了这项工作，并且成功了。我目前正在使用 Windows 7、MATLAB 2009b。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:54:35.557

您需要在星号前加上句点以使其匹配：

```
regexp( 'asdfg_x.txt', '.*_x.txt' ) 
```

用 Octave 3.2.4 确认

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:14:22.290

是正则表达式中的`*`一个[特殊字符，一个量词](http://www.regular-expressions.info/repeat.html)。此字符使前面的字符/组匹配 0 次或多次。所以这个量词需要重复一些东西，但在你的表达中什么都没有。

我认为您的意思是`regexp( 'asdfg_x.txt', '.*_x.txt' )`，其中[是`.`另一个正则表达式特殊字符](http://www.regular-expressions.info/dot.html)，匹配除换行符以外的每个字符。所以`.*`会匹配一系列任意字符。

# game-engine - 如何在平面上获得 3D 点（表示为法线并从原点偏移）？

> ID：13435579
> 
> 赞同：1
> 
> 时间：2012-11-17T22:50:32.057
> 
> 标签：game-engine, computational-geometry, game-physics, raytracing

如果我知道射线和平面上的一个点以及平面法线，我知道如何获得射线和平面之间的交点。

在我使用的代码中，平面表示为与原点的有符号偏移量，并且是正常的，我需要得到一些平面上的任何点。这该怎么做？

所以，平面方程：Ax + By + Cz + D = 0，我知道 A、B 和 C，这基本上是平面的法线，我知道 D，它是到原点的有符号距离。我的问题是，鉴于我如何在飞机上获得一些 3D 点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T09:40:26.630

如果 (A, B, C) 是归一化向量，则平面上最接近原始点的点就是：

（-AD，-BD，-CD）

从您的描述中可以很容易地知道（A，B，C）是平面法线，D是平面与原点之间的距离。

这种方法很简单，不需要任何分支。

[平面上最靠近原点的点](http://en.wikipedia.org/wiki/Point_on_plane_closest_to_origin)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T08:07:36.030

您可以通过将平面与射线（线）相交来获得一个平面点 :-)

选择一些点`P=(x,y,z)`，计算一下`w=Ax+By+Cz`。

如果`w=-D`比`P`在飞机上。

对于`w!=-D`，选择某个方向`Q=(dx,dy,dz)`，`l=Adx+Bdy+Cdz!=0`例如`q=(A,0,0)`，如果`B!=0`或`C!=0`。比点`P+l*Q/w`在平面上。

# serialization - 在没有 DataContract 的 ServiceStack.Text 中覆盖或别名字段名称

> ID：13435584
> 
> 赞同：1
> 
> 时间：2012-11-17T22:51:32.977
> 
> 标签：serialization, servicestack

使用此方法：[覆盖 ServiceStack 中的字段名称反序列化](https://stackoverflow.com/questions/10114044/override-field-name-deserialization-in-servicestack)我能够覆盖字段名称。有没有我不必使用 DataContract 的替代方法？我想选择退出序列化。

编辑：如下面的评论中所述，这在设计上无法与.NET 的其余部分相匹配。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T22:55:18.787

您可以使用`[IgnoreDataMember]`它来选择退出并省略临时字段。

# vim - 我应该在 .vimrc 文件中使用单引号还是双引号？

> ID：13435586
> 
> 赞同：17
> 
> 时间：2012-11-17T22:51:41.400
> 
> 标签：vim, quotes, double-quotes, single-quotes

Vim 中的单引号( `'`) 和双引号 ( )有什么区别？`"`它会产生速度差异吗？在其中运行功能时使用一个或另一个更好吗？这有关系吗？

我对它们在`.vimrc`文件中的使用特别感兴趣。

我问是因为我发现人们在同一件事上使用两者，我想知道有什么区别。我试图用谷歌搜索这个，但找不到任何东西。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-18T00:33:04.727

双引号允许插值，而单引号则不允许。

例如，使用双引号将在单独的行上`:echo "foo\nbar"`输出`foo`和，而不会解释为换行符，而是按字面意思输出。`bar``:echo 'foo\nbar'``\n``foo\nbar`

有关帮助文件的不同类型引号类型`:h 41.2`的更多信息，并阅读带有标题的部分末尾附近的部分`STRING VARIABLES AND CONSTANTS`。

这就是说，不要将字符串的引号与行注释开头的双引号混淆。单引号从不开始行注释，只有双引号才可以。

# php - 如何通过谷歌地图地理定位或其他方式获得以某个点为中心的 X 英里半径的纬度/经度坐标？

> ID：13435589
> 
> 赞同：2
> 
> 时间：2012-11-17T22:52:10.507
> 
> 标签：php, mysql, google-maps, google-maps-api-3

我正在建立一个本地点的数据库，这些本地点中的每一个都存储在我的 mysql 数据库中，并带有经纬度坐标集。

我想建立一个用户在表单中输入他的位置的搜索，我的表单将通过谷歌地图地理定位 API 成功确定用户的纬度和经度。

我的问题/问题是这个。如何确定我的 mysql 数据库中项目的哪些纬度和经度集在预定半径内（比如 25 英里）。

有没有办法计算 25 英里半径范围内的纬度和经度的外部边界，然后使用基本的 mysql 选择检查与 # 匹配的项目？如果是这样，英里和纬度/经度之间的转换是什么？如果没有，还有其他方法可以解决任何人能想到的吗？

谢谢！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T01:22:53.563

几乎与@Skidrow 之前写的一样，但在 php.ini 中。如果您想检查已经加载的结果，PHP 可能会更好，否则您必须迭代 mysql 中的所有帖子。如果那样的话mysql版本会更好

```
function calculateDistance($targetLat, $targetLng, $againstLat, $againstLng, $units = 'miles')
{
    $result = 3958.75 * acos(
        sin($targetLat / 57.2958) * sin($againstLat / 57.2958) +
            cos($targetLat / 57.2958) * cos($againstLat / 57.2958) *
                cos($againstLng / 57.2958 - $targetLng / 57.2958)
    );

    switch ($units)
    {
        default:
        case "":
        case "miles":
            $result *= 1;
            break;
    }

    return $result;
} 
```

使用此功能进行测试

$target* = 数据库中的位置

$against* = 用户位置

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:00:49.847

有很多方法。您可以使用空间索引或 harvesine 公式。您还可以创建邻近搜索。在这里阅读：[https](https://developers.google.com/maps/articles/geospatial) ://developers.google.com/maps/articles/geospatial 。harvesine 公式是球体上两点之间的大圆距离。

# solr - 无法使 Solr Delta Import Index 正常工作

> ID：13435593
> 
> 赞同：0
> 
> 时间：2012-11-17T22:52:42.453
> 
> 标签：solr, lucene

这些是我为尝试使增量导入处理程序工作而采取的确切步骤。如果我可以提供更多信息来帮助让我知道。从字面上看，我整个星期五晚上和今天都在这上面度过，我认输了。我哪里出错了？

将此行添加到 solrconfig：

```
<requestHandler name="/dataimport" class="org.apache.solr.handler.dataimport.DataImportHandler">
    <lst name="defaults">
      <str name="config">/home/solr/data-config.xml</str>
    </lst>
  </requestHandler> 
```

然后我的 data-config.xml 看起来像这样：

```
<dataConfig>
  <dataSource type="FileDataSource" />
  <document>
    <entity 
      name="document" 
      processor="FileListEntityProcessor" 
      baseDir="/var/lib/data" 
      fileName=".*.xml$" 
      recursive="false" 
      rootEntity="false" 
      dataSource="null">
      <entity 
        processor="XPathEntityProcessor" 
        url="${document.fileAbsolutePath}" 
        useSolrAddSchema="true" 
        stream="true">
      </entity>
    </entity>
  </document>
</dataConfig> 
```

然后在我的 var/lib/data 文件夹中，我有一个如下所示的 data.xml 文件：

```
<add>
<doc>
        <field name="id">123</field>
        <field name="description">This is my long description</field>
        <field name="company">Google</field>
        <field name="location_name">England</field>
        <field name="date">2007-12-31 22:29:59</field>
        <field name="source">Google</field>
        <field name="url">www.google.com</field>
        <field name="latlng">45.17614,45.17614</field>
</doc>
</add> 
```

最后我运行了这个命令：

```
http://localhost:8080/solr/dataimport?command=delta-import&clean=false 
```

我得到了这个结果（失败）：

```
<response>
<lst name="responseHeader">
<int name="status">0</int>
<int name="QTime">1</int>
</lst>
<lst name="initArgs">
<lst name="defaults">
<str name="config">/home/solr/data-config.xml</str>
</lst>
</lst>
<str name="command">delta-import</str>
<str name="status">idle</str>
<str name="importResponse"/>
<lst name="statusMessages">
<str name="Time Elapsed">0:15:9.543</str>
<str name="Total Requests made to DataSource">0</str>
<str name="Total Rows Fetched">0</str>
<str name="Total Documents Processed">0</str>
<str name="Total Documents Skipped">0</str>
<str name="Delta Dump started">2012-11-17 17:32:56</str>
<str name="Identifying Delta">2012-11-17 17:32:56</str>
<str name="">Indexing failed. Rolled back all changes.</str>
<str name="Rolledback">2012-11-17 17:32:56</str>
</lst>
<str name="WARNING">
This response format is experimental. It is likely to change in the future. 
</str>
</response> 
```

编辑：这就是 tomcat.log 所说的：

```
INFO: Starting Delta Import
Nov 18, 2012 12:48:46 PM org.apache.solr.core.SolrCore execute
INFO: [] webapp=/solr path=/dataimport params={clean=false&command=delta-import} status=0 QTime=1 
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.SimplePropertiesWriter readIndexerProperties
WARNING: Unable to read: dataimport.properties
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.DocBuilder doDelta
INFO: Starting delta collection.
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.DocBuilder collectDelta
INFO: Running ModifiedRowKey() for Entity: 84430688679548
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.DocBuilder collectDelta
INFO: Completed ModifiedRowKey for Entity: 84430688679548 rows obtained : 0
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.DocBuilder collectDelta
INFO: Completed DeletedRowKey for Entity: 84430688679548 rows obtained : 0
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.DocBuilder collectDelta
INFO: Completed parentDeltaQuery for Entity: 84430688679548
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.DocBuilder collectDelta
INFO: Running ModifiedRowKey() for Entity: document
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.DocBuilder collectDelta
INFO: Completed ModifiedRowKey for Entity: document rows obtained : 0
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.DocBuilder collectDelta
INFO: Completed DeletedRowKey for Entity: document rows obtained : 0
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.DocBuilder collectDelta
INFO: Completed parentDeltaQuery for Entity: document
Nov 18, 2012 12:48:46 PM org.apache.solr.handler.dataimport.DocBuilder doDelta
INFO: Delta Import completed successfully 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T18:18:36.757

看[维基](http://wiki.apache.org/solr/DataImportHandler#Using_delta-import_command-1)：

> 唯一支持 delta 的 EntityProcessor 是 SqlEntityProcessor！XPathEntityProcessor 尚未实现它。因此，不幸的是，目前还没有对 XML 的增量支持。

# ruby-on-rails - Rails belongs_to 问题

> ID：13435597
> 
> 赞同：0
> 
> 时间：2012-11-17T22:53:07.730
> 
> 标签：ruby-on-rails, ruby

我试图遵循这篇 [关于 Event_calendar 的帖子提供的答案。仅显示当前用户的事件，而不是所有存在的事件](https://stackoverflow.com/questions/4925627/about-event-calendar-showing-only-events-for-current-user-and-not-all-events-pre)

但是，当我尝试`belongs_to user`在事件模型中添加时，它给了我以下错误。

```
NameError (undefined local variable or method 'user' for #<Class:0x007fff15d1f6c0>):
  app/models/event.rb:3:in '<class:Event>'
  app/models/event.rb:1:in '<top (required)>'
  app/controllers/calendar_controller.rb:9:in 'index'

  Rendered .../.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_trace.erb (2.8ms)
  Rendered .../.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (2.0ms)
  Rendered .../.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.8/lib/action_dispatch/middleware/templates/rescues/diagnostics.erb within rescues/layout (23.6ms) 
```

在我的 user.rb 模型中，我包含了`has_many :events`

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T23:48:20.993

`belongs_to :user`

您必须在前面加上`:`以使其成为符号，否则它将被解析为方法。

# c - 使用 2 个 switch 语句打印输出

> ID：13435599
> 
> 赞同：1
> 
> 时间：2012-11-17T22:53:10.457
> 
> 标签：c, pointers, switch-statement

```
#include <stdio.h>
#include <math.h>

void getInput( int *metricUnit, int *englishUnit, int *metricNum, int *englishNum, int *valueConvert, int convert);
int getMetricUnit(int *metricNum);
int getEnglishUnit (int *englishNum);
int getValueConvert(int convert, int *metricUnit);
double convertLiquid(int metricUnit, int englishUnit, int convert, double converted);
void printOutput(int metricUnit, int englishUnit, int convert, double converted);

int main (void)
{
//Declarations
int metricUnit;
int englishUnit;
int convert;
int metricNum;
int englishNum;
int valueConvert;
int converted;

//Statements
getInput(&metricUnit, &englishUnit, &metricNum, &englishNum, &valueConvert, convert);
convertLiquid(metricUnit, englishUnit, convert, converted);
printOutput(metricUnit, englishUnit, convert, converted);

return 0;
}

void getInput( int *metricUnit, int *englishUnit, int *metricNum, int *englishNum, int *valueConvert, int convert) //Function 0
{
*metricUnit = getMetricUnit(metricNum);
*englishUnit = getEnglishUnit(englishNum);
*valueConvert = getValueConvert(convert, metricUnit);
}

int getMetricUnit(int *metricNum)      //Subfunction 1 of getInput

{
printf("Metric Units (Input)\n");
printf("1 - Milliliters \n");
printf("2 - Centiliters \n");
printf("3 - Deciliters \n");
printf("4 - Liters \n");
printf("Enter the number of metric unit: ");
scanf("%d", metricNum);
printf("\n");

return *metricNum;
}

int getEnglishUnit (int *englishNum)    //Subfunction 2 of getInput

{
printf("English Units (Output) \n");
printf("1 - Fluid Ounce \n");
printf("2 - Cup \n");
printf("3 - Pint \n");
printf("4 - Quart \n");
printf("5 - Gallon \n");
printf("Enter the number of the English unit: ");
scanf("%d", englishNum);

return *englishNum;

} 

int getValueConvert(int convert, int *metricUnit)
{
switch (*metricUnit)
{
    case 1: printf("Enter the milliliter value to convert: ");
            scanf("%d", &convert); break;
    case 2: printf("Enter the centiliter value to convert: ");
            scanf("%d", &convert); break;
    case 3: printf("Enter the deciliter value to convert: ");
            scanf("%d", &convert); break;
    case 4: printf("Enter the liter value to convert: ");
            scanf("%d", &convert); break;
    default: printf("Enter the milliliter value to convert: ");
            scanf("%d", &convert); break;
}

if (convert > 0) return convert;
else return 0;
}

double convertLiquid(int metricUnit, int englishUnit, int convert, double converted)
{
double milliliter;
double centiliter;
double deciliter;
double liter;
double fluidOunce;
double cup;
double pint;
double quart;
double gallon;

    switch (metricUnit)
{
    case 1:  metricUnit = milliliter; convert = milliliter       ;break;
    case 2:  metricUnit = centiliter; convert = milliliter * 10  ;break;
    case 3:  metricUnit = deciliter ; convert = milliliter * 100 ;break;
    case 4:  metricUnit = liter     ; convert = milliliter * 1000;break;
    default: metricUnit = milliliter; convert = milliliter       ;break;
} //end swtich1
    fluidOunce = ((double)convert) * 29.537;

switch (englishUnit)
{
    case 1:  englishUnit = fluidOunce; converted = fluidOunce ; break;
    case 2:  englishUnit = cup;  converted = fluidOunce * 8 ; break;
    case 3:  englishUnit = pint;  converted = fluidOunce * 16; break;
    case 4:  englishUnit = quart;   converted = fluidOunce * 32; break;
    case 5:  englishUnit = gallon;   converted = fluidOunce * 128; break;
    default: englishUnit = fluidOunce; converted = fluidOunce     ; break;
}  //end switch2
return converted;
}

void printOutput(int metricUnit, int englishUnit, int convert, double converted)
{
switch (metricUnit)
{
    case 1: printf("%lf milliliter(s) = %lf  ", (double)convert);
    case 2: printf("%lf centiliter(s) = ", (double)convert);
    case 3: printf("%lf deciliter(s) = ", (double)convert);
    case 4: printf("%lf liter(s) = ", (double)convert);
    default: printf("%lf milliliter(s) = ", (double)convert);   

}
}

Im having the trouble with the printOutput function, 
```

这是试运行

```
Metric Units (Input)
1: Milliliter
2: Centiliter
3: Deciliter
4: Liter
Enter the number of the metric unit: 5

English Units (Output)
1: Fluid Ounce
2: Cup
3: Pint
4: Quart
5: Gallon
Enter the number of the English unit: 0
Enter the milliliter value to convert: 300
300.000 milliliter(s) = 10.144 fluid ounce(s) 
```

我只是不知道如何获得此测试运行的最后一行。最后一行显示了 2 个变量，分别是毫升和液量盎司，我如何将 2 个变量放入 2 个 switch 语句中？或者我怎样才能让最后一行以与测试运行相同的方式出现。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T01:13:18.980

我对你问的确切问题有点困惑，但你可以在开关中嵌套一个开关。

```
void printOutput(int metricUnit, int englishUnit, int convert, double converted)
{
    switch (metricUnit)
    {
        case 1: printf("%lf milliliter(s) = ", (double)convert);
                switch (englishUnit)
                {
                    case 1: printf("%lf fluid ounce(s)\n", (double)converted); break;
                    case 2: printf("%lf cup(s)\n", (double)converted); break;
                    case 3: printf("%lf pint(s)\n", (double)converted); break;
                    case 4: printf("%lf quart(s)\n", (double)converted); break;
                    case 5: printf("%lf gallons(s)\n", (double)converted); break;
                }
        break;

        case 2: printf("%lf centiliter(s) = ", (double)convert);
                switch (englishUnit)
                {
                    case 1: printf("%lf fluid ounce(s)\n", (double)converted); break;
                    case 2: printf("%lf cup(s)\n", (double)converted); break;
                    case 3: printf("%lf pint(s)\n", (double)converted); break;
                    case 4: printf("%lf quart(s)\n", (double)converted); break;
                    case 5: printf("%lf gallons(s)\n", (double)converted); break;
                }
        break;

        case 3: printf("%lf deciliter(s) = ", (double)convert);
                switch (englishUnit)
                {
                    case 1: printf("%lf fluid ounce(s)\n", (double)converted); break;
                    case 2: printf("%lf cup(s)\n", (double)converted); break;
                    case 3: printf("%lf pint(s)\n", (double)converted); break;
                    case 4: printf("%lf quart(s)\n", (double)converted); break;
                    case 5: printf("%lf gallons(s)\n", (double)converted); break;
                }
        break;

        case 4: printf("%lf liter(s) = ", (double)convert);
                switch (englishUnit)
                {
                    case 1: printf("%lf fluid ounce(s)\n", (double)converted); break;
                    case 2: printf("%lf cup(s)\n", (double)converted); break;
                    case 3: printf("%lf pint(s)\n", (double)converted); break;
                    case 4: printf("%lf quart(s)\n", (double)converted); break;
                    case 5: printf("%lf gallons(s)\n", (double)converted); break;
                }
        break;

        default: printf("%lf milliliter(s) = ", (double)convert);
                switch (englishUnit)
                {
                    case 1: printf("%lf fluid ounce(s)\n", (double)converted); break;
                    case 2: printf("%lf cup(s)\n", (double)converted); break;
                    case 3: printf("%lf pint(s)\n", (double)converted); break;
                    case 4: printf("%lf quart(s)\n", (double)converted); break;
                    case 5: printf("%lf gallons(s)\n", (double)converted); break;
                }
        break;
    }
} 
```

但是如果可以的话，这种方法有点费力，我会将englishUnit 和metricUnit 更改为数组，这样你就可以用一个printf() 打印输出。当然，您将不得不重写几乎所有的程序。

```
char metricUnit[20];
char englishUnit[20];

printf("%lf %s(s) = %lf %s(s)\n", (double)convert, metricUnit, (double)converted, enlgishUnit); 
```

# c - 释放字符指针返回错误

> ID：13435603
> 
> 赞同：0
> 
> 时间：2012-11-17T22:54:11.800
> 
> 标签：c, pointers, memory-management, malloc

我试图在使用后释放一个字符指针，但它返回一个奇怪的错误。

错误说：

> _CrtDbgREport：字符串太长或 IO 错误

调试器本身在编译时不返回错误。

目前的代码如下所示：

```
void RespondToUser(SOCKET client, SOCKET server)
{
    char buffer[80];
    char *temp = malloc(_scprintf("HTTP/1.1 200 OK\r\n%s\r\nServer: %s\r\nConnection: close\r\n\r\nHi!", buffer, SERVER_NAME));
    sprintf(temp, "HTTP/1.1 200 OK\r\n%s\r\nServer: %s\r\nConnection: close\r\n\r\nHi!", buffer, SERVER_NAME);

    send(client, temp, strlen(temp), 0);
    closesocket(client);
    free(temp);
    ListenToUsers(server);
} 
```

仅当我尝试从内存中释放临时指针而不是其他情况时才会出现此问题。这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T22:57:53.347

调用`sprintf()`是在末尾写一个（因为它附加了一个 NULL 终止符），因为 from 的返回值`_scprintf()`不包括 NULL 终止符。从[`_scprintf()`](http://msdn.microsoft.com/en-us/library/t32cf9tb%28v=vs.80%29.aspx)参考页面：

> 如果要使用指定的格式代码打印或发送到文件或缓冲区，则返回将生成的字符数。**返回的值不包括终止空字符。**

这意味着程序具有未定义的行为。更正`+ 1`为`_scprintf()`s 返回值。

# javascript - 获取元素的内部高度

> ID：13435604
> 
> 赞同：32
> 
> 时间：2012-11-17T22:54:19.923
> 
> 标签：javascript, dom

如何在没有填充和边框的情况下获得元素的内部高度？

没有 jQuery，只有纯 JS，还有一个跨浏览器的解决方案（包括 IE7）

![在此处输入图像描述](../Images/a93811fa61f8d46cb855ce7544631d74.png)

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-17T23:20:42.247

```
var style = window.getComputedStyle(document.getElementById("Example"), null);
style.getPropertyValue("height"); 
```

上述版本将在现代浏览器中运行。请检查`currentStyle`IE 浏览器。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2020-01-24T15:59:51.097

[clientHeight - 给出](https://developer.mozilla.org/en-US/docs/Web/API/Element/clientHeight)*包括* **填充**但没有 **边框**的高度。

[getComputedStyle](https://developer.mozilla.org/en-US/docs/Web/API/Window/getComputedStyle) - 一种利用元素的 CSS 规则并检索属性值（填充）的方法

使用[parseInt](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseInt)是一种去除单位并仅保留数值（以*像素*为单位）的
`parseFloat`方法，也可用于更精确的亚像素测量

> 请注意，DOM API 会自动将所有值转换为*像素*

```
function getInnerHeight( elm ){
  var computed = getComputedStyle(elm),
      padding = parseInt(computed.paddingTop) + parseInt(computed.paddingBottom);

  return elm.clientHeight - padding
} 
```

# 演示：

```
// main method
function getInnerHeight( elm ){
  var computed = getComputedStyle(elm),
      padding = parseInt(computed.paddingTop) + parseInt(computed.paddingBottom);

  return elm.clientHeight - padding
}

// demo utility function
function printInnerHeight( selector ){
  console.clear()
  console.log(
    getInnerHeight( document.querySelector(selector) )
  )
}
```

```
body{ display: flex; padding:0; margin: 0; }
div{ flex: 1; }

.demo1{
  padding-top: 2vh;
  padding-bottom: 1vh;
  margin: 30px;
  border: 10px solid salmon;
  box-sizing: border-box;
  outline: 1px solid red;
}

.demo2{
  padding-top: 2vh;
  padding-bottom: 4vh;
  margin: 30px;
  border: 10px solid salmon;
  border-bottom-width: 0;
  height: 150px;
  outline: 1px solid red;
}

p::before{
  content: '';
  display: block;
  height: 100%;
  min-height: 50px;
  background: lightgreen;
}
```

```
<div>
  <h2>inner height should be ~50px</h2>
  <button onclick="printInnerHeight('.demo1')">Get Inner Height</button>
  <p class='demo1'></p>
</div>
<div>
  <h2>inner height should be ~150px</h2>
  <button onclick="printInnerHeight('.demo2')">Get Inner Height</button>
  <p class='demo2'></p>
</div>
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-17T23:22:09.590

从评论编辑：

[http://jsfiddle.net/hTGCE/1/](http://jsfiddle.net/hTGCE/1/)（比预期更多的代码）

在互联网上你会发现这样的功能：

```
 function getRectangle(obj) {

          var r = { top: 0, left: 0, width: 0, height: 0 };

          if(!obj)
             return r;

          else if(typeof obj == "string")
             obj = document.getElementById(obj);

          if(typeof obj != "object")
             return r;

          if(typeof obj.offsetTop != "undefined") {

             r.height = parseInt(obj.offsetHeight);
             r.width  = parseInt(obj.offsetWidth);
             r.left = r.top = 0;

             while(obj && obj.tagName != "BODY") {

                r.top  += parseInt(obj.offsetTop);
                r.left += parseInt(obj.offsetLeft);

                obj = obj.offsetParent;
             }
          }
          return r;
       } 
```

如果你想减去在css文件中设置的填充/边框宽度，而不是在样式属性中动态：

```
 var elem = document.getElementById(id);
    var borderWidth = 0;

          try {
             borderWidth = getComputedStyle(elem).getPropertyValue('border-top-width');

             } catch(e) {

             borderWidth = elem.currentStyle.borderWidth;
          } 
    borderWidth = parseInt(borderWidth.replace("px", ""), 10); 
```

和填充相同。然后你计算它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-15T02:43:47.733

您可以简单地使用`clientHeight`and`clientWidth`属性。

[Element.clientHeight 的 MDN Web 文档](https://developer.mozilla.org/en-US/docs/Web/API/Element/clientHeight)— clientWidth 的工作方式完全相同。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2014-02-25T22:32:22.423

我遇到了同样的问题，发现没有本地跨平台解决方案，但解决方案很简单

```
var actual_h = element.offsetHeight;

            if(parseInt(element.style.paddingTop.replace('px','')) > 0){
                actual_h=actual_h -  parseInt(element.style.paddingTop.replace('px',''));

            }
            if(parseInt(element.style.paddingBottom.replace('px','')) > 0){
                actual_h=actual_h -  parseInt(element.style.paddingBottom.replace('px',''));

            } 
```

# java - http请求的url编码正文

> ID：13435613
> 
> 赞同：2
> 
> 时间：2012-11-17T22:55:22.903
> 
> 标签：java, http, servlets, urlencode

有人可以向我解释一下在使用时实际上需要对在 http 请求的正文部分发送的数据进行 Url 编码吗

```
 content-type: application/x-www-form-urlencoded 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:04:48.700

“需要”是指“目的”吗？

如果你追求的是紫色——它只是告诉服务器会发生什么：URL 编码的键=值对。它还允许服务器知道什么*不是*它的方式 - multipart/form-data 之类的！这允许服务器明确地知道如何读取传入的数据。

数据作为一个标头发送（这也是它有大小限制的原因）。因此，您绝对希望避免使用以下内容：换行符、冒号。除此之外，您肯定希望在数据中转义 =，以免与 key=value 结构混淆。你也想逃避 & 出于同样的原因。URL 编码可以做到这一切——所以只有设计 HTTP 协议的人才会这样做才有意义！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T06:25:25.410

There are multiple ways to send data to the server in a POST request; URL Encoded data is just one of several possible formats.

The client and server have to agree on the format of data in the POST body. URL Form encoded data is the easiest to use because of its universal support. Browsers support it natively. Every programming language allows you to read url encoded post parameters using a familiar syntax.

But of course, there is no need to use url form encoded. You can as easily send json or xml encoded POST body. As long as the client and server are in sync, you can even create a totally different encoding and use it.

# c++ - 使用来自另一个方法的函数和#define 定义常量

> ID：13435614
> 
> 赞同：0
> 
> 时间：2012-11-17T22:55:25.193
> 
> 标签：c++, visual-studio-2010, c-preprocessor

有没有办法使用另一个方法的函数定义一个常量`#define`？

例如，我在文件 foo.cpp 中有一个返回 int 的方法：

```
int foo() { return 2; } 
```

在我的 bar.cpp 中，我想要类似的东西

```
#define aConstant foo() 
```

是否可以？有没有办法做到这一点？

（我正在使用 Visual Studio 2010）

编辑：`constexpr`因为我使用的是 VS 2010，所以不起作用，所以还有其他想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:07:37.987

做了

```
constexpr int foo() { return 2; } 
```

然后在另一个单元

```
static constexpr int aConstant = foo(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:19:15.453

`static int const a = bar();`在命名空间范围内的代码中的任何地方都没有任何本质上的错误。只是除非`bar`是`constexpr`，否则初始化将发生在*动态初始化阶段*。这可能会导致某些排序问题，但它本身并没有被破坏，后续使用`a`将与您想象的一样高效。

或者，您可以将函数设为宏：

```
#define TIMESTWO(n) (n * 2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T23:20:29.703

不幸的是，Visual C++ 2010 不支持`constexpr`C++11 带来的功能，正如您在[此表](http://wiki.apache.org/stdcxx/C++0xCompilerSupport)上看到的那样（来自 Apache Stdcxx 项目）：MSVC（MicroSoft Visual Studio C/C++ 编译器）尚不支持它（检查第 7 行）。

但是，您仍然可以将`foo()`正文保存在`foo.cpp`文件中并使用中间全局变量：

```
inline int foo() { return 2; }
const int aConstant = foo(); 
```

然后在`bar.cpp`文件中：

```
extern const int aConstant;

void bar()
{
   int a = 5 * aConstant;
} 
```

如果您已将 Visual C++ 配置为允许内联（这是默认设置），则将`aConstant`在编译时初始化。否则，`foo()`将`aConstant`在运行时调用以进行初始化，但在启动时（在`main()`调用函数之前）。`foo()`所以这比每次使用`const`返回值时调用要好得多。

# xpath - 如何使用 hxs.select 在 scrapy 中获取整个文档

> ID：13435620
> 
> 赞同：2
> 
> 时间：2012-11-17T22:55:58.250
> 
> 标签：xpath, scrapy

我已经在这工作了 12 小时，我希望有人可以帮我一把。

这是我的代码，我想要的只是在页面爬行时获取页面上每个链接的锚点和 url。

```
from scrapy.contrib.spiders import CrawlSpider, Rule
from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor
from scrapy.selector import HtmlXPathSelector
from scrapy.utils.url import urljoin_rfc
from scrapy.utils.response import get_base_url
from urlparse import urljoin

#from scrapy.item import Item
from tutorial.items import DmozItem

class HopitaloneSpider(CrawlSpider):
name = 'dmoz'
allowed_domains = ['domain.co.uk']
start_urls = [
    'http://www.domain.co.uk'
]

rules = (
    #Rule(SgmlLinkExtractor(allow='>example\.org', )),
    Rule(SgmlLinkExtractor(allow=('\w+$', )), callback='parse_item', follow=True),
)

user_agent = 'Mozilla/5.0 (Windows; U; MSIE 9.0; WIndows NT 9.0; en-US))'

def parse_item(self, response):
    #self.log('Hi, this is an item page! %s' % response.url)

    hxs = HtmlXPathSelector(response)
    #print response.url
    sites = hxs.select('//html')
    #item = DmozItem()
    items = []

    for site in sites: 

                   item = DmozItem()
                   item['title'] = site.select('a/text()').extract()
                   item['link'] = site.select('a/@href').extract()

                   items.append(item)

    return items 
```

我做错了什么......我的眼睛现在受伤了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-29T07:01:32.140

response.body 应该是你想要的

```
def parse_item(self, response):
    #self.log('Hi, this is an item page! %s' % response.url)

    body = response.body
    item = .... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T14:29:11.460

要在单个页面上获取所有链接：

```
def parse_item(self, response):
  hxs = HtmlXPathSelector(response)
  items = []
  links = hxs.select("//a")

  for link in links: 

                 item = DmozItem()
                 item['title'] = site.select('text()').extract()
                 item['link'] = site.select('@href').extract()

                 items.append(item)

return items 
```

# meteor - 模板渲染回调

> ID：13435621
> 
> 赞同：2
> 
> 时间：2012-11-17T22:56:19.600
> 
> 标签：meteor

我正在使用 Handlebar 的 {{#each}} 将我的集合呈现给 DOM。呈现每个项目后，我想在这些元素上运行一个脚本。当整个渲染完成时，我试图找到一个只触发一次的 callabck 函数。Meteor 的 Template.rendered() 每次插入新项目时都会运行，因此它运行的次数是我收藏中的项目数的倍数。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:01:07.913

`Template.foo.rendered`在外部模板（包含`{{#each}}`）上是您要查找的内容。

要注意的是，这只会在第`{{#each}}`一次渲染时运行，但是当（例如）更多项目添加到集合中时，您不一定要依赖它重新运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-15T19:23:11.607

使用 Template.created() 而不是 render()。如您所见，每次渲染和重新渲染模板时，都会运行 render()。

# android - 未找到奇怪的资源问题？

> ID：13435623
> 
> 赞同：1
> 
> 时间：2012-11-17T22:56:26.000
> 
> 标签：android, resources, soundpool

我似乎遇到了一个非常奇怪的问题，当应用程序在我的测试手机上运行时，它运行良好，并且在按下按钮时通过 soundpool 从原始文件夹播放声音，但是当我在构建应用程序后提交测试时它崩溃了在 120 多台设备上“找不到资源”

下面的代码：另请注意，该文件实际上存在，在 R 文件中，在编译的 APK 文件中，我也清理了很多次。

[http://www.appthwack.com/public/FUVGFZn42q](http://www.appthwack.com/public/FUVGFZn42q)

```
'01-03 21:09:36.828 26762 26762 W System.err: java.lang.RuntimeException: Unable to start activity ComponentInfo{appinventor.ai_Broak.PaintballWiz/com.muo.paintballwiz.PaintballWiz}: android.content.res.Resources$NotFoundException: File res/raw/pballshot.ogg from drawable resource ID #0x7f050000 - 1 occurrence'

soundPool = new SoundPool(4, AudioManager.STREAM_MUSIC, 100);

//soundPoolMap = new SparseIntArray();
soundPoolMap = new HashMap<Integer, Integer>();

// soundPoolMap.put(soundID, soundPool.load(this, R.raw.midi_sound, 1));
int myAudioFile = getResId("pballshot", R.raw.class);
soundPoolMap.put(soundID, soundPool.load(PaintballWiz.this, myAudioFile, 1));
audioManager = (AudioManager) getSystemService(Context.AUDIO_SERVICE);
curVolume = audioManager.getStreamVolume(AudioManager.STREAM_MUSIC);
maxVolume = audioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC);
leftVolume = curVolume / maxVolume;
rightVolume = curVolume / maxVolume;
soundPool.play(soundID, leftVolume, rightVolume, priority, no_loop, normal_playback_rate);
soundPool.play(soundID, 0, 0, 1, -1, 1f); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T23:12:04.763

我可能是错的，但听起来资源不是您自己的文件之一。并且您正在使用手机的资源。我知道你在编译的 APK 中声明了它，但我认为你应该仔细检查一下

如果是这种情况，那么您正在使用的资源是一个，不能保证在 Android 手机上。在某些设备中也是如此。

解决的办法是把它复制下来，放到自己的资源文件夹中，这样就可以打包成APK，分发到任何安装了你的应用的手机上。

如果它已经在您的 APK 中，但也是手机资源，请确保它正确指向您 APK 中的资源，而不是手机的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T23:16:51.853

您可能想尝试将音频文件放入“资产”文件夹。然后使用 AssetManager 访问该文件。

# qt - QAbstractTableModel：index() 与 createIndex()

> ID：13435627
> 
> 赞同：4
> 
> 时间：2012-11-17T22:56:32.023
> 
> 标签：qt, qmodelindex

当子类化 QAbstractTableModel 时，为给定的行和列获取 QModelIndex 的正确方法是什么（例如，提供方便的方法 data(int row, int column)）？

有 index() 和 createIndex() - 他们似乎都这样做？

例子：

```
TableModel::data(int row, int column, int role) const
{
    return data(index(row, column), role);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T03:34:52.383

你想要的是 index()，createIndex() 是子类用来生成索引的。但是，QModelIndex 有一个 data() 成员。所以，model->index(row, column).data(role) 可能是你想要的。不需要辅助函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T03:47:18.320

我想说 index() 是这里的惯用方式，那么您的代码就是正确的。

通常，在 QAbstractItemModel 的子类中使用 createIndex()，当您需要覆盖 index() 和 parent() 方法时。由于 QModelIndex 构造函数是私有的，因此您必须使用 createIndex() 来创建新索引。

此外，QModelIndex 可以存储一些内部数据（[QModelIndex::internalPointer](http://doc.qt.digia.com/qt/qmodelindex.html#internalPointer)）。createIndex() 还用于将内部指针传递给创建的 QModelIndex。

# ruby-on-rails-3 - Rails 3 和 IE9 的加密 cookie

> ID：13435629
> 
> 赞同：0
> 
> 时间：2012-11-17T22:57:07.783
> 
> 标签：ruby-on-rails-3, cookies, encryption, internet-explorer-9

我正在使用加密的 cookie 将数据传递到我的 rails 应用程序。一旦设置了这些 cookie，它们就会很好地从 Chrome、Firefox、Safari（iOS 和 OSX 版本）等传递到我的应用程序。

但是，当我在 Win7/IE9 上执行相同操作时，cookie 不会被传回。

我正在使用 Ruby 1.9 和 Rails 3，并使用 cookies.permanent.encrypted 设置 cookie 的方法。例如：

```
cookies.permanent.encrypted[:some_data] = object.some_data 
```

关于发生了什么的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T18:27:05.310

It turns out it has to do with my P3P policy not getting passed correctly prior to the cookies being set. IE prevents cookies if that's the case, other browsers apparently don't care about that.

# jquery - Jquery 的 .click() 是如何工作的？

> ID：13435637
> 
> 赞同：1
> 
> 时间：2012-11-17T22:58:34.283
> 
> 标签：jquery, click

我正在尝试使用以下方法模拟用户单击元素：

```
 el = document.getElementById('#inputToClick');
      oEvent = document.createEvent("MouseEvents");
      oEvent.initMouseEvent("click", true, false, window, 1, 1, 1, 1, 1, false, false, false, false, 0, null);
      el.dispatchEvent(oEvent); 
```

这适用于另一个 jQuery 的 $el.click() 没有的站点，但我找到了一个 jQuery 的点击工作但上面没有的站点。我希望有人可以指出 jQuery 源代码的相关部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:11:24.483

如果你真的在寻找 jQuery 1.7.2 的点击功能的来源：

```
function (data, fn) {
    if (fn == null) {
        fn = data;
        data = null;
    }

    return arguments.length > 0 ? this.on(name, null, data, fn) : this.trigger(name);
} 
```

来源： [Jquery.Click 函数](http://james.padolsey.com/jquery/#v=1.7.2&fn=jQuery.fn.click)

如果你只是想知道如何点击某些东西......

```
$('#inputToClick').click(); 
```

# ios - 如果我在我的 iOS 应用程序中使用 Google Analytics，我是否必须回答是才能包含加密？

> ID：13435638
> 
> 赞同：1
> 
> 时间：2012-11-17T22:58:40.010
> 
> 标签：ios, cryptography, google-analytics

我已经在我的 iOS 应用中实现了新的 Google Analytics SDK。这是否意味着我在提交到 App Store 时必须对密码问题回答“是”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:25:45.310

是的。你可能应该。由于 Google Analytics 使用密码学，您最好勾选“是”。如果您不这样做，那么当 Apple 开始测试您的应用程序并发现它确实如此时，他们可能会拒绝它，您将不得不重新执行该过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T15:54:14.170

我不认为他们使用 SSL 连接到他们的站点以外的其他东西，这在逻辑上应该由基本系统库完成。所以我建议对密码学的使用回答“否”。

# linux - 如何在内核 Makefile 中正确地进行清理

> ID：13435639
> 
> 赞同：2
> 
> 时间：2012-11-17T22:58:59.433
> 
> 标签：linux, kbuild

我正在将驱动程序移植到 3.4 内核，当我执行 make clean 时，它并没有清理一些 .o 文件，所以现在我想知道这样做的正确方法是什么。

我有以下 Makefile（注意：在与内核不同的目录中）：

```
obj-y += foo.o
foo-objs += foo1.o foo2.o
clean-files := foo3.o 
```

当我运行 make clean 时，它会清除 foo3.o，但会留下 foo.o、foo1.o 和 foo2.o。我可以将所有这些放入干净的文件中，但这似乎是多余的，我认为有某种方法可以使 Makefile 自动清除 obj-y 目录中的所有对象。

谢谢，

约翰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T07:37:14.170

这是我使用`make clean`驱动程序代码的方式：

```
clean:
    $(MAKE) -C $(KDIR) M=$$PWD clean 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T02:14:01.070

You can use regular expressions in makefiles, and write *.o instead of foo1.o, foo2.o, etc.

Common way is to have a 'clean' target, which looks like this:

```
clean:
    $(RM) .*.cmd *.o *.ko -r .tmp* 
```

# c# - 关于使用 RuntimeHelpers.PrepareMethod() 进行预 JIT 的问题

> ID：13435641
> 
> 赞同：4
> 
> 时间：2012-11-17T22:59:11.257
> 
> 标签：c#, .net, clr

我正在探索使用 RuntimeHelpers.PrepareMethod() 来减少具有大量 UI 库的瘦客户端应用程序的启动时间

我创建了一个 JIT-helper 类以在后台线程上运行，并遍历类型或程序集的方法并在它们上调用 PrepareMethod

首先，这样做有什么缺点吗？（我的意思不是对整个应用程序进行 JIT，我的意思是重的库，例如 Infragistics、DevExpress 和代表 WPF 中的窗口类的类）

其次，有没有办法确定一个方法是否已经被 JIT 编辑过？（虽然我没有注意到不小心多次调用它的任何延迟或问题）

最后，如果我在后台线程上执行 JIT-ing 并且另一个线程调用当前正在 JIT-ed 的方法会发生什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T13:04:04.580

由于您所问的是高度依赖于实现的，因此没有明确的答案......我希望在 JITted 时会对方法进行某种锁定......但除了深入挖掘特定的 .NET 版本等.这仍然是猜测...

顺便说一句：有一个（非公共）字段被称为JIT 编译器在 jitting 后设置`IsJitted`的相应字段...有关更多信息，请参见[此处](http://blog.liranchen.com/2010/08/forcing-jit-compilation-during-runtime.html)...`MethodDesc``true`

# c - 如何使用 C 系统调用 mkdir 创建隐藏文件夹？

> ID：13435646
> 
> 赞同：0
> 
> 时间：2012-11-17T23:00:34.077
> 
> 标签：c, posix, mkdir

假设我想创建一个文件夹 myFolder，并且我希望它被隐藏。我很难为 Unix 找到答案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T23:12:53.173

有关在 C 中创建文件夹的信息，请参见[man 2 mkdir](http://linux.die.net/man/2/mkdir)。要使其隐藏，您必须在名称前加上一个点。这只是一个单行：

```
mkdir(".myFolder", 0755); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:04:32.087

隐藏目录必须以“.”开头 点在他们的文件名前面。mkdir .hidden

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T23:05:40.207

```
mkdir .myFolde 
```

以点开头的目录是 unix 中的隐藏目录

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T09:08:56.797

您可以创建一个目录并拒绝对其进行读取/执行访问。然后该目录中的所有文件都将被“隐藏”。`mkdir ("no-peeking-here", S_IRWXU); mkdir ("no-peeking-here/look-ma-no-dots", S_IRWXU);` 或者，如果您只是想减少混乱，请按照许多人的建议使用前导点。

# c - C 全局结构指针

> ID：13435651
> 
> 赞同：5
> 
> 时间：2012-11-17T23:01:17.383
> 
> 标签：c, variables, pointers, struct, global-variables

我在文件中声明了一个 typedef 的结构。我有一个指向它的指针，并想在多个文件中将它用作全局变量。有人可以指出我做错了什么吗？

**文件A.h：**

```
typedef struct
{
  bool                  connected;
  char                  name[20];
}vehicle;

extern vehicle *myVehicle; 
```

**文件AC：**

```
#include "fileA.h"
void myFunction(){
    myVehicle = malloc(sizeof(vehicle));
    myVehicle->connected = FALSE;
} 
```

**文件B.c：**

```
#include "fileA.h"
void anotherFunction(){
   strcpy(myVehicle->name, "this is my car");
} 
```

我得到的错误是：

> fileA 中引用的未定义外部“myVehicle”

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-17T23:02:52.273

这是一个*声明*：

```
extern vehicle *myVehicle; /* extern makes this a declaration,
                              and tells the compiler there is
                              a definition elsewhere. */ 
```

添加*定义*：

```
vehicle *myVehicle; 
```

到*一个*文件`.c`。

# cryptography - 为什么替换密码的密钥空间是阶乘 N

> ID：13435652
> 
> 赞同：4
> 
> 时间：2012-11-17T23:01:23.197
> 
> 标签：cryptography, key

我正在学习加密课程，我们正在学习替代密码及其密钥空间。根据导师的说法，关键空间是 26！（大约 2^88）为英文字母。没有提到密钥长度，可能是因为 subst cipher 的长度是字母表长度的函数，就像选项的数量一样。

根据[维基百科](http://en.wikipedia.org/wiki/Key_space_%28cryptography%29)，密钥空间是一定长度的所有可能密钥的集合，其计算方式与蛮力尝试计数为选项^长度或在本例中为 26^26 的方式相同。

那么我没有到达这里是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-17T23:17:45.847

这有点误导，你的导师和维基百科都是正确的。通常，26 个英文字母的键定义了一个键空间大小`26`^(`26`)。

对于英文字母表的替换密码，`26!`是表示密钥空间的正确数字。这是因为对于替换密码，密钥被定义为用另一个字母唯一替换每个字母，例如`A -> D, B -> M, C -> Y, etc.`26 个字母 --> 密钥可以是 26 个字母集的任何排列 --> `26!`。由于替换所需的唯一性，键空间实际上小于最大值`26`^(`26`)，因为某些（大多数）键是不可能的 - 例如，您不能将 A 和 B 都映射到 D。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:06:15.403

如果您的密钥是一组数字，则 options^length 是正确的。每个数字可能出现多次。

如果您的键是字母表，则阶乘 N 是正确的。说，你想把A放在第一位。您有 26 个选项。在那之后，你对于 B 只有 25 个选项，因为 A 已经占据了一个。24 对于 C 等等。

26*25*24*...*1 = 26！

# android - 如何使用 FLAG_GRANT_READ_URI_PERMISSION 授予对自定义内容提供者的临时访问权限

> ID：13435654
> 
> 赞同：10
> 
> 时间：2012-11-17T23:01:51.190
> 
> 标签：android, android-intent, android-contentprovider

我正在尝试从另一个应用程序（应用程序 B）查询自定义内容提供程序（应用程序 A）。

当内容提供者没有权限保护时，我可以这样做。具体来说，我在 App A 上构建了自定义内容提供程序，并向 App B 发送了一个包含 URI 的意图。这是 App A 中的意图发送部分。

```
class InsertOnClickListener implements OnClickListener{        
        public void onClick(View v) {
            ContentValues values = new ContentValues();
            values.put(DataBaseConfiguation.TableConfiguation.USER_NAME, "Jack");
            Uri uri = getContentResolver().insert(DataBaseConfiguation.TableConfiguation.CONTENT_URI, values);
            System.out.println("uri------------------->" + uri);
            // the uri above should be like "content://com.catking.contentprovider.MyContentProvider/user"
            Uri uri2 = Uri.parse("content://com.catking.contentprovider.MyContentProvider/user");
              Cursor c = managedQuery(uri2, null, null, null, null);
              String sendvalue = null;
               if (c.moveToFirst()) {
                  do{
                     System.out.println("User name:"+c.getString(c.getColumnIndex(DataBaseConfiguation.TableConfiguation.USER_NAME)).toString());               
                     sendvalue = c.getString(c.getColumnIndex(DataBaseConfiguation.TableConfiguation.USER_NAME)).toString();
                  } while (c.moveToNext());
               }
            Intent sendIntent = new Intent();
            sendIntent.setClassName("com.android.web", "com.android.web.Provid");
            sendIntent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION);
            sendIntent.putExtra("name", uri2.toString());
            sendIntent.setType("text/plain");
            startActivity(sendIntent);
        }
} 
```

然后是 App A 的清单文件。

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name=".ContentProviderTestActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <provider android:authorities="com.catking.contentprovider.MyContentProvider"
        android:exported="true"
        android:grantUriPermissions="true"
        android:name="com.catking.contentprovider.MyContentProvider" 
        android:readPermission="android.permission.permRead"
        android:writePermission="android.permission.permWrite" >
    </provider>
</application> 
```

然后 App B(class Provid) 获取 URI 并在 content provider 中查询相应的数据（使用以下代码）。

```
public class Provid extends Activity {

public void onCreate(Bundle savedInstanceState) {
    Bundle extras = getIntent().getExtras(); 
    String userNameuri;
    if (extras != null) {
        userNameuri = extras.getString("name");
      Uri allTitles = Uri.parse(userNameuri);
      Cursor c = managedQuery(allTitles, null, null, null, null);
       if (c.moveToFirst()) {
          do{
             System.out.println("Name is"+c.getString(c.getColumnIndex(DataBaseConfiguation.TableConfiguation.USER_NAME)).toString());               
          } while (c.moveToNext());
       }
    }
} 
```

}

这是 App B 的清单文件。

```
<uses-permission android:name="android.permission.INTERNET" />
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >
    <activity
        android:name="._GetWebResoureActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
        <intent-filter>
            <action android:name="android.intent.action.SEND" >
            </action>
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="*/*" />
        </intent-filter>
    </activity>

    <receiver android:name="StaticReceiver11" >
        <intent-filter>
            <action android:name="android.intent.action.MYSEND" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </receiver>

    <activity
        android:name="Provid"
        android:label="@string/title_activity_provid" >
        <intent-filter>
            <action android:name="android.intent.action.VIEW" />
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="*/*" />
        </intent-filter>

    </activity>
</application> 
```

但是，当我从 App B 查询内容提供者时，会出现错误：

```
java.lang.RuntimeException: Unable to start activity ComponentInfo {com.android.web/com.android.web.Provid}: java.lang.SecurityException: Permission Denial: opening     provider com.ck.contentprovider.MyContentProvider from ProcessRecord{426c6ea8 17032:com.android.web/u0a95} (pid=17032, uid=10095) requires android.permission.permRead or android.permission.permWrite 
```

App B似乎没有使用临时权限访问。换句话说，如何利用 App B 的 FLAG_GRANT_READ_URI_PERMISSION？

我也尝试直接将 Uri 添加到意图（使用 setData（）），而不是 Uri.toString（）（使用 putExtra（））。

```
sendIntent.setData(uri2); 
```

和

```
Uri userNameuri = getIntent().getData(); 
```

但是 App B 中的“userNameuri”为空。

我完全糊涂了……

**更新**

根据上一篇文章，我尝试了“grantUriPermission("com.android.getCPaccess", uri2, Intent.FLAG_GRANT_READ_URI_PERMISSION)"
[将敏感应用数据作为电子邮件附件发送时正确的权限处理是什么？](https://stackoverflow.com/questions/4179594/what-is-the-correct-permission-handling-when-sending-sensitive-app-data-as-email)

它确实有效。它可以在不使用 FLAG_GRANT_READ_URI_PERMISSION 的情况下工作。但许可不是“临时的”。它必须通过 revokeUriPermission() 手动结束。

所以，我想知道是否有一种方法可以授予 FLAG_GRANT_READ_URI_PERMISSION 中介绍的临时权限，或者它根本就是一个错误？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-15T14:10:46.810

似乎`FLAG_GRANT_READ_URI_PERMISSION`只影响`Uri Intent.mData`但不影响额外内容中的 uris。

我在玩的时候发现了类似的问题`ACTION_SEND`，它需要一个uri `EXTRA_STREAM`。提供相同的 uri`setData()`将起作用，但不符合规则并导致意外行为（例如 Gmail 收件人）。

由于果冻豆意图可以包含 ClipData，这应该可以解决问题。因为`ACTION_SEND`它是由附加功能自动生成的。

`grantUriPermission`会工作，但需要`revokeUriPermission`. `startActivity(Intent.createChooser(intent, title))`要完成与您必须选择目标（ ）相同的工作`ACTION_PICK_ACTIVITY`，授予其包的权限并在不再需要时撤销它们（onActivityResult？）。

这是一些代码：

接收器应用程序：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.handler" >

    <application android:allowBackup="true" android:icon="@drawable/ic_launcher" android:label="@string/app_name" >
        …
        <activity
            android:name=".ActivityView"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.VIEW"/>
                <action android:name="android.intent.action.SEND"/>
                <category android:name="android.intent.category.DEFAULT"/>
                <data android:mimeType="*/*"/>
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

活动视图.java：

```
protected void onCreate(Bundle savedInstanceState) {
    Intent intent = getIntent();
    if ((intent != null)) {
        procUri(intent.getData());
        procUri(intent.<Uri>getParcelableExtra(Intent.EXTRA_STREAM));
    }
}

private void procUri(Uri uri) {
    if (uri != null) {
        InputStream i;
        try {
            i = getContentResolver().openInputStream(uri);
            byte[] b = new byte[i.available()];
            i.read(b);
            …
        } catch (Throwable e) {
            …
        }
    }
} 
```

发件人应用：

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.sender" >

    <application android:allowBackup="true" android:icon="@drawable/ic_launcher" android:label="@string/app_name" >
        …
        <activity
            android:name=".ActivitySend"
            android:label="@string/app_name" >
        </activity>
        <provider
            android:name=".MyContentProvider"
            android:authorities="com.example.sender.content"
            android:enabled="true"
            android:exported="false"
            android:grantUriPermissions="true" >
        </provider>
    </application>
</manifest> 
```

活动发送.java：

```
// OK!
private void doTestView(Uri uri, String type) {
    startActivity(
            new Intent(Intent.ACTION_VIEW)
                .setDataAndType(uri, type)
                .addFlags(Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET)
                .addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION)
        );
}

// error prior to JellyBean
// ok on JellyBean, even without explicit FLAG_GRANT_READ_URI_PERMISSION (due to generated ClipData)
private void doTestSend(Uri uri, String type, CharSequence title) {
    startActivity(
            Intent.createChooser(
                new Intent(Intent.ACTION_SEND)
                    .setType(type)
                    .putExtra(Intent.EXTRA_STREAM, uri)
                    .putExtra(Intent.EXTRA_SUBJECT, title)
                    .addFlags(Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET)
                    .addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION)
                ,
                title
            )
        );
}

// working but not ok, unexpected results!
private void doTestSend2(Uri uri, String type, CharSequence title) {
    startActivity(
            Intent.createChooser(
                new Intent(Intent.ACTION_SEND)
                    .setDataAndType(uri, type)
                    .putExtra(Intent.EXTRA_STREAM, uri)
                    .putExtra(Intent.EXTRA_SUBJECT, title)
                    .addFlags(Intent.FLAG_ACTIVITY_CLEAR_WHEN_TASK_RESET)
                    .addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION)
                ,
                title
            )
        );
} 
```

# php - 统计 RSS 提要的订阅者

> ID：13435663
> 
> 赞同：0
> 
> 时间：2012-11-17T23:03:15.720
> 
> 标签：php, rss, feed, feedburner, subscribe

在 Google 决定关闭 feedburner 的 API 后，我在网上搜索了另一种显示 RSS 提要当前订阅者的方式，但没有成功。

如果没有旧的 feedburner API，有没有办法在 PHP 中做到这一点？

# facebook-graph-api - 使用图形 api 隐藏帖子

> ID：13435670
> 
> 赞同：2
> 
> 时间：2012-11-17T23:05:31.363
> 
> 标签：facebook-graph-api, curl

我已经发布了创建调用图 api

```
https://graph.facebook.com/me/feed/?access_token=<token> 
```

它返回类似： {"id":"<UID>_<POST_ID>"}

现在我想通过 api 调用隐藏这篇文章

```
curl -F "is_hidden=true" "https://graph.facebook.com/<POST_ID>?access_token=<token> 
```

但我得到了这样的回应：

```
{"error":{"message":"(#100) The parameter reorder_pids is required", "type": "OAuthException", "code":100}} 
```

这里有人为此使用api吗？（隐藏帖子）如果是，它对你有用吗？;)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-02T07:59:37.757

I found a way to hide the post from facebook page.

```
curl -F "timeline_visibility=hidden" "https://graph.facebook.com/<POST_ID>/?access_token=<page_token> 
```

...and it return true.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-19T15:40:49.530

它仅在帖子由非管理员用户发布时才有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T19:56:30.447

事后真的有可能更新帖子的隐私吗？我不确定。

您可以在初始创建时设置隐私字段。

```
 privacy={'value':'SELF'} 
```

看

[http://developers.facebook.com/docs/reference/api/post/](http://developers.facebook.com/docs/reference/api/post/) 和 [http://developers.facebook.com/docs/reference/privacy-parameter/](http://developers.facebook.com/docs/reference/privacy-parameter/)

# c++ - 自定义 QWidget 在与主函数不同的文件中

> ID：13435675
> 
> 赞同：3
> 
> 时间：2012-11-17T23:06:20.600
> 
> 标签：c++, qt

我有一个关于 Qt 自定义小部件的小问题。

在[http://doc.qt.digia.com/4.3/tutorial-t4.html](http://doc.qt.digia.com/4.3/tutorial-t4.html)和[http://doc.qt.digia.com/4.3/tutorial-t8.html](http://doc.qt.digia.com/4.3/tutorial-t8.html)中，自定义窗口声明都是在*main.cpp*文件，其中*qApp*指针是可访问的（在第二个链接中，更多的小部件在他们自己的文件中声明）。

窗口不能在另一个不同的文件中完成并将*qApp*指针传递给它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:12:18.973

是的，可以在另一个文件中创建主窗口。您主要需要创建`QApplication`并展示您包含的内容。然后启动事件循环。

您不必在`qApp`任何地方传递指针。它是对唯一可以运行的单个应用程序的全局引用。只需在任何其他文件中包含`QApplication`.

另请注意，这些教程适用于旧的 Qt 4.3（除非您现在必须使用该版本）。您可以[在此处找到 Qt 4.8 的教程](http://qt-project.org/doc/qt-4.8/tutorials.html)

# r - R图中时间数据的天刻度

> ID：13435676
> 
> 赞同：1
> 
> 时间：2012-11-17T23:06:20.973
> 
> 标签：r, plot

我有一个带有温度数据和读取时间的框架。它看起来像这样：

```
> head(dx)
                       t Temp
1218 2012-11-13 00:01:15   79
1219 2012-11-13 00:07:19   80
1220 2012-11-13 00:15:19   78
1221 2012-11-13 00:22:57   82
1222 2012-11-13 00:30:25   78
1223 2012-11-13 00:43:19   75
...
> tail(dx)
                       t Temp
2240 2012-11-17 13:37:19  106
2241 2012-11-17 13:43:23  106
2242 2012-11-17 13:49:25  106
2243 2012-11-17 13:55:25  106
2244 2012-11-17 14:00:00  107
2245 2012-11-17 14:06:23  107 
```

我想在图表中显示它，每天都有刻度。我用

```
plot(dx$t, dx$Temp/10) 
```

显示数据，效果很好，但是 x 轴上显示的刻度太少了。我想每天显示一个刻度。最好的方法是什么？有很多问题的要求略有不同，所以我迷路了。如果已经问过这个问题，我会很感激一个链接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:25:22.440

这是使用基本图实现此目的的一种方法，但正如贾斯汀建议的那样，您还可以查看为绘制日期对象提供额外灵活性的包，例如`zoo`和`xts`。

```
t <- seq(ISOdatetime(2012,1,1,11,10,25), ISOdatetime(2012,03,31,11,10,25), "hours")
dx <- data.frame(t=t, Temp=runif(length(t)))
plot(dx$t, dx$Temp/10, xaxt='n')
axis(1, at=as.POSIXct(unique(format(dx$t, '%Y-%m-%d')), format='%Y-%m-%d'),
     labels=unique(format(dx$t, '%Y-%m-%d'))) 
```

# java - RequestDispatcher 是否可以在一个 servlet 容器中处理多个 Web 应用程序？

> ID：13435678
> 
> 赞同：1
> 
> 时间：2012-11-17T23:06:40.347
> 
> 标签：java, tomcat, servlets, requestdispatcher

RequestDispatcher 是否可以在多个 webapps 上工作？

我之所以问，是因为我有一个使用 RequestDispatcher 而不是重定向的 webapp 运行良好，因此在显示错误和反馈消息时状态不会丢失。

但是我现在需要在两个 webapps 之间拆分一些功能，所以初始调用是从 webapp1 上托管的网页进行的，调用 webapp2 最终将用户返回到 webapp1 上托管的页面。

显然，如果 webapps 和 webapp2 使用 RequestDispatcher 在不同的网站上是不可能的，但是如果两个 webapps 都部署在同一个 servlet 容器实例中（tomcat 7）

**更新**

让请求调度程序部分按照答案中的说明工作，但无法检索放入我的 webapp2 的数据，这就是我使用它的原因

IE

webapp2 调用，进行一些处理，然后分派到 webapp1 上的 jsp

```
protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException
{

    HttpSession userSession = request.getSession(true);
    String emailAddress = ......
    String nextPage     = /finish.jsp
    userSession.setAttribute("DATA", emailAddress);
    ServletContext otherContext = getServletContext().getContext("/webapp1");
    otherContext.getRequestDispatcher(nextPage).forward(request, response); 
} 
```

webapp2 jsp 文件包含

```
...
<p>Email(<%=((String)session.getAttribute("DATA"))%>)</p>
... 
```

但总是显示空

****更新 2 ******

 **我想知道我是否误解了 crossContext="true" 的实际作用。它是否使相同的 HttpSession 在不同的 webapps 中可用，或者它只是使 ServletContext 从一个 webap 可用到另一个，从而允许一个 webapp 看到另一个 webapp 的 HttpSessions？

我开始认为我正在做的事情是个坏主意，因为我一直热衷于使用 vanilla servlet 设置，并且从不想将自己束缚于特定的实现。我认为如果我解释为什么我一开始就不需要拆分 webapps 可能会有所帮助。

我有一个 webapp (webapp1)，这是一个关于我开发的产品的网站，以及使用 Google Checkout（现在的 Google Wallet）购买该产品的代码。

然后我添加了为新产品（webapp2）创建了一个新的 webapp。

然后，我尝试将新产品的 Google Checkout 添加到 webapp2 中，但意识到我不能轻易做到这一点，因为 Google Checkout 要求我提供一个 URL，一旦它处理了付款，它就可以由应用程序调用，这样我就可以向用户发送一个执照。该 url 已经设置为 webapp1 中的一个 servlet，但是 webapp1 处理产品 2 的付款是没有意义的。

一种选择是将 webpp1 和 webapp2 合并到一个 webapp 中，但这违背了我保持模块化的一般观点，这也意味着每次我想为一个产品 Id 进行更改时都必须重新部署所有内容。这也意味着对 webapp1 的重大修改，我真的不想修改它，因为它工作且稳定。

另一种方法是创建 webapp3，然后 google url 可以指向它，并使用它来处理产品 1 和产品 2 的购买，这就是我所做的。但问题是购买产品 1 时，起始页面位于 webapp1 中，一旦购买完成，我想返回 webapp1 中的页面，但只有 webapp3 有我想要的刚刚购买的用户的详细信息在 webapp1 的页面上显示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:31:40.890

这是由于安全原因，默认情况下是不可能的。您需要先配置 Tomcat 以启用将`ServletContext`当前 webapp 暴露给其他 webapps。这是通过设置to[的`crossContext`属性`context.xml`](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html)来完成的`true`。

```
<Context ... crossContext="true"> 
```

完成后，您可以使用[`ServletContext#getContext()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getContext%28java.lang.String%29)通过其上下文路径获取另一个 servlet 上下文，最后使用`RequestDispatcher`通过[`ServletContext#getRequestDispatcher()`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getRequestDispatcher%28java.lang.String%29)通常方式获得的 。

例如

```
ServletContext otherContext = getServletContext().getContext("/otherContext");
otherContext.getRequestDispatcher("/WEB-INF/some.jsp").forward(request, response); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:20:22.997

是的。

您需要做的第一件事是`ServletContext`为另一个 webapp 获取一个。你可以[`ServletContext::getContext`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getContext%28java.lang.String%29)自己做`ServletContext`，传递另一个 webapp 的上下文路径。

然后，您只需[`ServletContext::getRequestDispatcher`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getRequestDispatcher%28java.lang.String%29)在外国环境中照常行事。

我实际上还没有尝试过，但我 100% 保证它会起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-09T13:18:25.617

我不确定不同的 servlet 容器。但它通过使用 **getServletContext().getContext()**方法适用于同一个容器。

首先，您需要在以下文件中进行更改

(Windows) C:\Program Files\Apache Software Foundation\Tomcat 7.0\conf\context.xml 将 crossContext 的值设置为 true。

**上下文.xml**

```
<Context crossContext="true">

    <!-- Default set of monitored resources -->
    <WatchedResource>WEB-INF/web.xml</WatchedResource>

    <!-- Uncomment this to disable session persistence across Tomcat restarts -->
    <!--
    <Manager pathname="" />
    -->

    <!-- Uncomment this to enable Comet connection tacking (provides events
         on session expiration as well as webapp lifecycle) -->
    <!--
    <Valve className="org.apache.catalina.valves.CometConnectionManagerValve" />
    -->

</Context> 
```

请注意**crossContext="true"**。

假设您有两个名为*InterServletComm1*和*InterServletComm2*的 Web 应用程序，每个 Web 应用程序中分别 有 Servlet *Servlet1*和*Servlet1*。然后每个 servlet 中的代码如下：

**Servlet1.java**

```
package interServletComm1;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class Servlet1
 */
@WebServlet("/Servlet1")
public class Servlet1 extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * @see HttpServlet#HttpServlet()
     */
    public Servlet1() {
        super();
        // TODO Auto-generated constructor stub
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException 
    {
        response.setContentType("text/html");
        PrintWriter pw = response.getWriter();

        request.setAttribute("name", "WebApp1");
        ServletContext context = getServletContext().getContext("/InterServletComm2");
        RequestDispatcher rd = context.getRequestDispatcher("/Servlet2");
        rd.forward(request, response);
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
    }

} 
```

**Servlet2.java**

```
package interServletComm2;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet implementation class Servlet2
 */
@WebServlet("/Servlet2")
public class Servlet2 extends HttpServlet {
    private static final long serialVersionUID = 1L;

    /**
     * @see HttpServlet#HttpServlet()
     */
    public Servlet2() {
        super();
        // TODO Auto-generated constructor stub
    }

    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException 
    {
        response.setContentType("text/html");
        PrintWriter pw = response.getWriter();
        String name = (String) request.getAttribute("name");
        pw.println("This is web application 2.");
        pw.println("<br>The value received from web application one is: " + name);
    }

    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // TODO Auto-generated method stub
    }

} 
```

上面的代码从*InterServletComm1*发送属性*名称*，并在*InterServletComm2*中接收。如果这个答案不清楚，请告诉我。**

# java - 找不到符号：parseInt

> ID：13435680
> 
> 赞同：4
> 
> 时间：2012-11-17T23:06:43.967
> 
> 标签：java, parseint

我已经用java编译了一些小程序，一切都很好。但是我的新代码有任何问题。

```
class myclass
{
 public static void main (String[] args)
 {
  int x, y;
  String s ="sssss";
  x=args.length;
  s= args[0].substring(1,2);
  System.out.println("Num of args: "+x);
  System.out.println("List of args:");
  y = parseInt(s,5);
  }
} 
```

编译器说：

```
 e:\java\4>javac myclass.java 
  myclass.java:11: error: cannot find symbol   
   y = parseInt(s,5);
       ^   symbol:   method parseInt(String,int)   location: class myclass 1 error

 e:\java\4> 
```

奇怪的是编译器跳过了方法子字符串（因为没有问题）但是方法 parseInt 似乎有任何问题。y = parseInt(s); 或： y = parseInt("Hello"); --> 也是同样的编译信息。

还是该方法不存在？[docs.oracle-->整数](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Integer.html)表示它存在:)

这让我真的很疯狂**，因为我不知道如何搜索错误**。我已经检查了互联网，我检查了类路径和路径......

因此，如果任何专家可以帮助我，那就太好了。:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-17T23:08:32.887

[**parseInt**](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/Integer.html#parseInt%28java.lang.String%29)是**Integer**类**中的静态**方法你需要这样称呼它：

 **```
 y = Integer.parseInt(s,5); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:08:40.403

您正在尝试访问`Integer`该类的静态方法

你必须这样做：

```
y = Integer.parseInt(s,5); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T23:16:45.967

`parseInt`是 Integer 类的静态方法。要调用它，您必须执行以下操作之一：

*   在 Integer 类上调用它

    ```
    Integer.parseInt(s, 5) 
    ```

*   在整数引用上调用它

    ```
    Integer i = null;//yes reference can be even null in this case
    i.parseInt(s, 5); 
    ```

*   或避免前两个选项使用静态导入（如`import static java.lang.Integer.parseInt;`. 这样您就可以使用该方法，例如

    ```
    y = parseInt(s,5); 
    ```**

# java - 无效的条目压缩大小

> ID：13435683
> 
> 赞同：7
> 
> 时间：2012-11-17T23:07:10.937
> 
> 标签：java, exception, jar, java-bytecode-asm

我正在使用一个称为 ASM 的字节码库来更改类文件，然后我想将每个类文件写回一个 jar 文件，而不是一个充满类文件的文件夹。我通过运行以下代码来做到这一点：

当 ZipException 因不是预期的大小而被抛出时，我的问题就会出现，即

```
java.util.zip.ZipException: invalid entry compressed size (expected 695 but got 693 bytes)
    at java.util.zip.ZipOutputStream.closeEntry(Unknown Source)
    at org.steinburg.client.accessor.Accessor.accessJar(Accessor.java:64)
    at org.steinburg.client.accessor.Accessor.<init>(Accessor.java:41)
    at Loader.main(Loader.java:5)

package org.steinburg.client.accessor;

import java.io.DataInputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.util.Enumeration;
import java.util.jar.JarEntry;
import java.util.jar.JarFile;
import java.util.jar.JarOutputStream;

import org.objectweb.asm.ClassReader;
import org.objectweb.asm.ClassWriter;

public class Accessor {

private String input;
private File inFile;
private JarEntry jarEntry;
private JarFile jarFile;
private Enumeration<JarEntry> entries;
private InputStream is;

private String out;
private File outFile;
private FileOutputStream fos;
private JarOutputStream jos;

private byte[] bytes;

public Accessor(){
    try{
        input = new String("Input Jar.jar");
        inFile = new File(input);
        jarFile = new JarFile(inFile);
        entries = jarFile.entries();
        out = new String("Output Jar.jar");
        outFile = new File(out);
        fos = new FileOutputStream(outFile);
        jos = new JarOutputStream(fos);
        accessJar();
    } catch (Exception e) {
        e.printStackTrace();
    }
}

protected final void accessJar(){
    try {
        while (entries.hasMoreElements()){
            jarEntry = entries.nextElement();
            is = jarFile.getInputStream(jarEntry);
            if (jarEntry.getName().endsWith(".class")){
                ClassReader cr = new ClassReader(is);
                ClassWriter cw = new ClassWriter(cr, 0);
                FieldAdapter fa = new FieldAdapter(cw);
                cr.accept(fa, 0);
                bytes = cw.toByteArray();
            } else {
                bytes = readBytes(is);
            }
            JarEntry je = new JarEntry(jarEntry);
            jos.putNextEntry(je);
            jos.write(bytes);
            jos.closeEntry();
        }
        jos.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
}

protected byte[] readBytes(InputStream inputStream){
    try{
        DataInputStream reader = new DataInputStream(inputStream);
        byte[] toReturn = new byte[reader.available()];
        reader.readFully(toReturn);
        reader.close();
        return toReturn;
    } catch (Exception e){
        e.printStackTrace();
        return null;
    }
}

} 
```

ClassReader、ClassWriter（库的每个部分）和 FieldAdapter（我自己制作）只是祭坛代码，为了获取整个类的字节，我使用 cw.toByteArray()。字节码操作本身没有问题，它只是通过 JarOutputStream 写入一个新的 jar 文件。任何人都知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T01:00:01.543

有问题的行是这样的：

```
JarEntry je = new JarEntry(jarEntry); 
```

因为它也会复制压缩后的大小。

除非您关心保留名称以外的其他字段，否则您应该使用[此构造函数](http://docs.oracle.com/javase/6/docs/api/java/util/jar/JarEntry.html#JarEntry%28java.lang.String%29)并仅提供文件名，如下所示：

```
JarEntry je = new JarEntry(jarEntry.getName ()); 
```

然后将自动计算压缩后的大小。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-02-27T13:15:41.790

这样做不会复制 Jar Attributes 和其他元信息。该问题是在最初打包后修改 jar/zip 文件时引起的。

你可以这样做：

```
JarEntry je = new JarEntry(jarEntry);
je.setCompressedSize(-1); 
```

这将导致重新计算条目的大小，并且您将从原始 jarEntry 复制所有其他属性

# java - 我的代码的每一部分都需要 JavaDoc/Comments 吗？

> ID：13435684
> 
> 赞同：3
> 
> 时间：2012-11-17T23:07:18.270
> 
> 标签：java, comments, javadoc, checkstyle

我正在为大学最后一年的 CS 本科项目编写 Java 应用程序。在过去的几年里，我们被告知在我们的代码中使用 CheckStyle 是必须的。但是，我发现使用默认的 CheckStyle 配置需要我为每一件事编写一个 JavaDoc。即使是名称和实际代码足以描述这段代码的作用的明显实例字段和方法，也需要我编写 JavaDoc 注释。

老实说，我发现这是重复的，只是弄乱了我的代码。如果没有所有这些注释，我会发现我的代码更具可读性和更短，当我需要查看类等时，这给了我更好的概览。

问题是，如果 checkstyle 将其突出显示为一个问题（缺少 JavaDoc），并且我们被告知要毫无例外地使用 CheckStyle，那么我怀疑我会失去分数，这是我最不想做的事情。我引用了这本优秀的书：Martin, Robert C. (2008-08-01)。清洁代码：敏捷软件工艺手册（第 54 页）。培生教育（美国）。

> 正确使用注释是为了弥补我们在代码中表达自己的失败。请注意，我使用了失败这个词。我是认真的。评论总是失败的。我们必须拥有它们，因为没有它们我们无法始终弄清楚如何表达自己，但使用它们并不是值得庆祝的理由。因此，当您发现自己处于需要写评论的位置时，请仔细考虑一下，看看是否没有办法扭转局面并用代码表达自己。每次在代码中表达自己时，都应该拍拍自己的后背。每次写评论，你都应该做鬼脸，感受一下自己表达能力的失败。为什么我对评论如此失望？因为他们撒谎。并非总是如此，也不是故意的，而是太频繁了。注释越旧，离它描述的代码越远，它越有可能是完全错误的。原因很简单。程序员实际上无法维护它们。

我不能说我是多么全心全意地同意上述观点。评论在我眼里不过是一团糟。在相关的地方，我确实有意见。

因此，我的问题归结为以下几点：我应该坚持自己的信念和通过阅读上述书籍获得的知识/建议，还是应该遵守 CheckStyle 标准并消除因缺乏 JavaDoc 注释而被标记的风险?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T23:42:02.023

你说：

> 但是，我发现使用默认的 CheckStyle 配置需要我为每一件事编写一个 JavaDoc。即使是名称和实际代码足以描述这段代码的作用的明显实例字段和方法，也需要我编写 JavaDoc 注释。

并且：

> 我确实问过我的主管，他说最好坚持 Sun 的建议，即默认的 checkstyle 配置。

这两种说法并不一致。

这是实际的、传统的、古老的 Sun 编码约定文件（1999 年修订）：

*   [http://www.oracle.com/technetwork/java/codeconvtoc-136057.html](http://www.oracle.com/technetwork/java/codeconvtoc-136057.html)

[评论部分](http://www.oracle.com/technetwork/java/javase/documentation/codeconventions-141999.html)确实说：

> 讨论不平凡或不明显的设计决策是合适的，但要避免重复出现在代码中（并从代码中清除）的信息。多余的评论太容易过时了。一般来说，避免任何可能随着代码发展而过时的注释。

它并不是说每个成员都需要评论。

我认为这很清楚地表明，“明显的实例字段”或“名称和实际代码足以描述那段代码的作用的方法”不需要注释。您的主管的指令或您对它的解释在将 Sun 编码约定与默认 Checkstyle 配置等同起来时都会出错。

还值得牢记的是，Sun 编码约定是由编写 Java 本身的程序员编写的，并且是为*编写 Java 本身*的程序员编写的。那是一种非常特殊的工作；他们不仅需要生成有效的代码，并且维护者可以理解，还因为他们正在制作一个标准库，该标准库只能以二进制形式分发，这是可以理解的，并且在许多情况下完全指定，通过签名和单独评论。我认为将 1990 年代为实现 Java 本身开发的规则应用于今天编写的应用程序代码是非常愚蠢的。这就像按照利未记的方式过你的生活。

# compilation - 编译 Fortran 外部符号

> ID：13435686
> 
> 赞同：3
> 
> 时间：2012-11-17T23:07:40.830
> 
> 标签：compilation, fortran, symbols

将 fortran 代码编译成目标文件时：编译器如何确定符号名称？

当我使用内部函数“getarg”时，编译器会将其转换为名为“_getarg@12”的符号

我查看了外部库，发现里面的符号名称叫做“_getarg@16”，“getarg”末尾的“@[number]”是什么意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T17:08:08.017

`_name@length`是高度特定于 Windows 的名称修饰，应用于遵循`stdcall`（或`__stdcall`通过 C 中使用的关键字的名称）调用约定的例程名称，这是 Pascal 调用约定的变体。这是所有 Win32 API 函数都使用的调用约定，如果您查看 DLL 的导出表，`KERNEL32.DLL`您`USER32.DLL`会发现所有符号都是这样命名的。

`_...@length`装饰给出了例程参数占用的字节数。这是必要的，因为在`stdcall`调用约定中，是被调用者从堆栈中清理参数，而不是调用者，就像 C 调用约定的情况一样。`func`当编译器使用两个 4 字节参数生成一个调用时，它会将一个引用`_func@8`放入目标代码中。如果 real`func`碰巧有不同数量或大小的参数，它的修饰名称会有所不同，例如`_func@12`，因此会发生链接错误。这对于动态库 (DLL) 非常有用。想象一下，一个 DLL 被另一个版本替换，该版本`func`需要一个额外的参数。如果不是因为名字修饰（前置的技术术语`_`并添加`@length`到符号名称），程序仍然会`func`使用错误的参数调用，然后`func`会增加堆栈指针的字节数，而不是传递的参数列表的大小，从而破坏调用者。使用名称修改，加载程序根本不会启动可执行文件，因为它无法解析对`_func@8`.

在您的情况下，看起来外部库并不是真正打算与此编译器一起使用，或者您缺少一些编译指示或编译器选项。内在函数有`getarg`两个参数——一个整数和一个假定大小的字符数组（字符串）。一些编译器将字符数组大小作为附加参数传递。对于 32 位代码，这将导致 2 个指针和 1 个整数被传递，总共 12 个字节的参数，因此`_getarg@12`. 例如，`_getarg@16`可以是 64 位例程，其中字符串由某种描述符传递。

正如 IanH 在他的评论中提醒我的那样，这种命名差异的另一个原因可能是您调用`getarg`的参数比预期的要少。Fortran 具有“无原型”例程调用的这一特殊功能 - Fortran 编译器可以在不知道其签名的情况下生成对例程的调用，这与 C/C++ 中必须以函数原型的形式提供显式签名不同。这是可能的，因为在 Fortran 中，所有参数都是通过引用传递的，并且指针的大小始终相同，无论它们指向的实际类型如何。在这种特殊情况下，`stdcall`名称修饰扮演了非常粗糙的参数检查机制的角色。如果不是为了修饰（例如在带有 GNU Fortran 的 Linux 上没有使用这种装饰，或者默认调用约定是`cdecl`) 可以调用具有与预期不同数量的参数的例程，并且链接器会愉快地将目标代码链接到一个可执行文件中，该可执行文件很可能在运行时崩溃。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T07:41:51.633

这完全取决于实现。你没有说，你使用哪个编译器。对于不同的整数或字符类型，（非标准）内在函数可以存在于更多版本中。对于更多的计算机体系结构（例如 32 位和 64 位），还可以有更多版本的运行时库。

# scala - 将 emacs 连接到远程 ensime 服务器

> ID：13435687
> 
> 赞同：10
> 
> 时间：2012-11-17T23:07:42.357
> 
> 标签：scala, emacs, ensime

如何连接到远程主机上的 ensime 服务器？对于那种东西，我的上网本有点慢。我复制了数据并使用 tramp 远程编辑文件。我跑去`bin/server`创建服务器和 ssh 转发以便能够连接到它。我`ensime-connect`用来连接到本地主机上的端口。远程服务器上的 ensime 服务器回答为`Got connection, creating handler...`，但仅此而已。Ensime 在`[ENSIME: wtf]`emacs 状态行中处于模式。我该如何解决？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T17:15:57.823

问题是 ensime 找不到连接的“配置”（通过 ensime-connect 进行）。

然后以下行将引发错误：

```
(if (and loose (ensime-file-in-directory-p file project-root)) 
```

因为项目根是零。

通过将连接设置为 ensime-buffer-connection，可以解决问题。尝试将以下功能添加到您的 ensime.el

并使用`ensime-stackoverflow-connect`连接。

```
(defun ensime-stackoverflow-connect (host port)
  (interactive (list
        (read-from-minibuffer "Host: " ensime-default-server-host)
        (read-from-minibuffer "Port: " (format "%d" ensime-default-port)
                      nil t)))
  (let ((c (ensime-connect host port))
    (config (ensime-config-load "/Users/whunmr/lab/scala/.ensime")))
    (ensime-set-config c config)
    (setq ensime-buffer-connection c))
  ) 
```

记得更改代码中的配置路径：“/Users/whunmr/lab/scala/.ensime”

**EDIT1：** “.ensime”文件是由 Mx ensime 命令在您的 scala 项目文件夹中创建的。实际上，只需对配置进行硬编码，您就可以忽略该文件。

```
(defun ensime-my-connection (host port)
      (interactive (list
            (read-from-minibuffer "Host: " ensime-default-server-host)
            (read-from-minibuffer "Port: " (format "%d" ensime-default-port)
                          nil t)))
      (let ((c (ensime-connect host port))
        (config '(:project-name "test" :project-package "com.whunmr" :sources ("./src") :compile-jars ("./" "../../apps/scala/lib/") :target "./bin" :root-dir "/Users/twer/lab/scala/")))
        (ensime-set-config c config)
        (setq ensime-buffer-connection c))
      ) 
```

# javascript - Firefox 中的 Html5 拖放鼠标位置

> ID：13435690
> 
> 赞同：5
> 
> 时间：2012-11-17T23:07:55.490
> 
> 标签：javascript, html, drag-and-drop

我有一个使用拖放的 HTML5 应用程序。本质上，用户可以将图像从“抽屉”拖到画布上以创建更大的图像。我希望元素落在它们被释放的地方。我可以在除 Firefox 之外的所有浏览器中使用此功能。

在`drop`事件中，我使用以下内容来获取鼠标的坐标，并计算画布中放置的图像的位置。

```
var top = evt.originalEvent.offsetX;
var left = evt.originalEvent.offsetY; 
```

问题是，这个属性在 FF 中不可用。有没有其他方法可以得到这个？没有它，我看不到如何在 FF 中拖动和移动元素。

注意：我没有使用 canvas 元素。我正在将图像放到一个 div 中。不确定这是否重要。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T10:28:42.130

Try this in firefox..

```
var X = event.layerX - $(event.target).position().left;
var Y = event.layerY - $(event.target).position().top; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-12-27T11:52:59.780

我尝试使用`layerX`，`layerY`但神秘的是它们与 Chrome 中的相同值不同。

然后我意识到**在 Retina 显示器上 Firefox`setDragImage`不会考虑比例**。
换句话说，调用`setDragImage(div, 10, 10)`会将光标放在`5px; 5px`点上。

荒谬，不是吗？

```
var originalEvent = e.originalEvent,
  offsetX = originalEvent.offsetX,
  offsetY = originalEvent.offsetY;

if (_.isUndefined(offsetX) || _.isUndefined(offsetY)) {
  // Firefox doesn't take scale into account so we need to compensate for it
  offsetX = originalEvent.layerX * (window.devicePixelRatio || 1);
  offsetY = originalEvent.layerY * (window.devicePixelRatio || 1);
}

originalEvent.dataTransfer.setDragImage(el, offsetX, offsetY); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-12T00:20:03.500

我在上面尝试了 Kathirvans 的回答，但它对我不起作用。我的页面的魔药是...

```
var x = e.originalEvent.pageX - $(this).offset().left;
var y = e.originalEvent.pageY - $(this).offset().top; 
```

# ios - 压缩 PNG 以与 CIFilter 一起使用

> ID：13435691
> 
> 赞同：4
> 
> 时间：2012-11-17T23:07:56.350
> 
> 标签：ios, compression, png, cifilter

我有一个 iPhone 应用程序，它使用 CIFilter CIHardLightBlendMode 在由 XIB 创建的视图上覆盖图像。视图是 1000x1000 像素，我想保持这个大小直到结束。如果有任何复杂性，这会使图像文件大约 1 MB 作为 png。

我尝试过使用 JPG，但它不会将图像叠加到设备上的视图上（它适用于模拟器）。我试过压缩PNG，但是当它们覆盖在视图上时会出现乱码（在覆盖之前它们看起来与全质量的相同）。此外，当 XCode 将 PNG 重新压缩到特殊的 iOS 版本时，压缩大小的节省会丢失。

我真的很想稍微压缩文件，但我不确定 CIFilter 可以使用什么。有小费吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T03:57:55.137

感谢这篇文章——[聪明的 PNG 优化技术](http://www.smashingmagazine.com/2009/07/15/clever-png-optimization-techniques/)——我发现了一个减少文件大小的技巧。

海报化将文件大小从 1.3 MB 减少到 458 KB（XCode 优化后为 326 KB！）。这是一笔巨大的节省。我的照片（纹理）可能会被严重分色，所以我不确定这在其他情况下是否也能正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-07T22:47:42.573

如果您对减小压缩图像文件大小的新方法感兴趣，我创建了一个 iOS 框架，可以将 PNG 图像压缩成更紧凑的形式，称为[PNGSquared](http://pngsquared.com/)。这有点像后处理方法，但您可以更好地控制质量。

# c# - C# 控制台应用程序失去焦点

> ID：13435693
> 
> 赞同：0
> 
> 时间：2012-11-17T23:08:04.217
> 
> 标签：c#, windows, scheduled-tasks, console-application

我的本地 PC 上有大约 15 个不同的控制台应用程序，它们以不同的时间段作为计划任务运行。

由于我将此计算机用作个人用途（例如在 YouTube 上冲浪或观看电影），它们在我的屏幕上跳跃，但我必须始终手动将它们最小化。

我的目标是，我希望它们首先出现（已经在这样做）并在几秒钟后自动失去焦点。

是否可以在 Windows 上使用控制台应用程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T23:13:33.543

如果要最小化控制台窗口，可以使用 WinApi

```
const Int32 SW_MINIMIZE = 6;

[DllImport("Kernel32.dll", CallingConvention = CallingConvention.StdCall, SetLastError = true)]
private static extern IntPtr GetConsoleWindow();

[DllImport("User32.dll", CallingConvention = CallingConvention.StdCall, SetLastError = true)]
[return: MarshalAs(UnmanagedType.Bool)]
private static extern bool ShowWindow([In] IntPtr hWnd, [In] Int32 nCmdShow);

private static void MinimizeConsoleWindow()
{
    IntPtr hWndConsole = GetConsoleWindow();
    ShowWindow(hWndConsole, SW_MINIMIZE);
} 
```

用法：

```
static void Main(string[] args)
{
    Console.WriteLine("Starting foo...");
    Thread.Sleep(1000); // hold console for a second on the screen
    MinimizeConsoleWindow();
    Console.ReadKey();
} 
```

# ios - 以百分比形式查看维度

> ID：13435697
> 
> 赞同：0
> 
> 时间：2012-11-17T23:08:41.353
> 
> 标签：ios, views

我需要根据设备分辨率设置按钮、标签和视图的位置。如何在界面生成器中将按钮和其他视图尺寸设置为百分比？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T19:42:43.210

如果您只有 2 个元素，则在 IB 中使用普通的“弹簧和结构”就足够了。它们与在 a 上设置的
完全匹配。 `UIViewAutoresizing``UIView`

如果这还不够，你将不得不使用它们的超级视图的“bounds.size”在你的方法中使用`IBOutlet`和计算它们的大小和位置。`viewDidLoad`

* * *

`[[UIScreen mainScreen] applicationFrame]`将返回您的屏幕大小`point`。它将在屏幕坐标系中为您提供框架或应用程序根视图。因此，如果您有一个状态栏，您的原点将是 (0, 20)。

但同样，您应该检查放置元素的超级视图的大小，以确定元素的定位。 `myView.superView.bounds.size.height * 0.8;`

如果您真的真的很想知道您所在屏幕的像素分辨率（这是一个非常非常非常糟糕的主意），那么 UIView 有一个属性调用`contentScaleFactor`，但除非您正在做一些非常低级的绘图，否则您永远不要担心自己有了这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:10:28.980

不，你不能。也许还有另一种方法可以完成你想要的，所以你应该详细说明你正在尝试做什么。

# wpf - 为什么 WPF 进度条不能拉伸以适应？

> ID：13435699
> 
> 赞同：8
> 
> 时间：2012-11-17T23:09:33.930
> 
> 标签：wpf, alignment, stackpanel

这是我的原始代码：

```
<StackPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" Orientation="Horizontal">
        <ProgressBar Height="23" Name="searchProgressBar" Foreground="Blue" BorderBrush="#00000000" BorderThickness="1" VerticalAlignment="Top" HorizontalAlignment="Stretch"/>
        <TextBlock Text="asdf" Height="23"  Name="progressTextBlock" VerticalAlignment="Top" Foreground="Red" HorizontalAlignment="Right"/>
</StackPanel> 
```

进度条非常小，大概有 2 或 3 个像素宽，然后是文本块和后面的空白区域。因此，我尝试将元素显式停靠在两侧：

```
<DockPanel Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2" >
            <ProgressBar DockPanel.Dock="Left" Height="23" Name="searchProgressBar" Foreground="Blue" BorderBrush="#00000000" BorderThickness="1" VerticalAlignment="Top" />
            <TextBlock DockPanel.Dock="Right" Text="asdf" Height="23"  Name="progressTextBlock" VerticalAlignment="Top" Foreground="Red" HorizontalAlignment="Right"/>
</DockPanel> 
```

徒劳无功。我还尝试通过设置`HorizontalAlignment="Stretch"`进度条来修改每个解决方案，但没有任何变化。如何拉伸它以填充文本块渲染后的所有空间？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T23:16:29.043

`DockPanel.Dock="Left"`从 中删除`ProgressBar`并切换控件的顺序：

```
<DockPanel>
    <TextBlock DockPanel.Dock="Right" Height="23"  VerticalAlignment="Top" HorizontalAlignment="Right"/>
    <ProgressBar Height="23" VerticalAlignment="Top" />
</DockPanel> 
```

默认情况下，`DockPanel`将其属性`LastChildFill`设置为`true`，这将`ProgressBar`占用可用空间。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T19:49:22.017

啊，我明白你在做什么。这可能是使用具有 2 列定义的网格的更好地方。Width="*" 的第一个（左侧）列定义和宽度设置为 Width="Auto" 的第二个（右侧）列定义。有关汽车与 * 的更多信息，请参阅[http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/9a7e6591-1fae-4295-b68a-be97e8e53d06/](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/9a7e6591-1fae-4295-b68a-be97e8e53d06/)

# google-chrome - 在 Windows 上运行的 Google Chrome 推送通知？

> ID：13435700
> 
> 赞同：2
> 
> 时间：2012-11-17T23:09:42.477
> 
> 标签：google-chrome, google-chrome-extension, push-notification

我通常在本地和 RDP 会话 50/50 中工作。我在本地和终端会话中启动了两个 Google Chrome。我厌倦了来回复制和粘贴 URL。我想为 Chrome 做一个扩展，比如流行的扩展 Chrome2phone。但在详细了解 Chrome2phone 的工作原理后，我了解到可能没有像在普通台式计算机上运行的 Chrome 实例的推送通知这样的选项。Chrome2phone 使用 GCM 发送/接收消息。但 GCM 仅适用于 Android 设备。

有谁知道是否可以在不同计算机上运行的两个 Chrome 之间实现推送通知？我知道这是一个非常奇怪的问题，但是..也许有人有这种经历并且可以分享。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T01:21:26.683

如果您已登录 chrome，您也可以使用 Chrome Sync，使用标签同步来解决此问题。只需进入新标签页，查看底部的“其他设备”，即可看到另一台计算机正在查看的标签，然后在此桌面上进行访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T08:17:27.743

现在有。[适用于 Chrome 的谷歌云消息传递](http://developer.chrome.com/dev/apps/cloudMessaging.html)。我想知道它是否可以与 Firefox 甚至桌面应用程序一起使用。

# c# - 简单的注入器打开通用装饰器

> ID：13435701
> 
> 赞同：2
> 
> 时间：2012-11-17T23:09:49.017
> 
> 标签：c#, .net, dependency-injection, ioc-container, simple-injector

我正在尝试利用简单注射器中的一些不错的功能。

我目前在装饰器方面遇到问题，当我期望它们时，它们也没有受到打击。

我正在像这样注册它们：

```
container.RegisterManyForOpenGeneric(
      typeof(ICommandHandler<>),
      AppDomain.CurrentDomain.GetAssemblies());

container.RegisterDecorator(
      typeof(ICommandHandler<>),
      typeof(CreateValidFriendlyUrlCommandHandler<>),
      context => context.ServiceType == typeof(ICommandHandler<CreateProductCommand>)
 );

 container.RegisterDecorator(
      typeof(ICommandHandler<>),
      typeof(CreateProductValidationCommandHandler<>),
      context => context.ServiceType == typeof(ICommandHandler<CreateProductCommand>)
 ); 
```

我想我一定错过了一些东西，因为我期望调用`ICommandHandler<CreateProductCommand>`将在`CreateValidFriendlyUrlCommandHandler<>`运行`CreateProductValidationCommandHandler<>`之前调用。

我尝试过这样的不同注册：

```
container.RegisterManyForOpenGeneric(
      typeof(ICommandHandler<>),
      AppDomain.CurrentDomain.GetAssemblies());

container.RegisterDecorator(
      typeof(ICommandHandler<>),
      typeof(CreateValidFriendlyUrlCommandHandler<>),
      context => context.ImplementationType == typeof(CreateProductCommandHandler)
 );

 container.RegisterDecorator(
      typeof(ICommandHandler<>),
      typeof(CreateProductValidationCommandHandler<>),
      context => context.ImplementationType == typeof(CreateProductCommandHandler)
 ); 
```

正如我所想的那样，当and实现可能会遇到一些循环引用时`ICommandHandler<CreateProductCommand>`，为类型注册一个装饰器。`ICommandHandler<CreateProductCommand>``CreateProductValidationCommandHandler``CreateValidFriendlyUrlCommandHandler``ICommandHandler<CreateProductCommand>`

但改变这一点并没有什么不同。

这是我的`CreateProductValidationCommandHandler<TCommand>`：

```
public class CreateProductValidationCommandHandler<TCommand> 
    : ICommandHandler<CreateProductCommand>
{
    private readonly ICommandHandler<TCommand> decorated;
    private readonly IValidationService validationService;

    public CreateProductValidationCommandHandler(
        ICommandHandler<TCommand> decorated,
        IValidationService validationService)
    {
        this.decorated = decorated;
        this.validationService = validationService;
    }

    public void Handle(CreateProductCommand command)
    {
        if (!validationService.IsValidFriendlyName(
            command.Product.ProductFriendlyUrl))
        {
            command.ModelStateDictionary.AddModelError(
                "ProductFriendlyUrl", 
                "The Friendly Product Name is not valid...");

            return;
        }

        if (!validationService.IsUniqueFriendlyName(
            command.Product.ProductFriendlyUrl))
        {
            command.ModelStateDictionary.AddModelError(
                "ProductFriendlyUrl", 
                "The Friendly Product Name is ...");

            return;
        }
    }
} 
```

这是我的`CreateValidFriendlyUrlCommandHandler<TCommand>`：

```
public class CreateValidFriendlyUrlCommandHandler<TCommand>
    : ICommandHandler<CreateProductCommand>
{
    private readonly ICommandHandler<TCommand> decorated;

    public CreateValidFriendlyUrlCommandHandler(ICommandHandler<TCommand> decorated)
    {
        this.decorated = decorated;
    }

    public void Handle(CreateProductCommand command)
    {
        if (string.IsNullOrWhiteSpace(
            command.Product.ProductFriendlyUrl))
        {
            command.Product.ProductFriendlyUrl = 
                MakeFriendlyUrl(command.Product.Name);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T08:20:43.747

问题是 Simple Injector 永远无法`ICommandHandler<T>`用您的装饰器之一包装实现，因为存在无法解析的泛型类型`TCommand`。`Handle`如果您的装饰器的方法会调用`decorated`实例，您会注意到这一点。例如：

```
public class CreateValidFriendlyUrlCommandHandler<TCommand>
    : ICommandHandler<CreateProductCommand>
{
    private readonly ICommandHandler<TCommand> decorated;

    public CreateValidFriendlyUrlCommandHandler(
        ICommandHandler<TCommand> decorated)
    {
        this.decorated = decorated;
    }

    public void Handle(CreateProductCommand command)
    {
        // This won't compile since CreateProductCommand and
        // TCommand are not related.
        this.decorated.Handle(command);
    }
} 
```

这段代码不会编译，因为装饰器的`Handle`方法接受一个`CreateProductCommand`参数，而`decorated`实例接受一个`TCommand`未指定的参数（并且没有说明`CreateProductCommand`是 a `TCommand`）。

事实上，您根本没有创建装饰器。装饰器包装了它实现的同一接口的实例。你`ICommandHandler<TCommand>`在实现一个`ICommandHandler<CreateProductCommand>`. 让它工作的唯一方法是当你明确指定`TCommand`为 a`CreateProductCommand`时，如下所示：

```
ICommandHandler<CreateProductCommand> handler = 
    new CreateValidFriendlyUrlCommandHandler<CreateProductCommand>(
        new CreateProductCommandHandler()
    ); 
```

尽管如此，Simple Injector 还是无法“猜测”这`TCommand`应该是 a `CreateProductCommand`，这就是为什么您的“装饰器”没有被包装的原因。

长话短说：放弃`TCommand`：

```
public class CreateValidFriendlyUrlCommandHandler
    : ICommandHandler<CreateProductCommand>
{
    private ICommandHandler<CreateProductCommand> decorated;

    public CreateValidFriendlyUrlCommandHandler(
        ICommandHandler<CreateProductCommand> decorated)
    {
        this.decorated = decorated;
    }

    public void Handle(CreateProductCommand command)
    {
        // logic here
    }
} 
```

或者使用类型约束使其通用：

```
 public class CreateValidFriendlyUrlCommandHandler<TCommand>
        : ICommandHandler<TCommand>
        where TCommand : CreateProductCommand
    {
        private ICommandHandler<TCommand> decorated;

        public CreateValidFriendlyUrlCommandHandler(
            ICommandHandler<TCommand> decorated)
        {
            this.decorated = decorated;
        }

        public void Handle(TCommand command)
        {
            // logic here
        }
    } 
```

或删除类型约束并允许处理任何类型的命令，而不仅仅是`CreateProductCommand`.

Note that if you are defining many decorators that can only handle one specific type of command handler, you might want to reconsider your strategy. There might be a problem in your design.

# mysql - MySQL #1005 无法创建表，但不说原因，errno:150

> ID：13435704
> 
> 赞同：0
> 
> 时间：2012-11-17T23:10:18.823
> 
> 标签：mysql, sql, create-table

我正在制作一个包含多个表的数据库，到目前为止，我可以制作这些表，并使用一些演示数据对其进行更新，但是当我尝试制作一个新表来连接我的两个表时，我只是得到了这个不能无论我做什么都会创建表错误。试图将实体重命名为完全不同的名称可能是问题所在，但事实并非如此。

```
CREATE DATABASE IF NOT EXISTS ETR;

CREATE TABLE Hallgato (
OktAzonosito INT(6) PRIMARY KEY,
EHAazonosito VARCHAR(11),
TeljesNev VARCHAR(50),
Szemelyazonosito INT(6),
AnyaNyelv VARCHAR(20),
VegzettsegSzint VARCHAR(25),
AnyjaNeve VARCHAR(35),
SzuletesiHely VARCHAR(30),
SzuletesiEv DATE,
Allampolgarsag VARCHAR(30),
Neme VARCHAR(5),
Adoazonosito INT(6),
TAJszam INT(6),
BankszamlaSzam INT(9)
) ENGINE = InnoDB;

CREATE TABLE OktAdat (
OktAzonosito INT(6),
NyelvVizsgaNyelve VARCHAR(15),
NyVegzesDatuma DATE,
NyIntezmeny VARCHAR(35),
EgyebVegzetteseg VARCHAR(15),
EgyVegzesDatuma DATE,
ID INT(5) PRIMARY KEY NOT NULL auto_increment,
FOREIGN KEY (OktAzonosito) REFERENCES Hallgato(OktAzonosito) ON DELETE CASCADE
) ENGINE = InnoDB;

CREATE TABLE Oktato (
TEHAazonosito VARCHAR(11) PRIMARY KEY,
Nev VARCHAR(50),
SzuletesiEv DATE,
Szakterulet VARCHAR(25),
Telefonszam INT(9),
Email VARCHAR(50)
) ENGINE = InnoDB;

CREATE TABLE Kurzus (
KurzusKod VARCHAR(8) PRIMARY KEY,
KurzusNev VARCHAR(30),
Idotartam INT(3),
EloadasHelye VARCHAR(25),
Tipus CHAR(3),
Vizsgatipus VARCHAR(7),
KreditErtek INT(2),
OktatoKod VARCHAR(11)
) ENGINE = InnoDB;

CREATE TABLE Terem (
Sorszam INT(3) PRIMARY KEY NOT NULL,
Epuletszam INT(1),
Kapacitas INT(3),
IRszam INT(4),
Utca CHAR(25),
Hazszam INT(2)
) ENGINE = InnoDB;

CREATE TABLE DiakKurz (
kd_id INT (5) PRIMARY KEY NOT NULL auto_increment,
DKKod VARCHAR(8),
EHA VARCHAR(11),
FOREIGN KEY (EHA) REFERENCES Hallgato(EHAazonosito) ON DELETE CASCADE,
FOREIGN KEY (DKKod) REFERENCES Kurzus(KurzusKod) ON DELETE CASCADE
) ENGINE = InnoDB; 
```

问题在于创建 DiakKurz 表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:14:23.497

这

```
FOREIGN KEY (EHA) REFERENCES Hallgato(EHAazonosito) ON DELETE CASCADE, 
```

不起作用，因为`EHAazonosito`不是`Hallgato`表的主键。外键只能引用主（或唯一）键。

**顺便说一句：您是否**意识到`6`in`int(6)`不是限制列中的值？

 **它什么也没做。`int(6)`是一样的`int`。只是为了`6`给客户端应用程序一个提示（！）该列应该显示多少位。它根本不强制执行任何操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:20:14.323

您必须为表 Hallgato 中的 EHAazonosito 列设置一个索引

```
CREATE TABLE Hallgato (
OktAzonosito INT(6) PRIMARY KEY,
EHAazonosito VARCHAR(11), INDEX (EHAazonosito),
TeljesNev VARCHAR(50),
Szemelyazonosito INT(6),
AnyaNyelv VARCHAR(20),
VegzettsegSzint VARCHAR(25),
AnyjaNeve VARCHAR(35),
SzuletesiHely VARCHAR(30),
SzuletesiEv DATE,
Allampolgarsag VARCHAR(30),
Neme VARCHAR(5),
Adoazonosito INT(6),
TAJszam INT(6),
BankszamlaSzam INT(9)
) ENGINE = InnoDB; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T23:14:13.743

您是否尝试过查找错误？

> 如果 MySQL 从 CREATE TABLE 语句中报告错误号 1005，并且错误消息引用错误 150，则表创建失败，因为未正确形成外键约束。类似地，如果 ALTER TABLE 失败并且它引用错误 150，这意味着为更改的表将错误地形成外键定义。要显示服务器中最近的 InnoDB 外键错误的详细说明，请发出 SHOW ENGINE INNODB STATUS。

[http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html](http://dev.mysql.com/doc/refman/5.5/en/innodb-foreign-key-constraints.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-22T10:47:21.753

在整个模式转储后，它也发生在我身上，帮助将整个转储包装在禁用的外键检查中

```
SET foreign_key_checks=0;

...dump

SET foreign_key_checks=1; 
```**

# java - 在 Java 中对对象进行的更改

> ID：13435705
> 
> 赞同：0
> 
> 时间：2012-11-17T23:10:27.387
> 
> 标签：java

我创建了一个 Compound 类，其中包含碳、氢、氧、氮的数量及其键数。我有一个包含这些对象的堆栈。

最初堆栈将从空开始，我将弹出它。然后我将对其应用 addHydrogen 函数，因此它的氢将 = 1，氧 = 0，氮 = 0 和碳 = 0。

然后我想取同一个对象并应用 addCarbon 函数，这样 Hydogren 将 = 0、Oxygen = 0、Nitrogren = 0 和 Carbon = 1。

如何编写我的程序，以便我可以使用相同的对象，但不能使用添加氢所做的更改？我知道我最初可以使用一些 if 案例，但我认为它不会起作用，因为我最终会从氢 = 2、氧 = 2、氮 = 0、碳 = 1 的化合物开始。

*我没有在代码中包含我的构造函数，它们只是将所有内容初始化为 0。

```
class compound {

    int Hydrogen;
    int Carbon;
    int Nitrogen;
    int Oxygen;
    int bond;

    public void addHydrogen(compound comp) {
        Hydrogen++;
    }

    public void addCarbon(compound comp) {
        Carbon++;
    }

}
    public static void main(String[] args) {
        Compound a= new Compound();
        a.addHydrogen(a);
        a.addCarbon(a);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:13:16.340

您的问题不是很清楚，但您可能希望考虑的一个选项是使您的对象*不可变*- 因此您永远不能更改单个对象中的值，但您可以让您的`addCarbon`(etc) 方法*返回*一个新对象具有适当的新值。

（请注意，目前您没有使用您的参数，无论如何这似乎都有错误的情况......）

示例代码：

```
public class Compound {
    private final int hydrogen;
    private final int carbon;
    private final int nitrogen;
    private final int oxygen;

    public Compound(int hydrogen, int carbon, int nitrogen, int oxygen) {
        this.hydrogen = hydrogen;
        this.carbon = hydrogen;
        this.nitrogen = nitrogen;
        this.oxygen = oxygen;
    }

    public int getHydrogen() {
        return hydrogen;
    }

    // ... etc for the other getters

    public Compound plusHydrogen() {
        return new Compound(hydrogen + 1, carbon, nitrogen, oxygen);
    }

    // etc for the other plus calls
} 
```

请注意，我已经调用了方法`plusHydrogen`等，以明确它们不会改变*现有*对象，而是返回一个新对象。

然后你可以拥有：

```
Compound base = new Compound(0, 0, 0, 0);
Compound withHydrogen = base.plusHydrogen();
Compound withCarbon = base.plusCarbon();
// whatever 
```

# java - 如何在 Java 中连接字符串数组

> ID：13435714
> 
> 赞同：9
> 
> 时间：2012-11-17T23:11:30.963
> 
> 标签：java, arrays

我想知道如何在 Java 中连接 4 个字符串数组。

已经有一个关于这个的问题。 [如何在 Java 中连接两个数组？](https://stackoverflow.com/questions/80476/how-to-concatenate-two-arrays-in-java)

但我试图复制它，但它对我不起作用。

这就是我的代码的样子：

调用方法：

```
concatAll(jobs1, jobs2, jobs3, jobs4); 
```

方法本身：

```
public String[] concatAll(String[] jobsA, String[] jobsB, String[] jobsC, String[] jobsD) {
    int totalLength = jobsA.length;
    for (String[] array : jobsD) {
        totalLength += array.length;
    }

    String[] result = Arrays.copyOf(jobsA, totalLength);

    int offset = jobsA.length;

    for (String[] array : jobsD) {
        System.arraycopy(array, 0, result, offset, array.length);
        offset += array.length;
    }
    return result;
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-17T23:19:04.563

抛开诸如检查数组是否为 的事情`null`，您可以为它创建一个通用方法并在您的特定情况下使用它，如下所示：

```
 public String[] concatAll(String[] jobsA, String[] jobsB, String[] jobsC, String[] jobsD) 
    {
        return generalConcatAll (jobsA, jobsB, jobsC, jobsD);
    }

    public String[] generalConcatAll(String[]... jobs) {
        int len = 0;
        for (final String[] job : jobs) {
            len += job.length;
        }

        final String[] result = new String[len];

        int currentPos = 0;
        for (final String[] job : jobs) {
            System.arraycopy(job, 0, result, currentPos, job.length);
            currentPos += job.length;
        }

        return result;
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-03-13T14:53:19.010

这更简洁一些，并`null`使用 Apache Commons Lang 库正确处理所有情况。[`ArrayUtils.addAll(T[], T...)`](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/ArrayUtils.html#addAll%28T%5B%5D,%20T...%29)

```
public String[] generalConcatAll(String[]...arrays) {

    String[] result = null;

    for(String[] array : arrays) {
         result = ArrayUtils.addAll(result, array);
    }

    return result;

} 
```

# php - MySQL Where 子句中的数组

> ID：13435716
> 
> 赞同：0
> 
> 时间：2012-11-17T23:12:07.997
> 
> 标签：php, mysql, arrays

我有一个数组 $ziparray，我试图在 MySQL 查询中使用它来检查名为“zip”的数据库列。以下代码对我来说似乎是合乎逻辑的，但出现错误：

> 可捕获的致命错误：stdClass 类的对象无法在...中转换为字符串

```
$ziparrayimplode = implode(",", $ziparray);
$listinghistoryquery = "SELECT * FROM listings WHERE zip IN ($ziparrayimplode) ORDER BY list_ts DESC";
$listinghistory = mysql_query($listinghistoryquery) or die('SQL Error :: '.mysql_error()); 
```

我绝对确定 $ziparray 是一个数组。谁能告诉我如何使这个查询工作？这是用于创建数组的代码..

```
$countyzipquery = mysql_query("SELECT city_zip FROM dev_cities WHERE city_state='$state' AND city_county='$county' AND city_name='$city'");
$ziparray = array();
while (($ziparrayrow = mysql_fetch_object($countyzipquery)) !== FALSE) {
  $ziparray[] = $ziparrayrow; 
```

这是 var_dump($ziparray) 的输出

```
array(1) { [0]=> object(stdClass)#3 (1) { ["city_zip"]=> string(5) "63028" } } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:21:55.143

```
while (($ziparrayrow = mysql_fetch_object($countyzipquery)) !== FALSE) { 
```

您正在从数据库中获取*对象*，然后将这些完整对象存储到您的`$ziparray`数组中。您不能连接`stdClass`对象，因为它们不能转换为字符串（对象需要为此定义`__toString`方法，而`stdClass`实例没有这样的方法）。

您很可能想要获取数组（`mysql_fetch_array`而不是`mysql_fetch_object`），然后仅将第一个元素（`$ziparrayrow[0]`）存储在`$ziparray`. 或者，您可以保留`mysql_fetch_object`，但更改您在 中的元素累积`$ziparray`：

```
$ziparray[] = $ziparrayrow->city_zip; 
```

# xaml - RenderTransform 发生在 TextBlock 上的 EntranceThemeTransition 之后

> ID：13435721
> 
> 赞同：3
> 
> 时间：2012-11-17T23:12:47.383
> 
> 标签：xaml, windows-8, microsoft-metro, windows-runtime, windows-store-apps

我正在将`EntranceThemeTransition`动画应用于`TextBlock`. 有`TextBlock`一种风格，`PageHeaderTextStyle`其中有一种`RenderTransform`。我遇到的问题是`RenderTransform`应用了一个`Translation`效果，直到动画播放完毕后才真正呈现。因此，它看起来很奇怪，因为动画滚动控件，然后突然翻译将文本捕捉到位。有谁知道为什么会这样？

有没有办法在考虑翻译的情况下播放动画？

转换：

```
<Setter Property="RenderTransform">
    <Setter.Value>
        <TranslateTransform X="-2" Y="8"/>
    </Setter.Value>
</Setter> 
```

文本块：

```
<TextBlock x:Name="pageTitle" Grid.Column="1" Text="{Binding Title}" Style="{StaticResource PageHeaderTextStyle}">
    <TextBlock.Transitions>
        <TransitionCollection>
            <EntranceThemeTransition/>
        </TransitionCollection>
    </TextBlock.Transitions>
</TextBlock> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T02:13:55.930

我刚刚遇到了完全相同的问题。解决它的方法是*嵌套*`TextBlock`远离的一层`Grid`，上面有过渡，例如第二层`Grid`。

发生的情况是过渡对其每个子级应用一个变换，但在动画完成之前，它们可能拥有的任何变换都会被临时替换，从而在随后应用原始变换时导致令人讨厌的“捕捉”。

在以下示例中，将运行转换，替换`TextBlock`' 的转换，然后在转换结束后应用原始转换。您会看到“快照”：

```
<Grid Style="{StaticResource LayoutRootStyle}">
    <TextBlock Text="Header" Style="{StaticResource PageHeaderTextStyle}"
        Margin="0,0,0,40"/>
</Grid> 
```

在下一个示例中，转换运行并将转换应用于`Grid`，而`TextBlock`' 的转换不受影响。没有“快照”：

```
<Grid Style="{StaticResource LayoutRootStyle}">
    <Grid>
        <TextBlock Text="Header" Style="{StaticResource PageHeaderTextStyle}"
            Margin="0,0,0,40"/>
    </Grid>
</Grid> 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T06:47:05.440

从您的话看来，EntranceThemeTransition 似乎为您的 TextBlock 的变换设置了动画。最简单的解决方法是将入口过渡放在父元素上，或者将变换放在父元素上。你可以简单地将你的 TextBlock 包装在一个网格中来做到这一点。

# c++ - 对话框过程中的“函数”

> ID：13435729
> 
> 赞同：0
> 
> 时间：2012-11-17T23:13:49.263
> 
> 标签：c++, winapi, dialog

我注意到我的对话框过程中需要函数。例如，我可以点击多个按钮，这些按钮需要以相同的方式更新其他控件。现在我只是在适当的地方重复相同的代码。

全局对话框“助手”功能是解决此问题的常用方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T01:10:34.700

您可以将通用功能分解为单独的类或模块。让您的对话框类继承自分解类或调用独立函数。

我将此过程称为软件进化： 将常见的部分*重构*为两个或多个软件单元可以使用的单独模块。

# ruby - 使用 Rubinius 为 ruby 对象添加“源”属性

> ID：13435730
> 
> 赞同：2
> 
> 时间：2012-11-17T23:13:49.593
> 
> 标签：ruby, compiler-construction, rubinius

我正在尝试（为了乐趣和利润）添加在 ruby​​ 中检查对象并发现它们的源代码的能力。不是生成的字节码，也不是内部表示的一些反编译版本，而是被解析以创建该对象的实际源。

我学习 Rubinius 的时间很晚，虽然我还没有完全理解它，但我认为我已经取得了一些进展。

不过，我很难弄清楚如何做到这一点。我的第一种方法是简单地将另一个实例属性添加到 AST 结构（例如，一个 ClosedScope 对象）。然后，当在运行时解释字节码时，以某种方式再次提取该属性。

这看起来是一种合理的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T06:21:57.217

正如塞缪尔先生所说，您可以使用 pry and do `show-source foo`。但也许您想知道它在幕后是如何工作的。

Ruby 提供了两个有用的东西：首先，您可以获得对象上所有方法的列表。只要打电话`foo.methods`。其次，它为每个方法提供了一个 file_name 和 line_number 属性。

为了找到一个对象的完整源代码，我们浏览了所有的方法，并按照定义的位置对它们进行分组。然后我们将文件扫描回来，直到我们看到`class`或`module`其他一些 ruby​​ists 用来定义方法的方式。然后我们在每个文件中向前扫描，直到我们识别出整个类/模块定义。

正如 dgitized 指出的那样，如果人们有猴子修补的核心对象，我们通常会得到多个这样的定义。默认情况下，pry 只显示包含大多数方法的模块定义；但你可以用`show-source -a`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T04:37:36.353

你调查过撬吗？它是一个 Ruby 解释器/调试器，声称能够完成您所要求的工作。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-18T07:26:55.750

你试过 set_trace_func 吗？它不是 rubinius 特定的，而是按照你的要求做的，而不是基于 pry 或其他一些宝石。

见[http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-set_trace_func](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-set_trace_func)

# java - Java 服务器在 32 位下工作，但在 64 位下不工作。为什么？

> ID：13435731
> 
> 赞同：5
> 
> 时间：2012-11-17T23:13:55.040
> 
> 标签：java, sockets, 64-bit, serversocket, java-server

只有在 64 位（Windows 7 终极版）上运行时才会出现这个奇怪的异常，而不是在运行 32 位 Win7 终极版时。目前它在 java 版本 1.6.0_26 上运行

```
running server!
java.net.SocketException: select failed
 at java.net.PlainSocketImpl.socketAccept(Native Method)
 at java.net.PlainSocketImpl.accept(Unknown Source)
 at java.net.ServerSocket.implAccept(Unknown Source)
 at java.net.ServerSocket.accept(Unknown Source)
 at Server.main(Server.java:18) 
```

这是代码：

```
//import java.net.ServerSocket;
//import java.net.Socket;
import java.io.*;
import java.net.*;

public class Server {

 public static void main(String[] args) {
 System.out.println("running server!");
  int nreq = 1;
  try{
   ServerSocket sock = new ServerSocket(7337);
  for(;;){
   Socket newsock = sock.accept();
   System.out.println("Creating thread...");
   Thread t = new ThreadHandler(newsock, nreq);
   t.start();
   nreq++;
  }
  }

  catch(Exception e)
  {

   e.printStackTrace();

  }
 }
} 
```

在线引用的错误指向该位：

```
Socket newsock = sock.accept(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:19:26.513

您肯定会遇到 Windows 7 和您安装的 Java SDK 版本的问题。从 oracle 网站下载并安装最新版本的 Java SDK 7。看看是否有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T23:17:45.113

当 JVM 和操作系统不匹配时，这些问题可能会发生。一个运行 32 位，另一个运行 64 位。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T23:20:21.850

我*不*认为问题出在 Java 32 位与 64 位之间。

问题*可能*是 Windows 32 位与 Windows 64 位，但是：

*   [什么会导致“IO error java.net.SocketException: select failed”？](https://stackoverflow.com/questions/11926655/what-can-cause-io-error-java-net-socketexception-select-failed)

还：

1) 请尝试使用此 JVM 选项运行：

*   -Djava.net.preferIPv4Stack=true

2) 请确保您已安装*64 位*版本的 Java

# python - 如何识别 raw_input 中的多个关键字？Python

> ID：13435739
> 
> 赞同：3
> 
> 时间：2012-11-17T23:15:35.333
> 
> 标签：python, raw-input

```
 if "sneak" or "assasinate" or "stealth" not in action:
        print"...cmon, you're a ninja! you can't just attack!"
        print "STEALTH, SNEAK ATTACKS, ASSASINATIONS!"
        print "The gods decide that you have come too close to loose now."
        print "they give you another chance"
        return 'woods'
    else:
        print "You throw a ninja star at a near by tree to distract the warlord,"
        print "you take out his legs, get him on the ground and have your blade to his neck"
        print "You take off his mask to stare into his eyes as he dies, and realise, it's your father."
        return 'the_choice' 
```

这是我遇到问题的代码。我是 python 新手，我需要知道如何识别 raw_input 中给出的多个单词。我不知道为什么 ^ 不起作用，但这确实：

```
action = raw_input("> ")

if "body" in action:
    print "You hit him right in the heart like a pro!"
    print "in his last dying breath, he calls for help..."
    return 'death' 
```

任何帮助将不胜感激，非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:19:07.403

您可以使用内置功能[`any()`](http://docs.python.org/2/library/functions.html#any)：

```
any(x not in action for x in  ("sneak","assasinate","stealth")) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:34:38.283

这里涉及两个问题：

1.  非空字符串本质上是真实的
2.  的关联性与`or`您所写的有点不同。

看到这一点的最简单方法是仅使用第一个分支：

```
if "sneak":
   print "This was Truthy!" 
```

如果我们在 if 子句中添加括号，它将像这样解析（因为它从左到右读取：

```
if ("sneak" or "assasinate") or ("stealth" not in action) 
```

@AshwiniChaudhary 的使用建议`any`是一个很好的建议，但要明确的是，它会产生与执行相同的结果：

```
"sneak" in action or "assasinate" in action or "stealth" in action 
```

顺便说一句，如果你正在寻找一个完全匹配的，你也可以这样做

```
if action in ("sneak", "assasinate", "stealth") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T00:48:58.760

感谢您的帮助，但我想通了，这就是我所做的：

```
 action = raw_input("> ")

    if "sneak" in action:
        print "You throw a ninja star at a near by tree to distract the warlord,"
        print "you take out his legs, get him on the ground and have your blade to his neck"
        print "You take off his mask to stare into his eyes as he dies, and realise, it's your father."
        return 'the_choice'
    elif "assasinate" in action:
        print "You throw a ninja star at a near by tree to distract the warlord,"
        print "you take out his legs, get him on the ground and have your blade to his neck"
        print "You take off his mask to stare into his eyes as he dies, and realise, it's your father."
        return 'the_choice'
    elif "stealth" in action:
        print "You throw a ninja star at a near by tree to distract the warlord,"
        print "you take out his legs, get him on the ground and have your blade to his neck"
        print "You take off his mask to stare into his eyes as he dies, and realise, it's your father."
        return 'the_choice'
    else:
        print"...cmon, you're a ninja! you can't just attack!"
        print "STEALTH, SNEAK ATTACKS, ASSASINATIONS!"
        print "The gods decide that you have come too close to loose now."
        print "they give you another chance"
        return 'woods' 
```

# java - Java NullPointerException - 短程序

> ID：13435742
> 
> 赞同：5
> 
> 时间：2012-11-17T23:15:50.027
> 
> 标签：java, exception, nullpointerexception, runtime-error, main

我是 Java 编程新手，我不明白我的代码中发生了什么。

它告诉我：

```
Exception in thread "main" java.lang.NullPointerException
    at Main.Country.addMine(Country.java:37)
    at Main.Main.main(Main.java:21)
Java Result: 1 
```

我的 main.java 很简单：

```
 Continent Europe = new Continent("Europe");
    Country asd = new Country("asd", Europe);
    Mine mine = new Mine(100,100,100,100);
    System.out.println(mine == null);
    asd.addMine(mine); //dies here 
```

这是 addMine 方法：

```
public void addMine(Mine mine) {
     System.out.println(mine == null);
     this.mines.add(mine); //dies here
     this.iron += mine.iron;
     this.gold += mine.gold;
     this.stone += mine.stone;
     this.wood += mine.wood;
     System.out.println("Mine has been successfully added to the country with the given values."
); 
```

和 Mine.java 是：

```
public class Mine implements Building { //Building is an empty interface :)
    protected int iron;
    protected int gold;
    protected int stone;
    protected int wood;
    public Mine(int iron, int gold, int stone, int wood) {
        this.iron += iron;
        this.gold += gold;
        this.stone += stone;
        this.wood += wood;
    }
} 
```

如您所见，我写了 2 个 println-s 并且它们都是错误的，所以对象存在！我不明白为什么它显示 NullPointerException :(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T23:19:48.103

如果这失败了：

```
this.mines.add(mine); //dies here 
```

...然后我怀疑`mines`是一个空引用。您没有显示任何声明*或*初始化 - 但这应该是您的第一个停靠港。很可能这只是一个改变的例子：

```
private List<Mine> mines; 
```

到

```
private List<Mine> mines = new ArrayList<Mine>(); 
```

或类似的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:20:24.467

是的，`mine`可能不是`null`，但是呢`mines`？我猜它是一个`ArrayList<Mine>`或类似的东西，你是否将它初始化为`mines = new ArrayList<Mine>()`？（或任何集合）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T23:25:56.683

当您在为空的引用上调用方法时，将引发空指针异常。

```
this.mines.add(mine); //dies here 
```

`this.mines`参考显然等于`null`。

还要尝试使您的参考变量名称以小写字母开头。

```
Continent Europe = new Continent("Europe"); 
```

->

```
Continent europe = new Continent("Europe"); 
```

以大写字母开头的名称为类“保留”。

它在 Java 中被认为是一种很好的风格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T23:41:32.277

您的代码在

```
this.mines.add(mine); 
```

在县级。

为了绕过错误，您应该在 County 类中创建一个局部变量（如果您没有它），它将是

```
private List<Mine> mines; 
```

您将通过添加以下内容对其进行初始化

```
mines=new LinkedList<Mine>(); 
```

上面的事情可以写在一行代码中，但这取决于你。

```
private List<Mine> mines=new LinkedList<Mine>(); 
```

您可以使用 List 的任何其他实现。

# rest - Spring Security 认证 RESTful Web 服务

> ID：13435743
> 
> 赞同：3
> 
> 时间：2012-11-17T23:15:57.690
> 
> 标签：rest, authentication, spring-mvc, spring-security

我正在为我的 RESTful Web 服务（使用 Spring MVC 实现）添加基本身份验证，而 Spring Security 以前从未真正使用过它。现在，我只是在使用内存`UserService`中，目的是稍后添加基于存储库的内存。

```
<security:http>
    <security:http-basic />
    <security:intercept-url pattern="/**" access="ROLE_ADMIN" />
</security:http>

<security:authentication-manager>
    <security:authentication-provider>
        <security:user-service>
            <security:user name="admin" password="admin"
                authorities="ROLE_USER, ROLE_ADMIN" />
            <security:user name="guest" password="guest"
                authorities="ROLE_GUEST" />
        </security:user-service>
    </security:authentication-provider>
</security:authentication-manager> 
```

这很好用，即发送以下请求授予我访问所需资源的权限（其中编码字符串为 admin:admin）：

```
GET /user/v1/Tyler HTTP/1.1
Authorization: Basic YWRtaW46YWRtaW4= 
```

发送以下请求会给我一个错误 403（其中编码的字符串是 guest:guest）：

```
GET /user/v1/Tyler HTTP/1.1
Authorization: Basic Z3Vlc3Q6Z3Vlc3Q= 
```

但是，发送所提供的用户名*不*包含在其中的请求`UserService`不会导致错误 403，正如我预期的（或至少是预期的），而是继续提示输入用户名和密码。例如（其中编码的字符串是用户：用户）：

```
GET /user/v1/Tyler HTTP/1.1
Authorization: Basic dXNlcjp1c2Vy 
```

当提供无法识别的用户凭据时，是否需要额外的配置来响应错误 403？我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T23:45:24.373

首先，

`403 Forbidden`当用户已通过身份验证但无权执行特定操作时应使用。在您的示例`guest`中，已成功通过身份验证，但未授予查看页面的权限，因为他只是来宾。

您应该使用`401 Unauthorized`指示您的用户未成功通过身份验证。

有关 HTTP 错误代码的更多信息：[http ://en.wikipedia.org/wiki/HTTP_401#4xx_Client_Error](http://en.wikipedia.org/wiki/HTTP_401#4xx_Client_Error)

第二，

您可以通过扩展来指定您的自定义行为`BasicAuthenticationFilter`。有一种`protected void onUnsuccessfulAuthentication(HttpServletRequest request, HttpServletResponse AuthenticationException failed)`方法可以覆盖并做任何适当的事情。在默认实现中，该方法为空。

关于注入自定义过滤器的 Spring Security 文档：[CLICK](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/appendix-namespace.html#nsa-custom-filter)

编辑：

每次您的身份验证输入无效时 Spring Security 会做什么：

```
public class BasicAuthenticationEntryPoint implements AuthenticationEntryPoint {
...
public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException)
        throws IOException, ServletException {

response.addHeader("WWW-Authenticate", "Basic realm=\"" + realmName + "\"");
response.sendError(HttpServletResponse.SC_UNAUTHORIZED, authException.getMessage()); 
```

因此，默认行为是正确的。用户被发送 401 并被要求提供有效的登录/凭据。

在覆盖之前，请尝试了解默认行为。源代码：[点击](https://github.com/SpringSource/spring-security/blob/master/web/src/main/java/org/springframework/security/web/authentication/www/BasicAuthenticationFilter.java)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:41:47.940

您应该在 wget 或 curl 之类的客户端中尝试此操作。如果您被 401 拒绝，您的浏览器会多次为 Basic redentials 唠叨。这可能就是这种情况。

# c++ - 我们如何在 c++ 实现文件中包含结构？

> ID：13435745
> 
> 赞同：1
> 
> 时间：2012-11-17T23:15:59.360
> 
> 标签：c++, struct, linked-list, queue, implementation

所以我正在尝试创建自己的实现文件，其中包含队列的说明。我决定使用链表来实现 Queue 类，这意味着我需要使用自己的 Node 结构。不幸的是，我被卡住了，不知道如何正确地将其包含在文件中。

这是我到目前为止所拥有的：

```
#include <string>

#ifndef NODE
template <class DataType>
struct Node
{
  DataType data;
  Node *next;
};
#endif

template <class DataType>
class Queue
{
  public: 
    Queue();
    bool isEmpty() const;
    void push(const DataType& parameter);
    bool peek(DataType& parameter) const;
    bool pop(DataType& parameter);
    void makeEmpty();

  private:
    Node<DataType>* front;
    Node<DataType>* end;
};

template <class DataType>
Queue<DataType>::Queue()
: front(0), end(0)
{
}

template <class DataType>
bool Queue<DataType>::isEmpty() const {return 0 == front;}

template <class DataType>
void Queue<DataType>::push(const DataType& parameter)
{
  Node<DataType>* node = new Node<DataType>;
  node->data = parameter;
  node->next = 0;
  if (end) end->next = node;
  else front = node;
  end = node;
}

template <class DataType>
bool Queue<DataType>::peek(DataType& parameter) const
{
  if (0 == front) return false; // failed
  parameter = front->data;
  return true; // success
}

template <class DataType>
bool Queue<DataType>::pop(DataType& parameter)
{
  if (0 == front) return false; // failed
  parameter = front->data;
  Node<DataType>* p = front->next;
  delete front;
  front = p;
  if (front == 0) end = 0;
  return true; // success
}

template <class DataType>
void Queue<DataType>::makeEmpty()
{
  end = 0;
  Node<DataType>* p;
  while (front) 
{ 
  p = front->next; 
  delete front; 
  front = p;
} 
} 
```

我不确定我是否正确地用#ifndef 封闭了结构（我什至不确定这是否是我应该采取的路线：/），我应该做类似的事情还是应该做一些事情其他结构的代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T23:20:05.353

您可以完全删除#ifdef/#endif

这是一个类模板，它可能在多个翻译单元中出现多次，只要所有出现都相同（一个定义规则）

## 选择

由于`Node<>`纯粹是私人问题，我将其设为嵌套的`struct`.

这是一个使这种更“现代 C++”风格的小演示。

**编辑**感谢@R.MartinhoFernandes 展示了更多改进并对此进行了审查。

```
#include <memory>

template <typename T>
struct Queue {
    Queue() : front(), end(/*nullptr*/) {}

    // Copy-And-Swap idiom
    // see http://en.wikibooks.org/wiki/More_C%2B%2B_Idioms/Copy-and-swap
    // or  http://stackoverflow.com/questions/3279543/what-is-the-copy-and-swap-idiom
    void swap(Queue& q) noexcept {
        using std::swap;
        swap(q.front, front);
        swap(q.end, end);
    }
    Queue(Queue const& q) : front(), end() {
        for(auto it=q.front.get(); it; it=it->next.get())
            push(it->data);
    }
    Queue& operator=(Queue q) {
        std::swap(*this, q);
        return *this;
    }
    // end Copy-and-swap

    // prevent stack overflows in ~Node if the list grows large (say >1k elements) 
    ~Queue() { clear(); }

    bool isEmpty() const { 
        return !front; 
    }
    void push(T const& data) {
        Ptr node(new Node(data));
        if (end)
            end->next = std::move(node);
        else
            front = std::move(node);
        end = node.get();
    }
    bool peek(T& data) const {
        if(front) data = front->data;
        return front.get();
    }
    bool pop(T& data) {
        if(!front) return false;

        data           = front->data;
        front          = std::move(front->next);
        if(!front) end = nullptr;

        return true;
    }
    void clear() {
        end = nullptr;
        while(front) front = std::move(front->next);
    }
private:
    struct Node;
    typedef std::unique_ptr<struct Node> Ptr;
    struct Node {
        Node(T data) : data(std::move(data)), next() {}
        T   data;
        Ptr next;
    };
    Ptr front;
    Node* end;
};

#include <iostream>

int main(int argc, const char *argv[]) {
    Queue<int> test;
    test.push(1);
    test.push(2);
    test.push(3);
    test.push(5);
    test.clear();
    test.push(32028);
    test.push(10842);
    test.push(1839);
    test.push(23493);
    test.push(9857);
    int x;
    test.peek(x);
    while(test.pop(x)) {
        std::cout << x << '\n';
    }
} 
```

注意：也许这里的代码`push`有点过分了，但是，嘿，它向您展示了现代 C++ 如何需要更少的手持（即使没有`std::make_unique`）。

请注意我认为 Clang 如何正确处理以下版本（即使用隐式`std::move`）：

```
void push(const DataType& parameter) {
    end = ((end? end->next : front) = Ptr(new Node(parameter))).get();
} 
```

我不太清楚为什么 gcc 拒绝它。

# c - 为什么我需要 stat 来检查目录是否已经存在？

> ID：13435746
> 
> 赞同：1
> 
> 时间：2012-11-17T23:16:10.700
> 
> 标签：c, mkdir

从我的家庭作业：

> 备份文件存储在名为 .mybackup 的隐藏目录中，如有必要，您的程序会创建该目录。要创建目录，请使用 mkdir() 函数（单击此处了解详细信息），但请务必检查目录是否已存在（使用 stat() 或检查 EEXIST）。如果该目录已经存在，请不要覆盖它。

如果目录已经存在，我认为 mkdir 固有地返回 -1。我肯定在某个地方读到过。我在这里弄错了吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T23:24:37.353

[`mkdir`](http://linux.die.net/man/3/mkdir)任何错误都返回 -1。所以为了区分错误，即发现目录是否已经存在，你应该使用该`stat`函数或者在返回-1之后检查`errno`。`EEXIST``mkdir`

```
if(mkdir(".mybackup", S_IRWXU | S_IRWXG | S_IROTH | S_IXOTH) == -1)
{
    if(errno == EEXIST)
    {
        // Directory already exists, do something
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:26:30.817

`mkdir`功能可能因多种原因而失败：

> [EACCES] 拒绝路径前缀的组件的搜索权限，或拒绝要创建的目录的父目录的写入权限。
> 
> [EEXIST] 命名文件存在。
> 
> [ELOOP] 在解析路径参数期间遇到的符号链接中存在循环。
> 
> [EMLINK] 父目录的链接数将超过 {LINK_MAX}。
> 
> [ENAMETOOLONG] 路径参数的长度超过 {PATH_MAX} 或路径名组件长于 {NAME_MAX}。
> 
> [ENOENT] path 指定的路径前缀的组件未命名现有目录或路径为空字符串。
> 
> [ENOSPC] 文件系统没有足够的空间来保存新目录的内容或扩展新目录的父目录。
> 
> [ENOTDIR] 路径前缀的组件不是目录。
> 
> [EROFS] 父目录驻留在只读文件系统上。如果出现以下情况，mkdir() 函数可能会失败：
> 
> [ELOOP] 在解析路径参数期间遇到了超过 {SYMLOOP_MAX} 个符号链接。
> 
> [ENAMETOOLONG] 由于在解析路径参数时遇到符号链接，替换的路径名字符串的长度超过了 {PATH_MAX}。

如果函数返回，如果`-1`不检查就无法确定是哪个特定错误`errno`，这就是建议的原因。

# php - 如何从 PHP 数组中的每个字符串中删除文件扩展名？

> ID：13435747
> 
> 赞同：2
> 
> 时间：2012-11-17T23:16:18.080
> 
> 标签：php, arrays

我有一个字符串数组，每个字符串都包含一个图像文件的名称：

```
$slike=(1.jpg,253455.jpg,32.jpg,477.jpg); 
```

我想要新数组，看起来像这样：

```
$slike=(1,253455,32,477); 
```

如何从此数组中的每个字符串中删除文件扩展名？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-17T23:19:37.367

如果您使用文件名，请使用 PHP 的内置[pathinfo()](http://php.net/manual/en/function.pathinfo.php)函数。没有必要为此使用正则表达式。

```
<?php

# your array
$slike = array('1.jpg','253455.jpg','32.jpg','477.jpg');

# if you have PHP >= 5.3, I'd use this
$slike = array_map(function($e){
    return pathinfo($e, PATHINFO_FILENAME);
}, $slike);

# if you have PHP <= 5.2, use this
$slike = array_map('pathinfo', $slike, array_fill(
    0, count($slike), PATHINFO_FILENAME
));

# dump
print_r($slike); 
```

输出

```
Array
(
    [0] => 1
    [1] => 253455
    [2] => 32
    [3] => 477
) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:19:53.473

正则表达式是你的朋友。我假设括号，你的意思是一个数组。

```
$k = count($slike);
for ($i = 0; $i < $k; $i++) {
   $extpos = strrpos($slike[$i],".");
   $slike[$i] = substr($slike[$i],0,$extpos);
} 
```

这不再依赖于正则表达式，并且比 pathinfo() 更快地进行基准测试。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-17T23:20:18.037

使用**[`preg_split`](http://www.php.net/manual/en/function.preg-split.php)**在**[`foreach`](http://php.net/manual/en/control-structures.foreach.php)**

```
foreach ($slike as &$value) {
    $split = preg_split('/\./', $value);
    $value = $split[0]
} 
```

将正则表达式更改为也`/[^.]+/`包括在内`a.b.jpg`。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-04-24T08:52:30.257

试试这个：

```
$slike = array('1.jpg','253455.jpg','32.jpg','477.jpg');

$slike = array_map(function($e){
            $e = explode('.', $e);
            return $e[0];
        }, $slike);

echo "<pre>";
print_r($slike);
echo "</pre>"; 
```

# javascript - 如何使用 JQuery 以编程方式单击特定 div 上的特定 XY 位置？

> ID：13435752
> 
> 赞同：4
> 
> 时间：2012-11-17T23:16:45.943
> 
> 标签：javascript, jquery, html, canvas, mouseevent

我有两个完全重叠的 div。上面的 div 是一个部分透明的 HTML5 画布，不透明的部分与鼠标悬停、点击、滚动等交互。

下面的 div 有一个地图（使用传单），同样它应该与悬停、点击、滚动等交互。

我可以通过以下代码在两个 div 中注册一次点击：

```
$("#canvas").click(function(e){
    $('#map').click();
} 
```

但是，为了让我的应用程序正常工作，单击事件（和所有其他鼠标事件）需要在相同的 XY 位置注册。

我真正需要做的就是传递`e.pageX`到`e.pageY`新的点击功能，因为两个 div 完全重叠（又名相同的 4 个角） - 但是我不确定如何做到这一点。使用 JQuery（或任何其他替代方式），如何在 div 中的特定 XY 位置注册点击`#map`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:23:36.223

```
 // Create a new jQuery.Event object with specified event properties.
  var e = jQuery.Event("click", { pageX: pageX, pageY: pageY });

  // trigger an artificial keydown event with keyCode 64
  jQuery("#map").trigger( e ); 
```

这将“在 div #map 中的特定 XY 位置注册点击”。

# ruby-on-rails - 无法运行 Forge Gem/Rack Gem

> ID：13435754
> 
> 赞同：0
> 
> 时间：2012-11-17T23:17:08.667
> 
> 标签：ruby-on-rails, rubygems, gem, rack

我尝试在我的 MBP 操作系统 10.8.2 上安装[Forge 。](http://forge.thethemefoundry.com/)我已经安装了 Compass、Susy、Sass 和其他 gem，所以我已经习惯了。

但是，安装首先失败，说它需要安装 Rack。所以，我安装了 Rack，它似乎安装成功了。

现在我尝试创建一个 Forge 项目但收到此错误：

```
[~/Documents/.../ONOTW/onotw_wk] $ forge create onotw
/System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:230:in `activate': can't activate rack (~> 1.3.5, runtime) for ["forge-0.5.0"], already activated rack-1.4.1 for ["sprockets-2.0.4", "forge-0.5.0"] (Gem::LoadError)
from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:246:in `activate'
from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:245:in `each'
from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:245:in `activate'
from /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/lib/ruby/1.8/rubygems.rb:1056:in `gem'
from /usr/bin/forge:18 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T06:06:15.430

我遇到了同样的问题，并在[这里](https://github.com/thethemefoundry/forge/issues/56)找到了解决方案。本质上，您安装了两个版本的机架，需要卸载冲突的版本。

```
$ sudo gem uninstall rack

Select gem to uninstall:
1\. rack-1.3.10
2\. rack-1.4.1
3\. All versions

$ 2

Successfully uninstalled rack-1.4.1 
```

# svg - 在缩放平移后检测 d3.js 强制布局中的可见节点

> ID：13435756
> 
> 赞同：5
> 
> 时间：2012-11-17T23:17:33.543
> 
> 标签：svg, d3.js, zooming, force-layout

我在加载时使用 d3.js 中的强制定向布局来定位节点和边缘。然后我可以缩放和平移 svg。当我放大时，我想检测哪些节点和边缘是可见的，因此我可以仅为可见节点和边缘实现附加数据的延迟加载。

有谁知道获得（部分）可见元素的最佳方法是什么？

代码如下（只是将一些示例粘贴在一起）：

```
var svg = d3.select("#chart")
  .append("svg")
  .attr("width", width)
  .attr("height", height)
  .attr("pointer-events", "all")
  .append('svg:g')
  .call(d3.behavior.zoom().on("zoom", redraw))
  .append('svg:g')

svg.append('svg:rect')
  .attr('width', width)
  .attr('height', height)
  .attr('fill', 'white')

function redraw() {
  trans=d3.event.translate;
  scale=d3.event.scale
  svg.attr("transform", "translate(" + trans + ")" + " scale(" + scale + ")")
  console.log(scale)
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-08T09:23:05.217

如果您使用比例尺，您可以使用 找到当前可见范围`scale.invert`。因此，要找到宽度为 600 像素的轴的可见值，请使用`x.invert(0)`和`x.invert(600)`。

# php - 表单元素未使用正确的 jquery 移动设计插入

> ID：13435758
> 
> 赞同：1
> 
> 时间：2012-11-17T23:17:35.957
> 
> 标签：php, javascript, jquery, jquery-mobile

我使用 jquery 构建了一个表单。只要我使用 $('#Form').append(''); 当我使用 PHP 插入新添加的元素时，它们没有主题/看起来与我的不同。

说清楚：

php 添加：Jquery 移动风格

Jquery 动态添加：Regular Form 样式。

我怎样才能购买通行证？

======ADDON====== 好的，这是代码

此函数添加块：

```
function addItem(section){
    if(itemcounter[section]>1){
        $('table#deductionItemContent'+section+' tr:last').after('<tr id="deductionItemContentRow'+section+'_'+itemcounter[section]+'1"></tr>');
        $('table#deductionItemContent'+section+' tr:last').after('<tr id="deductionItemContentRow'+section+'_'+itemcounter[section]+'2"></tr>');
        $('table#deductionItemContent'+section+' tr:last').after('<tr id="deductionItemContentRow'+section+'_'+itemcounter[section]+'3"></tr>');
    }else{
        $('#deductionItemContent'+section).append('<tr id="deductionItemContentRow'+section+'_'+itemcounter[section]+'1"></tr>');
        $('#deductionItemContent'+section).append('<tr id="deductionItemContentRow'+section+'_'+itemcounter[section]+'2"></tr>');
        $('#deductionItemContent'+section).append('<tr id="deductionItemContentRow'+section+'_'+itemcounter[section]+'3"></tr>');
    }

    $('#deductionItemContent'+section).append('<tr id="deductionItemContentRow'+section+'_'+itemcounter[section]+'1"></tr>');
    $('#deductionItemContent'+section).append('<tr id="deductionItemContentRow'+section+'_'+itemcounter[section]+'2"></tr>');
    $('#deductionItemContent'+section).append('<tr id="deductionItemContentRow'+section+'_'+itemcounter[section]+'3"></tr>');
    $('#deductionItemContentRow'+section+'_'+itemcounter[section]+'1').append('<td id="deductionItemContent'+section+'El'+itemcounter[section]+'"></td>');
    $('#deductionItemContent'+section+'El'+itemcounter[section]).append('<div class="type-select"><label for="nu_item_'+section+'_'+itemcounter[section]+'">{/literal}{translate text="application_reports_plate5_item"}{literal}'+itemcounter[section]+'</label><select onchange="updateForm('+section+');" id="nu_item_'+section+'_'+itemcounter[section]+'" name="nu_item_'+section+'_'+itemcounter[section]+'"></select></div>')
    $('#nu_item_'+section+'_'+itemcounter[section]).append('<option value="main">{/literal}{translate text="application_reports_plate5_item_main"}{literal}</option>');
    $('#nu_item_'+section+'_'+itemcounter[section]).append('<option value="aux">{/literal}{translate text="application_reports_plate5_item_aux"}{literal}</option>');
    $('#nu_item_'+section+'_'+itemcounter[section]).append('<option value="jib">{/literal}{translate text="application_reports_plate5_jib"}{literal}</option>');
    $('#nu_item_'+section+'_'+itemcounter[section]).append('<option value="rope">{/literal}{translate text="application_reports_plate5_rope"}{literal}</option>');
    $('#nu_item_'+section+'_'+itemcounter[section]).append('<option value="underhookdevice">{/literal}{translate text="application_reports_plate5_underhookdevice"}{literal}</option>');
    $('#nu_item_'+section+'_'+itemcounter[section]).append('<option value="rigging">{/literal}{translate text="application_reports_plate5_rigging"}{literal}</option>');
    $('#nu_item_'+section+'_'+itemcounter[section]).append('<option value="none">{/literal}{translate text="application_reports_plate5_none"}{literal}</option>');
    $('#deductionItemContentRow'+section+'_'+itemcounter[section]+'2').append('<td id="deductionItemContent'+section+'E2'+itemcounter[section]+'"></td>');
    $('#deductionItemContent'+section+'E2'+itemcounter[section]).append('<div class="type-select"><label for="nu_status_'+section+'_'+itemcounter[section]+'">{/literal}{translate text="application_reports_plate5_itemstatus"}{literal} '+'</label><select onchange="updateForm('+section+');" id="nu_status_'+section+'_'+itemcounter[section]+'" name="nu_status_'+section+'_'+itemcounter[section]+'"></select></div>')
    $('#nu_status_'+section+'_'+itemcounter[section]).append('<option value="stowed">{/literal}{translate text="application_reports_plate5_item_stowed"}{literal}</option>');
    $('#nu_status_'+section+'_'+itemcounter[section]).append('<option value="erected">{/literal}{translate text="application_reports_plate5_item_erected"}{literal}</option>');
    $('#nu_status_'+section+'_'+itemcounter[section]).append('<option value="inservice">{/literal}{translate text="application_reports_plate5_item_inservice"}{literal}</option>');
    $('#nu_status_'+section+'_'+itemcounter[section]).append('<option value="none">{/literal}{translate text="application_reports_plate5_none"}{literal}</option>');
    $('#deductionItemContentRow'+section+'_'+itemcounter[section]+'3').append('<td id="deductionItemContent'+section+'E3'+itemcounter[section]+'"></td>');
    $('#deductionItemContent'+section+'E3'+itemcounter[section]).append('<div class="type-text"><label for="nu_deduction_'+section+'_'+itemcounter[section]+'">{/literal}{translate text="application_reports_plate5_deduction"}{literal}</label><input onkeyup="updateForm('+section+');" type="text" length="6" maxlength="6" id="nu_deduction_'+section+'_'+itemcounter[section]+'" name="nu_deduction_'+section+'_'+itemcounter[section]+'" /></div>');
    /**
     * Add Data to page 3
     */
    $('#weightMasterDataTable'+section).append('<tr id="weightMasterDataTableRow'+section+itemcounter[section]+'"></tr>');
    $('#weightMasterDataTableRow'+section+itemcounter[section]).append('<td id="weightMasterDataTableContent'+section+itemcounter[section]+'1"></td>');
    $('#weightMasterDataTableRow'+section+itemcounter[section]).append('<td id="weightMasterDataTableContent'+section+itemcounter[section]+'2"></td>');
    $('#weightMasterDataTableRow'+section+itemcounter[section]).append('<td id="weightMasterDataTableContent'+section+itemcounter[section]+'3">0</td>');
    $('#weightMasterDataTableRow'+section+itemcounter[section]).append('<td id="weightMasterDataTableContent'+section+itemcounter[section]+'4">0</td>');
    $('#weightMasterDataTableRow'+section+itemcounter[section]).append('<td id="weightMasterDataTableContent'+section+itemcounter[section]+'5">0</td>');
    /**
     * Add Radio Buttons
     */
    $('#weightMasterDataButtons'+section).append('<input type="radio" name="nu_masterbutton_'+section+'" id="nu_masterbutton_'+section+'_'+itemcounter[section]+'" value="'+itemcounter[section]+'" /><label for="nu_masterbutton_'+section+'_'+itemcounter[section]+'" >&nbsp;&nbsp;{/literal}{translate text="application_reports_plate5_item"}{literal} '+itemcounter[section]+'</label>');
    $('#weightMasterDataButtons'+section).append('<br />');
    /**
     * in the end update counter
     */
    itemcounter[section]++;
} 
```

属于 this 的 HTML 代码如下所示：

```
<tr>
    <td>
        <div id="tabs-2">
            <h4>deductions for loadtest 1</h4>
            <div id="deductions1">
                <a onclick="addItem(1);">+ Add item to deduction</a>
                <table id="deductionMaster1" class="tablecloth" width="100%" cellspacing="0" cellpadding="0" border="0">
                    <tbody>
                        <tr id="deductionMasterRow11">
                            <td>
                                <table id="deductionItemContent1" class="tablecloth" width="100%" cellspacing="0" cellpadding="0" border="0"></table>
                            </td>
                        </tr>
                        <tr id="deductionMasterRow12">
                            <td id="deductionMasterElement12">
                            total:
                            <b id="deductionValue1">0</b>
                            lbs
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </td>
</tr> 
```

这只是表格的一小部分，因为一切都以相同的方式反应。我想我需要告诉浏览器插入的表单元素将以 jquery 样式为主题。但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T00:22:18.603

尝试添加

```
$('select').selectmenu(); 
```

在 jQuery 脚本的末尾。那应该处理 <select> 标签。如果成功，请参阅 jquery mobile 的文档以获取有关如何处理页面上所需的任何其他表单元素的信息。

# cordova - 在 PhoneGap 应用程序中创建目录

> ID：13435762
> 
> 赞同：1
> 
> 时间：2012-11-17T23:18:14.920
> 
> 标签：cordova, filesystems, directory, ripple

我正在使用 Cordova-2.2.0，Chrome 浏览器，安装 Ripple 模拟器插件，在我的笔记本电脑上使用 Windows 7 操作系统（不是 Windows 7 操作系统手机，而是我的笔记本电脑上的 Windows 7 操作系统，只是为了清楚）。

这是我运行以创建文件夹的示例 javascript。但是我没有看到在我的硬盘上创建了一个文件夹。但是如果我打包 www 文件夹并使用 build.phonegap.com 在我的安卓手机上构建和安装应用程序，我确实看到它正在创建文件夹。这只是示例，但我喜欢 Ripple sim 并希望用于完整测试而不是使用 Mac X-Code 和 Android eclipse 进行调试，这要简单得多。任何人都可以提出任何修复建议，这样当我在笔记本电脑上运行它时它仍然能够创建文件夹，但是当我准备好部署包时，我可以保留下面的代码吗？

```
 window.addEventListener('load', function () {
     document.addEventListener('deviceready', onDeviceReady, false);
 }, false);

 function onDeviceReady(){
    window.requestFileSystem(LocalFileSystem.PERSISTENT, 2000, gotFS, fail);
 }

 function gotFS(fileSystem) 
 {
   fileSystem.root.getDirectory("example", {create: true, exclusive: false}, function(dir){}
   , function(error){}
   ); 
 } 
```

谢谢生锈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T04:02:50.087

[https://github.com/blackberry/Ripple-UI/issues/404](https://github.com/blackberry/Ripple-UI/issues/404)

我在 deviceready 之后添加了这段代码

```
 window.webkitStorageInfo.requestQuota(PERSISTENT, 1024*1024, function(grantedBytes) {
       window.webkitRequestFileSystem(PERSISTENT, grantedBytes, onInitFs, errorHandler); 
   }, function(e) {
      console.log('Error', e); 
   }); 
```

# paypal - Paypal Auto Return 不发送 POST 数据

> ID：13435764
> 
> 赞同：2
> 
> 时间：2012-11-17T23:18:42.647
> 
> 标签：paypal, paypal-ipn

我刚刚切换了我的 Paypal 设置以允许自动退货。现在，我不再收到发送到我的确认页面的帖子数据。当我意识到这一点时，我禁用了自动返回，我仍然没有得到数据。我还启用了 IPN 我启用了自动返回。它现在已禁用，但我仍然没有得到任何数据。

我还收到一条错误消息，警告我从安全页面转到不安全页面。如果我禁用自动返回，我仍然会收到该消息，但是当从 Paypal 返回到也没有 SSL 证书的其他网站上的确认页面时，它不会显示。

如何解决这两个问题，让我的客户轻松返回我的网站并让我收集有关他们交易的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T16:00:19.937

PayPal IPN 和 PDT 提供了 2 种可能的方法。

如果您想使用自动返回，那么您必须使用 IPN 将数据发布到您的确认页面。

或者您可以使用 PDT，因为它仅适用于 PayPal 所述的自动退货

> 请注意，为了使用支付数据传输，您必须打开自动退货。

这意味着为了在自动返回时将数据发送到您的确认页面，您必须启用 PDT 并稍微更改您的确认脚本以验证数据。

# .net - 站点编译为 .net 3.5 作为目标框架，但似乎仍然引用 .net 4.0

> ID：13435768
> 
> 赞同：0
> 
> 时间：2012-11-17T23:19:11.707
> 
> 标签：.net, target

我有一个网站，我编译为 .net 3.5 作为目标框架，它在本地运行良好，但是当我将它上传到 godaddy 的服务器时，我收到以下错误：-

System.Web.HttpParseException：无法加载文件或程序集“System.Web.Extensions，Version=4.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。该系统找不到指定的文件。---> System.IO.FileNotFoundException：无法加载文件或程序集“System.Web.Extensions，版本=4.0.0.0，文化=中性，PublicKeyToken=31bf3856ad364e35”或其依赖项之一。该系统找不到指定的文件。文件名：System.Signature._GetSignature（SignatureStruct& 签名，Void* pCorSig，Int32 cCorSig，IntPtr fieldHandle，IntPtr methodHandle，IntPtr declaringTypeHandle）中的文件名：'System.Web.Extensions，Version=4.0.0.0，Culture=neutral，PublicKeyToken=31bf3856ad364e35'

我检查了我的 web.config 文件，没有任何 4.0.0.0 dll 的引用，任何想法我可能做错了什么以及为什么会出现这些错误？我的 Godaddy 服务器正在运行 .net 3.5。我看不出编译为 3.5 的项目是如何遇到这些问题的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T00:34:55.380

检查项目引用，删除引用`System.Web.Extensions`，然后再次添加，但检查您是否选择了正确的版本。

项目目标框架与依赖目标框架不同。您可以为一个项目编译一个项目，但它的依赖项可能会为另一个目标框架编译。

当依赖使用更高版本的运行时，这个应用程序一旦启动就会失败。当使用具有较低版本运行时的依赖项时，一切都会运行良好。

# java - O(n^2) 在解决这个问题上不够快。任何更快的方法？

> ID：13435771
> 
> 赞同：16
> 
> 时间：2012-11-17T23:19:19.523
> 
> 标签：java, string, algorithm

我一直在尝试在 ACM Timus 上解决这个问题

[http://acm.timus.ru/problem.aspx?space=1&num=1932](http://acm.timus.ru/problem.aspx?space=1&num=1932)

我的第一种方法是 O(n^2) 肯定不够快，无法通过所有测试。下面的 O(n^2) 代码在测试 10 中给出了 TL。

```
import java.util.*;
import java.io.*;

public class testtest
{
    public static void main(String[] args) throws IOException
    {
        BufferedReader rr = new BufferedReader(new InputStreamReader(System.in));
        int n = Integer.parseInt(rr.readLine());
        String[] p = new String[n];
        for (int i = 0; i < n; i ++)
        {
            p[i] = rr.readLine();
        }
        int[] diff = new int[]{0, 0, 0, 0};
        for (int i = 0; i < n - 1; i ++)
        {
            for (int j = i + 1; j < n; j ++)
            {
                int ans  = (p[i].charAt(0) == p[j].charAt(0) ? 0 : 1) +
                           (p[i].charAt(1) == p[j].charAt(1) ? 0 : 1) +
                           (p[i].charAt(2) == p[j].charAt(2) ? 0 : 1) +
                           (p[i].charAt(3) == p[j].charAt(3) ? 0 : 1);
                diff[ans - 1] ++;
            }
        }
        System.out.print(diff[0] + " " + diff[1] + " " + diff[2] + " " + diff[3]);
    }
} 
```

有什么想法可以使这种方法更快吗？我注意到输入中只允许有限的一组字符（'0' .. '9', 'a' .. 'f'）所以我们可以创建数组（内存限制就足够了）来快速检查是否之前输入过的字符。

谢谢...我不需要实际的实施，只需快速的想法/想法就可以了。 **编辑：**感谢伟大的想法。我已经尝试使用位逻辑对 O(n^2) 进行改进，但仍然超出了时间限制。帕斯卡代码如下。

```
program Project2;

{$APPTYPE CONSOLE}

var
  i, j, n, k, bits: integer;
  arr: array[1..65536] of integer;
  diff: array[1..4] of integer;
  a, b, c, d: char;

function g(c: char): integer; inline;
begin
  if ((c >= '0') and (c <= '9')) then
  begin
    Result := Ord(c) - 48;
  end
  else
  begin
    Result := Ord(c) - 87;
  end;
end;

begin
  Readln(n);
  for i := 1 to n do
  begin
    Read(a); Read(b); Read(c); Readln(d);
    arr[i] := g(a) * 16 * 16 * 16 + g(b) * 16 * 16 + g(c) * 16 + g(d);
    for j := 1 to i - 1 do
    begin
      bits := arr[i] xor arr[j];
      k := ((bits or (bits shr 1) or (bits shr 2) or (bits shr 3)) and $1111) mod 15;
      Inc(diff[k]);
    end;
  end;
  Write(diff[1], ' ', diff[2], ' ', diff[3], ' ', diff[4]);
{$IFNDEF ONLINE_JUDGE}
  Readln;
{$ENDIF}
end. 
```

所以我想，我必须尝试其他更好的建议..

**编辑：** 我已经尝试过 Daniel 的算法，它非常有前途，也许下面的代码有错误，在测试 10 中不断得到错误的答案......有人可以看看吗？非常感谢...

```
import java.util.*;
import java.io.*;

public class testtest
{
    private static int g(char ch)
    {
        if ((ch >= '0') && (ch <= '9'))
        {
            return (int)ch - 48;
        }
        return (int)ch - 87;
    }

    public static void main(String[] args) throws IOException
    {
        BufferedReader rr = new BufferedReader(new InputStreamReader(System.in));
        int n = Integer.parseInt(rr.readLine());
        int[] p = new int[n];
        int[] all = new int[65536];
        int[][] miss = new int[4][4096];
        int[] g12 = new int[256];
        int[] g13 = new int[256];
        int[] g14 = new int[256];
        int[] g23 = new int[256];
        int[] g24 = new int[256];
        int[] g34 = new int[256];
        int[][] gg = new int[4][16];
        int same3, same2, same1, same0, same4;
        for (int i = 0; i < n; i ++)
        {
            String s = rr.readLine();
            int x = g(s.charAt(0)) * 4096 + g(s.charAt(1)) * 256 + g(s.charAt(2)) * 16 + g(s.charAt(3));
            p[i] = x;
            all[x] ++;
            miss[0][x >> 4] ++;
            miss[1][(x & 0x000F) | ((x & 0xFF00) >> 4)] ++;
            miss[2][(x & 0x00FF) | ((x & 0xF000) >> 4)] ++;
            miss[3][x & 0x0FFF] ++;
            g12[x >> 8] ++;
            g13[((x & 0x00F0) >> 4) | ((x & 0xF000) >> 8)] ++;
            g14[(x & 0x000F) | ((x & 0xF000) >> 8)] ++;
            g23[(x & 0x0FF0) >> 4] ++;
            g24[(x & 0x000F) | ((x & 0x0F00) >> 4)] ++;
            g34[x & 0x00FF] ++;
            gg[0][x >> 12] ++;
            gg[1][(x & 0xF00) >> 8] ++;
            gg[2][(x & 0xF0) >> 4] ++;
            gg[3][x & 0xF] ++;
        }

        same4 = 0;
        for (int i = 0; i < 65536; i ++)
        {
            same4 += (all[i] - 1) * (all[i]) / 2;
        }

        same3 = 0;
        for (int i = 0; i < 4096; i ++)
        {
            same3 += (miss[0][i] - 1) * (miss[0][i]) / 2;
            same3 += (miss[1][i] - 1) * (miss[1][i]) / 2;
            same3 += (miss[2][i] - 1) * (miss[2][i]) / 2;
            same3 += (miss[3][i] - 1) * (miss[3][i]) / 2;
        }

        same2 = 0;
        for (int i = 0; i < 256; i ++)
        {
            same2 += (g12[i] - 1) * g12[i] / 2;
            same2 += (g13[i] - 1) * g13[i] / 2;
            same2 += (g14[i] - 1) * g14[i] / 2;
            same2 += (g23[i] - 1) * g23[i] / 2;
            same2 += (g24[i] - 1) * g24[i] / 2;
            same2 += (g34[i] - 1) * g34[i] / 2;
        }

        same1 = 0;
        for (int i = 0; i < 16; i ++)
        {
            same1 += (gg[0][i] - 1) * gg[0][i] / 2;
            same1 += (gg[1][i] - 1) * gg[1][i] / 2;
            same1 += (gg[2][i] - 1) * gg[2][i] / 2;
            same1 += (gg[3][i] - 1) * gg[3][i] / 2;
        }

        same3 -= 4 * same4;
        same2 -= 6 * same4 + 3 * same3;
        same1 -= 4 * same4 + 3 * same3 + 2 * same2;
        same0 = (int)((long)(n * (n - 1) / 2) - same4 - same3 - same2 - same1);
        System.out.print(same3 + " " + same2 + " " + same1 + " " + same0);
    }
} 
```

**编辑** 终于得到了交流...感谢丹尼尔如此出色的算法！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T13:49:27.487

对于 small `n`，检查每一对的蛮力`O(n²)`算法当然更快，因此人们希望找到一个好的切换算法的截止点。在没有测量的情况下，由于信封背面的考虑，我预计值在 200 到 3000 之间。

通过将海盗 ID`int`解析为十六进制数字，将其转换为 。将 ID 存储在

```
int[] pirates = new int[n]; 
```

首先，计算具有相同 ID 的海盗对的数量（此处可以省略此步骤，因为问题陈述中没有）。

```
int[] allFour = new int[65536];
for(int i = 0; i < n; ++i) {
    allFour[pirate[i]] += 1;
}
int fourIdentical = 0;
for(int i = 0; i < 65536; ++i) {
    fourIdentical += allFour[i]*(allFour[i] - 1) / 2;
} 
```

接下来，计算 ID 中具有三个相同半字节的海盗对，

```
int oneTwoThree(int p) {
    return p >> 4;
}
int oneTwoFour(int p) {
    return (p & 0x000F) | ((p & 0xFF00) >> 4);
}
int oneThreeFour(int p) {
    return (p & 0x00FF) | ((p & 0xF000) >> 4);
}
int twoThreeFour(int p) {
    return p & 0x0FFF;
}

int[] noFour  = new int[4096];
int[] noThree = new int[4096];
int[] noTwo   = new int[4096];
int[] noOne   = new int[4096];

for(int i = 0; i < n; ++i) {
    noFour[oneTwoThree(pirate[i])] += 1;
    noThree[oneTwoFour(pirate[i])] += 1;
    noTwo[oneThreeFour(pirate[i])] += 1;
    noOne[twoThreeFour(pirate[i])] += 1;
}

int threeIdentical = 0;
for(int i = 0; i < 4096; ++i) {
    threeIdentical += noFour[i]*(noFour[i]-1) / 2;
}
for(int i = 0; i < 4096; ++i) {
    threeIdentical += noThree[i]*(noThree[i]-1) / 2;
}
for(int i = 0; i < 4096; ++i) {
    threeIdentical += noTwo[i]*(noTwo[i]-1) / 2;
}
for(int i = 0; i < 4096; ++i) {
    threeIdentical += noOne[i]*(noOne[i]-1) / 2;
} 
```

但是，对于每对具有四个相同半字节的海盗，这里已经计算了`4 choose 3 = 4`多次，对于三个半字节的每个可能选择，所以我们需要减去它（好吧，不是为了问题，而是原则上）：

```
threeIdentical -= 4*fourIdentical; 
```

然后，计算 ID 中有两个相同半字节的海盗对：

```
int oneTwo(int p) {
    return p >> 8;
}
int oneThree(int p) {
    return ((p & 0x00F0) >> 4) | ((p & 0xF000) >> 8);
}
int oneFour(int p) {
    return (p & 0x000F) | ((p & 0xF000) >> 8);
}
int twoThree(int p) {
    return (p & 0x0FF0) >> 4;
}
int twoFour(int p) {
    return (p & 0x000F) | ((p & 0x0F00) >> 4);
}
int threeFour(int p) {
    return p & 0x00FF;
} 
```

分配 6 个 256 `int`s 的数组并计算海盗的数量，其中相应的半字节位于`a`和`b`，例如

```
int twoIdentical = 0;
int[] firstTwo = new int[256];
for(int i = 0; i < n; ++i) {
    firstTwo[oneTwo(pirate[i])] += 1;
}
for(int i = 0; i < 256; ++i) {
    twoIdentical += firstTwo[i]*(firstTwo[i] - 1) / 2;
}
// analogous for the other five possible choices of two nibbles 
```

但是，这里有四个相同的半字节的对已经被计数`4 choose 2 = 6`了，而具有三个相同的半字节的对已经被计数了`3 choose 2 = 3`，所以我们需要减去

```
twoIdentical -= 6*fourIdentical + 3*threeIdentical; 
```

接下来，具有一个相同半字节的对数。我相信您可以猜到需要哪些四个函数和数组。然后我们将计算具有四个相同半字节的对，计算`4 choose 1 = 4`具有三个相同半字节`3 choose 1 = 3`的对，以及具有两个相同半字节的对`2 choose 1 = 2`，所以

```
oneIdentical -= 4*fourIdentical + 3*threeIdentical + 2*twoIdentical; 
```

最后，没有相同半字节的对数为

```
int noneIdentical = (int)((long)n*(n-1) / 2) - oneIdentical - twoIdentical - threeIdentical - fourIdentical; 
```

（`long`为了避免溢出`n*(n-1)`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:58:56.063

这可能是比较标识符对的快速方法。它假定两个标识符都作为十六进制数字而不是字符串读入。

```
int bits = p[i] ^ p[j];
int ans = ((bits | bits >> 1 | bits >> 2 | bits >> 3) & 0x1111) % 15;
diff[ans - 1]++; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T01:17:29.630

这个怎么样：

创建一个 4 维整数数组，每个维度都是`16`元素宽，所有元素都初始化为`0`。所以，这将是`16*16*16*16*4 = 262144`字节，大约是`262KB`. 现在，在读取每个标识符时将它们索引（插入）到该结构中。`counter`索引时，在每个维度上递增...

当您对该结构进行索引时，您可以逐步计算所需的答案。

例如，假设我正在索引标识符**dead**。在第一个维度上，选择**d**对应的位置，假设这个位置的计数器是`n1`，这意味着到目前为止，在位置 1已经有**d**`n1`的标识符。现在取**e**并将其插入到第二个维度上的正确位置...并说这个位置的计数器是，那么我肯定知道与插入的当前标识符相比，存在 3 个位置不同的标识符...****`n2``n1 - n2`****

 ******编辑：**我开始怀疑自己。如果两个标识符在第一个字符中不同但在第二个字符中相等怎么办？这种方法将无法接受我的想法。需要多思考...

**编辑：**暂停“智能解决方案”后，我尝试改进基本`O(n^2)`算法，如下所示。

每个标识符都有 4 个十六进制数字，因此可以打包成一个整数（不过一个 2 字节的字就足够了）。所以，这样的整数看起来像：

```
[ ][ ][ ][ ] * [ ][ ][ ][ ] * [ ][ ][ ][ ] * [ ][ ][ ][ ] 
```

其中每个`[ ]`代表一个位，每个`[ ][ ][ ][ ]`组（半字节）对应于标识符中的一个十六进制数字。现在我们需要一种方法来快速比较这两个标识符。给定两个标识符`a`和`b`，首先我们计算`c = a ^ b`，这将给我们两个位模式的**XOR （差异，排序）。**现在我们将此位模式`c`与以下常量模式进行比较：

```
u = [1][1][1][1] * [0][0][0][0] * [0][0][0][0] * [0][0][0][0]

v = [0][0][0][0] * [1][1][1][1] * [0][0][0][0] * [0][0][0][0]

w = [0][0][0][0] * [0][0][0][0] * [1][1][1][1] * [0][0][0][0]

x = [0][0][0][0] * [0][0][0][0] * [0][0][0][0] * [1][1][1][1] 
```

对比如下：

```
diffs = 0

if (c & u)
  diffs++
if (c & v)
  diffs++
if (c & w)
  diffs++
if (c & x)
  diffs++ 
```

在此操作结束时，`diffs`将包含与`a`和`b`不同的字符数。请注意，可以在不将标识符打包成整数的情况下实现相同的方法（即，将每个十六进制数字保留在它自己的整数/字符类型上），但我认为这种打包节省的内存可能意味着什么。

恕我直言，这只是对基本`O(n^2)`算法的微小改进。如果接受的答案是这种**诡计**而不是基于更好的算法/数据结构的答案，我会非常失望。急切地等待有人就这样的答案提供一些建议...... :-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-18T15:14:28.683

这可以通过单次遍历 id 列表来解决，因此需要 O(n) 时间，但您仍然需要小心，以便实现及时运行。

考虑查找相等字符串对的问题。这可以通过跟踪先前在地图中找到的每个字符串的计数来完成：

```
long pairs = 0;
Set<String, Long> map = new HashMap<String, Long>();
for(String id:ids) {
    if(map.containsKey(id)) {
        pairs += map.get(id);
        map.put(id, map.get(id) + 1);
    } else {
        map.put(id, 1);
    }
} 
```

现在找到一个字符不同的对。您可以存储不包括每个字符的字符串。所以对于“abcd”，存储“.bcd”、“a.cd”、“ab.d”和“abc”。在地图中。对于每个 id，您可以为每个缺失的字符位置添加每个字符串的计数。这也将计算相等的字符串，因此减去相等字符串的计数。

[使用包含/排除原则](http://en.wikipedia.org/wiki/Inclusion%E2%80%93exclusion_principle)泛化到更多缺失的字符。例如，具有 2 个不同字符的字符串的计数`s`为：

```
sum of all character positions `x` and `y`:
    the number of strings equal to `s` excluding characters `x` and `y`
    - the number of strings equal to `s` excluding character `x`
    - the number of strings equal to `s` excluding character `y`
    + the number of strings equal to `s` 
```

出于效率原因，您不想进行字符串操作，因此实际实现应将字符串转换为整数。此外，您可以使用长数组代替 Map（其中索引表示字符串，值是匹配字符串的计数）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-17T23:46:04.807

除了计算对，你可以只计算匹配然后计算对吗？以 d 开头的 IE 5 代码实际上是 5！= 10 对。

这将允许您使用可以在插入时而不是迭代地计算位置匹配的结构。

编辑：

当时我在想也许有一个带有根节点和 4 个嵌套级别的树结构。每个级别代表代码中的一个位置。IE 根目录 -> d -> e -> a -> f。当您插入每个代码时，如果该字符在该级别不存在，则插入它，如果它确实符合它。在每次代码插入结束时，您将知道该代码有多少匹配项，然后将其添加到`diff`. 然后通过取 n! 转换为对，而不仅仅是匹配项！每个桶的。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-17T23:51:06.993

您有`n!/(n-2)!2! =`O(n ² ) 对（n - 输入数），无论您做什么，都需要检查它们，因为这是要求。

您可以通过将整个输入插入[DAWG](http://en.wikipedia.org/wiki/Directed_acyclic_word_graph)并稍后遍历它来优化时间。对于 DAWG 中的任何 2 条路径，相似性定义为由两条路径中存在的边组成的集合。构造这个集合并从路径长度中减去它的大小以找到差异距离。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-19T01:42:06.267

我们可以将私有数映射到一个 3 维矩阵 P[x][y][z] 吗？

*   x 是私人的数量（2 ≤ n ≤ 65536）。
*   y 是介于 0 和 15 (0 - 9, a - f) 之间的标识符。
*   z 将是 1，包含标识符 (0 - f) 的选项。

例如：

死
牛肉
f00d

相应的 p[x][y] 将是

**0 1 2 3 4 5 6 7 8 9 abcdef**

0 0 0 0 0 0 0 0 0 0 1 0 0 1 1 0
0 0 0 0 0 0 0 0 0 0 0 1 0 0 1 1
1 0 0 0 0 0 0 0 0 0 0 0 0 1 0 1

z 维数为

0 0 0 0 0 0 0 0 0 2 0 0 9 4 0 (2 -> 0010, 9 -> 1001, 4 -> 0100)
0 0 0 0 0 0 0 0 0 0 8 0 0 6 1 (6 -> 0110, 8 -> 1000, 1 -> 0001)
6 0 0 0 0 0 0 0 0 0 0 0 1 0 8

我们逐列检查 p[x][y]，如果 2 个海盗有相同的标识符，那么我们在他们的位置之间做一个“&”位运算并保存结果（可能需要另一个矩阵来决定这 2 个pirates 在当前列中的新匹配之前匹配，O(1))。

遍历这个矩阵一次可能就足够了 O(n)。

还没有通过代码证明，这是个好主意。希望能帮助到你。

感谢这个谜题。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-19T03:13:48.367

该答案是对@fgb / @Daniel 提供的答案的详细说明。

让我们将每个标识符表示为`H1H2H3H4`（四个十六进制数字）

1.  我们有**四个**数组，每个数组都是 length `16*16*16 (4096)`。这四个数组将用于跟踪在 3 个位置相等的标识符。

2.  对于读取的每个标识符，计算值（整数）`H2H3H4`, `H1H3H4`, `H1H2H4`, `H1H2H3`（请注意，这些值的范围是 0 - 4095；这就是我们选择数组大小为 4096 的原因）。现在，使用这些值中的每一个来索引步骤（1）中提到的四个数组，并将相应的位置加一。

3.  我们还有另外**六个**数组，每个数组都是 length `16*16 (256)`。这五个数组将用于跟踪在 2 个位置相等的标识符。

4.  对于读取的每个标识符，计算值（整数）`H3H4`, `H2H4`, `H1H4`, `H1H3`, `H1H2`, `H2H3`。现在，使用这些值中的每一个来索引步骤（3）中提到的六个数组，并将相应的位置加一。每个数组位置有效地计算在 2 个位置相等的标识符的数量（但请注意，此计数也将包括在 3 个位置相等的标识符的数量）。

5.  我们还有另外**四个**数组，每个数组都是 width `16`。这四个数组将用于跟踪在 1 位置相等的标识符。

6.  对于读取的每个标识符，计算值（整数）`H4`, `H3`, `H2`, `H1`。现在，使用这些值中的每一个来索引步骤（5）中提到的四个数组，并将相应的位置加一。每个数组位置有效地计算在 1 个位置相等的标识符的数量（同样，这个计数将包括在 3、2 个位置相等的标识符的数量）。

请注意，所有这些都可以通过输入一次完成。然而，这还不足以计算最终答案，我们必须在步骤 1 - 6 的同时逐步计算最终答案。我们可以这样做：

```
diff1 = 0
diff2 = 0
diff3 = 0
diff4 = 0 
```

*   在步骤 (2) 中，当我们增加某个数组位置时，如果结果值为`u (u > 1)`，则`diff1 = diff1 + (u - 1)`。这意味着，使用`(u - 1)`已经找到的标识符，我们可以制作`(u - 1)`新的对（通过将它们中的每一个与当前标识符配对）。

*   在步骤（4）中，当我们增加某个数组位置时，如果结果值为`v (v - u >= 1)`then `diff2 = diff2 + (v - u)`。这意味着，我们知道`u`在上一步中已经考虑了许多标识符，它们不应该被重新计算。因此，**仅**在2 个位置`(v - u)`给出与该标识符相等/不同的其他标识符。使用这些标识符，我们可以制作新的对（通过将它们中的每一个与当前标识符配对）。**`(v - u)`**

***   在步骤 (6) 中，当我们增加某个数组位置时，如果结果值为`w (w - u >= 1)`then `diff3 = diff3 + (w - u)`。解释与上面的解释非常相似。** 

 **再次注意，所有这些步骤都可以在整个输入的单次通过期间完成。

现在，接下来是如何计算`diff4`。这可以在步骤 (2) 中完成，当我们增加某个数组位置时，如果新值为 1，那么`diff4 = diff4 + 1` **如果**新值为 2，那么`diff4 = diff4 - 1`。这会跟踪迄今为止尚未找到匹配标识符的**新标识符。**

**更新：**上述方法效果很好，但我建议的计算方法`diff4`不起作用。基本上，不是关于唯一标识符，而是我们可以通过组合在所有 4 个位置上**彼此**`diff4`不同的标识符来形成多少对。

 **`diff4`在 C 中的以下实现中采用了不同的方法 (for )：

```
#include <stdio.h>
#include <stdlib.h>

// forward declarations
__inline int update_same3 (int x1, int x2, int x3, int* map, int* diff1, int* overlaps);
__inline int update_same2 (int x1, int x2, int u, int* map, int* diff2, int* overlaps);
__inline void update_same1 (int x1, int v, int* map, int* diff3, int* overlaps);

int main () {
  // number of input identifiers
  int n = 0;

  // each identifier represented as four hexa-decimal digits
  int h1, h2, h3, h4; 

  // final answer
  int diff1 = 0;
  int diff2 = 0;
  int diff3 = 0;
  int diff4 = 0;

  int i, u1, u2, u3, u4, v1, v2, v3, v4, v5, v6, overlaps;

  // maps for keeping track of the identifiers
  int* maps [14];
  maps[0] = (int*) calloc (4096, sizeof(int)),  // h1h2h3
  maps[1] = (int*) calloc (4096, sizeof(int)),  // h2h2h4
  maps[2] = (int*) calloc (4096, sizeof(int)),  // h1h3h4
  maps[3] = (int*) calloc (4096, sizeof(int)),  // h2h3h4
  maps[4] = (int*) calloc (256, sizeof(int)),  // h1h2
  maps[5] = (int*) calloc (256, sizeof(int)),  // h1h3
  maps[6] = (int*) calloc (256, sizeof(int)),  // h1h4
  maps[7] = (int*) calloc (256, sizeof(int)),  // h2h3
  maps[8] = (int*) calloc (256, sizeof(int)),  // h2h4
  maps[9] = (int*) calloc (256, sizeof(int)),  // h3h4
  maps[10] = (int*) calloc (16, sizeof(int)),  // h1
  maps[11] = (int*) calloc (16, sizeof(int)),  // h2
  maps[12] = (int*) calloc (16, sizeof(int)),  // h3
  maps[13] = (int*) calloc (16, sizeof(int)),  // h4

  // main loop
  fscanf (stdin, "%d\n", &n);
  for (i = 0; i < n; i++) {
    // scan identifier 
    fscanf (stdin, "%1x%1x%1x%1x", &h1, &h2, &h3, &h4);

    // keeps track of the number of identifiers that the current
    // identifier overlaps with, required for calculating diff4
    overlaps = 0;

    u1 = update_same3 (h1, h2, h3, maps[0], &diff1, &overlaps); //h1h2h3
    u2 = update_same3 (h1, h2, h4, maps[1], &diff1, &overlaps); //h1h2h4
    u3 = update_same3 (h1, h3, h4, maps[2], &diff1, &overlaps); //h1h3h4
    u4 = update_same3 (h2, h3, h4, maps[3], &diff1, &overlaps); //h2h3h4

    v1 = update_same2 (h1, h2, u1 + u2, maps[4], &diff2, &overlaps); //h1h2
    v2 = update_same2 (h1, h3, u1 + u3, maps[5], &diff2, &overlaps); //h1h3
    v3 = update_same2 (h1, h4, u2 + u3, maps[6], &diff2, &overlaps); //h1h4
    v4 = update_same2 (h2, h3, u1 + u4, maps[7], &diff2, &overlaps); //h2h3
    v5 = update_same2 (h2, h4, u2 + u4, maps[8], &diff2, &overlaps); //h2h4
    v6 = update_same2 (h3, h4, u3 + u4, maps[9], &diff2, &overlaps); //h3h4

    update_same1 (h1, (v1 + v2 + v3) - (u1 + u2 + u3), maps[10], &diff3, &overlaps); //h1
    update_same1 (h2, (v1 + v4 + v5) - (u1 + u2 + u4), maps[11], &diff3, &overlaps); //h2
    update_same1 (h3, (v2 + v4 + v6) - (u1 + u3 + u4), maps[12], &diff3, &overlaps); //h3
    update_same1 (h4, (v3 + v5 + v6) - (u2 + u3 + u4), maps[13], &diff3, &overlaps); //h4

    // if the current identifier overlapped with n existing identifiers
    // then it did not overlap with (i - n) identifiers
    if (i - overlaps > 0)
      diff4 += (i - overlaps); 
  }

  // print results
  printf ("%d %d %d %d\n", diff1, diff2, diff3, diff4);
}

// identify overlaps at 3 positions
__inline int update_same3 (int x1, int x2, int x3, int* map, int* diff1, int* overlaps) {
  int idx = (x1 << 8 | x2 << 4 | x3);
  int u = (map[idx])++;
  if (u > 0) {
    (*diff1) += u;
    (*overlaps) += u;
  }
  return u;
}

// identify overlaps at 2 positions
__inline int update_same2 (int x1, int x2, int u, int* map, int* diff2, int* overlaps) {
  int idx = (x1 << 4 | x2);
  int v = (map[idx])++;
  if (v - u > 0) {
    (*diff2) += (v - u);
    (*overlaps) += (v - u);
  }
  return v;
}

// identify overlaps at 1 position
__inline void update_same1 (int x1, int v, int* map, int* diff3, int* overlaps) {
  int w = (map[x1])++;
  if (w - v > 0) {
    (*diff3) += (w - v);
    (*overlaps) += (w - v);
  }
} 
```

我用我自己的一些示例输入对此进行了测试，它似乎有效。如果 OP 可以对此进行测试并查看它是否有效，那就太好了。它可能需要更多的工作。

**更新：**好的，[它有效](http://acm.timus.ru/status.aspx?space=1&num=1932&author=133397)！必须重新格式化代码以使其通过那里的编译器。我还更新了此处列出的代码以反映更改。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-18T00:32:40.253

你能尝试一下这些方面的东西吗：

当您处理每个条目时，将其添加到位置一有特定字母的名称列表中。列表中的任何条目都已添加到“4 个匹配候选者”列表中。

然后将其添加到具有特定第二个字母的名称列表中。此列表中已有的“4 个匹配候选者”中的任何条目仍保留在“4 个匹配候选者”中，“4 个匹配候选者”中的所有其他条目与该列表中的所有条目一起移动到“3 个匹配候选者”列表中.

然后将其添加到具有特定第三个字母的名称列表中。此列表中已有的“3 个匹配候选者”中的任何条目仍保留在“3 个匹配候选者”中，“3 个匹配候选者”中的所有其他条目与该列表中已有的所有条目一起移动到“2 个匹配候选者”列表中列表。此列表中“4 个匹配候选者”中的任何条目都保留在“4 个匹配候选者”中，“4 个匹配候选者”中的所有其他条目都移动到“3 个匹配候选者”列表中。

然后将其添加到具有特定第四个字母的名称列表中。此列表中的任何条目都添加到 1 个匹配候选者的计数中，“2 个匹配候选者”列表中的任何条目都添加到 2 个匹配候选者的计数中，“3 个匹配候选者”列表中的任何条目都添加到3 个匹配候选者的计数，并且“4 个匹配候选者”列表中的任何条目都将添加到 4 个匹配候选者的计数中。

这应该意味着（希望）您只处理一次列表，而不是检查每个其他条目，您只需要检查在相同位置具有相同字母的子集。

或者，也许我需要睡觉了……

编辑：

所以我昨晚误解了目标。上述过程计算相似之处而不是差异，但我们可以使用类似的方法来计算差异。基本上为1个差异词、2个差异词、3个差异词和4个差异词保留4个列表。将到目前为止我们看到的所有单词添加到 4 个不同单词的列表中。然后从包含所有现有名称的列表开始，然后查找将当前单词第一个字母放在首位的单词列表。将这个列表中所有在 2 个差异列表中的单词移动到 1 个差异列表，3 个差异列表到 2 个差异列表，4 个差异列表到 3 个差异列表。

处理完所有列表后，您可以将每个列表中的 count 添加到全局计数中。

我认为这应该有效，但我稍后会联系它。..********

# sql - 如何从另一个 SQL Server 复制（或至少选择）数据？

> ID：13435784
> 
> 赞同：0
> 
> 时间：2012-11-17T23:20:12.860
> 
> 标签：sql, sql-server, sql-server-2005, sql-server-2012

我想将数据从一台服务器复制到另一台服务器，但不知道该怎么做（我已经有正确的表，使用 创建`Script Table As > Create To > New Query`）。

也许：

```
SELECT * FROM OPENDATASOURCE('SQLNCLI','Data Source=192.168.10.1\dbName;') 
```

或者：

```
exec sp_addlinkedserver @server = '192.168.10.1'
SELECT * FROM [192.168.10.1].[dbo].[myTableName] 
```

`IP`地址（当然还有用户名和密码..）是否足够？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T19:02:20.737

```
Addition new linkedserver & mapping between a login
EXEC sp_addlinkedserver
  @server = 'your_LServer',
  @srvproduct= '',
  @provider = 'SQLNCLI',
  @datasrc= '192.168.10.1\'

EXEC sp_addlinkedsrvlogin
  @rmtsrvname = 'your_LServer',
  @useself = 'FALSE',
  @locallogin = 'locallogin',
  @rmtuser = 'remotelogin', 
  @rmtpassword = 'remotepassword' 
```

在链接服务器上查询

```
SELECT * FROM your_LServer.dbo.myTableName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T01:46:09.043

如果是一次，我会使用远程服务器或链接服务器选项上的数据执行查询。如果不是一次，我们必须在将来进行更新，那么我们创建一个“复制”或者有一个第三方工具 Redgate 的 SQL 数据比较。

# c - 函数中的 fscanf（语言 C）

> ID：13435796
> 
> 赞同：0
> 
> 时间：2012-11-17T23:20:56.490
> 
> 标签：c, file

我正在使用 fscanf() 逐字符读取文本文件；

我试图将我的 FILE 指针传递给一个函数，以便继续阅读，但我陷入了一个循环。

```
void keepReading(FILE *fp){
     char c;
     fscanf(fp, "%c", &c);
}

/* main */
fscanf(fp, "%c", &c);
while(c!='A'){
    keepReading(fp);
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:24:44.533

变量`c`in`keepReading()`是该函数的局部变量。将值返回到您的循环并进行测试

```
char keepReading(FILE *fp){
     char c;
     fscanf(fp, "%c", &c);
     return c;
}

/* main */
fscanf(fp, "%c", &c);
while(c!='A'){
    c = keepReading(fp);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T23:44:48.667

不要`fscanf`用于此，如果您要逐字符读取文件，请使用读取字符的函数，`fgetc`. `fscanf`用于读取格式化数据。

```
#include <stdio.h>

int main(void)
{
    FILE *file = fopen("...", "r");
    int c;
    while ((c = fgetc(file)) != EOF)
    {
        if (c == 'A') break;
        // do stuff
    }
    fclose(file);
} 
```

# c# - Booksleve 中的 Redis 事务

> ID：13435797
> 
> 赞同：3
> 
> 时间：2012-11-17T23:21:04.090
> 
> 标签：c#, redis, booksleeve

下面的 3 个命令在按原样执行时可以完美运行。

```
using (var redis = NewRedisConnection)
{
    await redis.Open();
    var allKeys = await redis.Keys.Find(db, "searchPattern");
    var allVals = await redis.Strings.GetString(db, allKeys);
    await redis.Keys.Remove(db, allKeys);

    //process the data I pull from redis
} 
```

但是，当我尝试将它们包装在事务中时，它会停止工作。不会引发异常，但是如果我调试执行似乎会停止在`var allKeys = ...`设置事务时是否遗漏了什么？

```
using (var redis = NewRedisConnection)
{
    await redis.Open();
    var tran = redis.Createtransaction();

    var allKeys = await tran.Keys.Find(db, "searchPattern");
    var allVals = await tran.Strings.GetString(db, allKeys);
    await tran.Keys.Remove(db, allKeys);

    await tran.Execute();
    //process the data I pull from redis
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T23:26:38.493

事务在本地缓冲，直到您调用“exec”，然后以原子单元发送。如果您在执行之前“等待”，您将永远不会发送任何内容。只有**在**调用 execute 之后才需要“等待”事务中的操作。

其次，您**不能在事务期间查询数据**。更具体地说，您*可以*，但只有在调用“执行”时才能得到结果。这是 redis 工作方式的基本部分：简单地说，redis 事务与 SQL 事务不同。这意味着您无法根据交易期间查询的数据做出决策。但是，您可以在事务*之外*查询数据，然后确保它不会更改。使用 bookleeve，事务上的 AddConstraint 方法可以添加许多可以在事务期间安全验证的常见断言。

第三，Keys.Find**不**应该用作例行代码的一部分——应该很少使用，通常在调试和数据库分析期间。

在您的情况下，我想知道“哈希”是否是更好的选择 - 因此，与其“查找与此模式匹配的所有键，从这些键中获取所有值，删除所有这些键”，不如将其作为“获取所有值”来完成从此哈希中删除此哈希”。

所以类似（注意：手机代码！请原谅拼写错误）

```
using(var tran = conn.CreateTransaction())
{
    valsPending = tran.Hashes.GetAll(db, key);
    tran.Keys.Remove(db, key);
    await tran.Execute();
    var vals = await valsPending;
    // iterate dictionary in "vals", decoding each .Value with UTF-8
} 
```

如果它使上述更容易，我可以添加一个 GetAllString 。

# php - 跨网站替换文本？

> ID：13435798
> 
> 赞同：0
> 
> 时间：2012-11-17T23:21:54.527
> 
> 标签：php, string, replace

我帮助管理一个包含大量 html 文件的非营利性网站，大概有 1,000 个左右。断开的链接很麻烦，我想知道是否可以使用 PHP 创建一个程序来替换所有这些文件中的文本字符串（即 URL）。

这么多文件会造成很多服务器压力吗？假设有 10 个人同时使用该程序查找和替换所有 1,000 个文件，情况会怎样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:26:30.037

这当然是可能的！

这样做的关键是能够在 PHP 中读取文件并处理其内容。阅读很容易，写作也很简单。编辑是需要您注意的部分。

```
$yourFilename = "file.html";
$yourFileData = file_get_contents($yourFilename);
if ($yourFileData !== false) {
     // File has been read successfully
     // $yourFileData has the contents of it. This is where the magic needs to happen!
}
// Write everything back
$file = fopen($yourFilename,"w");
fwrite($file,$yourFileData);
fclose($file); 
```

这段代码有效地读取文件并写入文件。中间的部分是您进行搜索和替换的地方。我强烈建议为此使用正则表达式。我敢肯定，preg_replace 会派上用场。阅读它，并随时使用更多详细信息编辑您的问题 - 我非常乐意为您编写正则表达式。

遍历目录也非常简单。您想使用 opendir() 打开一个目录并使用 readdir() 循环，确保返回值不是 .、.. 或 false，并且是一个文件。

对于您的其他问题：多个用户，如果我是您，我会避免。这创造了竞争条件。

# c# - jquery+AJAX+c#导致页面加载

> ID：13435800
> 
> 赞同：3
> 
> 时间：2012-11-17T23:21:56.643
> 
> 标签：c#, jquery, asp.net, ajax

我正在尝试进行 Ajax 调用，但它导致页面加载这是我的 jquery 代码

```
 var ajaxUrl = "AjaxCallHandler.aspx";
function _init_Chart() {

$.ajax({
    type: "GET",        //GET or POST or PUT or DELETE verb
    url: ajaxUrl,       // Location of the service
    data: "OpCode=GetCallAverageReportForGraph&Parms=DeptId^17~Month^10~Year^2012",         //Data sent to server
    contentType: "",    // content type sent to server
    dataType: "string",     //Expected data format from server
    processdata: true,  //True or False
    success: function (responseString) {//On Successful service call
        alert(responseString);
    }
});

return false;
} 
```

这是我的 AjaxCallHandler.aspx.cs c# 代码

```
protected void Page_Load(object sender, EventArgs e)
{
    string responseMessage = "";
    string status = "SUCCESS";
    try
    {
        if (Request.QueryString["OpCode"] == null)
        {
            throw new Exception("Invalid Request, OpCode missing.");
        }
        string operationRequested = Request.QueryString["OpCode"];
        string Params = Request.QueryString["Parms"];
        switch (operationRequested)
        {
            case "GetCallAverageReportForGraph":
                responseMessage = GetCallAverageReportForGraph(Params);
                break;
            case "GetCallAverageReportDetails":
                responseMessage = GetCallAverageReportDetails(Params);
                break;
        }
    }
    catch (Exception exp)
    {
        status = "EXCEPTION";
        responseMessage = exp.Message;
    }
    Response.ClearContent();
    Response.ClearHeaders();
    Response.Write(responseMessage);
} 
```

我不知道为什么这件事会导致页面加载。我是 jquery AJAX 的新手，但是当我尝试使用 javascript AJAX 时，它在没有任何页面加载的情况下工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:33:07.240

我假设这是您的 AjaxCallHandler.aspx 背后的代码？

如果是这样，您的 AJAX 调用本质上只是加载该页面的结果，就像您使用浏览器窗口（即 GET）点击它一样。

大多数时候，当您想要执行 AJAX 请求时，您会针对返回 JSONResult ActionResult 或 Web 服务 (.asmx) 的 MVC 函数调用它。

由于您只是在访问常规网页，因此它总是会在该页面的代码后面执行 Page_Load 事件。

# css - 如何将背景图像与文本垂直居中对齐？

> ID：13435803
> 
> 赞同：20
> 
> 时间：2012-11-17T23:23:27.097
> 
> 标签：css, vertical-alignment

我无法将背景图像与文本垂直对齐，而没有为`height`or分配常量（因此，不是自动和可重用）值`line-height`。我想知道是否真的有一种方法可以垂直居中对齐 bg 图像，比如`a`元素`, with its text without assigning constant values to`行高`or`？

现场演示可在此处获得：[http](http://cssdesk.com/8Jsx2) ://cssdesk.com/8Jsx2 。

这是HTML：

```
<a class="">background-position: center</a>
<a class="contain">background-size: contain</a>
<a class="line-height">Constant line-height</a> 
```

这是CSS：

```
a {
  display: block;
  margin: 10px;
  width: 200px;
  padding-left: 34px;
  font-size: 14px;  

  background: url('http://cdn1.iconfinder.com/data/icons/freeapplication/png/24x24/Thumbs%20up.png');  
  background-repeat: no-repeat;
  background-position: 5px center;

  border: 1px solid black;
}

/* I don't want to use constant line-height */
.line-height {
    line-height: 24px;
}

/* I don't want to use this, because I want my bg image's size to stay intact */
.contain {
    background-size: contain;   
} 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-12-12T20:46:53.060

尝试使用两个词将您的背景与 css 对齐。

```
background-position: left center; 
```

参考：[http ://www.w3schools.com/cssref/pr_background-position.asp](http://www.w3schools.com/cssref/pr_background-position.asp)

更新：

从评论中添加另一个链接。Grant Winney 分享了另一个站点，该站点具有更好的界面来说明其工作原理。

[https://developer.mozilla.org/en-US/docs/Web/CSS/background-position](https://developer.mozilla.org/en-US/docs/Web/CSS/background-position)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:55:58.277

我认为仅使用 CSS 是不可能的，因为背景图像不会影响其包含元素的高度。您需要检测背景图像的大小，这需要 javascript。在 Javascript 中检测元素的宽度和高度涉及`img`从背景图像创建一个。

这是一个使用 Javascript 并`display: table`达到预期结果的解决方案：

工作示例：http: [//jsbin.com/olozu/9/edit](http://jsbin.com/olozu/9/edit)

CSS：

```
div {
    display: table; 
}

a {
    display: table-cell;
    vertical-align: middle;
    margin: 10px;
    width: 200px;
    padding-left: 34px;
    font-size: 14px;  

    background: url('http://cdn1.iconfinder.com/data/icons/freeapplication/png/24x24/Thumbs%20up.png');  
    background-repeat: no-repeat;
    background-position: 0 0;
    border: 1px solid black;
} 
```

HTML：

```
<div><
    <a id="example-a">background-position: center</a>
</div> 
```

JS：

```
$(function() {

    var imageSrc = $('#example-a')
                 .css('background-image')
                   .replace('url(', '')
                      .replace(')', '')
                      .replace("'", '')
                      .replace('"', '');   

    var image = '<img style="display: none;" src="' + imageSrc + ' />';

    $('div').append(image);

    var width = $('img').width(),
        height = $('img').height(); 

    // Set the height of the containing div to the height of the background image
    $('#example-a').height(height);

}); 
```

我的答案基于以下来源[如何在 jQuery 中获取背景图像大小？](https://stackoverflow.com/questions/5106243/how-do-i-get-background-image-size-in-jquery)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T23:42:13.167

通过将`background`css 用于`center`背景图像，您将始终居中。问题是文本与控件中间的对齐方式。

您是否考虑过使用`em`单位来指定行高？您将需要指定某种高度以允许垂直中心发生。

或者，如果你不想使用`em`，你可以试试`display:table-cell`css。

检查 - [http://cssdesk.com/3ZXrH](http://cssdesk.com/3ZXrH) - 以上两个例子。我已经添加`height:10em;`以更好地演示正在发生的事情。

# spring - Maven Spring 项目 - 在不包含 web 的模块中使用 application-context.xml 测试 daos

> ID：13435806
> 
> 赞同：0
> 
> 时间：2012-11-17T23:24:00.647
> 
> 标签：spring, testing, maven, junit

Application-context.xml 在 web 模块中

pom
- 用户
-*具有业务逻辑和 daos 的各种其他模块*
- Web*仅依赖于服务层。只和你的朋友说话。*

Web 将用户作为依赖项。我（不应该）不能让依赖项反过来，因为它是循环的，所以我如何使用 Web 中的应用程序上下文进行测试？

我是否：
1\. 复制数据源信息的应用程序上下文？（代码味道）
2\. 将数据库应用程序上下文放在依赖链底部的休眠依赖项目中？
3\. 其他答案？

2 号似乎是最好的选择。当一切都在一个服务模块中时，我让测试工作，但我试图获得更多的模块化，所以我将用户特定的服务重构为一个单独的模块。

感谢您的任何想法。实际上，我选择在 web 和模块之间添加一个层，也称为服务，而不是在模块层中添加服务。我不认为这是典型的，但它提供了更好的信息隐藏并有助于强制打开/关闭。它与这种情况无关，所以我没有包括它。

工具：

*   智能 11
*   朱尼特
*   Maven 2
*   休眠 3
*   春天 3
*   MySql5.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T05:03:03.670

我最终在单元和网络之间使用了一个服务模块来在那里存储数据库上下文。Web 依赖于它，并且 Web 级别的应用程序上下文包括模块上下文和测试一样。我正在该层上进行服务级别集成测试。单元测试将使用模拟对象或 hql 来消除单元本身之外的任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T23:34:25.413

将执行用户模块依赖注入的上下文文件放在模块本身内。请记住，在 spring 中，您可以拥有很多上下文文件，并且可以导入它们。

要了解这背后的原因，请问问自己：我的应用程序的 Web 部分是否需要数据库，还是后端需要数据库？

# javascript - 将标记转换为选择范围

> ID：13435810
> 
> 赞同：0
> 
> 时间：2012-11-17T23:24:24.457
> 
> 标签：javascript, jquery, range, selection, rangy

如何将 jQuery 选择中的一组标记范围转换为一组范围[广泛](http://code.google.com/p/rangy/)的范围？

例如我有这个：

```
<div class="test-input">
    <p>
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas
        convallis dui id erat pellentesque et rhoncus nunc semper. Suspendisse
        malesuada {hendrerit velit nec }tristique. Aliq{uam gravida mauris at
        ligula venenatis rhoncus. Suspendisse inter}dum, nisi nec consectetur
        pulvinar, lorem augue ornare felis, vel lacinia erat nibh in ve{lit.
    </p>
    <p>
        Hendr}erit, felis ac fringilla lobortis, massa ligula aliquet justo, sit
        amet tincidunt enim quam {sollicitudin} nisi. Maecenas ipsum augue,
        commodo sit amet aliquet ut, laoreet ut nunc. Vestibulum ante ipsum
        primis in {fauc}ibus orci luctus et ultrices posuere cubilia Curae;
        Pellentesque tincidunt eros quis tellus laoreet ac dignissim turpis
        luctus. Integer nunc est, {pulvinar ac tempor ac, pretium ut odio.
    </p>
    <p>
        Pellentesque in arcu sit amet} odio scelerisque tincidunt. Lorem ipsum
        dolor sit amet, consectetur adipiscing elit. Pellentesque habitant morbi
        tristique senectus et netus et malesuada fames ac turpis egestas.
    </p>
</div> 
```

我想将文本转换为范围（`{`并`}`删除标记）。

我尝试使用这个：

```
function tokensToRanges(element) {
    element = $(element);
    var node = element.get(0);
    var ranges = [];
    do {
        var text = $(node).text(),
            start = text.indexOf('{'),
            end = text.indexOf('}') - 1,
            input = null;
        input = node.innerHTML.replace('{', '').replace('}', '');
        element.html(input);
        var range = rangy.createRange();
        range.selectCharacters(node, start, end);
        ranges.push(range);
    } while ($(node).text().indexOf('{') != -1);
    return ranges;
} 
```

但它的范围不正确。我认为该`selectCharacters`方法忽略了空格。

如果可能的话，我也不想使用[`TextRangeModule`](http://code.google.com/p/rangy/wiki/TextRangeModule)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T16:09:08.543

`selectCharacters()`不会忽略所有空白，但会忽略折叠的空白。例如，如果一个文本节点包含三个连续的空格字符，则只有第一个会影响字符数。我可以在该方法中添加一个选项来关闭该行为。

在回答你的问题时，Rangy 的测试套件有一个功能，它有点像你想要的，所以我在下面对其进行了调整。开始和结束范围标记可能出现在不同的节点中。

演示：http: [//jsfiddle.net/timdown/DdeFr/](http://jsfiddle.net/timdown/DdeFr/)

代码：

```
function RangeInfo() {}

RangeInfo.prototype = {
    setStart: function(node, offset) {
        this.sc = node;
        this.so = offset;
    },
    setEnd: function(node, offset) {
        this.ec = node;
        this.eo = offset;
    },
    toRange: function() {
        var range = rangy.createRange();
        range.setStart(this.sc, this.so);
        range.setEnd(this.ec, this.eo);
        return range;
    }
};

function getTextNodesIn(node) {
    var textNodes = [];
    function getTextNodes(node) {
        if (node.nodeType === 3) {
            textNodes.push(node);
        } else {
            for (var i = 0, l = node.childNodes.length; i < l; i++) {
                getTextNodes(node.childNodes[i]);
            }
        }
    }

    getTextNodes(node);
    return textNodes;
}

function tokensToRanges(el) {
    var rangeInfos = [];
    var currentRangeInfo;
    var textNodes = getTextNodesIn(el);

    $.each(textNodes, function() {
        var searchStartIndex = 0;
        var searchIndex;
        while ( (searchIndex = this.data.indexOf(currentRangeInfo ? "}" : "{", searchStartIndex)) != -1 ) {
            // Remove the marker. Doing this breaks existing ranges
            // in this node, which is why we use RangeInfo objects
            // instead of ranges
            this.data = this.data.slice(0, searchIndex) + this.data.slice(searchIndex + 1);
            if (currentRangeInfo) {
                currentRangeInfo.setEnd(this, searchIndex);
                rangeInfos.push(currentRangeInfo);
                currentRangeInfo = null;
            } else {
                currentRangeInfo = new RangeInfo();
                currentRangeInfo.setStart(this, searchIndex);
            }
            searchStartIndex = searchIndex;
        }
    });

    // Convert RangeInfos into ranges
    var ranges = [];
    $.each(rangeInfos, function() {
        ranges.push(this.toRange());
    });

    return ranges;
}

var ranges = tokensToRanges(document.body);
var applier = rangy.createCssClassApplier("highlight");
applier.applyToRanges(ranges); 
```

# delphi - 如何重载简单的整数德尔福函数？

> ID：13435812
> 
> 赞同：2
> 
> 时间：2012-11-17T23:24:30.070
> 
> 标签：delphi, types, overloading

使用 Delphi 7，我有几个采用单个整数参数的函数。这些函数对属于该对象的文本字符串进行操作。唯一的参数是文本中的字符索引或单词索引。例如，要在单词 i 或字符 Text[loc] 之后检索 Text 的下一个单词，我想要：

```
function NextWord(i:Integer): String; overload;
function NextWord(loc:Integer): String; overload; 
```

显然，这是模棱两可的。Delphi Help 说“重载的例程必须通过它们采用的参数数量或参数类型来区分。” 所以我定义了两种类型：

```
type WordIndex = Integer;
type CharIndex = Integer;
...
function NextWord(i:WordIndex): String; overload;
function NextWord(i:CharIndex): String; overload; 
```

但这不起作用，因为这些只是整数的别名。

Delphi 关于类型的帮助区分了“类型标识”、“类型兼容性”和“赋值兼容性”，然后没有说明如何使用这些区别。但它确实说要重复“类型”这个词来创建与整数不同的新类型：

```
type WordIndex = type Integer;    //really, a new type
type CharIndex = type Integer;
...
function NextWord(i:WordIndex): String; overload;
function NextWord(i:CharIndex): String; overload;
...
var WordNumber: WordIndex;      //variable of new type
...
  WordStr := NextWord(WordNumber);  //call overloaded function 
```

令我惊讶的是，这也不起作用。编译器将 WordIndex 识别为单独的类型，并编译重载函数，但在调用它时声称重载是不明确的。我还尝试将函数参数更改为 VAR（因为“对于 var 参数，形式和实际的类型必须相同。”），但这没有帮助。

上网时，我读到编译器首先根据参数的数量，然后根据它们的大小来消除重载函数的歧义。我想我可以让 WordIndex 成为 DWord 而不是 Integer，但我不希望它是 16 位，我使用 -1 来表示“无效的字号”。

最后，我在“重载过程和函数”的帮助中找到了这一点：“您可以传递给重载的例程参数，这些参数的类型与任何例程声明中的参数不同，但与一个以上的声明。......在这些情况下，如果可以不产生歧义，编译器会调用例程，其参数的类型具有容纳调用中实际参数的最小范围。”

所以我尝试了这个，它有效：

```
type WordIndex = -1..High(Integer);
type CharIndex =  Integer;
function NextWord(i:WordIndex): String; overload;
function NextWord(i:CharIndex): String; overload;
...
var WordNumber: WordIndex;
    loc: CharIndex;
...
  WordStr := NextWord(WordNumber);
  (or)
  WordStr := NextWord(loc); 
```

这样编译时不会出现警告或错误，并且实际上会为每个参数类型调用正确的函数。另外 SizeOf(WordIndex) = SizeOf(CharIndex) = 4。即它们都是整数。

我的问题是，我**应该**这样做吗？如果是这样，我怎么会知道呢？帮助或源代码中是否有类似的示例？

奖励问题：我检查过，并且将类型 WordIndex 设置为 Range 不会在调用或函数中产生代码/运行时开销。但它可能在代码的其他地方吗？Delphi 会在不会测试整数的任何地方测试 WordNumber 的范围错误吗？（我很确定答案是否定的。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-17T23:30:39.897

在这里尝试使用超载只会导致痛苦和痛苦。想象一下当你想使用整数文字时会发生什么？或者想象一下，您想向 NextWord 传递一个作为表达式的索引，例如 a+b。或者你传递一个函数的返回值。您是否将拥有返回您建议定义的各种专用类型的函数？想想任何必须阅读代码的人。他们将如何确定正在调用哪个重载？

你可以通过给你的函数起不同的名字来避免所有的痛苦。当您有多个接受不同类型参数的函数时，重载是合适的。这里情况不同。您的函数采用相同类型的参数。所以你的函数需要不同的名字。

组织它的另一种方法是拥有一个函数，但将更多传递给函数。传递索引和描述如何解释该索引的枚举类型。您可以将这两个值组合成一条记录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T14:33:34.607

如果遇到此类问题，请使用重构来分离不同的行为。例如，您可以按位置和字符索引拆分单词提取，您可以引入两个新类：

电话是：

```
MyClass.Location.NextWord(SomeIndex);
MyClass.Character.NextWord(SomeIndex); 
```

另一种方法可能是使用第二个参数提供该方法：

```
MyClass.NextWord(SomeWordIndex, wmiByWordLocation);
MyClass.NextWord(SomeCharIndex, wmiByCharLocation); 
```

但是，我建议重构。

# firebase - push() 期间创建 ID 的时间和位置

> ID：13435816
> 
> 赞同：1
> 
> 时间：2012-11-17T23:24:41.597
> 
> 标签：firebase

[push](https://www.firebase.com/docs/firebase/push.html)的文档让我做了这个小实验：

```
var FB = new Firebase(MYURL);
var ref = FB.push({test: 'push'}, function() { console.log('callback completed'); });
console.log(ref.name()); 
```

我看到`ref.name()`即使在调用异步回调之前，调用也会立即返回一个 ID。这是否意味着在没有咨询服务器的情况下在客户端创建 ID？我假设是这样，这引起了人们的好奇：

如果两个客户端发送相同的 ID，服务器将如何处理冲突？第二个会覆盖第一个吗？

我在这里不是假设两个客户端会创建冲突的 ID，而是假设恶意客户端可能会欺骗 ID 并覆盖现有记录。在为即将到来的安全性配置规则时，我需要注意这个问题吗？

更重要的是，我非常想知道 ID 是如何创建的，因此我可以确保正确使用它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T13:56:36.533

push 创建的 ID 是在调用 push 时创建的。我们这样做是为了让您拥有一个响应速度非常快的客户端，而不必等待网络延迟，并且您的客户端也可以在离线模式下工作。

ID 生成算法基于时间戳（以便 ID 保持有序）和随机后缀（除此之外还有更多内容，但这是基础知识）。该算法的设计是为了在我们的有生之年（甚至数百万年）中没有两个非恶意客户端会选择相同的密钥。

如果没有强制执行安全措施，恶意客户端可能会覆盖其他人的 ID（尽管他们很难猜测其他客户端将生成的 ID），是的，如果您需要为这些位置提供安全保护想防止这种情况。我不认为“push()”ID 具有其他位置没有的任何独特的安全需求。

# php - MySQL & PHP：何时与 MySQL 数据库建立连接？

> ID：13435819
> 
> 赞同：0
> 
> 时间：2012-11-17T23:25:26.680
> 
> 标签：php, mysql, sql

从 PHP 代码发出 MySQL/SQL 查询时，必须首先建立与数据库的连接。

请您告诉我，**我是否应该仅在用户的 Web 会话开始时，或者在加载新页面时，或者在每个 MySQL/SQL 查询之前建立与数据库的连接？**

我认为当不必要地与数据库建立连接的次数过多时，我会消耗不必要的系统资源。因此，我希望以最少的必要时间连接数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:30:54.640

必须时，您应该始终连接**数据库**。想象一下，谷歌或其他机器人在几秒钟内大量访问您的应用程序。有时，您的所有内容都将从您的缓存系统传送。

此外，重新打开数据库连接将直接花费您等待用户并由于上下文切换而消耗更多内存。您应该在需要时连接数据库，并且不必关闭它，因为当您的脚本执行结束时，您的数据库连接将自动结束。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:31:23.903

您应该在页面加载时连接到数据库。

为了最大限度地减少连接时间开销，请使用[持久连接。](http://php.net/manual/en/pdo.connections.php)

```
<?php
$dbh = new PDO('mysql:host=localhost;dbname=test', $user, $pass,
    array(PDO::ATTR_PERSISTENT => true));
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T23:33:04.760

如果您没有打开持久连接（是吗？），那么当脚本结束时（即每个页面）自动关闭连接。

而且，打开连接的执行不会消耗资源（好吧，确实如此，但时间很短）。保持开放的连接确实如此。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-17T23:33:22.650

你需要取得适当的平衡。每个部分都有它的问题。让我们回顾一下所有三种可能性

**持久的 MySQL 连接**

优点：加载一次后忘记

缺点：您需要确保自己终止任何不再处于活动状态的连接。此外，休眠连接仍会使用一些资源。不推荐，因为它的唯一好案例是大量请求，此时您很可能希望集群您的数据库服务器，而持久连接往往会对此造成严重破坏。

**一查询一请求模型**

优点：构建和忘记

缺点：极端的资源使用。

好的解决方案是适当的平衡。当您第一次真正需要它时加载您的 DBH，并保留它直到您的脚本结束，此时您应该释放它使用的所有资源并终止它。这保证您将使用所需的最少资源完成所有工作。

# javascript - 如何在 Windows 8 应用程序中实施和激活搜索？

> ID：13435820
> 
> 赞同：1
> 
> 时间：2012-11-17T23:25:38.587
> 
> 标签：javascript, search, windows-8

我想让我的应用程序使用 Windows 8 搜索功能，尽管浏览了 MSDN 上的大量搜索文档，但我似乎错过了第一步。首先，我已经声明我希望在项目清单中使用搜索，并且我已经在我的标题中添加了代码来链接我`default.html`的`searchResults.js file`.

然后文档建议使用系统搜索应该只是“工作”。这怎么不会发生在我身上，当我进行搜索时，它不会在默认的空白搜索结果页面上打开我的应用程序。我尝试将以下内容添加到我的`default.js`页面，但无济于事：

```
 // When the user submits a search query
Windows.ApplicationModel.Search.SearchPane.getForCurrentView().onquerysubmitted =
    // Call the function 
    function (eventObject) {

        winJS.log && WinJS.log("User submitted the search query: " + eventObject.queryText, "sample", "status");
}; 
```

我错过了什么？如何获得搜索魅力以实际激活我的应用程序并显示结果页面？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:59:31.907

我正在寻找一个 C# 项目。我创建了一个启动 js 项目，搜索在 2 分钟内工作。这就是我所做的

添加搜索合约，点击新增 -> 搜索合约

默认情况下，js 文件名为 searchResults.js

在您的主页或 default.html 页面上添加对 searchResults.js 的引用

这是我的样子

```
<head>
    <meta charset="utf-8" />
    <title>App4</title>

    <!-- WinJS references -->
    <link href="//Microsoft.WinJS.1.0/css/ui-dark.css" rel="stylesheet" />
    <script src="//Microsoft.WinJS.1.0/js/base.js"></script>
    <script src="//Microsoft.WinJS.1.0/js/ui.js"></script>

    <!-- App4 references -->
    <link href="/css/default.css" rel="stylesheet" />
    <script src="/js/default.js"></script>
    <script src="/searchResults.js"></script>
</head> 
```

最后在应用清单声明中，选择搜索支持的声明。就我而言，右侧的属性是空的。

就是这样！我在 onQuerySubmitted 函数中设置了一个断点。我运行该应用程序，调用搜索超级按钮（Windows 键 + Q）开始输入文本，然后按 Enter 键应该会遇到断点！

```
appModel.Search.SearchPane.getForCurrentView().onquerysubmitted = function (args)
{
    nav.navigate(searchPageURI, args); // put breakpoint here
}; 
```

希望这可以帮助。

# php - 用于简化 php 中等式的语法

> ID：13435822
> 
> 赞同：2
> 
> 时间：2012-11-17T23:25:53.187
> 
> 标签：php

我需要一些语法帮助来简化 php 中的方程（我已经使用 php 3 天了）。在做一些研究时，我发现可能有一种更简单的方法来编写方程。请参阅下面的现有代码：

```
<?php 
$w = $_POST['weight'];
$h = $_POST['height']; 
?>  

Hi, Your BMI is <?php echo bcmul(bcdiv($w,bcpow($h,2,2),2),703,2); ?> 
```

根据对[http://www.php.net/manual/en](http://www.php.net/manual/en)的评论，我可以简单地将代码改为：bc($w/($h)^2*703)。但是，我收到一条功能未定义的错误消息。有没有更简单的方法来编码这个方程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:32:19.067

为什么**需要**BC 功能？您**需要**任意精度吗？如果没有（因为大多数应用程序没有），你可以这样做：

```
$bmi = ($w/pow($h,2))*703; 
```

如果您需要获得一定数量的小数，请查看 PHP 的[number_format()](http://php.net/manual/en/function.number-format.php)，例如：

```
echo 'BMI to 3 decimal places is: '.number_format($bmi,3); 
```

# html - 为 Web 开发新应用程序有哪些选择

> ID：13435824
> 
> 赞同：2
> 
> 时间：2012-11-17T23:26:04.963
> 
> 标签：html, delphi, intraweb, raudus

我正在为一所学校创建一个新的应用程序。有财务和学术部分。这所学校已经在为学生使用平板电脑。

我认为 Metro UI 界面的新概念很有趣，就像拥有数据仪表板一样。我喜欢一些视觉效果。

我的背景是 Delphi（最高到 Xe2），SQL。我喜欢 delphi 的 RAD 方法。最近我使用 B4A 制作了一个应用程序，它是一个类似于 android 编译器的 Visual Basic，我对我的学习速度印象深刻（从未在 vb 上做过任何事情）并部署了一个漂亮的应用程序。

那里有很多新设备，特别是平板电脑，我预见我可以使用平板电脑代替 Windows PC，这将带来更低的成本和更容易处理。

然而，服务器是一个 Windows 服务器盒子，我对 linux 了解不多，也没有看到退出 Windows 服务器的价值。

因此，我正在寻找一种进行 RAD 开发的方法，最好使用 Delphi，但也可以是其他语言。

我不清楚 Delphi 选项：intraweb（即使使用 TMS 组件）似乎没有太多使用。我没有看到带有它的网站，并且似乎不可能有丰富的图形选项，至少可以模拟 Windows Metro 风格（具有近似质量）

Raudus 仍不清楚，Ext js 的选项很棒，但从项目中删除了。

我必须使用什么选项来创建基于多平台和基于 Web 的 RAD 应用程序？由于 HTML 5 开辟了一种新方法，Ria 可能会在未来几年内退出市场。

# javascript - 修复了移动 Safari 网站上带有文本字段的标题

> ID：13435833
> 
> 赞同：6
> 
> 时间：2012-11-17T23:27:12.747
> 
> 标签：javascript, css, header, mobile-safari, css-position

我一直在四处寻找，但似乎找不到任何解决此问题的方法。当输入字段在移动 safari 中获得焦点时（尚未检查其他浏览器），由于 safari 将该元素置于视图中（更靠近中心），固定元素将跳转。该错误仅在用户滚动时发生，如果用户仍位于页面顶部，则不会发生任何事情。

前后截图

![聚焦前](../Images/280241fcd279b1fd3a5ffdc39d826076.png)

![聚焦后](../Images/b16b643a0b5561c79e1520639a123063.png)

有谁知道如何解决这个问题？我遇到的唯一解决方案是在聚焦时滚动回顶部，然后在模糊滚动回原位......这似乎是一个非常草率的解决方案。

这是屏幕截图中的示例站点，非常基本，没有任何异常。

```
 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, scale=1"/> 
    <title>MySite</title>
    <style>
    body{
        height:100%;
        width:100%;
        padding:0;
        margin:0;
        font-size:16px;
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
    }
    header, footer {
        background-color:#333;
        padding:10px;
        color:#FFF;
        width:100%;
    }
    header {
        position:fixed;
        top:0;
        left:0;

    }
    input[type=search] {
        position:relative;
        margin-left:20px;
        width:160px;
        font-size:16px;
        height:26px;
    }
    section{
        padding:10px;
    }
    </style>
</head>
<body>
<header>
<b>MySite</b>
<input type='search' placeholder='Search'>
</header>
<section>
<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
</sction>
<footer>
&copy; MySite <?php echo date('Y') ?>
</footer>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-24T21:17:07.900

我有同样的问题。但我意识到，固定位置只是延迟而不是中断（至少对我而言）。滚动并等待 5-10 秒，然后查看搜索栏是否调整回屏幕顶部。我相信这不是错误，而是打开键盘时的延迟响应。

# matlab - 使用 fminsearch 时出错

> ID：13435836
> 
> 赞同：1
> 
> 时间：2012-11-17T23:27:40.423
> 
> 标签：matlab, optimization, runtime-error, fminsearch

我正在使用`fminsearch`通过扰动某些参数来最小化粗尺度协方差和细尺度协方差平均值之间的误差。这些是 2 行代码行，我在其中使用我打算扰乱的三个参数`fminsearch`调用目标函数：`minimize_me`

```
opts = optimset('display', 'iter');
[x,fval,exitflag] = fminsearch( @(x) minimize_me(x(1), x(2), x(3)), [2, 5, 90], opts); 
```

该函数`minimize_me`如下所示，它在其体内使用了更多函数：

```
function diff = minimize_me(a_minor, a_major, theta)

%# Grid and model parameters
nModel=50;
nModel_want=1;
nI_grid1=5;
Nth=1;
nRow.Scale1=5;
nCol.Scale1=5;
nRow.Scale2=5^2;
nCol.Scale2=5^2;
nCell.Scale1=nRow.Scale1*nCol.Scale1;

%% Covariance computation, averaging and difference of coarse and fine scale averaged covariances

% Reading files by using the function 'general_gslib_file_to_mat.mat'
[Deff_matrix_NthModel,~,~]=general_gslib_file_to_mat(nModel,nCell.Scale1,nModel_want,nI_grid1,Nth,'effective_dispersivity_coarsegrid5x5_gslib_format');

%# Maximum value of covariance/variogram at coarse scale
sill = var(reshape(Deff_matrix_NthModel,nCell.Scale1,1)); % variance of the coarse data matrix of size (nRow.Scale1 X nCol.Scale1)

%% Compute the covariance at different lags using the function general_CovModel.m

for ihRow = 1:nRow.Scale1
    for ihCol = 1:nCol.Scale1
        [cov.Scale1(ihRow,ihCol),heff.Scale1(ihRow,ihCol)] = general_CovModel(theta, ihCol, ihRow, a_minor, a_major, sill, 'Exp');
    end
end

for ihRow = 1:nRow.Scale2
    for ihCol = 1:nCol.Scale2
        [cov.Scale2(ihRow,ihCol),heff.Scale2(ihRow,ihCol)] = general_CovModel(theta, ihCol/(nCol.Scale2/nCol.Scale1), ihRow/(nRow.Scale2/nRow.Scale1), a_minor, a_major,...
            sill/(nRow.Scale2*nCol.Scale2), 'Exp');
    end
end

%# Scale-up of fine scale values by averaging which is done using the function general_AverageProperty.m
[covAvg.Scale2,var_covAvg.Scale2,varNorm_covAvg.Scale2] = general_AverageProperty(nRow.Scale2/nRow.Scale1,nCol.Scale2/nCol.Scale1,1,nRow.Scale1,nCol.Scale1,1,cov.Scale2,1);

%# Difference between the coarse scaled covariance and average of fine scale covariance
diff = (covAvg.Scale2 - cov.Scale1)^2;
end 
```

但是，在运行前面显示的前两行代码时，我收到此错误：

```
??? Subscripted assignment dimension mismatch.

Error in ==> fminsearch at 195
fv(:,1) = funfcn(x,varargin{:}); 
```

有人可以指出有什么问题吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T16:33:54.600

问题是，您没有为任何人提供足够的资源来测试您的代码。

所以你应该...

*   学习使用调试器！在任何情况下都是一个好主意。这将帮助您发现自己做错了什么，同时也教您使用有价值的工具。

*   使用起始值测试您的函数一次。它返回什么？你试过这个吗？总是做这个测试。验证您的目标是否符合您的预期。

Fminsearch 需要一个标量输出来最小化。你的功能有吗？

哦，顺便说一句，定义一个名为 diff 的变量或任何作为 MATLAB 中已经存在的有用工具的变量是一个糟糕的主意。否则，您只是恳求在您的代码中创建难以发现的错误。

# sql-server - 条件“Where”子句和自定义函数

> ID：13435837
> 
> 赞同：1
> 
> 时间：2012-11-17T23:28:07.210
> 
> 标签：sql-server, where-clause, sql-server-2012

在 SQL Server 2012 中，我有一个包含这个 where 子句的大查询：

```
(1 = Case 
    When (@bSomeSpecialCheck = 'Y') Then 
        Case When (dbo.SomeFunction(SomeColumn, @SomeParam)=1) Then 1 Else 0 End
Else 1 End) 
```

我知道“SomeFunction”很慢，我希望只有在@SomeParam 中有值时才对其进行评估。所以我用这种方式写了 where，因为如果不需要，我想避免执行“SomeFunction”。

好吧，事情是不管@bSomeSpecialCheck 总是“N”，SQL Server 似乎正在评估整个案例，因为如果我这样写它是为了测试目的：

```
(1 = Case 
    When (@bSomeSpecialCheck = 'Y') Then 
        Case When (1=1) Then 1 Else 0 End
Else 1 End) 
```

我得到了立即响应，所以我知道正在评估我的慢速函数“SomeFunction”，但为什么呢？仅当 @bSomeSpecialCheck 为“Y”时，如何避免评估 SomeFunction？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T00:05:14.017

我认为避免这种情况的唯一方法是复制您的查询

```
if (@bSomeSpecialCheck = 'Y') Then
begin
   Whole Query with function
end
else
begin
  Whole Query without function
end 
```

# html - 如何用 飞镖替换 \n？

> ID：13435839
> 
> 赞同：6
> 
> 时间：2012-11-17T23:28:32.663
> 
> 标签：html, dart

这行不通

```
 String t = "Lorem\nipsum";
    Element br = new Element.tag('br');
    t = t.replaceAll('\n', br); 
```

也不会

```
 String t = "Lorem\nipsum";
    String br = "<br>";
    t = t.replaceAll('\n', br); 
```

当然，如果 Dart 有一些安全的方法可以在前端处理 HTML 输入，那么这将是最佳解决方案。但我发现的最接近的是 afaik 只运行后端（？）的模板。

目前，只需将 \n 替换为 <br> 就可以了，但必须从前端完成，因为我正在构建的内容没有后端（目前仅使用 localStorage）。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T00:27:58.497

这有效：

```
String t = "Lorem\nipsum";
String br = "<br>";
t = t.replaceAll('\n', br);
query("#text").innerHTML = t; 
```

（如果您对这个答案感到满意，请不要害怕单击复选标记。我的老板答应如果我明天回答了 2 个问题，就请我吃午饭！）

# c++ - 在 C++ 中破坏指向动态二维数组的指针

> ID：13435841
> 
> 赞同：1
> 
> 时间：2012-11-17T23:29:20.103
> 
> 标签：c++, multidimensional-array

作为我从学校获得的作业的一部分，我一直在尝试解决这个分配/销毁问题，基本上我需要分配一个我设计的简单类的二维数组指针。

```
class RobotsWorld{
public:
    RobotsWorld(int width,int hight);
    ~RobotsWorld();
    /**
     * copy,Assign,operator=
     */
    //RobotsWorld(const RobotsWorld &);
    //void Assign(const RobotsWorld &);
    //RobotsWorld& operator=(const RobotsWorld &);

    bool addRobot(Robot & r,Point p);
    bool moveRobot(Robot & r);
    bool removeRobot(Robot & r);
    Point getPosition(Robot r);
    string toString();

    Robot* getRobotInWorld(Robot & r);

    /** validation functions **/
    bool checkOutOfBounds(int,int);
    bool isEmptySlot(int x,int y);
    bool ableToMove(Robot &);

private:
    Robot*** robots;
    Point point;
    int width,height;
}; 
```

这不是函数的完整源文件，但这些函数会导致崩溃\内存丢失。（是的，它必须被定义为三重指针 - ***机器人）

```
RobotsWorld::RobotsWorld(int width,int height)
:width(width),height(height)
{
    robots = new Robot**;
    *robots = new Robot*[height];

    for(int i = 0 ; i < height ; i++){
        robots[i] = new Robot*[width];
        for(int j = 0 ; j < width ; j++)
            robots[i][j] = NULL;
    }

}

RobotsWorld::~RobotsWorld(){

    for(int i = 0 ; i < height ; i++){
        delete [] robots[i];
        robots[i] = NULL;
    }
    delete [] *robots;
    delete **robots;
} 
```

机器人类和主类没有分配什么。我一直在努力寻找解决方案，但即使描述这种情况也证明自己很困难。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T23:34:20.313

您需要两个嵌套循环来删除 2D 指针数组 - 删除单个机器人，并删除机器人行：

```
RobotsWorld::~RobotsWorld(){
    for(int i = 0 ; i < height ; i++) {
        for(int j = 0 ; j < width ; j++) {
            delete robots[i][j]; // Delete each individual robot
        }
        delete[] robots[i]; // Delete the row of robots
    }
    // Finally delete the 2D array itself
    delete[] robots;
} 
```

虽然`NULL`在删除后设置指针通常是个好主意，但在析构函数中这样做会浪费 CPU 周期；我建议跳过。

这是很多工作（我相信你可以看到）。使用标准 C++ 库可以通过使用合适的容器来帮助您避免所有这些工作 - 比如说，

```
vector<vector<unique_ptr<Robot> > > robots; 
```

现在，与管理机器人内存相关的任务将自动处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:34:41.603

最后一行：

```
delete **robots; 
```

很可能是你的问题。它应该是：

```
delete robots; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-17T23:37:30.080

```
robots = new Robot**;
*robots = new Robot*[height]; 
```

不正确，你想要

```
robots = new Robot**[height]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-17T23:56:47.870

您想要存储指向 Robot 的二维指针数组。这是一个可能的初始化例程：

```
RobotsWorld::RobotsWorld(int width,int height)
:width(width),height(height)
{
  robots = new (Robot**)[height];

  for(int i = 0 ; i < height ; i++){
      (*robots)[i] = new (Robot*)[width];
      for(int j = 0 ; j < width ; j++)
          robots[i][j] = NULL;
  }
} 
```

析构函数应该实现双重操作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-17T23:43:56.497

我在这个答案中复制我的评论：

您还可以使用：

```
template <int WIDTH, int HEIGHT> 
class RobotsWorld
{
  public:
     /*... functions ...*/

  private:
     Robot robots[WIDTH][HEIGHT];
     /*... other private data ...*/
 }; 
```

而且你不必关心`new`/`delete`东西;-)

但是，您必须实现一些`operator`s 才能允许：

```
RobotsWorld<3,4> rw34; 
RobotsWorld<5,6> rw56 = rw34;
if (rw56 == rw34) /*...*/; 
```

如果您不需要像上面那样允许操作，那么`template`这是一个优雅的解决方案。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-17T23:40:01.280

我无法想象为什么有必要拥有一个`T***`并且我当然无法在没有辅助类的情况下为这样的事情维护资源！如果我不能`std::vector<T>`用来帮助维护，我将实现一个类似的类（嗯，这对我来说很容易：我已经实现了我自己的 C++ 标准库版本......）。

我没有寻找所有问题，但最直接的问题是您`new robots**`将结果视为具有超过`robots[i]`.

# node.js - 插入 mongodb node.js express

> ID：13435842
> 
> 赞同：0
> 
> 时间：2012-11-17T23:29:47.623
> 
> 标签：node.js, mongodb, express, mongoose

我正在尝试在我的 mongodb 中添加数据

```
models.user.find(function(err, docs){
    console.log(docs)
});

var user = new models.user.model({
    ...
})
user.save(); 
```

第一次console.log很好地返回我在用户集合中的所有内容但是当我想创建我的用户时，我有“无法调用未定义的方法'模型'”

我不明白为什么

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T23:36:36.027

我发现 ：）

```
models.user.find(function(err, docs){
console.log(docs)
});

var user = new models.user({
    ...
})
user.save(); 
```

# java - Java 服务器-客户端交互

> ID：13435843
> 
> 赞同：1
> 
> 时间：2012-11-17T23:29:51.853
> 
> 标签：java, sockets

我有一个可以托管多个客户端的服务器，以及一个可以连接的客户端。我试图能够选择其中一个客户并说，通过 PrintWriter 向他们发送消息。I 下面的代码仅供参考，甚至可能不需要使用。我只是想知道是否有办法向特定客户而不是所有客户发送消息。我不知道从哪里开始..我可以做服务器到客户端和客户端到服务器，但我希望服务器到客户端的通信被发送到特定的客户端

客户：

```
 import java.net.Socket;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;

import javax.swing.JOptionPane;

public class Main{
    private static Socket socket;
    private static PrintWriter printWriter;
    private static String inputLine;
    private static Thread thread;

    public static void main(String[] args) {
        // System.out.println("What is the computer's IP address?");
        String Ip_addr = JOptionPane
                .showInputDialog("Enter the IP number of the server to connect: ");
        String IP = Ip_addr;
        while (true) {

            try {
                System.out.println("Client running...");
                socket = new Socket(IP, 8080);
                BufferedReader bufferedReader = new BufferedReader(
                        new InputStreamReader(socket.getInputStream()));
                while ((inputLine = bufferedReader.readLine()) != null) {
                    System.out.println(inputLine);
                    JOptionPane.showMessageDialog(null, inputLine);
                }
            } catch (Exception e) {

            }

        }
    }
} 
```

服务器：

```
import java.net.ServerSocket;
import java.net.Socket;
import java.util.Scanner;
import java.awt.Desktop;
import java.io.BufferedReader;
import java.io.File;
import java.io.InputStreamReader;
import java.io.IOException;
import java.io.PrintWriter;
public class Main
{
    private static ServerSocket serverSocket;
    private static Socket clientSocket;
    private static BufferedReader bufferedReader;
    private static BufferedReader threadReader;
    private static String inputLine;
    private static Thread thread;
    private static PrintWriter printWriter;
    public static void main(String[] args) throws IOException
    {
        Thread cmd = new Thread(new Commands());
        cmd.start();
        while(ClientThread.Clients < 100) {
            Scanner scan = new Scanner(System.in);
            try
            {
                serverSocket = new ServerSocket(8080);
                clientSocket = serverSocket.accept();
                ClientThread.Clients += 1;

                //Desktop.getDesktop().open(new File("C:/Users/Chris/Desktop/Test.txt")); // Opens notepad on Windows.
                bufferedReader = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));

                printWriter = new PrintWriter(clientSocket.getOutputStream(),true);
            }
            catch(IOException e)
            {
                System.out.println(e.getMessage());
            }
            try{
                thread = new Thread(new ClientThread(clientSocket));
                thread.start();
            }catch(Exception e){System.out.println("Error 103 = failed to create thread."); break;}
            try{
                serverSocket.close();
            }catch(Exception e){System.out.println("Error 105 = failed to close socket.");}

        }

    }
} 
```

多个客户端的线程：

```
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;
import java.util.StringTokenizer;

public class ClientThread extends Thread{
    static Socket socket;
    BufferedReader in;
    PrintWriter out;
    String username;
    public static int Clients = 0;
    static String[] Names = new String[100];
    char EOF = (char)0x00;
    public ClientThread(Socket s){
        socket = s;
    }
    public void run(){
        try{
            in = (new BufferedReader(new InputStreamReader(socket.getInputStream())));
            out = new PrintWriter(socket.getOutputStream());
            System.out.println("Client Connected from " + socket.getInetAddress() + ", " + Clients + " connected.");
            Names[Clients-1] = "Client" + (Clients) + " " + socket.getInetAddress();
            in.readLine();
            Thread.sleep(100);
        }catch(Exception e){
            System.out.println(("Client Disconected from " + socket.getInetAddress()));
            removeClient((socket.getInetAddress()).toString());

        }

    }
    private void removeClient(String Inet) {
        int Location;
        String[] Storage = new String[Clients];
        int j = 0;
        for(int i = 0; i < Clients; i++) {
            String line = Names[i];
            StringTokenizer st = new StringTokenizer(line);
            String Name = st.nextToken();
            String IP = st.nextToken();
            if(IP.equalsIgnoreCase(Inet)) {
                //System.out.println("Client removed..");
            }else {
                Storage[j] = Names[i];
                j++;
            }
        }

        for(int i = 0; i < Clients; i++) {
            Storage[i] = Names[i];
        }

        Clients--;

    }
} 
```

任何建议都非常感谢，在此先感谢。

# r - 基于键值将数据框与列表列表合并的有效方法

> ID：13435847
> 
> 赞同：1
> 
> 时间：2012-11-17T23:30:12.650
> 
> 标签：r

我有一个列表列表，每个列表都有相同的结构。每个子列表中的元素之一是键值。我想向每个子列表添加一个新元素，它是包含匹配键值的数据框的行。我认为这基本上就像“合并”，除了一个列表。

所以我的列表和数据框看起来像这样

```
#Define the list of lists and the data frame
l <- list()
l[[1]] <- list(i=1, data=1:5)
l[[2]] <- list(i=2, data=runif(5))
l[[3]] <- list(i=1, data=rnorm(5))
d <- data.frame(i=c(1, 2), val1=c(TRUE, FALSE), val2 = c("a", "b")) 
```

我想结束

```
> l_mod[[1]]
$i
[1] 1

$data
[1] 1 2 3 4 5

$newData
val1  val2
TRUE     a 
```

对于 的每个元素，依此类推`l_mod`，`$newData`成为 的相应行`d`。请注意，我们可以假设 的每一行`d`都有一个唯一的值`d$i`。

我目前的方法是编写一个匹配函数并从`lapply`

```
matchingRow <- function(indexValue, df) {
  return(df[df$i==indexValue, -1])
}

l_mod <- lapply(l, function(x) c(x, newData=matchingRow(x$i, d))) 
```

这基本上有效，但似乎过于复杂。（此外，它将每一列拆分`d`为新列表的一个单独元素；我宁愿将整个 1 行数据框作为单个列表元素放置）。

有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T00:02:58.773

没有特别的种子。只需取出额外的函数调用似乎很好。：

```
l_mod2 <- lapply(l, function(x) list(x, newData=d[d$i==x$i, -1]))

    l_mod2[[3]]
[[1]]
[[1]]$i
[1] 1

[[1]]$data
[1] -0.109289881 -0.577508057  1.416671342 -1.130346543 -0.002256123

$newData
  val1 val2
1 TRUE    a 
```

# android - Titanium Studio 无法识别 V8 Android？

> ID：13435849
> 
> 赞同：0
> 
> 时间：2012-11-17T23:30:23.703
> 
> 标签：android, titanium

每次我尝试在 Titanium Studio 中将程序作为 V8 Android 运行时，都会收到以下错误消息：

```
This launch uses a V8 Android Runtime, which require Android 2.2 SDK and above. 
Please edit your launch configuration to select a compatible SDK. 
```

我可以将它作为 Rhino 程序运行，但如果可能的话，我想要 V8 引擎的增加速度。我正在尝试将程序作为 Android 2.2 运行，并且我拥有最新的 SDK。知道发生了什么吗？

tiapp.xml（略微精简）

```
<?xml version="1.0" encoding="UTF-8"?>
<ti:app xmlns:ti="http://ti.appcelerator.org">
    <deployment-targets>
        <target device="mobileweb">true</target>
        <target device="iphone">false</target>
        <target device="ipad">false</target>
        <target device="android">true</target>
        <target device="blackberry">false</target>
    </deployment-targets>
    <sdk-version>2.1.4.GA</sdk-version>
    <publisher>pearsonartphoto</publisher>
    <icon>appicon.png</icon>
    <persistent-wifi>false</persistent-wifi>
    <prerendered-icon>false</prerendered-icon>
    <statusbar-style>default</statusbar-style>
    <statusbar-hidden>false</statusbar-hidden>
    <fullscreen>false</fullscreen>
    <navbar-hidden>false</navbar-hidden>
    <analytics>true</analytics>
    <property name="ti.ui.defaultunit">system</property>
    <iphone>
        <orientations device="iphone">
            <orientation>Ti.UI.PORTRAIT</orientation>
        </orientations>
        <orientations device="ipad">
            <orientation>Ti.UI.PORTRAIT</orientation>
            <orientation>Ti.UI.UPSIDE_PORTRAIT</orientation>
            <orientation>Ti.UI.LANDSCAPE_LEFT</orientation>
            <orientation>Ti.UI.LANDSCAPE_RIGHT</orientation>
        </orientations>
    </iphone>
    <android xmlns:android="http://schemas.android.com/apk/res/android"/>
    <mobileweb>
        <precache/>
        <splash>
            <enabled>true</enabled>
            <inline-css-images>true</inline-css-images>
        </splash>
        <theme>default</theme>
    </mobileweb>
    <modules>
        <module platform="commonjs" version="2.3.0">ti.cloud</module>
    </modules>
</ti:app> 
```

我的配置：

*   视窗 7 64 位
*   最新的 Android SDK（Rev 21 和 API 17）64 位
*   钛工作室 2.1.4 GA

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T15:40:54.360

在 Titanium Studio 中，进入运行->运行配置...

从 Android Emulator 项目列表中，找到有问题的项目并将其突出显示。在右侧，确保 Android API 至少为 2.2 或更高版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T05:12:08.800

我遇到了同样的问题，我通过以下步骤解决了

1.  转到您的 Titanium 首选项（窗口 - > 首选项）。
2.  选择图片中给出的钛选项。
3.  将默认 Android SDK 设置为**Google APIs Android 2.2**
4.  选择您的屏幕尺寸
5.  按确定
6.  重启钛工作室
7.  使用 android 模拟器运行您的应用程序

![钛安卓设置](../Images/e6353d494b14965e40bf3be0b75d1d1f.png)

*如果它没有解决您的问题，请检查您的 android SDK*

1.  转到您的 andorid sdk 位置（例如：C:\Program Files\Android\android-sdk）
2.  打开 AVD 管理器
3.  创建一个新的虚拟设备
4.  选择目标设备为 Android 2.2 API Level 8
5.  试用您的新虚拟设备

# java - 如何在静态类中调用泛型类的方法？爪哇

> ID：13435850
> 
> 赞同：-1
> 
> 时间：2012-11-17T23:30:29.743
> 
> 标签：java, generics, static

我有 4 个类：边缘、图形、节点和最短路径。我想在我的最短路径类的静态主目录中调用我的图形类中的方法。我得到的错误是“无法从类型图中对非静态方法 readFile() 进行静态引用”。我会很感激我卡住的任何帮助:(！

```
public class edge<E>{}
public class node<E> extends edge<E>{}

public class graph<E> {
   public node<E> BFS(E value)
   {
    if (adjList.isEmpty())
        return (null);

    ArrayList<node<E>> visitedNodes = new ArrayList<node<E>>(); 

    node<E> sourceNode = adjList.get(0);
    sourceNode.setVisited(true);

    visitedNodes.add(sourceNode); 

    node<E> currNode = null; 

    while(!visitedNodes.isEmpty())
    {
        currNode = visitedNodes.get(0);
        visitedNodes.remove(0);

        if(currNode.getData() == value)
            return (currNode);

        //ListIterator<edge<E>> itr = currNode.incidentEdges.listIterator(); 

        for(node<E> adjNode : adjList) 
        {
            adjNode = adjNode.getChild();

            if(!adjNode.isVisited())
            {
                adjNode.setVisited(true);
                visitedNodes.add(adjNode);
            }

        }

    }
    return (null);
}

public void readFile()
{
File file = new File("Enron-Email.txt");

try 
{
    Scanner scanner = new Scanner(file);

    while (scanner.hasNextLine()) 
    {
        String line = scanner.nextLine();
        if(line.trim().startsWith("#"))
        {
            continue; 
        }

        String[] tokens = line.split("\\t");

        Integer parent = Integer.parseInt(tokens[0]);
        Integer child = Integer.parseInt(tokens[1]);

        addEdge((E) parent, (E) child);
    }
    scanner.close();
} 
catch (FileNotFoundException e) 
{
    e.printStackTrace();
}
}
}    

    public class shortestpath{
public static void main(Integer source, Integer dest) {
    graph<E> myGraph = new graph<E>(); 
    myGraph.readFile();
    myGraph.BFS(source);    
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:31:30.897

您要么必须在类上创建方法`graph.readFile()`或`static`调用`readFile()`方法。`instance``graph`

在第一种情况下，它看起来像：

```
public class shortestpath {
    public static void main (String[] args) {
        graph.readFile ();
    }
}

public class graph {
    public static void readFile () {
    }
} 
```

而在第二种情况下，它看起来像：

```
public class shortestpath {
    public static void main (String[] args) {
        new graph ().readFile ();
    }
}

public class graph {
    public void readFile () {
    }
} 
```

此外，请注意，即使在下面的代码中我使用了小写的类名（正如您在问题中提供的那样），Java 世界中有一个通用约定使用[大写驼峰式](http://c2.com/cgi/wiki?UpperCamelCase)命名类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T23:32:15.717

要从**静态**方法调用**非静态方法**，您需要创建**类的****实例**并在该实例上调用该方法。因此，在您的情况下，您需要创建**Graph 类的实例并从****ShortestPath 类**的主要方法调用方法。********`readFile()`********

 ******```
Graph<YourType> g = new Graph<YourType>(); //replace YourType with the type you want to pass like Integer, blah blah...
g.readFile(); 
```

编辑：

```
graph<E> myGraph = new graph<E>(); 
```

应该

```
graph<Integer> myGraph = new graph<Integer>(); //Or some other valid types. 

E is just an representation of Element. provide a valid element type 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T23:33:25.520

为了调用实例方法，您必须有一个可以调用它的对象。

```
public class A
{
    public void someMethod()
    {
        ....
    }
}

public class B
{
    public static void main(String[] args)
    {
        A.someMethod(); // ERROR

        A a = new A();
        a.someMethod(); // Correct
    }
} 
```******

# java - 在 JXPath 中使用 // 运算符

> ID：13435851
> 
> 赞同：1
> 
> 时间：2012-11-17T23:30:35.623
> 
> 标签：java, xpath, data-structures, tree, jxpath

一些根对象有 field `MyCollection myCollection`。该类`MyCollection`实现`Collection`接口。元素的名称可以通过调用获得`someService().getName()`，这就是我创建`Rules`类的原因。

`context.getValue("/myCollection");` 返回 myCollection - 好的

`context.getValue("//myCollection");` 返回 myCollection - 好的

`context.getValue("/myCollection/.[rules:getName() = 'secondName']");`返回返回“secondName”`IMyNode`的 实例- OK`someService().getName()`

行后 `context.getValue("/myCollection//.[rules:getName() = 'secondName']");` 不执行下一行。也不例外，并且没有设置宽松模式。我不明白发生了什么事。第 8 行的`Rules`类打印`"POINTER SET ON /myCollection[1]"`。我想在这个例子中得到的元素是 in `/myCollection[2]`。

这是获取元素名称的地方。我认为这堂课是正确的。

```
public class Rules {
public static String getName(ExpressionContext context){
   Pointer pointer = context.getContextNodePointer();
    if(pointer == null){
        return "";
    } else {
        if(pointer.getValue() instanceof IMyNode){
        System.out.println("POINTER SET ON " + pointer);
            IMyNode node = (IMyNode)pointer.getValue();
           return node.someService().getName();
       }
   }
   return "";
}
} 
```

**编辑：** 这个问题是关于**JXPath**的。我添加标签 xpath 而不是 jxpath 是错误的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T00:09:59.773

尝试使用`*`而不是`.`. 另外我认为您可以使用标准 XPath 函数`local-name()`而不是`rules:getName()`.

# c# - 在wpf中从网格中动态删除列

> ID：13435854
> 
> 赞同：4
> 
> 时间：2012-11-17T23:30:51.957
> 
> 标签：c#, wpf

我有一个数字 1 到 10 的组合框，根据用户的选择，我的表单上应该显示许多用户控件。第一次加载表单时，组合框的值为 1，并且网格中只有一个用户控件 petdetails （它只有一行，并且在进行更改时添加了额外的列）。我的程序在此范围内工作正常，但是一旦用户添加了更高的值并由于某种原因减少了列，但最后一列中的控件重叠。（例如：用户选择了 6 ,6 个控件并添加了一次他将组合框中的值更改为 3，只剩下 3 列，但在第三列中，我可以看到用户控件 5,6 重叠）。我在这里粘贴我的代码，任何帮助将不胜感激。

```
private void cmbNoOfPets_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {

        int i = Convert.ToInt32(((System.Windows.Controls.ContentControl)(cmbNoOfPets.SelectedValue)).Content);
        int grdCols=Convert.ToInt32(grdPetDetails .ColumnDefinitions .Count.ToString ()); 
        // check if the number of pets is more than the existing number in the grid if more start with adding at the next column
        // if less start from the last decreasing till the number of columns required
            if (i > grdCols)
            for (int j = grdCols+1 ; j <= i; j++)
            {

                ColumnDefinition c = new ColumnDefinition();
                c.Width = new GridLength(370, GridUnitType.Pixel);
                grdPetDetails.ColumnDefinitions.Add  (c);
                PetDetails petdetails = new PetDetails();
                petdetails.Name = "petDetails" + j ;
                string str="Pet Number " + j + ":";
                petdetails.lblPetNumber.Content = str;
                Grid.SetRow(petdetails, 1);
                Grid.SetColumn(petdetails, j - 1);
                grdPetDetails.Children.Add(petdetails);

           }
            else if (i < grdCols)

                for (int j = grdCols; j > i; j--)
                {

                    PetDetails petdetails = new PetDetails();
                    petdetails.Name = "petDetails" + j;
                    grdPetDetails.Children.Remove(petdetails);
                    grdPetDetails.ColumnDefinitions.RemoveAt(j - 1);

                } 

     } 
```

我先删除控件，然后删除列定义，但不明白为什么会这样。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T19:41:43.053

因此，重新表述问题/请求“当我更改组合框的 SelectedItem 时，我希望在应用程序的其他位置显示新的 SelectedIndex+1 数量的控件。” 看起来很简单，只需将事件处理程序连接到 SelectionChanged，并在该事件处理程序中创建控件。[http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selectionchanged.aspx](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.selector.selectionchanged.aspx)

# java - 添加到 Arraylist 会覆盖其余部分，这是为什么呢

> ID：13435859
> 
> 赞同：1
> 
> 时间：2012-11-17T23:32:01.327
> 
> 标签：java, arraylist, multidimensional-array

这个问题是这个问题的后续..

> [使用 Java 将多维数组添加到数组列表](https://stackoverflow.com/questions/13430448/add-multidimensinal-array-to-an-array-list-using-java)

```
 int tmp;
  int[][] Key = new int [TopSubKey.length+BottomSubKey.length][TopSubKey.length];
  int[][] KeyChoiceTable = {{14,17,11,24,1,5},{3,28,15,6,21,10},{23,19,12,4,26,8}}     
 int [][] KeySelection = new int [KeyChoiceTable.length][KeyChoiceTable[0].length];

List<int [][]> list = new ArrayList<int [][]>();

 int row,col,x;

for(int l =0;l<3;l++) {

 for(int i=0;i<KeyChoiceTable.length;i++){
    for(int j=0;j<KeyChoiceTable[0].length;j++){
         row = 0;
         col = 0;
         x = KeyChoiceTable[i][j];
         while(x>7){x=x-7; row=row+1;}
         col = x-1;

     KeySelection[i][j] = Key[row][col];
     }
 }
 list.add(KeySelection);
 System.out.print(list.size());
  } 
```

如果你能看看..因为这个问题看起来很愚蠢，但它杀了我。

Lopp 运行 2 次，我对最后一行的期望是每个循环将 2D 数组存储在索引 0 的列表中，因此第二个循环将第二个 2D Keyselection 存储在索引 1 的列表中。每当我添加对于Arraylist（列表），新的additiion覆盖了所有其他条目，导致所有条目与最后一个条目相同。我整天都在尝试，如果我使用向量或堆栈，它也是一样的。这是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:43:46.797

如果要存储对象数组，则应为每个条目创建一个新对象。不要添加对象，然后更改一些实例值，然后再次添加它们，这也会更改所有其他条目。（阅读有关 Java 的面向对象方法的更多信息）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:48:54.847

由于您一遍又一遍地操作同一个数组中的值，并且 ArrayList 不会复制添加到其中的元素，而只是引用它们，因此 ArrayList 中的每个条目都引用同一个数组，该数组具有最后一个状态，它给了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T00:24:49.180

当您添加`KeySelection`到 时`list`，您实际上是在添加对它的引用，而不是副本。当您`KeySelection`在下一次迭代中更改时，更改也会反映在`list`. 为避免这种情况，`KeySelection`请在将其添加到的同一范围内声明`list`：

```
for(int l =0;l<3;l++) {
    int [][] keySelection = new int [KeyChoiceTable.length][KeyChoiceTable[0].length];
    // Populate keySelection
    list.add(keySelection);
    System.out.print(list.size());
} 
```

然后每个条目`list`是一个不同的数组。

# meteor - 如何将传统创建的网站/应用程序从 MAMP 转移到 Meteor

> ID：13435863
> 
> 赞同：0
> 
> 时间：2012-11-17T23:32:52.013
> 
> 标签：meteor

我刚刚安装了 Meteor，它工作正常。所以我立即的第一个测试是复制一个我使用 JQuery、一些 javascript 库和网络音频 api 做的小网络应用程序，然后将它复制到我创建的会话目录并运行 localhost:3000

我遇到了一堆错误，网站没有显示。

我想知道简单地移动一个非 Meteor 创建的项目是否有一个简单的解决方案（例如我需要运行的命令），或者是否必须逐个处理出现的错误。

我知道这违背了使用流星的“点”，但也许我想将我过去所做的事情整合到一个新的流星项目等中。

继承人的错误日志：

```
Errors prevented startup:
Exception while bundling application:
Error: Can't set DOCTYPE here.  (Meteor sets <!DOCTYPE html> for you) - line 3, file /Users/William/willsjunk/crap/hide&save/Full Working JQuery TUNA Effects!.html
<!DOCTYPE html>
    at html_scanner.scan.parseError (/usr/local/meteor/packages/templating/html_scanner.js:23:14)
    at Object.html_scanner.scan (/usr/local/meteor/packages/templating/html_scanner.js:58:17)
    at /usr/local/meteor/packages/templating/package.js:46:32
    at _.extend.add_file (/usr/local/meteor/app/lib/bundler.js:195:5)
    at self.api.add_files (/usr/local/meteor/app/lib/bundler.js:96:16)
    at Array.forEach (native)
    at Function._.each._.forEach (/usr/local/meteor/app/lib/third/underscore.js:76:11)
    at self.api.add_files (/usr/local/meteor/app/lib/bundler.js:95:11)
    at Array.forEach (native)
    at Function._.each._.forEach (/usr/local/meteor/app/lib/third/underscore.js:76:11)
Your application is crashing. Waiting for file change. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T03:31:22.690

我发现答案是简单地创建一个公用文件夹并将非流星应用程序放入其中。

# batch-file - 批处理文件删除停用的用户

> ID：13435866
> 
> 赞同：1
> 
> 时间：2012-11-17T23:33:08.457
> 
> 标签：batch-file

我正在尝试构建一个批处理文件，但是由于未知原因，当执行该过程时，该变量`%UT:~47%`保持为空，并且仅在第二次执行后才被填充。如果我执行 This 一旦回显结果为〜47，但第二次结果结果显示是或否（法语中的 Oui 或 Non）。有谁知道为什么？

第一个条件完美，如果没有参数。但是如果我在参数中使用用户名执行我的批处理，它会检查用户帐户是否被激活。我在文件 C:\user.txt 中放置了实际代表英语帐户的单词“Compte”的行，但 set /p 似乎有问题，因为我的 echo 命令给我 ~47 为空，但文件 c :\user.txt 包含

```
(Compte : actif                                 Oui or Non) 
```

用英语是

```
(Account : active                                Yes or No) 
```

* * *

```
@echo off
::if no parameter
if "%~1" == "" echo Please Indicate an User to delete ! & exit /b 0
for %%U in (%*) do (
    net user %%U | find "Compte">c:\user.txt || echo can't find user %%U
    set /p UT=<c:\user.txt
    echo %UT:~47%
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T01:26:44.867

这是因为您在 for 循环中设置了变量“UT”，请搜索“批量延迟扩展”以获取更多信息。此外，您可能不需要先将输出重定向到文件，您可以使用`for /f "tokens=* eol=" %%a in ('net user add %%U')`直接捕获变量中的输出。

# jsf-2 - Primefaces 3.4：带有 f:setPropertyActionListener 的 DataTable 和 CommandLink 列抛出 javax.el.E LException: java.lang.IllegalArgumentException

> ID：13435867
> 
> 赞同：0
> 
> 时间：2012-11-17T23:33:16.963
> 
> 标签：jsf-2, datatable, primefaces, commandlink

我有这个数据表，其中包含一个客户列表和一个 Edit commandLink 列。我需要打开一个对话框来显示客户端的数据，并且我正在尝试使用 f:setPropertyActionListener 将 Client 对象发送到 bean 对话框，使用用于 dataTable 行的变量*cli ：*

```
<p:dataTable id="tblClients" var="cli" value="#{clientsBean.clients}" rowKey="#{cli.id}">

   <p:column>  
      <p:commandLink id="lnkEdit" value="Edit" action="#{clientBean.start}" process="@this" update="dlgClient" oncomplete="dialogClient.show()">
         <f:setPropertyActionListener target="#{clientBean.client}" value="#{cli}" />
      </p:commandLink>
   </p:column>             

   <p:column headerText="Name" sortBy="#{cli.name}" id="name">
      #{cli.name}
   </p:column>
   ...
</p:dataTable> 
```

但是当我点击编辑按钮时，会抛出这个错误：

**java.lang.IllegalArgumentException：无法将 java.lang.String 类型的 test.Client@95 转换为 test.Client 类**

我确定 clientBean.client 是 Client 类型，它的 getter 和 setter 是正确的。

是否可以以任何方式引用 dataTable 变量？我需要实现一个转换器来完成这个任务吗？

任何帮助我将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T02:05:21.433

这就是我解决的方法，您可以将*cli*变量作为参数发送到*启动*函数：

```
<p:dataTable id="tblClients" var="cli" value="#{clientsBean.clients}" rowKey="#{cli.id}">

   <p:column>  
      <p:commandLink id="lnkEdit" value="Edit" action="#{clientBean.start(cli)}" process="@this" update="dlgClient" oncomplete="dialogClient.show()">
         <f:setPropertyActionListener target="#{clientBean.destinyProperty}" value="#{clientsBean.sourceProperty}" />
      </p:commandLink>
   </p:column>             

   ...
</p:dataTable> 
```

可以像这样在 clietBean 中接收此参数：

```
public void start(Client currentClient) {

    this.client = currentClient;
    ...        
} 
```

这可以与 f:setPropertyActionListener 参数混合使用。

谢谢。

# iphone - 如何以编程方式在 iPhone 上创建消息聊天气泡（如在 iPhone 消息中）

> ID：13435870
> 
> 赞同：11
> 
> 时间：2012-11-17T23:33:22.517
> 
> 标签：iphone, sms, bubble-popup

我想知道是否有办法从 iOS 以编程方式构建这些聊天气泡？如果不是 iOS 自己的，那么是否有任何像样的开源库可以让我这样做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-18T00:13:55.803

[这里](http://www.cocoacontrols.com/platforms/ios/controls/acanichat)和[这里](http://alexbarinov.github.com/UIBubbleTableView/)的一些例子。您可能还想查看[UIImage 类](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIImage_Class/Reference/Reference.html)`resizableImageWithCapInsets`的方法

# joomla - 如何在 Joomla 的一篇文章中显示多个类别列表？

> ID：13435872
> 
> 赞同：1
> 
> 时间：2012-11-17T23:33:29.047
> 
> 标签：joomla, joomla3.0

如何将类别列表和属于它们的文章显示为树结构，仅显示文章和类别的名称？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T23:38:23.837

在 Joomla 后端，转到模块管理器并打开名为“文章类别”的模块。在那里您可以编辑参数以满足您的需要，这将显示类别的树结构和属于它们的文章。

如果您想在文章中显示此模块，请通过键入一个而不是选择一个来为该模块指定一个自定义位置。在文章中，添加如下代码：

```
{loadposition xxx} 
```

如果您的自定义位置，请将**xxx**更改为名称。

# powershell - 在 PowerShell 中的 -Include 过滤器中使用变量

> ID：13435876
> 
> 赞同：0
> 
> 时间：2012-11-17T23:34:21.920
> 
> 标签：powershell

我有一个函数，它使用[Get-ChildItem](http://technet.microsoft.com/en-us/library/hh849800.aspx)来计算文件夹中的最新文件。我需要在一个文件夹中找到最新的增量备份并编写一个 EXE 文件来挂载它。但是，在同一个文件夹中，所有不同的服务器都有多个备份链，即

```
SERVER1_C_VOL_b001_i015.spi
SERVER2_D_VOL_b001_i189.spi
SERVER1_C_VOL_b002_i091.spi
SERVER1_E_VOL_b002_i891.spi (This is the newest file created) 
```

我只想看`SERVER1`，只看，`C_VOL`只看`b001`——别无其他。

我有所有这些单独的组件：驱动器号、服务器名称、存储在数组中的 b00X 编号。

那我怎么能去使用`Get-ChildItem`过滤`-Include`器来只看：

```
.spi
SERVER1
C_VOL
b001 
```

鉴于我将所有这些单独的组件放在一个从文本文件中获取的数组中：

```
Get-Content .\PostBackupCheck-TextFile.txt | Select-Object -First $i { $a = $_ -split ' ' ; $locationArray += "$($a[0]):\$($a[1])\$($a[2])" ; $imageArray += "$($a[2])_$($a[3])_VOL_b00$($a[4])_i$($a[5]).spi" } 
```

我继续尝试过滤，然后我被卡住了：

```
$latestIncremental = Get-ChildItem -Path ${shadowProtectDataLocation}\*.* -Include *.spi | Sort-Object LastAccessTime -Descending | Select-Object -First 1 
```

我已经过滤了 .spi，但我怎样才能只包含 C（用于卷）、b00x 的编号和服务器名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T10:56:23.810

> I want only to look at SERVER1, look at only the C_VOL and look at only b001 - nothing else.

Is this meant to be inclusive or exclusive (the question is not 100% clear)?

Ie. is it `SERVER1` *and* `C_VOL` *and* …, or is it any file matching any one of them? Based on the final paragraph it seems you want the former.

I see two approaches, depending how closely the match criteria array matches the filename structuyre..

1.  If your matching files have the a form that matches the filter criteria (eg. as in Q's example with same ordering of name components apart of extension first) then you can build that "like pattern" dynamically:

    ```
    $parts = … # the match parts array
    $pattern = (($parts | Select-Object -skip 1) -join '*') + $parts[0]
    $file = Get-ChildItem -Path $basePath -include $pattern | Sort-Object … 
    ```

2.  Apply each part of the pattern incrementally, again assuming the extension comes first in the file:

    ```
    $parts = … # the match parts array
    $potentialFiles = Get-ChildItem -Path $basePath -include ('*' + $parts[0])
    $parts = $parts | Select-Object -skip 1
    foreach ($p in $parts) {
      $potentialFiles = $potentialFiles | Where-Objecft { $_.Name -like ('*' + $p + '*') }
    }
    # Now sort and select -first 1 to get single file (if any left to match) 
    ```

# android - iOS或android开发，如何在一定时间后使应用程序过期

> ID：13435877
> 
> 赞同：2
> 
> 时间：2012-11-17T23:34:23.333
> 
> 标签：android, ios

我有一个客户想要在安装日期之后建立一个定时到期。

不管这是否是一个好主意，除此之外，我知道我可以通过在安装后一段时间后禁用功能来使应用程序基本上无用。

我的问题是，苹果商店的评论者和安卓评论者可以接受这样的想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T02:08:45.510

没有 Android 评论者。如果应用程序编译成功，您可以将其发布到 Google Play。至于禁用，您可以在应用程序首次启动时简单地创建某种 Date 对象，然后将表示该 Date 的 long 保存到 SharedPreferences。然后，当您想禁用该应用程序的时间过去后，只需让该应用程序显示一个对话框，说明其已禁用，并基本上以这种方式切断所有功能。换句话说，此时使整个应用程序的功能只是显示该应用程序已被禁用......只是切断对任何其他功能的访问。或者只是将应用程序定向到显示此信息的 Acitivity，而不是实际可用的应用程序。

快速样机：

```
 SharedPreferences sharedPreferences = PreferenceManager.getDefaultSharedPreferences(this);
        long time = sharedPreferences.getLong("install_date", 0);
        if(time!=0) {
            Date installDate = new Date(time);
            Date now = new Date();
            int secondsBetween = (int) (installDate.getTime() - now.getTime()); //gives you seconds between
            if(secondsBetween==???) {
                startActivity(new Intent(this, AppDisabled.class));
            }

        } 
```

# php - 2 个导航栏，其中一个用于内容区域。如何有效地更改导航栏#2 的内容和导航栏#1 上链接的内容

> ID：13435879
> 
> 赞同：0
> 
> 时间：2012-11-17T23:34:32.790
> 
> 标签：php, css, html, php-include

我的页面顶部有两个导航栏：

> ```
>  <section id="topnav">
>             <ul>
>                 <li><a href="#">Links formatted like this</a></li>
>             </ul>
>         </section>
>         <section id="bottomnav">
>             <ul>
>                 <li><a href="#">Link</a></li>
>             </ul>
>         </section> 
> ```

在单击“topnav”上的链接之前，“bottomnav”将不会被填充。我希望 'bottomnav' 成为我猜想的 'topnav' 的一种子菜单。例如，在“顶部导航”上可能有“帖子、页面、设置”，如果您单击“帖子”，它会将内容框架更改为“管理帖子”页面，并将“底部导航”更改为显示“管理帖子、新建、备份帖子”链接等。我希望这是有道理的，我似乎对解释事情有一种障碍。

我根本想不出一个简单的方法来做到这一点。顺便说一句，模板完成后我将使用 PHP。这不是一个容易想到标签的问题。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T23:38:52.943

您的问题被标记为正确的东西 - PHP 包括！这可能是最简单的方法。只需为底部导航设置不同的导航文件，并包含相关的导航文件。

但是，如果我是你，我会加载所有这些并使用 JS 来屏蔽除当前处于活动状态的之外的所有内容。这将节省您的带宽，因为您只需传输一次所有内容，而不是加载五页。

# objective-c - 通过pairedDevices自动连接蓝牙设备

> ID：13435891
> 
> 赞同：1
> 
> 时间：2012-11-17T23:35:50.540
> 
> 标签：objective-c, xcode, bluetooth

我正在尝试自动连接到蓝牙设备。第一次，用户必须通过 IOBluetoothDeviceSelectorController 选择设备。然后将该地址存储在某处，之后，该设备应自动连接。

我的想法是使用pairedDevices遍历所有已知和配对的蓝牙设备，然后在设备地址等于前一个地址时中断。但由于某种原因，我无法让这种休息发生。

这是我的（有些缩短的）代码：

```
IOBluetoothDevice *device;
NSArray *devices = [IOBluetoothDevice pairedDevices];
NSEnumerator *e = [devices objectEnumerator];
NSString *mytempstring, *mytempstring2 = @"AA";

while (device = [e nextObject])
{
    NSLog(@"=%@=", [device addressString]);
    mytempstring = [device addressString];
    NSLog(@"=%@=", mytempstring);
    if (mytempstring == @"00-80-25-15-29-20")
    {
        break;
    }
    if (mytempstring2 == @"AA")
    {
        break;
    }
} 
```

日志窗口输出如下：

2012-11-18 00:06:02.385 程序[5093:303] =00-80-25-15-29-20=

2012-11-18 00:06:04.772 程序[5093:303] =00-80-25-15-29-20=

The outputs clearly match, but for some reason the if statement thinks otherwise and the break is never executed. I have added a second if statement for checking, and this one does execute as expected and initiates the second break...

Any thoughts why the address string compare does not work?

Thanks in advance!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T18:34:27.560

我通过用“isEqualToString”语句替换“==”语句来解决它......

```
IOBluetoothDevice *device;
NSArray *devices = [IOBluetoothDevice pairedDevices];
NSEnumerator *e = [devices objectEnumerator];

while (device = [e nextObject])
{
    if ([[device addressString] isEqualToString:@"00-80-25-15-29-20"])
    {
        break;
    }
} 
```

无论如何，感谢您调查它！

# netbeans-7 - Netbeans PHP - Code Navigator show included files

> ID：13435892
> 
> 赞同：3
> 
> 时间：2012-11-17T23:35:51.257
> 
> 标签：netbeans-7

Using Netbeans 7.2.1 can I get included files to show up in the "Navigator"?

In Dreamweaver they appear in the toolbar, in Aptana Studio 3 they appear in the "Outline", phpDesigner they appear as dependencies.

If I can get Netbeans to show php includes ( and even files linked link JS and CSS files ) I'm going to use it as my primary PHP IDE.

# excel - Excel VBA - Delete rows when a cell contains a date

> ID：13435895
> 
> 赞同：0
> 
> 时间：2012-11-17T23:36:28.797
> 
> 标签：excel, vba

I am trying to write code that does the following:

*   找到单元格 A4。
*   如果单元格包含日期，则删除整行。
*   我希望这个循环，直到 A 列中的单元格不包含日期。一旦单元格为空白，循环就可以结束。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T12:19:57.633

这就是你需要做的所有事情：

> *   使用 VBA 函数`IsDate`
> *   如果返回的值在中的值上为真`Range A4`
> *   删除`entire row`_`Range A4`
> *   如果没有，那么你的潜艇就结束了。

真的，它不应该超过 5-9 行代码，而且非常非常非常简单。如果您在编写代码时遇到问题，请回来询问您遇到的**问题的具体问题**。

# jquery - 如何使用 JQuery 以编程方式在传单中单击/拖动/等？

> ID：13435900
> 
> 赞同：2
> 
> 时间：2012-11-17T23:36:59.200
> 
> 标签：jquery, leaflet

我的传单地图目前完全位于透明画布元素后面，因此它永远不会直接注册用户的鼠标事件。因此，我需要以编程方式将鼠标事件注册到传单中。

如果我在我的应用程序中运行快速入门教程代码，AKA：

```
 <div id="backgroundMap"></div>
    <script>
$("#backgroundMap").css("width",$(window).width()).css("height",$(window).height());
        var map = L.map('backgroundMap').setView([51.505, -0.09], 13);

        L.tileLayer('http://{s}.tile.cloudmade.com/API-Key/997/256/{z}/{x}/{y}.png', {
            attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="http://cloudmade.com">CloudMade</a>',
            maxZoom: 18
        }).addTo(map);

        map.on('click', onMapClick);
    </script> 
```

我需要鼠标事件在 div backgroundMap, AKA 中注册`$('#backgroundMap').click(...)`吗？还是应该在其他地方注册？

或者，在传单方面，我应该做一些完全不同的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-30T08:55:44.297

您想触发 Leaflet 中的单击/拖动/等事件以及这些事件的任何侦听器吗？或者您只是想以编程方式移动地图？

[如果您想要后者，在如何更改传单中的地图中心](https://stackoverflow.com/questions/12735303/how-to-change-the-map-center-in-leaflet)有多种答案。

这是您真正想要的命令，在此[答案](https://stackoverflow.com/a/12735612/198348)中提到：

```
map.panTo(new L.LatLng(40.737, -73.923)); 
```

# jquery - 无法让 jQuery Nav 在 WordPress 中工作

> ID：13435903
> 
> 赞同：0
> 
> 时间：2012-11-17T23:37:29.377
> 
> 标签：jquery, wordpress, mobile, navigation

我正在使用 jQuery 为我的网站创建移动导航来隐藏/显示子链接。这是导航的一个工作示例：http: [//codepen.io/johnmotyljr/pen/HGADn](http://codepen.io/johnmotyljr/pen/HGADn)

但是，当我将 javascript 放入 WordPress 主题的 HEAD 中时，它似乎不起作用。这是我在主题中使用的代码：

```
<script type="text/javascript">
$(function() {
  $('ul.menu > li > a').click(function(e) {
    $('ul.sub-menu').slideUp('normal');
      if($(this).next('ul.sub-menu').is(':hidden') === true) {    
        $(this).next('ul.sub-menu').slideDown('normal');
      }
    e.preventDefault();
  });
}); 
</script> 
```

我很少使用 Javascript/jQuery，所以我确信这可能是一些小问题。有人想指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T00:28:32.847

你确定你没有忘记在你的头部添加这一行吗？

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

我敢打赌你忘了包含 jQuery 脚本......只需添加这一行。所以你的代码应该是这样的（只需复制粘贴所有内容，它就可以工作 - 我测试了它 - 并且脚本在 head 部分内）：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
            <html xmlns="http://www.w3.org/1999/xhtml">
            <head>
            <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
            <title>Document sans titre</title>
            <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
            <script>
            /*
            *  $(document).ready(function() { });
            *  is the same as
            *  $(function() { });
            */

            $(function() {
              $('ul.menu > li > a').click(function(e) {
                $('ul.sub-menu').slideUp('normal');
                  if($(this).next('ul.sub-menu').is(':hidden') === true) {    
                    $(this).next('ul.sub-menu').slideDown('normal');
                  }
                e.preventDefault();
              });
            });

            /*
             *  Page reference: http://css-tricks.com/forums/discussion/20608/mobile-navigation-dropdown#Item_10
             */
            </script>

            <style>
            #main-nav_responsive {
                display:block;
                z-index: 99;
                margin: 0 auto;
                width: 95%;
            }

            #main-nav_responsive li {
                list-style:none;
                margin: 0 auto;
                padding-top: 2px;
            }

            #main-nav_responsive ul {
                padding: 0px;
                height: auto;
                z-index: 10000;
            }

            #main-nav_responsive ul li a {
                display: block;
                color:white;
                text-decoration:none;
                font: normal 18px "Century Gothic", sans-serif;
                text-align: left;
                margin: 0;
                text-transform:capitalize;
                background: #ED1C3F;
                padding: 9px 0px 11px 20px;
                text-transform:lowercase;
            }

            #main-nav_responsive ul li a:hover {
                background:#E35959;
            }

            #main-nav_responsive .sub-menu li a {
                background: #35342f;
            }

            ul.sub-menu {
                display:none;
            }

            </style>
            </head>

            <body>
            <div id="main-nav_responsive">
              <div>
                <ul class="menu">
                  <li>
                    <a href="#">Specialties</a> 
                      <ul class="sub-menu">
                        <li><a href="#" >Consumer Packaged Goods</a></li>
                        <li><a href="#" >Grocery Stores</a></li>
                        <li><a href="#" >Resorts + Hospitality</a></li>
                        <li><a href="#" >Education</a></li>
                        <li><a href="#" >New Product Development</a></li>
                      </ul>
                    </li>

            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-522"><a href="#" >Services</a>
            <ul class="sub-menu">

                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-523"><a href="#" >Advertising</a></li>

                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-538"><a href="#" >Branding</a></li>

                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-524"><a href="#" >PR</a></li>

                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-525"><a href="#" >Online</a></li>
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-527"><a href="#" >Events</a></li>
            </ul>
            </li>

            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-643"><a href="#" >Results</a></li>

            <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-645"><a href="#" >About</a>

            <ul class="sub-menu">
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-531"><a href="#" >Who We Are</a></li>

                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-532"><a href="#" >How We Work</a></li>

                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-533"><a href="#" >Blog</a></li>
            </ul>
            </li>

            <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-534"><a href="#" >Contact</a>
            <ul class="sub-menu">

                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-535"><a href="#" >Careers</a></li>
            </ul>
            </li>
            </ul>
            </div>
            </body>
            </html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T08:15:38.757

用这个函数调用一个 jquery 库`<?php wp_enqueue_script("jquery"); ?>`是不够的。你必须使用`wp_enqueue_scripts`动作来钩住它。如果您真的担心 jquery 冲突，请按照此操作并将此代码放入您的 functions.php

```
//function to call jquery
function install_jquery(){      
   wp_enqueue_script('jquery'); 
}

//finally, the action hook to put jquery library in your theme
add_action( 'wp_enqueue_scripts', 'install_jquery'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T18:12:01.550

```
function my_scripts_method() {
    wp_deregister_script( 'jquery' );
    wp_register_script( 'jquery', 'http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js');
    wp_enqueue_script( 'jquery' );
}    

add_action('wp_enqueue_scripts', 'my_scripts_method');
?> 
```

这就是为我解决的问题。感谢 barakadam 和 loQ 的帮助。我不得不使用 Google CDN 来覆盖默认的 WP jQuery。

# php - MYSQL PHP 在 textarea 中保存换行符以供以后显示

> ID：13435904
> 
> 赞同：2
> 
> 时间：2012-11-17T23:37:32.773
> 
> 标签：php, mysql, line-breaks

我正在从文本区域收集文本。文本中有换行符。然后我将它保存到数据库中。

但是，当我从数据库中检索它并将其显示回文本区域进行编辑时，换行符消失了，文本变成了一个长的连续字符串。

我希望原来那里的换行符重新出现。插入回文本区域时，如何使换行符按应有的方式显示？

**注意：**我*不能*只将它们转换为 a `<br>`，因为这是**在一个**文本区域内，`<br>`元素不会被渲染，而只是作为文本写出。我想要实际的换行符。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-10-28T01:17:30.210

每个人都建议将换行符转换为`<br />`，但是正如您在问题中所说的那样，这不是您想要的。您想再次在 textarea 中显示换行符。所以，你需要的是`stripcslashes()`- 这将剥离`\n`并给你你所追求的，是你的文本区域中的换行符，而不是文本区域`<br />`中的 html 标签：

PHP:[条带斜杠](http://php.net/manual/en/function.stripcslashes.php)

用法：

```
echo stripcslashes($input_text); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T12:00:26.930

你可以使用这样的东西：

```
echo nl2br($someText); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-22T20:48:04.963

`str_replace()` doesn't go like this:

```
echo str_replace($data, "\n", "<br />"); 
```

It goes like this:

```
str_replace("SEARCH_FOR","REPLACE_WITH",STRING); 
```

In the sense that `SEARCH_FOR` is what you are trying to find, `REPLACE_WITH` is what you want to replace with, and `STRING` is the variable you are using (such as `$data`).

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-18T00:36:58.703

这是我在处理此类问题时通常会做的事情：

1.  将任何数据接收器保存在表单中。这意味着，如果用户使用换行符，则以这种方式存储。不要改变它。
2.  显示数据后，将每个换行符转换为`<br />`：

    ```
    echo str_replace("\n", "<br />", $data); 
    ```

使用这种技术，您可以在 textarea 中保留用户使用的任何格式数据。

# twitter-bootstrap - 超大插件禁用 Bootstrap 下拉菜单

> ID：13435907
> 
> 赞同：2
> 
> 时间：2012-11-17T23:38:09.757
> 
> 标签：twitter-bootstrap, supersized

我正在创建一个基于 Bootstrap 的基本营销网站的网站：http: [//twitter.github.com/bootstrap/examples/hero.html](http://twitter.github.com/bootstrap/examples/hero.html) 但是，当我安装 Supersized jQuery 插件时，它会禁用我的下拉菜单。谁能告诉我如何解决这个问题？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T06:59:28.927

我对 Supersized 3.2 版和 jQuery 1.9 版有同样的问题。

尝试包括 jQuery 迁移插件（ [http://blog.jquery.com/2013/02/16/jquery-migrate-1-1-1-released/](http://blog.jquery.com/2013/02/16/jquery-migrate-1-1-1-released/)）

# android - 当我创建一个新的 android 应用程序项目时，属性文件总是无法立即加载

> ID：13435915
> 
> 赞同：0
> 
> 时间：2012-11-17T23:39:09.067
> 
> 标签：android, eclipse, android-emulator

有一段时间，每次我尝试运行一个 Android 应用程序项目时，都会收到一条错误消息，说*你的项目有错误*。每次发生这种情况时，我都会在我创建的每个 Android 应用程序项目的项目文件夹中得到一个**x**（尽管项目文件夹的内容都没有 x）。

为了确保错误不是我的错，我尝试创建一个示例 Android 项目以查看发生了什么，但我仍然收到该错误。所以我查看了错误日志，每次我创建一个新的 Android 项目时，我总是收到一个错误，说*属性文件无法加载*。我尝试重建文件，尝试清理它，并尝试检查属性文件，但没有任何效果。

你能就我能做些什么提出建议吗？如果您需要更多信息，请告诉我，我会为您提供。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T23:55:41.090

我之前遇到过这个问题，我认为您需要重新安装 eclipse 并在新安装时参考 android sdk

# iphone - 无法为自定义 UIButton 添加标题？

> ID：13435916
> 
> 赞同：0
> 
> 时间：2012-11-17T23:39:15.057
> 
> 标签：iphone, ios, cocoa-touch, cocoa, uibutton

嘿伙计们，我有一个奇怪的问题。如果我在情节提要编辑器中创建一个自定义按钮并想为其添加标题，它会出现在按钮的右侧，但它应该放在按钮顶部的中心。我检查了所有的偏好，但找不到它为什么不起作用。任何想法为什么它会这样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T04:33:35.707

它使用 Xcode 4.5 对我有用，看看截图：

![在此处输入图像描述](../Images/1ffbcc7b002f6d34a4e7b1fbc45a7e42.png)

您应该检查 Control 下的 Alignment 属性（显示在右下角）。如果您为水平和垂直选择中心选项，您应该得到与图像显示相同的结果。

# javascript - 如何在 ENTER/RETURN keydown 上提交 textareas

> ID：13435917
> 
> 赞同：1
> 
> 时间：2012-11-17T23:39:15.903
> 
> 标签：javascript

如果您在输入框中按 RETURN/ENTER，则您提交表单。在 textarea 中按 RETURN 会产生换行符。您如何在 RETURN 键下创建一个而不是产生换行符来提交表单并在 SHIFT+RETURN 中产生换行符？（像 fb 和其他网站一样）

有没有办法只用 HTML 来做到这一点？如果不是，如何用 JS 来完成？

这就是我现在正在尝试的：

```
$('#conversationForm textarea').keydown(function(e) {
    e = e || event;
    if(e.keyCode == 13 && !e.shiftKey) {
        $("#conversationForm").submit();
        return false;
        }
    }); 
```

但是，当我无法阻止换行符的发生时。（如果您按 RETURN，则在提交之前可以看到换行符。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:49:48.277

使用 jQuery，与其他答案类似，但包括您要求 shift 不提交而只是换行的请求

```
$("#mytextarea").keypress(function() {
  if(event.which == 13 && !event.shiftKey)
  {
      //submit your form here  i.e. form.submit();
  }
});​ 
```

在这里，如果按下 shift ，它将不会提交，只会给你一个换行符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:44:34.597

如您所见，[通过按“Enter”从 textarea 提交数据的](https://stackoverflow.com/questions/789701/submitting-data-from-textarea-by-hitting-enter)可能重复项

```
[SomeTextarea].onkeyup = function(e){
  e = e || event;
  if (e.keyCode === 13) {
    // start your submit function
  }
  return true;
 } 
```

将是您寻找的解决方案

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-17T23:43:20.980

附加一个`keydown`事件监听器。如果`event.keyCode || event.which`计算结果为 13（或 10，为了安全起见），则按下 Enter 键，以便您可以使用表单的`submit`方法提交表单。

# ruby-on-rails - 在 Rails 应用程序上设计、CanCan 和 ActiveAdmin

> ID：13435920
> 
> 赞同：4
> 
> 时间：2012-11-17T23:40:37.787
> 
> 标签：ruby-on-rails, devise, activeadmin, cancan

我在使用 Devise 和 CanCan 的 Rails 应用程序中尝试使用 ActiveAdmin 时不断收到错误消息。错误是：

> CanCan::AuthorizationNotPerformed in Admin::FindingsController#index

这个动作失败了，`check_authorization`因为它没有`authorize_resource`。添加`skip_authorization_check`以绕过此检查。

我进行了广泛研究，但找不到似乎可行的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-15T09:18:05.047

ActiveAdmin 以不同的方式授权请求，您不能`check_authorization`与 ActiveAdmin 一起使用。

# python-3.x - 蟒蛇编码（）

> ID：13435922
> 
> 赞同：23
> 
> 时间：2012-11-17T23:41:22.370
> 
> 标签：python-3.x, hex, encode

十六进制编解码器是否已从 python 3.3 中排除？当我写代码时

```
>>> s="Hallo"
>>> s.encode('hex')
Traceback (most recent call last):
  File "<pyshell#24>", line 1, in <module>
    s.encode('hex')
LookupError: unknown encoding: hex 
```

这意味着什么？我知道 binascii.hexlify() 但仍然 .encode() 方法很好！有什么建议吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-11-18T06:03:04.993

不，使用`encode()`hexlify 不好。

您使用`hex`编解码器的方式在 Python 2 中有效，因为您可以在 Python 2 中调用`encode()`8 位字符串，即您可以对已经编码的内容进行编码。那没有意义。`encode()`用于将 Unicode 字符串编码为 8 位字符串，而不是将 8 位字符串编码为 8 位字符串。

在 Python 3 中，您不能再调用`encode()`8 位字符串，因此`hex`编解码器变得毫无意义并被删除。

虽然理论上你可以有一个`hex`编解码器并像这样使用它：

```
>>> import codecs
>>> hexlify = codecs.getencoder('hex')
>>> hexlify(b'Blaah')[0]
b'426c616168' 
```

使用 binascii 更容易更好：

```
>>> import binascii
>>> binascii.hexlify(b'Blaah')
b'426c616168' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-20T12:13:14.240

这与上面的答案相同，但我对其进行了修改，因此它适用于 python 3。

```
import binascii
from Crypto.Cipher import AES
from Crypto import Random

def encrypt(passwrd, message):
    msglist = []
    key = bytes(passwrd, "utf-8")
    iv = Random.new().read(AES.block_size)
    cipher = AES.new(key, AES.MODE_CFB, iv)
    msg = iv + cipher.encrypt(bytes(message, "utf-8"))
    msg = binascii.hexlify(msg)
    for letter in str(msg):
        msglist.append(letter)
    msglist.remove("b")
    msglist.remove("'")
    msglist.remove("'")
    for letter in msglist:
        print(letter, end="")
    print("")

def decrypt(passwrd, message):
    msglist = []
    key = bytes(passwrd, "utf-8")
    iv = Random.new().read(AES.block_size)
    cipher = AES.new(key, AES.MODE_CFB, iv)
    msg = cipher.decrypt(binascii.unhexlify(bytes(message, "utf-8")))[len(iv):]
    for letter in str(msg):
        msglist.append(letter)
    msglist.remove("b")
    msglist.remove("'")
    msglist.remove("'")
    for letter in msglist:
        print(letter, end="")
    print("") 
```

# c - 如何通过 ProcessID 查找进程？

> ID：13435924
> 
> 赞同：3
> 
> 时间：2012-11-17T23:41:39.983
> 
> 标签：c, windows

有没有办法通过PID查找进程？假设我创建了一个进程，比如说 cmd.exe 和`CreateProcess`. 从这个 cmd 我打开一个记事本和一个油漆。是否有可能以某种方式找到这些过程？我需要的是来自这些进程的 PID。

有人可以帮助我。这对我来说真的很重要。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T00:09:49.633

您可以在 msdn microsoft windows api 中找到一个示例。查看下一个链接。

[枚举所有进程](http://msdn.microsoft.com/en-us/library/ms682623(VS.85).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T01:21:21.910

如果您知道cmd的PID，那么我认为您可以使用类似于[此问题](https://stackoverflow.com/questions/185254/how-can-a-win32-process-get-the-pid-of-its-parent)中列出的逻辑的逻辑来完成任务。

# objective-c - 我怎样才能找到最大的整数？

> ID：13435930
> 
> 赞同：-1
> 
> 时间：2012-11-17T23:42:32.490
> 
> 标签：objective-c

我有 5 个整数，我正在尝试找出哪一个整数的值最大。我怎样才能做到这一点？

我试过了：

```
if (louis > harry , matt , bob , jack) {
    name.text = @"Louis";
} 
```

但它不能正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-17T23:50:53.453

使用数组！将整数放入数组中。如果您甚至不能使用单独的命名`int`变量，`int`而是使用数组。

```
int values[5] = {louis, harry, matt, bob, jack};
NSArray *names = @[@"Louis", @"Harry", @"Matt", @"Bob", @"Jack"];
int highestValue = -INFINITY;
NSString *highestName = nil;
for (int i = 0; i < 5; i++) {
    if (values[i] > highestValue) {
        highestValue = values[i];
        highestName = names[i];
    }
} 
```

您的问题有很多解决方案。以上只是一个通用且非常简单的一个。

它只是将您的整数放入一个数组中，并使用一个循环来找到最大的一个。然后它从另一个字符串数组中获取相应的名称。请注意，该`int`数组是一个普通的 C 数组，而字符串数组是一个 Objective-C 样式[`NSArray`](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/NSArray.html)或[`NSString`](http://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)对象。

顺便说一句，您的方法不起作用，因为它不是有效的 C 代码。如果您想这样做，请按照我在下面的操作进行。但我真的建议使用数组，因为它更容易阅读维护。

```
if (louis > harry && louis > matt && louis > bob && louis > jack) {
    name.text = @"Louis";
} else if (harry > louis && harry > matt && harry > bob && harry > jack) {
    name.text = @"Harry";
} ... etc ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:49:43.973

*请注意，我对xcode没有任何经验，我只是在写我能找到的东西*

据我所见，无法`fmax`使用任意数量的参数进行调用，因此您必须遍历变量，如下所示：

```
switch(fmax(louis,fmax(harry,fmax(matt,fmax(bob,jack)))) {
    case louis: name.text = @"Louis"; break;
    case harry: name.text = @"Harry"; break;
    case matt : name.text = @"Matt";  break;
    case bob  : name.text = @"Bob";   break;
    case jack : name.text = @"Jack";  break;
} 
```

# php - 为 xslt 创建的表单中的输入提供有用的名称

> ID：13435932
> 
> 赞同：1
> 
> 时间：2012-11-17T23:42:38.983
> 
> 标签：php, xml, forms, xslt

我有一个 xml 文件。

我用一个 xsl 文件转换这个 xml 以生成一个 html 表单。

我在这个表单中有多个输入，所以我不知道给他们什么属性名称。由于我必须获取表单的数据，因此我需要相关的名称来识别每个输入。

我尝试了几种解决方案，但都没有成功。

这是 XML 文件：

```
<typedata id="post" label="Post" >
    <data name="titre" label="Titre" type="text" occurrence="1" />
    <data name="date" label="Date" type="abstract" occurrence="1" >
        <data name="jour" label="Jour" type="text" occurrence="1" >
            <attribut name="lol" label="Lol" />
        </data>
        <data name="mois" label="Mois" type="text" occurrence="1" />
        <data name="annee" label="Année" type="text" occurrence="1" />
    </data>
    <data name="thumbnail" label="Thumbnail Url" type="text" occurrence="1" >
        <attribut label="Thumbnail alt" name="alt" />
    </data>
    <data name="extrait" label="Extrait" type="textarea" occurrence="1" />
</typedata> 
```

这是 XSL 文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" 
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:str="http://exslt.org/strings"
    extension-element-prefixes="str">

    <xsl:output 
        method="html"
        indent="yes" 
        encoding="UTF-8"
        />

    <xsl:template match="typedata" >
        <input type="hidden" name="id" value="{@id}" />

        <!-- ID TypeData -->
        <label for="idTypeData" >ID TypeData : </label>
        <input type="text" id="idTypeData" name="idTypeData" value="{@id}" /><br />

        <!-- Label TypeData -->
        <label for="labelTypeData" >Label TypeData : </label>
        <input type="text" id="labelTypeData" name="labelTypeData" value="{@label}" /><br />

        <!-- Parcourir les data du type -->
        <xsl:apply-templates select="data" />

    </xsl:template>

    <!-- Template Data -->
    <xsl:template match="data" >
        <fieldset>
            <legend><xsl:value-of select="@label" /></legend>

            <!-- Titre -->
            <label for="{generate-id(@name)}" >Nom : </label>
            <input type="text" name="{generate-id(@name)}" id="{generate-id(@name)}" value="{@name}" />

            <!-- Label -->
            <label for="{generate-id(@label)}" >Label : </label>
            <input type="text" name="{generate-id(@label)}" id="{generate-id(@label)}" value="{@label}" />

            <!-- Type -->
            <label for="{generate-id(@type)}" >Type : </label>
            <select name="{generate-id(@type)}" id="{generate-id(@type)}">
                <xsl:call-template name="optionsType" >
                    <xsl:with-param name="type" >
                        <xsl:value-of select="@type" />
                    </xsl:with-param>
                </xsl:call-template>
            </select>

            <!-- Occurrence -->
            <label for="{generate-id(@occurrence)}" >Occurrence : </label>
            <select name="{generate-id(@occurrence)}" id="{generate-id(@occurrence)}">
                <xsl:call-template name="optionsOccurrence" >
                    <xsl:with-param name="occurrence" >
                        <xsl:value-of select="@occurrence" />
                    </xsl:with-param>
                </xsl:call-template>
            </select>

            <!-- Attributs -->
            <fieldset>
                <legend>Attributs</legend>

                <xsl:for-each select="attribut" >

                    <fieldset>
                        <legend><xsl:value-of select="@label" /></legend>

                        <!-- Name -->
                        <label for="{generate-id(@name)}" >Nom : </label>
                        <input type="text" id="{generate-id(@name)}" name="{name(ancestor::node())}" value="{@name}" />
                        <br />

                        <!-- Label -->
                        <label for="{generate-id(@label)}" >Label : </label>
                        <input type="text" id="{generate-id(@label)}" name="{generate-id(@label)}" value="{@label}" />
                        <br />

                    </fieldset>

                </xsl:for-each>

            </fieldset>

            <!-- Enfants -->
            <fieldset>
                <legend>Contient</legend>
                <xsl:apply-templates select="data" />
            </fieldset>

        </fieldset>
    </xsl:template>

    <!-- Template Options Type -->
    <xsl:template name="optionsType" >

        <xsl:param name="type" />

        <!-- Option text -->
        <xsl:element name="option" >
            <xsl:attribute name="value" >text</xsl:attribute>

            <!-- Mettre l'option en sélectionnée si demandé -->
            <xsl:if test="$type = 'text'" >
                <xsl:attribute name="selected" />
            </xsl:if>

            <xsl:text>Text</xsl:text>
        </xsl:element>

        <!-- Option textarea -->
        <xsl:element name="option" >
            <xsl:attribute name="value" >textarea</xsl:attribute>

            <!-- Mettre l'option en sélectionnée si demandé -->
            <xsl:if test="$type = 'textarea'" >
                <xsl:attribute name="selected" />
            </xsl:if>

            <xsl:text>Textarea</xsl:text>
        </xsl:element>

        <!-- Option Abstract -->
        <xsl:element name="option" >
            <xsl:attribute name="value" >abstract</xsl:attribute>

            <!-- Mettre l'option en sélectionnée si demandé -->
            <xsl:if test="$type = 'abstract'" >
                <xsl:attribute name="selected" />
            </xsl:if>

            <xsl:text>Abstract</xsl:text>
        </xsl:element>
    </xsl:template>

    <!-- Template Options Occurrence -->
    <xsl:template name="optionsOccurrence" >

        <xsl:param name="type" />

        <!-- Option 1 -->
        <xsl:element name="option" >
            <xsl:attribute name="value" >1</xsl:attribute>

            <!-- Mettre l'option en sélectionnée si demandé -->
            <xsl:if test="$type = '1'" >
                <xsl:attribute name="selected" />
            </xsl:if>

            <xsl:text>de 1 à 1</xsl:text>
        </xsl:element>

        <!-- Option ? -->
        <xsl:element name="option" >
            <xsl:attribute name="value" >?</xsl:attribute>

            <!-- Mettre l'option en sélectionnée si demandé -->
            <xsl:if test="$type = '?'" >
                <xsl:attribute name="selected" />
            </xsl:if>

            <xsl:text>de 0 à 1</xsl:text>
        </xsl:element>

        <!-- Option * -->
        <xsl:element name="option" >
            <xsl:attribute name="value" >*</xsl:attribute>

            <!-- Mettre l'option en sélectionnée si demandé -->
            <xsl:if test="$type = '*'" >
                <xsl:attribute name="selected" />
            </xsl:if>

            <xsl:text>de 0 à infini</xsl:text>
        </xsl:element>

        <!-- Option + -->
        <xsl:element name="option" >
            <xsl:attribute name="value" >+</xsl:attribute>

            <!-- Mettre l'option en sélectionnée si demandé -->
            <xsl:if test="$type = '+'" >
                <xsl:attribute name="selected" />
            </xsl:if>

            <xsl:text>de 1 à infini</xsl:text>
        </xsl:element>
    </xsl:template>

</xsl:stylesheet> 
```

这会产生一个这样的 HTML 表单（这是一个摘录，表单可以更大）

```
<fieldset>
    <legend>Date</legend>

    <label for="id942230">Nom : </label>
    <input type="text" name="id942230" id="id942230" value="date">

    <label for="id942274">Label : </label>
    <input type="text" name="id942274" id="id942274" value="Date">

    <label for="id942185">Type : </label>
    <select name="id942185" id="id942185">
        <option value="text">Text</option>
        <option value="textarea">Textarea</option>
        <option value="abstract" selected>Abstract</option>
    </select>

    <label for="id942245">Occurrence : </label>
    <select name="id942245" id="id942245">
        <option value="1">de 1 à 1</option>
        <option value="?">de 0 à 1</option>
        <option value="*">de 0 à infini</option>
        <option value="+">de 1 à infini</option>
    </select>

    <fieldset><legend>Attributs</legend></fieldset>

    <fieldset>
        <legend>Contient</legend>

        <fieldset>
            <legend>Jour</legend>

            <label for="id942231">Nom : </label>
            <input type="text" name="id942231" id="id942231" value="jour">

            <label for="id942236">Label : </label>
            <input type="text" name="id942236" id="id942236" value="Jour">

            <label for="id942224">Type : </label>
                <select name="id942224" id="id942224">
                <option value="text" selected>Text</option>
                <option value="textarea">Textarea</option>
                <option value="abstract">Abstract</option>
            </select>

            <label for="id942347">Occurrence : </label>
            <select name="id942347" id="id942347">
                <option value="1">de 1 à 1</option>
                <option value="?">de 0 à 1</option>
                <option value="*">de 0 à infini</option>
                <option value="+">de 1 à infini</option>
            </select>

            <fieldset>
                <legend>Attributs</legend>

                <fieldset>
                    <legend>LoL</legend>

                    <label for="id942327">Nom : </label>
                    <input type="text" id="id942327" name="" value="lol"><br>

                    <label for="id942342">Label : </label>
                    <input type="text" id="id942342" name="id942342" value="LoL">

                </fieldset>
            </fieldset>

            <fieldset><legend>Contient</legend></fieldset>

        </fieldset>
    </fieldset>
</fieldset> 
```

如您所见，我将 generate-id 赋予名称。但它不起作用，因为 ID 每次都在变化。

我搜索了一种可以在 PHP 中轻松找到的名称的好方法。

在 PHP 中，我需要指定数据 ex：

`$_POST['Label of Attribute LoL in the Data Jour in the Data Date']`

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T07:01:17.353

试试这个样式表，看看它是否更接近你想要的。我假设您需要唯一的 ID，因为您使用`generate-id()`的是`name()`. 我添加了一个命名模板`number`并在变量中调用它以在这样的表达式中使用

```
{concat(name(@label),'-',$number} 
```

这是样式表。

```
<xsl:stylesheet version="1.0" 
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:str="http://exslt.org/strings"
  extension-element-prefixes="str">

  <xsl:output 
    method="html"
    indent="yes" 
    encoding="UTF-8"
  />

  <xsl:template match="typedata" >
    <input type="hidden" name="id" value="{@id}" />

    <!-- ID TypeData -->
    <label for="idTypeData" >ID TypeData : </label>
    <input type="text" id="idTypeData" name="idTypeData" value="{@id}" /><br />

    <!-- Label TypeData -->
    <label for="labelTypeData" >Label TypeData : </label>
    <input type="text" id="labelTypeData" name="labelTypeData" value="{@label}" /><br />

    <!-- Parcourir les data du type -->
    <xsl:apply-templates select="data" />

  </xsl:template>

  <!-- Template Data -->
  <xsl:template match="data" >
    <xsl:variable name="number">
      <xsl:call-template name="number"/>
    </xsl:variable>
    <fieldset>
      <legend><xsl:value-of select="@label" /></legend>

      <!-- Titre -->
      <label for="{concat(name(@name),'-',$number)}" >Nom : </label>
      <input type="text" name="{concat(name(@name),'-',$number)}" id="{concat(name(@name),'-',$number)}" value="{@name}" />

      <!-- Label -->
      <label for="{concat(name(@label),'-',$number)}" >Label : </label>
      <input type="text" name="{concat(name(@label),'-',$number)}" id="{concat(name(@label),'-',$number)}" value="{@label}" />

      <!-- Type -->
      <label for="{concat(name(@type),'-',$number)}" >Type : </label>
      <select name="{concat(name(@type),'-',$number)}" id="{concat(name(@type),'-',$number)}">
        <xsl:call-template name="optionsType" >
          <xsl:with-param name="type" >
            <xsl:value-of select="@type" />
          </xsl:with-param>
        </xsl:call-template>
      </select>

      <!-- Occurrence -->
      <label for="{concat(name(@occurrence),'-',$number)}" >Occurrence : </label>
      <select name="{concat(name(@occurrence),'-',$number)}" id="{concat(name(@occurrence),'-',$number)}">
        <xsl:call-template name="optionsOccurrence" >
          <xsl:with-param name="occurrence" >
            <xsl:value-of select="@occurrence" />
          </xsl:with-param>
        </xsl:call-template>
      </select>

      <!-- Attributs -->
      <fieldset>
        <legend>Attributs</legend>

        <xsl:for-each select="attribut" >
          <xsl:variable name="attribut-number">
            <xsl:call-template name="number"/>
          </xsl:variable>

          <fieldset>
            <legend><xsl:value-of select="@label" /></legend>

            <!-- Name -->
            <label for="{concat(name(@name),'-',$attribut-number)}" >Nom : </label>
            <input type="text" id="{concat(name(@name),'-',$attribut-number)}" name="{concat(name(@name),'-',$attribut-number)}" value="{@name}" />
            <br />

            <!-- Label -->
            <label for="{concat(name(@label),'-',$attribut-number)}" >Label : </label>
            <input type="text" id="{concat(name(@label),'-',$attribut-number)}" name="{concat(name(@label),'-',$attribut-number)}" value="{@label}" />
            <br />

          </fieldset>

        </xsl:for-each>

      </fieldset>

      <!-- Enfants -->
      <fieldset>
        <legend>Contient</legend>
        <xsl:apply-templates select="data" />
      </fieldset>

    </fieldset>
  </xsl:template>

  <!-- Template Options Type -->
  <xsl:template name="optionsType" >

    <xsl:param name="type" />

    <!-- Option text -->
    <xsl:element name="option" >
      <xsl:attribute name="value" >text</xsl:attribute>

      <!-- Mettre l'option en sélectionnée si demandé -->
      <xsl:if test="$type = 'text'" >
        <xsl:attribute name="selected" />
      </xsl:if>

      <xsl:text>Text</xsl:text>
    </xsl:element>

    <!-- Option textarea -->
    <xsl:element name="option" >
      <xsl:attribute name="value" >textarea</xsl:attribute>

      <!-- Mettre l'option en sélectionnée si demandé -->
      <xsl:if test="$type = 'textarea'" >
        <xsl:attribute name="selected" />
      </xsl:if>

      <xsl:text>Textarea</xsl:text>
    </xsl:element>

    <!-- Option Abstract -->
    <xsl:element name="option" >
      <xsl:attribute name="value" >abstract</xsl:attribute>

      <!-- Mettre l'option en sélectionnée si demandé -->
      <xsl:if test="$type = 'abstract'" >
        <xsl:attribute name="selected" />
      </xsl:if>

      <xsl:text>Abstract</xsl:text>
    </xsl:element>
  </xsl:template>

  <!-- Template Options Occurrence -->
  <xsl:template name="optionsOccurrence" >

    <xsl:param name="type" />

    <!-- Option 1 -->
    <xsl:element name="option" >
      <xsl:attribute name="value" >1</xsl:attribute>

      <!-- Mettre l'option en sélectionnée si demandé -->
      <xsl:if test="$type = '1'" >
        <xsl:attribute name="selected" />
      </xsl:if>

      <xsl:text>de 1 à 1</xsl:text>
    </xsl:element>

    <!-- Option ? -->
    <xsl:element name="option" >
      <xsl:attribute name="value" >?</xsl:attribute>

      <!-- Mettre l'option en sélectionnée si demandé -->
      <xsl:if test="$type = '?'" >
        <xsl:attribute name="selected" />
      </xsl:if>

      <xsl:text>de 0 à 1</xsl:text>
    </xsl:element>

    <!-- Option * -->
    <xsl:element name="option" >
      <xsl:attribute name="value" >*</xsl:attribute>

      <!-- Mettre l'option en sélectionnée si demandé -->
      <xsl:if test="$type = '*'" >
        <xsl:attribute name="selected" />
      </xsl:if>

      <xsl:text>de 0 à infini</xsl:text>
    </xsl:element>

    <!-- Option + -->
    <xsl:element name="option" >
      <xsl:attribute name="value" >+</xsl:attribute>

      <!-- Mettre l'option en sélectionnée si demandé -->
      <xsl:if test="$type = '+'" >
        <xsl:attribute name="selected" />
      </xsl:if>

      <xsl:text>de 1 à infini</xsl:text>
    </xsl:element>
  </xsl:template>

  <xsl:template name="number">
    <xsl:number count="data|attribut" level="any"/>
  </xsl:template>

</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T17:17:43.983

谢谢您的帮助 ！

我调整了您的解决方案以准确获得我需要的东西：

（我为属性“id”更改了“data”节点的“name”属性，但没关系）

这是模板编号：

```
<xsl:template name="number">
    <xsl:number count="data|attribut" level="multiple"/>
</xsl:template> 
```

这是数据节点标签和输入的 xslt：

```
<label for="{concat(name(@id),'-',$number)}" >Nom : </label>
<input type="text" name="{concat($number,'-','data','-',name(@id))}" id="{concat(name(@id),'-',$number)}" value="{@id}" /> 
```

这是属性节点的标签和输入的 xslt：

```
 <label for="{concat(name(@id),'-',$attribut-number)}" >Nom : </label>
 <input type="text" name="{concat($attribut-number,'-','att','-',name(@id))}" id="{concat(name(@id),'-',$attribut-number)}" value="{@id}" /> 
```

使用此代码在我的名称属性中获得的示例：

`2-data-id`-> 数据节点n°2的id属性

`2.1-data-label`-> 数据节点n°2中数据节点n°1的标签属性

`2.1.2.1-att-id`-> 数据节点 n°2 中属性节点 n°1 的 id 属性等

所以有了这个名字属性，我可以很容易地在 php 中控制它们。感谢您的帮助九九！

# sql - 带有 AND 和 OR 复合语句的 oracle 特定 SQL 查询

> ID：13435934
> 
> 赞同：0
> 
> 时间：2012-11-17T23:43:06.550
> 
> 标签：sql, oracle, plsql, oracle10g

我有以下查询..

```
select * 
  from  TABLE
 where (to_date('1970-01-01 00:00:00','yyyy-MM-dd hh24:mi:ss') + (AUDITTIMESTAMP/60/60/24/1000)) < to_date('2012-11-18 10:06', 'yyyy-MM-dd hh24:mi:ss') 
   AND (to_date('1970-01-01 00:00:00','yyyy-MM-dd hh24:mi:ss') + (AUDITTIMESTAMP/60/60/24/1000)) > to_date('2012-11-17 22:06', 'yyyy-MM-dd hh24:mi:ss')  
   AND (
     --(COLUMNA like '%aaa%' AND COLUMNAA like '%aaaaaaaaaaaaa%')
       (COLUMNB like '%bbb%' AND COLUMNBB like '%bbbbbbbbbbbbbb%')
     --or(COLUMNC like '%ccc%' AND COLUMNCC like '%ccccccccccccccc%') 
     --or (COLUMND like '%ddd%' AND COLUMNDD like '%ddddddddd%')
     )
 order by COLUMN1_PK 
```

对于括号内的复合 OR 语句中的每个条件，数据库中都有记录。

但是当我在这个复合块中有一个语句时，没有返回记录。

我怎样才能改变它来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T04:43:20.703

如果您所说的正在发生的事情真的发生了，那将是最令人惊讶和令人担忧的，因为这表明 Oracle 出现了严重错误。幸运的是，情况并非如此：因为[这个 SQL Fiddle 演示](http://sqlfiddle.com/#!4/2239b/1)了未复合条件在两列上*都*匹配，而不仅仅是第一列。

您所看到的最可能的解释是您的数据存在问题，或者更确切地说是您对数据的理解。您只是在指定的时间范围内没有任何与 COLUMNB 和 COLUMNBB 匹配的记录。

* * *

如果您不同意此评估，请发布*足够的*代表性数据作为测试用例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T02:54:24.590

不是一个答案，只是一些调试帮助与代码格式化的奢侈。也许您可以将 WHERE 子句移动到列中，并保留未过滤的数据以查看到底发生了什么。这通常可以帮助您看到可能不明显的东西。您应该在结果集中看到出现在 C1 或 C2 中的 1 将导致出现在 C3 中的 1。试试这个并发表评论。

```
select 
  CASE 
    WHEN COLUMNA like '%aaa%' AND COLUMNAA like '%aaaaaaaaaaaaa%'  
    THEN 1 ELSE 0 END C1,
  CASE 
    WHEN COLUMNB like '%bbb%' AND COLUMNBB like '%bbbbbbbbbbbbbb%' 
    THEN 1 ELSE 0 END C2,
  CASE WHEN (
    (COLUMNA like '%aaa%' AND COLUMNAA like '%aaaaaaaaaaaaa%') OR
    (COLUMNB like '%bbb%' AND COLUMNBB like '%bbbbbbbbbbbbbb%') 
    THEN 1 ESLE 0 END C3
from  TABLE
where date '1970-01-01' + AUDITTIMESTAMP/60/60/24/1000
  between timestamp '2012-11-17 22:06:01' and timestamp '2012-11-18 10:05:59'
order by COLUMN1_PK 
```

# java - 从 URL 或 HttpUrlConnection 获取下载文件名？

> ID：13435940
> 
> 赞同：0
> 
> 时间：2012-11-17T23:44:05.497
> 
> 标签：java, url, download, httpurlconnection

在 Firefox 中从以下 URL 下载文件（Eclipse 的 win32 zip）时，文件名为`eclipse-jee-juno-SR1-win32.zip`.

```
http://www.eclipse.org/downloads/download.php?file=/technology/epp/downloads/release/juno/SR1/eclipse-jee-juno-SR1-win32.zip&url=http://download.eclipse.org/technology/epp/downloads/release/juno/SR1/eclipse-jee-juno-SR1-win32.zip&mirror_id=1 
```

但是，此文件名未在`Content-disposition`标头中指定，这是获取服务器建议文件名的标准方法。

这里，eclipse的下载只是一个例子。我看到文件名是 URL 的一部分，但是是否有其他方法来获取文件名？在这种情况下，我可以使用正则表达式从 URL 中提取文件名，但不能保证它是每个没有 Content-disposition 标头的 URL 的一部分。

**问题：当没有 Content-disposition 标头时，如何获取下载的文件名？**或者，更本地化，Firefox 是如何提出上述名称的？

[还是 Firefox 只是在此处解析 URL，而我遇到过一个案例，尽管从间接的、脚本交付的下载中提取文件名，但它恰好可以工作？]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:47:13.697

内容处置是服务器建议文件名的标准方法。在没有内容处置标头的情况下，完全由客户端提供文件名。最常见的选择是采用路径的最后一段。

在没有内容处置标头的情况下，服务器甚至没有真正说应该将 url 下载到文件而不是显示。只是大多数浏览器默认将无法显示的任何内容保存为文件。

# java - 什么是空：Java？

> ID：13435942
> 
> 赞同：1
> 
> 时间：2012-11-17T23:44:18.700
> 
> 标签：java, null

我正在阅读 Patrick Naughton 的“Java 手册”。

书上说：当你将一个变量的类型声明为一个类时，它有一个默认值，`null` **它是 type 的引用，`Object`**因此与所有其他类都是类型兼容的。`null`对象没有价值；它与整数 0 不同，就像布尔值一样`false`。

我无法理解/混淆突出显示的部分，它是否说这`null`是一个类型的变量`Object`？

页码：107 段：5

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-17T23:45:22.253

它是一个参考*值*，而不是一个参考*变量*。任何作为引用类型的变量都可以具有值*null*。（在 Java 中，所有变量要么是引用类型，要么是原始类型（`int`、`char`、`float`等）。（好吧，当您开始谈论泛型时，也有类型变量。）

[这是Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html)的相关部分：

> Java 编程语言中有两种类型：原始类型（第 4.2 节）和引用类型（第 4.3 节）。相应地，有两种数据值可以存储在变量中、作为参数传递、由方法返回并对其进行操作：原始值（第 4.2 节）和参考值（第 4.3 节）。
> 
> 还有一种特殊的 null 类型，即表达式 null 的类型（第 3.10.7 节、第 15.8.1 节），它没有名称。
> 
> 因为 null 类型没有名字，所以不可能声明一个 null 类型的变量或强制转换为 null 类型。
> 
> 空引用是空类型表达式的唯一可能值。
> 
> 空引用始终可以进行扩展引用转换为任何引用类型。
> 
> 在实践中，程序员可以忽略 null 类型，只是假装 null 只是一个可以是任何引用类型的特殊文字。

**编辑**解决您的评论：我认为“Java 手册”中的语言有点离题。该值`null`不是 type 的引用`Object`；它是空类型的引用。规范中的关键点是“空引用总是可以经历扩大的引用转换为任何引用类型”。从某种意义上说，这恰恰相反`Object`。参考是最广泛的`Object`参考类型；类型是`null`（也有点松散地说）最窄的。特别是，将类型的引用分配给`Object`任何其他引用类型的变量是一种*缩小*转换，需要显式强制转换（并且可以引发 a `ClassCastException`）。分配`null`对任何引用类型的变量的引用从不需要强制转换，也不能引发异常。

请注意，没有命名引用类型可以具有 null 类型的行为。确实没有“最窄类型”，因为 Java 中的（命名）类型系统没有这样的东西。不可能定义一个既可分配给`String`变量又可分配给变量的引用类型`Double`。只有 null 类型具有该属性。引用类型转换的常规规则不允许这样做，这就是为什么它在 Java 语言规范中有单独的规则。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:47:34.183

来自[**JLS**](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.7)：

> null 类型有一个值，即 null 引用，由 null 文字 null 表示，它由 ASCII 字符组成。

# c# - Windows Phone 7 上的 WebRequest

> ID：13435943
> 
> 赞同：0
> 
> 时间：2012-11-17T23:44:25.653
> 
> 标签：c#, httpwebrequest

我有以下类（我取自网上的一个例子，我唯一修改的是我使用 IP 地址和端口而不是域名）：

```
public class ConnectionManager
{
    private static ManualResetEvent allDone = new ManualResetEvent(false);
    private string message = "foobar";

    public Action MessageSent;
    public Action<string> MessageReceived;
    public void SendMessage()
    {
          // Create a new HttpWebRequest object.
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://10.1.91.48:3330/");

        request.ContentType = "application/json; charset=utf-8";
        request.Accept = "application/json";
        // Set the Method property to 'POST' to post data to the URI.
        request.Method = "POST";

        // start the asynchronous operation
        request.BeginGetRequestStream(new AsyncCallback(GetRequestStreamCallback), request);
        MessageSent();
        // Keep the main thread from continuing while the asynchronous 
        // operation completes. A real world application 
        // could do something useful such as updating its user interface. 
        allDone.WaitOne();
    }
    private void GetRequestStreamCallback(IAsyncResult asynchronousResult)
    {
        HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;

        // End the operation
        Stream postStream = request.EndGetRequestStream(asynchronousResult);

        // Convert the string into a byte array. 
        byte[] byteArray = Encoding.UTF8.GetBytes(message);

        // Write to the request stream.
        postStream.Write(byteArray, 0, byteArray.Length);
        postStream.Close();

        // Start the asynchronous operation to get the response
        request.BeginGetResponse(new AsyncCallback(GetResponseCallback), request);
    }

    private void GetResponseCallback(IAsyncResult asynchronousResult)
    {
        HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;

        // End the operation
        HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(asynchronousResult);
        Stream streamResponse = response.GetResponseStream();
        StreamReader streamRead = new StreamReader(streamResponse);
        string responseString = streamRead.ReadToEnd();
        Console.WriteLine(responseString);
        // Close the stream object
        streamResponse.Close();
        streamRead.Close();

        // Release the HttpWebResponse
        response.Close();
        allDone.Set();

        MessageReceived(responseString);
    }
} 
```

上面的代码无法发送消息。如果我迈步，当我在 GetRequestStreamCallback 内部时，我可以在 IAsyncResult 内部看到以下错误：

> AsyncWaitHandle = 'asynchronousResult.AsyncWaitHandle' 引发了“System.NotSupportedException”类型的异常

我究竟做错了什么？如何修复此代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T02:03:36.413

虽然这可能不是您问题的解决方案，但您需要养成将`IDisposable`对象放入 using 块的习惯，以确保即使发生异常也能清理它们：

```
private void GetRequestStreamCallback(IAsyncResult asynchronousResult)
{
    HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;

    // End the operation
    using (Stream postStream = request.EndGetRequestStream(asynchronousResult))
    {
        byte[] byteArray = Encoding.UTF8.GetBytes(message);

        // Write to the request stream.
        postStream.Write(byteArray, 0, byteArray.Length);
        postStream.Close();
    }

    // Start the asynchronous operation to get the response
    request.BeginGetResponse(new AsyncCallback(GetResponseCallback), request);
}

private void GetResponseCallback(IAsyncResult asynchronousResult)
{
    HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;

    // End the operation
    string responseString;
    using (HttpWebResponse response = (HttpWebResponse) request.EndGetResponse(asynchronousResult))
    {
        using (Stream streamResponse = response.GetResponseStream())
        {
            using (StreamReader streamRead = new StreamReader(streamResponse))
            {
                responseString = streamRead.ReadToEnd();
                Console.WriteLine(responseString);
            }
        }
    }
    allDone.Set();

    MessageReceived(responseString);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T03:14:01.317

作为替代方案，您可以使用 RestSharp。

[http://restsharp.org/](http://restsharp.org/)

它使这种事情变得微不足道。但是，您必须进行一些细微的更改才能使其在 Windows Phone 上运行：

[http://www.toncodes.net/blog/async-and-restsharp-for-windows-phone-7/](http://www.tonicodes.net/blog/async-and-restsharp-for-windows-phone-7/)

没有什么太疯狂了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T08:31:00.750

我最终使用了 WebClient：

```
WebClient wc = new WebClient();
wc.DownloadStringCompleted += ReadServerResponse;
wc.DownloadStringAsync(new Uri(url)); 
```

# python - 在函数中返回一个列表。另外，while循环的问题

> ID：13435944
> 
> 赞同：1
> 
> 时间：2012-11-17T23:44:30.540
> 
> 标签：python, list, function, while-loop

我在 Python 中创建函数时遇到问题。我希望我的功能允许用户在列表中输入单词并询问用户是否要输入其他单词。如果用户输入“n”，我希望该函数返回列表中输入的单词。当我运行该函数时，它会询问用户是否要输入两次额外的单词。此外，它不会返回列表。

```
def add_list(x):
    first_list = raw_input('Please input a word to add to a list ')
    x.append(first_list)
    response = None
    while response != 'n':
        response = raw_input('Would you like to enter another word? ')
        if response == 'n':
            print 'Here is the list of words'
            return x            
        else:
            add_list(x)

def main(): 
    add_list(x)

x = []
main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T00:42:43.877

如上所述，您的代码不返回任何内容的原因是因为您实际上并没有打印结果。此外，即使您已经说过“n”，它仍然继续询问您是否要输入另一个单词的原因是由于递归（即您以嵌套方式一遍又一遍地调用函数的事实（想想Excel中的嵌套IF，如果有帮助的话:)）。一旦你掌握了基础知识，你就可以更多地阅读它，但现在我会避免它:)

这是一个基本版本的东西，可以做你想做的事，评论希望能帮助你理解正在发生的事情：

```
def add_list():
    # Since you are starting with an empty list and immediately appending
    # the response, you can actually cut out the middle man and create
    # the list with the result of the response all at once (notice how
    # it is wrapped in brackets - this just says 'make a list from the
    # result of raw_input'
    x = [raw_input('Please input a word to add to a list: ')]

    # This is a slightly more idiomatic way of looping in this case. We
    # are basically saying 'Keep this going until we break out of it in
    # subsequent code (you can also say while 1 - same thing).
    while True:
        response = raw_input('Would you like to enter another word? ')

        # Here we lowercase the response and take the first letter - if
        # it is 'n', we return the value of our list; if not, we continue
        if response.lower()[0] == 'n':
            return x
        else:
            # This is the same concept as above - since we  know that we
            # want to continue, we append the result of raw_input to x.
            # This will then continue the while loop, and we will be asked
            # if we want to enter another word.
            x.append(raw_input('Please input a word to add to the list: '))

def main():
    # Here we return the result of the function and save it to my_list
    my_list = add_list()

    # Now you can do whatever you want with the list
    print 'Here is the list of words: ', my_list

main() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T23:58:37.510

我稍微修改了你的程序：

```
def add_list(x):
    first_list = raw_input('Please input a word to add to a list.')
    x.append(first_list)
    response = None
    while response != 'n':
        response = raw_input('Would you like to enter another word? ')
        if response.lower() in ['n','no']:
            print 'Here is the list of words:', x
            return x            
        else:
            x.append(response)

def main(): 
    returned_list = add_list(x)
    print "I can also print my returned list: ", returned_list

x = []
main() 
```

第一：不需要递归。而是简单地附加`response`到您的列表中`x`。python 的一个很好的特性是检查是否`response`不仅仅是`n`，而是任何接近`n`使用的东西：

```
if response.lower() in ['n','no']: 
```

我还编辑了一行，将列表实际打印给您的用户！

```
print 'Here is the list of words:', x 
```

最后，您还可以在退货后打印您的清单。查看已编辑的`def main():`.

# wpf - 如何使用相同的动画，WPF一个一个地为不同的按钮设置动画

> ID：13435947
> 
> 赞同：0
> 
> 时间：2012-11-17T23:44:39.130
> 
> 标签：wpf, animation, button, imagebutton

我是 WPF 新手，有一个可能很愚蠢的问题。

我试图用相同的动画（旋转 360 度）为 4 个按钮设置动画，当其中一个被单击时，只有这个被动画化。

这是我到目前为止所拥有的：

```
 <Window.Resources>
    <Storyboard x:Key="Storyboard" BeginTime="00:00:00" Duration="00:00:10">
        <DoubleAnimationUsingKeyFrames Storyboard.TargetName="rotButton" Storyboard.TargetProperty="(RotateTransform.Angle)">
            <SplineDoubleKeyFrame KeyTime="0:0:00.0" Value="0.0" />
            <SplineDoubleKeyFrame KeyTime="0:0:01.0" Value="360.0" />
        </DoubleAnimationUsingKeyFrames>
    </Storyboard>

</Window.Resources> 
```

并且 rotButton 在这里的第一个按钮中定义：

```
<Button Click="Button_Click">
            <StackPanel>
                <Image Source="open.png" Height="46" Width="48" />
            </StackPanel>
            <Button.RenderTransform>
                <TransformGroup>
                    <RotateTransform x:Name="rotButton" Angle="0" CenterX="25" CenterY="25" />
                    <ScaleTransform x:Name="scaButton" ScaleX="1" ScaleY="1" CenterX="50" CenterY="25" />
                </TransformGroup>
            </Button.RenderTransform>
            <Button.Triggers>
                <EventTrigger RoutedEvent="Button.Click">
                    <BeginStoryboard Storyboard="{StaticResource Storyboard}" />
                </EventTrigger>
            </Button.Triggers>
        </Button> 
```

如何将此代码用于所有其他按钮并为每个按钮使用“通用”Button.RenderTransform？应该有更聪明的方法来创建 3 个故事板并为每个按钮使用 rotButton1、rotButton2 等。

我希望这是有道理的，并指出我正确的方向:)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T19:35:02.620

如果为按钮创建样式，则可以使用 setter 为使用该样式的每个按钮实例设置 RenderTransform。此外，样式可以有触发器。

诀窍是正确的路径语法[http://blogs.charteris.com/blogs/patl-closed/archive/2007/03/20/Complex-PropertyPath-syntax.aspx](http://blogs.charteris.com/blogs/patl-closed/archive/2007/03/20/Complex-PropertyPath-syntax.aspx)

```
 <Window.Resources>
    <TransformGroup x:Key="transformGroup">
        <RotateTransform Angle="0" CenterX="25" CenterY="25" />
        <ScaleTransform ScaleX="1" ScaleY="1" CenterX="50" CenterY="25" />
    </TransformGroup>
    <Style x:Key="MyButtonStyle"  TargetType="{x:Type Button}">
        <Setter Property="RenderTransform" Value="{StaticResource transformGroup}"/>
        <Style.Triggers>
            <EventTrigger RoutedEvent="Button.Click">
                <BeginStoryboard>
                    <Storyboard BeginTime="00:00:00" Duration="00:00:10">
                        <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(Button.RenderTransform).(TransformGroup.Children)[0].(RotateTransform.Angle)">
                            <SplineDoubleKeyFrame KeyTime="0:0:00.0" Value="0.0" />
                            <SplineDoubleKeyFrame KeyTime="0:0:01.0" Value="360.0" />
                        </DoubleAnimationUsingKeyFrames>
                    </Storyboard>
                </BeginStoryboard>
            </EventTrigger>
        </Style.Triggers>
    </Style>
</Window.Resources>
<Grid>
    <StackPanel>
        <Button Style="{StaticResource MyButtonStyle}"/>
        <Button Style="{StaticResource MyButtonStyle}"/>           
    </StackPanel>
</Grid> 
```

# php - 使用 simpleXML php 将 xml 的信息放入数组中

> ID：13435951
> 
> 赞同：-2
> 
> 时间：2012-11-17T23:45:02.910
> 
> 标签：php, xml, foreach, simplexml

来源：

[使用 php simplexml 显示来自 XML 的数据](https://stackoverflow.com/questions/5833788/display-data-from-xml-using-php-simplexml)

[使用 SimpleXML 获取属性和值](https://stackoverflow.com/questions/6399504/get-attributes-and-values-using-simplexml)

[PHP SimpleXML + 获取属性](https://stackoverflow.com/questions/10537657/php-simplexml-get-attribute)

我正在尝试使用 simpleXML for php 但无法使其正常工作

我的 xml 示例

```
 <?xml version="1.0" encoding="UTF-8" standalone="no" ?>
    <gpx creator="Ski Tracks 1.3.3" version="1.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.topografix.com/GPX/1/0" xsi:schemaLocation="http://www.topografix.com/GPX/1/0 http://www.topografix.com/GPX/1/0/gpx.xsd">
    <metadata>
    <link href="http://www.corecoders.com">
    <text>Core Coders Ltd</text>
    </link>
    <time>2012-11-15T13:52:46.005+01:00</time>
    <bounds maxlat="52.0502500" maxlon="5.6405950" minlat="52.0498680" minlon="5.6387020"/>
    </metadata>
    <trk>
    <name>New Track Doe Maar</name>
    <desc>Yeah</desc>
    <type>snowboarding</type>
    <trkseg>
    <trkpt lat="52.0499970" lon="5.6387520">
    <ele>3.00</ele>
    <time>2012-11-15T13:42:17.380+01:00</time>
    </trkpt>
    <trkpt lat="52.0499510" lon="5.6388820">
    <ele>3.00</ele>
    <time>2012-11-15T13:43:32.433+01:00</time>
    </trkpt
</trkpt>
</trkseg>
</trk>
 </gpx> 
```

我想检索 'trkpt' 属性及其子元素，例如 'time' 和 'ele'，并且我想将 trkpt 'lat'/'lon'、'time' 和 'ele' 元素放在一个数组中。我只是不让它工作这件作品现在工作正常并获取元数据信息

```
 $xml = simplexml_load_file("./data/ski1/skitrack.xml");

    //$url = './data/ski1/skitrack.xml';
    //$xml = new SimpleXmlElement($url, null, true);

    $time = $xml->metadata[0]->time;
    $name = $xml->trk->name;
    $desc = $xml->trk->desc;
    $type = $xml->trk->type;
    foreach ($xml->metadata[0]->bounds as $bounds) {
        $maxlat = $bounds->attributes()->maxlat;
        $maxlon = $bounds->attributes()->maxlon;
        $minlat = $bounds->attributes()->minlat;
        $minlon = $bounds->attributes()->minlon; 

    } 
```

但是当我为 trkpt 尝试它时，它给了我一个错误，即没有数组：为 foreach 提供的参数无效

```
 print_r($xml);

    foreach ($xml->trkseg->trkpt as $trkpt) {
        $lon = $trkpt->attributes()->lon;
    } 
```

我实际上正在尝试将代码从 javascript 转换为 php，它在 javascr 中工作得很好

```
 var alat = new Array();
        var alon = new Array();
        var ele = new Array();
        var year = new Array();
        var month = new Array();
        var day = new Array();
        var hours = new Array();
        var minutes = new Array();
        var seconds = new Array();
        var milisec = new Array();

        $(xml).find('trkseg').each(function(){
            $(this).find('trkpt').each(function(i){
                alat[i] = $(this).attr('lat');
                alon[i] = $(this).attr('lon');
                ele[i] = $(this).find('ele').text();
                year[i] = $(this).find('time').text().substr(0,4);
                month[i] = $(this).find('time').text().substr(5,2);
                day[i] = $(this).find('time').text().substr(8,2);
                hours[i] = $(this).find('time').text().substr(11,2);
                minutes[i] = $(this).find('time').text().substr(14,2);
                seconds[i] = $(this).find('time').text().substr(17,2);
                milisec[i] = $(this).find('time').text().substr(20,3);

                if(i > 0) {
                    var laterdate = new Date(year[i],month[i],day[i],hours[i],minutes[i],seconds[i],milisec[i]);
                    var earlierdate = new Date(year[i-1],month[i-1],day[i-1],hours[i-1],minutes[i-1],seconds[i-1],milisec[i-1]);
                    locDistance(alat[i-1], alon[i-1], alat[i], alon[i]);
                    timeDifference(laterdate,earlierdate);
                }

                $('.content').append(i);
                $('.content').append(
                '<br />lat ' + alat[i] +
                '<br />' + 'lon ' + alon[i] +
                '<br / >' + 'ele ' + ele[i] +
                '<br / >' + 'time ' + year[i] + (month[i]-1) + day[i] + hours[i] + minutes[i] + seconds[i] + milisec[i] +
                '<br / >' + 'dist ' + d + '<br / >'
                );

                i = i + 1;

            });
        }); 
```

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T00:28:16.673

虽然您发布的 xml 没有验证（它缺少标签），但我假设它应该是这样的：

```
<?xml version="1.0" encoding="UTF-8" standalone="no" ?>
<gpx creator="Ski Tracks 1.3.3" version="1.0"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.topografix.com/GPX/1/0" xsi:schemaLocation="http://www.topografix.com/GPX/1/0 http://www.topografix.com/GPX/1/0/gpx.xsd">
   <metadata>
      <link href="http://www.corecoders.com">
         <text>Core Coders Ltd</text>
      </link>
      <time>2012-11-15T13:52:46.005+01:00</time>
      <bounds maxlat="52.0502500" maxlon="5.6405950" minlat="52.0498680" minlon="5.6387020"/>
   </metadata>
   <trk>
      <name>New Track Doe Maar</name>
      <desc>Yeah</desc>
      <type>snowboarding</type>
      <trkseg>
         <trkpt lat="52.0499970" lon="5.6387520">
            <ele>3.00</ele>
            <time>2012-11-15T13:42:17.380+01:00</time>
         </trkpt>
         <trkpt lat="52.0499510" lon="5.6388820">
            <ele>3.00</ele>
            <time>2012-11-15T13:43:32.433+01:00</time>
         </trkpt>
      </trkseg>
   </trk>
</gpx> 
```

如果是这种情况，那么您的代码`foreach ($xml->trkseg->trkpt`无法找到，`trkseg`因为它嵌套在`trk`元素中。相反，您可以尝试遍历每个`trk`元素，然后在每个`trk`元素中访问这些`trkseg`元素。

```
foreach($xml->trk as $trk)
{
    //do something with each trk

    foreach ($trk->trkseg->trkpt as $trkpt) {

         //do something with each trkseg

    }
} 
```

# dart - 到目前为止，是否可以使用 Dart 制作跨浏览器兼容的游戏？

> ID：13435952
> 
> 赞同：1
> 
> 时间：2012-11-17T23:45:11.100
> 
> 标签：dart

仅仅让它兼容三大浏览器IE9+、Chrome和Firefox怎么样？

我想使用 Canvas 2D 制作游戏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T00:30:47.540

据我所知，它工作得很好。不幸的是，我现在无法测试它，因为我没有 Windows 机器。但是，有很多示例展示了如何执行此类操作。看：

*   [http://dart-lang.github.com/pop-pop-win/](http://dart-lang.github.com/pop-pop-win/)
*   [https://github.com/dart-lang/pop-pop-win](https://github.com/dart-lang/pop-pop-win)
*   [https://github.com/dart-lang/dart-html5-samples/tree/master/web/speed/animations](https://github.com/dart-lang/dart-html5-samples/tree/master/web/speed/animations)

现代浏览器支持画布：http: [//caniuse.com/#feat=canvas](http://caniuse.com/#feat=canvas)

# c - 可以使用 fseek() 将数据插入文件中间吗？- C

> ID：13435955
> 
> 赞同：3
> 
> 时间：2012-11-17T23:46:00.687
> 
> 标签：c, insert, fseek

我知道函数 fseek() 可用于将数据输出到文件中的特定位置。但我想知道我是否使用 fseek() 移动到文件中间然后输出数据。新数据会覆盖旧数据吗？例如，如果我有一个包含 123456789 的文件，并且我使用 fseek() 在 5 之后输出 newdata，那么该文件将包含 12345newdata6789 还是包含 12345newdata。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-17T23:48:22.310

在文件的“中间”写入数据将覆盖现有数据。所以你会有'12345newdata'。

* * *

编辑：正如下面的评论中提到的，应该注意的是，这会覆盖数据而不截断文件的其余部分。作为您的示例的扩展版本，如果您在包含 的文件中编写`newdata`了，那么您将拥有，*而不是*。`5``1234567890ABCDEFG``12345newdataCDEFG` *`12345newdata`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:47:20.500

是的，它可以让您这样做，这些文件称为“随机访问文件”。假设您已经有一个设置文件（具有结构但为空），在这种情况下，您可以填充所需的“插槽”，或者在插槽充满数据的情况下，您可以覆盖它。

```
typedef struct{
    int number;
    char name[ 20 ];
    char lastname[ 20 ];
    float score;
}students_t;

/* Supposing that you formatted the file already and the file is opened. */
/* Imagine the students are listed each one has a record. */

void modifyScore( FILE * fPtr ){
    students_t student = { 0, "", "", 0.0 };
    int nrecord;
    float nscore;

    printf( "Enter the number of the student:" );
    scanf( "%d", &record )
    printf( "Enter the new Score:" );
    scanf( "%f", &nscore ); // this is a seek example so I will not complicate things.

    /*Seek the file ( record - 1 ), because the file starts in position 0 but the list starts in 1*/
    fseek( fPtr, ( record  - 1  ) * sizeof ( students_t ), SEEK_SET );

    /* Now you can read and copy the slot */
    fread( fPtr, "%d%s%s%f", &student.number, student.name, student.lastname, &student.score );

    /* Seek again cause the pointer moved. */
    fseek( fPtr, ( record  - 1  ) * sizeof ( students_t ), SEEK_SET );
    student.score = nscore;

    /*Overwrite his information, only the score will be altered. */
    fwrite( &student, sizeof( student_t ), 1, fPtr );
} 
```

这是它的工作原理（图片来自 Deitel-How to program in C 6th Edition）：

![Deitel-如何在 C 第 6 版中编程](../Images/311315eb2c93f0cbaa0ee1a94d518d95.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T02:42:02.470

您可能知道这一点，但`fseek()`只是移动了相关的位置指示器，并没有规定正在进行的输出函数是覆盖还是插入。

您可能正在使用`fwrite()`或其他一些普通的普通输出功能，*这些将覆盖*，给您“12345newdata”而不是插入的变体。

另一方面，您可以*推出自己的插入功能*（我认为没有库存`stdio.h`功能），然后调用它`fseek()`来获得您想要的插入。

这样的事情就足够了：

```
insert(const void *ptr, size_t len, FILE *fp) {
    char tmp[len];
    size_t tmplen;

    while (len) {
        // save before overwriting
        tmplen = fread(tmp, 1, sizeof(tmp), fp);
        fseek(fp, -tmplen, SEEK_CUR);

        // overwrite
        fwrite(ptr, len, 1, fp);

        // reloop to output saved data
        ptr = tmp;
        len = tmplen;
    }
} 
```

（错误处理为冗长`fread()`而`fwrite()`省略。）*

# javascript - clearRect 函数不清除画布

> ID：13435959
> 
> 赞同：46
> 
> 时间：2012-11-17T23:46:35.650
> 
> 标签：javascript, line, draw, onmousemove

我在 body`onmousemove`函数上使用这个脚本：

```
function lineDraw() {
    // Get the context and the canvas:
    var canvas = document.getElementById("myCanvas");
    var context = canvas.getContext("2d");
    // Clear the last canvas
    context.clearRect(0, 0, canvas.width, canvas.height);
    // Draw the line:
    context.moveTo(0, 0);
    context.lineTo(event.clientX, event.clientY);
    context.stroke();
} 
```

每次我移动鼠标并画一条新线时，它都应该清除画布，但它不能正常工作。我试图在不使用 jQuery、鼠标侦听器或类似的情况下解决它。

这是一个演示：[https ://jsfiddle.net/0y4wf31k/](https://jsfiddle.net/0y4wf31k/)

* * *

## 回答 #1

> 赞同：93
> 
> 时间：2013-04-16T11:12:02.990

您应该使用“ **beginPath()** ”。这就对了。

```
function lineDraw() {   
    var canvas=document.getElementById("myCanvas");
    var context=canvas.getContext("2d");
    context.clearRect(0, 0, context.width,context.height);
    context.beginPath();//ADD THIS LINE!<<<<<<<<<<<<<
    context.moveTo(0,0);
    context.lineTo(event.clientX,event.clientY);
    context.stroke();
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2019-02-22T16:00:09.000

请注意，ctx.clearRect()在 Google Chrome 上**无法正常工作。**我花了几个小时试图解决一个相关的问题，却发现在 Chrome 上，它不是用 rgba(0, 0, 0, 0) 填充矩形，而是**用**rgba(0, 0, 0, 1) 填充矩形反而！

因此，为了用所需的透明黑色像素*正确填充矩形，您需要在 Chrome 上执行此操作：*

```
ctx.fillStyle = "rgba(0, 0, 0, 0)";
ctx.fillRect(left, top, width, height); 
```

当然，这应该适用于为 HTML5 Canvas 对象提供适当支持的所有浏览器。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-12-22T01:33:19.497

还有我们需要用到的 beginPath() 和 stroke()。此代码与 clearRect(...) 相同

```
ctx.beginPath();
ctx.fillStyle = "rgba(0, 0, 0, 255)";
ctx.fillRect(0, 0, canvas.width, canvas.height);    
ctx.stroke(); 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-11-17T23:54:33.167

尝试`context.canvas.width = context.canvas.width`：

```
function lineDraw() {   
    var canvas=document.getElementById("myCanvas");
    var context=canvas.getContext("2d");
    //context.clearRect(0, 0, context.width,context.height);
    context.canvas.width = context.canvas.width;
    context.moveTo(0,0);
    context.lineTo(event.clientX,event.clientY);
    context.stroke();
} 
```

[在这里](http://jsfiddle.net/salih0vicX/7vx2z/3/)演示

# java - 如何在 Linux、Mac 和 Solaris 中使用 Java 获取我的主板 ID？

> ID：13435960
> 
> 赞同：2
> 
> 时间：2012-11-17T23:46:37.117
> 
> 标签：java, linux, macos, motherboard

如何在 Linux、Mac 和 Solaris 中使用 Java 获取我的主板 ID？我更喜欢跨平台的解决方案。

我找到了一种适用于 Windows 的方法：

```
String result = "";
    try {
    File file = File.createTempFile("realhowto",".vbs");
    file.deleteOnExit();
    FileWriter fw = new java.io.FileWriter(file);

    String vbs =
    "Set objWMIService = GetObject(\"winmgmts:\\\\.\\root\\cimv2\")\n"
    + "Set colItems = objWMIService.ExecQuery _ \n"
    + " (\"Select * from Win32_BaseBoard\") \n"
    + "For Each objItem in colItems \n"
    + " Wscript.Echo objItem.SerialNumber \n"
    + " exit for ' do the first cpu only! \n"
    + "Next \n";

    fw.write(vbs);
    fw.close();
    Process p = Runtime.getRuntime().exec("cscript //NoLogo " + file.getPath());
    BufferedReader input =
    new BufferedReader
    (new InputStreamReader(p.getInputStream()));
    String line;
    while ((line = input.readLine()) != null) {
    result += line;
    }
    input.close();
    }
    catch(Exception e){
    e.printStackTrace();
    }
    return result.trim(); 
```

这在 Windows 中完美运行，但我需要在 Mac、Linux 和 Solaris 中也能运行的东西。

# c# - C# 中的自定义值类型是什么，如何创建它们？

> ID：13435965
> 
> 赞同：4
> 
> 时间：2012-11-17T23:47:09.810
> 
> 标签：c#, types

C# 中的自定义值类型是什么？我怎样才能创建它们？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-17T23:48:40.493

要创建一个值类型，您需要将您的类型定义为 a `struct`（而不是 a `class`，它定义了一个引用类型）。例如：

```
struct MyValueType
{
    public string MyField;
} 
```

# javascript - 下面的代码有什么问题吗？(html/javascript/href)

> ID：13435972
> 
> 赞同：1
> 
> 时间：2012-11-17T23:47:44.650
> 
> 标签：javascript, html, forms, hyperlink, href

```
<html>
<title>My Web Page</title>

<form onsubmit="return redirect()">
<input id="search_form_input" type="text" name="query" />
<input type="submit" value="Search" />
</form>

<script type="text/javascript">
function redirect() {
var link = document.getElementById('link');
link.href += document.getElementById('search_form_input')
return false;
}
</script>

<body>
<p>
<a id="link" href="http://www.cnn.com/">CNN</a>
</p>
</body>
</html> 
```

基本上 id 就像来自表单的输入，以将自身扩展到 CNN.com 的 URL。例如，在表单中输入政治，提交，然后单击 CNN 链接会将其带到 CNN.com/politics。我会以正确的方式解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T00:06:30.097

你在做什么，你是怎么做的，这太疯狂了。寻求其他解决方案，但您的问题很简单。您将整个元素附加到`href`字符串。所以而不是

`link.href += document.getElementById('search_form_input')`

利用

`link.href += document.getElementById('search_form_input').value`

完整的结果是：

```
<html>
<title>My Web Page</title>

<form onsubmit="return redirect()">
<input id="search_form_input" type="text" name="query" />
<input type="submit" value="Search" />
</form>

<script type="text/javascript">
function redirect() {
var link = document.getElementById('link');
link.href += document.getElementById('search_form_input').value
return false;
}
</script>

<body>
<p>
<a id="link" href="http://www.cnn.com/">CNN</a>
</p>
</body>
</html>​ 
```

至少尝试一下jQuery。

# delphi - 如何知道在应用程序图标上拖放了多少文件？

> ID：13435974
> 
> 赞同：1
> 
> 时间：2012-11-17T23:47:59.340
> 
> 标签：delphi

放置在应用程序图标上的文件的名称可在 ParamStr(1) 中找到。

但是，如何知道是否不止一个？因为，如果还有更多，则应显示错误消息，例如：“您只能打开一张图片！” 或类似的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-17T23:55:47.047

Windows 只是像这样执行你的程序：

```
yourapp.exe "C:\file1.jpg" "C:\file2.jpg" 
```

所以这些文件中的每一个都可以在 中找到，返回值在`ParamStr(i)`哪里。`i``ParamCount()`

所以你可以做例如：

```
procedure TMainForm.FormShow(Sender: TObject);
begin
  if ParamCount > 1 then
  begin
    ShowMessage('You can open only one picture!');
  end
  else
  begin
    MyOpen(ParamStr(1));
  end;
end; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:54:16.007

举例回答，每个文件都是一个参数

```
var
 i:Integer;

begin

  Memo1.Lines.Add(IntToStr(ParamCount));
  for I := 1 to ParamCount  do
    memo1.Lines.Add(paramstr(i))

end; 
```

# php - 选择用户以前没有看过的帖子

> ID：13435975
> 
> 赞同：0
> 
> 时间：2012-11-17T23:47:59.747
> 
> 标签：php, mysql, yii

我正在寻找创建以下功能的最有效方法。用户将加载一个页面，这将为他们提供一个随机帖子（来自 user_post 表），但必须排除他们之前查看过的帖子。我的数据结构是（简化的）：

```
user_post
---------
id (PK)

user_post_view
--------------
id (PK)
user_id
user_post_id 
```

其中 user_post 是存储的帖子，而 user_post_view 是将用户与他们查看过的帖子相关联。因此，用英语查询将是：

**从 user_post 表中选择一个没有 user_post_view 记录的随机帖子**

我正在使用 Yii 框架，但即使是“普通”的 SQL 语句也会有所帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T23:56:17.167

```
SELECT * FROM user_post p where 
your_user_id NOT IN (SELECT user_id FROM user_post_view WHERE user_post_id = p.id) 
```

编辑：

EXISTS 实际上在这里可能更有意义......我添加了你的 LIMIT 1 以防你只想要 1 个帖子

```
SELECT * FROM user_post p where 
NOT EXISTS (SELECT user_id FROM user_post_view WHERE user_post_id = p.id AND 
user_id = your_user_id) LIMIT 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:51:24.480

```
SELECT p.* FROM user_post p LEFT JOIN user_post_view pv ON (pv.user_id = your_user_id_here AND pv.user_post_id = p.id) WHERE pv.user_id = NULL 
```

应该做的伎俩。它尝试与 user_post_view 表进行 LEFT JOIN。如果失败，连接右侧的所有字段都将为空。我正在利用这个优势。

为了提高效率，请确保您有一个索引 user_id、user_post_id 的索引。不必是主要的，只是某种加速请求的索引。

# php - 存储页面检查的值，导航到下一页，然后通过链接返回失败

> ID：13435980
> 
> 赞同：0
> 
> 时间：2012-11-17T23:48:21.153
> 
> 标签：php, mysql, mysqli

**编辑：**我现在解决了这个问题，但是如果有人能告诉我是否有其他方法或者为什么它之前不起作用，请告诉我！

我有一个页面正在接收上一页的 id，根据该 id，您可以查看一个人的课程表。我在课程表页面上添加了一个链接，以将它们带回课程注册页面，但每次没有 id 时我都会收到错误消息。我将 id 存储在隐藏字段中，但由于某种原因，它没有与链接一起传递。不确定为什么没有传递该值，因为它与其他页面的代码相同。谢谢你的帮助！

这是注册页面的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Course Listings</title>
<link rel="stylesheet" href="php_styles.css" type="text/css" />
<meta http-equiv="content-type"
content="text/html; charset=iso-8859-1" />
</head>
<body>
<h1>Aqua Don's Scuba School</h1>
<h2>Class Registration Form</h2>
<?php
$DBConnect = @mysqli_connect("localhost", "students", "password")
    Or die("<p>Unable to connect to the database server.</p>"
    . "<p>Error code " . mysqli_connect_errno()
    . ": " . mysqli_connect_error()) . "</p>";
$DBName = "scuba_school";
@mysqli_select_db($DBConnect, $DBName)
    Or die("<p>Unable to select the database.</p>"
    . "<p>Error code " . mysqli_errno($DBConnect)
    . ": " . mysqli_error($DBConnect)) . "</p>";
$DiverID = $_GET['diverID'];
if (empty($DiverID))
    exit("<p>You must enter a diver ID! Click your browser's Back button to return to the previous page.</p>");
$TableName = "divers";
$SQLstring = "SELECT * FROM $TableName WHERE diverID='$DiverID'";
$QueryResult = @mysqli_query($DBConnect, $SQLstring)
    Or die("<p>Unable to execute the query.</p>"
    . "<p>Error code " . mysqli_errno($DBConnect)
    . ": " . mysqli_error($DBConnect)) . "</p>";
if (mysqli_num_rows($QueryResult) == 0)
    die("<p>You must enter a valid diver ID! Click your browser's Back button to return to the Registration form.</p.");
mysqli_close($DBConnect);
?>
<form method="get" action="ReviewSchedule.php">
<p><strong>Student ID: <?= $DiverID ?></strong>
<input type="submit" value=" Review Current Schedule " /><input type="hidden" name="diverID" value="<?= $DiverID ?>" /></p>
</form>
<form method="get" action="RegisterDiver.php">
<p><strong>Select the class you would like to take:</strong><br />
<input type="radio" name="class" value="Beginning Open Water" checked="checked" />Beginning Open Water<br />
<input type="radio" name="class" value="Advanced Open Water" />Advanced Open Water<br />
<input type="radio" name="class" value="Rescue Diving" />Rescue Diving<br />
<input type="radio" name="class" value="Divemaster Certification" />Divemaster Certification<br />
<input type="radio" name="class" value="Instructor Certification" />Instructor Certification</p>
<p><strong>Available Days and Times:</strong><br />
<select name="days">
<option selected="selected" value="Mondays and Wednesdays">Mondays and Wednesdays</option>
<option value="Tuesdays and Thursdays">Tuesdays and
Thursdays</option>
<option value="Wednesdays and Fridays">Wednesdays and
Fridays</option>
</select>
<select name="time">
<option selected="selected" value="9 a.m. - 11 a.m.">9 a.m. - 11 a.m.</option>
<option value="1 p.m. - 3 p.m.">1 p.m. - 3 p.m.</option>
<option value="6 p.m. - 8 p.m.">6 p.m. - 8 p.m.</option>
</select><input type="hidden" name="diverID" value="<?= $DiverID ?>" /></p>
<p><input type="submit" value=" Register " action="RegisterDiver.php"/>
<input type="reset" /></p>
</form>
</body>
<footer>
<div align="center">
    <a href="Registration.html">Return to Registration</a>
    <br/>
    <a href="../Menu.html">Return to Menu</a>
</div>
</footer>
</html> 
```

这是审查计划页面的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Review Schedule</title>
<link rel="stylesheet" href="php_styles.css" type="text/css" />
<meta http-equiv="content-type"
content="text/html; charset=iso-8859-1" />
</head>
<body>
<h1>Aqua Don's Scuba School</h1>
<h2>This is your current schedule:</h2>
<?php
$DiverID = $_GET['diverID'];
if (empty($DiverID))
    exit("<p>You must enter a diver ID! Click your browser's Back button to return to the previous page.</p>");
$DBConnect = @mysqli_connect("localhost", "students","password")
    Or die("<p>Unable to connect to the database server.</p>"
    . "<p>Error code " . mysqli_connect_errno()
    . ": " . mysqli_connect_error()) . "</p>";
$DBName = "scuba_school";
@mysqli_select_db($DBConnect, $DBName)
    Or die("<p>Unable to select the database.</p>"
    . "<p>Error code " . mysqli_errno($DBConnect)
    . ": " . mysqli_error($DBConnect)) . "</p>";
$TableName = "registration";
$SQLstring = "SELECT * FROM $TableName WHERE diverID='$DiverID'";
$QueryResult = @mysqli_query($DBConnect, $SQLstring)
    Or die("<p>Unable to execute the query.</p>"
    . "<p>Error code " . mysqli_errno($DBConnect)
    . ": " . mysqli_error($DBConnect)) . "</p>";
if (mysqli_num_rows($QueryResult) == 0)
    die("<p>You have not registered for any classes! Click your browser's Back button to return to the previous page.</p>");
echo "<table width='100%' border='1'>";
echo "<tr><th>Class</th><th>Days</th>
<th>Time</th></tr>";
$Row = mysqli_fetch_assoc($QueryResult);
do {
    echo "<tr><td>{$Row['class']}</td>";
    echo "<td>{$Row['days']}</td>";
    echo "<td>{$Row['time']}</td></tr>";
    $Row = mysqli_fetch_assoc($QueryResult);
} while ($Row);

?>

<form method="get" action="CourseListings.php">
<input type="hidden" name="diverID" value="<?= $DiverID ?>" />
<center>
<h3><a href="CourseListings.php">Return to View Course Listings</a></h3>
<h3><a href="Registration.html">Go back to Registration</a></h3>
<h3><a href="../Menu.html">Return to Menu</a></h3>
</center>
</form>

<?php
mysqli_free_result($QueryResult);
mysqli_close($DBConnect);
?>

</body>
<footer>
<div align="center">
&copy; Copyright Ryan Strouse &copy;
</div>
</footer>
</html> 
```

我想到了！我需要：

```
<h3><a href="CourseListings.php?diverID=<?php echo $DiverID;?>">Return to View Course Listings</a></h3> 
```

而不是普通的链接。除非有人想出更好的东西？我觉得它应该接受一切

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T00:15:44.687

使用 POST 而不是 GET。

我个人的经验法则：POST 用于表单，GET 用于通过 URL 传递的变量。

# ruby-on-rails - Rails：澄清预编译的目的：资产

> ID：13435983
> 
> 赞同：1
> 
> 时间：2012-11-17T23:48:28.560
> 
> 标签：ruby-on-rails

我试图了解 precompiling:assets 到底是做什么的，因为我已经意识到，对于我的上一个项目，当我将我的应用程序推送到 heroku 时，我的 CSS 永远不会更新，除非我输入`bundle exec rake assets:precompile`，但这只是在接近尾声时才开始发生的，所以我相信我可能在配置文件中添加了一些东西。

我目前正在尝试理解缓存，这让我想到了 precompile:assets。precompile:assets 是否类似于通过将资产预加载到 Web 服务器来进行缓存，这样这些资产就不会直接从 Rails 堆栈中加载？这是出于性能目的，对吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T02:09:56.540

You can find everything you need to know in the [Asset Pipeline Rails Guide](http://guides.rubyonrails.org/asset_pipeline.html).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T02:43:45.397

缓存是一个相关但独立的主题。

编译资产的目的包括资产的合并和最小化，例如所有在 1 行和 1 个字母变量的 javascript，而不是在开发模式下使用的原始文件，并让您使用原始源代码在那里进行调试。

# javascript - 很难让微调器按我需要的方式工作

> ID：13435988
> 
> 赞同：0
> 
> 时间：2012-11-17T23:48:47.207
> 
> 标签：javascript, jquery

我已经在这个微调控件上工作了几天，虽然我没有太多运气让它按照我需要的方式工作。它最初是我在其他地方找到的代码，并根据我自己的需要重新调整用途——所以它只是有点超出我的想象。

HTML：

```
<ul class="picker">
    <li class="pickerItem"><span class="value">1st Item Test</span></li>
    <li class="pickerItem"><span class="value">2nd Item Test</span></li>
    <li class="pickerItem"><span class="value">3rd Item Test</span></li>
    <li class="pickerItem win"><span class="value">4th Item Test</span></li>
    <li class="pickerItem"><span class="value">5th Item Test</span></li>
    <li class="pickerItem"><span class="value">6th Item Test</span></li>
    <li class="pickerItem"><span class="value">7th Item Test</span></li>
    <li class="pickerItem"><span class="value">8th Item Test</span></li>
    <li class="pickerItem"><span class="value">9th Item Test</span></li>
    <li class="pickerItem"><span class="value">10th Item Test</span></li>
    <li class="pickerItem last"><span class="value">11th Item Test</span></li>
</ul>
<div class="clear"></div>
<p><a href="#" id="start">start</a></p>
<p>Position: <span id="position">0</span></p>
<p>Speed: <span id="speed">0</span></p>
<p>Deceleration: <span id="deceleration">0</span></p> 
```

Javascript：

```
var marqueeRunning = false;
var winElement;
var fullSpeed = 60;
var speed = fullSpeed;
var deceleration = 3;
var rotationTotal = 10;
var currentRotation = 0;

$(document).ready(function() {

winElement = $(".pickerItem.win");
$(".pickerItem").last().addClass("last");
$(".picker").each(function() {
    var i = 0;
    $(this).find(".pickerItem").each(function() {
        var $this = $(this);
        $this.css("top", i);
        i += $this.height();
    });
});

$('#start').click(function() {
    if (!marqueeRunning) {
        speed = fullSpeed;
        $("#speed").html(speed);
        //marqueeRunning = true;                
        var countScrolls = $('.picker .pickerItem').length;

        marqueeRunning = true;
        for (var i = 0; i < countScrolls; i++) {
            doScroll($('.picker .pickerItem:nth-child(' + i + ')'));
        }

        setTimeout
        (
            function()
            {
                marqueeRunning = false;
            }, 
            1000
        );
    }
});
});

function slowDown()
{
var currentTop = Math.floor(winElement.css("top").replace("px",""));
/* -- Bounce Effect
if (currentTop != 0)
{
    newSpeed = speed;
    if (Math.abs(currentTop) < Math.abs(speed *4)) newSpeed = Math.floor(Math.abs(speed) - deceleration);
    if (newSpeed === 0)
    {
        newSpeed = speed;
    }
    if (currentTop > 0)
    {
       speed = Math.floor(Math.abs(newSpeed));
    }
    else
    {
       speed = -Math.floor(Math.abs(newSpeed));
    }
    if (Math.abs(currentTop) < 3 && Math.abs(speed) === 3) speed = currentTop;
}
*/
$("#speed").html(speed);
if (currentTop === 0)
{
    speed = 0;
    $("#speed").html(speed + " (complete)");
}
}

function doScroll($ele) {
//alert($ele.css("top"));
var top = parseInt($ele.css("top"));
//console.log(' Outside - ' + top + ' < -' + 3*fullSpeed);

if (top < -(3 * fullSpeed)) { //bit arbitrary!
//console.log(' Inside - ' + top + ' < -' + 3*fullSpeed);
    var $lastEle = $ele.closest('.picker').find(".last");
    $lastEle.removeClass("last");
    $ele.addClass("last");
    var top = (parseInt($lastEle.css("top")) + $lastEle.height());
    $ele.css("top", top);
}
$ele.animate({
    top: (parseInt(top) - speed)
}, 100, 'linear', function() {
    $("#position").html(winElement.css("top"));
    if ($ele.get(0) === winElement.get(0) && marqueeRunning === false) setTimeout(slowDown, 10);
    if (marqueeRunning || (Math.floor(winElement.css("top").replace("px","")) !== 0 && speed !== 0)) doScroll($(this))
});
 } 
```

​ 你可以在这里查看当前版本：http: [//jsfiddle.net/STLCajun/FYWtb/](http://jsfiddle.net/STLCajun/FYWtb/)

我想要做的是让微调器旋转，然后在 5-6 次旋转后，减速到中间有“win”类的列表项。有人可以指出我正确的方向。另外，我不知道为什么，但是在第一组项目之后它会产生一个差距，我不知道如何摆脱它。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T02:05:39.403

我用 scrollTo 做了一个[简单的例子](http://jsbin.com/ahexoc/2/)，为了使无限循环，我在滚动窗口中复制了你的项目数量，并在完成滚动到最后一个获胜项目时：

HTML几乎和你的一样，

CSS：

```
p {
 padding: 0px;
 margin: 0px;
}
.pickerItem {
 height:60px;
 width:298px;
 color: #000;
 border: 1px solid #ccc;
 text-align: center;
 font-size: 1.2em;
 font-weight: bold;
 list-style: none;
 margin: 0px;
 padding: 0px;
}

.value {
  display: block;
  margin-top: 15px; 
  padding: 0px;
}

.picker {
  margin: 0px;
  height: 220px;
  width:300px;
  border: solid 1px black;
  position: relative;
  overflow: hidden;
  background-image: url(http://i.imgur.com/hMWRu.jpg);
  padding: 0px;
}
.clear {
  clear:both;
}
.win span{
 background:blue; 
} 
```

JS

```
$.easing.elasout = function(x, t, b, c, d) {
        var s=1.70158;var p=0;var a=c;
        if (t===0) return b;  if ((t/=d)==1) return b+c;  if (!p) p=d*0.3;
        if (a < Math.abs(c)) { a=c;  s=p/4; }
        else s = p/(2*Math.PI) * Math.asin (c/a);
        return a*Math.pow(2,-10*t) * Math.sin( (t*d-s)*(2*Math.PI)/p ) + c + b;
    };

$(function() {
  var picker=$('.picker');
  var added_items=picker.children('li').clone(true);
  picker.append(added_items);
  var last=picker.children().last();
  var first=picker.children().first();
  var stop=false;
  var win=$('.picker .win').last();
  var start=function() {
    $(this).unbind('click');
    stop=false;
  scroll();  
    setTimeout(function() {
     stop=true; 
    },1000);
  };
  var scroll=function()   {
    picker.scrollTo(last,500,{ onAfter: nextstep});
  };
  var nextstep=function() {
    if (stop) {
      picker.scrollTo(first);
      picker.scrollTo(win.prev(),2000,{easing: 'elasout'});
      $('#start').click(start);
      return;
    }
    picker.scrollTo(first);
    scroll();

  };
  $('#start').click(start);

}); 
```

初始脚本的最大问题是弄乱了全局范围，并且很难做简单的事情。

# graph - 在有向图中以特定成本查找所有路径

> ID：13435990
> 
> 赞同：3
> 
> 时间：2012-11-17T23:48:54.880
> 
> 标签：graph, graph-algorithm, path-finding, directed-graph, weighted

假设我们有有向加权图。我们的任务是找到成本小于或等于 =< N 的两个顶点（源和目标）之间的所有路径。我们只访问每个顶点一次。在以后的版本中，我想添加一个条件，即源可以是目标（我们只是做一个循环）。

我认为可以通过修改后的 Dijkstra 算法来完成，但我不知道如何实现这样的事情。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T01:04:33.623

您可以使用递归回溯来解决此问题。在以下情况下终止递归：

*   你到达目的地
*   你访问了一个已经访问过的节点
*   您的路径长度超过 N。

伪代码：

```
list curpath := {}
int dest, maxlen
def findPaths (curNode, dist):
    if curNode = dest:
        print curpath
        return
    if curNode is marked:
        return
    if dist > maxlen:
        return
    add curNode to curpath
    mark curNode
    for nextNode, edgeDist adjacent to curNode:
        findPaths(nextNode, dist + edgeDist)
    remove last element of curpath 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T01:15:25.077

您想在有向图中找到从 A 点到 B 点的**所有**路径，例如从 A 到 B 的距离小于 N，并允许 A = B 的可能性。

Dijkstra 的算法被定制为在图中找到从一个点到另一个点的最小路径，并在此过程中丢弃许多其他点，可以这么说。因此，如果我们包含重叠的路径，它不能用于查找**所有路径。**

您可以通过在图中进行广度优先搜索来实现您的目标，将覆盖树的每个分支保持在其堆栈中（如果节点连接得很好，您将获得大量分支），然后在深度 N 处停止。所有到达 B 的分支都被搁置一旁。一旦深度 N 被覆盖，你就放弃所有没有到达 B 的路径。剩下的路径，以及放在一边的路径放在一起成为你的解决方案。

您可以选择添加路径中没有循环的限制，在这种情况下，您将在搜索的每个步骤中检查新到达的节点是否已经在到目前为止所覆盖的路径中，如果它是路径，则修剪该路径案子。

这是一些伪代码：

```
function find_paths(graph G, node A):
list<path> L, L';

L := empty list;
push path(A) in L;
for i = 2 to N begin
   L' := empty list;
   for each path P in L begin
       if last node of P = B then push P in L'
       else
       for each successor S of last node in P begin
           if S not in P then
              path P' := P;
              push S in P';
              push P' in L';
           endif
       end
       endif
   end
   L := L';
end

for each path P in L begin
  if last node of P != B
  then remove P from L
  endif
end
return L; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-05T21:25:28.347

我认为对 jma127 建议的递归回溯算法的可能改进（取决于问题的大小和最大成本 N）是预先计算每个节点到目的地的最小距离（最短路径树），然后追加以下是测试终止递归的条件：

*   您到达一个节点，其与目的地的最小距离大于最大成本 N 减去到达当前节点所经过的距离。

如果需要针对不同的源和目的地多次运行该算法，则可以在开始时运行例如约翰逊算法，以创建所有节点对之间的最短路径矩阵。

# jquery - 语义问题。意外的标记 ：？

> ID：13435991
> 
> 赞同：1
> 
> 时间：2012-11-17T23:49:01.183
> 
> 标签：jquery, ajax

我正在尝试使用 jQuery 做一些 AJAX，但我似乎遇到了问题。

在我的 Safari 检查器中，我得到`Semantic Issue`和`Unexpected Token :`.

我只是愚蠢吗？它似乎发生在我`data:`的功能线上`$.ajax`：

```
function storeEmail ()
{
alert('Entered Function');

email = $('#emailField').val();
$('#emailField').hide();

console.log('Yep: '+email);

if(email.indexOf('@'))
{
    $.ajax(function(){
        url: "emailer/storeEmail.ajax.php",
        type: "POST",
        data: { "email" : email }
    }).done(function(data){
        if(data.resp == "success")
            $('#emailSuccess').show();
        else
        {
            $('#failedText').html('Error: '+data.resp);
            $('#emailFailed').show();
        }
    });
}
else
{
    $('#failedText').html('Error: Email is invalid!');
    $('#emailFailed').show();
}

return false;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T23:51:29.260

您似乎正在将一个函数传递给`$.ajax()`. 我认为你的意思是传递一个对象。取下`function()`这块，你应该很高兴。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T23:51:54.423

您没有将函数传递给 $.ajax，而是传递了一个映射（JavaScript 对象）

```
$.ajax({
    url: "emailer/storeEmail.ajax.php",
    type: "POST",
    data: { "email" : email }
}).done(function(data){
    if(data.resp == "success")
        $('#emailSuccess').show();
    else
    {
        $('#failedText').html('Error: '+data.resp);
        $('#emailFailed').show();
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T00:00:25.800

您收到错误的原因是以下代码：

```
function(){
    url: "emailer/storeEmail.ajax.php",
    type: "POST",
    data: { "email" : email }
} 
```

这是一个匿名函数，但内容不是代码，而是对象文字的内容。

当它被解释为代码时，它`url:`变成了一个标签，`"emailer/storeEmail.ajax.php"`变成了一个表达式。之后是`,`分隔两个表达式的运算符，因此它需要另一个表达式，而是来了`type:`。它被解释`type`为一个变量，`:`它后面的标记是unexpeted。

只需删除`function()`以使其成为对象文字：

```
{
    url: "emailer/storeEmail.ajax.php",
    type: "POST",
    data: { "email" : email }
} 
```

# java - 数据库新手，我该如何设计？MYSQL 和 Java

> ID：13435992
> 
> 赞同：0
> 
> 时间：2012-11-17T23:49:16.890
> 
> 标签：java, mysql, database, database-design, jdbc

我是数据库新手，在开始学习 mySQL 并在 Java 中使用驱动程序连接服务器端的数据库之前，我想先了解我的数据库设计。我在数据库中有两列，CRN NUMBER 和 DEVICE_TOKEN。CRN 号将是一个五位数的字符串，而 DEVICE_TOKEN 将是一个字符串设备令牌（用于推送通知的 iOS 设备令牌）。让我试着描述一下我正在尝试做的事情。我将让用户从 iOS 应用程序发送我的服务器数据，主要是他们用于推送通知的设备令牌和他们想要观看的 CRN（课程）。将会有许多设备令牌请求观看相同的 CRN 号码。我想知道将这些存储在数据库中的最有效方法。我将有一个线程查看数据库中的所有行，并为每个 CRN 轮询网站。如果我要查找的事件发生，我想通知与此 CRN 关联的每个设备令牌。最初，我希望一列是 CRN，另一列是 DEVICE_TOKENS。我知道这是不可能的，并且每一列应该只对应一个条目。有人可以帮我找出设计这个数据库的最佳方法，那将是最有效的吗？

```
CRN     DEVICE_TOKEN

12345   "string_of_correct_size"
12345   "another_device_token" 
```

与其向网站发出多个请求以获取相同的 CRN，不如每次迭代轮询每个唯一 CRN 一次的网站，然后将更改通知所有设备令牌，这样会更有效。我应该如何存储这些信息？谢谢你的时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-17T23:57:34.920

最常见的方法是使用设备令牌中的外键规范化课程。例如两个表：

```
Courses
id    CRN
1     12345

InterestedDevices
id    course    DEVICE_TOKEN
1     1        "string_of_correct_size"
2     1        "another_device_token" 
```

然后，您可以使用如下 SQL 找到感兴趣的设备：

```
SELECT *
FROM Courses
JOIN InterestedDevices ON Courses.id = InterestedDevices.course
WHERE Courses.CRN = ? 
```

这样您就可以避免一遍又一遍地复制课程信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T00:03:20.713

在这种类型的问题中，您具有一对多关系（一个 CRN 与多个 Device_Tokens），您希望有一个单独的表来存储 CRN，其中为每个新 CRN 分配一个唯一 ID。然后应该为您的 DEVICE_TOKENS 创建一个单独的表，该表具有唯一 ID、CRN 和 DEVICE_TOKEN 的列。

使用此模式，您可以遍历 CRN 表的行，轮询每个 CRN，然后只需与 DEVICE_TOKEN 表进行简单的 JOIN 即可在发生更改时查找所有订阅的设备。

# c++ - 公共头类构造函数

> ID：13435993
> 
> 赞同：3
> 
> 时间：2012-11-17T23:49:18.157
> 
> 标签：c++

我是构建用 C++ 编写的可分发库的新手，我有点迷路了。我创建了一个 .cpp 文件，其中包含我希望库为用户提供的所有功能的包装器，并且我编写了 2 个 .h 文件，一个是公共的，一个是私有的。下面是我的头文件的一个虚拟示例：

### 公共.h：

```
class myclass
{
public:
    public_function();
private:
} 
```

### 私人.h：

```
class myclass
{
public:
    public_function();
private:
    anotherClass instanceofClass;
} 
```

请注意，`public_function()`代码中的实现使用了“instanceofClass”。我已经能够毫无问题地使用私有类编译代码，并使用公共头文件和编译库编译库并将其与外部程序链接。但是，在执行该代码时，我遇到了分段错误，我怀疑这与缺少“instanceofClass”的正确初始化有关。

我在做正确的事吗？我是否被迫在实现中实例化“instanceofClass”`public_function()`以使其正确初始化，或者我应该做些什么？

非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T00:00:42.230

您不能以两种不同的方式声明同一个类“myclass”。必须有一个单一的类定义。如果你想隐藏实现的 API，你想使用“Pimpl”成语。所以你的公共类有一个指向私有类的指针。例如：

公共.h

```
class myclass_private;
class myclass {
    private:
        myclass_private* pimpl; 
    public:
        myclass();
        void public_function();
}; 
```

公共.cpp

```
myclass::myclass() {
    pimpl = new myclass_private;
}

void myclass::public_function() {
     pimpl->private_function();
} 
```

私人的.h

```
class myclass_private {
    public:
        void private_function(); 
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T00:10:25.480

您的类缺少适当的构造函数，这意味着编译器将根据类定义的内容提供一个默认构造函数。如果该定义在所有代码中不一致，则不会在所有地方都以相同的方式初始化，并且可能会丢失一些数据。

如果您想隐藏 的实现细节`instanceofClass`，只需在标头中进行前向声明（您提供的私有标头是正确的，您可以将其用作公共标头），并在代码中的某处提供实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T00:00:00.490

public.h中`myclass`定义的没有成员，因此大小为 1 字节。`myclass`private.h 中定义的封装了，`anotherClass`因此无论大小如何`anotherClass`。这种不一致是您问题的根源。

你应该做的是只有一个头文件，并使用一个指针（不需要类定义）来隐藏`anotherClass`. 我将重复 Joachim[与 pimpl 成语](http://c2.com/cgi/wiki?PimplIdiom)的链接以进行详细说明。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-18T00:03:50.853

类的定义在不同的翻译单元之间不能改变。这是单一定义规则的方面之一。您可能希望将公开可见的类定义为具有指向私有实现的指针：Pimpl Idiom：

```
class Public {
public:
    ...
private:
     struct Impl;
     Impl* impl_;
}; 
```

`struct Impl`只会在实现文件中定义。

# sql - 取排他锁的正确方法

> ID：13435997
> 
> 赞同：6
> 
> 时间：2012-11-17T23:50:06.310
> 
> 标签：sql, sql-server, sql-server-2008-r2, locking

我正在编写一个程序来协调实时数据库上的最终交易。我正在做的工作不能作为一个集合操作来完成，所以我使用了两个嵌套游标。

在为每个客户端进行协调时，我需要在事务表上使用排他锁，但我想释放锁并让其他人在我处理的每个客户端之间运行他们的查询。

我很想在行级别而不是表级别上做一个排他锁，但是[到目前为止我所读到](https://stackoverflow.com/a/4609384/80274)`with (XLOCK, ROWLOCK, HOLDLOCK)`的内容表明，如果其他事务在`READCOMMITED`隔离级别上运行（这对我来说），我就不能这样做。

我是否正确使用了表级独占锁，Server 2008 R2 中是否有任何方法可以让行级独占锁按照我想要的方式工作，而无需修改数据库上运行的其他查询？

```
declare client_cursor cursor local forward_only for 
     select distinct CLIENT_GUID from trnHistory
open client_cursor

declare @ClientGuid uniqueidentifier
declare @TransGuid uniqueidentifier

fetch next from client_cursor into @ClientGuid
WHILE (@@FETCH_STATUS <> -1)
BEGIN
    IF (@@FETCH_STATUS <> -2)
    BEGIN
        begin tran

        declare @temp int

        --The following row will not work if the other connections are running READCOMMITED isolation level
        --select @temp = 1 
    --from trnHistory with (XLOCK, ROWLOCK, HOLDLOCK) 
    --left join trnCB with (XLOCK, ROWLOCK, HOLDLOCK) on trnHistory.TRANS_GUID = trnCB.TRANS_GUID
    --left join trnClients with (XLOCK, ROWLOCK, HOLDLOCK) on trnHistory.TRANS_GUID = trnClients.TRANS_GUID
    --(Snip) --Other tables that will be "touched" during the reconcile
    --where trnHistory.CLIENT_GUID = @ClientGuid

        --Works allways but locks whole table.
    select top 1 @temp = 1 from trnHistory with (XLOCK, TABLOCK) 
    select top 1 @temp = 1 from trnCB with (XLOCK, TABLOCK)
    select top 1 @temp = 1 from trnClients with (XLOCK, TABLOCK)
    --(Snip) --Other tables that will be "touched" during the reconcile

        declare trans_cursor cursor local forward_only for 
                select TRANS_GUID from trnHistory where CLIENT_GUID = @ClientGuid order by TRANS_NUMBER
        open trans_cursor

        fetch next from trans_cursor into @TransGuid
        WHILE (@@FETCH_STATUS <> -1)
        BEGIN
            IF (@@FETCH_STATUS <> -2)
            BEGIN

                --Do Work here

            END
            fetch next from trans_cursor into @TransGuid
        END

        close trans_cursor
        deallocate trans_cursor

            --commit the transaction and release the lock, this allows other 
            -- connections to get a few queries in while it is safe to read.
        commit tran
    END

    fetch next from client_cursor into @ClientGuid
END 

close client_cursor
deallocate client_cursor 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-18T00:55:19.927

我不敢相信 an`XLOCK`不会阻止并发阅读器，`read committed`所以我只是复制了它：这是真的。脚本：

第 1 节：

```
SET TRANSACTION ISOLATION LEVEL READ COMMITTED
BEGIN TRAN

SELECT * FROM T WITH (ROWLOCK, XLOCK, HOLDLOCK /*PAGLOCK, TABLOCKX*/) WHERE ID = 123 
```

第 2 节：

```
SET TRANSACTION ISOLATION LEVEL READ COMMITTED
BEGIN TRAN

SELECT * FROM T WHERE ID = 123 
```

插入您手头的一些表名。会话 2 未被阻止。

我也尝试过使用 a `PAGLOCK`，但这也没有用。接下来我尝试了一个`TABLOCKX`，但也没有用！

所以你的基于表锁的策略不起作用。我认为你必须修改读者，以便他们要么

1.  使用快照隔离来获得一致的视图（在任何写入之前）
2.  使用更高的隔离级别被作者阻止

当然有一个讨厌的解决方法来真正地锁定表：改变它的模式。这将采用`Sch-M`与基本上对表的任何访问相冲突的锁。它甚至包含一些元数据读取操作。它可能看起来像这样：

```
--just change *any* setting in an idempotent way
ALTER TABLE T SET (LOCK_ESCALATION = AUTO) 
```

我对此进行了测试。

* * *

SQL Server 是否正确不遵守`XLOCK`？或者这是产品的缺陷？我认为这是正确的，因为它符合`READ COMMITTED`. 此外，即使`SERIALIZABLE`在某些情况下，一个事务可以独占锁定一行，而另一个事务可以读取同一行！这可能在存在索引的情况下发生。一个事务可能会在非聚集索引上进行 X 锁定，`IX_T_SomeCol`而另一个事务可能会愉快地读取聚集索引`PK_T`。

因此，即使存在排他锁定，事务也可以独立执行实际上是很正常的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-18T12:15:20.010

如果你只是担心其他读者，那么你不应该需要排他锁，模式

```
Begin Transaction

  Make Data Inconsistent

  Make Data Consistent

Commit Transaction 
```

应该没事。唯一会看到不一致数据的会话是那些使用`nolock`or的会话`Read Uncommitted`，或者那些期望在不使用`Repeatable Rows`or的情况下进行多次一致读取的会话`Serializable`。

在回答这个问题时，在我看来，获取排他锁的正确方法是安排事情，以便引擎为你做这件事。

# ruby-on-rails - ActiveRecord：通过循环集合重新分配子代失败

> ID：13435998
> 
> 赞同：0
> 
> 时间：2012-11-17T23:50:28.170
> 
> 标签：ruby-on-rails, activerecord

所以我正在做一个家庭作业（edx.org 上的 SaaS 第 2 部分课程）。本质上，我们有两篇博客文章，每篇文章都有相关的评论。所以目标是通过创建第三篇文章将两篇文章合并为一篇。这也意味着，将前两篇文章的评论转移到第三篇文章中。

在我的代码中，我的第一种方法是.. 假设方法签名是`def merge_with(other_article_id)`，并且`self`指的是第一篇文章，`other_article`指的是第二篇文章，并且`new_article`是指新创建的第三篇文章（注意，`new_article`已经使用分配的主键保存）

```
self.comments do |comment|
  new_article.comments << comment
end
other_article.comments do |comment|
  new_article.comments << comment
end     
new_article.save
debugger 
```

在调试器下，如果我这样做`e new_article.comments`，它会返回空`[]`，但**我很困惑为什么会这样**。

目前的解决方法是

`new_article.comments = self.comments + other_article.comments`

，这让我可以完成我的作业，但是，对于为什么集合循环方法不起作用，它仍然困扰着我。

最后一个问题是..在将孩子重新分配给另一位父母（在本例中将评论从一篇文章重新分配给另一篇文章）**时，是否有任何推荐的方法？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T06:36:25.803

为了解决这个问题，我很想在循环内部进行调试，以查看注释的值是什么，并确保它实际上被调用了。不应该是：self.comments.each 做 |comment| ...？也许您错过了对“每个”的呼叫

# c# - 在 C# 中存储除字典以外的对象对的数据类型

> ID：13435999
> 
> 赞同：3
> 
> 时间：2012-11-17T23:50:32.050
> 
> 标签：c#, c#-5.0

存储非唯一对象对的最佳数据类型是什么？我不能使用字典，因为键必须是唯一的。我可以创建一个将这两种数据类型作为属性的对象并将它们存储在一个列表中，但这不够灵活，无法容纳不同的数据类型对。几乎像字典但非唯一的东西。.NET 的内置解决方案会更好。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-17T23:52:45.880

我认为 a`List<Tuple<T1,T2>>`在这里效果最好。

*   [`List<T>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)
*   [`Tuple<T1,T2>`](http://msdn.microsoft.com/en-us/library/dd268536.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-17T23:54:16.773

你可以使用`List<KeyValuePair<T1,T2>>`. `Dictionary`类`KeyValuePair`也用。