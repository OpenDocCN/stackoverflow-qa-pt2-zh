# StackOverflow 问答 16058000-16058999

# spring - 拦截网址不起作用

> ID：16058001
> 
> 赞同：0
> 
> 时间：2013-04-17T10:46:26.950
> 
> 标签：spring, security

我已经使用 Maven 成功配置了 Spring Secure，但是我的过滤器不起作用。Spring 允许所有人进入。我想禁用用户配置文件子页面。当用户未签名时，过滤器不会重定向到登录页面。

```
<beans:beans xmlns="http://www.springframework.org/schema/security"
xmlns:beans="http://www.springframework.org/schema/beans" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security-3.0.3.xsd">

<http auto-config="true" use-expressions="true">
    <intercept-url pattern="/user-profile/**" access="hasRole('ROLE_USER')" />
</http>

<beans:bean id="userDetailsService" class="com.walladverts.auth.HibernateUserDetailsService">
</beans:bean>

<beans:bean id="daoAuthenticationProvider"
    class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
    <beans:property name="userDetailsService" ref="userDetailsService" />
</beans:bean>

<beans:bean id="authenticationManager"
    class="org.springframework.security.authentication.ProviderManager">
    <beans:property name="providers">
        <beans:list>
            <beans:ref local="daoAuthenticationProvider" />
        </beans:list>
    </beans:property>
</beans:bean>

<authentication-manager>
  <authentication-provider user-service-ref="userDetailsService">
    <password-encoder hash="sha"/>
  </authentication-provider>
</authentication-manager> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T10:51:24.847

用这种方式

```
<security:http auto-config="true" use-expressions="true">
    <security:intercept-url pattern="/user-profile/**" access="hasRole('ROLE_USER')" />
</security:http>

<security:authentication-manager>
  <security:authentication-provider user-service-ref="userDetailsService">
    <security:password-encoder hash="sha"/>
  </security:authentication-provider>
</security:authentication-manager> 
```

将以下内容添加到您的`web.xml`

```
<!-- Enables Spring Security -->
    <filter>
        <filter-name>springSecurityFilterChain</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>lazyLoadingFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter-mapping>
      <filter-name>springSecurityFilterChain</filter-name>
      <url-pattern>/*</url-pattern>
    </filter-mapping> 
```

# sql - SQL Server 2008R2 - 从多个表插入

> ID：16058004
> 
> 赞同：2
> 
> 时间：2013-04-17T10:46:44.193
> 
> 标签：sql, select, join, sql-server-2008-r2, sql-insert

我的存储过程有一个问题（实际上是两个问题），我可能在这里犯了一个新手错误，但我试图修复它并惨遭失败。输入堆栈溢出大师来拯救我：D

我希望能够使用存储过程（下面的工作原理）将新约会插入到我的约会表中。问题是我试图通过输入他们的名字来获取造型师和客户 ID（显然这些是在单独的表中，你可以看到我试图在代码片段中获取 ID 的位置...... ) 无论如何，我没有任何错误，但它实际上并没有做任何事情，因为当存储过程被测试时，没有任何东西被插入到约会表中（它执行得很好）。我不知道为什么会这样，我不知道从哪里开始寻找。

还有另一个可能相关的问题，那就是 c.fullName 和 s.fullName 经常用红线下划线，表示找不到它们。这两个列都存在于客户表和造型师表中；它们都是计算列（名字+姓氏）并且在其他查询中工作得很好，所以我不明白为什么它们在这里不起作用。

```
@AppDate date = null,
@AppTime time(5) = null,
@Details varchar(255) = null,
@ClientName varchar(50) = null,
@StylistName varchar(50) = null,
@ClientID int = null,
@StylistID int = null

INSERT into appointment(appDate, appTime, details, clientID, stylistID)
SELECT
    @AppDate AS appDate, 
    @AppTime AS appTime, 
    @Details AS details,
    @ClientID, 
    @StylistID
FROM appointment a
JOIN client c 
ON c.clientID = a.clientID
JOIN stylist s
ON s.stylistID = a.stylistID
WHERE c.fullName = @ClientName
AND s.fullName = @StylistName 
```

任何想法或提示将不胜感激:)

编辑：我刚刚注意到，当我注销并重新登录时，它删除了 fullName 列的问题 - 我之前确实尝试过，但它没有用，但显然现在它似乎不是问题......存储过程仍然没有插入任何东西:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:14:54.487

错误＃1：

您甚至没有尝试从表中插入 ClientID 和 StylistID，而是插入回输入参数 @ClientID 和 @StylistID。您的整个选择不是从表格中选择任何内容。

但是，这不会导致行不被插入，因为如果它们由 select 返回，它们将被插入 NULL 值。

错误＃2：

您的查询实际上是在搜索具有相同客户和造型师的现有约会。我猜那些不存在，这就是为什么没有插入行。如果它们确实存在，您将使用此插入复制它们。

使固定：

在 INSERT 语句之前搜索 ClientID 和 StylistID。从输入参数中删除@ClientID 和@StylistID 并在过程主体中声明它们。

```
DECLARE @ClientID int;
DECLARE @StylistID int;

SELECT @ClientID = ClientID FROM client WHERE fullName = @ClientName
SELECT @StylistID = StylistID FROM stylist WHERE fullName = @StylistName

INSERT into appointment(appDate, appTime, details, clientID, stylistID)
SELECT
    @AppDate AS appDate, 
    @AppTime AS appTime, 
    @Details AS details,
    @ClientID, 
    @StylistID 
```

PS: CTRL-SHIFT-R 刷新 Intelli-sense 当某些东西带有红色下划线并且它不应该是

# javascript - 在指令中获取子属性

> ID：16058005
> 
> 赞同：1
> 
> 时间：2013-04-17T10:46:49.390
> 
> 标签：javascript, angularjs, angularjs-directive

给定

```
<mytag class="red">
     <mysubtag id="3"></mysubtag>
</mysubtag> 
```

子标签可能具有不同的含义，具体取决于父标签（可能是 mytag 或 mysupercustomtag）。我有所有父标签的指令。如何访问子标签？

我知道在 mytag 指令的链接函数中我可以使用`children()`, `contents()`, and `data()`, 甚至`elm.find('#someid')`. 像下面这样的东西可以解决问题吗？这样做的正确方法是什么？嵌套指令？

```
.directive('mytag', function() {
  return {
    restrict: 'A',
    template: '<div></div>',
    replace: true,
    link: function (scope, element, attrs) {
        // get the id of the first child (for example mysubtag)
        var newid = element.children()[0].getAttribute('id');
        // and put it in mytag, so that it is transformed into <div class="red" id="3">..
        attrs.$set('id', newid);
    }
  } 
}) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T11:23:23.990

这种做法是不正确的。对于嵌套指令，您必须在父指令中声明控制器并在子指令中使用 require 属性来访问父控制器。请参见下面的子父指令角度文档中的示例。下面的链接将帮助您设置一个

[http://angularjs.org/#create-components](http://angularjs.org/#create-components)

# python - 在持续集成解决方案中使用 python tox 而不以 root 身份安装 tox？

> ID：16058007
> 
> 赞同：0
> 
> 时间：2013-04-17T10:46:55.507
> 
> 标签：python, tox

我确实喜欢独立的解决方案，并且能够运行单元测试而无需在机器上安装任何东西。

这将允许我在几台机器上测试 python 包，而无需为此做准备。

是否有可能（如何？）使用 tox 运行 python unittests 而无需将其安装到机器上（因此 root 访问）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:10:46.410

您也许可以为此使用 virtualenv，特别是如果您拥有相对较新的 Python 版本。

这将允许您使用所需的任何包创建沙盒环境，跨环境共享它，并运行您需要运行的内容。

另一种方法（有点“复杂”）是使用像 Vagrant 这样的 VM 解决方案来设置一个几乎可以在任何地方运行的沙盒环境。它确实需要安装和配置，但它是一次性的，然后可用于设置您需要的任何环境，而不会弄乱每台机器的实际系统库。

这些只是我会考虑的一般方法，您会更好地了解适用于您的案例的方法，因为您了解您正在使用的实际限制和架构。

我认为 virtualenv 设置可能真的是要走的路，你可以让它依赖于系统包作为基础，然后安装`tox`在沙箱之上：

[http://www.virtualenv.org/en/latest/#the-system-site-packages-option](http://www.virtualenv.org/en/latest/#the-system-site-packages-option)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T19:11:57.097

您可以尝试下载并使用[toxbootstrap.py](https://bitbucket.org/hpk42/tox/src/1b8bdf9ab87e87203df8543b8e5a85bc30433f52/toxbootstrap.py?at=default)，它是一个自动安装的 tox 脚本。它从您的 tox.ini 下载并创建所有必要的内容。

# jquery - 有没有一种已知的方法来使用密码类型的文本区域？

> ID：16058008
> 
> 赞同：5
> 
> 时间：2013-04-17T10:46:56.390
> 
> 标签：jquery, html, dom, fonts

所以我目前正在尝试获取密码类型的文本区域（实际上就像一个输入）。

我尝试创建自己的字体（只有黑点），但这有点难......

我尝试了一些 Jquery，但这也不是很确定。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:11:32.693

这篇文章： [如何使 Textarea 像密码字段一样工作](https://stackoverflow.com/questions/12895774/how-to-make-a-textarea-act-like-a-password-field)

提到使用 keydown 事件将框中的内容替换为您想要的任何内容。当然，您需要同时将输入的文本存储在某个 javascript 变量中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2021-03-13T20:23:43.207

您可以改用 CSS 来模糊文本。

```
style="color: transparent;text-shadow: 0 0 8px rgba(0,0,0,0.5);" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T11:19:00.703

我希望你能从中得到想法

[http://jsfiddle.net/X37Wz/6/](http://jsfiddle.net/X37Wz/6/)

```
<textarea rows="10" cols="30" id="field"  onKeyPress="handleTyping(event)">
</textarea>

<textarea rows="10" cols="30" id="hiddenfield"  style="display:none">
</textarea>

function handleTyping(e){
    setTimeout(function(){handleTypingDelayed(e)},500);
}

function handleTypingDelayed(e){

    var text = document.getElementById('hiddenfield').value;
    var stars = document.getElementById('hiddenfield').value.length;
    unicode = eval(unicode);
    var unicode=e.keyCode? e.keyCode : e.charCode;

    if ( (unicode >=65 && unicode <=90) 
            || (unicode >=97 && unicode <=122) 
                || (unicode >=48 && unicode <=57) ){
        text = text+String.fromCharCode(unicode);    
        stars += 1;
    }else{
        stars -= 1;
    }

    document.getElementById('hiddenfield').value = text;
    document.getElementById('field').value = generateStars(stars);
}

function generateStars(n){
    var stars = '';
    for (var i=0; i<n;i++){
        stars += '.';
    }
    return stars;
} 
```

# python - 使用 Python，将一个 XML 块发布到 Web 服务器

> ID：16058014
> 
> 赞同：0
> 
> 时间：2013-04-17T10:47:07.253
> 
> 标签：python, python-3.x

我想将请求 url 和请求正文作为 xml 输入，并将输出作为响应 xml 代码。

是否有任何代码片段。

虽然我在 Java 中有一个代码：

```
import java.net.*;    // import java packages.  
import java.io.*;
import java.net.URL;

public class POST {
public static void main(String[] args) {
try{
       URL url = new URL("");  // Http request
       URLConnection con = url.openConnection();
       con.setDoInput(true);
       con.setDoOutput(true);
       con.setConnectTimeout( 20000 );
       con.setReadTimeout( 20000 );
       con.setUseCaches (false);
       con.setDefaultUseCaches (false);
       con.setRequestProperty ( "Content-Type", "application/xml" );
       OutputStreamWriter writer = new OutputStreamWriter( con.getOutputStream());
       writer.write("xml request body");  // xml request body
       writer.flush();
       writer.close();
       InputStreamReader reader = new InputStreamReader( con.getInputStream() );
       StringBuilder buf = new StringBuilder();
       char[] cbuf = new char[ 2048 ];
       int num;
       while ( -1 != (num=reader.read( cbuf )))
       {
              buf.append( cbuf, 0, num );
       }
       String result = buf.toString();
       System.err.println( "\nResponse from server after POST:\n" + result );
       }
catch( Throwable t )
{
       t.printStackTrace( System.out );
}
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:45:34.803

你可以这样做：

```
import urllib2
req = urllib2.Request(url='http://example.com/yourpath/yourscript.extension', 
                  data='xml request body', 
                  headers={'Content-Type': 'application/xml'})
response = urllib2.urlopen(req)
xml = response.read() 
```

对于 Python 3，您可以这样做：

```
import urllib.request
req = urllib.request.Request(url='http://example.com/yourpath/yourscript.extension',
                   data='xml request body')
req.add_header('Content-Type', 'application/xml')
response = urllib.request.urlopen(req)
xml = response.read()) 
```

# calendar - 剑道 ui 中的日历选择模式

> ID：16058017
> 
> 赞同：0
> 
> 时间：2013-04-17T10:47:11.773
> 
> 标签：calendar, kendo-ui, kendo-asp.net-mvc

嗨，剑道 ui 日历中有没有`selection mode = DayWeekMonth`类似 asp.net 的选项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T16:11:07.520

没有。在这一点上剑道压光机没有类似的东西。你只有这些

[http://docs.kendoui.c​​om/api/web/calendar#configuration](http://docs.kendoui.com/api/web/calendar#configuration)

# python - 在python中从文本文件中读取多个变量的聪明方法

> ID：16058020
> 
> 赞同：3
> 
> 时间：2013-04-17T10:47:21.940
> 
> 标签：python, numpy

我正在尝试加载存储在单个文本文件中的多个向量和矩阵（用于 numpy）。该文件如下所示：

```
%VectorA
1 2 3 4
%MatrixA
1 2 3
4 5 6
%VectorB
3 4 5 6 7 
```

理想的解决方案是有一个字典对象，如：

```
{'VectorB': [3, 4, 5, 6, 7], 'VectorA': [1, 2, 3, 4], 'MatrixA':[[1, 2, 3],[4, 5, 6]]} 
```

变量的顺序可以假定为固定的。因此，在文本文件中按出现顺序排列的 numpy 数组列表也可以。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T11:13:14.787

```
from StringIO import StringIO
mytext='''%VectorA
1 2 3 4
%MatrixA
1 2 3
4 5 6
%VectorB
3 4 5 6 7'''

myfile=StringIO(mytext)
mydict={}
for x in myfile.readlines():
    if x.startswith('%'):
        mydict.setdefault(x.strip('%').strip(),[])
        lastkey=x.strip('%').strip()
    else:
        mydict[lastkey].append([int(x1) for x1 in x.split(' ')]) 
```

以上给出`mydict`为：

```
{'MatrixA': [[1, 2, 3], [4, 5, 6]],
 'VectorA': [[1, 2, 3, 4]],
 'VectorB': [[3, 4, 5, 6, 7]]} 
```

# html - 将 IE 滤镜用于背景渐变

> ID：16058024
> 
> 赞同：0
> 
> 时间：2013-04-17T10:47:28.177
> 
> 标签：html, internet-explorer, css

我在我的 CSS 中使用这个属性来为 IE 创建一个渐变。

```
.icons,
#nav {
filter: progid:DXImageTransform.Microsoft.gradient(   startColorstr='#9e9ccf', endColorstr='#423f88', GradientType=0 ); /* IE6-9 */
} 
```

应用后，我可以看到预期的漂亮渐变。但是，我的图标不再应用边框半径，我的 #nav z-index 失败，我的子菜单无法按预期加载并根据 #nav 高度和宽度被剪裁。在所有 IE 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:01:59.513

IE 的旧专有`filter`样式与`border-radius`. 他们使用具有方角的 activeX 控件并覆盖您可能尝试使用的任何圆角。这是一个已知的错误，没有解决方法。

作为一个activeX 控件的另一个问题`filter`是它带有activeX 控件所具有的所有错误和怪癖。这包括搞乱分层和其他类似的有趣的东西。`filter`我的建议是不惜一切代价避免使用。

我会注意到，`border-radius`无论如何只能在 IE9 上工作，所以你的问题不适用于 IE8 或更早版本。

**解决方案：**我建议您尝试[CSS3Pie](http://css3pie.com/)。这是一个插入 IE6 - IE9 的 javascript 库，并为这些浏览器提供对标准 CSS3 渐变的更好支持。它使用 VML 图形来完成，因此不需要使用`filter`，因此没有`filter`渐变可​​能导致的错误。（它确实有一些自己的怪癖，但相比之下它们是次要的，很容易解决，并且在 CSS3Pie 网站上有很好的记录）。另一个好处是它允许您对所有浏览器（包括旧版 IE）使用标准 CSS 代码。大胜。

哦，它也`border-radius`适用于 IE6-8，这对您来说是一个额外的好处。（是的，它适用于渐变）

希望有帮助。

# c++ - 文件未正确读取 C++ ifstream

> ID：16058025
> 
> 赞同：0
> 
> 时间：2013-04-17T10:47:29.513
> 
> 标签：c++

我有一个使用 ifstream 读取文件的应用程序。我在每行的文件中有 1000 个数字。我的应用程序应该阅读所有这些行。

但是当我的行数少于 800 时，它显示计数为 0，为什么会这样。代码如下。

```
int tmp, count=0,ucount=0; 

ifstream fin("rnum.txt");
while(fin >> tmp)
{
    count++;
}
cout<<"showing count: "<<count<<endl;
ucount=count;
fin.open("rnum.txt");
int i=0;
cout<<"Before entering loop"<<count<<endl;
while(fin >> tmp){
    iArray[i++]=tmp;
} 
```

当我读取一个 1000 行的文件时，它也只读取 720 行。我不明白为什么它的阅读方式是这样的。

代码有什么问题吗。

我的要求是将行数 COUNT 带到 ucount 变量中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T10:53:36.383

计算文件中的行数使用`getline`函数。

```
#include<string>

std::string line;
while (std::getline(fin, line))
{
    ++count;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:02:05.827

您需要`fin.close()`在第二次打开文件之前关闭文件或保持文件打开，重置读取指针并清除 eof 标志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T10:57:54.000

这不会解决您的错误，因为我认为这与输入文件本身有关，但是读取文件一次至少会使其更快：

```
vector<int> iArray;
int tmp; 

ifstream fin("rnum.txt");
while (fin >> tmp)
{
    iArray.push_back(tmp);
}
cout << "showing count: " << iArray.size() << endl; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-19T16:53:28.740

如果输入不正确（如果遇到字符而不是数字），>> 操作将失败并`fin >> tmp`返回 false，从而过早地中断循环。

此外，您应该在重新打开文件之前关闭文件。而且我相信您需要/想要的功能仅仅是`fin.seekg(0)`.

除了您的代码可以简化为：

```
int temp;
ifstream fin("rnum.txt");
vector<int> iArray;
while(fin >> tmp)
{
    iArray.push_back(tmp);
}

std::cout << "showing count : " << iArray.size(); 
```

正如@trojanfoe 在[https://stackoverflow.com/a/16058205/6459731中所建议的那样](https://stackoverflow.com/a/16058205/6459731)

# ios - 无法识别的选择器发送到我自己的按钮类上的实例

> ID：16058032
> 
> 赞同：-1
> 
> 时间：2013-04-17T10:47:44.300
> 
> 标签：ios, objective-c

我对 Objective-C 和 iOS 很陌生。我有一个问题：

我正在动态创建按钮，我需要在按钮上存储一些数据以在`onClick`方法上使用它。我有一个用于存储我的数据的类，当尝试在按钮上存储该数据时问题就开始了。

这是要存储的数据类 .h：

```
 @interface MenuItem : NSObject
{
    NSString *name;
    NSString *action;
    NSString *xml;
}

@property (nonatomic, retain) NSString *name;
@property (nonatomic, retain) NSString *action;
@property (nonatomic, retain) NSString *xml;
@end 
```

这个类没有任何方法。

这是我的按钮类：

```
 @interface MyButton : UIButton
{
    MenuItem * buttonInf;
}

@property (nonatomic, retain) MenuItem * buttonInf;

@end 
```

将数据放入该字段时遇到问题：

```
MyButton * button = [MyButton buttonWithType:UIButtonTypeRoundedRect];
button.buttonInf = buttoninf; 
```

我试着做：

```
[button setButtonInf:buttoninf] 
```

并制作那个二传手，但结果相同，总是有：

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-   [UIRoundedRectButton setButtonInf:]: unrecognized selector sent to instance 
```

我真的不知道为什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T10:54:13.443

正如[文档](https://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIButton_Class/UIButton/UIButton.html#//apple_ref/occ/clm/UIButton/buttonWithType:)所说：

> **讨论**
> 
> 此方法是一个方便的构造函数，用于创建具有特定配置的按钮对象。如果您将 UIButton 子类化，*则此方法不会返回您的子类的实例。如果要创建特定子类的实例，则必须直接分配/初始化按钮。*

这意味着返回的对象`buttonWithType:`是`UIButton`(not `MyButton`) 类型，并且此类不声明该`buttonInf`属性。

您必须以不同的方式（`initWithFrame`例如使用）创建按钮，然后`QuartzCore`将按钮的外观配置为您想要的样子。

使用上面的代码，我得到了图像中显示的正确按钮

```
MyButton *button = [[MyButton alloc] initWithFrame:CGRectMake(100, 20, 73, 44)];
button.layer.borderColor = [UIColor lightGrayColor].CGColor;
button.layer.borderWidth = 1.0;
button.layer.cornerRadius = 10.0;
[button setTitle:@"Button" forState:UIControlStateNormal];
[button setTitleColor:[UIColor blueColor] forState:UIControlStateNormal]; 
```

![在此处输入图像描述](https://i.stack.imgur.com/0DTzf.png)

# eclipse - GGTS 3.1 (Eclipse) 搜索视图不工作

> ID：16058037
> 
> 赞同：2
> 
> 时间：2013-04-17T10:48:15.563
> 
> 标签：eclipse

使用 Ctrl+H 时未显示搜索视图。单击菜单 Search -> Search... 时它也没有出现

我正在使用 GGTS 3.1

其他热键工作没有问题。我还检查了首选项中的映射，仍然有绑定到 Ctrl + H 的搜索视图。

知道我的日食发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T13:52:48.840

更新：如果仍然存在任何进程（ggts、sts、javaw），请尝试关闭每个 ide 并终止进程。

* * *

其他搜索方法是否有效？（例如 CTRL+SHIFT+G）？

# javascript - Xpages中的JQuery Mobile，传递参数

> ID：16058039
> 
> 赞同：0
> 
> 时间：2013-04-17T10:48:18.680
> 
> 标签：javascript, jquery, jquery-mobile, xpages

我在我的一个 Xpages 应用程序中使用 JQuery Mobile Framework。

我制作了一个包含一些条目的 listView，并希望在单击其中一个条目时显示相应的文档。我有一个带有两个 JQM 页面的 XPage。

oyu 知道这在 XPages 中是如何实现的吗？我知道有一些 JQuery mobile 插件可以在页面之间添加参数功能，但我的主要问题是没有触发服务器端事件，因此我可以刷新页面并传递我的 documentID

这些是我以前尝试过的一些事情：

*   在我的条目周围包裹一个 div 并尝试触发服务器端事件 -> 无事件
*   使用 <'a> 标准元素（改变页面，但没有给出参数，例如通过 url
*   单击链接时尝试触发 XSP.partialRefreshGet 无效，因为必须停用 dojo 才能使 JQM 正常工作
*   试图填充一个隐藏的Input来传递参数，没用，我需要一个服务器端事件
*   单击条目以打开文档时尝试打开新的 XPage，但没有成功，要么他找不到 xpage，要么我收到无法找到 XSP 的错误。
*   还有一些我暂时不记得的事情

有没有人有在 XPages 中使用 JQM 框架的经验？我无法想象我没有办法让它工作。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T12:36:39.653

我能够解决这个问题，虽然它有点奇怪。我的同事不得不禁用 dojo，因为如果不关闭它，UI 就无法正确呈现。我已经在我的页面中再次激活了 dojo，并且链接现在完全可以正常工作，这意味着我可以使用我想要的参数打开另一个 XPage。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T05:15:30.463

根据[http://notesin9.com/index.php/2013/04/20/jquery-mobile-seems-incompatible-with-xpages-in-domino-9-0/?utm_source=feedburner&utm_medium=feed&utm_campaign=中的评论提要%3A+NotesIn9+%28Notes+In+9+-+Wordpress%29](http://notesin9.com/index.php/2013/04/20/jquery-mobile-seems-incompatible-with-xpages-in-domino-9-0/?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3A+NotesIn9+%28Notes+In+9+-+Wordpress%29)

> 在 jQuery Mobile 版本 1.3.1 中的第 16 行是问题所在。我不确定真正的问题是什么，但是如果您将第 13 行更改为 23
> 
> (function ( root, doc, factory ) { if ( typeof define === "function" && define.amd ) { // AMD。注册为匿名模块。define( [ "jquery" ], function ( $ ) { factory ( $, root, doc ); return $.mobile; }); } else { // 浏览器全局工厂( root.jQuery, root, doc ); }
> 
> 至
> 
> (function (root, doc, factory) {// 浏览器全局工厂(root.jQuery, root, doc); }
> 
> 每件事都会奏效

已经测试并且有效

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-21T06:08:23.953

> 我的同事不得不禁用 dojo，因为 UI 在不关闭的情况下无法正确呈现

是的，但我似乎只是 ND 9 和 dojo 1.8 的问题。用户嫌疑人刚刚开始写关于这个问题的博客:) [http://notesin9.com/index.php/2013/04/20/jquery-mobile-seems-incompatible-with-xpages-in-domino-9-0/](http://notesin9.com/index.php/2013/04/20/jquery-mobile-seems-incompatible-with-xpages-in-domino-9-0/)

到目前为止，它适用于 8.5.1 - 8.5.2。需要在 8.5.3 上进行测试，但认为它仅与 ND 9 / Dojo 1.8 相关

我已经尝试过使用不同的 JQM 命名空间（ data-bcc-role 而不是 data-role ），但问题仍然存在。所以恕我直言，它一定是不同的。甚至 jQuery 的 noConflict() 也无济于事。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T20:17:27.150

我为视图和文档使用了单独的 XPage。

```
<div data-role="page" id="main">
    <div data-role="header">
        <h1>Contacts</h1>
    </div>
    <div data-role="content">
        <ul data-role="listview" data-inset="true" data-filter="true">
        <xp:repeat id="contactRepeat" rows="30" value="#{contactsView}" var="dataRow" disableOutputTag="true">
            <li>
                <xp:link escape="true" id="link1">
                    <xp:this.value><![CDATA[#{javascript:return "m_ContactDetails.xsp?action=OpenDocument&documentId=" + dataRow.getDocument().getUniversalID();}]]></xp:this.value>
                    <xp:this.text><![CDATA[#{javascript:return dataRow.getColumnValue("Name");}]]></xp:this.text>
                </xp:link>
            </li>
        </xp:repeat>
    </ul>
</div> 
```

虽然我确信您可以将视图和表单放在同一个 XPage 上（这是我在扩展库中学会的方法），但我认为拥有单独的 XPage 效果很好，我知道它允许我传递参数.

在我的扩展库一中，它打开以关注 XPage 的文档部分并选择特定文档的链接是：

```
http://dominodev.mydomain.com/djn/Test.nsf/m_milestoneList.xsp#milestoneDetails&databaseName=DominoDev/MyDomain!!DJN\Test.nsf&documentId=5DDB32855213FC0485257B2D00730253&action=editDocument 
```

因此，我想如果您将数据视图中的链接设置为使用 #pageName 和 &documentId= 它可能会起作用.....

# sass - 带有 WP 和字体的 SASS 和 Compass

> ID：16058042
> 
> 赞同：0
> 
> 时间：2013-04-17T10:48:31.710
> 
> 标签：sass, font-face, compass-sass

我无法让字体在我的 sass 网站上工作。我是 sass 和 compass 的新手，除了字体，一切正常。

我生成了字体文件并将它们放在文件夹库/字体中

在 config.rb 文件中，我添加了以下几行：

```
css_dir = "/"
sass_dir = "library/sass"
images_dir = "library/img"
fonts_dir = "library/font"
javascripts_dir = "library/js" 
```

style.css 中生成的字体路径在开头有一个正斜杠。

```
src: url('///fonts/fontawesome-webfont-webfont.ttf') format('truetype'), url('///fonts/fontawesome-webfont-webfont.svg') format('svg'), url('///fonts/fontawesome-webfont-webfont.woff') format('woff'), url('///fonts/fontawesome-webfont-webfont.eot') format('embedded-opentype'); 
```

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:50:09.717

是的，scr: 中调用的字体名称不正确。然而，这并没有解决我的问题。

字体正在生成，并且`/`在字体文件夹的路径名之前有一个。所以我不得不在 config.rb 文件中添加这一行来修复它：

```
relative_assets = true 
```

我不确定这是否是让它全部工作的正确方法。所以下次的任何建议都会很棒。

谢谢大家的时间。

# c# - 如何跳过不可访问的文件夹？

> ID：16058044
> 
> 赞同：0
> 
> 时间：2013-04-17T10:48:50.357
> 
> 标签：c#, exception, permissions, tree, directory

这是我的递归函数：

```
private void createListFolder(string path)
{
    try
    {
        string[] directoryList = Directory.GetDirectories(path);
        if (directoryList.Length > 0)
        {
            foreach (string directory in directoryList)
            {
                if (Directory.EnumerateFiles(directory).Any())
                {
                    folderList.Add(directory);
                }

                createListFolder(directory);
            }
        }
    }
    catch (Exception err)
    {
        txtErrors.AppendText(err.Message + Environment.NewLine);
    }
} 
```

我从根路径开始调用，只读包含文件的文件夹并将路径添加到列表中。问题是，如果我捕捉到一个不可访问的文件夹，它就会停止。我只想忽略不可访问的文件夹（或者更好，得到一个例外，但仍在阅读其余的文件夹）。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T10:52:54.487

如果您在循环中创建第二个 try/catch（嵌套的 try/catch 语句），则会在此处捕获错误，然后循环将继续。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:09:27.373

像下面这样尝试它会帮助你...

```
try
{
 createListFolder(directory);
}
catch (Exception err)
{
 txtErrors.AppendText(err.Message + Environment.NewLine);
} 
```

# html - 哪种 HTML 是最好的长文本格式？

> ID：16058047
> 
> 赞同：0
> 
> 时间：2013-04-17T10:49:08.380
> 
> 标签：html

写太长文本的主要两种格式是：

```
 <p>
    test test test test test test test test test test test test 
test test test test test test test test test test test test test 
test test test test test test test test test test test </p>

    <p>
    test test test test test test test test test test test test 
test test test test test test test test test test test test test 
test test test test test test test test test test test </p> 
```

和

```
 <p>
        test test test test test test test test test test 
    test test test test test test test test test test test 
    test test test test test test test test test test test test test 
test test <br /> <br />

test test test test test test test test test test 
test test test test test test test test test test test 
test test test test test test test test test test test test test test test 
</p> 
```

哪一个最适合搜索引擎、结构……等？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T10:56:07.547

完全没有区别。

大多数搜索引擎只为代表整体内容的某些标签中的文本赋予更多价值。例如，H1 标签内的内容可能表明页面中的内容是关于什么的。

用或新段落分隔长文本`<br />`不会影响搜索引擎结果。

我将补充一点`<p>`，在程序员的眼中，使用标签来分隔段落更有意义。

# c# - 在 WCF 服务中添加汇编指令

> ID：16058051
> 
> 赞同：0
> 
> 时间：2013-04-17T10:49:18.313
> 
> 标签：c#, wcf, quartz.net

我是使用 Quartz.net 的新手，我的问题如下：我创建了一个 WCF 服务器，其中包括一个接口，其中包含调度程序可以执行的操作，以及一个实现接口的类，其中分配了实例化调度程序和方法的构造函数。

在其他地方，在同一个项目中，我可以创建一个包含简单作业定义的库：

```
public class MyJob : IJob
{
    public virtual void Execute(IJobExecutionContext context)
    {
       // Body of the job
    } 
```

当我与客户端连接时，一切正常，但我需要以不同的方式包含作业，包括`.dll`在石英服务文件夹中的动态。但我不知道怎么做。

我一直在寻找解决方案，并且找到了与`System.Reflection`; 但我不知道我必须在哪里放置一个可能的代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T14:49:11.507

我有这样的典型 ScheduleJob 方法

```
 public void ScheduleJob(string jobName, string groupName, string triggerName, string cron, bool a)
    {            
        // Load the assembly
        AssemblyName assembly = AssemblyName.GetAssemblyName(@"C:\Program Files\Quartz.net\Jobs2.dll");
        System.Reflection.Assembly obj = System.Reflection.Assembly.Load(assembly);
        Type type = obj.GetType("MyJob2");

        if (!(type is IJob))
        {
            // Nothing, because the Job only have one method from IJob
        }

        // Contructor
        ConstructorInfo ctor = type.GetConstructor(new Type[] { });

        object loadedObject = ctor.Invoke(new object[] { obj });
        IJob importedObject = (IJob)loadedObject;                       

        JobKey jobKey = new JobKey(jobName, groupName);
        IJobDetail jobDetail = JobBuilder.Create(importedObject.GetType())
            .WithIdentity(jobName, groupName)
            .Build();
        TriggerKey tkey = new TriggerKey(triggerName, groupName);
        ITrigger cronTrigger = TriggerBuilder.Create()
            .WithIdentity(tkey)
            .ForJob(jobDetail)
            .WithCronSchedule(cron)
            .Build();
        AddJob(jobName, groupName, a);
        GetScheduler().ScheduleJob(cronTrigger); 
```

但是，当我使用我的客户端执行此方法时，我收到以下异常：

- 你调用的对象是空的 -

非常感谢您之前的回答！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:48:02.307

看来您需要从 .dll 文件动态加载程序集，这可以通过反射来完成。

```
var assembly = Assembly.LoadFile(@"yourDllFilesPath.dll"); // this loads the assembly 
```

现在，你可以得到这个程序集类

```
var type = assembly.GetType("Foo");  // a class Foo 
```

现在你有了类型，你还需要创建这种类型的实例，这可以使用`Activator`

```
object obj=Activator.CreateInstance(type); 
```

# php - PHP正则表达式函数冲突

> ID：16058053
> 
> 赞同：0
> 
> 时间：2013-04-17T10:49:28.970
> 
> 标签：php, preg-match

我使用过 `php 4`function`spliti()`和`php 5`function `preg_match`。它在我的本地主机（xampp 版本 1.7.2）中显示输出。但是当我将它上传到我的服务器时，它在 preg_match 上什么也没有显示并返回 false。我不知道为什么。有人可以帮我吗？

我的功能是获取 html 页面的 doctype 和 char-set。功能如下：

```
function GetContentType($Data) { // data as the html code
     print preg_match('@<meta\s+http-equiv="Content-Type"\s+content="([\w/]+)(;\s+charset=([^\s"]+))?@i', $Data, $matches);
    print var_dump($matches);
    if (isset($matches[3]))
        return $matches[3];
    else
        return "No Character set detected.";
}

function GetDocType($Data) { // Data as the html codes
    print preg_match('/<!DOCTYPE (\w.*)dtd">/is', $Data, $patterns);
    print var_dump($patterns);
    $Data = explode(" ", str_replace('"', "", $patterns[1]));
    $Data = $Data[0] . " " . $Data[3] . " " . $Data[4] . " " . $Data[5];
    return str_replace("//EN", "", $Data);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T10:52:17.687

来自 PHP 文档：

```
preg_match() 5.3.6 Returns FALSE if offset is higher than subject length. 
```

我认为这将是这里的问题......

# selenium - I had a error msg while run the build.xml in eclipse

> ID：16058054
> 
> 赞同：0
> 
> 时间：2013-04-17T10:49:34.690
> 
> 标签：selenium

```
D:\MY FILES\My project\MakeMyTrip>ant compile` 
```

**Buildfile:** `D:\MY FILES\My project\MakeMyTrip\build.xml`

```
setClasspath:

init:

clean:
   [delete] Deleting directory D:\MY FILES\My project\MakeMyTrip\build

compile:
     [echo] making directory...
    [mkdir] Created dir: D:\MY FILES\My project\MakeMyTrip\build
     [echo] Classpath===: D:\MY FILES\Selenium\Jar files\junit-4.10.jar;D:\MY FI
     LES\Selenium\Jar files\jxl.jar;D:\MY FILES\Selenium\Jar files\reportng-1.1.2.jar
    ;D:\MY FILES\Selenium\Jar files\testng-6.0.1.jar
     [echo] compiling...
    [javac] D:\MY FILES\My project\MakeMyTrip\build.xml:43: warning: 'includeant
    runtime' was not set, defaulting to build.sysclasspath=last; set to false for re
    peatable builds
    [javac] Compiling 1 source file to D:\MY FILES\My project\MakeMyTrip\build
    [javac] D:\MY FILES\My project\MakeMyTrip\src\MMTPack\TripClass.java:5: pack
    age com.thoughtworks.selenium does not exist
    [javac] import com.thoughtworks.selenium.DefaultSelenium;
    [javac]                                 ^
    [javac] D:\MY FILES\My project\MakeMyTrip\src\MMTPack\TripClass.java:6: pack
    age com.thoughtworks.selenium does not exist
    [javac] import com.thoughtworks.selenium.Selenium;
    [javac]                                 ^
    [javac] D:\MY FILES\My project\MakeMyTrip\src\MMTPack\TripClass.java:22: can
    not find symbol
    [javac] symbol  : class Selenium
    [javac] location: class MMTPack.TripClass
    [javac]     private static Selenium selenium;
    [javac]                    ^
    [javac] D:\MY FILES\My project\MakeMyTrip\src\MMTPack\TripClass.java:27: can
    not find symbol
    [javac] symbol  : class DefaultSelenium
    [javac] location: class MMTPack.TripClass
    [javac]     selenium = new DefaultSelenium("Localhost", 4444, "*iexplore", "
    http://www.makemytrip.com/");
    [javac]                    ^
    [javac] 4 errors 
```

**BUILD FAILED**

```
D:\MY FILES\My project\MakeMyTrip\build.xml:43: Compile failed; see the compiler
  error output for details.

  Total time: 2 seconds 
```

# extjs - 如何在 extjs 的菜单中动态设置项目？

> ID：16058057
> 
> 赞同：2
> 
> 时间：2013-04-17T10:49:42.823
> 
> 标签：extjs, extjs4, extjs4.1, extjs-mvc

通过单击显示菜单的按钮。**一旦我们选择菜单需要在其他菜单中动态更改项目。**我没有为这个视图的任何组件定义 id，因为如果我给组件提供 id，它会给出错误重复 id found。**此视图在所有视图中都很常见，例如全局功能。**在下面的代码中，两个项目： regionType 和 items: americaSubregionType 来自常量文件。第一次我需要将这些数据显示为区域和子区域中菜单的默认项。一旦我从区域中选择项目，我需要在子区域菜单中动态更改项目。**所以我已经通过这种方式单击区域菜单，我已经为子区域项目分配了值：您可以在下面的代码中看到 americaSubregionType。**但它没有反映。旧数据本身显示来自常量文件的子区域菜单项。谁能告诉如何动态更改项目？如何在extjs中实现这一点？非常感谢。谢谢你。

**这是我的代码**

```
{
    xtype: 'button',
    action: 'btnFilter',
    cls: 'filterCls',
    plain: true,
    menu: {
        items: [{
            text: 'Region',
            cls: 'filterMenuCls',
            menu: {
                plain: true,
                cls: 'filterMenuCls',
                listeners: {
                    click: function (menuitem, e, opt) {
                        var grid = Ext.getCmp('GridViewId');
                        grid.store.clearFilter();
                        grid.store.filter([{
                            property: "region",
                            value: e.text,
                            anyMatch: false,
                            exactMatch: true
                        }])
                        //This one i will retrieve from grid store and assign to americaSubregionType here will changesubregion value but it is not reflecting in visible view
                        americaSubregionType = [

                            '<b class="menuTitleCls">Choose a Vessel Type</b>', {
                            text: 'ABC',
                            cls: 'filterMenuCls'
                        }, {
                            text: 'Hello',
                            cls: 'filterMenuCls'
                        }]
                    }
                },
                items: regionType
            }
        }, {
            text: 'SubRegion',
            cls: 'filterMenuCls',
            menu: {
                plain: true,
                cls: 'filterMenuCls',
                action: 'Subbb',
                listeners: {
                    click: function (menuitem, e, opt) {

                    }
                },
                items: americaSubregionType
            }
        }

        }
    }

} 
```

常量文件数据

```
regionType = [

    '<b class="menuTitleCls">Choose a Vessel Type</b>',
    {
        text: 'AMERICAS',
        cls: 'filterMenuCls'
    },
    {
        text: 'NORTH SEA',
        cls: 'filterMenuCls'
    },
    {
        text: 'SEA',
        cls: 'filterMenuCls'
    }
]

americaSubregionType = [

    '<b class="menuTitleCls">Choose a Vessel Type</b>',
    {
        text: 'Brazil',
        cls: 'filterMenuCls'
    },
    {
        text: 'Mexico',
        cls: 'filterMenuCls'
    },
    {
        text: 'US',
        cls: 'filterMenuCls'
    }
] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T11:16:14.450

您可以设置`itemId`需要选择的菜单。

并且添加项目不应该有任何问题，`add()`或者`insert()`因为每个菜单都是一个容器（面板）。

# python - 在 django 中保存对象列表

> ID：16058063
> 
> 赞同：4
> 
> 时间：2013-04-17T10:50:00.173
> 
> 标签：python, django, django-views, django-orm, django-1.5

我正在使用 django 1.5，我正在尝试做这样的事情：

```
 quotes = formset.save()
    user = client_form.save()
    for quote in quotes:
        quote.client = user
    quotes.save() 
```

但是列表没有 save() 方法，所以是否有一些内置功能可以做类似的事情？

[我在关于 Django 中的批量保存对象的](https://stackoverflow.com/questions/4216192/question-about-batch-save-objects-in-django)SO Question 上找到了这个答案

django 1.5 仍然是真的吗？有没有办法避免对列表的每个对象进行 save() 调用？

这是我的实际视图代码：

```
def new_quote(request):
    QuoteLineFormSet = modelformset_factory(QuoteLine, form=QuoteLineForm, extra=2)

    if request.method == 'POST':
        formset = QuoteLineFormSet(request.POST, request.FILES, queryset=QuoteLine.objects.none())
        quote_form = QuoteForm(request.POST, request.FILES)
        if formset.is_valid() and quote_form.is_valid():
            quote_lines = formset.save(commit=False)
            #quote_lines = formset.get_queryset()
            quote = quote_form.save()
            for quote_line in quote_lines:
                quote_line.quote = quote
                quote_line.save()
            request.session['quote_id'] = quote.id
            return HttpResponseRedirect(reverse('new_client'))
    else:
        formset = QuoteLineFormSet(queryset=QuoteLine.objects.none())
        quote_form = QuoteForm()

    return render(request, 'request_quote_form.html', {
        'formset': formset,
        'quote_form': quote_form,
    }) 
```

我现在的解决方案

```
 quote_line_ids = [item.pk for item in formset.save()]
    quote_lines_qs = QuoteLine.objects.filter(pk__in=quote_line_ids)
    quote = quote_form.save()
    quote_lines_qs.update(quote=quote) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T11:05:25.400

您可以[`update()`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#update)在查询集上使用方法。

另请参阅此问题和答案：[Django: form that updates X amount of models](https://stackoverflow.com/questions/3778585/django-form-that-updates-x-amount-of-models/3779224#3779224)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T12:10:38.623

当您这样做时`formset.save()`，它访问数据库的次数与表单集中的表单数量一样多。因此，`n`如果表单集中的元素数量为`n`.

因此，您可以拥有`commit=False`根本不会命中数据库的表单集。然后您可以更新对象并调用`save()`每个对象。因此，您的数据库调用仍然是`n`时间。

```
#doesn't hit the database at all
quotes = formset.save(commit=False)
user = client_form.save()
for quote in quotes:
    quote.client = user
    #hits the db
    quote.save() 
```

不确定您是否可以在一次调用 db 中完成整个操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T11:36:46.413

也看看这个[链接](http://ole-laursen.blogspot.nl/2010/11/bulk-inserting-django-objects.html)。非常简单易用的方法。来自博客：

```
for x in seq:
   o = SomeObject()
   o.foo = x
   o.save() 
```

变成

```
l = []
for x in seq:
    o = SomeObject()
    o.foo = x
    l.append(o)
insert_many(l) 
```

# python - 如何将“\u5c0f\u738b\u5b50\u003a\u6c49\u6 cd5\u82f1\u5bf9\u7167”等字符串转换为汉字

> ID：16058065
> 
> 赞同：1
> 
> 时间：2013-04-17T10:50:15.927
> 
> 标签：python, string, unicode

我现在正在开发一个小工具来请求和解码一个网页，在该网页上，汉字被存储为字符串，如

```
\u5c0f\u738b\u5b50\u003a\u6c49\u6cd5\u82f1\u5bf9\u7167 
```

在源代码中，一些 unicode。我想把它转换成汉字。

我可以通过这个网站[http://rishida.net/tools/conversion/](http://rishida.net/tools/conversion/)。但是我怎样才能使用 python 来实现呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T10:57:07.847

*这些已经*是 Unicode 代码点。它们代表中文字符，但使用开发人员更容易的转义码：

```
>>> print u'\u5c0f\u738b\u5b50\u003a\u6c49\u6cd5\u82f1\u5bf9\u7167'
小王子:汉法英对照 
```

您不必做*任何事情*来转换它们；`\uxxxx`转义形式只是表达相同代码点的另一种方式。请参阅[字符串文字](http://docs.python.org/2/reference/lexical_analysis.html#string-literals)：

> `\uxxxx`
> 具有 16 位十六进制值 xxxx 的字符（仅限 Unicode）
> `\Uxxxxxxxx`
> 具有 32 位十六进制值 xxxxxxxx 的字符（仅限 Unicode）

Python 在读取源代码以构造 unicode 值时会解释这些转义码。

如果数据源不是来自 Python 源代码而是来自网络，那么您将使用 JSON 数据，它使用相同的转义格式：

```
>>> import json
>>> print json.loads('"\u5c0f\u738b\u5b50\u003a\u6c49\u6cd5\u82f1\u5bf9\u7167"')
小王子:汉法英对照 
```

请注意，该值需要成为较大字符串的一部分，该字符串*至少*包含引号以将其标记为字符串。

另请注意，当涉及到非 BMP（补充）代码点时，JSON 字符串转义格式与 Python 的不同；JSON 像 UTF-16 一样对待那些，通过[创建代理对](https://en.wikipedia.org/wiki/UTF-16#U.2B10000_to_U.2B10FFFF)并为这样的代码点使用两个`\uxxxx`序列。在 Python 中，您将使用`\Uhhhhhhhh`32 位十六进制值。

# java - Jsoup HTTPS 连接

> ID：16058067
> 
> 赞同：0
> 
> 时间：2013-04-17T10:50:32.257
> 
> 标签：java, ssl, login, https, jsoup

因此，我正在尝试登录一个站点，保存 cookie 并连接到另一个站点，同时提供 cookie 并继续抓取该网站。全部使用 Jsoup 和常规 java（我计划稍后迁移到 Android）。我的问题是，带有登录表单的网站正在使用 https 并且我收到[大量错误](http://pastebin.com/hK0wsVzR)。在四处搜索后，我发现[了这个 stackoverflow question](https://stackoverflow.com/questions/7744075)。所描述的方法涉及从登录站点获取 SSL 证书并将扩展名从 .crt 更改为 .jks。但是，我不断收到错误，因此无法使其工作。这是我的代码

```
public static void main(String args[]) throws IOException {

                //Log in
                Connection.Response login = Jsoup.connect("https://login.emu.dk")
                                .data("login", "myUsername")
                                .data("pass", "myPassword")
                                .method(Method.POST)
                                .execute();

                //Keep logged in
                Map<String,String> loginCookies = login.cookies();

                ArrayList<Lesson> unsorted = new ArrayList<Lesson>();
                URL elevplan = new URL("https://elevplan.dk");
                CSVParser csvParser = new CSVParser();

                System.setProperty("javax.net.ssl.trustStore", "/Users/philipjakobsen/Desktop/login.emu.dk.jks");
                System.setProperty("javax.net.ssl.trustStore", "/Users/philipjakobsen/Desktop/login.emu2.dk.jks");

                Document doc = Jsoup.connect("https://elevplan.dk")
                .cookies(loginCookies)
                .get(); 
```

那么，有谁知道如何让 Jsoup 建立 https 连接？如前所述，我想将我的应用程序“移植”到 Android，在这种情况下，我认为不可能使用静态证书（？）。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-11T10:28:55.740

尝试以下（只需将其放在 Jsoup.connect(" [https://login.emu.dk](https://login.emu.dk) ") 之前）：

```
 Authenticator.setDefault(new Authenticator() {
            @Override
            protected PasswordAuthentication getPasswordAuthentication() {
                return new PasswordAuthentication(username, password.toCharArray());
            }
        }); 
```

# javascript - 如何在 JavaScript 中绘制图形或树结构？

> ID：16058073
> 
> 赞同：34
> 
> 时间：2013-04-17T10:50:51.263
> 
> 标签：javascript, charts

我需要能够在 JavaScript 中绘制如下图：

![疯狂的图形图片](https://i.stack.imgur.com/F0uyt.jpg)

我知道[Raphael](http://raphaeljs.com/)库，但它仅用于绘制任意形状。

我有一些预定义的节点类型（图像上的彩色节点）和每个节点附近/内部的文本。这个库似乎没有处理这种情况。我如何在 JavaScript 中做到这一点？如果这已经由另一个库完成，我该如何使用该库来解决这个问题？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-04-17T12:14:06.560

网络是一个快速发展的世界，所以这个答案有点过时了。考虑到这一点，我更新了这个答案，使其在 2016 年适用。

*   [D3.js](http://d3js.org/) -*这仍然是我的建议。它正在积极开发中，并拥有一个充满活力的社区。*
*   [Vega](https://vega.github.io/vega-editor/?mode=vega&spec=force) -*一种富有表现力的语言（不如 D3 强大）*
*   [Cytoscape.js](http://js.cytoscape.org/)
*   [Spring.js](http://getspringy.com/)
*   [可乐.js](http://marvl.infotech.monash.edu/webcola/)

我要补充一点，我只`D3.js`在这个新列表中使用过，它的强大功能和灵活性让我从不需要寻找替代品。下面是[force 指令](https://bl.ocks.org/mbostock/4062045)的示例实现。

```
var width = 960,
    height = 500;

var color = d3.scale.category20();

var force = d3.layout.force()
    .charge(-120)
    .linkDistance(30)
    .size([width, height]);

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

d3.json("https://gist.githubusercontent.com/mbostock/4062045/raw/4176c7d0c0c5ce15630d16072da0af67bb50eb6a/miserables.json", function(error, graph) {
  if (error) throw error;

  force
      .nodes(graph.nodes)
      .links(graph.links)
      .start();

  var link = svg.selectAll(".link")
      .data(graph.links)
    .enter().append("line")
      .attr("class", "link")
      .style("stroke-width", function(d) { return Math.sqrt(d.value); });

  var node = svg.selectAll(".node")
      .data(graph.nodes)
    .enter().append("circle")
      .attr("class", "node")
      .attr("r", 5)
      .style("fill", function(d) { return color(d.group); })
      .call(force.drag);

  node.append("title")
      .text(function(d) { return d.name; });

  force.on("tick", function() {
    link.attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; });

    node.attr("cx", function(d) { return d.x; })
        .attr("cy", function(d) { return d.y; });
  });
});
```

```
.node {
  stroke: #fff;
  stroke-width: 1.5px;
}

.link {
  stroke: #999;
  stroke-opacity: .6;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.11/d3.min.js"></script>
```

* * *

有许多库可以在浏览器中绘制这种输出，你提到了 Raphael，其他的包括：

*   [Sigma.js](http://sigmajs.org/)
*   [处理.js](http://processingjs.org/)
*   [jit.js](http://philogb.github.io/jit/) -*卖给 SenchaLabs。独立开发者似乎停止了它的工作。*
*   [D3.js](http://d3js.org/)
*   Raphael.js -*似乎消失了，他们的主站点已经消失了*

我个人会推荐后者，D3，具体取决于您希望显示的项目数量和您需要的浏览器支持，因为它有据可查、功能强大且易于使用。查看这个[Github 项目以获取强制导向库的示例](http://mbostock.github.io/d3/talk/20111116/force-collapsible.html)。

为完成您设定的任务，您需要进行的更改是：

1）通过修改以下函数来更改数据的来源：

```
d3.json("flare.json", function(json) {
   root = json;
   root.fixed = true;
   root.x = w / 2;
   root.y = h / 2 - 80;
   update();
 }); 
```

将 更改`d3.json("flare.json")`为指向服务器上的不同文件/URL。如果您愿意，也可以使用 jQuery 做同样的事情并使用类似的回调方法。

2）要根据不同的类别为节点着色，您需要更改以下部分：

```
// Update the nodes…
  node = vis.selectAll("circle.node")
      .data(nodes, function(d) { return d.id; })
      .style("fill", color); 
```

将 更改为`.style("fill", color);`以下内容：

```
.style("fill", function(d) { 
    switch(d.category) {
       case A: return "#FF0000";
       case B: return "#00FF00";
       default: return "#0000FF";
    }
}); 
```

其中 category 是 JSON 数据对象的一个​​属性，您希望以此为依据。

# php - 在functions.php之外调用WP函数

> ID：16058074
> 
> 赞同：1
> 
> 时间：2013-04-17T10:50:51.997
> 
> 标签：php, wordpress

`functions.php`是否可以在非标准 WP 主题文件中调用 WordPress 主题文件之外的 WordPress 函数？

我正在 WordPress 之上开发某种补充框架，该框架预先组织来自 WP 数据库的数据，因此我可以使用 jQuery 调用它们并创建单页体验。

我试图从一个`post.php`文件（在主题根目录中）调用 WP 函数，该文件不是 WP 主题的默认文件。`post.php`与前端 jQuery之间的通信工作正常，它只是无法访问 WP 功能的文件。例如：

PHP 主题文件夹/post.php：

```
//function to get ALL posts, don't use to save server capacity
function fetch_all(){
    $posts = get_posts(); //<-- this is a WP function, it doesn't work

    /* however this line below makes the function return some data
        $posts = 'testing if function works';
    */

    if( isset( $posts )){
        echo json_encode( $posts );
        exit();
    }

    echo json_encode( 'no data to return...' );
} 
```

在 functions.php 中包含 post.php 时，我得到相同的结果：什么都没有。我看了一下[这种](https://stackoverflow.com/questions/13503014/wordpress-using-functions-outside-of-wordpress)方法，但是当我在 WP 环境中工作时，这似乎很详细。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:33:23.003

是的，这是可能的。在文件开头包含`wp-blog-header.php`并设置`WP_USE_THEMES`为。`false`

```
define( 'WP_USE_THEMES', false );  
require('wp-blog-header.php'); # adjust your path

# write the rest of your codes here. 
```

# java - EWS Java 1.2 - Unable to connect to company Exchange Server

> ID：16058076
> 
> 赞同：0
> 
> 时间：2013-04-17T10:50:55.523
> 
> 标签：java, ssl, exchange-server, exchangewebservices, ewsjavaapi

I'm currently trying to connect to our company's Exchange server using the EWS Java API. Unfortunately when try to execute anything (either autodiscover or some other action after using `setUrl` manually) I receive the following error:

```
Apr 17, 2013 7:57:10 AM org.apache.commons.httpclient.HttpMethodDirector executeWithRetry
INFO: I/O exception (java.net.ConnectException) caught when processing request: Connection refused: connect
Apr 17, 2013 7:57:10 AM org.apache.commons.httpclient.HttpMethodDirector executeWithRetry
INFO: Retrying request
Apr 17, 2013 7:57:11 AM org.apache.commons.httpclient.HttpMethodDirector executeWithRetry
INFO: I/O exception (java.net.ConnectException) caught when processing request: Connection refused: connect
Apr 17, 2013 7:57:11 AM org.apache.commons.httpclient.HttpMethodDirector executeWithRetry
INFO: Retrying request
Apr 17, 2013 7:57:12 AM org.apache.commons.httpclient.HttpMethodDirector executeWithRetry
INFO: I/O exception (java.net.ConnectException) caught when processing request: Connection refused: connect
Apr 17, 2013 7:57:12 AM org.apache.commons.httpclient.HttpMethodDirector executeWithRetry
INFO: Retrying request
Exception in thread "main" microsoft.exchange.webservices.data.ServiceRequestException: The request failed. Connection refused: connect
    at microsoft.exchange.webservices.data.ServiceRequestBase.getEwsHttpWebResponse(Unknown Source)
    at microsoft.exchange.webservices.data.ServiceRequestBase.validateAndEmitRequest(Unknown Source)
    at microsoft.exchange.webservices.data.SimpleServiceRequestBase.internalExecute(Unknown Source)
    at microsoft.exchange.webservices.data.MultiResponseServiceRequest.execute(Unknown Source)
    at microsoft.exchange.webservices.data.ExchangeService.bindToFolder(Unknown Source)
    at microsoft.exchange.webservices.data.ExchangeService.bindToFolder(Unknown Source)
    at microsoft.exchange.webservices.data.CalendarFolder.bind(Unknown Source)
    at microsoft.exchange.webservices.data.CalendarFolder.bind(Unknown Source)
    at er.dream.tgif.outlook.OutlookTest.findAppointments(OutlookTest.java:59)
    at er.dream.tgif.outlook.OutlookTest.main(OutlookTest.java:45)
Caused by: java.net.ConnectException: Connection refused: connect
    at java.net.DualStackPlainSocketImpl.waitForConnect(Native Method)
    at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:75)
    at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
    at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)
    at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
    at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:157)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
    at java.net.Socket.connect(Socket.java:579)
    at sun.security.ssl.SSLSocketImpl.connect(SSLSocketImpl.java:618)
    at microsoft.exchange.webservices.data.EwsSSLProtocolSocketFactory.createSocket(Unknown Source)
    at org.apache.commons.httpclient.HttpConnection.open(HttpConnection.java:707)
    at org.apache.commons.httpclient.MultiThreadedHttpConnectionManager$HttpConnectionAdapter.open(MultiThreadedHttpConnectionManager.java:1361)
    at org.apache.commons.httpclient.HttpMethodDirector.executeWithRetry(HttpMethodDirector.java:387)
    at org.apache.commons.httpclient.HttpMethodDirector.executeMethod(HttpMethodDirector.java:171)
    at org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java:397)
    at org.apache.commons.httpclient.HttpClient.executeMethod(HttpClient.java:323)
    at microsoft.exchange.webservices.data.HttpClientWebRequest.executeRequest(Unknown Source)
    ... 10 more 
```

I tried logging in using my credentials to the exchange servers web interface and this is working fine. Assuming it might be related to SSL issues, I also tried implementing a dummy TrustManager and setting it as default for `HttpsUrlConnections`.

Unfortunately this didn't help and the error still persists.

One notable fact: In my Outlook I can see that the Exchange server is configured to use a proxy server and a specific SSL URL to connect to it. (Proxy authentication is set to NTLM) I'm not quite sure how to reflect this in my coding.

Might this be causing the exception or am I looking at a different issue here?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T14:54:55.707

Java EWS API 的发行说明提到：

> 在 Windows 7 操作系统（32 位）上运行时，如果应用程序生成以下错误：错误：请求失败。无法获取响应代码java.io.IOException：身份验证失败

因此，如果这是您的情况，请参阅 EWS java Api 提供的发行说明（和/或 gooole 这个确切的句子以找到它们）。

请务必使用正确的 Web 服务端点和端口，因为您使用的套接字似乎已关闭（连接被拒绝）。这应该是这样的：

```
"https://YOURDOMAIN.com/EWS/Exchange.asmx" 
```

[这个其他 StackOverflow 问题](https://stackoverflow.com/questions/15841767/how-to-authenticate-ews-java-api)中提到的代码对我有用（Exchange 2010 + NTLM 身份验证方案）。

# javascript - jquery 1.7.1 hide and show not working correctly

> ID：16058078
> 
> 赞同：0
> 
> 时间：2013-04-17T10:51:06.523
> 
> 标签：javascript, jquery, sugarcrm

I have an element that is initially hidden by an inline style display:none. On click of another element I want to show the hidden element, then on re-click I want to hide it again. But what happens is if I put anything in the else statement it wont show or hide but if I leave the else blank it will show the element.

Also toggle(); and .is(:hidden) dont work either.

jquery version is either jQuery v1.6.4 or jQuery v1.7.1

What’s going wrong?

```
 //this does not work
$('#cust_select').click(function(e) {

    var element =  document.getElementById('cust_list');

    if($('#cust_list').css('display') === 'none') {
        $('#cust_list').show(); 
    }
    else if($('#cust_list').css('display') !== 'none'){
        $('#cust_list').hide(); 
    }

//this will show the element
$('#cust_select').click(function(e) {

    var element =  document.getElementById('cust_list');

    if($('#cust_list').css('display') === 'none') {
        $('#cust_list').show(); 
    }
    else if($('#cust_list').css('display') !== 'none'){
       //do nothing
    }
}); 
```

html:

```
 <ul id="selectLinkTop" class="clickMenu selectmenu SugarActionMenu" name="">
                <li class="sugar_action_button">
                  <input id="checkallContacts" class="checkbox massall" type="checkbox" name="checkallContacts" style="float: left;margin: 2px 0 0 4px;" onclick="">
                  <ul id="cust_list" style="background: none repeat scroll 0 0 #FFFFFF;border: 1px solid #CCCCCC;box-shadow: 0 5px 10px #999999;float: left;left: 0;list-style: none outside none;margin: 0;overflow: hidden;padding: 8px 0;position: absolute;top: 18px;width: auto;z-index: 10;display: none;">
                    <li style="clear: both;margin: 0;padding: 0;white-space: nowrap;width: 100%;"><a id="button_select_this_page_top" style="border: 0 none !important;float: left;font-size: 12px !important;padding: 1px 10px !important;text-align: left;width: 100%;line-height: 18px;display: block;" href="#">Select This Page</a></li>
                    <li style="clear: both;margin: 0;padding: 0;white-space: nowrap;width: 100%;"><a id="button_select_all_top" style="border: 0 none !important;float: left;font-size: 12px !important;padding: 1px 10px !important;text-align: left;width: 100%;line-height: 18px;display: block;" href="#" name="selectall">Select All‎&lt;/a></li>
                    <li style="clear: both;margin: 0;padding: 0;white-space: nowrap;width: 100%;"><a id="button_deselect_top" style="border: 0 none !important;float: left;font-size: 12px !important;padding: 1px 10px !important;text-align: left;width: 100%;line-height: 18px;display: block;" href="#" name="deselect">Deselect All</a></li>
                  </ul>
                  <span id="cust_select" class="subhover"> </span>
                </li>
                </ul>' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T10:56:20.783

利用 ：

```
$('#cust_select').click(function(e) {
    $('#cust_list').toggle();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:11:32.653

尝试这个。希望它有效:)

```
$('#cust_select').click(function(e) {

var element =  document.getElementById('cust_list');

if($('#cust_list').is(':hidden')) {
    $('#cust_list').show(); 
}
else if($('#cust_list').is(':visible')){
    $('#cust_list').hide(); 
}
}); 
```

# opencv - 如何正确训练级联

> ID：16058080
> 
> 赞同：33
> 
> 时间：2013-04-17T10:51:16.850
> 
> 标签：opencv

`"Required leaf false alarm rate achieved. Branch training terminated."` 以下训练命令的可能原因是什么：

用于创建样本

> -img imgs/CHE_one_wb.jpg -num 300 -bg imgs/negat.dat -vec imgs/vector.vec -info imgs/smpl/info.txt -maxxangle 0.1 -maxyangle 0 -maxzangle 0.1 -maxidev 100 -bgcolor 255 -bgthresh 0 -w 20 -h 35
> 
> -img imgs/CHE_one_wb.jpg -num 300 -bg imgs/negat.dat -info imgs/smpl/info.txt -maxxangle 0.1 -maxyangle 0.1 -maxzangle 0.1 -maxidev 100 -bgcolor 255 -bgthresh 0 -w 20 -h 35

火车

> -data imgs/cascade/ -vec imgs/vector.vec -bg imgs/negat.dat -numPos 200 -numNeg 40 -numStages 10 -featureType LBP -maxFalseAlarmRate 0.9 -w 20 -h 35

培训结果

![在此处输入图像描述](https://i.stack.imgur.com/sEdEl.png)

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-05-30T11:24:43.247

我已经实现了我的目标并训练了良好的级联。

1.  首先，您需要几个原始样本（不要使用一个并将其与创建样本相乘）。我使用了 10 张不同的啤酒瓶照片，每张照片创建了 20000 个样本，然后我将所有样本与 2000 个样本合并到一个矢量文件中。
2.  -w 20 -h 35 应该匹配原始图像的纵横比
3.  正样本与负样本的关系应该在 2:1 左右（应该有更多的正样本）
4.  您应该自己选择的阶段数（对我来说是12-13）。您设置的阶段越多，您的级联就越精确，但您也可以过度训练您的级联，它不会找到任何东西。级联的精度由最后阶段的**acceptanceRatio**显示，它应该在这个值附近`0.000412662`或更低。

但是如果你得到像这样的**acceptanceRatio**`7.83885e-07` ，你的级联可能已经过度训练并且它不会找到任何东西，试着设置更少的阶段。

**！！！**还有一件更重要的事情，当你训练你的级联时，你应该在你的阶段上从 2 或 3 个阶段开始有多个功能。如果您只有一个功能，您将无法获得良好的级联。您应该处理训练图像（负样本和正样本）。正常训练将如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/Oy1m4.png)

对于培训，我使用了`-data imgs/cascade/ -vec imgs/vector.vec -bg imgs/negat.dat -numPos 1900 -numNeg 900 -numStages 12 -featureType HAAR -minHitRate 0.999 -maxFalseAlarmRate 0.5 -w 24 -h 30`命令

两种功能类型的工作方式几乎相同，有时 HAAR 稍微好一点，但比 LBP 慢得多。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-17T11:00:24.893

与正数和阶段数相比，负数太少。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-17T13:05:56.717

如果您有少量数据，则需要更少的阶段来达到您设置的所需误报率。这意味着级联分类器“足够好”，因此不必进一步增长。总的误报率实际上是乘以每个阶段的比率，所以在一个点之后，就达到了该值。

在您的选项中，您将其设置为 0.9。考虑让它更高，比如 0.95 或更高。

除此之外，您的数据集很小，因此在训练期间验证它们时算法更容易获得良好的结果。数据集越小，分类器越容易训练，因此需要的阶段就越少。但这并不意味着在真实数据上运行时会更好。此外，如果您保持较低的训练规模并设置较高的比率，请考虑分类器将需要更多阶段才能完成并且会更复杂，但它很可能会在训练集上过度训练。

总而言之，如果您拥有的正面和负面的性质使它们易于分离，那么您不需要这么多样本。当然，这取决于您训练算法的目的。根据您的样本数量，您放置的 10 个阶段很多，因此算法会提前终止（不一定是坏的）。

当我训练人脸时，我想我有大约 1000 个正面（包括所有的旋转/偏差）和 2-3 千个负面，如果我没记错的话，需要一个大约 11-13 个级别的分类器。

[Naotoshi Neo](http://note.sonots.com/SciSoftware/haartraining.html)的教程对我帮助很大。

另外，正如 Safir 所提到的，我现在注意到的是，与正样本相比，负样本太少了。应该至少在数量上相等，最好是正数的 1.5 - 2 倍左右。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2015-04-26T20:06:10.967

您设置 maxFalseAlarmRate=0.9。
这意味着在每个阶段中，不超过 90% 的 40 个负样本（即 36 个样本）应该位于正边界内。当算法设法将至少 4 个样本置于该边界之外时，它可以进入下一阶段。
这工作了几个阶段，直到发生（只是偶然）从一开始就少于 36 个样本已经在正边界内（请记住，负样本提取是一个随机过程）。所以当算法应该操作分离时，它已经完成了它的工作，它不知道如何进行。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-08-08T11:21:26.450

我在正确训练我的级联时也遇到了一些问题。我遵循@Dmitry Zaytsev 编写的步骤，但我无法获得正确的 cascade.xml。我总是有这样的消息：

> “达到要求的叶子误报率。分支训练终止。”

或者

> “最可能的原因是给定 vec 文件中的样本数量不足。”

最后我成功了。我想分享我的想法，即使我不完全确定它们是否正确。把它们当作我自己的经验，记住我不是开发人员。

参数 -w 和 -h 真的很有意义。当我发现向量的样本应该具有可能的最小尺寸时，一切都开始正常工作，并且我从经验丰富的开发人员那里读到 24 是一个很好的最小尺寸。我得到了轴（宽度和高度）之间的关系，我使用 -w 24 和 -h 66 作为我的形状检测器。

另外，当我得到背景图像时，我意识到了一些事情。大小关心。100 x 100 像素这是一个很好的尺寸（在教程中看到）但我想相信的是尺寸必须大于矢量样本的图像！这意味着如果您使用：

```
opencv_createsamples -vec yourvectorsamplesimages.vec -info path/to/data/file.info -num NumOfPositivesImages -w 24 -h 66 
```

**-w**和**-h**值必须低于 100。我认为这是因为当我之后使用 opencv_traincascade 时，这是我唯一一次得到正确的火车 cascade.xml，正如 @Dmitry Zaytsev 之前所说的那样。

我知道我的信息不严谨，也可能是错误的，但是为了获得正确的 cascade.xml 挣扎了 4 天，导致我建立了这种关系。

只是想提供帮助，因为您的信息对我有所帮助。:-)

谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-01-26T09:06:51.353

这不是错误！鉴于提供的样本和训练设置，您的级联已经达到了预期的潜力。要么添加更多数据，要么让您的要求更加苛刻！现在它只是说，和你要求的一样好......

你现在有三种方式...

1.  在 -numStages 中添加更多阶段以获得您的阶段，例如，如果您想获得 10 个阶段，您可以在参数 -numStages 14 中写入，您将获得 10 或 11 个阶段。

2.你可以通过增加你的数据来摆脱这个，我的意思是你的正面图像和负面图像的数量。“尽量保持积极而不是消极”

3.我在某个地方读过这个，所以我不知道它是否有效。您可以通过增加 -minHitRate 0.995 和 -maxFalseAlarmRate 0.5 来做到这一点，这两个参数有它们的默认值，您可以通过将它们增加到 0.998 和 0.7 并继续这样做来解决您的问题。

但就像我说的，这不是一个错误。

# php - How to fetch Array keys from PHP in jQuery

> ID：16058081
> 
> 赞同：1
> 
> 时间：2013-04-17T10:51:19.543
> 
> 标签：php, javascript, jquery

I'm new to jQuery and would like to know how I can fetch Array keys from a php file into jQuery.

I have this jQuery code to post input to `file.php` and exexute a query on every keyup.

`file.php` echoes the result with the help of an Array what will look like:

```
echo '<li>'.$row["name"].' '.$row["place"].' '.$row["year"].'</li>'; 
```

The jQuery code is:

```
$(document).ready(function() { //changes are possible when the page has fully loaded
    $('.inp').keyup(function() { //executes keyup function to the field class "inp"
        var inp = $(this).attr('value'); //sets a variable with the value of input from class="inp"
        $.post('ajax/file.php', {inp:inp}, function(data) { //posts that value to file.php as variable inp and executes the function (data) to this 
            $('.result').html(data);  //adds the returned result into HTML content as a first element in the set of class="result" => <li>

            $('.result li').click(function() { //executes click function when clicking li element
                var result_value = $(this).text(); //sets a variable and prepares something as text 
                $('.inp').attr('value', result_value); //fills value attribute of field class "inp" with the variable result_value
                $('.result').html(''); //clears li to ul class to hide the lists of results
            });
        });
    });
}); 
```

So when I click onto the `li` result it will be converted into text and the value attribute of the input field is filled with that.

To give an example:

```
echo '<li>'.$row["name"].' '.$row["place"].' '.$row["year"].'</li>'; 
```

will output:

```
<li>ExAmpLE Home 2013</li> 
```

So when I click on `li` the new value of the input field is:

> ExAmpLE Home 2013

My question is how can I exlude specific Array keys like `$row["name"]` or `$row["year"]` from converting the result value into text from that click function so that the new value of the input field is:

> ExAmpLE Home

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:09:15.683

您可以使用 json ：

`file.php`

```
json_encode(array('name' => $row["name"], 'place' => $row["place"], 'year' => $row["year"])); 
```

在您的 javascript 中使用 jQuery [data()](http://api.jquery.com/data/)函数将您的数据存储在 DOM 中以便稍后检索它：

```
$.post('ajax/file.php', {inp:inp}, function(data) {
            $('.result').html(
              $('<li>').text(data.name + ' ' + data.place + ' ' + data.year)
                .data('name', data.name)
                .data('place', data.place)
                .data('year', data.year)
                .click(function() {
                    $('.inp').attr('value', $(this).data('name') + ' ' + $(this).data('place'))
                    $(this).empty();
                })
            );
        }, 'json'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T10:59:41.860

将您需要的东西放入一个跨度应该可以工作：

```
echo '<li><span>'.$row["name"].' '.$row["place"].'</span> '.$row["year"].'</li>'; 
```

我假设您已经知道如何使用 li 元素。然后做：

```
var $li= $(this);
var text= $li.find('span').text(); 
```

# ios - My iPhone app with cocos2d-x crashes only in Ad-hoc build

> ID：16058082
> 
> 赞同：1
> 
> 时间：2013-04-17T10:51:20.700
> 
> 标签：ios, cocos2d-x, adhoc

My cocos2d-x app crashes in Ad-hoc build, even though it works fine in debug-mode.

Just after the app launches, it crashes.

The situation may be similar to the issue here. [Cocos2d-x app only crashes in Ad-hoc build](https://stackoverflow.com/questions/15084299/cocos2d-x-app-only-crashes-in-ad-hoc-build)

But as I don't use CocosBuilder, it must have happened with different reason. (I tried to fix following the advice but my app didn't work.)

Crash report is:

```
Incident Identifier: CEE9C97F-CCA7-4769-B17B-AD39AF709B28
CrashReporter Key:   7bad3b03fac96eca686dbc9f7de90780e15c35d3
Hardware Model:      iPhone4,1
Process:         myapp [2855]
Path:
/var/mobile/Applications/7A2BA957-8ACE-46BD-9FBB-79FAF1BD4DCB/myapp.app/myapp
Identifier:      myapp
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2013-04-15 17:37:06.354 +0900
OS Version:      iOS 6.1.3 (10B329)
Report Version:  104

Exception Type:  EXC_BAD_ACCESS (SIGBUS)
Exception Codes: EXC_ARM_DA_ALIGN at 0x331cb869
Crashed Thread:  0

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   myapp                              0x000161e2 0x1000 + 86498
1   myapp                              0x000162aa 0x1000 + 86698
2   myapp                              0x00016286 0x1000 + 86662
3   myapp                              0x00013ae0 0x1000 + 76512
4   myapp                              0x0001c328 0x1000 + 111400
5   myapp                              0x0001de1a 0x1000 + 118298
6   myapp                              0x0001b636 0x1000 + 108086
7   myapp                              0x0001c04c 0x1000 + 110668
8   QuartzCore                          0x331ca094
CA::Display::DisplayLink::dispatch(unsigned long long, unsigned long
long) + 156
9   QuartzCore                          0x331c9fec
CA::Display::IOMFBDisplayLink::callback(__IOMobileFramebuffer*,
unsigned long long, unsigned long long, unsigned long long, void*) +
60
10  IOMobileFramebuffer                 0x35447fd4
IOMobileFramebufferVsyncNotifyFunc + 152
11  IOKit                               0x321c4446
IODispatchCalloutFromCFMessage + 190
12  CoreFoundation                      0x315a75d8 __CFMachPortPerform + 116
13  CoreFoundation                      0x315b2170
__CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE1_PERFORM_FUNCTION__ + 32
14  CoreFoundation                      0x315b2112 __CFRunLoopDoSource1 + 134
15  CoreFoundation                      0x315b0f94 __CFRunLoopRun + 1380
16  CoreFoundation                      0x31523eb8 CFRunLoopRunSpecific + 352
17  CoreFoundation                      0x31523d44 CFRunLoopRunInMode + 100
18  GraphicsServices                    0x350fc2e6 GSEventRunModal + 70
19  UIKit                               0x334392fc UIApplicationMain + 1116
20  myapp                              0x00012db6 0x1000 + 73142
21  myapp                              0x0000229c 0x1000 + 4764 
```

Can anyone tell me how to deal with?

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T02:01:28.510

我能够自己解决问题

[CCFiniteTimeAction::getDuration() 创建 CCSequence 时的 EXC_BAD_ACCESS](https://stackoverflow.com/questions/14923788/ccfinitetimeactiongetduration-exc-bad-access-when-creating-a-ccsequence)

数组不是以 NULL 结尾的，所以它不起作用。由于我过于专注于运行应用程序，我错过了重要和基本的事情。

感谢您的评论，Madhusudhan 和 LearnCocos2D。

# mysql - SQL Foreign Key constraint syntax

> ID：16058083
> 
> 赞同：-3
> 
> 时间：2013-04-17T10:51:22.837
> 
> 标签：mysql, sql, foreign-keys

I cannot import my db as I've configured my foreign key incorrectly. Could someone please tell me what I did wrong?

```
 CREATE TABLE `candidats` (
  `id_candidats` varchar(20) NOT NULL DEFAULT '1',
  `affiche_candidat` varchar(50) DEFAULT NULL,
  `film_id_film` tinyint(1) unsigned NOT NULL,
  `categories_id_categorie` tinyint(2) unsigned NOT NULL,
  `ecole_id_ecole` tinyint(3) unsigned NOT NULL,
  `email_candidat` varchar(75) DEFAULT NULL,
  `password_candidat` varchar(20) DEFAULT NULL,
  `nom_candidat` varchar(50) DEFAULT NULL,
  `prenom_candidat` varchar(50) DEFAULT NULL,
  `datenaiss` date DEFAULT NULL,
  `titre` varchar(50) DEFAULT 'sans-titre',
  `description` mediumblob,
  `approuvee` tinyint(1) NOT NULL DEFAULT '0',
  `abus` tinyint(1) NOT NULL DEFAULT '0',
  `votes_candidat` mediumint(4) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id_candidats`),
  KEY `candidats_FKIndex4` (`film_id_film`),
  KEY `candidats_FKIndex3` (`ecole_id_ecole`),
  KEY `candidats_FKIndex2` (`categories_id_categorie`),
  KEY `film_id_film` (`film_id_film`),
  KEY `ecole_id_ecole` (`ecole_id_ecole`),
  KEY `categories_id_categorie` (`categories_id_categorie`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `categories` (
  `id_categorie` tinyint(2) unsigned NOT NULL AUTO_INCREMENT,
  `nom_categorie` varchar(20) DEFAULT NULL,
  PRIMARY KEY (`id_categorie`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=5 ;

CREATE TABLE `ecole` (
  `id_ecole` tinyint(3) unsigned NOT NULL AUTO_INCREMENT,
  `nom_ecole` varchar(100) DEFAULT NULL,
  `nom_referent` varchar(50) DEFAULT NULL,
  `email_ecole` varchar(50) DEFAULT NULL,
  `tel_ecole` varchar(13) DEFAULT NULL,
  PRIMARY KEY (`id_ecole`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=15 ;

CREATE TABLE `films` (
  `id_films` tinyint(1) unsigned NOT NULL AUTO_INCREMENT,
  `nom_films` varchar(25) NOT NULL,
  `class_films` varchar(12) NOT NULL,
  PRIMARY KEY (`id_films`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

ALTER TABLE `candidats`
  ADD CONSTRAINT `candidats_ibfk_1` FOREIGN KEY (`ecole_id_ecole`) REFERENCES `ecole` (`id_ecole`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `candidats_ibfk_2` FOREIGN KEY (`categories_id_categorie`) REFERENCES `categories` (`id_categorie`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `candidats_ibfk_3` FOREIGN KEY (`film_id_film`) REFERENCES `films` (`id_films`) ON DELETE NO ACTION ON UPDATE NO ACTION; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:08:10.583

事实证明，我已经在候选人表的电影列中插入了 0。由于 0 不是可能的 id 编号，因此它引发了错误。

# linux - How to filter tshark results before to write to file?

> ID：16058088
> 
> 赞同：6
> 
> 时间：2013-04-17T10:51:31.307
> 
> 标签：linux, tshark

I try to calculate `GET` Request from my server.

I use `tshark`.

I run followed command to filter incoming traffic and fetch only `GET` requests:

```
/usr/sbin/tshark   -b filesize:1024000  -b files:1  \
'tcp port 80 and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2)) != 0)' \
-w samples.pcap -R 'http.request.method == "GET"' 
```

As you see I defined to store filtered results to 1 file with max size 1G and name: `samples.pcap`.

The problem is, when i try to open pcap file i see that `tshark stored all traffic there`:

```
3245 172.692247  1.1.1.1 -> 2.2.2.2 HTTP [TCP Retransmission] Continuation or non-HTTP traffic
3246 172.730928  1.1.1.1 -> 2.2.2.2 HTTP Continuation or non-HTTP traffic
3247 172.731944  1.1.1.1 -> 2.2.2.2 HTTP Continuation or non-HTTP traffic
3248 172.791934  1.1.1.1 -> 2.2.2.2  HTTP GET /services/client/client.php?cnc=13 HTTP/1.1
3249 172.825303  1.1.1.1 -> 2.2.2.2 HTTP HTTP/1.1 200 OK [Unreassembled Packet [incorrect TCP checksum]]
3250 172.826329  1.1.1.1 -> 2.2.2.2 HTTP Continuation or non-HTTP traffic
3251 172.826341  1.1.1.1 -> 2.2.2.2 HTTP Continuation or non-HTTP traffic
3252 172.826347  1.1.1.1 -> 2.2.2.2 HTTP Continuation or non-HTTP traffic
3253 172.826354  1.1.1.1 -> 2.2.2.2 HTTP Continuation or non-HTTP traffic
3254 172.826359  1.1.1.1 -> 2.2.2.2 HTTP Continuation or non-HTTP traffic 
```

I have really big traffic, during 10 min i get pcap file size 950M. And it takes about 4 min to parse it.

The interesting thing is when I try to run it without to store it to local file (but under /tmp):

```
/usr/sbin/tshark \
'tcp port 80 and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2)) != 0)' \
-R 'http.request.method == "GET"':

3.776587 1.1.1.1 -> 2.2.2.2  HTTP GET /services/client/client.php?cnc=13 HTTP/1.1
4.775624 1.1.1.1 -> 2.2.2.2  HTTP GET /services/client/clsWebClient.php HTTP/1.1
8.804702 1.1.1.1 -> 2.2.2.2  HTTP GET /services/client/client.php?cnc=13 HTTP/1.1 
```

It works, but in this case i have under /tmp several temp files with huge size 1G+.

Did i miss something?

Thank you

=======================================================

**Edit**

Lars asked to add `-f`:

```
sudo /usr/sbin/tshark   -T fields -e 'http.request.uri contains "cnc=13"'  \
         -b filesize:1024000  -b files:1  \
         -f 'tcp port 80 and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2)) != 0)'  \
         -w samples.pcap 
```

Doesn't help, still samples.pcap stores all traffic:

```
 74   6.908388  172.20.0.23 -> 89.78.170.96 HTTP Continuation or non-HTTP traffic
 75   6.908394  172.20.0.23 -> 89.78.170.96 HTTP Continuation or non-HTTP traffic 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T13:05:51.987

当您想要组合 -w 和 bpf 数据包过滤器（即，您放在 -f 上的内容）时，这似乎有效：

```
 tcpdump -nli en1 -w - 'tcp port 80' | tshark -i - -R'http.request.method == "GET"' 
```

（用 tshark 替换初始 tcpdump 会导致我的本地系统出现此错误：tshark: Unrecognized libpcap format）

自 1.4.0 版本以来，在捕获（或从捕获中读取）并再次写出结果时，似乎不再支持保存读取过滤器 (-R) 的结果（请参阅：[http://ask.wireshark .org/questions/10397/read-filters-arent-supported-when-capturing-and-saving-the-captured-packets](http://ask.wireshark.org/questions/10397/read-filters-arent-supported-when-capturing-and-saving-the-captured-packets)）。大概 1.4.0 之前的版本将允许写入 pcap 并限制输出`-b`（尚未测试）。

如果您只想要 -R 的文本输出（而不是 pcap 输出）。我认为上述命令将是您的解决方案。

为了限制您的输出（即您提到您只想取样），您可以`head -c <bytes>`在处理管道中的任何位置使用：

```
tcpdump -nli en1 -w - 'tcp port 80' | \
  tshark -i - -R'http.request.method == "GET"' | \
  head -c 1024000 > output.txt 
```

生成一个 1024000 字节的文本输出文件，名为 output.txt 或

```
tcpdump -nli en1 -w - 'tcp port 80' | \
  head -c 1024000 | \
  tshark -i - -R'http.request.method == "GET"' > output.txt 
```

处理为 TCP 端口 80 预过滤的 102400 字节的 pcap 输入，并将文本输出放入名为 output.txt 的文件中

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-07-28T15:43:52.907

好吧，不要使用-w，它会保存原始数据，你应该使用重定向运算符“>”来指定目标目录。

# android - 在 Android 中上下移动对象（跳跃）

> ID：16058091
> 
> 赞同：0
> 
> 时间：2013-04-17T10:51:41.183
> 
> 标签：android, android-animation

我制作了一个应用程序，其中一个盘子上有一个苹果。我想把这个苹果放在盘子上，然后放置后让这个苹果跳起来，直到用户不能点击它。我不知道该怎么做。

关于在盘子上上下移动苹果的任何帮助。我可以完成这项任务的任何课程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T10:59:20.090

使用[2D 图形](http://developer.android.com/guide/topics/graphics/2d-graphics.html)或[OpenGL](http://developer.android.com/guide/topics/graphics/opengl.html)来获得这种效果，2D 图形将很容易实现，但如果您想提高性能，请使用 openGL。这可以与您的应用程序逻辑相结合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:00:01.020

示例：保存在 res/anim/rocket.xml 的 XML 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<animation-list xmlns:android="http://schemas.android.com/apk/res/android"
    android:oneshot="false">
    <item android:drawable="@drawable/rocket_thrust1" android:duration="200" />
    <item android:drawable="@drawable/rocket_thrust2" android:duration="200" />
    <item android:drawable="@drawable/rocket_thrust3" android:duration="200" />
</animation-list> 
```

此应用程序代码会将动画设置为 View 的背景，然后播放动画：

```
ImageView rocketImage = (ImageView) findViewById(R.id.rocket_image);
rocketImage.setBackgroundResource(R.drawable.rocket_thrust);

rocketAnimation = (AnimationDrawable) rocketImage.getBackground();
rocketAnimation.start(); 
```

在这里，您可以使用一组可绘制对象并开始动画，一旦单击视图，您就可以通过调用**RocketAnimation.stop() 来停止动画；**

# geolocation - 如何将 GML/JSON 转换为 RDF？

> ID：16058093
> 
> 赞同：1
> 
> 时间：2013-04-17T10:51:42.520
> 
> 标签：geolocation, rdf, opendata

我有一个带有坐标的地理相关数据集，并希望将其转换为 RDF 以将其发布为关联数据。数据集以 GML、KML、JSON、CSV 和 XSD 格式存在。内容只是带有描述的要点。

我只是这方面的初学者，所以我想问你，我必须将它转换为 RDF 的可能性有哪些？我已经在[http://www.w3.org/wiki/ConverterToRdf](http://www.w3.org/wiki/ConverterToRdf)和 [http://simile.mit.edu/wiki/RDFizers](http://simile.mit.edu/wiki/RDFizers)上找到了一组转换器，但不支持所需的格式。我尝试对 GML 文件使用 XML 转换器来查看发生了什么，但结果仅包含元数据信息。除此之外，我尝试了 TopBraid Composer 测试版，但安装后我不确定如何使用它。我还没有在某处找到 JSON2RDF 函数。

您对如何转换数据集有任何想法或方法吗？我正在寻找一个尽可能简单的解决方案，其他初学者可以快速重复这项工作。

附上 JSON 文件的一些摘录。各种格式的整个数据集可以在这里找到： [https ://geo.sv.rostock.de/download/opendata/naturdenkmale/](https://geo.sv.rostock.de/download/opendata/naturdenkmale/)

```
JSON:
{"type": "FeatureCollection",
"features": [
{ "type": "Feature", "properties": { "id": 1, "bezeichnung": "1\. Stieleichen mit Hecke", "bezeichnung_latein": "Quercus robur et. al.", "veroeffentlichung": "BeschluÃŸ Rat d. Stadt 94\/51\/81 18.06.1981" }, "geometry": { "type": "Point", "coordinates": [ 12.061458855408354, 54.141761469057052 ] } },
{ "type": "Feature", "properties": { "id": 2, "bezeichnung": "2\. Stieleichen mit Hecke", "bezeichnung_latein": "Quercus robur et. al.", "veroeffentlichung": "BeschluÃŸ Rat d. Stadt 94\/51\/81 18.06.1981" }, "geometry": { "type": "Point", "coordinates": [ 12.061222607125485, 54.141793579585588 ] } }, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T16:29:17.820

你做的最简单的事情可能就是写一些快速而肮脏的东西来进行转换。

[Sesame](http://openrdf.org)有一个非常好的 API，称为 RIO，用于进行 RDF 读取和写入，所以如果您使用 Java，那是您最好的选择。

使用任何现成的 JSON 解析器，您可以进行非常简单的转换为三元组并将它们流式传输到 RIO RDF 编写器，以您选择的格式输出它们。您可以选择自己的模式来命名谓词、类等，或者您可以从 schema.org 中获取一些东西来重用。

# python - 在 matplotlib 中有条件地绘制连接线

> ID：16058096
> 
> 赞同：2
> 
> 时间：2013-04-17T10:51:57.240
> 
> 标签：python, matplotlib

我想在笛卡尔图上绘制风向测量值，X 轴为时间，Y 轴为方向。因为从 359 度移动到 0 度时方向会发生回绕，所以画一条连接 359 到 0 的线是不合适的。

如果较短的跳跃没有包裹，是否可以有条件地绘制连接线？即这里是一个值序列，在适当的地方有连接线：

10—15—30—90—150—290—350 40—50—20 310—250—150

我假设我会使用类似下面的公式来确定 A 和 B 之间是否应该有一条线：

```
max(A,B) - min(A,B) <= 180 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T10:51:57.240

While writing the question, I came up with a working approach: Simply adding a `None` value indicates that the data are not continuous and the line is broken.

To make it perfect, I added points outside my range so that lines will eg leave the plot at the top and come out of the bottom.

This was done with a simple generator that adds the relevant data points:

```
def break_degree_wrap(values):
    values1, values2 = itertools.tee(values)

    # Yield the first value
    yield next(values2)

    for (prev_datetime, prev_val), (datetime, val) in itertools.izip(values1, values2):

        # If the data wraps over the top
        if val > prev_val and val - prev_val > 180:
            yield (datetime, val - 360)
            yield (datetime, None)
            yield (prev_datetime, prev_val + 360)

        # If the data wraps under the bottom
        elif val < prev_val and prev_val - val > 180:
            yield (datetime, val + 360)
            yield (datetime, None)
            yield (prev_datetime, prev_val - 360)

        # Add each original value
        yield (datetime, val) 
```

This could be easily generalised to accept a valid range, instead of the hardcoded (0, 360).

Here is how it looks (excuse the poor axes :-) ![Wind direction](https://i.stack.imgur.com/kDu9g.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T12:21:36.660

我总是使用 np.diff() 函数来获取变化大于 180 度的点并插入一个蒙面元素。主要的缺点是您还必须为绘图保留一个“索引”。

所以：

```
a = np.array([10,15,30,90,150,290,350,40,50,20,310,250,150])
idx = np.arange(len(a))

b = np.diff(a)
mask = np.where(np.abs(b) >= 180)[0]+1

c = np.ma.masked_equal(np.insert(a, mask, -1), -1)
idx = np.ma.masked_equal(np.insert(idx, mask, -1), -1)

fig, ax = plt.subplots(figsize=(10,3))

ax.plot(idx, c)
ax.set_xticks(idx)
ax.set_ylim(0,360) 
```

![在此处输入图像描述](https://i.stack.imgur.com/Jr4k5.png)

这不会插入超出范围的值，但我想可以添加。您可以插入 2 个元素再次“出”和“入”图表，而不是 1 个蒙面元素。

另请注意，180 度的阈值只是一个假设，除非您实际测量它，否则您并不真正知道风是在倒退还是转向。

# h2 - 无法浏览 H2 数据库文件？

> ID：16058100
> 
> 赞同：5
> 
> 时间：2013-04-17T10:52:05.823
> 
> 标签：h2, dbvisualizer

我正在我的单元测试中创建一个 H2 数据库。数据库使用以下属性：

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" 
    destroy-method="close">
  <property name="driverClassName" value="org.h2.Driver"/>
  <property name="url" value="jdbc:h2:file:target/db/testdb"/>
  <property name="username" value="sa"/>
  <property name="password" value=""/>
</bean> 
```

我正在使用`com.h2database.h2`jar 文件的 1.3.166 版本。

当我运行测试时，我看到在`target/db`目录中创建了数据库，并且`testdb.h2.db`存在一个文件。我的测试运行并从数据库加载数据。我可以打开`target/db/testdb.h2.db`文件并查看用于创建数据库的 SQL 语句。

但是，当我尝试将`target/db/testsb.h2.db`文件加载到 DBVisualizer 等数据库浏览工具中时，我看不到任何表或数据。对于 DBVisualizer，我指定 H2（嵌入式）模式。

我也尝试了 H2 控制台，但一个`show tables`命令返回一个空的结果集。

我看不出我做错了什么：数据库文件存在，测试正确运行，但我无法在数据库浏览器中打开此文件。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T15:11:50.387

最有可能的问题是您使用的数据库 URL。

```
jdbc:h2:file:target/db/testdb 
```

这意味着数据库文件是***相对于当前工作目录***存储的。所以这取决于你从哪里开始应用程序。如果您在不同的目录中启动 DBVisualizer（很可能您已经这样做了），那么它会在不同的目录中创建一个*新*数据库。

为确保您使用相同的数据库，我建议使用绝对目录名称，或相对于当前用户主目录，如 H2 文档中所述：

```
jdbc:h2:~/relative/to/user/home/dir/testdb
jdbc:h2:/absolute/path/testdb 
```

前缀`file:`是可选的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-12T14:45:02.987

如果您收到类似的错误

```
Unsupported database file version or invalid file header in file "Old database:
/path/to/databasename.data.db - please convert the database to a SQL script and 
re-create it." [90048-167] 
```

问题是（如消息所述）您正在使用使用旧版本的 h2 创建的数据库。为了使用 dbVisualizer 浏览数据库，您可以创建一个新的数据库驱动程序：

`Tools`> `Driver manager...`>`Create a new driver`

填写字段并选择正确的 h2 jar 文件，你应该很高兴。

# objective-c - 圆角矩形 UITextField 的自定义高度

> ID：16058102
> 
> 赞同：-1
> 
> 时间：2013-04-17T10:52:12.280
> 
> 标签：objective-c, ios6, uitextfield

我有 RoundedRectangle 类型的 UITextField。我想将高度设置为 50。

当我尝试通过 IB 时，我看到它被禁用。当我将类型更改为矩形时，我看到它已启用，我可以从那里进行更改。我更改为 50 并将类型再次更改为 RoundedRectangle。它又变成了，30的高度。

任何想法，如何做到这一点？任何帮助/建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:03:26.367

这可能是 IB 不能很好地迎合的那些奇怪的球之一。有点像在 UITextField 等上设置圆角。

为按钮设置一个 IBOutlet 并将其与视图的 .h 文件中的实例 var/property 连接，然后使用以下内容：

```
myButton.frame.size.height = 50.0; 
```

这应该有效，因为 UITextField 是 UIView 的后代，它具有框架，框架是 CGRect 并且 CGRect 包含原点和大小的结构。

您将大小指定为 CGFloat，它是十进制数。

进一步参考：[UIView 中的 CGRect 文档](http://developer.apple.com/library/ios/#documentation/GraphicsImaging/Reference/CGGeometry/Reference/reference.html#//apple_ref/doc/c_ref/CGRect "UIView 中的 CGRect 文档")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:12:07.697

在 IB 中将文本字段类型设置为方形矩形并将高度设置为 50，并在 viewDidLoad 中的代码中说

```
[firstName setBorderStyle:UITextBorderStyleRoundedRect]; 
```

# git - Git checkout 通过 ftp 部署更改

> ID：16058103
> 
> 赞同：1
> 
> 时间：2013-04-17T10:52:13.273
> 
> 标签：git, phpstorm

我使用远程 Web 服务器在本地工作，将文件放在 ftp 上。有没有办法在我签出分支时，更改/删除的文件会自动更新到 ftp 部署服务器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:32:36.367

考虑[`git-ftp`](https://github.com/resmo/git-ftp)为此使用。它只进行最少的上传，还能够镜像文件和目录删除。

# c# - 如何将每个项目创建为另一个列表？

> ID：16058104
> 
> 赞同：0
> 
> 时间：2013-04-17T10:52:14.487
> 
> 标签：c#, list, listitem

我正在尝试将一个列表项创建为另一个列表。我需要该列表每个项目都有另一个列表。我将字符串创建为一个循环的列表。下一个循环我需要将每个项目作为一个列表来根据范围插入数据。这个怎么做..？？

我的代码：

```
List<string> l = new List<string>(s.Split(';'));
foreach (string item in l) 
{
    if (item.Contains("-"))
    {    
        List<string> parts = new List<string>();
        int min = Int32.Parse(parts[0]);
        int max = Int32.Parse(parts[1]);
        for (int m = min; m <= max; m++)
        {
            // add the value in i to the data
            cmd = "insert into quickcom values('" + destination + "','" + codes + "','" + prefix + "','" + rate + "','" + level + "','" + m + "','" + effective_date + "','" + company_id + "')";

            cmd = ReplaceSpecialCharacters(cmd);

            MySqlCommand sqlCmd = new MySqlCommand(cmd, sqlCon);
            var i = sqlCmd.ExecuteNonQuery();
            cmd = "";
        }
    }
    else
    {
        if (item.Contains(";"))
        {
            List<string> parts = new List<string>(s.Split(';'));

            cmd = "insert into quickcom values('" + destination + "','" + codes + "','" + prefix + "','" + rate + "','" + level + "','" + s + "','" + effective_date + "','" + company_id + "')";

            cmd = ReplaceSpecialCharacters(cmd);

            MySqlCommand sqlCmd = new MySqlCommand(cmd, sqlCon);
            var i = sqlCmd.ExecuteNonQuery();
            cmd = "";
        }
    }
} 
```

帮帮我... thnx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:06:55.220

如果您有两个分隔符来打破每条记录和记录的每个项目，那么您可以直接获取字符串列表列表，如下所示

```
string s = "a2-b2-c2-d2-e2;a3-b4-c2-d2-e2";
var list  = s.Split(';').Select(s1 => s1.Split('-').ToList()).ToList(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:07:07.227

不确定你想要什么，`List<List<string>>`但这就是我的假设：

```
var l = new List<string>(s.Split(';'));
var aggregatedList = new List<List<string>>();

foreach (var item in l)
{
    if (item.IndexOf("-") > -1)
    {
        var a = item.Split('-').Select(n => int.Parse(n)).ToArray();
        var parts = Enumerable.Range(a[0], a[1]-a[0]+1).Select(i => i.ToString()).ToList();
        aggregatedList.Add(parts);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T10:57:24.417

初始化一个包含其他列表的列表：

```
List<List<string>> g = new List<List<string>>(); 
```

然后只需将您的“零件”添加到此列表中：

```
g.Add(parts); 
```

希望我理解正确！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T10:54:08.207

不确定这是否是您需要的，但您可以使用以下类型创建一个列表，其项目依次是字符串列表：`List<List<string>>`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T11:03:24.783

你上面的代码只是一部分，在我的电脑上不起作用。
所以我只是写一些评论：
1\. List parts = new List(); **零件**是这里从未使用过的变量。
2\. 我想查看**ReplaceSpecialCharacters**的详细信息。
3\. cmd = "insert into ... 最好换成**string.Format** ("insert into ..{0}..{1}",para0,para1...)
4\. List l = new List ( **s** .Split(';')); 如果您在此处列出一些字符串**s 的**示例，它会很有帮助。

# video - X264 解码器完整帧不在一个 NAL 单元中

> ID：16058109
> 
> 赞同：0
> 
> 时间：2013-04-17T10:52:35.983
> 
> 标签：video, h.264, libx264

我正在使用 libX264 库进行编码。编码后数据采用 NAL 单元（）的形式.....。这是我需要的相同格式（AVC），但问题是一帧来自两个 Nal 单元（一帧 =（长度，数据）+（长度，数据））并且我需要（一帧=（长度，数据）以单个最终单位）。当我转换为文件然后播放时，它首先显示屏幕的上部，然后显示下部。我的配置参数如下

```
param.i_width = 1680//;
param.i_height = 948;
param.i_fps_num = some no;
param.i_fps_den = 1;
param.i_keyint_max = 1 ;
param.rc.i_rc_method = //;
param.rc.f_rf_constant = //;
param.rc.f_rf_constant_max = //;
param.rc.b_mb_tree = 1;
param.rc.i_vbv_max_bitrate = ; // Convert to Kbps
param.rc.i_vbv_buffer_size = param.rc.i_vbv_max_bitrate / param.i_fps_num;
param.b_repeat_headers = 0;
param.b_annexb = 0; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-08T10:01:17.483

你可以发送你的编码器代码吗？通常你应该有以下代码：

```
naluSize=x264_encoder_encode(h, &nal, &i_nal, pic, &pic_out);
if(naluSize_size>0)
{
    memcpy(Framebuffer, nal[0].p_payload, frame_naluSize);
    FrameBufferSize= frame_naluSize;
} 
```

因此，您将在 Framebuffer 中拥有编码帧，其大小在 FrameBufferSize 中。这在我的应用程序中就像一个魅力。

另一个建议是不要触及任何你不知道的参数（至少在你解决问题之前）。只需使用

```
x264_param_default_preset(&param, "ultrafast", "zerolatency"); 
```

这将为您设置许多参数。当然，不要忘记设置分辨率:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-12T23:59:30.840

需要更多信息才能获得完整答案，但只是猜测。如果第一个 NALU 是 AUD（类型 9），您可以忽略它。或者不要通过设置 b_aud = 0 一开始就生成它们。

# game-center - 如何管理 Game Center 邀请自定义视图

> ID：16058115
> 
> 赞同：3
> 
> 时间：2013-04-17T10:52:51.870
> 
> 标签：game-center, invitation, gkturnbasedmatch

我正在为 iPhone/iPad IOS 6 开发基于回合的游戏。我以自己的观点管理我的 GameCenter 游戏中的不同游戏。它工作正常。我想知道是否可以管理用户邀请以我自己的观点玩游戏。如果这不可能，我想知道如何使用 Game Center 自定义视图来管理它。我想通过用户名邀请我的游戏中的玩家。

我读到用这种方法激活了邀请：

```
- (void)registerInvites {
    [GKMatchmaker sharedMatchmaker].inviteHandler = ^(GKInvite *acceptedInvite, NSArray *playersToInvite) {
        self.pendingInvite = acceptedInvite;
        self.pendingPlayersToInvite = playersToInvite;
        [delegate inviteReceived];
    };
} 
```

如何以我自己的视图发送邀请？如何管理我在自己的视图中收到的邀请？如何知道有人接受或拒绝我的邀请？

# c - 每次输入数字时，如何检查由连续用户输入提供的二进制数是否可被 5 整除？

> ID：16058119
> 
> 赞同：1
> 
> 时间：2013-04-17T10:53:05.467
> 
> 标签：c, binary

用户可以输入 0 或 1，将其附加到起始数字 0。

每次用户添加一个数字时，程序应该判断整数是否可以被 5 整除。

**例子：**

1.  第一个数字是 0。
2.  用户输入'1' - 完整的数字是'1' - 答案是否定的。
3.  用户输入'0' - 完整的数字是'10' - 答案是否定的。
4.  用户输入'1' - 完整的数字是'101' - 答案是肯定的。

我知道答案与最后一个余数和保留最后一个余数有关，但我找不到确切的计算或逻辑或数学来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T11:01:02.370

在伪代码中：

```
remainder=0
while true {
    remainder = remainder % 5
    if remainder = 0
        print "divisbile"
    else
        print "nondivisible"

    remainder = (remainder<<1) + inputBit
} 
```

解释：如果一个数能被 5 整除，则该数的倍数也能被 5 整除，因此该部分无意义。由于您的扩展可以建模为乘以 2 和加法，因此可以将其应用于您的问题。现在你要做的就是将余数相乘并添加输入并检查它是否可整除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:00:14.823

```
int old_x = 0,new_x;
    while(1)
    {
    scanf("%d",new_x);
    new_x= ((old_x<<1)|new_x);
    old_x = new_x ;
    new_x = new_x%5;
    if(!new_x)
    {
    printf("divisible by 5)
    old_x = 0;
    }
    else
    printf("not divisible by 5)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T12:21:16.707

诀窍是要知道一个数字是否可以被 5 整除，您只需要知道该数字的*最后一位十进制数字*。如果它以 5 或 0 结尾，那么它可以被 5 整除。如果它不以 5 或零结尾，它需要一个额外的数量，我称之为*余数*才能到达那里。现在鉴于您*有余数，您可以对数字的**最后一位*进行逆向工程。然后将*最后一位数字*移动2 并添加用户键入的新数字 ( *d* )。根据*d*，您将获得该数字的新最后一位。有了它，您可以再次看到必须添加什么 newremainder 才能获得下一个 5 的倍数。

![在此处输入图像描述](https://i.stack.imgur.com/WCTaL.png)

```
int newRemainder[2][5] = {{0,2,4,1,3},{4,1,3,0,2}};
int remainder = 0;
int d;

while(1){
   scanf("%d", &d);
   remainder = newRemainder[d][remainder];
   if (remainder ==0) printf("multiple");
} 
```

# javascript - 在服务器端处理 Ajax 调用并响应返回进行 ajax 调用的页面

> ID：16058139
> 
> 赞同：-1
> 
> 时间：2013-04-17T10:54:18.410
> 
> 标签：javascript, asp.net

我正在通过 ajax 调用向网页发送一些数据`javascript`。我已经成功地做到了这一点。现在我想要在服务器端做一些编程，比如获取数据并将数据存储在数据库中，然后发送响应可能是一些 weburl 链接等到发送 ajax 调用的页面。

我在客户端页面上的代码如下：

**page1.aspx**

```
 $.ajax({
        url: "www.abc.com/Page2.aspx?weburl=" + something+ "&ip_click=" + something+ "&src=" + source,
        type: "GET",
        complete: function (data) {

        } 
```

现在我在 page2.aspx 上得到了这个参数。现在我如何将响应从 page2.aspx 发送回 page1.aspx。请帮助我如何实现这一目标？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:38:42.840

您不能直接将数据从 ajax 调用发送到另一个页面。此数据将在响应回调（onComplete）中发送该调用的页面上可用。因此，如果您加载包含对 Page2.aspx 的 ajax 调用的 Page1.aspx，结果将到达 Page1.aspx（当前加载在浏览器中），而不是 Page2 和其他任何内容。服务器无法在不存在的页面上发送数据（oc 它可以使用该参数向该页面执行 http-request，但这是非常糟糕的方式）。

因此，即如果您有主页 Home.aspx 对 Page2 进行 ajax 调用：

```
$.ajax({
        url: "www.abc.com/Page2.aspx?weburl=" + something+ "&ip_click=" + something+ "&src=" + source,
        type: "GET",
        complete: function (data) {

        }
}); 
```

Page1 上需要该数据，您应该进行另一个调用（可能是 POST）：

```
$.ajax({
        url: "www.abc.com/Page2.aspx?weburl=" + something+ "&ip_click=" + something+ "&src=" + source,
        type: "GET",
        complete: function (data) {
             $.post("http://www.abc.com/Page1.aspx", data, function(result){});
        }
}); 
```

# sql-server-ce - Web 项目链接到 sql-server-ce 3.5 而不是 4.0

> ID：16058144
> 
> 赞同：0
> 
> 时间：2013-04-17T10:54:30.683
> 
> 标签：sql-server-ce

我在两台机器上构建的网络项目遇到问题。

第一个有：

*   .NET 4.0
*   Sql-Server-Ce 3.5 SP2 ENU
*   Sql-Server-Ce 3.5 SP2 x64 ENU
*   Sql-Server-Ce 4.0 SP1 x64 ENU CTP1

在 VisualStudio 中，我将 SqlServerCe 作为参考，作为版本 4.0.0.0。如果我检查生成的 dll（使用 ildasm 或 Reflector），我可以看到它引用了正确的 SqlServerCe 4.0 版本。

然后将此代码移动到单独的（构建）机器，其中包含：

*   .NET 4.0
*   Sql-Server-Ce 3.5 SP2 ENU
*   Sql-Server-Ce 3.5 SP2 x64 ENU
*   Sql-Server-Ce 4.0 x64 ENU

并被重建。但是，这一次，该 dll 链接到 SqlServerCe 的 3.5.1.0 版本。新机器上的 v4.0 sql-server 略有不同（x64 enu 与 sp1 x64 enu），但这不应该破坏构建，不是吗？

任何想法为什么新版本拒绝链接到 4.0 版本？我猜我缺少一些非常简单的东西，配置的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T20:17:24.700

在您的参考文献中使用特定版本 = true

# jquery - 带有自动生成的文本框的 JQuery 自动完成

> ID：16058146
> 
> 赞同：0
> 
> 时间：2013-04-17T10:54:36.477
> 
> 标签：jquery, autocomplete

我正在尝试将自动完成插件添加到在我的 jquery 代码中生成的文本框中，作为表格的一部分，但我什么也没得到。这是我的代码：

```
var spool = "<thead><tr><th>Α/Α</th><th>Ονομασία Ύλης</th><th>W/W%</th><th>Κωδ.Ύλης</th><th>Σχόλιο</th><th>Χρήση Συγκεκριμένης Ύλης</th><th>Ορθή Αναλογία</th><th>Ορθή Χρέωση</th><th>Ιδιοκτησία Ύλης</th><th>Προτεινομενος Προμηθευτής</th></thead>";
spool += "<tr><td>1</td><td><input type ='textbox' id = 'ingautotb' style = 'margin-left: -1px;margin-right: -1px;margin-top: -1px;margin-bottom: -1px;border: 0px;'></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>"
var a = ['a','av'];
$('#ingautotb').autocomplete({source:a}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:17:29.547

这里的问题是，您正在尝试使用尚未添加到 dom 的输入元素创建自动完成小部件。

尝试

```
var spool = "<thead><tr><th>Α/Α</th><th>Ονομασία Ύλης</th><th>W/W%</th><th>Κωδ.Ύλης</th><th>Σχόλιο</th><th>Χρήση Συγκεκριμένης Ύλης</th><th>Ορθή Αναλογία</th><th>Ορθή Χρέωση</th><th>Ιδιοκτησία Ύλης</th><th>Προτεινομενος Προμηθευτής</th></thead>";
spool += "<tr><td>1</td><td><input type ='textbox' id = 'ingautotb' style = 'margin-left: -1px;margin-right: -1px;margin-top: -1px;margin-bottom: -1px;border: 0px;'></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>";

//insert spool to dom ex
//$('#mycontainer').append(spool)

var a = ['a','av'];
$('#ingautotb').autocomplete({source:a}); 
```

# dbus - dbus 服务器总是调用名称丢失的回调。它没有与守护进程进行会话

> ID：16058147
> 
> 赞同：2
> 
> 时间：2013-04-17T10:54:37.117
> 
> 标签：dbus

对 DBus 有疑问。我在我的 linux 电脑中安装了 d-bus 并使用终端。然后我做了 dbus-launch 以在会话模式下运行 dbus 守护进程。我在 gio、glib dbus 库的帮助下编写了 dbus 服务器代码。

Dbus 服务器代码将尝试使用会话类型和唯一众所周知的名称调用 g_dbus_own_name api，并且它将有两个回调（获取名称和丢失名称）。但它总是调用名称丢失的回调。

我不知道我错过了什么。请任何人知道创建 dbus 服务器的步骤。我确信我的代码是正确的。那只是简单的服务器将调用 g_dbus_own_name api。

# ./myserver 如果我这样运行.. 我猜它无法与守护进程连接..

我不知道..

请帮我。

# sharepoint - SharePoint：如何使用 PowerShell 解决/搜索声明？

> ID：16058148
> 
> 赞同：1
> 
> 时间：2013-04-17T10:54:44.413
> 
> 标签：sharepoint, search, resolve, claims

我有一个 SharePoint (2010) Web 应用程序，它设置了基于声明的身份验证，以及两个声明提供程序（Azure ACS 和 ADFS）。从 SP Central Admin -> Manage Web Applications -> User Policy -> Add Users，我可以在不同的身份提供者中搜索用户（我相信该控件称为“People Picker”）。

是否可以使用与 PowerShell 中的人员选择器类似的功能？

原则上，我需要的是这样的：

```
$claim = Resolve-Claim "alice.bob@gmail.com" 
```

通过搜索添加到 SharePoint 的所有声明提供程序，这将返回“完全限定”用户名（包括声明前缀），例如 i:05.t|acs|alice.bob@gmail.com。

这可能吗？或者至少，是否可以枚举索赔提供者，并单独搜索每个（这也是可以接受的）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T06:12:51.317

我找到了某种解决方案...

```
$claimManager = New-Object Microsoft.SharePoint.Administration.Claims.SPClaimProviderManager

$providers = @()

foreach ($cp in $claimManager.TrustedClaimProviders)
{
    $providers += $cp
}
$provider = $providers[0]
$userId = $provider.Search("http://localhost", $null, $UserName, $null, 1).Children[0].EntityData[0].Key 
```

此解决方案的主要问题：

通过例如 Azure ACS 的提供者实际上并不搜索以查看用户 ID 是否存在，而只是返回一个声明。这给了我这个 ID 提供者的前缀，但我不知道它是否有效，因此我不知道是否应该继续搜索其他 ID 提供者，或者我是否应该停止。

但我不确定这是否是 ACS 中的配置问题，或者是否是 SharePoint 中身份提供者的 Search 方法实施中的固有弱点。

# vb.net - 在 VB.NET 中 do while 和 while 有什么区别？

> ID：16058154
> 
> 赞同：20
> 
> 时间：2013-04-17T10:55:25.017
> 
> 标签：vb.net, loops, while-loop, do-while

语句是循环块中的第一行的**Do While**与 VB.NET中的单个**While**有什么区别？

他们似乎没有提供任何行为差异。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-17T13:03:24.277

**在 Visual Basic**中，这些是相同的：

```
 Dim foo As Boolean = True

    While Not foo
        Debug.WriteLine("!")
    End While

    Do While Not foo
        Debug.WriteLine("*")
    Loop 
```

这些不是；执行`do`一次：

```
 Dim foo As Boolean = True

    While Not foo
        Debug.WriteLine("!")
    End While

    Do
        Debug.WriteLine("*")
    Loop While Not foo 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-17T03:57:15.163

在**DO...WHILE**中，循环内的代码**至少执行一次**

在**WHILE**循环中，循环内的代码被执行**0 次或多次**。

* * *

## 回答 #3

> 赞同：-6
> 
> 时间：2013-04-17T10:59:14.297

`Do While`首先执行，然后检查是否有效。`While`先检查再执行。

```
while (1!=1){ echo 1} 
```

什么都不会输出

但

```
do{echo 1} while (1!=1) 
```

将输出 1 一次。

# r - ggplot2 数据框结构条形图与误差条

> ID：16058156
> 
> 赞同：-2
> 
> 时间：2013-04-17T10:55:26.350
> 
> 标签：r, ggplot2, dataframe

我得到了一个包含 14 个主题的 10 个度量的数据集，我想在 ggplot2 中制作一个包含每个主题的平均分数和误差条（置信区间）的条形图。但我不确定如何塑造数据以便能够制作这样的图。

任何指示或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:40:51.490

`ggplot2`需要长格式的数据。这意味着每个数据点必须位于不同的行上。您想要计算 14 个受试者的平均值和 CI。因此，您应该有一个包含主题、平均值和 CI 列以及 14 行的 data.frame。这是两个主题的示例：

```
set.seed(1)
dat <- data.frame(Subject = c(rep("Sub1", 10), rep("Sub2", 10)),
Measure = rep(paste0("Meas", 1:10),2),
Value = rnorm(20,15,3)) 

library(plyr)
se <- function(x) sd(x)/sqrt(length(x))
dat.new <- ddply(dat, .(Subject), summarize, mean = mean(Value), 
CI = qnorm(0.975)*se(Value))

dat.new
# Data format for ggplot
#  Subject     mean       CI
#1    Sub1 15.39661 1.686627
#2    Sub2 15.74653 1.974250

library(ggplot2)

ggplot(dat.new, aes(x = Subject, y = mean, ymin = mean, ymax = mean + CI)) +
geom_bar(stat="identity") + geom_errorbar(width=0.25) 
```

![在此处输入图像描述](https://i.stack.imgur.com/udjGy.png)

有关详细信息，请参阅[ggplot2 文档](http://docs.ggplot2.org/current/)、有关[ggplot2 条形图](https://stackoverflow.com/search?q=barplot%20ggplot)和[误差](https://stackoverflow.com/search?q=error%20bar%20ggplot)线的其他问题。

# c++ - QT4 settext() 与 lineEdits 数组

> ID：16058162
> 
> 赞同：0
> 
> 时间：2013-04-17T10:55:45.597
> 
> 标签：c++, arrays, qt4, line, edit

我有一个 lineEdits 数组：

```
QLineEdit *cells[81]; 
```

但是当我尝试在其中设置文本时，我得到了一个段错误：

```
cells[i]->setText(QString::number(i)); 
```

如何访问这些元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T09:35:32.530

解决它。我设置了私有数组，然后在本地范围内重新声明了它。不知怎的，这并没有发出警告......

# c# - 获取文件夹的根目录 +1

> ID：16058164
> 
> 赞同：12
> 
> 时间：2013-04-17T10:56:00.730
> 
> 标签：c#, .net

如何获取文件夹+1的根目录？

示例：输入：`C:\Level1\Level2\level3` 输出应为：

```
Level1 
```

如果输入是`Level1` 输出应该是`Level1`

如果输入是 C:\ 输出应该是`empty string`

是否有一个.Net函数处理这个？

`Directory.GetDirectoryRoot`总会回来的`C:\`

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-17T11:03:21.477

您可以使用`Path`-class ++`Substring`删除`Split`根目录并获取顶级文件夹。

```
// your directory:
string dir = @"C:\Level1\Level2\level3";     

// C:\  
string root = Path.GetPathRoot(dir); 

// Level1\Level2\level3:
string pathWithoutRoot = dir.Substring(root.Length);       

// Level1
string firstFolder = pathWithoutRoot.Split(Path.DirectorySeparatorChar).First(); 
```

另一种方法是使用[`DirectoryInfo`](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.aspx)类及其[`Parent`](http://msdn.microsoft.com/en-us/library/system.io.directoryinfo.parent.aspx)属性：

```
DirectoryInfo directory = new DirectoryInfo(@"C:\Level1\Level2\level3");
string firstFolder = directory.Name;
while (directory.Parent != null && directory.Parent.Name != directory.Root.Name)
{
    firstFolder = directory.Parent.Name;
    directory = directory.Parent;
} 
```

但是，我更喜欢“轻量级”字符串方法。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-17T11:04:42.567

```
string dir = @"C:\foo\bar\woah";
var dirSegments = dir.Split(new char[] { Path.DirectorySeparatorChar }, 
                            StringSplitOptions.RemoveEmptyEntries);
if (dirSegments.Length == 1)
{
    return string.Empty;
}
else
{
    return dirSegments[0] + Path.DirectorySeparatorChar + dirSegments[1];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T11:10:06.413

通过将下面的代码部分添加到方法中，您可以使用以下结构循环使用目录信息类

```
string path = "C:\Level1\Level2\level3";
DirectoryInfo d = new DirectoryInfo(path);
while (d.Parent.FullName != Path.GetPathRoot(path))
{
    d = d.Parent;
}
return d.FullName; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T11:42:38.603

你可以使用`DirectoryInfo`和一个`while`循环。

```
DirectoryInfo info = new DirectoryInfo(path);
while (info.Parent != null && info.Parent.Parent != null)
    info = info.Parent;
string result = info.FullName; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T11:01:13.367

一种可能的解决方案，但可能不是最好的，是找到@“\”的位置，并自己进行一些手动处理。下面的代码没有经过全面测试，只是片段：

```
//var positions = inputString.IndexOfAny(new [] {'\'});  //Original one
//Updated, thanks to Snixtor's implementation 
var positions = inputString.IndexOfAny(new [] {Path.DirectorySeparatorChar}); 
int n=positions.Length;
if(n>=1)
{
     var pos = positions[1];  //The 2nd '\';
     return inputString.SubString(0, pos);
}
return null; 
```

当然，这仅在我们确定要在第二个“\”之后截断子字符串时才有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-17T11:03:22.117

不确定这是否是正确的方法，但你这样做：

```
string s = @"C:\Level1\Level2\Level3";
string foo = s.split(@"\")[1]; 
```

不确定 DirectoryInfo 对象是否可以以更清晰的方式获取此信息。

```
DirectoryInfo di = new DirectoryInfo(@"C:\Level1\Level2\Level3");
di.Root; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-17T11:14:14.547

一个快乐的 linq 一个班轮：

```
string level1_2 = Directory.GetDirectoryRoot(path) + path.Split(Path.DirectorySeparatorChar).Skip(1).Take(1).DefaultIfEmpty("").First(); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-17T11:14:15.500

```
 var di = new System.IO.DirectoryInfo(@"C:\a\b\c");
  Func<DirectoryInfo, DirectoryInfo> root = null;
  root = (info) => info.Parent.FullName.EndsWith("\\") ? info : root(info.Parent);
  var rootName = root(di).Name; //#a 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-04-17T11:42:25.857

为什么不只使用`System.IO.Path`来检索名称？

```
MessageBox.Show(System.IO.Path.GetFileName(
    System.IO.Path.GetDirectoryName(
        System.IO.Path.GetDirectoryName(@"C:\Level1\Level2\Level3")
    )
)); 
```

这返回`Level 1`。

```
MessageBox.Show(System.IO.Path.GetFileName(
    System.IO.Path.GetDirectoryName(
        System.IO.Path.GetDirectoryName(@"C:\")
    )
)); 
```

这将返回空字符串。

# ios - 为什么GCDAsyncSocket连接在设备锁定时被终止，但在按下主页按钮时没有？

> ID：16058168
> 
> 赞同：4
> 
> 时间：2013-04-17T10:56:11.827
> 
> 标签：ios, objective-c, tcp, cocoaasyncsocket

这发生在设备上而不是模拟器上。我打开我的应用程序并使用 GCDAsyncSocket 连接到服务器。当我按下主页按钮，将应用程序置于后台，然后切换回应用程序时，套接字仍然连接。这里没问题。

但是如果我真的**锁定**了设备然后解锁它，即使是马上，插座也会断开。`- (void)socketDidDisconnect:(GCDAsyncSocket *)sock withError:(NSError *)err {`委托方法的错误说...

> 错误：错误域 = GCDAsyncSocketErrorDomain 代码 = 7“远程对等方关闭的套接字” UserInfo = 0x20051cb0 {NSLocalizedDescription =远程对等方关闭的套接字}

我检查了服务器，没有明确破坏连接的代码。我认为这是与 iOS 相关的事情，当应用程序发送到后台时会终止连接。**但是，我想知道是不是因为应用程序被发送到后台，那么为什么主页按钮不会终止连接但锁定设备呢？**

有没有什么办法解决这一问题？

**===== 当前进展 =====**

似乎没有解决方案。现在作为一种解决方法。如果它意外断开连接，我只是重新连接。将保持这个问题悬而未决，希望奇迹出现。;)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T11:19:28.670

查看 Apple 的文档[“App States and Multitasking”](http://developer.apple.com/library/ios/#documentation/iphone/conceptual/iphoneosprogrammingguide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html)：

> 准备好处理基于网络的套接字中的连接故障。当您的应用因多种原因暂停时，系统可能会断开套接字连接。只要您的基于套接字的代码为其他类型的网络故障（例如丢失信号或网络转换）做好准备，就不会导致任何异常问题。当您的应用程序恢复时，如果它在使用套接字时遇到故障，只需重新建立连接。

当您锁定设备时，iOS 可能会决定随时拆除套接字。我做了不同的体验，有些socket会保持打开一段时间，但它们迟早会关闭。您必须通过捕获“应用程序将移至后台”/“应用程序将移至前台”状态更改通知来处理它。

一种解决方法是将您的应用程序声明为 VoIP 应用程序。这将允许您保持连接打开。但是，如果您的应用程序没有真正实现 VoIP 功能并且您想将其提交到应用程序商店，您将面临被拒绝的风险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-23T14:10:22.263

您需要在套接字上启用后台：**无需**`App provides Voice over IP services`在 info.plist中添加密钥

```
- (void)socket:(GCDAsyncSocket *)socket didConnectToHost:(NSString *)host port:(UInt16)port {

    NSLog(@"Socket Did Connect to Host: %@ Port: %hu", host, port);

    //allow socket to operate when the iOS application has been backgrounded
    [self.socket performBlock:^{
        [self.socket enableBackgroundingOnSocket];
    }];
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-17T11:44:42.207

您应该按照此处所述尝试为您的应用程序后台执行：[当 iOS 应用程序进入后台时，冗长的任务是否暂停？](https://stackoverflow.com/questions/6650717/when-an-ios-application-goes-to-the-background-are-lengthy-tasks-paused)

# iphone - 在特定日期显示本地通知

> ID：16058175
> 
> 赞同：0
> 
> 时间：2013-04-17T10:56:30.203
> 
> 标签：iphone, ios, objective-c, notifications, nsdatecomponents

今天的日期是 2013-04-17 10:39:00 +0000。现在我从表中选择工作日来设置当天的时间表（警报）。我想永远在选定的日子显示本地通知警报。但我遇到了问题。

这是我的代码：

```
-(IBAction)setDays{
NSDate *date1=[df dateFromString:time123];  //2013-04-17 10:39:00 +0000
 NSCalendar *calendar = [NSCalendar autoupdatingCurrentCalendar];
            NSDateComponents *components = [calendar components:NSUIntegerMax fromDate:date1];
             NSDateComponents *timeComponents = [calendar components:( NSHourCalendarUnit | NSMinuteCalendarUnit | NSSecondCalendarUnit ) 
             fromDate:date1];
            [components setHour:[timeComponents hour]]; 
            [components setMinute:[timeComponents minute]];
            [components setSecond:0];

            NSString *su=@"false";
            NSString *mo=@"false";
            NSString *tu=@"false";
            NSString *we=@"false";
            NSString *th=@"false";
            NSString *fr=@"false";
            NSString *sa=@"false";
            if ([[selectedDays objectAtIndex:0] isEqualToString:@"1"]) {
                su=@"true";
                [components setWeekday:1];
                NSDate *itemDate = [calendar dateFromComponents:components];
                NSLog(@"date1 %@",itemDate);
                [appDelegate scheduleNotification:@"hi shiv" repeatDaily:YES fireDate:itemDate forKey:@"1"];
            }
            if ([[selectedDays objectAtIndex:1] isEqualToString:@"1"]) {
                mo=@"true";
                [components setWeekday:2];
                NSDate *itemDate = [calendar dateFromComponents:components];
                NSLog(@"date2 %@",itemDate);
                [appDelegate scheduleNotification:@"hi shiv" repeatDaily:YES fireDate:itemDate forKey:@"2"];
            }
            if ([[selectedDays objectAtIndex:2] isEqualToString:@"1"]) {
                tu=@"true";
                [components setWeekday:3];
                NSDate *itemDate = [calendar dateFromComponents:components];
                NSLog(@"date3 %@",itemDate);
                [appDelegate scheduleNotification:@"hi shiv" repeatDaily:YES fireDate:itemDate forKey:@"3"];
            }
            if ([[selectedDays objectAtIndex:3] isEqualToString:@"1"]) {
                we=@"true";
                [components setWeekday:4];
                NSDate *itemDate = [calendar dateFromComponents:components];
                NSLog(@"date4 %@",itemDate);
                [appDelegate scheduleNotification:@"hi shiv" repeatDaily:YES fireDate:itemDate forKey:@"4"];
            }
            if ([[selectedDays objectAtIndex:4] isEqualToString:@"1"]) {
                th=@"true";
                [components setWeekday:5];
                NSDate *itemDate = [calendar dateFromComponents:components];
                NSLog(@"date5 %@",itemDate);
                [appDelegate scheduleNotification:@"hi shiv" repeatDaily:YES fireDate:itemDate forKey:@"5"];
            }
            if ([[selectedDays objectAtIndex:5] isEqualToString:@"1"]) {
                fr=@"true";
                [components setWeekday:6];
                NSDate *itemDate = [calendar dateFromComponents:components];
                NSLog(@"date6 %@",itemDate);
                [appDelegate scheduleNotification:@"hi shiv" repeatDaily:YES fireDate:itemDate forKey:@"6"];
            }
            if ([[selectedDays objectAtIndex:6] isEqualToString:@"1"]) {
                sa=@"true";
                [components setWeekday:7];
                NSDate *itemDate = [calendar dateFromComponents:components];
                NSLog(@"date7 %@",itemDate);
                [appDelegate scheduleNotification:@"hi shiv" repeatDaily:YES fireDate:itemDate forKey:@"7"];
            }
} 
```

在 AppDelegate.m

```
-(UILocalNotification * )scheduleNotification:(NSString *)remainderText repeatDaily:(BOOL )isRepeat fireDate:(NSDate *)fireDate forKey:(NSString*)key{

    Class cls = NSClassFromString(@"UILocalNotification");
    UIApplication *app = [UIApplication sharedApplication];
    if (cls != nil) {
        NSLog(@"in set local notification");
        UILocalNotification *notif = [[cls alloc] init];
        notif.fireDate = fireDate;

        if (isRepeat == FALSE) {

            notif.repeatInterval = 0;

        } else {
            notif.soundName = UILocalNotificationDefaultSoundName;
            notif.repeatInterval = NSWeekCalendarUnit;
        }

        notif.timeZone = [NSTimeZone defaultTimeZone];
        notif.alertBody = remainderText;
        notif.alertAction = @"Show me";
        notif.soundName = UILocalNotificationDefaultSoundName;

        notif.userInfo = [NSDictionary dictionaryWithObjectsAndKeys:@"shiv",key, nil];

                                   [app scheduleLocalNotification:notif];
                                   NSLog(@"Added an event with ");
                                         return notif;

    }
    return nil;
} 
```

# android - 使用多个帐户进行 Android APK 扩展测试

> ID：16058177
> 
> 赞同：0
> 
> 时间：2013-04-17T10:56:36.787
> 
> 标签：android, apk-expansion-files, android-account

我的应用程序是一个付费应用程序，它也使用 apk 扩展库。

为了测试，我在我的开发者控制台中添加了一个测试帐户说

xyz@gmail.com

当我使用首先在上述帐户注册的设备进行测试时，它按预期工作（下载了扩展文件）。

但是当我将签名的 apk 安装到已经注册的设备上时出现了问题

abc@gmail.com

我在安装签名 apk 之前添加了 xyz@gmail.com 帐户，作为清单，我确保 Gmail 和 Google Play 可以正常使用此帐户。

但是在运行应用程序时，我得到了错误

“下载失败，因为您可能尚未购买该应用程序”。

在上述情况下我应该怎么做才能测试应用程序？我需要删除 abc@gmail.com 吗？或者有什么解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T12:21:47.667

它已经完成并且是最终的。

Android LVL aka Licensing 验证库仅获取`primary account`（您首先为您的设备注册的 Google 帐户）才能使用。

引用android的原始[文档](http://developer.android.com/google/play/licensing/overview.html)

> Google Play 客户端收集有关用户和设备的必要信息，例如设备的**主要 Google 帐户用户名**、IMSI 和其他信息。然后它代表您的应用程序将许可证检查请求发送到服务器。

# jquery - 缓存为空时获取音频文件的持续时间属性的问题

> ID：16058178
> 
> 赞同：1
> 
> 时间：2013-04-17T10:56:36.990
> 
> 标签：jquery, html, audio, mp3, metadata

我在获取音频/mpeg (mp3) 的元数据时遇到问题。

例如，我使用 JS 来获取音频文件的持续时间，当缓存为空时，持续时间值返回“Infinity”（NaN）。

我尝试过使用事件/属性 preload 和 onloadedmetadata 并且总是当缓存为空时我无法获得音频的持续时间和其他属性。

注意：问题仅出现在我清理缓存时（或访问者第一次访问页面时）。

```
 audioElement = new Audio('http://www.html5rocks.com/en/tutorials/audio/quick/test.mp3');
    console.log(audioElement);
    audioElement.addEventListener("loadedmetadata", function(_event) {
    var duration = audioElement.duration;
    console.log( duration );
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-07T08:37:37.243

也许是因为您的媒体正在流式传输？

请参阅[https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement](https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement)

> duration 只读 double
> 媒体的长度（以秒为单位），如果没有可用的媒体数据，则为零。如果媒体数据可用但长度未知，则该值为 NaN。 *如果媒体是流媒体并且没有预定义的长度，则值为 Inf*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-14T12:27:33.960

```
audioElement = new Audio('http://www.html5rocks.com/en/tutorials/audio/quick/test.mp3');
    console.log(audioElement);
    audioElement.addEventListener("loadedmetadata", function(_event) {
    var duration = audioElement.duration;
    console.log( duration );
}); 
```

# javascript - 在网页上，如何显示在悬停时更改为下拉框的标签

> ID：16058179
> 
> 赞同：-1
> 
> 时间：2013-04-17T10:56:36.943
> 
> 标签：javascript, jquery, css

我想在屏幕上看到一个标签，当鼠标指针悬停在它上面时，它会变成一个下拉列表。

我有以下

```
<div class="sizeit"> 
    <select id="SelectUrgency" class="invisible">
        <option value="3">Non Urgent</option>
        <option value="2">Urgent</option>
        <option value="1">System Down</option>
    </select>
    <label>test</label>
<div> 
```

使用以下CSS

```
.invisible {
    visibility: hidden;
    position: absolute;
    top: -9999px;
}
.visible {
    visibility: visible;
    position: static;
}
.sizeit {
    width: 100px;
    height: 440px;
    border: 1px solid black;
} 
```

和下面的javascript

```
$("div").hover(  function () {    $(this).find("label:first").remove();  },  
              function () {    $(this).append($("<label>test</label>"));  });

$("div.sizeit").mouseover(function(){
        $(this).find("select:first").addClass("visible");
    }).mouseout(function(){
        $(this).find("select:first").removeClass("visible");    
        $(this).find("select:first").addClass("invisible"); 
    }); 
```

这几乎可以工作，但是当单击下拉框时，我无法选择一个项目。有谁知道如何解决这个问题，以便可以选择下拉框项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:07:34.557

试试这个小提琴：http: [//jsfiddle.net/aKh5x/](http://jsfiddle.net/aKh5x/)

HTML：

```
<div class="sizeit"> 
<select id="SelectUrgency" class="invisible">
    <option value="3">Non Urgent</option>
    <option value="2">Urgent</option>
    <option value="1">System Down</option>
</select>
<label>test</label> 
```

CSS：

```
.sizeit > select {
    display:none;
}
.sizeit > label {
    display:block;
}
.sizeit > select:focus, .sizeit:hover > select {
    display:block;
}
.sizeit > select:focus + label, .sizeit:hover > label {
    display:none;
} 
```

:focus 规则将防止选择框消失。

希望这对您来说是一个很好的解决方案

# ios - BButton & CGGradient 发布 - 内存泄漏

> ID：16058180
> 
> 赞同：0
> 
> 时间：2013-04-17T10:56:42.267
> 
> 标签：ios, xcode, memory-leaks, core-graphics

我正在使用 BButton ( [https://github.com/jessesquires/BButton](https://github.com/jessesquires/BButton) ) 在 UICollectionView 的单元格中绘制一些漂亮的按钮。当我刷新 UICollectionView 的数据时，我记录了一些内存泄漏（CollectionView 中每个单元格一个泄漏的对象）。我已经使用工具将其追溯到在“BButton.m”中创建的 CGGradient：

```
gradient = CGGradientCreateWithColors(colorSpace, (__bridge CFArrayRef)newGradientColors, newGradientLocations);
CGColorSpaceRelease(colorSpace); 
```

我知道 CGGradients 应该被释放（ CGGradientRelease() ），但是我不确定在哪里释放它，我尝试了几个位置（在绘制按钮之后，在 init 方法中返回之前）但我仍然得到同样的问题。

一切都在 IB 中完成，按钮和单元格不是以编程方式创建的。

任何帮助将不胜感激，我快把头发扯掉了！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:36:04.653

我假设您正在使用 ARC。如果你是我认为你的问题是你的 CFArrayRef 没有转移所有权。我找到[了这篇文章](https://stackoverflow.com/questions/12285231/how-to-convert-cfarrayref-to-nsarray)，所以我不需要重复我的意思。

# java - Eclipse撤消对项目的更改到特定时间？

> ID：16058185
> 
> 赞同：10
> 
> 时间：2013-04-17T10:56:54.390
> 
> 标签：java, eclipse

是否可以在特定时间之前撤消对项目的更改？比如说，将项目恢复到原来的样子`1:00pm`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-17T10:58:44.540

在 Eclipse 的编辑器中，执行此操作，**右键单击 -> 替换为 -> 本地历史...**

从**Revision Time**中的条目列表中，选择您想要的修订，比较更改，如果它们看起来不错，请替换它。

完毕！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-10T02:09:51.147

右键单击项目文件夹，选择“从本地历史记录恢复...”检查您想要恢复的文件。这本身不会撤消提取，但它会取回您的文件。

# java - 使用 POI 解析相交的名称范围

> ID：16058186
> 
> 赞同：0
> 
> 时间：2013-04-17T10:56:58.623
> 
> 标签：java, apache, apache-poi

我在解析包含与 apache-poi 相交名称范围的公式时遇到问题。
例如，如果我尝试解析像“=SUM((Total_Cost!Jan):(Total_Cost!Apr_))”这样的公式，其中 Total_Cost、Jan 和 Apr_ 是重叠的名称范围，我会收到以下异常：

线程“主”org.apache.poi.ss.formula.FormulaParseException 中的异常：在指定公式“SUM((Total_Cost Jan):(Total_Cost Apr_))”中的 char 16 'J' 附近解析错误。org.apache.poi.ss.formula.FormulaParser.Match(FormulaParser.java:251) 的 org.apache.poi.ss.formula.FormulaParser.Match(FormulaParser.java:251) 的预期 ')' .poi.ss.formula.FormulaParser.parseSimpleFactor(FormulaParser.java:1108) 在 org.apache.poi.ss.formula.FormulaParser.percentFactor(FormulaParser.java:1079) 在 org.apache.poi.ss.formula.FormulaParser .powerFactor(FormulaParser.java:1066) 在 org.apache.poi.ss.formula.FormulaParser.Term(FormulaParser.java:1426) 在 org.apache.poi.ss.formula.FormulaParser.additiveExpression(FormulaParser.java:1526) ) 在 org.apache。

有没有人遇到过这种问题？解析器只是无法解析这样的公式还是我做错了什么？除了编写我自己想要避免的解析器之外，我没有任何想法可以解决这个问题......

# git - 让 git 忽略 PDF 文件中的日期

> ID：16058187
> 
> 赞同：7
> 
> 时间：2013-04-17T10:57:00.180
> 
> 标签：git

首先：我知道一般评论：不要跟踪生成的文件。

说，我想跟踪生成的 PDF 并让 git 忽略写入 PDF 的日期。这意味着，如果唯一的区别是日期信息，我希望 git 将两个 PDF 视为相同。

我尝试的是一个过滤器——在它的干净部分——将日期设置为任意值。

（---评论----
基本上，过滤器会做某事：

```
## dump the pdf metadata to a file and replace the dates
pdftk "$FILENAME" dump_data | sed -e '{N;s/Date\nInfoValue: D:.*/Date\nInfoValue: D:19790101072619/}' > "$TMPFILE"

## update the pdf metadata
pdftk "$FILENAME" update_info "$TMPFILE" output "$TMPFILE2" 
```

) --- 结束评论 ----

过滤器有效（提交的 pdf 将日期设置为我的任意值），但我遇到[了从 git 存储库重新签出的文件，并使用“干净”过滤器结束了修改状态](https://stackoverflow.com/questions/13294354/files-re-checked-out-from-git-repository-with-clean-filter-end-up-with-modifie)

所以，我的过滤器显然不是我想要在这里做的。

我的问题是：
1）我可以使用巧妙的过滤方法让 git 完全忽略 PDF 中的日期值吗？如何？
或
2）如果没有过滤器，正确的方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-18T18:34:40.900

最后在 git 邮件列表的帮助下解决了这个问题。毕竟不是 git 问题，而是我过滤器对 pdftk 的期望的问题。（也许是编码的东西？没有深入挖掘。）

git 邮件列表上的有用信息在这里： http: [//permalink.gmane.org/gmane.comp.version-control.git/224797](http://permalink.gmane.org/gmane.comp.version-control.git/224797)

基本上，我编写的过滤器脚本不是幂等的，这意味着再次将干净的过滤器应用于已清理的文件会更改文件。

背景：当 pdftk 用于使用它之前从该确切 pdf 中提取的元数据更新 pdf 的元数据时，令我惊讶的是它会更改 pdf 文件。

因此，我在过滤器中加入了安全检查，问题就消失了。

作为参考，这里是完整的过滤器：

```
 #!/bin/bash

 ## use GNU coreutils on OS X explicitely
 ## (install via homebrew, for instance:
 ##  > brew install coreutils
 ##  > brew install gnu-sed
 ## )
 if [ ${OSTYPE:0:6} == "darwin" ]; then
     MKTMP=gmktemp
     SED=gsed
 else
     MKTMP=mktemp
     SED=sed
 fi

 FILEASARG=true
 if [ "$#" == 0 ]; then
     FILEASARG=false
 fi

 if $FILEASARG ; then
     FILENAME="$1"
 else
     FILENAME=`$MKTMP`
     cat /dev/stdin > "${FILENAME}"
 fi

 TMPFILE=`$MKTMP`
 TMPFILE2=`$MKTMP`
 TMPFILE3=`$MKTMP`

 ## dump the pdf metadata to a file and replace the dates
 pdftk "$FILENAME" dump_data > "$TMPFILE3"
 $SED -e '/Date/{ N; s/Date\nInfoValue: D:.*/Date\nInfoValue: D:19790101072619/ }' < "$TMPFILE3" > "$TMPFILE"

 ## if the metadata did not change, do nothing
 if diff "$TMPFILE3" "$TMPFILE"; then
     rm "$TMPFILE3"
     rm "$TMPFILE"
     if [ -n $FILEASARG ] ; then
    cat "$FILENAME"
     fi
     exit 0
 fi

 ## update the pdf metadata
 pdftk "$FILENAME" update_info "$TMPFILE" output "$TMPFILE2"

 ## overwrite the original pdf
 mv -f "$TMPFILE2" "$FILENAME"

 ## clean up
 rm -f "$TMPFILE"
 rm -f "$TMPFILE2"
 if [ -n $FILEASARG ] ; then
     cat "$FILENAME"
 fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T13:26:06.240

如果您可以控制 PDF 的生成，则可以考虑在生成时将 PDF 文件内容的哈希值注入 pdf 关键字中。此哈希将唯一标识 PDF 文件，而不考虑日期字段。

然后在 git 方面，您可以[在 .gitattributes 中使用一些东西](http://git-scm.com/book/ch7-2.html)（在 pdf 文件上使用[extract -p 关键字](http://linux.die.net/man/1/extract)）来对 pdf 文件进行二进制差异。

我想这可能会奏效。

# oracle - 指定日期范围内字段的总和

> ID：16058188
> 
> 赞同：-2
> 
> 时间：2013-04-17T10:57:04.237
> 
> 标签：oracle, plsql, sql-date-functions

我需要以下帮助 - 请帮助。

![示例图像](https://i.stack.imgur.com/ODomo.png)

如何总结日期范围。？？我是 Oracle 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T13:57:38.480

在评论中，您说您指定了两组不重叠的日期。这与您在问题中发布的数据相矛盾。由于您无法以清晰简单的方式解释您的需求，因此有几个人浪费了时间提出非解决方案。

无论如何，假设你终于明白了你的故事并且两组不重叠，这应该适合你：

```
with data as (
    select field1
           , field2
           , field4
           , case when field3 between date '2011-10-30' and date '2012-01-28' then 'GR1' 
                  when field3 between date '2012-10-28' and date '2013-02-03' then 'GR2'
                  else null
             end as GRP
    from your_table )
select field1
       , field2
       , GRP
       , sum(field4) as sum_field4
from data
where GRP is not null
order by 1, 2, 3
/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T12:03:27.317

原始答案的评论部分中的问题/答案表明您实际上正在寻找两个不同的选择 - 一个用于第一个日期范围，一个用于重叠的第二个日期范围。只有您想在单个结果集中获取所有结果记录。您可以为此使用 UNION：

```
select field1, field2, min(trunc(field3))) || '-' || max(trunc(field3))), sum(field4)
from yourtable
where to_char(field3, 'yyyymmdd') between '20130201' and '20130204'
group by field1, field2
UNION
select field1, field2, min(trunc(field3))) || '-' || max(trunc(field3))), sum(field4)
from yourtable
where to_char(field3, 'yyyymmdd') between '20130203' and '20130207'
group by field1, field2
order by 1, 2, 3; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T11:47:49.890

使用硬编码日期有点奇怪，就像您制作范围的方式一样（并且您的`field4`值在示例输出中似乎是错误的），但假设您知道自己想要什么......

您可以使用`case`语句根据日期为行分配一个虚拟组号，然后使用一个外部查询来`group by`针对该虚拟字段，我称之为`gr`：

```
select field1, field2,
    to_char(min(field3), 'MM/DD/YYYY')
        ||'-'|| to_char(max(field3), 'MM/DD/YYYY') as field3,
    sum(field4) as field4
from (
    select field1, field2, field3, field4,
        case when field3 between date '2013-02-01'
                and date '2013-02-05' - interval '1' second then 1
            when field3 between date '2013-02-05'
                and date '2013-02-08' - interval '1' second then 2
        end as gr
    from t42
)
group by field1, field2, gr
order by field1, field2, gr;

F     FIELD2 FIELD3                    FIELD4
- ---------- --------------------- ----------
A          1 02/01/2013-02/04/2013         14
A          1 02/05/2013-02/07/2013         21 
```

如果某个边界日没有数据，则显示`field3`将看起来错误，但我不确定这是这种方法的最大问题 *8-)

您可以修改`case`以拥有更多通用组，但我不确定如何使用它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T11:16:13.173

尝试这样的事情：

```
SELECT FIELD1, FIELD2, TRUNC(MIN(FIELD3)), TRUNC(MAX(FIELD3)), SUM(FIELD4)
  FROM SOME_TABLE
  WHERE FIELD3 BETWEEN DATE '2013-02-01'
                   AND DATE '2013-02-04' + INTERVAL '1' DAY - INTERVAL '1' SECOND
  GROUP BY FIELD1, FIELD2
  ORDER BY MIN(FIELD3); 
```

分享和享受。

# asp.net - 如何在asp.net中单击浏览器的后退按钮重新加载网页

> ID：16058190
> 
> 赞同：1
> 
> 时间：2013-04-17T10:57:10.660
> 
> 标签：asp.net, browser, browser-cache

我对浏览器的后退按钮有疑问。单击后退按钮 我想重新加载我的网页，但它没有回发，这就是我无法刷新页面的原因。我使用以下代码清理缓存，但它显示您的页面已过期，但我想刷新它。

```
Response.Cache.SetCacheability(HttpCacheability.NoCache);
Response.Cache.SetExpires(Now.AddSeconds(-1));
Response.Cache.SetNoStore();
Response.AppendHeader("Pragma", "no-cache"); 
```

我也试图通过javascript禁用浏览器的后退按钮，但它无法正常工作。javascript的代码是

```
window.history.forward();
function noBack(){ window.history.forward(); } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:08:24.043

您可以创建历史记录点并将它们保存到浏览器这里是微软的演练 [http://msdn.microsoft.com/en-us/library/cc488548%28v=vs.90%29.aspx](http://msdn.microsoft.com/en-us/library/cc488548%28v=vs.90%29.aspx)

# objective-c - 尝试从 AFHTTPClient 反序列化子类对象时的 EXC_BAD_ACCESS

> ID：16058196
> 
> 赞同：0
> 
> 时间：2013-04-17T10:57:24.223
> 
> 标签：objective-c, nsuserdefaults, exc-bad-access, afnetworking, nscoding

我有一个 AFHTTPClient 的子类，实现了 NSCoding 协议方法：

```
- (id)initWithCoder:(NSCoder *)aDecoder {

  self = [super initWithCoder:aDecoder];

  if (!self)
    return nil;

  self.isLoggedIn = [aDecoder decodeBoolForKey:@"isLoggedIn"];

  return self;
}

- (void)encodeWithCoder:(NSCoder *)aCoder {
  [super encodeWithCoder:aCoder];
  [aCoder encodeBool:self.isLoggedIn forKey:@"isLoggedIn"];
} 
```

我还实现了为令牌设置默认标头的方法，并在那里存档了客户端：

```
- (void)setAuthorizationHeaderWithToken:(NSString *)token {
  [self setDefaultHeader:@"Authorization" value:[NSString stringWithFormat:@"OAuth %@", token]];

  [self setIsLoggedIn:YES];

  NSData *data = [NSKeyedArchiver archivedDataWithRootObject:self];
  [[NSUserDefaults standardUserDefaults] setObject:data forKey:kGCClient];
  [[NSUserDefaults standardUserDefaults] synchronize];
} 
```

我`- (id)initWithBaseURL:(NSURL *)url`在子类的实现中反序列化客户端：

```
- (id)initWithBaseURL:(NSURL *)url {

  NSData *data = [[NSUserDefaults standardUserDefaults] objectForKey:kGCClient];
  GCClient *client = [NSKeyedUnarchiver unarchiveObjectWithData:data];

  if (client)
    return self = client;

  self = [super initWithBaseURL:url];

  if (!self) {
    return nil;
  }

  [self setIsLoggedIn:NO];

  return self;
} 
```

问题是，一旦我登录，下次我打开应用程序时，它会在`AFHTTPClient`类`- (id)initWithCoder:(NSCoder *)aDecoder`方法中崩溃客户端的反序列化，在第一次尝试解码对象时，在调试器中它说返回的值是不是 Objective-C 对象。

```
NSURL *baseURL = [aDecoder decodeObjectForKey:@"baseURL"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-26T18:01:21.510

两件事情：

*   使用 Keychain 而不是`NSUserDefaults`来存储凭据。
*   而不是弄乱`NSCoding`, 只需覆盖`-initWithBaseURL`, （当然要确保调用`super`），并`Authorization`根据存储在钥匙串中的值（如果存在）设置标题。该`isLoggedIn`属性可以（并且应该）定义为派生`readonly`属性，`YES`当`Authorization`标头存在时返回，`NO`否则返回。

# javascript - 用表单隐藏leanModal div

> ID：16058199
> 
> 赞同：1
> 
> 时间：2013-04-17T10:57:27.557
> 
> 标签：javascript, jquery, modal-dialog

首先我想说我根本不是 javascript 专家..

我正在测试[Ray Stone](https://twitter.com/finelysliced)的[leanModal 插件](http://leanmodal.finelysliced.com.au/)。我可以使用插件打开和关闭模式。

我在模态 div 中添加了一个表单。我现在要做的是在用户单击提交按钮时关闭模式（如您在项目网站中所见）。

问题是我没有像往常一样处理表格。我使用 jQuery 获取数据，并使用`$.ajax()`. 这是我的代码：

```
 $(function() {
     $('#add-user').submit(function() {
         $.ajax({
             type: 'post',
             url: '***',
             data: '***',
             contentType: 'application/json',
             dataType: 'json'
         });
         $(this).closest('form').find("input[type=text], textarea").val("");
         $(this).leanModal.closeModal('#cp');
         return false;
     }); 
}); 
```

`#add-user`打开模式的链接 在哪里 。`#cp`是模态的 div id。

在这种情况下，div 靠近，但 div 后面的模糊在用户点击之前不会消失。效果和使用`$('#cp').remove();` How can I fully close the div when the request is sent时效果一样？提前致谢

**更新：**我的代码的 jsFiddle[在这里](http://jsfiddle.net/PTGFQ/)可用。一些 CSS 规则被遗漏了，我没有展示 AJAX 请求，但我认为主要代码就在那里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:11:36.990

首先`$.ajax()`是异步的，所以以下几行

```
$(this).closest('form').find("input[type=text], textarea").val("");
$(this).leanModal.closeModal('#cp'); 
```

即使您的查询不成功，也会执行。
你最好做

```
$.ajax({
    ...
    success: function () {
        $(this).closest('form').find("input[type=text], textarea").val("");
        $(this).leanModal.closeModal('#cp');
    }
}); 
```

其次，在[检查了来源](https://github.com/FinelySliced/leanModal.js/blob/master/jquery.leanModal.js#L62)之后，我认为你应该使用

```
$.leanModal.close_modal('#cp'); 
```

`$("#lean_overlay")`似乎是您想要摆脱的“模糊”元素。
最终你可以做到`$("#lean_overlay").remove()`，但插件似乎已经管理它

最后你应该有

```
$(function() {
    $('#add-user').submit(function(e) {
        e.preventDefault();
        $.ajax({
            type: 'post',
            url: '***',
            data: '***',
            contentType: 'application/json',
            dataType: 'json',
            success: function () {
                $('#add-user :input:not(:submit)').val('');
                $.leanModal.close_modal('#add-user');
            }
        });
        return false;
    }); 
}); 
```

# neo4j - EmbeddedReadOnlyGraphDatabase 抱怨数据库被锁定

> ID：16058200
> 
> 赞同：2
> 
> 时间：2013-04-17T10:57:28.150
> 
> 标签：neo4j, readonly

```
Exception in thread "main" java.lang.IllegalStateException: Database locked.
    at org.neo4j.kernel.InternalAbstractGraphDatabase.create(InternalAbstractGraphDatabase.java:289)
    at org.neo4j.kernel.InternalAbstractGraphDatabase.run(InternalAbstractGraphDatabase.java:227)
    at org.neo4j.kernel.EmbeddedReadOnlyGraphDatabase.<init>(EmbeddedReadOnlyGraphDatabase.java:81)
    at org.neo4j.kernel.EmbeddedReadOnlyGraphDatabase.<init>(EmbeddedReadOnlyGraphDatabase.java:72)
    at org.neo4j.kernel.EmbeddedReadOnlyGraphDatabase.<init>(EmbeddedReadOnlyGraphDatabase.java:54)
    at QueryNodeReadOnly.main(QueryNodeReadOnly.java:55) 
```

这是使用 1.8.2 版本的 neo4j。我编写了一个程序，它以只读模式打开数据库，查询并使其在退出前休眠一段时间。

# 这是相关的文字

```
 graphDb = new EmbeddedReadOnlyGraphDatabase( dbname); // Line 55 - the exception.
  ......
  ......
  ......
  ......
  ......
    if(sleepVal > 0)
    Thread.sleep(sleepVal); 
```

我认为我不应该收到此错误。只有 2 个进程打开 db ，都处于只读模式。事实上，即使我在另一个进程打开它来写入它时打开数据库，它也应该工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T12:35:38.563

我们不允许两个数据库同时访问磁盘上的相同文件——即使在只读模式下也是如此。

原因是虽然我们不允许您以只读模式修改数据库，但 Lucene 在处理您的读取请求时仍会写入磁盘，并且让两个实例访问相同的索引文件会导致竞争条件和索引损坏。

为什么您希望 2x 实例同时访问相同的文件？你的用例是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:33:16.500

您不能与嵌入式数据库建立多个连接。也许您应该考虑使用 REST 服务器。

# objective-c - 检测大陆以选择最佳 AWS S3 存储桶的最佳方法

> ID：16058203
> 
> 赞同：1
> 
> 时间：2013-04-17T10:57:46.690
> 
> 标签：objective-c, amazon-s3

我试图找出在不使用 GPS 的情况下在 Amazon S3 中找到最近存储桶的最佳方法是什么。

Obj-C中有什么方法可以检测当前大陆吗？AWS 框架中有什么东西吗？

我的想法是使用当前国家/地区（来自 iphone 偏好）并制作一个包含国家/地区的大陆列表，然后选择正确的存储桶。

另一个想法是获取当前时区并检查哪个时区更接近存储桶的时区。

对此有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T10:49:49.747

如果您只是想从 S3 提供静态文件，如果您使用 CloudFront 从存储桶提供内容，这一切都会自动完成。

CloudFront 将负责从最近的边缘站点向客户端提供内容。

# c++ - 使用 boost 保存 xml 时省略 xml 声明

> ID：16058204
> 
> 赞同：7
> 
> 时间：2013-04-17T10:57:49.230
> 
> 标签：c++, xml, boost, boost-propertytree

是否可以通过在 write_xml 调用中用作第三个参数的 xml_writer_settings 在函数保存 xml 时省略 xml 声明？我的意思是，我不想有最初的“xml version="blah" encoding="blah blah" 部分。我正在搜索互联网，但我仍然没有找到答案。怎么做？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-03-30T11:14:41.123

是的，这是可能的，但您需要直接调用函数“write_xml_element”。这是 boost 1.49 的示例：

```
using namespace boost::property_tree;
ptree pt;
...
write_xml_element(std::cout,ptree::key_type(),pt,-1,xml_writer_settings<ptree::key_type::value_type>()); 
```

当然。您可以用 std::ofstream 或您想要的任何其他输出流替换标准输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:07:26.023

不，这是不可能的。[在此处查找 xml_writer_settings 的成员](http://www.boost.org/doc/libs/1_52_0/boost/property_tree/detail/xml_parser_writer_settings.hpp)

同样，`write_xml`调用`write_xml_internal`是（在 boost 1.52 中）

```
template<class Ptree>
void write_xml_internal(
std::basic_ostream<typename Ptree::key_type::value_type> &stream, 
const Ptree &pt,
const std::string &filename,
const xml_writer_settings<typename Ptree::key_type::value_type> & settings)
{
    typedef typename Ptree::key_type::value_type Ch;
    typedef typename std::basic_string<Ch> Str;
    stream  << detail::widen<Ch>("<?xml version=\"1.0\" encoding=\"")
            << settings.encoding
            << detail::widen<Ch>("\"?>\n");
    write_xml_element(stream, Str(), pt, -1, settings);
    if (!stream)
        BOOST_PROPERTY_TREE_THROW(xml_parser_error("write error", filename, 0));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-27T06:07:31.397

似乎没有 xml_writer_settings，write_xml_element 就无法工作。并且 xml_writer_settings 有两个不同的不兼容版本；一个与另一个与。

在 boost v1.58 中，这条线是有效的：

```
boost::property_tree::xml_writer_settings<std::string> settings;
boost::property_tree::xml_parser::write_xml_element(xmlStream,ptree::key_type(),pt_,-1, settings); 
```

而在 boost 1.54 中，这些是有效的：

```
boost::property_tree::xml_writer_settings<char> settings;
boost::property_tree::xml_parser::write_xml_element(xmlStream,ptree::key_type(),pt_,-1, settings); 
```

我不确定是否有任何解决方案可以统一它们。因此，在使用 write_xml_element 时请考虑 boost 版本。

# jquery - 查找一类元素并选择多个类

> ID：16058206
> 
> 赞同：1
> 
> 时间：2013-04-17T10:57:54.560
> 
> 标签：jquery, class, selector

我不确定，我打电话对.. 但我给你一个演示

**HTML：**

```
<div class="demo one"></div>
<div class="demo two"></div> 
```

如果我设置了变量

`var element = $(".demo");`

那么..我如何选择选择一个带有类的元素`.one`？喜欢...

`element.withclass('.one')`

PS：我知道我可以打电话`$(".demo.one")`

**测试：http:** [//jsfiddle.net/UH6pj/](http://jsfiddle.net/UH6pj/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:05:53.073

您可以使用[**.filter()**](http://api.jquery.com/filter/)简单地做到这一点：

```
var element = $(".demo");
element.filter(".one"); 
```

[**在这里演示**](http://jsfiddle.net/VbqNL/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T11:04:08.347

您可以使用[filter()](http://api.jquery.com/filter/)和[hasClass()](http://api.jquery.com/hasClass/)过滤掉具有类`demo`和`one`

```
 elements = $('.demo').filter(function(){
    return $(this).hasClass('one');
}); 
```

# java - AsynchCallback 上的空指针异常

> ID：16058208
> 
> 赞同：0
> 
> 时间：2013-04-17T10:58:06.560
> 
> 标签：java, gwt, google-maps-api-3, nullpointerexception

这是我的方法。

```
@Override
public void onSuccess(PlotSetOutput result) {
            String test = result.toString(); // this works
        controller.getScolopaxGUI().getResultsPanel().setPlots(result);
        controller.getScolopaxGUI().displayTab(1);
    } 
```

在我的 setPlots 方法中，我试图在 GoogleMaps 上显示结果。我在 setPlots 中设置了一个断点，似乎代码在那之前就失败了。我也成功地获得了 ResultPanel 对象。因此，我对导致此 NullPointerException 的原因感到困惑。

```
06:47:38.791 [ERROR] [scolopax] Uncaught exception escaped
java.lang.NullPointerException: null
    at edu.neu.scolopax.web.client.RetrieveSummariesAsynchCallback.onSuccess(RetrieveSummariesAsynchCallback.java:32)
    at edu.neu.scolopax.web.client.RetrieveSummariesAsynchCallback.onSuccess(RetrieveSummariesAsynchCallback.java:1)
    at com.google.gwt.user.client.rpc.impl.RequestCallbackAdapter.onResponseReceived(RequestCallbackAdapter.java:232)
    at com.google.gwt.http.client.Request.fireOnResponseReceived(Request.java:258)
    at com.google.gwt.http.client.RequestBuilder$1.onReadyStateChange(RequestBuilder.java:412)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
    at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
    at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
    at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessagesWhileWaitingForReturn(BrowserChannelServer.java:338)
    at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:219)
    at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:571)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNativeObject(ModuleSpace.java:279)
    at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeObject(JavaScriptHost.java:91)
    at com.google.gwt.core.client.impl.Impl.apply(Impl.java)
    at com.google.gwt.core.client.impl.Impl.entry0(Impl.java:242)
    at sun.reflect.GeneratedMethodAccessor33.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
    at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
    at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
    at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessages(BrowserChannelServer.java:293)
    at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:547)
    at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:364)
    at java.lang.Thread.run(Thread.java:680) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:01:49.497

这里

以下之一为空

```
controller

controller.getScolopaxGUI()    

controller.getScolopaxGUI().getResultsPanel() 
```

试试这个

```
 if(controller != null &&  controller.getScolopaxGUI() != null && 
 controller.getScolopaxGUI().getResultsPanel() != null)
     controller.getScolopaxGUI().getResultsPanel().setPlots(result); 
```

# video-streaming - 显示带有访问令牌的 EmbedLink 播放器

> ID：16058210
> 
> 赞同：2
> 
> 时间：2013-04-17T10:58:11.003
> 
> 标签：video-streaming, google-drive-api, google-oauth

在我的 Java Web 应用程序中，我需要向未经身份验证的用户显示存储在 Google Drive 帐户中的视频。

我设法在服务器应用程序中使用来自 Google API 的 OAuth2 来检索访问令牌和视频文件的 DownloadUrl 属性来解决这个问题。然后以这种方式将访问令牌添加到 URL：

```
https://doc-10-8g-docs.googleusercontent.com/...&access_token=XXXXXXXX 
```

我将此 URL 传递给前端应用程序，无论是 HTML5 视频播放器还是 Flash 视频播放器，它都能正常工作。

但我想知道是否可以以类似的方式使用 Google Drive 视频播放器，原因如下：

*   是直播。您无需等待缓冲即可获取视频的任何部分
*   支持更多视频格式（MKV、divx等）
*   视频质量选择器

我尝试以类似的方式使用 Drive API 中的 EmbedLink 和 access_token 参数，但它不起作用。

替代解决方案可能是在 Flash/HTML5 播放器中播放真正的流媒体。这对于我的目的应该足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:08:59.980

通过查看 Google Drive 嵌入播放器的请求，我自己找到了解决方案。

基本上你会请求这个地址：

```
https://docs.google.com/get_video_info?authuser=&docid=<YOUR_VIDEO_ID> 
```

您可以在 OAuth 身份验证后使用 Drive 客户端执行此操作，或附加`&access_token=YOUR_TOKEN`在 URL 的末尾。两种选择都有效。

响应包含 URL 编码的字段和值对，以及有关视频的信息。我们的 porpuse 的有趣字段是`fmt_stream_map`，它包含各种格式和编解码器的可用流列表。这些 URL 可以发送到 Flash 或 HTML5 播放器，无需验证即可复制。

如果您想在任何特定时刻开始播放视频，只需`&begin=MILLISECONDS`在流 URL 的末尾添加即可。

注意：您可以从字段中获取 URL 列表`url_encoded_fmt_stream_map`。它有点难以解析，但包含其他有用的信息，如视频 mime 类型和编解码器。

示例代码：

```
Credential credential = getOAuth2Credential(); //Your authentication stuff

//Create a new authorized API client
Drive service = new Drive.Builder(new NetHttpTransport(), new JacksonFactory(), credential).build();

String fileId = "XXXXXXXXXXX"; //Your video docid in Google Drive

HttpResponse resp = service.getRequestFactory()
        .buildGetRequest(new GenericUrl("https://docs.google.com/get_video_info?authuser=&docid=" + fileId)).execute();

//Convert response InputStream to String
String content = "";
InputStreamReader isr = new InputStreamReader(resp.getContent());
int ch = 0;
while (ch != -1) {
    ch = isr.read();
    if (ch != -1) content += (char)ch;  
}

//Split response in pairs field / value
StringTokenizer st = new StringTokenizer(content, "&");

while (st.hasMoreTokens()) {
    String token = st.nextToken();
    if (token.split("=").length == 2) {
        String field = token.split("=")[0];
        String value = URLDecoder.decode(token.split("=")[1], "UTF-8");
        if ("url_encoded_fmt_stream_map".equals(field)) {
            //Prints info of each available video Stream
            String[] urlList = value.split(",");
            for (int i=0; i < urlList.length; i++) {
                System.out.println("Stream #" + i + ":");
                System.out.println("URL: " + URLDecoder.decode(urlList[i].split("&")[1].split("=")[1], "UTF-8"));
                System.out.println("Quality: " + URLDecoder.decode(urlList[i].split("&")[3].split("=")[1], "UTF-8"));
                String type = URLDecoder.decode(urlList[i].split("&")[2], "UTF-8");
                if (type.indexOf(';') > 0) {
                    System.out.println("Mime type: " + type.substring(5, type.indexOf(';')));
                    System.out.println("Codecs: " + type.substring(type.indexOf("codecs=\"") + 8, type.lastIndexOf('"')));
                }
                else {
                    System.out.println("Mime type: " + type.substring(5));
                }
            }
        }
    }
} 
```

# python - 跨多个 mod_wsgi 进程/线程共享变量

> ID：16058211
> 
> 赞同：4
> 
> 时间：2013-04-17T10:58:15.440
> 
> 标签：python, global, mod-wsgi, wsgi, shared

您能否在多个 WSGI 线程/进程之间共享一个对象（并且以在 *NIX 和 Windows 上都可以工作的方式）？

基本前提：（1）我有一个将连接到后端服务器的 WSGI 前端。我有一个序列化类，其中包含有关如何序列化/反序列化各种对象的规则，包括特定于该项目的类。因此，它需要一些设置来告诉它如何处理自定义对象。然而，它是无状态的——多个线程可以同时访问它以毫无问题地序列化它们的数据。(2) 有socket可以连接到后端。我宁愿有一个套接字池而不是每次有连接时都创建/销毁。

注意：我不介意有多个 (1) 和 (2) 实例的解决方案，但理想情况下，我希望它们尽可能少地创建/初始化。我不确定内部结构，但是如果线程循环而不是关闭并让服务器在新请求上重新打开，那么每个线程有一个数据集就可以了（因此，套接字和序列化程序每次初始化一次）线程，但重复使用它处理的每个后续调用。）实际上每个线程有一个套接字，如果它是这样工作的，那将是最好的，因为我不需要套接字池并且必须处理互斥锁。

注意：这不是会话，与会话无关。这不应该关心谁在调用服务器。它只是在线程创建速度较慢或内存很大但 CPU 相对较慢的系统上调整性能。

编辑 2：下面的代码将提供一些关于您的系统如何共享变量的信息。您需要多次加载该页面才能获得一些诊断信息...

```
from datetime import *;
from threading import *;
import thread;
from cgi import escape;
from os import getpid;

count = 0;
responses = [];
lock = RLock();

start_ident = "%08X::%08X" % (thread.get_ident(), getpid());

show_env = False;

def application(environ, start_response):
    status = '200 OK';
    this_ident = "%08X::%08X" % (thread.get_ident(), getpid());

    lock.acquire();
    current_response = """<HR>
<B>Request Number</B>: """ + str(count) + """<BR>
<B>Request Time</B>: """ + str(datetime.now()) + """<BR>
<B>Current Thread</B>: """ + this_ident  + """<BR>
<B>Initializing Thread</B>: """ + start_ident  + """<BR>
Multithread/Multiprocess: """ + str(environ["wsgi.multithread"]) + "/" + str(environ["wsgi.multiprocess"]) +"""<BR>
"""
    global count;
    count += 1;

    global responses;
    responses.append(current_response)
    if(len(responses) >= 100):
        responses = responses[1:];
    lock.release();

    output="<HTML><BODY>";

    if(show_env):
        output+="<H2>Environment</H2><TABLE><TR><TD>Key</TD><TD>Value</TD></TR>";
        for k in environ.keys():
            output += "<TR><TD>"+escape(k)+"</TD><TD>"+escape(str(environ[k]))+"</TD></TR>";
        output+="</TABLE>";
    output += "<H2>Response History</H2>";
    for r in responses:
        output += r;
    output+="</BODY></HTML>"

    response_headers = [('Content-type', 'text/html'),
                        ('Content-Length', str(len(output)))]
    start_response(status, response_headers)
    return [output] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-11T20:46:14.250

通过我对[http://code.google.com/p/modwsgi/wiki/ProcessesAndThreading](http://code.google.com/p/modwsgi/wiki/ProcessesAndThreading)的阅读，如果您启用了多处理和多线程（与工作者一样，或者如果您有

WSGIDaemonProcess 示例进程=2 线程=25

那么你有两个问题：多个线程意味着你可以共享一个变量，但它只能**在**2 个进程中的每个进程中共享。除非您明确地让另一个守护程序（NON-APACHE）处理消息传递和请求，否则没有真正的方法可以在进程之间共享变量。

假设您对数据库连接池有一个简单的需求。使用上述配置，您将拥有两个池，每个池服务 25 个线程。这对大多数人来说都很好，因为线程是轻量级的，而进程不是（据说）。

那么，如何实现呢？

*   在您的一个模块中，创建一个实例化连接池的变量。让每个线程（实际上是为单个请求提供服务的代码）在适当的时间获得连接使用它，并将其返回到池中。不要忘记最后一部分，你会很快用完连接。

*   创建另一个守护进程（与 Apache 无关）。实例化一个共享内存数组。将包含 db 连接和进程 ID 的对象放入此数组中（以 null 开始）。在 while-True 循环中，侦听套接字上的连接，当你得到一个连接时，生成一个子进程，传入共享数组，数组元素的数量。子进程填写它知道的进程ID，它处理请求，关闭任何游标，然后删除它的进程ID并退出。

*   聘请熟悉 WSGI 和 db 连接池的程序员为您做这件事；-)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T11:26:19.377

有关 mod_wsgi 进程/线程模型如何工作的一些阅读，请参阅：

*   [http://code.google.com/p/modwsgi/wiki/ProcessesAndThreading](http://code.google.com/p/modwsgi/wiki/ProcessesAndThreading)

请特别注意有关构建可移植应用程序的部分。

无论您使用什么 WSGI 服务器，那里的评论并没有什么不同。所有 WSGI 服务器也属于多进程/单进程、多线程/单线程类别之一。

# c# - 为什么我的设计器属性没有在 ASPX 中序列化

> ID：16058212
> 
> 赞同：9
> 
> 时间：2013-04-17T10:58:16.747
> 
> 标签：c#, asp.net, editor, controls, datasource

为了创建一个应该在 ASP.NET 中使用的自定义数据源，我创建了一个自定义数据源类、一个自定义编辑器和一个自定义可序列化类。

我不明白为什么它不起作用......即使我可能有比要求更多的属性（我已经浏览和尝试了几个小时），但据我所知，`PersistenceMode(PersistenceMode.InnerProperty)`应该做到这一点......另外，在我看来，我的代码类似于[为什么我不能在 WebForm 中声明 UserControl 的子元素（属性）？](https://stackoverflow.com/questions/8743680/why-cant-i-declare-sub-elements-properties-of-a-usercontrol-in-a-webform).

该代码的工作原理如下：

```
[ParseChildren(true)]
[PersistChildren(true)]
public class MyDataSource : DataSourceControl
{
    // [much more irrelevant code...]

    [Browsable(true)]
    [EditorBrowsable(EditorBrowsableState.Always)]
    [PersistenceMode(PersistenceMode.InnerProperty)]
    [MergableProperty(false)]
    [TypeConverter(typeof(ExpandableObjectConverter))]
    [DesignerSerializationVisibility(DesignerSerializationVisibility.Content)]
    [Editor(typeof(Editors.ResultRequestEditor), typeof(System.Drawing.Design.UITypeEditor))]
    public ResultRequest Request { get; set; }
}

[Serializable]
[PersistChildren(true)]
[TypeConverter(typeof(ExpandableObjectConverter))]
[ParseChildren(true)]    
public class ResultRequest
{
    [Browsable(true)]
    [EditorBrowsable(EditorBrowsableState.Always)]
    public string ColumnName { get; set; }

    [Browsable(true)]
    [EditorBrowsable(EditorBrowsableState.Always)]
    public Type ColumnType { get; set; }

    [Browsable(false)]
    [EditorBrowsable(EditorBrowsableState.Always)]
    public object[] ResultTypeParameters { get; set; }
} 
```

自定义编辑器似乎工作：使用它后，VS 中的属性正确更新。

但是，更新某些内容后，信息不会保留在 ASPX 文件中：

```
<cc1:MyDataSource ID="SearchDataSource1" runat="server" ProviderID="MyProvider1" /> 
```

我期望的是数据源中的一些序列化，例如：

```
<cc1:MyDataSource ID="SearchDataSource1" runat="server" ProviderID="MyProvider1">
    <Request>
        // blah
    </Request>
</cc1:MyDataSource> 
```

有人可以解释为什么这不起作用吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T19:49:11.163

请看一下我的示例，它不太复杂，因此更容易理解：

第一个父控件（在您的情况下，这将是 DataSource）：

```
[ToolboxData("<{0}:TabContainer runat=server></{0}:TabContainer>")]
[ParseChildren(ChildrenAsProperties = false)]
[PersistChildren(true)]
public class TabContainer : Panel, INamingContainer
{

    #region private properties

    List<TabItem> tabs = new List<TabItem>();

    #endregion

    [Bindable(true)]
    public event EventHandler TabClick;

    [Browsable(true)]
    [PersistenceMode(PersistenceMode.InnerProperty)]
    public List<TabItem> Tabs
    {
        get { return this.tabs; }
    }
} 
```

请注意我已将 ChildrenAsProperties 设置为 false。这是子定义，TabItem：

```
public class TabItem : Panel, IPostBackEventHandler
{

    String clientClick = String.Empty;

    public event EventHandler Click;

    [Bindable(true)]
    [Category("Appearance")]
    public string Text
    {
        get
        {
            if (ViewState["Text"] == null)
            {
                ViewState["Text"] = "";
            }
            return (string)ViewState["Text"];
        }
        set
        {
            ViewState["Text"] = value;
        }
    }
} 
```

现在在设计师内部，我可以像这样声明 TabContainer：

```
 <cc1:TabContainer ID="TabContainer1" runat="server"
        </cc1:TabContainer> 
```

最后添加保留状态的子控件：

```
 <cc1:TabContainer ID="TabContainer1" runat="server"
            OnTabClick="TabContainer_TabClick">
            <Tabs>
                <cc1:TabItem ID="Tab1" Text="Hello" runat="server" />
                <cc1:TabItem ID="Tab2" Text="World" runat="server" />
            </Tabs>
        </cc1:TabContainer> 
```

此致！

# java - PDFBox 将 PDF 转换为 TIFF。以字节为单位减小图像大小

> ID：16058213
> 
> 赞同：0
> 
> 时间：2013-04-17T10:58:26.233
> 
> 标签：java, image, pdf, tiff, pdfbox

我正在尝试将 pdf 转换为 tiff 图像。我使用 pdfbox 让它工作，但图像太大。

假设我的 PDF 大小是 224kb => 图像大小=1.4Mb

如何在不损失质量的情况下使 tiff 文件更小？

这是一些代码：

```
TIFFImageWriterSpi tiffspi = new TIFFImageWriterSpi();
writer = tiffspi.createWriterInstance();
ImageWriteParam param = writer.getDefaultWriteParam();
TIFFImageWriteParam param2 = (TIFFImageWriteParam) writer.getDefaultWriteParam();
param2.setCompressionMode(ImageWriteParam.MODE_EXPLICIT);

param2.setCompressionType("LZW");
param2.setCompressionQuality(1.0f);

writer.setOutput(output);
writer.write(null,new IIOImage(image,null,null),param2); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-28T22:48:00.437

以下是一些指导方针：

*   将颜色与您的输出相匹配。如果您以黑白方式渲染，请使用双值输出，即每像素一位。如果您的颜色很少而没有太多阴影或混​​合，如高光着色或卡通风格的图形，请使用 256 色。如果您的 PDF 中有照片，请仅使用全彩色。如果您必须制作全彩，那么您对小巧的追求就注定要失败。
*   将您的压缩与您的颜色深度相匹配。对于单色，使用 CCITT T.4 或 CCITT T.6，它们对位序列更有效。LZW 最适用于 256 色等字节序列。如果你必须制作全彩，你唯一希望得到体面的压缩是 jpeg，但这会使你的文本和线条模糊。

# firefox - hosted app for firefox os similar to: http://www.zoobe.com/, is it possible?

> ID：16058215
> 
> 赞同：1
> 
> 时间：2013-04-17T10:58:33.083
> 
> 标签：firefox, operating-system, firefox-os

I'm currently working at a project to develop an App for firefox os similar to: [http://www.zoobe.com/](http://www.zoobe.com/).

So it's basicly a hosted app, where you can choose a 3D-character. Then you have to make a picture for the background and record your voice on the phone. A Video will be rendered then and the 3d-character will speak the recorded message for you!

So my generell question is: Does anybody know, if its possible to develop such complex app for firefox os at this stage? I've read, that all the APIs required for the project, like camera API and so on are already working.

I would implement the data-flow between server and client with node.js. I would be greatful for any evaluations, tips and help.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:35:49.357

There is no sound recording API yet, so I fear you will have to wait for it to be implemented for this kind of app to be possible. You can track the work on this API at [https://bugzilla.mozilla.org/show_bug.cgi?id=803414](https://bugzilla.mozilla.org/show_bug.cgi?id=803414)

# jquery - Tinymce 4.0b1 未加载

> ID：16058217
> 
> 赞同：0
> 
> 时间：2013-04-17T10:58:36.450
> 
> 标签：jquery, html, tinymce

我正在使用这些行来加载 tinymce4.0b1 但它没有加载。什么问题？

```
<script src="~/Scripts/tinymce/tinymce.min.js"></script>
<script src="~/Scripts/tinymce/js/tinymce/plugins/table/plugin.min.js"></script>
<script src="~/Scripts/tinymce/js/tinymce/themes/modern/theme.min.js"></script>
<link rel="stylesheet" type="text/css" href="~/Scripts/tinymce/js/tinymce/skins/lightgray/skin.min.css"/>
<script type="text/javascript">
    tinymce.init({
        selector: "textarea",
        plugins: ["table"],
        toolbar: "insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"
    });
</script> 
```

这些是我的 HTML 行。

```
<body>
    <div>
        <form method="post">
            <textarea name="content" style="width: 100%">salam</textarea>
        </form>
    </div>
</body> 
```

但是textarea没有改变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:26:44.173

不确定这里的问题是什么，因为您的代码很好。仔细检查您的`JS`和`CSS`文件的路径。

如果您已经检查过，但仍然有问题，请复制并粘贴以下代码：

```
<html>
<head>
<title>TinyMCE Test</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
<script src="tinymce.min.js"></script>
<script type="text/javascript">
    tinymce.init({
        selector: "textarea",
        plugins: ["table"],
        toolbar: "insertfile undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"
    });
</script>
</head>
<body>
    <div>
        <form method="post">
            <textarea name="content" style="width: 100%">salam</textarea>
        </form>
    </div>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-10T14:16:24.177

脚本文件应在引导文件后加载，媒体插件在购买前不应使用。

# sql-server - 更新上一行，从其他行获取值

> ID：16058218
> 
> 赞同：-1
> 
> 时间：2013-04-17T10:58:40.410
> 
> 标签：sql-server, tsql

我对 T-SQL 很陌生，我需要一些帮助。我有一个`table1`. 我怎么能做这个过程？我应该使用嵌套光标还是什么？需要这方面的建议。

请在此处参考图片-http: [//i.stack.imgur.com/CHYIg.gif](https://i.stack.imgur.com/CHYIg.gif)

![在此处输入图像描述](https://i.stack.imgur.com/8Ho0a.gif)

到目前为止，这是我的代码：

```
DECLARE @get_invckey datetime;
SET @get_invckey = '2013-04-09 13:30:43.537'

UPDATE table1
SET RUNTIME = @get_invckey
FROM
    (
    SELECT
        DCREPORTTIME
    FROM table1
    WHERE
        LOCATIONAME = 'MYQ01_PRNT_A_SP3'
        AND EVENT LIKE '%RUN%'
    ) newdata
WHERE
   LOCATIONAME = 'MYQ01_PRNT_A_SP3'
   AND EVENT = 'MACHINE B STOPPED' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:21:05.130

不完整的答案，因为你的问题不够复杂。

只是快速简单的示例如何实现这一点。

一些样本数据

```
DECLARE @Table table
(   dcreporttime datetime, event_name varchar(55))

insert INTO @Table
SELECT '2013-04-09 13:34:01', 'RUNNING'
union
SELECT '2013-04-09 13:34:19', 'STOPPED'
union
SELECT '2013-04-09 13:34:29', 'RUNNING'
union
SELECT '2013-04-09 13:34:39', 'RUNNING'
union
SELECT '2013-04-09 13:35:19', 'STOPPED'
union
SELECT '2013-04-09 13:35:29', 'RUNNING'
union
SELECT '2013-04-09 13:35:39', 'RUNNING'
union
SELECT '2013-04-09 13:36:19', 'RUNNING'
union
SELECT '2013-04-09 13:37:19', 'STOPPED'
union
SELECT '2013-04-09 13:37:39', 'RUNNING' 
```

和查询。它使用 CTE（公用表表达式）和排名函数：

```
;with cte as
(
SELECT RANK() OVER(ORDER by dcreporttime) as RankN, *
FROM @Table
)
select a.dcreporttime, a.event_name,  a.dcreporttime, b.dcreporttime, DATEDIFF(ms, a.dcreporttime, b.dcreporttime) as runtime
from cte a 
            -- shift by Rank to compare with previous row
    join cte b on a.RankN = b.RankN + 1 
```

这只是您从上一个事件开始获得时间。我希望这可以为您指出解决方案。如果没有，请更具体地说明您的需要:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T14:35:09.640

我已将视图更新如下：

```
create view [dbo].[cm] as

WITH cteMain
AS
(SELECT DCREPORTTIME, 
ROW_NUMBER() OVER (ORDER BY DCREPORTTIME) AS rn,
RUNTIME,
[EVENT] AS EVENT

FROM
table1),
cte2 as (SELECT 
sLeg.rn,
slead.DCREPORTTIME AS leadvalue,
       sLeg.DCREPORTTIME AS lagvalue,
       m.EVENT

FROM
cteMain AS m
LEFT OUTER JOIN cteMain AS sLead
ON sLead.rn = m.rn+1
LEFT OUTER JOIN cteMain AS sLeg
ON sLeg.rn = m.rn-1) 
SELECT cte2.leadvalue, cte2.lagvalue, cte2.rn, cte2.EVENT
FROM cte2 
```

然后，我将更新查询修改为：

```
update table1
set RUNTIME = DATEDIFF(ms, lagvalue, leadvalue)
FROM cm 
where leadvalue=table1.DCREPORTTIME
and table1.EVENT='MACHINE RUNNING' 
```

我使用你的前三行作为示例数据，这是我在更新后看到的：

![在此处输入图像描述](https://i.stack.imgur.com/8DcbH.png)

这是你想要的？顺便说一句，我意识到这一切都可以在没有视图的情况下完成，但是，我发现这更容易处理，就逐步解决问题而言。

我的查询基于在以下链接中找到的查询：

[查询以模拟 SQL Server 2008 中的 Lead 函数](http://blog.sqlauthority.com/2011/11/24/sql-server-solution-to-puzzle-simulate-lead-and-lag-without-using-sql-server-2012-analytic-function/)

请参阅 SQLFiddle：[SQLFiddle for Update previous row, get value from other row](http://sqlfiddle.com/#!3/d284c/1)

# java - 为 JMS 组件设置 TaskExecutor

> ID：16058221
> 
> 赞同：0
> 
> 时间：2013-04-17T10:58:52.100
> 
> 标签：java, apache-camel

我想将我的 jms 组件设置为使用特定的`TaskExecutor`（实际上宁愿使用 an`ExecutorService`但似乎不可能）。但是为什么我尝试这样做我得到一个错误。

我的春天有以下几点：

```
<bean id="jmsExecutorService" class="org.springframework.scheduling.concurrent.ThreadPoolTaskExecutor>....</bean> 
```

我的路线生成器具有以下内容：

```
from("jms:queue:myQueue?concurrentConsumers=20&taskExecutor=jmsExecutorService")... 
```

当我运行它时，我收到以下错误：

```
IllegalArgumentException: Could not find a suitable setter for property: taskExecutor
     as there isn't a setter method with same type: String not a conversion possible:
     No type converter available to convert from type: String to the required type
     TaskExecutor with value jmsExecutorService 
```

我很难找到设置 TaskExecutor 的工作示例。我想指定一个特定的 TaskExecutor，因为我想适当地命名线程池中的线程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T12:04:44.693

也发布到骆驼邮件列表，我们有答案 [http://camel.465427.n5.nabble.com/Setting-TaskExecutor-for-JMS-component-tp5731017.html](http://camel.465427.n5.nabble.com/Setting-TaskExecutor-for-JMS-component-tp5731017.html)

# google-geocoder - 谷歌地理编码返回错误的目的地

> ID：16058225
> 
> 赞同：1
> 
> 时间：2013-04-17T10:59:12.707
> 
> 标签：google-geocoder

我开发了一个网站，该网站使用谷歌地理编码来显示 A 点和 B 点之间的距离（以英里为单位）。我进行了大量测试，一切正常。但是，每当我的客户测试它时，返回的目的地都不正确。即，我输入邮政编码 EH12 5DR，我正确收到了爱丁堡的地址。当客户尝试使用相同的邮政编码时，它会将 EH Shoes 退回到贝尔法斯特的一个地址。这只是少数情况之一。这似乎只是我的客户机器的问题，我无法解释出了什么问题。任何建议将不胜感激。

问候，理查德

[http://www.minibusedinburgh.com/](http://www.minibusedinburgh.com/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:32:53.933

客户是否尝试过不止一种浏览器？客户是否忽略了某种自动建议 - 因为它至少看起来很可疑，当您有一个邮政编码 EH12 5DR 并且客户得到以 EH 开头的东西时。

# php - 我们如何使用 PHP 中的 API 获取 Google 的好友列表和圈子？

> ID：16058226
> 
> 赞同：1
> 
> 时间：2013-04-17T10:59:13.470
> 
> 标签：php, api, google-plus

我正在尝试从 google+ 获取朋友列表和圈子，但没有获得任何特定的 API 来获取这些东西。我正在用 PHP 做这一切。

如果有人对此有想法，将不胜感激。

提前致谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-30T09:22:19.983

检查此 [https://developers.google.com/+/api/latest/people/list](https://developers.google.com/+/api/latest/people/list)

列出此用户已添加到一个或多个圈子的所有人员。此列表仅限于用户对请求应用程序可见的圈子。此方法不返回圈子信息......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T14:25:12.860

使用[Google+ 登录，](https://developers.google.com/+/web/signin/)您可以访问用户关注的人员列表，并且他们也允许您访问 - 但您不能保证这是该人圈子中的所有成员。您也不会被告知这些人在哪个或哪些圈子中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-17T07:47:49.543

这是不可能的。在此处标记问题以注册您对该功能的支持： [https ://code.google.com/p/google-plus-platform/issues/detail?id=47](https://code.google.com/p/google-plus-platform/issues/detail?id=47)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T11:06:54.967

访问此[https://developers.google.com/+/web/badge/](https://developers.google.com/+/web/badge/) .. 他们提供的只是一些您可以在您的网站中使用的脚本。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-14T06:09:33.390

Google+ Domains API 为 Google Apps 客户提供 API 访问权限，以代表其 Google Apps 域中的用户创建和管理圈子。这有助于用例，例如

# magento - magento 安装，localhost/magento 正在重定向到 www.localhost.com/magento

> ID：16058227
> 
> 赞同：1
> 
> 时间：2013-04-17T10:59:13.610
> 
> 标签：magento, windows-7, localhost

我已经从他们的网站下载了最新版本的 magento。当我从像 localhost/magento 这样的浏览器运行它时，它会将我重定向到 www.localhost.com/magento。我正在使用 Windows 7 和 wamp。我的本地主机上的所有其他项目都运行良好，只是 magento 遇到了这个重定向问题。

这个问题发生在办公室。我在 Windows 8 上使用 wamp 在家中尝试了它，安装没有任何问题。

有人知道我该如何解决这个问题并在本地主机上运行 magento 吗？？？请给我一些帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-05-20T09:42:07.497

感谢詹姆斯的回复。那里没有与数据库相关的内容，因为这一切都是在我设置配置之前发生的。我更新我的php版本并下载了最新版本的任何方式，它运行没有任何问题。我以前使用的是 5.3.13，我不认为它太老了，magento 开始做问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T11:30:27.257

听起来存储在数据库中的 magento URL 在您希望时设置为 www.localhost.com/magento`http://localhost/magento`

您可以通过运行以下命令从命令行的 MySQL gui 进行检查：

```
select * from core_config_data where path = 'web/unsecure/base_url'; 
```

我的工作方式是在 VHOST 中为 apache 设置一个 serverName 以便 magento.local，然后更新我的主机文件（抱歉，没有进行谷歌搜索，我不知道它在 Windows 上的位置）。然后在我的 magento 数据库中使用这个 URL。

无论哪种方式，检查上面的 SQL 的结果是否与您期望的结果相比。如果您在此之后还有任何问题，请粘贴 SQL 的输出，我可以提供更多帮助。

# junit - 自上次提交/运行以来代码覆盖率降低的类列表

> ID：16058241
> 
> 赞同：1
> 
> 时间：2013-04-17T10:59:56.333
> 
> 标签：junit, jenkins, report, sonarqube, cobertura

我们对项目中的代码覆盖率有严格的规定。并使用 jenkins/sonar/cobertura 进行检查。你知道我是否以及如何获得自上次提交/运行以来代码覆盖率**降低的所有类的列表？**

例如：有数千个类的大项目，有数十个接触/更改的类的大问题......并且分析只给我总体统计数据，或者我必须手动遍历的每个包/类的统计数据。我想查看包含 A 和 B 类列表的信息框，其中代码覆盖率降低，X 条件覆盖率降低。这意味着我忘记为这些类添加/更新junit测试。

谢谢，祝你有美好的一天。W

# c# - 表达式编码器：编码后更改文件名

> ID：16058242
> 
> 赞同：0
> 
> 时间：2013-04-17T11:00:00.510
> 
> 标签：c#, expression-encoder, expression-encoder-sdk, expression-encoder-4

我正在使用 Microsoft Expression Encoder，这是我的代码

```
using (LiveJob job = new LiveJob())
        {
            // Creates file source for encoding
            LiveFileSource fileSource = job.AddFileSource(DataDirectory);

            // Sets playback to loop on reaching the end of the file
            fileSource.PlaybackMode = FileSourcePlaybackMode.Jump;

            // Sets this source as the current active one
            job.ActivateSource(fileSource);

            job.ApplyPreset(LivePresets.VC1IISSmoothStreamingLowBandwidthStandard);

            PushBroadcastPublishFormat format = new PushBroadcastPublishFormat();
            format.PublishingPoint = new Uri(PublishPoint);
            job.PublishFormats.Add(format);

            // Starts encoding
            job.StartEncoding();
   } 
```

这段代码在他完成一个目录时对目录中的文件列表进行编码他跳到下一个我想要做的是在传递给另一个文件之前在编码时更改文件名

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T09:00:58.353

我已经添加了这个方法我不知道它是否有效

```
public void liveJob_Status(object sender, EncodeStatusEventArgs e)
    {
        if (e.Status == EncodeStatus.Jumped)
        { LiveFileSource file = (LiveFileSource)e.LiveSource; 
          string name = file.Name;
          string modified_name = "Encode" + name;

          File.Move(DataDirectory + @"\" + name, DataDirectory + @"\" + name.Replace(name, modified_name)); 
        }
    } 
```

# c++ - 在 C 源文件中包含具有命名空间的 C++ 头文件会导致编译错误

> ID：16058245
> 
> 赞同：9
> 
> 时间：2013-04-17T11:00:09.287
> 
> 标签：c++, c, compilation, header, namespaces

我不是专业的 C++ 程序员，我最近在 C++ 中做了一个技巧，这导致了我下面的问题。

我的任务目标：复制特定的非系统线程（实际上是协作线程）安全模块以创建系统线程安全版本以支持系统中的不同需求。但是我们决定创建一个命名空间来保护 C++ 头文件中的系统线程版本，而不是创建 sys_XXX 函数来保持兼容性。我实际上可以将它包含在 CPP 文件中并愉快地工作，但我刚刚意识到我的 funcInit 调用在它到达 CPP 文件控件之前没有被调用。不幸的是，协作线程版本的这个 init 在 C 文件中。现在我需要从同一个地方初始化我的系统线程安全版本，但是我被编译错误阻止了，据我所知很难解决。

编译错误日志：-

```
In file included from sysinit.c:87:
sys_unicode.h:39: error: expected '=', ',', ';', 'asm' or '__attribute__' before 'SystemThreadUtils' <== corresponds to line [namespace SystemThreadUtils {]
sysinit.c:88:
sysinit.c:512: error: expected identifier or '(' before string constant <== corresponds to line [extern "C" bool SystemThreadUtils::funcInit(void);]
sysinit.c:513: error: expected identifier or '(' before string constant <== corresponds to line [extern "C" bool SystemThreadUtils::funcTerm(void);]
sysinit.c: In function 'SysInit':
sysinit.c:817: error: 'SystemThreadUtils' undeclared (first use in this function) <= corresponds to line [SystemThreadUtils::funcInit();]
sysinit.c:817: error: (Each undeclared identifier is reported only once
sysinit.c:817: error: for each function it appears in.)
sysinit.c:817: error: expected ')' before ':' token
sysinit.c: In function 'SysTerm':
sysinit.c:2737: error: expected expression before ':' token <== corresponds to line [SystemThreadUtils::funcTerm();]
sysinit.c:2737: warning: label 'SystemThreadUtils' defined but not used 
```

源代码和标题片段仅供参考：-

C 头文件 (unicode.h):

```
// all functions called from the C source file
funcInit();
funcA();
funcB();
funcTerm(); 
```

C 头文件（unicode.c）：

```
// all functions called from the C source file
funcInit() {
}
funcA() {
}
funcB() {
}
funcTerm() {
} 
```

C++ 头文件 (sys_unicode.h)：

```
#include "unicode.h"
namespace SystemThreadUtils {

    // below functions called from the C source file
    extern "C" funcInit();
    extern "C" funcTerm();

    // below functions called from the CPP source file
    funcA();
    funcB();
} 
```

C++ 源代码定义（sys_unicode.cpp）：

```
#include "sys_unicode.h"

namespace SystemThreadUtils {

    // below functions are called from C source
    funcInit() {
    }
    funcTerm() {
    }

    // below methods are called from CPP source
    funcA() {
    }
    funcB() {
    }
} 
```

CPP 源 #1 (utils.cpp)：

```
#include "sys_unicode.h"

using namespace SystemThreadUtils;

utils::utils_init()
{
   funcA();
   funcB();
} 
```

C 源代码 #2 (sysinit.c)：

```
#include "sys_unicode.h"

extern "C" bool SystemThreadUtils::funcInit(void);
extern "C" bool SystemThreadUtils::funcTerm(void);

SysInit ()
{
   funcInit(); // non system thread safe version
   SystemThreadUtils::funcInit();  // system thread safe version
}
SysTerm ()
{
   funcTerm(); // non system thread safe version
   SystemThreadUtils::funcTerm();  // system thread safe version
} 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-17T11:26:33.000

您不能在 C 中使用命名空间，在 C 中`extern "C"`也不允许使用。所以可能的解决方案是：您的 C++ 模块在命名空间`SystemThreadUtils`中定义了一组需要在 C 代码中调用的函数。由于您不能直接执行此操作，因此您必须围绕它们编写符合 C 的包装器：

```
//C/C++ - header "sys_unicode_for_c.h"

#ifdef __cplusplus
extern "C" {
#endif

  void STU_funcInit();
  void STU_funcTerm();

#ifdef __cplusplus
} //end extern "C"
#endif 
```

* * *

```
//C++-source: sys_unicode_for_c.hpp
#include "sys_unicode.h"

extern "C" {
  void STU_funcInit() {
    SystemThreadUtils::funcInit();
  }
  void STU_funcTerm() {
    SystemThreadUtils::funcTerm();
  }
} 
```

含义：您需要一个有效的 C 代码标头，并为您需要从 C 调用的每个 C++ 函数声明一个委托函数。源代码是 C++ 并且只是进行调用。

另请参阅[从 C 文件调用 C++ 函数](https://stackoverflow.com/questions/12615683/calling-c-functions-from-c-file)。

# java - -XX:MinHeapFreeRatio 和 -XX:MaxHeapFreeRatio 的目的是什么

> ID：16058250
> 
> 赞同：18
> 
> 时间：2013-04-17T11:00:19.067
> 
> 标签：java, heap-memory

请告诉我这些选项的目的。谷歌搜索后我认为： MinHeapFreeRatio 告诉“指定的最小百分比的空间将确保在 GC 后在堆​​内存中空闲”，而 MaxHeapFreeRatio 告诉“在 GC 后不超过指定百分比的空间将在堆内存中空闲”[如果有超出指定百分比的可用内存，这些内存将返回给操作系统]

当我尝试将这些选项都设置为 10 时，即使有超过 80% 的可用堆内存，它也没有释放回操作系统。

细节：

Java HotSpot(TM) 64 位服务器 VM（1.5.0_15-b04，混合模式）ParallelGC（也称为吞吐量收集器，它是服务器类 VM 中的默认收集器）我指定 -Xms50M 和 -Xmx1000M 作为 jvm 参数操作系统：windows 7 专业版（8 GB 内存 64 位操作系统）

注意：我也尝试过使用 SerialGC，那些最小和最大无堆比率选项被忽略了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2021-07-07T18:03:29.977

参数 -XX:MinHeapFreeRatio 和 -XX:MaxHeapFreeRatio 参数的最佳解释可以在 oracle 垃圾文档中找到：

[https://docs.oracle.com/javase/10/gctuning/factors-affecting-garbage-collection-performance.htm](https://docs.oracle.com/javase/10/gctuning/factors-affecting-garbage-collection-performance.htm)

```
-XX:MinHeapFreeRatio=40
-XX:MaxHeapFreeRatio=70 
```

使用这些选项，如果一代中的可用空间百分比低于 40%，则该代会扩展以保持 40% 的可用空间，直至该代的最大允许大小。类似地，如果空闲空间超过 70%，则生成会收缩，因此只有 70% 的空间是空闲的，这取决于生成的最小大小。

我以这种方式将它与 G1GC 结合起来：

```
-XX:+UseG1GC -XX:MinHeapFreeRatio=2 -XX:MaxHeapFreeRatio=10 
```

有了这个结果：

[![随时间变化的堆大小与解释的参数](https://i.stack.imgur.com/Xbpq8.png)](https://i.stack.imgur.com/Xbpq8.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T11:48:18.817

Java**很少**将内存释放回操作系统。

一般来说，随着时间的推移，应用程序会使用更多的内存而不是更少。你确定你的记忆力如此有限以至于你需要这个吗？您确定要检查常驻内存而不是虚拟内存大小，在您的情况下，虚拟内存大小始终约为 1.2 GB。

# java - 数据属性的 OWL 类表达式

> ID：16058259
> 
> 赞同：2
> 
> 时间：2013-04-17T11:00:46.903
> 
> 标签：java, semantic-web, owl, owl-api

在我的本体中，我有一个拥有这个数据属性的人

`hasName "somaName"^^string`,

但是，当我构建一个类表达式并发送给推理器以获取实例时，我得到一个带有以下查询的空集，

```
OWLClassExpression x = schema.getFactory().getOWLDataHasValue(schema.getDataProperty("hasName"), schema.getFactory().getOWLLiteral("somaName"));
System.out.println(reasoner.getInstances(x, true)); 
```

**getDataProperty 只是一个小方法：**

```
public OWLDataProperty getDataProperty(String dataProperty){
        return factory.getOWLDataProperty("#"+dataProperty,pm);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T14:46:37.380

以下代码片段有效，将其与您的代码进行比较，看看有什么不同。您应该使用支持这种类型构造的推理器（Hermit 确实如此）。

```
//Initiate everything
OWLOntologyManager manager = OWLManager.createOWLOntologyManager();
String base = "http://www.example.org/";
OWLOntology ontology = manager.createOntology(IRI.create(base + "ontology.owl"));
OWLDataFactory factory = manager.getOWLDataFactory();
//Add the stuff to the ontology
OWLDataProperty hasName = factory.getOWLDataProperty(IRI.create(base + "hasName"));
OWLNamedIndividual john = factory.getOWLNamedIndividual(IRI.create(base + "john"));
OWLLiteral lit = factory.getOWLLiteral("John");
OWLDataPropertyAssertionAxiom ax = 
                  factory.getOWLDataPropertyAssertionAxiom(hasName, john, lit);
AddAxiom addAx = new AddAxiom(ontology, ax);
manager.applyChange(addAx);

//Init of the reasoner
//I use Hermit because it supports the construct of interest
OWLReasonerFactory reasonerFactory = new Reasoner.ReasonerFactory();
OWLReasoner reasoner = reasonerFactory.createReasoner(ontology);
reasoner.precomputeInferences();

//Prepare the expression for the query
OWLDataProperty p = factory.getOWLDataProperty(IRI.create(base + "hasName"));
OWLClassExpression ex = 
                factory.getOWLDataHasValue(p, factory.getOWLLiteral("John"));

//Print out the results, John is inside
Set<OWLNamedIndividual> result = reasoner.getInstances(ex, true).getFlattened();        
for (OWLNamedIndividual owlNamedIndividual : result) {
    System.out.println(owlNamedIndividual);
} 
```

# mongodb - 不支持的稀疏唯一复合索引的 MongoDB 解决方法

> ID：16058261
> 
> 赞同：4
> 
> 时间：2013-04-17T11:00:54.717
> 
> 标签：mongodb

我需要一个解决方法，因为 MongoDB 不支持稀疏的唯一复合索引（`null`如果不存在，它会将值设置为，而当它是非复合索引时，它不会将字段添加到索引中）。见[https://jira.mongodb.org/browse/SERVER-2193](https://jira.mongodb.org/browse/SERVER-2193)

在我的特殊情况下，我有`events`. 它们可以是一次性的，也可以是重复的。我有一个字段，该字段`parent`仅在事件是重复事件的实例时才存在（我定期创建父项的新副本以在系统中的下几周拥有重复事件）。

我想我只是添加这个索引，以防止 cronjob 运行两次时出现重复副本

```
events.ensureIndex({ dateFrom: 1, dateTo: 1, parent: 1 }) { sparse: true, unique: true } 
```

不幸的是，如上所述，MongoDB 不支持`sparse`复合索引。这意味着对于一次性事件，该`parent`字段不存在并且`null`由 MongoDB 设置。如果我现在同时有第二个一次性事件，它会导致重复键错误，我只在设置 parent 时才需要。

有任何想法吗？

编辑：我见过[MongoDB: Unique and sparse complex index with sparse values](https://stackoverflow.com/questions/11386674/mongodb-unique-and-sparse-compound-indexes-with-sparse-values)，但是在应用程序级别检查唯一性是不行的。我的意思是这就是数据库的用途，以**保证**唯一性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-23T16:03:32.257

您可以添加第四个字段，即 dateFrom+dateTo+parent（字符串连接）。当 parent 为 null 时，选择一个 uid，例如从 ObjectId 函数中，然后索引该字段（唯一）。

通过这种方式，您可以强制执行您想要的唯一性。但是，除了强制执行此约束之外，您几乎无法将其用于其他任何事情。（尽管诸如“获取字符串以 blah blah 开头的文档”之类的查询可能非常有效）

# c# - 在 Windows 资源管理器中缓存数据（文件和文件夹）。我应该采取哪种方法？

> ID：16058266
> 
> 赞同：1
> 
> 时间：2013-04-17T11:01:13.140
> 
> 标签：c#, c++, windows, vb.net, winapi

在我的应用程序中，我从服务器获取数据并在 Windows 资源管理器中显示该数据。数据采用文件和文件夹的形式。你可以想象我机器上的一个映射驱动器，它在服务器上有数据，我可以通过 Windows 资源管理器浏览这些数据。

我的应用程序的问题是，每次我打开或关闭文件夹时，它都会从服务器获取数据。这是一个多余的调用并引发性能问题，因为数据大小可能会增长到 GB。

我在想的是在我的机器上缓存这些数据，它应该与服务器上的数据同步。

我应该如何实现这个？我可以在我的机器上使用任何轻量级数据库作为缓存吗？或者还有其他方法可以做到这一点。

# c++ - Qt: c++: QTableView 不显示我的模型

> ID：16058270
> 
> 赞同：2
> 
> 时间：2013-04-17T11:01:23.327
> 
> 标签：c++, qt, model, qtableview

我正在`model`使用以下代码创建一个：

```
QStandardItemModel table_model(4,4);
    for(int row=0; row<4; row++){
        for (int column=0; column<4; column++){
            QStandardItem* item = new QStandardItem((QString("100")));
            table_model.setItem(row,column,item);
        }
    } 
```

然后，我将其传递给`QTableView`如下：

```
QStandardItemModel* model = &table_model;
ui->table->setModel(model);
ui->table->show(); 
```

然而有些不对劲。什么都没有显示`QTableView`，只是到处都是空白。然而，当且仅当我单击触发按钮（创建模型并将其链接到`QTableView`）我可以看到 4x4 表，但没有任何数据。在“点击”之后，一切都消失了（这只是点击按钮的那一刻）..

所以我错过了什么？- 谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:21:37.733

您在堆栈上创建模型并传递一个指针，该指针在您离开声明它的方法后立即变得无效。

```
QStandardItemModel * table_model = new QStandardItemModel(4,4); 
```

# c - iTunes COM for Windows SDK IITUserPlaylist::AddFile 访问冲突

> ID：16058271
> 
> 赞同：0
> 
> 时间：2013-04-17T11:01:25.420
> 
> 标签：c, com, itunes-sdk

我只是尝试编写简单的程序进行一些练习。但是 iTunes COM for Windows SDK 让我有点意外。我想创建播放列表并向其中添加文件，但是当我调用 IITUserPlaylist::AddFile 时程序崩溃并出现访问冲突。我可以使用所有其他方法，例如删除等。

项目（MSVC10）：[http ://www76.zippyshare.com/v/34795637/file.html](http://www76.zippyshare.com/v/34795637/file.html)

```
#include <iostream>
#include <windows.h>
#include <comutil.h>
#include "iTunesCOMInterface.h"

int main(int argc, char* argv[])
{
CoInitialize(0);

HRESULT  hRes;
IiTunes* itunes = 0;

// note - CLSID_iTunesApp and IID_IiTunes are defined in iTunesCOMInterface_i.c
hRes = ::CoCreateInstance(CLSID_iTunesApp, NULL, CLSCTX_LOCAL_SERVER, IID_IiTunes, (PVOID *)&itunes);
if(hRes != S_OK && itunes == nullptr)
{
    std::cout << "Can not create iTunesApp instance" << std::endl;
    CoUninitialize();
    return 1;
}

IITLibraryPlaylist* mainLibrary = 0;
hRes = itunes->get_LibraryPlaylist(&mainLibrary);
if(hRes != S_OK || mainLibrary == 0)
{
    std::cout << "Can not get main library" << std::endl;

    itunes->Release();
    CoUninitialize();
    return 1;
}

IITSource* mainLibrarySource = 0;
hRes = itunes->get_LibrarySource(&mainLibrarySource);
if(hRes != S_OK || mainLibrarySource == 0)
{
    std::cout << "Can not get library source" << std::endl;

    mainLibrary->Release();
    itunes->Release();
    CoUninitialize();
    return 1;
}

IITPlaylistCollection* playlistCollection = 0;
hRes = mainLibrarySource->get_Playlists(&playlistCollection);
if(hRes != S_OK || playlistCollection == 0)
{
    std::cout << "Can not get source playlists" << std::endl;

    mainLibrarySource->Release();
    mainLibrary->Release();
    itunes->Release();
    CoUninitialize();
    return 1;
}

BSTR playlistName = SysAllocString(L"SoundFrost playlist");

IITPlaylist* ownPlaylist = 0;
//TODO: But there can be additional playlists with the same name, since playlist names are not unique
hRes = playlistCollection->get_ItemByName(playlistName, &ownPlaylist);
if(hRes != S_OK || ownPlaylist == 0)
{
    //just create new
    hRes = itunes->CreatePlaylist(playlistName, &ownPlaylist);
    if(hRes != S_OK || ownPlaylist == 0)
    {
        std::cout << "Can not create playlist";

        SysFreeString(playlistName);

        playlistCollection->Release();
        mainLibrarySource->Release();
        mainLibrary->Release();
        itunes->Release();
        CoUninitialize();
        return 1;
    }
}
SysFreeString(playlistName);

ITPlaylistKind playlistKind;
hRes = ownPlaylist->get_Kind(&playlistKind);
if(hRes == S_OK && playlistKind == ITPlaylistKindUser)
{
    IITUserPlaylist* ownUserPlaylist = static_cast<IITUserPlaylist*>(ownPlaylist);
    if(ownUserPlaylist != 0)
    {
        BSTR filePath = SysAllocString(L"C:\\test.mp3");
        IITOperationStatus* status;
        //hRes = mainLibrary->AddFile(filePath, &status);
        //hRes = ownUserPlaylist->AddFile(filePath, &status);
        SysFreeString(filePath);
    }
}

playlistCollection->Release();
ownPlaylist->Release();
mainLibrarySource->Release();
mainLibrary->Release();
itunes->Release();

CoUninitialize();

return 0; 
```

}

如果我调用 IITLibraryPlaylist::AddFile 一切都是正确的。只需取消注释 95 或 96 行即可进行测试。

简单的 C# 代码可以正常工作：

```
iTunesApp itunes = new iTunesLib.iTunesApp();
IITUserPlaylist playlist = itunes.CreatePlaylist("C# playlist") as IITUserPlaylist;
IITOperationStatus status = playlist.AddFile("C:\\test.mp3"); 
```

我不明白为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T15:26:01.777

你不能用 COM 真正做到这一点：

```
IITUserPlaylist* ownUserPlaylist = static_cast<IITUserPlaylist*>(ownPlaylist); 
```

您只是将一个接口指针转换为另一个接口指针。您必须改为使用[QueryInterface](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682521.aspx)：

```
HRESULT hr = ownPlaylist->QueryInterface(IID_IITUserPlaylist, (void**)&ownUserPlaylist); 
```

# c# - ModelMetadata TemplateHint 始终为空

> ID：16058272
> 
> 赞同：3
> 
> 时间：2013-04-17T11:01:32.933
> 
> 标签：c#, asp.net-mvc-3, data-annotations, modelmetadata, modelmetadataprovider

我正在尝试创建一个自定义`ModelMetadataProvider`来为 JQuery UI 自动完成小部件提供不显眼的属性。

我有一个看起来像这样的自定义属性：

```
[AttributeUsage(AttributeTargets.Property, AllowMultiple = false)]
public sealed class AutocompleteAttribute : Attribute, IMetadataAware
{
    public void OnMetadataCreated(ModelMetadata metadata)
    {
        metadata.TemplateHint = "Autocomplete";
    }
} 
```

和一个如下所示的编辑器模板：

```
@{
    var attributes = new RouteValueDictionary
    {
        {"class", "text-box single-line"},
        {"autocomplete", "off"},
        {"data-autocomplete-url", "UrlPlaceholder" },
    };
}

@Html.TextBox("", ViewContext.ViewData.TemplateInfo.FormattedModelValue, attributes) 
```

我有一个视图模型，其类型属性`string`包括`AutocompleteAttribute`以下内容：

```
public class MyViewModel
{
    [Autocomplete]
    public string MyProperty { get; set; }
} 
```

当我在我的视图中使用这个 viewModel 时，我检查生成的 html 并且我得到一个`<input>`具有如下属性的标签：`data-autocomplete-url="UrlPlaceholder"`.

我接下来要做的是能够在我的视图中指定使用我的 viewModel 的 URL，如下所示：

```
@model MyViewModel

@{ ViewBag.Title = "Create item"; }

@Html.AutoCompleteUrlFor(p => p.MyProperty, UrlHelper.GenerateUrl(null, "Autocomplete", "Home", null, Html.RouteCollection, Html.ViewContext.RequestContext, true))

// Other stuff here...

<div>
    @Html.ActionLink("Back to List", "Index")
</div> 
```

我的`AutoCompleteForUrl`助手只是将生成的 URL 保存在字典中，使用属性名称作为键。

接下来我创建了一个自定义`ModelMetadataProvider`并使用这行代码在 global.asax 中注册它`ModelMetadataProviders.Current = new CustomModelMetadataProvider();`。

我想要做的是将要由 JQuery UI 自动完成小部件使用的 URL 插入到要`metadata.AdditionalValues`由自动完成编辑器模板使用的字典中。

我的自定义`ModelMetadataProvider`看起来像这样：

```
public class CustomModelMetadataProvider : DataAnnotationsModelMetadataProvider
{
    protected override ModelMetadata CreateMetadata(IEnumerable<System.Attribute> attributes, Type containerType, Func<object> modelAccessor, Type modelType, string propertyName)
    {
        var metadata = base.CreateMetadata(attributes, containerType, modelAccessor, modelType, propertyName);

        if (metadata.TemplateHint == "Autocomplete")
        {
            string url;
            if(htmlHelpers.AutocompleteUrls.TryGetValue(metadata.propertyName, out url)
            {
                metadata.AdditionalValues["AutocompleteUrl"] = url;
            }
        }

        return metadata;
    }
} 
```

我更新的编辑器模板如下所示：

```
@{
    object url;

    if (!ViewContext.ViewData.ModelMetadata.TryGetValue("AutocompleteUrl", out url))
    {
        url = "";
    }

    var attributes = new RouteValueDictionary
    {
        {"class", "text-box single-line"},
        {"autocomplete", "off"},
        {"data-autocomplete-url", (string)url },
    };
}

@Html.TextBox("", ViewContext.ViewData.TemplateInfo.FormattedModelValue, attributes) 
```

问题是，`TemplateHint`在我的自定义模型元数据提供程序中，该属性永远不会等于“自动完成”，因此我生成 URL 的逻辑永远不会被调用。我会认为此时该属性将被设置为`TemplateHint`我称之为`CreateMetadata`.`DataAnnotationsModelMetadataProvider`

这是我可以确认的：

*   已`CustomModelMetadataProvider`正确注册，因为它包含正在调用的其他代码。
*   由于生成的 Html 包含一个名为`"data-autocomplete-url"`.
*   如果我在自动完成模板中放置一个断点，Visual Studio 会转到调试器。

那么任何人都可以为我解释一下吗？我对`ModelMetadataProvider`系统有什么误解？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T20:01:11.507

在查看了 ASP.NET MVC 3 源代码后，我发现这是因为该方法是在应用于模型的任何属性`CreateMetadata`的方法之前调用的。`OnMetadataCreated``IMetadataAware`

我找到了一种替代解决方案，可以让我做我想做的事。

首先我更新了我的`AutocompleteAttribute`：

```
[AttributeUsage(AttributeTargets.Property, AllowMultiple = false)]
public class AutocompleteAttribute : Attribute, IMetadataAware
{
    public const string Key = "autocomplete-url";
    internal static IDictionary<string, string> Urls { get; private set; }

    static AutocompleteAttribute()
    {
        Urls = new Dictionary<string, string>();
    }

    public void OnMetadataCreated(ModelMetadata metadata)
    {
        metadata.TemplateHint = "Autocomplete";

        string url;

        if (Urls.TryGetValue(metadata.PropertyName, out url))
        {
            metadata.AdditionalValues[Key] = url;
            Urls.Remove(metadata.PropertyName);
        }
    }
} 
```

我在视图中设置 url 的 Html 辅助方法如下所示：

```
public static IHtmlString AutocompleteUrlFor<TModel, TValue>(this HtmlHelper<TModel> html, Expression<Func<TModel, TValue>> expression, string url)
{
    if (string.IsNullOrEmpty(url))
        throw new ArgumentException("url");

    var property = ModelMetadata.FromLambdaExpression(expression, html.ViewData).PropertyName;
    AutocompleteAttribute.Urls[property] = url;

    return MvcHtmlString.Empty;
} 
```

然后我在编辑器模板中要做的就是：

```
@{
    object url;
    ViewData.ModelMetadata.AdditionalValues.TryGetValue(AutocompleteAttribute.Key, out url);

    var attributes = new RouteValueDictionary
    {
        {"class", "text-box single-line"},
        {"autocomplete", "off"},
        { "data-autocomplete-url", url },
    };
}

@Html.TextBox("", ViewContext.ViewData.TemplateInfo.FormattedModelValue, attributes) 
```

# c - C解析字符串划分

> ID：16058273
> 
> 赞同：3
> 
> 时间：2013-04-17T11:01:39.970
> 
> 标签：c, parsing

我讨厌成为那个问简单问题的人，但我的 C 语言有点生疏，这里有一些东西在躲避我。我正在尝试使用以下示例文本读取文件：

```
 23# 1110.00:1000.00,120.00:1110.00,1190.00:900.00,-52.98,-53.21 
```

我想将除以基数和昏迷的元素分成几个字符串，但是在我的控制台中根本没有得到任何输出。

```
 #include <stdio.h>   /* required for file operations */
    #include <conio.h>  /* for clrscr */
    #include <dos.h>  /* for delay */

    FILE *fr;            /* declare the file pointer */

    #include <stdio.h>
    int main(void)
    {
        char output[200];
        const char filename[] = "file.txt";
        FILE *file = fopen(filename, "r");
        if ( file )
        {
            char line [ BUFSIZ ];
            while ( fgets(line, sizeof line, file) )
            { printf(" %s \n", line);

                char * i[80],pt1[80], pt2[80], pt3[80], tp1[80], tp2[80];
                if ( sscanf(line, "%s# %s,%s,%s,%s,%s",
                        &i, &pt1, &pt2, &pt3, &tp1, &tp2) == 6 )
                {
                    snprintf(output, sizeof output,
                            "Leitura:=%s,PT1=%s,PT2=%s,PT3=%s,TP1=%s,TP2=%s,",
                            i, pt1, pt2, pt3, tp1, tp2);
                    puts(output);
                }
            }
        }
        else
        {
            perror(filename);
        }
        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T11:09:15.867

问题是[`sscanf()`](http://en.cppreference.com/w/c/io/fscanf)不会将其视为`#`或`,`作为分隔符，只有空格。这意味着`"%s"`它将完全读取`"1110.00:1000.00,120.00:1110.00,1190.00:900.00,-52.98,-53.21"`，导致可能的缓冲区溢出并且绝对`6`不是结果。

一个解决方案是使用扫描集：

```
if (sscanf(line,
           "%79[^#]# %79[^,],%79[^,],%79[^,],%79[^,],%s",
           i,
           pt1,
           pt2,
           pt3,
           tp1,
           tp2) == 6 ) 
```

此外，声明`i`不正确：

```
char * i[80],pt1[80], pt2[80], pt3[80], tp1[80], tp2[80]; 
```

因为它制作`i`了一个 80 的数组`char*`。改成：

```
char i[80],pt1[80], pt2[80], pt3[80], tp1[80], tp2[80]; 
```

# c++ - 读取然后处理流数据

> ID：16058275
> 
> 赞同：1
> 
> 时间：2013-04-17T11:01:45.307
> 
> 标签：c++, stream

我正在处理来自 Accelerated C++ 的问题 4-6。问题要求我重写`Student_info`结构、`read()`函数和`grade()`函数，以便立即计算最终成绩，然后将其作为唯一成绩存储在`Student_info`.

以前，该程序的工作方式如下：

1.  `read()`从输入流中读取数据并将数据存储到`Student_info`对象中
2.  每个对象都被添加到一个向量中
3.  一旦读取并添加了每个对象，就会在向量中的`grade()`每个对象上调用`Student_info`

有了新的约束，我觉得我必须结合`read()`and`grade()`函数，所以没有必要存储中间等级。问题是从流中读取时，我不知道我是否遇到了文件末尾，直到我这样做。执行此操作时，我尝试在`grade()`文件数据末尾调用该函数。

考虑到约束是读取然后立即处理数据，我没有看到解决方法。如何处理？

```
struct Student_info 
{
    std::string name;
    double final_grade;
};

istream& read(istream& is, Student_info& s)
{
    double midterm, final;
    is >> s.name >> midterm >> final;

    // Error, when EOF is read, grade() will process bad data
    s.final_grade = grade(midterm, final);
    return is;
}

void main()
{
    vector<Student_info> students;
    Student_info record;
    while (read(cin, record))
        students.push_back(record);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T12:36:26.847

您可以在函数内部检查记录是否已成功读取`read`。例如像这样：

```
istream& read(istream& is, Student_info& s)
{
    string name;
    double midterm, final;

    if( is >> name >> midterm >> final ) {
        s.name = name;
        s.final_grade = grade(midterm, final);
    }

    return is;
} 
```

请注意，您*可以*像在原始代码中一样直接读取`s.name`，但我的实现具有事务语义：它要么读取整个结构，要么不理会它，以防它无法读取所有字段。

# android - 如何以编程方式访问android根目录（/system/app）？

> ID：16058277
> 
> 赞同：1
> 
> 时间：2013-04-17T11:01:50.153
> 
> 标签：android, android-assets, android-install-apk

我在资产文件夹中有一个 apk 文件。
现在我需要创建一个程序，将该 apk 文件安装为系统应用程序。
手动可以通过以下步骤将该apk文件复制到sdcard中，

```
$ adb push MyApk.apk /sdcard/ 
$ adb shell
$ su
$ mount -o remount,rw -t yaffs2 /dev/block/mtdblock3 /system
$ cat /sdcard/MyApk.apk > /system/app/MyApk.apk
$ pm install /system/app/MyApk.apk 
```

但是可以通过代码来完成吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T05:28:00.203

[请参考以下代码，借助RootTools](https://code.google.com/p/roottools/w/list)方法将用户应用程序 apk 移动到生根设备中的系统应用程序 apk 中。

```
 PackageInfo paramPackageInfo = null;
        try {
            paramPackageInfo = this.getPackageManager().getPackageInfo(
                    this.getPackageName(), 0);
        } catch (NameNotFoundException e) {
            e.printStackTrace();
        }

        ApplicationInfo localApplicationInfo = paramPackageInfo.applicationInfo;

String str1 = "/system/app/" + localApplicationInfo.packageName
                + ".apk";
        String str2 = "busybox mv " + localApplicationInfo.sourceDir + " "
                + str1;

        RootTools.remount("/system", "rw");
        RootTools.remount("/mnt", "rw");

        CommandCapture command = new CommandCapture(0, str2,
                "busybox chmod 644 " + str1);

        try {
            RootTools.getShell(true).add(command).waitForFinish();
        } catch (InterruptedException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        } catch (TimeoutException e) {
            e.printStackTrace();
        } catch (RootDeniedException e) {
            e.printStackTrace();
        }

        RootTools.remount("/system", "ro");
        RootTools.remount("/mnt", "ro"); 
```

在您的应用程序中使用上述代码时需要 Busybox 和超级用户应用程序。

# sql - Oracle 中 regexp_replace 与 translate 的性能？

> ID：16058279
> 
> 赞同：10
> 
> 时间：2013-04-17T11:01:52.747
> 
> 标签：sql, regex, performance, oracle, plsql

`translate`对于简单的事情，在 CPU 密集度较低的前提下使用该功能更好还是可行`regexp_replace`的方法？

这个问题来自[如何在 Oracle REGEXP_REPLACE 函数中将括号替换为连字符？](https://stackoverflow.com/questions/16054892/how-can-i-replace-brackets-to-hyphens-within-oracle-regexp-replace-function)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-17T11:07:54.680

我认为您遇到了简单的优化。regexp 表达式的计算成本非常高，以至于结果被缓存以希望将来再次使用它。如果您实际使用不同的字符串进行转换，您会发现适度的翻译自然更快，因为它是它的特殊功能。

这是我的示例，运行在`11.1.0.7.0`：

```
SQL> DECLARE
  2     TYPE t IS TABLE OF VARCHAR2(4000);
  3     l       t;
  4     l_level NUMBER := 1000;
  5     l_time  TIMESTAMP;
  6     l_char  VARCHAR2(4000);
  7  BEGIN
  8     -- init
  9     EXECUTE IMMEDIATE 'ALTER SESSION SET PLSQL_OPTIMIZE_LEVEL=2';
 10     SELECT dbms_random.STRING('p', 2000)
 11       BULK COLLECT
 12       INTO l FROM dual
 13     CONNECT BY LEVEL <= l_level;
 14     -- regex
 15     l_time := systimestamp;
 16     FOR i IN 1 .. l.count LOOP
 17        l_char := regexp_replace(l(i), '[]()[]', '-', 1, 0);
 18     END LOOP;
 19     dbms_output.put_line('regex     :' || (systimestamp - l_time));
 20     -- tranlate
 21     l_time := systimestamp;
 22     FOR i IN 1 .. l.count LOOP
 23        l_char := translate(l(i), '()[]', '----');
 24     END LOOP;
 25     dbms_output.put_line('translate :' || (systimestamp - l_time));
 26  END;
 27  /

regex     :+000000000 00:00:00.979305000
translate :+000000000 00:00:00.238773000

PL/SQL procedure successfully completed 
```

上`11.2.0.3.0`：

```
regex     :+000000000 00:00:00.617290000
translate :+000000000 00:00:00.138205000 
```

结论：总的来说，我怀疑`translate`会赢。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T11:01:52.747

对于 SQL，我使用以下脚本对此进行了测试：

```
set timing on

select sum(length(x)) from (
  select translate('(<FIO>)', '()[]', '----') x
  from (
    select *
    from dual
    connect by level <= 2000000
  )
);

select sum(length(x)) from (
  select regexp_replace('[(<FIO>)]', '[\(\)\[]|\]', '-', 1, 0) x
  from (
    select *
    from dual
    connect by level <= 2000000
  )
); 
```

并发现 和 的性能`translate`几乎`regexp_replace`总是相同的，但可能是其他操作的成本超过了我尝试测试的功能的成本。

接下来，我尝试了一个 PL/SQL 版本：

```
set timing on

declare
  x varchar2(100);
begin
  for i in 1..2500000 loop
    x := translate('(<FIO>)', '()[]', '----');
  end loop;
end;
/

declare
  x varchar2(100);
begin
  for i in 1..2500000 loop
    x := regexp_replace('[(<FIO>)]', '[\(\)\[]|\]', '-', 1, 0);
  end loop;
end;
/ 
```

这里的`translate`版本只需要不到 10 秒，而`regexp_replace`版本大约需要 0.2 秒——快了大约 2 个数量级（！）

基于这个结果，我将在我的性能关键代码中更频繁地使用正则表达式——SQL 和 PL/SQL。

# domain-driven-design - 具有动态父实体的域实体

> ID：16058281
> 
> 赞同：0
> 
> 时间：2013-04-17T11:01:54.543
> 
> 标签：domain-driven-design

EntityA 是一个聚合根，有许多 EntityB 实体。EntityB 有许多 EntityC 实体。EntityC 正在引用 EntityB（原始父级）和 EntityA（创建 EntityC 时为空）。

有一次，我想将 EntityA 设置为 EntityC 的“新父级”，因此在 EntityC 中，我将对原始 EntityB 父级的引用设置为 null，并将对 EntityA 的引用设置为（之前为 null）。

这种“动态实体父”的想法是否与 DDD 兼容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T04:33:18.267

您的想法绝对与 DDD 兼容。但是，如何实施它很重要。

正如 eulerfx 所指出的，这里的聚合设计是相关的。不过，我确实怀疑您可能有某种形式的分类结构。这意味着该结构的表示可能会成为一组新的实体/聚合。或者，如果不是一个完整的子域，那么可能有实体中的值对象表示的分类。但是，如果您发现自己处于该位置，则在聚合中引用其他聚合有点危险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T15:24:42.710

设计聚合时的主要考虑因素之一是将其视为一致性边界。所以当你考虑是否应该表达组成实体之间的各种关系时，考虑这些关系是否需要实现行为，以及它们是否需要在执行所述行为后保持一致。DDD 并没有规定对象模型本身的实现，而是规定了对行为和事务一致性的关注。也很多时候，实现关系以支持查询场景。在这些情况下，不要污染聚合，而是创建一个单独的[read-model](http://gorodinski.com/blog/2012/04/25/read-models-as-a-tactical-pattern-in-domain-driven-design-ddd/)。另外，看看[有效的聚合设计](https://vaughnvernon.co/?p=139)。

# objective-c - Grails API 结合 Native IOS 应用程序

> ID：16058293
> 
> 赞同：0
> 
> 时间：2013-04-17T11:02:20.190
> 
> 标签：objective-c, api, grails

我目前创建了一个本地 IOS 应用程序，现在我正在开发 grails 后端。

我对 API 概念有点陌生，所以我正在寻找一些涵盖以下问题的好教程：

*   从 IOS 应用程序到 API 的身份验证如何使用 JSON 进行？
*   如何使用 JSON 将帖子推送到后端？

我了解如何在 grails 中编写一个可以发送 ae 书籍列表的 API，但是在移动应用程序中，用户可以定义自己的项目（在这种情况下为模板）。当用户在另一部手机上使用他的凭证时，他的物品需要转移到手机上。我目前使用 spring security 在后端应用程序上对用户进行身份验证

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:10:04.333

为了在您的 IOS 应用程序中实现其余 API 客户端，我建议您查看[这个库](https://github.com/samvermette/SVHTTPRequest)。

适合您的应用和 API 的身份验证方法不是一个简单的问题，它取决于应用的功能和方式。使用 API 验证应用程序的更标准方式是[OAuth 2.0](http://oauth.net/2/)

# winforms - 如何有条件地禁用 Windows 按钮？

> ID：16058294
> 
> 赞同：0
> 
> 时间：2013-04-17T11:02:22.520
> 
> 标签：winforms, button

我正在开发一个简单的应用程序，让用户解决河内塔谜题。我需要能够有条件地禁用界面上的某些按钮。（即，如果某个特定动作违反规则，则必须禁用该动作的按钮）。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:06:19.330

你应该在移动后做一些检查，看看哪些按钮是允许的，一个简单的`button.Enabled = false`应该禁用你的按钮

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:11:50.100

您可以在移动事件上禁用按钮，如果移动违反规则，请设置`button.Enabled = false`

或者，如果移动违反规则，您可以简单地忽略按钮单击事件上的按钮操作。

## 编辑

您可能已经有了移动拼图的事件，在这些事件上您可以验证规则。

例如，在您的事件调用方法中，根据规则启用、禁用按钮

```
private void CheckState()
{
    if(!CheckRuleOne())
    {
      button1.Enabled = false;
    }
   // more rules and validations ....
} 
```

# security - 错误：OAuth 2 参数只能有一个值：hd

> ID：16058300
> 
> 赞同：13
> 
> 时间：2013-04-17T11:02:38.030
> 
> 标签：security, oauth-2.0

将应用程序限制为使用 OAuth 登录到一个域（例如 abc.com）。通过以下步骤获取错误：

1.  在谷歌浏览器中使用多个帐户登录。
2.  在尝试使用未提及域的用户登录时，没有任何反应（没有错误消息）。尝试使用无效用户登录两次。
3.  现在尝试使用有效用户登录。

这样做会发生以下错误：

> OAuth 2 参数只能有一个值：hd

在错误堆栈跟踪客户端 ID 是可见的。这是安全风险吗？

如何修复此错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-08-04T08:01:44.340

根据[文档，hd 参数](https://developers.google.com/identity/protocols/OpenIDConnect#hd-param)适用于 G Suite，因此您可能正在重复 hd 参数，一个与您的托管域一起使用`hd=*`，另一个与您的托管域一起使用。还指出您不应依赖此 UI 优化来控制对您的应用程序的访问。

> 在错误堆栈跟踪客户端 ID 是可见的。这是安全风险吗？

没有任何。[这不是秘密](https://www.rfc-editor.org/rfc/rfc6749#section-2.2)。它用于调试目的。

> 如何修复此错误？

尝试替换参数`hd`而不是添加一个新参数。一般来说，这应该与您请求的每个参数一起完成。当您重复参数时，[OAuth2 文档也会](https://www.rfc-editor.org/rfc/rfc6749#section-5.2)指出错误。`invalid_request`

# javascript - 有没有办法让打字稿检测我何时从函数返回未定义？

> ID：16058308
> 
> 赞同：3
> 
> 时间：2013-04-17T11:03:25.790
> 
> 标签：javascript, function, typescript

我希望打字稿能够检测到函数何时可以返回未定义的值并警告我。我尝试了以下操作，但打字稿网站上的操场编辑器没有显示任何警告

```
class Test {

    get(key: string) :string{

        var hash = {'some-key': 1, 'some-other-key': 3};

        return hash[key]

    }    

} 
```

当您明确声明它应该只返回某些特定类型时，是否可以让打字稿在有时可能返回未定义值时发出警告？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T15:20:13.800

TypeScript 不会`hash[key]`像使用`hash.myKey`. 因此，要获得设计时和编译时检查，您必须更改公开此信息的方式以允许代码使用点属性语法...

所以而不是：

```
class Test {
    get(key: string) :string{
        var hash = {'some-key': 1, 'some-other-key': 3};
        return hash[key];
    }    
}

var test = new Test();
test.get('myKey'); 
```

你可以暴露：

```
class Test {
    public hash = { someKey: 1, someOtherKey: 3};
}

var test = new Test();
test.hash.myKey; // you'll get a warning here 
```

这仅在此设计适合您正在做的事情时才有效 - 但您会以这种方式收到警告，因为 TypeScript 将为它创建一个匿名类型`hash`并确保仅使用已知属性。

更新：我根据反馈更新了示例。值得注意的是，虽然 using`'some-key'`会阻止您使用点表示法（因此，如果可以的话，绝对值得删除连字符） - 您仍然可以获得代码完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T01:45:19.720

正如史蒂夫提到的，您可以使用属性访问 (.) 而不是索引访问 ([string])。但这只有在您的属性遵循打字稿命名约定时才有效。即属性名称不能包含“-”，例如以下作品：

```
class Test {
    public hash = {'someKey': 1, 'someOtherKey': 3};
}

var test = new Test();
test.hash.someKey;// Valid
test.hash.myKey; // you'll get a warning here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T12:44:33.730

它可能不会阻止您意外返回 undefined，但您的代码肯定会返回 undefined，如下所示：

```
class Test {

    get(key: string) :string{

        var hash = {'some-key': 1, 'some-other-key': 3};

        return hash[key]

    }    

}

var test = new Test();
alert(test.get("asdf")); 
```

TypeScript 需要支持 CodeContracts 之类的东西才能完成您的要求。

# c# - MiniProfiler MvcSiteMapProvider

> ID：16058309
> 
> 赞同：1
> 
> 时间：2013-04-17T11:03:26.033
> 
> 标签：c#, .net, asp.net-mvc-4, mvc-mini-profiler

**历史**

在静态内容页面上，我们的加载时间超过 6 秒，这似乎发生在“渲染：索引”周围，我们已经设法解决了它的 MvcSiteMapProvider

```
*Executing Controller: Eclipse.Wi.Areas.Workin...    2.1     6314.6 +3.9    
   Find: Index   0.0     0.0    +6.0    
   Render : Index    6306.4  6312.5 +6.0* 
```

我们正在使用 StackExchange MVC 分析器和 MvcSiteMapProvider（下面的链接）

[http://www.nuget.org/packages/MvcSiteMapProvider](http://www.nuget.org/packages/MvcSiteMapProvider)

[http://nuget.org/packages/MiniProfiler/](http://nuget.org/packages/MiniProfiler/)

**问题**

我们如何使用 Profiler 来分析 MvcSiteMapProvider，这样我们就可以评估为什么使用 3 个菜单时加载时间如此之长。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:16:38.570

Mini-profiler 是一个相当简单（但有效）的分析器；它不包括侵入性地钻入外部代码的钩子。我希望使用 mini-profiler，因为您需要[从 source](https://github.com/maartenba/MvcSiteMapProvider)进行自定义构建，并添加显式的分析步骤。这可能并不过分繁重，但还有其他*一些*专为侵入式分析而设计的工具可能更方便（但对整体性能的影响更大）。

# ruby-on-rails - 在 Rails 中使用 ldap 进行身份验证？

> ID：16058315
> 
> 赞同：2
> 
> 时间：2013-04-17T11:03:44.563
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ldap

我是 ldap 的新手，我已经搜索了相当长的时间，但找不到继续的步骤。我已经说明了我的要求

我想允许用户使用`ldap`凭据登录，成功后`login`我想将用户保存在用户模型中并重定向到下一页，该页面将包含特定于用户的项目。

如果用户已经存在于用户模型中，那么它应该被更新。我怎样才能做到这一点？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:18:27.777

[Devise](https://github.com/plataformatec/devise)是管理用户身份验证的绝佳工具，并且有一个名为[Devise LDAP Authenticable](https://github.com/cschiewek/devise_ldap_authenticatable)的 LDAP 插件可以满足您的需求。这是一个很好的截屏视频，演示了如何针对 LDAP 服务器设置简单的用户登录：

[http://corrupt.net/2010/07/05/LDAP-Authentication-With-Devise/](http://corrupt.net/2010/07/05/LDAP-Authentication-With-Devise/)

截屏视频是几年前发布的，因此请务必阅读 Devise 和 LDAP 插件的完整文档。

使用 Devise 时，您可以通过覆盖 ApplicationController 中的 after_sign_in_path_for 并让它返回您希望用户看到的页面的路径来控制用户在登录后被重定向到的位置

```
def after_sign_in_path_for(resource)
  some_other_path
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:15:29.413

使用设计 gem 进行身份验证。它会照顾你的要求。如需更多参考，请参阅此

[https://github.com/plataformatec/devise](https://github.com/plataformatec/devise)

# knockout.js - Knockout js '文章' 预览框

> ID：16058316
> 
> 赞同：0
> 
> 时间：2013-04-17T11:03:44.643
> 
> 标签：knockout.js, ckeditor, wysiwyg

最近拿起了 knockoutjs，我正在尝试制作一个预览框，当我在所见即所得的编辑器中编写它时，它将在 div 中呈现 html。现在我正试图让我写的文本呈现在一个 div 中，但它似乎与所见即所得的编辑器冲突。我通过渲染在普通`<textarea>`字段中编写的文本来测试脚本，没有问题，工作正常。但是，当我尝试在所见即所得编辑器中执行相同操作时，它不会呈现任何内容。

我正在使用 CKeditor 顺便说一句。我基本上有这个：

```
<textarea name="body" data-bind="value: body"></textarea>
<script type="text/javascript">
   CKEDITOR.replace('body');
</script> 
```

Ckeditor 默认需要一个`<textarea>`名为“body”的字段，它将被编辑器界面替换。

脚本本身就像我提到的那样工作，它适用于`<textarea>`正常`CKEDITOR.replace`的`<textarea>`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T15:38:32.413

问题在于 ckeditor 将其替换为 contenteditable 并且它不知道任何值绑定。您可以编写一个 customBindingHandler 来执行此操作。不久前我为 CLEditor 写了一个。这是它的样子

```
ko.bindingHandlers.cleditor = {
init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext)             {

    var modelValue = valueAccessor();
    var options = {}

    if (allBindingsAccessor().cleditorOptions)
        options = $.extend(options, allBindingsAccessor().cleditorOptions);

    var ko_editor = $(element).cleditor(options);

    if (allBindingsAccessor().cleditorCSS) {
        var cssLink = ko_editor[0].doc.createElement("link");
        cssLink.rel = "stylesheet";
        cssLink.type = "text/css";
        cssLink.href = allBindingsAccessor().cleditorCSS;
        if (ko_editor[0].doc.head === undefined) {
            var headElement = ko_editor[0].doc.getElementsByTagName('head');
            headElement[0].appendChild(cssLink);
        }
        else
            ko_editor[0].doc.head.appendChild(cssLink);
    }

    ko_editor[0].change(
        function (a) {
            var elementValue = ko_editor[0].doc.body.innerHTML;

            if (ko.isWriteableObservable(modelValue)) {
                modelValue(elementValue);
            }
            else { //handle non-observable one-way binding
                var allBindings = allBindingsAccessor();
                if (allBindings['_ko_property_writers'] && allBindings['_ko_property_writers'].htmlValue) allBindings['_ko_property_writers'].htmlValue(elementValue);
            }
        }
      );

},
update: function (element, valueAccessor) {
    var value = ko.utils.unwrapObservable(valueAccessor()) || "";
    var ko_editor = $(element).cleditor();
    if (ko_editor[0].doc.body.innerHTML !== value) {
        ko_editor[0].doc.body.innerHTML = value;
        ko_editor[0].focus();
    }
}
}; 
```

html看起来像这样

```
<textarea rows="20" data-bind="cleditor: Body, cleditorCSS: 'path/ComposeEditor.css', cleditorOptions:$root.EditorOptions"></textarea> 
```

因此您现在可以提供一个名为 Body 的可观察对象（存储值的位置）、一个 css 和在您的视图模型中指定的选项。

希望对您有所帮助。

# android - 如何在android中索引媒体文件以进行快速搜索

> ID：16058321
> 
> 赞同：2
> 
> 时间：2013-04-17T11:03:50.410
> 
> 标签：android, search, indexing, mp3, media

我有可以从云端播放音乐的音乐应用程序。用户可以下载他们喜欢的歌曲以在没有互联网连接的情况下收听。下载歌曲的早期文件名与其在云中的 ID 完全匹配。例如 a34dsa335dkf.mp3, 34fdnn34n2n1.mp3, ...

这种命名方式方便快速搜索。但对人们来说并不方便，因为像 a34dsa335dkf.mp3 这样的文件名并没有告诉他们任何信息。例如，如果有人想将他下载的歌曲复制到其他地方，他将不知道要复制什么。

我正在寻找一些索引机制，因此我可以将文件命名为人类可读的（例如 Madonna-Frozen.mp3 而不是 a34dsa335dkf.mp3），并且我可以根据需要快速找到这些文件。我不能简单地将文件名与云中的 ID 匹配。因为可能重复。

有人可以给我建议我该怎么做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:55:06.650

我对此没有很好的经验，所以请将此作为新手建议。我建议使用 MP3`metadata`将您的用户 ID 放入并将文件重命名为更具描述性的名称，例如您提到的名称，例如`Madonna-Frozen.mp3`

很少有**Java**库可以读取和写入 MP3 元数据，您可以尝试一下：

*   [`jd3Lib`](http://sourceforge.net/projects/jd3lib/)是一个用 Java 编写的**id3/mp3库。**它提供读取**mpeg**信息的功能，例如比特率、采样率、通道模式等。它还允许读取、写入和删除**id3v1**和**id3v2**标签

*   [`JavaMusicTag`](http://javamusictag.sourceforge.net/docs.htm)该库从 MP3 文件中读取歌曲信息，例如歌曲名称、艺术家和专辑。它支持**ID3v1**、**ID3v1.1**、**Lyrics3v1**、**Lyrics3v2**、**ID3v2.2**、**ID3v2.3**和**ID3v2.4**标签。MP3 帧头也可以读取。有一个**FilenameTag**，一个从文件名智能派生的**ID3v2.4**标记。它包含标签同步实用程序、多个保存选项和简单的标签转换方法。

*   [`JAudioTagger`](http://www.jthink.net/jaudiotagger/)是 Jaikoz 使用的音频标记库，用于标记音频文件中的数据。它目前完全支持**Mp3**、**Mp4**（**Mp4**音频、**M4a**和**M4p**音频）**Ogg**、**Vorbis**、**Flac**和**Wma**，对**Wav**和**Real**格式的支持有限。

我很确定你会从专家那里得到更好的方法。

# php - 谷歌地图全球搜索

> ID：16058324
> 
> 赞同：0
> 
> 时间：2013-04-17T11:04:05.557
> 
> 标签：php, google-places-api, google-places

我正在尝试使用 google places [textSearch](https://developers.google.com/places/documentation/search#TextSearchRequests)来发现某个品牌的所有商店（比如说 Levi's），所以我将使用 next_page_token 遍历结果，但我似乎遇到了返回最多 60 个结果的问题。能否以某种方式提升此结果，或者是否有人知道可以提供这种结果的另一种服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:39:19.800

遗憾的是，除了对 textsearch 进行巧妙的轮询外，没有办法绕过 60 条目的限制，并且无法对结果进行排序。您最好的解决方案是就近搜索。API 参数与 textsearch 几乎相同，但有以下三个不同点：

*   您的半径将自动设置为 50 公里
*   `rankby=distance`允许您按与您的距离对结果进行排序`location`（您会明白为什么这很重要）
*   `query`成为`keywords`并且不再是真正的 Google 地图搜索参数 - 只是关键字列表

返回的结果与返回的结果相似`textSearch`——它们带有一个唯一的 ID，它也会派上用场。

# 如何扫描所有内容

扫描一个区域非常简单。每个查询限制为 60 个结果 - 所以我们要做的是按距离排序，以便我们确定我们的*最后一个*结果也是最远的。这使您可以为您的请求建立一个最大可能的半径 - 并以此为基础您的下一次搜索。

这是 Photoshop 上的模拟结果。我根据法国的一个点运行了一个随机请求，并使用绿色圆圈映射了搜索的半径：

![第一个查询](https://i.stack.imgur.com/KfyAb.png)

绿色圆圈表示结果。这允许我制定三个新查询，所有三个都位于当前区域的边缘（但在其中）：

![第二轮查询](https://i.stack.imgur.com/3C9U0.png)

您会注意到第二个查询完全覆盖了第一个查询。这使您可以在尽可能少的重叠区域中获得全部结果，并按 ID 有效地对它们进行排序（因此您知道您没有重复）。

**警告**：半径 50 公里（最大）将需要 1 次查询。95公里的半径需要四个。140 公里半径需要 13。它会迅速增加 - 所以如果我是你，我会在某处缓存结果。

`id`返回字段保证唯一 -绑定到您的`reference`API 密钥。区别？这`reference`允许您触发地点详细信息请求以获取有关地点的更新信息（[此处为一些信息](https://developers.google.com/places/documentation/details#PlaceDetailsRequests)）。

希望这有助于澄清一些事情。

# java - 计算图表组的公式

> ID：16058330
> 
> 赞同：-2
> 
> 时间：2013-04-17T11:04:12.003
> 
> 标签：java, jfreechart, formula, graph-algorithm

我使用 JFreeChart 库处理图表以生成条形图。

示例场景：考虑到数据将在数组/数组列表中。

![在此处输入图像描述](https://i.stack.imgur.com/SbZae.png)

使用上表数据，我必须生成下表（前 2 列）和条形图

![在此处输入图像描述](https://i.stack.imgur.com/0JMJI.png)

分类方法

```
Number of days taken by person into 
Number of people between two days(column 2) and exactly 10 values in x axis. 
```

我正在寻找一种方法来获取第 2 列的值并让我自己休息。如果需要，我很乐意提供更多信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:31:13.803

简单的回答，

```
always set min = 0
max = maximum number in the column Number of days taken
divide the maximum by 10, interval = max/10
and start from to 0 to interval and  interval to interval+ interval ...., 
```

# bash - 为什么我的 bash 提示没有正确转义？

> ID：16058332
> 
> 赞同：0
> 
> 时间：2013-04-17T11:04:24.527
> 
> 标签：bash, command-prompt

我在 .basrhc 文件中定义了以下 bash 提示变量：

`PS1='\u@\h:\[\e[01;34m\] \[$(pwd|sed -e "s!.*/\\([^/]*/[^/]*/[^/]*\\)!\\1!g")\] \[\e[00m\] \[\e[01;31m\]\t\[\e[00m\]\$ '`

从目录 /one/two/three/four/ 中，这看起来像是以下内容的彩色版本：

`me@my-computer two/three/four 12:01:37$`

（我不想把我得到的图像，但我是一个没有代表点的新人..）

我遇到了无法正确转义的问题（我认为这是源代码），因为当向上滚动浏览我的历史记录时，这些行会截断 bash 提示符，并且终端不会在正确的位置显示光标命令行。不过，您可能需要向上滚动几行才能看到这种效果。

我认为问题出在`sed`命令上，但如果正确，我不确定如何解决。
有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T13:22:01.143

您可能希望改为设置 的值`PROMPT_DIRTRIM`。它的工作方式与您想要的略有不同，但它可能足够接近，它是内置的`bash`，并且更容易使用。（注意：`PROMPT_DIRTRIM`是`bash`4.x 的新手（至少 4.1，可能是 4.0））。

```
PROMPT_DIRTRIM=3
PS1='\u@\h:\[\e[01;34m\] \w\[\e[00m\] \[\e[01;31m\]\t\[\e[00m\]\$ ' 
```

您还可以使用该`PROMPT_COMMAND`变量通过将其分解为可管理的步骤来简单地创建提示。`bash`如果`PROMPT_DIRTRIM`不可用或不符合您的喜好，这将适用于早期版本。

```
prompt_cmd () {
    # Trim leading directories off the current working directory.
    # Use single quotes so you don't need to escape the backslashes.
    trimmed_pwd=$( pwd | sed -e 's!.*/\([^/]*/[^/]*/[^/]*\)!\1!g' )

    # The initial part of your prompt
    PS1='\u@\h:\[\e[01;34m\] '
    # Add the directory; no single quotes, so the parameter expands, and
    # no need to wrap it in \[ \]
    PS1+=$trimmed_pwd
    # And the final part of your prompt
    PS1+='\[\e[00m\] \[\e[1;31m\]\t\[\e[00m\]\$ '
}
PROMPT_COMMAND='prompt_cmd' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:31:50.887

在 sed 命令中，单引号和一些简单的正则表达式似乎可以工作。我不知道提示和颜色的东西，希望这会有所帮助。

```
sed 's!..*/\(.*/.*/.*\)!\1!g' 
```

# c++ - （不）在其他像素下方绘制像素的有效方法？

> ID：16058333
> 
> 赞同：0
> 
> 时间：2013-04-17T11:04:24.870
> 
> 标签：c++, drawing, pixel

当在屏幕上绘制多个精灵时（尤其是当这些精灵具有不同的深度（即高于或低于其他精灵）时，您可能最终会在其他像素之上绘制许多像素。

这是低效的，因为如果来自另一个精灵的另一个像素只是在该像素之上绘制，则没有必要设置像素。当有更多的精灵和更大的精灵时，效率低下的问题只会变得更糟。

我只能想到两种传统的方法：

1）只画一切，自下而上并忽略问题（效率不高）

2) 检查是否还没有绘制更高级别的像素，然后绘制。（也效率不高，因为您必须*检查*每一层中的每个像素）

有什么想法或意见吗？

PS：这个问题一般是关于绘制像素的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T12:10:50.613

这两种“传统”的做法实际上非常有效：

*   绘制所有内容可让您使用块传输（即您的数据作为大块传输，例如每像素行一次传输），这非常快。
*   您提到的第二种方法通常以模板和/或深度缓冲区的形式在硬件中实现。这也使事情变得相当快。

无论如何：为了提高效率，如果你想避免过度绘制，你通常会从前到后绘制图层/精灵，并使用第二个缓冲区和一些智能逻辑运算符来确定要绘制的颜色。

例如：

```
// This buffer contains a byte for each pixel. Either the byte is 0x00 for a free pixel
// or 0xFF for a colored pixel.
byte* overDrawBuffer;
// The colorbuffer is our rendertarget
byte* colorBuffer;
// The spritesource is where the pixeldata of our sprite resides
byte* spriteSource

for (int i = 0; i < numPixels; i++)
{
   // will choose either the existing color or the new color depending on
   // the value of the overDrawBuffer. 
   byte theColor = (*colorBuffer & *overDrawBuffer) | (*spriteSource & !*overDrawBuffer);
   *colorBuffer = theColor;
   // Mark the pixel
   *overDrawBuffer = 0xFF;

   //Move to the next pixel
   *overdrawBuffer++;
   *colorBuffer++;
   *spriteSource++;
} 
```

注意：这段代码肯定不能正常工作——它只是为了说明这个想法。像这样的代码，没有分支和很少的操作应该产生非常快的机器代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T12:15:20.967

给定可能重叠的精灵的坐标和位置，您应该计算它们中的哪些部分将是可见的。这些是你应该画的。

如果您的精灵是非矩形或透明的，这会增加复杂性，但想法保持不变。

您可能需要：

*   向下到扫描线级别（水平 1 像素厚的跨度构成整个精灵）而不是矩形级别

*   使用遮罩告诉精灵的哪些像素是透明的，哪些不是

*   使用[四叉树](http://en.wikipedia.org/wiki/Quadtree)更有效地检测重叠精灵

# javascript - getElementById 未在 Javascript 中选择元素

> ID：16058337
> 
> 赞同：1
> 
> 时间：2013-04-17T11:04:30.763
> 
> 标签：javascript, events, dom, testing

我正在尝试基于 DOM 创建一个事件来测试我的 Javascript 技能，有人知道为什么这不适用于元素吗？

```
function getButton(){
    var getButton = document.getElementById("submit");
    getButton.onclick() = function(){
         alert("it works!")
    }
} 
```

Submit 是`<input type="submit" />`Id 元素中的一种元素，所以我不明白为什么它不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T11:05:55.947

删除`()`事件标识符。您只是在此处分配一个属性，而不是进行函数调用或类似操作。

```
function getButton(){

  var getButton = document.getElementById("submit");

  getButton.onclick = function(){
     alert("it works!");
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:08:54.777

您的代码中有几个问题：

1.  您尝试提交的元素是`<submit>`标签；它没有`id="submit"`，所以试图获取元素`getElementById("submit")`是行不通的。

    要么给你的`<submit>`标签它自己的标签`id`并选择它，要么使用它`getElementByTagName("submit")`。

2.  正如@Sirko 和@Osiris 所提到的那样，`getButton.onclick() = function(){`它不起作用，因为你试图`.onclick()`在它不是的时候作为一个函数调用。您要做的是为 的`onclick`属性分配一个函数`getButton`：

    `getButton.onclick() = function(){`应该是`getButton.onclick = function(){`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T11:05:43.237

```
getButton.onclick = function() {
       alert("it works!");
}; 
```

# logging - 让码头使用正确的时区登录

> ID：16058343
> 
> 赞同：3
> 
> 时间：2013-04-17T11:04:38.120
> 
> 标签：logging, jetty

我正在使用 Jetty 8 并正在配置我的 jetty.xml 以自定义 requests.log 文件。

我的问题是，Jetty 正在为带有 GMT 时区时间戳的日志提供服务——我在英国，但现在是夏季时间（GMT+1，又名 BST）。大概是因为：

```
<Set name="LogTimeZone">GMT</Set> 
```

如何让 Jetty 使用服务器上的本地时间来提供日志（这是正确的）？简单地删除`<Set name="LogTimeZone">GMT</Set>`并没有做任何事情，我不想每 6 个月手动更改一次。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T13:47:02.183

Jetty NCSARequestLog 使用[java.util.TimeZone](http://docs.oracle.com/javase/7/docs/api/java/util/TimeZone.html)。

`GMT`是 NCSA 格式的日志文件的默认值，因为这是各种日志分析工具所期望的。

听起来您希望 NCSA 格式的日志使用夏令时感知的时区。在这种情况下，您确实有 1 个选择，请使用适合您的系统和环境的长格式时区。

以下是有关英国伦敦的详细信息：[http ://www.timeanddate.com/worldclock/city.html?n=136](http://www.timeanddate.com/worldclock/city.html?n=136)

您需要的是由您的系统识别的 TimeZone 字符串。意思是：

*   时区标识符不使用 GMT 偏移表示法
*   TimeZone 标识符不是 3 个字母（请参阅[javadoc 部分关于“三个字母的时区 ID”](http://docs.oracle.com/javase/7/docs/api/java/util/TimeZone.html)）
*   时区标识符是长格式。

创建一个简单的 Java 源文件并（在您的系统上）运行以下代码。

```
package time;

import java.util.TimeZone;

public class TZDump
{
    public static void main(String[] args)
    {
        TimeZone mytz = TimeZone.getDefault();
        System.out.printf("The TimeZone for this machine: %s%n", mytz);
        for (String string : TimeZone.getAvailableIDs(mytz.getRawOffset())) {
            System.out.println(string);
        }   
    }
} 
```

所以对于我的机器，这个报告......

```
SystemV/MST7MDT
US/Arizona
US/Mountain 
```

我很幸运，因为这个列表很小，对我来说还有一个好处是我住的地方没有观察到夏令时。就我而言，我将使用`"US/Arizona"`.

在你的情况下，你会看到一个更大的列表（只是因为你离欧洲太近了）。`"Europe/"`选择一个以（我猜你的将是`"Europe/London"`）开头的条目

现在在您的配置中使用那个长格式的 TimeZone 标识符。

```
<Set name="LogTimeZone">Europe/London</Set> 
```

# ios - SQLite 数据库更新不起作用

> ID：16058347
> 
> 赞同：0
> 
> 时间：2013-04-17T11:04:49.217
> 
> 标签：ios, xcode, sqlite

我正在尝试使用 XCode 4.3.2 更新 SQLite 数据库中的 Userdetail 表。我正在使用的代码如下：

```
-(IBAction)saveUserProfile
{
    sqlite3_stmt *statement;
    const char *dbpath = [mDatabasePath UTF8String];

    if (sqlite3_open(dbpath, &mDiary) == SQLITE_OK)
    {
        NSString *updateSQL = [NSString stringWithFormat: 
                               @"UPDATE USERDETAIL SET mUname = \"%@\", mGender = '%@', mEmail = \"%@\", mAddress = \"%@\", mLatitude = \"%@\", mLongitude = \"%@\" WHERE mUserName = \"%@\" ", mUname.text, mGender.text, mEmail.text, mAddress.text, mLatitude.text,mLongitude.text, mUserName];
        const char *update_stmt = [updateSQL UTF8String];
        sqlite3_prepare_v2(mDiary, update_stmt, 
                           -1, &statement, NULL);
        if (sqlite3_step(statement) != SQLITE_DONE){

            mStatus.text = @"Failed to update user profile";
        }

        sqlite3_finalize(statement);
        sqlite3_close(mDiary);
    }
} 
```

该表没有得到更新。问题是什么？

# tcl - 无效的命令名称“模块/MMac/ALOHA”错误 ns-2 NS-MIRACLE

> ID：16058352
> 
> 赞同：0
> 
> 时间：2013-04-17T11:05:01.170
> 
> 标签：tcl, ns2

我对 ns-2 和 NS-MIRACLE 很陌生。

我想在 ns-2 中使用多无线电、多通道模拟。所以，我正在使用 NS-MIRACLE 库来做到这一点。但是在编译他们的样本时我得到了一个错误。类似于“无效的命令名称”模块/MMac/ALOHA“错误”。

我正在架起我的控制台。

```
invalid command name "Module/MMac/ALOHA"
    while executing
"Module/MMac/ALOHA create _o17 "
    invoked from within
"catch "$className create $o $args" msg"
    invoked from within
"if [catch "$className create $o $args" msg] {
if [string match "__FAILED_SHADOW_OBJECT_" $msg] {
delete $o
return ""
}
global errorInfo
error "class $..."
    (procedure "new" line 3)
    invoked from within
"new Module/MMac/ALOHA"
    (procedure "createNode" line 8)
    invoked from within
"createNode 1"
    (file "bpsk_aloha.tcl" line 160) 
```

真正的问题是我的 ns-miracle 找不到“libmmac.so”库。但是当我搜索 lib 文件夹时，它就在那里。

```
couldn't load file "libmmac.so": /home/mazhar/ns/lib/libmmac.so: undefined symbol: CLMSG_PHY2MAC_ENDTX
    while executing
"load libmmac.so"
    (file "bpsk_aloha.tcl" line 54) 
```

所以现在的问题是

> 未定义符号：CLMSG_PHY2MAC_ENDTX

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:11:47.480

在您更新的问题中，您有一个尚未链接到其所有依赖项的库。这使得它......充其量*难以使用。*您应该做的是找出缺少哪些库（或库），并在链接共享库的步骤中添加这些库。最低限度，它们将包含符号`CLMSG_PHY2MAC_ENDTX`，但可能还有更多。还要注意编译步骤中的意外警告；它们通常可以表明一些更严重的问题。

有关如何在您的平台上构建共享库的详细信息，请在 Stack Overflow 上搜索。这个问题已经回答过很多次了...

# c# - 最佳实践 - 在派生类中设置的继承变量

> ID：16058356
> 
> 赞同：4
> 
> 时间：2013-04-17T11:05:25.523
> 
> 标签：c#, .net, inheritance, constructor, abstract-class

我有一个抽象类，其中包含依赖于类级变量的方法。但是，这些变量的值是在从抽象继承的类中设置的。

我写了这个，以便在构造函数中设置变量 - 这似乎是迄今为止最巧妙的事情。但我只是觉得有点不舒服——它们看起来应该是抽象的属性。我只是无法说出我为什么会有这种感觉。

这是我实际所做的简化示例：

```
public abstract class TestBase
{
    protected string itemType;
}

public class TestClass1 : TestBase
{
    public TestClass1()
    {
        itemType = ConfigurationManager.AppSettings["TestClass1.ItemType"];
    }
}

public class TestClass2 : TestBase
{
    public TestClass2()
    {
        itemType = ConfigurationManager.AppSettings["TestClass2.ItemType"];
    }
} 
```

所以，问题是：

1）这是不好的做法吗？

2）如果是这样，为什么，什么更好？

3）这是一个测试类，用于回归测试而不是部署在任何地方。是否有充分的理由像示例中那样在 config 中设置我的类级变量，或者可以对它们进行硬编码？我总是倾向于默认配置。

干杯，马特

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T11:10:48.847

您可以将数据传递给正确的构造函数：

```
public abstract class TestBase
{
    protected string itemType;    // can now become 'readonly`

    protected TestBase(string keyName)
    {
       itemType = ConfigurationManager.AppSettings[keyName];
    }
}

public class TestClass1 : TestBase
{
    public TestClass1() : base("TestClass1.ItemType")
    {
        //itemType = ConfigurationManager.AppSettings["TestClass1.ItemType"];
    }
} 
```

这样一来，它更加一致并且不容易忘记一个项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:10:52.510

1：对于永远存在的领域有很多话要说`private`；其他访问虽然*可以工作*。

2：

这里最常见的方法可能是：

```
public abstract class TestBase {
    private string itemType;
    protected TestBase(string itemType) {
        this.itemType = itemType;
    }
}
public class TestClass1 : TestBase {
    public TestClass1() : base(
       ConfigurationManager.AppSettings["TestClass1.ItemType"])
    {}
} 
```

但你也可以只使用：

```
public abstract class TestBase {
    protected string ItemType {get;set;}
    // or:
    // public string ItemType {get;protected set;}
}
public class TestClass1 : TestBase {
    public TestClass1() {
       ItemType = ConfigurationManager.AppSettings["TestClass1.ItemType"];
    }
} 
```

如果应用程序设置名称始终与类型相关，您也可以使用一些反射：

```
public abstract class TestBase {
    private string itemType;
    protected TestBase() {
        itemType = ConfigurationManager.AppSettings[
            GetType().Name + ".ItemType";
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T11:18:24.080

对我来说更好的方法是声明抽象属性。如果您忘记在继承类中设置属性，编译器会提醒您。

```
public abstract class TestBase
{
    protected abstract string ItemType {get;}
}

public class TestClass1 : TestBase
{
    protected override string ItemType 
    {
        get { return ConfigurationManager.AppSettings["TestClass1.ItemType"];}
    }
} 
```

# mysql - 将原始 mysql 文件复制到通过 mysqlhotcopy 从 Linux MySQL 5.1 获得的 Windows 7 MySQL 5.6

> ID：16058360
> 
> 赞同：0
> 
> 时间：2013-04-17T11:05:41.343
> 
> 标签：mysql, linux, windows, workbench

假设我只能访问原始文件（.myd、.myi、.frm），我是否只需将从“/var/lib/mysql/mydb”获得的 mysql db 文件复制+粘贴到“C:\Program Files\MySQL \MySQL Workbench CE 5.2.47\data\mydb”还是“C:\Program Files\MySQL\MySQL Server 5.6\data\mydb”？我在 Linux 上使用 mysql-5.1.43，现在在 Windows 7 上使用 mysql 5.6。我无法再访问 Linux。

我尝试了前 2 个 Windows 位置，但均未成功。当我在 Workbench 中创建新模式时，我什至无法确定数据实际保存在哪里；即使在我将一些数据发布到表之后，这两个位置都没有我创建的新虚拟模式的实际数据文件。

关于本网站上提出的类似问题，我似乎没有得到任何直接答案。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:48:47.210

是的，您可以将原始文件移动到服务器目录。

检查 C:\Program Files\MySQL\MySQL Server 5.5\my.ini 中的**datadir**条目，因为这是服务器将使用/查找的位置。

不要忘记按照[此处](https://stackoverflow.com/a/14934258/2274885)所述升级您的表。

# settings - 流浪者没有在正确的地方寻找傀儡清单

> ID：16058362
> 
> 赞同：0
> 
> 时间：2013-04-17T11:05:46.260
> 
> 标签：settings, puppet, vagrant

我正在尝试使用 puppet 来提供 vagrant

我的 Vagrantfile 是这样的

```
Vagrant::Config.run  do |config|
    config.vm.box = "precise32"
    config.vm.provision :puppet  do |puppet|
       puppet.modules_path = "/path/to/puppet/modules"
       puppet.manifest_path = "/path/to/puppet/manifests"
       puppet.manifest_file = "site.pp"
       puppet.puppet_node = "lucy-dev-1"
       ## custom facts provided to Puppet
       puppet.facter = {
          ## tells default.pp that we're running in Vagrant
          "is_vagrant" => true,
       }
       puppet.options = "--verbose --debug"
    end
 end 
```

当我运行时`vagrant up`发生以下错误：

```
There are errors in the configuration of this machine. Please fix
the following errors and try again:

puppet provisioner:
   * The manifests path specified for Puppet does not exist: /Users/fguimara/vagrant/manifests 
```

您会注意到 manifest_path 没有得到尊重。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T12:41:15.890

从这里[http://docs.vagrantup.com/v2/provisioning/puppet_apply.html](http://docs.vagrantup.com/v2/provisioning/puppet_apply.html)它是`manifests_path`.

# spring - 单例和原型 bean 有什么区别？

> ID：16058365
> 
> 赞同：53
> 
> 时间：2013-04-17T11:05:53.997
> 
> 标签：spring, dependency-injection

我是春天的新手，我读到了这个：

> 基本上，一个 bean 具有定义它们在应用程序中存在的范围
> 
> Singleton：表示每个 Spring IOC 容器的单个对象实例的单个 bean 定义。
> 
> 原型：意味着对任意数量的对象实例的单个 bean 定义。

那么什么是“对象实例”。

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2013-04-17T11:07:19.050

**原型范围**= 每次注入/查找时都会创建一个新对象。`new SomeClass()`每次都会用到。

**单例范围**= *（默认）*每次注入/查找时都返回相同的对象。在这里，它将实例化一个实例，`SomeClass`然后每次都返回它。

**也可以看看：**

*   [Spring Bean 范围](https://stackoverflow.com/questions/17599216/spring-bean-scopes)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2016-09-09T06:22:33.030

让我们通过代码简单地查看一下。

以下是具有默认**`singleton`**Scope的 TennisCoach Bean

```
@Component
@Scope("singleton")
public class TennisCoach implements Coach {

    public TennisCoach(){

    }

    @Autowired
    public void setFortuneService(FortuneService fortuneService) {
        this.fortuneService = fortuneService;
    }

    @Override
    public String getDailyWorkout() {
        return "Practice your backhand volley";
    }

    @Override
    public String getDailyFortune() {
        return "Tennis Coach says : "+fortuneService.getFortune();
    }

} 
```

以下是具有**原型**范围的 TennisCoach Bean

```
@Component
@Scope("prototype")
public class TennisCoach implements Coach {

    public TennisCoach(){
        System.out.println(">> TennisCoach: inside default constructor");
    }

    @Autowired
    public void setFortuneService(FortuneService fortuneService) {
        System.out.println(">> Tennis Coach: inside setFortuneService");
        this.fortuneService = fortuneService;
    }

    @Override
    public String getDailyWorkout() {
        return "Practice your backhand volley";
    }

    @Override
    public String getDailyFortune() {
        return "Tennis Coach says : "+fortuneService.getFortune();
    }

} 
```

以下是一个主类：

```
public class AnnotationDemoApp {

    public static void main(String[] args) {

        // read spring config file
        ClassPathXmlApplicationContext context =
            new ClassPathXmlApplicationContext("applicationContext.xml");

       // get the bean from the spring container
       Coach theCoach = context.getBean("tennisCoach",Coach.class);
       Coach alphaCoach = context.getBean("tennisCoach",Coach.class);
       // call a method on the bean
       System.out.println("Are the two beans same :" + (theCoach==alphaCoach));

       System.out.println("theCoach : " + theCoach);
       System.out.println("alphaCoach: "+ alphaCoach);

       context.close()

    }
} 
```

对于**单例**范围，输出为：

```
Are the two beans same :true
theCoach : com.springdemo.TennisCoach@2a53142
alphaCoach: com.springdemo.TennisCoach@2a53142 
```

对于**原型**范围，输出为：

```
Are the two beans same :false
theCoach : com.springdemo.TennisCoach@1b37288
alphaCoach: com.springdemo.TennisCoach@1a57272 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-04-17T20:52:36.110

添加到上面..不要与java单例混淆。根据 JAVA 规范，单例意味着每个 JVM 只会创建该 bean 的一个实例。但在春季单例中，意味着每个应用程序上下文将为该特定 bean 创建一个实例。因此，如果您的应用程序有多个上下文，您仍然可以为该 bean 提供多个实例。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-17T11:12:08.740

它们都是创造型设计模式。

Singleton，将在第一次调用中创建一个新实例，并在后续调用中返回它。

Prototype 每次都会返回一个新的实例。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-09-07T10:54:54.687

**单例范围：**使用单例范围，使用提供的 bean 定义创建一个且只有一个 bean 实例，对于同一个 bean 的后续请求，Spring 容器将返回相同的实例。

来自 Spring 文档：

> .. 当您定义一个 bean 定义并将其限定为单例时，Spring IoC 容器会创建该 bean 定义所定义的对象的一个​​实例。此单个实例存储在此类单例 bean 的缓存中，并且该命名 bean 的所有后续请求和引用都返回缓存对象...

示例：可以说，我们定义了一个 bean `accountDao`，如下所示：

```
<bean id="accountDao" class="" /> 
```

还有另外两个 bean，它使用这个`accountDao`bean

```
<bean id="someBean" ref="accountDao" /> 
<bean id="anotherBean" ref="accountDao" /> 
```

Spring 最初会创建`accountDao`bean 并缓存它。然后for `someBean`as well `anotherBean`，它将提供相同的实例`accountDao`。

**注意：**如果 bean 定义没有指定范围，则 Singleton 是默认范围。

**原型作用域：**对于原型作用域，对于 bean 的每个请求，都会创建并返回一个新的 bean 实例。这类似于在 java 中为类调用***new运算符。***

示例：可以说，我们定义了一个 bean `accountDao`，如下所示：

```
<bean id="accountDao" class="" scope="prototype"/> 
```

还有另外两个 bean，它使用这个`accountDao`bean

```
<bean id="someBean" ref="accountDao" /> 
<bean id="anotherBean" ref="accountDao" /> 
```

对于 someBean 和 anotherBean，Spring 会返回两个独立的 accountDao 对象实例。

一个重要的区别是，对于原型作用域，Spring 不管理 bean 的完整生命周期，清理需要由客户端代码完成。

来自 Spring 文档：

> Spring 不管理原型 bean 的完整生命周期：容器实例化、配置和以其他方式组装原型对象，并将其交给客户端，而没有进一步记录该原型实例。因此，尽管在所有对象上调用初始化生命周期回调方法而不考虑范围，但在原型的情况下，不会调用配置的销毁生命周期回调。客户端代码必须清理原型范围的对象并释放原型 bean 持有的昂贵资源。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2017-11-08T09:40:49.347

1.  单例范围是默认的。
2.  单例 bean 在应用上下文初始化期间创建，并且始终返回相同的 bean。
3.  原型 bean 在被调用时被创建。每次调用它都会得到一个新对象。

注意：如果 Bean 被其他 Bean 引用并使用 Application 上下文调用，则将创建具有任何范围的 Bean。

用于检查这一点的示例代码。

```
public class PrototypeClass {

        PrototypeClass()
        {
            System.out.println("prototype class is created"+this.toString());
        }

    } 
```

这将在调用构造函数时打印相关文本。

对于下面的代码

```
for(int i=0;i<10;i++) {
   PrototypeClass pct= (PrototypeClass) context.getBean("protoClass");
} 
```

> 创建原型类Spring.PrototypeClass@29774679 创建原型类Spring.PrototypeClass@3ffc5af1 创建原型类Spring.PrototypeClass@5e5792a0 创建原型类Spring.PrototypeClass@26653222 创建原型类Spring.PrototypeClass@3532ec19 创建原型类Spring.PrototypeClass@68c4039c 原型类已创建Spring.PrototypeClass@ae45eb6 原型类已创建Spring.PrototypeClass@59f99ea 原型类已创建Spring.PrototypeClass@27efef64 原型类已创建Spring.PrototypeClass@6f7fd0e6 原型类已创建Spring.PrototypeClass@47c62251

bean定义是

```
<bean id="protoClass" class="Spring.PrototypeClass" scope="prototype</bean> 
```

现在我将 bean 定义中的范围更改为 singleton 。在上下文初始化期间只调用一次构造函数。接下来，我删除了 scope 属性并观察到与单例相同的行为。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-09-17T14:28:50.567

我想添加一些额外的信息，可以帮助我们找出上述句子中“对象实例”的含义。Spring Doc 中的这一段尝试定义“对象实例”：

> 当您创建一个 bean 定义时，您创建了一个用于创建**由该 bean 定义定义的类的****实际** 实例的方法。bean 定义是一个配方的想法很重要，因为这意味着，与一个类一样，您可以从一个配方创建许多**对象实例。**

 ****因此，如上一节所述，每个 bean 定义都可以被视为一个类（就面向对象而言）。根据您在其中定义的数据（例如范围，...），这个类（或 bean 定义）可能只有一个对象实例（只有一个共享实例的单例范围）或任意数量的对象实例（例如每次对特定 bean 发出请求时，通过创建一个新的 bean 实例来创建原型作用域）。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-09-27T20:49:02.523

**原型作用域：**每次注入时都会创建一个新对象。
**单例作用域：**每次注入都返回同一个对象。

原型范围用于所有有状态的 bean，而单例范围应用于无状态 bean。让我用我的例子来解释。请自行复制运行，以便清楚了解。考虑一个界面教练。

```
public interface Coach {

    public String getDailyWorkout();

    public String getDailyFortune();

} 
```

我们有另一个名为 TrackCoach 的类，它实现了 Coach。

```
public class TrackCoach implements Coach {

    private FortuneService fortuneService;

    public TrackCoach(FortuneService fortuneService) {
        this.fortuneService = fortuneService;
    }

    @Override
    public String getDailyWorkout() {
        return "Run a hard 5k";
    }

    @Override
    public String getDailyFortune() {
        return "Just Do it: " + fortuneService.getFortune();
    }    
} 
```

现在有一个FortuneService接口。

```
public interface FortuneService {

    public String getFortune();

} 
```

它由我们的 HappyFortuneService 类实现。

```
public class HappyFortuneService implements FortuneService {

    @Override
    public String getFortune() {
        return "Today is your lucky day!";
    }

} 
```

让我们连接这两个类并使用 Xml 将一个类的对象 bean 注入到另一个类中。让我们执行依赖注入。请注意，我们也可以使用 java 注释来做到这一点。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans.xsd
    http://www.springframework.org/schema/context
    http://www.springframework.org/schema/context/spring-context.xsd">

    <!-- Define your beans here -->

    <!--  define the dependency  -->
    <bean id = "myFortuneService"
        class = "com.luv2code.springdemo.HappyFortuneService">
    </bean>

    <bean id = "myCoach"
        class = "com.luv2code.springdemo.TrackCoach"
        scope = "singleton">

        <!-- set up construction injection -->
        <constructor-arg ref = "myFortuneService" />
    </bean>

</beans> 
```

请注意`scope = singleton`.

现在让我们定义我们的 BeanScopeDemoApp，它有我们的 main 方法。

```
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class BeanScopeDemoApp {

    public static void main(String[] args) {

        // load the spring configuration file 
        ClassPathXmlApplicationContext context = 
                new ClassPathXmlApplicationContext("beanScope-applicationContext.xml");

        // retrieve bean from spring container 
        Coach theCoach = context.getBean("myCoach", Coach.class);

        Coach alphaCoach = context.getBean("myCoach", Coach.class);

        // check if they are the same 
        boolean result = (theCoach == alphaCoach);

        // print out the results 
        System.out.println("\nPointing to the same object: " + result);

        System.out.println("\nMemory location for theCoach: " + theCoach);

        System.out.println("\nMemory location for alphaCoach: " + alphaCoach +"\n");

        // close the context 
        context.close();
    }

} 
```

运行上述代码后，您将看到以下结果：

```
Pointing to the same object: true

Memory location for theCoach: com.luv2code.springdemo.TrackCoach@16515bb7

Memory location for alphaCoach: com.luv2code.springdemo.TrackCoach@16515bb7 
```

它指向同一个对象并在调用它两次后占用相同的内存位置。现在让我们更改`scope = prototype`我们的 XML 文件，保存它并再次运行 BeanScopeDemoApp。
您将看到以下结果：

```
Pointing to the same object: false

Memory location for theCoach: com.luv2code.springdemo.TrackCoach@6d4d203d

Memory location for alphaCoach: com.luv2code.springdemo.TrackCoach@627fbcda 
```

它指向不同的对象并在调用两次后占用不同的内存位置。这将是我刚才所说的图形说明。 [![在此处输入图像描述](https://i.stack.imgur.com/GBLDL.png)](https://i.stack.imgur.com/GBLDL.png) [![在此处输入图像描述](https://i.stack.imgur.com/9VnXs.png)](https://i.stack.imgur.com/9VnXs.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-05-26T06:30:24.300

单例是跨应用程序的相同实例

原型是 getBean 的每个新请求的新实例****

# windows - Windows 远程桌面连接

> ID：16058372
> 
> 赞同：1
> 
> 时间：2013-04-17T11:06:41.663
> 
> 标签：windows, remote-desktop

我正在使用 Windows 7。我知道要在远程桌面连接中关闭/重新启动窗口，组合键是：Ctrl+Alt+End。从远程连接使用该命令重新启动时，它正在重新启动，但会断开远程桌面的连接。那么是否有任何选项可以在不断开远程桌面连接的情况下重新启动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:09:39.843

不，先生，在不与 RDP 断开连接的情况下重新启动机器非常困难。RDP 服务在机器重新启动时死亡，因此它不会赶上连接。您可以使用 TeamViewer、LogMein RIM 工具让您在重新启动时自动建立连接。您可以尝试优化 RDP 连接设置以在连接断开时重新连接。尝试并更新。一切顺利 。

[http://www.informationweek.com/byte/personal-tech/desktop-operating-systems/how-to-optimize-remote-desktop-in-window/231600221](http://www.informationweek.com/byte/personal-tech/desktop-operating-systems/how-to-optimize-remote-desktop-in-window/231600221)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:11:57.520

如果您重新启动 PC，您将失去与该 PC 的网络连接，因此连接将断开。

解决此问题的唯一方法是获取无法通过 Windows 显示的内容（因此没有软件解决方案）。

像[Lantronix](http://www.provantage.com/lantronix-slslp400ps2-01~7LAN9049.htm?source=googleps)这样的 IP KVM是您最好的选择。因为这些为您提供 BIOS 级别的访问权限（您可以远程访问 BIOS），并运行他们自己的操作系统（我使用的 Lantronix Spider）运行一个微型 Linux 内核。

# java - JProgressBar 中的颜色

> ID：16058381
> 
> 赞同：2
> 
> 时间：2013-04-17T11:06:59.570
> 
> 标签：java, swing, look-and-feel, color-scheme, jprogressbar

![在此处输入图像描述](https://i.stack.imgur.com/cQh6m.jpg)我只是想在`JFrame`. 现在，在使用进度条时，默认颜色是绿色，类似于在其他窗口功能中使用的颜色，例如文件复制等。有时您可能已经看到，窗口显示“红色”-彩色进度（当可能有在复制文件的情况下覆盖）。在进度条的情况下，如何使用“红色”颜色，而不是将“前景颜色”设置为“红色”，看起来不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:18:15.627

Java 使用自己的代码实现了具有原生外观的进度条。它不支持通过更改条形颜色来指示进度停滞/缓慢的 Vista 和更新功能。

[绘制条形图](http://javasourcecode.org/html/open-source/jdk/jdk-6u23/com/sun/java/swing/plaf/windows/WindowsProgressBarUI.java.html#line.105)的来源可供检查；它使用`paintSkin`方法来绘制条形图，默认情况下只绘制一种颜色。

[在 Windows 上使用进度条](http://msdn.microsoft.com/en-us/library/windows/desktop/aa511486.aspx)的设计指南表明您应该：

*   仅使用红色或黄色进度条来指示进度状态，而不是任务的最终结果。红色或黄色进度条表示用户需要采取一些行动才能完成任务。如果条件不可恢复，请将进度条保留为绿色并显示错误消息。
*   当存在阻止进一步进展的用户可恢复条件时，将进度条变为红色。显示消息以解释问题并推荐解决方案。将进度条变为黄色表示用户已暂停任务或存在阻碍进度但仍在进行的情况（例如，网络连接不佳）。如果用户已暂停，请将 Pause 按钮​​标签更改为 Resume。如果进展受阻，请显示一条消息以解释问题并推荐解决方案。

# opengl - 使用 GL_TEXTURE_RECTANGLE 时 glTexImage2D 不起作用

> ID：16058387
> 
> 赞同：3
> 
> 时间：2013-04-17T11:07:09.180
> 
> 标签：opengl

我正在尝试编写“BMP 播放器”。我的主要目标是快速完成！我需要达到60fps。我将所有图像加载到内存中，然后使用 glTexImage2D 切换纹理内容。

当我使用命令时：

```
glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, g_width, g_height, 0, GL_RGB, GL_UNSIGNED_BYTE, currentlyPlatedFrame->data); 
```

这部电影在低分辨率（720p 及更低）上运行良好（60fps），但在高清或更高时它的帧速率非常低（我需要达到 1600p）。

我在网上做了一些搜索，发现 GL_TEXTURE_2D 适用于 2 次方的方形纹理，这意味着在播放 1920x1080 时，我实际上是在玩 2048x2048（1280 之后的下一个 2 次方的 squer），为了让我的程序更快，我需要使用 GL_TEXTURE_RECTANGLE。

我的问题是，当我将代码中的所有 GL_TEXTURE_2D 更改为 GL_TEXTURE_RECTANGLE 时，我的播放器仅在整个屏幕上显示第一个像素。

从 2D 切换到 RECTANGLE 时，我还需要更改其他内容吗？谁能看到我做错了什么？或者，如果您对如何使用 GL_TEXTURE_2D 有一个想法但做得更快，那将对我有很大帮助。

我正在开发 win7 和 VS2010

我的代码（相关部分）：

```
#include <glew.h>
#include <glfw.h>

glfwInit();
glEnable(GL_DEPTH_TEST);
glEnable( GL_TEXTURE_2D );  
if( !glfwOpenWindow( g_width, g_height, 8, 8, 8, 0, 0, 0, GLFW_FULLSCREEN ))
{
    glfwTerminate(); //terminating glfw window
    return 0;
}

glfwSetWindowTitle("Texture");
glfwSetWindowSizeCallback(handleResize);
glfwSetKeyCallback(handleKeypress);
glfwEnable(GLFW_MOUSE_CURSOR);
glfwSwapInterval(1);

glClearColor( 0.0f, 0.0f, 0.0f, 0.0f ); //clear background screen to black

    //Clear information from last draw
glClear( GL_COLOR_BUFFER_BIT| GL_DEPTH_BUFFER_BIT);
glMatrixMode(GL_PROJECTION);
glLoadIdentity(); 

    glGenTextures(1,&Texture); //allocate the memory for texture
    glBindTexture(GL_TEXTURE_2D,Texture); //Binding the texture

glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glEnable(GL_TEXTURE_2D); //Enable texture

currentlyPlatedFrame = goToFirstFrameToPlay(headOfList,startFrameNum);

glBindTexture(GL_TEXTURE_2D,Texture);
while (1)
{ 
    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGB, g_width, g_height, 0, GL_RGB, GL_UNSIGNED_BYTE, currentlyPlatedFrame->data);

    glPushMatrix();//move out of loop
    glBegin(GL_POLYGON); //Begin quadrilateral coordinates
    glNormal3f(0.0f, 0.0f, 1.0f);//normal vector
    glTexCoord2f(0.0f, 0.0f); //Texture co-ordinate origin or  lower left corner
    glVertex3f(-1.0f,-1.0f, 0.0f);
    glTexCoord2f(1.0f, 0.0f); //Texture co-ordinate lower right corner
    glVertex3f(1.0f,  -1.0f,0.0f);
    glTexCoord2f(1.0f, 1.0f);//Texture co-ordinate top right corner
    glVertex3f(1.0f, 1.0f, 0.0f);
    glTexCoord2f(0.0f, 1.0f);//Texture co-ordinate top left corner
    glVertex3f(-1.0f, 1.0f, 0.0f);
    glEnd(); //End quadrilateral coordinates
    glPopMatrix();//move out of loop
    glFinish();//add glfinish
    glfwSwapBuffers();
    numOfPlayedFrames++;

    currentlyPlatedFrame = currentlyPlatedFrame->next;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-09-04T08:09:43.587

对于那些来这里寻求解决方案的游客；使用矩形纹理时，必须在 (0,0) - (tex_width, tex_height) 范围内指定坐标，而不是 (0,0) - (1,1)。

# mongodb - MongoDB：有没有办法调整输出？

> ID：16058389
> 
> 赞同：0
> 
> 时间：2013-04-17T11:07:14.357
> 
> 标签：mongodb, aggregation-framework, nosql

对于以下命令：

```
db.my_items.aggregate({
    $match: {
        // ...
    }
},{
    $project: {
        _id: 0,
        myField: 1
    }
}).result.forEach(function(obj) {
    print(obj.myField)
}) 
```

有没有办法`forEach`从`aggregate`查询内部执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T14:22:18.227

由于 MongoDB 响应您想要做的事情的方式是不可能的。MongoDB 接受输入并使用 BSON 文档进行响应，这实际上就是您在这里得到的回报。

由于 MongoDB 需要 BSON 文档返回，即使您可以将其`forEach`放入查询本身，您也需要在返回上进行额外的 foreach 以迭代 BSON 文档返回。

# spring - 在 Spring 3 中将属性注入到类级别注释中

> ID：16058391
> 
> 赞同：0
> 
> 时间：2013-04-17T11:07:23.490
> 
> 标签：spring, spring-3

我的要求是将属性注入到类级别注释中。

我想要的是如下内容，但 @Value 仅支持注入字段或方法：

```
@MyAnno(someproperty = @Value("${someproperty}"))
public class My {
...
} 
```

# c# - 调用与设置的链接限制兼容的“-.l1lilliIililI”类型的构造函数导致异常

> ID：16058393
> 
> 赞同：0
> 
> 时间：2013-04-17T11:07:27.287
> 
> 标签：c#, xaml

我尝试将我的应用程序作为发行版运行，并出现以下错误。我在 stacoverflow 上看到了带有 XMLserializer 的线程，但它没有帮助。什么是类**-.l1lilliIililI**，它来自哪里？在调试模式下，应用程序可以毫无问题地运行。消息以某种方式在主题中翻译。

```
System.Windows.Markup.XamlParseException was unhandled
Message=Wywołanie konstruktora dla typu „-.l1lilliIililI” zgodnego z określonymi ograniczeniami wiązania spowodowało wyjątek.
Source=PresentationFramework
LineNumber=0
LinePosition=0
StackTrace:
   w System.Windows.Markup.XamlReader.RewrapException(Exception e, IXamlLineInfo lineInfo, Uri baseUri)
   w System.Windows.Markup.WpfXamlLoader.Load(XamlReader xamlReader, IXamlObjectWriterFactory writerFactory, Boolean skipJournaledProperties, Object rootObject, XamlObjectWriterSettings settings, Uri baseUri)
   w System.Windows.Markup.WpfXamlLoader.LoadBaml(XamlReader xamlReader, Boolean skipJournaledProperties, Object rootObject, XamlAccessLevel accessLevel, Uri baseUri)
   w System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream)
   w System.Windows.Application.LoadBamlStreamWithSyncInfo(Stream stream, ParserContext pc)
   w System.Windows.Application.LoadComponent(Uri resourceLocator, Boolean bSkipJournaledProperties)
   w System.Windows.Application.DoStartup()
   w System.Windows.Application.<.ctor>b__1(Object unused)
   w System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
   w MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
   w System.Windows.Threading.DispatcherOperation.InvokeImpl()
   w System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)
   w System.Threading.ExecutionContext.runTryCode(Object userData)
   w System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)
   w System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   w System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   w System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   w System.Windows.Threading.DispatcherOperation.Invoke()
   w System.Windows.Threading.Dispatcher.ProcessQueue()
   w System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   w MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
   w MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)
   w System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
   w MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
   w System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)
   w MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)
   w MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg)
   w System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)
   w System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)
   w System.Windows.Application.RunDispatcher(Object ignore)
   w System.Windows.Application.RunInternal(Window window)
   w System.Windows.Application.Run(Window window)
   w System.Windows.Application.Run()
   w  .()
   w System.AppDomain._nExecuteAssembly(RuntimeAssembly assembly, String[] args)
   w System.AppDomain.ExecuteAssembly(String assemblyFile, Evidence assemblySecurity, String[] args)
   w Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly()
   w System.Threading.ThreadHelper.ThreadStart_Context(Object state)
   w System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state, Boolean ignoreSyncCtx)
   w System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)
   w System.Threading.ThreadHelper.ThreadStart()
InnerException: System.ArgumentException
   Message=Identyfikator ' ' nie jest zgodny z CLS.
Nazwa parametru: ident
   Source=System.Xml
   ParamName=ident
   StackTrace:
        w System.Xml.Serialization.CodeIdentifier.CheckValidIdentifier(String ident)
        w System.Xml.Serialization.CodeIdentifier.EscapeKeywords(String identifier, CodeDomProvider codeProvider, StringBuilder sb)
        w System.Xml.Serialization.CodeIdentifier.GetCSharpName(Type t, Type[] parameters, Int32 index, StringBuilder sb)
        w System.Xml.Serialization.CodeIdentifier.GetCSharpName(Type t)
        w System.Xml.Serialization.CodeIdentifier.GetCSharpName(Type t, Type[] parameters, Int32 index, StringBuilder sb)
        w System.Xml.Serialization.CodeIdentifier.GetCSharpName(Type t)
        w System.Xml.Serialization.TypeDesc.get_CSharpName()
        w System.Xml.Serialization.XmlSerializationWriterCodeGen.WriteElements(String source, String enumSource, ElementAccessor[] elements, TextAccessor text, ChoiceIdentifierAccessor choice, String arrayName, Boolean writeAccessors, Boolean isNullable)
        w System.Xml.Serialization.XmlSerializationWriterCodeGen.WriteMember(String source, String choiceSource, ElementAccessor[] elements, TextAccessor text, ChoiceIdentifierAccessor choice, TypeDesc memberTypeDesc, Boolean writeAccessors)
        w System.Xml.Serialization.XmlSerializationWriterCodeGen.GenerateTypeElement(XmlTypeMapping xmlTypeMapping)
        w System.Xml.Serialization.XmlSerializationWriterCodeGen.GenerateElement(XmlMapping xmlMapping)
        w System.Xml.Serialization.TempAssembly.GenerateAssembly(XmlMapping[] xmlMappings, Type[] types, String defaultNamespace, Evidence evidence, XmlSerializerCompilerParameters parameters, Assembly assembly, Hashtable assemblies)
        w System.Xml.Serialization.XmlSerializer.GenerateTempAssembly(XmlMapping xmlMapping, Type type, String defaultNamespace)
        w System.Xml.Serialization.XmlSerializer..ctor(Type type, String defaultNamespace)
        w System.Xml.Serialization.XmlSerializer..ctor(Type type)
        w  .[T](String )
        w  .()
        w  .()
        w -.l1lilliIililI.()
        w -.l1lilliIililI..ctor()
   InnerException: 
```

# jquery - 拖放jquery在div标签之间不起作用

> ID：16058396
> 
> 赞同：0
> 
> 时间：2013-04-17T11:07:39.460
> 
> 标签：jquery, html, css

我有一个带有左列的页面，其中存储“面板”，可以将其拖到页面的主要内容区域。将面板拖到左列中的新“区域”效果很好，但如果我尝试将它拖到主要内容区域，它似乎在它后面，即使使用 z-index。我创建了以下内容来说明：[JSFiddle](http://jsfiddle.net/8HQt6/1/)

仅供参考，主要内容区域中会有更多区域可以拖动到，我只是为了这个线程的目的而保持简单。同样在我的应用程序中，面板实际上是剑道图，需要在某些样式上使用 !important 标记。

任何人都可以帮忙吗？

脚本：

```
$('.area').droppable({
tolerance: 'fit'
});

$('.panel').draggable({
revert: 'invalid',
stop: function () {
    $(this).draggable('option', 'revert', 'invalid');
}
});

$('.panel').droppable({
greedy: true,
tolerance: 'touch',
drop: function (event, ui) {
    ui.draggable.draggable('option', 'revert', true);
}
}); 
```

CSS：

```
.area {
display:inline-block;
width:100px;
height:100px;
border:1px solid silver;
background-color:yellow;
padding:10px;
z-index: 10;
}
.panel {
display:inline-block;
width:30px;
height:30px;
border:1px solid silver;
background-color:white;
}
#frameContentLeft {
position: absolute !important;
top: 0px !important;
left: 0px !important;
width: 200px !important;
height: 1000px !important;
background-color: blue;
}
#mainContent {
position: absolute !important;
left: 200px !important;
top: 0px !important;
width: 100% !important;
height: 1000px !important;
background-color: red;
} 
```

HTML：

```
<div id="frameContentLeft">
    <div class="area">
        <div class="panel"></div>
    </div>
    <div class="area">
    </div>
</div>

<div id="mainContent">
    <div class="area"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:10:30.393

您需要设置要移动的元素的 z-index...

[http://jsfiddle.net/8HQt6/3/](http://jsfiddle.net/8HQt6/3/)

我只是将 z-index 设置`.panel`为 11，它工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:14:14.703

我发现一个问题是您的 mainContent z-index 高于其他窗格，请尝试执行以下操作：

```
#mainContent {
    position: absolute !important;
    left: 200px !important;
    top: 0px !important;
    width: 100% !important;
    height: 1000px !important;
    background-color: red;
    z-index:-1;
} 
```

或者增加您正在移动的元素的 z-index。**（请记住，这样做，一旦添加更多具有更高 z-index 的 div，您将得到相同的错误）**

如果您想动态更改 z-index，您可以尝试参考：[How to find the highest z-index using jQuery](https://stackoverflow.com/questions/5680770/jquery-find-the-highest-z-index)

*   获取更高的 z-index
*   然后将此 z-index + 1 设置为可拖动元素。

# domain-driven-design - 支持将有界上下文与消息传递和 Web 服务集成的基础架构

> ID：16058398
> 
> 赞同：1
> 
> 时间：2013-04-17T11:07:43.770
> 
> 标签：domain-driven-design, bounded-contexts

在我第一次涉足系统集成时，我确定了以下限界上下文：

1.  发票
2.  订阅
3.  收藏品

特别是对于集合有界上下文“暂停过期帐户”功能，我们将：

1.  从 Invoicing 获取过期发票列表
2.  向用户发送暂停通知（内部电子邮件服务）
3.  将请求暂停发送到订阅有界上下文

我了解如何使用阻塞 Web 服务来集成有界上下文，但我可以看到这会在远程服务关闭时带来问题。

我知道消息总线，但不确定我们将如何与消息策略集成：

每个上下文是否包含外部有界上下文的本地读取模型（在外部有界上下文添加/删除实体并通过唯一 ID 关联时监听来自外部有界上下文的事件）？

如果使用消息，我们是否真的从感兴趣的远程上下文构建实体的本地副本（具有用于本地上下文的字段）？还是我错过了其他东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T15:31:12.810

在您的场景中，您可以采用[事件驱动架构](http://en.wikipedia.org/wiki/Event-driven_architecture)并避免在本地存储数据。为了暂停过期帐户，您可以让 Invoicing BC 发布一个事件，指示发票过期。Collections and Subscriptions BC 将订阅该事件并调用所需的行为。从 Invoicing BC 的角度来看，您将有一个名为 InvoiceBecamePastDue 之类的[域事件，它将通过消息总线在外部发布。](http://lostechies.com/jimmybogard/2010/04/08/strengthening-your-domain-domain-events/)

在这种情况下，您似乎不需要本地副本。但是，在某些情况下，需要数据的本地副本，在这种情况下，您将使用已发布的事件来维护本地副本。

# python - 滤锅和檐口不能正常工作

> ID：16058400
> 
> 赞同：3
> 
> 时间：2013-04-17T11:07:53.993
> 
> 标签：python, pyramid, pylons, colander, cornice

我尝试添加架构验证，因为它在官方檐口文档中描述，并通过像 service_name.post(schema=SomeSchemaClass) 这样的装饰器来做到这一点，但它不起作用

```
import colander

class TrackSchema(colander.MappingSchema):
    genre = colander.SchemaNode(colander.String(), location="body", type='str')

@track.post(schema=TrackSchema)
def create_track(request):
    ... 
```

我得到错误

```
"status": "error", "errors": [{"location": "body", "name": null, "description":      "Expecting value: line 1 column 2 (char 1)"}, {"location": "body", "name": "genre", "description": "genre is missing"}]} 
```

我尝试了不同类型的位置参数，如查询字符串和标题，但我得到了同样的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-06T07:10:58.430

遇到同样的情况，在深入研究之后，如果您查看`cornice.util.extract_request_data`函数，您会发现它试图将主体加载为 json `json.loads(request.body)`，因此您需要将数据发布为 json：

```
curl -H "Content-Type: application/json" -X POST http://localhost:6543/foo -d '{"foo": "bar"}' 
```

高温高压

# jquery - 动态创建的内容不绑定 jQuery 事件

> ID：16058402
> 
> 赞同：1
> 
> 时间：2013-04-17T11:07:55.440
> 
> 标签：jquery, html

我无法将 jQuery 事件绑定到动态创建的列表项。

`btnRemoveItem`这是由jQuery添加开始后未触发的事件。

```
$('#btnAddStore').on('click', function(){
  (...)
  $.ajax({
    success: (function(result) {
      (...)
      var li = jQuery('<li/>', {
          'id': object['id']
         }).append('<span title="Remove item from list" class="btnRemoveItem"></span>')
           .append('<span class="text">' + name_adr[0] + '</span>')
           .append('<span class="address">' + name_adr[1] + '</span>');

      $(li).appendTo('#'+ country + ' ul');
    }
  });
}); 
```

我在这里查看了类似的问题，但我没有找到任何可以解决我的问题的答案。我从这段代码中遗漏了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T11:08:49.280

使用[**`.on()`**](http://api.jquery.com/on/)这种方式

```
$(document).on('click','#btnAddStore', function(){...}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T11:10:30.963

尝试这个

```
$(document).on('click','#btnAddStore', function(){...}); 
```

`$('#btnAddStore').on("scroll", ....)`仅将滚动事件绑定到执行此语句时存在的那些元素，即如果在执行此语句后动态添加任何具有类 wrapper1 的新元素，则不会为这些元素执行事件处理程序。

`$(document).on("scroll","#btnAddStore", ...)`另一方面，将向文档对象注册一个事件处理程序，并使用事件冒泡在具有类 `wrapper` 的元素内发生滚动时调用处理程序，因此它将支持元素的动态添加。

[看这里](https://stackoverflow.com/questions/16057640/difference-between-on-functions-calls)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T11:09:15.267

将委托与 .on() 一起使用：

```
$(document).on('click', '#btnAddStore', function(){...}); 
```

# php - 基于mysql时间戳的截止日期后的PHP和mysql查询

> ID：16058404
> 
> 赞同：0
> 
> 时间：2013-04-17T11:08:02.910
> 
> 标签：php, mysql

我有mysql DB，它存储时间戳（日期+小时）。

我想使用这些数据来创建截止点，例如一周前、一个月前等...

```
$result = $mysqli->query("SELECT 
u.user_id,
  ( SELECT sum(r.result_value)
    FROM logos_results r
    WHERE r.user_id = u.user_id
    AND r.result_date <= '$week' ) AS rsum,
u.user_name,
u.user_pic,
u.user_logos_level
FROM users u
ORDER BY rsum DESC
LIMIT 4"); 
```

我的问题是，如何在 php 中创建周？我应该删除时间戳并使用没有时间的东西吗？这个确切的时间会大大降低查询速度吗？`AND r.result_date <= '$week'`这是重要的部分，语法正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:16:29.853

您是否有理由不使用 mysql 将周转换为日期或按周选择间隔的能力？

对我来说，这似乎比在 php 中实现你的一周至今逻辑更好。

[检查这个问题。](https://stackoverflow.com/questions/3600481/mysql-query-dates-older-than-1-week-ago-all-datetimes-in-utc)

```
SELECT sum(r.result_value)
    FROM logos_results r
    WHERE r.user_id = u.user_id
    AND r.result_date < NOW() - INTERVAL $num_of_weeks WEEK 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:14:54.710

您可以使用 unix 时间戳代替您的日期时间值。这些包含自 Epoch (1.1.1970) 以来的秒数，可以很容易地用于计算。

另一种方法是使用 datetime 和任一 MySQL 方法来获取日期值：

[https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)

或在 PHP 中使用 DateTime 对象或 strtotime() 计算

[http://php.net/manual/de/function.strtotime.php](http://php.net/manual/de/function.strtotime.php) [http://de2.php.net/manual/de/class.datetime.php](http://de2.php.net/manual/de/class.datetime.php)

```
$nextweek = strtotime ( "+1 week") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T11:15:14.317

```
$week = date('d-m-Y', strtotime("+1 week")); // 1 week from now
$week = date('d-m-Y', strtotime("-1 week")); // 1 week ago

$month = date('d-m-Y', strtotime("-1 month")); // 1 month ago 
```

[http://www.php.net/manual/en/function.strtotime.php](http://www.php.net/manual/en/function.strtotime.php)

# mysql - 带有 PDO 连接的 MySQL SET

> ID：16058407
> 
> 赞同：0
> 
> 时间：2013-04-17T11:08:08.227
> 
> 标签：mysql, pdo

我正在尝试执行一个非常长的 SQL 语句，该语句使用多个用户选项选择“前 N”行。我不想在这里发布整个语句，因为它很长，但我正在使用本文所述的 MySQL 变量：[MySql Query: Select top 3 rows from table for each category](https://stackoverflow.com/questions/3140589/mysql-query-select-top-3-rows-from-table-for-each-category)

该语句在 MySQL 命令行上运行时运行良好，但我遇到的问题是整个查询必须通过 PDO 连接运行，我想知道是否有人可以确认我不能将值“即时”设置为如下图所示。这是 PDO 限制吗？我只是浪费了几个小时吗？非常感谢您的帮助 ...

```
SELECT outerseasons.* FROM (SELECT seasons.CountryName, seasons.idCountry, '' as     idCountryGroup, '' as CGName, seasons.DIValue_WorkingEntered, 
      seasons.SNName, seasons.idSeason, seasons.idParameter, seasons.PMName,
      CASE 
        WHEN @idSeason != seasons.idSeason OR @idParameter != seasons.idParameter
        THEN @rownum := 1
        ELSE @rownum := @rownum + 1
      END AS rank,
      @idSeason := seasons.idSeason as var_season,
      @idParameter := seasons.idParameter as var_parameter
      FROM ( SELECT ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:52:25.090

PDO 与 SQL 语法有关。它可以执行您编写的任何 SQL 查询。
唯一的麻烦可能是由*一组查询*引起的。可以通过将这些集合拆分为单独的查询并逐个运行它们来轻松解决。

其他任何问题都可能仅由 SQL 语法错误引起。
只需验证您的 SQL 语法并[**观察 PDO 错误**](https://stackoverflow.com/questions/15990857/reference-frequently-asked-questions-about-pdo#15990858)

# css - twitter bootstrap，row-fluid里面的row-fluid有什么问题

> ID：16058408
> 
> 赞同：1
> 
> 时间：2013-04-17T11:08:09.823
> 
> 标签：css, twitter-bootstrap

在我的网站中，它会生成动态 html，如下所示

```
<div class="container-fluid">
  <div class="row-fluid">
    <div class="row">      
        some html here ..  
    <div>

     some html here

    <form>
       <div class="row-fluid">
            <div class="span6">
               form elements here .. 
```

上面的html是有效的吗？我们可以有`.row-fluid`还是`row`里面`row-fluid`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:33:41.563

您的代码应该可以工作，但我会这样编写代码：

```
<div class="container-fluid">
  <div class="row-fluid">
    <div class="spanX">
        <div class="row">      
            <div class="spanX">
                some html here...
            </div>
        </div>
        some html here
        <form class="row-fluid">
            <div class="span6">
                form elements here ..  
            </div>
            <div class="spanY"></div>
        </form>
    </div>
    ... 
```

正如我的经验所表明的那样，最好将`row`or`row-fluid`放在其中一个`container`or`spanX`包装器中。

*X 和 Y 必须是根据您的网格系统的数字*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:21:42.860

是的，您可以在 a 中嵌套 a`.row`或`.row-fluid`a `.row-fluid`。[您可以在Bootstrap 的文档](http://twitter.github.io/bootstrap/scaffolding.html#fluidGridSystem)中找到示例。

# opencv - 如何在 pythoncard 中保存实时视频

> ID：16058416
> 
> 赞同：0
> 
> 时间：2013-04-17T11:08:24.070
> 
> 标签：opencv, python-2.7, wxpython, pygtk, pythoncard

我有一个带有图像、Signatue 文件的 PythonCard GUI**表单。**我需要从实时流中捕获图像，

我正在尝试将我的实时视频作为 pythoncard 组件注入，例如 staticbox 或 staticArea

PythonCard 是否具有内置的视频组件或任何其他进入 GUI 的方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T16:27:54.733

You can try wxPython's MediaCtrl, but I don't think it works very well with streaming media. Instead, I would recommend a 3rd party widget called the MPlayerCtrl which wraps MPlayer. You can get it on [PyPI](https://pypi.python.org/pypi/MplayerCtrl/)

Here is a link for the [documentation](http://pythonhosted.org/MplayerCtrl/) and I also wrote a [tutorial](http://www.blog.pythonlibrary.org/2010/07/24/wxpython-creating-a-simple-media-player/) for it. It should be noted that I didn't try to make it take screenshots. You'll have to do some research into it to find out if that is supported. If MPlayer can do it, than this wrapper should be able to as well.

# sql - 从字符串中的列表中查找任何字符的索引

> ID：16058417
> 
> 赞同：0
> 
> 时间：2013-04-17T11:08:26.670
> 
> 标签：sql, sql-server-2008

我有兴趣从字符串中查找字符索引，其中字符是空格或 _（下划线）或 -（连字符）。

```
SELECT CHARINDEX(' ','kjhk wonderful', 1) 
```

（返回 5）可以在我搜索“空格”时使用，但我对提到的任何一个符号都感兴趣，它首先出现。请问有什么想法吗？什么是正确的语法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T11:18:56.403

检查这个

```
SELECT PATINDEX('%[ _-]%','kjhk wonderful') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:18:56.303

它很乱，所以很可能有一个更整洁的方法，但下面的方法会起作用。

```
SELECT MIN(pos) FROM
(
    SELECT CHARINDEX(' ','kj-hk won_derful', 1) AS pos
    UNION ALL
    SELECT CHARINDEX('_','kj-hk won_derful', 1) AS pos
    UNION ALL
    SELECT CHARINDEX('-','kj-hk won_derful', 1) AS pos
) as query 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T11:18:56.940

请尝试使用[PATINDEX (Transact-SQL)](http://msdn.microsoft.com/en-in/library/ms188395.aspx)：

```
SELECT PATINDEX('%[ _-]%', 'kjhk wonderful') 
```

# hadoop - 将hdfs目录从伪分布备份到本地目录？

> ID：16058418
> 
> 赞同：0
> 
> 时间：2013-04-17T11:08:28.833
> 
> 标签：hadoop, hbase

我正在使用 HBase 和 Hadoop，并让它们在我的机器上以伪分布式模式运行。我有写入 HBase 的表，这些表存储在 hdfs 上的“hbase”目录中，如下所示

```
$HADOOP_HOME/bin/hadoop fs -ls /Found 3 items
drwxr-xr-x   - robocode supergroup          0 2013-04-17 11:48 /Users
drwxr-xr-x   - robocode supergroup          0 2013-04-17 11:26 /hbase
drwxr-xr-x   - robocode supergroup          0 2013-04-08 15:07 /usr 
```

我想将此 hbase 目录从 hdfs 备份到我桌面上的目录，以便以后可以将其还原到 hbase/hdfs。我正在使用如下 distcp，它似乎运行良好，但是当它完成时，我的桌面上没有 hbase 目录的迹象

```
hadoop distcp hdfs://localhost:8020/hbase /Users/robocode/Desktop/

13/04/17 11:55:39 INFO tools.DistCp: srcPaths=[hdfs://localhost:8020/hbase]
13/04/17 11:55:39 INFO tools.DistCp: destPath=/Users/robocode/Desktop
13/04/17 11:55:39 INFO tools.DistCp: sourcePathsCount=40
13/04/17 11:55:39 INFO tools.DistCp: filesToCopyCount=17
13/04/17 11:55:39 INFO tools.DistCp: bytesToCopyCount=22.9k
13/04/17 11:55:40 INFO mapred.JobClient: Running job: job_201304171125_0004
13/04/17 11:55:41 INFO mapred.JobClient:  map 0% reduce 0%
13/04/17 11:55:55 INFO mapred.JobClient:  map 100% reduce 0%
13/04/17 11:56:00 INFO mapred.JobClient: Job complete: job_201304171125_0004
13/04/17 11:56:00 INFO mapred.JobClient: Counters: 20
13/04/17 11:56:00 INFO mapred.JobClient:   Job Counters
13/04/17 11:56:00 INFO mapred.JobClient:     SLOTS_MILLIS_MAPS=11840
13/04/17 11:56:00 INFO mapred.JobClient:     Total time spent by all reduces waiting after reserving slots (ms)=0
13/04/17 11:56:00 INFO mapred.JobClient:     Total time spent by all maps waiting after reserving slots (ms)=0
13/04/17 11:56:00 INFO mapred.JobClient:     Launched map tasks=1
13/04/17 11:56:00 INFO mapred.JobClient:     SLOTS_MILLIS_REDUCES=0
13/04/17 11:56:00 INFO mapred.JobClient:   File Input Format Counters
13/04/17 11:56:00 INFO mapred.JobClient:     Bytes Read=7105
13/04/17 11:56:00 INFO mapred.JobClient:   File Output Format Counters
13/04/17 11:56:00 INFO mapred.JobClient:     Bytes Written=673
13/04/17 11:56:00 INFO mapred.JobClient:   FileSystemCounters
13/04/17 11:56:00 INFO mapred.JobClient:     HDFS_BYTES_READ=24954
13/04/17 11:56:00 INFO mapred.JobClient:     FILE_BYTES_WRITTEN=22417
13/04/17 11:56:00 INFO mapred.JobClient:     HDFS_BYTES_WRITTEN=18365
13/04/17 11:56:00 INFO mapred.JobClient:   distcp
13/04/17 11:56:00 INFO mapred.JobClient:     Files copied=7
13/04/17 11:56:00 INFO mapred.JobClient:     Bytes copied=17692
13/04/17 11:56:00 INFO mapred.JobClient:     Bytes expected=17692
13/04/17 11:56:00 INFO mapred.JobClient:     Files skipped=10
13/04/17 11:56:00 INFO mapred.JobClient:   Map-Reduce Framework
13/04/17 11:56:00 INFO mapred.JobClient:     Map input records=39
13/04/17 11:56:00 INFO mapred.JobClient:     Spilled Records=0
13/04/17 11:56:00 INFO mapred.JobClient:     Total committed heap usage (bytes)=85000192
13/04/17 11:56:00 INFO mapred.JobClient:     Map input bytes=7005
13/04/17 11:56:00 INFO mapred.JobClient:     Map output records=10
13/04/17 11:56:00 INFO mapred.JobClient:     SPLIT_RAW_BYTES=157 
```

关于我要去哪里错的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:40:19.250

如评论中所述，将此问题标记为已回答：

```
hadoop distcp hdfs://localhost:8020/hbase file:///Users/robocode/Desktop/ 
```

# java - Java ExecutorService：我应该在使用执行之前加锁吗？

> ID：16058419
> 
> 赞同：5
> 
> 时间：2013-04-17T11:08:29.650
> 
> 标签：java, multithreading, thread-safety

我有一个班级组织如下：

```
public class MyClass {

   ExecutorService pool;

   public MyClass(){
     pool = ... //inited by a class that implements ExecutorService
   }

   public final void submit(Runnable run){
        pool.execute(run);
   }
} 
```

该方法是`submit`线程安全的还是我应该使用`Lock`基于 - 的系统？例如

```
 ReentrantLock look  = new ReentrantLock();

   public final void submit(Runnable run){
        lock.lock();
        try{ pool.execute(run); } finally{lock.unlock();}
   } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T11:11:43.373

[不，调用ExecutorService#submit](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ExecutorService.html)时不需要锁。

> 内存一致性效果：在将 Runnable 或 Callable 任务提交给 ExecutorService 之前，线程中的操作发生在该任务采取的任何操作之前，这反过来又发生在通过 Future.get() 检索结果之前。

或者在调用[Executor#execute](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executor.html)时：

> 内存一致性效果：在将 Runnable 对象提交给 Executor 之前，线程中的操作发生在其执行开始之前，可能在另一个线程中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:18:28.550

这取决于您`ExecutorService`的访问方式或您`MyClass`的创建方式。如果`MyClass`在单个线程中创建实例并且`#pool`ivar 也在单个线程中创建，则此类是线程安全的，并且您的使用`#pool`是线程安全的。

但是，如果您`MyClass`可以跨多个线程存在（例如首先通过单例、共享工厂或共享列表访问 - 即不是`new MyClass()`），那么它不是线程安全的。这是因为多个线程可以访问您的`Myclass`实例及其单个`#pool`ivar。调用提交可以完成，但一次有多个线程，因此您的`Myclass`实例的状态或`pool`可能会受到损害。在这种情况下，您`MyClass#submit`应该通过锁进行同步或管理。由于这是一种小方法，我建议只同步`#submit`.

同样，如果您的`MyClass`实例是在此线程中创建的，但未在此线程`#pool`中创建为新实例（`pool = new AnExecutorPoolType(...);`那么此类将再次不是线程安全的。可以再次从跨多个线程可用的另一个源（如上）访问池。如果如果是这种情况，那么它就有可能被多个线程访问置于不一致的状态。在这种情况下，该`pool#execute`方法应该同步（或通过同步块保护 ivar 访问）或通过锁进行管理。

# c# - 无法读取pdf文件

> ID：16058422
> 
> 赞同：-1
> 
> 时间：2013-04-17T11:08:47.637
> 
> 标签：c#, itextsharp, pdftotext

我正在尝试构建一个可以读取 PDF 文件的应用程序。我使用本指南：

[http://www.codeproject.com/Articles/14170/Extract-Text-from-PDF-in-C-100-NET](http://www.codeproject.com/Articles/14170/Extract-Text-from-PDF-in-C-100-NET)

但不明白“文件”的含义是您计算机的整个网址。因为当我尝试它时，它说它的格式错误。

```
String file = "C:/project/test2.pdf";
// create an instance of the pdfparser class
PDFParser pdfParser = new PDFParser();

// extract the text
String result = pdfParser.ExtractText(file); 
```

错误讯息：

> 错误 1 ​​方法“ExtractText”没有重载需要 1 个参数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:17:16.940

如果要将 pdf 文本提取为字符串，请尝试使用`PdfTextExtractor.GetTextFromPage`，示例代码：

```
public string ReadPdfFile(string fileName)
{
    var text = new StringBuilder();

    if (File.Exists(fileName))
    {
        var pdfReader = new PdfReader(fileName);

        for (int page = 1; page <= pdfReader.NumberOfPages; page++)
        {
            var strategy = new SimpleTextExtractionStrategy();
            string currentText = PdfTextExtractor.GetTextFromPage(pdfReader, page, strategy);

            currentText = Encoding.UTF8.GetString(ASCIIEncoding.Convert(Encoding.Default, Encoding.UTF8, Encoding.Default.GetBytes(currentText)));
            text.Append(currentText);
        }
        pdfReader.Close();
    }
    return text.ToString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:20:48.417

我认为`ExtractText`有`two arguments` **一个是 PDF 源文件**，**第二个是文本目标文件**

所以尝试如下，你的错误得到解决：

```
pdfParser.ExtractText(file,Path.GetFileNameWithoutExtension(file)+".txt"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T11:24:05.643

首先，您应该正确指定路径。您可以从您发布的 codeproject 链接下载测试项目。

你应该这样使用它：

```
string sourceFile =  "C:\\Folder\\File.pdf";
string outputFile =  "C:\\Folder\\File2.txt"

PDFParser pdfParser = new PDFParser();
pdfParser.ExtractText(sourceFile, outputFile); 
```

UPD：您使用它是错误的（并且您肯定会得到错误：无法将 bool 隐式转换为字符串）：

```
string result = pdfParser.ExtractText(sourceFile, outputFile); 
```

正确的方法是：

```
pdfParser.ExtractText(sourceFile, outputFile); 
```

# javascript - 在 javascript.replace 中允许使用负数和正数小数

> ID：16058428
> 
> 赞同：0
> 
> 时间：2013-04-17T11:09:05.733
> 
> 标签：javascript, regex

我用它来过滤掉所有不是数字的东西（包括小数）

在 keydown 我这样做：

```
function validateNudgerInput(ele){
          ele.val(ele.val().replace(/[^0-9\.]/g,''));
            if (parseFloat(ele.val())> settings.max
              ||parseFloat(ele.val())< settings.min)
            {
              ele.addClass("nudgerInvalid ")
            }else{
             ele.removeClass("nudgerInvalid")
            }
        } 
```

当前使用： `ele.val(ele.val().replace(/[^0-9\.]/g,''));` 这会删除任何不是大于零的数字（允许小数） - 即如果用户按下“A”键，它将停止将其放置在文本框中

我将如何调整它以允许负数呢？（允许 - 符号）

有效输入示例： `1` `-1` `123.45` `-123.45`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:21:43.343

此正则表达式将解析更多数字：

```
yourString.replace(/-?[0-9]+(\.[0-9]+)?/g,'') 
```

**编辑**：要从输入的开头到结尾匹配一个数字：

```
yourString.match(/^-?[0-9]+(?:\.[0-9]+)?$/,'') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:47:12.190

听起来您这样做是为了限制文本框中的输入。我通常会记住上次验证文本框时的值，如果当前值无效，例如与正则表达式不匹配，则`/^-?[0-9]+(?:\.[0-9]+)?$/`恢复为以前的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-05T12:06:09.057

```
function testFloat(id)
{
    var obj = document.getElementById(id);
    // allows only integer and float values (negative, positive)  
    obj.value = obj.value.replace(/([^-\d.]+)?((-{0,1}\d*\.?\d*)(.*)?$)/, "$3");            
}

HTML:<input type="text" id="testId"  onkeyup="testFloat(this.id)"/> 
```

希望这可以帮助。:)

# python - 要列出的 Python 字符串（基于标签）

> ID：16058429
> 
> 赞同：0
> 
> 时间：2013-04-17T11:09:06.860
> 
> 标签：python, list

我不想使用 XML 解析器（我没有看到我正在做的少量工作的意义）。

我有一个存储为字符串的 XML 文件，并希望根据标签创建列表或拆分​​它：

```
<xmlval>
  <anotherval></anotherval>
  <anotherval></anotherval>
</xmlval>
<xmlval>
  <anotherval></anotherval>
  <anotherval></anotherval>
</xmlval>
<xmlval>
  <anotherval></anotherval>
  <anotherval></anotherval>
</xmlval>
<xmlval>
  <anotherval></anotherval>
  <anotherval></anotherval>
</xmlval>
<xmlval>
  <anotherval></anotherval>
  <anotherval></anotherval>
</xmlval> 
```

我想将它拆分成一个列表基于`<xmlval>`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:15:09.877

确实，XML 解析器是*完成*这样一个小任务的方法。使用[ElementTree API](http://docs.python.org/2/library/xml.etree.elementtree.html)：

```
from xml.etree import ElementTree as ET

tree = ET.parse(inputfile)

somelist = []

for elem in tree.findall('xmlval'):
    text = ' '.join(elem.findall('./anotherval/text()'))
    somelist.append(text) 
```

在那里，那还不错，是吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:15:20.840

```
b=[]
for i in string.split('<xmlval>'):
    for j in i.split('</xmlval>'):
        b.append(j) 
```

将有由标签`<xmlval>`和`</xmlval>`标签分割的字符串

# java - 移植/编译 JAVA 框架到 Javascript

> ID：16058431
> 
> 赞同：0
> 
> 时间：2013-04-17T11:09:14.997
> 
> 标签：java, javascript, gwt, llvm

我目前正在为大学做一个项目。我的一位教授用 JAVA 开发了一个 P2P 框架。现在我们的任务是让它在不同的移动设备上运行。在 Android 上，这应该没什么大不了的。但现在涉及到 iOs。我正在考虑移植框架的最简单方法。一种方法是将它完全移植到Objective-C，但我们没有时间这样做。然后我想到了可以（以我非常基础的知识）将 JAVA 编译为 Javascript 的 LLVM 或 GWT。这样我们就可以在 WebView 或类似的东西中运行它。直到现在我还没有找到一个适用于 JAVA 的 LLVM 前端。而且我没有使用 Google WebToolkit 的经验。你们中的一些人已经在这方面有经验吗？我的计划是行不通的还是有解决这个问题的现实方法？希望大家分享一些经验

菲利克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:51:10.513

看来是不行了。GWT 仅将 JAVA 子集编译为 javascript。它不会将 io、线程、套接字映射到 web 中！！

GWT 仅将以下 java api 子集转换为 javascript - [https://developers.google.com/web-toolkit/doc/latest/RefJreEmulation](https://developers.google.com/web-toolkit/doc/latest/RefJreEmulation)

# awk - Gnuplot：输出中命令行的残差

> ID：16058436
> 
> 赞同：0
> 
> 时间：2013-04-17T11:09:26.340
> 
> 标签：awk, plot, gnuplot

我正在运行 ubuntu 并且在 gnuplot 中，当我执行`plot "<(awk '...' data.txt)"`此命令的一部分时，它会被绘制到数据图的中间。该图本身是正确的，问题是输出中保留的命令文本。我找不到任何关于其他人遇到这种残留物的信息。有谁知道问题可能出在哪里或在哪里寻找解决方案？

代码：

```
plot '<(awk "BEGIN{x=0} /^#previous/ {x++} /^#[^p]/ {x=0} /^[^m#]/ {if(x) print}" ./data.txt)' using 2:3 
```

源数据：

```
#current                
month   followed    retweeted   mentioned   replied
Jan 395 29  35  28
Feb 380 28  32  31

#previous               
month   followed    retweeted   mentioned   replied
Jan 381 30  38  32
Feb 378 25  42  30
Mar 374 28  46  40
Apr 372 29  40  35
May 371 28  35  25
Jun 371 31  37  30
Jul 370 30  34  28
Aug 372 30  35  30
Sep 376 27  35  33
Oct 379 29  42  37
Nov 387 31  40  35
Dec 385 29  33  25 
```

输出： ![在此处输入图像描述](https://i.stack.imgur.com/ybApL.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T13:28:31.343

用于`notitle`解决此问题：

```
plot '< awk "/^#previous/{x=1}/^#[^p]/{x=0}/^[^m#]/&&x" data.txt' u 2:3 notitle 
```

# android - Android 应用程序一直处于注销状态

> ID：16058444
> 
> 赞同：0
> 
> 时间：2013-04-17T11:09:40.807
> 
> 标签：android, gps, alarmmanager

我有一个 Android 应用程序，它具有用户登录功能。问题是应用程序不断关闭。间隔不规则。有时会持续 3 分钟，有时会持续 10 分钟。

背景：当用户登录时，应用程序将坐标发送到我们的服务器。坐标是从 GPS 获取的。

以固定间隔。我们添加了 AlarmManager，以便应用程序在手机进入睡眠模式时继续运行。

它也无济于事。

我们注意到：如果我们要从信号塔获取坐标，电池寿命很长，我们测试过一次，它能够保持 10 个小时的会话。但是提供的坐标不准确，因此我们不能使用这种方法。

我们已经看到有人写过关于粘性的文章，我们不太确定它是如何工作的。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:37:38.490

aGPS 或辅助 GPS 不会为您提供非常准确的位置。您正在使用 1..n 个手机信号塔估算您的位置。这个怎么运作 ...![在此处输入图像描述](https://i.stack.imgur.com/Dxuhq.jpg)

“使用蜂窝塔三角测量（3 个塔），可以将电话位置确定在‘大约’3/4 平方英里的区域内。” ——他们的报价不是我的。讨厌他们而不是这篇文章。我试图提供帮助；） [http://wrongfulconvicionsblog.org/2012/06/01/cell-tower-triangulation-how-it-works/](http://wrongfulconvictionsblog.org/2012/06/01/cell-tower-triangulation-how-it-works/)

如果您尝试定期获取和记录用户的位置，您可能需要运行后台服务。

# java - RRD4J 获取检索奇怪的值

> ID：16058445
> 
> 赞同：0
> 
> 时间：2013-04-17T11:09:42.153
> 
> 标签：java, rrd

我正在尝试使用 RRD4J，但它检索到奇怪的数据。也许我在做一些奇怪的事情。

我创建了一个具有以下功能的数据库：

```
// MAIN DATA SOURCES
rrdDef.addDatasource("create", DsType.COUNTER, 600, Double.NaN, Double.NaN);
rrdDef.addDatasource("copy", DsType.COUNTER, 600, Double.NaN, Double.NaN);
rrdDef.addDatasource("check", DsType.COUNTER, 600, Double.NaN, Double.NaN);
rrdDef.addDatasource("delete", DsType.COUNTER, 600, Double.NaN, Double.NaN);
// AVERAGE ARCHIVES
rrdDef.addArchive(ConsolFun.AVERAGE, 0.5, 1, 576);
rrdDef.addArchive(ConsolFun.AVERAGE, 0.5, 6, 336);
rrdDef.addArchive(ConsolFun.AVERAGE, 0.5, 24, 720);
rrdDef.addArchive(ConsolFun.AVERAGE, 0.5, 288, 540);
// MAX ARCHIVES
rrdDef.addArchive(ConsolFun.MAX, 0.5, 1, 576);
rrdDef.addArchive(ConsolFun.MAX, 0.5, 6, 336);
rrdDef.addArchive(ConsolFun.MAX, 0.5, 24, 720);
rrdDef.addArchive(ConsolFun.MAX, 0.5, 288, 540); 
```

我更新如下：

```
Sample sample = rrdDb.createSample();
sample.setTime(now);
sample.setValue("create", (double)create);
sample.setValue("copy", (double)copy);
sample.setValue("check", (double)check);
sample.setValue("delete", (double)del);
sample.update(); 
```

并检索数据：

```
long endTime = Util.getTime();
long startTime = endTime - (12*60*60L);
FetchRequest fetchRequest = rrdDb.createFetchRequest(ConsolFun.MAX, startTime, endTime);
FetchData fetchData = fetchRequest.fetchData();
System.out.println(fetchData.dump()); 
```

但我尽可能检索到最奇怪的数据。我输入了 95、48、78 和 15 等数字，并收到了 +1.8046081071E07、+1.8046079370E07、+0.0000000000E00 和 +1.8046081013E07 等数据

我想取回值。难道我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T19:10:25.387

我找到了解决方案。

当我应该使用 DsType.GAUGE 时，我使用了 DsType.COUNTER。

因此，使用以下代码创建数据库解决了这个问题：

```
rrdDef.addDatasource("create", DsType.GAUGE, 600, Double.NaN, Double.NaN);
rrdDef.addDatasource("copy", DsType.GAUGE, 600, Double.NaN, Double.NaN);
rrdDef.addDatasource("check", DsType.GAUGE, 600, Double.NaN, Double.NaN);
rrdDef.addDatasource("delete", DsType.GAUGE, 600, Double.NaN, Double.NaN); 
```

# user-interface - 剑道网格取消按钮失去了新的价值

> ID：16058446
> 
> 赞同：1
> 
> 时间：2013-04-17T11:09:42.327
> 
> 标签：user-interface, grid, kendo-ui, kendo-grid

我使用带有自定义编辑器的网格。我用列内的文本区域替换常用输入。

用例：

1.  将 textarea 的当前值破解为“test 0”
2.  按下网格的编辑按钮（它的行）
3.  添加新值“test 01”
4.  按网格的更新按钮
5.  检查网格行中的新值是否更新（有效）
6.  再次按下网格的编辑按钮（新值为“test 01”）
7.  按下网格的取消按钮（这里有一些魔法！不仅是网格，还有每个自定义编辑元素）
8.  检查当前值是否没有从“test 01”变为“test 0”（失败）。

取消后，先前的值（“test 0”而不是“test 01”）由网格显示。这种情况与其他列（非 customEditable）中的值相同，例如金额。如果我保存然后按取消，则会显示错误的值，但正确的值将保存在 db 中

完全网格重新加载可以节省情况，但对于 ajax 网格来说不是最佳的

网格的数据源：

```
// bind json result from /Bonuses/GetPagedJsonBonuses
var bonusesDataSource = new kendo.data.DataSource({
    transport: {
        read: "@Url.Action("GetPagedJsonBonuses", "Bonuses")",
        update: {
            url: "@Url.Action("Edit", "Bonuses")",
            type: "PUT"
        },
        create: {
            url: "@Url.Action("Create", "Bonuses")",
            type: "POST"
        },
        parameterMap: function(options, operation) {
            if (operation === "update" || operation === "create") {
                // updates the BonusDTO.EmployeeId with selected value
                if (newValueEmployeeId !== undefined)
                    options.EmployeeId = newValueEmployeeId;
            }
            return options;
        }
    },
    schema: {
        data: "Data", // PagedResponse.Data
        total: "TotalCount", // PagedResponse.TotalCount
        model: {
            id: "BonusId",  // Data
            fields: {
                EmployeeId: { type: "number" },
                EmployeeLastName: {
                    type: "string",
                    editable: true,
                    //validation: { required: {message: "Employee's last name is required"}}
                },
                Amount: {
                    type: "number",
                    editable: true,
                    nullable: false,
                    validation: {
                        required: { message: "Amount is required to be set" }
                    }
                }
            } // fields
        } // model
    }// schema 
}); 
```

网格元素如下所示：

```
// creates bonuses grid control
$("#bonusesGrid").kendoGrid({
    dataSource: bonusesDataSource,
    toolbar: ["create"],
    editable: "inline",
    columns: [
        "BonusId",
        "EmployeeId",
        {
            field: "EmployeeLastName",
            editor: employeeAutocompletingEditor,
            template: "#=EmployeeLastName#"
        },
        "Amount",
        {
            field: "Comment",
            titel: "Comment",
            editor: textareaEditor,
            filterable: {
                operators: {
                    number: {
                        contains: "Contains"
                    }
                }
            }
        },
        {
            command: ["edit"],
            title: " "
        }
    ],
    save: function(e) {
        if (newValueEmployeeId !== undefined && newValueEmployeeLastName !== undefined) {
            e.model.EmployeeId = newValueEmployeeId; // it's a hack to bind model and autocomplete control
            e.model.EmployeeLastName = newValueEmployeeLastName;
        }
    },
    edit: function(e) {
        setCurrentValueEmployeeIdAndLastName(e.model.EmployeeId, e.model.EmployeeLastName);
    },
    cancel: function(e) {
        setCurrentValueEmployeeIdAndLastName(e.model.EmployeeId, e.model.EmployeeLastName);
    }
}); 
```

文本区域代码在这里：

```
function textareaEditor(container, options) {
    $('<textarea data-bind="value: ' + options.field + '" cols="10" rows="4"></textarea>')
        .appendTo(container);
} 
```

* * *

**更新 1**

在第 4 步之后（将“测试 0”更改为“测试 01”评论并按更新）我有下一个请求：

```
 Accept:application/json, text/javascript, */*; q=0.01
  Content-Length:490
  Content-Type:application/x-www-form-urlencoded; charset=UTF-8
  Host:localhost
  Origin:http://localhost
  Referer:http://localhost/
  X-Requested-With:XMLHttpRequest 
```

POST 正文

```
 Form Dataview sourceview URL encoded
  BonusId:45
  EmployeeId:47
  Employee[EmployeeId]:47
  Employee[UserName]:opetriv
  Employee[LastName]:Oleh Petrivskyy
  Employee[LastNameUkr]:Петрівський Олег Миронович
  EmployeeLastName:Oleh Petrivskyy
  Date:Fri Apr 19 2013 12:00:00
  Amount:2
  **Comment:test 01**
  IsActive:true
  Ulc:ryakh               
  Dlc:Fri Apr 19 2013 12:34:33 GMT+0300 (FLE Daylight Time) 
```

这对我来说是正确的。

**控制器的响应是：**

```
{"BonusId":45,
 "EmployeeId":47,
 "Employee":{"EmployeeId":47,"UserName":"opetriv","LastName":"Oleh      Petrivskyy","LastNameUkr":"Петрівський Олег Миронович"},
 "EmployeeLastName":"Oleh     Petrivskyy","Date":"\/Date(1366362000000)\/","Amount":2,**"Comment":"test    01"**,"IsActive":true,"Ulc":"ryakh               ","Dlc":"\/Date(1366375264603)\/"} 
```

在第 7 步（按取消并接收此魔法）之后，没有任何 ajax 请求到服务器。我有一个数据源错误处理程序，它不会触发。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T20:48:03.140

当您按下更新时，服务器的响应是什么很重要。**为dataSource的error**事件放一个handler，看是否触发。

检查服务器对更新请求的原始响应是什么。它不应包含任何错误。另请记住，最新版本的 jQuery 空响应不是有效的 JSON，并且将触发错误事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:16:59.037

使用自定义编辑器更改字段不会触发数据库更新。这可以通过更改`save`函数来解决，如下所示：

```
save: function(e) {
    if (newValueEmployeeId !== undefined && newValueEmployeeLastName !== undefined) {
      e.model.EmployeeId = newValueEmployeeId; // it's a hack to bind model and autocomplete control
    e.model.EmployeeLastName = newValueEmployeeLastName;
    **e.model.dirty = true;**
  } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-05-17T07:44:29.067

我有同样的问题。就我而言，问题是在创建新值后我没有返回正确的模型（使用有效 ID）。

旧代码（不起作用）：

```
public ActionResult Product_Create([DataSourceRequest] DataSourceRequest request, Product product)
{
    if (product != null && ModelState.IsValid)
    {
        Database.Products.InsertOnSubmit(new Product()
        {
            Name = product.Name,
            IsActive = product.IsActive
        });
        Database.SubmitChanges();
    }

    return Json(new[] { product }.ToDataSourceResult(request, ModelState), JsonRequestBehavior.AllowGet);
} 
```

新代码：

```
public ActionResult Product_Create([DataSourceRequest] DataSourceRequest request, Product product)
{
    Product newProduct = product;
    if (product != null && ModelState.IsValid)
    {
        Database.Products.InsertOnSubmit(newProduct = new Product()
        {
            Name = product.Name,
            IsActive = product.IsActive
        });
        Database.SubmitChanges();
    }

    return Json(new[] { newProduct }.ToDataSourceResult(request, ModelState), JsonRequestBehavior.AllowGet);
} 
```

我将 ASP.NET MVC 与 EF 一起使用，因此在`Database.SubmitChanges()`我拥有具有有效 ID 的产品之后。

# c# - Linq过滤器历史记录中的行差异

> ID：16058447
> 
> 赞同：6
> 
> 时间：2013-04-17T11:09:42.503
> 
> 标签：c#, .net, sql, linq

我有一个存储产品更改历史记录的表，并且想要获取在 Col1 或 Col2 或 Col3 中发生更改的记录列表，但不向我显示在这三列中的任何一个中没有更改的记录。

这是一个用 SQL 完成的示例。你如何使用Linq？

创建临时表进行测试

```
CREATE TABLE #ProductHistorical(
    IdProductHistorical int IDENTITY(1,1) NOT NULL,
    IdProduct int NOT NULL,
    DateChange datetime NULL,
    Col1 int NOT NULL,
    Col2 int NOT NULL,
    Col3 int NOT NULL,
 CONSTRAINT PK_ProductHistorical PRIMARY KEY CLUSTERED (IdProductHistorical ASC))
GO 
```

插入测试数据

```
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (1, CAST(0x0000A13900000000 AS DateTime), 1, 2, 3)
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (1, CAST(0x0000A13A00000000 AS DateTime), 1, 2, 3)
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (1, CAST(0x0000A13B00000000 AS DateTime), 1, 2, 3)
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (1, CAST(0x0000A13C00000000 AS DateTime), 1, 1, 3)
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (1, CAST(0x0000A13D00000000 AS DateTime), 1, 1, 3)
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (1, CAST(0x0000A13E00000000 AS DateTime), 2, 2, 2)
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (1, CAST(0x0000A13F00000000 AS DateTime), 2, 2, 2)
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (1, CAST(0x0000A14000000000 AS DateTime), 2, 2, 2)
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (1, CAST(0x0000A14100000000 AS DateTime), 1, 2, 3)
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (2, CAST(0x0000A14200000000 AS DateTime), 1, 1, 1)
INSERT #ProductHistorical ( IdProduct, DateChange, Col1, Col2, Col3) VALUES (2, CAST(0x0000A14300000000 AS DateTime), 1, 1, 2) 
```

SQL 查询

```
SELECT  phWithChanges.DateChange,
       phWithChanges.Col1,
       phWithChanges.Col2,
       phWithChanges.Col3 
FROM #ProductHistorical ph 
       CROSS APPLY (
          SELECT TOP 1 * 
          FROM #ProductHistorical phPost 
          WHERE phPost.IdProduct=ph.IdProduct AND
                phPost.IdProductHistorical>ph.IdProductHistorical AND
                (phPost.Col1<>ph.Col1 OR phPost.Col2<>ph.Col2 OR phPost.Col2<>ph.Col2)
          ORDER BY phPost.IdProductHistorical ASC) phWithChanges
WHERE ph.IdProduct=1
GROUP BY phWithChanges.DateChange,phWithChanges.Col1,phWithChanges.Col2,phWithChanges.Col3

UNION
    --Add First Row
    SELECT * FROM
       (SELECT TOP 1 
          phFirst.DateChange,
          phFirst.Col1,
          phFirst.Col2,
          phFirst.Col3
       FROM #ProductHistorical phFirst
       WHERE phFirst.IdProduct=1 ORDER BY phFirst.IdProductHistorical) rowFirst

ORDER BY 1 
```

数据

```
IdProductHistorical IdProduct   DateChange              Col1        Col2        Col3
------------------- ----------- ----------------------- ----------- ----------- -----------
1                   1           2013-01-01 00:00:00.000 1           2           3
2                   1           2013-01-02 00:00:00.000 1           2           3
3                   1           2013-01-03 00:00:00.000 1           2           3
4                   1           2013-01-04 00:00:00.000 1           1           3
5                   1           2013-01-05 00:00:00.000 1           1           3
6                   1           2013-01-06 00:00:00.000 2           2           2
7                   1           2013-01-07 00:00:00.000 2           2           2
8                   1           2013-01-08 00:00:00.000 2           2           2
9                   1           2013-01-09 00:00:00.000 1           2           3
10                  2           2013-01-10 00:00:00.000 1           1           1
11                  2           2013-01-11 00:00:00.000 1           1           2 
```

结果

```
DateChange              Col1        Col2        Col3
----------------------- ----------- ----------- -----------
2013-01-01 00:00:00.000 1           2           3
2013-01-04 00:00:00.000 1           1           3
2013-01-06 00:00:00.000 2           2           2
2013-01-09 00:00:00.000 1           2           3 
```

你如何使用Linq？

**第一种方法**

```
var query=(
        from ph in ProductHistorical.Where(p=>p.IdProduct==1)
        orderby ph.DateChange ascending 
        select new ProductHistoricalItem
                   {
                       DateChange = ph.DataChange,
                       Col1 = ph.Col1,
                       Col2 = ph.Col2,
                       Col3 = ph.Col3
                   });

List<ProductHistoricalItem> listResult=new List<ProductHistoricalItem>();
ProductHistoricalItem previous = null;
foreach (ProductHistoricalItem item in query)
{
    if (previous == null ||
        previous.Col1 != item.Col1 ||
        previous.Col2 != item.Col2 ||
        previous.Col3 != item.Col3)
    {
        listResult.Add(item);
        previous = item;
    }
} 
```

这不是很有效。我如何在不使用循环的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T13:52:03.900

如果您愿意实现自己的 LINQ 扩展方法，则可以使用“WhereWithPrevious”版本（原始实现是 SelectWithPrevious，来自[此处](https://stackoverflow.com/questions/3683105/calculate-difference-from-previous-item-with-linq/3683217#3683217)），如下所示：

```
public static IEnumerable<TSource> WhereWithPrevious<TSource>
(this IEnumerable<TSource> source,
 Func<TSource, TSource, bool> selector)
{
    using (var iterator = source.GetEnumerator())
    {
        if (!iterator.MoveNext())
        {
             yield break;
        }
        TSource previous = default(TSource);

        // return the first item always
        yield return iterator.Current;

        while (iterator.MoveNext())
        {
            if(previous != null && selector(previous, iterator.Current))
            {
                yield return iterator.Current;
            }
            previous = iterator.Current;
        }
    }
} 
```

查询看起来像这样：

```
ProductHistorical.Where(p => p.Id == 1)
        .Select(
            p => new
            {
                DateChange = p.Date,
                Col1 = p.Col1,
                Col2 = p.Col2,
                Col3 = p.Col3
            })
        .OrderBy(p => p.DateChange)
        .WhereWithPrevious((prev, curr) =>
               prev.Col1 != curr.Col1
            || prev.Col2 != curr.Col2
            || prev.Col3 != curr.Col3) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T13:16:35.927

基本上，我尝试完全应用您的逻辑并将其转换为 Linq 代码。

```
var linqQuery = context.ProductHistoricals
    .SelectMany(ph => context.ProductHistoricals, (ph, phPost) => new { ph = ph, phPost = phPost }) // cross join
    .Where(a => a.ph.IdProduct == a.phPost.IdProduct
            && a.ph.IdProductHistorical > a.phPost.IdProductHistorical
            && (
                a.phPost.Col1 != a.ph.Col1 
             || a.phPost.Col2 != a.ph.Col2 
             || a.phPost.Col3 != a.ph.Col3))
    .Select(a => a.ph)
    .GroupBy(p => new { p.IdProduct, p.Col1, p.Col2, p.Col3 })
    .Select(p => p.OrderBy(phPost => phPost.IdProductHistorical).FirstOrDefault())
    .Union
    (
       // add first row
       context.ProductHistoricals
              .GroupBy(t => t.IdProduct)
              .Select(t => t.OrderBy(p => p.IdProductHistorical).FirstOrDefault())
    ); 
```

此查询返回

```
1   2013-01-01  1   2   3
1   2013-01-04  1   1   3
1   2013-01-06  2   2   2
1   2013-01-09  1   2   3
2   2013-01-10  1   1   1
2   2013-01-11  1   1   2 
```

作为参考，这里是生成的 SQL：

```
SELECT [t10].[test], [t10].[IdProductHistorical], [t10].[IdProduct], [t10].[DateChange], [t10].[Col1], [t10].[Col2], [t10].[Col3]
FROM (
    SELECT [t5].[test], [t5].[IdProductHistorical], [t5].[IdProduct], [t5].[DateChange], [t5].[Col1], [t5].[Col2], [t5].[Col3]
    FROM (
        SELECT [t0].[IdProduct], [t0].[Col1], [t0].[Col2], [t0].[Col3]
        FROM [dbo].[ProductHistorical] AS [t0], [dbo].[ProductHistorical] AS [t1]
        WHERE ([t0].[IdProduct] = [t1].[IdProduct]) AND ([t0].[IdProductHistorical] > [t1].[IdProductHistorical]) AND (([t1].[Col1] <> [t0].[Col1]) OR ([t1].[Col2] <> [t0].[Col2]) OR ([t1].[Col3] <> [t0].[Col3]))
        GROUP BY [t0].[IdProduct], [t0].[Col1], [t0].[Col2], [t0].[Col3]
        ) AS [t2]
    OUTER APPLY (
        SELECT TOP (1) 1 AS [test], [t3].[IdProductHistorical], [t3].[IdProduct], [t3].[DateChange], [t3].[Col1], [t3].[Col2], [t3].[Col3]
        FROM [dbo].[ProductHistorical] AS [t3], [dbo].[ProductHistorical] AS [t4]
        WHERE ([t2].[IdProduct] = [t3].[IdProduct]) AND ([t2].[Col1] = [t3].[Col1]) AND ([t2].[Col2] = [t3].[Col2]) AND ([t2].[Col3] = [t3].[Col3]) AND ([t3].[IdProduct] = [t4].[IdProduct]) AND ([t3].[IdProductHistorical] > [t4].[IdProductHistorical]) AND (([t4].[Col1] <> [t3].[Col1]) OR ([t4].[Col2] <> [t3].[Col2]) OR ([t4].[Col3] <> [t3].[Col3]))
        ORDER BY [t3].[IdProductHistorical]
        ) AS [t5]
    UNION
    SELECT [t9].[test], [t9].[IdProductHistorical], [t9].[IdProduct], [t9].[DateChange], [t9].[Col1], [t9].[Col2], [t9].[Col3]
    FROM (
        SELECT [t6].[IdProduct]
        FROM [dbo].[ProductHistorical] AS [t6]
        GROUP BY [t6].[IdProduct]
        ) AS [t7]
    OUTER APPLY (
        SELECT TOP (1) 1 AS [test], [t8].[IdProductHistorical], [t8].[IdProduct], [t8].[DateChange], [t8].[Col1], [t8].[Col2], [t8].[Col3]
        FROM [dbo].[ProductHistorical] AS [t8]
        WHERE [t7].[IdProduct] = [t8].[IdProduct]
        ORDER BY [t8].[IdProductHistorical]
        ) AS [t9]
    ) AS [t10] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T14:34:55.353

这个怎么样？

```
int? col1 = null;
int? col2 = null;
int? col3 = null;

ProductHistorical.GroupBy(p=>p.IdProduct)
.Select(grp => grp.OrderBy(p=> p.DateChange)
    .Select(p => {
        var changed = col1 != p.Col1 || col2 != p.Col2 || col3 != p.Col3;
        col1 = p.Col1; col2 = p.Col2; col3 = P.Col3;
        return new { p = p, changed = changed };
    }
    .Where(p => p.changed)
    .Select(p => p.p)
)
.SelectMany(p => p) 
```

# iphone - 使用网络服务从 .NET 服务器上的 Iphone 应用程序上传视频

> ID：16058448
> 
> 赞同：1
> 
> 时间：2013-04-17T11:09:53.270
> 
> 标签：iphone, asp.net, web-services, video, file-upload

我已经在 Iphone 中编写了客户端代码。

```
self.postRequest = [[ASIFormDataRequest alloc] initWithURL:[NSURL URLWithString:@"http://Services/UploadVideo.asmx"]];

NSString *urlString=[self.videoURL path];
NSLog(@"urlString=%@",urlString);
[self.postRequest setFile:urlString forKey:@"videoUrl"];
[self.postRequest setRequestMethod:@"POST"];
[self.postRequest setDelegate:self];
[self.postRequest setDidFailSelector:@selector(postFailed:)];
[self.postRequest setDidFinishSelector:@selector(postSuccessful:)];
[self.postRequest startAsynchronous];

LOG output:// urlString=/private/var/mobile/Applications/09108E9E-1494-4C25-8C3E-328B95BD1504/tmp/capture-T0x1e569fd0.tmp.w37766/capturedvideo.MOV 
```

我应该如何捕获它并将其保存在服务器上？提前致谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:25:34.780

首先，您需要将视频转换为 nsdata

```
NSData *data = [NSData dataWithContentsOfFile:video_url]; 
```

然后将 nsdata 转换为 base64 字符串（您需要下载 base64 的单独文件）

```
NSString *encodedString=[data base64EncodedString]; 
```

所以最后你可以将编码的字符串发送到你的.net服务器（你需要在你的.net服务器中解码编码的字符串来检索视频）

上面的代码适用于我作为图像转换（我认为它也适用于视频）

# iphone - iphoe-获取UIView的矩形部分并制作新视图

> ID：16058450
> 
> 赞同：0
> 
> 时间：2013-04-17T11:09:55.497
> 
> 标签：iphone, ios, uiview

我有一个带有图像的 UIView。我使用了 UIBezierPath 并裁剪了该视图的一部分。下图显示。

![在此处输入图像描述](https://i.stack.imgur.com/clJvo.png)

现在我想要一个新的 UIView 对象，其框架为可见图像。我怎样才能做到这一点。请帮忙。谢谢你。

我使用以下来获取图像。

```
-(UIImage *)getImage
{
    UIGraphicsBeginImageContext(self.bounds.size);

    [self.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    [image retain];
    return [image autorelease];
} 
```

但我得到的是原始完整图像，而不是被裁剪的图像。我得到了以下图像。

![在此处输入图像描述](https://i.stack.imgur.com/6uuOt.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:31:17.270

**对于剪切矩形图像：**

```
UIImage *croppedImg = nil;
CGRect cropRect = CGRectMake(100 , 100, 50, 50);// set as you need
croppedImg = [self croppIngimageByImageName:self.imageView.image toRect:cropRect]; 
```

使用以下返回方法`UIImage`（*如您想要的图像大小*）

```
- (UIImage *)croppIngimageByImageName:(UIImage *)imageToCrop toRect:(CGRect)rect
    {
        //CGRect CropRect = CGRectMake(rect.origin.x, rect.origin.y, rect.size.width, rect.size.height+15);

        CGImageRef imageRef = CGImageCreateWithImageInRect([imageToCrop CGImage], rect);
        UIImage *cropped = [UIImage imageWithCGImage:imageRef];
        CGImageRelease(imageRef);

        return cropped;
    } 
```

Here You get `cropped`image and you can put it on you like (also put image on `newView`and add it io you )`backGroungColor``UIImageView``newView`

```
UIView *newView = [[UIView alloc]initWithFrame:CGRectMake("as YOu Need")];
self.tblView.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:cropped]];
[self.view addSubView:newView]; 
```

# actionscript-3 - 如何计算Flex中两条相交线之间的角度

> ID：16058454
> 
> 赞同：1
> 
> 时间：2013-04-17T11:10:08.613
> 
> 标签：actionscript-3, flash, apache-flex, flash-builder

如果有两行 line1 和 line2 。如何计算这两条线之间的角度。

如果 line1 有点 {(x1,y1),(x2,y2)} 而 line2 有点 {(x3,y3),(x4,y4)}

我知道如何计算斜率。计算弯曲角度的任何想法。

让斜坡已知....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:16:10.283

```
var angleRadians:Number=Math.abs(Math.atan2(y2-y1,x2-x1)-Math.atan2(y4-y3,x4-x3));
if (angleRadians>0.5*Math.PI) angleRadians=Math.PI-angleRadians; 
```

简而言之，得到两个斜率，从另一个中减去一个，将结果绝对化（角度为正），并且由于交叉点周围有 4 个角度，所以如果我们会收到一个更大的，那就把它变小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:17:33.653

当斜率已知时，您可以计算角度，如..

斜率 M = y2-y1/x2-x1 , M = tanX , 角度 X = arc tan(M)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-09T10:48:51.597

**代码：**

两个向量之间的度数：

```
public function degreesTwoVectors(v1A:Object, v1B:Object, v2A:Object, v2B:Object):Number 
{
    var angle = (Math.atan2(v1B.y-v1A.y, v1B.x-v1B.x) - Math.atan2(v2B.y-v2A.y, v2B.x-v2B.x)) * (180 / Math.PI);
    if (angle >  180) angle -= 360;
    if (angle < -180) angle += 360;
    return angle;
} 
```

两个向量之间的弧度：

```
public function radiansTwoVectors(v1A:Object, v1B:Object, v2A:Object, v2B:Object):Number 
{
    var angle = Math.atan2(y2-y1, x2-x1) - Math.atan2(y4-y3, x4-x3);
    if (angle >  Math.PI) angle -= Math.PI*2;
    if (angle < -Math.PI) angle += Math.PI*2;
    return angle;
} 
```

**使用示例：**

```
degreesTwoVectors(circle1, circle2, circle3, circle4); 
```

或者

```
degreesTwoVectors(circle1, circle2, circle2, circle3); 
```

或者

```
degreesTwoVectors({x:0,y:0}, circle1, {x:100,y:100}, circle2); 
```

**说明：**

```
//v1A: Object A of vector 1;
//v1B: Object B of vector 1;

//v2A: Object A of vector 2;
//v2B: Object B of vector 2; 
```

# stripes - 无法使用条纹从动作 bean 获取值到 jsp

> ID：16058456
> 
> 赞同：0
> 
> 时间：2013-04-17T11:10:25.353
> 
> 标签：stripes

我的动作豆是

```
@HandlesEvent("getExcessesWidget")
public Resolution getExcessesWidget(){
    primaryCO ="situser5";
    excessList = excessManagementUiService.**getExcessesWidget**(primaryCO);
    return new ForwardResolution("/WEB-INF/jsp/excessManagement/inbox.jsp");
} 
```

GetExcessesWidget 方法 --

```
public FilteredUIExcessList getExcessesWidget(String primaryCO){
    if(primaryCO != null && !primaryCO.trim().equals("")){
        List<CrExcessMaster> crExcessMasterList =       getExcessDbService().getExcessesWidget(primaryCO);
        return UIBeanFormatter.formatWidgetBean(crExcessMasterList);
    }
    return null;
} 
```

我的 UIBeanFormatter.formatWidgetBean 方法是

```
public static FilteredUIExcessList formatWidgetBean(List<CrExcessMaster> crExcessMasterList){
        if(crExcessMasterList != null){

            FilteredUIExcessList filteredUIExcessList = new FilteredUIExcessList();

            List<CustomerExcessUIBean> widgetList = new ArrayList<CustomerExcessUIBean>();

            for(CrExcessMaster crExcessMaster : crExcessMasterList){

                ExcessUIBean excessUIBean = new ExcessUIBean();
                excessUIBean.setExcessId(crExcessMaster.getExcessId().toString());              
                excessUIBean.setOpenDate(sdf.format(crExcessMaster.getOpenDate()));
                excessUIBean.setExcessAmount(crExcessMaster.getMaxExcessAmount().toString());
                excessUIBean.setDaValueForUser(Integer.parseInt(excessDbService.getDaLevelForUser("situser5")));

                CustomerExcessUIBean customerExcessUIBean = new CustomerExcessUIBean();
                customerExcessUIBean.setClientName(getClientName(crExcessMaster.getCif()));
                customerExcessUIBean.setUltimateParent(getParentEntity(crExcessMaster.getCif()));   

if (widgetList.contains(customerExcessUIBean)){
                    widgetList.get(widgetList.indexOf(customerExcessUIBean)).getExcessList().add(excessUIBean);
                }
                else{
                    customerExcessUIBean.getExcessList().add(excessUIBean);
                    widgetList.add(customerExcessUIBean);
                }
            }
            filteredUIExcessList.setWidgetList(widgetList);
            return filteredUIExcessList;
        }
        return null;
    } 
```

我的值在动作 bean 类中正确显示，但我无法在 jsp 文件中获取它我的 jsp 是

```
<s:form method="POST" action="/excessList.htm?getExcessesWidget=true"
        id="form">
        <table border="2px" bordercolor="black" width="100%" height="100%">
            <tr>Excesses to be actioned
            </tr>
            <tr>
                <th>Excess ID</th>
                <th>Date</th>
                <th>Client</th>
                <th>Product</th>
                <th>Amount</th>
                <th>DA</th>
            </tr>
            <tbody>
            <c:forEach items="${actionBean.excessList}" var="excess">
                        <c:forEach items="${excess.widgetList}"     var="customerExcess">
                        <tr>
                            <td><c:out value="${customerExcess.excessId }"></c:out></td>
                            <td><c:out value="${customerExcess.openDate }"></c:out></td>
                            <td><c:out value="${customerExcess.excessAmount }"></c:out></td>
                            <td><c:out value="${customerExcess.daValueForUser }"></c:out></td>
                        </tr>
                    </c:forEach>
                </c:forEach> 
            </tbody>
        </table>
    </s:form> 
```

无法找到我的错误....任何帮助都非常感谢。提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:48:24.663

I don't see where excessList is defined, make sure it has public getter.

# android - 关于成员变量的 onCreate 与 onResume/onRestart 行为

> ID：16058461
> 
> 赞同：7
> 
> 时间：2013-04-17T11:10:40.520
> 
> 标签：android, android-activity, restart, resume

当我打开一个活动时，我知道我可以在 onCreate 函数中初始化东西。

但是 OnResume 和 onRestart 函数的行为是什么？什么时候调用这些函数？

具体来说：我在 onCreate 函数中初始化了一个局部成员变量 auiqring 对全局对象的引用。现在，当用户被打断时，例如，被电话打断，活动可以关闭。稍后，当用户回到我的视图时，已经初始化的变量的状态是什么？我是否必须重新初始化 onResume/onRestart 函数中的所有内容？那么与 onCreate 相反的功能差异是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T11:20:07.307

*   `onCreate`: 活动首次启动。这里是你可以初始化你的东西的地方。
*   `onResume`：用户在另一个活动进入前台后返回活动。( `onPause`)
*   `onRestart`：用户在活动不再可见后导航到活动 ( `onStop`)。

您可以在[Activity 文档](http://developer.android.com/reference/android/app/Activity.html)中查看完整的生命周期。您的活动内容只会在`onDestroy`被调用时丢失，这发生在您完成它或被系统销毁时（即当具有更高优先级的应用程序需要内存时）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:19:58.853

假设从您当前的活动启动对话，主窗口（活动）将进入 onPause 状态。一旦您强制活动处于后台（假设您按下主页按钮），活动将进入 onPause 状态。

# asp.net - 使用 asp 控件在 asp.net 中进行验证

> ID：16058462
> 
> 赞同：-3
> 
> 时间：2013-04-17T11:10:43.397
> 
> 标签：asp.net, validation

对于 asp.net 中的表达式验证，这是什么意思？我在网上找到了这个来检查表达式。

```
[RegularExpression("^[A-Za-z0-9 ]*[A-Za-z0-9][A-Za-z0-9 ]*$")] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:12:58.270

这是一个`Attribute`用 表示的`[...]`。其中包含的正则表达式用于将任何字符串与其进行比较，并接受或拒绝该字符串。

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.componentmodel.dataannotations.regularexpressionattribute.aspx)

```
Specifies that a data field value in ASP.NET Dynamic Data must match the 
specified regular expression. 
```

例子

以下示例显示如何使用 RegularExpressionAttribute 属性来验证 FirstName 和 LastName 数据字段。正则表达式最多允许 40 个大写和小写字符。该示例执行以下任务：
• 实现元数据分部类和关联的元数据类。• 在关联的元数据类中，将RegularExpressionAttribute 属性应用于FirstName 和LastName 数据字段，指定模式和自定义错误消息。

```
 using System;
   using System.Web.DynamicData;
   using System.ComponentModel.DataAnnotations;

   [MetadataType(typeof(CustomerMetaData))]
   public partial class Customer
   {

   }

   public class CustomerMetaData
   {

       // Allow up to 40 uppercase and lowercase  
       // characters. Use custom error.
       [RegularExpression(@"^[a-zA-Z''-'\s]{1,40}$", 
            ErrorMessage = "Characters are not allowed.")]
       public object FirstName;

       // Allow up to 40 uppercase and lowercase  
       // characters. Use standard error.
       [RegularExpression(@"^[a-zA-Z''-'\s]{1,40}$")]
       public object LastName;
   } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:13:37.297

Seema，你为什么不做一些功课[@Regexlib](http://regexlib.com/%28A%28K3dYCiXq6B_RiiOprBynEXSc68xXZtNlcGGcHq94reS_kycg9RjAdxrtrSlxGphm4tIyn04Hw543PkIVZSSnUfCTsC3jcvWhLxNDyTCmcpThl9O4Eu-PV7zKdE9sJ2YGtKqoczRLwrWMN03xJfK8Mx5vUdFkct4qXqGQKyYlwF9PFPhu2d013DLsDiYWVKrZ0%29%29/CheatSheet.aspx)

# java - 使用来自 java 的 javascript 解析 XML

> ID：16058467
> 
> 赞同：2
> 
> 时间：2013-04-17T11:10:57.723
> 
> 标签：java, javascript, xml

为此用途`javax.script.*`

基于

> DOMParser 不是 JS 的一部分，而是 Mozilla 浏览器的一部分，这使得它可用于使用 XPConnect 在浏览器中编写脚本。另一种方法是使用内置的 E4X。

和

> E4X 是在 Rhino（用 Java 编写的 JavaScript 引擎）中实现的。

试试看：

```
import java.io.IOException;
import java.util.Map;

import javax.script.Bindings;
import javax.script.ScriptContext;
import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;

public class heshCode {

    public static void main(String[] args) throws IOException {
        scripter();
    }

    public static void scripter() {
        try {

            String Jscript = "var map = {};" + "\n"+
                      "var x = new XML();" +
                      "var person = new XML('<person><name>Bob Smith</name><likes><os>Linux</os><browser>Firefox</browser><language>JavaScript</language><language>Python</language></likes></person>');" +
                      "map[1]=person.name;" +
                      "map[2]=person['name'];" +
                      "map[3]=person.likes.browser;" +
                      "map[4]=person['likes'].browser;";
            ScriptEngineManager manager = new ScriptEngineManager();
            ScriptEngine rhinoEngine = manager.getEngineByName("javascript");
            Bindings bindings = rhinoEngine
                    .getBindings(ScriptContext.ENGINE_SCOPE);
            rhinoEngine.eval(Jscript.toString());

            @SuppressWarnings("unchecked")
            Map<String, String> m = (Map<String, String>) bindings.get("map");
            for (Map.Entry<String, String> entry : m.entrySet()) {
                System.out.println(entry.getKey() + " = " + entry.getValue());
            }
        } catch (ScriptException e) {
            System.out.println(e.getMessage());
        }
    }
} 
```

但我收到错误：

```
sun.org.mozilla.javascript.EcmaError: ReferenceError: "XML" is not defined. (<Unknown source>#2) in <Unknown source> at line number 2 
```

有什么想法/建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-12T01:14:07.607

Scripting Programmer guide 明确指出它已排除 E4X（ECMAScript for XML）。[在此http://docs.oracle.com/javase/6/docs/technotes/guides/scripting/programmer_guide/](http://docs.oracle.com/javase/6/docs/technotes/guides/scripting/programmer_guide/)中查看。

我有一个类似的问题，我必须使用 java 脚本解析 XML 并获取输出。然后我使用了 Mozilla Rhino ( [https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino](https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino) )。

它适用于我的情况。

希望这可以帮助遇到类似问题的任何人。

# javascript - 当requireJS从服务器加载JS文件时如何更新加载器

> ID：16058471
> 
> 赞同：1
> 
> 时间：2013-04-17T11:11:16.990
> 
> 标签：javascript, requirejs

我有一个使用 requireJS 制作的应用程序。它使用了大量的 JS 文件并且需要时间来下载所有文件。所以我正在考虑在 requireJS 加载 JS 文件时提供进度条。我想知道 requireJS 是否为每个文件加载提供任何钩子或回调，以便我可以更新进度条？

# android - canvas.drawLine() 没有出现在位图上

> ID：16058472
> 
> 赞同：1
> 
> 时间：2013-04-17T11:11:23.293
> 
> 标签：android, canvas, ondraw, drawbitmap

我尝试了很多方法，但我的代码仍然拒绝在画布上简单地画一条线。我注释掉的每一次尝试要么使程序崩溃，要么不显示该行。我真的很难弄清楚如何做到这一点，我不断收到关于使用线程或 onDraw 或其他什么的不同建议，但似乎没有一个有效。

我的总体目标是在屏幕上显示位图图像，并在其上画线。然后，我希望使用 canvas.tranlate 使整个图像（位图及其顶部的线条）能够平移。（我已经实现了成功平移图像的功能。）

```
public class Main extends Activity implements OnTouchListener {
CanvasView myCanvas;
Canvas canvas;
Bitmap bmp;
float fingerPosX = 0;
float fingerPosY = 0;
float preFingerPosX = 0;
float preFingerPosY = 0;
float bmpX = 0;
float bmpY = 0;
float dx = 0;
float dy = 0;
Paint paint;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    bmp = BitmapFactory.decodeResource(getResources(), R.drawable.gmit2013mod);
    canvas = new Canvas();
    myCanvas = new CanvasView(this);
    myCanvas.setOnTouchListener(this);
    setContentView(myCanvas);

}

@Override
public void onPause() {
    super.onPause();
    myCanvas.pause();
}

@Override
public void onResume() {
    super.onResume();
    myCanvas.resume();
}

public boolean onTouch(View v, MotionEvent event) {
    int action = event.getAction();
    if(action == event.ACTION_DOWN) {       //when touch is received get finger position
        preFingerPosX = event.getX();   
        preFingerPosY = event.getY();
    }

    if(action == event.ACTION_UP) {         //when touch is released get finger position
        fingerPosX = event.getX();
        fingerPosY = event.getY();
        dx = fingerPosX - preFingerPosX;    //subtract previous finger position from current
        dy = fingerPosY - preFingerPosY;
        bmpX += dx;                         //apply difference to image
        bmpY += dy;
    }
    //CanvasView.updateMap();
    //invalidate();

    return true;
}

//CanvasView Class
public class CanvasView extends SurfaceView implements Runnable{ //implements Runnable
    SurfaceHolder surfaceHolder;
    Thread myThread = null;
    boolean isRunning = false;

    public CanvasView(Context context) {
        super(context);
        surfaceHolder = getHolder();
    } 

    @Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);
    //  canvas.drawBitmap(bmp, 0, 0, null);
        //canvas = surfaceHolder.lockCanvas();
        canvas.drawLine(10, 10, 30, 30, paint);
        //surfaceHolder.unlockCanvasAndPost(canvas);
    }

    public void pause() {
        isRunning = false;
        while(true) {
            try {
                myThread.join();
            }
            catch (InterruptedException e) {
                e.printStackTrace();
            }
            break;
        }
        myThread = null;
    }

    public void resume() {
        isRunning = true;
        myThread = new Thread(this);
        myThread.start();
    }

    public void run() {
        while(isRunning) {
            //init(); //crashes when code here
            if(!surfaceHolder.getSurface().isValid()) {
                continue;
            }
            invalidate();
            //init();
            //canvas.translate(bmpX, bmpY);
            updateMap();
            //invalidate();
        }
    }

    //  canvas = surfaceHolder.lockCanvas();
    //  canvas.drawRGB(255, 255, 255);
    //  canvas.drawBitmap(bmp, 0-(bmp.getWidth()/2), 0-(bmp.getHeight()/2), null);
    //  surfaceHolder.unlockCanvasAndPost(canvas);
    }

    public void updateMap() {
        runOnUiThread(new Runnable () {

            public void run() {
                // TODO Auto-generated method stub
                //canvas = surfaceHolder.lockCanvas();
                //canvas.drawRGB(255, 255, 255);
                //canvas.drawBitmap(bmp, bmpX-(bmp.getWidth()/2), bmpY-(bmp.getHeight()/2), null);
                //paint.setColor(Color.RED);
                //canvas.drawLine(10, 10, 30, 30, paint);   //it seems this must b in ondraw. try canvas(bmp) again, mite have some affect with different bmp
                //invalidate();
                //surfaceHolder.unlockCanvasAndPost(canvas);

            }

        });
    }
} 
```

这是我的代码，如果您能给我提供任何解决方案或一些已经在线运行的示例，我将不胜感激，因为我在这个项目上的时间不多了！谢谢

**更新：** 我在 onCreate 方法中添加了以下代码行：

```
Drawable drawBmp = new BitmapDrawable(bmp);
drawBmp.draw(canvas); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:28:34.453

您需要将位图创建为 Drawble 对象，然后在该位图上绘制，而不是在它自己的画布上绘制。

所以基本上你在 BitmapFactory 选项的帮助下创建的 Bitmap 对象的帮助下创建了一个 BitmapDrawable 对象。您必须使用此 Drawable 类的 draw(Canvas c) 方法在位图上绘图。

[http://developer.android.com/reference/android/graphics/drawable/BitmapDrawable.html](http://developer.android.com/reference/android/graphics/drawable/BitmapDrawable.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T12:04:00.890

我需要添加`paint = new Paint()`onCreate。油漆对象是`null`如此，这就是它不会绘制的原因。我花了几个星期和大量的纠缠才发现这一点！我要去度假了...

如果有人计划制作这样的项目，我打算在不久的将来制作一些 youtube 视频教程，以帮助任何人避免陷入我所做的同样愚蠢的陷阱！

非常感谢 user_CC 的所有时间和对这个问题的帮助！

# php - 使用 PHP + curl 将包上传到存储库

> ID：16058478
> 
> 赞同：1
> 
> 时间：2013-04-17T11:11:33.980
> 
> 标签：php, libcurl, desire2learn

我需要将 SCORM 包从 PHP 上传到 D2L 实例。我有所有需要的密钥和数据，因为其他查询（例如获取用户配置文件数据的 GET 请求）。我还测试了从 Chrome 的 Advanced REST 插件上传，它工作正常，为 Repository.LRWSPublishResult 提供了新的学习对象 ID 等。

当我尝试使用 CURL 从 PHP 上传时（我的代码基于 GettingStartedSample），我总是得到“对象移动到 /d2l/error/404”响应。我读过这可能是由 URL 的“https”前缀引起的，我应该使用 CURLOPT_FOLLOWLOCATION 选项，但它没有帮助。它遵循重定向并返回空响应。

我做了一个 PUT 请求

> /d2l/api/lr/1.0/objects/?repositoryId=REPO_ID

有人有这方面的工作代码，可以给我一些提示吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T21:05:57.470

这是一些PHP代码：

```
$apiRoute = "/d2l/api/lr/1.0/objects/?repositoryId=" . $repoID;

$id = uniqid();
$data = "--" . $id . "\r\n".
        "Content-Disposition: form-data; name=\"Resource\"; filename=\"HW_SCORM.zip\"\r\n".
        "Content-Type: application/zip\r\n".
        "\r\n".
        file_get_contents("HW_SCORM.zip") . "\r\n".
        "--" . $id . "--";

$uri = $opContext->createAuthenticatedUri($apiRoute, "PUT");

curl_setopt($ch, CURLOPT_URL, $uri);
curl_setopt($ch, CURLOPT_HEADER, 1);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'PUT');
curl_setopt($ch, CURLOPT_HTTPHEADER, array(
  "Content-Type: multipart/form-data; boundary=" . $id,
  "Content-Length: " . strlen($data))
);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);                                                                     

$response = curl_exec($ch); 
```

它将发送如下内容：

```
Content-Type: multipart/form-data; boundary=ba5567548ef846b595f2d8f0ee5a1ca4
Accept: */*
Content-Length: {size}

--ba5567548ef846b595f2d8f0ee5a1ca4
Content-Disposition: form-data; name="Resource"; filename="HW_SCORM.zip"
Content-Type: application/zip

{file_data}
--ba5567548ef846b595f2d8f0ee5a1ca4-- 
```

作为回应，您应该看到类似

```
HTTP/1.1 100 Continue

HTTP/1.1 200 OK
Cache-Control: no-cache, no-store
Pragma: no-cache
Content-Length: 73
Content-Type: application/json; charset=UTF-8
Expires: -1
Server: Microsoft-IIS/6.0
X-Powered-By: ASP.NET
Date: Wed, 17 Apr 2013 21:02:42 GMT

{"IdentId":15805,"Version":1,"ExecutionMessage":null,"ExecutionStatus":0} 
```

**随机猜测**：如果您忘记了文件内容之后和结束边界标记之前的尾随换行符，看起来 LOR 会发送 303 响应告诉您转到 404 页面。

# unix - 如何在 unix 中创建一个新文件？

> ID：16058479
> 
> 赞同：11
> 
> 时间：2013-04-17T11:11:35.030
> 
> 标签：unix

如何在不同的目录中创建新文件？如果文件存在，它还应该创建一个新文件。

我正在使用命令：

```
Touch workdirectory/filename.txt 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-17T11:29:43.127

尝试`> workdirectory/filename.txt`

这个会：

*   如果文件存在则截断文件
*   如果不存在则创建

你可以认为它等同于：

```
rm -f workdirectory/filename.txt; touch workdirectory/filename.txt 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-17T11:13:48.970

命令是小写的：`touch filename`.

请记住，`touch`如果它不存在，只会创建一个新文件！这里有一些很好的文档：[http ://unixhelp.ed.ac.uk/CGI/man-cgi?touch](http://unixhelp.ed.ac.uk/CGI/man-cgi?touch)

如果您总是想要一个空文件，一种方法是使用：

```
echo "" > filename 
```

# jquery - 如何在段落末尾添加阅读更多链接？

> ID：16058483
> 
> 赞同：10
> 
> 时间：2013-04-17T11:11:42.143
> 
> 标签：jquery, css

我正在尝试添加一个链接以在段落末尾阅读更多文本。我希望这个链接在最后的段落中显示，如下所示：

![](https://i1208.photobucket.com/albums/cc376/Elementgraphics/read-more_zps834399fb.jpg)

我希望该段落附有 ... 和阅读更多链接。

现在我不希望阅读更多链接做任何事情，因为一旦我获得链接，我将添加我自己的功能。我只是在努力寻找一种方法让链接看起来像这样。

我一直在查看以下 jquery 脚本，但这似乎适用于字符数，并在字符限制处剪切最后一个单词，然后不显示我想要的方式（链接出现在段落下方） . 它还已经包含一个功能，用于单击链接时发生的情况，由于我缺乏 jquery 的能力，我一直未能成功编辑。

```
$(function(){ /* to make sure the script runs after page load */
    $('.customer_experience').each(function(event){ /* select all divs with the  customer_experience class */
        var max_length = 250; /* set the max content length before a read more link will be added */

        if($(this).html().length > max_length){ /* check for content length */
            var short_content   = $(this).html().substr(0,max_length); /* split the content in two parts */
            var long_content    = $(this).html().substr(max_length);

            $(this).html(short_content+
                '<a href="#" class="read_more"><br/>read more...</a>'+
                '<span class="more_text" style="display:none;">'+long_content+'</span>'); /* Alter the html to allow the read more functionality */

            $(this).find('a.read_more').click(function(event){ /* find the a.read_more element within the new html and bind the following code to it */
                event.preventDefault(); /* prevent the a from changing the url */
                $(this).parents('.customer_experience').find('.more_text').show(); /* show the .more_text span */
            });
        }
    });
}); 
```

我是否需要使用 jQuery 来获得我正在寻找的结果？这可以单独使用 CSS 完成吗？我根本不会写 jQuery，所以我有点迷茫。

任何关于我可以去哪里的帮助或提示将不胜感激。

编辑添加 HTML 标记

```
<div class='comments_container'>
    <img src='images/comment-icon.png'/>
    <h1 class='comments_title'>Customer experience</h1>
    <p class='customer_experience'>$customer_exp_one</p>
</div> 
```

有问题的段落是`.customer_experience`。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-17T11:31:09.180

我希望下面的对你有帮助。

[http://jsfiddle.net/X5r8r/1156/](http://jsfiddle.net/X5r8r/1156/)

```
body, input {
    font-family: Calibri, Arial;
    margin: 0px;
    padding: 0px;
}
a {
    color: #0254EB
}
a:visited {
    color: #0254EB
}
#header h2 {
    color: white;
    background-color: #00A1E6;
    margin: 0px;
    padding: 5px;
}
.comment {
    width: 400px;
    background-color: #f0f0f0;
    margin: 10px;
}
a.morelink {
    text-decoration: none;
    outline: none;
}
.morecontent span {
    display: none;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-17T11:36:39.900

用于截断段落。此脚本检查段落计数，而不是字数。

**JS（带 Jquery）**

```
$(document).ready(function() {

    /* Count of paragraphs shown */
    var cutCount = 2;

    $("#testID p").each(function (i) {
        i++;
        if(i == cutCount) {
            $(this).append(' <a href="javascript:void(1)" onclick="$(\'#testID p\').show(); $(this).hide()">Read more</b>')   
        }
        if(i > cutCount) {
           $(this).hide();
        }
    });

}); 
```

**HTML**

```
<div id="testID">

<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam egestas lobortis mi, quis convallis arcu interdum id. Nunc velit justo, congue ac vestibulum eu, sodales sed nulla. Nam semper egestas nunc, placerat suscipit lorem fringilla sit amet. Etiam id metus quis tellus luctus rhoncu</p>

<p>Donec euismod, dui aliquam vestibulum rutrum, urna ipsum luctus justo, in eleifend tellus ligula et elit. Morbi gravida lacinia magna quis faucibus. Duis arcu ligula, euismod sed ornare quis, posuere ac quam. Sed orci metus, pretium ut blandit sed, ullamcorper in eros. Mauris at euismod diam. Quisque auctor congue erat et varius. Nulla odio orci, convallis non fringilla vel.</p>

<p>Curabitur a velit eu lacus vestibulum vehicula. Proin mi velit, tempor quis convallis vulputate, adip</p>

<p>Nullam eget pulvinar arcu. Nam tellus tortor, luctus non rutrum eget, condimentum ac lectus. Nulla diam tellus, aliquet non auctor nec, bibendum nec orci. Proin rhoncus sodales sapien, sit amet eleifend erat sagittis quis. Ut et urna et erat venenatis convallis at sit amet sem. Quisque tempus sodales ornare. Maecenas eget nisi et ligula facilisis dictum.</p>

<p>Etiam lectus dolor, tincidunt a ultricies et, vehicula ut lectus. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Aenean bibendum suscipit nunc sit amet ultrices. Praesent nunc velit, dignissim eget tincidunt non, varius at velit. Aliquam ac interdum lectus. Nulla a ante lacinia arcu suscipit suscipit a nec mauris. In sed tempor massa. Donec luctus dapibus dolor, vel mattis justo pulvinar eget. Pellentesque scelerisque dolor ut erat cursus ornare. In in nunc et tellus consequat convallis id sed est. Integer dictum fermentum tempus. Ut lobortis ante vel ante condimentum lacinia. Donec malesuada pretium sapien, et euismod turpis faucibus at. Duis vel turpis ultrices enim viverra vestibulum vitae sed sapien.</p>

</div> 
```

示例 [http://jsfiddle.net/9bXQh/2/](http://jsfiddle.net/9bXQh/2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T11:20:13.180

你可以用这样的东西切割空间：

```
$(this).html().substr(0, $(this).html().indexOf(" ", max_length)) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T11:47:42.837

我进行了网络搜索，发现了这个插件：[http](http://dotdotdot.frebsite.nl/) ://dotdotdot.frebsite.nl/ 。

我想这并不能真正回答您的问题，只是为您指明可能的解决方案的方向。看起来这个插件可以让你做你想做的事：当文本超过固定高度的容器时截断文本，添加一个“阅读更多”链接，并将你自己的自定义函数绑定到“阅读更多”链接。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-09T12:35:07.617

单击下面的按钮以通过类更改显示和隐藏另一个元素：

`.collapse`隐藏内容

`.collapsing`在过渡期间应用

`.collapse.`show 显示内容 您可以使用带有属性的链接`href`或带有属性的按钮`data-target`。在这两种情况下，`data-toggle="collapse"`都是必需的。HTML

```
 <div class="container">

     <div class="row justify-content-center">
      <div class="col-md-4">
        <div id="parent">
         <p class="collapse" id="collapseParent">
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc     </p>
         <a class="collapsed" data-toggle="collapse" href="#collapseParent" aria-expanded="false" aria-controls="collapseParent"></a>
   </div>
 </div> 
```

CSS

```
#parent {
   font-size: 14px;
   line-height: 1.5;
}

#parent p.collapse:not(.show) {
   height: 42px !important;
   overflow: hidden;
   display: -webkit-box;
   -webkit-line-clamp: 2;
   -webkit-box-orient: vertical;  
  }

#parent p {
    min-height: 42px !important;
}

 #parent a.collapsed:after  {
     content: 'Read More';
  }

  #parent a:not(.collapsed):after {
      content: 'Read Less';
  } 
```

[CodePen 示例](https://codepen.io/KondalDurgam/pen/VxyKEg)

# sql-server-2008 - SQL Server 2008 R2 JOB 步骤链接服务器登录失败

> ID：16058486
> 
> 赞同：0
> 
> 时间：2013-04-17T11:11:45.950
> 
> 标签：sql-server-2008, linked-server, data-transfer, sql-job

我需要每天转移一张桌子。表名每天都在变化，所以我应该使用脚本来获取表名。

有一个作业步骤将数据从源表传输到使用`T-SQL`查询创建的目标表。sourceTable 和destinationTable 位于不同的服务器中。链接服务器工作正常。

如果我在 sql serer management studio 中执行相同的查询，它工作正常。但是当在这一步执行作业时，我看到了这条消息：

> 以用户身份执行：NT AUTHORITY\SYSTEM。用户“NT AUTHORITY\ANONYMOUS LOGON”登录失败。步骤失败。

两个 sql server 都是 2008 R2 版本，并且相互链接。

您可能会建议一些其他方法，而不是使用 T-SQL。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-05T21:04:26.717

这是因为 SQL 服务器的“2-Hops”问题。我可以通过两种方式解决这个问题： 1\. 仍然使用链接服务器：在远程服务器上创建具有 SQL Server 身份验证的用户并提供所有需要的权限。然后打开链接服务器属性并将您的帐户映射到您刚刚创建的用户，如下所示： ![在此处输入图像描述](https://i.stack.imgur.com/1el1w.png)

之后，您将能够运行您的脚本

2.  使用 openrowset：

    SELECT a.* FROM OPENROWSET('SQLNCLI', 'Server=;Trusted_Connection=yes;', 'SELECT * from .dbo.') AS a;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-11T15:07:06.367

我无法用链接服务器解决这个问题。

我没有使用链接服务器，而是使用了以下步骤：

1.  将 x 重命名为 x_temp
2.  使用 SSIS 包（比链接服务器查询快得多）将所有数据从 x_temp 移动到其他服务器。
3.  将 x_temp 重命名为 x_dd_mm_yyyy

# django - 模型对象过滤不起作用

> ID：16058491
> 
> 赞同：0
> 
> 时间：2013-04-17T11:12:01.007
> 
> 标签：django, django-models, django-admin

我尝试在电路模型类的管理类中过滤外键字段的对象：

```
def formfield_for_foreignkey(self, db_field, request, **kwargs):
        if db_field.name == "current_firmware":
            kwargs["queryset"] = FirmwareVersion.objects.filter(firmware__circuit_model=self.model)
        return super(CircuitAdmin, self).formfield_for_foreignkey(db_field, request, **kwargs) 
```

我不知道为什么，但`current_firmware`过滤后字段的选择列表为空。也许任何人都可以帮助我。我有这些课程：

```
class FirmwareVersion(models.Model):
    firmware = models.ForeignKey(Firmware)
    version = models.CharField(max_length=100)

class Firmware(models.Model):
    name = models.CharField(max_length=250)
    circuit_model = models.ForeignKey(Versiiplates)

class Versiiplates (Model):
     version = ForeignKey(Plates)
     nomer_oboznachenie = CharField(max_length=8)

class Circuit(models.Model):
    circuit_id = models.PositiveIntegerField(blank=True, null=True)
    model = models.ForeignKey(Versiiplates)
    current_firmware = models.ForeignKey(FirmwareVersion, blank=True, null=True) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:17:50.300

我怀疑你想`self.model`在你的过滤器表达式中使用：在 ModelAdmin 对象中，它只是指模型类，而不是实例。

事实上，这可能根本不是进行这种过滤的方法。而不是定义`formfield_for_foreignkey`，您可能需要定义一个自定义模型表单，并在那里设置查询集`self.instance`作为比较。

# java - 在 MyBatis 中使用 resultMap 选择查询只获取一行

> ID：16058492
> 
> 赞同：0
> 
> 时间：2013-04-17T11:12:02.697
> 
> 标签：java, select, mybatis

我们正在将 MyBatis 用于我正在从事的项目之一。我在尝试使用 resultMap 获取结果时遇到问题。

**映射器.xml**

```
 <resultMap id="BaseResultMap" type="com.mycompany.myproduct.dto.ChannelMap">
        <id column="CHNL_MAP_ID" property="chnlMapId" jdbcType="DECIMAL" />
        <result column="CHNL_MAP_NM" property="chnlMapNm" jdbcType="VARCHAR" />
        <association property="ctnDlvryPltf"
            resultMap="com.mycompany.myproduct.mapper.ContentDelvryPltfrmMapper.BaseResultMap" />
        <association property="ctnDtr"
            resultMap="com.mycompany.myproduct.mapper.ContentDistributorMapper.BaseResultMap" />
        <association property="region"
            resultMap="com.mycompany.myproduct.mapper.RegionMapper.BaseResultMap" />
    </resultMap>    
    <sql id="Value_Columns_List">
        cmap.CHNL_MAP_NM, cdp.CTN_DLVRY_PLTF_NM,
        cdp.CTN_DLVRY_PLTF_TYP_NM, cdp.CTN_DTR_NM, cd.CTN_DTR_NM,
        cmap.RGN_ID, cmap.CNTRY_ID
    </sql>
    <select id="select" resultMap="BaseResultMap">
        select
        <include refid="Value_Columns_List" />
        FROM
        channel_map cmap,
        (SELECT
        cdpl.ctn_dlvry_pltf_id,cdpl.ctn_dlvry_pltf_nm,
        cdplt.ctn_dlvry_pltf_typ_nm ,cds.ctn_dtr_nm FROM
        content_delvry_pltfrm
        cdpl,
        content_delvry_pltfrm_typ cdplt,
        content_distributor cds
        WHERE
        cdpl.ctn_dlvry_pltf_typ_id =
        cdplt.ctn_dlvry_pltf_typ_id AND
        cdpl.ctn_dtr_id = cds.ctn_dtr_id)
        cdp,
        content_distributor
        cd
        WHERE
        cmap.ctn_dlvry_pltf_id = cdp.ctn_dlvry_pltf_id AND
        cmap.ctn_dtr_id = cd.ctn_dtr_id         
    </select> 
```

在上述文件中需要注意的重要一点是，我们在选择查询中通过不同的别名（参见 Value_Columns_List）两次获取名为 CTN_DTR_NM 的列。这是因为 channel_map 表包含一个 CTN_DTR_NM。频道映射表还包含对另一个包含 CTN_DTR_NM 的表的引用。

我面临的问题是，即使 channel_map 表包含多行，select 方法也会返回一个仅包含一行的 List。查看 MyBatis 日志显示实际查询获取了多行，并且所有获取的行都显示在日志中。我感觉问题与 MyBatis 获取的结果集映射到我的 POJO 的方式有关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-25T21:31:10.023

就你为 chnlMapId 属性使用 id 标签而言，你正在阻止 mybatis 生成多个具有相同 chnlMapId 值的对象。¿您是否尝试对 chnlMapId 属性使用结果标记而不是 id 标记？

# node.js - 从本地文件夹引用节点模块

> ID：16058494
> 
> 赞同：2
> 
> 时间：2013-04-17T11:12:05.830
> 
> 标签：node.js, npm

由于我的办公系统的代理限制，为了安装节点及其模块，我依赖于外部 PC。我的外部系统中有**node.exe**和**npm.cmd**，我可以在那里下载模块

> npm 安装快递

我从我的外部 PC 复制了 node_modules 文件夹并将其放在我办公室 PC 的节点安装路径中，但我仍然无法做到

> 要求（'表达'）

它说找不到模块快递。*所以我认为节点没有考虑安装这个模块，所以我复制了我的项目附近的模块文件夹，并在我的一个 js 文件中引入了一个路径变量。

> var path = 'D:/sw/nodejs/'; // 这里我暂时复制了express文件夹 var express = require(path+'express'), app = express.createServer();

在这里运行时找不到模块“连接”。

我应该把这些依赖模块放在哪里，让它们正常工作，我们不能通过将它们粘贴到 node_modules 来安装节点模块吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T11:44:56.757

您必须`NODE_PATH`在您的环境中设置变量

```
set NODE_PATH=D:/sw/nodejs/node_modules 
```

然后就可以使用里面的所有模块了`D:/sw/nodejs/node_modules`。express 需要它无法找到的连接模块，这`require('connect')`与您调用的 express 不同`require(path+'express')`。

您还可以在 NODE_PATH 中指定多个路径，以 ';' 分隔

```
set NODE_PATH=C:/path/1;C:/path/2; 
```

最好设置一个而不是每次在控制台上键入它。转到：
我的电脑 > 右键单击​​ > 属性 > 高级系统设置 > 环境变量 > 新建
并在`NODE_PATH`那里设置变量。您必须重新启动才能看到更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:17:50.990

任何一个：

*   将下载的包放入项目/源代码的**根目录**（从您调用节点的位置）的`node_modules`文件夹中。
***   [为 npm设置](https://npmjs.org/doc/config.html)代理。（[例](http://jjasonclark.com/how-to-setup-node-behind-web-proxy)）**

# math - 如何在没有舍入误差的情况下获得六边形边缘的坐标？

> ID：16058499
> 
> 赞同：0
> 
> 时间：2013-04-17T11:12:25.650
> 
> 标签：math, canvas, geometry, kineticjs, rounding-error

我需要在 JavaScript 中生成 6 个坐标（x，y），代表六边形的边缘，但我需要结果没有“舍入错误”，我该如何实现？当我有舍入误差时，如果六边形足够大，在坐标处绘制的圆圈之间会有一些不需要的空间，或者换句话说，它们不能准确地对齐在一起。

也许用于计算坐标的数学需要摆脱 cos 或 sin 等某些方法？但如果没有，我有什么选择？[我尝试使用 BigDecimal ( https://github.com/dtrebbien/BigDecimal.js](https://github.com/dtrebbien/BigDecimal.js) )来表达数学，但它似乎并没有改变任何东西，尽管也许我用错了，我宁愿不必使用它.

无效方法一：http: [//jsbin.com/ekuyam/2/edit](http://jsbin.com/ekuyam/2/edit)

无效方法二：http: [//jsbin.com/ekuyam/4/edit](http://jsbin.com/ekuyam/4/edit)

小的：

![在此处输入图像描述](https://i.stack.imgur.com/n9gNf.png)

大的：

![在此处输入图像描述](https://i.stack.imgur.com/qtvIS.png)

# windows-phone-8 - 有什么东西会阻止 PubCenter 广告在未发布的应用中显示吗？

> ID：16058500
> 
> 赞同：0
> 
> 时间：2013-04-17T11:12:27.043
> 
> 标签：windows-phone-8

我在我的 WP8 应用程序中使用 AdRotator，虽然 NAX 和 AdDuplex 广告显示得很好，但 PubCenter 广告没有显示。是否必须发布应用程序才能立即显示？我以前这样做过，但自从最新的 AdRotator 更新以来就没有这样做过，因此可能不是最新的 PubCenter 更新。

这是我的xml：

```
<AdRotator:AdRotatorControl
        Grid.Row="1"
        x:Name="Ad1"
        Visibility="Visible"
        Height="80"
        Width="480"
        DefaultAdType="PubCenter"
        PubCenterAppId="xxxxxxxxxxxxxxxxxxx"
        PubCenterAdUnitId="xxxxxxxxxx"
        AdDuplexAppId="xxxxxxx"
        InneractiveAppId="xxxxxxxxxxxxxxxx"
        DefaultSettingsFileUri="xxxxxxxx/defaultAdSettings.xml"
        SettingsUrl="http://xxxxxxxxxxxxxxxxxxx.xml"
        Margin="0" /> 
```

就像我说的，其他广告在设备和模拟器中都显示得很好，但 PubCenter 广告没有显示。我唯一能想到的是它们现在不能在未发布的应用程序中工作，但我不想在没有它们工作的情况下发布。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T21:42:54.813

我想到了。PubCenter 广告需要比 NAX 广告更多的功能。PubCenter 广告需要：

```
<Capability Name="ID_CAP_IDENTITY_USER"/>
<Capability Name="ID_CAP_MEDIALIB_PHOTO"/>
<Capability Name="ID_CAP_NETWORKING" />
<Capability Name="ID_CAP_PHONEDIALER" />
<Capability Name="ID_CAP_WEBBROWSERCOMPONENT" /> 
```

我真的很讨厌它需要用户身份和照片库，因为我认为他们没有真正的理由在那里，而且它使应用程序看起来更加可疑，IMO，但他们在那里......

# ruby-on-rails - 使用 current_page 在 HAML 中激活链接？

> ID：16058502
> 
> 赞同：1
> 
> 时间：2013-04-17T11:12:28.760
> 
> 标签：ruby-on-rails, ruby, haml

所以我得到了这个错误的代码（当它不是根路径时，链接会消失。）：

```
 = link_to "News", root_path, class: "active" if current_page?(root_path) 
```

当 current_page 为 root_path 时，我想将链接的类设为 .active。

试图找到 Rails 方式

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T11:13:32.420

将选项 for 括`class`在括号中

```
= link_to "News", root_path, class: ("active" if current_page?(root_path)) 
```

# dart - 将符号转换为字符串

> ID：16058505
> 
> 赞同：18
> 
> 时间：2013-04-17T11:12:44.070
> 
> 标签：dart

有没有办法将符号转换为字符串？

例如，VariableMirror 返回符号而不是字符串。有没有办法将符号转换为字符串，所以我可以打印一个类的所有变量名？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-17T18:05:04.610

使用[MirrorSystem.getName()](https://api.dartlang.org/apidocs/channels/stable/dartdoc-viewer/dart-mirrors.MirrorSystem#id_getName)：

```
import 'dart:mirrors';

void main() {
  var sym = new Symbol('test');
  print(MirrorSystem.getName(sym));
} 
```

这输出：

```
测试

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-02-18T18:11:11.663

我对这个问题也很感兴趣。
我不能在我的包中使用 'dart:mirrors'，所以使用以下内容：

```
String s = new Symbol('hi').toString();
s = s.substring(8,pn.length-2); 
```

看起来很糟糕，但它可以完成工作。也许有一个性能问题。

# 编辑：

### `机会是伟大的事情在缩小的 JS 中打破。非常气馁！` by Günter Zöchbauer

没想到这个，谢谢。
即使它现在有效，将来也有可能损坏，所以我想最好避免使用'toString()'。

确认的：

```
Warning: 'hi=' is used reflectively but not in MirrorsUsed. This will break minified code.index.bootstrap.initialize.dart.js:7612 
Warning: 'hi' is used reflectively but not in MirrorsUsed. This will break minified code` 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-03-15T08:59:49.850

事实证明有一个简单的解决方案

```
print(MirrorSystem.getName(symbol)); 
```

印刷

> 某人的名字

另见：[https ://code.google.com/p/dart/issues/detail?id=17471](https://code.google.com/p/dart/issues/detail?id=17471)

**编辑**

*@lrn 对上面链接的问题的有趣评论*

> 它是故意“难以使用”的。符号可以通过 dart2js 缩小，查找它们的原始名称只能通过镜像系统完成。这允许 dart2js 知道该功能是否被使用，如果不需要，则不包含转换表。一般来说，如果可能的话，我建议以一种不需要将符号转换为字符串的方式进行编码。将它们视为不透明的标记，并且仅将它们与其他标记进行比较。

[Smoke 包](https://pub.dartlang.org/packages/smoke)为此提供了一项服务，该服务由其转换器以一种也适用于缩小 JavaScript 的方式转换为代码。`symbolToName()`和`nameToSymbol()`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-29T19:01:39.057

一些示例代码：

```
// Listen for App changes so we can do some things.
app.changes.listen((List<ChangeRecord> records) {
  PropertyChangeRecord record = records[0] as PropertyChangeRecord;
  String changedValue = MirrorSystem.getName(record.name);

  if (changedValue == "pageTitle") {
    print("$changedValue changed!");
  }
} 
```

# android - SurfaceView 不显示来自媒体播放器的视频

> ID：16058507
> 
> 赞同：2
> 
> 时间：2013-04-17T11:12:56.340
> 
> 标签：android, surfaceview, android-mediaplayer

我正在制作一个自定义视频播放器，我正在使用 Surfaceview 和视频播放器，但是当我运行该应用程序时，它只显示黑屏并播放音频。

我的代码：

```
public class MainActivity extends Activity implements SurfaceHolder.Callback {

    private SeekBar seekbar;
    private ImageView ivPlay;
    private SurfaceView surfaceView;
    private SurfaceHolder surfaceHolder;
    private MediaPlayer mediaPlayer;
    private Handler mHandler;
    private Utilities utils;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        initObjects();
        playVideo();
    }

    private void initObjects() {
        seekbar = (SeekBar) findViewById(R.id.sbVideo);
        seekbar.setOnSeekBarChangeListener(seekbarChangeListener);
        mHandler = new Handler();
        utils = new Utilities();
        ivPlay = (ImageView) findViewById(R.id.ivPlay);
        ivPlay.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View view) {
                if (mediaPlayer.isPlaying()) {
                    if (mediaPlayer != null) {
                        mediaPlayer.pause();
                        // Changing button image to play button
                        ivPlay.setImageResource(R.drawable.ic_media_play);
                    }
                } else {
                    // Resume song
                    if (mediaPlayer != null) {
                        mediaPlayer.start();
                        // Changing button image to pause button
                        ivPlay.setImageResource(R.drawable.ic_media_pause);
                    }
                }

            }
        });
        surfaceView = (SurfaceView) findViewById(R.id.svVideoSurface);
        surfaceHolder = surfaceView.getHolder();
        surfaceHolder.addCallback(this);
        surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

        mediaPlayer = new MediaPlayer();
        mediaPlayer.setDisplay(surfaceHolder);
    }

    public void playVideo() {
        // Play song

        Uri uri = Uri
                .parse("android.resource://com.videoplayer.demo/raw/title_video1");

        try {

            mediaPlayer.reset();
            mediaPlayer.setDataSource(MainActivity.this, uri);

            mediaPlayer.prepare();
            mediaPlayer.start();

            // Changing Button Image to pause image
            ivPlay.setImageResource(R.drawable.ic_media_pause);

            // set Progress bar values
            seekbar.setProgress(0);
            seekbar.setMax(100);

            // Updating progress bar
            updateProgressBar();
        } catch (IllegalArgumentException e) {
            e.printStackTrace();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private OnSeekBarChangeListener seekbarChangeListener = new OnSeekBarChangeListener() {

        @Override
        public void onStopTrackingTouch(SeekBar seekbar) {
            mHandler.removeCallbacks(mUpdateTimeTask);
            int totalDuration = mediaPlayer.getDuration();
            int currentPosition = utils.progressToTimer(seekbar.getProgress(),
                    totalDuration);

            // forward or backward to certain seconds
            mediaPlayer.seekTo(currentPosition);

            // update timer progress again
            updateProgressBar();

        }

        @Override
        public void onStartTrackingTouch(SeekBar seekbar) {
            // TODO Auto-generated method stub
            mHandler.removeCallbacks(mUpdateTimeTask);
        }

        @Override
        public void onProgressChanged(SeekBar seekbar, int progress,
                boolean fromUser) {
            // TODO Auto-generated method stub

        }
    };

    @Override
    public void surfaceChanged(SurfaceHolder holder, int arg1, int arg2, int arg3) {
        mediaPlayer.setDisplay(holder);

    }

    @Override
    public void surfaceCreated(SurfaceHolder holder) {

    }

    @Override
    public void surfaceDestroyed(SurfaceHolder arg0) {
        // TODO Auto-generated method stub

    }

    public void updateProgressBar() {
        mHandler.postDelayed(mUpdateTimeTask, 100);
    }

    private Runnable mUpdateTimeTask = new Runnable() {
        public void run() {
            long totalDuration = mediaPlayer.getDuration();
            long currentDuration = mediaPlayer.getCurrentPosition();

            // Updating progress bar
            int progress = (int) (utils.getProgressPercentage(currentDuration,
                    totalDuration));
            // Log.d("Progress", ""+progress);
            seekbar.setProgress(progress);

            // Running this thread after 100 milliseconds
            mHandler.postDelayed(this, 100);
        }
    };

    @Override
    protected void onDestroy() {
        super.onDestroy();
        mediaPlayer.release();
    };
} 
```

我不知道我做错了什么，任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-06T05:59:48.927

试试这个，它会帮助你！

```
 @Override
 public void surfaceCreated(SurfaceHolder holder) {
    if(player == null) {
        player = new MediaPlayer();
    }
    player.setDisplay(holder);
 } 
```

# c# - 如何打开 docx 进行写作？

> ID：16058509
> 
> 赞同：-1
> 
> 时间：2013-04-17T11:13:00.423
> 
> 标签：c#, ms-word

我需要打开一个word文件进行写作。这是我的代码：

```
private void button1_Click(object sender, `EventArgs` e)
{
    var wordApp = new Microsoft.Office.Interop.Word.Application();

    object useDefaultValue = Type.Missing;
    object readnly = false;
    object visibe = true;
    wordApp.Documents.Open("f:\\test2.docx");
} 
```

但它以只读方式打开我的文件。为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:27:23.413

为我工作

```
Word._Application oWord;
Word._Document oDoc;
object oMissing = Type.Missing;
oWord = new Word.Application();
oWord.Visible = true;

//Add Blank sheet to Word App
oDoc = oWord.Documents.Add(ref oMissing, ref oMissing, ref oMissing, ref oMissing); 

oWord.Selection.TypeText("Write your text here"); 
```

# c# - 如何在 WPF 中从 C# 代码隐藏中获取/放置这些 XAML 数据源值？

> ID：16058515
> 
> 赞同：0
> 
> 时间：2013-04-17T11:13:20.093
> 
> 标签：c#, wpf, data-binding, collections

我正在学习WPF。

考虑 WPF 应用程序的 XAML 代码：

```
<Window x:Class="_0SE_BridgingCodeBehind.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:col="clr-namespace:System.Collections;assembly=mscorlib"
    xmlns:sys="clr-namespace:System;assembly=mscorlib" 
            Title="MainWindow" Height="350"    Width="525" Loaded="Window_Loaded">

   <Window.Resources>
       <col:ArrayList x:Key="MyDataSource">
           <sys:DateTime>1/2/2003 5:00:00</sys:DateTime>
           <sys:DateTime>4/5/2006 13:13:13</sys:DateTime>
           <sys:DateTime>7/8/2009 23:59:59</sys:DateTime>
       </col:ArrayList>
   </Window.Resources>
   <Canvas>
       <ListBox Width="200" Height="100"
             ItemsSource="{StaticResource MyDataSource}">
             <ListBox.ItemTemplate>
                <DataTemplate>
                   <StackPanel Orientation="Horizontal">
                       <Label Content="{Binding DayOfWeek}" 
                          Width="80" Background="Red" />
                       <Label Content="{Binding DayOfYear}" 
                          Width="50" Background="Yellow" />
                       <Label Content="{Binding TimeOfDay}" 
                          Background="LightBlue" />
                   </StackPanel>
                  </DataTemplate>
              </ListBox.ItemTemplate>
       </ListBox>
   </Canvas>
</Window> 
```

![在此处输入图像描述](https://i.stack.imgur.com/GbdUd.png)

来自 codepoject 文章“ [WPF 列表/视图 - 可视化快速入门](http://www.codeproject.com/Articles/33650/WPF-Lists-Views-A-Visual-Quick-Start)”（“数据模板”部分），
如何按顺序修改项目代码：

*   添加到第`MyDataSource`4 个中的 3 个现有静态值，例如`4/4/2013 13:12:13`C# 代码 ( `MainWindow.xaml.cs`) 中的值？
*   在 C# 代码中获取第二个 DateTime 值（当前`4/5/2006 13:13:13`在`MyDataSource`XAML 代码中）？

更新：
遵循[Henk Holterman 的回答](https://stackoverflow.com/a/16059170/2031316)（稍作改动）：

```
<Canvas>
    <ListBox Width="200" Height="100"
      x:Name="myListBox"
      ItemsSource="{StaticResource MyDataSource}" 
```

我已经从 C# 中渲染了值（从 XAML 中丢失了它们，尽管我不想要它们）或 C# 中的 XAML 值，但不是两者兼而有之。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:47:32.767

基本思想：

```
<ListBox Width="200" Height="100" 
      x:Name="myListbox"
      d:ItemsSource="{StaticResource MyDataSource}"   // design-time data
>
   ...
</ListBox> 
```

在 MainForm_Loaded 或构造函数中：

```
 var data = new ObservableCollection<DateTime> { new DateTime(2013,4,17), ... };
 myListbox.ItemsSource = data; 
```

# android - Android类图

> ID：16058519
> 
> 赞同：3
> 
> 时间：2013-04-17T11:13:36.177
> 
> 标签：android, uml, class-diagram

我想问一下如何为`Android`应用程序创建类图。

示例：有`Activity`MyActivity，它有一个 onClick 方法，我在其中调用另一个`Activity`, 或`Service`. 我的问题是，它们之间的关系是什么？

**是协会**吗？ ![协会](https://i.stack.imgur.com/FMjPL.jpg)

或`MyActivity` **使用**它们？ ![利用](https://i.stack.imgur.com/3Nbx5.jpg)

还是另一种关系？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-27T11:16:19.667

关联是 UML 元素之间各种关系的超类型。您可能会使用依赖项（MyService 依赖于 MyAcitivity）。为描述其目的的关系命名始终是一种好习惯。如果您想布置导航路径结构，那么我怀疑类图是您的最佳选择。您是否尝试过使用序列图？

据我所知，Android并没有为Activity声明onClick，所以你好像是自己声明的。如果它是由 Android 提供的，则您不必在模型中再次对关系建模。

# c# - 在特定代码位期间暂时禁用/绕过系统集代理？

> ID：16058521
> 
> 赞同：0
> 
> 时间：2013-04-17T11:13:38.007
> 
> 标签：c#, asp.net, proxy, system.net

我有一个页面，基本上是供客户填写和提交的支持请求表......它位于 ASP.net 中，后面是 C#。我已经设法使用“System.Environment.MachineName;”将计算机名称填充到表单文本框中之一 而且我遇到了这个不工作的重大问题，除非它在某种内部网类型的环境中，它可以进行反向 DNS 查找......这很好，因为该页面通常可以在我们的 AD 森林中访问（s ）。我现在遇到的问题是，除非我在 Internet Explorer 中禁用代理，否则我会不断获取代理名称/地址而不是计算机名称。如果我禁用代理，它会完美运行......

那么有没有办法让这 2 或 3 行代码退出代理但页面的其余部分留在里面？或者如果我必须让整个页面用完代理，因为参考点都是本地的，它应该仍然可以在没有 webproxy 的情况下工作..？

任何帮助都非常感谢！

谢谢，亚当。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T09:44:52.503

最后不需要从代码中绕过代理，只需将站点添加到服务器/客户端代理绕过列表上的代理绕过列表中即可：）也感谢您的帮助！:)

System.Net.Dns.GetHostEntry(Request.ServerVariables["REMOTE_ADDR"]).HostName 是我用来让它工作的:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T19:58:52.403

我不是 100% 的，因为我没有可以测试这段代码的情况，但我相信这就是你想要的

```
System.Net.Dns.GetHostEntry(Request.ServerVariables["remote_addr"]).HostName 
```

# asp.net - System.Web.HttpCompileException (0x80004005)

> ID：16058526
> 
> 赞同：6
> 
> 时间：2013-04-17T11:13:52.873
> 
> 标签：asp.net, iis-7

我的 .net 4 Intranet 应用程序几乎一直都能正常工作。有时，在不做任何更改的情况下，它会开始给出 500 个异常并显示以下消息：

```
System.Web.HttpCompileException (0x80004005): External component has thrown an exception. 
at System.Web.Compilation.AssemblyBuilder.Compile() 
at System.Web.Compilation.BuildProvidersCompiler.PerformBuild() 
at System.Web.Compilation.BuildManager.CompileWebFile(VirtualPath virtualPath) 
at System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) 
at System.Web.Compilation.BuildManager.GetVPathBuildResultWithNoAssert(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) 
at System.Web.Compilation.BuildManager.GetVPathBuildResult(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean ensureIsUpToDate) 
at System.Web.UI.TemplateControl.LoadControl(VirtualPath virtualPath) 
```

唯一的解决方案是停止 inet 服务，删除 C:\Windows\Microsoft.Net..\Temporary 文件，然后一切重新开始工作。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:17:33.807

尝试清理临时 asp.net 文件`C:\Windows\Microsoft.NET\Framework\v4.0.30319\Temporary ASP.NET Files`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-27T21:39:53.093

解决方法是清理 Asp.Net 临时文件或回收 IIS 池。

阅读有关[Microsoft 支持的更多信息](https://support.microsoft.com/en-us/kb/3118750)

# python - 为什么不能为非浮点数定义“round”？

> ID：16058529
> 
> 赞同：2
> 
> 时间：2013-04-17T11:14:02.427
> 
> 标签：python, class, python-2.7, rounding

给定一个简单的类

```
class Vector(object):
    def __init__(self, value):
        self.value = value
    def __abs__(self):
        return math.sqrt(sum([x**2 for x in self.value]))
    def __round__(self, *n):
        return [round(x,*n) for x in self.value] 
```

为什么在抱怨 a而不是 desired时`abs(Vector([-3,4]))`正确 yield ，如何解决？`5``round(Vector([-3.1,4]))``TypeError: a float is required``[-3,4]`

我知道`round`通常应该返回一个浮点数，但是对于本例中的向量，可能的含义可能没有歧义，那么为什么不能简单地覆盖它呢？我真的必须继承`numbers.Real`或定义`Vector(...).round(n)`吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T11:18:41.830

特殊方法仅在 Python 3中`__round__`引入。Python 2 中不支持特殊方法。

您必须使用专用方法而不是函数：

```
class Vector(object):
    def __init__(self, value):
        self.value = value

    def round(self, n):
        return [round(x, n) for x in self.value] 
```

或者您必须提供自己的`round()`功能：

```
import __builtin__

def round(number, digits=0):
    try:
        return number.__round__(digits)
    except AttributeError:
        return __builtin__.round(number, digits) 
```

您甚至可以将其修补到`__builtins__`命名空间中：

```
import __builtin__

_bltin_round = __builtin__.round

def round(number, digits=0):
    try:
        hook = number.__round__
    except AttributeError:
        return _bltin_round(number, digits)
    else:
        # Call hook outside the exception handler so an AttributeError 
        # thrown by its implementation is not masked
        return hook(digits)

__builtin__.round = round 
```

# c++ - 使类抽象的好处是什么

> ID：16058531
> 
> 赞同：5
> 
> 时间：2013-04-17T11:14:06.430
> 
> 标签：c++, abstract-class

我们举个例子，

```
class base{
public:
virtual void abstract() = 0;
};

class derived:public base{
public:
void abstract(){cout << "Abstract\n";}
};

int main{
derived d;
d.abstract();
return 0;
} 
```

它可以写成其他方式，

```
class base{
    public:
    void abstract(){cout << "Abstract\n";}
    };

    int main{
    base b;
    b.abstract();
    return 0;
    } 
```

它也提供相同的结果，实际上我不需要派生类。我确实阅读了很多关于抽象类`it says we can not instantiate base class`的文章，并且`pure virtual function`强迫用户使用`define the function`. 但是，如果我们在这两种情况下都看到上面的代码，我会得到相同的结果（`or output`）。所以在这里我的问题是`abstract`课程如何帮助我们？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T11:18:45.300

正如您所注意到的，在您的示例代码中，有单独的基类和派生类是没有意义的。

*一般来说*，具有虚函数的类的目的是动态多态性，但是您的代码没有使用它。

假设您有一些使用 a 的代码，`base*`但不知道它实际指向*哪个（几个）派生类。*假设他们每个人都有不同的实现`abstract()`。假设您想*强制*编写派生类的任何人`base`实现他们自己的`abstract()`. 然后有理由制作`abstract()`一个纯虚函数，因此有理由`base`成为一个抽象类：

```
#include <iostream>
#include <cstdlib>
#include <ctime>

struct Base {
    virtual void abstract() = 0;
    virtual ~Base() {};
};

struct Derived1 : Base {
    void abstract() { std::cout << "Derived1\n"; }
};

struct Derived2 : Base {
    void abstract() { std::cout << "Derived2\n"; }
};

Base *random_object() {
    if (std::rand() < RAND_MAX/2) {
        return new Derived1();
    } else {
        return new Derived2();
    }
}

int main() {
    std::srand(std::time(0));
    Base *b = random_object();
    b->abstract();
    delete b;
} 
```

中的代码`main`只关心`Base`，它不需要知道任何关于派生类的事情，除了可能有一些。只有其中的代码`random_object`知道派生类。同时`Base`不需要知道如何`abstract()`实现，只有派生类知道（每个只关心自己的实现）。代码不需要了解事物是有好处的——这意味着可以在不触及无关代码的情况下更改这些事物。

使用非抽象类作为公共基类也存在一些高级设计问题。例如，一旦某些函数被覆盖，很容易不假思索地编写无法按预期工作的代码，并且很容易意外地用具体的基类对对象进行切片。所以有一种哲学说你应该始终知道你是在写一个具体的类还是一个基类，而不是试图同时做这两个。当您遵循这一理念时，所有基类都是抽象的，因此您将类抽象化以表明它被设计为派生自。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T11:17:31.197

抽象类用于为某些功能提供接口，其中确切的行为由调用者的类定义。为确保函数的“用户”实现其功能，您在基类中使用抽象函数。这样，如果“用户”没有提供所需的功能之一，则代码不会编译。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T11:23:59.880

这是给你的一个例子：假设你的程序需要计算不同形状的面积。

```
class shape{
public:
    virtual double area() = 0;
};

class triangle:public shape{
public:
    triangle(double base, double height) : b(base), h(height) {}
    double area(){ return 0.5 * b * h; }
private:
    double b;
    double h;
};

class circle:public shape{
public:
    circle(double radius) : r(radius) {}
    double area(){ return M_PI * r * r; }
private:
    double r;
};

int main{
    std::vector<shape*> shapes;

    //add whatever shapes you want here
    shapes.push_back( new triangle(4, 5) );
    shapes.push_back( new circle(3) );

    double dTotal = 0.0;
    std::vector<shape*>::iterator i;
    for (i = shapes.begin(); i != shapes.end(); i++)
    {
        dTotal += (*i)->area();
        delete *i;
    }

    cout << dTotal;
    return 0;
} 
```

您现在可以非常轻松地为矩形、圆形、十二面体等创建形状，并以类似方式对待它们，而无需了解它们如何计算自己的面积的细节。同时，`shape`定义一个自己的区域是没有意义的。

编辑：添加了另一个派生类并使用抽象方法使用它们。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-17T12:11:04.860

Steve Jessop 已经指出了为什么需要抽象类和虚函数。您可以强制使用 vtable 来实现动态调度。

您的抽象基类声明了派生类的共同特征。如果在编译时无法确定对象的类型，则虚函数确保调用正确的函数。

在以下示例中，`class other`在编译时不知道`class shape`提供了哪个派生。唯一知道的是：每个`shape`派生都将为该`center`方法提供一个实现，因为它是*pure* `virtual`。（否则程序不会编译和链接。）这足以提供功能。该程序将`shPtr`在运行时确定 的类型并调用正确的`center()`.

```
#include <string>
#include <iostream>

using namespace std;

class v2d
{
public: 
  double x, y;
  v2d (void) : x(0.0), y(0.0) { }
  v2d (double const a, double const b) : x(a), y(b) { }
};

class shape
{
public:
  string name;
  shape (void) : name() { }
  shape (string const n) : name(n) { }
  virtual v2d center (void) const = 0;
};

class circle : public shape 
{
private:
  v2d center_point;
  double radius;
public:
  circle (void) : shape("Circle"), center_point(), radius(0.0) { }
  circle (v2d const cp, double const r) : shape("Circle"), center_point(cp), radius(r) { }
  v2d center (void) const { return center_point; }
};

class square : public shape
{
private:
  v2d lowright;
  double sidelength;
public:
  square (void) : shape("Square"), lowright(), sidelength(0.0) { }
  square (v2d const tl, double const sl) : shape("Square"), lowright(tl), sidelength(sl) { }
  v2d center (void) const
  {
    double const halflen = sidelength/2.0;
    return v2d(lowright.x+halflen, lowright.y+halflen);
  }
};

class other
{
private:
  shape *shPtr;
public:
  other (void) : shPtr(NULL) { }
  other (shape *sh_ptr) : shPtr(sh_ptr) { }
  void doSomething (void)
  {
    cout << "Center of this Shape, which is a " << shPtr->name << " is: "<< shPtr->center().x << ", " << shPtr->center().y << endl;
  }
};

int main (void) 
{

  v2d sq_c(1.0, 2.0), circ_c(4.0, 4.0);
  square square_obj(sq_c, 5.0);
  circle circle_obj(circ_c, 2.0);

  other other1 (&square_obj), other2(&circle_obj);

  cout << fixed << setprecision(2);

  other1.doSomething();
  other2.doSomething();

  return 0;
} 
```

输出是

```
Center of this Shape, which is a Square is: 3.50, 4.50
Center of this Shape, which is a Circle is: 4.00, 4.00 
```

完全正确（意味着已经调用了正确的中心函数）。

-为清楚起见进行编辑-

SuvP 的动物示例也几乎适用。它的缺点是不需要继承来实现相同的功能。

我稍微调整了一下，试图让纯虚拟的好处变得清晰。首先，用户可以任意添加`Animal`，并且实现`feed_all_animals`独立于当前派生`Animal`的 s。

```
#include <string>
#include <iostream>
#include <vector>

using namespace std;

class Animal
{
public:
  virtual string food() = 0;
  virtual string name() = 0; 
  void eat()  { cout << "A " << name() << " is eating " << food() << endl; }
};

class Dog:public Animal
{
public:
  string name() { return "Dog"; }
  string food() { return "Meat"; }
};

class Horse:public Animal
{
public:
  string name() { return "Horse"; }
  string food() { return "Gras"; }
};

void feed_all_animals (vector<Animal*> animals)
{
  for (size_t i=0; i<animals.size(); ++i)
  {
    cout << "Feeding animal " << i+1 << " (a " << animals[i]->name() << ") with " << animals[i]->food() << endl;
    animals[i]->eat();
  }
}

int main (void)
{
  vector<Animal*> animals;
  // We have a zoo with three dogs and two horses
  Dog dog1, dog2, dog3;
  Horse horse1, horse2;
  animals.push_back((Animal*)&dog1);
  animals.push_back((Animal*)&dog2);
  animals.push_back((Animal*)&dog3);
  animals.push_back((Animal*)&horse1);
  animals.push_back((Animal*)&horse2);
  // now we let the user add another animal
  int ani(0);
  cout << "Do you want to add a Horse [1] or a Dog [0]: ";
  cin >> ani;
  switch (ani)
  {
    case 1: animals.push_back((Animal*)new Horse); break;
    default: animals.push_back((Animal*)new Dog); break;
  }
  // so they don't starve
  feed_all_animals(animals);

  delete animals[animals.size()-1];
  animals.clear();
  return 0;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-17T11:21:52.987

用“抽象”的话来说，抽象类（完全抽象时也称为*接口）从一组**相似*类的实现中抽象出来。在这里，相似意味着它们具有相同的功能集，但可能以不同的方式实现它们。

抽象类本身并没有定义实现。在程序中传递（指针或引用）抽象类只会传递一个“封闭的包”，您可以与之交互（例如摇动）。但是你隐藏了包里面的东西，包括接口是如何实现的（例如当你摇动它时会发生什么）。

也就是说，抽象类只是将抽象提高了一级。类描述对象具有的属性和行为，但抽象类仅描述您可以对对象执行的操作。只有实际的实现才能定义行为。

话虽如此，一个重要的事实是您不能创建抽象类的实例。

在设计一个软件时，抽象类/接口是一种非常重要的抽象方法。每当您的软件的某些部分想要与它不知道的东西进行交互时，您可以编写一个接口来描述此类对象必须提供的功能，而无需指定实际类型。这使得可以轻松地传递不同类型的对象。获取指向此类接口/抽象类的指针/引用的函数可以在不知道其实际类型的情况下与对象交互。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-17T11:20:39.607

an 的目的是为子类`abstract (base-)class`定义一个。`interface`通过这种方式，您可以确定您的类必须具备什么能力（它的方法），但不能确定它是如何做事的（实现）。
当您从一个`abstract`类派生时，您承诺在您的子类中提供某种行为。使用它，函数可以使用您的对象并执行它们的操作，而无需详细了解它们的具体行为。
到处都有类层次结构，比如在`.NET`-framework 中表示概念或 UI 控件之类的东西。
其次，有时拥有一个类的实例是没有意义的。考虑一个类`Animal`。如何`Animal`定义？实例化 a 没有意义`Animal`，而是实例化 a`Dog`或 a `Cat`，派生自`Animal.`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-17T11:26:24.440

在您不希望为类创建对象的情况下，抽象类也很有帮助。

考虑到这一点，

```
/* Abstract Class Animal */
class Animal
{
public:
    virtual void eat() = 0;
    virtual void walk() = 0;
};

class Dog:public Animal
{
public:
    void walk() { std::cout<<"\nWalk with Paws"; }   
    void eat()  { std::cout<<"\nEat meat";       }
};

class Horse:public Animal
{
public:
        void walk() {  std::cout<<"\nWalk with Hooves"; }   
        void eat()  {  std::cout<<"\nEat Grass";        }
};

int main()
{
    Dog d;
    Horse h;

    d.eat();
    d.walk();
    h.eat();
    h.walk();
return 0;
} 
```

在这里，您不希望`Animal`创建类型的对象。`sleep` `eat`该对象对等没有任何特定行为。

您可以利用这个`abstract`类来创建子类，例如`Dog`，`Cat`等 `pure virtual functions`必须由派生类实现，否则编译器会出错。

这保证了您的所有子类都将具有所需的方法，并且您最终不会创建一个`undefined`对象，例如`Animal`

# ruby-on-rails - Rails 修改输入字段，因为我不想

> ID：16058535
> 
> 赞同：1
> 
> 时间：2013-04-17T11:14:15.037
> 
> 标签：ruby-on-rails, serialization

这真的很奇怪，但是当我添加我的模型时：

```
serialize :source, Array 
```

默认情况下，输入字段在您加载页面的任何时候都有“ **[]** ”符号。

当我删除序列化时，它消失了。但是视图本身的代码没有被修改，所以我不知道如何删除这个括号。

真的很烦，请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T12:18:55.057

来自[http://api.rubyonrails.org/classes/ActiveRecord/Base.html#method-c-serialize](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#method-c-serialize)

> Active Record 可以使用 YAML 序列化文本列中的任何对象。为此，您必须通过调用类方法序列化来指定它。这使得在不做任何额外工作的情况下存储数组、散列和其他不可映射的对象成为可能。

```
class User < ActiveRecord::Base
  serialize :preferences
end 
```

我想，你认为你有类似的东西`<%= @my_model.source %>`。

现在如果你`serialize :source, Array`从你的模型中删除，类型`@my_model.source`是字符串，你的视图输出一个空字符串（什么都没有）。

如果添加`serialize :source, Array`到模型中，则类型`@my_model.source`为数组。期间转换为字符串的空数组`<%= @my_model.source %>`正是您所看到的：`[]`。

> 真的很烦，请帮帮我。

为了帮助你，我需要知道你到底想要存档什么。

*   应该`source`是一个字符串，删除`serialize :source, Array`并快乐
*   应该`source`是一个数组，重写您的视图以输出迭代其元素的数组。例如：

    ```
    <%- @my_model.source.each do |v| -%>
        <li><%= v %></li>
    <%- end -%> 
    ```

# java - Java的开源Geoparsing工具？

> ID：16058537
> 
> 赞同：4
> 
> 时间：2013-04-17T11:14:19.423
> 
> 标签：java, geolocation

我需要将 GeoParsing 实现为我项目的一部分。我目前正在通过代码执行此操作，查找可能位置的输入。我读到了一些可用的地理解析工具，例如 Yahoo Placemaker；但是我遇到的那些仅在企业版本中可用。有人知道开源地理解析器吗？或者可能是其他更快的替代方法来查找文本中的位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-02T14:01:13.760

我想我回答有点晚了。但我认为 CLAVIN ( [https://github.com/Berico-Technologies/CLAVIN](https://github.com/Berico-Technologies/CLAVIN) ) 将是您正在寻找的 (您可以使用 Java API) 并且它是开源的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-01-27T16:29:58.607

雅虎 placemaker 不再免费...

问题是，您是否会一起进行地理解析（识别哪个词是位置词）或地理解析和地理编码（它在地图上的哪个位置）。

如果仅进行地理分析，CLAVIN 是一个可以使用的下降软件。但是，与 Yahoo! 相比，地理编码并不是很好。占位符。

我认为解决您的问题的更好方法是分叉这个项目 [https://github.com/weizh/geolocator-3.0](https://github.com/weizh/geolocator-3.0)

本文解释了软件原理 [http://www.cs.cmu.edu/~gelern/pdfs/geocoding.pdf](http://www.cs.cmu.edu/~gelern/pdfs/geocoding.pdf)

性能可与雅虎媲美！placemaker，在地理编码上比 CLAVIN 更好。

# android - 从布局中删除视图时保持线条

> ID：16058538
> 
> 赞同：0
> 
> 时间：2013-04-17T11:14:22.753
> 
> 标签：android, view

我有这个视图可以通过跟随用户的手指来绘制。当我希望他可以绘制时，我使用 addView 将其添加到我的 Activity 的布局中，当我希望他无法绘制时，我使用 removeView 将其删除。我的问题是我希望他绘制的线条出现但它们消失了！你知道我能做些什么来改变这个吗？

```
public class MyView extends View{
    private static final float MINP = 0.25f;
    private static final float MAXP = 0.75f;

    public MyView(Context c) {
        super(c);

        mPath = new Path();
        mBitmapPaint = new Paint(Paint.DITHER_FLAG); 
        mPaint = new Paint();
        mPaint.setAntiAlias(true);
        mPaint.setDither(true);
        mPaint.setColor(Color.BLACK);
        mPaint.setStyle(Paint.Style.STROKE);
        mPaint.setStrokeJoin(Paint.Join.ROUND);
        mPaint.setStrokeCap(Paint.Cap.ROUND);
        mPaint.setStrokeWidth(3);

    }

    @Override
   protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        super.onSizeChanged(w, h, oldw, oldh);
        mBitmap = Bitmap.createBitmap(w, h, Bitmap.Config.ARGB_8888);
        mCanvas = new Canvas(mBitmap);

    }

    @Override
    protected void onDraw(Canvas canvas) {
        canvas.drawBitmap(mBitmap, 0, 0, mBitmapPaint);
        canvas.drawPath(mPath, mPaint);
        invalidate();

    }

    private float mX, mY;
    private static final float TOUCH_TOLERANCE = 4;

    private void touch_start(float x, float y) {
        mPath.reset();
        mPath.moveTo(x, y);
        mX = x;
        mY = y;
    }
    private void touch_move(float x, float y) {
        float dx = Math.abs(x - mX);
        float dy = Math.abs(y - mY);
        if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {
            mPath.quadTo(mX, mY, (x + mX)/2, (y + mY)/2);
            mX = x;
            mY = y;
        }
    }
    private void touch_up() {
        mCanvas.drawPath(mPath, mPaint);
    }

    @Override
    public boolean onTouchEvent(MotionEvent event) {
        float x = event.getX();
        float y = event.getY();

        switch (event.getAction()) {
            case MotionEvent.ACTION_DOWN:
                touch_start(x, y);
                invalidate();

                break;
            case MotionEvent.ACTION_MOVE:
                touch_move(x, y);
                invalidate();

                break;
            case MotionEvent.ACTION_UP:
                touch_up();
                invalidate();

                break;
        }
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:18:49.383

我不知道这是不是真的，但你可以这样做： 1\. 用绘图截取你的布局。2.从您的布局中删除图纸视图。3.使用刚刚截取的屏幕截图设置布局的背景。

希望你理解..希望它有效..

# c# - MVC DropDownListFor Null 值

> ID：16058539
> 
> 赞同：11
> 
> 时间：2013-04-17T11:14:23.813
> 
> 标签：c#, asp.net-mvc, razor

我在 MVC 中使用 htmlhelper 的下拉列表时遇到问题。当回发发生时，没有选择任何内容，并且列表模型中的值和所选项目为空。

这是我的模型：

```
namespace MvcTestWebApp.Models
{
    public class Customer
    {
        public string name { get; set; }

        public List<SelectListItem> members { get; set; }

        public Member selected { get; set; }
    }

    public class Member
    {
        public string name { get; set; }

    }
} 
```

控制器：

```
namespace MvcTestWebApp.Models
{
    public class CustomerController : Controller
    {
        //
        // GET: /Customer/
        public ActionResult Index()
        {
            Customer cust = new Customer() { name = "Cust1" };
            cust.members = new List<SelectListItem>();

            cust.members.Add(new SelectListItem(){Text = "Bob"} );
            cust.members.Add(new SelectListItem(){Text = "Dave"} );

            return View(cust);
        }

        [HttpPost]
        public ActionResult Index(Customer customer)
        {

           return View();
        }

    }
} 
```

并查看：

```
 @model MvcTestWebApp.Models.Customer

@{
    ViewBag.Title = "Customer";
    Layout = null;
}

<!DOCTYPE html>

<html>

<head>
    <meta name="viewport" content="width=device-width" />
    <title> Index </title>
</head>

    <body>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Customer Data</legend>

          @Html.HiddenFor(model => model.name)

          @Html.DropDownListFor(model => model.selected, Model.members, "--Select--")

        <p>
            <input type="submit" value="Save" />
        </p>

        </fieldset> 
}

    </body>

</html> 
```

当我从选择列表中选择某些内容并单击提交按钮时，将返回空值：

![空选择](https://i.stack.imgur.com/HUd1c.png)

谁能阐明我做错了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-17T11:51:10.927

您遇到的问题是 MVC 不知道如何将下拉列表的选定值（它是一个字符串）转换为对象成员。

你应该做的是有一个 selectedValue 属性，用于设置下拉列表中的值并检索返回的值。

新客户类别：

```
public class Customer
{
  public string name { get; set; }

  public List<SelectListItem> members { get; set; }

  public string selectedValue { get; set; }

  public Member selected { get; set; }
} 
```

更新下拉列表控件：

```
@Html.DropDownListFor(model => model.selectedValue, Model.members, "--Select--") 
```

这会将下拉列表中的选定值返回到属性 selectedValue 中。

您的成员列表返回 null 的原因是因为 HTML 不返回下拉列表中的选项，它只返回选定的值。因此，当信息进入方法时，只给出输入表单的值。

如果您想查看哪些信息被发送回服务器，您可以使用开发者控制台并捕获返回的 Http 请求

和/或

您可以添加`FormCollection collection`到控制器操作的参数中，以查看 MVC 使用什么信息来构建它传递给方法的对象。

```
[HttpPost]
public ActionResult Index(Customer customer, FormCollection collection)
{

  return View();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:32:24.460

```
cust.members.Add(new SelectListItem(){Text = "Bob"} );
cust.members.Add(new SelectListItem(){Text = "Dave"} ); 
```

尝试设置值：

```
cust.members.Add(new SelectListItem(){Value = "Bob", Text = "Bob"} );
cust.members.Add(new SelectListItem(){Value = "Dave", Text = "Dave"} ); 
```

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2015-07-03T07:56:56.320

使用 jQuery prepend 轻松解决问题。

```
$("#idOfSelectTag").prepend('
                              <option selected="selected" value="null">
                                -- Select School --
                              </option>
                            '); 
```

# apache - Apache到底是什么？

> ID：16058546
> 
> 赞同：-4
> 
> 时间：2013-04-17T11:14:46.083
> 
> 标签：apache

经过一番谷歌搜索后，似乎 Apache 是一个 Web 服务器，但我偶然发现了看起来与 javadocs 几乎相同的 apache 文档。现在我很困惑。我读到的所有内容都说它是一个 Web 服务器，但它有像编程语言一样的文档。

它是一种语言还是网络服务器？

编辑：我误解了 Apache 是什么。我所指的文档是

[http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math3/fraction/BigFraction.html](http://commons.apache.org/proper/commons-math/apidocs/org/apache/commons/math3/fraction/BigFraction.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:23:54.090

Apache 软件基金会开发了几个 Apache 软件项目。Apache HTTP Server 就是这些项目之一，还有几个带有 JavaDocs 的 Java 库。

我猜你得到了错误的 Apache 项目的文档。您可以查看[Apache HTTP Server 的文档](http://httpd.apache.org/docs/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:21:46.597

[Apache](http://www.apache.org/)不是一个网络服务器，它是一群构建伟大软件的人。

您正在查看[Apache Commons](http://commons.apache.org/)，它是 Java 库的集合。您在评论中链接到的库是[Commons Math: The Apache Commons Mathematics Library](http://commons.apache.org/proper/commons-math/)。所以，是的，Java 文档看起来像 Java 文档。

您将需要查看[Apache HTTP Server](http://httpd.apache.org/)。

# jsp - Struts 2中Action类的jsp中填写的表格行的值如何获取？

> ID：16058547
> 
> 赞同：4
> 
> 时间：2013-04-17T11:14:46.707
> 
> 标签：jsp, struts2, struts, struts-1, struts2-jquery

我有以下jsp，其中我可以选择添加和删除表的行，并且在表的每一行中，我必须填写选项并提交表单。

在动作类中，我如何检索我在 JSP 中填写的行的值，因为我在表中填写了不止一行？

这是我的 JSP：

```
<table id="fragmentTable" style="height: 100%; width: 100%">

    <tr class="tableRow" style='height: 5%;'>
      <td class='' style='position: absolute; left: 75%;'>
    <button value="Add Row" type="button" onclick="return addRow1();">Add Row</button>
    <button value="Delete Row" type="button" onclick="return deleteRow          ('dataTable')">Delete Row</button>
      </td>
    </tr>

     <tr>
    <td colspan="2"><br><br>
    <table id="dataTable" border="1" width=100% height=30% class='blueBorder'>
    <thead>
    <tr class='rowHeader'>
          <th width='14%'>Select</th>
          <th width='14%'>Opening Brace</th>
          <th width='14%'>Parameter</th>
          <th width='14%'>Relational Operator</th>
          <th width='14%'>Value</th>
          <th width='15%'>Closing Brace</th>
          <th width='15%'>Logical Operator</th>
    </tr>
    </thead>

    <tbody>

        <tr class='rowData' id=1>
<td>
<s:checkbox theme="simple" id="sel" name="GRF_FRAGID" value="false" /></td>
<td ><s:select headerKey="-1" headerValue="Select" list="#{'1':'(', '2':'((','3':'(((','4':'((((','5':'((((('}" name="GRF_OPNGBRCES" /></td>
<td>
<s:select label="Mode" headerKey="-1" headerValue="Select" list="#{'1':'=', '2':'!='}"
    name="GRF_OP" />
</td>
<td>
<s:textfield name="Country"/>
</td>

</tr>
</tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T12:00:17.073

我不完全理解您的页面，但您需要使用迭代器（如 @NidhishKrishnan 建议的那样）并通过其 IteratorStatus 对象指向索引：

```
<s:iterator value="yourlist" status="ctr" >
  <tr>
    <td><s:textfield name="yourlist[%{#ctr.index}].country"/></td>
  </tr>
 </s:iterator> 
```

`country`应该用第一个字母小写。

如果您需要使用 javascript 生成新行，则必须生成`<s:textfield/>`标签“输出”的相同 HTML（单击`View Source`浏览器，了解它是如何生成的）。

这将在目标操作（必须`List`与 a相同`setter`）上创建一个包含页面中所有值的新列表。

无需单独对一行进行操作，您可以使用此更新（例如）一篇文章中的 10 行。

* * *

**编辑**

回答您的评论，如果您没有任何初始值，则不涉及迭代：您可以使用与添加新行相同的语法将第一行定义为列表的第一个元素。

不需要从 List*开始*，唯一的要求是发布要在*目标*List 中设置的列表格式的 HTML 元素。

以**[本文](http://www.programmingforfuture.com/2011/02/how-to-handle-values-from-dynamically.html)**为例，了解您需要创建哪些 javascript 和 HTML。

# doxygen - 如何在 doxygen 中引用成员组

> ID：16058548
> 
> 赞同：8
> 
> 时间：2013-04-17T11:14:49.003
> 
> 标签：doxygen, documentation-generation

我找到了如何为一组班级成员命名：

```
/**\{
\name Foo
*/
 members
/**
\}*/ 
```

，但是我如何从其他班级成员那里引用 Foo 呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T11:36:26.797

```
/** \{
\anchor Foo
\name   Foo
*/
members
/** \} */ 
```

锚点允许您使用从其他地方引用组

```
/// \ref Foo 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-04-21T13:26:43.620

不确定命名组是否与定义组相同，`\defgroup id name`但使用后者您可以`\ref`使用 id 并将链接到组的文档。

# java - 使用 Java 和 Javascript 从另存为窗口下载文件

> ID：16058553
> 
> 赞同：0
> 
> 时间：2013-04-17T11:14:57.863
> 
> 标签：java, javascript

我正在我的应用程序中生成一个报告并将其保存在我的 PC 中的某个位置。现在，当用户单击下载按钮时，应打开另存为窗口，并且文件应以指定名称写入指定位置。我可以将文件写入另一个文件，但无法获取另存为窗口。

如何使用 Java 和 Javascript 从另存为窗口下载文件？

对不起！文件类型可以是 HTML 或 PDF 或 CSV。文件的内容是包含少量值和结果的表格。

它是一个桌面应用程序。现在我将文件保存到我的硬编码位置。保存后，如果用户单击下载按钮，应打开另存为窗口，以便用户可以将五个保存到他指定的位置。我正在使用 Java，Spring，休眠和 JavaScript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:20:25.637

利用`JFilechooser`

```
String wd = System.getProperty("user.dir");
JFileChooser fc = new JFileChooser(wd);
int rc = fc.showDialog(null, "Select Data File");
if (rc == JFileChooser.APPROVE_OPTION)
{
File file = fc.getSelectedFile();
filename = file.getAbsolutePath();
// call your function here
}
else
System.out.println("File chooser cancel button clicked");
return; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:17:45.923

请确保您的下载网址发送正确的内容类型。

这是我创建的一个小助手方法：

```
protected void SetContentType(ContentType type)
        {
            switch (type)
            {
                case ContentType.HTML:
                    {
                        _context.Response.ContentType = "text/html";
                        break;
                    }
                case ContentType.JSON:
                    {
                        _context.Response.ContentType = "application/json";
                        break;
                    }
                case ContentType.Text:
                    {
                        _context.Response.ContentType = "text/plain";
                        break;
                    }
                case ContentType.PDF:
                    {
                        _context.Response.ContentType = "application/pdf";
                        break;
                    }
                case ContentType.OctetStream:
                    {
                        _context.Response.ContentType = "application/octet-stream";
                        break;
                    }
                case ContentType.Excel:
                    {
                        _context.Response.ContentType = "application/vnd.ms-excel";
                        break;
                    }
                default:
                    {
                        _context.Response.ContentType = "application/json";
                        break;
                    }
            }
        } 
```

如果您希望文件始终下载，请使用 application/octet-stream 选项

# dart - 创建具有多个订阅者的流

> ID：16058558
> 
> 赞同：4
> 
> 时间：2013-04-17T11:15:05.753
> 
> 标签：dart

创建和使用具有多个订阅者的流的最佳方式是什么？

它曾经是：

```
new StreamController.broadcast() 
```

但是那个构造函数在 M4 中消失了。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T11:34:41.367

根据此链接：

[https://groups.google.com/a/dartlang.org/d/msg/misc/KJrKH5-bNkU/CjpIpEP_EpgJ](https://groups.google.com/a/dartlang.org/d/msg/misc/KJrKH5-bNkU/CjpIpEP_EpgJ)

> 使用 r21499，我们删除了 StreamController.broadcast 构造函数。
> 
> StreamController.broadcast 流具有令人讨厌的属性，很容易导致错过事件和类似的难以调试的情况。我们最初为 html-library 添加了这个类，但最终在那里不需要它。通过删除这个类，我们可以为 Streams 提供更清晰的合约。
> 
> 我们仍然保留 asBroadcastStream 方法。它的行为与 StreamController.broadcast 的行为稍有不同和更清醒。`asBroadcastStream`在大多数情况下，如果您需要附加多个侦听器，您可以尝试迁移到。

因此，创建一个新流并调用`asBroadcastStream()`它。

（但您可能还想关注这个问题：[asBroadcastStream 不能被多次调用](https://stackoverflow.com/questions/16057001/asbroadcaststream-cant-be-called-multiple-times)）

# javascript - Reveal.js 多路复用不起作用

> ID：16058563
> 
> 赞同：6
> 
> 时间：2013-04-17T11:15:27.393
> 
> 标签：javascript, node.js, socket.io, reveal.js

我按照以下链接中的示例进行操作：[https://github.com/hakimel/reveal.js#multiplexing](https://github.com/hakimel/reveal.js#multiplexing)，但不知何故，多路复用不起作用 - 主幻灯片更新时客户端不会更新。我已经尝试过使用reveal.js 演示socket.io 服务器，并尝试托管我自己的。

这些选项都不起作用，我很确定我已经正确配置了它们。这是我的两个配置代码：

## 主/index.html

```
 Reveal.initialize({
    controls: true,
    progress: true,
    history: true,
    center: true,

    multiplex: {
      id: 'e2bc6e79f19fbe63',
      secret: '13661966883862075064',
      url: 'revealjs.jit.su:80'
    },

    dependencies: [
      { src: '//cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.10/socket.io.min.js', async: true },
      { src: 'plugin/multiplex/client.js', async: true },
      { src: 'plugin/multiplex/master.js', async: true },
    ]
    // { src: 'plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
    // { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
  }); 
```

## 客户端/index.html

```
 Reveal.initialize({
            controls: true,
            progress: true,
            history: true,
            center: true,

    multiplex: {
      id: 'e2bc6e79f19fbe63',
      secret: null,
      url: 'revealjs.jit.su:80'
    },

    dependencies: [
      { src: '//cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.10/socket.io.min.js', async: true },
      { src: 'plugin/multiplex/client.js', async: true },
      { src: 'plugin/multiplex/master.js', async: true },
    ]
    // { src: 'plugin/search/search.js', async: true, condition: function() { return !!document.body.classList; } }
  }); 
```

显然，我去[http://revealjs.jit.su/token](http://revealjs.jit.su/token)获取了一个令牌和秘密，而客户端秘密为空，因此他们无法自己控制演示。但是，当我转到母版中的另一张幻灯片时，尽管已配置为客户端，但客户端根本不跟随。主服务器和客户端都在 XAMPP 下本地托管（我也尝试使用节点静态托管主服务器，但结果相同）。

有没有人知道如何解决这个问题？任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T13:00:06.320

您必须设置一些额外的依赖项（以使套接字请求真正起作用）

```
{ src: 'http://revealjs.jit.su/socket.io/socket.io.js', async: true }, 
{ src: 'plugin/multiplex/client.js', async: true },
{ src: 'plugin/multiplex/master.js', async: true } 
```

确保您的插件文件夹确实包含多路复用文件！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-24T09:35:36.080

[http://revealjs.jit.su/](http://revealjs.jit.su/)不再工作了。最好先为您使用 localhost 为您的 socket.io 服务器您还可以向您显示控制台日志

# android - EditText 验证不起作用

> ID：16058566
> 
> 赞同：0
> 
> 时间：2013-04-17T11:15:38.087
> 
> 标签：android, regex

我在使用来自 EditText 的验证输入时遇到问题。每当我单击 SaveData 按钮时，无论它是否有效，都会弹出对话框。这是我写的示例：

验证类：

```
package android.week04Lab03;

import java.util.regex.Matcher;
import java.util.regex.Pattern;
import android.webkit.URLUtil;
import android.widget.EditText;

public class Validation {

public boolean isEmpty(EditText txt){

    if(txt.getText().toString().equals("")){            
        return false;
    } else
        return true;

}

public boolean isURL (EditText txt){
    if (!URLUtil.isValidUrl(txt.getText().toString())){
        return false;
    } 
    return true;
}

public boolean isEmail (EditText txt){
    String isEmail = "^([^@\\s]+)@((?:[-a-z0-9]+\\.)+[a-z]{2,})$";
    Pattern isEmailPattern = Pattern.compile(isEmail);
    Matcher mailMatcher = isEmailPattern.matcher(txt.getText().toString());
    if (!mailMatcher.find()) {
        return false;
    }
    return true;
}

} 
```

这是活动课

```
public class MetaData extends Activity {
Validation validator;
ImageView angel;
EditText name, loc, keyword, date, mail;
ToggleButton share;
RatingBar rating;
Button save;

@Override
protected void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_meta_data);        
    name = (EditText) findViewById(R.id.name);
    ..........................

public void saveData(View v) {
    Validation validator = new Validation();

    if (!validator.isEmpty(name)) {

        AlertDialog.Builder alert = new AlertDialog.Builder(this);
        alert.setTitle("Input Validation Warning");
        alert.setIcon(R.drawable.ic_launcher);
        alert.setMessage("Error found, please enter your information correctly!");
        alert.setPositiveButton("OK",
                new DialogInterface.OnClickListener() {

                    @Override
                    public void onClick(DialogInterface dialog, int which) {
                        return;

                    }
                });
        alert.show();
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:23:35.850

这不是检查字符串是否为空的方法。因为如果您的 Edittext 中有一个或多个空格，它将失败。

所以像这样检查长度

```
 if(txt.getText().toString().trim().length() == 0){         
        return false;
    } else
        return true; 
```

您还应该将字符串与`equals`方法进行比较。

当您在 "" 之间给出比较时， == 也将被视为相等。所以在这种情况下没有问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T11:23:42.723

只需使用 equals() 而不是 == 来检查字符串是否为空

`txt.getText().toString().equals("")`代替`txt.getText().toString() == ""`

**==**比较两个对象而不是它的值

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T11:31:08.173

代替使用`if(txt.getText().toString() == "")`来比较字符串，您可以尝试使用`if(txt.getText().toString().equals(""))`吗？

* * *

除了你的问题，我发现你的逻辑可能有点混乱：

首先，你做了这个字符串比较

```
public boolean isEmpty(EditText txt){

    if(txt.getText().toString() == ""){         
        return false;
    } else
        return true;

} 
```

如果 EditText 中的字符串为空，则您尝试执行的操作是`return false`您的方法，否则。`isEmpty``return true`

然后，您`if (!validator.isEmpty(name))`在`saveDate()`方法中执行了此操作，这意味着，根据您的代码：

```
if (validator.isEmpty(name) == false) // isEmpty returned false, means getText got an empty String 
```

如果 EditText 为空，`isEmpty`为什么不做呢？`return true`这将使您以后更容易理解代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T13:53:27.017

```
 EditText e1;
e1=(EditText)findViewById(R.id.et1); 
int et1=e1.getText().toString().trim().length();

        public boolean isEmpty(EditText txt){

           if(et1>0)
        {            
                return false;
            } else
                return true;

        }
    try This..May Be Its Helpfull For You. 
```

# jquery - jQuery - 检查元素是否具有数组中的所有类

> ID：16058569
> 
> 赞同：2
> 
> 时间：2013-04-17T11:15:59.070
> 
> 标签：jquery, jquery-selectors

我有一个动态构建的类数组：

```
var classes = new Array();
classes.push('class1');
classes.push('class2');
classes.push('class5'); 
```

并想用 jquery 选择具有所有这些类（但不仅是那些类）的任何元素，例如：

```
<a class="class1 class2 class5 class10 class18">my element</a> 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T11:17:18.657

你可以得到你的元素

```
$('.'+classes.join('.')) 
```

在您的情况下，生成的选择器将是`".class1.class2.class5"`.

`classes`请注意，这假设您的数组中至少有一个元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:21:58.157

你可以试试这个颜色是你的类名数组这里是一段代码

```
 for ( var i = 0; i < color .length; i++ )
    {
      if ( $(this).hasClass( color[i] ) )
      {       
        break;  
      }
    } 
```

也看看这个[http://api.jquery.com/jQuery.inArray/](http://api.jquery.com/jQuery.inArray/)

# django - 比较 django TestCase 中的查询集

> ID：16058571
> 
> 赞同：27
> 
> 时间：2013-04-17T11:16:01.847
> 
> 标签：django, compare, testcase, django-queryset

我有一个非常简单的看法如下

```
def simple_view(request):
    documents = request.user.document_set.all()
    return render(request, 'simple.html', {'documents': documents}) 
```

为了在我的测试用例中测试上述视图，我有以下方法出错。

```
Class SomeTestCase(TestCase):
    # ...
    def test_simple_view(self):
        # ... some other checks
        docset = self.resonse.context['documents']
        self.assertTrue(self.user.document_set.all() == docset) # This line raises an error
    # ... 
```

我得到的错误是`AssertionError: False is not true`。我已经尝试打印两个查询集，并且两者都完全相同。为什么`False`当两个对象相同时它会返回？有任何想法吗 ？

目前为了克服这个问题，我正在使用一种令人讨厌的检查长度的方法，如下所示：

```
ds1, ds2 = self.response.context['documents'], self.user.document_set.all()
self.assertTrue(len([x for x in ds1 if x in ds2]) == len(ds1) == len(ds2)) # Makes sure each entry in ds1 exists in ds2 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-04-17T11:45:13.247

如果查询集对象是不同查询的结果，即使它们在结果中具有相同的值（比较`ds1.query`和`ds2.query`），它们也将不相同。

如果您首先将查询集转换为列表，您应该能够进行正常比较（当然假设它们具有相同的排序顺序）：

```
self.assertEqual(list(ds1), list(ds2)) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-17T13:31:24.190

这种替代方法不需要排序：

```
self.assertQuerysetEqual(qs1, list(qs2), ordered=False) 
```

请参阅[断言参考](https://docs.djangoproject.com/en/1.5/topics/testing/overview/#django.test.TestCase.assertQuerysetEqual)。

注意：仅适用于 django 1.4+。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-07-01T14:32:12.837

您可以使用[assertQuerysetEqual](https://docs.djangoproject.com/en/2.2/topics/testing/tools/#django.test.TransactionTestCase.assertQuerysetEqual)方法比较两个查询集，而无需转换为列表。`True`如果查询集的值相等，这将返回，无论查询是否不同。

一个问题是，此方法`repr`在比较之前将函数作为转换应用于第一个参数中的每个对象，这在比较两个实际相等的查询集时可能导致以下错误：

```
AssertionError: Lists differ: ['<Object: id1'] != [<Object: id1>] 
```

解决方案是传递您自己的`transform`函数来使用，而不是`repr`：

```
self.assertQuerysetEqual(qs1, qs2, transform=lambda x: x) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-10-04T10:26:46.967

For me works the `transform` option:

```
 def subject(self):
        return Mission.objects.add_keynest_api_token().filter(keynest_api_token__isnull=False)

    def test_mission_has_property(self):
        self.mission.appartement = self.property
        self.mission.save()
        self.assertQuerysetEqual(self.subject(), [self.mission], transform=lambda x: x) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-04-17T11:46:37.843

找到了解决方案。我们需要先转换`Querysets`为排序列表，然后才能比较它们。东西如下。

```
Class SomeTestCase(TestCase):
    # ...
    def test_simple_view(self):
        # ... some other checks
        docset1 = self.resonse.context['documents']
        docset2 = self.user.document_set.all()
        self.assertTrue(list(sorted(docset1)) == len(sorted(docset)))
    # ... 
```

# c++ - 第二次调用 VS2010 时未初始化局部变量

> ID：16058574
> 
> 赞同：0
> 
> 时间：2013-04-17T11:16:16.547
> 
> 标签：c++, visual-studio-2010, visual-c++

我对下面 VS2010 上的代码有一个非常烦人的问题：

```
template <class N>
size_t NumericIndex<N>::GetPageIndex(const PageRef& page, Id id) const
{
  size_t size=page->entries.size();

  if (size>0) {
    size_t left=0;
    size_t right=size-1;
    size_t mid;

    while (left<=right) {
      mid=(left+right)/2;
      if (page->entries[mid].startId<=id &&
          (mid+1>=size || page->entries[mid+1].startId>id)) {
        return mid;
      }
      else if (page->entries[mid].startId<id) {
        left=mid+1;
      }
      else {
        right=mid-1;
      }
    }
  }

  return size;
} 
```

它通过以下方法调用：

```
template <class N>
bool NumericIndex<N>::GetOffset(const N& id,
                                FileOffset& offset) const
{
  size_t r=GetPageIndex(root,id);
  ...
} 
```

问题是，在第一次调用该方法时，一切都很好，`size`并且`left`初始化`right`良好，但在第二次调用时，它直接跳转到该行`while (left<=right) {`，跳过该行之前的每个指令，并`right`用垃圾初始化。

你知道问题可能出在哪里吗？

提前致谢。

该代码是项目[libosmscout](http://sourceforge.net/projects/libosmscout/)的一部分。

[编辑]

Arne Mertz 解决了这个问题。实际上这是循环的第二遍。由于 size_t 是无符号类型，所以当 mid == 0 和 right=mid-1 时我们会溢出。

修复代码应该是：

```
template <class N>
size_t NumericIndex<N>::GetPageIndex(const PageRef& page, Id id) const
{
  size_t size=page->entries.size();

  if (size>0) {
    size_t left=0;
    size_t right=size-1;
    size_t mid;

    while (left<=right) {
      mid=(left+right)/2;
      if (page->entries[mid].startId<=id &&
          (mid+1>=size || page->entries[mid+1].startId>id)) {
        return mid;
      }
      else if (page->entries[mid].startId<id) {
        left=mid+1;
      }
      else {
        if (mid == 0) {
          return size;
        }
        right=mid-1;
      }
    }
  }

  return size;
} 
```

# mongodb - 同一记录中 MongoDB 中的更新是否会使数据库增长？

> ID：16058575
> 
> 赞同：1
> 
> 时间：2013-04-17T11:16:17.303
> 
> 标签：mongodb

我在我的网络服务器（播放器 ID 增量器）中多次更新同一记录，所以我的问题是这种重复更新最终是否会使 MongoDB 数据库变得更大（例如，由于事务日志），或者如果数据库的大小几乎保持不变。

如果数据库实际上因此而变大，我该如何防止这种情况？

谢谢！

编辑：

有关此情况的更多详细信息：

更新声明如下：

```
db.usergen.update({ userprefix: userPrefix }, { $set: { number: userIdNumber } },
    { upsert: true }, function(err, saved) {}); 
```

此更新始终适用于同一记录。这条记录中唯一改变的是“数字”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T11:30:00.513

MongoDB 最多有一个 oplog 和 journal。oplog 是一个固定大小的封顶集合，因此它永远不会失去控制，并且日志具有一定的空间量（通常为 3GB）。

如果文档由于增长而需要在磁盘上移动，那么是的，数据库的大小可能会增长，从而导致您的已删除列表和空闲列表中出现碎片。

这个演示文稿很好地解释了这个概念：[http ://www.10gen.com/presentations/storage-engine-internals](http://www.10gen.com/presentations/storage-engine-internals)

至于避免这种情况，这完全取决于您正在执行的查询以及您正在提交的更新。没有单一的方法可以解决问题，并且在不了解您的问题的情况下，我只能将您引导到各个地方。

一个考虑因素是，如果您要进行需要移动文档的连续、定期更新，则使用 2 大小分配的幂：http: [//docs.mongodb.org/manual/reference/command/collMod/#usePowerOf2Sizes](http://docs.mongodb.org/manual/reference/command/collMod/#usePowerOf2Sizes)

但是，大多数情况下是调整架构和查询以提高性能，即不会在子文档等中创建太多冗余。

您还可以在另一个地方看到`mongod`日志中的问题。如果您创建了过多的涉及`mongod`服务器的查询日志记录，那么您可能会看到您的日志用尽了所有空间，但是，您可以通过限制写入多少日志或[http://docs.mongodb.org/来解决这个问题手册/教程/旋转日志文件/](http://docs.mongodb.org/manual/tutorial/rotate-log-files/)

# liferay - 在 Liferay 的文档库中迭代图像

> ID：16058581
> 
> 赞同：1
> 
> 时间：2013-04-17T11:16:36.653
> 
> 标签：liferay, liferay-6, document-library

我想显示存在于 liferay 文档库中的图像。
我应该如何迭代以获取所有图像并显示它们？

我现在拥有的代码是：

```
<portlet:renderURL  var="viewImageDataURL"/>

<liferay-ui:search-container delta="20" emptyResultsMessage="No Results Found">
    <liferay-ui:search-container-results
            total="<%= employeeImages.size() %>"
            results="<%= ListUtil.subList(employeeImages, searchContainer.getStart(), searchContainer.getEnd()) %>" />
    <liferay-ui:search-container-row modelVar="search"
            className="com.liferay.portlet.documentlibrary.service.DLFileEntryLocalServiceUtil">

        <liferay-ui:search-container-column-text
                name="ImageName"
                value = '<img  src="<%=search.getDLFileEntry(1)%>"/>'>
        </liferay-ui:search-container-column-text>
    </liferay-ui:search-container-row>

    <liferay-ui:search-iterator searchContainer="<%=searchContainer %>" paginate="<%=true%>" />

</liferay-ui:search-container> 
```

我应该如何迭代？从文档库显示图像的功能是`getDLFileEntry(fileId)`，我想显示所有值。

**编辑代码：**

我使用的代码是：

```
<portlet:renderURL  var="viewImageDataURL"/>

<liferay-ui:search-container delta="20" emptyResultsMessage="No Results Found">
    <liferay-ui:search-container-results
        total="<%=DLFileEntryLocalServiceUtil.getDLFileEntriesCount() %>"
        results="<%=DLFileEntryLocalServiceUtil.getFileEntries(searchContainer.getStart(), searchContainer.getEnd())%>" />

    <liferay-ui:search-container-row
            modelVar="search"
            className="com.liferay.portlet.documentlibrary.model.impl.DLFileEntry">
        <liferay-ui:search-container-column-text
                name="ImageName"
                value = '<img src="<%=search.getDLFileEntries(searchContainer.getStart(), searchContainer.getEnd())%>"/>'>
        </liferay-ui:search-container-column-text>
    </liferay-ui:search-container-row>

    <liferay-ui:search-iterator searchContainer="<%=searchContainer %>" paginate="<%=true%>" />

</liferay-ui:search-container> 
```

错误显示在下面的行中：

错误描述是：

> com.liferay.portlet.documentlibrary.model.impl.DLFileEntry 无法解析为类型

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T12:01:49.967

您提供的属性值 className 似乎不正确。

在您的情况下，我相信结果值将是 DLFileEntry 类型的列表。

在这里，您可以将 className 指定为要在搜索容器中迭代的模型名称 [com.liferay.portlet.documentlibrary.model.impl.DLFileEntry]。keyProperty 作为模型的一些主键名称，

```
<liferay-ui:search-container-row className="com.liferay.portlet.documentlibrary.model.impl.DLFileEntry" keyProperty="fileEntryId" modelVar="searchRow"> 
```

现在，searchRow 可以被视为迭代的对象。

您可以调用模型 DLFileEntry 的任何 getter 方法来使用它进行显示。

==================================================== ============================== `<liferay-ui:search-container searchContainer="${searchContainerObj}"> <liferay-ui:search-container-results results="<%=LIST OF OBJECT OF DLFileEntry%>"/> <liferay-ui:search-container-row className="com.liferay.portlet.documentlibrary.model.impl.DLFileEntry" keyProperty="fileEntryId" modelVar="fileEntry"> <img src="<%= DLUtil.getThumbnailSrc(fileEntry, fileEntry.getFileVersion(), null, themeDisplay) %>" /> </liferay-ui:search-container-row>
</liferay-ui:search-container>`

让我解释一下上述代码的术语。liferay-ui:search-container-results 标签将有对象列表，您想在搜索容器中显示。liferay-ui:search-container-row 标签将定义modelVar fileEntry，它将是List对象类型的迭代对象。在 liferay-ui:search-container-row 的主体中，modelVar fileEntry 将可用。 **如果结果列表的大小为 3，则将显示 3 个缩略图。**

# iphone - UITextInput dictationRecordingDidEnd 被调用，但 insertDictationResultPlaceholder 没有

> ID：16058582
> 
> 赞同：2
> 
> 时间：2013-04-17T11:16:37.087
> 
> 标签：iphone, uitextinput, dictation

我正在为富文本编辑实现一个自定义文本视图，它实现了`UITextInput`协议，当使用听写时，我发现它`-dictationRecordingDidEnd`被调用了，但从`-insertDictationResultPlaceholder`未被调用，所以它不会显示听写的占位符，知道吗？

# java - 持久化实体时出现 NullPointerException

> ID：16058583
> 
> 赞同：7
> 
> 时间：2013-04-17T11:16:37.227
> 
> 标签：java, spring, hibernate

我能够使用 NamedQuery 成功检索对象列表。如果我不对对象进行任何修改然后尝试合并它（使用我的实体管理器），则不会引发异常。但是，如果我更新该实体中的任何字段并尝试合并它，则会引发以下异常：

```
SEVERE: Servlet.service() for servlet [spring-mvc] in context with path [/EuropCar]   threw exception [Request processing failed; nested exception is org.springframework.transaction.TransactionSystemException: Could not commit JPA transaction; nested exception is javax.persistence.RollbackException: Error while committing the transaction] with root cause
java.lang.NullPointerException
    at org.hibernate.ejb.event.EJB3PostUpdateEventListener.handlePostUpdate(EJB3PostUpdateEventListener.java:71)
    at org.hibernate.ejb.event.EJB3PostUpdateEventListener.onPostUpdate(EJB3PostUpdateEventListener.java:67)
    at org.hibernate.action.internal.EntityUpdateAction.postUpdate(EntityUpdateAction.java:248)
    at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:205)
    at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:362)
    at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:354)
    at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:276)
    at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:328)
    at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:52)
    at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1233)
    at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:403)
    at org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.beforeTransactionCommit(JdbcTransaction.java:101)
    at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.commit(AbstractTransactionImpl.java:175)
    at org.hibernate.ejb.TransactionImpl.commit(TransactionImpl.java:75)
    at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:512)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754)
    at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723)
    at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:393)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:120)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202) 
```

我检查了以下内容：

*   我坚持的实体不为空。
*   entityManager 不为空。

任何帮助将不胜感激。

* * *

```
// Code to update the 'Rate' entity
Rate r = rateDao.getRate();
r.setCountry("NA");
rateDao.update(r);

// RateDaoImpl code (DAO IMPLEMENTATION CLASS)
@Override
public Rate getRate() {
// named query is : "SELECT rp FROM RatePeriod rp WHERE rp.id = 458"
return em.createNamedQuery("Rate.qry", Rate.class).getResultList().get(0);
}

@Transactional(readOnly=false)
@Override
public void update(Rate rate) {
em.merge(rate);
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-18T14:38:15.727

我在同一行有同样的例外。那是因为我使用了不兼容的版本：hibernate-core:4.2.0.Final hibernate-entitymanager:4.1.9.Final

我已将 hibernate-core 降级到 4.1.9.Final 并且问题消失了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T12:05:14.587

这是代码`EJB3PostUpdateEventListener`：

```
70  private void handlePostUpdate(Object entity, EventSource source) {
71      EntityEntry entry = (EntityEntry) source.getPersistenceContext().getEntry( entity );
72      // mimic the preUpdate filter
73      if ( Status.DELETED != entry.getStatus()) {
74          callbackHandler.postUpdate(entity);
75      }
76  } 
```

在这个方法中设置一个断点，看看`null`第 71 行是什么。可能`getPersistenceContext()`返回`null`。

# wcf - Ninject 3.0.0 和 NServiceBus 3.3.0 注入问题

> ID：16058588
> 
> 赞同：2
> 
> 时间：2013-04-17T11:16:47.670
> 
> 标签：wcf, ninject, nservicebus

我开发了一个小型测试系统来了解 NServiceBus。测试项目中的类取自使用 Castle.Windsor 进行依赖注入的生产系统。

除了 Ninject 和 NServiceBus 程序集之外，testproject 还引用了：

```
Ninject.Extensions.ContextPreservation 3.0.0.0
Ninject.Extensions.Conventions 3.0.0.0
Ninject.Extensions.NamedScope 3.0.0.0
Ninject.Extensions.Wcf 3.0.0.0
Ninject.Web.Common 3.0.0.0
NServiceBus.ObjectBuilder.Ninject 3.3.0.0 
```

这是 NServiceBus 端点配置：

```
public class EndpointConfig : IConfigureThisEndpoint, AsA_Server, IWantCustomInitialization
{
    private IKernel _kernel;

    public void Init()
    {
        _kernel = new StandardKernel(new EndpointModule());
        Configure.With()
                 .NinjectBuilder(_kernel)
                 .Log4Net()
                 .XmlSerializer();
    }
} 
```

EndpointModule 定义为：

```
public class EndpointModule : NinjectModule
{
    public override void Load()
    {
        Kernel.Bind(x => x.FromThisAssembly().SelectAllTypes().InheritedFrom<IWcfGatewayService>().BindToSelf().Configure(c => c.InTransientScope()));
    }
} 
```

下面是实现 IWcfGatewayService 的类型的示例：

```
[ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.PerCall)]
public abstract class WcfGatewayService<TCommand> : IWcfGatewayService where TCommand : ICommand
{
    public IBus Bus { get; set; }

    public ResponseCode Process(TCommand command)
    {
        try
        {
            Bus.SendLocal(command);
            return ResponseCode.Sent;
        }
        catch (Exception)
        {
            return ResponseCode.Failed;
        }
    }
} 
```

这是一个实际服务的实现：

```
public class PlaceOrderCommandService : WcfGatewayService<PlaceOrderCommand>, IPlaceOrderCommandService
{} 
```

和

```
[ServiceContract]
public interface IPlaceOrderCommandService
{
    [OperationContract(Action = "http://tempuri.org/IPlaceOrderCommandService/Process", ReplyAction = "http://tempuri.org/IPlaceOrderCommandService/ProcessResponse")]
    ResponseCode Process(PlaceOrderCommand command);
} 
```

这是引导程序：

```
public class WcfServiceBootstrapper : IWantToRunAtStartup
{
    private readonly List<ServiceHostBase> _hosts = new List<ServiceHostBase>();

    public void Run()
    {
        var serviceTypes = GetType().Assembly.GetTypes().Where(t => typeof(IWcfGatewayService).IsAssignableFrom(t) && !t.IsAbstract && !t.IsInterface).ToList();
        foreach (var host in from serviceType in serviceTypes let baseAddress = new[] { new Uri(string.Format("http://localhost:8778/omjykonservices/{0}", serviceType.Name)) } select new ServiceHost(serviceType, baseAddress))
        {
            _hosts.Add(host);
            var serviceMetadataBehaviour = new ServiceMetadataBehavior
                {
                    HttpGetEnabled = true,
                    MetadataExporter = {PolicyVersion = PolicyVersion.Policy15}
                };
            host.Description.Behaviors.Add(serviceMetadataBehaviour);
            host.Open();
        }
    }

    public void Stop()
    {
        foreach (var host in _hosts.Where(host => host != null))
        {
            host.Close();
        }
        _hosts.Clear();
    }
} 
```

我遇到的问题是，当调用 Process 方法（在 WcfGatewayService 中）时，它会失败，因为 Bus 属性为空，即没有注入 IBus 实例。但是，NinjectBuilder (NServiceBus.ObjectBuilder.Ninject) 的文档明确指出，对 NinjectBuilder 的调用将向 IoC 注册一个 IBus 实例，即 Ninject。由于情况似乎并非如此，我怀疑我一定忽略了一些东西。

有没有人有过这种设置的经验？关于为什么 Bus 属性没有注入 IBus 实例的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T21:47:00.547

问题是您没有使用 Ninject.Extension.WCF 来创建服务主机。您可以通过添加自己的自定义依赖项并声明为属性来验证这一点。即使使用 InjectAttribute 它也将始终为空，因为您正在自己实例化服务主机并且只需注册服务类型。为了让 ninject 魔法工作，您需要使用 Ninject.Extension.WCF 提供的机制创建主机。例如参见：

[https://github.com/ninject/ninject.extensions.wcf/blob/master/src/Examples/WindowsTimeService/WindowsTimeService.cs](https://github.com/ninject/ninject.extensions.wcf/blob/master/src/Examples/WindowsTimeService/WindowsTimeService.cs)

```
 var yourServiceConfiguration = NinjectWcfConfiguration.Create<YourService, NinjectServiceSelfHostFactory>();

  var selfHost = new NinjectSelfHostBootstrapper(
            kernel, 
            yourServiceConfiguration );
  selfHost.Start(); 
```

然后，您可以在公共汽车关闭时停止它。当使用带有 ninject 的属性注入时，Ruben 的回答通常是正确的，您必须在属性上声明 InjecAttribute。但是 nservicebus 的 ninject 对象构建器具有特殊的启发式方法，它允许进行属性注入而无需声明注入属性。这是为了方便而添加的，因为大多数 NSB 示例使用属性注入而没有任何自定义容器声明。我们认为 Ninject 也必须与 NSB 一起支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T21:07:33.187

虽然您`Bus`在命令上有一个属性，但它没有 [Inject] 属性。OOTB Ninject 不会注入没有此类标记的属性（但 Windsor 会注入（根据我对[http://manning.com/seemann](http://manning.com/seemann)中有关它的章节的粗略记忆（这是必读的）））

* * *

如果这不是问题，你会发现一些很好的老式调试每次都会击败 SO 或邮件列表：-

要诊断 Ninject 是否真的被用于创建服务，最好添加一个 ctor 并在其上放置断点并查看调用者是否是 Ninject。实现相同目的的另一种方法是实现`IActivation`（或者称为 IStart）。或者`OnActivation`在您的`Configure`.

# google-maps - 每 100 米后获取沿途点的纬度/经度

> ID：16058594
> 
> 赞同：2
> 
> 时间：2013-04-17T11:17:06.830
> 
> 标签：google-maps, google-maps-api-3

使用方向服务我在地图上绘制了一条路线。现在我希望将这条路线保存为 MySQL 中的多边形

所以我需要在每 100 米之后获取路线上点的纬度/经度，我将其保存为多边形。我如何在谷歌地图 V3 中做到这一点。我正在使用 JS 和 JAVA。

[我还在这里](https://stackoverflow.com/questions/11216384/how-to-get-entire-latlng-along-a-route-google-api-v3)找到了类似的帖子，有 75 次以上的浏览量，但没有任何回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T12:14:56.570

嗯，首先我会专注于

> 获取路径（）

Google Maps API v3 中折线对象的方法。

[看到这个链接](https://developers.google.com/maps/documentation/javascript/reference#Polyline)

这将返回 LatLng 对象的 MVC 数组，这些对象是生成的路线折线的顶点。然后，如果您想要更多点样本（例如，我的意思是您希望在每 100 米后获得点），您可以编写一个循环来生成更多点。循环中将发生的事情是它使用当前索引获取 LatLng 并获取下一个索引。然后它计算它们之间的航向，然后如果检查的两个点之间的距离超过 100 米，那么它将在距当前索引点 100 米的距离处放置一个点。

为了给你更多的思考，我建议你看看[这个链接](https://developers.google.com/maps/documentation/javascript/reference#spherical)

在循环期间，您会将纬度收集到一个新数组中，该数组将在循环结束时包含生成的折线的所有所需顶点。

至于将这些点存储在mysql中，您必须将这些点格式化为WKT格式。由于将方向折线存储为多边形是无意义的，因此我建议您使用 LINESTRING。这是一个维基百科页面，它为您提供 WKT 的概述：[链接](http://en.wikipedia.org/wiki/Well-known_text)

# android - android Ndk 未定义对 sigemptsyset 的引用

> ID：16058597
> 
> 赞同：3
> 
> 时间：2013-04-17T11:17:15.050
> 
> 标签：android, android-ndk, signals

我正在为 android 交叉编译一些本机代码，我在我的代码中使用了一些与 linux 计时器相关的信号集（sigemptyset）。在我的 PC 上一切正常，当我使用 android ndk-build 脚本构建代码时，出现以下错误

```
 jni/../src/Timer.cpp:74: undefined reference to `sigemptyset'
  jni/../src/Timer.cpp:75: undefined reference to `__libc_current_sigrtmin'
  jni/../src/Timer.cpp:75: undefined reference to `sigaddset'
  jni/../src/Timer.cpp:86: undefined reference to `sigemptyset'
  jni/../src/Timer.cpp:88: undefined reference to `__libc_current_sigrtmin' 
```

我已经正确链接了所有的库，但我仍然得到这个未定义的引用错误。

我必须使用哪个库来为函数 realted signal.h 提供参考。

# xpath - 在带有属性的 Xpath 中使用通配符

> ID：16058601
> 
> 赞同：7
> 
> 时间：2013-04-17T11:17:23.620
> 
> 标签：xpath

这是我试图用 XPath 解析的 html 内容

```
<td class="text1">Content</td>
<td class="text2">Content</td>
<td class="text2">Content</td> 
```

我想使用 class 属性选择 td 元素，但很明显，这个属性的值对于每个元素都是不同的。我尝试过：

```
//td[starts-with(@class,'text')] 
```

但这种方法不起作用。正确的方法是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-17T19:46:50.960

您可以使用“包含”：

```
//td[contains(@class, 'text')] 
```

# google-chrome - 如何使用选项卡在 Chrome 的 textarea 编辑器中识别多行？

> ID：16058602
> 
> 赞同：1
> 
> 时间：2013-04-17T11:17:25.687
> 
> 标签：google-chrome

我正在寻找一种解决方案，使我能够使用 tab/shift-tab 来更改文本区域中选定多行的缩进，例如此处的降价编辑器。

到目前为止，我正在寻找 Chrome 解决方案。

# bash - 用 \n + 相同的字符替换字符

> ID：16058603
> 
> 赞同：0
> 
> 时间：2013-04-17T11:17:27.770
> 
> 标签：bash

我正在尝试用相同的字符替换某些字符，但`\n`在它前面。

所以我想做，像，`replace (a|b|c|d) with \n + (same character as before)`。

有谁知道解决这个问题的好方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:19:12.693

尝试：

```
data_producing_command | sed 's/[abcd]/\n&/g' 
```

例如

```
cat myFile.txt | sed 's/[abcd]/\n&/g' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:20:43.853

您可以使用`sed`. 只需通过以下方式捕获有问题的`\1`角色`\(...\)`：

```
sed 's/\([abcd]\)/\n\1/g' 
```

# .net - 在安装项目中自动安装 .Net 框架

> ID：16058608
> 
> 赞同：1
> 
> 时间：2013-04-17T11:17:34.467
> 
> 标签：.net, winforms, installation

我在 Visual Studio 2010 中有一个安装项目来安装 Winforms，我希望安装程序自动安装 .Net 框架。我把框架作为先决条件，但安装不是自动的。用户必须在收到未安装 .NET 的消息后，手动打开安装程序。有没有办法在我的设置中自动安装 .Net 框架？

# twitter-bootstrap - What bootstrap components make "cancel" links look right?

> ID：16058611
> 
> 赞同：1
> 
> 时间：2013-04-17T11:17:40.543
> 
> 标签：twitter-bootstrap

I'm trying to download a subset of Bootstrap that gives me alerts and modals. The main elements (the body of the alerts and the modals) appear correctly, but the "x" to cancel both the alerts and modals is showing up as misplaced and unstyled, respectively. For example:

[http://imm.io/138VK](http://imm.io/138VK)

The only thing I've downloaded from [http://twitter.github.io/bootstrap/customize.html](http://twitter.github.io/bootstrap/customize.html) is the Alerts and Modals (plus their JS counterparts). What else am I missing? I've checked that there is no conflicting CSS.

For the alert, I can fix it by adding float: right; and then changing the pointer style (which shows a text entry cursor instead of a link), but I'd rather not do it manually.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:26:36.370

In Bootstrap Customize page there's an option called **Close icon** under **Miscellaneous** section. Make sure you check this option before downloading your customized version of Twitter Bootstrap.

# android - Android 调用 getview

> ID：16058613
> 
> 赞同：1
> 
> 时间：2013-04-17T11:17:43.427
> 
> 标签：android, view, textview, listadapter, method-call

我对android中的getview方法有疑问。我的 getview 方法（在课堂上`QuestionsListAdapter`）：

```
public View getView(int position, View convertView, ViewGroup parent){
    QuestionView qv;
    if (convertView == null) {
        qv = new QuestionView (nContext, nQuestion[position], nDetail[position], nExpanded[position]);
    } else {
        qv = (QuestionView)convertView;
        qv.setName(nQuestion[position]);
        qv.setDetail(nDetail[position]);
        qv.setExpanded(nExpanded[position]);
    }        
    return qv;
} 
```

但是我该如何调用该方法呢？如果我没有旧观点并且父母不是`LayoutParams.FILL_PARENT`

我的创建：

```
@Override
public void onCreate(Bundle savedInstanceState){
   super.onCreate(savedInstanceState);

   // Use our own list adapter
   setListAdapter(new QuestionsListAdapter(this));
} 
```

那么如何调用 getView 方法，因为如果我运行代码，它就不会绘图。像这样的东西？

```
QuestionsListAdapter.getView( 0,  convertView,  parent); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T11:23:12.863

您不必调用该方法。如果您在 customAdapter 中覆盖该方法，则每次`Adapter`从您的数据源获取数据并将其放入`View`表示您的`ListView`.

# nginx - MP4 伪流在 JWPlayer Flash 模式下不起作用

> ID：16058615
> 
> 赞同：0
> 
> 时间：2013-04-17T11:17:46.763
> 
> 标签：nginx, html5-audio, jwplayer, pseudo-streaming

我已经配置了一个 NginX`mod_mp4`来流式传输 mp4 媒体，并且我在 HTML5 和 Flash 模式下都使用 JWPlayer 5。

现在寻求功能在支持 mp4 播放的 webkit 浏览器中工作，但在 Firefox 和其他 JWPlayer 使用 Flash 模式的浏览器中它不起作用。怎么了？

我的 JWPlayer 设置：

```
jwplayer('mediaplayer').setup({
    file: '/1.mp4',
    height: '100',
    width: '100%',
    bufferlength: 50,
    repeat: 'none',
    startparam: 'start',
    modes: [
        { 'type': 'html5' },
        { 'type': 'flash', src: '/mediaplayer/player.swf' }
    ],
    autostart: 'false'
}); 
```

# python - 如何从 0 属性函数侧的 tkinter 顶层获取值？

> ID：16058616
> 
> 赞同：1
> 
> 时间：2013-04-17T11:17:48.870
> 
> 标签：python, get, tkinter

如何从 0 属性函数侧的 tkinter 顶层获取值？

```
def Update():  
    Up = Toplevel()
    Up.title("Update")
    taskLabel = Label(Up, text ="Update", font=('Times', 20)).grid(row=0)

    var = IntVar()
    radio = Radiobutton(Up, text="Fully", variable=var, value=1, command = taskUpdate).grid(row=2, sticky=W)

    radio = Radiobutton(Up, text="Partly", variable=var, value=2, command = taskUpdate).grid(row=3, sticky=W)

    radio = Radiobutton(Up, text="Un", variable=var, value=3, command = taskUpdate).grid(row=4, sticky=W)

    note = EntryaUp, width=30, font=('Arial', 12,)).grid(row=6)
    Button = Button(Up, text ="Task Complete and Send Invoice", command = taskUpdate).grid(row =7)

    return (var, note) 
```

* * *

```
def updateB ():
    var, noteBox = Update()
    a = (var.get())
    b = (note.get()) 
```

这是 tkinter 中的顶级窗口，我想在单击单选按钮时获取值 1,2,3，并在我在条目中输入文本并单击命令按钮时获取字符串值，但我只是不知道我怎样才能做到这一点。顺便说一句，我认为我根本无法返回该值，每次返回时它只返回初始值，即 0 和“”。我知道它是如何工作的，并且如果单选按钮不在顶层（或在函数中），我可以获得值。但是如果结构是这样的，我无法弄清楚我该怎么做。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T16:40:16.980

对您的问题的简短回答是，您可以使用[wait_window()](http://effbot.org/tkinterbook/widget.htm#Tkinter.Widget.wait_window-method)等待窗口被关闭，然后您可以从函数中返回您想要的任何内容。然后，您将连接“任务完成”按钮以简单地销毁窗口。

您必须非常小心——`wait_window`创建一个*新*的*嵌套*事件循环。大多数情况下，这与窗口抓取一起完成，以防止处理其他窗口中的事件。当你这样做时，你正在创建一个模态对话框。

这是一个工作示例；我不得不稍微调整一下你的代码，我冒昧地删除了一些不必要的变量（例如对单选按钮的引用，因为你从不对引用做任何事情）

```
import Tkinter as tk # python 2.7 

class Example(tk.Frame):
    def __init__(self, *args, **kwargs):
        tk.Frame.__init__(self, *args, **kwargs)
        button = tk.Button(self, text="Open window", command=self.on_button)
        button.pack()

    def on_button(self):
        var, note = Update()
        a = var.get()
        b = note.get()
        print "a: '%s' b: '%s'" % (a,b)

def Update():
    Up = tk.Toplevel()
    Up.title("Update")
    tk.Label(Up, text ="Update", font=('Times', 20)).grid(row=0)

    var = tk.IntVar()
    tk.Radiobutton(Up, text="Fully", variable=var, value=1).grid(row=2, sticky="w")
    tk.Radiobutton(Up, text="Partly", variable=var, value=2).grid(row=3, sticky="w")
    tk.Radiobutton(Up, text="Un", variable=var, value=3).grid(row=4, sticky="w")

    evar = tk.StringVar()
    note = tk.Entry(Up, width=30, font=('Arial', 12,), textvariable=evar)
    note.grid(row=6)

    Button = tk.Button(Up, text ="Task Complete and Send Invoice", command = Up.destroy).grid(row =7)

    Up.wait_window()
    print "done waiting..."
    return (var, evar)

if __name__ == "__main__":
    root = tk.Tk()
    Example(root).pack(side="top", fill="both", expand=True)
    root.mainloop() 
```

要了解为什么在使用此功能时必须小心，请尝试以下场景：

1.  单击“打开窗口”按钮，填写表格并单击“任务完成”按钮。请注意，它可能以您期望的方式工作（它打印到标准输出，因此请确保您是从控制台窗口运行的）

2.  单击“打开窗口”按钮，然后再次单击它。你现在有两个窗口。填写第二个窗口，单击“任务完成”并注意它的工作方式与您预期的一样。现在填写第一个窗口并单击“任务完成”，它仍然可以正常工作。在这两种情况下，当您单击按钮时，它都会将正确的值打印到屏幕上。

3.  单击“打开窗口”按钮，然后再次单击它。你现在有两个窗口。这次，填写第*一个*窗口，然后单击“任务完成”。请注意，它不会*将* 结果打印到屏幕上。这是因为在第三个窗口的嵌套事件循环完成之前，第一个窗口的嵌套事件循环无法完成。填写第二个窗口的表格并单击“任务完成”，您会看到两个嵌套的事件循环展开，但不是按照您单击“任务完成”的顺序，而是按照窗口的顺序创建的。

这就是为什么您在使用时需要小心的原因`wait_window`——您应该防止这种事件循环的递归嵌套，否则您的 GUI 可能不会按照您期望的方式运行。

# php - 使用 Drupal 7 的 php 中的多线程

> ID：16058618
> 
> 赞同：0
> 
> 时间：2013-04-17T11:17:57.093
> 
> 标签：php, mysql, drupal, drupal-7

我正在使用框架 Drupal 7 和带有 mysql 的环境 Windows。我有一个问题，我想在 php 中调用异步调用，我必须更新数据库中的某些值，但我不想停止函数的执行。即使数据库处理正在进行，函数也应该完成并返回值。

我在考虑线程方法，其中一个线程正在更新数据库，其他线程将完成并返回函数。可以在 php 中使用吗？如果是，那怎么办？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-01T04:20:04.067

另一种选择是 HTTP 并行请求和线程库模块：[https ://www.drupal.org/project/httprl](https://www.drupal.org/project/httprl)

我认为您想要的功能是 httprl_queue_background_callback() 然后是 httprl_send_request()。请参阅示例（API 文档不是很好）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-22T19:47:43.507

这是我编写的多线程 Drush 教程的链接，它可能会帮助您了解 Drupal 7 中的多线程示例：

[http://deeson-online.co.uk/labs/multi-threading-part-1-how-make-drush-rush](http://deeson-online.co.uk/labs/multi-threading-part-1-how-make-drush-rush)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T16:06:15.253

到目前为止，有上千个关于 PHP 多线程的问题，它们都在 Drupal 上“工作”。PHP 并不真正支持多线程。我敢打赌，您需要使用此功能。

```
passthru("/usr/bin/php /path/to/script.php ".$argv_parameter." >> /path/to/log_file.log 2>&1 &"); 
```

这将使它保持在后台运行并将结果输出到您的日志中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T09:26:49.270

我建议使用 Symfony2 框架中的 Process 组件：http: [//symfony.com/doc/master/components/process.html](http://symfony.com/doc/master/components/process.html)

# javascript - 通过 Ajax 动态更新数据列表

> ID：16058621
> 
> 赞同：1
> 
> 时间：2013-04-17T11:17:59.797
> 
> 标签：javascript, php, ajax, html, html-datalist

我需要通过 ajax 更新一个 html 5 数据列表。
html代码在这里。

```
<body>
  <input type="text" id="bar" list="fruit" onkeyup="jsfun()" />
   <datalist id="fruit"></datalist>
</body> 
```

JavaScript 的伪代码。

```
function jsfun(){
    //1- Get the last word from input field ("bar").
    var skw1 = document.getElementById("searchBar").value;
    var skw2 = skw1.split(" ");
    var skw = skw2[skw2.length-1];
   //2- Use Ajax to send data on server and get data result back
   /* 
   * here goes other javascript content for ajax
    */
    xmlhttp.open("GET","searchopt.php?skw="+skw,true);
            xmlhttp.send();
   //3- use javascript to update the datalist with those result which Ajax get.
} 
```

在这里看到下面的网址首先写**mang**然后删除它并写**bann**
它给出一个建议
然后删除它并知道写**mango bann**这次它不能给出任何建议。为什么但是这个建议存在于数据库中。它只给第一个建议单词。
[http://iws.uphero.com/qwe.html](http://iws.uphero.com/qwe.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:45:31.447

好的...这是问题所在。默认情况下，Datalist 将文本框中的内容与允许的选项相匹配。选项正在通过 AJAX 正确更改。没有改变的是“mango bann”不等于“mango”或“bann”。

作为一种解决方法，您可以使用 AJAX 函数在输入第二个单词后覆盖文本框。例如：

```
var skw1 = document.getElementById("searchBar").value;
var skw2 = skw1.split(" ");
var skw = skw2[skw2.length-1];
document.getElementById("searchBar").value = skw; 
```

# mongodb - 迭代 MongoDB 中的集合以进行更新

> ID：16058623
> 
> 赞同：2
> 
> 时间：2013-04-17T11:18:02.703
> 
> 标签：mongodb, loops, collections, mongoid, moped

我正在迭代一个集合（将 Moped 作为 Ruby 驱动程序运行），但是如何为每个文档更新一个字段？

```
irb> session = Moped::Session.new(["127.0.0.1:27017"])
irb> session.use :demoapp
irb> users = session[:users]
irb> users.find.each {|u| u.update(age: rand(18..80))} 
```

这不会更新字段“年龄”，而一个简单的

```
irb> users.find.each {|u| users.find(_id: u["_id"]).update(age: rand(18..80))} 
```

做。但是迭代一个集合然后在每次迭代中查找 id 似乎不是很有效。那么我该如何简化呢？我需要一些快速的方法来以这种方式更新数百万个文档。

问候，克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T23:14:20.160

你对待轻便摩托车更像是mongoid。Moped 不是 ODM——它是一个低级的 mongodb 驱动程序。

当你迭代时，`users.find`你会得到一个简单`Moped::BSON::Document`对象的集合，它们更像 ruby`Hash`​​ 对象而不是其他任何东西。所以当你调用`update`它们时，你只是在内存中更新本地的，而不是触及数据库。

相似地

```
users.find(_id: u["_id"]).update(age: rand(18..80)) 
```

并没有你想的那么糟糕。Moped 将其编译为单个`update`命令——它不会获取文档、修改它，然后将其写回。

为了便于开发，您可能会更乐意实际使用 mongoid，如下所示：

```
class User
    include Mongoid::Document
    field :age, type: Integer
end 

User.all.each do |u| 
    u.age = rand(18..80)
    u.save!
end 
```

但如果性能很关键，轻便摩托车会更快。您还可以对官方[10gen ruby​​ 驱动程序](http://api.mongodb.org/ruby/current/)进行基准测试。如果您可以将代码移植到 javascript，则可以在 mongodb 服务器本身上运行它，这将消除网络延迟，但在执行此类操作时要小心锁定整个数据库。

# java - 如何测试我的网络服务？

> ID：16058628
> 
> 赞同：0
> 
> 时间：2013-04-17T11:18:15.530
> 
> 标签：java, web-services, jsf, soap

嘿，我是 JSF 的新手，我发现了有关基本 JSF 操作的大量信息。

我正在尝试创建一个 webervice 并自动生成以下内容：

```
@WebService(serviceName = "Charge")
@Stateless  
public class Charge {

    @WebMethod(operationName = "charge")
    public String hello(@WebParam(name = "name") String name) {
        return "Hello " + name+" !";
    }
} 
```

现在到目前为止这么好，我该如何测试它？如果我尝试访问 Web 服务，我会收到`resource not available`错误消息。我应该添加一些东西`web.xml`吗？

我正在尝试创建一个简单的 SOAP Web 服务，但找不到有关该主题的信息，如果您碰巧有一个很好的教程（不是那些出现在 Google 上的第一个结果），我很想获得一个链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:36:56.110

好吧，我不知道为什么，但事实上我有服务`@Stateless`使它无法访问。

当我删除它时，我可以找到服务@`localhost/<app-name>/Charge?wsdl`

# cuda - 在 CUDA 中解绑纹理之前我应该 同步吗？

> ID：16058631
> 
> 赞同：2
> 
> 时间：2013-04-17T11:18:23.587
> 
> 标签：cuda, textures, gpu

我正在为我的一个内核程序使用纹理内存。

我绑定纹理内存，然后调用使用纹理内存的内核执行，最后我取消绑定纹理。我试图弄清楚我的设备是否有可能在我的内核执行结束之前取消绑定纹理？或者无论哪种方式， unbind 命令会失败吗？

```
 cudaChannelFormatDesc desc = cudaCreateChannelDesc<unsigned char>();
     cudaBindTexture(NULL,tex,d_buffer,desc,iw,ih,d_bufferStride));

     KernelTextureCall<<<100,100,0,streamObject>>>();
     cudaGetLastError(); 

     // Should I sych or not ? 
     cudaUnbindTexture(tex); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T12:07:30.037

之前不需要同步`cudaUnbindTexture`。它包含隐式同步。

# c++ - GLuint 未被识别

> ID：16058635
> 
> 赞同：8
> 
> 时间：2013-04-17T11:18:38.397
> 
> 标签：c++, visual-studio, opengl, textures, glut

我正在 OpenGL 中创建一个 3D 应用程序，并且为了在我正在阅读的模型上显示纹理，我正在使用 GLuint。但是，我收到了 Visual Studio 错误 C4430 缺少类型，以及与该问题相关的其他一些错误。

包含 glut 文件，并且在放入之前运行良好。是 GLuint 已过时，还是其他原因？

编辑：已更改的代码是：

之前的对象构造函数

```
Object::Object(string shapeFileName, string texFileName){
    readFile(shapeFileName);
    loadTexture(texFileName);
} 
```

之后的对象构造函数

```
Object::Object(string shapeFileName, string texFileName){
    readFile(shapeFileName);

    glGenTextures(1, &texture);
    glBindTexture(GL_TEXTURE_2D, texture);
    glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_MODULATE);

    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);

    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
    glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);

    loadTexture(texFileName);
    gluBuild2DMipmaps(GL_TEXTURE_2D, 3, 1024, 512, GL_RGB, GL_UNSIGNED_BYTE, image_array);

    free(image_array);

    glTexImage2D(GL_TEXTURE_2D, 0, 3, 1024, 512, 0, GL_RGB, GL_UNSIGNED_BYTE, image_array);
} 
```

除了`GLuint texture;`头文件中添加的行之外，这是唯一引发错误的位。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T12:42:23.493

Did you include the OpenGL header in the header you're declaring the variable in? `GLuint` is defined in `gl.h` so you must include that.

On all operating systems *except* MacOS X it's

```
#include <GL/gl.h> 
```

on MacOS X it is

```
#include <OpenGL/gl.h> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-04-15T15:19:18.040

我认为您应该使用 glew 并包括：

```
#include <GL/glew.h> 
```

而不是：

```
#include <GL/gl.h> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-02-17T16:28:50.903

对于 iOS，您需要将 OpenGLES.framework 链接到您的目标并在代码中导入标头：

```
#import <OpenGLES/gltypes.h> 
```

# python - 与 Mac 的 Enthought-Canopy 中的 Tkinter 冲突

> ID：16058639
> 
> 赞同：1
> 
> 时间：2013-04-17T11:18:50.940
> 
> 标签：python, tkinter, enthought, canopy

我在尝试使用 Mac 中的 Enthough-Canopy 编译简单的 tkinter gui 时遇到问题。这是我要编译的代码：

```
from Tkinter import *
root= Tk();
root.title('Toplevel')
Label(root,text='This is the Toplevel').pack(pady=10)
root.mainloop() 
```

这是我收到的消息：

```
ImportError                               Traceback (most recent call last)
/Applications/Canopy.app/appdata/canopy-1.0.0.1160.macosx-
x86_64/Canopy.app/Contents/lib/python2.7/site-packages/IPython/utils/py3compat.pyc in 
execfile(fname, *where)
    181             else:
    182                 filename = fname
--> 183             __builtin__.execfile(filename, *where)
/var/folders/m1/70f55r290cz7j_sjc010k0n00000gn/T/tmp1gLNQA.py in <module>()
----> 1 from Tkinter import *
      2 
      3 root= Tk();
      4 
      5 root.title('Toplevel')
/Applications/Canopy.app/appdata/canopy-1.0.0.1160.macosx-
x86_64/Canopy.app/Contents/lib/python2.7/lib-tk/Tkinter.py in <module>()
     37     # Attempt to configure Tcl/Tk without requiring PATH
     38     import FixTk
---> 39 import _tkinter # If this fails your Python may not be configured for Tk
     40 tkinter = _tkinter # b/w compat for export
     41 TclError = _tkinter.TclError
ImportError: dlopen(/Applications/Canopy.app/appdata/canopy-1.0.0.1160.macosx- 
x86_64/Canopy.app/Contents/lib/python2.7/lib-dynload/_tkinter.so, 2): Library not loaded: 
/Library/Frameworks/Python.framework/Versions/111.222.33344/lib/libtcl8.5.dylib
 Referenced from: /Applications/Canopy.app/appdata/canopy-1.0.0.1160.macosx-
x86_64/Canopy.app/Contents/lib/python2.7/lib-dynload/_tkinter.so
  Reason: image not found 
```

主要问题是 TK 或 TCL，但它已经安装并且运行良好（代码在 Aptana studio 3 中运行良好），但是当我尝试在 Canopy 中运行它时它失败了。

感谢您的时间和支持

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-28T18:51:42.903

默认情况下，Canopy 使用 Qt4 图形后端，这会导致问题，因为这两个后端不能在一个进程中共存。要解决此问题，在 Canopy Preferences > Python 选项卡中，您可以将 PyLab 后端从 Interactive (Qt4) 更改为 Inline (SVG) 以允许使用 Tkinter。

您可以根据项目在这两种设置之间切换（推荐，因为默认的 Qt 后端通常更有吸引力），或者如果您认为不需要返回，则只需指定内联 (SVG)。

# neo4j - 在 neo4j 中使用 GlobalGraphOperations 检索所有节点时出现 UnsupportedOperationException

> ID：16058644
> 
> 赞同：2
> 
> 时间：2013-04-17T11:18:56.723
> 
> 标签：neo4j

我正在使用 neo4j 1.8.2 并试图从图中检索所有节点，但我得到了 UnsupportedOperationException。

```
GraphDatabaseService db = GraphDatabaseFactory.databaseFor("http://localhost:7474/db/data/");
Iterable<Node> nodes = GlobalGraphOperations.at(db).getAllNodes(); 
```

我在 API 文档中找到了它，所以我无法理解，我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:38:23.943

你在哪里找到它？

**REST**图形数据库不支持此操作（或者至少不支持从`GlobalGraphOperations`

这`db.getAllNodes()`是使用远程密码查询实现的，这也是您应该做的。

```
new RestCypherQueryEngine(restGraphDb.getRestAPI()).query(....) 
```

或者

```
restGraphDB.query() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T12:02:43.437

看来您无法使用远程数据库执行此操作。检查[源代码](https://github.com/neo4j/java-rest-binding/blob/master/src/main/java/org/neo4j/rest/graphdb/AbstractRemoteDatabase.java)，它经常抛出 UnsupportedOperationExceptions。也许嵌入式数据库是您的选择？

# ruby-on-rails-3 - Ruby on Rails + MongoDB 和 MongoID

> ID：16058651
> 
> 赞同：0
> 
> 时间：2013-04-17T11:19:13.753
> 
> 标签：ruby-on-rails-3, mongodb, mongoid, mongoid3

我已经使用 MongoDB 创建了一个示例数据库，其中包含来自 mongodbs 网站上的 JSON 文件的数据，我已使用以下命令将其导入。mongoimport --db test --collection zips --file zips.json 数据正在处理中，当我尝试在控制台中搜索数据时，它会显示出来，到目前为止一切都很好。

我的问题是当我尝试将数据库与我的 Rails 应用程序一起使用时。我创建了一个类，城市，代码如下所示。

```
 class City
       include Mongoid::Document
       field :c, as: :city, type: String
       field :l, as: :loc, type: Array
       field :p, as: :population, type: Integer
       field :s, as: :state, type: String
       field :_id, type: Integer
    end 
```

我的 mongoid.yml 文件看起来像这样

```
 development:
     # Configure available database sessions. (required)
    sessions:
     # Defines the default session. (required)
    default:
     # Defines the name of the default database that Mongoid can connect to.
     # (required).
    database: exjobb
     # Provides the hosts the default session can connect to. Must be an array
     # of host:port pairs. (required)
    hosts:
      - localhost:27017
    options:

    options:

    test:
     sessions:
      default:
       database: exjobb
       hosts:
        - localhost:27017
       options:
       consistency: :strong
        # In the test environment we lower the retries and retry interval to
        # low amounts for fast failures.
        max_retries: 1
        retry_interval: 0 
```

活动记录被禁用。当我启动 Rails 控制台并尝试 City.where... 时，我得到以下输出。

```
 City.where(city: "Acmar")
    => #<Mongoid::Criteria
    selector: {"c"=>"Acmar"}
    options:  {}
    class:    City
    embedded: false> 
```

如果我尝试 City.first 则会引发错误

```
 NoMethodError: undefined method `to_sym' for nil:NilClass
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/sessions.rb:409:in `__evaluate__'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/sessions.rb:357:in `__database_name__'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/sessions.rb:198:in `database_name'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/sessions.rb:429:in `current_database_name'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/sessions.rb:228:in `mongo_session'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/sessions.rb:171:in `collection'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/contextual/mongo.rb:256:in `initialize'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/contextual.rb:48:in `new'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/contextual.rb:48:in `create_context'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/contextual.rb:31:in `context'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/contextual.rb:21:in `rescue in first'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/contextual.rb:19:in `first'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/mongoid-3.1.2/lib/mongoid/finders.rb:117:in `first'
from (irb):1
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/railties-3.2.11/lib/rails/commands/console.rb:47:in `start'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/railties-3.2.11/lib/rails/commands/console.rb:8:in `start'
from /Users/admin/.rvm/gems/ruby-1.9.3-p374/gems/railties-    3.2.11/lib/rails/commands.rb:41:in `<top (required)>'
from script/rails:6:in `require' 
```

我已经[在这里](https://github.com/josefottosson/exjobb)上传了我的代码，请克隆并尝试帮助我，我卡住了。如您所见，我的数据库不是空的。[http://i.stack.imgur.com/Bho2H.png](http://i.stack.imgur.com/Bho2H.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:06:07.567

Mongoid（使用与 ActiveRecord 类似的映射约定）将类名复数以获取集合名称。看起来您有一个名为的集合，`city`但 Mongoid 会将您的类映射到一个名为`cities`.

您可以覆盖集合名称：

```
class City
  store_in collection: "city"
end 
```

或者更好地将您的数据导入到城市集合中。

# c# - 我的 wpf 应用程序中出现堆栈溢出异常（对 ValidationResult 的无限方法调用）

> ID：16058656
> 
> 赞同：3
> 
> 时间：2013-04-17T11:19:35.100
> 
> 标签：c#, wpf, validation

我想在用户输入时验证文本字段。最初文本为空。验证规则是： 1 它只是数字。2 大于0小于5。下面是xmal中的代码。

```
 <TextBox Grid.Column="1" HorizontalAlignment="Left" Style="{StaticResource textBoxInError}" Name="txtQuantity" Margin="70,0,0,0" Width="70">
   <TextBox.Text>
     <Binding RelativeSource="{RelativeSource Mode=Self}" Path="Text" UpdateSourceTrigger="PropertyChanged">
       <Binding.ValidationRules>                                            
         <ValidationRules:PositiveIntegerRule Min="1" Max="5"></ValidationRules:PositiveIntegerRule>
       </Binding.ValidationRules>
     </Binding>
   </TextBox.Text>
 </TextBox> 
```

我的验证类如下（请忽略汉字，这是错误信息。）：

```
 class PositiveIntegerRule : ValidationRule
{
    public ushort Max { get; set; }
    public ushort Min { get; set; }

    public override ValidationResult Validate(object value, System.Globalization.CultureInfo cultureInfo)
    {
       ushort tmp = 0;
        try
        {
            if (value != null && !String.IsNullOrEmpty(value.ToString()))
            {
                tmp = ushort.Parse(value.ToString());
            }
            else
            {
                return new ValidationResult(false,"数值不能为空");
            }
        }
        catch (Exception e)
        {
            return new ValidationResult(false, "含有不合法字符");
        }

        if(tmp < Min || tmp > Max)
        {
            return new ValidationResult(false,string.Format("超出数值范围：最大值为{0},最小值为{1}",Max,Min));
        }
        else
        {
            return new ValidationResult(true,null);
        }
    }
} 
```

问题是当我运行这个 wpf 应用程序时，只要我输入了一个有效的值，它就会抛出堆栈溢出异常。方法 ValidationResult 被无限调用。而如果我输入了一个无效的值，ValidationResult 方法只会被调用一次。但是不会应用资源中定义的无效值的样式。

我认为这个问题的原因是`RelativeSource="{RelativeSource Mode=Self and UpdateSourceTrigger="PropertyChanged"`同时使用。源和目标指向同一事物。所以他们会无限地互相更新。我什至尝试了与 OneWayToSource 不同的绑定模式，它仍然不起作用。

1.  这里有人可以解释一下当我使用`RelativeSource="{RelativeSource Mode=Self}"`和`UpdateSourceTrigger="PropertyChanged"`在一起时真正发生的事情。
2.  我不明白为什么有效值会导致无限循环，但无效值不会。那是因为如果方法`Validate`返回`new ValidationResult(false,xxx)`，那么.net框架内部的某个地方会抛出一个异常，停止程序运行，那么就不会发生无限循环。而有效值则相反。
3.  为什么我得到一个堆栈溢出异常，而不是像保持调用方法一样继续调用 Validate`CanExecute`方法。

非常感谢

我刚刚添加了调用堆栈：

```
>   JieMeiTaoInventoryManager.exe!JieMeiTaoInventoryManager.ValidationRules.PositiveIntegerRule.Validate(object value, System.Globalization.CultureInfo cultureInfo) Line 16    C#
PresentationFramework.dll!System.Windows.Data.BindingExpressionBase.Validate(object value, System.Windows.Controls.ValidationStep validationStep) + 0x19a bytes 
PresentationFramework.dll!System.Windows.Data.BindingExpression.Validate(object value, System.Windows.Controls.ValidationStep validationStep) + 0x18 bytes  
PresentationFramework.dll!System.Windows.Data.BindingExpressionBase.UpdateValue() + 0x2e bytes  
PresentationFramework.dll!System.Windows.Data.BindingExpression.Update(bool synchronous) + 0x4f bytes   
PresentationFramework.dll!System.Windows.Data.BindingExpressionBase.Dirty() + 0x30 bytes    
PresentationFramework.dll!System.Windows.Data.BindingExpression.SetValue(System.Windows.DependencyObject d, System.Windows.DependencyProperty dp, object value) + 0x27 bytes    
WindowsBase.dll!System.Windows.DependencyObject.SetValueCommon(System.Windows.DependencyProperty dp, object value, System.Windows.PropertyMetadata metadata, bool coerceWithDeferredReference, bool coerceWithCurrentValue, System.Windows.OperationType operationType, bool isInternal) + 0x3c7 bytes  
PresentationFramework.dll!MS.Internal.Data.PropertyPathWorker.SetValue(object item, object value) + 0x171 bytes 
PresentationFramework.dll!MS.Internal.Data.ClrBindingWorker.UpdateValue(object value) + 0xa3 bytes  
PresentationFramework.dll!System.Windows.Data.BindingExpression.UpdateSource(object value) + 0x99 bytes 
PresentationFramework.dll!System.Windows.Data.BindingExpressionBase.UpdateValue() + 0x66 bytes  
PresentationFramework.dll!System.Windows.Data.BindingExpression.Update(bool synchronous) + 0x4f bytes   
PresentationFramework.dll!System.Windows.Data.BindingExpressionBase.Dirty() + 0x30 bytes    
PresentationFramework.dll!System.Windows.Data.BindingExpression.SetValue(System.Windows.DependencyObject d, System.Windows.DependencyProperty dp, object value) + 0x27 bytes    
WindowsBase.dll!System.Windows.DependencyObject.SetValueCommon(System.Windows.DependencyProperty dp, object value, System.Windows.PropertyMetadata metadata, bool coerceWithDeferredReference, bool coerceWithCurrentValue, System.Windows.OperationType operationType, bool isInternal) + 0x3c7 bytes  
WindowsBase.dll!System.Windows.DependencyObject.SetCurrentDeferredValue(System.Windows.DependencyProperty dp, System.Windows.DeferredReference deferredReference) + 0x29 bytes  
PresentationFramework.dll!System.Windows.Controls.TextBox.OnTextContainerChanged(object sender, System.Windows.Documents.TextContainerChangedEventArgs e) + 0xa7 bytes  
PresentationFramework.dll!System.Windows.Documents.TextContainer.EndChange(bool skipEvents) + 0xd9 bytes    
PresentationFramework.dll!System.Windows.Documents.TextContainer.System.Windows.Documents.ITextContainer.EndChange(bool skipEvents) + 0xb bytes 
PresentationFramework.dll!System.Windows.Documents.TextRangeBase.EndChange(System.Windows.Documents.ITextRange thisRange, bool disableScroll, bool skipEvents) + 0x77 bytes 
PresentationFramework.dll!System.Windows.Documents.TextRange.System.Windows.Documents.ITextRange.EndChange(bool disableScroll, bool skipEvents) + 0x15 bytes    
PresentationFramework.dll!System.Windows.Documents.TextRange.ChangeBlock.System.IDisposable.Dispose() + 0x15 bytes  
PresentationFramework.dll!System.Windows.Documents.TextEditorTyping.DoTextInput(System.Windows.Documents.TextEditor This, string textData, bool isInsertKeyToggled, bool acceptControlCharacters) + 0x1b2 bytes 
PresentationFramework.dll!System.Windows.Documents.TextEditorTyping.TextInputItem.Do() + 0x20 bytes 
PresentationFramework.dll!System.Windows.Documents.TextEditorTyping.ScheduleInput(System.Windows.Documents.TextEditor This, System.Windows.Documents.TextEditorTyping.InputItem item) + 0x2f bytes  
PresentationFramework.dll!System.Windows.Documents.TextEditorTyping.OnTextInput(object sender, System.Windows.Input.TextCompositionEventArgs e) + 0x16c bytes   
PresentationFramework.dll!System.Windows.Controls.Primitives.TextBoxBase.OnTextInput(System.Windows.Input.TextCompositionEventArgs e) + 0x35 bytes  
PresentationCore.dll!System.Windows.UIElement.OnTextInputThunk(object sender, System.Windows.Input.TextCompositionEventArgs e) + 0x6f bytes 
PresentationCore.dll!System.Windows.Input.TextCompositionEventArgs.InvokeEventHandler(System.Delegate genericHandler, object genericTarget) + 0x31 bytes    
PresentationCore.dll!System.Windows.RoutedEventArgs.InvokeHandler(System.Delegate handler, object target) + 0x29 bytes  
PresentationCore.dll!System.Windows.RoutedEventHandlerInfo.InvokeHandler(object target, System.Windows.RoutedEventArgs routedEventArgs) + 0x3e bytes    
PresentationCore.dll!System.Windows.EventRoute.InvokeHandlersImpl(object source, System.Windows.RoutedEventArgs args, bool reRaised) + 0xbe bytes   
PresentationCore.dll!System.Windows.UIElement.RaiseEventImpl(System.Windows.DependencyObject sender, System.Windows.RoutedEventArgs args) + 0x79 bytes  
PresentationCore.dll!System.Windows.UIElement.RaiseTrustedEvent(System.Windows.RoutedEventArgs args) + 0x41 bytes   
PresentationCore.dll!System.Windows.UIElement.RaiseEvent(System.Windows.RoutedEventArgs args, bool trusted) + 0x2c bytes    
PresentationCore.dll!System.Windows.Input.InputManager.ProcessStagingArea() + 0x1ff bytes   
PresentationCore.dll!System.Windows.Input.InputManager.ProcessInput(System.Windows.Input.InputEventArgs input) + 0x45 bytes 
PresentationCore.dll!System.Windows.Input.TextCompositionManager.UnsafeCompleteComposition(System.Windows.Input.TextComposition composition) + 0x7e bytes   
PresentationCore.dll!System.Windows.Input.TextCompositionManager.PostProcessInput(object sender, System.Windows.Input.ProcessInputEventArgs e) + 0x41d bytes    
PresentationCore.dll!System.Windows.Input.InputManager.RaiseProcessInputEventHandlers(System.Windows.Input.ProcessInputEventHandler postProcessInput, System.Windows.Input.ProcessInputEventArgs processInputEventArgs) + 0x9d bytes    
PresentationCore.dll!System.Windows.Input.InputManager.ProcessStagingArea() + 0x23b bytes   
PresentationCore.dll!System.Windows.Input.InputManager.ProcessInput(System.Windows.Input.InputEventArgs input) + 0x45 bytes 
PresentationCore.dll!System.Windows.Input.TextCompositionManager.UnsafeStartComposition(System.Windows.Input.TextComposition composition) + 0x74 bytes  
PresentationCore.dll!System.Windows.Input.TextCompositionManager.PostProcessInput(object sender, System.Windows.Input.ProcessInputEventArgs e) + 0x6ca bytes    
PresentationCore.dll!System.Windows.Input.InputManager.RaiseProcessInputEventHandlers(System.Windows.Input.ProcessInputEventHandler postProcessInput, System.Windows.Input.ProcessInputEventArgs processInputEventArgs) + 0x9d bytes    
PresentationCore.dll!System.Windows.Input.InputManager.ProcessStagingArea() + 0x23b bytes   
PresentationCore.dll!System.Windows.Input.InputManager.ProcessInput(System.Windows.Input.InputEventArgs input) + 0x45 bytes 
PresentationCore.dll!System.Windows.Input.InputProviderSite.ReportInput(System.Windows.Input.InputReport inputReport) + 0x62 bytes  
PresentationCore.dll!System.Windows.Interop.HwndKeyboardInputProvider.ProcessTextInputAction(System.IntPtr hwnd, MS.Internal.Interop.WindowMessage msg, System.IntPtr wParam, System.IntPtr lParam, ref bool handled) + 0x189 bytes 
PresentationCore.dll!System.Windows.Interop.HwndSource.OnPreprocessMessage(object param) + 0x2c6 bytes  
WindowsBase.dll!System.Windows.Threading.ExceptionWrapper.InternalRealCall(System.Delegate callback, object args, int numArgs) + 0x53 bytes 
WindowsBase.dll!MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(object source, System.Delegate method, object args, int numArgs, System.Delegate catchHandler) + 0x42 bytes    
WindowsBase.dll!System.Windows.Threading.Dispatcher.InvokeImpl(System.Windows.Threading.DispatcherPriority priority, System.TimeSpan timeout, System.Delegate method, object args, int numArgs) + 0xb4 bytes    
PresentationCore.dll!System.Windows.Interop.HwndSource.OnPreprocessMessageThunk(ref System.Windows.Interop.MSG msg, ref bool handled) + 0xc6 bytes  
PresentationCore.dll!System.Windows.Interop.HwndSource.WeakEventPreprocessMessage.OnPreprocessMessage(ref System.Windows.Interop.MSG msg, ref bool handled) + 0x35 bytes    
WindowsBase.dll!System.Windows.Interop.ComponentDispatcherThread.RaiseThreadMessage(ref System.Windows.Interop.MSG msg) + 0x3d bytes    
WindowsBase.dll!System.Windows.Threading.Dispatcher.PushFrameImpl(System.Windows.Threading.DispatcherFrame frame) + 0xaa bytes  
WindowsBase.dll!System.Windows.Threading.Dispatcher.PushFrame(System.Windows.Threading.DispatcherFrame frame) + 0x49 bytes  
PresentationFramework.dll!System.Windows.Window.ShowHelper(object booleanBox) + 0x181 bytes 
PresentationFramework.dll!System.Windows.Window.Show() + 0x61 bytes 
PresentationFramework.dll!System.Windows.Window.ShowDialog() + 0x2d0 bytes  
JieMeiTaoInventoryManager.exe!JieMeiTaoInventoryManager.MainWindow.NewItemCommandBinding_Executed(object sender, System.Windows.Input.ExecutedRoutedEventArgs e) Line 291 + 0xd bytes   C#
PresentationCore.dll!System.Windows.Input.CommandBinding.OnExecuted(object sender, System.Windows.Input.ExecutedRoutedEventArgs e) + 0x63 bytes 
PresentationCore.dll!System.Windows.Input.CommandManager.ExecuteCommandBinding(object sender, System.Windows.Input.ExecutedRoutedEventArgs e, System.Windows.Input.CommandBinding commandBinding) + 0x98 bytes  
PresentationCore.dll!System.Windows.Input.CommandManager.FindCommandBinding(System.Windows.Input.CommandBindingCollection commandBindings, object sender, System.Windows.RoutedEventArgs e, System.Windows.Input.ICommand command, bool execute) + 0x10a bytes  
PresentationCore.dll!System.Windows.Input.CommandManager.FindCommandBinding(object sender, System.Windows.RoutedEventArgs e, System.Windows.Input.ICommand command, bool execute) + 0x1a0 bytes 
PresentationCore.dll!System.Windows.Input.CommandManager.OnExecuted(object sender, System.Windows.Input.ExecutedRoutedEventArgs e) + 0x26 bytes 
PresentationCore.dll!System.Windows.UIElement.OnExecutedThunk(object sender, System.Windows.Input.ExecutedRoutedEventArgs e) + 0x59 bytes   
PresentationCore.dll!System.Windows.Input.ExecutedRoutedEventArgs.InvokeEventHandler(System.Delegate genericHandler, object target) + 0x3e bytes    
PresentationCore.dll!System.Windows.RoutedEventArgs.InvokeHandler(System.Delegate handler, object target) + 0x29 bytes  
PresentationCore.dll!System.Windows.RoutedEventHandlerInfo.InvokeHandler(object target, System.Windows.RoutedEventArgs routedEventArgs) + 0x3e bytes    
PresentationCore.dll!System.Windows.EventRoute.InvokeHandlersImpl(object source, System.Windows.RoutedEventArgs args, bool reRaised) + 0xbe bytes   
PresentationCore.dll!System.Windows.UIElement.RaiseEventImpl(System.Windows.DependencyObject sender, System.Windows.RoutedEventArgs args) + 0x79 bytes  
PresentationCore.dll!System.Windows.UIElement.RaiseTrustedEvent(System.Windows.RoutedEventArgs args) + 0x41 bytes   
PresentationCore.dll!System.Windows.UIElement.RaiseEvent(System.Windows.RoutedEventArgs args, bool trusted) + 0x2c bytes    
PresentationCore.dll!System.Windows.Input.RoutedCommand.ExecuteImpl(object parameter, System.Windows.IInputElement target, bool userInitiated) + 0x111 bytes    
PresentationCore.dll!System.Windows.Input.RoutedCommand.ExecuteCore(object parameter, System.Windows.IInputElement target, bool userInitiated) + 0x5b bytes 
PresentationCore.dll!System.Windows.Input.CommandManager.TranslateInput(System.Windows.IInputElement targetElement, System.Windows.Input.InputEventArgs inputEventArgs) + 0x3df bytes   
PresentationCore.dll!System.Windows.UIElement.OnKeyDownThunk(object sender, System.Windows.Input.KeyEventArgs e) + 0x67 bytes   
PresentationCore.dll!System.Windows.Input.KeyEventArgs.InvokeEventHandler(System.Delegate genericHandler, object genericTarget) + 0x34 bytes    
PresentationCore.dll!System.Windows.RoutedEventArgs.InvokeHandler(System.Delegate handler, object target) + 0x29 bytes  
PresentationCore.dll!System.Windows.RoutedEventHandlerInfo.InvokeHandler(object target, System.Windows.RoutedEventArgs routedEventArgs) + 0x3e bytes    
PresentationCore.dll!System.Windows.EventRoute.InvokeHandlersImpl(object source, System.Windows.RoutedEventArgs args, bool reRaised) + 0xbe bytes   
PresentationCore.dll!System.Windows.UIElement.RaiseEventImpl(System.Windows.DependencyObject sender, System.Windows.RoutedEventArgs args) + 0x79 bytes  
PresentationCore.dll!System.Windows.UIElement.RaiseTrustedEvent(System.Windows.RoutedEventArgs args) + 0x41 bytes   
PresentationCore.dll!System.Windows.UIElement.RaiseEvent(System.Windows.RoutedEventArgs args, bool trusted) + 0x2c bytes    
PresentationCore.dll!System.Windows.Input.InputManager.ProcessStagingArea() + 0x1ff bytes   
PresentationCore.dll!System.Windows.Input.InputManager.ProcessInput(System.Windows.Input.InputEventArgs input) + 0x45 bytes 
PresentationCore.dll!System.Windows.Input.InputProviderSite.ReportInput(System.Windows.Input.InputReport inputReport) + 0x62 bytes  
PresentationCore.dll!System.Windows.Interop.HwndKeyboardInputProvider.ReportInput(System.IntPtr hwnd, System.Windows.Input.InputMode mode, int timestamp, System.Windows.Input.RawKeyboardActions actions, int scanCode, bool isExtendedKey, bool isSystemKey, int virtualKey) + 0x101 bytes    
PresentationCore.dll!System.Windows.Interop.HwndKeyboardInputProvider.ProcessKeyAction(ref System.Windows.Interop.MSG msg, ref bool handled) + 0xf4 bytes   
PresentationCore.dll!System.Windows.Interop.HwndSource.CriticalTranslateAccelerator(ref System.Windows.Interop.MSG msg, System.Windows.Input.ModifierKeys modifiers) + 0x8f bytes   
PresentationCore.dll!System.Windows.Interop.HwndSource.OnPreprocessMessage(object param) + 0x106 bytes  
WindowsBase.dll!System.Windows.Threading.ExceptionWrapper.InternalRealCall(System.Delegate callback, object args, int numArgs) + 0x53 bytes 
WindowsBase.dll!MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(object source, System.Delegate method, object args, int numArgs, System.Delegate catchHandler) + 0x42 bytes    
WindowsBase.dll!System.Windows.Threading.Dispatcher.InvokeImpl(System.Windows.Threading.DispatcherPriority priority, System.TimeSpan timeout, System.Delegate method, object args, int numArgs) + 0xb4 bytes    
PresentationCore.dll!System.Windows.Interop.HwndSource.OnPreprocessMessageThunk(ref System.Windows.Interop.MSG msg, ref bool handled) + 0xc6 bytes  
PresentationCore.dll!System.Windows.Interop.HwndSource.WeakEventPreprocessMessage.OnPreprocessMessage(ref System.Windows.Interop.MSG msg, ref bool handled) + 0x35 bytes    
WindowsBase.dll!System.Windows.Interop.ComponentDispatcherThread.RaiseThreadMessage(ref System.Windows.Interop.MSG msg) + 0x3d bytes    
WindowsBase.dll!System.Windows.Threading.Dispatcher.PushFrameImpl(System.Windows.Threading.DispatcherFrame frame) + 0xaa bytes  
WindowsBase.dll!System.Windows.Threading.Dispatcher.PushFrame(System.Windows.Threading.DispatcherFrame frame) + 0x49 bytes  
PresentationFramework.dll!System.Windows.Application.RunDispatcher(object ignore) + 0x5b bytes  
PresentationFramework.dll!System.Windows.Application.RunInternal(System.Windows.Window window) + 0x74 bytes 
PresentationFramework.dll!System.Windows.Application.Run(System.Windows.Window window) + 0x2b bytes 
PresentationFramework.dll!System.Windows.Application.Run() + 0x1b bytes 
JieMeiTaoInventoryManager.exe!JieMeiTaoInventoryManager.App.Main() + 0x5e bytes C#
[Native to Managed Transition]  
[Managed to Native Transition]  
mscorlib.dll!System.AppDomain.ExecuteAssembly(string assemblyFile, System.Security.Policy.Evidence assemblySecurity, string[] args) + 0x6d bytes    
Microsoft.VisualStudio.HostingProcess.Utilities.dll!Microsoft.VisualStudio.HostingProcess.HostProc.RunUsersAssembly() + 0x2a bytes  
mscorlib.dll!System.Threading.ThreadHelper.ThreadStart_Context(object state) + 0x63 bytes   
mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state, bool ignoreSyncCtx) + 0xb0 bytes    
mscorlib.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state) + 0x2c bytes    
mscorlib.dll!System.Threading.ThreadHelper.ThreadStart() + 0x44 bytes   
[Native to Managed Transition] 
```

**更新：** 我注意到每次我的程序点击 Validate 方法时都会重复调用以下行。

```
 PresentationFramework.dll!MS.Internal.Data.PropertyPathWorker.SetValue(object item, object value) + 0x171 bytes 
PresentationFramework.dll!MS.Internal.Data.ClrBindingWorker.UpdateValue(object value) + 0xa3 bytes  
PresentationFramework.dll!System.Windows.Data.BindingExpression.UpdateSource(object value) + 0x99 bytes 
PresentationFramework.dll!System.Windows.Data.BindingExpressionBase.UpdateValue() + 0x66 bytes  
PresentationFramework.dll!System.Windows.Data.BindingExpression.Update(bool synchronous) + 0x4f bytes   
PresentationFramework.dll!System.Windows.Data.BindingExpressionBase.Dirty() + 0x30 bytes    
PresentationFramework.dll!System.Windows.Data.BindingExpression.SetValue(System.Windows.DependencyObject d, System.Windows.DependencyProperty dp, object value) + 0x27 bytes    
WindowsBase.dll!System.Windows.DependencyObject.SetValueCommon(System.Windows.DependencyProperty dp, object value, System.Windows.PropertyMetadata metadata, bool coerceWithDeferredReference, bool coerceWithCurrentValue, System.Windows.OperationType operationType, bool isInternal) + 0x3c7 bytes 
```

**更新 2** 如果我的 Validate 方法返回 new ValidationResult(false,xxx)，则不会发生无限循环。我想知道 ValidationResult(false,xxx) 是否在某处触发了停止循环的事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T13:24:02.917

尝试使用此验证（您必须有一个事件）然后进行其他验证..如果大于 0 且小于 5

```
private bool AreAllValidNumericChars(string str)
{
  foreach (char c in str)
  {
    if (c != '.')
    {
      if (!Char.IsNumber(c))
        return false;
    }
  }
  return true;
}

private void textBoxMs_PreviewTextInput(object sender, TextCompositionEventArgs e)
{
  e.Handled = !AreAllValidNumericChars(e.Text) && isGreaterOrLess(e.Text);
}

public bool isGreaterOrLess(string text)
{
  int number = Convert.toInt32(text);
  if(number>0 && number<5)
  {
    return true;
  }
  else
  {
    return false
  }

} 
```

# .net - 涉及 .NET 中数据格式之间转换的设计

> ID：16058657
> 
> 赞同：0
> 
> 时间：2013-04-17T11:19:37.280
> 
> 标签：.net, entity-framework, type-conversion

我们正在构建一个新的 Web 服务，它将以特定的公共元数据格式返回数据。

我们目前有一个数据库系统，它是围绕相同的格式设计的，但并不完全符合它，因为需要在不丢失任何数据的情况下迁移和维护预先存在的数据。

为了构建使用数据库的应用程序，我创建了一个程序集，其中包含一个实体框架项目。然后，任何希望与数据库交互的解决方案都可以使用该程序集。

对于 Web 服务项目，公共元数据格式有一个 xml 模式，我使用 .NET 的 xsd.exe 工具将其转换为 C# 类（非常方便）。从本质上讲，Web 服务将从数据库中返回对象，但采用上述元数据格式定义的格式。这意味着需要进行某种形式的翻译/转换才能将实体框架对象转换为公共元数据格式对象，然后由 Web 服务返回。

假设我有 DBEntities.dll 和 PublicMetadataFormat.dll，那么在设计方面“翻译”这些格式的最佳方式是什么？

以下是我想到的可能性：

*   创建一些在两种格式之间转换的静态扩展类。例如，EFEntity.ToMetadataFormat() 或 MetadataFormat.ToEFEntity()。
*   在各自的项目中，实现显式或隐式运算符，以允许在两种格式之间进行转换。
*   在每个上实现 IConvertible，以允许在两种格式之间进行转换。
*   创建两个 TypeConverter 类，并将它们应用于每种格式。

从上面我真正喜欢的唯一选择是静态扩展类的想法，因为它允许两个程序集保持不变，并使它们不耦合。它还允许跨解决方案的转换的不同实现。

最终我想做的是也为公共元数据格式创建一个 LINQ 提供程序，就像已经有实体框架对象一样，我可以向其中注入一个“转换器”对象，该对象控制如何将数据库对象转换为元数据对象。

有没有人在像这样的两种松散相关的格式之间进行翻译或转换的经验？如何最好地接近它？

问候，尼克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T14:54:36.327

我自己没用过，但这听起来像是[AutoMapper的工作](http://automapper.org/)

# php - 使用布尔 php 计算 mysql 中的列总和

> ID：16058660
> 
> 赞同：1
> 
> 时间：2013-04-17T11:19:52.057
> 
> 标签：php, mysql, checkbox, sum

我有一个名为费用的表，它包括以下列：

```
ID, amount_1, amount_2, amount_1_paid, amount_2_paid, total 
```

`amount_x_paid`是 a`TINYINT`所以它用于复选框。

我想做的是根据`amount_x_paid`值（1,0）计算总数

所以让我们说：

```
amount_1 = 100
amount_2 = 200
amount_1_paid = 1
amount_2_paid = 0 
```

这应该计算

```
 total = 100 
```

我怎样才能在php中实现这一点？

php 文件将是一项计划任务作业，每天运行一次以计算总数。

这可以解决问题：

```
SELECT
 FORMAT(
   SUM(
     CASE
       WHEN amount_1_paid = 0 THEN (total + amount_1)
 ELSE (total - amount_1)
       END
    ),
    0
  )
AS total
  FROM
    expenses  
    WHERE ID = '1'; 
```

我怎样才能把它放在一个循环中并更新所有记录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:23:08.473

要`amount_`根据`amount_x_paid`列选择字段，可以使用`CASE`表达式。像这样的东西：

```
SELECT
  CASE 
    WHEN amount_1_paid = 1 THEN amount_1 
    WHEN amount_2_paid = 1 THEN amount_2  
    ELSE 0
  END AS Amount,
  ...
FROM tablename; 
```

如果您正在寻找这些金额的总和，请在子查询中使用它：

```
SELECT 
  SUM(Amount) AS Total,
  ...
FROM
(
    SELECT
      CASE 
        WHEN amount_1_paid = 1 THEN amount_1 
        WHEN amount_2_paid = 1 THEN amount_2  
        ELSE 0
      END AS Amount,
      ...
    FROM tablename
) AS sub; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T11:26:20.937

在你的 php 文件中，你执行一个 mysql 查询：

```
SELECT SUM(amount_1*amount_1_paid + amount_2*amount_2_paid) AS "total"
FROM expenses; 
```

更新：当您想要按列计算总计时，您可能会考虑不保存它，因为总计完全取决于 amount_1_paid、amount_2_paid、amound_1 和 amound_2。

我的更新查询（不需要循环，会更新整个表）

```
UPDATE expenses SET total=amount_1*amount_1_paid + amount_2*amount_2_paid; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-02T07:57:02.890

这段代码成功了：

```
 <?php

            include('dbcon.php');

            $query = "SELECT recordno,poso10,poso11,poso12,poso13,poso14,poso15,poso16,poso17,poso18,poso19,poso20,poso21,poso30,poso31,poso32,poso33,poso34,poso41,poso42,poso50,poso51,poso52,poso53,poso60,poso61,poso62,poso63,poso70,poso71,poso10_check,poso11_check,poso12_check,poso13_check,poso14_check,poso15_check,poso16_check,poso17_check,poso18_check,
            poso19_check,poso20_check,poso21_check,poso30_check,poso31_check,poso32_check,poso33_check,poso34_check,poso40_check,
            poso41_check,poso42_check,poso50_check,poso51_check,poso52_check,poso53_check,poso60_check,poso61_check,poso62_check,
            poso63_check,poso70_check,poso71_check,synolo40_42_At_Pa_Bo,
            (if(isnull(poso10),0,poso10) + 
            if(isnull(poso11),0,poso11) + 
            if(isnull(poso12),0,poso12) +
            if(isnull(poso13),0,poso13) + 
            if(isnull(poso14),0,poso14) + 
            if(isnull(poso15),0,poso15) + 
            if(isnull(poso16),0,poso16) + 
            if(isnull(poso17),0,poso17) + 
            if(isnull(poso18),0,poso18) + 
            if(isnull(poso19),0,poso19) + 
            if(isnull(poso20),0,poso20) + 
            if(isnull(poso21),0,poso21) + 
            if(isnull(poso30),0,poso30) + 
            if(isnull(poso31),0,poso31) + 
            if(isnull(poso32),0,poso32) + 
            if(isnull(poso33),0,poso33) + 
            if(isnull(poso34),0,poso34) +  
            if(isnull(poso41),0,poso41) + 
            if(isnull(poso42),0,poso42) + 
            if(isnull(poso50),0,poso50) + 
            if(isnull(poso51),0,poso51) + 
            if(isnull(poso52),0,poso52) + 
            if(isnull(poso53),0,poso53) + 
            if(isnull(poso60),0,poso60) + 
            if(isnull(poso61),0,poso61) + 
            if(isnull(poso62),0,poso62) + 
            if(isnull(poso63),0,poso63) + 
            if(isnull(poso70),0,poso70) + 
            if(isnull(poso71),0,poso71) +
            if(isnull(synolo40_42_At_Pa_Bo),0,synolo40_42_At_Pa_Bo)
            )as synolo

            FROM
            (SELECT
            recordno,poso10_check,poso11_check,poso12_check,poso13_check,poso14_check,poso15_check,poso16_check,poso17_check,poso18_check,
            poso19_check,poso20_check,poso21_check,poso30_check,poso31_check,poso32_check,poso33_check,poso34_check,poso40_check,
            poso41_check,poso42_check,poso50_check,poso51_check,poso52_check,poso53_check,poso60_check,poso61_check,poso62_check,
            poso63_check,poso70_check,poso71_check,
            (CASE WHEN poso10_check = '1' THEN poso10 END) AS poso10,
            (CASE WHEN poso11_check = '1' THEN poso11 END) AS poso11,
            (CASE WHEN poso12_check = '1' THEN poso12 END) AS poso12,
            (CASE WHEN poso13_check = '1' THEN poso13 END) AS poso13,
            (CASE WHEN poso14_check = '1' THEN poso14 END) AS poso14,
            (CASE WHEN poso15_check = '1' THEN poso15 END) AS poso15,
            (CASE WHEN poso16_check = '1' THEN poso16 END) AS poso16,
            (CASE WHEN poso17_check = '1' THEN poso17 END) AS poso17,
            (CASE WHEN poso18_check = '1' THEN poso18 END) AS poso18,
            (CASE WHEN poso19_check = '1' THEN poso19 END) AS poso19,
            (CASE WHEN poso20_check = '1' THEN poso20 END) AS poso20,
            (CASE WHEN poso21_check = '1' THEN poso21 END) AS poso21,
            (CASE WHEN poso30_check = '1' THEN poso30 END) AS poso30,
            (CASE WHEN poso31_check = '1' THEN poso31 END) AS poso31,
            (CASE WHEN poso32_check = '1' THEN poso32 END) AS poso32,
            (CASE WHEN poso33_check = '1' THEN poso33 END) AS poso33,
            (CASE WHEN poso34_check = '1' THEN poso34 END) AS poso34,
            (CASE WHEN poso40_check = '1' THEN synolo40_42_At_Pa_Bo END) AS synolo40_42_At_Pa_Bo,
            (CASE WHEN poso41_check = '1' THEN poso41 END) AS poso41,
            (CASE WHEN poso42_check = '1' THEN poso42 END) AS poso42,
            (CASE WHEN poso50_check = '1' THEN poso50 END) AS poso50,
            (CASE WHEN poso51_check = '1' THEN poso51 END) AS poso51,
            (CASE WHEN poso52_check = '1' THEN poso52 END) AS poso52,
            (CASE WHEN poso53_check = '1' THEN poso53 END) AS poso53,
            (CASE WHEN poso60_check = '1' THEN poso60 END) AS poso60,
            (CASE WHEN poso61_check = '1' THEN poso61 END) AS poso61,
            (CASE WHEN poso62_check = '1' THEN poso62 END) AS poso62,
            (CASE WHEN poso63_check = '1' THEN poso63 END) AS poso63,
            (CASE WHEN poso70_check = '1' THEN poso70 END) AS poso70,
            (CASE WHEN poso71_check = '1' THEN poso71 END) AS poso71

            FROM 010_08_exoda)a;";

            $synolo = mysql_query($query);
            $count=mysql_num_rows($synolo);

            while($row = mysql_fetch_assoc($synolo))
            {
                    $recordno = $row['recordno'];
                    $synolo2 = $row['synolo'];

            mysql_query("UPDATE 010_08_exoda SET synolo_paid='$synolo2' where recordno='$recordno'");  

                }
            ?> 
```

# jquery - 将变量传递给 jQuery jsonp

> ID：16058661
> 
> 赞同：0
> 
> 时间：2013-04-17T11:19:54.790
> 
> 标签：jquery, jsonp

我们有一个大学校园数据库，我正在尝试为每个州创建链接。在我们的网站上，它会是一个被点击的 SVG 地图，但出于演示目的，它只是一个文本链接。我不知道如何接线。

我在一些 json 结果中进行了硬编码，以确保部分代码有效，但我不确定如何制作，所以当点击页面上的链接时，它会将状态传递给 json 请求。

这是演示 HTML

```
<a href="http://ml.uscm.org/ministries.json?state=WY&active=true&callback=Wyoming">Wyoming</a>
<a href="http://ml.uscm.org/ministries.json?state=WY&active=true&callback=Florida">Florida</a>

<span class="results"></span> 
```

这是JS

```
$(document).ready(function () {
    var jsonp = '[{"city":"Casper","enrollment":"4426","name":"Casper College","state":"WY","tuition":2232,"url":"http://www.campusventures.org","zip":"82601-2458","id":3928},{"city":"Riverton","enrollment":"2316","name":"Central Wyoming College","state":"WY","tuition":2472,"url":"","zip":"82501-1520","id":818},{"city":"Torrington","enrollment":"1965","name":"Eastern Wyoming College","state":"WY","tuition":2376,"url":"http://www.campusventures.org","zip":"82240-1699","id":819},{"city":"Cheyenne","enrollment":"5302","name":"Laramie County Community College","state":"WY","tuition":2640,"url":"","zip":"82007-3299","id":820},{"city":"Sheridan","enrollment":"4296","name":"Northern Wyoming Community College District","state":"WY","tuition":2398,"url":"","zip":"82801-1500","id":5825},{"city":"Laramie","enrollment":"13922","name":"University of Wyoming","state":"WY","tuition":4278,"url":"http://www.cvuw.com","zip":"82071-3434","id":4073},{"city":"Rock Springs","enrollment":"4013","name":"Western Wyoming Community College","state":"WY","tuition":1145,"url":"","zip":"82902-0428","id":823}]';
    var results = '';
    var obj = $.parseJSON(jsonp);
    $.each(obj, function () {
    results += "<h3><a href='http://ml.uscm.org/ministries/" + this['id'] + ".json" + "'>" + this['name'] + "</a></h3>";
    results += this['city'] + "<br/>";

    $('span.results').html(results);

}); 
```

});

这是迄今为止我所拥有的一个[jsfiddle示例。](http://jsfiddle.net/richcoy/nfNMr/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:24:16.977

抱歉，如果我弄错了，但是您的意思是像这样将状态作为变量简单地传递到 JSON 请求中吗？

```
?state=" + this['state'] + " 
```

[http://jsfiddle.net/richcoy/nfNMr/1/](http://jsfiddle.net/richcoy/nfNMr/1/)

# c# - 使用无效键值访问的 JArray 值

> ID：16058663
> 
> 赞同：0
> 
> 时间：2013-04-17T11:20:01.150
> 
> 标签：c#, json, json.net

尝试挖掘 json 数据时出现以下错误。

使用无效键值访问的 JArray 值：“RateInfos”。预期的数组位置索引。

任何人都可以帮助解决这个问题，我正在尝试获取 currentAllotment: 3 的值，它是从提供的 json 底部向上的 15 行。

```
customerSessionId: "0ABAA82A-4307-A913-E172-4D238D901107",
    numberOfRoomsRequested: 1,
    moreResultsAvailable: true,
    cacheKey: "-73d4307a:13e174d238d:-10fe",
    cacheLocation: "10.186.168.42:7301",
    cachedSupplierResponse: {
        @matchedLocale: "true",
        @matchedCurrency: "true",
        @tpidUsed: "5101",
        @otherOverheadTime: "1",
        @candidatePreptime: "98",
        @supplierResponseTime: "498",
        @supplierResponseNum: "1",
        @supplierRequestNum: "207",
        @cachedTime: "0",
        @supplierCacheTolerance: "NOT_SUPPORTED"
    },
    HotelList: {
        @activePropertyCount: "224",
        @size: "1",
        HotelSummary: {
            @ubsScore: "15815285",
            @order: "0",
            hotelId: 161395,
            name: "Larkspur Landing Bellevue - An All-Suite Hotel",
            address1: "15805 Se 37th St",
            city: "Bellevue",
            stateProvinceCode: "WA",
            postalCode: 98006,
            countryCode: "US",
            airportCode: "SEA",
            supplierType: "E",
            propertyCategory: 1,
            hotelRating: 3,
            confidenceRating: 95,
            amenityMask: 7823362,
            tripAdvisorRating: 4,
            tripAdvisorReviewCount: 81,
            tripAdvisorRatingUrl: "http://www.tripadvisor.com/img/cdsi/img2/ratings/traveler/4.0-12345-4.gif",
            locationDescription: "Near Bellevue College",
            shortDescription: "&lt;p&gt;&lt;b&gt;Location. &lt;/b&gt; &lt;br /&gt;Located in Bellevue, Larkspur Landing Bellevue - An All-Suite Hotel is in the suburbs and close to Bellevue College, T-Mobile USA Headquarters, and Factoria Mall. Nearby",
            highRate: 64.45,
            lowRate: 51.56,
            rateCurrencyCode: "GBP",
            latitude: 47.57755,
            longitude: -122.13193,
            proximityDistance: 2.0668056,
            proximityUnit: "MI",
            hotelInDestination: true,
            thumbNailUrl: "/hotels/1000000/130000/127100/127040/127040_14_t.jpg",
            deepLink: "http://travel.ian.com/index.jsp?pageName=hotAvail&amp;cid=55505&amp;hotelID=161395&amp;mode=2&amp;numberOfRooms=1&amp;room-0-adult-total=2&amp;room-0-child-total=0&amp;arrivalMonth=4&amp;arrivalDay=17&amp;departureMonth=4&amp;departureDay=19&amp;showInfo=true&amp;locale=en_US&amp;currencyCode=GBP",
            RoomRateDetailsList: {
                RoomRateDetails: {
                    roomTypeCode: 200207592,
                    rateCode: 201183732,
                    maxRoomOccupancy: 2,
                    quotedRoomOccupancy: 2,
                    minGuestAge: 0,
                    roomDescription: "Studio Suite Accessible",
                    propertyAvailable: true,
                    propertyRestricted: false,
                    expediaPropertyId: 127040,
                    RateInfos: {
                        @size: "1",
                        RateInfo: {
                            @rateChange: "false",
                            @promo: "true",
                            @priceBreakdown: "true",
                            RoomGroup: {
                                Room: {
                                    numberOfAdults: 2,
                                    numberOfChildren: 0,
                                    rateKey: "adbdfb1a-df03-4577-9970-ed62f4c84a17"
                                }
                            },
                            ChargeableRateInfo: {
                                @total: "117.14",
                                @surchargeTotal: "14.02",
                                @grossProfitOnline: "18.82",
                                @grossProfitOffline: "11.21",
                                @nightlyRateTotal: "103.12",
                                @maxNightlyRate: "51.56",
                                @currencyCode: "GBP",
                                @commissionableUsdTotal: "158.4",
                                @averageRate: "51.56",
                                @averageBaseRate: "64.45",
                                NightlyRatesPerRoom: {
                                    @size: "2",
                                    NightlyRate: {
                                        0: {
                                            @promo: "true",
                                            @rate: "51.56",
                                            @baseRate: "64.45"
                                        },
                                        1: {
                                            @promo: "true",
                                            @rate: "51.56",
                                            @baseRate: "64.45"
                                        }
                                    }
                                },
                                Surcharges: {
                                    @size: "1",
                                    Surcharge: {
                                        @amount: "14.02",
                                        @type: "TaxAndServiceFee"
                                    }
                                }
                            },
                            nonRefundable: false,
                            rateType: "MerchantStandard",
                            promoId: 202578064,
                            promoDescription: "Sale! Save 20% on this Stay.",
                            promoType: "Standard",
                            currentAllotment: 3
                        }
                    },
                    ValueAdds: {
                        @size: "1",
                        ValueAdd: {
                            @id: "1024",
                            description: "Free High-Speed Internet"
                        }
                    }
                }
            }
        }
    }
} 
```

代码行抛出错误。

```
IList<JToken> rates = root["HotelListResponse"]["HotelList"]["HotelSummary"]["RateInfos"]["RateInfo"].Children().Values().ToList(); 
```

如果有人也可以向我展示一种比我正在做的深入研究 json 数据更简单的方法，我将不胜感激。

谢谢乔治

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-27T04:11:11.080

此 JSON 中没有数组。你应该用`JToken.Parse()`它来解析它。然后你可以使用 use`SelectToken`来提取你想要的值：

```
JToken token = JToken.Parse(json);

int currentAllotment = 
    token.SelectToken("HotelList.HotelSummary.RoomRateDetailsList.RoomRateDetails.RateInfos.RateInfo.currentAllotment")
         .Value<int>(); 
```

小提琴：[https ://dotnetfiddle.net/TFKpq5](https://dotnetfiddle.net/TFKpq5)

# java - 在 myeclipse 中从 xsd 生成 java 类

> ID：16058670
> 
> 赞同：2
> 
> 时间：2013-04-17T11:20:21.620
> 
> 标签：java, eclipse, jaxb, myeclipse

是否有任何用于 myeclipse 的 jaxb 插件通过提供 xsd 来生成 java 类？我已经尝试过 jars 并包含在 myeclipse 的 plugins 文件夹中，但没有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:24:32.103

在普通的 Eclipse 中，您可以右键单击 .xsd 文件，然后选择`Generate > JAXB Classes`. 您还必须确保已安装 JAXB，否则请先安装该插件。

如果您希望在 .xsd 文件更改时生成类，您可能还需要查看 JAXB-Maven 扩展之一。

# windows-8 - 如何将自定义位置设置为文件选择器/文件夹选择器的 SuggestedStartLocation

> ID：16058671
> 
> 赞同：3
> 
> 时间：2013-04-17T11:20:23.043
> 
> 标签：windows-8, windows-store-apps, winrt-xaml

由于 Windows 商店应用程序在所谓的沙盒环境中运行，我决定使用文件夹选择器来访问文件。我想在文件/文件夹选择器启动时向用户显示他的 %localappdata% 文件夹（C:\Users\Admin\AppData\Local）我找不到执行此操作的方法或设置任何自定义位置（“C\ testFolder") 而不是通过设置预定义的**PickerLocationId**枚举。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:47:42.807

这不可能。WinRT 没有任何将 ANY 文件夹设置为`SuggestedStartLocation`.

# java - 带除数的整数数组

> ID：16058681
> 
> 赞同：0
> 
> 时间：2013-04-17T11:20:51.743
> 
> 标签：java, arrays

我被一些非常基本的东西困住了。我需要获取一个整数数组，并在一个名为`divisibleIntegers`. 如果所有内容都可整除，则 main 方法将打印 true。

我可以创建数组；但是当我创建除数表达式时，我有点困惑。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:26:48.520

遍历数组，如果找到不与分母相除的元素，则返回false。例子：

```
boolean divisibleIntegers(int denom) {
    for (int elem : myArray) {
         if (elem % denom != 0)
              return false;
    } 
    return true;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:27:12.983

您应该检查数组的所有元素，如果存在一个不能被 整除的元素，则`n`返回`false`，否则（所有元素都可以被 整除`n`），返回`true`。

[在此处](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op1.html)阅读有关提醒运算符的信息。

```
public static boolean divisibleIntegers(int[] arr, int n) {
    for(int num : arr) {
        if (!(num % n)) {
           return false;
        }
    }
    return true;
}

System.out.println(divisibleIntegers(new int[]{2,4,8}, 2)); //Will print true.
System.out.println(divisibleIntegers(new int[]{2,5,8}, 2)); //Will print false. 
```

# c# - 对于调用循环错误

> ID：16058682
> 
> 赞同：0
> 
> 时间：2013-04-17T11:20:55.340
> 
> 标签：c#, .net, for-loop

我有以下代码

```
List<WorkingRecord> recordListz = new List<WorkingRecord>();

-----other unrelated code----------

recordListz = IF_Export(out ifRecCount,out WrittenRecords);

for (int i = 0; i < recordListz.Count; i++)
{
//do something
} 
```

recordListz 被创建好（好吧，但稍后会更多），IF_Export 方法重新调整列表，然后如果我将断点放在 for 循环上并将鼠标悬停在 recordListz 对象上，它看起来很好（其中有 10 条记录）和计数也报告 10 条记录。但是，一旦我尝试执行循环，代码错误就会声称“对象未设置为对象的实例”（列表中的对象都不是空的）。另外，如果我此时快速观察对象，它声称该值为 ['' 为 null]。

现在谈谈首先创建recordListz对象的问题......在recordListz的实例化和方法调用之间实际上还有一些其他代码（与上面的代码完全无关）。最初我有以下代码

```
List<WorkingRecord> recordListz = IF_Export(out ifRecCount,out WrittenRecords); 
```

然而，这导致了“对象未设置为对象的实例”的错误，即使被调用的方法返回了一个完美的列表（通过在方法的返回行上放置一个断点来确认）。

然后我将其分解为以下内容

```
List<WorkingRecord> recordListz = new List<WorkingRecord>();
recordListz = IF_Export(out ifRecCount,out WrittenRecords); 
```

然而，这在第一行出错，“对象未设置为对象的实例”。我有完全相同的行，它在 IF_Export 方法中调用它工作正常并且与调用它的代码在同一个类中......

将这一行移到代码的顶部可以阻止它出错，但这会导致循环错误。

这到底是怎么回事，我以前从未见过。

- - - - - - - - - - - -更新 - - - - - - - - - -

好的，如果我有以下代码

```
-----other unrelated code----------
List<int> WrittenRecords=new List<int>();
List<WorkingRecord> recordListz = new List<WorkingRecord>();

recordListz = IF_Export(out ifRecCount,out WrittenRecords);

for (int i = 0; i < recordListz.Count; i++)
{
//do something
} 
```

recordListz 实例化行错误为“对象未设置为对象的实例

但是，如果我有以下代码

```
-----other unrelated code----------
List<WorkingRecord> recordLista = new List<WorkingRecord>();
List<int> WrittenRecords=new List<int>();
List<WorkingRecord> recordListz = new List<WorkingRecord>();

recordListz = IF_Export(out ifRecCount,out WrittenRecords);

for (int i = 0; i < recordListz.Count; i++)
{
//do something
} 
```

然后recordListz实例化仍然错误，但recordLista实例化工作正常！

另外，如果我有以下代码

```
-----other unrelated code----------
List<int> WrittenRecords=new List<int>();
List<WorkingRecord> recordLista = new List<WorkingRecord>();
List<WorkingRecord> recordListz = new List<WorkingRecord>();

recordListz = IF_Export(out ifRecCount,out WrittenRecords);

for (int i = 0; i < recordListz.Count; i++)
{
//do something
} 
```

recordLista 也可以正常工作！

--------另一个更新-----

如果我输入以下代码

```
-----other unrelated code----------
List<int> WrittenRecords=new List<int>();
List<WorkingRecord> recordLista = new List<WorkingRecord>();
List<WorkingRecord> recordListz = new List<WorkingRecord>();

recordLista = IF_Export(out ifRecCount,out WrittenRecords);

for (int i = 0; i < recordLista.Count; i++)
{
//do something
} 
```

现在是recordLista实例化错误............

--------更新3---------------

好的，我发现奇怪的事情正在发生。

代码位于 if 语句中

```
if (dsExportRecords != null && dsExportRecords.Tables[0].Rows.Count != 0) 
```

dsExportRecords 是一个数据集。如果我将我的代码立即放在 if 语句中，那么奇怪的事情就会发生，但是如果它就在 if 语句之前，那么一切都很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T10:04:12.780

我已经找到了问题（好吧我的代码现在仍然可以工作）

问题原来是一些 Linq 代码。

失败的循环如下

```
for (int i = 0; i < recordLista.Count; i++)
{
    int id = (from r in WrittenRecords where r == recordLista[i].RequestID select r).FirstOrDefault();
    if (id != 0)
    {
        //do something
    }
} 
```

书面记录是一个`List<int>`

ling 线从未被击中（因为一旦我进入循环就失败了），所以这看起来从来都不是问题。然而，这确实是问题所在。不知道为什么这条线也阻止了它上面的代码也无法工作（即实例化recordLista List），但它确实导致了整个地方的问题。

实际问题是 WrittenRecords 整数列表作为空列表返回（不是 null，但没有项目），尽管在进入循环之前，WrittenRecords 确实报告为空列表，一旦 try catch 捕获到错误，然后报告它作为 Null 仍然让我感到困惑.....但是，如果列表中没有项目，我永远不需要运行此代码，因此在 for 循环周围放置一个 if 语句，仅当 WrittenRecords 包含项目时才允许它运行已经解决了这个问题。

然而，我仍然不知道为什么循环根本无法执行，为什么 linq 代码失败，只是一个空列表，为什么空列表突然变成一个空列表，或者实际上为什么 linq 抛出的错误声明它是空的，或者为什么 linq 代码完全停止了 recordLista 的实例化。但至少我的代码现在可以工作了。

# python - Python解码“\u041b”字符串

> ID：16058683
> 
> 赞同：6
> 
> 时间：2013-04-17T11:20:57.913
> 
> 标签：python, unicode

我有 unicode 字符串，我确定它是 UTF-8，但我无法解码。字符串是`'\u041b\u0435\u0433\u043a\u043e\u0432\u044b\u0435'`. 如何解码？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-17T11:25:22.750

您可以使用`aString.decode('unicode_escape')`，它将 unicode 格式的字符串转换为 unicode 对象

```
>>> u'\u041b\u0435\u0433\u043a\u043e\u0432\u044b\u0435'
u'\u041b\u0435\u0433\u043a\u043e\u0432\u044b\u0435'
>>> '\u041b\u0435\u0433\u043a\u043e\u0432\u044b\u0435'.decode('unicode_escape')
u'\u041b\u0435\u0433\u043a\u043e\u0432\u044b\u0435'
>>> 
```

在你的情况下

```
>>> print '\u041b\u0435\u0433\u043a\u043e\u0432\u044b\u0435'.decode('unicode_escape')
Легковые
>>> 
```

# c++ - Makefile 目标始终与代码生成保持同步

> ID：16058685
> 
> 赞同：1
> 
> 时间：2013-04-17T11:21:03.263
> 
> 标签：c++, makefile, code-generation

我有一个基于配置文件生成多个 C++ .h 和 .cpp 文件的脚本。该脚本还生成一个名为“Makefile.inc”的文件，该文件包含一个具有所需目标文件名的变量，用于生成的 .cpp 文件。

Makefile.inc 文件示例（所有路径都是绝对路径）：

```
MESSAGE_OBJS = \
    /scratch/openttd/software/AtLargePlatform/branches/lucas/libatlarge/atlarge/messages/error-message.o \
    /scratch/openttd/software/AtLargePlatform/branches/lucas/libatlarge/atlarge/messages/challenge-request-message.o \
    /scratch/openttd/software/AtLargePlatform/branches/lucas/libatlarge/atlarge/messages/challenge-response-message.o \
    /scratch/openttd/software/AtLargePlatform/branches/lucas/libatlarge/atlarge/messages/login-message.o \
    /scratch/openttd/software/AtLargePlatform/branches/lucas/libatlarge/atlarge/messages/get-game-list-message.o \
    /scratch/openttd/software/AtLargePlatform/branches/lucas/libatlarge/atlarge/messages/game-list-response-message.o \
    /scratch/openttd/software/AtLargePlatform/branches/lucas/libatlarge/atlarge/messages/join-game-message.o \
    /scratch/openttd/software/AtLargePlatform/branches/lucas/libatlarge/atlarge/messages/connect-to-game-message.o \
    /scratch/openttd/software/AtLargePlatform/branches/lucas/libatlarge/atlarge/messages/leave-game-message.o 
```

[使用这个问题中的答案作为基础](https://stackoverflow.com/questions/10164924/code-generation-and-make-rule-expansion)，我创建了以下 Makefile：

```
# Include the generated makefile for messages.
# This includes a variable with all message targets
include atlarge/messages/Makefile.inc

# Create a variable with all source targets
LIBOBJS = \
    atlarge/exceptions.o \
    atlarge/message-factory.o \
    atlarge/envelope.o \
    atlarge/client.o \
    atlarge/user.o \
    atlarge/atlarge-protocol.o \
    atlarge/atlarge-gameserver.o \
    $(MESSAGE_OBJS)

CXXFLAGS += -W -Wall -I. -g -O3 -MD \
    `pkg-config jansson --cflags` \
    `libgcrypt-config --cflags` \
    `pkg-config glib-2.0 --cflags` \
    -fPIC -DDEBUG -DENABLE_LOGGING

PREFIX = /usr/local

# TODO use pkg-config for jansson
LDLIBS += -lm -ljansson -latlarge-util `libgcrypt-config --libs` `pkg-config glib-2.0 --libs` 
LDFLAGS += -shared -L/usr/local/lib

# Include automatically generated dependencies
-include $(LIBOBJS:.o=.d)

all: libatlarge.so

# If the message Makefile doesn't exist yet, generate it
atlarge/messages/Makefile.inc: atlarge/messages/messages.conf
    python ../common/messagegen.py -o ./atlarge/messages/ atlarge/messages/messages.conf

libatlarge.so: $(LIBOBJS)
    $(CXX) $(LDFLAGS) -o $@ $^ $(LDLIBS)

clean:
    @rm -f *.o
    @rm -f atlarge/*.o
    @rm -f atlarge/messages/*.o
    @rm -f atlarge/messages/*.cpp
    @rm -f atlarge/messages/*.h
    @rm -f atlarge/messages/Makefile.inc
    @rm -f atlarge/*.d
    @rm -f atlarge/messages/*.d
    @rm -f *.d
    @rm -f ../common/*.d
    @rm -f ../common/*.o
    @rm -f *.a
    @rm -f *.so
    @rm -f tags

install: libatlarge.so
    @install -m 0644 $^ $(PREFIX)/lib
    @install -m 0755 -d $(PREFIX)/include/atlarge
    @install -m 0755 -d $(PREFIX)/include/atlarge/messages
    @install -m 0644 -D atlarge/*.h $(PREFIX)/include/atlarge
    @install -m 0644 -D atlarge/messages/*.h $(PREFIX)/include/atlarge/messages
    @ldconfig
    @echo "Installed"

.PHONY: all clean install splint messages 
```

如您所见，我首先包含生成的 Makefile.inc。然后定义一个包含所有库目标文件的变量，该变量使用生成的 Makefile.inc 中声明的变量。之后，声明了一些带有编译器标志的变量。

为了使用*Makefile remaking*，我为生成的 Makefile.inc 添加了一个目标规则，因此如果 Makefile.inc（配置文件）的依赖关系比 Makefile.inc 更新，它会重新生成，并且 Make 将自行重启。

所以这是目标：

1.  检查是否需要（重新）生成 Makefile.inc。
2.  包括它
3.  在主 Makefile 的 $LIBOBJS 变量中使用 Makefile.inc 中的变量。

这实际上有效。如果我更新 messages.conf 文件，Make 会检测到这一点，并将运行 python 脚本。然后它将自行重启，包含新的 Makefile.inc，然后继续编译。

但是这里出现了不起作用的部分：如果我**不**更新 messages.conf 文件，而只更新 $LIBOBJS 列表中默认的 .h 或 .cpp 文件，Make 将不会继续编译。

例如，如果更改 client.cpp 而没有其他文件，我会收到以下错误：

```
make: `atlarge/exceptions.o' is up to date. 
```

好吧，很好，你发现 exceptions.o 是最新的，但我更改了 client.cpp，那么你为什么不开始编译那个呢？为什么 make 看到 LIBOBJS 中的第一个目标是最新的后立即退出？

谁知道是什么原因造成的，有什么解决办法？是否有更好的方法来处理使用 makefile 生成代码？

提前致谢。

注意：我也使用 gcc 生成的依赖文件，在我添加代码生成之前工作正常，所以我认为这不是问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:47:56.143

您需要将`all`目标移动到`include`. Make 总是构建它在 makefile 中看到的第一个目标，除非你在命令行上给出一个特定的目标。由于`include`在任何目标之前，定义的第一个目标`Makefile.inc`将是默认目标，当您运行时`make`，它将被构建。这就是为什么它尝试构建`exceptions.o`然后停止的原因。如果您`make all`显式运行，它将按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:41:15.303

目标文件对源文件或头文件的依赖关系在哪里？如果文件与 . 位于同一目录中，*则*有一个隐式规则应该获取依赖项，但如果它们不是，则必须提供自己的，或使用 VPATH（请参阅手册中的 §4.5.1 ）。您还需要为包含生成依赖项，请参阅手册中的 §4.1.4。`.cpp``.o`

# xslt - 两个命令有什么区别，一个是我从家输入的，另一个是从项目目录输入的？

> ID：16058686
> 
> 赞同：0
> 
> 时间：2013-04-17T11:21:06.270
> 
> 标签：xslt, ant, build.xml

**`xslt`当所有测试用例通过或失败时，**第一点**给出了不正确的报告，给出了一些旧的报告。我不知道它在哪里保存，因为我每次执行 build.xml 时都会清理（ant clean）旧报告并生成新报告**

 ****第二点**给出了完美的 xslt 报告，正如预期的那样（通过或失败）。

```
 1.kris@kris-Satellite-C660:~$ ant -buildfile /home/kris/Desktop/myproject/build.xml run 
```

和

```
 2\. kris@kris-Satellite-C660:~/Desktop/myproject $ ant run 
```**

# java - 静态变量在从一个活动移动到另一个活动时重新初始化

> ID：16058688
> 
> 赞同：1
> 
> 时间：2013-04-17T11:21:08.390
> 
> 标签：java, android, static-variables

我正在使用一个公共类名常量，其中有静态变量。

```
/*
 * Flags
 */
public static boolean gotCourse = false;
public static boolean quizTaken = false; 
```

我在第一个活动中更改这些标志并移动到第二个（我也退出第一个活动）但在第二个活动中我得到标志的初始值而不是更改的值。为什么我会遇到这个问题？？应用程序的静态变量是否有任何限制？

而且我也不想通过意图传递这些值，因为它们会使我的逻辑复杂化。

第一次活动的代码：

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_moviewrapper);
        Constants.quizTaken = extra.getBoolean("fromquiz", false);
        Log.d(Constants.TAG,"Got Course Value: "+Constants.gotCourse);
        if(Constants.gotCourse == false){
            mGetDataTask = new GetDataTask();
            mGetDataTask.execute();
            Constants.gotCourse = true;
        }else{
            Log.d(Constants.TAG,"In Play");
            playProgram();
        }
        Log.d(Constants.TAG,"Got Course Value: "+Constants.gotCourse);

    } 
```

我正在改变的地方`Constants.gotCourse = true;`

第二次活动代码：

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.d(Constants.TAG,"Got Course Value in Video Wrapper: "+Constants.gotCourse);
    } 
```

任务代码：

```
private class GetDataTask extends AsyncTask<String, Void, Void> {
    private final ProgressDialog dialog = new ProgressDialog(MovieWrapperActivity.this);

    // can use UI thread here
    protected void onPreExecute() {
        this.dialog.setMessage("Loading...");
        this.dialog.setCancelable(false);
        this.dialog.show();
    }

    // automatically done on worker thread (separate from UI thread)
    protected Void doInBackground(final String... args) {
        getCourse();
        return null;
    }

    // can use UI thread here
    protected void onPostExecute(final Void unused) {
        if (this.dialog.isShowing()) {
            this.dialog.dismiss();
            playProgram();
        }
    }
} 
```

节目播放功能：

```
private void playProgram(){
        Intent intent = new Intent(MovieWrapperActivity.this, VideoWrapperActivity.class);

        int chap_played = extra.getInt("chapterplayed",-1);
        Log.d(Constants.TAG,"Played: "+chap_played +" : chapter: "+Constants.mCourse.getTotalChapters());
        if(chap_played == -1){
            //Play 1st Chapter
            intent.putExtra("chaptertoplay", 1);
            //Chapter cha = mCourse.getmChapters().get(1);
            intent.putExtra("videofile",  Constants.mCourse.getmChapters().get(0).getVideoURL());
            if(Constants.mCourse.getmChapters().get(0).isQuiz()){
                Constants.quizTaken = false;
            }else{
                Constants.quizTaken = true;
            }
        }
        else if (chap_played < Constants.mCourse.getmChapters().size()){
            // For Playing 2nd to till last
            if(Constants.mCourse.getmChapters().get(chap_played-1).isQuiz() && !Constants.quizTaken){

                Intent in2 = new Intent(MovieWrapperActivity.this, QuestionWrapper.class);
                in2.putExtra("chaptertoplay", chap_played);
                Constants.quizTaken = true;
                startActivity(in2);
                //System.exit(0);

            }else{
                if(Constants.mCourse.getmChapters().get(chap_played).isQuiz()){
                    Constants.quizTaken = false;
                }else{
                    Constants.quizTaken = true;
                }
                intent.putExtra("videofile",  Constants.mCourse.getmChapters().get(chap_played).getVideoURL());
                intent.putExtra("chaptertoplay", chap_played+1);
            }

        }
        else if(chap_played == Constants.mCourse.getmChapters().size()){
            // Move to End Knowlege Test Here
            MovieWrapperActivity.this.finish();
        }
        Log.d(Constants.TAG,"Here...");
        startActivity(intent);
        System.exit(0);

    } 
```

**编辑：**还有一件事。当我没有完成第一个活动并开始第二个活动时，我在第二个活动中得到了改变。

**更新：**当我完成 Activity 时出现问题，`System.exit(0);`但在完成时没有问题`finish();`。但是当使用`finish();`它完成活动时会导致更多的运行时错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:04:44.690

这是因为有两个不同的线程。现在在这种情况下，第二个活动在 gotCourse 变量更改为 true 之前启动。因此，如果您执行以下操作，它将解决您的问题。

```
 if(Constants.gotCourse == false){
         Constants.gotCourse = true;
        mGetDataTask = new GetDataTask();
        mGetDataTask.execute();

    }else{ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:26:53.900

您应该使用 getter 和 setter 将这些值提取到共享资源类中。这样，他们的内容就可以在任何地方被检索到。

# android - 反编译android apk文件创建java源码

> ID：16058693
> 
> 赞同：1
> 
> 时间：2013-04-17T11:21:21.057
> 
> 标签：android

我使用了 3 个工具作为 1)apktool 1.5.2.tar.bz2 2)dex2jar-0.0.9.13.zip 3)jd-gui-0.3.5.windows.zip

但是当我在 cmd 上使用命令时出现以下错误：C:\New folder\Tea.apk>dex2jar classes.dex

```
Error occurred during initialization of VM`could not reserve enough space for object heap code Error: Could not create the Java Virtual Machine.Error: A fatal exception has occurred. Program will exit. 
```

我在控制面板中将 vm heap size 更改为 500 MB，但发生与上述相同的错误。请发送给定问题的解决方案。在此先感谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-17T11:27:44.240

首先你需要一个名为 dex2jar 的工具，它是由一个中国学生制作的。它会将 dex 转换为 jar 文件。然后你可以使用 jd-gui，源代码可读性很强，因为 dex2jar 做了一些优化。

# timer - Arduino纳米计时器

> ID：16058695
> 
> 赞同：8
> 
> 时间：2013-04-17T11:21:25.127
> 
> 标签：timer, arduino, avr, atmel, atmega

我想了解更多关于[Arduino Nano](https://store.arduino.cc/arduino-nano)计时器的信息。

1.  有哪些计时器？
2.  他们会产生中断吗？
3.  什么代码会将中断处理程序附加到它们？
4.  如何`delay()`和`delayMicroseconds()`实施...
    *   他们使用定时器中断吗？（如果是这样，在此期间如何执行其他代码？）
    *   还是他们反复轮询直到计时器达到某个值？
    *   还是他们将值增加 X 次？
    *   还是他们以另一种方式做到这一点？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-17T20:27:43.280

考虑 Arduino Nano 计时器的最佳方式是考虑底层芯片中的计时器：[ATmega328](http://www.atmel.com/Images/Atmel-8271-8-bit-AVR-Microcontroller-ATmega48A-48PA-88A-88PA-168A-168PA-328-328P_datasheet.pdf)。它有三个定时器：

*   定时器 0：8 位，芯片引脚 11 和 12 上的 PWM
*   定时器 1：16 位，芯片引脚 15 和 16 上的 PWM
*   定时器 2：8 位，芯片引脚 17 和 5 上的 PWM

所有这些定时器都可以产生两种中断：

*   “值匹配”中断发生在与定时器的每个滴答相加的定时器值达到定时器寄存器中的比较值时。
*   当定时器值达到最大值时发生定时器溢出中断

不幸的是，没有 Arduino 函数可以将中断附加到定时器。要使用定时器中断，您需要编写更多的低级代码。基本上，您需要声明一个[中断例程](http://www.nongnu.org/avr-libc/user-manual/group__avr__interrupts.html)，如下所示：

```
ISR(TIMER1_OVF_vect) {
   ...
} 
```

这将声明一个服务 timer1 溢出中断的函数。然后您需要使用寄存器*启用*定时器溢出中断。`TIMSK1`在上面的示例中，这可能如下所示：

```
TIMSK1 |= (1<<TOIE1); 
```

或者

```
TIMSK1 |= BV(TOIE1); 
```

这会`TOIE1`在 TIMSK1 寄存器中设置（请生成 timer1 溢出中断）标志。假设您的中断已启用，`ISR(TIMER1_OVF_vect)`每次 timer1 溢出时都会调用您。

* * *

Arduino`delay()`函数在源代码 ( ) 中如下所示`wiring.c`：

```
void delay(unsigned long ms)
{
    uint16_t start = (uint16_t)micros();

    while (ms > 0) {
        if (((uint16_t)micros() - start) >= 1000) {
            ms--;
            start += 1000;
        }
    }
} 
```

所以在内部它使用该`micros()`函数，该函数确实依赖于 timer0 计数。Arduino 框架使用 timer0 来计算毫秒数，实际上， timer0 计数是`millis()`函数获取其值的地方。

`delayMicroseconds()`另一方面，该功能使用某些适时的微处理器操作来产生延迟。使用哪个函数取决于处理器和时钟速度；最常见的是`nop()`（无操作），它恰好需要一个时钟周期。Arduino Nano 使用 16 MHz 时钟，源代码如下所示：

```
// For a one-microsecond delay, simply return. The overhead
// of the function call yields a delay of approximately 1 1/8 µs.
if (--us == 0)
    return;

// The following loop takes a quarter of a microsecond (4 cycles)
// per iteration, so execute it four times for each microsecond of
// delay requested.
us <<= 2;

// Account for the time taken in the proceeding commands.
us -= 2; 
```

我们从中学到了什么：

*   1 µs 延迟什么都不做（函数调用就是延迟）
*   较长的延迟使用左移操作来计算延迟时间。

# r - 如何用水平线和文本表示 ggplot 中的因子

> ID：16058697
> 
> 赞同：2
> 
> 时间：2013-04-17T11:21:32.827
> 
> 标签：r, ggplot2

我的数据看起来像这个例子：

```
 dataExample<-data.frame(Time=seq(1:10),
        Data1=runif(10,5.3,7.5),
        Data2=runif(10,4.3,6.5),
        Application=c("Substance1","Substance1","Substance1",
        "Substance1","Substance2","Substance2","Substance2",
        "Substance2","Substance1","Substance1"))
        dataExample

           Time    Data1    Data2 Application
        1     1 6.511573 5.385265  Substance1
        2     2 5.870173 4.512775  Substance1
        3     3 6.822132 5.109790  Substance1
        4     4 5.940528 6.281412  Substance1
        5     5 7.269394 4.680380  Substance2
        6     6 6.122454 6.015899  Substance2
        7     7 5.660429 6.113362  Substance2
        8     8 6.649749 4.344978  Substance2
        9     9 7.252656 4.764667  Substance1
        10   10 7.204440 5.835590  Substance1 
```

我想指出在什么时候应用了不同于 的任何物质`dataExample$Application[1]`。

在这里，我向您展示了绘制此图的方式，但我假设使用 ggplot 有一种更简单的方法。

```
library(reshape2)
library(ggplot)

plotDataExample<-function(DataFrame){
  longDF<-melt(DataFrame,id.vars=c("Time","Application"))
  p=ggplot(longDF,aes(Time,value,color=variable))+geom_line()

  maxValue=max(longDF$value)
  minValue=min(longDF$value)

  yAppLine=maxValue+((maxValue-minValue)/20)
  xAppLine1=min(longDF$Time[which(longDF$Application!=longDF$Application[1])])
  xAppLine2=max(longDF$Time[which(longDF$Application!=longDF$Application[1])])
  lineData=data.frame(x=c(xAppLine1,xAppLine2),y=c(yAppLine,yAppLine))

  xAppText=xAppLine1+(xAppLine2-xAppLine1)/2
  yAppText=yAppLine+((maxValue-minValue)/20)
  appText=longDF$Application[which(longDF$Application!=longDF$Application[1])[1]]
  textData=data.frame(x=xAppText,y=yAppText,appText=appText)

  p=p+geom_line(data=lineData,aes(x=x, y=y),color="black")
  p=p+geom_text(data=textData,aes(x=x,y=y,label = appText),color="black")
  return(p)
}
plotDataExample(dataExample) 
```

![在此处输入图像描述](https://i.stack.imgur.com/EvMoi.jpg)

**问题：** 您是否知道获得类似结果的更好方法，以便我可以指出多个因素（例如 Substance3、Substance4 ...）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T12:54:32.347

首先，使新的样本数据具有2个以上的水平并重复两次`Substance2`。

```
dataExample<-data.frame(Time=seq(1:10),
                        Data1=runif(10,5.3,7.5),
                        Data2=runif(10,4.3,6.5),
                        Application=c("Substance1","Substance1","Substance2",
                                      "Substance2","Substance1","Substance1","Substance2",
                                      "Substance2","Substance3","Substance3")) 
```

没有将此作为显示每个步骤的功能。

将新列添加`groups`到原始数据框 - 这包含用于分组的标识符`Applications`- 如果物质发生变化，则形成新组。

```
dataExample$groups<-c(cumsum(c(1,tail(dataExample$Application,n=-1)!=head(dataExample$Application,n=-1)))) 
```

将数据行转换为长格式数据。

```
longDF<-melt(dataExample,id.vars=c("Time","Application","groups")) 
```

计算物质标识符的位置。使用`ddply()`库中的函数`plyr`。对于计算，仅使用与第一个`Application`值不同的数据（即`subset()`）。然后`Application`和`groups`用于数据分组。计算 x 轴上的开始、中间和结束位置，y 值取最大值`value`+0.3。

```
library(plyr)    
lineData<-ddply(subset(dataExample,Application != dataExample$Application[1]),
      .(Application,groups),
                summarise,minT=min(Time),maxT=max(Time),
                meanT=mean(Time),ypos=max(longDF$value)+0.3) 
```

`ggplot()`现在用and绘制 longDF 数据，并在 plot with和 text`geom_line()`上面添加段，使用 new data frame 。`geom_segment()``annotate()``lineData`

```
ggplot(longDF,aes(Time,value,color=variable))+geom_line()+
  geom_segment(data=lineData,aes(x=minT,xend=maxT,y=ypos,yend=ypos),inherit.aes=FALSE)+
  annotate("text",x=lineData$meanT,y=lineData$ypos+0.1,label=lineData$Application) 
```

![在此处输入图像描述](https://i.stack.imgur.com/bt6KN.png)

# ms-access - Numlock 和 CAPSLOCK 在 VBA Access 中始终打开

> ID：16058704
> 
> 赞同：0
> 
> 时间：2013-04-17T11:21:44.780
> 
> 标签：ms-access, vba

您好，我有一个用 VBA Access 编写的表单，当我从组合框或文本中键入或选择一些值或文本一些值时，我的 NUMLOCK 和 CAPSLOCK 键正在关闭，如何使它们始终处于打开状态，我不知道如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T13:43:52.463

[这](http://access.mvps.org/access/api/api0046.htm)具有将检查和设置**capslock**、**numlock**和**scrolllock**的代码。

它使用 Windows API

```
 Private Declare Function GetKeyboardState Lib "user32" _
     (pbKeyState As Byte) As Long
  Private Declare Function SetKeyboardState Lib "user32" _
     (lppbKeyState As Byte) As Long 
```

检查和设置键盘状态 - 使用此 API，可以使用其他有趣的东西，例如使用 windows 键。

# c# - 带有 linq 数据上下文的存储过程返回值

> ID：16058713
> 
> 赞同：12
> 
> 时间：2013-04-17T11:22:12.000
> 
> 标签：c#, sql, sql-server, linq, stored-procedures

我正在尝试使用 Linq 访问存储过程的返回值

```
DECLARE @ValidToken int = 0 //I have also tried using a bit instead of an int here.

IF EXISTS(SELECT 1 FROM Tests WHERE TestToken = @Token)
    select @ValidToken = 1

return @ValidToken 
```

这在通过 sql studio 运行 SP 时有效。但是我正在尝试使用 linq 使用 datacontext 类运行它，它总是返回-1。

```
using (DataEntities dataEntities = new DataEntities())
    {
        int query = data.ValidateToken(id);
        Response.Write(query.ToString());
    } 
```

查询总是等于-1，我不知道为什么。

我在网上查看过，似乎有更简单的方法来获取返回值，但是我宁愿坚持使用 Linq，因为这是程序的其余部分正在使用的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-25T14:29:52.233

为什么你们都使用存储过程作为函数？

虽然存储过程有`return`，但它不是一个函数，所以你不应该使用它`return`来返回数据，

相反，您应该使用输出参数和其他方式来返回数据，如[MSDN 中所述](http://msdn.microsoft.com/en-us/library/ms188655.aspx)

`return`并且使用[记录在 MSDN](http://msdn.microsoft.com/en-us/library/ms174998.aspx)

滥用`return`可能是 LINQ 不理解您的存储过程的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-21T16:53:40.213

这是我做的，它奏效了。

在 Sqlserver 中：

```
 ALTER PROCEDURE [dbo].[ValidateToken]
-- Add the parameters for the stored procedure here
@Id int
AS
BEGIN
DECLARE @Ret INT

SELECT
    @Ret = COUNT(*)
FROM Test

set @Ret =@Id+1;

select @Ret

END 
```

在 C# 中：

```
 static void Main(string[] args)
    {
        using (SergioEntities dm = new SergioEntities()) 
        {
            int? validToken = 1;

            int? a = dm.ValidateToken(validToken).First();

        }

    } 
```

试试看 ：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T11:25:51.497

尝试将 RETURN 0/1 语句更改为 SELECT 0/1

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T11:32:31.297

你的代码的问题是你使用`IF(query)`而不是你需要像这样使用它，`IF EXISTS(query)`所以你的代码将如下所示

```
CREATE PROCEDURE [dbo].[MyProc]         
AS
BEGIN
      DECLARE @Ret INT

      //use of IF EXISTS instead of IF
      IF EXISTS(SELECT * from Tests WHERE TestToken = @Token)
        SELECT @Ret =  0
      ELSE
        SELECT @Ret =  1

      RETURN @Ret
END 
```

您的代码可能看起来像，

```
using (TestDBDataContext db = new TestDBDataContext())
{
    //For Stored Procedure with Return value (for Integer)
    //returns Int
    var q = db.MyProc();
    Console.WriteLine(q);               

} 
```

如果这不起作用，请选择其他解决方案

*   输出参数
*   使用标量值函数

这里讨论的是：[**LINQ to SQL：从存储过程返回标量值**](http://blogs.msdn.com/b/wriju/archive/2009/04/10/linq-to-sql-returning-scalar-value-from-stored-procedure.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-27T10:07:45.557

```
CREATE PROCEDURE [dbo].[MyProc]         
AS
BEGIN
    DECLARE @Ret INT

    // use of IF EXISTS instead of IF
    IF EXISTS(SELECT * from Tests WHERE TestToken = @Token)
        SELECT @Ret =  0
    ELSE
        SELECT @Ret =  1

    RETURN @Ret
END 
```

# java - Java - 如何从触摸板鼠标监听缩放事件

> ID：16058716
> 
> 赞同：2
> 
> 时间：2013-04-17T11:22:27.207
> 
> 标签：java, pinchzoom, touchpad

使用我的 ThinkPad 触摸板，我可以通过捏合手势放大和缩小各种应用程序，就像使用其他缩放方法（例如 Ctrl+鼠标滚轮）一样。

是否可以在 Java 中收听此类手势，并将缩放事件发送到我的应用程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:44:30.537

这会有帮助吗？

[SmoothPinchZoom](https://github.com/killoctal/AndEngineControls/blob/master/src/com/killoctal/andenginecontrols/camera/SmoothPinchZoom.java)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-21T13:38:29.123

我遇到了同样的问题-尽管没有详细说明您正在考虑使用哪种组件，但对于 javafx webview 这应该可以工作： [https ://docs.oracle.com/javase/8/javafx/api/javafx/scene/input /ZoomEvent.html](https://docs.oracle.com/javase/8/javafx/api/javafx/scene/input/ZoomEvent.html)

```
webView.addEventFilter(ZoomEvent.ZOOM, (ZoomEvent e) -> {
    double zoom = e.getZoomFactor();
    webView.setZoom(webView.getZoom() * zoom);
    e.consume();
}); 
```

# gwt - GXT - 如何设置网格单元格背景颜色

> ID：16058717
> 
> 赞同：2
> 
> 时间：2013-04-17T11:22:31.347
> 
> 标签：gwt, gxt

我想更改 GXT Grid 中单元格的背景颜色，我使用的是 GXT 3.0。我有一个与我的查询相关的链接（[http://ui-programming.blogspot.in/2010/01/gxt-how -to-set-cell-grid-background.html](http://ui-programming.blogspot.in/2010/01/gxt-how-to-set-cell-grid-background.html)）但 setRenderer 方法在 GXT 3.0 中不存在 columnConfig 。如何获得所需的输出？lz帮忙。

到目前为止我已经完成的代码：-

```
ColumnConfig<Stock, Double> changeCol = new ColumnConfig<Stock, Double>(props.change(), 100, "Change");
changeCol.setCell(new AbstractCell<Double>() {

    @Override
    public void render(Context context, Double value, SafeHtmlBuilder sb) {
          if (value == null) {
                return;
              }
   store.get(context.getIndex());
          GWT.log(DOM.getCaptureElement().getId());
      String style = "style='background-color: " + (value < 0 ? "red" : "green") + "'";
      String v = number.format(value);
       sb.appendHtmlConstant("<span " + style + " qtitle='Change' qtip='" + v + "'>" + v + "</span>");
    }
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-31T00:48:40.217

对于那些需要根据网格中的**数据更改单元格颜色的**人，我只需要这样做（GXT 3.1），但不幸的是，解决方案并不完美。

通常，可以使用`ColumnConfig.setCell(MyCell)`“MyCell”是`AbstractCell`. 不幸的是，**主机“div”中存在“填充”**问题，它没有着色。有几种方法可以解决这个问题......

最**简单的方法**是：

1.  `ColumnConfig.setCellPadding(false)`
2.  渲染填充整个单元格的自己的彩色 div（如果需要，可以使用填充）

不幸的是，这不适用于**单个单元格选择**( `CellSelectionModel`)。用于单元格选择的 css 类被混淆，因此不能在其他样式表中引用。:(

我的**（丑陋的）替代方案**是呈现链接在模块的 html 页面（例如 Main.html）中的自定义样式表。然后我可以使用 css 'class' 而不是 'style' 属性为单元格着色。IE：

1.  创建一个呈现样式表的自定义 JSP（内容类型“text/css”）
2.  将样式表链接到模块 html（在“reset.css”之后）
3.  样式表需要有选择器`td.someClass`（`.someClass`不够具体）
4.  用于`Grid.getView().setViewConfig()`提供`GridViewConfig`返回适当类的 a

不幸的是，这需要对 CSS 规则有很好的了解，并且在用户登录时需要知道可能的颜色。

可能**有第三种方式**使用 'td' 元素的样式属性。从 Sencha 看一下这个问题： [http](http://www.sencha.com/forum/showthread.php?289347-Influencing-cell-td-style-in-a-grid&p=1057079) ://www.sencha.com/forum/showthread.php?289347-Influencing-cell-td-style-in-a-grid&p=1057079 （正在进行中）

请注意，**其他样式选项**包括：

*   各种各样的`ColumnConfig.setXxxClassName()`
*   各种各样的`ColumnConfig.setXxxStyle()`

# php - 为什么无法在资源管理器上使用 php 读取 javascript 设置的 cookie？

> ID：16058718
> 
> 赞同：4
> 
> 时间：2013-04-17T11:22:32.470
> 
> 标签：php, javascript, internet-explorer, cookies, opera

我有一个问题，我需要帮助。我正在做一些简单的步骤：

1.  我用 php 设置了一个 cookie（如果尚未设置）。
2.  我用 php 再次读取了这个 cookie，它工作正常（适用于所有浏览器！）。
3.  我重置了我之前设置的cookie，这次使用了javascript。
4.  我用 php 和 firefox、chrome 读取了 javascript 设置的 cookie，它工作正常，但在 explorer、opera、safari（我使用最新版本）上它不起作用。无法读取 cookie。没有错误返回，但 cookie 的字段为空白。请看下面的代码。

**php代码：**

```
<?php
    if (isset($_COOKIE["parameters"])){
            $UserParam = json_decode($_COOKIE["parameters"],true);
            print_r($UserParam); // when the cookie is set by php it prints the array (on all browsers), but when cookie is set by javascript nothing print on explorer,opera,safari.
            echo"<script>function readCookie(){ alert(\"the cookie was there with radius: ".$UserParam['radius']." type: ".$UserParam['type']."\"); //again when the cookie set with php the variables have values on every browser, but when the cookie set with javascript no values to the variables.
                            getLocationFunction(\"".$UserParam["radius"]."\",\"".$UserParam["type"]."\",\"".$UserParam["date"]."\",\"".$UserParam["name"]."\")}</script>";
    }
    else { 
            $defaultParam = array("radius" => "ως 50km","type" => "all","date" => "unlimited", "name" => "all");
            $defaultParamSerialized = json_encode($defaultParam);
            setcookie("parameters","$defaultParamSerialized",time()+3600);
            echo"<script>function readCookie(){ alert(\"there was no cookie so i set it: radius ".$defaultParam["radius"]."\");
                             getLocationFunction(\"".$defaultParam["radius"]."\",\"".$defaultParam["type"]."\",\"".$defaultParam["date"]."\",\"".$defaultParam["name"]."\")
                        }
                </script>";
    }

?> 
```

**javascript代码：**

```
function renewCookie(){ 
    var myArray = {radius: radius, type: type, date: price , name: company };
    var valueSerialized = JSON.stringify(myArray);
    createCookie('parameters',valueSerialized,999);   
  }
function createCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
  } 
```

同样，我在所有情况下都使用 php 读取 cookie，但是当我使用 php 创建它时，它可以被所有浏览器读取，当我使用 javascript 创建它时，它可以被 firefox、chrome 读取，但不能在 explorer、opera 和苹果浏览器。

注意1：没有语法错误。

注意2：浏览器是最新版本。

请帮忙。先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T05:39:58.670

试试看，

改变这个

```
if (isset($_COOKIE["parameters"])){ 
```

有了这个

```
$COOKIE = isset($_COOKIE["parameters"]) ? $_COOKIE["parameters"] : ""; 
```

并`print_r($_COOKIE)`与任何浏览器一起使用以查看差异。

# jwplayer - 如何在 ipad 中使用 jwplayer 自动播放视频，上面的代码

> ID：16058719
> 
> 赞同：1
> 
> 时间：2013-04-17T11:22:36.627
> 
> 标签：jwplayer

此代码适用于浏览器，但不适用于移动设备。

我怎样才能使它适用于移动设备？

```
$(document).ready(function() {
    $('#game_flash').on( "touchstart", function(){
        $(this).remove();
    }); 
    $('#game_flash').trigger('touchstart');

}); 

jwplayer("game_flash").play(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:41:43.543

在 iOS 设备上无法自动播放。在 iOS 上，jwplayer 使用 HTML 5 video 标签，这对 iOS 有一些限制：

> 在 iOS 上的 Safari（适用于所有设备，包括 iPad）中，用户可能在蜂窝网络上并按数据单位收费，预加载和自动播放被禁用。在用户启动数据之前不会加载数据。

[资源](http://developer.apple.com/library/safari/#documentation/AudioVideo/Conceptual/Using_HTML5_Audio_Video/Device-SpecificConsiderations/Device-SpecificConsiderations.html)

# java - 在线 Java 线程转储分析器

> ID：16058721
> 
> 赞同：3
> 
> 时间：2013-04-17T11:22:54.443
> 
> 标签：java, web-services, parsing, thread-dump

我经常使用 Java Thread Dumps 进行事后分析和服务器减速分析。问题是线程转储通常很长，理解线程之间的并发关系可能很乏味。

**是否有（最好是在线的）工具可以解析 Java 线程转储并显示可读的摘要？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-11-13T09:19:57.823

这是一个在线工具，无需安装：
[http ://spotify.github.io/threaddump-analyzer/](http://spotify.github.io/threaddump-analyzer/)

我写它是因为我也错过了这个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T12:02:56.857

[IntelliJ](http://www.jetbrains.com/idea/download/index.html)（社区版或终极版）有一个不错的 Stacktrace/Thread Dump 分析器。

它不是一个在线工具，但你说*最好是在线*的，所以这是一个足够的答案 IMO。

![在此处输入图像描述](https://i.stack.imgur.com/tCJTl.png)

# view - SharePoint 列表视图上的条件样式

> ID：16058728
> 
> 赞同：1
> 
> 时间：2013-04-17T11:23:14.583
> 
> 标签：view, sharepoint-2010, formatting

我有一个显示文档库内容的标准 Web 部件。

如果一个字段具有特定值，我想以不同的颜色显示内容粗体。

我可以通过转到文档库列表并使用 SharePoint 设计器修改视图并添加“条件格式”和“格式化行”来实现这一点。

结果在 Designer 中看起来很棒。（红色和粗体）

在列表视图中，颜色丢失了，但粗体仍然可见。

在使用 WebPart 进行显示的网站上，所有格式都丢失了。

可以做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T09:07:28.013

通过不修改 SharePoint Designer 中的 VIEW 而是修改 PAGE 解决了这个问题。奇怪的东西... :)

# knockout.js - 敲除锚标记的可见绑定不起作用

> ID：16058730
> 
> 赞同：0
> 
> 时间：2013-04-17T11:23:19.830
> 
> 标签：knockout.js, javascript

我在我的应用程序中使用 JavaScript 模块模式。这是我的 html 绑定

`<a href="#" data-bind="visible:master.child.showDeleteLink,click: function(obj, event) { master.child.showDeletePopup() } ">`

我的视图模式是

```
 master.child=(function (my, jQuery, ko) {
    var textTemp;
    my.ViewModel = function () {
    self.showDeleteLink = ko.observable();
        self.showDeleteLink = function () {
            if (textTemp.length > 500)
                return true;
            else
                return false;
       }
    ko.applyBindings(my.anothermodule);
    } 
}(master.child, $, ko)); 
```

单击绑定，html 是文本工作得很好:)。

但是可见性绑定不起作用。任何机构有任何想法吗？我在哪里错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:32:07.237

```
my.ViewModel = function () {
    self.showDeleteLink = ko.observable();
        self.showDeleteLink = function () {
            if (textTemp.length > 500)
                return true;
            else
                return false;
       } 
```

您的“self.showDeleteLink”不再可见。你给它一个新的价值，成为功能。

我认为您正在寻找的是一个计算值： http: [//knockoutjs.com/documentation/computedObservables.html](http://knockoutjs.com/documentation/computedObservables.html)

```
self.showDeleteLink = ko.computed(function() {
        return (textTemp.length > 500);
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T12:07:28.363

将绑定更改为`data-bind="visible:master.child.showDeleteLink()`现在它工作得很好

# jsf - 如何刷新富标签面板的特定标签？

> ID：16058732
> 
> 赞同：0
> 
> 时间：2013-04-17T11:23:23.523
> 
> 标签：jsf, richfaces, tabpanel

我有`rich:tabPanel`作为`switchtype`客户。

当我在第三个选项卡中进行页面刷新时，它导航到第一个选项卡。请在下面找到代码片段。

请建议如何仅刷新召回选项卡。

此外，如果我使用 switch 类型作为服务器或 ajax，调用选项卡中的命令按钮将不起作用，命令按钮的操作需要单击两次或三次。

```
<rich:tabPanel id="meainmenu1" width="80%" styleClass="panelGrid_class" switchType="client" rendered="true">
    <rich:tab id="menu1" label="Display / Delete" style="font-weight:bold;font-size:15px">
        some code here
    </rich:tab>
    <rich:tab id="menu2" label="Add / Modify">
        some code here
    </rich:tab>
    <rich:tab id="menu3" label="Zoom" rendered="#{not mcifTransMBean.consoleBasedTrans}">
    </rich:tab>
    <rich:tab id="menu4" label="Benf. View" rendered="#{not mcifTransMBean.consoleBasedTrans}">
    </rich:tab>
    <rich:tab id="menu5" label="Recall" >
        <ui:include src="/pages/mctrans/reCallMcifTrans.xhtml" />           
    </rich:tab> 
```

# java - 绘制背景图像

> ID：16058736
> 
> 赞同：0
> 
> 时间：2013-04-17T11:23:28.493
> 
> 标签：java, swing, jframe

我画了一个图像，这是我的背景图像，一切都很好，但是当我尝试将一些 JButtons 添加到框架时，整个业务出错了，我绘制的图片消失了，我看到了原始背景。

图片是这样的：

```
public void paint(Graphics g){
    g.drawImage(bg, 0, 0, null);
} 
```

我想我的问题是与paint方法有关，需要提到的是我正在扩展JFrame类。

编辑：这里有一些图片来说明我的意思。

它首先绘制我的图像： ![在此处输入图像描述](https://i.stack.imgur.com/xETwl.png)

当我将鼠标移动到应该绘制按钮的位置时，这就是我得到的： ![在此处输入图像描述](https://i.stack.imgur.com/VYPUs.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T11:24:35.887

![在此处输入图像描述](https://i.stack.imgur.com/JHNhB.png)

```
import java.awt.*;
import java.awt.image.BufferedImage;
import javax.swing.*;
import javax.swing.border.EmptyBorder;
import java.net.URL;
import javax.imageio.ImageIO;

public class FrameWithBG {

    public static void main(String[] args) throws Exception {
        URL url = new URL("http://i.stack.imgur.com/OVOg3.jpg");
        final BufferedImage bg = ImageIO.read(url);
        Runnable r = new Runnable() {

            @Override
            public void run() {
                JPanel c = new PanelWithBackgroundImage(bg);
                c.setLayout(new GridLayout(0,5,16,16));
                c.setBorder(new EmptyBorder(10, 10, 10, 10));
                for (int ii = 1; ii < 26; ii++) {
                    c.add(new JButton("Button " + ii));
                }
                JFrame f = new JFrame(c.getClass().getSimpleName());

                f.add(c);
                f.pack();
                f.setVisible(true);
            }
        };
        // Swing GUIs should be created and updated on the EDT
        // http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html
        SwingUtilities.invokeLater(r);
    }
}

class PanelWithBackgroundImage extends JPanel {

    Image bg;

    PanelWithBackgroundImage(Image bg) {
        this.bg = bg;
    }

    @Override
    public void paintComponent(Graphics g) {
        super.paintComponent(g);
        g.drawImage(bg, 0, 0, getWidth(), getHeight(), this);
    }
} 
```

# c# - ServiceStack.Text 如何获取要序列化的子类值？

> ID：16058742
> 
> 赞同：1
> 
> 时间：2013-04-17T11:23:50.740
> 
> 标签：c#, json, serialization, servicestack

例如，我有这两个类，PropertyEx 继承自 PropertyDataEx

`public class PropertyDataEx { public string Name { get; set; } }`

`public class PropertyEx : PropertyDataEx { public string Value { get; set; } }`

当我序列化一个包含一些 PropertyEx 的 PropertyDataEx 列表时，它不会采用属性值，只是名称。

`public void Serialize_Property_WillHaveValue() {`

 ````
 var property = new PropertyEx()
  {Name = "Niclas", Value = "varde"};

  JsConfig.DateHandler = JsonDateHandler.ISO8601;
  JsConfig.ExcludeTypeInfo = false;
  JsConfig.IncludeTypeInfo = true;
  JsConfig.IncludeNullValues = true;
  JsConfig.PreferInterfaces = false;

  var list = new List<PropertyDataEx>();

  list.Add(property);

  var value = JsonSerializer.SerializeToString(list);
} 
```` 

`在这种情况下，该值将是 "[{"__type":"Namespace.PropertyEx, Namespace","Name":"Niclas"}]"`

 `您会看到属性 Value 丢失了。我怎样才能解决这个问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T12:34:33.537

好的，找到它，要使其正常工作，PropertyDataEx 需要是抽象的。`

# eclipse - 从实体生成表导致 NoInitialContextException

> ID：16058743
> 
> 赞同：0
> 
> 时间：2013-04-17T11:23:51.633
> 
> 标签：eclipse, jpa, eclipselink, jboss7.x, java-ee-6

当我尝试从项目的实体生成数据库表时，会引发以下异常。

如果我理解正确，异常建议指定`java.naming.factory.initial`：
所以我浏览了 JBoss-Documentation 的几个部分，不太确定我在寻找什么，用`jndi.properties`-file 进行了实验，最后意识到我完全一无所知。

顺便说一句：从表中生成实体（反之亦然）可以正常工作。

```
[EL Info]: EclipseLink, version: Eclipse Persistence Services - 2.3.2.v20111125-r10461
[EL Severe]: Local Exception Stack: 
Exception [EclipseLink-7060] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.ValidationException
Exception Description: Cannot acquire data source [java:jboss/datasources/MySQLDS].
Internal Exception: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at org.eclipse.persistence.exceptions.ValidationException.cannotAcquireDataSource(ValidationException.java:497)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:109)
    at org.eclipse.persistence.sessions.DatasourceLogin.connectToDatasource(DatasourceLogin.java:162)
    at org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.loginAndDetectDatasource(DatabaseSessionImpl.java:584)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryProvider.login(EntityManagerFactoryProvider.java:206)
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:488)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryDelegate.getDatabaseSession(EntityManagerFactoryDelegate.java:188)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryDelegate.createEntityManagerImpl(EntityManagerFactoryDelegate.java:277)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManagerImpl(EntityManagerFactoryImpl.java:294)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:272)
    at org.eclipse.jpt.jpa.eclipselink.core.ddlgen.Main.perform(Main.java:85)
    at org.eclipse.jpt.jpa.eclipselink.core.ddlgen.Main.execute(Main.java:76)
    at org.eclipse.jpt.jpa.eclipselink.core.ddlgen.Main.main(Main.java:63)
Caused by: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at javax.naming.spi.NamingManager.getInitialContext(Unknown Source)
    at javax.naming.InitialContext.getDefaultInitCtx(Unknown Source)
    at javax.naming.InitialContext.getURLOrDefaultInitCtx(Unknown Source)
    at javax.naming.InitialContext.lookup(Unknown Source)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:103)
    ... 11 more

Exception in thread "main" javax.persistence.PersistenceException: Exception [EclipseLink-7060] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.ValidationException
Exception Description: Cannot acquire data source [java:jboss/datasources/MySQLDS].
Internal Exception: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:517)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryDelegate.getDatabaseSession(EntityManagerFactoryDelegate.java:188)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryDelegate.createEntityManagerImpl(EntityManagerFactoryDelegate.java:277)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManagerImpl(EntityManagerFactoryImpl.java:294)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryImpl.createEntityManager(EntityManagerFactoryImpl.java:272)
    at org.eclipse.jpt.jpa.eclipselink.core.ddlgen.Main.perform(Main.java:85)
    at org.eclipse.jpt.jpa.eclipselink.core.ddlgen.Main.execute(Main.java:76)
    at org.eclipse.jpt.jpa.eclipselink.core.ddlgen.Main.main(Main.java:63)
Caused by: Exception [EclipseLink-7060] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.ValidationException
Exception Description: Cannot acquire data source [java:jboss/datasources/MySQLDS].
Internal Exception: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at org.eclipse.persistence.exceptions.ValidationException.cannotAcquireDataSource(ValidationException.java:497)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:109)
    at org.eclipse.persistence.sessions.DatasourceLogin.connectToDatasource(DatasourceLogin.java:162)
    at org.eclipse.persistence.internal.sessions.DatabaseSessionImpl.loginAndDetectDatasource(DatabaseSessionImpl.java:584)
    at org.eclipse.persistence.internal.jpa.EntityManagerFactoryProvider.login(EntityManagerFactoryProvider.java:206)
    at org.eclipse.persistence.internal.jpa.EntityManagerSetupImpl.deploy(EntityManagerSetupImpl.java:488)
    ... 7 more
Caused by: javax.naming.NoInitialContextException: Need to specify class name in environment or system property, or as an applet parameter, or in an application resource file:  java.naming.factory.initial
    at javax.naming.spi.NamingManager.getInitialContext(Unknown Source)
    at javax.naming.InitialContext.getDefaultInitCtx(Unknown Source)
    at javax.naming.InitialContext.getURLOrDefaultInitCtx(Unknown Source)
    at javax.naming.InitialContext.lookup(Unknown Source)
    at org.eclipse.persistence.sessions.JNDIConnector.connect(JNDIConnector.java:103)
    ... 11 more 
```

我的persistence.xml

```
<?xml version="1.0" encoding="UTF-8"?>

<persistence version="2.0"
    xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd">
  <persistence-unit name="DynamicWebProject" transaction-type="JTA">
  <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <jta-data-source>java:jboss/datasources/MySQLDS</jta-data-source>
    <class>hoho.model.generated.AvailabilityDeliveryMethod</class>
    <class>hoho.model.generated.AvailabilityItem</class>
    <class>hoho.model.generated.AvailabilityRestaurant</class>
    <class>hoho.model.generated.Category</class>
    <class>hoho.model.generated.ContactData</class>
    <class>hoho.model.generated.Deliverer</class>
    <class>hoho.model.generated.DeliveryMethod</class>
    <class>hoho.model.generated.DeliveryMethodHasPrice</class>
    <class>hoho.model.generated.Item</class>
    <class>hoho.model.generated.Label</class>
    <class>hoho.model.generated.OrderHasItem</class>
    <class>hoho.model.generated.OrderLimitation</class>
    <class>hoho.model.generated.PaymentMethod</class>
    <class>hoho.model.generated.Person</class>
    <class>hoho.model.generated.PersonPreference</class>
    <class>hoho.model.generated.Price</class>
    <class>hoho.model.generated.PurchaseOrder</class>
    <class>hoho.model.generated.Restaurant</class>
    <class>hoho.model.generated.Tag</class>
    <class>hoho.model.generated.Image</class>
    <class>hoho.model.generated.MimeType</class>
    <class>hoho.model.generated.TaxRate</class>
    <properties>
      <!-- <property name="eclipselink.ddl-generation" value="drop-and-create-tables"/> -->
      <property name="javax.persistence.jtaDataSource" value="java:jboss/datasources/MySQLDS" />
    </properties>
  </persistence-unit>
</persistence> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-27T21:42:17.927

JPA 工具不适用于资源类型 JTA。将其临时更改为 RESOURCE_LOCAL。另请参阅[从实体生成表](https://stackoverflow.com/questions/19771723/generating-tables-from-entities/19772106#19772106)

# ember.js - hasMany data undefined ember-data

> ID：16058748
> 
> 赞同：0
> 
> 时间：2013-04-17T11:23:58.827
> 
> 标签：ember.js, ember-data

I've tried to retrieve some data using ember-data. But there is just `artists: undefined` when I look in the console the model object retrieved.

I don't understand why the association is not done, here is my code

```
MyApp.Track = DS.Model.extend
    artists: DS.hasMany 'MyApp.Artist'
    name: DS.attr 'string'

MyApp.Artist = DS.Model.extend
    name: DS.attr 'string' 
```

And there is the data should be loaded :

```
{
    "track": {
    "name": "Troublemaker",
    "id": 74,
    "artists": [
        {
            "artist": {
                 "name": "Taio Cruz"
            }
        }
    ]
  }
} 
```

I've got the name of the track but not the `id` and the `artists`data.

Thanks a lot for your help.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T14:04:48.463

您必须将艺术家的 id 作为artist_ids 数组返回

这是该[http://emberjs.com/guides/models/the-rest-adapter/#toc_relationships的文档](http://emberjs.com/guides/models/the-rest-adapter/#toc_relationships)

此外，如果您打算发出一个 ajax 请求，则必须包含艺术家的 id 才能工作[http://emberjs.com/guides/models/the-rest-adapter/#toc_sideloaded-relationships](http://emberjs.com/guides/models/the-rest-adapter/#toc_sideloaded-relationships)

如果您的后端在轨道上，则必须在模型序列化程序中包含 ID，如下所示：

```
class TrackSerializer < ActiveModel::Serializer
  attributes :id, :name, :actist_ids
end 
```

# asp.net - ASP.NET MVC 表单和双字段

> ID：16058760
> 
> 赞同：9
> 
> 时间：2013-04-17T11:24:38.080
> 
> 标签：asp.net, html, razor, asp.net-mvc-4

我正在开发一个 asp.net mvc 门户来使用 localDB 管理 GPS 坐标。我的模型是：

```
public class GpsCoordinateViewModel
{
    double Latitute { get; set; }
    double Longitude { get; set; }
} 
```

用于创建新 GpsCoordinate 的自动生成的广告相关视图是：

```
@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>
@using (Html.BeginForm()) {
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(true)

<fieldset>
    <legend>GpsCoordinateViewModel</legend>

    <div class="editor-label">
        @Html.LabelFor(model => model.Latitude)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Latitude)
        @Html.ValidationMessageFor(model => model.Latitude)
    </div>

    <div class="editor-label">
        @Html.LabelFor(model => model.Longitude)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.Longitude)
        @Html.ValidationMessageFor(model => model.Longitude)
    </div>
    <p>
        <input type="submit" value="Create" />
    </p>
</fieldset> 
```

}

```
<div>
    @Html.ActionLink("Back to List", "Index")
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
} 
```

问题是，当我插入纬度：41.213321 和经度：12.123432（例如）时，使用断点本地值是：纬度：41213321 经度：12123432。由于位置的准确性，我需要使用双精度，但是如何？

我还阅读了这个问题： [我应该如何在 MVC 中使用 EditorFor() 作为货币/货币类型？](https://stackoverflow.com/questions/5080451/how-should-i-use-editorfor-in-mvc-for-a-currency-money-type)

[MVC3 - double 类型的小数点后 3 位，前导零](https://stackoverflow.com/questions/7375729/mvc3-3-decimal-places-on-type-double-with-leading-zero)

但解决方案对我不起作用。有什么建议吗？

编辑：我的网络配置是：

```
<system.web>
<httpHandlers>
  <add path="*" verb="*" type="System.Web.HttpNotFoundHandler"/>
</httpHandlers>

<!--
    Enabling request validation in view pages would cause validation to occur
    after the input has already been processed by the controller. By default
    MVC performs request validation before a controller processes the input.
    To change this behavior apply the ValidateInputAttribute to a
    controller or action.
-->
<pages
    validateRequest="false"
    pageParserFilterType="System.Web.Mvc.ViewTypeParserFilter, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
    pageBaseType="System.Web.Mvc.ViewPage, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"
    userControlBaseType="System.Web.Mvc.ViewUserControl, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=number">
  <controls>
    <add assembly="System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=number" namespace="System.Web.Mvc" tagPrefix="mvc" />
  </controls>
</pages>
<globalization culture="en-US" uiCulture="en-US" /> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T11:35:55.387

可能是由文化信息引起的，某些文化使用`,`而不是`.`小数分隔符。尝试在 web.config 中设置以下内容，

```
<system.web>
    <globalization culture="en-US" uiCulture="en-US" />
</system.web> 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T04:31:59.840

那么，使用 String 作为 DataType 并稍后从 Controller 将其解析为 Decimal 值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-17T12:21:30.550

使用 Decimal 而不是 Double 作为您的数据类型，这可能会有所帮助。

```
public class GpsCoordinateViewModel
{
    decimal Latitute { get; set; }
    decimal Longitude { get; set; }
} 
```

# spring - 嵌套异常是 java.lang.IllegalStateException: No persistence units parsed from {classpath*:META-INF/persistence.xml}

> ID：16058761
> 
> 赞同：0
> 
> 时间：2013-04-17T11:24:43.773
> 
> 标签：spring, jpa, classpath

我的 Spring + hibernate 应用程序有一点问题。我的应用似乎无法找到我的persistance.xml，我基本上已经尝试了每个位置来放置它。似乎没有任何效果。由于我是 spring、hibernate、jpa 的新手......那么这实际上可能是一个我无法弄清楚的小错误。这是我的使用 JPA 的 hibernateContext.xml。

```
 <?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context" xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context-3.1.xsd
       http://www.springframework.org/schema/tx
       http://www.springframework.org/schema/tx/spring-tx-3.1.xsd">

    <context:property-placeholder location="/WEB-INF/jdbc.properties" />

    <tx:annotation-driven transaction-manager="transactionManager" />

    <!-- Declare a datasource that has pooling capabilities-->
    <bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource"
          destroy-method="close"
          p:driverClass="${jdbc.driverClassName}"
          p:jdbcUrl="${jdbc.url}"
          p:user="${jdbc.username}"
          p:password="${jdbc.password}"
          p:acquireIncrement="5"
          p:idleConnectionTestPeriod="60"
          p:maxPoolSize="100"
          p:maxStatements="50"
          p:minPoolSize="10" />

    <!-- Declare a JPA entityManagerFactory-->
    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean" >
        <property name="dataSource" ref="dataSource"/>
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" >
                <property name="databasePlatform">
                    <value>${jdbc.dialect}</value>
                </property>
                <property name="showSql" value="true"/>
            </bean>
        </property>
    </bean>

    <!-- Declare a transaction manager-->
    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
        <property name="entityManagerFactory" ref="entityManagerFactory" />
    </bean>

</beans> 
```

还有我的项目结构：

```
src
   main.java.controller
   main.java.dao
   main.java.model
   main.java.security
   main.java.services
   main.java.webapp
       WEB-INF
           classes
               META-INF
                   persistance.xml
       hibernateContext.xml
       web.xml
       ....
   main.webapp.pages
   .... 
```

错误信息 ：

```
SEVERE: Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in ServletContext resource [/WEB-INF/hibernateContext.xml]: Invocation of init method failed; nested exception is java.lang.IllegalStateException: No persistence units parsed from {classpath*:META-INF/persistence.xml}
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1486)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:524)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:461)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:295)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:223)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:292)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
    at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1117)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:922)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:479)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:112)
    at org.mortbay.jetty.handler.ContextHandler.startContext(ContextHandler.java:549)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:136)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.jetty.Server.doStart(Server.java:224)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at runjettyrun.Bootstrap.main(Bootstrap.java:97)
Caused by: java.lang.IllegalStateException: No persistence units parsed from {classpath*:META-INF/persistence.xml}
    at org.springframework.orm.jpa.persistenceunit.DefaultPersistenceUnitManager.obtainDefaultPersistenceUnitInfo(DefaultPersistenceUnitManager.java:547)
    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.determinePersistenceUnitInfo(LocalContainerEntityManagerFactoryBean.java:309)
    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:258)
    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:310)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1545)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1483)
    ... 22 more
2013-04-17 09:53:19.053:WARN::Failed startup of context org.mortbay.jetty.webapp.WebAppContext@1732ed2{/Fishpoop,C:\Users\Kaspar\Documents\Git\Fishpoop\Fishpoop\src\main\webapp}
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in ServletContext resource [/WEB-INF/hibernateContext.xml]: Invocation of init method failed; nested exception is java.lang.IllegalStateException: No persistence units parsed from {classpath*:META-INF/persistence.xml}
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1486)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:524)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:461)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:295)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:223)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:292)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
    at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1117)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:922)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:479)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:112)
    at org.mortbay.jetty.handler.ContextHandler.startContext(ContextHandler.java:549)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:136)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.jetty.Server.doStart(Server.java:224)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at runjettyrun.Bootstrap.main(Bootstrap.java:97)
2013-04-17 09:53:19.055:WARN::Nested in org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'entityManagerFactory' defined in ServletContext resource [/WEB-INF/hibernateContext.xml]: Invocation of init method failed; nested exception is java.lang.IllegalStateException: No persistence units parsed from {classpath*:META-INF/persistence.xml}:
java.lang.IllegalStateException: No persistence units parsed from {classpath*:META-INF/persistence.xml}
    at org.springframework.orm.jpa.persistenceunit.DefaultPersistenceUnitManager.obtainDefaultPersistenceUnitInfo(DefaultPersistenceUnitManager.java:547)
    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.determinePersistenceUnitInfo(LocalContainerEntityManagerFactoryBean.java:309)
    at org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean.createNativeEntityManagerFactory(LocalContainerEntityManagerFactoryBean.java:258)
    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.afterPropertiesSet(AbstractEntityManagerFactoryBean.java:310)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1545)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1483)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:524)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:461)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:295)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:223)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:292)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
    at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1117)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:922)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:479)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:383)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:112)
    at org.mortbay.jetty.handler.ContextHandler.startContext(ContextHandler.java:549)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:136)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.jetty.Server.doStart(Server.java:224)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at runjettyrun.Bootstrap.main(Bootstrap.java:97)
2013-04-17 09:53:19.186:INFO::Started SelectChannelConnector@0.0.0.0:8080 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:47:17.970

首先，您应该调用它`persistence.xml`而不是`persistance.xml`.

现在添加您的文件`applicationContext.xml`：

```
<property name="persistenceUnitName" value="YourPersistanceUnitName" />
<property name="persistenceXmlLocation" value="classpath:META-INF/persistence/persistence.xml"/> 
```

作为您`entityManagerFactory`的属性，具有正确的持久性单元名称。这应该正常工作

# function - 获取特定工作表名称的函数

> ID：16058763
> 
> 赞同：3
> 
> 时间：2013-04-17T11:24:46.910
> 
> 标签：function, excel, vba

我有一个具有以下外观的工作簿：

![在此处输入图像描述](https://i.stack.imgur.com/IKTVm.gif)

此工作簿的第一个工作表“Resultat”从工作簿中的其他工作表计算数据并将它们呈现为图片所示。

为了使计算正常工作，标记的红色方块中显示的名称必须相同且对应，否则该值将是#####，如您在条目号 2 中看到的那样（单元格 A5 有效并且具有相同的名称为表号 2，但单元格 A8 不起作用，因为它与表号 3 的名称不同）。

我的问题基本上是，是否可以使用在特定单元格中输入工作表名称的函数。在这个例子中，我希望`cell A5`自动获取工作表的名称 with `index 2`，`cell A8`等于 sheet with`index 3`等等。

现在我手动执行此操作，但如果这可以自动化，那将是一个很大的帮助，因为我有很多这些工作簿并且名称不时更改。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T11:56:25.490

使用这个公式

```
=MID(CELL("filename",A1), FIND("]", CELL("filename", A1))+ 1, 255) 
```

以上将为您提供当前工作表的名称

如果您将 A1 的引用更改为相关工作表，那么它将使用该名称。

前任：

```
=MID(CELL("filename",Sheet1!A1), FIND("]", CELL("filename", Sheet1!A1))+ 1, 255) 
```

这会给你`Sheet1`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:54:53.997

创建一个VBA模块并输入以下代码：

```
Public Function SheetNameByIndex(Index As Integer) As String
    SheetNameByIndex = ActiveWorkbook.Sheets(Index).Name
End Function 
```

现在，在工作簿中的任何位置，您都可以

```
=sheetnamebyindex(2)
=sheetnamebyindex(A1) 
```

# c# - 正则表达式使用端口验证域名

> ID：16058764
> 
> 赞同：0
> 
> 时间：2013-04-17T11:24:48.680
> 
> 标签：c#, .net, regex

我是新开发人员，对正则表达式没有太多了解。今天我指定使用正则表达式修复错误，但经过大量努力我无法找到错误。

这是我的要求。

我的代码是：

```
string regex = "^([A-Za-z0-9\\-]+|[A-Za-z0-9]{1,3}\\.[A-Za-z0-9]{1,3}\\.[A-Za-z0-9]    {1,3}\\.[A-Za-z0-9]{1,3}):([0-9]{1,5}|\\*)$";

Regex _hostEndPointRegex = new Regex(regex);

bool isTrue = _hostEndPointRegex.IsMatch(textBox1.Text); 
```

它会为“nikhil-dev.in.abc.ni:8080”之类的域名抛出错误。

我不确定问题出在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:35:51.467

您的正则表达式有点多余，因为您或其他已包含在其他或块中的某些内容。

我只是简化了你必须做的事情

```
(?:[A-Za-z0-9-]+\.)+[A-Za-z0-9]{1,3}:\d{1,5} 
```

它工作得很好......

我不确定为什么您在允许的字符中有 \，因为我很确定在主机名中不允许使用 \。

您的问题是您的或 | 像这样把事情拆散...

```
[A-Za-z0-9\\-]+ 
```

**或者**

```
[A-Za-z0-9]{1,3}\\.[A-Za-z0-9]{1,3}\\.[A-Za-z0-9]{1,3}\\.[A-Za-z0-9]{1,3} 
```

**或者**

```
\* 
```

正如评论员所说，第二个区块中不包括“-”。

所以也许你打算

```
^((?:[A-Za-z0-9\\-]+|[A-Za-z0-9]{1,3})\.[A-Za-z0-9]{1,3}\.[A-Za-z0-9]{1,3}\.[A-Za-z0-9]{1,3}):([0-9]{1,5}|\*)$ 
```

然而，前两个 or'ed 项目将是多余的，因为 + 包括 {1-3}。

IE。[A-Za-z0-9\-]+ 也将匹配与 [A-Za-z0-9]{1,3} 匹配的任何内容

您可以使用此工具来帮助测试您的正则表达式： [http ://regexpal.com/](http://regexpal.com/)

我个人认为每个开发人员都应该有[regexbuddy](http://www.regexbuddy.com/)

上面的正则表达式虽然有效，但将允许无效的主机名。

它应该被修改为不允许在第一个字符中使用标点符号。

所以应该修改成这样。

```
(?:[A-Za-z0-9][A-Za-z0-9-]+\.)(?:[A-Za-z0-9-]+\.)+[A-Za-z0-9]{1,3}:\d{1,5} 
```

同样在理论上，主机不允许以连字符结尾。

这一切都太复杂了，我只会使用正则表达式来捕获部分，然后使用 Uri.CheckHostName 来实际检查 Uri 是否有效。

或者您可以只使用 CodeCaster 建议的正则表达式

# ios - 定制 iPhone 框架的 Mach-O 类型应该是什么？

> ID：16058765
> 
> 赞同：1
> 
> 时间：2013-04-17T11:24:52.170
> 
> 标签：ios, frameworks, linker, symbols

我正在尝试使用[本教程](http://www.blackjaguarstudios.com/blog/programming/2012/11/22/xcode-45-creating-ios-framework-and-hold-my-hand-im-3-years-old)构建一个 iPhone 框架，但是当我构建我的测试应用程序（将使用构建框架的应用程序）时，它出现了一个错误：

```
duplicate symbol _objc_unretainedPointer in:
...
8 duplicate symbols for architecture i386 
```

在终端上，我`nm`调用了框架的二进制文件，它具有正常可执行文件的符号，包括`_main`/ `_objc_unretainedPointer`/etc。难怪会出现重复的错误：框架有自己的可执行符号，测试应用程序也有。

我的问题是，框架的正确 Mach-O 类型应该是什么，以便它没有`_main`/etc 符号？应该如何将它添加到测试应用程序中？

而且...教程也有错误吗？

我尝试过：我将框架的 Mach-O 类型设置为动态库，它摆脱了`_main`/etc 符号并且测试应用程序构建良好，但是当测试应用程序在模拟器上运行时，它有一个`dyld: Library not loaded`错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T03:22:51.540

我解决了我的问题并使设置正常工作，但它没有回答标题问题。

问题是原始问题（教程A）中的教程有误。它缺少我在另一个[**教程**](http://codefriend.blogspot.com/2011/09/creating-ios-framework-with-xcode4.html)（教程 B）中找到的捆绑目标设置。

```
Link With Standard Libraries = No 
```

在教程 A 中，它没有设置，所以它默认为是。在完成教程 B 并将其设置为否后，使用构建框架的测试应用程序成功编译并按预期运行。

要回答标题问题：Mach-O 类型（至少对于本例和教程 A 和 B）应该是**Relocatable Object File**。

# java - Java中的奇怪异常PreparedStatement：参数索引超出范围

> ID：16058768
> 
> 赞同：1
> 
> 时间：2013-04-17T11:25:00.307
> 
> 标签：java, prepared-statement

我有一个字符串

```
 final static String OPENTICID="SELECT j.`uid`,j.`key`,j.`status`,j.`group`,j.`createdDate`,j.`updatedDate`,j.`priority`,j.`reporter`,j.`assignee`,`type`,j.`summary` FROM jira_local j "+ 
"                     INNER JOIN "+
"                      ( SELECT MAX(uid) u FROM jira_local GROUP BY `key` ) x "+
"                      ON j.uid=x.u "+
"                     WHERE convert_tz(createdDate,'+05:30','-05:00') > ? "+
"                      AND `status` IN ('acknowledged','In process','Advanced Investigation','Open','Assigned','More investigation','reopened','New','partenered investigation) "+
"                      AND `group` NOT IN ('l3','jira_pms_connect_l3_support','l3_istay2','l3_expedia','jira-ota-webservices','jira_ota_pushstyle_dev','l3_web_3.0','jira_l3_istay2betasupport','l3_ihotelier','jira_ihotelier_l3_support','l3_databridge','l3_istay2betasupport','istay3 team','reservations l3 development team','jira_ihotelier 3.0_dev') "+
"                     AND convert_tz(updatedDate,'+05:30','-05:00') < ? "; 
```

查询必须`?`使用 PreparedStatement 设置2

以下是我的代码片段

```
con = DBConnector.getInstance().getConnection("travelclick");
            PreparedStatement pst=con.prepareStatement(new StringBuilder("select `group` , count(*) cnt from (" +
                                                        OPENTICID +
                                                        ") y group by `group`").toString());
            System.out.println("select `group` , count(*) cnt from (" +
                                                        OPENTICID +
                                                        ") y group by `group`");
            System.out.println(pst);
            pst.setTimestamp(1, new java.sql.Timestamp(octDate.getTimeInMillis()));
            System.out.println(pst);
            pst.setTimestamp(2, new java.sql.Timestamp(end.getTimeInMillis()));

            ResultSet rs=pst.executeQuery(); 
```

以下是输出

```
select `group` , count(*) cnt from (SELECT j.`uid`,j.`key`,j.`status`,j.`group`,j.`createdDate`,j.`updatedDate`,j.`priority`,j.`reporter`,j.`assignee`,`type`,j.`summary` FROM jira_local j                      INNER JOIN                       ( SELECT MAX(uid) u FROM jira_local GROUP BY `key` ) x                       ON j.uid=x.u                      WHERE convert_tz(createdDate,'+05:30','-05:00') > ?                       AND `status` IN ('acknowledged','In process','Advanced Investigation','Open','Assigned','More investigation','reopened','New','partenered investigation)                       AND `group` NOT IN ('l3','jira_pms_connect_l3_support','l3_istay2','l3_expedia','jira-ota-webservices','jira_ota_pushstyle_dev','l3_web_3.0','jira_l3_istay2betasupport','l3_ihotelier','jira_ihotelier_l3_support','l3_databridge','l3_istay2betasupport','istay3 team','reservations l3 development team','jira_ihotelier 3.0_dev')                       AND convert_tz(updatedDate,'+05:30','-05:00') < ? ) y group by `group`
com.mysql.jdbc.PreparedStatement@1484a05: select `group` , count(*) cnt from (SELECT j.`uid`,j.`key`,j.`status`,j.`group`,j.`createdDate`,j.`updatedDate`,j.`priority`,j.`reporter`,j.`assignee`,`type`,j.`summary` FROM jira_local j                      INNER JOIN                       ( SELECT MAX(uid) u FROM jira_local GROUP BY `key` ) x                       ON j.uid=x.u                      WHERE convert_tz(createdDate,'+05:30','-05:00') > ** NOT SPECIFIED **                       AND `status` IN ('acknowledged','In process','Advanced Investigation','Open','Assigned','More investigation','reopened','New','partenered investigation)                       AND `group` NOT IN ('l3','jira_pms_connect_l3_support','l3_istay2','l3_expedia','jira-ota-webservices','jira_ota_pushstyle_dev','l3_web_3.0','jira_l3_istay2betasupport','l3_ihotelier','jira_ihotelier_l3_support','l3_databridge','l3_istay2betasupport','istay3 team','reservations l3 development team','jira_ihotelier 3.0_dev')                       AND convert_tz(updatedDate,'+05:30','-05:00') < ? ) y group by `group`
com.mysql.jdbc.PreparedStatement@1484a05: select `group` , count(*) cnt from (SELECT j.`uid`,j.`key`,j.`status`,j.`group`,j.`createdDate`,j.`updatedDate`,j.`priority`,j.`reporter`,j.`assignee`,`type`,j.`summary` FROM jira_local j                      INNER JOIN                       ( SELECT MAX(uid) u FROM jira_local GROUP BY `key` ) x                       ON j.uid=x.u                      WHERE convert_tz(createdDate,'+05:30','-05:00') > '2012-10-01 12:00:00'                       AND `status` IN ('acknowledged','In process','Advanced Investigation','Open','Assigned','More investigation','reopened','New','partenered investigation)                       AND `group` NOT IN ('l3','jira_pms_connect_l3_support','l3_istay2','l3_expedia','jira-ota-webservices','jira_ota_pushstyle_dev','l3_web_3.0','jira_l3_istay2betasupport','l3_ihotelier','jira_ihotelier_l3_support','l3_databridge','l3_istay2betasupport','istay3 team','reservations l3 development team','jira_ihotelier 3.0_dev')                     AND convert_tz(updatedDate,'+05:30','-05:00') < ? ) y group by `group`
java.sql.SQLException: Parameter index out of range (2 > number of parameters, which is 1).
    at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:910)
    at com.mysql.jdbc.PreparedStatement.setInternal(PreparedStatement.java:2569)
    at com.mysql.jdbc.PreparedStatement.setInternal(PreparedStatement.java:2600)
    at com.mysql.jdbc.PreparedStatement.setTimestampInternal(PreparedStatement.java:3552)
    at com.mysql.jdbc.PreparedStatement.setTimestamp(PreparedStatement.java:3507)
    at com.cybage.WeeklyStatusReport.OpenTicketsCountReport(WeeklyStatusReport.java:873)
    at com.cybage.WeeklyStatusReport.generateReport(WeeklyStatusReport.java:319)
    at com.cybage.WeeklyStatusReport.main(WeeklyStatusReport.java:1193) 
```

我不知道为什么有一个例外我有 2 个？和 2 个 pst.setTimeStamp()

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:35:39.420

您缺少引号：

```
'partenered investigation) "+
                        ^

                        |
here -------------------- 
```

附带说明一下，这是一个非常糟糕的查询 - 作为存储过程可能更容易维护（在代码中很难阅读）。

# c# - 使用 using 声明实体框架上下文

> ID：16058769
> 
> 赞同：10
> 
> 时间：2013-04-17T11:25:00.387
> 
> 标签：c#, entity-framework

哪个是声明实体框架上下文的最佳实践

```
function()
{
    DBContext context = new DBContext();

    //Entity code

    return ;
} 
```

或者

```
function()
{
    using(DBContext context = new DBContext())
    {
        //Entity code
    }
} 
```

我们需要在 EntityFrameWork 中使用 using 吗？如果是，我的第二个问题

在 DataAccess Layer 中执行 EF 并将结果存储在 IEnumerable 内部使用

我的DL

```
function()
{
    IEnumerable something = null;
    using(DBContext context = new DBContext())
    {
        IEnumerable something = ....
    }
    return something;
} 
```

在控制器中

```
function()
{
    List some = something.ToList();
} 
```

在我的控制器中，我将其作为列表获取，因为我需要执行一些查找操作

```
"The operation cannot be completed because the DbContext has been disposed Entity Framework" 
```

是的，我可以从 DL 返回一个列表，它工作正常

如果我与 IEnumerable 一起使用，我该如何处理？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T11:26:31.703

`.ToList()`您可以通过在`IEnumerable`释放上下文之前调用（即在您的`using`块中）来避免延迟加载 EF 行为

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-17T12:25:56.300

是的，使用是最佳实践，因为它可以清理您的上下文。[Using 语句](http://msdn.microsoft.com/en-us/library/yh598w02%28v=vs.80%29.aspx)是一个快捷方式：

```
try {
    // Execute your code inside the using statement
}
finally {
    // Cleanup the context no matter what by calling .Dispose()
} 
```

请记住，您的上下文可能会返回 IEnumerables，并且由于 EF 支持延迟加载，因此在您将它们提取到具体集合（即 yourResult.ToList()）之前，不会填充这些对象。

在这种情况下会出现一个常见的负面结果：

```
public IEnumerable<Employee> GetEmployeesInAccounting()
{
    using(var myContext = new MyDbContext())
    {
        return myContext.Employees.Where(emp => emp.Department == 'Accounting');
    }
}

// Code that fails, Assuming Manager is a lazy loaded entity, this results in an exception but it compiles no problem
var acctEmps = GetEmployeesInAccounting();
var something = acctEmps.First().Department.Manager.Department; 
```

`.Include(emp => emp.Manager)`您可以通过使用(linq 扩展方法) 并使用绑定结果来避免这种情况`.ToList();`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-17T11:50:02.920

Your request will be executed toward the datasource as soon as you'll call .ToList() method.

That's why you cannot perform .ToList() in your Controller as your context as been disposed at the end of the using block.

In your DL method, just do something like:

```
IEnumerable<Something> function()
{
    using(DBContext context = new DBContext())
    {
      return something.ToList();
    }
} 
```

and in your Controller you'll get an IEnumerable of Something:

```
var mySomethingIEnumerable = DL.Function(); 
```

Hope that helps!

# java - 无法使用 DocFlavor 打印瑞典语字符

> ID：16058771
> 
> 赞同：2
> 
> 时间：2013-04-17T11:25:05.833
> 
> 标签：java

我正在尝试使用 DocFlavor 打印瑞典语字符，但我无法做到。

我的打印机只支持以下口味。

```
Win32 Printer : V2PRINTER supports :
    image/gif; class="[B"
    image/gif; class="java.io.InputStream"
    image/gif; class="java.net.URL"
    image/jpeg; class="[B"
    image/jpeg; class="java.io.InputStream"
    image/jpeg; class="java.net.URL"
    image/png; class="[B"
    image/png; class="java.io.InputStream"
    image/png; class="java.net.URL"
    application/x-java-jvm-local-objectref; class="java.awt.print.Pageable"
    application/x-java-jvm-local-objectref; class="java.awt.print.Printable"
    application/octet-stream; class="[B"
    application/octet-stream; class="java.net.URL"
    application/octet-stream; class="java.io.InputStream" 
```

下面是代码片段

```
 psStream = new FileInputStream("C:\temp.txt"); 
        DocFlavor psInFormat = DocFlavor.INPUT_STREAM.AUTOSENSE;   
        Doc myDoc = new SimpleDoc(psStream, psInFormat, null);
        PrintRequestAttributeSet aset = new HashPrintRequestAttributeSet();   
        try 
        {
            DocPrintJob job = printer.createPrintJob();
            job.print(myDoc, aset);
            psStream.close();
        } 
```

如果有人遇到同样的问题并有解决方案，请告诉我，由于打印机性能问题，我不想使用 Graphics2d 类。

提前致谢。拉维

# java - Get index at new for loop

> ID：16058773
> 
> 赞同：0
> 
> 时间：2013-04-17T11:25:13.597
> 
> 标签：java, for-loop

I have a following for loop

```
ArrayList<User> userList;
for(User user:userList){
    ....
} 
```

How do I get the index of the current obj that im working with? I could change it regular `for(int i...)` loop but this would be counter productive.

Thanks.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:26:53.833

It makes perfect sense to use `for(int i...)` if you want to use the index.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T11:29:20.907

You have to use your own counter like this one

```
int counter = 0;
ArrayList<User> userList;
for(User user:userList){
    ....

counter++;
} 
```

This is because java for each loop is based on iterator which is not based on index based iteration. Actually foreach loop internally uses an iterator. so it doesn't have any index. It moves automatically over the items of a collection or list, grabbing a reference to each one as you need it.

**See this image**

![enter image description here](https://i.stack.imgur.com/Nmiy4.gif)

**In this way iterator traverse each element or object without indexes. So as the for loop.**

or you can use

```
User user = null;

for (int counter = 0; counter < userList.size(); counter++) {
   user  = userList.get(counter);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T11:27:16.373

You could use a separate counter:

```
int index = 0;
for (User user: list) {
    //use index
    index++;
} 
```

But to be honest, if you do need the index, it is probably easier to just use a plain old for loop:

```
for (int i = 0; i < list.size(); i++) {
    User user = list.get(i);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-17T11:29:42.797

This type of looping is called **foreach** loop.. it iterate on collection elements so there is no really index.. it's like vector which have iterator (if you know stl in c++)

The regular for loop as you said (for (int i = 0 ... ) ) will give the index as you want

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-17T11:27:18.223

I'm afraid you'll have to go with this or the for loop with the counter. There is no other way.

```
int index = 0;
for(User user:userList){
    ....
    index++;
} 
```

# android - 从edittext中获取值并将其作为字符串传递给另一个活动

> ID：16058777
> 
> 赞同：0
> 
> 时间：2013-04-17T11:25:34.013
> 
> 标签：android, eclipse, string, android-intent, android-activity

我希望从`edittext`字段中获取值并将其作为字符串传递给另一个活动。我已经完成了如下所示。我认为它可以工作，但我希望能够打印出文本以查看变量值是否实际传递

但是一旦我输入`Log.d("PJM",value);`了活动，就会出现错误

主屏幕活动

```
public class MainScreen extends Activity {

Button btnSearch, btnFavourites;
EditText enterDefinition;
Editable word;

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main_screen);

    btnSearch=(Button)findViewById(R.id.btnSearch);
    btnFavourites=(Button)findViewById(R.id.btnFavourites);
    enterDefinition=(EditText)findViewById(R.id.enterDefinition);

    String text = enterDefinition.getText().toString();

    Intent i = new Intent(this, Definition.class);
    i.putExtra("KEY",text);
    //startActivity(i);

    //Intent i = new Intent(this, Definition.class);
    //i.putExtra("text_Label",theText);
    //startActivity(i); 
```

定义活动

```
public class Definition extends Activity {

Button btnSend, btnSaveFave, btnReturn;
EditText enterDefinition;
String value;
TextView definition;

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_definition);

    btnSend=(Button)findViewById(R.id.btnSend);
    btnSaveFave=(Button)findViewById(R.id.btnSaveFave);
    btnReturn=(Button)findViewById(R.id.btnReturn);
    enterDefinition=(EditText)findViewById(R.id.enterDefinition);
    definition=(TextView)findViewById(R.id.tvDefinition);

    definition.setText("some text");

    Bundle extras = getIntent().getExtras();
    String value = null; 
    if (extras != null) {
      value = extras.getString("KEY");
    }
    else {
      value = "None";
    }
    Log.d("text entered", value);
    Toast.makeText(getBaseContext(), value, Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:29:16.977

你要：

```
String value = null; 
if (extras != null) {
  value = extras.getString("KEY");
}
else {
  value = "None"
}
Log.d("PJM", value); 
```

# sql-server - Visual Studio C# 中的 SQL 查询

> ID：16058782
> 
> 赞同：1
> 
> 时间：2013-04-17T11:25:50.250
> 
> 标签：sql-server, plugins, visual-studio-2012

是否有适用于 Visual Studio 的插件，可以将我的 mssql 字符串显示为实际查询，并带有突出显示，如果可能的话是智能感知。

我不想讨论为什么查询在代码中，它是一个正在运行的项目，并且已经为我做出了这个决定。

现在的代码：

`string sql = @"select * from A where a.Id = @pId"`

我想要的是上面突出显示，所以它看起来像一个查询，所以它显示 select 和 where 作为实际的 sql。我需要的是某种分析器插件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T13:57:34.093

看起来你可以看看[http://visualstudiogallery.msdn.microsoft.com/a3a662c6-28eb-4de9-9a29-d328b1ac3f6b](http://visualstudiogallery.msdn.microsoft.com/a3a662c6-28eb-4de9-9a29-d328b1ac3f6b)来解决你的问题。

# sparql - SPARQL中显式连接示例查询

> ID：16058784
> 
> 赞同：2
> 
> 时间：2013-04-17T11:25:54.907
> 
> 标签：sparql

我有以下 sparql 查询（来自本书，语义网入门）：

```
select ?n
where
{
    ?x rdf:type uni:Course;
        uni:isTaughtBy :949352
    ?c uni:name ?n .
    FILTER(?c=?x) .
} 
```

在这种情况下，我猜这段代码与以下代码相同：

```
Select ?n
Where
{
    ?x rdf:type uni:course;
        uni:isTaughtBy :949352 .
    ?x uni:name ?n .
} 
```

此查询是否会导致编码错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T12:07:42.910

不，我不明白为什么它会给你一个错误或产生错误的结果。只需确保始终使用正确的大小写（`uni:Course`vs. `uni:course`），因为 SPARQL 区分大小写。

老实说，第一个版本似乎相当晦涩，因为它使用了 a`FILTER`而不是真正需要它。也就是说，如果您愿意，您可以进一步缩小查询范围：

```
SELECT ?n
WHERE
{
    ?x rdf:type uni:Course;
       uni:isTaughtBy :949352;
       uni:name ?n .
} 
```

但是，请记住，保存字符并不总能提高可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T18:57:11.847

`FILTER`对于您的示例，是的，查询是相同的，使用over 连接没有任何价值。

* * *

但是，您可能使用该表单的原因是连接和运算符`FILTER`之间的语义差异`=`

连接要求变量的值是完全相同的 RDF 项，而`=`值是否相等 - RDF 项的值是否代表相同的值？当一个/两个值可能具有文字值时，这主要是一个问题

`?x=4`如果你举一个具体的例子，假设和`?c = 4.0`（这对于你的查询来说是一个不好的例子，但说明了这一点），更容易看到

`?x = ?c`会给出`true`而加入不会给出任何结果，因为它们不是完全相同的术语

# c++ - 将 GUI 从 glade 导入 code::blocks

> ID：16058785
> 
> 赞同：0
> 
> 时间：2013-04-17T11:25:55.930
> 
> 标签：c++, xml, user-interface, codeblocks, glade

我想将我在 glade 中制作的测试 GUI 导入到`code::blocks`. 我按照指南将其作为 xml 导入到项目中，无论是否有效，我遇到了一个问题，`code::blocks`找不到`<glade/glade.h>`位于`/usr/include/libglade-2.0/glade/glade.h`.

如果我将包含路径设置为该绝对路径，那么其他`glade.h`需要包含的文件也会出现同样的问题。

我是否需要将 glade 导出到环境变量中，如果需要，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T12:12:58.840

您必须添加`/usr/include/libglade-2.0`到包含目录列表中；这是 Code::Blocks 某处的一个选项。

然后你写`#include <glade/glade.h>`。

# android - Android.database.sqlite.SQLiteException

> ID：16058786
> 
> 赞同：0
> 
> 时间：2013-04-17T11:26:00.783
> 
> 标签：android, sqlite

我正在数据库 order.db 中创建一个名为 order 的表。在执行函数调用“database.execSQL(DATABASE_CREATE)”期间出现错误。

错误如下：

```
04-17 02:06:35.014: E/AndroidRuntime(4612): android.database.sqlite.SQLiteException: near "order": syntax error (code 1): , while compiling: create table order ( _id integer primary key autoincrement, orderName text not null, orderCommission text not null, orderDate text not null, orderSlot text not null, orderGain text not null, orderNO text not null, orderValue text not null);

package com.shoaib.lotteryerp.helper;

import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.util.Log;

public class MySQLiteHelperOrder extends SQLiteOpenHelper {

    public static final String TABLE_ORDER = "Order";
    public static final String COLUMN_ID = "_id";
    public static final String COLUMN_NAME = "orderName";
    public static final String COLUMN_DATE="orderDate";
    public static final String COLUMN_ORDERNO="orderNO";
    public static final String COLUMN_SLOT="orderSlot";

    public static final String COLUMN_ORDERVALUE="orderValue";
    public static final String COLUMN_COMMISSION="orderCommission";
    public static final String COLUMN_GAIN="orderGain";
    private static final String DATABASE_NAME = "order.db";
    private static final int DATABASE_VERSION = 2;

    // Database creation sql statement
    private static final String DATABASE_CREATE = "create table "
            + TABLE_ORDER + "(" + COLUMN_ID
            + " integer primary key autoincrement, " + COLUMN_NAME
            + " text not null, " + COLUMN_COMMISSION + " text not null, "
            + COLUMN_DATE + " text not null, "
            + COLUMN_SLOT + " text not null, "
            + COLUMN_GAIN + " text not null, "
            + COLUMN_ORDERNO + " text not null, " + COLUMN_ORDERVALUE
            + " text not null);";

    MySQLiteHelperOrder(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    public void onCreate(SQLiteDatabase database) {
        database.execSQL(DATABASE_CREATE);
    }

    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.w(MySQLiteHelperOrder.class.getName(),
                "Upgrading database from version " + oldVersion + " to "
                        + newVersion + ", which will destroy all old data");
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_ORDER);
        onCreate(db);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:28:26.270

尝试将表的名称更改为其他名称。`order`是 sql 中的保留字（即`order by`）。

# python - 计算具有巨大中间值的总和

> ID：16058787
> 
> 赞同：1
> 
> 时间：2013-04-17T11:26:01.937
> 
> 标签：python, math

我想计算

![在此处输入图像描述](https://i.stack.imgur.com/z2zV6.jpg)

对于`n`高达`1000000`尽可能准确的值。这是一些示例代码。

```
from __future__ import division
from scipy.misc import comb
def M(n):
    return sum(comb(n,k,exact=True)*(1/n)*(1-k/n)**(2*n-k)*(k/n)**(k-1) for k in xrange(1,n+1))
for i in xrange(1,1000000,100):
    print i,M(i) 
```

第一个问题是`OverflowError: long int too large to convert`当`n = 1101`. 这是因为`comb(n,k,exact=True)`太大而无法转换为浮点数。然而，最终结果始终是一个数字`0.159`。

我在[如何计算具有大中间值的总和中](https://stackoverflow.com/questions/16044801/how-to-compute-sum-with-large-intermediate-values)提出了一个相关问题，但是由于三个主要原因，这个问题有所不同。

1.  我要计算的公式不同，这会导致不同的问题。
2.  从我给出的示例中可以看出，之前提出的使用 exact=True 的解决方案在这里没有帮助。编写我自己的梳子实现也行不通，因为我仍然需要执行浮点除法。
3.  我需要计算比以前更大的值的答案，这会导致新的问题。我怀疑如果不以某种巧妙的方式对总和进行编码，就无法做到这一点。

一个不会崩溃的解决方案是使用

```
from fractions import Fraction
def M2(n):
    return sum(comb(n,k,exact=True)*Fraction(1,n)*(1-Fraction(k,n))**(2*n-k)*Fraction(k,n)**(k-1) for k in xrange(1,n+1))
for i in xrange(1,1000000,100):
    print i, M2(i)*1.0 
```

`n=1101`不幸的是，它现在太慢了，以至于我在合理的时间内 没有得到答案。

所以第二个问题是如何让它足够快地完成大型`n`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T13:12:04.300

您可以使用对数变换计算每个和，该对数变换分别用加法、减法和乘法代替乘法、除法和取幂。

```
def summand(n,k):
    lk=log(k)
    ln=log(n)
    a=(lk-ln)*(k-1)
    b=(log(n-k)-ln)*(2*n-k)
    c=-ln
    d=sum(log(x) for x in xrange(n-k+1,n+1))-sum(log(x) for x in xrange(1,k+1))
    return exp(a+b+c+d)

def M(n):
    return sum(summand(n,k) for k in xrange(1,n)) 
```

请注意，当 k=n 时，加数将为零，因此我不计算它，因为对数将是未定义的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T13:18:05.670

您可以使用[gmpy2](https://code.google.com/p/gmpy/)。它具有具有大指数界限的任意精度浮点运算。

```
from __future__ import division
from gmpy2 import comb,mpfr,fsum

def M(n):
    return fsum(comb(n,k)*(mpfr(1)/n)*(mpfr(1)-mpfr(k)/n)**(mpfr(2)*n-k)*(mpfr(k)/n)**(k-1) for k in xrange(1,n+1))
for i in xrange(1,1000000,100):
    print i,M(i) 
```

这是输出的摘录：

2001 0.15857490038127975
2101 0.15857582611615381
2201 0.15857666768820194
2301 0.15857743607577454
2401 0.15857814042739268
2501 0.15857878842787806
2601 0.15857938657957615

免责声明：我维护 gmpy2。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-17T12:31:54.777

一种相当粗暴的方法是计算所有因子，然后以这样的方式相乘以使结果保持在 1.0 左右（Python 3.x）：

```
def M(n):
    return sum(summand(n, k) for k in range(1, n + 1))

def f1(n, k):
    for i in range(k - 1):
        yield k
    for i in range(k):
        yield n - i

def f2(n, k):
    for i in range(k - 1):
        yield 1 / n
    for i in range(2 * n - k):
        yield 1 - k / n
    yield 1 / n
    for i in range(2, k + 1):
        yield 1 / i

def summand(n, k):
    result = 1.0
    factors1 = f1(n, k)
    factors2 = f2(n, k)
    while True:
        empty1 = False
        for factor in factors1:
            result *= factor
            if result > 1:
                break
        else:
            empty1 = True
        for factor in factors2:
            result *= factor
            if result < 1:
                break
        else:
            if empty1:
                break
    return result 
```

因为`M(1101)`我得到`0.15855899364641846`了，但这需要几秒钟。`M(2000)`大约需要 14 秒并产生`0.15857489065619598`。

（我相信它可以优化。）

# iphone - 如何在不模拟多部分表单的情况下发布图像

> ID：16058789
> 
> 赞同：0
> 
> 时间：2013-04-17T11:26:03.203
> 
> 标签：iphone, ios, nsurlconnection, afnetworking

我正在与 php 开发人员合作，他希望我向他发布图像。但我什么都试过了，包括afnetworking和nsurlconnection。他可以接收文件，但图像已损坏。我所知道的是他在不使用表格的情况下接收图像，我想问我可以在 iphone 中发布没有模拟表格的图像吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:30:11.550

首先，您需要将图像转换为 nsdata

```
NSData *imageData = UIImagePNGRepresentation(_image); 
```

然后将 nsdata 转换为 base64 字符串（您需要下载 base64 的单独文件）

```
NSString *encodedString=[imageData base64EncodedString]; 
```

所以最后你可以将编码的字符串发送到你的php服务器（你需要在你的php服务器中解码编码的字符串来检索图像）

# javascript - d3.js：如何使用地图功能？

> ID：16058791
> 
> 赞同：14
> 
> 时间：2013-04-17T11:26:04.123
> 
> 标签：javascript, d3.js

我怎样才能`d3.map()`摆脱`[10, 12]`以下数组？

```
var mydata = [ 
  { '__data__' : 10 }, 
  {'__data__' : 12 }
]; 
```

我一直在尝试这个，但它不起作用：

```
var mymap = d3.map(mydata, function(d) { 
  return d.__data__; 
}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-17T12:37:01.923

您不能 -`d3.map()`不是用于跨数组映射函数，而是用于散列的垫片。简而言之，虽然对象可以像哈希一样使用，但在某些情况下可能会发生意外行为。一个新的 Javascript 标准为此提出了一个解决方案，并且在它被实施之前，`d3.map()`可以用于相同的效果。

[文档](https://github.com/mbostock/d3/wiki/Arrays#wiki-d3_map)中的更多信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-06-28T16:32:20.797

.map() 只是创建了另一个数组，遍历了你给它的任何东西，并对旧数组中的每个元素执行你定义的函数，然后它就变成了新数组。

因此，如果我想对数组中的所有元素执行单个操作并从中创建一个新数组，我会使用 .map()

例如，当我从 /proc/loadavg 获取的数据每 5-15 分钟平均负载为我提供 0.28、0.03、1.0、0.97、0.04 等数字时，我需要看到以百分比表示的东西。但我还需要在我的计算中运行 nproc 的输出，并且 nproc 给了我有多少核心分布在哪些核心上。所以每次 /proc/loadavg 给我一个新值时我都会创建一个数组，然后我将每个新值推送到一个数组中......

这将是您的初始数据：

```
var data = [0.28,0.03,1.0,0.97,0.04];
var dataSize = 5; 
```

这可能是用于应用于原始数据数组中所有索引的函数：

```
 percent = function () {
      return (loadval/(numCores*100));
   } 
```

这会将其映射到具有转换后值的新数组：

```
 data = d3.range(dataSize).map(percent); 
```

# javascript - Window.prototype.confirm 和 Window.confirm 的区别

> ID：16058793
> 
> 赞同：3
> 
> 时间：2013-04-17T11:26:18.627
> 
> 标签：javascript

`Window.prototype.confirm`和 和有什么不一样`Window.confirm`？

我正在处理一个更改请求，上面写着我们需要在确认消息框上有一个标题。我刚刚浏览了弹出此确认窗口的代码。

在 javascript 中有一个调用

```
Window.prototype.confirm = function(arg){return false;}; 
```

哪个负责弹出确认窗口

我在谷歌搜索有一个像 window.confirm 这样的 javascript 函数，我们无法设置标题，我们需要编写一些自定义的 javascript 函数来做同样的事情

所以我只是想知道是否`Window.prototype.confirm`和`Window.confirm`相同，如果不是有什么区别？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:47:19.287

你没见过`Window.confirm`，它是`window.confirm`。

在 Chrome JavaScript 控制台中逐一键入以下行，这可能有助于阐明这一点。（键入后面的部分`>`，它将打印您在下面看到的内容。）

```
> window.constructor
  function Window() { [native code] }
> window.constructor === Window
  true
> window.confirm === Window.prototype.confirm
  true
> window.confirm = function() { alert('oops'); };
  function () { alert('oops'); }
> window.confirm === Window.prototype.confirm
  false 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:54:05.020

它与 JavaScript 的原生继承模型有关。

1.  **您访问Window原型的confirm方法。**

    Window.prototype.confirm

2.  **您可以访问名为 window 的 Window 实例的 confirm 方法。**

    window.confirm（注意小写 w）

如您所见， window 是 Window 的一个实例，这意味着如果您更改 window.confirm ，则您仅针对此特定实例更改了它。Window 的其他实例将具有原始功能。但是，如果您更改 Window 原型的确认功能，则所有 window 实例都将使用新的实现。

使用自定义对象来说明。

```
function MyObject () {

}

MyObject.prototype.test = function () {
     alert('A');
}

var myobj1 = new MyObject();
var myobj2 = new MyObject();

myobj1.test(); // alerts A
myobj2.test(); // alerts A

myobj1.test = function () { alert('B'); };

myobj1.test(); // alerts B
myobj2.test(); // alerts A

MyObject.prototype.test = function () { alert('C'); };

myobj1.test(); // alerts C
myobj2.test(); // alerts C 
```

# php - 如何在 PHP 中处理 Oracle CLOB？

> ID：16058811
> 
> 赞同：0
> 
> 时间：2013-04-17T11:27:05.253
> 
> 标签：php, oracle, save, clob

我昨天问了这样一个问题，但我还没有得到任何答案。

要点：如何在 insert into 或 update 语句中获取 CLOB 引用：

```
$sql = "INSERT INTO table (data) VALUES (EMPTY_CLOB()) RETURNING data INTO :data";
$statement = oci_parse($conn, $sql);
$descriptor = oci_new_descriptor($conn, OCI_DTYPE_LOB);
oci_bind_by_name($statement, ':data', $descriptor, -1, OCI_B_CLOB);
oci_execute($statement);
$descriptor->save('5000 chars');
oci_free_descriptor($descriptor); 
```

所以，我想在没有插入和更新语句的情况下调用 clob 保存方法。所以我尝试了：

```
$sql = "SELECT data FROM table WHERE id = " . $fooid;
$statement = oci_parse($conn, $sql);
oci_execute($statement);
$row = oci_fetch_assoc($statement);
$row['DATA']->save('5000 chars'); 
```

如何？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T14:55:51.480

```
$sql = "INSERT INTO table t (t.data) VALUES (EMPTY_CLOB()) RETURNING t.data.clob INTO :data";
$statement = oci_parse($conn, $sql);
$descriptor = oci_new_descriptor($conn, OCI_DTYPE_LOB);
oci_bind_by_name($statement, ':data', $descriptor, -1, OCI_B_CLOB);
oci_execute($statement, 0); //no commit!!!
$descriptor->save('5000 chars');
oci_commit($conn);
oci_free_descriptor($descriptor); 
```

# php - 使用 CURL 播放 Youtube 视频

> ID：16058817
> 
> 赞同：1
> 
> 时间：2013-04-17T11:27:20.443
> 
> 标签：php, json, curl, oembed

我正在使用 CURL 来获取这样的 Youtube 页面：

```
$url = "https://www.youtube.com/watch?v=jyPnQw_Lqds";

$ch = curl_init($url);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
$curl_scraped_page = curl_exec($ch);
curl_close($ch);

echo $curl_scraped_page; 
```

视频好像不能播放，不知道为什么。`format json`我找到了一个脚本，它通过将数据设置为，然后像这样将其解码`json`为普通格式，从而解决了这个问题`html`：

```
$youtube = "http://www.youtube.com/oembed?url=" . $url. "&format=json";

$curl = curl_init($youtube);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
$return = curl_exec($curl);
curl_close($curl);

$result = json_decode($return, true);
echo $result['html']; 
```

我试图将这两个脚本“合并”为一个脚本。我把脚本放在一起是这样的：

[PHPFiddle 示例，单击运行（F9）按钮](http://phpfiddle.org/main/code/qnf-twg)

如您所见，顶部的视频无法播放。如果您向下滚动到底部，您将看到另一个视频（这是 JSON 回显的视频），这个视频实际上可以播放。

如何让上（顶部）视频播放？我在考虑首先“找到”“对象”，然后格式化为 json 等。但我担心这会弄乱页面。

# css - 如何使 div 以固定位置水平居中？

> ID：16058823
> 
> 赞同：9
> 
> 时间：2013-04-17T11:27:49.477
> 
> 标签：css, html, center

我希望 div 水平居中，css代码是这样的：

```
<style type="text/css">
#footer{
    position: fixed;
    bottom: 20px;
    background-color: red;
    width:500px;
            margin: auto;/*left:auto; right:auto;*/
}
</style> 
```

和html代码：

```
<body>
<div id="footer">hello world</div>
</body> 
```

我认为没有必要解释我的css代码，它几乎是不言自明的，但是div不是水平居中的，有什么办法可以做到这一点？提前致谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-17T11:32:36.807

试试这个

```
#footer{
    position: fixed;
    bottom: 20px;
    background-color: red;
    width:80%;
    margin: 0 0 0 -40%;
    left:50%;
} 
```

[JS 小提琴示例](http://jsfiddle.net/7Q47W/)

这里要注意的一点是，`margin-left`正好半个值的负值，`width`并设置`left`了身体的 50%

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-17T11:37:59.403

这应该适合你。它通过添加容器 div 来工作。

```
<style>

#footer-container{
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  text-align: center;
}

#footer
{
    width:500px;
    margin:0 auto;
    margin-bottom:20px;
    background-color:red;
}
</style>

<div id="footer-container">
      <div id="footer">hello world</div>
</div> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-17T11:30:05.233

在其中放置另一个具有相对位置的 div，margin: auto。给固定的一个 100% 宽度。

否则你可以用负边距“技巧”破解它

```
div { 
    position: fixed;
    left: 50%;
    width: 500px;
    margin-left: -250px;
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-12-25T05:09:40.773

如果您使用现代浏览器，您可以使用 flexbox 布局模块：[http](http://caniuse.com/#feat=flexbox) ://caniuse.com/#feat=flexbox 。

Flexbox 文档：developer.mozilla.org/en-US/docs/Web/Guide/CSS/Flexible_boxes
*注意：由于我的代表，不能发布两个以上的链接。*

* * *

[JSF](http://jsfiddle.net/pa6ttkg1/4/)中。

（使用`footer`标签而不是 a`div#footer`因为它更简单。）

```
<div id="footer-container">
  <footer>hello world</footer>
<div> 
```

```
#footer-container {
  bottom: 20px;
  position: fixed;

  display: flex;
  justify-content: center;
  width: 100%;
}

footer {
  width: 500px;

  background-color: red;
} 
```

`justify-content: center;`'centers'`#footer-container`的孩子，这只是`footer`本例中的元素。

这与 Nick N. 的解决方案非常相似，只是您不必重置页脚上的`text-align`属性，而且这可能是您想要的非“技巧”方式。

可接受的解决方案略有偏差，因为在这种情况下页脚的宽度是可变的 (80%) 而不是 500 像素。

* * *

对于其他读者，如果您的父级是一个`form`元素，而子级是一个`input`元素，`flex: 1;`请在`input`(child) 元素上使用，并使用`max-width: 500px;`而不是`width: 500px;`. 使用`flex: 1;`应该使`input`元素扩展以填充`form`元素的宽度，否则它可能不会这样做。

# cucumber - Gherkin and Cucumber 的特色和场景是什么？

> ID：16058824
> 
> 赞同：7
> 
> 时间：2013-04-17T11:27:52.857
> 
> 标签：cucumber, bdd, gherkin

假设我正在使用 Cucumber 开发购物车 BDD。购物车相当复杂并且有很多花里胡哨的东西，但这对于“博客”或“用户资料”可能同样适用。

我一直认为“购物车”是*Feature*，而花里胡哨的是*Scenario*。但是，这可能会生成大型*Feature*文件，并且与*Scenario*的字面意思相违背。这是看起来的样子：

```
Feature: Cart

  So that I can buy items
  As a user
  I want to place items in a cart

  #.... Many more scenarios

  Scenario: Empty a filled cart
    Given 2 products in my cart
    When I visit the cart page
    And I press "Empty cart"
    Then I should see the text:
      """
      Your cart is empty.
      """

  Scenario: Empty an empty cart
    Given 0 products in my cart
    When I visit the cart page
    Then I should not see the "Empty cart" button

  # Many more Scenario's 
```

填写的细节越多，这个“空车”组就会变得越长。我想知道，“清空购物车”是否应该被视为独立功能？这将导致许多*Features*，都包含但几个*Scenario*的。然后*场景*变得更像“上下文”。像这样：

```
Feature: Emptying Cart

  So that I can reconsider my shopping-spree
  As a user
  I want to empty my cart

  Scenario: with a filled cart
    Given 2 products in my cart
    When I visit the cart page
    And I press "Empty cart"
    Then I should see the text:
      """
      Your cart is empty.
      """

  Scenario: with an empty cart
    Given 0 products in my cart
    When I visit the cart page
    Then I should not see the "Empty cart" button 
```

什么是使某物成为*Feature*的好指南？我什么时候应该将*Scenario*重新组合到他们自己的*Feature*中？一个*功能*通常有多少个*场景？*

 ** * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-18T14:50:09.620

你可以缩短你的场景——甚至去掉一些——通过用[声明性而不是命令性](http://dannorth.net/2011/01/31/whose-domain-is-it-anyway/)语言来表达它们。

例如：

```
Given the cart has two products in
When I empty the cart
Then I should see it has nothing in it. 
```

对于实际的购物车和 UI，这可能是一样的。它没有实现细节。您可以看到其中一些步骤与您的多个步骤相对应；这是一件好事，因为它将代码的复杂性保持在更易于维护的地方。

如果我们以这种方式表达您的其他情况，我们会得到：

```
Given my cart is empty
Then I should not be able to empty it again. 
```

这里没有“何时”，因为“那么”对于那个状态来说是正确的。

但是，您真的需要这种情况吗？释放清空已经空的购物车的能力会杀死您或您的公司吗？这本质上是审美。添加它是为了使 UI 更易于使用，并且判断 UI 是否可用的*唯一方法是实际使用它。*如果您发现此类情况，我建议您将其删除。您始终可以对导致启用或禁用按钮的逻辑进行单元测试。

如果您更改为这种语言风格，然后删除任何仅测试美学和可用性的场景，您会发现您的功能文件变得非常非常小。

我还建议将最有趣或最令人惊讶的场景放在顶部。例如，这将是一个更有趣的场景（是的，它有两个“时间”，因为它描述了与两个不同用户之间的交互相关的行为）：

```
Given a user put a copy of "Moby Dick" in his cart
When the last copy of "Moby Dick" is sold
And the user comes back to look at his cart
Then it should tell him, "Sorry, this item is currently out of stock." 
```

这会更有趣：

```
Given a user put a new copy of "Moby Dick" in his cart
And there are second-hand copies of "Moby Dick" available
When the last new copy of "Moby Dick" is sold
And the user comes back to look at his cart
Then it should tell him, "Sorry, this item is currently out of stock."
And it should also show the way to the second-hand copies with,
  "2nd hand copies are available." 
```

那将是一个与众不同的场景；您的商店与其他商店的做法不同，因此对企业非常感兴趣。

通过将最有趣的放在顶部，功能文件很长并不重要。我们都知道购物车是如何买卖物品的，无论如何我们都没有在那个阶段阅读底部的场景。

[安迪·韦特](https://stackoverflow.com/a/16071408/363592)说没有硬性规则是对的，所以要听天由命；如果它不起作用，请做一些不同的事情。希望这些提示也会有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T22:33:45.960

您可以将功能分组到文件夹中，例如，您可能有一个文件夹`cart`，然后是 、 等的功能`emtpy_cart.feature`文件`update_cart.feature`。

没有硬性规定，但我个人不会在单个功能文件中放置超过 8 个场景。

查看 Relish 自己的文档，了解如何构建功能的一个很好的例子：[https ://www.relishapp.com/relish/relish](https://www.relishapp.com/relish/relish)*

# android - 在 PC 上看不到通过 getExternalStoragePublicDirectory 保存的图片

> ID：16058826
> 
> 赞同：1
> 
> 时间：2013-04-17T11:28:01.400
> 
> 标签：android, camera, file-permissions, save, nexus-7

**链接到问题底部的解决方案/解决方法**

我使用[Android 教程](http://developer.android.com/guide/topics/media/camera.html)编写代码，通过意图打开 nexus 7 相机并拍照。除非我更改文件对象初始化代码，否则它拒绝正常工作

`File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory( Environment.DIRECTORY_PICTURES), "MyCameraApp");`

至

`File mediaStorageDir = new File(Environment.getExternalStoragePublicDirectory( Environment.DIRECTORY_PICTURES) + File.separator +"MyCameraApp");`

甚至在被调用`intent.getData()`时仍然为空`onActivityResult`。回到手头的问题：我可以在平板电脑本身上看到保存的图像浏览，但当我通过 USB 在 PC 上浏览它时看不到。

我究竟做错了什么？我认为使用`getExternalStoragePublicDirectory`完全可访问的文件。我的代码可能还有其他问题吗？我是否需要以某种方式“告诉”库存相机应用程序将其保存为`MODE_WORLD_READABLE`或类似的东西？

花费数小时试图使其正常工作 - 任何帮助将不胜感激！

如果有帮助，我可以发布我的其余代码——尽管它几乎与[Android 教程](http://developer.android.com/guide/topics/media/camera.html)相同。

**编辑：**这是由 nexus 7 和 4 的已知问题引起的。请参阅第二个链接以获取解决方案

[在 Nexus 7 上的外部存储上保存文件并从 PC 检索](https://stackoverflow.com/questions/14346160/saving-files-on-external-storage-on-nexus-7-and-retrieving-from-pc?rq=1)

[Nexus 4 未通过 MTP 显示文件](https://stackoverflow.com/questions/13737261/nexus-4-not-showing-files-via-mtp)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:50:03.917

I do something similar like this:

```
File photo = new File(Environment.getExternalStorageDirectory(),
                "filename.jpg");
        mImageUri = Uri.fromFile(photo);
        Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE)
                .putExtra(MediaStore.EXTRA_OUTPUT, mImageUri);
        startActivityForResult(intent, REQUEST_CODE_TAKE_PHOTO); 
```

And after take and save photo call from terminal (or cmd):

adb pull /mnt/storage/sdcard/filename.jpg c:\folder

and get result photo from c:\folder. You can use Log or debugger to monitoring mImageUri address on your device.

PS: And dont forget permissions [about permissions](http://developer.android.com/guide/topics/media/camera.html#manifest)

# d3.js - d3刷部分更新轴不是圆圈

> ID：16058829
> 
> 赞同：1
> 
> 时间：2013-04-17T11:28:13.823
> 
> 标签：d3.js, brush, bubble-chart

我准备了一个气泡图，你可以用画笔在刻度下方的灰色区域放大它。这是[小提琴](http://jsfiddle.net/LfBva/9/)。下面的代码更新了图表。它正在更新标尺而不是图形。任何人都可以指出原因吗？

```
function brushmove(){
            x_axis.domain(brush.empty() ? x_axis.domain() : brush.extent());
       svg.select('.ruler').call(x_axis_ruler);

      blue_circle.selectAll('circle').data(dataset)
      .attr('cx', function (d, i) {
            return x_axis(d.waiting_to_be_processed_time);
        })

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:17:58.860

我不知道为什么，但您不应该使用变量 blue_circle 来更新宽度。

相反，您应该用以下代码替换代码：

```
function brushmove(){
            x_axis.domain(brush.empty() ? x_axis.domain() : brush.extent());
       svg.select('.ruler').call(x_axis_ruler);

      d3.select('.processing_circles').selectAll('circle').data(dataset).attr('cx', function (d, i) {
            return x_axis(d.waiting_to_be_processed_time);})

    } 
```

我留下了让更有经验的用户结帐的原因。

# javascript - Javascript 多菜单。如果我单击一个 ul，我希望另一个关闭。（图格尔）。一直开着，怎么解决？

> ID：16058839
> 
> 赞同：1
> 
> 时间：2013-04-17T11:28:45.217
> 
> 标签：javascript

希望你能帮我解决我的问题。已经烦了很长时间了。

试图让我的菜单工作。

当我单击一个块时，我希望它打开，然后关闭另一个选项卡“如果”另一个选项卡是打开的。

最好的问候 jfb

**这里是 JSFIDDLE** [http://jsfiddle.net/3ZWZu/](http://jsfiddle.net/3ZWZu/) *包括 HTML、CSS、JS(jQuery)*

```
$(document).ready(function() {

$('.ac-menu .topLevel').click(function(e) {
    e.preventDefault();

        if($('.ac-menu .topLevel ul').hasClass('open') === true){
        $('.ac-menu .topLevel ul').removeClass('open'); 
        $('.ac-menu .topLevel ul').addClass('closed');  
        $('.ac-menu .topLevel ul').slideUp(300);

    }
        if($(this).next('ul').hasClass('closed') === true){ 
        $(this).next('ul').removeClass('closed');           
        $(this).next('ul').slideDown(300);
        $(this).next('ul').addClass('open');
    }
 });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:00:06.647

假设你使用 JQuery，试试这个：

```
$(document).ready(function() {    
 $('.ac-menu .topLevel').click(function(e) {
    e.preventDefault();    
    $('.ac-menu ul.open').removeClass('open').addClass('closed').slideUp(300);    
    $(this).next('ul.closed').removeClass('closed').slideDown(300).addClass('open');
  });
}); 
```

基本上，这背后的想法是使用`ul.open`or`ul.closed`选择器，您将只选择`ul`具有该特定类集的 s。如果没有——那么 JQuery 将返回一个空集并且不会将这些操作应用于任何东西——这就是 JQuery 的工作方式。此外，它允许您链接命令，如我的示例所示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T12:23:54.587

我认为你需要那个[jsfiddle](http://jsfiddle.net/mido_rizk007/3ZWZu/7/)

我将`topLevel`类添加到 li 而不是`a href`

```
$(document).ready(function() {
  $('.ac-menu li.topLevel').click(function(e) {
    e.preventDefault();
    var isClosed = $(this).find('ul').hasClass('closed');
    $('.ac-menu li.topLevel ul').removeClass('open').addClass('closed').slideUp(300);
    if( isClosed){
        $(this).find('ul').addClass('open').removeClass('closed').slideDown(300);
    }
 });
}); 
```

# php - 如何通过在某些条件下首先输入值来在第二个文本框中显示值

> ID：16058841
> 
> 赞同：0
> 
> 时间：2013-04-17T11:28:46.187
> 
> 标签：php, javascript, jquery

问候大家，有什么方法可以在第二个文本框中获取值，我有一些文件，如图所示，![在此处输入图像描述](https://i.stack.imgur.com/h8f0U.png) 如果我们在结果文本框中键入 90，那么 nor/ab 字段的值自动应该是“低”，因为180应该很高。所以我们必须检查 110-170（范围字段）的条件...

实际上，我对 110-170 形式的范围字段的值感到困惑......任何想法将不胜感激......在此先感谢......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:55:30.610

尝试这样做：

```
var result = $('#result');
var sel = $('#select');

result.on('keydown keyup', function () {
   if (result.val() < 90) {
      $('option[value="low"]', sel).prop('selected', true);
    } else if (result.val() > 90) {
      $('option[value="high"]', sel).prop('selected', true);
    }
}); 
```

### [演示小提琴](http://jsfiddle.net/kdUG3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:40:41.080

如果需要，它可以改进为更具可读性，但它应该可以解决问题：

```
$("#result").on('keyup',function(){
    if($(this).val()<110){
    $("#select").val("low");
    }
    else if($(this).val()<=170){
        $("#select").val("normal");
    }
    else{
            $("#select").val("high");
    }
}) 
```

[http://jsfiddle.net/YWUrR/](http://jsfiddle.net/YWUrR/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T11:34:40.507

```
var result = $("#result").val();
if(result >= 110 || result <=170){
 $("#nor").val('Normal');
}
else if(result == 90){
  $("#nor").val('Low');
}
else if(result == 180){
  $("#nor").val('High');
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T11:38:25.963

假设您的行包含在父 div 中：

```
$('.result').change(function(){
    level = (($(this).val() < 170) ? 'low' : 'high');
    $(this).parent().find('.nor').val(level);
} 
```

# sql - 将两种类型的铸造添加到单列中

> ID：16058843
> 
> 赞同：4
> 
> 时间：2013-04-17T11:29:10.563
> 
> 标签：sql, sql-server, sql-server-2008, casting

我的表中有一个名为“薪水”的列。值存储的另一个表

*   同样是 50 万 12000..

**我要结果**

*   5*10000+12*1000

**我创建了一个查询，**

```
SELECT TOP(10) 'INSERT INTO jobs(Budget) VALUES('+
CAST(SUBSTRING(
      CAST(r.Budget AS VARCHAR(50)), 0, PATINDEX('%laks%', r.Budget))*100000 AS VARCHAR(50))
      + ',' +CAST(SUBSTRING(
      CAST(r.Budget AS VARCHAR(50)), PATINDEX('%laks%', r.Budget) + 4
    ,patindex('%Thousands%', r.Budget) - PATINDEX('%laks%', r.Budget) - 4)* 1000  AS VARCHAR(50))+')'
    FROM requirementsdetailsfororganization r 
```

在这里，我可以将单独的值相乘。我不能添加两个值。

当我使用上面的查询时，我的结果是

```
INSERT INTO jobs(Budget) VALUES(200000,5000) 
```

**预期输出：**

```
INSERT INTO jobs(Budget) VALUES(205000) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-17T11:40:41.020

```
SELECT TOP(10) 'INSERT INTO jobs(Budget) VALUES('+
        CAST(SUBSTRING(CAST(r.Budget AS VARCHAR(50)), 0, PATINDEX('%laks%', r.Budget))*100000
            + SUBSTRING(CAST(r.Budget AS VARCHAR(50)), PATINDEX('%laks%', r.Budget) + 4, 
                                                       patindex('%Thousands%', r.Budget) - PATINDEX('%laks%', r.Budget) - 4)* 1000 AS VARCHAR(50))+')'
    FROM requirementsdetailsfororganization r 
```

# php - 网址缩短器 PHP

> ID：16058844
> 
> 赞同：3
> 
> 时间：2013-04-17T11:29:12.373
> 
> 标签：php, .htaccess, url-rewriting

我正在寻找创建一个 URL Shortener，尽管我遇到了一个我无法思考的问题。我需要用户能够通过使用斜杠（`/`）而不是`?=`例如的获取请求找到他的 ID，

而不是使用`oli.pw?id=100`我需要它是`oli.pw/100`.

我研究了 URL 重写，但老实说，我不知道如何通过所有 get 请求来实现这一点。

如果这还不够详细，请在下面发表评论。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:38:03.210

你的意思是？

```
RewriteEngine On

RewriteCond %{THE_REQUEST} ^(GET|HEAD)\ /(index\.php)?\?id=([0-9]+)([^\ ]*)
RewriteRule ^ /%3?%4 [L,R=301]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([0-9]+)/?$ /?id=$1 [L,QSA] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-17T11:34:18.787

这是一些基本 url 重写的简短示例，

```
RewriteEngine on
RewriteRule ^([0-9]+)$ index.php?id=$1 [L,QSA] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-17T11:33:51.580

您需要创建一个`.htaccess`文件并在其中配置您的重写规则。

您将需要类似的东西：

```
RewriteEngine on    
RewriteRule ^([0-9]+)/$ ?id=$1 
```

你应该阅读更多关于`mod_rewrite` [这里。](http://httpd.apache.org/docs/2.0/misc/rewriteguide.html)

# javascript - JS 乘法和 parseFloat() 有点奇怪

> ID：16058848
> 
> 赞同：3
> 
> 时间：2013-04-17T11:29:17.590
> 
> 标签：javascript, math

好的，这就是我所拥有的

```
amount = parseFloat("0.07") * 100; 
```

这就是我得到的回报

```
7.000000000000001 
```

谁能告诉我为什么？它只发生在 0.07... 其他数字正确转换，例如 0.01 或 0.06。

# c# - 在固定大小的标签中自动调整文本大小以避免文本跳转到第二行

> ID：16058858
> 
> 赞同：2
> 
> 时间：2013-04-17T11:29:49.470
> 
> 标签：c#, string, winforms, label, autosize

我有一个固定大小的标签，大约 100 像素宽和 20 像素高。

当我将一个长字符串放入标签时，文本会换行到第二行，但我看不到第二行，因为标签的大小是固定的。

我不想换行到第二行，而是希望字体大小缩小，以便字符串显示在标签的单行上。有谁知道一个简单的方法来做到这一点？

**编辑：**

下面的代码对我有用（大部分时间）。我不想做任何递归的事情。有时文本仍然溢出到另一行。我假设是因为我不能真正使用标签的整个宽度。我该如何弥补？

```
private void Label_TextChanged(object sender, EventArgs e)
{
    Label label = sender as Label;

    if (label != null && label.Text.Length != 0)
    {
        SizeF size = new SizeF();
        using (Graphics g = label.CreateGraphics())
        {
            size = g.MeasureString(label.Text, label.Font);
        }

        Single x = (label.Width) / size.Width;
        Single y = (label.Height) / size.Height;
        Single scaler = x > y ? y : x;

        using (Font font = label.Font)
        {
            label.Font = new Font(font.Name, font.SizeInPoints * scaler);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:34:42.033

这很容易做到。使用[Graphics.MeasureString(...)](http://msdn.microsoft.com/en-us/library/6xe5hazb.aspx)确定字符串所需的宽度，然后逐渐使字体越来越小，直到字符串所需的宽度等于或小于标签的宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:35:18.117

您可以使用`System.Windows.Forms.Label.TextChanged`-event 并检查字符串的长度。

```
private void Label_TextChanged(object sender, EventArgs e){
    System.Windows.Forms.Label label = sender as label;
    if(label != null){
       //check text-length and if necessary resize it
    } 
} 
```

看到[这里](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.textchanged.aspx)-`TextChanged`事件。

有`FontHeight`-property，它可能会做你的伎俩。请参阅[此处](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.fontheight.aspx)以获取参考。

如果一切都失败了，从`System.Windows.Forms.Label`并创建您自己的自定义标签。

# objective-c - 从objective-c中解析的NSString中提取单个值

> ID：16058865
> 
> 赞同：7
> 
> 时间：2013-04-17T11:30:16.130
> 
> 标签：objective-c, regex, nsstring, nsarray, nsregularexpression

这些是我简化的示例 NSStrings（解析为数组）。

单个字符串对象被解析为 "STRING1, STRING2 then DATE TIME then - A:VALUE"，例如：

```
The name of first value, first 17/04/2013 11:30:00 - A:30.0 // sometimes there is a comma after first string
The name of second value 17/04/2013 11:00:00 - A:20.0 // sometimes there is NOT a comma after first string
Name of third value 17/04/2013 10:30:00 - A:40.0
Fourth 17/04/2013 09:40:00 - A:50.0
Fifth value 17/04/2013 05:00:00 - A:10.0 
```

好吧，我需要提取STRING或STRING的单独值，STRING：

```
The name of first value, first
The name of second value
Name of third value
Fourth
Fifth value 
```

然后是日期和时间

```
17/04/2013 11:30:00
17/04/2013 11:00:00
17/04/2013 10:30:00
17/04/2013 09:40:00
17/04/2013 05:00:00 
```

最后，单一的价值：

```
30.0
20.0
40.0
50.0
10.0 
```

**编辑：**我正在尝试使用 Martin R 的代码来解析 *allValues：

```
The *allValues array is something like: 
    (
        "The name of first value, first 17/04/2013 11:30:00 - A:30.0",
        "The name of second value 17/04/2013 11:00:00 - A:20.0",
        "Name of third value 17/04/2013 10:30:00 - A:40.0",
        "Fourth 17/04/2013 09:40:00 - A:50.0",
        "Fifth value 17/04/2013 05:00:00 - A:10.0"
    ) 
```

这是提取单个值的代码：

```
NSMutableArray *allValues = [parsedFeed valueForKey:@"values"];

for (int i=1; i < [allValues count]; i++) {
    NSString *string = [allValues objectAtIndex:i];
    NSString *pattern = @"(.*) (\\d{2}/\\d{2}/\\d{4} \\d{2}:\\d{2}:\\d{2}) - A:(.*)";
    NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:pattern options:0 error:NULL];
    NSTextCheckingResult *match = [regex firstMatchInString:string options:0 range:NSMakeRange(0, [string length])];

    if (match != nil) {
    NSString *s1 = [string substringWithRange:[match rangeAtIndex:1]];
    NSString *s2 = [string substringWithRange:[match rangeAtIndex:2]];
    NSString *s3 = [string substringWithRange:[match rangeAtIndex:3]];
    NSLog(@"First part:  %@", s1);
    NSLog(@"Second part: %@", s2);
    NSLog(@"Third part:  %@", s3);
    }
} 
```

但在这种情况下，我无法获得任何 NSLog 结果（**match == nil**）。发生了什么事？谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-17T11:56:12.853

如果 DATE/TIME 具有固定格式，则可以使用正则表达式：

```
NSString *string = @"The name of first value, first 17/04/2013 11:30:00 - A:30.0";
NSString *pattern = @"(.*) (\\d{2}/\\d{2}/\\d{4} \\d{2}:\\d{2}:\\d{2}) - A:(.*)";
NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:pattern
                                       options:0 error:NULL];
NSTextCheckingResult *match = [regex firstMatchInString:string options:0 range:NSMakeRange(0, [string length])];
if (match != nil) {
    NSString *s1 = [string substringWithRange:[match rangeAtIndex:1]];
    NSString *s2 = [string substringWithRange:[match rangeAtIndex:2]];
    NSString *s3 = [string substringWithRange:[match rangeAtIndex:3]];
    NSLog(@"First part:  %@", s1);
    NSLog(@"Second part: %@", s2);
    NSLog(@"Third part:  %@", s3);
} 
```

输出：

```
第一部分：第一个值的名称，first
第二部分：17/04/2013 11:30:00
第三部分：30.0

```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-17T11:50:05.103

NSString 类提供了许多不同的方法来完成你想要的。查找、组合和划分字符串和子字符串。看看这些方法，我相信你可以将它们组合起来得到你想要的字符串。我认为您将需要一些 if() else 大括号。

[http://developer.apple.com/library/ios/#Documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html](http://developer.apple.com/library/ios/#Documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

希望这对您有所帮助。

# php - 使用 Facebook 分享按钮分享视频

> ID：16058870
> 
> 赞同：0
> 
> 时间：2013-04-17T11:30:26.943
> 
> 标签：php, facebook, facebook-javascript-sdk

我尝试使用 Facebook 分享按钮分享视频，但视频未显示且未分享。

这是我的代码：

```
<script type="text/javascript">

jQuery(document).ready(function(){

jQuery('#share_button').click(function(e){

e.preventDefault();

var obj = {
          method: 'feed',
          name: 'Co-Operation Hub Hour Sharing To Your Buddy!',
          source : 'http://vimeo.com/user15830580/cooperationhub',
          type : 'video'
      };

  FB.ui(obj, callback);

   });

});

</script> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-05-23T17:29:15.027

快速浏览[Facebook 官方开发者文档进行分享](https://developers.facebook.com/docs/sharing/reference/share-dialog/)。这是您的代码中存在问题的部分...

```
var obj = {
      source : 'http://vimeo.com/user15830580/cooperationhub',
  }; 
```

`source` *不在*API 的指定选项上。

要共享 URL，请使用`href`，如官方文档页面中所示....

```
var obj = {
      href : 'http://vimeo.com/user15830580/cooperationhub',
  }; 
```

# c++ - 传递函数指针时出现分段错误

> ID：16058872
> 
> 赞同：0
> 
> 时间：2013-04-17T11:30:28.097
> 
> 标签：c++, segmentation-fault

我正在使用 Solaris。我得到分段错误的代码在 .so 里面。我们几乎没有静态函数，基本上这些函数是回调函数。我通过将这些函数的地址传递给另一个函数来将这些函数设置为回调函数。只有其中一个函数在作为参数传递之前的地址看起来是正确的，但是在进入函数设置函数指针之后，它变成了一些垃圾指针并通过该指针调用函数崩溃。我放了一些示例代码，它不是实际代码，但与此类似。

在 A.cpp 中，我有三个回调函数

```
static void Func1(A* ptr)
{
}

static void Func2(A* ptr)
{
}

static void Func3(A* ptr)
{
} 
```

在一个注册函数中，我将它们分配为回调函数

```
void vRegisterCallback(void (*ptrToFunc)(void*))
{
}

void Register()
{
    vRegisterCallback(void (*)(void*)Func1);
    vRegisterCallback(void (*)(void*)Func2);
    vRegisterCallback(void (*)(void*)Func3);
} 
```

我像上面一样注册了三个函数。
`Func1`指针是有效的，但是当它作为参数传递给`vRegisterCallback`. `vRegisterCallback`与 的地址不同`Func1`。

如果我在`printf`上面添加一条语句，它适用于发送到的有效指针`vRegisterCallback`。
如果我将它`Func1`从静态更改为非静态，它可以工作......
如果我将 .so 更改为 .a ，它就可以工作。

不知道是什么问题。

# c# - 在哪个事件中，我可以使用 PushSharp 获取 GCM 响应以向 Android 设备发送通知？

> ID：16058874
> 
> 赞同：1
> 
> 时间：2013-04-17T11:30:42.423
> 
> 标签：c#, android, .net, pushsharp

我正在尝试从我的 .Net 服务器向所有下载了我的 Android 应用程序的 Android 设备发送通知。我正在使用 PushSharp 库。发送通知很好。但我试图从 GCM 获得响应，告诉我规范注册 ID 如果用户卸载应用程序并重新下载它。我在向同一个 android 设备发送拖车通知时遇到问题。一个使用新 ID，一个使用未注册 ID 我正在尝试从我的数据库中删除该 ID。这样我只能为单个设备发送一个通知。我会注册这 4 个由 GCM 触发的事件。在哪个事件中我可以做我的逻辑？

任何帮助表示赞赏。

这是我的代码：

```
 private static void Events_OnNotificationSent(Notification notification)
    {

    }

    private static void Events_OnNotificationSendFailure(Notification notification, Exception notificationFailureException)
    {

    } 

    private static void Events_OnChannelException(Exception exception, PlatformType platformType, Notification notification)
    {
    } 

    private static void Events_OnDeviceSubscriptionExpired(PlatformType platform, string deviceInfo, Notification notification)
    {

    } 

    private static void Events_OnDeviceSubscriptionIdChanged(PlatformType platform, string oldDeviceInfo, string newDeviceInfo, Notification notification)
    {

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-07T19:29:38.447

如果我对您的理解正确，如果用户卸载了您的应用程序，您希望从数据库中删除该设备。我正在为我的项目使用以下逻辑：

```
private void Events_OnNotificationFailed(object sender, INotification notification, Exception error)
{
    var gcmNotification = notification as GcmNotification;
    bool userHasUninstalled = error.Message.Contains("Device Subscription has Expired");
    bool isAndroidNotification = gcmNotification != null;
    if (isAndroidNotification && userHasUninstalled)
    {
        foreach (var registrationId in gcmNotification.RegistrationIds)
        {
            DeleteDeviceByIdentifier(registrationId);
        }
    }
} 
```

# php - 使用php更新xml中的节点属性

> ID：16058880
> 
> 赞同：-1
> 
> 时间：2013-04-17T11:31:03.080
> 
> 标签：php, xml, simplexml

是否可以使用 simplexml 更新 xml 的节点属性？示例：-我的程序实际上是老师的测验编辑器，作为老师，我想编辑特定的问题属性。IE

```
<Quiz>
<topic text="Preparation for Exam">
    <subtopic text="Math">
              <question text="1 + 1 = ?"> 
              <answer num="A" Text="1" /> 
              <answer num="B" Text="2" /> 
              <answer num="C" Text="3" /> 
              <answer num="D" Text="4" /> 
              </question>
              <question text="4 * 4 = ?" > 
              <answer num="A" Text="12" /> 
              <answer num="B" Text="14" /> 
              <answer num="C" Text="16" /> 
              <answer num="D" Text="18" /> 
              </question>
       </subtopic>
       </topic>
       </Quiz> 
```

可能吗？虽然我尝试了很多方法，即删除前一个节点，然后插入已编辑的节点。但是这个技巧只适用于最后一个节点......对于其他节点它只是交换

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:46:20.717

```
<?php
$subtopic = new SimpleXMLELement(data());
$subtopic->question[1]['text'] = 'lalala';
$subtopic->question[1]['foo'] = 'bar';

foreach( $subtopic->question[1]->answer as $answer) {
    $answer['Text'] .= '(dez)';
}

echo $subtopic->asXML();

function data() {
    return <<< eox
<subtopic text="Math">
<question text="1 + 1 = ?"> 
<answer num="A" Text="1" /> 
<answer num="B" Text="2" /> 
<answer num="C" Text="3" /> 
<answer num="D" Text="4" /> 
</question>
<question text="4 * 4 = ?" > 
<answer num="A" Text="12" /> 
<answer num="B" Text="14" /> 
<answer num="C" Text="16" /> 
<answer num="D" Text="18" /> 
</question>
</subtopic>
eox;
} 
```

印刷

```
<?xml version="1.0"?>
<subtopic text="Math">
<question text="1 + 1 = ?"> 
<answer num="A" Text="1"/> 
<answer num="B" Text="2"/> 
<answer num="C" Text="3"/> 
<answer num="D" Text="4"/> 
</question>
<question text="lalala" foo="bar"> 
<answer num="A" Text="12(dez)"/> 
<answer num="B" Text="14(dez)"/> 
<answer num="C" Text="16(dez)"/> 
<answer num="D" Text="18(dez)"/> 
</question>
</subtopic> 
```

# java - Java Bouncy Castle OCSP 网址

> ID：16058889
> 
> 赞同：4
> 
> 时间：2013-04-17T11:31:24.960
> 
> 标签：java, certificate, bouncycastle, ocsp

我正在使用 bouncy castle 1.48 来验证 OCSP 的证书验证。它运作良好。但我使用 Ocsp Url 作为静态变量，我想从证书中读取它。网址在证书中写为`Authority Info Access`

```
[1]Authority Info Access
 Access Method=On-line Certificate Status Protocol (1.3.6.1.5.5.7.48.1)
 Alternative Name:
      URL=http://ocsp.mydomain 
```

我`org.bouncycastle.asn1.x509.AuthorityInformationAccess`从证书中得到了对象

```
byte[] octetBytes = certificate.getExtensionValue(X509Extension.authorityInfoAccess.getId());
ASN1InputStream octetStream = new ASN1InputStream(octetBytes);
byte[] encoded = X509ExtensionUtil.fromExtensionValue(octetBytes).getEncoded();
ASN1Sequence seq = ASN1Sequence.getInstance(ASN1Primitive.fromByteArray(encoded));
AuthorityInformationAccess access = AuthorityInformationAccess.getInstance(seq); 
```

写入`AuthorityInformationAccess: Oid(1.3.6.1.5.5.7.48.1)`但无法从那里获取 URL

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T10:33:02.307

我找到了方法。

```
private String getOcspUrl(X509Certificate certificate) throws Exception {
    byte[] octetBytes = certificate
            .getExtensionValue(X509Extension.authorityInfoAccess.getId());

    DLSequence dlSequence = null;
    ASN1Encodable asn1Encodable = null;

    try {
        ASN1Primitive fromExtensionValue = X509ExtensionUtil
                .fromExtensionValue(octetBytes);
        if (!(fromExtensionValue instanceof DLSequence))
            return null;
        dlSequence = (DLSequence) fromExtensionValue;
        for (int i = 0; i < dlSequence.size(); i++) {
            asn1Encodable = dlSequence.getObjectAt(i);
            if (asn1Encodable instanceof DLSequence)
                break;
        }
        if (!(asn1Encodable instanceof DLSequence))
            return null;
        dlSequence = (DLSequence) asn1Encodable;
        for (int i = 0; i < dlSequence.size(); i++) {
            asn1Encodable = dlSequence.getObjectAt(i);
            if (asn1Encodable instanceof DERTaggedObject)
                break;
        }
        if (!(asn1Encodable instanceof DERTaggedObject))
            return null;
        DERTaggedObject derTaggedObject = (DERTaggedObject) asn1Encodable;
        byte[] encoded = derTaggedObject.getEncoded();
        if (derTaggedObject.getTagNo() == 6) {
            int len = encoded[1];
            return new String(encoded, 2, len);
        }
    } catch (IOException e) {
        e.printStackTrace();
    }
    return null;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-26T17:51:29.120

我是这样做的：

```
 private String getOcspUrlFromCertificate(X509Certificate cert) {
    byte[] extensionValue = cert.getExtensionValue(X509Extensions.AuthorityInfoAccess.getId());

    try {
        ASN1Sequence asn1Seq = (ASN1Sequence) X509ExtensionUtil.fromExtensionValue(extensionValue); // AuthorityInfoAccessSyntax
        Enumeration<?> objects = asn1Seq.getObjects();

        while (objects.hasMoreElements()) {
            ASN1Sequence obj = (ASN1Sequence) objects.nextElement(); // AccessDescription
            DERObjectIdentifier oid = (DERObjectIdentifier) obj.getObjectAt(0); // accessMethod
            DERTaggedObject location = (DERTaggedObject) obj.getObjectAt(1); // accessLocation

            if (location.getTagNo() == GeneralName.uniformResourceIdentifier) {
                DEROctetString uri = (DEROctetString) location.getObject();
                String str = new String(uri.getOctets());
                if (oid.equals(X509ObjectIdentifiers.id_ad_ocsp)) {
                    return str;
                }
            }
        }
    } catch (Exception e) {
        logger.error("Error", e);
    }

    return null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-02-19T18:54:36.067

BouncyCastle 1.9 是：

依赖性

```
 <dependency>
        <groupId>org.bouncycastle</groupId>
        <artifactId>bcprov-jdk15on</artifactId>
        <version>1.59</version>
    </dependency>
    <dependency>
        <groupId>org.bouncycastle</groupId>
        <artifactId>bcpkix-jdk15on</artifactId>
        <version>1.59</version>
    </dependency> 
```

获取 url OCSP 的方法

```
private ASN1Primitive getExtensionValue(X509Certificate certificate, String oid) throws IOException {
    byte[] bytes = certificate.getExtensionValue(oid);
    if (bytes == null) {
        return null;
    }
    ASN1InputStream aIn = new ASN1InputStream(new ByteArrayInputStream(bytes));
    ASN1OctetString octs = (ASN1OctetString) aIn.readObject();
    aIn = new ASN1InputStream(new ByteArrayInputStream(octs.getOctets()));
    return aIn.readObject();
}

public String getOcspUrl() throws Exception {
    ASN1Primitive obj;
    try {
        obj = getExtensionValue(getFirstCertificate(), Extension.authorityInfoAccess.getId());
    } catch (IOException ex) {
        ex.printStackTrace();
        return null;
    }

    if (obj == null) {
        return null;
    }

    AuthorityInformationAccess authorityInformationAccess = AuthorityInformationAccess.getInstance(obj);

    AccessDescription[] accessDescriptions = authorityInformationAccess.getAccessDescriptions();
    for (AccessDescription accessDescription : accessDescriptions) {
        boolean correctAccessMethod = accessDescription.getAccessMethod().equals(X509ObjectIdentifiers.ocspAccessMethod);
        if (!correctAccessMethod) {
            continue;
        }

        GeneralName name = accessDescription.getAccessLocation();
        if (name.getTagNo() != GeneralName.uniformResourceIdentifier) {
            continue;
        }

        DERIA5String derStr = DERIA5String.getInstance((ASN1TaggedObject) name.toASN1Primitive(), false);
        return derStr.getString();
    }

    return null;
} 
```

验证撤销的功能

```
public CertificateStatus verifRevocationWithOCSP(X509Certificate certificate,X509Certificate issuerCertificate) throws Exception{
    OcspClientBouncyCastle ocspClient = new OcspClientBouncyCastle();
    String urlOCSP = getOcspUrl();
    BasicOCSPResp basicOCSPResp = ocspClient.getBasicOCSPResp(certificate, issuerCertificate, urlOCSP);

    if (basicOCSPResp == null)
        throw new IOException("Error en la consulta ar servidor OCSP ["+urlOCSP+"]");

    BasicOCSPResp basicResponse = basicOCSPResp;
    SingleResp[] responses = basicResponse.getResponses();
    if (responses.length == 1) {
        SingleResp resp = responses[0];
        Object status = resp.getCertStatus();
        System.out.println("OBJECT: "+status);
        if (status == CertificateStatus.GOOD) {
            return CertificateStatus.GOOD;
        } else if (status instanceof RevokedStatus) {
            RevokedStatus revokedStatus = (RevokedStatus)status;
            return revokedStatus;
        } else if(status instanceof UnknownStatus){
            UnknownStatus unknownStatus = (UnknownStatus)status;
            return unknownStatus;
        }
        throw new IOException("Tipo de respuesta de OCSP ["+status+"] desconocido");
    }
    else
        throw new IOException("No se recibio ni una respuesta al consultar el OCSP para la URL ["+urlOCSP+"]");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-04T22:16:36.217

使用 BouncyCastle X509CertificateHolder。

使用 BouncyCastle 1.66、Java 8 和 Lombok val...

```
public static String getOcspUrl(final String certPEM) {                                                                                                                                                                                                                                                               
    val certHolder = toCertificateHolder(certPEM);                                                                                                                                                                                                                                                                    

    val aiaExtension = AuthorityInformationAccess.fromExtensions(certHolder.getExtensions());                                                                                                                                                                                                                         
    val ocspUrl = Arrays.stream(aiaExtension.getAccessDescriptions())                                                                                                                                                                                                                                                 
          .filter(ad -> ad.getAccessMethod().equals(X509ObjectIdentifiers.id_ad_ocsp))                                                                                                                                                                                                                                  
          .map(ad -> ad.getAccessLocation().getName().toASN1Primitive().toString())                                                                                                                                                                                                                                     
          .findFirst();

    return ocspUrl.get();
}

public static X509CertificateHolder toCertificateHolder(final String certPEM) {                                                                                                                                                                                                                                       
    val parser = new PEMParser(new StringReader(certPEM));                                                                                                                                                                                                                                                   
    return (X509CertificateHolder) parser.readObject();                                                                                                                                                                                                                                                               
} 
```

# c# - 如何在 C# 中编组指向一系列以 null 结尾的字符串的指针？

> ID：16058890
> 
> 赞同：3
> 
> 时间：2013-04-17T11:31:25.977
> 
> 标签：c#, c++, marshalling, unmanaged, managed

我需要以下帮助。我有一个 c++ API（无法访问源代码），我正在努力处理返回 char* 属性或返回包含 char* 属性的结构的方法。根据 API 的文档，返回值如下：

返回值
如果函数成功，则返回值是指向一系列以空字符结尾的字符串的指针，主机系统上的每个项目都有一个，以第二个空字符结尾。以下示例显示了缓冲区内容，`<null>`表示终止空字符：

```
project1<null>project2<null>project3<null><null> 
```

如果函数失败，返回值为NULL

我遇到的问题是 C# 中返回的指针仅包含第一个值... project1 在这种情况下。如何获得完整列表以便能够在托管端循环访问它们？

这是c#代码：

> ```
>  [DllImport("vmdsapi.dll", EntryPoint = "DSGetProjectList", CallingConvention = CallingConvention.Cdecl)]
>     public static extern IntPtr DSGetProjectList(); 
> ```

调用方法：

> ```
>  IntPtr ptrProjectList = DSAPI.DSGetProjectList();
>    string strProjectList = Marshal.PtrToStringAnsi(ptrProjectList).ToString(); 
> ```

strProjectList 仅包含第一项。
这是API头文件中的信息......

> ```
>  DllImport char *DSGetProjectList dsproto((void)); 
> ```

这是我用于测试目的的 c++ 控制台应用程序的一些示例代码...

> ```
>  char *a;
>    a = DSGetProjectList( );
>    while( *a ) { 
>     printf("a=%s\n", a); 
>     a += 1 + strlen(a); 
>    } 
> ```

每次迭代都会正确显示列表中的每个项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:44:42.213

问题是，当使用 将 C++ char* 转换为 C# 字符串`Marshal.PtrToStringAnsi`时，它会在第一个空字符处停止。

**您不应该直接将其转换`char*`为字符串。**

`char*`您可以将由 an 表示的复制`IntPtr`到 a `byte[]`using `Marshal.Copy`，然后根据需要提取尽可能多的字符串（请参阅[*Matthew Watson*的从托管数组中提取字符串的答案](https://stackoverflow.com/a/16059344/1439688)），但您需要先获取多字符串大小。

正如*leppie*建议的那样，您还可以使用提取第一个字符串，`Marshal.PtrToStringAnsi`然后将指针增加该字符串大小并提取下一个字符串，依此类推。当 is 提取空字符串（从最后一个 NULL 字符开始）时，您会停止。

就像是 ：

```
IntPtr ptrProjectList = DSAPI.DSGetProjectList();
List<string> data;
string buffer;
do {
    buffer = Marshal.PtrToStringAnsi(ptrProjectList);
    ptrProjectList += buffer.size() + 1;
    data.Add(buffer);
}while(buffer.size() > 0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:56:13.910

这种字符串称为 a `Multi-String`，在 Windows API 中很常见。

编组它们很繁琐。您要做的是将其编组为`char[]`数组，而不是字符串，然后将`char[]`数组转换为一组字符串。

[有关示例解决方案，请参见此处](https://stackoverflow.com/questions/268899/how-do-you-convert-multistring-to-from-c-sharp-string-collection)。我已将相关代码复制到此答案中，但它是从我提供的链接中复制的：

```
static List<string> MultiStringToList(char[] multistring)
{
    var stringList = new List<string>();
    int i = 0;

    while (i < multistring.Length)
    {
        int j = i;

        if (multistring[j++] == '\0') 
            break;

        while (j < multistring.Length)
        {
            if (multistring[j++] == '\0')
            {
                stringList.Add(new string(multistring, i, j - i - 1));
                i = j;
                break;
            }
        }
    }

    return stringList;
} 
```

# matlab - 如何保存matlab神经网络工具箱生成的数字

> ID：16058891
> 
> 赞同：0
> 
> 时间：2013-04-17T11:31:33.650
> 
> 标签：matlab, neural-network, matlab-figure

在 matlab 工作区中，可以轻松保存输出/结果。但是当我用一些数据训练网络以查看训练的性能时（在神经网络工具箱中），回归图以及直方图和性能图无法保存为图形文件。目前我正在使用截图工具来捕获他们。

我的问题是如何做到这一点？是否有任何选项可以保存这些图（在 Maltab 神经网络工具箱中生成）？

我将不胜感激有关我的询问的任何代码/答案。非常感谢。

我正在通过 matlab 中的命令代码添加要保存的绘图快照。

![在此处输入图像描述](https://i.stack.imgur.com/N1jlr.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/RuOk6.jpg)

目前我正在使用截图工具，但是当我输入文字时，它们的属性/图像质量会缩小。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:53:46.570

首先，您需要确定要快照的 gfx 对象（其句柄）。这可能来自可识别的属性。然后你想用`print`它把它保存到一个文件中；您需要提供文件名，最后是类型；有关更多详细信息，请参阅[帮助](http://www.mathworks.nl/help/matlab/ref/print.html)。

例如，如果您想使用标签“my.awesome.fig”保存图形，您可以尝试：

```
h = findobj('Type', 'figure', 'tag', 'my.awesome.fig');
for k = 1:numel(h)
        print(h(k), sprintf('Pic%d.ps',k));
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-03T20:02:27.520

nntraintool 本身以外的训练图都是真正的 matlab 图。标签例如 TRAINING_PLOTERRHIST TRAINING_PLOTPERFORM TRAINING_PLOTRESPONSE 。nntraintool 图是 java——你可以使用 nnjava.tools('nntraintool') 访问它。有关如何在 Matlab 中操作 java 图形，请参阅未记录的 Matlab。

```
Richard 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-03-23T21:23:38.963

如果您只提到图形的质量，您可以通过单击图形菜单中的 EDIT/COPY 来完成。

# javascript - 性能：jQuery remove() 与 JavaScript removeChild()

> ID：16058894
> 
> 赞同：4
> 
> 时间：2013-04-17T11:31:35.037
> 
> 标签：javascript, jquery, performance

我有一个包含大约 1,500 行的表。

我正在使用以下 jQuery 代码从 DOM 中删除表：

```
$('#myTable').remove(); 
```

这大约需要 300 毫秒，产生了非常明显的延迟。

用 removeChild() 做同样的事情：

```
var myTable = $('#myTable')[0] ;
myTable.parentNode.removeChild(myTable); 
```

大约需要 30 毫秒。

我可以轻松使用 removeChild() 版本，但我很困惑为什么 jQuery 的 remove() 会花费这么长时间？removeChild() 版本是否没有清除 jQuery 的内容？

演示：[jspref](http://jsperf.com/jquery-remove-vs-removechild)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-17T11:33:18.410

从[文档中](http://api.jquery.com/remove/)：

> 除了元素本身，所有与元素关联的绑定事件和 jQuery 数据都将被删除。

这表示 ：

*   这个函数做了一些额外的工作（主要是调用`cleanData`它自己和孩子）
*   您通常应该使用它来避免内存泄漏

这清楚地出现在源代码中：

```
remove: function( selector, keepData ) {
    var elem,
        i = 0;

    for ( ; (elem = this[i]) != null; i++ ) {
        if ( !selector || jQuery.filter( selector, [ elem ] ).length > 0 ) {
            if ( !keepData && elem.nodeType === 1 ) {
                jQuery.cleanData( getAll( elem ) );
            }

            if ( elem.parentNode ) {
                if ( keepData && jQuery.contains( elem.ownerDocument, elem ) ) {
                    setGlobalEval( getAll( elem, "script" ) );
                }
                elem.parentNode.removeChild( elem );
            }
        }
    }

    return this;
} 
```

# jquery - 悬停菜单上的 SlideUp 和 Slidedown

> ID：16058900
> 
> 赞同：0
> 
> 时间：2013-04-17T11:32:02.137
> 
> 标签：jquery, html, toggle, slidedown, slideup

我有一个菜单，它将在`hover()`. 我是这样写的

```
$(".menu2").hover(function ()
{
 $(".slider").slideDown(500);
  $(".slider").css('display','block');      
},
    function () {   
    $(".slider").slideUp(500);      
 //$('.slider').css("display","none");

}); 
```

这显示了滑块。（我喜欢使用`slideDown()`并且`slideUp()`看起来不错）。当我将我的移动`cursor`到滑块时，它会回到`display:none`状态。所以我尝试了这个

```
 $(".sliderHolder").hover(function ()
{
  $(".slider").css('display','block');              
},
    function () {

 $(".slider").slideUp(500);

 });

}); 
```

在我`display:none`将光标从`menu`. 有没有更简单的方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:39:52.127

你期待像

[http://jsfiddle.net/jUraw/1369/](http://jsfiddle.net/jUraw/1369/)

```
 <ul id="nav">
        <li><a href="home.html"><span>M</span>enu</a>
            <ul>
                <li><a href="fashion.html"><span>F</span>ashion</a></li>
                <li><a href="about-us.html"><span>A</span>bout <span>U</span>s</a></li>
                <li><a href="find-us.html"><span>F</span>ind <span>U</span>s</a></li>
                <li class="underline"><a href="http://www.bellissimafashions.com/blog/"><span>B</span>log</a></li>
            </ul>
        </li>    
    </ul>

$(document).ready(function (){
    var t = null;
    $('#nav li').hover(function(){
        var that = this;
        t = setTimeout(function(){
            $('ul', that).slideDown(200);
            t = null;
        }, 300);
    }, function(){
        if (t){
            clearTimeout(t);
            t = null;
        }
        else
            $('#nav li ul').slideUp(200);
    });
}); 
```

# c++ - 通过 constexpr 的临界区

> ID：16058901
> 
> 赞同：1
> 
> 时间：2013-04-17T11:32:03.443
> 
> 标签：c++, c++11, embedded, critical-section

在嵌入式编程中，需要创建代码的原子部分——所谓的临界区。它们通常通过宏实现，例如，像这样：

```
#define ENTER_CRITICAL() int saved_status_ = CPU_STATUS_REGISTER; __disable_irq();
#define EXIT_CRITICAL()  CPU_STATUS_REGISTER = saved_status_ 
```

即在进入中断状态（启用或禁用）时保存；退出时 - 它已恢复。问题是为此需要额外的变量。

我的问题是：是否可以通过 constexpr 函数创建关键部分（并摆脱宏）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-17T20:18:22.823

RAII 解决方案将是传统的：

```
struct CriticalSection {
  int saved_status_;
  void Enter() {
    saved_status_ = CPU_STATUS_REGISTER;
    __disable_irq();
  }
  CriticalSection() { Enter(); }
  void Exit() {
    CPU_STATUS_REGISTER = saved_status_;
  }
  ~CriticalSection() {
    Exit(); // Can you call this more than once safely?  Dunno.
  }
}; 
```

你会这样使用它：

```
void foo() {
  // unprotected code goes here
  {
    CriticalSection _;
    // protected code goes here
  }
  // unprotected code goes here
} 
```

在没有任何状态的情况下这样做是不可能的，因为这`CPU_STATUS_REGISTER`是一个运行时值。C/C++ 中的状态主要存储在变量中。

我强烈怀疑，在任何非平凡的优化级别下，上述 RAII 类将编译为与您的宏编译成完全相同的代码，除非您不再需要记住 EXIT_CRITICAL()。

# string - 在经典asp中拆分字符串

> ID：16058903
> 
> 赞同：1
> 
> 时间：2013-04-17T11:32:09.357
> 
> 标签：string, asp-classic

我在经典的 ASP 中工作，并且有一个字符串如下：

甲乙丙
_
_

现在我想拆分字符串，我尝试过 vbCrLf、vbNewline、vblf，
但它们都不起作用。

请建议我另一种拆分字符串的方法。我的情况很糟糕。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-17T16:22:39.043

你确定，你的字符串中有换行符吗？

首先，您可以输出所有字符代码以找出要拆分的字符：

```
dim i, c

for i = 1 to len(my_string)
    c = mid(my_string, i, 1)
    Response.Write "CHAR: " & ASC(c) & " = " & c
next 
```

然后你有2个选择：

1.  如果你可以用一个字符分割（例如 char num 10），你可以使用：

    ```
    a_result = split(my_string, CHR(10)) 
    ```

2.  您可以使用正则表达式匹配从字符串中获取值。这是很大的开销，但如果所有其他方法都失败了，你可以这样做：

    ```
    function findStrings(s_text, s_pattern)
            dim a_out, obj_regex, obj_matches
            dim obj_match, n_index
            set obj_regex = New RegExp

            obj_regex.IgnoreCase = true
            obj_regex.Global = true
            obj_regex.MultiLine = true
            obj_regex.Pattern = s_pattern
            set obj_matches = obj_regex.execute(s_text)
            if obj_matches.Count>0 then
                    redim a_out(obj_matches.Count-1)
                    n_index = 0
                    for each obj_match in obj_matches
                            a_out(n_index) = cvStr(obj_match.Value)
                            n_index = n_index + 1
                    next
            end if
            findStrings = a_out
            set obj_regex = Nothing
    end function

    a_result = findStrings(my_string, "\w+") 
    ```

这假设您要查找的字符串中没有空格。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T06:12:16.367

这种情况发生的频率比您想象的要多，您需要先删除 vbcr 然后只替换 vblf 并忘记在 vbcrlf 上进行拆分，因为它不适用于 100% 的用户环境。

```
A
B
C

' assuming about is in the variable str

split(replace(str,vbcr,""),vblf) 
```

# javascript - Accessing .json file to get bank holidays access denied

> ID：16058905
> 
> 赞同：2
> 
> 时间：2013-04-17T11:32:14.023
> 
> 标签：javascript, jquery, json

I am very new to `jQuery` and `json`. I am trying to get UK Bank Holiday data from the following API/link so that I can create a function which determines if a selected date is a working day.

[https://www.gov.uk/bank-holidays.json](https://www.gov.uk/bank-holidays.json)

I had an error for `No Transport` which I fixed by putting in:

```
jQuery.support.cors = true; 
```

I am now getting `Access Denied`. I have no idea how to gain access to this because as I say, I am still learning all this.

```
function IsWorkingDay(date) {
  var day = new moment(value, "DD-MM-YYYY").day();
  jQuery.support.cors = true;
  var bankHolidays = $.getJSON("https://www.gov.uk/bank-holidays.json").done(function(data) {
                                                                                   alert(data);
                                                                                 })
                                                                           .fail(function(a, b, c) {
                                                                                   alert(b + ',' + c);
  return day != 0 && day != 6;
}
                                                                          }); 
```

My question is in two phases:

1.  How do I get access? (Main question)
2.  How do I move on to access the data? I have downloaded the `json` onto my computer to look at, just how I am going to go about translating this to `javascript` is what I am struggling on.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T11:51:33.160

如果你被 CORS 阻塞了，并且服务不支持 JSONP，最简单的解决方法是为实际服务创建一个代理服务。因此，如果您在服务器上创建服务（与提供 javascript 的服务相同），您可以调用该服务，该服务反过来将从外部服务获取数据。在服务器端，无需担心 CORS。

我不知道你的后端是什么，但步骤如下：

*   在您身边创建一个使用 URL 公开的服务（例如`/myapp/workingday`）
*   调用这个服务而不是真正的服务
*   您的代理服务将获取 JSON 数据并将其返回给 javascript

**编辑**

我不知道 MVC4，但我怀疑它与 Spring MVC 的一些概念相同，所以这里有一个 Java 示例：

```
@Controller
public class HolidaysController {

    @RequestMapping("/workingday")
    public void isworkingDay(@RequestParam("day") Date day, HttpServletResponse response) {
        // Call external service and get JSON
        String json = callExternalService(day);
        response.setContentType("application/json");
        response.getWriter().write(json);
    }
} 
```

在你的 javascript 中：

```
function IsWorkingDay(date) {
    var day = new moment(value, "DD-MM-YYYY").day();
    var bankHolidays = $.getJSON("/workingday").done(function(data) {
        // process data
    });
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T11:44:26.673

为此，您需要使用 jsonp，如此[处所示](https://stackoverflow.com/a/2686406/168097)

**但**

运行上面的代码会抛出一个无效的标签异常，正如[这里](https://stackoverflow.com/a/3909742/168097)解释的那样，正如@NilsH 所暗示的，这是由于服务器阻止了它

# node.js - 在服务器发送事件中从客户端向服务器发送额外的字符串

> ID：16058907
> 
> 赞同：0
> 
> 时间：2013-04-17T11:32:18.030
> 
> 标签：node.js, express, server-sent-events

```
source = new EventSource("stream"); 
```

这就是我连接到服务器推送流数据的方式，现在我的场景是在建立连接时发送一个额外的字符串。我该如何做到这一点？

我敢肯定，我在互联网上的文章中找不到有关此的任何详细信息！

任何人帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T18:21:30.243

由于 SSE 只使用普通的 HTTP URL，因此您应该能够在启动连接时添加 GET 参数。

```
source = new EventSource("http://example.com/sse?arg=value"); 
```

在服务器端，您将`'arg'`在参数中查找密钥。

# php - 如果“echo”用于输出，jquery 效果在 php 中不可见

> ID：16058909
> 
> 赞同：0
> 
> 时间：2013-04-17T11:32:28.447
> 
> 标签：php, jquery, ajax

我有使用fancybox的小图片库。所以在每张图片上都有一个悬停和弹出效果。下面是我的代码

```
<div class="one-third column hover">
               <a href="large/28crowview_ld.jpg" class="image-box">
                <div class="photo">
                <span class="text"><span class="anchor"></span></span>
                </div>          
                <img src="large/28crowview_ld.jpg" height="170px" width="260px"/>       
        </a>                        
    </div> 
```

上面的代码完美运行。

但是我使用了一个 ajax 控制器，它使用回显返回上述代码

```
 echo '<div class="one-third column hover">
                   <a href="large/28crowview_ld.jpg" class="image-box">
                    <div class="photo">
                    <span class="text"><span class="anchor"></span></span>
                    </div>          
                    <img src="large/28crowview_ld.jpg" height="170px" width="260px"/>       
            </a>                        
        </div>'; 
```

但是当我使用回声标签时，图像会显示，但悬停效果不可见。这很奇怪。我也在我的社交栏上注意到了同样的问题。

当我在 html 视图中使用它时，它工作得很好。但是当我回显时，我在源代码中看到了代码，但图标不可见

```
echo '<div class="supersocialshare" data-networks="facebook,google,twitter,linkedin,pinterest" data-url="'.$share.'" data-orientation="line"></div>'; 
```

所有图像都正确放置，没有js冲突。

下面是我使用的java脚本

```
<script type="text/javascript">
$(document).ready(function() {

    var track_click = 0; //track user click on "load more" button, righ now it is 0 click

    var total_pages = <?php echo $total_pages; ?>;
    $('#results').load("<?php echo base_url() ?>fetch_pages", {'page':track_click}, function() {track_click++;}); //initial data to load

    $(".load_more").click(function (e) { //user clicks on button

        $(this).hide(); //hide load more button on click
        $('.animation_image').show(); //show loading image

        if(track_click <= total_pages) //make sure user clicks are still less than total pages
        {
            //post page number and load returned data into result element
            $.post('<?php echo base_url() ?>fetch_pages',{'page': track_click}, function(data) {

                $(".load_more").show(); //bring back load more button

                $("#results").append(data); //append data received from server

                //scroll page to button element
                $("html, body").animate({scrollTop: $("#load_more_button").offset().top}, 500);

                //hide loading image
                $('.animation_image').hide(); //hide loading image once data is received

                track_click++; //user click increment on load button

            }).fail(function(xhr, ajaxOptions, thrownError) { 
                alert(thrownError); //alert any HTTP error
                $(".load_more").show(); //bring back load more button
                $('.animation_image').hide(); //hide loading image once data is received
            });

            if(track_click >= total_pages-1)
            {
                //reached end of the page yet? disable load button
                $(".load_more").attr("disabled", "disabled");
            }
         }

        });
});
</script> 
```

在 fetch_pages 里面

```
 $page_number = filter_var($this->input->post('page'), FILTER_SANITIZE_NUMBER_INT, FILTER_FLAG_STRIP_HIGH);

        //throw HTTP error if page number is not valid
        if(!is_numeric($page_number)){
            header('HTTP/1.1 500 Invalid page number!');
            exit();
        }

        $item_per_page = 5;

        //get current starting point of records
        $position = ($page_number * $item_per_page);

        $cottages = $this->properties->getstuff($sub_location,$position, $item_per_page);

       foreach ($props as $cots):

                 echo'<div class="container section" id="'.$cots["id"].'">
                        <div class="one-third column hover">
                        <a href="'.$cots["image_url"].'" class="image-box">
                                <div class="photo">
                                    <span class="text"><span class="anchor"></span></span>
                                </div>          
                                 <img src="'.$cots["image_url"].'" height="170px" width="260px"/>

                                </a>                        

                        </div>';
 endforeach; 
```

我正在使用 codeigniter、php 和 jquery 构建这个项目。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:43:12.167

您似乎在理解 Web 应用程序的整体架构、客户端浏览器上发生的事情以及服务器上发生的事情、php 所做的事情等方面存在一些严重的问题。你应该读一读。

但是，您的问题很可能与您的悬停和弹出效果正在通过与此等效的方式完成的事实有关：

```
$(".hover").on("hover",function () {
  // BLAH
}); 
```

如果是这种情况，那么在附加事件处理程序（即通过 ajax）之后加载的任何具有类悬停的元素都不会附加该事件处理程序，一个简单的解决方法是将事件处理程序附加到容器并使用委托的事件处理程序，如下所示：

```
$(document).on("hover",".hover",function () {
  // This handler is attached to the document but applies to any .hover elements inside it
}); 
```

另一个解决方法是在通过 ajax 加载元素后运行将“fancybox”功能附加到元素的任何函数。没有一些参考代码很难做到正确，但我认为它会是这样的：

```
$.get(url, function (data) {
  var elem = $(data);
  $("#container").append(elem);
  elem.fancybox();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:41:49.247

请为您提供 JavaScript 代码，我想扔我的一分钱。我敢打赌您使用的是`hover`方法而不是`live hover`或`on hover`函数，如下所示：

```
jQuery('#div').click(...); // this will work fine if you place your code in page not posted back from ajax request or dynamically created
jQuery('#div').live('click',...); // this will work even if the element was created dynamically or from ajax request. 
```

[jQuery“实时”链接](http://api.jquery.com/live/)

[jQuery“打开”链接](http://api.jquery.com/on/)

* * *

还有一件事，请注意该`live`功能已被弃用并从 jQuery 1.9 中删除

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T12:18:12.213

根据`anpsmn`评论我不得不重新初始化完整的fancybox插件

```
$(window).load(function() { 
```

它工作得很好..

# ssis - 使用 SSIS 发送邮件发送邮件任务

> ID：16058911
> 
> 赞同：3
> 
> 时间：2013-04-17T11:32:31.733
> 
> 标签：ssis

我想使用 SSIS 发送带有附件的电子邮件，并出现以下错误。

> [发送邮件任务] 错误：发生错误并显示以下错误消息：“SMTP 服务器需要安全连接或客户端未通过身份验证。服务器响应为：5.5.1 需要身份验证。了解更多信息”。

下面是我的 SMTP 连接管理器和发送邮件任务，出现上述错误..

![在此处输入图像描述](https://i.stack.imgur.com/IuRUB.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/zzwWf.jpg)

任何帮助..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T14:24:51.173

您需要提供身份验证，GMail 不能作为开放中继。

此外，您无法使用 Windows 身份验证连接到 GMail，因此您必须使用脚本组件并在 .Net 中执行此操作，如果这必须是您的邮件服务器。

这是已经发现并解决了这个问题的人，甚至包括 GMail 部分： http: [//kalyan-coldfusion.blogspot.co.uk/2012/04/send-email-with-ssisdatabase-from-gmail.html](http://kalyan-coldfusion.blogspot.co.uk/2012/04/send-email-with-ssisdatabase-from-gmail.html)

祝你在未来的谷歌搜索上好运:)

# git - 使用 TortoiseGit 拉取 git 子模块

> ID：16058917
> 
> 赞同：18
> 
> 时间：2013-04-17T11:32:45.587
> 
> 标签：git, tortoisegit

我正在使用 TortoiseGit 来维护 git 存储库。我们有一个包含多个子模块的仓库。一切正常，但是当我尝试提取主仓库时，子模块没有更新。我必须一一拉出每个子模块。

乌龟中是否有一个选项可以仅使用菜单中的一个拉取命令来更新所有子模块中的所有更改以进行 repo？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2014-02-03T15:37:20.470

（git 1.8.2 或更高版本）

1.  git 拉

2.  git 子模块更新 --merge --remote

这是执行任务的 TortoiseGit 的相应屏幕。

![在此处输入图像描述](https://i.stack.imgur.com/DYbOR.png)

![在此处输入图像描述](https://i.stack.imgur.com/fbuaO.png)

![在此处输入图像描述](https://i.stack.imgur.com/VlSd0.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-15T01:35:48.783

# 更新

现在有一种方法可以在 TortoiseGit 中执行此操作，另一个答案涵盖了该方法；旧脚本方法可用于下面的自动化脚本。

# 旧编辑

目前在 TortoiseGit 中没有这样做的方法，尽管我发现如果您将它们作为明确的功能请求提交，作者会对好的想法非常敏感。以下是我处理这个问题的方法：

在每个带有子模块的新项目中，我将以下 2 个脚本转储到根目录中：

gitsetup.sh

```
#!/bin/bash
# git built-in
echo "Setting up submodules"
git submodule update --init

echo "Setting up submodules for TortoiseGit/Putty"
# 1) Find the puttykeyfile line, like
#         puttykeyfile = C:\\Users...\\.ssh\\PuTTY.ppk
# 
# in .git/config

# pass to sed to double-escape all backslashes (Windows problem) - that way
# it doesn't become an issue when we use it in sed
puttyline="$(grep puttykeyfile .git/config | sed 's/\\/\\\\/g')"

# 2) Search for .git/modules/*/config

files=$(find .git/modules -type f -name config)

# 3) Find [remote "origin"] 
# 4) Insert line (entire puttykeyfile line we picked up earlier)

echo 'Inserting missing TortoiseGit .ppk into submodules:'

for file in $files
do
    # -q says don't print the grep results, just return 0 or 1
    if grep -q putty $file
    then
        # I have no idea how to just say if not grep, so screw it here's an empty then
        /dev/null
    else
        echo $file
        # -i means overwrite the file rather than printing the result to
        # stdout
        sed -i "s/\(\[remote .origin.\]\)/\1\n$puttyline/" $file
    fi
done 
```

gitpullall.sh

```
#!/bin/bash -v
git pull --recurse-submodules
git submodule update --recursive 
```

或者，如果您希望在子模块上获取 HEAD，而不是检查父 repo 的提交：

gitpullallhead.sh：

```
git submodule foreach git pull origin master 
```

他们是这样做的：

当其他人通过 TortoiseGit 拉下您的项目时，他们将比需要拉出所有子模块更糟糕——他们甚至不会配置这些子模块。更糟糕的是，如果他们试图设置它们：

1.  TortoiseGit 只会妨碍他们——它还没有任何东西可以解决这个问题。
2.  他们将使用命令行，它将每个子模块指向其 repo，但不会像普通的 Pull 那样将其与您的 Tortoise/PuTTY 键关联。

因此，如果他们只是运行 gitsetup.sh，它会处理所有这些 - 它设置每个子模块，拉取它，甚至将特殊的 .ppk（PuTTY 键）配置设置插入每个子模块。适用于任何项目 - 无需每次都进行调整。

gitpullall.sh 会按照您的想法进行操作，它会获取所有内容。

因此，严格来说不是 TortoiseGit 解决方案（不存在），但仍然足够方便。

这些脚本中的评论很可能证明了这一点，我不是 Bash 专业人士，并且显然将它们破解在一起。我欢迎改进建议，尤其是在最明显的地方。但我向您保证，它们不仅可以工作，而且可以在我们的多个项目中工作，其中有许多子模块存储在多个目录级别。

老答案：

就像是：

```
for module in a b c d; do cd $module; git pull; cd..; done 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-17T13:31:56.243

我还可以右键单击作为子模块的文件夹，然后对该文件夹执行正常的 Git Pull。

这仅提取了子模块 - 比上面针对单个子模块的（诚然很棒）答案稍微简单一些。

# android - 即使设置了正确的尺寸，相机预览也会被拉伸

> ID：16058926
> 
> 赞同：19
> 
> 时间：2013-04-17T11:33:37.043
> 
> 标签：android, android-camera, surfaceview

我正在创建一个相机应用程序，它实现了自己的相机预览来拍照。该应用程序当前被强制进入纵向模式。

我的问题是相机的预览略微拉伸（纵横比有点偏离）。有趣的是，我将 SurfaceView 的大小设置为始终与预览大小匹配。这样可以确保始终保持纵横比……但事实并非如此……

这是我用来显示我的相机预览的布局：

```
public class Cp extends ViewGroup implements SurfaceHolder.Callback {
    private final String TAG = "CameraPreview";

    private boolean mPreviewRunning = false;

    private SurfaceView mSurfaceView;
    private SurfaceHolder mHolder;
    private Size mPreviewSize;
    private List<Size> mSupportedPreviewSizes;
    private Camera mCamera;

    public boolean IsPreviewRunning() {
        return mPreviewRunning;
    }

    public Cp(Context context) {
        this(context, null, 0);
    }

    public Cp(Context context, AttributeSet attrs) {
        this(context, attrs, 0);
    }

    public Cp(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);

        mSurfaceView = new SurfaceView(context);
        addView(mSurfaceView);

        // Install a SurfaceHolder.Callback so we get notified when the
        // underlying surface is created and destroyed.
        mHolder = mSurfaceView.getHolder();
        mHolder.addCallback(this);
        mHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
    }

    public void setCamera(Camera camera) {
        mCamera = camera;
        if (mCamera != null) {
            requestLayout();
        }
    }

    public void switchCamera(Camera camera) {
        setCamera(camera);
        try {
            camera.setPreviewDisplay(mHolder);
        } catch (IOException exception) {
            Log.e(TAG, "IOException caused by setPreviewDisplay()", exception);
        }
        Camera.Parameters parameters = camera.getParameters();
        parameters.setPreviewSize(mPreviewSize.width, mPreviewSize.height);
        requestLayout();

        camera.setParameters(parameters);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        // We purposely disregard child measurements because act as a wrapper to
        // a SurfaceView that
        // centers the camera preview instead of stretching it.
        final int width = resolveSize(getSuggestedMinimumWidth(),
                widthMeasureSpec);
        final int height = resolveSize(getSuggestedMinimumHeight(),
                heightMeasureSpec);
        setMeasuredDimension(width, height);

        if (mSupportedPreviewSizes == null && mCamera != null) {
            mSupportedPreviewSizes = mCamera.getParameters()
                    .getSupportedPreviewSizes();
        }
        if (mSupportedPreviewSizes != null) {
            mPreviewSize = getOptimalPreviewSize(mSupportedPreviewSizes, width,
                    height);
        }
    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        if (changed && getChildCount() > 0) {
            final View child = getChildAt(0);

            final int width = r - l;
            final int height = b - t;

            int previewWidth = width;
            int previewHeight = height;
            if (mPreviewSize != null) {
                previewWidth = mPreviewSize.height;
                previewHeight = mPreviewSize.width;
            }
            if (previewWidth == 0) {
                previewWidth = 1;
            }
            if (previewHeight == 0) {
                previewHeight = 1;
            }

            // Center the child SurfaceView within the parent.
            if (width * previewHeight > height * previewWidth) {
                final int scaledChildWidth = previewWidth * height
                        / previewHeight;
                child.layout((width - scaledChildWidth) / 2, 0,
                        (width + scaledChildWidth) / 2, height);
            } else {
                final int scaledChildHeight = previewHeight * width
                        / previewWidth;
                child.layout(0, (height - scaledChildHeight) / 2, width,
                        (height + scaledChildHeight) / 2);
            }
        }
    }

    @Override
    public void surfaceCreated(SurfaceHolder holder) {
        // The Surface has been created, acquire the camera and tell it where to
        // draw.
        try {
            if (mCamera != null) {
                Parameters params = mCamera.getParameters();
                mSupportedPreviewSizes = params.getSupportedPreviewSizes();
                mCamera.setPreviewDisplay(holder);
            }
        } catch (IOException exception) {
            Log.e(TAG, "IOException caused by setPreviewDisplay()", exception);
        }
    }

    @Override
    public void surfaceDestroyed(SurfaceHolder holder) {
        // Surface will be destroyed when we return, so stop the preview.
        stop();
    }

    private Size getOptimalPreviewSize(List<Size> sizes, int w, int h) {
        final double ASPECT_TOLERANCE = 0.1;
        double targetRatio = (double) w / h;
        if (sizes == null)
            return null;

        Size optimalSize = null;
        double minDiff = Double.MAX_VALUE;

        int targetHeight = h;

        // Try to find an size match aspect ratio and size
        for (Size size : sizes) {
            double ratio = (double) size.width / size.height;
            if (Math.abs(ratio - targetRatio) > ASPECT_TOLERANCE)
                continue;
            if (Math.abs(size.height - targetHeight) < minDiff) {
                optimalSize = size;
                minDiff = Math.abs(size.height - targetHeight);
            }
        }

        // Cannot find the one match the aspect ratio, ignore the requirement
        if (optimalSize == null) {
            minDiff = Double.MAX_VALUE;
            for (Size size : sizes) {
                if (Math.abs(size.height - targetHeight) < minDiff) {
                    optimalSize = size;
                    minDiff = Math.abs(size.height - targetHeight);
                }
            }
        }
        return optimalSize;
    }

    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int w, int h) {
        if (mCamera != null) {
            // Now that the size is known, set up the camera parameters and
            // begin the preview.
            Camera.Parameters parameters = mCamera.getParameters();
            if (mPreviewSize != null) {
                parameters.setPreviewSize(mPreviewSize.width,
                        mPreviewSize.height);
            }
            requestLayout();

            mCamera.setParameters(parameters);
            mCamera.startPreview();
            mPreviewRunning = true;
        }
    }

    public void stop() {
        if (mCamera != null) {
            mCamera.stopPreview();
            mPreviewRunning = false;
            mCamera = null;
        }
    }
} 
```

请注意，`onLayout`宽度和高度是交换的，因为应用程序始终以纵向运行。

我包括一些图片来向您展示问题的样子： ![在此处输入图像描述](https://i.stack.imgur.com/VFwes.jpg)

![在此处输入图像描述](https://i.stack.imgur.com/MmdYW.jpg)

我已经调试了代码。预览大小被设置为 1280x720，并且布局的大小也被正确调整以匹配该大小。

我也尝试过不同的布局，但结果总是一样的......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-12T17:56:06.520

我遇到了同样的问题，在这个难题中度过了几天后，我的 Java 类最终出现在以下代码上：

所以，问题发生了，因为相机显示器的尺寸（高 x 宽）为 576x720，而我的显示器是 1184x720。因此，相机预览（我的表面视图类）被拉伸以填充父级。

所以，有效的方法是让这个视图比我的屏幕大，并且只显示我的屏幕区域。所以，我不得不使用这种奇怪的框架组合（线性布局内的相对布局），这样相对的大小就会像我想要的一样大 - 表面视图将填充它 - 而线性将只占用我想展示的部分。

```
package com.example.frame.camera;

import android.content.Context;
import android.hardware.Camera;
import android.util.Log;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.ViewGroup.LayoutParams;
import android.widget.LinearLayout;
import android.widget.RelativeLayout;
import android.widget.Toast;

import com.example.frame.MainActivity;

public class NativeCamera extends SurfaceView implements SurfaceHolder.Callback {

    static private NativeCamera instance;

    private LinearLayout        frame               = null;
    private RelativeLayout      innerFrame          = null;

    private Camera              camera;
    private final SurfaceHolder previewHolder;
    private static final String TAG                 = "NativeCamera.java";

    private boolean             inPreview           = false;
    private boolean             cameraConfigured    = false;
    private boolean             frontCamera         = false;

    private Camera.Size         size;

    static public NativeCamera getInstance() {
        if (NativeCamera.instance == null) {
            if (MainActivity.debug) {
                Log.d(TAG, "Creating Camera Singleton");
            }
            NativeCamera.instance = new NativeCamera(MainActivity.instance);
        }
        return NativeCamera.instance;
    }

    public void onResume() {
        if (MainActivity.debug) {
            Log.d(TAG, "onResume");
        }
        camera = Camera.open();
        if (size != null) {
            initPreview(size.width, size.height);
        }
        startPreview();
    }

    public void onPause() {
        if (MainActivity.debug) {
            Log.d(TAG, "onPause");
        }
        if (inPreview) {
            camera.stopPreview();
        }
        camera.release();
        camera = null;
        inPreview = false;
    }

    public void onDestroy() {
        if (MainActivity.debug) {
            Log.d(TAG, "onDestroy");
        }
        NativeCamera.instance = null;
    }

    public void onSwitch() {
        frontCamera = !frontCamera;
        if (inPreview) {
            camera.stopPreview();
        }
        camera.release();

        int cam = frontCamera ? 1 : 0;

        camera = Camera.open(cam);
        if (size != null) {
            initPreview(size.width, size.height);
        }
        startPreview();
    }

    private NativeCamera(Context context) {
        super(context);
        // TODO Auto-generated constructor stub

        // Install a SurfaceHolder.Callback so we get notified when the
        // underlying surface is created and destroyed.
        previewHolder = getHolder();
        previewHolder.addCallback(this);
        // deprecated setting, but required on Android versions prior to 3.0
        // previewHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        innerFrame = new RelativeLayout(MainActivity.instance);
        innerFrame.addView(this);
        frame = new LinearLayout(MainActivity.instance);
        frame.addView(innerFrame);
    }

    public LinearLayout getFrame() {
        return frame;
    }

    public void surfaceChanged(SurfaceHolder holder, int format, int width,
            int height) {
        // TODO Auto-generated method stub
        if (MainActivity.debug) {
            Log.d(TAG, "surfaceChanged");
        }
        initPreview(width, height);
        startPreview();
    }

    public void surfaceCreated(SurfaceHolder holder) {
        // TODO Auto-generated method stub
        // no-op -- wait until surfaceChanged()

    }

    public void surfaceDestroyed(SurfaceHolder holder) {
        // TODO Auto-generated method stub
        // no-op
    }

    private Camera.Size getBestPreviewSize(int width, int height,
            Camera.Parameters parameters) {
        Camera.Size result = null;

        for (Camera.Size size : parameters.getSupportedPreviewSizes()) {
            if (size.width <= width && size.height <= height) {
                if (result == null) {
                    result = size;
                } else {
                    int resultArea = result.width * result.height;
                    int newArea = size.width * size.height;

                    if (newArea > resultArea) {
                        result = size;
                    }
                }
            }
        }

        this.size = result;
        return (result);
    }

    private void initPreview(int width, int height) {
        if (camera != null && previewHolder.getSurface() != null) {

            if (!cameraConfigured) {
                Camera.Parameters parameters = camera.getParameters();
                Camera.Size size = getBestPreviewSize(width, height, parameters);

                if (size != null) {
                    parameters.setPreviewSize(size.width, size.height);
                    camera.setParameters(parameters);
                    cameraConfigured = true;
                    // Setting up correctly the view
                    double ratio = size.height / (double) size.width;
                    LayoutParams params = innerFrame.getLayoutParams();
                    params.height = MainActivity.size.y;
                    params.width = (int) (MainActivity.size.y * ratio);
                    innerFrame.setLayoutParams(params);
                    int deslocationX = (int) (params.width / 2.0 - MainActivity.size.x / 2.0);
                    innerFrame.animate().translationX(-deslocationX);
                }
            }

            try {
                camera.setPreviewDisplay(previewHolder);
                camera.setDisplayOrientation(90);

            } catch (Throwable t) {
                Log.e(TAG, "Exception in setPreviewDisplay()", t);
                Toast.makeText(MainActivity.instance, t.getMessage(), Toast.LENGTH_LONG).show();
            }

        }
    }

    private void startPreview() {
        if (MainActivity.debug) {
            Log.d(TAG, "startPreview");
        }
        if (cameraConfigured && camera != null) {
            camera.startPreview();
            inPreview = true;
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-02-18T12:26:57.523

我一直在尝试解决同样的问题......下面的代码对我有用：

```
private void setMyPreviewSize(int width, int height) {
    // Get the set dimensions
    float newProportion = (float) width / (float) height;

    // Get the width of the screen
    int screenWidth = getWindowManager().getDefaultDisplay().getWidth();
    int screenHeight = getWindowManager().getDefaultDisplay().getHeight();
    float screenProportion = (float) screenWidth / (float) screenHeight;

    // Get the SurfaceView layout parameters
    android.view.ViewGroup.LayoutParams lp = surfaceView.getLayoutParams();
    if (newProportion > screenProportion) {
        lp.width = screenWidth;
        lp.height = (int) ((float) screenWidth / newProportion );
    } else {
        lp.width = (int) (newProportion * (float) screenHeight);
        lp.height = screenHeight;
    }
    // Commit the layout parameters
    surfaceView.setLayoutParams(lp);
} 
```

你可以看到线程：[Resizing surface view for aspect ratio change in video display in android](https://stackoverflow.com/questions/20491499/resizing-surface-view-for-aspect-ratio-change-in-video-display-in-android)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-15T16:35:17.160

这是一个解决方案

surfaceChanged 只是为了获得最佳的预览尺寸

```
@Override
            public void surfaceChanged(SurfaceHolder holder, int format, int width, int height) {
                Log.e("MYTAG", "surfaceChanged " );

                Camera.Parameters myParameters = camera.getParameters();
                Camera.Size myBestSize = getBestPreviewSize(width, height, myParameters);

                if(myBestSize != null){
                    myParameters.setPreviewSize(myBestSize.width, myBestSize.height);
                    camera.setParameters(myParameters);
                    camera.startPreview();

                }
            }

@Override
    public void onPictureTaken(byte[] data, Camera camera) {

        Bitmap bitmap = BitmapFactory.decodeByteArray(data, 0, data.length);
       imageReview.setImageBitmap(bitmap);
    } 
```

这将在 imageReview 上设置捕获的图像，但您需要一种方法来获取位图的旋转

您需要为拉伸图像问题设置 imageView scaleType 属性

```
<ImageView
        android:id="@+id/imageView"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:scaleType="centerCrop"
        /> 
```

# actionscript-3 - 您可以将影片剪辑链接到 Actionscript 3 中外部加载的图像上的某个点吗？

> ID：16058932
> 
> 赞同：0
> 
> 时间：2013-04-17T11:33:53.840
> 
> 标签：actionscript-3, flash, zooming, movieclip, pan

[编辑] 请看代码。我可以加载图像，我可以加载影片剪辑。图像缩放并平移到用户输入。但是，movieclip (mcInfo) 需要“附加”到图像上的某个点，以确保它随图像一起缩放和平移。这样做的原因是因为该图像是一个由许多不同产品组成的大型灌溉装置。信息图标 (mcInfo) 应该是一个可点击的影片剪辑，以显示该产品的信息。图像上会有很多这样的图标。但它必须与用户想要查看的产品相关联。

```
var spImage:Sprite = new Sprite(); //load image to sprite "I think"
board.addChild(spImage);    

function initPic(e:Event):void {
      infoBox.text = "";
      infoBox.visible = false;
      image = Bitmap(loader.content);
      minScale = boardWidth/image.width;
      image.scaleX = minScale;
      image.scaleY = minScale;

      spImage.addChild(image);// the loaded image
      spImage.addChild(mcIn); // custom zoom in cursor
      spImage.addChild(mcOut); // custom zoom out cursor
      spImage.addChild(mcInfo); //information icon. This is the movieclip that I need to set at a point 

      spImage.addEventListener(MouseEvent.MOUSE_DOWN, startDragging);
      stage.addEventListener(MouseEvent.MOUSE_UP, stopDragging);

      loader.contentLoaderInfo.removeEventListener(Event.COMPLETE, initPic);
      loader.contentLoaderInfo.removeEventListener(ProgressEvent.PROGRESS, updateInfo);
      loader = null;

      board.filters = [ new DropShadowFilter() ];
      spImage.addEventListener(MouseEvent.CLICK, zoom);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:45:29.260

将您加载的图像放入 a`Sprite`中，然后在其中添加所需的`DescriptionObject`任何位置`Sprite`。`Sprite`从现在开始，在而不是加载的图像上进行所有缩放和平移。当触发`Event.COMPLETE`事件时，您的图像变得完全可用。`loaded.contentLoaderInfo`内部`initPic`函数做：

```
theSprite.addChild(event.target.content) //adds your image to the Sprite object
theSprite.addChild(description); 
description.x = 100;
description.y = 200; 
```

# javascript - 移动 noscript 消息

> ID：16058933
> 
> 赞同：1
> 
> 时间：2013-04-17T11:33:55.763
> 
> 标签：javascript, css, noscript

当用户禁用他的 JS 时，我在我的网站上使用以下 Javascript noscript 消息：

```
<noscript>

 For full functionality of this site it is necessary to enable <b>JavaScript</b>.
 Here are the <a href="http://www.enable-javascript.com/" target="_blank">
 instructions how to enable JavaScript in your web browser</a>.

</noscript> 
```

**我的问题：**

它当前位于窗口的绝对顶部。我想把它移下来说 top:20px ......

我尝试将文本包装在与顶部有偏移的 div 中，但只有文本与 div 一起移动，而不是`noscript`标签应用的红色边框样式（我没有对 应用任何样式`noscript`，它有自己的边框)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-17T11:35:06.103

使用 CSS：

```
noscript
{
    position: fixed;
    top: 20px;
} 
```

# actionscript-3 - 使用 SWC 时继承定义冲突

> ID：16058936
> 
> 赞同：0
> 
> 时间：2013-04-17T11:34:15.380
> 
> 标签：actionscript-3, flash, swc

我正在使用 Flash CS6，但我被继承的定义困住了。

假设我有一个名为 Button 的类，例如：

```
public class Button extends MovieClip
{
    public var _text : TextField;
} 
```

在库中，我想创建一个 MovieClip 符号，将其导出到 actionscript 并将“类”设置为“ButtonSkinned”，将“基类”设置为“按钮”。在这个 MovieClip 符号中，我在舞台上放置了一个名为“_text”的文本字段。

这是定义自定义影片剪辑并进行蒙皮的传统方式，对吗？

问题来了：

如果我通过将“按钮”类添加到我的类路径中来使用它，那么一切都很好。

如果我将此类预编译为 SWC 文件并将其添加为外部库。当我导出 SWF 时，Flash CS6 抛出一个错误：

```
Symbol 'ButtonSkinned' A conflict exists with inherited definition MyPackage:Button._text in namespace public. 
```

当然，我已经禁用了“自动声明阶段实例”。我不知道如何摆脱这个错误。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:37:35.520

如果您使用公共变量扩展非动态类，则不需要重新声明它们，是的，在这种情况下您甚至无法重新定义这样的变量。“受保护”和“公共”变量对超类和子类都可用。总之，不要`public var _text`在`ButtonSkinned`类中声明，在里面定义`Button`就够了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T06:21:22.480

我发现了同样的情况并在这里四处走走：[http ://forums.adobe.com/thread/198821](http://forums.adobe.com/thread/198821)

走一走的关键是手动编写视觉符号关联类代码，而不是Flash自动生成。为了更容易使用 JSFL 脚本来自动编写类代码将非常有帮助。

# java - IO和NIO的性能区别及例子

> ID：16058938
> 
> 赞同：3
> 
> 时间：2013-04-17T11:34:18.813
> 
> 标签：java, jakarta-ee, io, nio

我对 Java NIO 很陌生，没有动手。关于 Java NIO，我知道它比 java.IO 快。

因此，只是为了尝试一下，我想编写简单的程序来“将一个文件的内容复制到另一个文件”。“从大文件中搜索单词”。

同时使用 java.io 和 java.nio 包。

另外，我分别在操作开始和结束之前和之后打印了时间。

我没有发现 NIO 更快的任何区别。可能是我走错了方向。

任何人都可以指导我通过示例正确看到差异的场景吗？

编辑：

得知这个问题会得到反对票，我真的很惊讶。我已经提到我是 NIO 的新手，如果我走错了方向，我会指导我。我没有发布程序，因为它是非常基本的读写操作......请参阅下面我用来测试的程序......

使用 IO

```
public static void copyFile(File in, File out) throws Exception {

    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS");
    Date now = new Date();
    String strDate = sdf.format(now);

    System.out.println("Before Read :"+strDate);

    FileInputStream fis  = new FileInputStream(in);
    FileOutputStream fos = new FileOutputStream(out);
    try {
        byte[] buf = new byte[1024];
        int i = 0;
        while ((i = fis.read(buf)) != -1) {
            fos.write(buf, 0, i);
        }
    } 
    catch (Exception e) {
        throw e;
    }
    finally {
        if (fis != null) fis.close();
        if (fos != null) fos.close();
    }

    Date now1 = new Date();
    String strDate1 = sdf.format(now1);

    System.out.println("After Read :"+strDate1);

} 
```

使用蔚来

```
 public static void copyFile(File in, File out) 
        throws IOException 
{

    SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS");
    Date now = new Date();
    String strDate = sdf.format(now);

    System.out.println("Before Read :"+strDate);

    FileChannel inChannel = new
        FileInputStream(in).getChannel();
    FileChannel outChannel = new
        FileOutputStream(out).getChannel();
    try {
        inChannel.transferTo(0, inChannel.size(),
                outChannel);
    } 
    catch (IOException e) {
        throw e;
    }
    finally {
        if (inChannel != null) inChannel.close();
        if (outChannel != null) outChannel.close();
    }

    Date now1 = new Date();
    String strDate1 = sdf.format(now1);

    System.out.println("After Read :"+strDate1);
} 
```

我从一个文件复制到另一个文件的文件大约是 20 MB。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-23T07:40:42.770

NIO 允许您仅使用单个（或更少）线程来管理多个通道，但代价是解析数据可能比使用标准 IO 从阻塞流中读取数据要复杂一些。

如果您需要同时管理数千个打开的连接，每个连接只发送少量数据，例如聊天服务器，那么在 NIO 中实现服务器可能是一个优势。同样，如果您需要保持与其他计算机的大量打开连接，例如在 P2P 网络中，使用单个线程来管理所有出站连接可能是一个优势。

如果您的连接较少且带宽非常高，一次发送大量数据，那么标准 IO 服务器实现应该是您的选择。

Ref :[标准 IO 和 NIO 的区别](http://howtodoinjava.com/2013/12/22/difference-between-standard-io-and-nio/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-17T12:16:55.470

NIO 更快并不是真的。保罗·泰玛（Paul Tyma）在某个时候打破了这个神话。

[http://mailinator.blogspot.in/2008/02/kill-myth-please-nio-is-not-faster-than.html](http://mailinator.blogspot.in/2008/02/kill-myth-please-nio-is-not-faster-than.html)

[http://paultyma.blogspot.in/2008/03/writing-java-multithreaded-servers.html](http://paultyma.blogspot.in/2008/03/writing-java-multithreaded-servers.html)

# javascript - Javascript 地理位置

> ID：16058939
> 
> 赞同：1
> 
> 时间：2013-04-17T11:34:23.663
> 
> 标签：javascript, geolocation, return

我正在尝试用地理位置做一些事情。我想将一个变量中的地理位置纬度和经度作为数组取回。它不起作用。我认为代码中的第一行是问题所在。是否有可能获得这样的价值（有回报）？

```
startingPoint = navigator.geolocation.getCurrentPosition(onGeoSuccess);

function onGeoSuccess(position) {
    start['lat'] = position.coords.latitude;
    start['lng'] = position.coords.longitude;
    return start;
} 
```

有更好的解决方案吗？我不想在 onGeoSuccess 中执行其他代码，我想返回值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-26T18:18:45.633

你可以尝试这样的事情：

```
function geolocate() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var geolocation = new google.maps.LatLng(
        position.coords.latitude, position.coords.longitude);
      var circle = new google.maps.Circle({
        center: geolocation,
        radius: position.coords.accuracy
      });
      autocomplete.setBounds(circle.getBounds());
    });
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T11:37:42.100

检查是否支持地理定位并执行这样的代码

```
function getLocation()
  {
  if (navigator.geolocation)//check for support
    {
    navigator.geolocation.getCurrentPosition(showPosition);
    }
  else{x.innerHTML="Geolocation is not supported by this browser.";}
  }
function showPosition(position)
  {
  x.innerHTML="Latitude: " + position.coords.latitude + 
  "<br>Longitude: " + position.coords.longitude; 
  } 
```

# c# - Mono for Android / MonoTouch System.Net.WebException：请求中止

> ID：16058943
> 
> 赞同：4
> 
> 时间：2013-04-17T11:34:45.377
> 
> 标签：c#, exception, mono, xamarin.ios, xamarin.android

当我使用以下代码向 FTP 服务器发出请求时。如果请求失败，我会收到错误消息。我不知道为什么。

代码：

```
try
{
      FtpWebRequest request = GetFtpWebResquest(WebRequestMethods.Ftp.ListDirectoryDetails, shareInfo.Uri);
      FtpWebResponse response = (FtpWebResponse)request.GetResponse();
      root = new FtpResource(this, response);
}
catch (Exception e)
{                  
} 
```

例外：

```
Unhandled Exception:
System.Net.WebException: Request aborted
at System.Net.FtpWebRequest.CheckIfAborted () [0x00000] in <filename unknown>:0 
at System.Net.FtpWebRequest.set_State (RequestState value) [0x00000] in <filename     unknown>:0 
at System.Net.FtpWebRequest.ProcessRequest () [0x00000] in <filename unknown>:0 
at System.Threading.Thread.StartInternal () [0x00000] in <filename unknown>:0 
[ERROR] FATAL UNHANDLED EXCEPTION: System.Net.WebException: Request aborted
at System.Net.FtpWebRequest.CheckIfAborted () [0x00000] in <filename unknown>:0 
at System.Net.FtpWebRequest.set_State (RequestState value) [0x00000] in <filename unknown>:0 
at System.Net.FtpWebRequest.ProcessRequest () [0x00000] in <filename unknown>:0 
at System.Threading.Thread.StartInternal () [0x00000] in <filename unknown>:0 
@@@ ABORTING: INVALID HEAP ADDRESS IN dlfree addr=0x420e3580
_wapi_handle_ref: Attempting to ref unused handle 0x41c
* Assertion at /Users/builder/data/lanes/monodroid-lion-bs1/03814ac5/source/mono/mono/io-layer/wthreads.c:1365, condition `ok' not met 
```

**编辑：** 为了更好地理解，我实现了一个从 AsyncTask 调用的简单测试方法。AsnycTask 启动一次，除了 GUI 线程和此 AsyncTask 之外，我不使用其他线程。每隔几秒钟，AsyncTask 就会收到我的 ListView 的所有条目并设置状态（离线/在线）。2 - 3 分钟后，我得到了上面未处理的异常。

**异步任务：**

```
#region implemented abstract members of AsyncTask
protected override Java.Lang.Object DoInBackground (params Java.Lang.Object[] @params)
{
try
{
    _isRunning = true;
    while (_isRunning) 
    {                     
        if (Statics.IsInternetAvailable(_context))
        {
            AvailableShareAdapter adapter = _context.GetAvailableSharesAdapter();
            if (adapter != null)
            {
                List<ShareInformation> list = adapter.GetAllItems();
                foreach(ShareInformation si in list)
                {
                    if (!_isRunning)
                        break;

                    si.State = ShareInformation.ShareState.Testing;
                    _handler.Post(new Java.Lang.Runnable(() => { _context.GetAvailableSharesAdapter().NotifyDataSetChanged(); } ));

                    if (_coreFacade.SimpleTest(si.Uri, si.UserName, si.Password))
                         si.State = ShareInformation.ShareState.Online;
                    else
                         si.State = ShareInformation.ShareState.Offline;

                   _handler.Post(new Java.Lang.Runnable(() => { _context.GetAvailableSharesAdapter().NotifyDataSetChanged(); } ));

              }
         }
         Thread.Sleep(60000); 
      }                 
    }
} catch(Exception e)
{
    _coreFacade.Log("DoInBackground", e.ToString());
}

return null;
}
#endregion 
```

**简单测试：**

```
public bool SimpleTest(string uri, string username, string password)
{
    Console.WriteLine("SimpleTest called");
    try {
        WebRequest request = HttpWebRequest.Create(uri);
        request.Credentials = new NetworkCredential(username, password);
        request.Method = WebRequestMethods.Ftp.ListDirectoryDetails;
        request.Timeout = 30 * 1000;
        FtpWebResponse response = (FtpWebResponse)request.GetResponse();
        return true;
    } catch (Exception ex) {
        Console.WriteLine(ex.ToString());
        return false;
    }
} 
```

**编辑2：** 顺便说一句......我只在连接失败时得到这个未处理的异常。如果 FTP 源可用，一切正常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-11T06:25:03.593

简短的回答：这是一个 Mono 错误（实际上是 FtpWebRequest 中的几个错误之一）。如果可能，切换到替代 FTP 客户端类/库（例如 JP Trosclair 的 System.Net.FtpClient）。

长答案：

抛出“请求中止”异常的线程是运行时创建的线程，这就是您无法捕获异常的原因（以及运行时终止的原因）。

我最近遇到了同样的问题，花了很多时间调试它。

如果您查看 Mono 的 FtpWebRequest（截至目前的最新来源）：

[https://github.com/mono/mono/blob/5aeeb9cf7b558b8a92a7eb7d6a524cc4e7b60191/mcs/class/System/System.Net/FtpWebRequest.cs](https://github.com/mono/mono/blob/5aeeb9cf7b558b8a92a7eb7d6a524cc4e7b60191/mcs/class/System/System.Net/FtpWebRequest.cs)

您将看到 ProcessRequest（来自您的堆栈跟踪）是一个 ThreadStart 委托，并且感兴趣的线程确实是由运行时创建的（第 391 和 442 行）。

事实证明，FtpWebReuqest.GetResponse() 虽然按照规范是同步的，但实际上在引擎盖下是异步的 [原文如此！] —— 第 422 行。这创建了动态环境（我们很快就会看到）容易出错。

以下是在失败场景之一（TCP connect() 超时）中发生的情况：

```
[calling thread] Create(); // FtpWebRequest object, State == RequestState.Before
[calling thread] GetResponse();
[calling thread]  BeginGetResponse();
[calling thread]    State = RequestState.Scheduled;
[calling thread]    new Thread(ProcessRequest()).Start() // runtime-created thread
[calling thread]  EndGetResponse();
[calling thread]    WaitUntilComplete();
[runtime thread]  ProcessRequest();
[runtime thread]    ProcessMethod();
[runtime thread]      State = RequestState.Connecting;
[runtime thread]      OpenControlConnection();
[runtime thread]        Socket.Connect();
         <time passes>
[calling thread]    Abort(); // WaitUntilComplete() times out
[calling thread]    State = RequestState.Aborted; // [!!]
[calling thread]    throw WebException("Transfer timed out");
                    // calling thread seems to think everything's fine, but...
         <some time later>
[runtime thread]        throw SocketException // Socket.Connect() times out
[runtime thread]        sock = null; // from exception handler
[runtime thread]        throw WebException("unable to connect to remote server");
                         // because sock was set to null
[runtime thread]    State = RequestState.Error;
                    // exception is caught in ProcessRequest, an attempt is made to
                    // change the State to RequestState.Error, but it's already been
                    // set to RequestState.Aborted by the calling thread [!!]
[runtime thread]      throw WebException("Request aborted");
                    // and this exception isn't caught anywhere... *KABOOM* 
```

啊，事情就是这样发生的。不幸的是，修复属于 Mono。

您当然可以尝试通过设置超过底层套接字的 connect() 超时的超时来解决它，但事实是，很少有其他代码路径可以让 Mono 抛出无法处理的异常...... :-(

# php - 会话数据自动丢失，无需在 codeigniter 中单击注销

> ID：16058950
> 
> 赞同：0
> 
> 时间：2013-04-17T11:35:32.283
> 
> 标签：php, codeigniter, session, session-variables

我有一个使用codeigniter的Web应用程序，用户大约200个。如果大约100个用户同时登录系统，有时用户会自动注销或重定向到登录页面而无需单击注销。

我的代码。

登录助手（加载 Construst 以检查登录与否）

```
function is_logged_in()
{
    //Get Codeigniter Instance
    $obj =& get_instance();

    $is_logged_in = $obj->session->userdata('LOGGED_IN');

    if(!isset($is_logged_in) || $is_logged_in != true)
    {   
        $obj->session->set_flashdata('message','<div class="error_login"><b>ERROR:</b> Silahkan login terlebih dahulu.</div>');

        //If no session, redirect to login page
        redirect('login', 'refresh');
    }

 } 
```

控制器。

```
public function verify()
{
    $username = $this->input->post('username');
    $password = $this->input->post('password');

    //Query the database
    $row = $this->Loginmodel->verify($username,$password);

    if (count($row)) {

        $dataSession = array(
            'userid' => $row->userid,
            'role' => $row->role,
            'prov_cd' => $row->prov_cd,
            'kab_cd' => $row->kab_cd,
            'LOGGED_IN'=> true,
            'MODAL'=> true
        );

        $this->session->set_userdata($dataSession);

        redirect('dashboard','refresh');

    } 
    else
    {
         $this->session->set_flashdata('message','<div class="error_login"><b>ERROR:</b> Username atau password salah.</div>');
         redirect('login','refresh');
    }

} 
```

我认为这是因为我在会话数据中存储了许多参数。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:43:33.070

看看你的 count($row) 你能指定它是

```
COUNT($row) == 1 
```

所以我有点理解你想要做什么，如果 $row 返回计数 0 那么用户名密码没有验证，如果它返回单个用户示例

```
== 1 
```

那么用户名是正确的并进行了验证。试试这个解决方案。

根据 php 文档，它不返回布尔值 true 或 false。请尝试一下。还有什么错误？

同样为了进一步的实现，我引用了“计算数组中的所有元素，或者对象中的某些东西”。所以只是打电话

```
COUNT($row) { // If it is true or not will not work 
```

我怀疑您必须明确说明计数是否为 == 1，然后是的，我们确实得到了查询的返回，让该人继续。

好吧，我也会从 CI 的角度进一步扩展这个主题！

我怀疑您也没有检查是否设置了会话......我建议创建一个 MY_Controller 情况。这很容易，并且会为...减少麻烦

请看一下这段代码：

```
<?php
if (!defined('BASEPATH'))
    exit('No direct script access allowed');

class MY_Controller extends CI_Controller { // Create your custom controller
    public function __construct() {
        parent::__construct();
    }
} 
```

然后在同一个文件中执行以下操作：

class MY_logincontroller extends MY_Controller { // 扩展你在上面创建的类

```
public function __construct() { 
    parent::__construct();
    $this -> load -> model('login_model'); // Load your login model
    $loggedin = $this -> session -> userdata('loggedin'); // set your user information
    $username = $this -> session -> userdata('username'); // Set your user information

    if ((!isset($loggedin)) || ($loggedin != TRUE)) { // This will check if the the session variable is set or if it is equal to logged in, if not it will send to a access denied page
        $this -> session -> unset_userdata('loggedin'); // If access denied happens unset user data logged in (just to be sure) and destroy all other session stuff
        $this -> session -> sess_destroy();
        $this -> load -> view('messages/accessdenied_view');
        $this -> output -> _display();
        die();
    }
    $this -> output -> set_header('Last-Modified: ' . gmdate("D, d M Y H:i:s") . ' GMT');
    $this -> output -> set_header('Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0');
    $this -> output -> set_header('Pragma: no-cache');
    $this -> output -> set_header("Expires: Mon, 26 Jul 1997 05:00:00 GMT");
} 
```

希望这可以为您解决一些问题

# tomcat - 如何在 tomcat 24 * 7 上运行特定代码？

> ID：16058951
> 
> 赞同：-5
> 
> 时间：2013-04-17T11:35:35.120
> 
> 标签：tomcat

场景如下，

我有一个 Web 应用程序，如果特定条件匹配，它将向用户发送电子邮件。现在我想让这个 web 应用程序自动化，它将在 tomcat 服务器上运行 24 * 7。没有人会触发这个 Web 应用程序。

所以我希望服务器本身触发这个 Web 应用程序并 24 * 7 运行。所以现在我不知道我应该把这个 Web 应用程序放在 tomcat 的哪个位置，以便它可以 24 * 7 运行。如果您需要任何其他详细信息，那么请让我知道。在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:40:07.853

在操作系统级别使用 cron。或者，如果您必须将其嵌入到您的应用程序中，请使用[Quartz tasks](http://quartz-scheduler.org/)。

# javascript - 如何在锚点后附加/添加文本框

> ID：16058960
> 
> 赞同：0
> 
> 时间：2013-04-17T11:36:04.153
> 
> 标签：javascript, jquery, jquery-ui, datatable

有 4 个可用的锚点，div 1,2,3,4 /div

我的查询是如何在 2 和 3 之间添加/附加文本框。

请。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:53:21.743

```
 <div id="1"></div>
  <div id="2"></div>
  <div id="3"></div>
  <div id="4"></div> 
```

//jquery后方法

```
$("#2").after('<input type="text" name="somename" />'); 
```

# android - Android 中的位置管理器

> ID：16058962
> 
> 赞同：0
> 
> 时间：2013-04-17T11:36:06.630
> 
> 标签：android, latitude-longitude, locationmanager

我是安卓新手。但它没有返回纬度和经度值。我在模拟器中试过这个。我测试并且 onLocationChanged 方法没有执行。我只需要获取当前位置的 gps 坐标

```
 final TextView tv1 = (TextView) findViewById(R.id.textView1);
    final TextView tv2 = (TextView) findViewById(R.id.textView2);
    LocationManager manager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);

    LocationListener listener = new LocationListener() {

        @Override
        public void onStatusChanged(String provider, int status, Bundle extras) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onProviderEnabled(String provider) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onProviderDisabled(String provider) {
            // TODO Auto-generated method stub

        }

        @Override
        public void onLocationChanged(Location location) {
            // TODO Auto-generated method stub

            //String kk = "wefewfwef";

            //tv1.setText(kk);
            if(location != null){

                latitude = location.getLatitude();
                longitude = location.getLongitude();

                int lat = (int) latitude;
                int longi  = (int) longitude;

                tv1.setText(lat);
                tv2.setText(longi);
            }

        }
    };

    manager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, listener);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-11T10:15:31.090

试试这个代码。

```
public class GPSTracker extends Service implements LocationListener{

private Context context;
boolean isGPSEnabled = false;
boolean isNetworkEnabled = false;
boolean canGetLocation = false;

Location location;
double latitude,longitude;

LocationManager locationManager;
AlertDialogManager am = new AlertDialogManager();
public GPSTracker(Context context){
    this.context = context;
    getLocation();
}
private Location getLocation() {
    // TODO Auto-generated method stub
    try{
        locationManager = (LocationManager)context.getSystemService(Context.LOCATION_SERVICE);

        isGPSEnabled = locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER);

        isNetworkEnabled = locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER);

        if (!isGPSEnabled && !isNetworkEnabled){

        } else {
            this.canGetLocation = true;

            if (isNetworkEnabled){

                locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 60000, 3, this);

                if (locationManager != null){
                    location = locationManager.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
                    if (location != null){
                        latitude = location.getLatitude();
                        longitude = location.getLongitude();
                    }
                }
            }

            if (isGPSEnabled){
                if (location == null){
                    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 60000, 3, this);
                    if (locationManager != null){
                        location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER);
                        if (location != null){
                            latitude = location.getLatitude();
                            longitude = location.getLongitude();
                        }
                    }
                }
            } else {
                showAlertDialog();
            }
        }
    }catch(Exception e){
        e.printStackTrace();
    }
    return location;
}

public void showAlertDialog(){
    am.showAlertDialog(GPSTracker.this, "GPS Setting", "Gps is not enabled. Do you want to enabled it ?", false);
}
public double getLatitude(){
    if (location != null){
        latitude = location.getLatitude();
    }

    return latitude;
}

public double getLongitude(){
    if (location != null){
        longitude = location.getLongitude();
    }

    return longitude;
}

public boolean canGetLocation(){
    return this.canGetLocation;
}
@Override
public void onLocationChanged(Location location) {
    // TODO Auto-generated method stub
    if (location != null){
        this.location = location;
    }
}

@Override
public void onProviderDisabled(String provider) {
    // TODO Auto-generated method stub

}

@Override
public void onProviderEnabled(String provider) {
    // TODO Auto-generated method stub

}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub

}

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
} 
```

}

在您的 MainActivity 中创建此类的对象，如下所示。

```
GPSTracker gps = new GPSTracker();
latitude = gps.getLatitude();
longitude = gps.getLongitude(); 
```

不要忘记在清单文件中获得许可。

```
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION"/> 
```

# asp.net - webService 请求失败，HTTP 状态为 404

> ID：16058966
> 
> 赞同：1
> 
> 时间：2013-04-17T11:36:18.640
> 
> 标签：asp.net, web-services, http-status-code-404

我在通过 webService (System.Web.Services.Protocols.SoapHttpClientProtocol.ReadResponse) 发送大文件时遇到问题。

当文件小于 20 MB 时一切正常，如果文件更大，我会收到 404 代码的响应。

**异常信息**

```
Exception Type: System.Net.WebException
Status: ProtocolError
Response: System.Net.HttpWebResponse
Message: The request failed with HTTP status 404: Not Found.
Data: System.Collections.ListDictionaryInternal
TargetSite: System.Object[] ReadResponse(System.Web.Services.Protocols.SoapClientMessage, System.Net.WebResponse, System.IO.Stream, Boolean)
HelpLink: NULL
Source: System.Web.Services 
```

**StackTrace 信息**

```
 at System.Web.Services.Protocols.SoapHttpClientProtocol.ReadResponse(SoapClientMessage message, WebResponse response, Stream responseStream, Boolean asyncCall)
   at System.Web.Services.Protocols.SoapHttpClientProtocol.Invoke(String methodName, Object[] parameters)
   at ie.osds.DocumentsTransferBLL.FSDMZRepositoryService.FileStreamingWebService.UploadScanning(DateTime DateCreated, String Title, String FileName, String ReferenceNumber, String Author, String DocumentType, XmlNode IndexData, Byte[] Content, Nullable`1 IsCompressed, Nullable`1 Version, DateTime DateReceived, String CreatedBy, String OrigDocumentGUID)
   at ie.osds.DocumentsTransferBLL.Actions.ActionsHelper.UploadDocumentToDMZFileStreaming(FileStreamingWebService fsDMZWebService, SPQDocument spqDocument, String documentReferenceNumber, String documentAuthor, String documentType, Byte[] documentContent, String version, DateTime dateReceived)
   at ie.osds.DocumentsTransferBLL.Actions.DocumentsUploadAction.Upload()* 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T13:06:59.987

听起来您的文件上传超时：

**您可以在 global.asax 中捕获此错误以查看是否是这种情况：**

```
Protected Sub Application_EndRequest(ByVal sender As Object, ByVal e As System.EventArgs)

    Dim context As HttpContext = HttpContext.Current.ApplicationInstance.Context
    If Not IsNothing(context) Then

        If Not context.Response.StatusCode = HttpStatusCode.OK Then

            'Detect file upload exceeded max length:
            If context.Response.StatusCode = 404 And
                context.Response.SubStatusCode = 13 Then
                'clear the previous error page content:
                context.Response.Clear()
                'redirect to custom error page:
                context.Server.Transfer("~/error.aspx?code=404.13", False)
            End If

        End If

    End If
End Sub 
```

**您还可以像这样增加 web.config 中的请求长度：**

```
<system.web>
    <httpRuntime maxRequestLength="29296" />
</system.web> 
```

注意：值以千字节为单位

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-14T07:12:15.510

如果 Web 应用程序中有 Web 服务引用，只需将其删除然后重建，运行 Web 服务，然后再次将该 Web 服务引用添加到 Web 应用程序。

# javascript - Dynamically creating jQuery Dialog box & append it to DIV . Dialog is created but not within the DIV

> ID：16058972
> 
> 赞同：0
> 
> 时间：2013-04-17T11:36:29.313
> 
> 标签：javascript, jquery, html

```
$('.image').draggable({
    revert:'invalid',
    helper:'clone',
});
$('#content').droppable({
    accept:'.image',
    drop:function(event , ui{
        $('<div>').appendTo('#content').dialog();               
    }
}); 
```

**Dialog gets created but not within the CONTENT div. It gets created under the body !** *why it doesn't append under CONTENT ?*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:56:36.657

我相信这篇博客文章可能比我能更好地解释它 [http://blog.pengoworks.com/index.cfm/2007/10/26/jQuery-Understanding-the-chain](http://blog.pengoworks.com/index.cfm/2007/10/26/jQuery-Understanding-the-chain)

> jQuery 总是引用链中的第一个元素，除非您使用显式更改链的命令。

如果有人在 jquery 网站上引用了上述引用，请发布它，因为我也想刷新我对那个引用的知识..

**更新：** 实际上上述可能不是您的问题（保留为它仍然有效）似乎对话框本身在实际添加位置方面存在一些问题，请参见此处：http: [//forum.jquery.com/topic/dialog- will-move-its-div-tag-to-body](http://forum.jquery.com/topic/dialog-will-move-its-div-tag-to-body)

这些似乎已经解决，因此它确实取决于您的 jquery UI 版本，请参见此处： [http ://api.jqueryui.com/dialog/#option-appendTo](http://api.jqueryui.com/dialog/#option-appendTo)

```
$('.image').draggable({
    revert:'invalid',
    helper:'clone',
});
$('#content').droppable({
    accept:'.image',
    drop:function(event , ui{
        $('#content').dialog({ appendTo: "#content" });               
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T12:10:54.203

-function`dialog()`将其移出`#content`div。创建了一个小[小提琴](http://jsfiddle.net/L75PL/)，其中只有一个常规（非 dlg）div 被插入到 #content -> 作品中。然后我在html（非javascript）中插入了另一个div，并制作了一个对话框->移出#content

# html - Live Preview / WYSIWYG support (plugin?) for Notepad++?

> ID：16058975
> 
> 赞同：22
> 
> 时间：2013-04-17T11:36:41.033
> 
> 标签：html, css, notepad++, wysiwyg, live-preview

Anyone know of a way to have a split screen view in Notepad++ where I can be editing my HTML / CSS in one pane/tab and be seeing the Live Preview of what it would look like in a browser in another tab/pane.

Ideally, this would be:

1.  in Notepad++ itself (using native panes/tabs as described above)
2.  the user could configure whatever browser rendering engine (Chrome, FF, IE, etc...) they wanted to view the preview in

however, I could live with any variation of the two above, e.g. simply integrated with RubyMine using external windows/browsers, or maybe, the preview only available with limited rendering engines (only Chrome let's say).

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-10-15T09:19:25.327

该插件`Preview HTML`与您正在寻找的内容最接近。

转到`Plugins`菜单，然后找到`Preview HTML`安装它的条目。它的描述是：*在 Notepad++ 中（或在浮动窗口中）预览 HTML 文件，而无需先保存它们。*最新更新现在会在切换选项卡后或文档更改时自动刷新预览。

更多信息在官[网](http://fossil.2of4.net/npp_preview/home)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T02:13:01.683

我知道 Webstorm JetBrains 6.0.1 等程序可以做到这一点，您还必须下载 chrome 扩展程序。如果没有，那么您可以随时使用 Codeacademy.com 作为替代方案，并在编辑器中输入代码。它仍然有效。：/

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-15T03:25:25.343

我想你正在寻找它，“预览 HTML”。

这是简介：<a href="http://chiselapp.com/user/vor0nwe/repository/npp_preview/home" rel="nofollow">http://chiselapp.com/user/vor0nwe/repository/npp_preview/家

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-02-03T19:49:11.437

好吧，现在是8！岁。但我想我会插话。插件的作者不再更新它，而且，至少在我的机器上，它不再工作了。[1](http://chiselapp.com/user/vor0nwe/repository/npp_preview/wiki?name=Deprecation)

插件作者的建议是使用更现代的文本编辑器（如 Visual Studio Code）并使用其中一个扩展。（[浏览器预览](https://marketplace.visualstudio.com/items?itemName=auchenberg.vscode-browser-preview)）

# iphone - core data fetched property. refresh after update

> ID：16058977
> 
> 赞同：0
> 
> 时间：2013-04-17T11:36:45.253
> 
> 标签：iphone, ios, objective-c, core-data

I have UITableView with NSFetchedResultsController and a main context attached to it. I'm updating my main context from background.

```
- (void)contextDidSave:(NSNotification *)notification
{
    NSManagedObjectContext *context=[self managedObjectContext];
    [context performSelectorOnMainThread:@selector(mergeChangesFromContextDidSaveNotification:) withObject:notification waitUntilDone:YES];

    if ([context hasChanges])
    {            
        [context performSelectorOnMainThread:@selector(save:) withObject:nil waitUntilDone:YES];

    }        
} 
```

My UITableView reloads with new data and everything is fine, *but* some UITableView cell's data must be populated from fetched properties and I need that values to be refreshed.

I've read about NSManagedObjectContext's method refreshObject:mergeChanges: that might help. Where should I place it? If I will place it in cellForRowAtIndexPath's helper method - configureCell:atIndexPath: this will result in cycling row updates.

Here's the piece of cell configuration code:

```
- (void)configureCell:(UITableViewCell *)cell atIndexPath:(NSIndexPath *)theIndexPath
{
    //NSLog(@"PTAgencyList: configureCell: atIndexPath: %i %i", theIndexPath.section, theIndexPath.row);

    NSManagedObject *managedObj=[self.agenciesFetchedResultsController objectAtIndexPath:theIndexPath];
    if (managedObj==nil)
    {
        NSLog(@"PANIC: fetchedResultsController objectAtIndexPath: returned nil object");
        return;
    }
    else
    {

        CDAgency *agency=(CDAgency *)managedObj;

        [agency city];
        NSLog(@"agency.city_server_id: %@", agency.city_server_id);
        NSLog(@"agency.city.name: %@", ((CDCities *)[[agency city] objectAtIndex:0]).name);
        NSFetchRequest *fr=[[NSFetchRequest alloc] init];
        [fr setEntity:[NSEntityDescription entityForName:@"Cities" inManagedObjectContext:self.context]];
        [fr setPredicate:[NSPredicate predicateWithFormat:@"server_id=%@", agency.city_server_id]];
        NSArray *res=[self.context executeFetchRequest:fr error:nil];
        NSLog(@"fetched city name: %@", ((CDCities *)[res objectAtIndex:0]).name); 
```

After context update: fetched property city is nil (I think it is because it still points to the old city entry that was removed), *but* if I'm doing the fetch manually I'm getting fresh data.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:55:48.503

只需在配置单元格的位置显式调用获取的属性即可。

```
[managedObject fetchedPropertyAttribute]; 
```

它应该按预期重新计算。

此外，请考虑使用**关系**而不是获取的属性。

# android - 从可扩展列表视图中获取选定的孩子，然后转到 android 中的新活动

> ID：16058982
> 
> 赞同：0
> 
> 时间：2013-04-17T11:37:09.737
> 
> 标签：android, android-intent, expandablelistview, expandablelistadapter

请在下面检查我的代码：

```
 public class Expandable extends ExpandableListActivity implements OnChildClickListener {

ExpandableListView exp;

String[] parentList = {
        "Timeless", "The Gap", "Series Break", "Will You", "Casting Call", "Beyond Normal"
};

String[][] childList = {
        {
            "God In The Past", "God In The Present", "God In The Future"
        },
        {
            "Compassionate God", "Compassionate People"
        },
        {
            "Living The Life In The Kingdom", "Characteristics Of Early Church"
        },
        {
            "Be My Friend", "Be My Valentine", "Marry Me"
        },
        {
            "Casting Call"
        },
        {
            "Divine Courage", "Divine Guidance", "Divine Intervention"
        }
};

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.list);

    exp = (ExpandableListView) findViewById (R.id.expandableListView1);
    exp.setAdapter(new MyAdapter(this));

    exp.setOnChildClickListener(this);

}

@Override
public boolean onChildClick(ExpandableListView parent, View v,
           int groupPosition, int childPosition, long id) {

            if(childList[childPosition].equals("God In The Past")){
                Intent timeless = new Intent(this, MainActivity.class);
                startActivity(timeless);
            }

          return true;
         }

public class MyAdapter extends BaseExpandableListAdapter {

    private Context context;

    public MyAdapter(Context context) {
        // TODO Auto-generated constructor stub
        this.context = context;
    }

    @Override
    public Object getChild(int arg0, int arg1) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public long getChildId(int arg0, int arg1) {
        // TODO Auto-generated method stub
        return 0;
    }

    @Override
    public View getChildView(int groupPosition, int childPosition, 
            boolean isLastChild, View convertView, ViewGroup parent) {
        // TODO Auto-generated method stub

        TextView tv = new TextView(context);
        tv.setText(childList[groupPosition][childPosition]);
        tv.setPadding(50, 10, 10, 10);          
        return tv;
    }

    @Override
    public int getChildrenCount(int groupPosition) {
        // TODO Auto-generated method stub
        return childList[groupPosition].length;
    }

    @Override
    public Object getGroup(int groupPosition) {
        // TODO Auto-generated method stub
        return groupPosition;
    }

    @Override
    public int getGroupCount() {
        // TODO Auto-generated method stub
        return parentList.length;
    }

    @Override
    public long getGroupId(int groupPosition) {
        // TODO Auto-generated method stub
        return groupPosition;
    }

    @Override
    public View getGroupView(int groupPosition, boolean isExpanded, View convertView, ViewGroup parent) {
        // TODO Auto-generated method stub
        TextView tv = new TextView(context);
        tv.setText(parentList[groupPosition]);
        tv.setPadding(30, 10, 10, 10);
        return tv;
    }

    @Override
    public boolean hasStableIds() {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public boolean isChildSelectable(int arg0, int arg1) {
        // TODO Auto-generated method stub
        return true;
    }

}

} 
```

但在一线

```
 if(childList[childPosition].equals("God In The Past")){
                String TAG = null;
                Log.e(TAG, "God in the past");
                Intent timeless = new Intent(this, MainActivity.class);
                startActivity(timeless);
            } 
```

它似乎没有得到选定的子视图？我在这里缺少什么？

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T11:59:29.273

```
@Override
public boolean onChildClick(ExpandableListView parent, View v,
        int groupPosition, int childPosition, long id) {

    if(childList[groupPosition][childPosition].equals("God In The Past")){
        //Intent timeless = new Intent(this, MainActivity.class);
        //startActivity(timeless);
        Log.d(getClass().getName(), "I am pressed");
    }

    return true;
} 
```

像这样改变你的`onChildClick`功能，你没有考虑`groupPosition`.

还有一件事`getGroupView`像这样改变你的功能，`getChildView`也这样做。因为`AdpaterViews`通常重用他们的视图，所以不需要一次又一次地创建它。

```
@Override
public View getGroupView(int groupPosition, boolean isExpanded, View convertView, ViewGroup parent) {
       // TODO Auto-generated method stub
       TextView tv = (convertView == null ) ? new TextView(context) : (TextView)convertView;
       tv.setText(parentList[groupPosition]);
       tv.setPadding(30, 10, 10, 10);
       return tv;
} 
```

# php - To create div link in li of toplinks in magento

> ID：16058985
> 
> 赞同：0
> 
> 时间：2013-04-17T11:37:29.160
> 
> 标签：php, magento, hyperlink

I am using latest version of magento and i want to create div tag into li of toplinks in magento for cart link only. How can i do it? For class I have added

```
<liParams><class>mini-top-cart</class></liParams> 
```

but its also not working

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T02:34:54.680

如果您尝试仅在顶部链接中的“我的购物车链接”上进行一些设计更改，那么您可以轻松完成，而无需提及 div 类，只需更改默认定义为“top-link-cart”的“a”类. 因此，如果您覆盖放置在 core/Mage/Checkout/Block/Links.php 下的 Links 块并将其移动到本地文件夹以供将来校对，然后在函数 addCartLink() 中将底部定义的 $parentBlock 更改为拥有自己的类，它看起来像：

```
$parentBlock->addLink($text, 'checkout/cart', $text, true, array(), 50, null, 'class="top-link-cart"'); 
```

将其替换为您自己的类，例如迷你顶推车。

```
$parentBlock->addLink($text, 'checkout/cart', $text, true, array(), 50, null, 'class="mini-top-cart"'); 
```

完成后，您可以通过添加

```
a.mini-top-cart {
your styles here } 
```

希望有帮助

# c++ - 在 C++ 中反转句子的单词，在 Google Code jam 上提问

> ID：16058989
> 
> 赞同：1
> 
> 时间：2013-04-17T11:37:42.443
> 
> 标签：c++, string

如何解决这个问题？[https://code.google.com/codejam/contest/351101/dashboard#s=p1](https://code.google.com/codejam/contest/351101/dashboard#s=p1)？

我最终得到的代码如下，但它只能将字符串反转一个空格，因为它是记住文字逻辑的代码，反转整个字符串，反转单词，然后完成。空格有点混乱，当我尝试循环检测空格数并采取相应措施时，它失败了。请帮忙！代码：

```
#include <iostream>
#include <string>

using namespace std;

int main()
{

    char revwrd[100];
    char revstr[100];
    string str;
    getline(cin, str);
    cout<<str;
    int sps[10];

    int len,y=0;
    len = str.length();
    cout<<"\n"<<"The Length of the string is:"<<len;
    for(int x=len-1;x>-1;x--)
    {
        revstr[x] = str[y];
        y++;

    }
    cout<<"\n"<<"The inverse of the string is:"<<"\n";
    for(int z = 0;z<len;z++)
    {
        cout<<revstr[z];
    }
    cout<<"\n";

    int no=0;
    int spaces=0;
    for(int a=0;a<len;a++)
    {
        if(revstr[a]== ' ')
        {
            sps[no]=a;
            no++;
            spaces++;
        }
    }

    int rinc=0;
    int spinc;
    cout<<"\n";
    spinc=sps[0];

    int spinc2 = sps[0]+1;
    int lend;
    for(rinc=0;rinc<sps[0]+1;rinc++)
    {

        revwrd[rinc] = revstr[spinc];
        spinc--;
    }

    for(lend=len;lend>sps[0];lend--)
    {
        revwrd[spinc2] = revstr[lend];
        spinc2++;
    }
    cout<<"Spaces in the string:"<<spaces<<"\n";
    cout<<"The words inversed are:"<<"\n";
    for(int inc=1;inc<len+1;inc++)
    {
        cout<<revwrd[inc];
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-17T16:27:09.667

挑战的条件是单词之间只有一个空格，并且空格不会出现在行首或行尾，因此*对于这个特定的练习* ，您不必担心保留空格；只要您在每个单词之间用一个空格编写输出，就可以了。

考虑到这一点，您可以使用常规格式的输入读取每个单词：

```
std::string word;
...
while ( stream >> word )
  // do something with word 
```

您不必担心缓冲区大小，您不必担心检测空格等。您*不必*担心检测换行符，但这很容易使用以下`peek`方法完成：

```
while ( stream >> word )
{
  // do something with word;
  if ( stream.peek() == '\n' )
    break;
} 
```

上面的循环将从输入流中读取单个单词，`stream`直到它看到一个换行符（可能有更好的方法来做到这一点，但它有效）。

现在，为了反转输入的每一行，您显然需要在读取字符串时将它们存储在某处。最简单的做法是将它们存储到向量中：

```
std::vector< std::string > strings;
...
while ( stream >> word )
{
  strings.push_back( word );
  if ( stream.peek() == '\n' )
    break;
} 
```

所以现在你有一个包含行中所有字符串的向量，你只需要以相反的顺序打印出来。您可以使用*反向迭代器遍历*向量：

```
std::vector< std::string >::reverse_iterator it;
for ( it = strings.rbegin(); it != strings.rend(); ++it )
{
  std::cout << *it << " ";
}
std::cout << std::endl; 
```

该`rbegin()`方法返回一个指向向量中*最后一个*元素的迭代器；该`rend()`方法返回一个迭代器，该迭代器指向向量的第一个元素*之前的元素；*`++it`使迭代器前进以指向向量中的下一项，回到前面；并`*it`给出迭代器指向的字符串。您可以获得更深奥的知识并使用`copy`模板功能：

```
std::copy( strings.rbegin(), 
           strings.rend(), 
           std::ostream_iterator<std::string>( std::cout, " " )
         ); 
```

那个单一的方法调用替换了上面的循环。它创建了一个新`ostream_iterator`的，将字符串写入`cout`，由单个空格字符分隔。

对于这个特定练习的条件，这绰绰有余。如果您需要保留间距，或考虑标点符号或大写字母，那么您必须做一些较低级别的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-09T01:02:10.357

只有几个循环和if：

```
// Reverse Words 
#include <iostream>
#include <string>

using namespace std;

int main() {
    int tc; cin >> tc; cin.get();
    for(int t = 0; t < tc; t++) {
        string s, k; getline(cin, s);   
        for(int i = (s.length()- 1); i >= 0; i--) {
            if(s[i] == ' ' || (i == 0)) {
                    if(i == 0) k += ' ';
                for(int j = i; j < s.length(); j++) {
                    k += s[j];
                    if(s[j+1] == ' ' ) break;
                }
            } 
        }
        cout << "Case #" << t + 1 << " " << k << endl;
    }   

    return 0;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-10T15:47:11.990

这个问题真的是为了递归：

```
void reverse()
{
    string str;
    cin >> str;
    if (cin.peek() != '\n' || cin.eof()) {
        str = " " + str;
        reverse();
    }
    cout << str;
}

int main(int argc, const char * argv[])
{
    int count = 0;
    cin >> count;
    for (int i = 0; i < count; i++) {
        cout << "Case #" << (i + 1) << ": ";
        reverse();
        cout << endl;
    }
    return 0;
} 
```

所以我逐字阅读并在单词前面添加一个空格，直到到达行尾或文件结尾。一旦到达行尾，递归就会展开并以相反的顺序打印读取的字符串。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T12:52:46.723

这可能会处理多个空格：

```
std::string ReverseSentence(std::string in)
{
   std::vector<string> words;
   std::string temp = "";
   bool isSpace = false;
   for(int i=0; in.size(); i++)
   {
      if(in[i]!=' ')
      {
         if(isSpace)
         {
            words.push_back(temp);
            temp = "";
            isSpace = false;
         }
         temp+=in[i];
      }
      else
      {
         if(!isSpace)
         {
            words.push_back(temp);
            temp = "";
            isSpace = true;
         }
         temp +=  " ";
      }
   }
   std::reverse(words.begin(),words.end());
   std::string out = "";
   for(int i=0; i<words.size(); i++)
   {
      out+=words[i];
   }
 return out;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T12:56:14.690

你可以按照这个方法：

第 1 步：只需检查输入数组中的空格，将它们的索引号存储在整数数组中。

第 2 步：现在从末尾迭代这个整数数组

```
step a : make a string by copying characters from this index to previous index .
      note : since for first element there is no previous element in that case you will   copy   from this index to end of the input string .  

step b : step a will give you a word from end of input string now add these word with a space to make your output string . 
```

我希望这能帮到您 。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-05-27T15:43:11.870

我选择了蛮力，我非常想使用指针！

1.  得到句子
2.  检测每个单词并将它们放入容器中。
3.  向后阅读容器。

就是这个：

```
#include <iostream>
#include <string>
#include <vector>
int main()
{
char *s1 = new char[100];
std::cin.getline(s1, 100);

std::vector<std::string> container;
char* temp = new char[100];
char *p1, *p0;

p1 =p0 = s1;
int i;
do{
    if (*p1==' ' || *p1=='\0'){
        //std::cout<<p1-p0<<' ';
        for(i=0;i<p1-p0;++i) temp[i]=p0[i]; temp[i]='\0';
        p0 = p1+1;
        container.push_back(temp);
        std::cout<<temp;
    }
    p1++;
}while(*(p1-1)!='\0');

std::cout<<std::endl;
for(int i=container.size()-1;i>=0;i--) std::cout<<container[i]<<' ';

return 0;
} 
```

# matlab - MATLAB: Split values in column into 1 or 2 additional columns

> ID：16058995
> 
> 赞同：1
> 
> 时间：2013-04-17T11:37:55.380
> 
> 标签：matlab, split

I have a 312x2 matrix representing number of questions answered (column 2) by individual subjects (column 1) e.g.

```
x =

    40    56
    41    56
    42   176
    43   176
    44   116
    45    56
    46    56
    47   116
    48    56
    49    56
    50   116 
```

Some participants answered the questionnaire more than once, and I would like to divide their data into additional columns.

I.e. participant 43 completed it 3 times - 56 questions once, 60 questions twice.

Therefore, I'd like to split their data into 3 columns, to end up with:

```
x = 
    40    56
    41    56
    42    56    60    60
    43    56    60    60
    44    56    60
    ...etc 
```

I'll then fill in the gaps with NaN so i can work out the mean questions answered per questionnaire.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-17T12:04:05.380

这不是最优雅的解决方案，但它可以相对简单地完成工作：

```
x = [40 56;41 56;42 176;43 176;44 116;45 56;46 56;47 116;48 56;49 56;50 116];
a=x(:,2);
newData=[];
for i=1:size(a,1)
    if a(i)==56
        newData=vertcat(newData,[56 NaN NaN]);
    elseif a(i)==116
        newData=vertcat(newData,[56 60 NaN]);
    elseif a(i)==176
        newData=vertcat(newData,[56 60 60]);
    end
end
Data = horzcat(x(:,1),newData) 
```

命令窗口：

```
Data =

40    56   NaN   NaN
41    56   NaN   NaN
42    56    60    60
43    56    60    60
44    56    60   NaN
45    56   NaN   NaN
46    56   NaN   NaN
47    56    60   NaN
48    56   NaN   NaN
49    56   NaN   NaN
50    56    60   NaN 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-17T12:02:05.137

最好使用[元胞数组](http://www.mathworks.com/help/matlab/cell-arrays.html)来存储最终输出，因为每一行可能包含不同数量的元素。

这是一个简短的解决方案，可为您提供所需的结果：

```
C = mat2cell(x, ones(1, size(x, 1)), 2);
C(ismember(x(:, 1), cellfun(@(z)z(1), y))) = y; 
```

where`x`是问题中描述的原始数据数组，并且`y`是一个单元格数组，其中包含要替换的新行（如您所说的*split*） in `x`。

### 例子

这是一个类似于问题中给出的简短示例：

```
%// Generate sample data
x = [40 56; 41 56; 42 176; 43 176; 44 116; 45 56];
y = {[43 56 60 60]; [44 56 60]};

%// Replace rows in x with matching rows in y
C = mat2cell(x, ones(1, size(x, 1)), 2);
C(ismember(x(:, 1), cellfun(@(z)z(1), y))) = y; 
```

结果是一个新的元胞数组：

```
C =
    [40    56]
    [41    56]
    [42   176]
    [43    56    60    60]
    [44    56    60]
    [45    56] 
```

要计算每个问卷回答的平均问题，请使用`cellfun`遍历单元格：

```
m = cellfun(@(x)mean(x(2:end)), C) 
```

对于这个例子产生：

```
m =
   56.0000
   56.0000
  176.0000
   58.6667
   58.0000
   56.0000 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-17T12:12:13.200

当您分配超出当前矩阵范围的内容时，MATLAB 会自动为您展开矩阵：

```
>> a = [
    40    56
    41    56
    42   176
    43   176
    44   116
    45    56
    46    56
    47   116
    48    56
    49    56
    50   116];     
>> a(3,3) = 60
a =
    40    56     0
    41    56     0
    42   176    60
    43   176     0
    44   116     0
    45    56     0
    46    56     0
    47   116     0
    48    56     0
    49    56     0
    50   116     0 
```

默认操作是用零（而不是`NaN`s）填充。如果您可以合理地预期*永远不会*有任何参与者回答了 0 个问题，您可以这样做

```
>> a(a==0) = NaN;
>> M = nanmean(a(:,2:end),2); 
```

得到平均值。

如果你不能指望这一点（或者你没有/不想依赖统计工具箱来使用`nanmean`），那么你可以编写一些小函数来做你想做的事：

```
function new_a = addQsAnswered(old_a, QsAnswered)

    new_a = old_a;

    for ii = 1:size(QsAnswered,1)

        inds = (new_a(:,1) == QsAnswered(ii,1));

        if sum(isnan(new_a(inds,:))) < size(QsAnswered(:,2:end),2)
            new_a = [new_a NaN(size(new_a,1),1)]; %#ok            
        end

        new_a(inds,isnan(new_a(inds,:))) = QsAnswered(ii,2:end);        

    end

end

function M = getParticipantMeans(a)   
    M = zeros(size(a,1),1);    
    for ii = 1:size(a,1)
        as = a(ii,2:end);
        as = as(~isnan(as));
        M(ii) = sum(as)/numel(as);
    end    
end 
```

例子：

```
>> addQsAnswered(a, [46 78 90; 49 60 78])
ans =
        40    56   NaN   NaN
        41    56   NaN   NaN
        42   176    60   NaN
        43   176   NaN   NaN
        44   116   NaN   NaN
        45    56   NaN   NaN
        46    56    78    90
        47   116   NaN   NaN
        48    56   NaN   NaN
        49    56    60    78
        50   116   NaN   NaN

>> getParticipantMeans(new_a)
ans =
        5.600000000000000e+001
        5.600000000000000e+001
        1.180000000000000e+002
        1.760000000000000e+002
        1.160000000000000e+002
        5.600000000000000e+001
        7.466666666666667e+001
        1.160000000000000e+002
        5.600000000000000e+001
        6.466666666666667e+001
        1.160000000000000e+002 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T12:03:21.640

以下将实现您所需要的：

```
B = unique(A(:,1));
m = max(hist(A(:,1),B));
B = [B, nan(numel(B),m)];
for ii=1:size(B,1)
    jj = (A==B(ii,1));
    B(ii,2:end) = [A(jj(:,1),2)', nan(1,m-sum(sum(jj(:,1))))];
end 
```

对于输入：

```
A =

    53    83
    84    76
    52    99
    53    83
    76    90
    54    73
    91    72
    91    92
    86    54
    57    56 
```

结果将是：

```
B =

    52    99   NaN
    53    83    83
    54    73   NaN
    57    56   NaN
    76    90   NaN
    84    76   NaN
    86    54   NaN
    91    72    92 
```