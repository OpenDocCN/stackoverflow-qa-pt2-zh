# StackOverflow 问答 13476000-13476999

# sharepoint-2010 - IsNull 与 SharePoint 2010 的 CAML 查询中的其他参数

> ID：13476003
> 
> 赞同：2
> 
> 时间：2012-11-20T15:03:35.860
> 
> 标签：sharepoint-2010

考虑以下 CAML 查询：

```
<Query>
<Where>
    <And>
        <Eq>
            <FieldRef Name="Field1"/>
            <Value Type="Text">Field value 1</Value>
        </Eq>
        <Eq>
            <FieldRef Name="Field2"/>
            <Value Type="Text">Field value 2</Value>
        </Eq>
        <IsNull>
            <FieldRef Name="Field3"/>
        </IsNull>
    </And>
</Where> 
```

SharePoint 提出了一个`Microsoft.SharePoint.SoapServer.SoapServerException`. 这里有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:00:49.970

“And”元素只能有两个子元素。因此，例如，您的查询可以具有这种结构，其中“And”具有“IsNull”加上嵌套的“And”作为子元素。

```
<Query>
<Where>
     <And>
         <IsNull>
              <FieldRef Name="Field3" /></IsNull>
         <And>
              <Eq>
                    <FieldRef Name="Field1" /><Value Type="Counter">field 1 value</Value>
              </Eq>
              <Eq>
                    <FieldRef Name="Field2" /><Value type="Text">field 2 value</Value>
              </Eq>
         </And>
     </And>
</Where> 
```

这篇文章有一些很好的例子：http: [//msdn.microsoft.com/en-us/library/ms196939.aspx](http://msdn.microsoft.com/en-us/library/ms196939.aspx)

# php - JavaScript location.reload() 正在丢失帖子数据

> ID：13476006
> 
> 赞同：6
> 
> 时间：2012-11-20T15:03:47.483
> 
> 标签：php, javascript, joomla

我正在尝试使用java脚本重新加载页面页面重新加载但页面中的帖子数据未加载帖子数据被删除而页面重新加载任何人都可以帮助我

```
function currencychange(xxx) {
    setTimeout('delay()', 2000);
}
function delay(){
    location.reload();
} 
```

这是我用来重新加载页面 onchange 的 javascript 代码

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T15:07:46.430

`window.location.reload()`问题 a `GET`，所以是的，`POST`数据将丢失。

您可以发布帖子的唯一方法是：

1.  使用 AJAX 发回数据，获取新页面，并用它替换您的正文元素，或者

2.  在页面上创建一个表单元素，动作为 current `window.location.href`，然后将要发布的数据作为隐藏输入放入其中。然后，在货币兑换电话上`form.submit()`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-13T15:24:39.947

这是 Chrome 中的一个已知错误。问题是当您通过 JavaScript 重新加载时，Chrome 不会执行 POST。如果您使用重新加载按钮执行此操作，它将正常运行并询问用户是否要重新发布数据。

所有详细信息都在这里： [http](http://code.google.com/p/chromium/issues/detail?id=6429) ://code.google.com/p/chromium/issues/detail?id=6429 [编辑：相关错误] [https://bugs.webkit.org/show_bug.cgi?id=23735](https://bugs.webkit.org/show_bug.cgi?id=23735)

**请为这个错误加注星号，以便更快地修复它。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T15:07:45.697

我认为您需要重新发布而不是重新加载，如 HTTP POST 而不是 HTTP GET。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-05T20:55:54.790

这是一个完整的 hack，但有必要并允许它与 Safari 一起使用。所以在页面的最后我将所有的帖子数据推送到一个会话中

```
$_SESSION['post'] = $_POST 
```

然后我使用 jQuery 来更新会话变量。然后使用 location.reload(); 完成更改后重新加载页面，当页面加载时，我简单地将所有会话数据推回帖子中。

```
$_POST = £_SESSION['post']; 
```

结果与提交表单一样。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T15:08:07.400

`location.reload`不应该发布任何数据。如果您需要将数据发送回服务器，请考虑使用`method='post'`（如果有）提交表单，或使用 AJAX（例如[`jQuery.post`](http://api.jquery.com/jQuery.post/)）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-25T13:48:21.903

我以这种方式解决了这个问题：

```
// In the page called by POST, assuming coming from a search form 
// (i.e. searchResult.php)
$working=array();

if ($_POST) {
  if(!isset($_POST["postArray"]))  // Not set, first call
      $working = $_POST;
  else
     $working = unserialize($_POST["postArray"]); // recalled by someone else

  foreach ($working as $key => $value) { // Getting data
                $kv[] = "$key=$value";

// do something with input data....
           }

 echo '<form action="newRequest.php" method="post">'; 
// Your data here ......
 echo '<input type="hidden" name="currPost" value="' . htmlentities(serialize($working)) . '">';
 echo '<input type="submit" value="Go!">';
 echo '</form>';
 } // end if($_POST) ....

// This is the "newRequest.php" form
$postDataReceiver=array();
foreach ($_POST as $key => $value) { // Getting data from searchResult.php
           $kv[] = "$key=$value";

           switch($key) {
                // Your other stuff here ......
               case "currPost": // Here we are!
                    $postDataReceiver = unserialize($value);
                    break;

                 } // end switch
} // end foreach
echo '<form action="searchResult.php" method="post">'; 
// Your data here ......
 echo '<input type="hidden" name="postArray" value="' . htmlentities(serialize($postDataReceiver)) . '">';
 echo '<input type="submit" value="Go Back to search result!">';
 echo '</form>'; 
```

只是有点复杂，但它有效。希望这可以帮助！最好的，卢卡。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-24T16:29:17.740

你可以试试这个：

```
<form action="<?=$_SERVER['PHP_SELF']?>" method="post" name="form" id="form">

</form>

<script>
    // reload page every x miliseconds
    setInterval(function(){
    // inser here the post variables. Examples:

    var input = document.createElement('input');
    input.type = 'hidden';
    input.name = 'id';
    input.value = <?=$id?>;

    document.form.appendChild(input);

    var input2 = document.createElement('input');
    input2.type = 'hidden';
    input2.name = 'anotherid';
    input2.value = <?=$anotherid?>;

    document.form.appendChild(input2);

    // send form
    document.form.submit();
    }, 120000);
</script> 
```

# visual-studio-2012 - 是否在 Visual Studio 2012 Express 中删除了 Batch Build 选项？

> ID：13476010
> 
> 赞同：18
> 
> 时间：2012-11-20T15:04:02.660
> 
> 标签：visual-studio-2012, visual-studio-express

我最近刚从 Visual C++ 2010 Express 切换到 Visual Studio 2012 Express for Desktop。*由于我经常使用它，我很快发现自己在Build*菜单（或 Solution Explorer → <solution> 的右键菜单）下寻找*Batch Build...*选项。

 *在工作中，我有 Visual Studio 2012 Professional 和*Batch Build...*选项是它在 Visual Studio 2010 中的位置。

此功能是否已从 Express 版本中删除？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-27T14:51:47.893

事实证明*Batch Build...*功能仍然存在于 Visual Studio 2012 的 Express 版本中；它只是由于某种原因被隐藏了。

要访问它，您可以通过菜单*Tools* → *Options...* → *Environment* → *Keyboard*并找到*Build.BatchBuild*分配键盘快捷键，或者您可以将其添加到*Build*菜单和 Solution 上下文菜单中，它曾经是，通过*工具*→*自定义...* →*命令*。*Build*菜单位于名为*Build*的菜单栏下方，Solution 上下文菜单位于名为*Project 和 Solution Context Menus |的上下文菜单下方。解决方案*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-03T13:19:00.710

您还可以（Visual Studio 2013 Express）自定义菜单以获取命令（返回）： *[How to: Customize Menus and Toolbars in Visual Studio](https://docs.microsoft.com/en-us/visualstudio/ide/how-to-customize-menus-and-toolbars-in-visual-studio?view=vs-2015)*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T03:17:01.280

不，它没有被剪掉。我最近一直在使用它。

![Visual Studio 2012 批量构建](../Images/9f252c4467749f3ad4e2c4fe03a400b3.png)

但是，我至少有一个解决方案，其中 Batch Build 没有出现在菜单上（也没有出现在 Visual Studio 2010 中）。我的猜测是 Visual Studio 不喜欢该解决方案的某些内容，并且它禁用了批处理构建功能 - 但我从未深入了解它。

我想说，如果您真的需要该功能，请创建一个新解决方案并一个一个重新添加现有项目。*

# prolog - prolog中一组N维向量的最小支配向量

> ID：13476012
> 
> 赞同：0
> 
> 时间：2012-11-20T15:04:19.370
> 
> 标签：prolog

我需要编写一个程序，为一组 N 维向量构造一个最小支配向量。向量集合 S 的支配向量被定义为第 i 个分量大于或等于 S 中每个向量的第 i 个分量的向量，其中 i 分布在向量的所有维度上。维度 N 必须作为用户的输入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T09:49:58.433

串行实现：

```
fnt(M,N) :-
    fnt2(M,N,0,[]).

fnt2(_,N,N,Ds) :-
    reverse(Ds,R),
    write(R).
fnt2(M,N,K,Ds) :-
    column(M,K,Col),
    max_list(Col,H),
    K2 is K+1,
    fnt2(M,N,K2,[H|Ds]).

row(M, N, Row) :-
    nth(N, M, Row).

column(M, N, Col) :-
    transpose(M, MT),
    row(MT, N, Col).

symmetrical(M) :-
    transpose(M, M).

transpose([[]|_], []) :- !.
transpose([[I|Is]|Rs], [Col|MT]) :-
    first_column([[I|Is]|Rs], Col, [Is|NRs]),
    transpose([Is|NRs], MT).

first_column([], [], []).
first_column([[]|_], [], []).
first_column([[I|Is]|Rs], [I|Col], [Is|Rest]) :-
    first_column(Rs, Col, Rest).

nth(0,[X|_],X).
            nth(N,[_|T],R):- M is N-1,nth(M,T,R).

max_list([H], H).
max_list([H|T], M2) :- 
  max_list(T, M),
  M2 is max(H, M). 
```

并行实现（小调整）

```
fnt(M,N) :-
    fnt2(M,N,0,[]).

fnt2(_,N,N,Ds) :-
    reverse(Ds,R),
    write(R).
fnt2(M,N,K,Ds) :-
    column(M,K,Col),
    max_list(Col,H),
    K2 is K+1,
    fork(fnt2(M,N,K2,[H|Ds])).

row(M, N, Row) :-
    nth(N, M, Row).

column(M, N, Col) :-
    transpose(M, MT),
    row(MT, N, Col).

symmetrical(M) :-
    transpose(M, M).

transpose([[]|_], []) :- !.
transpose([[I|Is]|Rs], [Col|MT]) :-
    first_column([[I|Is]|Rs], Col, [Is|NRs]),
    transpose([Is|NRs], MT).

first_column([], [], []).
first_column([[]|_], [], []).
first_column([[I|Is]|Rs], [I|Col], [Is|Rest]) :-
    first_column(Rs, Col, Rest).

nth(0,[X|_],X).
            nth(N,[_|T],R):- M is N-1,nth(M,T,R).

max_list([H], H).
max_list([H|T], M2) :- 
  max_list(T, M),
  M2 is max(H, M).

reverse(A,R) :- reverse(A,[],R).
reverse([X|Y],Z,W) :- reverse(Y,[X|Z],W).
reverse([],X,X). 
```

测试：

```
time(fnt([[1,2,3,56],[14,5,6,43],[7,8,9,22]],4)). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:35:05.367

Prolog 没有向量。您可以使用列表或 arity N 的结构。当然，在第二种情况下，N 必须小于允许的最大 arity（SWI-Prolog 具有无限长度......）

如果您使用列表，则此代码应该可以。我假设 N 是从列表长度中隐含的。

```
'minimal dominating vector'([V|Vs], Min) :-
  'minimal dominating vector'(Vs, V, Min).

'minimal dominating vector'([], M, M).
'minimal dominating vector'([V|Vs], MinSoFar, Min) :-
   maplist(min, V, MinSoFar, Updated),
   'minimal dominating vector'(Vs, Updated, Min).

min(X, Y, M) :- X < Y -> M = X ; M = Y. 
```

测试：

```
?- 'minimal dominating vector'(["abc","aab","uaa"],M),format('~s',[M]).
aaa
M = [97, 97, 97]. 
```

如果您的 Prolog 没有 maplist/4（我不记得 P# 的这个细节），那么替换`maplist(min, V, MinSoFar, Updated),`为`minvect(V, MinSoFar, Updated),`，并添加这个定义

```
minvect([], [], []).
minvect([N|Ns], [M|Ms], [R|Rs]) :- min(N,M,R), !, minvect(Ns,Ms,Rs). 
```

**请注意，OT**一年前我尝试 P# 时，发现它非常慢，而且内存不足。如果你有大数组，那么你最好使用 LINQ

# apache - SEF 的 Apache 重写

> ID：13476016
> 
> 赞同：0
> 
> 时间：2012-11-20T15:04:42.257
> 
> 标签：apache, .htaccess, mod-rewrite

如何让 index.php 处理请求

例如

如果我在浏览器中输入 SEF

```
http://localhost/friends
http://localhost/me 
```

重写为

```
http://localhost/index.php/friends
http://localhost/index.php/me 
```

所以我可以从 $_REQUEST['PATH_lNFO'] 访问朋友或我

我已经修改并允许为 apache 中的根目录设置所有指令。

需要一个 .htaccess 文件，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:13:30.090

在这篇文章 [http://www.sitepoint.com/apache-mod_rewrite-examples/](http://www.sitepoint.com/apache-mod_rewrite-examples/) 中查看这个 RewriteRule ^/?([a-zA-Z_]+)/([a-zA-Z_]+)/([ a-zA-Z_]+)$ display.php?country=$1&state=$2&city=$3 [L]

```
AddDefaultCharset UTF-8
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /rtest
RewriteCond %{HTTP_HOST} ^mathpdq\.com
RewriteRule ^(.*)$ http://www.mathpdq.com/rtest/$1 [R=permanent,L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1 [L]
</IfModule> 
```

[http://mathpdq.com/rtest/fred](http://mathpdq.com/rtest/fred)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:36:01.383

```
RewriteRule ^friends$ index.php/friends [L]
RewriteRule ^me$ index.php/me [L] 
```

就这样。

`$_REQUEST['PATH_INFO']`将设置为“ `/friends`”或“ `/me`”。

（根据您的服务器配置`ORIG_PATH_INFO`，可能必须使用而不是`PATH_INFO`）

# c# - 如何知道前台窗口何时更改

> ID：13476021
> 
> 赞同：0
> 
> 时间：2012-11-20T15:04:54.990
> 
> 标签：c#, hook, setwindowshookex

我正在用 c# 编写一个应用程序，我需要知道地面窗口何时发生变化我使用了 SetWindowsHookEx，但是在窗口之间切换时我没有收到回调

我的代码：

```
private const int WH_CALLWNDPROC = 4;

private delegate IntPtr windowName(int nCode, IntPtr wParam, IntPtr lParam);
private static windowName _name = HookCallback;
private static IntPtr _hook = IntPtr.Zero;

public static void start()
{   
    _hook = SetHook(_name);
    Application.Run();
    UnhookWindowsHookEx(_hook);
}

private static IntPtr SetHook(windowName proc)
{
    using (Process curProcess = Process.GetCurrentProcess())
        using (ProcessModule curModule = curProcess.MainModule)
        {
            return SetWindowsHookEx(WH_CALLWNDPROC, proc, GetModuleHandle(curModule.ModuleName), 0);
        }
}

private static IntPtr HookCallback(int nCode, IntPtr wParam, IntPtr lParam)
{   
    browser = GetActiveWindow();
    Console.WriteLine(browser);
    return CallNextHookEx(_hook, nCode, wParam, lParam);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T11:09:02.673

好的，我有答案

```
 public static void start()
    {
        WinEventDelegate dele = new WinEventDelegate(WinEventProc);
        IntPtr m_hhook = SetWinEventHook(EVENT_SYSTEM_FOREGROUND, EVENT_SYSTEM_FOREGROUND, IntPtr.Zero, dele, 0, 0, WINEVENT_OUTOFCONTEXT);
        string window = GetActiveWindowTitle();
        Console.WriteLine(window);
        while (true)
        {
            if (window != GetActiveWindowTitle())
            {
                window = GetActiveWindowTitle();
                Console.WriteLine(window);
            }
        }
    }

    delegate void WinEventDelegate(IntPtr hWinEventHook, uint eventType, IntPtr hwnd, int idObject, int idChild, uint dwEventThread, uint dwmsEventTime);

    private static string GetActiveWindowTitle()
    {
        const int nChars = 256;
        IntPtr handle = IntPtr.Zero;
        StringBuilder Buff = new StringBuilder(nChars);
        handle = GetForegroundWindow();

        if (GetWindowText(handle, Buff, nChars) > 0)
        {
            return Buff.ToString();
        }
        return null;
    }

    public static void WinEventProc(IntPtr hWinEventHook, uint eventType, IntPtr hwnd, int idObject, int idChild, uint dwEventThread, uint dwmsEventTime)
    {
        Console.WriteLine(GetActiveWindowTitle());
    }

    #region imports
    [DllImport("user32.dll")]
    static extern IntPtr SetWinEventHook(uint eventMin, uint eventMax, IntPtr hmodWinEventProc, WinEventDelegate lpfnWinEventProc, uint idProcess, uint idThread, uint dwFlags);

    private const uint WINEVENT_OUTOFCONTEXT = 0;
    private const uint EVENT_SYSTEM_FOREGROUND = 3;

    [DllImport("user32.dll")]
    static extern IntPtr GetForegroundWindow();

    [DllImport("user32.dll")]
    static extern int GetWindowText(IntPtr hWnd, StringBuilder text, int count);
    #endregion 
```

它有点乱，但它有效

# python - 访问描述符实例

> ID：13476023
> 
> 赞同：0
> 
> 时间：2012-11-20T15:04:59.747
> 
> 标签：python, python-3.x

当一个定义描述符值检索等被覆盖时，使描述符的实例实际上不可访问。

即一个人不会写`instance_with_descriptor_attr.descriptor_attr.some_method_on_descriptor()`...不会工作。我的问题基本上是如何仍然可以访问描述符的实例......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-15T03:54:11.127

正如 eryksun 所指出的，Martijn 的解决方案适用于属性，但不适用于所有描述符：

```
class Desc(object):
    def __init__(self, val=None):
        self.val = val

    def __get__(self, obj, cls):
        return self.val

    def __set__(self, obj, val):
        self.val = val

class Test(object):
    x = Desc(5)

>>> o = Test()
>>> print o.x
5
>>> print Test.x
5 
```

它适用于属性描述符的原因可以在文档中的示例属性描述符实现中看到：http: [//docs.python.org/2/howto/descriptor.html#properties](http://docs.python.org/2/howto/descriptor.html#properties)

关键是`__get__`功能：

```
def __get__(self, obj, objtype=None):
    if obj is None:
        return self
    if self.fget is None:
        raise AttributeError, "unreadable attribute"
    return self.fget(obj) 
```

如果 obj 为 None 它返回 self，它是描述符本身的实例。obj 是访问描述符的类的实例。当您从类实例访问属性时，obj 是该实例，当您从类对象访问它时，obj 是 None。

将先前的描述符更改为：

```
class Desc(object):
    def __init__(self, val=None):
        self.val = val

    def __get__(self, obj, cls):
        if obj is None:
            return self
        return self.val

    def __set__(self, obj, val):
        self.val = val

class Test(object):
    x = Desc(5) 
```

产量（如果您使用的是 python shell，则必须重新定义类）

```
o = Test()
>>> print o.x
5
>>> print Test.x
<__main__.Desc object at 0x23205d0> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:08:45.443

你需要去上课本身：

```
type(instance_with_descriptor_attr).descriptor_attr 
```

示范：

```
>>> class Foo():
...     @property
...     def bar(self): return 'bar'
... 
>>> foo = Foo()
>>> foo.bar
'bar'
>>> type(foo).bar
<property object at 0x109f24310> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-10T17:39:39.650

如果`__get__`描述符的方法没有“ `return self`”语句，那么描述符只能通过`__dict__`类的属性访问：

```
class descriptor:
    def __get__(self, instance, owner=None):
        return 1

class A:
    d = descriptor()

a = A()
a.d # --> 1
A.d # --> 1
A.__dict__['d'] # --> <__main__.descriptor object at ...> 
```

# grid - 如何从分页工具栏获取当前页面

> ID：13476025
> 
> 赞同：0
> 
> 时间：2012-11-20T15:05:15.720
> 
> 标签：grid, paging, toolbar, extjs4.1, current-page

我在我的网格中使用 extjs 4.1 实现了一个分页工具栏，我得到了 20 组第一页记录。“但是”当我单击下一步时，它不会显示下一页。我想问题就在这里

```
proxy: {
            type: 'ajax',
            scope: this,
            url: 'Controller/getData',
            extraParams: {
                PageNumber: this.currentPage, // this doesn't change on clicking next
                PageSize: 20

            },
            reader: {
                type: 'json',
                root: 'myTable',
                totalProperty: 'count'
            } 
```

如您所见，我传递给我的控制器的 PageNumber 是静态的。如果我将它更改为我得到该页面的任何数字...那么我如何获取当前页面以便我可以将它传递给我的控制器..下面是我的工具栏

```
bbar: Ext.create('Ext.PagingToolbar', {
            scope: this,
            store: myStore,
            displayInfo: true,
            displayMsg: 'Displaying Records {0} - {1} of {2}',
            emptyMsg: "No Records to display"
        }) 
```

请帮助...谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T02:47:59.190

我不确定我是否可以帮助你，你检查过你的后端处理代码吗？我的意思是，据我所知，您声明存储和分页工具栏的方式是正确的，因此问题可能存在于服务器端。

作为参考，这是我的服务器端页面（remote/data/user/mahasiswa/read.php），用于处理带有分页支持的存储：

```
$sql = "SELECT * FROM user";
$rs = mysql_query($sql);
$totalCount = mysql_num_rows($rs);
$sql = $sql." LIMIT ".$start.",".$limit;
$rs = mysql_query($sql);
while($obj = mysql_fetch_object($rs)){
    $arr[] = $obj;
}
echo '{success:true, totalCount:'.$totalCount.', data:'.json_encode($arr).'}'; 
```

然后，这是我的商店：

```
Ext.define('PMK.store.user.Mahasiswa', {
extend: 'Ext.data.Store',
model: 'PMK.model.user.Mahasiswa',
pageSize: 30,

proxy: {
    type: 'ajax',
    url: 'remote/data/user/mahasiswa/read.php',
    reader: {
        type: 'json',
        root: 'data',
        successProperty: 'success',
        totalProperty: 'totalCount'
    }
}) 
```

最后这是我的观点：

```
Ext.define('PMK.view.user.mahasiswa.List' ,{
extend: 'Ext.panel.Panel',
alias : 'widget.mhslist',

title:'Manage Mahasiswa',
layout:'fit',

initComponent: function() {
    this.items = [
        {
            xtype:'grid',
            store:'user.Mahasiswa',
            columns: [
                {xtype: 'rownumberer', width: 50, sortable: false},
                {header: 'Angkatan', dataIndex: 'ANGKATAN', sortable:true, width:60},
                {header: 'NIM', dataIndex: 'NIM', sortable:true, width:100},
                {header: 'Nama', dataIndex: 'NAMA', sortable:true, width:225},
                {header: 'Program Studi', dataIndex: 'PRODI', sortable:true, width:225},
                {header: 'Kelas', dataIndex: 'KELAS', sortable:true, width:50},
                {header: 'Dosen PA', dataIndex: 'DOSEN_PA', sortable:true, width:125},
                {header: 'Jalur', dataIndex: 'JALUR', sortable:true, width:50},
                {header: 'Asal Sekolah', dataIndex: 'ASAL_SEKOLAH', sortable:true, width:175},
                {header: 'Tempat Lahir', dataIndex: 'TL', sortable:true, width:100},
                {header: 'Tanggal Lahir', dataIndex: 'TGL', sortable:true, width:75},
                {header: 'JK', dataIndex: 'JK', sortable:true, width:25},
                {header: 'Alamat', dataIndex: 'ALAMAT', sortable:true, width:225},
                {header: 'Email', dataIndex: 'EMAIL', sortable:true, width:130},
                {header: 'Telp', dataIndex: 'TELP', sortable:true, width:100},
                {header: 'Agama', dataIndex: 'AGAMA', sortable:true, width:50},
                {header: 'Input Date', dataIndex: 'INPUT_DATE', sortable:true, width:125},
                {header: 'Input By', dataIndex: 'INPUT_BY', sortable:true, width:125},
                {header: 'Edit Date', dataIndex: 'EDIT_DATE', sortable:true, width:125},
                {header: 'Edit By', dataIndex: 'EDIT_BY', sortable:true, width:125}
            ]
        }
    ];

    this.bbar = Ext.create('Ext.PagingToolbar', {
        store: 'user.Mahasiswa',
        displayInfo: true,
        displayMsg: 'Displaying mahasiswa {0} - {1} of {2}',
        emptyMsg: "No mahasiswa to display"
    });

    this.callParent(arguments);
}
}); 
```

# jboss - 如何自定义 JBoss AS7 404 页面

> ID：13476028
> 
> 赞同：9
> 
> 时间：2012-11-20T15:05:20.920
> 
> 标签：jboss, http-status-code-404

我已经在部署在 JBoss AS 7.1 中的 Web 应用程序中创建了一个自定义 404 页面。因此，如果我的应用程序位于 fubar dot com:8080/Myapp 并且我转到 fubar dot com:8080/Myapp/xyzzy，我会得到自定义错误页面（在 Web 应用程序的 web.xml 文件中定义）。

但是，当我转到 fubar dot com :8080/xyzzy 时，JBoss 显示默认的 404 页面，其中显示它是 JBoss 以及哪个 JBoss 版本。

我需要替换此页面以隐藏此信息。

请指教。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T22:57:13.823

如果您想为 JBoss 7 中的所有其他上下文自定义错误页面，这是您在 Myapp 应用程序中配置的一部分，您还将拥有：

*   禁用 JBoss 欢迎页面：在文件 Standalone/configuration/standalone.xml（或 domain/configuration/domain.xml）中，将属性 enable-welcome-root 设置为 false（默认为 true）
*   然后，您必须部署一个简单的war 文件，将其上下文根设置为“/”，并为该war 定义错误页面（使用与Myapp 相同的方法）。因此，war 结构应该类似于（error.war 名称是任意的）：

> ```
>  error.war
>     |
>     |- META-INF
>     |- WEB-INF
>     |     |    
>     |     |- web.xml
>     |     |- jboss-web.xml
>     |
>     |- error
>           |- 404.html 
> ```

web.xml 文件在哪里：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" id="WebApp_ID" version="2.5">
  <display-name>yourcompanyname</display-name>
  <error-page>
            <error-code>404</error-code>
            <location>/error/404.html</location>
  </error-page>
</web-app> 
```

在 jboss-web.xml 中将上下文根定义为“/”，所以它是：

```
<jboss-web>
    <context-root>/</context-root>
</jboss-web> 
```

文件 404.html 是 Jboss 将显示的自定义 html 错误页面，而不是 404 默认错误。就是这样，在 JBoss 7 中部署这个应用程序，当您访问 fubar dot com:8080/yzyqqa 或任何其他根上下文时，您将拥有自定义的 404 错误页面。请记住，您还必须将错误配置保留在 Myapp web.xml 中（以及在所有其他应用程序中，您可能会在服务器中部署）。

顺便说一句，您是否考虑过让您的应用 Myapp 可以直接从*fubar dot com:8080*访问？或者更好的是，让 jboss 服务器只能从代理（例如 Apache）访问？这样你也可以避免这个问题。

我希望它有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T20:43:36.237

`web.xml`您的问题：您在中定义了自定义错误页面`Myapp`。现在，如果您使用 root as 访问任何资源`Myapp`并且请求抛出 a`404`它会返回自定义错误页面。

现在，如果您访问任何其他 root ，`xxyzzzz`您希望在此处返回自定义错误页面。

现在从逻辑上讲，如果您为其他项目配置了一个文件，您不能期望它与其他项目相同

除非

1.  要么你为其他项目配置相同的东西，即`xxxyzzz`。即将 404 配置也放入其中`web.xml`。

2.  或者你需要在服务器范围内做一些事情。

如果项目数量较少并且您不希望 URL 与任何项目都不匹配，则第一种解决方案相当简单易行。

如果您想使用第一种解决方案，您知道该怎么做

关于第二种方法。我可以找到一些对你有帮助的帖子

参考这些

使用 jboss as7，全局 web.xml 的自定义消失了。我只能找到一种配置全局 404 错误页面的方法。参考这里。它的工作原理：D

[JBoss AS7 的 Apache 中的自定义错误页面](http://middlewaremagic.com/jboss/?p=1334)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T20:19:17.523

我相信您将不得不创建自己的页面。JBoss 使用 Tomcat 来处理 Web 请求。

在 Tomcat 中，定义您自己的 404 响应页面的方式是在您的 web.xml 中包含以下代码段（参考 - [http://wiki.apache.org/tomcat/FAQ/Miscellaneous#Q6](http://wiki.apache.org/tomcat/FAQ/Miscellaneous#Q6)）

```
 <error-page>
        <error-code>404</error-code>
        <location>/error/404.html</location>
    </error-page> 
```

[mykong @ http://www.mkyong.com/struts/how-to-handle-404-error-in-struts/](http://www.mkyong.com/struts/how-to-handle-404-error-in-struts/)创建了有关如何使用 struts 执行此操作的详细页面。

如果您使用的是除 struts 之外的任何其他框架，您应该有一个等效的框架。

# mysql - 多表选择与 JOIN（性能）

> ID：13476029
> 
> 赞同：60
> 
> 时间：2012-11-20T15:05:34.007
> 
> 标签：mysql

从 MySQL 中的多个表中进行选择时，以下两个查询都返回相同的结果集。

这些查询中的一个是否比另一个*更好*或更有效？从我对一个小数据集（每个表中约 2k 行）的测试来看，它们都在大约相同的执行时间内返回相同的结果集。

**查询一：**

```
SELECT
    *
FROM
    products,
    product_meta,
    sales_rights
WHERE 
    (
        products.id = product_meta.product_id
        AND products.id = sales_rights.product_id
    )
    AND (...)
LIMIT 0,10; 
```

**查询 2：**

```
SELECT
    *
FROM
    products
INNER JOIN product_meta ON products.id = product_meta.product_id
JOIN sales_rights ON product_meta.product_id = sales_rights.product_id 
WHERE
    (...)
LIMIT 0,10; 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-11-20T15:06:33.187

它们是相同的，但语法不同。所以你不应该期望这两种语法之间有任何性能差异。但是，建议使用最后一种语法（ANS SQL-92 语法），有关详细信息，请参阅这些：

*   [**要改掉的坏习惯：使用老式的 JOIN。**](https://sqlblog.org/2009/10/08/bad-habits-to-kick-using-old-style-joins)
*   [**SQL JOIN：USING、ON 或 WHERE 之间有区别吗？**](https://stackoverflow.com/questions/5654278/sql-join-is-there-a-difference-between-using-on-or-where/5654338#5654338)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T15:09:26.363

我认为[这个线程](https://stackoverflow.com/questions/1018822/inner-join-on-vs-where-clause)给出了一个很好的解释。

> INNER JOIN 是您应该使用的 ANSI 语法。
> 
> 它通常被认为更具可读性，尤其是当您连接大量表时。
> 
> 每当需要时，它也可以很容易地用 OUTER JOIN 替换。
> 
> WHERE 语法更面向关系模型。
> 
> 两个表 JOIN'ed 的结果是应用过滤器的表的笛卡尔积，该过滤器仅选择与连接列匹配的那些行。
> 
> 使用 WHERE 语法更容易看到这一点。
> 
> 至于您的示例，在 MySQL 中（通常在 SQL 中），这两个查询是同义词。
> 
> 另请注意，MySQL 也有一个 STRAIGHT_JOIN 子句。
> 
> 使用此子句，您可以控制 JOIN 顺序：在外循环中扫描哪个表，在内循环中扫描哪个表。
> 
> 你不能在 MySQL 中使用 WHERE 语法来控制它。

# android - 尝试初始化 monoAndroidPackage 时出错

> ID：13476031
> 
> 赞同：3
> 
> 时间：2012-11-20T15:05:34.720
> 
> 标签：android, visual-studio-2010, visual-studio, xamarin.android

我是 android 单声道的新手。我正在我的电脑上下载并安装**mono-android-4.2.7.15330979**。当我启动我的 Visual Studio 2010 时，我得到了这个错误。

以下是有关错误的详细信息：

```
There was an error attempting to initialize the MonoAndroidPackage 
System.ArgumentNullException: Vale cannot be null.
Parameter name: path1
         At System.IO.Path.Combine(String path1,String path2)
         At Xamarin.AndroidTools.AndroidSdk.get.AdbExe()
         At Mono.Android.VisualStudio.MonoAndrioidDeviceManager.ctor()
         At Mono.Android.VisualStudio.MonoAndrioidSdk.get_DeviceManager()
         At Mono.Android.VisualStudio. MonoAndrioidPackage.Initialize() 
```

当我尝试创建一个项目时，会出现以下错误

```
 This project file 
 ‘Project Path’ cannot be opened
 The project type is not supported by this installation 
```

我也在安装

```
 Java at "C:\Program Files\Java\jdk1.7.0_02"
  Set environment variable JAVA_HOME="C:\Program Files\Java\jdk1.7.0_02"
  Android SDK at "C:\Program Files (x86)\Android\android-sdk" 
```

我在用 ：

```
Windows7 64 bit
Visual Studio 2010 ultimate 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T02:54:52.613

听起来您需要在 Visual Studio 下的 Mono for Android/Xamarin.Android 设置中更新 Android SDK 的位置（TOOLS -> OPTIONS -> Xamarin.Android）

确保路径正确，因为在将路径组合到 adb.exe 文件时会引发异常。

![适用于 Android 的 Mono 设置](../Images/983febbc0050b6b054fe3ad338fadbbd.png)

**更新**

这种情况下的问题是没有安装平台工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T20:58:24.630

这是另一个对我有用的解决方案。

开始 -> 运行 -> 注册表编辑器

HKLM -> 软件 -> Novell -> Mono for Android

检查 AndroidSdkDirectory 是否正确。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-27T13:39:21.890

this is problem is simple ,,, you should open MonoDelop ,and to set option these JDK and ADM install directory, exit MonoDelop, reopen your visual studio 2010 .

# python - Matplotlib 粗动画，显示痕迹

> ID：13476032
> 
> 赞同：1
> 
> 时间：2012-11-20T15:05:36.920
> 
> 标签：python, matplotlib, plot, particles

我刚刚开始一个小型粒子模拟器，我希望扩展它以解决一些物理问题，但我在尝试为它们设置动画时遇到了问题。基本上取决于您选择哪种随机分布，粒子将在给定长度的区域中“振荡”。我想在前面的 10 个步骤中展示粒子的“历史”。

这是代码

```
from numpy import *
import matplotlib.pyplot as plt
import pylab
import time

pylab.ion()

N = 10
r = random.randint(-100,100,2*N).reshape(N,2)
line, = plt.plot(r[:,0], r[:,1],'o')

for i in range(100000):
  newdatax = r[:,0] + random.rand(N)
  newdatay = r[:,1] + random.rand(N)
  line.set_ydata(newdatay)
  line.set_xdata(newdatax)
  plt.title("At timestep: %d" %i)
  plt.hold(True)
  plt.draw()
  time.sleep(1.0/30) 
```

我想要的是行更新不会在每次迭代时清除画布并重绘，我只是希望它这样做，例如，每 10 帧（迭代），这将使我更容易在视觉上跟踪粒子。

我还想实现另一件事，但并非绝对必要，是否可以在每个“o”周围绘制一个框（正方形）或一个圆形或一个三角形？这样该点以该框/圆/三角形为中心？这将再次使跟踪粒子变得更加容易。如果我可以指定哪个“o”（点）获得此属性（正方形），那就更好了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:59:19.107

试试这个[`animation`模块](http://matplotlib.org/api/animation_api.html)。另请参阅这个很棒的[教程](http://jakevdp.github.com/blog/2012/08/18/matplotlib-animation-tutorial/)，[Matplotlib 对图像进行动画处理（主要是我对](https://stackoverflow.com/questions/12666990/matplotlib-animate-over-an-image/12676593#12676593)[Animate drawing networkx edges](https://stackoverflow.com/questions/13223191/animate-drawing-networkx-edges/13225651#13225651)的回答的副本和过去）

要获得所需的时间延迟，您需要设置一个历史数据结构，例如：

```
from matplotlib import animation

fig = figure()
N = 10
r = random.randint(-100,100,2*N).reshape(N,2)
line, = plt.plot(r[:,0], r[:,1],'o')

lag_len = 10
history_x = np.zeros((N,lag_len))
history_y = np.zeros((N,lag_len))
trails = [plot(hx,hy)[0] for hx,hy in zip(history_x,history_y)]

def update_frame(i):
    frame_num = i
    newdatax = r[:,0] + random.rand(N)
    newdatay = r[:,1] + random.rand(N)
    line.set_ydata(newdatay)
    line.set_xdata(newdatax)
    history_x[:,frame_num%lag_len] = newdatax
    history_y[:,frame_num%lag_len] = newdatay
    for hx,hy,ln_h in zip(history_x,history_y,trails):
         ln_h.set_xdata(hx)
         ln_h.set_ydata(hy)

    plt.title("At timestep: %d" %i)
    plt.hold(True)
    return (line,) + tuple(trails)

anim = animation.FuncAnimation(fig, update_frame, 
                           frames=100, interval=20) 
```

至于盒子，使用 [Rectangle](http://matplotlib.org/api/artist_api.html#matplotlib.patches.Rectangle)（[在 pylab 模式下绘制矩形（add_patch）](https://stackoverflow.com/questions/10665163/draw-rectangle-add-patch-in-pylab-mode)），以及传递给的可选参数`FuncAnimation`。

这并不完美，它有一些奇怪的细节循环回到它自己（一个循环中的第 50 帧与下一次经过的第 50 帧不同），前 10 帧有一个瞬态，当有历史中的一堆零（您可以通过将历史数组初始化为初始点的 10 个副本来解决此问题）

# php - Monolog FingersCrossedHandler

> ID：13476038
> 
> 赞同：7
> 
> 时间：2012-11-20T15:05:51.673
> 
> 标签：php, monolog

我正在研究在我正在开发的应用程序中使用独白，但我不确定是否能够使用 FingersCrosedHandler 实现我需要的功能。

如果添加了 ERROR 或更高级别的消息，我只想记录 DEBUG 级别的消息，但是我希望在日志中查看 INFO 消息。

我努力了：

```
$applicationLog = new Monolog\Logger('App');
$streamHandler = new Monolog\Handler\StreamHandler(LOG_FILE, Monolog\Logger::DEBUG, false);
$fingersCrossedHandler = new Monolog\Handler\FingersCrossedHandler($streamHandler, Monolog\Logger::INFO, 0 , false);
$applicationLog->pushHandler($fingersCrossedHandler);
$applicationLog->addDebug('debug');
$applicationLog->addInfo('info'); 
```

但这会将调试和信息级别消息添加到日志中。

这是否可以使用 FingersCrossedHandler 来实现，还是我需要自己创建？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2018-03-10T06:36:07.520

这在`1.11.0`Monolog 的版本中有所改变。现在有一个可选的第 6 个参数，`$passThruLevel`. 此参数是应始终刷新的最低级别日志。在您的情况下，您应该按以下方式设置 FingersCrossed：

```
use Monolog\Handler\FingersCrossedHandler;

$fingersCrossedHandler = new FingersCrossedHandler(
    $streamHandler,
    Monolog\Logger::ERROR,
    0,
    true,
    true,
    Monolog\Logger::INFO
); 
```

这将导致`INFO`始终记录或更高级别的消息，但仅当已记录级别或更高级别`DEBUG`的消息时才会显示消息。`ERROR`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T19:28:24.877

这对于 FingersCrossedHandler 本身是不可能的。不过，您可以轻松扩展它并覆盖 handle() ，以便它仅缓冲调试消息并让其余消息始终通过。问题是，如果您这样做，则在发生错误时消息会乱序，除非您缓冲所有内容，最后刷新所有内容，如果没有发生错误则进行调试。

# javascript - 从不同页面访问打开的窗口

> ID：13476043
> 
> 赞同：2
> 
> 时间：2012-11-20T15:06:11.160
> 
> 标签：javascript, dom

是否可以存储使用打开的窗口`window.open()`并从其他页面访问它？

这是我打开窗口的方式：

```
win = window.open("jmap.php?id="+id); 
```

当父页面被导航（访问网站的其他页面）时，我想调用之前打开的窗口的函数：

```
win.zoomToPlainte(id) 
```

如何`win`跨页面保存变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:10:24.320

**只要两个窗口在同一个域中**，这是可能的。

您需要保存对打开的窗口对象的引用，就像您正在使用的那样：

```
var win = window.open("jmap.php?id="+id); 
```

Window 对象有一个`document`属性可以让你像这样访问它的 DOM：

```
win.document.getElementById(...); 
```

或者您可以通过使用窗口对象调用全局函数/变量：

```
win.someGlobalFunction(); 
```

要从子窗口返回到打开它的窗口对象，请使用`window.opener`返回窗口对象的属性：

```
window.opener.document.getElementById(...);
window.opener.someGlobalFunction(); 
```

# asp.net-mvc - DTO 的属性等于实体的属性

> ID：13476048
> 
> 赞同：2
> 
> 时间：2012-11-20T15:06:29.477
> 
> 标签：asp.net-mvc, entity-framework

在我的项目中，我有一个服务层，它从控制器接收对象，将其转换为 DTO 并将其发送到存储库。我猜的问题是，对于我项目中的每个实体类，我都需要一个具有完全相同实体属性的 DTO。让我展示一些代码：

```
public class PersonDto
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public int Age { get; set; }
    };

    public class Person
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public int Age { get; set; }
    };

    public class PersonController : Controller
    {
        public ActionResult Create(CreatePersonViewModel createPersonViewModel)
        {
            var personDto = //here I map createPersonViewModel to a PersonDto
            _personCreateService.Create(personDto);
        }
    }

    public class PersonCreateService
    {
        public void Create(PersonDto personDto)
        {
            _repository.Create(personDto);
        }
    }

    public class PersonRepository
    {
        public void Create(PersonDto personDto)
        {
            Person person = PersonMapper.Map(personDto);

            _db.Person.Add(person);
        }
    } 
```

所以，我对此有一些疑问：

1.  它是一个好的架构吗？
2.  我应该将 dto 映射到服务中的实体还是仅在存储库中？
3.  让我的 dto 等于我的实体有什么问题吗？
4.  正如许多教程所教的那样，我不直接在我的控制器中使用 dbContext 是不是很愚蠢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:45:09.947

我将尝试回答一些问题。

1 - 它是一个好的架构吗？

也许。如果您正在使用诸如 NHibernate、Entity Framework 之类的 ORM 工具，您必须认为您无法从 ORM 工具共享您的瞬态对象，因为有时您有一个代理，而不是具体类型。我不喜欢直接从 ORM 工具将对象发送到视图。我更喜欢使用 viewModel 或 DTO。

2 - 我应该将 dto 映射到服务中的实体还是仅在存储库中？

也许，服务应该返回`ViewModel`，因为这是 View 需要的，但有时您需要直接在 上指定结果`Query`并从`Repository`.

3 - 让我的 dto 等于我的实体有什么问题吗？

不，有时您可以拥有具有 50 个属性的实体，并且您需要在仅具有 5 或 6 个属性的视图上显示网格，因此，您必须创建具有这 5 或 6 个属性的 ViewModel 并将您的实体转换为 ViewModel 类型.

有一个名为[AutoMapper](http://automapper.org/)的好工具，可以帮助您映射对象。你应该考虑使用它。

Jimmy Bogard 使用 Asp.Net MVC 和 AutoMapper 实现了一个很好的实现，它讲述了如何使用 ViewModel 清理帖子并使用 asp.net mvc 采用面向对象编程的最佳实践。

[http://lostechies.com/jimmybogard/2011/06/22/cleaning-up-posts-in-asp-net-mvc/](http://lostechies.com/jimmybogard/2011/06/22/cleaning-up-posts-in-asp-net-mvc/)

# asp.net-mvc-3 - MVC3 Razor - 在控制器和视图中使用 viewbag

> ID：13476049
> 
> 赞同：2
> 
> 时间：2012-11-20T15:06:31.130
> 
> 标签：asp.net-mvc-3, viewbag

我正在尝试根据控制器中的 if/else 条件为我的 viewbag 创建动态属性。viewbag 显示的内容取决于我在控制器中的逻辑。在我看来，我尝试用剃刀语法调用我的视图包，但页面上没有任何内容。

```
[HttpPost]
        public ActionResult EditUser(vw_UserManager_Model edituser)
        {
            UserManager.Models.vw_UserManager_Model model = edituser; 
            int outcome = 0;
                outcome = UserManager.DAL.EditUser(model);
                if (outcome == 1)
                {
                    ViewBag.Message = "Successfully edited user" + model.UserName;
                    ViewBag.Description = "Look below for full details.";
                    //ViewData["Message"] = "Successfully edited user" + model.UserName;
                    return RedirectToAction("showSuccess", model);
                }
                else
                {
                    ViewBag.Message = "Failure";
                    return RedirectToAction("showFailure", model);
                }
        }

#region successErrorHandling
        public ActionResult showError(List<string> ErrorMessage)
        {
            ViewBag.ErrorMessage = ErrorMessage[0];
            return View("ErrorMessageView");
        }

        public ActionResult showSuccess(vw_UserManager_Model model)
        {

            return View("SuccessMessageeView", model);
        } 
```

我为 viewbag、message 和 description 设置了两个属性。如果成功或失败，我会进行重定向。

```
@model UserManager.Models.vw_UserManager_Model
<h2>@ViewBag.Message</h2>
<br />
<h4>@ViewBag.Description</h4>
<h2>
    SuccessMessageeView</h2>
<br />
User Created:
@using (Html.BeginForm())
{
    <ul>
        <li> <b>@Html.Label("Username:  ")</b>@Model.UserName</li>
        <li> <b>@Html.Label("Salutation:  ")</b>@Model.salutation</li>
        <li> <b>@Html.Label("Firstname:  ")</b>@Model.firstname</li>
        <li>  <b>@Html.Label("Lastname:  ")</b>@Model.lastname</li>
        <li> <b>@Html.Label("Email:  ")</b>@Model.email</li>
        <li> <b>@Html.Label("Group name:  ")</b>@Model.group_name</li>
        <li> <b>@Html.Label("Is active:  ")</b>@Model.isactive</li>
    </ul>
} 
```

在我看来，然后我调用我的 viewbag，但它不会渲染。我做错了吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T17:35:42.637

正如 Hari 提到的，因为您正在重定向，所以您会丢失 viewbag 数据。如果要在请求之间保留数据，请[改用 TempData](http://msdn.microsoft.com/en-us/library/system.web.mvc.tempdatadictionary%28v=vs.108%29.aspx)。[该博客](http://blogs.teamb.com/craigstuntz/2009/01/23/37947/)描述了 TempData 的用途。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:30:24.727

如果 ViewBag 可以放在视图模型中，请不要使用它。Viewbag 应该只用于与他一起工作在同一页面上的视图。

# c# - Marshal.StructureToPtr 在模块 ntdll.dll 中失败

> ID：13476055
> 
> 赞同：2
> 
> 时间：2012-11-20T15:06:45.433
> 
> 标签：c#, marshalling, unmanaged

我将从**一些历史**开始：我目前面临的问题突然出现，没有对代码进行任何更改。然后3天后以同样的方式消失。现在它一周后又回来了，不想离开=）。

我有**与打印机一起使用的代码**- 设置它的打印机首选项以指定方式打印文档。我使用指向网络打印机的 TCP 地址的本地打印机（这是我所知道的此类任务的常用方法）。

下面是**我用来从二进制文件加载打印机配置的代码**（以前以类似的方式保存）。我给所有源代码都声明了非托管函数调用，因为不知道是什么导致了这个问题。正在阻止我的应用程序（Windows 服务）的行：

```
Marshal.StructureToPtr(pInfo, pPInfo, true); //THIS LINE FAILS 
```

这是一个函数的完整代码：

```
public static bool LoadSettings(string printerName, string filepath)
{
    Logger.GetLog().WriteInformation(string.Format("Loading printer settings '{0}' for printer '{1}'", filepath, printerName), "PrinterSettingsStorage.LoadSettings()");
    bool success = false;
    try
    {
        if (!File.Exists(filepath))
        {
            return false;
        }

        IntPtr hPrinter;
        int bytes = 0;
        IntPtr pPInfo;
        IntPtr pDevMode;
        PRINTER_INFO_2 pInfo = new PRINTER_INFO_2();

        PRINTER_DEFAULTS PrinterValues = new PRINTER_DEFAULTS();
        PrinterValues.pDatatype = 0;
        PrinterValues.pDevMode = 0;
        PrinterValues.DesiredAccess = PRINTER_ALL_ACCESS;

        //retrieve the devmode from file
        using (FileStream fs = new FileStream(filepath, FileMode.Open))
        {
            int length = Convert.ToInt32(fs.Length);
            pDevMode = GlobalAlloc(0, length);
            for (int i = 0; i < length; i++)
            {
                Marshal.WriteByte(pDevMode, i, (byte)fs.ReadByte());
            }
        }

        //get printer handle
        OpenPrinter(printerName, out hPrinter, ref PrinterValues);

        //get bytes for printer info structure and allocate memory
        GetPrinter(hPrinter, 2, IntPtr.Zero, 0, out bytes);
        if (bytes == 0)
        {
            throw new Exception("Get Printer Failed");
        }
        pPInfo = GlobalAlloc(0, bytes);

        //set pointer to printer info
        GetPrinter(hPrinter, 2, pPInfo, bytes, out bytes);

        //place the printer info structure
        pInfo = (PRINTER_INFO_2)Marshal.PtrToStructure(pPInfo, typeof(PRINTER_INFO_2));

        //insert the new devmode
        pInfo.pDevMode = pDevMode;
        pInfo.pSecurityDescriptor = IntPtr.Zero;

        //set pointer to new printer info
        Marshal.StructureToPtr(pInfo, pPInfo, true); //THIS LINE FAILS

        //update
        SetPrinter(hPrinter, 2, pPInfo, 0);

        //free resources
        GlobalFree(pPInfo);
        GlobalFree(pDevMode);
        ClosePrinter(hPrinter);

        success = true;
    }
    catch (COMException ce)
    {
        Logger.GetLog().WriteError(string.Format("COM error loading printer settings to printer: {0}", Marshal.GetLastWin32Error()), ce.StackTrace, "PrinterSettingsStorage.LoadSettings()");
    }
    catch (Exception e)
    {
        Logger.GetLog().WriteError(string.Format("Unknown error loading printer settings to printer"), e.StackTrace, "PrinterSettingsStorage.LoadSettings()");
    }
    finally
    {
        Logger.GetLog().WriteInformation(string.Format("Finish loading printer settings '{0}' for printer '{1}'. Success: {2}", printerName, filepath, success), "PrinterSettingsStorage.LoadSettings()");
    }
    return success;
}

[StructLayout(LayoutKind.Sequential)]
internal struct PRINTER_DEFAULTS
{
    public int pDatatype;
    public int pDevMode;
    public int DesiredAccess;
}

[StructLayout(LayoutKind.Sequential)]
internal struct PRINTER_INFO_2
{
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pServerName;
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pPrinterName;
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pShareName;
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pPortName;
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pDriverName;
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pComment;
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pLocation;
    public IntPtr pDevMode;
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pSepFile;
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pPrintProcessor;
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pDatatype;
    [MarshalAs(UnmanagedType.LPStr)]
    public readonly string pParameters;
    public IntPtr pSecurityDescriptor;
    public readonly Int32 Attributes;
    public readonly Int32 Priority;
    public readonly Int32 DefaultPriority;
    public readonly Int32 StartTime;
    public readonly Int32 UntilTime;
    public readonly Int32 Status;
    public readonly Int32 cJobs;
    public readonly Int32 AveragePPM;
}

[DllImport("kernel32.dll", ExactSpelling = true)]
private static extern IntPtr GlobalFree(IntPtr handle);

[DllImport("winspool.Drv", EntryPoint = "GetPrinterA", SetLastError = true,
    CharSet = CharSet.Ansi, ExactSpelling = true,
    CallingConvention = CallingConvention.StdCall)]
private static extern bool GetPrinter(IntPtr hPrinter, Int32 dwLevel,
                                        IntPtr pPrinter, Int32 dwBuf, out Int32 dwNeeded);

[DllImport("winspool.Drv", EntryPoint = "OpenPrinterA",
    SetLastError = true, CharSet = CharSet.Ansi,
    ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
private static extern bool
    OpenPrinter([MarshalAs(UnmanagedType.LPStr)] string szPrinter,
                out IntPtr hPrinter, ref PRINTER_DEFAULTS pd);

[DllImport("winspool.drv", CharSet = CharSet.Ansi, SetLastError = true)]
private static extern bool SetPrinter(IntPtr hPrinter, int Level, IntPtr pPrinter, int Command);

[DllImport("winspool.Drv", EntryPoint = "ClosePrinter", SetLastError = true,
    ExactSpelling = true, CallingConvention = CallingConvention.StdCall)]
private static extern bool ClosePrinter(IntPtr hPrinter); 
```

**症状：**

*   服务只是立即停止在引用的行退出。没有 finally 块执行，没有捕获到异常。

*   *Windows 事件日志包含错误*

    错误模块名称：ntdll.dll，版本：6.1.7601.17725，时间戳：0x4ec49b8f 异常代码：0xc0000374 错误偏移量：0x000ce6c3 错误进程 id：0x12dc 错误应用程序启动时间：0x01cdc71b9bf9b661 错误应用程序路径：C:\Program Files (x86)\ MyServiceExePath.exe 错误模块路径：C:\Windows\SysWOW64\ntdll.dll 报告 ID：0eb45111-330f-11e2-be8e-005056975a30

我的操作系统：Windows Server 2008 R2。

正如我所说，它会在一段时间内不断复制，然后在没有任何代码更改的情况下消失。我不知道是什么导致了这个问题，为什么它如此不稳定。希望这里有人比我更熟悉非托管代码=）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-12-03T20:43:00.380

```
 //insert the new devmode
        pInfo.pDevMode = pDevMode;
        pInfo.pSecurityDescriptor = IntPtr.Zero;

        //Add by me
        Marshal.StructureToPtr(pInfo, pPInfo, false);
        //set pointer to new printer info 
        Marshal.StructureToPtr(pInfo, pPInfo, true);

        //update
        SetPrinter(hPrinter, 2, pPInfo, 0);
        //Add by me
        Marshal.DestroyStructure(pPInfo, typeof(PRINTER_INFO_2));

        //free resources
        GlobalFree(pPInfo);
        GlobalFree(pDevMode);
        ClosePrinter(hPrinter); 
```

# sql - CLI 标准的 Oracle 实现是什么？

> ID：13476056
> 
> 赞同：-2
> 
> 时间：2012-11-20T15:06:45.283
> 
> 标签：sql, oracle, clr

众所周知，[CLR](http://en.wikipedia.org/wiki/Common_Language_Runtime)是微软对[CLI 标准](http://www.ecma-international.org/publications/standards/Ecma-335.htm)的实现。但是 Oracle 甚至 Postgre 呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:08:30.653

Oracle 或 PostgreSQL 没有实现。据我所知，除了 Microsoft 的实现之外，目前只有一种实现：[Mono](http://www.mono-project.com/Main_Page)。

我实际上不明白为什么您认为 Oracle 和 PostgreSQL 可以拥有一个。这些公司创建数据库。CLI 标准与数据库没有任何关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:08:39.550

> 但是 Oracle 甚至 Postgre 呢？

据我所知，没有。最接近 Oracle 的是 Java（无论如何它都不是 CLI 实现，但 CLI 和 Java 至少是相似的）。至于“Postgre”，我假设你的意思是 PostgreSQL——你为什么*希望*他们有一个实现？

您知道 CLI 实际上是一种 VM 规范，*而不是*数据库，对吧？

# php - 使用正则表达式验证 Youtube URL

> ID：13476060
> 
> 赞同：18
> 
> 时间：2012-11-20T15:06:52.593
> 
> 标签：php, regex, youtube

我正在尝试验证我的应用程序的 YouTube 网址。

到目前为止，我有以下内容：

```
// Set the youtube URL
$youtube_url = "www.youtube.com/watch?v=vpfzjcCzdtCk";

if (preg_match("/((http\:\/\/){0,}(www\.){0,}(youtube\.com){1} || (youtu\.be){1}(\/watch\?v\=[^\s]){1})/", $youtube_url) == 1)
{
    echo "Valid";
else
{
    echo "Invalid";
} 
```

我希望验证以下 Youtube Urls 变体：

*   有和没有 http://
*   有和没有 www。
*   使用网址 youtube.com 和 youtu.be
*   必须有 /watch?v=
*   必须具有唯一的视频字符串（在上面的示例中为“vpfzjcCzdtCk”）

但是，我认为我的逻辑不正确，因为由于某种原因它返回**true**为：（`www.youtube.co/watch?v=vpfzjcCzdtCk`注意我用`.co`and not写错了`.com`）

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-20T15:13:43.930

你的这个正则表达式有很多冗余（还有[倾斜牙签综合症](http://en.wikipedia.org/wiki/Leaning_toothpick_syndrome)）。但是，这应该会产生结果：

```
$rx = '~
  ^(?:https?://)?                           # Optional protocol
   (?:www[.])?                              # Optional sub-domain
   (?:youtube[.]com/watch[?]v=|youtu[.]be/) # Mandatory domain name (w/ query string in .com)
   ([^&]{11})                               # Video id of 11 characters as capture group 1
    ~x';

$has_match = preg_match($rx, $url, $matches);

// if matching succeeded, $matches[1] would contain the video ID 
```

一些注意事项：

*   使用波浪号`~`作为分隔符，以避免 LTS
*   使用`[.]`而不是`\.`提高视觉易读性并避免 LTS。（“特殊”字符 - 例如点`.`- 在字符类中无效（在方括号内））
*   要使正则表达式更“可读”，您可以使用`x`修饰符（这具有进一步的含义；请参阅[有关 Pattern 修饰符的文档](http://php.net/manual/en/reference.pcre.pattern.modifiers.php)），它还允许在正则表达式中添加注释
*   可以使用非捕获组来抑制捕获：`(?: <pattern> )`. 这使得表达更有效。

* * *

或者，要从（或多或少完整的）URL 中提取值，您可能需要使用[`parse_url()`](http://php.net/manual/en/function.parse-url.php)：

```
$url = 'http://youtube.com/watch?v=VIDEOID';
$parts = parse_url($url);
print_r($parts); 
```

输出：

```
Array
(
    [scheme] => http
    [host] => youtube.com
    [path] => /watch
    [query] => v=VIDEOID
) 
```

验证域名和提取视频 ID 作为练习留给读者。

* * *

我屈服于下面的评论战；感谢 Toni Oriol，正则表达式现在也适用于短 (youtu.be) URL。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-20T15:15:20.790

正则表达式的替代方法是[`parse_url()`](http://php.net/manual/en/function.parse-url.php).

```
 $parts = parse_url($url);
 if ($parts['host'] == 'youtube.com' && ...) {
   // your code
 } 
```

虽然它是更多代码，但它更具可读性，因此更易于维护。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T15:11:43.080

这应该这样做：

```
$valid = preg_match("/^(https?\:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/watch\?v\=\w+$/", $youtube_url);
if ($valid) {
    echo "Valid";
} else {
    echo "Invalid";
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-20T15:09:25.180

请试试：

```
// Set the youtube URL
$youtube_url = "www.youtube.com/watch?v=vpfzjcCzdtCk";

if (preg_match("/^((http\:\/\/){0,}(www\.){0,}(youtube\.com){1}|(youtu\.be){1}(\/watch\?v\=[^\s]){1})$/", $youtube_url) == 1)
{
    echo "Valid";
}
else
{
    echo "Invalid";
} 
```

你有|| 在任何情况下没有 ^$ 都可以。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-02-01T19:41:20.163

我遵循此页面上的其他答案来解析 URL 语法，但对于**YouTube ID**值本身，您可以更具体一点，正如我在**StackExchange/WebApps**上的以下答案中所描述的那样：

> [**YouTube 视频 ID 的格式**](https://webapps.stackexchange.com/a/101153/141734)   -    [https://webapps.stackexchange.com/a/101153/141734](https://webapps.stackexchange.com/a/101153/141734)
> 
> * * *
> 
> **视频 ID**
> 
> 对于**videoId**，它是一个 8 字节（64 位）整数。对 8 个字节的数据应用 Base64 编码需要**11 个字符**。但是，由于每个 Base64 字符恰好传达 6 位，因此这种分配实际上可以容纳`11 × 6 = 66`位 - 比我们的有效负载需要的多 2 位。多余的位设置为零，这具有排除某些字符出现在编码字符串的最后位置的效果。特别是，**videoId**将始终以下列之一结尾：
> 
> ```
> { A, E, I, M, Q, U, Y, c, g, k, o, s, w, 0, 4, 8 } 
> ```
> 
> 因此，**videoId**的正则表达式 (RegEx)如下所示：
> 
> ```
> [-_A-Za-z0-9]{10}[AEIMQUYcgkosw048] 
> ```
> 
> **频道或播放列表 ID**
> 
> **channelId**和**playlistId**字符串是通过Base64 编码 128 位（16 字节）二进制整数生成的。同样在这里，每个 Base64 的计算正确地预测了观察到的**22-characters**字符串长度。在这种情况下，输出能够编码`22 × 6 = 132`位，剩余4位；这些零最终限制了 64 个字母符号中的大多数出现在最后一个位置，只有 4 个仍然符合条件。所有**channelId**字符串都以下列之一结尾：
> 
> ```
> { A, Q, g, w } 
> ```
> 
> **这为我们提供了channelId**的正则表达式：
> 
> ```
> [-_A-Za-z0-9]{21}[AQgw] 
> ```

# c++ - C++ 结构错误 - 错误 C2061：语法错误：标识符

> ID：13476062
> 
> 赞同：0
> 
> 时间：2012-11-20T15:06:53.610
> 
> 标签：c++, c, visual-c++, dev-c++

这是我的代码：

```
struct opts
{
   int a;
   int b;
};
class myclass
{
  private:
           opts options;
 public:
       void afunction();
}

//myclass.cpp
void myclass::afunction()
{
     if options.a==1
           //do something
} 
```

当我编译它时，我得到了以下错误。

```
error C2061: syntax error : identifier options 
```

它有什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:08:02.190

```
 if options.a==1 
```

是错的。条件必须用括号括起来。

```
 if (options.a==1) 
```

# ruby-on-rails-3 - 从登台服务器连接到 GitoLite 时出错 - ECONNREFUSED 部署错误

> ID：13476064
> 
> 赞同：2
> 
> 时间：2012-11-20T15:07:07.837
> 
> 标签：ruby-on-rails-3, capistrano, rvm-capistrano

我在尝试将以前工作的项目部署到开发服务器时遇到了一些麻烦。我没有设置系统，但是我确实拥有我需要的所有凭据（我认为）。

在尝试 cap staging deploy 之后，我得到了这么多，然后它产生了一个错误。请看下面：

```
triggering load callbacks
  * 2012-11-20 14:52:20 executing `staging'
    triggering start callbacks for `deploy'
  * 2012-11-20 14:52:20 executing `multistage:ensure'
Identity added: /Users/XXX/.ssh/id_rsa (/Users/XXX/.ssh/id_rsa)
  * 2012-11-20 14:52:20 executing `deploy'
  * 2012-11-20 14:52:20 executing `deploy:update'
 ** transaction: start
  * 2012-11-20 14:52:20 executing `deploy:update_code'
    executing locally: "git ls-remote ssh://gitolite@repo1:2011/proto_projectname_rails HEAD"
    command finished in 2864ms
  * executing "git clone -q ssh://gitolite@repo1:2011/proto_projectname_rails /var/www/projectname/releases/20121120145223 && cd /var/www/projectname/releases/20121120145223 && git checkout -q -b deploy 0598169ed07015279bd78efa91f25ed3e5edcad8 && (echo 0598169ed07015279bd78efa91f25ed3e5edcad8 > /var/www/projectname/releases/20121120145223/REVISION)"
    servers: ["repo2"]
*** [deploy:update_code] rolling back
  * executing "rm -rf /var/www/projectname/releases/20121120145223; true"
    servers: ["repo2"]
 ** [deploy:update_code] exception while rolling back: Capistrano::ConnectionError, connection failed for: repo2 (Errno::ECONNREFUSED: Connection refused - connect(2))
connection failed for: repo2 (Errno::ECONNREFUSED: Connection refused - connect(2)) 
```

部署.rb

```
set :stages, %w(staging production)
set :default_stage, "production"
require 'capistrano/ext/multistage'

set :application, "projectname"

set :scm, :git
set :repository,  "ssh://gitolite@repo1:2011/proto_projectname_rails" 
```

老实说，我对为什么以前的工作版本不再起作用感到困惑。

任何帮助、建议或指导或此事都非常受欢迎。

谢谢

附带说明一下，是的，它一直是 2011 年的非标准端口，并且在我的 .ssh/config 中

编辑：

此过程涉及 2 台服务器。

在本地和第二台服务器上运行以下命令后，我确实得到了响应。

```
git ls-remote ssh://gitolite@repo1:2011/proto_projectname_rails 
```

它返回；

```
0598169ed07015279bd78efa91f25ed3e5edcad8    HEAD
0598169ed07015279bd78efa91f25ed3e5edcad8    refs/heads/master 
```

编辑：在 2 台服务器上运行。回购 1 和回购 2

```
cap deploy:check 
```

退货

```
 triggering load callbacks
 * 2012-11-27 21:02:36 executing `production'
 triggering start callbacks for `deploy:check'
 * 2012-11-27 21:02:36 executing `multistage:ensure'
  Identity added: /Users/x/.ssh/id_rsa (/Users/x/.ssh/id_rsa)
 * 2012-11-27 21:02:36 executing `deploy:check'
 * executing "test -d /var/www/projectname/releases"
   servers: ["repo2"]
   connection failed for: repo2 (Errno::ECONNREFUSED: Connection refused - connect(2)) 
```

**解决了**

事实证明，由于第二个服务器端口号，它被拒绝了。添加

```
set :port, 1893 
```

赏金仍然对任何可以解释这一点的人开放。

为什么总是可以通过 SSH 连接到服务器，而无需随时编辑我的 ssh/config，并且其他机器能够使用完全相同的部署和暂存文件进行部署，但在我明确添加端口号之前我不能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:51:55.073

**有关此问题的最终答案，请参阅下面的更新 2**

好的，所以首先要测试的是，您是否可以从本地计算机运行`git ls-remote ssh://gitolite@XXX:2011`——它应该返回来自 repo 的引用列表。如果这不起作用，它可能会给您一个类似的错误（连接被拒绝或类似），然后您可能需要从托管 git repo 的人那里找出原因。

如果它确实在本地工作，那么您可能需要设置部分或全部这些选项，具体取决于您在部署时希望如何访问 git。我认为需要 forward_agent 选项，除非您的部署服务器/用户可以直接登录到存储库。

```
set :deploy_via, :remote_cache
default_run_options[:pty] = true
ssh_options[:forward_agent] = true 
```

我描述了如何在[另一个堆栈溢出答案](https://stackoverflow.com/questions/13476138/setting-up-private-github-access-with-aws-elastic-beanstalk-and-ruby-container/13476637#13476637)中进行设置。

关于 capistrano 要记住的关键是大多数命令实际上只是标准的 shell 命令，但是使用 ssh 传递到远程服务器，如`ssh user@server.example.com <command>`，因此如果您无法使其正常工作，那将是另一件事来测试。

根据添加到原始问题的信息进行更新：

当您使用 URL 与服务器建立 TCP 连接时，您需要指定协议、主机地址和端口号。许多协议都隐含了端口号。例如`ssh://1.2.3.4`，指定标准端口为 22 的协议 SSH，因此与`ssh://1.2.3.4:22`. 我猜您的 git 提供程序将不同的端口分配给不同的存储库（可能在相同的 IP 地址上）以路由请求，因此对于您的每个存储库，您可能有不同的端口号。因为它不是正在使用的 ssh 协议的默认端口，所以必须将其指定为 URL 的一部分（而且您似乎可以在 capistrano 中使用 覆盖它`set :port`）。

对我来说，同一个项目有多个 git 存储库（`repo1`和`repo2`）是没有意义的，所以也许我需要了解在什么情况下会发生这种情况，但无论如何，错误的原因是您的服务器无法制作给定提供的 URL 到 git 主机的 TCP 连接。

**Update 2** OK，原来`repo1`是一个 git 仓库。它托管在非标准 SSH 端口 ( `2011`) 上，因此每当引用 git 服务器的 ssh URL 时，都需要将其嵌入到 URL 中。

然而，`repo2`它实际上只是运行 Rails 应用程序的应用程序服务器（与 git 存储库由相同的源托管），并且它*也*可以在非标准 ssh 端口 ( `1893`) 上使用。为了 ssh 进入这个服务器，你需要使用`ssh -p 1893 ...`-- 指定端口，因为这是 capistrano 连接的方式，所以它也是。这就是为什么`set :port, 1893`需要添加的原因。

# sql - Oracle 11g：如何合并两个结果集

> ID：13476073
> 
> 赞同：0
> 
> 时间：2012-11-20T15:07:19.820
> 
> 标签：sql, oracle, oracle11g

我正在使用 Oracle 数据库，我无法从 2 个结果集中获得一个结果。

我有桌子案例

```
Create table cases (ID varchar(1), date_entered date, sub_category varchar (5));

insert into cases (id, date_entered, sub_category)
values('1', to_date('2012/05/03','yyyy/mm/dd'),'Temp1');
insert into cases (id, date_entered, sub_category)
values('2', to_date('2012/06/01','yyyy/mm/dd'),'Temp2');
insert into cases (id, date_entered, sub_category)
values('3', to_date('2012/03/15','yyyy/mm/dd'),'Temp3');
insert into cases (id, date_entered, sub_category)
values('4', to_date('2012/03/01','yyyy/mm/dd'),'Call1');
insert into cases (id, date_entered, sub_category)
values('5', to_date('2012/03/08','yyyy/mm/dd'),'Call2');
insert into cases (id, date_entered, sub_category)
values('6', to_date('2012/02/20','yyyy/mm/dd'),'Call2'); 
```

并且需要按SUB CATEGORIES，BY MONTH统计记录，其中**一个计数**包括sub_category：Temp1，Temp2，Temp3**其他计数**包括sub_category：Call1，Call2，Call3

我做了查询1：

```
With skills
    AS 
    ( 
          Select sub_category, 
                 date_entered,
                 extract(MONTH FROM cases.date_entered) as month_entered, 
                 count (*)
          from cases 
          where 
                SUB_CATEGORY IN('Temp1', 'Temp2', 'Temp3')

          group by cases.sub_category, cases.date_entered
          order by to_char(cases.date_entered,'MM')
    )

    select  s.month_entered, 
            count(*)as skill_count
            from skills s

    group by s.month_entered
    ORDER BY CAST(s.month_entered AS INTEGER) ASC 
```

结果：

```
MONTH_ENTERED   SKILL_COUNT
3               1
5               1
6               1 
```

和查询2：

```
With training
AS 
( 
      Select sub_category, 
             date_entered,
             extract(MONTH FROM cases.date_entered) as month_entered, 
             count (*)
      from cases 
      where 
            SUB_CATEGORY IN('Call1', 'Call2', 'Call3')

      group by cases.sub_category, cases.date_entered
      order by to_char(cases.date_entered,'MM')
)

select  t.month_entered, 
        count(*)as training_count
        from training t

group by t.month_entered
ORDER BY CAST(t.month_entered AS INTEGER) ASC 
```

结果：

```
MONTH_ENTERED   TRAINING_COUNT
2                1
3                2 
```

我需要从这两个查询中得到的结果是：

```
MONTH_ENTERED   SKILL_COUNT  TRAINING_COUNT
    2               0            1
    3               1            2
    5               1            0
    6               1            0 
```

尝试联合并离开加入，但没有给我这个结果。

这是 sqlfiddle 示例[http://sqlfiddle.com/#!4/504cd/31](http://sqlfiddle.com/#!4/504cd/31)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:20:07.433

我认为您可以将查询大大简化为：

```
 Select extract(MONTH FROM cases.date_entered) as month_entered, 
             sum(case when SUB_CATEGORY IN('Temp1', 'Temp2', 'Temp3') then 1 else 0 end) as Skill_Count,
             sum(case when SUB_CATEGORY IN('Call1', 'Call2', 'Call3') then 1 else 0 end) as Skill_Count,
      from cases 
      group by extract(MONTH FROM cases.date_entered)
      order by extract(MONTH FROM cases.date_entered) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:22:06.930

```
SELECT
  EXTRACT(MONTH FROM CASES.DATE_ENTERED) AS MONTH_ENTERED,
  COUNT (CASE WHEN SUB_CATEGORY IN('Temp1', 'Temp2', 'Temp3') THEN 1 END) SKILL_COUNT,
  COUNT (CASE WHEN SUB_CATEGORY IN('Call1', 'Call2', 'Call3') THEN 1 END) TRAINING_COUNT
FROM CASES
GROUP BY EXTRACT(MONTH FROM DATE_ENTERED)
ORDER BY MONTH_ENTERED ASC 
```

# c# - 存储过程连接包装器

> ID：13476075
> 
> 赞同：0
> 
> 时间：2012-11-20T15:07:26.887
> 
> 标签：c#, .net, stored-procedures, ado.net, db2

我有一个用于查询 DB2 数据库的包装器。我设置包装器的方式是在查询方法中创建和处理连接。这样，我的包装器的消费者不必担心管理（打开和关闭）连接。有没有办法用存储过程做到这一点？我的一些用户发送出站参数，有没有办法将这些参数转换为数据表，就像我在上面的查询中所做的那样？

```
 /// <summary>
    /// Query A database and return a DataTable of strings with no null
    /// </summary>
    /// <param name="txtQuery">The Query</param>
    /// <param name="list">the paramaters for the query</param>
    /// <returns>Datatable with results</returns>
    public DataTable Query(string txtQuery, params string[] list)
    {
     //create return ovject
        DataTable dt = new DataTable();
        //pull dbconnection out of pool
        using (var conn = new DB2Connection(connectionstring))
        {
            //open connection
            if (!OpenConn(conn))
            {
                throw new Exception(“failed to connect”);
            }
            try
            {
                //query db
                using (DB2Command cmd = new DB2Command())
                {
                    cmd.Connection = conn;
                    cmd.CommandText = txtQuery;
                    for (int i = 0; i < list.Length; i++)
                    {
                        DB2Parameter param = new DB2Parameter(i.ToString(), list[i]);
                        cmd.Parameters.Add(param);
                    }
                    //fill datatable
                    using (DB2DataAdapter adap = new DB2DataAdapter())
                    {
                        adap.SelectCommand = cmd;
                        adap.Fill(dt);
                    }
                }
            }
            catch (Exception ex)
            {
                throw ex;
            }                
        }
       return dt;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T16:01:42.017

它不会那么容易做到，但它是可能的。我假设 DB2Parameter 与此答案中的 SqlParameter 基本相同...

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.aspx)和相关页面将在我在这里说的之后（或期间）有用。

本质上，当调用带有输出参数的过程时，您可以像通常那样调用它。对于输出参数，您可以正常传递一个对象，但`Direction`参数对象上有一个属性允许您指定它是一个输出参数。

一旦您在过程上调用了适当的执行方法，那么这些输出参数的值将被填充并且可以从参数对象中检索。

然后将它们放入 DataTable 由您决定。您可以创建一个数据表，为每个输出参数添加一列，然后添加包含所有值的行。

这样做的主要问题当然是，在设置数据库调用时，您需要知道哪些参数可以返回某些内容，以便您可以适当地设置它们的方向。当你只传递一个字符串数组时，这几乎肯定是不可能的。

最好的方法是正如其他人在评论中建议的那样，将所有数据作为数据集返回。当前使用输出参数的任何现有过程都可以创建仅捕获输出参数的包装过程，然后将它们放入您可以如上所述处理的选择语句中。

另一种选择是让您的`Query`方法的调用者传递有关他们正在使用的参数的更多详细信息（例如输入或输出）。我个人更喜欢将所有数据作为选择返回，而不是使用输出参数，因为它使这种代码更简单。

# android - Android蓝牙一个接一个扫描

> ID：13476082
> 
> 赞同：0
> 
> 时间：2012-11-20T15:07:45.067
> 
> 标签：android, bluetooth, network-scan

我在连续运行不止一次扫描时遇到了一些问题。这是我处理动作的方式：

```
if(BluetoothAdapter.ACTION_DISCOVERY_FINISHED.equals(action)){
            Log.w("Bluetooth", "SCAN STOPPED EVENT");
            try{
                mBluetoothAdapter.startDiscovery();
            }catch(Exception ex){
                Log.w("Bluetooth", ""+ex);
            }
        } 
```

扫描后，我得到以下日志输出。在此示例中，扫描发现了 5 个设备。

```
(main) [1,17346] SCAN STOPPED EVENT
(524): mDeviceProperties size is 5
(524): mCache size is 5
(524): trying to delete object
(524): trying to delete object
(524): trying to delete object
(524): trying to delete object
(524): trying to delete object
(524): Deleting object00:AA:DD:FF:AA:44
(524): Deleting object77:DD:22:66:99:44
(524): Deleting object00:00:88:99:22:77
(524): Deleting object77:CC:33:CC:33:FF
(524): Deleting object66:33:44:00:33:88
(524): mDeviceProperties size is 0
(524): mCache size is 0 
```

它显然正在经历某种过程，它会删除所有缓存的设备，但它永远不会再次开始扫描..有人对此有什么建议吗？

# jquery - jQuery、Ajax 填充下拉列表

> ID：13476084
> 
> 赞同：0
> 
> 时间：2012-11-20T15:07:54.993
> 
> 标签：jquery, html, ajax

我有一个带有工作函数的 ajax 调用来填充下拉列表，但我希望该函数接收变量以填充下拉列表，而不是特定于用于提取数据的 url

我有

```
var string = '';
success: function (item)
if (item != '') {
  for (var x = 0; x < item.food.length; x++) {
    var filler = '<option value=' + item.food[i].name + '">' + item.food[i].name + '</option>';
    string += filler;
  }
  $("#food-list").html(string);
}
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:25:18.820

这似乎对我有用，但唯一的错误是，“我认为”是食物数组中的变量，它可能`x`不是`i`.

```
var food =['Sandwish', 'Hamburguer', 'Tacos']
var string = '';

success: function (item){
  if (food) {
    for (var x = 0; x < item.food.length; x++) {
     var filler = '<option value=' + item.food[x].name + '">' + item.food[x].name + '</option>';
     string +=filler;
     }
   $("#food-list").html(string);
 }
}
}); 
```

下面是一个小[例子](http://jsfiddle.net/eddiarnoldo/r2q37/)，希望对你有所帮助。

# entity-framework-5 - 将 EF4 模型升级到 EF5 模型后的性能下降 (DbContext)

> ID：13476088
> 
> 赞同：5
> 
> 时间：2012-11-20T15:08:03.747
> 
> 标签：entity-framework-5

我在升级到 .NET 4.5 和 EF5（引用新的 EntityFramework 5 程序集）的 .NET 4.0 应用程序中有一个 EF4 模型，我将“代码生成策略”更改为“无”并添加了一个代码生成项（EF 5 .x DbContext 生成器）到模型。几乎在任何情况下都可以正常工作。但是现在当我访问引用大量记录（> 100.000 条记录）的导航属性时出现了大问题。该数据库是一个 MSSQL 2005 服务器。

我的场景如下所示：

我的数据库中的每个客户都有一个唯一的 ID（它是数据库中的主键），此外，每个客户记录都包含一个父客户 ID（在这种特殊情况下，几乎每个客户都引用相同的父 ID（150.000 条记录中约有 145.000 条记录）记录），它是 id 为 1 的记录）。

我的模型包含`DbSet<CustomerBase> CustomerBase`代表包含所有客户及其数据的表。此外，还有一些导航属性被调用`ICollection<CustomerBase> CustomerBaseChildren`，`ICollection<CustomerBase> CustomerBaseParent`它们以 0..1 到 * 的多重性连接客户 ID 和客户父 ID。

我构建了一个简化版本来说明我的意思：

为此测试构建包含 150.000 条记录的表：

```
CREATE TABLE CustomerBase
(
  id int IDENTITY(1,1) PRIMARY KEY NOT NULL,
  parent_id int FOREIGN KEY REFERENCES CustomerBase(id),
  some_data1 varchar(100),
  some_data2 varchar(100),
  some_data3 varchar(100),
  some_data4 varchar(100),
  some_data5 varchar(100),
)
GO

DECLARE @i int = 0
WHILE @i < 150000 BEGIN
  INSERT INTO CustomerBase (parent_id, some_data1, some_data2, some_data3, some_data4, some_data5) VALUES (1, newid(), newid(), newid(), newid(), newid())

  SET @i = @i + 1
END 
```

将包含引用约束的表导入到新的实体模型中。我用作“实体容器名称”ef5Entities。然后我将导航属性 CustomerBase1 和 CustomerBase2 重命名为 CustomerBaseChildren 和 CustomerBaseParent。

这是我的示例应用程序：

```
static void Main(string[] args)
{
  ef5Entities context = new ef5Entities();

  // Start with selecting a single customer.
  // Works fine in EF4/ObjectContext, works even faster in in EF5/DbContext
  CustomerBase someCustomer = context.CustomerBase.First(customer => customer.id == 1234);
  // Do something ...

  // Get the parent of the customer.
  // Works fine in EF4/ObjectContext, works even faster in in EF5/DbContext
  CustomerBase parentCustomer = someCustomer.CustomerBaseParent;
  // Do something ...

  // Get the first child of the given parent id.
  // Takes about 10 seconds in EF4/ObjectContext, I stopped the debugger after 2 minutes waiting in EF5/DbContext
  CustomerBase firstChild = parentCustomer.CustomerBaseChildren.First();

  Console.WriteLine("Press any key to quit.");
  Console.ReadKey();
} 
```

我使用 SQL Server Profiler 查看在数据库上执行的实体框架。看来EF4和EF5的代码是一模一样的：

```
SELECT TOP (1) 
[Extent1].[id] AS [id], 
[Extent1].[parent_id] AS [parent_id], 
[Extent1].[some_data1] AS [some_data1], 
[Extent1].[some_data2] AS [some_data2], 
[Extent1].[some_data3] AS [some_data3], 
[Extent1].[some_data4] AS [some_data4], 
[Extent1].[some_data5] AS [some_data5]
FROM [dbo].[CustomerBase] AS [Extent1]
WHERE 1234 = [Extent1].[id]

exec sp_executesql N'SELECT 
[Extent1].[id] AS [id], 
[Extent1].[parent_id] AS [parent_id], 
[Extent1].[some_data1] AS [some_data1], 
[Extent1].[some_data2] AS [some_data2], 
[Extent1].[some_data3] AS [some_data3], 
[Extent1].[some_data4] AS [some_data4], 
[Extent1].[some_data5] AS [some_data5]
FROM [dbo].[CustomerBase] AS [Extent1]
WHERE [Extent1].[id] = @EntityKeyValue1',N'@EntityKeyValue1 int',@EntityKeyValue1=1

exec sp_executesql N'SELECT 
[Extent1].[id] AS [id], 
[Extent1].[parent_id] AS [parent_id], 
[Extent1].[some_data1] AS [some_data1], 
[Extent1].[some_data2] AS [some_data2], 
[Extent1].[some_data3] AS [some_data3], 
[Extent1].[some_data4] AS [some_data4], 
[Extent1].[some_data5] AS [some_data5]
FROM [dbo].[CustomerBase] AS [Extent1]
WHERE [Extent1].[parent_id] = @EntityKeyValue1',N'@EntityKeyValue1 int',@EntityKeyValue1=1 
```

如果我在 SQL Management Studio 中执行所有三个语句，则需要大约 1-2 秒才能获取所有 1 + 1 + 150.000 条记录。

但据我了解，第三个陈述是问题所在。它返回 150.000 条记录（即使我`.First()`在上面的代码中使用，`.Single()`或者`.Take(10)`无论我是否`.OrderBy(...)`在它前面使用。看起来实体框架获取所有 150.000 条记录并在 DbContext 中缓存记录需要花费大量时间（等了 2 分钟后，我停止了测试代码，用我的真实客户基表测试它需要 100 分钟才能完成。在 ObjectContext 中缓存只需要大约 10 秒（考虑到数据库本身快 5-10 倍，这很糟糕，但我可以忍受）。

甚至内存消耗也是可怕的，使用 ObjectContext 应用程序工作集提高了大约 200mb，使用 DbContext 工作集提高了大约 10 倍。

如果我只想要第一条记录或前 n 条记录（通常是 10 到 100 条记录），有没有办法在 select 语句中注入 TOP(n) 子句以停止从数据库接收所有记录？在第一个语句中，select 语句中有一个 TOP(1)（如果使用`.Single()`而不是TOP(2)，则为 TOP(2) `.First()`）。

我什至尝试将线路更改`CustomerBase someCustomer = context.CustomerBase.First(customer => customer.id == 1234);`为无跟踪：`CustomerBase someCustomer = context.CustomerBase.AsNoTracking().First(customer => customer.id == 1234);`

但随后收到`System.InvalidOperationException`以下`CustomerBase firstChild = parentCustomer.CustomerBaseChildren.First();`消息：

当使用 NoTracking 合并选项返回对象时，只能在 EntityCollection 或 EntityReference 不包含对象时调用 Load。

如果我将代码生成策略改回使用 EF5 的 ObjectContext，则一切正常，就像在旧的 EF4 中一样。我在使用 DbContext 时做错了什么，还是 DbContext 不能在更大的环境中使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-04T16:51:05.330

我最近升级到 Visual Studio 2013、.NET 4.5.1 和 Entity Framework 6。如果我修改我的模型以使用 EF6 而不是 EF5，它就像一个魅力。

所以解决方案是使用带有 ObjectContext 的 EF4/EF5 或带有 DbContext 的 EF6。

# android - 如何在 onDestory() 之后显示警报对话框？

> ID：13476089
> 
> 赞同：0
> 
> 时间：2012-11-20T15:08:05.253
> 
> 标签：android, android-alertdialog

```
 package com.example.test3;

import java.util.HashMap;

import android.os.Bundle;
import android.app.Activity;
import android.app.AlertDialog;
import android.app.DialogFragment;
import android.app.FragmentManager;
import android.content.Context;
import android.content.DialogInterface;
import android.content.SharedPreferences;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;

public class Test3 extends Activity {

    Button testShowPinDialogButton;
    public AlertDialog alertCreate;
    AlertDialog.Builder alert;
    private HashMap<String, Boolean> pinDialogState;
    EditText input;
    Context context;
    private String tag = "Test3";
    private String click1 = "click1";
    private SharedPreferences sharedPreferences;
    private SharedPreferences.Editor editor;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_test3);
        context = this;
        sharedPreferences = getPreferences(MODE_PRIVATE);
        editor = sharedPreferences.edit();
        testShowPinDialogButton = (Button) findViewById(R.id.testShowPinDialogBbutton);
        testShowPinDialogButton.setOnClickListener(showPinDialog);
        pinDialogState = new HashMap<String, Boolean>();
        Log.d(tag, "onCreate()");
    }

    private OnClickListener showPinDialog = new OnClickListener() {

        @Override
        public void onClick(View v) {
            launchDialog();
        }
    };

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_test3, menu);
        return true;
    }

    protected void launchDialog() {
        alert = new AlertDialog.Builder(context);
        alert.setTitle("Title");
        alert.setMessage("Message");
        alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int whichButton) {
            }
        });

        alert.setNegativeButton("Cancel",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        dialog.dismiss();
                        pinDialogState.put("click1", false);
                    }
                });

        Log.d(tag, "launchDialog()");
        alertCreate = alert.create();
        alertCreate.show();
    }

    @Override
    protected void onPause() {
        super.onPause();
        Log.d(tag, "onPause()");
        if (alertCreate != null) {
            alertCreate.dismiss();
            editor.putBoolean(click1, true);
        }
    }

    @Override
    protected void onRestart() {
        super.onRestart();

    }

    @Override
    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
        Log.d("Test3", "onResume()");
        alertCreate.show();
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        Log.d("Test3", "onDestroy()");
    }

} 
```

我正在为如何在从 onPause() 中解除警报对话框后重新显示它的逻辑而苦苦挣扎。我正在考虑共享首选项，但我怎么知道在活动被破坏之前正在显示对话框，现在用户回到应用程序，我必须显示对话框。我还听说，在活动被销毁后，简单地调用 alertDialog.show() 将不起作用。我能做些什么？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:56:25.410

Maybe Crouton works, i dont know, but try:

[http://www.grokkingandroid.com/useful-android-libraries-crouton/](http://www.grokkingandroid.com/useful-android-libraries-crouton/)

Crouton is Nofitication Library, simple, easy, fast!

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T16:07:32.860

您将使用共享首选项是对的。

在`onPouse()`方法中将您的警报消息保存为标志并打开它`onResume()`：

```
public class Test3 extends Activity {
....
 SharedPreferences mPrefs = context.getSharedPreferences("MyPrefs", 0);

 ....
 @Override
protected void onPause() {
    super.onPause();
    Log.d(tag, "onPause()");

         SharedPreferences.Editor editor = mPrefs.edit();
         editor.putBoolean("isShowed", alertCreate );
         editor.commit();

    if (alertCreate != null) {
        alertCreate.dismiss();
        editor.putBoolean(click1, true);
    }
}

 ....

 @Override
protected void onResume() {
    // TODO Auto-generated method stub
    super.onResume();
    Log.d("Test3", "onResume()");

     boolean isShow = mPrefs.getBoolean("isShowed", false);

     if(isShow == true){
        alertCreate.show();
        .....
     }

}

} 
```

# android - facebook FQL 让朋友参加活动

> ID：13476096
> 
> 赞同：1
> 
> 时间：2012-11-20T15:08:24.850
> 
> 标签：android, facebook, facebook-graph-api, facebook-fql

我正在尝试获取参加特定活动的所有 Facebook 朋友。

```
select uid, rsvp_status from event_member where uid IN (SELECT uid2 FROM friend WHERE uid1=me()) AND eid=100609746772815 and  rsvp_status="attending"; 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:34:48.630

如果您在用户登录时使用权限“friends_events”，它可以正常工作。没有它，你只会得到一个空的结果。

# sitecore - Sitecore：如何列出组成时事通讯的一组项目

> ID：13476097
> 
> 赞同：1
> 
> 时间：2012-11-20T15:08:26.380
> 
> 标签：sitecore, sitecore6

我有来自客户的以下要求：

我将不得不在将成为网站页面一部分的子布局中列出一组项目。

这些项目将组成时事通讯。

每个项目（“文章”）都必须列出（文章名称+查看文章的链接）这里的逻辑是什么？我怎样才能找回那些文章？应该在特定文件夹中创建而不是在 C# 中解析文件夹吗？我们可以通过 parsign / 查看时事通讯项目本身来检索项目路径吗？

谢谢你，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:47:30.050

## 使用索引

为了优化，您可能想要创建要列出的项目的索引。您可以不这样做，但您将开始遇到大量文章的性能问题。

以下代码块显示了从索引中加载项目的一种方法的示例。如果你用谷歌搜索，你可以找到很多这方面的信息，尤其是使用[Advanced Database Crawler。](http://sitecoreblog.alexshyba.com/2010/11/sitecore-searcher-and-advanced-database.html)

```
 /// <summary>
    /// Searches against the Lucene index for all articles
    /// </summary>
    /// <returns></returns>
    private List<Item> LoadArticlesWithLucene()
    {
        ConcurrentBag<Item> articles = new ConcurrentBag<Item>();

        Index searchIndex = SearchManager.GetIndex("MyArticleIndexName");
        using (IndexSearchContext context = searchIndex.CreateSearchContext())
        {
            //The wildcard search allows us to pull back all items from the index
            var query = new WildcardQuery(new Term(Constants.LuceneFields.Name, "*"));
            SearchHits hits = context.Search(query);

            //Go through the results 
            SearchResultCollection results = hits.FetchResults(0, hits.Length);

            Parallel.ForEach(results, result =>
            {
                //This is done in a foreach in case you want to add any processing or checking before adding to your collection
                Item searchItem = result.GetObject<Item>();
                articles.Add(searchItem);
            });

        }

        return articles.ToList();
    } 
```

您仍然需要创建索引，如果您使用的是高级数据库爬虫模块，您只需向您的 Sitecore 实例添加一些配置，如下所示：

```
 <search>
        <configuration>
            <indexes>
                <index id="MyArticleIndexName" type="Sitecore.Search.Index, Sitecore.Kernel">
                    <param desc="name">$(id)</param>
                    <param desc="folder">__news</param>
                    <Analyzer ref="search/analyzer" />
                    <locations hint="list:AddCrawler">
                        <master type="scSearchContrib.Crawler.Crawlers.AdvancedDatabaseCrawler,scSearchContrib.Crawler">
                            <Database>master</Database>
                            <Root>/sitecore/content</Root>
                            <IndexAllFields>true</IndexAllFields>
                            <include hint="list:IncludeTemplate">
                                <article>{3DD181B0-0F39-4E7A-8C94-DFA129DE6C81}</article> <!-- Replace the GUID here with yours -->
                            </include>
                            <fieldTypes hint="raw:AddFieldTypes">
                                <!-- Multilist based fields need to be tokenized to support search of multiple values -->
                                <fieldType name="multilist" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                                <fieldType name="treelist" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                                <fieldType name="treelistex" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                                <fieldType name="checklist" storageType="NO" indexType="TOKENIZED" vectorType="NO" boost="1f" />
                            </fieldTypes>
                        </master>
                    </locations>
                </index>
            </indexes>
        </configuration>
    </search> 
```

## 在没有索引的情况下从 Sitecore 中提取

如果您在没有索引的情况下从 Sitecore 中提取，您将需要查找具有特定模板 ID 或名称（您的文章模板）的所有后代。有多种方法可以做到这一点，但您可以使用这样的扩展：

```
 /// <summary>
    /// Returns every item below the current item which has the specified template
    /// </summary>
    /// <param name="item"></param>
    /// <param name="templateName">Template of items to return</param>
    /// <returns></returns>
    public static List<Item> GetAllDescendants(this Item item, string templateName)
    {
        return new List<Item>(Context.Database.SelectItems(item.Paths.LongID + "//*[@@templatename='" + templateName + "']"));
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T03:11:31.930

有什么理由你不能使用 Treelist 字段，放置一些数据源/模板限制，让编辑选择他们想要包含在时事通讯中的文章（以及按什么顺序）？

[http://firebreaksice.com/tame-your-sitecore-treelists/](http://firebreaksice.com/tame-your-sitecore-treelists/)

除非您真的想要完全动态且无需用户干预的东西？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T18:53:05.613

## 项目桶

您可能需要考虑 Item Bucket 共享源模块，它允许您将大量项目存储在内容树中的一个位置并按分类类别进行搜索。这将支持您当前的需求，并支持随着您的需求发展以新的方式呈现此内容，例如，在侧边栏中显示有关相关主题的文章。

来自[Github 文档：](https://github.com/jerrong/Sitecore-Item-Buckets)

> Sitecore 项目存储桶解决了内容树中大量项目的管理问题，并且能够以快速有效的方式检索和使用它们。要决定是否应该将一个项目变成一个桶，然后隐藏它的所有后代，就像问自己是否关心桶下数据的结构一样简单。例如，如果您在内容树中有一个产品存储库、电影存储库或标签存储库，您很可能只想将它们全部转储到一个文件夹中，当您想要使用特定产品、电影或标签时，您会只需搜索并打开它。

Item Bucket 具有一些令人印象深刻的特性，例如非常干净的用户界面、标记项目的能力以及针对这些标记运行 LINQ 查询的能力。这是 Github 文档中的一个示例。

```
var movies  = new BucketQuery().WhereContentContains("Dark")
                           .WhereTemplateIs("{D3335D0B-D84D-46AF-C620-A67A6022AB3F}")
                           .WhereLanguageIs(Sitecore.Context.Language)
                           .WhereTaggedWith("Tag ID for Tim Burton")
                           .WhereTaggedWith("Tag ID for Johnny Depp")
                           .WhereTaggedWith("Tag ID for Helen Bohnam-Carter")
                           .Starting(DateTime.Now.AddYears(-12))
                           .Ending(DateTime.Now)
                           .SortBy("_name")
                           .Page(1, 200, out hitCount); 
```

Item Buckets 于 2012 年在 Sitecore Symposium 上推出。虽然这是一个共享源模块，但受 Sitecore 支持，并在 Symposium 主题演讲中作为企业级解决方案用于处理 Sitecore 内容树中的大型数据集。

### 链接：

*   [PDF手册](https://github.com/jerrong/Sitecore-Item-Buckets/blob/master/documentation/Item_Buckets_Developer_Guide-SC64-66-USLetter.pdf)
*   [Sitecore 市场](http://marketplace.sitecore.net/en/Modules/Sitecore_Item_Buckets.aspx)
*   [Github](https://github.com/jerrong/Sitecore-Item-Buckets)

# c - 如何在 C 中将图像旋转 90 度

> ID：13476099
> 
> 赞同：1
> 
> 时间：2012-11-20T15:08:30.113
> 
> 标签：c, arrays, pixels, flip

我一直在尝试将图像变成黑白，然后在 C 中将其旋转 90 度，但我对编程还很陌生，这就是我必须要做的。

```
#include<stdio.h>
#include<string.h>

int main () {
FILE* first;
FILE* second;
FILE* third;
int counter;
char c;
int width, height, pixelmax, average;
int pixelred, pixelgreen, pixelblue, black[300][300][3];
int i, j, timer=0;
int k, f=0;
first=fopen("blackbuck.ppm","r");
second=fopen("blacktrout.ppm","w"); 
```

这会跳过前几行代码

```
for(counter=1;counter<3;counter++){
do{
    c=getc(first);
}while(c != '\n');
    }
fscanf(first,"%d%d", &width,&height);
fscanf(first,"%d", &pixelmax); 
```

在程序的这一部分中，我通过取它们的平均值将像素变为黑白，这是最简单的部分。

```
for(i=0, j=0; i<width;i++, timer++){
fscanf(first,"%d%d%d",&pixelred,&pixelgreen,&pixelblue);
average=(pixelred+pixelgreen+pixelblue)/3;
black[i][j][0]=average;
black[i][j][1]=average;
black[i][j][2]=average;
fprintf(second,"%d %d %d\n",black[i][j][0],black[i][j][1],black[i][j][2]);

if (i==(width-1)&& j<height){
i=0;
j++;
}
}
fclose(first);
fclose(second);
third=fopen("blackflip.ppm","w"); 
```

这是我完全迷失的部分，我不知道如何将我的 3d 阵列中的像素存储旋转 90 度。请问有什么帮助吗？对于像我这样的新手程序员来说，一个很好解释的解释将大有帮助。谢谢！

```
for(...???)
}
}

return 0; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:19:38.250

基本逻辑是这样的：

```
original_x = original_height-1-rotated_y
original_y = rotated_x
rotated_image(rotated_x,rotated_y) = original_image(original_x,original_y) 
```

假设 (0,0) 是左上角，我们想要向左旋转 90 度。那么旋转后图像的左上角就相当于原图的右上角，在(original_height-1,0)处。

当你越过图像的顶部，增加 x 时，你正在沿着右侧从原始图像中抓取像素，增加 y，因此旋转图像的 x 就像原始图像的 y。

当您在 rotate_image 中向下移动时，增加 y，您将向 original_image 的左侧移动更多，这就是为什么我们要从 original_height-1 中减去 rotate_y 以获得 original_x 坐标。

另一件需要注意的是，旋转图像的宽度和高度与原始图像相反。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:30:58.527

```
for (i = width-1 ; i >= 0 ; --i){
    for(j = height-1 ; j >= 0 ; --j)
        // use formulas: x' = y; y' = -x' to rotate left
        rotated[i][j] = black[j][width-i-1];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:40:15.450

一般来说，你可以使用下一个公式顺时针旋转一个点 alpha 度让一个点 P(x,y) 让 alpha 你想要顺时针旋转的度数

然后 x_rotated = x*cos(alpha) - y*sin(alpha); y_rotated = x*sin(alpha) + y*cos(alpha);

如果 alpha 是顺时针 90 度，那么

x_rotated = -y; y_rotated = x;

我希望这会有所帮助

# javascript - xmlHTTP SCRIPT5：访问被拒绝错误

> ID：13476102
> 
> 赞同：1
> 
> 时间：2012-11-20T15:08:39.297
> 
> 标签：javascript, jquery, google-chrome, internet-explorer-10

有一个我无法克服的错误。它涉及读取本地文件。代码如下，完全可以在 Chrome 中运行。在 IE10 上，它适用于 jQuery 而不是 xmlHTTP。xmlHTTP 路由会`SCRIPT5: Access is Denied`报错。

我在代码中看不到任何跨域操作，但为了确保灵活性，我更改了安全设置以允许跨域代码，但仍然无法正确执行它。非常感谢大家的专业知识！

外部引用是`test.txt`与该 HTML 文件位于同一目录中的一个简单文件，并且包含一行文本。

```
<!DOCTYPE html>
<html>
 <head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js">
</script>
</head>
<body>
<script>
function getXmlHttp() {
   if (window.XMLHttpRequest) {
      xmlhttp=new XMLHttpRequest();
   } else if (window.ActiveXObject) {
      xmlhttp=new ActiveXObject("Msxml2.XMLHTTP");
   }
   if (xmlhttp == null) {
      alert("Your browser does not support XMLHTTP.");
   }
   return xmlhttp;
}

function readFileHttp(fname, callback) {
   xmlhttp = getXmlHttp();
   xmlhttp.onreadystatechange = function() {
      if (xmlhttp.readyState==4 ) { 
          callback(xmlhttp.responseText); 
      }
   }
   xmlhttp.open("GET", fname, true);
   xmlhttp.send(null);
}

function handleTextFile(e){
   var strOutput = String(e);
   var result = document.getElementById('xmlHTTPText');
   result.innerHTML = strOutput;
}

function doXMLHTTP(){
   readFileHttp("./test.txt", handleTextFile);
}

function handleJQTextFile(e){
   var strOutput = String(e);
   var result = document.getElementById('jQueryText');
   result.innerHTML = strOutput;
}

function doJQuery(){
   $.get("./test.txt", handleJQTextFile);
}

</script>
<button onclick="doJQuery()">doJQuery</button>
<button onclick="doXMLHTTP()">doXMLHTTP</button>
<BR />
<A>jQueryText:&nbsp;</A><A id="jQueryText"></A>
<BR />
<A>xmlHTTPText:&nbsp;</A><A id="xmlHTTPText"></A>

</body>
</html> 
```

# mysql - 按字段排序 + 按字母顺序

> ID：13476104
> 
> 赞同：2
> 
> 时间：2012-11-20T15:08:50.577
> 
> 标签：mysql, sql, sql-order-by

我想先按字段排序我的查询，然后对于不在“按字段”列表中的查询，按字母顺序排序。当我这样做时，结果首先给出不在字段列表中的所有字段，然后在这些字段之后，结果显示按字段排序的字段（正确）

这是我的查询：

```
SELECT merk FROM user WHERE merk <> '' group by merk 
ORDER BY FIELD(merk,'Theo', 'Anne et Valentin') ASC, merk ASC 
```

结果是这样的（看最后2个是ORDER BY FIELD记录）

```
'Binoche'
'Binoche Mini'
'Blac'
'Carrera'
'Christian Dior'
'D&G'
'Staffan Preutz Design'
'Tim Van Steenbergen'
'Tom Ford'
'Tom Tailor'
'Tommy Hilfiger'
'Vogue'
'Vuillet Vega'
'You\'s Eyeworks'
'Theo'
'Anne et Valentin' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:14:03.273

这是因为当值不在列表中时`FIELD(merk,'Theo', 'Anne et Valentin')`返回，所以不是，而是按降序排序，这样列表中的值将首先排序。`zero``FIELD(merk,'Theo', 'Anne et Valentin') ASC``FIELD`

```
SELECT..
FROM..
WHERE....
ORDER BY FIELD(merk,'Theo', 'Anne et Valentin') DESC, merk ASC 
```

**来源**

*   [场地（）](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_field)
*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/1746c/2)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-20T16:07:26.223

您也可以这样做，因此您不必更改自定义字段的排序顺序：[http ://www.sqlfiddle.com/#!2/c9122/1](http://www.sqlfiddle.com/#!2/c9122/1)

```
SELECT merk , FIELD(merk,'Theo', 'Anne et Valentin') 
FROM user 
WHERE merk <> '' group by merk 
ORDER BY 
    COALESCE(
      NULLIF(FIELD(merk,'Theo', 'Anne et Valentin'), 0)
      , 99999)      
    ASC 
```

输出：

```
|                  MERK | FIELD(MERK,'THEO', 'ANNE ET VALENTIN') |
------------------------------------------------------------------
|                  Theo |                                      1 |
|      Anne et Valentin |                                      2 |
|            Tom Tailor |                                      0 |
| Staffan Preutz Design |                                      0 |
|               Carrera |                                      0 |
|               Binoche |                                      0 |
|       You''s Eyeworks |                                      0 |
|        Tommy Hilfiger |                                      0 |
|   Tim Van Steenbergen |                                      0 |
|        Christian Dior |                                      0 |
|          Binoche Mini |                                      0 |
|                 Vogue |                                      0 |
|              Tom Ford |                                      0 |
|                   D&G |                                      0 |
|                  Blac |                                      0 |
|          Vuillet Vega |                                      0 | 
```

# android - 为什么 BitmapRegionDecoder 分配这么多内存？

> ID：13476105
> 
> 赞同：3
> 
> 时间：2012-11-20T15:08:51.340
> 
> 标签：android, bitmap, bitmapfactory

我在磁盘上有 1280x1280 JPG，我正在使用以下代码来解码图像的一个区域（剪掉侧面）以显示在 ImageView 中。裁剪图像的顶部和底部也有类似的问题。

```
private Bitmap decodeBitmapRegion(InputStream in, Rect region, Bitmap recycleBitmap) {
    LOGD(TAG, "decodeBitmapRegion region=" + region + ", recycleBitmap=" + recycleBitmap );

    Bitmap bitmap = null;
    BitmapRegionDecoder decoder = null;

    BitmapFactory.Options options = new BitmapFactory.Options();        
    options.inSampleSize = 1;
    options.inBitmap = recycleBitmap;

    try {
        decoder = BitmapRegionDecoder.newInstance(in, false);
        bitmap = decoder.decodeRegion(region, options);
    } catch (IllegalArgumentException e){
        LOGE(TAG, "Failed to recycle bitmap for rect=" + region, e);
    } catch (IOException e) {
        LOGE(TAG, "Failed to decode into rect=" + region, e);
    } finally {
        if (decoder != null) decoder.recycle();
    }

    return bitmap;
} 
```

在 Acer Iconia A100 (4.0.3) 上，代码可以完美运行，并将区域解码为回收位图（如果提供），不会在堆上分配内存。logcat 没有 GC 或增长堆消息。它还在运行 4.2.0 的 Nexus 7 上正常工作。

在 Motorola Xoom (4.0.4) 上，代码生成以下 logcat。第一个 dalvikvm-heap 增长（4738256 字节）可能用于 BitmapRegionDecoder 的数据，第二个（3603216 字节）匹配存储图像所需的内存量（800x1126x4）。还有一个skia错误。

```
 8522    LocationImageLoader  D  decodeBitmapRegion region=Rect(240, 77 - 1040, 1203), recycleBitmap=android.graphics.Bitmap@415319a8
  8522               dalvikvm  D  GC_FOR_ALLOC freed 8213K, 28% free 22782K/31623K, paused 34ms
  8522          dalvikvm-heap  I  Grow heap (frag case) to 26.808MB for 4738256-byte allocation
  8522               dalvikvm  D  GC_CONCURRENT freed 6K, 14% free 27403K/31623K, paused 3ms+7ms
  8522                   skia  D  WARNING: One-shot allocator has already allocated (alloc count = 1)
  8522               dalvikvm  D  GC_FOR_ALLOC freed 0K, 14% free 27403K/31623K, paused 33ms
  8522          dalvikvm-heap  I  Grow heap (frag case) to 30.238MB for 3603216-byte allocation
  8522               dalvikvm  D  GC_FOR_ALLOC freed 0K, 3% free 30922K/31623K, paused 41ms 
```

设置 options.inPreferredConfig = Bitmap.Config.RGB_565; 似乎否定了 Xoom 上的第二次分配，就好像位图被正确回收一样，但仍然为解码器分配了内存。

使用完整图像 (1280x1280) 和 BitmapFactory 进行回收虽然用于存储完整图像的内存比该区域所需的内存要多得多。

我不明白为什么 Xoom 不工作但宏碁很好，当两者都运行 Android 4.0.x 时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T03:32:15.977

我注意到在我的 Archos G9 80 (4.0.4) 上返回的位图使用的是 RGB8888，即使我请求了 RGB656。如果我解码一个 1024x1024 的正方形并在生成的位图上调用 getByteCount()，它会返回 4MB。即使我使用 RGB8888 传入一个位图，它仍然会分配一个新的。

如果您注意文档，它会说选项用于 inSampleSize，这似乎确实有效，但没有特别提到 inPreferredConfig 和 inBitmap 的使用。我想这意味着尊重 inPreferredConfig 和 inBitmap 取决于制造商或在 4.1+ 中添加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T18:29:26.500

你在回收recycleBitmap吗？

值得注意的是，有时回收的位图是某些操作中返回的实际位图，因此您不想回收它。然而，有时会实例化一个新的位图，在这种情况下您想要回收原始位图 - 假设在此方法的范围之外不再需要它。

# javascript - 背景图像在 IE 8 中不起作用

> ID：13476106
> 
> 赞同：0
> 
> 时间：2012-11-20T15:08:51.090
> 
> 标签：javascript, jquery, html, css

我正在尝试为 . 但它无法正常工作。在 Firefox 和 Chrome 中，图像出现了，但在 Internet Explorer Image not Showing 中。我在下面附上了我的站点链接和相关的css代码，任何人都可以帮助解决这个问题。在主页实时聊天部分。

[https://www.autobase.lk/](https://www.autobase.lk/)

```
#slideshow_ad{
    width:230px;
    height:240px;
    border:thin solid;
    border-color:#e1e1e1;
    background: white url('../banner/Chat-Banner.png') no-repeat top;
    float:right;
    margin:3px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:13:36.707

你能试着去掉顶部吗？

```
 background: white url('../banner/Chat-Banner.png') no-repeat; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:14:47.237

在您的 IE8 条件 css 上有一个白色背景

```
<!--[if IE 8]>
    <link href='http://www.autobase.lk/css/ie8.css' rel='stylesheet' type='text/css' />
    <link href='http://www.autobase.lk/css/directory_ie.css' rel='stylesheet' type='text/css' />
<![endif]--> 
```

你的代码

```
#slideshow_ad{
    width:230px;
    height:240px;
    border:thin solid;
    border-color:#e1e1e1;
    background: #fff;
    float:right;
    margin:3px;
} 
```

删除背景#fff

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:15:21.193

您的样式表似乎没有加载。

将 2 个标签替换为这些标签，并使用相对 url：

```
<link href="css/style.css" rel="stylesheet" type="text/css">
<link href="css/directory.css" rel="stylesheet" type="text/css"> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T15:22:12.810

尝试编辑这行代码

```
background:  url('../banner/Chat-Banner.png') no-repeat top #fff; 
```

到

```
background:  url('../banner/Chat-Banner.png') center top no-repeat #fff ; 
```

# c# - 拦截 ASP.NET MVC 4 响应生成

> ID：13476109
> 
> 赞同：0
> 
> 时间：2012-11-20T15:09:10.860
> 
> 标签：c#, asp.net-mvc, caching, asp.net-mvc-4

我需要做的是在 MVC 执行控制器之前和完成生成视图之后执行一些代码。有没有办法做到这一点？

我需要将 MVC 应用程序与现有的缓存系统集成，因此：

*   在执行控制器之前，实例化一个缓存。
*   生成视图后，销毁缓存。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:14:19.763

显而易见的答案是在 global.asax 中`Application_BeginRequest`还是`Application_EndRequest`我错过了什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:19:33.180

动作过滤器属性使您能够将代码拦截器注入到 MVC 控制器的请求中，该请求可以在控制器或其 Action 方法执行之前和之后执行。

有关更多详细信息，请参阅：[Scott Guthrie 的了解过滤器拦截器](http://weblogs.asp.net/scottgu/archive/2008/07/14/asp-net-mvc-preview-4-release-part-1.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:28:10.053

如果您想挂钩页面事件，您可能需要实现自己的[WebViewPage](http://msdn.microsoft.com/en-us/library/system.web.mvc.webviewpage%28v=vs.98%29.aspx)和[WebViewPage](http://msdn.microsoft.com/en-us/library/gg402107%28v=vs.98%29.aspx)类。具体来说，您需要装饰 Execute 方法。Phil Haack[有一篇](http://haacked.com/archive/2011/02/21/changing-base-type-of-a-razor-view.aspx)关于如何做到这一点的博客文章。

# mysql - mysql查询根据多个条件连接4个表

> ID：13476117
> 
> 赞同：4
> 
> 时间：2012-11-20T15:09:39.750
> 
> 标签：mysql, join

我在mysql中有四个表，如下所示：

![在此处输入图像描述](../Images/a85a49aa96b9563281227f90928e3c65.png)

![在此处输入图像描述](../Images/730d9eb63612e2137e3780380b86caa2.png)

我想要做的是将表格连接在一起以显示是否已为部门中的每个用户完成培训，如果已完成则显示培训日期，否则表示需要培训。

因此部门财务的期望输出将类似于：

![在此处输入图像描述](../Images/4aa770149b6819ccaa0245ed1c94d2e2.png)

我已尝试使用以下代码，但连接变得不准确且无效。

```
select o.person, o.job, j.risk, r. training,c.course,
    c.person,c.datecompleted 
from orgstructure o 
left outer join jobsrisks j 
    on o.job=j.job 
left outer join risktraining r 
    on j.risk=r.risk 
left outer join coursescompleted c 
    on o.person=c.person 
where o.department='finance' 
```

我应该将多个选择查询嵌入一个吗？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-20T15:17:22.053

我猜这个问题是你只加入了`orgstructure`，`coursescompleted`我`person`认为你还需要参加培训：

```
select o.person, 
  o.job, 
  j.risk, 
  r.training,
  c.course,
  c.person,
  c.datecompleted 
from orgstructure o 
left outer join jobsrisks j 
  on o.job=j.job 
left outer join risktraining r 
  on j.risk=r.risk 
left outer join coursescompleted c 
  on o.person=c.person 
  and r.training = c.course   --- add this
where o.department='finance' 
```

如果该人已完成与工作相关的每种风险的课程，则您需要加入该人。

将整个查询放在一起，您将拥有：

```
select o.person, 
  o.job, 
  j.risk, 
  r.training,
  case when c.course is null then 'no' else 'yes' end TrainingCompleted,
  coalesce(c.datecompleted, 'n/a') datecompleted
from orgstructure o 
left outer join jobsrisks j 
  on o.job=j.job 
left outer join risktraining r 
  on j.risk=r.risk 
left outer join coursescompleted c 
  on o.person=c.person 
  and r.training = c.course   
where o.department='finance' 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/c1110/7)

结果是：

```
|        PERSON |        JOB |                     RISK |                  TRAINING | TRAININGCOMPLETED |       DATECOMPLETED |
-------------------------------------------------------------------------------------------------------------------------------
| taylor chetty |    manager |                   safety |          induction course |                no |                 n/a |
| taylor chetty |    manager |                 security |           security course |                no |                 n/a |
| bill thompson | data clerk |              bad posture | personal wellbeing course |                no |                 n/a |
| bill thompson | data clerk | repetitive strain injury |            nursing course |               yes | 2000-04-13 00:00:00 |
| bill thompson | data clerk |                   safety |          induction course |               yes | 2007-12-04 00:00:00 |
|     ann brown | data clerk |              bad posture | personal wellbeing course |                no |                 n/a |
|     ann brown | data clerk | repetitive strain injury |            nursing course |                no |                 n/a |
|     ann brown | data clerk |                   safety |          induction course |                no |                 n/a | 
```

# wordpress - Flexslider startAt 属性 - 需要什么？

> ID：13476119
> 
> 赞同：1
> 
> 时间：2012-11-20T15:09:45.800
> 
> 标签：wordpress, flexslider

我有 flexslider 在带有自定义导航的 WordPress 网站上工作。但是，我无法让 startAt 属性工作。它总是从第一张幻灯片开始。我已经根据 Woo Flexslider 页面和 github 上的内容尝试了许多修改。没运气。

这是我的javascript：

```
<script type="text/javascript" charset="utf-8">
  jQuery(window).load(function() {
  jQuery(".flexslider").flexslider({
  slideshow: false, 
  controlNav: true, 
  directionNav: true, 
  controlsContainer: ".slider-controls",
  manualControls: ".flex-control-nav li",
  startAt: 3'
  });
});
</script> 
```

我错过了什么吗？

# asp.net - 计时器滴答时停止 Reportviewer 刷新

> ID：13476121
> 
> 赞同：0
> 
> 时间：2012-11-20T15:09:55.820
> 
> 标签：asp.net, visual-studio-2010, reporting-services

我正在尝试使用 asp.net 在 vs2010 中创建报告主机。这是我第一次尝试进行 Web 开发，所以我可能犯了一个非常明显的错误。最终目标是主机不仅向用户显示报告，而且还跟踪他们查看报告的时间。但是，我无法解决这个烦人的问题，即每次我的计时器滴答作响时，都会重新绘制报告。

我有一个 UsageAuditor 控件，它只是一个带有计时器和标签的更新面板：

```
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
<ContentTemplate>
    <asp:Timer runat="server" ID="Timer1" Interval="3000" OnTick="Timer1_Tick"/>
    <asp:Label ID="lblTime" runat="server" Text="Not updated yet"></asp:Label>
</ContentTemplate> 
```

然后我的报告外壳使用该控件：

```
<body>
<form id="form1" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server"/>
    <uc1:UsageAuditor ID="ua1" runat="server" />
    <rsweb:reportviewer ID="reportViewer" runat="server"  Font-Names="Verdana" 
        Font-Size="8pt" InteractiveDeviceInfos="(Collection)" ProcessingMode="Remote" 
        WaitMessageFont-Names="Verdana" WaitMessageFont-Size="14pt" 
        Height="800px" Width="1000px" AsyncRendering="True">            
    </rsweb:reportviewer>
</form>
</body> 
```

计时器滴答只是更新标签：

```
protected void Timer1_Tick(object sender, EventArgs e)
{
    lblTime.Text = String.Format("Updated at {0}", DateTime.Now.ToString());
} 
```

所以我想通过在 UpdatePanel 之外定义我的 ReportViewer，UpdatePanel 会自己重绘，但页面的其余部分不会更新。但是，每次计时器滴答作响时，它都会重新绘制报告。这很烦人，因为如果您在报表上打开日历控件，它会关闭它。目前出于测试目的，计时器每三秒滴答一次，这是不现实的，但我仍然不希望在用户尝试使用它时重绘报告控件，而不管时间间隔如何。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:56:05.620

好吧，我发现一个帖子说[ReportViewer 和 UpdatePanel 不要混合](http://social.msdn.microsoft.com/Forums/en-US/vsreportcontrols/thread/3c555eb9-6bc2-4155-8233-67462d45fdd1)：

> 由于报表查看器使用脚本的方式，它目前与 UpdatePanel 不兼容。我们已经意识到这个问题，并研究了使 ReportViewer 在 UpdatePanel 中工作的必要更改。但目前，没有变通办法。虽然看起来您可以在这种情况下获得简单的报表，但一些更微妙的报表查看器行为仍然会被破坏，例如当浏览器窗口保持打开状态时保持报表会话处于活动状态的代码。

在阅读了 puddleglums 的建议后，我思考了为什么我觉得我需要使用计时器来更新我的使用信息。如果我可以捕获用户离开页面的时间，那么间隔更新确实是不必要的。

在[这个示例](http://codeasp.net/blogs/raghav_khunger/microsoft-net/609/calling-codebehind-or-server-side-code-on-page-unload)之后，我添加了一些 java 脚本来在关闭时调用服务器端函数：

```
<script type="text/javascript">
    //<![CDATA[
    function HandleClose() {
        var QAid = document.getElementById('QAReportRequest');
        PageMethods.SetReportViewEndTime(QAid.value);
    }
    //]]> 
</script> 
```

在我的正文中添加了 onunload 和 hidden 类型的 HandleClose 调用：

```
<body onunload="HandleClose()">
  <form id="form1" runat="server">
  <input id="QAReportRequest" type="hidden" runat="server"/>
  <asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true"/>
  <rsweb:reportviewer ID="reportViewer" runat="server" Font-Names="Verdana" 
    Font-Size="8pt" InteractiveDeviceInfos="(Collection)" ProcessingMode="Remote" 
    WaitMessageFont-Names="Verdana" WaitMessageFont-Size="14pt" 
    Height="800px" Width="1000px">
  </rsweb:reportviewer>          
  </form>
</body> 
```

然后创建了一个服务器端函数：

```
 [WebMethod]
    public static void SetReportViewEndTime(string ID)
    {
        QAReportingManager manager = new QAReportingManager();
        QAReportUsageResponse element = manager.GetQAReportUsage(long.Parse(ID));
        QAReportUsageRequest request = new QAReportUsageRequest
        {
            ID = element.ID,
            userID = element.userID,
            userName = element.userName,
            reportName = element.reportName,
            startTime = element.startTime,
            endTime = DateTime.Now,
            department = "Unknown"
        };
        manager.SaveQAReportUsage(request);
    } 
```

# c# - Caliburn Micro 对话窗口的宽度/高度被任意设置

> ID：13476124
> 
> 赞同：2
> 
> 时间：2012-11-20T15:10:10.027
> 
> 标签：c#, .net, wpf, caliburn.micro

我在使用 Caliburn micro 的窗口管理器时发现的奇怪问题。

我有以下代码显示一个对话框窗口

```
sendLogicDialogViewModel.Initialize(CompiledCodeList);
dynamic settings = new System.Dynamic.ExpandoObject();
settings.WindowStartupLocation = WindowStartupLocation.CenterScreen;

windowManager.ShowDialog(sendLogicDialogViewModel, null, settings); 
```

哪个完美..但由于某种原因，它与视图在 XAML 中的窗口高度声明有关。我做了一个非常简单的观点来证明我的观点：

```
<Window x:Class="DDCLogicInstaller.SendLogicDialogView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="{Binding Title}"
        xmlns:cal="http://www.caliburnproject.org"
        cal:Bind.Model="DDCLogicInstaller.SendLogicDialogViewModel"
        >
    <Button Content="300" Height="100" Width="100"/>
</Window> 
```

这是我希望在对话框窗口中看到的（这是它在 Visual Studio 的设计视图中显示的）

![在此处输入图像描述](../Images/c9c8e4141ca5507b9f76631855960660.png)

但相反，这就是我得到的：

![在此处输入图像描述](../Images/e37f9a32657ca82c5e39cd0809a0b429.png)

是什么赋予了？为什么随意设置对话窗口的高度/宽度？我必须在 windowManager 中设置一些设置吗？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T19:23:34.223

您可以将`SizeToContent="WidthAndHeight`" 添加到您的根`Window`元素中`SendLogicDialogView`，或将其作为另一个设置传递。

此行为并非特定于 Caliburn.Micro，它是标准的 WPF 行为，当 a`Width`和`Height`未在上指定`Window`并且`SizeToContent`设置为`Manual`（默认值）时，窗口将具有默认宽度和高度。

# objective-c - 将按钮添加到滚动视图时未调用操作

> ID：13476128
> 
> 赞同：0
> 
> 时间：2012-11-20T15:10:14.057
> 
> 标签：objective-c, xcode, uiscrollview, uibutton

我添加到滚动视图的按钮有一个奇怪的行为。

```
 for (UIView *subview in self.scrollView.subviews) {
        [subview removeFromSuperview];
    }
    //Create and place info Button(s)
    for (int i = 0; i < BigPictures.count; i++) {
        UIButton *infoButton = [[UIButton alloc] initWithFrame:CGRectMake(scrollView.frame.size.width*(i+1) - 29 - 5 - 10, scrollView.frame.size.height - 29 - 5, 29, 29)];
        [infoButton addTarget:self action:@selector(flip) forControlEvents:(UIControlEvents)UIControlEventTouchUpInside];
        //[infoButton setEnabled:YES];
        //[infoButton setUserInteractionEnabled:YES];

        [self.scrollView addSubview:[FrontViews objectAtIndex:i]];
        [infoButton setBackgroundImage:[UIImage imageNamed:@"btn_image-info.png"] forState:UIControlStateNormal];
        [scrollView addSubview:infoButton]; 
```

BigPictures 包含我想在滚动视图中显示的所有图像。现在到奇怪的事情。如果 BigPictures 包含 1 个图像，则调用动作（翻转）。只要 [BigPictures count] > 1，第一张图片上的按钮就不会执行操作，但所有其他按钮（第 2-n 页）都会执行。所以这怎么可能？？

即使我改变`for (int i = 0; i < BigPictures.count; i++)`了`for (int i = 0; i < 1; i++)`，按钮也可以工作。

那么我错过了什么？已经尝试过类似的东西

```
scrollView.delaysContentTouches = NO;
scrollView.canCancelContentTouches = NO; 
```

但后一个禁用滚动视图的滚动。

编辑：我尝试将其他按钮放在不同的位置，但它们都不能在第一页上工作（如果页面 > 1）。还尝试放置一个 GestureRecognizer。这有效，`if ([touch.view isKindOfClass:[UIButton class]])`但未检测到下方的按钮。在滚动视图的其他页面上一切正常。真的很奇怪。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T14:07:55.140

做了一个完整的重建，现在它可以工作了。真的很奇怪，因为我使用了完全相同的代码。

# mysql - MYSQL 表中的约束？

> ID：13476129
> 
> 赞同：0
> 
> 时间：2012-11-20T15:10:15.953
> 
> 标签：mysql, sql, rdbms, database

我有一个名为**Groups**的表`primary key = Pkey`。在 Group 中有一个递归关联**Parent_group**引用*Pkey*。我将 Parent_Group 定义为关系*Groups*中的外键。我正在使用 MYSQL。

表类：**组**

```
+------+-----------+------------+----------+---------------+            
| PKey | GroupName | Region     |  Role    | Parent_Group  |
+------+-----------+------------+----------+---------------+            
| k1   | RootGroup | Jaipur     |  Admin   | NULL          | 
+------+-----------+------------+----------+---------------+            
| k2   | G2        | Alwar      |  Admin   | k1            |
+------+-----------+------------+----------+---------------+            
| k3   | G3        | Jaipur     |  Guest   | k3            | 
+------+-----------+------------+----------+---------------+            
| k4   | G4        | Alwar      |  Operator| k2            |
+------+-----------+------------+----------+---------------+ 
```

创建表的查询：

```
CREATE TABLE IF NOT EXISTS `groups` 
(
  `PKey` varchar(64) NOT NULL,
  `group_name` varchar(64) DEFAULT NULL,
  `Region` varchar(128) NOT NULL,
  `Role` varchar(128) NOT NULL,
  `parent_group` varchar(64) DEFAULT NULL, 
  PRIMARY KEY (`Pkey`),
  KEY `FK_ParentGroup_ChildGroup` (`parent_group`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

该`Groups`表将与我的应用程序一起提供，只有一个`RootGroup`元组。

`I want to impose two constraints on table?`如下 ：

1.  新插入的行不能有`Parent_group`列的 NULL 值
2.  添加一个约束，使该`RootGroup`行不能被删除。

我想知道，天气可能在 SQL 中（如果`yes`如何？）或者我必须在后端系统中处理？

可以用触发器吗？

**编辑**：我想对表施加额外的约束，以便新的插入元组不能指向自身。例如

```
mysql> INSERT INTO Employee VALUES ("8", "H", "BOSS",   "8");
Query OK, 1 row affected (0.04 sec) 
```

**应该失败**吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T13:36:16.407

关于您希望施加的两个约束，有几件事：

1.  Parent_group 列的新插入行不能有 NULL 值。

    *   仅当列包含所有非空值时，才能对列施加 NOT NULL 约束。您需要在此列中为根节点设置一个空值。
    *   为此，您可以使用 CHECK 约束。[在此处](http://www.w3resource.com/mysql/creating-table-advance/create-table-to-check-values-with-check-constraint.php)阅读有关检查约束的更多信息。
    *   你可以把

> 检查 ((peky= AND parent_group IS NULL)
> OR
> (peky!= AND parent_group IS NOT NULL))

这将只允许根节点使用 NULL 值，并对表中的每个其他行强制使用 NOT NULL 值。

2.  添加一个约束，使 RootGroup 行不能被删除。

    *   如果您已经在`parent_group`和之间定义了外键`pkey`，数据库将自动强制执行参照完整性并禁止删除根节点（或任何父节点）。如果在任何父节点或根节点上尝试删除，数据库将返回错误。
3.  对于**EDIT**部分中提到的点，您可以在表上放置一个简单的检查约束，例如
    `CHECK (parent_group != pkey)`. 这应该为您完成这项工作。

阅读有关如何定义外键约束以及如何使用它们来强制引用完整性的信息。另外，在应用这些建议之前，请先浏览我在上面或[此处发布的链接。](http://www.w3resource.com/mysql/creating-table-advance/create-table-to-check-values-with-check-constraint.php)

# javascript - Javascript平均数组

> ID：13476130
> 
> 赞同：5
> 
> 时间：2012-11-20T15:10:20.010
> 
> 标签：javascript

这是我的第一篇文章。我正在编写一个程序来从四个输入框中获取输入，找出这四个的总和并找到平均值。当我这样做时，我得到一个 NaN 错误，有人可以指出我哪里出错了。谢谢

```
<html>
<head>
<title> Average marks </title>

<script type = "text/javascript">

function average(form)
{

scores = new Array(4)

scores [0] = form.mark1.value
scores [0] = new Number(scores[0])
scores [1] = form.mark2.value
scores [1] = new Number(scores[1])
scores [2] = form.mark3.value
scores [2] = new Number(scores[2])
scores [3] = form.mark4.value
scores [3] = new Number(scores[3])

var Sum = 0
var average

for(var x = 0; x < scores.length; x ++)
{
Sum = Sum + scores[x]
average = Sum / scores[x]
}

document.write("The sum of the marks is equal to " + Sum + "<br>")
document.write("The average of these marks is equal to " + average + "<br>")

}

</script>

</head>

<body>

<form>
Enter the first mark : <input type = "text" name="mark1"> <br>
Enter the second mark : <input type = "text" name="mark2"> <br>
Enter the third mark : <input type = "text" name="mark3"> <br>
Enter the fourth mark : <input type = "text" name="mark4"> <br>

<input type = "submit" value = "submit" onclick="average(this.form)">
</form>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T15:22:17.297

欢迎来到 Stackoverflow :) 我们很乐意帮助您，同时更好地学习我们的工具。关于算法的一个注释：将平均计算命令移到循环之外：

```
for(var x = 0; x < scores.length; x ++)
{
  Sum = Sum + scores[x];  //or Sum += scores[x];
}

average = Sum / scores.length;  //length of the array scores is in scores.length 
```

我会使用`parseInt()`而不是`new Number()`因为`new Number()`创建一个对象，同时`parseInt()`给你实际的文字值作为结果。（更好的性能）。

顺便说一句，`var`除非您希望全局访问它们（坏主意），否则不要忘记在每个变量定义之前放置。你在所有变量上都做得很好，除了`scores`. 定义应该是`var scores`虽然这不是这个错误的来源。

还有一点：你可以检查`parseInt()`使用`isNaN()`函数的结果。如果您的数字可以有小数点，您还可以使用`parseFloat()`：

*   [解析整数（）](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)

*   [解析浮动（）](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseFloat)

如果从字符串到数字的转换失败，这两个函数的结果都是 NaN（不是数字）。

最后，我认为定义具有指定长度的数组是个好主意。它提高了代码的可读性。然而，在 Javascript 中没有必要，因为它会在运行时自动增加/减少数组的长度，因此您不必提前决定它应该多长。它可能是好事也可能是坏事，这取决于你如何使用它。但一般情况下，您可以使用`var myarr=[];`而不是`var myarr= new Array();`. 但是，当您想提示其他开发人员发生了什么时，您也可以指定数组长度：`var myarr=new Array(4);`.

最后一点使用 Stackoverflow：请接受最佳答案并“投票”其他有用的答案。这样，您将获得分数和其他人。

祝你好运

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:19:29.797

你没有以正确的方式平均......你从总和（循环*外*）除以标记数得到平均值。

还：

1.  不要使用`new Array(4)`. 在 JavaScript 中预定义数组长度是不必要的（并且会损害可读性和性能）。
2.  永远不要使用`new Number()`。这会创建一个`Number` *object*，这是一件可怕的事情，会在某个时间点造成严重破坏。用来施法`Number(yourString)`。
3.  我强烈建议您在语句的末尾加上分号。
4.  `scores`未声明。（请开启严格模式！）

无论如何，这可能是这样的：

```
function average(form) {
    var scores = [ // Array literal!
        Number(form.mark1.value), // You could also use a leading +
        Number(form.mark2.value),
        Number(form.mark3.value),
        Number(form.mark4.value)
    ];

    var sum = 0;

    for(var i = 0; i < scores.length; i++) {
        sum += scores[i];
    }

    var average = sum / scores.length;

    // etc.
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:18:36.700

你建立你的分数数组的方式是不必要的复杂。你可以这样做：

```
scores [0] = form.mark1.value;
scores [1] = form.mark2.value;
scores [2] = form.mark3.value;
scores [3] = form.mark4.value; 
```

那么你的平均计算有误。计算平均值的正确方法是将所有值相加，然后将它们除以值的数量一次。

```
for(var x = 0; x < scores.length; x ++)
{
    Sum = Sum + scores[x];
}
average = Sum / scores.length; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-19T04:57:04.937

要找到平均第一个计算和（例如通过[reduce](https://developer.mozilla.org/pl/docs/Web/JavaScript/Referencje/Obiekty/Array/Reduce)），然后除 - 就是这样

```
var Sum = scores.reduce((a,b)=> a+b);    // calculate sum
var average = Sum/scores.length;         // divide by number of elements 
```

```
<html>
<head>
<title> Average marks </title>

<script type = "text/javascript">

function average(form)
{

scores = new Array(4)

scores [0] = form.mark1.value
scores [0] = new Number(scores[0])
scores [1] = form.mark2.value
scores [1] = new Number(scores[1])
scores [2] = form.mark3.value
scores [2] = new Number(scores[2])
scores [3] = form.mark4.value
scores [3] = new Number(scores[3])

var Sum = scores.reduce((a,b)=> a+b);
var average = Sum/scores.length;

document.write("The sum of the marks is equal to " + Sum + "<br>")
document.write("The average of these marks is equal to " + average + "<br>")

}

</script>

</head>

<body>

<form>
Enter the first mark : <input type = "text" name="mark1"> <br>
Enter the second mark : <input type = "text" name="mark2"> <br>
Enter the third mark : <input type = "text" name="mark3"> <br>
Enter the fourth mark : <input type = "text" name="mark4"> <br>

<input type = "submit" value = "submit" onclick="average(this.form)">
</form>

</body>
</html>
```

# jquery - 在 iPad 中将内容放入 Video Js 全屏帧中

> ID：13476133
> 
> 赞同：1
> 
> 时间：2012-11-20T15:10:24.940
> 
> 标签：jquery, css, html, html5-video

我正在为 iPad 设置一个视频 js 播放器，在播放完视频后，会弹出一个 img。我可以在没有全屏的情况下进行这项工作，但 iPad 用户往往只想在观看视频时使用全屏。因此，我试图弄清楚如何在视频完成时将 img 内容推送到全屏帧内，而不必退出全屏以查看图像。这可能吗？

这是我到目前为止的代码：

```
<link href='http://fonts.googleapis.com/css?family=Petit+Formal+Script' rel='stylesheet'         type='text/css'>

<style type="text/css">

body {
background-color: #EAEAEA;  
}
.style2 {font-size: 24px}
div#showdiv {
        background-image:url('BackGround.png');
        width:800px; 
        height:446px;
}
textarea#tweet {
                background:transparent;
            border:transparent; 
            float:left; 
                font-weight: bold;
                font-size:170%;
                margin-left:100px;
                margin-right:100px;
                margin-top:30px;
                width:600px;
                height:600px;
                opacity:0.7;
                color:660000;
                font-family: 'Petit Formal Script', cursive;
}
</style></head>

<body>
<div id = "okaydiv"></div>

<div align="center">
      <p>
    <div id = "showdiv" style="display:none" align="center">
        <p>
            <textarea cols="50" rows="5" id="tweet" >this is the text over     image</textarea>
        </p>
</div>
<video id='myVideo' align="center" class='video-js 
    vjs-default-skin' preload='auto' data-setup='{}' 
    poster='thumb.png' width='800' height='446' controls autobuffer>
<source src='vid.mp4' type='video/mp4'l></source>
    <source src='vid.ogg' type='video/ogg'></source>
    <source src='vid.webm' type='video/webm'>

</div>
<script src="http://code.jquery.com/jquery-latest.js"></script>

    <script type='text/javascript'>
    var toggleFx = function() {
    $.fx.off = !$.fx.off;
    };
    toggleFx();

    document.getElementById('myVideo').addEventListener('ended',myHandler,false);

    function myHandler(e) {
        if(!e) { e = window.event; }
        // What you want to do after the event
        $("#myVideo").toggle("slow");
        $("#showdiv").toggle("slow");
        //document.getElementById('okaydiv').innerHTML = "<img src = 'cleanscreen.png'/>";
    }
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T19:45:13.930

鉴于当 iPad 用户按下全屏按钮时，视频文件会在原生 iOS 视频播放器中打开，您将无法在该播放器内部单独“弹出”图像“不再在网络浏览器中。

不幸的是，当涉及到他们自己的原生应用程序时，iOS 非常锁定，所以我认为你无法在视频结尾提示事件以关闭 ipad 或 iphone 上的全屏，但如果你有它可以让您在用户关闭全屏模式（即关闭本机视频播放器）时看到正在显示的图像，那么另一种方法可能是创建一些一致性并将现在显示在网站上的图像作为最后一帧插入正在播放的视频。这样，当用户返回浏览器时，他们会看到一些熟悉的东西。

# asp.net - Asp:DropDownList 仅显示第 90,337 个项目

> ID：13476135
> 
> 赞同：0
> 
> 时间：2012-11-20T15:10:29.840
> 
> 标签：asp.net, drop-down-menu, truncate, items

我们有一个从数据库存储过程中填充的下拉列表。存储过程返回 94,060 行。子例程将所有 94,060 项添加到 DropDownList。但是，在运行应用程序时，下拉列表仅显示前 90,337 个项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:20:18.583

它可能受到您的浏览器或计算机的限制，两者都可以加载到内存中并仍然运行的限制。

尝试在其他人的计算机上加载页面，并在页面上显示从 SP 返回的项目计数，以确保也返回正确的数量。

所以在页面上，让 SP 返回行数，以及下拉列表项数，看看它是否因计算机而异。

还要对所发表的评论 +1，90k+ 项不应出现在下拉列表中，永远。

**下拉的替代方案**

可搜索的数据列表，很像 Outlook 收件人添加中的一个。

![在此处输入图像描述](../Images/bd7776a3eeefb025e40bf54509872198.png)

自动完成（将您的 SP 结果放入数据表 i 中，然后使用 jquery 搜索）

[ASP JQuery 自动完成](http://blogs.msdn.com/b/josephkiran/archive/2011/02/25/jquery-asp-net-server-control-dropdown-autocomplete-sample.aspx)

# ruby-on-rails - 使用 AWS Elastic Beanstalk 和 Ruby 容器设置私有 Github 访问

> ID：13476138
> 
> 赞同：29
> 
> 时间：2012-11-20T15:10:41.310
> 
> 标签：ruby-on-rails, ruby, amazon-web-services, amazon-elastic-beanstalk

通过最近关于使用 Git 为 Ruby 部署设置 AWS Elastic Beanstalk 的[教程，我刚刚从我的 CI 服务器设置了一个 Elastic Beanstalk 环境。](http://ruby.awsblog.com/post/Tx2AK2MFX0QHRIO/Deploying-Ruby-Applications-to-AWS-Elastic-Beanstalk-with-Git)但是，应用程序无法启动。我浏览了日志，发现`bundle install`失败并显示错误消息。

> 获取 git@github.com:example/private-repository.git 主机密钥验证失败。致命：远程端意外挂断[31mGit错误：`git clone 'git@github.com:example/private-repository.git' "/var/app/ondeck/vendor/cache/ruby/1.9.1/cache/bundler/git/private-repository-e4bbe6c2b13bb62664e39e345c1b01d80017934c" --bare --no-hardlinks`目录/var/app/ondeck中的命令失败。[0m

`Gemfile`我的 Rails 应用程序包含对托管在我在 Github 上的几个私有存储库中的 gemified 插件的引用。就像是

> gem 'somegemname', :git => 'git@github.com:example/private-repository.git'

我在 Capistrano 部署中遇到过类似的问题，这些问题通过设置`ssh_options[:forward_agent] = true`.

AWS Elastic Beanstalk Ruby 容器支持通过`.config`放置在`.ebextensions`. 在这种情况下，设置 SSH 转发代理会有所帮助吗？在启动 Elastic Beanstalk 环境时，是否有其他替代方法可以访问私有 Github 存储库？

更新 1：我刚刚检查了`bundle install`启动 a 的用户。发现脚本以用户身份`/opt/elasticbeanstalk/hooks/appdeploy/pre/10_bundle_install.sh`启动。我尝试在下创建一个 SSH 密钥，并将它的 pub-key 添加到该存储库的 Github Deploy 密钥中。到目前为止没有运气。现在将尝试将 SSH 发布密钥添加到我在 Github 上的用户帐户，以便它适用于通过我的 Github 帐户访问的所有私有存储库。`bundle install``root``/root/.ssh`

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2015-08-11T15:31:16.347

经过一天的努力，我终于通过使用一个`.config`文件来启用我组织的私有 GitHub 存储库和 Elastic Beanstalk。我正在使用 Python 和`pip`，但它也应该适用于 EB 上的其他包安装程序。

rhetonik 的`ssh-agent`+`ssh-add`方法对我根本不起作用，所以我选择设置一个 ssh 配置文件。

这是我的`.ebextensions/3-pip-install-from-github.config`文件：

```
files:
    "/root/.ssh/config":
        owner: root
        group: root
        mode: "000600"
        content: |
            Host github.com
                User git
                Hostname github.com
                IdentityFile /root/.ssh/github

commands:
    01-command:
        command: sudo ssh-keyscan -H github.com >> /root/.ssh/known_hosts
    02-command:
        command: sudo chmod 644 /root/.ssh/known_hosts
    03-command:
        command: sudo aws s3 cp s3://bucket-with-your-github-ssh-key/github /root/.ssh
    04-command:
        command: sudo chmod 600 /root/.ssh/github 
```

粗略说明：

*   [设置您的 EB 实例可访问的 S3 存储桶](https://stackoverflow.com/questions/21653176/grant-s3-access-to-elastic-beanstalk-instances)。`pip`在该存储桶中，存储 SSH 密钥，以允许通过、`npm`、`bundle`等访问您想要访问的 GitHub 存储库。用于`sudo aws s3 cp`在部署时将该密钥复制到您的 EB 实例上。`sudo`是必要的，因为 EB 脚本使用`root`而不是`ec2-user`.

*   此 ebextensions 配置文件还在您的 EB 实例上创建 2 个文件。`/root/.ssh/config`告诉（由and`ssh`调用）使用从 S3 复制的密钥。存储into的输出将预先验证您的 EB 实例上实际上正在与 GitHub 通信以避免 MITM 攻击。这比禁用.`pip``git``ssh-keyscan -H github.com``/root/.ssh/known_hosts``ssh``StrictHostKeyChecking``/root/.ssh/config`

这是我的`requirements.txt`文件`pip`：

```
Beaker==1.7.0
Flask==0.10.1
Jinja2==2.7.3
MarkupSafe==0.23
# [...]
git+ssh://git@github.com/myorganization/myprivaterepo.git@0.0.142 
```

运行`eb-deploy`时，您可以`tail -f /var/log/eb-activity.log`确保一切顺利。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-22T07:23:06.047

这就是我最终做到的方式。这一切都是为了为负责`bundle install`阶段的用户设置一个 SSH 密钥。

1.  在 AWS Elastic Beanstalk 中为应用程序启动环境
2.  *可选*- 登录到 Amazon EC2 控制台并将实例类型更改为所需值
3.  更新 SSH 密钥对名称以启用远程 SSH 登录。（我确信在启动环境时必须有一种方法来指定实例类型和 SSH 密钥对名称）
4.  在 EC2 控制台或通过 CLI 查找新启动的实例，记下此实例的*完全限定域名 (FQDN)*。EB 实例与您使用 Amazon EC2 创建的任何其他实例一样。通过 SSH 登录到此实例。
5.  执行以下命令为`root`用户 创建 SSH 密钥

    > $ sudo su - 根
    > 
    > $ ssh-keygen -t rsa -C "some-email@yourdomain.com"

6.  编辑`.bash_profile`以显式启动`ssh-agent`并添加新生成的 SSH 密钥。添加以下几行（这似乎没有必要，我这样做只是为了确定）

    > eval `ssh-agent
    > 
    > 评估`ssh-add ~/.ssh/id_rsa`

7.  注意 SSH 公钥，例如：`~/.ssh/id_rsa.pub`并将其添加到可以访问私有存储库的 Github 帐户的 SSH 密钥集中

8.  此时，您的实例可以访问您的私有 Github 存储库。`git clone`您可以通过以用户身份登录在这些存储库上发出 a 来测试这一点`root`。

9.  使用标准方法从此实例创建 AMI

10.  回到您的 AWS Elastic Beanstalk 仪表板并在您的应用程序环境中寻找`Edit Configuration`选项。在`Server`选项卡中，查找可让您指定`Custom AMI`. 使用新创建的 AMI ID 更新此字段，例如：`ami-4324fd4`。

11.  点击保存配置`Apply Changes`。AWS Elastic Beanstalk 将开始在您的环境中部署新实例并终止旧实例。这是为了确保您的所有自动扩展实例都具有私有 Github 访问所需的列入白名单的 SSH 密钥。

完成上述步骤后，您可以继续部署 Rails 应用程序`git aws.push`

希望这可以帮助其他陷入困境的人。不过，我很高兴看到比这个更优雅的解决方案。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-06-11T14:42:11.110

如果您赶时间，并且您的应用程序存储库也是私有的，您可以创建一个额外的 Github 用户帐户并将其分配给包含 gem 的存储库的只读权限。

然后为 bundler 提供带有新帐户凭据的 https url：

```
gem 'somegemname', git: "https://username:password@github.com/example/privaterepository" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T15:35:51.563

使用 GitHub 进行身份验证有两种方法。无论哪种情况，我都建议将您的个人 GitHub 帐户与私有 GitHub 存储库相关联。

第一种方法传递您在本地用于从远程 GitHub 存储库推送、拉取等的相同 ssh 凭据——您为您的个人帐户上传了您的公钥，这就是 GitHub 使用的。要在另一台服务器上运行时使其工作，您需要`ssh-agent`运行并使用`ssh-add`将您的密钥添加到代理 - 然后您的个人 GitHub 凭据可用于执行 git 命令。

第二种方法是允许您部署的远程服务器访问 GitHub——这可能是弹性 beanstalk 或您的实际服务器。在服务器上创建一个无密码的 ssh 密钥（`ssh-keygen -t rsa`接受默认值，或者 EB 可能有自己的方式）然后复制生成的公钥内容并在您的 GitHub 存储库中创建一个包含该密钥的新“部署密钥”——您将需要是管理员，我假设你是。已安装的部署密钥将允许 EB 用户登录远程服务器并从服务器执行`git pull`相关命令（只读）。

我认为随着您要部署到的服务器数量的增长，第一种方法更优雅且更易于管理，但您使用哪种方法可能取决于 EB 的选项。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-07-26T15:55:19.880

从您的 requirements.txt 文件中删除私有 github 存储库，并创建一个脚本以使用用户名和密码的环境变量来安装它们。

文件：**project-root/install-extra-requirements.sh**

```
#!/bin/sh

source /opt/python/run/venv/bin/activate
python ".extra-requirements.py" 
```

文件：**project-root/.extra-requirements.py**

```
import os

def main():
    github_username = os.environ['GITHUB_USERNAME']
    github_password = os.environ['GITHUB_PASSWORD']
    repository = "git+https://%s:%s@github.com/yourgithubrepo" % (github_username, github_password)
    os.system("pip install %s" % repository)

if __name__ == '__main__':
    main() 
```

文件：项目根/.ebextensions/002_container.config

```
container_commands:
  01_install_extra_requirements:
    command: './install-extra-requirements.sh' 
```

现在您可以在弹性 beanstalk 环境中将 GITHUB_USERNAME 和 GITHUB_PASSWORD 设置为环境变量。

# django - 美味派：如何为用户添加权限？

> ID：13476139
> 
> 赞同：0
> 
> 时间：2012-11-20T15:10:42.497
> 
> 标签：django, tastypie

我正在用 django-tastypie 构建一个 IOS 应用程序。用户的默认权限只是“获取”某些东西。但是，可以授予用户“添加”权限以发布内容。如何设计tastepie的api？如何使用 django-tastypi 向用户授予权限？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:49:56.143

首先，我想指出身份验证和授权之间的细微差别，这让我在之前使用 sweetpie 时感到困惑：

*   **身份验证**意味着“向我证明你就是你声称的那个人”——即某种形式的密码登录或 API 密钥
*   **授权**的意思是“现在我知道你是谁了，让我看看你有什么样的权限 - 即让我看看你属于哪个用户组/为你的用户帐户授予了哪些特定权限等。

现在，考虑到这一点，如果您还没有，请查看[此处非常简洁的示例。](http://django-tastypie.readthedocs.org/en/latest/authentication_authorization.html#authentication-authorization)

例如，您可以通过以下方式将用户限制为只能访问他们自己的用户信息：

```
# REST endpoint for authenticating user accounts
class UserResource(ModelResource):

    class Meta:
        queryset = User.objects.all()
        resource_name = 'auth/user'
        authentication = BasicAuthentication()
        authorization = DjangoAuthorization()

    def apply_authorization_limits(self, request, object_list):
        return object_list.filter(username=request.user) 
```

下面是在与视图交互时如何验证用户身份的片段：

```
# first check that the user is allowed to post
username = form.cleaned_data['username']
password = form.cleaned_data['password'] # @todo: remove this for production
user = authenticate(username=username, password=password)
if user is None:
    raise Http404('Error: new_frame: invalid username / password')
if not user.is_active:
    raise Http404('Error: new_frame: your account is inactive')
# username / password is correct + user is active, proceed with posting 
```

# jquery - 如果不是 iPad，则运行代码

> ID：13476142
> 
> 赞同：0
> 
> 时间：2012-11-20T15:10:59.400
> 
> 标签：jquery, html, ipad, user-agent

```
if ( (navigator.userAgent.indexOf('/iPadi') != -1) ) {

} 
```

**我使用这个 if 语句来检测用户代理是否是 iPad，但如果它不是**iPad ，我只想运行代码。我有 JQuery 悬停，我想在除 iPad 之外的所有情况下使用，我想在其中使用触摸手势。在这种情况下，我会将`hover()`函数放入 if 语句中，仅当**不是**iPad 时才运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:13:05.120

在我的项目中，我使用它并且它有效。不需要正则表达式：

```
 if ( navigator.userAgent.indexOf('iPad') == -1 )
  {

  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:12:22.143

你想使用正则表达式。

`if ( (navigator.userAgent.match(/iPad/i) <= 0) ) {`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T16:00:56.963

该语句也可以完成这项工作：

```
var isIpad = navigator.userAgent.match(/iPad/i) != null; 
```

# javascript - 是否可以触发/绑定 jQuery UI 事件？

> ID：13476146
> 
> 赞同：3
> 
> 时间：2012-11-20T15:11:04.773
> 
> 标签：javascript, jquery, jquery-ui, events, callback

> **可能重复：**
> [jQuery AutoComplete 触发器更改事件](https://stackoverflow.com/questions/6431459/jquery-autocomplete-trigger-change-event)

我正在使用 jQuery UI v1.9 并成功实现了[jQuery UI 自动完成](http://api.jqueryui.com/autocomplete)小部件。我想知道是否可以触发/绑定 jQuery UI 事件，如果可以，如何实现。也就是说，例如，如果我有

```
$('#autocomplete_field" %>').autocomplete({
  change: function (event, ui) {
    // Make something...
  },
  minLength: 2,
  ...
}); 
```

是否可以通过将 jQuery UI`change`事件绑定到事件来运行它`keypress`？

* * *

*注意*：我试过

```
$('#autocomplete_field').bind('keypress', function(event) {
    $('#autocomplete_field').autocomplete('option', 'change').call();
}); 
```

但我收到以下错误（来自 Firebug 控制台）：

```
TypeError: elem.nodeName is undefined
...ks = jQuery.valHooks[ elem.type ] || jQuery.valHooks[ elem.nodeName.toLowerCase(... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:18:59.567

在快速查看[jQuery UI 源代码](http://code.jquery.com/ui/jquery-ui-git.js)后，我最初的猜测大部分是正确的（我已经有一段时间没有使用任何 jQuery UI 小部件了）。

`autocomplete`等等使用`jQuery.Widget`构建器，它为任何以小部件名称调用的事件添加前缀（或者`widgetEventPrefix`如果提供了一个）。

对于`autocomplete`，这意味着事件应该可以通过`autocompletechange`、等触发和绑定（您可以在[小部件的文档页面](http://api.jqueryui.com/autocomplete/)`autocompleteclose`上找到其余事件）[`autocomplete`](http://api.jqueryui.com/autocomplete/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:19:34.630

我认为如果您只是将功能从自动完成中抽象出来，那将很容易。

```
$('#autocomplete_field" %>').autocomplete({
    change: function (event, ui) {
        changeFunction()
    },
    minLength: 2,
          ...
});

$('#autocomplete_field').bind('keypress', function(event) {
    changeFunction();
});

function changeFunction() {
//make something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:42:48.160

这将涵盖文本框的自动完成：

```
 $(".autoCompleteTxtBox").autocomplete({
                 source: "www.url.com/Source",
                 select: function (event, ui) {
                     //something to do when user selects from dropdown
                 }
             });

 $(document).on('keyup, keydown, change', '.selectorClass', function(event){    
       //I'm not sure what you need ui for exactly
      var pos = $(this).position(); // gets position of .selectorClass
      var val = $(this).val(); // gets current value of .selectorClass
      var width = $(this).width(); // gets width
     // if there are multiple '.selectorClass' - $(this) is the one that fired event
   }); 
```

这是否让您了解如何使用 $(this) ？

在同一文本框的 2 个位置处理事件有点多余，但如果这是你想要的 - 这将有一个正常工作的自动完成功能，并且每次文本框更改时都有另一个处理位置，无论它如何更改。

# python - 与网站调用相比，Python 请求提供了不同的状态码

> ID：13476154
> 
> 赞同：1
> 
> 时间：2012-11-20T15:11:52.627
> 
> 标签：python, python-requests

我使用请求，并且某些 URL 给出的响应代码与浏览器中具有相同 URL 的调用不同。

例如：

```
import requests
req = requests.get('http://www.jordaaninfo.nl')
responsecode = req.status_code
# responsecode == 500 
```

提供响应代码 500，而页面[http://www.jordaaninfo.nl](http://www.jordaaninfo.nl)可通过 Chrome/FF/Safari 访问。

谢谢，尼尔斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T22:31:41.447

在我的 Firefox 中，www.jordaaninfo.nl 也会出现 500 状态代码，但无论如何都会显示该页面。这可以在 Firebug 的 Net 选项卡中看到。我在 Linux 上的 Chromium 浏览器获得了 200 OK。

问题（和解决方案）在请求中的 Accept-Language 标头中。显然，服务器在这方面有特殊需求;-)

问题和解决方案可以用 wget 演示：

```
$ wget 'http://www.jordaaninfo.nl/'
--2012-11-20 23:15:20--  http://www.jordaaninfo.nl/
Resolving www.jordaaninfo.nl... 87.250.155.10
Connecting to www.jordaaninfo.nl|87.250.155.10|:80... connected.
HTTP request sent, awaiting response... 500 Internal Server Error
2012-11-20 23:15:22 ERROR 500: Internal Server Error.

$ wget --header="Accept-Language: Accept-Language: en;q=0.8,en-us;q=0.5" 'http://www.jordaaninfo.nl/'
--2012-11-20 23:16:01--  http://www.jordaaninfo.nl/
Resolving www.jordaaninfo.nl... 87.250.155.10
Connecting to www.jordaaninfo.nl|87.250.155.10|:80... connected.
HTTP request sent, awaiting response... 200 OK
.... 
```

我的 Firefox 中的 500 错误是由语言 'nl' 作为 Accept-Language 设置中的第一个条目引起的：

```
nl,en;q=0.8,en-us;q=0.5,fy;q=0.3 --> 500 ERROR
en,nl;q=0.8,en-us;q=0.5,fy;q=0.3 --> 200 OK 
```

# actionscript-3 - UI 美学与接受/预期的功能

> ID：13476156
> 
> 赞同：0
> 
> 时间：2012-11-20T15:12:04.170
> 
> 标签：actionscript-3, user-interface, user-experience

我遇到的问题是设计师似乎对 gui 设计采取了美学方法，以支持预期的功能。在这种情况下，我有一个正在实现的视频播放器的新布局 - 图形很棒 - 但它缺少视频播放头时间和持续时间。有一个搜索栏，当你搜索时还有一个时间叠加，但它只是向用户显示他们正在搜索的位置。没有任何可用的界面或显示显示当前时间。还有一些元数据（注释）与它们相关联的特定时间，但没有特定于播放器。

关于什么是最好的方法的任何想法，以证明这不是最好的方法，并且像我们拥有的所有其他视频播放器界面一样，我们需要将时间码放在播放器上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:46:28.463

您可能会争辩说，某人不可能分享视频的特定部分。如果特别长，你只想告诉别人5点43分发生的场景，那是不可能的。您不能只说*“将滑块移动大约 2 个半季度”*。这将是令人困惑和不必要的。

还要指出，在大多数情况下，诸如此类的事情仅仅是新奇的，并不实用。新奇产品很快就会出现，尤其是当用户已经习惯了来自 YouTube 和 Vimeo 的视频播放器时，新奇事物给用户带来了不便，两者都具有视频播放器有效所需的最低限度的组件。然而同时它们都允许独特的视觉风格。

无论如何，这就是我对这一切的感受，希望这会有所帮助。

# java - 是否有“Spring 方式”从带注释的接口获取实现？

> ID：13476157
> 
> 赞同：4
> 
> 时间：2012-11-20T15:12:04.357
> 
> 标签：java, spring, interface, annotations, spring-aop

我想废弃一些样板。假设我有一个带有自定义注释的自定义界面：

```
interface MyInterface {
    @DoSomething("crazy")
    public String aMethod(int numberOfJumps); 
} 
```

现在我可以编写一个`InvocationHandler`, 并生成一个`Proxy`实现，该实现基于注释和方法参数或多或少有用，并返回适当的结果。这工作正常。

我的问题是我是否可以使用 Spring 的某种机制来获得相同的结果，但可能更安全、更快、更灵活和/或更可配置。Spring AOP 注释看起来很有希望，但它们似乎需要一个类，而不是一个接口。

**[更新]**

为了明确我想要的内容，我当前代码的大纲：

```
public interface TestInterface {
    @MyAnnotation(name = "foo")
    public void testMethod(String arg);
}

public class AnnotationProxy {
    @SuppressWarnings("unchecked")
    public static <T> T getImplementation(Class<T> annotatedInterface) {
       return (T) Proxy.newProxyInstance(annotatedInterface.getClassLoader(),
               new Class<?>[]{annotatedInterface},
               new AnnotationHandler());
    }

    private static class AnnotationHandler implements InvocationHandler {
        public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
            System.out.println("Args " + Arrays.toString(args));
            System.out.println("Annotations" + Arrays.toString(method.getAnnotations()));
            return "useful value";
        }
    }
}

TestInterface ti = getImplementation(TestInterface.class);
String s = ti.testMethod("xyz"); //"useful value" 
```

如您所见，我凭空创建了一个对象（以及一些丑陋的反射材料）。我想知道我是否可以用一种更文明、更像春天的方式来做到这一点。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T16:32:39.097

一种方法是扫描具有您喜欢的注释的方法的接口，在 Spring 应用程序上下文中创建和注册代理。

**例子**

让我们有一个接口`Test`，我们要为其创建和注册代理：

```
package com.test;

public interface Test {
    @DoSomething(pattern = "[%s]")
    void print(String value);
} 
```

我们的注解如下所示：

```
package com.test;

import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;

@Retention(RetentionPolicy.RUNTIME)
public @interface DoSomething {

    String pattern();

} 
```

我们想在这样的应用程序中使用它：

```
import org.springframework.context.support.ClassPathXmlApplicationContext;

import com.test.Test;

public class Main {
    public static void main(final String[] args) throws Exception {
        final ClassPathXmlApplicationContext ctx = new ClassPathXmlApplicationContext("test.xml");
        final Test test = ctx.getBean(Test.class);
        test.print("Hello");
    }
} 
```

我们的*test.xml* Spring 配置文件只包含对组件的扫描：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
           http://www.springframework.org/schema/context
           http://www.springframework.org/schema/context/spring-context-3.1.xsd">

    <context:component-scan base-package="com.test"/>
</beans> 
```

不着边际。为了创建和注册代理，我们必须实现[BeanFactoryPostProcessor](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/beans/factory/config/BeanFactoryPostProcessor.html)来扫描接口并创建代理：

```
package com.test;

import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;
import java.util.Map;
import java.util.Set;

import org.springframework.beans.BeansException;
import org.springframework.beans.factory.config.BeanFactoryPostProcessor;
import org.springframework.beans.factory.config.ConfigurableListableBeanFactory;
import org.springframework.context.ApplicationContext;
import org.springframework.context.ApplicationContextAware;
import org.springframework.core.io.Resource;
import org.springframework.core.type.AnnotationMetadata;
import org.springframework.core.type.MethodMetadata;
import org.springframework.core.type.classreading.MetadataReader;
import org.springframework.core.type.classreading.SimpleMetadataReaderFactory;
import org.springframework.stereotype.Component;

@Component
public class DoSomethingPostprocessor implements BeanFactoryPostProcessor, ApplicationContextAware {

    private ApplicationContext applicationContext;

    private Object createDoSomethingBean(final MethodMetadata mmd, final Map<String, Object> attributes)
            throws Exception {
        final String pattern = (String) attributes.get("pattern");
        final Class<?> clazz = Class.forName(mmd.getDeclaringClassName());
        return Proxy.newProxyInstance(clazz.getClassLoader(), new Class[] { clazz },
                new InvocationHandler() {

                    @Override
                    public Object invoke(final Object proxy, final Method method, final Object[] args) throws Throwable {
                        System.out.println(String.format(pattern, args[0]));

                        return null;
                    }
                });
    }

    @Override
    public void postProcessBeanFactory(final ConfigurableListableBeanFactory beanFactory) throws BeansException {
        try {
            final String packageSearchPath = "classpath*:com/**/*.class";

            final Resource[] resources =
                    applicationContext.getResources(packageSearchPath);
            final SimpleMetadataReaderFactory factory = new
                    SimpleMetadataReaderFactory(applicationContext);

            for (final Resource resource : resources) {
                final MetadataReader mdReader = factory.getMetadataReader(resource);

                final AnnotationMetadata am = mdReader.getAnnotationMetadata();
                final Set<MethodMetadata> methodMetadata =
                        am.getAnnotatedMethods(DoSomething.class.getName());
                for (final MethodMetadata mmd : methodMetadata) {
                    final Map<String, Object> attributes =
                            mmd.getAnnotationAttributes(DoSomething.class.getName());
                    final String beanName = mmd.getDeclaringClassName();
                    beanFactory.registerSingleton(beanName, createDoSomethingBean(mmd, attributes));
                }
            }
        } catch (final Exception e) {
            throw new RuntimeException(e);
        }

    }

    @Override
    public void setApplicationContext(final ApplicationContext applicationContext) throws BeansException {
        this.applicationContext = applicationContext;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:30:37.457

您可以使用 Spring AOP 来拦截和后处理带注释的方法：

```
@Aspect
public class ProcessDoSomethingAspect {

    @AfterReturning(value = "execution(@annotation(doSomething) * *.*(..))", returning = "result")
    public String processResult(my.package.DoSomething doSomething, String result) {
        // process result here
        return result;
    }   

} 
```

# ios - 苹果审查：播放内容审查指南第 11.14 节

> ID：13476158
> 
> 赞同：0
> 
> 时间：2012-11-20T15:12:08.367
> 
> 标签：ios, app-store, appstore-approval

我开发了一个包含医疗文件的应用程序。这个应用程序将通过应用程序商店免费分发。

该应用程序并非所有人都可以使用，但只能由医生使用。出于这个原因，我在应用程序的主屏幕中放置了一个表格，要求输入密码。此密码将通过电子邮件免费分发给所有医生，并附有一个指向 Apple Store 的链接，要求他们下载该应用程序。

我已提交应用以供审核，但由于以下原因被拒绝：
“我们发现您的应用不恰当地通过 App Store 以外的机制解锁或启用了附加功能，这不符合 App Store 审核指南。
具体而言，我们发现您的应用需要代码才能运行。
修改或删除此功能会更合适。”

在向审核团队发送一些消息后，他们已确认该应用符合审核指南第 11.14 节

```
“11.14 应用程序可以阅读或播放在应用程序之外订阅或购买的经批准的内容（特别是杂志、报纸、书籍、音频、音乐和视频），只要应用程序中没有购买按钮或外部链接批准的内容。Apple 将不会收到在 App 之外订阅或购买的批准内容的任何部分收入”
```

但不是第 11.1 节

```
“11.1 使用 App Store 以外的机制解锁或启用附加特性或功能的应用程序将被拒绝”
```

所以，我的问题是：如何让用户在不使用密码或代码的情况下阅读或播放保留的内容？请注意，内容是免费的，不需要在应用程序外购买。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T16:15:43.350

我找到的唯一解决方案是使用标准登录密码身份验证系统更改密码身份验证系统，该系统检查远程服务器上的输入。

# functional-programming - 从字符串中获取子字符串

> ID：13476159
> 
> 赞同：-2
> 
> 时间：2012-11-20T15:12:10.413
> 
> 标签：functional-programming, scheme

我尝试在方案函数式编程中编写代码，从一个字符串中获取子字符串。

```
input "HelloWorld" output "Hello"+"World"
input "TheTreeIsGreen" output "The"+"Tree"+"Is"+"Green" 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:07:01.950

这个问题可以通过正则表达式轻松解决。例如，在球拍中：

```
(regexp-match* #rx"[A-Z][a-z]+" "TheTreeIsGreen")
=> '("The" "Tree" "Is" "Green") 
```

# sencha-touch-2 - 嵌套列表项的高度（Sencha Touch 2.1.0）

> ID：13476161
> 
> 赞同：2
> 
> 时间：2012-11-20T15:12:16.803
> 
> 标签：sencha-touch-2

我创建了一个带有自定义模板的嵌套列表（我已经制作了自定义函数`getItemTextTpl`）。问题是我无法更改嵌套列表项的高度（附图片）。Sencha Touch 2.0.0 没有这个问题。是否有可能更改项目高度？

![在此处输入图像描述](../Images/fd0af77083af0824f23fa9954f26ff84.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:50:52.277

我已经自己解决了这个问题。他们在 Sencha Touch v2.1 中添加了新的列表属性。
这些属性之一是`itemHeight`. 它是用于项目高度的属性（[更多信息在这里](http://docs.sencha.com/touch/2-1/#!/api/Ext.dataview.List-cfg-itemHeight)）。要在嵌套列表中使用此属性，您必须初始化嵌套列表的属性`listConfig`。像这样：

```
listConfig: {
  itemHeight: 100
} 
```

也许您还需要检查新列表的属性`variableHeights`（[更多信息在这里](http://docs.sencha.com/touch/2-1/#!/api/Ext.dataview.List-cfg-variableHeights)）。

# sql-server - 向表中插入 n 行

> ID：13476163
> 
> 赞同：0
> 
> 时间：2012-11-20T15:12:24.283
> 
> 标签：sql-server, tsql

我有两张桌子。一张表 (A) 有 n 行数据，另一张表 (B) 为空。我想在表 B 中插入 n 行，表 A 中的每一行插入 1 行。表 B 中将包含表 A 中的几个字段，包括表 A 中的外键。最后我想要 B 中的一行对于 A 中的每一行。我怎样才能编写一些 TSQL 来做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:14:50.343

```
INSERT INTO TableB (ColA, ColB, ColC)
SELECT ColA, ColB, ColC
FROM TableA 
```

Pinal Dave 在这里写了一篇关于其他替代方法的精彩文章：

[http://blog.sqlauthority.com/2007/08/15/sql-server-insert-data-from-one-table-to-another-table-insert-into-select-select-into-table/](http://blog.sqlauthority.com/2007/08/15/sql-server-insert-data-from-one-table-to-another-table-insert-into-select-select-into-table/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:15:08.467

如果我理解正确，您需要使用类似`SELECT INTO`： [http ://www.w3schools.com/sql/sql_select_into.asp](http://www.w3schools.com/sql/sql_select_into.asp)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T15:15:30.093

你可以这样做：

```
;WITH CTE
AS
(
   SELECT *, ROW_NUMBER() OVER(ORDER BY PrimaryKey) row_num
   FROM tableA
)
INSERT INTO Tableb(...)
SELECT ...
FROM CTE
WHERE row_num = 1; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T15:16:26.360

这可以通过使用以下查询来完成。

```
INSERT INTO B(PriKey, RelationshipWithA, Description)
SELECT ROW_NUMBER(), A.PrimaryKey, A.Description
FROM A 
```

如果您想要一个更充分的示例，您可以向我提供您希望输入的特定表名和列。

# php - Zend Framework 2 表单的自定义验证器

> ID：13476164
> 
> 赞同：10
> 
> 时间：2012-11-20T15:12:37.240
> 
> 标签：php, validation, zend-framework2

我正在尝试制作一个用户注册表单来检查密码字段的复杂性。我已经根据[文档](http://framework.zend.com/manual/2.0/en/modules/zend.validator.writing-validators.html)编写了一个自定义验证器来执行此操作。该文件位于我的“用户”模块中，位于 User\src\User\Validator。

```
<?php

namespace User\Validator;

use Zend\Validator\AbstractValidator;

class PasswordStrength extends AbstractValidator {

const LENGTH = 'length';
const UPPER  = 'upper';
const LOWER  = 'lower';
const DIGIT  = 'digit';

protected $messageTemplates = array(
    self::LENGTH => "'%value%' must be at least 6 characters long",
    self::UPPER => "'%value% must contain at least one uppercase letter",
    self::LOWER => "'%value% must contain at least one lowercase letter",
    self::DIGIT => "'%value% must contain at least one digit letter"
);

public function isValid($value) {
    ... validation code ...
}
} 
```

我的问题是在我的用户注册表单中尝试使用这个验证器。我尝试通过在 Module.php 中配置验证器将其添加到 ServiceManager。

```
public function getServiceConfig() {
    return array(
        'invokables' => array(
            'PasswordStrengthValidator' => 'User\Validator\PasswordStrength'
        ),
    );
} 
```

然后我将它添加到 User.php 中的输入过滤器中。

```
public function getInputFilter() {
    if (!$this->inputFilter) {
        $inputFilter = new InputFilter();
        $factory     = new InputFactory();

        $inputFilter->add($factory->createInput(array(
            'name'     => 'username',
            'required' => true,
            'validators' => array(
                array(
                    'name'    => 'StringLength',
                    'options' => array(
                        'encoding' => 'UTF-8',
                        'min'      => 1,
                        'max'      => 100,
                    ),
                ),
            ),
        )));

        $inputFilter->add($factory->createInput(array(
            'name'     => 'password',
            'required' => true,
            'validators' => array(
                array(
                    'name'    => 'PasswordStrengthValidator',
                ),
            ),
        )));

        $this->inputFilter = $inputFilter;
    }

    return $this->inputFilter;
} 
```

但是，当我访问表单并点击提交按钮时，我得到一个 ServiceNotFoundException。

```
Zend\ServiceManager\ServiceManager::get was unable to fetch or create an instance for PasswordStrengthValidator 
```

我的 ServiceManager 配置有问题吗？我什至不确定这是否是首先使用自定义验证器的适当方式。我发现了很多使用 ZF1 的示例，但是我发现的 ZF2 的文档和示例从未超出验证器的编写范围以解决其与表单的集成等问题。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T02:10:22.377

您可以尝试此解决方法...在 Module.php 中注册您的验证器，但使用函数**getValidatorConfig**或在 module.config.php 中的键“validators”下注册。

```
public function getValidatorConfig() {
  return array(
    'invokables' => array(
        'PasswordStrengthValidator' => 'User\Validator\PasswordStrength'
    ),
  );
} 
```

然后在你的 User.php 中，试试这个：（但你必须有权访问服务定位器，你可以从 UserFactory 等注入它）

```
$validatorManager = $this->getServiceLocator()->get('ValidatorManager');
// here you can test $validatorManager->get('PasswordStrengthValidator');

$validatorChain = new ValidatorChain();
$validatorChain->setPluginManager($validatorManager);

$inputFilter = new InputFilter();   
$inputFilter->getFactory()->setDefaultValidatorChain($validatorChain); 
```

这对我有用。

马丁

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-21T19:21:05.037

您尝试在示例中使用的“短名称”验证器加载仅在您首先使用验证器插件管理器 ( `Zend\Validator\ValidatorPluginManager`) 注册该短名称/别名时才有效。

一种替代方法（以及我这样做的方式）是在创建表单过滤器对象时注入必要的自定义验证器的实例。这是 ZfcUser 的做法：

```
// Service factory definition from Module::getServiceConfig
'zfcuser_register_form' => function ($sm) {
     $options = $sm->get('zfcuser_module_options');
     $form = new Form\Register(null, $options);
     $form->setInputFilter(new Form\RegisterFilter(
         new Validator\NoRecordExists(array(
             'mapper' => $sm->get('zfcuser_user_mapper'),
             'key'    => 'email'
         )),
         new Validator\NoRecordExists(array(
            'mapper' => $sm->get('zfcuser_user_mapper'),
            'key'    => 'username'
         )),
         $options
     ));
     return $form;
}, 
```

来源：[https ://github.com/ZF-Commons/ZfcUser/blob/master/Module.php#L100](https://github.com/ZF-Commons/ZfcUser/blob/master/Module.php#L100)

在这里，两个`ZfcUser\Validator\NoRecordExists`验证器实例（一个用于电子邮件，一个用于用户名）被注入到注册表单 ( `ZfcUser\Form\RegisterFilter`) 的输入过滤器对象的构造函数中。

然后，在`ZfcUser\Form\RegisterFilter`类内部，将验证器添加到元素定义中：

```
$this->add(array(
    'name'       => 'email',
    'required'   => true,
    'validators' => array(
        array(
            'name' => 'EmailAddress'
        ),
        // Constructor argument containing instance of the validator
        $emailValidator
    ),
)); 
```

来源：[https ://github.com/ZF-Commons/ZfcUser/blob/master/src/ZfcUser/Form/RegisterFilter.php#L37](https://github.com/ZF-Commons/ZfcUser/blob/master/src/ZfcUser/Form/RegisterFilter.php#L37)

我相信另一种选择是使用完全限定的类名作为验证器名称（即：“User\Validator\PasswordStrength”，而不仅仅是“PasswordStrengthValidator”），尽管我自己从未尝试过。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-24T13:34:23.690

删除您的可调用配置。

并将您的验证器设置修改为：

```
 $inputFilter->add($factory->createInput(array(
            'name'     => 'password',
            'required' => true,
            'validators' => array(
                array(
                    'name'    => 'User\Validator\PasswordStrength',
                ),
            ),
        ))); 
```

为我工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-02-06T07:59:42.593

Rufinus 解决方案就像魅力一样。我使用自定义验证器的步骤是（在我的例子中是一个 URL 验证器来检查网络是否真的存在）：

1）在module.config.php中

```
'validators' => array(
     'invokables' => array(
         'UrlValidator' => 'Application\Validators\UrlValidator'
     ),
 ) 
```

2) 在路径 Application/src/Application/Validators/UrlValidator.php

```
namespace Application\Validators; 
use Zend\Validator\AbstractValidator;                     
class UrlValidator extends AbstractValidator{
    const NOTURL = 'NOTURL';

    protected $messageTemplates = array(
        self::NOTURL => 'Value should be a valid URL',
    );

    public function __construct(array $options = array()){
        parent::__construct($options);
    }

    public function isValid($value){
        $this->setValue($value);       
        if (!$this->validateurl($value)) {
            $this->error(self::NOTURL);
            return false;
        } 
        return true;
    }
    private function validateurl($url) {
        $ch = curl_init(); // initialize curl handle
        curl_setopt($ch, CURLOPT_URL, $url); // set url to post to
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
        curl_setopt($ch, CURLOPT_HEADER, 1);
        $result = curl_exec($ch);

        $info = curl_getinfo($ch);
        $code = $info['http_code'];
        curl_close($ch);

        if ($code == substr($code, 0, 1) || substr($code, 0, 1) == '4' || substr($code, 0, 1) == '5') {
            return false;
        } else {
            return true;
        }
   }
} 
```

3) 在表格中

```
 $inputFilter->add($factory->createInput(array(
                    'name' => 'url',                       
                    'validators' => array(
                        array(
                            'name' => 'NotEmpty',
                            'options' => array(
                                'messages' => array(
                                    'isEmpty' => 'URL is required'
                                )
                            )
                        ),
                        array(
                            'name'=>'Application\Validators\UrlValidator'
                        )
                    )
        ))); 
```

额外）如果您想在应用程序的任何位置（即在控制器操作内）使用它，您可以从 ValidatorManager 插件中检索：

```
$urlValidator = $this->getServiceLocator()->get('ValidatorManager')->get('UrlValidator'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-09-23T19:05:21.907

是的，它可以按照 Conti 的说明进行调用，也可以作为工厂调用，以防您需要注入服务管理器，或者在以下示例中注入 Doctrine 实体管理器。这是非常优雅的解决方案：

```
 'validators' => array(
        'invokables' => array(
            //'emailExist' => 'Application\MyValidation\EmailExistValidator',
        ),
        'factories' => array(
            'emailExist' => function ($vm) {
                $serviceLocator = $vm->getServiceLocator();
                $emailExistValidator = new \Application\MyValidation\EmailExistValidator();
                $doctrineEntityManager = $serviceLocator->get('Doctrine\ORM\EntityManager');
                $emailExistValidator->setObjectManager($doctrineEntityManager);
                return $emailExistValidator;
            },
        ),
    ), 
```

# windows - 可以指定 IFileDialog 的开始位置吗？

> ID：13476169
> 
> 赞同：11
> 
> 时间：2012-11-20T15:12:52.437
> 
> 标签：windows, winapi, filedialog, common-dialog

我在 Microsoft 文档中找不到任何内容，所以我只是想知道是否有人知道，是否可以指定 a 的起始位置`IFileDialog`？具体来说，我希望第一次打开对话框时，它会在父窗口的中心打开。

`WM_*`除了以某种方式连接到底层消息之外，我没有看到一种直接的方法来做到这一点。

是否可以使用类似的东西[`SetWindowPos`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633545(v=vs.85).aspx)？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2018-09-29T08:08:38.400

shell 的 IFileDialog 实现支持[IOleWindow](https://docs.microsoft.com/en-us/windows/desktop/api/oleidl/nn-oleidl-iolewindow) 接口（注意它似乎没有记录......）。但是必须先打开对话框，然后才能获得它的窗口句柄。

[所以诀窍是使用IFileDialogEvents](https://docs.microsoft.com/en-us/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogevents)接口订阅对话框的事件，获取窗口句柄并移动它，如下面的示例所示。我选择 OnSelectionChange 是因为它似乎是个好地方。当然这是要适应的（你不想在每次选择改变时移动窗口......）。

```
class Events : public IFileDialogEvents
{
  // poor man's IUnknown implementation :-)
  STDMETHODIMP QueryInterface(REFIID riid, void **ppvObject) { *ppvObject = NULL; return E_NOINTERFACE; }
  STDMETHODIMP_(ULONG) AddRef() { return 1; };
  STDMETHODIMP_(ULONG) Release() { return 1; }
  STDMETHODIMP OnFileOk(IFileDialog *pfd) { return S_OK; }
  STDMETHODIMP OnFolderChanging(IFileDialog *pfd, IShellItem *psiFolder) { return S_OK; }
  STDMETHODIMP OnShareViolation(IFileDialog *pfd, IShellItem *psi, FDE_SHAREVIOLATION_RESPONSE *pResponse) { return S_OK; }
  STDMETHODIMP OnTypeChange(IFileDialog *pfd) { return S_OK; }
  STDMETHODIMP OnOverwrite(IFileDialog *pfd, IShellItem *psi, FDE_OVERWRITE_RESPONSE *pResponse) { return S_OK; }
  STDMETHODIMP OnFolderChange(IFileDialog *pfd) { return S_OK; }

  STDMETHODIMP OnSelectionChange(IFileDialog *pfd) {
    IOleWindow *window;
    if (SUCCEEDED(pfd->QueryInterface(&window)))
    {
      HWND hwnd;
      if (SUCCEEDED(window->GetWindow(&hwnd)))
      {
        MoveWindow(hwnd, 0, 0, 600, 600, FALSE);
      }
      window->Release();
    }
    return S_OK;
  }
};

int WINAPI wWinMain(HINSTANCE hInstance, HINSTANCE, PWSTR pCmdLine, int nCmdShow)
{
  CoInitialize(NULL);
  IFileOpenDialog *dlg;
  if (SUCCEEDED(CoCreateInstance(CLSID_FileOpenDialog, NULL, CLSCTX_ALL, IID_PPV_ARGS(&dlg))))
  {
    DWORD cookie;
    Events *evts = new Events();
    dlg->Advise(evts, &cookie);
    dlg->Show(NULL);
    dlg->Unadvise(cookie);
    dlg->Release();
    delete evts;
  }
  CoUninitialize();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-28T16:09:08.070

`IFileDialog`不提供控制对话框位置的方法，但这可以通过子类化对话框来实现。

`WM_WINDOWPOSCHANGING`消息是：

> 由于调用 SetWindowPos 函数或另一个窗口管理函数，发送到其大小、位置或 Z 顺序中的位置即将更改的窗口。
> 
> 窗口通过其 WindowProc 函数接收此消息。

因此，如果我们截获此消息，我们可以在窗口移动到那里之前将其参数更改为指向我们想要的位置。我们可以通过子类化对话框来做到这一点，它用我们自己的窗口过程更改对话框的窗口过程。我们的自定义窗口过程可能如下所示：

```
LRESULT MyWndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    if (msg == WM_WINDOWPOSCHANGING)
    {
        WINDOWPOS* wp = (WINDOWPOS*)lParam;
        wp->x = 100;
        wp->y = 100;
    }
    return CallWindowProc(owp, hwnd, msg, wParam, lParam);
} 
```

对话框是[`SetWindowLong`](https://docs.microsoft.com/en-us/windows/desktop/api/winuser/nf-winuser-setwindowlonga)函数的子类。但是，为了使用该功能，我们需要知道对话框的`HWND`. 反过来，我们可以通过设置一个临时挂钩来获取对话框的句柄，该挂钩`SetWindowsHookEx`将匹配对话框的标题，例如，并在子类化与给定标题匹配的窗口时删除自身：

```
LRESULT CALLBACK GetMsgProc(
    _In_ int    code,
    _In_ WPARAM wParam,
    _In_ LPARAM lParam
    )
{
    if (code == HC_ACTION)
    {
        MSG* msg = (MSG*)lParam;
        WCHAR title[120];
        GetWindowText(msg->hwnd, title, sizeof(title));
        if (lstrcmpW(title, L"MyTest01") == 0)
        {
            if (sizeof(long long) == 8)
                owp = (WNDPROC)SetWindowLongPtr(msg->hwnd, GWLP_WNDPROC, (LONG_PTR)MyWndProc);
            else
                owp = (WNDPROC)SetWindowLong(msg->hwnd, GWLP_WNDPROC, (LONG_PTR)MyWndProc);
            LRESULT r = CallNextHookEx(hhk, code, wParam, lParam);
            UnhookWindowsHookEx(hhk);
            return r;
        }
    }
    return CallNextHookEx(hhk, code, wParam, lParam);
} 
```

整个例子：

```
#include <windows.h>
#include <shobjidl.h> 

HHOOK hhk = NULL;
WNDPROC owp = NULL;

LRESULT MyWndProc(HWND hwnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    if (msg == WM_WINDOWPOSCHANGING)
    {
        WINDOWPOS* wp = (WINDOWPOS*)lParam;
        wp->x = 100;
        wp->y = 100;
        (WNDPROC)SetWindowLongPtr(hwnd, GWLP_WNDPROC, (LONG_PTR)owp);
    }
    return CallWindowProc(owp, hwnd, msg, wParam, lParam);
}

LRESULT CALLBACK GetMsgProc(
    _In_ int    code,
    _In_ WPARAM wParam,
    _In_ LPARAM lParam
    )
{
    if (code == HC_ACTION)
    {
        MSG* msg = (MSG*)lParam;
        WCHAR title[120];
        GetWindowText(msg->hwnd, title, sizeof(title));
        if (lstrcmpW(title, L"MyTestIFileOpenDialog01") == 0)
        {
            if (sizeof(long long) == 8)
                owp = (WNDPROC)SetWindowLongPtr(msg->hwnd, GWLP_WNDPROC, (LONG_PTR)MyWndProc);
            else
                owp = (WNDPROC)SetWindowLong(msg->hwnd, GWLP_WNDPROC, (LONG_PTR)MyWndProc);
            LRESULT r = CallNextHookEx(hhk, code, wParam, lParam);
            UnhookWindowsHookEx(hhk);
            return r;
        }
    }
    return CallNextHookEx(hhk, code, wParam, lParam);
}

int WINAPI wWinMain(HINSTANCE hInstance, HINSTANCE, PWSTR pCmdLine, int nCmdShow)
{
    HRESULT hr = CoInitializeEx(NULL, COINIT_APARTMENTTHREADED |
        COINIT_DISABLE_OLE1DDE);
    if (SUCCEEDED(hr))
    {
        IFileOpenDialog *pFileOpen;

        // Create the FileOpenDialog object.
        hr = CoCreateInstance(CLSID_FileOpenDialog, NULL, CLSCTX_ALL,
            IID_IFileOpenDialog, reinterpret_cast<void**>(&pFileOpen));

        if (SUCCEEDED(hr))
        {
            hhk = SetWindowsHookEx(WH_GETMESSAGE, GetMsgProc, NULL, GetCurrentThreadId());
            pFileOpen->SetTitle(L"MyTestIFileOpenDialog01");
            // Show the Open dialog box.
            hr = pFileOpen->Show(NULL);

            // Get the file name from the dialog box.
            if (SUCCEEDED(hr))
            {
                IShellItem *pItem;
                hr = pFileOpen->GetResult(&pItem);
                if (SUCCEEDED(hr))
                {
                    PWSTR pszFilePath;
                    hr = pItem->GetDisplayName(SIGDN_FILESYSPATH, &pszFilePath);

                    // Display the file name to the user.
                    if (SUCCEEDED(hr))
                    {
                        MessageBox(NULL, pszFilePath, L"File Path", MB_OK);
                        CoTaskMemFree(pszFilePath);
                    }
                    pItem->Release();
                }
            }
            pFileOpen->Release();
        }
        CoUninitialize();
    }
    return 0;
} 
```

# windows - 从 WlanEnumInterfaces 的 GUID 到硬件 ID、驱动程序版本等

> ID：13476173
> 
> 赞同：2
> 
> 时间：2012-11-20T15:13:11.007
> 
> 标签：windows, msdn, wlanapi

我目前正在使用 Windows 本机 wifi 功能来处理一些事情。这对我来说是一个非常好的抽象并且易于使用。

现在我需要更多关于我使用[WlanEnumInterfaces](http://msdn.microsoft.com/en-us/library/windows/desktop/ms706716%28v=vs.8.5%29.aspx)获得的 wifi 接口的详细信息。

基本上我想要硬件管理器中可用的信息，如硬件 ID、驱动程序版本等。

我现在不知道如何从 GUID 获得设备的一些较低级别的标识，我什至现在不知道哪些方法可用于查询详细的设备信息。

期待一些帮助。

菲利普

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:32:12.030

对我来说最简单的方法是查询注册表：

```
SYSTEM\\CurrentControlSet\\Control\\Class\\{4D36E972-E325-11CE-BFC1-08002BE10318} 
```

其中 {4D36E972-E325-11CE-BFC1-08002BE10318} 是网络适配器的类 guid。然后我可以在 NetCfgInstanceId 中解析我的 GUID。

问候

# php - php mysql插入图像BLOB字段

> ID：13476179
> 
> 赞同：0
> 
> 时间：2012-11-20T15:13:16.187
> 
> 标签：php, mysql, sql, blob, image-upload

我有一个包含 6 个字段的表，`students_id, customer_id, firstname, lastname, image_name, image`该`image`字段是 BLOB 类型、`image_name`字段图像文件名和扩展名。我知道如何从 blob 字段获取存储的图像并显示到我的网页，我通过 phpmyadmin 上传图像对其进行了测试...我的问题是如何在我的`image`字段中存储图像。？

这是我用于其他领域的..

```
<?php
public function addStudents($data) {
     $this->db->query("INSERT INTO " . DB_PREFIX . "students SET customer_id = '" .
 (int)$this->customer->getId() . "', firstname = '" . $this->db->escape($data['firstname']) .
 "', lastname = '" . $this->db->escape($data['lastname']) . "'");
}
?> 
```

它是我的 HTML 图片上传部分

```
<input type="file" name="image" /> 
```

有人请帮帮我吗？如果有人可以通过编辑我的源代码来回答它非常有帮助......

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-12T03:10:45.630

嗯，你可以查看[http://www.mysqltutorial.org/php-mysql-blob/](http://www.mysqltutorial.org/php-mysql-blob/)，解释的很清楚

# ipad - iPad 上的 iOS 5 UISplitViewController 不会在肖像上显示 MasterView（但只是最初）

> ID：13476183
> 
> 赞同：3
> 
> 时间：2012-11-20T15:13:28.363
> 
> 标签：ipad, ios5, ios-simulator

我有一个 UITabBarController 应用程序，其中一个选项卡显示应用程序设置。这是一个带有多个细节控制器的 UISplitViewController，这些细节控制器会根据主控制器上的选择而改变。我的 detailViewControllers 有这些行允许主视图不断显示（或应该）：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.splitViewController.delegate = self;
}

- (BOOL) splitViewController:(UISplitViewController *)svc shouldHideViewController:(UIViewController *)vc inOrientation:(UIInterfaceOrientation)orientation {
    return NO;
} 
```

这是我的问题：如果在点击设置选项卡时垫是纵向的，则仅显示初始详细视图。不是大师。将垫子旋转到横向和向后，大师显示得很好并停留在那里。

我无法弄清楚为什么会这样。XCode 4.5.2 master/detail 模板项目在我将detailController 更新为不隐藏master 后就没有这个问题了。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-04T22:37:44.333

我只是遇到了同样的问题，但是通过仔细检查我的 UISplitViewController 委托是否在适当的时间设置了它。

请注意 XCode 示例项目的 AppDelegate 中所做的工作正常：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPad) {
        UISplitViewController *splitViewController = (UISplitViewController *)self.window.rootViewController;
        UINavigationController *navigationController = [splitViewController.viewControllers lastObject];
        splitViewController.delegate = (id)navigationController.topViewController;
    }
    return YES;
} 
```

它专门将 UISplitViewController 委托设置为特定的视图控制器。

出于我的目的，我将 AppDelegate 设置为 SplitViewControllerDelegate，因为我在 SplitViewController 中有一些稍微复杂的视图控制器管理。

因此，请确保在 application:didFinishLaunchingWithOptions: 中正确设置了委托，并且您应该没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T17:00:27.053

为了解决这个问题，我必须执行我在原始问题中使用的相同代码，但将其放入子类 UISplitViewController。最初我将其放入详细视图中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T10:33:34.263

我为这个问题找到的简单解决方法是确保 AppDelegate 具有方向委托：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return YES;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-16T16:56:32.120

我知道为时已晚，但我想展示我如何摆脱这种情况，以便其他人可以从中受益。

```
- (IBAction)hideMaster
{
   // 1\. set desired width for master view
   [self.splitViewController setValue:[NSNumber numberWithFloat:0.0] forKey:@"_masterColumnWidth"];

   // 2\. splitViewController delegate to self
   self.splitViewController.delegate = self;

  // 3\. give a smooth animation

  [UIView animateWithDuration:1.0 animations:^{
      [self.splitViewController.view layoutSubviews];
  }];
}

- (BOOL)splitViewController: (UISplitViewController*)svc shouldHideViewController:(UIViewController *)vc inOrientation:(UIInterfaceOrientation)orientation  __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_5_0);
{
    return NO;
} 
```

# email - iPhone 上的电子邮件日期错误 (imap_append)

> ID：13476193
> 
> 赞同：2
> 
> 时间：2012-11-20T15:14:03.213
> 
> 标签：email, date, migration, imap

我正在使用 PHP Imap 库将邮件从一个 imap 服务器复制到另一个。见[http://www.php.net/manual/en/ref.imap.php](http://www.php.net/manual/en/ref.imap.php)

我的脚本工作正常，除了邮件日期有问题。

如果我在 MS Outlook 中连接到新的 imap 帐户，日期是正确的，但如果我用我的 iPhone 连接到同一个帐户，电子邮件日期将显示为今天的日期（复制过程的日期）

所以我的问题是：iPhone 如何从电子邮件标头中检测电子邮件日期，以及在使用 imap_append 时如何使标头正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T21:00:01.700

它可能正在使用 IMAP 服务器`INTERNALDATE`字段，该字段在服务器上创建消息时由服务器维护。

RFC 指出，对于`APPEND`命令：

```
 If a date-time is specified, the internal date SHOULD be set in
  the resulting message; otherwise, the internal date of the
  resulting message is set to the current date and time by default. 
```

你有一个接口来提供一个时间戳来追加吗？

**编辑**：

是的，可以使用 imap_headerinfo：

$headerinfo = imap_headerinfo($source_imap, $message_number);
$internal_date=date('dMY H:i:s O',$headerinfo->udate);

imap_append ( $imap_stream , $mailbox , $message , $options , $internal_date);

我已经测试了您的解决方案并且它有效，iPhone 上的日期现在是正确的。

# php - 来自ajax的google-charts javascript arrayToDataTable

> ID：13476194
> 
> 赞同：0
> 
> 时间：2012-11-20T15:14:04.470
> 
> 标签：php, javascript, mysql, google-visualization

我有这个数组：["day","counts","Male","Female","AVGages"],["2012-01-20",15,10,5,25]。

```
function drawChart() {
            var jsonData = $.ajax({
                url: "server.php",
                dataType: "json",
                async: false
            }).responseText;

            var obj = jQuery.parseJSON(jsonData);
            var data = google.visualization.arrayToDataTable(obj); 
```

一个图表成功出现，有 5 列：

["day","counts","Male","Female","AVGages"]，像这样：

[http://s13.postimage.org/3q2o4g2mt/chart.png](http://s13.postimage.org/3q2o4g2mt/chart.png)

有没有办法让年龄不显示为一列但仍然是表格的一部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T16:05:19.370

您可以在绘制之前从数据对象中删除此列。

```
var data = google.visualization.arrayToDataTable(obj);
data.removeColumn(4); 
```

# java - 这个 iterator.remove() 如何帮助我节省内存？

> ID：13476197
> 
> 赞同：0
> 
> 时间：2012-11-20T15:14:11.593
> 
> 标签：java, out-of-memory, heap-memory

最近，我将以下代码从**for-each 更改为 Iterator**（使用*iterator.remove()*）

它立即解决了我的堆空间内存问题。

有人可以解释*iterator.remove()*真的有帮助吗？

```
final Iterator<Entry<String, String>> metaTagIterator = localeDO.getMetaTags().entrySet().iterator();

while (metaTagIterator.hasNext()) {
    final Entry<String, String> entry = metaTagIterator.next();

    if (ImportUtil.isI18nLiferayLayoutProperty(entry.getKey())) {
        layoutProps.setProperty(entry.getKey() + StringPool.UNDERLINE + locale, entry.getValue());
    } else if (ImportUtil.isLiferayLayoutProperty(entry.getKey())) {
        layoutProps.setProperty(entry.getKey(), entry.getValue());
    } else {
        myCustomLayoutProps.setProperty(entry.getKey() + StringPool.UNDERLINE + locale, entry.getValue());
    }
    metaTagIterator.remove();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:18:57.547

我唯一能做到的是，当您设置值`layoutProps`并`myCustomLayoutProps`消耗更多内存时，`metaTagIterator.remove();`释放内存是同时**删除元素`localeDO.getMetaTags()`**。**这样，您可以在迭代期间节省一些内存需求。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:23:58.033

从基础集合中移除迭代器返回的最后一个元素（可选操作）。每次调用 next 时，此方法只能调用一次。如果在迭代过程中以除调用此方法之外的任何方式修改了基础集合，则迭代器的行为是未指定的。

这里没什么特别的。当您迭代和删除时，该对象将从集合中删除，如果它没有活动引用，它将可用于 GC。

# ruby-on-rails - 如何在 Rails 应用程序中实现 wrapbootstrap 主题

> ID：13476200
> 
> 赞同：0
> 
> 时间：2012-11-20T15:14:25.523
> 
> 标签：ruby-on-rails, twitter-bootstrap

我有一个 rails 应用程序，我也集成了，但我不知道在 rails 中集成一个 wrapbootstrap？知道如何做到这一点吗？

我是新来的，我没有找到任何关于这个的例子。

# c++ - boost::thread 和 std::thread 之间的区别

> ID：13476201
> 
> 赞同：4
> 
> 时间：2012-11-20T15:14:39.007
> 
> 标签：c++, boost, c++11

我有一个使用 boost::thread 的地方（使用 boost::asio 的示例）

```
 std::vector<boost::shared_ptr<boost::thread> > threads;
  for (std::size_t i = 0; i < io_services_.size(); ++i)
  {
    boost::shared_ptr<boost::thread> thread(new boost::thread(
          boost::bind(&boost::asio::io_service::run, io_services_[i])));
    threads.push_back(thread);
  } 
```

如果我尝试将它与 std:thread 一起使用，则会出现编译错误：

```
std::vector<std::thread> threads;
for (std::size_t i = 0; i < this->ioServices.size(); ++i)
{
    std::thread thread(&boost::asio::io_service::run, ioServices[i]); // compile error std::thread::thread : no overloaded function takes 2 arguments   

    threads.push_back(std::move(thread));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:46:49.413

理论上，两者都应该工作，因为`std::thread`有一个可变参数构造函数，它基本上调用它的参数，就好像它与`std::bind`. 问题似乎是，至少在我的实现（gcc 4.6.3）中，既`std::thread`不能也`std::bind`不能确定`run`预期的哪个重载，从而导致编译错误。

但是，如果您使用`boost::bind`，则此方法有效。所以我会使用并手动执行绑定：

```
std::vector<std::thread> threads;
for (std::size_t i = 0; i < this->ioServices.size(); ++i)
{
    std::thread thread(boost::bind(&boost::asio::io_service::run, ioServices[i])); 

    threads.push_back(std::move(thread));
} 
```

编辑：它似乎`boost::bind`成功了，因为它有大量的重载，并且根据它提供的参数数量，在重载解析和模板替换期间，`boost::bind`它可以确定`boost::asio::io_service::run`预期的重载。

但是，由于`std::bind`and`std::thread`依赖于可变参数模板参数，因此 的两个重载`run`同样有效，编译器无法解析使用哪一个。这种模棱两可导致无法确定您所看到的失败的结果。

所以另一个解决方案是：

```
std::vector<std::thread> threads;
typedef std::size_t (boost::asio::io_service::*signature_type)();
signature_type run_ptr = &boost::asio::io_service::run;

for (std::size_t i = 0; i < this->ioServices.size(); ++i)
{
    std::thread thread(run_ptr, ioServices[i]); 

    threads.push_back(std::move(thread));
} 
```

# jquery - 在窗口调整大小时更新 fancyBox 边距

> ID：13476202
> 
> 赞同：2
> 
> 时间：2012-11-20T15:14:40.203
> 
> 标签：jquery, fancybox

回复： http: [//fancyapps.com/fancybox/#docs](http://fancyapps.com/fancybox/#docs)

我已经为自定义边距设置了选项，但如果窗口低于特定大小，我想调整它。有谁知道这是否可以使用 API 方法完成。尽管以下内容不起作用，但它可以让您了解我正在尝试做的事情：

```
if ($(window).width() <= 1024) $.fancybox.update({margin:18}); 
```

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-09T00:09:42.497

I resolved this problem by using the `onUpdate()` callback that fancybox provides and changing the margins there based on the screen width:

```
$(document).ready(function() {
    $(".fancybox").fancybox({ 
        onUpdate: function () {
            if ($(window).width() < 768) {
                $.fancybox.current.margin = [10,10,10,10];
            } else {
                $.fancybox.current.margin = [30,90,30,90];
            }
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:24:07.373

我已经使用媒体查询进行了更改。

默认情况下，fancybox 保留在您的代码中：

```
padding: 0
margin: 0 
```

然后在您的容器 div 弹出窗口中放置您的边距或填充，然后您就可以使用媒体查询了。

```
@media only screen and (min-width: 1024px) {
    ....
} 
```

# javascript - 我的代码有什么问题？

> ID：13476205
> 
> 赞同：0
> 
> 时间：2012-11-20T15:14:41.247
> 
> 标签：javascript, syntax

目前我正在研究函数，我无法真正找出以下代码有什么问题。无论“密码”取什么值，我总是得到“NICE”

```
var passValid = function (password) {
    return password.length;
};

if (passValid<5){
    console.log("ERROR");
}
else{
    console.log("NICE");
}

passValid("somevalue"); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T15:16:35.337

我想你想要：

```
if (passValid("password") < 5) {
  console.log("ERROR");
}
else {
  console.log("NICE");
} 
```

我不确定如何描述您的原始代码错误的原因；它只是杂草丛生:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:33:04.330

您在函数调用中缺少参数

```
if (passValid<5)//no argument
if (passValid("passowrd")<5)//pass an argument
passValid("somevalue");//no need for this 
```

或者

```
var passValid = function (password) {
    //return password.length;remove this from here
//}; remove this from here

if (password.length<5){
    console.log("ERROR");
}
else{
    console.log("NICE");
}
}; //add here so now entire is function
passValid("somevalue"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T15:17:04.893

您不调用该函数，而是尝试将函数本身与一个数字进行比较，而不是使用该函数返回的值。

在您的情况下`passValid`，只是对该函数的引用。要返回一个值，您必须使用`passValid( "someValueInHere" );`

试试这个：

```
var passValid = function (password) {
  return password.length;
};

if ( passValid("somevalue") < 5){
  console.log("ERROR");
} else {
  console.log("NICE");
} 
```

# php - 完成付款后如何获得 Google Checkout 的回复

> ID：13476209
> 
> 赞同：0
> 
> 时间：2012-11-20T15:14:49.623
> 
> 标签：php, payment-gateway

我正在将 Google Checkout 集成到 PHP 中。完成付款后，我试图重定向到我的本地主机，但我没有收到来自 Google Checkout 的响应。当我使用 Paypal 时，我会得到 txn_id、item_name、payment_status、支付金额等。这是我的代码：

```
 echo "<h2>Standard Checkout Request</h2>";
  $merchant_id = "my merchant id";  // Your Merchant ID
  $merchant_key = "my merchant key";  // Your Merchant Key
  $server_type = "sandbox";
  $currency = "USD";
  $cart = new GoogleCart($merchant_id, $merchant_key, $server_type,
  $currency);
  $total_count = 12;

  $item_1 = new GoogleItem("item name",      // Item name
                           "T-shart", // Item      description
                           $total_count, // Quantity
                           1); // Unit price

  $cart->AddItem($item_1);

  // Add shipping options
  if($total_count < 3){
         $ship_1 = new GoogleFlatRateShipping("USPS Priority Mail", 4.55);
  }else{
         $ship_1 = new GoogleFlatRateShipping("USPS Priority Mail", 6.2);
  }
  $Gfilter = new GoogleShippingFilters();
  $Gfilter->SetAllowedCountryArea('CONTINENTAL_48');

  $ship_1->AddShippingRestrictions($Gfilter);

  $cart->AddShipping($ship_1);

  // Add tax rules
  $tax_rule = new GoogleDefaultTaxRule(0.05);
  $tax_rule->SetStateAreas(array("MA"));
  $cart->AddDefaultTaxRules($tax_rule);

  // Specify <edit-cart-url>
  $cart->SetEditCartUrl("http://localhost/Practice/PaymentDemo/library/googleRequestSecond.php");

  // Specify "Return to xyz" link
  $cart->SetContinueShoppingUrl("http://localhost/Practice/PaymentDemo/library/googleRequestSecond.php");

  // Request buyer's phone number
  $cart->SetRequestBuyerPhone(true);

  // Display Google Checkout button
  echo $cart->CheckoutButtonCode("SMALL"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T09:14:52.240

您没有花太多时间向 Google 寻求帮助吧？您可能对 ResponseHandlerAPIFunctions.php 库感兴趣

查看[https://google-developers.appspot.com/checkout/samples/Google_Checkout_Sample_Code_PHP_ResponseHandlerAPIFunctions 上面](https://google-developers.appspot.com/checkout/samples/Google_Checkout_Sample_Code_PHP_ResponseHandlerAPIFunctions)写着：

> ResponseHandlerAPIFunctions.php 库包含一组函数，用于处理 Google Checkout 在收到您的 API 请求时发送的同步响应。

# batch-file - Windows BAT 脚本删除目录中的子文件夹

> ID：13476210
> 
> 赞同：0
> 
> 时间：2012-11-20T15:14:51.790
> 
> 标签：batch-file

我的文件夹结构如下

```
E:\test1\42\5440001\5338023\html
E:\test1\43\5440021\5338024\html
E:\test1\47\5440021\5638024\html
E:\test1\43\5448721\5339024\html 
```

等等...

其中HTML文件夹、**ABC**命名的子文件夹（所有文件夹的通用名）需要删除。

任何人都可以通过提供 BAT 脚本一次性删除所有**ABC子文件夹来帮助我。**

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:26:33.887

尝试这个。

```
@ECHO OFF
CD "E:\test1"
FOR /D /R %%A IN (*ABC) DO RMDIR /S /Q %%A 
```

在您实际运行上述脚本删除文件夹之前，您可以确认您将使用此脚本删除正确的文件夹。

```
@ECHO OFF
CD "E:\test1"
FOR /D /R %%A IN (*ABC) DO ECHO %%A 
```

我强烈建议首先运行第二个脚本，以确保您只获得所需的文件夹。

# c++ - 具有多个非可选参数的转换构造函数看起来如何，为什么有意义？

> ID：13476218
> 
> 赞同：7
> 
> 时间：2012-11-20T15:15:13.587
> 
> 标签：c++, constructor, c++11, type-conversion, language-lawyer

就我使用“转换构造函数”而言，它们看起来像这样：

```
struct X {
  X(A); // conversion from A -> X
  X(B,C = someC); // conversion from B -> X, with some default C
};
X x1 = A(); // calls X::X(A())
X x2 = B(); // calls X::X(B(),someC) 
```

这是完全有道理的，据我所知，只要你没有构造函数就可以工作：

```
struct Y {
  Y(A,B); // no implicit conversion
}; 
```

然而，这就是有趣的地方，C++11 标准的字面意思是：

> **12.3.1 构造函数转换**
> 
> 1.  `explicit` ~~一个可以用单个参数调用的~~没有函数说明符的构造函数指定了~~从其参数的第一个参数~~ *类型的*类型到其类的类型的转换。这样的构造函数称为转换构造函数。

（斜体原本是下划线的，但是markdown不接受`<u>`）

这似乎表明*转换*构造函数不必“使用单个参数”调用，并且从“其第一个参数的类型”更改为“其参数的类型**”**（注意复数！）进一步支持这一点。虽然我希望“其第一个参数的类型”将更改为“其单个非可选参数的类型”（1）或什至“接收显式参数的参数类型”（2）以允许这些：

```
struct Z {
  Z(A = a, B, C = c); // (1)
  Z(D = d, E = e, F = f); // (2)
};
Z = D(); // (2)
Z = E(); // (2) 
```

我不明白复数形式的公式是如何有意义的：**它真的表明您可以使用多个参数执行转换吗？这是什么意思？**

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T15:22:31.480

语言被修改为添加初始化列表的一部分。请参阅[n2672：init-list 措辞](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2672.htm)。

一个例子：

```
struct S {
    S(int x, double y) { }
};

void f(S) { }

int main() {
    f({ 42, 42.0 });
} 
```

# php - 创建搜索查询并根据选中的复选框显示结果（难度分组结果）

> ID：13476220
> 
> 赞同：2
> 
> 时间：2012-11-20T15:15:18.000
> 
> 标签：php, mysql

我想要一个显示多个关键字（复选框）的 php 页面，例如 Narberth、Pembrokeshire、Carmarthenshire 等区域以及其他内容。

到目前为止，我已经创建了一种方法来执行此操作并在表格中分别显示数据。我遇到的问题是首先显示与它们相关联的多个关键字的行。

因此，如果用户搜索“Narberth”和“Pembrokeshire”，结果将首先显示包含这两个关键字的任何文档，然后显示仅包含“narberth”和“pembrokeshire”后缀的任何文档。

我列出了到目前为止我已经完成的代码：

```
<form method="post">
<table border="1px solid" width="60%">
<tr>
<td><input type="checkbox" name="keywords[]" value="1">Narberth </td>
<td><input type="checkbox" name="keywords[]" value="2">James Brothers </td>
<td><input type="checkbox" name="keywords[]" value="3">Mabinogion </td>
</tr>
<tr>
<td><input type="checkbox" name="keywords[]" value="4">Pembrokeshire </td>
<td><input type="checkbox" name="keywords[]" value="5">Pubs </td>
<td><input type="checkbox" name="keywords[]" value="6">Coastal Paths </td>
</tr>
</table>
<br>
<input type="submit" name = "submit"> 
```

```
<?php
if (isset($_POST['submit'])) {

foreach( $_REQUEST['keywords'] as $keywordID )
{
$result = mysql_query("SELECT * FROM tbl_index m
inner join tbl_filekeywords r on m.file_id = r.file_id
where r.keyword_id = '".$keywordID."'");

$keywordname = mysql_query ("SELECT keyword FROM tbl_keywords WHERE keyword_id = '".$keywordID."'");
$KeywordName = mysql_fetch_row($keywordname);
$KeywordName = $KeywordName[0];

echo "<table border='1' width='50%'>
<th colspan='2'>".$KeywordName."</th>
<tr>
<th>File ID</th>
<th>Filename</th>
</tr>";

while($row = mysql_fetch_array($result)){
echo "<tr>";
echo "<td>" . $row['file_id'] . "</td>";
echo "<td>" . $row['file'] . "</td>";
echo "</tr>";
}
echo "</table><br>";
mysql_free_result($result);
}
}?> 
```

PS我开发了另一种替代方法，将所有文件集中到一个表中，这很好，但我仍然希望停止为每个关键字多次出现相同的文件，并且希望优先考虑并显示具有多个关键字的文件最佳。

```
<?php
if(isset($_POST['keywords']) && !empty($_POST['keywords'])){
foreach($_POST['keywords'] as $key=>$value){
if($value==1) $keywords[] = "keyword_id='".mysql_escape_string($key)."'";
}
$keywords = implode(' OR ', $keywords);
}
$query = "SELECT * FROM tbl_index m inner join tbl_filekeywords r on m.file_id = r.file_id WHERE $keywords";
$result = mysql_query($query);

echo "<table border='1' width='50%'>
<tr>
<th>File ID</th>
<th>Filename</th>
<th>Keyword_ID</th>
</tr>";

while($row = mysql_fetch_array($result)){
echo "<tr>";
echo "<td>" . $row['file_id'] . "</td>";
echo "<td>" . $row['file'] . "</td>";
echo "<td>" . $row['keyword_id'] . "</td>";
echo "</tr>";
}
echo "</table><br>";
mysql_free_result($result);
?> 
```

最后，表格的设置如下：

```
tbl_index : file_id, file

tbl_keywords : keyword_id, keyword

tbl_filekeywords : file_id, keyword_id 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:41:57.680

首先，欢迎来到 SO。后回答延迟是由于非综合问题。在接下来的问题中，请记住仅包含要提问的相关代码。

假设`tbl_index`和`tbl_filekeywords`表处于 1:N 关系。

首先，在 php 中，您可以获得`$keywords`选定关键字的字符串列表示例：

```
$keywords = " 1, 5, 12,  24" 
```

现在您可以通过这种方式对 tbl_filekeywords 进行排名。我们命名`rank view`：

```
select 
  r.file_id, 
  sum( case when r.keyword_id in ( $keywords  ) then 1 else 0 end ) as rank
from
  tbl_filekeywords r
group by 
  r.file_id 
```

最后一步是加入`rank view`tbl_index：

```
 select t.*
   from 
     tbl_index t left outer join
     ( HERE PREVIUS QUERY ) r
          on r.file_id = t.file_id
   order by
     coalesce( r.rank, 0 ) 
```

让我们知道这是否运行并且它是您的解决方案。如果没有，请解释我们如何改进答案！

**编辑到期 OP 评论**

我没有你的数据库模式，但它似乎`file_id`是`tbl_index`. 如果是这种情况，则查询不会产生重复项。请注意，由于 group by 子句，第一个查询 ,`rank view`每个查询只有一行。`file_id`因此，加入不会产生重复。对我来说，最后的查询是：

```
 select t.*
   from 
     tbl_index t inner join                 <--No dups
     ( 
       select 
         r.file_id, 
         count(*) as rank
       from
         tbl_filekeywords r
       where
         r.keyword_id in ( $keywords  )
       group by 
         r.file_id                          <--No dups
     ) r2
          on r2.file_id = t.file_id
   order by
      r2.rank 
```

# c - 使用 SIMD 优化一维热方程

> ID：13476223
> 
> 赞同：3
> 
> 时间：2012-11-20T15:15:21.187
> 
> 标签：c, optimization, sse, simd, heat

我正在使用 CFD 代码（用于计算流体动力学）。我最近有机会看到英特尔编译器在我的一个循环中使用 SSE，在这个循环中将计算性能提高了近 2 倍。但是，使用 SSE 和 SIMD 指令似乎更像是运气。大多数时候，编译器什么都不做。

然后我试图强制使用 SSE，考虑到 AVX 指令将在不久的将来加强这一方面。

我做了一个简单的一维传热代码。它由两个阶段组成，使用另一个阶段的结果（U0 -> U1，然后是 U1 -> U0，然后是 U0 -> U1，等等）。当它迭代时，它会收敛到稳定的解决方案。我在主代码中的大部分循环都使用相同类型的计算。（有限差分）。

但是，我的代码比正常循环慢两倍。结果是一样的，所以计算是一致的。

我犯错了吗？在超级计算机（使用 Westmer）上测试之前，我使用 Core 2 来测试循环。

这是代码，带有 SSE 循环，然后是参考循环：

```
#include <stdio.h>
#include <emmintrin.h>
#include <time.h>
//#include <vector>
#define n1 1004
#define niter 200000

int i,j,t;

double U0[n1] __attribute__ ((aligned(16)));
double U1[n1] __attribute__ ((aligned(16)));
double Dx,Dy,Lx,Ly,InvDxDx,Dt,alpha,totaltime,Stab,DtAlpha,DxDx;

__m128d vmmx00;
__m128d vmmx01;
__m128d vmmx02;
__m128d vmmx10;

__m128d va;
__m128d vb;
__m128d vc;
__m128d vd;

clock_t time0,time1;
FILE *f1;
int main()
{
/* ---- GENERAL ---- */
   alpha = 0.4;
   totaltime = 1.0/100.0;
   Dt = totaltime/((niter-1)*1.0);
   Lx = 1.0;
   Dx = Lx/((n1-1)*1.0);
   InvDxDx = 1.0/(Dx*Dx);
   DxDx = Dx*Dx;
   Stab = alpha*Dt*(InvDxDx);
   DtAlpha = Dt*alpha;
/* Stability if result <= 0.5 */
   printf("Stability factor : %f \n",Stab);

   for( i = 0; i < n1; i++){U0[i] = 0.0;}
   U0[1] = 1.0;
   U0[2] = 1.0;
   U0[3] = 1.0;
   U0[n1-2] = 2.0;

//    for ( i = 0; i < n1; i++) {
 //       for ( j = i + 1; j < n2; j++) {
  //          std::swap(U0[i][j], U0[j][i]);
   //     }
    //}

    va = _mm_set1_pd(-2.0);
    vb = _mm_set1_pd(InvDxDx);
    vd = _mm_set1_pd(DtAlpha);

 time0=clock();

 for( t = 0; t < niter; t++)
 {

    for( i = 2; i < n1-2; i+=2)
    {
      //printf("%d  %d  \n",i,j);
      //fflush(stdout);
      vmmx00 = _mm_load_pd(&U0[i]);
      vmmx01 = _mm_loadu_pd(&U0[i+1]);
      vmmx02 = _mm_loadu_pd(&U0[i-1]);

      vmmx10 = _mm_mul_pd(va,vmmx00);   // U1[i][j] = -2.0*U0[i][j];
      vmmx10 = _mm_add_pd(vmmx10,vmmx01);   // U1[i][j] = U1[i][j] + U0[i+1][j];
      vmmx10 = _mm_add_pd(vmmx10,vmmx02);   // U1[i][j] = U1[i][j] + U0[i-1][j];
      vmmx10 = _mm_mul_pd(vb,vmmx10);   // U1[i][j] = U1[i][j] * InvDxDx;

      vmmx10 = _mm_mul_pd(vd,vmmx10);   // U1[i][j] = U1[i][j] * DtAlpha;
      vmmx10 = _mm_add_pd(vmmx10,vmmx00);   // U1[i][j] = U1[i][j] + U0[i][j];

      _mm_store_pd(&U1[i],vmmx10);

      // U1[i][j] = U0[i][j] + DtAlpha*( (U0[i+1][j]-2.0*U0[i][j]+U0[i-1][j])*InvDxDx
    }

    for( i = 2; i < n1-2; i+=2)
    {
      //printf("%d  %d  \n",i,j);
      //fflush(stdout);
      vmmx00 = _mm_load_pd(&U1[i]);
      vmmx01 = _mm_loadu_pd(&U1[i+1]);
      vmmx02 = _mm_loadu_pd(&U1[i-1]);

      vmmx10 = _mm_mul_pd(va,vmmx00);   // U0[i][j] = -2.0*U1[i][j];
      vmmx10 = _mm_add_pd(vmmx10,vmmx01);   // U0[i][j] = U0[i][j] + U1[i+1][j];
      vmmx10 = _mm_add_pd(vmmx10,vmmx02);   // U0[i][j] = U0[i][j] + U1[i-1][j];
      vmmx10 = _mm_mul_pd(vb,vmmx10);   // U0[i][j] = U0[i][j] * InvDxDx;

      vmmx10 = _mm_mul_pd(vd,vmmx10);   // U0[i][j] = U0[i][j] * DtAlpha;
      vmmx10 = _mm_add_pd(vmmx10,vmmx00);   // U0[i][j] = U0[i][j] + U1[i][j];

      _mm_store_pd(&U0[i],vmmx10);

      // U1[i][j] = U0[i][j] + DtAlpha*( (U0[i+1][j]-2.0*U0[i][j]+U0[i-1][j])*InvDxDx
    }

 }

 time1=clock();
 printf("Loop 0, total time : %f \n", (double) time1-time0);
 f1 = fopen ("out0.dat", "wt");
 for( i = 1; i < n1-1; i++)
 {
       fprintf (f1, "%d\t%f\n", i, U0[i]);
 }

// REF

   for( i = 0; i < n1; i++){U0[i] = 0.0;}
   U0[1] = 1.0;
   U0[2] = 1.0;
   U0[3] = 1.0;
   U0[n1-2] = 2.0;

 time0=clock();

 for( t = 0; t < niter; t++)
 {

    for( i = 2; i < n1-2; i++)
    {
       U1[i] = U0[i] + DtAlpha* (U0[i+1]-2.0*U0[i]+U0[i-1])*InvDxDx;
    }

    for( i = 2; i < n1-2; i++)
    {
       U0[i] = U1[i] + DtAlpha* (U1[i+1]-2.0*U1[i]+U1[i-1])*InvDxDx;
    }

 }

 time1=clock();
 printf("Loop 0, total time : %f \n", (double) time1-time0);
 f1 = fopen ("outref.dat", "wt");
 for( i = 1; i < n1-1; i++)
 {
       fprintf (f1, "%d\t%f\n", i, U0[i]);
 }

} 
```

++++++++++++++++++++++++++++++++++++++++++++++++++++++ ++++++++++

**编辑 ：**

++++++++++++++++++++++++++++++++++++++++++++++++++++++ ++++++++++

考虑到你的回答，我找到了合适的地方来讨论这个问题，所以我将扩大话题并解释我的目标。如果您接受，我们将一个接一个地讨论所有循环。这可能很长，但对于我所在领域的很多人以及像 OpenFoam 这样的开源求解器来说，它可能非常有用。不考虑对能源消耗的影响（我们都使用大型超级计算器）。

我使用的 CFD 代码在 512 个 Westmer Core 上运行了 1 个多月。我正在使用 MPI（消息传递接口）在 procs 之间进行通信。物理场可以被视为一个网格，因此是 1D、2D 或 3D 阵列，具体取决于模拟的类型。但是 3D 是你能想象到的最好的。

完整的代码在 Fortran 95 中，实际上是 C 语言的简化。它很容易与 C 接口，并且 C 例程可以直接从 Fortran 调用，类型相同（int、double、long 等）。但是，Fortran 不允许这样的优化：它的设计很简单。这就是我研究 C 指令的原因。

在所有 CFD 代码中，我们都面临着相同的问题：3 种类型的循环和 MPI 内存分配。让我们首先讨论一下循环：

*   空间导数（称为有限差分）：循环由**所有情况下**的 1D 卷积组成（1D、2D、3D，一次只能在一个轴上推导）（DF = F[i-1]*A + F[i ]*B + F[i+1]*C)。但是，当使用超过 1D 时，内存访问变为以下内容：

    ```
    // x1 derivative
    for i 1 -> n1
        for j 1 ->n2
            DF_x1[i][j] = F[i-1][j]*A + F[i][j]*B + F[i+1][j]*C

    // x2 derivative
    for i 1 -> n1
        for j 1 ->n2
            DF_x2[i][j] = F[i][j-1]*D + F[i][j]*E + F[i][j+1]*G 
    ```

    在第一个循环中，内存访问不继续（Fortran 中的反转，内存被反转）。这是第一个问题。使用 3D 数组时同上。

*   泊松方程分辨率，即矩阵乘法：循环由 1D、2D 或 3D 卷积组成，**具体取决于模拟**。这实际上是二阶导数 (DDF = D(DF))。

    ```
    for i 1 -> n1
        for j 1 ->n2
            DDF[i][j] = F[i-1][j]*A + F[i][j]*B + F[i+1][j]*C + F[i][j-1]*D + F[i][j]*E + F[i][j+1]*G 
    ```

    这个循环和我第一次给你的循环是一样的，但是它是直接计算的，不是偶数和奇数。

*   加权高斯赛德尔分辨率，即与波纹管相同的循环，但具有依赖性：

    ```
    // even
    for i 1 -> n1
        for j 1 ->n2
            F1[i][j] = F0[i-1][j]*A + F0[i][j]*B + F0[i+1][j]*C + F0[i][j-1]*D + F0[i][j]*E + F0[i][j+1]*G

    //odd
    for i 1 -> n1
        for j 1 ->n2
            F0[i][j] = F1[i-1][j]*A + F1[i][j]*B + F1[i+1][j]*C + F1[i][j-1]*D + F1[i][j]*E + F1[i][j+1]*G 
    ```

    这是您之前调查的循环。

然后，我们面临另一个问题：内存分配。每个核心都有自己的内存，需要与其他人共享。让我们考虑最后一个循环，但经过简化：

```
 for t 1 -> niter

        // even
        for i 1 -> n1-2
                F1[i] = F0[i-1]*A + F0[i]*B + F0[i+1]*C

        //odd
        for i 1 -> n1-2
                F0[i] = F1[i-1]*A + F1[i]*B + F1[i+1]*C 
```

考虑 n1=512，但由于 RAM 容量低，无法将其存储在本地内存中。内存分布在 core0 (1->255) 和 core1 (256-512) 上，它们不在同一台计算机上，而是在网络上。在这种情况下，i=256 中的导数需要知道点 i=255，但是这个值在另一个 proc 上。包含其他处理器值的内存称为 GHOST 内存。所以循环是：

```
 ! update boundary memory :
    Share to ghost : core0 : F0[255] -> Network -> F0[0] : core1 (don't forget that for core1, the array restart from 0)
    Share to ghost : core1 : F0[1] -> Network -> F0[256] : core0 (you understand that F0[256] is the ghost for core0, and F0[0] is the ghost for core1)
    // even, each core do this loop.
    for i 1 -> n1-2
            F1[i] = F0[i-1]*A + F0[i]*B + F0[i+1]*C

    ! update boundary memory :
    Share to ghost : core0 : F1[255] -> Network -> F1[0] : core1
    Share to ghost : core1 : F1[1] -> Network -> F1[256] : core0

    //odd, each core do this loop.
    for i 1 -> n1-2
            F0[i] = F1[i-1]*A + F1[i]*B + F1[i+1]*C 
```

我们需要处理这个问题。**神秘**的，你现在明白我要去哪里了：循环交错需要考虑到这一点。我认为这可以通过这种方式完成：

```
 ! update boundary memory :
        Share to ghost : core0 : F0[255] -> Network -> F0[0] : core1 
        Share to ghost : core1 : F0[1] -> Network -> F0[256] : core0

        for t 1 -> niter

        ! compute borders in advance :
        core0 only : F1[255] = F0[254]*A + F0[255]*B + F0[256]*C
        core1 only : F1[1] = F0[0]*A + F0[1]*B + F0[2]*C

        Launch Share to ghost asynchronous : core0 : F1[255] -> Network -> F1[0] : core1 
        Launch Share to ghost asynchronous : core1 : F1[1] -> Network -> F1[256] : core0

        During the same time (this can be done at the same time because MPI support asynchronous communications)
        // even
        for i 2 -> n1-3 (note the reduced domain)
                F1[i] = F0[i-1]*A + F0[i]*B + F0[i+1]*C

        Check that communications are done.

        ! compute borders in advance :
        core0 only : F0[255] = F1[254]*A + F1[255]*B + F1[256]*C
        core1 only : F0[1] = F1[0]*A + F1[1]*B + F1[2]*C

        Launch Share to ghost asynchronous : core0 : F0[255] -> Network -> F0[0] : core1 
        Launch Share to ghost asynchronous : core1 : F0[1] -> Network -> F0[256] : core0

        //odd, each core do this loop.
        for i 2 -> n1-3
                F0[i] = F1[i-1]*A + F1[i]*B + F1[i+1]*C

        Check that communications are done. 
```

希望我没有在某处犯错索引。让我们暂时考虑第一种类型的循环，这是最简单的，然后我们可以通过循环 2 和 3，它们是相似的。目的是这样做（类似于图像处理）：

```
 // x1 derivative
    for i 1 -> n1
        for j 1 ->n2
            DF_x1[i][j] = F[i-1][j]*A + F[i][j]*B + F[i+1][j]*C

    // x2 derivative
    for i 1 -> n1
        for j 1 ->n2
            DF_x2[i][j] = F[i][j-1]*D + F[i][j]*E + F[i][j+1]*G 
```

我正在处理它，我将在几个小时内发布结果代码，同时考虑到您的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T17:47:42.513

Mysticial 在代码中的明智之言：

```
 xmm7 = InvDxDx * dtAlpha; // precalculate
  xmm6 = -2*xmm7;
  xmm0 = *ptr++;   // has values d0, d1
  xmm1 = *ptr++;   // has values d2, d3
  while (loop--) {
     xmm2  = xmm0;  // take a copy of d0,d1
     xmm0 += xmm1;  // d0+d2, d1+d3
     xmm2 = shufps (xmm2,xmm1, 0x47);  // the middle elements d1,d2 ??
     xmm0 *= xmm7;  // sum of outer elements * factor
     xmm2 *= xmm6;  // -2 * center element * factor
     // here's still a nasty dependency
     xmm2 += xmm0;
     xmm0 = xmm1;    // shift registers
     *out_ptr ++= xmm2;  // flush
     xmm1 = *ptr++;  // read in new values

  } 
```

这可以通过将循环分成 2 个部分来改进，每个部分工作 502 个条目，它们与不同的任务分开或来自不同的任务，并交错结果，这打破了依赖链。

此外，移位寄存器方法 xmm0 <- xmm1, xmm1 <- new 可以通过展开循环两次并每隔一种情况更改 xmm0 和 xmm1 的含义来避免。

这指出了另一个大问题：使用内部函数时，寄存器一直溢出到内存中。

# rrdtool - 将新数据源添加到现有 RRD

> ID：13476226
> 
> 赞同：8
> 
> 时间：2012-11-20T15:15:28.953
> 
> 标签：rrdtool, rrd

我有几百个 rrd，我想为所有这些 rrd 添加 5 个额外的数据源。

1.  这样做是否可取
2.  最好的方法和最快的方法是什么

--**索恩**--

**David OBrien 在邮件列表中回复**

在搜索档案（你应该先完成）和谷歌搜索后，我发现有几个人在使用它......

用 perl。安装RRD：简单

```
#!/usr/local/bin/perl 

use strict; 
use RRD::Simple (); 

my $rrd = RRD::Simple->new(); 
my $rrdfile=$ARGV[0]; 
my $source=$ARGV[1]; 
my $type=$ARGV[2]; 
chomp($type); 
$rrd->add_source($rrdfile, $source => $type); 
```

用法：

```
./addSource.pl file.rrd ds GAUGE 
```

或任何类型..

享受。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T15:10:12.563

使用 rrddump 和 rrdrestore。

就这样：

```
rrdtool dump my.rrd > file.xml

./rrdAddDS.pl file.xml newDsName > new_file.xml

rrdtool restore new_file.xml my_new.rrd 
```

你可以从这里参考：http: [//osdir.com/ml/db.rrdtool.user/2003-08/msg00115.html](http://osdir.com/ml/db.rrdtool.user/2003-08/msg00115.html)

在这里： http: [//www.docum.org/drupal/sites/default/files/add_ds_to_rrd.pl_.txt](http://www.docum.org/drupal/sites/default/files/add_ds_to_rrd.pl_.txt)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-11T17:28:07.857

如果您使用 PNP4Nagios ( [https://docs.pnp4nagios.org/pnp-0.6/start](https://docs.pnp4nagios.org/pnp-0.6/start) )，它们提供了一个实用脚本*rrd_modify.pl*用于修改现有的 RRD 数据文件。

```
 $ rrd_modify.pl -h

   === rrd_modify.pl 0.01 ===
   Copyright (c) 2012 PNP4Nagios Developer Team (http://www.pnp4nagios.org)

   This script can be used to alter the number of data sources of an RRD file.

   Usage:
   rrd_modify.pl RRD_file insert|delete start_ds[,no_of_cols] [type]

   Arguments:
   RRD_file
      the location of the RRD file. It will NOT be overwritten but appended
      by ".chg"
   insert or delete
      the operation to be executed
   start_ds
      the position at which the operation starts (1..no of data sources+1)
   no_of_cols
      (an optional) number of columns which will be added/deleted
   type
      the data type (one of GAUGE, COUNTER)
                Defaults to GAUGE if not specified for insert operations
        (DERIVE, ABSOLUTE, COMPUTE have not been tested and might result in
                 errors during creation of a new RRD file) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-28T07:39:32.113

由于 1.5 版可以使用该选项`rrdtool create`“预填充”现有文件中的数据。`--source`此功能无需额外脚本即可解决问题。

还请参见：Matija Nalis 的评论如下。

# git - 将标签名称（版本号）附加到 git post-receive 挂钩中的 Zip 文件

> ID：13476228
> 
> 赞同：0
> 
> 时间：2012-11-20T15:15:29.890
> 
> 标签：git, git-post-receive

在 Git 中，我试图在接收后挂钩中获取提交的版本号（通过使用标签）。

获得该标签后，我想压缩某个目录并将版本号附加到其中（例如：myplugin-2.0.1.zip），但我不确定如何在 post-receive 中获取提交的标签钩。

有谁知道如何在 post-receive 挂钩中正确获取提交的标签名称？

这是我到目前为止所拥有的，但 SOME_WAY_OF_GETTING_TAG_NAME 是我感到困惑的地方。

```
#!/bin/bash
_version=SOME_WAY_OF_GETTING_TAG_NAME
zip -r myplugin-$_version.zip plugin_repo/ 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:34:17.910

接收后挂钩作为标准输入的输入

```
<oldrev> <newrev> <refname> 
```

refname 总是包含 ref，如果你标记，它将是`refs/tags/TAGNAME`

# mysql - 不小心卸载了mysql服务器

> ID：13476229
> 
> 赞同：3
> 
> 时间：2012-11-20T15:15:29.287
> 
> 标签：mysql, installation, admin, uninstallation, recovery

我正在使用 Centos。在生产服务器上，我们似乎不小心卸载了 mysql 服务器

我们仍然在 /var/mysql 中看到我们的 DB 文件夹

我们可以做些什么来恢复我们的所有数据。

请确定您的建议，这是客户生产级别的数据。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:19:22.853

该死。不要告诉客户；）

一个预先步骤......如果服务器仍在运行，如果您的服务器正在从某个地方复制或者是其他人的主服务器，请尝试获取复制信息。这本身就是一篇文章，但由于我猜测您的 MySQL 服务器已关闭并且您将无法执行此操作，因此我不会详细介绍它。

1.  在安全的地方复制 /var/mysql 的所有内容和 /etc/my.cnf 文件（确保保留权限）
2.  安装完全相同版本的 mysql 并验证它是否正常工作
3.  关闭新的mysql
4.  备份默认新安装的 /var/mysql 以备不时之需
5.  将原始 /var/mysql 文件以及原始 /etc/my.cnf 复制回来
6.  祈祷，启动 MySQL，然后继续前进
7.  如果需要，设置复制设置

如果您没有进行复制，则第 8 步将研究设置复制，以便您可以在下次发生这种情况并且有人实际删除您的数据库文件时保存您的问题。（发生在我身上）

# android - Aviary 返回的图像尺寸小于原始尺寸

> ID：13476231
> 
> 赞同：7
> 
> 时间：2012-11-20T15:15:46.850
> 
> 标签：android, image-processing, aviary

我正在使用 Aviary 在我的 android 应用程序中编辑图像，但我发现返回的图像小于原始图像。

例如，我将一个 2560x1920 的大图像传递到 aviary，但返回的图像是 480x640。

这是我的代码：

```
private void startFeather(Intent data) {
    File file = getBitmapFromResult(data);

    BitmapInfo bitmap = Helper.getBitmap(file, App.screenWidth, 0);
    toastLong("raw photo: " + bitmap.getWidth() + "x" + bitmap.getHeight());

    Uri uri = Uri.fromFile(file);

    this.featherOutputFile = new File(App.Path.tempDir(), "111" + ".jpg");

    // Create the intent needed to start feather
    Intent newIntent = new Intent(self, FeatherActivity.class);

    // set the source image uri
    newIntent.setData(uri);

    // pass the required api key ( http://developers.aviary.com/ )
    String API_KEY = "aaabbbccc";

    newIntent.putExtra("API_KEY", API_KEY);

    // pass the uri of the destination image file (optional)
    // This will be the same uri you will receive in the onActivityResult
    newIntent.putExtra("output", Uri.parse("file://" + featherOutputFile.getAbsolutePath()));

    // format of the destination image (optional)
    newIntent.putExtra("output-format", Bitmap.CompressFormat.JPEG.name());

    // output format quality (optional)
    newIntent.putExtra("output-quality", 100);

    // you can force feather to display only a certain tools
    // newIntent.putExtra( "tools-list", new String[]{"ADJUST", "BRIGHTNESS" } );

    // enable fast rendering preview
    newIntent.putExtra("effect-enable-fast-preview", true);

    // limit the image size
    // You can pass the current display size as max image size because after
    // the execution of Aviary you can save the HI-RES image so you don't need a big
    // image for the preview
    newIntent.putExtra("max-image-size", App.screenWidth);
    newIntent.putExtra("effect-enable-external-pack", false);
    newIntent.putExtra("stickers-enable-external-pack", false);
    newIntent.putExtra("effect-enable-borders", false);

    // HI-RES
    // You need to generate a new session id key to pass to Aviary feather
    // this is the key used to operate with the hi-res image ( and must be unique for every new instance of Feather )
    // The session-id key must be 64 char length
    String mSessionId = StringUtils.getSha256(System.currentTimeMillis() + API_KEY);
    newIntent.putExtra("output-hires-session-id", mSessionId);

    // you want to hide the exit alert dialog shown when back is pressed
    // without saving image first
    // newIntent.putExtra( "hide-exit-unsave-confirmation", true );

    // ..and start feather
    startActivityForResult(newIntent, INTENT_FEATHER);
} 
```

我想念什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-08T14:29:09.267

终于得到了解决方案。它在 Aviary android 示例应用程序中提到

```
final DisplayMetrics metrics = new DisplayMetrics();
        getWindowManager().getDefaultDisplay().getMetrics( metrics );
        int max_size = Math.max( metrics.widthPixels, metrics.heightPixels );
        max_size = (int) ( (float) max_size / 1.2f );
        newIntent.putExtra( Constants.EXTRA_MAX_IMAGE_SIZE, max_size ); 
```

# zsh - 使用 Zsh 启动 iTerm2

> ID：13476232
> 
> 赞同：103
> 
> 时间：2012-11-20T15:15:51.547
> 
> 标签：zsh, iterm2

我一直在研究 iTerm2 的设置，但我似乎找不到让它启动 Zsh 而不是 Bash 的方法，有人知道在 iTerm2 中执行此操作的正确方法吗？

我问这个是因为我来自 Mac Terminal，它很容易让你选择在启动时运行什么，但我似乎无法用 iTerm2 直接找到一些东西。

我在 Google 上搜索它，但由于某种原因，我只能找到 oh-my-zsh 引用，与未修改的 iTerm2 无关。

感谢您提供的任何帮助，谢谢。:)

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2012-11-20T15:17:15.720

`chsh -s /bin/zsh`通过运行命令将默认 shell 更改为 /bin/zsh 。

* * *

## 回答 #2

> 赞同：68
> 
> 时间：2014-07-28T08:43:03.967

尽管更改`chsh -s $(which zsh)`对我来说非常有效，但我的 iTerm2 不会自动使用 zsh 打开新终端。

相反，我去`iTerm2 -> Preferences -> Profiles -> Default`并在`General`选项卡中将命令设置为`/usr/local/bin/zsh`而不是`Login shell`.

**更新：**使用当前版本的 iTerm（从 2.1.1 开始），只需更改默认 shell（如上所示），它就可以完美地为我工作。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2020-10-27T02:52:30.853

以下内容也对我有用：

首选项 -> 配置文件 -> 常规选项卡 -> 命令 -> 选择“自定义 Shell” -> 编写“zsh”

重启 iTerm2。

我仍然将终端的 bash 作为默认 shell。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2016-05-11T19:35:46.930

类似于上面的答案：编辑我创建的 zsh 配置文件，在常规选项卡上，在“开始时发送文本：”字段中，我有“clear; pwd; ls; zsh;” 这给我留下了一个窗口，向我展示了我想看到的内容，最后启动了 zsh。

# vb.net - 如何点击网站上的按钮？

> ID：13476238
> 
> 赞同：1
> 
> 时间：2012-11-20T15:16:11.240
> 
> 标签：vb.net, vba

我正在尝试单击网站上的某个按钮。这是它的代码。

```
<div id="ff_submit_button">

<input type="image" onclick="javascript:return preFareFinderSubmitActions('The following information is needed to process your request:', 'Problem Pricing the Itinerary: Atlantic City Express Service offers adult fares only for all passengers.  Please modify your selection to continue. \n[Error ID: 1121S]')" src="/images/en/btn_ff_go.gif" alt="Click to Find Tickets" border="0" name="_handler=url.presentation.handler.request.rail.urlRailSearchRequestHandler/_xpath=/sessionWorkflow/productWorkflow[@product='Rail']">

</div> 
```

目前，我在按钮中使用此代码点击“alt="Click to find Tickets"。

```
 For Each webpageelement As HtmlElement In allelements

        If webpageelement.GetAttribute("alt") = "Click to Find Tickets" Then
            webpageelement.InvokeMember("click")

        End If 
```

它可以工作，但问题是网站上的另一个区域也使用了该 alt。因此它要求输入用户名和密码。我的代码行目前在一个按钮中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:26:15.807

而不是`alt`，要检查的更好的元素是`id`- 这[意味着提供一个唯一的 identifier](http://reference.sitepoint.com/html/core-attributes/id)，尽管您需要将它添加到您的输入标签中。

# c - 使 C 程序更小

> ID：13476240
> 
> 赞同：4
> 
> 时间：2012-11-20T15:16:12.557
> 
> 标签：c

我有一个非常小的 C 程序可以反转文件。它在 Windows 上编译`exe`为大小为 28,672 字节的文件。

*   减小文件大小的最佳方法是什么？
*   有没有什么工具可以告诉我什么占用的空间最多？（包括库）
*   对于这么简单的程序，这个大小正常吗？
*   我应该使用哪些编译器标志来减小文件大小（`/O1`并且`/Os`似乎没有任何效果）？

顺便说一句 - 编译时`gcc`我得到大约 50Kb 的文件，编译时`cl`我得到 28Kb。

*编辑：这是代码*

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main(int argc, char *argv[])
{
   FILE *fi, *fo;

   char *file1, file2[1024];
   long i, length;
   int ch;

   file1 = argv[1];

   file2[0] = 0;
   strcat(file2, file1);
   strcat(file2, ".out");

   fo = fopen(file2,"wb");
   if( fo == NULL )
   {
      perror(file2);
      exit(EXIT_FAILURE);
   }

   fi = fopen(file1,"rb");
   if( fi == NULL )
   {
      fclose(fo);
      return 0;
   }

   fseek(fi, 0L, SEEK_END);
   length = ftell(fi);
   fseek(fi, 0L, SEEK_SET);

   i = 0;
   while( ( ch = fgetc(fi) ) != EOF ) {
      fseek(fo, length - (++i), SEEK_SET);
      fputc(ch,fo);
   }

   fclose(fi);
   fclose(fo);
   return 0;
} 
```

**更新：**

*   编译`/MD`产生一个 16Kb 的文件。
*   用`tcc`(Tiny C Compiler) 编译产生一个 2Kb 的文件。
*   编译`gcc -s -O2`产生了一个 8Kb 的文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T15:19:46.843

尝试使用 tcc 编译它：http: [//bellard.org/tcc/](http://bellard.org/tcc/)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T15:24:04.990

```
#include <stdio.h> 
```

让实现了自己版本的 stdio 函数的人说：它们很大，而且有些相互依赖。链接其中一个会自动链接到其他几个。

由于这是一次性成本，并且在大型应用程序的范围内无关紧要，因此大多数库都不会费心优化它。

话虽如此，编译成*动态*链接的可执行文件而不是静态的可执行文件通常是要走的路。如果您*必须*有一个静态链接的可执行文件，您可能需要查看为嵌入式环境优化的库之一，因为它们更专注于像这样的小尺寸优化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T15:22:55.837

您使用哪些库？除了标准库之外，您不需要任何库来反转 C 中的文件。那么你的可执行文件应该不超过 2kb。

但是，如果我编译：

```
int main()
{
    return 0;
} 
```

使用 MinGW，可执行文件的大小等于 48kb。但我没有使用任何优化标志。

编辑：使用 -s 标志，它减少到 7,5 kb。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T15:38:12.600

查看[`-s`](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html#Link-Options)gcc 标志：

> -s 从可执行文件中删除所有符号表和重定位信息。

我正在开发的小型 C 程序测试：

没有`-s`: **120,2 Kib**

`-s`含：58,3 **基布**

通过从可执行文件中删除死代码：

通过使用`-fdata-sections -ffunction-sections`，编译器会将未使用的函数放入分隔部分，通过使用`-Wl,--gc-sections`将被链接删除。

现在的文件大小是：**50,2 Kib**

经过`-O2`

做很多优化，但不增加文件大小，通常，不像。

现在的文件大小是：**42,1 KiB**

gcc 有太多`-O*`的优化有利于文件大小。

# angularjs - AngularJS 与 node-webkit

> ID：13476243
> 
> 赞同：4
> 
> 时间：2012-11-20T15:16:17.887
> 
> 标签：angularjs, node-webkit

我现在正在评估 node-webkit 作为使用 Web 技术构建桌面应用程序的可能解决方案，并且有一个小问题。该应用程序正在使用 AngularJS，我遇到的问题是似乎没有正确加载我的 html 模板文件。

我的测试应用程序有这个配置：

```
nucleusApps.config(['$locationProvider', '$routeProvider', function($locationProvider, $routeProvider) {
  $locationProvider.html5Mode(true);
  $routeProvider
    .when('/style', {
      templateUrl: '/templates/core/style.html',
      controller: nucleusApps.controllers.Style
    })
    .otherwise({redirectTo: '/style'});
}]); 
```

问题是我收到以下错误：

```
Failed to load resource     file://templates/core/style.html 
```

我为 templateUrl 尝试了多种不同的格式，包括：

```
./templates/core/style.html
file://template/core/style.html 
```

但我不断收到这个错误。我的目录结构也是：

```
-index.html
-package.json
-css
  -file.css
  -etc...
-templates
  -core
    style.html
-etc... 
```

这就是被拉上拉链的东西。

你知道我为什么会收到这个错误吗？

**- 更新 -**

不知道这里发生了什么，但刚刚更新了我的代码（我正在构建的网络版本），现在一切正常。旧代码中一定有一些奇怪的东西

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T17:30:05.600

我还没有使用 html5mode，但问题就在这里。[$位置提供者，](http://docs.angularjs.org/guide/dev_guide.services.%24location)

# c# - GraphicsPath 和 Region - 交集

> ID：13476244
> 
> 赞同：0
> 
> 时间：2012-11-20T15:16:20.467
> 
> 标签：c#, gdi, intersection

我编写了一个在给定路径上/上/下绘制字符串的程序。问题是我需要检查实际绘制的字母和所有以前的字母之间的交叉点。我这样做了，而且效果很好。唯一的问题是关于性能。

```
private void RemoveOverlapping(Graphics gr, float angle, float x, float y, GraphicsPath graphicsPath)
{
    Matrix matrix = new Matrix();
    for (;;)
    {
        matrix.Reset();
        matrix.RotateAt(angle, new PointF(x, y));
        graphicsPath.Transform(matrix);

        bool isOverlapping = false;
        Region letterRegion = new Region(graphicsPath);
        foreach (Region region in _previousRegions)
        {
            region.Intersect(letterRegion);

            if (!region.IsEmpty(gr))
            {
                matrix.Reset();
                matrix.RotateAt(360f - angle, new PointF(x, y));
                graphicsPath.Transform(matrix);

                matrix.Reset();
                matrix.Translate(1, 0);
                graphicsPath.Transform(matrix);

                isOverlapping = true;
                break;
            }
        }

        letterRegion.Dispose();

        if (!isOverlapping)
            return;
    }
} 
```

我做了`Alt+F2`测试，它告诉我这`region.IsEmpty()`需要大部分计算时间......还有其他方法（不实施额外的算法）来检查两个`Regions/GraphicsPaths`交叉点吗？

它是这样的：
![着作](../Images/3609966a1c56bc7d2f1b01afe8a3d6e6.png)

# java - 用 Java 构建 GPS 跟踪应用程序

> ID：13476249
> 
> 赞同：2
> 
> 时间：2012-11-20T15:16:54.880
> 
> 标签：java, swing, google-maps, google-maps-api-3, gps

我需要构建一个（PC）软件应用程序来从 GPS 模块获取读数并在地图中显示模块位置。

该模块将连接到一个机器人，一个空中机器人。最好在谷歌地图（或类似地图，如果有的话）上显示它的位置并实时更新。

我对这类问题没有任何经验。实际上，我什至不知道这是否可能。任何有用的信息都非常感谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:27:27.447

`JXMapViewer`可以帮助您完成您正在寻找的东西。[这是](http://today.java.net/pub/a/today/2007/10/30/building-maps-into-swing-app-with-jxmapviewer.html)一篇关于如何使用它的有点过时的文章。

好的部分是您可以将后端更改为您想要的任何映射服务提供商（请参阅[此处](http://weblogs.java.net/blog/joshy/archive/2006/07/getting_started.html)）。默认使用[OpenStreetMap](http://www.openstreetmap.org/)。

编辑：使用 JXMapViewer 将需要[swingx-ws](http://java.net/projects/swingx-ws)项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:48:15.083

1.  您需要一个 GPS 模块
2.  您需要将模块与您的 PC（应用程序）连接以读取 GPS 数据。这取决于设备提供的连接性。
3.  应该有供应商提供的应用程序附带 GPS 模块，这些应用程序将为您提供 LA 和 LO（地理详细信息）。使用它们定期将此信息转储到文件中。
4.  让您的 java 应用程序查找文件中的任何修改并获取数据。现在您可以使用这些数据创建带有 google map/ 或 wiki map 的路径

# jquery - jquery可拖动隐藏内容

> ID：13476251
> 
> 赞同：3
> 
> 时间：2012-11-20T15:17:00.267
> 
> 标签：jquery, draggable, jquery-ui-sortable, hidden

我正在使用可拖动和可排序的列表在它们之间拖动和排序项目。但是，我拥有的项目是可滑动的（即单击它们会显示/隐藏内容）。当我将一个项目从一个列表拖到另一个列表时，滑动效果会丢失。此外，如果我有一个隐藏了其子节点的项目，并且我将该项目拖动到另一个列表，则仅拖动该项目（没有任何子内容）。这是代码

[http://jsbin.com/ujivav/1/edit](http://jsbin.com/ujivav/1/edit)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:29:56.393

KHY 是正确的，但您也可以更改`click`要使用的事件`on`，如下所示：

```
$('body').on('click', '.clicktohide',function(){
    $(this).siblings().slideToggle('fast');
}); 
```

这是一个例子[http://jsbin.com/ujivav/4/edit](http://jsbin.com/ujivav/4/edit)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:27:24.070

我相信这是因为一旦加载了初始页面，就会发生与“click”事件的绑定。鉴于在您的示例中，在被拖动后，具有“.clicktohide”类的元素被复制，复制的元素不在“click”事件所绑定的选择中。

我想您必须通过实现在触发“停止”事件时调用的回调函数来将此事件绑定到拖动的元素上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:32:00.293

它看起来不像“克隆”重新创建事件处理程序，只是 DOM 元素。尝试在“停止”事件上手动复制。这样你就可以告诉它如何处理新的 DOM 元素。

# c# - Visual Studio 2012 MVC 3 多个不需要的线程

> ID：13476254
> 
> 赞同：0
> 
> 时间：2012-11-20T15:17:06.697
> 
> 标签：c#, multithreading, asp.net-mvc-3, entity-framework, visual-studio-debugging

我有一个在 Visual Studio 2012 中创建并一直在使用的 MVC 3 C# 项目。我也在使用实体框架。调试时，我得到已知的“自上一步以来进程或线程已更改”。调试图标上的消息。有一段时间，它并没有改变程序的行为，所以我忽略了它。

然而，最近，我收到了相同的消息和行为（调试器跳回到断点所在的已执行方法的开头），只是现在我的代码实际上被执行了两次。我的意思是现在任何数据库插入都至少运行两次。知道我也在使用实体框架可能会有所帮助，并且我的插入都是通过导入一个执行简单插入的存储过程来完成的。

在我的代码中，我没有明确地启动新线程或尝试执行任何多线程。我对多线程不是很熟悉，但是当我调试和使用线程窗口时，我看到一个主线程有7个线程，还有两个工作线程。（对不起，我会发布图片，但我是新用户，他们不会让我）。

然后，当我按F5继续时，我的单断点又被击中，我看到一个主线程，3个线程，6个！！工作线程。

我在哪里可以查看在哪里/为什么有多个线程正在旋转？另外，自上一步消息以来，我可以做些什么来改变流程？我已经研究了几个星期没有解决方案。

预先感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T04:35:49.727

所以我弄清楚了问题所在。两次将事物保存到数据库的问题是由于**页面上有两次不显眼的 ajax**（一次在我的布局页面中，一次在单个页面上）。

查看多个线程的问题似乎**与浏览器有关**，因为我没有在我的应用程序中执行任何类型的线程。虽然小图标和方法的后退很烦人（*我想在某个时候解决它*），但它实际上并没有改变应用程序的行为。

# ruby-on-rails - Rails UJS - 第一次操作后无法触发 jquery

> ID：13476255
> 
> 赞同：1
> 
> 时间：2012-11-20T15:17:11.710
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery, ujs

在我的 show.html.haml 视图中，我有一个表单，用户可以在其中更改一些设置。我刚刚更新为使用 Rails UJS，当我的用户更改下拉菜单时，他们看到 jquery shizzle 正在做这件事。

我在 show.js 文件中真正做的就是刷新表单所在的部分并闪烁错误消息。

问题是一旦更新一次，jquery 下拉选择就不起作用了。我认为这是因为它正在渲染 update.js 视图——因此我包含了这个文件。但是，仍然没有任何反应，并且我在日志中没有任何错误。

在 show.html.haml 我有（简化）：

```
#show_form
  = render "show" 
```

我的节目部分包含：

```
= semantic_form_for @product_order, :remote => true do |f| 
  = f.select :shipping_method, options_for_select(ProductOrder::Couriers, :selected => @product_order.shipping_method) 
```

我的 show.js.erb 和 update.js.erb 包含：

```
$("#show_form").html("<%= escape_javascript(render("show")) %>");
$("#status_banner").effect("highlight", {}, 3000);
$("#status_banner").html("<h2>ORDER STATUS: <%= (@product_order.state.titlecase) %></h2>");
$("#status_banner").removeClass("alert").addClass("alert <%= (@product_class) %>"); 
```

在我的 product_order.js.coffee 我有这个：

```
jQuery ->
  $("#dropdown_select").change ->
    $(this).closest("form").submit()
    $(this).serialize()
    null
    "script"
    false 
```

就像我说的，第一个操作有效，但在第一次更新后失败。我的控制器更新操作有点笨重，但我确保包含 format.js。我还尝试将 respond_to :js 放在控制器的顶部。

我做错了还是有一个我看不到的简单修复？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:44:08.623

您的问题是刷新表单后，您的 js 不会触发，因为从技术上讲，它是 DOM 中的一个新元素。您需要像这样使用 jquery 事件绑定：

```
jQuery ->
  $("#dropdown_select").on "change", ->
    $(this).closest("form").submit()
    $(this).serialize()
    null
    "script"
    false 
```

# p2p - 在 Gnutella 中，PUSH 如何通过防火墙或 NAT 框工作？

> ID：13476256
> 
> 赞同：2
> 
> 时间：2012-11-20T15:17:10.683
> 
> 标签：p2p, nat

我正在尝试更多地了解 Gniutella P2P 协议的工作原理。我已经阅读了 GnuFU 和我能找到的最新协议规范 (0.4)，但我对 PUSH 如何通过防火墙或 NAT 框工作有一些疑问。

案例 1：Alice 通过 NAT 框或防火墙连接到 Internet。她看到 Bob 有一个她想要下载的文件。Bob 没有防火墙。所以 Alice 的客户端打开一个到 Bob 机器的 TCP 连接并下载文件。没问题。

情况 2：与 #1 相同，只是 Bob 想从 Alice 那里得到一个文件。Bob 的客户端无法打开与 Alice 计算机的 TCP 连接，因为它位于防火墙后面。根据我的阅读，Bob 的客户端需要向 Alice 的机器发送一个 PUSH 命令。Alice 的机器收到 PUSH，打开与 Bob 机器的 TCP 连接，并将文件发送给 Bob。我说的对吗？

我的问题： 1) PUSH 数据包如何从 Bob 发送到 Alice？Bob 不能直接发送它，因为他无法打开到 Alice 的 TCP 连接，因为她在防火墙后面。它是否被缓存在某个地方？如果是这样，爱丽丝怎么会知道去寻找它？

2) 这是否仅在 Alice 的 NAT 盒支持 uPNP 和/或端口转发时才有效？如果是这样，如果 Alice 和 Carol 位于同一个 NAT 盒子后面怎么办——路由器如何知道 Bob 试图将 PUSH 发送到哪台计算机？

3) 假设 Alice 试图将一个文件推送到 Bob 的机器上，但 Bob 没有请求该文件。Bob 机器上的服务端是否仍然收到它？还是它拒绝传入的文件？

谢谢，迈克

# vim - 如何使用 sed 或 vim 将 {{{...}}} 转换为 markdown 代码块？

> ID：13476260
> 
> 赞同：2
> 
> 时间：2012-11-20T15:17:19.790
> 
> 标签：vim, replace, sed, newline, multiline

我怎样才能转换评论像

```
{{{
abc
def
}}} 
```

降价评论，如

```
 abc
    def 
```

（每行开头有 4 个空格）在 vim 或 sed 中？

我尝试了以下但我没有得到第一行之后的空格：

```
:%s/{{{\n\(\_.*\)\n}}}/    \1/ 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:37:05.680

用 vim：

```
:g/{{{/,/}}}/le 4|d|/}}}/d 
```

解释：

*   `:g/{{{/`使用模式在每一行上运行一个命令`{{{`
*   `,/}}}/le 4`从当前行到结尾左对齐`}}}`
*   `d`删除当前行
*   `/}}}/d`搜索匹配的行`}}}`并将其删除

根据您的缩进设置，使用`>`而不是`le 4`可能是排序器。

如需更多帮助，请参阅

```
:h :g
:h range
:h :left
:h :d 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T15:31:16.283

使用[awk](/questions/tagged/awk "显示标记为“awk”的问题")：

```
awk '/{{{/{l=1;next}/}}}/{l=0} l{print"    "$0}' file.txt 
```

或不那么神秘：

```
awk '/{{{/{l=1;next} /}}}/{l=0} l==1{print "    " $0}' file.txt 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T15:25:12.450

```
sed -i~ '/^{{{/,/^}}}/{/^{{{\|}}}/d;s;\(^.*$\);    \1;}' inFile 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-20T15:35:41.297

假设您的文本中没有`\r`对象，您可以在以下帮助下进行转换`tr`：

```
tr '\n' '\r' \
| sed 's/{{{/\r{{{/;
       s/}}}/}}}\r/;
       :w;
         s/\r{{{\r}}}//;
         s/{{{\r\([^\r]*\)\r\(.*\)}}}/    \1\r{{{\r\2}}}/;
       tw' \
| tr '\r' '\n' 
```

请注意，我在代码部分之前和之后添加了额外的一行，否则 markdown 将无法正确识别代码。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-20T17:33:24.967

这可能对您有用（GNU sed）：

```
sed '/^{{{/,/^}}}/{//d;s/^/    /}' file 
```

# android - 多个异步任务实现

> ID：13476263
> 
> 赞同：-1
> 
> 时间：2012-11-20T15:17:22.077
> 
> 标签：android, android-asynctask

我正在处理 Android 异步任务。我曾尝试在主类中实现几个异步任务。但是，无论我调用哪个任务，都只会加载第一个实现。为什么会发生这种情况，我该如何解决？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:29:21.790

我使用android注解，实现asynctasks和progressdialog非常简单，

对实现的引用：

[http://androidannotations.org/](http://androidannotations.org/)

简单，快速！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-20T15:35:35.713

我在使用 AsyncTask 时遇到过类似的问题，显然没有您的代码，我无法告诉您您的具体问题是什么。但是，我看到的与您类似的大多数问题都是由于以下几点：

> “理想情况下，AsyncTasks 应该用于短操作（最多几秒钟）。如果您需要保持线程长时间运行，强烈建议您使用 java.util.concurrent 包提供的各种 API，例如作为 Executor、ThreadPoolExecutor 和 FutureTask。”

此外，如果您希望 AsyncTasks 同时运行，您可能做错了：

> 首次引入时，AsyncTask 在单个后台线程上串行执行。从 DONUT 开始，这被更改为允许多个任务并行运行的线程池。从 HONEYCOMB 开始，任务在单个线程上执行，以避免并行执行导致的常见应用程序错误。
> 
> 如果你真的想要并行执行，你可以使用 THREAD_POOL_EXECUTOR 调用 executeOnExecutor(java.util.concurrent.Executor, Object[])。

# javascript - 当屏幕尺寸小于特定尺寸时隐藏 div 元素

> ID：13476267
> 
> 赞同：55
> 
> 时间：2012-11-20T15:17:29.380
> 
> 标签：javascript, html, css

我有一个 div 元素，当浏览器的宽度小于或等于 1026px 时，我想隐藏它。这是否可能与 css 相关： **`@media only screen and (min-width: 1140px) {}`** 如果 css 无法实现，是否有其他选择？

额外信息：当 div 元素被隐藏时，我不想要一个空白的空白。如果我从代码中完全删除了 div 元素，我希望页面能够流动。

我隐藏的 div 是**`<div id="fadeshow1"></div>`**.

HTML5 文档类型。

我使用 javascript 将画廊放入该 div。

**当它大于 1026px 宽度时，我希望它看起来像这样：** [![http://i.stack.imgur.com/REBPi.png](../Images/cc345b521a2b33ceb22fbc0a51e8ab3b.png)](https://i.stack.imgur.com/REBPi.png)

**当它小于 1026px 宽度时，我希望它看起来像这样：** [![http://i.stack.imgur.com/XdiL4.png](../Images/9294510fc3691d551900318282dd7c5a.png)](https://i.stack.imgur.com/XdiL4.png)

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2012-11-20T15:19:16.077

你可以用 CSS 做到这一点：

```
@media only screen and (max-width: 1026px) {
    #fadeshow1 {
        display: none;
    }
} 
```

我们使用`max-width`，因为我们想在屏幕*小于*1026 像素时对 CSS 进行例外处理。 `min-width`将使 CSS 规则适用于所有宽度为 1026 像素或*更大*的屏幕。

需要记住的是，`@media`IE8 及更低版本不支持查询。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-11-20T15:19:14.247

```
@media only screen and (max-width: 1026px) { 
  #fadeshow1 { 
    display: none; 
  } 
} 
```

只要屏幕宽度小于 1026 像素，屏幕内的任何内容都`{ }`将适用。

[一些浏览器不支持媒体查询。](http://caniuse.com/css-mediaqueries)您可以使用像[Respond.JS这样的 javascript 库来解决这个问题](https://github.com/scottjehl/Respond)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-03-29T11:06:52.693

如果您使用的是引导程序，您可以根据您的需要使用 hidden-sm（lg 或 md 或 xs）。然后您可以进入 css 文件并指定您希望它显示的百分比。在下面的示例中，它将隐藏在大屏幕、中屏幕和超小屏幕上，但在小屏幕上显示时会占据屏幕的一半。

```
<div class="col-sm-12 hidden-lg hidden-md hidden-xs">what ever you want</div> 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-11-20T15:27:18.573

我不了解 CSS，但这个 Javascript 代码应该可以工作：

```
 function getBrowserSize(){
       var w, h;

         if(typeof window.innerWidth != 'undefined')
         {
          w = window.innerWidth; //other browsers
          h = window.innerHeight;
         } 
         else if(typeof document.documentElement != 'undefined' && typeof      document.documentElement.clientWidth != 'undefined' && document.documentElement.clientWidth != 0) 
         {
          w =  document.documentElement.clientWidth; //IE
          h = document.documentElement.clientHeight;
         }
         else{
          w = document.body.clientWidth; //IE
          h = document.body.clientHeight;
         }
       return {'width':w, 'height': h};
}

if(parseInt(getBrowserSize().width) < 1026){
 document.getElementById("fadeshow1").style.display = "none";
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-12-16T14:26:27.377

您只需要在 CSS 中使用媒体查询即可完成此操作。

```
@media (max-width: 1026px) {
    #fadeshow1 { display: none; }
} 
```

不幸的是，有些浏览器不支持`@media`（看看你的 IE8 及以下）。在这些情况下，您有几个选择，但最常见的是 Respond.js，它是一个用于最小/最大宽度 CSS3 媒体查询的轻量级 polyfill。

```
<!--[if lt IE 9]>
    <script src="respond.min.js"></script>
<![endif]--> 
```

这将允许您的响应式设计在那些旧版本的 IE 中运行。
[*参考](https://stackoverflow.com/a/21031736/643482)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-20T15:19:30.067

```
@media only screen and (min-width: 1140px) 
```

应该做他的工作，给我们看你的css文件

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-20T15:25:05.607

这应该有助于：

```
if(screen.width<1026){//get the screen width
   //get element form document
   elem.style.display == 'none'//toggle visibility
} 
```

768 px 也应该足够了

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2014-12-15T15:31:41.937

您必须使用最大宽度而不是最小宽度。

```
<style>
    @media (max-width: 1026px) {
        #test {
            display: none;
        }
    }
</style>
<div id="test">
    <h1>Test</h1>
</div> 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2012-11-20T15:25:53.767

我知道的最简单的方法是使用 onresize() 函数：

```
 window.onresize = function(event) {
        ...
    } 
```

[这是一个小提琴](http://jsfiddle.net/TNCodeMonkey/UTMts/1/)

# algorithm - 冒泡排序的比较次数

> ID：13476270
> 
> 赞同：-2
> 
> 时间：2012-11-20T15:17:40.213
> 
> 标签：algorithm

我了解到冒泡排序的比较次数是

> (n - 1) + (n - 2) + (n - 3) + ... + 2 + 1

怎么会变成这样？

> (n - 1) * n/2

你能解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:26:45.407

总和

```
1 + 2 + 3 + 4 + .... + n = n * (n + 1)/2 
```

所以总和

```
1 + 2 + 3 + .. + (n-1) = (n - 1) * n/2 
```

# php - Foreach 循环不会在 PHP 中中断，使用 Facebook-api

> ID：13476271
> 
> 赞同：-1
> 
> 时间：2012-11-20T15:17:42.187
> 
> 标签：php, foreach, break

我试图在 php 中从 Facebook 获取我的电影的某个数字之后突破一个 foreach 循环。

我认为这是愚蠢的小事。这是我得到的：

```
 try {
// Proceed knowing you have a logged in user who's authenticated.
$user_movie_info = $facebook->api('/me/movies?fields=name,genre,release_date,picture,likes');
  } catch (FacebookApiException $e) {
    error_log($e);
    $user = null;
  }

//print_r($user_movie_info);

$numer_of_movies_allowed = 2;
$movie_counter = 0;

foreach($user_movie_info['data'] as $movie) {

    if ($movie_counter === $number_of_movies_allowed ) {
        break;
    }

    echo '<img src="' .$movie['picture']['data']['url']. '">'; 
    echo $movie['name'];  
    echo $movie['release_date']; 
    echo $movie['genre']; 
    echo $movie['likes']; 
    echo "</br> </br>";
    $movie_counter ++;  
}

print ($movie_counter);

print ($numer_of_movies_allowed); 
```

它不会在两部电影之后爆发，而是将它们全部展示出来。

如果我使用：

```
if ($movie_counter == $number_of_movies_allowed ) 
```

或者

```
if ((int)$movie_counter === (int)$number_of_movies_allowed ) 
```

根本没有电影放映。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:17:58.250

```
$numer_of_movies_allowed = 2;
$movie_counter = 0;

foreach($user_movie_info['data'] as $movie) {

    if ($movie_counter === $number_of_movies_allowed ) { 
```

如果您在初始化时编写正确的变量名可能会有所帮助……`$numer_of_movies_allowed`与`$number_of_movies_allowed`.

如果你已经将你的 error_reporting 设置为一个合理的开发水平，那么整个问题将是完全没有必要的（因为 PHP 会告诉你 if 条件中的变量没有设置）——现在就做**！**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:20:55.833

```
if ($movie_counter === $number_of_movies_allowed ) 
```

应该：

```
if ($movie_counter == $number_of_movies_allowed ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T15:21:39.527

=== 要求两种数据类型相等。您必须将 $movie_counter 解析为 int 或删除一个等号。

尝试

```
if ($movie_counter == $number_of_movies_allowed ) 
```

或者

```
if ((int) $movie_counter === (int)$number_of_movies_allowed ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T15:31:20.517

这是我找到的一张表：

```
// "===" means that they are identical  
// "==" means that they are equal  
// "!=" means that they aren't equal.

         false   null    array()  0      "0"     0x0     "0x0"   "000"    "0000"
false    ===     ==      ==       ==      ==     ==      !=      !=       !=    
null     ==      ===     ==       ==      !=     ==      !=      !=       !=    
array()  ==      ==      ===      !=      !=     !=      !=      !=       !=    
0        ==      ==      !=       ===     ==     ===     ==      ==       ==    
"0"      ==      !=      !=       ==      ===    ==      ==      ==       ==    
0x0      ==      ==      !=       ===     ==     ===     ==      ==       ==    
"0x0"    !=      !=      !=       ==      ==     ==      ===     ==       ==    
"000"    !=      !=      !=       ==      ==     ==      ==      ===      ==    
"0000"   !=      !=      !=       ==      ==     ==      ==      ==       === 
```

# java - Java Swing：具有固定宽度和可变高度的垂直布局

> ID：13476274
> 
> 赞同：2
> 
> 时间：2012-11-20T15:17:55.327
> 
> 标签：java, swing, layout, vertical-alignment, fixed-width

我正在寻找一个布局管理器（或一组布局管理器）来帮助我垂直排列我的组件。所有组件（按钮）都应具有相同的宽度，并以底层对话框客户区宽度为边界。这些按钮中的每一个都能够根据连接的 JLabel 扩展其高度（一旦用户单击相关按钮，标签将显示） - 简而言之：所有组件都应拉伸到相同的固定宽度，但具有变量高度取决于它们的内容。如果需要，整个对话框内容应放置在 JScrollPane 中以支持垂直滚动条。

我在这一点上，我堆叠了许多不同的布局管理器（主要是用于水平拉伸的边界布局和用于垂直排列的框布局）来实现我的目标行为。但它既不是令人满意的代码，也不能完全按照我的意愿工作。

我花了很多时间在网上浏览这个问题，发现垂直布局是 Java 中的一个常见问题。很多人回答说 GridBagLayout 将是完成这项工作的最佳布局，但我没有让它按照我想要的方式工作。

我希望这些信息足以为我解决这个问题提供一些帮助。

最好的问候迈克尔

编辑：-不再需要-

编辑2：

这是我当前尝试的图像： [http ://www.pic-upload.de/view-16978954/example-image.png.html](http://www.pic-upload.de/view-16978954/example-image.png.html)

这几乎是我想要的结果，但在调整大小时有奇怪的行为。

编辑3：

我认为我的主要问题是 JScrollPane 与包含 JLabel 的 html 相结合，我需要 setMaximumSize(...) 之类的东西，但它不能正常工作： [http ://www.pic-upload.de/view- 16988005/example-image3.png.html](http://www.pic-upload.de/view-16988005/example-image3.png.html)

我需要一个固定的宽度，但我找不到设置它的方法。

setPreferredSize(...) 有效，但我不知道 JLabel 的高度，因为它包含 html 文本。

编辑4：

我的按钮：

```
public class Expander extends JPanel implements ActionListener {

    private static class HtmlViewer extends JLabel {

        private static final long serialVersionUID = 8787130155299083869L;

        public HtmlViewer(String doc) {
            super(doc);
            this.setBackground(Color.WHITE);
            this.setOpaque(true);
        }
    }

    private static final long serialVersionUID = 4480221797736558685L;

    JToggleButton button;
    JComponent component;

    public Expander(String text, String doc) {
        this(text, new HtmlViewer(doc));
    }

    public Expander(String text, JComponent expandableComponent) {
        this.setLayout(new BorderLayout());

        button = new JToggleButton(text) {
            private static final long serialVersionUID = -3330376265192275758L;

            @Override
            public void paint(Graphics g) {
                super.paint(g);

                if (this.isSelected()) {
                    g.drawString("▼", this.getWidth() - 20, 15);
                } else {
                    g.drawString("■", this.getWidth() - 20, 15);
                }
            }
        };

        button.setFocusPainted(false);
        button.addActionListener(this);

        component = expandableComponent;
        component.setBorder(new EmptyBorder(5, 5, 5, 5));

        this.add(button, BorderLayout.PAGE_START);
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        if (button.isSelected()) {
            this.add(component);
        } else {
            this.remove(component);
        }
        this.getTopLevelAncestor().validate();
        this.getTopLevelAncestor().repaint();
        this.setMaximumSize(this.getPreferredSize());
    }
} 
```

框架：

```
public class grid2 {

    public static void main(String[] args) {

        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        JPanel p = new JPanel();
        JScrollPane scroll = new JScrollPane(p, JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED, ScrollPane.HORIZONTAL_SCROLLBAR_NEVER);
        addStuff(p);

        frame.add(scroll);

        frame.pack();
        frame.setVisible(true);
    }

    public static void addStuff(Container container) {
        container.setLayout(new GridBagLayout());

        GridBagConstraints c = new GridBagConstraints();
        c.fill = GridBagConstraints.HORIZONTAL;
        c.weightx = 1;
        c.weighty = 0;

        Expander e = new Expander("test", "<html>fgb fdh fgfhg ifghiufdshfidsghfiufdsghiudsfhdsfiu dshiufhds if dhf idsufhdsiufhiufhiuds hfdshfiudshfuidsifudshfiudshf  ufdhfiushdfiudshiufhdsiufhdsiuf udshfiudshfiudshfudshf iuhfiudshfiudshfiudshf</html>"); // long html text example
        e.setMaximumSize(new Dimension(500, 10000));
        c.gridx = 0;
        c.gridy = 0;
        c.gridwidth = GridBagConstraints.REMAINDER;
        container.add(e, c);

        JButton button2 = new JButton("Button 2");
        c.gridy = 1;
        c.gridwidth = GridBagConstraints.REMAINDER;
        container.add(button2, c);

        c.gridy = 2;
        c.weighty = 1;
        c.gridwidth = GridBagConstraints.REMAINDER;
        container.add(new JLabel(), c);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:24:27.170

请参阅[http://docs.oracle.com/javase/tutorial/uiswing/layout/box.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/box.html)

```
setLayout(new BoxLayout(pane, BoxLayout.Y_AXIS)); 
```

![例子](../Images/8e510cc5e929290b39de89731eb49bb4.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:24:33.707

我会使用的是[GridBagLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)。它类似于 HTML 表格，通过使用[GridBagConstraints](http://docs.oracle.com/javase/6/docs/api/java/awt/GridBagConstraints.html)，您可以将对象设置为在水平和垂直方向上展开（例如`constraints.fill = GridBagConstraints.BOTH`）

我相信这可以解决您在下图中的问题（有一个小技巧可以通过在底部添加一个空白标签使按钮保持在顶部，但我相信通过更多的修补可以将其删除）

```
public static void main(String[] args) {
    final JFrame frame = new JFrame();
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    addStuff(frame.getContentPane());

    frame.pack();
    frame.setVisible(true);
}

public static void addStuff(Container container) {
    container.setLayout(new GridBagLayout());

    GridBagConstraints c = new GridBagConstraints();
    c.fill = GridBagConstraints.HORIZONTAL;
    c.weightx = 1;
    c.weighty = 0;

    JButton button = new JButton("Button 1");
    c.gridx = 0;
    c.gridy = 0;
    container.add(button, c);

    JButton button2 = new JButton("Button 2");
    c.gridy = 1;
    container.add(button2, c);

    c.gridy = 2;
    c.weighty = 1;
    container.add(new JLabel(), c);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T09:12:12.217

好的，我让它工作了。我完全错了，我认为 JScrollPane 是这个问题的麻烦制造者，但它是 JLabel。如果 JLabel 包含 HTML 文本，它不会自动换行文本，这就是如果对话框的宽度太小，所有内容都会水平拉伸的原因。我在这里找到了解决这个问题的好方法：[通过设置最大宽度使 JLabel 包装它的文本](https://stackoverflow.com/questions/2420742/make-a-jlabel-wrap-its-text-by-setting-a-max-width)

答案 6：

```
JLabel labelBeingUsed = myLabel;
View view = (View) labelBeingUsed.getClientProperty(BasicHTML.propertyKey);
view.setSize(scrollPane1.getWidth(), 0.0f);
float w = view.getPreferredSpan(View.X_AXIS);
float h = view.getPreferredSpan(View.Y_AXIS);
labelBeingUsed.setSize((int) w, (int) h); 
```

每次调整对话框大小时，都需要使用上面的代码将每个包含 JLabel 的 HTML 的宽度更新为所需的宽度。

非常感谢您提供的所有有用提示。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T16:46:40.007

这里有几个问题：

1.  会伸展你`BorderLayout`的`JFrame``JPanel p`
2.  您没有设置`weightx`，因此该`fill`属性无用

解决方案：

1.  要么将您包装`JPanel p`在另一个将其放在顶部的面板中，要么在最后添加一个额外的不可见 JPanel 以推动您的组件
2.  将`weightx`属性设置为`1.0`

这是一个有效的演示代码（基于您的）：

```
import java.awt.GridBagConstraints;
import java.awt.GridBagLayout;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class Gridbag {

    public void initUI() {
        JFrame frame = new JFrame();

        frame.setSize(500, 500);
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

        JPanel p = new JPanel(new GridBagLayout());

        GridBagConstraints constraints = new GridBagConstraints();
        JButton button = new JButton("button 1");
        constraints.fill = GridBagConstraints.HORIZONTAL;
        constraints.anchor = GridBagConstraints.PAGE_START;
        constraints.gridwidth = GridBagConstraints.REMAINDER;
        constraints.weightx = 1.0;
        p.add(button, constraints);

        button = new JButton("button 2");
        constraints.fill = GridBagConstraints.HORIZONTAL;
        constraints.anchor = GridBagConstraints.PAGE_START;
        p.add(button, constraints);
        JPanel root = new JPanel(new GridBagLayout());
        constraints.weighty = 1.0;
        root.add(p, constraints);
        frame.add(root);
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Gridbag().initUI();
            }
        });
    }

} 
```

# forms - 单击JSF中的命令按钮后如何填写表单

> ID：13476277
> 
> 赞同：1
> 
> 时间：2012-11-20T15:18:07.970
> 
> 标签：forms, jsf-2

我有 2 个文本字段，我在其中接受用户输入，并使用这些文本字段通过按钮的动作侦听器触发 managedbean。此类将生成（从 xml）我想在同一页面中以不同形式填充数据表的数据。如果在触发类后按钮会打开一个不同的页面，我可以解决这个问题，但我不希望这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:41:34.073

只需在 bean action 方法中相应地设置其他表单的组件的属性即可。

例如

```
<h:form>
    <h:inputText value="#{bean.input1}" />
    <h:inputText value="#{bean.input2}" />
    <h:commandButton value="submit" action="#{bean.submit}" />
</h:form>
<h:form>
    <h:dataTable value="#{bean.items}" rendered="#{not empty bean.items}">
        ...
    </h:dataTable>
</h:form> 
```

和

```
private String input1;
private String input2;
private List<Item> items;

public void submit() {
    items = loadItBasedOn(input1, input2);
} 
```

# javascript - 使用另一个变量作为计数器创建一个 javascript 变量

> ID：13476279
> 
> 赞同：1
> 
> 时间：2012-11-20T15:18:12.707
> 
> 标签：javascript, variables

说我想要这样的东西：

```
var i = 0;

for (i upto 100) {
    var x+i = "This is another variable altogether";
    i++;
} 
```

javascript 解释器会看到：

```
var x = "This is another variable altogether";
var x1 = "This is another variable altogether";
var x2= "This is another variable altogether";
var x3 = "This is another variable altogether";
var x4 = "This is another variable altogether"; 
```

我可以使用变量计数器来增加变量的名称，以便完全拥有不同的变量吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T15:21:29.350

从技术上讲，是的。

如果您在我怀疑的全球范围内运作，您可以这样做：

```
for (var i=0; i<100; i++){
  window["x"+i]="This is another variable altogether";
}

console.log(x1); 
```

但是，您应该使用数组做这种事情，所以：

```
var arr=[];
for (var i=0; i<100; i++){
  arr[i]="This is another variable altogether";
}

console.log(arr[1]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:19:50.797

您不应该为此使用不同的变量。试试数组：

```
var arr = [];
...
arr.push('my var'); 
```

或对象：

```
var ob = {};
...
ob[counter] = 'my var'; 
```

# java - 如何清除 GWT CellTable 上的用户输入？

> ID：13476281
> 
> 赞同：0
> 
> 时间：2012-11-20T15:18:21.733
> 
> 标签：java, gwt

我有一个`CellTable<Price> table = new CellTable<Price>();`.

我还有一个`TextInputCell`专栏：

```
 priceColumn = new Column<Price, String>(new TextInputCell()) {
            public String getValue(Price p) {
                if (p.getPrice() == 0)
                    return "";
                return p.getPrice()+"";
            }   
        }; 
```

我还有一个`refresh button`. 如果按下按钮，那么它基本上从服务器重新加载所有数据，然后将数据设置到表中。

当表第一次加载数据时，就可以了。假设**一个单元格**的价格为**12**。

然后，如果我将该单元格修改为**11（或 12 以外的任何值）**，则该单元格将`11`永远留在那里。我的意思是，即使我按下`refresh button`，单元格的数据也不会变回`12`，但仍然保持`11`。

**如何使列/单元格不记得用户输入？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:55:05.027

在您收到新数据并使用新数据调用更新您的对象后`table.redraw();`

**工作示例**

```
final Price p1 = new Price(4);
final Price p2 = new Price(5);
final Price p3 = new Price(6);

final CellTable<Price> table = new CellTable<Price>();

Column<Price, String> priceColumn = new Column<Price, String>(new TextInputCell()) {
    public String getValue(Price p) {
    if (p.getPrice() == 0)
        return "";
    return p.getPrice() + "";
    }
};

ListDataProvider<Price> dataProvider = new ListDataProvider<Price>();
dataProvider.addDataDisplay(table);

List<Price> list = dataProvider.getList();
list.add(p1);
list.add(p2);
list.add(p3);

table.addColumn(priceColumn);

Button b = new Button("refresh");
b.addClickHandler(new ClickHandler() {

    @Override
    public void onClick(ClickEvent event) {
    // your refresh logic, update the items already loaded into the CellTable!
    p2.setPrice(1000);
    p3.setPrice(2000);

    table.redraw();
    }
});

RootPanel.get().add(table);
RootPanel.get().add(b); 
```

# php - 为 zf2 实现密码验证器

> ID：13476282
> 
> 赞同：4
> 
> 时间：2012-11-20T15:18:23.253
> 
> 标签：php, validation, zend-framework2

编写验证两个输入（必须是 eqeal）的密码验证器的好方法是什么，以及如何将其集成到 zf2 表单中。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-20T18:05:42.180

有一个“相同”验证器可以检查两个字段是否相等，它可以在表单构造函数中以下列方式使用：

```
$this->add(array(
    'name' => 'password', // add first password field
    /* ... other params ... */
));
$this->add(array(
    'name' => 'passwordCheck', // add second password field
    /* ... other params ... */
    'validators' => array(
        array(
            'name' => 'Identical',
            'options' => array(
                'token' => 'password', // name of first password field
            ),
        ),
    ),
)); 
```

# plsql - PL/SQL 游标 ORA-00936 缺少表达式

> ID：13476283
> 
> 赞同：0
> 
> 时间：2012-11-20T15:18:25.633
> 
> 标签：plsql, cursor, ora-00936

谁能帮我解决这个问题：

```
CURSOR csr(start IN NUMBER, finish IN NUMBER, sort IN VARCHAR2, search IN VARCHAR2) IS
  SELECT id, text, code, name
    FROM (SELECT rownum r,
                 id,
                 text,
                 table1.code,
                 name 
            FROM table1, table2
       WHERE table1.code = table2.code
             AND (id LIKE ||'%'||search||'%' 
              OR  name LIKE ||'%'||search||'%'
              OR  table1.code LIKE ||'%'||search||'%'
              OR  text   LIKE ||'%'||search||'%')
          )
   WHERE   r > start
 AND     r <= finish
   ORDER BY sort; 
```

这给了我以下行的 *ORA-00936 Missing Expression 错误：

```
AND( id LIKE ||'%'||search||'%'* 
```

我只是在测试代码，但找不到问题所在。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:24:01.077

连接运算符“||” 在操作数之间。在第一个学期之前放一个是错误的。所以“id LIKE ||'%'||search||'%'”应该是“id LIKE '%'||search||'%'”

# mysql - CakePHP：路由中的 MySQL 查询

> ID：13476287
> 
> 赞同：0
> 
> 时间：2012-11-20T15:18:44.170
> 
> 标签：mysql, cakephp-2.0

我不知道在 CakePHP 中进行查询或在 CakePHP 中进行路由的第一件事，所以我什至不知道如何开始为我的问题寻找解决方案。也许你可以帮忙。

我希望用户能够访问：

```
http://www.domain.com/movies/1 
```

或者

```
http://www.domain.com/movie-nickname 
```

两者都将访问“页面”控制器，“查看”操作。他们都应该提出页面 id = 1。

（我不希望他们只是去[http://www.domain.com/pages/1](http://www.domain.com/pages/1)）

每个页面都有 URL 的昵称，但如果留空，则 URL 将为[http://www.domain.com/CATEGORY/PAGE](http://www.domain.com/CATEGORY/PAGE)，如第一个示例所示。

如果昵称没有留空，有没有办法在我的路线中进行查询，上面写着“SELECT id FROM pages WHEREnickname = 'nickname'”

最重要的是，如果 pages 表中的昵称是“this that”，则 URL 应该是[http://www.domain.com/this-that](http://www.domain.com/this-that)，这意味着连字符需要替换为空格，然后执行查询.

我有第一个 URL 的路由：

```
Router::connect(
    '/:category/:page',
    array('controller' => 'pages', 'action' => 'view'),
    array(
        'pass' => array('page'),
        'page' => '[0-9]+',
        'category' => 'shows|music|games|books|hobbies'
    )
); 
```

我正在寻找的第二种选择可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:11:45.853

我想出了我的自定义路由。

```
App::uses('ClassRegistry', 'Utility');

// HOMEPAGE
Router::connect('/', array('controller' => 'index', 'action' => 'index'));

$requestURI = explode('/', $_SERVER['REQUEST_URI']);
$scriptName = explode('/',$_SERVER['SCRIPT_NAME']);

for($i= 0;$i < sizeof($scriptName);$i++)
        {
      if ($requestURI[$i]     == $scriptName[$i])
              {
                unset($requestURI[$i]);
            }
      }

$param = array_values($requestURI);

$param1 = $param[0]; // domain.com/page-nickname
$param2 = $param[1]; // domain.com/category_id/page_id

// convert 'page-nickname' to 'page nickname' which is what it would be in db
$pagelink = str_replace('-', ' ', $param1);

// initiate Page mode;
$pagesModel = ClassRegistry::init('Page');

// check if there is a matching page in the db that has link column like 'page nickname'
$matchedpage = $pagesModel->find('first', array(
    'conditions' => array('Page.link LIKE' => "$pagelink"), 'recursive' => '0'
));

// Cache::write('routepagelinks', $pagelinks);

// if there is a match
if($matchedpage['Page']['id']){
    Router::connect('/' . $param1, array('controller' => 'pages', 'action' => 'view', 'page' => $matchedpage['Page']['id']), array(
    'pass' => array('page'),
    'page' => '[0-9]+'
    ));

// ... more custom routing if there is a match

}

// general routing info here

// if no page-nickname, routes page for domain.com/category_id/page_id
Router::connect(
'/:category/:page',
array('controller' => 'pages', 'action' => 'view'),
array(
    'pass' => array('page'),
    'page' => '[0-9]+',
    'category' => 'shows|music|games|books|hobbies'
    )
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:22:31.313

虽然有可能，但您不会经常看到路由器执行这样的逻辑。更常见的是，路由器将其传递给控制器​​，控制器处理解析 URL 路径。

作为证明，请考虑本机*编辑*路由的工作方式。路由器不会测试数据库中现有的*id*。控制器会。

# entity-framework - 具有实体框架代码优先和 oracle 提供程序的布尔类型

> ID：13476288
> 
> 赞同：3
> 
> 时间：2012-11-20T15:18:46.863
> 
> 标签：entity-framework, ef-code-first, oracle11g, boolean, code-first

在必须在 oracle 和 sqlServer 中工作的应用程序中工作。在 SqlServer 中，我们使用“Bit”来存储布尔值和 oracle number(1)。

我们创建了一个代码优先模型，我们发现映射到数据库字段的布尔属性很少。

例如：

```
public partial class ZPruebaBooleano
{
    public int Numero { get; set; }

    public bool Booleano { get; set; }
} 
```

映射为：

```
 this.ToTable("ZPRUEBABOOLEANO", schema);

    this.HasKey<int>(t => t.Numero);
    this.Property(t => t.Numero).HasColumnName("NUMERO");

    this.Property(t => t.Booleano).HasColumnName("BOOLEANO"); 
```

此外，将 sw 添加到应用程序配置文件中（为简单起见，我们在不使用任何额外 dll 的情况下对其进行了测试）：

```
 <oracle.dataaccess.client>
    <settings>
      <add name="bool" value="edmmapping number(1,0)" />
      <add name="byte" value="edmmapping number(3,0)" />
      <add name="int16" value="edmmapping number(4,0)" />
      <add name="int32" value="edmmapping number(9,0)" />
      <add name="int64" value="edmmapping number(18,0)" />
    </settings>
  </oracle.dataaccess.client> 
```

我相信提供程序工厂在创建模型时会读取它，因为如果我在文件中映射的任何类型名称中添加无效条目，它会引发异常。

正如我在其他论坛中发现的那样，这应该可以。但现在我不确定是否应该一直工作，包括代码。

当我执行代码时出现此异常（从西班牙语翻译，如有任何错误，请见谅）：

> 从“Booleano”键入“Edm.Boolean[Nullable=False,DefaultValue=]”以键入“PruebaBooleanos.ZPruebaBooleano”与“OracleEFProvider.number[Nullable=False,DefaultValue=,Precision=38,Scale=0]”不兼容

说 Precision=38 很有趣。数据库是 Number(1)，我很确定，实际上这是脚本：

```
CREATE TABLE ZPRUEBABOOLEANO
(
  NUMERO    NUMBER(15),
  BOOLEANO  NUMBER(1)
) 
```

另外，我发现有趣的是，即使我没有通知我正在映射的表，我也遇到了这个错误，就像 oracle 提供者甚至没有检查列是否为数字（任何东西）一样。现在是很好的映射，表和模式。

正如我们在这段代码中看到的那样，我已经测试创建一个由布尔值包装的整数属性。

```
namespace PruebaBooleanos
{
    public partial class ZPruebaBooleano
    {
        public int Numero { get; set; }

        public bool Booleano
        {
            get
            {
                return iBooleano == 1 ? true : false;
            }
            set
            {
                iBooleano = value ? 1 : 0;
            }
        }
        public int iBooleano { get; set; }
    }
} 
```

在最后一种情况下，我忽略了布尔值并映射了整数。

这在甲骨文中工作正常。但增加了2个问题：

1.  它在 SqlServer 中失败，因为在 sql server 中有点
2.  无法使用布尔属性查询实体模型，因为它未映射到数据库。

我可以将 SqlServer 中的位字段更改为数字。

但我想在 sqlserver 和 oracle 中的 number(1) 中保留位。

有人有类似的问题吗？

我愿意接受任何想法，谢谢！！！

力博

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-18T03:33:56.240

从发布日期来看，我很确定这个答案现在至少对你来说毫无用处，但是像我这样的许多人可能会觉得这很有用。

1.  .Net (ODP/ODAC) 的 Oracle 数据提供程序[不支持](https://forums.oracle.com/thread/2558851)EF 代码优先
2.  Code First 不会考虑 .config 文件上的映射设置，也就是说，如果您添加 `<add name="bool" value="edmmapping number(1,0)" />`它，它只会在您拥有 EDMX 文件并且使用模型优先或 db-first 时才有效
3.  并非所有希望都消失了，对于您的案例（以及我的案例和许多其他案例），有一个“解决方法”可以在 SQL Server 和 Oracle（可能还有更多的数据库引擎）中实际使用带有布尔值的 POCO 类

所以对我来说解决方案很简单，我花了很多时间试图为你完成同样的事情，当论坛上的 Oracle 的某个人（似乎是一名员工）告诉我它不受支持时，我就继续前进了，时期。

所以你想要做的是：

1.  在 SQL Server 中有一个`integer`用于存储布尔值的列
2.  出于同样的目的，在 Oracle 上有一个`number(1,0)`专栏
3.  模型中有两个属性，一个实际映射到数据库中的字段，另一个未映射但将映射值转换为布尔值

所以在你的代码中这样做：

```
[Table("SomeTable")]
public class MyModel  {

    [Column("SOME_BOOLEAN")]
    public int SomeBooleanValue { get; set; }

    [NotMapped]
    public bool SomeBoolean {
        get {
            return Convert.ToBoolean(SomeBooleanValue);
        }
        set {
            SomeBooleanValue = Convert.ToInt32(value);
        }
    }
} 
```

然后你只需在你的代码中访问 SomeBoolean ，它实际上将引用一个可以映射到两个数据库的 int 。

我在映射 Enum 常量值时也使用这种方法。

# structure - 从 WebGl 中的代码访问顶点着色器中的结构

> ID：13476294
> 
> 赞同：4
> 
> 时间：2012-11-20T15:19:05.473
> 
> 标签：structure, webgl, vertex-shader

我怎样才能在我的顶点着色器中达到这个光结构？

```
struct LightInfo {
    vec4 Position; // Light position in eye coords.
    vec3 La; // Ambient light intensity
    vec3 Ld; // Diffuse light intensity
    vec3 Ls; // Specular light intensity
};
uniform LightInfo Light; 
```

我试过：

```
shaderProgram.Light = gl.getUniformLocation(shaderProgram, "Light"); 
```

可以编译，但是当我尝试插入一些值时，例如：

```
gl.uniform4f(
    shaderProgram.Light.Position,
    parseFloat(document.getElementById("lightPositionX").value),
    parseFloat(document.getElementById("lightPositionY").value),
    parseFloat(document.getElementById("lightPositionZ").value),
    0.0
); 
```

它完全破裂。如何将此位置数据发送到着色器结构中？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-22T06:59:37.140

您必须为每种基本类型获取一个位置。在你的例子中

```
struct LightInfo {
    vec4 Position; // Light position in eye coords.
    vec3 La; // Ambient light intensity
    vec3 Ld; // Diffuse light intensity
    vec3 Ls; // Specular light intensity
};
uniform LightInfo Light; 
```

意味着你需要

```
var lightPosLoc = gl.getUniformLocation(program, "Light.Position");
var lightLaLoc  = gl.getUniformLocation(program, "Light.La");
var lightLdLoc  = gl.getUniformLocation(program, "Light.Ld");
var lightLsLoc  = gl.getUniformLocation(program, "Light.Ls"); 
```

如果您有数组，则需要每个数组的每个字段的位置，如

```
struct LightInfo {
    vec4 Position; // Light position in eye coords.
    vec3 La; // Ambient light intensity
    vec3 Ld; // Diffuse light intensity
    vec3 Ls; // Specular light intensity
};
uniform LightInfo Lights[2];

// ---

var light0PosLoc = gl.getUniformLocation(program, "Lights[0].Position");
var light0LaLoc  = gl.getUniformLocation(program, "Lights[0].La");
var light0LdLoc  = gl.getUniformLocation(program, "Lights[0].Ld");
var light0LsLoc  = gl.getUniformLocation(program, "Lights[0].Ls");
var light1PosLoc = gl.getUniformLocation(program, "Lights[1].Position");
var light1LaLoc  = gl.getUniformLocation(program, "Lights[1].La");
var light1LdLoc  = gl.getUniformLocation(program, "Lights[1].Ld");
var light1LsLoc  = gl.getUniformLocation(program, "Lights[1].Ls"); 
```

和数组数组等。

```
struct LightInfo {
    vec4 Positions[2]; // Light positions in eye coords.
    vec3 La; // Ambient light intensity
    vec3 Ld; // Diffuse light intensity
    vec3 Ls; // Specular light intensity
};
uniform LightInfo Lights[2];

// ---

var light0Pos0Loc = gl.getUniformLocation(program, "Lights[0].Positions[0]");
var light0Pos1Loc = gl.getUniformLocation(program, "Lights[0].Positions[1]");
var light0LaLoc   = gl.getUniformLocation(program, "Lights[0].La");
var light0LdLoc   = gl.getUniformLocation(program, "Lights[0].Ld");
var light0LsLoc   = gl.getUniformLocation(program, "Lights[0].Ls");
var light1Pos0Loc = gl.getUniformLocation(program, "Lights[1].Positions[0]");
var light1Pos1Loc = gl.getUniformLocation(program, "Lights[1].Positions[1]");
var light1LaLoc   = gl.getUniformLocation(program, "Lights[1].La");
var light1LdLoc   = gl.getUniformLocation(program, "Lights[1].Ld");
var light1LsLoc   = gl.getUniformLocation(program, "Lights[1].Ls"); 
```

ETC...

# mercurial - 摆脱 Mercurial 中的非拓扑头

> ID：13476299
> 
> 赞同：3
> 
> 时间：2012-11-20T15:19:23.100
> 
> 标签：mercurial

我的存储库中有以下情况：

```
A----B----F----G----(long time)----H       <- default branch, H is what I'm working on
      \
       C----D                              <- default branch, long time ago
             \
              E                            <- non-default named branch 
```

我在默认分支中工作，当前版本是 H，提示。可悲的是，在历史时期，有人在 D 上工作，然后在修订版 E 中将其分支到一个命名的分支中。（这实际上是一个 SVN 导入，但这并不重要）。

到目前为止，这还不是问题，因为 D 不是拓扑头。但是现在我使用 buildbot 来执行一些测试，并且 buildbot 抱怨默认分支中有多个头。这是正确的，因为它用于`hg heads`确定默认磁头。

我怎样才能摆脱 D 作为默认分支的负责人？我想通过关闭 D `hg commit --close-branch`。但这不会创建一个实际的拓扑头吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T18:29:40.550

**简短的回答：没有**

图解答案

`>hg glog --template "{rev}-{branch}\n"`

```
o  9-German
|
| @  8-default
| |
o |  7-default
| |
o |  6-default
| |
o |  5-default
| |
| o  4-default
| |
| o  3-default
| |
| o  2-default
| |
| o  1-default
|/
o  0-default 
```

`>hg heads`

```
changeset:   9:62eaf0f52632
branch:      German

changeset:   8:39b0fec94839

changeset:   7:d98a89a763cf 
```

`>hg up 7`

`>hg commit --close-branch -m "Close variation"`

`>hg heads`

```
changeset:   9:62eaf0f52632
branch:      German

changeset:   8:39b0fec94839 
```

只有在创建（非封闭）10 个孩子的情况下**才会出现**新的拓扑头

![回购树](../Images/38234368fd5a957bf203204c2f697a7e.png)

# php - 是否可以破解 mysql_real_escape_string() Htmlspecialchars()？

> ID：13476316
> 
> 赞同：0
> 
> 时间：2012-11-20T15:20:06.587
> 
> 标签：php, xss, sql-injection, mysql-real-escape-string, htmlspecialchars

我在我的 PHP 代码中使用`mysql_real_escape_string()`和`Htmlspecialchars()`函数，以使其免受 sql 注入和 XSS 的影响。有没有可能破解这些功能？如果是的话，你能描述一下它是如何完成的，以便我可以改进我的代码。

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:25:09.213

如果您的 PHP 已更新，请尝试使用 mysqli 或 PDO 和[准备好的语句](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)

但是要回答您的问题，可以注入 YES mysql_real_escape_string() ，但是这样做非常复杂。这是一个[例子](https://stackoverflow.com/questions/5741187/sql-injection-that-gets-around-mysql-real-escape-string)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:26:36.603

要防止 SQL 注入，您要做的第一件事是使用[PDO](http://www.php.net/manual/es/class.pdo.php)和准备好的语句。或者至少是 mysqli，因为 mysql 已被弃用，迁移到 mysqli 非常容易并且已经过优化

如果你使用`mysql_real_escape_strings`你应该是安全的，只要你正确地逃脱并且在你真正需要的地方，请记住，在大多数情况下，错误是人为的，而不是因为功能：P

# compare - Excel vba - 将非数学复制并粘贴到第三个工作表的问题（在比较两个范围并找到不匹配项之后）

> ID：13476318
> 
> 赞同：1
> 
> 时间：2012-11-20T15:20:18.833
> 
> 标签：compare, copy-paste

我有两个工作表（Month1 和 Month2）。我正在尝试查找不匹配项，然后将不匹配项复制并粘贴到第三个工作表（EndReport）中。但是，它根本没有粘贴可能是由于代码......有人可以建议我如何修改我的复制和粘贴代码以使其工作......非常感谢！

```
'Search for Non-Matched IO Series of Month 2 and populate the data into EndReport

Dim iNON As Long
Dim arrSum As Variant, arrUsers As Variant
Dim cUnique As New Collection

'Put the name range from "Month2" in an array
With ThisWorkbook.Sheets("Month2")
    arrSum = .Range("A3", .Range("A" & Rows.Count).End(xlUp))
End With

'"Convert" the array to a collection (unique items)
For iNON = 1 To UBound(arrSum, 1)
    On Error Resume Next
    cUnique.Add arrSum(iNON, 1), CStr(arrSum(iNON, 1))
Next iNON

'Get the users array
With ThisWorkbook.Sheets("Month1")
    arrUsers = .Range("A3", .Range("A" & Rows.Count).End(xlUp))
End With

'Check if the value exists in the Month1 sheet
For iNON = 1 To cUnique.Count
    'if can't find the value in the users range, delete the rows
    If Application.WorksheetFunction.VLookup(cUnique(iNON), arrUsers, 1, False) = "#N/A" Then
        With ThisWorkbook.Sheets("Month2").Cells
            .AutoFilter Field:=1, Criteria1:=cUnique(iNON)
            .Range("A3", .Range("A" & Rows.Count).End(xlUp)).EntireRow.Copy
        End With

        Sheets("EndReport").Activate
        Sheets("EndReport").Select
        ThisWorkbook.Sheets("EndReport").Cells.Range("A3", Range("A" & Rows.Count).End(xlUp)).Paste Paste:=xlPasteValues

        Worksheets("EndReport").Range("A" & Worksheets("EndReport").Range("A65536").End(xlUp).Row & "").Offset(1, 0).Select
    End If
Next iNON

'removes AutoFilter if one remains
ThisWorkbook.Sheets("Month2").AutoFilterMode = False 
```

# asp.net-mvc - ASP.Net MVC 4 -> 加载符号需要 25 秒

> ID：13476324
> 
> 赞同：2
> 
> 时间：2012-11-20T15:20:28.870
> 
> 标签：asp.net-mvc

我正在 Visual Studio 2012 中开发一个新的 MVC4 应用程序。

每次我运行此 (F5) 时，所有符号都需要大约 25 秒才能加载。

每次都需要这么长时间正常吗？（我有一台最近/快速的笔记本电脑）

我已经删除了一些我不需要的库。

在构建/发布之间进行选择没有区别。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:23:06.620

我的一个同事也有同样的问题。至少在他的情况下，尽管看起来无关紧要，但事实证明是他的病毒扫描程序。显然禁用病毒扫描程序不是一个选项，但他能够将文件夹级别的排除添加到他的病毒扫描程序中，并且他使用包含他正在使用的解决方案的文件夹这样做。据我了解，这解决了他所看到的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:23:38.640

尝试取消选中此选项：

工具\选项\调试\常规\启用源服务器支持

# php - CentOS 6、PHP 和 APC 上的分段错误（11）

> ID：13476326
> 
> 赞同：1
> 
> 时间：2012-11-20T15:20:35.557
> 
> 标签：php, linux, centos, apache, apc

我的服务器上的 httpd error_log 中有很多分段错误 (11)。

```
[Tue Nov 20 16:14:41 2012] [notice] child pid 30017 exit signal Segmentation fault (11) 
```

它是带有 PHP 5.4.8、Httpd 和 APC 3.1.13 的 CentOS 6.3。

我注意到当我使用 Zend 框架的 Google Calendar API 和停用 APC 时会发生这种情况，这个问题就停止了。

有任何想法吗 ？

我的 gdb BT ：

```
#0  0x00007f0ad0e95da9 in ?? () from /etc/httpd/modules/libphp5.so
#1  0x00007f0ad0e95f83 in ?? () from /etc/httpd/modules/libphp5.so
#2  0x00007f0ad0ec88c1 in zend_hash_destroy () from /etc/httpd/modules/libphp5.so
#3  0x00007f0ad0ebac87 in _zval_dtor_func () from /etc/httpd/modules/libphp5.so
#4  0x00007f0ad0eadeaa in _zval_ptr_dtor () from /etc/httpd/modules/libphp5.so
#5  0x00007f0ace4a889f in apc_free_class_entry_after_execution (src=0x7f0adda6bb08) at /var/tmp/APC/apc_compile.c:2003
#6  0x00007f0ace4abdcc in apc_deactivate () at /var/tmp/APC/apc_main.c:948
#7  apc_request_shutdown () at /var/tmp/APC/apc_main.c:1042
#8  0x00007f0ace4a1d25 in zm_deactivate_apc (type=<value optimized out>, module_number=<value optimized out>) at /var/tmp/APC/php_apc.c:407
#9  0x00007f0ad0ec1c44 in ?? () from /etc/httpd/modules/libphp5.so
#10 0x00007f0ad0e5e085 in php_request_shutdown () from /etc/httpd/modules/libphp5.so
#11 0x00007f0ad0f654a7 in ?? () from /etc/httpd/modules/libphp5.so
#12 0x00007f0adb5e9b00 in ap_run_handler ()
#13 0x00007f0adb5ed3be in ap_invoke_handler ()
#14 0x00007f0adb5f8a30 in ap_process_request ()
#15 0x00007f0adb5f58f8 in ?? ()
#16 0x00007f0adb5f1608 in ap_run_process_connection ()
#17 0x00007f0adb5fd807 in ?? ()
#18 0x00007f0adb5fdb1a in ?? ()
#19 0x00007f0adb5fe79c in ap_mpm_run ()
#20 0x00007f0adb5d5900 in main () 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T17:54:49.230

我已经从主干编译了 APC，我再也没有问题了！

# linq - EF Group By 删除导航属性

> ID：13476328
> 
> 赞同：0
> 
> 时间：2012-11-20T15:20:42.460
> 
> 标签：linq, entity-framework, group-by

EF，我正在检索一个小部件实体。当我 GroupBy 时，它返回时没有填充导航属性，当我不 GroupBy 时，导航属性被填充。我的 groupby 可能是错误的，但为什么唯一受影响的是导航属性？以下是查询：

```
List<NewFacilityLimit> group = (from item in tdsDb.Widgets
                                     .Include("NewTslTiers") 
                                     group item by item.AreaId
                                     into groupedPerAreaId 
                                     let maxWidgetId = 
                                     groupedPerAreaId.Max(item => item.WidgetId) 
                                     select groupedPerAreaId.Where( 
                                     y => y.WidgetId == maxWidgetId)
                                     .FirstOrDefault()) 
                                     .ToList(); 
```

返回没有NewTslTiers。然而：

```
 List<NewFacilityLimit> noGroup = (from item in tdsDb.Widgets
                                     .Include("NewTslTiers") 
                                     select item).ToList(); 
```

这与 NewTslTiers 一起返回。唯一的区别是分组依据。任何接受者为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T13:40:53.130

这显然是“设计使然” -[包含投影不起作用](https://stackoverflow.com/questions/7917348/include-with-projection-does-not-work)

我在 MSDN 上没有看到任何内容，但有[一篇 2009 年的博客文章](http://blogs.msdn.com/b/alexj/archive/2009/06/02/tip-22-how-to-make-include-really-include.aspx)和[2007 年的一篇论坛文章](http://social.msdn.microsoft.com/forums/en-US/adodotnetentityframework/thread/d700becd-fb4e-40cd-a334-9b129344edc9/)讨论了这种行为。

# ruby-on-rails-3 - Gem 测试无法使用 url_for 找到路线

> ID：13476334
> 
> 赞同：4
> 
> 时间：2012-11-20T15:20:58.877
> 
> 标签：ruby-on-rails-3, routes, gem, rspec2, rspec-rails

我认为运行我的 gem 测试的虚拟应用程序设置不正确，因为当我`url_for`在 gem 的帮助程序中调用 Gadget 实例（来自虚拟应用程序的存根模型）时，我得到

```
undefined method `gadgets_path' for #<#<Class:0x007fe274bc1228>:0x007fe273d45eb0> 
```

**背景：**我分叉了一个 gem 并进行了一些重大更改。（[这是叉子](https://github.com/pjmorse/jeditable-wysiwyg-rails)。）现在我正在尝试使 rspec 测试正常工作，以便我可以验证我的更新。

测试的设置类似于 Rails 引擎，`spec`目录中有一个虚拟应用程序。该应用程序有一个模型 ( `Gadget`) 具有适当的控制器和`spec/dummy/environment/routes.rb`文件中声明的资源：

```
Dummy::Application.routes.draw do
  resources :gadgets
end 
```

该`spec/spec_helper.rb`文件如下所示：

```
ENV["RAILS_ENV"] ||= "test"

require File.expand_path("../dummy/config/environment", __FILE__)
require 'rspec/rails'

require 'rspec/autorun'

RSpec.configure do |config|
  config.mock_framework = :rspec
  config.fixture_path = "#{::Rails.root}/spec/fixtures"
  config.use_transactional_fixtures = true
  config.infer_base_class_for_anonymous_controllers = false
  config.order = "random"

  config.include Rails.application.routes.url_helpers
end 
```

[（实际上，您可以在项目的 github 存储库](https://github.com/pjmorse/jeditable-wysiwyg-rails)中看到完整的测试设置。我实际上在一周左右之前为此打开[了一个问题，但直到现在我才开始尝试解决它。​​）](https://github.com/pjmorse/jeditable-wysiwyg-rails/issues/6)

一个未挂起的测试会创建一个 Gadget 实例，然后以它作为参数调用助手。当助手尝试`url_for(@gadget)`时，它会触发上述错误。

这里有什么问题？

ETA 12 月 4 日：更新为当前的`spec_helper.rb`.

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-04T13:39:46.610

**更新**

把它放在你的 spec_helper.rb 中——至少这对我有用（我克隆了你的仓库）

```
ActionView::TestCase::TestController.instance_eval do
  helper Rails.application.routes.url_helpers#, (append other helpers you need)
end
ActionView::TestCase::TestController.class_eval do
  def _routes
    Rails.application.routes
  end
end 
```

真正的问题是，`TestController`从`ActionController::Base` **以前** `ActionController::Base`继承的子类是用路由辅助方法扩展的。
所以你需要将它注入到`TestController`. `_routes`此外，还需要实现AbstractController::UrlFor 。

* * *

为了使用路由助手，您应该插入

```
Rspec.configure do |config|
  config.include Rails.application.routes.url_helpers
  ...
end 
```

在您的 spec_helper.rb 中，它使所有`something_path`方法都可用。**解决实际问题的**另一种方法是像这样删除助手：

```
helper.stub!(:url_for).and_return("/path") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-04T12:01:03.490

虽然这是相当多的源代码，但在我看来，您正在调用`editable_field`它，而后者又调用了`url_for`. 但是`url_for`只能在控制器的上下文中工作，而您只是在规范的中间调用它。

因此，也许将这种方法存根或进行集成测试将是一个合适的解决方法。

# c# - 按流量类型的访问量作为指标

> ID：13476335
> 
> 赞同：0
> 
> 时间：2012-11-20T15:20:59.890
> 
> 标签：c#, google-analytics, google-api

我正在编写软件来分析我的网站流量。我在查询中有类似的东西：

```
var query1 = new DataQuery(dataFeedUrl)
                {
                    Ids = string.Format("ga:{0}", profileId),
                    Metrics = "ga:visits,ga:newVisits,ga:organicSearches",
                    Sort = "ga:visits",
                    GAStartDate = startDate.ToString("yyyy-MM-dd"),
                    GAEndDate = endDate.ToString("yyyy-MM-dd"),
                    StartIndex = 1
                }; 
```

我必须按流量类型（不仅是有机搜索）获取有关访问的更多数据，例如：

*   直接的
*   推荐
*   有薪酬的
*   邮寄

我怎样才能将它们作为指标？亲切的问候！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:46:04.850

您可以通过向与流量来源相关的查询添加维度来做到这一点。这将使您能够查看访问次数、新访问次数等指标的数据，但按流量来源分开。

我不知道 C#，但我想代码会是这样的：

```
var query1 = new DataQuery(dataFeedUrl)
            {
                Ids = string.Format("ga:{0}", profileId),
                Dimensions = "ga:source,ga:medium",
                Metrics = "ga:visits,ga:newVisits",
                Sort = "ga:visits",
                GAStartDate = startDate.ToString("yyyy-MM-dd"),
                GAEndDate = endDate.ToString("yyyy-MM-dd"),
                StartIndex = 1
            }; 
```

您可以在此处找到有关您可以使用的所有维度和指标组合的文档：[https ://developers.google.com/analytics/devguides/reporting/core/dimsmets](https://developers.google.com/analytics/devguides/reporting/core/dimsmets)

您还可以使用 GA Query Explorer 试验不同的查询参数：http: [//ga-dev-tools.appspot.com/explorer/](http://ga-dev-tools.appspot.com/explorer/)

# haskell - 惰性评估实现

> ID：13476336
> 
> 赞同：1
> 
> 时间：2012-11-20T15:21:00.723
> 
> 标签：haskell, lazy-evaluation

我有一个函数`fromRange`，它接受一个过滤函数和一个区间，并返回一个集合，其中包含区间中满足过滤函数的所有元素。

我使用列表理解实现了它：

```
fromRange   :: (Integer->Bool) -> (Integer,Integer)  -> [Integer]
fromRange f (x,y) = [i | i<-[x..y], f i] 
```

但是大列表需要很长时间，所以我找到了懒惰的评估概念，但我不知道如何实现它，有什么帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T15:36:37.400

对于大型数据集，惰性评估不应该更快，它只会将评估推迟到需要值的那一刻。例如，如果您输入`ghci`：

```
fromRange (< 50) (1, 1000000000) 
```

在它遍历整个列表以过滤它并打印结果之前，您必须永远等待。

另一方面：

```
take 10 $ fromRange (< 50) (1, 1000000000) 
```

将立即完成，因为它不必计算列表的其余部分。

注意：`take 100`也会挂起，因为它永远找不到足够的条目。

# ssis - 来自 Oracle 源的 SSIS

> ID：13476344
> 
> 赞同：1
> 
> 时间：2012-11-20T15:21:26.837
> 
> 标签：ssis

我对SSIS相当陌生。我正在尝试从 Oracle 源加载数据。我安装了 Oracle 客户端 9i。我也有Attunity。

在 Oracle Connection Manager 编辑器上，TNS 服务名称是什么？你也可以有步骤吗？我想看看我做得对不对。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T17:52:55.900

我想通了：这就像 sql server 中的数据库名称。

# redis - 进入“发布/订阅”模式后如何发出“订阅”命令？

> ID：13476348
> 
> 赞同：4
> 
> 时间：2012-11-20T15:21:51.813
> 
> 标签：redis, publish-subscribe

使用 redis-cli 进入“发布/订阅”模式后，我找不到任何订阅其他频道的方法。例如：

```
$ redis-cli
redis> SUBSCRIBE channel:1
Reading messages... (press Ctrl-C to quit)
1) "subscribe"
2) "channel:1"
3) (integer) 1 
```

当我按下 Ctrl-C 时，redis-cli 退出而不是“pub/sub”模式。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-20T06:59:54.690

实际上， [SUBSCRIBE](http://redis.io/commands/subscribe)和[PSUBSCRIBE](http://redis.io/commands/psubscribe)都会阻止所有后续命令，因此您不能将任何订单发送到服务器，而是将您的热切目光投向等待您感兴趣的频道接收消息。好吧，这种荒谬的行为也让我头晕目眩。但是，如果您尝试通过 telnet`telnet localhost 6379`而不是 redis-cli 的方式访问 redis。一切都会变好。请检查一下。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:36:08.533

AFAIK，订阅频道后，您无法在 redis-cli 中发出新命令。但是，[SUBSCRIBE](http://redis.io/commands/subscribe)命令从 2.4 版本开始是可变参数的，这意味着您可以一次通过多个频道来订阅：

```
redis 127.0.0.1:6379> SUBSCRIBE channel:1 channel:2
Reading messages... (press Ctrl-C to quit)
1) "subscribe"
2) "channel:1"
3) (integer) 1
1) "subscribe"
2) "channel:2"
3) (integer) 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-14T10:10:14.897

这是*的问题`redis-cli`，而不是 Redis*的问题。

Redis 说我们**可以**在发出`SUBSCRIBE`一个之后再发出一个`SUBSCRIBE`。但是，`redis-cli`会**阻止**一切。

因此，正如@user1611552 所建议的，我们可以使用

```
telnet localhost 6379 
```

而不是`redis-cli`, 一切都会好起来的。

# go - 在 Go 中检查 nil 和 nil 接口

> ID：13476349
> 
> 赞同：83
> 
> 时间：2012-11-20T15:21:54.773
> 
> 标签：go

目前我正在使用这个辅助函数来检查 nil 和 nil 接口

```
func isNil(a interface{}) bool {
  defer func() { recover() }()
  return a == nil || reflect.ValueOf(a).IsNil()
} 
```

由于`reflect.ValueOf(a).IsNil()`如果值的 Kind 不是`Chan`, `Func`, `Map`, `Ptr`, `Interface`or时会发生恐慌`Slice`，因此我投入了 deferred`recover()`来捕捉那些。

有没有更好的方法来实现这个检查？它认为应该有更直接的方法来做到这一点。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-20T15:43:14.887

例如，请参阅golang-nuts 邮件列表中此[线程](https://groups.google.com/d/topic/golang-nuts/wnH302gBa4I/discussion)中Kyle 的回答。

简而言之：如果您从不存储`(*T)(nil)`在接口中，那么您可以可靠地使用与 nil 的比较，无需使用反射。另一方面，将无类型 nil 分配给接口总是可以的。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2018-05-23T11:21:22.703

如果之前的选项都不适合您，那么到目前为止我能想到的最好的方法是：

```
if c == nil || (reflect.ValueOf(c).Kind() == reflect.Ptr && reflect.ValueOf(c).IsNil()) 
```

至少它检测到 (*T)(nil) 个案例。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2018-02-28T00:45:48.410

**不使用反射的**两种解决方案：

将代码复制并粘贴到编辑器中：https: [//play.golang.org/](https://play.golang.org/)以查看实际情况。

# 1：在接口中添加“IsInterfaceNil()”函数。

# 2：使用A“类型开关”

**下面的代码：**

**一一一一一一一一一一一一一一一一一一一一**

**示例 #1：IsInterfaceNil()**

**一一一一一一一一一一一一一一一一一一一一**

```
//:Example #1:
//:I prefer this method because the 
//:TakesInterface function does NOT need to know
//:about all the different implementations of
//:the interface.
package main;
import "fmt";

func main()(){

    var OBJ_OK *MyStruct = &( MyStruct{} );
    var NOT_OK *MyStruct = nil;

    //:Will succeed:
    TakesInterface( OBJ_OK );

    //:Will fail:
    TakesInterface( NOT_OK );

}

func TakesInterface( input_arg MyInterface ){

    if( input_arg.IsInterfaceNil() ){
        panic("[InputtedInterfaceIsNil]");
    }

    input_arg.DoThing();
}

type MyInterface interface{
    DoThing()()
    IsInterfaceNil()(bool)
}
type MyStruct struct{}
func(f *MyStruct)DoThing()(){
    fmt.Println("[MyStruct.DoThing]");
}
func(f *MyStruct)IsInterfaceNil()(bool){
    if(nil==f){ return true; }
    return false;
} 
```

**一一一一一一一一一一一一一一一一一一一一**

**示例 #2：类型切换**

**一一一一一一一一一一一一一一一一一一一一**

```
//:Example #2:
//:This will also work, but the function taking
//:the interface needs to know about all 
//:implementations. This defeats a bit of the
//:decoupling from implementation that an
//:interface offers, but if you are just using
//:interfaces for polymorphism, it's probably
//:an okay way to go. (opinion)
package main;
import "fmt";

func main()(){

    //:Will succeed:
    var OBJ_OK *IMPLMENTS_INTERFACE_01 = 
             &( IMPLMENTS_INTERFACE_01{} );
    TakesInterface( OBJ_OK );

    //:Will fail:
    var NOT_OK *IMPLMENTS_INTERFACE_01 = nil;
    TakesInterface( NOT_OK );
}

func TakesInterface( hasDoThing MyInterface ){

    //:THIS WILL NOT WORK:
    if(nil==hasDoThing){
        panic("[This_Error_Message_Will_Never_Happen]");
    }

    //:TYPE SWITCH TO THE RESCUE:
    switch v := hasDoThing.(type){

        case (*IMPLMENTS_INTERFACE_01): 
        if(nil==v){ panic("[Nil_PTR_01]"); }

        case (*IMPLMENTS_INTERFACE_02): 
        if(nil==v){ panic("[Nil_PTR_02]"); }

        case (*IMPLMENTS_INTERFACE_03): 
        if(nil==v){ panic("[Nil_PTR_03]"); }

        default: 
            panic("[UnsupportedInterface]");
    }

    hasDoThing.DoThing();

}

type IMPLMENTS_INTERFACE_01 struct{};
type IMPLMENTS_INTERFACE_02 struct{};
type IMPLMENTS_INTERFACE_03 struct{};
func (f *IMPLMENTS_INTERFACE_01)DoThing()(){
    fmt.Println( "DoingTheThing_01" );
}
func (f *IMPLMENTS_INTERFACE_02)DoThing()(){
    fmt.Println( "DoingTheThing_02" );
}
func (f *IMPLMENTS_INTERFACE_03)DoThing()(){
    fmt.Println( "DoingTheThing_03" );
}

type MyInterface interface{
    DoThing()()
} 
```

**更新：** 在我的代码库中实施后，我发现#2（类型切换）是最好的解决方案。特别是因为我不想在我正在使用的绑定库中编辑 glfw.Window 结构。这是我的用例的粘贴箱。为我的非标准编码风格道歉。[https://pastebin.com/22SUDeGG](https://pastebin.com/22SUDeGG)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-14T14:39:47.010

这是此示例解决方案的接口定义：

```
package checker

import (
    "errors"

    "github.com/rs/zerolog"
)

var (
    // ErrNilChecker returned if Check invoked on a nil checker
    ErrNilChecker = errors.New("attempted Check with nil Checker")

    // ErrNilLogger returned if the Check function is provide a nil logger
    ErrNilLogger = errors.New("nil logger provided for Check")
)

// Checker defines the interface
type Checker interface {
    Check(logger *zerolog.Logger) error
} 
```

我们的检查器实现之一支持检查器的聚合。但是测试发现了与此线程相同的问题。如果简单的 nil 检查失败，此解决方案将使用`reflect`包，利用`reflect.Value`类型来解决问题。

```
// AggregateChecker implements the Checker interface, and
//  supports reporting the results of applying each checker
type AggregateChecker struct {
    checkers []Checker
}

func (ac *AggregateChecker) Add(aChecker Checker) error {
    if aChecker == nil {
        return ErrNilChecker
    }

    // It is possible the interface is a typed nil value
    // E.g. checker := (&MyChecker)(nil)
    t := reflect.TypeOf(aChecker)
    if reflect.ValueOf(aChecker) == reflect.Zero(t) {
        return ErrNilChecker
    }

    ac.checkers = append(ac.checkers, aChecker)
    return nil
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-06T10:47:51.423

可能是您尝试在填充界面的函数中使用错误：

包装一个

```
func getObj() (obj *someObject, err error) {
   obj = db.getA()
   if obj == nil {
      err = fmt.Errorf("Some error")
   }
   return
} 
```

包 b

```
import a

var i interface{}

i, err = a.getObj()
if err != nil {
   // catch err
} else {
   // do next step
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2020-12-14T13:35:09.490

认为`inboundData`是你的界面

使用`len()`函数检查界面是否有数据

```
if inboundData != nil && len(inboundData) > 0 {
    // ... do stuff | data is present
} else {
    // ... data is not present
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2021-07-20T13:29:49.630

```
func main() {
    var foo interface{}
    fmt.Println(reflect.TypeOf(foo) == nil) // true

    type Bar struct{}
    var bar *Bar
    fmt.Println(reflect.TypeOf(bar) != nil) // true
} 
```

# file - 具有安全过滤器和浏览器兼容性的 GWT 文件上传

> ID：13476351
> 
> 赞同：1
> 
> 时间：2012-11-20T15:21:56.080
> 
> 标签：file, gwt, file-upload, input, upload

我需要一种用户可以输入文件并在 GWT 面板中显示文件内容的方法。内容不需要发送到任何服务器，我更愿意将文件保留在客户端。我尝试了以下方法：

*   使用库 lib-gwt-file。它在 Firefox 中完美运行，主要在 Chrome 中运行，在 Internet Explorer 中根本无法运行。我需要支持所有这些浏览器。我已经给图书馆的作者发了电子邮件，但没有收到回复。

*   使用[诸如此类](http://www.jroller.com/hasant/entry/fileupload_with_gwt)的方法来使用 FileUpload 对象和 FormPanel。但是，我的组织使用安全过滤器，它需要设置标头才能与服务器通信。我了解无法为 FormPanel 设置标题。

*   我已经调查了 GWT 的其他文件上传库，例如 GWTUpload，但它们并没有真正做到我想要的。我不想将文件上传到我的服务器，我只需要文件客户端的内容。

我没有想法，我不知道如何完成这个简单的任务。有没有人对其他方法或方式来克服我目前的障碍有任何建议？
谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T15:09:10.607

我现在可以完全回答我自己的问题了。Neeko 在上面是正确的，但 lib-gwt-file 在这个用例中不能正常工作。因此，我联系了该图书馆的制造商并解释了这些问题。他解决了我在 Chrome 中遇到的问题，并且使该库在 IE10 上运行良好。正如 Neeko 所说，不支持 IE9。

在 IE10 中，必须通过在 URL 末尾添加 &mode=typeArrays 来启用对 typedArrays 的支持。这是 IE 中的错误的一种解决方法，可能并不总是必要的。

在 Chrome 中，有一个 Webkit 错误，其中两次选择相同的文件将不再触发更改事件，因此无法连续两次上传相同的文件。在下一版本的 lib-gwt-file 中有一个解决方法。

Firefox 从 0.3.2 版开始可以正常工作

因此，如果其他人尝试使用此库并遇到这些问题，那么它现在应该更适合您。lib-gwt-file 的作者 Lukas Laag 对解决这些问题非常有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T16:32:45.750

使用[lib-gwt-file API](http://www.vectomatic.org/libs/lib-gwt-file)是实现此目的的最佳方式，因为它封装了用于 GWT 的[HTML5 File API](http://dev.w3.org/2006/webapi/FileAPI/)，这使得本地文件系统访问成为可能；据我所知，本地文件系统访问是不可能的。不幸的是，IE 9 和更低版本不支持 File API，所以这就是 lib-gwt-file 不起作用的原因。[File API 直到IE10](http://msdn.microsoft.com/en-us/library/ie/hh673542%28v=vs.85%29.aspx)才被引入 IE 。

编辑：根据这个[SO answer](https://stackoverflow.com/questions/6710432/ie-and-local-file-reading)，您可以通过 ActiveX 访问 IE 中的本地文件系统，但它是有限制的，要与 GWT 一起使用，您必须使用[JSNI](https://developers.google.com/web-toolkit/doc/latest/DevGuideCodingBasicsJSNI)在 GWT 代码中手写 JavaScript。

# c# - 重载 + 用于布尔加法

> ID：13476354
> 
> 赞同：0
> 
> 时间：2012-11-20T15:22:12.853
> 
> 标签：c#, operator-overloading

我需要计算所有选中的复选框，我的意思是使用运算符重载作为这个例子：

```
public static int operator +(bool b1, bool b2)
{
    int i1 = 0;
    int i2 = 0;

    if (b1) i1 = 1;
    if (b2) i2 = 1;

    return i1 + i2;
} 
```

然后总数将被简单地检索

```
int countCbx = cbx1.Checked + cbx2.Checked + ... 
```

但它不起作用，我不明白为什么。编译错误是“二元运算符的参数之一必须是包含类型”。逻辑看起来不错，但这是我第一次在示例之外使用运算符重载。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T15:24:01.370

> 但它不起作用，我不明白为什么。

因为语言规范是这么说的。编译器基本上给了你原因。

> 逻辑看起来不错，但这是我第一次在示例之外使用运算符重载。

*成员主体*的逻辑很好 - 但您不能为任意类型重载运算符。至少有一个操作数（或转换的返回类型）必须是您在其中声明运算符的类型。

C# 5 规范在第 10.10 节中包含此内容：

> 与其他成员一样，在基类中声明的运算符由派生类继承。因为运算符声明始终要求声明运算符的类或结构参与运算符的签名，所以在派生类中声明的运算符不可能隐藏在基类中声明的运算符。因此，new 修饰符在操作符声明中从来不是必需的，因此也绝不是允许的。

然后在 10.10.1 中强制执行该规则：

> 以下规则适用于一元运算符声明，其中 T 表示包含运算符声明的类或结构的实例类型：
> 
> *   一元 +、-、! 或 ~ 运算符必须采用 T 或 T 类型的单个参数？并且可以返回任何类型。
> *   ...

.... 10.10.2：

> 以下规则适用于二元运算符声明，其中 T 表示包含运算符声明的类或结构的实例类型：
> 
> *   二元非移位运算符必须采用两个参数，其中至少一个必须具有类型 T 或 T?，并且可以返回任何类型。
> *   二元`<<`或`>>`运算符必须有两个参数，第一个参数的类型必须是 T 还是 T？而第二个必须有 int 或 int? 类型，并且可以返回任何类型。

...和 ​​10.10.3：

> 对于给定的源类型 S 和目标类型 T，如果 S 或 T 是可空类型，则令 S0 和 T0 引用它们的基础类型，否则 S0 和 T0 分别等于 S 和 T。仅当满足以下所有条件时，才允许类或结构声明从源类型 S 到目标类型 T 的转换：
> 
> *   S0 和 T0 是不同的类型。
> *   S0 或 T0 是发生运算符声明的类或结构类型。
> *   ...

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T15:25:28.363

你不能仅仅因为语言不允许这样做。加法运算符不能重载以处理`bool`值，并且由于`bool`不能隐式转换为任何算术类型（例如在 C++ 中），因此您没有选择余地。

如果要计算复选框的数量，例如可以使用

```
var count = (new[] { cbx1, cbx2, ... }).Count(cb => cb.Checked); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T15:24:47.093

编译错误会告诉你究竟出了什么问题。

> “二元运算符的参数之一必须是包含类型”

除了要为其重载的类型（或其中一种类型）的定义之外，您不能重载运算符。

我可以建议吗

```
int countCbx = new[] { cbx1, cbx2, ... }.Count(c => c.Checked); 
```

# java - RSA 如何将密钥分发给发送方和接收方？

> ID：13476355
> 
> 赞同：2
> 
> 时间：2012-11-20T15:22:13.623
> 
> 标签：java, encryption, rsa, encryption-asymmetric, secret-key

我正在研究一个使用 RSA 加密算法的加密项目，我已经实现了 RSA 算法并理解了它，但是我怎样才能安全地将私钥发送给接收者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:24:47.590

使用非对称加密时，您永远不要将私钥发送给接收者。接收者拥有您的公钥来解密使用您的私钥加密的消息。

其他方式可能是您使用接收者公钥加密，只有他可以使用他的私钥解密消息。

所以非对称加密意味着永远不要给你手头的私钥。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-03-30T22:44:32.643

在**私钥密码系统**中，无论加密和解密方案多么复杂，都需要发送方和接收方都同意该方案，然后才能使用它进行通信。这是 RSA 和其他**公钥密码系统**试图解决的密码学的基本问题。

在 RSA 中，接收方使用两个非常大的素数生成一个公钥*(N, e)*和一个私钥*d*，大到它们的乘积很难分解。[（你可以参考这里](https://en.wikipedia.org/wiki/RSA_(cryptosystem))的密钥生成细节） RSA与前面提到的私钥算法的关键区别在于，*任何人都*可以使用接收者生成的公钥加密消息并将其发送给*任何人*，但只能发送给接收者，有了私钥，就可以解密消息了。因此，RSA 通常被称为**非对称密码系统**。

# ruby-on-rails - 当新表单位于父级的显示模板上时，如何处理保存嵌套资源的错误？

> ID：13476358
> 
> 赞同：0
> 
> 时间：2012-11-20T15:22:25.567
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我有两个资源`Team`和`Player`. Player 是我的 Team 下的嵌套资源`routes.rb`。

对于团队，我有一个`show`带有`show.html.erb`模板的操作。在那个模板中，我有类似的东西`form_for [@team, @team.players.build]`，所以基本上我可以从团队视图中创建一个新玩家。

现在在控制器中为错误编码渲染/重定向的最佳方法`Player#create`是*什么*？在标准的创建动作中，我会呈现`new`带有错误的动作：

```
 if @player.save
    redirect_to @player, notice: 'Player was successfully created.'
  else
    render action: 'new'
  end 
```

但现在我在另一个控制器 ( `Player#create`) 中，而我的表单在`Team#show`. 如果出错时我重定向到@team，比如成功时，我将丢失存储在实例变量中的错误信息。尝试渲染更好`team/show.html.erb`吗？这看起来有点乱。或者也许将 Player 的创建操作添加到 Team 控制器中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:01:25.837

我为您看到 3 个选项：

1.  用于`flash`处理错误消息。您将没有可用的实例变量，但您将呈现的任何内容都可以进入`flash[:error]`并在 Team#show 中使用。

2.  使用带有 json 响应的远程请求。您根本不需要重定向，只需返回一个 json 对象，其中包含新玩家的部分内容（成功时）或错误消息（出错时）。处理远程回调中的响应以相应地更新页面。

3.  将玩家创建逻辑移至 Team 控制器。只有当其他选项都不可行时，我才会这样做。

# android - 禁止删除或禁用 Android 应用

> ID：13476360
> 
> 赞同：0
> 
> 时间：2012-11-20T15:22:27.800
> 
> 标签：android

我是一名初学者 Android 开发人员，他对通过 GUI 选项管理器使我的应用程序不可移动和不可禁用的可能性感兴趣。我发现系统应用程序（使用 gui 不可删除）位于 /system/app，但除了某些应用程序（启动器、sim 工具等）外，它们可以被禁用。我想知道，我怎么能用我的应用程序做出同样的行为？

这不是恶意软件，而是我自己设备中的内置应用程序，因此如果它有帮助，我可以拥有完全访问权限（sdk/ndk）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T16:16:05.610

阅读有关 AlarmManager 的信息，它用于 gmail，启动器，在应用程序死亡后，此警报管理器会初始化我们的应用程序。

另一种方式？根访问权限！=/

# azure - LuceneNet 在以下场景中如何工作和实施可行性？

> ID：13476364
> 
> 赞同：2
> 
> 时间：2012-11-20T15:22:34.043
> 
> 标签：azure, lucene, lucene.net, azure-storage

我是 LuceneNet 的新手。我应该说非常新。在阅读了大量有关它的数据后，我心中有一些疑问，我无法清除。好吧，我在一个场景中，我将拥有大量的 PDF/Docs/Excels/Images 以及将具有相关数据的网页。系统中有各种类型的用户，其中一些可以访问特定的 PDF/Docs，而另一些则不能。我将在我希望部署我的应用程序的地方使用 Azure。因此，如果用户搜索某些内容，我只想向他显示那些他有权查看的结果。如果我使用 LuceneNet 可以做到吗？此外，我希望跟踪特定文档/URL等的点击量，以便它可以显示在大多数搜索等中。那么是否可以使用 LuceneNet 来实现呢？当涉及到 PDF/Doc/Docx/XSL/XSLX/PPT/PPTX 等时，如果我想对其中的文件和数据进行索引，我需要使用哪些东西。我应该如何通过 LuceneNet 存储数据（索引数据）？我的意思是我应该将它存储在 BLOB 存储中吗？可取吗？？我希望我的应用程序应该是可扩展的。那么 LuceneNet 会支持我吗？我可以有多个它的工人角色实例吗？重新索引如何发生？如果在重新索引期间重新索引是否会重新生成所有索引，我将能够搜索吗？很抱歉一起提出这么多问题，所有这些问题也可能没有正确的顺序。但我回忆起来问道。我应该如何存储 LuceneNet 的数据（索引数据）？我的意思是我应该将它存储在 BLOB 存储中吗？可取吗？？我希望我的应用程序应该是可扩展的。那么 LuceneNet 会支持我吗？我可以有多个它的工人角色实例吗？重新索引如何发生？如果在重新索引期间重新索引是否会重新生成所有索引，我将能够搜索吗？很抱歉一起提出这么多问题，所有这些问题也可能没有正确的顺序。但我回忆起来问道。我应该如何存储 LuceneNet 的数据（索引数据）？我的意思是我应该将它存储在 BLOB 存储中吗？可取吗？？我希望我的应用程序应该是可扩展的。那么 LuceneNet 会支持我吗？我可以有多个它的工人角色实例吗？重新索引如何发生？如果在重新索引期间重新索引是否会重新生成所有索引，我将能够搜索吗？很抱歉一起提出这么多问题，所有这些问题也可能没有正确的顺序。但我回忆起来问道。所有这些也可能没有正确的顺序。但我回忆起来问道。所有这些也可能没有正确的顺序。但我回忆起来问道。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T17:27:45.210

首先，我会推荐一本名为“Lucene In Action”的书，它适用于 Java，但它使用的是 Lucene 版本 3.0.3，恰好是当前的 Lucene.NET 版本。API 是相同的，因此它是一个很好的入门资源.

回答... 1）是否可以仅在 Lucene.NET 中显示授权记录？是的..你可以通过几种方式做到这一点。如果您需要，您可以按用户分开索引，或者您可以添加其他字段并始终将这些字段包含在搜索查询中。

2）是的，您也可以在 Lucene 中跟踪命中（您可以记录您的命中并根据需要插入它们）

3）如果你想索引PDF、Docs、Docx……你需要提取文本。Lucene 不会为您这样做。因此，您可以使用 Office 自动化（用于 Word Docs..its 免费 API）。API 是基本的，但如果您想要更成熟/成本更高的东西，请选择 AsPose（.NET 库可以完全满足您的需求）

4) 有一个库可以为您抽象 AzureDirectory 并使用 blob 存储。我不推荐它，因为它不适合：Lucene 3.0.3，存在稳定性问题，并且它使用较旧的 Storage Client API（2.0 之前的版本）。我会使用 Azure IaaS 虚拟机并将 Lucene 索引存储在磁盘上。如有必要，您始终可以扩展和添加更多磁盘并条带化磁盘。

5) 你应该只有一个 IndexWriter，但你可以有多个 index Searcher。

6) 从 Lucene 2.9.x 开始，您有一种称为“实时”搜索的功能，您可以在其中更新索引，执行查询的搜索器可以“接近”实时获取新数据，而无需完全提交索引/酡。

# objective-c - Objective-C（iOS）：NSData 到 long long 值？

> ID：13476365
> 
> 赞同：3
> 
> 时间：2012-11-20T15:22:35.540
> 
> 标签：objective-c, nsdata, long-integer

我正在通过网络（来自 ac# windows 服务器）发送一个 8 字节的数值，我的 iDevice 需要接收该数值。该值是我的服务器（System.Int64）上的“长”变量。我检查了该值是否正确转换为字节数组，使用

```
byte[] valueBytes = BitConverter.GetBytes(mylongvalue); 
```

数据通过 NSData 变量在 iDevice 上接收。我需要跳过前 3 个字节，然后读取接下来的 8 个字节来计算我的 long long 值。

我试过这个：

```
NSData * longlongValueBytes = [receivedData subDataWithRange:NSMakeRange(3,8)];
long long receivedLongLongValue = *(const long long *)[longlongValueBytes bytes]; 
```

但这仅适用于低于 128 的值。每个发送的高于或等于 128 的值在收到时总是返回 127。

我错过了什么？这可能与符号问题有关，还是与字节顺序问题有关？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:35:28.487

您是否检查（使用调试器或一些`NSLog`）您的 NSData 的原始内容以确保它被正确接收？

*尤其要检查您的不同系统（您的 Windows Server 和 iOS 设备）之间没有不同的字节顺序。通常，在向网络发送字节之前，请尝试确保它们以“网络字节顺序”表示，该顺序对应于“大端”顺序（最高有效字节在前），而不管发送方或接收方的字节序.*

您可以`NSLog(@"data: %@", longlongValueBytes);`在代码中编写以查看数据的十六进制表示并检查您是否收到了预期的字节。

然后将这些字节转换为 a `long long`，试试这个而不是你的代码：

```
unsigned long long receivedLongLongValue = 0;
[longlongValueBytes getBytes:&receivedLongLongValue length:8];
NSLog(@"received long value: %llu", receivedLongLongValue); 
```

# python - 在保留对象的同时更改 python 迭代器

> ID：13476366
> 
> 赞同：0
> 
> 时间：2012-11-20T15:22:36.087
> 
> 标签：python, sqlalchemy

我有一个可迭代的 SQLAlchemy 查询，假设它是一个名为`query`. 当你迭代它时，你会得到这样的项目：

```
Table1('Column1', 'Column2') 
```

当您在查询对象上连接表然后对其进行迭代时，您会得到元组：

```
(Table1('Column1', 'Column2'), Table2('Column3', 'Column4')) 
```

我知道我可以使用生成器来遍历查询对象，如下所示：

```
(each[0] for each in query) 
```

但这并没有保留 object 上的任何其他方法`query`，而是将其转换为生成器对象。有没有一种简单的方法可以改变迭代部分的行为，`query`同时保留其余方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T03:15:35.633

我想通了，我只需要使用`__getattr__`来转发对另一个对象的访问，并`__iter__`使用新功能进行定义。只要我没有调用任何其他方法来扩展查询，这将与 SQLAlchemy 一起工作，这将创建一个没有这些更改的新对象。我设法通过在计划迭代对象之前包装对象来避免这种情况。

```
class X:
    def __init__(self):
        self.prop1 = "prop1"

    def __iter__(self):
        yield 1
        yield 2
        yield 3

    def method(self):
        print "method 1"

class Y:
    def __init__(self):
        self.prop2 = "prop2"

    def __iter__(self):
        yield (1,2)
        yield (3,4)
        yield (5,6)

    def another_method(self):
        print "method 2"

class FirstInTuple:
    def __init__(self, obj):
        self.obj = obj

    def __getattr__(self, attr):
        return getattr(self.obj, attr)

    def __iter__(self):
        for each in self.obj:
            if hasattr(each, '__getitem__'):
                yield each[0]
            else:
                yield each

if __name__ == "__main__":
    x = X()
    y = Y()
    f_x = FirstInTuple(x)
    f_y = FirstInTuple(y)

    for each in x:
        print each
    print
    for each in y:
        print each
    print
    for each in f_x:
        print each
    print
    for each in f_y:
        print each
    print
    print f_x.prop1
    f_x.method()
    print
    print f_y.prop2
    f_y.another_method() 
```

输出：

```
1
2
3

(1, 2)
(3, 4)
(5, 6)

1
2
3

1
3
5

prop1
method 1

prop2
method 2 
```

# jquery - SF 菜单不显示在 Wordpress 中

> ID：13476367
> 
> 赞同：0
> 
> 时间：2012-11-20T15:22:38.677
> 
> 标签：jquery, css, wordpress, wordpress-theming, superfish

我希望在我的 wordpress 网站中显示以下超级鱼菜单：

[http://rusticblonde.hostizzo.com/](http://rusticblonde.hostizzo.com/)

我在函数文件中调用了 js，如下所示：-

```
<?php
function my_scripts_method() {
wp_enqueue_script('superfish', get_template_directory_uri() . '/js/superfish.js', array('jquery')
);
}
add_action('wp_enqueue_scripts', 'my_scripts_method');
?>
<?php
register_nav_menu('main', 'Main navigation menu');
?> 
```

我还在标题中调用了 CSS 文件：-

```
<link rel="stylesheet" type="text/css" href="http://rusticblonde.hostizzo.com/wp-content/themes/randomtheme/css/superfish.css" /> 
```

我刚刚将它包装在一个 DIV 中，但是由于某种原因它根本没有显示！

```
<div id="menudiv">
<?php wp_nav_menu( array( 'theme_location' => 'primary', 'menu_class' => 'menu sf-menu' ) ); ?> 
</div> 
```

有人可以帮忙吗？谢谢科斯蒂

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:49:34.260

你需要初始化超级鱼菜单:)

在你的`header.php`（或者在你的主题中的一个单独的 js 文件中，用 调用`wp_enqueue_script()`），添加以下代码（如果它是一个单独的文件，跳过开始和结束`<script>`标签）：

```
<script type="text/javascript">
    (function($){
        $(document).ready(function(){ 
            $(".menudiv > div > ul").addClass('sf-menu').superfish();
        });
    })(jQuery)
</script> 
```

此外，您似乎出于某种原因`ul`没有获得`sf-menu`课程 - 这就是为什么`addClass()`在初始化菜单之前调用菜单的原因。

# validation - ace:dateTimeEntry 将无效日期转换为另一个日期

> ID：13476368
> 
> 赞同：0
> 
> 时间：2012-11-20T15:22:51.220
> 
> 标签：validation, date, ace-editor, icefaces-3

我有一个 ace:dateTimeEntry 组件，如下所示：

`<ace:dateTimeEntry id="surveyDate" partialSubmit="true" renderAsPopup="true" value="#{maintainAppointmentManagedBean.surveyNewDate}" pattern="dd/MM/yyyy" showButtonPanel="true" navigator="true" valueChangeListener="#{maintainAppointmentManagedBean.surveyDateChangeListener}"> </ace:dateTimeEntry>`

当我手动输入无效日期（例如 21544/10/2012）时，icefaces 会将其转换为可接受的格式，例如 10/12/2020 或类似的格式。它必须进行一些背景计算，因为它将无效日期转换为其他日期。当它到达我自己的验证器时，日期已经转换为其他日期，因此我的验证无效，并且没有显示有关无效日期格式的消息。没有提出 JIRA 来解决这个问题。在我将此作为错误提出之前，是否有其他人遇到过此问题或有任何解决方案。

此外，当`pattern="dd/MM/yyyy hh:mm"`. 它仅在模式为`pattern="dd/MM/yyyy"`

谢谢， Dakshata Gulkhobare

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-19T18:51:42.220

我尝试添加`lenientParsing="false"`，`ace:dateTimeEntry` 它对我有用。

[日期时间条目](http://res.icesoft.org/docs/v3_latest/ace/tld/ace/dateTimeEntry.html)

# lotus-notes - 如何在用户的默认浏览器中从客户端集成浏览器打开链接？

> ID：13476369
> 
> 赞同：0
> 
> 时间：2012-11-20T15:22:51.140
> 
> 标签：lotus-notes, xpages

**设想：**

Lotus Notes 客户端中的侧边栏小部件从小部件向导配置的 URL 中打开 XPage。这非常有效（SSO，速度）。该 XPage 中的一些链接指向需要更多空间的第 3 方 Web 应用程序。所以链接的目标属性设置为“_blank”以在新窗口中打开，它仍然是 Lotus Notes 客户端的集成浏览器。这个浏览器有些残缺，缺少导航控件、地址栏、书签等。用户希望在默认浏览器（IE、FF）中启动此类链接。这不是 XPiNC 设置。位置文档中的浏览器设置似乎被忽略了。

**问题：**

如何在另一个浏览器中从 Notes 浏览器启动链接？此站点上发布的类似问题声称使用标准浏览器是不可能的。我希望Notes可以做到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T06:28:48.927

最简单的方法是更改​​莲花笔记的默认浏览器:)

文件-> 设置-> Web 浏览器并将其更改为系统的默认浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T06:34:47.630

顺便说一下，看看这里[http://www-01.ibm.com/support/docview.wss?uid=swg21268588](http://www-01.ibm.com/support/docview.wss?uid=swg21268588) Lotus Notes 8 正在使用 IE 来呈现页面。因此，如果 Lotus Notes 的版本是 8，那么即使使用 LN 的嵌入式浏览器，您的客户也不会出现任何问题。

瓦哈恩

# java - 如何在 java 中获取输出流的名称（即 stderr 或 stdout）？

> ID：13476375
> 
> 赞同：3
> 
> 时间：2012-11-20T15:22:55.643
> 
> 标签：java, outputstream

在 Java 中，如果给定的流是`System.err`or ，我如何找到作为参数传递的流的名称`System.out`？

```
public String getStreamName(OutputStream arg0) {
    String streamName = ????;
    return "This is stream: " + streamName;
} 
```

应该返回类似：

```
This is stream: System.err 
```

我试过`arg0.toString()`了，但这似乎没有用，因为返回的名称类似于`java.io.PrintStream@71cb25`每次运行时都会发生变化。如果名称是固定的，我可以将其与标准输出和标准错误的已知名称进行比较。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:32:54.993

System.out 和 System.err 都是 PrintStream 的实例。打印流和输出流没有可以用来区分它们的属性。

API 文档显示了可用的内容：

[http://docs.oracle.com/javase/6/docs/api/java/io/PrintStream.html](http://docs.oracle.com/javase/6/docs/api/java/io/PrintStream.html)

[http://docs.oracle.com/javase/6/docs/api/java/io/OutputStream.html](http://docs.oracle.com/javase/6/docs/api/java/io/OutputStream.html)

在这种情况下，您只需检查 System.out 或 System.err 是否为 ==：

```
if (arg0 == System.out) {

} else if (arg0 == System.err) {

} else {
   // it is another output stream
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:26:35.957

试试这个：

```
public void printStreamName(OutputStream stream) {
    String streamName = "Other";

    if(stream instanceof PrintStream) {
        streamName = stream == System.err ? "System.err" : (stream == System.out ? "System.out" : "Other");
    }

    System.out.println("This is stream: " + streamName);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T15:33:05.190

也许不是最好的解决方案，但它确实有效。

```
public  String getStreamName(OutputStream arg0) {
    boolean lol = arg0.equals(System.err);
    String streamName;

    if(lol)  streamName = "System.err";
    else  streamName = "System.out";

    return "This is stream: " + streamName;
} 
```

编辑 ：

```
public  String getStreamName(OutputStream arg0)
{
 return "This is stream: " + ((arg0.equals(System.err)) ? "System.err" : "System.out");
} 
```

# php - 带有 IIS 配置的 PHP

> ID：13476378
> 
> 赞同：0
> 
> 时间：2012-11-20T15:23:08.363
> 
> 标签：php, iis

我有一个我试图通过 IIS 设置的 PHP 网站。我正在关注这个视频： [http ://www.iis.net/learn/application-frameworks/running-php-applications-on-iis/mix08-partying-with-php-on-microsoft-internet-information-services- 7岁及以上](http://www.iis.net/learn/application-frameworks/running-php-applications-on-iis/mix08-partying-with-php-on-microsoft-internet-information-services-7-and-above)

当这个人谈论在其中添加您自己的功能并指定一个可执行文件（php-cgi.exe）时，我被卡住了，因为我没有那个。

但是，处理程序映射中的功能列表已经包含 PHP53_via_FastCGI 和 PHP54_via_FastCGI。

该网站的详细信息是：

**网站名称：**我的网站

**物理路径：** C:\MyWebsite

**IP 地址：**全部未分配

**端口：** 80

**类型：** http

**主机名：** www.MyWebsite.com（这个网址不是我的。这只是我现在可以在主机名中放入的一些数据）

此外，当我单击“测试连接”时，它给了我错误：“无法验证对路径 C:\MyWebsite 的访问

**拜托拜托请帮忙。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T17:28:36.783

您需要授予`IISUSR`用户访问权限。在安全选项卡上单击`Edit`，`Add`然后键入 IISUSR 并单击确定。然后确保它具有所需的权限。如果这是一个本地主机，我现在可能会从完全控制开始，如果你打算用它做更多的事情，然后去阅读和执行。

# c# - >1 客户端无法连接到 C# 中的服务器

> ID：13476381
> 
> 赞同：1
> 
> 时间：2012-11-20T15:23:16.667
> 
> 标签：c#, .net, sockets, networking, network-programming

我正在用 C# 创建一个聊天客户端，以在 localhost 上进行演示。

以下是相关代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Net.Sockets;
using System.Net;
using System.IO;
using System.Threading;

namespace WindowsFormsApplication1
{
 public partial class Form1 : Form
 {
    static List<TcpListener> garabage_collection_preventor = new List<TcpListener>();
    static Dictionary<IPEndPoint, bool> address_dictionary = new Dictionary<IPEndPoint, bool>();
    static int port_increment = 9999;
    static int client_id = 0;

    void start_listening()
    {
        while (true)
        {
            TcpListener listen = new TcpListener(IPAddress.Any, port_increment);
            garabage_collection_preventor.Add(listen);
            listen.Start();
            TcpClient client = listen.AcceptTcpClient();
            IPEndPoint temp_end = ((IPEndPoint)listen.LocalEndpoint);
            address_dictionary.Add(temp_end, false);
            port_increment++;
            new Thread(new ParameterizedThreadStart(connection_stuff)).Start(client);
        }
    }

    void writer(object ob,int end_point)
    {
        StreamWriter write = ob as StreamWriter;
        while (true)
        {
            foreach (KeyValuePair<IPEndPoint, bool> value in address_dictionary)
            {
                IPEndPoint index = value.Key;
                int temp = value.Key.Port;
                if (temp == end_point)
                {
                    while (address_dictionary[index] == true)
                    {
                        write.WriteLine(msg_box.Text);
                    }
                }
            }
        }
    }

    void reader(StreamReader read)
    {
        while (true)
        {
            MessageBox.Show(read.ReadLine());
        }
    }

    void connection_stuff(object ob)
    {
        TcpClient client = ob as TcpClient;
        int writer_identification_endpoint = ((IPEndPoint)client.Client.LocalEndPoint).Port;

        NetworkStream stream = client.GetStream();
        StreamReader read = new StreamReader(stream);
        StreamWriter write = new StreamWriter(stream);

        ThreadStart port_passing = delegate { writer(write, writer_identification_endpoint); };
        Thread thread = new Thread(port_passing);

        reader(read);
        thread.Start();
    }

    public Form1()
    {
        InitializeComponent();
    }

    private void send_Click(object sender, EventArgs e)
    {
        int end_point = int.Parse(port.Text);
        foreach (KeyValuePair<IPEndPoint, bool> value in address_dictionary)
        {
            IPEndPoint index = value.Key;
            int temp = value.Key.Port;
            if (temp == end_point)
            {
                address_dictionary[index] = true;
            }
        }
    }

    private void listener_Click(object sender, EventArgs e)
    {
        new Thread(start_listening).Start();
        listener.Enabled = false;
    }
 }
} 
```

现在的问题是第一个客户端可以轻松地与程序连接并发送该程序可以轻松读取的消息。但是，每个后续客户端都无法连接。

我知道我不应该创建一个 TCPListener，但问题是我必须在 localhost 上演示程序，端口号是区分客户端的唯一真正方法。

所以请告诉我代码有什么问题，我已经把头撞在墙上好几个小时了。

编辑

当英语不是第一语言时会发生这种情况:) 此代码（目前不完整）将是一个聊天客户端。此代码的每个实例都将能够与此相同代码的其他实例连接以进行通信。任意数量的实例应该能够与任意数量的实例连接（例如，如果双击程序 5 次，现在将有 5 个实例准备好相互通信）。

现在的问题是每个实例都将具有相同的 IP 地址（因为它们都在同一台机器上运行）。问题是如何说实例 1 假设连接到实例 4，此处不能使用 ip，因为实例 2,3 和 5 也将具有相同的 IP 地址。所以我想做的是用IP地址和端口连接实例1和实例4，而不是像单个TCPListener那样只使用IP地址。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T15:26:47.727

尝试将这三行代码移到 start_listening 例程中的 while(true) 循环之外。

```
TcpListener listen = new TcpListener(IPAddress.Any, port_increment);
garabage_collection_preventor.Add(listen);
listen.Start(); 
```

您只需要一个侦听器，您可以从中接受许多不同的连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:27:15.820

试试这样：

```
void start_listening()
{
    TcpListener listen = new TcpListener(IPAddress.Any, port_increment);
    garabage_collection_preventor.Add(listen);
    listen.Start();
    while (true)
    {
        TcpClient client = listen.AcceptTcpClient();
        // etc
    }
} 
```

也就是说，一旦您创建了侦听器，它就会在循环中运行，接受来自客户端的传入连接。

编辑：您遇到的问题是因为您的模拟存在缺陷。在现实世界中，每个聊天服务器都运行在一个单一的 O/S 实例中，在一个已知的端口号上。因为您自己只有一个 O/S 实例，所以您不能在该实例上运行多个聊天服务器，它们都侦听同一个端口。但是这样的事情可能会起作用，即您需要两个循环，第一个循环来创建您的侦听器，第二个内部循环让每个侦听器接受多个客户端。注意：这些循环需要退出条件！

```
void start_listening()
{
    while (true)
    {
        TcpListener listen = new TcpListener(IPAddress.Any, port_increment);
        garabage_collection_preventor.Add(listen);
        listen.Start();
        while (true)
        {
            TcpClient client = listen.AcceptTcpClient();
            IPEndPoint temp_end = ((IPEndPoint)listen.LocalEndpoint);
            address_dictionary.Add(temp_end, false);
            new Thread(new ParameterizedThreadStart(connection_stuff)).Start(client);
        }
        port_increment++;
    }
} 
```

# python - PIL：如何使用 draw.text 在图像上绘制€？

> ID：13476383
> 
> 赞同：2
> 
> 时间：2012-11-20T15:23:24.817
> 
> 标签：python, python-imaging-library, python-unicode

我有一个表单值的标题（“cadeau check 50 €”），我想用`arial.ttf`. 我的文字是正确的，但对于欧元符号。我有 2 [] 到位。我不知道问题出在哪里。这是 PIL 中的编码问题，还是我的字体有问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:39:39.430

也许使用Unicode字符串？？像 u'cadeau check 50 €' ...现在，您的字体是否也有相应的字形？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:42:33.023

它可能是你的字体。在 GIMP 中尝试使用相同字体的 Euro 字符，以查看该字体是否支持该代码点。

还要检查你的代码，看看你是给 PIL 一个`unicode`字符串还是一个字节字符串。 [文档](http://effbot.org/imagingbook/imagefont.htm)说你应该这样做：

```
font = ImageFont.truetype("symbol.ttf", 16, encoding="symb")
draw.text((0, 0), unichr(0xF000 + 0xAA)) 
```

欧元符号是`unichr(0x20AC)`。请注意，`unichr`返回一个`unicode`字符串而不是`str`（字节）字符串。

# drupal - Drupal如何使用module_load_include将变量传递给文件？

> ID：13476395
> 
> 赞同：0
> 
> 时间：2012-11-20T15:23:52.043
> 
> 标签：drupal, variables, module

我的模块中有一个函数：

```
<?php
function foo($node) {
module_load_include('php', 'mymodule', 'path/to/filename');
}
?> 
```

在 filename.php 中，我希望能够访问 $node 变量或任何其他变量。

```
<?php
var_dump($node);
?> 
```

我怎样才能做到这一点。你怎么做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T00:58:02.177

不，没有办法使用`module_load_include()`. 来自[php.net](http://www.php.net/manual/en/function.include.php)：

> 如果包含出现在调用文件中的函数内部，则被调用文件中包含的所有代码的行为就好像它已在该函数中定义一样。因此，它将遵循该函数的变量范围。

由于包含发生在内部`module_load_include()`，因此包含文件将包含该函数范围内的所有变量，而不是您的函数。

您可以：

1.  在包含文件中添加一个函数，然后`foo()`在使用`module_load_include()`.
2.  使用常规 PHP 包含而不是`module_load_include()`：`include DRUPAL_ROOT . '/' . drupal_get_path('module', 'mymodule') . '/path/to/filename.php';`

另外，提一句建议：不将功能包装在函数中通常是个坏主意。使用函数时，您可以获得更好的变量作用域、更少的意外副作用和更好的代码可重用性。所以，我建议你选择第一个选项。

# php - 通过 CURL 发布到 Facebook 页面

> ID：13476396
> 
> 赞同：5
> 
> 时间：2012-11-20T15:23:53.507
> 
> 标签：php, facebook, post, curl

我已经设置了一个脚本来通过 PHP 将新闻发布到我的 facebook 页面

在过去的 2 年里一直有效

现在，在没有通知的情况下它停止了工作。

我正确地得到了`access_token`但第二部分返回了这个错误

```
{"error":{"message":"An unknown error has occurred.","type":"OAuthException","code":1}} 
```

这是代码

```
$url = "https://graph.facebook.com/oauth/access_token";
$postString = "client_id=KEY&client_secret=SECRET&type=client_cred";
$curl = curl_init();
curl_setopt($curl, CURLOPT_URL, $url);
curl_setopt($curl, CURLOPT_FAILONERROR, 1);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curl, CURLOPT_POST, 1);
curl_setopt($curl, CURLOPT_POSTFIELDS, $postString);
$access_token = str_replace( "access_token=", "", curl_exec($curl) );

$titolo = 'Test';
$link_pulito = 'test.html';
$testo_fb = 'Test';

$attachment =  array(
        'access_token' => $access_token,
        'message' => 'MESSAGE',
        'name' => 'test',
        'link' => 'http://www.test.com/workshop/',
        'description' => 'test test test',
        'picture'=>'http://www.test.com/77818763a19937bdd82b25f26cef2522.jpg'
        );

// set the target url
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,'https://graph.facebook.com/MYPAGE/feed');
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, $attachment);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, false);  //to suppress the curl output 

$result= curl_exec($ch);
curl_close ($ch); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:31:12.623

Facebook 改变了租赁代币的方式。[请使用来自https://github.com/facebook/facebook-php-sdk](https://github.com/facebook/facebook-php-sdk)的 facebook PHP SDK

# uisearchbar - 在位于 navigationItem 的 titleView 的 uisearch 栏右侧添加按钮

> ID：13476401
> 
> 赞同：3
> 
> 时间：2012-11-20T15:24:02.777
> 
> 标签：uisearchbar, rightbarbuttonitem

我有一个 UISearchBar `navigationItem's titleView`：

```
self.searchBar = ....
self.navigationItem.titleView = self.searchBar; 
```

我需要在 UISearchbar 右侧添加一个按钮，并在搜索栏获得焦点时隐藏。（即出现取消按钮时）。

如何完成这样的行为？ ![在此处输入图像描述](../Images/ef3bfef686886e02bdc2b7e9d23d194d.png)

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-31T13:45:50.017

您需要做的是创建另一个 UIView 并将 UISearchBar 和您的 UIButton“设置”放在它上面。然后直接添加新的复合 UIView 而不是 self.searchBar。

这是一个例子：

```
UISearchBar *_searchBar = [[UISearchBar alloc] initWithFrame:CGRectMake(0.0, 0.0, 230, SEARCHBAR_HEIGHT)];
    _searchBar.barStyle = UIBarStyleBlack;
    _searchBar.delegate = self;
UIButton *_button = [[UIButton alloc] initWithFrame:CGRectMake(0.0, 0.0, 100, BUTTON_HEIGHT)];
UIView *searchBarView = [[UIView alloc] initWithFrame:CGRectMake(0.0, 0.0, SEARCHBAR_WIDTH, SEARCHBAR_HEIGHT)];
    [searchBarView addSubview:_searchBar];
    [searchBarView addSubview:_button];
    self.navigationItem.titleView = searchBarView; 
```

# jsonp - Simile 3.0 中的 JSONP 转换函数

> ID：13476403
> 
> 赞同：2
> 
> 时间：2012-11-20T15:24:05.380
> 
> 标签：jsonp, simile

我正在使用 Simile 来显示一些数据。我有一个 JSONP 文件，在使用它之前我必须正确格式化。使用来自 Exhibit 网站的 JSONP 示例，我已经能够使用 2.2 版本的 Exhibit API 做到这一点：

```
<link rel="exhibit/data" type="application/jsonp"
    href="http://www.editgrid.com/user/ecmanaut/font-names.exhibit.jsonp"
    ex:jsonp-callback="editgridCallback" ex:converter="fontConverter" /> 
```

我想更新我的代码以展示 3.0，我正在使用以下代码：

```
<link rel="exhibit/data" type="application/jsonp"
  href="http://www.editgrid.com/user/ecmanaut/font-names.exhibit.jsonp"
  data-ex-jsonp-callback="cbfunc" data-ex-converter="fontConverter" /> 
```

但 fontConverter 函数不执行。我究竟做错了什么？

# javascript - 在聊天应用程序中发送本地语言消息时出现 UTF-8 问题？

> ID：13476406
> 
> 赞同：1
> 
> 时间：2012-11-20T15:24:13.987
> 
> 标签：javascript, ajax, jsp, servlets, utf-8

在我的聊天应用程序中，我需要以本地语言发送消息。

当尝试向代理发送消息并在客户端准确显示它时，它工作正常。

但在代理端显示 à®¨à¯à®à¯à®à®³à¯ à®à®ªà¯à®ªà®à®¿ à®à®°à¯à®à¯à®à®¿ à®±à¯à®°à¯à®à®³à¯ for நீங்கள் எப்படி இருக்கிறீர்கள்（英语 - 你好吗）...

在我使用的jsp页面中，

```
<%@ page contentType="text/html; charset=UTF-8"%> 
<html>
<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8; ">
<title>Initializer</title>
<link rel="stylesheet" type="text/css" href="css/login.css" />
<script type="text/javascript" src="javascript/login.js"></script>
</head>
<body>

<div><textarea id="textarea" rows="10" readonly></textarea></div>
<div>
<table>
    <tr>
        <td id="msg" class="fontStyle">message :</td>
        <td id="msgvalue"><input size="40" type="text" id="message"
            onkeydown="enterKey()" /></td>
        <td style="width: 5%;"></td>
        <td>
        <center><input type="button" id="button3"
            onclick="sendMessage()" value="Send" /></center>
        </td>
    </tr>
</table>
</div>
</div>
</body> 
```

在java脚本中，

```
function sendMessage(){
    clearInterval(timer);
    timer = setInterval(function(){pingAction();},5000);
    message = document.getElementById("message").value;
    document.getElementById("message").innerText = "";
    //document.getElementById("textarea").innerHTML = message;
    //alert("---------->"+sessionId+userId+secureKey+message);
    //alert("msg ---> : "+ message);
    try
    {
        xmlhttp.onreadystatechange=function()
        {
            //alert("Status : "+xmlhttp.status+"\nreadyState : "+xmlhttp.readyState);
            if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
                //alert("Message ----> : "+xmlhttp.responseText.toString());
                //alert("Decoded Message----> : "+decodeURIComponent(xmlhttp.responseText.toString()));
                //var checkMsg = decodeURIComponent(xmlhttp.responseText.toString());
                var checkMsg = xmlhttp.responseText.toString();
                if(checkMsg != "null" && checkMsg != null){
                    //document.getElementById("textarea").innerHTML +=  checkMsg;
                    if(textarea.value == "")
                        textarea.value = checkMsg;
                    else
                        textarea.value += "\n"+ checkMsg;
                }
            }
        };

        xmlhttp.open("POST","SendMessageAction?sessionId="+sessionId+"&userId="+userId+"&securekey="+secureKey+"&message="+encodeURIComponent(message)+"&sid="+Math.random(),true);
        xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
        xmlhttp.setRequestHeader("charset","UTF-8");        
        xmlhttp.send();

    }
    catch(err)
    {
        alert(err.description);
    }
} 
```

在我的 servlet 中，

```
 protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        PrintWriter out = response.getWriter();

        msg = request.getParameter("message");
        //System.out.println("msg -----> : "+msg);
        seckey = request.getParameter("securekey");
        uid = request.getParameter("userId");
        sessionId = request.getParameter("sessionId");
        //counter =Integer.parseInt(request.getParameter("counter"));
        counter = 1;
        protocol = ApplicationInfo.flexProtocol;

        message = new SendMessage();
        message.send(msg, seckey, uid, sessionId, counter, protocol);

        CustomerInfo customer = ApplicationInfo.customerDetails.get(uid);

        out.print(customer.getMessage());

    } 
```

提前致谢..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:29:29.973

> *但在代理端显示 à®¨à¯à®à¯à®à®³à¯ à®à®ªà¯à®ªà®à®¿ à®à®°à¯à®à¯à®à®¿ à®±à¯à®°à¯à®à®³à¯ for நீங்கள் எப்படி இருக்கிறீர்கள்（英语 - 你好吗）...*

当 ISO-8859-1 被错误地用于在通过 HTTP 线路传输给定字符之前将它们解码为字节时，或者当客户端被错误地指示使用 ISO-8859-1 对检索到的字符进行编码时，您将得到这个结果字节到字符。这是证据：

```
System.out.println(new String("நீங்கள் எப்படி இருக்கிறீர்கள்".getBytes("UTF-8"), "ISO-8859-1")); 
```

您基本上需要指示 servlet 容器使用 UTF-8 将给定的字符解码为字节**，并**指示客户端使用 UTF-8 将检索到的字节编码为字符。否则默认为 ISO-8859-1。这可以在 servlet 中按如下方式完成，*然后再将*任何内容写入响应：

```
response.setCharacterEncoding("UTF-8"); 
```

### 也可以看看：

*   [Unicode - 如何让字符正确？](http://balusc.blogspot.com/2009/05/unicode-how-to-get-characters-right.html)

* * *

**与具体问题无关**，您还有其他潜在的编码问题；您还没有指示您的 JSP 也使用 UTF-8 呈现响应。只设置`@page contentType`是不够的，还需要设置`@page pageEncoding`. 更重要的是，单独设置它已经足够了，因为 JSP 已经默认为`text/html`.

```
<%@ page pageEncoding="UTF-8"%> 
```

一旦你解决了这个问题，那么你应该在第一次调用*之前*`request.getParameter()`在 servlet 代码中添加另一行，以指示容器使用 UTF-8 对请求参数进行编码。

```
request.setCharacterEncoding("UTF-8"); 
```

另请注意，通过 HTTP 提供页面时**不**`<meta>`使用 HTML标记。完全被忽略了。它仅在最终用户将 HTML 输出保存到磁盘上的 HTML 文件，然后通过URI 从磁盘重新打开它时使用。**`file://`**

# oracle - 从 shell 脚本调用 sqlplus 时抑制 passwd

> ID：13476419
> 
> 赞同：2
> 
> 时间：2012-11-20T15:25:05.623
> 
> 标签：oracle, security, sqlplus

我的脚本`sqlplus`以标准格式调用：

```
sqlplus $USER/$PASSWD@$DBNAME 
```

显然，这不是很安全，因为`ps -ef`会显示整个命令，包括密码。

如何在没有手动提示的情况下调用 sqlplus 但仍隐藏密码？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T16:26:17.860

您需要的是一种不同的身份验证方法，例如 Oracle Wallet。

这是文档中的演练。

[http://docs.oracle.com/cd/E11882_01/network.112/e16543/authentication.htm#CBHGEBEI](http://docs.oracle.com/cd/E11882_01/network.112/e16543/authentication.htm#CBHGEBEI)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T17:33:53.280

**坏的：**

```
sqlplus $USER/$PASSWD@$SID<<!!

...
--some SQL
...

!! 
```

`ps -ef`显示连接字符串

**好的：**

```
sqlplus /nolog<<!!

connect $USER/$PASSWD@$SID;

...
--some SQL
...

!! 
```

`ps -ef`不**显示**连接字符串

# assembly - 如何使用整数寄存器在 MIPS 汇编中找到偶数

> ID：13476421
> 
> 赞同：1
> 
> 时间：2012-11-20T15:25:06.383
> 
> 标签：assembly, mips, division

如何在 MIPS 中找到输入是偶数还是奇数？我试图找出使用整数寄存器，但我的程序不工作。这是代码：

```
li $s1,2

div $s0,$s1

mfhi $t0

xor $t1,$t0,$0

beq $t1,0,Even

j Odd 
```

但是这个程序显示偶数奇数，因为偶数是因为结果是十进制的，比如 0.3 。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:48:28.053

您需要使用`and`您要检查的号码`0x01`。

这是您`and`在 mips 中的使用方式：`and $d, $s, $t`

如果目标寄存器中的值为 1，则为奇数，否则为偶数。

# jquery - jqgrid 在 loadComplete 事件中禁用 html 按钮

> ID：13476424
> 
> 赞同：0
> 
> 时间：2012-11-20T15:25:11.460
> 
> 标签：jquery, jqgrid, jquery-1.6

我的页面中有一个 jqgrid，在网格之外有一个如下按钮：

```
<input type="button" id="mybutton" value="click here" /> 
```

准备好文档后，我将使用以下代码禁用和隐藏按钮：

```
$(document).ready(function () {
    var btn = $('#mybutton');
    btn.prop('disabled', true);
    btn.hide();
    ...
    setupGrid();
}); 
```

`setupGrid()`是一个完成 jqgrid 设置的函数，并且在`loadComplete`事件中有这个代码

```
[...]
loadComplete: function() {
    //do some logic here and then...
    var btn = $('#mybutton');
    if ( mycustomlogic ) {
        btn.prop('disabled', false);
        btn.show();        
    }
} 
```

但不幸的是，此后该按钮不再启用。它在`mycustomlogic`评估为 true 时正确显示，但仍处于禁用状态。我也尝试过使用`btn.attr('disabled', 'disabled')`而`btn.removeAttr('disabled')`不是`.prop()`没有运气。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:45:06.390

使用 jQuery UI 按钮时，最好使用 api 的方法来启用/禁用按钮[http://api.jqueryui.com/button/](http://api.jqueryui.com/button/)

```
$(element).button('disable/enable') 
```

这样，除了 disabled 属性之外，它还会为您处理所有其他更改

# java - 如何将java函数指针传递给c++本机代码

> ID：13476429
> 
> 赞同：3
> 
> 时间：2012-11-20T15:25:21.950
> 
> 标签：java, c++, callback, java-native-interface, swig

我想从 java (android) 代码中调用原生 c++ 方法，并将 java 函数作为参数传递，这样我就可以将函数指针保存在 c++ 代码中，并从原生代码中激活它。

我选择使用匿名类在java中实现函数指针，并从java调用本机函数，如下所示：

```
interface FunctionPtrHelper {
bool function(String param); 
```

}

```
NativeFunc(param1,param2,new FunctionPtrHelper() {
public bool myFunction(String param) {
    //body of my function
}}); 
```

如何让 swig/jni 知道第三个参数（实际上是一个类）并将其转换为 c++ 中的函数指针（将包含'myFunction'）？
如果不可能，是否有另一种方法可以将函数指针从 java 传递给 c++？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T15:49:31.243

您可以编写一个 C++ 接口并将其作为“导演”类 SWIG。然后你可以用Java实现接口。在 Java 中实例化实现对象并将其传递给 C++ 方法，该方法采用指向接口的指针或引用，C++ 将能够回调您的 Java 类。例如：

```
// SWIGed C++
class IStringToBool
{
public:
    virtual bool call(std::string s) = 0;
}

class IStringToBoolUser
{
public:
    void setFunction(IStringToBool &function);
} 
```

接着：

```
// Java
public class MyFunction implements IStringToBool {
    public bool call(String s) {
        // do something
        return true;
    }
} 
```

文档：[使用导向器的跨语言多态性](http://www.swig.org/Doc1.3/Java.html#java_directors)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:36:43.490

使用 JNI，您可以将对象传递给 C++，然后您可以从 C++ 对象中获取函数指针。

# c++ - 结构引用和取消引用运算符

> ID：13476430
> 
> 赞同：10
> 
> 时间：2012-11-20T15:25:26.400
> 
> 标签：c++

假设我定义了这个结构：

```
struct Point {
   double x, y;
}; 
```

现在，假设我创建了一个这种类型的动态数组：

```
Point *P = new Point[10]; 
```

为什么我使用`P[k].x`and`P[k].y`而不是`P[k]->x`and`P[k]->y`来访问`k`-th 点的元素？

我认为您必须使用后者作为指针。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-20T15:28:31.777

实际上，您使用`p[index].x`and`p[index].y`访问`struct`数组内部的元素，因为在这种情况下，您使用指针来引用动态分配的数组。

`ptr->member`运算符只是 的简写`(*ptr).member`。为了使用它，您需要在左侧有一个指针：

```
Point *p = new Point;
p->x = 12.34;
p->y = 56.78; 
```

请注意，即使对于动态分配的数组，`->`运算符也可以工作：

```
Point *p = new Point[10];
p->x = 12.34;
p->y = 56.78; 
```

这相当于

```
p[0].x = 12.34;
p[0].y = 56.78; 
```

因为指向数组的指针等于指向其第一个元素的指针。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:27:32.547

因为您创建了一个动态分配的*数组*来保存`Point`对象，而不是`Point*`. 您通过以下方式访问每个成员`operator[]`：

```
p[0].x = 42; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T15:30:08.230

> 为什么我使用 P[k].x 和 P[k].y 而不是 P[k]->x 和 P[k]->y 来访问第 k 个点的元素？

因为`P[k]`不是指针，所以它是第 th 位置的对象，*它*`k`的类型是`Point`, not `Point*`。例如：

```
Point p = P[0]; // Copy 0th object
p.x; // Access member x
Point* pp = &(P[0]); // Get address of 0th element, equivalent to just P
pp->x; // Access member x 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T15:30:38.463

通常，箭头`->`运算符用于取消引用指针。但在这种情况下，P 是一个点数组。如果 P 是 Point 指针数组，那么您将使用后者

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-03-01T20:02:25.380

我相信 Q 与**C 间接相关**

在 C 中，数组名称**是类型**的变量（指向分配给 / 数组的第一个内存位置的指针）

指定索引（ 的方括号表示法`[n]`）会导致**间接**。

因此，

```
PointerA    behaves like   ArrayA
*PointerA   behaves like   ArrayA[] 
```

对于指针类型的变量，星号 (*) 是用于的*间接运算符*，

访问值（存储在**内存**位置中）

* * *

给定原始 Q 中的代码示例，假设 P 分配给内存地址位置`ADDR-01`

`P`不是指`ADDR-01`存储在其中的**内容** `ADDR-01`

`P[0]`指在第一个存在和第二个存在中存储**的内容** `ADDR-01``ADDR-16``8 bytes``P[0]``x``8 bytes``P[0]``y`

`P[0]`占用 ADDR-01 到 ADDR-16（16 个字节），因为 a`double`是 8 个字节，x 和 y 都定义为`double`

# iphone - 当手机处于待机状态时，您可以通过蓝牙进行通信吗？

> ID：13476432
> 
> 赞同：1
> 
> 时间：2012-11-20T15:25:28.117
> 
> 标签：iphone, bluetooth

是否可以创建一个 iphone-app，即使该应用程序在后台运行或 iphone 被锁定（=待机），它也可以与其他 iphone（安装了该应用程序）进行通信。有一个名为“蓝牙”的应用程序，它建立连接，但一旦应用程序关闭或iphone处于待机状态，它就会失去连接。希望我的解释不会太混乱

# r - 使用 XLConnect 创建的 excel 文件保存在哪里？

> ID：13476446
> 
> 赞同：0
> 
> 时间：2012-11-20T15:26:05.853
> 
> 标签：r

R对我来说很新。我有一个简单的问题。我使用 XLConnect 创建了一个 excel 文件并保存了它。

```
library(XLConnect)
data <- loadWorkbook("mydata.xls",create=TRUE)
saveWorkbook(data) 
```

但我不知道它到底保存在哪里。我在我的电脑上搜索并找不到它。请问有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:28:31.607

它们保存在您当前的工作目录中。为了找出哪个是您的工作目录，请使用`getwd()`

您还可以使用更改当前目录`setwd("desired directory")`

# python - 二维数组中索引对之间的 Numpy 总和

> ID：13476450
> 
> 赞同：2
> 
> 时间：2012-11-20T15:26:16.193
> 
> 标签：python, numpy, sum, multidimensional-array

我有一个 2-d numpy 数组 (MxN) 和另外两个 1-d 数组 (Mx1)，它们代表我想要总结的 2-d 数组的每一行的开始和结束索引。我正在寻找在大型数组中执行此操作的最有效方法（最好不必使用循环，这是我目前正在做的）。我想做的一个例子如下。

```
>>> random.seed(1234)
>>> a = random.rand(4,4)
>>> print a
[[ 0.19151945  0.62210877  0.43772774  0.78535858]
 [ 0.77997581  0.27259261  0.27646426  0.80187218]
 [ 0.95813935  0.87593263  0.35781727  0.50099513]
 [ 0.68346294  0.71270203  0.37025075  0.56119619]]
>>> b = array([1,0,2,1])
>>> c = array([3,2,4,4])
>>> d = empty(4)
>>> for i in xrange(4):
    d[i] = sum(a[i, b[i]:c[i]]) 

>>> print d
[ 1.05983651  1.05256841  0.8588124   1.64414897] 
```

我的问题类似于以下问题，但是，我认为那里提出的解决方案不会非常有效。[索引对之间子数组中值的 Numpy 总和](https://stackoverflow.com/questions/7471474/numpy-sum-of-values-in-subarrays-between-pairs-of-indices)在那个问题中，他们想要找到同一行的多个子集的总和，因此`cumsum()`可以使用。但是，我每行只会找到一个总和，所以我认为这不是计算总和的最有效方法。

编辑：对不起，我在我的代码中犯了一个错误。循环内的行先前已读取`d[i] = sum(a[b[i]:c[i]])`。我忘记了第一维的索引。每组开始和结束索引对应于二维数组中的一个新行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T16:59:11.147

你可以这样做：

```
from numpy import array, random, zeros
random.seed(1234)
a = random.rand(4,4)
b = array([1,0,2,1])
c = array([3,2,4,4])

lookup = zeros(len(a) + 1, a.dtype)
lookup[1:] = a.sum(1).cumsum()
d = lookup[c] - lookup[b]
print d 
```

如果您的 b/c 数组很大并且您要求和的窗口很大，这可能会有所帮助。因为您的窗口可能会重叠，例如 2:4 和 1:4 几乎相同，所以您实际上是在重复操作。通过将 cumsum 作为每个处理步骤，您可以减少重复操作的数量，并且可以节省时间。如果您的窗口很小并且 b/c 很小，这将无济于事，主要是因为您将对 a 矩阵中您不太关心的部分求和。希望有帮助。

# wpf - 在 WPF 中画一条连接两个用户控件的线

> ID：13476451
> 
> 赞同：1
> 
> 时间：2012-11-20T15:26:18.033
> 
> 标签：wpf

我想画一条连接屏幕上两个用户控件的线，然后在用户控件移动时移动。我创建了第三个名为 ConnectingLine 的用户控件，然后添加了两个指向用户控件的依赖项属性。

我编写了代码，以便 ConnectingLine 具有对源和接收器用户控件的引用，但现在我遇到了一些问题：

*   如何确定源和接收器用户控件的位置？我是 WPF 的新手，并且对缺少将返回 Point 对象的“位置”属性感到困惑。如果我可以得到两个 Point 对象，那么我可以将它们绑定到 ConnectingLine 内的 Line：

    `< Line X1="{Binding ElementName=Me, Path=Source.X}" Y1="{Binding ElementName=Me, Path=Source.Y}" X2="{Binding ElementName=Me, Path=Sink.X}" Y2="{Binding ElementName=Me, Path=Sink.Y}" x:Name="Connector" Stroke="Black" StrokeThickness="4" MouseDown="Connector_MouseDown" />`

*   如何让 ConnectingLine 与用户控件一起移动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T16:24:45.867

您需要使用[Canvas](http://wpftutorial.net/Canvas.html)。放置在画布上的每个 UI 元素都有附加属性，例如：Canvas.Left、Canvas.Top、Canvas.ZIndex。

# mkmapview - 您如何以编程方式定位 mkmapregion 以适合注释

> ID：13476453
> 
> 赞同：2
> 
> 时间：2012-11-20T15:26:25.323
> 
> 标签：mkmapview

我试图弄清楚如何以编程方式重新定位 MKMap 区域，以便我的注释（*在地图加载时自动选择*）都适合居中。

当前结果：[https ://www.evernote.com/shard/s46/sh/7c7d2ed8-203c-4878-af8c-83ff77ad7b21/ce7786acdf66b0782fc689b72d1b67e7](https://www.evernote.com/shard/s46/sh/7c7d2ed8-203c-4878-af8c-83ff77ad7b21/ce7786acdf66b0782fc689b72d1b67e7)

期望的结果：[https ://www.evernote.com/shard/s46/sh/21fb0eab-d5c4-4e6d-b05b-322e7dcce8ab/ab816f2a24f11b9c9e15bf55ac648f72](https://www.evernote.com/shard/s46/sh/21fb0eab-d5c4-4e6d-b05b-322e7dcce8ab/ab816f2a24f11b9c9e15bf55ac648f72)

我试图重新定位所有内容，`- (void)mapView:(MKMapView *)mapView didAddAnnotationViews:(NSArray *)views`但没有奏效。有更好的方法吗？

// 这里是 viewWillAppear 逻辑

```
[self.mapView removeAnnotations:self.mapView.annotations];

CLGeocoder *geocoder = [[CLGeocoder alloc] init];

CLGeocodeCompletionHandler completionHandler = ^(NSArray *placemarks, NSError *error) {

if (error) {

  EPBLog(@"error finding placemarks: %@", [error localizedDescription]);

} else {

  if (placemarks) {

    [placemarks enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {

      CLPlacemark *placemark = (CLPlacemark *)obj;

      if ([placemark.country isEqualToString:@"United States"]) {

        EPBAnnotation *annotation = [EPBAnnotation annotationWithCoordinate:placemark.location.coordinate];

        annotation.title    = self.locationObj.locationName;
        annotation.subtitle = self.locationObj.locationAddress;

        [self.mapView addAnnotation:annotation];

        self.mapView.selectedAnnotations = @[annotation];

        [self.mapView setCenterCoordinate:placemark.location.coordinate];

        /**
         * @todo
         * MOVE THIS OUTTA HERE
         */

        MKCoordinateRegion region = {{0.0f, 0.0f}, {0.0f, 0.0f}};

        region.center = placemark.location.coordinate;

        region.span.longitudeDelta = 0.003f;
        region.span.latitudeDelta  = 0.003f;

        [self.mapView setRegion:region animated:YES];
        [self.mapView regionThatFits:region];

        *stop = YES;
      }
    }];
  }
}
};

[geocoder geocodeAddressString:self.locationObj.locationAddress completionHandler:completionHandler]; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T15:19:03.013

以下方法将适合区域上的地图以显示所有注释。您可以在 Map 的 didAddAnnotations 方法中调用此方法。

```
- (void)zoomToFitMapAnnotations { 

    if ([mMapView.annotations count] == 0) return;
    int i = 0;
    MKMapPoint points[[mMapView.annotations count]];

    //build array of annotation points
    for (id<MKAnnotation> annotation in [mMapView annotations]){
         points[i++] = MKMapPointForCoordinate(annotation.coordinate);
    }

    MKPolygon *poly = [MKPolygon polygonWithPoints:points count:i];
    [mMapView setRegion:MKCoordinateRegionForMapRect([poly boundingMapRect]) animated:YES]; 
} 
```

但是，您应该查看是否还想在可见区域中添加用户位置注释。如果您不这样做，则在循环中检查当前注释是否为 MkUserLocation 并且不要将其点添加到点数组中。

```
if ([annotation isKindOfClass:[MKUserLocation class]]) {
    continue:
} 
```

现在，如果您希望注释位于中心并自动选择，请执行此操作

```
annotation.coordinate=mMapView.centerCoordinate;
[mMapView selectAnnotation:annotation animated:YES]; 
```

# node.js - 如何使用nodejs、expressjs渲染jade文件

> ID：13476458
> 
> 赞同：0
> 
> 时间：2012-11-20T15:26:36.080
> 
> 标签：node.js, pug, express

我使用 express 工具“express -s”创建了一个项目，默认情况下，它将玉指定为默认视图模板系统。

我还创建了一个文件 index.html 并使用 html2jade 工具对其进行了转换，问题是当我尝试使用此函数访问 index.jade 文件时：

```
exports.index = function(req, res){
     console.log('welcome admin');
     res.render('admin/app/index', {  }); 
} 
```

我收到了这个错误

```
SyntaxError: Unexpected token .
at Object.Function (unknown source) 
```

请有人可以解释什么是错的:)

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T17:32:22.317

```
That problem seems to be some formatting issue. you can use ejs instead. add the following to your app.js:
// map .renderFile to ".html" files
app.engine('html', require('ejs').renderFile);

// make ".html" the default
app.set('view engine', 'html');

//Then you can use below code to render html files and code in ejs:
res.render('index.html); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:55:49.827

可能是您没有向索引文件发送任何数据。我会尝试这样的事情..

```
 exports.index = function(req, res){
      console.log('welcome admin');
      res.render('index', { output: 'Welcome Admin' }); 
    } 
```

然后在你想要的 app.js 文件中

```
 app.get('/', routes.index); 
```

然后在你的 index.jade 文件中应该有输出键的标签。这样输出键的任何值都会打印在模板中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:12:59.413

该错误通常意味着您的模板中的 Jade 语法存在问题，因此我会仔细检查 - 终端的输出应该包含有关解析错误发生位置的更详细信息。

此外，如果您还没有配置它，我建议添加以下内容以打开 Connect 的错误处理程序：

```
app.configure('development', function(){
  app.use(express.errorHandler({ dumpExceptions: true, showStack: true })); 
}); 
```

# ios - 4" ios 设备上的 card.io UI 问题

> ID：13476462
> 
> 赞同：2
> 
> 时间：2012-11-20T15:26:46.197
> 
> 标签：ios, card.io

card.io 在 ios 3.5" 设备上运行良好，但在 4" 设备上，相机视图保持不变，其余空间被底部工具栏完全占据。有没有办法控制相机和工具栏的视图大小？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:05:38.603

来自 card.io 的 Josh 在这里。该问题已于 2012 年 12 月 4 日修复。请从 card.io/integrate 获取最新的 SDK

# java - 使用 For 循环处理许多变量，其中名称仅略有不同（不同的数字）

> ID：13476465
> 
> 赞同：2
> 
> 时间：2012-11-20T15:26:57.637
> 
> 标签：java, jtogglebutton

我有一个使用数百个 JToggleButtons 的程序。它们的名称仅在数字上略有不同（例如 jToggleButton1、jToggleButton2、jToggleButton3、...） 有没有一种方法可以在对多个按钮执行相同操作时使用 for 循环？例如，如果我想以编程方式更改几个按钮的状态，我可以遍历它们，每次都更改名称的结尾编号吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:31:20.070

您可以尝试将它们全部放在一个数组中或`ArrayList`使用`foreach`循环。

```
ArrayList<JToggleButton> toggleButtonArrayList = new ArrayList<JToggleButton>();
// ... insert your JToggleButtons to the ArrayList here...

for (JToggleButton myButton : toggleButtonArrayList) {
    myButton.changeSomething();
    // ...  do whatever you want here ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:29:56.597

通过将所有按钮放入一个数组或一个`ArrayList`.

# node.js - o带有 nodejs、jaydata 和 MongoDB 的数据服务器

> ID：13476466
> 
> 赞同：1
> 
> 时间：2012-11-20T15:27:02.327
> 
> 标签：node.js, jaydata

我正在使用 Ubuntu Server 12.04、节点 v0.8.14 和 jaydata v1.2.3 并尝试按照这篇文章安装节点 odata 服务器：http: [//jaydata.org/blog/install-your-own-odata-server- with-nodejs-and-mongodb](http://jaydata.org/blog/install-your-own-odata-server-with-nodejs-and-mongodb)

当指令 require('jaydata'); 在节点 REPL 上 执行它返回应该为空：[]

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T08:22:39.130

这是 Q Promise 库的输出，没有任何害处——尽管很烦人。:) 但是 Q 在其他方面非常酷，所以我们只接受它的礼貌 console.log 输出。

# templates - 提示保存 Normal.dot

> ID：13476468
> 
> 赞同：1
> 
> 时间：2012-11-20T15:27:08.387
> 
> 标签：templates, vba, ms-access, ms-word

在尝试手动关闭从我的 VBA 项目（实际上是使用 Access 2003 开发）创建的 Word 文档时，我遇到了一些问题。根据我使用的方法，它可能会提示保存 Normal.dot，然后告诉我它已经打开或正在使用。这有点烦人，因为我无法关闭 Microsoft Word。非常浪费时间。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T15:27:08.387

后来有些沮丧，我发现了一个小技巧来解决我的问题。我决定将其发布在那里，因为我无法在 Stack Overflow 上找到有关此问题的任何信息。

事情是这样的：

```
Set WordApplication = CreateObject("Word.Application")
WordApplication.NormalTemplate.Saved = True 
```

这里没什么特别的，但是第二行阻止了保存 Normal.dot 的提示。它实际上并**没有**将任何内容保存到模板中，它只是让 MS-Word 相信它已经被保存了。

确保在 MS Word 的首选项（*工具 > 首选项 > 保存 > 提示保存 Normal 模板*）中禁用提示保存 Normal.dot 的选项。禁用 so 将阻止正常使用情况下的提示。但是，当您使用 VBA（可能还有许多其他语言）从头开始创建文档时，可能会出现上述问题，这始终取决于您实现创建/打开文档的方法。

希望这条小线可以为您节省更多的研究时间。

# java - JLabel 图标未显示

> ID：13476469
> 
> 赞同：2
> 
> 时间：2012-11-20T15:27:07.897
> 
> 标签：java, icons, jlabel

我正在尝试在我的应用程序中显示图像...

```
 picture = new JLabel("No file selected");
    picture.setFont(picture.getFont().deriveFont(Font.ITALIC));
    picture.setHorizontalAlignment(JLabel.CENTER);

    scrollPane.setViewportView(picture);

    ImageIcon icon = new ImageIcon("map.jpg");
    picture.setIcon(icon);
    if (picture.getIcon() != null)                   // to see if the label picture has Icon
        picture.setText("HERE IS ICON"); 
```

当我运行该代码时，只显示“这里是图标”文本。对不起，如果这个问题听起来很愚蠢，但我真的不知道为什么不显示图像图标:(

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:38:53.563

您需要确保 map.jpg 作为文件存在。如果您想确定（仅用于测试目的），请尝试使用完整路径。按照您的方式，路径是相对于应用程序的启动目录的。

您可以使用以下命令仔细检查它是否存在：

```
System.out.println(new java.io.File("map.jpg").exists()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:43:58.187

你可以这样做：

```
ImageIcon icon = createImageIcon("map.jpg", "My ImageIcon");

if (icon != null) {
    JLabel picture = new JLabel("HERE IS ICON", icon, JLabel.CENTER);
    picture.setFont(picture.getFont().deriveFont(Font.ITALIC));
    picture.setHorizontalAlignment(JLabel.CENTER);

    scrollPane.setViewportView(picture);
} 
```

createImageIcon 方法（在前面的代码片段中使用）找到指定的文件并返回该文件的 ImageIcon，如果找不到该文件，则返回 null。这是一个典型的实现：

```
/** Returns an ImageIcon, or null if the path was invalid. */
protected ImageIcon createImageIcon(String path,
                                           String description) {
    java.net.URL imgURL = getClass().getResource(path);
    if (imgURL != null) {
        return new ImageIcon(imgURL, description);
    } else {
        System.err.println("Couldn't find file: " + path);
        return null;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:36:31.127

文件 map.jpg 可能与 java 文件不在同一个包（文件夹）中。核实。

# wpf - 在 WPF 中设置按钮的选定颜色和焦点

> ID：13476487
> 
> 赞同：2
> 
> 时间：2012-11-20T15:27:42.150
> 
> 标签：wpf, button, triggers

我有一个按钮，它有一个透明的背景和一个厚厚的白色边框。当按钮检测到鼠标输入时，我看到背景从设置的透明背景变为默认的焦点颜色，因此我只是将不透明度设置为 0.2，以便它显示一些反馈，它具有焦点。

现在这是我的困境。当我离开按钮的边界时，在将背景更改为原始透明之前，会有一个小动画从我的 .2 不透明度变为 1。我想知道如何用更平滑的动画替换它，以便在它变为透明之前看不到不透明的背景，或者只是有办法完全绕过动画并让它设置我的值。当按钮聚焦时，我看到类似的事情发生。它将使用默认背景颜色在 0.2 和 1.0 之间进行动画处理。任何想法将不胜感激。

```
<Button BorderBrush="White" BorderThickness="1" Width="45" Height="45" >
    <Button.Style>
        <Style TargetType="{x:Type Button}">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Opacity" Value="0.2" />
                </Trigger>
                <Trigger Property="IsMouseOver" Value="False">
                    <Setter Property="Background" Value="Transparent" />
                    <Setter Property="Opacity" Value="1.0" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </Button.Style>
</Button> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T15:40:03.857

这是一个仅 XAML 的解决方案，我认为这可以满足您的需求...

```
<Button BorderBrush="White" BorderThickness="1" Width="45" Height="45" Content="1234" >
        <Button.Style>
            <Style TargetType="{x:Type Button}">
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="False">
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="Opacity" Value="1.0" />
                    </Trigger>
                    <EventTrigger RoutedEvent="MouseLeave">
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0.2" To="1"></DoubleAnimation>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                    <EventTrigger RoutedEvent="MouseEnter">
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0.2" To="0.2"></DoubleAnimation>
                            </Storyboard>
                        </BeginStoryboard>
                    </EventTrigger>
                </Style.Triggers>
            </Style>
        </Button.Style>
    </Button> 
```

# android - Double.compare() 给出不一致的结果

> ID：13476490
> 
> 赞同：0
> 
> 时间：2012-11-20T15:27:49.660
> 
> 标签：android, double, listadapter

我有一个自定义 ListAdapter 用于显示一系列数字。在 getView() 方法中，我尝试根据两个数字之间的差异设置 TextView 的背景颜色：

```
if (Double.compare(homeDT, homeBF) > 0) {
homeDiff.setBackgroundResource(color.holo_blue_light);
} 
```

如果 homeBF > homeDT，这应该将 TextView 背景设置为浅蓝色，只有当 homeBF < homeDT 时，它才会将背景设置为浅蓝色。它似乎随机发生在 ListView 中的一两个子视图中。

任何想法为什么会发生这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-28T19:03:25.217

尝试这个

```
if (HomeDT > HomeBF){
// What you want to do if HomeDT is greater than HomeBF
}
else {
// What you want to do if HomeDT is not greater than HomeBF
} 
```

# php - 126: 出现表错误的密钥文件不正确

> ID：13476491
> 
> 赞同：2
> 
> 时间：2012-11-20T15:27:51.170
> 
> 标签：php, mysql, zen-cart

我收到以下错误：

> PHP致命错误：126：表'/dev/shm/#sql_c40_0.MYI'的密钥文件不正确；尝试修复它:: SELECT (SELECT p.products_price FROM (products p, products_description pd, products_to_categories p2c) ORDER BY p.products_price LIMIT 1) AS low, (SELECT p.products_price FROM (products p, products_description pd, products_to_categories p2c) ORDER BY p.products_price DESC LIMIT 1) 第 101 行 /hsphere/local/home/xxxxx/includes/classes/db/mysql/query_factory.php 中的最高值

我想也许上面的 SQL 是不正确的，但是在我的本地主机上开发时，我没有收到任何错误。我在这里和其他地方读到过，这可能是服务器上的 tmp 表大小问题，但主机说这不太可能是服务器错误，并想向我收费调查

如果这有什么不同的话，我正在使用 zencart 1.5。

有没有人知道我可以尝试做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:30:57.973

我建议按照它所说的去做。尝试对表进行[修复](http://dev.mysql.com/doc/refman/5.1/en/repair-table.html)，看看它是否不能解决问题::

```
REPAIR TABLE `products`;
REPAIR TABLE `products_description`;
REPAIR TABLE `products_to_categories`; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:30:20.663

您需要尝试修复您的表。您可以通过命令行、phpMyAdmin 或某种 GUI 连接到数据库来完成此操作。

我假设您的主机可能提供 phpMyAdmin 访问权限，因此请先尝试一下，因为检查您的表格相对简单。

# android - 全球安卓网络/WIFI位置

> ID：13476494
> 
> 赞同：-1
> 
> 时间：2012-11-20T15:28:11.483
> 
> 标签：android, location

所有国家/地区的 Android 网络/Wifi 位置都可用吗？

我对中国、大多数欧洲国家（德国、法国、英国、西班牙……）特别感兴趣，当然还有美国和加拿大。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:47:57.457

我认为该位置与哪个国家/地区无关，或者您是否对街景感兴趣？

我在中国使用我的应用程序没有问题（它使用地理位置和地图）当我想使用街景时遇到问题......

# jquery - jquery getScript 函数永远不会失败？

> ID：13476497
> 
> 赞同：3
> 
> 时间：2012-11-20T15:28:26.780
> 
> 标签：jquery, ajax, getscript

永远不会调用 jQuery getScript 失败函数。看到这个小提琴：http: [//jsfiddle.net/getsetbro/8xNMs/](http://jsfiddle.net/getsetbro/8xNMs/)

```
$.getScript("http://api.jquery.com/scripts/jquery.NO-SUCH-FILE.js").done(function() {
    console.log('yep');
}).fail(function() {
    console.log('fail function does not fire fine');
}); 
```

并且永远不会调用完整的功能：http: [//jsfiddle.net/getsetbro/ns6yQ/](http://jsfiddle.net/getsetbro/ns6yQ/)

```
$.ajax({
    url: url,
    type: 'get',
    crossDomain: true,
    dataType: 'script',
    async:false,
    cache:false,
    success: function(result) {
        console.log('SUCCESS');
    },
    error: function(result) {
        console.log('ERROR');
    },
    complete: function(result) {
        console.log('COMPLETE');
    }
}) 
```

哦，在 IE 中，当它应该失败时，它实际上会触发 SUCCESS 和 COMPLETE。=[

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T15:49:56.950

`.fail`不适用于跨域请求。

```
// Bind script tag hack transport
jQuery.ajaxTransport( "script", function(s) {

    // This transport only deals with cross domain requests
    if ( s.crossDomain ) {
    ...
    script = document.createElement( "script" ); 
```

脚本元素不会触发错误等。

但是对于同一个域是可以的。[http://jsfiddle.net/8xNMs/2/](http://jsfiddle.net/8xNMs/2/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-22T19:21:16.293

跨域 .fail 和 .always 与 jQuery 2.0 一起使用

```
$.getScript("http://api.jquery.com/scripts/NO-SUCH-FILE.js")
  .done(function() {
    console.log("done fired");
  }).fail(function() {
    console.log("fail fired");
  }).always(function() {
    console.log("always fired");
}); 
```

[http://jsfiddle.net/c2gyy/1/](http://jsfiddle.net/c2gyy/1/)

# ruby-on-rails - 将一个 Web 框架与另一个集成

> ID：13476503
> 
> 赞同：0
> 
> 时间：2012-11-20T15:28:56.423
> 
> 标签：ruby-on-rails, django, playframework, web-frameworks

我是 web 新手，也是 django（python web 框架）的新手。

我发现 python 更容易使用，但我的大多数同事更喜欢 java.(play framework)

是否可以将它们混合在 Web 应用程序中？
如果我只是转储 django 并开始使用 play 会更容易吗？

[Integrating Django and Rails](https://stackoverflow.com/questions/5137495/integrating-django-and-rails)中的某个人提到了“消息传递”，我想知道他的意思是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T16:11:32.140

跳入 Play（或 django）然后混合两种解决方案绝对是更好的主意。理性是一个，根本的。尽管可以将一个框架与其他框架混合，甚至可以混合多种语言的框架，但首先……您至少需要*非常*了解所有元素。然后，您可以搜索连接它们的最佳方法，并使用每个部分中最好的部分，以获得最佳结果。

由于事实上 Play 和 djangos 的方法非常相似，我认为没有充分的理由尝试将它们连接起来，特别是当团队中的大部分人使用一种解决方案时，最好的选择是遵循它们。

虽然，正如您所写 - 您也是 django 的新手，但该开关应该不是问题。你以后可以在 django 中编写类似的项目并比较生产力、性能等。也许你会说服你的同事尝试其他东西。

顺便说一句：两个应用程序之间的消息传递应该使用文档化的 API 来完成，只需将彼此视为“外来”服务。您可以共享数据库，但要确保框架不会重复功能。

换句话说 - 如果您要在 django 中编写 ContenteManager，请确保 Play 人员作为客户端连接到数据库，反之亦然，不要尝试在两种解决方案之间混合责任（即使使用相同的语言编写） /framework) 因为你会失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:57:15.307

I think messaging between two separate frameworks is possible by a number of ways :

*   intensive exchanging data-files (we're back to DOS days...)
*   sharing the same database (not described in books , but I've seen it )
*   communicating trough key-value store as a common data-source

All those solutions are the same if you put diesel fuel in your Ferrari .

Anyway , if you step on a framework you don't like , probably it has some kind of database , that you can use . My advice is to abandone the old and ugly framework , instead of learning to work with it - burden in your hands (soundgarden) .

# javascript - 如何存储 JavaScript 文件并在 .NET 中调用以使用 Ajax

> ID：13476505
> 
> 赞同：4
> 
> 时间：2012-11-20T15:29:06.260
> 
> 标签：javascript, .net, ajax, database, visual-studio-2010

我对编码很陌生，并且正在使用 VB 在 Visual Studio 2010 中开发一个项目。我想在我的解决方案中实现 Ajax，我认为我必须使用 .js 文件来执行此操作。我的问题是，如果我可以获得适当的 JavaScript 来构建文件，我应该如何将它们存储在我的解决方案中，以及如何实际调用我创建的类。我认为 .js 文件将与 .aspx 和 .aspx.vb 文件分开。任何援助将不胜感激。

我在网上搜索过，但找不到任何显示如何创建 .js 文件然后在相应页面中运行它的内容。只是为了让您了解我的计划，我有一个用户数据库，它通过 gridview 表在网站中表示。我想使用 Ajax 使我能够在表中拖放行以重新定位用户。重新定位后，数据库将需要更新以显示每个用户现在在表中的位置。我将为此使用一个名为“UserID”的字段，它是一个 int。

抱歉扯淡了。只是尽量简洁。多谢你们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T16:24:38.033

Aspx 基本上使用 html 语义（其中包含一些 cs 或 vb 内容），因此您可以`script`像在任何 html 文件中一样包含标签。例如，您可以拥有（对我来说，它在 C# 和我的母版页中）：

```
<%@ Master Language="C#" AutoEventWireup="true" CodeBehind="_Site.master.cs" Inherits="MyProject.SiteMaster" %>

<!doctype html>
<html lang="fr" class="no-js">
<head runat="server">
    ...
</head>
<body>
    ...
    <asp:ContentPlaceHolder ID="MainContent" runat="server" />
    ...
    <script src="~/Scripts/External/jquery-1.7.2.js" type="text/javascript"></script>
    <asp:ContentPlaceHolder ID="otherScripts" runat="server" />
</body>
</html> 
```

我的全局脚本位于名为“Scripts”的文件夹中（与我的项目文件在同一个项目中）。此外，我有一个占位符，以便添加一些特定于一页的小脚本。 ![在此处输入图像描述](../Images/3e585bcbd48407c47695100f7fd6bfbd.png)

# data-structures - 非二叉树高度

> ID：13476508
> 
> 赞同：3
> 
> 时间：2012-11-20T15:29:17.720
> 
> 标签：data-structures, tree

有没有办法找到不一定是二元的树的高度？二叉树的高度有很多算法，但它们都不适用于非二叉树。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-11-03T14:38:45.713

就在这里。递归方法可能类似于：

```
public class TreeNode<T>{
    private List<TreeNode<T>> children = new ArrayList<TreeNode<T>>();
    private T data = null;

    public TreeNode(T data){
        this.data = data;
    }       

    public List<TreeNode<T>> getChildren(){
        return children;
    }   

    public void setChild(TreeNode<T> children){
        this.children.add(children);
    }   

    public Integer getHeight(TreeNode<T> root){
        if(root == null) return 0;
        Integer h=0;

        for(TreeNode<T> n : root.getChildren()){
            h = Math.max(h, getHeight(n));
        }
        return h+1;
    }
} 
```

测试：

```
public static void main(String[] args){
    TreeNode<Integer> root = new TreeNode<Integer>(50);
    TreeNode<Integer> c1 = new TreeNode<Integer>(100);
    TreeNode<Integer> c2= new TreeNode<Integer>(10);
    TreeNode<Integer> c3 = new TreeNode<Integer>(-5);
    TreeNode<Integer> c4 = new TreeNode<Integer>(0);
    TreeNode<Integer> c5 = new TreeNode<Integer>(33);
    TreeNode<Integer> c6 = new TreeNode<Integer>(1);
    TreeNode<Integer> c7 = new TreeNode<Integer>(2);
    TreeNode<Integer> c8 = new TreeNode<Integer>(3);
    TreeNode<Integer> c9 = new TreeNode<Integer>(300);
    TreeNode<Integer> c10 = new TreeNode<Integer>(350);

    root.setChild(c1);
    root.setChild(c2);
    c2.setChild(c3);
    c3.setChild(c4);
    c3.setChild(c5);
    c3.setChild(c6);
    c3.setChild(c7);
    c3.setChild(c8);

    c1.setChild(c9);
    c1.setChild(c10);

    System.out.print("Pre order: \n");
    root.dfs(root, 0);
    System.out.print("\nPost order: \n");
    root.dfs(root, 1);
    System.out.print("\nBFS: \n");
    root.bfs(root);
    System.out.println();
    System.out.print("\nHeigth: \n");
    System.out.println(root.getHeight(root));
} 
```

结果：

```
Heigth: 
4 
```

编辑：返回 4，而不是前面所述的 3

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:33:16.057

任何树的定义都是一样的。一棵树的高度是它的任何一个孩子的高度（加一）。因此，如果您有三个孩子，请检查所有三个孩子并递归地取最大的 + 1 作为您的身高。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-07-03T18:30:12.907

有可能的。我们可以通过下面的方法来做。

```
package com.ds;

import java.util.Arrays;

public class TreeNode {

    private Integer data;
    private TreeNode[] children;

    public TreeNode() {
        super();
    }

    public TreeNode(Integer data) {
        super();
        this.data = data;
    }

    public void setChildren(TreeNode[] children) {
        this.children = children;
    }

    public Integer maxDepth(TreeNode treeNode) {
        Integer depth = 0;
        if (treeNode.children != null) {
            if (treeNode.children.length == 0) {
                return depth;
            } else {
                for (int i = 0; i < treeNode.children.length; i++) {
                    depth = Math.max(depth, this.maxDepth(treeNode.children[i]));
                }
                return depth + 1;
            }
        } else {
            return depth;
        }
    }

    @Override
    public String toString() {
        return "TreeNode [data=" + data + ", children=" + Arrays.toString(children) + "]";
    }

    public static void main(String[] args) {
        TreeNode t1 = new TreeNode(1);
        TreeNode t2 = new TreeNode(2);
        TreeNode t3 = new TreeNode(3);
        TreeNode t4 = new TreeNode(4);
        TreeNode t5 = new TreeNode(5);
        TreeNode t6 = new TreeNode(6);
        TreeNode t7 = new TreeNode(7);
        TreeNode t8 = new TreeNode(8);
        TreeNode t9 = new TreeNode(9);
        TreeNode t10 = new TreeNode(10);
        TreeNode t11 = new TreeNode(11);
        TreeNode t12 = new TreeNode(12);

        TreeNode t101 = new TreeNode(101);

        TreeNode[] childOf1 = { t2, t3 };
        TreeNode[] childOf2 = { t4, t5, t101 };
        TreeNode[] childOf3 = { t6, t7 };
        TreeNode[] childOf4 = { t8, t9 };
        TreeNode[] childOf6 = { t10 };
        TreeNode[] childOf10 = { t11, t12 };
        t1.setChildren(childOf1);
        t2.setChildren(childOf2);
        t3.setChildren(childOf3);
        t4.setChildren(childOf4);
        t6.setChildren(childOf6);
        t10.setChildren(childOf10);

        TreeNode obj = new TreeNode();
        Integer depth = obj.maxDepth(t1);
        System.out.println("Depth- " + depth);

    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T15:35:52.103

通常，您可以将大多数二叉树算法扩展到非二叉树。

例如，对于 2 棵树：

```
h(node) = max(h(left-child-of(node)) , h(right-child-of(node)))+1 
```

可以扩展到：

```
h(node) = max(h(for-all-child-of(node)) + 1 
```

# ruby - `String#sub` 方法在第一次执行时返回不正确的值

> ID：13476512
> 
> 赞同：1
> 
> 时间：2012-11-20T15:29:34.330
> 
> 标签：ruby

我正在尝试通过在子字符串的每个部分中插入一个连字符来将 UUID 变成一个正确符合的 UUID。

```
test = "CB13DBB20A9945CC86F11914C979C761"
#The first one will return '----' so essentially the $1 to $5 are returned as emptys
test.sub(/(\h{8})(\h{4})(\h{4})(\h{4})(\h{12})/, "#{$1}-#{$2}-#{$3}-#{$4}-#{$5}")
#Returns the ideal result of CB13DBB2-0A99-45CC-86F1-1914C979C761
test.sub(/(\h{8})(\h{4})(\h{4})(\h{4})(\h{12})/, "#{$1}-#{$2}-#{$3}-#{$4}-#{$5}") 
```

如您所见，该函数的第一次运行不起作用，但第二次运行。任何想法都会很棒。作为附加信息，

```
test.match(/(\h{8})(\h{4})(\h{4})(\h{4})(\h{12})/){|m| "#{$1}-#{$2}-#{$3}-#{$4}-#{$5}"} 
```

将在第一次工作。单引号和双引号不影响任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:56:41.377

While this can be accomplished using regex, I'd go with substrings:

```
require 'pp'

uuid = 'CB13DBB20A9945CC86F11914C979C761'
pp [uuid[0, 8], uuid[8, 4], uuid[12, 4], uuid[16, 4], uuid[20, 12]]
# => ["CB13DBB2", "0A99", "45CC", "86F1", "1914C979C761"]

puts [
  uuid[0, 8], uuid[8, 4], uuid[12, 4], uuid[16, 4], uuid[20, 12]
].join('-')
# => CB13DBB2-0A99-45CC-86F1-1914C979C761 
```

Because the use of offsets and lengths can be a bit of a chore when writing that code, here's an alternate using `unpack` with only the lengths:

```
lengths = [8, 4, 4, 4, 12]
uuid.unpack(lengths.map{ |l| "a#{ l }" }.join).join('-')
# => "CB13DBB2-0A99-45CC-86F1-1914C979C761" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T15:36:59.627

像这样引用模式匹配。

```
test.sub(/(\h{8})(\h{4})(\h{4})(\h{4})(\h{12})/, '\1-\2-\3-\4-\5') 
```

Ruby Docs 中解释了您看到这种行为的原因：

> 如果替换是一个字符串，它将被替换为匹配的文本。**它可能包含对模式捕获组的反向引用，格式为 \d，其中 d 是组号**，或 \k，其中 n 是组名。如果它是双引号字符串，则两个反向引用都必须以附加的反斜杠开头。**但是，在替换中，特殊匹配变量（例如 &$）不会引用当前匹配**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T15:37:06.097

在您的示例中， $1...$5 在替换**之前**在字符串中被替换。

如果您想在替换期间对它们进行评估，请改用块形式：

```
test.sub(/(\h{8})(\h{4})(\h{4})(\h{4})(\h{12})/) { "#{$1}-#{$2}-#{$3}-#{$4}-#{$5}" } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T17:13:54.183

FWIW，Ruby 有 SecureRandom 来提供 uuid

```
require 'securerandom'
p SecureRandom.uuid #"dd1f58f8-8c42-47e0-9c08-a8d5c191c9c3" 
```

将绳子切成碎片很容易完成`String#unpack`

```
test = "CB13DBB20A9945CC86F11914C979C761"
p test.unpack("A8A4A4A4A8").join('-') #"CB13DBB2-0A99-45CC-86F1-1914C979" 
```

# asp.net-mvc - JQGrid 的 MVC 版本：为编辑字段（下拉菜单、文本和复选框）设置默认值

> ID：13476513
> 
> 赞同：0
> 
> 时间：2012-11-20T15:29:38.187
> 
> 标签：asp.net-mvc, jqgrid

如何在 JQGrid 的编辑/搜索字段中设置默认值（使用 MVC 版本）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T15:15:31.333

**设置下拉菜单的默认值**

```
new JQGridColumn
{ 
   DataField = "myField",
   DataType = typeof(string),
   Editable = true,
   EditType = EditType.DropDown,
   EditFieldAttributes = new List<JQGridEditFieldAttribute>()
   {                                     
      new JQGridEditFieldAttribute(){ Name = "defaultValue", Value = "myDefaultValue"},
   },
}, 
```

**设置文本框的默认值**

```
new JQGridColumn
{ 
   DataField = "myField",
   DataType = typeof(string),
   Editable = true,
   EditFieldAttributes = new List<JQGridEditFieldAttribute>()
   {                                     
      new JQGridEditFieldAttribute(){ Name = "value", Value = "myDefaultValue"},
   },
}, 
```

**将复选框默认为选中**

```
new JQGridColumn
{ 
   DataField = "myField",
   DataType = typeof(bool),
   Editable = true,
   EditType.CheckBox,
   EditFieldAttributes = new List<JQGridEditFieldAttribute>()
   {                                     
     new JQGridEditFieldAttribute(){ Name = "checked", Value = "checked"},
   },
}, 
```

# java - 将字节 [] 放入队列 (ListBlockingQueue) 的最有效方法

> ID：13476514
> 
> 赞同：1
> 
> 时间：2012-11-20T15:29:39.917
> 
> 标签：java, queue, bytearray

我正在读取传递给我的字节数组（不是我的选择，但我必须以这种方式使用它）。我需要将数据获取到 LinkedBlockingQueue，并最终通过字节构建一个或多个（可能包含部分消息）xml 消息。所以我的问题是：

我应该为 LBQ 类型使用什么泛型？将 byte[] 转换为该泛型类型的最有效方法是什么？

这是我的示例代码：

```
parsebytes(byte[] bytes, int length)
{
    //assume that i am doing other checks on data

    if (length > 0)
    {
        myThread.putBytes(bytes, length);
    }
} 
```

在我的线程中：

```
putBytes(byte[] bytes, int length)
{
    for (int i = 0; i < length; i++)
    { 
        blockingQueue.put(bytes[i]);
    }
} 
```

我也不想一个字节一个字节地退出阻塞队列。我宁愿抓住队列中的所有内容并进行处理。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:35:34.087

没有`ListBlockingQueue`. 但是，由于 Java 数组是对象，因此 any`BlockingQueue<Object>`都会接受。`byte[]`

在没有其他设计考虑的情况下，最简单的选择可能是在数组到达时将它们放入队列中，然后让消费者将它们拼接在一起。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T17:27:12.853

考虑一下：

```
 BlockingQueue<byte[]> q = new LinkedBlockingQueue<>();
    q.put(new byte[] {1,2,3});
    byte[] bytes = q.take(); 
```

# wordpress - 从 youtube api 将数据保存到自定义字段

> ID：13476515
> 
> 赞同：0
> 
> 时间：2012-11-20T15:29:40.440
> 
> 标签：wordpress, api, youtube, custom-post-type, custom-fields

我为我的一位客户制作了一个 wordpress 视频部分。在后端，它是一种自定义帖子类型，用户可以在其中放置视频的 ID (http://www.youtube.com/watch?v= **kFHshctPO9E** )。

使用此**ID**，我嵌入视频并从 youtube api 获取每个视频的**持续时间**和**评分**。

现在每次加载视频（在概览模板中加载所有视频）时，它都必须联系 YouTube 以获取所有视频的持续时间（然后我将其解析为小时和分钟而不是秒）和评级。

我想以某种方式将这些值缓存或保存到自定义字段或其他地方。

有人知道吗？

预先感谢！

瑞克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:23:17.690

您可以`post_meta`在第一次保存帖子时使用保存此信息，然后从数据库中加载信息，而不是再次使用 youtube api。

我用伪代码给你举了一个例子：

```
add_action('save_post', 'my_function_to_save_posts_action');
function my_function_to_save_posts_action($post_id) {
  $the_post = get_post($post_id);
  if ($the_post->type == 'my_custom_post_type') {
    $youtube_data = my_function_to_retrieve_youtube_data();
    if (my_function_exists_post_meta($post_id)) {
      update_post_meta($post_id, 'my_video_duration', $youtube_data['duration']);
      update_post_meta($post_id, 'my_video_rating', $youtube_data['rating']);
    }
    else {
      add_post_meta($post_id, 'my_video_duration', $youtube_data['duration'], true);
      add_post_meta($post_id, 'my_video_rating', $youtube_data['rating'], true);
    }
  }
} 
```

当然，当您查询自定义帖子类型时，您必须检索 post_meta 信息并正确显示此信息。

# iphone - MapQuest ios API 无法请求路由

> ID：13476516
> 
> 赞同：2
> 
> 时间：2012-11-20T15:29:49.887
> 
> 标签：iphone, ios, map, mapquest

我正在尝试在 MQMapView 上绘制路线。`routeLoadFinished()`我在模拟器中的回叫中得到以下响应，

```
<?xml version="1.0" encoding="UTF-8"?><response>
<info><statusCode>400</statusCode>
<messages><message>No sessionId found in request. You must provide a sessionId when requesting a Route Shape.</message></messages><copyright>    <imageUrl>http://api.mqcdn.com/res/mqlogo.gif</imageUrl><imageAltText>© 2012 MapQuest, Inc.</imageAltText><text>© 2012 MapQuest, Inc.</text></copyright></info><route/></response> 
```

我不知道为什么它说我正在请求一个路线形状，而我只是想通过以下方式绘制路线`[self.route getRouteWithStartCoordinate:start endCoordinate:end];`

我正在使用许可数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T22:08:20.187

你还看到这个错误吗？通常，状态码 400 表示输入有问题，因此服务无法计算路线。您是否认为您指定的坐标之间可能没有路线（即，如果其中一个在海洋或水体中，或者远离道路网络等）？

免责声明：我在 MapQuest 工作。

# unit-testing - 我如何在 Symfony 中为此编写测试？

> ID：13476517
> 
> 赞同：0
> 
> 时间：2012-11-20T15:29:51.843
> 
> 标签：unit-testing, symfony, phpunit

我即将深入研究 PHP 世界中的测试，但我有一些问题。我有一个处理贷款申请的控制器。然后将大部分工作委托给 ProcessLoanApplication 类。

**应用控制器**

```
class ApplyController extends Controller
{
  public function indexAction(Request $request)
  {
    $form = $this->createForm(new LoanApplication());

    if($request->getMethod() == 'POST') {
        $form->bind($request);

        if($form->isValid()) {

            $session = $this->getRequest()->getSession();

            $loan_app_processor = new Tasks\ProcessLoanApplication($form, $session);
            $loan_app_processor->process();

            return $this->redirect($this->generateUrl('apply_thanks'));
        }
    } 
```

**任务\ProcessLoanApplication**

```
class ProcessLoanApplication
{
  private $_QuickBaseModels;
  private $_session;
  private $_app; // submitted form data
  private $_existingApp = false; // holds existing application in QB, if it exists

  public function __construct(Form $form, Session $session)
  {
    $this->_app = $form->getNormData();
    $this->_session = $session;

    // save the form data to a session
    $session->set('application', $this->_app);

    // create the quickbase table models objects
    $this->_QuickBaseModels['GenFnHome\Application'] = new GenFnHome\Application();
    $this->_QuickBaseModels['GenFnHome\SSN'] = new GenFnHome\SSN();
  }

  public function process()
  {
    $this->_existingApp = $this->_getExistingApplication();

    $app_status = $this->_existingApp[GenFnHome\SSN::LogInApplicationStatus];

    if(!$this->_existingApp || ($this->_existingApp && ($app_status !== 'PENDING' && $app_status !== 'OPEN' && $app_status !== 'EXPIRED')))
      return $this->_saveNewLoanApplication();

    if($app_status == 'EXPIRED') $this->_reOpenApplication();
  } 
```

这里发生了很多事情，所以我先概述一下：

*   用户对应用程序提出请求
*   申请表已验证
*   如果有效，处理贷款申请
*   检查用户是否已经有一个应用程序，如果是 - 做 X，如果不是 Y
*   该应用程序保存在一个“在线数据库”（QuickBase）中，我的应用程序通过 HTTP 上的 XML 与之通信（换句话说，没有真正的数据库）

我对社区的问题：

*   这里应该测试什么？我知道这在很大程度上取决于我，但也许社区可以推荐一些应该编写的基线测试。我应该测试控制器、处理器类和 QuickBase 类吗？
*   我的测试是否应该相互独立 - 意思是，我应该单独测试每个组件，而不是拥有一个庞大的 testApplication 来完成 indexAction 所做的所有事情并且只查找设置的预期会话变量？
*   最后，如何在没有实际请求的情况下测试 API 调用（请求/响应）（我使用的是 PHPUnit）。
*   还有什么我应该知道的吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:05:29.223

> 这里应该测试什么？我知道这在很大程度上取决于我，但也许社区可以推荐一些应该编写的基线测试。我应该测试控制器、处理器类和 QuickBase 类吗？

我建议测试您构建的每个类。如果您使用的是测试驱动开发，则测试声明您正在构建的内容，没有测试没有代码。

> 我的测试是否应该相互独立 - 意思是，我应该单独测试每个组件，而不是拥有一个庞大的 testApplication 来完成 indexAction 所做的所有事情并且只查找设置的预期会话变量？

每个单元测试都应该被隔离，并且应该只测试你正在测试的类。如果一个对象依赖于另一个对象，您应该使用 Mock 对象（使用 PHPunit 模拟库或其他第 3 方库作为 Mockery）。

> 最后，如何在没有实际请求的情况下测试 API 调用（请求/响应）（我使用的是 PHPUnit）。

您可以使用 Symfony`WebTestCase`提供的简单方法来模拟浏览器请求，在[文档](http://symfony.com/doc/current/book/testing.html#functional-tests)中了解更多信息。我们称之为功能测试。

这通常是单元测试之后的阶段。[在单元测试中，您将测试每个单独的类（对控制器](http://php-and-symfony.matthiasnoback.nl/2012/06/symfony2-testing-your-controllers/)进行单元测试是一种很好的做法），然后编写功能测试，它将所有内容和测试结合起来，如果它按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:33:58.213

对于控制器，您应该使用功能测试 (http://symfony.com/doc/2.0/book/testing.html#functional-tests)。使用它们，您可以模拟浏览器和用户的操作，例如提交表单和检查验证、数据库更改、http 状态代码等。

您不应该忘记对 ProcessLoanApplication 进行单元测试。

我真的不知道你为什么将表单对象传递给 ProcessLoanApplication 。你应该通过实体 - 它已经有 normdata 了。

# asp.net - 在后面的代码中获取隐藏字段

> ID：13476520
> 
> 赞同：1
> 
> 时间：2012-11-20T15:29:55.260
> 
> 标签：asp.net, vb.net

我一直在这里和其他地方寻找答案，但到目前为止还没有找到确切的方法。

我的 .aspx 页面中的隐藏字段有以下定义：

```
<asp:HiddenField ID="hfAddressChange" runat="server" /> 
```

我在客户端的 javascript 函数中设置了值：

```
function confirmAddressChange()
{
    if (typeof document.forms[0].hfAddressChange.valueOf ==="undefined")
    { 
     var res = (confirm('"Update Contact Addresses to Rich?"')==true);
     document.forms[0].hfAddressChange.valueOf = res;    
    }
} 
```

基本上我只想设置一次值。

现在我想检查后面代码中的值：

```
If hfAddressChange.Value <> String.Empty Then
    Dim x As String = "Do Something here"

End If 
```

但是，即使我已经验证该值是在 js 函数中设置的，但当它到达我后面的代码时，它始终是一个空字符串。

有人看到我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:31:24.183

```
document.forms[0].hfAddressChange.valueOf = res; 
```

属性是`value`，不是`valueOf`。（也不会`undefined`更早；只需检查一下`!document.forms[0].hfAddressChange.value`。）

# php - 在模板时间分配 smarty 变量

> ID：13476523
> 
> 赞同：0
> 
> 时间：2012-11-20T15:30:07.577
> 
> 标签：php, templates, smarty, assign

在一个 smarty 模板中，我调用一个用户定义的函数，作为这样的修饰符：

```
{"myArray"|assignArray} 
```

我在 php 中的用户定义函数如下所示：

```
function smarty_modifier_assignArray($str)
{
  global $smarty;
  if ($str=="myArray") 
  {
    // it is not constant in real, but comes from a mysql query
    $all = array( array("foo","joe")), array("green", "blue"));
    $smarty-&gt;assign($str,$all);
  }
  return null;
} 
```

我的目的是从 mysql 加载“myArray”很昂贵，如果我的模板不需要该数组，我不想加载它。我的模板如下：

```
{"myArray"|assignArray}
{foreach from=$myArray item=r}
  {$r[0]}
{/foreach} 
```

问题是，在 foreach 中我看不到 $myArray （或者它是空的）。我在 smarty 论坛（v3.x，[http](http://www.smarty.net/forums/viewtopic.php?p=77671) ://www.smarty.net/forums/viewtopic.php?p=77671 ）中读到，为了优化速度，变量被复制到模板空间，所以在启动模板后，不能为其分配新变量。可悲的是，这似乎是真的。我想使用模板 {assign ...} 我仍然可以这样做，但是我无法在该 {assign ...} 中生成动态多级数组：(

我应该怎么办？有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-12-08T06:51:07.690

您可以在渲染时分配 smarty 多级数组，使用 {assign} 标签。

句法，

```
{assign var=foo value=[1,[9,8],3]}   // can be nested 
```

# prolog - SWI Prolog 不会终止

> ID：13476524
> 
> 赞同：5
> 
> 时间：2012-11-20T15:30:10.937
> 
> 标签：prolog, clpfd, prolog-dif, failure-slice

```
:- use_module(library(clpfd)).

fact(treated=A) :- A in 0..1.
fact(numYears=B) :- B in 0..sup.
fact(numDrugs=C) :- C in 0..sup.
fact(treated2=D) :- D in 0..1.
fact(cParam=E) :- E in 0..4.

is_differentfact(X,X) :- false.
is_differentfact(Element=_,OtherElement=_) :-
    dif(Element,OtherElement).

is_fakt([]).
is_fakt([X|Xs]) :-
    fact(X),
    maplist(is_differentfact(X),Xs),
    is_fakt(Xs). 
```

为什么会`?- is_fakt(X)`返回~~结果~~答案列表，但在获得多个~~结果~~答案后它会挂起。我不知道为什么 Prolog 不能返回 X 的所有可能值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T18:19:11.793

你问：

> 为什么`?- is_fakt(L)`...但是在许多~~结果~~ **答案**之后它挂起。

你说**一个数字**。这个数字是 62 次按下`SPACE`才能到达循环的那一刻。不是很长吗？而且你的程序很小。您将如何有机会在更大的计划中做同样的事情？别担心，有帮助。但是你需要从不同的角度来看待这个程序。

在 Prolog 中理解一个具体查询的非常精确的执行几乎是不可能的。你有两种不同类型的控制流交错加上奇怪的数据结构，它们不需要存在，但稍后“进来”；有时。所有这一切都打开了一整套*可能的*执行痕迹，这些痕迹非常详细，以至于你的大脑会溢出——更糟糕的是：你的大脑仍然会*假装*你了解一切，但实际上你不了解。并且错误在您的程序中有大量的聚会时间。这些虫子会在未来的某个时间点咬人，但只是在虫子咬人的基础上。这可能非常令人沮丧。毕竟，程序很小，应该很容易理解（按照命令式语言的标准）。但是，对于其他语言中非常复杂的问题，Prolog 程序往往非常紧凑。

尝试使用示踪剂逐步了解我的意思。你会看到各种各样的事情发生。而且大部分都是无关紧要的。

幸运的是，有一些方法可以理解 Prolog，但在这里你必须依赖语言本身的良好属性。对于未终止的本地化原因，最好是开始考虑[故障切片](/questions/tagged/failure-slice "显示标记为“故障切片”的问题")。通过将目标添加到程序中，您可以从程序中获得失败片段**`false`**。如果生成的程序仍然没有终止，那么我们有一个原因为什么我们的原始程序也没有终止。

想一想：我们不是试图理解你的程序，而是做一些人类更擅长的事情：做出有根据的猜测。这个猜测可能会出错，但我们可以很容易地检查它。一开始你会很不擅长猜测。很快你就会发现你可以系统地做很多事情。现在变得无关紧要的所有代码都被~~删除了~~。

```
:- 使用模块（库（clpfd））。

事实（处理= A）：- 0..1 中的 A。     
fact(numYears=B) :- B in 0..sup, **false**。
fact(numDrugs=C) :- C in 0..sup, **false**。
事实（处理 2=D）：- D 在 0..1，**假**。
fact(cParam=E) :- E in 0..4, **false**。

is_differentfact(X,X) :- 假。
is_differentfact（元素=_，其他元素=_）：-
    差异（元素，其他元素）。

is_fakt([])。
is_fakt([X|Xs]) :-
    事实（X），
    地图列表（is_differentfact（X），Xs），
    is_fakt(Xs)。

```

我们得到了什么？我们可以更快地缩小问题范围：

```
?- is_fakt(Xs)。
Xs = [] ;
Xs = [治疗=_G180099]，
_G180099 在 0..1 ;
**循环**

```

在继续之前，我试着理解你的意思`is_fakt/1`。您可能的意思是：所有事实都以他们的名字命名，并确保没有重复。现在我们只有名为 的事实`treated`，所以我们只能产生一个长度为 1 的列表。然后它循环。

你说：

> 我不知道为什么 Prolog 不能返回所有可能的值`X`。

要挑剔，那是不对的。Prolog 确实列举了所有可能的值`X`。但后来它并没有终止。

（（要考虑的一些注意事项：您真的想以这种方式获得该列表吗？您将获得所有排列！使用长度为*n*的列表，您将获得*n！*不同的答案。对于*n = 10*，即 3628800。这是，你想要什么？可能不是。））

但让我们首先坚持确定不终止的确切原因。

为了更好地确定原因，让我们“关闭”所有答案。所以我们`is_fakt(L),`**`false`**改为查询：

```
:- 使用模块（库（clpfd））。

事实（处理= A）：- 0..1 中的 A。     
fact(numYears=B) :- B in 0..sup, **false**。
fact(numDrugs=C) :- C in 0..sup, **false**。
事实（处理 2=D）：- D 在 0..1，**假**。
fact(cParam=E) :- E in 0..4, **false**。

is_differentfact(X,X) :- 假。
is_differentfact（元素=_，其他元素=_）：-
    差异（元素，其他元素）。

is_fakt([]) :-**假**。
is_fakt([X|Xs]) :-
    事实（X），
    maplist(is_differentfact(X),Xs), false ,
     is_fakt(Xs)。

```

那是最小的故障片。因此，它`maplist/2`首先不会终止。您的想法是确保`X`具有与 中的事实名称不同的事实名称`Xs`。但如果`Xs`不受约束，那将永远不会终止。让我们尝试一下：

```
?- maplist(is_differentfact(X),Xs)。
Xs = [] ;
X = (_G496=_G497),
Xs = [_G508=_G509],
差异（_G496，_G508）；
X = (_G552=_G553),
Xs = [_G564=_G565, _G570=_G571],
差异（_G552，_G570），
差异（_G552，_G564）；
X = (_G608=_G609),
Xs = [_G620=_G621, _G626=_G627, _G632=_G633],
差异（_G608，_G632），
差异（_G608，_G626），
差异（_G608，_G620）；
X = (_G664=_G665),
Xs = [_G676=_G677, _G682=_G683, _G688=_G689, _G694=_G695],
差异（_G664，_G694），
差异（_G664，_G688），
差异（_G664，_G682），
差异（_G664，_G676）；
X = (_G720=_G721),
Xs = [_G732=_G733, _G738=_G739, _G744=_G745, _G750=_G751, _G756=_G757],
差异（_G720，_G756），
差异（_G720，_G750），
差异（_G720，_G744），
差异（_G720，_G738），
差异（_G720，_G732）...

```

看起来不太好......但我们可以做得更好：

```
?- maplist(is_differentfact(X),Xs), false。
**循环**

```

所以它循环。这就是不终止的原因。为了解决这个问题，我们必须在故障切片的剩余可见部分做一些事情......

有关更多信息，请查找标记[为故障切片的其他解释](/questions/tagged/failure-slice "显示标记为“故障切片”的问题")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T10:19:30.107

根据错误的评论编辑版本。

```
:- use_module(library(clpfd)).
:- use_module(library(lists)).

fact(treated-X) :- X in 0..1.
fact(numYears-X) :- X in 0..sup.
fact(numDrugs-X) :- X in 0..sup.
fact(treated2-X) :- X in 0..1.
fact(cParam-X) :- X in 0..4.

facts(Facts) :-
findall(X,fact(X),Facts).

is_fact2(_, []).
is_fact2(Facts, [X|Xs]) :-
    member(X,Facts),
    select(X,Facts,Remaining),
    is_fact2(Remaining,Xs).

is_fakt(X) :-
    facts(Facts),
    is_fact2(Facts,X),
    keysort(X,X). 
```

现在终止。

# mysql - sql错误码表

> ID：13476527
> 
> 赞同：0
> 
> 时间：2012-11-20T15:30:21.943
> 
> 标签：mysql, 2-3-4-tree

```
CREATE TABLE IF NOT EXISTS `users` ( 
`id` int(11) NOT NULL auto_increment, 
`username` varchar(32) NOT NULL, 
`password` varchar(32) NOT NULL, 
`online` int(20) NOT NULL default '0′, 
`email` varchar(100) NOT NULL, 
`active` int(1) NOT NULL default '0′, 
`rtime` int(20) NOT NULL default '0′, 
PRIMARY KEY (`id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
```

这是原始的 phpmyadmin 错误消息，当我输入上面显示的代码 sql 创建表时：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds 
to your MySQL server version for the right syntax to use near 
'`password` varchar (32) NULL, `On-line` int NOT (20) NULL default '0 ', NON ' 
at line 4 
```

我想了解这段代码应该如何正确编写以及有什么问题！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:56:21.077

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:54:16.663

# c# - 停止线程、ManualResetEvent、volatile boolean 或 cancelToken

> ID：13476528
> 
> 赞同：5
> 
> 时间：2012-11-20T15:30:27.170
> 
> 标签：c#, multithreading, cancellation, cancellation-token

我在 Windows 服务中有一个线程 (STAThread)，它执行大量工作。当 Windows 服务重新启动时，我想优雅地停止这个线程。

我知道几种方法

*   一个不稳定的布尔值
*   手动复位事件
*   取消令牌

据我发现 Thread.Abort 是不行的......

最佳做法是什么？这项工作是在另一个类中执行的，而不是启动线程的类，因此有必要在构造函数中引入 cancelToken 参数，或者例如具有一个 volatile 变量。但我就是不知道什么是最聪明的。

**更新**
只是为了澄清一点，我已经总结了一个非常简单的例子来说明我在说什么。如前所述，这是在 Windows 服务中完成的。现在我在想一个在循环中检查的 volatile boolean 或 cancelToken.... 我不能等待循环完成，如下所述，它可能需要几分钟，使服务器的系统管理员相信当他们需要重新启动服务时，服务出现问题......接口被调用，因此需要进行小清理。

```
Class Scheduler{
  private Thread apartmentThread;
  private Worker worker;

  void Scheduling(){
    worker = new Worker();
    apartmentThread = new Thread(Run);
    apartmentThread.SetApartmentState(ApartmentState.STA);
    apartmentThread.Start();    
  }

  private void Run() {
    while (!token.IsCancellationRequested) {
      Thread.Sleep(pollInterval * MillisecondsToSeconds);
      if (!token.IsCancellationRequested) {
        worker.DoWork();
      }
    }
  }
}

Class Worker{
  //This will take several minutes....
  public void DoWork(){
    for(int i = 0; i < 50000; i++){
      //Do some work including communication with a COM interface
      //Communication with COM interface doesn't take long
    }
  }
} 
```

**更新**
刚刚检查了性能，使用在代码中“检查”isCancelled 状态的cancellationToken 比在ManualResetEventSlim 上使用waitOne 快得多。一些快速计算者，如果在 cancelToken 上在 for 循环中迭代 100.000.000 次，我大约花费了我。500 毫秒，其中 WaitOne 的成本约为。3 秒。因此在这种情况下的性能使用cancellationToken 会更快。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T16:16:06.397

使用 WaitHandle，最好是 ManualResetEvent。您最好的选择是让循环中的任何内容完成。这是实现目标的最安全方法。

```
ManualResetEvent _stopSignal = new ManualResetEvent(false); // Your "stopper"
ManualResetEvent _exitedSignal = new ManualResetEvent(false);

void DoProcessing() {
    try {
        while (!_stopSignal.WaitOne(0)) {
            DoSomething();
        }
    }
    finally {
        _exitedSignal.Set();
    }
}

void DoSomething() {
    //Some work goes here
}

public void Terminate() {
    _stopSignal.Set();
    _exitedSignal.WaitOne();
} 
```

然后使用它：

```
Thread thread = new Thread(() => { thing.DoProcessing(); });
thread.Start();

//Some time later...
thing.Terminate(); 
```

如果您的“DoSomething”实现中有一个运行时间特别长的进程，您可能希望异步调用它，并为其提供状态信息。不过，这可能会变得非常复杂——最好等到你的过程完成，然后退出，如果你能的话。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-20T15:40:42.783

我倾向于使用 bool 标志、锁定对象和 Terminate() 方法，例如：

```
object locker = new object();
bool do_term = false;

Thread thread = new Thread(ThreadStart(ThreadProc));
thread.Start();

void ThreadProc()
{
    while (true) {
        lock (locker) {
            if (do_term) break;
        }

        ... do work...
    }
}

void Terminate()
{
    lock (locker) {
        do_term = true;
    }
} 
```

除了 Terminate() 之外，所有其他字段和方法都是“工人”类私有的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-20T16:08:06.773

您尚未发布足够多的实施，但`CancellationToken`如果您可以使用，我强烈建议您使用。从可维护性的角度来看，它很容易使用和理解。如果您决定拥有多个工作线程，您也可以设置协作取消。

如果您发现自己处于此线程可能会长时间阻塞的情况，最好设置您的体系结构，以免发生这种情况。当您告诉它们停止时，您不应该启动不会很好玩的线程。如果你问他们时他们没有停止，唯一真正的方法是拆除进程并让操作系统杀死他们。

[Eric Lippert 在这里](https://stackoverflow.com/a/2118236/360944)对一个有点相关的问题发表了精彩的回答。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-20T16:03:36.783

有两种情况下您可能会找到您的线程：

*   加工。
*   阻塞。

如果您的线程正在处理某些事情，您必须等待您的线程完成处理才能安全退出。如果它是工作循环的一部分，那么您可以使用布尔标志来终止循环。

在您的线程阻塞的情况下，您需要唤醒您的线程并再次处理它。一个线程可能会阻塞`ManualResetEvent`一个数据库调用、一个套接字调用或任何其他你可以阻塞的东西。为了唤醒它，您必须调用`Thread.Interrupt()`将引发`ThreadInterruptedException`.

它可能看起来像这样：

```
private object sync = new object():
private bool running = false;

private void Run()
{
    running = true;
    while(true)
    {
        try
        {
            lock(sync)
            {
                if(!running)
                {
                    break;
                }
            }

            BlockingFunction();
        }
        catch(ThreadInterruptedException)
        {
            break;
        }
    }
}

public void Stop()
{
    lock(sync)
    {
        running = false;
    }
} 
```

以下是如何使用它：

```
MyRunner r = new MyRunner();
Thread t = new Thread(()=>
{
    r.Run();
});

t.IsBackground = true;
t.Start();

// To stop the thread
r.Stop();

// Interrupt the thread if it's in a blocking state
t.Interrupt();

// Wait for the thread to exit
t.Join(); 
```

# sql - 返回对应聚合结果的表ID

> ID：13476531
> 
> 赞同：1
> 
> 时间：2012-11-20T15:30:39.570
> 
> 标签：sql, postgresql, aggregate, min

我有一张这样的桌子：

```
+-----+------------+-------+--------+
| ID  |  val1      | val2  | val3   |
+-----+------------+-------+--------+
| 100 |  110       | 25    | 530    |
| 101 |  56        | 75    | 591    |
| 102 |  65        | 93    | 827    |
| 103 |  75        | 70    | 805    |
+-----+------------+-------+--------+ 
```

我想在 postgreSQL 中编写一个查询，只要*(val3-val1)*最小，就会为我返回*ID*。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:33:02.000

你可以使用`order by`：

```
select  id
from    YourTable
order by
        val3 - val1
limit   1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T22:49:57.753

如果我正确理解你想要什么，这可以用 SQL 来表达，非常接近你用文字写出来的方式。

[http://sqlfiddle.com/#!12/61046/1](http://sqlfiddle.com/#!12/61046/1)

```
SELECT id
FROM table1
WHERE (val1 - val3) = (SELECT min(val1-val3) FROM Table1); 
```

如果多行具有相同的`val1 - val3`. 如果有可能，您将需要添加其他标准。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T15:32:48.570

你可以这样做：

```
SELECT  t1.ID
FROM Tablename t1
INNER JOIN
(
   SELECT Id, MIN(val3 - val1) Minval
   FROM Tablename
   GROUP BY Id
) t2 ON t1.ID = t2.Id AND t2.minval = (t1.val3 - t1.val1) 
```

# javascript - 如何使用 Javascript onchange 从 mysql 中提取行

> ID：13476532
> 
> 赞同：0
> 
> 时间：2012-11-20T15:30:40.873
> 
> 标签：javascript, mysql, rows, onchange, pull

我有一个网站，收集来自各个国家和州的注册会员的信息。在我的搜索表单上，我有 3 个字段；`Country`,`State`和`Sex`.

我在搜索中列出了世界上所有的国家（作为下拉列表），但状态字段为空。我想要的是，一旦访问者选择了一个国家，我只想将注册会员在我的数据库中的那个国家的状态拉到状态字段中，而不是那个国家的所有状态。

例如，来自美国的 3 名成员分别来自纽约、新泽西和乔治亚州。在国家下拉列表中选择美国时，只有这 3 个州应出现在州下方，而不是美国的 50 个州。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:36:30.517

您可以使用 php 或您正在使用的任何服务器端语言从数据库中提取注册成员的状态。然后，您可以使用 AJAX 以 xml 或 JSON 对象的形式获取状态。您可以使用对象的成员来填充下拉列表。

获取注册用户状态的示例 sql 查询字符串：`Select state From user_details WHERE country = 'USA'`. 这应该返回状态（可能在数组中）；

将由 AJAX 调用检索的示例 PHP 代码：`$reply = {states: [NJ, NY, AZ]}`. 解析上述回复的示例 JS 代码：`var reply = JSON.parse(serverReply); var states = reply.states;` . 我希望这有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:39:04.030

你需要做一个脚本，例如，用 php（或任何服务器端语言）来执行查询，它看起来像：

```
$countryId = $_POST['countryId'];

$sql = "SELECT fields FROM states WHERE countryId = $countryId";
$result = .... etc; 
```

**例如**返回一个 json 对象到主页。

您应该从主页向 php 页面发出 Ajax 请求，根据您选择的选项获取返回的 json 对象并填充下一个字段。

您至少可以像我一样看一下 jQuery 框架，发现比使用原始 javascript 更容易。

# javascript - 为什么我的 Google Chrome 扩展程序不会显示我的弹出窗口

> ID：13476536
> 
> 赞同：0
> 
> 时间：2012-11-20T15:30:52.130
> 
> 标签：javascript, json, google-chrome

你能给我一些帮助吗？

我已经创建了我的第一个 chrome 扩展，我希望我能弹出一个弹出窗口。但它不起作用

清单.json：

```
{
"name" :"CHROMICHROME",
"version" : "1.0.0",
"manifest_version" : 2,
"description" :"Testitest",
"browser_action" :
    {
        "default_icon" : "icon.png",
        "popup" :"bonjour.html"
    }
} 
```

bonjour.html

```
<script>
alert("Bonjour!") ;
</script> 
```

扩展程序可以加载到 chrome 上，但是当我点击它的图标时，什么也没有发生！..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T00:15:55.410

如果您使用[清单版本 2](http://developer.chrome.com/extensions/tut_migration_to_manifest_v2.html)，则不能直接使用标签。出于安全原因，您必须改为使用来加载脚本文件。例子：

bonjour.html

```
<script src="bonjour.js"></script> 
```

bonjour.js

```
alert("Bonjour!"); 
```

尽管我看不出您为什么要在浏览器操作中发出警报；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-15T22:16:05.587

尝试使用`"default_popup" :"bonjour.html"`

# javascript - JavaScript 垃圾会收集这个吗？

> ID：13476540
> 
> 赞同：5
> 
> 时间：2012-11-20T15:30:58.320
> 
> 标签：javascript, garbage-collection

每隔一段时间，我就会发现自己在按照以下方式做一些事情

```
var img = new Image();
img.src = 'php/getpic.php?z=' + imid + '&th=0';
img.onload = function(){drawImages(img,contexts,sizes)}; 
```

解释

1.  创建一个 HTML 图像元素。
2.  分配它的 src 属性
3.  分配其 onload 事件
4.  将一个或多个 Canvas 上下文传递给事件处理程序
5.  将加载的图像绘制到画布上

我不清楚的是 - JavaScript 垃圾收集器会处理丢弃 img 元素的任务，还是我需要自己做，否则会面临缓慢的内存泄漏？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T15:32:24.277

它会在**IE 6 和 7 （以及非常旧的 FF 版本）中***泄漏*，因为它会在 JavaScript 和 DOM 之间创建循环引用。IE 6 和 7 不能垃圾收集在两个世界之间具有循环引用的任何对象，因为它们使用单​​独的垃圾收集器。

 **现代浏览器可以在不泄漏的情况下处理这个问题。

为防止它在 IE 6 和 7 中泄漏，请在完成以下操作后执行此操作`img`：

```
img.onload = null; 
```

如果您只关心现代浏览器，则不必担心。（我很高兴 IE 6 和 7 的市场份额终于低到足以表明这一点！）

* * *

## 更新

您分配给的函数`onload`创建一个闭包。该闭包包含对`img`. `img`只要该闭包存在于 JScript 的内存中（JScript 是 JavaScript 的 IE 实现的名称），就不能从 DOM 的内存中进行垃圾回收。同样，只要`img`存在于 DOM 的内存中，闭包就不能从 JScript 的内存中进行垃圾回收，因为`img.onload`它引用了您的函数。这是一个循环引用。换句话说，仅仅因为`drawImages`执行一次并不意味着它不会再次执行（JScript 引擎不知道`onload`只触发一次——那是 DOM 的域），所以 JScript 必须保持闭包处于活动状态。

您展示的模式是已知会在 IE 6 和 7 中造成内存泄漏的经典模式。它包括 (1) 一个 DOM 节点，(2) 该 DOM 节点上创建闭包的事件处理程序，以及 (3 ) 对闭包内该 DOM 节点的引用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-20T16:06:54.010

如果您担心内存泄漏，我建议您使用[Google Chrome 的 Heap Debugger](https://developers.google.com/chrome-developer-tools/docs/heap-profiling)。在您的情况下，我做了一个简单的测试，可以验证您的特定模式是否会造成内存泄漏。

```
<html>
    <head>
        <script>
            function test() {
                var img = new Image();
                img.src = 'php/getpic.php?z=1&th=0';
                img.onload = function(){ drawImages(img,contexts,sizes); };
            }
        </script>
    </head>
    <body>
        <input type="button" onclick="test()" value="test" />
    </body>
</html> 
```

我建议您在测试前按一次“测试”以避免结果中出现不必要的噪音（代码第一次运行时内存中会添加一些东西，这并不意味着存在内存泄漏）。

拍摄堆快照，按测试并拍摄堆快照。如果您想要实际结果，您必须将视图从 "Summary" 切换到["Comparaison"](https://developers.google.com/chrome-developer-tools/docs/heap-profiling#views_comparison)。如果视图是空的（在我测试的情况下），这意味着在该步骤中没有添加任何内容，这意味着它没有内存泄漏。在另一种情况下，它将向您显示快照之间添加或删除的内容。

注意：对于有自身问题的旧浏览器，此方法无法帮助您解决内存泄漏问题，但这是在大多数现代浏览器中找到会导致内存泄漏的事情的好步骤。**

# javascript - 我可以突出显示选定的列表元素吗？

> ID：13476541
> 
> 赞同：0
> 
> 时间：2012-11-20T15:31:02.160
> 
> 标签：javascript, jquery, css

将jQuery用于列表项单击事件，是否可以以某种方式突出显示所选项目？

```
$('#listReports').delegate('li', 'click', function () {
  var filename = $(this).text();
  // Any highlight methods or css tricks that I can add/remove for each click
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:33:14.860

您可以使用`addClass`和`removeClass`方法：

```
.selected {
   property: value
} 
```

```
$('#listReports').delegate('li', 'click', function () {
     //var filename = $(this).text();
     $('.selected').removeClass('selected');
     $(this).addClass('selected');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:33:29.593

```
$('#listReports').delegate('li', 'click', function () {

     var filename = $(this).text();
     $('.highlight').removeClass('highlight');
     $(this).toggleClass('highlight');
});

.highlight{
  background-color: #ddd;  /*or whatever color */
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:37:07.457

可能最适合您使用 .on() 方法，如 jQuery 网站所述

> 从 jQuery 1.7 开始，.delegate() 已被 .on() 方法取代

试试吧

```
$("#listReports").on( "click", "li", function( ) {
    var filename = $(this).text();
    $(this).addClass("selected").siblings().removeClass("selected")
} 
```

显然，然后`.selected`适当地设置类的样式

# c# - 如何捕获引发异常的页面的url

> ID：13476542
> 
> 赞同：1
> 
> 时间：2012-11-20T15:31:02.490
> 
> 标签：c#, asp.net-mvc

获取当前 URL 很简单

```
HttpContext.Current.Request.Url.ToString(); 
```

事实上，这是对[这个非常相似的问题的公认答案。](https://stackoverflow.com/questions/344440/how-to-get-which-page-threw-an-exception-to-application-error-in-aspx) 但是，我已经实现了应用程序范围的错误处理，并且有一个 ErrorController 可以在出现未处理的异常时生成电子邮件，这些电子邮件会发送回给我们。如果我在错误控制器中实现上面的代码片段，我得到的 URL 类似于

```
http://.../Error/GenericError?aspxerrorpath=/Controller/ErrorProneAction 
```

如何获取实际引发错误的页面的 url？也就是说，更像是

```
http://.../Controller/ErrorProneAction 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T17:28:02.507

根据您的评论-`void Application_OnError(object sender, EventArgs e)`您的 global.asax 中是否有类似的功能？如果是这样，那么您应该能够获得您正在寻找的信息。

```
protected void Application_OnError(object sender, EventArgs e)
{
    var app = (MvcApplication)sender;
    var context = app.Context;
    string path = context.Request.PathWithQueryString;
    ... 
```

给你类似的东西`/controllerOrRoute/action?query=val`。或者，您可以使用 RawUrl 或 Url 属性来获得基本相同的内容。我刚刚启动了我的应用程序以查看它生成的内容，看起来这就是您所要求的。

编辑：我应该注意我为 MVC3 测试了上述内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:34:25.103

请参阅此博客文章：

[http://blog.gauffin.org/2011/11/how-to-handle-errors-in-asp-net-mvc/](http://blog.gauffin.org/2011/11/how-to-handle-errors-in-asp-net-mvc/)

如果您将参数传递给您的`ActionResult`，这将采用`aspxerrorpath`查询字符串值的值。

```
public ActionResult NotFound(string url)
{
  var originalUri = url ?? Request.QueryString["aspxerrorpath"] ?? Request.Url.OriginalString;
} 
```

# python - 从 distutils install 命令中排除某些文件

> ID：13476546
> 
> 赞同：1
> 
> 时间：2012-11-20T15:31:14.377
> 
> 标签：python, installation, distutils

我想确保在用户键入时不会安装 Python 包中的某些文件：

```
python setup.py install 
```

`__pycache__`具体来说，在某些情况下，目录中可能会有目录`build`，如果用户然后运行`install`，`__pycache__`目录也会被安装，这会导致问题。解决方案可能是使用以下命令创建自定义安装命令：

```
class CustomInstall(DistutilsInstall):
    # code here 
```

但是在浏览 distutils 代码后，我不知道如何编辑已安装的文件列表。有没有人有什么建议？我可以`CustomInstall`删除所有我不想要的文件，但我想避免这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T04:39:20.477

必须编写自定义命令听起来需要做很多工作。替代想法：

*   为 Python 3.2（创建 __pycache__）和 2.7（打包它们，除非我误读您的帖子）使用不同的构建目录；

*   使用 setup.py clean build 从以前的构建中删除工件；

*   （疯狂尝试）使用 MANIFEST.in 排除模式。

如果这些不起作用，您能否详细说明导致创建并安装 __pycache__ 目录的命令序列？

# drupal - 这个drupal 6模块我做错了什么？

> ID：13476553
> 
> 赞同：0
> 
> 时间：2012-11-20T15:31:30.807
> 
> 标签：drupal, drupal-6, drupal-modules

每当我单击提交按钮时，表单都会被清除，并且不会执行任何内部代码，尽管我正在设置 drupal 消息或尝试发送电子邮件。我已经用“user@domain.com”替换了我的电子邮件等。

```
<?php

/**
 *  implementation of help hook
 */
function module_test_help($path, $arg) {
  switch ($path) {    // if the path is equaled to case, return value.
    case 'admin/help#module_test':
      $output .= '<p>' . t('Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam quis dictum turpis.') . '</p>';
      return $output;
     break;
  }
}

/**
 *  implementation of menu hook
 */
/** function module_test_menu() {
*   $items = array();
*   $items['lorem-ipsum'] = array (  
*   'title' => t('Lorem-ipsum'),  
*   'page callback' => '_module_test_page',
*   'access arguments' => array('administer my module'),  
*   'type' => MENU_CALLBACK, 
*   );
*   return $items; 
*   }
**/

function module_test_menu() {
  $items = array();
  $items['validation_form'] = array (  
  'title' => t('Validation Form'),  
  'page callback' => 'drupal_get_form',
  'page arguments' => array('module_test_form'),
  'access arguments' => array('administer my module'),  
  'type' => MENU_NORMAL_ITEM, 
   );
   return $items; 
}

 /**
*   implementing permissions
**/ 
function module_test_perm() {
  return array('Administer my module');
}  

/**
*   implementing forms with validations
**/ 
function module_test_form() {
  $form['name'] = array(
   '#title' => t('Name'),   
   '#type' => 'textfield',
   '#size' => '25',
   '#required' => FALSE,
   );

   $form['email'] = array(
   '#title' => t('E-mail'),
   '#type' => 'textfield',
   '#size' => '25',   
   '#required' => FALSE,
   '#element_validate' => array('module_test_validate'),
   );

   $form['message'] = array(
   '#title' => t('Message'),
   '#type' => 'textarea',
   '#required' => FALSE,
   );

   $form['checkbox'] = array(
   '#title' => t('Send yourself a copy'),
   '#type' => 'checkbox', 
   '#required' => FALSE,
   '#return_value' => 1,
   '#default_value' => 0
   );

   $form['submit'] = array(
   '#type' => 'submit',
   '#value' => t('Submit')
   );
   return $form;//
}

/**
*   Validation of e-mail form
**/
function module_test_validate($form, &$form_state) {
  $valid_email = $form_state['values']['email'];
    if(!valid_email_address($valid_email)) {
     form_set_error('email', 'The email address "' . $valid_email . '" is invalid.');
    }
}

/**
* implementing mail function
*/
function module_test_mail($key, &$message, $params) {

  $headers = array(
    'MIME-Version' => '1.0',
    'Content-Type' => 'text/html; charset=UTF-8; format=flowed',
    'Content-Transfer-Encoding' => '8Bit',
    'X-Mailer' => 'Drupal'
  );

  foreach ($headers as $key => $value) {
    $message['headers'][$key] = $value;
  }

  $message['subject'] = $params['subject'];
  $message['body'] = $params['body'];
}

/**
* Create the form submit function
*/
function module_test_submit($form, &$form_state) {

    //main server details
    ini_set("SMTP", "mail.host");
    //smtp port number
    ini_set("smtp_port", "25");
    //send from address
    ini_set("sendmail_from","user@domain.com");

    $admin_email = 'user@domain.com';
    $valid_name = $form_state['values']['name'];
    $valid_email = $form_state['values']['email'];
    $valid_message = $form_state['values']['message'];
    $valid_check = $form_state['values']['checkbox'];

    $from = 'user@domain.com';
    $body = 'Name: ' . $valid_name;
    $body = 'Email: ' . $valid_email;
    $body = 'Message: ' . $valid_message;

    $params = array(
    'body' => $body,
    'subject' => 'ModuleTest Form Confirmation ',
    );

    if($valid_check == 1){
        if (drupal_mail('module_test_form', 'some_mail_key', $valid_email, language_default(), $params, $from, $send = TRUE))
        {
            form_set_error('checkbox', 'A copy has been sent to ' .$valid_email .'');
        }
    }   
    if (drupal_mail('module_test_form', 'some_mail_key', $valid_email, language_default(), $params, $from, $send = TRUE))
    {
        drupal_set_message('An email has been sent to ' . $admin_email);      
    } else {
        drupal_set_message('There was an error sending your email');
    }

}
/**
* Return the form.
*/
return drupal_get_form('module_test_form');
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T01:42:15.980

您的代码有几个问题，但是您的提交处理程序不起作用的原因仅仅是因为您有错误的命名约定。

让我们澄清所有这些：

您已将电子邮件字段设置为不需要，然后假设电子邮件地址字段在验证功能中可用。将其更正为：

```
$form['email'] = array(
   '#title' => t('E-mail'),
   '#type' => 'textfield',
   '#size' => '25',   
   '#required' => TRUE,
   ); 
```

我们现在允许标准验证功能来验证电子邮件地址。

您的验证功能在清理用户输入方面存在问题。将其更正为：

```
function module_test_validate($form, &$form_state) {
  $valid_email = $form_state['values']['email'];
    if(!valid_email_address($valid_email)) {
     form_set_error('email', t('The email address "@email" is invalid.', array('@email' => $valid_email)));
    }
} 
```

您不能在打开的 .module 文件中返回任何内容。删除这个：

```
/**
* Return the form.
*/
return drupal_get_form('module_test_form'); 
```

像这样重命名验证函数：

```
function module_test_form_validate($form, &$form_state) { 
```

并且您的提交功能有几个问题。主要是它的名字。

```
/**
* Create the form submit function
*/
function module_test_form_submit($form, &$form_state) {

    //main server details
    ini_set("SMTP", "mail.host");
    //smtp port number
    ini_set("smtp_port", "25");
    //send from address
    ini_set("sendmail_from","user@domain.com");

    $admin_email = 'user@domain.com';
    $valid_name = $form_state['values']['name'];
    $valid_email = $form_state['values']['email'];
    $valid_message = $form_state['values']['message'];
    $valid_check = $form_state['values']['checkbox'];

    $from = 'user@domain.com';
    $body[] = 'Name: ' . check_plain($valid_name);
    $body[] = 'Email: ' . $valid_email;
    $body[] = 'Message: ' . nl2br(check_plain($valid_message));
    $body = implode('<br />', $body);
    $params = array(
    'body' => $body,
    'subject' => 'ModuleTest Form Confirmation ',
    );

    if($valid_check == 1){
        if (drupal_mail('module_test', 'some_mail_key', $valid_email, language_default(), $params, $from))
        {
            drupal_set_message(t('A copy has been sent to @email', array('@email' => $valid_email)));
        }
    }   
    if (drupal_mail('module_test', 'some_mail_key', $valid_email, language_default(), $params, $from))
    {
        drupal_set_message(t('An email has been sent to @email', array('@email' => $admin_email)));      
    } else {
        drupal_set_message('There was an error sending your email', 'error');
    }

} 
```

好的，下面是您可以复制粘贴的模块文件的完整代码。它有效（我测试过）。尝试找出必要的更改。尽可能/合适地使用 t() 函数。

```
<?php

/**
 *  implementation of help hook
 */
function module_test_help($path, $arg) {
  switch ($path) {    // if the path is equaled to case, return value.
    case 'admin/help#module_test':
      $output .= '<p>' . t('Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam quis dictum turpis.') . '</p>';
      return $output;
     break;
  }
}

/**
 *  implementation of menu hook
 */
/** function module_test_menu() {
*   $items = array();
*   $items['lorem-ipsum'] = array (  
*   'title' => t('Lorem-ipsum'),  
*   'page callback' => '_module_test_page',
*   'access arguments' => array('administer my module'),  
*   'type' => MENU_CALLBACK, 
*   );
*   return $items; 
*   }
**/

function module_test_menu() {
  $items = array();
  $items['validation_form'] = array (  
  'title' => t('Validation Form'),  
  'page callback' => 'drupal_get_form',
  'page arguments' => array('module_test_form'),
  'access arguments' => array('administer my module'),  
  'type' => MENU_NORMAL_ITEM, 
   );
   return $items; 
}

 /**
*   implementing permissions
**/ 
function module_test_perm() {
  return array('Administer my module');
}  

/**
*   implementing forms with validations
**/ 
function module_test_form() {
  $form['name'] = array(
   '#title' => t('Name'),   
   '#type' => 'textfield',
   '#size' => '25',
   '#required' => FALSE,
   );

   $form['email'] = array(
   '#title' => t('E-mail'),
   '#type' => 'textfield',
   '#size' => '25',   
   '#required' => TRUE,
   );

   $form['message'] = array(
   '#title' => t('Message'),
   '#type' => 'textarea',
   '#required' => FALSE,
   );

   $form['checkbox'] = array(
   '#title' => t('Send yourself a copy'),
   '#type' => 'checkbox', 
   '#required' => FALSE,
   '#return_value' => 1,
   '#default_value' => 0
   );

   $form['submit'] = array(
   '#type' => 'submit',
   '#value' => t('Submit')
   );
   return $form;//
}

/**
*   Validation of e-mail form
**/
function module_test_form_validate($form, &$form_state) {
  $valid_email = $form_state['values']['email'];
    if(!valid_email_address($valid_email)) {
     form_set_error('email', 'The email address "' . $valid_email . '" is invalid.');
    }
}

/**
* implementing mail function
*/
function module_test_mail($key, &$message, $params) {
  // these do not work in Drupal 7 //
  $headers = array(
    'MIME-Version' => '1.0',
    'Content-Type' => 'text/html; charset=UTF-8; format=flowed',
    'Content-Transfer-Encoding' => '8Bit',
    'X-Mailer' => 'Drupal'
  );

  foreach ($headers as $key => $value) {
    $message['headers'][$key] = $value;
  }

  $message['subject'] = $params['subject'];
  $message['body'] = $params['body'];
}

/**
* Create the form submit function
*/
function module_test_form_submit($form, &$form_state) {

    //main server details
    ini_set("SMTP", "mail.host");
    //smtp port number
    ini_set("smtp_port", "25");
    //send from address
    ini_set("sendmail_from","user@domain.com");

    $admin_email = 'user@domain.com';
    $valid_name = $form_state['values']['name'];
    $valid_email = $form_state['values']['email'];
    $valid_message = $form_state['values']['message'];
    $valid_check = $form_state['values']['checkbox'];

    $from = 'user@domain.com';
    $body[] = 'Name: ' . $valid_name;
    $body[] = 'Email: ' . $valid_email;
    $body[] = 'Message: ' . nl2br($valid_message);
    $body = implode('<br />', $body);
    $params = array(
    'body' => $body,
    'subject' => 'ModuleTest Form Confirmation ',
    );

    if($valid_check == 1){
        if (drupal_mail('module_test', 'some_mail_key', $valid_email, language_default(), $params, $from))
        {
            drupal_set_message(t('A copy has been sent to @email', array('@email' => $valid_email)));
        }
    }   
    if (drupal_mail('module_test', 'some_mail_key', $valid_email, language_default(), $params, $from))
    {
        drupal_set_message(t('An email has been sent to @email', array('@email' => $admin_email)));      
    } else {
        drupal_set_message('There was an error sending your email', 'error');
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:14:50.293

缺少一个 } 来关闭你的函数 module_test_submit($form, &$form_state) {

希望能帮助到你

公关

# libtiff.net - libtiff.net 无法读取 jpeg 压缩文件

> ID：13476554
> 
> 赞同：1
> 
> 时间：2012-11-20T15:31:34.877
> 
> 标签：libtiff.net

我有一个使用 jpeg 压缩的多页 tiff。

通过 libtiff.net 打开文件时，我收到以下错误消息：

```
JPEGPreDecode: 
JPEG strip/tile size exceeds expected dimensions, expected 1164x1, got 1164x826. 
```

图像处理失败。文件/目录具有以下标签：

```
OldSubFileType (1 Short): 1
ImageWidth (1 Long): 1164
ImageLength (1 Long): 826
BitsPerSample (3 Short): 8, 8, 8
Compression (1 Short): JPEG Technote #2
Photometric (1 Short): YCbCr
FillOrder (1 Short): Msb2Lsb
StripOffsets (1 Long): 224
SamplesPerPixel (1 Short): 3
StripByteCounts (1 Long): 109294
XResolution (1 Rational): 200
YResolution (1 Rational): 200
PlanarConfig (1 Short): Contig 
```

使用其他 jpeg 压缩文件我没有问题。任何想法为什么我会收到错误？为什么它期望 1164x1？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T19:12:47.033

请确保您的文件设置了[ROWSPERSTRIP](http://www.awaresystems.be/imaging/tiff/tifftags/rowsperstrip.html)标记。

如果没有此标签集，JPEG 解码器可能会认为图像中条带的高度不正确。

另一种选择是下载[LibTiff.Net 的源代码，](https://github.com/BitMiracle/libtiff.net)在 JpgeCodec.cs的方法开头设置断点，`JPEGPreDecode`看看哪里出了问题。最有可能的是，该方法的以下部分导致了编解码器的警告和行为不端：

```
if (segment_height > td.td_rowsperstrip)
    segment_height = td.td_rowsperstrip; 
```

您可能会更改该方法的这一部分，但最好还是修复文件。

您也可以尝试自己添加标签（请注意，您需要为每个目录设置标签）。打开图像，检查标签的存在并尝试使用“SetField”方法为标签设置正确的值。

```
using (Tiff image = Tiff.Open(existingTiffName, "a"))
{
    for (int i = 0; i < image.NumberOfDirectories(); i++)
    {
        image.SetDirectory(i);
        ...

        FieldValue[] value = image.GetField(TiffTag.ROWSPERSTRIP);
        if (value == null)
        {
            // ROWSPERSTRIP is not set
            image.SetField(TiffTag.ROWSPERSTRIP, heightOfTheImage);
        }
        ...
    }
} 
```

请注意，您应该打开附加更多的图像（`"a"`为此使用参数）。

# redirect - 从非 www 重定向到 www 的 Heroku 问题

> ID：13476555
> 
> 赞同：0
> 
> 时间：2012-11-20T15:31:36.907
> 
> 标签：redirect, heroku, http-status-code-301, forward, no-www

我已经在例如 www.mydomainhere.com 上使用 SSL 设置了我的应用程序

通过我的 DNS 提供商，我设置了一个从 mydomainhere.com 到 www.mydomainhere.com 的 URL 转发，并且可以正常工作。但是，如果我尝试访问 mydomainhere.com/users 或任何其他变体，它会让我看到“这里什么都不存在，但这里有一堆广告页面”，但如果我输入 www.mydomainhere.com/users 那么它完美运行。

我将 Heroku 与 SSL 端点和 mydomain.com 用于 DNS 提供程序。我在这里缺少什么吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:27:13.353

这不是 Heroku 问题，而是您的 DNS 重定向问题。显然他们没有正确重定向。如果您无法让您的 DNS 提供商正确重定向，我建议您更改 DNS 提供商。

# javascript - 什么会修复当前用作可点击 div 的 div 中的链接

> ID：13476556
> 
> 赞同：2
> 
> 时间：2012-11-20T15:31:38.450
> 
> 标签：javascript, html, anchor

你好，我有一个网站，我正在为这个网站工作，我正在制作三个面板，当它们被点击时，你可以把它想象成一个翻转卡的概念。我一切正常，但我意识到，因为 div 本身被包裹在一个锚标记中，并且显示了“块”。我所拥有的是里面的内容，它们是指向外部页面的链接，但由于 div 是可点击的，它只读取该锚点。我尝试使用 z-index 但这似乎并没有帮助。

这是我的标记：什么是 ElectedFace？

```
<div class="flip_content"  id="flip1">
 <div class="content-info">
  <h5 style="text-align:center; font-size:20px; margin:3px 0 0 0; font-family:Arial, Helvetica, sans-serif;"><span class="blue">Elected</span><span class="red">face</span></h5>
  <p>electedface is America's free social network delivering more real time news, faster   than any other website.</p>
  <p>electedface connects subscribers to their elected officials with active electedface accounts</p>

<p>electedface empowers subscribers to share their voice and turn social networking into constructive civil action.</p>
  </div>
</div>

<a href="#" class="flip_switch" data-content_container="#flip2" data-flip_container="#flip_box2">
<div class="flipbox" id="flip_box2">
   <h4>Getting Started</h4>
</div>
</a>

 <div class="flip_content" id="flip2">
 <div class="content-info">
  <p> There are three ways to connect:</p>
     <p><a href="http://google.com">Read top news stories</a> and <a href="http://google.com">Read local news stories</a></p>
     <p><a href="http://google.com">Connect to your elected officials and start a group in your community</a></p>
     <p><a href="http://google.com">Register for free membership</a></p>
     </div>
</div>
<a href="#" class="flip_switch" data-content_container="#flip3" data-flip_container="#flip_box3">
<div class="flipbox" id="flip_box3">
   <h4>Next Steps</h4>
</div>
</a>
 <div class="flip_content" id="flip3">
 <div class="content-info">
  <p>Elected officials: activate your electedface account, connect to your electorate, and enlist supporters.</p>
  </div>
</div> 
```

这是我的 Javascript

```
 <script type="text/javascript">
        $(function(){
           $('.flip_switch').bind("click",function(){
              var element = $(this);
              var content = element.data("content_container");
              var flip_container = element.data("flip_container");
              var active_flipbox = $('.activeFlip');

              if(element.hasClass('activeFlip')){
                  //If the flipbox is already flipped
                  flip_container.revertFlip();  
              }
              else{
                  if(active_flipbox){
                    //Revert active flipbox
                    active_flipbox.revertFlip();
                    //Remove active status
                    active_flipbox.removeClass('activeFlip');
                  }
                  $(flip_container).flip({
                    direction: 'rl',
                    color: '#c8cbce',
                    content: $(content).html(),
                    speed:100,
                    onBefore: function(){
                      $(flip_container).addClass('activeFlip'); 
                    }  
                  });
              }

               return false;  
           });      
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:40:19.800

在我看来你的问题就是所谓的`bubbling`

你需要的是（很可能:)：http: [//api.jquery.com/event.stopPropagation/](http://api.jquery.com/event.stopPropagation/)

# html - Phonegap 是否允许发出 POST 请求？

> ID：13476557
> 
> 赞同：0
> 
> 时间：2012-11-20T15:31:40.550
> 
> 标签：html, cordova, post

我正在使用 Phonegap 开发应用程序。我为获取 JSON 文件做了很多 GET 请求，它们运行良好，但是当我尝试做同样的事情但使用 POST 请求时，我没有回调，并且在服务器中我收到错误 400（我什至没有向服务器）。

所以我最小化了我的应用程序，并将其包含在纯 HTML 中：

```
<form action="https://edge.suitepad.de:442/api/v1/8b17ec5acab7537b/orders/a4054d5fe4184431f55aca69cca9a7ef/purchase" method="post">
  <input type="hidden" name="order" value='{"currency":"eur","order_items":[{"id":265,"quantity":5}]}' />
  <input type="submit">
</form> 
```

这对你有用吗？您是否在使用 Phonegap 的应用程序中收到任何具有此表单的回调？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:16:39.480

发布请求从 phonegap 工作得很好 - 错误的请求错误是特定于您的数据和服务器设置的组合。

不过，您显示的 html 肯定不会触发回调 - 一旦您单击提交，它就会从服务器加载一个页面，并且包含回调的 phonegap 页面消失了。

# c# - 使用 LINQ 和 EF，如何从数据库中删除不在项目列表中的值

> ID：13476559
> 
> 赞同：1
> 
> 时间：2012-11-20T15:31:42.347
> 
> 标签：c#, asp.net-mvc, linq, entity-framework

我在数据库中有一组现有的项目，其中一个`MultiSelectList`ID 允许将班次添加到操作员。目前，操作员分配了 3 个班次。现在在视图上对其进行编辑，以从 3 中删除 1 Shift。

遍历现有项目集并确定要删除的 3 个项目中的哪一个在选定项目列表中找不到的最佳方法是什么。

我知道最简单的方法是为 Operator 删除数据库中的所有项目，然后从 MultiSelectList 中插入值，但我认为可能有一种方法可以使用 LINQ 从 Id 列表中没有的现有位置中进行选择

```
var existing = (from os in db.OperatorShifts
                where os.OperatorId == model.Id
                select os);

public List<Guid?> Shifts { get; set; }
public MultiSelectList AvailableShifts { get; set; }

model.Shifts 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:51:02.767

```
//asuming your db has these fields: db.Shifts, db.OperatorShifts
//and model is the current Operator

var existingShifts = (from os in db.OperatorShifts
                where os.OperatorId == model.Id
                select os).ToList();

IEnumerable<Guid> newShiftIds = ?; //don't now how your selected shift ids got post back, figure it out yourself

var shiftsToRemove = existingShifts.Where(e => newShiftIds.All(id => e.Id != id)).ToList();
var shiftIdsToAppend = newShiftIds.Where(id => exising.All(e => e.Id != id)).ToList();

foreach(var shift in shiftsToRemove)
{
    db.OperatorShifts.Remove(shift);
}

foreach(var shiftId in shiftIdsToAppend)
{
    db.OperatorShifts.Add(new OperatorShift{
        OperatorId = model.Id,
        ShiftId = shiftId
    });
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:11:06.247

我发现执行此类任务的最简单方法是从数据库中删除所有项目，然后将我想要的项目重新插入。

# android - 未调用 SendWakeFull 工作

> ID：13476560
> 
> 赞同：0
> 
> 时间：2012-11-20T15:31:49.413
> 
> 标签：android, commonsware-cwac

我已经在我的项目中实现了 Commonsware WakefulIntentService jar 文件。

我设置了新的警报如下：

```
Intent intent = new Intent(context, AlarmReceiver.class);

PendingIntent pi = PendingIntent.getBroadcast(context, 0, intent, 0);

// Get the AlarmManager service
AlarmManager am = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);

// CONSTANT.ALARM_TIME is set to 300000
am.setRepeating(AlarmManager.ELAPSED_REALTIME_WAKEUP,   SystemClock.elapsedRealtime()+CONSTANT.ALARM_TIME, CONSTANT.ALARM_TIME, pi); 
```

我设置广播接收器如下：

```
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

import com.commonsware.cwac.wakeful.WakefulIntentService;

public class AlarmReceiver extends BroadcastReceiver {
  @Override
  public void onReceive(Context context, Intent intent) {
    WakefulIntentService.sendWakefulWork(context, AlarmService.class);
  }
} 
```

我已经调试了这个设置，当我在 AlarmReceiver 类中设置断点时，它会触发。

但是，doWakeFulWork 中有一个断点，它永远不会到达那里。

```
import com.commonsware.cwac.wakeful.WakefulIntentService;

public class AlarmService extends WakefulIntentService implements OFDelegate {
private MMApp myApp;
private Account _currentAccount;
private ArrayList<Thread> _threads;

private static final String SHOW_TIME_FORMAT = "h:mma";

private final static String CLASS_NAME = AlarmService.class.getName();

public AlarmService() {
    super("AlarmService");
}

@Override
protected void doWakefulWork(Intent intent) { 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T14:55:32.037

@Commonsware 是正确的。我在清单中有条目，但有一个错字。一旦我纠正了那个错字，doWakefulWork 就被正确调用了。感谢@Commonsware 的帮助和一个很棒的图书馆。强烈推荐！

# html - 由于 -moz-transform: scale(1)，仅在 Firefox 中出现“位置：已修复”的 CSS 问题；

> ID：13476561
> 
> 赞同：3
> 
> 时间：2012-11-20T15:31:54.043
> 
> 标签：html, css, firefox, css-position, fixed

我正在建立一个网站，我想让标题处于固定位置。

我已经在几个网站上这样做了，但它在 Firefox 上不起作用。Safari 和 Chrome 都可以。

[这是一个现场示例（仅适用于 Firefox）](http://www.reflexion-graphic.com/projets/forum/css-position-fixed/zz-test.html)

[这是一个与 Firefox 一起使用的实时示例](http://www.reflexion-graphic.com/projets/forum/css-position-fixed/zz-test-2.html)

唯一的区别在于 css ：

```
-moz-transform: scale(1); 
-moz-transform-origin: 0 0; 
```

似乎 -moz-transform “删除”了固定位置。

你能解释一下为什么吗？

我正在使用 -moz-transform: 因为我的客户想要一个缩放按钮。我已经解释过这不是一件好事，但他仍然想要这个功能。

CSS 代码：

```
#conteneur
{
width: 960px;
position: relative;
margin: auto;
zoom: 100%;
-moz-transform: scale(1); 
-moz-transform-origin: 0 0;
}

#header
{
position:fixed;
top:0;
z-index:3;
width:960px;
height:81px;
background-color:#ccc;
padding-bottom:8px;
} 
```

ps：如果您想编辑我的帖子，欢迎您，因为英语不是我的第一语言。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T17:54:24.773

尝试移动

```
-moz-transform: scale(1); 
-moz-transform-origin: 0 0; 
```

部分从`#conteneur`到`#conteneur > div`。

所以而不是：

```
#conteneur {
    width: 960px;
    position: relative;
    margin: auto;
    zoom: 100%;
    -moz-transform: scale(1); 
    -moz-transform-origin: 0 0;
} 
```

尝试

```
#conteneur {
    width: 960px;
    position: relative;
    margin: auto;
}

#conteneur > div {  
    zoom: 100%;
    -moz-transform: scale(1); 
    -moz-transform-origin: 0 0;
} 
```

`0.4`有关比例示例，请参见此 Fiddle ：http: [//jsfiddle.net/XtsRH/2/](http://jsfiddle.net/XtsRH/2/)

**更新：**

关于`>`（子）选择器：

*   [W3.org 选择器](http://www.w3.org/TR/CSS2/selector.html#child-selectors)
*   [堆栈溢出问题（CSS Child vs Descendant 选择器）](https://stackoverflow.com/questions/1182189/css-child-vs-descendant-selectors)

`*`只是[通用选择器](http://www.w3.org/TR/CSS2/selector.html#universal-selector)，它匹配任何元素类型的名称。

我已经分叉了你的小提琴（用 jQuery 修改比例）：http: [//jsfiddle.net/AgCSx/](http://jsfiddle.net/AgCSx/)。jQuery 选择器从更改`#conteneur`为`#conteneur > *`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:45:27.903

最近我发现一条评论描述了应用了任何转换的容器的相同问题，这意味着转换破坏了固定效果。这是评论的摘录...

“除了‘none’之外的任何转换值都会导致堆叠上下文和包含块的创建。该对象充当固定位置后代的包含块。” （[http://www.w3.org/TR/css3-2d-transforms/](http://www.w3.org/TR/css3-2d-transforms/)）

请参阅[移动浏览器中的固定定位](http://bradfrostweb.com/blog/mobile/fixed-position/)

# macos - 如何为多点触控手势添加 GlobalMonitorForEventsMatchingMask？

> ID：13476566
> 
> 赞同：0
> 
> 时间：2012-11-20T15:32:21.410
> 
> 标签：macos, cocoa, event-handling, multi-touch, nsevent

一切都很好 -**在本地**- 与......

```
[NSEvent addLocalMonitorForEventsMatchingMask:NSEventMaskRotate 
                                      handler:^(NSEvent *e) {
                       NSLog(@"event type:  %lx", e.type);  }]; 
```

`NSLOG``event type: 12`

但是，我在全局处理程序中没有收到任何手势事件。（尽管其他类型、滚动、单击等确实有效。）

```
_ev = [NSEvent addGlobalMonitorForEventsMatchingMask: NSEventMaskRotate 
                                             handler:^(NSEvent *e){
                             NSLog(@"event type:  %lx", e.type);  }]; 
```

`NSLOG`

这低于 10.8。我意识到手势不会在 10.6 上得到报告。但文档没有表明这不应该起作用。有任何想法吗？

# emacs - Emacs 中的 perltidy 模式自动运行

> ID：13476571
> 
> 赞同：1
> 
> 时间：2012-11-20T15:32:41.217
> 
> 标签：emacs, lisp, elisp, perl-tidy

我有一个***perltidy-mode.el*** lisp 文件，它正在被加载 - 我可以通过`M-x perltidy-mode`.

打开文件（或加载 emacs）后自动运行它的正确方法是什么？

```
(defalias 'perl-mode 'cperl-mode)
(defalias 'perl-mode 'perltidy-mode) 
```

似乎不起作用。

* * *

*看来我忘记了很多 lisp/emacs*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:12:51.377

如果你想为每个打开的 perl 文件激活它，你可以将它添加到一个钩子中：

```
(defun my-perl-hook ()
  (perltidy-mode 1))
(add-hook 'perl-mode-hook 'my-perl-hook) 
```

注意：我对这种模式或不同的 perl 模式一无所知，所以你也可以将你的函数添加到其他钩子中。

# linux - gedit 中的可折叠代码

> ID：13476579
> 
> 赞同：9
> 
> 时间：2012-11-20T15:32:59.480
> 
> 标签：linux, editor, gedit

如何在 gedit 中折叠函数、类或方法。我设法为 gedit 安装了所有插件，但找不到任何相同的插件。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-29T21:08:31.050

在 gedit 3 中，我目前正在使用我自己的其他人提到的插件的分支。它并不完美，但无论如何它对我来说效果很好。[https://github.com/aeischeid/gedit-folding](https://github.com/aeischeid/gedit-folding)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T16:59:20.483

我刚刚发现了这个更新版本的 gedit-folding：
[http ://code.google.com/p/gedit-folding/issues/detail?id=4](http://code.google.com/p/gedit-folding/issues/detail?id=4)

只需下载`folding.py`并`folding.gedit-plugin`保存它们，`~/.local/share/gedit/plugins`然后在编辑>首选项>插件下启用“简单折叠”。

要使用，请移至块*的最开头*并按 Alt+Z。我已经用 Python、Javascript 和 HTML 文件对其进行了快速测试，它似乎折叠了大多数块，但多行字符串和注释除外。

它并不完美，但总比没有好，我想。

**更新：**我刚刚用严重缩进的代码测试了它。折叠似乎仅基于缩进。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:46:50.180

对于 ubuntu 10.04 可以使用这个折叠插件：

[http://code.google.com/p/gedit-folding/downloads/list](http://code.google.com/p/gedit-folding/downloads/list)

通过将其放置在为用户安装它

```
~/.gnome2/gedit/plugins/ 
```

或系统

```
/usr/lib/gedit-2/plugins/ 
```

# javascript - Jquery cookie，适用于背景颜色但不适用于徽标图像

> ID：13476582
> 
> 赞同：1
> 
> 时间：2012-11-20T15:33:04.293
> 
> 标签：javascript, jquery, cookies, state

我正在使用[JQuery cookie](https://github.com/carhartl/jquery-cookie)来更改背景的颜色。我还同时更改了徽标图像，但在页面重新加载时，我仍在尝试弄清楚如何让 cookie 保留徽标图像。到目前为止，我有使用 cookie 的背景，但还没有弄清楚如何使用 cookie 保留选定的主题徽标图像。

到目前为止，我的代码是：

```
<div class="main bg1"> 
<img id="logo-img" class="green-img" src="http://i1294.photobucket.com/albums/b601/danomatic11/logo-green.png" alt="logo"/>
<h2>Lorem ipsum dolor sit</h2>
</div>

<p>Choose a theme:</p>
<ul class="theme-switcher">
<li class="green">&nbsp;</li>
<li class="purple">&nbsp;</li>
<li class="rust">&nbsp;</li>
</ul>​

$("li.green").click( function(){ $
(".main").removeClass('bg2 , bg3').addClass("bg1");
$('#logo-img').attr('src', 'http://i1294.photobucket.com/albums/b601/danomatic11/logo-green.png');
$.cookie('mycookie','bg1');
$.cookie('mycookieimg','green-img');
}); 
```

ETC...

如您所见，当`<li>`单击 an 并重新加载页面时，我在背景颜色上设置了一个 cookie，并且我正在尝试对徽标图像执行相同的操作。它可以在点击时替换图像，但我无法在页面重新加载时正确设置 cookie。

[**我这里有一个小提琴。**](http://jsfiddle.net/highrockmedia/ndCKK/22/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:40:44.497

试试这个....

[JSfiddle](http://jsfiddle.net/ndCKK/25/)

```
 $(document).ready(function(){

/* 
On click the theme is changed for the image and the logo. So far I have JQuery cookie working to keep the background color that was selected even after page reload. 

To do: retain the selected theme logo using coookie.
*/

    $("li.green").click( function(){ $
        (".main").removeClass('bg2 , bg3').addClass("bg1");
        $('#logo-img').attr('src', 'http://i1294.photobucket.com/albums/b601/danomatic11/logo-green.png');
        $.cookie('mycookie','bg1');
        $.cookie('mycookieimg','logo-green');
    });

    $("li.purple").click( function(){ $
        (".main").removeClass("bg1 , bg3").addClass("bg2");
        $('#logo-img').attr('src', 'http://i1294.photobucket.com/albums/b601/danomatic11/logo-purple.png');
        $.cookie('mycookie','bg2');
        $.cookie('mycookieimg','logo-purple');
    });

    $("li.rust").click( function(){ $
        (".main").removeClass("bg1 , bg2").addClass("bg3");
        $('#logo-img').attr('src', 'http://i1294.photobucket.com/albums/b601/danomatic11/logo-rust.png');
        $.cookie('mycookie','bg3');
        $.cookie('mycookieimg','logo-rust');
    }); 

    if ($.cookie('mycookie')) {
        var $imgsrc = $.cookie('mycookieimg');
        $('.main').addClass($.cookie('mycookie'));
        $('#logo-img').attr('src','http://i1294.photobucket.com/albums/b601/danomatic11/'+$imgsrc+'.png');
    }

});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:53:03.353

```
if ($.cookie('mycookie')) {
    $('.main').addClass($.cookie('mycookie'));
    //-- set image src/class via $.cookie('mycookieimg') value
} 
```

我看不到试图设置 img 属性的位置。另外，为什么不直接使用透明的 PNG 并通过图像显示 div 的背景呢？

# android - 如何正确获取外部 SD 卡路径？

> ID：13476585
> 
> 赞同：0
> 
> 时间：2012-11-20T15:33:08.917
> 
> 标签：android, storage, external, sd-card

我面临着一个众所周知的问题，即获取安装在某些 Android 设备上的外部 SD 卡的路径。（请参阅[此问题](https://stackoverflow.com/questions/11281010/how-can-i-get-external-sd-card-path-for-android-4-0)以了解我的意思）

我曾想过通过读取 的内容来解决问题`/etc/vold.fstab`，然后只取代表分区的行，但我没有进行测试的设备。我想要做的是读取该文件，忽略引用返回的地址的行`Environment.getExternalStorageDirectory()`，然后取另一行（如果存在）。

我不知道（而且我没有可能对其进行测试）是：在某些情况下，我可以拥有不是外部 SD 卡的其他线路吗？SD 卡（如果存在）是否出现在文件 vold.fstab 中？

**编辑**：答案是：是的。阅读[接受的答案](https://stackoverflow.com/a/29076048/1507512)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:35:26.577

这有什么[问题](http://developer.android.com/reference/android/os/Environment.html#getExternalStorageDirectory%28%29)？

```
Environment.getExternalStoreDirectory() 
```

当它是 SD 卡时，你为什么忽略这个？

好的 - 对于带有 /sdcard（内部）和外部 SD 卡（??）的设备，您始终可以扫描 fstab 文件并查找“sdhci”，它是 SD 主机控制器桥驱动程序。

就像是：

`dev_mount sdcard /mnt/external_sdcard auto /devices/platform/sdhci.2/mmc_host/mmc2`

然后根据需要进行解析。

为什么“有必要”找到实际的 SD 卡，但操作系统实际上并没有这样对待它？（不会作为大容量存储安装）

您的应用程序是否仅适用于这种情况的设备？使用 Android 认为的 SD 存储空间有什么问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:04:45.420

我使用以下代码首先检测 sdCard 是否存在，然后运行相关代码：

```
Detecting whether SD card exists:

Boolean isSDPresent = android.os.Environment.getExternalStorageState().equals(android.os.Environment.MEDIA_MOUNTED);
if(isSDPresent)
{
    // file path = "/mnt/sdcard/Android/data/PACKAGE_NAME/..."
}
else
{
    // file path = "/data/data/PACKAGE_NAME/..."
} 
```

认为这就是你所追求的吗？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-03-16T11:48:46.377

这可能是正确的解决方案。从 /etc/vold.fstab 中读取它，其中列出了当前安装在 Linux 系统（包括 Android）上的所有分区

```
String getExternalSdcardDirectory() {
    FileInputStream fis = null;
    try {
        fis = new FileInputStream(new File("/etc/vold.fstab"));
    } catch (FileNotFoundException e) {
        return null;    // should never be reached
    }

    try {
        byte[] buffer = new byte[4096];
        int n=0;

        String file = "";
        while ((n=fis.read(buffer, 0, 4096))>0) {
            file += new String(buffer, 0, n);
        }
        fis.close();

        String[] rows = file.split("\n");
        for (String row: rows) {
            String trimmedRow = row.trim();
            if (trimmedRow.startsWith("#") || trimmedRow.equals(""))
                continue;
            else if (trimmedRow.equals(Environment.getExternalStorageDirectory().getAbsolutePath()))
                continue;
            else
                return trimmedRow.split(" ")[2];

        }
    } catch (IOException e) {
        // nothing
    }
    return null;
} 
```

# python - 将输出命令重定向到变量或文件？

> ID：13476590
> 
> 赞同：2
> 
> 时间：2012-11-20T15:33:23.850
> 
> 标签：python, command-line, output

我正在尝试编写一个 python 脚本，它允许我从命令中获取输出并将其放入文件或变量中（首选变量）。

在我的代码中，我已将输出重定向到一个`StringIO()`对象。从那开始，我想输出一个命令并将其放入该`StringIO()`对象中。

这是我的代码示例：

```
from StringIO import StringIO
import sys

old_stdout = sys.stdout

result = StringIO()
sys.stdout = result

# This will output to the screen, and not to the variable
# I want this to output to the 'result' variable
os.system('ls -l') 
```

另外，如何获取结果并将其放入字符串中？

提前致谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T15:35:07.247

```
import subprocess
sp = subprocess.Popen(['ls', '-l'], stdout=subprocess.PIPE)
output, _ = sp.communicate()
print "Status:", sp.wait()
print "Output:"
print output 
```

# javascript - Access-Control-Allow-Origin: * 已设置但我仍然得到 Origin not allowed

> ID：13476597
> 
> 赞同：3
> 
> 时间：2012-11-20T15:33:34.127
> 
> 标签：javascript, json, cors

我正在开发一个使用 jQuery 从远程服务器读取 JSON 文件的 Web 客户端。而且我很难让它工作。

代码：

```
jQuery.getJSON('http://[remote-ip]/openbeacon/test.json', updateJsonCallback); 
```

错误：

> XMLHttpRequest 无法加载 http://[remote-ip]/openbeacon/test.json。
> Access-Control-Allow-Origin 不允许来源 http://[remote-ip]。

我已经阅读了整个 Access-Control-Allow-Origin 的内容，并认为我找到了解决方案：将 'Header set Access-Control-Allow-Origin "*"' 添加到 Apache 配置文件 (httpd.conf) 和重新启动服务。不幸的是，这没有用。

我检查了标题：现在确实显示了选项 - 但 Chrome 仍然不允许我访问。我什至将标题与远程工作的 json 文件的标题进行了比较：

[http://api.openbeacon.net/get/brucon.json](http://api.openbeacon.net/get/brucon.json) < 工作

```
HTTP/1.1 200 OK
Date: Tue, 20 Nov 2012 15:01:43 GMT
Server: Apache
Last-Modified: Tue, 20 Nov 2012 15:01:43 GMT
ETag: W/"d073949-154d-4ceee830cdae1"
Accept-Ranges: bytes
Content-Length: 5453
Access-Control-Allow-Origin: *
Connection: close
Content-Type: application/json; charset=utf-8 
```

http://[remote-ip]/openbeacon/test.json < 不工作

```
HTTP/1.1 200 OK
Date: Tue, 20 Nov 2012 15:01:41 GMT
Server: Apache/2.2.14 (Unix) DAV/2 mod_ssl/2.2.14 OpenSSL/0.9.8l PHP/5.3.1 mod_perl/2.0.4 Perl/v5.10.1
Last-Modified: Tue, 20 Nov 2012 15:01:41 GMT
ETag: W/"2b8ab16-1e7-4ceee82edbf40"
Accept-Ranges: bytes
Content-Length: 487
Acces-Control-Allow-Origin: *
Connection: close
Content-Type: application/json 
```

帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T16:33:13.203

好吧，这很愚蠢。正如@Rocket 已经指出的那样，我输错了 Access。叹。

```
Acces-Control-Allow-Origin: * 
```

应该

```
Access-Control-Allow-Origin: * 
```

# tsql - 运行插入语句 x 次

> ID：13476598
> 
> 赞同：14
> 
> 时间：2012-11-20T15:33:43.083
> 
> 标签：tsql

我有两张桌子。一张表`A`有 n 行数据，另一张表`B`为空。我想将`insert`n 行放入表中`B`，表中的每一行 1 行`A`。Table`B`将有几个来自 table 的字段`A`，包括来自 table 的外键`A`。

最后，我希望`B`在`A`. 为此，我使用了：

```
INSERT INTO B(Col1
             ,Col2
             ,Col3
             ,Col4
             ,Col5
             );
SELECT 100
      ,25 
      ,'ABC'
      ,1
      ,A.ID
FROM Auctions A 
```

现在，我把这段代码放在一个存储过程中，这个 SP 接受一个`int`名为`NumInserts`.

我想插入`n * NumInserts`行。因此，如果 n 为 10 且 NumInserts 为 5，我想运行此代码 5 * 10 (50) 次。

换句话说，`table A`我想要`insert`5 行中的每一行`table B`。我该怎么做？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-20T15:42:37.520

```
create procedure insert_into_b
    @numInserts int
as
begin
    while @numInserts > 0
    begin
        insert into b (id)
        select id from a
        set @numInserts = @numInserts - 1
    end
end

exec insert_into_b 2 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-20T15:47:32.903

我宁愿尽可能避免循环，这样我就不必在我的存储过程中维护一些容易破坏且有些丑陋的循环结构。

`Numbers`您可以使用表格、`CROSS APPLY`语句和现有语句轻松完成此操作`INSERT`。

鉴于您的数字表如下所示：

```
Number
======
0
1
2
... 
```

您的 SQL 语句简单地变为：

```
INSERT INTO B 
(
    [Col1]
    ,[Col2]
    ,[Col3]
    ,[Col4]
    ,[Col5]
)
SELECT 
    100 
    ,25
    ,'ABC'
    ,1
    ,a.ID
FROM 
    Auctions a
CROSS APPLY
    Numbers n
WHERE
    n.Number BETWEEN 1 AND @NumInserts 
```

如果使用得当，数字表会很有用。如果您不熟悉它们，这里有一些资源和一些优点/缺点：

*   [http://dataeducation.com/you-require-a-numbers-table/](http://dataeducation.com/you-require-a-numbers-table/)（本文创建数字表的代码如下所示）
*   [http://archive.msdn.microsoft.com/SQLExamples/Wiki/View.aspx?title=NumbersTable](http://archive.msdn.microsoft.com/SQLExamples/Wiki/View.aspx?title=NumbersTable)
*   [https://dba.stackexchange.com/questions/11506/why-are-numbers-tables-invaluable](https://dba.stackexchange.com/questions/11506/why-are-numbers-tables-invaluable)

如果这个解决方案总是会是一个相当小的数字，那么这个解决方案可能有点过分`@NumInserts`了，但是如果你已经有一个 Numbers 表，那么你不妨利用它！

**更新**：

这是一种快速而肮脏的方法来填充从 0 到 65,535 的数字表：

```
CREATE TABLE Numbers
(
    Number INT NOT NULL,
    CONSTRAINT PK_Numbers 
        PRIMARY KEY CLUSTERED (Number)
        WITH FILLFACTOR = 100
)
GO

INSERT INTO Numbers
SELECT
    (a.Number * 256) + b.Number AS Number
FROM 
(
    SELECT number
    FROM master..spt_values
    WHERE 
        type = 'P'
        AND number <= 255
) a (Number),
(
    SELECT number
    FROM master..spt_values
    WHERE 
        type = 'P'
        AND number <= 255
) b (Number)
GO 
```

[**信用：** [http ://dataeducation.com/you-require-a-numbers-table/](http://dataeducation.com/you-require-a-numbers-table/)]

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-11-20T15:55:19.950

这是一个 hack，我不建议在生产或大量数据中使用它。但是，在开发快速而肮脏的场景中，我发现它通常很有用：

用于[`GO \[count\]`](http://msdn.microsoft.com/en-us/library/ms188037.aspx)执行指定次数的一批命令。

具体来说，如果您有一个名为 的存储过程`InsertAIntoB`，您可以在 Management Studio 中运行它：

```
exec InsertAIntoB
GO 10 
```

*（`10`用任何 NumInserts 替换）*

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-20T15:39:35.237

```
 Create procedure DoitNTimes 
 @N integer = 1
 As
 Set NoCount On

    While @N > 0 Begin
       Insert B (Col1, Col2, Col3, Col4, Col5)
       Select 100, 25, 'ABC', 1, A.ID
       From Auctions A
       -- -----------------------------------
       Set @N -= 1
    End 
```

如果使用 SQL Server 2005 或更早版本，请替换`Set @N -= 1' with`Set @N = @N-1`

如果你真的想避免使用 T-SQL 变量的循环，那么使用 CTE，而不是基于磁盘的表：

```
 Create procedure DoitNTimes 
 @N integer = 1
 As
 Set NoCount On

     With nums(num) As
       (Select @N Union All
        Select num - 1
        From nums
        Where num > 1)
     Insert B (Col1, Col2, Col3, Col4, Col5)
     Select 100, 25, 'ABC', 1, A.ID
     From Auctions A Full Join nums
     Option(MaxRecursion 10000) 
```

但当然，这也是循环的，就像任何解决这个问题的方法一样。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-08T19:10:05.007

很晚的答案，但不需要循环，它比 Corey 的好答案简单一点；

```
DECLARE @n int = 10;
INSERT INTO B(Col1,Col2,Col3,Col4,Col5);
SELECT 100,25,'ABC',1,A.ID
FROM Auctions A
JOIN (SELECT TOP(@n) 1 [junk] FROM sys.all_objects) as copies ON 1 = 1 
```

您可以在连接中使用任何表，只要它具有您需要的行数。如果您想要插入表中某处的副本号，您也可以将“1 [junk]”更改为“ROW_NUMBER() OVER(ORDER BY object_id) [copyno]”。

希望这可以为某人节省一些工作......

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-10-20T00:25:22.630

试试这个（在 SQL 服务器数据库上）：

```
DECLARE @NumInserts SMALLINT = 3

INSERT INTO B (Col1, Col2, Col3, Col4, Col5)
    SELECT 100, 25, 'ABC', 1, A.ID
    FROM Auctions A
        JOIN master.dbo.spt_values numbers ON numbers.number < @NumInserts
    WHERE numbers.[type] = 'P' 
```

*   **注意**：这仅在`@NumInserts`小于或等于 2048时才有效
*   `master.dbo.spt_values WHERE type = 'P'`只是一个从 0 到 2047 的内置 SQL Server 数字表

# json - 访问json API，自定义accept type madness

> ID：13476599
> 
> 赞同：0
> 
> 时间：2012-11-20T15:33:44.097
> 
> 标签：json, api, get, url-parameters

我正在尝试向此 API 发出请求：

[http://services.vrt.be/epg/playlists](http://services.vrt.be/epg/playlists)

默认返回文本/html。

当我在这样的浏览器中查询它时： [http://services.vrt.be/epg/playlists?accept=text/html](http://services.vrt.be/epg/playlists?accept=text/html)它仍然按请求返回 html。

但是当我这样查询时： [http ://services.vrt.be/epg/playlists?accept=application/vnd.epg.vrt.be.playlists_1.0+json](http://services.vrt.be/epg/playlists?accept=application/vnd.epg.vrt.be.playlists_1.0+json)

使用 API 文档中所述的正确数据类型，它 406 并告诉我这是不可接受的。

错误页面显示了一个接受类型列表，如下所示：

> 支持以下媒体类型：application/vnd.epg.vrt.be.playlists_1.0+xml、application/vnd.epg.vrt.be.playlists_1.0+json、application/vnd.epg.vrt.be.playlists_1 .1+xml，应用程序/vnd.epg.vrt.be.playlists_1.1+json，文本/html

Wich 列出了我提供的接受类型。我做错了什么，我正确通过了吗？（accept 参数由文档定义，并在提供 text/html 类型时起作用）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:56:14.597

这些 URL 似乎有效（至少它们不会出错）：

```
http://services.vrt.be/epg/playlists?vnd.epg.vrt.be.playlists_1.1+json
http://services.vrt.be/epg/playlists?vnd.epg.vrt.be.playlists_1.0+xml 
```

# wpf - 如何在 WPF 中进行绑定 - C#

> ID：13476603
> 
> 赞同：-1
> 
> 时间：2012-11-20T15:33:58.890
> 
> 标签：wpf, c#-4.0

我有以下代码：

```
<ControlTemplate x:Key="ViewItemTemplate"
                             TargetType="ListViewItem">
                    <StackPanel Orientation="Horizontal">
                        <CheckBox Margin="0,0,3,0" x:Name="CkBox">
                            <CkBox.IsChecked>
                                <Binding Path="IsSelected"
                                     Mode="TwoWay">
                                    <Binding.RelativeSource>
                                        <RelativeSource Mode="TemplatedParent" />
                                    </Binding.RelativeSource>
                                </Binding>
                            </CkBox.IsChecked>
                            <DataTrigger Binding="{Binding InvalidForeground}" Value="true">
                                <Setter TargetName="CkBoxVisual" Property="Foreground" Value="#999999"/>
                            </DataTrigger>
                        </CheckBox>
                        <ContentPresenter />
                    </StackPanel>
            </ControlTemplate> 
```

如何绑定 InvalidForeground？我在网上查看了许多他们告诉使用 DataTemplate 的示例。但是当我在 StackPanel 上方添加 DataTemplate 时出现错误？难道我做错了什么？

我正在尝试绑定 InvalidForeground，以便我可以添加一些代码。我收到一个错误：由于未知的 DataContext，无法解析符号“InvalidForeground”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:49:56.267

您似乎正在尝试声明一个自定义复选框控件以在 WPF 应用程序中使用。因此，您的“InvalidForeground”属性将被公开，但模板不了解它的实际类型是预期的。

我在[这里](https://stackoverflow.com/questions/13274956/wpf-custom-button-best-approach/13276319#13276319)发布了另一个答案，它为自定义按钮提供了完整的逐步说明。原则是一样的，我试图指出我对声明、类型等的理解。希望它不仅可以指导您，还可以指导其他类模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:51:06.987

```
<ControlTemplate x:Key="ViewItemTemplate"
                         TargetType="ListViewItem">
        <StackPanel Orientation="Horizontal">
            <CheckBox Margin="0,0,3,0" x:Name="CkBox">
                <CkBox.IsChecked>
                    <Binding Path="IsSelected"
                                 Mode="TwoWay">
                        <Binding.RelativeSource>
                            <RelativeSource Mode="TemplatedParent" />
                        </Binding.RelativeSource>
                    </Binding>
                </CkBox.IsChecked>
                 <DataTrigger Binding="{Binding InvalidForeground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" Value="true">
                    <Setter TargetName="CkBoxVisual" Property="Foreground" Value="#999999"/>
                </DataTrigger>
            </CheckBox>
            <ContentPresenter />
        </StackPanel>
    </ControlTemplate>

public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        DataContext = this;
        abc A = new abc();
        A.InvalidForeground = true;
    }
}
public class abc : INotifyPropertyChanged
{
    private bool invalidForeGround;
     public bool InvalidForeground
    {
        get
        { return invalidForeGround; }
        set
        { 
            invalidForeGround = value;
            Notify("InvalidForeground");
        }
     }
     private void Notify(string propName)
     {
         if (PropertyChanged != null)
             PropertyChanged(this, new PropertyChangedEventArgs(propName));
     }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

InvalidForeground 必须是上面代码是其模板的控件的DataContext中的属性。我希望这会有所帮助

# select - 使用 select 子句插入到

> ID：13476606
> 
> 赞同：1
> 
> 时间：2012-11-20T15:34:18.087
> 
> 标签：select, join, insert

第一次来这里虽然我经常使用该网站，但您的知识非常丰富！

我正在尝试在表 XXX 中插入一些值，购买我的“位置”条件是另一个表 YYY 中的特定值。我相信我需要使用“加入”句子，但我不知道如何或在哪里包含它。

我的句子是

* * *

*INSERT INTO XXX (value1, value2, value3) VALUES ('value1', 'value2', 'value3') WHERE YYY.value = 2* ;

* * *

但是当然，它缺少我不知道如何使用的“加入”句子

有什么建议么？我正在尝试在 PostgreSQL 和 SQL Server 数据库中执行此操作，因此任何语法对我都有好处

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:50:52.633

您使用哪个数据库？

对于 ms-access，您可以使用`select value1, value2, value3 from yyyy WHERE value4 = 2 into xxx`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-05T21:04:22.760

```
INSERT INTO XXX (col1,col2,col3) VALUES ('value1','value2','value3') 
WHERE XXX.id = YYY.id
AND YYY.age <> 2 
```

XXX 和 YYY 需要以某种方式连接（您提到的人，可能就像 1-1 比赛中的 #SSN 或其他标识符）

您插入的价值观来自哪里？即使它们是用户输入的，仍然必须有一个标识符将新信息与具有年龄的表链接起来。

# python - python gtk gobject 切换窗口的可见性

> ID：13476607
> 
> 赞同：4
> 
> 时间：2012-11-20T15:34:19.850
> 
> 标签：python, pygtk, pygobject, python-multithreading, gobject

我为隐藏和显示我的窗口编写了全局快捷方式示例，使用像“F12”这样的键，我使用了 python-xlib 和一些名为“pyxhook”的脚本，一切正常，除非我想隐藏（）和显示（）窗口几次我的过程变成一个僵尸，但相同的代码可以隐藏和显示按钮。

```
#!/usr/bin/python
# -*- coding: utf-8; -*-
from gi.repository import Gtk, GObject
from pyxhook import HookManager
GObject.threads_init()
class Win(Gtk.Window):

    def __init__(self):
        super(Win, self).__init__()
        self.connect('destroy', Gtk.main_quit)
        self.button = Gtk.Button()
        self.add(self.button)
        self.resize(200,150)
        self.show_all()

    def handle_global_keypress(self, event):
        if event.Key == 'F12':
            if self.get_visible():
                self.hide()
            else:
                self.show()

            ### this part works fine with button

            #if self.button.get_visible():
            #    self.button.hide()
            #else:
            #    self.button.show()

def main():
    app = Win()
    hm = HookManager()
    hm.HookKeyboard()
    hm.KeyDown = app.handle_global_keypress
    hm.start()
    Gtk.main()

    hm.cancel()

if __name__ == "__main__":    
    main() 
```

编辑：我使用 Keybinder 库而不是编写纯 python keybinder 解决了我的问题。 [http://kaizer.se/wiki/keybinder/](http://kaizer.se/wiki/keybinder/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T20:58:12.163

我无法回答您的具体问题，但我可能会建议另一种选择。Guake 控制台实现了同样的行为，但使用 dbus：

[http://guake.org/](http://guake.org/)

在`dbusiface.py`文件中，您可以找到：

```
import dbus
import dbus.service
import dbus.glib
import gtk
import guake.common
dbus.glib.threads_init()

DBUS_PATH = '/org/guake/RemoteControl'
DBUS_NAME = 'org.guake.RemoteControl'

class DbusManager(dbus.service.Object):
    def __init__(self, guakeinstance):
        self.guake = guakeinstance
        self.bus = dbus.SessionBus()
        bus_name = dbus.service.BusName(DBUS_NAME, bus=self.bus)
        super(DbusManager, self).__init__(bus_name, DBUS_PATH)

    @dbus.service.method(DBUS_NAME)
    def show_hide(self):
        self.guake.show_hide() 
```

除其他方法外。这是值得探索的。另请注意，Guake 是使用 PyGtk 而不是 PyGObject 开发的，但无论如何你可以得到一些想法。

# cookies - 将 cookie 值增加 1

> ID：13476613
> 
> 赞同：0
> 
> 时间：2012-11-20T15:34:40.317
> 
> 标签：cookies, setcookie

我有一个文本字段和一个提交按钮。用户提交一个电子邮件 ID，成功提交后将加载一个灯箱。成功提交后，我设置了一个 cookie 并最初分配了一个值 1。虽然我能够设置增量，但我无法将增量值分配给 cookie 值。

```
var demoCookieCount = getCookie("democount");
$('#online-demo-lightbox-button').click(function (e) {
e.preventDefault();
demoCookiecount++;
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T05:04:21.100

终于以某种方式通过了。这段代码有效

```
//setting the Cookie democount with initial value of 1
setCookie("democount", '1');
//getting the value of 'democount' cookie and assigning it to a variable
var demoCookieCount = getCookie("democount");
$('#sample-button').click(function (e) {
e.preventDefault();
//increment the variable on every click
demoCookieCount++;
//set the incremented value of demoCookieCount variable to democount cookie
setCookie("democount",demoCookieCount);
// assigning the value of demoCookiecount to variable 123
var123 = getCookie("democount");
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:39:04.083

您不会将新值保存到 cookie 中。最后尝试这样的事情：

`document.cookie = cookieName + cookieContent + cookieExpires;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:41:01.083

您必须使用 setCookie() 或类似的东西将新值存储在 cookie 中

```
function setCookie(democount, ++demoCookiecount, 1)
{
  var exdate=new Date();
  exdate.setDate(exdate.getDate() + exdays);
  var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
  document.cookie=c_name + "=" + c_value;
} 
```

# c# - 在 Mono for Android 中单击 ExpandedListView 项目时出现致命错误

> ID：13476616
> 
> 赞同：0
> 
> 时间：2012-11-20T15:34:50.163
> 
> 标签：c#, android, mono, expandablelistview

我有一个在 Mono for Android 中构建的 Android 应用程序，其中有一个 ExpandableListView。我正在为我的列表适配器扩展 BaseExpandableListAdapter 类。

这是我活动的 OnCreate 方法：

```
protected override void OnCreate(Bundle savedInstanceState) 
{        
base.OnCreate(savedInstanceState);
SetContentView(Resource.Layout.Main);
lv = (ExpandableListView)FindViewById(Resource.Id.lv);
var expandableAdapter = new MyExpandableListAdapter(this);
lv.SetAdapter(expandableAdapter);
} 
```

该列表已正确加载，但是当我单击一个项目时，我得到了一个致命的异常。我用调试运行，异常发生在执行 GetChildView 方法之后。

```
public override View GetChildView(int groupPosition, int childPosition, bool isLastChild,View convertView, ViewGroup parent) 
{
if (convertView == null)
{
LayoutInflater infaInflater = (LayoutInflater)context.GetSystemService(Context.LayoutInflaterService);
convertView = infaInflater.Inflate(Resource.Layout.childLayout, null);
}

TextView textView = (TextView)convertView.FindViewById(Resource.Id.tvChild);
textView.SetText(GetChild(groupPosition, childPosition).ToString(), TextView.BufferType.Normal);
return textView;
} 
```

这是异常消息：

```
FATAL EXCEPTION: main
E/AndroidRuntime(12474): java.lang.ClassCastException: android.widget.LinearLayout$LayoutParams cannot be cast to android.widget.AbsListView$LayoutParams 
:at android.widget.ListView.setupChild(ListView.java:1806)
:at android.widget.ListView.makeAndAddView(ListView.java:1775)
:at android.widget.ListView.fillDown(ListView.java:672) 
```

# symfony - Symfony2 和 RememberMe 令牌异常

> ID：13476617
> 
> 赞同：1
> 
> 时间：2012-11-20T15:34:55.200
> 
> 标签：symfony, remember-me

我们正在使用 Symfony2 框架构建一个应用程序。

实现了一个自定义身份验证管理器，可以正常工作，除非用户连接并选择“记住我”令牌。用户登录后，可以导航抛出网站，过了一会儿，随机时间从大约 5 分钟到大约 1 小时（可能更长），出现以下异常：

```
The UserProviderInterface implementation must return an instance of UserInterface, but returned "Symfony\Component\Security\Http\RememberMe\TokenBasedRememberMeServices". 
```

此时“修复”此问题（并再次访问网站）的唯一解决方案是从浏览器中删除 rememberme 令牌。

我真的找不到任何关于这个问题的建议，所以我想我可以在这里问一下，以防有人遇到过这个问题。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-17T10:25:16.637

您的用户提供程序应该返回一个实例，`\Symfony\Component\Security\Core\User\UserInterface`或者在找不到用户的情况下抛出`\Symfony\Component\Security\Core\Exception\UsernameNotFoundException`。没有其他的。

就我而言，它看起来像这样：

```
public function loadUserByUsername($loginOrEmail)
{
    $qb = $this->dm
        ->getRepository('MyBundle:User')
        ->createQueryBuilder('u');

    $qb->where()->orX()
        ->eq()->localName('u')->literal($loginOrEmail)->end()
        ->eq()->field('u.email')->literal($loginOrEmail);

    $user = $qb->getQuery()->getOneOrNullResult();

    if (!$user) {
        throw new UsernameNotFoundException(sprintf('User "%s" not found.', $loginOrEmail));
    }

    return $user;
} 
```

这种方法将解决所有问题。仔细看`\Symfony\Bridge\Doctrine\Security\User\EntityUserProvider`

希望它有所帮助:)

# java - 如何在 Spring MVC 表单中拥有多个按钮并相应地对待它们？

> ID：13476625
> 
> 赞同：3
> 
> 时间：2012-11-20T15:35:09.930
> 
> 标签：java, spring, hibernate, maven, spring-mvc

通过使用 Spring MVC + Maven + Hibernate，我正在尝试构建一个同时具有“添加到购物车”按钮和“添加到收藏夹”按钮的 Spring MVC 表单。每当按下一个按钮时，另一个按钮就会返回 null，如下面的代码所示。

两个按钮都是*type=submit*，我在下面的代码中处理它们。我遇到的问题是“添加到收藏夹”案例总是导致未捕获的异常（将我重定向到“内部错误”页面）。

我想知道是否有一种优雅的方式可以分别处理表单中的每个按钮按下，而无需为每个按钮设置大量 if - 语句。

HTML 文件在表单结构中声明了以下项目：

```
<c:if test="${empty readOnly}">
                        <input type="number" value="1" name="quantity" class="input-mini"/>
                        <button class="btn btn-primary" type="submit" name="addToCart"><i class="icon-shopping-cart icon-white"><jsp:text /></i> Add</button>
                        <button class="btn btn-secondary" type="submit" name="favourite"><jsp:text /> Favourite This!</button>
</c:if> 
```

我正在使用以下控制器方法：

```
 @RequestMapping(value = "/submit", method = RequestMethod.POST, produces = "text/html")
      public String submit(HttpServletRequest request, Model uiModel) {

        init(uiModel);
        String id = request.getParameter("product-id");
        String quantity = request.getParameter("quantity");

        if(!request.getParameter("addToCart").toString().equals(null))
        {
            if (StringUtils.isNotBlank(id) && StringUtils.isNotBlank(quantity)) {
              shoppingCartServiceLocal.addToShoppingCart(shoppingCart, id, quantity);         
            }
        }

    if(!request.getParameter("favourite").equals(null))
    {
        //ADD TO FAVOURITE
    }
        return "redirect:/items/" + id;
 } 
```

我可能会遗漏一些明显的东西，因为我还在学习这些。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-20T16:11:47.390

使用该`param`属性来指定对哪个按钮使用哪个方法。

```
@RequestMapping(value = "/submit", method = RequestMethod.POST, params = "addToCart")
public String addToCart(HttpServletRequest request, Model uiModel) {
    //your code
}

@RequestMapping(value = "/submit", method = RequestMethod.POST, params = "favourite")
public String addToFavorites(HttpServletRequest request, Model uiModel) { 
    //your code
} 
```

# performance - 更快：迭代列表或 JPQL 查询？

> ID：13476635
> 
> 赞同：1
> 
> 时间：2012-11-20T15:35:39.820
> 
> 标签：performance, jpql, loops

什么会更快找到匹配项：迭代列表，或执行 JPQL 查询？当然，平均而言，因为这也取决于匹配项在列表中的位置。答案是否取决于列表大小？

示例：查找名称为“Joe”的人（唯一名称）

JPQL：

```
TypedQuery<Person> q = em.createQuery(  "SELECT p " +
                                        "FROM Person p " +
                                        "WHERE p.name = :name ", Person.class);
q.setParameter("name", "Joe");
return q.getResultList().size() == 1; 
```

迭代：

```
for (Person p : persons) {
    if ("Joe".equals(p.name)) {
        return true;
    }
}
return false; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:48:54.427

在 Java 或 DB 中查找特定人员是否会更快，这实际上取决于您的具体情况，如果您在这里遇到性能问题，您真的应该为这两种实现计时。

有很多事情需要考虑。一个重要的问题是，`persons`在您的迭代示例中是从哪里来的？您手头是否已经有人员名单，或者您是否必须在`SELECT`此之前将所有人员都从数据库中取出？如果您无论如何都要查询该`Person`表，那么您*最好*只使用那个简单的 where 子句。

此外，如果有很多结果，结果的数量可能很重要。如果您的数据库中只有 5 个人，那么实现速度的任何差异都可能非常小，您不会注意到。如果你有几百万，那么这些差异将被放大。

我的直觉是，它可能不会对您的情况产生重大影响，您应该使用您更喜欢的任何一种。如果这确实是一个性能瓶颈，那么您需要在开始担心摆弄表、索引、线程等之前对它们进行计时。

# ruby - Ruby MITM 代理

> ID：13476639
> 
> 赞同：2
> 
> 时间：2012-11-20T15:35:59.860
> 
> 标签：ruby, ssl, https, proxy, man-in-the-middle

我正在寻找一些关于如何在 Ruby 中编写支持 HTTPS 的代理的示例。我有一个用 Webricks HTTPProxyServer 实现的简单代理，但我注意到，HTTPS 流量只是隧道（应该如此；））。但我想用 VCR 记录内容（关于我的问题[VCRProxy: Record PhantomJS ajax calls with VCR inside Capybara](https://stackoverflow.com/questions/13039251/record-phantomjs-ajax-calls-with-vcr-inside-capybara)），只要内容只是通过隧道，VCR 就无法记录它。

所以我想把代理写成中间人，即时生成SSL证书（我不关心证书错误，它只是为了测试），然后我就可以记录内容了/ 稍后播放。

因此，如果有人从如何开始、教程或要点方面有很好的资源，请告诉我。

PS：我已经看到了这个问题，但他们没有提供任何进一步的东西（它需要在 ruby​​ 中）：

*   [支持 HTTPS 的中间人 (MITM) 代理](https://stackoverflow.com/questions/8129260/man-in-the-middle-mitm-proxy-with-https-support)
*   [如何在 Ruby 中编写一个简单的 HTTPS 代理服务器？](https://stackoverflow.com/questions/12187509/how-do-i-write-a-simple-https-proxy-server-in-ruby)
*   [帮助 Ruby 中的 HTTP 拦截代理？](https://stackoverflow.com/questions/2679104/help-with-http-intercepting-proxy-in-ruby)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-07-10T17:45:01.963

一个老问题，但为了完整起见，这里有另一个答案。

我在 Ruby 中实现了一个 HTTP/HTTPS 拦截代理，该项目[托管在 github 中](https://github.com/argos83/ritm)。

该项目是新项目，因此它（还）不像 Python 的[mitmproxy](https://github.com/cortesi/mitmproxy)那样成熟，但它支持 HTTPS 和动态生成证书。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:14:02.277

Python 中有一个出色的 MITM 代理，其名称为[mitmproxy](https://github.com/cortesi/mitmproxy)。作者的[netlib](https://github.com/cortesi/netlib)库做了这些技巧， mitmproxy 使用它。

代码库并不大，鉴于您了解 Ruby，通读它应该不难。

# terminal - AES 密钥中有一个 LF 字符

> ID：13476640
> 
> 赞同：0
> 
> 时间：2012-11-20T15:36:02.783
> 
> 标签：terminal, openssl, aes, newline, cbc-mode

我正在尝试使用 openssl 解密视频文件。但是 16 字节的 aes 键中有一个换行符（LF）。

```
x
yÏï:YÛI?þbl 
```

由于 LF，当我将密钥复制到终端时，它只发送“x”而不是整个密钥。

如何在终端上键入此密钥？

> openssl aes-128-cbc -d -in input.ts -out output.ts -pass [aes_key]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:52:14.297

试试参数-K

来自 openssl 帮助：

```
-K/-iv         key/iv in hex is the next argument 
```

所以这样的事情应该有效

```
openssl aes-128-cbc -d -in input.ts -out output.ts -K 00EF45.... 
```

其中 00EF45.... 将是您的十六进制格式的 aes 密钥。

# php - 如何使用 fgets 作为 stream_get_line 替代品？

> ID：13476641
> 
> 赞同：0
> 
> 时间：2012-11-20T15:36:02.643
> 
> 标签：php, fgets

我正在使用[stream_get_line](http://php.net/manual/en/function.stream-get-line.php)将一些php 输出存储在一个变量中，而我正在通过fsockopen 运行一个telnet 会话。

但是，我的第二台服务器没有运行 PHP5，因此无法使用[stream_get_line](http://php.net/manual/en/function.stream-get-line.php)。PHP 4.3 有什么替代方案吗？

我听说[fgets](http://php.net/manual/en/function.fgets.php)几乎相同，但我似乎并没有让它像[stream_get_line](http://php.net/manual/en/function.stream-get-line.php)一样工作。

代码：

```
...
# opening connection    
$fp = @fsockopen($ip, 23, $errno, $errstr, 8);
    # loggin in
    fputs($fp, "$user\r");
    usleep(250000);
    fputs($fp, "$password\r");

# getting information
fputs($fp, "show info\n");
usleep(250000);
fputs($fp, "show info 2\n");
usleep(250000);
fputs($fp, "show info 3\n");
usleep(250000);
fputs($fp, "show info 4\n");
usleep(250000);
fputs($fp, "?\n");

$content = stream_get_line($fp, 0, "?");
$contentvalues = array(
    1 => substr($content, 130, 3),
    2 => substr($content, 180, 3)
);

fclose($fp);
... 
```

（我将输出的特定部分存储在 $contentvalues 变量中。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T16:08:24.320

[从文档：](http://ca3.php.net/manual/en/function.stream-get-line.php)

> 此函数与 fgets() 几乎相同，不同之处在于它允许使用标准 \n、\r 和 \r\n 以外的行尾分隔符，并且不返回分隔符本身。

[从评论：](http://ca3.php.net/manual/en/function.stream-get-line.php#94879)

> 当 fgets 从 socket 读取一些字节时，到达 EOF，它返回 bool(false) 与 stream_get_line 相同
> 
> 但是如果远程客户端断开连接，服务器脚本将尝试使用函数 fgets 读取一些数据，函数将返回 bool(false)，stream_get_line 将返回 string(0) ""
> 
> 因此您可以使用 stream_get_line 检测远程客户端断开连接，而无法使用 fgets

还有一些关于哪个函数更快的问题，但这似乎取决于 PHP 的版本、星期几以及评论者前一天晚上的晚餐。

## 编辑

从您对 Steffen 的回答的回答来看，您对`fgets()`不使用第三个参数作为分隔符的事实感到困惑。应用一个基本的输入循环并检查字符串会让你到达那里。此外，在 Steffen 的辩护中，你的问题从来都不是很清楚，只是说它“不像 stream_get_line 那样工作”。

```
<?php
$delim = '?';
$buf = 4096;

$fp = @fsockopen($ip, 23, $errno, $errstr, 8);

// ... yadda yadda yadda ... //

$content = '';
while( $part = fgets($fp, $buf) ) {
    $ind = strpos($part, $delim);
    if( $ind !== false ) {
        $content .= substr($part, 0, $ind);
        break;
    }
    $content .= $part;
} 
```

此外，即使`stream_get_line()`您应该使用循环来获取输入作为`length`参数，或者`0`并不意味着“无限”，而是将使用[PHP 的默认值之一，即 8192 bytes](http://ca1.php.net/manual/en/function.stream-get-line.php#109339)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:55:32.360

您可以使用 fgets() (string fgets ( resource $handle [, int $length ] )) 代替。

[http://www.php.net/manual/de/function.fgets.php](http://www.php.net/manual/de/function.fgets.php)

# apache-pig - 在猪查询中计算百分比

> ID：13476642
> 
> 赞同：1
> 
> 时间：2012-11-20T15:36:03.990
> 
> 标签：apache-pig

*   我有一个包含两列的表（col1：string，col2：boolean）
*   可以说 col1 = "aaa"
*   对于 col1 = "aaa"，col2 有很多 True/False 值
*   我想计算 col1 (aaa) 的 True 值的百分比

输入：

```
aaa T
aaa F
aaa F
bbb T
bbb T
ccc F
ccc F 
```

输出

```
COL1   TOTAL_ROWS_IN_INPUT_TABLE   PERCENTAGE_TRUE_IN_INPUT_TABLE
aaa     3                          33%
bbb     2                          100%
ccc     2                          0% 
```

我将如何使用 PIG (LATIN) 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T23:57:34.123

在 Pig 0.10 SUM(INPUT.col2) 中不起作用并且无法转换为布尔值，因为它将 INPUT.col2 视为布尔值包，并且包不是原始类型。另一件事是，如果 col2 的输入数据被指定为布尔值，则输入的转储没有 col2 的任何值，但将其视为 chararray 就可以了。

Pig 非常适合这种类型的任务，因为它可以通过使用嵌套在 FOREACH 中的运算符来处理各个组。这是有效的解决方案：

```
inpt = load '....' as (col1 : chararray, col2 : chararray);
grp = group inpt by col1; -- creates bags for each value in col1
result = foreach grp {
    total = COUNT(inpt);
    t = filter inpt by col2 == 'T'; --create a bag which contains only T values
    generate flatten(group) as col1, total as  TOTAL_ROWS_IN_INPUT_TABLE, 100*(double)COUNT(t)/(double)total as PERCENTAGE_TRUE_IN_INPUT_TABLE;
};

dump result; 
```

输出：

```
(aaa,3,33.333333333333336)
(bbb,2,100.0)
(ccc,2,0.0) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T19:34:04.237

当您`COUNT`计算每个键的记录数时`col1`，您应该`true`同时计算值的数量。这样，整个事情就发生在一个 MapReduce 作业中。

```
grouped = group INPUT by col1
OUTPUT = foreach grouped generate group, COUNT(INPUT), (double)SUM(INPUT.col2)/COUNT(INPUT); 
```

我在遗留系统上坚持使用 Pig 0.9，所以我不熟悉新的布尔类型。如果有可能`SUM`超过布尔值，那么这就足够了。否则，您需要使用简单的`foreach`/ `generate`first 将布尔值转换为 1 和 0。

# openerp - 在树中显示 one2many 的值

> ID：13476646
> 
> 赞同：0
> 
> 时间：2012-11-20T15:36:13.527
> 
> 标签：openerp

我在另一个树表中有一个树表。当我编辑时，嵌套表正确显示在单元格内。但是当我只查看值时，单元格中只有逗号分隔的 id（而不是嵌套表）。如何在单元格中显示表格或在视图模式下至少显示格式化值？

嵌套表：

```
<record id="view_mrp_repair_line_item_tree" model="ir.ui.view">
    <field name="name">mrp.repair.line.item.tree</field>
    <field name="model">mrp.repair.line.item</field>
    <field name="type">tree</field>
    <field name="arch" type="xml">
        <tree string="Repair line items" editable="bottom">
            <field name="description" />
            <field name="price" />
        </tree>
    </field>
</record> 
```

父表：

```
<field colspan="4" mode="tree" name="operations" nolabel="1" widget="one2many_list">
    <tree string="Operations" editable="bottom">
        ...
        <field name="items" context="{'default_repair_line_id':active_id}" widget="one2many_list" />
    </tree>
</field> 
```

嵌套表中的模型：

```
class mrp_repair_line_item(osv.osv):
    _name = 'mrp.repair.line.item'

    _columns = {
        'repair_line_id': fields.many2one('mrp.repair.line', 'Repair Line', required=True),
        'description': fields.char('Description', required=False, size=160),
        'price': fields.float('Price', required=False)
    }

mrp_repair_line_item() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T18:49:27.913

您可以创建一个函数字段，该字段返回一个表示值的字符串并改为显示该字段。例如：`[description1: Price1], [description2: Price2], ...`

# select - PostgreSQL 选择结果大小

> ID：13476649
> 
> 赞同：2
> 
> 时间：2012-11-20T15:36:30.437
> 
> 标签：select, postgresql-9.1

我在 PostgreSQL DB 中有一个表，并从该表中进行选择，但有一些约束，我想知道这个选择有多少磁盘空间。我知道有一个 postgres 函数`pg_total_relation_size`可以为我提供 DB 中某个表的大小，但我怎样才能找到“子表”的大小？

有任何想法吗？

我使用 PostgreSQL 9.1

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-20T23:18:52.953

要获取数据大小，允许`TOAST`压缩等：

```
regress=> SELECT sum(pg_column_size(devices)) FROM devices WHERE country = 'US';
 sum 
-----
 105
(1 row) 
```

要获得所需的磁盘存储，包括块分配开销、标头等：

```
regress=> CREATE TEMPORARY TABLE query_out AS SELECT * FROM devices WHERE country = 'US';
SELECT 3
regress=> SELECT pg_total_relation_size('query_out');
 pg_total_relation_size 
------------------------
                  16384
(1 row) 
```

为什么结果如此不同？因为后一个查询报告的是主表的 8k 块的大小，以及 TOAST 表的 8k 块的大小。它并不关心这些块大部分是空的。

# cakephp - 多个复选框，结果存储在同一数据库字段中 - cakePHP

> ID：13476657
> 
> 赞同：1
> 
> 时间：2012-11-20T15:37:03.520
> 
> 标签：cakephp

作为 CakePHP (2.2) 应用程序的一部分，我在我的用户控制器 admin_add() 中编写我需要有一系列与用户可以访问哪些文档相关的复选框。但是，我需要每个复选框的结果进入同一个数据库字段。

例如，假设您有 3 个值为 1、2 和 3 的复选框 - 如果所有三个都被勾选，它们将进入与以下字符串相同的 db 字段：

`1,2,3`

我怎样才能做到这一点？

我知道这很麻烦，通常我会通过 ACL 控制它，但需要以不同的方式执行此操作（主要是由于此应用程序的先前版本的编写方式以及我无法控制的其他因素）。

提前致谢

****更新大卫的评论******

 **我对您的建议代码进行了略微修改，如下所示：

```
if(isset($this->request->data['User'])){
    foreach($this->request->data['User']['manuals'] as $key => $value) {
    if ($value == 1) {
        $field .= $key .", ";
    }
}
    $this->request->data['User']['manuals'] = rtrim($field, ', ');
} 
```

此代码在控制器 add() 函数中运行良好（根据需要将正确的字符串写入数据库），但在 beforeSave() 模型函数中完成时产生以下错误

```
Error: SQLSTATE[42S22]: Column not found: 1054 Unknown column 'Array' in 'field list' 
```

导致上述错误的 SQL 语句是：

```
SQL Query: INSERT INTO `cakeapp`.`users` (`webforms_email`, `manuals_email`, `user_status_id`, `view_uat`, `username`, `password`, `forename`, `surname`, `company`, `position`, `version_numbers_id`, `support_case_reference`, `support_web_password`, `group_id`, `manuals`, `modified`, `created`) VALUES ('1', '1', 2, '1', 't800@cyberdyne.com', '48e813c14688aff66054d1f1eb93c02d977648c1', 'T800', '101', 'Cyberdyne', 'terminator', 1, '', '', 14, Array, '2012-11-21 12:28:33', '2012-11-21 12:28:33') 
```

问题似乎在于它试图插入的数组而不是数组的内容。有任何想法吗？再次感谢您的帮助。

按照要求 -

```
public function beforeSave() {

    // Added this if for cases when user being saved but password isnt set 
    if (isset($this->data['User']['password'])) {       
        $this->data['User']['password'] = AuthComponent::password($this->data['User']['password']);
        return true;
    }

    if(isset($this->request->data['User'])){
        foreach($this->request->data['User']['manuals'] as $key => $value) {
            if ($value == 1) {
                $field .= $key .", ";
            }
        }
        $this->request->data['User']['manuals'] = rtrim($field, ', ');
    }

} 
```

在 add() 上调试 $this->request->data：

```
array(
'User' => array(
    'password' => '*****',
    'username' => 'test@test.com',
    'forename' => 'James',
    'surname' => 'Jacobs',
    'company' => 'Company name',
    'position' => 'Web dev',
    'version_numbers_id' => '1',
    'support_case_reference' => '',
    'support_web_password' => '',
    'webforms_email' => '0',
    'manuals_email' => '0',
    'group_id' => '14',
    'user_status_id' => '1',
    'view_uat' => '1',
    'manuals' => array(
        (int) 36 => '1',
        (int) 31 => '1',
        (int) 32 => '1',
        (int) 33 => '1',
        (int) 34 => '0',
        (int) 35 => '0',
        (int) 37 => '0',
        (int) 38 => '0',
        (int) 39 => '0',
        (int) 40 => '0',
        (int) 41 => '0',
        (int) 30 => '0',
        (int) 29 => '0',
        (int) 24 => '0',
        (int) 25 => '0',
        (int) 26 => '0',
        (int) 27 => '0',
        (int) 28 => '0',
        (int) 47 => '0',
        (int) 48 => '0',
        (int) 49 => '0',
        (int) 118 => '0',
        (int) 117 => '0',
        (int) 94 => '0',
        (int) 88 => '0',
        (int) 51 => '0',
        (int) 50 => '0',
        (int) 46 => '0',
        (int) 45 => '0',
        (int) 9 => '0',
        (int) 6 => '0',
        (int) 5 => '0',
        (int) 10 => '0',
        (int) 4 => '0',
        (int) 44 => '0',
        (int) 7 => '0',
        (int) 43 => '0',
        (int) 42 => '0',
        (int) 125 => '0',
        (int) 124 => '0',
        (int) 127 => '0',
        (int) 129 => '0',
        (int) 130 => '0',
        (int) 126 => '0',
        (int) 131 => '0',
        (int) 132 => '0',
        (int) 133 => '0',
        (int) 134 => '0',
        (int) 135 => '0',
        (int) 136 => '0',
        (int) 137 => '0',
        (int) 168 => '0',
        (int) 123 => '0',
        (int) 128 => '0',
        (int) 97 => '0',
        (int) 91 => '0',
        (int) 101 => '0',
        (int) 100 => '0',
        (int) 98 => '0',
        (int) 92 => '0',
        (int) 95 => '0',
        (int) 93 => '0',
        (int) 74 => '0',
        (int) 120 => '0',
        (int) 73 => '0',
        (int) 75 => '0',
        (int) 76 => '0',
        (int) 72 => '0',
        (int) 122 => '0',
        (int) 119 => '0',
        (int) 175 => '0',
        (int) 174 => '0',
        (int) 173 => '0',
        (int) 172 => '0',
        (int) 171 => '0',
        (int) 170 => '0',
        (int) 169 => '0',
        (int) 176 => '0'
    ),
    'filename' => array(
        'name' => '',
        'type' => '',
        'tmp_name' => '',
        'error' => (int) 4,
        'size' => (int) 0
    )
) 
```

)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:44:47.653

如果我这样做，我会使用模型回调函数。

在您的`User`模型中，我将创建一个`beforeSave()`. 您的实现可能会有所不同，但希望您从下面的快速示例中获得想法。

```
public function beforeSave(){
  if(isset($this->data['User']){
    foreach($this->data['User']['documents'] as $doc){
       $field .= $doc .", ";
    }
    $this->data['User']['allowed_docs'] = rtrim($field, ', ');
  }
} 
```**

# cuda - GPU 亲和性（GPU 核心亲和性）

> ID：13476661
> 
> 赞同：3
> 
> 时间：2012-11-20T15:37:09.183
> 
> 标签：cuda, opencl, gpu, gpgpu, nvidia

谁能告诉我为什么没有 GPU 亲和性（我的意思是执行单元亲和性）？我知道在 Opencl 规范 1.2 中我们有一种称为设备裂变的东西，但据我所知，这仅适用于 CPU。

有人对此有更多信息吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:53:33.450

这是目前与 CPU 非常相关的扩展。我相信一些 GPU 很快就会支持这一点，并且已经有几个启用了扩展。如果您阅读下面的页面，您会看到一些 CPU 功能，例如每当提到 NUMA 时。

[http://www.khronos.org/registry/cl/extensions/ext/cl_ext_device_fission.txt](http://www.khronos.org/registry/cl/extensions/ext/cl_ext_device_fission.txt)

# batch-file - 如何检查文本文件是否批量包含某些文本？

> ID：13476663
> 
> 赞同：20
> 
> 时间：2012-11-20T15:37:14.150
> 
> 标签：batch-file

我在与批处理文件所在的文件夹相同的文件夹中有文本文件。

所以我希望我的批处理文件读取文本文件的内容，并根据该文本文件的内容，我希望它执行操作。

例如，如果文本文件包含“Hello World”，则像 Start VLC 一样，如果它不包含 Hello World，则执行其他操作。

文本将自行更新。

到目前为止，这是我的批处理代码，它可以从屏幕上的文本文件中输出文本。

```
@echo off
for /f "tokens=*" %%a in (log.txt) do call :processline %%a

pause
goto :eof

:processline
echo line=%*

goto :eof

:eof 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-11-20T15:52:40.473

您应该使用 FIND 或 FINDSTR。在命令提示符下键入`HELP FIND`和`HELP FINDSTR`以获取文档。FIND 非常简单可靠。FINDSTR 更强大，但也很喜怒无常。请参阅[Windows FINDSTR 命令有哪些未记录的功能和限制？](https://stackoverflow.com/q/8844868/1012053)了解更多信息。

您不关心任一命令的输出，因此您可以将输出重定向到 nul。

如果找到字符串，则这两个命令都将 ERRORLEVEL 设置为 0，如果未找到字符串，则将其设置为 1。您可以使用`&&`and`||`运算符根据是否找到字符串有条件地执行代码。

```
>nul find "Hello World" log.txt && (
  echo "Hello World" was found.
) || (
  echo "Hello World" was NOT found.
)

>nul findstr /c:"Hello World" log.txt && (
  echo "Hello World" was found.
) || (
  echo "Hello World" was NOT found.
) 
```

您也可以在 IF 语句中测试 ERRORLEVEL，但我更喜欢上面的语法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-12-07T01:26:46.940

这是另一种可行的方法。该代码使用 findstr 命令查看文本文件内部并找到特定字符串...返回错误级别 0（如果找到）或错误级别 1（如果未找到字符串）。

```
findstr /m "Findme" Log.txt >Nul
if %errorlevel%==0 (
echo "Findme" was found within the Log.txt file!
)

if %errorlevel%==1 (
echo "Findme" wasn't found within the Log.txt file!
)
pause 
```

# ssis - 多个 SSIS 包错误

> ID：13476668
> 
> 赞同：5
> 
> 时间：2012-11-20T15:37:33.897
> 
> 标签：ssis

我有一个 SSIS 包，它是 3 年前由其他人构建的，但早已不复存在。在过去的一年中，我多次运行它，现在我遇到了这些错误，我不知道为什么会出现这些错误。这个 ssis 包从一个 excel 文档导入到一个临时表。一旦信息在第二次运行时出现在临时表上，它就会从临时表中获取并将其与其他列一起插入到生产表中。这些是我得到的错误：

```
[OLE DB Destination [162]] Error: SSIS Error Code DTS_E_OLEDBERROR.  An OLE DB error has 
occurred. Error code: 0x80004005.
An OLE DB record is available.  Source: "Microsoft SQL Server Native Client 10.0"  Hresult:
0x80004005  Description: "Unspecified error".

[OLE DB Destination [162]] Error: There was an error with input column "UserProfileID" (299) on 
input "OLE DB Destination Input" (175). The column status returned was: "The value violated the 
integrity constraints for the column.".

[OLE DB Destination [162]] Error: SSIS Error Code DTS_E_INDUCEDTRANSFORMFAILUREONERROR.  The
"input "OLE DB Destination Input" (175)" failed because error code 0xC020907D occurred, and 
the error row disposition on "input "OLE DB Destination Input" (175)" specifies failure on 
error. An error occurred on the specified object of the specified component.  There may be 
error messages posted before this with more information about the failure.

[SSIS.Pipeline] Error: SSIS Error Code DTS_E_PROCESSINPUTFAILED.  The ProcessInput method on 
component "OLE DB Destination" (162) failed with error code 0xC0209029 while processing input 
"OLE DB Destination Input" (175). The identified component returned an error from the 
ProcessInput method. The error is specific to the component, but the error is fatal and will
cause the Data Flow task to stop running.  There may be error messages posted before this with 
more information about the failure. 
```

当我看到“输入列'UserProfileID'出错”时，我在临时表中查看了它，它为空。这是包在运行时应该找到的列之一。但我不知道第二次运行时是否找到了该信息，或者它是否应该在第一次填充。所以我不确定这是否是我遇到的问题。

我很感激我能得到的任何帮助。如果需要任何其他信息，我可以尝试提供。感谢任何可以提供帮助的人。

![从 Excel 文件导入临时表](../Images/9c5b596e53c3c6cc533a41a983744616.png) ![从临时表导入到真实表](../Images/db0befe84a36e6d37af24ade1ab0148b.png) ![数据流](../Images/810fcbc19e62bbb2d627185942bdf9d7.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T16:29:18.440

表的结构最近是否发生了变化？如果该字段之前没有约束，而现在有，那么您需要解决 SSIS 包中的问题，以将任何不符合约束的记录移动到异常表中，或者您需要找出约束的原因在不适合导入的数据类型时添加。

我要看的下一个地方是 Excel 文件。当一个包运行一个文件一段时间后突然出现问题并且插入数据的表的结构没有改变，那么文件中的数据很可能是错误的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T15:41:21.470

我认为信息的重要部分是：

```
"The value violated the integrity constraints for the column." 
```

您的目的地是否允许该字段中的空值？你可以手动插入行吗？如果取出该字段中具有空值的行，它是否运行成功？

回复：您的评论 *我确信文件中没有错误* 如果您可以识别由于字段中的空值而不会导入的行，您可以将那个设置发回并询问该人这些行是否有效，因为他们打破了进口？

好的，从您的附加信息中，我可以看到问题是 userProfileID 字段中的空值不允许空值。那么问题就变成了，什么进程应该正确确定 userProfileID 值？是 updateIDs 步骤吗？它是直接从 Excel 输入文件中复制的吗？

# python - 产生不同结果的等效 numpy 脚本

> ID：13476669
> 
> 赞同：2
> 
> 时间：2012-11-20T15:37:41.210
> 
> 标签：python, numpy

我运行了以下被认为相同的脚本，但输出完全不同，谁能解释为什么？

我首先导入了必要的模块：

```
from ctypes import *
import numpy as np 
```

**代码1：**

```
AOVoltage = np.linspace(-1, 1, 2200)
AOVoltage = AOVoltage.ctypes.data_as(POINTER(c_double))
print AOVoltage.contents

c_double(1.821347161578237e-284) 
```

**代码2：**

```
a = np.linspace(-1, 1, 2200)
AOVoltage = a.ctypes.data_as(POINTER(c_double))
print AOVoltage.contents

c_double(-1.0) 
```

**代码3：**

```
AOVoltage = (np.linspace(-1, 1, 2200)).ctypes.data_as(POINTER(c_double))
print AOVoltage.contents

c_double(1.821347161578237e-284) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:47:06.273

为此，您需要保留对原始`numpy`数组的引用，以防止它被垃圾收集。这就是为什么 #2 有效，而 #1 和 #3 无效（它们的行为未定义）。

这在[文档](http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.ctypes.html)中进行了解释：

> 小心使用该`ctypes`属性 - 特别是在临时数组或动态构建的数组上。例如，调用`(a+b).ctypes.data_as(ctypes.c_void_p)`返回一个指向无效内存的指针，因为创建的数组`(a+b)`在下一个 Python 语句之前被释放。您可以使用`c=a+b`或避免此问题`ct=(a+b).ctypes`。在后一种情况下，`ct`将持有对数组的引用，直到`ct`被删除或重新分配。

# c - 为什么不在 tcp 的情况下重用消息缓冲区

> ID：13476670
> 
> 赞同：2
> 
> 时间：2012-11-20T15:37:43.053
> 
> 标签：c, tcp

我已经看到许多 tcp/ip 的开源框架和最佳实践建议永远不要重用您已交给 tcp 层进行传输的缓冲区。背后的原因是什么？缓冲区只是简单地被复制到内核中是不是真的，那么不重用缓冲区的问题是什么？上述的一个典型例子是

```
char data[1024] = {'1', '2'.................'1024'};
write(socket, data, 1024);
data = {'a', 'b','c'...........};  //reusing the buffer 
```

ZeroMQ 提供 api 来创建缓冲区并删除它，他们强烈建议不要使用它。Netperf 创建一个环形缓冲区并确保它永远不会重用它当前写入套接字的缓冲区。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T16:48:47.540

`write()`并且`send()`都会将您的数据复制到 TCP“发送窗口”，因此您不必担心在这些调用之后在程序中更改它。但是请注意，非阻塞套接字可能不会复制您的*所有*数据，因此您应该检查返回代码以了解实际写入了多少字节。

一些自定义 TCP 堆栈（可能用于非常小的嵌入式系统）可能需要数据保留，但没有主流操作系统需要这样。

# java - 功能类似于 Django 的默认 ORM 的 Java ORM？

> ID：13476674
> 
> 赞同：0
> 
> 时间：2012-11-20T15:37:59.283
> 
> 标签：java, orm, django-models

我打算从 django 切换到 Java，不要问为什么:)。我决定使用 Play Framework。我需要的是一个 ORM，它允许将面向对象的方法与本机 sql 混合。

类似于 django 的示例：[https ://docs.djangoproject.com/en/1.3/ref/models/querysets/#extra](https://docs.djangoproject.com/en/1.3/ref/models/querysets/#extra)

Java 世界中是否有任何东西具有这些功能？

来自 Django 的 ORM 世界的示例，两个模型：blog 和 blogEntry（1->N 关系）。我们正在选择所有包含已计数 blogEntry 元素的博客。

```
Blog.objects.extra(
    select={
        'entry_count': 'SELECT COUNT(*) FROM blog_entry WHERE blog_entry.blog_id = blog_blog.id'
    },
) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:29:45.973

您可以使用 JPA 执行类似的操作，它是 Java 中的标准持久性 API，使用其 JPQL 查询语言。

假设您有一个名为 的持久类`Blog`，它有一个名为 的属性`entries`，它引用了一个名为 的类的一组实例`BlogEntry`。

您可以`Blogs`使用以下查询自行检索所有内容：

```
select b from Blog b 
```

然后，您还可以通过`entries`属性加入并计算按以下方式分组的结果来检索条目计数`Blog`：

```
select b, count(e) from Blog b join b.entries e group by b 
```

现在，这样做意味着查询将返回一个对象数组列表，其中每个数组包含 a`Blog`和 a`Long`用于计数。你可能想让它更安全一点。如果您编写了一个名为的类，该类`BlogWithCount`具有这样的构造函数：

```
public BlogWithCount(Blog b, long count) 
```

然后您可以使用构造函数表达式：

```
select new org.example.BlogWithCount(b, count(e)) from Blog b join b.entries e group by b 
```

此查询返回一个`BlogWithCount`对象列表，然后您可以从该列表中以一种简洁的方式检索您的结果。

当我第一次写这个答案时，我认为可以编写一个更简单的计数查询版本，如下所示：

```
select b, count(b.entries) from Blog b 
```

但这不起作用，至少在 Hibernate 4.1.4 中是这样。查看规范，似乎它应该可以工作，所以这可能是一个错误。我不知道。

# iphone - 如何在 xcode/iPhone SDK 中创建设置

> ID：13476678
> 
> 赞同：0
> 
> 时间：2012-11-20T15:38:14.140
> 
> 标签：iphone, objective-c, xcode

我想知道如何向我的应用程序添加某种设置，因此当用户启动应用程序时，它会询问几个问题，并根据这些问题重定向到特定视图，并且下次启动应用程序时它将继续在那里再次。

有什么方法可以实现这一点，因为我不确定应该从哪里开始搜索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:47:43.797

我在上一个项目中做了类似的事情。在那里，用户可以选择是否使用与 facebook 连接的应用程序。为了存储用户的决定，我在`NSUserDefaults`. 它非常容易读/写，并且永久存储在应用程序文件系统中。

**如果键/值对已经存在，我首先检查了 NSUserDefaults。**

1.  **如果不是**，我重定向到包含两个按钮的 ViewController（使用 FB/无 FB）
2.  然后根据用户的选择，我设置了 NSUserDefault 键。

* * *

1.  **如果是**，我确实阅读了 NSUserDefaults 并获取了密钥的值。
2.  根据加载的值，我将他重定向到 FB ViewController 或正常的。

这是阅读 NSUserDefaults 的简短示例：

```
NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
NSString *myString = [prefs stringForKey:@"keyToLookupString"]; 
```

这是编写 NSUserDefaults 的简短示例：

```
NSUserDefaults *prefs = [NSUserDefaults standardUserDefaults];
[prefs setObject:@"TextToSave" forKey:@"keyToLookupString"]; 
```

我想你的应用程序的唯一区别是你有几个值要存储，但你仍然可以使用`NSUserDefaults`. 您也可以使用`CoreData`来存储信息，但我认为在这种情况下使用`NSUserDefaults`是要走的路。

# postgresql - JPA、EclipseLink、PostgreSQL 和模式

> ID：13476679
> 
> 赞同：1
> 
> 时间：2012-11-20T15:38:17.920
> 
> 标签：postgresql, jpa, schema, eclipselink

我想开发一个使用 JPA（EclipseLink 实现）和 PostgreSQL 作为数据库的 Java EE 应用程序。

我选择拥有一个数据库和多个模式，而不是拥有多个数据库和每个数据库一个模式。

所以，在我的 persistence.xml 我有类似的东西：

```
<persistence-unit name="00" transaction-type="JTA">

    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <jta-data-source>todo</jta-data-source>

    <class>...</class>
    <class>...</class>

    <properties>
        <property name="javax.persistence.target-database" value="PostgreSQL" />
        <property name="javax.persistence.jdbc.driver" value="org.postgresql.Driver" />
        <property name="javax.persistence.jdbc.url" value="jdbc:postgresql://localhost:5432/testdb;create=true" />
        <property name="javax.persistence.jdbc.user" value="user" />
        <property name="javax.persistence.jdbc.password" value="userpwd" />
    </properties>

</persistence-unit>

<persistence-unit name="01" transaction-type="JTA">

    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <jta-data-source>todo</jta-data-source>

    <class>...</class>
    <class>...</class>

    <properties>
        <property name="javax.persistence.target-database" value="PostgreSQL" />
        <property name="javax.persistence.jdbc.driver" value="org.postgresql.Driver" />
        <property name="javax.persistence.jdbc.url" value="jdbc:postgresql://localhost:5432/testdb;create=true" />
        <property name="javax.persistence.jdbc.user" value="user" />
        <property name="javax.persistence.jdbc.password" value="userpwd" />
    </properties>

</persistence-unit> 
```

我可以很容易地引用持久性单元：

```
EntityManagerFactory emf = Persistence.createEntityManagerFactory("01");
EntityManager em = emf.createEntityManager(); 
```

但是如何在 persistence.xml 中存储有关模式的信息？我想访问架构`00`或数据库`01`。`testdb`

我可能可以直接通过本机 SQL 更改架构，但有没有办法将架构绑定到持久性单元？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T21:27:20.423

在这里提出并回答了同样的问题： [JPA - EclipseLink - How to change default schema](https://stackoverflow.com/questions/3211138/jpa-eclipselink-how-to-change-default-schema)

您可以使用 orm.xml 文件覆盖整个持久性单元的模式，或者根据需要在每个表注释或 xml 元素中定义它。

# c# - C# 客户端验证 2 个证书？

> ID：13476681
> 
> 赞同：2
> 
> 时间：2012-11-20T15:38:23.710
> 
> 标签：c#, .net, security, .net-4.0, certificate

我住在以色列，谷歌也有`google.co.il`。

我创建了一个到**google.com**的网络请求（我只想连接*到*google.com！）

但在`ServerCertificateValidationCallback`函数中，我似乎获得了*2 个*证书。

这是代码：

```
ServicePointManager.ServerCertificateValidationCallback =   
          (sender, certificate, chain, policyError) => 
               {
                 var subject = ((X509Certificate2)certificate).GetName();
                 Console.WriteLine(subject);
                // return true;
                return  XXX==YYY; // ????the 2'nd question  is about this line
               };

WebRequest oRequest;
WebResponse oResponse;
oRequest = WebRequest.Create("https://www.google.com/");
oResponse = oRequest.GetResponse(); 
```

代码（当`return true`）*启用*时的结果是：

```
C=US, S=California, L=Mountain View, O=Google Inc, CN=www.google.com
C=US, S=California, L=Mountain View, O=Google Inc, CN=*.google.co.il 
```

但我面临一个问题：

现在它发出 2 个证书：

1.  为什么我会获得 2 个证书？

2.  哪个值应该在“ `XXX`”中，哪个值应该在“ `YYY`”中？

    （我的意思是，我应该将`CN`or`O` 或*_*等同于相应的 Google 价值吗？

    如果我（首先）获得了 google.com 证书（这是所需的），然后我获得了 google.co.il 证书（这是*不*想要的）怎么办？

# .net - 如果另一个服务依赖于它，我如何导致尝试卸载我的 Windows 服务失败？

> ID：13476685
> 
> 赞同：0
> 
> 时间：2012-11-20T15:38:36.270
> 
> 标签：.net, windows-services, wix, windows-installer, dependency-management

我有一个 Windows 服务（用 .NET 编写），为此我使用 WiX 3.7 构建了一个安装程序。它充当基础架构角色，任何人都可以编写另一个使用它的 Windows 服务。由于我的服务需要在任何其他此类服务使用它时运行，所以其他服务的安装程序在安装期间将我的服务定义为它们的“服务依赖项”。

不幸的是，即使其他服务依赖于 Windows 服务，Windows 似乎也允许删除它。我想让我的安装程序出错，并且当该机器上仍安装任何其他依赖服务时无法卸载我的服务。

我不知道会在我的基础上构建什么其他服务，所以我无法对任何检查进行硬编码。

有没有办法用 WiX 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T14:49:48.183

如果有其他服务正在使用您的服务，请编写自定义操作并使卸载失败。

`OpenSCManager`+ `EnumServicesStatusEx`(查找所有服务) + `OpenService`+ `QueryServerConfig`(查找依赖项)

自定义操作应设置一个 WiX 变量（例如“SERVICE_IS_USED”），然后使用 Condition 元素对其进行测试：

```
 <Condition Message ="Stop using me first!">
    SERVICE_IS_USED = "0"
  </Condition> 
```

（实际上，我会添加其他条件，因此这仅适用于卸载期间，并且我会认真考虑允许 FORCE 选项以允许卸载，即使该服务*正在*使用中。

我建议用 C 或 C++ 而不是 .Net 编写自定义操作——在 .Net 中运行自定义操作的引导过程让我感到害怕。

如果您还没有安装程序的 boostrapper 来安装依赖项，如 .Net 框架和 C 运行时库，我会更进一步，建议以不使用 C 运行时库的方式用 C 编写自定义操作（只需Windows API 调用）。

PS 顺便说一句，我认为这与 .Net 并没有真正的关系——它更多的是 windows-services、wix 和 windows-installer

# exception - 刮擦未处理的异常

> ID：13476688
> 
> 赞同：2
> 
> 时间：2012-11-20T15:38:43.583
> 
> 标签：exception, scrapy, unhandled

我在linux上使用scrapy 0.16.2版本。我在跑：

```
scrapy crawl mycrawlspider -s JOBDIR=/mnt/mycrawlspider 
```

我收到这个阻止scrapy的错误（挂起并且不会自动完成，只有^C会停止它）

```
2012-11-20 15:04:51+0000 [-] Unhandled Error    Traceback (most recent call last):    File "/usr/lib/python2.7/site-packages/scrapy/commands/crawl.py", line 45, in run
        self.crawler.start()      File "/usr/lib/python2.7/site-packages/scrapy/crawler.py", line 80, in start
        reactor.run(installSignalHandlers=False) # blocking call      File "/usr/lib/python2.7/site-packages/twisted/internet/base.py", line 1169, in run
        self.mainLoop()       File "/usr/lib/python2.7/site-packages/twisted/internet/base.py", line 1178, in mainLoop
        self.runUntilCurrent()  --- <exception caught here> ---       File "/usr/lib/python2.7/site-packages/twisted/internet/base.py", line 800, in runUntilCurrent
        call.func(*call.args, **call.kw)      File "/usr/lib/python2.7/site-packages/scrapy/utils/reactor.py", line 41, in __call__
        return self._func(*self._a, **self._kw)       File "/usr/lib/python2.7/site-packages/scrapy/core/engine.py", line 116, in
_next_request
        self.crawl(request, spider)       File "/usr/lib/python2.7/site-packages/scrapy/core/engine.py", line 172, in crawl
        self.schedule(request, spider)    File "/usr/lib/python2.7/site-packages/scrapy/core/engine.py", line 176, in schedule
        return self.slots[spider].scheduler.enqueue_request(request)      File "/usr/lib/python2.7/site-packages/scrapy/core/scheduler.py", line 48, in enqueue_request
        if not request.dont_filter and self.df.request_seen(request):   exceptions.AttributeError: 'NoneType' object has no attribute 'dont_filter' 
```

顺便说一句，这在 0.14 版中有效

这是代码：

```
class MySpider(CrawlSpider):
    name = 'alrroya'

    NEW_IGNORED_EXTENSIONS = list(IGNORED_EXTENSIONS)
    NEW_IGNORED_EXTENSIONS.remove('pdf')

    download_delay = 0.05
    # Stay within these domains when crawling
    allowed_domains = []

    all_domains = {}

    start_urls = []

    # Add our callback which will be called for every found link
    rules = [
        Rule(SgmlLinkExtractor(deny_extensions=NEW_IGNORED_EXTENSIONS, tags=('a', 'area', 'frame', 'iframe'), attrs=('href', 'src')), follow=True, callback='parse_crawled_page')
    ]

    # How many pages crawled
    crawl_count = 0

    # How many PDFs we have found
    pdf_count = 0

    def __init__(self, *args, **kwargs):
        CrawlSpider.__init__(self, *args, **kwargs)
        dispatcher.connect(self._spider_closed, signals.spider_closed)
        dispatcher.connect(self._spider_opened, signals.spider_opened) 
        self.load_allowed_domains_and_start_urls()

    def allowed_to_start(self):
        curr_date = datetime.today()
        curr_date = datetime(curr_date.year, curr_date.month, curr_date.day)
        jobdir = self.settings['JOBDIR']
        if jobdir:
            mnt = os.path.dirname(os.path.normpath(jobdir))
        else:
            mnt = ''

        checkfile = os.path.join(mnt, '%s.crawlercheck' % self.__class__.name)
        day = timedelta(days=1)
        if os.path.exists(checkfile):
            f = open(checkfile, 'r')
            data = f.read()
            f.close()
            data = data.split('\n')
            reason = data[0]
            try:
                reason_date = datetime.strptime(data[1], '%Y-%m-%d')

            except Exception as ex:
                reason_date = None

            if reason_date and 'shutdown' in reason:
                reason = True

            else:
                if reason_date and reason_date + day <= curr_date and 'finished' in reason:
                    reason = True

                else:
                    reason = False
        else:
            reason = True

        return reason

    def _spider_opened(self, spider):
        if spider is not self:
            return

        curr_date = datetime.today()
        curr_date = datetime(curr_date.year, curr_date.month, curr_date.day)
        jobdir = spider.settings['JOBDIR']
        if jobdir:
            mnt = os.path.dirname(os.path.normpath(jobdir))
        else:
            mnt = ''

        checkfile = os.path.join(mnt, '%s.crawlercheck' % self.__class__.name)
        day = timedelta(days=1)
        if os.path.exists(checkfile):
            f = open(checkfile, 'r')
            data = f.read()
            f.close()
            data = data.split('\n')
            reason = data[0]
            try:
                reason_date = datetime.strptime(data[1], '%Y-%m-%d')

            except Exception as ex:
                reason_date = None

            if reason_date and 'shutdown' in reason:
                f = open(checkfile, 'w')
                f.write('started\n')
                f.write(str(date.today()))
                f.close()

            else:
                if reason_date and reason_date + day <= curr_date and 'finished' in reason:
                    f = open(checkfile, 'w')
                    f.write('started\n')
                    f.write(str(date.today()))
                    f.close()

                else:
                    crawler.engine.close_spider(self, 'finished')
                    if jobdir and os.path.exists(jobdir):
                        shutil.rmtree(jobdir)
                        f = open(checkfile, 'w')
                        f.write('finished\n')
                        f.write(str(date.today()))
                        f.close()
                    os._exit(1)
        else:
            f = open(checkfile, 'w')
            f.write('started\n')
            f.write(str(date.today()))
            f.close()

    def _spider_closed(self, spider, reason):
        if spider is not self:
            return

        jobdir = spider.settings['JOBDIR']
        if jobdir:
            mnt = os.path.dirname(os.path.normpath(jobdir))
        else:
            mnt = ''

        checkfile = os.path.join(mnt, '%s.crawlercheck' % self.__class__.name) 
        if 'shutdown' in reason:
            f = open(checkfile, 'w')
            f.write('shutdown\n')
            f.write(str(date.today()))
            f.close()
        else:
            if jobdir and os.path.exists(jobdir):
                shutil.rmtree(jobdir)
                f = open(checkfile, 'w')
                f.write('finished\n')
                f.write(str(date.today()))
                f.close()

    def _requests_to_follow(self, response):
        if getattr(response, 'encoding', None) != None:
            return CrawlSpider._requests_to_follow(self, response)
        else:
            return []

    def make_requests_from_url(self, url):
        http_client = httplib2.Http()
        try:
            headers = {
                'content-type': 'text/html',
                'user-agent': random.choice(USER_AGENT_LIST)
            }
            response, content = http_client.request(url, method='HEAD', headers=headers)
            #~ if 'pdf' in response['content-type'].lower() or (url.endswith('.pdf') and 'octet-stream' in response['content-type'].lower()):
            if 'pdf' in response['content-type'].lower() or 'octet-stream' in response['content-type'].lower(): 
                if self.allowed_to_start():
                    self.get_pdf_link(url)

            else:
                return CrawlSpider.make_requests_from_url(self, url)

        except Exception as ex:
            return CrawlSpider.make_requests_from_url(self, url)

    def get_pdf_link(self, url):
        source = self.__class__.name
        parsed_url = urlparse(url)
        url_domain = parsed_url.netloc
        url_path = parsed_url.path
        if url_domain:
            for domain, paths in self.__class__.all_domains[source]['allow_domains'].iteritems():
                if url_domain.endswith(domain):
                    pre_and = False
                    pre_or = False
                    and_cond = True
                    or_cond = False
                    for path in paths:
                        if path[0:1] == '!':
                            pre_and = True
                            if path[1:] not in url_path:
                                and_cond = and_cond and True
                            else:
                                and_cond = and_cond and False

                        else:
                            pre_or = True
                            if path in url_path:
                                or_cond = or_cond or True
                            else:
                                or_cond = or_cond or False

                    if pre_and and pre_or:
                        if and_cond and or_cond:
                            self.pdf_process(source, url)
                            return
                    elif pre_and:
                        if and_cond:
                            self.pdf_process(source, url)
                            return
                    elif pre_or:
                        if or_cond:
                            self.pdf_process(source, url)
                            return
                    else:
                        self.pdf_process(source, url)
                        return

    def parse_crawled_page(self, response):
        self.__class__.crawl_count += 1
        crawl_count = self.__class__.crawl_count
        if crawl_count % 100 == 0:
            print 'Crawled %d pages' % crawl_count

        if 'pdf' in response.headers.get('content-type', '').lower():
            self.get_pdf_link(response.url)

        return Item()

    def load_allowed_domains_and_start_urls(self):
        day = timedelta(days=1)
        currdate = date.today()

        alrroya = ('http://epaper.alrroya.com/currentissues.php?editiondt=' + currdate.strftime('%Y/%m/%d'),)

        self.__class__.all_domains = {
            'alrroya': {
                'start_urls': alrroya,
                'allow_domains': {
                    'epaper.alrroya.com': frozenset(()),
                }
            }
        }

        for domain in self.__class__.all_domains[self.__class__.name]['allow_domains']:
            self.__class__.allowed_domains.append(domain)

        self.__class__.start_urls.extend(self.__class__.all_domains[self.__class__.name]['start_urls'])

    def pdf_process(self, source, url):
        print '!!! ' + source + ' ' + url 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-28T20:59:53.770

这似乎是 Scrapy 中的一个错误。当前版本似乎不接受从 make_requests_from_url() 返回的列表。我能够通过以下方式修改 Scrapy 代码来解决该问题。

在文件 Scrapy-0.16.5-py2.7.egg/scrapy/spider.py

改变：

```
def start_requests(self):
    for url in self.start_urls:
        yield self.make_requests_from_url(url) 
```

到：

```
def start_requests(self):
    for url in self.start_urls:
        requests = self.make_requests_from_url(url)
        if type(requests) is list:
            for request in requests:
                yield request
        else:
            yield requests 
```

我希望官方的 Scrapy 人员最终会解决这个问题。

# mysql - 如果日期存在于表列中的任何位置，则返回单行

> ID：13476697
> 
> 赞同：0
> 
> 时间：2012-11-20T15:39:11.820
> 
> 标签：mysql

以下是 mysql 查询，我在其中检测当前（所有）月份和（当前）年份是否存在于数据库日期列中。查询工作正常，但它分别针对表的每一行运行，并返回表中存在的所有行数以及该行的特定匹配。我想要做的是以下查询应该返回单行并告诉表中是否存在给定日期（日期列中的任何位置）。请让我知道如何修改以下查询来执行此操作。谢谢

```
SELECT 
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'01'),1,0) as jan,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'02'),1,0) as feb,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'03'),1,0) as mar,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'04'),1,0) as apr,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'05'),1,0) as may,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'06'),1,0) as jun,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'07'),1,0) as jul,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'08'),1,0) as aug,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'09'),1,0) as sep,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'10'),1,0) as oct,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'11'),1,0) as nov,
IF(DATE_FORMAT(FROM_UNIXTIME(dt_note_created),'%Y%m') =  CONCAT((DATE_FORMAT(NOW(),'%Y')),'12'),1,0) as decb
FROM Notes 
```

**输出：**

```
一月 | 二月 | 三月 ....等等... | 十一月 | 十二月
 0 1 1 0 1

0 和 1 是指示月份和年份是否存在于整个日期列中的标志

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:45:06.593

我不确定我是否理解正确，但如果您只想检查您的列中是否至少有一个日期与当前月份和年份匹配，请尝试

```
SELECT COUNT(*) 
FROM date
WHERE MONTH(dt_note_created) = MONTH(Now()) 
  AND YEAR(dt_note_created) = YEAR(Now()) 
```

如果没有这样的日期，这将返回 0，否则返回日期总数。

尝试

```
SELECT DISTINCT MONTH(dt_note_created)
FROM date
WHERE YEAR(dt_note_created) = YEAR(Now()) 
```

获取包含在您的日期列中的不同月份的列表。

它返回类似（对于 1 月、2 月、8 月、11 月的日期）：

```
1
2
8
11 
```

只要这个数字小于 12，每个月就没有至少一个日期。

# php - 如何配置kohana数据库文件

> ID：13476700
> 
> 赞同：0
> 
> 时间：2012-11-20T15:39:20.300
> 
> 标签：php, database, database-connection, kohana, sqlconnection

我正在尝试在我的系统上设置一个 kohana 项目。但是它抱怨它无法访问数据库。

```
Database_Exception [ 0 ]: [1044] Access denied for user ''@'localhost' to database 'kohana' 
```

我在`application/config/database.php`下面设置了正确的用户名和密码：

```
 'hostname'   => 'localhost',
        'database'   => 'database_name',
        'username'   => 'root',
        'password'   => 'password', 
```

在备用部分我也改变了。

```
 'dsn'        => 'mysql:host=localhost;dbname=database_name',
        'username'   => 'root',
        'password'   => 'password',
        'persistent' => FALSE, 
```

我也设置了我`base_url`的`application/bootstrap.php`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T18:41:44.733

更改`modules/database/config/database.php`文件解决了问题。

谢谢@Linas

# c# - 从 string[] 转换为 int[] 的 xna 4.0 错误

> ID：13476703
> 
> 赞同：0
> 
> 时间：2012-11-20T15:39:33.940
> 
> 标签：c#, windows-phone-7, xna, runtime-error, streamreader

好的 om 试图从一个 .txt 文件加载到一个整数数组到一个二维数组，但它让我“在 mscorlib.dll 中发生了类型为 'System.FormatException' 的未处理异常”我相信它与循环和也许会越界。但我对 c# 很陌生，所以我很难过。

它在“nRow[r] =Convert.ToInt32(row[r]);”上中断

```
protected void read_lvl()
    {
        IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication();
        IsolatedStorageFileStream fileStream = myIsolatedStorage.OpenFile("myFile.txt", FileMode.Open, FileAccess.Read);
        using (StreamReader reader = new StreamReader(fileStream))
        {    //Visualize the text data in a TextBlock text

            while (!reader.EndOfStream)
            {
                //for each row
                for (int i = 0; i < rows; i++)
                {
                    //read in the line
                    string myLine = reader.ReadLine();
                    //take out the commas
                    string[] row = myLine.Split(',');

                    //convert to string to ints
                    int[] nRow = new int[row.Length];
                    for(int r=0; r<row.Length;r++){
                        nRow[r] =Convert.ToInt32(row[r]);
                    }

                    //feed back into the array
                    for (int j = 0; j < columns; j++){
                        myreadArray[i, j] = nRow[j];
                    }
                }
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:33:23.280

如果 row[r] 可能不是整数，则应使用 Int32.TryParse。

[http://msdn.microsoft.com/en-US/library/vstudio/f02979c7.aspx](http://msdn.microsoft.com/en-US/library/vstudio/f02979c7.aspx)

使用喜欢

```
int nb = 0;

if (Int32.TryParse("12", out nb) == false)
{
      Console.WriteLine("Error");
} 
```

# c# - 从 WCF 返回大字节数组 - 内存问题

> ID：13476708
> 
> 赞同：2
> 
> 时间：2012-11-20T15:39:42.333
> 
> 标签：c#, .net, wcf, memory, large-object-heap

我需要从 WCF 服务器返回一个大字节数组。

问题是 - 为了返回这样一个数组 - 我需要创建一个 - 当创建这样一个数组时 - 它会自动进入大对象堆 - 这意味着当服务受到压力时 - 我遇到了一个真正的问题内存使用和管理。

我考虑过使用非托管内存来避免使用大型托管字节数组 - 但仍然 - 我如何从 WCF 服务返回这样的数组？

有什么方法可以从 WCF 服务返回字节“流”，但不包括实际创建托管字节数组？我知道 WCF 本身使用 BufferManager - 所以如果它只是读取我的非托管内存并在发送之前使用它的缓冲区管理来存储它 - 我希望不会有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:43:59.913

您可以使用 WCF 的[Streaming Mode](http://msdn.microsoft.com/en-us/library/ms789010.aspx)。从该页面：

> 1.  要流式传输数据，服务的 OperationContract 必须满足两个要求：
>     
>     
>     
>     一种。保存要流式传输的数据的参数必须是方法中的唯一参数。例如，如果输入消息是要流式传输的消息，则操作必须只有一个输入参数。类似地，如果要流式传输输出消息，则操作必须只有一个输出参数或返回值。
>     
>     
>     
>     湾。参数和返回值的至少一种类型必须是[Stream](http://msdn.microsoft.com/en-us/library/system.io.stream.aspx)、[Message](http://msdn.microsoft.com/en-us/library/system.servicemodel.channels.message.aspx)或[IXmlSerializable](http://msdn.microsoft.com/en-us/library/system.xml.serialization.ixmlserializable.aspx)。
>     
>     
> 2.  必须在绑定上启用流式传输。您设置一个 TransferMode 属性，该属性可以采用以下值之一：
>     
>     
>     
>     一种。缓冲的，
>     
>     
>     
>     湾。流式传输，可实现双向流式通信。
>     
>     
>     
>     C。StreamedRequest，仅启用流式传输请求。
>     
>     
>     
>     d。StreamedResponse，仅启用流式传输响应。

该页面上也有一些不错的示例，包括如何写回自定义流（位于底部）。

有关编码、流式传输和会话的更多背景信息，以及使用流式传输时的一些安全注意事项，请参阅[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/ms733742.aspx)。

# integer - 我们如何从 sint 和 uint 创建我们自己的 64 位整数

> ID：13476714
> 
> 赞同：1
> 
> 时间：2012-11-20T15:40:17.453
> 
> 标签：integer

我们如何从两个给定的 32 位整数 sint 和 uint 创建用户定义的 64 位整数。

请帮我。

# c# - 从某个抽象继承的类型参数

> ID：13476719
> 
> 赞同：0
> 
> 时间：2012-11-20T15:40:28.007
> 
> 标签：c#, game-engine

我想知道是否有一种方法可以传入强制为某种基本类型的类型。例如，对于我的游戏引擎，我有一个属性列表（可控、刚体等）。我有一个 addAttribute 参数，它接受一个新对象。但是，我还想有一个重载，它采用一个类型，而不是我可以自己创建一个新对象的类型。所以例如

```
public void addAttribut(Type attribute) 
```

我在想也许可以实现 linq 的东西？我已经尝试过，但看起来“where”只能用于泛型：

```
public void addAttribute(Type attribute) where attribute : Attribute 
```

将是函数的签名。我相信 Unity 可以做到这一点；但是它可能是它可以通过 Mono 做到这一点。

如果它不是正确的基本类型，我总是可以抛出异常。但是我想知道是否有一种方法可以防止程序员一起传递错误的时间。

有任何想法吗？任何帮助是极大的赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:45:50.033

如果您乐于在*compile-time*调用代码以了解类型，则可以将其设为带有类型参数的泛型方法：

```
public void AddAttribute<T>() where T : Attribute
{
    // Use typeof(T)
} 
```

或者强制执行一个无参数构造函数，然后您可以调用它：

```
public void AddAttribute<T>() where T : Attribute, new()
{
    T t = new T();
    ...
} 
```

但否则没有办法做到这一点，不 - 你必须在执行时验证参数，就像其他任何方法一样。

# c# - 具有辅助属性的实体对象

> ID：13476721
> 
> 赞同：0
> 
> 时间：2012-11-20T15:40:38.320
> 
> 标签：c#, domain-driven-design

在我的域模型中，我有一个 Entity 对象，如下所示：

```
public class Group
{
    public int idGroup { get; set; }
    public string Description { get; set; }
} 
```

我有这个对象的存储库：

```
public class GroupRepository : IGroupRepository
{
    public Group LoadGroup(int idGroup)
    {
        //imitation of SQL data reader
        Group g = new Group();
        g.idGroup = Convert.ToInt32(r["idTipoGrupo"]);
        g.Description = Convert.ToString(r["Descricao"]);
        return g;
    }
} 
```

但是现在我需要通过我创建的存储库中的一个新函数从数据存储中获取有关 Group 对象的一些额外信息，这里是我需要的字段：

```
public bool HasChildGroups { get; set; }
public int ChildGroupsCount { get; set; }
public bool HasDeals { get; set; }
public int DealsCount { get; set; } 
```

这些属性在我看来就像一个“服务”或“帮助”属性，我不打算在我的应用程序中到处使用它们，只是几次，但我需要它们。我能想到的最简单的事情是我将这些“服务”属性添加到我的 Group 对象中，并在我的存储库中创建了一个填充它们的方法。但我认为这样做是错误的，因为它是实体，我在这里不需要它们。那么我应该把这些“服务”对象放在哪里呢？我是否必须创建一个继承自`Group`这样的新类：

```
public class GroupHelper : Group
{
    public bool HasChildGroups { get; set; }
    public int ChildGroupsCount { get; set; }
    public bool HasDeals { get; set; }
    public int DealsCount { get; set; }
} 
```

还是我应该考虑使用一些数据传输对象？你将如何解决这个问题？任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T16:44:05.997

要问的第一个问题是如何`GroupHelper`管理提议对象的状态。HasChildGroups 之类的属性似乎会因在`Group`实体上调用的行为而改变。如果是这样，那么它们应该是您的域模型中的一流实体，也许是组实体本身的事件部分。如果属性是在您的域模型之外管理的，那么您可以像查询任何其他外部数据源一样查询该数据。我希望这是一个独立的对象，可能称为`GroupInfo`不扩展 Group 本身。

这里的问题似乎是您的查询要求与实体的形状不符。在这种情况下，您可以灵活地将[读取模型](http://gorodinski.com/blog/2012/04/25/read-models-as-a-tactical-pattern-in-domain-driven-design-ddd/)与域模型分离。读取模型旨在满足查询要求，您的域模型旨在托管与您的域相关联的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T16:50:19.547

> HasChildGroups [...] 在我看来就像“服务”或“帮助”属性 [...] 但我认为这样做是错误的，因为它是实体，我在这里不需要它们。

如果你认为你的`Group`对象是一个数据访问对象，并且你有一个单独的模型，比如 viewdata，那么你是对的。

但这也可能是一个胖类，提供特定于视图和特定于*数据库*的代码。这不是完全错误的。

您确实可以创建一个`GroupDTO`类来提供您在应用程序中需要的属性，但不能用于数据访问，以分离关注点。

# asp.net-mvc - ASP.net MVC DisplayNameFor 视图中的嵌套模型

> ID：13476724
> 
> 赞同：0
> 
> 时间：2012-11-20T15:40:42.560
> 
> 标签：asp.net-mvc, model, controller

我的 ASP.net MVC 项目中有一个视图，它与控制器 (SubmissionController) 和类 (Submission) 相关联。

在视图中，我使用以下方法显示类中的一些值：

```
@Html.DisplayFor(Function(model) model.Created) 
```

这完美地工作，但我现在想要实现的是能够获得嵌套在我上面引用的模型中的集合的显示名称。

使这一点更清楚；我正在视图中查看多个提交的单个提交（使用 SubmissionController 的详细信息功能）。每个提交都有许多照片，我想在提交详细信息视图中显示这些照片以及提交详细信息本身。

为了显示照片，我有以下代码创建一张照片表......

```
 <tbody>
            @For Each item In Model.Photos
                Dim currentItem = item
                @<tr>
                    <td>
                        @Html.DisplayFor(Function(modelItem) currentItem.Photo_ID)
                    </td>
                    <td>
                        @Html.DisplayFor(Function(modelItem) currentItem.Photo_Status1.Value)
                    </td>
                    <td>
                        @Html.DisplayFor(Function(modelItem) currentItem.Photo_Size)
                    </td>
                    <td>
                        @Html.DisplayFor(Function(modelItem) currentItem.Photo_Taken)
                    </td>
                </tr>
            Next
        </tbody> 
```

虽然未经测试，但我相信上面的代码应该可以正常工作。

考虑到这一点，我到底如何获得 Photo 字段/属性的 DisplayNameFor 值？

这显然是行不通的！

```
@Html.DisplayNameFor(Function(model) model.Photos.Photo_Size) 
```

**顺便说一句，我不想​​手动写入标题名称，它们必须来自模型。**

## 回答

[DigitalD](https://stackoverflow.com/users/1649762/digitald)的答案几乎就在那里，这是解决方案。

```
@Dim photoModel = New Photo()
@Html.DisplayNameFor(Function(photoModelx) photoModel.Photo_ID) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T17:07:30.400

`@Html.DisplayNameFor(Function(model) model.Photos.Photo_Size)`将不起作用，因为`model.Photos`它可能`IEnumerable`没有 Photo_Size 属性。你可能会像这样传递一个空的模型项：

```
@Dim displayModel = new Photo()
@Html.DisplayNameFor(Function(displayModel) displayModel.Photo_Size) 
```

等等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:33:30.407

如果我理解正确，您正在尝试获取所显示字段的名称（“已拍摄照片”、“照片尺寸”等）？如果是这种情况，我建议使用 DataAnnotations 和 LabelFor(item=>item.Field)。我相信这会给你你正在寻找的东西。

# asp.net-mvc - 复杂对象的 ASP.NET MVC 3 模型绑定

> ID：13476726
> 
> 赞同：0
> 
> 时间：2012-11-20T15:40:49.660
> 
> 标签：asp.net-mvc, asp.net-mvc-3, model-binding

一般考虑复杂对象的 MVC 模型绑定。如果存在没有匹配表单值的属性，复杂对象的正常模型绑定会失败吗？

有人对模型绑定算法有简明的描述吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:52:49.213

当你有一个控制器参数是一个类时，`DefaultModelBinder`将尝试创建它的一个实例并用请求中的数据填充属性。

即使任何属性都没有单个值，它也会创建对象并将其传递给您的操作方法。

如评论中所述，您可以下载 MVC 框架的源代码（查找类`DefaultModelBinder`）或使用反射器之类的工具，因此请查看源代码。

如果您有特定问题，请发布一些代码。

# iphone - 导航控制器和 UITableView 方向问题

> ID：13476731
> 
> 赞同：0
> 
> 时间：2012-11-20T15:40:55.850
> 
> 标签：iphone, ios, uitableview, uinavigationcontroller, orientation

当我决定让我的应用程序与横向兼容时，我发现 UITableView 有一个奇怪的行为。

我有两个 UITableView 分别链接到 UITableViewControllers 和一些数据。我创建了一个链接到第一个 TVC 的导航控制器，并在 TVC 之间添加了一个 segue

我运行模拟器，出现第一个 tableview。我切换到横向模式并单击一行以查看第二个表格视图。我回到纵向模式，然后单击后退按钮。

当第一个tableview重新出现时，底部有一个奇怪的水平滚动，我可以移动tableview。似乎第一个 tableview 仍然相信处于 Landscape Mode ： ![http://i.imgur.com/wzmFQ.png](../Images/5a9d7807143d5147d6a373a6ec164a5d.png)

我在 viewWillAppear 中尝试了一些更改，但没有结果......

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:20:49.090

如果您在 UITableview 的后面有一个 UIScrollview，有时可能会发生这种情况。它与视图的旋转和自动布局有关。检查您是否正在设置 tableview 的框架或类似的东西。

# r - 无法加载 R lapack 例程

> ID：13476736
> 
> 赞同：4
> 
> 时间：2012-11-20T15:41:11.607
> 
> 标签：r, ubuntu-12.04, lapack

我通常使用像 gam() lm() 等使用 lapack 的例程在 R 中运行不同的统计分析，但是在多次更新库后出现以下错误：

```
library(mgcv)
This is mgcv 1.7-22\. For overview type 'help("mgcv-package")'.
model <- with(chlaR,gam(ClorMAX ~ s(DegDay_NM)))
Error en eigen(St, symmetric = TRUE) : 
lapack routines  cannot be loaded
Además: Mensajes de aviso perdidos
In eigen(St, symmetric = TRUE) :
  unable to load shared object '/usr/lib/R/modules//lapack.so':
  /usr/lib/R/modules//lapack.so: undefined symbol: dpstrf_ 
```

版本信息为：

```
platform       i686-pc-linux-gnu            
arch           i686                         
os             linux-gnu                    
system         i686, linux-gnu              
status                                      
major          2                            
minor          15.2                         
year           2012                         
month          10                           
day            26                           
svn rev        61015                        
language       R 
```

我正在使用 Ubuntu 12.04.1 LTS

更新：我检查了 lapack.so 库

```
leonardo@LyP:~$ ldd  /usr/lib/R/modules/lapack.so
linux-gate.so.1 =>  (0x009ec000)
libR.so => /usr/lib/libR.so (0x0023a000)
liblapack.so.3gf => /usr/lib/liblapack.so.3gf (0x00ba3000)
libblas.so.3gf => /usr/lib/libblas.so.3gf (0x00186000)
... 
```

检查对象

```
leonardo@LyP:~$ R CMD objdump -T /usr/lib/liblapack.so.3gf|grep dpstrf
00327f10 g    DF .text  000024d4  Base        dpstrf_ 
```

但

```
R CMD ldd /usr/lib/R/modules/lapack.so
linux-gate.so.1 =>  (0x009f5000)
libR.so => /usr/lib/R/lib/libR.so (0x00110000)
liblapack.so.3gf => /usr/lib/R/lib/liblapack.so.3gf (0x009f6000)
libblas.so.3gf => /usr/lib/R/lib/libblas.so.3gf (0x11eef000) 
```

R 链接到另一个库并搜索对象：

```
leonardo@LyP:~$ R CMD objdump -T /usr/lib/R/lib/liblapack.so.3gf|grep dpstrf 
```

给空

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-10T15:11:01.523

我有同样的问题，我跟踪它与革命 mkl 包的冲突

```
sudo apt-get remove revolution-mkl 
```

解决了问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-25T16:13:52.280

我使用突触卸载 R 并标记所有 r-base 和 r-cran 包，重新安装它

```
sudo apt-get install r-base r-base-dev r-base-html 
```

就是这样，一切正常。

感谢所有的评论者！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T21:52:55.590

你的`mgcv`包裹是从哪里来的？CRAN 作为来源？CRAN 作为`r-cran-mgcv`通过迈克尔重建我的 Debian 软件包的方式？

在我的 Ubuntu 机器上，使用 CRAN 上的标准 Ubuntu 存储库，一切都很好：

```
edd@max:~$ ldd /usr/lib/R/library/mgcv/libs/mgcv.so 
        linux-vdso.so.1 =>  (0x00007ffff43ff000)
        liblapack.so.3gf => /usr/lib/liblapack.so.3gf (0x00007f0374f75000)
        libblas.so.3gf => /usr/lib/libblas.so.3gf (0x00007f0373ad6000)
        libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f03737d9000)
        libR.so => /usr/lib/libR.so (0x00007f0373215000)
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f0372e56000)
        libgfortran.so.3 => /usr/lib/x86_64-linux-gnu/libgfortran.so.3 (0x00007f0372b3e000)
        libgcc_s.so.1 => /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007f0372928000)
        libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f037270b000)
        libreadline.so.6 => /lib/x86_64-linux-gnu/libreadline.so.6 (0x00007f03724c8000)
        libpcre.so.3 => /lib/x86_64-linux-gnu/libpcre.so.3 (0x00007f037228b000)
        liblzma.so.5 => /usr/lib/x86_64-linux-gnu/liblzma.so.5 (0x00007f0372069000)
        libbz2.so.1.0 => /lib/x86_64-linux-gnu/libbz2.so.1.0 (0x00007f0371e58000)
        libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007f0371c41000)
        librt.so.1 => /lib/x86_64-linux-gnu/librt.so.1 (0x00007f0371a39000)
        libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f0371834000)
        libgomp.so.1 => /usr/lib/x86_64-linux-gnu/libgomp.so.1 (0x00007f0371626000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f0375de2000)
        libquadmath.so.0 => /usr/lib/x86_64-linux-gnu/libquadmath.so.0 (0x00007f03713f0000)
        libtinfo.so.5 => /lib/x86_64-linux-gnu/libtinfo.so.5 (0x00007f03711c8000)
edd@max:~$ 
```

和

```
edd@max:~$ R

R version 2.15.2 (2012-10-26) -- "Trick or Treat"
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

R> library(mgcv)
This is mgcv 1.7-22\. For overview type 'help("mgcv-package")'.
R> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-15T14:31:51.007

我有一个类似的问题，因为我只用 sudo 开始 R 解决了它。

# jquery - 使用 jquery 脚本作为函数

> ID：13476737
> 
> 赞同：2
> 
> 时间：2012-11-20T15:41:15.803
> 
> 标签：jquery, function

我想将此脚本用作函数：

```
jQuery(function ($) {
    var kkeys = [],
        login = '76,79,71,73,78'; //login
    $(document).keydown(function (e) {
        kkeys.push(e.keyCode);
        if (kkeys.toString().indexOf(login) >= 0) {
            $(document).unbind('keydown', arguments.callee);
            return hs.htmlExpand(this, {
                contentId: 'highslide-html-loginform',
                wrapperClassName: 'mod_cdlogin',
                outlineType: 'rounded-white',
                align: 'auto',
                anchor: 'auto',
                dimmingOpacity: 0,
                slideshowGroup: 'mod_cdlogin_loginform'
            })
        }
    });
}); 
```

因此，我可以在我的 js 部分中使用此代码来调用另一个文件中的函数，例如`codelogin('mycode')`，在这种情况下，“mycode”将是 76、79、71、73、78。我尝试了很多东西，但它不起作用。脚本本身工作正常，但我不习惯使用 jQuery，所以这可能是我的问题，我寻找了一种方法来做到这一点，但我有点迷失了。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:43:44.760

您可以将代码放入函数中并从文件的其他脚本块中调用它。

```
<script>

jQuery(function($){

    function YourFunName(myCode){
    {
    var kkeys = [];     
    login = myCode;//login
    $(document).keydown(function(e)
    {
    kkeys.push( e.keyCode );
    if( kkeys.toString().indexOf( login ) >= 0 )
    {
    $(document).unbind('keydown',arguments.callee);
    return hs.htmlExpand(this, { contentId: 'highslide-html-loginform', wrapperClassName: 'mod_cdlogin', outlineType: 'rounded-white', align: 'auto', anchor: 'auto', dimmingOpacity: 0, slideshowGroup: 'mod_cdlogin_loginform' })
    }
    });
    }

     YourFunName('76,79,71,73,78');
});

</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T16:04:21.387

您的代码几乎就在那里。这是我能够完成的一个实现，它接受一个代码，在本例中是字符串“jonathan”，一个回调函数和一个可选的操作元素。默认情况下，`document`如果没有请求其他选项，代码将绑定到对象：

```
// When 'jonathan' is entered, fire off alertSuccess
bindcode ("jonathan", alertSuccess);

// Our callback function
function alertSuccess () {
    alert("You did it!");
}

// The bindcode function takes a code, a callback, and an optional element
function bindcode( code, callback, element ) {
    var input = [];
    // When the keypress event occurs on either your element, or the document
    $(element || document).on("keypress", function(e){
        // Push the new character onto the input array
        input.push(String.fromCharCode(e.which));
        // Convert to a string and check for presence of code
        if (input.join("").indexOf(code) > -1) {
            // Unbind the keypress event, and fire off callback
            $(this).off("keypress");
            callback();
        }
    });
} 
```

演示：http: [//jsfiddle.net/rQU4A/](http://jsfiddle.net/rQU4A/)

# android - 在 Android 平板电脑上查找电池电流 (mA/mAh)

> ID：13476738
> 
> 赞同：3
> 
> 时间：2012-11-20T15:41:19.020
> 
> 标签：android, tablet, battery

我正在创建一个应用程序，我需要能够获得电池的电流 (mA/mAh)。我有电压/温度/电平等，这是我需要得到的最后一件事，巧合的是，也是最难的。

我查看了 CurrentWidget[源代码](https://play.google.com/store/apps/details?id=com.manor.currentwidget&hl=en)并在谷歌上下搜索，我拥有所有的类/方法来提取数据，它只是包含当前阻止我获取它的文件的路径。

“CurrentWidget”包含许多不同的文件路径（适用于各种设备），但它们都不能在我的 4.0.3 上的 ASUS EEPad Transformer 上工作，我需要它来工作，因为它是我的测试设备，我能得到的我的手。我已经进入 adb shell 并在平板电脑的根部挖了几个小时，但除了我已经拥有的名称、温度、电压_now 和其他东西之外，我似乎找不到任何东西。它们都存储在 /sys/class/power_supply/battery 中，但没有我预期的“电流”，而且似乎在其他设备上。

感谢您的帮助，我知道这很长！

# android - 如何使 Web 服务安全

> ID：13476741
> 
> 赞同：0
> 
> 时间：2012-11-20T15:41:26.663
> 
> 标签：android, vb.net, web-services, security, wcf-security

我创建了一个使用 Web 服务的 android 应用程序（我使用 vb.net 来开发它）。这些 Web 服务驻留在我的服务器上（我使用 IIS）。如果我打开与这些 WS 关联的 HTTP 路径，我可以自由使用它。但是通过这种方式，任何其他用户都可以使用我的 WS。我怎样才能使它安全？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:45:31.923

我将从客户端身份验证证书开始。这样，如果您没有证书，则无法进入。并且使用 https 而不是 http。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:45:35.870

我能想到的基本方法是从你的应用程序中设置一个“密码”或一个字符串，加盐和加密，以防有人试图直接从应用程序解密它，并对 Web 服务进行检查，然后只运行该服务如果密码匹配。

无论如何，如果您使用的信息是敏感信息并且您想让它真正安全，也许您会考虑使用 HTTPS/SSL 来避免嗅探。

# database - 数据库引擎设计

> ID：13476745
> 
> 赞同：0
> 
> 时间：2012-11-20T15:42:05.103
> 
> 标签：database, database-design, sequence-diagram

我的任务是设计一个数据库引擎。我根本不需要实现代码，只需要设计（伪代码、序列图等）。我已经获得了这些方法，并且正在寻找任何帮助以进一步了解我在做什么。以下是我到目前为止所得到的，非常感谢任何帮助。这是一个家庭作业，不是在寻找任何答案，只是更深入地了解如何更好地理解设计这个软件。

> 数据库方法：
> 
> static void createDB(String dbName)：
> 在磁盘上新建一个文件夹（即：存储为c:/dbName）这个文件夹将是数据库的根；里面将包含表和索引>（文件）
> 
> static void deleteDB(String dbName):
> for(FolderName in disk folder (c:/) ) if(folderName == dbName) 从磁盘中删除
> 
> 静态数据库 openDB(String dbName)
> 
> 无效关闭数据库（）
> 
> Table createTable(String tableName, long recordSize):
> 在数据库文件夹 tableName 中创建新文件 在存储记录大小的文件中创建标题 此文件是一个字节数组，记录大小将告诉我存储在 >此表中的对象有多大是。（即：如果文件总共有 105 个字节。我知道我的标题是 5 个字节，所以标题（15、25、35 ...）之后的每 >10 个字节都是我表中的一个对象
> 
> Table getTable(String tableName)
> 在数据库文件夹中，遍历每个文件 If(file name == tableName) Return Table(file)
> 
> void deleteTable(String tableName)
> 在数据库文件夹中，遍历每个文件 if(file name == tableName) remove table(file)
> 
> 索引创建索引（字符串索引名称）
> 
> 索引获取索引（字符串索引名称）
> 
> 无效删除索引（字符串索引名称）
> 
> 表方法：
> 
> long getRecordSize()
> 表是一个文件 (byte[]) 文件的第一行 (byte[0]) 是包含 recordSize 的 header 返回 recordSize
> 
> 表文件头中的long addRecord(byte[] record)
> 获取记录大小和文件中对象的数量 将记录写入文件中的位置 (spot = (# of objects already in file * record size) >+ header size。 （即：如果标头大小 = 5 字节，记录大小 = 10 字节，并且我已经在 >file 中有 7 个对象......下一个对象将添加到点 (7 * 10) + 5 = 75 ）
> 
> 无效删除记录（长主键）
> 
> byte[] getRecord(long primaryKey)
> 
> void updateRecord(long primaryKey, byte[] 记录)
> 
> 无效关闭（）
> 
> 索引方法：
> 
> void addKey(字符串键，长值)
> 
> IteratorgetValues(String startKey, String endKey)
> 
> 长删除键（字符串键）
> 
> void updateKey（字符串键，长值）
> 
> 无效关闭（）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:54:14.120

首先你必须明白，这些方法都是外部接口。您可能会在幕后做更多的事情（在它们自己的线程中生成长期或短期的对象，拥有实用程序库等等）。

首先以类图或其他方式对您拥有的东西进行建模。然后尝试了解接口将如何使用（也许通过编写一些详细的用例？）。我发现[CRC 卡](http://en.wikipedia.org/wiki/Class-responsibility-collaboration_card)在这一步非常有用，因为它们可以轻松移动东西，一次查看单个类等等。

当你了解系统后，试着弄清楚你需要什么后端功能和功能，用新的类扩展你的类图，直到你涵盖了所有内容。

从序列图开始时，请准备好进行更改。在剩下的工作中，您可能会很好地发现初始模型的问题，解决这些问题通常比试图解决它们/忽略它们更有用。

# objective-c - 在浮点数中获取小数点后的部分

> ID：13476747
> 
> 赞同：1
> 
> 时间：2012-11-20T15:42:14.533
> 
> 标签：objective-c

有没有办法“拆分”一个浮点数，所以我得到小数点**前的值和小数点****后**的值？

```
float myVal = 1.234;
// how to get .234 and 1 
```

我看到了另一个例子，但它是用 Java 编写的，我不知道如何在 Objective-C 中做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:44:26.213

您可以使用[modf](http://www.cplusplus.com/reference/clibrary/cmath/modf/)功能：

```
float intPart = 0;
float fractPart = modf(myVal, &intPart); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:45:17.920

```
#include <math.h>

float myVal = 1.234f;

int wholePart = (int)myVal;
float fractionalPart = fmodf(myVal, 1.0f); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T16:06:09.263

```
int   wholePart = (int) myVal;
float fractionalPart = myVal - wholePart; 
```

我相信在 math.h 中有很多你可以滥用的函数。

# nltk - 当我在 NLTK 中尝试 FreqDist() 时收到错误消息 -- NameError: name 'nltk' is not defined

> ID：13476748
> 
> 赞同：7
> 
> 时间：2012-11-20T15:42:15.133
> 
> 标签：nltk

我正在学习 NLTK，我的 mac 工作正常，除了 FreqDist() 有问题。（我看到另一个关于 FreqDist() 的问题，但他收到了不同的错误消息。TypeError: unhashable type: 'list'）这是一个例子：

```
>>> from nltk.corpus import brown
>>> news_text = brown.words(categories='news')
>>> fdist = nltk.FreqDist([w.lower() for w in news_text])

Traceback (most recent call last):

`  File "<stdin>", line 1, in <module>`
`NameError: name 'nltk' is not defined` 
```

此错误消息非常一致。每次尝试 FreqDist() 时都会收到此消息。其他命令，如 - >>> brown.fileids() 很好。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-21T13:06:10.333

在您可以使用 FreqDist 之前，您需要将其导入。

添加一行如下：

```
import nltk 
```

或者如果你只是想使用 FreqDist 你应该试试这个：

```
>>> from nltk.corpus import brown
>>> from nltk import FreqDist
>>> news_text = brown.words(categories='news')
>>> fdist = FreqDist([w.lower() for w in news_text]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-22T11:27:00.980

which means you haven't installed nltk. follow these steps to install nltk:

1:go to this link https://pypi.python.org/pypi/setuptools at the end of page you find setuptools-7.0.zip (md5) download it, then unzip it. you can find easy_install.py python script.

2:use the command sudo easy_install pip. By this time pip will be installed ready to use, (make sure you are in the directory where you can find easy_install script file).

3:use this command sudo pip install -U nltk. successful execution ensure that nltk is now installed.

4:open the IDLE then you type the following:

> > > import nltk

if nltk is installed properly then you will be returned with console.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-17T06:38:06.017

nltk 需要您首先下载的数据。然后运行以下代码：

```
import nltk
nltk.download('stopwords')

from nltk.corpus import stopwords
stopwords.words("english") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-14T17:55:03.053

旧版本的 Python 需要 setuptools。如果您运行的是 3.2+，则不需要相同的内容您可以从[https://pypi.python.org/pypi/nltk轻松下载相同内容](https://pypi.python.org/pypi/nltk)

有关[http://www.nltk.org/install.html的更多信息](http://www.nltk.org/install.html)

# curl - 设计如何支持 CURL -u user:pwd 身份验证？

> ID：13476749
> 
> 赞同：1
> 
> 时间：2012-11-20T15:42:16.940
> 
> 标签：curl, devise

我的应用程序使用了 Devise，并且 API 想要支持 cURL 来像[BaseCamp API一样进行测试](https://github.com/37signals/bcx-api#making-a-request)

```
curl -u username:password https://app.com/api/v1/test.json 
```

我知道如何使用令牌进行身份验证，但我想使用**-u 用户名：密码**进行身份验证并直接返回 json。如何实现？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T11:38:17.847

这与 Devise 无关，Rails 很容易做 HTTP Basic 和 Digest 认证。[HttpAuthentication](http://api.rubyonrails.org/classes/ActionController/HttpAuthentication/Basic.html)

```
curl -u username:password https://app.com/api/v1/test.json 
```

用户名和密码可以传递给以下代码中的 'u','p' 参数：

```
user = authenticate_with_http_basic { |u, p| User.authenticate(u, p) } 
```

# winapi - 防止编辑控件呈现

> ID：13476750
> 
> 赞同：0
> 
> 时间：2012-11-20T15:42:27.913
> 
> 标签：winapi

我有一个编辑控件，我想禁用任何渲染，但将其保留为交互式（类似于所有者绘制的控件）。现在，我已经对 Window 进行了子类化并捕获了 WM_PAINT，例如

```
SetWindowSubclass(box, [](HWND hwnd, UINT msg, WPARAM wparam, LPARAM lparam, UINT_PTR, DWORD_PTR) -> LRESULT {
    if (msg != WM_PAINT)
        return DefSubclassProc(hwnd, msg, wparam, lparam);
    PAINTSTRUCT paint;
    BeginPaint(hwnd, &paint);
    EndPaint(hwnd, &paint);
    return 0;
}, 0, 0); 
```

这可以很好地禁用几乎所有编辑框的渲染。但是，当与它交互时，它仍然偶尔会清除它要渲染的区域，当我在该空间中使用 Direct3D 进行渲染时会导致空域问题。

如何完成子类以使编辑框永远不会呈现任何内容？

# jgit - 如何使用 jgit 执行相当于“git repack -ad”的操作？

> ID：13476755
> 
> 赞同：0
> 
> 时间：2012-11-20T15:42:45.973
> 
> 标签：jgit

我已经实现了一个`DfsRepository`使用 jgit-2.0.0.201206130900。它很好用，但我想重新打包它，这样我只有一个打包文件。我如何通过 jgit 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:25:46.617

得到这个工作。`DfsGarbageCollector`基本上相当于`repack -d`. 要获得`repack -a`行为，请使用`DfsPackCompactor`：

```
void repack(DfsRepository repo) throws IOException {
    DfsGarbageCollector gc = new DfsGarbageCollector(repo);
    gc.pack(null);

    // update the list of packs for getPacks() below
    // otherwise not all packs are compacted
    repo.scanForRepoChanges();

    // only compact if there are multiple pack files
    DfsPackFile[] packs = repo.getObjectDatabase().getPacks();

    if (packs.length > 1) {
        DfsPackCompactor compactor = new DfsPackCompactor(repo);

        for (DfsPackFile pack : packs) {
            compactor.add(pack);
        }

        compactor.compact(null);
    }
} 
```

这还不是全部。

`DfsGarbageCollector`为垃圾创建一个单独的包文件。

`DfsOutputStream`我发现“删除”垃圾包文件的最简单方法是从我的实现中返回一个，`DfsObjDatabase.writePackFile()`如果包文件的源是`PackSource.UNREACHABLE_GARBAGE`.

# php - 将 PHP 变量传递给 jQuery 整数

> ID：13476759
> 
> 赞同：1
> 
> 时间：2012-11-20T15:42:53.713
> 
> 标签：php, javascript, jquery

基本上我或多或少知道该怎么做，但想知道是否有更好的方法？

我在 PHP 中有以下变量

```
$day; $month; $year; 
```

上面的那些具有爆炸 php 日期字符串的值。

下面是 PHP 插件函数，它说明了倒计时的日期。

```
<script type="text/javascript">
$(function () {
    var austDay = new Date();   
    austDay = new Date(2013, 12, 22);
    $('#defaultCountdown').countdown({until: austDay});
});
</script> 
```

我想将日期日/月/年变量从 PHP 传递到该函数中，当我尝试附加到 javavariable 并将该变量代替日期部分时，我该怎么做？

感谢所有帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:44:55.983

```
var day  = <?php echo $day ?>; 
var month = <?php echo $month ?>; 
var year = <?php echo $year ?>;

$(function () {
    var austDay = new Date();   
    austDay = new Date( year, month, day );
    $('#defaultCountdown').countdown({until: austDay});
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:48:38.427

有几种方法可以剥皮。

*   通过 $.ajax 获取值，php 将值作为 jsonified 数组返回（echo json_encode($my_values)）
*   如果生成 html 的页面是 php 页面，那么只需 new Date();
*   将值放入页面上任何位置的隐藏表单字段或页面上相关对象的数据日、数据月、数据年属性中，并使用 jquery 获取值
    *   day = $('#hiddenfield_day').val(); //将var day放入新日期的day字段等

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:45:35.720

更改此行：

```
austDay = new Date(<?= $year ?>, <?= $month ?> , <?= $day ?>); 
```

也就是说，请记住 Javascript 的[`new Date()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)月份参数采用 0 - 11 范围内的数字。

# c - 函数指针和空指针

> ID：13476762
> 
> 赞同：0
> 
> 时间：2012-11-20T15:42:58.010
> 
> 标签：c, embedded, function-pointers

我正在为嵌入式系统编写代码。编译器是 GCC 衍生产品。下面的代码是否正确？

```
void *voidPointer = 0;
int (*functionPointer)(int a);

int testFunction(int a)
{
   return(a+1);
}

void registerFunction(void *pvFunctionAddress)
{
   voidPointer = pvFunctionAddress;
}

main()
{
   ...
   registerFunction(testFunction);
   functionPointer = voidPointer;
   x = functionPointer(17);
   ...
} 
```

现在 x 的值应该是 18。编译器没有显示错误 - 但这是正确的吗？或者我们是否覆盖了堆栈上的一些内存。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:45:00.083

不，它永远不可能是“正确的”，因为严格来说 C 禁止`void *`函数指针和函数指针之间的转换。

如果它有效，那是因为特定的编译器允许它用于特定的目标（操作系统+硬件组合）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T15:45:41.643

严格来说，根据 C 标准，`void*`不能保证 a 能够持有函数指针。我相信 POSIX 确实要求函数指针能够存储在 a`void*`中（以支持该`dlsym()`函数）。见[https://stackoverflow.com/a/12359083/12711](https://stackoverflow.com/a/12359083/12711)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T16:06:51.187

让我们这样说：

在 C 中，函数由开始执行它的相应程序集中的第一条指令的地址和它的调用约定来标识，因此`void*`如果调用约定是编译时常量，则 a 是一个有效的存储类来存储它。对于最常用的 CPU 架构，它是。

如果您的代码适用于您的目标硬件的编译器，那么它在这个意义上是正确的。

这是一个简单的比较：

```
uintptr_t i = NULL; 
```

是有效的 C，因为`uintptr_t`(通常) 与(type of )`unsigned long int`是相同的存储类。`void *``NULL`

# windows - 双击选择带连字符的单词

> ID：13476764
> 
> 赞同：2
> 
> 时间：2012-11-20T15:43:09.683
> 
> 标签：windows, google-chrome, windows-7

更新：根据下面的建议，这就是我想做的事情：如果我双击鼠标光标从“蓝绿色”的“b”到“n”的任何地方，我想要所有单词“蓝绿色”应突出显示。如何才能做到这一点？目前，根据您单击的位置，它将“蓝绿色”视为三个单独的字符串。因此，如果您在“blue”的“b”和“e”之间双击，它只会突出显示“blue”而不是“-green”。如果双击连字符，它会单独突出显示连字符。如果您在“green”的“g”和“n”之间双击，它只会突出显示“green”而不是“blue-”。

ORIGINAL：当我双击一个带连字符的单词或一组字符（例如“123-abc”或“blue-green”等）时，只有我双击的单词部分被突出显示。我想突出显示整个单词。

我正在使用 Windows 7 专业版。如果需要在每个应用程序的基础上完成，我最感兴趣的是为 Google Chrome 修复它，但任何与 Windows 兼容的网络浏览器都可以。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-08-17T20:38:22.690

老问题，但我碰巧一直在研究同样的问题。这是我的解决方案：

[jsFiddle.net](https://jsfiddle.net/avvhsruu/)

```
"use strict"

// Tweak to make a double-click select words with hyphens
// 
// As of 2016-0816, None of the major Mac browser selects whole words
// with hyphens, like "ad-lib". This tweak fixes the hypen issue.
// 
// Note: Firefox 48.0 doesn't automatically select whole words with 
// apostrophes like "doesn't". This tweak also treats that.

;(function selectWholeWordsWithHyphens(){
  var pOutput = document.getElementById("output")
  var selection = window.getSelection()
  // Regex designed to find a word+hyphen before the selected word.
  // Example: ad-|lib|
  // It finds the last chunk with no non-word characters (except for
  // ' and -) before the first selected character. 
  var startRegex = /(\w+'?-?)+-$/g
  // Regex designed to find a hyphen+word after the selected word.
  // Example: |ad|-lib
  var endRegex = /^-('?-?\w+)+/
  // Edge case: check if the selection contains no word
  // characters. If so, then don't do anything to extend it.
  var edgeRegex = /\w/

  document.body.ondblclick = selectHyphenatedWords

  function selectHyphenatedWords(event) {
    if (!selection.rangeCount) {
      return
    }
    var range = selection.getRangeAt(0)
    var container = range.startContainer
    var string = container.textContent
    var selectionUpdated = false

    if (string.substring(range.startOffset, range.endOffset)
              .search(edgeRegex) < 0) {
      // There are no word characters selected
      return
    }

    extendSelectionBackBeforeHypen(string, range.startOffset)
    extendSelectionForwardAfterHyphen(string, range.endOffset)

    if (selectionUpdated) {
      selection.removeAllRanges()
      selection.addRange(range)
    }

    function extendSelectionBackBeforeHypen(string, offset) {
      var lastIndex = 0
      var result
        , index
      string = string.substring(0, offset)

      while (result = startRegex.exec(string)) {
        index = result.index
        lastIndex = startRegex.lastIndex
      }

      if (lastIndex === offset) {
        range.setStart(container, index)
        selectionUpdated = true
      }
    }

    function extendSelectionForwardAfterHyphen(string, offset) { 
      if (!offset) {
        return
      }

      string = string.substring(offset)
      var result = endRegex.exec(string)

      if (result) {
        range.setEnd(container, offset + result[0].length)
        selectionUpdated = true
      }
    }
  }
})() 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-20T20:26:14.243

这是所有程序的标准，因为它们都运行操作系统的输入配置/程序。要修复它，您需要在 System32 中做一些事情。我不知道你需要做什么，但我怀疑这是你的问题。您可能应该更详细地了解您想要的具体内容。

# html - 在wordpress中将表格宽度与td匹配

> ID：13476769
> 
> 赞同：0
> 
> 时间：2012-11-20T15:43:28.930
> 
> 标签：html, css, html-table

我正在使用 WP e-Commerce 在 Wordpress 中进行一些样式设计，并且在结帐页面中有一个表格，其中表格标题都左对齐，而不是每个列的宽度。当我在没有 CSS 的情况下尝试 HTML 代码时，它工作得相当好，但是应用了太多的 CSS，以至于我无法确切地弄清楚是什么导致了它。

请参阅下面有问题的 HTML 代码。

关于如何找到罪魁祸首的任何想法？

```
<table class="checkout_cart">
    <tbody>
        <tr class="header">
            <th colspan="2">Product</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Total</th>
            <th>&nbsp;</th>
        </tr>
        <tr class="product_row product_row_0 alt">
            <td class="firstcol wpsc_product_image wpsc_product_image_0">   <img src="31x31.jpg" alt="Spreading the Light" title="Light" class="product_image">   </td>
            <td class="wpsc_product_name wpsc_product_name_0">  <a href="http://hailefinephotography.com/products-page/inner-aperture-fine-art-note-cards/spreading-the-light/">Spreading the Light</a>  </td>
            <td class="wpsc_product_quantity wpsc_product_quantity_0">
                <form action="/store/checkout/" method="post" class="adjustform qty">  
                    <input type="text" name="quantity" size="2" value="1">  
                    <input type="hidden" name="key" value="0">  
                    <input type="hidden" name="wpsc_update_quantity" value="true">  
                    <input type="submit" value="Update" name="submit">  
                </form>
            </td>
            <td><span class="pricedisplay">$5.00</span></td>
            <td class="wpsc_product_price wpsc_product_price_0"><span class="pricedisplay"><span class="pricedisplay">$5.00</span></span></td>
            <td class="wpsc_product_remove wpsc_product_remove_0">
                <form action="/store/checkout/" method="post" class="adjustform remove"> 
                    <input type="hidden" name="quantity" value="0">  
                    <input type="hidden" name="key" value="0">  
                    <input type="hidden" name="wpsc_update_quantity" value="true">  
                    <input type="submit" value="Remove" name="submit">  
                </form>
            </td>
        </tr>
    </tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:47:46.863

您有 5 个标题（th），但下面有 6 个列（td）

# java - Java 和 android XML 序列化器

> ID：13476774
> 
> 赞同：0
> 
> 时间：2012-11-20T15:43:49.103
> 
> 标签：java, android, xml

是否有一些类似于 Android 的 XmlSeializer 的 SAX 序列化程序可以在 Java 和 Android 中使用？我必须在 Java 项目和 Android 项目中使用一个库，并且我需要一些方法来从中序列化 XML。我使用 SAX 序列化，因此不适合 dom4j 之类的工具（据我所知）。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:48:27.017

是的，我推荐[XMLPullParser](http://www.xmlpull.org/)

您可以使用它来解析和序列化 XML。我也发现它更快。

这是它的[Android文档](http://developer.android.com/reference/org/xmlpull/v1/XmlPullParser.html)。

[序列化程序文档](http://developer.android.com/reference/org/xmlpull/v1/XmlPullParserFactory.html#serializerClasses)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:50:05.700

[XStream](http://xstream.codehaus.org/)被认为可以在 Android 上运行，我知道它可以在 Java 中运行。例子：

```
@XStreamAlias("blah")
class Foo {
   @XStreamAsAttribute
   public String baz = "Stack";
} 
```

现在：

```
XStream xstreamInstance = new XStream();
xstreamInstance.processAnnotations(Foo.class);
System.err.println(xstreamInstance.toXML(new Foo()); 
```

会打印出来...

```
 <blah baz="Stack"/> 
```

# javascript - 定价最小到最大下拉菜单的相关下拉菜单

> ID：13476780
> 
> 赞同：2
> 
> 时间：2012-11-20T15:44:08.937
> 
> 标签：javascript, drop-down-menu, dependencies

我在这里跟踪的时间比我记得的要长，这是我的第一篇文章，所以我希望我做对了。我希望能够有一个最低和最高价格下拉菜单，并且当有人选择最低价格时，它会使用所选的最小值自动更新最高价格。到目前为止，这是我的代码......（取自其他人之前的帖子，但我可以让它正常工作。它在理论上工作，但如果我选择说 90,000.00 英镑，它会删除包含小于 9 的数字的所有内容.

我想我需要知道如何让 Javascript 将其视为数字/数字，因此它知道 110000 高于 90000

```
$(window).load(function(){
var maxprice = $('#maxprice').html();
$('#minprice').change(function() {
$('#maxprice').html(maxprice);
$('#maxprice option').each(function() {
    if ($(this).val() <= $('#minprice').val()) $(this).remove();
});
});
});

<div><select name="minprice" class="searchboxes" id="minprice">
<option value="0">No Minimum</option>
<?php for ($n = 10000; $n <= 250000; $n += 10000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>        </option><?php  } ?>
<?php for ($n = 275000; $n <= 500000; $n += 25000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?>
<?php for ($n = 550000; $n <= 1000000; $n += 50000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?>
<?php for ($n = 1100000; $n <= 2500000; $n += 100000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?>
<?php for ($n = 3000000; $n <= 5000000; $n += 250000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?>
<?php for ($n = 5000000; $n <= 15000000; $n += 500000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?></select></div>

<div><select name="maxprice" class="searchboxes" id="maxprice">
<option value="0">No Maximum</option>
<?php for ($n = 10000; $n <= 250000; $n += 10000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?>
<?php for ($n = 275000; $n <= 500000; $n += 25000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?>
<?php for ($n = 550000; $n <= 1000000; $n += 50000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?>
<?php for ($n = 1100000; $n <= 2500000; $n += 100000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?>
<?php for ($n = 3000000; $n <= 5000000; $n += 250000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?>
<?php for ($n = 5000000; $n <= 15000000; $n += 500000) { ?>
<option value="<?php echo $n; ?>"><?php echo number_format($n, 2, '.', ','); ?>    </option><?php  } ?>
</select></div> 
```

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:47:15.683

试试[parseInt](http://www.w3schools.com/jsref/jsref_parseint.asp)

`if (parseInt($(this).val()) <= parseInt($('#minprice').val())) $(this).remove();`

# unicode - 为什么 Firefox 挤压了 Windows 的心脏，而不是 Ubuntu 的？

> ID：13476781
> 
> 赞同：1
> 
> 时间：2012-11-20T15:44:09.407
> 
> 标签：unicode, fonts, cross-browser, typography

我试图在这个[jsfiddle](http://jsfiddle.net/ytzRf/2/)中显示 heart ♥ Unicode 字符（U+2665 BLACK HEART SUIT） 。

即使我指定了`Droid Sans`字体，不同的浏览器也会以不同的方式显示相同的字符。因此，我假设该`Droid Sans`字体不包含 ♥ 字符，并且浏览器必须回退到其他字体才能显示该字符。但是浏览器如何确定 Unicode 字符使用哪种字体？事实证明（从屏幕截图中）它不是特定于操作系统的，因为 Ubuntu 上的 Firefox 和 Chromium 都以不同的方式显示它；而且它不是特定于浏览器的，因为 Firefox 在 Ubuntu 和 Windows 7 上的显示方式不同。

所以我的问题是——**浏览器如何确定使用哪种字体来显示 Unicode 字符？如何找出浏览器使用哪种字体来显示 Unicode 字符；以及如何确保跨浏览器的外观一致？**

**PS：**（Firefox 特定）即使`Droid Sans`不包含 ♥ 字符，Firefox 仅在所选字体为`Droid Sans`. 对于任何其他字体，Firefox 会选择`DejaVu Sans`字体来显示 ♥ 字符（在 Ubuntu 上，通过点击和试用确认）。

![在此处输入图像描述](../Images/91cf4dc172930e304f1e8224bb2ffab2.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T17:21:03.957

Droid Sans 字体不包含 U+2665 BLACK HEART SUIT，所以在这里声明字体是无关紧要的。我无法在您的“PS”中重现观察结果，所以我不想解释它。

（检查字体中字符覆盖率的一种快速方法是下载并安装[LastResort](http://www.unicode.org/policies/lastresortfont_eula.html)字体。它包含所有字符的通用、易于识别的渲染，因此通过`font-family: foo, LastResort`在测试文本上使用，您将快速找出特定字符是否存在于字体“foo”。）

备用字体的使用取决于浏览器。浏览器可能对此进行了设置。但关键是，作为作者，当您的字符无法在您指定的字体列表中找到时（如果已安装，则安装在用户的计算机中），您作为作者无法知道在其他人的浏览器上会发生什么。

# winapi - Windows 8 共享合同和剪贴板挂钩/拦截

> ID：13476783
> 
> 赞同：2
> 
> 时间：2012-11-20T15:44:18.763
> 
> 标签：winapi, windows-8, microsoft-metro, windows-runtime, hook

2个问题：

1) 是否可以连接到 Windows 8 Metro 中的 Share Broker，以便我能够编写一个程序，每次 Windows 8 应用程序与另一个 Windows 8 应用程序共享内容时都会调用该程序？例如，我想自动修改应用程序之间共享的文本内容。如果是这样，我想只有 Win32 API 才有可能，对吗？

2) Windows 8 Metro 中的剪贴板是否可以实现相同的功能？

我猜 WinRT 太沙盒了，无法编写这样一个全局拦截恶魔，但我可以想象在使用 Win32 时这是可能的......

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T19:25:55.127

尽管您可以使用 Win32 监视剪贴板，但无法（至少我知道）拦截共享。共享本身被认为是一种*合同*，而合同是两个应用程序之间甚至一个应用程序与外壳之间进行通信的唯一手段。允许另一个应用程序拦截并可能修改通过合约发送的数据可能会带来假冒、数据窃取等安全风险。

# java - 使用 java swing 更新 jtextpane

> ID：13476785
> 
> 赞同：1
> 
> 时间：2012-11-20T15:44:21.200
> 
> 标签：java, swing, jtextpane

我正在用 java swing 做一个应用程序。在应用程序的一个按钮中，我需要每隔 x 分钟做一些事情。我认为我必须用一个新线程来做，但我有两个问题。首先是我必须向这些线程传递一个参数。我用一个扩展线程和构造函数的类解决了它。我认为这些方式是正确的，不是吗？我无法解决的第二件事是我需要在线程运行时更新 jtextpane，但是如果我尝试更新 JTextPane 属性 Eclipse 说我无法解决。我认为问题在于这些线程不是主线程。但是……有办法解决吗？非常感谢和对不起我的英语！

代码是：

```
btnIniciar.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                //String file = "D:\\prueba.torrent";

        //  while (true) {
                Hilo ejecutar = new Hilo(listaBuscar);

                ejecutar.run();

public class Hilo extends Thread {

    public Hilo(List&lt;String&gt; aBuscar){            
    }
    public void run(){
        System.out.println("Trabajo por hacer dentro de MiHilo");
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
               lblNewLabel.setText("hola");

            }
        });
    }

} 
```

它说我 lblNewLabel 无法解决。

有什么帮助吗？谢谢

我现在正在尝试使用这些代码并且不起作用：

```
public class Hilo implements Runnable {

    private JLabel etiqueta;

    public Hilo (List <String> aBuscar, JLabel label){

        System.out.println("Hemos entrado en el puto hilo");
        etiqueta = label;

    }
    @Override
    public void run() {

          etiqueta.setText("hola");
          System.out.println("vamos a coneseguirlo");

        // TODO Auto-generated method stub
          SwingUtilities.invokeLater(new Runnable() {
              public void run() {
                 etiqueta.setText("hola");
                 System.out.println("vamos a coneseguirlo");

              }
          });

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:29:23.997

*   您`JTextPane`在问题标题中提到但仅提及`JLabel`?

虽然你看到的主要问题是你没有`JLabel`在你的线程范围内声明，你可以传递你的`JLabel`实例，它有一个方法来`JLabel`通过构造函数获取对你的线程的引用，因此它有一个引用的`JLabel`，现在它没有。

*   我也建议使用`SwingUtilities`而不是`EventQueue`
*   并且不要扩展`Thread`类（除非添加自定义功能）`implement`而是`Runnable`

就像是：

**GUI.java：**

```
 public class GUI {

        private JFrame frame;
        private JLabel label;
        private JButton btnIniciar;

       public void getJLabel() {
           return label;
       }

        public void initComponents() {
        //create UI and components here

        btnIniciar.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent arg0) {
                //String file = "D:\\prueba.torrent";
                Hilo ejecutar = new Hilo(listaBuscar,Gui.this);//pass reference of to our class

          }
      }

    } 
```

**希洛.java：**

```
 public class Hilo implements Runnable {

        private Thread t;
        private final GUI gui;

        public Hilo(List<String> aBuscar, GUI ui){      
             this.gui=ui;   
             t=new Thread(this);   
              startThread();
        }

        @Override
        public void run(){
            SwingUtilities.invokeLater(new Runnable() {
                public void run() {
                   gui.getJLabel().setText("hola");
                }
            });
        }
        //so we can start thread from other class
        public void startThread() {
           if(!t.isAlive()) //if the thread is not started alreade
           t.start();
        }
    } 
```

尽管取决于您在做什么，[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)可能是您所需要的，但它允许您以间隔/延迟运行代码，所有这些都已经在 EDT 上完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:59:03.970

使用[摇摆计时器](http://docs.oracle.com/javase/1.4.2/docs/api/javax/swing/Timer.html)。它非常像在给定间隔内定期按下的隐形按钮。它将调用您`actionPerformed`已经在 Swing 线程中的您可以操作组件的位置（与 相同`JButton` `ActionListener`）。因此，您很可能不需要为此任务运行自己的线程。

# java - Gson StackOverflowError

> ID：13476788
> 
> 赞同：4
> 
> 时间：2012-11-20T15:44:38.170
> 
> 标签：java, json, gson

我有一个简单的返回类，它要么接受异常，要么接受我们的业务对象之一。如果 REST Web 服务方法抛出异常，它会捕获它并在响应中设置异常。如果没有，它会在响应中设置返回值并将其序列化。

就我而言，我得到了一个 InvocationTargetError ，它包装了我们的一个服务异常。我在返回类的异常上设置了这个，并得到以下堆栈跟踪：

```
java.lang.StackOverflowError
com.google.gson.reflect.TypeToken.hashCode(TypeToken.java:280)
java.util.HashMap.get(HashMap.java:300)
java.util.Collections$SynchronizedMap.get(Collections.java:1975)
com.google.gson.Gson.getAdapter(Gson.java:337)
com.google.gson.internal.bind.TypeAdapterRuntimeTypeWrapper.write(TypeAdapterRuntimeTypeWrapper.java:55)
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.write(ReflectiveTypeAdapterFactory.java:89)
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.write(ReflectiveTypeAdapterFactory.java:195)
com.google.gson.internal.bind.TypeAdapterRuntimeTypeWrapper.write(TypeAdapterRuntimeTypeWrapper.java:68)
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.write(ReflectiveTypeAdapterFactory.java:89)
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.write(ReflectiveTypeAdapterFactory.java:195)
com.google.gson.internal.bind.TypeAdapterRuntimeTypeWrapper.write(TypeAdapterRuntimeTypeWrapper.java:68)
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$1.write(ReflectiveTypeAdapterFactory.java:89)
com.google.gson.internal.bind.ReflectiveTypeAdapterFactory$Adapter.write(ReflectiveTypeAdapterFactory.java:195)
and so on... 
```

有人有想法么？这看起来像 Gson 2.2.2 中的一个错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T00:29:43.790

Gson 无法处理序列化数据中的循环引用。很有可能你有一个。解决这个问题，你就解决了你的问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T16:51:24.520

我在谷歌代码网站上为此创建了一个问题。

[http://code.google.com/p/google-gson/issues/detail?id=488](http://code.google.com/p/google-gson/issues/detail?id=488)

# maven - Maven 不在辅助镜像中定位依赖项

> ID：13476790
> 
> 赞同：1
> 
> 时间：2012-11-20T15:44:40.977
> 
> 标签：maven

我有一个 maven 项目，它依赖于中央存储库，还有几个依赖于本地工件存储库。当我尝试运行`mvn rpm:rpm`与中央存储库相关的依赖项时，解决了与本地存储库相关的依赖项。

我的配置看起来像（示意图）：

```
<mirrors>
    <mirror>central</mirror>
</mirrors>
<profiles>
    <profile>
        <repository>local-repo1</repository>
        <repository>local-repo2</repository>
    </profile>
</profiles> 
```

# python - 在命令期间将日志记录重定向到控制台

> ID：13476791
> 
> 赞同：2
> 
> 时间：2012-11-20T15:44:42.597
> 
> 标签：python, django, logging

在我的 Django 应用程序中，我设置了日志记录以将所有级别记录到一个文件中，效果很好。

在管理命令期间（并且仅在那里），我也想将（某些级别）记录到控制台。

我如何（动态地）设置日志记录来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T10:20:57.430

这实际上很简单，我所要做的就是为我想要重定向的每个记录器添加一个新的处理程序：

```
loggernames = [ ... ]
level = logging.DEBUG
handler = logging.StreamHandler()
handler.setLevel(level)
handler.setFormatter(logging.Formatter('%(levelname)s: %(message)s'))

for name in loggernames:
    logging.getLogger(name).addHandler(handler) 
```

# coldfusion - 属性范围与属性结构

> ID：13476795
> 
> 赞同：2
> 
> 时间：2012-11-20T15:44:55.767
> 
> 标签：coldfusion, attributes, custom-tag

自定义标签具有属性范围。凉爽的。

我还看到了一些其他应用程序（可能还有 ColdBox？），开发人员将所有内容都放入属性结构中。例如在`login.cfm`：

`<cfparam name="attributes.username" default="some value">`

除了必须指定`attributes.foo`哪些确实提高了可读性之外，还有什么意义，我承认，但为什么要重用完整范围的名称？

这是个人偏好还是我错过了属性范围的一些深刻的东西？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T15:56:50.187

It's nothing profound. A lot of frameworks (and individual developers) like to combine the form and url scopes into a single "event" object or something (ala your "attributes" example), but it doesn't really buy you much.

That said, naming a new object after an existing scope is misguided, and I'd recommend against it. What happens when you want something out of the attributes scope, not the attributes object?

You could always reference the object via variables.attributes.foo for explicitness, but that's a pain and a bit ugly. And of course, nothing stops you from accessing the attributes scope (scope priority would check attributes before variables.attributes), but then the person that has to read the code after you is more confused. It's essentially created a problem instead of solving one.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T19:43:43.203

在 Fusebox 中，想法是单个文件可以用作框架的一部分，也可以用作 cfmodule 的一部分。corefiles/application.cfc 里面是：

```
...
<cfparam name="variables.attributes" default="#structNew()#" />
<cfif isDefined("URL")>
    <cfset structAppend(attributes,URL,true) />
</cfif>
<cfif isDefined("form")>
    <cfset structAppend(attributes,form,true) />
</cfif>
... 
```

详见[GitHub](https://github.com/fusebox-framework/Fusebox-ColdFusion/blob/master/corefiles/Application.cfc) _

# vb.net - “清除”组合框索引的正确方法是什么？

> ID：13476797
> 
> 赞同：1
> 
> 时间：2012-11-20T15:45:02.223
> 
> 标签：vb.net

```
Me.cmbSomeCombo.Text = ""
Me.cmbSomeCombo.SelectedIndex = -1 
```

**对比**

```
Me.cmbSomeCombo.SelectedIndex = -1
Me.cmbSomeCombo.Text = "" 
```

我遇到了设置原因的问题`Text`是否会改变？如果是这样，它将索引更改为什么？`ComboBox``SelectedIndex`

**或者**

设置`SelectedIndex`为 -1 会导致`Text`吗`""`？

我试图弄清楚哪种是“清除”所选索引的“正确”方法`ComboBox`。

**编辑**：`DropDownStyle`是. _`ComboBox``DropDown`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:53:05.997

要回答您的问题，是的，将所选索引设置为 -1 确实会导致组合框的文本为“”。这就是我测试它的方式

```
 Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
    ComboBox1.SelectedIndex = -1
    Dim string1 As String = ComboBox1.Text
End Sub 
```

在此过程结束时，string1 将等于“”。

# c# - 行未显示在 DataTable c#

> ID：13476800
> 
> 赞同：2
> 
> 时间：2012-11-20T15:45:06.420
> 
> 标签：c#

我正在尝试将数据从我的 datagridview 复制到数据表，以便我可以导出到 csv 文件

这是代码

```
public DataTable createdatatablefromdgv()
   {
       DataTable dsptable = new DataTable();

       for (int i = 0; i < dataGridView1.Columns.Count; i++)
       {
           DataColumn dspcolumn = new DataColumn(dataGridView1.Columns[i].HeaderText);
           dsptable.Columns.Add(dspcolumn);
       }
       int noOfColumns = dataGridView1.Columns.Count;
       foreach (DataGridViewRow dgvr in dataGridView1.Rows)
       {
           DataRow dataRow = dsptable.NewRow();

           for (int i = 0; i < noOfColumns; i++)
           {
               dataRow[i] = dgvr.Cells[i].Value.ToString();
           }

       }
       return dsptable;
   } 
```

似乎它将数据从网格复制到表但是当我返回数据表时，所有的列都没有行

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T15:47:12.270

在将值分配给其列后，您不会将 dataRow 添加到数据表中。

```
public DataTable createdatatablefromdgv()
{
   DataTable dsptable = new DataTable();

   for (int i = 0; i < dataGridView1.Columns.Count; i++)
   {
       DataColumn dspcolumn = new DataColumn(dataGridView1.Columns[i].HeaderText);
       dsptable.Columns.Add(dspcolumn);
   }
   int noOfColumns = dataGridView1.Columns.Count;
   foreach (DataGridViewRow dgvr in dataGridView1.Rows)
   {
       DataRow dataRow = dsptable.NewRow();

       for (int i = 0; i < noOfColumns; i++)
       {
           dataRow[i] = dgvr.Cells[i].Value.ToString();
       }
       dsptable.Rows.Add(dataRow); //Add this statement to add rows to Data Table

   }
   return dsptable;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:59:22.053

上面的答案是正确的，但对您遇到此问题的原因进行了一些解释。有人会认为，通过调用`NewRow()`你`DataTable`会添加一个新行`DataTable`，然后就可以访问它了。

实际上做的是给你`NewRow`一个实例，`DataRow`然后你可以使用列名作为列标识符（整数）的位置。

这允许你做这样的事情

```
DataRow dataRow = dsptable.NewRow();
foreach(DataColumn dc in dsptable.Columns)
{
   dataRow[dc.ColumnName] = dgvr.Cells[dc.ColumnName].Value.ToString()
} 
```

或者，您可以调用`Rows.Add()`which 需要一个对象数组或 a ，因为您正在尝试执行 a `DataRow`。

```
List<string> rowData = new List<string>();
for (int i = 0; i < noOfColumns; i++)
{
   rowData.Add(dgvr.Cells[i].Value.ToString());
}
dsptable.Rows.Add(rowData.ToArray()); 
```

这应该更简单地解释向数据表添加行:)

# python - python中直方图的概率密度函数以拟合另一个直方图

> ID：13476807
> 
> 赞同：8
> 
> 时间：2012-11-20T15:45:30.723
> 
> 标签：python, numpy, matplotlib, scipy

我有一个关于拟合和获取随机数的问题。

情况是这样的：

首先，我有一个来自数据点的直方图。

```
import numpy as np

"""create random data points """
mu = 10
sigma = 5
n = 1000

datapoints = np.random.normal(mu,sigma,n)

""" create normalized histrogram of the data """

bins = np.linspace(0,20,21)
H, bins = np.histogram(data,bins,density=True) 
```

我想将此直方图解释为概率密度函数（例如 2 个自由参数），以便我可以使用它来生成随机数，并且我还想使用该函数来拟合另一个直方图。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T18:04:29.423

您可以使用累积密度函数从任意分布生成随机数，如此处[所述](http://www.av8n.com/physics/arbitrary-probability.htm)。

使用直方图生成平滑的累积密度函数并非易事；您可以使用插值，例如 scipy.interpolate.interp1d() 来获取箱中心之间的值，这对于具有相当多的箱和项目的直方图来说可以正常工作。但是，您必须决定概率函数尾部的形式，即对于小于最小 bin 或大于最大 bin 的值。您可以根据例如将高斯拟合到直方图）或适合您的问题的任何其他形式的尾部来给出分布高斯尾部，或者简单地截断分布。

例子：

```
import numpy
import scipy.interpolate
import random
import matplotlib.pyplot as pyplot

# create some normally distributed values and make a histogram
a = numpy.random.normal(size=10000)
counts, bins = numpy.histogram(a, bins=100, density=True)
cum_counts = numpy.cumsum(counts)
bin_widths = (bins[1:] - bins[:-1])

# generate more values with same distribution
x = cum_counts*bin_widths
y = bins[1:]
inverse_density_function = scipy.interpolate.interp1d(x, y)
b = numpy.zeros(10000)
for i in range(len( b )):
    u = random.uniform( x[0], x[-1] )
    b[i] = inverse_density_function( u )

# plot both        
pyplot.hist(a, 100) 
pyplot.hist(b, 100)
pyplot.show() 
```

这不处理尾部，它可以更好地处理 bin 边缘，但它会让您开始使用直方图生成更多具有相同分布的值。

PS您也可以尝试拟合由几个值描述的特定已知分布（我认为这是您在问题中提到的），但上述非参数方法更通用。

# sql-server-2008 - SQL Server 2008 t-SQL - 将多个记录 ID 作为 CSV 插入 varchar 列

> ID：13476815
> 
> 赞同：-1
> 
> 时间：2012-11-20T15:45:43.733
> 
> 标签：sql-server-2008, tsql, csv

> **可能重复：**
> [将多行连接成一个文本字符串？](https://stackoverflow.com/questions/194852/concatenate-many-rows-into-a-single-text-string)

我在 SQL Server 2008 数据库中有 2 个表 - tblQuestion 和 tblSummary。我从 tblQuestion 中选择 QuestionIDs，如下所示。

```
SELECT QuestionId from tblQuestion WHERE Status='Completed'; 
```

结果如下（来自多条记录），

```
QuestionId 
----------
1
2
5
7
8
9

[6 rows] 
```

现在，我需要将上面选定的 ID 插入 tblSummary 中的“CompletedSections”列（VARCHAR 类型）。它应该以类似 CSV 的格式插入 - 1,2,5,7,8,9

例如，如果我从 tblSummary 中选择那些将如下所示。

```
SELECT CompletedSections FROM tblSummary WHERE <Some Condition> 
```

结果应该是，

```
CompletedSections 
-----------------
1,2,5,7,8,9

[1 row] 
```

如何使用 t-SQL（不使用 C# 之类的任何编程语言）在数据库级别完成此操作？我希望使用预定的 SQL SP/函数/触发器通过 t-SQL 实现这一点。

谢谢，

查图尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T16:17:21.413

[这](http://blog.sqlauthority.com/2009/11/25/sql-server-comma-separated-values-csv-from-table-column/)是我过去使用过的解决方案。这有点 hacky，但它应该比使用光标创建 CSV 更快。这是一些示例代码，可帮助您入门。

```
DECLARE @tblQuestion TABLE
(
     QuestionId nvarchar(10)
)

DECLARE @tblSummary TABLE
(
    CompletedSections nvarchar(100)
)

INSERT INTO @tblQuestion
VALUES (1),(2),(3),(4),(5),(6),(7),(8),(9)

INSERT INTO @tblSummary
SELECT SUBSTRING(
(SELECT ',' + QuestionId 
from @tblQuestion 
FOR XML PATH('')),2,200000) AS CSV

SELECT * FROM @tblSummary 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T16:08:04.243

这将完成这项工作；

```
DECLARE @S VARCHAR(5000)

SELECT @S=ISNULL(@S+ ',', '') + CONVERT(VARCHAR(10),QuestionId)
FROM tblQuestion 

SELECT @S 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-20T16:00:08.923

```
 DECLARE @STRING VARCHAR(MAX) = ''
    DECLARE @VALUE VARCHAR(MAX)

    DECLARE A_CURSOR CURSOR FOR
    SELECT QuestionId from tblQuestion WHERE Status='Completed'

    OPEN A_CURSOR
    FETCH A_CURSOR INTO @VALUE

    WHILE @@FETCH_STATUS = 0
    BEGIN

    if @STRING <> ''
    set @STRING = @STRING + ', '

    set @STRING = @STRING + CONVERT(VARCHAR(MAX),@VALUE)

    FETCH A_CURSOR INTO @VALUE

    END

    CLOSE A_CURSOR

    DEALLOCATE A_CURSOR

    INSERT INTO CompletedSection (tblSummary) SELECT @STRING 
```

# django - Ajax - 如何自动保存我的 Django 表单

> ID：13476816
> 
> 赞同：4
> 
> 时间：2012-11-20T15:45:46.570
> 
> 标签：django, jquery, django-forms, autosave

`add_form`我的 django 应用程序下有一个。我想在这个表单中添加一个功能，它会在用户开始输入后自动保存表单。

就像在 gmail 或 blogger 中一样。

我应该遵循哪些步骤？哪种方式或插件？以及如何使用它们？

任何知识都可以帮助我。谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T15:57:02.553

There's two useful jquery plugins to get you started

[https://github.com/BenGriffiths/jquery-save-as-you-type](https://github.com/BenGriffiths/jquery-save-as-you-type) which saves what you type locally to a cookie client-side. Using this plugin is simpler and you will only need to actually save into your django backend when the user hits your form's "save" button.

and

[https://github.com/nervetattoo/jquery-autosave](https://github.com/nervetattoo/jquery-autosave) which requires that you set up an intermediary model (perhaps a `Draft` model) in django to keep track of updates along the way. And when the user finally hits save, a final copy of the data is then saved into the actual model.

# user-interface - WindowEx：将背景颜色设置为透明

> ID：13476820
> 
> 赞同：3
> 
> 时间：2012-11-20T15:45:57.197
> 
> 标签：user-interface, window, transparency, autoit

我正在使用以下代码：

```
#include <WinAPI.au3>
#include <WindowsConstants.au3>

Global Const $WC_LINK = "SysLink"
Global Const $WC_LINKA = $WC_LINK
Global Const $WC_LINKW = $WC_LINK

$g_hLink = _WinAPI_CreateWindowEx(0, $WC_LINK, _
        'Test, [url="http://www.microsoft.com"]click here[/url], [url="http://www.microsoft.com"]here[/url] or [url=""]here[/url]', _
        BitOR($WS_VISIBLE, $WS_CHILD, $WS_TABSTOP), _
        10, 10, 300, 60, $Form2 _
)
GUIRegisterMsg($WM_NOTIFY, "MY_LINK_NOTIFY")

Func MY_LINK_NOTIFY($hWnd, $Msg, $wParam, $lParam)
    Local Const $tagNMLINK = $tagNMHDR & ";" & "UINT mask; int iLink; UINT state; UINT stateMask; WCHAR szID[48]; WCHAR szUrl[2083];"
    Local $NMHDR = DllStructCreate($tagNMHDR, $lParam)
    Local $hwndFrom = DllStructGetData($NMHDR, "hwndFrom");
    Switch $hwndFrom
        Case $g_hLink
            Switch DllStructGetData($NMHDR, "code")
                Case $NM_CLICK
                    ContinueCase
                Case $NM_RETURN
                    $NMHDR = DllStructCreate($tagNMLINK, $lParam)
                    Local $iLink = DllStructGetData($NMHDR, "iLink")
                    Local $szURL = DllStructGetData($NMHDR, "szURL")
                    Local $szID = DllStructGetData($NMHDR, "szID")

                    If $szURL <> "" Then
                        ShellExecute($szURL, "", "", "open", @SW_SHOW);
                    EndIf
            EndSwitch
    EndSwitch
EndFunc 
```

要使我的系统链接可点击：

![在此处输入图像描述](../Images/b1ab9bae546a3530852c1c80dbe6f36e.png)

问题是我希望它只显示文本......并将这个白色/灰色背景设置为透明。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T13:30:31.693

似乎这是不可能的。

有`LWS_TRANSPARENT`样式，但它不会使 SysLink 透明，它只是将其背景颜色设置为窗口背景颜色。

此外，SysLink 支持该`WM_CTLCOLORSTATIC`消息，但您不能使用它使背景颜色透明。

# git - 恢复从未提交的已删除目录

> ID：13476822
> 
> 赞同：0
> 
> 时间：2012-11-20T15:45:58.303
> 
> 标签：git, restore

我不小心将本地目录添加到本地 Git 存储库中。

```
git add dirName 
```

它在该目录中添加了大约二十个文件。我不想添加它们。它们以前从未添加过，我也没有提交它们。相反，我删除了它们：

```
git rm -rf dirName 
```

这成功地将它们从存储库中删除，但令我沮丧的是，该目录似乎也已从磁盘中删除。它们不在我的回收站中。

有什么办法可以找回这些文件吗？当然，我有备份，但自上次备份以来，我对文件进行了很多更改。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-22T08:53:45.377

我认为接受的答案并不完全准确。Indeed`git rm`会从索引中删除文件，但它们通常会在 Git 的对象数据库中保留一段时间。除非您强制进行垃圾收集，否则就是这样。

您是否尝试过跑步`git fsck`以检索一些*悬垂的斑点*或*悬垂的树木*？

```
$ git init test
Initialized empty Git repository in D:/DOCUME~1/T012345/LOCALS~1/Temp/test/.git/

$ echo baz > foo/bar.txt

$ git add -Av
add 'foo/bar.txt'

$ git rm -rf *
rm 'foo/bar.txt'

$ git fsck
notice: HEAD points to an unborn branch (master)
Checking object directories: 100% (256/256), done.
notice: No default references
dangling blob 76018072e09c5d31c8c6e3113b8aa0fe625195ca

$ git cat-file -p 76018072e09c5d31c8c6e3113b8aa0fe625195ca
baz 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:55:13.403

不，不是因为

```
git rm -rf dirName 
```

就好像

```
rm -rf dirName 
```

这也是不可逆转的，但它也会删除暂存文件，因此您无法取回文件。下次使用 git rm --cached dirName 只会将其从舞台上删除，而不是从您的光盘中删除。

# jsf - 如何在不绑定到托管 bean 中的 UI 组件的情况下访问 primefaces 树中的当前 TreeNode（以标记或编程方式）？

> ID：13476824
> 
> 赞同：7
> 
> 时间：2012-11-20T15:46:07.210
> 
> 标签：jsf, jsf-2, primefaces

我将 Primefaces 3.4.1 与 Oracle 的 JSF 2.2 实现的 2.2.0-m05 里程碑版本一起使用。我还使用 Spring 3.1 进行依赖注入和一些 AOP。

我正在尝试使用 Primefaces 树组件来显示逻辑过滤规则的组合（并允许用户在组合结构内的任何深度创建组合/叶节点）。

示例复合过滤器：

((location = 'cal') AND (description contains 'test')) OR (project = 'someProject')

示例树标记：

```
<p:tree value="#{form.rootComponent}" var="filterComponent" animate="true">

    <p:treeNode type="composite">
       <!-- some composite specific components -->
    </p:treeNode>

    <p:treeNode type="leaf">
       <!-- some leaf specific components -->
    </p:treeNode>

</p:tree> 
```

尽管元素上的“value”属性接受根 TreeNode（从托管 bean 中检索），但“var”属性指向当前树节点中存在的实际数据，而不是节点本身。**我想要一种访问当前树节点的方法，而不是它的包装数据，无论是标记还是编程**。

如果我可以在标记中访问它，我可以将它作为方法参数传递给托管 bean。如果无法在标记中访问它，我可以通过模型对象获得直接的编程访问吗？（大概是通过访问底层树模型？）。

我知道您可以使用解析为基础 DataModel 的表达式而不是直接将数据集合作为 h:dataTable 的“值”，但我相信您只能将根节点本身与 p:tree 一起使用。

我可以在包装的数据对象中包含对树节点的引用，但如果可能的话，我真的宁愿避免讨厌的循环引用。

在没有更好的选择的情况下，我尝试使用“绑定”属性将 p:tree 元素直接绑定到托管 bean 中的 Tree 实例（Tree 是 p:tree 的 UIComponent 类），这样我就可以访问当前节点通过 getTreeNode() 方法，但考虑到托管 bean 和视图组件之间的生命周期不匹配，我更愿意避免这种情况。它不能按原样完美运行，我认为必须有一个更好、更简单的解决方案。

我还尝试使用 jsf 数据表 - 使用嵌套数据表来处理复合部分 - 但考虑到在 jsf 标记中创建条件递归结构的困难，我决定反对它（我相信在视图构建时不会评估“rendered”属性所以很难避免无限递归）。

澄清一下，我只对包含“var”引用的数据的当前树节点感兴趣，而不是用户当前选择的节点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-02-04T20:12:53.513

PF Lead 刚刚在 PF 5.1.10 / 5.2 中为 p:treeTable 添加了一个名为“nodeVar”的新属性（不知道是否包含 p:tree）。此功能将允许获取实际的 TreeNode 而不是它的数据。因此，现在可以对节点本身执行额外的方法调用，例如 TreeNode.isLeaf()。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-21T08:19:56.267

嗯，树组件中有一个名为“选择”的属性。您只需要提供对托管 bean 方法的引用。

例如，在您的 xhtml 中以下列方式定义属性：

```
selection="#{myManagedBean.selectedNode}"
```

通过上述属性的定义，您必须在托管 bean 中提供通常的 setter 和 getter 方法，这些方法引用 org.primefaces.model.TreeNode 实例。

# php - 数据不通过 AJAX

> ID：13476825
> 
> 赞同：1
> 
> 时间：2012-11-20T15:46:11.413
> 
> 标签：php, javascript, jquery, ajax

我正在尝试使用一些 ajax 将按钮的值传递给单独的文件。

这是我的代码。

```
 $("input#downloadSingle").click(function() {
                var myData = $("input#downloadSingle").val();
                $.ajax({
                    type: 'post',
                    url:'singleDownload.php',
                    data: myData,
                    success: function(results) {
                        alert('works');
                    }
                });
            }); 
```

但是，当我通过在 $_POST 上执行 var_dump 来测试下一页时。我没有得到任何数据回来。想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T15:48:52.213

您没有指定`$_POST`要在`singleDownload.php`文件中获取的变量的名称（除非这是按钮值的一部分），因此您应该尝试以下操作：

```
 $("input#downloadSingle").click(function() {
            var myData = "whatever=" + $("input#downloadSingle").val();
            $.ajax({
                type: 'post',
                url:'singleDownload.php',
                data: myData,
                success: function(results) {
                    alert('works');
                }
            });
        }); 
```

并确保`$_POST`在您的 php 文件中是相同的`whatever`变量

# vba - vba 循环遍历数据透视表的所有数据透视字段并返回指定值

> ID：13476826
> 
> 赞同：1
> 
> 时间：2012-11-20T15:46:12.227
> 
> 标签：vba, loops, boolean, pivot

我有一个数据集，其条目有 5 个不同的属性和一个值。比如我身高5000人。对于每个人，我有他的头发颜色、眼睛颜色、国籍、他出生的城市和他母亲的名字（5 个维度）。

编号/眼睛颜色/头发颜色/国籍/家乡/母亲姓名/身高

1.  蓝色金发瑞士苏黎世妮可 184
2.  蓝棕色英国约克红宝石 164
3.  Brown Brown 法国巴黎 Sophie 154
4.  ETC..

所以有5个维度。数据是动态设置的，因此每个维度中的类别数量可能会有所不同。我试图根据是否要包含某些维度（从 1 到 5）来计算人的平均身高。例如我想要检索：

法国人和蓝眼人的平均身高。第二天只有在伦敦出生的人。一周后，瑞士人，蓝眼睛，红头发，出生在日内瓦，母亲叫妮可。

因此，我创建了一个数据透视表，其中眼睛颜色作为行标签，头发颜色作为列标签，平均高度作为数据，最后 3 个维度作为市场过滤器。这让我看到了我的数据所暗示的所有可能和期望的平均高度组合。

**现在我的目标是：**

我想创建一个宏，它遍历我的尺寸所需的所有可能组合（即 2^5-1=31），并将高于某个值（例如 190）的所有平均高度组合存储在一个向量中。然后它可以打印在工作表上。

我正在考虑使用一些布尔数组向量和 For-Each-Next 结构，但我必须说我无法想象如何实现它。

有任何想法吗？

感谢您的时间和帮助！

# javascript - 跨多个页面的加载栏

> ID：13476828
> 
> 赞同：2
> 
> 时间：2012-11-20T15:46:21.100
> 
> 标签：javascript, jquery, coldfusion

我有一个需要合并进度条的场景。（这不是问题）。问题就在这里：

这个进度条需要在不同的页面调用中继续，直到我点击一个特定的页面。

所以基本上，它看起来像这样：

**HTML**

```
<div id="processing_overlay">
  <div class="abs">#labelProcessing#<br>
    <img src="/defaultStyles/images/transparent-ajax-loader.gif">
  </div>
</div> 
```

**脚本**

```
<script>
     $('##processing_overlay').show();
     setTimeout(function() { $('##processing_overlay').hide(); }, 5000);
</script>
<cfinclude template="/nextpage"> 
```

所以基本上当它进入下一页时，进度条需要继续。我已经到处搜索了是否有任何可能做到这一点，但没有任何成功。

关于我如何解决这个问题的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T23:07:02.700

如果加载栏是指正在处理的页面数，另一种更简单的方法是：

第1页.cfm

```
<cfset session.totalPages = 5>

<cfset currentPage = 1>

<div width="100%">
    <div width="#round(currentpage/session.totalPages)#%"></div>
</div> 
```

Page2.cfm

```
 <cfset currentPage = 2> 
```

等等。您必须适当地设置 div 的样式才能获得正确的加载栏外观。

# asp.net - 为什么我的组合框计数为 0？

> ID：13476833
> 
> 赞同：1
> 
> 时间：2012-11-20T15:46:33.293
> 
> 标签：asp.net, combobox, telerik, rad-controls, radcombobox

为什么我的[ComboBox](http://demos.telerik.com/aspnet-ajax/combobox/examples/populatingwithdata/autocompletesql/defaultcs.aspx)中的项目数始终为 0，尽管此组合框的数据源有数据！

* * *

```
<div align="right" dir="rtl">
        <asp:Label ID="lbl_contactListName" runat="server" Text="Menu Name :" CssClass="span"></asp:Label>
        <telerik:RadComboBox ID="ddl_contactList" runat="server" AutoPostBack="True" CausesValidation="False"
            CollapseDelay="0" Culture="ar-EG" ExpandDelay="0" Filter="StartsWith" ItemsPerRequest="10"
            MarkFirstMatch="true" Skin="Outlook" EnableAutomaticLoadOnDemand="True" EmptyMessage="-New Menu-"
            ShowMoreResultsBox="True" OnSelectedIndexChanged="ddl_contactList_SelectedIndexChanged"
            EnableVirtualScrolling="True" DataTextField="list_desc" DataValueField="list_code"
            DataSourceID="ObjectDataSource1" EnableViewState="true" Width="300px">
        </telerik:RadComboBox>
    </div>
        <asp:ObjectDataSource ID="ObjectDataSource1" runat="server" SelectMethod="GetContactListsByDep"
            TypeName="SendSMS_EmailModule.ContactList">
            <SelectParameters>
                <asp:SessionParameter Name="year" SessionField="year" Type="Int32" />
                <asp:SessionParameter Name="main_code" SessionField="main_code" Type="Int32" />
            </SelectParameters>
        </asp:ObjectDataSource> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-29T09:53:18.623

此处 Rad 组合“EnableAutomaticLoadOnDemand=True”的属性值。该属性按需加载所有数据。因此，当您单击组合框时，它将加载其中的数据，直到它为空。如果您不想按需组合组合，请将该属性设为 false。通过这样做，您将直接获得计数。

如果您想将该 EnableAutomaticLoadOnDemand 属性保持为 True。您可以使用 Rad Combo 的 ItemDataBound 事件。通过使用它，您可以更改 Item 的 Text 和 Value 属性以及基于 DataItem 修改其 Attributes 集合

您可以在[telerik rad combo](http://demos.telerik.com/aspnet-ajax/combobox/examples/populatingwithdata/autocompletesql/defaultcs.aspx)找到更多详细信息。如果您想了解更多详细信息，请告诉我。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T16:57:42.257

您是否在页面加载时将计数设为零。

如果是这种情况，那是因为页面加载事件在 ComboBox 被填充之前命中。一种更简单的方法是在页面加载本身上填充项目。

（此代码未经测试）

```
if(!Page.IsPostBack)
{
 using(var context = new Entities())
 {
   foreach(var item in context.Employee)
   {
      RadComboBox1.Items.Add(new RadListBoxItem(item.Name, item.ID.ToString()));
   }
 }
}
//Here you can get the count. 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T16:01:18.583

也许您应该在调用 Count() 之前调用 DataBind()。

```
ddl_contactList.DataBind();
ddl_contactList.Items.Count(); 
```

# javascript - Highcharts - 跨浏览器图表有不同的 Y 轴范围，如何确保一致性？

> ID：13476834
> 
> 赞同：1
> 
> 时间：2012-11-20T15:46:42.453
> 
> 标签：javascript, highcharts

我正在使用 Highcharts 来绘制我们网站上的数据。不幸的是，我们必须支持 Internet Explorer，当然，高图表在 IE 中的呈现方式与在 Chrome 中不同。

我遇到的问题是图表在 chrome 中的 Y 范围与在 Internet Explorer 中的不同。是否有我可以用来使范围一致的配置设置？以下是我正在谈论的屏幕截图：

**IE**（期望的结果）

![IE中的图表](../Images/dc5314e43d5ff7766d5eba6f5ae91d7d.png)

**铬**（不正确）

![Chrome 中的图表](../Images/16e81d66b1a0c902a96aa8f8614a8ade.png)

我正在寻找滴答间隔的配置选项。请注意，在 IE 中，左侧的 Y 轴是 250 的倍数，而 chrome 是 200 的倍数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-20T16:35:18.427

如果没有看到您的代码，这只是一个猜测，因为您可能已经这样做了。尝试使用 yAxis 属性[`max`](http://api.highcharts.com/highcharts#yAxis.max)。这将允许您设置 yAxis 的最大范围。也可以对[`min`](http://api.highcharts.com/highcharts#yAxis.min).

最后，用于[`tickInterval`](http://api.highcharts.com/highcharts#yAxis.tickInterval)设置步骤之间的范围。

# php - 为什么 PHP 的 json_decode 应该返回一个数组时返回一个字符串？

> ID：13476837
> 
> 赞同：2
> 
> 时间：2012-11-20T15:46:50.863
> 
> 标签：php, json

我有点困惑，为什么我在使用 json_decode() 后没有在我的变量中得到一个数组。我正在使用 cURL 发送一些帖子数据。这是 cURL 的帖子数据的样子

```
upload, post_data: Array
(
    [local_file_path] => C:\videos\421F7D21-C659-43E1-9851-2397A4EEFB11.mp4
    [botr_video] => "{\"path\":\"\\\/v1\\\/videos\\\/upload\",\"query\":{\"token\":\"b34f75e5c2c4a23db9850b147f0440fc536bcc7a21847e29\",\"key\":\"hKwNuueB\"},\"protocol\":\"http\",\"address\":\"upload.bitsontherun.com\"}"
) 
```

所以我调用 cURL，在 cURL 调用的接收端，我有以下内容

```
$upload_link=json_decode($_POST['botr_video'], true); 
$file_path=$_POST['local_file_path']; 
$api_format="php"; 

error_log('upload link data is of type: '. gettype($upload_link)); 
```

当我去检查我的错误日志时，它会这样写：

```
upload link data is of type: string 
```

那不应该是一个数组吗？接收 url 中的其余代码取决于 json_decode 的工作。我错过了什么吗？

此外，我在对`$upload_link`变量应用 json_decode 函数后记录了变量，`$_POST['botr_video']`如下所示：

```
error_log('received upload link data: ' . print_r($upload_link, true)); 
```

这是我在日志中得到的：

```
received upload link data: {"path":"\\/v1\\/videos\\/upload","query":{"token":"0835b9c46c0619cec9633a22bc9616a693696e4ea39a827c","key":"kRhvNuIF"},"protocol":"http","address":"upload.bitsontherun.com"} 
```

为什么 json_decode 不获取 post 数据并形成一个数组？好像它把它作为一个字符串。

# c# - 使用 OpenXml SDK 2.0 在 word 文档中插入表格

> ID：13476838
> 
> 赞同：1
> 
> 时间：2012-11-20T15:46:51.970
> 
> 标签：c#, .net, openxml, openxml-sdk

我刚开始使用 Visual Studio 2010 (C#) 中的 OpenXML SDK 2.0。在使用 COM 自动化之前，我有自动化办公程序，这很痛苦。

我有一个由我们的一位平面设计师制作的模板，它将为我的报告奠定基础。为了自动化简单的事情（纯文本项），我在模板中添加了内容控件并将自定义 XML 部分绑定到文档。内容控件如下：

*   天数
*   替代职务
*   日期
*   签名名称

复制模板后，我编辑内容控件并使用以下代码保存文件：

```
//stand up object that reads the Word doc package
using (WordprocessingDocument doc = WordprocessingDocument.Open(docOutputPath, true))
  {
    //create XML string matching custom XML part
    string newXml = "<root>" +
                    "<DayCount>42</DayCount>" +
                    "<AlternateJobTitle>Supervisor</AlternateJobTitle>" +
                    "<Date>9/24/2012</Date>" +
                    "<SignatureName>John Doe</SignatureName>" +
                    "</root>";

    MainDocumentPart main = doc.MainDocumentPart;
    main.DeleteParts<CustomXmlPart>(main.CustomXmlParts);

    //add and write new XML part
    CustomXmlPart customXml = main.AddCustomXmlPart(CustomXmlPartType.CustomXml);
    using (StreamWriter ts = new StreamWriter(customXml.GetStream()))
    {

       ts.Write(newXml);
    }
} 
```

这一切都很好。但是，我的文档不仅仅由标准文本和纯文本更新组成。报告的真正内容在于许多表格，这些表格也需要添加到每个报告中。我一直在疯狂地寻找有关如何完成此操作的良好描述，但实际上没有找到任何东西。是否有某种方法可以使用与纯文本控件相同的内容控制逻辑来描述放置表格的位置？我发现的使用 OpenXML 创建表的任何代码示例都假设您希望将其附加到主文档部分的末尾。我想指定表格需要在模板中的位置，生成表格并将它们放置在模板的指定区域中。这可能吗？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T16:30:38.827

有很多 OpenXml 创建问题。但是，如果您决定采用这种方式（答案很笼统），请检查**OpenXml Productivity Tool**。在我的 PC 上，可以在“C:\Program Files (x86)\Open XML SDK\V2.0\tool\OpenXmlSdkTool.exe”中找到它。只需在要使用 OpenXml 创建的 MsWord 文档中创建并使用此工具反映文档的代码。祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T21:57:22.737

如果您需要显示表格数据，到目前为止，我发现的最好的东西是[http://worddocgenerator.codeplex.com/](http://worddocgenerator.codeplex.com/)上的 Word 文档生成器。

# c++ - 如何在函数内获取函数返回地址？

> ID：13476839
> 
> 赞同：4
> 
> 时间：2012-11-20T15:46:58.040
> 
> 标签：c++, visual-c++, gcc

我想在我的跟踪器中打印返回值，有两个问题

1.  如何获得退货地址？
2.  返回位置在 ~Tracer() 之前或之后更新？

此处需要文本，以便 Stackoverflow 格式化代码：

```
struct Tracer
{
  int* _retval;
  ~Tracer() 
  { printf("return value is %d", *_retval); }
};

int foo()
{
  Tracer __tracter = { __Question_1_how_to_get_return_address_here__ };

  if(cond) {
     return 0;
  } else {
     return 99;
  }

  //Question-2: 
  // return postion is updated before OR after ~Tracer() called ???
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T15:55:40.837

我找到了问题 1 的一些提示，现在检查 Vc 代码

对于 gcc，__builtin_return_address [http://gcc.gnu.org/onlinedocs/gcc/Return-Address.html](http://gcc.gnu.org/onlinedocs/gcc/Return-Address.html)

对于 Visual C++，_ReturnAddress

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T15:53:12.557

您不能在 C++ 中可移植或可靠地执行此操作。返回值可能在内存或寄存器中，并且在不同情况下可能会或可能不会间接。

您可能可以使用内联汇编来使某些硬件/编译器工作。

一种可能的方法是让您`Tracer`的模板引用返回值变量（在适当时）并在销毁之前将其打印出来*。*

另请注意，带有`__`（双下划线）的标识符是为实现保留的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-08-19T10:59:05.483

您的问题相当令人困惑，您可以互换使用不可互换的术语“地址”和“价值”。

返回值是函数在 x86(_64) 中以 E/RAX 或 EDX:EAX 或 XMM0 等形式出现的 4/8 字节值形式吐出的内容，您可以[在此处](https://msdn.microsoft.com/en-us/library/984x0h58.aspx)阅读有关它的更多信息。

另一方面，返回地址是 E/RSP 在调用时所指向的地址（也就是堆栈顶部的东西），并保存函数完成后“跳转”回的地址（定义为称为返回）。

现在我什至不知道什么是示踪剂 tbh，但我可以告诉你你是怎么得到的，这都是关于钩子的。

对于值，假设您在内部执行此操作，只需将函数与具有相同定义的函数挂钩，一旦它返回，您将获得结果。

对于地址，它有点复杂，因为你必须降低一点，并且可能会做一些 asm 恶作剧，我真的不知道你到底想要完成什么，但如果你愿意的话，我做了一个小“存根” , 为被调用者提供返回指针。

这是：

```
 void __declspec(noinline) __declspec(naked) __stdcall _replaceFirstArgWithRetPtrAndJump_() {
    __asm {                   //let's call the function we jump to "callee", and the function that called us "caller"                       
        push ebp             //save ebp, ESP IS NOW -4
        mov ebp, [esp + 4]  //save return address
        mov eax, [esp + 8] //get callee's address (which is the first param) - eax is volatile so iz fine
        mov[esp + 8], ebp //put the return address where the callee's address was (to the callee, it will be the caller)
        pop ebp          //restore ebp
        jmp eax         //jump to callee
}   }
#define CallFunc_RetPtr(Function, ...) ((decltype(&Function))_replaceFirstArgWithRetPtrAndJump_)(Function, __VA_ARGS__)

unsigned __declspec(noinline) __stdcall printCaller(void* caller, unsigned param1, unsigned param2) {
    printf("I'm printCaller, Called By %p; Param1: %u, Param2: %u\n", caller, param1, param2);
    return 20;
}

void __declspec(noinline) doshit() {
    printf("us: %p\nFunction we're calling: %p\n", doshit, printCaller);
    CallFunc_RetPtr(printCaller, 69, 420);  
} 
```

现在可以肯定，您可以并且也许应该使用 _ReturnAddress() 或任何不同的编译器的内在函数，但如果这不可用（这应该是一个非常罕见的场景，取决于您的工作）并且您知道您的 ASM，这个概念应该适用于任何架构，因为无论指令集如何不同，它们都遵循相同的程序计数器设计。

我写这个更多是因为我很久以前出于某种目的寻找这个答案，但我找不到一个好的答案，因为大多数人只是说“呃，这是不可能的或便携的或其他什么”，并且我觉得这会有所帮助。

# php - foreach 循环和 json_encode 只返回一个对象 Joomla 2.5 组件

> ID：13476841
> 
> 赞同：0
> 
> 时间：2012-11-20T15:47:03.220
> 
> 标签：php, jquery, joomla2.5, json

我目前正在使用 Gmaps3 为 Joomla 2.5 制作一个谷歌地图组件，我在它用标记填充地图的地方，但我的 foreach 循环只返回一个对象。

下面的代码：

我的 View.json.php：

```
<?php
defined( '_JEXEC' ) or die;

jimport( 'joomla.application.component.view');

class LocateViewBranches extends JView
{
    public function display($tpl = null)
    {
        $branch = $this->get('Branches');

        foreach ($branch as $row) {
                $response = array(
                        'lat' => $row->branch_latitude,
                        'lng' => $row->branch_longitude,
                        'data' => array(),
                    );
                $response['data'][] = array(
                    'city' => $row->branch_city,
                );

        }
        echo json_encode($response);
    }
} 
```

然后在我的模型中；

```
<?php
defined( '_JEXEC' ) or die;

jimport('joomla.application.component.model');

class LocateModelBranches extends JModel
{
    public function getBranches()
    {
        $db = $this->getDbo();
        $query = $db->getQuery(true);

        $query->select('*');
        $query->from('#__branches');
        $query->where("published = 1");

        $db->setQuery($query);

        $rows = $db->loadObjectList();

        return $rows;
    }
} 
```

如果你们需要更多代码，请大喊，但我认为这是两个关键文件。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T18:05:42.510

我已经整理了你的显示功能。它将以 json 格式回显一个多维数组：

```
public function display($tpl = null)
{
    $responses = array(); // assign each row to this array

    $branch = $this->get('Branches');
    foreach ($branch as $row) 
    {
        // append row data to $responses array
        $responses[] = array(
            'lat' => $row->branch_latitude,
            'lng' => $row->branch_longitude,
            'data' => array(
                'city' => $row->branch_city
            ),
        );
    }
    echo json_encode($responses);
} 
```

我还没有测试它，但它应该是你需要的。

# windows-phone-7 - 如何将变量包含图像保存到windowsphone中的隔离存储中

> ID：13476845
> 
> 赞同：0
> 
> 时间：2012-11-20T15:47:05.357
> 
> 标签：windows-phone-7, windows-phone

我一直在写一篇关于 windowsphone 的文章。我创建了一个地址变量，包括一个 uri 以将图像添加到地址中。使用隔离存储保存数据时出现错误。我不知道为什么。请帮我！太感谢了。

```
class Address
{
   private string name;
   private Uri icon;
   .....
} 
```

……

```
public void save()
    {
        XmlWriterSettings xmlwritersetting = new XmlWriterSettings();
        xmlwritersetting.Indent = true;
            using (IsolatedStorageFile myisolatedstiragefile = IsolatedStorageFile.GetUserStoreForApplication())
        {

            if (myisolatedstiragefile.FileExists(filename))
            {
                myisolatedstiragefile.DeleteFile(filename);
            }

            using (IsolatedStorageFileStream stream = new IsolatedStorageFileStream(filename, System.IO.FileMode.OpenOrCreate, myisolatedstiragefile))
            {
                XmlSerializer serializer = new XmlSerializer(typeof(List<Adress>));
                using (XmlWriter writer = XmlWriter.Create(stream, xmlwritersetting))
                {
                    serializer.Serialize(writer, listadress);
                }
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:56:29.787

我有点难以理解你的问题，但我会努力的。您确实应该指出您在调试器中具体遇到的错误以及它发生的位置。

但只是通过查看，您似乎正在尝试使用 XmlSerializer 将二进制图像数据写入 iso-storage，这可能行不通。您可以找到许多将 iso-storage 用于各种目的的示例，包括在此处编写图像文件：http: [//www.windowsphonegeek.com/tips/All-about-WP7-Isolated-Storage---Read-and-Save-Images](http://www.windowsphonegeek.com/tips/All-about-WP7-Isolated-Storage---Read-and-Save-Images)

例如，它表明您可以通过执行以下操作将 JPG 图像保存到独立存储中：

```
 // Create a filename for JPEG file in isolated storage.
            String tempJPEG = "logo.jpg";             
    // Create virtual store and file stream. Check for duplicate tempJPEG files. 
           using (IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication())            {
                if (myIsolatedStorage.FileExists(tempJPEG))                {
                    myIsolatedStorage.DeleteFile(tempJPEG);
            }  
               IsolatedStorageFileStream fileStream = myIsolatedStorage.CreateFile(tempJPEG); 
                StreamResourceInfo sri = null;
                Uri uri = new Uri(tempJPEG, UriKind.Relative);
                sri = Application.GetResourceStream(uri);
                 BitmapImage bitmap = new BitmapImage();
                bitmap.SetSource(sri.Stream);
                WriteableBitmap wb = new WriteableBitmap(bitmap);
                 // Encode WriteableBitmap object to a JPEG stream.
                Extensions.SaveJpeg(wb, fileStream, wb.PixelWidth, wb.PixelHeight, 0, 85);
                 //wb.SaveJpeg(fileStream, wb.PixelWidth, wb.PixelHeight, 0, 85);                fileStream.Close();
            } 
```

# android - 通知/指示——在最新的摩托罗拉 API 中使用 IBluetoothGattCallback.Stub

> ID：13476855
> 
> 赞同：1
> 
> 时间：2012-11-20T15:47:46.993
> 
> 标签：android, bluetooth-lowenergy, motorola-droid

在旧版本的摩托罗拉 API 中，通知/指示将通过 IBluetoothGattCallback.Stub.... 的实现来接收。

在更新版本的 API 中——引入了新的 IBluetoothGattProfile.Stub 类——我不太确定如何接收通知/指示......我已经实现了 IBluetoothGattProfile.Stub，并且确实接收呼叫按预期在其他方法上......我假设 onValueChanged() 方法是当底层堆栈收到通知/指示时我会收到回调的地方？

使用 setCharacteristicClientConf() 方法，我已启用在客户端接收通知/指示；并且适当的 BLE 数据包已将其传送到服务器端.... 一般来说，空中跟踪看起来很正常 - 与我在使用 iphone 连接（比如说）时看到的没有什么不同......

查看来自底层蓝牙服务的日志消息，我发现那里没有任何活动——事实上，传入的通知/指示正在通过空中传输....

任何有关如何使用最新的 moto ble API 接收通知/指示的见解将不胜感激......

# javascript - YouTube iframe 自定义控制菜单暂停功能

> ID：13476857
> 
> 赞同：2
> 
> 时间：2012-11-20T15:47:51.733
> 
> 标签：javascript, jquery, api, iframe, youtube

我试图简单地创建一个可以使用 iFrame API 控制 YouTube 视频的菜单。我在 id="pause_button" 的 HTML 中放置了一个按钮，并尝试使用 jquery 创建一个函数，以便在单击时暂停视频。下面是我的 HTML 文档：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
<title>Untitled 1</title>
<script type="text/javascript" src="jquery.min.js"></script>
<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">

  // 2\. This code loads the IFrame Player API code asynchronously.
  var tag = document.createElement('script');
  tag.src = "//www.youtube.com/iframe_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.paresntNode.insertBefore(tag, firstScriptTag);

  // 3\. This function creates an <iframe> (and YouTube player)
  //    after the API code downloads.
  var player;
  function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
      events: {
        'onReady': onPlayerReady,
        'onStateChange': onPlayerStateChange
      }
    });
  }

  // 4\. The API will call this function when the video player is ready.
  function onPlayerReady(event) {
    event.target.playVideo();
  }

  // 5\. The API calls this function when the player's state changes.
  //    The function indicates that when playing a video (state=1),
  //    the player should play for six seconds and then stop.
  var done = false;
  function onPlayerStateChange(event) {
    if (event.data == YT.PlayerState.PLAYING && !done) {
      setTimeout(stopVideo, 6000);
      done = true;
    }
  }
  function stopVideo() {
    player.stopVideo();
  }

</script>
<script type="text/javascript">
$(document).ready(function(){
    $("#pause_button").click(function(){
        $("#test").append("TEST");
        player.pauseVideo();
    });
});
</script>

</head>
  <body>
    <!-- 1\. The <iframe> (and video player) will replace this <div> tag. -->
    <iframe id="player" type="text/html" width="640" height="390" src="http://www.youtube.com/embed/u1zgFlCw8Aw?enablejsapi=1&origin=http://example.com" frameborder="0">
    </iframe>

    <button id="pause_button">STOP</button>
    <div id="test">TEST<br /></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T07:39:39.957

您的第一个错误，即无法调用未定义的方法“insertBefore”，是由于您的代码中的拼写错误；应该：

```
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag); 
```

（你有 parsntNode。）

第二个错误是由于您对 iframe 的 URL 参数的来源；您留在了示例来源 (http://example.com)，但它应该设置为您的代码正在运行的服务器的值。这是一种安全措施，允许您的脚本随后与播放器的方法进行交互。

# android - Android 颜色行

> ID：13476861
> 
> 赞同：0
> 
> 时间：2012-11-20T15:48:00.237
> 
> 标签：android, listview, row

有谁知道如何在创建列表视图时为每行的背景着色？

我有一个从我的数据库中提取的数组列表，并在其中填充了一个带有列表视图的布局。

我怀疑可能有一种方法可以使用简单的适配器来做到这一点，但无法弄清楚。

任何帮助将非常感激 ：）

```
@Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);
        setContentView(R.layout.item_list);

        // Read var from Intent
        Intent intent= getIntent();
        final String ListID = intent.getStringExtra("ListID");
        golbalItemID = ListID;

        ivAdd = (ImageView) findViewById(R.id.ivAdd);
        ivCancel = (ImageView) findViewById(R.id.ivCancel);
        tvTotItems = (TextView) findViewById(R.id.tvTotItems);

        final myDBClass myDb = new myDBClass(this);
        final ArrayList<HashMap<String, String>> MebmerList = myDb.SelectAllItemData(ListID);       

        myData =  myDb.SelectItemData(Integer.parseInt(ListID.toString())); 

        // listView1
        final ListView lisView1 = (ListView)findViewById(R.id.listView1); 
        registerForContextMenu(lisView1);

        MyAdapter sAdap;
        sAdap = new MyAdapter(ListItems.this, MebmerList, R.layout.activity_column, new String[] {"Name", "Price", "Quan"}, new int[] {R.id.ColName, R.id.ColTel, R.id.ColQuan});      
        lisView1.setAdapter(sAdap); 

        lisView1.setOnItemClickListener(new OnItemClickListener() {
              public void onItemClick(AdapterView<?> myAdapter, View myView, int position, long mylng) {
                  int iChk = 0;
                // Show Data
                String arrData[] = myDb.SelectItemData((MebmerList.get(position).get("ItemID").toString()));
                if(arrData != null)
                {
                    iChk = Integer.parseInt(arrData[4]);    
                }

                if(iChk == 1)
                {
                    ischkCheck(Integer.parseInt(MebmerList.get(position).get("ItemID").toString()), 0);
                    change_color(lisView1, position, 255, 255, 255);

                    System.out.println("POSITION!ichk=1" + myAdapter.getItemAtPosition(position).toString());
                    setTitle(myAdapter.getItemAtPosition(position).toString());
                }

                else if(iChk == 0)
                {
                    ischkCheck(Integer.parseInt(MebmerList.get(position).get("ItemID").toString()), 1);
                    change_color(lisView1, position, 155, 155, 138);

                    System.out.println("POSITION!ichk=0" + myAdapter.getItemAtPosition(position).toString());
                }

              }});

        ivAdd.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Intent newActivity = new Intent(ListItems.this,AddItem.class);
                newActivity.putExtra("ListID", ListID);
                startActivity(newActivity);
                finish();
            }
        });

        ivCancel.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                Intent newActivity = new Intent(ListItems.this,MenuScreen.class);
                startActivity(newActivity); 
                finish();
            }
        }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:59:11.207

创建一个`Adapter`类，并控制其中每一行的颜色，然后将其设置为适配器`ListView` 这是我的一个项目中的示例代码，检查`getView`功能：

```
public class ListAdapter extends BaseAdapter {

    private LayoutInflater myInflater;
    private List<Poet> list;

    public ListAdapter(Context context) {
        super();
        myInflater = LayoutInflater.from(context);

        Log.d("Ganjoor", "Data passed to the adapter.");

    }

    static class ViewHolder {
        TextView tvName;
    }

    public void setData(List<Poet> list) {
        this.list = list;
    }

    @Override
    public int getCount() {

        return list.size();
    }

    @Override
    public Poet getItem(int position) {

        return (null == list) ? null : list.get(position);
    }

    @Override
    public long getItemId(int position) {

        return position;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        ViewHolder holder;

        if (convertView == null) {
            convertView = myInflater.inflate(R.layout.list_adapter, parent,
                    false);
            holder = new ViewHolder();
            holder.tvName = (TextView) convertView.findViewById(R.id.tvName);

            convertView.setTag(holder);
        } else {
            holder = (ViewHolder) convertView.getTag();
        }

        holder.tvName.setTag(list.get(position).getId());
        holder.tvName.setText(list.get(position).getName());
        // Log.d("Ganjoor", "Adapter: " + list.get(position).getName());

        if (position % 2 == 0) {
            convertView.setBackgroundResource(R.drawable.grad_blue);
        } else {
            convertView.setBackgroundResource(R.drawable.row_style);
        }

        return convertView;
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:57:07.710

正如@Nikita Beloglazov 所说，您可以通过实现自定义 ArrayAdapter 来做到这一点，将您的配色方案放在 getView Override 方法中。请参阅[ArrayAdapter 文档](http://developer.android.com/reference/android/widget/ArrayAdapter.html)。

# java - Java 图形事件未按我期望的顺序发生

> ID：13476862
> 
> 赞同：1
> 
> 时间：2012-11-20T15:48:01.563
> 
> 标签：java, graphics, repaint

所以我正在制作一个图形纸牌游戏。每张卡片都是一个 JPanel，带有一个按钮和两个与之关联的图像。我有一个翻转方法，这是我在点击卡片时在动作监听器中调用的第一件事。

```
public void flip()
{
    if(b1.getIcon() == card2) b1.setIcon(card1);
    else b1.setIcon(card2);
    revalidate();
    repaint();
} 
```

但是，由于某种原因，卡片在我调用此方法后的某个时间点才会翻转（意味着图标不会改变）。例如，当我在调用翻转后放置一个 Thread.sleep 时，我会假设我的程序会在翻转完成后暂停，但事实并非如此！它在尚未切换图像的情况下进入睡眠状态，并且仅在睡眠时间结束后才切换它们。

当我让人类在这个纸牌游戏中玩 AI 时，这会导致一些重大问题，因为 AI 事件发生在纸牌在屏幕上翻转之前发生，即使我在执行任何 AI 代码之前调用了 flip()。谁能告诉我这里发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T16:03:30.873

重绘是对 Swing 重绘的请求，而不是对重绘的调用。在幕后 repaint() 正在将重绘作业发布到事件队列中。与重绘工作一起，鼠标移动、鼠标点击、键盘活动等也发布在那里。Swing 线程来并定期从该队列执行作业以重绘 UI，将鼠标和键盘事件传递给组件等。事实上，swing 线程非常频繁地传递这些事件，但这仅取决于您的 UI 正在做多少工作在那个 Swing 线程上。当它发出鼠标点击、键盘事件和重绘时，它无法从该队列中读取。因此，如果您的代码需要很长时间才能响应任何事件，则 swing 及时响应新事件的能力会降低或一起被阻止。

这就是为什么如果您使用 Swing 事件调度线程通过网络执行阻塞服务调用，您的 UI 将停止绘制，直到该调用返回。这就是为什么将长时间运行的作业（如网络调用）移出 Swing 线程并在调用返回时使用 SwingUtilities.invokeLater() 以便您可以在事件线程上更新 UI 的原因。（invokeLater() 通过将作业发布到我们上面讨论过的 Swing 事件队列来做到这一点）。

这也是为什么在 Swing 事件线程上调用 sleep 是一个糟糕的主意。如果您将该线程置于睡眠状态，则它无法为队列中的事件提供服务。并且您请求的 repaint() 不会在 Swing 线程休眠时完成。

首先删除你的睡眠电话。第二。在执行更多逻辑之前，不要编写依赖于绘制完成的代码。重绘和重新验证是特殊调用，Swing 将合并请求以重绘/重新验证，因此它不会连续重绘 10 次（浪费重要的 cpu 时间）。

在您让调用您的线程离开它第一次调用您的方法之前，Swing 无法重绘您的面板。线程越早离开该方法，您的 repaint() 就会越早发生。

您还没有解释为什么要立即进行重绘，因此我无法就如何构建代码给您任何建议，因此您不必关心它。但我告诉你，你不应该关心重绘还没有发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T16:24:06.767

完全同意@chubbsondubs。我只是想补充一点，如果您的目标是在调用翻转后的某个时间发生某些事件，请考虑使用[摇摆计时器](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)。正如您痛苦地意识到的那样，调用 Sleep 不会产生预期的效果。但如果相反，你

*   创建一个 1 秒的计时器
*   创建计时器触发时要执行的操作
*   启动计时器

然后你可以创建你想要的延迟而不阻塞事件调度线程。

```
public void flip()
{
    if(b1.getIcon() == card2) b1.setIcon(card1);
    else b1.setIcon(card2);
    revalidate();
    repaint();

    javax.swing.Timer t = new javax.swing.Timer(1000, new ActionListener() {
        public void actionPerformed(ActionEvent e) {
          // do something interesting
        }
     });
    t.repeats(false);
    t.start();
} 
```

# javascript - 将标签放在输入旁边

> ID：13476863
> 
> 赞同：0
> 
> 时间：2012-11-20T15:48:02.697
> 
> 标签：javascript, html, css, validation

我有一个简单的案例。我想要两件事。

1.  将标签放在输入旁边。
2.  某种验证，只有文本框的数字。

对应的[链接](http://jsfiddle.net/zhshqzyc/GCtPE/)在这里。

现在输入在标签下方。我的代码：

```
<div id="generatePinsDialog" title="Generate New PINs">
<label style="display: inline-block; width: 400px;">
    How many?</label>
<input id="newInmateCount" type="text" size="25" value="Enter the number!" />
<br />
<select>
    <option value="sameAsID">Same as ID</option>
    <option value="appendID">AppendID</option>
</select> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:52:16.493

演示：http: [//jsfiddle.net/GCtPE/25/](http://jsfiddle.net/GCtPE/25/)

```
label, input { display: inline-block; } 
```

由于并非所有浏览器都完全支持 HTML5，因此您必须使用 javascript 进行验证。[HTML5 虽然很酷。](http://www.the-art-of-web.com/html/html5-form-validation/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:53:30.153

删除`display: inline-block`. 这导致输入字段转到新行。

你这个 js 函数只验证数字，将其`onkeypress`称为输入字段的事件或将其与`onkeydown`事件绑定

```
function onlyNumbers(evt) {
    var theEvent = evt || window.event;
    var key = theEvent.keyCode || theEvent.which;
    key = String.fromCharCode( key );
    var regex = /[0-9]|\./;
    if( !regex.test(key) ) {
        theEvent.returnValue = false;
        if(theEvent.preventDefault) theEvent.preventDefault();   
    }
} 
```

[jsFiddle 演示](http://jsfiddle.net/GCtPE/22/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-20T16:02:48.797

首先，从标签中删除“inline-block”并添加如下`for`属性：

```
<label for="newInmateCount" style="width: 400px;">How many?</label> 
```

至于输入，仅对数字执行此操作：

```
$("#newInmateCount").keydown(function(e) {
    if (e.which == 8 || e.which == 46) return true; // for backspace and delete
    if (e.which < 48 || (e.which > 57 && e.which < 96) || e.which > 105) return false;
}); 
```

# [查看您的 jsFiddle 更新](http://jsfiddle.net/SpYk3/GCtPE/38/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T15:52:21.583

将标签放在输入旁边，更改`display:inline-block;`为`display:inline`或将 减小`width:400px`到较低的值，直到获得所需的定位。为了验证，您需要阅读一些**正则表达式**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T15:53:57.757

[jsfiddle here](http://jsfiddle.net/GCtPE/11/) 输入太靠右了，因为您将标签的宽度设置为 400 像素，我刚刚删除了它，现在看起来很好。还添加了一些快速验证，您显然必须在提交表单时运行验证。

```
<div id="generatePinsDialog" title="Generate New PINs">
    <label style="display: inline-block;">
        How many?</label>
    <input id="newInmateCount" type="text" size="25" value="Enter the number!" />
    <br />
    <select>
        <option value="sameAsID">Same as ID</option>
        <option value="appendID">AppendID</option>
    </select>
 </div>​ 
```

JS如下：

```
if($('#newInmateCount').val() != "") {
    var value = $('#newInmateCount').val().replace(/^\s\s*/, '').replace(/\s\s*$/, '');
    var intRegex = /^\d+$/;
    if(!intRegex.test(value)) {
        errors += "Field must be numeric.<br/>";
        success = false;
    }
} else {
    errors += "Field is blank.</br />";
    success = false;
}​ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-20T15:55:08.303

使用 jQuery 提交时验证非常简单。这是一个[例子](http://docs.jquery.com/Plugins/Validation/Methods/number)。如果你想让它永远不会有数字以外的东西，你可以使用 onchange 或 onkeyup 事件并简单地从输入中删除数字。

对于定位，请尝试使用 inline 而不是 inline-block。

# javascript - 当用户滚动到页面上的特定点时，如何计时脚本运行？

> ID：13476865
> 
> 赞同：2
> 
> 时间：2012-11-20T15:48:20.190
> 
> 标签：javascript, scroll, image, scrolltop

我有一张随着用户向下滚动而变化的图片（请参见下面的代码）。

目前，它从滚动开始点开始，但我希望它只在用户滚动到页面上的特定点（或像素）时才开始改变。

我需要在下面添加什么才能做到这一点？预先感谢您的帮助和回复。

```
<div class='fauxcolumn-outer fauxcolumn-right-outer'>
<div style='position:relative'/>
<style>
        #photo { position: absolute; top:3px; right:29px; z-index:1 }
    </style>
    <script src='http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js'/>
    <script>
        var urls = [
            "http://abcd.jpg",
            "http://abcd.jpg",
            "http://abcd.jpg",
            "http://abcd.jpg",
            "http://abcd.jpg",
            "http://abcd.jpg",
            "http://abcd.jpg",
            "http://abcd.jpg",
            "http://abcd.jpg",
            "http://abcd.jpg"

        ];
        $(function(){
            $(window).scroll(function(){
            var i = Math.min(Math.floor($(window).scrollTop()/50), urls.length-1)
                $("#photo img").attr("src", urls[i]);
            });
        });
    </script>
<body>
    <div id='photo'><img src='http://abcd.jpg'/>
</div>
</body> 
```

# java - Java Servlet：为 request.getParameter 指定 postdata 限制？

> ID：13476866
> 
> 赞同：2
> 
> 时间：2012-11-20T15:48:22.187
> 
> 标签：java, servlets, post, limit

我知道第一次调用`getParameter`将读取 postdata 内容（如果有）。

有没有办法让我限制将多少 postdata 内容处理到 RAM 中，或者我是否需要重写这些`getParameter*`方法才能完成？

我对将此设置为服务器范围的设置不感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T16:00:40.330

> *还是我需要重写 getParameter*方法才能完成？*

是的。

为此，您可以使用[`HttpServletRequestWrapper`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequestWrapper.html)由[`Filter`](https://stackoverflow.com/tags/servlet-filters/info).

```
@Override
public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException {
    chain.doFilter(new MyPostDataLimitingRequest((HttpServletRequest) request), response);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T16:03:21.180

我不相信有一种方法可以限制现有的`getParameter()`，这是一种方便的方法，无需扩展 servlet 或添加侦听器来为您分解它。

您可以通过直接使用`getInputStream()`or解析 servlet 中的输入流来规避此问题，但我相信这会使对该请求的其余部分的`getReader()`进一步调用无效；`getParameter()`您需要通过您选择的方法使用其余的输入。

它并不优雅，但它确实有效。

# memory - PyQt GUI 中的 Matplotlib 图像显示因内存错误而停止

> ID：13476867
> 
> 赞同：1
> 
> 时间：2012-11-20T15:48:22.963
> 
> 标签：memory, matplotlib, pyqt4

问题：我有一个 PyQt4 GUI 应用程序，它必须导入 16 位灰度图像数据并对图像进行一些计算。Gui 有一些控制元素和一个带有两个选项卡的 QTabWidget() 元素，其中一个显示图像，另一个在表格中表示计算结果。图像表示是使用 Matplotlib 完成的。

在我的应用程序中，我应该能够打开最大 10000x12500 像素的图像，这对应于 250MB 的图像数据。不幸的是，我的应用程序只能打开大约 130MB 大小的图像。导入和显示大于 8000x8000 像素的数据时，我的应用程序停止显示内存错误。虽然图像本身大小为 128MB，但 Windows 任务管理器显示 python 任务使用的内存为 694MB。无法再显示 8000x9000 像素大小的图像。

我的电脑有 4GB 的 RAM 内存。我不认为这个问题是由于内存不足造成的。

问题：如何让我的应用程序显示尺寸最大为 10000x12500 像素灰度 16 位的图像？我可以修改 Matplotlib 内部限制吗？

我搜索了网络，但没有找到任何答案。与我的问题最接近的问题描述可以[在 Matplotlib imshow 中的 Excessive memory usage 中看到](https://stackoverflow.com/questions/9525706/excessive-memory-usage-in-matplotlib-imshow)。但是将显示命令从 show() 更改为 draw() 并没有帮助。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T19:25:24.700

`mapplotlib`对带有图像的内存效率不高，数据有多个内部副本。

除非你有一个巨大的屏幕（在 300ppi 时，你的图像是 33 英寸 x 42 英寸），否则你的图像在显示时会被下采样。我建议将您的图像下采样到更接近实际区域像素数的大小。您可能希望根据用户实际看到的内容编写一些对自适应下采样的操作。

相关[问答](https://stackoverflow.com/questions/13183460/plot-really-big-file-in-python-5gb-with-x-axis-offset) [_](https://stackoverflow.com/a/13197330/380231)

# ruby-on-rails - rails 中的自定义 url 和路径

> ID：13476871
> 
> 赞同：1
> 
> 时间：2012-11-20T15:48:30.107
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有两个模型：`Books`并且`pages`是典型的 one_to_many 关系。

我怎样才能使以下

```
page_path(@page) 
```

输出此路径：

```
bookname/page/pageid 
```

代替

```
page/pageid 
```

如果我覆盖 to_param，我所能做的就是制作一条类似的路径，`localhost/page/bookid/pageid`但这不是我想要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:58:08.560

不确定是否可以获得您想要的内容，但您可以将 Page 设置为 book 下的嵌套资源，如下所示：

```
resources :books do
  resources :pages
end 
```

然后你会得到：

`localhost/book/bookid/page/pageid`

然后你可以覆盖 `to_param' 来获得：

`localhost/book/bookid-bookname/page/pageid`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T16:09:18.577

我假设您的意思是路径为 /:book_name/page/:id

在 routes.rb 中：

```
match '/:book_name/page/:id' => "page#show", :as => :page 
```

在控制器中，您将访问 params[:id] 以获取 page.id 和 params[:book_name] 以获取书名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T17:24:57.760

我发现要完全控制路径助手，您必须覆盖`application_helper.erb`文件中的那些。以下代码对我有用：

```
def pages_path(@page)
  @bookpath = Book.find(@page.book_id)
  @bookpath + '/page/' + @page.id
end 
```

助手只创建路径。您仍然需要将其链接到`routes.rb`. 您甚至可以将`pages`资源嵌套在`books`资源中。唯一重要的是，上述助手生成的路径必须能够被 rails 应用程序识别。

# objective-c - 单元格已创建但未在 UITableView 中显示

> ID：13476873
> 
> 赞同：1
> 
> 时间：2012-11-20T15:48:38.640
> 
> 标签：objective-c, xcode, uitableview, uisearchbar

这是我的第一个问题。

我的 UITableView 没有显示所有创建的单元格。有什么问题？

应用程序启动后，它会从服务器下载数据并使用 UITableView 显示。当我滚动 UITableView 时，我的应用程序会下载更多数据（如 Twitter 应用程序）。一切都很好。

但我也有一个 UISearchBar。还有一个问题。当 SearchBar 处于活动状态时，一切都以相同的方式工作（例如，它在我键入时下载数据的第一部分，在我滚动时下载另一个数据），但 UITableView 仅显示数据的第一部分。

但是 cellForRowAtIndexPath 中的 NSLog 告诉我，所有单元格都创建得很好。我不知道该怎么办。

对不起，我的英语不太好。

此外，numberOfRowsInSection 返回正确的值（例如 3），而 UITableView 中仅显示 1 个单元格。而且，当然，我的数组包含我需要显示的所有数据。

```
 - (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
    {
        return 1;
    }

    - (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
    {
        if(searching == 0){ //if we aren't in search
            NSLog(@"Total rows %d", ids.count);
            return [ids count];
        }
        if(searching == 1){ //if we are in search
            NSLog(@"Total rows %d", idsSearch.count);
            return [idsSearch count];
        }
    }

    - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
    {
        static NSString *CellIdentifier = @"Cell";

        UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
        if (cell == nil) {
            cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
            if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
                cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
            }
        }

        NSInteger row = [indexPath row];

        if(searching == 0){
            cell.textLabel.text = [names objectAtIndex:row];
            NSLog(@"Cell with %@ created", [names objectAtIndex:row]);
        }

        if(searching == 1){
            cell.textLabel.text = [namesSearch objectAtIndex:row];
            NSLog(@"Cell with %@ created", [namesSearch objectAtIndex:row]); //tells me that ALL cells were created. But they aren't in UITableView.
        }

        return cell;
    }

    - (void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText {
        searchRequest = searchBar.text;
        if([searchRequest isEqualToString:@""]){
            searching = 0;
        }
        else{
            searching = 1;

            [idsSearch removeAllObjects];
            [namesSearch removeAllObjects];

            [self getArtistsStartFrom:0 withLimit:1]; //downloads new data (1 record in this example) with needed predicate (searchRequest) from server, then adds it to arrays and performs [self.tableView reloadData] at the end.
        }
    } 
```

# websphere-6.1 - Websphere 应用服务器管理

> ID：13476878
> 
> 赞同：0
> 
> 时间：2012-11-20T15:49:00.497
> 
> 标签：websphere-6.1

如何查看在 Websphere 应用程序服务器管理中运行的所有 Web 服务器进程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T20:07:48.077

通过说 webserver，我假设您在谈论 IBM IHS 服务器，而不是 java 应用程序服务器。

无论您的网络服务器进程是在受管节点（使用节点代理）还是在非受管节点（没有节点代理）上运行，如果您设置了网络服务器属性（它运行的端口号），您应该能够看到它的状态（运行/未运行） , IHS 二进制目录等...)

# c++ - 如何在 C++ 中为指针“this”赋值

> ID：13476879
> 
> 赞同：24
> 
> 时间：2012-11-20T15:49:01.013
> 
> 标签：c++, this

在函数中，如何分配`this`新值？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-11-20T15:56:22.610

您可以在以下位置分配对象`this`点：

```
*this = XY; 
```

但是您不能分配 的直接值`this`：

```
this = &XY;   // Error: Expression is not assignable 
```

* * *

## 回答 #2

> 赞同：40
> 
> 时间：2012-11-20T15:49:45.520

你不能。

### 9.3.2 this指针[class.this]

> 1 在非静态 (9.3) 成员函数的主体中，关键字**`this`是[纯右](https://stackoverflow.com/q/3601602/673730)值表达式**，其值是调用该函数的对象的地址。[...]（强调和链接我的）

您可以修改对象`this`指向，即`*this`. 例如：

```
struct X
{
   int x;
   void foo()
   {
     this->x =3;
   }
}; 
```

该方法修改对象本身，但类似的东西`this = new X`是非法的。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2012-11-20T16:02:28.483

很久以前，在第一个 C++ 标准发布之前，一些编译器实现允许您在构造函数中编写以下代码：

```
this = malloc(sizeof(MyClass)); // <<== No longer allowed 
```

该技术是控制对象类分配的唯一方法。这种做法已被标准禁止，因为 的重载`operator new`已经解决了过去通过分配 to 来解决的问题`this`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-20T15:51:15.113

你不能。如果您觉得有必要这样做，也许您应该编写一个将类指针作为第一个参数的静态方法。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-20T15:50:25.890

`this`您不能为指针赋值。如果您尝试将值分配给`this`某些东西，就像`this = &a`它会导致非法表达式一样

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-21T04:21:45.643

你不能。"this" 是一个类的每个成员函数的隐藏参数，它对于 X 类的对象的类型是 X* const。这显然意味着您不能将新值分配给“this”，因为它被定义为 const。但是，您可以修改 this 指向的值。有关详细信息，请参阅[http://www.geeksforgeeks.org/this-pointer-in-c/](http://www.geeksforgeeks.org/this-pointer-in-c/)。

# backbone.js - Handlebar编译的html无法识别backbone.js中的模板功能

> ID：13476881
> 
> 赞同：0
> 
> 时间：2012-11-20T15:49:21.500
> 
> 标签：backbone.js, underscore.js, handlebars.js

我正在进行的项目目前正在使用 Backbone.js 创建一个网站，并使用 Handlebars (http://handlebarsjs.com/) 作为模板系统。我正在尝试创建一个子视图，该子视图将 json 文档中的值获取到相应的模板中，然后将其返回给父视图。

我遇到的问题是当我使用

`Handlebars.Compile(referenceViewTemplate)`

`template`然后，当我尝试使用替换令牌时，它无法识别该功能

`this.template({ identifier: value })`

模板代码为：

```
<div id="reference-template">
  <div class="id">{{id}}</div>
  <div class="reference">{{content}}</div>
</div> 
```

主干模型为：

```
define(['underscore','backbone'], 
function(_, Backbone){
  var reference = Backbone.Model.extend({
     initialize: function(){}
  });
  return reference;
}); 
```

主干集合代码为：

```
define(['underscore','backbone','models/reference'], 
  function(_, Backbone, Reference){
  var References = Backbone.Collection.extend({
    model: Reference,
    parse:function(response){ return response; }
  });
  return new References;
}); 
```

调用参考视图的父视图中的代码是：

```
this.ref = new ReferenceView();
this.ref.model = this.model.page_refs; //page_refs is the section in the json which has the relevant content 
this.ref.render(section); //section is the specific part of the json which should be rendered in the view 
```

ReferenceView 中的代码是：

```
define([
  // These are path alias that we configured in our bootstrap
  'jquery','underscore','backbone','handlebars',
  'models/reference','collections/references','text!templates/reference.html'],
  function($, _, Backbone, Handlebars, Reference, References, referenceViewTemplate) {
    var ReferenceView = Backbone.View.extend({

    //Define the default template
    template: Handlebars.Compiler(referenceViewTemplate),   

    el: ".overlay-references",

    model: new Reference,

    events:{},

    initialize : function() {
      this.model.bind('change', this.render, this);
      return this;
    },

    // Render function
    render : function(section) {
       //this is where it says "TypeError: this.template is not a function" 
       $(this.el).append(this.template(References.get(section).get("content")));
       return this;
    }
}); 
```

我知道这需要阅读很多内容，我感谢任何抽出时间阅读的人，如果还有什么我可以提供澄清的，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T16:03:20.840

答案是显然我使用了错误的函数来编译 html。出于某种原因，我输入`Handlebars.Compiler`而不是`Handlebars.compile`

这并没有解决我项目中的所有问题（现在正在传回模板，但没有输入值），但至少它向前迈出了一步。

# android - 在 Android 上无需访问令牌即可获得点赞数和显示评论

> ID：13476887
> 
> 赞同：2
> 
> 时间：2012-11-20T15:49:39.720
> 
> 标签：android, facebook, json, facebook-page

我正在尝试制作一个显示特定页面提要的应用程序，也显示喜欢和评论。但问题是，用户无需登录 Facebook 即可查看。

如果我退出 Facebook 并访问像 .http://www.facebook.com/(PAGE_NAME)" 这样的网站，我可以看到墙上的所有帖子、点赞数以及评论。

我可以通过转到 .http://graph.facebook.com/(PAGE_NAME) 找到页面 ID，然后使用该 ID 通过以下方式获取 JSON 格式：.https://www.facebook.com/feeds /page.php?id=(PAGE_ID)&format=json。

通过使用该 URL，我可以轻松解析它，并获取整个提要：

```
String JSONObjectString = "None";
        HttpClient client = new DefaultHttpClient();
        HttpGet request = new HttpGet();
        request.setURI(new URI(url));
        JSONObjectString = client.execute(request, new BasicResponseHandler());
        JSONObject jObject = new JSONObject(JSONObjectString); 
```

但是，评论和点赞的 JSON 值为空：

```
 "comments": "",
     "likes": "", 
```

如果不提供某种 access_token/authentication 并且基本上只是“查看提要”，就不可能从 Facebook 页面获得#of 喜欢并查看评论吗？

# xml - 带有 AndEngine 和 XML-Levels 的横向滚动游戏

> ID：13476897
> 
> 赞同：0
> 
> 时间：2012-11-20T15:50:11.083
> 
> 标签：xml, andengine, side-scroller

我刚刚开始使用andengine 使用xml-levels 和box2d 进行横向滚动游戏。

有谁知道当我移动玩家时如何让关卡滚动，让玩家停留在屏幕中央？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T20:21:25.497

使用方法`Camera.setChaseEntity`（使用您的播放器对象）。

# android - 是否可以在移动应用程序中放置一个类似 Facebook 的按钮，并且在使用时，它会喜欢我的网站网址？

> ID：13476898
> 
> 赞同：0
> 
> 时间：2012-11-20T15:50:20.747
> 
> 标签：android, ios, facebook-like, facebook-authentication

我有一个 Android 和一个 iPhone 移动应用程序，我需要在其中放置一个类似 Facebook 的按钮以用于营销目的。

问题是我不确定当用户喜欢移动应用程序内部的东西时真正喜欢的是什么。我有两个应用程序（Android 和 iPhone）的网站，所以当用户喜欢移动应用程序中的某些内容时，似乎应该喜欢这个网站。

那有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T17:03:22.060

根据我的经验和我所知道的，Facebook 不会让您在移动应用程序中使用 likeButton，他们不希望用户被每个应用程序中的用户发送垃圾邮件。

从我的角度来看，有两种解决方案，但都不是完美的：

*   [您使用 Facebook OpenGraph 并为网站对象创建一个类似的操作，您可以在facebook 文档](https://developers.facebook.com/docs/concepts/opengraph/)、[OpenGraph 网络教程和](https://developers.facebook.com/docs/technical-guides/opengraph/opengraph-tutorial/)[更具体到 iOS](https://developers.facebook.com/docs/samples/)的最后一个示例中找到有关 Facebook OpenGraph 的更多信息。但是如果我没记错的话，你将无法创建一个名为“Like”的动作，我认为 facebook 会阻止它，所以不会让用户感到困惑，但我完全不确定，它仍然值得尝试。

*   第二种解决方案是制作一个简单的 UIButton，当您单击它时，您只需显示您希望用户喜欢的 facebook 页面的 web 视图。如果您想知道用户是否喜欢您的页面，您可以随时请求他的点赞，并在用户退出网页视图时尝试在其中找到您的 Facebook 页面 ID。

我希望我回答了你的问题。

如果你找到一种方法来制作一个真正的 Facebook （而不是 opengraph），直接在本地移动应用程序中，我会对了解操作方法非常感兴趣。

**编辑：**

实际上，如果要喜欢 facebook fanpage，只有第二种解决方案可以工作，至于 OpenGraph，您需要能够修改页面发送的元数据，使其适合您的对象的属性。

Opengraph 解决方案只能在您自己的网页上制作虚假的“赞”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T09:12:07.277

使用此代码。在使用此代码之前，您应该先登录 Facebook。检查 Facebook 会话是否有效，然后使用此代码。

```
WebView foll_fb = (WebView) findViewById(R.id.btn_foll_fb);    
String url = "http://www.facebook.com/plugins/like.php?layout=standard&show_faces=true&width=80&height=50&action=like&colorscheme=light&href=YOUR_URL_TO_LIKE";              
foll_fb.loadUrl(url);
foll_fb.getSettings().setJavaScriptEnabled(true);
foll_fb.requestFocus(View.FOCUS_DOWN);
foll_fb.setWebViewClient(new LikeWebviewClient()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T16:02:57.253

正确的。如果您在移动应用程序中单击“赞”按钮，大多数用户都希望他们喜欢相应的页面。如果您有一个同时适用于 android 和 iOS 应用程序的页面，那么它应该喜欢相应的页面。

如果你想知道如何做到这一点，我可以给你主要的想法。只需放置一个按钮，点击即可运行任何喜欢的东西。由于我个人没有这样做，我不确定需要运行什么。

希望这会有所帮助，但其他人可能有比我更好的答案。这意味着实际的代码。

# r - 省略轴上的间隔/拆分比例？细粒度的低和高间隔？

> ID：13476900
> 
> 赞同：0
> 
> 时间：2012-11-20T15:50:26.533
> 
> 标签：r, intervals

假设我有两个数据集，我想在一个图中绘制。

例如这样的：

```
low <- runif(10,min=10, max=50)
high <- runif(10,min=10000, max=11000)
plot(
     high,
     type="l",
     ylim=c(0,11000)
)
lines(low, type="l") 
```

我不希望 y 轴显示这些样本之间的所有值，因为这样`low`，即使存在变化，数据也会显示为平线。

因此，轴应该在 10-50 之间有更细粒度的刻度，并且应该省略 50 和 10000 之间的值。同样，区间 [10000-11000] 也应该有更细粒度的刻度。因此，`low`样品的变化也是可见的。

有没有办法实现这种行为？

如果发现这个，bt

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:09:23.210

这有用吗……？

```
set.seed(001)    
low <- runif(10,min=10, max=50)

high <- runif(10,min=10000, max=11000)
plot(
  high,
  type="l",
  ylim=c(0,11000)
)
lines(low, type="l")

plot(high,            
     type="l",              
     col="red",              
     bty='l',                
     ylab='', xlab='',      
     las=1,                 
     cex.axis=.75)     

par(new=TRUE)                

plot(low,
     type="l", 
     col="blue", 
     bty='n',                
     xaxt="n",               
     yaxt="n",               
     xlab="", ylab="", 
     cex.axis=.75)

axis(4, las=1, cex.axis=.75) 

legend('topright', c('high', 'low'), col=c('red', 'blue'), lty=1, bty='n', cex=.75) 
```

![在此处输入图像描述](../Images/f010752cd4557d53d30ca1a6f1d2c931.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:06:53.953

除了良好的图形实践问题，这可以使用**plotrix**包来完成：

```
low <- runif(10,min=10, max=50)
high <- runif(10,min=10000, max=11000)
y <- c(low,high)
x <- rep(1:10,times = 2)

library(plotrix)
yl <- c(pretty(5:70,2),pretty(9900:11000,5))
gap.plot(x,y,
        gap = c(70,9900),
        gap.axis = "y",
        ytics = yl,
        type = "l") 
```

![在此处输入图像描述](../Images/cc5a80e087602a6079d2f858e99bd4a8.png)

# java - 带有配置文件的构建 maven 项目

> ID：13476902
> 
> 赞同：1
> 
> 时间：2012-11-20T15:50:31.227
> 
> 标签：java, maven, osgi

我在定义配置`settings.xml`文件的文件夹中有一个文件。当我使用命令构建我的 Maven 项目时，会生成如下内容的文件：`.m2``nexus``install``_maven.repositories`

```
bundle-1.1.0.pom>=
bundle-1.1.0.jar>= 
```

但我意识到我需要一个包含以下内容的文件：

```
bundle-1.1.0.pom>nexus=
bundle-1.1.0.jar>nexus= 
```

如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T02:38:59.563

使用 mvn -P 并为 arg 值选择要使用的配置文件，否则如果未指定，它将诉诸默认 user.dir/.m2

# javascript - IE 事件回调对象 JavaScript

> ID：13476905
> 
> 赞同：3
> 
> 时间：2012-11-20T15:50:43.743
> 
> 标签：javascript, internet-explorer, event-handling, callback

> **可能重复：**
> [如何使用 attachEvent 引用调用者对象（“t​​his”）](https://stackoverflow.com/questions/4590122/how-to-reference-the-caller-object-this-using-attachevent)

**这不是完全重复的。与假设的副本相比，请参阅下面的答案！**

我的术语可能有点偏离，所以请随时纠正我。也许这就是为什么我似乎找不到任何相关的原因。*请*不要图书馆。

我有一个事件处理程序，它调用一个回调函数。花哨，对吧？在 IE<9`this`中，处理程序中的对象是窗口。我不知道为什么，或者如何访问正确的对象。

```
if (document.addEventListener){
    element.addEventListener(event, callback, false);
} else {
    element.attachEvent('on' +event, callback);
} 
```

这部分**有效**。

这部分没有：

```
function callback(event){
    console.log(this);
} 
```

`this`在 IE 中正在返回，而它返回在每个其他浏览器`[object Window]`中调用该函数的元素。`callback`这从我的完整脚本中大大减少了，但这应该是相关的所有内容。

**编辑**

@metadings 提供的这个链接 [How to reference the caller object ("this") using attachEvent](https://stackoverflow.com/questions/4590122/how-to-reference-the-caller-object-this-using-attachevent)非常接近。但是，仍然存在两个问题。

1）我需要同时获取`event object`和`DOM element`调用这个函数。

2) 该事件以委托方式处理：可能有子 DOM 元素触发该事件，这意味着`event.target`不一定（在我的情况下，通常不是）具有侦听器的元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T16:57:03.880

好吧，关闭是正确的方法。以下是上述场景的答案：

```
(function(element, event){
    element.attachEvent(
        'on' + event, 
        function(e){
            callback(e, element);
        }
    );
})(element, event); 
```

这样做！回调接收`e`作为`event object`和`element`作为`DOM object`触发侦听器（不一定是事件目标）。

然后在回调中：

```
function callback(event, obj){
    obj = obj || this;
    console.log(event, obj);
} 
```

按照链接中的建议，尝试使用匿名函数和 .call，在 .call`this`内部`callback()`进行`event object`，但没有成功。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:38:45.407

我投票结束了这个，但似乎你错过了论点，所以像这样

```
element.attachEvent("on"+event, function(){ callback.apply( element, arguments ); }); 
```

# java - eclipse rcp 进度监视器

> ID：13476908
> 
> 赞同：1
> 
> 时间：2012-11-20T15:50:52.227
> 
> 标签：java, progress-bar, eclipse-rcp, jobs

我正在使用 Job 类来创建一些任务，并且正在使用进度监视器在进度视图中显示进度。

```
 Job createNewJobRun(final int i, final Job previousJob) {
    Job job = new Job("Test Job " + i) {
        @Override
        protected IStatus run(IProgressMonitor monitor) {
            monitor.beginTask("Job is running", 100); //$NON-NLS-1$

            if (previousJob != null) {
                try {
                    previousJob.join();

                } catch (InterruptedException e1) {
                    e1.printStackTrace();
                }
            }
                            // do the real work 
            monitor.done();
            return Status.OK_STATUS;
        }
    };

    job.schedule();
    return job;

} 
```

我不想并行但顺序地运行作业，如何在进度视图中初始化作业以显示将在前一个完成后执行。上面的代码只是等待前一个，所以它在第二个作业之后阻塞并且没有显示进度条......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T08:46:25.923

调度规则应如下所示：

```
 public class MutexRule implements ISchedulingRule {
      public boolean isConflicting(ISchedulingRule rule) {
         return rule == this;
      }
      public boolean contains(ISchedulingRule rule) {
         return rule == this;
      }
   } 
```

设置规则和调度：

```
 Job job1 = new SampleJob();
   Job job2 = new SampleJob();
   MutexRule rule = new MutexRule();
   job1.setRule(rule);
   job2.setRule(rule);
   job1.schedule();
   job2.schedule() 
```

来源：[Eclipse Wiki：FAQ 如何防止两个作业同时运行？](http://wiki.eclipse.org/FAQ_How_do_I_prevent_two_jobs_from_running_at_the_same_time?)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T17:11:06.207

You need to look at scheduling rules on Eclipse Jobs.

This should help. [http://www.eclipse.org/articles/Article-Concurrency/jobs-api.html](http://www.eclipse.org/articles/Article-Concurrency/jobs-api.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T17:00:27.653

一个可能的解决方案是使用@TomSeidel 和@SambiReddy 提出的调度规则，但是这个解决方案有很多限制。

特别是，它仅适用于您在所有先前的作业完成之前不安排多个新作业，因为通常使用的调度规则没有顺序的概念。这可以修复，尽管结果通常很难维护。

你没有写任何关于有问题的工作，但如果我们谈论一遍又一遍地重复相同的工作，那么简单的解决方案是在工作完成之前重新安排工作（只是）。

```
Job job = new Job("Test Job " + i) {
    @Override
    protected IStatus run(IProgressMonitor monitor) {
        monitor.beginTask("Job is running", 100); //$NON-NLS-1$

                        // do the real work 
        monitor.done();

        schedule(...);
        return Status.OK_STATUS;
    }
};

job.schedule(); 
```

# mysql - WSO2 App Store 在尝试针对 mysql 保存用户应用程序时抛出错误

> ID：13476915
> 
> 赞同：2
> 
> 时间：2012-11-20T15:51:11.973
> 
> 标签：mysql, transactions, wso2

当我尝试创建或编辑应用程序时，API Store 抛出错误

```
java.sql.SQLException: Can't call commit when autocommit=true 
```

我添加了设置

```
init-command='set autocommit=0' 
```

到 my.cnf 文件

我还添加了标志：

```
?relaxAutoCommit=true 
```

连接字符串，但无济于事。我继续收到此错误。

我对 WSO2_CARBON_DB 和 WSO2AM_DB 都使用相同的 mysql 数据库，而且我有一个发布者节点和两个单独的存储节点，它们都指向同一个 mysql 数据源。

我注意到应用程序编辑已保存（或新应用程序已创建），但控制台中仍抛出异常，并且用户界面中出现错误消息（根据此问题顶部的错误）。

在 WSO2 conf 文件中是否有其他设置，我必须对其进行调整才能使其正常工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T07:08:04.277

将`autoReconnect`和`relaxAutoCommit`标志添加到文件中定义的“WSO2AM_DB”数据源的 jdbc url `master-datasources.xml`。这将解决您的问题。

```
<configuration>

<url>jdbc:mysql://localhost:3306/AM_DB?autoReconnect=true&amp;relaxAutoCommit=true</url>

<username>xxxx</username>

<;password>xxxxx</password> 
```

编辑：我更新了 url 以反映转义 & 符号的正确语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T13:02:14.050

只是为了完整起见，JDBC URL 应该是

jdbc:mysql://localhost:3306/WSO2CARBON_DB?autoReconnect=true&relaxAutoCommit=true

# apache-flex - flex 4 组中的中心元素

> ID：13476917
> 
> 赞同：2
> 
> 时间：2012-11-20T15:51:15.750
> 
> 标签：apache-flex, actionscript, flex4

我正在使用带有简单对齐的 flex 4 GUI，但不知道为什么。

我有 button1、button2 和一个文本字段。我想将它们水平对齐，并将文本垂直居中。对于以下代码，我看到以下输出。

```
_______   ______
|bt1   | |bt2   |   text1
|______| |______| 
```

我的问题是；1）为什么我在 btn 1 verticalCenter="10" 和 btn2 verticalCenter="-10" 上发送的属性仍然对齐？我不应该看到一个在上升，一个在下降吗？2 ) 为什么我的 text1 顶部对齐，即使我将它设置为 verticalCenter=0，我在组中尝试过或不尝试过。

多谢你们

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark"
    xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955"
    minHeight="600">
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>
    <s:Group minWidth="100">
        <s:layout>
            <s:HorizontalLayout/>
        </s:layout>
        <s:Button label="myButton" click="" horizontalCenter="0"
            verticalCenter="10"/>
        <s:Button label="myButton" click="" verticalCenter="-10"/>
        <s:Group verticalCenter="0" horizontalCenter="0">
            <s:Label text="hello" color="#FFFF" verticalCenter="0"
                textAlign="center" />
        </s:Group>

    </s:Group>
</s:Application> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T18:30:16.867

由于这是一个常见问题，因此可能有助于其他人理解为什么会发生这种情况。

当您使用您在“布局对象”上设置的一个`HorizontalLayout`或`VerticalLayout`某些属性时，不会使用。发生这种情况是因为这些属性在垂直/水平布局中实际上不起作用或没有意义。

垂直/水平布局忽略的布局属性：

*   `x`和`y`坐标
*   `horizontalCenter`和`verticalCenter`
*   `top`, `bottom`, `left`,`right`约束

上述属性将适用于默认`BasicLayout`类。

正如@Mahesh Parate 的回答所示，垂直/水平布局确实允许使用`horizontalAlign`and`verticalAlign`属性使内容居中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T18:17:06.443

下面的代码可能对您有所帮助： - 在 Horizo​​ntalLayout 中添加 verticalAlign="middle" 这将解决您的问题。

```
<?xml version="1.0" encoding="utf-8"?>
<s:Application xmlns:fx="http://ns.adobe.com/mxml/2009" xmlns:s="library://ns.adobe.com/flex/spark"
               xmlns:mx="library://ns.adobe.com/flex/mx" minWidth="955"
               minHeight="600">
    <fx:Declarations>
        <!-- Place non-visual elements (e.g., services, value objects) here -->
    </fx:Declarations>
    <fx:Script>
        <![CDATA[

            protected function onClickHandler(event:MouseEvent):void
            {
                // TODO Auto-generated method stub

            }

        ]]>
    </fx:Script>
    <s:Group minWidth="100" >
        <s:layout>
            <s:HorizontalLayout verticalAlign="middle"/>
        </s:layout>
        <s:Button label="myButton" click="onClickHandler(event)" horizontalCenter="0"
                  verticalCenter="10"/>
        <s:Button label="myButton" click="onClickHandler(event)" verticalCenter="-10"/>
        <s:Group verticalCenter="0" horizontalCenter="0">
            <s:Label text="hello" color="#FFFF" verticalCenter="0"
                     textAlign="center" />
        </s:Group>

    </s:Group>
</s:Application> 
```

# ios - IOS ARC NSMutableArray我需要在为其分配新内存之前删除AllObjects吗

> ID：13476920
> 
> 赞同：0
> 
> 时间：2012-11-20T15:51:20.963
> 
> 标签：ios, memory, nsmutablearray, automatic-ref-counting

```
NSMutableArray * arrayTest;

-(void) setContent
{
  //must I call [array removeAllObjects]; ? 
  arrayTest = [[NSMutableArray alloc] init]

  [arrayTest addObject:@"str"];
  ...//add many objects
} 
```

我在不同的代码片段中调用此函数。我需要先删除arrayTest的AllObjects，然后每次都为arrayTest分配内存吗？我使用 ARC 。我不希望每次调用此函数时我的应用程序内存都增加。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:53:25.013

不，你所拥有的一切都很好。您无需`removeAllObjects`在 ARC 或非 ARC 下调用。

当旧数组被释放时，它将负责释放旧数组中的所有对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:58:33.163

在分配内存之前检查 arrayTest 是否存在。如果不这样做，则每次调用该方法时都会有一个新数组（假设您想保留该数组及其内容一段时间）。甚至更好.. 将 alloc 移到类的 init 中。

```
-(void) setContent
{
  if(!arrayTest){
      arrayTest = [[NSMutableArray alloc] init];
  }

  [arrayTest addObject:@"str"];
  ...//add many objects
} 
```

# mysql - MySQL Count rows from query with left join

> ID：13476923
> 
> 赞同：0
> 
> 时间：2012-11-20T15:51:27.527
> 
> 标签：mysql, join, count

我有一个看起来像这样的查询：

```
 Select x.date, x.id, x.phone,
    x.product, xy.policy,xy.date 
 from (y left join z 
            on y.customer_id=z.customer_id)
    left join x 
       on x.id=z.id 
    left join xy 
       on xy.id=x.id 
 where x.date > '2000-01-01'  
    and y.detail =foo 
    and xy.policy like 'foo_____'  
    and xy.policy_type = foo; 
```

如何计算返回的行数？

我尝试使用 SQL_CALC_FOUND_ROWS 但我不能完全适应这个查询。

任何帮助将不胜感激。

谢谢，斯特凡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T15:56:58.983

Easiest is just add a subquery...

```
 Select x.date, x.id, x.phone,
    x.product, xy.policy,xy.date,
    (Select Count(*) 
     From (y left join z on y.customer_id=z.customer_id)
        left join x on x.id=z.id 
        left join xy  on xy.id=x.id 
     where x.date > '2000-01-01'  
       and y.detail =foo 
       and xy.policy like 'foo_____'  
       and xy.policy_type = foo) RecordCount  
 from (y left join z 
            on y.customer_id=z.customer_id)
    left join x 
       on x.id=z.id 
    left join xy 
       on xy.id=x.id 
 where x.date > '2000-01-01'  
    and y.detail =foo 
    and xy.policy like 'foo_____'  
    and xy.policy_type = foo; 
```

If all you want is the count, then:

```
 Select Count(*) 
 From (y left join z on y.customer_id=z.customer_id)
    left join x on x.id=z.id 
    left join xy  on xy.id=x.id 
 where x.date > '2000-01-01'  
   and y.detail =foo 
   and xy.policy like 'foo_____'  
   and xy.policy_type = foo 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T15:58:42.163

你可以写：

```
SELECT COUNT(1)
  FROM y
  JOIN z
    ON y.customer_id = z.customer_id
  JOIN x
    ON x.id = z.id
  JOIN xy
    ON xy.id = x.id
 WHERE x.date > '2000-01-01'
   AND y.detail = foo
   AND xy.policy LIKE 'foo_____'
   AND xy.policy_type = foo
; 
```

（请注意，我冒昧地将您`LEFT JOIN`的 s 更改为常规`JOIN`s，因为该`WHERE`子句阻止它们实际上作为`LEFT JOIN`s 运行。如果您想要真正`LEFT JOIN`的 s，您可以将条件从`WHERE`子句移动到`ON`子句中：

```
SELECT COUNT(1)
  FROM y
  LEFT
  JOIN z
    ON z.customer_id = y.customer_id
  LEFT
  JOIN x
    ON x.id = z.id
   AND x.date > '2000-01-01'
  LEFT
  JOIN xy
    ON xy.id = x.id
   AND xy.policy LIKE 'foo_____'
   AND xy.policy_type = foo
 WHERE y.detail = foo
; 
```

)

# yii - Yii：是否可以从外部页面链接指定的 CJuiTabs？

> ID：13476925
> 
> 赞同：2
> 
> 时间：2012-11-20T15:51:48.103
> 
> 标签：yii

我有一个带有 CjuiTab 的页面，有七个标签。

我需要一个从外部页面或同一页面进入的链接，以直接刷新指定选项卡上的页面。

我需要使用 ChtmlLink，但如何将 '#' 附加到 url 的末尾？

```
CHtml::link (Yii::t('general','Annulla'),
             array("company/update", 
            'id'=> $companyId) 
```

在哪里/如何附加“#contactTab”！？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T16:06:21.210

你只需要传递一个`'#'=>'value'`. url 参数的值`CHtml::link`最终传递给`CController::createUrl`，并且[文档状态](http://www.yiiframework.com/doc/api/1.1/CController#createUrl-detail)：

> 额外的 GET 参数（名称=>值）。名称和值都将是 URL 编码的。如果名称为“#”，则对应的值将被视为锚点，并将附加在 URL 的末尾。

所以尝试：

```
CHtml::link (Yii::t('general','Annulla'),
    array(
        "company/update", 
        'id'=> $companyId,
        '#'=>'contactTab'
    )
); 
```

* * *

更新：对于相同的页面链接，您需要在设置浏览器 url*后使用一些 javascript 重新加载页面：*

```
CHtml::link (Yii::t('general','Annulla'),
    array(
        "company/update", 
        'id'=> $companyId,
        '#'=>'contactTab'
    ),
    array('onclick'=>'setTimeout("location.reload(true);",100);')
); 
```

（不确定这是否是重新加载的最佳方式）

# algorithm - 平均大于或等于 k 的最长连续子数组

> ID：13476927
> 
> 赞同：4
> 
> 时间：2012-11-20T15:51:54.987
> 
> 标签：algorithm, array-algorithms

考虑一个包含 N 个整数的数组。找到最长的连续子数组，使其元素的平均值大于（或等于）给定数 k。

显而易见的答案具有 O(n^2) 复杂度。我们能做得更好吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T16:25:50.233

我们可以通过在 O(n) 时间内从所有值中减去 k 来将此问题简化为总和 >= 0 的最长连续子数组。现在让我们计算前缀和：

```
index    0     1     2     3     4     5     6
array          2     -3    3     2     0     -1
prefix   0     2     -1    2     5     5     4 
```

现在这个问题是找到距离最远的两个索引`prefix_right - prefix_left >= 0`。让我们创建一个新的前缀索引数组并按前缀排序，然后是索引。

```
index    2     0     1     3     6     4     5
prefix   -1    0     2     2     4     5     5 
```

然后我们可以做一个从右到左的扫描，为每个前缀计算前缀大于或等于当前前缀的最大索引：

```
index    2     0     1     3     6     4     5
prefix   -1    0     2     2     4     5     5
maxind   6     6     6     6     6     5     5 
```

现在，让我们回到原来的前缀数组。对于每个前缀-索引对，我们对新数组进行二进制搜索以找到最小前缀 >= 当前前缀。我们从二进制搜索前缀的 maxind 中减去当前前缀的索引，以检索从当前索引开始的最佳可能序列长度。取最大长度的序列。

由于排序和 n 次二进制搜索，该算法为 O(n log n)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-01T02:45:21.493

我们可以在 O(n) 时间和 O(n) 空间复杂度内解决问题：
我尝试过简单且最优的方法。
简而言之，这个问题涉及两个步骤：
(1) 从每个 ar[i] 中减去 k，并在新数组中找到累积值。让我们将新数组称为 cumArr[]。
(2) 现在问题变成在 CumArr[] 中找到 max(j-1) 使得 j>i 并且 cumArr[j]>cumArr[i]。这一步是一个著名的问题，可以在很多地方找到。

**这是运行代码的详细信息：http:** [//codeshare.io/Y1Xc8](http://codeshare.io/Y1Xc8)

可能有可以轻松处理的小角落案例。
让我知道你的想法的朋友。

# python - 使用 python 64bit win32com (Solidworks-API) 时发生异常：Exception SldWorks.Application.InvokeTypes

> ID：13476933
> 
> 赞同：1
> 
> 时间：2012-11-20T15:52:30.733
> 
> 标签：python, 64-bit, win32com, solidworks

我的 Windows Server 2003 标准 x64 版上有一个 64 位 Python 2.7 (python-2.7.3.amd64.msi) 和一个 64 位 win32-Extension (pywin32-218.win-amd64-py2.7.exe)。我的应用程序是 SolidWorks 2012 x64 版。然后我生成

```
C:\Python27\Lib\site-packages\win32com\client\makepy.py "D:\Program Files\SolidWorks Corp\SolidWorks\sldworks.tlb" the file 83A33D31-27C5-11CE-BFD4-00400513BB57x0x20x0.py 
```

与

```
C:\Python27\Lib\site-packages\win32com\client\makepy.py "D:\Program Files\SolidWorks Corp\SolidWorks\swconst.tlb" the file 4687F359-55D0-4CD3-B6CF-2EB42C11F989x0x20x0.py 
```

我的以下代码在具有 32 位 Python 2.4 和 32 位 win32-Extension 的 32 位 Windows XP 上运行良好。但是在我的 64 位服务器上，我通过调用 ExitApp() 方法得到一个异常“SldWorks.Application.InvokeTypes”。是什么原因，我该如何解决这个问题？谢谢你的提示，托马斯

```
 try:

        pythoncom.CoInitializeEx(pythoncom.COINIT_APARTMENTTHREADED)

        sldworks = gencache.EnsureModule('{83A33D31-27C5-11CE-BFD4-00400513BB57}', 0x0, 20, 0) 
        print "sldworks = " + str(sldworks)       
        swconst = gencache.EnsureModule('{4687F359-55D0-4CD3-B6CF-2EB42C11F989}', 0x0, 20, 0) 
        print "swconst = " + str(swconst)   

        sw = sldworks.ISldWorks(DispatchEx('SldWorks.Application'))  
        print "sw = " + str(sw)   

        sw.ExitApp() 

    except Exception, value:        
        print "Exception occured, value = ", value 
```

这里的印刷品：

```
sldworks = module 'win32com.gen_py.83A33D31-27C5-11CE-BFD4-00400513BB57x0x20x0' from 'C:\Python27\lib\site-packages\win32com\gen_py\83A33D31-27C5-11CE-BFD4-00400513BB57x0x20x0.pyc'  

swconst = module 'win32com.gen_py.4687F359-55D0-4CD3-B6CF-2EB42C11F989x0x20x0' from 'C:\Python27\lib\site-packages\win32com\gen_py\4687F359-55D0-4CD3-B6CF-2EB42C11F989x0x20x0.pyc'        

sw = win32com.gen_py.SldWorks 2012 Type Library.ISldWorks instance at 0x82548360  

Exception occured, value = SldWorks.Application.InvokeTypes 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T12:39:00.690

和

```
sw = win32com.client.Dispatch("SldWorks.Application") 
```

反而

```
sw = sldworks.ISldWorks(DispatchEx('SldWorks.Application')) 
```

并且使用 Python 2.4 32 位和 win32 扩展 32 位它可以正常工作。

托马斯

迪森Beitrag melden Beitrag löschen

# java - 意图使用警报对话框时的Android错误

> ID：13476939
> 
> 赞同：-2
> 
> 时间：2012-11-20T15:52:52.017
> 
> 标签：java, android, eclipse

我有警报对话框，如果我按是，它将转到其他活动

这是我的代码

```
public class DialogActivity extends Activity {
    final Context context = this;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_dialog);

        AlertDialog.Builder alertDialogBuilder = new AlertDialog.Builder(
                context);

            alertDialogBuilder.setTitle("Your Title");

            alertDialogBuilder
                .setMessage("Click yes to exit!")
                .setCancelable(false)
                .setPositiveButton("Yes",new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog,int id) {

                        Intent intent = new Intent(DialogActivity.this,TaskActivity.class);
                        startActivity(intent);
                    }
                  })
                .setNegativeButton("No",new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog,int id) {

                        DialogActivity.this.finish();
                    }
                });

                AlertDialog alertDialog = alertDialogBuilder.create();
                alertDialog.show();
    }

} 
```

这是我的 logcat 错误

```
11-15 22:01:16.882: E/AndroidRuntime(2613): FATAL EXCEPTION: main
11-15 22:01:16.882: E/AndroidRuntime(2613): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.finaloop/com.example.finaloop.TaskActivity}: java.lang.NumberFormatException: unable to parse 'null' as integer
11-15 22:01:16.882: E/AndroidRuntime(2613):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at android.app.ActivityThread.access$1500(ActivityThread.java:117)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at android.os.Looper.loop(Looper.java:123)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at android.app.ActivityThread.main(ActivityThread.java:3683)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at java.lang.reflect.Method.invokeNative(Native Method)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at java.lang.reflect.Method.invoke(Method.java:507)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at dalvik.system.NativeStart.main(Native Method)
11-15 22:01:16.882: E/AndroidRuntime(2613): Caused by: java.lang.NumberFormatException: unable to parse 'null' as integer
11-15 22:01:16.882: E/AndroidRuntime(2613):     at java.lang.Integer.parseInt(Integer.java:356)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at java.lang.Integer.parseInt(Integer.java:332)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at java.lang.Integer.valueOf(Integer.java:506)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at com.example.finaloop.TaskActivity.onCreate(TaskActivity.java:49)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
11-15 22:01:16.882: E/AndroidRuntime(2613):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
11-15 22:01:16.882: E/AndroidRuntime(2613):     ... 11 more 
```

请帮助我..错误是什么？以及如何解决？

我已经坚持并强调要完成这个程序..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T15:54:13.310

```
 Caused by: java.lang.NumberFormatException: unable to parse 'null' as integer 
```

问题在于 TaskActivity `. Not in`DialogActivity `. You are passing`null` 作为输入并试图将其解析为整数。

`TaskActivity.java` 第 49 行是有问题的行。

# wpf - 以非管理员用户身份安装的 WPF 浏览器应用程序 + .NET Framework

> ID：13476941
> 
> 赞同：0
> 
> 时间：2012-11-20T15:52:55.750
> 
> 标签：wpf, xbap

我的应用程序使用 .net 4 客户端配置文件，并且需要安装在没有网络框架且由非管理员用户安装的机器上。任何人都可以确认它是否可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:54:36.037

You will need to enable your application to be deployed via [ClickOnce](http://msdn.microsoft.com/en-us/library/t71a733d%28v=vs.80%29.aspx)

# css - flexslider border-radius 不会在 Chrome、Safari 中包裹图像，但会在 Firefox 中

> ID：13476942
> 
> 赞同：6
> 
> 时间：2012-11-20T15:52:58.620
> 
> 标签：css, flexslider

我正在尝试使用幻灯片动画选项在 flexslider 上查看舷窗窗口。基本上，图像会滑动，但会被屏蔽成一个圆圈，我正在尝试使用边框半径和溢出来完成此操作：隐藏在 flexslider 包装器上。

在 Firefox 中查看此页面以查看所需的结果，因为它在那里工作。然后看到它不在 Chrome 或 Safari 中。这是链接（幻灯片是我的照片）：http: [//imjoeybrennan.com/about.html](http://imjoeybrennan.com/about.html)

任何帮助深表感谢！谢谢，乔伊

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-20T16:07:32.033

只是帮你解决了一个问题。这个也很简单。它在 chrome 或 safari (webkit) 中不起作用的原因是，当使用溢出隐藏 + 位置相对和边框半径时，webkit 存在一个已知错误。简单的解决方法是将 svg webkit 掩码添加到同一元素：

```
.joey_pic .flexslider {
-webkit-border-radius: 200px;
-moz-border-radius: 200px;
border-radius: 200px;
-webkit-mask-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC);
overflow: hidden;
} 
```

这也可能导致锯齿状边缘，因此另一种可能的解决方案是在 flexslider 中的图像上设置边框半径：（这是您在下面的图像上使用悬停过渡所做的操作）

```
.flexslider .slides img {
max-width: 100%;
display: block;
border-radius: 100px;
} 
```

希望这可以帮助

# windows-7 - WM_GESTURE/WM_GESTURENOTIFY 未在带有 iIyama plt2250 监视器的 Windows 7 上调度。我究竟做错了什么？

> ID：13476945
> 
> 赞同：1
> 
> 时间：2012-11-20T15:53:02.143
> 
> 标签：windows-7, touch, gestures

我的任务是为我们的产品添加手势支持，这在新的 Windows 8 机器上非常简单——我刚刚将 WM_GESTURE 添加到我们的 wndproc 中，一切都按预期工作。然而，当要让它在 Win7 机器上工作时，情况就大不相同了。我根本没有收到任何手势信息。甚至 spy++ 也没有显示任何手势消息被发送到我的应用程序。我已经设法使用 RegisterTouchWindow() 让触摸消息正常工作，但我知道当触摸被禁用时我不会收到手势消息，所以这只是为了测试目的。我在某处读到“轻弹”可能会干扰，所以我从控制面板和使用 SetOpt() 的代码中都禁用了轻弹。我什至尝试过使用 SetWindowsHookEx 连接到 GetMessage。我所做的一切都不起作用。我' 已经尝试了 Microsoft Touch Pack 中的示例程序，并且手势似乎在那里工作，因为一切都按预期工作。我已经阅读了我能找到的所有文档，但仍然无法弄清楚出了什么问题。任何人都可以对此提供更多见解吗？我觉得它应该“正常工作”，但事实并非如此！

提前致谢。

# android - 在android上重绘画布

> ID：13476947
> 
> 赞同：0
> 
> 时间：2012-11-20T15:53:09.110
> 
> 标签：android, bitmap, android-canvas

我有画布和绘制位图的自定义视图。设置画布透明，当我用透明区域绘制位图时，我看不到透明区域。但是，当我设置一些画布颜色时，我可以看到这种颜色。

```
snowflakesTriangle = Bitmap.createScaledBitmap(snowflakesTriangle, realBmpWidth,realBmpHeight, true);

SnowFlakeView surface = (SnowFlakeView)findViewById(R.id.snow_flake_view);
surface.setZOrderOnTop(true);
SurfaceHolder holder = surface.getHolder();
holder.setFormat(PixelFormat.TRANSPARENT);

public void onDraw(Canvas canvas) {  
canvas.drawARGB(0, 25, 67, 178);  
usersTriangle = getResizedBitmap(snowflakesTriangle, relativeBmpWidth, relativeBmpHeight);
canvas.drawBitmap(usersTriangle, marginForBmp, marginForBmp, null);  
drawPoints(canvas);  
} 
```

我该如何解决这个问题？

# memory - 如何读取块中的字节以避免内存不足异常？或者是其他东西

> ID：13476950
> 
> 赞同：1
> 
> 时间：2012-11-20T15:53:20.940
> 
> 标签：memory, byte, out

在搜索并尝试找到 2 天的解决方案后，我最终决定在这里发帖寻求帮助...

我有一个读取和写入文件字节的代码（如十六进制编辑器），从这里取得的效果非常好：[http](http://www.novahq.net/forum/showthread.php?t=42592) ://www.novahq.net/forum/showthread.php?t= 42592 代码如下：

```
Public Class Form1
    Private Shared Function HexStringToByteArray(ByRef strInput As String)
As Byte()
        Dim length As Integer
        Dim bOutput As Byte()
        Dim c(1) As Integer
        length = strInput.Length / 2
        ReDim bOutput(length - 1)
        For i As Integer = 0 To (length - 1)
            For j As Integer = 0 To 1
                c(j) = Asc(strInput.Chars(i * 2 + j))
                If ((c(j) >= Asc("0")) And (c(j) <= Asc("9"))) Then
                    c(j) = c(j) - Asc("0")
                ElseIf ((c(j) >= Asc("A")) And (c(j) <= Asc("F"))) Then
                    c(j) = c(j) - Asc("A") + &HA
                ElseIf ((c(j) >= Asc("a")) And (c(j) <= Asc("f"))) Then
                    c(j) = c(j) - Asc("a") + &HA
                End If
            Next j
            bOutput(i) = (c(0) * &H10 + c(1))
        Next i
        Return (bOutput)
    End Function

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As
System.EventArgs) Handles Button1.Click
        Dim myFile As String = "..\..\Test.jpg"
        Dim myBytes As Byte() =
My.Computer.FileSystem.ReadAllBytes(myFile)
        Dim txtTemp As New System.Text.StringBuilder()
        For Each myByte As Byte In myBytes
            txtTemp.Append(myByte.ToString("X2"))
        Next
        RichTextBox1.Text = txtTemp.ToString()
    End Sub

    Private Sub Button2_Click(ByVal sender As System.Object, ByVal e As
System.EventArgs) Handles Button2.Click
        Dim myFile As String = "..\..\Test2.jpg"
        Dim myBytes As Byte() = HexStringToByteArray(RichTextBox1.Text)
        My.Computer.FileSystem.WriteAllBytes(myFile, myBytes, False)
    End Sub
End Class 
```

这很好用，但仅适用于中小型文件。如果我尝试加载 512MB 或更大的文件，我将收到“System.OutOfMemoryException”错误。

我知道为了完成这项工作（读取更大的文件而不会出错）我必须读取小块文件（或任何你想命名的块），或者我想可能逐字节读取它......

唯一的问题是我找不到办法。我确实找到了一些代码，但由于某种原因我无法使这些代码工作:(

如果有人可以推动我这样做，我很感激。

...但是，我在想，也许我不需要读取整个文件，因为我只需要在文件末尾添加一些字节，然后再次删除它们。

**我将尝试解释我需要什么：**

我只需要`504B0506000000000000000000000000000000000000`在 zip 的末尾添加这个“”字节，然后就可以盲/隐藏 zip 的内容，然后我需要再次读取并删除这些字节。

**a) 将字节追加到文件末尾**

**b) 再次删除这些字节**

这听起来很简单，但是从我发现的所有代码和示例中，我无法使它们适应我的代码。

谢谢

# excel - Excel 文件作为 HTTP 发布方法响应

> ID：13476955
> 
> 赞同：0
> 
> 时间：2012-11-20T15:53:30.210
> 
> 标签：excel, http, post, get

在我的应用程序中，我使用 GET 方法获取 Excel 文件。url 实际上包含服务器生成 Excel 文件所需的参数。但是，有时，参数可能会变得很长（超过 2000 个字符）。

我正在考虑使用 POST 方法，但似乎 POST 方法不能返回文档。我对吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T16:00:42.813

不，您如何请求，比如说`GET`，`PUT`和`POST`，并不一定会影响您响应的服务器。

如何做出响应取决于服务器上的程序。如果您想在 POST 请求后发送二进制文件，那是非常酷的。

只需看看 megaupload、rapidshare 等网站。在您`POST`输入验证码后，它们都会向您发送一个文件。

# java - 在 Eclipse 上运行动态 Web 项目会在 Tomcat 7 中引发 404 错误

> ID：13476957
> 
> 赞同：4
> 
> 时间：2012-11-20T15:53:37.900
> 
> 标签：java, eclipse, tomcat, build, http-status-code-404

我不完全确定为什么会发生这种情况。

现在我能够构建项目而不会遇到任何问题，并且它部署到我正在运行的 eclipse tomcat 服务器

![这就是我的目录结构的样子。](../Images/b848ea55b3ad9f494d0a26b070bf5927.png)

所以记住这一点，这里的索引是 hera.jsp，我在 web.xml 文件中设置了它：

![Web.xml 文件](../Images/3deda1c0e15fdc1408ed9f361481d160.png)

更糟糕的是，似乎无论我尝试什么，我总是会收到同样的错误消息：

![404](../Images/0656bad9fe4332099834e8a208d928be.png)

在发布之前，我能想到的让这个更完整的是我的构建路径和服务器设置，所以这里也是。

![服务器](../Images/ba1cced42f1ba0b52c836ace14a51374.png) ![构建路径](../Images/aeff794bf69ca1631f285fe459f148fa.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T16:22:17.050

我有类似的问题。首先：

1.  检查是否所有的源都复制到了tomcat7 webapps，尤其是hera/WEB-INF/web.xml。如果它不存在，请尝试在您的项目中创建虚拟文件夹，例如“hera/fix”，并在您的“项目属性->部署程序集”中添加此文件夹（因此，“hera/fix -> /”映射应该被创建）。当 eclipse 插件不想复制 web.xml 时，这对我有用。

2.  如果所有需要的库都在那里，请检查“项目属性->部署程序集”，如果没有，请添加它们。

3.  检查为什么 Eclipse 项目中的 src 有问题，因为这可能会中断或冲突来自 Eclipse 的动态项目部署。

希望能帮助到你。

# security - 那么仅在客户端验证表单是否安全？

> ID：13476959
> 
> 赞同：9
> 
> 时间：2012-11-20T15:53:39.313
> 
> 标签：security, validation, client-side-validation, server-side-validation

当然，我知道服务器端验证是**必须**的。

我正在使用 jQuery 验证表单输入并同时使用 jquery ajax 进行服务器端（PHP）验证。*所以我想它可能是安全的，因为它在启用 javascript 时*对双方进行验证。

好吧，这是我的问题...

但是，如果用户在他的浏览器上*禁用了 javascript*，并且如果一些坏人试图通过编辑我的客户端脚本来做坏事怎么办？

因为我正在通过 jquery ajax 进行服务器端验证，并且我计划不直接在 php script(action="some.php") 中验证它们，即使启用了用户的 javascript。

那么……它还安全吗？

对不起我的英语不好，希望你不介意。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-20T15:59:16.503

不，这不安全。提交表单*后*，您应该始终在服务器端验证您的数据。提交表单之前的客户端验证和 AJAX 验证只会通过对无效数据提供更快的反馈来增强用户体验。客户端验证和 AJAX 提交前验证都不会也不能保护您免受恶意制作的表单提交。攻击者和滥用者通常甚至不使用浏览器来向您的服务器提交数据。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-20T15:56:36.347

My rules are fairly simple...

1.  If you care about your data, then you must validate on the server.
2.  If you care about your user experience, then you must validate on the client.

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-20T16:00:06.187

由于任何访问者都可以阅读 javascript，并且可以使用最新的浏览器轻松编辑，因此任何具有一点编程技能的人都可以立即绕过您的 javascript 验证。因此，您也应该始终在服务器端进行验证。

# asp.net - Asp.net + Razor 2 + MySQL & iFrame 显示

> ID：13476960
> 
> 赞同：-2
> 
> 时间：2012-11-20T15:53:40.583
> 
> 标签：asp.net, mysql, iframe

好的，基本上我想显示我的 MySQL 数据库中的 iframe（电影 iframe）但我想在按钮单击时显示 iframe（通过 AJAX？）

当我在数据库中为电影创建 iframe 并使用 Razor2 (WebMatrix) 调用某个 iframe 时，我得到的 iframe 源代码不是实际的（JwPlayer/Flash/Movie Player）常规 html 文档中的 iframe。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T15:56:40.310

```
@Html.Raw(<your source from the database>) 
```

Use the Raw method to render the iframe source code to valid HTML.

# python - 如何从两个文件中获得相似的行？

> ID：13476964
> 
> 赞同：1
> 
> 时间：2012-11-20T15:53:53.217
> 
> 标签：python, scripting, grep

我想比较两个文件。文件 1.txt 文件 2.txt

文件1.txt

```
name1
name2
name3 
```

文件2.txt

```
nameA
nameB
name1
nameC 
```

我想使用 grep 查看这两个文件并说 name1 在两个文件中。我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T15:56:35.397

尝试

```
grep -f file1.txt file2.txt 
```

来自男人：

> -f FILE, --file=FILE 从 FILE 中获取模式，每行一个。空文件包含零个模式，因此不匹配任何内容。（-f 由 POSIX 指定。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T15:57:05.490

使用`comm(1)`：

```
 comm -1 -2 <(sort file1.txt) <(sort file2.txt) 
```

**输出**

```
name1 
```

**解释**

`-1 -2 表示抑制第 1 列和第 2 列，只保留相交。

* * *

> 姓名
> 
> ```
>  comm - compare two sorted files line by line 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T15:57:06.393

您可以使用`-f`in 选项`grep`将第一个文件作为“模式文件”提供，并`grep`在第二个文件上执行作为实际搜索空间：

```
grep -f file1.txt file2.txt 
```

分解：

*   `grep`: 调用 grep 工具
*   `-f file1.txt`：指定`file1.txt`为保存您的搜索模式的文件
*   `file2.txt`: 用于搜索空间的文件名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T15:58:25.733

Set 在 python 中用于比较列表很有用。

```
>>> f1 = set( l.strip() for l in open('file1.txt'))
>>> f2 = set( l.strip() for l in open('file2.txt'))
>>> print "\n".join( f1 & f2)
name1 
```

它也可以生成差异：

```
>>> print "\n".join( f1 - f2)
name2
name3
>>> print "\n".join( f2 - f1)
nameB
nameC
nameA 
```

正如@Jon Clements 所建议的，如果您关心性能，请使用此表格：

```
 f1 = set( l.strip() for l in open('file1.txt'))
 common = f1.intersection(l for l in open('file2.txt'))
 print "\n".join( common ) 
```

由于它不在内存中存储“file2.txt”的内容，因此内存效率更高、速度更快。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T15:59:00.070

您可以使用 diff 来比较文件。

`diff file1.txt file2.txt`

# algorithm - 计算比给定距离更近的点数

> ID：13476965
> 
> 赞同：3
> 
> 时间：2012-11-20T15:53:55.473
> 
> 标签：algorithm, scala, coordinates, distance, points

我正在开发一个项目，给定一组坐标（纬度和经度），需要找到所有比给定距离（公里）更近的点。

我有迭代每个点的工作实现，并且每个点都迭代所有其他点。这是 O(n^2)。我想知道我可以采用什么方法来改进这一点，记住我不想要最近的点，而是那些比 x Km 更近的点（我也希望能够做相反的事情，找到所有比 x Km 更远的点）。

如果您能提供一些想法和算法，那就太好了。代码示例也很好，特别是在 Scala 中（我正在开发这个项目 Scala）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T17:57:40.207

对于这个问题，我会使用一个 java 库（这在 Scala 中是可能的）。计算地球上的距离比你想象的要困难得多。例如，地球不是一个完美的球体。在 java 中进行“地理工作”的主要库是 JTS：[http](http://tsusiatsoftware.net/jts/main.html) ://tsusiatsoftware.net/jts/main.html 您还可以查看 Geotools 或者甚至是像 PostGIS（基于 Postgresql 构建）这样的 GIS 数据库，但这对您的项目来说可能有点过头了

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-01T00:05:53.050

晚了几个月回答自己。好吧，我最终使用 KD-Tree 来实现这一点。我基于这个 Java 实现： http: [//people.cs.vt.edu/~shaffer/Book/JAVA/progs/KDtree/](http://people.cs.vt.edu/~shaffer/Book/JAVA/progs/KDtree/)

但是我对它进行了一些修改（包括将其移植到 Scala）并使其适应我在 Geocaches 周围的具体问题。结果代码如下：

```
/*
 * Based on
 * http://people.cs.vt.edu/~shaffer/Book/JAVA/progs/KDtree/
 * 
 * That code is made available as part of this textbook on Data Structures:
 * http://people.cs.vt.edu/~shaffer/Book/
 */
//A node for a KDTree
class KDNode[E] {
  private var key_value : Array[Double] = null   //key for this node
  def key = key_value                     
  def key_=(k : Array[Double]) { key_value = k } 

  private var element_value: E = _               //Element for this node
  def element = element_value
  def element_=(e : E) {element_value = e}

  private var left_value : KDNode[E] = null      //Pointer to left child
  def left = left_value
  def left_=(l : KDNode[E]) {left_value = l}

  private var right_value : KDNode[E] = null     //Pointer to right child
  def right = right_value
  def right_=(r : KDNode[E]) {right_value = r}
  /** Constructors */
  def this(k : Array[Double], value : E) = 
  {
    this()
    key = k
    element = value
  }
  def this(k : Array[Double], value : E, l : KDNode[E], r : KDNode[E]) = 
  {
    this(k,value)
    left = l
    right = r    
  }
  //Checks if it's a leaf
  def isLeaf : Boolean = 
  {
    return (left == null) && (right == null)
  }
}

//Trait for a basic Dictionary that will be used as basis for our KDTree
trait Dictionary[K,V] {
  def size: Int
  def insert(key: K, value: V)
  def remove(key: K): V
  def find(key: K): V
  def clear
  def isEmpty: Boolean
}

/**
 * A extended trait that defines that the key of the dictionary is an array of
 * doubles and defines the need of a method called regionSearchGeo (very
 * important for All Years 5 & 6 stats)
 */
trait GeoDictionary[E] extends Dictionary[Array[Double], E] {
  def regionSearchGeo(k: Array[Double], radius: Double) : List[E]
}

/**
 * Our implementation of a KDTree. It's based on the code provided in the
 * reference above, but had a few key areas modified for geographic searching.
 * For example, this KDtree is a 3D Tree. The keys are Latitude, Longitude and
 * the Year of the cache (that was also included to speed thins even further)
 */
class K3DGeoTree[E] extends GeoDictionary[E]{

  private var root : KDNode[E] = null
  private val D : Int = 3 // Only supporting 2D points in this implementation
  private var nodecount : Int = 0 // Number of nodes in the KD tree

  /**
   * Implementing everything that is required by the Dictionary trait
   * Some private auxiliary methods are also present
   */
  def clear() = { root = null }
  def isEmpty() : Boolean = { root == null }
  def size() : Int = { return nodecount }

  def insert(pt : Array[Double], value : E) = {
    root = inserthelp(root, pt, value, 0)
    nodecount=nodecount+1
  }
  def inserthelp(rt :  KDNode[E], key : Array[Double], value : E, level : Int)
                                 : KDNode[E] = {
    if (rt == null) return new KDNode[E](key, value)
    val rtkey : Array[Double] = rt.key
    if (rtkey(level) > key(level))
        rt.left = inserthelp(rt.left, key, value, (level+1)%D)
    else
        rt.right = inserthelp(rt.right, key, value, (level+1)%D)
    return rt
  }

  private def findmin(rt : KDNode[E], descrim : Int, level : Int): KDNode[E]= {
  var temp1 : KDNode[E] = null
  var temp2 : KDNode[E] = null
  var key1 : Array[Double] = null
  var key2 : Array[Double] = null
  if (rt == null) return null
  temp1 = findmin(rt.left, descrim, (level+1)%D)
  if (temp1 != null) key1 = temp1.key
  if (descrim != level) {
    temp2 = findmin(rt.right, descrim, (level+1)%D)
    if (temp2 != null) key2 = temp2.key
    if ((temp1 == null) || ((temp2 != null) && (key1(descrim) > key2(descrim))))
    temp1 = temp2
    key1 = key2
  } // Now, temp1 has the smaller value
  var rtkey : Array[Double] = rt.key
  if ((temp1 == null) || (key1(descrim) > rtkey(descrim)))
    return rt
  else
    return temp1
}

  def find(key : Array[Double]) : E = { return findhelp(root, key, 0) }

  private def findhelp(rt : KDNode[E], key : Array[Double], level : Int) : E ={
  if (rt == null) return null.asInstanceOf[E]
  val it : E = rt.element
  val itkey : Array[Double]= rt.key
  if ((itkey(0) == key(0)) && (itkey(1) == key(1)))
    return rt.element
  if (itkey(level) > key(level))
    return findhelp(rt.left, key, (level+1)%D)
  else
    return findhelp(rt.right, key, (level+1)%D)
}

  def remove(key : Array[Double]) : E = {
    val temp : E = findhelp(root, key, 0)   // First find it
    if (temp != null) {
            root = removehelp(root, key, 0) // Now remove it
            nodecount=nodecount-1
    }
    return temp
  }

  private def removehelp(rt : KDNode[E], key : Array[Double], level : Int)
                                             : KDNode[E] = {
      if (rt == null) return null
      val rtkey : Array[Double] = rt.key
      if (key(level) < rtkey(level))
        rt.left = removehelp(rt.left, key, (level+1)%D)
      else if (key(level) > rtkey(level))
        rt.right = removehelp(rt.right, key, (level+1)%D)
      else {  // Found it
      if (rt.right == null)
        if (rt.left == null) // Just drop element
         return null
      else { // Switch subtree to right
            rt.right = rt.left
            rt.left = null
      }
      val temp : KDNode[E] = findmin(rt.right, level, (level+1)%D)
      rt.right = removehelp(rt.right, temp.key, (level+1)%D)
      rt.element = temp.element
    }
    return rt
  }

  /**
   * Implementing the GeoDictionary trait
   */
  def regionSearchGeo(point: Array[Double], radius: Double) : List[E] = 
  {
    val pointGeo : GeoLocation = GeoLocation.fromDegrees(point(0), point(1))
    /**
     * Calculates a bounding rectangle that contains the circle with the given
     * radius. This will be explained later in the corresponding class
     */
    val boundingRect = pointGeo.boundingCoordinates(radius)  
    //Return the caches found
    return rsGeoHelp(root, point, radius, boundingRect, 0)
  }
  /**
   * Auxiliary region search function that does all the heavy work
   */
  private def rsGeoHelp(rt : KDNode[E], point : Array[Double], radius : Double,
                                                boundingRect : Tuple2[GeoLocation,GeoLocation],
                                                lev : Int): List[E] = {
  if (rt == null) return Nil
  val rtkey : Array[Double] = rt.key
  var found : List[E] = Nil
 //Checks if the current node is in the desired radius (and also the year)
  if (InCircleGeo(point, radius, rtkey))
          found = List(rt.element)
 //First Dimension is latitude
  if(lev % D == 0){
        if (rtkey(lev) >= boundingRect._1.degLat)
        found = found:::rsGeoHelp(rt.left, point, radius, boundingRect, (lev+1)%D)
        if (rtkey(lev) <= boundingRect._2.degLat)
        found = found:::rsGeoHelp(rt.right, point, radius, boundingRect, (lev+1)%D)
  }
 //Second Dimension is Longitude
  else if(lev % D == 1){
        if (rtkey(lev) >= boundingRect._1.degLon)
        found = found:::rsGeoHelp(rt.left, point, radius, boundingRect, (lev+1)%D)
        if (rtkey(lev) <= boundingRect._2.degLon)
    found = found:::rsGeoHelp(rt.right, point, radius, boundingRect, (lev+1)%D)
  }
 //Third and last dimension is the year
  else{
    found = found:::rsGeoHelp(rt.left, point, radius, boundingRect, (lev+1)%D)
        if (rtkey(lev) <= point(lev))
        found = found:::rsGeoHelp(rt.right, point, radius, boundingRect, (lev+1)%D)
  }
  //Return the found nodes (in our case it will be caches)
  return found
  }
  private def InCircleGeo(point : Array[Double], radius : Double,
                                                  coord : Array[Double]) : Boolean = {
  //Creates a GeoLocation object for each point
  val pointGeo : GeoLocation = GeoLocation.fromDegrees(point(0), point(1))
  val coordGeo : GeoLocation = GeoLocation.fromDegrees(coord(0), coord(1))
  /**
   * If the year is smaller than the query point and the distance is within
   * radius return true. Else it's false.
   */
  return (coord(0) != point(0) && coord(1) != point(1) && coord(2) <= point(2)
         && pointGeo.distanceTo(coordGeo) < radius)
  }
}

/**
 * This class encapsulates a series of utility methods to deal with geographic
 * coordinates. It was based on the information in the link below that gives
 * a very good insight about how to do math with geographic coordinates and
 * also provides some Java samples that we used as an inspiration for this
 * class.
 * Link: http://janmatuschek.de/LatitudeLongitudeBoundingCoordinates
 */
//Companion object of Class GeoLocation to define static methods and variables
object GeoLocation {
  //Min maxs in terms of Latitude and Longitude accross the globe
  private val MIN_LAT : Double = math.toRadians(-90)  // -PI/2
  private val MAX_LAT : Double = math.toRadians(90)   //  PI/2
  private val MIN_LON : Double = math.toRadians(-180) // -PI
  private val MAX_LON : Double = math.toRadians(180)  //  PI
  /**
   * Earth radius. This value is the most used but there are others that may
   * give slightly different results.
   */
  private val RADIUS : Double = 6372.8

  /**
   * A factory method that creates a GeoLocation object from given latitude and
   * longitude in degrees
   */
  def fromDegrees(latitude : Double, longitude : Double) : GeoLocation = {
    val result : GeoLocation = new GeoLocation()
        result.radLat = math.toRadians(latitude)
        result.radLon = math.toRadians(longitude)
        result.degLat = latitude
        result.degLon = longitude
        result.checkBounds
        return result
  }

  /**
   * A factory method that creates a GeoLocation object from given latitude and
   * longitude in radians
   */
  def fromRadians(latitude : Double, longitude : Double) : GeoLocation = {
        val result : GeoLocation = new GeoLocation()
        result.radLat = latitude
        result.radLon = longitude
        result.degLat = math.toDegrees(latitude)
        result.degLon = math.toDegrees(longitude)
        result.checkBounds
        return result
  }
}
/**
 * The GeoLocation class itself. The constructor is private use the factory
 * methods above.
 */
class GeoLocation private{

  /**
   * Getters and Setters implemented as properties with syntactic sugar
   * This properties  contain the latitude and longitude in degrees and radians
   */
  private var radLat_value : Double = _
  def radLat = radLat_value                    
  private def radLat_=(k : Double) { radLat_value = k } 

  private var radLon_value : Double = _
  def radLon = radLon_value                    
  private def radLon_=(k : Double) { radLon_value = k } 

  private var degLat_value : Double = _
  def degLat = degLat_value                    
  private def degLat_=(k : Double) { degLat_value = k } 

  private var degLon_value : Double = _
  def degLon = degLon_value                    
  private def degLon_=(k : Double) { degLon_value = k } 

  /**
   * Check if the vales are valid considering the MIN and MAX for latitude and
   * longitude.
   */
  private def checkBounds = {
        if (radLat < GeoLocation.MIN_LAT || radLat > GeoLocation.MAX_LAT ||
                radLon < GeoLocation.MIN_LON || radLon > GeoLocation.MAX_LON)
            throw new IllegalArgumentException()
  }

  /**
   * Function to calculate the distance between this GeoLocation and the given
   * GeoLocation.
   * 
   * Check the reference above and
   * http://en.wikipedia.org/wiki/Haversine_formula
   * for more information.
   */
  def distanceTo(location : GeoLocation) : Double = {
        return math.acos(math.sin(radLat) * math.sin(location.radLat) +
                   math.cos(radLat) * math.cos(location.radLat) *
                   math.cos(radLon - location.radLon)) * GeoLocation.RADIUS
  }

  /**
   * This method is very important for the search made in the K3DTree.
   * It allows us to make a bouding rectangle with the given distance/radius
   * that is geometrically correct. Check the reference above to learn more
   * about the math involved.
   */
  def boundingCoordinates(distance : Double)
        : Tuple2[GeoLocation, GeoLocation] = {
    if (distance < 0d) throw new IllegalArgumentException()
        // Angular distance in radians on a great circle
        val radDist : Double = distance / GeoLocation.RADIUS

        //Initialize local variables to check for poles
        var minLat : Double = radLat - radDist
        var maxLat : Double = radLat + radDist

        var minLon : Double = 0
        var maxLon : Double = 0

        //Normal case
        if (minLat > GeoLocation.MIN_LAT && maxLat < GeoLocation.MAX_LAT) {
                val deltaLon : Double = math.asin(math.sin(radDist) / math.cos(radLat))
                        minLon = radLon - deltaLon
                if (minLon < GeoLocation.MIN_LON) minLon += 2d * math.Pi
                        maxLon = radLon + deltaLon
                if (maxLon > GeoLocation.MAX_LON) maxLon -= 2d * math.Pi
        }
    //Special case in which a pole is within the distance
        else{
                        minLat = math.max(minLat, GeoLocation.MIN_LAT)
                        maxLat = math.min(maxLat, GeoLocation.MAX_LAT)
                        minLon = GeoLocation.MIN_LON
                        maxLon = GeoLocation.MAX_LON
                }       
    /**
     * Each of the bounding points (one in the south-west, bottom-left,
     * and other in the north-east, top-right)
     */
    val swPoint : GeoLocation = GeoLocation.fromRadians(minLat, minLon)
    val nePoint : GeoLocation = GeoLocation.fromRadians(maxLat, maxLon) 
    //Return the tuple with the two points
    return (swPoint, nePoint)
  }
} 
```

整个代码都已记录在案，因此我希望这对遇到类似问题的人有所帮助。在这个特定的问题中，除了纬度和经度之外，我还必须处理年份，所以我添加了一个额外的维度。但是对于更一般的地理问题，仅使用两个维度（一个用于纬度，一个用于经度）就更容易了。

# javascript - 将 MS Word 文档在浏览器内转换为 PDF

> ID：13476970
> 
> 赞同：2
> 
> 时间：2012-11-20T15:54:15.930
> 
> 标签：javascript, silverlight, activex, pdf-generation, ms-office

我想实现一个浏览器内的 Microsoft Word 文档合并功能，它将合并的文档转换为 PDF 并将其提供给用户以供下载。我希望 Google Chrome 和 Firefox 支持此过程。这是我希望它的工作方式：

1.  客户端 JavaScript 从服务器获取 docx 格式的 Word 模板文档，或者通过要求用户上传文件（然后可以使用 FileReader API 读取）
2.  JavaScript 使用其本地数据结构（例如，它通过 Ajax 获得的数据列表）将模板扩展为文档。它可以直接执行此操作，通过解压缩 docx 文件并处理其内容，或使用 DOCx.js。模板扩展只是用从本地数据结构中获得的值替换模板变量的问题。
3.  JavaScript 然后将扩展的模板转换为 PDF。
4.  JavaScript 向用户提供 PDF 文件以供下载，例如，使用 Downloadify。

我遇到的困难在于第 3 步。我的理解（基于我到目前为止所做的所有谷歌搜索）是​​我有以下选择：

1.  要求本地机器是Windows机器，并在其上调用Word，转换为PDF。这可以通过使用 WScript.shell 编写一点脚本来完成，而且在 Internet Explorer 上看起来也是可行的。但是根据我所读到的内容，由于安全限制，我似乎无法从 Chrome 或 Firefox 中调用 WScript.shell。
2.  我愿意尝试 Silverlight 进行转换，但我还没有找到足够的文档来说明如何做到这一点。理想情况下，如果我使用 Silverlight，我想用 JavaScript 编写 Silverlight 代码，因为 (a) 我不太了解 CSharp，并且 (b) 我认为用 JavaScript 会容易得多。
3.  创建一个将给定 docx 文件转换为 pdf 文件的 Web 服务，并通过 Ajax 调用该服务。如果可能的话，我宁愿不这样做，原因如下： (a) 我尝试使用[docx4java](http://www.docx4java.org/trac/docx4j)（我是一个相当熟练的 Java 程序员），但是转换过程太慢了，而且它不能很好地保留文档内容；(b) 我想避免呼叫网络，以避免安全问题。似乎可以在 Windows 服务器上编写一个小服务来进行转换，如果没有其他好的选择，我可能会走那条路。

如果我有什么不清楚的地方，请告诉我。我会很感激你的想法和反馈。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T16:05:31.290

我喜欢命令行工具。

将文档加载到您的服务器并使用 LibreOffice 通过命令行将其转换为 PDF

```
soffice.exe --headless --convert-to pdf --outdir E:\Docs\Out E:\Docs\In\a.doc 
```

您可以向用户显示进度条，并在完成后为他们提供下载文档的选项。

有关 LibreOffice 命令行参数的更多信息，请访问[此处](http://help.libreoffice.org/Common/Starting_the_Software_With_Parameters)

完毕。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-22T22:22:13.940

现在是老问题了，但是对于任何偶然发现这个问题的人来说，网络组装（wasm）现在使这种方法成为可能。

我们刚刚发布了[https://www.npmjs.com/package/@nativedocuments/docx-wasm](https://www.npmjs.com/package/@nativedocuments/docx-wasm)可以在本地执行转换。

# objective-c - Objective-C typedef enum - two enums maps to same values

> ID：13476972
> 
> 赞同：0
> 
> 时间：2012-11-20T15:54:21.353
> 
> 标签：objective-c, enums

I've taken over a project and it uses an enum to flag API calls.

It can filter them by OR'ing the enum values so a previous developer did some bitshifting.

```
typedef enum {
APICallTimeSeriesSearchTimeSeries   = (1LL << 1),
APICallTimeSeriesGetTimeSeriesInfo  = (1LL << 2),
APICallTimeSeriesGetSeriesInfo      = (1LL << 3),
....
APICallFavouritesAddNewsFavourite               = (1LL << 79),
APICallFavouritesRemoveNewsFavourite            = (1LL << 80),
APICallFavouritesGetAllFavourites               = (1LL << 81)
} APICallType; 
```

Then we can do things like

```
filter(APICallTimeSeriesGetTimeSeriesInfo | APICallTimeSeriesGetSeriesInfo | APICallTimeSeriesGetSeriesData); 
```

But recently I notice similar enums mapped to the same value. I dumped the whole enum list like so

```
NSLog(@"%d",APICallTimeSeriesSearchTimeSeries);
NSLog(@"%d",APICallTimeSeriesGetTimeSeriesInfo);
NSLog(@"%d",APICallTimeSeriesGetSeriesInfo);
NSLog(@"%d",APICallTimeSeriesGetSeriesData);
NSLog(@"%d",APICallFleetSearchVessels);
NSLog(@"%d",APICallFleetGetVesselInfo);
etc. 
```

And we can see the bitshifting in action

```
2
4
8
16
32
64
128
256
512
1024
2048
4096
8192
16384
32768
65536
131072
262144
524288
1048576
2097152
4194304
8388608
16777216
33554432
67108864
134217728
268435456
536870912
1073741824
2147483648
4294967296
8589934592
17179869184
34359738368
68719476736 
```

The problem is after (1LL << 63) the same values are generated

```
1152921504606846976 APICallFavouritesAddMarketFavourite = (1LL << 60)
2305843009213693952 APICallFavouritesRemoveMarketFavourite  = (1LL << 61)
4611686018427387904 APICallFavouritesGetFutureFavourites    = (1LL << 62)
-9223372036854775808    APICallFavouritesAddFutureFavourite = (1LL << 63)
-9223372036854775808    APICallFavouritesRemoveFutureFavourite  = (1LL << 64)
-9223372036854775808    APICallFavouritesRemoveVesselFavourite  = (1LL << 65) 
```

etc same value(-9223372036854775808) repeats for all new enums

From this thread [Types in objective-c on iPhone](https://stackoverflow.com/questions/2107544/types-in-objective-c-on-iphone)

its because -9223372036854775808 is LLONG_MIN

```
NSLog(@"LLONG_MIN:  %lli", LLONG_MIN);   // signed long long int 
```

I noticed theres a higher value

```
NSLog(@"LLONG_MAX:  %lli", LLONG_MAX);
NSLog(@"ULLONG_MAX: %llu", ULLONG_MAX);  // unsigned long long int

LLONG_MIN:  -9223372036854775808         
LLONG_MAX:  9223372036854775807          
ULLONG_MAX: 18446744073709551615 
```

but cant find ULLONG_MIN

How do we fix this?

I tried changing the primitive storage from 1LL to 1ULL but no effect.

FROM:

```
typedef enum {
APICallTimeSeriesSearchTimeSeries   = (1LL << 1),
APICallTimeSeriesGetTimeSeriesInfo  = (1LL << 2),
APICallTimeSeriesGetSeriesInfo      = (1LL << 3),
... 
```

TO:

```
typedef enum {
APICallTimeSeriesSearchTimeSeries               = (1ULL << 1),
APICallTimeSeriesGetTimeSeriesInfo              = (1ULL << 2),
APICallTimeSeriesGetSeriesInfo                  = (1ULL << 3),
... 
```

cheers

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T22:31:42.493

ULLONG_MIN 为0。ULLONG 表示*unsigned* long long，即64 位表示的正值。

如果您想要正数和负数，则只能表示可以用相同位宽的无符号类型表示的该组值的一半。这就是 ULLONG_MAX 更大的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T09:52:06.303

我选择将 APICallType 拆分为另一个枚举。就是这样，或者重新连接一个 3 年的项目，并且必须测试每个 API 调用。

```
APICallTimeSeriesSearchTimeSeries   = (1LL << 1),
APICallTimeSeriesGetTimeSeriesInfo  = (1LL << 2),
APICallTimeSeriesGetSeriesInfo      = (1LL << 3),
....
APICallFavouritesAddNewsFavourite               = (1LL << 79),
APICallFavouritesRemoveNewsFavourite            = (1LL << 80),
APICallFavouritesGetAllFavourites               = (1LL << 81)
} APICallType; 
```

变成

```
typedef enum {
APICallTimeSeriesSearchTimeSeries   = (1LL << 1),
APICallTimeSeriesGetTimeSeriesInfo  = (1LL << 2),
APICallTimeSeriesGetSeriesInfo      = (1LL << 3),
APICallTimeSeriesGetSeriesData      = (1LL << 4),
APICallFleetSearchVessels           = (1LL << 5),
APICallFleetGetVesselInfo           = (1LL << 6),
APICallNewsGetNewsItems             = (1LL << 7),
APICallNewsGetPublicationItems      = (1LL << 8),
APICallPodcastGetPodcastItems       = (1LL << 9),
APICallUserLoginAuthenticateUser    = (1LL << 10),
APICallFFASearchFFARoutes           = (1LL << 11),
APICallFFAGetRouteData              = (1LL << 12),
APICallOwnerSearchOwners            = (1LL << 13),
APICallOwnerGetOwnerFleet           = (1LL << 14),
APICallIndicesSearchIndices         = (1LL << 15),
APICallIndicesGetIndicesData        = (1LL << 16),
APICallEquitiesGetEquitiesData      = (1LL << 17),
APICallEquitiesGetEquityPreviews    = (1LL << 18),
APICallEquitiesSearchBrokingStocks  = (1LL << 19),
APICallEquitiesSearchIndices        = (1LL << 20),
APICallEquitiesSearchCurrencies     = (1LL << 21),
APICallEquitiesGetRelatedNewsItems  = (1LL << 22),
APICallEquitiesGetCurrencyList      = (1LL << 23),
APICallSandPVesselsSearch           = (1LL << 24),
APICallSandPVesselSalesSearch       = (1LL << 25),
APICallSandPGetCommercialData       = (1LL << 26),
APICallSandPGetSimilarSales         = (1LL << 27),
APICallSandPGetFullVesselDetails    = (1LL << 28),
APICallSandPEnquiriesSearch         = (1LL << 29),
APICallTimeSeriesGetCategories                  = (1LL << 30),
APICallTimeSeriesGetShipTypes                   = (1LL << 31),
APICallTimeSeriesGetDataTypes                   = (1LL << 32),
APICallTimeSeriesSearchTimeSeriesWithCategories = (1LL << 33),
APICallHomeGetComments                          = (1LL << 34),
APICallEquitiesGetRelatedNewsItemsWithIds       = (1LL << 35),
APICallEquitiesSearchEquitiesBrokingStocks      = (1LL << 36),
APICallTimeSeriesGetFutureShipTypes             = (1LL << 37),
APICallTimeSeriesGetFutureDataTypes             = (1LL << 38),
APICallTimeSeriesGetOHLCData                    = (1LL << 39),
APICallTimeSeriesGetSeriesDataMaxPoints         = (1LL << 40),
APICallTimeSeriesGetSeriesOHLCDataMaxPoints     = (1LL << 41),
APICallClientSearchClients                      = (1LL << 42),
APICallClientGetClientListForBroker             = (1LL << 43),
APICallClientSearchDivisionsAndDesks            = (1LL << 44),
APICallClientGetDivisionsAndDesks               = (1LL << 45),
APICallClientSaveEmployeeDetails                = (1LL << 46),
APICallTimeSeriesSearchWithSeriesId             = (1LL << 47),
APICallHomeGetCommentsCargo                     = (1LL << 48),
APICallHomeGetCommentsSandP                     = (1LL << 49),
APICallHomeGetCommentsTanker                    = (1LL << 50),
APICallClientGetSandPRoutes                     = (1LL << 51),
APICallClientGetSandP2ndHandValues              = (1LL << 52),
APICallHomeGetCommentsSpecialised               = (1LL << 53),
APICallClientGetSpecialised                     = (1LL << 54),
APICallClientGetGas                             = (1LL << 55),
APICallClientGetGasBunkerPrices                 = (1LL << 56),
APICallFFAGetAllWhiteboardSpreadTypes           = (1LL << 57),
APICallFFAGetWhiteboardSpreadPricesForType      = (1LL << 58),
APICallFavourites                               = (1LL << 59)
/*
APICallFavouritesGetMarketFavourites            = (1LL << 59),
APICallFavouritesAddMarketFavourite             = (1LL << 60),
APICallFavouritesRemoveMarketFavourite          = (1LL << 61),
APICallFavouritesGetFutureFavourites            = (1LL << 62),

//Enum bit shifted greater than 63 will have same value as MAX INT reached
//moved these to 
APICallFavouritesAddFutureFavourite             = (1LL << 63),
APICallFavouritesRemoveFutureFavourite          = (1LL << 64),
APICallFavouritesGetVesselOwnerFavourites       = (1LL << 65),
APICallFavouritesGetVesselFavourites            = (1LL << 66),
APICallFavouritesAddVesselFavourite             = (1LL << 67),
APICallFavouritesRemoveVesselFavourite          = (1LL << 68),
APICallFavouritesGetOwnerFavourites             = (1LL << 69),
APICallFavouritesAddOwnerFavourite              = (1LL << 70),
APICallFavouritesRemoveOwnerFavourite           = (1LL << 71),
APICallFavouritesGetShippingStockFavourites     = (1LL << 72),
APICallFavouritesAddShippingStockFavourite      = (1LL << 73),
APICallFavouritesRemoveShippingStockFavourite   = (1LL << 74),
APICallFavouritesGetIndicieFavourites           = (1LL << 75),
APICallFavouritesAddIndicieFavourite            = (1LL << 76),
APICallFavouritesRemoveIndicieFavourite         = (1LL << 77),
APICallFavouritesGetNewsFavourites              = (1LL << 78),
APICallFavouritesAddNewsFavourite               = (1LL << 79),
APICallFavouritesRemoveNewsFavourite            = (1LL << 80),
APICallFavouritesGetAllFavourites               = (1LL << 81)
*/

} APICallType; 
```

并添加 APICallSubType

```
typedef enum {

/* for use with APICallType:APICallFavourites */
APICallFavouritesGetMarketFavourites            = (1LL << 1),
APICallFavouritesAddMarketFavourite             = (1LL << 2),
APICallFavouritesRemoveMarketFavourite          = (1LL << 3),

APICallFavouritesGetFutureFavourites            = (1LL << 4),
APICallFavouritesAddFutureFavourite             = (1LL << 5),
APICallFavouritesRemoveFutureFavourite          = (1LL << 6),

APICallFavouritesGetVesselOwnerFavourites       = (1LL << 7),
APICallFavouritesGetVesselFavourites            = (1LL << 8),
APICallFavouritesAddVesselFavourite             = (1LL << 9),
APICallFavouritesRemoveVesselFavourite          = (1LL << 10),

APICallFavouritesGetOwnerFavourites             = (1LL << 11),
APICallFavouritesAddOwnerFavourite              = (1LL << 12),
APICallFavouritesRemoveOwnerFavourite           = (1LL << 13),

APICallFavouritesGetShippingStockFavourites     = (1LL << 14),
APICallFavouritesAddShippingStockFavourite      = (1LL << 15),
APICallFavouritesRemoveShippingStockFavourite   = (1LL << 16),

APICallFavouritesGetIndicieFavourites           = (1LL << 17),
APICallFavouritesAddIndicieFavourite            = (1LL << 18),
APICallFavouritesRemoveIndicieFavourite         = (1LL << 19),

APICallFavouritesGetNewsFavourites              = (1LL << 20),
APICallFavouritesAddNewsFavourite               = (1LL << 21),
APICallFavouritesRemoveNewsFavourite            = (1LL << 22),
APICallFavouritesGetAllFavourites               = (1LL << 23)
//do not go over (1LL << 63) - enum values start at MAX INT after that

} APICallSubType; 
```

并且我在任何地方检查了我必须在之后检查子类型的类型

```
filter(APICallFavourites);
filterSubType(APICallFavouritesAddVesselFavourite |
              APICallFavouritesRemoveVesselFavourite);

if (responseOfSubType(APICallFavouritesAddVesselFavourite))
{
    NSLog(@"%s APICallFavouritesAddVesselFavourite response not handled", __PRETTY_FUNCTION__);
}

if (responseOfSubType(APICallFavouritesRemoveVesselFavourite))
{
    NSLog(@"%s APICallFavouritesRemoveVesselFavourite response not handled", __PRETTY_FUNCTION__);
} 
```

# iphone - New modern Objective-C enum type check

> ID：13476977
> 
> 赞同：5
> 
> 时间：2012-11-20T15:54:32.360
> 
> 标签：iphone, objective-c, ios, macos

If I declare enum type with new NS_ENUM macro which was introduced because of stronger type check, am I able to check for this type also in runtime?

I mean, I have

```
typedef NS_ENUM(NSUInteger, MyNewType) {

    MyNewTypeInstance1,
    MyNewTypeInstance2,
    MyNewTypeInstance3

}; 
```

. And I want to know that for example `(NSUInteger)i = 2` is kind of `MyNewType`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T16:02:02.823

不`NS_ENUM`，这只是一种使用通过 C++11 引入到 Objective-C 的功能的一种方式，称为“固定基础类型”用于枚举。这确保了用于存储枚举值的类型具有固定的大小和符号，但它不允许您在运行时查询枚举类型。

如果您有兴趣验证值是否实际上是枚举的成员，则有两种相关的方法。如果这些值是连续的，您可以编写一个宏来检查所讨论的值是否在有效的连续范围内。否则，您可以采用 Apple 采用的更通用（和详细）的方法，例如[UIDeviceOrientationIsValidInterfaceOrientation](https://developer.apple.com/documentation/uikit/1625051-uideviceorientationisvalidinterf)，并明确检查所有有效的枚举值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T16:34:09.460

@warrenm：很好的答案

我在想这个：

添加一种“myLastValueJustToCheck”并检查您的int是否<该值怎么样？

```
typedef NS_ENUM(NSUInteger, MyNewType) {
    MyNewTypeInstance1,
    MyNewTypeInstance2,
    MyNewTypeInstance3,
    myLastValueJustToCheck
}; 
```

然后检查：

```
NSUInteger i = 2;
NSLog(@"is %i i in my range? %i", i, (i<myLastValueJustToCheck));

i = 3;
NSLog(@"is %i i in my range? %i", i, (i<myLastValueJustToCheck));

i = 4;
NSLog(@"is %i i in my range? %i", i, (i<myLastValueJustToCheck)); 
```

# debugging - 为 Spring Roo shell 打开调试

> ID：13476980
> 
> 赞同：1
> 
> 时间：2012-11-20T15:54:37.130
> 
> 标签：debugging, logging, spring-roo

我希望能够**打开 Spring Roo Shell 的调试日志记录级别，**以便在发生错误时获得完整的堆栈跟踪。

谁能建议如何实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T23:34:06.063

好吧，命令如下：

```
roo> development mode --enabled true 
```

[http://static.springsource.org/spring-roo/reference/html/command-index.html#command-index-development-mode](http://static.springsource.org/spring-roo/reference/html/command-index.html#command-index-development-mode)

我不知道发生错误时它是否显示完整的堆栈跟踪。

# objective-c - AutoCompleteTableView 响应很慢

> ID：13476981
> 
> 赞同：0
> 
> 时间：2012-11-20T15:54:38.190
> 
> 标签：objective-c, json, uitableview, ios5

我正在尝试访问我的网络服务以从那里获取字符串并`AutoCompleteTableView`使用以下方法将其放入我的 -

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

NSString *substring = [NSString stringWithString:txtSearching.text];
substring = [substring stringByReplacingCharactersInRange:range withString:string];

if (([substring isEqualToString:@""]) || (substring == nil) || ([substring length] == 0)){

    autoCompleteTableView.hidden=YES;
}

NSString *jsonUrl = [NSString stringWithFormat:MYAPI,substring];
NSURL *url = [NSURL URLWithString:[jsonUrl stringByReplacingOccurrencesOfString:@" " withString:@"%20"]];
NSData *jsonData = [NSData dataWithContentsOfURL:url];
NSArray *data = [jsonData objectFromJSONData];

for (int i = 0; i< [data count]; i++) {

    NSDictionary * dic = [data objectAtIndex:i];
    [elementArray addObject:[dic objectForKey:@"keyword"]];
}  
[self searchAutocompleteEntriesWithSubstring:substring];
[elementArray removeAllObjects];

return YES;
} 
```

和我的`searchAutocompleteEntriesWithSubstring`

```
- (void)searchAutocompleteEntriesWithSubstring:(NSString *)substring {

// Put anything that starts with this substring into the autoCompleteArray
// The items in this array is what will show up in the table view
//[elementArray removeAllObjects];
[autoCompleteArray removeAllObjects];

 int lengthOfSubstring = [substring length];
for(NSString *curString in elementArray) {
    int lengthOfCurentString = [curString length];
    if (lengthOfCurentString >=lengthOfSubstring) {
        NSString *substringRangeLowerCase = [[curString substringWithRange:NSMakeRange(0,[substring length])] lowercaseString];
        NSString *substringRangeUpperCase = [[curString substringWithRange:NSMakeRange(0,[substring length])] uppercaseString];
        NSString *substringRangeCase = [[curString substringWithRange:NSMakeRange(0,[substring length])] capitalizedString];
        if (([substring isEqualToString:@""]) || (substring == nil) || ([substring length] == 0)) {
      //      NSLog(@"current string = [%@]",curString);
        }else{
            if (([substring isEqualToString:substringRangeLowerCase]) || ([substring isEqualToString:substringRangeUpperCase]) || ([substring isEqualToString:substringRangeCase])) {

                [autoCompleteArray addObject:curString];                 

            }
        }
    }

}

autoCompleteTableView.hidden = NO;
[autoCompleteTableView reloadData];
} 
```

我的资料——

> [{"keyword":"qwerty"},{"keyword":"司法试卷"},{"keyword":"qwe"},{"keyword":"quilts"},{"keyword":"藜麦"},{"keyword":"qwerty0disk"},{"keyword":"q"}]

我不知道为什么我`UI`变得很慢..我`JSONKit`也在使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T17:44:30.860

`NSData *jsonData = [NSData dataWithContentsOfURL:url];`是同步调用。这意味着调用是在主线程中完成的，它将在其进程中阻塞执行。如果连接很慢，它将阻塞接口（也运行在主线程中），直到它接收到数据。

为了避免在 dataWithContentOfURL 完成时阻塞您的界面，您应该使用 gcd 或实现一个异步类来获取数据。

[这](https://stackoverflow.com/questions/8918501/gcd-and-async-nsurlconnection)是关于 gcd 和异步连接的讨论

我希望这将有所帮助。

# python - Django，找到2个字段总和的最大值

> ID：13476982
> 
> 赞同：4
> 
> 时间：2012-11-20T15:54:56.617
> 
> 标签：python, django

我有一个这样的模型 Django 模型：

```
class MyModel(models.Model):
  fieldA = models.CharField(max_length=100)
  fieldB = models.IntegerField()
  fieldC = models.IntegerField() 
```

我想找到 Max(fieldB + fieldC)。有没有 Django 方法可以做到这一点？还是我必须使用原始 sql（以防它类似于“从 mymodel_table 中选择 Max（fieldA + fieldB）”）？

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-20T16:05:19.153

这是一个应该工作的相当迂回的解决方案，改编[自带有表达式的 Django 聚合查询](https://stackoverflow.com/questions/10221422/django-aggregate-queries-with-expressions)：

```
MyModel.objects.extra(select={'sum':'fieldB + fieldC'}).order_by('-sum')[0] 
```

* * *

原始无效答案（从 Django 1.4 开始，F() 表达式在注释中不起作用）

您可以使用[F() 表达式](https://docs.djangoproject.com/en/dev/topics/db/queries/#query-expressions)和[注释/聚合](https://docs.djangoproject.com/en/dev/topics/db/aggregation/#aggregating-annotations)来为您执行此操作。我想你想要的是。

```
from django.db.models import F, Max
MyModel.objects.annotate(sum=F('fieldB') + F('fieldC')).aggregate(Max('sum')) 
```

# c - 在二进制数中找到第一个“1”

> ID：13476983
> 
> 赞同：5
> 
> 时间：2012-11-20T15:54:57.190
> 
> 标签：c, algorithm, assembly, x86

> **可能重复：**
> [用于计数位或找到最右边|最左边的有效位运算](https://stackoverflow.com/questions/9093323/efficient-bitwise-operations-for-counting-bits-or-find-the-rightleft-most-ones)

有没有一种快速的方法可以找到（32 位）二进制数中的第一个 1？

例如，如果我有数字 00000000 00000000 00000000 10000000

我想计算值“7”（或“24”，如果从另一侧读取），因为数字中的第一个零存储在右侧的第 7 位中。

有没有比这更快的方法

```
int pos=0;
int number = 127; //binary from above
while ((number>>pos) > 0) { pos++; } 
```

?

也许是特定的 x86 汇编指令？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-20T15:59:32.023

使用 gcc，您可以使用`__builtin_ctz`和`__builtin_clz`。 `ctz`给出尾随 0 位`clz`的数量，并给出前导 0 位的数量.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-20T16:17:46.810

您正在寻找 x86 的位扫描指令

```
__inline__ size_t bsf(size_t input) {
    size_t pos;
    __asm__ ("bsf %1, %0" : "=r" (pos) : "rm" (input));
    return pos;
} 
```

如果使用内联 asm，请确保两者`pos`和`input`是相同的存储类（2、4 或 8 字节整数类型）。这个内联函数应该没问题。

大多数编译器都有使用这条指令的内在函数，但我知道 MSVC 是唯一一个有直接指令的编译器。

对于最高位设置，请改用`bsr`指令，语法相同。

**注意**：如果输入为 0（未设置位），则结果未定义！

`pos`如果输入为 0 ，下面是一个将预定义常量放入的版本：

```
#define BIT_SCAN_IFZERO 0

__inline__ size_t bsf(size_t input) {
    size_t pos, ifzero = BIT_SCAN_IFZERO;
    __asm__ ( "bsf %1, %0\n\t"
              "cmovz %2, %0"
            : "=r" (pos)
            : "rm" (input)
            , "rm" (ifzero));
    return pos;
} 
```

定义`BIT_SCAN_IFZERO`为你喜欢的任何东西。如果您想要一个负数，请更改`size_t`为`ssize_t`（有符号大小类型）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T16:09:51.197

是的，有一种更快的方法——不使用宏。

使用您的方法，您最多可以拥有 32*2 个操作。

这是一个对数算法。

首先，您将数字分成 2 个短裤，并检查较低的短裤是否为 0。如果为 0，则检查高位部分，保持 offset=16。如果不是 0，请检查低位部分，偏移量 = 0。您将保持短路和偏移量

接下来，将剩余部分分成 2 个字符，并继续进行相同的操作。您将保留一个字符和一个偏移量。

接下来，将 char 分成 4 位的 2 部分，并检查是否相同。

您将进行最大日志 32 * 2 操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T16:06:14.073

MSVC 内在函数是`_BitScanForward`和`_BitScanReverse`。

[你可以在这里](http://msdn.microsoft.com/en-us/library/wfd9z0bb%28v=vs.80%29.aspx)查看它们的参数，它们并不太直观（你想要的值不是返回值）。

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-11-20T15:59:30.363

这几乎是最快的方法。如果您我们正在处理多个单词的可能性，您可以测试第一个单词然后是第二个单词，依此类推并找到最低的非 0 单词。不过，您仍然需要对其进行转换。

# events - 当您切换浏览器选项卡时，以编程方式会发生什么？

> ID：13476987
> 
> 赞同：1
> 
> 时间：2012-11-20T15:55:07.030
> 
> 标签：events, google-chrome, browser, fancybox

我在 chrome 中遇到了一个奇怪的问题，在我切换到另一个 chrome 选项卡并切换回来之前，我的滚动条不会出现。我自己会弄清楚——我只是想通过尽可能具体地了解浏览器切换选项卡时究竟会发生什么来达到一个起点？

* * *

像：

1.  什么失去/获得焦点？
2.  还有其他事件触发了吗？
3.  从这个意义上说，chrome 与其他浏览器有何不同？

* * *

**抱歉，如果这个问题有点开放式 - 我已尽力以一种可以具体回答的方式对其进行限定。**

# c++ - C++ 运算符重载类和结构

> ID：13476994
> 
> 赞同：0
> 
> 时间：2012-11-20T15:55:35.270
> 
> 标签：c++, operator-overloading

我正在尝试做一些我不完全确定甚至可能的事情。我正在尝试重载一个等于运算符，如下所示：

```
Class A //Defined somewhere
Struct B{
   float bobsAge; 
};
B& operator=(A,B){
    A.GetAge("bob",B.bobsAge);

    return B; 
}

Function(getAge){
    A Names;
    B structNames; 

    structNames = Names; 
} 
```

我知道这可能是不可能的，因为我知道 operator= 用于做一些事情，例如将一个相同类型的对象设置为等于另一个对象。或者这是可能的，但我做错了什么。

提前谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T16:01:10.997

`operator=`是一个赋值运算符，只能在*被*赋值的类中被覆盖。所以在你的情况下，它必须在里面声明`A`。

“等于运算符”，即 ，`operator==`用于比较两个对象是否相等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T15:59:32.513

你可以超载`operator=`，但它必须在课堂上。有关类定义之外的内容，请参见[http://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B 。](http://en.wikipedia.org/wiki/Operators_in_C_and_C%2B%2B)

例如

```
class foo {
  foo& operator=(B b) {
    //...
    return *this;
  };
}; 
```

我不完全确定你想用它做什么。

此外，它是赋值运算符 - 不要将其称为等于运算符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T16:01:25.317

您要做的是重载*赋值运算符*但是，标准方法是提供一个转换构造函数：

```
class A
{
 public:
  A(const B& b) { GetAge("bob", b.bobsAge; }
}; 
```

然后让隐式转换开始用于表达式，例如

```
A a;
B b;
a = b; // Assignment: calls A(const B&), and uses A's default assignment operator 
A a2 = b;  // Construction: calls A(const B&) and A(const A&) 
```

你可以提供一个赋值运算符

```
A& operator=(const B&); 
```

`B`但是只允许从to分配`A`而不是构造似乎不直观。

# css - 如何调整 div 容器的大小以适应子 div 的溢出

> ID：13476997
> 
> 赞同：4
> 
> 时间：2012-11-20T15:55:38.157
> 
> 标签：css, html, height, overflow

我有一个 div 容器，里面有一个子 div：

```
<div id=mainWrapper>
    <div id=child>
    </div>
<div>

 #mainwrapper height:100%, width:900px
 #child height:100%, width:50% overflow:visible float:right 
```

子 div 包含元素列表。

当子级溢出大于 mainWrapper 的高度时，如何调整 mainWrapper 的大小？

我尝试了一堆 CSS 和一些脚本： $('#mainWrapper').css('height',$('#child').height());

没有任何工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-20T15:58:56.543

在`#child`. 浮动 div 需要清除才能将其父 div 拉到相同的高度。

```
 <div id=mainWrapper>
     <div id=child>
     </div>
     <div style='clear:both;'><!--clear--></div> 
  <div>

  #mainwrapper height:100%, width:900px  
  #child height:100%, width:50% overflow:visible float:right 
```

参考： [http ://www.webtoolkit.info/css-clearfix.html](http://www.webtoolkit.info/css-clearfix.html)

[我可以使用哪些“clearfix”方法？](https://stackoverflow.com/questions/211383/which-method-of-clearfix-is-best)

[http://css-tricks.com/snippets/css/clear-fix/](http://css-tricks.com/snippets/css/clear-fix/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-20T16:01:36.817

在 mainwrapper 上设置溢出：自动：

```
#mainwrapper {
    width:900px
    overflow: auto;  
} 
```

使用浮动时，它是 hasLayout 的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-31T07:26:20.227

[写为新答案，因为评论很容易被忽略。[Damien Overeem](https://stackoverflow.com/users/1472389/damien-overeem)的学分]

为了实现`overflow:visible`为孩子和`mainwrapper`调整溢出的高度，`height`从孩子和`mainwrapper`.
在`mainwrapper`，设置`overflow: auto`。

# c# - 如何从 Brush 继承，以便添加 Name 属性？

> ID：13476999
> 
> 赞同：7
> 
> 时间：2012-11-20T15:55:41.857
> 
> 标签：c#, wpf

例如：

```
public class DesignerPatternBrush : Brush
{
    public string Name { get; set; }
} 
```

我想`Brush`通过添加一个名为 的新属性来定义我自己的类`Name`，但是有一个编译器错误：

> 错误 CS0534：“Brushes.DesignerPatternBrush”未实现继承的抽象成员“System.Windows.Freezable.CreateInstanceCore()”

如何将`Name`属性添加到`Brush`类型？

请注意这个相关问题：[如何在 WPF 中实现自定义画笔？](https://stackoverflow.com/q/794512/)它回答了为什么不能从字面上继承的问题`Brush`。但是还有其他方法（例如使用附加属性）来达到我想要的相同效果吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T16:05:10.070

这意味着您需要实现从 Brush 及其祖先继承的所有抽象方法。在这种情况下，它是类的`CreateInstanceCore()`方法`Freezable`。

为什么需要命名画笔？您可以为您的视图/窗口/应用程序创建一个画笔并将其存储到 ResourceDictionary（在给定的键下，这基本上是一个名称）中 - 也许您正在寻找这个解决方案。

更多信息在这里：http: [//blogs.msdn.com/b/wpfsldesigner/archive/2010/06/03/creating-and-sumption-resource-dictionaries-in-wpf-and-silverlight.aspx](http://blogs.msdn.com/b/wpfsldesigner/archive/2010/06/03/creating-and-consuming-resource-dictionaries-in-wpf-and-silverlight.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T16:03:44.550

正如编译错误消息所说，Brush an abstract class --> 你必须实现它的抽象成员

为了让 Visual Studio 为您完成所有工作，存在一个快捷方式。

选择 Brush 类并按 Alt + Shift + F10 --> 输入自动实现的抽象类：

```
public class T : Brush
{

    protected override Freezable CreateInstanceCore()
    {
        throw new NotImplementedException();
    }
} 
```

**编辑：**

但这不适用于 Brush 类。Visual Studio 自动实现所有可见的方法，但 Brush 类将一些方法定义为内部抽象

IE：

```
internal abstract int GetChannelCountCore(); 
```

由于 Brush 是在 PresentationCore 中定义的，我们将永远无法覆盖程序集之外的抽象方法... --> 无法从类继承

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-20T16:04:45.563

当你继承一个抽象类时，你有一些你需要的成员`Override`。您会注意到`Brush`. 如果您在光标位于时按`CTRL`+ ，它将要求您执行它，我在+之后按。当你实现它时，你会看到：`.``Brush``Enter``CTRL``Space`

```
 protected override Freezable CreateInstanceCore()
  {
    throw new NotImplementedException();
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-29T00:12:28.617

我有一个简单的解决方案：您可以创建一个更改 Brush 属性并抛出附加属性的类，而不是继承。例如：我创建了一个名为“HatchBrushes”的类，它可以创建 55 个具有不同阴影样式的 DrawingBrushes（类似于 WinForms HatchBrush..实际上这部分代码属于另一个程序员） HatchBrushes 类定义了 4 个附加属性，用于控制阴影画笔外观：HatchStyle、Background、Foreground 和 PenThickness。所有这些属性都注册了一个名为“OnHatchChanged”的 PropertyChangedCallBck 子，我可以在其中更改 DrawingBrush 的属性：

```
Shared Sub OnHatchChanged(d As DependencyObject, e As DependencyPropertyChangedEventArgs)
        Dim DBrush = TryCast(d, DrawingBrush)
        If DBrush Is Nothing Then Return
        Dim B = GetHatchBrush(GetHatchStyle(DBrush), GetBackground(DBrush), GetForeground(DBrush), GetPenThickness(DBrush))
        DBrush.Drawing = B.Drawing.CloneCurrentValue
        DBrush.Stretch = B.Stretch
        DBrush.ViewportUnits = B.ViewportUnits
        DBrush.Viewport = B.Viewport
        DBrush.TileMode = B.TileMode
    End Sub 
```

请注意，“GetHatchBrush”是一个创建具有所需 HatchStyle 的 DrawingBrush 的函数。我不会在这里写它，因为它太长了。

现在，我可以使用带有 simole xaml 代码的 Horizo​​ntal-lines Hatch 为窗口的背景着色，如下所示：

```
<DrawingBrush c:HatchBrushes.HatchStyle="Horizontal"
   c:HatchBrushes.Background="Red" 
   c:HatchBrushes.Foreground="Yellow" 
   c:HatchBrushes.PenThickness="2"/> 
```