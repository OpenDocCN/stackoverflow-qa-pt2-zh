# StackOverflow 问答 13956000-13956999

# javascript - 删除输入后，从零开始排列输入名称元素数组中的数字

> ID：13956001
> 
> 赞同：1
> 
> 时间：2012-12-19T15:46:21.747
> 
> 标签：javascript, jquery

我想在 html 代码中删除其中一行（例如：**Row 2**）后，通过 jQuery 更改为 in name 元素。

例如，我们首先在 html 中有：

> **第 1 行：** name="check[ **0** ][]"
> **第 2 行（已删除）：** name="check[ **1** ][]"
> **第 3 行：** name="check[ **2** ][]"
> **第 4 行：** name="check[ **3** ][]"

现在如果我们删除第二行，事实上，在删除第 2 行之后，我们有这样的行：

> **第 1 行：** name="check[ **0** ][]"
> **第 3 行：** name="check[ **2** ][]"
> **第 4 行：** name="check[ **3** ][]"

但是我希望它在结果中（在删除其中一行例如：第 2 行之后）为：

> **第 1 行：** name="check[ **0** ][]"
> **第 3 行：** name="check[ **1** ][]"
> **第 4 行：** name="check[ **2** ][]"

我试过了（见我的完整代码）但不工作：http: [//jsfiddle.net/k3wne/](http://jsfiddle.net/k3wne/)

JS：

```
$('.remove_input').live('click', function (e) {
    e.preventDefault();
    var remove = $(this).closest($class);
    remove.fadeOut('slow', function () {
        $('.add_units').each(function (idx, val) {
            var num = $('.add_units').length;
            NumIdx = (num - (num - idx));
            //for(var i = 0; i < num-1; i++){
            $(this).closest($class_guide).next($class_guide).each(function (idx, val) {
                $('.add_units input[type="checkbox"]').attr('name', function (idx, str) {
                    var int = parseInt(str.match(/\d+/)[0], 10);
                    return str.replace(int, NumIdx);
                })
            });
            //}
        })
    });)
}​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:03:13.137

Here

[DEMO](http://jsfiddle.net/mplungjan/VjF9Z/)

```
$('.remove_input').live('click', function (e) {
    e.preventDefault();
    var remove = $(this).closest('.RowCheck');
    remove.fadeOut('slow', function () {
        $(this).remove(); // or change next line to  $('.RowCheck:visible')
        $('.RowCheck').each(function (idx) {
            var checkBoxes = $('input[type="checkbox"]',this);
            checkBoxes.each(function(i) {
              var str = $(this).attr('name');  
              var currentIdx = parseInt(str.match(/\d+/)[0], 10);  
              $(this).attr('name', str.replace(currentIdx,idx));
           })
        });
    });
});​ 
```

This code will work if you either

1.  remove the row for real - also suggested by Explosion Pills **or**
2.  test for visible like Simon did

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:19:14.847

你们中的大多数代码都是正确的，但是需要进行一些更改：

更改为使用**$('.RowCheck:visible').each()** as fadeOut 只是隐藏该行但没有真正删除，内部循环应使用**$('input[type="checkbox"]', this)**

代码如下所示：

```
$('.remove_input').live('click', function (e) {
    e.preventDefault();
    var remove = $(this).closest('.RowCheck');
    remove.fadeOut('slow', function () {
        debugger;
        $('.RowCheck:visible').each(function (idx, val) {
            var num = $('.RowCheck:visible').length;
            NumIdx = (num - (num - idx));
            //for(var i = 0; i < num-1; i++){
            //$(this).closest('.RowCheck').next().each(function (idx, val) {
                $('input[type="checkbox"]', this).attr('name', function (idx, str) {
                    var int = parseInt(str.match(/\d+/)[0], 10);
                    return str.replace(int, NumIdx);
                })
            //});
            //}
        });
    });
});​ 
```

[演示](http://jsfiddle.net/k3wne/3/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T15:56:26.067

[http://jsfiddle.net/k3wne/1/](http://jsfiddle.net/k3wne/1/)

有几件事：一旦元素淡出，你就永远不会真正删除元素，这会搞砸你的计数，最后一个选择器 ( `.RowCheck input[type="checkbox"]`) 会影响*所有*复选框，因此它们都将具有最高数字。

在我的更改中，只有迭代中的当前行受到影响。

# asp.net - linq总和和组

> ID：13956003
> 
> 赞同：3
> 
> 时间：2012-12-19T15:46:43.040
> 
> 标签：asp.net, asp.net-mvc, linq, entity-framework

> **可能重复：**
> [Razor 中的动态匿名类型导致 RuntimeBinderException](https://stackoverflow.com/questions/5120317/dynamic-anonymous-type-in-razor-causes-runtimebinderexception)

我有这个 Linq 聚合查询

```
var GruposQ = from lcGrupos in db.Merlin_ConceptosFacturacion_Kit_Componentes
    where lcGrupos.NumIdConcepto == Item.NumIdConcepto & lcGrupos.BitComponenteVariable == true
    select lcGrupos;

var GruposList = from comps in GruposQ
     group comps by
     new
     {
         NumIdGrupoProducto = comps.NumIdGrupoProducto,
     } into g
     select new
     {
         NumIdTransaccion = NumIdTransaccion,
         NumIdGrupoProducto = g.Key.NumIdGrupoProducto,
         NumCantidad = g.Sum(x=>x.NumCantidad),
         Grupo = GruposQ.Where(x => x.NumIdGrupoProducto == g.Key.NumIdGrupoProducto)
     };

ViewBag.CompsKit = GruposList.ToList(); 
```

我的问题是当我尝试从 ViewBag.CompsKit 获取元素时：

```
@foreach (var myTrans in ViewBag.CompsKit)
{
    // Here it throws an error
    // 'object' does not contain a definition for 'NumIdtransaccion'

    <span>myTrans.NumIdtransaccion</span>
} 
```

但是，如果我查看这个对象，它已经拥有该属性。

```
myTrans { NumIdTransaccion = 15460
            , NumIdGrupoProducto = 163
            , NumCantidad = 100,000
            , Grupo = System.Data.Common.Internal.Materialization.CompensatingCollection`1[ParadigmaNet.Areas.Items.Models.Merlin_ConceptosFacturacion_Kit_Componentes] }   dynamic {<>f__AnonymousType7<decimal,decimal?,decimal,System.Linq.IQueryable<ParadigmaNet.Areas.Items.Models.Merlin_ConceptosFacturacion_Kit_Componentes>>} 
```

如何访问属性？在这个集合中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:50:17.187

您不能在 Razor 视图中使用“动态”类型。

您必须使用类型化对象作为模型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:53:39.413

您可以在单个查询中进行分组和过滤：

```
var numIdConcepto = Item.NumIdConcepto;
var query = from comps in db.Merlin_ConceptosFacturacion_Kit_Componentes
            where comps.NumIdConcepto == numIdConcepto &&
                  comps.BitComponenteVariable
            group comps by comps.NumIdGrupoProducto into g
            select new 
            {
               NumIdGrupoProducto = g.Key,
               NumCantidad = g.Sum(x => x.NumCantidad),
               Grupo = g.ToList()
            };        

ViewBag.CompsKit = query.ToList();
ViewBag.NumIdTransaccion = NumIdTransaccion; 
```

还

*   您不需要创建匿名对象来按单个属性进行分组
*   您不需要将布尔值与真/假进行比较
*   使用单个属性进行分组时，您可以简单地使用 g.Key
*   组中的项目已经具有 NumIdGrupoProducto 等于分组键
*   不要将相同的 NumIdTransaccion 分配给查询结果中的每个组，而是将该值传递给单独查看：`ViewBag.NumIdTransaccion = NumIdTransaccion`

看法：

```
<span>ViewBag.NumIdTransaccion</span>

@foreach(var item in ViewBag.CompsKit)
{
    <span>@item.NumIdGrupoProducto</span>
    <span>@item.NumCantidad</span>
} 
```

还可以考虑为这个视图创建 ViewModel - 这样您就可以安全地避免拼写错误，并且所有此类错误都将在编译时消除。

# iphone - （MKAnnotationView *）mapView：第一次查看时不触发

> ID：13956009
> 
> 赞同：0
> 
> 时间：2012-12-19T15:47:14.463
> 
> 标签：iphone, ios

-(MKAnnotationView *) mapView: 在第一次运行视图时没有触发。

我从 JSON 调用中加载引脚。引脚可以很好地加载所有信息，但调用（*参见代码）并将它们变成紫色。（在 -(MKAnnotationView *) mapView2 :) 中完成但是当我离开该选项卡并返回它时，它会被调用并一切都很好。

为什么这不行？因为最终用户如果只检查一次，就不会知道地图图钉具有电话呼叫功能。

**进度流：**它加载地图。加载引脚。呼出时将引脚更改为紫色。然后缩放到引脚和当前位置。但在第一次运行时，它不会更改带有呼叫的引脚。

我已将其缩小到 -(MKAnnotationView *) mapView: 在几次测试中第一次没有触发，但是在一次测试中它确实触发了，但只在两个引脚中的第二个被调用，直到重新加载视图。

我愿意接受任何改进与此相关的任何代码天气的建议。我总是喜欢学习更好的方法来做我所做的事情。因此，请随意提出您的批评。

**.h 文件**

> @class 可达性；

```
@interface LocationsViewController : UIViewController <MKMapViewDelegate,CLLocationManagerDelegate>
{
NSString *phone;

IBOutlet MKMapView *mapView;

CLLocationManager *locationManager;

NSURLConnection *theConnection;

Reachability* internetReachable;
Reachability* hostReachable;
}

@property(nonatomic, retain) IBOutlet MKMapView *mapView;
@property(nonatomic, retain)CLLocationManager *locationManager;
@property(nonatomic, retain) NSString *phone;

- (BOOL) connectedToNetwork;
- (void) mapPinsJSON;

@end 
```

**.m 文件**

```
@implementation LocationsViewController

@synthesize mapView;
@synthesize locationManager;
@synthesize phone;

MapAnnotation *ann1;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self)
    {
        self.title = NSLocalizedString(@"Locations", @"Locations");
        self.tabBarItem.image = [UIImage imageNamed:@"locations"];
    }
    return self;
 }

- (void)dealloc
{
    [super dealloc];
    [[NSNotificationCenter defaultCenter] removeObserver:self];
}

- (void)didReceiveMemoryWarning
{
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];
    // Release any cached data, images, etc that aren't in use.
}

#pragma mark - View lifecycle

//Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad
{
    [super viewDidLoad];    
}

- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
    MKCoordinateRegion region;
    region.center.latitude = newLocation.coordinate.latitude;
    region.center.longitude= newLocation.coordinate.longitude;
    region.span.longitudeDelta=0.2;
    region.span.latitudeDelta =0.2;
    [mapView setRegion:region animated:YES];
    [mapView setDelegate:self];
    NSTimer *myTimer;
    myTimer = [NSTimer scheduledTimerWithTimeInterval:2 target:self selector:@selector(countDown) userInfo:nil repeats:NO];
    [self zoomMapViewToFitAnnotations:self.mapView animated:YES];   
}

-(void)countDown{
    [locationManager stopUpdatingLocation];
}

-(void)viewDidDisappear:(BOOL)animated
{
    [locationManager stopUpdatingLocation];
}

-(void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    [mapView removeAnnotations:mapView.annotations];
    self.locationManager = [[CLLocationManager alloc] init];
    locationManager.delegate = self;
    locationManager.desiredAccuracy = kCLLocationAccuracyBest;
    [locationManager startUpdatingLocation];

    if([self connectedToNetwork] != YES)
    {
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"OH NO!" message:@"To get the latest information you need a data or wi-fi connection" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
        [alert show];
        [alert release];
    }
    else
    {
        [self performSelectorInBackground:@selector(mapPinsJSON) withObject:nil];
    }
}

- (void) mapPinsJSON{

    NSString *urlString = [NSString stringWithFormat:@"http://www.mywebsite.com/api/newlocations25/json.json"];

    NSURL *url = [NSURL URLWithString:urlString];

    NSData *data = [NSData dataWithContentsOfURL:url];

    NSError *error;

    NSMutableDictionary *json = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];

    for(id key in json) {
        id value = [json objectForKey:key];
        NSString *titlePin = [value valueForKey:@"address"];
        NSString *address = [value valueForKey:@"title"];
        NSString *latitude = [value valueForKey:@"latitude"];
        NSString *longitude = [value valueForKey:@"longitude"];

        NSArray* foo = [address componentsSeparatedByString: @":"];
        NSString* address2 = [foo objectAtIndex: 0];
        phone = [foo objectAtIndex: 1];

        double myLatitude = [latitude doubleValue];
        double myLongitude = [longitude doubleValue];

        MKCoordinateRegion location1;
        location1.center.latitude =myLatitude;
        location1.center.longitude= myLongitude;
        location1.span.longitudeDelta=0.1;
        location1.span.latitudeDelta =0.1;

        ann1 =[[[MapAnnotation alloc] init] autorelease];
        ann1.title=[NSString stringWithFormat:@"%@",titlePin];
        ann1.subtitle=[NSString stringWithFormat:@"%@",address2];
        ann1.phone=[NSString stringWithFormat:@"%@",phone];
        ann1.coordinate= location1.center;
        [mapView addAnnotation:ann1];
        [phone retain];     
    }
}

-(MKAnnotationView *) mapView:(MKMapView *)mapView2 viewForAnnotation:(id<MKAnnotation>)annotation {
    if (annotation == mapView2.userLocation) {
        return nil;
    }else{
        MKPinAnnotationView *MyPin=[[MKPinAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:@"current"];
        MyPin.pinColor = MKPinAnnotationColorPurple;

        UIButton *advertButton = [UIButton buttonWithType:UIButtonTypeInfoDark];
        [advertButton setImage:[UIImage imageNamed:@"mapphone"] forState:UIControlStateNormal];
        [advertButton addTarget:self action:@selector(button:) forControlEvents:UIControlEventTouchUpInside];
        MyPin.rightCalloutAccessoryView = advertButton;

        MyPin.draggable = NO;
        MyPin.highlighted = YES;
        MyPin.animatesDrop=TRUE;
        MyPin.canShowCallout = YES;

        return MyPin;
    }
}

-(void)button:(id)sender {

    UIButton *button = (UIButton *)sender;

    MKPinAnnotationView *annotationView = (MKPinAnnotationView*)button.superview.superview;

    MapAnnotation *mapAnnotation = annotationView.annotation;

   UIDevice *device = [UIDevice currentDevice];
    if ([[device model] isEqualToString:@"iPhone"] ) {
        [[UIApplication sharedApplication] openURL:[NSURL URLWithString:[NSString stringWithFormat:@"tel:%@",mapAnnotation.phone]]];
    } else {
        UIAlertView *Notpermitted=[[UIAlertView alloc] initWithTitle:mapAnnotation.phone message:@"Your device doesn't support this feature." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
        [Notpermitted show];
        [Notpermitted release];
    }   
}

- (BOOL) connectedToNetwork
{
    Reachability *r = [Reachability reachabilityWithHostName:@"www.google.com"];
    NetworkStatus internetStatus = [r currentReachabilityStatus];
    BOOL internet;
    if ((internetStatus != ReachableViaWiFi) && (internetStatus != ReachableViaWWAN)) {
    internet = NO;
    } else {
    internet = YES;
    }
    return internet;
}

- (void)viewDidUnload
{
    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
// Return YES for supported orientations
return YES;
}

#define MINIMUM_ZOOM_ARC 0.014 //approximately 1 miles (1 degree of arc ~= 69 miles)

#define ANNOTATION_REGION_PAD_FACTOR 1.15

#define MAX_DEGREES_ARC 360

- (void)zoomMapViewToFitAnnotations:(MKMapView *)mapView3 animated:(BOOL)animated
{

    NSArray *annotations = mapView.annotations;

    int count = [mapView.annotations count];

    if ( count == 0) { return; } //bail if no annotations

    //convert NSArray of id <MKAnnotation> into an MKCoordinateRegion that can be used to set the map size

    //can't use NSArray with MKMapPoint because MKMapPoint is not an id

    MKMapPoint points[count]; //C array of MKMapPoint struct

    for( int i=0; i<count; i++ ) //load points C array by converting coordinates to points  
    {
        CLLocationCoordinate2D coordinate = [(id <MKAnnotation>)[annotations objectAtIndex:i] coordinate];
        points[i] = MKMapPointForCoordinate(coordinate);    
    }

    //create MKMapRect from array of MKMapPoint

    MKMapRect mapRect = [[MKPolygon polygonWithPoints:points count:count] boundingMapRect];

    //convert MKCoordinateRegion from MKMapRect

    MKCoordinateRegion region = MKCoordinateRegionForMapRect(mapRect);

    //add padding so pins aren't scrunched on the edges

    region.span.latitudeDelta  *= ANNOTATION_REGION_PAD_FACTOR;

    region.span.longitudeDelta *= ANNOTATION_REGION_PAD_FACTOR;

    //but padding can't be bigger than the world

    if( region.span.latitudeDelta > MAX_DEGREES_ARC ) { region.span.latitudeDelta  = MAX_DEGREES_ARC; }

    if( region.span.longitudeDelta > MAX_DEGREES_ARC ){ region.span.longitudeDelta = MAX_DEGREES_ARC; }

    //and don't zoom in stupid-close on small samples

    if( region.span.latitudeDelta  < MINIMUM_ZOOM_ARC ) { region.span.latitudeDelta  = MINIMUM_ZOOM_ARC; }

    if( region.span.longitudeDelta < MINIMUM_ZOOM_ARC ) { region.span.longitudeDelta = MINIMUM_ZOOM_ARC; }

    //and if there is a sample of 1 we want the max zoom-in instead of max zoom-out

    if( count == 1 )   
    {    
        region.span.latitudeDelta = MINIMUM_ZOOM_ARC;
        region.span.longitudeDelta = MINIMUM_ZOOM_ARC;     
    }
    [mapView3 setRegion:region animated:animated];   
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T19:21:40.147

嗯，我觉得很害羞。这是为我解决的问题。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    mapView.delegate = self;
} 
```

# redis - 我如何杀死空闲的redis客户端

> ID：13956010
> 
> 赞同：17
> 
> 时间：2012-12-19T15:47:14.087
> 
> 标签：redis

我想超时并杀死空闲的 redis 客户端。有没有我可以设置的设置来做到这一点？我似乎记得在某处设置了配置，但我似乎无法再次找到它。

我希望这可以自动完成，而不是手动调用客户端 kill 命令。

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-19T16:59:44.637

查看 Redis 配置文件（用于启动 Redis 的文件）。

```
# Close the connection after a client is idle for N seconds (0 to disable)
timeout 0 
```

只需检查参数没有被注释掉，并将超时参数更改为以秒为单位的非零值。应重新启动实例以考虑此参数。

要在正在运行的 Redis 实例上更改此参数，您可以使用客户端命令：

```
> src/redis-cli config set timeout 10
OK
> src/redis-cli config get timeout
1) "timeout"
2) "10" 
```

# html - 通过浏览器在 iPhone 或其他移动设备中打开谷歌地图或苹果地图

> ID：13956015
> 
> 赞同：5
> 
> 时间：2012-12-19T15:47:33.143
> 
> 标签：html, asp.net-mvc, google-maps, mobile, apple-maps

我有指向 Google Maps 的链接，但现在自从 Apple 更新到他们自己的服务后，我的 iPhone 转到了 Google Maps 网站。有没有办法在 HTML 中显示[Apple Maps 链接](http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/MapLinks.html)，当它是 iOS6 时，并显示所有其他设备的 Google Maps 链接。我正在使用 ASP.NET MVC。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-04T15:36:24.393

该解决方案甚至比这更容易，并且不需要任何条件语句：

*   从 iOS6 设备单击时，指向 [maps.apple.com/maps?q=cupertino](http://maps.apple.com/maps?q=cupertino)的链接会在 Apple 的本机地图应用程序中打开。
*   但在其他移动设备和计算机上，它会重定向到 Google 地图（位于[maps.google.com/maps?q=cupertino](http://maps.google.com/maps?q=cupertino)）。

所以此时，您需要做的就是包含 Apple Maps 链接，它应该可以在非 iOS 设备上按预期工作。

* * *

我在[最近的](https://stackoverflow.com/questions/14160049/same-parameters-for-apple-maps-and-google-maps-api)一篇文章中提到了这一点，该文章还涉及是否可以使用相同的参数。

# git - 在 Capistrano 中处理用户上传的内容

> ID：13956016
> 
> 赞同：1
> 
> 时间：2012-12-19T15:47:45.303
> 
> 标签：git, version-control, capistrano

我已经设置 capistrano 以部署到登台和生产服务器。困扰我的最后一件事是如何处理用户上传的内容 - 目前，我的上传文件夹及其内容在我的 git repo 中进行了版本控制。如果可能并且不错的做法，我想做的是使用部署脚本来执行通常的部署工作，而且还可以通过向脚本添加任务来将产品服务器上的任何新上传内容推送到存储库。

这是一个明智/可能的举动吗？大家平时是怎么处理这种事情的呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T01:17:36.710

您应该将内容与代码库分开。

一种策略是将您的内容存储在部署端点（在服务器上，它将随着您的应用程序的使用而随着时间的推移而构建）并在部署期间将 capistrano 符号链接到它。

假设您在 '{rails_root}/public' 中有一个名为 'uploads' 的文件夹——您将在部署配方中添加如下内容：

```
# Create a symlink to our 'uploads' folder
namespace :deploy do
  task :symlink_uploads, :roles => :app do
    run "ln -s #{deploy_to}/shared/uploads #{release_path}/public/uploads"
  end
end
after "deploy:update_code", "deploy:symlink_uploads" 
```

# regex - 正则表达式在 Notepad++ 上包含特殊字符

> ID：13956017
> 
> 赞同：1
> 
> 时间：2012-12-19T15:47:45.570
> 
> 标签：regex, notepad++

我正在使用 notepadd++ 来搜索和替换很多名称。

我需要把这些

```
 Neil Kilkenny
 Mateja Kežman
 Kim Do-Heon 
```

进入这个：

```
 Neil,Kilkenny
 Mateja,Kežman
 Kim,Do-Heon 
```

到目前为止，我得到了：

```
 search: ([A-Z]+)([a-z]+) ([A-Z]+)([a-z]+)
 replace: $1,$2 
```

**问题**：我的正则表达式与其中`ž`或`-`其中的名称不匹配。

我考虑过使用`.`，但我不知道这些特殊字符中有多少或它们会出现在哪里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T15:55:22.617

试试这个：

```
([^ \n\t\r]+) ([^ \n\t\r]+) 
```

（不要忘记后面的空格`^`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T15:55:31.820

我认为您唯一确定的是名称将用空格分隔，并且名字在前。因此，我认为使用`.`会很好。

```
([^\s]+) (.+) 
```

-或者-

```
([\S]+) (.+) 
```

（感谢@Simon 提供了第二个更具可读性的解决方案）。

这应该抓住空间之前的所有东西并放在一个组中，并将空间之后的所有东西（包括更多空间）放在一个组中。

* * *

我只是注意到 OP 没有切换组的顺序，如果是这种情况，简单的 find a replace on`<space>`就可以了。但是提供的正则表达式将允许您`<last name>, <first name>`根据需要进行操作。

作为参考，Notepad++ 使用 PCRE。[http://perldoc.perl.org/perlre.html](http://perldoc.perl.org/perlre.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T15:58:21.060

如果这些是剩下的所有空格，请搜索单个空格（或者`[ ]+`如果您担心可能存在连续空格）并替换为`,`. 对于单个空格选项，您甚至不需要正则表达式模式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T15:56:59.913

这个正则表达式似乎正在工作（**将组从 4 减少到 2**）：

```
 ([A-Z]+[a-z]+) ([A-Z]+[a-z]+) 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-19T15:53:38.420

要获得比赛，请`\n`改用。
正则表达式：`([a-zA-Z]+)\s([a-zA-Z]+)`
替换：`\1,\2`

# r - 在 r 中创建具有时间刻度和标签的线图

> ID：13956023
> 
> 赞同：15
> 
> 时间：2012-12-19T15:47:59.767
> 
> 标签：r, plot, axis

我正在尝试创建如下图（很多时候我最终会手动绘制这样的图，但这次我想自己绘制）。

![在此处输入图像描述](../Images/dc1f87a16c9cee9fc10ee13fab004bff.png)

这是我的数据和我的试验：

```
myd <- data.frame (period = c("Triassic", "Jurasic", 
 "Cretaceous", "Cenzoic"), myears = c(245, 208, 145, 65), 
 label = c(226, 176,105, 32 ))
myd2 <- data.frame (event = c("Diansaurs_strt", "Birds", 
  "Diansaurs_ext", "Human"), myears = c(235, 200, 60, 0.5))
myd2$x <- -0.25
with (myd2, plot(x,myears,ylim=c(0,250),
xlim = c(0, 10), axes=F,xlab="",ylab="",type="p",pch=17))
with (myd2,text(x,myears,event,pos=4,xpd=T))
axis(side=2,at = myd$label, labels = myd$period) 
```

![在此处输入图像描述](../Images/67a6d9a8a0f58c52a04320fa6c32a434.png)

我有问题特别是轴与文本和点的绘图和方向匹配。任何其他想法或改进帮助表示赞赏。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-19T17:18:08.613

对于“从头开始”构建新颖的情节，以及对单个图形元素的最大控制，**网格**图形系统很难被击败：

```
library(grid)

## Set up plotting area with reasonable x-y limits
## and a "native" scale related to the scale of the data.
x <- -1:1
y <-  extendrange(c(myd$myears, myd2$myears))
dvp <- dataViewport(x, y, name = "figure")

grid.newpage()
pushViewport(dvp)

## Plot the central timeline
grid.lines(unit(0, "native"), unit(c(0,245), "native"),
           gp = gpar(col="dodgerblue"))

## Annotate LHS
grid.segments(x0=0.5, x1=0.47,
              y0=unit(c(0, myd$myears), "native"),
              y1=unit(c(0, myd$myears), "native"),
              gp=gpar(col="dodgerblue"))
grid.text(label=c(0, myd$myears), x=0.44, y=unit(c(0, myd$myears), "native"))
grid.text(label=myd$period, x=0.3, y=unit(myd$label, "native"),
          just=0, gp=gpar(col="dodgerblue", fontface="italic"))

## Annotate RHS
## Create a function that plots a pointer to the specified coordinate
pointer <- function(x, y, width=1) {
    grid.polygon(x = x + unit(width*(c(0, .1, .1)), "npc"),
                 y = y + unit(width*(c(0, .03, -.03)), "npc"), 
                 gp = gpar(fill="dodgerblue", col="blue", lwd=2))
}
## Call it once for each milestone
for(y in myd2$myears) {
    pointer(unit(.5, "npc"), y=unit(y, "native"), width=0.3)
}
## Or, if you just want blue line segments instead of those gaudy pointers:
## grid.segments(x0=0.5, x1=0.53,
##           y0=unit(c(myd2$myears), "native"),
##           y1=unit(c(myd2$myears), "native"), gp=gpar(col="dodgerblue"))

grid.text(label=myd2$event, x=0.55, y=unit(myd2$myears, "native"),
          just=0) 
```

![在此处输入图像描述](../Images/9f9b3d35b5061bb17ef0d94e7e52265a.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-19T16:30:16.693

您可以尝试这样的事情来帮助您入门：

```
myd <- data.frame(period = c("", "Triassic", "Jurasic", 
                             "Cretaceous", "Cenzoic", ""), 
                  myears = c(260, 245, 208, 145, 65, -5), 
                  label = c(260, 226, 176,105, 32, -5))
myd2 <- data.frame(event = c("Dinosaurs_strt", "Birds", 
                             "Dinosaurs_ext", "Human"), 
                   myears = c(235, 200, 60, 0.5))
myd2$x <- 1
with(myd2, plot(x, myears, ylim = c(-5, 250), xlim = c(0, 10), 
                axes = FALSE, xlab = "", ylab = "", type = "n"))
with(myd2, text(x, myears, event, pos = 4, xpd = TRUE))
axis(side = 2, at = myd$label, labels = myd$period, las = 2)
X0 <- rep(myd2$x, 4)
Y0 <- myd2$myears
X1 <- rep(-.25, 4)
Y1 <- Y0
arrows(X0, Y0, X1, Y1) 
```

![在此处输入图像描述](../Images/215c31d0aa2701ca99aeff7419757403.png)

我在“myd”中数据的开头和结尾添加了一个额外的空元素来帮助轴。然后，`pch`我习惯于`arrows`将右手标签与轴匹配，而不是使用 。

一些调整可能会使它看起来更好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T16:31:10.483

以下是一些增强功能（我建议现在添加 0 以更好地扩展）：

```
myd <- data.frame (period = c("Triassic", "Jurasic", 

 "Cretaceous", "Cenzoic", "now"), myears = c(245, 208, 145, 65, 0), 
    label = c(226, 176,105, 32, NA ))
    myd2 <- data.frame (event = c("Diansaurs_strt", "Birds", "Diansaurs_ext", "Human"),
    myears = c(235, 200, 60, 0.5))
    myd2$x <- -0.25
    with (myd2, plot(x,myears,ylim=c(0,250), xlim = c(0, 10), 
    axes=F,xlab="",ylab="",type="p",pch=17, col = "green"))
    with (myd2, plot(x,myears,ylim=c(0,250), 
    xlim = c(0, 10), axes=F,xlab="",ylab="",type="p",pch="-", col = "green"))
    with (myd2,text(x,myears,event,pos=4,xpd=T), col = "green")
    axis(side=2,at = myd$label, labels = myd$period, tick = FALSE, 
    las = 2, col = "green", )
    axis(side=2,at = myd$myears, labels = myd$myears,  las = 2, col = "green") 
```

![在此处输入图像描述](../Images/7a87b824f55cd1448ed997a27b076c92.png)

剩下的问题很少，您可能想要更改箭头的方向（我相信您可以以某种方式找到 <- 符号，但我不知道如何）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T16:56:22.227

要绘制三角形，请查看 TeachingDemos 包中的`my.symbols`和`ms.polygon`函数。

在你上面的右图中，恐龙被向上移动，如果你想要这个（移动标签，否则会太靠近或重叠）然后查看`spread.labs`TeachingDemos 包中的函数。

其他一些可能有助于绘图的函数是`text`、`mtext`、`grconvertX`、`grconvertY`、`segments`和`axis`。

# android - 以编程方式重新启动android应用程序

> ID：13956026
> 
> 赞同：4
> 
> 时间：2012-12-19T15:48:14.573
> 
> 标签：android, android-intent, intentservice, relaunch

我正在开发适用于 6 个国家/地区的 I18N 应用程序，有一个要求，例如，当用户从设置中更改语言时，应用程序应自行重启并以更改后的语言显示应用程序。为此，我将语言值存储在共享偏好中并与当前语言值进行比较。如果值不同，我需要重新启动应用程序。为此，我使用以下代码：

```
if (currentLanguage == null) {
    Util.saveStringInSP(_activity, "LANGUAGE", languageValue);
}
else if (currentLanguage.equalsIgnoreCase(languageValue)) {
    String currentLanguage = Util.getStringFromSP(_activity, "LANGUAGE");
}
else {
    try {
        android.os.Process.killProcess(android.os.Process.myPid());
    }
    catch(Exception e) {   }
    Intent i = new Intent();
    PackageManager manager = getPackageManager();
    i = manager.getLaunchIntentForPackage("com.pfizer.stablemate");
    i.addCategory(Intent.CATEGORY_LAUNCHER);
    startActivity(i);
} 
```

请提供一段代码以编程方式重新启动 Android 应用程序。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T15:54:41.867

尝试 ：

```
Intent intent = getBaseContext().getPackageManager().getLaunchIntentForPackage(        
getBaseContext().getPackageName() );
intent .addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
intent .addFlags(Intent.FLAG_ACTIVITY_CLEAR_TASK);
startActivity(intent); 
```

# ember.js - 如何知道为什么 ember 数据中的记录是脏的

> ID：13956028
> 
> 赞同：3
> 
> 时间：2012-12-19T15:48:30.560
> 
> 标签：ember.js, ember-data

有没有办法知道为什么记录在 ember 数据中处于脏状态，我的意思是已经改变的属性和关系是什么。

调用 findAll 后我有 isDirty = true ，我想调试为什么会发生这种情况。

非常感谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-05-09T21:17:00.500

从 Ember-Data beta 6 或更早版本开始，有一个`changedAttributes()`函数可以返回已更改属性的哈希值及其初始/当前值。请参阅[http://emberjs.com/guides/models/working-with-records/](http://emberjs.com/guides/models/working-with-records/)

例如：

```
person.changedAttributes(); //=> { isAdmin: [false, true] } 
```

请注意，这`changedAttributes()`不是您可以观察到的属性；但是，如果您需要这样做，您可以观察模型上可能更改的所有属性，然后检查`changedAttributes()`您的计算属性/观察函数内部。

对于（人为的）示例：

```
checkAttributes: (->
  changed = @get('model').changedAttributes()
  if changed['name'] && Object.keys(changed).length == 1
    # Do something if name is the only changed attribute
).property('name', 'alias', 'description') 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T16:54:29.793

根据您使用的 ember-data 版本（以及现在您使用的适配器），这可能会有所不同。[版本 9 中](https://github.com/emberjs/data/blob/master/BREAKING_CHANGES.md#removal-of-dirty-factors)的行为发生了变化。在那之前，你可以说`record.isDirtyBecause('belongsTo')`如果记录因为`belongsTo`关系改变而被标记为脏，它会返回`true`。现在，由于 Stores 和 Adapters 之间的职责发生了一些变化，这由 Adapter 来处理。

> 如果您的适配器中仍需要此信息，则您有责任在上述挂钩中进行[任何](https://github.com/emberjs/data/blob/master/BREAKING_CHANGES.md#adapter-specified-record-dirtying)`dirtyRecordsForAttributeChange`记账。

# c++ - 命令行参数的“条件”解析

> ID：13956029
> 
> 赞同：9
> 
> 时间：2012-12-19T15:48:32.120
> 
> 标签：c++, command-line, terminal, command-line-arguments

假设我有一个可执行文件（在 mac、win 和 linux 上运行）

```
 a.out [-a] [-b] [-r -i <file> -o <file> -t <double> -n <int> ] 
```

其中参数 in`[ ]`表示它是可选的。但是，如果`-r`设置了最后一个参数，那么`-i`, `-o`, `-t`,`-n`也必须提供。

有很多好的 C++ 库可以解析命令行参数，例如 gflags ( [http://code.google.com/p/gflags/](http://code.google.com/p/gflags/) )、tclap ( [http://tclap.sourceforge.net/](http://tclap.sourceforge.net/) )、 simpleopt（[http://code.jellycan.com/simpleopt/](http://code.jellycan.com/simpleopt/)），boost.program_options（[http://www.boost.org/doc/libs/1_52_0/doc/html/program_options.html](http://www.boost.org/doc/libs/1_52_0/doc/html/program_options.html)）等，但我想知道如果有一个可以让我直接对参数之间的这些条件关系进行编码，则无需手动编码错误处理

```
if ( argR.isSet() && ( ! argI.isSet() || ! argO.isSet() || ... ) ) ... 
```

并手动设置`--help`.

库[tclap](http://tclap.sourceforge.net/)允许对参数进行异或运算，例如，一个`-a`或一个`-b`被允许，但不能两者兼而有之。所以，在那个术语中，参数的 AND 会很好。

*有人知道可以做到这一点的多功能、轻量级和跨平台库吗？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:53:39.610

您可以两次通过论点；如果`-r`在选项中，则重置解析器并从添加的新强制选项重新开始。

* * *

您还可以研究 TCLAP 的`XorHandler`工作原理，并创建自己的`AndHandler`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T15:54:55.800

您可以更改参数语法，以便 -r 连续获取四个值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T06:50:44.653

我有一部分`TCLAP`代码片段似乎适合您正在寻找的错误处理部分，但它与您正在寻找的内容不完全匹配：

```
# include "tclap/CmdLine.h"

namespace TCLAP {

class RequiredDependentArgException : public ArgException {
public:
  /**
   * Constructor.
   * \param text - The text of the exception.
   * \param parentArg - The text identifying the parent argument source
   * \param dependentArg - The text identifying the required dependent argument
   * of the exception.
   */
  RequiredDependentArgException(
    const TCLAP::Arg& parentArg,
    const TCLAP::Arg& requiredArg)
  : ArgException(
    std::string( "Required argument ") +
    requiredArg.toString() +
    std::string(" missing when the ") +
    parentArg.toString() +
    std::string(" flag is specified."),
    requiredArg.toString())
  { }
};

} // namespace TCLAP 
```

`TCLAP::CmdLine::parse`然后在被调用后利用新的异常：

```
if (someArg.isSet() && !conditionallyRequiredArg.isSet()) {
  throw(TCLAP::RequiredDependentArgException(someArg, conditionallyRequiredArg));
} 
```

我记得我曾考虑扩展和添加一个额外的类来处理这个逻辑，但后来我意识到我真正想要的唯一东西是好的错误报告，因为逻辑并不完全简单并且不容易压缩（在至少，对下一个出现的可怜人没有用处）。一个人为的场景阻止了我进一步追求它，大意是“如果 A 为真，则必须设置 B，但如果 D 的值为 N，则不能设置 C。” 用本机 C++ 表达这些东西是要走的路，尤其是当需要在 CLI arg 解析时进行非常严格的参数检查时。

[对于真正的病态案例和需求，请使用Boost 之`MSM`](http://www.boost.org/doc/libs/release/libs/msm/doc/HTML/index.html)类的东西创建状态机。（多状态机）。HTH。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-07-09T08:24:04.490

你想解析命令行吗？你可以使用simpleopt，它可以如下使用：下载simpleopt from： [https ://code.google.com/archive/p/simpleopt/downloads](https://code.google.com/archive/p/simpleopt/downloads)

测试： int _tmain(int argc, TCHAR * argv[]) argv 可以是：1.txt 2.txt *.cpp

# vbscript - 如何使.vbs 读/写保护？

> ID：13956031
> 
> 赞同：0
> 
> 时间：2012-12-19T15:48:37.233
> 
> 标签：vbscript

有什么方法可以使 .vbs 文件只读，这样就没有人可以阅读内容或更改内容？但只能双击该文件开始执行。我将设置一个 Main.vbs，我将在其中放入以下内容

```
 Dim oShell : Set oShell = WScript.CreateObject ("WScript.Shell")
 oShell.run "A.VBS", 1, True
 oShell.run "B.VBS", 1, True
 oShell.run "C.VBS", 1, True
 oShell.run "D.VBS", 1, True 
```

用户只需单击 main.vbs 即可开始执行。我想要读/写保护的所有 .vbs。我的想法在实践中可行吗？

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:55:09.710

如果你不能阅读它，你就不能运行它。

您可以设置权限，以使其他人（管理员除外）无法更改该文件，但您不能阻止人们在应该能够运行该文件的情况下读取该文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T03:28:02.797

需要考虑的其他一些选项。可以使用 Microsoft Script Encoder 对脚本进行编码。这将使它不可读。这里有一个下载链接（找不到微软官方下载链接）[http://www.softpedia.com/get/Programming/Packers-Crypters-Protectors/Microsoft-Script-Encoder.shtml](http://www.softpedia.com/get/Programming/Packers-Crypters-Protectors/Microsoft-Script-Encoder.shtml)。当然，人们可以使用适当的工具对文件进行解码。

另一种选择是使用代码签名证书对脚本进行数字签名。这仍然允许查看它，但在不破坏数字签名的情况下将无法对其进行修改。

甚至对脚本进行编码，然后对其进行数字签名。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-29T12:54:01.850

如果这样做的目的是保护您的代码，那么您始终可以制作一个可执行文件。

# c# - 输出路径怎么会有差异？

> ID：13956034
> 
> 赞同：0
> 
> 时间：2012-12-19T15:48:45.460
> 
> 标签：c#, exe, file-handling

我制作了一个应用程序，该应用程序使用另一家公司的 exe 来生成一些输出文件，这些输出文件基于对传递给公司 exe 的一些输入文件所做的计算……为了使 exe 工作，它将在同一目录中查找这些输入文件作为exe文件的位置。

对于输出文件，我发现从我的程序运行 exe 时输出到的文件夹与在 Windows 资源管理器中运行 exe 时不同。

*   当 exe 在 Windows 资源管理器中运行时，这些将输出到 exe 所在的同一目录
*   当我的程序运行时（在 Visual Studio 的调试中），这些输出到调试文件夹

有谁知道如何让我的程序将这些文件输出到同一个目录或为什么会发生这种情况？

除了它是用 Fortran 编写的之外，我对这个 exe 中的代码一无所知。

我正在使用运行 exe`Process.Start(exeName).WaitForExit()`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:51:47.093

您可能正在搜索[Directory.SetCurrentDirectoty](http://msdn.microsoft.com/en-us/library/system.io.directory.setcurrentdirectory.aspx)函数。

在实际执行外部 exe 程序*之前*调用它。将您希望查看输出文件的文件夹完整路径传递给它，这*可能会*解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:53:01.550

当你运行一个应用程序时，每次它应该有一个当前文件夹作为上下文，我认为实际上是那个 exe 使用当前文件夹进行输出，并运行你的程序并调试导致当前文件夹差异。您可以尝试使用 Directory.SetCurrentDirectory 设置当前文件夹，看看是否有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:52:21.253

尝试将[工作目录](http://msdn.microsoft.com/en-us/library/system.io.directory.setcurrentdirectory.aspx)显式设置为两个应用程序所在的目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T15:53:57.470

如果您不想为 C# 应用程序设置工作目录，而只想为运行的程序设置工作目录，请使用该`Process.StartInfo.WorkingDirectory`属性。

例子：

```
var process = new Process();
var startInfo = new ProcessStartInfo("myProgram.exe");
startInfo.WorkingDirectory = "myDirectory";
process.StartInfo = startInfo;
process.Start(); 
```

# jpa - EAR 未部署 (org.eclipse.persistence.exceptions.EntityManagerSetupException)

> ID：13956037
> 
> 赞同：0
> 
> 时间：2012-12-19T15:48:53.510
> 
> 标签：jpa, ejb-3.0, eclipselink

我正在使用 Websphere、JSF 1.2、JPA (Eclipselink) 在我的项目中，我具有以下结构：

```
-APHP0000_EJB
    .APHP0000FacadeEJB.java
    .Controllers (Managers)
    .persistence.xml
-APHP0000_EJBClient 
    .APHP0000FacadeEJBLocal.java
    .APHP0000FacadeEJBRemote.java
    .Entyties
    .TO
-APHP0000_EJBEAR
-APHP0000_Web (depends on APHP0000_EJBClient )
    .jsp
    .ManageBeans
-APHP0000_WebEAR 

-->persistence.xml 

<?xml version="1.0" encoding="UTF-8"?>
<persistence version="1.0" xmlns="http://java.sun.com/xml/ns/persistence"     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"      xsi:schemaLocation="http://java.sun.com/xml/ns/persistence     http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
    <persistence-unit name="APHP0000_EJB" transaction-type="JTA">
    <provider>org.eclipse.persistence.jpa.PersistenceProvider</provider>
    <jta-data-source>java:comp/env/ds_aphp_web</jta-data-source>

    <jar-file>APHP0000_EJBClient.jar</jar-file>

    <class>su.aphpweb.jpa.entities.UnidadeProdutiva</class>
    <class>su.aphpweb.jpa.entities.TipoParadaN4</class>
    ...
    <class>su.aphpweb.jpa.entities.MaquinaProdutiva</class>

    <properties>
        <property name="eclipselink.logging.level" value="FINE" />
        <property name="eclipselink.target-server"      value="org.eclipse.persistence.platform.server.was.WebSphere_7_Platform" />
        <property name="javax.persistence.jtaDataSource" value="jdbc/ds_aphp_web" />
                <property name="eclipselink.cache.shared.default" value="false" />
        <property name="eclipselink.logging.parameters" value="true" />
</properties>
</persistence-unit>
</persistence> 
```

当我启动我的容器时，我的 APHP0000_EJBEAR 已部署，但我的 APHP0000_WebEAR 未部署。并得到以下异常。拜托，自上周以来，我一直坚持这件事。

```
[19/12/12 13:33:49:898 BRST] 00000006 JPAPUnitInfo  E   CWWJP0015E: Ocorreu um erro no provedor de persistência org.eclipse.persistence.jpa.PersistenceProvider quando ele tentou criar factory de gerenciador de entidade do contêiner para a unidade de persistência APHP0000_EJB. Ocorreu o seguinte erro: Exception [EclipseLink-28018] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.EntityManagerSetupException
Exception Description: Predeployment of PersistenceUnit [APHP0000_EJB] failed.
Internal Exception: java.lang.RuntimeException: java.io.FileNotFoundException: D:\Equipe\APHP\APHP0000_EJB\ejbModule\APHP0000_EJBClient.jar (O sistema não pode encontrar o arquivo especificado.)
[19/12/12 13:33:49:898 BRST] 00000006 JPAPUnitInfo  E   CWWJP0009E: O servidor não pode criar um depósito de informações EntityManagerFactory para a unidade persistente APHP0000_EJB do provedor org.eclipse.persistence.jpa.PersistenceProvider no módulo file:/D:/Equipe/APHP/APHP0000_EJB/ejbModule/.
[19/12/12 13:33:49:914 BRST] 00000006 EJBContainerI I   WSVR0037I: Iniciando o jar do EJB: APHP0000_EJB.jar
[19/12/12 13:33:49:914 BRST] 00000006 EJBContainerI I   CNTR0167I: O servidor está ligando a interface su.aphpweb.jpa.entities.controller.ResponsParadaUnidManagerRemote do enterprise bean ResponsParadaUnidManager no módulo APHP0000_EJB.jar do aplicativo APHP0000_WebEAR.  O local de ligação é: ejb/APHP0000_WebEAR/APHP0000_EJB.jar/ResponsParadaUnidManager#su.aphpweb.jpa.entities.controller.ResponsParadaUnidManagerRemote
[19/12/12 13:33:49:914 BRST] 00000006 EJBContainerI I   CNTR0167I: O servidor está ligando a interface su.aphpweb.jpa.entities.controller.UnidadeMotivoTipoManagerRemote do enterprise bean UnidadeMotivoTipoManager no módulo APHP0000_EJB.jar do aplicativo APHP0000_WebEAR.  O local de ligação é: ejb/APHP0000_WebEAR/APHP0000_EJB.jar/UnidadeMotivoTipoManager#su.aphpweb.jpa.entities.controller.UnidadeMotivoTipoManagerRemote
[19/12/12 13:33:49:914 BRST] 00000006 ComponentData E   CWMDF0015E: O carregador de classes não pode carregar a interface su.aphpweb.negocio.ejb.APHP0000FacadeEJBRemote no arquivo su.aphpweb.negocio.ejb.APHP0000FacadeEJB Enterprise JavaBeans (EJB). 
[19/12/12 13:33:49:914 BRST] 00000006 EJBContainerI E   WSVR0040E: Falha no addEjbModule para APHP0000_EJB.jar [class com.ibm.ws.runtime.component.DeployedEJBModuleImpl]
com.ibm.ejs.container.EJBConfigurationException: CWMDF0015E: O carregador de classes não pode carregar a interface su.aphpweb.negocio.ejb.APHP0000FacadeEJBRemote no arquivo su.aphpweb.negocio.ejb.APHP0000FacadeEJB Enterprise JavaBeans (EJB). 
    at com.ibm.ws.metadata.ComponentDataObject.setInterfacesFromImplements(ComponentDataObject.java:783)
    at com.ibm.ws.metadata.ComponentDataObject.finishCDO(ComponentDataObject.java:424)
    at com.ibm.ws.runtime.component.EJBContainerImpl.startModule(EJBContainerImpl.java:2609)
    at com.ibm.ws.runtime.component.EJBContainerImpl.start(EJBContainerImpl.java:3827)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:1120)
    at com.ibm.ws.runtime.component.DeployedApplicationImpl.fireDeployedObjectStart(DeployedApplicationImpl.java:1313)
    at com.ibm.ws.runtime.component.DeployedModuleImpl.start(DeployedModuleImpl.java:619)
    at com.ibm.ws.runtime.component.DeployedApplicationImpl.start(DeployedApplicationImpl.java:938)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplication(ApplicationMgrImpl.java:723)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl$1.run(ApplicationMgrImpl.java:1264)
    at com.ibm.ws.security.auth.ContextManagerImpl.runAs(ContextManagerImpl.java:4476)
    at com.ibm.ws.security.auth.ContextManagerImpl.runAsSystem(ContextManagerImpl.java:4654)
    at com.ibm.ws.security.core.SecurityContext.runAsSystem(SecurityContext.java:255)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplicationDynamically(ApplicationMgrImpl.java:1269)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.start(ApplicationMgrImpl.java:2041)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:437)
    at com.ibm.ws.runtime.component.CompositionUnitImpl.start(CompositionUnitImpl.java:122)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.start(CompositionUnitMgrImpl.java:380)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.startCompositionUnit(CompositionUnitMgrImpl.java:651)
    at com.ibm.ws.runtime.component.CompositionUnitMgrImpl.startCompositionUnit(CompositionUnitMgrImpl.java:613)
    at com.ibm.ws.runtime.component.ApplicationMgrImpl.startApplication(ApplicationMgrImpl.java:1175)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:600)
    at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:36)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:600)
    at sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:243)
    at javax.management.modelmbean.RequiredModelMBean.invokeMethod(RequiredModelMBean.java:1086)
    at javax.management.modelmbean.RequiredModelMBean.invoke(RequiredModelMBean.java:967)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:848)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:773)
    at com.ibm.ws.management.AdminServiceImpl$1.run(AdminServiceImpl.java:1320)
    at com.ibm.ws.security.util.AccessController.doPrivileged(AccessController.java:118)
    at com.ibm.ws.management.AdminServiceImpl.invoke(AdminServiceImpl.java:1213)
    at com.ibm.ws.management.application.AppManagementImpl._startApplication(AppManagementImpl.java:1284)
    at com.ibm.ws.management.application.AppManagementImpl.startApplication(AppManagementImpl.java:1180)
    at com.ibm.ws.management.application.AppManagementImpl.startApplication(AppManagementImpl.java:1140)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:600)
    at sun.reflect.misc.Trampoline.invoke(MethodUtil.java:36)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:600)
    at sun.reflect.misc.MethodUtil.invoke(MethodUtil.java:243)
    at javax.management.modelmbean.RequiredModelMBean.invokeMethod(RequiredModelMBean.java:1086)
    at javax.management.modelmbean.RequiredModelMBean.invoke(RequiredModelMBean.java:967)
    at com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.invoke(DefaultMBeanServerInterceptor.java:848)
    at com.sun.jmx.mbeanserver.JmxMBeanServer.invoke(JmxMBeanServer.java:773)
    at com.ibm.ws.management.AdminServiceImpl$1.run(AdminServiceImpl.java:1320)
    at com.ibm.ws.security.util.AccessController.doPrivileged(AccessController.java:118)
    at com.ibm.ws.management.AdminServiceImpl.invoke(AdminServiceImpl.java:1213)
    at com.ibm.ws.management.connector.AdminServiceDelegator.invoke(AdminServiceDelegator.java:181)
    at com.ibm.ws.management.connector.rmi.RMIConnectorService.invoke(RMIConnectorService.java:282)
    at com.ibm.ws.management.connector.rmi._RMIConnectorService_Tie.invoke(_RMIConnectorService_Tie.java:395)
    at com.ibm.ws.management.connector.rmi._RMIConnectorService_Tie._invoke(_RMIConnectorService_Tie.java:160)
    at com.ibm.CORBA.iiop.ServerDelegate.dispatchInvokeHandler(ServerDelegate.java:622)
    at com.ibm.CORBA.iiop.ServerDelegate.dispatch(ServerDelegate.java:475)
    at com.ibm.rmi.iiop.ORB.process(ORB.java:513)
    at com.ibm.CORBA.iiop.ORB.process(ORB.java:1574)
    at com.ibm.rmi.iiop.Connection.respondTo(Connection.java:2841)
    at com.ibm.rmi.iiop.Connection.doWork(Connection.java:2714)
    at com.ibm.rmi.iiop.WorkUnitImpl.doWork(WorkUnitImpl.java:63)
    at com.ibm.ejs.oa.pool.PooledThread.run(ThreadPool.java:118)
    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1550) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T13:56:48.517

该错误似乎表明它找不到 jar 文件 APHP0000_EJBClient.jar。罐子在耳朵里吗？它需要。

您可以尝试删除标记，并仅列出实体类（只要在类路径中有它们就会被发现）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-10T10:09:36.507

For EJB Exception :CWMDF0015E 需要点击 Eclipse IDE 的 WebSphere Application Server 的发布参数“执行服务器和服务器上的资源”

并运行服务器

# delphi - QuickPDF 将 PDF 转换为图像：字母相互移动

> ID：13956041
> 
> 赞同：1
> 
> 时间：2012-12-19T15:48:59.627
> 
> 标签：delphi

Quick PDF 具有将 PDF 转换为图像的功能：

```
iNumPages := PDFLibrary.PageCount();
PDFLibrary.RenderDocumentToFile(300, 0, iNumPages, 0, 'H:\temp\quickpdf_testimage_6_new.bmp'); 
```

如果执行此功能，字母会相互移动（带有一些 PDF 源）。以下是 PDF 和生成的 JPG： ![在此处输入图像描述](../Images/5dad61f6111969d4e594213505907531.png) ![在此处输入图像描述](../Images/4338ef3a2789c172f8bad8d5e027688a.png) PDF：[http ://www.baunetz.de/aip/2001/tunnel.pdf](http://www.baunetz.de/aip/2001/tunnel.pdf)

现在有一个问题：在生成的图像中，字母相互移动。

**更新**：我有问题的原因：“此 PDF 包含未嵌入在 PDF 中的字体 (OfficinaSans-Book)，因此 Quick PDF 替代了 Arial，它具有较粗的字符。

这是 PDF 和许多 PDF 查看器的常见问题。最好的解决方案是为 PDF 中使用的任何非标准字体创建嵌入字体的 PDF。” [http://www.quickpdf.org/forum/topic2478_post10369.html#10369](http://www.quickpdf.org/forum/topic2478_post10369.html#10369)

**更新 2：** 到目前为止，唯一没有“字母相互移动”问题的 PDF 引擎是 foxit DLL。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T09:32:51.897

我有问题的原因：“此 PDF 包含未嵌入在 PDF 中的字体 (OfficinaSans-Book)，因此 Quick PDF 替换了 Arial，而不是具有较粗字符的字体。

这是 PDF 和许多 PDF 查看器的常见问题。最好的解决方案是为 PDF 中使用的任何非标准字体创建嵌入字体的 PDF。” [http://www.quickpdf.org/forum/topic2478_post10369.html#10369](http://www.quickpdf.org/forum/topic2478_post10369.html#10369)

**编辑**：如果在系统上找不到字体，一个可能的解决方案是使用 MultiMaster 字体。Adobe 使用这种技术。但我还没有找到用 quickpdf 实现它的方法。

# .net - .net XML 反序列化 - 跟踪哪些属性已被反序列化

> ID：13956047
> 
> 赞同：1
> 
> 时间：2012-12-19T15:49:23.337
> 
> 标签：.net, xml-serialization, xmlserializer

我有一个遗留系统，它首先从 XML 文件中读取配置类，然后在它们被反序列化后对结果对象执行一些其他逻辑。

在编写将旧配置文件迁移到新格式的工具时，我正在尝试执行常规序列化过程，但只需要跟踪那些已从 XML 文件反序列化的属性。有没有办法连接到 XML 序列化程序以触发它反序列化的每个属性的某些事件？

考虑如下类：

```
public class UrlPrefs{
    public string LoginUrl = "http://default.com/login";
    public string LogoutUrl = "http://default.com/logout";
    public int MaxFailedLogins = 3;
}

// ...

public UrlPrefs ReadUrlPrefs(string fileName){
    var ser = new XmlSerializer(typeof(UrlPrefs));
    using(var stream = new StreamReader(fileName)){
        UrlPrefs ret = (UrlPrefs)ser.Deserialize(stream);
        return TouchUpPrefsFromDB(ret); // Gets another layer of overrides from the database...
    }
} 
```

以下将是一个有效的 UrlPrefs.xml：

```
<UrlPrefs>
    <LoginUrl>http://customer.com/login</LoginUrl>
    <LogoutUrl>http://customer.com/logout</LogoutUrl
</UrlPrefs> 
```

请注意，MaxFailedLogins 未在 XML 中设置，因此默认为 3。
因此，我想监视序列化程序以了解 LoginUrl 和 LogoutUrl 是唯一被触及的。

注意：我知道我可以将它们转换为属性并在 setter 方法中执行一些逻辑，但我们谈论的是现实世界中的数百个属性，而不仅仅是我示例中的 3 个，所以我试图避免这种情况有点乏味。

# python - 单击 django 管理站点中的后退按钮

> ID：13956049
> 
> 赞同：1
> 
> 时间：2012-12-19T15:49:29.777
> 
> 标签：python, django-admin

我是 Django 新手。我正在尝试 django admin/auth 系统。我先登录管理站点，然后注销。注销并单击浏览器（Chrome）上的后退按钮后，我仍然看到旧的管理页面。它不应该被重定向到登录页面吗？如果是这样 我的设置是否存在一些配置问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:54:30.267

## 发生了什么

Chrome 不会再次获取该页面，只是显示“之前”的内容以及 Chrome 存储在其缓存中的内容。

Chrome 甚至不会向您的网络服务器询问该页面，而且据您的应用所知，您从未返回过该页面。

## 别担心

但是，如果您：

*   刷新页面
*   尝试发布一些数据，

Chrome 必须访问您的网络服务器，Django 将重定向到登录页面。

# image - Matlab - 如何获取像素值？

> ID：13956051
> 
> 赞同：2
> 
> 时间：2012-12-19T15:49:34.383
> 
> 标签：image, matlab, pixel

如果我有一张图片，我怎样才能获得该图片中每个像素的值`matlab`

谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T15:51:10.597

图像是 MATLAB 中的矩阵（灰度为 2D，彩色为 3D）。

您可以使用它`x(i,j)`来访问`(i,j)`灰度图像中某个位置的像素。

如果图像是彩色的，您可以使用`x(i,j,:)`分别访问 3 向量中的 r、g、b 值。如果您需要单独的通道，则可以使用`x(i,j,1)`红色例如。

您可以阅读[此页面](http://www.mathworks.com/help/images/image-types-in-the-toolbox.html)以了解更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T15:44:54.697

您可以使用`reshape`将图像的所有像素值提取到具有像素值的向量中：

```
frame = imread('picture.jpg');
frame_size = size(frame);
allpixels = reshape(frame, frame_size(1)*frame_size(2), frame_size(3)) 
```

当您想对您的 Matlab 代码进行矢量化（以避免`for`循环遍历每个像素）时，这可能很有用。要取回原始图像表示：

```
frame2 = reshape(allpixels, frame_size); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-05T04:44:21.993

要获取值，`pixel(1,1)`我们只需编写`image(1,1)`.

# vb.net - 新工作，巨无霸项目

> ID：13956052
> 
> 赞同：1
> 
> 时间：2012-12-19T15:49:36.050
> 
> 标签：vb.net, design-patterns, project

所以，几周前我刚刚开始了一份新工作。这是我做软件的第一份工作，我的任务是学习一个巨大的项目是如何工作的。现在，我之前的那个人在源代码的任何地方都没有留下任何（zilch）文档或注释。此外，他基本上应用了 Gamma 等着名的*设计模式*书中的每一种设计模式......

我的问题是，我该如何开始？我已经尝试为我想学习的某些调用设置断点（一点一点地学习），但是由于使用了 500 万种设计模式，每次调用都会上升大约 7 个级别才能完成，到那时，很难保持跟踪正在创建和使用的 20 个对象。

有没有人有类似的经历？关于尝试不同方法的一些指示？

规格：语言 - VB.net
IDE - Visual Studio 2010
使用 - Windows Forms
Brain - Melting

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:58:49.177

Inheriting a large project without documentation is always a huge pain in the ass. I hope you have already accustomed your manager to the inconvenient truth that it will take several weeks or even months until you can maintain that project efficiently.

I would start with creating some [UML class diagrams](http://en.wikipedia.org/wiki/Class_diagram). That could tell you a lot about how the system works and which design patterns are used where.

While doing so, I would also add comments to the code with everything I learned about it. When I am not sure if I understood what the code does correctly, I would add a common string like "NOT_SURE" to the comment. Later, when I have a better understanding of the system, I could use a text search to find and revise these comments.

# python - 我可以在 mongodb 运行时更改 mongod 的 binding_ip 吗？

> ID：13956054
> 
> 赞同：0
> 
> 时间：2012-12-19T15:49:37.847
> 
> 标签：python, mongodb

我在 ubuntu 12.04 机器上安装了 mongodb 2.2.2，我需要在数据库运行时修改 binding_ip 列表，而无需重启 mongo。有没有办法这样做？可以从pymongo做吗？

ps 我真的试过了

mongod --config /etc/mongodb.conf --bind_ip 127.0.0.1 31\. *** *

提供了 bind_ip 列表，但它说

12 月 19 日星期三 17:02:05 [initandlisten] initAndListen 中的异常：10309 无法创建/打开锁定文件：/var/lib/mongodb/mongod.lock errno:13 Permission denied mongod 实例是否已经在运行？，终止

而且我不确定它是否不仅仅是重新启动数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:05:25.183

显然你可以用`iptables(8)`规则来做。然后尝试（使用 192.0.2.1 作为您要接收连接的 IP 地址）：

```
iptables -A INPUT -p tcp -d '!' 192.0.2.1 -p 27017 --m state --state NEW -j REJECT 
```

如果您已经有 iptables 规则，那么您可能需要不同的命令。检查 的输出`iptables -L INPUT`。

# c++ - Boost.Python：获取对包装 C++ 对象的 python 弱引用

> ID：13956055
> 
> 赞同：6
> 
> 时间：2012-12-19T15:49:38.703
> 
> 标签：c++, python, boost-python

我已经使用 Boost.Python 包装了一个 C++ 类。这些对象在 C++ 端具有强引用（boost::shared_ptr），Python 中也可能存在间歇性强引用。到目前为止，一切正常。但是，如果我从其中一个强引用创建一个 python 弱引用，那么一旦最后一个 python 强引用消失，这个弱引用就会被删除。我希望弱引用保持活跃，直到 C++ 端的最后一个强引用也消失。有可能实现吗？

换一种说法：有没有办法从 python 中找出一个特定的 C++ 对象（由 Boost.Python 包装）是否仍然存在？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T11:42:58.117

您如何持有对包装类的“C++ 强引用”？

我对 boost python 很生疏，但我相信 boost::shared_ptr 的删除器存在确保了生命周期管理。

如果这不是问题，您可能需要将 C++ 中的实例保存在 boost::python::object 中。

# database - 可插拔数据库接口

> ID：13956059
> 
> 赞同：0
> 
> 时间：2012-12-19T15:49:56.980
> 
> 标签：database, database-agnostic

我正在开展一个项目，我们正在确定多个批发商后端系统接口的规范。这是我们正在使用的，

1.  每个批发商都有多种产品，超过 10,000 种。每个批发商都为其产品定制了价格。
2.  未来被访问的批发商列表将继续增长，因此系统可能会访问 1000 家批发商。
3.  批发商在地理上分散。
4.  该系统的界面将允许用户选择他们想要的批发商并浏览他们的产品。
5.  产品价格更新应实时反映在网站上。因此，如果批发商更新价格，它应该立即在网站上可用。
6.  系统应该与数据库无关。
7.  该系统应该易于在批发商端设置，并且对他们的日常活动的干扰最小。

最初，我考虑为我们端的每个批发商创建数据库，但未来可能有 1000 家批发商，就性能和存储而言，这是最佳选择吗？直接查询批发商数据库而不是在本地存储他们的数据会更好吗？我们可以做到这一点并且仍然保持与数据库无关吗？这种实现的最佳技术堆栈是什么？我需要某种 ORM 工具。

首选基于 Java 的框架和技术。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:54:39.337

如果您想创建一个可以切换数据库的软件，我建议您使用[Hibernate](http://www.hibernate.org/)（如果您使用 .Net，则使用[NHibernate ）。](http://nhforge.org/)

Hibernate 是一个不依赖于特定数据库的 ORM，这使您可以非常轻松地切换数据库。它已经在大型应用程序中得到证明，并且很好地集成在[Spring 框架](http://www.springsource.org/)中（但也可以在没有 Spring 框架的情况下使用）。（如果使用 .Net，则[Spring.net](http://www.springframework.net/)等效）

Spring 是构建大型可扩展应用程序（包含 IoC-Container、数据库访问层、事务管理、支持 AOP 等等）的良好技术栈。

Wiki 为您提供了一个简短的概述：

[http://en.wikipedia.org/wiki/Hibernate_(Java](http://en.wikipedia.org/wiki/Hibernate_(Java) )

[http://en.wikipedia.org/wiki/Spring_Framework](http://en.wikipedia.org/wiki/Spring_Framework)

> 直接查询批发商数据库而不是在本地存储他们的数据会更好吗？

这取决于访问远程数据的可用性和延迟。数据库本身有多种可能性可以通过多个服务器实例使它们保持同步。问问自己，如果批发商数据库（部分）离线，应该/会发生什么。也许并非所有数据都需要复制。

> 我们可以做到这一点并且仍然保持与数据库无关吗？

是的，请参阅我与 ORM (N)Hibernate 相关的答案。

> 这种实现的最佳技术堆栈是什么？

“最佳”取决于您的要求。我喜欢春天。如果您使用 .Net，内置的 ADO.NET 实体框架也可能适合。

# plone - Is it possible to avoid Diazo theming when printing?

> ID：13956063
> 
> 赞同：3
> 
> 时间：2012-12-19T15:50:14.983
> 
> 标签：plone, diazo

The look of a page printed by plone is ok and neutral thanks print.css. It would be rather handy to have a diazo rule which switchs off theming in the case that the page is printed (that the demanding device is a printer).

```
<notheme if="$print" /> 
```

But how to define $print in manifest.cfg?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T16:31:49.790

Unless you want to have a specific print URL, that won't work. print.css works at the browser/css level. The server doesn't even know, and the page isn't even reloaded.

I think the general consensus is that CSS is the right way to do this. So, stick with that strategy unless you have very unusual requirements.

# html - HTML问题中的特殊字符

> ID：13956065
> 
> 赞同：0
> 
> 时间：2012-12-19T15:50:17.460
> 
> 标签：html, character

尽管我包含了 ISO-8859-1 内容类型 META，但我的网站没有显示特殊字符，例如 ã 和 ê。如果我从 MYSQL 查询中“回显”一个字符串，则特殊字符会正确显示。如果我用纯 HTML 编写相同的字符，它将不会显示在同一个网站上。提前致谢。

[http://popguest.com.br/event/index3.php?c=48&p=3](http://popguest.com.br/event/index3.php?c=48&p=3)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:57:47.043

也许您可以使用一个简单的例程将所有特殊字符编码为实体（&#x----; 在 x 之后使用正确的十六进制 unicode 数字）

（切换到 UTF-8 也不错）

# python - 寻找 Pygame 和 Python 3.2

> ID：13956069
> 
> 赞同：0
> 
> 时间：2012-12-19T15:50:26.117
> 
> 标签：python, pygame

我对编程完全陌生，并且正试图让我的脚湿透。我一直在使用 Michael Dawson 写的绝对可爱的“Python Programming for the Absolute Beginner”。问题在于，在后面的章节中，他希望读者使用 pygame（实际上是他自己修改的版本，但足够接近）。问题是我无法找到它并为 Python 3.2 安装

有没有一种极其简单易用的下载和使用方法？我能找到的只有 pygame for 2.x 以及一些关于自己创建它或使用终端魔法的模糊解释，这两者都以我的经验水平使我难以理解。有没有一些直接的方法，或者我必须使用那些看似复杂的方向在黑暗中笨拙？多谢你们

编辑：好的，伙计们，你们仍然很可爱，但我需要 Pygame for Mac。因为我不想需要 Windows，所以我感到非常沮丧！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:16:01.553

[http://www.lfd.uci.edu/~gohlke/pythonlibs/](http://www.lfd.uci.edu/~gohlke/pythonlibs/)

该站点有一个非官方的 pygame 库，已针对 python 3.2 进行了更新。搜索页面：

pygame-1.9.2pre.win-amd64-py3.2.‌exe 或 pygame-1.9.2pre.win32-py3.2.‌exe

有几种选择。

# android - VideoView 中的视频大小错误（Nexus 7）

> ID：13956072
> 
> 赞同：1
> 
> 时间：2012-12-19T15:50:45.613
> 
> 标签：android, video, resolution, android-videoview

我正在实现一个带有广告的视频播放器。最终，在广告播放恢复后，播放暂停并显示一些广告。

为了实现这一点，我用一个 VideoView 和另一个 View 完成了 FrameLayout 来显示广告。

当广告中断时，我会：

```
videoView.pause();
videoView.setVisibility(View.GONE);
adsView.setVisibility(View.VISIBLE):
//Play ads for X time
adsView.setVisibility(View.GONE);
videoView.setVisibility(View.VISIBLE);
videoView.play(); 
```

它相当简单，在我尝试过的所有设备上都可以正常工作，除了 Nexus 7。在 Nexus 7 上，当恢复播放时，视频会变小并且不会填满整个屏幕。它只使用大约 1/4 的屏幕。

经过数小时的调查后，我意识到只有在更改 VideoView 的可见性时才会发生这种情况。如果我评论以下行`//videoView.setVisibility(View.GONE);`，问题就会消失，但我看不到广告。

一些可能相关的日志：

```
NvOsDebugPrintf   BeginSequence 640x368
NvOsDebugPrintf   pnvsi->nDecodeBuffers = 9 
NvOsDebugPrintf   Display Resolution : (640x360) 
NvOsDebugPrintf   Display Aspect Ratio : (128x360) 
```

显示纵横比 (128x360) 应与显示分辨率 (640x360) 相同，但事实并非如此。

任何的想法？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:19:53.467

不确定原因，但似乎存在测量错误（我认为还有其他关于 n7 测量问题的报告）。View.GONE 导致视图被重新排列以考虑现在从消失视图中释放出来的空间。

作为一种解决方法，您可以避免被重排——尝试将两个视图都放在一个 RelativeLayout 中，并通过将宽度和高度上的 fill_parent 设置为两者来使它们完全重叠。然后您可以使用`setVisibility(View.INVISIBLE)`不会导致小部件调整大小的。

# java - JAXB 更改服务器上的 XML 顺序，但不更改 localhost

> ID：13956077
> 
> 赞同：2
> 
> 时间：2012-12-19T15:51:01.593
> 
> 标签：java, xml-parsing, jaxb

我有以下格式的 XML：

```
<products>
     <product>
          <id>1</id>
          <name>a</name>
          <price>24.5</price>
     </product>
     <product>
          <id>2</id>
          <name>b</name>
          <price>3.75</price>
     </product>
     .
     .
     .
</products> 
```

我正在使用 JAXB 从 XML 中获取数据。

这就是 xsd 的样子：

```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified">
  <xs:element name="products">
    <xs:complexType>
      <xs:sequence>
        <xs:element maxOccurs="unbounded" ref="product"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="product">
    <xs:complexType>
      <xs:sequence>
        <xs:element ref="id"/>
        <xs:element ref="name"/>
        <xs:element ref="price"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <xs:element name="id" type="xs:integer"/>
  <xs:element name="name" type="xs:NCName"/>
  <xs:element name="price" type="xs:decimal"/>
</xs:schema> 
```

我的问题是，在本地主机上，我像在 XML 中一样获得产品（id 1 比 id 2 等）但是当我将它上传到我的亚马逊服务器（linux）时，我得到不同的排序，我不明白为什么。

有人有解释吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T17:39:03.530

默认情况下[**，JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)实现不定义顺序。这意味着 Java VM 之间的行为可能不同。有几个选项可用于定义订单。

**选项1 -`@XmlType(propOrder={"foo", "bar})`**

在类级别使用此注释允许您指定查看编组为 XML 的 XML 元素的顺序。

**选项 #2 -`@XmlAccessorOrder(XmlAccessOrder.ALPHABETICAL)`**

您可以`@XmlAccessorOrder`在类级别使用注释来指定您希望查看按字母顺序编组为 XML 的 XML 元素。

# python - 如何将带有时区的日期时间转换为python中的UTC时间

> ID：13956079
> 
> 赞同：1
> 
> 时间：2012-12-19T15:51:06.813
> 
> 标签：python, datetime, utc, python-dateutil

我曾经`dateutil`将字符串转换`'Wed, 19 Dec 2012 01:34:52 -0800'`为日期时间`datetime.datetime(2012, 12, 19, 1, 34, 52, tzinfo=tzoffset(None, -28800))`。如何将其转换为 UTD+0 `datetime.datetime(2012, 12, 19, 9, 34, 52)`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T15:52:04.460

使用`.astimezone()`方法：

```
dt.astimezone(pytz.UTC) 
```

# model-view-controller - 如何从 ASP.MVC 4 中经过身份验证的用户获取外部登录提供程序的类型？

> ID：13956084
> 
> 赞同：1
> 
> 时间：2012-12-19T15:51:17.690
> 
> 标签：model-view-controller, oauth, asp.net-mvc-4

我将 ASP.MVC 4 与使用表单身份验证的帐户控制器一起使用。我使用 OAuthWebSecurity.RegisterFacebookClient 等将 Facebook 和 Twitter 添加为外部登录提供程序。现在我想在控制器和视图中获取用户登录类型（Facebook、Twitter、登录名/密码等）。我怎样才能得到这个？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T09:35:53.770

我自己在 AccountController 中找到答案，操作 RemoveExternalLogins ：

```
ICollection<OAuthAccount> accounts = OAuthWebSecurity.GetAccountsFromUserName(User.Identity.Name); 
```

和帐户包含提供者字段 - account.Provider。对于 Facebook，它将是“Facebook”。

# android - Android 平台上的自定义水平 StackView

> ID：13956086
> 
> 赞同：1
> 
> 时间：2012-12-19T15:51:25.447
> 
> 标签：android, android-ui, android-library, coverflow

我正在尝试在 Android 平台（4.0 版）上设计一个 UI，这类似于从 iPad 上看到的 Apple App Store 的 Cover Flow 设计。（请查看随附的屏幕截图）。

![CoverFlowA][1]: [http://i.stack.imgur.com/pF2EC.png](http://i.stack.imgur.com/pF2EC.png)

我发现最接近这个的 Android 组件是 StackView。

问题： 1\. 这是正确的 Android 组件吗？如果没有，那么使用哪一个？

1.  是否可以扩展 StackView 来模仿这个 UI？

2.  在 Android 平台上是否有可用的 API/库？

# qt - 如何在 QGraphicsLayout 中获取隐藏的 QGraphicsItem 以放弃其空间？

> ID：13956087
> 
> 赞同：3
> 
> 时间：2012-12-19T15:51:29.357
> 
> 标签：qt

我有一个 QGraphicsLinearLayout，里面有一系列 QGraphicsWidgets。我可以很好地隐藏小部件，但是布局将所有剩余的小部件隔开，就好像隐藏的小部件仍然可见一样。我怎样才能让布局使用这个空间？

我的代码是这样的：

```
//scene is a QGraphicsScene*, myWidget# inherits QGraphicsWidget
scene->addItem(myWidget1);
layout->addItem(myWidget1);
scene->addItem(myWidget2);
layout->addItem(myWidget2)
scene->addItem(myWidget3);
layout->addItem(myWidget3)

//then later, I call
myWidget2->hide(); 
```

但是尽管 myWidget2 现在是不可见的，但布局仍然是间隔开的，就好像它在那里一样。我该如何改变呢？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:47:26.380

尝试调用 QGraphicsLinearLayout::invalidate() 以在隐藏小部件后清除所有缓存的几何信息。如果这没有帮助，我会假设从布局中删除小部件（如果这对您可行）应该这样做。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-19T16:26:44.627

我认为您正在寻找`QWidget::findChild<T>(Qstring name)`
名称 - 可以使用 QObject::setObjectName(Qstring name)
T 设置的对象名称 - 是您正在寻找的对象类型。
因此，在您的情况下，代码应如下所示：

```
MyWidget* myWidget1 = new MyWidget(this);
myWidget1->setObjectName("myWidget1");
........
MyWidget* requiredWidget=scene->findChild<MyWidget*>("myWidget1"); 
```

# hex - 十六进制偏移扇区

> ID：13956088
> 
> 赞同：1
> 
> 时间：2012-12-19T15:51:31.323
> 
> 标签：hex, byte, response, offset, nameservers

我从一个长于 512 字节的名称服务器得到响应。在那个响应中有一些补偿。响应开头的偏移量很好，但是当我超过 512 字节时，偏移量会发生变化并且它不再起作用。

`c0 0c`=从一开始的第12个字节（就像一个魅力）

我有一个偏移量：`c1 f0`这意味着（据我所知）

`c1`= 1 x 512 = 512
`f0`= 240

`c1 f0`= 字节 512 中的字节 240 == 字节 752

我的偏移量应指向名称的开头，该名称应位于字节 752，但在字节 752 处未找到名称。

**质疑**
512 字节后偏移量如何工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T13:32:02.487

这是一个相对的参考。为了表明它是一个相对引用，前 2 位被“保留”。最多可以引用 14 位：保留最高 2 位的 2 个字节。C0 01 是参考偏移量 1。因此它不必总是 C0。它也可以是 C1、C2、C3、C4、CF 等。实际上，除非您有非常复杂的长时间运行的查询，否则这种情况很少见。我有一个超过 3000 字节的查询:)

C1 =`11000001`
剥离 2 个最高位：`000001`
数字 =`1`

偏移量`C1 F0`是`1 x 256 + 240 = 496`
偏移量`C9 9F`是`9 x 256 + 159 = 2463`

在一个字节中有 256 个组合，而不是使用 512 ：S
的最大值`C0`是`C0 FF`255。之后`C1 00`开始

这个解释的学分去[http://www.helpmij.nl/forum/member.php/215405-wampier](http://www.helpmij.nl/forum/member.php/215405-wampier)

# ruby-on-rails - Rails 3.2.9 拦截用于重映射的资产请求

> ID：13956089
> 
> 赞同：0
> 
> 时间：2012-12-19T15:51:31.453
> 
> 标签：ruby-on-rails

在 Ruby on Rails 3.2.9 中，有一种方法可以拦截资产请求并重新映射正在请求的 URL。

例如，对于 /assets/javascripts/app.js 的请求，我想拦截请求并删除 javascripts/。我已经在 application.rb 中尝试过

```
config.asset_path = proc { |path| 
    path.slice! 'javascripts/'
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:50:17.120

我不知道有任何方法可以拦截对资产的请求，而且我非常怀疑是否存在或者根本不会存在。

仅仅是因为它不适用于已编译的资产。如果资产位于具有完全不同软件堆栈的另一台服务器上怎么办？例如，如果有人选择在 Amazon S3 上托管资产，那么请求怎么会被拦截？

如果您确实需要此功能并且您正在自托管您的资产，那么最好的方法是配置您的 Web 服务器以重定向请求。

看看`RewriteEngine`Apache 或`HttpRewriteModule`nginx。它们提供了 URL 重写的机制。（我猜大多数生产级 Web 服务器也有类似的东西）

# matlab - 在伪彩色图中突出显示某些值

> ID：13956096
> 
> 赞同：3
> 
> 时间：2012-12-19T15:51:43.663
> 
> 标签：matlab, plot

关于在 matlab 中绘制伪彩色图，我有一个非常基本的问题。假设我有如下情节：

```
d1 = 1:4;
d2 = 1:4;
dat = [2,3,4,1;...
    3,4,7,1;...
    8,7,6,1;...
    2,3,3,1];
pcolor(d1,d2,dat);shading interp 
```

那么我是否可以在此图上画一条突出显示某些值的线，例如通过值 = 5 画一条线？请注意，我想避免使用 contourf 并想在这种情况下使用 pcolor。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T16:28:34.910

您可以使用`contour`在绘图上绘制等高线`pcolor`。

```
d1 = 1:4;
d2 = 1:4;
dat = [2,3,4,1;...
3,4,7,1;...
8,7,6,1;...
2,3,3,1];
pcolor(d1,d2,dat);
shading interp
hold on

%# use the same contour level twice if you only have a single one
contour(dat,[5 5],'color','k','lineWidth',2) 
```

![在此处输入图像描述](../Images/d3cab94f6719cfa540fbbbba0eec6185.png)

# java - 从重复的 ANTLR 规则中删除多余的符号

> ID：13956097
> 
> 赞同：1
> 
> 时间：2012-12-19T15:51:42.843
> 
> 标签：java, antlr, dsl, antlr3, antlrworks

考虑以下简单的语法。

```
grammar test;

options {  
  language = Java; 
  output = AST;
}                     
//imaginary tokens
tokens{ 
}

parse
    : declaration
    ;

declaration
    : forall
    ;
forall
    :'forall' '('rule1')' '[' (( '(' rule2 ')' '|' )* ) ']' 
    ;
rule1
    : INT
    ;
rule2
    : ID
    ;
ID  
    : ('a'..'z' | 'A'..'Z'|'_')('a'..'z' | 'A'..'Z'|'0'..'9'|'_')*
    ;
INT 
    : ('0'..'9')+
    ;
WHITESPACE
    : ('\t' | ' ' | '\r' | '\n' | '\u000C')+ {$channel = HIDDEN;}
    ; 
```

这是输入

```
forall (1) [(first) | (second) | (third) | (fourth) | (fifth) |] 
```

语法适用于上述输入，但我想从输入中删除额外的管道符号（输入中的倒数第二个字符）。
有什么想法/想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:58:29.100

My antlr syntax is a bit rusty but you should try something like this:

```
forall
    :'forall' '('rule1')' '[' ('(' rule2 ')' ('|' '(' rule2 ')' )* )? ']' 
    ; 
```

That is, instead of `(r|)*` write `(r(|r)*)?`. You can see how the latter allows for zero, one or many rules with pipes inbetween.

# mysql - 为一对多表关系创建联接查询

> ID：13956103
> 
> 赞同：3
> 
> 时间：2012-12-19T15:52:02.650
> 
> 标签：mysql, sql, join, one-to-many

我有一个表 (Table `D`)，它的字段与另一个表 (Table `M`) 相关联，其中包含一组引用 table 中单行的行`D`。

可以（如果可以，如何）我可以创建一个 SQL 查询，它不仅可以从 中选择字段`D`，还可以与 table 连接`M`，在单个结果列中返回所有行值（仅来自一列），但全部连接在一起（最好有某种转义，这样它就不会被流氓数据污染`M`）？

编辑：

```
+-----------+----------+-------------+
| DataRowID | DataName | RandomField |
+-----------+----------+-------------+
| 1         | Foo      | Alice       |
+-----------+----------+-------------+
| 2         | Bar      | Bob         |
+-----------+----------+-------------+
| 3         | Baz      | Charlie     |
+-----------+----------+-------------+

+-----------+-----------+-----------+
| MetaRowID | DataRowID | MetaValue |
+-----------+-----------+-----------+
| 1         | 1         | Mercury   |
+-----------+-----------+-----------+
| 2         | 1         | Venus     |
+-----------+-----------+-----------+
| 3         | 1         | Earth     |
+-----------+-----------+-----------+
| 4         | 2         | Mars      |
+-----------+-----------+-----------+
| 5         | 2         | Jupiter   |
+-----------+-----------+-----------+
| 6         | 3         | Saturn    |
+-----------+-----------+-----------+
| 7         | 3         | Uranus    |
+-----------+-----------+-----------+
| 8         | 3         | Neptune   |
+-----------+-----------+-----------+
| 9         | 3         | Pluto     |
+-----------+-----------+-----------+ 
```

什么时候`Where DataName = 'Bar'`查询，

```
+-----------+----------+-------------+--------------+
| DataRowID | DataName | RandomField | MetaData     |
+-----------+----------+-------------+--------------+
| 2         | Bar      | Bob         | Mars,Jupiter |
+-----------+----------+-------------+--------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:55:40.413

使用MySql的[`GROUP_CONCAT`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_group-concat)功能：

```
SELECT d.ID, GROUP_CONCAT(m.Field) AS ConcatFields
FROM d JOIN m ON d.ID = m.dID
GROUP BY d.ID 
```

# c# - 将用户定义的函数添加到 Visual Studio Excel 加载项

> ID：13956104
> 
> 赞同：12
> 
> 时间：2012-12-19T15:52:03.367
> 
> 标签：c#, excel, user-defined-functions, excel-addins

在 Visual Studio 中，我有一个 Excel 2010 插件项目。我怎样才能让该项目创建以下模块：

![在此处输入图像描述](../Images/77eeee4f077bfbb8765944d070b80b1d.png)

我知道我可以使用该模块保存该工作簿，然后将其与我的插件一起使用。如果我可以让我的插件创建该模块，那就太好了...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-22T02:00:15.750

可以创建模块。但是，要使其正常工作，必须在 Excel 中选择“信任对 VB 项目模型的访问”的设置。如果未选择信任设置，则会引发拒绝访问的错误。

```
using Excel = Microsoft.Office.Interop.Excel;
using VB = Microsoft.Vbe.Interop;

Excel.Application eApp = new Excel.Application();

eApp.Visible = true;
Excel.Workbook eBook = eApp.Workbooks.Add();

VB.VBProject eVBProj = (VB.VBProject)eBook.VBProject;
VB._VBComponent vbModule = eVBProj.VBE.ActiveVBProject.VBComponents.Add(VB.vbext_ComponentType.vbext_ct_StdModule);

String functionText = "Function MyTest()\n";
      functionText += "MsgBox \"Hello World\"\n";
      functionText += "End Function";

vbModule.CodeModule.AddFromString(functionText); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T19:19:11.537

我不认为 VSTO 支持 Excel UDF，一般建议是使用自动化插件（如 Sid 的链接所示）。

另一种选择是从 VBA 调用托管 VSTO 函数。再一次，这是不推荐的，但可能的。

（链接中的教程回顾）这是从 VBA 调用托管函数的任何简单方法。

在 VSTO 中使用您的函数创建一个类

```
<System.Runtime.InteropServices.ComVisible(True)> _
Public Class MyManagedFunctions
    Public Function GetNumber() As Integer
        Return 42
    End Function
End Class 
```

在 VSTO 中将您的课程连接到 VBA

```
Private Sub ThisWorkbook_Open() Handles Me.Open
    Me.Application.Run("RegisterCallback", New MyManagedFunctions)
End Sub 
```

为托管代码创建 Hook 并为 VBA 中的函数创建一个包装器

在电子表格或文档的 VBA 模块中

```
Dim managedObject As Object

Public Sub RegisterCallback(callback As Object)
    Set managedObject = callback
End Sub

Public Function GetNumberFromVSTO() As Integer
    GetNumberFromVSTO = managedObject.GetNumber()
End Function 
```

现在您可以在单元格中输入 =GetNumberFromVSTO()，当 excel 启动时，单元格的值应该是 42。

[http://blogs.msdn.com/b/pstubbs/archive/2004/12/31/344964.aspx](http://blogs.msdn.com/b/pstubbs/archive/2004/12/31/344964.aspx)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-27T17:18:26.687

如果您真正想做的是编写 .NET UDF，或组合 .NET 应用程序级命令和 UDF 插件，那么使用 VSTO 目前不是一个好的解决方案：
我建议使用[Addin Express](http://www.add-in-express.com/add-in-net/index.php)（成本）或[Excel DNA](http://excel-dna.net/)（免费）。
这两者都允许您创建 .NET XLL UDF 插件和自动化 UDF 插件（XLL UDF 插件提供显着的性能优势，但对 Excel 对象模型的访问稍有限制）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T21:40:15.940

VSTO 插件无法创建 UDF，因此您需要为函数创建单独的插件。尽管此插件可以与 VSTO 插件在同一个 DLL 中，但如果没有特殊技巧，您无法在 VSTO 和 UDF 之间进行通信。

我有一篇关于这个的[博客文章](http://csharpramblings.blogspot.ca/2011/09/communicating-between-vsto-and-udfs-in.html)。它为您提供了一个完整的示例项目，其中包括 VSTO 和 UDF。

这是UDF本身的基本结构。

```
[Guid("3B81B6B7-3AF9-454F-AADF-FAF06E5A98F2")]
[InterfaceType(ComInterfaceType.InterfaceIsDual)]
[ComVisible(true)]
public interface IFunctions
{
    int MYINT();
}

[Guid("F58C591D-A22F-49AD-BC21-A086097DC26B")]
[ClassInterface(ClassInterfaceType.None)]
[ComVisible(true)]
public class Functions : IFunctions 
{
    public int MYINT()
    {
        return 42;
    }
} 
```

# model-view-controller - MVC LINQ：找不到源类型“X”的查询模式的实现。未找到“选择”

> ID：13956106
> 
> 赞同：0
> 
> 时间：2012-12-19T15:52:16.410
> 
> 标签：model-view-controller, linq-to-sql

刚开始弄乱存储库/接口等，在选择一条我无法解决的记录时出现错误。

我的控制器有：

```
 public ViewResult Detail(int ID)
    {
        var Details = (from x in repo.GetBreakdown(ID) select new BreakdownDetailViewModel { }).SingleOrDefault();

        return View(Details);
    } 
```

语句 repo.GetBreakdown(ID) 带有以下错误的下划线：

```
Could not find an implementation of the query pattern for source type ''. 'Select' not found. 
```

我的界面显示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using Domain.Entities;

namespace Domain.Abstract
{
    public interface IBreakdownRepository
    {
        tblBreakdown_Log GetBreakdown(int ID);
        IQueryable<tblBreakdown_Log> GetAllBreakdowns { get; }

    }
} 
```

存储库本身具有：

```
 public tblBreakdown_Log GetBreakdown(int ID)
        {
            return (from x in db.tblBreakdown_Logs where x.MB_ID == ID select x).SingleOrDefault();
    } 
```

关于这里的问题有什么想法吗？

谢谢，克里斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T09:03:33.147

基于@Evan 的评论

将我的存储库访问更改为：

```
 public IEnumerable<tblBreakdown_Log> GetBreakdown(int ID)
        {
            return (from x in db.tblBreakdown_Logs where x.MB_ID == ID select x);
        } 
```

存储库的接口现在具有：

```
 IEnumerable<tblBreakdown_Log> GetBreakdown(int ID); 
```

我的控制器访问权限是：

```
 public ViewResult Detail(int ID)
        {
        var Details = (from x in repo.GetBreakdown(ID) select new BreakdownDetailViewModel {Machine_Status=x.tblMachine_Status.Machine_Status, MB_ID=x.MB_ID});

        return View(Details);
    } 
```

现在所有工作都按需要工作=]

# php - 在其他域的另一个页面上加载 PHP 页面的 div

> ID：13956107
> 
> 赞同：7
> 
> 时间：2012-12-19T15:52:17.173
> 
> 标签：php, jquery, wordpress, html, load

早上好，我有这种情况：

我正在使用 Wordpress，并且正在尝试为我们的附属公司创建一个附属框。我已经动态创建了它，你可以[在这里看到一个例子](http://www.clubmagellano.it/affiliate-box/?value=okt_232425)

用于创建盒子的值通过 $_GET 传递，盒子由模板页面上的 the_content() 之前调用的 php 函数创建。

如果您直接加载页面，该框可以正常工作。

但是我正在尝试将该特定 div 加载到另一个页面中，并且为了测试，我正在尝试将它加载到我的同一域的页面中。

测试页面在[这里](http://www.clubmagellano.it/test-affiliate-box/)

我正在使用 jQuery load() 函数进行加载，如下所示：

```
jQuery(document).ready(function(){
   var valore = jQuery('#cm_aff_box_container').text();
   jQuery('#cm_aff_box_container').empty().load('http://www.clubmagellano.it/affiliate-box/?value='+valore+' #cm_affiliate_box', function(){/*Other stuff here*/});
    });     
}); 
```

不幸的是，它不会在 div 中加载任何内容。我尝试直接加载页面并且它正确加载，尽管在这种情况下我的附属框也没有加载。

我还读到 load() 函数不适用于其他域，我需要这种可移植性。我怎么解决这个问题？

==========更新===========

我已经解决了，并且该框已加载到我的域中。问题是，我怎样才能将它加载到另一个域？

==========更新 2.0 ===========

伙计们，我已经解决了这个问题：

```
<?php header("Access-Control-Allow-Origin: *"); ?> 
```

到创建框的域的 header.php 文件。它完美地工作！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T15:55:49.680

为什么不使用[iframe](http://www.w3schools.com/tags/tag_iframe.asp)？它通常用于在页面中显示广告。

```
<iframe id="cm_affiliate_box"></iframe>

.
.
.

jQuery(document).ready(function(){
   jQuery('#cm_affiliate_box').attr('src', 'http://www.clubmagellano.it/affiliate-box/?value='+valore+' #cm_affiliate_box');     
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T08:28:38.053

如果每个人都遇到此问题，请遵循以下解决方案：

将此代码放入域模板的 header.php 中，即必须加载的域。

```
<?php header("Access-Control-Allow-Origin: *"); ?> 
```

load() jQuery 函数将识别为受信任的网站并加载该框。这是完美的工作！

如果您不想允许所有域但只允许一些域，而不是“*”，您可以编写允许检索框的域的链接。

# php - Magento“注意：未定义的变量：响应”

> ID：13956111
> 
> 赞同：0
> 
> 时间：2012-12-19T15:52:28.063
> 
> 标签：php, magento

我正在运行 Magento 1.6.2.0。

每次下订单时，我都会在 system.log 中注意到以下 3 行：

```
2012-12-19T15:37:00+00:00 ERR (3): Recoverable Error: Argument 1 passed to Mage_Core_Controller_Varien_Action::__construct() must be an instance of Zend_Controller_Request_Abstract, array given, called in /chroot/home/saucench/saucencheese.com/html/app/code/core/Mage/Core/Model/Config.php on line 1351 and defined  in /chroot/home/saucench/saucencheese.com/html/app/code/core/Mage/Core/Controller/Varien/Action.php on line 138

2012-12-19T15:37:00+00:00 ERR (3): Recoverable Error: Argument 2 passed to Mage_Core_Controller_Varien_Action::__construct() must be an instance of Zend_Controller_Response_Abstract, none given, called in /chroot/home/saucench/saucencheese.com/html/app/code/core/Mage/Core/Model/Config.php on line 1351 and defined  in /chroot/home/saucench/saucencheese.com/html/app/code/core/Mage/Core/Controller/Varien/Action.php on line 138

2012-12-19T15:37:00+00:00 ERR (3): Notice: Undefined variable: response  in /chroot/home/saucench/saucencheese.com/html/app/code/core/Mage/Core/Controller/Varien/Action.php on line 141 
```

所以显然变量“响应”没有定义。任何人都可以帮助我找到导致此错误的来源吗？它不能在 Config.php 或 Action.php 中，因为我从未修改过它们。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T15:54:50.413

在这个文件上

```
/chroot/home/saucench/saucencheese.com/.../Core/Controller/Varien/Action.php 

on line 141 
```

查看那里发生了什么并确保`$variables`已定义。

# c# - 使用 XNA 游戏工作室在 2D 游戏中进行按键拍摄

> ID：13956112
> 
> 赞同：2
> 
> 时间：2012-12-19T15:52:30.347
> 
> 标签：c#, xna, xna-4.0

我正在使用 XNA 游戏工作室 4.0 开发 2D 游戏，我需要让我的“英雄”精灵拍摄一个长方形的射击精灵。

当我按下左键投篮时，投篮是从我的球员开始的。到目前为止，一切正常，但问题是它永远不会停止 - 它的位置永远不会到`theVoid`.

这是我的拍摄代码：

```
protected override void Update(GameTime gameTime)
{
    if (Keyboard.GetState().IsKeyDown(Keys.LeftControl) && isShotted == false)
    {
        isShotted = true;
        shotPosition = playerPosition;            
    }
    if (isShotted == true && (shotPosition.X <= shotPosition.X+150) )
    {
        shotPosition.X += shotSpeed.X * (float)gameTime.ElapsedGameTime.TotalSeconds;
    }
    else 
    { 
        isShotted = false;
        shotPosition = theVoid;
    }
} 
```

一些澄清：

*   `playerPosition`是我的“英雄”精灵位置。
*   `theVoid`是`Vector2 (700,700)`，当我设置`shotPosition = theVoid`镜头消失时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:07:24.660

镜头永远不会消失，因为您正在更新`shotPosition.x`每个更新。您正在检查：

```
if (isShotted == true && (shotPosition.X <= shotPosition.X+150) ) 
```

然后在里面`if`你增加`shotPosition.X`：

```
shotPosition.X += shotSpeed.X * (float)gameTime.ElapsedGameTime.TotalSeconds; 
```

解决此问题的一种选择是检查`shotPosition.X`玩家位置 - 根据@jonhopkins 评论。但是，如果玩家可以接近与射击相同的速度移动，他们可以跟随它，然后射击永远不会消失，这可能是也可能不是你想要的。

您的另一个选择是存储射击的位置，并比较以下内容：

```
if (isShotted == true && (shotPosition.initialX+150 >= shotPosition.currentX) ) 
```

不过，请确保根据玩家和对象如何在坐标系中移动来考虑这一点。如果您的播放器相对于 x 轴始终是静止的，那么与它们是否可以在屏幕上运行相比，这可以简化事情。

# mongodb - MongoDb 需要每个元素的 id

> ID：13956116
> 
> 赞同：1
> 
> 时间：2012-12-19T15:52:46.453
> 
> 标签：mongodb

这是一个 mongodb 记录的 json 表示

```
{
  _id : ObjectId("4e77bb3b8a3e000000004f7a"),
  when : Date("2011-09-19T02:10:11.3Z",
  author : "alex",
  title : "No Free Lunch",
  text : "This is the text of the post.  It could be very long.",
  tags : [ "business", "ramblings" ],
  votes : 5,
  voters : [ "jane", "joe", "spencer", "phyllis", "li" ],
  comments : [
    { who : "jane", when : Date("2011-09-19T04:00:10.112Z"),
      comment : "I agree." },
    { who : "meghan", when : Date("2011-09-20T14:36:06.958Z"),
      comment : "You must be joking.  etc etc ..." }
  ]
} 
```

现在我有一个问题，如果我想从`comments`数组中删除任何评论，我该怎么做？

我不想依赖评论文本。

是否有任何工具可以为文档中的每个对象提供 id。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T20:24:07.027

在文档插入期间未填充时，_id 字段将自动添加到顶级文档。当您有子文档时，它基于您的应用程序需要并且您必须设计这样，您应该能够通过某种方式指向该子文档。

对于您的情况，我们可能可以使用 comment_id 字段，该字段可用于唯一标识您的子文档，以便以后对它们进行各种操作（如果需要）。

希望这可以帮助！

# php - PHP如何用km计算经度，纬度

> ID：13956118
> 
> 赞同：1
> 
> 时间：2012-12-19T15:52:58.413
> 
> 标签：php, mysql

> **可能重复：**
> [如何进行基于位置的搜索](https://stackoverflow.com/questions/615403/how-to-do-location-based-search)
> [从数据库中获取相似的经度和纬度](https://stackoverflow.com/questions/13951056/getting-similar-longitude-and-latitude-from-database)

我有一个使用 MySQL 数据库的约会 PHP 应用程序，用户在其中输入他们的位置，并根据它显示其他配置文件。

表结构`cities`：

```
int id PK
int country_id FK
varchar(50) name
float longitude
float latitude 
```

表中的示例条目：

```
1 | 1 | New York | 23.20323 | 12.32356 
```

我想选择所有经度和纬度分别小于 23.20323 + 50 公里，大于 23.20323 - 50 公里的城市。

这里的问题不是 SQL 语法，而是实际的半径计算。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T15:57:33.710

您可以使用 Great Circle 算法来做到这一点。[http://en.wikipedia.org/wiki/Great-circle_distance](http://en.wikipedia.org/wiki/Great-circle_distance)

以下是如何找到距离。您需要求解 lat2 的方程。

距离 = ((因子 * (lat2-lat1)) ^ 2 + (因子 * (lng2 - lng1) * cos(lat2 / 57.3)) ^ 2) ^ .5

注意：因数 ~ 69.1 英里 ~ 115.1666667 公里

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T15:57:45.160

看看[Haversine 函数](http://en.wikipedia.org/wiki/Haversine_formula)。这是两个纬度/经度点的球面距离计算。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T16:05:44.060

这应该是你所追求的。

```
//Get your base city location e.g. New York
$base_lat = 12.32356;
$base_lng = 23.20323;

//Get target distance in miles
$target_distance = 31; //50km is approx 31 miles

//Select all cities that are closer than 50km (31 miles)
SELECT id, ( 3959 * acos( cos( radians('.$base_lat.') ) * cos( radians( latitude ) ) * cos( radians( longitude ) - radians('.$base_lng.') ) + sin( radians('.$base_lat.') ) * sin( radians( latitude ) ) ) ) AS distance
FROM cities
WHERE latitude IS NOT NULL
AND longitude IS NOT NULL
HAVING distance < $target_distance
ORDER BY distance ASC

//Select all cities that are further than 50km (31 miles)
SELECT id, ( 3959 * acos( cos( radians('.$base_lat.') ) * cos( radians( latitude ) ) * cos( radians( longitude ) - radians('.$base_lng.') ) + sin( radians('.$base_lat.') ) * sin( radians( latitude ) ) ) ) AS distance
FROM cities
WHERE latitude IS NOT NULL
AND longitude IS NOT NULL
HAVING distance > $target_distance
ORDER BY distance ASC 
```

# android - 使用谷歌地图获取位置周围的建筑物地址

> ID：13956125
> 
> 赞同：3
> 
> 时间：2012-12-19T15:53:27.703
> 
> 标签：android, google-maps-api-3

我想获取某个半径内所有建筑物的地址和坐标。我可以使用[http://maps.googleapis.com/maps/api/geocode/json?latlng=60.009719,30.354376&sensor=false&radius=2000](http://maps.googleapis.com/maps/api/geocode/json?latlng=60.009719,30.354376&sensor=false&radius=2000) 来获取最近的构建地址。或者我可以使用 [https://maps.googleapis.com/maps/api/place/search/json?location=60.009719,30.354376&radius=200&sensor=false](https://maps.googleapis.com/maps/api/place/search/json?location=60.009719,30.354376&radius=200&sensor=false)获得多个结果 问题是第一个请求只显示有关一个建筑物的信息，第二个向我展示了很多东西，但它向我展示了组织，而不仅仅是建筑物。Place api 有地方过滤器，但我无法确定适合我的情况的过滤器。谢谢。

# css - 源代码中不需要的 CSS

> ID：13956131
> 
> 赞同：4
> 
> 时间：2012-12-19T15:53:49.943
> 
> 标签：css, wordpress

在我的源代码中，我有以下代码：

```
<style>
/*Twenty Twelve fixes and other theme fixes and styles :( */

.flex-caption {
     background: #000;   
     -ms filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#4C000000,endColorstr=#4C000000);
     filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#4C000000,endColorstr=#4C000000); 
     zoom: 1;
 }

/*...*/
</style> 
```

这不在我的个人 CSS 文件中，我不知道这是从哪里提取的。

我根据 Wordpress Codex 链接到我的外部 CSS 文件，以包含如下样式表：

```
<link rel="stylesheet" href="<?php bloginfo('stylesheet_url'); ?>" type="text/css" /> 
```

我需要怎么做才能删除这个 CSS？

***编辑********

现在已经解决了这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:01:28.090

看起来您从 WordPress 的 TwentyTwelve 主题开始，或者从它继承并从那里进行更改的另一个主题。如果你看一下，`/wp-content/themes/head.php`我想你可能会在那里找到令人反感的风格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:02:23.510

如果它不在您的 CSS 中，它可能在 header.php 中

转到外观 > 编辑器 > 标题 (header.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:03:38.130

我已经弄清楚是什么产生了这个并删除了。这是一个插件，我没有使用它。

NextGEN 画廊插件生成这个。

# ruby - 如何判断 RVM 安装的 ruby 实际使用了哪个 openssl lib

> ID：13956134
> 
> 赞同：7
> 
> 时间：2012-12-19T15:53:56.573
> 
> 标签：ruby, openssl, rvm

我发现我可以使用以下任何命令成功安装 ruby​​：

```
$ rvm reinstall 1.9.3-p327
$ rvm reinstall 1.9.3-p327 --with-openssl-dir=/usr/local
$ rvm reinstall 1.9.3-p327 --with-openssl-dir=/afdlkjasd_not_a_dir
$ rvm reinstall 1.9.3-p327 --with-openssl-dirffadsf=/afdlkjasd_not_a_dir 
```

无论我使用上述哪个命令，我都可以输入：

```
$ rvm use 1.9.3-p327
Using /home/clay/rvm/gems/ruby-1.9.3-p327
$ which ruby
/home/clay/.rvm/rubies/ruby-1.9.3-p327/bin/ruby
$ ruby -e "puts require('openssl')"
true 
```

无论我做什么，我似乎都有 ssl 支持。我猜 rvm 或 ruby​​ 构建过程不介意无效的选项或值。`--with-openssl-dir`即使我（显然）正确输入该选项，我也不知道是否尊重该选项。

rvm 是否将我的 ruby​​ 与我想要的 openssl lib 链接（/usr/local 中的那个）？**如何判断 ruby​​ 是与哪个 openssl lib 编译/链接的？**

我正在使用 Linux Mint 13。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T17:15:44.020

怎么样：

```
ruby -ropenssl -e "puts OpenSSL::VERSION" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T18:40:57.380

Ruby 有相当复杂的库检测机制，每个扩展都有自己的代码。幸运的是，大多数扩展都支持`pkg-config`，因此可以强制定位`*.pc`文件：

```
PKG_CONFIG_PATH=/path/to/openssl/lib/pkgconfig rvm reinstall 1.9.3
rvm use 1.9.3 
```

然后编译后你可以在 OSX 上验证：

```
find $MY_RUBY_HOME -name openssl.bundle | xargs otool -L 
```

或在 Linux 上：

```
find $MY_RUBY_HOME -name openssl.so | xargs ldd 
```

至于`--with-openssl-dir=...`ruby​​ 不完全支持，应该是`--with-opt-dir=...`+ `--with-openssl`，opt-dir 支持`:`从 ruby​​ 1.9.3-p327 开始分隔的多条路径

# sql - Windows Azure - 带有 api 的 sql 数据库

> ID：13956135
> 
> 赞同：1
> 
> 时间：2012-12-19T15:53:58.013
> 
> 标签：sql, database, api, azure

我有带有数据的 SOAP 服务。我想从该服务下载所有数据并将其上传到我自己的服务器，然后从我的服务器使用这些数据（不用担心我有权限）。我想这样做是因为现在我没有所需的服务功能。

我想为此使用 Windows Azure，我认为 SQL 数据库方案是最好的。现在我有以前的 SOAP 服务的类，所以我认为 EF 代码首先会帮助我创建数据库，然后我会以某种方式上传数据。但是 API 呢？如何从 windows phone 或平板电脑访问我的数据？天蓝色数据库足够还是我必须创建更多？有什么好的文章吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:58:16.203

我认为您的意思是您正在汇总来自多个来源的数据并将信息存储在您自己的数据库中。而且，您希望您的数据库是 Azure 数据库。然后，您想构建一个 API 来公开您检索到的数据。

如果这确实是您的目标，那么是的，Azure 将满足您的一切需求。我建议[结合您的 Azure 部署检查 Web API](https://www.windowsazure.com/en-us/develop/net/tutorials/rest-service-using-web-api/)。在过去的一年里，我使用了这个方案并取得了一些成功。

**警告：** 您应该知道 Azure 数据库没有 SLA，这意味着 Microsoft 不保证任何级别的性能，包括每秒事务数。这意味着，如果您的 API 负载很高，您最终可能会以不可预知的方式受到严重限制。我之前被这个问题困扰，最终将我的数据移动到 Azure 表存储。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:58:33.987

Windows Azure 为您提供了一些向移动客户端公开 API 的选项：

*   您可以使用 ASP.NET Web API 自己构建一个 API（并使用 SQL Azure 作为后端）：[使用 ASP.NET Web API 和 SQL 数据库的移动友好 REST 服务](https://www.windowsazure.com/en-us/develop/net/tutorials/rest-service-using-web-api/)
*   您可以使用[Windows Azure 移动服务](https://www.windowsazure.com/en-us/develop/mobile/)，这将为您完成构建后端的所有繁重工作

# version-control - Mercurial 错误 - hg push, abort:error: ''

> ID：13956139
> 
> 赞同：0
> 
> 时间：2012-12-19T15:54:16.453
> 
> 标签：version-control, mercurial

我正在尝试使用 Mercurial 进行简单的推送，但是我在 DOS/cmd 中得到以下响应：

```
hg push
pushing to https://name@repo.website.com/frontend
http authorization required
realm: Mercurial Repository
user: name
password:
searching for changes
abort: error: '' 
```

密码是小写的并且输入正确 - 任何人都可以建议为什么会出现这个问题？

我已经完成了以下命令：

```
hg push --debug --traceback 
```

它遍历了许多文件，最后出现以下错误：

```
URLError: <urlopen error ''>
abort: error: '' 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T17:04:02.457

奇怪..经过几次尝试后，`hg push -v --debug --traceback`它工作得非常好......不知道为什么会发生，我猜**远程服务器有一些奇怪的超时问题**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T05:03:41.637

[17\. 诊断“中止：错误”消息](http://mercurial.selenic.com/wiki/TipsAndTricks#Diagnose_.22abort%3a_Error.22_messages)的一些官方提示

1.  在服务器上的 hgweb 中[禁用 cgitb](http://docs.python.org/2/library/cgitb.html)
2.  `--debug --traceback`在客户端上运行
3.  检查服务器上的错误日志

在遇到同样的问题时，**hg server restart**对我有用（我无权破解服务器）。

# google-app-engine - 每天更改谷歌应用引擎上的每个页面

> ID：13956145
> 
> 赞同：0
> 
> 时间：2012-12-19T15:54:31.523
> 
> 标签：google-app-engine

我在谷歌应用引擎上放了一个应用程序。

我的应用程序有一个 cronjob，它解析来自 Internet 的数据并将其存储到我的数据库中。

当用户使用我的应用程序时，它将从数据库中提取数据，并向用户显示数据。

我发现这太耗时了，而且来自 db 的请求太多。

我想在每天运行 cronjob 时修改每一页。

然后用户可以在不查询我的数据库的情况下看到该页面。

我怎样才能在 GAE 中做到这一点？

感谢你的回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:21:21.550

问题中没有足够的信息来帮助您。例如，“来自 db 的请求太多”是什么意思？是因为你的流量很大吗？或者你查询数据库太多了？可能的解决方案是：

1.  边缘缓存您的页面：[https ://groups.google.com/forum/#!topic/google-appengine/6xAV2Q5x8AU/discussion](https://groups.google.com/forum/#!topic/google-appengine/6xAV2Q5x8AU/discussion)

2.  将您的页面存储在内存缓存中。

3.  优化您的数据库访问。很可能你正在做一些非常低效的事情。

4.  使用 cronjob 生成您的页面，将其存储在 blobstore 中，并将您的提取重定向到 blobstore。你可以这样做，但考虑到有更好的选择，这是一种非常愚蠢的方法。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-19T16:02:57.357

I'm afraid it's a limitation of GAE, according to [this post](https://groups.google.com/forum/?fromgroups=#!topic/google-appengine/ImkolUIYJcs), no matter how much caching and tricky solutions you find. They just worsen google's policies.

You can't have what you need if you don't write directly inside the html file and store it on the server every time, which is far more resource consuming and, in my opinion, just pointless. Since GAE is a free service, with the purpose of testing, you should acquaint with what you have, or pay.

# ios - Xcode 中多个目标的类和标头

> ID：13956146
> 
> 赞同：1
> 
> 时间：2012-12-19T15:54:32.800
> 
> 标签：ios, xcode, header-files

我在标题中定义了一个`@interface`for 类，并在文件中定义了相应的实现。如果我在 Xcode 项目的不同目录中添加该类的另一个实现，我可以在“实用程序”栏的“文件”选项卡中指定“目标成员”，以将实现分配给特定目标。`Foo``Foo.h``Foo.m``Foo.m`

但是，这不适用于头文件。`Foo.h`如果我为类添加不同的标题，`Foo`则无法在“实用程序”栏的“文件”选项卡中分配“成员资格”。对于我声明的每个属性，我总是收到错误“类' `Foo`'的重复接口”，然后出现几个错误“属性具有先前的声明”。

如何使用 Xcode 4.5.2 为不同目标使用在不同标头中定义的具有相同名称的类？

**更新：**我已经尝试过[此线程](https://stackoverflow.com/questions/4868716/xcode-importing-different-header-file-with-same-name-based-on-target?rq=1)中建议的解决方案，但它在 Xcode 4.5.2 中不起作用，错误消息如上所示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T17:59:48.813

由于您的 Foo 类在两个目标之间仅部分不同，因此我建议您有一个 Foo.h 和一个 Foo.m。然后，您使用编译器指令来处理这些差异。

转到每个目标的构建设置并在“其他 C 标志”下添加一个标志。例如，对于目标 A，您可以添加：

```
-DTARGETA 
```

对于目标 B，您可以添加：

```
-DTARGETB 
```

然后在 Foo.h 你可以这样做：

```
@interface Foo : NSObject

@property commonProperty;
#if defined(TARGETA)
@property targetAProperty;
#elif defined(TARGETB)
@property targetBProperty;
#endif

@end 
```

为 Foo.m 做类似的事情。

# flash - 这个隐藏的 Zugo Flash 电影在我的页面上做什么？

> ID：13956147
> 
> 赞同：4
> 
> 时间：2012-12-19T15:54:33.360
> 
> 标签：flash, privacy, malware, spyware

我发现一个奇怪的东西隐藏在我的页面上：

```
 <div id="SiUnhdqlqHN9t7wB_tbstore_container" style="left: -2000px; top: -2000px; position: absolute;">
       <param name="movie" value="http://tbupdate.zugo.com/ztb/2.5/jsi/man/fc.swf"/>
   <param name="allowScriptAccess" value="always"/> 
```

编辑：我看到它也在 Chrome 中，而不仅仅是 IE，而且我在高级设置中禁用了所有的网络服务搜索增强功能等。

编辑：我检查了不在办公室的 PC 上的标记，并且 Zugo 不存在。可能只有办公室的 PC 或我的 PC 上的浏览​​器受到影响。

另一个编辑：这似乎是 StartNow 搜索扩展。希望我知道它是如何在工作时安装在我的 PC 上的。

我将使用此网格来跟踪 HIPAA 将涵盖的数据，并且需要知道隐私没有受到损害。此网格或此页面上不应有任何“打电话回家”的内容。真的。

问题的编程方面：如果 allowScriptAccess 设置为“always”，这个 SWF 可以看到 DOM 中的所有内容吗？如果 ID 发生变化，我有什么办法可以使用 javascript 来“杀死”它？

# mysql - 这个简单的 COALESCE 选择查询有什么问题？(mysql)

> ID：13956157
> 
> 赞同：3
> 
> 时间：2012-12-19T15:54:56.143
> 
> 标签：mysql, sql, select, coalesce, null-coalescing-operator

我有这个查询：

```
SELECT
    COALESCE(CONCAT(Ar.usaf, '-', Ar.wban),"NONE") AS TABLE_NAME
FROM
    `metadata`.`ISH-HISTORY_HASPOS` A
 INNER JOIN `metadata`.`Artificial` Ar ON (Ar.id = A.mergeId)
WHERE
    A.usaf = usaf
AND A.wban = wban; 
```

当没有发生连接并且结果为 NULL 时，我希望查询用“NONE”来合并 null 结果，但是我仍然得到 NULL。我将如何使它返回“NONE”而不是 NULL？

我忽略了解释一个重要的点： `usaf`并且`wban`是`IN`a 的变量`stored procedure`。这是我的最终（工作）版本。谢谢罗兰多

```
BEGIN
SET @usaf = usaf;
SET @wban = wban;

SELECT
    COALESCE(CONCAT(Ar.usaf, '-', Ar.wban),"NONE") AS TABLE_NAME
FROM
    `metadata`.`ISH-HISTORY_HASPOS` A
 INNER JOIN `metadata`.`Artificial` Ar ON (Ar.id = A.mergeId AND    A.usaf = @usaf AND A.wban = @wban)
LIMIT 1;

END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:02:23.587

由于以下`where`子句，查询从不考虑 usaf 和 wban 的 NULL 值：

```
WHERE A.usaf = usaf AND A.wban = wban; 
```

当这些列为 NULL 时，该行将被过滤掉。这对于重言式也是如此`a.usaf = a.usaf`。当 a.usaf 为 NULL 时，该语句返回 FALSE（嗯，NULL）。

删除该`where`子句，查询可能会按您的预期工作。

作为第二条评论。. . 你想要一个`inner join`还是一个`left outer join`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:08:37.247

在 WHERE 子句中提供 Ar 别名

```
SELECT
    COALESCE(CONCAT(Ar.usaf, '-', Ar.wban),"NONE") AS TABLE_NAME
FROM
    `metadata`.`ISH-HISTORY_HASPOS` A
 INNER JOIN `metadata`.`Artificial` Ar ON (Ar.id = A.mergeId)
WHERE
    A.usaf = Ar.usaf
AND A.wban = Ar.wban; 
```

查看此查询，您可以通过三 (3) 种方式进一步改进 JOIN

首先，将 WHERE 子句元素添加到 JOIN 的 ON 部分

其次，使其成为 LEFT JOIN 以适应`NULL`情况

```
SELECT
    COALESCE(CONCAT(Ar.usaf, '-', Ar.wban),"NONE") AS TABLE_NAME
FROM
    `metadata`.`ISH-HISTORY_HASPOS` A
    LEFT JOIN `metadata`.`Artificial` Ar
    ON (Ar.id = A.mergeId) AND A.usaf = Ar.usaf AND A.wban = Ar.wban; 
```

三、添加这些索引

```
ALTER TABLE `metadata`.`ISH-HISTORY_HASPOS` ADD INDEX (mergeId,usaf,wban);
ALTER TABLE `metadata`.`Artificial` ADD INDEX (id,usaf,wban); 
```

试试看 ！！！

# java - 在 Java 中哪个更快，而使用递归方法？

> ID：13956158
> 
> 赞同：18
> 
> 时间：2012-12-19T15:55:01.740
> 
> 标签：java, loops, recursion, optimization, do-while

我有以下`class`两种方法的示例：

**进程.java：**

```
public class Process {

    public Process() {
    }

    public static void countRecursive(int num) {
        System.out.println("countRecursive: " + num++);
        if (num <= 10) countRecursive(num);
        else return;
    }

    public static void countWhile(int num) {
        do System.out.println("countWhile: " + num++);
        while (num <= 10);
    }

} 
```

***主类：***

```
public static void main(String[] args) {        

    Process.countRecursive(0);
    Process.countWhile(0);

} 
```

***输出：***

```
countRecursive: 0
countRecursive: 1
countRecursive: 2
countRecursive: 3
countRecursive: 4
countRecursive: 5
countRecursive: 6
countRecursive: 7
countRecursive: 8
countRecursive: 9
countRecursive: 10

countWhile: 0
countWhile: 1
countWhile: 2
countWhile: 3
countWhile: 4
countWhile: 5
countWhile: 6
countWhile: 7
countWhile: 8
countWhile: 9
countWhile: 10 
```

但我想知道推荐使用哪种“技术”以及为什么。

提前致谢。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-19T15:56:12.367

由于方法调用开销和调用堆栈的使用，递归会变慢。

Java 也没有执行尾调用优化，所以不要指望它。*（虽然 JVM 上有一些语言确实有尾调用优化，包括 Clojure 和 Kotlin）*

另一个缺点可能是`StackOverflowError`如果您填满堆栈的风险。

如果您这样做只是为了尝试一下，我建议您使用可以在 java JDK 中找到的 VisualVM。它是一个分析器，可用于对这种情况进行基准测试（或者，如果您正在使用 OSS，您可以要求开源 YourKit 许可证）。

**请注意，** *我不建议仅仅为了花哨而使用递归。如果您真的需要它（例如遍历树），请使用它。*

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-19T17:08:16.990

您应该运行带有时间测量的代码。这里有 100 次递归/100 次 while 循环的输出：

```
Recursive time: 90941
While time: 5180 
```

这清楚地表明，while 循环比递归更快。

您可以通过运行以下代码来检查我的测量结果：

```
public class Process {

    public Process() {
    }

    public static void countRecursive(int num) {
        num++;
        if (num <= 100) countRecursive(num);
        else return;
    }

    public static void countWhile(int num) {
        do
            num++;
        while (num <= 100);
    }

    public static void main(String[] args) {
        Long start = System.nanoTime();        
        Process.countRecursive(0);
        System.out.println("Recursive time: " + (System.nanoTime() - start));
        Long startWhile = System.nanoTime();
        Process.countWhile(0);
        System.out.println("While time: " + (System.nanoTime() - startWhile));

    }

} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2012-12-19T15:57:51.990

我不建议使用递归，因为每个递归都存储在堆栈中。因此，您需要为每个递归调用存储方法参数、局部变量等，以维护该调用之前的方法状态。

此外，您显然不应该对此类问题进行递归。它应该留给一些特定的任务，只有当你真的无法避免使用它们时。

此外，您还可以对代码进行基准测试，以查看哪个运行得更快。你会有一个想法。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-12-19T15:57:42.553

递归调用将堆栈帧添加到调用堆栈。循环没有。循环通常比递归快，除非递归是诸如分治之类的算法的一部分（您的示例不是）。

您应该能够对每个方法的执行进行计时，并找出一个比另一个快多少。

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-12-19T15:58:22.477

一般来说，我更喜欢迭代（例如，while 或 for 循环）而不是递归，因为：

*   迭代更简单
*   如果递归太深，可能会得到 stackoverflow 异常。迭代不会发生这种情况。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2012-12-19T15:59:27.363

通常，如果可能，递归会针对循环进行优化，这意味着由于各种原因，包括堆栈帧分配和堆栈帧溢出，如果两个解决方案在其他方面相等，则迭代优于递归。请参阅[尾递归](https://en.wikipedia.org/wiki/Tail_call)
因此忽略 Java 没有优化尾递归的事实，循环应该更快。

也看看[这个](https://stackoverflow.com/questions/11853459/java-recursion-and-performance)

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2012-12-19T15:57:08.090

在 java 中，与 while 循环相比，递归的开销很小，因为它需要分配一个新的堆栈帧。在替代方案是显式管理堆栈的情况下，递归可能会更快

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2012-12-19T23:44:05.733

其他人说的都是真的。我想再补充一件事：对于您发布的问题，从 1 数到 10，使用递归或迭代都可以，因为它们运行的​​时间都可以忽略不计。一般来说，在现代计算机系统上，您无需过多担心完成一个进程需要多长时间（除非您正在处理大型数据集），因为内存非常便宜，而 CPU 非常强大。

通常，您首先使用良好的编程实践编写您感觉最舒服的程序。如果在那之后运行时间太长，那么你优化它。

并不是说在这个级别上比较迭代和递归是一件坏事。同样，迭代通常比递归更可取。我的观点是要吸取的教训是，虽然有一些方法可以让你的代码快速运行，但当你处理小型数据集时，你通常不需要担心它们 :)

# android - 无法在 ListView 单元格内的 EditText 中输入值？

> ID：13956159
> 
> 赞同：0
> 
> 时间：2012-12-19T15:55:01.307
> 
> 标签：android, android-layout

我在 ICS 4.1+ 上，并且在构成表格单元格的 LinearLayout 内有下面的布局。但是当我选择 EditText id 获得焦点但不允许任何输入时。

```
 <RelativeLayout android:id="@+id/options_bar" android:layout_width="fill_parent" android:layout_height="110dip" >  <!-- android:layout_marginBottom="-150dip"  --> 
<EditText  android:layout_marginLeft="15dip" android:layout_centerVertical="true" android:id="@+id/msg" android:editable="true" android:background="#D8D8D8" android:textColor="#000000" android:text="Reply to the tweet" android:layout_height="90dip" android:layout_width="170dip"
    android:layout_alignParentLeft="true" android:layout_marginRight="30dip"/>
<Button android:layout_width="wrap_content" android:layout_height="wrap_content"
    android:layout_alignParentRight="true" android:layout_centerVertical="true" android:layout_toLeftOf="@id/msg"
    android:text="Confirm" android:id="@+id/confirm_btn"/>
<Button android:id="@+id/cancel_btn" android:layout_width="wrap_content" android:layout_height="wrap_content"
    android:layout_centerVertical="true"
    android:text="Cancel" android:layout_toLeftOf="@id/confirm_btn"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:09:05.007

你在 EditText 上调用 requestFocus() 了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:41:10.197

您在问题标题中说 ListView，但在问题正文中谈论表格...假设您的意思是 ListView，您需要做的就是更改 ListView 焦点模式

```
lv = (ListView) v.findViewById(android.R.id.list);
lv.setItemsCanFocus(true); 
```

# c# - 使用 DotNetZip 和 MemoryStream 时用 '\0' 填充解压缩数据

> ID：13956170
> 
> 赞同：8
> 
> 时间：2012-12-19T15:55:33.633
> 
> 标签：c#, stream, zip, dotnetzip

我正在尝试压缩和解压缩内存中的数据（因此，我不能使用 FileSystem），并且在下面的示例中，当数据被解压缩时，它在原始数据的末尾有一种填充（'\0' 字符） .

我究竟做错了什么 ？

```
 [Test]
    public void Zip_and_Unzip_from_memory_buffer() {
        byte[] originalData = Encoding.UTF8.GetBytes("My string");

        byte[] zipped;
        using (MemoryStream stream = new MemoryStream()) {
            using (ZipFile zip = new ZipFile()) {
                //zip.CompressionMethod = CompressionMethod.BZip2;
                //zip.CompressionLevel = Ionic.Zlib.CompressionLevel.BestSpeed;
                zip.AddEntry("data", originalData);
                zip.Save(stream);
                zipped = stream.GetBuffer();
            }
        }

        Assert.AreEqual(256, zipped.Length); // Just to show that the zip has 256 bytes which match with the length unzipped below

        byte[] unzippedData;
        using (MemoryStream mem = new MemoryStream(zipped)) {
            using (ZipFile unzip = ZipFile.Read(mem)) {
                //ZipEntry zipEntry = unzip.Entries.FirstOrDefault();
                ZipEntry zipEntry = unzip["data"];
                using (MemoryStream readStream = new MemoryStream()) {
                    zipEntry.Extract(readStream);
                    unzippedData = readStream.GetBuffer();
                }
            }
        }

        Assert.AreEqual(256, unzippedData.Length); // WHY my data has trailing '\0' chars like a padding to 256 module ?
        Assert.AreEqual(originalData.Length, unzippedData.Length); // FAIL ! The unzipped data has 256 bytes
        //Assert.AreEqual(originalData, unzippedData); // FAIL at index 9
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T15:59:59.853

来自**[MSDN](http://msdn.microsoft.com/en-us/library/system.io.memorystream.getbuffer.aspx)**

> "请注意，缓冲区包含可能未使用的已分配字节。例如，如果将字符串 "test" 写入 MemoryStream 对象，则从 GetBuffer 返回的缓冲区长度为 256，而不是 4，其中 252 个字节未使用。要获得只有缓冲区中的数据，使用 ToArray 方法；

所以你实际上想改变这一行： `zipped = stream.GetBuffer();`

到线：`zipped = stream.ToArray();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:00:27.450

我怀疑它来自“MemoryStream.GetBuffer()”

[http://msdn.microsoft.com/en-us/library/system.io.memorystream.getbuffer.aspx](http://msdn.microsoft.com/en-us/library/system.io.memorystream.getbuffer.aspx)

请注意，缓冲区包含可能未使用的已分配字节。例如，如果将字符串“test”写入 MemoryStream 对象，则从 GetBuffer 返回的缓冲区长度为 256，而不是 4，其中 252 个字节未使用。要仅获取缓冲区中的数据，请使用 ToArray 方法；但是，ToArray 会在内存中创建数据的副本。

# sql - 选择联合 SQL

> ID：13956171
> 
> 赞同：1
> 
> 时间：2012-12-19T15:55:34.380
> 
> 标签：sql, select, union

我正在使用以下查询：

```
select 8 Union Select 0 Union Select 15 
```

在列中填充这 3 个数字。我得到的结果是：

```
0  
8  
15 
```

但我希望先出现 8，然后是 0，然后是 15，例如

```
8  
0  
15 
```

我该怎么做呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T15:59:02.207

使用 UNION ALL 例如

```
select 8 UNION ALL Select 0 UNION ALL Select 15 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T17:05:54.377

@SimonMartin 的答案适用于您提供的确切数据集，但请注意，如果您的数据集包含重复值，`UNION ALL`则会产生与`UNION`.

`UNION`操作员删除重复项，而将`UNION ALL`保留它们（以及它们的顺序，如@SimonMartin 的回答中所述）。

如果您想将`UNION`运算符的功能与 提供的排序功能相结合`UNION ALL`，那么您需要先`UNION ALL`自己过滤掉重复值：

```
-- baseline query + 1 duplicate record at the end
with query as 
(
    select 8 as Val
        UNION ALL 
    Select 0 as Val
        UNION ALL 
    Select 15 as Val
        UNION ALL 
    Select 0 as Val
)
-- now add row numbers
, queryWithRowNumbers as 
(
    select row_number() over (order by (select 0)) as rn, Val
    from query
)
-- finally, get rid of the duplicates
select Val from (
    select Val, min(rn) as minRn
    from querywithrownumbers
    group by val
) q
order by minRn 
```

这将给出结果

```
8
0
15 
```

而如果你只使用`UNION ALL`你最终会得到

```
8
0
15
0 
```

# c# - IIS url重写default.aspx等文件

> ID：13956175
> 
> 赞同：1
> 
> 时间：2012-12-19T15:55:44.530
> 
> 标签：c#, asp.net, iis, url-rewriting, webforms

我刚刚在我的 IIS 服务器上安装了 IIS Url Rewrite 2.0，我在正确执行一些重写时遇到了一些麻烦。这是我的麻烦：

我希望我的所有文件都被重写为：welcome.aspx > welcome/、about.aspx > about/ 等，以实现我正在这样做：

```
<rule name="Remove extension with slash" stopProcessing="true">
    <match url="(.*)/" />
    <conditions>
        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
    </conditions>
    <action type="Rewrite" url="{R:1}.aspx" appendQueryString="true" />
</rule> 
```

到目前为止，这是可行的..但是当我运行这样的 URL 时，我还想在 default.aspx 上执行一些查询字符串函数： mysite.com/logout/ 这实际上是 mysite.com/default.aspx?action=由于此规则而注销：

```
<rule name="Friendly URL" stopProcessing="true">
    <match url="(.*)/" />
    <conditions>
        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
    </conditions>
    <action type="Rewrite" url="default.aspx?action={R:1}" appendQueryString="true" />
</rule> 
```

但它不会执行第二条规则，因为它将查找不存在的 logout.aspx 文件，仅以我的 default.aspx 中的查询字符串函数的形式

有什么办法可以同时实现吗？

::::::::::: 编辑 :::::::::::::

我一直在尝试一整天..我非常接近以下设置：

```
<rule name="Remove ext" stopProcessing="true">
    <match url="^([^/]+)/?$" />
    <conditions>
        <add input="{REQUEST_FILENAME}.aspx" matchType="IsFile" negate="false" />
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
    </conditions>
    <action type="Rewrite" url="{R:1}.aspx" appendQueryString="true" />
</rule>

<rule name="Default actions" stopProcessing="true">
    <match url="^([^/]+)/?$" />
    <conditions>
        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
    </conditions>
    <action type="Rewrite" url="default.aspx?action={R:1}" appendQueryString="true" />
</rule>

<rule name="Other files with querystrings" stopProcessing="true">
    <match url="^([^/]+)/([^/]+)/?$" />
    <conditions>
        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
    </conditions>
    <action type="Rewrite" url="{R:1}.aspx?action={R:2}" appendQueryString="true" />
</rule> 
```

几乎一切正常

用户.aspx > 用户

default.aspx?action=logout > 注销

user.aspx?action=comments > 用户/评论

唯一搞砸的是，如果我在用户 ie 之后添加一个斜杠。它将响应 default.aspx 规则并充当查询字符串.. 这不是有意的.. 有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:57:48.637

你怎么能期望任何系统能够区分应该是页面名称的东西和作为参数的东西？

MVC 站点在这里要做的——并且你的 URL 系统与那个非常相似——是清楚地定义什么是什么。在您的情况下，您应该使用第一部分（欢迎，关于）作为视图 - 页面 - 部分并添加另一个代表该方法的级别。简而言之，使用 /default/logout 并将其重写为类似

```
{R:1}.aspx?action={R:2} 
```

如果您真的想像您说的那样查看您的 URL（/logout 没有 /default 部分），您可以添加一个单独重写它们的规则（与 OR | 匹配）或添加一个重定向到 Default.aspx 的 Logout.aspx ?action=logout - 但这会很难看。去寻找干净的解决方案。

# c++ - 内存转储未以 C++ 释放模式编写

> ID：13956176
> 
> 赞同：3
> 
> 时间：2012-12-19T15:55:45.003
> 
> 标签：c++, exception-handling, crash-dumps

我一直在使用[http://www.codeproject.com/Articles/1934/Post-Mortem-Debugging-Your-Application-with-Minidu](http://www.codeproject.com/Articles/1934/Post-Mortem-Debugging-Your-Application-with-Minidu)从我的应用程序中获取一个转储文件，该文件总是在另一个系统上崩溃。

所以我所拥有的是头文件和 CPP 并处于调试模式，但没有附加调试器，它询问我是否要创建 dmp 文件，然后崩溃，但在发布模式下，它只是崩溃。

基本上我一直在使用的代码是

```
void IndexFault(int n)
{
    unsigned char* smallArray = new unsigned char[4];
    printf((const char*)smallArray[n]);
}

MiniDumper* mDump = new MiniDumper("Dumpfile");

int main()
{
    IndexFault(4);
    return 0;
} 
```

同样，如果执行从调试模式创建的 exe，我得到的文件就好了，而发布我什么也得不到。在这两种情况下都是 64 位代码。一旦它起作用，我将把它应用到我的真实代码中，但到目前为止，我无法弄清楚发生了什么。我使用的 Minidumpwriter 来自上述网站。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T04:23:36.167

我相信你错过了这一步：

> 要调用 API，您需要通过使用 API 设置未处理的异常处理程序来捕获崩溃`SetUnhandledExceptionFilter`。这允许在应用程序中几乎任何时候发生未处理的异常时调用过滤器函数。在某些未处理的异常中，例如双堆栈错误，操作系统将**立即终止应用程序，而无需调用过滤器或 JIT 调试器**。

无论如何，我个人更喜欢在这种情况下使用 WinDbg。只需将其附加到远程进程并获取该转储即可。

# git - 将远程更改合并到不是当前分支的分支

> ID：13956179
> 
> 赞同：34
> 
> 时间：2012-12-19T15:55:51.087
> 
> 标签：git, merge

我有多个分支，我想将远程更改合并到一个**不是我当前分支的分支**中。

例如：

```
git merge remote/branch some-other-branch 
```

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2016-10-19T08:22:12.813

这只有在本地分支可以快速转发到远程头时才可行。在任何分支中，要从源获取远程分支并更新本地头，请使用：

```
git fetch origin remote_branch:local_branch 
```

从本质上讲，这与您在原点打开新分支的方式相反`git push -u origin local_branch:remote_branch`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-03-13T18:42:26.900

有[一个类似问题](https://stackoverflow.com/questions/3672073/git-merge-to-another-branch)[的答案](https://stackoverflow.com/a/20788245/1173869)可能会做你想做的事。

从您的回购根目录：

```
git push . remote/branch:some-other-branch 
```

当我想在我从我所在的分支（不是 master）重新定位到它之前将 master 快进到稍后的提交时，这对我有用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-07T05:40:49.623

我会说这是不可能的，设计使然。来自男人

```
描述
       合并来自命名提交的更改（因为他们的
       历史从当前分支分支）进入当前分支。

```

# multithreading - Apache mina 连接阻止 Tomcat 关闭

> ID：13956181
> 
> 赞同：2
> 
> 时间：2012-12-19T15:56:07.407
> 
> 标签：multithreading, tomcat7, mina

我有以下配置：

运行 Spring MVC 应用程序的 tomcat7 服务器，它使用 Apache mina 连接到 Java-Console 应用程序（或任何其他类型的应用程序）以检索一些数据。

现在很明显，当我关闭服务器时，在单独的线程中仍然有一个打开的会话，防止 Tomcat7 关闭。所以我要做的是：

```
package at.dauzinger.tcpservice;

import javax.servlet.ServletContextEvent;
import org.springframework.web.context.WebApplicationContext;
import org.springframework.web.context.support.*;

public class ServerContextListener implements javax.servlet.ServletContextListener
{
    PriceDao priceDao;

    public void contextDestroyed(ServletContextEvent event)
    {   
        WebApplicationContext context = WebApplicationContextUtils.getWebApplicationContext(event.getServletContext());
        priceDao = (PriceDao)context.getBean("priceDao");
        priceDao.closeConnection();
    }

    public void contextInitialized(ServletContextEvent arg0) {
        //Method Stub
    }
} 
```

在 web.xml 里面

```
<!-- Creates the Spring Container shared by all Servlets and Filters -->
<listener>
   <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>
<listener>
   <listener-class>at.dauzinger.tcpservice.ServerContextListener</listener-class>
</listener> 
```

ContextListener 工作，甚至我的控制台应用程序（我的套接字连接的服务器端）告诉我会话已终止。但是当我试图通过 eclipse GUI 停止 tomcat 时，它无法关闭，eclipse 告诉我它没有反应，并让我强制终止服务器。

服务器的最后一个登录表单是：

> Dez 19, 2012 4:39:17 PM org.apache.coyote.AbstractProtocolHandler 停止信息：停止 ProtocolHandler [“ajp-bio-8009”]

我在 tomcat-servlet 中运行的代码：

```
connector = new NioSocketConnector();
connector.getSessionConfig().setUseReadOperation(true);
connector.getFilterChain().addLast("codec", new ProtocolCodecFilter(new TextLineCodecFactory(Charset.forName("UTF-8"))));
session = connector.connect( new InetSocketAddress(PORT)).awaitUninterruptibly().getSession();

session.write(request);
String resp = (String) session.read().awaitUninterruptibly().getMessage(); 
```

打开连接时是否有任何其他线程 mina 启动？是什么阻止了 tomcat 实例正确关闭？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-28T13:32:14.617

我有同样的问题，我终于解决了，只需要在你想关闭tomcat时调用unbind和dispose。

```
@PreDestroy
public void close() {
    System.out.println("MINAServer.close");
    if (null != socketAcceptor) {
        socketAcceptor.unbind();
        socketAcceptor.dispose(false);
    }
} 
```

# matlab - matlab分割中的“忽略背景”

> ID：13956184
> 
> 赞同：0
> 
> 时间：2012-12-19T15:56:22.737
> 
> 标签：matlab, image-processing, image-segmentation

我有一张用 X 射线拍摄的图像，我想测试不同的分割算法（如[http://www.academia.edu/913222/segmentation_techniques](http://www.academia.edu/913222/segmentation_techniques)中的那些）

如何忽略计算中的背景，即如何忽略灰度值低于 50,000 的任何内容（对于 16 位图像）？

我现在使用的代码是：

```
clc;
clear;
[fn,pn]=uigetfile({'*.TIF','Image files'}, 'Select an image');
x = imread(fullfile(pn,fn));
T=graythresh(x);
y=im2bw(x,T);
imshow(y); 
```

但我也想测试不同的分割技术。

我正在尝试对软件的未来实现进行建模，以找到最佳的行动方案，并且该软件将忽略“背景”（我已经成功实现了 otsu 算法。

谢谢你的智慧=）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T17:21:02.403

如果你只想在 50000 以上的像素值上使用 Otsu，你可以简单地写

```
T = graythresh(x(x>50000)); 
```

# delphi - 可能的交叉点功能错误

> ID：13956188
> 
> 赞同：0
> 
> 时间：2012-12-19T15:56:34.303
> 
> 标签：delphi, delphi-xe3, teechart

我正在为 XE3 评估 TChartProVCL。

我创建了 2 个手册系列：

1) Series1，阶梯线 2) Series2，在不同点与 Series1 相交的简单线

然后我创建了一个计算系列，X Cross Points，它应该是 Series1 和 Series2 的交叉点。

它看起来很好，除了 x=6 和 x=5.6（大约） **这对我来说似乎是一个错误。**

![图片](../Images/bfc8fa7ba7548d31be39efda22a07863.png)

仅供参考，我的最终目标是为系列中的区域着色。TRegionBandTool 会接近，但我需要用不同的颜色为 Series1 上方和下方的区域着色。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T16:45:04.640

恐怕 TCrossPointsFunction 不支持使用楼梯模式设置的源。我已将其添加到希望在未来版本中实施的愿望清单中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T15:55:41.483

在将“阶梯”系列与 TCrossPointsFunction 一起使用的情况下，我发现了一个简单的“作弊”，足以满足我的目的。我只是：

1.  关闭 stair-step 属性。
2.  通过在 X 轴上非常靠近地放置两个点来创建阶梯效果。

例如：

```
const
    UPPER = 85;
    LOWER = 75;
begin
    SysThresh.Clear;
    for i := 0 to 8 do
        SysThresh.AddXY(i, UPPER);
    SysThresh.AddXY(8.001, LOWER);
    SysThresh.AddXY(12.999, LOWER);
    for i := 13 to 25 do
        SysThresh.AddXY(i, UPPER); 
```

这给了我阶梯效果，而不会混淆 TCrossPointsFunction。

# java - 声明一个无用的局部变量

> ID：13956191
> 
> 赞同：15
> 
> 时间：2012-12-19T15:56:41.257
> 
> 标签：java, if-statement, scope, declaration, local-variables

所以这是一个奇怪的，我知道代码本身是相当无用的，但我想知道为什么我得到错误：

我正在写一些代码，我写了这个：

```
if(scan.hasNextInt())
    int row = scan.nextInt(); 
```

当时没有考虑变量范围，显然这是没用的，因为无论如何我都不能使用`row`过去。`if`我不明白为什么我得到了我所做的错误：

```
> javac hw.java
hw.java:25: '.class' expected
    int row = scan.nextInt();
        ^
hw.java:25: not a statement
    int row = scan.nextInt();
    ^    
hw.java:25: illegal start of expression
    int row = scan.nextInt();
            ^
hw.java:25: ';' expected
    int row = scan.nextInt();
                  ^ 
```

现在，如果我只是将其修改为：

```
if(scan.hasNextInt()) {
    int row = scan.nextInt();
} 
```

它会编译得很好。我的印象是，如果`if`大括号下有 1 行是可选的......显然还有其他考虑因素，或者两者都会编译或失败。

有人可以向我解释一下，或者将我指向一个解释为什么我不能在`if`没有大括号的条件下声明局部变量的文档吗？

* * *

**编辑：**这是完整的功能：

```
public static char getinput() {
    System.out.println("Where do you want to go? (row column)");
    Scanner scan = new Scanner(System.in);
    if(scan.hasNextInt())
        int row = scan.nextInt();
    String input = scan.next();
    System.out.println(input);
    return 'a';    
} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-12-19T16:02:13.707

如果您有`if`, `for`, `while`，`do/while`则必须在其后加上一个语句。声明不是陈述。

来自[JLS 14.9 - if 语句](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.9)

```
IfThenStatement:
    if ( Expression ) Statement

IfThenElseStatement:
    if ( Expression ) StatementNoShortIf else Statement

IfThenElseStatementNoShortIf:
    if ( Expression ) StatementNoShortIf else StatementNoShortIf 
```

我假设他们这样做是因为您声明的任何变量都无法使用，因为它会立即超出范围（相同的声明除外）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:59:33.370

我的猜测是声明不是可执行语句，并且带有赋值的声明实际上被编译器分解为两个不同的语句，第一个语句（声明）不是可执行的。if 需要一个可执行的结构，一个块或一个可执行的语句。

我知道我无法在 Eclipse 调试器中的非分配声明语句上放置断点。可能是相同的根本原因。

# model - Zend Framework 2 - 自动创建 Doctrine 实体 Getter 和 Setter

> ID：13956192
> 
> 赞同：1
> 
> 时间：2012-12-19T15:56:43.507
> 
> 标签：model, doctrine-orm, zend-framework2

有没有办法自动创建[似乎有必要](http://samminds.com/2012/07/a-blog-application-part-1-working-with-doctrine-2-in-zend-framework-2/)的 getter 和 setter ？

会节省大量时间......到目前为止在互联网上找不到任何东西......

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T08:32:51.153

我检查了它，`PHPStorm5`您可以在编辑实体时执行以下操作：

> 右键单击>生成>获取器和设置器>*选择所有变量*>确定

你完成了:)

# java - 从 tomcat 迁移到 JBoss AS7。mvn jboss-as:deploy 不适用于我的 Maven 项目

> ID：13956193
> 
> 赞同：1
> 
> 时间：2012-12-19T15:56:56.953
> 
> 标签：java, spring, maven, jboss

我们正在从 tomcat 迁移到 JBoss AS7，我一直在阅读文档，它告诉我做一个

**mvn jboss-as:deploy**在项目上，但我得到：

```
[ERROR] No plugin found for prefix 'jboss-as' in the current project and in the plugin groups [org.apache.maven.plugins, org.codehaus.mojo] available from the repositories [local (/home/jsmith/.m2/repository), central (http://repo.maven.apache.org/maven2)] -> [Help 1] 
```

有人可以告诉我我的设置中缺少什么..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:33:16.193

我失踪了

```
<plugin>
            <groupId>org.jboss.as.plugins</groupId>
            <artifactId>jboss-as-maven-plugin</artifactId>
            <version>7.2.Final</version>
        </plugin>
    </plugins> 
```

从我的 pom.xml 文件

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:34:12.393

你可以做两件事。

在你的定义以下`settings.xml`

```
<pluginGroups>
        <pluginGroup>org.jboss.as.plugins</pluginGroup>
</pluginGroups> 
```

您可以运行以下命令：

> mvn org.jboss.as.plugins:jboss-as-maven-plugin:7.3.Final:deploy

# python - 在 qt 上显示小部件后 subprocess.call 停止（如果 shell=True）

> ID：13956196
> 
> 赞同：0
> 
> 时间：2012-12-19T15:56:59.700
> 
> 标签：python, qt, qt4, pyqt, subprocess

下面的代码在我的计算机上停止（实际上，最初当我调用 platform.uname() 代替子进程调用时，这失败了，我将其缩小到它的 popen 调用）。

有谁知道为什么会这样？（如果我使用 shell=False，它确实有效，但我很想知道这里有什么区别）

qt3 中 subprocess.call 中的代码停止：

```
import qt
import subprocess

app = qt.QApplication([])
q = qt.QWidget()
q.show()
subprocess.call(['doskey'], shell=True) 
```

代码在 qt4 中的 subprocess.call 中停止：

```
import subprocess
import PyQt4.QtGui

app = PyQt4.QtGui.QApplication([])
q = PyQt4.QtGui.QWidget()
q.show()
subprocess.call(['doskey'], shell=True) 
```

# odbc - 如何获取给定 ODBC 驱动程序的 ODBC 驱动程序 DLL 文件的名称

> ID：13956198
> 
> 赞同：1
> 
> 时间：2012-12-19T15:57:02.113
> 
> 标签：odbc

如何以编程方式获取给定 ODBC 驱动程序的 ODBC 驱动程序 DLL 文件的名称。例如，给定“SQL Server Native Client 10.0”，我想查找该驱动程序的 DLL 文件的名称：sqlncli10.dll。我可以在注册表中 HKEY_LOCAL_MACHINE\SOFTWARE\ODBC\ODBCINST.INI 下的“驱动程序”条目中的 REGEDIT 中看到这一点。如果我尝试在我的代码中从注册表中读取值，它会返回一个空字符串。我还尝试使用 ODBC API 函数 SQLDrivers。下面的代码成功返回了 Attribs 变量中除“Driver”之外的所有属性值。一切都在那里——APILevel、ConnectFunctions、CPTimeout 等——但“驱动程序”不在列表中。

```
repeat
  Status := SQLDrivers (HENV, SQL_FETCH_NEXT, PAnsiChar(DriverName), 255,
            NameLen, PAnsiChar(Attribs), 1024, AttrLen);
  if Status = 0 then begin
    List.Add(DriverName);
    List.Add(Attribs);
  end;
until Status <> 0; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T12:35:22.427

你可以`SQLGetInfo()`使用 `InfoType=SQL_DRIVER_NAME`

我希望这看起来像：

```
Status := SQLGetInfo(ConnEnv, SQL_DRIVER_NAME, PAnsiChar(DriverName), 255, NameLen); 
```

但此功能适用于已连接的数据库。

我试过`SQLDrives()`了，你是对的：在我的环境中，这个函数也不返回 DLL 名称。所以我试图从注册表中读取它，它是这样工作的：

```
 DLLName := RegGetStringDirect(HKEY_LOCAL_MACHINE, 'SOFTWARE\ODBC\ODBCINST.INI\'  + DriverName, 'Driver'); 
```

对于司机：`IBM INFORMIX ODBC DRIVER`我得到：`C:\informix\bin\iclit09b.dll`

对于司机：`SQL Server`我得到：`C:\WINDOWS\system32\SQLSRV32.dll`

`RegGetStringDirect()`是我基于 Windows API 从注册表中读取内容的函数。

编辑：

Ron Schuster 读取“SQL Server”ODBC 驱动程序 dll 名称的两个函数从评论中移出：

```
procedure TForm1.Button1Click(Sender: TObject); 
//using Windows API calls 
var 
  KeyName, ValueName, Value: string; 
  Key: HKEY; 
  ValueSize: Integer; 
begin
  ValueName := 'Driver';
  KeyName := 'SOFTWARE\ODBC\ODBCINST.INI\SQL Native Client';
  if RegOpenKeyEx(HKEY_LOCAL_MACHINE, PChar(KeyName), 0, KEY_READ, Key) = 0 then
    if RegQueryValueEx(Key, PChar(ValueName), nil, nil, nil, @ValueSize) = 0 then begin
      SetLength(Value, ValueSize);
      RegQueryValueEx(Key, PChar(ValueName), nil, nil, PByte(Value), @ValueSize);
      ShowMessage(Value);
    end;
end; 

procedure TForm1.Button2Click(Sender: TObject);
//using TRegistry class 
var
  KeyName, ValueName, Value: string;
  Reg: TRegistry;
begin
  ValueName := 'Driver';
  KeyName := 'SOFTWARE\ODBC\ODBCINST.INI\SQL Native Client';
  Reg := TRegistry.Create;
  try
    Reg.RootKey := HKEY_LOCAL_MACHINE;
    if Reg.OpenKeyReadOnly(KeyName) then begin
      Value := Reg.ReadString(ValueName);
      ShowMessage(Value);
    end;
  finally
    Reg.Free;
  end;
end; 
```

# webrtc - WebRTC - JSEP：无法在两个不同的网络之间连接对等点

> ID：13956200
> 
> 赞同：2
> 
> 时间：2012-12-19T15:57:04.143
> 
> 标签：webrtc

我不知道有没有人发过这个，但我不想问。我的问题是这样的：

*   我可以使用 apprtc.appspot.com 的两个 Chrome 选项卡（这意味着我称自己）进行视频聊天。一切运作良好。
*   如果这些笔记本电脑在同一个网络上，我也可以将 apprtc 与两台不同的笔记本电脑一起使用。我在代理后面使用了我大学的网络。
*   但是，如果我在调制解调器上的一台笔记本电脑和 LAN 上的另一台笔记本电脑上使用它，apprtc 就不起作用。

谁能解释发生了什么？这是 STUN/ICE 问题吗？还是JSEP？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-09T15:41:25.377

公开演示包括 STUN 服务器，但不提供 TURN 服务器，因为运行免费 TURN 服务器的带宽很昂贵。STUN 得到了很多思考，但不是所有的 NAT / 防火墙，但远没有 TURN 那么多。您可能处于 TURN 可以工作（但您没有 TURN 服务器）但 STUN 没有的情况。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T18:47:29.363

我已经能够从两个不同的 NAT 后面使用[http://apprtc.appspot.com/上的演示。](http://apprtc.appspot.com/)所以它至少在理论上可以工作；但众所周知，STUN、TURN 和 ICE 并非万无一失。对于初学者，如果有人阻止了对端口 19302（apprtc 演示使用的 STUN 服务器的端口）的访问，则防火墙穿越将永远无法启动。

基本的故障排除步骤是打开 Chrome 开发人员工具 (ctrl-shift-i) 并查看控制台中是否有任何错误。如果没有发现任何有趣的东西，您需要编写自己的演示应用程序版本，这一次有更好的错误处理。例如，apprtc 演示假设某些事情不能被认为是理所当然的，例如，`peerConnection.setLocalDescripton()`并且`peerConnection.setRemoteDescription()`会成功。在生产代码中，您确实需要在这些代码上实现成功和失败回调 - 这将为您提供有关可能出现问题的更好信息。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-31T03:13:01.567

AppRTC 默认使用 stun。TURN 是“更好的”（根据我的理解），但我记得 Justin Uberti 说公共 TURN 服务器可能会被滥用（或类似的东西）。

STUN 在企业级子网上经常失败，因为它无法“应对”不友好的 NAT 寻址。

# delphi - 在 Delphi 应用程序中查看 SolidWorks 工程图

> ID：13956203
> 
> 赞同：3
> 
> 时间：2012-12-19T15:57:11.740
> 
> 标签：delphi, solidworks

有没有办法（ole 或 component）在 Delphi 10/XE/XE2/XE3 中查看 SolidWorks 10/11 图纸？应用？

我的意思是阅读 .SLDPRT 文件、项目数据部分、使用的材料等...重要部分已标记...但可能已经存在执行此操作的组件...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-25T20:14:17.197

如果您想阅读有关文件的信息而不查看文件数据本身，则可以使用文档管理器 API。

[SOLIDWORKS 文档管理器 API](http://help.solidworks.com/2016/English/api/swdocmgrapi/Welcome-swdocmgrapi.html?id=2515e0f58389406bb1a99bdd86551bc0#Pg0)

# css - 在 Twitter Bootstrap 中创建稳定的响应式布局

> ID：13956204
> 
> 赞同：1
> 
> 时间：2012-12-19T15:57:15.830
> 
> 标签：css, mobile, twitter-bootstrap, media-queries

我正在使用 Twitter Bootstrap 构建响应式布局，我发现很难让布局在所有尺寸/设备上都保持良好状态。

在我早期的尝试中，我尝试简单地使用网格进行放置，但页面元素从未以不同的大小出现在我想要的位置。现在我正在使用媒体查询来覆盖一些 Bootstrap 的样式和我自己的样式。这似乎可能会导致维护方面的麻烦。

我认为我应该通过[注册媒体查询事件来](http://tylergaw.com/articles/reacting-to-media-queries-in-javascript)根据屏幕大小添加/删除样式，而不是覆盖样式。

有人可以提供有关使用 Bootstrap 在不同屏幕尺寸下调整页面布局的良好做法的建议吗？

我正在寻找一般建议，但如果有帮助，我可以发布代码和屏幕截图。

**更新**：看起来媒体查询事件[没有得到很好的支持](https://developer.mozilla.org/en-US/docs/DOM/window.matchMedia)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:36:48.963

你在正确的轨道上。使用 CSS 媒体查询。Firefox 有一个很好的附加功能，可以让您将页面调整到特定的视口，以便您可以逐像素查看更改，尽管我确信 chrome 会有类似的东西

没有什么特别的技巧，只是因为它的引导程序，只要你启用了响应式样式表，那么你就很好了

这是开始媒体查询的好地方

```
http://css-tricks.com/snippets/css/media-queries-for-standard-devices/ 
```

# git - 如何在 Git 中进行较旧的提交 HEAD？

> ID：13956207
> 
> 赞同：78
> 
> 时间：2012-12-19T15:57:18.930
> 
> 标签：git

我仍在尝试学习 Git 的（基本？）更好的点，并设法让自己陷入困境。我意识到我在 HEAD 上犯了一些错误，检查了一个较旧的提交并从那里开始编码。当我尝试推送时，我被告知我当前的提交已落后，我需要与 HEAD 合并。Git 推荐“git pull”。但是， HEAD 有我想忽略的代码。我该如何解决这个问题？非常感谢帮忙。

流程图：

```
-------- HEAD (bad) ---------------------- + (behind conflict, requires
     \                                    /   merge with HEAD, which is
      \------- Current commit (good) ----/    bad and needs to be ignored) 
```

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2014-11-30T05:30:18.233

这是您可以执行的操作：

```
git checkout <branch-to-modify-head>
git reset --hard <commit-hash-id-to-put-as-head>
git push -f 
```

如果你不强制推送，git 会抛出这个错误：Updates were denied because the tip of your current branch is behind。

请注意，这会篡改您的 git 历史记录，因此另一种方法是还原您不想要的每个提交。这样你就可以保留你的历史：

```
git revert commit-id 
```

干杯

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-12-19T16:01:19.333

如果您的存储库没有被其他人使用，您可以安全地`git push -f`覆盖远程分支。

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2016-01-20T12:55:25.673

我这样做的方式是：

```
git reset --hard <commit-SHA>
git push origin HEAD:<name-of-remote-branch> 
```

这是 git 推荐的方式`git push -f`，对于开发团队中的其他人来说，这样做可能会有点问题

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2019-01-13T23:17:52.257

唯一对我有用的东西：

```
git checkout <OLD_COMMIT>
git branch temp
git checkout temp
git branch -f master temp
git checkout master
git branch -d temp 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2012-12-20T01:39:00.270

ANeves 是对的，“git push -f” 之所以有效，是因为您是唯一使用存储库的人。对于大多数人来说，这不是一个可接受的解决方案。

这是您当前的提交历史记录：

```
---A-B < HEAD (bad)
    \
     C < my_branch (good) 
```

这有您想要的解决方案： [我如何“覆盖”而不是“合并”Git 中另一个分支上的一个分支？](https://stackoverflow.com/questions/4624357/git-how-to-overwrite-rather-than-merge-a-branch-on-another-branch)

回顾一下，

```
git checkout my_branch
git merge -s ours HEAD 
```

这将消除 HEAD 分支上的所有更改，并为您提供以下信息：

```
--A-B-D < HEAD, my_branch (both good)
   \ /
    C 
```

在这种情况下，D 实际上与 C 相同，只是具有不同的父级。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-02-07T11:42:40.477

对于我们这些在受保护分支上工作的人来说， push -f 不是一个选项。

反而：

```
Checkout HEAD
diff {hash of desired commit to use as new HEAD} > myChange.patch
git apply 
commit 
push 
```

如果您有更改想要合并到新版本的 HEAD 中，例如 OP，我会先备份它们，更正远程存储库，然后应用更改。

这也保留了您的回购历史。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-06-15T08:58:41.760

我参加聚会有点晚了-我必须这样做：

```
git push -f origin HEAD:<name-of-branch> 
```

请在执行此命令之前先[阅读文档。](https://git-scm.com/docs/git-push#Documentation/git-push.txt---force)

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-11-07T21:20:29.997

对我来说完美的步骤如下 -

1) git log --oneline

2) 获取您想要回滚的提交（很可能是您在 HEAD 的最后一次提交之前的提交并推送）

3) git checkout (这是你希望你的工作回滚到的提交 id)

4) git push -f origin HEAD:master (-f 将强制推送覆盖如果推送分支位于远程之后会发生的任何拒绝) HEAD:master(这是为了确保您将回滚推送到主分支并在远程仓库的负责人）

5）就是这样：）

# c# - “public override bool equals(object obj)”和“public override int gethashcode()”方法是什么？

> ID：13956208
> 
> 赞同：-5
> 
> 时间：2012-12-19T15:57:18.697
> 
> 标签：c#, methods, operator-overloading, overriding, gethashcode

我开始学习运算符重载，在示例代码中我发现这两种方法是 (`public override bool equals(object obj)`和`public override int gethashcode()`)。我不明白它们为什么在那里，因为当我调试这个程序时，我没有看到编译器进入它们。我不知道他们在做什么，也不知道我在做什么。

有人可以帮我解释一下吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:06:42.737

.NET 中的大多数类型都派生自 type ，在 C# 中`System.Object`简单地调用。`object`（例如，接口没有，但是它们的实现可以。）

`System.Object`声明方法`Equals`以及`GetHashCode`其他成员。（注意：大小写在 C# 中很重要）。您创建的类型会自动继承这些方法。

的任务`Equals`是将一个对象与另一个对象进行比较。引用类型的默认实现是比较引用。如果要更改此行为，则必须重写此方法。

`GetHashCode`计算对象的哈希码并用于哈希表。例如类型`Dictionary<TKey,TValue>`和`HashSet<T>`使用它。请参阅[哈希表和字典集合类型](http://msdn.microsoft.com/en-us/library/4yh14awz.aspx)。如果你覆盖`Equals`，你必须覆盖`GetHashCode`以及为了保持一致性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:14:42.963

最好先参考文档。

[Object.Equals](http://msdn.microsoft.com/en-us/library/bsc2ak47.aspx) -> 确定指定对象是否等于当前对象。

> 当前实例与 obj 参数比较的类型取决于当前实例是引用类型还是值类型。如果当前实例是引用类型，则 Equals(Object) 方法测试引用相等性，并且对 Equals(Object) 方法的调用等效于对 ReferenceEquals 方法的调用。引用相等意味着被比较的对象变量引用同一个对象。

[Object.GetHashCode](http://msdn.microsoft.com/en-us/library/system.object.gethashcode.aspx) -> 用作特定类型的哈希函数。

> 哈希码是一个数值，用于在相等性测试期间识别对象。它还可以用作集合中对象的索引。GetHashCode 方法适用于散列算法和数据结构，如散列表。

为什么它们[会覆盖](http://msdn.microsoft.com/en-us/library/ebca9ah3.aspx)> c# 中的所有类型都派生自[System.Object](http://msdn.microsoft.com/en-us/library/system.object.aspx)。它们是覆盖以提供派生类的能力，以便在需要时提供这些功能的替代/合适的实现。否则默认实现（在[System.Object](http://msdn.microsoft.com/en-us/library/system.object.aspx)中应该就足够了）。

# php - 实施 .htaccess 后，我的网站加载了两次，为什么？

> ID：13956210
> 
> 赞同：1
> 
> 时间：2012-12-19T15:57:19.853
> 
> 标签：php, apache, .htaccess

在实施 .htaccess 文件以使我的网站的单个页面可以通过简单的*/folder/*链接访问后，某些（如果不是全部）页面加载两次。

当我每次访问该页面时，计算我网站上某个内容的点击次数的计数器增加两次时，我注意到了这一点。

这仅在我创建 .htaccess 文件后发生。

这是一个常见问题还是我是唯一一个遇到这个问题的人？为了防止这种情况，应该做些什么？

除了一些重写条件之外，我的 .htaccess 文件中没有任何内容......

```
AddDefaultCharset UTF-8

RewriteEngine on

#remove PHPSESSID 
RewriteCond %{QUERY_STRING} PHPSESSID=.*$ 
RewriteRule .* %{REQUEST_URI}? [R=301,L]

#content
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule /?(content)/([0-9]+)/(.+)$ index.php?nav=single&ID=$2 [QSA,L]

#comments
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule /?(comments)/([0-9]+)/([0-9]+)$ index.php?nav=comments&ID=$2&catID=$3 [QSA,L]

#normal pages
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule /?([A-Za-z0-9_-]+)$ index.php?nav=$1 [QSA,L]

# compress text, html, javascript, css, xml:
AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T18:25:12.690

计数器在重定向之前递增，可能有多种原因。一个原因是对外部资源使用绝对路径。它们也将被重写，并可能导致问题。

这是一个想法：

在模板的 <head> 标记之间添加：

```
<base href="/"> 
```

如果这不起作用，请尝试在清除输出缓冲区之前将计数器功能移动到最后几行。

# r - 包 nlme，使用 corClass ARIMA(p,d,q) 的广义最小二乘拟合

> ID：13956211
> 
> 赞同：2
> 
> 时间：2012-12-19T15:57:24.923
> 
> 标签：r, package, time-series, least-squares

在 R 中，包`nlme`可用于拟合广义最小二乘模型。我们可以拟合 ARMA 相关性，例如

```
fm1 <- gls(Y ~X1+X2+X3,correlation = corARMA(p=2,q=1)) 
```

是否可以将 a`gls`与 ARIMA (p,d,q) （即包括差异 (d) 参数）作为相关参数进行拟合？也许是这样的：

```
fm2 <- gls(Y ~X1+X2+X3,correlation = corARMA(p=2,d=1,q=1)) 
```

`corClasses`我认为此软件包中不支持 ARIMA 。

# scikit-learn - scikit的学习随机森林分类器中是否有计算精度的内置方法？

> ID：13956212
> 
> 赞同：1
> 
> 时间：2012-12-19T15:57:24.720
> 
> 标签：scikit-learn, random-forest

我正在使用 scikit 的学习运行一个随机森林分类器，并希望计算一个精度指标（有多少预测与目标值匹配）作为结果的一部分。是否有内置选项可以做到这一点？如果不是，那么实现它的最简单方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:15:26.283

是的，请参阅有关性能指标的参考文档：http: [//scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics](http://scikit-learn.org/stable/modules/classes.html#module-sklearn.metrics)

# java - 存在可能为空的 manyToOne 关系时出错 (org.hibernate.TransientObjectException)

> ID：13956213
> 
> 赞同：0
> 
> 时间：2012-12-19T15:57:25.313
> 
> 标签：java, spring, hibernate, jpa, persistence

当我尝试持久化对象 Municipio 时出现异常。Municipio 与 Provincia 有 manyTone 关系，而与 Sector 有另一种 manyToOne 关系。Provincia 不能为空，但 Sector 可以为空。我不知道如何允许该 Sector 可以为空，因为当我尝试保存对象 Municipio 时会引发异常。

```
java.lang.IllegalStateException: org.hibernate.TransientObjectException: object references an unsaved transient instance - save the transient instance before flushing: es.caib.biocides.persistence.Municipio.sector -> es.caib.biocides.persistence.Sector
at org.hibernate.ejb.AbstractEntityManagerImpl.throwPersistenceException(AbstractEntityManagerImpl.java:611)
at org.hibernate.ejb.AbstractEntityManagerImpl$1.beforeCompletion(AbstractEntityManagerImpl.java:513) 
```

市政厅

```
/**
* The persistent class for the BCD_MUNICIPIO database table.
* 
*/
@Entity
@Table(name="BCD_MUNICIPIO")
public class Municipio implements Serializable {

@Id
@SequenceGenerator(name="BCD_MUNICIPIO_MUNCODIGO_GENERATOR", sequenceName="BCD_MUN_SEQ")
@GeneratedValue(strategy=GenerationType.SEQUENCE, generator="BCD_MUNICIPIO_MUNCODIGO_GENERATOR")
@Column(name="MUN_CODIGO")
private Long munCodigo;

@Column(name="MUN_NOMBRE")
private String munNombre;

//bi-directional many-to-one association to Provincia
@ManyToOne(fetch=FetchType.LAZY)
@JoinColumn(name="MUN_CODPRV")
private Provincia provincia;

//bi-directional many-to-one association to Sector
@ManyToOne(fetch=FetchType.LAZY, optional=true)
@JoinColumn(name="MUN_CODSEC", nullable=true)
private Sector sector;

public Municipio() {
}

public Long getMunCodigo() {
    return this.munCodigo;
}

public void setMunCodigo(Long munCodigo) {
    this.munCodigo = munCodigo;
}

public String getMunNombre() {
    return this.munNombre;
}

public void setMunNombre(String munNombre) {
    this.munNombre = munNombre;
}

public Provincia getProvincia() {
    return this.provincia;
}

public void setProvincia(Provincia provincia) {
    this.provincia = provincia;
}

public Sector getSector() {
    return this.sector;
}

public void setSector(Sector sector) {
    this.sector = sector;
}

} 
```

部门

```
/**
* The persistent class for the BCD_SECTOR database table.
* 
*/
@Entity
@Table(name="BCD_SECTOR")
public class Sector implements Serializable {
private static final long serialVersionUID = 1L;

@Id
@SequenceGenerator(name="BCD_SECTOR_SECCODIGO_GENERATOR", sequenceName="BCD_SEC_SEQ")
@GeneratedValue(strategy=GenerationType.SEQUENCE, generator="BCD_SECTOR_SECCODIGO_GENERATOR")
@Column(name="SEC_CODIGO")
private Long secCodigo;

@Column(name="SEC_NOMBRE")
private String secNombre;

//bi-directional many-to-one association to Municipio
@OneToMany(mappedBy="sector")
private List<Municipio> municipios;

public Sector() {
}

public Long getSecCodigo() {
    return this.secCodigo;
}

public void setSecCodigo(Long secCodigo) {
    this.secCodigo = secCodigo;
}

public String getSecNombre() {
    return this.secNombre;
}

public void setSecNombre(String secNombre) {
    this.secNombre = secNombre;
}

public List<Municipio> getMunicipios() {
    return this.municipios;
}

public void setMunicipios(List<Municipio> municipios) {
    this.municipios = municipios;
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T05:34:56.210

每当您尝试保存对象而不保存适当的联接时，都会出现 TransientObjectException。您必须先保存**扇区**，然后才能保存**Municipio**类。

```
Municipio.setSector(new Sector()); 
```

通过使用它，您将特定**Sector**分配给**Municipio**。但**Sector**没有任何 ID。两者将如何映射？这就是异常到来的原因。

有关更多详细信息，请发布您的保存/更新代码。

希望它会帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:09:30.093

问题与空对象本身无关，而是与`OneToMany`声明相关的实际实体的结构有关。

如果我没记错的话，您正在尝试保存与 a`Municipio`相关联的 a`Sector`而没有先前保存`Sector`，不是吗？发生的情况是 Hibernate 需要在`Municipio`和它所拥有的之间进行关联映射`Sector`，但如果后者尚未持久化，则没有创建关联的引用。

尝试保存第`Sector`一个，然后保存`Municipio`（如果您愿意，可以使用级联）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T02:02:01.880

在 Municipio 中，尝试将扇区显式初始化为空。是的，正如 Sajan 要求的那样，显示您的保存/修改代码。

# c++ - 使用 cmd 在后台运行 .exe 文件

> ID：13956215
> 
> 赞同：-1
> 
> 时间：2012-12-19T15:57:33.253
> 
> 标签：c++, file, windows-services, cmd, fstream

我正在运行一个简单的 CPP 程序来从控制台读取字符并以它们由点分隔的方式存储在文件中......

```
 #include<stdio.h>
 #include<conio.h>
 #include<iostream.h>
 #include<fstream.h>

 void main()
 {
           char content[2] = {'a','.'};
           ofstream o("filename",ios::out|ios::app);
           while(1)
           {
                   if(content[0]=='q')
                   {
                         break;
                   }
                   content = getche();
                   out<<content;
           }
           out.close();  
  } 
```

现在我希望这个程序只能在任务管理器中作为后台进程查看，而不是让用户看到（使用 cmd 运行）......

我使用最低优先级的`start` **命令。**但是没有用。一些类似的问题对我没有用。因此，请提供一个 apt 命令，该程序将通过该命令作为后台进程运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:15:13.910

您的意思是您根本不希望程序生成控制台*吗*？如果是这样，你将不得不改变你的主要功能：

```
int main() 
```

至：

```
#include <Windows.h>
int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, 
    LPSTR lpCmdLine, int nShowCmd) 
```

使用这个新的 main 函数将防止在程序启动时生成任何控制台。

如果您想在程序开始时生成控制台，并在中途关闭它，您必须自己为控制台创建 GUI。我会推荐[FLTK](http://www.fltk.org/)作为 GUI 库。对于更高级的 GUI，它并不是那么好，但如果您只想拥有一个简单的控制台，它就可以了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:13:54.163

您可以尝试使用[nsExec](http://nsis.sourceforge.net/Docs/nsExec/nsExec.txt)插件运行您的 exe。此应用程序内的执行不应显示任何控制台窗口

另一种解决方案是将您的程序作为 Windows 服务而不是应用程序运行

# javascript - Javascript 文件名函数/.html 条

> ID：13956217
> 
> 赞同：1
> 
> 时间：2012-12-19T15:57:35.297
> 
> 标签：javascript, html

早上好，

我正在使用从另一个帖子中获得的功能：

[如何使用 JavaScript 从完整路径中获取文件名？](https://stackoverflow.com/questions/423376/how-to-get-file-name-from-full-path-using-javascript/423385#423385)

返回网页的当前文件名

```
var url=window.location.pathname;
var filename = url.replace(/^.*[\\\/]/, '');
alert(filename); 
```

我很好奇是否可以在仍然使用这种语法的同时从末尾剥离 .html。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:02:47.007

使用以下命令指定要管理的扩展程序，使其更具限制性：

```
.replace(/^.*[\/](.*)[.](html|jsp|php)/, '$1'); 
```

要么更通用，使用：

```
.replace(/^.*[\/](.*)[.][a-zA-Z0-9]{2,5}/, '$1'); 
```

第二个将允许从 2 个字符（例如`.do`）到 5 个字符（例如`.xhtml`）的扩展，其中也可以包含数字（例如`.php3`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T16:06:21.580

我认为最简单的方法是

```
var filename = url.replace(/^.*[\\\/]/, '').replace(".html", ""); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T16:05:58.607

您可以在替换中使用捕获子句：

```
var url=window.location.pathname;
alert(url)
var filename = url.replace(/^.*[\\\/](.*).html$/, '$1');
alert(filename); 
```

# android - Android：Facebook登录无法调用选择片段（Facebook api 3.0）

> ID：13956219
> 
> 赞同：1
> 
> 时间：2012-12-19T15:57:40.743
> 
> 标签：android, facebook

我按照 Facebook 的教程用 Facebook 创建了一个登录功能（ [输入链接](http://developers.facebook.com/docs/tutorials/androidsdk/3.0/scrumptious/authenticate/#step2)）。运行示例时，我遇到了问题：授权应用程序后，我看不到欢迎文本（选择片段），它只是返回登录页面（启动片段）。作为我的调试，Facebook 的 Session 似乎没有打开。请给我一些建议。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T13:20:51.610

我有一个类似的问题，这是因为我没有覆盖 onActivityResult 方法，在我实现一切正常之后。由于您的会话似乎未通过身份验证，您是否在清单中更新了您的 applicationId ？我不确定这是否真的很重要，但 Facebook 应用设置页面上还有一个部分需要您的活动名称，请确保与您当前的应用相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T13:18:17.710

确保您提供正确的密钥哈希。用这种方法拿钥匙：

```
static final String GetKey(Context context)
{
    String KeyHash = "";
    PackageInfo info;
    try {
        info = context.getPackageManager().getPackageInfo(context.getPackageName(),  PackageManager.GET_SIGNATURES);

        for (Signature signature : info.signatures)
        {
            MessageDigest md = MessageDigest.getInstance("SHA");
            md.update(signature.toByteArray());
            KeyHash = Base64.encodeToString(md.digest(), Base64.DEFAULT);
        }

    } catch (NameNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (NoSuchAlgorithmException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return KeyHash;
} 
```

# spring - Spring 3.2 和缓存抽象缺少 EhCache 实现

> ID：13956224
> 
> 赞同：24
> 
> 时间：2012-12-19T15:57:45.420
> 
> 标签：spring, ehcache

我正在将我们的代码迁移到**Spring 3.2**版本（从**3.1.3**开始）并且我遇到了 Spring Cache Abstraction 的问题。

我们使用 EhCache 的实现，`CacheManager`它的配置非常简单：

```
<cache:annotation-driven />

<bean id="cacheManager" class="org.springframework.cache.ehcache.EhCacheCacheManager" p:cache-manager-ref="ehcache" />
<bean id="ehcache" class="org.springframework.cache.ehcache.EhCacheManagerFactoryBean" p:config-location="classpath:ehcache.xml" /> 
```

我的问题是我`EhCacheCacheManager`在`spring-context jar`. 我想他们将实现移至其他模块，但我找不到确切的位置。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-12-19T16:19:05.357

根据[附录 C. Migrating to Spring Framework 3.2](http://static.springsource.org/spring-framework/docs/3.2.0.RELEASE/spring-framework-reference/html/migration-3.2.html)，

> “org.springframework.cache.ehcache 包中的 EHCache 支持类从 spring-context 模块移动到 spring-context-support”。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-07-20T08:26:36.783

更新 Maven pom.xml 文件对我有用。

特性：

```
 <org.springframework-version>3.2.3.RELEASE</org.springframework-version> 
```

依赖项

```
 <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-context-support</artifactId>
        <version>${org.springframework-version}</version>
    </dependency> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-12-19T16:20:52.303

使用[oss.sonatype.org](http://oss.sonatype.org)，您可以按名称搜索一个类，并在它们被索引时找到它包含在哪些工件中：[https](https://oss.sonatype.org/index.html#nexus-search;classname~EhCacheCacheManager) ://oss.sonatype.org/index.html#nexus-search;classname~EhCacheCacheManager 。

正如 SwapnilS 回答的那样，它在 spring-context-support 中。

# c++ - 模仿 MFC 中复选框的两态按钮

> ID：13956226
> 
> 赞同：1
> 
> 时间：2012-12-19T15:57:46.030
> 
> 标签：c++, mfc

我想在 MFC 工具栏上制作一个可以按下的按钮并保持其状态直到再次按下（如复选框），但我不想要一个复选框。理想情况下，我想要一个在两个图标之间切换的按钮，并使用 DDV 在按下时更改布尔值。我该怎么办。

作为一个附带问题，我真的可以用一本关于 MFC 的好书来做。我有 Programming Windows with MFC 2nd edition，但想知道是否有更详细的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:22:05.803

用于`ON_UPDATE_COMMAND_UI`设置按钮的状态。例如，典型的处理程序将如下所示：

```
BEGIN_MESSAGE_MAP(CMyView, CView)
    ON_UPDATE_COMMAND_UI(ID_MY_BUTTON, OnUpdateMyButton)
END_MESSAGE_MAP()

...

void CMyView::OnUpdateMyButton(CCmdUI* pCmdUI) 
{
    // TODO: Add your command update UI handler code here

    pCmdUI->SetCheck( isButtonPressed() );
} 
```

关于好的 MFC 文档，我推荐 Professional MFC (Mike Blaszczak) - 它有点旧但非常好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:20:44.283

从[CToolBar 类的文档中](http://msdn.microsoft.com/en-us/library/69wz6ea1%28v=vs.110%29.aspx)：

要创建复选框按钮，请为其指定样式 TBBS_CHECKBOX 或在 ON_UPDATE_COMMAND_UI 处理程序中使用 CCmdUI 对象的 SetCheck 成员函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-08T12:02:50.913

在对话框上绘制一个单选按钮。

选择单选按钮并转到按钮属性页面。

设置 Push Like 属性并设置为“True”

为同一控件添加事件处理程序并获取布尔变量。

使用 API -> "CheckDlgButton(IDC_RADIO1, 1);" 根据布尔变量值设置状态。

更多细节。访问以下链接。

[https://www.codeproject.com/Articles/530/A-Better-Bitmap-Button-Class](https://www.codeproject.com/Articles/530/A-Better-Bitmap-Button-Class)

# python - 访问列表中的文件

> ID：13956229
> 
> 赞同：0
> 
> 时间：2012-12-19T15:57:49.993
> 
> 标签：python, file-io, python-3.x

我的搜索和销毁型程序以徒劳无功而告终。我已成功编排列表，但程序在`PermissionError`. 我的代码如下：

```
import os
count=0
while(count<4):
    file_list=[]
    for root, dirs, files in os.walk(os.path.expandvars('%windir%')):
        for f_name in files:
            if f_name=='infected-file-1':
                file_list.append(root+"\\"+f_name)
                str1='\n'.join(file_list)
                for x in str1.split('\n'): pass
                os.remove(x)
                continue
            for root, dirs, files in os.walk(os.path.expandvars('%windir%')):
                for f_name in files:
                    if f_name=='infected-file-2':
                        file_list.append(root+"\\"+f_name)
                        str1='\n'.join(file_list)
                        for z in str1.split('\n'): pass
                        os.remove(z) 
```

该程序确实启动良好，但由于存在权限错误而无法删除该文件

所以我打算使用 os.system 来使用 takeown 来获得完全控制但是我如何在语法中使用它，即`os.system("takeown /f x")`where 'x'=python variable

您可能会建议我使用 print`file_list`来获取文件的地址，然后使用 takeown 但这不是我想要的。[我的程序不包括用户交互]

while 命令用于重复该过程以确保文件不再存在！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:13:43.400

您应该真正使用该[`subprocess`模块](http://docs.python.org/2/library/subprocess.html)而不是`os.system`：

```
import subprocess

subprocess.call(['takeown', '/f', x]) 
```

该[`.call()`函数](http://docs.python.org/2/library/subprocess.html#subprocess.call)的第一个参数是命令参数列表，包括命令本身。只需将变量`x`用作该列表的元素即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:13:41.030

我找到了解决方案：P 所需要的只是一些安心；）

我只是放置此代码`os.system("cmd /c takeown /f "+x)`以访问该文件，然后删除成功。

作为一个新手，这是一个成就

谢谢堆栈溢出

# javascript - GetJSON 用于跨域请求

> ID：13956231
> 
> 赞同：1
> 
> 时间：2012-12-19T15:57:54.113
> 
> 标签：javascript, json, jquery

我正在尝试从 opendata 服务收集一些数据。我坚持我的 jquery 请求，遵循使用闪烁 API 的[Jquery 文档中的示例，它可以工作。](http://api.jquery.com/jQuery.getJSON/)但是当我更改 URL 时，我没有播放回调操作（这里是一个警报弹出窗口）。我可以在 Chrome 控制台中看到播放请求并返回正确的结果，但在我的回调中没有执行任何操作。

这是我的测试：

```
 <html>
     <body>
     <h1>Hello, world!</h1>
     <script src="http://code.jquery.com/jquery-latest.js"></script>
     <span id="info"></span>
     <script>  
       $.getJSON("https://open.tan.fr/ewp/tempsattente.json/SECH?jsoncallback=?",
       {},
     function(data) {
              alert("foo");
     });
     </script>
     </body>
     </html> 
```

有人可以告诉我为什么它不起作用吗？有什么建议吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:12:03.710

如果您使用`.error`该`getJSON`方法，您可以找出它失败的原因（希望如此）。既然您说您似乎得到了正确的响应并且它“有效”，那么它是一个解析错误是有道理的（基本上`200`是在收到 a 后剩下的所有内容）。如果您使用`.error`，您会发现以下消息：

```
Error: jQuery18206930075496322584_1355933072137 was not called 
```

在不同的地方，发现是因为

```
parsererror 
```

^ [http://jsfiddle.net/dCTES/](http://jsfiddle.net/dCTES/)

如果您获取实际响应并运行它`JSON.parse`，它会说：

```
SyntaxError: JSON.parse: unexpected character 
```

它指向的价值：

```
"Fran\u00e7ois Mitterrand" 
```

^ [http://jsfiddle.net/dCTES/1/](http://jsfiddle.net/dCTES/1/)

# objective-c - 旋转 UIImage 固定角度转

> ID：13956237
> 
> 赞同：0
> 
> 时间：2012-12-19T15:58:24.203
> 
> 标签：objective-c, ios

我有一个 UIImage，我希望用户能够旋转它，就像它是保险箱的转动按钮一样。我不希望图像在 0 < x < 360 范围内以任何角度转动，但我希望轮子（UIImage）停在不同的固定点之一（通常从 0 到 20）。例如，如果我有 3 个选项，用户将能够转动滚轮并将指针放在三个点上（在这种情况下，角度为：60、120、180）。我使用此代码来旋转图像：

```
-(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event {
}

-(void) touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event {
    NSSet *allTouches = [event allTouches];

    int len = [allTouches count]-1;

    UITouch *touch =[[allTouches allObjects] objectAtIndex:len];
    CGPoint location = [touch locationInView:[self.SplashItGroupPicker superview]];
    float theAngle = atan2( location.y-self.SplashItGroupPicker.center.y, location.x-self.SplashItGroupPicker.center.x );

    int totalRadians = -3.14;

    totalRadians += fabs(theAngle - totalRadians);
    totalRadians = fmod(totalRadians, 2*M_PI);

    [self rotateImage:totalRadians];

}

- (void)touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event {
}

-(void) rotateImage:(float)angleRadians{
    self.SplashItGroupPicker.transform = CGAffineTransformMakeRotation(angleRadians);
    CATransform3D rotatedTransform = self.SplashItGroupPicker.layer.transform;
    self.SplashItGroupPicker.layer.transform = rotatedTransform;
} 
```

我怎样才能得到那个结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:14:20.037

找出每一步需要多少弧度，例如，如果你想要 4 个位置，那么每个位置将比上一个位置多 3.14 / 4 弧度。将此称为 radIncrement。

在这条线之后

```
totalRadians = fmod(totalRadians, 2*M_PI); 
```

将 totalRadians 除以 radIncrement，将结果四舍五入为整数值，然后再次乘以 radIncrement。您可以更改舍入行为以在更改位置时进行调整。

# objective-c - Encapsulate properties and methods in framework header files

> ID：13956243
> 
> 赞同：0
> 
> 时间：2012-12-19T15:58:33.657
> 
> 标签：objective-c, ios, frameworks, private, encapsulation

My goal is to build a framework, but hide some methods and properties from public headers

The point is that framework has everything built in, but different versions must have some properties and methods hidden

I am looking for some method either to delete some marked properties from built headers or to avoid them to be added during the build phase.

In my mind it should be something like this:

```
@interface MyClass

@property (strong, nonatomic) SomeClass1* instance1;

#AVAILABLE FROM 1.0.2
@property (strong, nonatomic) SomeClass2* instance2;

#AVAILABLE FROM 1.0.3
@property (strong, nonatomic) SomeClass3* instance3;

- (void) method1;

#AVAILABLE FROM 1.0.3
- (void) method2;

@end 
```

So if i set some predefined version value or project version value (doesn't really matter) to 1.0.2
then instance1, instance2 and method1 SHOULD BE in the framework headers, but
instance3 and method2 will be available only in version 1.0.3 or higher

Does anyone know how to do that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:10:18.763

您可以通过预编译步骤来做到这一点：

a) 在项目中为每个 buildTarget 创建一个 #def 值，如 version( `#define VERSION 1.0`)。每个 buildTarget 都应该有一个不同的版本，并且代表你的固件的不同版本。为此，请转到项目选项，构建目标选项-> 构建设置-> 预编译器宏

b) 创建一个预编译器函数，例如 GREATER THAN: `#define SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(v) v>= VERSION`（可以在 .pch 中定义）

c) 在标题处

```
 #if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(1.0.2))
  property (strong, nonatomic) SomeClass2* instance2;
  #endif 
```

ETC

你认为这能解决你的问题吗。

如果你这样做，预编译器将跳转他的版本下的代码

# c# - To check if var is String type

> ID：13956244
> 
> 赞同：25
> 
> 时间：2012-12-19T15:58:39.963
> 
> 标签：c#, asp.net, asp.net-mvc, c#-4.0

I have a problem in code in C#:

I don't know how to implement logic - iterating through Hashtable having values of different data types, the schema I want is below:

```
if the value in variable is String type
{
 do action1;
}
else 
{
  do action2;
} 
```

* * *

There is a hashtable containing data of Types - String and Int (combined):

```
public string SQLCondGenerator {

        get
        {

            Hashtable conditions = new Hashtable();

            //data having String data type
            conditions.Add("miap", ViewState["miap_txt"]);
            conditions.Add("pocode", ViewState["po_txt "]);
            conditions.Add("materialdescription", ViewState["mat_desc_txt"]);
            conditions.Add("suppliername", ViewState["supplier_txt"]);
            conditions.Add("manufacturername", ViewState["manufacturer_txt"]);

            //data having Int32 data type
            conditions.Add("spareparts", ViewState["sp_id"]); 
            conditions.Add("firstfills", ViewState["ff_id"]);
            conditions.Add("specialtools", ViewState["st_id"]);
            conditions.Add("ps_deleted", ViewState["ps_del_id"]);
            conditions.Add("po_manuallyinserted", ViewState["man_ins_id"]);

            String SQLCondString = "";
            String SQLCondStringConverted = "";

            string s = string.Empty;
            foreach (string name in conditions.Keys) 
            {
                if (conditions[name] != null)
                {
                    SQLCondString += name+ "=" +conditions[name]+ " and ";
                    Response.Write(conditions[name].GetType());

                    bool valtype = conditions[name].GetType().IsValueType;
                    if (valtype == string)
                    {
                      SQLCondString.Substring(0, SQLCondString.Length - 4);
                      SQLCondString += name + " and like '%" + conditions[name] + "%' and ";
                    }
                }
            }

        //Response.Write("********************");
         SQLCondStringConverted = SQLCondString.Substring(0, SQLCondString.Length - 4);
         return SQLCondStringConverted;
        }   
    } 
```

May be I am wrong in coding, please advise!

Thanks!

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-12-19T16:01:56.747

```
if(conditions[name] is string)
{
}
else
{
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-19T16:02:10.857

Hmm, I'm not sure why you are calling `IsValueType`, but this should be sufficient:

```
if (conditions[name] is string) 
{
    ///  
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T16:28:18.273

## 方法 - 1

```
Int32 Val = 0;
if (Int32.TryParse("Your Value", out Val))
{
    //Your Logic for int
}
else
{
    //Your Logic for String
} 
```

## 方法 - 2（使用后期绑定）

```
Int32 Val = 0;
dynamic conditions = new Hashtable();
conditions.Add("miap", ViewState["miap_txt"]);
conditions.Add("pocode", ViewState["po_txt "]);
foreach (string name in conditions.Keys)
{
    if (Int32.TryParse(conditions[name].ToString(), out Val))
    {
        //Your Logic for int
    }
    else
    {
        //Your Logic for String
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-23T18:23:16.667

我遇到了同样的问题，但我使用的是文本框，需要验证输入是字母、- 还是 .

我在我的文本框上生成了一个按键事件，并插入了以下方法来检查每个按键并在它不是有效字符时给出提示：

```
public static class Validator
{
public static bool IsNameString(TextBox tb, string name, KeyPressEventArgs e)
    {
        bool valid = true;

        /*  e.KeyChar contains the character that was pressed
         e.Handled is a boolean that indicates that handling is done            
        if a bad character is entered, set e.Handled to true
        */
        if (!char.IsLetter(e.KeyChar) && e.KeyChar != ' ' && e.KeyChar != '-' &&
          e.KeyChar != '.' && e.KeyChar != (char)Keys.Back)
        {
            e.Handled = true;
            valid = false;
            MessageBox.Show(name+ " can only accept letters, space, - and .");
            tb.Focus();

        }
        return valid;
    }
} 
```

* * *

用法：

```
 private void txtCustomerName_KeyPress(object sender, KeyPressEventArgs e)
    {            
       Validator.IsNameString(txtCustomerName, "Customer Name", e);

    } 
```

# android - Android - save multiple record affecting multiple tables

> ID：13956246
> 
> 赞同：0
> 
> 时间：2012-12-19T15:58:42.687
> 
> 标签：android, sqlite

I have a project have to save some register into to database SQLite, but at the same time insert into another table.

Example:

```
tables : contact_enc contact_det
contact_enc columns: id, name, telefono
contact_det columns: id, id_ce, name, address, status 
```

I need to insert into `contact_enc` the field and same times `contact_det` the field.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:05:06.280

只需使用两次插入操作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:17:35.817

```
String sql = "INSERT INTO contact_enc yourdatabase"; 
long lastID = this.database.execSQL(sql); 

int lastInsertId = Integer.ValueOf(lastId);

if(lastInsertId > 0) {
    String sql2 = "INSERT INTO contact_det (id_ce) VALUES(lastInsertId)"; 
    this.database.execSQL(sql2);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T17:33:06.287

如果 的`id`列`contact_enc`定义为`INTEGER PRIMARY KEY`，您可以使用[last_insert_rowid()](http://www.sqlite.org/lang_corefunc.html#last_insert_rowid)函数，就像下面的 SQL 语句一样，一个接一个地执行：

```
BEGIN TRANSACTION;
INSERT INTO contact_enc (name, telefono) VALUES (:Name, :Telefono);
INSERT INTO contact_det (id_ce, name, address, status) SELECT last_insert_rowid(), :Name, :Address, :Status;
COMMIT; 
```

（注意 , `:Name`, `:Telefono`, `:Name`,`:Address`和`:Status`是按名称绑定的参数。如果您希望按数字绑定参数，这在 Android 中似乎更容易做到，只需将每个占位符替换为 ? 问号）。

# c++ - 通过 C API 实例化 Lua 对象

> ID：13956247
> 
> 赞同：3
> 
> 时间：2012-12-19T15:58:46.360
> 
> 标签：c++, lua

我正在尝试通过 C API 在 Lua 中执行一些 OO 功能。在我的 Lua 脚本中，我有以下内容：

```
Parser = {}
Parser.__index = Parser

function Parser:create(url)
    local self = {}
    print ("creating")
    self.baseUrl = url
    setmetatable(self, Parser)
    return self
end

function Parser:Foo()
    print ("baseUrl: " .. self.baseUrl)
end

p = Parser:create("http://www.google.com")
p:Foo() 
```

如果我从命令行运行它，它工作正常，我看到以下输出：

```
creating
baseUrl: http://www.google.com 
```

现在，如果我注释掉最后两行并通过 C API 尝试以下操作

```
// <load the state and lua file>
lua_getglobal(L, "Parser");
lua_getfield(L, -1, "create");
lua_pushstring(L, "http://www.google.com");

if (lua_pcall(L, 1, 1, 0) != 0)
{
  // handle error
} 
```

这行得通。我按预期在标准输出中看到“创建”。据我了解，新的*Parser*对象现在位于堆栈顶部。如果我他们立即尝试以下操作：

```
lua_getfield(L, -1, "Foo");
if (lua_pcall(L, 0, 0, 0) != 0)
{
  logger()->error("-- %1", lua_tostring(L, -1));
} 
```

我收到以下错误：***尝试索引本地“自我”（零值）***

谁能告诉我我做错了什么以及如何让函数按预期运行？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:08:11.500

定义`function Parser:Foo() ... end`等价于：

```
Parser.Foo = function(self)
    print ("baseUrl: " .. self.baseUrl)
end 
```

那就是 --`Foo`是一个接受一个参数的函数。当你打电话时，`lua_pcall(L, 0, 0, 0)`你正在传递`0`参数。将其更改为`lua_pcall(L, 1, 0, 0)`，一切都应该工作。（您还必须将 pcall 更改`create`为正确传递`2`参数，而不是`1`）。

# ios - iOS: Changing TabBarItem of not selected tab

> ID：13956251
> 
> 赞同：1
> 
> 时间：2012-12-19T15:58:51.730
> 
> 标签：ios, ios5

I have a TabBar Controller with two ViewControllers (A and B) and would like to change the font size of the two Tab Bar Items. When the first tab A ViewController is loaded, I can change the tab item font size using [self tabBarItem] setTitleTextAttribute.

However, how would I reference the tab bar item of the ViewController B from A so I can change the font as well?

Thanks in advance!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:03:42.220

您通过 self.tabbarController.viewControllers 引用了其他 viewController

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:05:10.477

您可以为 UITabBar 添加一个单例：[共享实例](http://www.johnwordsworth.com/2010/04/iphone-code-snippet-the-singleton-pattern/)并获取单个引用，或者您可以创建一个具有两个 UIViewController 及其随附的 UITabBar 的类，并将它们作为类变量调用。我不太喜欢单例，但它归结为您的应用程序的偏好和数据模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:10:22.233

就像@andershqst 所说的那样`self.tabbarController.viewControllers`。我为我的标签维护一个枚举。

```
typedef enum SICOTabIndexes {
    kSICOTabIndexHome,
    kSICOTabIndexSaved,
    kSICOTabIndexCamera,
    kSICOTabIndexList,
    kSICOTabIndexSettings
} SICOTabIndexes; 
```

然后我可以`controller.tabBarController.viewControllers[kSICOTabIndexHome]`用来获取特定的视图控制器。

```
UIViewController *homeController = controller.tabBarController.viewControllers[kSICOTabIndexHome] 
```

此时，使用`homeController.tabBarItem`进行您需要的更改。

# c# - 访问被拒绝冒充当前用户访问网络文件夹

> ID：13956256
> 
> 赞同：10
> 
> 时间：2012-12-19T15:59:03.900
> 
> 标签：c#, asp.net, .net, impersonation, delegation

试图列出特定文件夹中的目录和文件。此文件夹将取决于通过 Windows 身份验证 (NTLM) 登录并从 Active Directory（`homedirectory`属性）中检索的当前用户 (Page.User)。

我正在使用域用户访问 AD 并检索文件夹位置，这工作正常。

`System.IO.DirectoryInfo.GetDirectories()`失败的是即使使用模拟检索子文件夹。

这是我用于模拟的代码：

```
System.Security.Principal.WindowsImpersonationContext impersonationContext;
impersonationContext =  ((System.Security.Principal.WindowsIdentity)User.Identity).Impersonate(); 
```

我已检查被模拟的用户是否有权访问该文件夹。

从到目前为止我发现的情况来看，我似乎需要设置委托或 Kerberos 身份验证，这是真的吗？这些是实现这一目标的唯一方法吗？模仿还不够吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:34:13.583

模拟允许网站服务帐户模拟（假装是）*该计算机上的*另一个用户。因此，查询 AD 以查看您（或被冒充的用户）拥有的权限是允许的。

请求访问另一台机器上的 UNC 共享是要求另一台机器接受网站服务帐户代表被模拟的用户行事。这是委托。另一台机器不检查用户凭据本身，而是将检查委托给网络服务器。

如果客户端从另一台机器连接网站（通常是网络服务器的情况），那么你有一个从客户端到网络服务器到 UNC 文件服务器的“双跳”。

我建议您需要配置 Kerberos（通过 SetSPN 实用程序）并查看为网站服务帐户（AD 用户和计算机）启用委派权限。如果您在设置时遇到问题，我衷心推荐一个名为[DeleConfig](http://www.iis.net/downloads/community/2009/06/delegconfig-v2-beta-%28delegation-kerberos-configuration-tool%29)的工具。

# java - 拦截日志消息 slf4j

> ID：13956262
> 
> 赞同：14
> 
> 时间：2012-12-19T15:59:29.807
> 
> 标签：java, logging, slf4j

我有一个使用 slf4j 作为日志外观的应用程序。现在我想在传输被分发到底层日志系统之前拦截所有的错误消息。可以为 slf4j 做到这一点吗？我查看了文档，发现我们可以更改实现中的 Appenders（如 log4j）来实现这一点，但我们可以在外观级别本身做到这一点吗？拦截做一些基本的事情，比如为错误消息的数量增加一个全局计数器等。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T16:56:01.393

在 SLF4J API 中没有这样做的。

[但是，如果您的记录器是Logback](http://logback.qos.ch/manual/filters.html)，您可以使用像`TurboFilter`.

如果你不使用 Logback，你可能需要像 AspectJ 拦截器这样的东西。

# php - 将返回的字符串传递给另一个字符串并在 if 语句中使用它

> ID：13956267
> 
> 赞同：2
> 
> 时间：2012-12-19T15:59:42.393
> 
> 标签：php, sql, function, return

我有这段代码：

```
<?php
            require_once 'Membership.php';
    $membership = New Membership();
    $AccountType = $membership->is_Account($currUser);
    if ($AccountType == 'S') {
        echo '<li>';
        echo $AccountType;
        echo '</li>';
    }
   ?> 
```

它使用执行此操作的函数调用不同的文档 members.php：

```
function is_Account($currUser){
    //Find out if user is a buyer or a seller
    $mysql = New Mysql();
    $mysql->get_Account($currUser); 
} 
```

出于组织原因 - 转到执行此操作的文档（此位有效，因为其他功能成功运行）：

```
function get_Account($currUser) {
    $mysqli = new mysqli(DB_SERVER, DB_USER, DB_PASSWORD, DB_NAME);
    if (!$mysqli) {
        die('There was a problem connecting to the database.');
    }       
    $queryAcct = "SELECT Id
            FROM Users
            WHERE Username = '$currUser'
            LIMIT 1";
    if ($Result = $mysqli->query($queryAcct)){
        if (!$Result) {
            echo 'Could not run query: ' . mysql_error();
            exit;
        }
        else {
            $row = $Result->fetch_assoc();
            return $row["Id"];
        }
    }
    $mysqli->close();
} 
```

所以 - 最后一个功能有问题。我想使用返回的 ID，例如，如果它是 1，我会显示与 ID 1 相关的内容（多人将拥有该 ID 号，因为它是一个层级系统）。

基本上 - 我不知道为什么它没有将 Id 返回到原始代码位。我假设我做错了什么。我只是不知道如何解决它。

回显 $row["Id"] 会起作用，所以我知道那一点很好，它不是 sql 问题。但这不是我想做的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T16:01:25.123

`get_Account()`您需要从函数中返回值`is_Account()`：

```
return $mysql->get_Account($currUser); 
```

# youtube-api - youtube browser based uploader yt:authentication Unknown

> ID：13956271
> 
> 赞同：0
> 
> 时间：2012-12-19T16:00:01.410
> 
> 标签：youtube-api, uploading

I had used my php AP for uploading youtube videos for 2 days, All worked just fine. But yesterday and today, I get this error when trying to upload videos to my youtube account. yt:authentication Unknown

I am using OAuth2, all clientid , key, secret are correct

Any help ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T02:15:51.887

每当遇到 OAuth 2 异常时，我建议的第一步是使您现有的来自[https://accounts.google.com/IssuedAuthSubTokens](https://accounts.google.com/IssuedAuthSubTokens)的授权无效，然后从头开始再次通过 OAuth 2 审批流程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T12:06:49.263

我一直在为 Google API 使用 PHP 客户端库并且遇到了同样的问题。在 v3 文档中，我找不到与基于浏览器的 YouTube 上传相关的任何内容，因此我最终将 v3 API 用于某些事情（视频和播放列表检索、身份验证等），但我仍在使用[v2基于](https://developers.google.com/youtube/2.0/developers_guide_protocol_browser_based_uploading)浏览器的上传方法。所有这一切都工作正常，然后突然停止工作。Jeff 撤销令牌的建议确实有效，但问题会稍后再出现。

我要做的是检查用户的令牌是否已过期。请注意，YouTube 令牌目前似乎在 60 分钟后过期。如果令牌已过期，您需要确保用户再次通过身份验证过程。一个简单的例子：

```
// $client is your previously authenticated instance of Google_Client
if ($client->isAccessTokenExpired())
{
    // Redirect to your page which outputs $client->createAuthUrl() for them to authenticate again
} 
```

可能值得注意的是 $client->getAccessToken() 即使在令牌过期的情况下仍会在条件条件下评估为 true。

# actionscript-3 - AS3 Find Root SDCard Path And Search In Directories

> ID：13956276
> 
> 赞同：0
> 
> 时间：2012-12-19T16:00:23.877
> 
> 标签：actionscript-3

I have a problem. I'm creating an appplication for android with AS3 and the problem i´ve got it's that when I install the application in my android the directory I should create is doesn't appear and the file neither.

```
var dirPath:File = File.applicationStorageDirectory.resolvePath("MUSIC/");                     
var newFile:File = File.applicationStorageDirectory.resolvePath("songslist.xml");  
if (!dirPath.exists)
    {
        dirPath.createDirectory();
        stream.open(newFile, FileMode.WRITE);
        stream.close();
        trace("entra if");
    }
if (!newFile.exists)
    {
        stream.open(newFile, FileMode.WRITE);
        stream.close();
    } 
```

Could be the problem that I should write and isntall the app in sdcard ? and how can obtain later the root sdcard for searching all the existing *.mp3 files in the directories to add in my songslist.xml

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T15:56:09.333

**至少我已经解决了。如果有人有兴趣或有同样的问题。**

```
var newFile:File = File.desktopDirectory.resolvePath("MusicPlayer/songslist.xml");
if (!newFile.exists)
{
   stream.open(newFile, FileMode.WRITE);
   stream.close();
}
else
{
    newFile.deleteFile();
    stream.open(newFile, FileMode.WRITE);
    stream.close();
} 
```

# actionscript-3 - 根据子剪辑中的值对一组 MovieClips 进行排序

> ID：13956277
> 
> 赞同：5
> 
> 时间：2012-12-19T16:00:25.343
> 
> 标签：actionscript-3, flash

我有一个名为 Table 的类，它链接到舞台上的剪辑。在设置过程中，我创建了许多 Table 实例，并为每个实例传递一个 TableData 类的实例。此 TableData 对象包含一个 ID 值。

我将我的 Table 对象的选择放入`Array`我希望根据每个 Table 的 TableData 实例中的 ID 值进行排序的对象中。

我希望使用的是：`myArray.sortOn("tableData.id");`

这似乎不起作用，我认为`Array.sortOn()`不能深入到子剪辑中。有没有办法可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T19:36:09.700

The`Array`和 generic`Vector.<>`集合都提供了另​​一种形式的`.sort()`方法，它接受一个函数。您可以提供自己的排序实现，在这种情况下，它会查看对象并仅比较它们的特定部分。

考虑以下类：

```
class TableData {
    public var ID:String;

    public function TableData(id:String):void {
        this.ID = id;
    }

} 
```

这是您的`TableData`类的简化版本，仅提供`ID`. 然后是一个简化的`Table`类：

```
class Table {

    private var _data:TableData;

    public function get data():TableData {
        return _data;
    }

    public function Table(tableData:TableData) {
        _data = tableData;
    }

} 
```

最后，让我们使用它们，并启动一个新的集合。

```
var list:Vector.<Table> = new Vector.<Table>();

list.push(new Table(new TableData("X")));
list.push(new Table(new TableData("C")));
list.push(new Table(new TableData("S")));
list.push(new Table(new TableData("A"))); 
```

现在，我们需要创建一个新函数来实际进行比较：

```
private function sortUsingDataID(a:Table, b:Table):int {
    var aID:String = a.data.ID;
    var bID:String = b.data.ID;
    return aID < bID ? aID == bID ? 0 : -1 : 1;
} 
```

此函数将期望获得两个项目，并且应该返回`-1`、`0`或`1`。如果`a`应该在之前，`b`那么函数应该返回`-1`。否则，如果`a`应该在之后`b`，那么它应该返回`1`。最后，如果两者相同，则返回值应为`0`。

`.sort`所以，现在我们只需要通过调用并传入我们的函数来告诉数组使用我们的自定义排序函数来使用自己。

```
list.sort(sortUsingDataID); 
```

现在`list`应该按照您想要的方式进行排序。

在此处查看一个[工作示例](http://wonderfl.net/c/g7ir)。

有关更多详细信息，请参阅[文档](http://help.adobe.com/en_US/ActionScript/3.0_ProgrammingAS3/WS5b3ccc516d4fbf351e63e3d118a9b90204-7fa4.html)

# perl - Apache下的Perl缓存 - 长负载期间的互斥锁

> ID：13956279
> 
> 赞同：0
> 
> 时间：2012-12-19T16:00:27.857
> 
> 标签：perl, apache, caching

我有一个大文件需要加载到缓存中（作为哈希），它将在 perl 进程之间共享。将数据加载到缓存中大约需要 2 秒，但我们每秒有超过 10 次调用。

使用计算方法是否会导致其他进程被锁定？否则，我将不胜感激有关如何管理加载过程的建议，以便在加载期间保证锁定并且只发生一个加载过程！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T19:28:44.027

不确定有保证的锁，但您可以使用带有已知键的 memcached 作为互斥锁替代品（在撰写本文时，您还没有说出您的“缓存”是什么）。如果键的值为 false，则将其设置为 true，开始加载，然后返回结果。

对于在此期间发生的请求，您可以等待，或者尝试在 Retry-After 字段中使用[503“服务不可用”](https://www.rfc-editor.org/rfc/rfc2616#page-70)状态并等待几秒钟。我不确定浏览器对此的支持。

作为奖励，在互斥锁上使用 5 分钟的生存时间将导致整个文件每 5 分钟重新加载一次。否则，如果您出于其他原因重新加载文件，则需要手动删除该密钥。

# python - AttributeError：“模块”对象没有属性“日期字段”

> ID：13956280
> 
> 赞同：3
> 
> 时间：2012-12-19T16:00:29.337
> 
> 标签：python, django

在文件 models.py

```
from django.db import models

# Create your models here.

class Publisher(models.Model):
    name = models.CharField(max_length=30)
    address = models.CharField(max_length=50)
    city = models.CharField(max_length=60)
    state_province = models.CharField(max_length=30)
    country = models.CharField(max_length=50)
    website = models.URLField()

class Author(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=40)
    email = models.EmailField()

class Books(models.Model):
    title = models.CharField(max_length=100)
    authors = models.ManyToManyField(Author)
    publishers = models.ForeignKey(Publisher)
    publication_date = models.Datefield() 
```

当我运行命令时

```
$ python manage.py validate 
```

我收到错误消息

```
AttributeError: 'module' object has no attribute 'Datefield' 
```

请帮忙。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T16:02:23.597

应该是[`models.DateField`](https://docs.djangoproject.com/en/dev/ref/models/fields/#datefield)带大写的`F`。

所以你的`Books`模型应该是这样的：

```
class Books(models.Model):
    title = models.CharField(max_length=100)
    authors = models.ManyToManyField(Author)
    publishers = models.ForeignKey(Publisher)
    publication_date = models.DateField()  # <--- Typo was here 
```

# php - 从结构化的文件和文件夹数组创建 ZIP/RAR/GZ 存档

> ID：13956281
> 
> 赞同：3
> 
> 时间：2012-12-19T16:00:30.113
> 
> 标签：php, recursion, zip, rar, gzip

我正在尝试创建一个备份类，其主要目标是自定义类调用，以根据用户选择仅对特定扩展名、特定文件大小或主目录中的特定目录过滤最终备份。

目前，该课程缺少压缩算法，因为我一直在寻找有关 .zip 压缩的解决方案。

下面是一个文件和文件夹结构示例，该类将使用它来创建压缩存档（zip、rar、gz 等）：

```
Array
(
    [0] => pclzip.lib.php
    [1] => index.php
    [style] => Array
        (
            [js] => Array
                (
                    [0] => jNice.js
                    [1] => jquery.js
                )

            [img] => Array
                (
                    [0] => input-shaddow-hover.gif
                    [1] => btn_right.gif
                    [2] => top-menu-bg.gif
                    [3] => top-menu-item-bg.gif
                    [4] => left-menu-bg.gif
                    [5] => button-submit.gif
                    [6] => btn_left.gif
                    [7] => select_right.gif
                    [8] => select_left.gif
                    [9] => transdmin-light.png
                    [10] => content.gif
                    [11] => input-shaddow.gif
                )

            [css] => Array
                (
                    [0] => transdmin.css
                    [1] => layout.css
                    [2] => ie7.css
                    [3] => hack.css
                    [4] => jNice.css
                    [5] => ie6.css
                    [6] => reset.css
                )

        )

    [2] => config.php
    [3] => delete.php
    [4] => restore.php
    [5] => cron.php
    [6] => manage.php
) 
```

如您所见，文件和文件夹结构需要保存在备份文件中，因此要备份的文件和文件夹列表已经结构化，如果数组叶子包含子数组，则叶子是一个目录，如果叶子不包含子数组，则叶子是文件。

以下是我创建递归压缩文件和文件夹的过程的目的，这些文件和文件夹（应该）适用于我之前介绍的结构化数组：

```
private function zipFileAndFolderStructureArray ( $backupContentsArray, $zipDestination, $backupRootDirectory ) {
    if ( $this -> zipObject == null ) {
        if ( extension_loaded ( 'zip' ) === true ) {
            $this -> zipObject = new ZipArchive();
            if ( ( $zipErrorCode = $this -> zipObject -> open ( $zipDestination, ZipArchive::CREATE ) ) !== true ) $this -> zipObject = null;
            else $this -> zipFileAndFolderStructureArray ( $backupContentsArray, $zipDestination, $backupRootDirectory );
        }
    }
    else if ( $this -> zipObject != null ) {
        foreach ( $backupContentsArray as $folder => $file_or_folder_list ) {
            $cwd = rtrim ( $backupRootDirectory, '/' ) . '/' . $folder . '/';
            if ( is_array ( $file_or_folder_list ) && is_dir ( $cwd . $folder ) ) {
                echo 'adding folder ' . $folder . ' in cwd ' . $cwd . '<br>';
                $this -> zipObject -> addEmptyDir ( $folder );
                $this -> zipFileAndFolderStructureArray ( $file_or_folder_list, $zipDestination, $cwd );
            }
            else if ( is_file ( $cwd . $file_or_folder_list ) ) {
                echo 'adding file ' . $file_or_folder_list . '<br>';
                $this -> zipObject -> addFromString ( $cwd . $file_or_folder_list );
            }
        }

        $this -> zipObject -> close ();
        return true;
    }
} 
```

问题是，我被困在了这一点上。此递归函数在输入第一个文件夹叶子后存在，创建一个其中只有一个空文件夹的存档。

你能帮我找出问题所在吗？

关于我可以用来将压缩功能扩展到 RAR 和 GZ 的可能类的提示，尽可能多地重用用于 ZIP 的相同压缩算法？

先感谢您

PS 添加了当前创建文件夹和目录结构的函数

```
public function directory_list ( $directory_base_path, $filter_dir = false, $filter_files = false, $exclude_empty_dirs = true, $include_extensions = null, $exclude_extensions = null, $exclude_files = null, $recursive = true ) {
    $directory_base_path = rtrim ($directory_base_path, "/" ) . "/";
    if ( ! is_dir ( $directory_base_path ) ) return false;

    $result_list = array();
    if ( ! is_array ( $exclude_files ) ) $exclude_array = Array ( '.', '..' );
    else $exclude_array = array_merge ( Array ( '.', '..' ), $exclude_files );

    if ( ! $folder_handle = opendir ( $directory_base_path ) ) return false;
    else{
        while ( false !== ( $filename = readdir ( $folder_handle ) ) ) {
            if ( ! in_array ( $filename, $exclude_array ) ) {
                if ( is_dir ( $directory_base_path . $filename . "/" ) ) {
                    if ( $recursive && strcmp ( $filename, "." ) != 0 && strcmp ( $filename, ".." ) != 0 ) { // prevent infinite recursion
                        $result = self::directory_list("$directory_base_path$filename/", $filter_dir, $filter_files, $exclude_empty_dirs, $include_extensions, $exclude_extensions, $exclude_files, $recursive);
                        if ( $exclude_empty_dirs ) {
                            if ( count ( array_keys ( $result ) ) > 0 ) $result_list[$filename] = $result;
                        }
                        else $result_list[$filename] = $result;
                    }
                    else if ( ! $filter_dir ) $result_list[] = $filename;
                }
                else if ( ! $filter_files ) {
                    $extension = end ( explode ( '.', $filename ) );
                    if ( ! is_array ( $include_extensions ) && count ( $include_extensions ) == 0 && ! is_array ( $exclude_extensions ) && count ( $exclude_extensions ) == 0 ) if ( $filename != '.' && $filename != '..' ) $result_list[] = $filename;
                    if ( is_array ( $exclude_extensions ) && count ( $exclude_extensions ) > 0 && ! in_array ( $extension, $exclude_extensions ) ) $result_list[] = $filename;
                    else if ( is_array ( $include_extensions ) && count ( $include_extensions ) > 0 && strlen ( $extension ) > 0 && in_array ( $extension, $include_extensions ) ) $result_list[] = $filename;
                }
            }
        }
        closedir($folder_handle);
        return $result_list;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T12:10:44.533

在对递归 zip 算法中的几乎所有内容进行了调查和回显之后，发现文件夹结构很难处理，并且需要在路径中进行大量的斜杠修复。

这是相同 zipFileAndFolderStructureArray 函数的固定版本

```
private function zipFileAndFolderStructureArray ( $backupContentsArray, $zipDestination, $backupRootDirectory, $currentWorkingDirectory = '' ) {
    if ( $this -> zipObject == null ) {
        if ( extension_loaded ( 'zip' ) === true ) {
            $this -> zipObject = new ZipArchive();
            if ( ( $zipErrorCode = $this -> zipObject -> open ( $zipDestination, ZipArchive::CREATE ) ) !== true ) $this -> zipObject = '#ERROR#';
            else $this -> zipFileAndFolderStructureArray ( $backupContentsArray, $zipDestination, $backupRootDirectory );
        }
    }
    else if ( $this -> zipObject == '#ERROR#' ) return false; // return false in case the zipArchive::open returned false on archive opening
    else {
        foreach ( $backupContentsArray as $folder => $file_or_folder_list ) {
            if ( is_array ( $file_or_folder_list ) ) {
                $current_working_folder = rtrim ( $currentWorkingDirectory, '/' ) . '/' . $folder . '/';
                if ( is_dir ( $backupRootDirectory . $current_working_folder ) ) {
                    // not necessary to add an empty folder in this case: the addFile will take care of creating the folder structure in the zip file
                    $this -> zipFileAndFolderStructureArray ( $file_or_folder_list, $zipDestination, $backupRootDirectory, rtrim ( $current_working_folder, '/' ) );
                }
            }
            else if ( is_file ( $backupRootDirectory . trim ( $currentWorkingDirectory, '/' ) . '/' . $file_or_folder_list ) ) {
                $file_insertion = $backupRootDirectory . trim ( $currentWorkingDirectory, '/' ) . '/' . $file_or_folder_list;
                $zip_filename = str_replace ( $backupRootDirectory, '', $file_insertion );
                if ( substr_count ( $zip_filename, '/' ) == 1 ) $zip_filename = trim ( $zip_filename, '/' ); // file in backup root directory fix
                $this -> zipObject -> addFile ( $file_insertion, $zip_filename );
            }
        }
        return true;
    }
} 
```

# php - 在 Magento 中更改国家名称

> ID：13956283
> 
> 赞同：0
> 
> 时间：2012-12-19T16:00:44.873
> 
> 标签：php, mysql, magento

我正在尝试将地址标签上的“英国”替换为“英国”

我们注意到运往英国的货物（信不信由你）经常到达美国。

这是到目前为止的代码：

```
if ($value!=='') {
    if ($value =='United Kingdom') {
    $page->drawText(Mage::helper('addresslabel')->__('Great Britain'), $this->x, $this->y, 'UTF-8');
    }
    else {                          
    $page->drawText(strip_tags(ltrim($value)), $this->x, $this->y, 'UTF-8');
    }
} 
```

但它不起作用。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:45:19.277

我认为修改国名不会有任何问题，尽管这很不寻常。只要您只更改名称而不更改链接到它们的代码。

它们存储在（我能找到的）：

lib/Zend/Locale/Data/Translation.php
lib/Zend/Locale/Data/fil.xml
lib/Zend/Locale/Data/en.xml
lib/Zend/Locale/Data/id.xml
lib/Zend/Locale/数据/ms.xml

除了在这些文件中编辑它们之外，我不确定其他任何方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T19:49:30.337

错误出现在这行代码中：

```
$page->drawText(Mage::helper('addresslabel')->__('Great Britain'), $this->x, $this->y, 'UTF-8');
} 
```

我将其替换为以下内容：

```
$gb='Great Britain';
$page->drawText(strip_tags(ltrim($gb)), $this->x, $this->y, 'UTF-8'); 
```

这很好用！

# apache-flex - 从动态创建的 TextInput 字段中获取 Flex TextInput.text

> ID：13956284
> 
> 赞同：0
> 
> 时间：2012-12-19T16:00:46.437
> 
> 标签：apache-flex

我正在通过类似于下面的 for 循环创建几个 TextInput 框。NumberOfSelections 变量将根据用户的输入而有所不同。

```
 for(var i:int=1; i <= NumberOfSelections; i++){
            InputField = new TextInput;
            InputField.id = "Name" + i
            InputField.text = "2" 
            HGroup1.addElement(InputField);
    } 
```

TextInput 文本在运行时是可编辑的，用户将输入数字，然后按下将调用新函数的计算按钮。如何从所有 TextInput 字段中获取信息。例如，如果 NumberOfSelections 为 4，我将如何获取用户输入的所有 4 个数字以便将它们加在一起。是否可以使用唯一的 id 名称

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:43:41.007

Flextra 的回答绝对正确。我只想添加另外两个选项：

**遍历 HGroup 的孩子**

```
for (var i:i=0; i<hGroup1.numElements; i++) {
    var inputField:TextInput = hGroup1.getElementAt(i) as TextInput;
    if (inputField) doSomthingWith(inputField.text);    
} 
```

请注意，从“最佳实践”的角度来看，这不是一个非常漂亮的方法。
一个更好的方法可能是

**放弃动态实例化并改用 DataGroup**

因为这正是 DataGroup 的本意。

```
<s:DataGroup dataProvider="{dp}">
    <s:itemRenderer>
        <fx:Component>
            <s:ItemRenderer>
                <s:TextInput text="@{data.myValue}"/>
            </s:ItemRenderer>
        </fx:Component>
    </s:itemRenderer>

    <s:layout>
        <s:HorizontalLayout/>
    </s:layout>
</s:DataGroup> 
```

请注意，该`myValue`属性必须声明为可绑定才能使其正常工作。
您现在可以简单地循环输入项目`dp`以进行计算，并让框架处理动态实例化。如果您需要添加/删除 TextInput，只需将项目添加/删除到`dp`. 在我看来，这是迄今为止最干净的解决方案，因为它很好地将您的视图与模型分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:30:53.013

您必须在创建字段时保存对字段的引用。我建议将它们存储在一个数组中：

```
// somewhere in your code; define the variable
public var textBoxArray : Array = new Array();

// somewhere in some method create the textBoxes
for(var i:int=1; i <= NumberOfSelections; i++){
        InputField = new TextInput;
        InputField.id = "Name" + i
        InputField.text = "2" 
        HGroup1.addElement(InputField);
        textBoxArray.push(InputField);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:34:43.450

使用 [] 引用您的输入：

```
for(var i:int=1; i <= NumberOfSelections; i++){
    someVariable = this["Name" + i].text;
} 
```

# c - pthread_t 指针作为 pthread_create 的参数

> ID：13956285
> 
> 赞同：3
> 
> 时间：2012-12-19T16:00:48.510
> 
> 标签：c, pointers, pthreads

pthread_create 的第一个参数是一个 pthread_t 指针。在下面的*hello 程序*中，如果第一个参数是指向 pthread_t ( `pthread_t*`) 而不是pthread_t ( ) 的指针，`pthread_t`则程序以`Segmentation fault`...**为什么结束？**

我不记得看到`pthread_t*`. 的第一个参数的声明类型`pthread_create`。
Butenhof 的书*Programming with POSIX Threads*的第 2 章说：

> 要创建一个线程，您必须声明一个类型为`pthread_t`[not `pthread_t*`] 的变量。

但是[根据规范](http://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_create.html)，第一个参数`pthread_create`是指向的指针`pthread_t`，那么为什么会出现分段错误呢？

* * *

分段故障

```
pthread_t* thr;
pthread_create(thr, NULL, &hello, NULL); 
```

* * *

运行正常

```
pthread_t thr;
pthread_t* pntr = &thr;
pthread_create(pntr, NULL, &hello, NULL); 
```

* * *

你好程序：

```
#include <pthread.h>
#include <stdio.h>

void * 
hello(void *arg){
  printf("Hello\n");
  pthread_exit(NULL);
}

int 
main(int argc, char **argv){
  pthread_t thr = 1;
  pthread_create(&thr, NULL, &hello, NULL);

  pthread_join(thr, NULL);

  return 0;
} 
```

* * *

pthread_create 原型：

```
int pthread_create(pthread_t *thread, const pthread_attr_t *attr,
void *(*start_routine)(void*), void *arg); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T16:03:02.813

```
pthread_t* thr;
pthread_create(thr, NULL, &hello, NULL); 
```

declares a pointer to a `pthread_t` without allocating storage for it. When you call `pthread_create`, it'll try writing to `*thr`. This is at an undefined location and will almost certainly fail.

```
pthread_t thr;
pthread_t* pntr = &thr;
pthread_create(pntr, NULL, &hello, NULL); 
```

works because you've declare storage (`thr` on the stack) for a `pthread_t`.

Note that the second, working, version can be simplified to what is used in your hello program

```
pthread_t thr;
pthread_create(&thr, NULL, &hello, NULL); 
```

...which declares a `pthread_t` on the stack then passes a pointer to it into `pthread_create`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T16:03:54.717

这是因为如果你简单地声明一个指针，你不能指望它指向分配的、初始化的内存。

当您改为声明 a`pthread_t`时，它会被分配自己的一小块内存，然后您可以使用`&`运算符获取地址并将其传递给`pthread_create`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-22T11:13:57.843

如果你想创建一些线程，你可以使用下面的代码：

```
pthread_t* thread_handles;
thread_handles = malloc(thread_count * sizeof(pthread_t));
for (thread = 0; thread < thread_count; thread++)
{
  pthread_create(&thread_handles[thread], NULL, threadFunc, (void*)input);
} 
```

这样，您应该在调用之前为您的句柄分配内存`pthread_create`，就像当您想要创建一些“结构”时，您应该首先为它们分配内存。

# facebook - Facebook Like 在具有正确 og:image 的newsitems 列表中

> ID：13956287
> 
> 赞同：0
> 
> 时间：2012-12-19T16:00:54.580
> 
> 标签：facebook, facebook-like

`og:image`是特定于页面的。

当我有一个新站点列表（例如 10 个带有 10 张小图片的新站点）并且我想在该列表中喜欢 1 个新站点（您可以喜欢每个项目）时，那么标准的 facebook 之类的代码可以正常工作.. 但是.. 在我的知识中您只能设置一页特定的 og:image 并且不能在一页上使用多个 og:image 或传递（通过普通的 FB 类函数）正确的 og:image

我怎样才能做到这一点？所以在一个包含 10 个项目和 10 个图像的概览页面上，我喜欢 1 个项目，并且在 FB 中显示了相应的右图？

您只能在页面上设置 1 个 og:image，但我在一个页面上有 10 个项目，有 10 张不同的图片。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T18:53:12.923

对于每个项目的 URL，您可以包含不同的查询字符串参数。在页面本身上，根据查询字符串参数，您可以为 og:image 指定不同的值。这需要在服务器端完成，因为抓取页面的 Facebook 机器人将无法识别该值是否被客户端上的 JavaScript 更改。

# android - 为 nexus 10 准备应用程序

> ID：13956288
> 
> 赞同：6
> 
> 时间：2012-12-19T16:01:02.240
> 
> 标签：android, android-emulator, nexus-10

我正在开发一个安卓录音应用程序，我们的应用程序目前设计用于所有安卓手机、Nexus 7 和摩托罗拉 Xoom 平板电脑。

我想知道是否有**任何指南或最佳实践来重新设计/修改我们的 Nexus 10 应用程序**。更具体地说，关于以下几点的任何指示都会非常有帮助：

*   支持新的 2560x1600 分辨率的 UI 指南
*   Android资源文件相关修改（基于[类似指南](http://developer.android.com/guide/practices/screens_support.html)）
*   任何经过修改以在 nexus 10 上运行的示例或开源应用程序
*   创建和运行 nexus 10 模拟器的最佳实践，因为默认情况下没有这样的 AVD 设备（下面的屏幕截图）。关于创建一个的任何想法，请牢记高分辨率。

![新的 AVD 默认设备类型](../Images/71ac1a947ed20c91f70f4c4bad057c03.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-22T16:41:58.447

只要您拥有 xhdpi 资产和为 10 英寸平板电脑制作的布局，您就不必做任何事情（除了添加一个新的 xxhdpi 启动器图标，如 @Mattias 所述）。

要制作 Nexus 10 AVD，请导航至设备定义：

![设备定义](../Images/424ce4022515e12f65ad414ea1135b75.png)

然后，单击新设备。填写如下内容：

![Nexus 10 配置](../Images/7196bdd4c71d0a5627c772c3349aaf54.png)

现在它将列在上面显示的设备下拉列表中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-19T16:18:44.217

关于您的第二点，资源：虽然 nexus 10 是一种`xhdpi`设备，但如果可用，它将使用`xxhdpi`“one bucket up”中的启动器图标，因此请确保提供一个，因为它看起来会更好/更清晰/更清晰。原因是此设备上有更大图标的空间。xxhdpi 处的启动器图标大小为 144x144 像素。

参考见： https: [//plus.google.com/118292708268361843293/posts/ePQya3KsTjW](https://plus.google.com/118292708268361843293/posts/ePQya3KsTjW)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-21T17:07:47.703

模拟 Nexus 10 的最佳方式是使用 AndroVM。我目前正在以完整的 Nexus 10 2560x1600 分辨率在其上运行 Android，如果我将 AndroVM 设置为使用 320dpi，它就适合我的高清屏幕。

哦..而且它非常快:-)

我个人在模拟器和真实硬件设备上使用它，因为它响应速度极快，而且 APK 的部署速度快如闪电。

顺便说一句，我自己并没有为 AndroVM 项目做贡献，但它大大加快了我自己的开发周期。在所有开发周期中，开发人员等待查看他们的代码调整是否使用模拟器或硬件设备会增加相当大的时间开销。在正常代码开发过程中，无论屏幕大小如何，我都会彻底推荐使用 AndroVM。

# tfs - 服务器项目上的 tf diff 显示本地更改而不是服务器

> ID：13956290
> 
> 赞同：1
> 
> 时间：2012-12-19T16:01:03.093
> 
> 标签：tfs, team-explorer

我正在运行 TF Diff 命令来获取两个分支之间的差异。我运行以下命令： `tf difference $/myVersionControl/Branch1 $/myVersionControl/Branch2 -recursive` 显示的唯一区别是工作目录中的那些，并且只有顶级目录。它几乎就像它不递归地看里面一样。我在这里做错了什么？如果我从团队资源管理器中执行此操作，我可以获得所有差异的列表。我假设 Team Explorer 在幕后使用 TF Diff，但我可能是错的。我正在使用 TFS 2008。如果有一个等效的 powershell - 那将是完美的，因为我想通过管道输出并与这些更改做更多的事情。

![在此处输入图像描述](../Images/5e96002bddb7275d9d2a1c745d4b6e0d.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:47:00.530

tf folderdiff $/Branch1/ $/Branch2/ -recursive > output.txt

要使用差异命令，您必须将所有指定项目的读取权限设置为允许。

# javascript - toLocaleTimeString() 返回军用时间

> ID：13956291
> 
> 赞同：0
> 
> 时间：2012-12-19T16:01:06.357
> 
> 标签：javascript, date

我有一个将 SQL 日期时间戳转换为格式化时间的函数。它在 iOS 设备上看起来不错，但在 Android 设备上显示为军用时间。我怎样才能让它在 android 设备上返回 toLocaleTimeString() 而不是军事时间？

```
function fromDateString(str) {
    var res = str.match(/\/Date\((\d+)(?:([+-])(\d\d)(\d\d))?\)\//);
    if (res == null)
        return new Date(NaN); // or something that indicates it was not a DateString
    var time = parseInt(res[1], 10);
    if (res[2] && res[3] && res[4]) {
        var dir = res[2] == "+" ? -1 : 1,
            h = parseInt(res[3], 10),
            m = parseInt(res[4], 10);
        time += dir * (h*60+m) * 60000;
    }
    return formatdate.toLocaleTimeString();
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T16:12:25.560

该[`Date.toLocaleTimeString()`函数](http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.5.7)是“依赖于实现的”，这意味着如果您想在所有设备上保证某种格式，那么您必须自己应用它。

这是我的做法：

```
function formatTimeString(date) {
  if ((typeof(date)!=='object') || (date.constructor!==Date)) {
    throw new Error('argument must be a Date object');
  }
  function pad(s) { return ((''+s).length < 2 ? '0' : '') + s; }
  function fixHour(h) { return (h==0?'12':(h>12?h-12:h)); }
  var h=date.getHours(), m=date.getMinutes(), s=date.getSeconds()
    , timeStr=[pad(fixHour(h)), pad(m), pad(s)].join(':');
  return timeStr + ' ' + (h < 12 ? 'AM' : 'PM');
}

formatTimeString(new Date());
// => "09:19:03 AM"
formatTimeString(new Date('2012-12-19T20:09:10-0700'));
// => "08:09:10 PM"
formatTimeString(new Date('2012-12-19T00:13:14-0700'));
// => "12:13:14 AM" 
```

# r - Rcpp + inline - 创建和调用附加函数

> ID：13956292
> 
> 赞同：6
> 
> 时间：2012-12-19T16:01:07.527
> 
> 标签：r, rcpp

我想知道是否有一种方法可以`Rcpp`使用 `inline`主函数中的包来创建函数。这是我想做的一个例子：

```
library(inline)
library(Rcpp)
a = 1:10
cpp.fun = cxxfunction(signature(data1="numeric"), 
                      plugin="Rcpp",
                      body="
int fun1( int a1)
{int b1 = a1;
 b1 = b1*b1;
 return(b1);
}

NumericVector fun_data  = data1;
int n = data1.size();
for(i=0;i<n;i++){
fun_data[i] = fun1(fun_data[i]);
}
return(fun_data);
                           ") 
```

这应该导致：

```
> cpp.fun(a)
[1]  1  4  9  16  25  36  49  64  81  100 
```

但是我知道编译器不会接受在 main 方法中创建您自己的函数。我将如何创建和调用另一个`Rcpp`函数`inline`而不必将其传递给 R？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-19T16:09:16.317

`body`是函数体，你想看看`includes`参数`cxxfunction`：

```
library(inline)
library(Rcpp)
a = 1:10
cpp.fun = cxxfunction(signature(data1="numeric"), 
                      plugin="Rcpp",
                      body='

IntegerVector fun_data  = data1;
int n = fun_data.size();
for(int i=0;i<n;i++){
    fun_data[i] = fun1(fun_data[i]);
}
return(fun_data);
', includes = '

int fun1( int a1){
    int b1 = a1;
    b1 = b1*b1;
    return(b1);
}

' )    
cpp.fun( a ) 
```

`?cxxfunction``includes`有关于其论点的详细文档。

但请注意，此版本将在您的输入向量中进行适当的修改，这可能不是您想要的。另一个也利用以下`Rcpp`版本的版本`sapply`：

```
library(inline)
library(Rcpp)
a = 1:10
cpp.fun = cxxfunction(signature(data1="numeric"), 
                      plugin="Rcpp",
                      body='

IntegerVector fun_data  = data1; 
IntegerVector out = sapply( fun_data, fun1 ) ;
return(out);
', includes = '

int fun1( int a1){
    int b1 = a1;
    b1 = b1*b1;
    return(b1);
}

' )    
cpp.fun( a )
a 
```

最后，你绝对应该看看`sourceCpp`. 有了它，您可以将代码写入一个`.cpp`文件，其中包含：

```
#include <Rcpp.h>
using namespace Rcpp ;

int fun1( int a1){
    int b1 = a1;
    b1 = b1*b1;
    return(b1);
}

// [[Rcpp::export]]
IntegerVector fun(IntegerVector fun_data){ 
    IntegerVector out = sapply( fun_data, fun1 ) ;
    return(out);
} 
```

然后，您可以只`sourceCpp`使用您的文件并调用该函数：

```
sourceCpp( "file.cpp" )
fun( 1:10 )
#  [1]   1   4   9  16  25  36  49  64  81 100 
```

# jquery - jQuery .each 维度向下钻取

> ID：13956293
> 
> 赞同：1
> 
> 时间：2012-12-19T16:01:06.823
> 
> 标签：jquery, ajax, json

我有获取和解析 JSON 数组中数据的代码。它应该为每个数组条目执行此操作，但它只针对第一个条目执行此操作。

```
$.ajax({
    url: url,
    dataType: 'json',
    success: function(data){
        $.each(data, function (key, value){
            var mlsnum = value[1];
            var address = value[5] + ' ' + value[6] + ' ' + value[7];
            var city = value[9];
            var state = value[10];
            var zip = value[11];
            var county = value[12];
            var price = value[13];
            var sqft = value[17];
            var yrblt = value[22];
            var bdrms = value[14];
            var baths = value[15];
            $('#test').html(
                '<div class="listing_single">' +
                    '<div class="listing_img"><a href="http://mgoode.com/index.php?option=com_mls&view=mls&mlsnum=' + mlsnum + '"><img class="imgt" src="http://www.universaldynamicmedia.com/sandbox/Images/' + mlsnum + '/HQPhoto-' + mlsnum + '-1.jpeg" /></a></div>' +
                    '<div class="listing_data">' +
                    '<div class="listing_single_address "><a class="address_link" href="http://mgoode.com/index.php?option=com_mls&view=mls&mlsnum=' + mlsnum + '">' + address + '</a></div>' +
                    '<div class="listing_single_city">' + city + ', ' + state + ' ' + zip + '</div>' +
                    '<div class="listing_single_data_spec"><span class="listing_single_price">' + price + '</span>|<span class="data_small">SqFt: ' +  sqft + '</span>|<span class="data_small">Year Built: ' + yrblt + '</span>|<span class="data_small"> Bedrooms: ' + bdrms + '</span>|<span class="data_small"> Baths: ' + baths + '</span></div>' +
                    '</div>' +
                '<div class="clear"></div></div>'
            );   
        });
    },
    error: function(){
        alert('There was an error loading your request.  <br />Please try again later.');
    }
}); 
```

该数组以 3 维结构...

```
{ "0" : [
    { "0" : [
        { "0" : "data1", "1" : "data2"}]}
    { "1" : [
        { "0" : "data1", "1" : "data2"}]}
]} 
```

我认为它只是为第一个维度项目提取数据`.each`，其中只有一个。我想我需要将`.each`函数深入到第二维，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:21:09.893

你可以只嵌套jquery每个语句吗？如果我理解正确：

```
 $.each(data, function(key, value) {

        $.each(value[key], function(key2, value2) {

            $.each(value2[key2], function(key3, value3){

                // etc.

            });

        });

    }); 
```

# android - android如何读取“android.os.Build.TAGS”

> ID：13956295
> 
> 赞同：0
> 
> 时间：2012-12-19T16:01:14.333
> 
> 标签：android, c

谁能告诉android框架如何读取android.os.Build.TAGS。有没有办法可以使用 C 语言读取标签。因为我已经阅读了标签并在本机 C 代码中做了一些事情......

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:06:47.123

我想你可以使用

```
property_get("ro.build.tags") 
```

检查这个[帖子](https://stackoverflow.com/a/13357240/1109425)

# c# - .NET：XML 文档 - CREF 标记中使用的程序集别名

> ID：13956296
> 
> 赞同：2
> 
> 时间：2012-12-19T16:01:17.377
> 
> 标签：c#, .net, xml-comments, xml-documentation

在 cref 链接中使用程序集别名时，我难以解决 C# 编译器警告。不幸的是，我从智能感知得到的唯一反馈是“语法错误”。这是链接的示例 [参见 cref="global::Namespace.Class.Method"]。据我所知，语法是正确的。被引用的程序集为别名设置了“全局”。

这是编译器的问题吗？有解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:09:39.823

据我所知，`global`文档注释中的含义与普通代码中的含义相同。它只是一个*命名空间别名*，可让您避免命名空间名称和类型名称之间的冲突。有关更多详细信息，请参阅[关于全局命名空间别名的 MSDN 。](http://msdn.microsoft.com/en-us/library/c3ay4x3d.aspx)

请注意，这*与*在不同程序集中有两种具有相同完全限定名称的类型时使用的外部[别名不同。](http://msdn.microsoft.com/en-us/library/ms173212.aspx)您谈论“不同的根源”的问题表明您*可能*对外部别名感到困惑，但很难确定。

# android - 在 Android 中调用 .NET Web 服务

> ID：13956298
> 
> 赞同：8
> 
> 时间：2012-12-19T16:01:19.537
> 
> 标签：android, web-services, android-layout, ksoap2, android-ksoap2

我的 .NET Web 服务返回一个 XML。当我在 Android 中使用 ksoap2 调用 Web 服务时，我遇到了这个问题。请帮忙。

**我在 Eclipse 中的 Logcat**

```
12-19 15:58:11.951: W/dalvikvm(2041): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
12-19 15:58:11.961: E/AndroidRuntime(2041): FATAL EXCEPTION: main
12-19 15:58:11.961: E/AndroidRuntime(2041): java.lang.RuntimeException: double ID
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.serialization.SoapSerializationEnvelope.read(SoapSerializationEnvelope.java:407)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.serialization.SoapSerializationEnvelope.readUnknown(SoapSerializationEnvelope.java:273)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.serialization.SoapSerializationEnvelope.read(SoapSerializationEnvelope.java:389)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.serialization.SoapSerializationEnvelope.readUnknown(SoapSerializationEnvelope.java:273)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.serialization.SoapSerializationEnvelope.read(SoapSerializationEnvelope.java:389)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.serialization.SoapSerializationEnvelope.readUnknown(SoapSerializationEnvelope.java:273)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.serialization.SoapSerializationEnvelope.read(SoapSerializationEnvelope.java:389)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.serialization.SoapSerializationEnvelope.parseBody(SoapSerializationEnvelope.java:151)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.SoapEnvelope.parse(SoapEnvelope.java:140)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.transport.Transport.parseResponse(Transport.java:116)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:259)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:114)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at com.example.webservicee.MainActivity$1.onClick(MainActivity.java:133)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at android.view.View.performClick(View.java:2408)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at android.view.View$PerformClick.run(View.java:8816)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at android.os.Handler.handleCallback(Handler.java:587)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at android.os.Handler.dispatchMessage(Handler.java:92)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at android.os.Looper.loop(Looper.java:123)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at android.app.ActivityThread.main(ActivityThread.java:4627)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at java.lang.reflect.Method.invokeNative(Native Method)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at java.lang.reflect.Method.invoke(Method.java:521)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-19 15:58:11.961: E/AndroidRuntime(2041):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626) 
```

**MainActivity.java**

```
package com.example.webservicee; 
import java.io.IOException;

import org.ksoap2.SoapEnvelope;
import org.ksoap2.SoapFault;
import org.ksoap2.serialization.PropertyInfo;
import org.ksoap2.serialization.SoapObject;
import org.ksoap2.serialization.SoapPrimitive;
import org.ksoap2.serialization.SoapSerializationEnvelope;
import org.ksoap2.transport.HttpTransportSE;
import org.xmlpull.v1.XmlPullParserException;
import android.os.Bundle;
import android.app.Activity;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class MainActivity extends Activity {

    final static String NAMESPACE = "http://tempuri.org/";

    final static String METHOD_NAME = "GetContent";

    final static String SOAP_ACTION = "http://tempuri.org/GetContent";

    final static String URL = "http://www.example.com/XMLGenerator/GenerateXML.asmx";

    private Button Mybtn;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        deger = (EditText) findViewById(R.id.deger);
        sonuc = (TextView) findViewById(R.id.flag);
        Mybtn = (Button) findViewById(R.id.hesapla);
        Mybtn.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                // TODO Auto-generated method stub
                SoapObject Request = new SoapObject(NAMESPACE, METHOD_NAME);

                //My webservice paramaters 
                Request.addProperty("SectionsInclude","10");
                Request.addProperty("DocumentCount",10);
                Request.addProperty("SortBy","0");
                Request.addProperty("SortOrder","ASC");
                Request.addProperty("UserName","myuser");
                Request.addProperty("Pass","Lsss");
                /**/
                      /*  PropertyInfo pi=new PropertyInfo();
                        pi.setName("arg0");
                        pi.setValue("10");
                        pi.setType(String.class);
                        Request.addProperty(pi);
                        pi=new PropertyInfo();

                        pi.setName("arg1");
                        pi.setValue(10);
                        pi.setType(Integer.class);
                        Request.addProperty(pi);
                        pi=new PropertyInfo();

                        pi.setName("arg2");
                        pi.setValue("0");
                        pi.setType(String.class);
                        Request.addProperty(pi);
                        pi=new PropertyInfo();

                        pi.setName("arg3");
                        pi.setValue("ASC");
                        pi.setType(String.class);
                        Request.addProperty(pi);
                        pi=new PropertyInfo();

                        pi.setName("arg4");
                        pi.setValue("myuser");
                        pi.setType(String.class);
                        Request.addProperty(pi);
                        pi=new PropertyInfo();

                        pi.setName("arg5");
                        pi.setValue("Lsss");
                        pi.setType(String.class);
                        Request.addProperty(pi);

                        */

                SoapSerializationEnvelope soapEnvelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
                soapEnvelope.dotNet = true;
                soapEnvelope.setOutputSoapObject(Request);
                //soapEnvelope.bodyOut = Request;
                HttpTransportSE aht = new HttpTransportSE(URL);
                try {
                    aht.call(SOAP_ACTION, soapEnvelope);

                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                } catch (XmlPullParserException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                String result;
                try {

                    result = "Fahrenheit:"+(SoapPrimitive) soapEnvelope.getResponse();
                     Log.d("--Result-- ", result);
                    //sonuc.setText(result);

                    } catch (SoapFault e) 
                    {

                    e.printStackTrace();

                    }
            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

这是示例响应 xml：

```
<?xml version="1.0" encoding="utf-8"?>
<liste>
<document id="6" titles="bestPeople" showingDate="27.09.2011 00:00:00"  date="27.09.2011 00:00:00" ContentID=rbHe8zKvDTG7TLS" >
<part id="6" baslik="best" icerik="&lt;table style=&quot;width: 188px; height: 24px;&quot; border=&quot;tbody&gt;&#xD;&#xA;&lt;/table&gt;" resim="">
<SecNotes><![CDATA[]]></SecNotes>
<ContNotes><![CDATA[]]></ContNotes>
</part>
<SecNotes><![CDATA[]]></SecNotes>
<ContNotes><![CDATA[]]></ContNotes>
</document>
</liste> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T08:17:36.867

我解决它。我添加了这段代码。它正在工作。

**我的代码**

```
@Override
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    init();
}
private void init()
{
    //your webservice envelope
    String envelope="<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body><GetContentTreeBySections xmlns=\"http://tempuri.org/\"><SectionsInclude>%s</SectionsInclude><DocumentCount>%s</DocumentCount><SortBy>%s</SortBy><SortOrder>%s</SortOrder><UserName>%s</UserName><Pass>%s</Pass></GetContentTreeBySections></soap:Body></soap:Envelope>";

    String myEnvelope = String.format(envelope, "myParam1 value", "myParam2 value","myParam3 value","myParam4 value");
    String url = "http://www.mywebserice.com/XMLGenerator/GenerateXML.asmx";
    String soapAction = "http://tempuri.org/GetContentTreeBySections"; 
    String response = CallWebService(url, soapAction, myEnvelope);
    //Log.v("response", response);
    Toast.makeText(getApplicationContext(), "this"+response,Toast.LENGTH_LONG).show();
    String xml=response;    
}

@Override
public boolean onCreateOptionsMenu(Menu menu) 
{
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}
String CallWebService(String url,String soapAction,String envelope) 
{

      final DefaultHttpClient httpClient=new DefaultHttpClient();
      // request parameters
      HttpParams params = httpClient.getParams();
         HttpConnectionParams.setConnectionTimeout(params, 10000);
         HttpConnectionParams.setSoTimeout(params, 15000);
         // set parameter
      HttpProtocolParams.setUseExpectContinue(httpClient.getParams(), true);

      // POST the envelope
      HttpPost httppost = new HttpPost(url);
      // add headers
         httppost.setHeader("soapaction", soapAction);
         httppost.setHeader("Content-Type", "text/xml; charset=utf-8");
         String responseString="";

         try 
         {
                // the entity holds the request
                HttpEntity entity = new StringEntity(envelope);
                httppost.setEntity(entity);

                // Response handler
                ResponseHandler<String> rh=new ResponseHandler<String>() {
        // invoked when client receives response
        public String handleResponse(HttpResponse response)
          throws ClientProtocolException, IOException {

         // get response entity
         HttpEntity entity = response.getEntity();

         // read the response as byte array
               StringBuffer out = new StringBuffer();
               byte[] b = EntityUtils.toByteArray(entity);

               // write the response byte array to a string buffer
               out.append(new String(b, 0, b.length));
               return out.toString();
        }
       };

       responseString=httpClient.execute(httppost, rh); 

      }
         catch (Exception e) {
          Log.v("exception", e.toString());
      }

         // close the connection
      httpClient.getConnectionManager().shutdown();
      return responseString;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T09:39:41.507

与其使用 ksoap，不如尝试使用开源的 ice-soap 库。它比 ksoap 好得多，并提供了高效的库来使用注释发送请求和解析响应....

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-24T18:49:46.013

首先，永远不要在主线程中使用网络操作尝试始终在非主线程中插入网络操作，如 AsyncTask 或任何其他工作线程。其次使用以下代码获取结果：

```
 String message="";
    SoapObject result = (SoapObject)envelope.bodyIn;
    if(result != null)
       {
          message=result.getProperty(0).toString();
       } 
```

并更改以下代码

```
Request.addProperty("DocumentCount",10); 
```

成为

```
Request.addProperty("DocumentCount","10"); 
```

# php - 计算两个日期之间的天数

> ID：13956302
> 
> 赞同：5
> 
> 时间：2012-12-19T16:01:36.167
> 
> 标签：php, html, date, web

> **可能重复：**
> [如何使用 php 查找两个日期之间的天数](https://stackoverflow.com/questions/2040560/how-to-find-number-of-days-between-two-dates-using-php)

我不想知道如何做到这一点。我想知道为什么它没有给出预期的结果。

我尝试使用以下代码计算格式为 YYYY-mm-dd 的两个日期之间的天数：

```
$day1 = strtotime($_REQUEST['start']);
$day2 = strtotime($_REQUEST['end']);

$nbOfDays = $day2 - $day1;
$nbOfDays = ceil($nbOfDays/60/60/24);

echo $nbOfDays; 
```

问题是当我计算 2012-12-01 和 2012-12-31 之间的差异时，它给了我 30 天（应该是 31 天），而 2012-11-01 和 2012-11-30 之间的差异也是 30 天（即是正确的！）

更新纯信息：

我不得不修改这段代码（感谢贾斯汀）：

```
$day1 = new DateTime($_REQUEST['start']);
$day2 = new DateTime($_REQUEST['end']);
$interval = round(abs($day2->format('U') - $day1->format('U')) / (60*60*24));
echo $interval; 
```

为了 ：

```
$day1 = new DateTime($_REQUEST['start']);
$day2 = new DateTime($_REQUEST['end']);
$nb1 = $day2->format('U');
$nb2 = $day1->format('U');
$interval = round(abs($nb1 - $nb2) / (60*60*24));
echo $interval; 
```

因为

```
$day2->format('U') - $day1->format('U') 
```

等于 0

所以最后，2012-12-31 和 2012-12-01 之间的差异仍然是 30。BUUUTTTT，2012-11-30 和 2012-11-01 之间的差异是 29，所以

```
echo $interval +1; 
```

在任何情况下都给出正确的天数！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T16:03:51.967

您应该使用日期/时间差异[`date_diff()`](http://php.net/manual/function.date-diff.php)或其 OO 等效项。[`DateTime::diff()`](http://php.net/manual/datetime.diff.php)

```
$day1 = new DateTime($_REQUEST['start']);
$day2 = new DateTime($_REQUEST['end']);
$interval = $day1->diff($day2);
echo $interval->format('%d'); 
```

对于 PHP 5.2 版，您可以使用以下内容：

```
$day1 = new DateTime($_REQUEST['start']);
$day2 = new DateTime($_REQUEST['end']);
$interval = round(abs($day2->format('U') - $day1->format('U')) / (60*60*24));
echo $interval; 
```

对于 5.2 之前的 PHP 版本，使用[`strtotime()`](http://us3.php.net/manual/en/function.strtotime.php)上述公式：

```
$day1 = strtotime($_REQUEST['start']);
$day2 = strtotime($_REQUEST['end']);
$interval = round(abs($day2 - $day1) / (60*60*24));
echo $interval; 
```

# html - 子菜单在触摸设备上单击之前消失

> ID：13956303
> 
> 赞同：2
> 
> 时间：2012-12-19T16:01:39.210
> 
> 标签：html, menu, touch, submenu, twitter-bootstrap-2

当尝试使用 bootstrap 2.2.2 点击子菜单时，子菜单会在被触摸设备（如 iPhone 或 iPad）点击之前消失。有人可以看看我的代码并告诉我为什么吗？

我认为这应该在最新版本中得到修复，所以我想我的代码中可能遗漏了一些东西。

菜单代码：

```
<!-- navbar -->
      <div class="navbar navbar-inverse">
        <div class="navbar-inner">
          <div class="container">
            <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </a>
            <a class="brand" href="../home.html">TobyFCU</a>
            <div class="nav-collapse collapse">
              <ul class="nav">
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Membership<b class="caret"></b></a>
                  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                    <li class="dropdown-submenu"><a tabindex="-1" href="#"><strong>Member Benefits &amp; Services</strong></a>
                      <ul class="dropdown-menu">
                        <li><a tabindex="-1" href="membership/benefitsandservices/55plusclub.html">55 Plus Club</a></li>
                        <li><a tabindex="-1" href="membership/benefitsandservices/billpay.html">Bill Pay</a></li>
                        <li><a tabindex="-1" href="#">Direct Deposit</a></li>
                        <li><a tabindex="-1" href="membership/benefitsandservices/foreigncurrency.html">Foreign Currency Exchange</a></li>
                        <li><a tabindex="-1" href="membership/benefitsandservices/notary.html">Notary</a></li>
                        <li><a tabindex="-1" href="membership/benefitsandservices/onlinebanking.html">Online Banking</a></li>
                        <li><a tabindex="-1" href="#">Payroll Deduction</a></li>
                        <li><a tabindex="-1" href="#">Toby 24</a></li>
                        <li><a tabindex="-1" href="#">TextME (SMS Banking)</a></li>
                        <li><a tabindex="-1" href="#">Western Union Quick Cash</a></li>
                        <li><a tabindex="-1" href="#">Wire Transfer</a></li>
                        <li><a tabindex="-1" href="#">Toby Rewards</a></li>
                        <li><a tabindex="-1" href="#">Other Benefits</a></li>
                      </ul>
                    </li>
                    <li><a href="#"><strong>How to Join</strong></a></li>
                    <li><a href="#"><strong>SEGs</strong> <small>(<strong>S</strong>elect <strong>E</strong>mployer <strong>G</strong>roups)</small></a></li>
                    <li><a href="#"><strong>Toby Rewards</strong></a></li>
                  </ul>
              </li>
              <li class="divider-vertical"></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Personal<b class="caret"></b></a>
                  <ul class="dropdown-menu"role="menu" aria-labelledby="dLabel">
                    <li class="dropdown-submenu"><a tabindex="-1" href="#"><strong>Loans</strong></a>
                      <ul class="dropdown-menu">
                        <li><a tabindex="-1" href="personal/loans/signatureloans.html">Signature Loans</a></li>
                        <li><a tabindex="-1" href="personal/loans/vehicleloans.html">Vehicle Loans</a></li>
                        <li><a tabindex="-1" href="personal/loans/mortgages.html">Mortgages</a></li>
                        <li><a tabindex="-1" href="#">Home Equity</a></li>
                        <li><a tabindex="-1" href="#">Education Loans</a></li>
                        <li><a tabindex="-1" href="#">Share Certificate Secured Loan</a></li>
                        <li><a tabindex="-1" href="#">Share Secured Loan</a></li>
                        <li><a tabindex="-1" href="#">Additional Loans</a></li>
                        <li><a tabindex="-1" href="#">Loan Insurance</a></li>
                      </ul>
                    </li>
                    <li><a href="#"><strong>Share Draft Checking</strong></a></li>
                    <li class="dropdown-submenu"><a tabindex="-1" href="#"><strong>Savings & CDs</strong></a>
                      <ul class="dropdown-menu">
                        <li><a tabindex="-1" href="#">Share Savings</a></li>
                        <li><a tabindex="-1" href="#">Flex/Sub Account</a></li>
                        <li><a tabindex="-1" href="#">Club Accounts</a></li>
                        <li><a tabindex="-1" href="#">Money Market</a></li>
                        <li><a tabindex="-1" href="personal/savingsandcds/sharecertificates.html">Share Certificates</a></li>
                        <li><a tabindex="-1" href="#">IRA Certificate</a></li>
                        <li><a tabindex="-1" href="#">IRA (Traditional & Roth)</a></li>
                        <li><a tabindex="-1" href="#">Certificates</a></li>
                      </ul>
                    </li>
                    <li><a href="#"><strong>Credit Card</strong></a></li>
                    <li class="dropdown-submenu"><a tabindex="-1" href="#"><strong>Youth</strong></a>
                      <ul class="dropdown-menu">
                        <li><a tabindex="-1" href="#">Student Loans</a></li>
                        <li><a tabindex="-1" href="#">Youth Checking</a></li>
                        <li><a tabindex="-1" href="#">Youth Visa Check Card</a></li>
                        <li><a tabindex="-1" href="#">Student Visa Credit Card</a></li>
                        <li><a tabindex="-1" href="#">Toby's Troops</a></li>
                        <li><a tabindex="-1" href="#">Toby Teens</a></li>
                      </ul>
                    </li>
                    <li class="dropdown-submenu"><a tabindex="-1" href="#"><strong>Retirement</strong></a>
                      <ul class="dropdown-menu">
                        <li><a tabindex="-1" href="#">Investment Services</a></li>
                        <li><a tabindex="-1" href="#">IRAs</a></li>
                        <li><a tabindex="-1" href="#">55 Plus Club</a></li>
                      </ul>
                    </li>
                    <li><a href="#"><strong>ATMs</strong></a></li>
                    <li><a href="#"><strong>Rates</strong></a></li>
                    <li class="nav-header">24 Hour Services</li>
                    <li class="divider"></li>
                    <li><a href="#">Online Banking</a></li>
                    <li><a href="#">Toby24</a></li>
                    <li><a href="#">TextME</a></li>
                    <li><a href="#">Deluxe Personal Checks Reorder</a></li>
                    <li><a href="#">ATMs</a></li>
                  </ul>
              </li>
              <li class="divider-vertical"></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Business<b class="caret"></b></a>
                  <ul class="dropdown-menu"role="menu" aria-labelledby="dLabel">
                    <li><a href="#"><strong>Loans</strong></a></li>
                    <li><a href="#"><strong>Share Draft Checking</strong></a></li>
                    <li><a href="#"><strong>Share Savings</strong></a></li>
                    <li><a href="#"><strong>Credit Card</strong></a></li>
                    <li><a href="#"><strong>Certificates</strong></a></li>
                    <li class="dropdown-submenu"><a tabindex="-1" href="#"><strong>Services</strong></a>
                      <ul class="dropdown-menu">
                        <li><a tabindex="-1" href="#">Merchant Services</a></li>
                        <li><a tabindex="-1" href="#">Payroll Services</a></li>
                      </ul>
                    </li>
                    <li><a href="#"><strong>Rates</strong></a></li>
                    <li class="nav-header">24 Hour Services</li>
                    <li class="divider"></li>
                    <li><a href="#">Online Banking</a></li>

                    <li><a href="#">Toby24</a></li>
                    <li><a href="#">TextME</a></li>
                    <li><a href="#">Deluxe Personal Checks Reorder</a></li>
                    <li><a href="#">ATMs</a></li>
                  </ul>
              </li>
              <li class="divider-vertical"></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">About Us<b class="caret"></b></a>
                  <ul class="dropdown-menu"role="menu" aria-labelledby="dLabel">
                    <li><a href="#"><strong>Our Company</strong></a></li>
                    <li><a href="#"><strong>Careers</strong></a></li>
                    <li><a href="#"><strong>Blog</strong></a></li>
                    <li><a href="#"><strong>Locations</strong></a></li>
                  </ul>
              </li>
              <li class="divider-vertical"></li>
              <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contact Us<b class="caret"></b></a>
                  <ul class="dropdown-menu"role="menu" aria-labelledby="dLabel">
                    <li><a href="#"><strong>Contact Information</strong></a></li>
                    <li><a href="#"><strong>Locations</strong></a></li>
                    <li><a href="#"><strong>ATMs</strong></a></li>
                  </ul>
              </li>
              <li class="divider-vertical"></li>
              </ul>
            </div><!--/.nav-collapse -->
          </div>
        </div>
      </div>  <!-- /navbar --> 
```

# jquery - 可手动加载时触发的事件

> ID：13956306
> 
> 赞同：3
> 
> 时间：2012-12-19T16:01:46.387
> 
> 标签：jquery, events, handsontable, event-triggers

[在handsontable](http://handsontable.com)完成加载/初始化 后，我正在尝试进行一些DOM 操作。

handsontable 是否有一些在它完成自身构建后触发的事件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-06-27T13:17:36.127

无需再更改代码，因为为此内置了事件：

`afterInit ()`- Handsontable 实例启动后触发的回调。

`afterLoadData ()`- 将新数据（通过 loadData 方法）加载到数据源数组后触发回调。

`afterRender ()`- 渲染 Handsontable 表后触发的回调。

有关活动的完整列表，[请参见此处](https://github.com/warpech/jquery-handsontable/wiki/Events)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T17:13:58.603

[我在他们的github](https://github.com/warpech/jquery-handsontable/blob/master/README.md#options)上找不到任何这样的回调，而且我认为你真的不需要一个。只需在调用`$("#container").handsontable()`. 如果是因为您使用 ajax 加载它，只需在完成时调用它。只需[在此处](http://handsontable.com/demo/ajax.html)按照他们的示例进行操作。
[`if (source === 'loadData') {...}`]

但是，如果您能够应对挑战，并且根据您下载的版本，我们可以深入研究源代码并自己进行一些调整，因为它相当简单。我假设您在handsontable 完成初始化而没有任何ajax 负载的情况下要求回调。

跟着我，让我们潜入水中。

* * *

## 改变在`jquery.handsontable.full.js`

对了，就是这样，在设置之后，就在网上`2165`说：

```
$.fn.handsontable = function (action) {...}; 
```

在那里，我们知道一切都已初始化，幸运的是，开发人员很好地评论并正确标记了他的东西，所以让我们看看里面的行。

网上`2182`说：

```
instance = new Handsontable.Core($this, currentSettings); 
```

那里是他们初始化核心内容的地方，至少我可以从名字中看出这一点，所以在这一行之后添加一个回调就足以作为一个`afterInit`回调。

因此，我们需要做的就是在用户提供的设置中添加一个回调检查，然后调用它。我决定在行之后添加这个回调，`2184`因为它是在实例化之后。
[你可以争论我把回调放在哪里，它是否应该在`Core`函数内部，以及我如何检查设置是否是一个函数等，但这可以完成工作，而且这样更容易。]

于是，上线`2182`

```
[...] 
instance = new Handsontable.Core($this, currentSettings); //<---- line 2182
$this.data("handsontable", instance);
instance.init(); //<---- line 2184

if(typeof(currentSettings.afterInit) == "function"){
    currentSettings.afterInit();
}
[...] 
```

在那里，这就是我们需要做的一切！现在我们可以创建一个带有`afterInit`回调函数的handsontable。

```
$("#container").handsontable({
    startRows: 8,
    startCols: 6,
    rowHeaders: true,
    colHeaders: true,
    minSpareRows: 1,
    contextMenu: true,
    afterInit: function(){
        console.log("Handsontable initialized!");
    }
}); 
```

不要害怕弄乱源代码，你会学到很多东西！

* * *

## 完成修改后的代码

这是从行开始`2165`到`2203`包含`$.fn.handsontable`函数的完整更改代码：

```
$.fn.handsontable = function (action) {
  var i, ilen, args, output = [], userSettings;
  if (typeof action !== 'string') { //init
    userSettings = action || {};
    return this.each(function () {
      var $this = $(this);
      if ($this.data("handsontable")) {
        instance = $this.data("handsontable");
        instance.updateSettings(userSettings);
      }
      else {
        var currentSettings = $.extend(true, {}, settings), instance;
        for (i in userSettings) {
          if (userSettings.hasOwnProperty(i)) {
            currentSettings[i] = userSettings[i];
          }
        }
        instance = new Handsontable.Core($this, currentSettings);
        $this.data("handsontable", instance);
        instance.init();
        if(typeof(currentSettings.afterInit) == "function"){
            currentSettings.afterInit();
        }
      }
    });
  }
  else {
    args = [];
    if (arguments.length > 1) {
      for (i = 1, ilen = arguments.length; i < ilen; i++) {
        args.push(arguments[i]);
      }
    }
    this.each(function () {
      output = $(this).data("handsontable")[action].apply(this, args);
    });
    return output;
  }
}; 
```

# c++ - IWebBrowser2::Navigate2 错误处理

> ID：13956307
> 
> 赞同：0
> 
> 时间：2012-12-19T16:01:49.490
> 
> 标签：c++, com, error-handling, iwebbrowser2

处理错误的正确方法是什么？我有如下代码，处理我在 MSDN 上找到的所有错误代码，但有时我收到错误“未知”。

```
HRESULT hr = pwb->Navigate2(&URL, &Flag, &TargetFrameName, &PostData, &Headers);
if(FAILED(hr))
{
    std::string message("Navigate2 failed with reason: ");
    switch(hr)
    {
        // The operation was successful.
        case S_OK:
            message.append("S_OK");
            break;
        // One or more parameters are invalid.
        case E_INVALIDARG:
            message.append("E_INVALIDARG");
            break;
        // Out of memory.
        case E_OUTOFMEMORY:
            message.append("E_OUTOFMEMORY");
            break;
        // The operation failed.
        case E_FAIL:
            message.append("E_FAIL");
            break;
        case E_ACCESSDENIED:
            message.append("E_ACCESSDENIED");
            break;
        case E_POINTER:
            message.append("E_POINTER");
            break;
        case E_UNEXPECTED:
            message.append("E_UNEXPECTED");
            break;
        default:
            message.append("Unknown");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T07:41:37.623

如何处理 COM 错误有很多变化。策略包括使用级联`if SUCCEEDED()`或集中式函数错误处理`goto on FAILED()`等。[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ff485842%28v=vs.85%29.aspx)上有一些很好的信息。

至于解释错误代码，`FormatMessage()`通常会使您的工作更轻松 - 这是[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687061%28v=vs.85%29.aspx)的一个示例（为了清楚起见，包括在下面）

[来源： http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms687061(v=vs.85).aspx]](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687061(v=vs.85).aspx])

```
 #include <stdio.h>
    #include <windows.h>
    #include <tchar.h>

    void ErrorDescription(HRESULT hr) 
    { 
         if(FACILITY_WINDOWS == HRESULT_FACILITY(hr)) 
             hr = HRESULT_CODE(hr); 
         TCHAR* szErrMsg; 

         if(FormatMessage( 
           FORMAT_MESSAGE_ALLOCATE_BUFFER|FORMAT_MESSAGE_FROM_SYSTEM, 
           NULL, hr, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), 
           (LPTSTR)&szErrMsg, 0, NULL) != 0) 
         { 
             _tprintf(TEXT("%s"), szErrMsg); 
             LocalFree(szErrMsg); 
         } else 
             _tprintf( TEXT("[Could not find a description for error # %#x.]\n"), hr); 
    } 
```

在上面的调用中，标志表明 Windows 将为错误消息分配内存（您必须自由使用`LocalFree()`），并且它将在系统消息表（`FORMAT_MESSAGE_FROM_SYSTEM`）中查找错误消息。有时，（或通常取决于您使用的库类型） - 在系统消息表中找不到相应的错误描述。

在这种情况下，您可以自己处理错误描述（如您在示例中所做的那样）或尝试直接加载库的消息表。为此，请使用`FORMAT_MESSAGE_FROM_HMODULE`并提供模块句柄作为函数的`lpSource`参数`FormatMessage()`。

这是一个例子：

```
std::wstring StackExample::getLastError( HRESULT hr ) 
{
    LPWSTR lpMsgBuf;
    DWORD ret;
    std::wstring def(L"(UNKNOWN)");
    ret = FormatMessage(
        FORMAT_MESSAGE_ALLOCATE_BUFFER | 
        FORMAT_MESSAGE_FROM_HMODULE,
        GetModuleHandle(TEXT("imapi2.dll")),
        hr,
        0,
        (LPWSTR) &lpMsgBuf,
        0, NULL );

    if(ret)
    {
        std::wstring last(lpMsgBuf);
        LocalFree(lpMsgBuf);
        return last;
    }
    return def;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T06:47:48.443

`HRESULT`错误代码实际上是`LONG`带有具有单独含义的位块的类型。也就是说，处理`switch`语句中的每个错误是不现实的。

如果你对特定的错误代码有特定的处理，你就去做。否则，您通常使用[`SUCCEEDED`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms687197%28v=vs.85%29.aspx)和`FAILED`宏检查返回的成功/失败：

```
if(FAILED(nResult))
{
  // TODO: Handle the failed operation here
} 
```

另请参阅：[COM 中的错误代码](http://msdn.microsoft.com/en-us/library/windows/desktop/ff485841%28v=vs.85%29.aspx)：

> 要检查 COM 方法是否成功，请检查返回的 HRESULT 的高位。Windows SDK 标头提供了两个使这更容易的宏：SUCCEEDED 宏和 FAILED 宏。如果 HRESULT 是成功代码，SUCCEEDED 宏返回 TRUE，如果是错误代码，则返回 FALSE。

# c# - 找到 TrustAnchor，但证书验证失败

> ID：13956309
> 
> 赞同：3
> 
> 时间：2012-12-19T16:01:52.300
> 
> 标签：c#, bouncycastle

我创建一个这样的根证书：

```
public static Org.BouncyCastle.X509.X509Certificate GenerateRootCert(AsymmetricCipherKeyPair pair, System.Security.Cryptography.AsymmetricAlgorithm caKeyy)
{
    Org.BouncyCastle.X509.X509V3CertificateGenerator certGen = new Org.BouncyCastle.X509.X509V3CertificateGenerator();
    certGen.SetSerialNumber(BigInteger.One);
    certGen.SetIssuerDN(new X509Name("cn=Autorite1,ou=DC,o=A1"));                          

    certGen.SetNotBefore(DateTime.Today.Subtract(new TimeSpan(1, 0, 0, 0)));
    certGen.SetNotAfter(DateTime.Today.Add(new TimeSpan(10, 0, 0, 0)));
    certGen.SetSubjectDN(new X509Name("cn=Autorite1,ou=DC,o=A1"));
    certGen.SetPublicKey(pair.Public);
    certGen.SetSignatureAlgorithm("SHA1withRSA");

    certGen.AddExtension(X509Extensions.SubjectKeyIdentifier, false, new SubjectKeyIdentifierStructure(pair.Public));
    certGen.AddExtension(X509Extensions.BasicConstraints, false, new BasicConstraints(true));

    Org.BouncyCastle.X509.X509Certificate x509 = certGen.Generate(pair.Private);

    return x509;
} 
```

我像这样创建最终证书：

```
public static void generateEndEntityCert(
                    AsymmetricKeyParameter entityKey,
                    AsymmetricKeyParameter caKey, System.Security.Cryptography.AsymmetricAlgorithm caKeyy,
                    X509Certificate caCert)
{
    X509V3CertificateGenerator certGen = new X509V3CertificateGenerator();

    certGen.SetSerialNumber(BigInteger.Two);
    certGen.SetIssuerDN(new X509Name("cn=Autorite1,ou=DC,o=A1"));
    certGen.SetNotBefore(DateTime.Today.Subtract(new TimeSpan(1, 0, 0, 0)));
    certGen.SetNotAfter(DateTime.Today.Add(new TimeSpan(7, 0, 0, 0)));
    certGen.SetSubjectDN(new X509Name("cn=test,E=test@test.com"));
    certGen.SetPublicKey(entityKey);
    certGen.SetSignatureAlgorithm("SHA256WithRSAEncryption");

    GeneralNames subjectAltName = new GeneralNames(new GeneralName(GeneralName.Rfc822Name, "example@example.org"));

    Org.BouncyCastle.X509.X509Certificate cer = new Org.BouncyCastle.X509.X509Certificate(caCert.CertificateStructure);
    certGen.AddExtension(X509Extensions.AuthorityKeyIdentifier, false, new AuthorityKeyIdentifierStructure(cer));
    certGen.AddExtension(X509Extensions.SubjectKeyIdentifier, false, new SubjectKeyIdentifierStructure(entityKey));
    certGen.AddExtension(X509Extensions.BasicConstraints, false, new BasicConstraints(true)); certGen.AddExtension(X509Extensions.KeyUsage, false, new KeyUsage(KeyUsage.NonRepudiation));
    Org.BouncyCastle.X509.X509Certificate x509 = certGen.Generate(caKey);
} 
```

我将使用两次证书（根和端）创建一个路径证书，如下所示：

```
public static IEnumerable<X509Certificate> BuildCertificateChainBC(byte[] primary, IEnumerable<byte[]> additional)
{
    X509CertificateParser parser = new X509CertificateParser();
    PkixCertPathBuilder builder = new PkixCertPathBuilder();

    // Separate root from itermediate
    List<X509Certificate> intermediateCerts = new List<X509Certificate>();
    HashSet rootCerts = new HashSet();

    foreach (byte[] cert in additional)
    {
        Org.BouncyCastle.X509.X509Certificate x509Cert = parser.ReadCertificate(cert);

        // Separate root and subordinate certificates
        if (x509Cert.IssuerDN.Equivalent(x509Cert.SubjectDN))
            rootCerts.Add(new TrustAnchor(x509Cert, null));
        else
            intermediateCerts.Add(x509Cert);
    }

    // Create chain for this certificate
    X509CertStoreSelector holder = new X509CertStoreSelector();
    holder.Certificate = parser.ReadCertificate(primary);

    // WITHOUT THIS LINE BUILDER CANNOT BEGIN BUILDING THE CHAIN
    intermediateCerts.Add(holder.Certificate);

    PkixBuilderParameters builderParams = new PkixBuilderParameters(rootCerts, holder);
    builderParams.IsRevocationEnabled = false;

    X509CollectionStoreParameters intermediateStoreParameters =
        new X509CollectionStoreParameters(intermediateCerts);

    builderParams.AddStore(X509StoreFactory.Create("Certificate/Collection", intermediateStoreParameters));
    PkixCertPathBuilderResult result = builder.Build(builderParams); //<-- the exception here

    return result.CertPath.Certificates.Cast<Org.BouncyCastle.X509.X509Certificate>();
} 
```

我生成了错误的证书？因为我有这个异常：`TrustAnchor found but certificate validation failed.` 内部异常的值：`Public key presented not for certificate signature`

# jquery - 回答 JQuery 对话框时 Javascript 未执行

> ID：13956314
> 
> 赞同：10
> 
> 时间：2012-12-19T16:02:01.300
> 
> 标签：jquery, jquery-ui, jquery-dialog

我的页面上有一个使用 JQuery Dialog Widget 制作的对话框。我已经设置了两个按钮，使其具有单击页面上不同按钮的功能，这些按钮将触发页面的回发并执行各种操作。当对话框为**modal: false**时，对话框会执行相关的**clickButton**函数，然而，当我设置**modal: true**时，按钮不会被点击，虽然该函数被输入了。

我想我错过了关于执行与按钮相关的功能的**modal: true的一些内容。**

下面是我的javasript

```
 function displayQuoteToCashMessage() {
        //this is where we do that alert for the QuoteToCash request stuff
        $("#<%=divQuoteToCashAlert.ClientId %>").show();
        $("#<%=divQuoteToCashAlert.ClientId %>").dialog({
            modal: false,
            resizable: false,
            buttons: {
                "Ok": function () {
                    //save confirmations
                    clickButton(true);
                    $(this).dialog("close");
                },
                "No": function() {
                    clickButton(false);
                    $(this).dialog("close");
                }
            }
        });        
    }

    function clickButton(b) {
        //do something with b
        document.getElementById(btnSave).click()
    }; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:05:48.340

*Modal 阻止了覆盖层本身以及其下方的任何 DOM事件*上的各种事件/和操作。`clickButton()`但是像你这样的常规函数​​调用：**很好**，如果你在该函数的开头放置一个警报，你会看到它到达那里。

**您遇到的问题是，您正在尝试与`click`模态下方的 DOM 元素进行交互（*这是此处被拒绝的内容*）**

```
// It gets here without a problem
function clickButton(b) {

    // But this event here is what *modal* is preventing.
    document.getElementById(btnSave).click();
} 
```

我总是做的是*先*关闭对话框，**然后**执行任何外部脚本（特别是如果我知道它们试图触发 dom 事件）。通过这样做，您将没有任何问题。

**[jsFiddle 演示](http://jsfiddle.net/keRwn/)**

```
buttons: {
  "Ok": function () {

     $(this).dialog('close');

     // now wait a 100 ms for it to fully close 
     // this is mainly for the slow browsers, "just in case" really

     setTimeout(function () {
        clickButton(); // now we call your function (knowing the modal is gone)
     }, 100);
   }
} 
```

这个微小的延迟只是以防万一，不引人注意，并且可以让您运行您的功能，同时保持`modal:true`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T16:19:48.527

尝试[关闭](http://api.jqueryui.com/dialog/#event-close)事件：

```
var okButtonWasClicked = false;
$( "#<%=divQuoteToCashAlert.ClientId %>" ).dialog({ 
    buttons: {
        "Ok": function () {
            okButtonWasClicked = true;
            $(this).dialog("close");
        },
        "No": function() {
            okButtonWasClicked = false;
            $(this).dialog("close");
        }
    },
    close: function() {
        if(okButtonWasClicked) {
           clickButton(true);
        } else {
            clickButton(false);
        }
}); 
```

# spring - 如何在 Grails 中动态选择服务

> ID：13956316
> 
> 赞同：10
> 
> 时间：2012-12-19T16:02:06.447
> 
> 标签：spring, grails, dependency-injection, grails-2.0

从我的控制器中，我想根据参数动态选择服务。

目前我有一个基础服务和一些其他服务来扩展这个基础服务。基于参数，我调用了一个类，该类确实基于参数创建了一个 bean 名称，并最终调用以下内容：

```
import org.codehaus.groovy.grails.web.context.ServletContextHolder as SCH
import org.codehaus.groovy.grails.web.servlet.GrailsApplicationAttributes as GA

class Resolver {
    def ctx

def getBean(String beanName) {
    if(!ctx) {
        ctx = SCH.servletContext.getAttribute(GA.APPLICATION_CONTEXT)
    }
    return ctx."${beanName}"
} 
```

}

这将返回我想要的服务。但是我觉得这样做很脏。有没有人有更好的方法来处理基于某些参数获取服务（或任何其他 bean）？

谢谢你。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-19T16:29:53.327

`ctx."${beanName}"`被添加到`ApplicationContext`元类中，因此您可以执行`def userService = ctx.userService`. 这只是一个快捷方式，`ctx.getBean('userService')`因此您可以将代码更改为

```
return ctx.getBean(beanName) 
```

它会是一样的，但不那么神奇。

由于您是从控制器或服务调用它，我会跳过这些`ServletContextHolder`东西并通过依赖注入`grailsApplication`bean ( `def grailsApplication`) 并通过`def ctx = grailsApplication.mainContext`. 然后将它传递给这个助手类（记住 Spring 的大范式是依赖注入，而不是老式的依赖拉取），然后它就会很简单

```
class Resolver {
   def getBean(ctx, String beanName) {
      ctx.getBean(beanName)
   }
} 
```

但是它是如此简单，以至于我根本不会打扰助手类:)

# java - 替换android默认sqlite构建

> ID：13956322
> 
> 赞同：3
> 
> 时间：2012-12-19T16:02:14.523
> 
> 标签：java, android, sqlite, wrapper

我想用启用[rtree](http://www.sqlite.org/rtree.html)功能的新版本替换 android 默认 sqlite 版本。看起来我必须使用 java 包装器来实现这一点，而我发现与 android 兼容的唯一一个是[sqlite4java](http://code.google.com/p/sqlite4java/)。我更喜欢坚持标准。不幸的是，我发现 dalvikvm (Androids VM) 不支持 jdbc，并且本机 android.database.sqlite 可与禁用 rtree 的 sqlite 构建一起使用。

目前我有一个为android编译的新的.so sqlite rtree启用库，但想替换androids原生库，而不必使用像sqlite4java这样的第三方包装器。有任何想法吗？我正在考虑从 android sdk 下载 android.database.sqlite 包并构建一个 jar 以仅替换 .so 加载与我的应用程序上下文。这是最好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T16:31:06.293

> 我正在考虑从 android sdk 下载 android.database.sqlite 包并构建一个 jar 以仅替换 .so 加载与我的应用程序上下文。这是最好的方法吗？

只要您愿意将所有必要的类重构到您自己的包中，那可能是您唯一的方法。例如，这就是适用于 Android 的 SQLCipher 所做的。他们克隆[了大约 37 个类`android.database`并`android.database.sqlite`](https://github.com/sqlcipher/android-database-sqlcipher/tree/master/src/net/sqlcipher)对其进行了修改，以使用他们自己的支持 SQLCipher 的 SQLite 构建。

# javascript - 为什么页面上已经加载的图像会再次加载？

> ID：13956324
> 
> 赞同：-1
> 
> 时间：2012-12-19T16:02:21.690
> 
> 标签：javascript, jquery, css, http-status-code-304

我正在使用删除和替换 dom 中图像的 src

```
$('.myImg').attr('src',imgURL); 
```

我正在尝试将其与加载事件一起使用。我预计只有在页面上尚未加载 imgURL 时才会触发 load 事件。

相反，有时会触发加载事件。我可以在 chrome 网络选项卡中看到图像何时以 304 Not Modified 状态返回。

我知道如何解决这个问题，但我只是好奇这是否正常。

我想表达这个问题的最佳方式是什么会导致**浏览器**再次尝试加载已经加载到页面上的图像？有一个缓存杀手，但是在我再次显示图像之前它没有被更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:05:55.860

`304`不是“永远不要再加载这个！”的某种诫命。这只是对客户端缓存系统的建议，不需要重新加载。基于它的内部算法，自然会在不同的实现中有所不同，它可能会选择加载资源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:08:50.667

尝试使用

```
$(window).load(function () {
  // run code
}); 
```

只有在加载 dom 树和图形时才会触发该函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-24T16:46:55.500

问题最终是我在我的开发人员工具中检查了“禁用缓存”:-)

# joomla - Joomla！2.5 检查不推荐使用的类/方法的代码

> ID：13956338
> 
> 赞同：2
> 
> 时间：2012-12-19T16:03:08.473
> 
> 标签：joomla, joomla2.5

如何检查已弃用的 Joomla！API 代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:03:08.473

**这是在开发机器上完成的，而不是在生产网站上！**

检查弃用代码的最基本方法是启用**系统调试插件**并启用**选项“记录弃用的 API”。**

![记录弃用的 API](../Images/08338941d2757f04997abc5d2cb0c08d.png)

在 logs/deprecated.php 之后，您将找到这些条目。

现在，将记录大量已弃用的代码，您需要在代码中识别它们。

* * *

一个补充选项是使用像 Eclipse + PDT 这样的 IDE，您可以在编码时获取此信息：

![在此处输入图像描述](../Images/c0a032e1e3d15733a14e60b017cc787a.png)

# jquery - 放置在内的图片宽度

> ID：13956342
> 
> 赞同：0
> 
> 时间：2012-12-19T16:03:16.960
> 
> 标签：jquery, image, html, resizable

在调整图片大小时，我希望将图片宽度添加到 <div id="w" ></div>，我尝试了以下方法，有人可以帮忙吗？谢谢你：

```
<script>
$(document).ready(
function() {
    $( "#resizable" ).resizable({
         resize: select_function
    });
});
var select_function = function(event, ui)
{
    $("#w").text($( "#resizable" ).attr("width"));
};

</script>
 <div id="w">Test</div>
<img border="0" id="resizable" src="picture.png"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:06:04.643

你没有`width=""`属性。

要获取元素的实际宽度，请调用`$( "#resizable" ).width()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:13:40.333

您是否尝试过像这样获取图像的宽度？

```
$("#w").html($( "#resizable" ).width()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:17:21.673

您要么需要向标签添加`width`属性。`img`

```
<img border="0" id="resizable" src="picture.png" width="500px"> 
```

或者您需要使用内置的 JQuery`width()`函数。

```
$( "#resizable" ).width(); 
```

我建议查看[.width()](http://api.jquery.com/width/)和[.attr()](http://api.jquery.com/attr/)上的 JQuery 文档以获得更好的理解。

# php - jQuery Mobile 更新不带哈希的可见 URL

> ID：13956343
> 
> 赞同：1
> 
> 时间：2012-12-19T16:03:17.433
> 
> 标签：php, jquery, mysql, ajax, jquery-mobile

那么，这个问题存在[于 jQuery Mobile 中的 $.mobile.changePage - 更新可见 URL？](https://stackoverflow.com/questions/6412533/mobile-changepage-in-jquery-mobile-update-visible-url)但它没有解决我的问题。

我正在使用 PHP 和 MySQL 开发一个相当大的 JQM 站点，但是我对 JQM 的理解遇到了一些限制。

那么发生了什么？好吧（查看我帖子中的最后一段代码），导航到 page1.html 然后从下拉列表中选择 page2.html 只会将 #p 更改为“page2.html”并且不会更新页面的页眉、内容或页脚“1”到“2”。

我已经完成了我认为关闭 ajax 的操作，但它仍然将 #page2.html 附加到 URL ...

我已经阅读 JQM Docs 并在 Google 上搜索了 2 天。在这方面我绝对没有运气，我很感激你的任何见解。

以下代码完美运行（我很抱歉在这里发布整个 HTML...我目前无法访问 pastebin），页面转换非常漂亮，但它不适合我的需要，因为我需要大约 40页面并将它们全部放在一个包含所有 MySQL 调用的文件中会很疯狂，特别是因为用户在一个会话中可能只使用其中的 10 个页面，从而使其他 30 个页面的加载毫无意义、时间和数据消耗。

```
<!DOCTYPE html> 
<html> 
<head> 
    <title>Index Page</title> 
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>

    <script type="text/javascript">
    $(document).bind("pageinit", function(e) {  
        $("#nav").on("change", function(e) {
            $.mobile.changePage($(this).val());
        });
    });
    </script>

    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
</head> 
<body> 

<div id="page1" data-role="page" data-theme="c">

    <div data-role="header" data-theme="a">
        <h1>Header 1</h1>
    </div><!-- /header -->

    <div data-role="content">   
        <p>Content 1</p>
    </div><!-- /content -->

    <div data-role="footer" data-theme="b">
        <h1>Footer 1</h1>
        <select id="nav" data-native-menu="false">
            <option value="page1.html">Page 1</option>
            <option value="page2.html">Page 2</option>
        </select>
    </div><!-- /header -->

</div><!-- /page -->

<div id="page2" data-role="page" data-theme="c">

    <div data-role="header" data-theme="a">
        <h1>Header 2</h1>
    </div><!-- /header -->

    <div data-role="content">   
        <p>Content 2</p>
    </div><!-- /content -->

    <div data-role="footer" data-theme="b">
        <h1>Footer 2</h1>
        <select id="nav" data-native-menu="false">
            <option value="page1.html">Page 1</option>
            <option value="page2.html">Page 2</option>
        </select>
    </div><!-- /header -->

</div><!-- /page -->

</body>
</html> 
```

正如我所说，我正在开发的内容将相当大，因此在未来创建和编辑时允许链接并保持理智，我要求每个页面都位于其自己的 PHP 文件中。

我模拟了每个页面的预期结果示例：

## page1.html

```
<!DOCTYPE html> 
<html> 
<head> 
    <title>Page 1</title> 
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>

    <script type="text/javascript">
    $(document).bind("mobileinit", function(){
        $.mobile.ajaxEnabled = false;
        $.mobile.pushStateEnabled = false;
    });

    $(document).bind("pageinit", function(e) {
        $("#nav").on("change", function(e) {
            $("#p").html($(this).val());
            $.mobile.changePage($(this).val());
        });
    });
    </script>

    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>

</head> 
<body> 

<div data-role="page" data-theme="c">
    <div data-role="header" data-theme="a">
        <h1>Header 1</h1>
    </div><!-- /header -->

    <div data-role="content">   
        <p>Content 1</p>
        <div id="p">placeholder</div>
    </div><!-- /content -->

    <div data-role="footer" data-theme="b">
        <h1>Footer 1</h1>
        <select id="nav" data-native-menu="false">
            <option value="">SELECT</option>
            <option value="page1.html">Page 1</option>
            <option value="page2.html">Page 2</option>
        </select>
    </div><!-- /header -->

</div><!-- /page -->

</body>
</html> 
```

page2.html与**page1.html**完全相同，只是它的页眉、内容和页脚都用“2”而不是“1”。

另一方面，该站点需要登录。在 index.php 成功登录后（使用提交给自身的表单）PHP 使用 header() 重定向到内部页面（假设为 inner.php）。但在此重定向之后，用户显示来自 inner.php 的内容，URL 仍然显示 index.php。

因此，无论我使用 AJAX 还是 PHP 来更改页面，URL 都不会更新......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:09:01.837

您可以对历史记录使用 html5 规范：windowhistory.replaceState(stateObj, "page 2", "bar.html"); Mozilla 提供的信息：[https ://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)

# jsp - Spring JSP 保持缓存

> ID：13956348
> 
> 赞同：0
> 
> 时间：2012-12-19T16:03:39.473
> 
> 标签：jsp, jakarta-ee, servlets, jquery-mobile, spring-mvc

我正在处理的 servlet 有问题。这是一个基于spring框架的移动设备站点，使用Java和JQuery Mobile，部署在weblogic下。我对站点内的应用程序使用相同的 jsp，如果用户角色/登录 - 注销用户等不同，可能会有所不同。如果我登录并单击应用程序的按钮，它看起来正确。假设我提交了一个错误的表单，并且顶部出现了一个带有错误消息的 div。我点击主页，然后如果我退出或没有，然后再次点击按钮，页面被缓存并且仍然显示错误。只有当我在地址栏中输入自己的请求时，控制器才会再次被访问。

知道会有什么问题吗？我尝试使用 no-cache 和其他解决方案来禁用浏览器缓存的 response.setHeader，因为这似乎是问题所在，但似乎没有一个有效。

我的应用程序流程如下：单击主页上的按钮时，请求会调用控制器来验证您是否已登录，然后返回 jsp，如下所示：

```
@RequestMapping(value ="/recharge",method = RequestMethod.GET)
public String render(org.springframework.ui.Model model, HttpServletRequest request, HttpServletResponse response) throws UnsupportedEncodingException {

    ---- do some checks ----

    return "recharge"
    } 
```

然后在加载 jsp 时，它具有知道要显示/隐藏什么所需的参数。如果您在 jsp 上提交，它会转到另一个函数并执行一些操作。，然后返回带有一些url参数的相同jsp。

该应用程序的所有链接如下：

```
<a href = <c:url value="/mobilesite/recharge"/> 
```

这似乎只有当我在 JSP 中提交表单（url 更改）时才会发生。我需要这些参数，所以我不能丢失它们。但是我希望如果用户离开页面并再次单击以转到应用程序，则所有渲染部分都将再次计算。任何想法我怎么能克服这个？

提前致谢 ！

编辑：点击链接时，Firebug 也不会显示请求。

# c# - 如何返回流而不是写入磁盘？

> ID：13956353
> 
> 赞同：5
> 
> 时间：2012-12-19T16:03:59.423
> 
> 标签：c#, openxml-sdk

我正在使用 OpenXML SDK。

OpenXML SDK 创建了一个名为 CreatePackage 的方法，如下所示：

```
public void CreatePackage(string filePath)
{
    using (SpreadsheetDocument package = SpreadsheetDocument.Create(filePath,               SpreadsheetDocumentType.Workbook))
    {
        CreateParts(package);
    }
} 
```

我从我的程序中调用它，如下所示，它将创建 Excel 文件到给定路径：

```
gc.CreatePackage(excelFilePath);
Process.Start(_excelFilePath); 
```

我不确定如何调整代码，使其返回一个显示 Excel 文件的流，而不是让它在磁盘上创建文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:21:04.293

根据[文档，`SpreadsheetDocument.Create`](http://msdn.microsoft.com/en-us/library/documentformat.openxml.packaging.spreadsheetdocument.create.aspx)有多个重载，其中一个需要`Stream`.

所以将您的代码更改为：

```
public void CreatePackage(Stream stream)
{
    using (SpreadsheetDocument package = SpreadsheetDocument.Create(stream,               SpreadsheetDocumentType.Workbook))
    {
        CreateParts(package);
    }
} 
```

然后用任何有效的调用它`Stream`，例如：

```
using(var memoryStream = new MemoryStream())
{
   CreatePackage(memoryStream);
   // do something with memoryStream
} 
```

# sql - SQL - 如何查找正在使用所有最大并发连接的操作

> ID：13956354
> 
> 赞同：8
> 
> 时间：2012-12-19T16:04:01.360
> 
> 标签：sql, sql-server, sql-server-2008

我有一个达到并发连接最大限制的 SQL Server。我有许多不同的服务器和服务同时连接到一个 SQL Server。

我确实找到了另一个似乎有效的查询：

```
SELECT DB_NAME(dbid) AS DBName,
   COUNT(dbid)   AS NumberOfConnections,
   loginame      AS LoginName,
   nt_domain     AS NT_Domain,
   nt_username   AS NT_UserName,
   hostname      AS HostName
FROM   sys.sysprocesses
WHERE  dbid > 0
GROUP  BY dbid,
      hostname,
      loginame,
      nt_domain,
      nt_username
ORDER  BY NumberOfConnections DESC; 
```

但是，这给了我很好的连接数。然后我发现另一个查询似乎吐出了正在运行的 sql 语句等。

```
SELECT
SPID                = er.session_id
,STATUS             = ses.STATUS
,[Login]            = ses.login_name
,Host               = ses.host_name
,BlkBy              = er.blocking_session_id
,DBName             = DB_Name(er.database_id)
,CommandType        = er.command
,SQLStatement       = st.text
,ObjectName         = OBJECT_NAME(st.objectid)
,ElapsedMS          = er.total_elapsed_time
,CPUTime            = er.cpu_time
,IOReads            = er.logical_reads + er.reads
,IOWrites           = er.writes
,LastWaitType       = er.last_wait_type
,StartTime          = er.start_time
,Protocol           = con.net_transport
,ConnectionWrites   = con.num_writes
,ConnectionReads    = con.num_reads
,ClientAddress      = con.client_net_address
,Authentication     = con.auth_scheme
FROM sys.dm_exec_requests er
OUTER APPLY sys.dm_exec_sql_text(er.sql_handle) st
LEFT JOIN sys.dm_exec_sessions ses
ON ses.session_id = er.session_id
LEFT JOIN sys.dm_exec_connections con
ON con.session_id = ses.session_id 
```

我将如何将这两个查询合并在一起？我相信这两个查询一起会给我我需要的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T11:19:06.137

如果连接数是您所关心的，我不太确定除了 sys.dm_exec_connections 之外您还需要了解什么。无论哪种方式，这是我在查看实例上运行的内容时使用的代码，它还向您显示哪个作业正在运行该语句（如果它是一个作业）：

```
SELECT
    SPID                = er.session_id
    , Status             = ses.status
    , [Login]            = ses.login_name
    , Host               = ses.host_name
    , BlkBy              = er.blocking_session_id
    , DBName             = DB_Name(er.database_id)
    , CommandType        = er.command
    , SQLStatement       =
    SUBSTRING
    (
        qt.text,
        er.statement_start_offset/2,
        (CASE WHEN er.statement_end_offset = -1
        THEN LEN(CONVERT(nvarchar(MAX), qt.text)) * 2
        ELSE er.statement_end_offset
        END - er.statement_start_offset)/2
    )
    , sj.name + SUBSTRING(ses.program_name,65,8) JobName
    , ObjectName         = OBJECT_SCHEMA_NAME(qt.objectid,dbid) + '.' + OBJECT_NAME(qt.objectid, qt.dbid)
    , ElapsedMS          = er.total_elapsed_time
    , CPUTime            = er.cpu_time
    , IOReads            = er.logical_reads + er.reads
    , IOWrites           = er.writes
    , LastWaitType       = er.last_wait_type
    , StartTime          = er.start_time
    , Protocol           = con.net_transport
    , transaction_isolation =
    CASE ses.transaction_isolation_level
        WHEN 0 THEN 'Unspecified'
        WHEN 1 THEN 'Read Uncommitted'
        WHEN 2 THEN 'Read Committed'
        WHEN 3 THEN 'Repeatable'
        WHEN 4 THEN 'Serializable'
        WHEN 5 THEN 'Snapshot'
    END
    , ConnectionWrites   = con.num_writes
    , ConnectionReads    = con.num_reads
    , ClientAddress      = con.client_net_address
    , Authentication     = con.auth_scheme
FROM sys.dm_exec_requests er
    LEFT OUTER JOIN sys.dm_exec_sessions ses
        ON ses.session_id = er.session_id
    LEFT OUTER JOIN sys.dm_exec_connections con
        ON con.session_id = ses.session_id
    LEFT OUTER JOIN msdb..sysjobs sj
        ON upper(convert(varchar(34), master.dbo.fn_varbintohexstr(convert(varbinary(16), sj.job_id)))) = LTRIM(RTRIM(SUBSTRING(ses.program_name,29,36)))
    OUTER APPLY sys.dm_exec_sql_text(er.sql_handle) as qt
WHERE er.session_id > 50
ORDER BY
    er.blocking_session_id DESC
    ,er.session_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:56:16.820

不完全确定您想要输出什么；您可以通过直接连接 session_id = spid 将两个查询连接在一起（没有组）。

```
SELECT
spr.loginame as LoginName,
spr.nt_domain     AS NT_Domain,
spr.nt_username   AS NT_UserName,
spr.hostname      AS HostName,

STATUS             = ses.STATUS
,[Login]            = ses.login_name
,Host               = ses.host_name
,BlkBy              = er.blocking_session_id
,DBName             = DB_Name(er.database_id)
,CommandType        = er.command
,SQLStatement       = st.text
,ObjectName         = OBJECT_NAME(st.objectid)
,ElapsedMS          = er.total_elapsed_time
,CPUTime            = er.cpu_time
,IOReads            = er.logical_reads + er.reads
,IOWrites           = er.writes
,LastWaitType       = er.last_wait_type
,StartTime          = er.start_time
,Protocol           = con.net_transport
,ConnectionWrites   = con.num_writes
,ConnectionReads    = con.num_reads
,ClientAddress      = con.client_net_address
,Authentication     = con.auth_scheme
FROM [sys.dm_exec_requests][1] er
OUTER APPLY sys.dm_exec_sql_text(er.sql_handle) st
LEFT JOIN sys.dm_exec_sessions ses
ON ses.session_id = er.session_id
LEFT JOIN sys.dm_exec_connections con
ON con.session_id = ses.session_id
left outer join sys.sysprocesses spr
on er.session_id = spr.spid 
```

# javascript - 模型更新时的主干渲染视图

> ID：13956365
> 
> 赞同：13
> 
> 时间：2012-12-19T16:04:47.170
> 
> 标签：javascript, backbone.js

我正在使用backbone.js 编写一个示例应用程序。

在更新我的模型时，我以这种方式重新渲染我的视图

```
$('.target').html("");
$('.target').append(this.$el.html(this.template(model))) 
```

一旦在模型更新 [on change event] 后重新渲染视图，附加到`el`的孩子的事件就会丢失 [似乎不像是`jQuery`live]。这是一个已知问题还是我错过了什么？我应该尝试替换 html 而不是`append`？[小提琴](http://jsfiddle.net/zBjnj/)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-19T16:15:29.807

一旦视图在 DOM 中，您就不需要继续删除和附加它。我认为管理这个最简单的方法是从视图中完全删除 DOM 插入，并让调用者`view.render`来处理它。

看法：

```
render: function() {
  this.$el.html(this.template(model));
  return this;
} 
```

调用者（在第一次渲染时）：

```
var view = new SomeView();
$('.target').append(view.render().el); 
```

在随后的渲染中：

```
view.render(); 
```

在视图被渲染到 DOM 之后，它可以继续愉快地重新渲染自己，而无需了解任何有关父视图的信息。事件绑定也应该在渲染之间保持不变。

# jquery - 使用 jquery 加载图像：未在 safari 中显示

> ID：13956366
> 
> 赞同：4
> 
> 时间：2012-12-19T16:04:58.287
> 
> 标签：jquery, css, safari

> **可能重复：**
> [图像加载时的 jQuery 回调（即使图像被缓存）](https://stackoverflow.com/questions/3877027/jquery-callback-on-image-load-even-when-the-image-is-cached)

我有一个`#mainImg img`具有`opacity:0;`.

当页面加载时，我触发以下 jQuery 代码：

```
$("#mainImg img").load(function(){ 
   $("#mainImg img").center(); // center everything
   $("#mainImg img").animate({"opacity": "1"}, "400"); // fade the image in
}); 
```

它适用于 firefox/chrome/safari。我使用该`.load()`方法是因为在 webkit 浏览器中，宽度和高度是在图像加载后设置的。

但是当我单击缩略图时尝试加载另一个图像时，该图像在 safari 中不起作用（并且在 chrome 和 firefox 中起作用）。

这是我的缩略图系统代码：

```
$("#th2").click(function() {
    $("#mainImg").html('<img src="' + new_th2_link + '" />');
    $("#mainImg img").load(function(){ 
        $("#mainImg img").center();
        $("#mainImg img").animate({"opacity": "1"}, "400");
    });
}); 
```

在 Safari 中，`#mainImg img`具有`width:0; height:0;`. Safari 是不是太快了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:54:26.430

这是我最终使用的解决方案：

```
$("#mainImg img").animate({"opacity": "1"}, "400");
    setTimeout(function(){
        $("#mainImg img").center()
    }, 10); 
```

适用于 Firefox/Chrome/Safari。

# sql-server - 递归 CTE 中的 TSQL GROUP BY

> ID：13956368
> 
> 赞同：7
> 
> 时间：2012-12-19T16:05:03.357
> 
> 标签：sql-server, tsql, common-table-expression

是否有在循环 CTE 中使用 GROUP BY 的解决方法或有解决方法？

我需要对 CTE 表的结果集进行分组，并在具有相同 CTE 的另一个循环中使用它，但出现以下错误：

> 递归公用表表达式“cte”的递归部分中不允许使用 GROUP BY、HAVING 或聚合函数。

这是查询：

```
WITH cte
    AS
    (
        SELECT
          id,
          dailyconsumption,
          stock/dailyconsumption as cutoff
        FROM items
        WHERE father IS NULL

        UNION ALL

        SELECT
          i.id,
          SUM(father.dailyconsumption*i.num),
          MAX(stock)/SUM(father.dailyconsumption*i.num)
        FROM cte father
        JOIN items i ON father.id=i.father
        group by i.id
    )

SELECT id, MIN(cutoff)
FROM cte
GROUP BY id 
```

[**SQL-Fiddle**](http://sqlfiddle.com/#!3/f4f2a/11)（带有示例数据）

* * *

**编辑...这是逻辑问题**

我有一组最终用户项目（father=NULL）和由许多其他项目（字段父亲和字段 num 填充）组成的其他子项目。我得到了最终用户项目的每日消耗量（我的 cte 以“WHERE 父亲为 NULL”开始），子项目的每日消耗量由 SUM（father.dailyconsumption *item.num）计算。

```
WITH cte AS(
    SELECT
      id,
      dailyconsumption,
      stock/dailyconsumption as cutoff
    FROM items
    WHERE father IS NULL

    UNION ALL

    SELECT
      i.id,
      father.dailyconsumption*i.num
      0
    FROM cte father
    JOIN items i ON father.id=i.father
)

SELECT id, SUM(dailyconsumption)
FROM cte
GROUP BY id 
```

[http://sqlfiddle.com/#!3/f4f2a/95](http://sqlfiddle.com/#!3/f4f2a/95)

通过这个**有效**的查询，我将为所有项目（最终用户和子项目）填充所有日常消费。请注意，父子关系可以超过 1 级。

现在我需要计算截止值（我的库存是多少天）。对于最终用途，它非常容易并且已经在第一个 CTE 中计算出来：**库存/每日消费**。对于子项目，它有点复杂： **subitem.stock/subitem.dailyconsumption + MIN(father.cutoff)** 其中 MIN(father.cutoff) 是该子项目所有父亲的最小截止值。这是因为我需要另一个分组。

我可以需要另一个 CTE 来循环相同的父子关系吗？

谢谢你的关注，对不起我的英语。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-28T11:37:57.327

```
;WITH cte AS
 (
  SELECT id, father, 
         dailyconsumption,
         (stock / dailyconsumption) AS cutoff,
         0 AS [Level] 
  FROM items
  WHERE father IS NULL
  UNION ALL
  SELECT i.id, i.father, 
         c.dailyconsumption * i.num,
         i.stock / (c.dailyconsumption * i.num),
         [Level] + 1
  FROM cte c JOIN items i ON c.id = i.father
  )
  SELECT c.id, c.dailyconsumption, c.cutoff AS subItemsCutoff, 
         MIN(ct.cutoff) OVER(PARTITION BY ct.[Level]) AS fatherCutoff,
         (c.cutoff  + ISNULL(MIN(ct.cutoff) OVER(PARTITION BY ct.[Level]), 0)) AS Cutoff
  FROM cte c LEFT JOIN cte ct ON c.father = ct.id 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/84ed4/3/0)上的演示[](http://sqlfiddle.com/#!3/84ed4/3/0)

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T17:56:22.773

我建议改用变量表。声明表，然后将这些记录插入其中。您需要找到一种在第二次插入命令时循环遍历它的方法。我得到这个让你开始：

```
DECLARE @staging TABLE
(
    id                  INT
    ,dailyconsumption   FLOAT
    ,cutoff             FLOAT
)

INSERT INTO @staging
    SELECT
      id,
      dailyconsumption,
      stock/dailyconsumption as cutoff
    FROM 
      items
    WHERE 
      father IS NULL

INSERT INTO @staging
  SELECT
      i.id,
      SUM(father.dailyconsumption*i.num),
      MAX(stock)/SUM(father.dailyconsumption*i.num)
    FROM 
      @staging father

        JOIN items i 
        ON father.id=i.father
    group by 
      i.id

SELECT 
  id
 ,MIN(cutoff)
FROM 
  @staging
GROUP BY 
  id 
```**

# php - 从 facebook 的 RSS 提要中删除不需要的信息

> ID：13956372
> 
> 赞同：-2
> 
> 时间：2012-12-19T16:05:22.187
> 
> 标签：php, html, xml, facebook, rss

比如说我们去这个页面：

[https://www.facebook.com/feeds/page.php?format=rss20&id=133869316660964](https://www.facebook.com/feeds/page.php?format=rss20&id=133869316660964)

如何以编程方式从中删除数据..或将数据提取到变量/数组中，例如您想要 2 个最新帖子（标签中的一部分是否可以访问它？

对于这样一个悬而未决的问题，我很抱歉，但我在一段时间的搜索中没有找到解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:07:58.820

用 PHP 的 DOM 扩展解析它：http: [//php.net/manual/en/book.dom.php](http://php.net/manual/en/book.dom.php)

# facebook - 如何通过 API 获取正确的数据到外部 URL 和正确的 ID？

> ID：13956378
> 
> 赞同：1
> 
> 时间：2012-12-19T16:05:43.093
> 
> 标签：facebook, url, facebook-graph-api, metadata

是否有可能通过打开的图表获取到特定 url 的更多信息，例如预览图像、标题和简短描述？如果你做这样的事情，你只会得到“分享” //graph.facebook.com/http://www.google.de

这有点令人困惑，当我通过 object_url 表通过 FQL 获取 ID 时，我得到的 ID 与从调试器获取的 ID 不同。

获取身份证：

//graph.facebook.com/fql?q=SELECT%20url,id,type,site%20FROM%20object_url%20WHERE%20url%20=%20%22http://google.de%22

```
Result: "id": 6319338796</pre>
Trying to get the Data with that ID failed (acces token needed) 
```

//graph.facebook.com/6319338796/

```
 "message": "An access token is required to request this resource." 
```

使用调试器获取 ID：

//developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Fgoogle.de

从 ID 438699604740 获取结果（没问题）：//graph.facebook.com/438699604740

```
{
"url": "http://www.google.de/",
"type": "website",
"title": "Google",
"image": [{"url": "http://www.google.de/images/google_favicon_128.png"}
],
"updated_time": "2012-12-19T15:26:32+0000",
"id": "438699604740"
} 
```

我只是想知道，为什么同一个 URL 有两个不同的对象 ID，为什么我需要一个 acces_token 而不是另一个？

问题是，如何通过 API 获取正确的数据和正确的 ID？或者从 URL 获取这些数据是否有任何限制？

感谢帮助！

# c# - 银河系的敌人运动

> ID：13956380
> 
> 赞同：14
> 
> 时间：2012-12-19T16:05:48.387
> 
> 标签：c#, xna

我正在制作一个类似银河的射手，我的敌人物体有一个目的地向量，他们使用这段代码前往该向量：

```
position.X -= (Motion.X / Magnitude) * Speed;
position.Y -= (Motion.Y / Magnitude) * Speed; 
```

运动是通过：

```
this.Motion = InitialPosition - Destination; 
```

这使他们沿直线向目的地行驶。

但是，我想让它们变得更有趣，并在 sin 或 cos 波中旅行，有点像 Galaxian 所做的那样。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T16:19:05.653

您最好为运动函数定义贝塞尔曲线，而不是像正弦波这样的简单函数。Galaxian当然有比这更复杂的动作。

这是[贝塞尔曲线数学入门](http://processingjs.nihongoresources.com/bezierinfo/)的链接。这是一个相当长的文档，但很好地涵盖了所涉及的数学，并提供了大量示例。

希望对您有所启发。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-19T16:17:57.913

一种方法是为水平运动创建一个加速因子，并将该因子添加到每个刻度的水平速度。因此，如果你对给定敌人的水平速度一开始是 2，而你的加速度是 -.01，那么在 200 个滴答声之后，敌人会直线下降，再过 200 个滴答声之后，它会以 -2 的水平速度移动. 这将给出一个很好的曲线。

通过随机确定每个敌人的速度和加速度（在实验确定的特定限制内），您可以创建漂亮的各种攻击配置文件，而无需太多努力。这将给出一个非常类似银河的运动。

你也可以对垂直方向做同样的事情，当然，加速度限制会非常不同......对于水平加速度，你可能想要确定一个在 0 两侧大小相等的范围（比如说 -.02 到 +.02），而对于垂直加速度，您可能总是希望船最终从屏幕底部下降，因此您可能希望该加速度始终为正（或负，具体取决于你如何做屏幕坐标。）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T16:19:29.243

您可以根据当前的运动代码使用[航点导航来做到这一点。](http://xbox.create.msdn.com/en-US/education/catalog/sample/waypoints)您将通过绘制正弦波来计算航点。你可以通过使用一些东西来做到这一点`Destination.Y = Math.Sin(Destination.X)`——如果没有看到你的代码，很难确定。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-19T16:52:56.240

创建一个振荡器并将敌人（即使没有动量）垂直于其方向移动一个等于振荡器的正弦或余弦的偏移量就足够了。

以下示例在工作时显然只是一个指南。我希望它可以帮助你。

```
var dest = new PointF(200, 100);
var pos = new PointF(30, 140);
var oscAngle = 0d;
var dirAngle = Math.Atan2(dest.Y - pos.Y, dest.X - pos.X);
//Constants for your simulation
const int movSpeed = 2;
const int amp = 2;
const double frequency = Math.PI / 5;
//Inappropriate loop condition, change it to proper
while (true)
{
    oscAngle += frequency;
    //Scalar offset, you can use Cos as well
    var oscDelta = Math.Sin(oscAngle);
    //Linear movement
    var stepVector = new SizeF((float)(Math.Cos(dirAngle) * movSpeed), (float)(Math.Sin(dirAngle) * movSpeed));
    //Oscillating movement, making it transversal by adding 90° to the direction angle
    var oscNormalAngle = dirAngle + Math.PI / 2;
    //Vector for the oscillation
    var oscVector = new SizeF((float)(Math.Cos(oscNormalAngle) * oscDelta) * amp, (float)(Math.Sin(oscNormalAngle) * oscDelta) * amp);
    pos += stepVector + oscVector;
    //Operate below
} 
```

# splunk - 有没有办法只搜索上个月每天的时间范围？

> ID：13956383
> 
> 赞同：0
> 
> 时间：2012-12-19T16:05:54.217
> 
> 标签：splunk

我正在尝试使用 Splunk 创建一个搜索，这将允许我在非工作期间仅获得结果。我的意思是，Splunk 从日志中过滤掉从早上 8 点到早上 5 点发生的所有事件。

目前，我正在使用的查询是：`earliest=-1mon`所以我得到了上个月的所有事件，但我只需要那些在工作时间之外发生的事件。

是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:28:12.660

在 Splunk 中可能有多种方法可以做到这一点。下面是一个。我将小时字段（24 小时格式）提取到 c_time 中，然后将我的结果限制在 8p 和 5a 之间。您可以指定其他过滤器，例如更具体的最早和最新。希望这可以帮助。

```
... | convert timeformat="%H" ctime(_time) AS c_time | search c_time>= 20 c_time<= 05 
```

-尼拉杰。

# c++ - Boost单元测试运行荒谬的测试量

> ID：13956398
> 
> 赞同：0
> 
> 时间：2012-12-19T16:06:36.720
> 
> 标签：c++, boost

所以我使用 boost 单元测试来为我的代码运行一堆测试用例。

当我运行测试时，我得到以下奇怪的结果

```
Boost running 33 test cases...
Boost running 4294967295 test cases... 
```

有谁知道哪些常见错误会导致第二行发生？既然第一行已经发生，为什么第二行甚至会发生？

感谢您提供任何信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:24:16.597

> 有谁知道哪些常见错误会导致第二行发生？

例如，以下代码会生成此值：

```
unsigned start = 5;
unsigned end = 4;
unsigned count = end - start; // will be 4294967295 
```

# c# - 树结构中数据模型的存储库模式实现

> ID：13956405
> 
> 赞同：12
> 
> 时间：2012-12-19T16:07:09.497
> 
> 标签：c#, tree, repository-pattern

我在实现存储库接口的两个不同模型中有两个数据集合。其中之一是在一个非常适合存储库模型的平面列表中。另一个数据模型采用树形结构格式化，我构建的存储库接口的实现看起来很阴暗。我可以尝试展平第二个数据模型并仅使用对父级的引用，但目前该应用程序从能够以树结构获取数据中获得了一些巨大的好处。

我想知道是否有人有使用树结构数据模型实现存储库模式的经验。目前在我的`Get(Func<T, bool> predicate)`方法中，我使用递归方法展平列表并使用 LINQ 查询返回对象，但我觉得这种实现有点昂贵。

任何有关如何实现这一点的提示将不胜感激。

这里是 get by predicate 方法的实现，如果这有助于说明实现的愚蠢之处。

```
protected virtual IEnumerable<T> Get(Func<T, bool> predicate)
{
    var objects = GetAll<T>();
    return objects.Where(predicate);
} 
```

编辑：更多代码

```
private IEnumerable<TreeData> GetRecursiveObjects(TreeData object)
    {
        var allChildren = new List<TreeData>();
        allChildren.AddRange(object.Children);

        foreach (var child in object.Children)
        {
            allChildren.AddRange(GetRecursiveObjects(child).ToArray());
        }
        return allChildren;
    }

    protected virtual IEnumerable<T> GetAll<T>()
    {
        var objects = new List<T>();
        objects.AddRange(Objects);
        foreach (var object in Objects)
        {
            objects.AddRange(GetRecursiveObjects(object));
        }
        return objects.OfType<T>();
    } 
```

第二次编辑：

对于将元素添加到存储库的好策略是什么，我也有点困惑。我应该在使用代码中处理添加到父元素的子元素，还是存储库应该同时获取元素和对其父元素的引用并处理整个添加操作？

tl;博士

尝试用树状结构的数据实现存储库接口是不是很疯狂？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:26:45.977

您可以编写一个遍历树并返回一个`IEnumerable<T>`使用迭代器块 ( `yield return`) 的方法。

然后您不必创建树内容的“平面”集合，您可以使用 LINQ to Objects 来应用您的谓词：

```
protected virtual IEnumerable<T> Get(Func<T, bool> predicate)
{
  return WalkAll().Where( predicate );
} 
```

事实上，在客户端代码枚举它之前，甚至不会评估 LINQ 查询。

# nhibernate - NHibernate：IUserType 不起作用

> ID：13956408
> 
> 赞同：6
> 
> 时间：2012-12-19T16:07:33.533
> 
> 标签：nhibernate, fluent, usertype

我有这个实现 IUserType 的类：

```
public class StringToIntType : IUserType
    {
        /// <summary>
        /// mutable object = an object whose state CAN be modified after it is created
        /// </summary>
        public bool IsMutable
        {
            get { return false; }
        }

        public Type ReturnedType
        {
            get { return typeof(StringToIntType); }
        }

        public SqlType[] SqlTypes
        {
            get { return new[] { NHibernateUtil.String.SqlType }; }
        }

        public object NullSafeGet(IDataReader rs, string[] names, object owner)
        {
            var obj = NHibernateUtil.String.NullSafeGet(rs, names[0]);

            if (obj == null) return null;

            var s = (string)obj;

            int i;
            if (Int32.TryParse(s, out i))
                return i;
            return -1;
        }

        public void NullSafeSet(IDbCommand cmd, object value, int index)
        {
            if (value == null)
            {
                ((IDataParameter)cmd.Parameters[index]).Value = DBNull.Value;
            }
            else
            {
                var i = (int)value;
                ((IDataParameter)cmd.Parameters[index]).Value = i.ToString();
            }
        }

        public object DeepCopy(object value)
        {
            return value;
        }

        public object Replace(object original, object target, object owner)
        {
            return original;
        }

        public object Assemble(object cached, object owner)
        {
            return cached;
        }

        public object Disassemble(object value)
        {
            return value;
        }

        public new bool Equals(object x, object y)
        {
            if (ReferenceEquals(x, y)) return true;

            if (x == null || y == null) return false;

            return x.Equals(y);
        }

        public int GetHashCode(object x)
        {
            return x == null ? typeof(int).GetHashCode() + 473 : x.GetHashCode();
        }
    } 
```

我的映射：

```
public BarausLangMap()
        {
            Table("BARAUSLANG");

            Id(x => x.ula).CustomType<StringToIntType>();

            Map(x => x.bezeichnung);
            Map(x => x.sprache);
            Map(x => x.la);
            Where("la = 'SPE'");
        } 
```

我的属性：

```
 public virtual int ula { get; set; }
    public virtual String bezeichnung { get; set; }
    public virtual Int32? sprache { get; set; }
    public virtual String la { get; set; } 
```

问题：当我这样做时

```
var b = session.Get<BarausLang>(5); 
```

它说

```
{NHibernate.TypeMismatchException: Provided id of the wrong type.
Expected: MobileServiceServer.Models.StringToIntType, got System.Int32 
```

问题是什么？我认为 nHibernate 会隐式调用 StringToIntType 从 int 转换为 string，反之亦然。我认为这就是重点。我以为 StringToIntType 仅用于映射？那我该怎么用呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T17:09:42.330

You are correct, `ReturnedType` should return the type that NullSafeGet will return. The example code [you linked to](http://lostechies.com/rayhouston/2008/03/23/mapping-strings-to-booleans-using-nhibernate-s-iusertype/) is incorrect, `ReturnedType` should return `typeof(bool)`.

Also, getting the Equals method right is very important and I recommend a small change to your code:

```
 public new bool Equals(object x, object y)
    {
        if (ReferenceEquals(x, y)) return true;

        var xString = x as string;
        var yString = y as string;
        if (xString == null || yString == null) return false;

        return xString.Equals(yString);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:24:14.317

我**可能**发现了问题：

```
public Type ReturnedType 
```

上面返回StringToIntType，我**认为**它应该是int。

但是，在：

[http://lostechies.com/rayhouston/2008/03/23/mapping-strings-to-booleans-using-nhibernate-s-iusertype/](http://lostechies.com/rayhouston/2008/03/23/mapping-strings-to-booleans-using-nhibernate-s-iusertype/)

该方法返回实现 IUserType 的类型。

请*确认*。

# java - WS 部署上的 RuntimeInlineAnnotationReader 导致的 InternalError

> ID：13956410
> 
> 赞同：1
> 
> 时间：2012-12-19T16:07:52.613
> 
> 标签：java, weblogic, jax-ws

Web 服务在 Eclipse/WebLogic 中运行良好，但是当通过构建脚本构建 ear 并将 ear 部署在独立的 WebLogic 实例上时出现以下错误。为什么在不同的环境中会出现这个错误？

```
[HTTP:101216]Servlet: "MyServiceServlethttp" failed to preload on startup in Web application: "MyApp-WS". java.lang.InternalError
 at com.sun.xml.bind.v2.model.annotation.RuntimeInlineAnnotationReader.getClassValue(RuntimeInlineAnnotationReader.java:139) 
 at com.sun.xml.bind.v2.model.annotation.RuntimeInlineAnnotationReader.getClassValue(RuntimeInlineAnnotationReader.java:53) 
 at com.sun.xml.bind.v2.model.impl.PropertyInfoImpl.isApplicable(PropertyInfoImpl.java:212) 
 at com.sun.xml.bind.v2.model.impl.PropertyInfoImpl.getApplicableAdapter(PropertyInfoImpl.java:223)
 ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:07:52.613

**从 XSD 中删除**以下日期/日期时间转换器（并改为默认为 XMLGregorianCalendar）修复了该错误。当然，我仍然想使用日历而不是 XMLGregorianCalendar，但我已经在这方面浪费了足够多的时间。

```
<xs:annotation>
    <xs:appinfo>
        <jaxb:globalBindings>
            <jaxb:serializable uid="1"/>
            <jaxb:javaType name="java.util.Calendar" xmlType="xs:dateTime" parseMethod="javax.xml.bind.DatatypeConverter.parseDateTime" printMethod="javax.xml.bind.DatatypeConverter.printDateTime" />
            <jaxb:javaType name="java.util.Calendar" xmlType="xs:date" parseMethod="javax.xml.bind.DatatypeConverter.parseDate" printMethod="javax.xml.bind.DatatypeConverter.printDate" />
        </jaxb:globalBindings>
    </xs:appinfo>
</xs:annotation> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-18T05:45:39.907

在类似的问题上，进行调试并查看引发异常的位置非常有指导意义：有很多关于根本原因的相关信息，但没有提供给 InternalError，使得日志记录非常无用

# c# - MongoDB 嵌入式多态对象

> ID：13956413
> 
> 赞同：12
> 
> 时间：2012-12-19T16:07:56.977
> 
> 标签：c#, mongodb

我有一个类似的对象：

```
[BsonKnownTypes(typeof(Bike), typeof(Car), typeof(Van))]
public class Vehicle
{
    public List<Wheel> wheels;
}

public class Bike: Vehicle
{

}

public class Car: Vehicle
{

}

public class Van: Vehicle
{

}

[BsonKnownTypes(typeof(WheelA), typeof(WheelB))]
public class Wheel
{

}

public class WheelA: Wheel
{
    private int Propa;
}

public class WheelB: Wheel
{
    private int Propb;
} 
```

我有一个名为 vehicle 的集合，并将所有派生对象存储在这个集合中。Vehicle 具有“Wheel”类型的嵌入式对象集合。如果我的收藏有不同类型的轮子，则这些类型不会被反序列化。有没有办法可以将多态性用于嵌入式对象。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-04T19:37:12.170

尝试注册派生类型，例如：

```
BsonClassMap.RegisterClassMap<WheelA>();
BsonClassMap.RegisterClassMap<WheelB>(); 
```

或喜欢：

```
[BsonDiscriminator(Required = true)]
[BsonKnownTypes(typeof(WheelA), typeof(WheelB))]
public class Wheel 
```

**更新：**在创建测试项目时，我意识到：您需要**将属性设为 public**。
如果它们不可访问，MongoDB 无法设置它们。

这是测试代码：

```
[TestClass]
public class IntegrationTests
{
    [TestMethod]
    public void Polymorphic_objects_should_deserialize()
    {
        var database = MongoDatabase.Create("connection_string");
        var collection = database.GetCollection("vehicles");

        var car = new Car
        {
            wheels = new List<Wheel>
                       {
                           new WheelA {propA = 123},
                           new WheelB {propB = 456}
                       }
        };
        collection.Insert(car);

        var fetched = collection.AsQueryable<Car>()
                        .SingleOrDefault(x => x.Id == car.Id);

        Assert.IsNotNull(fetched.wheels);
        Assert.AreEqual(2, fetched.wheels.Count);

        Assert.IsInstanceOfType(fetched.wheels[0], typeof(WheelA));
        Assert.IsInstanceOfType(fetched.wheels[1], typeof(WheelB));

        Assert.AreEqual(123, (fetched.wheels[0] as WheelA).propA);
        Assert.AreEqual(456, (fetched.wheels[1] as WheelB).propB);
    }
} 
```

这些实体与您的列表相同，除了`Propa`& `Propb`，它是公开的。
我还添加了一个`Id`字段以便`Vehicle`能够对其进行测试。
测试是绿色的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T19:34:24.760

看 BsonDiscriminator 属性 [http://www.mongodb.org/display/DOCS/CSharp+Driver+Serialization+Tutorial#CSharpDriverSerializationTutorial-Polymorphicclassesanddiscriminators](http://www.mongodb.org/display/DOCS/CSharp+Driver+Serialization+Tutorial#CSharpDriverSerializationTutorial-Polymorphicclassesanddiscriminators)

# svn - 重用已删除分支的名称是否安全？

> ID：13956414
> 
> 赞同：9
> 
> 时间：2012-12-19T16:07:57.830
> 
> 标签：svn, branch

例如：

1.  我创建了一个名为 refactor 的分支。
2.  我将分支重新整合到主干。
3.  我删除分支。

**使用另一个名为 refactor 的分支重复该过程是否安全？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:28:53.560

使用 SVN，您可能遇到的唯一问题是，在合并`mergeinfo`合并点的属性时（文件夹或文件取决于合并的级别）将包含先前合并的分支名称和修订号。我不认为 SVN 在合并时实际上使用了这些信息，但作为用户有时会变得混乱。

如果您不关心这一点，那么它应该可以正常工作......但我知道在以前的项目中，我们使用`mergeinfo`作为我们已合并回主干的分支的指示，因此重新使用分支名称将是危险的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:26:53.223

是的，您可以这样做，只要您在查看 Subversion 日志历史记录时对哪个重构不感到困惑。

假设您有某种故障单系统，最好通过编号或代码将特定修订与导致进行修订的故障单联系起来。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T17:08:37.123

这不应该是一个问题 - 除了一件小事......

尽管该分支与旧分支同名，但就 Subversion 而言，它是一个全新的分支。如果您查看`svn log`分支的 ，它不会追溯到具有该名称的原始分支。旧分支甚至不会被视为合并历史的一部分。这是一个完全不同的分支，恰好有名字 name。

在这种情况下，这正是您想要的。但是，它可能会引起一些混乱。我遇到的最大问题之一是删除文件或目录然后将其重新添加的人**感到震惊！震惊！**Subversion 的合并没有按预期工作。

只要你明白这一点，一切都应该没问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T16:29:51.360

是的，完全没问题。

您可以在[SVNBook](http://svnbook.red-bean.com/en/1.7/svn.branchmerge.html)中找到所有内容。

# iphone - NSUserDefaults添加的subView如何保存？

> ID：13956419
> 
> 赞同：4
> 
> 时间：2012-12-19T16:08:22.500
> 
> 标签：iphone, objective-c, ios, cocoa-touch, nsuserdefaults

我正在使用图书应用程序，我想使用页面标记来帮助用户记住他停止阅读的位置。所以我添加了一个带有图像的栏按钮（“mark.png”）。标记视图将在被点击时添加到章节视图中，如果再次被点击，标记将从 中删除`superView`。我正在使用这段代码：

```
- (void)showMark {
    if (![markView superView]) {
       [chapterOne addSubView:markView];
    }
    else {
       [markView removeFromSuperView];
    }
} 
```

它工作正常，但每当我退出应用程序并再次重新运行时，标记视图就消失了，那么我该如何保留它呢？我发现一些论坛谈论`NSUserDefaults`保存操作，但我真的不知道如何在我的代码中使用它。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:17:08.860

您不能使用 NSUserDefaults 保存整个视图，但您可以保存有助于确定应在何处设置书签的参数。

例如，如果您将书签基于页码，您可以在用户离开视图控制器时将页面保存到 NSUserDefaults。

**例子：**

```
[[NSUserDefaults standardUserDefaults] setInteger:23 forKey:@"bookMarkPage"];
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

当用户返回视图控制器时，您可以检查是否有书签：

```
if ([[NSUserDefaults standardUserDefaults] objectForKey:@"bookMarkPage"] != nil) {
    int pageNumber = [[NSUserDefaults standardUserDefaults] objectForKey:@"bookMarkPage"];
    [self setBookmarkForPage:pageNumber];
} 
```

可能的书签构造方法：

```
- (void) setBookmarkForPage:(Int)pageNumber {
    // run through the logic of placing the bookmark on the correct page
} 
```

您可以使用所需的任何参数来确定放置书签的位置。当用户最初放置书签时，您使用哪些参数来确定放置书签的位置？尝试在用户第一次放置书签时使用相同的逻辑。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T16:12:03.637

我不确切知道您要保存什么，但是您可以使用 几乎任何类型的数据`NSUserDefaults`，如下所示：

```
[[NSUserDefaults standardUserDefaults] setInteger:123 forKey:@"CurrentPageNumber"]; 
```

设置好所有需要的值后，保存它们：

```
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

然后当应用程序打开时，检查该值是否已设置。如果是画你的标记。

```
if ([defaults valueForKey:@"CurrentPageNumber"] != nil) {
    int pageNumber = [defaults valueForKey:@"CurrentPageNumber"]

    if (pageNumber == 1) {
        [chapterOne addSubView:markView];
    }
    else {
        [markView removeFromSuperView];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:21:57.670

其他答案说明了解决该问题的好方法。澄清一下，不支持 UIView 或任何派生类`NSUserDefaults`。`NSUserDefaults`只允许原始对象类型 ( `NSString, NSNumber, NSArray, and NSDictionary`)。我可能错过了一两个。但是`UIView`or`UIViewController`对象类型不能保存在`NSUserDefaults`.

# dom - 使用 CasperJS 返回整个远程 DOM

> ID：13956420
> 
> 赞同：0
> 
> 时间：2012-12-19T16:08:28.013
> 
> 标签：dom, screen-scraping, casperjs

我正在使用 CasperJS 进行一些屏幕抓取，但遇到了一个奇怪的问题。当我使用 Web 浏览器导航到 URL 时，DOM 看起来与 CasperJS 在导航到相同 URL 时遇到的完全不同。

为此，我想通过 CasperJS 转储远程 DOM，以便排除正在发生的事情。

有没有人做过这样的事情？

提示赞赏！

# coldfusion - CFLOG 不写入日志文件

> ID：13956424
> 
> 赞同：1
> 
> 时间：2012-12-19T16:08:38.533
> 
> 标签：coldfusion

我想将一些信息写入日志文件。我尝试将此代码添加到我的文件中：

```
<cfparam name="BillingAddressOne" default="#session.userinfo.Address1#">
<cfparam name="BillingAddressTwo" default="#session.userinfo.Address2#">
<cfparam name="BillingCity" default="#session.userinfo.city#">
<cfparam name="BillingState" default="#session.userinfo.state#">
<cfparam name="BillingZipCode" default="#session.userinfo.zip#">
<cfparam name="BillingCountry" default="US">
<cfparam name="BillingPhone" default="#session.userinfo.phone#">
<cfparam name="BillingFax" default="#session.userinfo.fax#">
<cfparam name="BillingEmail" default="#session.userinfo.email#">
<cfparam name="CardType" default="#sessioninfo.CreditCardType#">
<cfparam name="form['Credit Card Number']" default="#sessioninfo.CreditCardNumber#">
<cfparam name="expmonth" default="#sessioninfo.CreditCardExpMonth#">
<cfparam name="expyear" default="#sessioninfo.CreditCardExpYear#">
<cfparam name="CCverificationCode" default="#sessioninfo.CCverificationCode#">
<cfparam name="CreditCardName" default="#sessioninfo.CreditCardName#">

<cflog file="info.log" application="no" 
    text="#BillingAddressOne# #BillingAddressTwo# #BillingCity# #BillingState# #BillingZipCode# #BillingCountry# #BillingPhone# #BillingEmail# #pmtmethod# #CardType# #form['Credit Card Number']# #expmonth# #expyear# #CCverificationCode# #CreditCardName#"> 
```

我尝试输入一些东西，但文件中没有显示`info.log`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T17:43:52.487

根据[文档](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=Tags_j-l_06.html)，文件属性应该只包含文件名，而不是扩展名。

还，

> 该文件必须位于默认日志目录中。您不能指定目录路径。如果文件不存在，则会自动创建，扩展名为 .log。

这很可能是 [coldfusion 安装文件夹]/logs

尝试

```
<cflog file="info"  
       application="no" 
       text="#BillingAddressOne# 
             #BillingAddressTwo# 
             #BillingCity# 
             #BillingState# 
             #BillingZipCode# 
             #BillingCountry# 
             #BillingPhone# 
             #BillingEmail# 
             #pmtmethod# 
             #CardType# 
             #form['Credit Card Number']# 
             #expmonth# 
             #expyear# 
             #CCverificationCode# 
             #CreditCardName#"> 
```

# django - 如何使用 Django Postman 设置像 Facebook 这样的后端消息传递系统？

> ID：13956431
> 
> 赞同：2
> 
> 时间：2012-12-19T16:09:13.177
> 
> 标签：django, django-views, private-messaging

我对 Django Postman 进行了研究，它似乎是最可靠的私人用户到用户消息传递平台。我查看了 Django Postman 文档，但它非常面向模板。对于使用 Django 作为后端并且只关心 views.py 和 urls.py 的开发人员，文档并没有多说。

但是我确实找到了这个：[https ://bitbucket.org/psam/django-postman/src/6ff9fdf9c33f7365a7235a789af2e47f47d9c4fa/postman/views.py?at=default](https://bitbucket.org/psam/django-postman/src/6ff9fdf9c33f7365a7235a789af2e47f47d9c4fa/postman/views.py?at=default)

这似乎很有希望，所以我要试一试。我唯一的问题是如何设置views.py 中的邮递员视图和urls.py 中的url 来创建一个类似于Facebook 的消息系统？

（即。类似消息对话系统的线程，一个中央收件箱，所有来自每个用户的消息汇集在一起​​，显示来自每个用户的最后一条消息，收件箱中的消息按对话而不是消息排序，最后一条消息发送的时间, 允许多个收件人）

下面我发布了一张 Facebook 消息平台的图片。这就是我本质上试图用 Django Postman 实现的目标。

[Facebook 示例 http://screenshots.en.sftcdn.net/en/scrn/73000/73077/facebook-19-371x535.jpg](http://screenshots.en.sftcdn.net/en/scrn/73000/73077/facebook-19-371x535.jpg)

如果您对如何设置 views.py 有任何指示、提示和想法，我将不胜感激！谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T19:13:47.100

我以前遇到过这个问题。

您需要通过克隆/分叉项目并从您自己的位置安装它来严格覆盖其中的一些视图，因为正如您所指出的，邮递员是面向模板的，因为它意味着只配置所需的模板和一些设置。我的意思是，后端应该按原样工作。

您需要做的是覆盖以下内容：

*   `Message`模型的[收件人](https://bitbucket.org/psam/django-postman/src/6ff9fdf9c33f7365a7235a789af2e47f47d9c4fa/postman/models.py?at=default#cl-239)字段为`ManyToManyField`
*   根据您的需要自定义视图并小心`Message.replied_at`
*   确保您允许用户回复他们自己的消息（默认情况下，当我遇到这个时，它是不允许的，现在不确定）

根据您的需要，也许您会想要覆盖其他内容，但这是一个好的开始。如果你需要它类似于 facebook，你需要使用一些推送库作为[Pusher](https://github.com/pusher/pusher_client_python#pusher-python-module)或[Juggernaut](http://flask.pocoo.org/snippets/80/)，也许你也对它们感兴趣。

祝你好运！:)

# php - 错误 MYSQL 期望参数为 1？

> ID：13956434
> 
> 赞同：-3
> 
> 时间：2012-12-19T16:09:20.903
> 
> 标签：php, mysql

> **可能重复：**
> [mysql_fetch_array() 期望参数 1 是资源，选择中给出的布尔值](https://stackoverflow.com/questions/2973202/mysql-fetch-array-expects-parameter-1-to-be-resource-boolean-given-in-select)

有人能帮我吗。我将 div 设置为仅在帐户类型为“付费”的用户登录时显示。

它工作正常，当“付费”用户登录 div 显示时，否则如果用户已注销，它会出现此错误消息，我不知道为什么？

```
Warning: mysql_fetch_array() expects parameter 1 to be resource, boolean given in /Applications/XAMPP/xamppfiles/htdocs/PTB1/includes/mod_profile/mod_star_rating/mod_rating.php on line 116 
```

代码：

```
<?php

$account_type = account_type();
while ($acctype = mysql_fetch_array($account_type)) 

 if ($acctype['account_type'] == 'paid')  {
     if (logged_in()) { ?>
    <div class="rate-button">can rate</div><?

 } 
 ?> 
```

这是我的帐户类型功能：

```
function account_type() {
            global $connection;
            global $_SESSION;
            $query = "SELECT account_type
                        FROM ptb_users
                        WHERE id = ".$_SESSION['user_id']." ";
            $account_type = mysql_query($query, $connection);
            confirm_query($query, $connection);
            return $account_type;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:17:22.820

```
$acctype = mysql_fetch_array($account_type); 
```

属于之后

```
 $account_type = mysql_query($query, $connection); 
```

其次是

```
return $acctype; 
```

主脚本应为： $acc_type = account_type(); 而不是

```
while 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:16:33.117

以 mysql_ 开头的函数已弃用，应替换为 mysqli 或 PDO。

$account_type 可能是错误的，可以解释您的错误。您将需要添加一些检查，以便获得 mysql_error() 的结果。

你会想做这样的事情：

```
if(!$account_type) {
  die(mysql_error());
} 
```

# r - 为随机森林回归模型设置 ntree 和 mtry 的值

> ID：13956435
> 
> 赞同：41
> 
> 时间：2012-12-19T16:09:27.427
> 
> 标签：r, statistics, machine-learning, regression, random-forest

我正在使用 R 包`randomForest`对一些生物数据进行回归。我的训练数据大小是`38772 X 201`.

`ntree`我只是想知道——对于树的数量和每个级别的变量数量来说，什么是一个好的值`mtry`？是否有一个近似公式来找到这样的参数值？

我输入数据中的每一行都是代表氨基酸序列的 200 个字符，我想建立一个回归模型来使用这样的序列来预测蛋白质之间的距离。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-12-19T16:29:04.387

mtry 的默认值是非常合理的，所以没有必要去搞砸它。有一个`tuneRF`优化这个参数的函数。但是，请注意，这可能会导致偏见。

引导复制的数量没有优化。我经常从随机森林对象开始`ntree=501`然后绘制。这将显示基于 OOB 错误的错误收敛。您需要足够多的树来稳定错误，但不要太多，以免过度关联整体，从而导致过度拟合。

需要注意的是：变量交互的稳定速度比误差慢，因此，如果您有大量自变量，则需要更多重复。我会将 ntree 保持为奇数，以便可以打破关系。

对于你问题的维度，我会开始`ntree=1501`。我还建议查看已发布的变量选择方法之一，以减少自变量的数量。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-19T16:24:22.617

最简洁的答案是不。

该`randomForest`函数当然具有`ntree`和的默认值`mtry`。默认值`mtry`通常（但不总是）是合理的，而通常人们会希望`ntree`从默认值 500 增加相当多的值。

的“正确”值`ntree`通常不是什么大问题，因为稍加修改就会很明显，模型的预测在一定数量的树之后不会有太大变化。

您可以花费（阅读：浪费）大量时间来修补`mtry`（以及`sampsize`和`maxnodes`等`nodesize`）之类的东西，这可能会有所帮助，但根据我的经验，不会很多。但是，每个数据集都会有所不同。有时您可能会看到很大的不同，有时根本没有。

**caret**包有一个非常通用的功能，`train`允许您对参数值进行简单的网格搜索，例如`mtry`各种模型。我唯一要注意的是，使用相当大的数据集执行此操作可能会很快消耗时间，因此请注意这一点。

此外，不知何故，我忘记了**ranfomForest**包本身具有`tuneRF`专门用于搜索`mtry`.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-03-01T10:27:04.373

这篇论文有帮助吗？ [限制随机森林中的树木数量](http://lisa.ulb.ac.be/image/publifiles/100/Mcs2001_final.pdf)

> 抽象的。本文的目的是提出一个简单的过程，该过程先验地确定要组合的最小分类器数量，以获得与通过更大集成组合获得的预测准确度水平相似的预测准确度水平。该程序基于 McNemar 非参数显着性检验。先验地知道给出最佳预测精度的分类器集合的最小尺寸，构成了时间和内存成本的收益，特别是对于大型数据库和实时应用程序。在这里，我们将此过程应用于具有 C4.5 决策树（Breiman 的 Bagging、Ho 的随机子空间、它们的组合我们标记为“Bagfs”和 Breiman 的随机森林）和五个大型基准数据库的四个多分类器系统。值得注意的是，所提出的过程也可以很容易地扩展到除决策树之外的其他基础学习算法。实验结果表明，可以显着限制树的数量。我们还表明，获得最佳预测精度所需的最小树数可能因一种分类器组合方法而异。

他们从不使用超过 200 棵树。

[![在此处输入图像描述](../Images/4f5a5077b776a48fd2ace532bf19efa6.png)](https://i.stack.imgur.com/MlkfP.png)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-07-07T16:09:19.897

我使用的一个很好的技巧是首先从预测变量数量的平方根开始，然后将该值插入“mtry”。它通常与随机森林中的 Tunerf 函数选择的值大致相同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-04-27T14:48:41.350

当我使用 ntree 和 mtry（更改参数）时，我使用下面的代码来检查准确性：

```
results_df <- data.frame(matrix(ncol = 8))
colnames(results_df)[1]="No. of trees"
colnames(results_df)[2]="No. of variables"
colnames(results_df)[3]="Dev_AUC"
colnames(results_df)[4]="Dev_Hit_rate"
colnames(results_df)[5]="Dev_Coverage_rate"
colnames(results_df)[6]="Val_AUC"
colnames(results_df)[7]="Val_Hit_rate"
colnames(results_df)[8]="Val_Coverage_rate"

trees = c(50,100,150,250)
variables = c(8,10,15,20)

for(i in 1:length(trees))
{
  ntree = trees[i]
  for(j in 1:length(variables))
  {
    mtry = variables[j]
    rf<-randomForest(x,y,ntree=ntree,mtry=mtry)
    pred<-as.data.frame(predict(rf,type="class"))
    class_rf<-cbind(dev$Target,pred)

    colnames(class_rf)[1]<-"actual_values"
    colnames(class_rf)[2]<-"predicted_values"
    dev_hit_rate = nrow(subset(class_rf, actual_values ==1&predicted_values==1))/nrow(subset(class_rf, predicted_values ==1))
    dev_coverage_rate = nrow(subset(class_rf, actual_values ==1&predicted_values==1))/nrow(subset(class_rf, actual_values ==1))

    pred_prob<-as.data.frame(predict(rf,type="prob"))
    prob_rf<-cbind(dev$Target,pred_prob)
    colnames(prob_rf)[1]<-"target"
    colnames(prob_rf)[2]<-"prob_0"
    colnames(prob_rf)[3]<-"prob_1"
    pred<-prediction(prob_rf$prob_1,prob_rf$target)
    auc <- performance(pred,"auc")
    dev_auc<-as.numeric(auc@y.values)

    pred<-as.data.frame(predict(rf,val,type="class"))
    class_rf<-cbind(val$Target,pred)

    colnames(class_rf)[1]<-"actual_values"
    colnames(class_rf)[2]<-"predicted_values"
    val_hit_rate = nrow(subset(class_rf, actual_values ==1&predicted_values==1))/nrow(subset(class_rf, predicted_values ==1))
    val_coverage_rate = nrow(subset(class_rf, actual_values ==1&predicted_values==1))/nrow(subset(class_rf, actual_values ==1))

    pred_prob<-as.data.frame(predict(rf,val,type="prob"))
    prob_rf<-cbind(val$Target,pred_prob)
    colnames(prob_rf)[1]<-"target"
    colnames(prob_rf)[2]<-"prob_0"
    colnames(prob_rf)[3]<-"prob_1"
    pred<-prediction(prob_rf$prob_1,prob_rf$target)
    auc <- performance(pred,"auc")
    val_auc<-as.numeric(auc@y.values)
    results_df = rbind(results_df,c(ntree,mtry,dev_auc,dev_hit_rate,dev_coverage_rate,val_auc,val_hit_rate,val_coverage_rate))
  }
} 
```

# javascript - RequireJs minifcation - 复杂的目录结构

> ID：13956439
> 
> 赞同：8
> 
> 时间：2012-12-19T16:09:44.870
> 
> 标签：javascript, requirejs, minify

我们在工作中遇到问题，我们正在使用 require js，但我们的文件夹结构有点不同，我们有以下内容：

```
--js folder 
   --Folder
      ---some base js files
    -Folder 
       ---main
            --src
                ---require.js 
                --- require JS modules
         --plugin js files
         --more js files 
```

我们想将所有这些 JS 文件压缩为一个 SINGLe js 文件以用于生产

```
---js folder
    --min-all.js 
```

这可能吗？如果是这样怎么办？.. 任何帮助，将不胜感激！

谢谢！

我只是想澄清一下其他文件夹包含标准的非模块化 javascript 文件，它们可以是插件或简单的 javascript 帮助程序的混合。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T16:17:40.990

简短的回答是：是的，RequireJS 可以做到这一点。

基本上，您将需要创建一个 JS 文件，该文件需要您想要缩小的所有资源。然后，您将优化器指向该文件，它将把它们混合在一起。

```
require(["one", "../another/two", "folder/three", "folder/inner/four" ... ]); 
```

如果调用了该文件`myfile.js`，您将使用与此类似的参数运行优化器：

```
node r.js -o name=myfile out=optimized.js 
```

如果您有不想包含在最终优化文件中的库或其他文件，则可以使用该`excludeShallow`标志。例如

```
node r.js -o name=myfile out=optimized.js excludeShallow=jquery.min 
```

还有更多选项，因此如果您还没有，您应该查看他们的[优化文档。](http://requirejs.org/docs/optimization.html)

# sqlite - 我想以格式从表中检索数据

> ID：13956440
> 
> 赞同：-9
> 
> 时间：2012-12-19T16:09:49.187
> 
> 标签：sqlite

我在表中有如下数据。

```
column1 | column2 | column3

123       234        1234567890
123       234        1234567892
234       123        1234567893
345       234        1234567894
345       123        1234567895 
```

我希望输出采用以下格式

```
234  123  1234567893
345  234  1234567894
345  123  1234567895 
```

谁能告诉我如何编写查询以检索上述指定格式的数据..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:23:18.983

如果我理解正确，这就是你想要的，

```
select b.column2,b.column1,max(b.column3) column3 from table1 a, table1 b 
where a.column1=b.column2 group by b.column2,b.column1; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-23T20:38:18.167

可以使用 SELECT column1, column2, MAX(ROWID) GROUP BY column1, column2 找到一对唯一项；ROWID 在每次插入时递增，但并不完全等同于最新。

现在可以使用第一个查询的结果来创建所需的结果。

```
SELECT t1.column1, t1.column2, t1.column3 FROM tbl AS t1 JOIN ( SELECT column1, column2, ROWID AS ID FROM tbl GROUP BY column1,column2) AS t2 ON t1.ROWID = t2.ID; 
```

# asp.net - 405 错误：请求的资源不支持 http 方法 GET

> ID：13956442
> 
> 赞同：0
> 
> 时间：2012-12-19T16:10:03.497
> 
> 标签：asp.net, asp.net-mvc-4, asp.net-web-api

我知道有类似的问题，但我的问题是独一无二的。我正在运行 IIS 7。最初我在直接向相关服务器发布/获取时收到此错误。我通读了有关此主题的答案并从我的配置文件中删除了 WebDAV，即使 WebDAV 未安装在相关服务器上，并且停止接收 405 错误。我现在遇到的问题是，当我公开访问服务器并通过我们公司的防火墙时，我再次收到 405 错误。我们有一个直接路由到相关服务器的公共地址。知道为什么会发生这种情况吗？

# xcode - 由于使用 UIInterfaceOrientationMaskAll，xcodebuild 失败

> ID：13956443
> 
> 赞同：1
> 
> 时间：2012-12-19T16:10:11.713
> 
> 标签：xcode, ios6, xcodebuild

这很奇怪。我之前从未尝试过 xcodebuild（所有内容都是从 xcode 构建的）。我的项目从 xcode 构建得非常好，但是当我尝试从终端构建它时，它给了我一个构建错误，说“使用未声明的标识符 UIInterfaceOrientationMaskAll”。

现在AFAIK，因为我提供最新的sdk（iphoneos5.1）编译器应该识别标识符，但不知何故它没有。

这是我正在尝试的命令..

```
xcodebuild -project /Users/venkat/v13.2.2/reader.xcodeproj -sdk iphoneos5.1 DEBUG_INFORMATION_FORMAT=dwarf-with-dsym GCC_VERSION=com.apple.compilers.llvm.clang.2_0 COPY_PHASE_STRIP=NO STRIP_INSTALLED_PRODUCT=NO GCC_GENERATE_DEBUGGIN_SYMBOLS=YES GCC_THUMB_SUPPORT=YES GCC_DEBUGGING_SYMBOLS=FULL GCC_OPTIMIZATION_LEVEL=0 
```

我故意选择保留调试符号，因为我需要发送它以进行安全测试。

任何指针将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:22:04.967

*UIInterfaceOrientationMaskAll*在 6.0 中可用，而不是 5.1。

# c# - EventTrigger 中的模板绑定

> ID：13956447
> 
> 赞同：2
> 
> 时间：2012-12-19T16:10:32.067
> 
> 标签：c#, wpf, xaml, binding, custom-controls

我在 EventTrigger 中有以下绑定：

```
<ControlTemplate.Triggers>
    <EventTrigger RoutedEvent="PreviewMouseDown">
        <SoundPlayerAction Source="{Binding Path=SoundFile, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource soundFileConverter}}" />
    </EventTrigger>
    ... 
```

该过程如下： 自定义控件（即它的模板）有一个名为**SoundFile**的属性，它是一个枚举类型。在转换器中，此枚举值应转换为 Uri 以将其传递给 SoundPlayerAction。

问题是：无论如何都没有调用转换器。输出窗口显示以下错误：

> 找不到目标元素的管理 FrameworkElement 或 FrameworkContentElement。绑定表达式：路径=声音文件；数据项=空；目标元素是 'SoundPlayerAction' HashCode=46763000); 目标属性是“源”（类型“Uri”）

绑定表达式有什么问题？

**编辑：**

为了更好地概述，这里是控件的整个模板：

```
<Style TargetType="{x:Type controls:Button}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type controls:Button}">
                <Border Name="Border"
                        Background="{TemplateBinding Background}"
                        BorderBrush="Transparent"
                        BorderThickness="0">
                    <Border.CornerRadius>
                        <MultiBinding Converter="{StaticResource areaCornerRadiusConverter}">
                            <MultiBinding.Bindings>
                                <Binding Path="RoundType" RelativeSource="{RelativeSource TemplatedParent}" />
                                <Binding Path="ActualHeight" RelativeSource="{RelativeSource TemplatedParent}" />
                            </MultiBinding.Bindings>
                        </MultiBinding>
                    </Border.CornerRadius>
                    <TextBlock Margin="{Binding Path=RoundType,
                                                RelativeSource={RelativeSource TemplatedParent},
                                                Converter={StaticResource buttonMarginConverter}}"
                               FontSize="{TemplateBinding FontSize}"
                               Style="{StaticResource innerTextBlock}"
                               Text="{TemplateBinding Text}" />
                </Border>
                <ControlTemplate.Triggers>
                    <EventTrigger RoutedEvent="PreviewMouseDown">
                        <SoundPlayerAction Source="{Binding Path=SoundFile, RelativeSource={RelativeSource TemplatedParent}, Converter={StaticResource soundFileConverter}}" />
                    </EventTrigger>                        
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

**编辑2：**

我以另一种方式进行了尝试：将 SoundPlayerAction 的 name 属性设置为**PART_SoundPlayerAction并使用****GetTemplateChild**从代码隐藏中检索它。但是**GetTemplateChild**总是返回 null。这真的很烦人。似乎没有任何工作...

**编辑 3：**

现在有了 Blachshma 的回答，我知道在控制初始化期间调用了转换器。但不是在属性发生变化时。此外，转换器返回的值不会作为 Source 应用于 SoundPlayerAction。

我实现了 BindingProxy：

```
public class BindingProxy : Freezable
{
    #region Overrides of Freezable

    protected override Freezable CreateInstanceCore()
    {
        return new BindingProxy();
    }

    #endregion

    public SoundFile Data
    {
        get { return (SoundFile)GetValue(DataProperty); }
        set { SetValue(DataProperty, value); }
    }

    // Using a DependencyProperty as the backing store for Data.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty DataProperty =
        DependencyProperty.Register("Data", typeof(SoundFile), typeof(BindingProxy), new UIPropertyMetadata(SoundFile.None));
} 
```

我将其更改`Path=Data.SoundFile`为`Path=Data`. 有什么错误吗？

**编辑4：**

MakeSoundCommand 的解决方案运行良好。非常感谢布拉赫什玛。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:45:54.310

好吧，您是对的，尝试在该特定位置使用绑定（样式中的 EventTrigger）非常痛苦。

我发现解决此问题的最佳方法是同时使用[Freezables](http://drwpf.com/blog/2008/05/22/leveraging-freezables-to-provide-an-inheritance-context-for-bindings/)（继承 DataContext）和静态 BindingProxies ...

要在您的情况下解决它，首先创建一个可冻结的类，我们将其称为 BindingProxy：

```
public class BindingProxy : Freezable
{
    #region Overrides of Freezable

    protected override Freezable CreateInstanceCore()
    {
        return new BindingProxy();
    }

    #endregion

    public object Data
    {
        get { return (object)GetValue(DataProperty); }
        set { SetValue(DataProperty, value); }
    }

    // Using a DependencyProperty as the backing store for Data.  This enables animation, styling, binding, etc...
    public static readonly DependencyProperty DataProperty =
        DependencyProperty.Register("Data", typeof(object), typeof(BindingProxy), new UIPropertyMetadata(null));
} 
```

所以我们的 BindingProxy 类实现`Freezable`并公开了一个名为`Data`. 这将是保存 DataContext 的属性。

现在，在我们的资源中，我们将创建一个使用此类的 StaticResource... 我们将其命名为“***代理***”：

```
<Window.Resources>
    <local:BindingProxy x:Key="proxy" Data="{Binding}" /> 
```

请注意，我们将 Window 的 DataContext 绑定到`Data`属性中。这将允许用户从`SoundPlayerAction`.

最后，让我们更新 SoundPlayerAction 以使用我们的代理：

```
<EventTrigger RoutedEvent="PreviewMouseDown">
    <SoundPlayerAction Source="{Binding Source={StaticResource proxy}, Path=Data.SoundFile,Converter={StaticResource soundFileConverter}}" />
</EventTrigger> 
```

我们没有使用您使用的常规绑定，而是绑定到一个 StaticResource，即 BindingProxy 类的实例。由于该`Data`属性绑定到窗口的 DataContext，我们可以使用`Data.SoundFile`. 作为额外的奖励，因为所有这些都是通过`Source={Binding`您完成的，您仍然可以调用您的 soundFileConverter 将字符串转换为 URI。

**更新：** OP 不想在每次使用此控件时将`BindingProxy`类放入某个`<Window.Resources>`标记中（这是合法的），因此在此版本中，我们将把所有逻辑放入 ResourceDictionary 并修改一些 XAML 以便它继续工作..

所以在我们的资源字典中，我们将使用`System.Windows.Interactivity`and `Microsoft.Expression.Interactions`（两者都可以通过[Blend SDK](http://www.microsoft.com/en-us/download/details.aspx?id=10801)免费获得）

```
xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions" 
```

由于在以前的版本中，我们可以依靠通过 Window.Resources 执行的绑定，这次我们将不得不自己做......我们将修改原始模板以添加一个`<i:Interaction.Triggers>`将替换`EventTrigger`但允许通过专用命令播放的声音：

```
<local:MakeSoundCommand x:Key="soundCommand"/>
<Style  TargetType="{x:Type controls:Button}" >
  ....
  ....
   <i:Interaction.Triggers>
     <i:EventTrigger EventName="PreviewMouseDown">
        <local:EventToCommand Command="{StaticResource soundCommand}" CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SoundFile, Converter={StaticResource soundFileConverter}}" />
     </i:EventTrigger>
   </i:Interaction.Triggers>
   <TextBlock Margin="{Binding Path=RoundType,.... 
```

它位于 TextBlock 之前，它的作用是处理`PreviewMouseDown`事件并调用名为`soundCommand`type的命令`MakeSoundCommand`。

这是**MakeSoundCommand**的实现：

```
public class MakeSoundCommand : ICommand
{
    public bool CanExecute(object parameter)
    {
        return true;
    }

    public event EventHandler CanExecuteChanged;

    public void Execute(object parameter)
    {
        Uri uri = parameter as Uri;

        if (uri != null)
        {
            StreamResourceInfo sri = Application.GetResourceStream(uri);
            SoundPlayer simpleSound = new SoundPlayer(sri.Stream);
            simpleSound.Play();
        }
    } 
```

其余代码保持不变。注意：`EventToCommand`使用的是[MVVM Light Toolkit](http://mvvmlight.codeplex.com/)中的一个，可以在[这里下载](http://mvvmlight.codeplex.com/SourceControl/changeset/view/b922e8ccf674#GalaSoft.MvvmLight/GalaSoft.MvvmLight.Extras%20%28NET4%29/Command/EventToCommandVS10.cs)

***最后结果：***

通用的.xaml：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
                xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
                xmlns:local="<YOUR NAMESPACE>">

<local:MakeSoundCommand x:Key="soundCommand" />
<local:SoundFileToUriConverter:Key="soundFileConverter" />
<Style TargetType="{x:Type controls:Button}">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType=" {x:Type controls:Button}">
                <Border Name="Border"
                    Background="{TemplateBinding Background}"
                    BorderBrush="Transparent"
                    BorderThickness="0">
                    <Border.CornerRadius>
                      ....
                    </Border.CornerRadius>
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="PreviewMouseDown">
                          <local:EventToCommand Command="{StaticResource soundCommand}" CommandParameter="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=SoundFile, Converter={StaticResource soundFileConverter}}" />
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                    <TextBlock Margin="{Binding Path=RoundType,
                                            RelativeSource={RelativeSource TemplatedParent}}" .... />
                </Border>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

# javascript - 如何将相同的 javascript 添加到 Acrobat pdf 中的互斥复选框？

> ID：13956449
> 
> 赞同：2
> 
> 时间：2012-12-19T16:10:30.870
> 
> 标签：javascript, pdf, acrobat

我在 Acrobat X pdf 表单中有 2 个互斥复选框。选中任一框需要隐藏一组文本字段。我已经为两个复选框分配了相同的 javascript，但只有在选中第一个框时才会隐藏这些字段。选中第二个框时没有任何反应。有任何想法吗？这是我使用的脚本（对javascript一无所知！）：

```
var showHide = event.target.isBoxChecked(0) ? display.hidden : display.visible;

this.getField("Joint Address 1").display         = showHide;
this.getField("Joint City 1").display            = showHide;
this.getField("Joint State 1").display           = showHide;
this.getField("Joint Zip/Postal Code 1").display = showHide;
this.getField("Joint Country 1").display         = showHide; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T15:48:00.887

*Acrobat 文档表明“isBoxChecked”的参数实际上是如果*有多个具有相同名称的复选框时要处理的复选框的索引。

这意味着将“0”更改为“1”作为参数值可以让您解决其他复选框并解决问题

# java - 无法针对路径解析属性 [lieferungen]

> ID：13956450
> 
> 赞同：1
> 
> 时间：2012-12-19T16:10:32.923
> 
> 标签：java, jpa

我们的 Maven 测试中有一个关键问题。我们收到错误：无法针对路径解析属性 [lieferungen]

不幸的是，其他帖子无法帮助我。

这是我的堆栈跟踪：

```
Running de.shop.bestellverwaltung.service.LieferverwaltungTest
Tests run: 4, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 36.446 sec <<< FAILURE!
createLieferung(de.shop.bestellverwaltung.service.LieferverwaltungTest)  Time elapsed: 0.079 sec  <<< ERROR!
java.lang.IllegalArgumentException: Unable to resolve attribute [lieferungen] against path
    at org.hibernate.ejb.criteria.path.AbstractPathImpl.unknownAttribute(AbstractPathImpl.java:120)
    at org.hibernate.ejb.criteria.path.AbstractPathImpl.locateAttribute(AbstractPathImpl.java:229)
    at org.hibernate.ejb.criteria.path.AbstractFromImpl.fetch(AbstractFromImpl.java:595)
    at de.shop.bestellverwaltung.dao.BestellungDao.findBestellungenByIds(BestellungDao.java:36)
    at de.shop.bestellverwaltung.dao.BestellungDao$Proxy$_$$_WeldSubclass.findBestellungenByIds(BestellungDao$Proxy$_$$_WeldSubclass.java)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.jboss.weld.interceptor.proxy.SimpleInterceptionChain.invokeNextInterceptor(SimpleInterceptionChain.java:84)
    at org.jboss.weld.interceptor.proxy.InterceptorInvocationContext.proceed(InterceptorInvocationContext.java:127)
    at de.shop.util.LogInterceptor.log(LogInterceptor.java:87)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.jboss.weld.interceptor.proxy.SimpleMethodInvocation.invoke(SimpleMethodInvocation.java:30)
    at org.jboss.weld.interceptor.proxy.SimpleInterceptionChain.invokeNextInterceptor(SimpleInterceptionChain.java:68)
    at org.jboss.weld.interceptor.proxy.InterceptorMethodHandler.executeInterception(InterceptorMethodHandler.java:112)
    at org.jboss.weld.interceptor.proxy.InterceptorMethodHandler.invoke(InterceptorMethodHandler.java:88)
    at org.jboss.weld.bean.proxy.CombinedInterceptorAndDecoratorStackMethodHandler.invoke(CombinedInterceptorAndDecoratorStackMethodHandler.java:53)
    at de.shop.bestellverwaltung.dao.BestellungDao$Proxy$_$$_WeldSubclass.findBestellungenByIds(BestellungDao$Proxy$_$$_WeldSubclass.java)
    at de.shop.bestellverwaltung.service.BestellverwaltungImpl.createLieferung(BestellverwaltungImpl.java:194)
    at de.shop.bestellverwaltung.service.BestellverwaltungImpl$Proxy$_$$_WeldSubclass.createLieferung(BestellverwaltungImpl$Proxy$_$$_WeldSubclass.java)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.jboss.weld.interceptor.proxy.SimpleInterceptionChain.invokeNextInterceptor(SimpleInterceptionChain.java:84)
    at org.jboss.weld.interceptor.proxy.InterceptorInvocationContext.proceed(InterceptorInvocationContext.java:127)
    at de.shop.util.LogInterceptor.log(LogInterceptor.java:87)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.jboss.weld.interceptor.proxy.SimpleMethodInvocation.invoke(SimpleMethodInvocation.java:30)
    at org.jboss.weld.interceptor.proxy.SimpleInterceptionChain.invokeNextInterceptor(SimpleInterceptionChain.java:68)
    at org.jboss.weld.interceptor.proxy.InterceptorMethodHandler.executeInterception(InterceptorMethodHandler.java:112)
    at org.jboss.weld.interceptor.proxy.InterceptorMethodHandler.invoke(InterceptorMethodHandler.java:88)
    at org.jboss.weld.bean.proxy.CombinedInterceptorAndDecoratorStackMethodHandler.invoke(CombinedInterceptorAndDecoratorStackMethodHandler.java:53)
    at de.shop.bestellverwaltung.service.BestellverwaltungImpl$Proxy$_$$_WeldSubclass.createLieferung(BestellverwaltungImpl$Proxy$_$$_WeldSubclass.java)
    at de.shop.bestellverwaltung.service.LieferverwaltungTest.createLieferung(LieferverwaltungTest.java:136)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
    at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
    at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
    at org.jboss.arquillian.junit.Arquillian$6$1.invoke(Arquillian.java:270)
    at org.jboss.arquillian.container.test.impl.execution.LocalTestExecuter.execute(LocalTestExecuter.java:60)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.jboss.arquillian.core.impl.ObserverImpl.invoke(ObserverImpl.java:94)
    at org.jboss.arquillian.core.impl.EventContextImpl.invokeObservers(EventContextImpl.java:99)
    at org.jboss.arquillian.core.impl.EventContextImpl.proceed(EventContextImpl.java:81)
    at org.jboss.arquillian.core.impl.ManagerImpl.fire(ManagerImpl.java:135)
    at org.jboss.arquillian.core.impl.ManagerImpl.fire(ManagerImpl.java:115)
    at org.jboss.arquillian.core.impl.EventImpl.fire(EventImpl.java:67)
    at org.jboss.arquillian.container.test.impl.execution.ContainerTestExecuter.execute(ContainerTestExecuter.java:38)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.jboss.arquillian.core.impl.ObserverImpl.invoke(ObserverImpl.java:94)
    at org.jboss.arquillian.core.impl.EventContextImpl.invokeObservers(EventContextImpl.java:99)
    at org.jboss.arquillian.core.impl.EventContextImpl.proceed(EventContextImpl.java:81)
    at org.jboss.arquillian.test.impl.TestContextHandler.createTestContext(TestContextHandler.java:89)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601) 
```

这些是我的域类（Lieferung）：

```
public class Lieferung implements java.io.Serializable {
    private static final long serialVersionUID = -2297631209213102849L;

    private static final String PREFIX = "Lieferung.";
    public static final String FIND_LIEFERUNGEN_BY_LIEFERNR_FETCH_BESTELLUNGEN =
                               PREFIX + "findLieferungenByLieferNrFetchBestellungen";
    public static final String PARAM_LIEFERNR = "lieferNr";

    @Id
    @GeneratedValue
    @Column(name = "lid", unique = true, nullable = false, updatable = false, precision = LONG_ANZ_ZIFFERN)
    private Long lid;

    @Column(nullable = false)
    @Temporal(TIMESTAMP)
    private Date aktualisiert;

    @Column(nullable = false)
    @Temporal(TIMESTAMP)
    private Date erzeugt;

    @Column
    @Temporal(TIMESTAMP)
    private Date lieferungsdatum;

    @ManyToOne
    @JoinColumn(name = "bestellung_fk")
    private Bestellung bestellung; 
```

这是我的域类 Bestellung：

```
public class Bestellung implements java.io.Serializable {
    private static final long serialVersionUID = -2703770025221749393L;

    private static final String PREFIX = "Bestellung.";
    public static final String FIND_BESTELLUNGEN_BY_KUNDE = PREFIX + "findBestellungenByKunde";
    public static final String FIND_BESTELLUNG_BY_ID_FETCH_LIEFERUNG =
                               PREFIX + "findBestellungenByIdFetchLieferung";
    public static final String FIND_KUNDE_BY_ID = PREFIX + "findBestellungKundeById";

    public static final String PARAM_KUNDEID = "kundeId";
    public static final String PARAM_ID = "id";

    @Id
    @GeneratedValue
    @Column(name = "bid", unique = true, nullable = false, updatable = false, precision = LONG_ANZ_ZIFFERN)
    @Min(value = MIN_ID, message = "{bestellverwaltung.bestellung.id.min}", groups = IdGroup.class)
    private Long bid = KEINE_ID;

    @OneToMany(fetch = EAGER, cascade = { PERSIST, REMOVE })
    @JoinColumn(name = "bid_fk", nullable = false)
    private List<Bestellposition> bestellpositionen;

    @OneToMany(cascade = { PERSIST, REMOVE }, mappedBy = "bestellung")
    private List<Lieferung> lieferung; 
```

您还需要什么信息。我很绝望。在这里坐了大约4天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-09-08T13:53:25.200

我在使用时看到了类似的错误`select(root.get("COLUMN_NAME"))`。最后，我必须使用 Hibernate JPA 2 Metamodel Generator 将元模型类生成到“目标/生成类/注释”中。`maven-compiler-plugin`你只需要添加一个依赖 jar 并再次构建，在我的情况下不需要玩。

```
 <dependency>
            <groupId>org.hibernate</groupId>
            <artifactId>hibernate-jpamodelgen</artifactId>
            <version>${some_version_in_properties}</version>
        </dependency> 
```

并且，为 IDE 启用注释处理，例如在 Intellij IDEA 中。

[https://docs.jboss.org/hibernate/stable/jpamodelgen/reference/en-US/html_single/](https://docs.jboss.org/hibernate/stable/jpamodelgen/reference/en-US/html_single/)

名称以结尾的新类`_` 将在类路径中。例如，对于实体类`Entity`，您将获得`Entity_.class`.

之后，您使用`select(root.get(Entity_.propName))`选择路径。

# php - PHP：从类中调用类函数

> ID：13956451
> 
> 赞同：2
> 
> 时间：2012-12-19T16:10:39.410
> 
> 标签：php, class

开始一个新的 PHP 项目并决定经过几年的 PHP 开发，我想我应该真正开始使用 PHP 类。我已经习惯了 C++ 世界中的课程，因此在将这些知识移植到 PHP 时，我不太确定一些事情。

在 C++ 中，您可以自动访问任何不带前缀的类变量，在 PHP 中，您似乎需要在所有此类访问（变量和函数）前加上`this->`. 我知道什么`this`是（或者至少我认为是指向当前类实例的指针），但我不确定它是必需的还是首选的，或者是否有任何替代方案。我的班级将大量使用同一个班级（即其本身）​​中的其他函数，因此`this->`每次都必须输入会很快耗费时间。

这些类本身很可能是单例，所以我不确定是实际使用一个类，还是只是在函数前面加上一个标识符。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T16:14:46.207

您需要引用该成员所属的对象才能访问该成员。

`$variable->`每个方法调用或属性访问都以-为前缀，`$this`这是一个引用当前对象实例的魔术变量。它的使用不是可选的。

这是（除其他原因外）因为并非 PHP 中的每个函数都是方法，还有全局函数。如果您引用一个函数而不将其与对象关联，则假定它是一个全局函数。

作为旁注，您应该避免在 PHP 中使用单例 - 使用它们不会发现性能/内存增益，因为每个同时执行的脚本都被围在自己的内存空间中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T16:16:44.190

“指针” ( `->`) != C++ 指针。

`$this`表示当前的类和实例。使用`$this->variable;`or访问所有变量`$this->function();`。

可以使用`self::$variable`或访问静态变量和函数`self::function()`

在类实例之外，必须指明类实例：`$foo->variable;`或`$foo->function();`

据我所知，如果不使用`$this->`或`self::`

关于使用函数对象......取决于你。您是否打算稍后扩展代码以添加更多功能？所有功能都有些相关吗？如果它们是单例函数，那么只写一个函数而不是一个类是没有害处的。这实际上取决于您要完成的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:18:23.493

是的，您必须`$this`在访问类方法或变量时使用。

您需要记住 PHP 不需要声明变量，因此请想象以下情况：

```
<?
class A {
  public $a = 'Hello World!';
  function hello() {
    $a = 'hello';
    echo $a;
  }
}

$object = new A();
echo $object->hello(); 
```

`$a` would be local scope and `$this->a` would be the class variable.

# ruby-on-rails - 路由到默认未找到 'catch all' 地址

> ID：13956452
> 
> 赞同：1
> 
> 时间：2012-12-19T16:10:40.930
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-routing

我正在尝试将 URL 路由`stats/non-existent-page`到默认的“未找到”页面，我想在其中显示“您的意思是”建议以及未找到的消息，如何将所有不存在的 URL 路由到默认值控制器/动作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:18:29.757

就像是：

```
match 'stats/*path' => 'default#non_existent' 
```

在您的其他 'stats/..' urls 之后添加它，这会将您的所有 stats/* 路径路由到使用`path`变量提到的控制器操作，您可以使用该变量来确定您的“您的意思是”建议..

# javascript - 具有事件的渲染部分的发布响应不起作用

> ID：13956453
> 
> 赞同：6
> 
> 时间：2012-12-19T16:10:48.997
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3.2

在 ruby​​ on rails 中，我正在尝试更新 2 个部分。

**显示.html.erb：**

```
<div id="filters"><%= render :partial => "pricelistfilters" %></div> 
```

**pricelistfilters.html.erb：**

```
<% @properties.each do |prop| %>
  #Render the page on properties (and the newproperties)
  #<select ...><option>...</option><option>...</option>
  #</select>
<% end %> 
```

**products.js** --> 渲染部分的事件

```
$(window).ready(function(){
  selectionchanges();
});
function selectionchanges(){
  $('#filters select').change(function(){
    //Doing stuff to send with ajax

    //Ajax:
    $.ajax({
      url: document.URL,
      type: 'POST',
      data: params
    });
  });
} 
```

**products_controller.rb** --> 处理所做更改的代码

```
def show
  #Changing the properties (and the pricelist properties)
  @properties #is filled
  @newproperties #is filled
  respond_to do |format|
    format.html
    format.js
  end 
end 
```

**显示.js.erb**

```
$('#filters').html('<%= escape_javascript(render :partial => "pricelistfilters") %>');
selectionChanges(); 
```

我渲染的项目非常好。但是，当我对渲染的项目做出正确的响应时，它就不再发送 ajax 了。所以我选择的项目上的事件消失了，而我确信我已经用“selectionchanges();”重置了它们。在我的 show.js.erb 文件的末尾？

谁能看到这个问题的解决方案？

提前问候和感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T20:27:26.510

尝试在**product.js**上使用 jquery 的 live 函数，如下所示：

```
$(window).ready(function(){
  selectionchanges();
});
function selectionchanges(){
  $('#filters select').live('change', function(){
    //Doing stuff to send with ajax

    //Ajax:
    $.ajax({
      url: document.URL,
      type: 'POST',
      data: params
    });
  });
} 
```

基本上，您正在替换您首先将事件“更改”绑定到的 HTML Dom 元素。使用 live，即使替换元素，jQuery 也会为您重新进行绑定。

希望能帮助到你！

# xml - “文档中根元素之后的标记必须格式正确。” 在 xml 文件中

> ID：13956456
> 
> 赞同：0
> 
> 时间：2012-12-19T16:10:59.340
> 
> 标签：xml, spring

我是 xml 和 spring 的新手。以下是 spring-servlet 文件。我从以下链接复制了它：[spring-servlet.xml](http://viralpatel.net/blogs/spring-3-mvc-tiles-plugin-tutorial-example-eclipse/)

文件代码如下：

```
 <?xml version="1.0" encoding="UTF-8"?>
<bean id="viewResolver" class="org.springframework.web.servlet.view.UrlBasedViewResolver">     
    <property name="viewClass">         
        <value>org.springframework.web.servlet.view.tiles2.TilesView</value>     
    </property> 
</bean>
<bean id="tilesConfigurer" class="org.springframework.web.servlet.view.tiles2.TilesConfigurer">     
    <property name="definitions">         
        <list>             
            <value>/WEB-INF/tiles.xml</value>         
        </list>     
    </property> 
</bean> 
```

有人可以指导我做错了什么以及如何纠正它。

提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T16:12:30.037

您没有根元素。你的 XML 看起来像

```
<bean>...</bean>
<bean>...</bean> 
```

而我希望有一个根，例如

```
<beans>
   <bean>...</bean>
   <bean>...</bean>
</beans> 
```

XML 文档必须有一个*根节点*- 一个顶级节点，您可以在它下面有多个分支。

从链接的教程：

> 从 WEB-INF 文件夹中打开 spring-servlet.xml 并在标签之间添加以下代码`<beans> </beans>`。

我认为这是你错过的一点:-)

# javascript - 映射选项中的关键功能不起作用

> ID：13956457
> 
> 赞同：0
> 
> 时间：2012-12-19T16:10:59.207
> 
> 标签：javascript, knockout.js, knockout-mapping-plugin

我无法理解`key`KnockoutJS 中映射插件的映射选项中的功能。根据文档，我了解关键功能将告诉映射插件使用什么属性来确定对象是新的还是旧的。

他们使用这个例子...... [http://knockoutjs.com/documentation/plugins-mapping.html#advanced_usage](http://knockoutjs.com/documentation/plugins-mapping.html#advanced_usage)

但它说..

> 这样，每次映射插件检查 children 数组中的项目时，它只会查看 id 属性来确定对象是完全替换还是只需要更新。

“需要更新”是什么意思？它会更新整个`children`对象吗？它只会更新`children`对象中已更改的属性？我很困惑。

他们的例子很简单，我无法让它与更真实的数据样本一起工作。这是我的问题的 jsFiddle ... [http://jsfiddle.net/rQfpr/1/](http://jsfiddle.net/rQfpr/1/)

在我的示例中，我试图仅`UserMovies`替换`self.movies[1]`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:53:00.057

这是一个可以帮助您理解交互的 JSFiddle：

注意：映射中的“更新”条目只是为了让我可以登录到控制台……除非您需要自定义更新的发生方式，否则不需要它。

[http://jsfiddle.net/jearles/wgZ59/49/](http://jsfiddle.net/jearles/wgZ59/49/)

点击“加载矩阵”，它将显示：

```
12
23
34 
```

单击“更改”，它将重新加载矩阵：

```
24
45 
```

查看我发布的控制台消息，您会看到：

```
Creating 1
Updating 1
Creating 2
Updating 2
Creating 3
Updating 3
Updating 2
Creating 4
Updating 4 
```

这确认了映射插件正在执行的操作。

最初：

```
12 - Is created and updated
23 - Is created and updated
34 - Is created and updated 
```

更新时：

```
12 - Is deleted
23 - Is changed to 24
34 - Is deleted
45 - Is added 
```

--

“键”条目通过将特定属性指定为“键”来帮助映射插件确定哪些条目是新的或现有的；否则将比较整个对象是否相等。

# digital-signature - Win7 64 位旧版 nt4 驱动程序签名问题

> ID：13956460
> 
> 赞同：3
> 
> 时间：2012-12-19T16:11:14.407
> 
> 标签：digital-signature, windows-7-x64, wdk

从 WinXP 开始，我就不再使用 Windows DDK（现在是 WDK），而且我注意到发生了很大的变化。

我正在使用最新的 Win7 DDK开发旧版 NT4 过滤器驱动程序（没有`.inf`和没有），我的环境是`.cat`

```
Windows 7 64bit
Visual Studio 2010
WinDDK v7600.16385.1
VisualDDK plugin for VS (latest version) 
```

我有问题自签名这个驱动程序，因为我仍在开发它我没有（也不知道如何获得）适当的 WHQL 证书，因此我正在遵循我在网上找到的程序。

```
@echo off

set SIGNTOOL="c:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\signtool.exe"
set MAKECERT="c:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\makecert.exe"
set PVK2PFX="c:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\pvk2pfx.exe"
set CERTPVK="C:\Users\myself\Desktop\testdriver\avtxagent\package\mycompanynametest.pvk"
set CERTPFX="C:\Users\myself\Desktop\testdriver\avtxagent\package\mycompanynametest.pfx"
set CERT="C:\Users\myself\Desktop\testdriver\avtxagent\package\mycompanynametest.cer"
set DRIVER="C:\Users\myself\Desktop\testdriver\avtxagent\package\avtxagent.sys"
set CERTSUBJ="mycompanyname (test)"

del *.cer *.pfx *.pvk
cls
%MAKECERT% -r -n "CN=mycompanyname (test)" -sv %CERTPVK% %CERT%
%PVK2PFX% -pvk %CERTPVK% -spc %CERT% -pfx %CERTPFX%
pause
cls
%SIGNTOOL% sign /v /f %CERTPFX% /t "http://timestamp.verisign.com/scripts/timestamp.dll" %DRIVER%
pause
cls
:: verification
%SIGNTOOL% verify /pa /v %DRIVER%

pause 
```

基本上我正在做的是每次生成证书（我已经尝试过只生成一次证书，仍然是同样的问题），签署我的驱动程序，然后尝试验证签名。在最后一步，验证中，我遇到了问题：

```
SignTool Error: A certificate chain processed, but terminated in a
                root certificate which is not trusted by the trust provider. 
```

显然，当我尝试以编程方式和使用 sc 安装然后启动旧版驱动程序时，我收到错误消息：

```
[SC] CreateService SUCCESS
[SC] StartService FAILED 577:

Windows cannot verify the digital signature for this file. A recent hardware or software change might have installed a file that is signed incorrectly or damaged, or that might be malicious software from an unknown source. 
```

如果我按照本指南[http://technet.microsoft.com/en-us/library/cc754841.aspx](http://technet.microsoft.com/en-us/library/cc754841.aspx)并在受信任的认证中导入证书，则验证过程会顺利进行，但我从 sc 收到相同的错误。

我究竟做错了什么 ？而且，由于文档有点缺乏，有没有人可以解释我必须做什么才能获得在生产环境中使用的适当证书？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:36:32.083

您不需要 WHQL 签名来签署内核模式驱动程序。您需要的是从 GlobalSign 或 Verisign 购买的代码签名证书（*其他人无法使用*）。当你有一个时，使用这个代码签名证书来签署你的驱动程序。注意：您还需要包含[Microsoft 的交叉证书](http://msdn.microsoft.com/en-us/library/windows/hardware/gg487315.aspx)。

或者（仅出于调试目的）您可以在不检查签名的测试模式下加载系统。为此，您需要在系统引导期间按 F8 并在菜单中选择相应的选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:17:25.693

这可能是因为您用于生成证书的私有 CA 不受系统信任。这些看起来很相关：

[http://technet.microsoft.com/en-us/library/dd441378(office.13).aspx](http://technet.microsoft.com/en-us/library/dd441378(office.13).aspx)

[http://technet.microsoft.com/en-us/library/cc754841.aspx](http://technet.microsoft.com/en-us/library/cc754841.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-05T01:58:57.227

您需要将自签名证书**作为受信任的根证书颁发机构**和**受信任的发布**者安装到**本地机器存储**中（通常`certmgr.msc`显示和管理您的用户帐户的存储）：

```
certmgr.exe -add <your.cer> -s -r localMachine ROOT
certmgr.exe -add <your.cer> -s -r localMachine TRUSTEDPUBLISHER 
```

如您所见，这里每次都生成一个新证书是非常不切实际的。您宁愿生成一次然后重用。

[（由[http://winitpro.ru/index.php/2014/05/08/kak-samostoyatelno-podpisat-drajver-dlya-windows-7/](http://winitpro.ru/index.php/2014/05/08/kak-samostoyatelno-podpisat-drajver-dlya-windows-7/)提供；相同效果的说明位于[https://technet.microsoft .com/en-us/library/dd919238(v=ws.10).aspx](https://technet.microsoft.com/en-us/library/dd919238(v=ws.10).aspx) )]

# javascript - JQuery Post 发送表单数据而不是 JSON

> ID：13956462
> 
> 赞同：49
> 
> 时间：2012-12-19T16:11:22.510
> 
> 标签：javascript, jquery, json

试图发送json。这是我的功能：

```
var object = ... ;

$.ajax({
      type: 'POST',
      url: '<url>',
      contentType: 'application/json; charset=utf-8',
      dataType: 'json',
      data: object
    }); 
```

但是每当我检查 Chrome 时，它​​总是将其作为查询参数发送：

```
Request Payload:
startDate=Wed+Dec+19+2012+19%3A00%3A00+GMT-0500+(EST)&endDate=Thu+Dec+20+2012+19%3A00%3A00+GMT-0500+(EST)& 
```

如何让它以 JSON 格式发送？

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-12-19T16:14:28.797

和`JSON.stringify(object)`

样本：

```
$.ajax({
    type: 'POST',
    url: '<url>',
    contentType: 'application/json; charset=utf-8',
    dataType: 'json',
    data: JSON.stringify(object)
}); 
```

注意 JSON.stringify 并非在所有浏览器 ( [http://caniuse.com/#feat=json](http://caniuse.com/#feat=json) ) 中都受支持，尤其是 IE7 及更低版本的浏览器。

如果你也需要支持这个浏览器，你可以使用这个 Javascript 库：[https ://github.com/douglascrockford/JSON-js](https://github.com/douglascrockford/JSON-js)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T16:13:47.550

**使用**字符串化**`JSON.stringify(object)`**

 **将字段修改`data`为：

```
...
data: JSON.stringify(object),
... 
```

你这样做的方式，IMO，jQuery 将参数视为字典（键值对），并从中构造一个百分位数编码的字符串；因此您会看到该输出。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-19T16:32:27.237

我发现使用 JSON 作为这样的字段以默认的“application/x-www-form-urlencoded”格式发送数据更容易：

```
$.ajax({
    type: 'POST',
    url: '<url>',
    dataType: 'json',
    data: {json:JSON.stringify(object)}
}); 
```

在服务器上使用常规方法接收名为`json`.

刚刚分享，看看这是否对你有效。**

# android - AES 填充问题 Android

> ID：13956463
> 
> 赞同：1
> 
> 时间：2012-12-19T16:11:28.130
> 
> 标签：android, encryption, padding

当我在 Java 中运行以下代码时，输​​出是 128 位（16 字节）的倍数。

Android 中完全相同的代码不再是 16 字节的倍数，表明填充失败。

有任何想法吗？

```
//Compress, Encrypt, Decrypt, Decompress variables 
public final static String Secretkey = "###hidden######";
public final static String VectorInitializationKey = "###hidden###";
public final static String transformation = "AES/CFB8/PKCS5Padding";  

public static byte[] encryptandCompress(byte[] input)
{
    ByteArrayOutputStream ms = new ByteArrayOutputStream();
    GZIPOutputStream gos = null; // Added
    CipherOutputStream cos= null; // Added

    SecretKeySpec skeySpec = new SecretKeySpec(Secretkey.getBytes(), "AES");
    Cipher cipher;

    try {
        cipher = Cipher.getInstance(transformation);
        IvParameterSpec iv = new IvParameterSpec(VectorInitializationKey.getBytes());
        cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv);
        cos = new CipherOutputStream(ms, cipher ); 
        gos= new GZIPOutputStream (cos);
        gos.write(input);
        gos.close(); // Must be called before we return bytes from ms
        cos.close();
        byte[] toReturn = ms.toByteArray();  
        Log.d("FileWriter", "Encrypted and compressed " + input.length + " bytes to " + toReturn.length + " bytes");
        Log.d("FileWriter", "Encrypted and compressed " + toReturn.length/16.0 + " blocks written");

        return toReturn;        

    } catch (Exception e) {
        Log.e("FileWriter", "Compression failed: " + e.getMessage());
        return null;
    }

    finally 
    {
        try 
        {
            if (gos != null) 
            {
                gos.close();
            }
            if (cos != null) 
            {
                cos.close();
            }
            if (ms != null) 
            {
                ms.close();
            }
        } 
        catch (IOException e) {

            e.printStackTrace();
        }

        catch (Exception e) 
        {
            e.printStackTrace();
        }
    }
} 
```

# javascript - 当网页边距上的元素变为负X像素jQuery时禁用按钮

> ID：13956465
> 
> 赞同：-1
> 
> 时间：2012-12-19T16:11:38.007
> 
> 标签：javascript, jquery, html

> **可能重复：**
> [如果 margin-left = -3200 则禁用按钮](https://stackoverflow.com/questions/13955652/disable-button-if-margin-left-3200)

我有一个页面，当它加载时，有一个 div 是 margin-left:0px; 单击按钮时，该元素以 600 像素的增量向左移动。不知何故，我想尝试听一下元素何时距左侧 -3200 像素，但我似乎无法弄清楚。

谁能看到我哪里出错了？

```
$(".hero-carousel").on("click", function(event){
    if($(this).css("margin-left") == -4480) {
        alert('test');    
    } else {};
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:15:15.833

试试这个...

```
$(".hero-carousel").on("click", function(event){
        var left = parseInt($(this).css("margin-left"), 10);
        if (left <= -3200) {
            //  do something here
        }
    };
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:13:07.097

在您的情况下，`.css("margin-left")`可能会返回**-4480px 之**类的 srting ，并且您正在将其与整数进行比较。所以最后去掉 px 解析成数字

实际上，正如@lan 所说的`parseInt()`那样，它会为您去掉“px”并将其转换为整数

# gridview - 如何在 RowDataBound 的 gridview 中更改超链接的 URL

> ID：13956467
> 
> 赞同：1
> 
> 时间：2012-12-19T16:11:44.293
> 
> 标签：gridview, hyperlink, rowdatabound

我有带有包含超链接的模板字段的gridview。我想根据我的 SQL 数据（绑定到网格的数据表）的特定字段中的一些逻辑来更改超链接的 URL。我想我需要使用 RowDataBound 事件，检查数据表字段的值并根据需要设置 NavigateURL。

RowDataBound期间如何访问数据表中列的值？

我可以确定它是否不是页眉或页脚行，并使用下面的代码访问超链接控件。但是在我的逻辑上画一个空白来查看数据以确定要设置哪个 URL。

```
if (e.Row.RowType == DataControlRowType.DataRow)
    {
        HyperLink hl = (HyperLink)e.Row.FindControl("hlStatus");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:21:49.097

[Eval 方法](http://msdn.microsoft.com/en-us/library/4hx47hfe.aspx)会给你你所追求的。

```
protected void GridView_RowDataBound(object sender, GridViewRowEventArgs e) {
    if (e.Row.RowType == DataControlRowType.DataRow) {
        HyperLink hl = (HyperLink)e.Row.FindControl("hlStatus");
        hl.NavigateUrl = "http://www.google.com?q=" + DataBinder.Eval(e.Row.DataItem, "ColumnName");
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:40:45.657

这似乎可以解决问题。如果有更好的方法请告诉我。

```
DataRowView drv = (DataRowView)e.Row.DataItem;
int iStatusCode =  Convert.ToInt32( drv[myDatAccessLayer.Class.Property.ToString()]); 
```

它给了我当前行中我想要的列的值。

# c# - 什么会影响 nhibernate 批量插入性能？

> ID：13956473
> 
> 赞同：5
> 
> 时间：2012-12-19T16:12:08.540
> 
> 标签：c#, nhibernate

我在一个基于 c# 和 Fluent NHibernate 构建的项目中有各种大数据修改操作。数据库是 sqlite（在磁盘上而不是在内存中，因为我对性能感兴趣）

我想检查这些性能，所以我创建了一些测试来输入大量数据并让流程完成它们的工作。其中两个过程的结果让我很困惑。

第一个是一个相当简单的案例，将 XML 文件中提供的数据进行一些轻量级处理并将其导入。XML 包含大约 172,000 行，该过程总共需要大约 60 秒才能运行，实际插入大约需要 40 秒。

在接下来的过程中，我对同一组数据进行了一些处理。所以我有一个数据库，一张表中有大约 172,000 行。然后该过程处理这些数据，进行一些更繁重的处理并生成一大堆数据库更新（插入和更新到同一个表）。总的来说，这会导致插入大约 50,000 行并更新 80,000 行。在这种情况下，处理大约需要 30 秒，这很好，但是将更改保存到数据库需要 30 多分钟！它在完成之前崩溃并出现 sqlite '磁盘或 i/o 错误'

所以问题是：为什么第二个过程中的插入/更新这么慢？他们使用相同的连接处理同一个数据库的同一张表。在这两种情况下，都使用 IStatelessSession 并将 ado.batch_size 设置为 1000。

在这两种情况下，代码看起来都像这样进行更新：

```
BulkDataInsert((IStatelessSession session) =>
{
    foreach (Transaction t in transToInsert) { session.Insert(t); }
    foreach (Transaction t in transToUpdate) { session.Update(t); }
}); 
```

（尽管第一个进程没有“transToUpdate”行，因为它只是插入 - 删除更新行并仅进行插入仍然需要将近 10 分钟。） transTo* 变量是列表，其中包含要更新/插入的对象。

BulkDataInsert 创建会话并处理数据库事务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T19:04:24.263

我不明白你的第二个过程。但是，这里有一些事情需要考虑：

1.  表上是否有任何聚集或非聚集索引？
2.  你有多少个磁盘驱动器？
3.  在第二个测试中有多少线程正在写入数据库？

您似乎遇到了 IO 瓶颈，可以通过拥有更多磁盘、更多线程、索引等来解决。

所以，假设有很多事情，这就是我“认为”正在发生的事情：

1.  在第一次测试中，您的表可能没有索引，并且由于您只是插入数据，因此它是在单个线程中的顺序插入，这可能非常快 - 特别是如果您正在写入一个磁盘。
2.  现在，在第二个测试中，您正在读取数据，然后更新数据。您的 SQL 实例必须找到它需要更新的记录。如果您没有任何索引，则此“查找”操作基本上是表扫描，这将针对这 80,000 行更新中的每一个进行。这将使您的应用程序非常缓慢。

您可能会做的最简单的事情是在表上添加一个聚集索引以获得唯一键，最好的选择是使用您在 where 子句中使用的列来“更新”这些行。

希望这可以帮助。

免责声明：我做了很多假设

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T10:24:44.333

问题是由于我的测试设置。与基于 nhibernate 的项目一样，我一直在使用内存中的 sqlite 数据库进行单元测试。这些工作很好，但一个缺点是，如果您关闭会话，它会破坏数据库。因此，我的工作单元实现包含一个“PreserveSession”属性，以保持会话活动并在需要时创建新事务。

我的新性能测试使用磁盘数据库，但它们仍然使用通用代码来设置测试数据库，因此将 PreserveSession 设置为 true。

似乎有几个会话都保持打开状态（即使它们没有做任何事情）一段时间后开始导致问题，包括性能下降和磁盘 IO 错误。

我在 PreserveSession 设置为 false 的情况下重新运行了第二个测试，然后我立即从 30 多分钟下降到 2 分钟以下。这更符合我的预期。

# php - 更改 PHP 类函数的隐私范围

> ID：13956475
> 
> 赞同：4
> 
> 时间：2012-12-19T16:12:15.170
> 
> 标签：php, class, scope, abstract-class

我有一个抽象类，它扩展类以提供基本的 orm 函数。它提供的所有功能都受类保护，因此它可以决定哪些字段对外部对象公开可用。但最近，我开始使用一些不需要如此复杂性的较小数据类，并且将受益于公开可用的 orm 编辑功能并且没有特殊功能。

由于函数的命名约定足够紧凑，有没有办法将现有函数更改为公共（不需要相同的类或临时扩展），或者我必须使用`traits`php 的新功能来添加一个现有类，其中包含作为内部受保护函数的抽象层的函数的公共版本？

编辑：

对于特征方法，我认为它会有所帮助：

```
abstract class ORMClass {
    public function __construct($pk) {}
    protected function __get($k) {}
    protected function __set($k,$v) {}
    protected function save() {}
}

trait publicORM {
    public function __get($k) { return parent::__get($k); }
    public function __set($k,$v) { return parent::__set($k,$v); }
    public function save() { return parent::save(); }
}

class myOrm extends ORMClass {
    use publicORM;
    protected static $table = 'myTable';
} 
```

所以我可以`myOrm`像这样使用：

```
$myOrm = new myOrm(1);
$myOrm->foo = 'alice'
echo $myOrm->bar;
$myOrm->save(); 
```

不需要：

```
public function __get($k) { return parent::__get($k); }
public function __set($k,$v) { return parent::__set($k,$v); }
public function save() { return parent::save(); } 
```

列在 myOrm 类中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T23:03:13.143

由于这从未得到正确回答，因此我添加了查尔斯的答案。

这可以使用 PHP 的[Reflection](http://www.php.net/manual/en/book.reflection.php)库来完成，该库自版本 5 起内置于 PHP。这种特殊方法相当 hacky：

```
<?php

abstract class BaseClass {
    protected function testMe() {
        echo 'I WORK!';
    }
}

class ConcreteClass extends BaseClass {
    // Class Code
}

$method = new ReflectionMethod('BaseClass', 'testMe');
$method->setAccessible(true);
$method->invoke(new ConcreteClass()); // Prints 'I WORK!' 
```

这是使用扩展基类但使用公共方法的临时抽象类的更好方法：

```
<?php

abstract class BaseClass {
    protected function testMe() {
        echo 'I WORK!';
    }
}

abstract class PublicBaseClass extends BaseClass {
    public function testMe() {
        parent::testMe();
    }
}

class ConcreteClass extends PublicBaseClass {
    // Class Code
}

$obj = new ConcreteClass();
$obj->testMe(); 
```

# ruby-on-rails-3 - rails redirect_to url 不起作用，返回：过滤器链停止为：redirect_to_https 呈现或重定向

> ID：13956476
> 
> 赞同：2
> 
> 时间：2012-12-19T16:12:22.237
> 
> 标签：ruby-on-rails-3, redirect, destroy

在这里难住了，在我们的网站上，我们有一个常见问题解答，在管理方面，我们可以添加/编辑/删除常见问题解答类别和这些类别中的单个常见问题解答。

在我的 faq_controller 我有这两种方法：

```
def destroy
  faq = load_faq_for_faq_category
  faq.destroy if faq
  redirect_to "/faq_categories/#{params[:faq_category_id]}"
end

private

def load_faq_for_faq_category
  faq = Faq.where(:id => params[:id]).first!

  if faq.faq_category_id != params[:faq_category_id].to_i
    raise ActiveRecord::RecordNotFound, "FAQ doesn't belong to specified FAQ Category"
  end
  faq
end 
```

这一行：

```
redirect_to "/faq_categories/#{params[:faq_category_id]}" 
```

以前是：

```
redirect_to :back 
```

但这对我不起作用，我切换到更明确的路径，但无论我做什么，它都不会破坏常见问题解答。

我的服务器日志这样说：

```
Started DELETE "/faq_categories/4/faq/50" at 2012-12-19 15:44:32 +0000
Processing by FaqController#destroy as HTML
Parameters: {"faq_category_id"=>"4", "id"=>"50"}
Redirected to http://my_staging_server/faq_categories/4/faq/50
Filter chain halted as :redirect_to_https rendered or redirected
Completed 302 Found in 1ms (ActiveRecord: 0.0ms) 
```

不过，最奇怪的是它可以在我的本地机器上运行。我的本地日志如下所示：

```
Started DELETE "/faq_categories/1/faq/5" for 127.0.0.1 at 2012-12-19 09:03:05 -0700
Processing by FaqController#destroy as HTML
Parameters: {"faq_category_id"=>"1", "id"=>"5"}
User Load (0.2ms)  SELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1
Role Exists (0.1ms)  SELECT 1 AS one FROM `roles` INNER JOIN `roles_users` ON `roles`.`id` = `roles_users`.`role_id` WHERE `roles_users`.`user_id` = 1 AND `roles`.`lookup_code` = 'root' LIMIT 1
Faq Load (0.1ms)  SELECT `faqs`.* FROM `faqs` WHERE `faqs`.`id` = 5 LIMIT 1
(0.2ms)  BEGIN
CACHE (0.0ms)  SELECT `faqs`.* FROM `faqs` WHERE `faqs`.`id` = 5 LIMIT 1
SQL (0.2ms)  DELETE FROM `faqs` WHERE `faqs`.`id` = 5
SQL (0.3ms)  UPDATE `faqs` SET position = (position - 1) WHERE (`faq_category_id` = 1 AND position > 1)
(45.1ms)  COMMIT
Redirected to http://localhost:3000/faq_categories/1
Completed 302 Found in 54ms (ActiveRecord: 46.3ms) 
```

哪个是正确的所以...

**TL：DR**为什么这`redirect_to`在我的登台服务器上不起作用，这`filter chain halted as :redirect_to_https`条线到底是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T18:06:25.620

可能是您在生产配置文件中设置了**HTTPS**，但没有在开发配置文件中设置。

假设您的控制器称为**faq_categories**，该方法称为**show**

你可以这样做：

```
class faq_categories_Controller
    skip_filter :redirect_to_https
end 
```

这将阻止 HTTPS 检查

**或者你可以这样做：**

```
redirect_to {:protocol => 'https://', :controller => 'faq_categories', :action => 'show'} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T18:39:40.453

该网站已经在使用 https，所以我仍然不知道为什么过滤器链会中断，但 @code4j 让我朝着正确的方向前进。

将此添加到我的 faq_controller 解决了问题：

```
skip_filter :redirect_to_https 
```

# c# - 如何从匿名委托或 lambda 访问安全关键字段？

> ID：13956481
> 
> 赞同：19
> 
> 时间：2012-12-19T16:12:46.050
> 
> 标签：c#, .net, security, .net-4.0, .net-4.5

## 设想

假设我们有下一个代码：

```
[SecuritySafeCritical]
public void SomeMethod()
{
    SomeCriticalClass critical = new SomeCriticalClass();

    Action someDelegate = () => 
    {
         critical.Do();
    }

    someDelegate();
} 
```

1.  `SomeMethod`签名具有`[SecuritySafeCritical]`属性。
2.  `SomeCriticalClass``[SecurityCritical]`是在类或方法方法级别具有属性的某个类`Do`。
3.  我们创建了一个匿名委托，自动推断为`Action`.

## 问题

调用`critical.Do()`会导致 a ，因为安全透明方法（匿名方法）正在尝试访问安全关键字段（SomeCriticalClass 局部变量）。~~`MethodAccessException`~~ `FieldAccessException``critical`

## 问题

***你是如何克服这一点的？***

简单的方法是实现一个标记为的实际方法，`[SecuritySafeCritical]`而不是使用匿名委托。但这使我们进入了匿名代表和lambas时代。*我不想要这个。*

其他简单的方法就是*不使用安全透明性*。**这不是解决方案。**

几乎所有来自 Microsoft 和开源社区的可用库在设计时都没有考虑到安全透明性。`[SecuritySafeCritical]`也就是说，任何自己的自定义代码都必须通过方法`[SecurityCritical]`/属性/委托与第三方库进行互操作。

实际上，我相信安全透明性是一个很好的工具，因为它可以强制进行更好和安全的软件设计，关键操作非常本地化，并且其余代码以最少的权限工作。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-19T17:20:20.080

抱歉，我等不及其他回答者了……我找到了解决方案！

通过实验，我可以确定使用`[SecuritySafeCritical]`具有在其主体中创建匿名方法的方法的类进行标记，可以**解决问题！**

换句话说，或*谈论代码*：

```
[SecurityCritical]
public class SomeCriticalClass
{
      [SecurityCritical]
      public void Do()
      {
      }
}

[SecuritySafeCritical]
public sealed class SomeClass
{
    [SecuritySafeCritical]
    public void SomeMethod()
    {
          SomeCriticalClass critical = new SomeCriticalClass()

          // No more FieldAccessException!
          Action action = () => critical.Do();         
    }
} 
```

我想澄清一下：

*   `SomeClass`用标记类`[SecuritySafeCritical]`并不意味着**所有声明的方法都将`[SecuritySafeCritical]`默认**为。*这意味着该类可以被部分信任的调用者使用*。您仍然需要用`[SecuritySafeCritical]`属性标记那些可以被部分信任的调用者访问的方法、属性或字段。

*   似乎`[SecuritySafeCritical]`在类级别使局部变量和匿名方法（也可能是匿名对象！）安全至关重要。

***是的！*** *我希望我的问题和我自己的回答都对大家有用，因为我相信我的问题中描述的情况会经常发生！*

# sql - 按证券计算 4 个季度移动平均线

> ID：13956483
> 
> 赞同：5
> 
> 时间：2012-12-19T16:12:55.867
> 
> 标签：sql, sql-server, tsql

为了简化我的问题，假设我有一个按安全性划分的季度日期和销售数字表。

month_end_date、ID、销售额

我需要计算每个 ID 的 4 个季度移动平均值。我尝试执行以下操作：

```
-- CALCULATE FOUR QUARTER AVERAGES
-- CREATE INDEX OF DATES
SELECT *, date_idx=RANK() OVER(PARTITION BY ID ORDER BY month_end_date)
INTO #Temp_Date_Index
FROM #Temp_industrials
GO
CREATE INDEX idx_1 on #Temp_Date_Index(ID, date_idx)
GO

-- CALCULATE MOVING AVERAGE
SELECT MAX(month_end_date), ID, Sales_avg=AVG(Sales)
INTO #Temp_4Q_Avgs
FROM #Temp_Date_Index
WHERE date_idx>=4 AND (date_idx BETWEEN date_idx AND (date_idx-4))
GROUP BY ID 
```

创建日期索引的第一步工作正常，但“计算移动平均”部分给我一个错误“对象或列名丢失或为空”。如果我`MAX(month_end_date)`从 SELECT 行中取出它，它运行没有错误，但给了我一个空表结果。

也许我的方法存在根本缺陷。

提前感谢您的帮助。

还尝试使用子查询：

```
SELECT end_of_period=MAX(month_end_date), ID, 
op_inc_avg=AVG(
SELECT r.Sales
FROM #Temp_Date_Index r
WHERE r.date_idx BETWEEN l.date_idx AND (l.date_idx-3)
) 
```

FROM #Temp_Date_Index l WHERE r.date_idx>=4 GROUP BY ID

但我得到

消息 156，级别 15，状态 1，第 3 行关键字“SELECT”附近的语法不正确。消息 102，级别 15，状态 1，第 6 行 ')' 附近的语法不正确。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T18:48:54.300

我的同事向我展示了如何做到这一点：

```
-- CALCULATE FOUR QUARTER AVERAGES
-- CREATE INDEX OF DATES
DROP TABLE #Temp_Date_Index
GO
SELECT *, date_idx=RANK() OVER(PARTITION BY gvkey ORDER BY month_end_date)
INTO #Temp_Date_Index
FROM #Temp_industrials
GO
CREATE INDEX idx_1 on #Temp_Date_Index(gvkey, date_idx)
GO

-- CALCULATE MOVING AVERAGE
DROP TABLE #Temp_4Q_Avgs
GO
SELECT l.gvkey, l.date_idx, mov_avg=AVG(r.op_inc_ratio)
INTO #Temp_4Q_Avgs
FROM #Temp_Date_Index l, #Temp_Date_Index r
WHERE r.gvkey=l.gvkey AND (r.date_idx BETWEEN (l.date_idx-3) AND l.date_idx)AND        r.date_idx>=4
GROUP BY l.gvkey, l.date_idx
GO
CREATE INDEX idx_1 on #Temp_4Q_Avgs(month_end_date, gvkey)
GO 
```

希望别人可以受益。

# c - 在数组中输入带有空格的名称或地址

> ID：13956488
> 
> 赞同：1
> 
> 时间：2012-12-19T16:13:20.143
> 
> 标签：c, arrays

> **可能重复：**
> [如何允许使用 scanf 输入空格？](https://stackoverflow.com/questions/1247989/how-do-you-allow-spaces-to-be-entered-using-scanf)
> [如何使用 scanf() 扫描带有空格的字符串？](https://stackoverflow.com/questions/13726499/how-can-i-scan-strings-with-spaces-in-them-using-scanf)

C 新手，我觉得这应该很简单，但由于某种原因，我没有看到明确的答案。

尝试将名称和地址写入文件，但如果我输入“FirstName LastName”，则只会将 FirstName 输入文件。与地址相同。有没有办法接受整个名称和文件中的空格？

```
struct person{
     char name[20];
     char address[50];
     char telno[20];
} info;

fp=fopen("contacts","a")

printf("Enter Name : ");
scanf("%s",info.name);

printf("Enter Address : ");
scanf("%s",info.address);

fprintf(fp,"%20s %20s %20s",info.name,info.address,info.telno);
fclose(fp); 
```

C新手，请原谅我的无知。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:16:58.227

将“空白”读入字符串的唯一方法`scanf()`是使用否定扫描集：

```
// This will read into comment everything up until the newline
scanf(" %[^\n]",info.name); 
```

通常，您将得到的答案是“不使用 scanf”，`fgets()`而是使用：

```
fgets(info.name, sizeof info.name, stdin); 
```

不要忘记很多有关[scanf()](http://www.cplusplus.com/reference/cstdio/scanf/)和[fgets()](http://www.cplusplus.com/reference/cstdio/fgets/)的信息，其他信息很容易通过快速搜索获得。

* * *

**编辑：** `I tried replacing scanf with fgets but when I run the program it skips past the "Enter Name:"`

如果它被您“跳过” `fgets()`，则意味着您`fgets()`刚刚读取了位于`stdin`缓冲区中的剩余字符。我敢打赌这是一个换行符。

输入字符串时：

```
john smith 
```

您将`'\n'`在`'h'`. 这意味着`scanf()`将阅读字母并离开换行符，`fgets()`另一方面将阅读所有内容直到/包括换行符。因此，如果您要这样做：

```
scanf("%s",info.name);

fgets(info.address, sizeof info.address, stdin); 
```

`fgets()`似乎被“跳过” 。如果您说将两者都替换`fgets()`为跳过第一个，那么您的`stdin`缓冲区不干净，您必须先准备一些东西，然后在上面留下换行符。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T16:15:43.333

[`scanf(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/scanf.3.html)找到空格时停止转换参数。试试[`fgets(3)`](http://www.kernel.org/doc/man-pages/online/pages/man3/fgets.3.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T16:16:48.880

> 有没有办法用空格接受全名

是`fgets()`的，使用（通常建议使用此函数而不是`scanf()`，因为`scanf()`它并不总是按照您的想法执行）：

```
fgets(info.name, sizeof(info.name), stdin); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T16:22:29.013

scanf("%[^\r\n]",info.name);

这意味着接受除 CR 和 LF 之外的所有内容。

# objective-c - iOS：如果您长按然后释放它，UIButton 文本不会立即更改

> ID：13956490
> 
> 赞同：3
> 
> 时间：2012-12-19T16:13:25.593
> 
> 标签：objective-c, ios, uibutton

我的目标是 iOS 5.1 并使用情节提要。我在 UITableViewCell 中有一个 UIButton，当点击它时，它会调用“Touch Up Inside”方法，调用 Web 服务，然后在完成处理程序中，通过调用为所有按钮状态设置文本的函数来更新 UIButton 的文本像这样：

```
+(void) setButtonText:(NSString *)text forButton:(UIButton *)button
{
    [button setTitle:text forState:UIControlStateNormal];
    [button setTitle:text forState:UIControlStateDisabled];
    [button setTitle:text forState:UIControlStateHighlighted];
    [button setTitle:text forState:UIControlStateSelected];
} 
```

如果您只是点击按钮，它会很好用，但是如果您长按它然后释放，Web 服务调用和完成处理程序会被调用并立即返回，但是在按钮上的文本更新之前大约需要 5 秒。我尝试在按钮和 self.view 上调用 setNeedsDisplay。当有人长按+发布时，我有什么想法可以让文本立即更新吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:21:46.793

您不一定需要检测长按，只需更改按钮触发选择器的状态即可。如果您以编程方式执行此操作，则应该具有以下内容：

```
[self.myButton addTarget:self action:@selector(mySelector) forControlEvents:UIControlEventTouchDown]; 
```

在 XIB/Storyboard 中，该选项在“Touch Down”下的调色板中可用：

![在此处输入图像描述](../Images/60be56fbdd1fd61502389ced9ece110a.png)

这会导致在触摸按钮时立即触发选择器，而不是我可以假设的，您已设置为`UIControlEventTouchUpInside`，其中当触摸在按钮附近结束时发送事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T17:47:28.173

发现了问题。我在 completionHandler 中设置按钮文本，它运行一个与 UI 线程不同的线程。因此，延迟 5 秒的奇怪未定义行为。解决方法是调用...

```
[self performSelectorOnMainThread:@selector(receivedData:) withObject:result waitUntilDone:YES]; 
```

...然后在“receivedData”方法中调用 setButtonText。

在 UI 上更新内容时的黄金法则是在 UI 线程中更新。

显然，如果我在我的问题中发布了更多代码，您就会看到这一点。对于那个很抱歉。至少吸取了教训。

# c# - 图像未显示在报表查看器上，但链接在设计模式下打开

> ID：13956496
> 
> 赞同：3
> 
> 时间：2012-12-19T16:13:41.827
> 
> 标签：c#, visual-studio-2010, reporting

我正在尝试将本地磁盘中的任何图像添加到报表查看器中，但没有成功。
首先，我将 Image 控件拖到报告中，并将 Value 属性设置为各种路径。例如：`="file://C:/Desert.jpg"`、`="file:\\\C:\Desert.jpg"`等。
在设计模式下，我`Ctrl + Click`在链接和视觉工作室能够找到图像。
当我运行该项目时，我在显示带有图像的报告的表单上出现**x错误。**
如果我尝试将该值设置为位于本地服务器上的 http 链接，则图像会正确显示。我已将`EnableExternalImages`属性设置为 true。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T08:05:28.247

我认为您必须将图像嵌入到您的报告中

为此，您必须：

1.  在 RDLC 中添加图像控件
2.  确保图像源设置为`Embedded`
3.  单击`Import`并浏览到您的图像

此时，您应该也可以在预览中看到该图像。为了更安全，在设计中点击图片框，在属性框中搜索`MIMEType`并选择`image/jpg`

现在尝试呈现您的报告。（如果你想遵循这种方式，你可以参考[这篇博文](http://weblogs.asp.net/rajbk/archive/2010/05/22/adding-an-expression-based-image-in-a-client-report-definition-file-rdlc.aspx)）

如果您必须使用不同的徽标创建相同的报告，则此解决方案不适合：我发现[这个博客](http://hintdesk.com/c-excel-image-pdf-report-with-rdlc-in-masterdetails-and-multicolumn/)解释了如何创建一个`ReportParameter`存储徽标的动态路径的博客（第 2 段`4.`）

这里[还有另一个](http://www.codeproject.com/Questions/160037/How-to-Pass-Image-in-Microsoft-Report)外部图像的例子。注意他使用`file:///`（三个斜线）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:20:05.020

我相信图像源需要与报告相关。

请参阅：[源元素 (RDL)](http://msdn.microsoft.com/en-US/library/ms152863%28v=sql.90%29.aspx)

> 值包含一个常数或一个表达式，其计算结果为报表服务器上图像的相对路径。

尝试将图像放在与可执行文件相同的文件夹中，并将图像的文件名放在源属性中。

编辑：澄清，设置`Source`为“外部”和`Value`“Desert.jpg”。

# hibernate - Openshift 数据源不工作

> ID：13956499
> 
> 赞同：2
> 
> 时间：2012-12-19T16:13:47.440
> 
> 标签：hibernate, spring-security, jboss7.x, openshift

我在 openshif 中有一个项目，我正在尝试使用 mysql 数据源配置模块。但它不起作用。

这是代码`hibernate.cfg`：

 `````
<hibernate-configuration>
    <session-factory>
        <property name="dialect">org.hibernate.dialect.MySQL5InnoDBDialect</property>
        <property name="connection.datasource">datasources/MysqlDS</property>
        <property name="current_session_context_class">thread</property>
        <property name="show_sql">false</property>
        <property name="hibernate.hbm2ddl.auto">update</property>
        <mapping class="com.wavetech_st.usuario.Usuario" />
    </session-factory>
</hibernate-configuration> 
````  `这是代码`applicationContext-security.xml`：

```
 <authentication-manager>
    <authentication-provider>
        <password-encoder hash="sha" />
        <jdbc-user-service data-source-ref="homeDataSource"
                           authorities-by-username-query="SELECT u.emailUsuario, p.permissao FROM Usuario u, permissaoUsuario p WHERE u.codigoUsuario = p.usuario AND u.emailUsuario = ?"
                           users-by-username-query="SELECT emailUsuario, senhaUsuario, ativoUsuario FROM Usuario WHERE emailUsuario = ?"/>
    </authentication-provider>
 </authentication-manager> 
```

这是代码`applicationContext.xml`：

```
<bean id="homeDataSource" class="org.springframework.jndi.JndiObjectFactoryBean">
    <property name="jndiName">
        <value>datasources/MysqlDS</value>
    </property>
</bean> 
```

它的配置是`standalone.xml`：

```
<datasource jta="false" jndi-name="java:jboss/datasources/MysqlDS" enabled="true" use-java-context="true" pool-name="MysqlDS" use-ccm="false">
  <connection-url>jdbc:mysql://127.5.211.129:3306/testehome</connection-url>
  <driver>mysql</driver>
  <security>
    <user-name>user</user-name>
    <password>mypassword</password>
  </security>
  <validation>
    <validate-on-match>false</validate-on-match>
    <background-validation>false</background-validation>
  </validation>
  <statement>
    <share-prepared-statements>false</share-prepared-statements>
  </statement>
</datasource>
<driver name="mysql" module="com.mysql.jdbc">
  <xa-datasource-class>com.mysql.jdbc.jdbc2.optional.MysqlXADataSource</xa-datasource-class>
</driver> 
```

我用 ssh 访问了我的项目。检查文件 teste.war.failed。我可视化了这个文件：

```
{"JBAS014653: Composite operation failed and was rolled back. Steps that failed:" => {"Operation step-2" => {"JBAS014671: Failed services" => {"jboss.web.deployment.default
-host./testehome" => "org.jboss.msc.service.StartException in service jboss.web.deployment.default-host./testehome: JBAS018040: Failed to start context"}}}} 
```

我在路径中配置了一个 mysql 模块`jbossas-7/jbossas-7/modules/com/mysql/jdbc/main/`：

```
module.xml  mysql-connector-java-5.1.18-bin.jar 
```

这是配置`module.xml`：

```
<module xmlns="urn:jboss:module:1.0" name="com.mysql.jdbc">
    <resources>
        <resource-root path="mysql-connector-java-5.1.18-bin.jar"/>
    <!-- Insert resources here -->
    </resources>
    <dependencies>
        <module name="javax.api"/>
        <module name="javax.transaction.api"/>
    </dependencies>
</module> 
```

请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T17:49:59.357

不建议更改文件设置standalone.xml。我遇到了问题，因为我正在改变它的内容。我按照提示解决了这个问题：[OpenShift](https://openshift.redhat.com/community/kb/kb-e1076-default-database-connectivity-configurations-for-jboss-applications) ;-)``

# jquery - 使用 ajax 选项卡从页面内容中链接到 JQuery 选项卡

> ID：13956504
> 
> 赞同：1
> 
> 时间：2012-12-19T16:14:19.190
> 
> 标签：jquery

我正在尝试[从页面内容中执行此链接到 JQuery 选项卡](https://stackoverflow.com/questions/6405904/link-to-jquery-tab-from-within-page-content)

但是我的页面是从其他页面加载的

```
<ul>
    <li><a href="#profile">Profile</a></li>
    <li><a href="/account/honors.jsp">Honors</a></li>
    <li><a href="/account/history.jsp">History</a></li>
    <li><a href="/account/following.jsp">Following</a></li>
</ul> 
```

如何引用 ajax 页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:48:44.310

这是我使用的代码，将其添加到我的 onload 函数中。

```
function jumpToTab() {
    hashNum = window.location.hash.replace('\#','');
    $("#profileTabs").tabs('select',hashNum);
}

jumpToTab();    

$(window).bind('hashchange', function() {
   jumpToTab();
}); 
```

链接看起来像

```
<a href="tabsPage">Tab One</a>
<a href="tabsPage#1">Tab Two</a>
<a href="tabsPage#2">Tab Three</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-14T03:26:07.763

在过去的两天里，我一直在研究这个问题，使用了各种答案。我发现的许多问题是由于Answers引用了旧版本的jqueryui。

以下适用于 jqueryui 1.12.1

我将以下代码添加到 jqueryui 模式的按钮单击中

```
"Switch To Next Tab": function() {
            $( this ).dialog( "close" );//Close the modal
            $('#modal1body').empty;//empty the div container form current modal
            $('#tabs .ui-tabs-active')//remove the active classes for all tabs
                .removeClass("ui-tabs-active")
                .removeClass("ui-state-active");
            $('#tabs').tabs({ active: 1});//Set new tab = current tab + 1
} 
```

# java - javax.net.ssl.SSLProtocolException：SSL 库失败，通常是协议错误

> ID：13956507
> 
> 赞同：2
> 
> 时间：2012-12-19T16:14:33.853
> 
> 标签：java, android, ssl, https

我有：

1.  公司.cert.pem
2.  ca_cert.pem

我正在尝试执行 ssl 连接。

我从这两个文件中生成**了 mykeystore.bks**（尝试了任何组合）并使用此处的 java 代码Trusting [all certificate using HttpClient over HTTPS](https://stackoverflow.com/questions/2642777/trusting-all-certificates-using-httpclient-over-https) - **emmby**响应。但一直以来我都会收到下一个错误：

```
12-20 03:04:48.844: W/System.err(2087): javax.net.ssl.SSLProtocolException: Read error: ssl=0x2b6e50: Failure in SSL library, usually a protocol error
12-20 03:04:48.854: W/System.err(2087):     at org.apache.harmony.xnet.provider.jsse.NativeCrypto.SSL_read(Native Method)
12-20 03:04:48.854: W/System.err(2087):     at org.apache.harmony.xnet.provider.jsse.OpenSSLSocketImpl$SSLInputStream.read(OpenSSLSocketImpl.java:788)
12-20 03:04:48.854: W/System.err(2087):     at org.apache.http.impl.io.AbstractSessionInputBuffer.fillBuffer(AbstractSessionInputBuffer.java:103)
12-20 03:04:48.854: W/System.err(2087):     at org.apache.http.impl.io.AbstractSessionInputBuffer.readLine(AbstractSessionInputBuffer.java:191)
12-20 03:04:48.854: W/System.err(2087):     at org.apache.http.impl.conn.DefaultResponseParser.parseHead(DefaultResponseParser.java:82) 
```

*

2.  [http://developer.android.com/reference/org/apache/http/conn/ssl/SSLSocketFactory.html](http://developer.android.com/reference/org/apache/http/conn/ssl/SSLSocketFactory.html)

似乎 Android 团队为此目的提出了另一种方法 - 但对我来说还不清楚。

# tfs - 从代码更新现有工作项

> ID：13956508
> 
> 赞同：9
> 
> 时间：2012-12-19T16:14:39.780
> 
> 标签：tfs, tfs-web-access

我一直在为我们的 TWA 进行扩展，发生了一件奇怪的事情。
我们有一个用于处理我们的自定义工作项的函数库，其中包含一个用于更新特定工作项的函数 - `UpdateContract`. 在我的工作过程中，我需要`TeamTask`使用附加字段扩展其他自定义工作项 ( ) 之一。

最初，该`UpdateContract`方法没有问题，但现在它只有在我向它添加显式调用`item.Open()`或`item.PartialOpen()`向它添加显式调用时才有效，否则它会引发以下异常：

`ValidationException:
TF400276: You have tried to set a value for a field of a work item which is not opened or partial opened. You cannot set a value for a field of a work item which is not opened or partial opened.`

我正在从 Web 应用程序中检索相同类型的工作项，但我从未从那里更改它们。

如果有人能对此有所了解，我会非常高兴，因为`TFS`我完全不知道这是什么原因，所以我对此完全陌生。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-02T00:47:21.590

您用于检索相关工作项的查询需要指定您的附加字段，以便您能够更新它。

默认情况下，当您查询 TFS 时，它仅返回您明确指定的工作项的字段（除了必需的字段）。如果您没有指定要更改的字段，则需要使用 item.Open() 以延迟加载整个工作项数据以进行编辑。

# android - Android：背景图像大小

> ID：13956512
> 
> 赞同：1
> 
> 时间：2012-12-19T16:14:51.637
> 
> 标签：android, image

在阅读了支持多种屏幕尺寸的最佳实践文档（[http://developer.android.com/guide/practices/screens_support.html](http://developer.android.com/guide/practices/screens_support.html)）之后，有一件事仍然让我感到困惑......如果不是让图像占据“任何空间”怎么办它占用”，您希望它覆盖整个区域，例如在使用背景图像时？

是否可以接受这样的观点，虽然您可以通过提供 ld、md、hd 和 xhd 图像来接近，但如果您强制图像占据整个屏幕，它可能会被稍微拉伸或粉碎以适应设备？

您如何最好地提供一个设计为在所有设备上以最小拉伸填充整个背景的图像？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:28:37.620

由于屏幕尺寸不同，我看到了两个合理的选择。首先是通过创建图像以适应每个屏幕范围的最大尺寸来接受一些缩小（避免拉伸），这可以根据链接的[图 1](http://developer.android.com/images/screens_support/screens-ranges.png)确定。

如果可以裁剪背景图像以适合屏幕，则第二个选项有效。如果是这样，您可以使用`android:scaleType="center"`它通过切断边缘来防止任何收缩。

# facebook - fb之类的按钮代码不起作用

> ID：13956518
> 
> 赞同：4
> 
> 时间：2012-12-19T16:15:12.870
> 
> 标签：facebook, html, xcode4, facebook-likebox

我已经尝试了所有插入代码的选项，以便在客户网站上获得类似 facebook 的按钮，但它没有显示出来，谁能帮我一个简单的代码让按钮工作，点赞的链接是 nnacanada

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:21:21.883

首先，您必须创建一个应用程序以获取应用程序 ID

[https://developers.facebook.com/apps](https://developers.facebook.com/apps)

其次，您必须在此处为您的喜欢按钮生成代码：[https](https://developers.facebook.com/docs/reference/plugins/like/) ://developers.facebook.com/docs/reference/plugins/like/或使用以下代码：

你需要像这样放置你的html标签：

```
<html lang="pt" xmlns:fb="http://www.facebook.com/2008/fbml"> 
```

`<body>`和之间`</body>`你需要把下面的代码

```
<fb:like href="http://www.your.page.url" layout="standard" show-faces="true" send="true" width="450" action="like" colorscheme="light"></fb:like>

<!-- Facebook -->
<div id="fb-root"></div>
<script type="text/javascript">
    window.fbAsyncInit = function() {
        FB.init({appId: 'your-facebook-app-id', status: true, cookie: true, xfbml: true});
    };
    (function() {
        var e = document.createElement('script');
        e.type = 'text/javascript';
        e.src = document.location.protocol + '//connect.facebook.net/pt_PT/all.js';
        e.async = true;
        document.getElementById('fb-root').appendChild(e);
    }());
</script> 
```

不要忘记用正确的值替换“http://www.your.page.url”和“your-facebook-app-id”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:18:46.123

Facebook 提供了这个生成器来进行点赞。 [http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)

如果它不会出现并且是从那里生成的，那通常是你的错。检查您是否运行了 Ghostery 或类似插件。还要检查您是否使用 FBML 而不包括所需的 Javascript。

否则只需使用 Facebook 提供的 iFrame 代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-10T08:27:24.550

我遇到过同样的问题。在[https://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/)上没有显示带有代码的弹出窗口。

在 Chrome 上“空缓存和硬重新加载”为我修复了它。在 FireFox 上清除历史记录完成了这项工作。

# html - 防止文本环绕浮动图像

> ID：13956522
> 
> 赞同：0
> 
> 时间：2012-12-19T16:15:17.943
> 
> 标签：html, css, css-float, word-wrap

我目前有一个向左浮动的图像，以及一个位于其右侧的文本块。该文本块不是当前浮动的，它只是出现在 HTML 中的图像之后。因此，随着它变得更长，它最终会在图像下方向左移动以继续。

我怎样才能使文本块始终保持在图像的右侧，因此图像和文本的行为就像两个并排的列？请记住，除了这两个元素之外，我无法做任何事情。我无法在它们周围添加包装器。我可以在之前、之间或之后添加元素。但不在身边。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:21:59.990

```
p
{
width:1000px;
display: table-row;       
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T16:18:21.950

**固定答案**

也只是浮动文本。:)

[http://jsfiddle.net/Hs7pN/](http://jsfiddle.net/Hs7pN/)

```
#image
{
    background-color: #09C;
    float: left;
    height: 200px;
    width: 200px;
}

#text
{
    float: left;
    width: 400px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:20:16.327

如果可能，尝试设置固定宽度并对齐您的文本

# ios - 从服务器预加载视频文件以在 MPMoviePlayerController 中播放

> ID：13956523
> 
> 赞同：0
> 
> 时间：2012-12-19T16:15:19.387
> 
> 标签：ios, objective-c, storage, mpmovieplayercontroller

我的应用程序需要在不同时间从服务器下载大量视频，我想知道是否有办法下载视频数据并将其存储以供以后播放？我最初下载了视频数据并将其存储到 NSData（见下文）中，但这不能在 MPMoviePlayerController 中使用。

```
NSString *imageURL = [NSString stringWithFormat:@"%@%@",@"http://wildknowledge.co.uk",[mapPoint objectForKey:@"videopath"]];

[mapPoint setObject:[NSData dataWithContentsOfURL:[NSURL URLWithString:[imageURL stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]]] forKey:@"videopath"]; 
```

然后我认为我可以使用以下内容设置 URL 以供以后使用：

```
NSString *imageURL = [NSString stringWithFormat:@"%@%@",@"http://wildknowledge.co.uk",[mapPoint objectForKey:@"videopath"]];

NSURL *movieURL = [[NSURL alloc] initFileURLWithPath:imageURL];
[mapPoint setObject:movieURL forKey:@"videopath"]; 
```

但显然 NSURL 只存储一个完整的 url 位置，而不是该位置的数据，所以在播放视频时，它必须首先缓冲它，这是我不想要的。

那么谁能告诉我如何存储来自 NSURL 的数据以供以后使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:57:21.763

如果我是你，我会使用[NSFileHandle](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSFileHandle_Class/Reference/Reference.html)读取电影块并将它们直接保存到文件系统。这样您就不会将电影保存在内存中，因此您的应用程序不会因为您永远不会超过可用内存而崩溃。

当我不得不下载一个大数据库（>700MB）时，我在应用程序中使用了这种方法，并且效果很好。但是，根据电影大小，您可能需要添加验证机制以确保传输成功，例如 md5 校验和。

# e-commerce - 新的 OpenCart 电子商务网站：响应式设计与移动主题

> ID：13956527
> 
> 赞同：0
> 
> 时间：2012-12-19T16:15:31.590
> 
> 标签：e-commerce, responsive-design, opencart

[我正在创建一个基于OpenCart](http://www.opencart.com/)的新电子商务网站。客户希望网站在移动设备中功能强大且美观。我有两个选择：我可以使用响应式模板；或者，我可以使用[移动主题](http://www.opencart.com/index.php?route=extension/extension&filter_search=%20mobile%20theme)。这将是一家大型家具店，我只是想看看您为大型电子商务网站设计移动版本的经验。最佳实践是什么？当您拥有大型网站时，采用响应式设计是否可行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:07:29.850

我个人更喜欢移动主题路线，因为它可以让您更好地控制客户下载的内容，这意味着您可以节省他们的带宽并提高网站速度，这在电子商务商店中至关重要。一种可用的移动/桌面扩展（商业）是 Omtex，它已被证明非常受欢迎

# android - 在活动的 onDestroy 方法中保存数据

> ID：13956528
> 
> 赞同：10
> 
> 时间：2012-12-19T16:15:35.023
> 
> 标签：android, android-service, android-sqlite, ondestroy

我正在编写一个任务列表并拥有一个包含所有任务（和元数据）的 Project 对象。我使用操作日志，因此当任务更改时，我不会立即将其保存到数据库中，只需将其保存在内存中，以便在活动完成时转储到数据库中。Activity 的 onDestroy 方法是最好的地方：如果没有调用 onRetainNonConfigurationInstance 方法，我启动服务来保存项目（一个实例存储在应用程序中）。保存是昂贵的：在数据库项目中有修订，所以我保存新数据，更改当前修订并删除以前修订的数据。所以我不怕突然申请停止。

但是，[根据文件](http://developer.android.com/reference/android/app/Activity.html#onDestroy%28%29)我必须`do not count on this method being called as a place for saving data.`

有没有其他地方可以保存我的数据？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-19T16:23:43.633

OnDestroy 并不总是会被调用。来自生命周期文档——

> 当您的活动收到对 onStop() 方法的调用时，它不再可见，并且应该释放用户不使用它时不需要的几乎所有资源。一旦您的活动停止，如果需要恢复系统内存，系统可能会破坏实例。在极端情况下，系统可能会简单地杀死您的应用程序进程而不调用活动的最终 onDestroy() 回调，因此使用 onStop() 释放可能会泄漏内存的资源很重要。
> 
> 虽然 onPause() 方法在 onStop() 之前调用，但您应该使用 onStop() 来执行更大、更占用 CPU 的关闭操作，例如将信息写入数据库

请参阅[停止您的活动](http://developer.android.com/training/basics/activity-lifecycle/stopping.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T16:41:13.533

您不应该使用`onDestroy()`方法来保存数据。`onPause()`相反，您应该使用内部/外部存储空间或在方法中编写代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T16:21:54.053

你应该使用`onStop`

[活动文档](http://developer.android.com/reference/android/app/Activity.html#onStop%28%29)

您也可以使用`onPause`，但每当您离开 时都会调用它`Activity`，包括关闭屏幕。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-02-06T12:11:25.283

根据[活动生命周期文档](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)，您应该将数据保存在`onPause()`或中`onSaveInstanceState(Bundle)`。

在活动关闭之前`onDestroy()`，可能永远不会调用这些方法。`onStop()`

[活动生命周期文档](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)摘录：

> 受保护的无效**onDestroy ()**
> 
> *注意：不要指望这个方法被称为保存数据的地方！例如，如果活动正在内容提供程序中编辑数据，则这些编辑应该在*`onPause()`*或中提交* `onSaveInstanceState(Bundle)`*，而不是在此处提交。*
> 
> 受保护的无效**onStop ()**
> 
> *请注意，在调用 onPause() 方法后系统没有足够内存来保持活动进程运行的低内存情况下，可能永远不会调用此方法。*

# c# - 将控件集合与列表进行比较

> ID：13956530
> 
> 赞同：1
> 
> 时间：2012-12-19T16:15:39.340
> 
> 标签：c#, list, controls

我有一个 FlowLayoutPanel，我想用 ID（字符串）列表中的 ProgressBars 和当前进度条（整数）的位置来更新它。我将这个列表称为列表**a**。

`FlowLayoutPanel.Controls`应该与列表a**进行**比较：

*   如果检测到新 ID，则应在`FlowLayoutPanel.Controls`集合中使用该 ID（名称）创建一个新控件。
*   如果集合中的 Control 在列表**a**`FlowLayoutPanel.Controls`中没有对应的名称，则应将其删除并处置。
***   应该更新两个集合上的控件（ProgressBar 的进度来自列表**a**中的整数）**

 **令我困扰的是该`FlowLayoutPanel.Controls`集合没有通用列表那么多的方法，因此我无法真正遵循互联网上的任何指南。

你能帮我怎么做吗？

谢谢！

编辑：回复 DJ KRAZE 评论：我用列表做了类似的事情，但正如我所说，控制集合没有列表的某些方法。这是我的代码（可能不起作用，我重写了它以使其更易于理解）：

**// 删除旧的**

```
// Make a new list of IDs, where none of the IDs from myList1 can be found in myList2
var remove = myList1.Where(f => !myList2.Any(g => g == f.ID));

//Do some operation for the object which is about to get removed
foreach (Object obj in remove)
{
    // Some operation           
}
// remove from list
myList1.RemoveAll(i => remove.Contains(i)); 
```

**//删除重复项**

```
// Remove Duplicates from myList2, so only the remaining object are to be started
myList2.RemoveAll(f => myList2.Any(g => g.ID == f)); 
```

**// 将剩余的对象从 myList2 添加到 myList1**

```
foreach(Object obj in myList2)
{
// add to myList1 and do some operation, like starting it
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:18:12.527

包括`System.Linq`所有扩展方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:47:04.003

`FlowLayoutPanel`（以及其他容器控件）的控件集合不实现`IEnumerable<T>`，而仅实现非泛型`IEnumerable`. 因此转换`IEnumerable`为`IEnumerable<T>`用`Cast<T>`exension方法。然后你可以使用大量的 LINQ：

```
 flowLayoutPanel1.Controls
     .Cast<Control>()
     .Where(c => c.Name == "...")
     .OrderBy(...)
     ... 
```

注意：大多数 LINQ 扩展方法都扩展了`IEnumerable<T>`.**

# php - 使用 strftime() 在 PHP 中获取星期几

> ID：13956537
> 
> 赞同：0
> 
> 时间：2012-12-19T16:16:01.840
> 
> 标签：php

获取星期几的最可靠方法是什么？

*   `strftime("%u")`（1 = 周一至 7 = 周日）
*   `strftime("%w")`（0 = 星期日至 6 = 星期一）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:20:22.913

答案是你**需要**使用 %w （看这里为什么： http: [//php.net/manual/en/function.strftime.php](http://php.net/manual/en/function.strftime.php)）

所以它是这样的：

```
function get_week_day()
{
    $tmp = strftime('%w');
    if ($tmp == 0)
    {
         return 7;
    }
    return $tmp;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:20:26.090

`%u`跨操作系统的行为似乎不一致（请参阅此处的警告：http: [//php.net/manual/en/function.strftime.php](http://php.net/manual/en/function.strftime.php)和搜索结果中的多个问题报告）。

如果您更喜欢使用 strftime，请坚持使用`%w`.

# android - 如何判断哪个 android sqlite 游标变量导致警告或异常？

> ID：13956538
> 
> 赞同：2
> 
> 时间：2012-12-19T16:16:03.570
> 
> 标签：android, android-cursor

我有两个与游标相关的问题，并且无法确定导致问题的游标。

首先，我试图删除所有关于“没有事先关闭（）的光标完成”的 LogCat 消息。

我知道为什么要打印该消息，并且我知道如何解决该问题。我想不通的是最后一个没有关闭的游标。我已经多次重复代码，据我所知，全部都是。

其次，是一个 onResume 问题，我得到一个“陈旧数据：游标关闭，无法重新查询”异常。堆栈跟踪都是 android.xx 和 com.android 内部的，所以我无法判断是哪个光标导致了问题。（我有一些预感，但没有确定）

是否有一个设置/标志我可以戳让操作系统告诉我更多关于这些的信息？游标的详细信息（例如它关联的表、在其上设置的列等）、游标变量名称、游标分配/声明的代码行等？

或者我是在调试器中单步执行大量代码和游标，还是有另一种我没有想到的方法来筛选这个？

编辑：

```
`StrictMode.setVmPolicy(new StrictMode.VmPolicy.Builder()
.detectAll()
.penaltyLog()
.penaltyDeath()
.build());` 
```

将在未关闭的游标上强制崩溃/终止。通过[问题](https://stackoverflow.com/questions/13919790/android-cursorwrapperinner-cursor-finalized-without-prior-close?rq=1)

# php - 为一个提交按钮的每个表单字段分配单独的名称

> ID：13956539
> 
> 赞同：0
> 
> 时间：2012-12-19T16:16:06.017
> 
> 标签：php, html, mysql, forms, submit

> 这个问题就解决了。代码如下。

目前我有一段代码是这样的：

```
while ($query…) {
<checkbox form named "rating"> <submit button for "rating">
} 
```

所有这些，x20。x20 由变量确定`$rpp`（每页的结果。代码中没有显示，因为它与问题无关）。每个表单都有各自的“ `submit`”按钮。

我想要实现的是，我想给`checkbox`和`radio`按钮所有个人的名字，所以我可以在while循环之外有提交按钮，而不是我现在拥有的，这意味着，`submit`所有x20复选框/收音机只有一个按钮按钮形式。

例如`checkbox_0`，`checkbox_1`...

我唯一的问题是，我如何实现这一目标？我在哪里玩我的`submit`按钮？我也在问正确的问题吗？如果我听起来有点含糊，我深表歉意。如果您有问题，请提出，我会回答。

我在下面的代码中试了一下。看来这不是很多人的做法，所以我的大部分谷歌搜索都没有发现任何太有用的东西，尽管我确实知道从哪里开始。有人可以给我一些指导吗？

```
<?

if (isset($_POST['formSubmit'])){
  $j = 1;
  while ($j < $_GET['rpp']) {
    $rating = mysql_real_escape_string($_POST['rating'.$j]);
    $accountID = $_POST['accountID'.$j]; 

    mysql_query("UPDATE Spreadsheet SET rating='$rating' WHERE accountID='$accountID'");
    $j++;
  }
}

$k = 1; ?>

<form name ="rating" method ="POST" action ="" > <?
while($row = mysql_fetch_array($query)){  

    // Drop-down menu

    $values = array('0 - No rating','1 - Very Bad','2 - Bad','3 - Average','4 - Above Average');

    echo "<input type = \"hidden\" name = \"accountID" . $k . "\" value = \"" . $row['accountID'] . "\" >";
    for($i = 0; $i < count($values); $i++){ ?>
          <input type="radio" name="rating<? echo $k; ?>" value="<?php echo $values[$i]; ?>" id="rbl_0" <? if($row['rating'] == $i) echo "checked='checked'"; ?>/>
          <? echo $values[$i] ?> <br> <? 
        }

$k++;
} ?>

 <input type ="Submit" name ="formSubmit" value ="Submit and Next Page" />
 </form> <? 
```

编辑：此时此代码的输出显示每个表单字段的单独提交按钮。我想要实现的是为所有表单域设置一个提交按钮。

编辑2：想通了！最终编辑是我的做法。对于将来可能会偶然发现这个问题的其他人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:27:35.543

试试这个：你想把你的表单声明移到你的 while 循环之外。这也意味着您想将提交按钮移到 while 循环之外。里面的所有东西都可以保持不变，因为您的单选按钮在每个 while 循环迭代中都有唯一的名称，并且在每个 for 循环迭代中分组。

```
<form name ="rating" method ="POST" action ="" > 
<?php
while($row = mysql_fetch_array($query)){ 
  $values = array('0 - No rating','1 - Very Bad','2 - Bad','3 - Average','4 - Above    Average'); ?>
  echo "<input type = \"hidden\" name = \"accountID" . $k . "\" value = \"" . $row['accountID'] . "\" >";
  for($i = 0; $i < count($values); $i++){ ?>
      <input type="radio" name="rating<? echo $k; ?>" value="<?php echo $values[$i]; ?>" id="rbl_0" <? if($row['rating'] == $i) echo "checked='checked'"; ?>/>
      <? echo $values[$i] ?> <br> <? 
    } ?>
 } ?>
 <input type ="Submit" name ="formSubmit" value ="Submit" />
</form> 
```

# javascript - 动态更改相对于左上角的 div 位置

> ID：13956540
> 
> 赞同：0
> 
> 时间：2012-12-19T16:16:09.110
> 
> 标签：javascript, jquery, css

当我将鼠标悬停在 LI 上时，我正在尝试更改 div 的位置（上、左）。这是我正在使用的，它似乎设置了 position:relative 但它不会添加或更改顶部或左侧元素。

它从此 html 获取 XX 和 YY 值：

```
<li value="9" xx="10" yy="10"><a href="#">Content Here</a></li>

$(function(){
    $("div.listcol ul li").bind("mouseover",function(){
        $("div.cutaway-text").hide();    
        $("div.cutaway-image img").hide();
        $("div.cutaway-image img#img"+this.value).show();
        var top2 = 0;
        var left2 = 0;

        top2 = $(this).attr('xx');
        left2 = $(this).attr('yy');

        $(".highlighter").css('position', 'relative');
        $(".highlighter").css('top', top2); 
        $(".highlighter").css('left', left2); 

        //var d = document.getElementById('highlighter');
        //d.style.position = "absolute";
        //d.style.left = left;
        //d.style.top = top;

        //document.getElementById("div.highlighter").style.left = left2;
        //document.getElementById("div.highlighter").style.top = top2;
        //console.log(this.value);
    });
}); 
```

注释掉的行是我已经尝试过/玩过的，谢谢。

编辑：这里是 jsfiddle [http://jsfiddle.net/SWXgb/](http://jsfiddle.net/SWXgb/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:40:28.487

您需要将“px”添加到您的`top`和`left`值中，如下所示：

```
$('.highlighter').css({  top : top2 + 'px', left : left2 + 'px' }); 
```

请参阅[工作演示](http://jsfiddle.net/jfrej/SWXgb/4/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:45:16.097

看看这个修改过的小提琴：http: [//jsfiddle.net/SWXgb/6/](http://jsfiddle.net/SWXgb/6/)

我注意到的事情：

*   您的第一个`<li>`标签没有`xx`属性，而是有`top`。
*   您没有指定 'px' 或 'em' 值来限定 JavaScript 中的`top`and`left`值。
*   子 div（带有类*highlighter*）设置为`position: relative`，如果您希望它相对于父 div 定位，则需要`position: relative`在*rollover-image*和`position: absolute`子上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:37:51.670

好的，我有个主意。

CSS：top、left、right 和 bottom 都可以正常工作，如果 position 是'absolute'...当 position 是相对位置时，使用 margin-top、margin-left、margin-right 和 margin-bottom。

或者，使父容器相对定位，以使绝对位置从第一个相对父级开始；）

# gwt - 从 DataGrid GWT 中的另一个单元格更新一个单元格而不重绘或刷新

> ID：13956547
> 
> 赞同：0
> 
> 时间：2012-12-19T16:16:35.150
> 
> 标签：gwt, mvp

我正在创建包含`DataGrid`4 列的应用程序`(name, hours, rate, total)`。

我想要的是在*小时*或*费率*值发生变化时更新*总*单元格。

 **你可以说：

`object.setTotal(object.getHours() * object.getRate());`

...但我想知道如何在不重绘行或 DataGrid 的情况下更新单元格值本身。这可能吗？

我得到了答案：我使用 DOM 来访问控件并更新值。当然，我在 DataGrid 中命名了每个控件，例如 First row (id=name0, id=hours0, rate0, total0) 等等。

`InputElement ele = DOM.getElementById( "total" + context.getIndex()).cast();` `ele.setValue(object.getTotal());`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T03:54:28.103

不能单独刷新单元格。但是行刷新是可能的。因此，每当小时/费率值更改时，您都会触发行刷新 API。

```
dataGrid.redrawRow( rowIndex ); 
```

上面的代码刷新由索引'rowIndex'标识的整行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T02:58:38.897

没有 redaraw、refresh 或 setData 是不可能的**

# c++ - LLVM 分段错误/需要使用指令而不是指令*

> ID：13956554
> 
> 赞同：2
> 
> 时间：2012-12-19T16:17:06.627
> 
> 标签：c++, llvm

运行 LLVM 通行证时出现分段错误。我需要在基本块的迭代“for”循环之外使用 BBterminators 数组。似乎 LLVM`TerminatorInst *BasicBlock::getTerminator()`在遍历循环时不保护地址（注意：），所以我需要将 BBterminators 保存在类型的变量中`Instruction`，而不是`Instruction *`. 我怎样才能将整个复制`Instructions`到`BBterminators`？

```
for (Function::iterator II = F.begin(), EE = F.end(); II != EE; ++II, ++ii)
{
BasicBlock* BB = (dyn_cast<BasicBlock>(II));

if (BB->getTerminator())
{
    Instruction *current = BB->getTerminator();

    Instruction *previous = current->getPrevNode();

    if (current->getOpcode() == Instruction::Br) 
    {   
        BBterminators[ii] = current; 
```

在哪里`Instruction **BBterminators = new Instruction *[100];`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:44:33.150

我不确定您在这里所说的“保护”是什么意思。遍历 BB 并查看它们的终止符当然不会使指令指针无效，因此只要您可以安全地不删除任何内容，您就可以保留它们。在任何情况下，您也可以`Instruction*`通过调用来复制对象`clone`（请注意，`Instruction`通过设计，复制 ctor 和赋值运算符是不可复制的）。像这样的东西：

```
virtual bool runOnFunction(Function &F) {
  std::vector<Instruction*> terminators;
    for (Function::iterator bb = F.begin(), bb_e = F.end(); bb != bb_e; ++bb) {
      terminators.push_back(bb->getTerminator()->clone());
    }
  ...
  ...
} 
```

完成后不要忘记发布您的副本矢量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T14:20:51.987

介绍一个条件

```
if ( !(II->empty()) && II->back().isTerminator() ) 
```

计算之前

# android - 在 Eclipse 中构建 Android 项目时构建 C++ 共享对象

> ID：13956558
> 
> 赞同：4
> 
> 时间：2012-12-19T16:17:16.983
> 
> 标签：android, eclipse, makefile

在构建我的 Android 项目*之前*，我正在尝试设置 Eclipse 以将 C++ 库构建为共享对象。

我通过 Android.mk 研究了如何做到这一点，但似乎我需要修改 C++ 库 make 文件以使用 android makefiles，这需要比可用时间更多的时间。

我已经导入了 C++ 库的源代码，并且能够通过 Eclipse 构建它，并且在我的 Android 项目 Android.mk 文件中，我引用了预构建共享对象的位置，并且在运行应用程序时它已正确安装。

那么，当我只构建 Android 项目时，有什么方法可以让 Eclipse 构建 C++ 项目，然后构建我的 Android 项目？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T15:02:04.730

在大多数情况下，我解决了我的问题。首先，我必须将本机库项目作为 C++ 项目导入。然后，我通过 Eclipse 将构建目录更改为我的库文件所在的位置。最后，我通过执行 Properties->Project References 并选择本机库项目使我的项目引用本机库。

# python - pandas 窗口函数：访问中间结果

> ID：13956564
> 
> 赞同：1
> 
> 时间：2012-12-19T16:17:29.957
> 
> 标签：python, numpy, scipy, pandas

我正在做一些日志分析并每隔几分钟检查一次队列的长度。我知道文件何时进入“队列”（一个简单的文件系统目录）以及何时离开。有了它，我可以以给定的间隔绘制队列的长度。到目前为止一切顺利，尽管代码有点程序化：

```
ts = pd.date_range(start='2012-12-05 10:15:00', end='2012-12-05 15:45', freq='5t')
tmpdf = df.copy()
for d in ts:
    tmpdf[d] = (tmpdf.date_in < d)&(tmpdf.date_out > d)
queue_length = tmpdf[list(ts)].apply(func=np.sum) 
```

但是，我想将实际长度与给定消耗率（例如每秒 1 次等）的长度进行比较。我不能只减去一个常数，因为队列不能超过零。

我已经做到了，但是以一种非常程序化的方式。我尝试使用 pandas 窗口函数但收效甚微，因为无法访问已经为前一个元素计算的结果。这是我尝试的第一件事是致命的错误：

```
imagenes_min = 60 * imagenes_sec
def roll(window_vals):
    return max(0.0, window_vals[-1] + window_vals[-2] - imagenes_min)

pd.rolling_apply(arg=imagenes_introducidas, func=roll , window = 2, min_periods=2) 
```

真实的代码是这样的，我觉得太冗长太慢了：

```
imagenes_sec = 1.05
imagenes_min = imagenes_sec * 60 *5
imagenes_introducidas = df3.aet.resample(rule='5t',how='count')
imagenes_introducidas.head()

def accum_minus(serie, rate):
    acc = 0
    retval = np.zeros(len(serie))
    for i,a in enumerate(serie.values):
       acc = max(0, a + acc - rate)
       retval[i] = acc
    return Series(data=retval, index=serie.index)

est_1 = accum_minus(imagenes_introducidas, imagenes_min)
comparativa = DataFrame(data = { 'real': queue_length, 'est_1_sec': est_1 })
comparativa.plot() 
```

![比较](../Images/3691ccd5451e5b5da1ee80f43f391cf2.png)

这似乎是一项容易的任务，但我不知道如何正确完成。可能 pandas 不是工具，而是一些 numpy 或 scipy 魔法。

更新： df3 是这样的（省略了一些列）：

```
 aet             date_out
date_in                                               
2012-12-05 10:08:59.318600  Z2XG17  2012-12-05 10:09:37.172300
2012-12-05 10:08:59.451300  Z2XG17  2012-12-05 10:09:38.048800
2012-12-05 10:08:59.587400  Z2XG17  2012-12-05 10:09:39.044100 
```

更新2：这似乎更快，仍然不是很优雅

```
imagenes_sec = 1.05
imagenes_min = imagenes_sec * 60 *5
imagenes_introducidas = df3.aet.resample(rule='5t',how='count')

def add_or_zero(x, y):
    return max(0.0, x + y - imagenes_min)

v_add_or_zero = np.frompyfunc(add_or_zero, 2,1)
xx = v_add_or_zero.accumulate(imagenes_introducidas.values, dtype=np.object)

dd = DataFrame(data = {'est_1_sec' : xx, 'real': queue_length}, index=imagenes_introducidas.index)
dd.plot() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T04:01:03.330

将入站和出站事件交错到单个帧中怎么样？

```
In [15]: df
Out[15]: 
                      date_in     aet                    date_out
0  2012-12-05 10:08:59.318600  Z2XG17  2012-12-05 10:09:37.172300
1  2012-12-05 10:08:59.451300  Z2XG17  2012-12-05 10:09:38.048800
2  2012-12-05 10:08:59.587400  Z2XG17  2012-12-05 10:09:39.044100

In [16]: inbnd = pd.DataFrame({'event': 1}, index=df.date_in)

In [17]: outbnd = pd.DataFrame({'event': -1}, index=df.date_out)

In [18]: real_stream = pd.concat([inbnd, outbnd]).sort()

In [19]: real_stream
Out[19]: 
                            event
date                             
2012-12-05 10:08:59.318600      1
2012-12-05 10:08:59.451300      1
2012-12-05 10:08:59.587400      1
2012-12-05 10:09:37.172300     -1
2012-12-05 10:09:38.048800     -1
2012-12-05 10:09:39.044100     -1 
```

在这种格式下（每增加一个减量），队列深度可以很容易地用 cumsum() 计算。

```
In [20]: real_stream['depth'] = real_stream.event.cumsum()

In [21]: real_stream
Out[21]: 
                            event  depth
date                                    
2012-12-05 10:08:59.318600      1      1
2012-12-05 10:08:59.451300      1      2
2012-12-05 10:08:59.587400      1      3
2012-12-05 10:09:37.172300     -1      2
2012-12-05 10:09:38.048800     -1      1
2012-12-05 10:09:39.044100     -1      0 
```

为了模拟不同的消费率，将所有真实的出站时间戳替换为固定频率的一系列出站时间戳。由于 cumsum() 函数在这种情况下不起作用，我创建了一个计数函数，它采用底值。

```
In [53]: outbnd_1s = pd.DataFrame({'event': -1},
   ....:                          index=real_stream.event.resample("S").index)

In [54]: fixed_stream = pd.concat([inbnd, outbnd_1s]).sort()

In [55]: def make_floor_counter(floor):
   ....:     count = [0]
   ....:     def process(n):
   ....:         count[0] += n
   ....:         if count[0] < floor
   ....:             count[0] = floor
   ....:         return count[0]
   ....:     return process
   ....: 

In [56]: fixed_stream['depth'] = fixed_stream.event.map(make_floor_counter(0))

In [57]: fixed_stream.head(8)
Out[57]: 
                            event  depth
2012-12-05 10:08:59            -1      0
2012-12-05 10:08:59.318600      1      1
2012-12-05 10:08:59.451300      1      2
2012-12-05 10:08:59.587400      1      3
2012-12-05 10:09:00            -1      2
2012-12-05 10:09:01            -1      1
2012-12-05 10:09:02            -1      0
2012-12-05 10:09:03            -1      0 
```

# php - file_get_contents 似乎正在缓存，锁定脚本问题

> ID：13956565
> 
> 赞同：5
> 
> 时间：2012-12-19T16:17:29.810
> 
> 标签：php, locking

假设我们需要一些锁定脚本，以确保两个脚本永远不会同时运行：

```
if(file_get_contents('test.txt')) { // this is always empty...
   die("Another script is running in background!");
}
file_put_contents('test.txt', 'busy!');
sleep(10); // heavy work here
file_put_contents('test.txt', ''); 
```

它仍然允许我同时运行两个脚本。看起来结果`file_get_contents()`被缓存了？

如何解决？我想使用文件，而不是数据库。

* * *

编辑：我已经设法使用[flock()](http://php.net/manual/en/function.flock.php)完成了锁定脚本（感谢Levi Morrison）

无论如何，我仍然很好奇为什么`file_get_contents`会以如此意想不到的行为工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T19:23:18.400

我能够重现它并找出问题所在。起初它看起来像你描述的那样：我在浏览器中请求了脚本，并且在它运行时我检查了文件内容 - 它是`busy!`. 然后我运行第二个脚本，在浏览器中它也在*加载*，与第一个相同。我以为它也在运行，**但事实并非如此**。

很容易计算，如果不是`busy!`随机添加一些东西，例如：

```
file_put_contents('test.txt', 'busy washing ' . (mt_rand(1, 999) * 99999) . ' dishes'); 
```

以相同的方式运行相同的两个脚本并监视文件内容。起初，这将是第一个脚本编写的内容。说`busy washing 1 dishes`。然后你会看到内容变成了第二个脚本写的内容，数量会有所不同。

基本上，发生的情况是第二个脚本*等待*第一个脚本完成，然后才开始。有趣的是，通过完成，第一个脚本清除了文件，这让第二个脚本正常运行，但在浏览器中看起来它们都在同时工作。事实上，第二个脚本运行的时间是第一个脚本的两倍。

我在通过 AJAX 执行大量异步请求并在另一个浏览器选项卡中请求相同的网站页面时遇到了这种行为。在脚本完成之前，我无法加载选项卡。

长话短说，没有问题！如果您通过 cron 将这些脚本排队，它们将单独运行，第二个将通过发现文件不为空来完成。

# android - Android：AssetManager 的读取过程是线程安全的吗？

> ID：13956566
> 
> 赞同：2
> 
> 时间：2012-12-19T16:17:32.113
> 
> 标签：android, android-ndk, assets

我正在使用 AssetManager 从 apk 读取数据。我想知道这组 API 是否是线程安全的。例如，

```
AAsset_seek
AAsset_getLength
AAsset_read 
```

我无法从官方文档中找到关于此事的明显信息：http: [//developer.android.com/reference/android/content/res/AssetManager.html](http://developer.android.com/reference/android/content/res/AssetManager.html)

或源代码：http: [//mobilepearls.com/labs/native-android-api/include/android/asset_manager.h](http://mobilepearls.com/labs/native-android-api/include/android/asset_manager.h)

谢谢！

# javascript-events - XMLHttpRequest 触发中止事件 - 为什么？

> ID：13956569
> 
> 赞同：2
> 
> 时间：2012-12-19T16:17:37.023
> 
> 标签：javascript-events, google-chrome-extension

进入 Javasript 和 Chrome 扩展世界的第一步。[我按照教程在Chrome 指南](http://developer.chrome.com/extensions/getstarted.html)中进行了一个简单的扩展。在此基础上，我想更改代码以显示来自 stackoverflow 用户页面的用户头像。

我试图确定为什么要触发中止事件以及为什么`XMLHttpRequest`对象没有填充响应。

我`manifest.json`的是：

```
{  
    /*snip*/
    "manifest_version": 2,
    "browser_action": { 
                    "default_icon": "icon.png",
                    "default_popup": "popup.html"
                  },
    "permissions": [ 
        "http://stackoverflow.com/users",
        "http://stackoverflow.com/users/*",
        "notifications"
    ],
    "web_accessible_resources": [
        "icon.png"
    ]
} 
```

我的`popup.html`：

`<script src="popup.js"></script>`

我的 Javascript 文件是：

```
var req = new XMLHttpRequest();
req.open(
    "GET",
    "http://stackoverflow.com/users",
    true);
window.addEventListener('loadend', showPhotos);
req.addEventListener("error", errorMsg, false);
req.addEventListener("abort", cancelMsg, false);

req.send(null); 
```

正如我提到的那样，`cancelMsg`它正在运行，我试图理解为什么。我的 Chrome 版本是 23。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-23T09:12:20.883

它对我有用以下代码，我从控制台得到以下输出。

## 输出

我在[这里](http://pastebin.com/w9gMt86m)链接了控制台的输出，它包含所有用户详细信息等。

**清单.json**

我使用了您的清单文件，没有任何更改

```
{  
    "manifest_version": 2,
    "browser_action": { 
                    "default_icon": "logo.png",
                    "default_popup": "popup.html"
                  },
    "permissions": [ 
        "http://stackoverflow.com/users",
        "http://stackoverflow.com/users/*",
        "notifications"
    ],
    "web_accessible_resources": [
        "logo.png"
    ],
    "name":"Demo for XHR",
    "description":"This is a demo for XHR",
    "version":"1"
} 
```

### popup.html

创建了一个简单的html页面

```
<html>
<head>
<script src="popup.js"></script>
</head>
<body>
</body>
</html> 
```

### popup.js

我可以使用此代码获得响应。

```
//Define functions
function showPhotos() {
    console.log("In Show Photos");

}
function errorMsg() {
    console.log("In error message");
}
function cancelMsg() {
    console.log("In error message");
}
function onload() {
    //New request
    var req = new XMLHttpRequest();
    //Register events
    req.onreadystatechange = handleStateChange;
    req.onerror = errorMsg;
    req.onabort = cancelMsg;
    //Make a call
    req.open("GET", "http://stackoverflow.com/users", true);
    req.send();

}

function handleStateChange(xhr) {
// Print response when status is 200
    if (xhr.srcElement.status == 200) {
        console.log(xhr.srcElement.response);
    }
}
//Invoked onload event 
document.addEventListener("DOMContentLoaded", onload); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T20:07:31.970

@Sudarshan 的回答帮助查明了问题，即我没有将事件侦听器添加到正确的对象......我将 onload 添加到窗口而不是请求本身......

# objective-c - AutoreleasePool 没有捕获断点，没有警告，没有在 Instruments Leaks 中报告

> ID：13956571
> 
> 赞同：9
> 
> 时间：2012-12-19T16:17:42.417
> 
> 标签：objective-c, xcode, cocoa, memory-management

如果没有自动释放池，我正在尝试捕捉场景。
这是我的测试应用程序。

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    [self performSelectorInBackground:@selector(bgOperation:) withObject:nil];
}

- (void)bgOperation:(id)obj
{
    NSString *string [[[NSString alloc] init] autorelease];
} 
```

我试过设置断点 objc_autoreleaseNoPool。
我尝试过使用 Instruments / Leaks 进行分析。
OSX 10.7.5 XCode 4.3.3 以 10.6 为目标，AutomaticRefCounting = NO，GarbageCollection = 不支持。

我了解 NSApplication 包括它自己的自动释放池。但我的理解是每次调用 performSelectorInBackground: 都需要它自己的自动释放池。

**来自建议的更新：**我 在 main.m 中
尝试过这个..没有运气。

```
int main(int argc, char *argv[])
{
    NSString *junk = [[[NSString alloc]init]autorelease];
    return NSApplicationMain(argc, (const char **)argv);
} 
```

而这个..
在我的appDelegate中，也没有结果。

```
- (void)applicationDidFinishLaunching:(NSNotification *)aNotification
{
    [NSThread detachNewThreadSelector:@selector(bgOperation:)
                             toTarget:self
                           withObject:nil];
} 
```

而这个..
在我的 main.m 中使用 pthreads

```
void *doJunk(void *ptr){
  NSString *junk = [[[NSString alloc]initWithString:@"string with no pool"]autorelease];
  NSLog(@"%@", junk);
  pthread_exit(NULL);
}

int main(int argc, char *argv[])
{
  pthread_t thread;
  pthread_create(&thread, NULL, doJunk, NULL);
  return NSApplicationMain(argc, (const char **)argv);
} 
```

我知道由于操作系统级别可能没有任何泄漏（仍未确认），但是当我瞄准 10.6 时，我在日志中看到许多“无池”消息。如果它只是由于操作系统级别而泄漏，那么当我的目标是 10.6 但使用 10.7 SDK 时，我需要一种方法来在 10.7 中捕获这些场景。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T17:50:59.117

`performSelectorInBackground:`现在可能正在使用 dispatch_queue，它会自动为您设置一个自动释放池。尝试直接启动一个新的 NSThread，看看是否会导致泄漏。

您也可以尝试将代码移到 NSApplicationMain 之前，这将具有相同的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T14:56:02.217

根据[文档](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Multithreading/CreatingThreads/CreatingThreads.html#//apple_ref/doc/uid/10000057i-CH15-SW2)，在这种情况下仍然必须创建一个池。

> **performSelectorInBackground:withObject:**方法创建一个新的分离线程，并使用指定的方法作为新线程的入口点。
> 
> [...]
> 
> 调用该方法的效果与调用NSThread的**detachNewThreadSelector:toTarget:withObject:**方法的效果是一样的，参数是当前对象、选择器和参数对象。使用默认配置立即生成新线程并开始运行。在选择器内部，您必须像配置任何线程一样配置线程。例如，如果您打算使用它，**您将需要设置一个自动释放池（如果您没有使用垃圾收集）并配置线程的运行循环。**

然后根据for的[文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSThread_Class/Reference/Reference.html#//apple_ref/occ/clm/NSThread/detachNewThreadSelector:toTarget:withObject:)`NSThread`

```
+ (void)detachNewThreadSelector:(SEL)aSelector
                       toTarget:(id)aTarget
                     withObject:(id)anArgument 
```

> 对于非垃圾收集的应用程序，方法 aSelector负责为新分离的线程**设置一个自动释放池，并在它退出之前释放该池。**

**因此，除非Apple**在没有记录的情况下更改了实现（非常不可能），否则对于在使用`autorelease`.

为了验证文档是否在陈述事实，请尝试替换您的电话

```
[self performSelectorInBackground:@selector(bgOperation:) withObject:nil]; 
```

和

```
[NSThread detachNewThreadSelector:@selector(bgOperation:) toTarget:self withObject:nil]; 
```

根据文档，上述两个调用应该是等效的。你可能会发现它们不是。

# c# - 特定的cookie是否存在或不使用selenium webdriver c#

> ID：13956572
> 
> 赞同：1
> 
> 时间：2012-12-19T16:17:44.437
> 
> 标签：c#, selenium

如何使用 selenium webdriver 查找 cookie 是否存在？

```
 public bool CheckIfCookiePresent(bool empty)
 {
     Browser.Driver.Manage().Cookies.GetCookieNamed("cookie name");
     {
         return true;
     }
     return false;
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:36:00.083

两种方式，两者几乎相同。第一个使用 LINQ，第二个使用您已经获得但稍作修改的内容：

```
public bool IsCookiePresent(string cookieName)
{
    return Driver.Manage().Cookies.AllCookies.Any(c => c.Name.Equals(cookieName, StringComparison.OrdinalIgnoreCase));
} 
```

与：

```
public bool IsCookiePresent(string cookieName)
{
    return Driver.Manage().Cookies.GetCookieNamed(cookieName) != null;
} 
```

# php - 网站需要包含 index.php 的基本 url 才能正常工作

> ID：13956573
> 
> 赞同：0
> 
> 时间：2012-12-19T16:17:49.353
> 
> 标签：php, apache, ubuntu, virtualhost, scalr

我们正在测试我们使用的 scalr。我们在文件夹中有一个站点设置，`/var/www/subdomain.example.com/public_html`具有以下虚拟主机配置：

```
<VirtualHost *:80>
       ServerAlias www.{$host} {$server_alias}
       ServerAdmin {$server_admin}
       DocumentRoot {$document_root}
       ServerName {$host}
       ErrorLog {$logs_dir}/http-{$host}-error.log
       CustomLog {$logs_dir}/http-{$host}-access.log combined
</VirtualHost> 
```

当我们转到`subdomain.example.com`它时，它会显示主机默认消息，例如“Welcome to Scalr”——但如果我们转到`subdomain.example.com/index.php`该站点，它就可以正常工作。有没有办法让基本网址直接指向 index.php 而不显示它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:20:16.570

你有没有尝试过：

```
DirectoryIndex index.php 
```

更多资源：[http ://httpd.apache.org/docs/2.2/mod/mod_dir.html](http://httpd.apache.org/docs/2.2/mod/mod_dir.html)

在你的情况下：

```
<VirtualHost *:80>
  # (other directives)
  DirectoryIndex index.php
</VirtualHost> 
```

*更新*

如`jcjr`建议的那样，该指令也可以放在`.htaccess`文件中，但请确保您已通过正确的`AllowOverride`指令值启用了此类方法：

[http://httpd.apache.org/docs/2.2/mod/core.html](http://httpd.apache.org/docs/2.2/mod/core.html)

# html - 用于 HTML5、CSS3 和 JS 开发的强大 IDE

> ID：13956574
> 
> 赞同：2
> 
> 时间：2012-12-19T16:17:53.190
> 
> 标签：html, css, web-applications, ide, development-environment

我正在寻找一个支持独立 HTML5 应用程序开发的 IDE。

最好是免费的。它必须具有以下特点：

**HTML5**

*   语法高亮
*   可定制的源格式化程序
*   代码导航（到相应的 CSS 和 JS 文件）
*   代码完成
*   验证

**CSS3**

*   语法高亮
*   可定制的源格式化程序
*   源清理（如排序属性等）
*   代码完成
*   验证

**JavaScript**

*   语法高亮
*   可定制的源格式化程序
*   源代码清理（如排序函数、添加大括号等）
*   代码导航
*   代码完成
*   验证

有没有可以做所有这些事情的IDE？

我尝试了以下 IDE，但没有一个能满足所有要求（我在每个 IDE 旁边都写了一些限制）：

WebStorm 5.0.4（最接近的）

*   没有 CSS 的源代码清理，尤其是没有属性的自动排序
*   CSS 的源格式化程序配置不足（我无法为每个选择器获取新行）

带有 WDT 的 Eclipse 4.2.1：

*   没有 CSS 的源代码清理
*   CSS 的源格式化程序不可配置（我无法为每个选择器获取新行）
*   从 HTML 到 CSS 的代码导航不起作用

Aptana 工作室 3：

*   不支持 CSS3（“1.5rem”被格式化为“1.5 rem”，验证无法正常工作）
*   从 HTML 到 CSS 的代码导航不起作用。

视觉工作室 2012

*   没有 CSS 的源代码清理
*   独立 HTML5 应用程序没有项目类型
*   CSS 的源格式化程序配置不足（我无法为每个选择器获取新行）
*   从 HTML 到 CSS 的代码导航不起作用

如果我对某些限制有误，请告诉我...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:38:47.807

你可以看看 Sublime Text 2：[http ://www.sublimetext.com/2](http://www.sublimetext.com/2)

它非常强大，这要归功于他可以安装由社区[http://wbond.net/sublime_packages/community](http://wbond.net/sublime_packages/community)开发的软件包。

例如，您可以使用名为 CSS Comb 的包对 CSS 进行排序。您可以使用名为 JSLinter 的包检查您的 js 语法。还有很多其他软件包可以满足您的要求。

# javascript - Ajax 不附加

> ID：13956577
> 
> 赞同：-1
> 
> 时间：2012-12-19T16:17:54.473
> 
> 标签：javascript, ajax, jsp

我在使用 ajax 创建“查看更多”选项时遇到问题。我的 html 代码如下

```
 <body>
//this page is index.jsp
        <%
            System.out.println("here in class");
            ClassA class_object = new ClassA();
            List list = class_object.getListValue();//gives me 6 random values
        %>

        <div id="div1">

            <div id="div2">

                <%
                    if (list != null) {
                        int count = 0;
                        for (int i = 0; i < list.size(); i++) {

                        %>
                            <div class="value">
                                <%=list.get(i)%>
                            </div>
                        <%
                            count++;
                        }
                        %>

                        <a  href="#" class="see_more" onClick="load();">see more</a>

                        <%
                    }
                %>

            </div>

        </div>
    </body> 
```

单击查看更多选项时，调用以下功能

```
function load()
            {
                var xmlhttp;
                if (window.XMLHttpRequest)
                {// code for IE7+, Firefox, Chrome, Opera, Safari
                    xmlhttp=new XMLHttpRequest();
                }
                else
                {// code for IE6, IE5
                    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
                }
                xmlhttp.onreadystatechange=function()
                {
                    if (xmlhttp.readyState==4 && xmlhttp.status==200)
                    {
                        alert("yahoo");
                    }
                }
                xmlhttp.open("GET","index.jsp",true);
                xmlhttp.send();
            } 
```

因此，在 ajax 调用之后，新数据应附加在先前数据的末尾，即 div class="value" 的末尾。我在 javascript 方面很弱，所以我所能做的就是做到这一点。我需要建议以及代码。Thnks提前。

如果需要，我也会发布 java 类代码..

```
public class ClassA {

    public List getListValue()
    {
        List list = new ArrayList();

        for(int i=0;i<6;i++)
        {
        int data= (int) (Math.random()*100);
        list.add("data "+data);
        }

        return list;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T21:12:51.263

那这个呢？

这样你就可以分开事情了。你给动作一个正确的名字`seeMore`，ajax 功能可以重复用于可能的其他目的，函数也是如此`appendDataToBody`。

```
function seeMore() {

    doAjaxRequest( appendDataToElem ); 
}

function doAjaxRequest( callback )
{
    var xmlhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");    // IE7+, Firefox, Chrome, Opera, Safari : IE6, IE5

    xmlhttp.onreadystatechange=function()
    {
        if ( callback && xmlhttp.readyState == 4 && xmlhttp.status == 200 )
        {
            callback( xmlhttp.responseText );
        }
    }

    xmlhttp.open( "GET", "index.jsp", true );
    xmlhttp.send();
}

function appendDataToElem( data ) {

    document.body.innerHTML += data;
} 
```

显然

```
<a  href="#" class="see_more" onClick="seeMore();">see more</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T05:18:46.967

对于其他开发人员，我使用 JQuery 解决了这个问题。我希望它对有需要的人有所帮助。

Index.jsp 代码如下

```
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>JSP Page</title>
        <script src="jquery-1.8.3.min.js"></script>

    </head>
    <body>

        <div id="div1">

            <div id="div2">

            </div>
            <a  href="#" class="see_more">see more</a>

        </div>
<script>
    $(document).ready(function(){
        loadContent = function() {
         $.ajax({
            url: "getContent.jsp",

            success: function(ret){$("#div2").append(ret)}
          });   
        }

        loadContent();

        $('.see_more').click(function(){
            loadContent();
            return false;
        });
    });

</script>
    </body>
</html> 
```

getContent.jsp 代码如下

```
<%

    System.out.println("here in class");
    ClassA class_object = new ClassA();
    List list = class_object.getListValue();//gives me 6 random values

    if (list != null) {
        int count = 0;
        for (int i = 0; i < list.size(); i++) {%>
    <div class="value">
        <%=list.get(i)%>

    </div>
<%
                        count++;
                    }
    }

%> 
```

ClassA代码如下

```
import java.util.*;

public class ClassA {

    public List getListValue()
    {
        List list = new ArrayList();

        for(int i=0;i<6;i++)
        {
        int data= (int) (Math.random()*100);
        list.add("data "+data);
        }

        return list;
    }
} 
```

# objective-c - Objective-C：将 NSData 转换为 int 或 char

> ID：13956580
> 
> 赞同：3
> 
> 时间：2012-12-19T16:18:02.177
> 
> 标签：objective-c, type-conversion, nsdata

```
NSData * data;
NSFileHandle * file;

file = [NSFileHandle fileHandleForReadingAtPath: @"script.txt"]; //this is wrong, as I have to provide a full pathname, but disregard for now

[file seekToFileOffset: i]; //i not mentioned here, as this is only a snippet of code. Suffice to know that in the file it falls at the beginning of an integer I want to read

data = [file readDataOfLength: 5]; //5-digit integer that I want to read 
```

现在我如何将数据转换为我可以使用的 int（即用于执行算术运算）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T16:23:13.797

由于您正在从文本文件中读取整数，因此可以像这样转换它：

```
char buf[6];
[data getBytes:buf length:5];
buf[5] = '\0';
NSInteger res = atoi(buf); 
```

这假定每个字符使用一个字节的编码，这与`[file readDataOfLength: 5]`您提供的代码片段中的调用一致。

如果事先不知道位数，您可以这样做：

```
char buf[11]; // Max 10 digits in a 32-bit number + 1 for null terminator
bzero(buf, 11);
[data getBytes:buf length:variableLength];
NSInteger res = atoi(buf); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T16:25:44.763

这样做的一种方法是将数据转换为 NSString 然后从中获取整数值：

```
// assuming UTF-8 encoding
NSString *temp = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
int val = [temp intValue]; 
```

参考文档： [NSString](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T16:27:11.003

更一般地说，您可以将其用于货币或科学记数法等，或者用于此处编码的 int 或浮点...

```
NSString *string = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding];
NSNumberFormatter * format = [[NSNumberFormatter alloc] init];
[format setNumberStyle:NSNumberFormatterDecimalStyle];
NSNumber * myNumber = [format numberFromString:string]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T16:29:29.877

如果我这样做，假设 script.txt 包含纯文本，我会使用[NSScanner](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSScanner_Class/Reference/Reference.html)：

```
NSError *error = nil;
NSString *fileString = [NSString stringWithContentsOfFile:scriptPath encoding:NSUTF8StringEncoding error:&error];
if (!fileString) { // Handle error }
NSScanner *scanner = [NSScanner scannerWithString:fileString];
[scanner setScanLocation:i];
int value = 0;
if (![scanner scanInt:&value]) { // Unable to scan integer from string }

// value should contain your integer here 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-13T11:44:26.967

NSData *dData ;

const char* fData =[dData 字节];

# oracle - Oracle - PL/SQL：如何从外部表中的可变文件名中读取？

> ID：13956581
> 
> 赞同：2
> 
> 时间：2012-12-19T16:18:02.680
> 
> 标签：oracle, plsql, external-tables

我需要帮助。我想使用名称中包含 sysdate 的 PL/SQL 创建一个表？例如，table_name_sysdate？

我正在尝试创建一个外部表，该表将从 .csv 文件和我要读取的文件名中读取，其名称由常量（table_name）和日期（sysdate）组成。该文件名可以根据日期每天更改。我不知道如何创建从日常可更改文件名加载的机制。

这是我的代码，我不知道在带问号的括号内放什么。

```
create table ext_table_1
(med_name varchar2(20),
cost integer)
organization external
(type ORACLE_LOADER 
default directory orders
access parameters
(records delimited by newline
fields terminated by ',')
location (???)
reject limit 200; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:33:34.870

该文件在表的 LOCATION 属性中指定。`alter table`你可以用一个语句来改变它，像这样：

```
 alter table log_files location ('prefix_20121219.csv'); 
```

所以基本上，使用今天的文件创建表，然后每天在计划的作业或类似操作中运行 ALTER TABLE 语句。

或者，您可以保持文件名静态并将每天的文件重命名/复制为该名称。如果您在 11gR2 上运行，您可以关联一个预处理器文件 - 一个 shell 脚本 - 以便在您查询外部表时执行此操作。 [了解更多](http://www.oracle-developer.net/display.php?id=513)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T17:07:58.257

这是对目录对象的引用，使用“创建目录”创建。

[http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_5007.htm](http://docs.oracle.com/cd/B28359_01/server.111/b28286/statements_5007.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-07T02:11:47.027

基本上你想要的是从外部 CSV 文件加载到一个表中，并且文件名包含一个时间戳，所以它的名称每次都会改变。外部脚本可以简单地将该文件（从文件名中提取时间戳并检查它是否以正确的格式匹配今天）复制到加载脚本所期望的标准名称。如果您以后需要原始文件，在覆盖之前，请先在备份目录中制作该文件的副本。

# php - 在文件名数组中搜索以“.txt”结尾的文件

> ID：13956583
> 
> 赞同：3
> 
> 时间：2012-12-19T16:18:09.100
> 
> 标签：php, arrays, filenames, ends-with

我有一个带有文件名的数组。

我想检查数组是否有扩展名为“.txt”的文件。

我怎样才能做到这一点？

`in_array`仅检查特定值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:20:06.687

试试[`array_filter`](http://php.net/array-filter)。在回调中，检查`.txt`扩展是否存在。

如果`array_filter`有条目的结果（真实），那么您可以获得第一个或所有条目。如果数组为空，则没有匹配项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T16:19:56.173

您可以遍历数组中的项目，然后对每个项目执行正则表达式或 strpos 匹配。找到匹配项后，您可以返回 true。

与`strpos()`：

```
$array = array('one.php', 'two.txt');

$match = false;
foreach ($array as $filename) {
    if (strpos($filename, '.txt') !== FALSE) {
        $match = true;
        break;
    }
} 
```

使用正则表达式：

```
$array = array('one.php', 'two.txt');

$match = false;
foreach ($array as $filename) {
    if (preg_match('/\.txt$/', $filename)) {
        $match = true;
        break;
    }
} 
```

两者都将导致`$match`等于`true`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T16:20:42.143

```
$files = array('foo.txt', 'bar.txt', 'nope.php', ...);

$txtFiles = array_filter($files, function ($item) {
    return '.txt' === substr($item, -4); // assuming that your string ends with '.txt' otherwise you need something like strpos or preg_match
});

var_dump($txtFiles); // >> Array ( [0] => 'foo.txt', [1] => 'bar.txt' ) 
```

该[`array_filter`](http://php.net/array-filter)函数循环遍历数组并将值传递给回调。如果回调返回 true，它将保留该值，否则它将从数组中删除该值。在回调中传递所有项目后，返回结果数组。

* * *

哦，你只想知道是否`.txt`在数组中。其他一些建议：

```
$match = false;

array_map(function ($item) use ($match) {
    if ('.txt' === substr($match, -4)) {
        $match = true;
    }
}, $filesArray); 
```

```
$match = false;
if (false === strpos(implode(' ', $filesArray), '.txt')) {
    $match = true;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T16:45:16.750

使用以下文件扩展名过滤数组结果[`array_filter`](http://php.net/manual/en/function.array-filter.php)：

```
// Our array to be filtered
$files = array("puppies.txt", "kittens.pdf", "turtles.txt");

// array_filter takes an array, and a callable function
$result = array_filter($files, function ($value) {
    // Function is called once per array value
    // Return true to keep item, false to filter out of results
    return preg_match("/\.txt$/", $value);
});

// Output filtered values
var_dump($result); 
```

结果如下：

```
array(2) {
  [0]=> string(11) "puppies.txt"
  [2]=> string(11) "turtles.txt"
} 
```

执行它：http: [//goo.gl/F3oJr](http://goo.gl/F3oJr)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T16:22:26.200

```
$iHaz = FALSE;

foreach ($arr as $item) {
    if (preg_match('/\.txt$/', $item)) {
        $iHaz = TRUE;
        break;
    }
} 
```

与其他答案相反`array_filter`，我不返回任何东西。我只是检查它是否存在于数组中。此外，这种实现比`array_filter`一旦找到东西就跳出循环更有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T16:34:27.567

由于您正在处理您应该使用的文件，`array_filter`并且`pathinfo`

```
$files = array_filter(array("a.php","b.txt","z.ftxt"), function ($item) {
    return pathinfo($item, PATHINFO_EXTENSION) === "txt";
});

var_dump($files); // b.txt 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-01-22T07:56:59.080

如果您想要一个仅包含以 结尾的字符串的过滤数组`.txt`，那么 PHP8 为您提供了一个原生函数。

代码：（[演示](https://3v4l.org/VVCkl)）

```
$array = ['one.php', 'two.txt'];

var_export(
    array_filter(
        $array,
        fn($v) => str_ends_with($v, '.txt')
    )
); 
```

如果您想要一个真/假结果并且不需要迭代整个数组，那么有条件`break`地循环。（[演示](https://3v4l.org/ngLtN)）

```
$found = false;
foreach ($array as $filename) {
    if (str_ends_with($filename, '.txt')) {
        $found = true;
        break;
    }
}
var_export($found); 
```

# c# - dapper 可以延迟加载吗？通用（POCO）和动态 API 有什么区别？

> ID：13956585
> 
> 赞同：11
> 
> 时间：2012-12-19T16:18:14.530
> 
> 标签：c#, dapper

我有两个关于使用 dapper 的问题：

1.  有没有办法加载像实体框架（延迟加载）这样的导航键属性？

2.  `POCO serialization`和 有什么区别`dynamic serialization`？哪个更好？以及如何使用此序列化？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T16:21:12.867

> 有没有办法加载像实体框架（延迟加载）这样的导航键属性？

不，Dapper 是一个直接 SQL 库，这就是为什么它的速度如此之快。自动加载没有开销。但是，您可以一次加载多个实体。

> POCO序列化和动态序列化有什么区别？哪个更好？我怎样才能使用这个序列化？

POCO 序列化更有效，因为该类型在编译时是众所周知的，而动态序列化则更昂贵，因为它必须在运行时进行评估。除此之外并没有真正的区别。

但是，我会推荐 Dapper，而不是任何地方的***所有其他***库。它简单、快速且极其灵活。相信我，我已经使用了很多框架和库来进行数据访问。

[小巧玲珑的文档](https://github.com/StackExchange/dapper-dot-net)

看看**多重映射**和**多重结果**

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-19T16:23:17.853

1：不；根本没有，除非你完全自己滚动它。它是故意简约和确定性的

2：如果您想将该数据公开给应用程序的其他部分，例如作为视图模型的数据，实现 POCO 会很方便；`Query<Customer>`例如，可以填充您可以在其他地方对其进行编码的众所周知的`Customer`对象。`dynamic`非常*方便*，但不是很*可探索*- 并且不适用于数据绑定或智能感知。然而，它对于仍然非常本地化的 DAL 方法非常方便，或者例如

```
var row = conn.Query("select qty, cost from parts where id = @id",
    new { id }).Single();
int qty = row.qty;
decimal cost = row.cost;
// and off we go... 
```

或者：

```
var lookup = conn.Query("select id, name from somelookup").ToDictionary(
      x => (int)x.id, x => (string)x.name); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T16:23:16.810

据我所知，dapper 中没有延迟加载支持，除非您使用`Lazy<T>`.NET 中的类手工制作某些东西。

POCO 序列化是您定义一个类的地方，它的实例用于从表中添加/编辑/读取行。

动态序列化是您在 .NET 中使用`dynamic`对象的地方（您不定义类）。

尽管您没有智能感知或类型安全性，但动态会更快地开始。POCO 的设置需要更长的时间（因为您需要创建要使用的每个类），但您可以保持类型安全和智能感知。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-01-23T13:22:25.500

使用 Dapper 提供另一个延迟加载选项是 Castle 的动态代理。我已经成功地使用 Dapper、Dynamic Proxy 和 Mediatr 编写了一个 POC 框架，以在访问时启用延迟加载属性，即

例如

```
public class Customer
{
    public IEnumerable<Order> Orders { get; set; }
}

public class Order
{
    public IEnumerable<OrderLine> OrderLines { get; set; }
}

public class OrderLine
{
    /*
     * ...
     */
} 
```

然后当你这样使用时：

```
Customer customer = ... /*Load from database*/
/* Perform some logic */
// Access "Orders"

foreach(Order order in customer.Orders)//loads orders from the database
{
    foreach(OrderLine in order.OrderLines) //loads order lines from the database
    {
    }
} 
```

所以你不必只是使用`Lazy<T>`它可以通过其他方式完成

# brightcove - 播放列表播放器的附加广告目标参数？

> ID：13956586
> 
> 赞同：0
> 
> 时间：2012-12-19T16:18:19.037
> 
> 标签：brightcove

使用单个视频播放器时，我可以成功传递附加的AdTargetingParams，其值针对广告服务器（例如：VERTICAL、PARTNER 等）。这些值基于单个视频的元数据。但是在使用播放列表播放器时，我不清楚每次播放新视频时如何将相同的视频级细节传递给广告调用。

我知道一种选择可能是使用单个视频播放器和缩略图来伪造播放列表体验，但我觉得应该有一种方法可以为播放列表中的每个视频做到这一点，我只是还没有看到它。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T14:21:12.310

在 Video Cloud Studio 的 Advertising 模块中可以为视频设置 Key-Value，但如果要动态设置，可以使用播放器的 setAdPolicy() API。

setAdPolicy() API 的文档：http: [//developer.brightcove.com/en/articles/dynamic-ad-policies-using-setadpolicy-api](http://developer.brightcove.com/en/articles/dynamic-ad-policies-using-setadpolicy-api)

此 API 将允许您在播放每个视频时为其设置键值。使用 getAdPolicy() 获取当前广告策略的副本，侦听 MediaEvent.CHANGE（在选择新视频时触发），根据需要修改对象（即更改键值），然后使用 setAdPolicy()新对象。

目前，这是一个仅限 Flash 的 API。对于 HTML5，您可能会考虑您提到的单一视频播放器体验。

播放器还自动将播放列表作为键值包含在内。在广告服务器中，您可以直接将播放列表 ID 定位为键值，而无需任何代码（尽管这与 VERTICAL、PARTNER 作为您想要的标志的用例不完全匹配）： [http://support.brightcove .com/en/video-cloud/docs/key-value-pairs-passed-video-cloud](http://support.brightcove.com/en/video-cloud/docs/key-value-pairs-passed-video-cloud)

# android - Android：如何解析这个 XML？

> ID：13956591
> 
> 赞同：-1
> 
> 时间：2012-12-19T16:18:34.333
> 
> 标签：android, xml, xml-parsing

我得到这种XML，

```
<?xml version="1.0"?>
<bats>
<symbols timestamp="2012-12-19 10:10:47" count="7984">
<symbol name="A"/>
<symbol name="AA"/>
<symbol name="AA-"/>
<symbol name="AAAA~"/>
<symbol name="AACC"/>
<symbol name="AADR"/> 
```

ETC...

我只需要提取 name=" *text* " 中的元素。

请问我该怎么做？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:26:19.977

您要解析的文本在一个属性中，您可以在`startElement`方法中使用这样的 SAX 解析器对其进行解析：

```
public void startElement(String uri, String localName, String qName,
        Attributes atts) throws SAXException {
        String key;
        if(qName.equals("symbol")) {
           key = atts.getValue("name");
         }
    } 
```

编辑：我认为这只是您 XML 的一小部分……您无法解析无效的 XML。但是，您可以获取该 XML 并执行类似的操作（以使其有效）：

```
parsedXml.append("\n</bats>"); 
```

# java - 无法通过反射在 EJB 内从 Field 转换为 EntityManager

> ID：13956592
> 
> 赞同：0
> 
> 时间：2012-12-19T16:18:37.063
> 
> 标签：java, casting

我想`EntityManager`通过反射在 EJB 中动态获取。我有这个代码：

```
 @Stateful
    @Local(ContextLocal.class)
    public class ContextBean implements ContextLocal {

    @PersistenceContext(unitName="00")
    private EntityManager emBeta;

    @PersistenceContext(unitName="01")
    private EntityManager emPretoria;

    private static Logger logger = Logger.getLogger(ContextBean.class);

    public ContextBean() {}

    @Override
    public void createAccount(String pseudo, char[] password, String email, TemperamentEnum temperament, Universe universe, int galaxie, int solarSystem, int position) throws PSQLException {

        // Récupération de l'EntityManager adequat en fonction de l'univers choisi
        EntityManager em = getEmFromUniverse(universe);

    }

    /**
     * retourne un EntityManager en fonction d'un univers donné
     * 
     * @param universe
     * 
     * @return EntityManager
     */
    private EntityManager getEmFromUniverse(Universe universe){

        EntityManager em = null;

        try {

            Field[] fields = Class.forName(getClass().getPackage() + "ContextBean").getDeclaredFields();

            for(Field field : fields){
                if(!field.getType().equals(EntityManager.class))
                    continue;
                if(field.getName().replaceFirst("^em", "").equalsIgnoreCase(universe.getName()))
                    return (EntityManager)field; // ERROR HERE
            }

        } catch (SecurityException e) {
            logger.log(Level.FATAL, e);
        } catch (ClassNotFoundException e) {
            logger.log(Level.FATAL, e);
        }

        return em;      
    }

} 
```

我不能`Field`投到`EntityManager`：

> 无法从 Field 转换为 EntityManager

`Field`请问我该如何投`EntityManager`反对票？

**编辑 ：**

我可以`universe`通过做我的对象的名称，`universe.getName()`我会得到`beta`or `pretoria`。

我知道我可以使用 getter 来检索正确的 EM：

```
if(universe.getName().equals("beta"))
   return emBeta;
else
   ... 
```

但是我的 EJB 中的 EM 数量可能会增加。因此，通过反射，代码会变慢（但每个用户在注册时只会使用一次），但是当我添加新的 EM 时我不必更改它。这就是为什么我不使用吸气剂。

在我的情况下使用反射有什么缺点吗？

**编辑2：**

我检索到的 EM 的交易完整性会丢失吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:40:26.223

您应该提供包含您需要获取的字段的对象：

```
boolean isAccessible = field.isAccessible();
try {
    field.setAccessible(true);
    return field.get(this); // <-- pass object instance here
} finally {
    field.setAccessible(isAccessible);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:39:47.753

您不能将 Field 强制转换为 EntityManager，因为它们不在同一个类层次结构中。您***真正***想要做的是将 Field 的*值*作为`EntityManager`：

```
field.setAccessible(true);
final EntityManager manager = (EntityManager) field.get(universe); 
```

上面的代码向您*展示了如何*执行此操作，但我强烈建议您不要使用这种方法。当您可以在 Context 对象上创建一个 getter 并以这种方式返回它时，为什么需要通过反射获取实体管理器？我建议不要使用反射的原因是因为您的实体 bean 将由您的应用程序容器代理，并且使用反射可能不会产生您期望的结果。

# custom-taxonomy - 无法在 WP 中制作同位素过滤器/排序帖子

> ID：13956593
> 
> 赞同：0
> 
> 时间：2012-12-19T09:47:17.107
> 
> 标签：custom-taxonomy, loops, jquery

我在一个网站上工作，我正在尝试使用 Isotope (http://isotope.metafizzy.co/docs/filtering.html) 在我的分类页面上过滤/排序帖子。但是由于某种原因，无论我做什么，我都无法使其工作。我需要一些紧急帮助。这是我的编码的样子 - 首先我在我的主题functions.php中有这个来生成类别列表

```
function isotope_categories() {

        $terms = get_terms('videoscategory');

        $html = '<ul class="filters option-set" data-option-key="filter">';
        $html .= '<li><a href="#" data-option-value="*" class="selected">All items</a></li>';

        foreach ($terms as $term) {

            $html .= "<li><a href='#filter' data-filter='.boxes {$term->name}'>{$term->name}</a></li>";   
        }

        $html .= '</ul>';

        echo $html;
    } 
```

然后在我的分类页面上，我这样称呼它-

```
<nav id="options" class="option-set filter" data-option-key="filter">                       
    <?php isotope_categories() ?>
</nav> 
```

类别链接已生成，但它们的功能不像预期的那样。这是我的页面循环 -

```
<div id="content">

<?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>

 <?php $terms = get_the_terms( $post->ID, 'videoscategory' ); ?>

<div class="boxes <?php foreach( $terms as $term ) echo ' ' . $term->name; ?>" style="width:100%; float:left; border-top:1px solid #ccc; margin-top:10px;">

// MY POST CONTENT AND DIVS

</div>
<?php endwhile; else: ?>

<p><?php _e('Sorry, no posts matched your criteria.'); ?></p>

<?php endif; ?>
<?php if (function_exists("pagination")) {
    pagination($additional_loop->max_num_pages);
} ?>
</div> 
```

而它下面的js——

```
<script type="text/javascript">
   jQuery(document).ready(function(){
     var mycontainer = jQuery('#content');
     mycontainer.isotope({
     itemSelector: '.boxes'
     });

   // filter items when filter link is clicked
jQuery('#options a').click(function(){
  var selector = jQuery(this).attr('data-filter');
  mycontainer.isotope({ filter: selector });
  return false;  
  });

});
 </script> 
```

我根本无法让它工作，我尝试了几种方法让它工作，但我想我错过了一些东西或者只是做错了。我必须修复或更改什么才能使过滤起作用？

很感谢任何形式的帮助。谢谢。

**编辑：**

通过使用 chrome 调试控制台，我能够看到这个错误 - Uncaught TypeError: Object [object Object] has no method 'isotope' - 我不确定它的含义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T06:54:19.530

好的，我能够让它工作和过滤，除了我还需要做一些事情才能让它按照我想要的方式工作。就它的功能而言，我确实设法让它工作。万一其他人感兴趣-这就是我所做的

1.  首先我检查了我的主题functions.php和我的标题以确保包含最新的jquery并且包含正确的脚本，我还确保它没有被多次包含并且它们的顺序正确（首先是jquery脚本，然后是同位素脚本。）

    `<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js'></script> <script type='text/javascript' src='<?php bloginfo('template_directory'); ?>/lib/jquery.isotope.min.js'></script>`

2.  接下来，我确保同位素的 CSS 在我的样式表中。

    ```
    .isotope-item {
      z-index: 2;
    }

    .isotope-hidden.isotope-item {
      pointer-events: none;
      z-index: 1;
    }

    .isotope,
    .isotope .isotope-item {
      /* change duration value to whatever you like */
      -webkit-transition-duration: 0.8s;
         -moz-transition-duration: 0.8s;
              transition-duration: 0.8s;
    }

    .isotope {
      -webkit-transition-property: height, width;
         -moz-transition-property: height, width;
              transition-property: height, width;
    }

    .isotope .isotope-item {
      -webkit-transition-property: -webkit-transform, opacity;
         -moz-transition-property:    -moz-transform, opacity;
              transition-property:         transform, opacity;
    } 
    ```

3.  之后，我在过滤器列表的函数中编辑了代码（您可以在我的问题中看到原始代码）

    ```
     function isotope_categories() {

        $terms = get_terms('videoscategory');

        $html = '<ul id="options">';
        $html .= '<li><a href="#" data-option-value="*" data-filter="*" class="selected">All items</a></li>';

        foreach ($terms as $term) {

            $html .= "<li><a href='#' data-filter='.{$term->slug}' class='current'>{$term->name}</a></li>";   
        }

        $html .= '</ul>';

        echo $html;
    } 
    ```

4.  接下来，我更改了循环的编码-

    ```
     <div id="content" style="width: 94%;">
       <div id="isocontent">
       <?php if ( have_posts() ) : while ( have_posts() ) : the_post(); ?>

       <?php $terms = get_the_terms( $post->ID, 'videoscategory' ); ?>

       <div class="box<?php foreach( $terms as $term ) echo ' ' . $term->slug; ?>" style="width:100%; float:left; border-top:1px solid #ccc; margin-top:10px;">

       //MY DIVS AND CONTENT

       </div>

       <?php endwhile; else: ?>

       <p><?php _e('Sorry, no posts matched your criteria.'); ?></p>

       <?php endif; ?>
       <div style="position:absolute;">
       <?php if (function_exists("pagination")) {
    pagination($additional_loop->max_num_pages);
       } ?>
       </div></div></div> 
    ```

5.  然后我编辑了它下面的javascript代码-

    ```
     <script type="text/javascript">
       $(document).ready(function(){
       var mycontainer = $('#isocontent');
     mycontainer.isotope({
     itemSelector: '.box'
     });

       // filter items when filter link is clicked
       $('#options a').click(function(){
       var selector = jQuery(this).attr('data-filter');
       mycontainer.isotope({ filter: selector });
       return false;  
       });

       });
       </script> 
    ```

做完这一切之后，我终于能够让同位素发挥作用。我还有一些事情要解决，以便我可以让它完全按照我想要的方式工作，但就让它正常运行而言，这对我有用。

# opencv - 使用 OpenCV 检测正方形

> ID：13956594
> 
> 赞同：1
> 
> 时间：2012-12-19T16:18:40.793
> 
> 标签：opencv

我想使用 OpenCV 检测正方形。这是我要处理的图像：

[![](../Images/83ba5847869793b0cee0cfb246e2193a.png)](https://i.imgur.com/ByKhN.jpg)

有 11 个彩色方块，在[https://code.ros.org/trac/opencv/browser/trunk/opencv/samples/c/squares.c?rev=1429](https://code.ros.org/trac/opencv/browser/trunk/opencv/samples/c/squares.c?rev=1429)上的 OpenCV 示例不会检测到所有方块. 我能做些什么来检测所有这些？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T13:34:12.493

根据案例优化代码。边学边玩。

检测正方形的另一种方法是使用基于签名的广义霍夫投票框架。创建一个方形签名，然后将其与图像进行卷积。在“霍夫空间”中累积结果并找到最大值（例如均值偏移）。要实现尺度不变性，请构建多尺度签名。

或者您可以尝试模板匹配。使用密集采样或关键点检测器（例如 harris edge ），并使用一些描述符（例如 SURF、ORB）构建空间码本。然后，您可以通过对码本距离进行阈值化来使用滑动窗口进行匹配。

# svn - svn挂在密码上

> ID：13956603
> 
> 赞同：2
> 
> 时间：2012-12-19T16:18:59.273
> 
> 标签：svn

我正在尝试运行合并的试运行，当我输入密码时它挂起。

```
svn merge --dry-run  --username mpsss -r BASE:HEAD .
Authentication realm: <https://svn.ggg.fff.ccc:443> CORE SVN Site
Password for 'mpsss': Mypassword 
```

我知道我的密码是好的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-19T08:46:45.123

一个可能的解决方案可能是选项：`--config-option servers:global:http-library=serf`

然后完整的命令：

```
svn merge --username mpsss --password password --no-auth-cache
          --config-option servers:global:http-library=serf
          --dry-run -r BASE:HEAD . 
```

# google-apps-script - 是否可以创建不加载页面的锚点？

> ID：13956604
> 
> 赞同：0
> 
> 时间：2012-12-19T16:18:59.903
> 
> 标签：google-apps-script

我想创建一个不加载页面的锚点，而只是触发客户端脚本。

我的问题是我创建的锚点总是会在单击时重新加载当前页面（虽然，是的，它确实首先通过 addClickHandler 执行 ClientHandler 代码）。这就是我创建锚点的方式：

```
app.createAnchor(text, '').setTarget('_self'); 
```

这会生成带有空白“href”的 html。我也尝试过使用'#'的href，但最终在html中使用'http://www.google.com/url?q=%23&sa=N&usd=2&usg=AFQjCNGs0Cz4Vz7tdafpLWloZGOjmdJv4Q'这样的href，它会导致重定向循环。（我认为 Hyperlink 小部件（和 InlineHyperlink）可能会做我想做的事，但它们不仅已被弃用，而且现在实际上也已被删除。）

我只是想知道是否可以使用 UiService 中的锚来完成 - 我找不到方法。（由于我自己的解决方法，我已将其发布为已回答，但我很想听听任何有使用 Anchor 小部件的解决方案的人的意见）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:18:59.903

一个可接受的解决方法可能是创建一个标签而不是锚点，然后对其进行样式设置，以便您获得“指针”手鼠标图标而不是标准箭头光标。

```
app.createLabel(text).setStyleAttributes({cursor: 'pointer'}); 
```

另一种解决方法是使用 HtmlService 对其进行编码，使用简单的 Javascript（JQuery 也可以很好地工作）。将 href 设置为 '#' 并添加一个 onclick 处理程序。

# system-verilog - SystemVerilog fork/join w/“run()”类型函数和 SystemC

> ID：13956606
> 
> 赞同：4
> 
> 时间：2012-12-19T16:19:04.003
> 
> 标签：system-verilog, fork-join, systemc

我正在尝试将内存控制器的 SystemVerilog 模型移植到 SystemC，并且想知道`run()`用 fork 生成并加入 SystemC 的转换类型函数（即使用执行连续处理的永久循环）的最佳方法是什么。这些`run()`函数通常在模拟开始时生成。我的困惑是 SystemC 确实支持生成线程、fork 和 join，但我相信该语言的目的是`SC_THREAD`提供这种功能。有没有人有足够的两种语言经验来发表评论？

注意：我认为这个问题更多地与惯例有关，而不是技术上正确或错误的解决方案。可能它可以通过不止一种方式完成。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-18T16:05:18.083

sc_thread 类似于 SystemVerilog 的 fork/join。两种语言都使用相同的非抢占式多线程语义来实现它们的线程。也就是说，一个线程一直运行直到它等待某些东西。此时，线程将控制权让给计划同时运行的任何其他线程。两种语言都是有限制的确定性的。显然，种子必须相同，但更改任何代码也会导致随机化发生变化。我相信这也包括线程运行的顺序，但我可能错了。

如上所述，您不应在 SystemC 中使用 posix fork/join，因为该库不是线程安全的，还因为它打破了库的假设并引入了非确定性。

因此，只要 SV 代码没有 SC 缺乏的功能，移植就应该很简单。

# google-maps - GoogleMaps 地理编码器错误：ZERO_RESULTS

> ID：13956615
> 
> 赞同：1
> 
> 时间：2012-12-19T16:19:22.007
> 
> 标签：google-maps, google-geocoder, street-address

这是我获取地址的 lon 和 lat 的 JS 代码。

在 99% 的情况下它都可以正常工作......但有时我会得到 ZERO_RESULTS 状态......

```
if (geocoder) {
    geocoder.geocode({'address': address, 'language':'it'}, function (results, status) {
        if (status == google.maps.GeocoderStatus.OK) {
            $('#frm_company_lat').val(results[0].geometry.location.lat());
            $('#frm_company_lon').val(results[0].geometry.location.lng());

            can_submit = true;
            $('#company_frm').trigger("submit");
        } else{
            top.console.debug(address);
            top.console.debug(status);
            alert("Cannot get lon in lat: "+ address);
            //can_submit = true;
            //$('#company_frm').trigger("submit");
        }
    });
} 
```

地址没什么特别的，如果我直接在谷歌地图中查找它，它会显示...

如果我尝试直接获取 JSON（通过直接 url），我会得到相同的结果！

[http://maps.googleapis.com/maps/api/geocode/xml?address=Via%20Selo%2010a,%2047122%20Forli,%20Italia&sensor=false](http://maps.googleapis.com/maps/api/geocode/xml?address=Via%20Selo%2010a,%2047122%20Forli,%20Italia&sensor=false)

**请指教**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:25:33.963

看起来有时最好从地址查询中**删除邮政编号/邮编...**

所以在特定情况下，如果我删除 47122 它可以正常工作。

# css - 为什么我的页脚没有位于所有内容/div 下方？

> ID：13956620
> 
> 赞同：1
> 
> 时间：2012-12-19T16:19:39.830
> 
> 标签：css

我几乎完成了我的网站的编码。我在*所有*div 和部分下制作了页脚。我使用了一个新的部分，`<footer>`.

但是页脚不在内容之下。为什么？它粘在顶部。

> [http://generationx-pk.net/tools/index.html](http://generationx-pk.net/tools/index.html)

我如何让它粘在底部，但并非总是如此，你知道当你进入网站时，直到你向下滚动才会看到页脚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:24:42.600

您不应该将带有内容 div 的容器放在标题 div 中。

那应该对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:29:34.567

只需编辑您`css`的删除高度属性，

```
.header {
height: 55px; 
} 
```

改成`height: auto;`

# php - Symfony 2 Forms and Doctrine Mongo - 如何渲染 @Embed 和 @Hash 属性？

> ID：13956621
> 
> 赞同：2
> 
> 时间：2012-12-19T16:19:38.640
> 
> 标签：php, symfony, doctrine-orm, symfony-forms, doctrine-odm

我完全陷入了 Symfony Forms 和 Doctrine MongoDb 的结合中，需要你的帮助。

我有一个带有@EmbedMany 和@Hash 的用户类：

```
/**
 * @MongoDB\Document
 */
class User
{
    /**
     * @MongoDB\EmbedMany(targetDocument="Project", strategy="set")
     */
    protected $projects;

    /**
     * @MongoDB\Hash
     */
    protected $schedule;
} 
```

项目类：

```
/**
 * @MongoDB\Document
 */
class Project
{
    /**
     * @MongoDB\Id
     */
    protected $id;

    /**
     * @MongoDB\String
     */
    protected $name;
} 
```

通过 Doctrine Document Manager 保存新记录后，我得到了以下结构：

```
{
   "_id": "1",
   "projects": [
     {
       "_id": ObjectId("50d1c5116146a13948000000"),
       "name": "Project 1"
     },
     {
       "_id": ObjectId("50d069336146a10244000000"),
       "name": "Project 2"
     }
   ],
   "schedule": ["2012-12-01", "2012-12-04"]
} 
```

还有 2 个集合 - 项目和时间表，充满了数据。

当我尝试编辑用户时，我想显示一个带有 2 个复选框列表的表单，其中包含来自这些集合的数据和用户拥有的选定项目。像这样：

[![例子](../Images/abd4f415e74cebec450352a46be748f7.png)](https://i.stack.imgur.com/ZeYkG.png)

问题是如何为@Embed 和@Hash 属性构建这样的表单？

我尝试了不同的方法：

```
class UserFormType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('schedule', 'collection', array(
            'type' => 'choice',
            'options'  => array(
                'expanded' => true,
                'multiple' => true,
            ),
        ));
        $builder->add('projects', 'document', array(
            'class' => 'Acme\MyBundle\Document\Project',
            'property' => 'name',
        ));
    }

    public function getDefaultOptions(array $options)
    {
        return array('data_class' => 'Acme\MyBundle\Document\User');
    }
} 
```

或者

```
 $builder->add('schedule', 'choice', array(
        'expanded' => true,
        'multiple' => true,
 ));
 $builder->add('projects', 'collection', array(
        'type' => 'choice',
        'options'  => array(
            'expanded' => true,
            'multiple' => true,
        ),
 )); 
```

其中一些失败并出现错误：`Expected argument of type "array", "string" given`。有些产生了成功的表单渲染，但列表中没有选定的项目。

也许我应该使用自定义数据转换器或手动呈现这些控件......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:32:58.500

要使用嵌入文档，必须将嵌入文档注释为 EmbeddedDocument，而不是 Document。但是，看起来您实际上希望在用户文档中的项目注释上使用 ReferenceMany；从嵌入文档列表中选择是没有意义的，除非您说选择要删除的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T10:58:38.247

我解决了@Hash 问题。考虑到数字索引数组，应该使用 @Collection 注释。

```
$builder->add('schedule', 'choice', array(
        'choices' => <your choices list here>,
        'expanded' => true,
        'multiple' => true,
)); 
```

@EmbedMany 问题仍然存在。

# java - 如何在jsp中迭代一组代码？

> ID：13956627
> 
> 赞同：0
> 
> 时间：2012-12-19T16:20:01.240
> 
> 标签：java, jsp, netbeans

我想用jsp迭代这组代码，（我用的是Netbeans 7.2.1）

```
<div class ="grid">
        <div class="img">
            <a target="_blank" href="Selected_Game.jsp?gameid=<%=rs.getString(1)%>">
                <img src="<%=rs.getString(2)%>" alt="">
            </a>
            <div class="desc">
                <div class="GName"> 
                    <%=rs.getString(3)%></div>
                <div class="Cost">Rs.<%=rs.getInt(5)%></div>
            </div>
        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:33:32.950

我相信，您正在从数据库中检索数据。然后，像这样编写代码

```
<div class ="grid">
<% 
while (rs.next()) {  // check for next row and display data accordingly
%>
  <div class="img">
        <a target="_blank" href="Selected_Game.jsp?gameid=<%=rs.getString(1)%>">
            <img src="<%=rs.getString(2)%>" alt="">
        </a>
        <div class="desc">
            <div class="GName"> 
                <%=rs.getString(3)%></div>
            <div class="Cost">Rs.<%=rs.getInt(5)%></div>
        </div>
    </div>

<% 
 }   //end of while loop
%>
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:30:26.773

不确定您是否想将该代码放入循环中，或者像包含一样重用它。

迭代（循环）

您可以将该代码包装在 for 循环中：

```
<% for (int i=0; i<limit; i++) { %>
  html and jsp code in here
  <%= i %>
<% } %> 
```

迭代（重复）

您可以将该代码放在片段/标签中并包含它：

```
<jsp:include page="hello.jsp"/> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:30:59.410

使用 JSTL 的[**C:for-each 标签**](http://www.java2s.com/Tutorial/Java/0380__JSTL/JSTLForEachLoopwithBeginEndStep.htm)

```
 <c:forEach var="person" items="${people.people}" varStatus="rowCounter">

      </c:forEach> 
```

# java-me - 如何遍历 jar 文件中的资源文件夹？

> ID：13956632
> 
> 赞同：1
> 
> 时间：2012-12-19T16:20:10.870
> 
> 标签：java-me

在 J2ME 中是否有类似的东西

```
ResFolder resFolder = new ResFolder("/myFolder"); // or "/myfolder/*.png"
for (i=0; i<resFolder.count; i++] {
  img = Image.createImage(resFolder.fileName[i]);
} 
```

?

我正在使用带有文件名的 .txt 来执行此操作。有谁知道是否有更实用的方法来做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2021-12-04T10:53:40.453

有两种选择。

1.) jar 文件是 Zip 文件，可以列举内容，例如这里 [List Contents Of Zip File Example](https://www.java-examples.com/list-contents-zip-file-example)

2.) 资源（文件夹）在技术上是一个 URL，它不提供枚举。但是您可以生成一个索引作为资源`/path/to/your/content/index.txt`，其中列出了内容/文件。因此，您可以从该索引中编写资源 URL 并访问它们。

后一个选项适用于 jar 和文件存储库。

# asp.net - 从外部 .config 文件异常加载配置

> ID：13956633
> 
> 赞同：0
> 
> 时间：2012-12-19T16:20:12.577
> 
> 标签：asp.net, configurationmanager

我有以下类继承自 ConfigurationSection

```
public class ExceptionsConfiguration:ConfigurationSection
    {
        private static ExceptionsConfiguration _exceptionsconfig = ConfigurationManager.GetSection("ExceptionsConfig") as ExceptionsConfiguration;
        /// <summary>
        /// Static accessible configuration
        /// </summary>
        public static ExceptionsConfiguration ExceptionsConfig
        {
            get
            {
                return _exceptionsconfig;
            }
        }
        //HTML message with the exception to be sent by email
        public string HTMLMessage { get; set; }
        //Subject of the email
        public string Subject { get; set; }
        //UserName of the email account to use
        public string FromLabel { get; set; }
        //Password of the email
        public string Password { get; set; }
        //Email account used to send the email
        public string Email { get; set; }
        //To account to send email with exception
        public string To{get;set;}
        //Smtp server used to send the email
        public string SmtpServer{get;set;}
        //Port used to send the email
        public int Port{get;set;}
    } 
```

另一方面，我在 web.config 上声明了我的部分

```
<configSections>
        <section name="ExceptionsConfig" type="Framework.Web.Configuration.ExceptionsConfiguration" allowLocation="true" allowDefinition="Everywhere" />
    </configSections>
    <ExceptionsConfig configSource="Config\ExceptionsConfig.config"/> 
```

最后是我的配置文件：

```
<ExceptionsConfig>
    <HTMLMessage>
        <![CDATA[
            <p> DataService:{0}</p>
            <p> AvailableCategories:{1} </p>
            <p> Queries:{2} </p>
            <p> Exception:{3} </p>
            <p> Is child action:{4} </p>
            <p> Action executed:{5} </p>
            <p> Controller executed:{6} </p>
            <p> Current URL: {7} </p>
            <p> Headers start </p>
            <p> {8} </p>
            <p> Headers end </p>
            <p> IP adress: {9}
        ]]>
    </HTMLMessage>
    <Subject>Exception on www.</Subject>
    <FromLabel>Exception watcher from</FromLabel>
    <Password>zzzzz</Password>
    <Email>xxxxxx@xxxxx.com</Email>
    <To>yyyyyy@yyyyyyy.com</To>
    <SmtpServer>smtp.nnnnnnn.com</SmtpServer>
    <Port>000</Port>
</ExceptionsConfig> 
```

这里是堆栈跟踪：

zh Framework.Web.Configuration.ExceptionsConfigurationSection.get_ExceptionsConfiguration() zh Framework.Web.Filters.ExceptionFilter.OnException(ExceptionContext filterContext) zh C:\inetpub\wwwroot\Projects\Generic Website\Framework.Web\Filters\ExceptionFilter.cs:línea 19 System.Web.Mvc.ControllerActionInvoker.InvokeExceptionFilters(ControllerContext controllerContext, IList `1 filters, Exception exception) en System.Web.Mvc.ControllerActionInvoker.InvokeAction(ControllerContext controllerContext, String actionName) en System.Web.Mvc.Controller.ExecuteCore() en System.Web.Mvc.ControllerBase.Execute(RequestContext requestContext) en System.Web.Mvc.ControllerBase.System.Web.Mvc.IController.Execute(RequestContext requestContext) en System.Web.Mvc.MvcHandler.<>c__DisplayClass6.<>c__DisplayClassb.<BeginProcessRequest>b__5() en System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass1.<MakeVoidDelegate>b__0() en System.Web.Mvc.Async.AsyncResultWrapper.<>c__DisplayClass8`1.b_ *7(IAsyncResult* ) en System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.End() en System.Web.Mvc.MvcHandler。 <> *c_DisplayClasse.b*_d() en System.Web.Mvc.SecurityUtil.b__0(Action f) en System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) en System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) en System.Web。 Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult result) en System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() en System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)

我收到类 ExceptionsConfiguration 的类型初始化错误...并且错误显示**"Element HTMLMessage not Recognized"**。

你能帮我一把吗？

谢谢

问候

何塞

# php - Javascript - 单击按钮以填充文本框

> ID：13956640
> 
> 赞同：-2
> 
> 时间：2012-12-19T16:20:23.457
> 
> 标签：php, javascript

这非常有效 - 使用下拉框找到了这个示例并进行了修改 - 当然还有一些帮助！

```
<!DOCTYPE html>
<html>
<head>
<script> function moveNumbers(num) {
var txt=document.getElementById("result").value;
txt=txt + num;
document.getElementById("result").value=txt;
}
</script>

</head>

<body>
<form>

Select numbers: <br> <input type="button" value="1" name="no"     onclick="moveNumbers(this.value)">  
<input type="button" value="2" name="no" onclick="moveNumbers(this.value)">  
<input type="button" value="3" name="no" onclick="moveNumbers(this.value)">  
<input type="text" id="result" size="20">

</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:22:24.103

**HTML：**

```
<input type="text" id="screen" />
<div id="keypad">
    <button>7</button>
    <button>8</button>
    <button>9</button>
    <br />
    <button>4</button>
    <button>5</button>
    <button>6</button>
    <br />
    <button>1</button>
    <button>2</button>
    <button>3</button>
    <br />
    <button>0</button>
</div> 
```

**JavaScript：**

```
window.onload = function () {
    var screen  = document.getElementById('screen'),
        keypad  = document.getElementById('keypad'),
        buttons = keypad.getElementsByTagName('button');
    for (var i = 0; i < buttons.length; i++) {
        buttons[i].onclick = function () {
            screen.value = screen.value + this.innerHTML;
            return false;
        };
    }
};​ 
```

**完整示例：**

```
<!DOCTYPE HTML>
<html>
<head></head>
<body>
    <form onsubmit="javascript: /* Just for testing */ alert('Sending...'); return false;">
        <input type="text" id="screen" />
        <div id="keypad">
            <button>7</button>
            <button>8</button>
            <button>9</button>
            <br />
            <button>4</button>
            <button>5</button>
            <button>6</button>
            <br />
            <button>1</button>
            <button>2</button>
            <button>3</button>
            <br />
            <button>0</button>
        </div>
    </form>
    <script>
        window.onload = function () {
            var screen  = document.getElementById('screen'),
                keypad  = document.getElementById('keypad'),
                buttons = keypad.getElementsByTagName('button');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].onclick = function () {
                    screen.value = screen.value + this.innerHTML;
                    // Try to comment line below to see what happens
                    return false;
                };
            }
        };​
    </script>
</body>
</html> 
```

**演示：** [JSFiddle](http://jsfiddle.net/nTzY4/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:30:45.260

**工作示例：http:** [//jsfiddle.net/KhwHY/1/](http://jsfiddle.net/KhwHY/1/)

**jQuery**

```
$('input').click(function(){
    if(this.checked) {
        $('#Output').text($('#Output').text() + $(this).val());
    } else {
    }
});​ 
```

**HTML**

```
<form>
    <input type="checkbox" value="1">1<br />
    <input type="checkbox" value="2">2<br /> 
    <input type="checkbox" value="3">3<br />
</form>

<div id="Output">

</div> 
```

这应该为您提供一个良好的起点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:28:28.290

```
<input type="checkbox" id="checkBox1" onclick="app(1)">
<input type="checkbox" id="checkBox2" onclick="app(2)">
<input type="checkbox" id="checkBox2" onclick="app(3)">

<script language="javascript">
    function app(text)
    {
         var TheTextBox = document.getElementById("Mytextbox"); //Replace this with correct name
         TheTextBox.value = TheTextBox.value + text;
    }
</script> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-19T16:28:33.090

我做了 90% 的工作，你从这里拿走。[http://jsfiddle.net/MeWhp/](http://jsfiddle.net/MeWhp/)

```
 <!DOCTYPE html>
<html>
<head>
  <style>
input, label { line-height: 1.5em; }
</style>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<body>

<form>
  <div>
    <input type="checkbox" name="fruit" value="1" id="orange">
    <label for="orange">orange</label>
  </div>
  <div>
    <input type="checkbox" name="fruit" value="2" id="apple">
    <label for="apple">apple</label>
  </div>
  <div>
    <input type="checkbox" name="fruit" value="3" id="banana">
    <label for="banana">banana</label>
  </div>
  <textarea id="log">
   </textarea>
</form>

<script>

</script>
$("input").click(function() {
  $("#log").html( $(":checked").val() + " is checked!" );
});
</body>
</html>​ 
```

# iphone - 点击地图图钉给出错误信息

> ID：13956642
> 
> 赞同：1
> 
> 时间：2012-12-19T16:20:34.343
> 
> 标签：iphone, ios, mkmapview, mkannotation, mkannotationview

我遇到的问题是，当我单击图钉时，它会给出与同一图钉相关的错误信息。我认为引脚的索引可能与数组的索引不同。

这是代码：

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation
{
    MKAnnotationView *pinView = nil;

    if(annotation != mapView.userLocation)
    {
        static NSString *defaultPinID = @"com.invasivecode.pin";
        pinView = (MKAnnotationView *)[mapView dequeueReusableAnnotationViewWithIdentifier:defaultPinID];
        if ( pinView == nil )
            pinView = [[MKAnnotationView alloc]
                       initWithAnnotation:annotation reuseIdentifier:defaultPinID];
        pinView.canShowCallout = YES;

        if ((annotation.coordinate.latitude == mapLatitude) && (annotation.coordinate.longitude == mapLongitude)) {

                if ([estadoUser isEqualToString:@"online"])
                    {
                       // NSLog(@"ONLINE");
                        pinView.image = [UIImage imageNamed:@"1352472516_speech_bubble_green.png"];    //as suggested by Squatch
                    }else{
                        //NSLog(@"OFFLINE");
                        pinView.image = [UIImage imageNamed:@"1352472468_speech_bubble_red.png"]; 
                    }
        }
        UIButton* rightButton = [UIButton buttonWithType:UIButtonTypeDetailDisclosure];
        [rightButton setTitle:annotation.title forState:UIControlStateNormal];
        [rightButton addTarget:self
                        action:@selector(showDetails)
              forControlEvents:UIControlEventTouchUpInside];
        pinView.rightCalloutAccessoryView = rightButton;

    } else {
        [mapView.userLocation setTitle:@"I am here"];
        }
    return pinView;
}

-(void)showDetails
{
    UIStoryboard* storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPhone" bundle:nil];
    DMChatRoomViewController *_controller = [storyboard instantiateViewControllerWithIdentifier:@"DmChat"];
    [self presentViewController:_controller animated:YES completion:nil];
}

-(void)mapView:(MKMapView *)mapView didSelectAnnotationView:(MKAnnotationView *)view
{
    if ([view.annotation isKindOfClass:[DisplayMap class]])
    {   
         NSInteger index = [mapView.annotations indexOfObject:view.annotation]      

        DisplayMap *annotation = (DisplayMap *)view.annotation;

        NSMutableDictionary *item = [allMapUsers objectAtIndex:index];

    //HERE DOES NOT DISPLAY THE INFO ON THE CORRECT PLACE

        NSUserDefaults * standardUserDefaults = [NSUserDefaults standardUserDefaults];
        [standardUserDefaults setObject:[[allMapUsers objectAtIndex:index] objectId] forKey:@"userSelecionadoParaChat"];

        [standardUserDefaults synchronize];
    }  
}

-(void)reloadMap
{
     NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    for (int i=0; i<allMapUsers.count; i++)
    {
        NSMutableDictionary *item = [allMapUsers objectAtIndex:i];

        NSLog(@"index=%i  para objectID=%@",i,[[allMapUsers objectAtIndex:i] objectId]);

        if (([[item valueForKey:@"estado"] isEqualToString:@"offline"] && [[defaults stringForKey:@"showOfflineUsers"] isEqualToString:@"no"]) || [[item valueForKey:@"estado"] isEqualToString:@""]) {

        }else{

        estadoUser = [item valueForKey:@"estado"];

        [outletMapView setMapType:MKMapTypeStandard];
        [outletMapView setZoomEnabled:YES];
        [outletMapView setScrollEnabled:YES];

        MKCoordinateRegion region = { {0.0, 0.0 }, { 0.0, 0.0 } };
        region.center.latitude = [[item valueForKey:@"Latitude"] floatValue];

        region.center.longitude = [[item valueForKey:@"Longitude"] floatValue];

        region.span.longitudeDelta = 81;
        region.span.latitudeDelta = 80;
        [outletMapView setRegion:region animated:YES];
        /////
        mapLatitude = [[item valueForKey:@"Latitude"] floatValue];
        mapLongitude = [[item valueForKey:@"Longitude"] floatValue];

        CLLocationCoordinate2D locationco = {mapLatitude,mapLongitude};

        ann = [[DisplayMap alloc] init];
        ann.coordinate = locationco;

        ann.title =   [item valueForKey:@"username1"];
            NSLog(@"ann.title=%@  para objectID=%@",[item valueForKey:@"username1"],[[allMapUsers objectAtIndex:i] objectId]);
        ann.subtitle = [item valueForKey:@"estado"];
        ann.coordinate = region.center;
        [outletMapView addAnnotation:ann];

        }
    }
} 
```

对不起我的英语不好，如果你不明白这个问题，请不要贬低，只是问，我总是在附近回答。

最好的祝福

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T16:56:36.080

在`didSelectAnnotationView`中，这段代码：

```
NSInteger index = [mapView.annotations indexOfObject:view.annotation]      
DisplayMap *annotation = (DisplayMap *)view.annotation;
NSMutableDictionary *item = [allMapUsers objectAtIndex:index]; 
```

不会总是有效，因为地图视图的`annotations`数组***无法保证***注释的顺序与您添加它们的顺序相同。（有关这一点的详细信息，请参阅[MKMapView 注释更改/丢失顺序？](https://stackoverflow.com/questions/9539802/mkmapview-annotations-changing-losing-order)和[如何重新排序 MKMapView 注释数组](https://stackoverflow.com/questions/13017305/how-to-reorder-mkmapview-annotations-array)。）

您***根本不能假设***数组`index`中的注释与`mapView.annotations`数组中注释源数据的索引相同`allMapUsers`。

相反，您可以做的是在注释本身中保留对源对象的引用。

例如，向您的类添加一个`NSMutableDictionary`属性：`DisplayMap`

```
@property (nonatomic, retain) NSMutableDictionary *sourceDictionary; 
```

创建注释时，设置属性：

```
ann = [[DisplayMap alloc] init];
ann.sourceDictionary = item;  // <-- keep ref to source item
ann.coordinate = locationco; 
```

然后在`didSelectAnnotationView`：

```
DisplayMap *annotation = (DisplayMap *)view.annotation;
NSMutableDictionary *item = annotation.sourceDictionary; 
```

另一个可能的问题是`viewForAnnotation`：

```
pinView = (MKAnnotationView *)[mapView dequeueReusableAnnotation...
if ( pinView == nil )
    pinView = [[MKAnnotationView alloc] ...
pinView.canShowCallout = YES; 
```

如果出队返回一个以前使用过的视图，它的`annotation`属性仍将指向它以前使用的注解。使用出队视图时，必须将其`annotation`属性更新为当前注解：

```
pinView = (MKAnnotationView *)[mapView dequeueReusableAnnotation...
if ( pinView == nil )
    pinView = [[MKAnnotationView alloc] ...
else
    pinView.annotation = annotation;  // <-- add this
pinView.canShowCallout = YES; 
```

有关更多详细信息，请参阅[MKMapView 屏幕外注释图像不正确](https://stackoverflow.com/questions/13869635/mkmapview-off-screen-annotation-image-incorrect/13870025#13870025)。

# grails - Grails 2.1.0 是否需要 Groovy 1.8？

> ID：13956646
> 
> 赞同：7
> 
> 时间：2012-12-19T16:20:47.697
> 
> 标签：grails, groovy, bamboo, grails-2.1

我最近将 Grails 应用程序更新到 2.1.0，但是当我`war`进行项目时，我收到以下错误：

> java.lang.NoClassDefFoundError: org/codehaus/groovy/transform/powerassert/ValueRecorder

*   Groovy 版本 1.7.5
*   Grails 版本 2.1.0

这两个版本兼容吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T16:47:01.090

不，Grails 1.3.x 使用 Groovy 1.7，Grails 2.0.x 和 2.1.x 使用 Groovy 1.8，Grails 2.2 使用 Groovy 2.0，Grails 2.3 将使用 Groovy 2.1。您可能应该`grails dependency-report`查看一下 Groovy 1.7 中的内容，并将适当的排除项放入您的`BuildConfig`依赖项声明中。

# html - Symbian belle模拟器浏览器版

> ID：13956649
> 
> 赞同：0
> 
> 时间：2012-12-19T16:20:54.640
> 
> 标签：html, emulation, symbian

我正在 symbian_belle_sdk_1.0 模拟器上测试一个网站，但安装的浏览器版本对我来说太旧了。提醒 userAgent 会返回“NokiaBrowser 7.4.2.4”。有没有办法将浏览器更新为“NokiaBrowser 8.3.1.4”或任何其他方式来测试更新的 NokiaBrowser？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T08:11:53.940

我从来没有听说过在模拟器中升级浏览器，但是对于其他方法来测试它：首先当然是真机。第二个选项是[远程设备访问](http://www.developer.nokia.com/Devices/Remote_device_access/)。

# linux - 从 .war 文件外部化 Tomcat webapp 配置

> ID：13956651
> 
> 赞同：39
> 
> 时间：2012-12-19T16:21:02.207
> 
> 标签：linux, tomcat, configuration

我在 Tomcat 7 中配置 webapp 时遇到问题。在我的 WAR 文件中，有一个属性文件`myApp/WEB-INF/classes/myProps.props`，它包含特定于环境的属性。我正在尝试覆盖服务器上的该配置文件，以便将同一个 WAR 文件部署到多个环境。

我听说有一种方法可以使用`tomcat/conf/Catalina/myApp`. 这是我无法弄清楚的方法。

此外，`myApp.war`它是在同一 Tomcat 服务器上运行的众多服务器之一，并且它不作为 localhost 运行。我希望能够为几个 webapps 解决这个问题。

```
Server version: Apache Tomcat/7.0.23
Server built:   Nov 20 2011 07:36:25
Server number:  7.0.23.0
OS Name:        Linux 
```

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2012-12-21T23:43:54.000

您`tomcat/conf/Catalina/<host>`可以包含上下文描述符，让您可以配置很多东西，包括定义“环境条目”，这些可以通过 JNDI 从 Java 访问。有很多方法可以使用它。就个人而言，我设置了一个环境条目，它是我的属性文件的文件系统路径。我的应用程序是为检查此条目而构建的，如果它不存在，则改为在类路径中查找该文件。这样，在 dev 中，我们在类路径中就有了 dev 属性，但是当我们构建和部署时，我们将它指向一个外部文件。

在 Tomcat 网站上有很好的[配置上下文的文档。](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html)有关如何创建文件以及将其放置在何处的详细信息，请参阅[*定义上下文*部分。](https://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Defining_a_context)

例如，如果您的主机被命名并且您的应用程序是目录中命名的`myHost`war 文件，那么您可以使用以下内容创建：`myApp.war``webapps``tomcat/conf/Catalina/myHost/myApp.xml`

```
<Context>
    <Environment name="configurationPath" value="/home/tomcat/myApp.properties" type="java.lang.String"/>
</Context> 
```

然后从您的代码中，您将执行 JNDI 查找`java:comp/env/configurationPath`（此处为 95% 确定性）以获取该字符串值。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2014-10-01T17:09:04.583

我喜欢`.properties`文件而不是

*   JNDI - 为什么在程序配置而不是初始化时*构建复杂对象？*
*   系统属性 - 您不能在单个 Tomcat 中单独配置相同 WAR 的多个实例
*   上下文参数 - 它们只能在 中访问`javax.servlet.Filter`，`javax.servlet.ServletContextListener`这很不方便

Tomcat 7 [Context](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html)[包含 Loader](http://tomcat.apache.org/tomcat-7.0-doc/config/loader.html)元素。根据[文档](http://tomcat.apache.org/tomcat-7.0-doc/config/context.html)部署描述符（`<Context>`标签中的内容）可以放在：

*   `$CATALINA_BASE/conf/server.xml`- 坏 - 需要重新启动服务器才能重新读取配置
*   `$CATALINA_BASE/conf/context.xml`- 不好 - 在所有应用程序中共享
*   `$CATALINA_BASE/work/$APP.war:/META-INF/context.xml`- 不好 - 需要重新打包才能更改配置
*   `$CATALINA_BASE/work/[enginename]/[hostname]/$APP/META-INF/context.xml`-*不错*，但请看最后一个选项！！
*   `$CATALINA_BASE/webapps/$APP/META-INF/context.xml`-*不错*，但请看最后一个选项！！
*   `$CATALINA_BASE/conf/[enginename]/[hostname]/$APP.xml`-**最好**- 完全退出应用程序并自动扫描更改！！！

`Context`可以保存自定义`Loader` [org.apache.catalina.loader.VirtualWebappLoader](http://tomcat.apache.org/tomcat-7.0-doc/config/loader.html)（在现代 Tomcat 7 中可用，您可以将**自己的单独的类路径**添加到您的`.properties`），和`Parameter`（通过访问`FilterConfig.getServletContext().getInitParameter(name)`）和`Environment`（通过访问`new InitialContext().lookup("java:comp/env").lookup("name")`）：

```
<Context docBase="${basedir}/src/main/webapp"
         reloadable="true">
    <!-- http://tomcat.apache.org/tomcat-7.0-doc/config/context.html -->
    <Resources className="org.apache.naming.resources.VirtualDirContext"
               extraResourcePaths="/WEB-INF/classes=${basedir}/target/classes,/WEB-INF/lib=${basedir}/target/${project.build.finalName}/WEB-INF/lib"/>
    <Loader className="org.apache.catalina.loader.VirtualWebappLoader"
            virtualClasspath="${basedir}/target/classes;${basedir}/target/${project.build.finalName}/WEB-INF/lib"/>
    <JarScanner scanAllDirectories="true"/>

    <Parameter name="min" value="dev"/>
    <Environment name="app.devel.ldap" value="USER" type="java.lang.String" override="true"/>
    <Environment name="app.devel.permitAll" value="true" type="java.lang.String" override="true"/>
</Context> 
```

如果您使用 Spring 并且它是 XML 配置：

```
<context:property-placeholder location="classpath:app.properties"/>

<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource" destroy-method="close">
    <property name="driverClassName" value="oracle.jdbc.OracleDriver"/>
    <property name="url" value="jdbc:oracle:thin:@${db.host}:${db.port}:${db.user}"/>
    <property name="username" value="${db.user}"/>
    <property name="password" value="${db.pass}"/>
</bean> 
```

使用 Spring 将上述属性注入 bean 字段很容易：

```
@Value("${db.user}") String defaultSchema; 
```

而不是 JNDI：

```
@Inject ApplicationContext context;
Enviroment env = context.getEnvironment();
String defaultSchema = env.getProperty("db.user"); 
```

另请注意，EL 允许这样做（默认值和深度递归替换）：

```
@Value('${db.user:testdb}') private String dbUserName;

<property name='username' value='${db.user.${env}}'/> 
```

也可以看看：

*   [将目录添加到 tomcat 类路径](https://stackoverflow.com/questions/1300780/adding-a-directory-to-tomcat-classpath)
*   [我可以在 Tomcat 中基于每个应用程序创建自定义类路径吗](https://stackoverflow.com/questions/6345793/can-i-create-a-custom-classpath-on-a-per-application-basis-in-tomcat)
*   [如何在Tomcat中读取我的webapp上下文之外的属性文件](https://stackoverflow.com/questions/15318578/how-to-read-a-properties-file-outside-my-webapp-context-in-tomcat)
*   [配置Tomcat使用属性文件加载DB连接信息](https://stackoverflow.com/questions/1380793/configure-tomcat-to-use-properties-file-to-load-db-connection-information)
*   [您是否应该在 server.xml 或 context.xml 中设置数据库连接属性](https://stackoverflow.com/questions/15064260/tomcat-jndi-configuration-best-practice)
*   [外部化 Tomcat 配置](https://stackoverflow.com/questions/11468881/externalize-tomcat-configuration)

**注意**通过将类路径扩展到实时目录，您还**允许外部化任何其他配置**，例如日志记录、身份验证、atc。我`logback.xml`以这种方式外化。

**更新** [Tomcat 8 更改](http://tomcat.apache.org/tomcat-8.0-doc/config/context.html) `<Resources>`和`<Loader>`元素的语法，对应的部分现在看起来像：

```
<Resources>
    <PostResources className="org.apache.catalina.webresources.DirResourceSet"
                   webAppMount="/WEB-INF/classes" base="${basedir}/target/classes" />
    <PostResources className="org.apache.catalina.webresources.DirResourceSet"
                   webAppMount="/WEB-INF/lib" base="${basedir}/target/${project.build.finalName}/WEB-INF/lib" />
</Resources> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T13:54:02.977

您可以尝试将配置（属性文件）放在 JAR 文件中的 Apache Tomcat\lib 中，然后将其从 Web 应用程序中删除。当 Tomcat 的类加载器在 webapp 中找不到您的配置时，它会尝试在“lib”目录中查找。因此，您可以将您的配置外部化，只需将配置移动到全局 lib 目录（它在其他 webapps 之间共享）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-06T11:49:20.287

我只是在tomcat的文件夹中添加了一个`setenv.bat`or`setenv.sh`脚本。`bin`像这样设置`classpath`变量

```
set CLASSPATH=my-propery-folder 
```

# amazon-web-services - AWS AMI 多实例

> ID：13956653
> 
> 赞同：1
> 
> 时间：2012-12-19T16:21:07.010
> 
> 标签：amazon-web-services, amazon-ec2, amazon-ami, ec2-ami

如果我有一个启动两个实例的 AMI（EBS 支持），这两个实例会完全相互独立吗？底层基础设施如何工作？

我发现将整个想法描绘出来有点不知所措。是的，我对这整个 AWS 事物都是新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:41:50.617

是的，它们本质上就像“双胞胎”——它们都是由相同的遗传物质 (AMI) 制成的，但每个都是个体（服务器）。每个实例必须彼此完全分离，并且能够在不知道或不依赖于它的“双胞胎”（其他实例）的情况下独立生存，否则在这个比喻的情况下，您将进入“连体双胞胎”领域！

假设这些实例中的每一个都用于 Web 服务器，那么在基础架构中将所有实例绑定在一起的东西就是“负载均衡器”。这将接收到您的应用程序的请求并将其传递给 Web 服务器实例之一 - 通常是最不忙的实例。

例如

![负载均衡器图](../Images/5276c34ae5942c05a997f209600fb5fb.png)

显然，它的意义远不止于此，但这是总体思路。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T05:49:42.773

只是补充一点，如果您的 AMI 实例中有 ip/DNS 特定的东西，是的，您必须在创建新的 EC2 后编辑它们。

# android - Android 我的位置修复

> ID：13956655
> 
> 赞同：6
> 
> 时间：2012-12-19T16:21:09.693
> 
> 标签：android, android-mapview, mapactivity, mylocationoverlay, geopoints

当我的地图活动被调用时，我会在 onCreate 中调用 addUserMapPoint。此函数包含两个实例，我尝试使用 myOverlay.getMyLocation 获取位置信息。在此活动的初始加载中，第一次尝试的结果返回一个空 GeoPoint，并且在主 UI 线程完成位于 myOverlay.runOnFirstFix(new Runnable()... 的侦听器线程中的第二次尝试后，在一秒钟后调用并且确实包含一个包含纬度和经度的 GeoPoint。此侦听器函数内部的调用似乎确实将点放在地图上，并且 mapController.animateTo(gp) 行确实将地图移动到我的位置。我的应用程序有一个刷新按钮，当单击再次触发此活动。我需要纬度和经度才能从另一个服务获取位置数据。刷新后，

如果我无法通过第一次调用 myOverlay.getMyLocation 来获取 GeoPoint，那么如何从 myOverlay.runOnFirstFix(new Runnable()... 线程中找到的第二次调用中传递纬度和经度值。你会注意到我一直在尝试将 lat 和 lon 添加到 MyApp 这是 helper bean 类但是即使在刷新后这个类中的 lat 和 lon 也是 null 如果我在第一次活动时手动在 addUserMapPoint 函数中手动设置 lat 和 lon被访问这些值被保留。我猜这是因为它是在主 UI 线程上设置的。

```
public class MapActivity extends com.google.android.maps.MapActivity {
    private MapView mapView = null;
    private MapController mapController = null;
    private MyLocationOverlay myOverlay = null;

    public static MyApp app;

    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_map);

        app = (MyApp) getApplicationContext();

        mapView = (MapView) findViewById(R.id.mapview);
        mapView.setBuiltInZoomControls(true);
        mapController = mapView.getController();

        List<Overlay> mapOverlays = mapView.getOverlays();
        mapOverlays.clear();

        addUserMapPoint(mapView);

        if (!app.isLocServOff()) {
            //map other points – service call to get items from our service near lat and lon
            addOtherMapPoints(mapOverlays);

        } else {
            Toast.makeText(app.getApplicationContext(),"Current location could not be found.",Toast.LENGTH_LONG).show();
        }

    }

    private void addUserMapPoint(MapView mapView){
            myOverlay = new MyLocationOverlay(app.getApplicationContext(), mapView);
            myOverlay.disableCompass();
        myOverlay.enableMyLocation();

            if(app.getMyLat()==null||app.getMyLon()==null){
                GeoPoint gp = myOverlay.getMyLocation();
                if(gp!=null){
                    app.setMyLat(Helper.latLon1E6Calc(gp.getLatitudeE6()));
                    app.setMyLon(Helper.latLon1E6Calc(gp.getLongitudeE6()));
                    app.setLocServOff(false);
                }else{
                    app.setLocServOff(true);
                }
        }

        myOverlay.runOnFirstFix(new Runnable() {   
                public void run() {     
                    GeoPoint gp = myOverlay.getMyLocation();    
                    if(gp!=null){
                        app.setMyLat(Helper.latLon1E6Calc(gp.getLatitudeE6()));
                        app.setMyLon(Helper.latLon1E6Calc(gp.getLongitudeE6()));
                        app.setLocServOff(false);   
                        mapController.animateTo(gp);
                    }else{
                        app.setLocServOff(true);
                    }
                }    
            });

        mapView.getOverlays().add(myOverlay);
    }   

} 
```

以下问题正在请求您的帮助。如何在主 UI 线程中获取包含 lat 和 lon 的 GeoPoint，或者如何从 GeoPoint 传递这些值，我可以从 myOverlay.runOnFirstFix(new Runnable()... 线程获取？

如果您要建议我使用 Handler 或 runOnUiThread，请提供代码示例，将 lat 和 lon 传递回主 UI 线程/地图视图可以使用的东西。我已经尝试过类似下面的代码，但没有产生预期的结果。我能够让 toast 消息显示出来，但无法以我可以使用的方式传递 lat 和 lon。

```
 final Handler handler = new Handler();   
    myOverlay.runOnFirstFix(new Runnable() {                     
        @Override public void run() {

            handler.post(new Runnable() {                                   
                @Override public void run() {

                        GeoPoint gp = myOverlay.getMyLocation();    
                        if(gp!=null){
                            app.setMyLat(Helper.latLon1E6Calc(gp.getLatitudeE6()));
                            app.setMyLon(Helper.latLon1E6Calc(gp.getLongitudeE6()));
                            app.setLocServOff(false);   
                            mapController.animateTo(gp);                                

                        }else{
                            app.setLocServOff(true);
                        }

                    //Toast.makeText(getApplicationContext(),"wowoowowowoowoowowow",Toast.LENGTH_LONG).show();                      
                    }                                  
                });

            }                
        }); 
```

我还使用如下代码来获取纬度和经度并且它可以工作，但是因为当前位置有时会与返回的纬度和经度不同，因为例如我无法获得 gps 信号但是返回旧值。我添加了检查以查看纬度/经度数据是否超过 2 分钟，但我仍然无法将最新的经度和经度与 myOverlay.getMyLocation 返回的经度匹配。

```
 LocationManager locMgr = (LocationManager)appcontext.getSystemService(Context.LOCATION_SERVICE);
    MyLocationListener locLstnr = new MyLocationListener();

    //fetch current location for current location 
    locMgr.requestSingleUpdate(LocationManager.GPS_PROVIDER, locLstnr, appcontext.getMainLooper()); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T01:24:33.590

下面你可以找到一些关于如何在 UI 线程中获取当前位置的示例，但首先是一些背景信息。

`GPS`在请求新位置后，可能需要一些时间（15 秒到 1 分钟）才能获得第一个修复。这就是您第一次尝试获取它`myOverlay`失败的原因，并且只有在第一次修复之后您才能获得价值。

在此*停电*`getLastKnownLocation()`期间，如果您赶时间，您可以使用它来获取最后一个众所周知的 GPS 位置。如果不可用，则返回`null`

编码：

**最后已知位置**

```
LocationManager locMgr=(LocationManager)context.getSystemService(Context.LOCATION_SERVICE);
Location loc = locMgr.getLastKnownLocation(LocationManager.GPS_PROVIDER);
if(loc != null){
    //we have a valid location. Check location date
} 
```

**请求单一位置更新**

```
LocationManager locMgr=(LocationManager)context.getSystemService(Context.LOCATION_SERVICE);
locMgr.requestSingleUpdate(LocationManager.GPS_PROVIDER, locationListener, appcontext.getMainLooper); 
```

**请求持续位置更新**

```
LocationManager locMgr = (LocationManager)context.getSystemService(Context.LOCATION_SERVICE);
//use 0 for minDistance and minDistance between updates if you need the maximum update frequency.
locMgr.requestLocationUpdates(LocationManager.GPS_PROVIDER, minDistance, minTime, locationListener); 
```

**用于单次和连续位置更新的位置监听器**

这是最后一段代码，也是您获取上面请求的新位置的地方。

当 GPS 检索到与您上面定义的请求条件匹配的新位置时，会立即调用此侦听器，除非您的设备正忙于做其他无法中断的事情（即回调在暂停线程上或锁定） .

从内部`onLocationChanged()`您可以根据需要设置任何类级别。如果您从 UI 线程注册了侦听器，那么它将在 UI 上运行。

```
LocationListener locationListener = new LocationListener() {
    public void onLocationChanged(Location fix) {
        fix.setTime(fix.getTime() + timeZoneOffset); //Add Timezone offset if needed
        //here you have a fresh new location in fix...
        //You can set the value of any class level field from here
    }

    public void onProviderDisabled(String provider) {
    }

    public void onProviderEnabled(String provider) {
    }

    public void onStatusChanged(String provider, int status, Bundle extras) {
    }
}; 
```

问候。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T17:13:02.307

在寻找设备的位置时，您必须考虑的一些最重要的点是：

1.  不能保证在足够的时间内收到卫星 GPS 定位。例如，设备在建筑物内/不在开阔的天空下。
2.  确保卫星 GPS 监听器不会长时间保持活动状态。让听者保持开启状态将意味着 GPS 收音机一直处于开启状态，这使其成为电池消耗最大的原因。

在下面的代码示例中，LinkedBlockingQueue 中的 poll 方法直到指定的时间间隔结束或 Location 排队时才会返回。

使用类似下面的内容来获取当前位置：

```
 Location getCurrentLocation() {
    long startmillis = 0;
    LinkedBlockingQueue<Location> mQueue = new LinkedBlockingQueue<Location>();
            try{

                long millisSinceLastCollection = System.currentTimeMillis() - startmillis; 

                startmillis = System.currentTimeMillis();
                mQueue.clear();

    // Register for Satellite GPS listener as well as Network GPS listener.
                registerGPSListeners();

                // Wait for a maximum of one minutes for a fix
                Location firstfix = mQueue.poll(1, TimeUnit.MINUTES);

                if(firstfix != null && firstfix.getProvider().equals(LocationManager.GPS_PROVIDER)) {
                    return firstfix;
                }

                long elapsedmillis = System.currentTimeMillis() - startmillis;
                long remainingmillis = ONE_MINUTE_IN_MS - elapsedmillis; 
                if (remainingmillis <= 0){
                    return firstfix;
                }

                Location secondfix = mQueue.poll(remainingmillis, TimeUnit.MILLISECONDS);

                if(secondfix != null && secondfix.getProvider().equals(LocationManager.GPS_PROVIDER)) {
                    return secondfix;
                }

                /*
                 * In case we receive fix only from Network provider, return it.
                 */
                if(firstfix != null && firstfix.getProvider().equals(LocationManager.NETWORK_PROVIDER)) {
                    return firstfix;
                }

            } catch(Exception e){
                Logger.e("GPS: Exception while listening for the current location", e);
            } finally {
                Logger.i("GPS: Unsubscribing from any existing GPS listeners");
                unregisterGPSListeners();

            }
    }

// GPS issue fix edit.
    private void registerGPSListeners() {

        LocationManager locationManager = (LocationManager)AirWatchApp.getAppContext().getSystemService(Context.LOCATION_SERVICE);

        if(locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER))
            locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 30000, 100, oneShotNetworkGPSLocationListener, MyAppApp.getAppContext().getMainLooper());

        if(locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)){
            locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 30000, 100, oneShotSatelliteGPSLocationListener, AirWatchApp.getAppContext().getMainLooper());
        }
    }

    private void unregisterGPSListeners(){

        final LocationManager locationManager = (LocationManager)MyApp.getAppContext().getSystemService(Context.LOCATION_SERVICE);
        locationManager.removeUpdates(oneShotSatelliteGPSLocationListener);
        locationManager.removeUpdates(oneShotNetworkGPSLocationListener);
    }

//One shot location listener
    protected LocationListener oneShotSatelliteGPSLocationListener = new LocationListener() {
        public void onLocationChanged(Location location) {

            try {
                mQueue.put(location);
            } catch (InterruptedException e) {
                Logger.e("Exception in putting new Location to the queue", e);
            }

            Logger.d("GPS: Location received from Satellite GPS Provider");
            unregisterGPSListeners();
        }

        public void onProviderDisabled(String provider) {}
        public void onStatusChanged(String provider, int status, Bundle extras) {}
        public void onProviderEnabled(String provider) {}
    };

    //One shot location listener
    protected LocationListener oneShotNetworkGPSLocationListener = new LocationListener() {
        public void onLocationChanged(Location location) {

            try {
                mQueue.put(location);
            } catch (InterruptedException e) {
                Logger.e("Exception in putting new Location to the queue", e);
            }

            Logger.d("GPS: Location received from Network GPS Provider");
            // Stop Listener for one-shot location fix from Network GPS provider.
            final LocationManager locationManager = (LocationManager)AirWatchApp.getAppContext().getSystemService(Context.LOCATION_SERVICE);
            locationManager.removeUpdates(oneShotNetworkGPSLocationListener);
            Logger.d("GPS: Unsubscribed the network location listener.");
        }

        public void onProviderDisabled(String provider) {}
        public void onStatusChanged(String provider, int status, Bundle extras) {}
        public void onProviderEnabled(String provider) {}
    }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-28T13:21:33.510

```
handler.post(new Runnable() {                                   
            @Override public void run() {

                    GeoPoint gp = myOverlay.getMyLocation();    
                    if(gp!=null){
                        app.setMyLat(Helper.latLon1E6Calc(gp.getLatitudeE6()));
                        app.setMyLon(Helper.latLon1E6Calc(gp.getLongitudeE6()));
                        app.setLocServOff(false);

                        // HERE WE HAVE VALID gp VALUE AND WE NEED TO SHARE IT

                        mapController.animateTo(gp);                                

                    }else{
                        app.setLocServOff(true);
                    }
                }                                  
            }); 
```

我认为您的 app.set/get|MyLat/Lon 无法正常工作，因为您从不同的线程调用它们。修复它同步设置和获取 MyLat/Long 的方法。（创建对象进行同步并在其上同步）

或者，如果您喜欢处理程序的方式，这应该可以：

```
final Handler handler = new Handler(); // BE SURE TO RUN THIS LINE ON UI THREAD
...   
myOverlay.runOnFirstFix(new Runnable() {                     
    @Override public void run() {

        // THIS PART WORKS AS BEFORE
        final GeoPoint gp = myOverlay.getMyLocation();
        mapController.animateTo(gp);                        
        ...
        // AND THIS RUNNABLE TO UPDATE MyLat/MyLong FROM UI THREAD
        handler.post(new Runnable() {                                   
            @Override public void run() {
               app.setMyLat(Helper.latLon1E6Calc(gp.getLatitudeE6()));
               app.setMyLon(Helper.latLon1E6Calc(gp.getLongitudeE6()));
            });

        }                
    }); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-28T13:52:10.583

Android 修改用户界面并处理来自单个用户界面线程（主线程）的输入事件。

如果程序员不使用任何并发构造，Android 应用程序的所有代码都在此线程中运行。

`GPS`是确定用户位置的最佳方法，但是过多地 ping 全球定位卫星会很快耗尽移动设备的电池，需要很长时间才能获取用户位置，而且这种方法在室内并不总是有效。`You are not getting your location in first attempt that's why you are getting null over there.`

Android`Network Location Provider`根据手机信号塔和 Wi-Fi 信号计算出用户的位置。它不仅比 GPS 使用更少的电池电量，而且速度更快，无论用户在室外还是室内，它都可以工作。

我 在该节目下方提供我的**工作代码**`progress dialog`，听用户的位置并在*谷歌地图*`location overlay`上获取位置显示用户后

 *我假设您在`Menifest file`
`<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>`
`<uses-permission android:name="android.permission.INTERNET"/>`
**我的主要课程中具有以下权限**

```
public class MyLocationOnMap extends MapActivity {

private MapView mapView;
private MyLocationOverlay itemizedoverlay;
private LocationManager locationManager;
private String provider;
private MyLocationListener locationListener;
MyBroadCastreceiver myBroadCastreceiver;
/**
 * My current Location <i>longitude</i>.
 */
static int longitude;
/**
 * My current Location <i>latitude</i>.
 */
static int latitude;
/**
 *My progress indicator. 
 */
ProgressDialog loadingDialog;

public static final String INTENT_FILTER_TAG="my location broadcast receiver";

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.my_location_on_map);

    loadingDialog = new ProgressDialog(this);
    loadingDialog.setTitle("Hot Spots!");
    loadingDialog.setMessage("Please wait ...");
    loadingDialog.setIndeterminate(true);
    loadingDialog.setCancelable(false);

    loadingDialog.show();

 // Configure the Map
    mapView = (MapView) findViewById(R.id.mapview);
    mapView.setBuiltInZoomControls(true);
    mapView.setStreetView(true);

    /**
     * Get your location manager and Location Listener...
     */
    locationManager = (LocationManager) getSystemService(Context.LOCATION_SERVICE);
    locationListener=new MyLocationListener();

    myBroadCastreceiver = new MyBroadCastreceiver();

        if (locationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
            Log.i("GPS_Enabled", "GPS enable! listening for gps location.");
            locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 10000, 0, locationListener);
            registerReceiver(myBroadCastreceiver, new IntentFilter(INTENT_FILTER_TAG));
        } else if (locationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER)) {
            Log.i("Network_Enabled", "Network enable! listening for Network location.");
            locationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 10000, 0, locationListener);
            registerReceiver(myBroadCastreceiver, new IntentFilter(INTENT_FILTER_TAG));
        } else {
            loadingDialog.dismiss();
            Toast.makeText(this, "No Provider enable!", Toast.LENGTH_LONG).show();
        }

}//End of onCreate......

 /**
 * My BroadCast Receiver, that is called when i get the location of user.
 * @author Rupesh Yadav.
 *
 */
class MyBroadCastreceiver extends BroadcastReceiver{

    @Override
    public void onReceive(Context context, Intent intent) {
        //Remove location update when you get user`s location very first time.
        locationManager.removeUpdates(locationListener);
        //Remove the broadcast listener that update my location on map.
        unregisterReceiver(myBroadCastreceiver);

        GeoPoint point = new GeoPoint(latitude, longitude);
        mapView.getController().animateTo(point);

        List<Overlay> mapOverlays = mapView.getOverlays();
        Drawable drawable = MyLocationOnMap.this.getResources().getDrawable(R.drawable.hs_mapoverlay);
        itemizedoverlay = new MyLocationOverlay(drawable, MyLocationOnMap.this);

        OverlayItem overlayitem = new OverlayItem(point, "Hello!", "My Current Location :)");

        itemizedoverlay.addOverlay(overlayitem);
        mapOverlays.add(itemizedoverlay);

        loadingDialog.dismiss();

    }

}

/**
 * My Location listener...
 */
class MyLocationListener implements LocationListener{
    @Override
    public void onLocationChanged(Location location) {
        latitude=(int) ((location.getLatitude())*1E6);
        longitude=(int) ((location.getLongitude())*1E6);

        //Send broadcast to update my location.
        Intent sendLocationIntent=new Intent(INTENT_FILTER_TAG);
        sendBroadcast(sendLocationIntent);
    }
    @Override
    public void onProviderDisabled(String provider) {
        // TODO Auto-generated method stub
    }
    @Override
    public void onProviderEnabled(String provider) {
        // TODO Auto-generated method stub
    }
    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
        // TODO Auto-generated method stub
    }

}

@Override
protected boolean isRouteDisplayed() {
    // TODO Auto-generated method stub
    return false;
}

} 
```

**MyLocationOverlay 类**

```
public class MyLocationOverlay extends ItemizedOverlay<OverlayItem> {

Context mContext;
private ArrayList<OverlayItem> hsOverlays = new ArrayList<OverlayItem>();

public MyLocationOverlay(Drawable defaultMarker) {
    super(boundCenterBottom(defaultMarker));
    // TODO Auto-generated constructor stub
}

public MyLocationOverlay(Drawable defaultMarker, Context context) {
    super(boundCenterBottom(defaultMarker));
    mContext = context;
}

@Override
protected OverlayItem createItem(int i) {
    // TODO Auto-generated method stub
    return hsOverlays.get(i);
}

@Override
public int size() {
    // TODO Auto-generated method stub
    return hsOverlays.size();
}

/**
 * add new OverlayItem objects to map OverlayItem ArrayList.
 * 
 * @param overlay
 */
public void addOverlay(OverlayItem overlay) {
    hsOverlays.add(overlay);
    populate();
}

/**
 * Called when user clicks on map overlay.
 */
@Override
protected boolean onTap(int index) {
    // TODO Auto-generated method stub
    // return super.onTap(index);
    OverlayItem item = hsOverlays.get(index);
    AlertDialog.Builder dialog = new AlertDialog.Builder(mContext);
    dialog.setTitle(item.getTitle());
    dialog.setMessage(item.getSnippet());
    dialog.show();
    return true;
} 
```

您可以根据需要修改`Location Listener`& 。`Broadcasr Receiver`我希望这能解决你的问题。
最好的祝福！

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-28T15:36:08.857

我已经使用这个类来检测我的纬度和经度：希望这对你也有用。

使用示例： **GPSUtility.getInstance(Context).getLatitude(); GPSUtility.getInstance(CamPhotoModeAct.this).getLongitude()**

```
public class GPSUtility {
    public static final String TAG = "GPSUtility";

    private Context ctx;

    Timer timer1;
    LocationManager lm;
    LocationResult locationResult;
    boolean gps_enabled=false;
    boolean network_enabled=false;

    private double latitude;
    private double longitude;

    private static SharedPreferences SHARED_PREF;
    private static SharedPreferences.Editor EDITOR_SHARED_PREF;

    private static GPSUtility this_instance;

    public GPSUtility(Context ctx){
        this.ctx = ctx;
        SHARED_PREF = ctx.getSharedPreferences(ConstantsG.SHARED_PREF_FILE, Context.MODE_PRIVATE);
        EDITOR_SHARED_PREF = SHARED_PREF.edit();
        this.getLocation(innerLocationResult);
    }

    public static GPSUtility getInstance(Context ctx){
        if(this_instance == null)
            this_instance = new GPSUtility(ctx);
        return this_instance;
    }

    public static void updateLocation(Context ctx){
        GPSUtility.getInstance(ctx);//this writes the latitude and longitude in sharable preference file
    }

    public double getLatitude(){
        String latitudeStr = SHARED_PREF.getString(ConstantsG.KEY_LATITUDE,null);
        if(latitudeStr == null){
            latitude = 0.0;
        }
        else{
            latitude = Double.parseDouble(latitudeStr);
        }
        return latitude;
    }

    public double getLongitude(){
        String longitudeStr = SHARED_PREF.getString(ConstantsG.KEY_LONGITUDE,null);
        if(longitudeStr == null){
            longitude = 0.0;
        }
        else{
            longitude = Double.parseDouble(longitudeStr);
        }
        return longitude;
    }

    private void updateWithNewLocation(Location location) {

        if (location != null) {
            latitude = location.getLatitude();
            EDITOR_SHARED_PREF.putString(ConstantsG.KEY_LATITUDE, String.valueOf(latitude) );

            longitude = location.getLongitude();
            EDITOR_SHARED_PREF.putString(ConstantsG.KEY_LONGITUDE, String.valueOf(longitude));

            EDITOR_SHARED_PREF.commit();
        }
    }

    public boolean getLocation(LocationResult result)
    {
        //I use LocationResult callback class to pass location value from GPSUtility to user code.
        locationResult=result;
        if(lm==null)
            lm = (LocationManager) this.ctx.getSystemService(Context.LOCATION_SERVICE);

        //exceptions will be thrown if provider is not permitted.
        try {
            gps_enabled = lm.isProviderEnabled(LocationManager.GPS_PROVIDER);
        } catch (Exception ex) {
            Log.e(TAG, "Exception error: " + ex.getLocalizedMessage(), ex);
        }
        try {
            network_enabled = lm
                    .isProviderEnabled(LocationManager.NETWORK_PROVIDER);
        } catch (Exception ex) {
            Log.e(TAG, "Exception error: " + ex.getLocalizedMessage(), ex);
        }

        //Toast.makeText(context, gps_enabled+" "+network_enabled,     Toast.LENGTH_LONG).show();

        //don't start listeners if no provider is enabled
        if(!gps_enabled && !network_enabled){
            Toast.makeText(this.ctx, "You should enable gps or be connected to network.", Toast.LENGTH_LONG).show();
            return false;
        }

        if(gps_enabled)
            lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, locationListenerGps);
        if(network_enabled)
            lm.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, locationListenerNetwork);
        timer1=new Timer();

        timer1.schedule(new GetLastLocation(), 10000);
        return true;
    }

    LocationListener locationListenerGps = new LocationListener() {
        public void onLocationChanged(Location location) {
            timer1.cancel();
            locationResult.gotLocation(location);
            lm.removeUpdates(this);
            lm.removeUpdates(locationListenerNetwork);
        }
        public void onProviderDisabled(String provider) {}
        public void onProviderEnabled(String provider) {}
        public void onStatusChanged(String provider, int status, Bundle extras) {}
    };

    LocationListener locationListenerNetwork = new LocationListener() {
        public void onLocationChanged(Location location) {
            timer1.cancel();
            locationResult.gotLocation(location);
            lm.removeUpdates(this);
            lm.removeUpdates(locationListenerGps);
        }
        public void onProviderDisabled(String provider) {}
        public void onProviderEnabled(String provider) {}
        public void onStatusChanged(String provider, int status, Bundle extras) {}
    };

    class GetLastLocation extends TimerTask {
        @Override
        public void run() {
            //Context context = getClass().getgetApplicationContext();
             Location net_loc=null, gps_loc=null;
             if(gps_enabled)
                 gps_loc=lm.getLastKnownLocation(LocationManager.GPS_PROVIDER);
             if(network_enabled)
                 net_loc=lm.getLastKnownLocation(LocationManager.NETWORK_PROVIDER);

             //if there are both values use the latest one
             if(gps_loc!=null && net_loc!=null){
                 if(gps_loc.getTime()>net_loc.getTime())
                     locationResult.gotLocation(gps_loc);
                 else
                     locationResult.gotLocation(net_loc);
                 return;
             }

             if(gps_loc!=null){
                 locationResult.gotLocation(gps_loc);
                 return;
             }
             if(net_loc!=null){
                 locationResult.gotLocation(net_loc);
                 return;
             }
             locationResult.gotLocation(null);
        }
    }

    public static abstract class LocationResult{
        public abstract void gotLocation(Location location);
    }

    LocationResult innerLocationResult = new LocationResult() {
        @Override
        public void gotLocation(Location location) {
            updateWithNewLocation(location);
        }
    };
} 
```*

# xml - 对“混合”元素设置限制

> ID：13956661
> 
> 赞同：0
> 
> 时间：2012-12-19T16:21:29.653
> 
> 标签：xml, xsd, libxml2

您好，我希望能够定义如下内容：

```
<Infos>
      <Mileage>9987
          <UseIn>POS_DISPLAY</UseIn>
          <UseIn>READER_DISPLAY</UseIn>
      </Mileage>
</Infos> 
```

`Mileage`是混合型。`9987`是它的值，`UseIn`是一些属性。问题是我找不到定义`Mileage`内容限制的方法。

有什么方法可以定义上面的结构，而不回退到：

```
<Infos>
      <Mileage>
          <MileageValue>9987</MileageValue>
          <UseIn>POS_DISPLAY</UseIn>
          <UseIn>READER_DISPLAY</UseIn>
      </Mileage>
</Infos> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T20:03:14.530

由于历史原因，我不想描述，具有混合内容的 XSD 类型允许字符数据出现在任何位置。定义一个允许你展示的结构的类型很容易，但是定义一个允许你展示的同时拒绝变体的类型并不容易

```
<Mileage>
    <UseIn>POS_DISPLAY</UseIn>
    9987
    <UseIn>READER_DISPLAY</UseIn>
</Mileage> 
```

或者

```
<Mileage>99
    <UseIn>POS_DISPLAY</UseIn>
    8
    <UseIn>READER_DISPLAY</UseIn>
    7
</Mileage> 
```

我的建议，fwiw，是回退到第二种设计，这将更好地与大多数 XML 基础设施一起工作。

# php - 无法使用 PHPMailer 发送带有正确字符的电子邮件

> ID：13956663
> 
> 赞同：16
> 
> 时间：2012-12-19T16:21:34.667
> 
> 标签：php, html, email, phpmailer

我正在尝试使用 PHPmailer 类发送电子邮件，但我发送的 html 是空的，或者字符未配置，并且没有重音符号。

```
<?php
header("Content-Type: text/html; charset=ISO-8859-1", true);
require_once('class.phpmailer.php');
include "config.php";

$nome = trim($_POST['nome']);
$email  = trim($_POST['Imail']);
$usuario = trim($_POST['usuario']);
$senha = trim($_POST['senha']);
$mail = new PHPMailer(true); // the true param means it will throw exceptions on errors, which we need to catch

$mail->IsSMTP(); // telling the class to use SMTP

try {
  $mail->AddAddress($email, $nome);
  $mail->SetFrom('editora@conectfarma.net', 'Conectfarma');
  $mail->AddReplyTo('editora@conectfarma.net', 'Conectarma');
  $subject = 'Guia Rápido de Interações Medicamentosas';
  $sendsubject= "=?utf-8?b?".base64_encode($subject)."?=";
  $mail->Subject = $sendsubject;
 $mensagem  = "<!DOCTYPE html>
<html>
<body>
Bem vindo ao Guia Rápido de Interações Medicamentosas em Neurologia e Psiquiatria
Seu Login e Senha para acesso ao aplicativo são:\n
Login:"  .$nome. "\n, Senha : " .$senha.
"\nAtenciosamente,
Conectfarma Publicações Científicas
</body>
</html>";

  $mail->Body = $mensagem;
  //$mail->CreateBody($mensagem);
  $mail->IsHTML(true);
  $mail->Send();
  //$mail->CharSet="UTF-8";
  echo "<!DOCTYPE html>
<html>
<head>
<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'>
<title>Confirmação</title>
</head>
<body>
Não vai maçã.
</body>
</html>
";
} catch (phpmailerException $e) {
  echo $e->errorMessage(); //Pretty error messages from PHPMailer
} catch (Exception $e) {
  echo $e->getMessage(); //Boring error messages from anything else!
}
        }
    }
}

?> 
```

我跳过了 SMTP 配置，因为它工作正常。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-12-19T16:53:20.577

仔细检查您的 PHP 代码也是 UTF-8 编码。

取消注释该行`//$mail->CharSet="UTF-8";`并将其理想地移动到 之后`$mail = new PHPMailer(true);`，因此代码如下所示：

```
// ...
$mail = new PHPMailer(true);
$mail->CharSet = "UTF-8";
// ... 
```

在您的代码中，它是在`$mail->Send();`因此字符集设置没有计算在内之后调用的...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-11-10T09:38:22.550

是的，就在“new PHPMailer(true);”之后。我遇到了同样的问题：

```
$mail = new PHPMailer(true);
try {
    $mail->setLanguage('fr', 'inc'.DIRECTORY_SEPARATOR.'PHPMailer'…);
    $mail->CharSet = 'UTF-8'; 
```

并更改为：

```
$mail = new PHPMailer(true);
$mail->CharSet = 'UTF-8';
try {
    $mail->setLanguage('fr', 'inc'.DIRECTORY_SEPARATOR.'PHPMailer'…); 
```

解决了重音问题。

# asp.net - 从 ASPX 站点使用 AJAX 检索 XML 数据

> ID：13956665
> 
> 赞同：3
> 
> 时间：2012-12-19T16:21:34.550
> 
> 标签：asp.net, xml, ajax, jsonp

我想使用 AJAX 检索和处理一些 XML 跨域数据。这是我的代码：

```
$(document).ready(function(){
   $.ajax({
      url: "http://www.synthesiagame.com/scoreboardFeed.aspx?p=c71067ca61fb1c8f3dc9e56dd58cd028_ee7c7e67ec3bc17a08b648fc77802697_f334fca735419b6074f78d82fcc9904d",
      type: "POST",
      dataType: "jsonp xml",
      success: function(data) {
         alert($(data));
         $(data).find('score').each(function(){
            $("#testing").append($(this).attr("points") + "<br />");
         });
      }, error: function(jxhr, status, err) {
            alert("Ajax error: status = " + status + ", err = " + err);
         }
   });
}); 
```

这显示了 alert() 消息，但它不处理 XML 数据。但是，如果我将带有 XML 数据的文件作为 url 放在我的服务器上，它就可以完美地工作。

我已经尝试了两天来完成这项工作。我一定已经阅读了这个网站上所有关于类似主题的问题，但没有答案能解决我的问题。我开始认为他们在回答请求时呈现数据的方式可能存在一些问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:26:24.737

这是行不通的。返回的文件未包装在函数中，因此无法调用 JSONP 回调。没有包装功能或“填充”。

JSONP 仅在返回的数据包含在函数中时才有效。然后 JQuery 将评估该函数并为您提供结果对象。

获得跨域 XML 的唯一方法是使用某种代理将页面返回到您自己的域中。之所以可以使用自己的xml，是因为它在你的域中，所以没有冲突。

[这是一个关于如何使用 php 代理来执行此操作的好教程。](http://benalman.com/projects/php-simple-proxy/)如果您不能使用 php，您将不得不寻找另一种方法在您的域中获取该文件。

# javascript - 使用来自 json 的 optgroup 创建 html 选择

> ID：13956667
> 
> 赞同：10
> 
> 时间：2012-12-19T16:21:39.653
> 
> 标签：javascript, jquery, json

我有一个看起来像的 JSON 字符串（来自 php json_encode）；

```
var json = [{"Foo":[{"id":1,"name":"aaa"},{"id":2,"name":"bbb"}]},{"Bar":[{"id":3,"name":"ccc"},{"id":4,"name":"ddd"}]}]; 
```

我希望能够在表单中使用 Javascript/jQuery 创建一个 html 选择；

```
<select>
    <optgroup label="Foo">
        <option value="1">aaa</option>
        <option value="2">bbb</option>
    </optgroup>
    <optgroup label="Bar">
        <option value="3">ccc</option>
        <option value="4">ddd</option>
    </optgroup>
</select> 
```

在处理 json 方面，我已经走了[这么远](http://jsfiddle.net/DVKMK/)（我知道不远），但是 jsFiddle 无法运行它并冻结了我的浏览器。

```
var json = [{"Foo":[{"id":1,"name":"aaa"},{"id":2,"name":"bbb"}]},{"Bar":[{"id":3,"name":"ccc"},{"id":4,"name":"ddd"}]}];

$.each(json, function(i,group) {
    console.log(i);
    $.each(group, function(j, option) {
        console.log(j, option);
        $.each(option, function(k, item) {
            console.log(k, item);
        });
    });
});​ 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T16:48:44.767

这应该运行得很好。

```
var $select = $("<select>");
$select.appendTo("#somewhere");

$.each(json, function(i, optgroups) {
    $.each(optgroups, function(groupName, options) {
        var $optgroup = $("<optgroup>", {label: groupName});
        $optgroup.appendTo($select);

        $.each(options, function(j, option) {
            var $option = $("<option>", {text: option.name, value: option.id});
            $option.appendTo($optgroup);
        });
    });
}); 
```

# silverlight - Windows Phone 8 和 7.1 的 ScheduledTaskAgent 之间的差异

> ID：13956670
> 
> 赞同：1
> 
> 时间：2012-12-19T16:21:49.043
> 
> 标签：silverlight, visual-studio-2012, windows-phone-7.1, scheduled-tasks, windows-phone-8

我有一个大问题。

我为 Windows Phone 7.1+ 编写了一个应用程序，它也在 Windows Phone Store 上发布：这个应用程序适用于 Windows Phone 7.1 和 Windows Phone 8，并且在应用程序提交过程中没有问题（谁还声明我的应用程序完全兼容自 Windows Phone 7.5 以来的任何操作系统）。

问题仅与我的有关`Scheduled Agent`，它在 Windows Phone Mango (7.1) 上完美运行，但在 Windows Phone 8 上根本没有触发（我还在真实设备上测试了我的应用程序，两个操作系统）。

当我升级到**Visual Studio 2012 (Express for Windows Phone)**时，我注意到可以添加两种不同类型的`ScheduledTaskAgent`项目：一种用于 Windows Phone 7.5，另一种用于 Windows Phone 8（显然在 Visual 中并非如此Studio 2010 ...我使用了唯一可用的=第一个）！

1.  您认为这可能是计划代理在 WP8 中不起作用的原因吗？
2.  这两种项目类型有什么区别？
3.  如何管理（我的意思是代码）该类型的两个项目？可能吗？
4.  如何选择我必须注册的任务（见下面的代码）？
5.  两个项目的提交过程是否会失败`ScheduledTaskAgent`（我认为是这样）？

这是代码的关键部分，当我在启动时注册我的任务时：

```
PeriodicTask newTask = new PeriodicTask("MyTaskID");

newTask.Description = "my Description";

ScheduledActionService.Add(newTask);

#if DEBUG
Microsoft.Phone.Scheduler.ScheduledActionService.LaunchForTest("MyTaskID", TimeSpan.FromSeconds(5));
#endif 
```

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T18:45:56.237

两种项目类型之间的唯一区别是 (1) Windows Phone 8 的目标是 Windows Phone 8 而不是 7.1 和 (2) 它引用 Windows Phone 8 SDK 而不是 Windows Phone 7 dll。

我有一个应用程序，其中有两个项目（7.1 和 8.0）。我还有两个后台代理项目（7.1 和 8.0），我使用链接文件在它们之间共享代码。我从 8.0 项目中引用了 8.0 代理，从 7.1 项目中引用了 7.1 代理。我[将此示例](http://www.developer.nokia.com/Resources/Library/Lumia/#!co-development-and-porting-guide.html)用作拥有两个代码版本的最佳实践。

您不想引用两个代理，因为这不起作用。

如果您删除#if DEBUG，您的代理会在您调试时被调用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T20:01:32.297

首先确保您在应用清单文件中获得了正确的引用。

```
<ExtendedTask Name="BackgroundTask">
    <BackgroundServiceAgent Specifier="ScheduledTaskAgent" Name="MyApp.Agent" Source="MyApp.Agent" Type="MyApp.Agent.ScheduledAgent" />
</ExtendedTask> 
```

其次，必须在主应用程序项目中引用代理库。
第三，确保您没有超过允许的运行时间或内存分配。在 WP8 中，后台代理的上限提高到 11MB。此外，注册后台任务的应用程序也有限制，因此您的任务可能没有空闲插槽用于 bg 代理。

# unity3d - 在 Unity 中创建动画的最佳方法？

> ID：13956673
> 
> 赞同：0
> 
> 时间：2012-12-19T16:21:54.707
> 
> 标签：unity3d

在我的游戏中，我需要创建 2 种 2D 动画：

*   静态 2D 动画：这就像一个短视频，在游戏屏幕的一部分播放
*   动态 2D 动画：这有一些从服务器返回的数据（数字，文本）并将其包含到动画中。

你知道做上述事情的最佳方法是什么吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T05:28:52.710

有几种方法可以在 Unity3D 中为 2D 内容制作动画，我能想到：

*   手动通过代码和 UV 缩放和偏移
*   使用像[Strumpy Shader这样的着色器编辑器](http://forum.unity3d.com/threads/56180-Strumpy-Shader-Editor-Now-Open-Source)
*   使用像[ex2d这样的插件](http://www.ex-dev.com/ex2d/)

我建议您在 Unity3D 编辑器中搜索资产商店，看看那里有哪些框架/附加组件 :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-15T23:32:10.230

You can also create animations of arbitrary complexity in Maya, Max or any program that exports animated FBX files and import them into unity as data

# android - 安卓 GCM 错误。客户端注册时服务器返回未注册

> ID：13956677
> 
> 赞同：12
> 
> 时间：2012-12-19T16:22:01.977
> 
> 标签：android, cloud, messaging

我按照[http://developer.android.com/google/gcm/gs.html](http://developer.android.com/google/gcm/gs.html)提供的演示，得到了一个试用应用程序，GCMTrial 可以正常工作。

但是，我尝试在现有应用程序上执行相同的步骤，但它不起作用。所以我做了一个全新的项目。但即便如此，按照完全相同的步骤，我还是无法让 GCM 成功发送消息。所以我尝试将 GCMTrial 重命名为所需的名称，但这也不起作用。

我通过主要活动注册 GCM 并获得以下日志：

```
12-19 21:30:13.102: V/GCMRegistrar(15889): Registering receiver
12-19 21:30:13.112: D/GCMBaseIntentService(15889): handleRegistration: registrationId =         XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX, error = null, unregistered = null
12-19 21:30:13.112: D/GCMRegistrar(15889): resetting backoff for com.XXX.XXX
12-19 21:30:13.117: V/GCMRegistrar(15889): Saving regId on app version 1 
```

但是当我尝试发送 GCM 消息时，它返回以下错误

```
[ errorCode=NotRegistered ] 
```

客户代码：

```
public class MainActivity extends Activity {
TextView tve;
String TAG = "GCMTrial";
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    GCMRegistrar.checkDevice(this);
    GCMRegistrar.checkManifest(this);
    final String regId = GCMRegistrar.getRegistrationId(this);
    if (regId.equals("")) {
        GCMRegistrar.register(this, "XXXXXX");
        Log.v(TAG, "Reg");
    } else {
        Log.v(TAG, "Already registered");
    }
}

GCMIntentService : 
public class GCMIntentService extends GCMBaseIntentService {
@Override
protected void onError(Context arg0, String arg1) {
    // TODO Auto-generated method stub
}
@Override
protected void onMessage(Context arg0, Intent arg1) {
    // TODO Auto-generated method stub
    Log.d("GCM", "RECIEVED A MESSAGE");
    // Get the data from intent and send to notificaion bar
}
@Override
protected void onRegistered(Context arg0, String arg1) {
    // TODO Auto-generated method stub
}
@Override
protected void onUnregistered(Context arg0, String arg1) {
    // TODO Auto-generated method stub
} 
```

}

显现 ：

服务器代码：

```
System.out.println("Sending GCM");
    String key = "XXX"; //Server API key taken from the site
    clientID = "XXXXXXXXX"; // copied from the logs
    Sender sender = new Sender(key);
    Message message = new Message.Builder().build();
    Result result = sender.send(message, clientID, 1);
    System.out.println(result.toString()); 
```

它快把我逼疯了。它显示为在 android 手机中注册，甚至调用 GCMIntentService 类的 onRegistered 方法。但是当我尝试发送消息时，它标记一个“NotRegistered 错误”......我不知道是什么我做错了..请帮帮我....

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-14T12:15:37.187

好吧，知道这是使用 adb 安装时的当前错误。

GCMRegistrar 不知道该设备在 GCM 服务器上未注册并且不注册。

你可以做的就是注册：

```
if (regId.equals("")) {
        GCMRegistrar.register(this, "XXXXXX");
        Log.v(TAG, "Reg");
    } else {
        //I SAY BULLSHIT !
        GCMRegistrar.register(this, "XXXXXX");
        Log.v(TAG, "Reg");
    } 
```

或者在客户端上卸载应用程序，然后从 Adb 运行新安装。

请记住，它在生产中发生的可能性很小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T17:19:40.050

你忘了在你的`GCMIntentService`

将以下内容添加到您的`GCMIntentService`

```
public GCMIntentService(){
        super(SENDER_ID);
    } 
```

SENDER_ID 是用于注册您的应用的 XXXXXXX。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-23T17:36:00.293

您可以尝试将上下文“this”替换为“getApplicationContext()”以使用应用程序上下文。这是我的示例代码：

```
private void registerGCM() {
    if (Build.VERSION.SDK_INT < Build.VERSION_CODES.ICE_CREAM_SANDWICH_MR1) {
        //prevent crash caused by no google account or not support for gcm
        try {
            GCMRegistrar.checkDevice(this);
        } catch (Exception e) {
            Log.i("test", "!!!cgm " + e.toString());
            return;
        }
    }

    final String regId = GCMRegistrar.getRegistrationId(this);
    if (TextUtils.isEmpty(regId)) {
        String gcmSenderId = PreferencesUtil.getStringPreference(PreferencesUtil.SETTING_GCM_SENDER_ID,
                "", getApplicationContext());
        GCMRegistrar.register(getApplicationContext(), gcmSenderId);
    }
    mGCMRegisted = true;
} 
```

# java - ListIterator 奇怪的添加到 ArrayList

> ID：13956680
> 
> 赞同：-6
> 
> 时间：2012-12-19T16:22:04.427
> 
> 标签：java, linked-list, listiterator

我有以下代码：

```
 ArrayList<String> words;
    words = new ArrayList<String>();
    words.add("is");
    words.add("us");
    ListIterator<String> it;
    it = words.listIterator();
    it.add("##");
    System.out.println(words);
    it.next();
    it.next();
    it.previous();
    it.set("##");
    System.out.println(words); 
```

我希望输出是`## us ##`，但是当我运行程序时它会返回`## is ##`。我希望这与向其`ListIterator`添加项目`ArrayList`而不是`ArrayList`向其自身添加项目有关。

为什么程序会以这种方式运行？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T16:29:09.660

您的问题不清楚，但我怀疑您可能缺少的要点是`ListIterator.add`在当前位置插入：

> 该元素被插入到 next() 将返回的下一个元素（如果有）之前，并且插入到 next() 将返回的下一个元素（如果有）之后。

并且：

> 新元素插入到隐式游标之前：对 next 的后续调用将不受影响

因此，在您对列表的初始调用后`it.add("##")`，包含`"##"`, `"is"` `"us"`。然后您接下来移动两次 - 第一次将光标移动到紧随其后`"is"`（返回）。第二个将光标移动到紧随其后`"us"`（返回）。然后调用再次`previous()`返回`"us"`，最后调用`set()`替换`"us"`为`"##"`：

> 将 next() 或 previous() 返回的最后一个元素替换为指定元素（可选操作）。

看起来它完全遵守了文档。不幸的是，不清楚这些步骤中的哪一个让您感到困惑，因为您在一个问题中混淆了这么多。

# python-3.x - 字符串索引超出范围错误 - TBRPG - python

> ID：13956682
> 
> 赞同：0
> 
> 时间：2012-12-19T16:22:05.577
> 
> 标签：python-3.x

好的，所以我正在创建一个 rpg 并且我继续让这个字符串错误超出范围

```
while playerturn1[0] != playerturn and playerturn1[1] != playerturn and playerturn[2]
!= playerturn:
IndexError: string index out of range 
```

[这是到目前为止的所有代码](http://snipt.org/yhXg2)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:25:19.293

我想你是想写

```
playerturn1[2] 
```

代替

```
playerturn[2] 
```

请务必使用清晰可辨的变量名称以避免此类错误。

# html - 如何在 iframe 之外创建自动弹出窗口

> ID：13956683
> 
> 赞同：0
> 
> 时间：2012-12-19T16:22:14.967
> 
> 标签：html

我的网站有一个聊天按钮，它应该创建一个自动邀请，在访问者在那里停留 60 秒后会在屏幕上滚动。我的问题是自动邀请被嵌入到聊天 iframe 中，并且没有显示在屏幕上。网站公司无法将我的代码添加到后端，所以我被 iframe 卡住了。如何更改代码以使自动邀请在屏幕上滚动而不是在 iframe 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:26:08.143

查看最顶部的[window.top或当前 iframe 的父级的](http://www.w3schools.com/jsref/prop_win_top.asp)[window.parent](http://www.w3schools.com/jsref/prop_win_parent.asp)。

这些允许您与当前 iframe“窗口”之外的那些“窗口”进行交互。

# regex - 正则表达式允许“单个 0”或“任何其他位数？

> ID：13956684
> 
> 赞同：3
> 
> 时间：2012-12-19T16:22:20.900
> 
> 标签：regex

我需要一个正则表达式来允许单个 0 或任何其他不以零开头的数字，因此：

> 允许使用 0 或 23443 或 984756，但不允许使用 0123。

我有以下仅允许 1 到 9

```
[1-9]\d 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T16:24:36.667

寻找一个单独的 0 或 1-9，后跟任何其他数字。

```
^(0|[1-9]\d*)$ 
```

如果要匹配较大字符串中的数字，请使用单词边界标记`\b`代替`^`and `$`：

```
\b(0|[1-9]\d*)\b 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T17:15:55.557

您无需将所有内容强制转换为单个正则表达式即可执行此操作。

如果您使用多个正则表达式会更清楚，每个正则表达式都进行特定检查。在 Perl 中，您会这样做，但您可以将其适应 C# 就好了。

```
if ( ($s eq '0') || (($s =~ /^\d+$/) && not ($s =~ /^0/)) ) 
```

您已明确说明意图是什么：

```
if ( (string is '0') OR ((string is all digits) AND (string does not start with '0')) ) 
```

请注意，第一次检查字符串是否`0`根本不使用正则表达式，因为您正在与单个值进行比较。

使用宿主语言的表达形式，而不是试图将逻辑塞进正则表达式。

# asp.net - ASP ChangePassword 控件 changepasswordfailuretext 不显示

> ID：13956688
> 
> 赞同：0
> 
> 时间：2012-12-19T16:22:45.250
> 
> 标签：asp.net, change-password

我正在使用 ASP ChangePassword 控件。当用户无法正确输入他们当前的密码时，我只会刷新所有字段，而不是 changepasswordfailuretext。谷歌了这个，发现你应该使用 ChangePasswordError 方法来捕捉这个。我在这个方法中设置了一个断点，当当前密码不正确时并没有在这里停止。

如何向我的用户显示他们输入的当前密码不正确？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T20:15:07.863

我自己遇到了这个问题并找到了答案。如果您使用 ChangePasswordTemplate 和 SuccessTemplate 自定义显示，您还需要添加一个 ID 为“FailureText”的控件。如果发生错误，此控件将填充您配置的消息：

```
<asp:Literal ID="FailureText" runat="server" /> 
```

[http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.changepassword.changepasswordtemplate.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.changepassword.changepasswordtemplate.aspx)

# javascript - 检测任何对话框何时打开jQuery

> ID：13956689
> 
> 赞同：5
> 
> 时间：2012-12-19T16:22:49.607
> 
> 标签：javascript, ajax, jquery, dialog

我有几个这样打开的对话框

```
 $("#dialog").load(URL);
 $("#dialog").dialog(
           attributes,
           here,
           close: function(e,u) {
                    cleanup
           } 
```

问题是我有数百个这样的对话框。我不想手动为每个创建一个 open: 属性。有什么方法可以监视整个文档以打开对话框，例如

```
 $(document).on("open","#dialog",function() {
     Do something
 }) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T16:25:53.957

来自 jQuery API：

```
$( ".selector" ).on( "dialogopen", function( event, ui ) {} ); 
```

所以你可以做你说的可能：

```
$("body").on("dialogopen",function(e,u){
    alert('dialog open!');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:35:51.500

如果您的对话框总是以相同的方式创建，为什么不使用这样的简单工厂方法：

```
var createUrlDialog = function(element, url, dialogOptions) {
    element.load(url);
    element.dialog($.extend({}, dialogOptions, {
        open: function(event, ui) {
            // do what you want
        }
    }));
} 
```

# sql - 通过基于 2 列中给出的范围进行分组来获取列的总和

> ID：13956692
> 
> 赞同：0
> 
> 时间：2012-12-19T16:22:53.900
> 
> 标签：sql, group-by, range

我有一个 sql 命令，可以在以下列中给出结果

```
start_date, end_date, count, weekday 
```

对于每个 start_date，我想获得从 start_date 到其工作日匹配的 end_date 的计数总和。

例如，如果我有一个带有`start_date = 2012 01 01`and`end_date = 2012 08 08`的行`weekday = Tuesday`，我想找到所有其他行的 start_date 落在该范围内并且它是星期二，然后找到计数的总和。我怎样才能做到这一点？

例如从这张表

```
Start       ||  End         ||Count||  Weekday
2012-01-01  ||  2012-12-12  ||  5  ||  Tuesday
2012-05-05  ||  2012-12-12  ||  7  ||  Tuesday
2012-06-06  ||  2012-10-10  ||  2  ||  Wednesday
2012-07-07  ||  2012-08-08  ||  8  ||  Wednesday
2012-09-09  ||  2012-10-10  ||  9  ||  Tuesday 
```

它应该返回

```
date        |  sum_count
2012-01-01  |  16    // count of 2012-05-05 + 2012-09-09 (Tuesdays only)
2012-05-05  |  9
2012-06-06  |  8
2012-07-07  |  0
2012-09-09  |  0 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:29:06.417

如果没有小提琴，[sqlfiddle.com](http://sqlfiddle.com)第一次尝试就很难正确获得。但是你想要做的是沿着这些方向做的事情：

```
 select count(*), * 
   from  
   (
    select *  
    from  
       (  
           select start_date,end_date,weekday  
           from  table  
           where start_date >= timestamp('2012 01 01')  
           and end_date <=  timestamp('2012 08 08')  
        )  
       where weekday = 'Tuesday'  
    ); 
```

目标是每次减少结果集，通过保留`weekday`单独的子查询，您可以潜在地避免代价高昂的连接或 2。

**问题**

> 嗯？不过我还是不明白。2012 08 08、2012 01 01 和 Tuesday 来自输入表，我需要处理多行。您是说单独处理每一行更有效吗？

您必须单独处理每一行，除非您知道在搜索日期时以某种方式避免全表扫描。这取决于比较解释计划，因为我们仍在等待您的小提琴，所以我们没有。
关键是最内部的查询将为您提供所需的日期范围，以及一周中的所有日期。然后针对更具体的 where 子句（在您的情况下是星期几）执行更有效（大多数情况下）。原因是数据库（大多数现代数据库都这样做）试图以一种可以尽快返回的方式对数据进行排序。

**额外更新**

作为一个真实的例子，我有一个表，其中包含近 10 亿个条目，我必须对其运行分析函数。我这样做的第一种方法是这样的：

```
select *   
from  
(  
        select *, row_number() over (partition by id order by seen desc) rn  
        from foo  
)where rn =1  
 and status = 1 
```

执行上述操作大约需要 9 分钟。当我将查询修改为：

```
select *
from   
(   select *   
    from  
    (  
            select *, row_number() over (partition by id order by seen desc) rn  
            from foo  
    )where status = 1  
) where status = 1 
```

它会在不到 1 分钟的时间内返回。这是一个示例，我小心地减小了驱动结果集的大小，以便系统做更少的工作，从而更快地返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:29:37.867

试试这个，我相信自我加入是最好的选择

```
 select b.start_date,nvl(sum(a.Count),0) from TABLE2 a right join TABLE2 b on 
  a.start_date<>b.start_date and
  a.weekday=b.weekday and a.start_date between b.start_date and b.end_date 
  group by b.start_date order by b.start_date 
```

[小提琴演示](http://sqlfiddle.com/#!4/2019f/20)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T12:25:17.023

我希望这是您的要求......这个适用于您的示例数据的 oracle

```
 select TAB.START_DATE START_DATE, nvl(X1.SUM_COUNT,0) SUM_COUNT
     from TABLE2 TAB,
        ( select A1.START_DATE,SUM(A2.COUNT) SUM_COUNT
          from TABLE2 A1,TABLE2 A2
          where A1.WEEKDAY=A2.WEEKDAY and A1.rowid <> A2.rowid
          and A2.START_DATE between A1.START_DATE and A1.END_DATE
          group by A1.START_DATE
       ) X1
    where TAB.START_DATE=X1.START_DATE(+) order by 1 
```

请参考这个 sql fiddle：[http ://sqlfiddle.com/#!4/2019f/4](http://sqlfiddle.com/#!4/2019f/4)

# c# - +CDS AT COMMAND 问题

> ID：13956694
> 
> 赞同：2
> 
> 时间：2012-12-19T16:23:01.263
> 
> 标签：c#, at-command

当我使用 SerialPort 通过 c# 在 AT COMMAND 中获得 +CDS 时，我遇到了问题，任何时候我都会截断这个 +CDS，例如：

+CDS：25 0002970C91555868047414212181414094882121814140948830

为什么我有这个问题，为什么任何时候都很好？

我正在启动 SerialPort：

```
 public PortCOM(string porta)
            : base(porta, 115200, Parity.None, 8, StopBits.One)
        {
            this.StatusPort = StatusPorta.Ready;
            this.DiscardNull = true;
            this.ReadTimeout = 21000;
            this.RtsEnable = true;
            this.DtrEnable = true;
            this.ReceivedBytesThreshold = 9;
            this.NewLine = "\r\n";
            this.ReadBufferSize = 1024;
        }

    public static  void TestPort()
        {
            var p = new PortCom("COM12");

            if (!p.IsOpen)
                p.Open();

            p.StatusPort = StatusPorta.Ready;
            p.DataReceived += new SerialDataReceivedEventHandler(p_DataReceivedSample);
            p.PinChanged += new SerialPinChangedEventHandler(p_PinChanged);
            p.ErrorReceived += new SerialErrorReceivedEventHandler(p_ErrorReceived);

            p.Disposed += new EventHandler((obj, porta) =>
            {
                Console.WriteLine(((PortaCOM)obj).ToString());
            });

            if (Console.ReadKey().Key == ConsoleKey.B)
            {
                p.Close();
                p.Dispose();
            }
        }

static void p_DataReceivedSample(object sender, SerialDataReceivedEventArgs e)
        {
            var p = (PortaCOM)sender;
            try
            {
                Console.WriteLine(p.ReadExisting());
                var sb = new StringBuilder();

                sb.Append(p.ReadExisting());
                int y = sb.ToString().IndexOf("\r\n");

                var stop = Stopwatch.StartNew();
                stop.Start();
                while (y == -1)
                {
                    sb.Append(p.ReadExisting());
                    y = sb.ToString().IndexOf("\r\n");
                    if (stop.Elapsed.TotalSeconds > 10)
                        break;
                }
                stop.Stop();

                var _retorno = sb.ToString();
                var cmt = regCMT.Match(_retorno);
                var succ = regSucess.Match(_retorno);
                var report = regStatusReport.Match(_retorno);
                var erro = regError.Match(_retorno);

                #region Resposta
                if (cmt.Success)
                {
                    var smss = new SMS();
                    var source = cmt.Groups[3].Value;
                    SMS.Fetch(smss, ref source);
                    var resposta = new Resposta()
                    {
                        Mensagem = smss.Message,
                        Data = smss.ServiceCenterTimeStamp,
                        Sender = smss.PhoneNumber,
                        Operadora = p.OperadoraName.NomeOperadora.ToString()
                    };

                    GravaResposta().ToAsync(Scheduler.TaskPool).Invoke(p, cmt.Groups[3].Value);
                    p.IsError = false;
                }
                #endregion

                #region StatusReport
                if (report.Success)
                {
                    RecebeReport(p, report.Groups[2].Value.Trim());
                    p.IsError = false;
                }
                #endregion
            }
            catch (Exception err)
            {
                Console.WriteLine(err.Message);
            }
        } 
```

请我真的需要帮助，我很高兴有任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T16:56:12.270

[+cds](http://www.developershome.com/sms/resultCodes3.asp)对传入消息发出警报，消息位置位于 SIM 内存中。

所以这里似乎是 PDU 模式数据。它似乎可能是 Flash 消息内容。

将数据 PDU 模式转换为文本模式以接收消息。

查看此[ATSMS 库](http://atsmslibrary.codeplex.com/)

# iphone - 如何在视图的背景中移动图像？

> ID：13956706
> 
> 赞同：-3
> 
> 时间：2012-12-19T16:23:34.347
> 
> 标签：iphone, objective-c, ios, image

我的应用程序有问题，我有一个动态图像，它可以正常工作。但是我的图像也在一个按钮上移动，当图像在按钮之前时我无法点击。我如何确保图像在我的视图背景上移动，以便我仍然可以按下按钮。

这是运动图像的代码

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [[self navigationController] setNavigationBarHidden:YES animated:YES];
    [self loadImage];
    image = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"cow.png"]];
    image.frame =self.view.bounds;
    [[self view] addSubview:image];

    [NSTimer scheduledTimerWithTimeInterval: 3
                                     target: self
                                   selector:@selector(moveImage:)
                                   userInfo: nil repeats:YES];

}

-(void) moveImage: (NSTimer*)timer {

    CGFloat x = (CGFloat) (arc4random() % (int) self.view.bounds.size.width);
    CGFloat y = (CGFloat) (arc4random() % (int) self.view.bounds.size.height);
CGPoint pointOne=CGPointMake(x,y);
    image.center=pointOne;
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:50:43.007

问题在于`arc4random_uniform()`调用采用上限，而不是基于 0 的 args 计数（正如您，聪明的一些人会说的那样，推断）。您的方程式几乎是合理的，但在某些地方存在缺陷，我已尝试通过一些文档进行更正：

```
-(void)someAction:(id)sender {
    NSInteger imageIndex1 = arc4random_uniform(self.images.count); //upper bounds, so no -1
    NSInteger imageIndex2 = arc4random_uniform(self.images.count); //upper bounds, so no -1
    NSInteger imageIndex3 = arc4random_uniform(self.images.count); //upper bounds, so no -1
    _Bool b1 = true, b2 = true, b3 = true; //I can only assume you've been declaring GNU C booleans because of the lowercase false.
                                              //be careful, in Objective-C land, BOOL is signed char.
    if (imageIndex1 == imageIndex2) {
        b1 = false;
        imageIndex2 = arc4random_uniform(self.images.count); //upper bounds, so no -1
    }
    if(imageIndex1 == imageIndex3) {
        b2 = false;
        imageIndex1 = arc4random_uniform(self.images.count); //upper bounds, so no -1
    }
    if (imageIndex2 == imageIndex3) {
        b3 = false;
        imageIndex3 = arc4random_uniform(self.images.count); //upper bounds, so no -1
    }
    //You have to use ors here, otherwise your UI will never actually update, considering that in checking
    //for unique factors, then reassigning to another unique factor if a check fails, one of them has got
    //to be true before the UI can update, rather than all 3 at once.
    //Perhaps an individual check of each boolean would be more effective.
    if(b1 == true || b2 == true || b3 == true ) {
        [self.picture1 setImage:self.images[imageIndex1]];
        [self.picture2 setImage:self.images[imageIndex2]];
        [self.picture3 setImage:self.images[imageIndex3]];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:40:13.937

我猜你正在寻找一个不是当前索引的随机索引，这样你就可以选择一个随机的、不同的索引，而不仅仅是一个随机索引。

```
- (NSUInteger)randomUnsignedLessThan:(NSInteger)max excluding:(NSUInteger)exclude {

    NSInteger firstTry = -1;
    while (firstTry == exclude) firstTry = arc4random() % max;
    return firstTry;
} 
```

请注意，此方法将始终调用 arc4random 一次，并且需要 1+N 次调用，概率为 1/max^N，因此对于低范围和高性能要求，您可能会考虑使用不同的算法来排除一个索引。

# php - 处理可能包含或不包含特定偏移量的数组

> ID：13956708
> 
> 赞同：0
> 
> 时间：2012-12-19T16:23:36.657
> 
> 标签：php, arrays

我在下面有这个功能：

```
public function set_partial($array)
{
    if (is_array($array)) {
        foreach ($array as $each) {
            self::$_partials[$each[0]] = array('view' => $each[1], 'data' => $each[2]);
        }
    }
} 
```

在 self::$_partials 中，不需要“数据”。那么如何在允许数据为空的同时保持代码简单？现在，如果未提供数据，则会出现偏移错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:28:00.303

您可以检查是否为`each[2]`isset。如果是，则设置变量，否则使其为空：

```
<?php
public function set_partial($array){
    if(is_array($array)){
        foreach ($array as $each) {
            self::$_partials[$each[0]] = array('view' => $each[1], 'data' => (isset($each[2])?$each[2]:NULL));
        }
    }
}?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:29:01.690

如果要避免偏移错误，可以执行以下操作：

```
public function set_partial($array)
{
    if (is_array($array)) {
        foreach ($array as $each) {
            $view = !empty($each[1]) ? $each[1] : ''; // replace '' with whatever default value you want to use
            $data = !empty($each[2]) ? $each[2] : '';
            self::$_partials[$each[0]] = array('view' => $view, 'data' => $data);
        }
    }
} 
```

# ubuntu - 让 Sinatra 在 Ubuntu 上运行，未初始化的常量错误

> ID：13956712
> 
> 赞同：0
> 
> 时间：2012-12-19T16:23:50.153
> 
> 标签：ubuntu, gem, sinatra

尝试在 Ubuntu 12.04 上设置 Sinatra。我已经安装了 RVM，并且我想我已经安装了所有依赖项（如下所列）。我发现另一个 SO 帖子（[此处](https://stackoverflow.com/questions/11743448/trouble-installing-ruby-on-rails)）表明我没有安装 libssl-dev，但看起来我安装了。当我运行时：

```
sudo gem install sinatra 
```

我得到：

```
ERROR:  While executing gem ... (NameError)
    uninitialized constant Gem::RemoteFetcher::OpenSSL 
```

rvm req 安装：

```
sudo apt-get install build-essential openssl libreadline6 libreadline6-dev curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsq
lite3-dev sqlite3 libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison subversion pkg-config

Reading package lists... Done
Building dependency tree       
Reading state information... Done
Note, selecting 'libxslt1-dev' instead of 'libxslt-dev'
Note, selecting 'libncurses5-dev' instead of 'ncurses-dev'
autoconf is already the newest version.
automake is already the newest version.
bison is already the newest version.
curl is already the newest version.
git-core is already the newest version.
libncurses5-dev is already the newest version.
libreadline6 is already the newest version.
libtool is already the newest version.
libyaml-dev is already the newest version.
subversion is already the newest version.
zlib1g is already the newest version.
zlib1g-dev is already the newest version.
build-essential is already the newest version.
libc6-dev is already the newest version.
libsqlite3-dev is already the newest version.
libssl-dev is already the newest version.
libxml2-dev is already the newest version.
libxslt1-dev is already the newest version.
openssl is already the newest version.
sqlite3 is already the newest version.
The following packages will be REMOVED:
  libreadline-gplv2-dev
The following NEW packages will be installed:
  libreadline6-dev pkg-config
0 upgraded, 2 newly installed, 1 to remove and 7 not upgraded.
Need to get 40.9 kB/305 kB of archives.
After this operation, 201 kB of additional disk space will be used.
Do you want to continue [Y/n]? y 
```

红宝石版本：

```
ruby -v
ruby 1.9.3p327 (2012-11-10 revision 37606) [x86_64-linux] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T09:43:32.163

您是否安装了带有 OpenSSL 选项的 RVM？就像是

```
rvm reinstall 1.9.2 --with-openssl-dir=/usr/local 
```

如果您已经在没有 RVM 的情况下在 System 中安装了 Ruby、IRB 或 RubyGems（例如使用 apt-get），有时您会偶然发现问题。

如果没有，您可能需要考虑使用 OpenSSL 重新安装 RVM。请参阅[RVM 文档](https://rvm.io/packages/openssl/)

我还建议在安装 RVM 之前安装以下软件包

```
sudo apt-get install build-essential openssl libreadline6 libreadline6-dev \
curl git-core zlib1g zlib1g-dev libssl-dev libyaml-dev libsqlite3-dev sqlite3 \
libxml2-dev libxslt-dev autoconf libc6-dev ncurses-dev automake libtool bison  \
subversion pkgconfig 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-03T16:07:01.653

如果无法通过 DNS 解析 ruby​​gems.org，则可能会出现此错误（未初始化的常量 Gem::RemoteFetcher::OpenSSL）。它只是发生在我身上。DNS 恢复正常后，gem install 又开始工作了。

# javascript - 从元素中删除类并添加到下一个元素

> ID：13956713
> 
> 赞同：10
> 
> 时间：2012-12-19T16:23:56.527
> 
> 标签：javascript, jquery

我有一个链接列表，其中一个具有活动的类。

在我的下一个按钮上单击 id 喜欢从当前元素中删除类并将其添加到下一个我似乎无法添加它？

我做了一个小提琴，希望能解释我的问题，任何帮助都会很棒，谢谢

[http://jsfiddle.net/h6D4k/](http://jsfiddle.net/h6D4k/)

```
$('.next').click(function(){
    $('ul.pagination').find('a.active').removeClass('active');
    $('ul.pagination').find('a.active').next('a').addClass('active');
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T16:25:14.810

jQuery 最有用的便利之一是它的方法（通常）是可链接的——换句话说，它们返回调用它们的对象。所以你可以简单地写这个：

```
$('ul.pagination').find('a.active').removeClass('active').closest('li')
                  .next('li').find('a').addClass('active'); 
```

...因为它`<li>`是应该“下一个”的元素，而不是`<a>`那些元素。但事实上，如果它是最后一个有问题的元素，您不应该完全放弃“活动”：

```
var $a      = $('ul.pagination').find('a.active'),
    $li     = $a.closest('li'),
    $nextLi = $li.next('li');

if ($nextLi.length) {
   $a.removeClass('active');
   $nextLi.find('a').addClass('active');
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T16:26:09.417

因为一旦你完成了这...

```
$('ul.pagination').find('a.active').removeClass('active'); 
```

没有更多了`a.active`-`active`类名已从该元素中删除。所以重复相同的选择器......

```
$('ul.pagination').find('a.active')//... 
```

...不会选择任何东西。

而是将它们链接在一起。

```
$('ul.pagination').find('a.active').removeClass('active').next('a').addClass('active'); 
```

* * *

你还有第二个问题。根据 jQuery API `next()`，它将：

> 获取匹配元素集中每个元素的紧随其后的兄弟。如果提供了选择器，则仅当它与该选择器匹配时，它才会检索下一个兄弟。

您不是想获得以下兄弟姐妹：

```
<ul class="pagination">
    <li><a class="one active" href="#">X</a></li>
    <li><a class="two" href="#">X</a></li>
    <li><a class="three" href="#">X</a></li>
</ul>

<a href="" class="next">Next</a>
<a href="" class="prev">Prev</a> 
```

您正在尝试获取`<a>`整个文档中的下一个。这更具挑战性——我不知道该怎么做。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T16:29:21.933

这实际上是您想要的，基于您小提琴中的 html 结构。[http://jsfiddle.net/h6D4k/1/](http://jsfiddle.net/h6D4k/1/)

```
$('ul.pagination').find('a.active').removeClass('active').parent()
                  .next().find('a').addClass('active'); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-19T16:35:10.270

我会这样写，防止动作在最后一个 li 上做任何事情。

[http://jsfiddle.net/h6D4k/6/](http://jsfiddle.net/h6D4k/6/)

```
$('.next').click(function(e){
    e.preventDefault();
    if ($("ul.pagination a.active").parent().is(":last-child")) return;
    $('ul.pagination a.active').removeClass('active').parent().next().find("a").addClass('active');
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-19T16:38:54.047

您的代码中有两个错误：

1.  删除后，将无法再找到活动类
2.  您的 a 标签嵌套在 li 标签中，因此 next() 无法按预期工作

为了简化事情，您可以将活动类附加到 li 标签。

现场演示：http: [//jsfiddle.net/h6D4k/7/](http://jsfiddle.net/h6D4k/7/)

代码：

```
$('.next').click(function(){
  $('ul.pagination').find('li.active').removeClass('active')
                    .next().addClass('active');
  return false;
}); 
```

# css - CSS：悬停高度变化不起作用

> ID：13956721
> 
> 赞同：0
> 
> 时间：2012-12-19T16:24:20.700
> 
> 标签：css, hover, height

我在我非常简单的`css`文件中有这个问题，我想`div`从`75px`in`height`和`width`with转换 a `:hover`，但它似乎只改变`width`.

```
#ich{
    transition: 2s;
    -moz-transition: 2s; /* Firefox 4 */
    -webkit-transition: 2s; /* Safari and Chrome */
    -o-transition: 2s; /* Opera */

    margin-top:40%;
    width:75px;
    height:75px;
    border-radius:35px;
    background-image:url(fb.jpg) ;
    background-repeat: no-repeat;
    background-position: center;
    text-align:center;
    display:block;
}

#ich:hover{
    width:300px!important;
    height:300x!important;
    background-size: 300px 300px;
} 
```

HTML 只是一个`div`带有 id`#ich`的`body`部分，没有别的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T16:25:47.233

```
height:300px!important; 
```

您只需输入“300x”而不是“300px”

# android - 在 Android Webview + jquery mobile 中允许远程 ajax 调用

> ID：13956726
> 
> 赞同：7
> 
> 时间：2012-12-19T16:24:44.970
> 
> 标签：android, ajax, jquery-mobile, cross-domain, android-webview

我正在使用 jquerymobile 开发一个 javascript/HTML 应用程序，它向远程服务器发出 ajax 请求。该应用程序在 Chrome 上运行良好（仅在禁用网络安全的情况下启动 chrome）但是当我将它嵌入到 Android 应用程序（一个简单的 webview）的 assets/ 目录中时，远程 ajax 调用失败。因此，我想这可能是一个跨域问题。我知道 phonegap 没有这个问题，但如果可能的话，我不想使用 phonegap。所以问题是：如何在 Android webview 应用程序中禁用跨域保护？

这是活动代码：

```
public class Moby extends Activity {

@SuppressLint("NewApi")
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_moby);

    WebView mbrowser = (WebView) findViewById(R.id.webView1); //get the WebView from the layout XML
    if (Build.VERSION.SDK_INT >= VERSION_CODES.JELLY_BEAN) 
        mbrowser.getSettings().setAllowUniversalAccessFromFileURLs(true);
    //mbrowser.setWebChromeClient(new WebChromeClient());
    mbrowser.setWebViewClient(new WebViewClient());
    mbrowser.loadUrl("file:///android_asset/index.html"); //set the HTML
    WebSettings settings = mbrowser.getSettings();
    settings.setJavaScriptEnabled(true);
} 
```

}

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

而且我已经在我的 html 页面中设置了 jquerymobile 跨域参数：

```
<script src="script/jquery-1.8.2.js"></script>
<script>
 $(document).bind("mobileinit", function(){
 $.support.cors = true;
 $.mobile.allowCrossDomainPages = true;       
}); 
</script>
<script src="script/jquery.mobile-1.2.0.js"></script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-01-12T13:42:21.363

我没有足够的积分将其作为评论发布，但是，请查看以下内容：

[ajax 在某些 Android 设备上工作，而不是在其他设备上](https://stackoverflow.com/questions/14191338/ajax-working-on-some-android-devices-not-in-other)

具体来说，基于 Chrome 的 webViews 需要以下内容：

webView.getSettings().setAllowUniversalAccessFromFileURLs(true);

编辑：对不起，我刚刚看到你已经在这样做了——我对此进行了测试，它似乎已经解决了我的问题（通过 ajax 加载本地链接时出现 access-control-allow-origin 错误）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-15T08:11:37.747

尝试这个

```
WebView web=(WebView) findViewById(R.id.webView1);
web.getSettings().setJavaScriptEnabled(true); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-15T07:33:48.003

我遇到了同样的问题，我通过在我的 WebViewClient 中覆盖 shouldInterceptRequest 来修复它。我拦截了ajax调用并在java中进行。您必须对 POST 方法执行相同的操作

```
private class MyWebViewClient extends WebViewClient {
        @Override
        public void onPageFinished(WebView webView, String url) {
            Log.d("test", "onPageFinished");
            loadWebViewJavascriptBridgeJs(webView);
        }

        @Override
        public WebResourceResponse shouldInterceptRequest(WebView webview, WebResourceRequest webrequest)
        {
            Log.d("test", "shouldInterceptRequest");
           return this.handleRequest(webrequest.getUrl().toString());
        }

        @NonNull
        private WebResourceResponse handleRequest(@NonNull String urlString) {
            try {
                URL url = new URL(urlString);
                HttpURLConnection connection = (HttpURLConnection)url.openConnection();
                connection.setRequestProperty("User-Agent", "");
                connection.setRequestMethod("GET");
                connection.setDoInput(true);
                connection.connect();

                InputStream inputStream = connection.getInputStream();
                return new WebResourceResponse("text/json", "utf-8", inputStream);
            } catch (MalformedURLException e) {
                e.printStackTrace();
                return null;
            }
            catch (ProtocolException e) {
                e.printStackTrace();
                return null;
            }catch (IOException e) {
                e.printStackTrace();
                return null;
            }

        }
    } 
```

当我启动我的 webview 时，我实例化了我的 WebViewClient

```
 mWebView.setWebViewClient(new MyWebViewClient()); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-19T16:33:55.293

在您的 AndroidManifest.xml 中，是否有这一行：

```
<uses-permission android:name="android.permission.INTERNET" /> 
```

# c++ - 使用 MinGW 的非标准位置构建 Boost 1.52

> ID：13956727
> 
> 赞同：1
> 
> 时间：2012-12-19T16:24:48.883
> 
> 标签：c++, boost, batch-file, mingw, bjam

我尝试使用 MinGW (x64) 从源代码为 64 位构建 Boost，但在创建 bjam.exe 时失败。任何指向帮助的指针表示赞赏。谢谢。

*   包：Boost 1.52.0（从 sourceforge 下载，C:\BoostSrc）
*   包：MinGW-w64（4.7.2-x64 rubenvb，C:\MinGW\rubenvb-4.7.2-64）

我创建了以下批处理文件以确保可重复构建，但出现了问题。我无法使用提供的批处理文件构建 bjam.exe。我没有使用提供的“bootstrap.bat”作为 MinGW 的非标准安装路径（我有多个 mingw 集），并且我的机器中没有安装 MSVC

```
SET BOOST_VER=boost_1_52_0
SET PATH_MINGW=C:\MinGW\rubenvb-4.7.2-64
SET PATH_BJAM=%~dp0\%BOOST_VER%\tools\build\v2\engine
SET PATH="%PATH_MINGW%\bin"
PUSHD "%PATH_BJAM%"

REM check path
mingw32-make -version

REM error below
build.bat mingw --toolset-root=%PATH_MINGW% --show-locate-target

SET PATH=%OPATH%
POPD
REM ... some more ... 
```

错误信息

gcc：错误：CreateProcess：没有这样的文件或目录

当我直接从命令提示符键入命令（设置路径，转到位置并调用 build.bat）时，它运行顺利（带有我认为可以忽略的警告）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:43:43.113

这可能会解决您的问题，但即使不是这样，无论如何更改它也是一个好主意。

使用不同的变量名称，`PATH`因为这是 MINGW 可能依赖的内置且重要的 windows 环境变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T06:05:11.233

在深入了解位于 BOOST_ROOT\tools\build\v2\engine 的 build.bat 后，当提供“mingw”作为工具集时，脚本绕过了“猜测工具集”步骤，未能定义变量“BOOST_JAM_TOOLSET_ROOT”，留下调用到 gcc 相关的可执行文件失败。

现在我改变了批次如下

```
PUSHD "%PATH_BJAM%"
SET "PATH=%PATH_MINGW%\bin"

REM add the line below
SET "BOOST_JAM_TOOLSET_ROOT=%PATH_MINGW%\"

build.bat mingw --show-locate-target
SET PATH=%OPATH% 
```

我从外部批处理文件手动设置了 BOOST_JAM_TOOLSET_ROOT 变量，这工作正常。注意结尾的“\”字符，因为里面的 build.bat 附加了路径变量，如下所示：

```
set "PATH=%BOOST_JAM_TOOLSET_ROOT%bin;%PATH%" 
```

非常感谢您的任何意见和建议。

# python - 如何检查 jinja2 模板中是否存在给定变量？

> ID：13956728
> 
> 赞同：18
> 
> 时间：2012-12-19T16:24:57.170
> 
> 标签：python, jinja2

假设，我创建了一个模板对象（fe using `environment.from_string(template_path)`）。是否可以检查创建的模板中是否存在给定的变量名称？

我想知道，如果

```
template.render(x="text for x") 
```

会产生任何影响（如果某些东西实际上会被“x 的文本”替换）。如何检查变量 x 是否存在？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-12-19T16:29:54.013

从文档中：

**定义（值）**

如果定义了变量，则返回 true：

```
{% if variable is defined %}
    value of variable: {{ variable }}
{% else %}
    variable is not defined
{% endif %}
See the default() filter for a simple way to set undefined variables. 
```

编辑：您似乎想知道是否将值传递给渲染上下文。在这种情况下，您可以使用[jinja2.meta.find_undeclared_variables](http://jinja.pocoo.org/docs/api/#jinja2.meta.find_undeclared_variables)，它将返回您要评估的模板中使用的所有变量的列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T16:40:15.977

我不确定这是否是最好的方法，或者它是否适用于所有情况，但我假设您在字符串中有模板文本，或者是因为您使用字符串创建了它，或者您的程序已读取源模板转换为字符串。

我会使用正则表达式库，重新

```
>>> import re
>>> template = "{% block body %} This is x.foo: {{ x.foo }} {% endblock %}"
>>> expr = "\{\{.*x.*\}\}"
>>> result = re.search(expr, template)
>>> try: 
>>>     print result.group(0)
>>> except IndexError:
>>>     print "Variable not used" 
```

结果将是：

```
'{{ x.foo }}' 
```

或抛出我捕获的异常：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
IndexError: no such group 
```

这将打印“未使用的变量”

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-12-19T16:32:26.317

你不能那样做。

我想您可以解析模板，然后通过 AST 来查看是否有引用，但这将是一些复杂的代码。

# php - 如何存储配置？

> ID：13956729
> 
> 赞同：5
> 
> 时间：2012-12-19T16:25:00.303
> 
> 标签：php, sql, configuration

我正在创建一个模块化系统，其中每个模块都与其他模块分开。我想将模块配置数据存储在数据库中，但我不知道最好的结构。

## 我有一些变体：

**第一个：**

```
key_____|______value (primary key is `key`)
option1 | 1
option2 | abcd
option3 | bla-bla-bla 
```

我可以轻松获取设置，但如果我想更新一些设置，我需要使用 CASE 构建硬 (？) SQL 查询：

```
UPDATE settings SET value = CASE
WHEN key = option1 THEN 1;
WHEN key = option2 THEN abcd;
…
END
WHERE key IN (option1, option2, …) 
```

如果有一个更好的变体可以在一个查询中更新多行（我将只使用 MySQLi 和 InnoDB），那就太好了。

**第二：**

```
module_____|_____settings
news       | a:3:{s:7:"option1";i:1;s:7:"option2";s:4:"abcd";s:7:"option3";s:11:"bla-bla-bla";} 
```

这样，我将使用设置序列化一个数组并将其放入数据库中。我想在 .php 文件中缓存未序列化的数据。但是如果我有*很大*的设置数组，我的序列化字符串会非常非常大。

**第三：**

```
option1 | option2 | option3
   1    |   abcd  |bla-bla-bla 
```

我将为一个选项键设置一列，但我认为创建一个表来存储一行是不必要的。

* * *

哪种变体最好？你能建议你自己的方法来存储配置吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:27:24.480

如果您打算在数据库中存储配置数据，我总是会选择第一个选项。

它允许您轻松添加和更新配置值，而不会影响系统的太多其他部分。您只是稍微考虑了更新值的复杂性。与其尝试将所有内容包装在单个更新中，不如为每个键编写单独的更新：

```
update settings set value = 1 where key = option1;
update settings set value = 'abcd' where key = option2; 
```

选项二可能紧随其后，但我真的很讨厌在数据库中存储一大串序列化数据。如果这是您要采用的方式，请考虑将其存储在配置文件中。

我也参与过使用第三个选项的项目，这是迄今为止我最不喜欢的。每次添加/删除配置值时都必须添加/删除列是一件非常痛苦的事情。

# templates - foreach 中的 KnockoutJS 模板

> ID：13956731
> 
> 赞同：5
> 
> 时间：2012-12-19T16:25:13.193
> 
> 标签：templates, knockout.js

我正在尝试在 foreach 中使用 knockoutjs 模板，但无法弄清楚数据成员需要是什么：

[JSFiddle](http://jsfiddle.net/JasonMore/ywqct/1/)

HTML

```
<script type="text/html" id="userPicture-template">
    <p data-bind="text: testText"></p>
</script>

<div >
    <ul data-bind="foreach: voters">
        <li data-bind="template: { name: userPicture-template, data: $data }">
        </li>
    </ul>
</div>
<div data-bind="foreach: voters" >
    <div>
        <div data-bind="template: { name: userPicture-template, data: $data }">
        </div>
    </div>
</div> 
```

Javascript

```
ko.applyBindings({
    voters: [
        { testText: "hello" },   
        { testText: "world" },
    ]
});​ 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T16:30:17.800

您没有用引号括起模板名称：

```
<div >
    <ul data-bind="foreach: voters">
        <li data-bind="template: { name: 'userPicture-template', data: $data }">
        </li>
    </ul>
</div>
<div data-bind="foreach: voters" >
    <div data-bind="css: questionClasses">
        <div data-bind="template: { name: 'userPicture-template', data: $data }">
        </div>
    </div>
</div> 
```

您的视图模型中也没有`questionClasses`字段。

这是工作小提琴：http: [//jsfiddle.net/ywqct/2/](http://jsfiddle.net/ywqct/2/)

# php - Symfony 2.1 表单主题验证错误不会覆盖默认值

> ID：13956736
> 
> 赞同：0
> 
> 时间：2012-12-19T16:25:28.387
> 
> 标签：php, symfony, twig, symfony-2.1

我试图用这个覆盖我的 symfony 2.1 应用程序中的默认错误树枝模板：

```
#config.yml
twig:
   debug:            %kernel.debug%
   strict_variables: %kernel.debug%
   form:
     resources:
       - 'AAACoreBundle::form_errors.html.twig' 
       - 'AAACoreBundle::form_label.html.twig' 
```

我在我的 AAACoreBundle/Resources/views 中创建了 form_errors.html.twig（几乎是默认的复制/粘贴）。

```
#form_errors.html.twig
{% block form_errors %}
{% spaceless %}
{% if errors|length > 0 %}
<ul class="validation_errors">
    {% for error in errors %}
    <li>{{
                    error.messagePluralization is null
                        ? error.messageTemplate|trans(error.messageParameters, 'validators')
                        : error.messageTemplate|transchoice(error.messagePluralization, error.messageParameters, 'validators')
    }}</li>
    {% endfor %}
</ul>
{% endif %}
{% endspaceless %}
{% endblock form_errors %} 
```

不幸的是，只使用了标签模板。对于验证错误，我仍然得到默认模板。奇怪的是，当我在我的 twig 表单文件中强制使用此模板时，它可以工作：

```
{% form_theme form with 'AAACoreBundle::form_errors.html.twig' %} 
```

有人知道我可以检查什么吗？我似乎找不到原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T17:01:41.323

出于某种我不明白的原因，切换顺序确实有效。

非常感谢提出这个建议的dreipunktnull！

# node.js - 在 Mongoose 中，如何在具有 .create()、.id() 和 .remove() 功能的模型中创建 MongooseArray/Collection

> ID：13956738
> 
> 赞同：1
> 
> 时间：2012-12-19T16:25:31.043
> 
> 标签：node.js, mongodb, backbone.js, mongoose

我的架构：

```
Account: mongoose.model('Account', new Schema({
    account_name: String,
    company: String,
    notes: String,
    contact_info: [this.ContactInfo]
})),
ContactInfo: mongoose.model('ContactInfo', new Schema({
    name: String,
    email: String,
    phone: String,
    notes: String 
})) 
```

但是，当我尝试对 contact_info 执行任何操作时，它说这些方法不存在。

```
var c = new ContactInfo...);
var a = new Account(...);

a.contact_info.create(c); //error, create doesn't exsit
a.contact_info.push(c); //works
a.contact_info.id(...).remove(); //id doesn't exist 
```

难道我做错了什么？

我的完整代码在这里（不多）：[https ://github.com/nycitt/node-survey-builder-api-server/blob/master/accounts.js](https://github.com/nycitt/node-survey-builder-api-server/blob/master/accounts.js)

顺便说一下，我正在接收来自 Backbone.js 的输入

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T19:04:45.813

所以显然我做错了一些事情：

在 Schemas 中，引用其他 Schemas NOT 模型：

好的：

```
var ContactInfoSchema = new Schema({
    name: String
});

var AccountSchema = new Schema({
    account_name: String,
    contact_info: [ContactInfoSchema] 
});

var ContactInfo = mongoose.model('ContactInfo', ContactInfoSchema);

var Account = mongoose.model('Account', AccountSchema); 
```

错误：var ContactInfoSchema = new Schema({ name: String, email: String, phone: String, notes: String });

```
var AccountSchema = new Schema({
    account_name: String,
    contact_info: [ContactInfo] //subtle difference
});

var ContactInfo = mongoose.model('ContactInfo', ContactInfoSchema);

var Account = mongoose.model('Account', AccountSchema); 
```

另一件事是执行以下操作不会保存任何内容！！！

```
account.contact_info.create(params);
account.save(); 
```

你也必须做

```
var c = account.contact_info.create(params);
account.contact_info.push(c);
account.save(); 
```

对于那些感兴趣的人，我为 Account 和 ContactInfo 创建了 CRUD 方法。

[https://github.com/nycitt/node-survey-builder-api-server/blob/f94fcd4b05bf0af4f34a0e00f4ff79ebf64e24e1/accounts.js](https://github.com/nycitt/node-survey-builder-api-server/blob/f94fcd4b05bf0af4f34a0e00f4ff79ebf64e24e1/accounts.js)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T17:06:00.303

您的问题可能在[`schemas.js`](https://github.com/nycitt/node-survey-builder-api-server/blob/4fbbcb24c94e08e75423b638b42ececcff014c9d/schemas.js). 通过字面量定义对象时，`this`不会引用正在定义的对象：

```
// ...
    contact_info: [this.ContactInfo]
// ... 
```

相反，它将引用文字周围的上下文——在节点模块的情况下，[`exports`对象](http://nodejs.org/api/globals.html#globals_exports)——没有`ContactInfo`属性。所以，结果是：

```
// ...
    contact_info: [undefined]
// ... 
```

你仍然会有一个`Array`，这就是为什么`push`可用。但是，Mongoose 不知道将其设为 a [`MongooseDocumentArray`](http://mongoosejs.com/docs/api.html#types-documentarray-js)，因此它没有`id`,`create`等方法。

您必须在对象之外定义模型才能引用它们。还要注意顺序的变化：

```
var ContactInfo = mongoose.model('ContactInfo', new Schema({
    // ...
});

var Account = mongoose.model('Account', new Schema({
    // ...
    contact_info: [ContactInfo]
});

module.exports = {
    Account: Account,
    ContactInfo: ContactInfo
}; 
```

或者，将它们附加到`exports`设置`this.ContactInfo`（相同的顺序）：

```
exports.ContactInfo = ...;
exports.Account = ...; 
```

# javascript - 为什么我在 IE8 上收到拒绝访问错误？

> ID：13956743
> 
> 赞同：-4
> 
> 时间：2012-12-19T16:25:45.453
> 
> 标签：javascript, html, internet-explorer-8, ie7.js

我的网站中没有 IE7-js，但出现与 IE7-js 相关的错误。我敲了几个小时的头，仍然没有得到任何线索。![在此处输入图像描述](../Images/24ae38c8b115b4b80268d744ac3c9cc3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:51:53.437

你有`iframe`s 从中加载内容`http://www.formstack.com/forms/?...`

这些页面上有这段代码：

```
<!--[if lt IE 9]>
    <script src="https://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
<![endif]--> 
```

这是导致`Permission denied`错误的脚本。该代码尝试访问`top.window`，当两个页面不在同一个域中时，这是不允许的`(if(/ie7_off/.test(top.location.search)||t<5.5||t>=h.compat)`。

# r - 当模型包含因子或多项式时，使用 predict.lm 生成模型项的拟合值

> ID：13956753
> 
> 赞同：1
> 
> 时间：2012-12-17T20:23:51.677
> 
> 标签：r

我想用来`predict.lm`为模型中的预测变量生成拟合值。换句话说，我想将对象中的系数估计值乘以具有*n*行`lm`的新数据框中的值。结果是一个具有*n*行的矩阵，其中每个值都乘以相应的系数。

 **当新数据框对对象中的每个系数估计都有一列时，这很容易做到`lm`。例如：

```
y       <- rnorm(6) 
x1      <- rnorm(6)
x2      <- rnorm(6) 
modEasy <- lm(y ~ x1 + x2)
dfEasy  <- data.frame(x1 = rnorm(6), x2 = rnorm(6))
predict(modEasy, newdata = dfEasy, type = "terms") 
```

但是当模型包含因子变量或多项式时，生成拟合值很棘手。在这些情况下，新数据框的列数少于*k*。例如：

```
y       <- rnorm(6) 
x1      <- rnorm(6)
x2      <- factor(rep(letters[1:3], 2))
modHard <- lm(y ~ x1 + x2)
dfHard  <- data.frame(x1 = rnorm(6), x2 = factor(rep(letters[1:3], each=2)))
predict(modHard, newdata = dfHard, type = "terms") 
```

在这种情况下，`modHard$coefficients`包含`x1`和 的每个因子水平的估计值`x2`，就像它应该的那样。但`dfHard`只有两列：一列 for`x1`和一列 for `x2`。结果，`predict`返回一个只有两列的矩阵：一列 for `x1`，另一列 for `x2`。

在这种情况下，我希望预测返回一个矩阵，其中`x1`包含每个级别的列`x2`。我可以使用以下代码生成该矩阵：

```
mf <- model.frame(formula(modHard), dfHard)
mm <- model.matrix(formula(modHard), mf)
t(modHard$coefficients * t(mm)) 
```

但是有没有更简单的方法？**

# php - MySQL 正则表达式替换

> ID：13956754
> 
> 赞同：3
> 
> 时间：2012-12-19T16:26:40.577
> 
> 标签：php, mysql, regex

这是我的情况：

我的公司为客户托管多个站点，站点的内容存储在 MySQL 数据库中。

我有一个问题，我需要遍历整个数据库并替换部分内容。例如：

我需要用**//downloads.mysever.com/siteID/someImage.jpg替换****http://downloads.mysever.com/siteID/someImage.jpg**

 **所以我只需要从所有链接到我们的下载服务器的链接中删除**http:。**

我的问题是解决这个问题的最佳方法是什么？我是否需要编写一个 php 脚本来处理这个，或者我可以只使用 MySQL 来完成这个。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:32:36.027

你可以使用sql语句

```
 UPDATE tablename SET url = REPLACE(url, 'http:', ''); 
```

阅读[这篇](http://davidwalsh.name/mysql-replace)博文

您可以使用命令行执行此命令

```
mysql -uUSERNAME -p DATABASE_NAME -e "UPDATE tablename SET url = REPLACE(url, 'http:', '')"; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T16:33:02.140

你可以用纯mysql做到这一点：

```
update table set field = REPLACE(field, 'http:', '') where INSTR(field, 'http:') > 0; 
```

看到[这个问题](https://stackoverflow.com/questions/125230/mysql-search-and-replace-some-text-in-a-field)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:31:50.763

如果您能够使数据库短暂脱机，我发现最简单的方法是：

1.  使用 mysqldump 导出整个数据库
2.  在您喜欢的任何编辑器中运行查找和替换以更新数据库转储
3.  从转储文件重新创建数据库 - 确保一切正常，然后用新版本替换原始数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T16:46:21.863

要删除表中所有行的前导`'http:'`字符串（从字符类型列中），那么简单的方法就可以了：

```
UPDATE mytable
   SET mycol = SUBSTRING(mycol,6)
 WHERE mycol LIKE 'http:%' 
```

* * *

**更新：**

请注意，使用该`REPLACE`函数将从字符串中替换所有出现的指定字符串；它可能不适合仅删除指定字符串的前导出现。

如果要删除在列值中找到的所有“http:”，则：

```
UPDATE mytable
   SET mycol = REPLACE( mycol , 'http:, '')
 WHERE mycol LIKE '%http:%' 
```

* * *

MySQL 确实提供了对正则表达式的支持，特别是查找与给定正则表达式匹配的值；但 MySQL 不支持使用正则表达式进行“替换”。

所以你可以在查询中使用它：

```
 WHERE mycol REGEXP 'http:' 
```

代替（相当于）：

```
 WHERE mycol LIKE '%http:%' 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T16:42:37.620

MySQL 确实提供了正则表达式功能。该功能可能过于详细，无法在此处介绍，因此这里是链接：

[http://dev.mysql.com/doc/refman/5.5/en/regexp.html](http://dev.mysql.com/doc/refman/5.5/en/regexp.html)

您的示例案例的基本用法示例是：

```
UPDATE table SET field = REPLACE(field, 'http:', '') WHERE field REGEXP '^http:' 
```

但是请注意，这种情况可以在没有正则表达式的情况下通过简单地执行以下操作来完成：

```
UPDATE table SET field = REPLACE(field, 'http:', '') WHERE field LIKE 'http:%' 
```

因此，您可能不需要对要执行的每种替换类型使用正则表达式。**

# magento - Magento：跟踪可下载产品链接的下载次数

> ID：13956756
> 
> 赞同：1
> 
> 时间：2012-12-19T16:26:42.117
> 
> 标签：magento

我想显示 Magento 中可下载产品的任何可下载链接的下载次数。

我不认为 Magento 有这样的功能。

看来我们需要对其进行编程。

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T17:29:55.127

查看 downloadable_link_purchased_item 表中的 number_of_downloads_bought 和 number_of_downloads_used（Mage_Downloadable_Model_Link_Purchased_Item 模型）

Magento 使用这些字段来定义用户可以下载文件的次数：

```
$linkPurchased = Mage::getModel('downloadable/link_purchased')->load($linkPurchasedItem->getPurchasedId());
$downloadsLeft = $linkPurchasedItem->getNumberOfDownloadsBought()
    - $linkPurchasedItem->getNumberOfDownloadsUsed(); 
```

因此，您可以使用 $linkPurchasedItem->getNumberOfDownloadsUsed() 作为所选顺序的下载次数。如果您计算每个订单的下载次数，您可以获得总下载次数。

或者您可以制作自己的计数器来调用 Mage_Downloadable_DownloadController::_processDownload()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T17:18:14.197

不是“downloadable_link”表中的“number_of_downloads”字段吗？

# ant - 第一个 Ant build.xml 文件未编译为检测错误以及其他 ant 问题

> ID：13956759
> 
> 赞同：0
> 
> 时间：2012-12-19T16:26:46.413
> 
> 标签：ant

我正在尝试为刚刚从 Netbeans 移出的已建立的 java 项目编写我的第一个 build.xml 文件。

A. 我试图实现的目标非常简单：

1.  使用下面的“dest”目标，将所有源文件（1 个包中的 4 个）复制到我要创建的 src/test 中。源文件被复制到“src/test”目录，但随后在“src/test”目录中也创建了一个“test”目录，为什么我不确定。

2.  使用下面的“jar”目标，创建一个 jar，其中包含包名目录下的所有类文件 - 根本不起作用！

3.  使用“编译”目标确保所有代码都编译成功，但我得到了很多错误。该代码在 Eclipse 中成功地进行了 CLEAN 和 BUILD，所以我不确定我在 ANT 脚本中做错了什么，我注意到的一件事是它试图在只有“4”个文件时编译“8”个文件。不确定其他 4 个来自哪里，尽管它表示重复。关于缺少符号的错误显示似乎是指有关构建路径中包含的所需项目的导入语句，因此我不确定如何解决 ANT 在其编译中引发的问题。

B. 这是我第一次尝试创建我的第一个 build.xml 文件，但我遇到了如下所示的问题：

```
<project name="ThalesDataGenerator" basedir="." default="clean-build">

    <property name="src.dir"     value="src"/>
    <property name="dest.dir"    value="${src.dir}/test"/>

    <property name="dist.dir"    value="dist"/>

    <property name="build.dir"   value="build"/>
    <property name="classes.dir" value="${build.dir}/classes"/>
    <property name="jar.dir"     value="${build.dir}/${ant.project.name}"/>

    <property name="main-class"  value="thalesdatagenerator.ThalesDataGenerator"/>

    <target name="clean">
        <delete dir="${build.dir}"/>
        <delete dir="${dest.dir}"/>
    </target>

    <target name="compile">
        <mkdir dir="${classes.dir}"/>
        <javac srcdir="${src.dir}" destdir="${classes.dir}"/>
    </target>

    <target name="dest">
        <mkdir dir="${dest.dir}"/>
        <copy todir="${dest.dir}">  
            <fileset dir="${src.dir}" includes="**"/>  
        </copy>
    </target>

    <target name="jar" depends="compile">
        <mkdir dir="${jar.dir}"/>
        <jar destfile="${jar.dir}/ThalesDataGenerator.jar" basedir="${build.dir}">
            <manifest>
                <attribute name="Main-Class" value="${main-class}"/>
            </manifest>
        </jar>
    </target>       

    <target name="run" depends="jar">
        <java jar="${jar.dir}/${ant.project.name}.jar" fork="true"/>
    </target>

    <target name="clean-build" depends="clean,dest,jar,run"/>

</project> 
```

这是我得到的错误：

*   > 构建文件：C:\ATMSwitch\ThalesDataGenerator\build.xml 干净：
*   > [delete] 删除目录C:\ATMSwitch\ThalesDataGenerator\build
*   > 目的地：
*   > [mkdir] 创建的目录：C:\ATMSwitch\ThalesDataGenerator\src\test
*   > 【复制】复制4个文件到C:\ATMSwitch\ThalesDataGenerator\src\test
*   > 【复制】复制2个空目录到C:\ATMSwitch\ThalesDataGenerator\src\test下1个空目录
*   > 编译：
*   > [mkdir] 创建的目录：C:\ATMSwitch\ThalesDataGenerator\build\classes
*   > [javac] C:\ATMSwitch\ThalesDataGenerator\build.xml:22: 警告：'includeantruntime' 未设置，默认为 build.sysclasspath=last；为可重复构建设置为 false
*   > [javac] 编译8个源文件到C:\ATMSwitch\ThalesDataGenerator\build\classes
*   > [javac] C:\ATMSwitch\ThalesDataGenerator\src\thalesdatagenerator\ISOUtil.java:36：重复类：thalesdatagenerator.ISOUtil
*   > [javac] C:\ATMSwitch\ThalesDataGenerator\src\test\thalesdatagenerator\ThalesDataGenerator.java:13: 包 common.database 不存在
*   > [javac] 导入 common.database.Database;
*   > [javac] ^
*   > [javac] C:\ATMSwitch\ThalesDataGenerator\src\test\thalesdatagenerator\ThalesSystem.java:13: com.sharpbancsystems.atmterminals.thales 包不存在
*   > [javac] 注意：C:\ATMSwitch\ThalesDataGenerator\src\test\thalesdatagenerator\ThalesDataGenerator.java 使用未经检查或不安全的操作。
*   > [javac] 注意：使用 -Xlint 重新编译：未选中详细信息。
*   > [javac] 18 个错误

*   > 构建失败

*   > C:\ATMSwitch\ThalesDataGenerator\build.xml:22：编译失败；有关详细信息，请参阅编译器错误输出。

*   > 总时间：874 毫秒

任何帮助/方向将不胜感激。问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:28:39.167

让我们一次拿一个：

一些提示：

*   `${basedir}`定义属性时使用。例如，`<property name="src.dir" value="${basedir}/src"/>`而不是简单地`value="src"/>`
*   不要强制清理作为默认目标的一部分。标准的默认目标应该构建 jar，就是这样。进行清理会使您重复可能不需要的工作。您可以使用名为的目标`all`来清理、构建和执行。
*   如上所述，使用默认目标名称`clean`来清理构建，并`all`运行构建中的所有目标。这些都不应该是默认目标。

* * *

现在回到你的问题。您的`<javac>`目标如下所示：

```
<target name="compile">
    <mkdir dir="${classes.dir}"/>
    <javac srcdir="${src.dir}" destdir="${classes.dir}"/>
</target> 
```

您是说您的来源不依赖第三方 jar 吗？您需要创建一个编译类路径，其中包含您的源所依赖的所有第三方 jar。在 Eclipse 中，您正在使用一个内置的类路径。在 Ant 中，您必须指定这一点。

假设您编译源代码所需的所有 jar 都存储在`${basedir}/lib`. 您的*编译*目标需要如下所示：

```
<target name="compile">
    <mkdir dir="${classes.dir}"/>
    <path id="compile.classpath">
        <fileset dir="${basedir}/lib">
           <include name="**/*.jar"/>
        </fileset>
    </path>
    <javac srcdir="${src.dir}" 
        classpathref="compile.classpath"
        destdir="${classes.dir}"/>
</target> 
```

有很多方法可以做到这一点，但这是最简单的语法。我`<path>`用来定义一个包含我需要的所有 jar的*compile.claasspath 。*因为他们都住在`lib`目录中，所以很容易。

接下来，我在编译 Java 代码时使用*classpathref参数来指定这个类路径。*

这将编译类（现在没有发生）。由于*编译*`<jar>`目标失败，Ant 构建在任务被调用之前就结束了。让编译工作应该允许你构建的其余部分工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-27T01:32:59.607

发生在我身上。是因为我没有将 selenium-server-standalone-3.4.0.jar 复制到我的 C:\jars 目录（ws.jars）

# excel - Excel 2007-VBA，右键单击按钮

> ID：13956763
> 
> 赞同：0
> 
> 时间：2012-12-19T16:27:02.403
> 
> 标签：excel, excel-2007, vba

我遇到了一个奇怪的 Excel 2007 问题，我不太清楚如何解释。所以请多多包涵……

我创建了一些右键单击按钮来调用我编写的各种后端 VBA 函数。他们今天早些时候工作正常，现在由于某种原因，出现了一个按钮，该按钮不是来自我的工作表中的代码。当您单击它时，它会尝试打开另一个工作表并从中执行代码。这两个文件不在同一个目录中，也没有类似的名称。我删除了按钮试图从中执行的文件，现在它只是给了我一个错误 400。

所以，我想不通，从那以后删除了这个文件后端的每一段代码，按钮仍然出现。有什么想法可能导致这种情况吗？似乎它可能混合文件或将副本保存在临时目录中的某个位置并尝试访问它而不是在 VBA 中编写的实际代码。是否有我需要清除的缓存或其他什么？

我知道我并没有很好地描述这一点，因此我非常乐意提供您可能需要的任何和所有其他详细信息。让我知道发生了什么事。

**编辑#1 - 新信息 ==** 我什至可以打开一个新的、完全空白的 excel 文件，并且右键单击按钮仍然存在。

**编辑 #2 -- 尝试诊断 ==** 我刚刚尝试运行 Excel 诊断，它没有发现任何问题。很奇怪，好像这个宏不知何故变成了全局或存储在某种类型的缓存或其他东西中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T17:30:05.283

我希望我能正确理解你的问题。

如果您知道按钮出现在哪些右键单击（上下文）菜单中，您应该能够使用`Reset`命令修复它们。例如，如果它出现在 Cell 上下文菜单中，您可以在 VBE 的即时窗口中尝试：

```
Application.Commandbars("Cell").Reset 
```

这会将整个菜单重置为其默认状态。

此外，您可能对我编写的工具[MenuRighter 感兴趣](http://yoursumbuddy.com/menurighter/)，它允许您调整右键菜单。它还有一个设置可以显示任何上下文菜单的标题和 ID。

# jquery - jQuery Mobile：向 ui-grids 添加动态内容并删除它

> ID：13956766
> 
> 赞同：1
> 
> 时间：2012-12-19T16:27:17.723
> 
> 标签：jquery, json, jquery-mobile, append

我想将内容添加到 ui-grid。这是一些 json 数据，有时没有可用的数据。因此，我需要 if 子句：

```
if (typeof results.xyz[0] !== "undefined") {
$("#testing").append('<div class="ui-block-a" id="springboard2"><div class="springboardIcon"><a onclick="changeActorInfo('+results.xyz[0].id+')" href="#"><img src="http://www..."><span id="springboardLabelActors">'+results.xyz[0].name+'</span></a></div></div>');
            } else {} 
```

2 问题：

1）每次我加载数据时都会添加内容。但是之前添加的内容应该会消失。

2) else{} 子句当前为空。当没有可用的 json 数据时，不应添加任何内容。

我该如何管理？先感谢您！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T17:52:26.090

该`.append()`方法会将内容添加到容器中。如果要替换现有内容，可以使用[.html()](http://api.jquery.com/html/)代替。

不需要 else 子句，你的 if 条件就足够了。如果您没有数据，则不会在页面中插入任何内容。

这是您修改后的代码：

```
if (typeof results.xyz[0] !== "undefined") {
    $("#testing").html('<div class="ui-block-a" id="springboard2"><div class="springboardIcon"><a onclick="changeActorInfo('+results.xyz[0].id+')" href="#"><img src="http://www..."><span id="springboardLabelActors">'+results.xyz[0].name+'</span></a></div></div>');
} 
```

# wpf - 绑定到自定义依赖属性 - 再次

> ID：13956767
> 
> 赞同：25
> 
> 时间：2012-12-19T16:27:19.820
> 
> 标签：wpf, xaml, binding, dependency-properties

任务：实现最简单的依赖属性，可以像这样在 xaml 中使用：

```
<uc:MyUserControl1 MyTextProperty="{Binding Text}"/> 
```

我认为[这个](https://stackoverflow.com/questions/5698865/simple-dependency-property-and-usercontrol-issues-in-c-sharp)答案非常接近。为了更好的可读性，我在这里复制了我的所有代码（主要来自上面的那个答案）。

```
<UserControl x:Class="Test.UserControls.MyUserControl1"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Grid>
        <!-- Text is being bound to outward representative property;
             Note the DataContext of the UserControl -->
        <TextBox Text="{Binding MyTextProperty}"/>
    </Grid>
</UserControl> 
```

和

```
public partial class MyUserControl1 : UserControl
{
    // The dependency property which will be accessible on the UserControl
    public static readonly DependencyProperty MyTextPropertyProperty =
        DependencyProperty.Register("MyTextProperty", typeof(string), typeof(MyUserControl1), new UIPropertyMetadata(String.Empty));
    public string MyTextProperty
    {
        get { return (string)GetValue(MyTextPropertyProperty); }
        set { SetValue(MyTextPropertyProperty, value); }
    }

    public MyUserControl1()
    {
        InitializeComponent();
    }
} 
```

这是我的 MainWindow.xaml

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:uc="clr-namespace:WpfApplication1"
        Title="MainWindow" Height="350" Width="525">
    <StackPanel Orientation="Vertical">
        <uc:MyUserControl1 MyTextProperty="my text goes here"/>
        <Button Click="ButtonBase_OnClick" Content="click"/>
    </StackPanel>
</Window> 
```

到目前为止，一切正常。但是，我发现这没什么用。我需要的是

```
<uc:MyUserControl1 MyTextProperty="{Binding Text}"/> 
```

并且能够通过设置 a 来改变它`DataContext`（就像你通常在 MVVM 中所做的那样）

所以我替换上面的行并在后面添加我的代码，如下所示：

```
public partial class MainWindow : Window, INotifyPropertyChanged
{
    public MainWindow()
    {
        InitializeComponent();
        Text = "Initial Text";
        DataContext = this;
    }
    private string _Text;
    public string Text
    {
        get { return _Text; }
        set
        {
            if (value != _Text)
            {
                _Text = value;
                NotifyPropertyChanged("Text");
            }
        }
    }

    private void ButtonBase_OnClick(object sender, RoutedEventArgs e)
    {
        Text = "clicked";
    }

    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(String info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }
} 
```

“初始文本”和“点击”都不会显示......永远。所以我的问题是如何实施一个部门。正确使用的属性

```
<uc:MyUserControl1 MyTextProperty="{Binding Text}"/> 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-12-19T16:36:56.730

该`Text`属性位于*MainWindow*`DataContext`的而不是 UserControl 的。

 *所以将此行更改`<uc:MyUserControl1 MyTextProperty="{Binding Text}"/>`为：

```
<uc:MyUserControl1 MyTextProperty="{Binding Text, ElementName=MyMainWindow}"/> 
```

这将告诉绑定您正在谈论位于 MainWindow 中的 Text 元素。当然，因为在这个例子中我使用了`ElementName`，你会想要将你的窗口*命名*为MyMainWindow...

因此，将其添加到您的 MainWindow：

```
<Window  Name="MyMainWindow" ..... /> 
```

如果你不想命名你的窗口，你可以像这样使用 RelativeSource FindAncestor 绑定：

```
<wpfApplication6:MyUserControl1 MyTextProperty="{Binding Text, RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}"/> 
```

在这两种方式中，您都要求在窗口的 DataContext 中找到名为“Text”的属性。*

# sql - SQL 性能：SELECT DISTINCT 与 GROUP BY

> ID：13956768
> 
> 赞同：26
> 
> 时间：2012-12-19T16:27:23.323
> 
> 标签：sql, performance, oracle, group-by, distinct

我一直在尝试改善现有 Oracle 数据库驱动应用程序的查询时间，该应用程序运行缓慢。该应用程序执行几个大型查询，例如下面的查询，可能需要一个多小时才能运行。`DISTINCT`在下面的查询中用`GROUP BY`子句替换将执行时间从 100 分钟缩短到 10 秒。我的理解是，`SELECT DISTINCT`并且`GROUP BY`以几乎相同的方式操作。为什么执行时间之间存在如此巨大的差异？查询在后端执行的方式有什么区别？有没有`SELECT DISTINCT`跑得更快的情况？

注意：在以下查询中，`WHERE TASK_INVENTORY_STEP.STEP_TYPE = 'TYPE A'`仅表示可以过滤结果的多种方式之一。提供此示例是为了说明连接所有未包含列的表的原因，这`SELECT`将导致大约十分之一的可用数据

SQL 使用`DISTINCT`：

```
SELECT DISTINCT 
    ITEMS.ITEM_ID,
    ITEMS.ITEM_CODE,
    ITEMS.ITEMTYPE,
    ITEM_TRANSACTIONS.STATUS,
    (SELECT COUNT(PKID) 
        FROM ITEM_PARENTS 
        WHERE PARENT_ITEM_ID = ITEMS.ITEM_ID
        ) AS CHILD_COUNT
FROM
    ITEMS
    INNER JOIN ITEM_TRANSACTIONS 
        ON ITEMS.ITEM_ID = ITEM_TRANSACTIONS.ITEM_ID 
        AND ITEM_TRANSACTIONS.FLAG = 1
    LEFT OUTER JOIN ITEM_METADATA 
        ON ITEMS.ITEM_ID = ITEM_METADATA.ITEM_ID
    LEFT OUTER JOIN JOB_INVENTORY 
        ON ITEMS.ITEM_ID = JOB_INVENTORY.ITEM_ID     
    LEFT OUTER JOIN JOB_TASK_INVENTORY 
        ON JOB_INVENTORY.JOB_ITEM_ID = JOB_TASK_INVENTORY.JOB_ITEM_ID
    LEFT OUTER JOIN JOB_TASKS 
        ON JOB_TASK_INVENTORY.TASKID = JOB_TASKS.TASKID                              
    LEFT OUTER JOIN JOBS 
        ON JOB_TASKS.JOB_ID = JOBS.JOB_ID
    LEFT OUTER JOIN TASK_INVENTORY_STEP 
        ON JOB_INVENTORY.JOB_ITEM_ID = TASK_INVENTORY_STEP.JOB_ITEM_ID 
    LEFT OUTER JOIN TASK_STEP_INFORMATION 
        ON TASK_INVENTORY_STEP.JOB_ITEM_ID = TASK_STEP_INFORMATION.JOB_ITEM_ID
WHERE 
    TASK_INVENTORY_STEP.STEP_TYPE = 'TYPE A'
ORDER BY 
    ITEMS.ITEM_CODE 
```

SQL 使用`GROUP BY`：

```
SELECT
    ITEMS.ITEM_ID,
    ITEMS.ITEM_CODE,
    ITEMS.ITEMTYPE,
    ITEM_TRANSACTIONS.STATUS,
    (SELECT COUNT(PKID) 
        FROM ITEM_PARENTS 
        WHERE PARENT_ITEM_ID = ITEMS.ITEM_ID
        ) AS CHILD_COUNT
FROM
    ITEMS
    INNER JOIN ITEM_TRANSACTIONS 
        ON ITEMS.ITEM_ID = ITEM_TRANSACTIONS.ITEM_ID 
        AND ITEM_TRANSACTIONS.FLAG = 1
    LEFT OUTER JOIN ITEM_METADATA 
        ON ITEMS.ITEM_ID = ITEM_METADATA.ITEM_ID
    LEFT OUTER JOIN JOB_INVENTORY 
        ON ITEMS.ITEM_ID = JOB_INVENTORY.ITEM_ID     
    LEFT OUTER JOIN JOB_TASK_INVENTORY 
        ON JOB_INVENTORY.JOB_ITEM_ID = JOB_TASK_INVENTORY.JOB_ITEM_ID
    LEFT OUTER JOIN JOB_TASKS 
        ON JOB_TASK_INVENTORY.TASKID = JOB_TASKS.TASKID                              
    LEFT OUTER JOIN JOBS 
        ON JOB_TASKS.JOB_ID = JOBS.JOB_ID
    LEFT OUTER JOIN TASK_INVENTORY_STEP 
        ON JOB_INVENTORY.JOB_ITEM_ID = TASK_INVENTORY_STEP.JOB_ITEM_ID 
    LEFT OUTER JOIN TASK_STEP_INFORMATION 
        ON TASK_INVENTORY_STEP.JOB_ITEM_ID = TASK_STEP_INFORMATION.JOB_ITEM_ID
WHERE 
    TASK_INVENTORY_STEP.STEP_TYPE = 'TYPE A'
GROUP BY
    ITEMS.ITEM_ID,
    ITEMS.ITEM_CODE,
    ITEMS.ITEMTYPE,
    ITEM_TRANSACTIONS.STATUS
ORDER BY 
    ITEMS.ITEM_CODE 
```

这是使用以下查询的 Oracle 查询计划`DISTINCT`：

![使用 DISTINCT 进行查询的 Oracle 查询计划](../Images/e5cd78a51c3cf6f3b950fef65bb6b0f9.png)

这是使用以下查询的 Oracle 查询计划`GROUP BY`：

![使用 GROUP BY 进行查询的 Oracle 查询计划](../Images/5220c89268215113843ebb2fb5b9f950.png)

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-19T16:39:52.670

性能差异可能是由于`SELECT`子句中子查询的执行。我猜它正在为不同*之前*的每一行重新执行此查询。对于`group by`，它将在 group by*之后执行一次。*

尝试用连接替换它，而不是：

```
select . . .,
       parentcnt
from . . . left outer join
      (SELECT PARENT_ITEM_ID, COUNT(PKID) as parentcnt
       FROM ITEM_PARENTS 
      ) p
      on items.item_id = p.parent_item_id 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-12-19T16:38:36.510

我相当确定`GROUP BY`并且`DISTINCT`有大致相同的执行计划。

由于我们必须猜测（因为我们没有解释计划） ，这里的区别是 IMO 内联子**查询****在**.`GROUP BY`**`DISTINCT`**

 **因此，如果您的查询返回 1M 行并聚合为 1k 行：

*   该`GROUP BY`查询将运行子查询 1000 次，
*   而`DISTINCT`查询将运行子查询 1000000 次。

tkprof 解释计划将有助于证明这一假设。

* * *

在我们讨论这个问题时，我认为重要的是要注意查询的编写方式对读者和优化器都有误导性：您显然希望从 item/item_transactions 中找到具有`TASK_INVENTORY_STEP.STEP_TYPE`值为 " A型”。

IMO 您的查询将有一个更好的计划，并且如果这样写会更容易阅读：

```
SELECT ITEMS.ITEM_ID,
       ITEMS.ITEM_CODE,
       ITEMS.ITEMTYPE,
       ITEM_TRANSACTIONS.STATUS,
       (SELECT COUNT(PKID) 
          FROM ITEM_PARENTS 
         WHERE PARENT_ITEM_ID = ITEMS.ITEM_ID) AS CHILD_COUNT
  FROM ITEMS
  JOIN ITEM_TRANSACTIONS 
    ON ITEMS.ITEM_ID = ITEM_TRANSACTIONS.ITEM_ID 
   AND ITEM_TRANSACTIONS.FLAG = 1
 WHERE EXISTS (SELECT NULL
                 FROM JOB_INVENTORY   
                 JOIN TASK_INVENTORY_STEP 
                   ON JOB_INVENTORY.JOB_ITEM_ID=TASK_INVENTORY_STEP.JOB_ITEM_ID
                WHERE TASK_INVENTORY_STEP.STEP_TYPE = 'TYPE A'
                  AND ITEMS.ITEM_ID = JOB_INVENTORY.ITEM_ID) 
```

在许多情况下，DISTINCT 可能表明查询编写不正确（因为好的查询不应该返回重复项）。

另请注意，原始选择中未使用 4 个表。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-19T16:40:24.860

首先应该注意的是使用`Distinct`指示代码气味，也就是反模式。这通常意味着缺少连接或生成重复数据的额外连接。查看您上面的查询，我猜想`group by`速度更快（没有看到查询）的原因是 的位置`group by`减少了最终返回的记录数。而`distinct`正在破坏结果集并进行逐行比较。

**更新接近**

> 对不起，我应该更清楚。当用户在系统中执行某些任务时会生成记录，因此没有时间表。用户可以在一天内或每小时生成数百条记录。重要的是，每次用户运行搜索时，都必须返回最新的记录，这让我怀疑物化视图是否可以在这里工作，特别是如果填充它的查询需要很长时间才能运行。

I do believe this is the exact reason to use a materialized view. So the process would work this way. You take the long running query as the piece that builds out your materialized view, since we know the user only cares about "new" data after they perform some arbitrary task in the system. So what you want to do is query against this base materialized view, which can be refreshed constantly on the back-end, the persistence strategy involved should not choke out the materialized view (persisting a few hundred records at a time won't crush anything). What this will allow is Oracle to grab a read lock (note we don't care how many sources read our data, we only care about writers). In the worst case a user will have "stale" data for microseconds, so unless this is a financial trading system on Wall Street or a system for a nuclear reactor, these "blips" should go unnoticed by even the most eagle eyed users.

如何执行此操作的代码示例：

```
create materialized view dept_mv FOR UPDATE as select * from dept; 
```

现在的关键是，只要您不调用刷新，您就不会丢失任何持久数据。由您决定何时再次“基线”您的物化视图（也许是午夜？）

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-12-19T16:34:02.967

如果只需要删除重复项，则应使用 GROUP BY 将聚合运算符应用于每个组和 DISTINCT。

我认为性能是一样的。

在你的情况下，我认为你应该使用 GROUP BY。**

# git - “git 变基 “在 git svn repo 上更改了远程跟踪目标？

> ID：13956772
> 
> 赞同：6
> 
> 时间：2012-12-19T16:27:31.693
> 
> 标签：git, svn, git-svn

我有一个 git svn 回购。我在这里有多个发布分支。我正在准备一个新版本，作为其中的一部分，我想我会从以前的版本中做一个“git rebase”来拉回任何尚未合并的更改。

所以我建立了我的分支......

```
git branch new_release remotes/svn-branches/new_release
git branch old_release remotes/svn-branches/old_release 
```

然后我做了rebase ...

```
git checkout new_release
git rebase old_release
# watch it pull a bunch of commits
git svn dcommit
    Committing to https://svn.mysvn.net/repo/releases/old_release ... 
```

在我执行“svn dcommit”之后，我差点把裤子弄脏了。它在 Subversion 中冲洗了我的旧版本分支！

为什么远程跟踪分支会因执行 rebase 而发生变化？

我该如何解决我陷入的困境？

编辑：好的，为了让自己出去，我相信我可以做到以下几点：[http ://svnbook.red-bean.com/en/1.5/svn.branchmerge.basicmerging.html#svn.branchmerge.basicmerging.undo](http://svnbook.red-bean.com/en/1.5/svn.branchmerge.basicmerging.html#svn.branchmerge.basicmerging.undo)

由于 new_release 分支上只有少数提交被拉到 old_release，我可以在 SVN 存储库上单独手动恢复它们。不过，我仍然对这里发生的事情感到困惑。

EDITx2：是的，这里有一些验证步骤。

1.  设置两个 git 分支远程跟踪到 SVN 分支
2.  查看其中一个分支
3.  运行`git svn info`并观察 URL 指向 SVN 中的正确位置
4.  跑`git rebase <other_branch>`
5.  再次运行`git svn info`并观察 URL 更改为指向 SVN 中的另一个分支位置

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T17:10:16.493

看起来你在使用 git-svn 时犯了一个常见的错误。

git-svn 中没有“跟踪分支”之类的东西。它始终通过第一父历史记录确定要提交到的分支的 URL，直到遇到带有“git-svn-id：”签名的第一次提交。此签名附近的 URL 是提交将被推送的 URL。但请注意，有一个双重检查：将签名附近的 URL 和修订与 .git/svn/refs 目录中的数据结构进行比较，如果 URL 和修订与它们相矛盾（这对于 rebase 提交是正确的，因为 rebase 不会触及那些结构），则不予考虑。所以旧的分支 URL 是第一个没有重新定位的提交 URL。

如果你想要纯粹的 Git 体验，你可以试试[SubGit](http://subgit.com/eap)作为 git-svn 的替代品。从 2.0 开始，它允许为您的 SVN 存储库创建一个可写的纯 Git 镜像，并注意同步和并发性。跑

```
$ subgit configure --svn-url <SVNURL> project.git
$ #adjust projectX.git/subgit/{config,authors.txt,passwd} 
$ subgit install project.git
$ git clone project.git project/ 
```

安装后，您可以将其用作普通的 Git 存储库。因此，对于您的示例，您运行：

```
$ git checkout new_release
$ git rebase old_release
$ git push origin new_release 
```

# python - GAE 应用程序是否会记录其发送的电子邮件？

> ID：13956774
> 
> 赞同：4
> 
> 时间：2012-12-19T16:27:36.180
> 
> 标签：python, google-app-engine

想知道是否可以查看 GAE 应用程序发送的电子邮件历史记录？需要查看历史以进行调试。

请注意，当我发送电子邮件或密件抄送用户时记录不是这个特定问题的选项，因为我好奇的时期是过去（从那时起我们正在密件抄送）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T16:57:18.657

您可以尝试以下方法之一：

# 日志

1.  每次调用 sent_mail 时将日志写入数据存储。
2.  使用模块写入日志`logging`并检查仪表板中的日志。

# 邮件

1.  在发送电子邮件时，在电子邮件的“密件抄送”字段中添加一个调试电子邮件地址。
2.  您还可以在用作发件人的电子邮件帐户中查看“已发送邮件”。

# asp.net - VS 在发布时重置 IIS 文件夹权限

> ID：13956775
> 
> 赞同：3
> 
> 时间：2012-12-19T16:27:38.933
> 
> 标签：asp.net, visual-studio-2010, webserver, iis-7.5, publish

在我将用户设置为`full permissions`在 IIS 7.5 上的网站上之后，我发布（使用 VS 2010）发现该用户的权限已重置为`read`only。

我经常发布，所以解决这个问题有什么办法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T10:48:23.267

我找到了一个保持权限不变的解决方案：

1.  共享 Web 服务器`www`文件夹
2.  `"File System"`使用发布选项发布到该文件夹​​。

但是，您必须使用正常的部署方法至少发布一次，以便在网络服务器上创建正确的帐户。

# testing - 硒发送文本

> ID：13956781
> 
> 赞同：3
> 
> 时间：2012-12-19T16:28:06.543
> 
> 标签：testing, selenium, webdriver

我需要以“我是菜鸟”作为开头。

在`WatiN`我能够使用`sendText("text");`which 将发送整个文本，而不是一次输入一个字符，这就是`sendKeys()`它的作用。我`sendText()`在 Selenium 中寻找了很多选项，但似乎找不到任何有效的方法。

是否有`sendText()`硒的选择，如果有，你能提供一个代码示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:47:16.063

在 Selenium RC（不再积极开发的旧版 JavaScript 驱动的 Selenium）中，有该[`type()`](http://selenium.googlecode.com/svn/trunk/docs/api/java/com/thoughtworks/selenium/Selenium.html#type%28java.lang.String,%20java.lang.String%29)方法。

在 WebDriver（也称为 Selenium 2）中，没有这样的东西。但是，您可以通过 JavaScript 轻松模拟它：

```
// only if your driver supports JavaScript
JavascriptExecutor js = (JavascriptExecutor)driver;

WebElement elem = driver.findElement(By.whatever("something"));
js.executeScript("arguments[0].value = 'some text'", elem); 
```

# c++ - 在OCaml中，抽象的代价有多大（即多态函数）

> ID：13956783
> 
> 赞同：10
> 
> 时间：2012-12-19T16:28:09.490
> 
> 标签：c++, polymorphism, ocaml

我仍处于学习 OCaml 的早期阶段，我很想知道从 OCaml 中的通用代码中提取最大性能的最佳方法是什么。

作为一个小实验，我编写了两个多态函数：一个在 C++ 中，另一个在 OCaml 中，用于查找给定数组中的最大元素。

我观察到的是，虽然在 C++ 中你不会为这种抽象付出任何代价，但在 OCaml 中的代价是性能下降了一个数量级。顺便说一句，我快速编写的 C++ 解决方案比 OCaml 更通用，但我主要将其归咎于我对这门语言缺乏经验。

我的问题如下：如何在 OCaml 中编写和使用多态函数而不付出我刚刚观察到的巨大性能损失？

对于这个特定问题，我观察到的另一件事是，我在 OCaml 中的函数式解决方案比命令式解决方案慢，而 C++ 中的“函数式”解决方案与模拟命令式方法相比没有受到任何惩罚。

C++ 代码`g++ -std="c++0x" -O3 -o max_cpp max.cpp`使用 gcc-4.6.3 编译，OCaml 代码使用：`ocamlopt -o max_ml max.ml`使用 ocamlopt 版本 3.12.1。生成的两个可执行文件都是 32 位并在 Ubuntu x64 11.04 上运行

我提交了两个程序的代码。

C++ 代码（当然不完全安全；））

```
#include <iostream>
#include <vector>
#include <numeric>
template <typename T> T max (T a, T b) {
     return (a>b)? a : b;
}

template <typename I> typename I::value_type find_max (I begin, I end) {
    auto max = *begin;
    for (begin++;begin!=end;begin++)
            if (*begin > max) max = *begin;
    return max;
}

template <typename I> typename I::value_type find_max1(I begin, I end) {
    return std::accumulate(begin, end, *begin, max< typename I::value_type> );
}

int main(int argc, char ** argv) {
    const size_t nElem = atoi(argv[1]);
    const size_t nIter = atoi(argv[2]);
    std::vector<int> intA(nElem);
    std::vector<double> dubA(nElem);
    for (int i=0;i<nIter;i++) {
            auto res1 = find_max(intA.begin(), intA.end());
            auto res2 = find_max(dubA.begin(), dubA.end());
            std::cout << "Max int: " << res1 << " " << "Max dub: " << res2 << std::endl;
    }
} 
```

OCaml 代码

```
let max a b = if a > b then a else b

(* functional version *)
let find_max vector =
    Array.fold_right max vector vector.(0)

(* imperative version *)
let find_max1 vector =
    let length = Array.length vector in
    let max = ref (vector.(0)) in
    for i=1 to length-1 do
            if vector.(i) > !max then max := vector.(i)
    done; max

let nElems = int_of_string Sys.argv.(1)

let nIter  = int_of_string Sys.argv.(2)

let _ = let intA = Array.make nElems 0 in
    let dubA = Array.make nElems 0.0 in
    for i=1 to nIter do
            let res1 = find_max intA in
            let res2 = find_max dubA in
            print_int !res1;
            print_newline ();
            print_float !res2;
    done 
```

但是，如果我“重载”函数来区分整数和浮点数，那么程序的性能甚至超过我的 C++ 代码的 50%！我想知道为什么。

```
let find_max_int (vector : int array) =
    let length = Array.length vector in
    let max = ref (vector.(0)) in
    for i=1 to length-1 do
            if vector.(i) > !max then max := vector.(i)
    done; max

let find_max_float (vector : float array) =
    let length = Array.length vector in
    let max = ref (vector.(0)) in
    for i=1 to length-1 do
            if vector.(i) > !max then max := vector.(i)
    done; max 
```

时间安排相当粗略地执行： `time ./max_cpp 1000000 100`和 `time ./max_ml 1000000 100`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T17:42:02.313

在 OCaml 中，比较运算符`(<)`是类型的通用函数`'a -> 'a -> bool`（同样用于相等等）。这意味着它是由运行时系统中的一个特殊原语实现的，该原语可以有效地对任何类型的数据结构进行临时比较。类型检查器能够优化整数和浮点数的单态比较到专门的比较操作，而不是在多态情况下在运行时进行类型检查。如果只测试这个操作，效率的十倍差异并不奇怪。

请注意，为了获得最大的灵活性，您应该抽象`find_max`. 然而，这会阻止单态优化，因此内联版本仍然会表现得更好。

我认为您的方法（进行微基准测试并希望学习有关真实程序性能的有趣事物）是有缺陷的。您遇到了一个非常具体的 OCaml 性能行为案例，并从那里错误地得出结论，多态函数的性能“很差”。这显然是过早优化的错误结论。为您打算运行的计算编写一个具有实际代表性的示例，然后对这段真实代码的性能进行推理。你从这类微基准测试中学到的东西很少，还有很多不相关的细节。

（然而，C++ 代码专业化方法确实可以生成比 OCaml 编译技术更高效的代码，OCaml 编译技术只为所有类型编译函数的一个版本，但必须做出相应的数据表示妥协；在 OCaml 中可能会有开销与多态性有关。但是，这仅在相当特定的情况下才能观察到，并且您通常可以在代码的小关键部分中进行特定的内联传递。您获得的回报是编译速度更快（无重复）和实际可读的错误消息——就像你可能会在 C++ 中集成概念一样。）

**编辑**：实际上我说对比较进行抽象会阻止类型导向的优化是错误的。下面的代码虽然仍然不如手动内联版本快，但仍然明显快于使用多态比较的版本：

```
let find_max1 comp vector =
    let length = Array.length vector in
    let max = ref (vector.(0)) in
    for i=1 to length-1 do
      if comp !max vector.(i) then max := vector.(i)
    done;
    !max

let find_max_int (vector : int array) = find_max1 (fun x y -> x < y) vector
let find_max_float (vector : float array) = find_max1 (fun x y -> x < y) vector 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T09:36:05.677

实际上，您是在比较编译时专用函数与运行时分派的函数。ocaml 方面更合适的代码将使用仿函数，理论上可以将间接调用的数量减少到零，但我想它仍然会受到优化不足的影响。另一个问题是数据表示是统一的，并且在任何情况下都不是针对用户类型专门/内联的。

# c# - 从 ASP.Net 客户端访问 SSO 凭据

> ID：13956785
> 
> 赞同：1
> 
> 时间：2012-12-19T16:28:24.170
> 
> 标签：c#, asp.net, web-services, single-sign-on

我有使用 asp.net web 服务的 asp.net web 应用程序。

这些 Web 服务请求必须经过身份验证才能获得任何响应。

Asp.net Web 应用程序将在 SSO 环境中运行。

如何让我的 asp.net 应用程序从 SSO 获取凭据并将这些凭据传递给 Web 服务？

谢谢，纳雷什

# php - Cakephp 不能即时更改数据库

> ID：13956791
> 
> 赞同：3
> 
> 时间：2012-12-19T16:28:36.053
> 
> 标签：php, cakephp, cakephp-2.0, cakephp-2.1, saas

我试图从一个循环中连接多个数据库，但看到 CakePHP 无法更改`database`，只有其他信息（如用户/密码/主机）。

**应用程序/配置/数据库.php**

```
<?php
class DATABASE_CONFIG {
    [...]

    public $default = array(
        [..] // Where I have the companies
    );
    public $client = array(
        [...] // Fakke settings, because I will change it on-the-fly
    );
} 
```

**应用程序/控制器/CronController.php**

```
$companies = $this->Company->find('all');
foreach($companies as $company) {
    $settings = array(
        'datasource' => 'Database/Mysql',
        'host' => $company['Company']['host'],
        'login' => $company['Company']['username'],
        'password' => $company['Company']['password'],
        'database' => $company['Company']['database'],
    );

    ConnectionManager::drop('client');
    $db = ConnectionManager::create('client', $settings);

    try {
        debug($this->MyModel->find('first'));
    } catch (Exception $e) {
        echo '<pre>';
        echo "Exception: ",  $e->getMessage(), "\n";

        /*
        debug($this->MyModel->getDataSource());

        Outputs:

        [...]
        [config] => Array
            (
                [persistent] => 
                [host] => 0.0.0.0 // CORRECT HOST
                [login] => root // CORRECT LOGIN
                [password] => pass // CORRECT PASSWORD
                [database] => database1
                [port] => 3306
                [datasource] => Database/Mysql
                [prefix] => 
                [encoding] => utf8
            )
        [...]
        */
    }
} 
```

它返回第一个连接和所有其他连接，我无法从 MyModel 中选择任何内容，因为它是错误的。它看到来自用户/密码/主机的连接是好的，但是，数据库没有改变，所以，因为用户没有在 cdatabase 上选择的权限，我得到了错误。

```
Array
(
    // First connection, connection ok, MyModel return nothing
)

// Second connection
Exception: SQLSTATE[42000]: Syntax error or access violation: 1142 SELECT command denied to user 'database_user_2'@'localhost' for table 'my_model'

// Third connection
Exception: SQLSTATE[42000]: Syntax error or access violation: 1142 SELECT command denied to user 'database_user_3'@'localhost' for table 'my_model'

// Fourth connection
Exception: SQLSTATE[42000]: Syntax error or access violation: 1142 SELECT command denied to user 'database_user_4'@'localhost' for table 'my_model'

// Fifth connection
Exception: SQLSTATE[42000]: Syntax error or access violation: 1142 SELECT command denied to user 'database_user_5'@'localhost' for table 'my_model' 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T18:24:25.180

尽量不要删除配置，只需更改您需要的东西。

对于此任务，我成功使用

```
$dataSource = ConnectionManager::getDataSource('company_data');
$dataSource->config['schema'] = 'company_'.$id; 
```

我不知道数据库切换和 mysql 作为引擎是否是好的一对。为此，我使用 postgresql 模式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:04:28.390

您可以使用模型方法[setSource()](http://api.cakephp.org/class/model#method-ModelsetSource)来更改表或[setDataSource()](http://api.cakephp.org/class/model#method-ModelsetDataSource)来更改数据库配置。

# java - 便携式wifi热点的Android DHCP机制

> ID：13956796
> 
> 赞同：2
> 
> 时间：2012-12-19T16:28:53.323
> 
> 标签：java, android, android-networking

当我打开 Android Wifi 热点时，其他人会加入我的网络并获取 IP 地址。

1.  在我的手机和客户端之间分配 IP 地址的机制如何？
2.  那么我需要配置电话系统中的任何方法（Java、Android）或任何文件来更改我的 IP 地址（作为服务器 IP 地址）和 DHCP IP 范围？

# sql-server - 将 sql 脚本转换为 mdf

> ID：13956813
> 
> 赞同：-1
> 
> 时间：2012-12-19T16:29:47.303
> 
> 标签：sql-server

我正在做一个明天必须上交的项目。对于这个项目，我使用在远程服务器上运行的 SQL Server Express 数据库。

现在，我需要`.mdf`从远程数据库生成一个文件。我到处搜索，我找不到合适的解决方案。

我已将数据库脚本编写到一个`.sql`文件中，但我找不到针对本地`.mdf`文件执行它的方法。我可以创建一个`.sdf`不起作用的，或者连接到数据库引擎。

帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:33:08.483

`.mdf`是 SQL Server 的数据文件格式。

所以你需要这些步骤：

1.  连接到您的本地服务器
2.  创建一个新的数据库
3.  针对它运行`.sql`脚本
4.  分离该数据库

现在，完成所有步骤后，您可以将生成的`.mdf`文件从 SQL Server 数据目录复制到其他地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:34:10.817

不，您不能从远程数据库生成 MDF 文件。
您可以使用如下脚本创建本地数据库：

```
CREATE DATABASE [test_db] ON  PRIMARY 
( NAME = N'test_db', FILENAME = N'D:\MSSQL\test_db.mdf' , SIZE = 3072KB , FILEGROWTH = 1024KB )
 LOG ON 
( NAME = N'test_db_log', FILENAME = N'D:\MSSQL\test_db_log.ldf' , SIZE = 1024KB , FILEGROWTH = 10%)
GO
ALTER DATABASE [test_db] SET COMPATIBILITY_LEVEL = 100
GO
ALTER DATABASE [test_db] SET ANSI_NULL_DEFAULT OFF 
GO
ALTER DATABASE [test_db] SET ANSI_NULLS OFF 
GO
ALTER DATABASE [test_db] SET ANSI_PADDING OFF 
GO
ALTER DATABASE [test_db] SET ANSI_WARNINGS OFF 
GO
ALTER DATABASE [test_db] SET ARITHABORT OFF 
GO
ALTER DATABASE [test_db] SET AUTO_CLOSE OFF 
GO
ALTER DATABASE [test_db] SET AUTO_CREATE_STATISTICS ON 
GO
ALTER DATABASE [test_db] SET AUTO_SHRINK OFF 
GO
ALTER DATABASE [test_db] SET AUTO_UPDATE_STATISTICS ON 
GO
ALTER DATABASE [test_db] SET CURSOR_CLOSE_ON_COMMIT OFF 
GO
ALTER DATABASE [test_db] SET CURSOR_DEFAULT  GLOBAL 
GO
ALTER DATABASE [test_db] SET CONCAT_NULL_YIELDS_NULL OFF 
GO
ALTER DATABASE [test_db] SET NUMERIC_ROUNDABORT OFF 
GO
ALTER DATABASE [test_db] SET QUOTED_IDENTIFIER OFF 
GO
ALTER DATABASE [test_db] SET RECURSIVE_TRIGGERS OFF 
GO
ALTER DATABASE [test_db] SET  DISABLE_BROKER 
GO
ALTER DATABASE [test_db] SET AUTO_UPDATE_STATISTICS_ASYNC OFF 
GO
ALTER DATABASE [test_db] SET DATE_CORRELATION_OPTIMIZATION OFF 
GO
ALTER DATABASE [test_db] SET PARAMETERIZATION SIMPLE 
GO
ALTER DATABASE [test_db] SET  READ_WRITE 
GO
ALTER DATABASE [test_db] SET RECOVERY FULL 
GO
ALTER DATABASE [test_db] SET  MULTI_USER 
GO
ALTER DATABASE [test_db] SET PAGE_VERIFY CHECKSUM  
GO
USE [test_db]
GO
IF NOT EXISTS (SELECT name FROM sys.filegroups WHERE is_default=1 AND name = N'PRIMARY') ALTER DATABASE [test_db] MODIFY FILEGROUP [PRIMARY] DEFAULT
GO 
```

然后运行你的 sql 脚本来创建表并用你的数据填充它们。
在此之后，您有两个选择。

*   在您的客户机器上重复该过程
*   分离数据库并将 MDF 和 LDF 文件提供给您的客户，然后尝试重新附加它

（当然这里假设两个SqlServer使用相同的版本）

# mongodb - MongoDB 无法更新值

> ID：13956818
> 
> 赞同：0
> 
> 时间：2012-12-19T16:29:55.450
> 
> 标签：mongodb, pymongo

如果值为空，我正在尝试转换记录中的某些字段。我现在可以返回那些具有空值的记录，但我不确定如何更新每条记录。这是我的代码（Python + pyMongo）：

```
from geopy import geocoders, distance
from pymongo import Connection
import time

db=Connection().blah
coll = db.tweet_info

cursor = coll.find(
                {"$and": [
                            {"coordinates": {"$type":10}}, 
                            {"place": {"$ne": None}}
                    ]}, 
            {"coordinates": 1, "place": 1, "time_normal": 1, "_id":1}, tailable = True, timeout = False)

g = geocoders.Google()

while cursor.alive:
    counter=0
    try:
        doc = cursor.next()
        your_id = doc['_id']
        if not doc['coordinates']:
            counter+=1
            print doc  
            placeName = doc['place']['full_name']
            loc = g.geocode(placeName)
            coll.update({"_id" : your_id},{"$set": {"coordinates": loc}})             
            time.sleep(0.15)                        
        else: 
            pass

    except (ValueError, geocoders.google.GQueryError):
        pass

    except StopIteration:
        break 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T17:02:54.803

当您需要更新时，要更新什么文档，以及将实际字段更新到什么：

```
coll.update({... find ...},
{... update to ...}
) 
```

要进行更新，您需要指定要更新的文档，因此首先您必须获取`_id`：

`"_id": 1,`// 在这里附加：`{"coordinates": 1, "place": 1, "time_normal": 1}`

然后在一段时间内，您必须从游标中获取`_id`最终更新应如下所示：

```
coll.update({"_id" : your_id}, // 
    {"$set": {"coordinates": loc}}
    ) 
```

（在您发表评论后才意识到）

# django - 如何在 django 中获取当前登录的用户配置文件到模型中？

> ID：13956819
> 
> 赞同：0
> 
> 时间：2012-12-19T16:29:59.203
> 
> 标签：django, django-models

如何在 django 中获取当前登录的用户配置文件到模型中？

我有这个代码：

```
def save(self, *args, **kwargs):
        profile = User.get_profile()
        self.empresa_id =   profile.idempresa
        self.empresa_id =  profile.id_comerx3c
        super(Cliente, self).save(*args, **kwargs) 
```

但不起作用..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:48:58.360

如果您使用的是 ModelForm，则有以下三种选择：

1.  实例化表单时设置配置文件
2.  在视图中创建对象实例，但不提交，然后设置配置文件属性并提交保存
3.  将配置文件传递给 save 方法，并在调用 super 之前设置属性

如果你只是处理一个模型，你有两个选择：

1.  实例化对象时传入配置文件
2.  在调用 save 之前在对象实例上设置配置文件

# r - 如何在使用 R 的缺失值之前获取列中最后 10 个值的平均值？

> ID：13956820
> 
> 赞同：3
> 
> 时间：2012-12-19T16:30:01.517
> 
> 标签：r, moving-average

我是 R 新手，无法解决这个问题。我有按年份组织的死树的树木生长率数据。所以，我的第一列是年份，右边的列是单棵树的增长率，以每棵树死亡的年份结束。树死后，数据集中剩余年份的值为“NA”。我需要取每棵树死亡前 10 年的平均增长，但每棵树在不同的年份死亡。有谁知道如何做到这一点？以下是数据集的示例：

```
Year    Tree1   Tree2   Tree3
1989    53.00   84.58   102.52
1990    63.68   133.16  146.07
1991    90.37   103.10  233.58
1992    149.24  127.61  245.69
1993    96.20   54.78   417.96
1994    230.64  60.92   125.31
1995    150.81  60.98   100.43
1996    124.25  42.73   75.43
1997    173.42  67.20   50.34
1998    119.60  73.40   32.43
1999    179.97  61.24   NA
2000    114.88  67.43   NA
2001    82.23   55.23   NA
2002    49.40   NA  NA
2003    93.46   NA  NA
2004    104.67  NA  NA
2005    44.14   NA  NA
2006    88.40   NA  NA 
```

所以，我需要计算的平均值是：

```
Tree1: mean(1997-2006) = 105.01
Tree2: mean(1992-2001) = 67.15
Tree3: mean(1989-1998) = 152.98 
```

由于我需要对大量树执行此操作，因此拥有一种自动计算的方法会很有帮助。非常感谢您的帮助！凯蒂

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-19T16:41:18.663

您可以使用`sapply`和`tail`一起使用`na.omit`如下：

```
sapply(mydf[-1], function(x) mean(tail(na.omit(x), 10)))
#   Tree1   Tree2   Tree3 
# 105.017  67.152 152.976 
```

`mydf[-1]`说要删除第一列。`tail`有一个参数 ，可让您从数据的*末尾*（尾部）`n`指定要多少个值。在这里，我们将其设置为“10”，因为您需要最后 10 个值。然后，假设在树还活着的时候你的实际数据中没有值，你可以安全地使用你的数据。*`NA``na.omit`*

# api - 如何使用第一版 api 获取项目和 sprint 燃尽图？

> ID：13956826
> 
> 赞同：4
> 
> 时间：2012-12-19T16:30:32.057
> 
> 标签：api, agile, versionone

我正在尝试使用[第一版](http://www.versionone.com/)api 来获取项目和 sprint 燃尽图。

我正在阅读[此页面](https://community.versionone.com/Developers/Developer-Library/Documentation/API/Data_API_Guide)，但我只是感到困惑。

有没有人做过类似的事情，并且有任何关于如何点击 api 来获得我想要的东西的提示？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T18:21:43.777

VersionOne api 不提供图像或图表特定数据。您可以使用查询语言和其余端点来生成燃尽所需的数据。您需要能够读取/解析数据并自己生成图表。

话虽如此，燃尽图比较了多少封闭的估计​​与多少开放的估计，并随着时间的推移绘制图表。所以你需要知道三个数据：开放估计、封闭估计和时间。您还希望将其限制为某个项目（以及它的子项目）。

这应该让您接近项目燃尽所需的数据：

```
http://<host>/VersionOne/rest-1.v1/Data/Timebox?where=Schedule.ScheduledScopes='Scope:1055'&sel=Name,BeginDate,EndDate,Workitems:Story[AssetState!='Closed'].Estimate.@Sum,Workitems:Story[AssetState='Closed'].Estimate.@Sum&sort=+EndDate 
```

请务必将 Scope:1055 更改为您感兴趣的项目 oid。

* * *

这就是我到达那里的方式。首先我在想“你需要总结一堆故事估计”所以我想我会对故事进行历史查询：

```
http://<host>/VersionOne.Web/rest-1.v1/Hist/Story?where=Scope.ParentMeAndUp='Scope:1055' 
```

但很快发现你不能在你的根上聚合。这意味着如果我想总结估计，我需要使用 Project (scope) 之类的东西来获取数据：

```
http://<host>/VersionOne.Web/rest-1.v1/Hist/Scope/1055?sel=Workitems:Story[AssetState!='Closed'].Estimate.@Sum,Workitems:Story[AssetState='Closed'].Estimate.@Sum,ChangeDate 
```

这个查询的问题是给你在奇怪的时间间隔内封闭和开放的估计是什么样子的；即每当项目发生变化时。所以它不会成为一个非常漂亮的图表。

但正如您所知，VersionOne 有一个与项目相关联的迭代和计划的概念，而故事与迭代相关联。所以我用它作为查询和汇总故事估计的根，并将数据限制在使用该时间表的项目中。

生成的数据更规则（按迭代分组）并包含正确聚合的估计数据。

* * *

那么还剩下什么？您必须聚合估算数据的聚合以获得项目的总估算数。然后您需要生成一个图表（可能是条形图或线形图），其中每个数据点都位于迭代结束时。您将保持关闭估计的运行总计并将其添加到迭代的总计中以生成数据点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-29T19:08:28.320

You need to do multiple queries to produce a burndown. First find the date range for the burndown:

```
/Data/Timebox?sel=BeginDate,EndDate&where=Name='X' 
```

Now for every day the date range, sum up the ToDo hours as of that point in history:

```
/Hist/Timebox?asof=2013-08-09T23:59:59&where=Name='X'&sel=Workitems[Team.Name='Y';AssetState!='Dead'].ToDo.@Sum 
```

The API and documentation are excellent. If you are interested in seeing the code for some custom reports, check out [https://github.com/timothypratley/vone/blob/master/src/vone/models/queries.clj](https://github.com/timothypratley/vone/blob/master/src/vone/models/queries.clj) (the code is in Clojure). There is a burndown, cumulative flow, and more :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-03T12:24:17.560

现在有一个“配方”来[查询](https://community.versionone.com/Developers/Developer-Library/Recipes/Query_for_Burndown_Data)与[query.v1](https://community.versionone.com/Developers/Developer-Library/Recipes/Tour_of_query.v1) API 端点一起使用的燃尽数据。

# ios - 如何在 telpromt Confirm call alertview 中自动确认通话

> ID：13956829
> 
> 赞同：0
> 
> 时间：2012-12-19T16:30:46.383
> 
> 标签：ios, uialertview, telprompt

我试图通过 telpromt 命令拨打电话：

[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"telprompt://123456789"]];

问题是，当 de 代码运行时，它显示一个 UIAlertView 不是我的财产，要求确认调用。它有按钮：取消和呼叫。我想以编程方式按下 AlertView 中的呼叫按钮。

可能吗 ？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:37:52.597

iOS 这样做是为了保护用户免受恶意应用程序的影响，这些应用程序会尝试进行随机调用。任何时候与电话、短信、推特、脸书等集成。苹果要求用户接受并允许应用程序执行操作。这就是为什么 iPhone 会显示`UIAlertView`询问用户是否真的想拨打您提供的电话号码的原因。

# java - 用Java（UDP）为MANet编程路由协议

> ID：13956831
> 
> 赞同：0
> 
> 时间：2012-12-19T16:30:52.407
> 
> 标签：java, mobile, udp, protocols, distributed

我正在用 JAVA 编写移动自组织网络路由协议（使用 UDP）。该路由协议由环形拓扑（每个节点作为一个前驱节点和一个后继节点）组成。首先，我将一个发送器（一个线程）和一个接收器（一个线程）组合成一个节点。但是，我面临一些问题，例如：

1.  我希望第三个节点可以监听从一个节点到另一个节点的传输。例如，节点 A 向节点 B 发送一个数据包，如果节点 C 在节点 A 的范围内，那么它也可能会监听该传输。

2.  我会为每个环设置一个频道以减少干扰。但是，我不知道应该使用哪种 java 网络 API 机制。

    我会得到你的指导。提前谢谢你（对不起我的英语不好）！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:37:25.903

```
Per example, node A sends a packet to node B, and if node C is in the range of node A then it might listen that transmission too. 
```

这是无线自组织网络的预期行为。如果 C 不是目的地（根据 MA​​C 地址），您可以丢弃收到的消息。

> 我会为每个环设置一个频道以减少干扰。

每个环一个通道会相反地增加干扰，特别是如果您期望高负载和许多消息被路由。但是管理单通道要容易得多。

您需要更多地考虑您的环境和要求。

*   您是否在 MAC 级别使用 802.11？
*   您想要可靠的保证交付吗？

# ant - 如果过滤器令牌不存在或令牌未被替换，则 Ant 失败

> ID：13956832
> 
> 赞同：0
> 
> 时间：2012-12-19T16:30:57.803
> 
> 标签：ant

`build.xml`在 Ant 中，如果在复制文件时没有发生特定令牌的令牌替换，那么有没有人知道一种简洁的方法来解决失败。即，在文件中找不到令牌，因此没有被替换。

这背后的想法是，在某些情况下，替换某些标记可​​能对标记化文件至关重要，因此值得验证这些标记是否存在于文件中 - 默认情况下，如果标记不存在，Ant 将不执行任何操作不在那里。

我查看了文档`filter`，`filterset`但如果搜索的令牌不存在，它们似乎没有失败的属性。

也许这可以通过正则表达式任务来检查令牌是否存在。人们能想到更简洁的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:40:16.450

你绝对可以这样做：

[蚂蚁过滤 - 如果未设置属性则失败](https://stackoverflow.com/questions/226683/ant-filtering-fail-if-property-not-set)

```
<loadfile property="all-build-properties" srcFile="build.properties"/>
<condition property="missing-properties">
    <matches pattern="@[^@]*@" string="${all-build-properties}"/>
</condition>
<fail message="Some properties not set!" if="missing-properties"/> 
```

杰森戴的所有权利

dovetalk 解决方案也很好：

```
<fail unless="my.property">
    Computer says no. You forgot to set 'my.property'!
</fail> 
```

# module - Fortran：固定形式源中的整个数组操作

> ID：13956834
> 
> 赞同：4
> 
> 时间：2012-12-19T16:31:01.717
> 
> 标签：module, segmentation-fault, fortran

我一遍又一遍地收到“分段错误”错误，同时使用我的子例程（我已将它们全部放在 MODULE 中）和以固定格式源编写的代码（在 fortran77 天内）。

原来的make文件（Linux平台）是一团糟，它只编译“.f”源，所以我不得不将我的文件扩展名从“.f90”更改为“.f”，并将前7列留空我的模块。我的模块广泛使用整个数组操作和数组部分的操作，并且我以 F90 样式声明变量，其中许多是假定大小的数组。

**我的问题：-**尽管编译器编译这些模块（具有整个数组/数组部分操作）而没有任何警告/错误，但是由于使用具有整个数组/数组部分操作的模块，这是“分段错误”（保存在 .f 文件中）在遗留代码中？

例如，我在“algebra.f”模块中编写了以下代码：

```
 function dyad_vv(v1,v2)     !dyadic product of two vectors
    real*8, dimension(:)::v1,v2
    real*8, dimension(size(v1,1),size(v2,1))::dyad_vv
    integer i,j
    do i=1,size(v1,1)
    do j=1,size(v2,1)
    dyad_vv(i,j)=v1(i)*v2(j)
    end do 
    end do
    end function
    !==================================        
    function dot_mv(m,v)   !dot product of a matrix and a vector
    real*8, dimension(:,:)::m
    real*8, dimension(:)::v
    real*8, dimension(size(m,1))::dot_mv
    integer i,j
    do i=1,size(m,1)
    dot_mv(i)=0.0000D0
    do j=1,size(v,1)
    dot_mv(i)=dot_mv(i)+m(i,j)*v(j)
    end do 
    end do        
    end function
    !==================================        
    function dot_vm(v,m)  !dot product of a vector and a matrix
    real*8, dimension(:)::v
    real*8, dimension(:,:)::m
    real*8, dimension(size(m,2))::dot_vm
    integer i,j
    do i=1,size(m,2)
    dot_vm(i)=0.0000D0
    do j=1,size(v,1)
    dot_vm(i)=dot_vm(i)+v(j)*m(j,i)
    end do 
    end do                
    end function 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T17:23:40.170

扩展一下我已经过长的评论：

Fortran 程序中的分段错误通常源于 (a) 尝试访问数组边界之外的数组元素，或 (b) 过程实际参数和伪参数不匹配。

幸运的是，聪明地使用你的编译器可以帮助你发现这两种情况。对于 (a) 您需要打开运行时数组边界检查，对于 (b) 您需要打开编译时子例程接口检查。您的编译器手册会告诉您需要设置哪些标志。

现代 Fortran 的优点之一，特别是您可以*免费*`modules`检查过程接口，编译器会在编译时检查虚拟参数和实际参数是否匹配。

 *所以我不认为你的问题直接源于以固定源代码形式编写现代 Fortran。但是我确实认为以固定源代码形式编写现代 Fortran 以避免重写您的 makefile 并避免升级某些 FORTRAN77 是一种非常不正当的活动，您会在短期内发现它很痛苦，从长远来看会后悔你继续开发退化的代码。

正视它，现在重构。*

# azure - RoleEnvironment.Changing 事件不会在 WorkerRole 中触发

> ID：13956838
> 
> 赞同：4
> 
> 时间：2012-12-19T16:31:13.747
> 
> 标签：azure, azure-worker-roles

所以，我有 3 个 WebRoles 和 1 个 WorkerRole 的 Azure 项目。在每个项目中，我都订阅了 RoleEnvironment.Changing 和 RoleEnvironment.Changed 事件。在 WebRole 中一切都很好，但在 WorkerRole 中这些事件不想触发。

Мreover 当我改变一些 WebRole 的设置时，**WorkerRole 也每次都在回收**

WorkerRole 在内部运行另一个 x86 进程并在启动时编写脚本

使用 Azure SDK 1.7

```
<WorkerRole name="MyService" vmsize="Medium" enableNativeCodeExecution="true">
    <Startup>
      <Task commandLine="startup.cmd" taskType="simple" executionContext="elevated" />
    </Startup>
    <Runtime executionContext="elevated" />
    <Imports>
      <Import moduleName="Diagnostics" />
      <Import moduleName="RemoteAccess" />
    </Imports>
    <Endpoints>
      <InputEndpoint name="Endpoint1" protocol="http" port="8081" />
      <InputEndpoint name="TCPEndpoint" protocol="tcp" port="10101" localPort="10100" />
      <InternalEndpoint name="InternalEndpoint" protocol="http" />
    </Endpoints>
    <ConfigurationSettings>
      <Setting name="StorageConnectionString" />
      <Setting name="TransactionLogsBlobContainer" />
    </ConfigurationSettings>
    <LocalResources>
      <LocalStorage name="DiagnosticStore" cleanOnRoleRecycle="false" sizeInMB="8192" />
    </LocalResources>
  </WorkerRole> 
```

有人知道会发生什么吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-07T21:20:53.170

对于工作角色，您必须定义一个**内部端点**（即使您实际上并未使用它），以便获取某些事件。

IE，将其添加到您的 CSDef：

更多详细信息：http: [//blogs.msdn.com/b/windowsazure/archive/2011/01/04/responding-to-role-topology-changes.aspx](http://blogs.msdn.com/b/windowsazure/archive/2011/01/04/responding-to-role-topology-changes.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:33:44.570

我遇到了类似的问题，发现`taskType`将启动任务从*提升*到*后台*更改解决了我的问题。我建议从那里开始。

```
<Startup>
  <Task commandLine="startup.cmd" executionContext="elevated" taskType="background"></Task>
</Startup> 
```

# c# - MVC 通用存储库/工作单元模式 - 扩展存储库

> ID：13956841
> 
> 赞同：1
> 
> 时间：2012-12-19T16:31:36.990
> 
> 标签：c#, asp.net-mvc, entity-framework, repository-pattern, unit-of-work

假设我有以下实现：

```
//Generic repository.
public interface IRepository<T> where T : class {
   void Insert(T entity);
   void Delete(int id);
   void SaveChanges();
   //..more generic functions
}

//Repository implementation.
public class EFRepository<T> : IRepository<T> where T: class {
   private MyDbContext context;
   protected DbSet<T> dbSet;

   public EFRepository(): this(new MyDbContext()){}

   public EFRepository(MyDbContext context)
   {
      this.context = context;
      dbSet = context.Set<T>();
   }

   public void Insert(T entity)
   {
      dbSet.Add(entity);
   }

   public void Delete(int id)
   {
      dbSet.Remove(dbSet.Find(id));
   }

   public void SaveChanges()
   {
      context.SaveChanges();
   }
   //...more generic implementations
}

//Unit of Work Interface
public interface IUnitOfWork: IDisposable
{
   IRepository<EntityA> ARepository { get; }
   IRepository<EntityB> BRepository { get; }
   //...more stuff
}

//Unit of Work Implementation
public class EFUnitOfWork: IUnitOfWork
{
   private MyDbContext context = new MyDbContext();

   private IRepository<EntityA> aRepository;
   private IRepository<EntityB> bRepository;

   public IRepository<EntityA> ARepository 
   {
      get
      {
            if (this.aRepository == null)
               this.aRepository = new EFRepository<EntityA>(context);

            return this.aRepository;
      }

   }

   public IRepository<EntityB> BRepository 
   {
      get
      {
            if (this.bRepository == null)
               this.bRepository = new EFRepository<EntityB>(context);

            return this.bRepository;
      }

   }

   //...more stuff
} 
```

最后，我的解析器中有以下绑定：

```
kernel.Bind(typeof(IRepository<>)).To(typeof(EFRepository<>));
kernel.Bind(typeof(IUnitOfWork)).To(typeof(EFUnitOfWork)); 
```

现在，我的问题是......我将如何扩展 EntityA 的存储库，以便它具有比通用操作更多的操作？

我会在几篇文章中发布我到目前为止所拥有的...

编辑：这是我到目前为止所拥有的：

```
//New interface.
public class IEntityARepository : IRepository<EntityA>
{
   void DoSomethingSpecificToEntityA();
}

//New implementation.
public class EFEntityARepository : EFRepository<EntityA>
{
   public EFEntityARepository(MyDbContext context) : base(context) {}
   //add additional methods for EntityA
   public void DoSomethingSpecificToEntityA()
   {

   }

}

//Modify Unit of Work Interface as follows.
//Unit of Work Interface
public interface IUnitOfWork: IDisposable
{
   IEntityARepository  ARepository { get; }
   IRepository<EntityB> BRepository { get; }
   //...more stuff
}

//Modify Unit of Work Implementation as follows.
public class EFUnitOfWork: IUnitOfWork
{
   private MyDbContext context = new MyDbContext();

   private IEntityARepository  aRepository;
   private IRepository<EntityB> bRepository;

   public IEntityARepository   ARepository 
   {
      get
      {
            if (this.aRepository == null)
               this.aRepository = new EFEntityARepository<EntityA>(context);

            return this.aRepository;
      }

   }

   public IRepository<EntityB> BRepository 
   {
      get
      {
            if (this.bRepository == null)
               this.bRepository = new EFRepository<EntityB>(context);

            return this.bRepository;
      }

   }

   //...more stuff
} 
```

添加以下绑定：

```
kernel.Bind(typeof(IEntityARepository)).To(typeof(EFEntityARepository)); 
```

但是，我确信这是不正确的。或者至少，不是正确的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:38:30.923

如果我对您的理解正确，您可以像这样从通用类的特定类型版本中派生出...

```
public class EFEntityARepository : EFRepository<EntityA>, IEntityARepository 
{
    //Add more opps
} 
```

我认为工作单元需要如下所示：

```
 public IEntityARepository   ARepository 
   {
      get
      {
            if (this.aRepository == null)
               this.aRepository = new EFEntityARepository(context);

            return this.aRepository;
      }

   } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T17:44:52.697

好的，我已经通过添加和/或修改我的原始代码来使其工作，如下所示：

```
//New interface for the extension of the repository.
//Is it possible to do this without defining this new interface? Doesn't seem like it.
public class IEntityARepository : IRepository<EntityA>
{
   void DoSomethingSpecificToEntityA();
}

//Add new class.
//It looks like you have to inherit from IEntityARepository as well.
public class EFEntityARepository : EFRepository<EntityA>, IEntityARepository
{

   public EFEntityARepository(MyDbContext context) : base(context) {}

   //add additional methods for EntityA
   public void DoSomethingSpecificToEntityA()
   {

   }

}

//Modify Unit of Work Interface as follows.
public interface IUnitOfWork: IDisposable
{
   IEntityARepository ARepository { get; }
   IRepository<EntityB> BRepository { get; }
   //...more stuff
}

//Modify Unit of Work Implementation as follows.
public class EFUnitOfWork: IUnitOfWork
{
   private MyDbContext context = new MyDbContext();

   private IEntityARepository aRepository;
   private IRepository<EntityB> bRepository;

   public IEntityARepository ARepository 
   {
      get
      {
            if (this.aRepository == null)
               this.aRepository = new EFEntityARepository(context);

            return this.aRepository;
      }

   }

   public IRepository<EntityB> BRepository 
   {
      get
      {
            if (this.bRepository == null)
               this.bRepository = new EFRepository<EntityB>(context);

            return this.bRepository;
      }

   }

   //...more stuff
} 
```

它有效......但这是最好的方法吗？

# java - 试图获得 mvn jboss-as:start for Jboss 但不工作

> ID：13956848
> 
> 赞同：0
> 
> 时间：2012-12-19T16:32:15.100
> 
> 标签：java, spring, maven, jboss

从 Tomcat 迁移到 JBoss AS 7 .. 我需要有关 maven 运行的帮助 .. 我下载并运行了 JBoss AS7 并且从命令行我可以做一个

**mvn jboss-as:deploy**在运行的 JBoss AS 7 上部署我的项目，但我正在尝试开始工作

**mvn jboss-as:start**将启动 JBoss AS7 但这不起作用...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:53:06.190

这个

> mvn jboss-as:start

不是[JBoss AS 7 maven 插件目标](https://docs.jboss.org/jbossas/7/plugins/maven/latest/plugin-info.html)之一。我想你想要的是：

> mvn jboss-as:run

# jquery - 直接链接到扩展的 jQuery 汇总框

> ID：13956849
> 
> 赞同：0
> 
> 时间：2012-12-19T16:32:19.797
> 
> 标签：jquery, html, expander

我正在使用 Karl Swedberg ( [http://jjnursingnotes.com/DEC12/jquery.summarize.js](http://jjnursingnotes.com/DEC12/jquery.summarize.js) ) 的汇总 jQuery 插件来包含时事通讯文章 ( [http://jjnursingnotes.com/DEC12/](http://jjnursingnotes.com/DEC12/) ) 并希望链接到这些文章中的每一篇都是外部的。简单地给元素一个链接名称#001 是行不通的，因为我希望该框在单击链接时自动展开。

目前，我使用的链接如下所示：

```
<a href="http://jjnursingnotes.com/DEC12?section=01"> 
```

...和 ​​div 层看起来像这样：

```
<div class="expandable" id="sect01"> 
```

...我正在使用的 javascript 看起来像这样：

```
<script type="text/javascript">
    // Redirect to Appropriate Section
    var urlParams = {};
    (function() {
        var match,
        pl     = /\+/g,  // Regex for replacing addition symbol with a space
        search = /([^&=]+)=?([^&]*)/g,
        decode = function(s) { return decodeURIComponent(s.replace(pl, " ")); },
        query  = window.location.search.substring(1);

        while(match = search.exec(query))
            urlParams[decode(match[1])] = decode(match[2]);
    })();

    $(document).ready(function() {
        if(urlParams['section'] != '') {
            $("#sect" + urlParams['section']).find(".read-more a").click();
            $('body,html').animate({scrollTop: $("#sect" + urlParams['section']).offset().top}, 500);
        }
    });
</script> 
```

问题是这根本不起作用，我不知道为什么！有什么想法吗？

谢谢！

# process - AutoIT 检查进程是否在远程 PC 上运行

> ID：13956852
> 
> 赞同：1
> 
> 时间：2012-12-19T16:32:24.107
> 
> 标签：process, autoit, wmi-query

我目前有一些 AutoIT 代码将终止远程机器上的进程，但我需要找到一种方法来添加检查以查看进程是否首先运行。花了一些时间筛选 AutoIT 论坛和谷歌后，我不知所措。这是我目前拥有的：

```
Func EndProc()
$oWMIService = ObjGet("winmgmts:\\" & $ipAddress & "\root\CIMV2")

If Not IsObj($oWMIService) Then
    MsgBox(48, "ERROR", "Couldn't locate the computer. Please make sure you've selected the correct computer and try again.")
    Return
EndIf

Dim $handle, $colProc, $cProc
$cProc = $oWMIService.ExecQuery('SELECT * FROM Win32_Process WHERE Name = "' & $ProcessToKill & '"')

For $oProc In $cProc
    $oProc.Terminate()
 Next
If $handle Then
    Return $handle
Else
    Return 0
EndIf
EndFunc ; Func EndProc() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:07:28.320

您可能想查看[此处](http://www.autoitscript.com/forum/topic/132420-checking-if-powerpoint-process-is-working-on-a-remote-computer/)的示例，有许多不同的方法可以通过 AutoIT 使用 WMI 来检索远程运行的进程列表并过滤您关心的进程。

或者，通过 AutoIT 调用[PSList](http://technet.microsoft.com/en-us/sysinternals/bb896682)也可能很有用。

# android - 在原生 c 中的 android ics 中绘制复杂文本

> ID：13956861
> 
> 赞同：4
> 
> 时间：2012-12-19T16:32:46.737
> 
> 标签：android, android-ndk, icu, skia, indic

注意：我的整个 senario 仅适用于 android 版本的 ICS。

我的目标是渲染具有复杂脚本/印度脚本的文本。在 ICS 中，此功能已添加到 WebView（以及浏览器）中。如果在 Browser 或 WebView 中呈现任何指示文本，则它会正确呈现。但在其他小部件（TextView、EditText）中，它呈现损坏。

现在我的目标是重新使用代码在 webcore 中正确绘制 indic 文本，并使用该代码在自定义小部件中绘制 indic 文本。

我还在浏览器中使用 HTML5 画布进行了测试，它可以很好地呈现 indic 文本。我已经测试了 android 的 android.graphics.Canvas 并且它无法正确呈现 indic 文本。

[libskia](http://code.google.com/p/skia)严重缺乏文档，所以我无法弄清楚如何使用它来呈现文本。

我检查了 libwebcore.so 的 objdump，发现它依赖于 lib“skia”“libicu”。所以我假设我可以使用这些库绘制印度文字。

谁能建议我如何使用skia和icu绘制印度文字？或者任何人都可以指向 libwebcore 中的特定代码段吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T04:39:50.290

有几个常用的替代文本堆栈，但都没有通过 Android NDK 直接公开。在基础级别，您需要：

1.  将您的文本分成单个脚本、单个字体、单个方向、单个行的运行。
2.  将每次运行中的字符序列转换为字形序列。
3.  在 2D 空间中布置这些字形，如果您的换行不成功，可能会返回到步骤 (1)。
4.  栅格化所选位置的字形。

最流行的堆栈大约是 (1) fribidi，(2) harfbuzz-ng，(3) 更多 harfbuzz-ng，(4) libfreetype。所有这些项目都很容易在 Android 上运行；文档质量参差不齐。

还有一个 Pango 项目，它位于刚刚描述的堆栈之上，但提供了更高级别的接口。不幸的是，Pango 有很多依赖项，因此合并 Pango 可能比直接使用堆栈更费力。如果没有别的，Pango 可以作为如何使用堆栈的很好的文档。

作为替代堆栈，libicu 的各个部分可以替换 fribidi、harfbuzz-ng 和 Pango（最后一个几乎没有文档化的 ParagraphLayout 类）；你仍然需要 libfreetype 来实际处理字体和光栅化。请注意，libicu 的部分内容正在转移到 harbuzz-ng，因此这些堆栈并不完全不同；虽然 libicu 的某些部分都非常出色且定期更新，但其他部分则比较模糊。

# html - html5 搜索输入不适用于引导程序

> ID：13956868
> 
> 赞同：36
> 
> 时间：2012-12-19T16:33:22.807
> 
> 标签：html, twitter-bootstrap

我已经测试过，当应用引导样式时`input[type="search"]`它没有显示清除图标。`(x)`

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-09-15T14:38:13.683

```
input[type="search"] {
 -webkit-box-sizing: content-box;
 -moz-box-sizing: content-box;
 box-sizing: content-box;
 -webkit-appearance: searchfield;
}

input[type="search"]::-webkit-search-cancel-button {
-webkit-appearance: searchfield-cancel-button;
} 
```

在 Chrome 上为我工作（在我的 Mac 上，但不在我的 iPhone 上......）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-19T16:37:16.253

与您相关的问题已发布在他们的[github中](https://github.com/twbs/bootstrap/issues/5624)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T16:44:36.407

如果您使用的是 Web Kit，您的问题可能与 sk8terboi87 发布的内容有关。

Bootstrap 不支持`Search`为您设置类型输入的样式，因为在 Web Kit 中很难做到可靠。

Bootstrap 使用了一个重置​​ CSS，它移除了通常出现的交叉，您可以通过修改核心 CSS 将其恢复，但这可能会在将来升级时导致问题。

如果它发生在其他浏览器中，尽管它可能是另一个问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-20T17:21:15.413

为了在所有设备上获得相同的用户体验，我最终编写了一个 Angular 指令，并将其放在 Bootstrap 'input-group-btn' 上。

角度视图 HTML

```
<div class="input-group">
    <input type="search" id="listItemSearch" class="form-control"
        placeholder="Search text..." 
        title="Search" aria-label="Search"
        data-ng-model-options="{'debounce':1500, 'updateOn':'blur default'}"
        data-ng-model="vm.filters.listItemSearchText"/>
    <span class="input-group-btn">
        <button type="button" class="btn btn-default" 
            data-ng-disabled="!vm.filters.listItemSearchText" 
            aria-describedby="listItemSearch" 
            data-clear-search-by-aria="#listItemSearch">
            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
        </button>
    </span>
    <span class="input-group-addon">
        <span>{{vm.models.listSearchResults.length}}</span>
        <span>/</span>
        <span>{{vm.data.list.length}}</span>
    </span>
</div> 
```

Angular 指令 JavaScript

```
.directive( 'clearSearchByAria', ['$parse', function clearSearchByAria( $parse )
{
    return(
    {
        'restrict':'A',
        'link':function clearSearchByAria_link( scope, jqElem, ngAttr )
        {
            jqElem.on( 'click', function( $event )
            {
                var $clickedElem = angular.element($event.currentTarget);
                var $searchInput;

                // Specified by selector.
                if( !!ngAttr.clearSearchByAria )
                {
                    var $specifiedElem = angular.element(ngAttr.clearSearchByAria)
                    if( $specifiedElem.length == 1 )
                    {$searchInput = $specifiedElem;}
                }
                else
                {
                    var $describedElem = $clickedElem.find( '[aria-describedby]' ).addBack( '[aria-describedby]' );
                    // Specified by 'aria-describedby'.
                    if( $describedElem.length == 1 )
                    {$searchInput = angular.element(''.concat( '#', $describedElem.attr('aria-describedby')));}
                    else
                    {
                        throw( new ReferenceError( "'clear-search-by-aria' attributes requires either 1) to be empty and for the element (or a descendant) to have an 'aria-describedby' attribute referring to another element or 2) to specify an element selector (e.g. '#id') to another element." ));
                    }
                }

                if( !!$searchInput && $searchInput.length == 1 )
                {
                    var ng_model = $searchInput.data( 'ngModel' ) || $searchInput.attr( 'ng-model' );
                    if( !!ng_model )
                    {
                        var modelGetter = $parse( ng_model );
                        modelGetter.assign( scope, '' );
                        scope.$apply();
                    }
                    else
                    {
                        $searchInput.val( '' );
                    }
                }
            });
        },
    });
}])` 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-05-07T06:30:48.233

将输入类型更改为 'search' 而不是 'text' 和 -webkit-appearance: block 而不是 'none'

# c# - TFS - 从构建工作项中获取工作项

> ID：13956869
> 
> 赞同：0
> 
> 时间：2012-12-19T16:33:24.673
> 
> 标签：c#

因此，我正在研究如何创建一个实用程序，在其中输入构建工作项并返回与其关联的所有工作项。

我们已经有代码可以获取与各个工作项关联的文件。

这可能吗？如果是这样，我正在寻找研究建议。我还没有处于编码状态。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:57:00.243

除非我误解了 Build WorkItem 的意思

这是一篇关于[通过 API 查询工作项链接的博客文章](http://blogs.msdn.com/b/dgorti/archive/2007/09/26/querying-on-workitem-links-through-the-api.aspx)

本质上，工作项有一个属性`WorkItemLinks`，可让您获取链接类型 ( `LinkType.BaseReferenceName`)、链接名称 ( `LinkType.Name`) 和工作项 id ( `TargetId`)。然后，您可以像加载任何工作项 ( `WIStore.GetWorkItem(wiLink.TargetId)`) 一样加载相关的工作项。

如果您只是想要与构建相关联的工作项，那么您必须遍历它以 `buildInformationNodes`查找 Associated WorkItems 节点 - [http://social.msdn.microsoft.com/Forums/da-DK/tfsgeneral/thread/92766815-c09b -422b-91fc-5e745e3aaa21](http://social.msdn.microsoft.com/Forums/da-DK/tfsgeneral/thread/92766815-c09b-422b-91fc-5e745e3aaa21)

# python - python中的sql查询——调试附加值

> ID：13956871
> 
> 赞同：1
> 
> 时间：2012-12-19T16:33:34.420
> 
> 标签：python, sql, cx-oracle

我正在尝试将某些值 row[9:11] 附加到我的查询结果中，如果 rows0-8 已经存在（以避免冗余并从多行移动到一行，多列）。查询执行得很好，如果我删除“else”子句，它就可以正常工作。但是，我没有让它打印已经存在的带有附加值的行（而且我知道这些行存在）......我缺少什么想法？

```
cursor.execute(query, cruise6_input=cruise6_input)
output=""
checkID=""
for row in cursor.fetchall():

    if row[0] != checkID:
        if output != "":
            print output, "this is a test"

        checkID=row[0]
        output=row[0:11]

    else:
        output=output + (row[8:11]) 
```

这打印了原始输出的所有行和“这是一个测试”......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:05:50.037

我的嵌套已关闭。代替：

```
if row[0] != checkID:
    if output != "":
        print output, "this is a test"

    checkID=row[0]
    output=row[0:11]

else:
    output=output + (row[8:11]) 
```

我有：

```
 if row[0] != checkID:
        if output != "":
            print output, "this is a test"

            checkID=row[0]
            output=row[0:11]

    else:
        output=output + (row[8:11]) 
```

愚蠢的错别字。谢谢大家！

# string - Unicode 字符

> ID：13956872
> 
> 赞同：0
> 
> 时间：2012-12-19T16:33:40.623
> 
> 标签：string, unicode, codepages

在我的应用程序中，我有 unicode 字符串，我需要知道字符串使用哪种语言，我想通过确定字符串的字符在哪个范围内来缩小可能语言的列表来做到这一点。

我从[http://jrgraphix.net/research/unicode_blocks.php获得的范围](http://jrgraphix.net/research/unicode_blocks.php)

[以及来自http://unicode-table.com/en/](http://unicode-table.com/en/)的可能语言

问题是算法必须检测所有语言，有人知道 unicode 范围到语言的更广泛映射吗？

谢谢沃伊切赫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T12:56:01.650

*这实际上是不可能*的，原因有两个：

*   许多语言共享相同的书写系统。例如，看看英语和荷兰语。两者都使用基本拉丁字母。仅查看代码点的范围，您根本无法区分它们。

*   某些语言使用更多字符，但不能保证特定文本包含它们。例如，德语使用基本拉丁字母加上“ä”、“ö”、“ü”和“ß”。虽然这些字母并不是特别少见，但您可以轻松地创建没有它们的整个句子。因此，短文本可能不包含它们。因此，再一次，仅查看代码点是不够的。

*   文本并不总是“纯”的。由于法语借词（例如“déjà vu”），英文文本可能包含法语字母。或者它可能包含外来词，因为文本在谈论外来事物（例如“Götterdämmerung 是理查德·瓦格纳的歌剧……”，或“万里长城是……”）。仅查看代码点会产生误导。

总而言之，不，您不能可靠地将代码点范围映射到语言。

*你可以做什么：*计算每个字符在文本中出现的频率，并与已知语言的统计数据进行启发式比较。或者分析单词结构，例如使用马尔可夫链。或在字典中搜索单词（考虑屈折变化、构图等）。或这些的组合。

但这很困难，而且工作量很大。您应该使用现有的解决方案，例如 deceze 和 Esailija 推荐的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-08T04:57:42.383

我喜欢使用谷歌翻译之类的建议——因为他们会为你做所有的工作。

您也许可以构建一个基于规则的系统，让您成为其中的一部分。为语言建立启发式规则，看看这是否足够。某些藏文字符确实表示藏文，并且在许多语言中都有独特的字符将被赠送。但正如另一个答案所指出的那样，有限的文本样本可能并不那么准确，因为您可能没有明确的指标。

然而，语言在每个字符出现的频率上会有所不同，因此您可以拥有每种语言的基本指纹，您需要根据字母频率进行分类和猜测。这可能比基于规则的系统更进一步。构建它的一个好工具可能是[文本分类算法](http://en.wikipedia.org/wiki/Document_classification)，它将为您完成所有分析。您将使用不同的语言训练算法，而不必自己阐明实际规则。

一个更复杂的版本大概是谷歌所做的。

# visual-studio-2012 - 打开 Visual Studio 2012 时出现设备未就绪错误

> ID：13956875
> 
> 赞同：12
> 
> 时间：2012-12-19T16:33:49.097
> 
> 标签：visual-studio-2012

当我打开 Visual Studio 以及尝试与 TFS 交互（签入、获取最新等）时，我收到错误“设备未准备好”

![在此处输入图像描述](../Images/80bb8962c1e7a6d4d91abda10c9a4467.png)

我尝试了以下方法来纠正这个问题，但没有解决它：

*   重启
*   修复 Visual Studio
*   卸载/重新安装 Visual Studio

什么设备没有准备好？我怎样才能使它准备好或以其他方式纠正这个错误？我宁愿不重新安装我的操作系统，但如果需要，我会这样做。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-25T09:00:16.300

这（主要）是当您的工作区指向的位置不再可用时引起的。

您需要做的就是重置工作区（

*   开源控制，
*   在工具栏中单击下拉列表工作区，
*   编辑驱动器更改的计算机的工作区
*   将本地文件夹设置到正确的位置

)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T16:42:50.467

我*认为*这种事情可能是由不再可访问的驱动器引起的。可以尝试以下方法：清除您最近使用的项目和文件列表：

1.  运行`regedit`。
2.  导航到`HKCU\Software\Microsoft\VisualStudio\11.0\ProjectMRUList`。
3.  删除所有“文件”项（文件 1、文件 2、文件 3 等）。
4.  导航到`HKCU\Software\Microsoft\VisualStudio\11.0\FileMRUList`。
5.  删除所有“文件”项（文件 1、文件 2、文件 3 等）。

如果这不起作用，请查看 11.0 及其下的其他项目，寻找不再有效的目录。这里有一些其他的节点可以查看：

*   11.0
*   11.0\外部工具
*   查找（可能为查找文件指定了一个目录）
*   JavaScript语言服务
*   键盘
*   NewProjectDialog 和子节点

...可能还有其他几个，但此时我已经厌倦了寻找。无论如何，请查看各个节点以查找不再存在的网络位置或可移动驱动器，并摆脱该路径或将该路径指向其他地方，看看问题是否消失。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T16:56:35.213

我最近遇到了硬盘故障，我设法修复了它。在这样做时，驱动器号发生了变化。我将驱动器的字母更改回其原始字母名称，并且不再出现此问题。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-10T21:27:30.670

我只是有同样的问题。我单击了要求我升级到本地工作区的按钮。在我这样做之后，每当我尝试使用 TFS 做任何事情时，我都会收到“设备未就绪错误”。标记为答案的响应对我没有帮助。我必须完全删除工作区（通过 Olivier 的回答中描述的菜单），然后重新添加一个新的工作区。

# java - 在 Android/Java 中将 DataInputStream 处理为更新的标准

> ID：13956877
> 
> 赞同：1
> 
> 时间：2012-12-19T16:33:58.243
> 
> 标签：java, android, bufferedinputstream

我在读取原始文件的 Android 应用程序中有这样的方法：

```
public String inputStreamToString(InputStream isTwo) throws IOException {
        StringBuffer sBuffer = new StringBuffer();
        DataInputStream dataIO = new DataInputStream(isTwo);
        String strLineTwo = null;
        while ((strLineTwo = dataIO.readLine()) != null) {
            sBuffer.append(strLineTwo + "\n");
        }
        dataIO.close();
        isTwo.close();
        return sBuffer.toString();

    } 
```

但是，DataInputStream 对象现在似乎已被弃用。我研究了它，听说最好`readline()`用`BufferedInputStream`. 有人可以帮我完成他的（填写缺失的行）吗？我不确定如何声明`br`var。这是我到目前为止所拥有的：

```
public String inputStreamToString(InputStream isTwo) throws IOException {
        String strLineTwo = null;
        BufferedReader br = null;

        StringBuffer sBuffer = new StringBuffer();
        InputStreamReader dataIO = new InputStreamReader(isTwo);

        while ((strLineTwo = br.readLine()) != null) {
            sBuffer.append(strLineTwo + "\n");
        }

        dataIO.close();
        isTwo.close();
        return sBuffer.toString(); 
```

这是调用此方法的前面我尚未触及的代码：

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.tech);
        InputStream iFileTwo = getResources().openRawResource(R.raw.testing);
        try {
            TextView helpText = (TextView) findViewById(R.id.tvStream);
            String strFileTwo = inputStreamToString(iFileTwo);
            helpText.setText(strFileTwo);

        } catch (Exception e) {
            Log.e(DEBUG_TAG_THREE, "InputStreamToString failure", e);
        }
    } 
```

另外，我想确保它适用于 Android 2.3 到 4.2（当前）。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:41:15.797

我就是这样写的。这具有更少的开销并保留了原来的换行符。

```
public String inputStreamToString(InputStream in) throws IOException {
    StringBuilder out = new StringBuilder();
    char[] chars = new char[1024];
    Reader reader = new InputStreamReader(in /*, CHARSET_TO_USE */);

    try {
        for (int len; (len = reader.read(chars)) > 0; )
            out.append(chars, 0, len);
    } finally {
        try {
            in.close();
        } catch (IOException ignored) {
        }
    }
    return out.toString();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T17:30:34.660

Just a suggestion, if you are migrating, then why not use the `IOUtils` from libraries like `apache commons` etc which actually take care of managing your streams and also save you with lot of errorneous conditions

# c# - 从 Salesforce 到 .net 应用程序的通知

> ID：13956878
> 
> 赞同：1
> 
> 时间：2012-12-19T16:34:00.047
> 
> 标签：c#, asp.net, .net, salesforce

我们正在构建一个 asp.net Web 应用程序，它将数据完全推送到 salesforce，并且是一个经过表单验证的网站。为了最大限度地减少对 Salesforce 的 API 调用次数并减少对网站最终用户的响应时间，当用户登录时，我们将所有联系信息存储在会话对象中。但是，问题是，当有人在 Salesforce 中更改信息时，我如何才能在 asp.net Web 应用程序中了解以再次查询更新的信息并更新会话对象。

我知道我们可以使用 salesforce 监听器来让通知发送出站消息。但是，只是想知道如何在 asp.net Web 应用程序中更新我当前正在运行的联系人会话对象。

您的意见对我很有价值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T14:59:00.587

如果您确实可以访问侦听器并且可以使用它来推送事件 - 那么我认为这样的方法可能会极大地减少事件/API 调用。

*   远程服务 - 销售队伍
*   本地服务 - 一种 WCF/SOAP 服务
*   Web 应用程序 - 您所指的 ASP.NET 应用程序
*   本地缓存 - 缓存系统（可能是文件系统，可能更精细）

首先，您应该考虑创建一个非常简单的本地服务，其目的是在数据更改时接收来自 SalesForce 的 API 调用。它的目的应该是在*对您重要的数据*发生更改时接收 API 调用。当收到这样的调用时，您应该使用新值更新本地缓存。Web 应用程序应始终并首先检查所请求的项目是否在本地缓存中，如果没有，则可以允许它对远程服务进行 API 调用以检索数据。检索到数据后，更新本地缓存并显示它。因此，从现在开始，除非数据发生更改（SalesForce 应该将更改推送给您和您的本地缓存），否则您永远不必再进行 API 调用。

您甚至可以演变为在 SalesForce 中创建数据时推送数据，并在新的本地服务到位并且正确配置远程服务时对 SalesForce 进行大量 API 调用。然后，这将为您提供一个解决方案，其中“互联网可能会死”，您仍然可以访问本地缓存并因此访问数据。

这里唯一的挑战是，我不知道如果 SalesForce 传出 API 调用失败（以防本地服务中断、互联网中断或 SalesForce 不可用）是否可以轻松重试，以保持最终的一致性.

如果本地缓存是 Session 对象（我不推荐它，因为它是易失的），只需将本地服务和 Web 应用程序集成到同一个保护伞（同一个应用程序）中。

这里的挑战是

1.  确保更改（包括创建和删除）触发从远程服务到本地服务的正确调用
2.  确保本地缓存是最新的 - 最终的一致性应该没问题，只要在发生更改时只需几分钟即可在本地更新它 - 如果所有服务都正常运行，一个好的设计应该在 30 秒内
3.  确保您可以将任何更改推回给 SalesForce？
4.  不要相信网络——它最终会失败——解释这种可能性

祝你好运，希望这会有帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:52:26.703

将值存储在缓存中，并将条目的到期时间设置为足够低，以便在进行更改时，更新将足够快地被注意到。对你来说，这可能是几个小时，可能更少，也可能是几天。

# checkout - magento 结帐按钮网址

> ID：13956881
> 
> 赞同：0
> 
> 时间：2012-12-19T16:34:10.137
> 
> 标签：checkout, magento-1.7

我不擅长编程。在我的购物车中，当用户单击“结帐”按钮时，它会直接转到 mydomain.com/checkout/onepagecheckout。

当我通过管理面板关闭 onepagecheckout 时，我的“结帐”按钮转到 mydomain.com/checkout/cart

但我想将 mydomain.com/checkout/cart 与 onepagecheckout 一起使用。

我想要的是，当用户单击“结帐”按钮时，它应该转到 mydomain.com/checkout/cart，然后从那里转到“onepagecheckout”。

请帮帮我！

多谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-17T14:18:51.140

为你

```
Mage::getUrl('checkout/onepagecheckout'); 
```

但 lint Proceed to Checkout 的默认值已使用：

```
Mage::getUrl('checkout/onepage'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T21:21:15.230

将此用于结帐网址

```
Mage::getUrl('checkout/cart'); 
```

# ruby-on-rails - 验证 HABTM 模型关系的存在

> ID：13956885
> 
> 赞同：0
> 
> 时间：2012-12-19T16:34:15.553
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有以下型号

```
class Business < ActiveRecord::Base
    has_and_belongs_to_many :categories

    validates_presence_of :category_ids
end

class Category < ActiveRecord::Base
    has_and_belongs_to_many :businesses
end 
```

我正在使用`category_ids`属性通过业务创建表单设置关系。

我尝试使用`validates_presence_of`，但是，这并不能验证类别的存在。

我可以通过浏览器操作表单，为一个类别提供一个不存在的 ID。提交表单后，我收到一个错误：

```
Couldn't find Category with id=181723 
```

* * *

编辑：

添加了以下自定义验证方法，但我仍然收到相同的错误，好像验证没有运行一样。

```
class Business < ActiveRecord::Base
    has_and_belongs_to_many :categories

    validate :categories_exist

    def categories_exist
      category_ids.each do |c|
        errors.add(:category_ids, :category_doesnt_exist) unless Category.exists? c
      end
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:09:58.010

可能有多种方法可以实现这一点，但我建议您查看[Custom Validations](http://guides.rubyonrails.org/active_record_validations_callbacks.html#performing-custom-validations)和[ActiveRecord Callbacks](http://guides.rubyonrails.org/active_record_validations_callbacks.html#callbacks-overview)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:57:31.057

您可以查看[validates_existence](https://github.com/perfectline/validates_existence) gem。这个 gem 对我验证外键是否对应于合法的父记录非常有用。如自述文件中所述：

> 这个插件库添加了 ActiveRecord 模型，以检查保存时是否存在 :belongs_to 关联。

# freeswitch - 自由切换电信中心

> ID：13956886
> 
> 赞同：0
> 
> 时间：2012-12-19T16:34:19.643
> 
> 标签：freeswitch

我一直在尝试使用 telcentris 配置 FreeSWITCH 但无法正常工作。FreeSWITCH 目前它与其他提供商完美配合。

我尝试使用官方网站中的 XML 配置（此处链接：[http](http://wiki.freeswitch.org/wiki/Provider_Configuration:_Telcentris) ://wiki.freeswitch.org/wiki/Provider_Configuration:_Telcentris ）但没有。我的 xml 中唯一改变的是用户和 ip 访问，这就是我所做的。太把公共背景。

我用我正在做的 puebas 创建了一个 lua 脚本，这是 FreeSWITCH 控制台引发的错误：12.19.2012 13:14:58.619723 [注意] switch_cpp.cpp: 1227 TELCENTRIS 12.19.2012 13:14 ：58.619723 [通知] switch_channel.c：930新频道sofia/sofia/sofia/2590573122223333 [80d4568f-2451-4f72-4f72-4f72-8de2-8de2-65b471a80e20] 12.19.19.19.19.2012 13.2012 13：14：14：14：58.77772/625/625/625/625/625/625/625/625/625/625/c。 [CS_CONSUME_MEDIA] [NORMAL_TEMPORARY_FAILURE] 12.19.2012 13:14:58.779729 [注意] switch_cpp.cpp: 1227 *********** 呼叫者：NORMAL_TEMPORARY_FAILURE - 尝试：1 ********** * 12.19.2012 13:14:58.779729 [通知] switch_cpp.cpp: 1227 请求

如果有人将 FreeSWITCH 与 telcentris 一起使用，或者可以告诉我可能出现的故障或错误，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T21:18:40.073

我认为最好的办法是运行`tcpdump`或`wireshark`收集该目的地的整个 SIP 和 RTP 流量。然后会更清楚发生了什么。

# objective-c - RestKit v0.20.x：同时映射（瞬态）对象和（核心数据）托管对象

> ID：13956887
> 
> 赞同：5
> 
> 时间：2012-12-19T16:34:20.410
> 
> 标签：objective-c, ios, core-data, restkit

假设我想用 json 向服务器发送请求

```
{ "begin_session" : { "info" : "this is some info" } } 
```

我期望响应json：

```
{ "token" : "this is a token", "a_objects" : [
    { "name" : "name of first a_object", "b_objects" : [
        { "name" : "name of first b_object", "type" : "some type value", "id" : "123" },
        { "name" : "name of second b_object", "type" : "some other type value", "id" : "124" }
    ], "id" : "id of first a_object" },
    { "name" : "name of second a_object", "b_objects" : [
        { "name" : "name of first b_object", "type" : "some type value", "id" : "123" },
        { "name" : "name of third b_object", "type" : "some third type value" , "id" : "125" },
    ], "id" : "id of second a_object" }
] } 
```

我想暂时存储“令牌”并将 a_objects 持久保存在核心数据中。这是我应该如何做整个过程吗？首先，我设置了对象：

```
@interface LoginToken : NSObject
    @property (nonatomic, copy) NSString *token;
@end

@interface AObject : NSManagedObject
    @property (nonatomic, retain) NSString *name;
    @property (nonatomic, retain) NSSet *bObjects;
    @property (nonatomic, retain) NSString *aObjectId;
@end

@implementation AObject
    @dynamic name; @dynamic bObjects; @dynamic aObjectId;
@end

@interface BObject : NSManagedObject
    @property (nonatomic, retain) NSString *name;
    @property (nonatomic, retain) AObject *aObject;
    @property (nonatomic, retain) NSString *type;
    @property (nonatomic, retain) NSString *bObjectId;
@end

@implementation BObject
    @dynamic name; @dynamic aObject; @dynamic type; @dynamic bObjectId;
@end 
```

这些是请求参数：

```
NSDictionary *params = @{"begin_session":@{@"info":@"this is some info"}}; 
```

然后我设置映射：

```
RKObjectMapping *tokenMapping = [RKObjectMapping mappingForClass:[LoginToken class]];
[tokenMapping addAttributeMappingsFromArray:@[@"token"]];
RKResponseDescriptor *tokenResponseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:tokenMapping pathPattern:nil keyPath:@"token" statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

RKEntityMapping *bObjectMapping = [RKEntityMapping mappingForEntityForName:@"BObject" inManagedObjectStore:objectManager.managedObjectStore];
[bObjectMapping addAttributeMappingsFromDictionary:@{@"name":@"name",@"type":@"type", @"id":@"bObjectId"}];
bObjectMapping.identificationAttributes = @[@"bObjectId"];

RKEntityMapping *aObjectMapping = [RKEntityMapping mappingForEntityForName:@"AObject" inManagedObjectStore:objectManager.managedObjectStore];
[aObjectMapping addAttributeMappingsFromDictionary:@{@"name":@"name",@"id":@"aObjectId"}];
[aObjectMapping addPropertyMapping:[RKRelationshipMapping relationshipMappingFromKeyPath:@"b_objects" toKeyPath:@"bObjects" withMapping:bObjectMapping]];
aObjectMapping.identificationAttributes = @[@"aObjectId"]; 
```

假设`objectManager`是一个正确配置的 RKObjectManager。我设置了响应描述符：

```
RKResponseDescriptor *tokenResponseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:tokenMapping pathPattern:nil keyPath:@"token" statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

RKResponseDescriptor *aObjectResponseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:aObjectMapping pathPattern:nil keyPath:@"a_objects" statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];

[objectManager addResponseDescriptorsFromArray:@[tokenResponseDescriptor, aObjectResponseDescriptor]]; 
```

最后我会提出请求：

```
[objectManager getObjectsAtPath:@"path" parameters:params success:^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {
    LoginToken *token = [mappingResult firstObject]; // use this token transiently
    // coredata objects are auto saved
} failure:^(RKObjectRequestOperation *operation, NSError *error) {
    // handle error
}]; 
```

如果这实际上是正确的方法，我需要注意什么吗？另外，如何设置从 BObject 到 AObject 的反向关系...？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-18T17:03:07.403

只要您的 CoreData 文件正确配置了关系（根据您的对象头文件看起来正确），那么映射器就会处理反向关系。否则，它应该按原样工作。

请注意，令牌对象也将保留在 CoreData 中，因此您可能必须删除它们，这是所需的行为。

# wcf - 在 WCF 中，我可以在 UriTemplate 的文字段中使用通配符吗？

> ID：13956889
> 
> 赞同：2
> 
> 时间：2012-12-19T16:34:28.660
> 
> 标签：wcf, rest, wcf-rest, operationcontract, uritemplate

我正在使用 .Net 4.0 创作一个 RESTful WCF 服务。我想要以下两个网址：

```
/root/document/{ids}?fields={fields}
/root/externaldocument/{ids}?fields={fields} 
```

映射到相同的接口成员：

```
Documents GetDocuments(string ids, string fields) 
```

我尝试将通配符放入文字 URL 段：

```
 [OperationContract]
    [WebGet(UriTemplate = "/root/*document/{ids}?fields={fields}")]
    Documents GetDocuments(string ids, string fields) 
```

但是，这是无效的，我得到以下异常：

```
The UriTemplate '/root/*document/{ids}?fields={fields}' is not valid; the 
wildcard ('*') cannot appear in a variable name or literal... Note that a 
wildcard segment, either a literal or a variable, is valid only as the last 
path segment in the template 
```

如果我将通配符段包装在模板大括号中：

```
 [OperationContract]
    [WebGet(UriTemplate = "/root/{*document}/{ids}?fields={fields}")]
    Documents GetDocuments(string ids, string fields) 
```

然后我得到一个异常，因为方法参数中没有这样的输入参数：

```
Operation 'GetDocuments' in contract 'IAPIv2' has a UriTemplate that expects a 
parameter named 'DOCUMENTS', but there is no input parameter with that name 
on the operation. 
```

我的解决方法是简单地有两个条目，指向不同的方法，然后让这些方法调用一个通用实现：

```
 [OperationContract]
    [WebGet(UriTemplate = "/root/document/{ids}?fields={fields}")]
    Documents GetDocuments(string ids, string fields)

    [OperationContract]
    [WebGet(UriTemplate = "/root/externaldocument/{ids}?fields={fields}")]
     Documents GetExternalDocuments(string ids, string fields) 
```

但这似乎有点丑陋。

我已阅读文档，无法找到这一点的具体地址。有什么方法可以在 WCF 中使用通配符文字段吗？或者这在 WCF 中是不可能的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T22:07:37.967

事实证明，这两个入口点需要具有稍微不同的功能。所以我需要捕获用于输入方法的 URL。我最终做的是以下内容：

```
[OperationContract]
[WebGet(UriTemplate = "/root/{source}ocuments/{ids}?fields={fields}")]
DocumentCollection GetDocumentsById(string source, string ids, string fields); 
```

两个网址：

```
/root/document/{ids}?fields={fields}
/root/externaldocument/{ids}?fields={fields} 
```

映射到相同的 URL 模板，因此我只需要在我的界面中有一个带有单个 UriTemplate 的条目。

如果第二段是“documents”，则“source”输入参数捕获“d”；如果第二段是“externaldocuments”，则捕获“externald”。因此，通过检查此输入参数，该方法可以做出适当的反应，具体取决于使用的 URL达到方法。

请注意，我不能将以下内容用于 UriTemplate：

```
[WebGet(UriTemplate = "/root/{source}documents/{ids}?fields={fields}")] 
```

因为在这种情况下，传入的 URL

```
/root/document/{ids}?fields={fields} 
```

将不匹配模板，即使在源输入参数使用空字符串 ("") 时模板匹配。显然，UriTemplate 匹配算法要求参数捕获组中至少有一个字符才能进行匹配。

# ios - NSPredicate 在 CGPoints 的 NSArray 上

> ID：13956890
> 
> 赞同：0
> 
> 时间：2012-12-19T16:34:43.130
> 
> 标签：ios, nspredicate, cgrect, cgpoint

我有一个 NSArray 的 CGPoints。

我实际上想获得包含该数组中所有 CGPoints 的最小 CGRect。是否已经有任何 iOS 功能可以做到这一点？

否则我将不得不手动 fetch `minX, maxX, minY, maxY`，并以这种方式构造我的 CGRect ：

```
CGrectMake(minX, minY, maxX-minX, maxY-minY); 
```

为此，我需要使用 NSPredicate 过滤 NSArray。

（我知道，我可以手动过滤数组，但是来吧！...）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T09:14:14.517

没有公共 API 可以满足您的要求。你必须自己写。

`NSPredicate`反正也不合适。谓词用于过滤值，而不是用于构造新值。

```
CGRect boundsOfPointArray(NSArray *array) {
    CGRect bounds = CGRectNull;
    for (NSValue *wrapper in array) {
        CGRect r = (CGRect){ wrapper.CGPointValue, CGSizeZero };
        bounds = CGRectUnion(bounds, r);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T17:20:04.137

这个问题非常不清楚。您的意思是要创建一个包含数组中所有点的最小 CGRect 吗？如果是这样，那很简单，只需遍历跟踪 minX、maxX、minY 和 maxY 的点数组。例如

```
CGFloat minX = CGFLOAT_MAX;
CGFloat minY = CGFLOAT_MAX;
CGFloat maxX = -CGFLOAT_MAX;
CGFloat maxY = -CGFLOAT_MAX;

for (NSValue *v in pointsArray) {
    CGPoint p = [v CGPointValue];
    minX = fminf(minX, p.x);
    minY = fminf(minY, p.y);
    maxX = fmaxf(maxX, p.x);
    maxY = fmaxf(maxY, p.y);
}

CGRect r = CGRectMake(minX, minY, maxX - minX, maxY - minY); 
```

# jquery - 阻止实时点击事件，直到该功能没有结束？

> ID：13956891
> 
> 赞同：0
> 
> 时间：2012-12-19T16:34:42.237
> 
> 标签：jquery, click, jquery-animate, live, animated

有人可以帮我修复此代码吗？我想要的是阻止 live ( `'click'`) 函数，直到`sliddingright`函数完成。

```
('li.menu-item').live('click', function(event){
    if( !$(this).is(':animated')) 
    {
    sliddingright(page_id_target_right,previous_right_old,previous_right,next_right,pages_numbers);
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:43:45.313

只需向您的slidingright 函数添加一个return 语句，该函数在函数完成其任务后返回“standby”，保存它并在下次调用“click”时检查其值。

像这样：

```
var state = 'standby';
('li.menu-item').live('click', function(event){
    if( !$(this).is(':animated') && state == 'standby' ) 
    {
        state = 'processing';
        state = sliddingright(page_id_target_right,previous_right_old,previous_right,next_right,pages_numbers);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:41:43.593

尝试：

```
clickMe = function() {
$('li.menu-item').live('click', function(event) {
    $('li.menu-item').off('click');
    sliddingright(page_id_target_right, previous_right_old, previous_right, next_right, pages_numbers);
});
    $('li.menu-item').on("click", clickMe);
};​ 
```

# c# - 我如何检查以确保客户在访问任何页面之前已完成任务

> ID：13956893
> 
> 赞同：3
> 
> 时间：2012-12-19T16:34:48.393
> 
> 标签：c#, asp.net-mvc-3, razor

我在 MVC Razor 网站上使用会员资格提供程序。

客户创建帐户然后登录后，我需要确保他们在登录中添加系统帐户，否则以下页面会出现问题。

这是我的页面的样子：

![在此处输入图像描述](../Images/9c06e17fad52e6b0ce306aa7ffcfc08a.png)

如您所见，他们可以单击顶部的任何选项卡并绕过此屏幕。

处理这个问题的最佳方法是什么？

我应该禁用标签吗？如果是这样，我将在哪里禁用它们？还是我应该检查每个页面并将它们重定向回此页面？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T16:36:48.710

在加载任何其他页面之前，您应该检查是否已输入该信息。（可能在动作过滤器中）

如果您只是禁用链接，恶意用户可以直接导航到 URL。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T16:51:09.307

如果`RedirectToAction()`他们还没有创建一个，例如使用

```
public ActionResult OrderGas(){

    // do check here to see if they have system account
    if (!hasSystemAccount()){

        // this will re-display the add another account page each time
        return RedirectToAction("AddAnotherAccountAction");
    }

    //other wise continue;
    return view("OrderGas");

} 
```

或者，您可以使用 javascript 根据型号隐藏按钮

```
public ActionResult OrderGas(){

    // do check here to see if they have system account
    Boolean hasAccount = this.hasSystemAccount();

    // apply to the model
    model.hasSystemAccount = hasAccount;

    return view("OrderGas", model);

} 
```

然后你的 jquery 可以检查这个值并相应地隐藏链接

```
if($('#hasSystemAccount').val().toLower() = "false"){

    $('.myLinkClass').hide();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T02:16:32.210

您是否考虑过使用额外的 Membership ROLE 来指示客户已添加“系统帐户”信息，例如*CustomerWithSystemAccountInfo*。

然后你可以保护控制器动作`[Authorize(Roles = "CustomerWithSystemAccountInfo")]`

至于基于 ROLE 隐藏或禁用 _layout 中的菜单选项，以下文章提供了一种我非常喜欢的方法：

[http://techbrij.com/981/role-based-menu-asp-net-mvc](http://techbrij.com/981/role-based-menu-asp-net-mvc)

# api - Shopify API 突然出现 HTTP 状态码 429 失败？

> ID：13956897
> 
> 赞同：2
> 
> 时间：2012-12-19T16:34:54.517
> 
> 标签：api, shopify, http-status-code-429

我们的应用程序使用 Shopify API 更新我们商店的产品数据并获取订单信息，突然收到失败的请求和新的响应错误代码：429（以下请求标头的快照）。有没有人经历过这个？处理此错误的正确方法是什么？而且（也许更重要的是）：开发人员去哪里了解即将发生的变化以及何时实施，所以我们不会感到意外？

```
Server: nginx
Date: Wed, 19 Dec 2012 15:58:37 GMT
Content-Type: application/xml; charset=utf-8
Transfer-Encoding: chunked
Connection: keep-alive
Status: 429
Retry-After: 600
Cache-Control: no-cache
X-Request-Id: ***********
X-UA-Compatible: IE=Edge,chrome=1
Set-Cookie: _secure_session_id=*********; path=/; secure; HttpOnly
X-Runtime: 0.041736
HTTP-Status-Code: 429 HTTP/1.1 429 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:42:17.243

从 11 月 16 日开始：

[http://www.shopify.com/technology/6901970-api-update-status-code-change](http://www.shopify.com/technology/6901970-api-update-status-code-change)

你可以关注那个博客，我想如果你想知道他们什么时候计划改变……有时实际的改变需要比最初的工作日期更长的时间。我认为503到429就是这种情况。

# fluent-nhibernate - Fluent Nhibernate 过滤器和收集和关联项目

> ID：13956904
> 
> 赞同：0
> 
> 时间：2012-12-19T16:35:17.090
> 
> 标签：fluent-nhibernate

```
class parent
{
virtual AnotherType AnotherType {get;set;}
virtual TypeA TypeA {get;set;}
virtual IList<TypeB> TypeBs {get;set;}
}

class TypeA
{
virtual TypeC TypeC {get;set;}
...
}

class TypeB
{
virtual TypeD TypeD {get;set;}
...
} 
```

需要通过过滤 TypeA 和 TypeB 返回不同的父列表

```
select p.*
from parent p
join typea a on a.parentid = p.parentid
join typeb b on b.parentid = p.parentid
join typec c on c.typeaid = c.typeaid
join typed d on d.typebid = d.typebid
where p.AnotherType.id = "someid"
and c.foo == "foo" 
and d.bar == "bar" 
```

尝试使用

```
Session.QueryOver(() => parent)
.joinalias(() => parent.TypeA, () => typea)
.joinalias(() => typea.TypeC, () => typec)
.joinalias(() => parent.TypeB, () => typeb)
.joinalias(() => typeb.TypeD, () => typed)
.where(() => parent.AnotherType.id == "someid")
.and(() => typec.foo == "foo")
.and(() => typed.bar == "bar).Future<parent>.ToArray(); 
```

但我得到了重复，因为 typeB 被扁平化为结果，而不是作为父集合单独查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T13:06:12.573

过滤重复项

```
Session.QueryOver(() => parent)
    ...
    .TransformUsing(Transformers.DistinctRootEntity)
    .Future<Parent>().ToArray(); 
```

# entity-framework - EF5 代码优先迁移：使用 RenameColumn 后出现“每个表中的列名必须唯一”错误

> ID：13956905
> 
> 赞同：17
> 
> 时间：2012-12-19T16:35:24.373
> 
> 标签：entity-framework, ef-code-first, entity-framework-5, entity-framework-migrations

我们正在使用 Entity Framework 5.0 Code First 和自动迁移。

我有这样的课：

```
public class TraversalZones
{
    public int Low { get; set; }
    public int High { get; set; }
}​ 
```

然后我们意识到这些属性并不是真正的正确名称，所以我们更改了它们：

```
public class TraversalZones
{
    public int Left { get; set; }
    public int Top { get; set; }
}​ 
```

重命名在整个项目中正确重构，但我知道自动迁移不够聪明，无法在 IDE 中获取这些显式重命名，因此我首先检查以验证唯一待处理的迁移是此列重命名：

```
update-database -f -script 
```

果然，它只是显示了 SQL 删除 Low 和 High 并添加 Left 和 Top。然后我添加了手动迁移：

```
add-migration RenameColumns_TraversalZones_LowHigh_LeftTop 
```

并将生成的代码修复为：

```
public override void Up()
{
    RenameColumn("TraversalZones", "Low", "Left");
    RenameColumn("TraversalZones", "High", "Top");
}

public override void Down()
{
    RenameColumn("TraversalZones", "Left", "Low");
    RenameColumn("TraversalZones", "Top", "High");
} 
```

​然后我更新了数据库：

```
update-database -verbose 
```

并得到了 2 列重命名，就像我所期待的那样。

几次迁移后，我备份了生产并将其还原到本地数据库以测试该数据库上的代码。这个数据库已经在其中创建了 TraversalZones 表，我当然首先更新了旧的列名（Low 和 High）：

```
update-database -f -verbose 
```

并且重命名命令出现在输出中 - 一切都很好：

```
EXECUTE sp_rename @objname = N'TraversalZones.Low', @newname = N'Left', @objtype = N'COLUMN'
EXECUTE sp_rename @objname = N'TraversalZones.High', @newname = N'Top', @objtype = N'COLUMN'
[Inserting migration history record] 
```

然后我运行我的代码，它错误地告诉我数据库自上次运行以来发生了变化，我应该运行`update-database`...。

于是我又跑了一遍：

```
update-database -f -verbose 
```

现在我陷入了这个错误：

```
No pending code-based migrations. Applying automatic migration:
201212191601545_AutomaticMigration.
ALTER TABLE [dbo].[TraversalZones] ADD [Left] [int] NOT NULL DEFAULT 0
System.Data.SqlClient.SqlException (0x80131904): Column names in each table must be unique. Column name 'Left' in table 'dbo.TraversalZones' is specified more than once.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout)
   at System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean asyncWrite)
   at System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at System.Data.Entity.Migrations.DbMigrator.ExecuteSql(DbTransaction transaction, MigrationStatement migrationStatement)
   at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.ExecuteSql(DbTransaction transaction, MigrationStatement migrationStatement)
   at System.Data.Entity.Migrations.DbMigrator.ExecuteStatements(IEnumerable`1 migrationStatements)
   at System.Data.Entity.Migrations.Infrastructure.MigratorBase.ExecuteStatements(IEnumerable`1 migrationStatements)
   at System.Data.Entity.Migrations.DbMigrator.ExecuteOperations(String migrationId, XDocument targetModel, IEnumerable`1 operations, Boolean downgrading, Boolean auto)
   at System.Data.Entity.Migrations.DbMigrator.AutoMigrate(String migrationId, XDocument sourceModel, XDocument targetModel, Boolean downgrading)
   at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.AutoMigrate(String migrationId, XDocument sourceModel, XDocument targetModel, Boolean downgrading)
   at System.Data.Entity.Migrations.DbMigrator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId)
   at System.Data.Entity.Migrations.Infrastructure.MigratorLoggingDecorator.Upgrade(IEnumerable`1 pendingMigrations, String targetMigrationId, String lastMigrationId)
   at System.Data.Entity.Migrations.DbMigrator.Update(String targetMigration)
   at System.Data.Entity.Migrations.Infrastructure.MigratorBase.Update(String targetMigration)
   at System.Data.Entity.Migrations.Design.ToolingFacade.UpdateRunner.RunCore()
   at System.Data.Entity.Migrations.Design.ToolingFacade.BaseRunner.Run()
ClientConnectionId:c40408ee-def3-4553-a9fb-195366a05fff
Column names in each table must be unique. Column name 'Left' in table 'dbo.TraversalZones' is specified more than once.​ 
```

因此，显然 Migrations 对“左”列是否仍需要进入此表感到困惑；我会假设 RenameColumn 会让事情保持在正确的状态，但它似乎没有。

当我将它试图做的事情转储到 a`update-database -f -script`时，如果没有手动迁移，我会尝试做它会做的事情：

```
ALTER TABLE [dbo].[TraversalZones] ADD [Left] [int] NOT NULL DEFAULT 0
ALTER TABLE [dbo].[TraversalZones] ADD [Top] [int] NOT NULL DEFAULT 0
DECLARE @var0 nvarchar(128)
SELECT @var0 = name
FROM sys.default_constraints
WHERE parent_object_id = object_id(N'dbo.TraversalZones')
AND col_name(parent_object_id, parent_column_id) = 'Low';
IF @var0 IS NOT NULL
    EXECUTE('ALTER TABLE [dbo].[TraversalZones] DROP CONSTRAINT ' + @var0)
ALTER TABLE [dbo].[TraversalZones] DROP COLUMN [Low]
DECLARE @var1 nvarchar(128)
SELECT @var1 = name
FROM sys.default_constraints
WHERE parent_object_id = object_id(N'dbo.TraversalZones')
AND col_name(parent_object_id, parent_column_id) = 'High';
IF @var1 IS NOT NULL
    EXECUTE('ALTER TABLE [dbo].[TraversalZones] DROP CONSTRAINT ' + @var1)
ALTER TABLE [dbo].[TraversalZones] DROP COLUMN [High]
INSERT INTO [__MigrationHistory] ([MigrationId], [Model], [ProductVersion]) VALUES ('201212191639471_AutomaticMigration', 0x1F8B08000...000, '5.0.0.net40') 
```

这似乎是迁移中的一个错误。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-19T16:45:01.650

显然，解决方法是这样的：

```
update-database -f -script 
```

您可以在我的问题中看到结果。然后我扔掉了脚本中除了最后一行之外的所有内容，然后针对数据库运行它以让 Migrations 知道：我们已经重命名了该列，将其删除。

我现在可以继续使用*此*数据库副本，但我担心每次针对生产副本的迁移（直到迁移生产本身）都会继续出现此问题。如果没有此解决方法，如何正确解决此问题？

**更新**

事实上，这在包括生产在内的所有其他情况下都是一个问题。`update-database -f -script`肮脏的解决方案是在提交生成的版本和修复的版本之后生成一个 SQL 脚本 ( )。

一个稍微干净的解决方案是从脚本中获取 SQL，添加手动迁移，并将 Up 的内容更改为简单：

```
public void Up()
{
    Sql("...That SQL you extracted from the script...");
} 
```

这将确保运行此迁移的其他环境完全按照您的预期方式进行。

测试这有点棘手，所以你可以这样处理：

1.  备份你的数据库以防万一。
2.  运行 SQL。如果它工作正常，请将 SQL 放在一边。
3.  添加手动迁移并清除 Up() 方法中的所有内容。让它完全空着。
4.  运行更新数据库 -f
5.  `Sql("...");`现在通过添加调用您预留的 SQL来修改 Up() 方法。

现在您的数据库是最新的，无需两次运行 SQL，并且其他环境可以获得该 SQL 的结果。

# jquery - $ajax 命令和 Json 响应

> ID：13956910
> 
> 赞同：0
> 
> 时间：2012-12-19T16:35:52.857
> 
> 标签：jquery, ajax, django

在我的 django 应用程序中，我尝试使用 ajax 来检查用户名是否已经存在，如果是则显示错误。

这是我所拥有的

html:

```
 <form  method="post" id='my_form'>
 {% csrf_token %}
    <input id='username' type="text" name="username"/>
 <button type="submit">Valider</button>
 </form> 
```

js：

```
 $('#my_form').submit(function(){
    var username = $('#username').val();
    if (username == ''){
       alert('please enter username');
       return false;
    }

    $.ajax({
           type: "POST",
           url: "/auth_validate",
           data: {'username': $('#username').val(), 'csrfmiddlewaretoken': '{{csrf_token}}'},
           dataType: "text",
           success: function(response) {
                  var response = $.parseJSON(response);
                  if (response.success){
                      return true;
                  }
                  else{
                      alert(response.error);
                      return false;
                  }
            },
            error: function(rs, e) {
                   alert(rs.responseText);
                   return false;
            }
      }); 
}) 
```

意见：

```
def auth_validate(request):
    error = ''
    success = False
    if request.method == 'POST':
        username = request.POST.get('username', None)
        if not username:
            error = _('Please enter username')
        elif User.objects.filter(username__exact=username).exists():
            error = _('Sorry this username is already taken')
        else:
            success = True

    ajax_vars = {'success': success, 'error': error}
    return HttpResponse(simplejson.dumps(ajax_vars), mimetype='application/javascript') 
```

当我输入用户名（如果存在或不存在）时，会出现一个空警报，当我单击“确定”时，会提交表单。此外，错误不会出现。

知道为什么它不起作用吗？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T18:46:13.460

您的视图和模板看起来不错我建议您使用本机`JSON`处理该函数并序列化表单而不是`data`手动“发送”。另外请注意`return false`事件回调的末尾，而不是`success`和`error`回调的内部。

```
$('#my_form').on('submit', function(){
    var $form = $(this);
    $.ajax({
        type: "POST",
        url: "/auth_validate",
        data: $form.serialize(),
        dataType: "json",
        success: function(response) {
            if (!response.success) {
                alert(response.error);
            } else {
                alert('This username is available!');
            }
        },
        error: function(rs, e) {
            alert(rs.responseText);
        }
    });
    return false;
}); 
```

祝你好运 ：）

**更新：**

请检查成功回调中的 else ;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:40:47.710

因为这部分：

```
 var response = $.parseJSON(response);
          if (response.success){
              return true;
          }
          else{
              alert(response.error);
          } 
```

响应没有值“成功”，因此会弹出一个警告对话框。jQuery 已经注意了，这个检查只在请求成功时进行，所以你不要这样做。

如果您不想使用 for 的浏览器提交，请在功能`return false;`末尾添加以防止浏览器默认行为。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:40:24.080

django 响应的 JSON 是什么样的？

你知道哪个警报被调用了吗？是错误函数还是成功函数中的那个？

我认为你不需要这条线

```
var response = $.parseJSON(response); 
```

响应应该已经是 JSON。

# linux - 从 bash 脚本获取用户输入（由 cron 或 udev 执行）

> ID：13956915
> 
> 赞同：2
> 
> 时间：2012-12-19T16:36:15.423
> 
> 标签：linux, bash, shell, ubuntu, console

编辑，这个问题可能还不是很清楚，简短的版本：

如果脚本在后台运行而不是在活动控制台中，如何弹出询问用户输入的对话框？/编辑

当我从 udev 或 cron 运行 bash 脚本时，它通常会在后台某处安静地运行。示例可能是插入外部硬盘驱动器运行 rsync 以进行数据备份。所以不是每次我插入硬盘时我都想启动这个动作。

启动某些用户输入对话框并询问是或否的最简单方法是什么？我可以用 PyQt 编写一些界面，但我希望尽可能少的依赖关系，最好是跨窗口管理器，甚至可能没有窗口管理器。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:31:24.463

编辑2：轻量级（因此和预期的一样丑）版本是xmessage，这可能是问题的答案，除非你有更好的：

```
xmessage  "Do you want to run the backup script?" -buttons yes,no 
```

[http://linux.byexamples.com/archives/87/using-gui-dialog-box/](http://linux.byexamples.com/archives/87/using-gui-dialog-box/)

编辑：所以kde有KDialog，X有什么真正轻量级的东西吗？

[http://www.linux-magazine.com/Issues/2009/99/Zenity-and-KDialog](http://www.linux-magazine.com/Issues/2009/99/Zenity-and-KDialog)

```
kdialog --title "Do you want to run the backup script?"
--yesno "Do you want to run the backup script?" 
```

我目前倾向于 zenity，唯一的问题是它在 kde 上引入了一系列 gtk 依赖项，但它是跨平台的并且可以在 Windows 上运行。从本质上讲，这正是我想要的：

```
if zenity --question --text="Please press a button."; then
    zenity --info --text="You pressed Yes\!"
else
    zenity --error --text="You pressed No\!"
fi 
```

但希望它在资源/依赖项上会轻很多。有什么替代建议吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:46:16.797

这应该在 linux 或超级用户或服务器故障中发布。

但是，Linux 上排名第一的谷歌搜索**读取用户输入**链接返回到 StackOverflow： [https ://www.google.com/search?q=linux+read+user+input&ie=utf-8&oe=utf-8&aq=t&rls= org.mozilla:en-US:official&client=firefox-a&channel=fflb](https://www.google.com/search?q=linux+read+user+input&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla:en-US:official&client=firefox-a&channel=fflb)

所以我想这不是太离谱。

同样，**linux 调用命令 usb 设备插件**的第三个谷歌结果链接到 ServerFault： [https ://serverfault.com/questions/399698/execute-a-command-when-a-device-is-connected-via-usb](https://serverfault.com/questions/399698/execute-a-command-when-a-device-is-connected-via-usb)

我将把这两者结合起来作为练习。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T16:42:29.327

一个简单的方法是让自动化脚本简单地向您发送电子邮件，或者可能`wall`通过说明（包含真实脚本的位置）发出警报。

另一种方法是将自动脚本写入`touch`文件`/var/lib`并在 5 分钟后如果文件仍然存在则继续。这使用户可以选择停止进程（通过删除文件），但保持一些自动化。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T16:43:52.633

这不是您应该首先处理 cron 或 udev 的事情。编写一个用户区守护程序，它监听适当的 D-Bus 消息并执行适当的操作。

# objective-c - 谷歌方向 Json 错误

> ID：13956917
> 
> 赞同：0
> 
> 时间：2012-12-19T16:36:22.593
> 
> 标签：objective-c, json

我正在尝试使用 google 路线获取路线，但出现此错误：

> 错误域=org.brautaset.JSON.ErrorDomain 代码=3 \"无法识别的前导字符 (41)\

这是Json

`loadDirections('Avenida Paulista', 'Rua Augusta', { 'locale': 'en', travelMode: G_TRAVEL_MODE_WALKING, avoidHighways: false, getPolyline: true, getSteps: true, preserveViewport: false})`

怎么了？什么是*无法识别的主角（41）*是什么意思？

```
 - (void)loadWithStartPoint:(NSString *)startPoint endPoint:(NSMutableArray *)endPoints options:(UICGDirectionsOptions *)options {
for (int idx = 0; idx < [endPoints count];idx ++) 
{
    NSString* msg = [NSString stringWithFormat:@"loadDirections('%@', '%@', %@)", startPoint, [endPoints objectAtIndex:idx], [options JSONRepresentation]];
    NSLog(@"msg %@",msg);
    mstr = [msg retain];
    [self performSelector:@selector(loadDirections:)  withObject:nil afterDelay:0.5];
}
}
 -(void)loadDirections:(NSString *)message
{
[googleMapsAPI stringByEvaluatingJavaScriptFromString:mstr]; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T14:58:50.043

确保在初始化 GDirections 对象时，您还传递了一个实际元素作为第二个参数。

如[文档](https://developers.google.com/maps/documentation/javascript/v2/reference?hl=en#GDirections)中所述：

> 出行方式，例如驾车（默认）或步行。请注意，如果您指定步行路线，则需要指定一个面板来向用户​​发出警告通知。

如果您使用的是[Map-Kit-Route-Directions 扩展](https://github.com/kishikawakatsumi/MapKit-Route-Directions)，您只需打开**api.html**文件，并在第 16 行替换它

```
gdir = new GDirections(null, null); 
```

有了这个

```
gdir = new GDirections(null, "body"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T16:44:06.863

JSON 无效。

```
{ 
  'locale': 'en', 
  travelMode: "G_TRAVEL_MODE_WALKING", 
  avoidHighways: false, 
  getPolyline: true, 
  getSteps: true, 
  preserveViewport: false
} 
```

我认为这与 G_TRAVEL_MODE_WALKING 有关，应该用引号引起来。唯一有效的 JSON 值如下

*   对象 ( `{}`)
*   数组 ( `[]`)
*   价值
    *   字符串 ( `"this is a string"`)
    *   数字`1/-1`
    *   `true`
    *   `false`
    *   `null`

[JSON 文档](http://www.json.org/)

# jquery - 从移动设备加载 j querymobile 网站

> ID：13956922
> 
> 赞同：1
> 
> 时间：2012-12-19T16:36:32.270
> 
> 标签：jquery, iphone, jquery-mobile, browser

我用 jQuery mobile 制作了一个网页，并将该页面上传到我的网络服务器，但是当我从我的 iPhone 加载该页面时，它会加载该页面，因为它将是一个“桌面网站”。看起来 jquery mobile 无法识别该页面是从移动设备加载的。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:02:18.330

将此视口添加到您的 html 头部：

```
<meta content="width=device-width, minimum-scale=1, maximum-scale=1" name="viewport"> 
```

如果您想了解有关屏幕尺寸的更多信息，请查看此链接： http: [//www.wintellect.com/cs/blogs/rrobinson/archive/2011/07/25/how-to-scale-a-jquery-mobile -site-for-ios.aspx](http://www.wintellect.com/cs/blogs/rrobinson/archive/2011/07/25/how-to-scale-a-jquery-mobile-site-for-ios.aspx)

# c# - 在 VS2010 中对项目运行代码分析

> ID：13956924
> 
> 赞同：0
> 
> 时间：2012-12-19T16:36:38.973
> 
> 标签：c#, visual-studio-2010, code-analysis

我正在我的项目上运行代码分析。我收到 8 个警告和 0 个错误。我不确定它们是什么意思，但我有 6 个代码相同（CA2000），另外 2 个代码相同（CA2240）。这是一个常见的警告吗？

```
Warning 1 CA2000 : Microsoft.Reliability : In method 'AdminDisplay.AdminDropDown_SelectedIndexChanged(object, EventArgs)', call System.IDisposable.Dispose on object 'ad' before all references to it are out of scope. 

Warning 2 CA2000 : Microsoft.Reliability : In method 'AdminDisplay.AdminDropDown_SelectedIndexChanged(object, EventArgs)', call System.IDisposable.Dispose on object 'cmd' before all references to it are out of scope. 

Warning 3 CA2000 : Microsoft.Reliability : In method 'AdminDisplay.AdminDropDown_SelectedIndexChanged(object, EventArgs)', call System.IDisposable.Dispose on object 'conn' before all references to it are out of scope. 

Warning 5 CA2240 : Microsoft.Usage : Add an implementation of GetObjectData to type 'FoundationDataSet'.

Warning 7 CA2000 : Microsoft.Reliability : In method 'WebForm1.ExecuteInsert(string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string, string)', object 'conn' is not disposed along all exception paths. 
```

我有“使用”，但我仍然收到该警告。我的语法不正确吗？

```
using (SqlConnection conn = new SqlConnection("Data Source=xx.xx.x.xx;Initial Catalog=tablenamae;User ID=xxx;Password=xxxxxxx"))
{
    DataTable dt = new DataTable();

    conn.Open();

    SqlCommand cmd = new SqlCommand("GetStudentInfo", conn);

    cmd.CommandType =CommandType.StoredProcedure;

    cmd.Parameters.Add(new SqlParameter("@ID", AdminDropDown.SelectedValue));

    //cmd.Connection.Open();
    //cmd.ExecuteNonQuery();

    SqlDataAdapter ad = new SqlDataAdapter(cmd);

    ad.Fill(dt);     

    if (dt.Rows.Count > 0)
    {
        //If you want to get mutiple data from the database then you need to write a simple looping
        txtFirstName.Text = dt.Rows[0]["FirstName"].ToString();

        txtMiddleName.Text = dt.Rows[0]["MiddleName"].ToString();

        txtLastName.Text = dt.Rows[0]["LastName"].ToString();

        txtSignature.Text = dt.Rows[0]["Signature"].ToString();

    }

    cmd.Connection.Close();
} 
```

关于如何解决这些错误的任何想法？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:47:04.643

只需将例如添加`ad.Dispose()`到您的代码中。警告不是关于语法，而是关于[缺少对 Dispoable 对象的调用](http://blogs.msdn.com/b/kimhamil/archive/2008/11/05/when-to-call-dispose.aspx)（这可能导致内存泄漏和其他问题）。如果一个对象实现了[IDisposable](http://msdn.microsoft.com/en-us/library/system.idisposable.aspx)你可以把它放到一个 using 块中。与垃圾收集的关系在[这里被揭开](http://blogs.msdn.com/b/clyon/archive/2004/09/21/232445.aspx)。

```
using (SqlConnection conn = new SqlConnection("Data Source=xx.xx.x.xx;Initial Catalog=tablenamae;User ID=xxx;Password=xxxxxxx"))
{
    DataTable dt = new DataTable();

    conn.Open();

    SqlCommand cmd = new SqlCommand("GetStudentInfo", conn);

    cmd.CommandType =CommandType.StoredProcedure;

    cmd.Parameters.Add(new SqlParameter("@ID", AdminDropDown.SelectedValue));

    //cmd.Connection.Open();
    //cmd.ExecuteNonQuery();

    SqlDataAdapter ad = new SqlDataAdapter(cmd);

    ad.Fill(dt);     

    if (dt.Rows.Count > 0)
    {
        //If you want to get mutiple data from the database then you need to write a simple looping
        txtFirstName.Text = dt.Rows[0]["FirstName"].ToString();

        txtMiddleName.Text = dt.Rows[0]["MiddleName"].ToString();

        txtLastName.Text = dt.Rows[0]["LastName"].ToString();

        txtSignature.Text = dt.Rows[0]["Signature"].ToString();

    }

    ad.Dispose();  // e.g. this way

    cmd.Connection.Close();
} 
```

...或者更好（就像您已经对 SqlConnection conn 所做的那样）将其放入 using 块中：

```
using (SqlDataAdapter ad = new SqlDataAdapter(cmd))
{
  // put the code using ad here, ad is automatically disposed
} 
```

# eclipse - 如果我不能再分享我的项目，如何修复 Subclipse？

> ID：13956928
> 
> 赞同：8
> 
> 时间：2012-12-19T16:36:44.320
> 
> 标签：eclipse, svn, subclipse

我使用*Eclipse*进行编程，使用*SVN*进行版本控制。因为不久，我不能分享我的项目。单击*myproject* -> *Team* -> *Share* -> *SVN*后出现此错误：

> 选定的 SVN 连接器库不可用或无法加载。

当我查看 SVN 时，我收到以下消息：

> 无法创建视图：org.tigris.subversion.subclipse.ui.repository.RepositoriesView

我应该怎么做才能修复它？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-17T13:38:11.157

您使用的是颠覆性还是 Subclipse？

我对第一个有同样的问题，卸载它，安装 Subclipse，就是这样！

这是 [链接](http://subclipse.tigris.org/servlets/ProjectProcess?pageID=p4wYuA)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-20T07:31:20.097

我发现，我重新下载 Eclipse 并解压缩它，然后在 Eclipse 中重新安装 subversion，现在它可以工作了。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-07-16T13:57:48.433

**颠覆性的。与本机 JavaHL 1.8.13 连接。**

**当我从 Eclipse Marketplace 下载时， Subclipse**对我**不起作用**。

# jquery-mobile - Chrome 网络浏览器允许持久存储

> ID：13956936
> 
> 赞同：0
> 
> 时间：2012-12-19T16:37:08.020
> 
> 标签：jquery-mobile, google-chrome-extension, user-agent, ripple

在 Ubuntu Linux 上运行 Ripple 模拟器 (phonegap)。在我的应用程序（jquery mobile）中，我想创建一个文件（使用持久存储），问题是持久存储允许的存储配额为 0，临时存储为 2gb。

所以这有效：

```
window.webkitStorageInfo.requestQuota(LocalFileSystem.TEMPORARY, 1024*1024, function(grantedBytes) {...}); 
```

但如果我改为`LocalFileSystem.TEMPORARY`then `grantedBytes == 0`。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-07T12:50:50.330

我刚刚遇到了同样的问题。

持久存储需要用户在 Chrome 中的许可。您可以通过以下方式请求：

```
window.webkitStorageInfo.requestQuota(window.PERSISTENT, 5*1024*1024 /* 5MB */, function(grantedBytes) {
  window.webkitRequestFileSystem(window.PERSISTENT, grantedBytes, onInitFs, errorHandler);
}, function(e) {
  console.log('Error', e);
}); 
```

我在[黑莓支持论坛](http://supportforums.blackberry.com/t5/Web-and-WebWorks-Development/More-details-about-FileSystem-API-support-in-Ripple-Emulator-v0/td-p/1920345)上找到了该解决方案，至少对我来说它有效。

# java - ANTLR3 语法吃整数

> ID：13956937
> 
> 赞同：2
> 
> 时间：2012-12-19T16:37:14.660
> 
> 标签：java, antlr

首先，我承认：这可能是你一生中见过的最丑陋的语法之一（讽刺地命名为 SimplePolicy.g）。它开始是一个简单的语法，但我最终需要更详细的异常，所以我最终制作了多个扩展 RecognitionException 的异常。然后是一个 RuntimeException 来包装它，这样我就可以摆脱解析器方法。

该语法应该验证一组一个或多个 IF/THEN/ELSE?/ENDIF 语句。不幸的是，当我尝试将 INTEGER_FIELD 令牌之一与 INTEGER 令牌进行比较时，INTEGER 令牌已完全从 TokenInputStream 中消失。我已经尝试将 println()s 洒在上面以弄清楚发生了什么，但没有运气。

下面是一个失败的例子：

IF AGE < 21 THEN WT > 150 ENDIF

似乎正在发生的事情是输入字符串很好，但是当我通过 CharStream 将它提供给 Lexer 时，整数常量消失了，AGE 和 WT 正在被比较消失。

这是一个单元测试：

```
@Test
public void ifStatement_legalPolicy2_passes() {
    String policy = "IF AGE < 21 THEN "+ 
                    "WT > 150 "+ 
                    "ENDIF";

    CharStream charStream = new ANTLRStringStream(policy);
    SimplePolicyLexer lexer = new SimplePolicyLexer(charStream);
    TokenStream tokenStream = new CommonTokenStream(lexer);
    System.out.println(tokenStream.toString());
    SimplePolicyParser parser = new SimplePolicyParser(tokenStream);    

    try {
        parser.ifStatement();
        parser.reset();
    } catch (RecognitionRuntimeException e) {
        RecognitionException e1 = e.getRecognitionException();
        fail("Legal policy should not have thrown exception. Exception thrown: " + e1.getClass().getName() + ". Line: " + e1.line + ", Column: " + e1.charPositionInLine);
    } catch (RecognitionException e) {
    }       

} 
```

这是令牌流的字符串输出：

```
13:14:14.978 DEBUG m.a.k.m.impl.SimplePolicyParser - ifStatement: IF AGE <  THEN WT >  ENDIF 
```

我为这个语法的丑陋道歉，但如果有人能告诉我为什么它会死，我会非常感激。

```
grammar SimplePolicy;

options {
  language = Java;
  backtrack = true;
}

@header {
package com.manager.impl;

import com.manager.RecognitionRuntimeException;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import java.util.Arrays;

@lexer::header {
package com.manager.impl;

}

@lexer::members {

}

@parser::members {

 private static final Logger log = LoggerFactory.getLogger(SimplePolicyParser.class);

 @Override
 protected Object recoverFromMismatchedToken(IntStream input, int ttype, BitSet follow) throws RecognitionException {
   throw new MismatchedTokenException(ttype, input);
 }

  @Override
 public Object recoverFromMismatchedSet(IntStream input, RecognitionException e, BitSet follow) throws RecognitionException {
   throw e;
 }

 @Override
 public String getErrorMessage(RecognitionException e, String[] tokenNames) {
  // wrap in a runtime exception to escape ANTLR's dungeon
  throw new RecognitionRuntimeException(e);
 }

}

@rulecatch {
    catch (RecognitionException e) {
           System.out.println(getErrorHeader(e));
      //System.out.println(getErrorMessage(e,tokenNames));
        throw new RecognitionRuntimeException(e);
    }
}

// evaluate multiple show statements
policyGroupWithShow
  : show (show)* EOF
  | ifStatement+ EOF
  {
    // nope, this isn't legal
    ShowExpectedException ex = new ShowExpectedException();
    ex.line = 1;
    ex.charPositionInLine=0;
    throw ex;
  }
  ;

policyGroupWithoutShow
  : ifStatement (ifStatement)* EOF
  | show+ EOF
  {
    // not legal
    UnexpectedSymbolOrConstructionException ex = new UnexpectedSymbolOrConstructionException();
    ex.line = 1;
    ex.charPositionInLine = 0;
    throw ex;
  }
  ;

//policyGroup
//  : show (show)* EOF
//  ;

// evaluate a single SHOW statement
show
  //: ifStatement
  : SHOW STRING FOR ifStatement // good
  // missing for (FOR expected)
  | SHOW expr1a=STRING ifStatement // missing for
  {
    int nextTokenPosition = expr1a.getTokenIndex();
    CommonToken token = (CommonToken) input.get(nextTokenPosition + 1);

    ShowWithoutForException ex = new ShowWithoutForException();
    ex.line = expr1a.getLine();
    ex.charPositionInLine = token.getCharPositionInLine();
    throw ex;

  }
  // missing show (SHOW expected)
  | expr1b=STRING FOR ifStatement
  {
    int tokenPosition = expr1b.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition);
    ForWithoutShowException ex = new ForWithoutShowException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  ;

ifStatement
  @init {
    log.debug("ifStatement: " + input.toString());
  }
  //: IF logical THEN logical+ (ELSE logical+)? ENDIF
  : IF operation 'THEN' expression+ ENDIF // good
  {
    log.debug("Matched [IF logical THEN expression+ ENDIF]");
  }
  | IF logical THEN expression+ ELSE expression+ ENDIF
  {
    log.debug("Matched [IF logical THEN expression+ ELSE expression+ ENDIF]");
  }
  | logical expr1a=THEN expression* (ELSE expression*)? ENDIF // missing if
  {
    int tokenPosition = expr1a.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition);
    MissingIfException ex = new MissingIfException();
    ex.line = token.getLine();
    ex.charPositionInLine = 0;
    throw ex;
  }
  // missing THEN (THEN clause is missing)
  | expr1b=IF logical expression+ (ELSE expression+)? ENDIF
  {
    int tokenPosition = expr1b.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);
    MissingThenClauseException ex = new MissingThenClauseException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getCharPositionInLine();
    throw ex;
  }
  // missing ELSE or ENDIF (ENDIF Expected)
  | IF logical expr1c=THEN expression+
  {
    String inputText = input.toString();
    if (inputText.indexOf("ELSE") < 0 && inputText.indexOf("ENDIF") < 0) {
      // best I can do is get the line/column from the THEN keyword
        MissingElseOrEndifException ex = new MissingElseOrEndifException();
        ex.line = expr1c.getLine();
        ex.charPositionInLine = expr1c.getCharPositionInLine();
        throw ex;   
    }
  }
  // missing comparison for IF (rule expected)
  | IF expr1d=THEN expression* ENDIF
  {
    int tokenPosition = expr1d.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition - 1);

    RuleExpectedException ex = new RuleExpectedException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStopIndex();
    throw ex;
  }
  // missing body of then (unexpected symbol or construction)
  | IF logical a=THEN b=ENDIF
  {
    int tokenPosition1 = a.getTokenIndex();
    int tokenPosition2 = b.getTokenIndex();
    CommonToken tokenA = (CommonToken) input.get(tokenPosition1);
    CommonToken tokenB = (CommonToken) input.get(tokenPosition2);

    UnexpectedSymbolOrConstructionException ex = new UnexpectedSymbolOrConstructionException();
    //MissingThenBodyException ex = new MissingThenBodyException();
    if (tokenA.getLine() == tokenB.getLine()) {
      ex.line = tokenA.getLine();
      ex.charPositionInLine = tokenA.getCharPositionInLine();
    } else {
      ex.line = tokenA.getLine() + 1;
      ex.charPositionInLine = 0;
    }
    throw ex;
  }
  // missing body of ELSE (Unexpected symbol or construction)
  | IF logical THEN expression+ ELSE expr3e=ENDIF
  {

    UnexpectedSymbolOrConstructionException ex = new UnexpectedSymbolOrConstructionException();
    ex.line = expr3e.getLine();
    ex.charPositionInLine = expr3e.getCharPositionInLine();
    throw ex;
  }
  // body of IF missing (Body of IF clause is missing)
  | IF expr3f=ENDIF
  {
    int tokenPosition = expr3f.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition);

    MissingIfBodyException ex = new MissingIfBodyException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getCharPositionInLine();
    throw ex;
  }
  | expression // expression should just pass through
  ;

expression
  @init {
    log.debug("Expression: " + input.toString());
  }
  : logical
  ;

// deal with AND/OR operator
logical
  @init {
    log.debug("Logical:" + input.toString());
  }
 : operation (AND operation | OR operation)*
 ;

operation
  @init {
    log.debug("Operation:" + input.LT(1) + input.LT(2) + input.LT(3));
  }
  // good rules
  //: ';' ~('/r/n'|EOF)*
  : DATE_FIELD (EQ|NE|LT|LE|GT|GE) (DATE_FIELD|DATE|DATE_CONSTANT)
  {

    log.info("Matched STRING_FIELD (EQ|NE) (STRING_FIELD|STRING) field operation: " + input.toString());
  }
  | DATE_FIELD (PLUS|MINUS) (DATE_FIELD|DATE|DATE_CONSTANT|DATE_PERIOD_FIELD|datePeriod)
  {
    log.info("Matched DATE_FIELD (PLUS|MINUS) (DATE_FIELD|DATE|DATE_CONSTANT|DATE_PERIOD_FIELD|datePeriod) field operation: " + input.toString());
  }
  | DATE_PERIOD_FIELD (EQ|NE|LT|LE|GT|GE) (DATE_PERIOD_FIELD|DATE_PERIOD_CONSTANT)
  {
    log.info("Matched DATE_PERIOD_FIELD (EQ|NE|LT|LE|GT|GE) (DATE_PERIOD_FIELD|DATE_PERIOD_CONSTANT) field operation: " + input.toString());
  }
  | DATE_PERIOD_FIELD (PLUS|MINUS) (DATE_PERIOD_FIELD|datePeriod|DATE_FIELD|DATE_CONSTANT|DATE)
  {
    log.info("Matched DATE_PERIOD_FIELD (PLUS|MINUS) (DATE_PERIOD_FIELD|datePeriod|DATE_FIELD|DATE_CONSTANT|DATE) field operation: " + input.toString());
  }
  | STRING_FIELD (EQ|NE) (STRING_FIELD|STRING)
  {
  log.info("Matched STRING_FIELD (EQ|NE) (STRING_FIELD|STRING) field operation: " + input.toString());
  }
  | INTEGER_FIELD (EQ|NE|LT|LE|GT|GE) test=inAllFields
  {
    Boolean result = $inAllFields.result;
    Integer type = $inAllFields.tokenType;

    //int testType = test.getType();
    if (type != INTEGER && type != INTEGER_FIELD) {

        IncompatibleTypeException ex = new IncompatibleTypeException();
        //ex.line = test.getLine();
        //ex.charPositionInLine = test.getStartIndex();
        throw ex;
    }
  }
  | INTEGER_FIELD (EQ|NE|LT|LE|GT|GE) test1=(INTEGER_FIELD|INTEGER)
  {
    log.info(test1.getText());
    log.info("Matched INTEGER_FIELD (EQ|NE|LT|LE|GT|GE) (INTEGER_FIELD|INTEGER) field operation: " + input.toString());
  }
  | BOOLEAN_FIELD (EQ|NE) (BOOLEAN_FIELD|BOOLEAN_CONSTANT)
  {
  log.info("Matched BOOLEAN_FIELD (EQ|NE) (BOOLEAN_FIELD|BOOLEAN_CONSTANT) field operation: " + input.toString());
  }
  | COMMENT
  {
  log.info("Matched COMMENT field operation: " + input.toString());

  }
  // specify bad rules
  // defined fields with no operation. The expression will be null if datePeriod isn't split off
  | (INTEGER_FIELD|INTEGER) (PLUS|MINUS|EQ|NE|LT|LE|)
  {
    System.out.println("Will it work?");
  }
  | (datePeriod)|e1=(DATE_PERIOD_FIELD|DATE_FIELD|STRING_FIELD|INTEGER_FIELD|WAIVER_FIELD|BOOLEAN_FIELD|BOOLEAN_CONSTANT)
  {
    RelationalOperatorOrNotExpectedException ex = new RelationalOperatorOrNotExpectedException();
    if (e1 == null) {
        ex.line = 1;
        ex.charPositionInLine = 0;
    } else {
      ex.line = e1.getLine();
      ex.charPositionInLine = e1.getCharPositionInLine();
    }
    throw ex;
  }
  | e2=(INTEGER|DATE|DATE_CONSTANT)
  {
    RuleCannotBeginWithNumberOrDateException ex = new RuleCannotBeginWithNumberOrDateException();
    ex.line = e2.getLine();
    ex.charPositionInLine = e2.getCharPositionInLine();
    throw ex;
  }
  // attempt to compare a date field to a different field type. Incompatable Type exception
  | DATE_FIELD operator1a=(EQ|NE|LT|LE|GT|GE) (DATE_PERIOD_FIELD|datePeriod|STRING_FIELD|STRING|INTEGER_FIELD|INTEGER|WAIVER_FIELD|BOOLEAN_FIELD|BOOLEAN_CONSTANT)
  {
    int tokenPosition = operator1a.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 2);

    IncompatibleTypeException ex = new IncompatibleTypeException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  // attempt to add/sub illegal field types to date (Relational Operator or NOT expected)
  | DATE_FIELD operator1b=(PLUS|MINUS)
      (STRING_FIELD|STRING|INTEGER_FIELD|WAIVER_FIELD|BOOLEAN_FIELD|BOOLEAN_CONSTANT)
  {
    int tokenPosition = operator1b.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition+1);

    RelationalOperatorOrNotExpectedException ex = new RelationalOperatorOrNotExpectedException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex; 
  }
  // attempting to add an int to a date field makes it assume it's a bad date period
  | DATE_FIELD operator1c=(PLUS|MINUS) expr1c=(INTEGER)
  {
   int tokenPosition = operator1c.getTokenIndex();
   CommonToken token = (CommonToken) input.get(tokenPosition + 1);

   MissingYearsMonthsWeeksDaysException ex = new MissingYearsMonthsWeeksDaysException();
   ex.line = token.getLine();
   ex.charPositionInLine = token.getStartIndex();
   throw ex;
  }
  // attempt to compare a String field to something besides a String field or String constant
  | STRING_FIELD operator2a=(EQ|NE) ~(STRING_FIELD|STRING)
  {
    int tokenPosition = operator2a.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    IncompatibleTypeException ex = new IncompatibleTypeException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  | expr2b=STRING_FIELD operator2b=(LT|LE|GT|GE) (STRING_FIELD|STRING)
  {
    int tokenPosition = operator2b.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    UnexpectedSymbolOrConstructionException ex = new UnexpectedSymbolOrConstructionException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  | stringExpr3=STRING
  {
    RuleCannotBeginWithAStringException ex = new RuleCannotBeginWithAStringException();
    ex.line = stringExpr3.getLine();
    ex.charPositionInLine = stringExpr3.getCharPositionInLine();
    throw ex;
  }
  // attempt to compare a number field to something besides a num field or int constant

  | INTEGER_FIELD operator3a=(EQ|NE|LT|LE|GT|GE) expr3a2=(DATE_FIELD|DATE|STRING_FIELD|STRING|DATE_PERIOD_FIELD|WAIVER_FIELD|BOOLEAN_FIELD|BOOLEAN_CONSTANT)
  {
    Boolean value = $inAllFields.result;
    //System.out.println("Expr text: " + expr3a2.getText());
    int tokenPosition = operator3a.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    IncompatibleTypeException ex = new IncompatibleTypeException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  // attempt to perform a PLUS/MINUS on a number field with something besides a num field or constant int
  | INTEGER_FIELD operator3b=(PLUS|MINUS)
    (DATE_FIELD|DATE|STRING_FIELD|STRING|DATE_PERIOD_FIELD|datePeriod|WAIVER_FIELD|BOOLEAN_FIELD|BOOLEAN_CONSTANT)
  {
    int tokenPosition = operator3b.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    IncompatibleTypeException ex = new IncompatibleTypeException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex; 
  }
  // attempt to compare date period to something besides a date period field or date period constant
  | DATE_PERIOD_FIELD operator4a=(EQ|NE|LT|LE|GT|GE)
    (INTEGER_FIELD|INTEGER|DATE_FIELD|DATE|DATE_CONSTANT|STRING_FIELD|STRING|BOOLEAN_FIELD|BOOLEAN_CONSTANT|WAIVER_FIELD)
  {
    int tokenPosition = operator4a.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    IncompatibleTypeException ex = new IncompatibleTypeException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  | DATE_PERIOD_FIELD operator5a=(PLUS|MINUS) (STRING_FIELD|STRING|INTEGER_FIELD|WAIVER_FIELD|BOOLEAN_FIELD|BOOLEAN_CONSTANT)
  {
    int tokenPosition = operator5a.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    RelationalOperatorOrNotExpectedException ex = new RelationalOperatorOrNotExpectedException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  | DATE_PERIOD_FIELD operator5b=(PLUS|MINUS) INTEGER
  {
    int tokenPosition = operator5b.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    MissingYearsMonthsWeeksDaysException ex = new MissingYearsMonthsWeeksDaysException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  | WAIVER_FIELD operator6a=(HAS|EQ|NE) ~(STRING)
  {
    int tokenPosition = operator6a.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    IncompatibleTypeException ex = new IncompatibleTypeException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  | WAIVER_FIELD operator6b=(PLUS|MINUS|LT|LE|GT|GE)  STRING
  {
    int tokenPosition = operator6b.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    UnexpectedSymbolOrConstructionException ex = new UnexpectedSymbolOrConstructionException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  | BOOLEAN_FIELD operator7a=(EQ|NE) ~(BOOLEAN_FIELD|BOOLEAN_CONSTANT)
  {
    int tokenPosition = operator7a.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    IncompatibleTypeException ex = new IncompatibleTypeException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex; 
  }
  | BOOLEAN_FIELD operator7b=(PLUS|MINUS|LT|LE|GT|GE) (DATE_FIELD|DATE|DATE_CONSTANT|DATE_PERIOD_FIELD|datePeriod|STRING_FIELD|STRING|INTEGER_FIELD|WAIVER_FIELD|BOOLEAN_FIELD|BOOLEAN_CONSTANT)
  {
    int tokenPosition = operator6b.getTokenIndex();
    CommonToken token = (CommonToken) input.get(tokenPosition + 1);

    UnexpectedSymbolOrConstructionException ex = new UnexpectedSymbolOrConstructionException();
    ex.line = token.getLine();
    ex.charPositionInLine = token.getStartIndex();
    throw ex;
  }
  ;

// this rule checks that a value is valid. It's not in the validation
// chain
atom
  : datePeriod
  | DATE_FIELD
  | INTEGER_FIELD
  | STRING_FIELD
  | DATE_PERIOD_FIELD
  | WAIVER_FIELD
  | BOOLEAN_FIELD
  | INTEGER
  {
    System.out.println("Matched atom INTEGER");
  }
  | DATE
  | DATE_CONSTANT
  | BOOLEAN_CONSTANT
  | STRING
  //| LPAREN expression RPAREN
  ;

datePeriod
  : (DATE_PERIOD_CONSTANT)+
  ;

// "subatomic" rules, meant to feed the atom rule understandable values

fragment DIGIT: ('0'..'9');

DATE_FIELD:('DOB'|'TEST_DATE');
DATE_PERIOD_FIELD:('AFS');
BOOLEAN_FIELD:('CERTIFIED'|'OVERRIDE');
INTEGER_FIELD:('AGE'|'HT'|'WT');
STRING_FIELD:('CURR_LOC'|'LANG_1'|'LANG_2''USER_LEVEL');
WAIVER_FIELD:('WAIVER');

DATE: /* empty */ {System.out.println("Matched DATE");};

INTEGER: DIGIT+
//INTEGER:('0'..'9')+
{
  System.out.println("Matched INTEGER: " + $text);
  //$type = INTEGER;
    // dynamically change the type when we match the date regular expression
  if ($text.matches("(19|20|21)[0-9]{2}[0-1]\\d{3}")) {
  //if ($text.matches("(19|20|21)[0-9]{2}[0-1]\\d{3}")) {
    System.out.println("Matched date pattern");
    $type = DATE;
  }

}
;
DATE_PERIOD_CONSTANT: ((INTEGER ' ' YEAR)|(INTEGER ' ' MONTH)|(INTEGER ' ' WEEK)|(INTEGER ' ' DAY))
{
  System.out.println("Matched DATE_PERIOD_CONSTANT");
};
DATE_CONSTANT:('TODAY'|'YESTERDAY'|'TOMMOROW');
BOOLEAN_CONSTANT:('TRUE'|'FALSE'|'"Y"'|'"N"');
IF: 'IF';
THEN: 'THEN';
ELSE: 'ELSE';
ENDIF: 'ENDIF';
AND: 'AND';
OR: 'OR';
YEAR: ('YEAR'|'YEARS');
MONTH: ('MONTH'|'MONTHS');
WEEK: ('WEEK'|'WEEKS');
DAY: ('DAY'|'DAYS');

STRING: '"' ID  (' ' ID)* '"' {System.out.println("Matched STRING");};
//  {
//    // strip the quotes once we match this token
//    setText(getText().substring(1, getText().length()-1));
//  }
//  ;

EQ: '=' {System.out.println("Matched EQ");};
NE: '<>';
LT: '<';
LE: '<=';
GT: '>';
GE: '>=';
HAS: 'HAS';
LPAREN: '(';
RPAREN: ')';
PLUS: '+';
MINUS: '-';
SHOW: 'SHOW';
FOR: 'FOR';
ID: ('A'..'Z'|'a'..'z'|'0'..'9'|','|'!'|'?'|':')+ {System.out.println("Matched ID: " + $text);};

COMMENT: ';' ~('\r'|'\n')* {skip();};
WS: (' '+|'\r'|'\n'|'\t') {$channel = HIDDEN;}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T18:56:11.407

每当您的词法分析器“看到”一个数字后跟一个空格时，它就会尝试构造一个`DATE_PERIOD_CONSTANT`. 改为使用解析器规则：

```
date_persiod_constant
 : INTEGER (YEAR | MONTH | WEEK | DAY)
 ; 
```

*（当然要删除`DATE_PERIOD_CONSTANT`）*

此外，您的`DATE`规则不匹配任何内容。我了解您需要此规则来更改规则的类型`INTEGER`，但永远不要创建（可能）不匹配的词法分析器规则。改为`DATE`：_`fragment`

```
fragment DATE : ; 
```

即使它是一个`fragment`你仍然可以`DATE`在你的解析器规则中使用。通过将其设为 a `fragment`，您只是在指示词法分析器永远不要`DATE`自己创建标记，但*您*知道词法分析器*可以*生成此类标记，因为您正在更改`INTEGER`它看起来像日期的类型。

## 编辑

> 有什么方法可以将其保留为词法分析器规则？我真的希望日期常量发出一个我以后可以使用的令牌。

当然，这是可能的。不漂亮，但可能：

```
INTEGER
 : DIGIT+ ( (' '+ (YEAR | MONTH | WEEK | DAY))=> 
             ' '+ (YEAR | MONTH | WEEK | DAY) {$type = DATE_PERIOD_CONSTANT;}
          )?
   {
     if ($text.matches("(19|20|21)[0-9]{2}[0-1]\\d{3}")) {
       $type = DATE;
     }
   }

 ;

fragment DATE_PERIOD_CONSTANT : ; 
```

这样做是在匹配一个或多个数字之后`DIGIT+`，它会强制词法分析器在字符流中向前看，以查看是否有一个或多个空格后跟一个`YEAR`,或`MONTH`,谓词，如果是，它会继续前进与此匹配（并且您将类型从 更改为）。`WEEK``DAY``(' '+ (YEAR | MONTH | WEEK | DAY))=>``INTEGER``DATE_PERIOD_CONSTANT`

## 编辑二

> 最后一个问题：日期期间可以是“1 YEAR 4 MONTHS 2 DAYS”之类的东西，而不仅仅是“1 YEAR”之类的单个。尝试向规则添加 + 不成功。我可以要求再提供一次帮助以使该规则按我需要的方式工作吗？

这样的事情应该这样做（但同样，解析器规则可能更合适！）：

```
INTEGER
 : (DATE_PERIOD_CONSTANT)=> DATE_PERIOD_CONSTANT ((' '+ DATE_PERIOD_CONSTANT)=> ' '+ DATE_PERIOD_CONSTANT)*
   {
     $type=DATE_PERIOD_CONSTANT;
   }
 | DIGIT+
   {
     if ($text.matches("(19|20|21)[0-9]{2}[0-1]\\d{3}")) {
       System.out.println("Matched date pattern");
       $type = DATE;
     }
   }   
 ;

fragment DATE_PERIOD_CONSTANT
 : DIGIT+ ' '+ (YEAR | MONTH | WEEK | DAY)
 ; 
```

# php - 正确的 PHP 方法来检查外部图像是否存在？

> ID：13956939
> 
> 赞同：13
> 
> 时间：2012-12-19T16:37:16.440
> 
> 标签：php, image, exists

我知道至少有 10 个相同的问题有答案，但似乎没有一个能完美地为我工作。我正在尝试检查是否存在内部或外部图像（图像 URL 是否有效？）。

1.  `fopen($url, 'r')`除非我使用失败`@fopen()`：

    ```
    Warning: fopen(http://example.com/img.jpg) [function.fopen]: failed to open stream: HTTP request failed! HTTP/1.1 404 Not Found in file.php on line 21 
    ```

2.  `getimagesize($img)`图像不存在时失败（PHP 5.3.8）：

    ```
    Warning: getimagesize() [function.getimagesize]: php_network_getaddresses: getaddrinfo failed 
    ```

3.  CURL 失败是因为某些服务器不支持它（尽管它几乎无处不在）。
4.  `fileExists()`失败是因为它不适用于外部 URL，并且无法检查我们是否正在处理图像。

作为此类问题最常见答案的四种方法是错误的。这样做的正确方法是什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-19T16:47:47.867

`getimagesize($img) fails when image doesn't exist:`我不确定你明白你想要什么......

来自 PHP 文档

> getimagesize() 函数将确定任何给定图像文件的大小，并返回尺寸以及文件类型和要在普通 HTML IMG 标记和相应 HTTP 内容类型中使用的高度/宽度文本字符串。
> 
> **失败时，返回 FALSE。**

例子

```
$img = array("http://i.stack.imgur.com/52Ha1.png","http://example.com/img.jpg");
foreach ( $img as $v ) {
    echo $v, getimagesize($v) ? " = OK  \n" : " = Not valid \n";
} 
```

输出

```
http://i.stack.imgur.com/52Ha1.png = OK  
http://example.com/img.jpg = Not valid 
```

`getimagesize`工作得很好

*   [PHP 5.3.19](http://codepad.viper-7.com/LXWqaB)
*   [PHP 5.4.9](http://codepad.viper-7.com/brbuM8)

编辑

> @Paul 。但是您的问题本质上是在说“我该如何处理，这样在出现错误情况时我就不会收到错误”。答案是“你不能”。因为所有这些函数都会在出现错误条件时触发错误。所以（如果你不想要错误）你压制它。这些在生产中都不重要，因为无论如何你都不应该显示错误；-) – [DaveRandom](https://stackoverflow.com/users/889949/daverandom)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-19T16:48:29.023

此代码实际上是检查文件...但是，它确实适用于图像！

```
$url = "http://www.myfico.com/Images/sample_overlay.gif";
$header_response = get_headers($url, 1);
if ( strpos( $header_response[0], "404" ) !== false )
{
   // FILE DOES NOT EXIST
} 
else 
{
   // FILE EXISTS!!
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-23T08:52:22.303

```
function checkExternalFile($url)
{
    $ch = curl_init($url);
    curl_setopt($ch, CURLOPT_NOBODY, true);
    curl_exec($ch);
    $retCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    curl_close($ch);

    return $retCode;
}

$fileExists = checkExternalFile("http://example.com/your/url/here.jpg");

// $fileExists > 400 = not found
// $fileExists = 200 = found. 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T16:45:11.727

如果您使用 PHP >=5.0.0，您可以向 fopen 传递一个附加参数来指定 HTTP 的上下文选项，其中包括是否忽略失败状态代码。

```
$contextOptions = array( 'http' => array('ignore_errors' => true));

$context = stream_context_create($contextOptions);

$handle = fopen($url, 'r', false, $context); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T16:41:38.467

您可以为此使用 PEAR/HTTP_Request2 包。你可以在[这里找到](http://pear.php.net/package/HTTP_Request2/redirected)

这里有一个例子。该示例要求您已正确安装或下载 HTTP_Request2 包。它使用旧式插座适配器，而不是卷曲。

```
<?php

require_once 'HTTP/Request2.php';
require_once 'HTTP/Request2/Adapter/Socket.php';

$request = new HTTP_Request2 (
    $your_url, 
    HTTP_Request2::METHOD_GET,
    array('adapter' => new HTTP_Request2_Adapter_Socket())
);

switch($request->send()->getResponseCode()) {

    case 404 : 
        echo 'not found';
        break;

    case 200 :
        echo 'found';
        break;

    default :
        echo 'needs further attention';

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T16:43:20.227

使用`fsockopen`，连接到服务器，发送`HEAD`请求并查看您返回的状态。

唯一需要注意的问题是该域是否不存在。

示例代码：

```
$file = "http://example.com/img.jpg";
$path = parse_url($file);
$fp = @fsockopen($path['host'],$path['port']?:80);
if( !$fp) echo "Failed to connect... Either server is down or host doesn't exist.";
else {
  fputs($fp,"HEAD ".$file." HTTP/1.0\r\n"
     ."Host: ".$path['host']."\r\n\r\n");
  $firstline = fgets($fp);
  list(,$status,$statustext) = explode(" ",$firstline,3);
  if( $status == 200) echo "OK!";
  else "Status ".$status." ".$statustext."...";
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-31T11:33:08.157

我发现 try catch 是最好的解决方案。它对我很好。

```
try{
      list($width, $height) = getimagesize($h_image->image_url);
   }
catch (Exception $e)
    {
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-02-27T09:27:40.440

我知道你写了“没有卷曲”，但仍然有人可能会觉得这很有帮助：

```
function curl_head($url) {

    $ch = curl_init($url);

    //curl_setopt($ch, CURLOPT_USERAGENT, 'Your user agent');
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_HEADER, 1); # get headers
    curl_setopt($ch, CURLOPT_NOBODY, 1); # omit body
    //curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 1); # do SSL check
    //curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2); # verify domain within cert
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); # follow "Location" redirs
    //curl_setopt($ch, CURLOPT_TIMEOUT_MS, 700); # dies after 700ms

    $result = curl_exec($ch);

    curl_close($ch);

    return $result;
}

print_r(curl_head('https://www.example.com/image.jpg')); 
```

您将看到类似这样的内容`HTTP/1.1 200 OK`或`HTTP/1.1 404 Not Found` 在返回的标头数组中。您还可以使用`curl multi`.

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2012-12-19T16:43:29.593

有多个步骤，没有单一的解决方案：

1.  验证网址
2.  检查文件是否可用（可以直接用第3步完成）
3.  将图像下载到 tmp 文件中。
4.  使用 getimagesize 检查图像的大小。

对于此类工作，您可以捕获异常并妥善处理它们以定义您的答案。在这种情况下，您甚至可以抑制错误，因为它们的欺骗可能会失败。因此，您可以正确处理错误。

因为在没有下载实际图像的情况下不可能对其进行 100% 检查。因此，第 1 步和第 2 步是必需的，第 3 步和第 4 步是可选的，以获得更明确的答案。

# eclipse - 收集要安装的项目时出错：osgi.bundle,org.eclipse.sdk,4.2.0.v201206081400

> ID：13956940
> 
> 赞同：5
> 
> 时间：2012-12-19T16:37:16.310
> 
> 标签：eclipse, eclipse-plugin, eclipse-juno, xtext

我正在尝试将 Xtext 项目导出为 Eclipse 产品。如果从 Eclipse 中启动，启动配置可以完美运行，但我无法将其导出以制作独立的产品。我得到：

收集要安装的项目时发生错误会话上下文是：(profile=profile, phase=org.eclipse.equinox.internal.p2.engine.phases.Collect, operand=, action=)。下载工件时出现问题：osgi.bundle,org.eclipse.sdk,4.2.0.v201206081400。

org.eclipse.sdk-4.2.0.v201206081400 已作为项目导入工作区。我正在尝试使用“所有工作区和启用的目标插件”导出，而不是一一选择插件。

我在 Linux 64 位 (Sabayon) 上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-14T08:36:37.720

为运行平台构建应该不是问题。您是否创建了一个产品并尝试在 Eclipse 中运行它？我怀疑您正在将项目作为 Eclipse 实例运行，而不是来自产品项目

您能否确保更改产品上的启动画面并在 Eclipse 中运行它？

*   如果您看到您更改的初始屏幕并且它可以工作，那么当您尝试构建产品时它应该可以工作。
*   如果不是，您需要检查运行配置和产品配置之间缺少什么。

# python - 情绪分析/线性回归 (Django)

> ID：13956943
> 
> 赞同：4
> 
> 时间：2012-12-19T16:37:25.120
> 
> 标签：python, django, machine-learning, weka, sentiment-analysis

我需要关于如何分析此类数据的建议。我想作为机器学习工具对其进行情感分析或线性回归。预测器是分数。

```
color   type    make    new score

red     truck   ford    y   2
black   sedan   chevy   n   4
silver  sedan   nissan  y   5
silver  truck   nissan  n   2
black   coupe   toyota  y   1
blue    van     honda   y   1
red     truck   toyota  n   4
red     coupe   ford    n   2
black   sedan   ford    y   1
blue    truck   toyota  y   4
white   coupe   chevy   y   3
white   van     toyota  n   5
red     van     ford    y   2
silver  truck   nissan  n   3
black   sedan   honda   n   1
silver  truck   chevy   y   4
red     truck   chevy   y   5
white   coupe   honda   n   5
blue    sedan   chevy   n   2
blue    van     nissan  y   3 
```

我可以在 WEKA 中运行一个 LinearRegression 分类器，它会产生：

```
score =  1.6 ( color=red,silver,white) + 1.8 (make=honda,nissan,toyota,chevy) + 0.55 
```

但是，我想在 Django 中为 Web 应用程序实现这一点。是否有另一种方法来处理这些数据并产生不使用 WEKA 的线性回归方程。除了线性回归之外，还有其他关于如何分析它的建议吗？我已经实现了一个决策树。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:44:43.310

您可以使用[scikit-learn](http://scikit-learn.org/stable/)作为您的机器学习库，尤其是它的[线性回归功能](http://scikit-learn.org/0.12/modules/linear_model.html)。[这个例子](http://scikit-learn.org/0.12/auto_examples/linear_model/plot_ols.html#example-linear-model-plot-ols-py)也可能有用。

此外，您始终可以将 Weka java API 绑定到您的应用程序，或者自己实现线性回归，在给定矩阵代数库的情况下实现相当容易的算法。

# android - 无法从 Maven 添加 ActionBarSherlock 地图插件

> ID：13956945
> 
> 赞同：1
> 
> 时间：2012-12-19T16:37:28.547
> 
> 标签：android, intellij-idea, actionbarsherlock, actionbarsherlock-map

我的 Android 项目正在使用 Maven 来控制依赖项，我正在尝试使用来自 Jake Wharton 的 ActionBarSherlock 地图插件。

我已将 Jake 的 Maven 存储库添加到我的 pom.xml 文件中，并尝试使用 IntelliJ IDEA 更新按钮更新我的本地存储库，但它总是返回错误。

你能帮助我吗？

来自 Jake Wharton 的 github 的内容：

```
 <!-- If you are a Maven user you can easily include the library by specifying it as a dependency: -->

    <dependency>
       <groupId>com.actionbarsherlock</groupId>
       <artifactId>plugin-maps</artifactId>
      <version><!-- LATEST PLUGIN VERSION --></version>
    </dependency>

    <!-- Since the Google Maps APIs are not available in central this plugin is deployed to Jake Wharton's personal repository. You can add it with the following: -->

    <repository>
      <id>com.jakewharton</id>
      <url>http://r.jakewharton.com/maven/release</url>
    </repository> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T15:21:57.700

我已将类代码复制到我的包中，并将以下行添加到我的 AndroidManifest.xml：

```
 <uses-library android:name="com.google.android.maps" /> 
```

# tastypie - 使用 ToOneField 发布到模型

> ID：13956947
> 
> 赞同：-1
> 
> 时间：2012-12-19T16:37:34.783
> 
> 标签：tastypie

我是新来的美味派，正在尝试发布到以下模型：

```
class UserScore(models.Model):
    """
    User Scores, used to categorise users
    """
    user     = models.OneToOneField(User)
    category = models.ForeignKey(Category)
    score    = models.IntegerField() 
```

这是我的api：

```
class UserScoreResource(ModelResource):
    category = fields.ForeignKey(CategoryResource, 'category')
    user = fields.OneToOneField(UserResource, 'user')

class Meta:
    queryset = UserScore.objects.all() 
    resource_name = 'score'
    authorization=Authorization()
    allowed_methods = ['post', 'put', 'get'] 
```

在我的单元测试中，我试图运行以下命令：

```
def test_no_post_to_userscore(self):
    post_data = {
        'user': {'resource_uri':'/api/v1/user/0/'}, 
        'category': {'resource_uri':'/api/v1/category/0/'},
        'score': 50,
    }
    print response.status_code 
```

但我收到一个 500 错误。非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T17:02:55.127

已解决 - 语法错误。漫长的一天

谢谢

# ruby-on-rails-3 - Rails 关联和迁移

> ID：13956952
> 
> 赞同：-1
> 
> 时间：2012-12-19T16:37:51.143
> 
> 标签：ruby-on-rails-3

我正在尝试创建一个日志，在`journal_entries`调用索引视图时列出登录用户的日志。

我已经为用户注册、登录/注销身份验证安装了 Devise gem。

我创建了一个模型，`JournalEntries`其中包括日期、字符串和文本字段。

创建数据库，`rake db:create`然后迁移后，`rake db:migrate`我试图在 journal_entries/index 视图中列出用户的日记条目。通过脚手架派生的默认视图列出了 ALL USERS journal_entries。这并不能成为一本出色的日记 - 您可以在其中查看所有其他用户的条目。

在我的研究中，我意识到我在`journal_entries`表中没有引用用户表的字段。

我在下面创建了一个迁移节目：

```
class AddForeignKeyToJournalEntries < ActiveRecord::Migration
  def up
    change_table :journal_entries do |t|
        t.references :user
    end
    #add a foreign key
    execute <<-SQL
        ALTER TABLE journal_entries
            ADD CONSTRAINT fk_journal_entries_users
            FOREIGN KEY (user_id)
            REFERENCES users(id)
    SQL
  end

  def down
    execute <<-SQL
        ALTER TABLE journal_entries
            DROP FOREIGN KEY fk_journal_entries_users
    SQL
  end

end 
```

（我还更改了 users.rb 和 journal_entries.rb 模型以包含 belongs_to 和 has_many 关联 - 起初我以为这就是我必须做的，并且不知何故数据库会选择它，但它没有......）

这成功地将外键 - user_id 添加到 journal_entries 表中，我以为我很清楚。

现在发生的事情是创建 journal_entry 时 - user_id 列是空白的 - 那里没有填充任何信息......？我通过在本地机器上登录 Postgres 验证了这一点。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-19T16:50:26.820

您需要确保在构建 的新实例时`JournalEntry`它知道与当前用户的关联：

```
# app/controllers/journal_entries_controller.rb
...
def create
  @journal_entry = current_user.build_journal_entry(params[:journal_entry])
... 
```

[请参阅 Rails Guide for Active Record Associations](http://guides.rubyonrails.org/association_basics.html#belongs_to-build_association)的相关部分。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-19T16:53:02.337

journal_entry 表中 user_id 列为空的原因是因为您需要在创建新的日记条目时添加当前用户的 id。

在您的 JournalEntries 控制器中，您需要将其添加到您的创建操作中：

`@journal_entry.user_id = current_user.id`

或者，`@journal_entry.user = current_user`

然后，在您的 JournalEntries Controller 索引操作中：

而不是`@journal_entries = JournalEntry.all`您可以仅显示当前登录用户的条目`@journal_entries = current_user.journal_entries`。

希望有帮助！

# c++ - 将本征仿射变换转换为本征等距变换

> ID：13956953
> 
> 赞同：9
> 
> 时间：2012-12-19T16:37:55.793
> 
> 标签：c++, transform, eigen

**[使用Eigen](http://eigen.tuxfamily.org)**库将仿射变换转换为等距变换（即仅包含旋转和平移）的最简单方法是什么？

两种转换都是 3D 的。仿射矩阵对左上象限有一个一般的 3x3 矩阵（即旋转、缩放和剪切），而等距矩阵对同一象限有一个 3x3 旋转矩阵，因此需要投影。

```
Eigen::AffineCompact3f a;
Eigen::Isometry3f b(a); 
```

给出编译错误：

> 错误 C2338：YOU_PERFORMED_AN_INVALID_TRANSFORMATION_CONVERSION

同时

```
Eigen::AffineCompact3f a;
Eigen::Isometry3f b(a.rotation(), a.translation()); 
```

给

> （第 2 行）错误 C2661：'Eigen::Transform<_Scalar,_Dim,_Mode>::Transform'：没有重载函数需要 2 个参数

和

```
Eigen::AffineCompact3f a;
Eigen::Isometry3f b;
b.translation() = a.translation();
b.rotation() = a.rotation(); 
```

给

> （第 4 行）错误 C2678：二进制“=”：未找到采用“const Eigen::Matrix<_Scalar,_Rows,_Cols>”类型的左侧操作数的运算符（或没有可接受的转换）

给定旋转（）和平移（）函数，问题可以改写为“如何最好地设置等距变换的旋转和平移分量？”

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-20T08:50:38.563

.rotation() 提取变换的旋转部分。它涉及 SVD，因此它是只读的。在左侧，您必须使用 .linear()：

```
Eigen::AffineCompact3f a;
Eigen::Isometry3f b;
b.translation() = a.translation();
b.linear() = a.rotation(); 
```

如果您知道“a”是等轴测图并且只想将其转换为等轴测图 3f，您可以简单地执行以下操作：

```
b = a.matrix(); 
```

# python - 如何让闭包引用变量在定义时的值

> ID：13956960
> 
> 赞同：-1
> 
> 时间：2012-12-19T16:38:30.970
> 
> 标签：python, closures

> **可能重复：**
> [在循环中创建 lambda](https://stackoverflow.com/questions/7546285/creating-lambda-inside-a-loop)

在下面的代码中，调用返回的闭包数组的任何成员都会打印数字 4。

```
def go():
    x = []
    for i in range(5):
        def y(): print i
        x.append(y)

    return x 
```

我希望闭包的每个成员都打印`i`定义闭包时的数字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:40:23.107

解决此问题的一种方法是使用默认参数：

```
def y(i=i): 
    print i 
```

默认参数是在创建函数时评估的，而不是调用函数，所以这正如你所期望的那样工作。

```
>>> i = 1
>>> def y(i=i): print i
... 
>>> i = 2
>>> y()
1 
```

* * *

一些额外的信息只是为了好玩：

如果您好奇默认值是什么，您可以随时使用`.func_defaults`属性（`__defaults__`在 python3.x 中）检查它：

```
>>> y.func_defaults
(1,) 
```

该属性也是可写的，因此您实际上可以在创建函数后通过在其中放置一个新元组来更改默认值。

# xslt - 转换后如何防止自关闭标签以及空标签

> ID：13956964
> 
> 赞同：3
> 
> 时间：2012-12-19T16:38:45.323
> 
> 标签：xslt, tags

我有一个输入文件：

```
<a></a>
<b/>
<c>text</c> 
```

我需要将其转换为字符串。使用变压器我得到低于输出：

```
<a/> <!-- Empty tags should not collapse-->
<b/>
<c>text</c> 
```

如果我使用 xslt 并且输出方法是“HTML”，我会得到以下输出：

```
<a></a> <!-- This is as expected-->
<b></b> <!-- This is not expected-->
<c>text</c> 
```

我想要与输入文件中的结构相同的结构。它在我的应用程序中是必需的，因为我需要计算索引并且更改索引计算逻辑将非常困难。

什么是正确的 XSLT 使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-24T06:53:28.713

什么 XSLT 处理器？XSLT 只是一种转换 xml 的语言，因此“html 输出”取决于处理器。

我猜这第一个解决方案对你来说太简单了，但我不得不使用它来避免处理原始 html

```
<xsl:copy-of select="child::node()" /> 
```

因为这应该克隆原始输入。就我而言，我使用以下内容提取具有 raw 属性的所有节点：

```
<xsl:for-each select="xmlData//node()[@raw]">
            <xsl:copy-of select="child::node()" />
</xsl:for-each> 
```

其他选项：

2) 为每个空节点添加一个属性，具体取决于您希望它稍后执行的操作，即role="long"、role="short-hand"。

3）循环遍历每个节点（xsl:for-each）

```
<xsl:choose>
<xsl:when test="string-length(.)=0"> <!-- There is no child-->
<xsl:copy-of select="node()" />
</xsl:when>
<xsl:otherwise>
...whatever normal processing you have
</xsl:otherwise> 
```

4）重新定义你的问题。两者都是有效的 XHTML/XML，所以也许您的问题可以在其他地方重新构建或修复。

无论哪种方式，您都可能希望在您的问题中添加更多信息，以便我们可以重现您的问题并在本地进行测试。

PS 太多的文本/代码无法发表评论，但这就是它应该属于的地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-22T18:35:46.560

一种可能的替代方法是像这样使用禁用输出转义：

```
<xsl:text disable-output-escaping="yes">&lt;a&gt;&lt;/a&gt;</xsl:text> 
```

但我知道这是一个肮脏的解决方案......

# mysql - 确保 MySQL 字段时间戳不早于当前时间的 1 小时

> ID：13956967
> 
> 赞同：1
> 
> 时间：2012-12-19T16:38:56.660
> 
> 标签：mysql, timestamp

好的，所以我在这里查看了很多类似的问题，但似乎没有一个有效。如果我目光短浅或缺乏正确搜索的能力，我会提前道歉。

所以我需要做的是检查`TIMESTAMP`我的 MySQL 数据库中的 a ，即 15:55:13 是否不早于脚本运行时当前时间的 1 小时。

如果我错过了任何需要的代码，请告诉我。

到目前为止我所拥有的：

```
$result = mysqli_query($link, "SELECT * 
                               FROM web_users
                               WHERE pass_reset_token='".$token."'
                               AND last_pass_reset < last_pass_reset
                               INTERVAL 1 HOUR")
                               or die(mysqli_error($link)); 
```

我之前尝试过的：

```
$result = mysqli_query($link, "SELECT *
                               FROM web_users
                               WHERE pass_reset_token='".$token."'
                               AND last_pass_reset < NOW()-INTERVAL 1 HOUR")
                               or die(mysqli_error($link)); 
```

还：

```
$result = mysqli_query($link, "SELECT *
                               FROM web_users
                               WHERE pass_reset_token='".$token."'
                               AND last_pass_reset < DATE_SUB(CURTIME(),
                               INTERVAL 1 HOUR)")
                               or die(mysqli_error($link)); 
```

所以我的理解是，我需要匹配以确保任何操纵的 SQL 时间不小于**last_pass_reset**也不大于 1 小时。

谢谢。

编辑：：

这是更新的 sql 查询，以确保我输入正确。

```
 // Perform a database search using the paramteres of the global variable
        $result = mysqli_query($link, "SET @scriptStartTime = CONCAT(CUR_DATE(), ' ', CUR_TIME())
                                       SELECT *
                                       FROM web_users
                                       WHERE pass_reset_token='".$token."'
                                       AND last_pass_reset > DATE_SUB(@scriptStartTime, INTERVAL 1 HOUR)")

                                       or die(mysqli_error($link)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:47:20.860

`NOW()`返回 a `timestamp`，`CUR_TIME()`只是`time`.

> 如果 TIMESTAMP 不早于当前时间的 1 个确切小时

翻译成我：

> 现在是 12:34:56，所以我想要所有 last_pass_reset 在 11:34:56 和 12:34:56 之间的记录

正确的？那么这应该工作：

```
SET @scriptStartTime = NOW();

SELECT *
FROM web_users
WHERE pass_reset_token='".$token."'
AND last_pass_reset > DATE_SUB(@scriptStartTime, INTERVAL 1 HOUR) 
```

另一种俗气的方式：

```
SELECT *
FROM web_users, (SELECT @scriptStartTime:=NOW()) v
WHERE pass_reset_token='".$token."'
AND last_pass_reset > DATE_SUB(@scriptStartTime, INTERVAL 1 HOUR) 
```

最终解决方案：

```
SELECT *
FROM web_users
WHERE pass_reset_token='".$token."'
AND last_pass_reset > TIME(DATE_SUB(NOW(), INTERVAL 1 HOUR)) 
```

# java - 如何从 wsdl 创建独立应用程序？

> ID：13956969
> 
> 赞同：0
> 
> 时间：2012-12-19T16:39:02.187
> 
> 标签：java, service, wsdl

我有 wsdl 文件，我通过 eclipse 2 个接口和 2 个类的 Web 服务生成该文件 - 定位器和存根。它都作为 Web 应用程序运行。但我需要创建独立的应用程序。怎么做？

# lua - 从函数返回表的内部

> ID：13956970
> 
> 赞同：3
> 
> 时间：2012-12-19T16:39:06.557
> 
> 标签：lua

> **可能重复：**
> [在 Lua 中，我如何将表用作可变参数（...）？](https://stackoverflow.com/questions/3473770/in-lua-how-can-i-use-a-table-as-varargs)

我想做类似于以下的事情，我想知道 lua 是否有可能？

```
fun = function()
    some_table = {1,2,3}
    -- some dark magic here
    return 1,2,3
end

a, b, c = fun() 
```

如何转换`{1,2,3}`为`1,2,3`仅从函数返回？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T16:46:03.053

使用[unpack()](http://www.lua.org/pil/5.1.html)`table.unpack` （在 Lua 5.2 中更名为）：

```
fun = function()
  some_table = {1,2,3}
  return (table.unpack or unpack)(some_table)
end
print(fun()) 
```

将打印`1 2 3`。

# php - jquery在document.ready中抓取不同的id

> ID：13956972
> 
> 赞同：0
> 
> 时间：2012-12-19T16:39:08.187
> 
> 标签：php, jquery

我正在编写一个小脚本，它将查询数据库中的标题，当您输入标题时，它会返回建议。

我找到了一个示例并设法创建了一个示例，如下所示：

```
<head>
<title>Match Form/title>
<script type="text/javascript" src="jquery.js"></script>
<script type='text/javascript' src='jquery.autocomplete.js'></script>
<link rel="stylesheet" type="text/css" href="jquery.autocomplete.css" />
<script type="text/javascript">
$(document).ready(function() 
    {

        $("#course").autocomplete("get_title_list.php", {

            width: 260,
            matchContains: true,
            mustMatch: true,
            selectFirst: false
        });
        $("#course").result(function(event, data, formatted) {
            $("#course_val").val(data[1]);
        });
    });

</script>
</head> 
```

然后工作并允许在页面上打印出我的结果，我的下一个任务是沿着多个标题有多个文本框，并允许某人搜索数据库，然后将结果返回到分配的框。

我知道 id 需要为每个框分配一个 ID，然后在我正在努力的 jquery 中选择该 id。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T16:46:52.613

将文本框更改为类，而不是 ID。像这样的东西应该适用于具有“课程”类的盒子：

```
 $(".course").autocomplete("get_title_list.php", {
        width: 260,
        matchContains: true,
        mustMatch: true,
        selectFirst: false
    });
    $(".course").result(function(event, data, formatted) {
        $(this).next(".course_val").val(data[1]);
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T16:47:07.373

我建议使用类而不是 ID。ID 必须是唯一的，但您可以拥有多个具有相同类的元素，因此您可以轻松地一次选择它们。

例子：

```
<input id="A" class="auto" />
<input id="B" class="auto" />

<script>
    $('.auto').autocomplete({}); // the  '.' is used to select by class
</script> 
```

# ios - 类似下拉菜单的 Gmail iOS 应用

> ID：13956973
> 
> 赞同：1
> 
> 时间：2012-12-19T16:39:14.577
> 
> 标签：ios, user-interface, uiview, menu, gmail

我想知道是否有任何iOS框架可以制作像Gmail App这样的下拉菜单 ![什么时候点击箭头](../Images/3a9c48b8ccd5e76d618a79fd896ba78c.png) ![我们得到这个带有一点动画的菜单](../Images/86920d70c597af39d4940e8e4ade4a8e.png)

谢谢 ！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T16:55:37.433

我不知道任何框架，但这将是一个相当少量的代码来开始工作。您所需要的只是一个具有 alpha < 1 的背景颜色的视图，并在其上放置一些按钮。然后使用 UIView 动画将其滑入和滑出。嘿，快。

您可以在界面生成器中创建视图以节省一些时间，并将其放在视图顶部。要对其进行动画处理，只需使用以下内容：

```
- (IBAction)menuButtonPressed:(id)sender
{
    CGRect menuFrame = self.menuView.frame;
    if (menuFrame.origin.y >= 0) {
        // menu is visible
        menuFrame.origin.y = -menuFrame.size.height;
    } else {
        // menu is invisible, slide it on screen
        menuFrame.origin.y = 0;
    }

    [UIView animateWithDuration:0.4
                     animations:^{
        self.menuView.frame = menuFrame;
    }];
} 
```

# php - 在 SonataAdmin 字段中为自定义模板提供参数

> ID：13956977
> 
> 赞同：0
> 
> 时间：2012-12-19T16:39:39.940
> 
> 标签：php, symfony, symfony-2.1, symfony-sonata, sonata-admin

我知道如何为 SonataAdminBundle 中的字段设置自定义模板。以下主题回答了一个关于此的问题：

[Symfony SonataAdmin 模板](https://stackoverflow.com/questions/10254316/symfony-sonataadmin-templates)

但是，如何传递要在该模板中使用的参数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T01:58:47.183

您需要[覆盖默认控制器](http://symfony.com/doc/master/cookbook/bundles/inheritance.html)和/或可能覆盖默认表单或[捆绑包的任何部分](http://symfony.com/doc/master/cookbook/bundles/override.html)

# css - 如何让图像滑块图像不拉伸但保持标题的定位？

> ID：13956983
> 
> 赞同：0
> 
> 时间：2012-12-19T16:40:11.147
> 
> 标签：css, wordpress

这是我正在开发的网站：

我可以通过删除高度来使图像不拉伸：481px；但后来我失去了图像下方的标题和方块，如果图像的高度不同，它会四处移动。我已经尝试过定位，但我还没有找到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T17:16:01.943

有几种方法可以解决这个问题。

正如@Sven 指出的那样，一个更清洁的解决方案是使用标签`<div>`而不是`<img>`使用图像作为`background`div。

或者，

您可以使用 CCS 剪辑属性将所有图像裁剪为相同大小，同时保持其原始比例：

```
img {clip:rect(0px,60px,200px,0px)} 
```

*（查看此链接以获取有关剪辑的文档：http:* [//www.w3schools.com/cssref/pr_pos_clip.asp](http://www.w3schools.com/cssref/pr_pos_clip.asp) *）*

但是，此时对您来说最快的解决方案（需要对实际代码进行较少更改的解决方案）可能是仅使用绝对定位，而不是将其应用于 div`.text-box`将其应用于他的父级`.slider-cont-wrapper`。：

```
.slider-cont-wrapper {position:absolute; top:100px; right:100px} 
```

*（更改`top:`和`right:`适合您的布局的措施）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T17:12:27.913

好吧，如果图像没有相同的比例，无论你做什么，你永远不会得到不同尺寸的图像完全适合同一个位置。所以你想要什么？

# ajax - Ajax 中的按钮不更新 - Rails 教程

> ID：13956986
> 
> 赞同：0
> 
> 时间：2012-12-19T16:40:15.983
> 
> 标签：ajax, ruby-on-rails-3, railstutorial.org

我知道，电流已经问过了，但我无法修复它......

**宝石文件**

```
 gem 'rails', '3.2.9'
 gem 'jquery-rails' , '2.0.2' 
```

**类关系控制器 < 应用控制器**

```
 def create
    @user = User.find(params[:relationship][:followed_id])
    current_user.follow!(@user)
    respond_to do |format|
      format.html { redirect_to @user }
      format.js
    end
  end 
```

**创建.js.erb**

```
 $("#follow_form").html("<%= escape_javascript(render('shared/unfollow')) %>") 
```

我有部分**\app\views\shared\_unfollow.html.erb**

```
 <%= form_for current_user.relationships.find_by_followed_id(@account), 
        :html => { :method => :delete }, :remote => true do |f|%>
     <div class="actions"><%= f.submit 'unfollow' %></div>
 <% end %> 
```

如果按下按钮，状态不会改变。尝试添加“.html_safe”也不起作用。

但如果我这样做

```
$("#follow_form").html("bla bla bla") 
```

或者

```
$("#follow_form").html("<%= 10+10 %>") 
```

这是工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T16:52:16.677

尝试改变

```
$("#follow_form").html("<%= escape_javascript(render('shared/unfollow')) %>") 
```

**到**

```
$("#follow_form").html('<%= escape_javascript(render("shared/unfollow")) %>'); 
```

错误可能是由于 javascript 的语法无效导致的，因此您的 javascript 将不会被执行。您不会在任何浏览器中看到错误。但是您可以使用 Firefox 来查看 Ajax 响应。

我之前遇到过[类似的问题](https://stackoverflow.com/questions/12220816/the-ajax-request-cannot-see-the-effect-without-refresh-the-browser-in-rails)