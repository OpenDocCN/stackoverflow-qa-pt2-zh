# StackOverflow 问答 13150000-13150999

# c# - 在循环外声明循环索引变量有什么好处？

> ID：13150001
> 
> 赞同：3
> 
> 时间：2012-10-31T01:25:04.150
> 
> 标签：c#, c++, performance, for-loop

我在很多游戏引擎代码中都看到了这一点。这应该比在 for 循环体中声明它更快吗？紧随其后的是许多其他 for 循环，每个循环都使用相同的变量。

```
int i;
for(i=0; i<count; ++i)
{
} 
```

对比

```
for(int i=0; i<count; ++i)
{
} 
```

顺便说一句，我自己从不这样做，只是对它背后的想法感到好奇，因为除了性能之外，我不知道为什么有人会这样做。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-31T01:26:26.427

第一种方式可能是 C 方式，OLD OLD C 方式，其中第二个版本无效。使用第二种方法，尽可能缩小变量的范围。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T01:31:07.977

最初，在 K&R C 中，如果您有`for`这样的声明

```
for (int i = 1; ... 
```

你以后不能用同样的方法（或`{}`范围）再次说

```
for (int i = 1; ... 
```

否则您会收到“重复符号”错误。

因此，如果想重用相同的循环变量，那么他们会在循环之外声明它。

C 的那个“特性”早已不复存在，但是，如果想`break`跳出循环并保留循环索引，则有必要在语句之外声明循环变量`for`：

```
int i;
for (i = 1; ...
  do stuff;
  if (something) break;
}

x = y[i]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T01:26:45.613

> 在循环外声明循环索引变量有什么好处？

在前一种情况下，您可以`i`在循环外访问最后一个值。天真的开发人员说，价值将是`count`. 但是采样这个

```
int i;
for(i = 0; i < count; ++i)
{
   if (i == 2)
       break;

   //Loop Logic
} 
```

在这种情况下`i`，将是`= 2`，或者`< 2`如果 count 是`> 2`。

但是，在后一种`i`中，一旦循环结束，就会超出范围

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-10-31T01:28:37.493

K&R C 不接受第二种样式。

第一种样式的一个优点是您可以在循环之后访问“i”，如果您正在搜索特定索引，这可能很重要。

第二个的优点是范围更窄，这总是一件好事。你不能把你的“我”弄混了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-31T01:31:57.363

至少有一个编译器（旧版本的 MSVC）在循环结束后泄露了`int i`in的定义。`for(int i = 0; i < max; ++i) { ... }`与此同时，该标准表示其范围仅限于`for`循环本身。如果您在多个编译器中进行编译，其中一个泄漏了定义，而另一个没有泄漏，如果您稍后在同一代码体中重新声明变量，您很容易遇到问题。

因此，我可以看到有人决定通过将变量声明放在循环之外来编写在符合标准和不符合标准的编译器中都会出现相同错误的代码。

现在，另一种理论是程序员希望在循环结束后访问迭代变量的值。另一种可能性是团队或编码人员认为将变量声明放在自己的行中是一种很好的风格。

# android - Android - 我如何在不付费的情况下下载自己的付费应用程序？

> ID：13150002
> 
> 赞同：1
> 
> 时间：2012-10-31T01:25:15.313
> 
> 标签：android

Android 是否允许我下载自己的应用程序而无需付费？:)

或者我可以给自己100%的折扣吗？人们通常如何处理这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T01:27:38.827

您不能通过 Google Play 购买自己的应用程序。这是[Google 的政策](http://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=141659)。

您将不得不侧载您的应用程序。如果您使用的是许可服务器，这并不完全令人满意，因为 Google Play 不会以与购买应用程序相同的方式响应您的安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T01:31:45.960

我不确定您的期望，但在 google play 中有一个供消费者使用的文档。它可能会帮助你

[http://support.google.com/googleplay/bin/answer.py?hl=en&answer=1751113](http://support.google.com/googleplay/bin/answer.py?hl=en&answer=1751113)

# ruby-on-rails - Foursquare 位置哈希存储作为 Rails 模型属性/列

> ID：13150004
> 
> 赞同：3
> 
> 时间：2012-10-31T01:25:43.467
> 
> 标签：ruby-on-rails, activerecord, serialization, hash, foursquare

我正在使用 Foursquare2 Ruby 包装器调用 Foursquare API [https://github.com/mattmueller/foursquare2](https://github.com/mattmueller/foursquare2)

如果我在 Rails 控制台中初始化客户端：

```
client = Foursquare2::Client.new(:client_id =>'CLIENT_ID', :client_secret => 'CLIENT_SECRET') 
```

然后我通过 location_id 调用 Foursquare API（例如使用 5104）。

```
restaurant = client.venue(5104) 
```

这将返回一个巨大的 Ruby Hashie::Mash。因此，如果我只想要位置哈希，那么我会这样做

```
restaurant.location 
```

这给了我这个“位置哈希”

```
#<Hashie::Mash address="4 Clinton St." cc="US" city="New York" country="United States" crossStreet="at E Houston St." lat=40.721294 lng=-73.983994 postalCode="10002" state="NY"> 
```

现在如果我这样做`restaurant.location.address` 返回`=> "4 Clinton St."`

所以现在，退出 Rails 控制台并进入 Rails 应用程序。我的问题 - 作为我的 Rails“餐厅”模型中的 after_save 方法调用，我将这个“位置哈希”在我的模型中的“foursquare_location”列中保存为：文本字段。

在我的“餐厅”视图模板中显示餐厅地址详细信息，我如何编写模板以便我可以调用 @restaurant.foursquare_location.address 以便它访问地址键以返回地址值？

我不确定我是否可以直接将 Foursquare API 响应直接保存到我的 SQLite3 数据库中的 :text 列中并让它保持其哈希结构。

我非常感谢这里的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T02:37:19.900

您可以使用 ActiveRecord`serialize`方法：

```
class Restaurant < ActiveRecord::Base
  serialize :foursquare_location
end 
```

然后，您可以将对象分配为 的值`foursquare_location`。

这应该适用`Hashie::Mash`（我自己从未尝试过，但它适用于常规哈希）。如果您一次访问大量记录，您可能会受到轻微的性能影响，并且查询此字段有点困难，但它应该适用于您所描述的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T02:42:08.507

虽然我还没有用 Hashie 完全测试过这种确切的方法，但您可能可以使用 ActiveRecord::Store 来做到这一点。这提供了一个包装器，将散列存储在数据库的一列中。

[http://api.rubyonrails.org/classes/ActiveRecord/Store.html](http://api.rubyonrails.org/classes/ActiveRecord/Store.html)

这是我正在处理的 Rails 应用程序的一个精简示例。该模型有一个名为 days_hours 的列，然后我可以引用它，就好像它们是实际属性一样。

```
class ProposedEvent < ActiveRecord::Base
  store :days_hours, accessors: [:mon, :tue, :wed, :thu, :fri, :sat, :sun]
end 
```

在 IRB 中：

```
my_event = ProposedEvent.new
my_event.days_hours = {:mon => '7, 8', :tue => '14, 15'} 
```

然后它会为您存储在数据库中，您可以使用方便的方法来访问它，就像您将这些存储为单独的列一样。

```
puts my_event.mon
=> "7, 8" 
```

希望这适用于您的场景。

# windows - 根据 Windows 批处理文件中的代码页 1252 将字符 > 7F (127) 写入十六进制字符串

> ID：13150009
> 
> 赞同：1
> 
> 时间：2012-10-31T01:26:17.783
> 
> 标签：windows, batch-file, hex

我有一个应用程序创建批处理文件的问题。问题是我的输出批处理文件始终是 UTF-8，它不适用于批处理文件。输出包含像é，à，Ä等变音符号，所以无论我做什么，这些都在我的批处理文件中失败。

因此我的问题是：有没有办法在我的批处理文件命令中以某种 7 位表示形式写入 7F（十进制 127）以上的任何字符。例如，作为字符 240 或类似字符的“\0xF0”之类的十六进制字符串。

当然要使用 win 1252 编码，我会使用以下命令启动批处理文件：

```
chcp 1252 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T04:51:30.470

感谢dbenham，他看到了显而易见的事情。[从批处理生成几乎任何字符，包括 TAB](http://www.dostips.com/forum/viewtopic.php?f=3&t=3857)

可以用`forfiles`.

```
@echo off
call :hex2Char 0x7f char_7F
call :hex2Char 0x80 char_80
echo %char_7F% %char_80%
exit /b

:hex2Char  hexString  rtnVar
  for /f delims^=^ eol^= %%A in (
    'forfiles /p "%~dp0." /m "%~nx0" /c "cmd /c echo(%~1"'
  ) do set "%~2=%%A"
exit /b 
```

但即使这样似乎也无法使用某些字符，例如 0xF4 或 0xF5。

# android - 在 ListView 单元格中处理动画的常用方法是什么？

> ID：13150010
> 
> 赞同：1
> 
> 时间：2012-10-31T01:26:24.087
> 
> 标签：android, android-listview, android-animation

我有一个`GridView`在网格单元的子视图上做动画的地方。我的问题是，`View`回收行为意味着在列表中长篇大论时，我`ObjectAnimators`有时最终会指向错误的`View`.

我已经实现了我的适配器`AbsListView.RecyclerListener`并且我得到了相关的事件，但是分离它`Animator`比我预期的要困难。我试过`animator.setTarget(null)`了，但这一切都崩溃了。我尝试用 no-op setter 将它指向一个虚拟对象，但这也不太顺利。我`Animators`想当你试图从他们下面改变目标时会不高兴。

我的运气要好一些`animator.end()`，只是完全忽略了回收事件，但是在这两种情况下，我仍然会得到一些我真的很想消除的闪烁。

理想情况下，我希望能够将长时间运行的`Animator`备份重新连接到`View`相关数据以某种合理的方式回摆到视口中时。

分离和重新连接`ObjectAnimators`到`ListView`或`GridView`细胞的最佳方法是什么？

# php - 使用服务器端语言 PHP 调用客户端应用程序

> ID：13150012
> 
> 赞同：0
> 
> 时间：2012-10-31T01:26:34.243
> 
> 标签：php, client-server, exe

我正在尝试为客户端创建一个可以由 php 调用并在执行时终止某些程序的应用程序。我尝试为此开发一个exe文件，但我无法在客户端通过php调用exe文件。我可以开发任何其他格式的应用程序可以由 php 调用吗？我可以开发一个 Windows 服务并通过 php 调用它吗？我可以要求用户下载和安装任何东西。但是我不能使用 javascript 来实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T01:30:11.583

我将稍微改写您的问题以确保我理解：

*我可以在服务器上使用 PHP 脚本来调用用户（客户端）计算机上的 EXE 吗？*

如果这是你的问题，那么答案是：

**不可以。**还有其他方法，但它们通常不会在非常严格的授权网站和客户子集或特殊案例之外起作用。

但是，您在问题*中说我可以要求用户下载和安装任何东西。*如果用户可以从您的网站下载一个文件（可执行文件），然后在他们的计算机上运行它，这似乎是什么问题？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T08:53:23.010

我设法解决了这个问题，但我不确定它是否适用于其他可能遇到这个问题的人。

我在 php 中设置了一个 cookie，并在客户端计算机中检查该 cookie 的值。

在我的情况下，我强制客户端使用 XULRunner 作为他们的浏览器客户端，因此 cookie 只有一个位置存在。如果浏览器不固定，所有浏览器的所有位置都需要单独处理。

以下是我在客户端计算机中用于应用程序的代码：-

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Diagnostics;

namespace beforeSEBstart
{
    class Program
    {
        static void Main(string[] args)
        {
            // Create a timer that polls once every 5 seconds
            string appdata = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData);
            Console.WriteLine(appdata);
            string curFile = appdata+@"\ETH Zuerich\xul_seb\Profiles\cookies.sqlite-wal";
            System.IO.File.WriteAllText(curFile, string.Empty);
            var timer = new System.Threading.Timer(TimerProc, null, 5000, 5000);
            Console.WriteLine("Polling every 5 seconds.");
            Console.WriteLine("Press Enter when done:");
            Console.ReadLine();
            timer.Dispose();
        }

        static int TickCount = 0;
        static void TimerProc(object state)
        {
            ++TickCount;
            Boolean found = false;
            Console.WriteLine("tick {0}", TickCount);
            string appdata = Environment.GetFolderPath(Environment.SpecialFolder.LocalApplicationData);
            Console.WriteLine(appdata);
            string curFile = appdata + @"\ETH Zuerich\xul_seb\Profiles\cookies.sqlite-wal";
            string line;
            Console.WriteLine(File.Exists(curFile) ? "File exists." : "File does not exist.");
            //Console.WriteLine(File.Exists(curFile) ? "File exists." : "File does not exist.");
            Stream stream = File.Open(curFile, FileMode.Open, FileAccess.Read, FileShare.ReadWrite);
            StreamReader file = new StreamReader(stream);
            while ((line = file.ReadLine()) != null)
            {
                if (line.Contains("SEBClose2"))
                {
                    found = true;
                }
            }
            if (found)
            {
                Console.WriteLine("String exists in the file.");
                System.Diagnostics.Process.Start("ConsoleApplication1.exe");
                foreach (System.Diagnostics.Process myProc in System.Diagnostics.Process.GetProcesses())
                {
                    if (myProc.ProcessName == "beforeSEBstart.vshost" || myProc.ProcessName == "beforeSEBstart")
                    {
                        myProc.Kill();
                    }
                };
            }
            else
            {
                Console.WriteLine("String does not exist in the file.");
            }
            file.Close();
        }
    }
} 
```

对于服务器端，当客户端按下退出按钮时，我只是在 php 中设置了一个名为 SEBclose2 的 cookie。

# ipc - 使用管道和文件进行进程间通信

> ID：13150014
> 
> 赞同：0
> 
> 时间：2012-10-31T01:26:48.460
> 
> 标签：ipc, inter-process-communicat, windows-process

我正在学习 Windows 系统编程。我遇到过“使用匿名管道的 IPC”和“使用文件的 IPC”。

但我对“使用匿名管道的 IPC”和“使用命名管道的 IPC”感到困惑。据我所知，“命名管道”通常作为文件出现在文件系统中。但是还有另一种机制称为“使用文件映射的 IPC”。

现在我的问题是哪一个是“IPC using files”？文件映射或命名管道？

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-06T17:36:23.963

“使用文件的 IPC”可能只是一个写入文件的进程和另一个读取文件的进程。例如在 /tmp 或 /var 中写入文件。/var 目录中有日志、锁和正在运行的 PID。您还可以使用 /proc 文件系统与内核通信或 /sys 与设备驱动程序通信。这些都是“使用文件的IPC”。

# ios - 无需重新压缩即可从用户图库中保存/获取 JPEG

> ID：13150017
> 
> 赞同：7
> 
> 时间：2012-10-31T01:27:30.440
> 
> 标签：ios, uiimage, ios6, uiimagepickercontroller, jpeg

我正在尝试找到一种方法来读取和写入 JPEG 图像到用户图库（相机胶卷），而无需 iOS 重新压缩它们。UIImage 似乎是这里的瓶颈。我发现保存到用户图库的唯一方法是 UIImageWriteToSavedPhotosAlbum()。有没有解决的办法？

现在我的例程看起来像这样

- 向 UIImagePickerController 索要一张照片。当它完成FinishPickingMediaWithInfo 时，执行以下操作：

```
NSData *imgdata = [NSData dataWithData:UIImageJPEGRepresentation([info objectForKey:@"UIImagePickerControllerOriginalImage"], 1)];
[imgdata writeToFile:filePath atomically:NO]; 
```

– 在磁盘上无损处理 JPEG。

–然后将其保存回来：

```
UIImageWriteToSavedPhotosAlbum([UIImage imageWithContentsOfFile:[self getImagePath]], self, @selector(image:didFinishSavingWithError:contextInfo:), nil); 
```

这是 3 次通过后质量下降的小动画：

![JPEG 质量下降](../Images/0f4baa131bcde83d88282a685fb7776a.png)

显然每次我这样做都会变得更糟，但我无法自动化图像拾取部分以对其进行 50/100/1000 个周期的全面测试。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-31T07:57:42.663

`UIImage`对图像数据进行解码，以便对其进行编辑和显示，因此

```
UIImageWriteToSavedPhotosAlbum([UIImage imageWithContentsOfFile:[NSData dataWithContentsOfFile:[self getImagePath]]], self, @selector(image:didFinishSavingWithError:contextInfo:), nil); 
```

`UIImageWriteToSavedPhotosAlbum`将首先解码图像，然后通过该方法将其编码回来。

相反，您应该使用[ALAssetsLibrary/writeImageDataToSavedPhotosAlbum:metadata:completionBlock:](http://developer.apple.com/library/ios/#documentation/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html#//apple_ref/occ/instm/ALAssetsLibrary/writeImageDataToSavedPhotosAlbum%3ametadata%3acompletionBlock%3a)，如下所示：

```
ALAssetsLibrary *assetLib = [[[ALAssetsLibrary alloc] init] autorelease];
[assetLib writeImageDataToSavedPhotosAlbum:[self getImagePath] metadata:nil completionBlock:nil]; 
```

您还可以将元数据和完成块传递给调用。

**编辑：**

获取图像：

`[info objectForKey:@"UIImagePickerControllerOriginalImage"]``UIImage`包含从中选择的解码`UIImagePickerController`。你应该改用

```
NSURL *assetURL = [info objectForKey:UIImagePickerControllerReferenceURL]; 
```

使用`assetURL`您现在可以`ALAsset`使用[ALAssetsLibrary/assetForURL:resultBlock:failureBlock:](http://developer.apple.com/library/ios/documentation/AssetsLibrary/Reference/ALAssetsLibrary_Class/Reference/Reference.html#//apple_ref/occ/instm/ALAssetsLibrary/assetForURL%3aresultBlock%3afailureBlock%3a)方法获取它：

```
ALAssetsLibrary *assetLib = [[[ALAssetsLibrary alloc] init] autorelease];
[assetLib assetForURL:assetURL resultBlock:resultBlock failureBlock:failureBlock]; 
```

您现在可以获取该图像的未更改的 NSData：

```
ALAssetsLibraryAssetForURLResultBlock resultblock = ^(ALAsset *asset){
  ALAssetRepresentation *assetRep = [asset defaultRepresentation];
  long long imageDataSize = [assetRepresentation size];
  uint8_t* imageDataBytes = malloc(imageDataSize);
  [assetRepresentation getBytes:imageDataBytes fromOffset:0 length:imageDataSize error:nil];
  NSData *imageData = [NSData dataWithBytesNoCopy:imageDataBytes length:imageDataSize freeWhenDone:YES]; // you could for instance read data in smaller buffers and append them to your file instead of reading it all at once
  // save it
  [imgdata writeToFile:filePath atomically:NO];
};
ALAssetsLibraryAccessFailureBlock failureblock  = ^(NSError *myerror){
  NSLog(@"Cannot get image - %@",[myerror localizedDescription]);
  //
}; 
```

我可能在代码中犯了一些错误，但步骤如上所列。如果某些事情不能正常工作，或者如果你想让它更有效率，有很多例子可以做一些事情，比如`NSData`从`ALAsset`stackoverflow 或其他网站上阅读。

# c# - 在动态 linq 中添加条件

> ID：13150019
> 
> 赞同：0
> 
> 时间：2012-10-31T01:28:05.473
> 
> 标签：c#, linq, lambda

我想编写一个动态 linq 查询，它根据两个时间框架 startTime 和 errorTime 检查“where”条件。现在的代码在这里，

```
IQueryable<LogFormat> errorLines = null;
if (!string.IsNullOrEmpty(errorStartTime) && !string.IsNullOrEmpty(errorTime))
{
    var sTime = DateTime.Parse(errorStartTime);
    var eTime = DateTime.Parse(errorTime);
    errorLines = from errorLine in File
                 where
                     (errorLine.DateTime >= sTime && errorLine.DateTime <= eTime) &&
                     (
                     errorLine.Level == "ERR"
                     || errorLine.Level == "WARN"
                     )
                 select errorLine;
}
else if (!string.IsNullOrEmpty(errorStartTime))
{
    var sTime = DateTime.Parse(errorStartTime);
    errorLines = from errorLine in File
                 where
                     errorLine.DateTime >= sTime
                     &&
                     (
                     errorLine.Level == "ERR"
                     || errorLine.Level == "WARN"

                     )
                 select errorLine;

}
else if (!string.IsNullOrEmpty(errorTime))
{
    var eTime = DateTime.Parse(errorTime);

    errorLines = from errorLine in File
                 where
                     errorLine.DateTime <= eTime
                     &&
                     (
                     errorLine.Level == "ERR"
                     || errorLine.Level == "WARN"
                   )
                 select errorLine;

}
else
{   
    errorLines = from errorLine in File
                 where
                     errorLine.Level == "ERR"
                     || errorLine.Level == "WARN"

                 select errorLine;

} 
```

我可以知道如何只进行一个查询，以便我可以动态发送开始时间和错误时间以获取结果吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:40:31.643

`where`您可以根据条件多次调用该子句来使其动态化：

```
var errorLines = File.Where(e => e.Level == "ERR" 
                              || e.Level == "WARN");                   

if (!string.IsNullOrEmpty(errorStartTime))
{
     var sTime = DateTime.Parse(errorStartTime);
     errorLines = errorLines.Where(e => e.DateTime >= sTime);
}

if (!string.IsNullOrEmpty(errorTime))
{
    var eTime = DateTime.Parse(errorTime);
    errorLines = errorLines.Where(e => e.DateTime <= eTime);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T10:41:06.783

您可以在使用 PredicateBuilder 时动态构建谓词并与 And() Or() 组合。看看：[http ://www.albahari.com/nutshell/predicatebuilder.aspx](http://www.albahari.com/nutshell/predicatebuilder.aspx)

# python - 是否可以创建一个 10 行 0 列的 numpy 矩阵？

> ID：13150020
> 
> 赞同：1
> 
> 时间：2012-10-31T01:28:06.480
> 
> 标签：python, numpy

我的目标是从一个“空”矩阵开始并反复向其中添加列，直到我有一个大矩阵。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T01:31:06.793

是的：

```
>>> a = np.zeros((10, 0))
>>> a.shape
(10, 0) 
```

然后，您可以[`ndarray.resize`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.resize.html#numpy.ndarray.resize)在不复制的情况下使用它来扩展它。但是这有一些问题，对于许多应用程序，使用向量列表然后合并到单个数组中会更容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T01:32:00.593

向ndarray（或矩阵）添加列需要内容的完整副本，因此您应该使用其他方法，例如列表或数组模块，或者先创建一个大矩阵，然后在其中填充数据。

# c# - 实体框架枚举和数据注释

> ID：13150025
> 
> 赞同：0
> 
> 时间：2012-10-31T01:28:36.287
> 
> 标签：c#, entity-framework, enums

我想`enum`在 Entity Framework 5.0 中使用带有 Code First 和 Data Annotation 的功能，但找不到与此技术相关的任何示例。我创建了一个表，其中有一个名为 Option type int 的列来从我的枚举中捕获数据：

公共枚举选项：int { Option1 ， Option2 ， Option3 }

你有任何使用枚举数据注释的例子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:31:09.927

我自己也有类似的问题。

在此处检查我的工作示例（第二段代码）：[Code First Enum not allowed within 'Enums' class? （英法 5）](https://stackoverflow.com/questions/13574053/code-first-enum-not-allowed-within-enums-class-ef-5)

祝你好运！

# c++ - C++ 程序中的未知错误

> ID：13150028
> 
> 赞同：0
> 
> 时间：2012-10-31T01:28:43.023
> 
> 标签：c++, pointers, gcc, stl, iterator

```
void change_degree(vector<int> &nodes, map<int, vector<int> > &edges, int vertex){
    map<int, vector<int> >::iterator ite;
    ite = edges.find(vertex);
    vector<int> temp = (*ite).second;
    vector<int>::iterator it;
    for(it = temp.begin(); it != temp.end(); it++){
        cout << *it;
        if(nodes[*it + 1] > 1)
            nodes[*it + 1]++;
    }
} 
```

此功能产生错误

```
*** glibc detected *** ./a.out: munmap_chunk(): invalid pointer: 0x09c930e0 *** 
```

有人能告诉我它为什么会出现以及它意味着什么吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T01:34:26.050

好吧，我看到的一个问题是您没有检查是否`vertex`确实在`edges`. 您可能正在取消引用您不拥有的内存。

```
void change_degree(vector<int> &nodes, map<int, vector<int> > &edges, int vertex){
    map<int, vector<int> >::iterator ite = edges.find(vertex);
    if (ite != edges.end()) {  // <-- this is what you're missing
        vector<int> temp = (*ite).second;  // <-- this is probably where you're dying
        vector<int>::iterator it;
        for(it = temp.begin(); it != temp.end(); it++){
            cout << *it;
            if(nodes[*it + 1] > 1)  // <-- you could also be crashing here
                nodes[*it + 1]++;
        }
    }
} 
```

下次，尝试通过 GDB 运行您的应用程序，并检查您的堆栈跟踪。

编辑：另一种可能性是您的索引`nodes`不正确。检查`nodes[*it + 1]`是否有效。

# windows - Git 配置别名不再起作用

> ID：13150031
> 
> 赞同：6
> 
> 时间：2012-10-31T01:28:49.427
> 
> 标签：windows, git, windows-7, msysgit

我使用了命令：

```
git config --global alias.st status 
```

按照帖子的建议添加我的第一个别名 -[如何在 git 中为命令添加别名？](https://stackoverflow.com/questions/2553786/how-do-i-alias-commands-in-git)

然后，我发现它被添加到配置文件中：

> C:\Users\damodar.bashyal\.gitconfig

所以，我直接在配置文件中添加了一堆别名，直到今天我在安装 MYOB 软件后不得不重新启动计算机时，一切都运行良好。

当我尝试使用别名时没有工作。所以，我使用上面的命令添加了另一个别名，但文件没有得到更新，但新别名工作正常。

因此，在挣扎了一段时间后，在 [ [git config --global 写入到哪里？](https://stackoverflow.com/questions/2114111/where-does-git-config-global-get-written-to)] 查找配置文件：

```
git config --global --edit 
```

令我惊讶的是，它显示了不同的位置，其中添加了新的 git 别名。

```
.gitconfig(~) - VIM

[gui]
   recentrepo = C:/_projects/example.com/trunk/bitbucket
[user]
   name = damu
[alias]
   st = status 
```

有没有办法将路径改回以前的 .gitconfig 文件？

我正在使用 Windows 7 和 msysgit。

```
c:\>echo %HOME%
%HOME%

c:\>set HOME
HOMEDRIVE=U:
HOMEPATH=\
HOMESHARE=\\agsbs\UserShares\Damodar.Bashyal

c:\>echo %HOME%
%HOME% 
```

**更新：** 按照这篇文章 [[在 Egit (Eclipse) 中更改用户位置（主变量）](https://stackoverflow.com/questions/6989847/change-user-locationhome-variable-in-egit-eclipse) ] 设置缺少的 HOME 环境变量，现在我得到了这个：

```
c:\>set HOME
HOME=C:\Users\damodar.bashyal
HOMEDRIVE=U:
HOMEPATH=\
HOMESHARE=\\agsbs\UserShares\Damodar.Bashyal 
```

这也解决了我的问题。耶！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T07:15:13.200

检查您的`HOME`参考资料：

```
echo %HOME%
# or
set HOME 
```

`git config --global`将引用`HOME`路径（除非您[使用 --file 选项](https://stackoverflow.com/a/1475346/6309)）。
HOME 在 Windows 上默认没有定义，但它是由[`git-cmd.bat`](https://github.com/msysgit/msysgit/blob/devel/git-cmd.bat#L9-L10)msysgit 包含的脚本设置的。

```
@if not exist "%HOME%" @set HOME=%HOMEDRIVE%%HOMEPATH%
@if not exist "%HOME%" @set HOME=%USERPROFILE% 
```

# sqlite - SQLite 导入 CSV 文件 - 预期 3 列，发现 1948

> ID：13150034
> 
> 赞同：2
> 
> 时间：2012-10-31T01:29:22.390
> 
> 标签：sqlite, csv

我正在尝试将 CSV 文件（位于[https://github.com/veekun/pokedex/blob/master/pokedex/data/csv/pokemon_species_names.csv](https://github.com/veekun/pokedex/blob/master/pokedex/data/csv/pokemon_species_names.csv)的 Pokemon CSV 文件）导入 SQLite3。我使用以下行创建了一个表：

`sqlite> create table pokemon_species_names (pid integer, lang integer, pokemonName text, genus text);`

当然，这很好用，但是当我尝试导入上述 CSV 文件时，我收到以下错误：

`sqlite> .separator ","`（编辑：最初忘记添加这个，但我也运行过这个）

`sqlite> .import ./pokemon_species_names.csv pokemon_species_names`

`Error: ./pokemon_species_names.csv line 1: expected 4 columns of data but found 1948`

为什么只有 4 列数据时会找到 1948 列数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T01:41:46.773

SQLite 可能没有寻找正确的分隔符。尝试运行：

```
.separator "," 
```

导入前。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-12-05T22:07:17.330

对于任何看到这个的人（5 年后），在 Mac 上的 TextWrangler 中，您选择“另存为”Unicode(UTF-8) 和 Unix(LF)。然后 .import 将像魅力一样工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T01:46:08.507

回答我自己的问题。原来我使用的文件有问题，因为我修改了它（在 Excel 中）。我使用了原始的、未修改的文件，它有效。感谢 glibdud 和 Larry Lustig 为我指明了正确的方向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-21T16:43:51.833

您的 csv 文件应使用 Unicode(UTF-8) Unix(LF) 编码 您可以从 TextWrangler 执行此操作

如果您从 windows/mac 保存它，则它是 Windows(CRLF) 或 Classic Mac(LF)

# android - Admob 状态恢复为非活动状态

> ID：13150035
> 
> 赞同：3
> 
> 时间：2012-10-31T01:29:36.973
> 
> 标签：android, admob

我有使用 Admob 的新应用程序。在 Admob 站点和应用程序页面中，它在几天前显示为活动状态。但是突然之间，状态又恢复为非活动状态，悬停文本显示

> 无效：AdMob 从未收到您网站的广告请求。

在我的测试设备上，我得到了测试广告，但是如果我关闭 addTestDevice() 行，我根本就没有广告，我在 logcat 中得到了这个：

> onFailedToReceiveAd（广告请求成功，但由于广告资源不足，没有返回广告。）

我得到了更多的活跃用户，所以肯定会有一些成功。我完全迷路了！

有谁知道这是否正常，因为我的填充率为 0，而状态只是误导？还是有什么问题，我需要改变一些东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T11:29:27.960

关键在这里

```
(Ad request successful, but no ad returned due to lack of ad inventory) 
```

一切正常，但没有针对您的国家/地区/设置等的特定广告。检查 Admob 控制面板上的广告设置，确保您没有屏蔽任何阻止您接收广告的类别。

（如果它说它从未收到您的应用/网站的请求，请检查您代码中的 Admob ID 号，因为它可能不正确，除非您肯定获得零点击/请求）

# objective-c - 我们应该在哪里设置MKAnnotationView的centerOffset？

> ID：13150037
> 
> 赞同：0
> 
> 时间：2012-10-31T01:29:53.680
> 
> 标签：objective-c, xcode4.5

我们应该这样做吗`- (MKAnnotationView *) mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>) annotation{`

是否有一些关于正确使用的示例代码

```
- (MKAnnotationView *) mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>) annotation{ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T01:56:28.193

是的，你可以在*viewForAnnotation*中做到这一点：

```
- (MKAnnotationView *)mapView:(MKMapView *)mapView viewForAnnotation:(id <MKAnnotation>)annotation
{        
    MKAnnotationView *annotationView = (MKAnnotationView *) [_mapView dequeueReusableAnnotationViewWithIdentifier:@"myIdentifier"];
    if (annotationView == nil) 
    {
        annotationView = [[MKAnnotationView alloc] initWithAnnotation:annotation reuseIdentifier:identifier];
    } 
    else 
    {
        annotationView.annotation = annotation;
    }
    annotationView.image = [UIImage imageNamed:@"myPinImage.png"];
    // set your offset here
    annotationView.centerOffset = CGPointMake(offsetX, offsetY);
    return annotationView;
} 
```

# asp.net - 他们是一种从链接或按钮自动登录到 t-mobile 的方法吗？

> ID：13150039
> 
> 赞同：0
> 
> 时间：2012-10-31T01:29:57.287
> 
> 标签：asp.net

帮助一个网站上的朋友，他希望有一个按钮或一个链接自动登录到他的 t-mobile 帐户是他们这样做的一种方式吗？

这是我第一次使用 API，任何指针都会非常感谢。我在 t-mobile 注册，但它没有在 api 上显示任何文档，我只能找到波兰语的网站。

1）我如何获得api

2）我如何调用它并使用这些方法？

任何帮助都会非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T01:48:05.433

您需要访问 T-mobile API 才能访问他们的数据对象。您还需要先注册他们的合作伙伴网络，然后才能访问它。这是注册页面的链接：

[http://developer.t-mobile.com/site/global/home/p_home.jsp](http://developer.t-mobile.com/site/global/home/p_home.jsp)

# c++ - 无法与 boost xpressive 动态正则表达式匹配

> ID：13150041
> 
> 赞同：2
> 
> 时间：2012-10-31T01:30:11.900
> 
> 标签：c++, regex, boost, mingw, boost-xpressive

**Edit8：**我首先为可能遇到同样问题的任何人发布了解决方案。

***解决方案*：**

用 = 分配正则表达式，而不是调用 () 运算符。工作得很好。那是愚蠢的。

```
#include <iostream>
#include <string>
#include <boost/xpressive/xpressive_dynamic.hpp>

int main()
{
    std::string str = "foobarfoo";
    boost::xpressive::sregex rex;
    std::string rstr = "foo";
    rex = boost::xpressive::sregex::compile(rstr, boost::xpressive::regex_constants::ECMAScript);
    if (boost::xpressive::regex_search(str, rex, boost::xpressive::regex_constants::match_continuous))
        std::cout << "Match found.";
    else
        std::cout << "No match found.";
    return 0;
} 
```

***原始问题*：**

我已经与 xpressive 斗争了一段时间，但我还没有做任何事情。使用以下代码：

```
#include <iostream>
#include <string>
#include <boost/xpressive/xpressive_dynamic.hpp>

int main()
{
    std::string str = "foobar";
    boost::xpressive::sregex rex;
    std::string rstr = "foo";
    rex(boost::xpressive::sregex::compile(rstr));
    if (boost::xpressive::regex_match(str, rex))
        std::cout << "Match found.";
    else
        std::cout << "No match found.";
    return 0;
} 
```

我没有找到我期望的匹配。帮助将不胜感激。

**编辑：**尝试将正则表达式编译行更改为

```
rex(boost::xpressive::sregex::compile(rstr, boost::xpressive::regex_constants::ECMAScript)); 
```

依然没有。

**Edit2：**使用 MinGW GCC 4.7 编译

**Edit3：**我还尝试将声明正则表达式字符串的行更改为

```
std::string rstr = ".*"; 
```

和

```
std::string rstr = "(.*)"; 
```

依然没有。

**Edit4：**我没有得到以下结果，仍然没有结果：

```
#include <iostream>
#include <string>
#include <boost/xpressive/xpressive_dynamic.hpp>

    int main()
    {
        std::string str = "foobarfoo";
        boost::xpressive::sregex rex;
        std::string rstr = "(foo)";
        rex(boost::xpressive::sregex::compile(rstr));//;, boost::xpressive::regex_constants::ECMAScript));
        if (boost::xpressive::regex_search(str, rex, boost::xpressive::regex_constants::match_default))
            std::cout << "Match found.";
        else
            std::cout << "No match found.";
        return 0;
    } 
```

**Edit5：**我期待此时有两个匹配项，即 str 开头和结尾处的“foo”。

**Edit6：**尝试使用设置了 match_continuous 标志运行 regex_search 希望我至少可以让它获取前缀。没有骰子。还尝试使用 ECMAScript 标志进行编译，并使用 match_default 和 match_continuous 标志运行 regex_search。

**Edit7：**我知道 strstr() 会在这里工作。这是因为这是一个简单的示例案例。Boost 在实际应用中是必不可少的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T05:38:25.763

```
#include <iostream>
#include <string>
#include <boost/xpressive/xpressive_dynamic.hpp>

int main()
{
    std::string str = "foobar";
    std::string rstr = "foo";
    boost::xpressive::sregex rex = boost::xpressive::sregex::compile(rstr);
    if (boost::xpressive::regex_search(str, rex))
        std::cout << "Match found." << std::endl;
    else
        std::cout << "No match found." << std::endl;
} 
```

为我打印`"Match found."`。如果你想找到所有的匹配...

```
#include <iostream>
#include <string>
#include <boost/xpressive/xpressive_dynamic.hpp>

int main()
{
    std::string str = "foobarfoo";
    std::string rstr = "foo";
    boost::xpressive::sregex rex = boost::xpressive::sregex::compile(rstr);
    boost::xpressive::sregex_iterator it(str.begin(), str.end(), rex), end;

    for (; it != end; ++it )
        std::cout << "Match found at offset "
                  << ((*it)[0].first - str.begin())
                  << std::endl;
} 
```

对我来说，这打印：

```
在偏移量 0 处找到匹配项
在偏移量 6 处找到匹配项

```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T01:40:37.593

尝试`regex_search`而不是`regex_match`？

状态的提升文档`regex_match`：

> 请注意，仅当表达式与整个输入序列匹配时，结果才为真。如果要在序列中的某处搜索表达式，请使用`regex_search`. 如果要匹配字符串的前缀，请`regex_search`与标志`match_continuous`集一起使用。

[http://www.boost.org/doc/libs/1_51_0/libs/regex/doc/html/boost_regex/ref/regex_match.html](http://www.boost.org/doc/libs/1_51_0/libs/regex/doc/html/boost_regex/ref/regex_match.html)

# database - 数据库设计菜单规划器应用

> ID：13150042
> 
> 赞同：0
> 
> 时间：2012-10-31T01:30:26.100
> 
> 标签：database, database-design

我的第一个数据库，所以我需要一些帮助：D

![MenuPlanner数据库](../Images/09ac0bf38e24e339bb0d7e7915eaeeb1.png)

在我提出问题之前，让我尝试解释一下应用程序和数据库流程。

该应用程序将是一个菜单计划器，您将从每周日历（计划器）开始，您可以手动将菜肴添加到日期，或者您可以按下推荐按钮并推荐以前制作的菜肴、健康菜肴和您最喜欢的类别/cuisine 将提供，您可以从中选择。有两个盘子部分，一个（盘子）有预插入盘子（食谱）和一个（mydish），您可以在其中添加自己的盘子和从预插入盘子中添加书签的盘子。

人们必须登录他们的帐户并创建会员资料。他们从菜品部分选择他们可以制作的菜品，这些菜品将保存在 my_dish 部分。

一些问题 1.当前数据库是否正常或我缺少东西？2.日期。我希望用户能够检查他们制作的菜肴（他们添加到每周日历计划器中的菜肴）的历史记录（以及推荐功能）。我应该在哪里添加这些信息。我应该为此多做一张桌子吗？不太确定如何执行此操作。

我可能会提出更多问题，但我期待看到您的想法和想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T17:25:51.540

该模式似乎相当完整，尽管您似乎缺少一个表，该表显示用户在哪个日期收到了哪道菜（这将具有字段 id、user_id、dish_id、curdate）。

目前尚不清楚 - 至少对我而言 - “时间表”的目的是什么。'my_dish' 表中的字段 'time'（可能是保留字，因此应该更改）是该表的外键吗？'dish'（应该是'dishs'？）表中的'time'字段是什么？准备一个给定的菜需要多长时间？

将 'ingredients' 表中的 varchar 字段的名称更改为 'name' 或类似名称 - 否则会造成混淆。

# python - 使用 win32print 在 Python 中安装密码保护的网络打印机

> ID：13150044
> 
> 赞同：2
> 
> 时间：2012-10-31T01:30:45.200
> 
> 标签：python, authentication, printing, python-2.7

我正在尝试通过 Python 2.7 和 win32print 模块在我的本地计算机上连接/安装网络打印机。尝试正常连接打印机时（在 Windows 开始菜单中输入服务器的 IP 地址），系统提示我输入用户名和密码。

在 Python shell 中，当我输入：

`win32print.AddPrinterConnection(r'\\myserver\\myprinter')`

我得到：

`error: (1326, 'AddPrinterConnection', 'Logon failure: unknown user name or bad password.')`

如何提交登录名和密码表格？成功连接到打印机后，如何在计算机上实际安装它？

编辑：虽然我通常更关心安装打印机，但我也对如何在 Python 中进行此操作感兴趣。

# objective-c - 如何使用导航栏外的按钮创建推送转场？

> ID：13150052
> 
> 赞同：1
> 
> 时间：2012-10-31T01:31:22.763
> 
> 标签：objective-c, ios, uinavigationcontroller

我想创建一个可以在我的导航控制器中触发推送 segue 的按钮，但我不想要导航栏，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T01:39:42.040

这些链接可能会有所帮助

[通过情节提要和 xcode 正确创建手动 segue](https://stackoverflow.com/questions/12518271/creating-manual-segue-correctly-through-storyboard-and-xcode)

[如何通过故事板 iOS 中的按钮从一个视图务实地切换到另一个视图](http://agilewarrior.wordpress.com/2012/05/04/how-to-pragmatically-segue-from-one-view-to-another-with-button-press-from-storyboard-ios/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T02:17:26.600

我假设您知道如何创建推送导航，问题是如何删除导航栏（如果我错了，请告诉我，我会编辑我的答案）。

在第二个视图控制器中添加以下代码：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.navigationController.navigationBarHidden = YES;
} 
```

# vb.net - 在 VB.NET 中使用宽带或 GSM 读取短信

> ID：13150060
> 
> 赞同：0
> 
> 时间：2012-10-31T01:32:10.113
> 
> 标签：vb.net, sms, serial-port

这里的任何人都知道如何使用 VB.NET 在 SIM 中读取 SMS？我正在使用宽带调制解调器。我已经可以发送短信，但我不知道如何从 SIM 中读取短信并以`datagridview`.

这是我发送短信的代码：

```
SerialPort1.Write("AT" & vbCrLf)
SerialPort1.Write("AT+CMGF=1" & vbCrLf)
SerialPort1.Write("AT+CMGS=" & Chr(34) & num & Chr(34) & vbCrLf)
SerialPort1.Write(message & Chr(26)) 
```

看短信怎么样？

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T06:33:42.390

也许更好的方法是使用库来发送/接收短信： [http ://www.scampers.org/steve/sms/libraries.htm#gsmcomm_download](http://www.scampers.org/steve/sms/libraries.htm#gsmcomm_download)

我们使用了这个，效果很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T01:48:11.650

根据[this blog entry](http://www.developershome.com/sms/cmgrCommand2.asp)，命令序列是

`AT+CMGF=1` 选择 SMS 文本调制解调器

`AT+CPMS="SM"`选择消息存储（在本例中为 SIM）

`AT+CMGR=1`实际阅读消息@ index 1

但一定要访问博客，它比我在这里给出的简短说明要详细得多。此外，最好先在超级终端中测试这些序列并详细查看返回的数据。

AT 命令的完整列表可以在许多地方找到，[诺基亚 AT 命令集的描述](http://amber.feld.cvut.cz/user/pokorny/bpdp/Nokia_AT.PDF)但应该与您的调制解调器非常相似，这只是一个可能的来源。当然，您的特定调制解调器类型随附的手册始终是最好的，但此类详细信息通常不包含在包装盒中。

另一件事：您应该始终检查每个 AT 命令的返回值（在大多数情况下`OK`或您请求的信息），因为如果您只是触发整个命令序列，调制解调器可能发送的任何错误都会被忽视。此外，我遇到了几个在处理上一个命令时不喜欢被发送到的调制解调器。

# c# - 在 C#/Win8 中等待 StreamSocket 上的消息

> ID：13150061
> 
> 赞同：0
> 
> 时间：2012-10-31T01:32:17.567
> 
> 标签：c#, windows, sockets, windows-8, windows-runtime

我正在尝试作为一个辅助项目在 Windows 8 中构建 IRC 客户端，作为学习网络编程的一种方式。但是，我找不到构建侦听器的最佳方法。

我有一个创建 StreamSocket 并连接到服务器的类。现在我需要让我的班级监听来自服务器的传入消息，并在消息传入时回调委托。据我所知，StreamSocket 只给了我一种方法来拉取当前在 Socket 上等待的任何内容，但对传入消息没有某种回调。做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:13:15.477

我想您会将其实现为 Windows 服务，因此您的代码将如下所示。其中大部分是让您轻松调试服务的基础设施。我知道它污染了这个例子，但没有它是太多的工作。

服务实现在库中而不是直接在服务主机中，因为我经常编写通过 WCF 发布接口的服务，并且总是将主机与服务分开更容易。

## 服务主机

```
using IrcServiceLibrary;
using System.Collections.Generic;
using System.ServiceProcess;
using System.Threading;
using System.Xml;

namespace IrcServiceHost
{
  internal static class Program
  {
    /// <summary>
    /// Launches as an application when an argument "app" is supplied.
    /// Otherwise launches as a Windows Service.
    /// </summary>
    private static void Main(string[] arg)
    {
      var args = new List<string>(arg);
      ServiceBase[] ServicesToRun = new ServiceBase[]
      {
        new IrcServiceLibrary.Irc(
            Properties.Settings.Default.IrcTcpPort)
          };
      if (args.Contains("app"))
      {
        foreach (IExecutableService es in ServicesToRun)
          es.StartService();
        Thread.Sleep(Timeout.Infinite);
      }
      else
      {
        ServiceBase.Run(ServicesToRun);
      }
    }
  }
} 
```

## 会话建立

```
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Net;
using System.Net.Sockets;
using System.ServiceModel;
using System.ServiceProcess;
using System.Threading;

namespace IrcServiceLibrary
{
  /// <summary>
  /// Listens for TCP connection establishment and creates an 
  /// IrcSession object to handle the test session.
  /// </summary>
  [ServiceBehavior(ConcurrencyMode = ConcurrencyMode.Multiple, InstanceContextMode = InstanceContextMode.Single)]
  public partial class Irc : ServiceBase, IExecutableService
  {
    AutoResetEvent _autoResetEvent = new AutoResetEvent(false);
    TcpListener _tcpListener;
    List<IrcSession> _sessions = new List<IrcSession>();

    /// <summary>
    /// Creates Irc and applies configuration supplied by the service host.
    /// </summary>
    /// <param name="tcpPort">Port on which the session is established.</param>
    public Irc(int tcpPort)
    {
      Trace.TraceInformation("NetReady service created {0}", GetHashCode());
      InitializeComponent();
      _tcpListener = new TcpListener(IPAddress.Any, tcpPort); 
      NetReadySession.Sessions = _sessions;
    }

    void AcceptTcpClient(IAsyncResult asyncResult)
    {
      var listener = asyncResult.AsyncState as TcpListener;
      var tcpClient = listener.EndAcceptTcpClient(asyncResult);
      try
      {
        new NetReadySession(tcpClient);
      }
      catch (IndexOutOfRangeException)
      {
        //no free session - NetReadySession ctor already informed client, no action here
      } 
      _tcpListener.BeginAcceptTcpClient(AcceptTcpClient, _tcpListener);
    }

    /// <summary>
    /// <see cref="StartService">ServiceStart</see> 
    /// </summary>
    /// <param name="args">Arguments passed by the service control manager</param>
    protected override void OnStart(string[] args)
    {
      StartService();
    }

    /// <summary>
    /// <see cref="StopService">ServiceStop</see> 
    /// </summary>
    protected override void OnStop()
    {
      StopService();
    }

    void Execute(object state)
    {
      Trace.TraceInformation("IRC service started");
      _tcpListener.Start();
      _tcpListener.BeginAcceptTcpClient(AcceptTcpClient, _tcpListener);
      _autoResetEvent.WaitOne();
      _tcpListener.Stop();
    }

    internal static int UdpPortLow { get; set; }

    internal static int UdpPortHigh { get; set; }

    /// <summary>
    /// Starts the service. OnStart uses this method to implement startup behaviour.
    /// This guarantees identical behaviour across application and service modes.
    /// </summary>
    public void StartService()
    {
      ThreadPool.QueueUserWorkItem(Execute);
    }

    /// <summary>
    /// Stops the service. OnStop uses this method to implement shutdown behaviour.
    /// This guarantees identical behaviour across application and service modes.
    /// </summary>
    public void StopService()
    {
      _autoResetEvent.Set();
    }
  }
} 
```

## 会话行为

```
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.IO;
using System.Net;
using System.Net.Sockets;
using System.Text;

namespace IrcServiceLibrary
{
  public class IrcSession
  {    
    /// <summary>
    /// Exists to anchor sessions to prevent premature garbage collection
    /// </summary>
    public static List<IrcSession> Sessions;
    TcpClient _tcpClient;
    NetworkStream _stream;
    byte[] _buf; //remain in scope while awaiting data

    /// <summary>
    /// Created dynamically to manage an Irc session. 
    /// </summary>
    /// <param name="tcpClient">The local end of the TCP connection established by a test client 
    /// to request and administer a test session.</param>
    public IrcSession(TcpClient tcpClient)
    {
      Sessions.Add(this);
      _tcpClient = tcpClient;
      _stream = _tcpClient.GetStream();
      _buf = new byte[1];
      _stream.BeginRead(_buf, 0, 1, IncomingByteHandler, _buf);
    }

    void IncomingByteHandler(IAsyncResult ar)
    {
      byte[] buf = ar.AsyncState as byte[];
      try
      {
        byte[] buf = ar.AsyncState as byte[];
        int cbRead = _stream.EndRead(ar);
        //do something with the incoming byte which is in buf
        //probably feed it to a state machine
      }
      finally
      {
        //restart listening AFTER digesting byte to ensure in-order delivery to this code
        _stream.BeginRead(buf, 0, 1, IncomingByteHandler, buf);
      }
    }

  }
} 
```

# android - Android：下载时播放 mp4 文件，但选择“视频”播放器时显示“无法播放视频”

> ID：13150066
> 
> 赞同：0
> 
> 时间：2012-10-31T01:32:47.057
> 
> 标签：android, ffmpeg, h.264, mp4

我已经使用 h264 编解码器和 AAC 将视频转换为带有 ffmpeg 的 mp4，并使用了基线配置文件。

视频为 540x360x250kbps

然后我在文件上运行 qt-faststart 以将原子移动到正确的顺序。

我已将文件粘贴在我们使用的 wiki 上并创建了指向它的链接。

我的测试手机是三星 Galaxy S3。

当我浏览到上面有 mp4 链接的页面并单击它们时，我会看到一个带有 2 个选项的弹出窗口：Internet 和 Video。

如果我使用“Internet”选项下载视频，我可以毫无问题地在手机上播放它们。

我也使用主配置文件进行了其他编码，这些也可以正常工作。我认为像 s3 这样功能强大的手机将能够处理 h264 中可用的更高级的压缩方案，但是我也浏览了有关支持的视频格式的 Android 文档，似乎只有“基线”支持压缩配置文件。

无论如何，尝试使用我假设尝试流式传输视频的“视频”选项是行不通的。

对于有问题的 wiki，单击链接显示正在设置 content-type 和 content-length 标头：

```
Content-Length  6175996
Content-Type    video/mp4;charset=UTF-8 
```

使用浏览器单击链接会调用可以播放 mp4 的播放器（大多数情况下为 Quicktime）。

除了链接到它之外，还有更多的文件可以流式传输吗？为什么我的 Android 4 不能播放这些文件？

**更新：** *我决定使用视频标签制作一个快速的 HTML5 页面，这些视频确实可以在我的 Galaxy S3 和最新的 IOS 上播放。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T18:36:37.237

mp4 is not a streaming format. Unless you have a player that can handle pseudo streaming or pd streaming a link will simply cause a download. To get playback of mp4 file without downloading you need to have a player support. The default player is meant to play local files. To play files off the web in pseudo streaming form you need to have atleast a webapp with the appropriate player [say jwplayer]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T06:53:35.973

我怀疑您指的是 Apple 的 HTTP Live Streaming (HLS)，自 Honeycomb 以来，Android 就支持它。（正如您所怀疑的）比在 HTTP 服务器上粘贴 mp4 文件更复杂。您可以阅读有关[Apple 开发人员资源的](https://developer.apple.com/streaming/)更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T12:13:21.103

如果你想让一个 mp4 流式传输（以便它可以在下载完成之前开始播放），你需要运行 qt-faststart 以将 moov atom 放在正确的位置。

有关更多信息和大量参考资料，请参阅[http://forums.creativecow.net/thread/291/486#610](http://forums.creativecow.net/thread/291/486#610)。

# c# - 绑定到 ListView

> ID：13150067
> 
> 赞同：0
> 
> 时间：2012-10-31T01:32:51.847
> 
> 标签：c#, wpf, xaml

以前有人问过这个问题。我已经尝试了几件事并阅读了很多帖子，但无法使其正常工作。发生的情况是窗口打开，我看不到`listview`. 相反，我看到`System.Windows.Controls.Gridview Columns=3`

XAML 和代码隐藏。`ViewModel`如有必要，我可以发布

^(**XAML**)

```
<Window x:Class="DataBinding.LogFileWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:DataBinding"
        Title="LogFileWindow" Height="556.183" Width="717.987">
    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
    <Grid>

                <TabPanel Margin="12,131,128.6,12.4" Width="Auto" Grid.RowSpan="2">
            <TabControl Margin="10,10,-270,-223.8">
                <TabItem Header="Logging Log">
                        <ListView Name="LoggingListView" ItemsSource="{Binding LogEntries}">
                            <GridView>
                                <GridViewColumn Header="Date" DisplayMemberBinding="{Binding Path=Date}"></GridViewColumn>
                                <GridViewColumn Header="Time" DisplayMemberBinding="{Binding Path=Time}"></GridViewColumn>
                                <GridViewColumn Header="Event" DisplayMemberBinding="{Binding Path=Event}"></GridViewColumn>
                            </GridView>
                        </ListView>
                </TabItem>
                <TabItem Header="Accounting Log">
                    <ListView Name="AccountingListView" ItemsSource="{Binding}" Margin="0,0,-14.6,38.2"></ListView>
                </TabItem>
                <TabItem Header="NVRAM Log">
                    <ListView Name="NVRAMListView" ItemsSource="{Binding}"></ListView>
                </TabItem>
            </TabControl>
        </TabPanel>

    </Grid> 
```

**^(C＃)**

```
 public MainWindow()
        {   
            //create a new logging log file
            LoggingLog logfile = new LoggingLog();

            //add some entries
            // these are not real dates and times but that doesn't matter much.

            for (int i = 0; i < 20; i++)
            {
                LogFileEntry le = new LogFileEntry();
                le.Date = String.Format("Date{0}", i);
                le.Time = String.Format("Time{0}", i);
                le.Event = String.Format("Event{0}", i);
              logfile.LogEntryList.Add(le);
            }

            //now load the viewmodel

            LogViewModel logviewmodel = new LogViewModel();
            foreach (LogFileEntry le in logfile.LogEntryList)
            {
                logviewmodel.Add(new LogEntryViewModel(le));

            }

            //now set the datacontext on the window
            LogFileWindow lfwindow = new LogFileWindow();
            lfwindow.LogEntries = logviewmodel;
            lfwindow.LoggingListView.DataContext = logviewmodel;

            InitializeComponent();
            lfwindow.Show();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T01:41:35.947

上面的 XAML 将 GridView 对象作为 ListView 的内容插入。所以它会覆盖 ItemsSource。您想将 GridView 分配为 ListView 的视图：

```
<ListView Name="LoggingListView" ItemsSource="{Binding LogEntries}">
    <ListView.View>
        <GridView>
           <GridViewColumn Header="Date" DisplayMemberBinding="{Binding Path=Date}"></GridViewColumn>
           <GridViewColumn Header="Time" DisplayMemberBinding="{Binding Path=Time}"></GridViewColumn>
           <GridViewColumn Header="Event" DisplayMemberBinding="{Binding Path=Event}"></GridViewColumn>
         </GridView>
    </ListView.View>
</ListView> 
```

# awk - 错误的 awk：仅将一个字段的空格转换为制表符

> ID：13150072
> 
> 赞同：2
> 
> 时间：2012-10-31T01:33:27.773
> 
> 标签：awk

我收到了一个表格数据的 PDF 文件，我已将其转换为纯文本进行处理。

```
pdftotext -nopgbrk -layout file.pdf 
```

这做得相当不错，但使用空格来分隔/分隔列中的字段，并且似乎主要对保留视觉布局而不是“结构”布局感兴趣，即，没有一致或可靠的分隔符。所以现在我将 2 个或更多空格转换为制表符：

```
sed -i 's/[[:space:]]\{2,\}/\t/g' file.txt 
```

使用`cat -vte`我看到这在文件中放置选项卡做得非常好....但是，我想请你帮忙的第二个字段有一些不一致之处。

请参阅以下比较以进行说明：

正常/预期结果：

```
79879 5.6 0.5 MG EN SQ TFK 世界报告 09-24-2004 儿童编辑时间，ORD1915643
79880 5.5 0.5 MG EN SQ TFK 世界报告 10-01-2004 儿童编辑时间，ORD1915643
79881 6.0 0.5 MG EN SQ TFK 世界报告 10-08-2004 儿童编辑时间，ORD1915643
79882 5.5 0.5 MG EN SQ TFK 世界报告 2004 年 10 月 22 日儿童编辑时间，ORD1915643
79883 5.9 0.5 MG EN SQ TFK 世界报告 10-29-2004 儿童编辑时间，ORD1915643

```

一些奇怪和不一致的地方：

```
72 5.2 3.0 MG EN LS Ramona 和她的父亲 Cleary，Beverly ORD2111460
491 4.8 4.0 MG EN LS Ramona 和她的母亲 Cleary，Beverly ORD1748201
134 5.6 3.0 MG EN LS Ramona Quimby，8 岁 Cleary，Beverly ORD1748201
29 4.7 5.0 MG EN LS 来自 Basil E. Konigsburg 夫人的混合文件，EL ORD1525579

```

请注意，“smushing”效应可能出现在字段 2 或字段 3 中......并且，字段数与“正常”结果相差 1 或 2。

...所以，为了解决这个问题，我尝试了以下方法：

```
awk -F'\t' 'OFS="\t";$1 ~ /^[[:digit:]]/{print $1,gensub(/[[:space:]]/,"\t","g",$2),$3,$4,$5,$6,$7}' file.txt 
```

这似乎使每条线或至少大部分线加倍并切断了字段。

**编辑** 这似乎工作......到目前为止，仍在测试。

```
awk -F'\t' '{$2 = gensub( /[[:space:]]/, "\t", "g", $2 );
             $3 = gensub( /[[:space:]]/, "\t", "g", $3 )}
             {OFS="\t";print}' file.txt 
```

有没有使用 awk 解决这个问题的简单方法？

**更新**

有些人要求提供一个代表我的空格选项卡转换之前的状态的样本。下图表示文档中前一个样本所在位置附近的样本。看起来差不多......除了一个[下面]是间隔的，另一个[上面]是标签。请注意 pdftotext 在下面的不同示例中处理第 2 列的方式...有时会拆分，有时会制作单个列。

样品 1：

```
    72 5.2 3.0 MG EN RP Ramona 和她的父亲 Cleary，Beverly ORD0630871
是孤儿
   491 4.8 4.0 MG EN RP Ramona 和她的母亲 Cleary，Beverly ORD0785414
也是孤儿
   186 4.8 4.0 MG EN RP Ramona Forever Cleary，贝弗利 ORD0630871
永远的孤儿

```

样本 2：

```
  79871 5.7 0.5 MG EN SQ TFK 世界报告 03-18-2005 儿童编辑时间，ORD1915643
  79872 5.8 0.5 MG EN SQ TFK 世界报告 04-01-2005 儿童编辑时间，ORD1915643
  79873 6.0 0.5 MG EN SQ TFK 世界报告 04-08-2005 儿童编辑时间，ORD1915643

```

**更新 2**

对 Ed 的提交进行了以下更改。认为它可以简化，但它的工作原理。它必须允许孤立线。

```
$1 ~ /^[[:digit:]]+/{
   for (i=1;i<=6;i++)
      printf "%s\t", $i

   n = split($0,tmp,/  +/)

   for (i=2;i>=0;i--)
      printf "%s\t", tmp[n-i]

   print ""
}
$1 ~ /^[^[:digit:]]+/ {print $0} 
```

也许这更漂亮：

```
{
        if ($1 ~ /^[[:digit:]]+/) {
                for (i=1;i<=6;i++)
                printf "%s\t", $i

                n = split($0,tmp,/  +/)

                for (i=2;i>=0;i--)
                printf "%s\t", tmp[n-i]

                print ""
        }
        else print $0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T18:23:19.913

您的原始 awk 脚本似乎将每行加倍，因为`OFS="\t"`计算结果为`true`，因此打印当前行。把它放在一个`BEGIN{}`块中以避免重复：

```
gawk -F'\t' 'BEGIN{OFS=FS} $1 ~ /^[[:digit:]]/ {print $1,gensub(/[[:space:]]/,"\t","g",$2),$3,$4,$5,$6,$7}' file.txt 
```

请注意，它`gensub()`是 的一部分`gawk`，因此不可移植。您可以通过以下方式实现相同的目标：

```
awk -F'\t' 'BEGIN{OFS=FS} $1 ~ /^[[:digit:]]/ {gsub(/[[:space:]]/,"\t",$2); print $1,$2,$3,$4,$5,$6,$7}' file.txt 
```

也就是说......通过您的更新，我可以看到原始数据的格式已经足够好，我们可能可以按原样处理它。令人烦恼的是，第 2 列和第 4 列之间只有一个空格，或者我们可以简单地使用多个空格作为字段分隔符。但它仍然是一种可预测的输入格式。

似乎对于您的前 6 个字段，输入由“任何空格”分隔，对于后 3 个字段，它由“两个或多个空格”分隔。考虑到这一点，我们可以使用以下 awk 来解析您的输入数据：

```
#!/usr/bin/awk -f

BEGIN {
  FS="  +";
  fmt="----\n1=%s\n2=%s\n3=%s\n4=%s\n5=%s\n6=%s\n7=%s\n8=%s\n9=%s\n";
}

{
  # Grab the right-hand fields, separated by FS
  a[7]=$(NF-2); a[8]=$(NF-1); a[9]=$NF;

  # Then trim the line and grab initial fields, separated by whitespace
  sub(/^ +/, "");
  split($0, easy, /[[:space:]]+/);
  for(i=1;i<=6;i++) {
    a[i]=easy[i+1];
  }

  printf(fmt, a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9]);
} 
```

这假设您的倒数第二个字段和最后一个字段之间的间隔总是超过 1 个空格（如您在问题中提供的输入数据所示）。如果这不是一个安全的假设，您/我们可以围绕这个进行编码。

根据需要调整输出。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T14:24:55.860

我们不是从可能会破坏您的数据的 sed 命令的输出开始，而是在您对其运行该 sed 命令之前发布您的数据，然后让我们从那里开始。我怀疑既然您说 PDF 转换工具保留了“视觉布局”，那么正确的解决方案可能是简单地使用 gawk 的 FIELDWIDTHS 功能，因此您可以根据字段的宽度解析 PDF 转换器输出，而不是试图弄清楚表示字段分隔符需要多少个空格。

编辑：这是一个基于 match() 的比较解决方案，但实际上我现在认为@ghoti 是正确的，并且解决方案比这更简单：

```
$ cat file
    72   5.2 3.0 MG       EN   RP     Ramona and Her Father     Cleary, Beverly    ORD0630871
   491   4.8 4.0 MG       EN   RP     Ramona and Her Mother     Cleary, Beverly    ORD0785414
  79872  5.8  0.5  MG  EN   SQ    TFK World Report 04-01-2005  Time for Kids Editors,  ORD1915643
  79873  6.0  0.5  MG  EN   SQ    TFK World Report 04-08-2005  Time for Kids Editors,  ORD1915643
$
$ cat tst.awk
BEGIN {
   whl = "([[:digit:]]+)"
   dec = "([[:digit:]]+[.][[:digit:]]+)"
   wrd = "([^ ]+)"
   rst = "(.*)"
   s   = "[ ]+"
   fmt = whl s dec s dec s wrd s wrd s wrd s rst
}
{
   match($0,fmt,arr)
   split(arr[7],tmp,/  +/)
   arr[7] = tmp[1]
   arr[8] = tmp[2]
   arr[9] = tmp[3]

   for (i=1;i<=9;i++)
      printf "<%s>", arr[i]
   print ""
}
$
$ awk -f tst.awk file
<72><5.2><3.0><MG><EN><RP><Ramona and Her Father><Cleary, Beverly><ORD0630871>
<491><4.8><4.0><MG><EN><RP><Ramona and Her Mother><Cleary, Beverly><ORD0785414>
<79872><5.8><0.5><MG><EN><SQ><TFK World Report 04-01-2005><Time for Kids Editors,><ORD1915643>
<79873><6.0><0.5><MG><EN><SQ><TFK World Report 04-08-2005><Time for Kids Editors,><ORD1915643> 
```

编辑：是的，这是一个更简单的解决方案，只需打印前 6 个字段，然后将其余字段拆分为多空格分隔符：

```
$ cat tst2.awk
{
   for (i=1;i<=6;i++)
      printf "<%s>", $i

   n = split($0,tmp,/  +/)

   for (i=2;i>=0;i--)
      printf "<%s>", tmp[n-i]

   print ""
}
$
$ awk -f tst2.awk file
<72><5.2><3.0><MG><EN><RP><Ramona and Her Father><Cleary, Beverly><ORD0630871>
<491><4.8><4.0><MG><EN><RP><Ramona and Her Mother><Cleary, Beverly><ORD0785414>
<79872><5.8><0.5><MG><EN><SQ><TFK World Report 04-01-2005><Time for Kids Editors,><ORD1915643>
<79873><6.0><0.5><MG><EN><SQ><TFK World Report 04-08-2005><Time for Kids Editors,><ORD1915643> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T13:33:35.470

而不是`{print $1,gensub(/[[:space:]]/,"\t","g",$2),$3,$4,$5,$6,$7}`，尝试：

```
{ $2 = gensub( /[[:space:]]/, "\t", "g", $2 ); print } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T01:49:18.500

我认为只有最后的第 2 列和第 3 列实际上可以有空格？

我会尝试一些类似 Python 的东西：

```
import re
import sys

for line in sys.stdin:
    start = line.rstrip().split(None, 6)
    end = start.pop().rsplit(None, 1)
    mid = re.split('\s\s+', end.pop(0), maxsplit=1)
    print '\t'.join(start + mid + end) 
```

* * *

编辑：好的，如果你想坚持使用 coreutils/textutils 工具，这里有一个 sed 脚本，它的作用与上面的 Python 大致相同：

```
#!/bin/sed -f
s/^ *//
s/ \+/\t/
s/ \+/\t/
s/ \+/\t/
s/ \+/\t/
s/ \+/\t/
s/ \+/\t/
s/ \+\([^ ]\+\) *$/\t\1/
s/  \+/\t/ 
```

或者，作为单行：

```
sed -e 's/^ *//; s/ \+/\t/; s/ \+/\t/; s/ \+/\t/; s/ \+/\t/; s/ \+/\t/; s/ \+/\t/; s/ \+\([^ ]\+\) *$/\t\1/; s/  \+/\t/' 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-31T01:36:05.650

尝试这样做：

```
column -t file.txt > newfile.txt 
```

# android - 如何动态更新 TextView 文本

> ID：13150073
> 
> 赞同：3
> 
> 时间：2012-10-31T01:33:35.680
> 
> 标签：android

在 BroadcastReceiver 中，我会跟踪每次下载列表的时间，并且每次我想用最后一次更新文本视图。我已经完成了以下操作，但时间从未显示。

```
@Override
public void onReceive(Context context, Intent intent) {
_context = context;
Toast.makeText(context, "ListDownloadReceiver....", Toast.LENGTH_SHORT)
    .show();

boolean force = intent.getBooleanExtra("FORCE", false);

long nextUpdateTime = getUpdateTime();

if (force || nextUpdateTime < System.currentTimeMillis()) {
    if (isNetworkAvailable()) {
    Log.i(LIST_DOWNLOAD_RECEIVER,
        "Going to be downloading the list...");
    DownloadListData downloadList = new DownloadListData(context);
    downloadList.execute();

    } else {
    Log.i(LIST_DOWNLOAD_RECEIVER, "Not connected...");
    context.registerReceiver(this, new IntentFilter(
        ConnectivityManager.CONNECTIVITY_ACTION));
    }
}

DatabaseHandler db = DatabaseHandler.getInstance(context);
String timeFormat = "d/M/yyyy 'at' k:mm:ss";

long lastUpdate = Long.valueOf(db.getPreference("LAST_UPDATED_TIME",
    "0"));

CharSequence time = DateFormat.format(timeFormat, lastUpdate);
Log.i(LIST_DOWNLOAD_RECEIVER, "Time is: " + time);

LayoutInflater inflater = (LayoutInflater) context
    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
View view = inflater.inflate(R.layout.activity_main, null);
TextView tv = (TextView) view.findViewById(R.id.lastRefreshed);
tv.append("Blah: " + time);

} 
```

这是我的 .xml 文件

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="left|top"
    android:orientation="vertical" >

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/noShowsLayout"
        android:layout_width="match_parent"
        android:layout_height="115dp"
        android:orientation="horizontal"
        android:background="@color/blue" >

        <TextView
            android:id="@+id/noShowsTextView"
            android:layout_width="match_parent"
            android:layout_height="fill_parent"
            android:gravity="center"
            android:text="@string/no_added_shows"
            android:textAppearance="?android:attr/textAppearanceMedium"
            android:textSize="18dip" />
    </LinearLayout>

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:orientation="horizontal" >

        <ListView
            android:id="@+id/listView1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >
        </ListView>
    </LinearLayout>

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="48dp"
        android:layout_gravity="bottom"
        android:background="@color/blue"
        android:orientation="horizontal" >

        <ImageButton 
            android:id="@+id/refreshButton"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="left"
            android:contentDescription="@string/refresh"
            android:src="@drawable/refresh"/>

        <TextView
            android:id="@+id/lastRefreshed"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:layout_gravity="center"
            android:layout_marginLeft="5dp"
            android:text="@string/lastRefreshTime" 
            android:textAppearance="?android:attr/textAppearanceSmall" />

        <ImageButton
            android:id="@+id/button1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="right"
            android:contentDescription="@string/remove_tv_show"
            android:src="@drawable/content_discard" 
            android:clickable="false"/>

    </LinearLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-31T01:51:57.663

您编写了以下行以在 TextView 中显示文本，

```
TextView tv = (TextView) view.findViewById(R.id.lastRefreshed);
tv.append("Blah: " + time); 
```

我建议你使用 .setText() 方法而不是 .append() 方法，如下，

```
TextView tv = (TextView) view.findViewById(R.id.lastRefreshed);
tv.setText("Blah: " + time);
view.invalidate();  // for refreshment 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-04-15T15:25:53.677

尝试以下（它对我有用）：

```
runOnUiThread(new Runnable() {
    @Override
    public void run() {
        tv.setText("Blah: " + time);
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-11T10:03:57.743

在 run() 方法中创建一个新线程，编写代码以更新所考虑的字段，然后启动循环。一定要记住，您必须在 UI 线程上执行更新操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-15T14:46:00.163

添加了 OnClickListener 并实现了 onClick，使用 View 参数并强制转换为 TextView

```
@Override
public void onClick(View v) {
    TextView textView = (TextView) v;
    textView.setText(crotLoan.getReducedNumber());
} 
```

使用 onClick 的想法来自[How do you update the screen after you change the text with a setText?](https://stackoverflow.com/questions/3695993/how-do-you-update-the-screen-after-you-change-the-text-with-a-settext)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-03-08T08:55:18.840

UI 元素在 android 中的工作方式是，如果您想访问元素，您必须在 UI 线程中执行此操作，并且我们从 API 获取数据或从 nonui 线程获取与互联网相关的内容，因此在获得 nonui 线程的结果后，我们可以更新 UI轻松穿线元素。你一定在logcat中看到UI线程的工作量太大了。和那个东西有关。不要深入它如果你想在解析完数据后以编程方式更新它，调用ui线程并更新元素。

# sqlite - 在创建 sqlite3 表后添加 ON DELETE CASCADE 行为

> ID：13150075
> 
> 赞同：8
> 
> 时间：2012-10-31T01:33:50.107
> 
> 标签：sqlite, ddl

是否可以`ON DELETE CASCADE`在创建表后将其添加到表中？

我的架构如下：

`CREATE TABLE skills(name varchar, skill varchar, level int, foreign key(name) references runners(name), primary key(name, skill));`

如果外键被删除，我想级联。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-31T09:37:15.713

SQLite 的[`ALTER TABLE`命令](http://www.sqlite.org/lang_altertable.html)不能做你想做的事。

但是，可以绕过 SQL 解释器并直接更改内部表定义。SQLite 将表定义作为命令的*文本*副本存储`CREATE TABLE`在其[`sqlite_master`表中](http://www.sqlite.org/fileformat2.html#sqlite_master)；查看此查询的结果：

```
SELECT sql FROM sqlite_master WHERE type='table' AND name='skills'; 
```

`sqlite_master`将您的级联规范添加到该字符串，然后启用对with的写入访问权限[`PRAGMA writable_schema=1;`](http://www.sqlite.org/pragma.html#pragma_writable_schema)并将您的新表定义写入其中：

```
UPDATE sqlite_master SET sql='...' WHERE type='table' AND name='skills'; 
```

然后重新打开数据库。

**警告**：这仅适用于不更改表的磁盘格式的更改。如果您确实进行了更改记录格式的任何更改（例如添加/删除字段，或修改`rowid`），您的数据库将严重崩溃。

# css - 如何在 iPad/iPhone 链接中实现悬停状态？

> ID：13150077
> 
> 赞同：1
> 
> 时间：2012-10-30T23:36:15.863
> 
> 标签：css, iphone, ipad, ios

我最近在很多网站上注意到，在链接上实现了悬停状态。

例如有一堆链接，你触摸一个，它变成红色，你再次触摸它，链接就起作用了。

我尝试了各种 CSS 方法来实现这一点，但到目前为止还没有运气。

任何人都可以解释一下吗？

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T16:12:52.153

这是一篇讨论 iOS :hover/[双击问题](http://www.nczonline.net/blog/2012/07/05/ios-has-a-hover-problem/)的文章。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-30T23:50:24.423

这不是一个悬停事件，对我来说它似乎更像是一个点击事件。您单击，颜色会发生变化（或者更好的是，它会切换）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T00:23:44.233

好吧，您可以尝试这些切换/切换示例：[css toggle](http://ghinda.net/css-toggle-switches/)

# html - 为什么 Flexslider 没有初始化？

> ID：13150083
> 
> 赞同：0
> 
> 时间：2012-10-31T01:35:16.940
> 
> 标签：html, css, slider, flexslider

[http://ashwin931996.webege.com/](http://ashwin931996.webege.com/)

Flexslider 未初始化。有什么理由吗？

css 和 js 链接正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T01:38:27.913

应该先加载 jQuery，所以在`document.ready`

```
 $(function(){
      SyntaxHighlighter.all();
      $('.flexslider').flexslider({
        animation: "slide",
        start: function(slider){
          $('body').removeClass('loading');
        }
      });
    }); 
```

# linux - boost 1.50的二进制复制

> ID：13150089
> 
> 赞同：0
> 
> 时间：2012-10-31T01:36:17.290
> 
> 标签：linux, boost, g++, binary-reproducibility

为了源代码的完整性，我需要看看是否有可能使 boost 1.50 二进制文件可重现，而对源代码的更改尽可能少。挑战是在不更改任何 .cpp 或 .hpp 文件的情况下做到这一点。

由于**__ *TIME* __**和**__ *DATE* __**宏出现在 boost 库 WAVE 和 SPIRIT 中，只需编译两次并进行 diff 即可显示失败。

我正在使用 g++ 4.1.1 进行编译。任何人都知道通过某种环境变量告诉预处理器取消定义或重新定义这些宏的方法吗？如果不是环境变量，那么一些 g++ 命令行选项？我想我可以编辑一些 .jam 文件来重新定义**__ *TIME* __**和**__ *DATE* __**，宏到???? 或者 gcc 所说的默认值是当这些无法解决时。

也许有一种方法可以强制预处理器无法解析当前日期和时间，我可以启用、构建然后禁用它？

任何有关此的想法将不胜感激。谢谢你。

编辑：对于那些一直关注这个的人，我认为我在最初的问题中犯了一个严重的错误。我现在发现，使用完全相同的 bjam 构建命令进行简单的背靠背构建会产生 .a 和 .so 文件，它们除了**DATE**和**TIME**宏之外完全不同。二进制十六进制差异显示 .so 文件中的大量差异。.a 文件似乎遵循相同值始终不同的模式（这很可能是**TIME**和**DATE**宏值），但 .so 文件甚至不在同一个球场。如果有人有这种心情，我会挑战你两次构建 boost 1.50，比较构建输出并尝试证明除了构建日期/时间的变化所构成的信息差异之外，没有显着差异。

编辑（续集！）：在进行了更多挖掘之后，我发现了似乎是某种不一致的名称修改。只构建 boost 文件系统，两次，背靠背，并检查两者之间的文件 path.o 之间的差异，我注意到了这一点：

nm of first path.o: 00000000 b _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_8F1C916311path_localeE 0000000c b _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_8F1C916312dot_dot_pathE 00000000 r _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_8F1C916316separator_stringE 00000004 b _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_8F1C916317codecvt_facet_ptrE 00000004 r _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_8F1C916326preferred_separator_stringE 00000008 b _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_8F1C91638dot_pathE

nm of second path.o: 00000000 b _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_EDDD474511path_localeE 0000000c b _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_EDDD474512dot_dot_pathE 00000000 r _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_EDDD474516separator_stringE 00000004 b _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_EDDD474517codecvt_facet_ptrE 00000004 r _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_EDDD474526preferred_separator_stringE 00000008 b _ZN57_GLOBAL__N_libs_filesystem_src_path.cpp_00000000_EDDD47458dot_pathE

我不认为我以前见过这种事情。为什么这些特定的局部变量定义会被 EDDD4745 而不是 8F1C9163 破坏？有什么想法吗？今天我的头已经炸了一次（被附近的南瓜灯解决了）。这个简直是恶毒。

编辑：v3）

不幸的是，我仍然在做。在这一点上，我处于 ​​ELF 文件规范级别，试图确定发生了什么变化。我现在只是在使用 boost 文件系统。我的 bjam 命令是

```
`./b2 -a --with-filesystem --debug-building -d+2 toolset=gcc define=__DATE__="??" define=__TIME__="??" pch=off hardcode-dll-paths=false strip=on` 
```

试图确定到底是什么导致了这些差异是一件苦差事。readelf 很有帮助，但只是在一定程度上。我在这里有两个 readelf 命令在两个版本的 boost filesystem.so 上的差异，它使用了相同的源代码。我对这些东西的了解还不够，无法确定是什么影响了这些变化，也许世界上有人。

```
`diff x1diff x2diff 
120,123c120,123
< 00015044  0000cc01 R_386_32          00015070   _ZTIN5boost6system14er
< 0001506c  0000cc01 R_386_32          00015070   _ZTIN5boost6system14er
< 00015048  0000d701 R_386_32          00005760   _ZN5boost6system14erro
< 0001504c  0000af01 R_386_32          00005730   _ZN5boost6system14erro
---
> 00015044  0000cd01 R_386_32          00015070   _ZTIN5boost6system14er
> 0001506c  0000cd01 R_386_32          00015070   _ZTIN5boost6system14er
> 00015048  0000d801 R_386_32          00005760   _ZN5boost6system14erro
> 0001504c  0000b001 R_386_32          00005730   _ZN5boost6system14erro
128,133c128,133
< 00015058  00009801 R_386_32          00005690   _ZNK5boost6system14err
< 000150b8  00009801 R_386_32          00005690   _ZNK5boost6system14err
< 0001505c  0000bf01 R_386_32          000056b0   _ZNK5boost6system14err
< 000150bc  0000bf01 R_386_32          000056b0   _ZNK5boost6system14err
< 00015060  0000a901 R_386_32          00005710   _ZNK5boost6system14err
< 000150c0  0000a901 R_386_32          00005710   _ZNK5boost6system14err
---
> 00015058  00009901 R_386_32          00005690   _ZNK5boost6system14err
> 000150b8  00009901 R_386_32          00005690   _ZNK5boost6system14err
> 0001505c  0000c001 R_386_32          000056b0   _ZNK5boost6system14err
> 000150bc  0000c001 R_386_32          000056b0   _ZNK5boost6system14err
> 00015060  0000aa01 R_386_32          00005710   _ZNK5boost6system14err
> 000150c0  0000aa01 R_386_32          00005710   _ZNK5boost6system14err
141,142c141,142
< 00015068  0000f001 R_386_32          00012180   _ZTSN75_GLOBAL__N_libs
< 00015074  00007b01 R_386_32          00012200   _ZTSN5boost6system14er
---
> 00015068  00007701 R_386_32          00012180   _ZTSN75_GLOBAL__N_libs
> 00015074  00007c01 R_386_32          00012200   _ZTSN5boost6system14er
146,152c146,152
< 00015080  00007e01 R_386_32          00012220   _ZTSN5boost12noncopyab
< 000150a4  0000d801 R_386_32          00015064   _ZTIN75_GLOBAL__N_libs
< 000150cc  00007801 R_386_32          000150dc   _ZTIN5boost6system12sy
< 000150f0  00007801 R_386_32          000150dc   _ZTIN5boost6system12sy
< 00015300  00007806 R_386_GLOB_DAT    000150dc   _ZTIN5boost6system12sy
< 000150d0  00009701 R_386_32          0000c810   _ZN5boost6system12syst
< 000152f4  00009706 R_386_GLOB_DAT    0000c810   _ZN5boost6system12syst
---
> 00015080  00007f01 R_386_32          00012220   _ZTSN5boost12noncopyab
> 000150a4  0000ea01 R_386_32          00015064   _ZTIN75_GLOBAL__N_libs
> 000150cc  00007901 R_386_32          000150dc   _ZTIN5boost6system12sy
> 000150f0  00007901 R_386_32          000150dc   _ZTIN5boost6system12sy
> 00015300  00007906 R_386_GLOB_DAT    000150dc   _ZTIN5boost6system12sy
> 000150d0  00009801 R_386_32          0000c810   _ZN5boost6system12syst
> 000152f4  00009806 R_386_GLOB_DAT    0000c810   _ZN5boost6system12syst
154c154
< 000150d8  0000a501 R_386_32          0000c8b0   _ZNK5boost6system12sys
---
> 000150d8  0000a601 R_386_32          0000c8b0   _ZNK5boost6system12sys
158,161c158,161
< 000150fc  0000a301 R_386_32          000150e8   _ZTIN5boost10filesyste
< 00015304  0000a306 R_386_GLOB_DAT    000150e8   _ZTIN5boost10filesyste
< 00015100  00009501 R_386_32          0000cdd0   _ZN5boost10filesystem1
< 000152e4  00009506 R_386_GLOB_DAT    0000cdd0   _ZN5boost10filesystem1
---
> 000150fc  0000a401 R_386_32          000150e8   _ZTIN5boost10filesyste
> 00015304  0000a406 R_386_GLOB_DAT    000150e8   _ZTIN5boost10filesyste
> 00015100  00009601 R_386_32          0000cdd0   _ZN5boost10filesystem1
> 000152e4  00009606 R_386_GLOB_DAT    0000cdd0   _ZN5boost10filesystem1
163,164c163,164
< 00015108  0000c701 R_386_32          0000d6d0   _ZNK5boost10filesystem
< 00015114  0000d201 R_386_32          0001512c   _ZTIN5boost6detail17sp
---
> 00015108  0000c801 R_386_32          0000d6d0   _ZNK5boost10filesystem
> 00015114  0000d301 R_386_32          0001512c   _ZTIN5boost6detail17sp
166,176c166,176
< 0001511c  0000b001 R_386_32          0000c700   _ZN5boost6detail17sp_c
< 00015120  00008b01 R_386_32          0000cb10   _ZN5boost6detail17sp_c
< 00015124  00009301 R_386_32          0000c620   _ZN5boost6detail15sp_c
< 00015154  00009301 R_386_32          0000c620   _ZN5boost6detail15sp_c
< 00015174  00009301 R_386_32          0000c620   _ZN5boost6detail15sp_c
< 00015128  0000c101 R_386_32          0000c650   _ZN5boost6detail17sp_c
< 00015130  0000cf01 R_386_32          00012680   _ZTSN5boost6detail17sp
< 00015134  0000a801 R_386_32          00015138   _ZTIN5boost6detail15sp
< 00015144  0000a801 R_386_32          00015138   _ZTIN5boost6detail15sp
< 00015184  0000a801 R_386_32          00015138   _ZTIN5boost6detail15sp
< 0001513c  0000bb01 R_386_32          000126e0   _ZTSN5boost6detail15sp
---
> 0001511c  0000b101 R_386_32          0000c700   _ZN5boost6detail17sp_c
> 00015120  00008c01 R_386_32          0000cb10   _ZN5boost6detail17sp_c
> 00015124  00009401 R_386_32          0000c620   _ZN5boost6detail15sp_c
> 00015154  00009401 R_386_32          0000c620   _ZN5boost6detail15sp_c
> 00015174  00009401 R_386_32          0000c620   _ZN5boost6detail15sp_c
> 00015128  0000c201 R_386_32          0000c650   _ZN5boost6detail17sp_c
> 00015130  0000d001 R_386_32          00012680   _ZTSN5boost6detail17sp
> 00015134  0000a901 R_386_32          00015138   _ZTIN5boost6detail15sp
> 00015144  0000a901 R_386_32          00015138   _ZTIN5boost6detail15sp
> 00015184  0000a901 R_386_32          00015138   _ZTIN5boost6detail15sp
> 0001513c  0000bc01 R_386_32          000126e0   _ZTSN5boost6detail15sp
178c178
< 0001514c  0000d501 R_386_32          0000c670   _ZN5boost6detail15sp_c
---
> 0001514c  0000d601 R_386_32          0000c670   _ZN5boost6detail15sp_c
180,189c180,189
< 00015168  0000ed01 R_386_32          0000c6e0   _ZN5boost6detail17sp_c
< 0001516c  0000c501 R_386_32          0000c730   _ZN5boost6detail17sp_c
< 00015170  00007c01 R_386_32          0000ca30   _ZN5boost6detail17sp_c
< 00015178  0000c301 R_386_32          0000c660   _ZN5boost6detail17sp_c
< 00015180  0000ae01 R_386_32          00012720   _ZTSN5boost6detail17sp
< 000151a4  0000c801 R_386_32          000151d0   _ZTIN5boost10filesyste
< 000151a8  0000d401 R_386_32          000120c0   _ZN5boost10filesystem6
< 000151ac  0000ab01 R_386_32          00012080   _ZN5boost10filesystem6
< 000151b0  0000aa01 R_386_32          00011ee0   _ZNK5boost10filesystem
< 000151b4  0000bd01 R_386_32          00012050   _ZNK5boost10filesystem
---
> 00015168  0000ee01 R_386_32          0000c6e0   _ZN5boost6detail17sp_c
> 0001516c  0000c601 R_386_32          0000c730   _ZN5boost6detail17sp_c
> 00015170  00007d01 R_386_32          0000ca30   _ZN5boost6detail17sp_c
> 00015178  0000c401 R_386_32          0000c660   _ZN5boost6detail17sp_c
> 00015180  0000af01 R_386_32          00012720   _ZTSN5boost6detail17sp
> 000151a4  0000c901 R_386_32          000151d0   _ZTIN5boost10filesyste
> 000151a8  0000d501 R_386_32          000120c0   _ZN5boost10filesystem6
> 000151ac  0000ac01 R_386_32          00012080   _ZN5boost10filesystem6
> 000151b0  0000ab01 R_386_32          00011ee0   _ZNK5boost10filesystem
> 000151b4  0000be01 R_386_32          00012050   _ZNK5boost10filesystem
192c192
< 000151c0  0000ce01 R_386_32          00012040   _ZNK5boost10filesystem
---
> 000151c0  0000cf01 R_386_32          00012040   _ZNK5boost10filesystem
194,196c194,196
< 000151c8  00008801 R_386_32          00012070   _ZNK5boost10filesystem
< 000151cc  00009601 R_386_32          00011cb0   _ZNK5boost10filesystem
< 000151d4  00008901 R_386_32          00012900   _ZTSN5boost10filesyste
---
> 000151c8  00008901 R_386_32          00012070   _ZNK5boost10filesystem
> 000151cc  00009701 R_386_32          00011cb0   _ZNK5boost10filesystem
> 000151d4  00008a01 R_386_32          00012900   _ZTSN5boost10filesyste
202c202
< 000152f0  0000a206 R_386_GLOB_DAT    00015110   _ZTVN5boost6detail17sp
---
> 000152f0  0000a306 R_386_GLOB_DAT    00015110   _ZTVN5boost6detail17sp
207c207
< 00015314  0000b506 R_386_GLOB_DAT    00015160   _ZTVN5boost6detail17sp
---
> 00015314  0000b606 R_386_GLOB_DAT    00015160   _ZTVN5boost6detail17sp
223c223
< 00015350  00007f07 R_386_JUMP_SLOT   0000e3e0   _ZNK5boost10filesystem
---
> 00015350  00008007 R_386_JUMP_SLOT   0000e3e0   _ZNK5boost10filesystem
227c227
< 00015360  0000b207 R_386_JUMP_SLOT   00009d10   _ZN5boost10filesystem6
---
> 00015360  0000b307 R_386_JUMP_SLOT   00009d10   _ZN5boost10filesystem6
230,231c230,231
< 0001536c  0000c607 R_386_JUMP_SLOT   0000f8e0   _ZNK5boost10filesystem
< 00015370  00009d07 R_386_JUMP_SLOT   0000e370   _ZN5boost10filesystem4
---
> 0001536c  0000c707 R_386_JUMP_SLOT   0000f8e0   _ZNK5boost10filesystem
> 00015370  00009e07 R_386_JUMP_SLOT   0000e370   _ZN5boost10filesystem4
235,237c235,237
< 00015380  00007707 R_386_JUMP_SLOT   000078a0   _ZN5boost10filesystem6
< 00015384  0000b607 R_386_JUMP_SLOT   0000cf20   _ZN5boost10filesystem1
< 00015388  0000b807 R_386_JUMP_SLOT   0000f490   _ZN5boost10filesystem4
---
> 00015380  00007807 R_386_JUMP_SLOT   000078a0   _ZN5boost10filesystem6
> 00015384  0000b707 R_386_JUMP_SLOT   0000cf20   _ZN5boost10filesystem1
> 00015388  0000b907 R_386_JUMP_SLOT   0000f490   _ZN5boost10filesystem4
239c239
< 00015390  0000a007 R_386_JUMP_SLOT   000099f0   _ZN5boost10filesystem6
---
> 00015390  0000a107 R_386_JUMP_SLOT   000099f0   _ZN5boost10filesystem6
241c241
< 00015398  00008507 R_386_JUMP_SLOT   00005880   _ZN5boost10filesystem6
---
> 00015398  00008607 R_386_JUMP_SLOT   00005880   _ZN5boost10filesystem6
250c250
< 000153bc  0000d607 R_386_JUMP_SLOT   00010770   _ZNK5boost10filesystem
---
> 000153bc  0000d707 R_386_JUMP_SLOT   00010770   _ZNK5boost10filesystem
254,255c254,255
< 000153cc  0000d007 R_386_JUMP_SLOT   000092c0   _ZN5boost10filesystem6
< 000153d0  0000a407 R_386_JUMP_SLOT   0000f2b0   _ZNK5boost10filesystem
---
> 000153cc  0000d107 R_386_JUMP_SLOT   000092c0   _ZN5boost10filesystem6
> 000153d0  0000a507 R_386_JUMP_SLOT   0000f2b0   _ZNK5boost10filesystem
257c257
< 000153d8  0000cd07 R_386_JUMP_SLOT   000095f0   _ZN5boost10filesystem6
---
> 000153d8  0000ce07 R_386_JUMP_SLOT   000095f0   _ZN5boost10filesystem6
260c260
< 000153e4  00008f07 R_386_JUMP_SLOT   000069e0   _ZN5boost10filesystem6
---
> 000153e4  00009007 R_386_JUMP_SLOT   000069e0   _ZN5boost10filesystem6
269c269
< 00015408  0000ee07 R_386_JUMP_SLOT   00011ea0   _ZNK5boost10filesystem
---
> 00015408  0000ef07 R_386_JUMP_SLOT   00011ea0   _ZNK5boost10filesystem
272,273c272,273
< 00015414  0000ca07 R_386_JUMP_SLOT   0000f7d0   _ZNK5boost10filesystem
< 00015418  0000d107 R_386_JUMP_SLOT   0000df70   _ZNK5boost10filesystem
---
> 00015414  0000cb07 R_386_JUMP_SLOT   0000f7d0   _ZNK5boost10filesystem
> 00015418  0000d207 R_386_JUMP_SLOT   0000df70   _ZNK5boost10filesystem
277c277
< 00015428  0000c907 R_386_JUMP_SLOT   0000d2f0   _ZN5boost10filesystem1
---
> 00015428  0000ca07 R_386_JUMP_SLOT   0000d2f0   _ZN5boost10filesystem1
286,287c286,287
< 0001544c  0000b707 R_386_JUMP_SLOT   0000e190   _ZNK5boost10filesystem
< 00015450  0000c007 R_386_JUMP_SLOT   00011c70   _ZN5boost10filesystem6
---
> 0001544c  0000b807 R_386_JUMP_SLOT   0000e190   _ZNK5boost10filesystem
> 00015450  0000c107 R_386_JUMP_SLOT   00011c70   _ZN5boost10filesystem6
295c295
< 00015470  0000ea07 R_386_JUMP_SLOT   000063c0   _ZN5boost10filesystem6
---
> 00015470  0000eb07 R_386_JUMP_SLOT   000063c0   _ZN5boost10filesystem6
297c297
< 00015478  00008e07 R_386_JUMP_SLOT   00011170   _ZN5boost10filesystem1
---
> 00015478  00008f07 R_386_JUMP_SLOT   00011170   _ZN5boost10filesystem1
303c303
< 00015490  0000a707 R_386_JUMP_SLOT   0000ded0   _ZN5boost10filesystem4
---
> 00015490  0000a807 R_386_JUMP_SLOT   0000ded0   _ZN5boost10filesystem4
306c306
< 0001549c  00009e07 R_386_JUMP_SLOT   00005490   _ZN5boost10filesystem2
---
> 0001549c  00009f07 R_386_JUMP_SLOT   00005490   _ZN5boost10filesystem2
319c319
< 000154d0  00007d07 R_386_JUMP_SLOT   0000efd0   _ZNK5boost10filesystem
---
> 000154d0  00007e07 R_386_JUMP_SLOT   0000efd0   _ZNK5boost10filesystem
325,326c325,326
< 000154e8  00008c07 R_386_JUMP_SLOT   00010eb0   _ZN5boost10filesystem1
< 000154ec  00008207 R_386_JUMP_SLOT   000091c0   _ZN5boost10filesystem6
---
> 000154e8  00008d07 R_386_JUMP_SLOT   00010eb0   _ZN5boost10filesystem1
> 000154ec  00008307 R_386_JUMP_SLOT   000091c0   _ZN5boost10filesystem6
329c329
< 000154f8  00008d07 R_386_JUMP_SLOT   0000ea70   _ZN5boost10filesystem4
---
> 000154f8  00008e07 R_386_JUMP_SLOT   0000ea70   _ZN5boost10filesystem4
334c334
< 0001550c  00009007 R_386_JUMP_SLOT   0000fbb0   _ZNK5boost10filesystem
---
> 0001550c  00009107 R_386_JUMP_SLOT   0000fbb0   _ZNK5boost10filesystem
337,340c337,340
< 00015518  0000eb07 R_386_JUMP_SLOT   00011270   _ZN5boost10filesystem1
< 0001551c  0000b107 R_386_JUMP_SLOT   000114b0   _ZN5boost10filesystem1
< 00015520  00009b07 R_386_JUMP_SLOT   0000c640   _ZN5boost6detail26sp_e
< 00015524  00009c07 R_386_JUMP_SLOT   0000f000   _ZNK5boost10filesystem
---
> 00015518  0000ec07 R_386_JUMP_SLOT   00011270   _ZN5boost10filesystem1
> 0001551c  0000b207 R_386_JUMP_SLOT   000114b0   _ZN5boost10filesystem1
> 00015520  00009c07 R_386_JUMP_SLOT   0000c640   _ZN5boost6detail26sp_e
> 00015524  00009d07 R_386_JUMP_SLOT   0000f000   _ZNK5boost10filesystem
342c342
< 0001552c  0000a607 R_386_JUMP_SLOT   0000dd00   _ZN5boost10filesystem4
---
> 0001552c  0000a707 R_386_JUMP_SLOT   0000dd00   _ZN5boost10filesystem4
344c344
< 00015534  0000ad07 R_386_JUMP_SLOT   00007aa0   _ZN5boost10filesystem6
---
> 00015534  0000ae07 R_386_JUMP_SLOT   00007aa0   _ZN5boost10filesystem6
591,597c591,597
<    234: 000063c0  1559 FUNC    GLOBAL DEFAULT   10 _ZN5boost10filesystem6det
<    235: 00011270    81 FUNC    GLOBAL DEFAULT   10 _ZN5boost10filesystem19po
<    236: 00009020   405 FUNC    GLOBAL DEFAULT   10 _ZN5boost10filesystem6det
<    237: 0000c6e0    30 FUNC    WEAK   DEFAULT   10 _ZN5boost6detail17sp_coun
<    238: 00011ea0    59 FUNC    GLOBAL DEFAULT   10 _ZNK5boost10filesystem6de
<    239: 000155b8     8 OBJECT  WEAK   DEFAULT   24 _ZGVZNK5boost10filesystem
<    240: 00012180    99 OBJECT  WEAK   DEFAULT   12 _ZTSN75_GLOBAL__N_libs_fi
---
>    234: 00015064    12 OBJECT  WEAK   DEFAULT   19 _ZTIN75_GLOBAL__N_libs_fi
>    235: 000063c0  1559 FUNC    GLOBAL DEFAULT   10 _ZN5boost10filesystem6det
>    236: 00011270    81 FUNC    GLOBAL DEFAULT   10 _ZN5boost10filesystem19po
>    237: 00009020   405 FUNC    GLOBAL DEFAULT   10 _ZN5boost10filesystem6det
>    238: 0000c6e0    30 FUNC    WEAK   DEFAULT   10 _ZN5boost6detail17sp_coun
>    239: 00011ea0    59 FUNC    GLOBAL DEFAULT   10 _ZNK5boost10filesystem6de
>    240: 000155b8     8 OBJECT  WEAK   DEFAULT   24 _ZGVZNK5boost10filesystem
619,623c619,623
<       0  42         ( 32.1%)
<       1  49         ( 37.4%)     34.8%
<       2  32         ( 24.4%)     80.1%
<       3  4          (  3.1%)     88.7%
<       4  4          (  3.1%)    100.0%
---
>       0  41         ( 31.3%)
>       1  50         ( 38.2%)     35.5%
>       2  32         ( 24.4%)     80.9%
>       3  5          (  3.8%)     91.5%
>       4  3          (  2.3%)    100.0%` 
```

（我不得不删减文件中的一些条目以适应帖子）。在大多数情况下，其中一些条目的行号似乎不同。什么可能会改变 ELF 文件中符号条目的顺序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:44:05.177

我终于找到了答案，我不敢相信我花了这么长时间才找到它。匿名命名空间在这里存在问题，而不是提升本身。显然， boost 1_50 包含一些匿名命名空间。看起来我正在使用的编译器，gcc 4.1.1 的 ABI 或其他任何东西（甚至可能是其他更新或更旧的）在每次编译翻译单元时生成一个新的和不同的 UUID 来为这些匿名命名空间中的符号添加前缀，我猜将唯一性应用于外部链接符号的原因（正确？不正确？）。这种情况下的解决方案是使用编译器提供的 -frandom-seed 标志。[当我偶然看到这个页面](http://communities.mentor.com/community/cs/archives/arm-gnu/msg01293.html)时，我终于被告知可能会发生什么。

[这是 frandom-seed 编译器标志的文档。](http://gcc.gnu.org/onlinedocs/gcc-4.1.1/gcc/Debugging-Options.html)

我的用例最终是 -frandom-seed="0"

**最后，它实际上与 __DATE __ 和 __ TIME __****宏*无关***（**直到*****处理*****boost** *WAVE和 SPIRIT，它们确实包含在 1.50 中）。*

 *这个真的打到我了。

在“二进制再现性”标签下，堆栈溢出似乎没有任何关于此的内容。似乎在其他文章中使用了“二进制再现性”之外的其他短语，所以我使用的搜索参数没有提出任何内容。谁知道？不是我，长官。*

# javascript - 使用 Javascript Ajax 调用调用 MVC 动作来下载对象

> ID：13150096
> 
> 赞同：1
> 
> 时间：2012-10-31T01:36:56.010
> 
> 标签：javascript, jquery, ajax, asp.net-mvc

我创建了一个简单的 MVC 控制器动作，它创建了一个简单的 ics（日历）项目并通过控制器动作将其发送回。如下：

```
 public object GenerateICS(int myID)
    {
        iCalendar iCal = new iCalendar();            
         Event evt = iCal.Create<Event>();
        Uri eventLink = new Uri("http://localhost:");
        evt.IsAllDay = false;

       evt.Start = new iCalDateTime(DateTime.Now);
       evt.End = new iCalDateTime(DateTime.Now.AddDays(3));

       evt.Summary = "MySummary";
       evt.Url = eventLink;
       evt.Description = "You know it";         

      Response.ContentType = "text/v-calendar";
      Response.AddHeader("content-disposition", "attachment; filename=" + "Event" + ".ics");
      iCalendarSerializer serializer = new iCalendarSerializer(iCal);
      string result = serializer.SerializeToString(iCal);
      Response.Write(result);          
        return Response;
    } 
```

所以随着网站的运行，如果我去：

```
http://localhost:21312/GenerateICS?myID=1 
```

这将生成 ics 文件服务器端并将其传递回客户端，因此您会收到“您想从 localhost 打开 blah.ics 吗？”。这完全是我想要的。

我的问题是如何通过从 javascript 执行它来实现完全相同的效果。我有以下ajax调用：

```
 $.ajax({
                url: "app/GenerateICS",
                data: { myID: 1 },
                success: function (data) {
                    //call is successfully completed and we got result in data
                    alert(data);
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    //some errror, some show err msg to user and log the error  
                    alert(xhr.responseText);

                }
            }); 
```

这完美地执行了 mvc 控制器。但它会将 ics 响应返回给成功函数。我如何使用 ajax 调用控制器但拥有它以便下载文件，因为我描述了当您手动执行它时它是如何做的？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:15:45.103

感谢@heads5150 提供链接。

这只是设置浏览器位置的事实：

```
document.location.href = "app/GenerateICS?..."; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:28:19.347

我只是在寻找从 js 下载，答案通常与创建 iframe 并完成它有关。甚至有一些 jquery 插件可以做到这一点。一些例如：

[使用 Javascript/jQuery 下载文件](https://stackoverflow.com/questions/3749231/download-file-using-javascript-jquery)

[http://johnculviner.com/category/jQuery-File-Download.aspx](http://johnculviner.com/category/jQuery-File-Download.aspx)

如果你谷歌它，你可以找到更多关于这个主题的信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T01:59:43.703

在你的ajax成功中，把这个

```
 Window.location.href='yourICSfileLink'; 
```

这将在 ajax 创建文件成功时重定向浏览器然后打开，或者在这种情况下下载 ics 文件，注意每次 ajax 成功时都会发生这种情况

# scala - 尝试在Scala中动态分配一个类

> ID：13150101
> 
> 赞同：2
> 
> 时间：2012-10-31T01:38:09.457
> 
> 标签：scala, dynamic

任何人都知道如何在 Scala (2.10) 中动态分配一个类？我有一些课程 MyClass。我正在使用 Akka (2.0)，我真的很想能够做类似的事情：

```
classnames = List[String]("fqcn", "fqcn", fqcn"....]
for (name <- classnames) {
     val clazz = classLoader.load(name)
     val actRef = actorSystem.actorOf(Props[clazz])
} 
```

但是，Akka 还有其他限制。所以我能做的最好的（我认为）是：

```
val activeClasses = HashMap([String, String, ActorRef]
     ("commonname" -> 
       "Fqcn", actorOf(Props[new classobject]])
  ) 
```

其中 classobject 是文字类，而不是类加载器的名称引用。我真的必须在某处编译该类并执行

actorOf(道具[**新**类对象* *** ])

这看起来很丑陋——有没有更好、更优雅的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T03:59:29.153

修复您提供的第一个示例，请参阅评论：

```
classnames = List[String]("fqcn", "fqcn", "fqcn"....) // close ( with ) not ]
for (name <- classnames) {
     val clazz = classLoader.forName(name) // forName is what loads a class
     //val actRef = actorSystem.actorOf(Props[clazz]) // still wrong I will explain later
} 
```

第二个示例还有一些问题。

首先`HashMap([String, String, ActorRef]("commonname" -> "Fqcn", someThing))`，它几乎是正确的，但有一些关键的句法错误。

在 Scala`[]`中用于声明或定义类型参数，看来我们手头的案例是定义问题，换句话说，我们要声明什么类型参数。只有少数地方 Scala 允许放置类型参数，在类实例化之后（例如`new HashMap[String, Int]`）和方法调用中（例如`list.map[String](...)`.

因此，将类型参数放置为 in`HashMap[String, String, ActorRef](...)`将是有效的 Scala 语法，并且由于 HashMap 是伴生对象，因此在对`HashMap.apply[String, String, ActorRef](...)`.

但是这个表达式还有一个很大的问题，HashMap 只带了两个类型参数，一个是键，一个是值。查看您的代码，似乎所需的键是一个元组。所以要让它工作：`HashMap[(String, String), ActorRef](...)`

现在进行最后一次修复`Props[new classobject]`，再次混淆类型参数。类型参数采用**类型**而不是实例，任何“新事物”都将创建某事物的实例。你必须做`Props[SomeClass]`。作为快速方面，术语“类对象”通常指的是类的实例，而不是类本身。

第二个样本的语法有效版本：

```
val activeClasses = HashMap[(String, String), ActorRef](
   ("commonname" ->  "Fqcn", actorOf(Props[SomeClass]))
) 
```

回到第一个示例和这一行：

```
val actRef = actorSystem.actorOf(Props[clazz]) 
```

`clazz`这是 Class[_] 的一个实例，上面的代码甚至都不是有效代码。这似乎`Props.apply[T <: ActorRef]...`需要一个类型，它会为您处理实例化它。但是您只有包含类的 Class[_]。如何解决这个问题？碰巧有另一个 Props.apply 代替了将要进行实例化的actor类的构造，看看它的签名：

```
def apply(creator: ⇒ Actor) 
```

为什么不使用这个？

```
classnames = List[String]("fqcn", "fqcn", "fqcn"....)
for (name <- classnames) {
     val clazz = classLoader.forName(name)
     val actRef = 
        actorSystem.actorOf(Props( clazz.newInstance.asInstanceOf[Actor] )) 
} 
```

假设第二个样本会以某种方式依赖第一个样本：

```
val activeClasses = HashMap[(String, String), ActorRef](
   ("commonname" ->  "Fqcn", 
     actorOf(Props( clazz.newInstance.asInstanceOf[Actor] ) )
) 
```

关于这些样本的一些评论：

*   这两个类型参数都是不必要的。编译器可以为您推断。
*   除了使用`(a -> b, c)`for 定义其第一个元素是元组的元组，您可以使用`a -> b ->`，这将导致`((a,b),c)`. `->`是左关联的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T02:30:29.867

由于 clazz 来自 classLoader，因此无法使用 Props[] 来创建 ActorRef

所以`Props.apply`改用

```
actorOf(Props(clazz.newInstance.asInstanceOf[Actor])) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T14:45:49.647

这在 Akka 邮件列表中得到了回答：[https ://groups.google.com/group/akka-user/browse_thread/thread/6823203b3c8470be/8ad21fcfb39b0e25?lnk=gst&q=dynamicAccess](https://groups.google.com/group/akka-user/browse_thread/thread/6823203b3c8470be/8ad21fcfb39b0e25?lnk=gst&q=dynamicAccess)

简而言之，创建一个处理动态类加载的Akka Extension并获取传入的ExtendedActorSystem，通过“dynamicAccess”方法获取其DynamicAccess并使用该方法加载类。这将使用与 Akka 中所有动态类加载相同的 ClassLoader，它与您传递给 ActorSystem 的 ClassLoader 相同。

# mysql - mysql query join: Pages in Sections OR Subsections，是否有更好的替代 GROUP BY 来消除欺骗？

> ID：13150106
> 
> 赞同：1
> 
> 时间：2012-10-31T01:38:53.590
> 
> 标签：mysql, categories, duplicate-removal, adjacency-list

**更新：我在生产中使用我的问题中显示的 sql 查询，但是如果您想查看另一种方法，请阅读整个线程，使用带有 UNION 的 sql**

我已经试验并制作了一个用于内容搜索的结果集，但我想确保它的性能是最好的。

我有一个名为 SECTIONS 的表，它在邻接列表模型中包含 2 个级别的部分，即级别 1（一个部分）和级别 2（一个子部分）

```
SECTIONS: id, parent_id, name 
```

我查询该表两次以获取排列中的列

```
sec_id, sec_name, subsec_id, subsec_name 
```

（这样我就可以创建像 /section_id/subsection_id 这样的 uri 链接）

现在我加入一个名为 PAGES 的单独表，其中一个页面可以通过字段 section_id 与一个部分或一个子部分（两者都不是）相关联

```
-- columns to return
SELECT
s.id as section_id,
s.name as section_name,
ss.id as subsection_id,
ss.parent_id as subsection_parent_id,
ss.name as subsection_name,
p.section_id as page_section_id,
p.name as page_name

-- join SECTIONS into Sections and SubSections
FROM 
( select id, name from sections where parent_id=0 ) as s

LEFT JOIN
( select id, parent_id, name from sections where parent_id!=0 ) as ss

ON
ss.parent_id = s.id

-- now join to PAGES table
JOIN 
( select id, section_id, name from pages where active=1 ) as p

ON
(
p.section_id = s.id
OR
p.section_id = ss.id 
)
-- need to use GROUP BY to eliminate duplicate pages
GROUP BY p.id 
```

我在结果集中得到了重复的页面，所以我使用 GROUP BY pages.id 来删除重复的页面，但这会稍微降低性能。

你能建议一个更好的方法来消除重复吗？

我已经考虑在 SECTIONS 连接中创建一个包含 Section ID 或 Subsection ID 的列（取决于行的类型 - 部分或子部分），然后使用它与 PAGES section_id 相关联，所以不会有重复的行，但我不知道该怎么做。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T16:32:51.180

您会得到重复的页面，因为您没有区分与级别 1 部分相关的页面与与级别 2 部分相关的页面。相反，将页面分为两个不同的组：

```
-- pages related to a level-2 section
SELECT
    p.id, p.section_id, p.name,
    l1.id AS section_id, l1.name AS section_name,
    l2.id AS subsection_id, L2.name AS subsection_name
FROM pages AS p
JOIN sections AS l2 ON (
    l2.id = p.section_id AND
    l2.parent_id <> 0
)
JOIN section AS l1 ON (
    l1.id = l2.parent_id
)
WHERE active = 1

UNION

-- pages related to a level-1 section
SELECT
    p.id, p.section_id, p.name,
    l1.id AS section_id, l1.name AS section_name,
    NULL, NULL -- do not join with sub-sections, so as to avoid duplicates
JOIN sections AS p_ss ON (
    p_ss.id = p.section_id AND
    p_ss.parent_id = 0
)
WHERE active = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T18:35:50.673

这会很长:(

请注意，我最终没有使用这种方法，因为它的性能比我最初使用 GROUP BY 的尝试更差

我不得不修改 PAGES 表的数据表设计，以包含一个新列来保存页面所属的小节的 id，因此现在 PAGES 表具有指示其所属节的列，以及小节。该结构修改仅用于测试，我没有在最终版本中使用它。

这是我使用两个查询之间的 UNION 概念创建的查询。

```
SELECT
* 
FROM
  pages AS p
JOIN
-- create derived table of sections and subsections
  ( -- separate query to get sections (parent id = 0 )
    SELECT 
        s.id AS page_sec_id,
        s.id AS sec_id,
        s.name AS sec_name,
        NULL AS subsec_id,
        NULL AS subsec_name,
        s.parent_id AS parent_id
    FROM
        sections AS s
    WHERE
        s.parent_id = 0
   UNION
    -- separate query to get subsection (parent id != 0)
    SELECT
        ss.id AS page_sec_id,
        ss.parent_id AS sec_id,
        -- need to get section name, so had to use weird subquery
        (SELECT name FROM sections WHERE parent_id =0 AND id = ss.parent_id) AS sec_name,
        ss.id AS subsec_id,
        ss.name AS subsec_name,
        ss.parent_id AS parent_id
    FROM
        sections AS ss
    WHERE
        ss.parent_id != 0
   )  AS sss

ON
    -- specify how PAGES table is joined to this derived table of sections and subsections

    -- pages linked to sections only
        ( p.section_id = sss.sec_id AND p.subsection_id = 0 AND sss.parent_id = 0)
        OR
    -- pages linked to subsections only
        ( p.section_id = sss.sec_id AND p.subsection_id = sss.subsec_id ) 
```

此 UNION 查询使用 **0.0388 秒** 来处理 5 行 Pages 和 4 行部分/子部分，而原始查询使用 **0.0017 seconds**，所以我在我的问题中坚持使用原始查询。顺便说一句，在我的开发环境中，mysql 在 P3 Katmai 450 Mhz 256 RAM 上运行，以迫使我编写高效的查询:)

感谢您的阅读，如果您有其他想法和意见，请添加它们。

# c# - 尝试提取方法时 Visual Studio 2008 停止响应

> ID：13150107
> 
> 赞同：0
> 
> 时间：2012-10-31T01:38:54.747
> 
> 标签：c#, winforms, visual-studio-2008

每次我尝试在 Visual Studio 2008 中提取方法时，IDE 都会停止响应并最终崩溃。崩溃时我没有收到错误消息，但事件日志中的错误如下。其他人有过这个问题吗？我之前已经重构和提取方法没有问题。我的系统上最近没有安装任何东西。我还尝试重新启动 Visual Studio 并重新启动我的机器但没有成功。

```
The description for Event ID 0 from source devenv cannot be found. Either the component that raises this event is not installed on your local computer or the installation is corrupted. You can install or repair the component on the local computer.

If the event originated on another computer, the display information had to be saved with the event.

The following information was included with the event: 

The data source '{130bada6-e128-423c-9d07-02e4734d45d4}' specifies no supporting providers or a set that are not registered.

the message resource is present but the message is not found in the string/message table 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T13:28:43.920

经过几个小时的尝试，包括修复安装 VS 2008，它最终成为我试图重构为方法的代码中的一个断点。有一次，我删除了代码重构（即提取到方法）的断点，没有问题。

# android - 在哪里保存 POS 应用程序的图像

> ID：13150112
> 
> 赞同：0
> 
> 时间：2012-10-31T01:40:18.110
> 
> 标签：android

我是一名安卓新手，正在为 10 英寸安卓平板电脑开发一个 POS 系统。产品的图像 (150 x 150) 及其名称显示在 10 列网格视图中。将有大约 1200 张图像，用户可以添加更多带有图像的产品。产品根据用户从列表视图中选择的产品类别显示。产品和产品类别详细信息保存在 SQLite 数据库中。

我想知道在哪里保存这些图像。我可以将它们保存在 SD 卡上吗？还是在 SQKite 数据库本身？还是我需要网络服务从服务器中提取图像？如果我将它们保存在 SD 卡上，是否需要异步任务来加载所选产品？

请指教。

谢谢并恭祝安康。

苏迪尔·帕拉帕兰比尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T01:53:05.270

POS 通常可以与多个设备一起使用，因此您需要一个中央数据源。该源的延迟和您的用户速度要求决定了您需要如何构建它。我已经将实时图像用于低延迟或可以接受慢速图片填充的 UI。POS 通常安装在专用的网络上，因此对实时性很好。

如果您设想 SaaS 多租户解决方案，那么您可能需要通过后台进程缓存图片 - 取决于图片的来源和加载速度。1200 张 150x150 的图像真的不是那么多/那么多的空间。您可以轻松地将它们存储到 'droid 上的本地文件系统中，并且 SD 卡可以正常工作。

本着敏捷的精神，你可能想先使用最简单的解决方案——实时显示。然后可能会在必要时添加缓存。如果您的用户需要，请担心异步后台加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:56:01.290

您最好的选择是从服务器在后台异步加载它们。因为它是一个 POS 系统，所以必须连接互联网，所以最好将图像保存在服务器上然后抓取它们。我个人不喜欢在我的手机上存储大量图像并占用空间的应用程序。

但缺点是由于图像数量很大，加载可能需要一段时间。您将需要根据什么是可接受的和什么是不可接受的来决定

# mod-rewrite - 将 ReSRC.it htaccess 覆盖到 Nginx conf

> ID：13150115
> 
> 赞同：1
> 
> 时间：2012-10-31T01:40:50.330
> 
> 标签：mod-rewrite, url-rewriting, nginx

我试图将下面的代码从 Apache htaccess 转换为 Nginx conf，以允许 ReSrc.it 自动重写 html 图像源。[此处](http://www.resrc.it/docs/)提供了文档链接。这是我试图转换的代码。

```
RewriteCond {%QUERY_STRING} ^.*resrc=0
RewriteRule /img/([^/]+) /img/$1 [L]
RewriteRule /img/([^/]+) http://app.resrc.it//www.your-domain.com/img/$1 [L] 
```

提前感谢您的任何帮助。

# ios - 我什么时候应该构建带有 armv7s 支持的应用程序？

> ID：13150116
> 
> 赞同：10
> 
> 时间：2012-10-31T01:40:51.903
> 
> 标签：ios, armv7

今天，当我尝试将我的应用（更新）提交到应用商店时，组织者告诉我：

“iPhone/iPod Touch：应用程序可执行文件包含不受支持的架构：armv7s”

我清楚地记得它的最后一个版本是同时设置了armv7和armv7s并成功提交的，但是现在Organizer改变了主意？

删除 armv7s 标志很简单，但我的应用程序是通用的，删除 armv7s 的应用程序会在所有 iOS 设备（例如 iPhone 5）上运行吗？我什么时候应该用 aremv7s 构建？

谢谢你。

编辑：这里的 xcode 版本首先是 4.5，然后我尝试了 4.5.1

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-31T06:31:29.110

在商店更新我的应用程序时遇到了同样的问题，我清楚地记得提交应用程序的最后一个版本时，它同时具有 armv7 和 armv7s 架构，部署目标 OS 4.3。今天更新同一个应用程序时出现错误。

最后，我尝试使用 Application Loader 上传二进制文件并成功上传到商店，因此在使用 Organizer 提交时，Apple 可能最近进行了一些验证。

使用 Application Loader Goto Organizer > 右键单击​​ Archive > Reveal in Finder 上传二进制文件。右键单击存档文件 > 显示存档内容

转到产品 > 应用程序 > [您的 APP.app]

压缩 [Your APP.app] 并使用 Application Loader 上传。

希望这可以帮助 ：）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-31T03:26:06.527

最新的 Xcode 可以使用 armv7 和/或 armv7s 代码构建可执行文件。在 iPhone 3G（不包括 3G）之后和 iPad 4、iPhone 5 之前（但不包括）生产的所有设备都需要 armv7 代码；iPad 4 和 iPhone 5 可以运行 armv7 代码，也可以运行 armv7s 代码。较旧的 iPhone 只能运行 armv6 代码。

您已经在构建 armv7 代码。您应该继续这样做，并在您可以在 armv7s 设备上充分测试您的代码时尽快*构建armv7s 代码。*但是，如果您无法在 armv7s 设备上进行测试，您可以只发布 armv7 代码。

您的错误消息让我想知道您是否运行了不支持 armv7s 的旧版 Xcode。armv7s 仅受 Xcode 4.5 支持。

另一方面，Xcode 4.5 放弃了对 armv6 的支持。您可以选择支持较旧的 CPU 或较新的 CPU，但不能同时支持两者。

最后一点：要支持 16:9 分辨率（iPhone 5 屏幕），您需要使用 Xcode 4.5。这不是技术要求，但 Apple 仍在通过政策强制执行。

# java - 使用 JSCH 设置目录权限 CHMOD

> ID：13150122
> 
> 赞同：5
> 
> 时间：2012-10-31T01:42:21.187
> 
> 标签：java, jsch

在 Unix 中，如何使用 JSCH 设置目录权限？我想做drwxrwxrwx。Filezilla 说整数是 775，但 JSCH 没有正确设置权限。在 JSCH 设置权限后，Filezilla 说它是 407。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-07-16T11:22:31.773

这对我有用：

```
sftp.chmod(Integer.parseInt(permissionStringInDecimal,8), str_Directory+fileName); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-31T04:42:59.620

Unix 中的文件权限代码（`777`例如 ）是八进制的，而不是十进制的。如：当你做类似`chmod -R 777`的事情时，数字被解释为八进制输入而不是十进制输入。

该系统来自于有 3 个权限组的事实：

*   所有者
*   团体
*   世界

每个组都有一个“开/关位”：

*   读
*   写
*   执行

所以八进制足以代表一个组的所有可能的权限配置。3 个八进制数字分别对应一个权限组。

（进一步阅读： http: [//www.december.com/unix/ref/chmod.html](http://www.december.com/unix/ref/chmod.html)）

回到 JSCH 的问题：十进制整数`775`的八进制表示是`0o1407`，我怀疑实际上发送的是十进制 775 而不是八进制 775，并且 FileZilla 很可能会截断第三个最低有效数字左侧的内容的`0o1407`（因为假设没有任何东西超过第三个最低有效位并不是不合理的）

现在，`509`是 octal 的十进制表示`775`，请尝试将其与 JSCH 一起使用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-09T10:11:38.790

这都是关于服务器配置的。[![在此处输入图像描述](../Images/3d6d3db314c2d9a1c24a296fcde5ccf2.png)](https://i.stack.imgur.com/O6fMA.png)

只需取消勾选覆盖时自动重命名现有文件

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-10-13T21:43:31.957

这是一个简短而完整的示例，说明如何使用通常的方式来描述 CHMOD 权限，从而轻松地使用 Jsch 更改 chmod

==================================================== ======= 简短回答： int chmodInt = Integer.parseInt(chmod, 8); 通道.chmod（chmodInt，fileLinux）；

==================================================== ======= 完整示例：

```
package example;

import java.io.IOException;
import java.util.Date;

import main.services.ServiceSSH;

import org.junit.Test;

import com.jcraft.jsch.ChannelSftp;
import com.jcraft.jsch.JSchException;
import com.jcraft.jsch.Session;
import com.jcraft.jsch.SftpException;

public class ExampleChmod {

    @Test
    public void testchmod() throws JSchException, SftpException, IOException {
        Session session = ServiceSSH.getSession(); // Use your own session Factory
        Date dateStart = new Date();
        chmod("/home/user/launcher.sh", "777", session);
        Date dateEnd = new Date();
        session.disconnect();
        System.out.println(dateEnd.getTime() - dateStart.getTime() + "ms");
    }

    public static void chmod(String fileLinux, String chmod, Session session) throws JSchException, SftpException {
        ChannelSftp channel = (ChannelSftp) session.openChannel("sftp");
        channel.connect();
        chmod(fileLinux, chmod, channel);
        channel.disconnect();

    }

    private static void chmod(String fileLinux, String chmod, ChannelSftp channel) throws SftpException {
        int chmodInt = Integer.parseInt(chmod, 8);
        channel.chmod(chmodInt, fileLinux);
    }
} 
```

# java - 如何将字符串的索引作为 int 获取？

> ID：13150123
> 
> 赞同：0
> 
> 时间：2012-10-31T01:43:10.623
> 
> 标签：java, string

我创建一个整数，我必须向后打印出这些值。所以如果我的号码是 12345，它必须打印：

```
5
4
3
2
1 
```

这些数字必须在单独的行上：

```
System.out.println(number.nextDigit()); 
```

每个都有一个`nextDigit();`从最后一个数字返回下一个数字的方法，它必须返回一个整数，而不是字符或字符串。

有什么帮助吗？

这是我的代码： http: [//pastebin.com/xrpKZixE](http://pastebin.com/xrpKZixE)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T01:45:45.647

与可能包含多个字符的字符串不同，`int`s 表示单个数字。

用 s 解决这个问题的诀窍`int`是应用`%`和`/`运算符：通过取`num % 10`，你得到最后一个数字；通过取`num / 10`，你砍掉最后一个数字。

```
while (num != 0) {
    int lastDigit = num % 10;
    num /= 10;
    System.out.println(lastDigit);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T01:46:31.177

可能最容易转换为字符串，然后从那里开始：

```
String digits = String.valueOf(number);
char thirdDigit = digits.charAt(2);
int thirdDigitAsNumber = Integer.parseInt(digits.substring(2,3)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T02:11:06.827

上面的答案很好。如果我正确理解您的问题，您还可以使用递归方法从最后一位数字开始垂直打印您的数字，这是您可以使用的递归方法：

```
public static void writeVertical(int number)
{
if(number <10)
 System.out.println(number);
else
{
 System.out.println(number%10);
 writeVertical(number/10);
} 
```

}

# actionscript-3 - 从 3 天 AS3 陷入错误 #1009

> ID：13150125
> 
> 赞同：1
> 
> 时间：2012-10-31T01:43:26.003
> 
> 标签：actionscript-3

我正在尝试准备一个万用表。使用旋转代码我在我的舞台上移动针。然后当它达到一个值时，会显示一个显示。现在我有各种不同的电阻值。所以当我点击一个特定的电阻值时，它最初只显示电阻，当针旋转时，电阻和值应该一起显示。我尝试运行此代码，但收到错误 #1009：

```
import flash.events.MouseEvent;

stop();

Resistance.addEventListener(MouseEvent.MOUSE_DOWN, ResistanceMenu);
btn100Ohm.addEventListener(MouseEvent.CLICK, Ohm100Show);
function Ohm100Show(e:MouseEvent):void
{
    gotoAndPlay(15);
}

stage.addEventListener(MouseEvent.MOUSE_DOWN, mouseDownOK);
stage.addEventListener(MouseEvent.MOUSE_UP, mouseUpOK);

function ResistanceMenu(e:MouseEvent):void
{
    gotoAndPlay(10);
}

function mouseDownOK (e:MouseEvent):void
{
    stage.addEventListener(MouseEvent.MOUSE_MOVE, rotateOK);
}

function rotateOK (e:MouseEvent):void
{
    var angle:Number = Math.atan2(mouseY - needle.y, mouseX - needle.x);
    angle = angle * 180/Math.PI-90;
    needle.rotation = angle;

    Ohm_200.addEventListener(MouseEvent.MOUSE_OVER, Ohm_200Call);
    function Ohm_200Call (e:MouseEvent):void
    {
        gotoAndPlay(20);
    }
}

function mouseUpOK (e:MouseEvent):void
{
    stage.removeEventListener(MouseEvent.MOUSE_MOVE, rotateOK);
} 
```

旋转部分运行正常。但是当我为 btn100Ohm 添加监听器时，我收到错误 #1009

请帮助我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:09:14.547

来自 ActionScript 3 文档（[运行时错误](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/runtimeErrors.html)）：

> ### #1009 - *null 没有属性。*
> 
> 计算结果为 null 的对象可以没有属性。在某些意外（尽管有效）的情况下，可能会发生此错误。例如，考虑下面的代码，它创建了一个 Sprite 对象。由于此 Sprite 对象从未添加到显示列表中（通过*`addChild()`* DisplayObjectContainer 对象的方法），因此其*`stage`*属性设置为 null，因此，其*`stage`*属性不能具有任何属性。所以代码生成错误：
> 
> `import flash.display.Sprite;`
> `var sprite1:Sprite = new Sprite();`
> `var q:String = sprite1.stage.quality;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:56:18.047

您可能在创建按钮 (btn100Ohm) 之前尝试访问它。我不知道您如何（或在哪里）拥有您的代码和按钮，但错误 1009 表示该按钮尚不存在。

# math - 计算二维图像中到三角形/正方形的距离

> ID：13150126
> 
> 赞同：0
> 
> 时间：2012-10-31T01:43:30.607
> 
> 标签：math, 2d, coordinates, distance, projection

我正在编写一个跟踪目标的机器人，目前我正在使用一个可以跟踪多达四个单独 LED 点的传感器。这些点作为像素网格内的二维位置给出。

我想知道是否可以计算从传感器到信标的距离，如果它们以已知比例的三角形或正方形排列。显然，如果我死死面对它很容易，但目标会移动并可能旋转，这会扭曲排列的感知形状。

可能这可以通过“校正”形状，然后根据其大小计算出距离来完成？

编辑：这里是澄清。假设我有一个 iPad 靠在房间另一端的墙上。我给这个 iPad 拍了张照片，然后，我测量了图像中 iPad 的宽度，以确定 iPad 离相机有多远。这很容易做到，因为我知道 iPad 的实际宽度并且可以使用比例。

但是，假设 iPad 转了一个角度，或者平放在地板上。然后，在图像中测量 iPad 的宽度就不是那么容易了，因为它的形状是倾斜的。但是，既然我知道 iPad 的形状“应该”是什么，是否仍然可以计算出距离？

# android - 无需重启设备即可更新 Android 应用程序

> ID：13150127
> 
> 赞同：0
> 
> 时间：2012-10-31T01:43:37.843
> 
> 标签：android, updates, maintenance

我有一个在专用 android 设备上 24/7 运行的应用程序。该应用程序在 Google Play 中配置为自动更新。该应用程序下载和安装没有任何问题。

我想弄清楚的部分是：该应用程序需要识别 Google Play 下载并安装了一个更新，随后应该停止并重新启动。

可能的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:03:22.977

毫无意义，因为您安装的（旧）应用程序被更新的应用程序替换，这也意味着旧的应用程序首先被杀死，然后被覆盖。如果您需要知道自己是“新”用户，请让每个应用程序（即存储其版本代码）。在启动时检查存储的 versionCode 与包 versionCode 并采取相应的行动

# python - 我收到 TypeError: int object not callable

> ID：13150129
> 
> 赞同：1
> 
> 时间：2012-10-31T01:44:28.050
> 
> 标签：python, shell

所以，我在做一个角色扮演游戏，我在做一个地图功能。错误出现在脚本顶部名为 map1 的 def 中。请停下来！另外，无论您有什么解决方案，请您解释一下它的作用，我是新人。

```
weap = 0
fate = 0
gold = 100

#---------------------------------------------------------------------------------
def map1(dellon, forrest, fate):
    print(dellon)
    print("MAP")
    print("---------------------------------------------------------------------------------")
    print("type one of the following numbers, then press enter.")
    if dellon == 1:
        print("\n(1) Dellon")
    if forrest == 1:
        print("(2) Darkwood Forrest")
    if fate == 1:
        print("(3) Fate")
    choice = float(input())
    if choice == 1:
        dellon(0)
    elif choice == 2:
        forrest()
    elif choice == 3:
        fate()
#---------------------------------------------------------------------------------
def forrest():
    print("What do you chose to do:")
    print("(1) Go North\n(2) Go South\n(3) Go East\n(4) Go West\n(5) Go hunting")
    choice = input()
    if choice == 1:
        print("You find Donna picking berries, do you wish to talk to her?")
        print("(1) Yes\n(2) No")
        talk = input()
        if talk == 1:
            pass
        elif talk == 2:
            forrest()
    elif choice == 2:
        Fate()
        fate = 1
    elif choice == 5:
        from random import randint
        hunt = randint(1,3)
        if hunt == 1:
            animal = randint(1,5)
            if animal == 1:
                print("You where ambushed by a wild bear.")
                input()
            elif animal == 2:
                print("You have been ambushed by a wild wolf.")
                input()
            elif animal == 3:
                print("You have been ambushed by a wild bobcat.")
                input()
            elif animal == 4:
                print("You have been ambushed by a wild cyote.")
            elif animal == 5:
                pass
                input()
#---------------------------------------------------------------------------------
def kingsquestdone(gold, dellon, forrest, fate):
    print("KING: I see you have the potions, good work!")
    print("Give them to me, and I will have")
    print("before you leave, here is your pay.  I'll give")
    print("my servant deliver them to the hospital.  And I will give")
    print("you 300 gold for your troubles.")
    gold = gold + 300
    print("Your current gold is "+ str(gold) +".")
    choice = float(input("(1) Go into Dellon\n(2) Map: "))
    if choice == 2:
        map1(dellon, forrest, fate)
    elif choice == 1:
        indellon(1)
#---------------------------------------------------------------------------------
def lockfail():
    print("You have failed to pick the lock.")
    game0()

#---------------------------------------------------------------------------------
def king(name):
    print("KING: Hello "+ name +", I requested your presence because")
    print("we, the people of Dellon, need your help.")
    print("We need you to seek out a berry called")
    print("a jutish berry.  It is for the public hospital, they need")
    print("it to make healing remidies for the sick, and injured.")
    print("--------------------------------------------------------------")
    print("What do you want to say:")
    print("1: Ok, I'll help.\n2: Maybe later.")
    choice = float(input())
    if choice == 1:
        print("KING: Good, the berry is found Darkwood Forrest.  A woman named Donna.")
        print("She has much exxperience in picking these berries, talk to")
        print("her to learn how, and where to pick them.  After you pick")
        print("three bushes, return to me, and I will give you your pay.")
        input("Press enter to continue into Darkwood Forrest.")
        dforrestent()
#---------------------------------------------------------------------------------
def allberriespicked():
    print("-----------------------------------------------------------------")
    print("\nDONNA: Good, you have collected all of the needed berries.")
    print("I'll take those, and make them into the potions that you need.")
    print("You can return here any time you want to pick some berries")
    print("for me to earn some extra coin.  Return to the King, and deliver")
    print("those berries to him.")
    input("\nPress enter to travel to the king.")
    kingsquestdone(gold)

#---------------------------------------------------------------------------------
def dforrestent():
    def jutish4():
        from random import randint
        berry = randint(1, 2)
        if berry == 1:
            print("---------------------------------------------------------------------")
            print("\nYou have picked one jutish berry bush.")
            input("Press enter to return to Donna.")
            allberriespicked()
        elif berry == 2:
            print("---------------------------------------------------------------------")
            print("\nYou didn'd find the correct bush this time, try again.")
            input("Press enter to continue looking.")
            jutish4()
    def jutish3():
        from random import randint
        berry = randint(1,2)
        if berry == 1:
            print("---------------------------------------------------------------------")
            print("\nYou have picked one jutish berry bush.")
            input("Press enter to continue picking the berries.")
            jutish4()
        elif berry == 2:
            print("\nYou didn'd find the correct bush this time, try again.")
            input("Press enter to continue looking.")
            jutish3()
    def jutish2():
        from random import randint
        berry = randint(1, 2)
        if berry == 1:
            print("---------------------------------------------------------------------")
            print("\nYou have picked one jutish berry bush.")
            input("Press enter to continue picking the berries.")
            jutish3()
        elif berry == 2:
            print("\nYou didn'd find the correct bush this time, try again.")
            input("Press enter to continue looking.")
            jutish2()

    def jutish1():
        print("You enter a field type area with many different types of bushes.")
        input("\nPress enter to look for more jutish berry bushes.")
        from random import randint
        berry = randint(1, 2)
        if berry == 1:
            print("\nYou have picked one jutish berry bush.")
            input("Press enter to continue picking the berries.")
            jutish2()
        elif berry == 2:
            print("\nYou didn'd find the correct bush this time, try again.")
            input("Press enter to look again.")
            jutish1()
    forrest = 1
    print("you have entered the forrest.  You must search")
    print("for Donna as the King has mentioned.")
    print("")
    print("1: Go West\n2: Go North\n3: Go East\n4: Go South")
    choice = float(input("Enter a number to travel in that direction: "))
    if choice == 1:
        print("You end up walking for hours, and never find Donna.")
        print("You end up back at the enterance to Darkwood Forrest.")
    elif choice == 2:
        print("You find Donna, and speak to her.")
        print("\nDONNA: Hello traveler, you must be the one")
        print("delivering the jutish berries for the Dellon hospital.")
        print("To find these berries, you must go to the enterance of the")
        print("forrest, and then travel East, then you will find a")
        print("short, and prickly bush with bright red berries, those are")
        print("the jutish berries you are looking for.  Pick berries from")
        print("four of the bushes, then return to me.")
        input("\nPress enter to continue.")
        jutish1()
#---------------------------------------------------------------------------------
def indellon(first):
    if first == 0:
        print("a man approaches you with a letter.")
        print("MAN:  Hello sir, what is your name?")
        name = input("Name: ")
        print("MAN: Ah, good to meet you, "+ name +", I have a")
        print("message for from the King himself.  He says that")
        print("he wishes to discuss something that will relieve")
        print("your bounty.  I suggest you talk to him imidiatly.")
        print("\nPress enter to conitinue.")
        first = 1
        input()
        king(name)
    elif first == 1:
        print("What do you want to do?")
        print("(1) Leave Dellon")
        print("(2) Go to shops")
        print("(3) Go to residential homes")
        print("(4) Go to the King's castle")
        print("(5) Map")
        choice = input()
        if choice == 1:
            dellonsign()
        elif choice == 2:
            dellonshops()
        elif choice == 3:
            dellonhomes()
        elif choice == 4:
            kingscastle()
        elif choice == 5:
            map1(dellon, forrest, fate)

#---------------------------------------------------------------------------------
def fight1(dellon):
    print("you decide to confront the gaurd.")
    en_hp = 10
    pl_hp = 10
    print("press (1) to attack")
    choice = float(input())
    if choice == 1:
        while True:
            if weap == 1:
                from random import randint
                en_damage = randint (1,8)
                pl_damage = randint (5,15)
            elif weap == 0:
                from random import randint
                en_damage = randint (1,8)
                pl_damage = randint (1,10)
            en_hp = en_hp - pl_damage
            pl_hp = pl_hp - en_damage
            print("enemy hp is now:")
            print(en_hp)
            print("your hp is now:")
            print(pl_hp)
            print("press enter to attack again.")
            input()
            if en_hp < 1:
                print("You win this battle, and continue onwards.")
                input("press enter to continue")
                dellon = 1
                dellon(0)
                break
            if pl_hp < 1:
                print("You died.")
                input("press enter to continue")
                fight1()
                break   

#---------------------------------------------------------------------------------
def dellon(dellong):
    if dellong == 1:
        print("as you approach Dellon's city gates, you see")
        print("a gaurd, do you want to try to sneak past him")
        print("or confront him?")
        print("(1) sneak past")
        print("(2) confront")
        choice = float(input())
        if choice == 1:
            from random import randint
            n = randint(1,2)
            if n == 1:
                print("you failed to sneak past the gaurd, and must")
                print("commenc battle.")
                fight1(0)
            elif n == 2:
                print("you have succesfully snuck past that gaurd and enter")
                print("the city.")
                dellon = 1
                input()
        elif choice == 2:
            fight1(dellon)
    elif dellong == 0:
        print("(1) enter Dellon")
        print("(2) map")
        choice1 = float(input())
        if choice1 == 1:
            indellon(0)
        elif choice1 == 2:
            map1(dellon, forrest, fate)
#---------------------------------------------------------------------------------
def freedome():
    print("as you step outside, you see two signs, one says")
    print("capitol city of Dellon, and the other says Red Bird Forrest.")
    print("which path do you wish to choose?")
    print("(1) Dellon")
    print("(2) Forrest")
    choice = float(input())
    if choice == 2:
        forrest()
    if choice == 1:
        dellong = 1
        dellon(1)
#---------------------------------------------------------------------------------
def fightwin():
    print("do you wish to search this body?  If you do, you may")
    print("run into more gaurds, if not, you won't get a better weapon.")
    print("(1) yes")
    print("(2) no")
    choice = float(input())
    if choice == 1:
        print("you find a long sword, and continue out the jail")
        print("doors and into freedome once more.")
        weap = 1
        freedome()
    elif choice == 2:
        print("you decide to ignore the body, and continue out the jail")
        print("doors and into freedome once more.")
        weap = 0
        freedome()
#---------------------------------------------------------------------------------
def fight():
    print("You have succesfully busted through the wall, and escaped your cell, but there's a gaurd on the other side!  What do you want to do?")
    en_hp = 10
    pl_hp = 10
    print("(1) attack")
    choice = float(input())
    if choice == 1:
        while True:
            from random import randint
            en_damage = randint(1,8)
            pl_damage = randint(1,10)
            en_hp = en_hp - en_damage
            pl_hp = pl_hp - pl_damage
            print("enemy hp is now:")
            print(en_hp)
            print("your hp is now:")
            print(pl_hp)
            print("press enter to attack again.")
            input()
            if en_hp < 1:
                print("You win this battle.")
                input("press enter to continue")
                fightwin()
                break
            if pl_hp < 1:
                print("You died.")
                input("press enter to continue")
                game0()
                break
#--------------------------------------------------------------------------------------
def lockgen():
    from random import randint
    number = randint(1,2)
    if number == 1:
        lfight()
    if number == 2:
        lockfail()
#--------------------------------------------------------------------------------------
def game0():
    print("You wake up very fatigued in a prison cell.")
    print("Your location is unkown, and you must break out.")
    print("Your only choice is to attempt to escape by digging your way")
    print("through the wall with a stone you have found.")
    print("-----------------------------------------------------")
    print("1: Dig through wall")
    prisonchoice = float(input())
    if prisonchoice == 1:
        fight()
    else:
        game0()
def gameover():
    input("Game Over.  Press enter to exit.")

print("")
print("welcome to THE role playing game.")
print("(1) Start game")
print("(2) Type in checkpoint key")
startchoice = float(input())
if startchoice == 2:
    print("Enter in the code.")
    code = float(input())
    if code == 123:
        dellon = 1
        forrest = 1
        fate = 0
        kingsquestdone(gold, dellon, forrest, fate)
elif startchoice == 1:
    game0() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:05:12.997

在您的函数中，您有以下语句：

```
if dellon == 1:
    print("\n(1) Dellon") 
```

这是检查是否`dellon`等于 1，因此我假设要查看是否`dellon`是整数（正如@Blender 所说，使用完整的回溯会更容易）。然后你这样做

```
if choice == 1:
    dellon(0) 
```

假设它`dellon`实际上是一个整数，您现在将它视为一个函数并将其`0`作为参数调用。你实际上有一个`dellon`可以用参数调用的函数，所以你可能需要看看你想要做什么`if dellon == 1:`。快速浏览一下程序的其余部分，您正在`dellon`以似乎是函数的形式传递，您不需要这样做，因为它不返回任何内容并且已经可用于其他函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:29:06.530

您遇到的问题是您正在使用函数中`dellon`的参数隐藏函数（在模块级别声明）`map1`。

这是函数声明：

```
def dellon(dellong):
    ... 
```

但是你不能从 访问它`map1`，因为有一个同名的参数。由于参数是函数中的局部变量，它“遮蔽”了外部函数定义，所以你不能得到它（至少，不容易）：

```
def map1(dellon, forrest, fate):
    ... 
```

`map1`异常会在您尝试调用函数的位置再往下一点触发，但取而代之的是获取参数（大概是一个整数）：

```
 if choice == 1:
        dellon(0) 
```

这应该很容易解决。只需重命名参数`map1`或`dellon`函数。

# java - Java，递归地反转数组

> ID：13150131
> 
> 赞同：13
> 
> 时间：2012-10-31T01:44:35.603
> 
> 标签：java, arrays, reverse, void

我还没有找到任何符合我的功能的特定需求来执行此操作，是的，它是用于家庭作业的。

所以我有：

```
public void reverseArray(int[] x) {

} 
```

前提条件：x.length > 0

我不能让函数返回任何东西，唯一的参数是一个数组，这一事实让我很困惑。

我尝试过使用循环和递归，但我尝试过的一切似乎都以生成函数的无限实例而告终。

我已经有了一个想法/建议来使用另一个函数和这个函数，但是，如何递归地使用原始函数目前超出了我的范围。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-31T02:07:54.243

```
void reverseArray(int[] x){
   reverse(x, 0, x.length -1);
}

void reverse(int[] x, int i, int j){
    if(i<j){//Swap
       int tmp = x[i];
       x[i] = x[j];
       x[j] = tmp;
       reverse(x, ++i, --j);//Recursive
    }   
} 
```

测试：

```
int[] s = new int[]{1,2,3,4,5};
reverseArray(s);
System.out.println(Arrays.toString(s));//"5,4,3,2,1" 
```

递归，O(n)，不需要临时数组。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-31T01:56:34.917

如果我对此进行编码，我将为递归调用创建一个临时数组（可能删除了一个元素？），并在从函数返回之前将元素复制回原始数组。您还需要找到一个基本案例来终止递归。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-10-31T02:15:02.857

因为这是你的作业，我建议一个例子：

给定序列：`1 2 3 4 5 6 7 8 9 10`

您可以更改为：`10 2 3 4 5 6 7 8 9 1`

在那之后：`10 9 3 4 5 6 7 8 2 1`

......

如您所见，一步一步，序列“更好”，问题“更小”。因此，您应该解决的问题是：

1) 如何对此方法应用递归调用。对于原文，方法是：`reverse(int[] a)`。所以，在第一步之后，你应该创建数组`b from a[2] --> a[n-1]`。并使用反向（int [] b）`。

2）在 reverse 之后`b`，我们应该怎么做才能反转 a ？再次将 b 的值赋回 a。

3）停止条件：什么停止条件？您会看到数组 b 的元素小于数组 a 的元素。那么，到哪一步，我们应该停下来？

希望这有帮助:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-19T22:02:26.363

```
public class RecursiveArray {

   public static int[] backWardArray(int[] arr, int start, int end) {

       if (start < end) {
           int temp = arr[start];
           arr[start] = arr[end];
           arr[end] = temp;
           backWardArray(arr, start + 1, end - 1);
       }
       return arr;
   }

    public static void main(String[] args) {
        int [] arr = {12,4,6,8,9,2,1,0};
    int [] reversedArray= backWardArray(arr, 0, arr.length-1);
    //loop through the reversed array
        for (int i: reversedArray) {
            System.out.println(i);
        }
    }

    public RecursiveArray() {
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-12-27T12:52:30.417

> 这里调用 reverseArray(0, n, arr) n 是数组的长度

```
public void reverseArray(int i, int n, int [] arr)
{
   if(i==n)
   {
     return ;
   } 
   else
   {
     reverseArray(i+1, n, arr);
     System.out.println(arr.at(i));
   }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-31T02:07:09.110

尝试如下：

```
public void reverseArray(int[] x) {
    if(x.length ==2){
      //if two elements, swap them
      int first = x[0];
      x[0] = x[1];
      x[1] = first;
    }else if(x.length > 2){
      //swap first and last
      int first = x[0];
      x[0]= x[x.length-1];
      x[x.length-1] = first;
      //create a copy of middle elements
      int [] copy = new int[x.length-2];
      System.arraycopy( x, 1, copy, 0, x.length-2);
      //recursive call for middle elements
      reverseArray(copy);
      //place the reversed elements back in the original array
      System.arraycopy( copy, 0, x, 1, copy.length);
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-12T17:47:24.303

//我们这里只是做一个操作，调用一个辅助方法。

```
public void reverseArray(int[] nums){
  int[] hold = new int[nums.length]; //just so it will take this argument
  int[] reversed = recurReverseArray(nums, hold, nums.length - 1, 0);
  nums = reversed; //not returning just changing nums to be reversed.
}
public int[] recurReverseArray(int[] nums, int[] reverse, int end, int start){
  if(end == 0 && start == nums.length - 1){
  reverse[start] = nums[end];
  return reverse; //the way out.
  }
  reverse[start] = nums[end];
  return recurReverseArray(nums, reverse, end - 1, start + 1);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-26T06:49:23.110

下面是主要方法：

```
package main;

public class Main {
    public static void main(String[] args) {
        StringOps ops = new StringOps();
        String string = "Arjun";
        // reversing the string recrusively
        System.out.println(ops.reverseRecursively(string.toCharArray(), 0));
    }
} 
```

这是递归函数：

```
package main;

public class StringOps {
    public char[] reverseRecursively(char[] array, int i) {
        char[] empty = new char[0];
        if (array.length < 1) {
            System.out.println("you entered empty string");
            return empty;
        }
        char temp;
        temp = array[i];
        array[i] = array[array.length - 1 - i];
        array[array.length - 1 - i] = temp;
        i++;

        if (i >= array.length - 1 - i) {
            return array;
        } else {
            reverseRecursively(array, i);
            return array;
        }

    }

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-09-26T22:32:09.027

这可能是最简单的方法，不是最快的，但可能是最简单的。

整个程序看起来像这样：

```
public static void main(String [] args)
{
    BackwardsArray back = new BackwardsArray();
}

public BackwardsArray()
{
    int [] a = {1,2,3,4,5,6,7,8,9};
    printBackwards(a);
}

void printBackwards( int [] b)
{
    print(b,b.length-1);
}

void print(int [] b, int pos)
{
    System.out.println(b[pos]); // prints last item
    if(pos != 0)
    {
        print(b,pos-1);
    }
} 
```

希望能帮助到你！

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-08-30T13:25:31.117

```
private static void reversePrint(int[] numbers)
{
    if(numbers.length==0) {
        return;
    }
    int[] a = new int[numbers.length -1];
    for(int i =0;i<numbers.length-1;i++) {
        a[i] = numbers[i+1];
    }
    reversePrint(a);
    System.out.println(numbers[0]+" ");

} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2016-10-13T21:18:58.900

```
public class FunWithAlgorthims {

public static void main(final String[] args) {

    String[] array = {"a", "b", "c", "d"};
    printArray(array);
    revereArrayRecusrive(array, 0);
    printArray(array);
}

public static void revereArrayRecusrive(final String[] array, int startPointer) {
    if (startPointer >= (array.length / 2)) {
        return;
    }
    String temp = array[startPointer];
    array[startPointer] = array[array.length - 1 - startPointer];
    array[array.length - 1 - startPointer] = temp;
    revereArrayRecusrive(array, ++startPointer);
}

public static void printArray(final String[] array) {
    Arrays.stream(array).forEach(a -> System.out.print(a + " "));
    System.out.println();
} 
```

}

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-10-31T02:25:41.977

由于没有声明不能使用循环：

```
void reverseArray(int[] x) {
    if (x != null) {
        for (int i = 0; i < length.x / 2; i++) {
            int j = (length.x - 1) - i;
            int temp = x[i];
            x[i] = x[j];
            x[j] = temp;
         }
         reverseArray(null);
     }
} 
```

可能是最快的。

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2012-10-31T01:51:58.560

伪代码

```
function revarray(a[1...n])
  if a.length == 1 or a.length == 0
    do nothing 
  # return a
  else
     swap a[1] and a[n]
     revarray(a[2...n-1])
  # return a (The function will not return anything but the contents of a are changed) 
```

# php - Yii：根据动态数字限制cgridview中cCheckboxColumn下的复选框选择

> ID：13150132
> 
> 赞同：1
> 
> 时间：2012-10-31T01:44:43.213
> 
> 标签：php, javascript, yii

我有一个带有允许复选框选择的 ccheckboxcolumn 的 cgridview。但是，我想限制一个人可以根据动态值选择的复选框的数量。

我研究了一下，这就是我所做的。但这似乎不起作用。任何人都可以帮忙吗？

我的代码如下：

**cgridview ccheckbox列：**

```
$this->widget('zii.widgets.grid.CGridView', array(
        'id'=>'v-grid',
        'dataProvider'=>$dataProvider,
        'summaryText'=>'',//remove display result count
        'columns'=>array(

            array(
                'id'=>'autoId',
                'class'=>'CCheckBoxColumn',
                'header'=>'',
                'selectableRows'=>'null', 
                'cssClassExpression'=>'$data->status=="accepted" ? "hidden" : ""', 
            ),
        ),
)); 
```

**cActiveForm的Ajax提交按钮：**

```
echo CHtml::ajaxSubmitButton('Submit',CHtml::normalizeUrl(array('default/viewV','render'=>false)),array('success'=>'js: function(data) {
        $("#view").dialog("open");
    }'),array('id'=>'submitButton')); 
```

**限制复选框选择的 Javascript：**

```
Yii::app()->clientScript->registerScript('restrictCbSelection','$("#submitButton").click(function() {

var checkboxCount=$("#v-grid").yiiGridView("getChecked","autoId");

if(checkboxCount.length>6) //will be changing 5 to a variable and that variable value will change dynamically
 {
     alert("Pls select only 6 items or less");
     return false;
 }

else console.log(checkboxCount);

});'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:44:53.057

yii 框架不提供您需要的控制方式，但您可以使用网格上的一些 javascript 进行控制。

以这种方式测试：

1.  禁用全选行，在 yii 1.10 中您需要使用 javascript 执行此操作，但在 yii 1.11 中您可以使用 CCheckBoxColumn 类中的 headerTemplate
2.  控制ajax更新，和第1步类似，如果使用yii 1.11，避免这一步
3.  控制selectionChange，很多javascript...

## 步骤1

```
Yii::app()->clientScript->registerScript('restrictCbSelection','
    $(document).ready(function(){
        $("#pais-grid .select-on-check-all").attr("disabled", true).attr("keys", "");
});'); 
```

## 第2步

在 CGridView 上

```
 'afterAjaxUpdate'=>'js:function(id){
        $("#pais-grid .select-on-check-all").attr("disabled", true).attr("keys", "");
    }', 
```

## 第 3 步

```
$this->widget('zii.widgets.grid.CGridView', array(
    'id'=>'pais-grid',
    'dataProvider'=>$dataProvider,
    'selectableRows'=>2, //<-- this means multiselect
    'afterAjaxUpdate'=>'js:function(id){
        $("#pais-grid .select-on-check-all").attr("disabled", true).attr("keys", "");
    }',
'selectionChanged'=>'js:function(id){
    var keys = $("#pais-grid .select-on-check-all").attr("keys");
    var sels = $("#" + id).yiiGridView("getSelection")
    var ext = $(sels).not(keys.split(","))
    if( $("#"+id+" :checked").size() <= 3 )  //<-- this is your variable number, you can use javascript value
        $("#pais-grid .select-on-check-all").attr("keys", sels.join(","));
    else
        $("#pais-grid .select-on-check[value="+ext[0]+"]").click().prop("checked",false);
    //your code here, if you need more.
}',
'columns'=>array(
    array(
        'class'=>'CCheckBoxColumn',
        'selectableRows'=>null, 
    ),
    'id',
    'nombre',
    'codigo',
),
)); 
```

这项工作对我来说......很好，在谷歌浏览器上测试过，原谅我的英语，我的母语是西班牙语

# css - Sencha Touch 2 圆形面板：CSS newb

> ID：13150134
> 
> 赞同：1
> 
> 时间：2012-10-31T01:44:52.713
> 
> 标签：css, sencha-touch-2, panel, rounded-corners

我对 CSS 非常满意。事实上，我并没有真正理解这些概念，即使在阅读了 3 本书之后。我在这里想要实现的是使用 Sencha Touch 2.0.1 创建一些圆角面板。我有一个 Ext.Panel。我给它一个“PanelBio”的类名，如下所示：

```
Ext.create('Ext.Panel', {
    id: 'panelBio02',
    styleHtmlContent: true,
    centered:true,
    cls: 'PanelBio',

    html: [
        '<h1>Lorem epsum.....</h1>'
    ].join("")
}) 
```

到目前为止一切顺利......然后，我在 SASS 文件中有一个类定义：

```
.PanelBio {
    -webkit-border-radius: 3em !important;
    border-radius: 3em !important;
    background-color: #333333;
    opacity: 0.8;
} 
```

然而，当我运行代码时，它只是不工作。它嵌入了几层。首先是一个带有 Carousel 的面板，然后一个项目是包含该面板的面板。因此，当我在 Chrome 开发工具中检查元素时，我会得到如下信息：

```
<div class="x-container x-panel PanelBio x-floating" id="panelBio02" style="z-index: 4 !important; ">        
    <div class="x-inner x-panel-inner" id="ext-element-10">
        <div class="x-innerhtml  x-html" id="ext-element-12">
            <h1>Lorem epsum.....</h1>
        </div>
    </div>
    <div class="x-anchor" style="display: none; " id="ext-element-11">
    </div>
</div> 
```

谁能解释一下我该怎么做才能完成这项工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T18:24:10.900

如您所知，问题出在 Sencha Touch 文件的“配置”中。代替

```
cls: 'PanelBio', 
```

我不得不使用

```
baseCls: 'PanelBio', 
```

不幸的是，我无法真正解释为什么会这样，但它似乎覆盖了 Sencha 默认为所有 Ext.Panel 对象生成的类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T01:48:38.280

您可以尝试将其添加到 css 中的 PanelBio 类中：

```
overflow: hidden; 
```

如果这没有帮助，请将应用于元素的 css 类附加到您的帖子中，以便我们查看。

# javascript - 为什么我的 jquery 脚本没有显示正确的分数？

> ID：13150141
> 
> 赞同：0
> 
> 时间：2012-10-31T01:46:03.123
> 
> 标签：javascript, jquery

我正在使用 jQuery Raty，我有以下脚本：

```
<script type="text/javascript" charset="utf-8" src="{{ STATIC_URL }}js/raty/js/jquery.raty.min.js"></script>
<script type ="text/javascript"> 
(function($) {
    $(function() {
        $('.yourrating').each(function(index,elem){
            $(elem).raty({
                readOnly:  false,
                path: "{{ STATIC_URL }}js/raty/img/",
                score: $(elem).children("span:first").text(),
                click: function(score, evt) {
                    var vote_url = "/spice/rate/" + this.id.substring(2) + "/" + score + "/";
                    $.ajax({
                        url: vote_url,
                        success: function(){
                            alert('vote successful');
                        }
                    });
                }
            });
            $('.thingrating').raty({
                readOnly: true,
                path: "{{ STATIC_URL }}js/raty/img/",
                score: $(elem).children("span:first").text(),
            });
        });
    });
})(jQuery);
</script> 
```

第一个脚本`yourrating`正在运行，并允许人们对项目进行评分。它的实现如下：

`<div class="yourrating" id="t_{{ item.id }}"><span style="display:none;">{{score}}</span></div>`

第二个脚本`thingrating`不起作用。它应该显示模型的当前分数。它在模板中实现如下：

`<div class="thingrating" id="t_{{ item.id }}"><span style="display:none;">{{score}}</span></div>`

为什么第二个脚本不起作用？它显示星星，但不显示分数。`4`如果我用硬编码而不是那样对分数进行硬编码`{{score}}`也没有效果 - 星星保持空白。

这是我浏览器中的实时代码：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr"
xml:lang="en-us" lang="en-us">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>

Welcomes         

component Description 

    </title>

        <!--[if IE]>
            <style>
                div { zoom: 1; /* trigger hasLayout */ }
            </style>
            <![endif]-->
            <link rel="stylesheet" href="/site_media/static/pinax/css/reset.css" />
            <link rel="stylesheet" href="/site_media/static/pinax/css/bootstrap/less/bootstrap.css" />
            <!--Scripts -->
            <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
            <script type="text/javascript">
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='/site_media/static/js/jquery-1.7.2.min.js' type='text/javascript'%3E%3C/script%3E"));
            }
            </script>
            <script src="/site_media/static/pinax/js/base.js" type="text/javascript"></script>
            <script src="/site_media/static/uni_form/uni-form.jquery.js" type="text/javascript"></script>
            <script type="text/javascript" src="/site_media/static/js/bootstrap.js"></script>

<link rel="stylesheet" href="/site_media/static/pinax/css/comments.css" />

<link href='http://fonts.googleapis.com/css?family=Ubuntu+Condensed' rel='stylesheet'
type='text/css'>

<!-- <link rel="stylesheet" href="/site_media/static/css/reset_tabs.css"
/>
<link rel="stylesheet" href="/site_media/static/css/site_tabs.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/avatar.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/base.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/blogs.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/friends.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/groups.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/locations.css"
/>
<link rel="stylesheet" href="/site_media/static/pinax/css/nav.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/messages.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/microblogging.css"
/>
<link rel="stylesheet" href="/site_media/static/pinax/css/pagination.css"
/>
<link rel="stylesheet" href="/site_media/static/pinax/css/photos.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/tabs.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/topics.css" />
<link rel="stylesheet" href="/site_media/static/pinax/css/wiki.css" />
<link rel="stylesheet" href="/site_media/static/bookmarks/css/bookmarks.css"
/>
<link rel="stylesheet" href="/site_media/static/spices/css/spices.css"
/>
--> 

    </head>

<body class="">
        <div id="wrapper">
            <div class="navbar">
                <div class="navbar-inner">
                    <div class="container" style="width: auto;">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/"><img src="/site_media/static/pinax/images/logo_small_55.png " alt="book" width="173.4" height="46.75" /></a>

                        <div class="nav-collapse">

<ul class="nav"><li id="tab_profile"><a href="/profiles/profile/admin/">PROFILE</a></li><li id="tab_product_library"><a href="/spices/">PRODUCT DATA</a></li><li id="tab_product_library"><a href="/spices/book_library">book LIBRARY</a></li><li class="dropdown pull-right" id = "community"><a class="dropdown-toggle" href="#">COMMUNITY</a><ul class="dropdown-menu"><li><a href="/profiles">Search </a></li><li><a href="/questions/">Questions and Answers</a></li><li><a href="/spices/view_requests/"> Requests</a></li><li><a href="/">Latest Updates</a></li></ul></li></ul> 

<ul class="nav pull-right">

    <li class="dropdown pull-right">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
            <span class="badge badge-warning">(2)</span>
        </a>
        <ul class="dropdown-menu">
            <li><a href="/notices/">All notifications</a></li>
            <li class="divider"></li>
            <li><a href="/messages/inbox/">Messages</a></li>
            <li class="divider"></li>
            <li><a href="/invitations/">Invitations</a></li>

        </ul>
    </li>
    <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">

             <!--<b>
                admin
            </b> -->
            <img src="/site_media/static/pinax/images/icons/gear.png" width = "20" height = "20" alt="" />

            <b class="caret"></b>
        </a>
        <ul class="dropdown-menu">

            <li><a href="/profiles/edit">Edit Profile</a></li>
            <li><a href="/spices/your_components">Manage Parts</a></li>
            <li>
                <a href="/account/email/">Account</a>
            </li>

            <li><a href="/admin/">Admin</a></li>

            <li class="divider"></li>
            <li><a href="/account/logout/">Logout</a></li>

        </ul>
    </li>
</ul>

                            <form class="navbar-search pull-right" value = "" action="/search/?q=">
                                <input type="text" class="search-query span2" name = "q" placeholder="Search">
                                <i class="icon-search icon-white" onclick=""></i>
                                &nbsp;&nbsp;&nbsp;
                            </form>
                        </div>
                        <!-- /.nav-collapse -->
                    </div>
                </div>
                <!-- /navbar-inner -->
            </div>
            <div class="container-fluid ">

                    <div id="left_tabs"></div>
                    <div id="right_tabs" ></div> 

                    <div id="body">

                    <div class=" row-fluid" id="subnav-outer">
                        <div class="pull-right" id="subnav-inner">

                        </div>
                    </div>

<script type="text/javascript" charset="utf-8" src="/site_media/static/js/raty/js/jquery.raty.min.js"></script>
<script type ="text/javascript"> 
(function($) {
    $(function() {
        $('.yourrating').each(function(index,elem){
            $(elem).raty({
                readOnly:  false,
                path: "/site_media/static/js/raty/img/",
                score: $(elem).children("span:first").text(),
                click: function(score, evt) {
                    var vote_url = "/spices/rate/" + this.id.substring(2) + "/" + score + "/";
                    $.ajax({
                        url: vote_url,
                        success: function(){
                            alert('vote successful');
                        }
                    });
                }
            });
            $('.thingrating').raty({
                readOnly: true,
                path: "/site_media/static/js/raty/img/",
                score: $(elem).children("span:first").text(),
            });
        });
    });
})(jQuery);
</script>

<div class="row-fluid">
    <!-- component image -->
    <div class="span2">
        <div class="row-fluid align-center">
            <img src="/site_media/static/pinax/images/library_placeholders/component.png">
            <br><br>
            <!-- Future CODE <div class="coverart"><img src=/site_media/media/ /></div>-->
        </div>
    </div>
    <div class="span6">
        <!-- component Name -->
        <div class="row-fluid">
            <div class="span6">
                <h3>
                    Book123: component for Books
                </h3>
            </div>
                    <fieldset class="inlineLabels">
                        <div class="thingrating" id="t_5"><span style="display:none;">3</span></div>
                    </fieldset>
            <div class="span6">

            </div>
 </div>
        <!-- Download Button -->
        <div class="row-fluid align-left">
            <a href="/site_media/media/bookParts/Book123-SDFKSDfsdfasd-component-Books-7.jpg" class="btn btn-medium btn-success" type="submit">Download component</a>
            <br>
<br>
<br>
 </div>
Please rate the quality of the component after downloading.
<br>
<br>
<div class="yourrating" id="t_5"><span style="display:none;">3</span></div>
<br>
<br>
  <div class="tabbable">
        <ul class="nav nav-tabs">
            <li class="active">
                <a href="#relatedproducts" data-toggle="tab"><h6>Related Products (26)</h6></a>
                </li>
            <li>
                <a href="#relatedbookparts" data-toggle="tab"><h6>Related book Parts (2)</h6></a>
            </li>
            <li>

                <a href="#comments" data-toggle="tab"><h6>Comments (3)</h6></a>
            </li>
        </ul>

 <div class="tab-content">
            <!-- SPECIFICATIONS - Use a for loop to run through the different specifications
            If not a spec sheet, just show the description -->
            <div class="tab-pane active" id="relatedproducts">
    <table class="table">

      <tr>
        <td><a href = "/spices/323/view_part">OAK 7-140</a></td>
        <td><img src="/site_media/static/pinax/images/company_logos/thumbs/Other Vendor.jpg" height="30" width='100' /></td>
      </tr>

      <tr>
        <td><a href = "/spices/327/view_part">OAK 7-14MM</a></td>
        <td><img src="/site_media/static/pinax/images/company_logos/thumbs/Other Vendor.jpg" height="30" width='100' /></td>
      </tr>

      <tr>
        <td><a href = "/spices/325/view_part">Book123AMH</a></td>
        <td><img src="/site_media/static/pinax/images/company_logos/thumbs/Book Vendor.jpg" height="30" width='100' /></td>
      </tr>

      <tr>
        <td><a href = "/spices/320/view_part">Book123CH</a></td>
        <td><img src="/site_media/static/pinax/images/company_logos/thumbs/Book Vendor.jpg" height="30" width='100' /></td>
      </tr>

      <tr>
        <td><a href = "/spices/324/view_part">Book123MH</a></td>
        <td><img src="/site_media/static/pinax/images/company_logos/thumbs/Book Vendor.jpg" height="30" width='100' /></td>
      </tr>

      <tr>
        <td><a href = "/spices/322/view_part">Book123H</a></td>
        <td><img src="/site_media/static/pinax/images/company_logos/thumbs/Book Vendor.jpg" height="30" width='100' /></td>
      </tr>

      <tr>
        <td><a href = "/spices/329/view_part">Book123H883C</a></td>
        <td><img src="/site_media/static/pinax/images/company_logos/thumbs/Book Vendor.jpg" height="30" width='100' /></td>
      </tr>

      <tr>
        <td><a href = "/spices/326/view_part">Book123H883</a></td>
        <td><img src="/site_media/static/pinax/images/company_logos/thumbs/Book Vendor.jpg" height="30" width='100' /></td>
      </tr>

      <tr>
        <td><a href = "/spices/321/view_part">Book123AH</a></td>
        <td><img src="/site_media/static/pinax/images/company_logos/thumbs/Book Vendor.jpg" height="30" width='100' /></td>
      </tr>

      <tr>
        <td><a href = "/spices/328/view_part">Book123MH883</a></td>
        <td><img src="/site_media/static/pinax/images/company_logos/thumbs/Book Vendor.jpg" height="30" width='100' /></td>
      </tr>

    <tr>
        <td><a href = "/search/?q=Book123">View more</a></td>
        </tr>
        </table>
</div>
  <div class="tab-pane active" id="relatedbookparts">    
    <table class="table">

    <tr>
        <td><a href = "/spices/5/view_component">Book123</a></td>
        <td>component</td>
      </tr>

    <tr>
        <td><a href = "/spices/4/view_component">Book123</a></td>
        <td>component</td>
      </tr>

    <tr>
        <td><a href = "/search/?q=Book123">View more</a></td>
        <td></td>
        </tr>       
    </table>
    </div>
    <div class="tab-pane active" id="comments"> 

<ul class="responses">

    <li class="even thread-0 clearfix">
        <div class="meta">
            <div class="avatar"><img src="/site_media/media/avatars/mary/resized/40/avatars/mary/Beta.jpg" alt="mary" width="40" height="40" /></div>
            <div class="details"><a href="/profiles/profile/mary/">mary</a></div>
            Oct. 30, 2012
        </div>
        <div class="bulk">
            <div class="body"><p>It&#39;s ok but not great.</p></div>

            <a class="btn pull-left" href="javascript:toggle_comment_form(2)">Reply</a>
            <form class="hidden" method="POST" action="/comments/comment/76/5/2/" id="comment_form_2">
                <div style='display:none'><input type='hidden' name='csrfmiddlewaretoken' value='745d1d9de808f6067468636314711afa' /></div>
                <table><tr><td><textarea rows="10" cols="40" name="comment"></textarea></td></tr>
                    <tr><td><input type="submit" value="Post Response" /></td></tr></table>
                    <input type="hidden" name="next" value="/spices/5/view_component/" />
                </form>

            </div>
        </li>

    <li class="odd thread-1 clearfix">
        <div class="meta">
            <div class="avatar"><img src="/site_media/media/avatars/mary/resized/40/avatars/mary/Beta.jpg" alt="mary" width="40" height="40" /></div>
            <div class="details"><a href="/profiles/profile/mary/">mary</a></div>
            Oct. 30, 2012
        </div>
        <div class="bulk">
            <div class="body"><p>You should be cooler</p></div>

            <a class="btn pull-left" href="javascript:toggle_comment_form(4)">Reply</a>
            <form class="hidden" method="POST" action="/comments/comment/76/5/4/" id="comment_form_4">
                <div style='display:none'><input type='hidden' name='csrfmiddlewaretoken' value='745d1d9de808f6067468636314711afa' /></div>
                <table><tr><td><textarea rows="10" cols="40" name="comment"></textarea></td></tr>
                    <tr><td><input type="submit" value="Post Response" /></td></tr></table>
                    <input type="hidden" name="next" value="/spices/5/view_component/" />
                </form>

            </div>
        </li>

    <li class="even thread-0 clearfix">
        <div class="meta">
            <div class="avatar"><img src="/site_media/media/avatars/mary/resized/40/avatars/mary/Beta.jpg" alt="mary" width="40" height="40" /></div>
            <div class="details"><a href="/profiles/profile/mary/">mary</a></div>
            Oct. 30, 2012
        </div>
        <div class="bulk">
            <div class="body"><p>Ok cool</p></div>

            <a class="btn pull-left" href="javascript:toggle_comment_form(3)">Reply</a>
            <form class="hidden" method="POST" action="/comments/comment/76/5/3/" id="comment_form_3">
                <div style='display:none'><input type='hidden' name='csrfmiddlewaretoken' value='745d1d9de808f6067468636314711afa' /></div>
                <table><tr><td><textarea rows="10" cols="40" name="comment"></textarea></td></tr>
                    <tr><td><input type="submit" value="Post Response" /></td></tr></table>
                    <input type="hidden" name="next" value="/spices/5/view_component/" />
                </form>

            </div>
        </li>

    </ul>

    <fieldset class="inlineLabels">
        <form class="uniForm" method="POST" action="/comments/comment/76/5/">
            <div style='display:none'><input type='hidden' name='csrfmiddlewaretoken' value='745d1d9de808f6067468636314711afa' /></div>
            <div class="ctrlHolder">
                <label for="id_comment">Comment</label>
                <textarea id="id_comment" rows="10" cols="40" name="comment"></textarea>
            </div>
            <div class="form_block">
                <input type="hidden" name="next" value="/spices/5/view_component/" />
                <input type="submit" value="Post Response" />
            </div>
        </form>
    </fieldset>

    </div>
<br>
<br>
  </div>
</div>
   </div>
    <div class="span4">
        <div class="row-fluid">
            <table class="table" id="information-table">
                <tbody>
                    <tr>
                        <td>
                            <div id="profile_avatar">
                                    <img src="/site_media/media/avatars/mary/resized/27/avatars/mary/Beta.jpg" alt="mary" width="27" height="27" />
                              </div>                    </td>
                        <td>Added by</td>
                        <td><a href="/profiles/profile/mary/">mary</a></td>

                    </tr>
                    <tr>
                        <td>
                            <img src="/site_media/static/pinax/images/icons/addedicon.png">
                        </td>
                        <td>
                            Added on
                        </td>
                        <td>October 30, 2012</td>

                    </tr>
                    <tr>
                        <td>
                            <img src="/site_media/static/pinax/images/icons/handsnap.png">
                        </td>
                        <td>
                            Downloads
                        </td>
                        <td>
                            193
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Twitter Button -->
        <div class="row-fluid align-center">
            <a href="#twitterlink" class="btn valign-middle">
                Share
                <img class="small-twitter-icon" src="/site_media/static/pinax/images/icons/twitter-icon.png" alt="" width="22" height="18" />
            </a>
        </div>
<br>
        <div class="row-fluid align-center">
    <br>
<h4>Find More Books Libraries</h4>
<br>
<div class="details inline">
     <a rel="tooltip" href="/spices/bookparts/Books/component" title="components"><img src="/site_media/static/pinax/images/library_placeholders/component.png" width = "20%"></a>&nbsp;&nbsp;&nbsp;<a rel="tooltip" href="/spices/bookparts/Books/component" title="components"><img src="/site_media/static/pinax/images/library_placeholders/component.png" width = "20%"></a>&nbsp;&nbsp;&nbsp;<a rel="tooltip" href="/spices/bookparts/Books/component" title="components"><img src="/site_media/static/pinax/images/library_placeholders/component.png" width = "20%"></a>
    </div>
</div>
<br>
<div class="row-fluid">
    <div class="span8">
        <h3>

        </h3>
    </div>
    <div class="span4 align-center">
    </div>
</div>

<script type="text/javascript">
    //javascript to send messages
    jQuery(document).ready(function($) {
        //activate tooltips
        $('[rel=tooltip]').tooltip();
    });

    function sendMessage(){
        //retrieve the inputs
        var form = $('#sendMessageForm');
        var recipient = form.find('#message_recipient');
        var subject = form.find('#message_subject');
        var body = form.find('#message_data');

        var fields = [recipient, subject, body];

        for(var i = 0; i <fields.length; i++){
            var field = fields[i];
            if(field.val() == ""){

                field.closest('.control-group').addClass('error');
                field.next('.help-inline').text('Please enter this field');
            }
            else{
                field.closest('.control-group').removeClass('error');
            }
        }

        if(!fieldsNotFilled){
            $.ajax({
              url: '/messages/compose/',
              type: 'POST',
              data: {
                csrfmiddlewaretoken: '745d1d9de808f6067468636314711afa',
                recipient: recipient.val(),
                subject: subject.val(),
                body: body.val(),

            },
            complete: function(xhr, textStatus) {

            },

        });

        }      
    }

    </script>

                </div>

                <script src="/site_media/static/pinax/js/facebox.js" type="text/javascript"></script>
<script type="text/javascript">
    jQuery(document).ready(function($) {
        $('a[rel*=facebox]').facebox({
            loadingImage: '/site_media/static/pinax/img/facebox/loading.gif',
            closeImage: '/site_media/static/pinax/img/facebox/closelabel.gif'
        });
        $(document).bind('reveal.facebox', function() {
            $("form.in_facebox").submit(function() {
                form = this;
                jQuery.facebox(function($) {
                    fields = jQuery(form).find("input[type='text']").filter(":enabled");
                    params = {}
                    fields.each(function() {
                        params[this.name] = this.value;
                    });
                    jQuery.post(form.action, params,
                        function(data, textStatus) {
                            jQuery.facebox(data);
                        }
                    );
                });
                return false;
            });
        });
     });
</script>

<script type="text/javascript" src="/site_media/static/pinax/js/topics.js">
</script>

            </div>

            <div id="push-footer"></div>
   </div>
        <div id="footer">
           <aside><p style="color:#1E90FF;background-color:white;text-align:center;font-size:125%;">
            Hi there, early book member! Want to provide a suggestion or report a bug? <a href="mailto:mary@book.com?subject=book: I have a comment&body=[sub]" onclick="this.href = this.href.replace('[sub]',window.location)"> Send Feedback</a>
            </p></aside>

<div id="footer-inner" class="row-fluid align-center">

    <div class="row-fluid">
        <div id="legal">
            <span>&copy; 2012 book</span> -
            <a href="/about/">ABOUT US</a>
            -
            <a href="/about/terms/">TERMS OF SERVICE</a>
            -
            <a href="/about/privacy/">PRIVACY POLICY</a>
            -
            <a href="/blog/"> BLOG </a>
        </div>

</div>

 </div>

        </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T14:21:09.587

也许问题是你`raty`在`'.thingrating'`里面初始化`$.each()`？尝试这个：

```
<script type ="text/javascript"> 
(function($) {
    $(function() {
        $('.yourrating').each(function(index,elem){
            $(elem).raty({
                readOnly:  false,
                path: "{{ STATIC_URL }}js/raty/img/",
                score: $(elem).children("span:first").text(),
                click: function(score, evt) {
                    var vote_url = "/spice/rate/" + this.id.substring(2) + "/" + score + "/";
                    $.ajax({
                        url: vote_url,
                        success: function(){
                            alert('vote successful');
                        }
                    });
                }
            });
        });
        $('.thingrating').each(function(index, elem){
            $(elem).raty({
                readOnly: true,
                path: "{{ STATIC_URL }}js/raty/img/",
                score: $(elem).children("span:first").text()
            });
        });
    });
})(jQuery);
</script> 
```

# mysql - 合并 3 个 SQL 查询，什么是正确的连接？

> ID：13150149
> 
> 赞同：0
> 
> 时间：2012-10-31T01:46:50.980
> 
> 标签：mysql, asp.net-mvc-3

我有几个查询想合并到 1 个查询中，但不确定正确的连接是什么。

此查询获取与 pid 匹配的所有弧：

```
var arcs = db.Query("SELECT arc FROM comics WHERE `publisher`=" + pid + " GROUP BY arc").ToList(); 
```

此查询从 arcs 表中获取弧的标题：

```
var ar = db.QuerySingle("SELECT title FROM arcs WHERE id=" + arc.arc); 
```

此查询用于获取匹配 arc.arc 和 pid 的总问题：

```
var issues = db.Query("SELECT id FROM comics WHERE arc=" + arc.arc + " AND publisher=" + pid); 
```

整个代码：

```
@{
    var pid = Request["pid"];

    var db = Database.Open("quickly");
    var publisher = db.QuerySingle("SELECT * FROM publishers WHERE id=@0",  pid);

    Page.Title = publisher.name + " @";

    var arcs = db.Query("SELECT arc FROM comics WHERE `publisher`=" + pid + " GROUP BY arc").ToList();
}

<div class="post">
    <div class="post-bgtop">
        <div class="post-bgbtm">
            <h2 class="title">@publisher.name</h2>
            <div class="entry">
                <p>
                    <table width="100%" border="0">
                        <thead>
                            <tr>
                                <th align="left">Title</th>
                                <th>Issues</th>
                            </tr>
                        </thead>  
                        <tbody>
                            @foreach (var arc in arcs) {
                                var ar = db.QuerySingle("SELECT title FROM arcs WHERE id=" + arc.arc);
                                var issues = db.Query("SELECT id FROM comics WHERE arc=" + arc.arc + " AND publisher=" + pid);
                            <tr>
                                <td><a href="@Href("~/Comics/Arcs?aid=" + arc.arc)">@ar.title</a></td>
                                <td align="center">@issues.Count</td>
                            </tr>
                            }
                        </tbody>     
                    </table>
                </p>
            </div>
        </div>
    </div>
</div> 
```

表结构：

```
CREATE TABLE IF NOT EXISTS `arcs` (
  `id` int(255) NOT NULL AUTO_INCREMENT,
  `title` varchar(255) NOT NULL,
  `plot` longtext NOT NULL,
  `added` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `title` (`title`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1;

CREATE TABLE IF NOT EXISTS `comics` (
  `id` varchar(255) NOT NULL,
  `arc` int(255) NOT NULL,
  `title` varchar(255) NOT NULL,
  `issue` decimal(5,1) DEFAULT NULL,
  `price` decimal(10,2) NOT NULL,
  `plot` longtext NOT NULL,
  `publisher` int(255) NOT NULL,
  `isbn` varchar(255) NOT NULL,
  `published` date NOT NULL,
  `cover` varchar(255) NOT NULL DEFAULT './images/nopic.jpg',
  `added` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `views` int(255) NOT NULL DEFAULT '0',
  `active` int(1) NOT NULL DEFAULT '0',
  `owned` int(1) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`),
  UNIQUE KEY `arc` (`arc`,`title`,`issue`,`publisher`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE IF NOT EXISTS `publishers` (
  `id` int(255) NOT NULL AUTO_INCREMENT,
  `name` varchar(255) NOT NULL,
  `plot` longtext NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:13:49.797

您必须向我们提供有关表结构的更多信息。

我的第一种方法是这样的..

```
Select 
cs.arc as 'Arc', 
arcs.title as 'Arc_Title', 
id as 'Issues'
from 
Comics cs 
left join Arcs arcs on cs.arc = arcs.id
left join Comics cs2 on cs.arc = cs2.arc and publisher = @pid 
```

但我真的不知道，因为我在猜测表结构

**编辑...**

我知道一个弧线可能出现在不止一部漫画中。并且您需要不同的弧线以及它们重复的次数。所以我认为这会起作用：

```
Select 
t1.arc as 'Arc_ID', 
t1.title as 'Arc_Title', 
count(t1.arc) as 'issues'
from (
Select c.id, c.arc, a.title
    from comics c
    left join arcs a on c.arc = a.id
    where c.publisher = 1) as t1
group by t1.arc, t1.title 
```

这是一个例子.. [http://sqlfiddle.com/#!2/a9fda/8/0](http://sqlfiddle.com/#!2/a9fda/8/0)

# ios - 当supportedInterfaceOrientations 改变时如何通知系统？

> ID：13150154
> 
> 赞同：15
> 
> 时间：2012-10-31T01:47:26.507
> 
> 标签：ios, uiviewcontroller, rotation, uikit

我的根视图控制器的实现`supportedInterfaceOrientations`几乎总是返回`UIInterfaceOrientationMaskAll`，但是有一种极端情况会返回`UIInterfaceOrientationMaskLandscape`。

如果用户旋转设备，这是可行的。但是，如果设备以纵向模式保持，`supportedInterfaceOrientations`则不会调用该方法，除非用户手动旋转设备。

**如何以编程方式告诉系统此方法的返回值已更改？**

根据文档，似乎我应该可以调用`[UIViewController attemptRotationToDeviceOrientation]`但是这没有任何效果（`supportedInterfaceOrientations`从不调用并且屏幕不旋转）。

我发现了其他人发布的各种解决方法来尝试解决这个问题，但在我的测试中它们都不起作用。我怀疑他们可能在 iOS 5.0 中工作过，但在 iOS 6.0 中没有。

我正在返回`YES`根视图控制器的`shouldAutorotate`方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T06:28:24.360

首先，如果你想在横向模式下展示你的 UIViewController，它可能会很有用。

```
- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return UIInterfaceOrientationLandscapeLeft | UIInterfaceOrientationLandscapeRight;
} 
```

此外，很大程度上取决于您的 UIViewController 嵌入到哪个控制器中。

例如，如果它在 UINavigationController 中，那么您可能需要继承该 UINavigationController 以覆盖这样的方向方法。

子类 UINavigationController（层次结构的顶部视图控制器将控制方向。）需要将其设置为 self.window.rootViewController。

```
- (BOOL)shouldAutorotate
 {
     return self.topViewController.shouldAutorotate;
 }
 - (NSUInteger)supportedInterfaceOrientations
 {
     return self.topViewController.supportedInterfaceOrientations;
 } 
```

从 iOS 6 开始，UINavigationController 不会向其 UIVIewControllers 请求方向支持。因此我们需要对它进行子类化。

**笔记 ：**

每当 Push 操作完成时，总是会为 UINavigationController 调用`shouldAutorotate`and方法。`supportedInterfaceOrientations`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:16:22.163

引用 Apple 的 UIViewController 类参考：

> **注意**：在启动时，应用程序应始终将其界面设置为纵向。在 application:didFinishLaunchingWithOptions: 方法返回后，应用程序使用上述视图控制器旋转机制在显示窗口之前将视图旋转到适当的方向。

[http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)

如果界面以纵向开始，则即使用户在设备侧放的情况下打开应用程序，自动旋转也应该能够处理调整。

**更新：**我发现这篇文章应该有助于启动后的轮换。显然，iOS 6 会查看导航控制器以确定支持的设备方向。

[如何在 iOS 6 中强制 UIViewController 为纵向](https://stackoverflow.com/questions/12520030/how-to-force-a-uiviewcontroller-to-portait-orientation-in-ios-6)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T03:32:51.770

您需要手动旋转它。您需要在视图控制器的`viewWillAppear:`方法中调用以下逻辑：

```
UIDeviceOrientation curDevOrientation = [[UIDevice currentDevice] orientation];
if (![self supportsOrientation:curDevOrientation]) {
    // We're going to rotate 90 degrees clockwise.  First figure out what that
    // means to the status bar.
    UIInterfaceOrientation newStatusBarOrientation;
    switch (curDevOrientation)  {
        case UIDeviceOrientationPortrait:
            newStatusBarOrientation = UIInterfaceOrientationLandscapeRight;
            break;
        case UIDeviceOrientationPortraitUpsideDown:
            newStatusBarOrientation = UIInterfaceOrientationLandscapeLeft;
            break;
    }
    [[UIApplication sharedApplication] setStatusBarOrientation:newStatusBarOrientation animated:NO];

    // Now rotate the view 90 degrees clockwise.
    CGAffineTransform transform = CGAffineTransformMakeRotation(M_PI * 90.0 / 180.0);
    self.view.transform = transform;
} 
```

这应该旋转特定视图控制器的视图，无论何时出现。

# android - 如何膨胀子视图？

> ID：13150160
> 
> 赞同：0
> 
> 时间：2012-10-31T01:48:05.523
> 
> 标签：android, layout, layout-inflater

我正在尝试对布局的特定部分进行膨胀，但是我遇到了编译器错误，并且不确定要采取什么方法。特别是与线 -

```
LinearLayout childList = (LinearLayout)findViewById(R.id.listLayout). 
//(This can be found near the bottom of Java code.) 
```

我也不确定在尝试给`listLayout`.

在这个阶段，我试图在顶部有一个按钮，然后在它下面的 Array 中动态扩展项目列表。

任何帮助将非常感激

**XML**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <Button
        android:id="@+id/labelAddCourseButton"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:onClick="addCourseButton"
        android:padding="10dp"
        android:text="@string/CourseName" />

    <LinearLayout
    android:id="@+id/listLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="horizontal" >     

    <TextView
        android:id="@+id/labelModuleCode"
        android:layout_height="wrap_content"
         android:layout_width="wrap_content"
         android:layout_marginLeft="10dp"
        android:text="@string/CourseName"
        android:textSize="10dp" />

     <TextView
        android:id="@+id/labelCourseType"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/CourseType"
        android:layout_marginLeft="10dp"
        android:textSize="10dp" />

    </LinearLayout>

</LinearLayout> 
```

**爪哇**

```
package com.example.mycoursetimetable;

import android.os.Bundle;
import android.app.ListActivity;
import android.content.Context;
import android.content.Intent;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.LinearLayout;
import android.widget.ListView;
import android.widget.TextView;

public class MyCourses extends ListActivity {

    static final String TEST = "com.example.mycoursetimetable.TEST";
    String [] MODULE;

    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_my_courses);
        MODULE = getResources().getStringArray(R.array.module);
        setListAdapter(new ListArrayAdapter(this,MODULE));
    }

    public void addCourseButton (View addCourseButton) 
    {
        Intent intent = new Intent(this,AddCourse.class);
        startActivity(intent);
    }

    public void onListItemClick(ListView l, View v, int position, long id)
    {
        super.onListItemClick(l, v, position, id);

        try {
        Class test = Class.forName("com.example.MyCourseTimeTable.AddCourse");
        Intent intent = new Intent(MyCourses.this, test);

        TextView textView = (TextView) v.findViewById(R.id.labelModuleCode);
        String module = textView.getText().toString();

        intent.putExtra(TEST,module);
        startActivity(intent);
        }   
        catch (ClassNotFoundException e)
        {
        e.printStackTrace();
        }             
    }    
}

class ListArrayAdapter extends ArrayAdapter<String> 
{
    //Context allows the retrieval of resources such as layout
    private final Context context;
    private final String[] test;

    //create the ArrayAdpater
    public ListArrayAdapter(Context context, String[] test) 
    {
        super(context, R.layout.activity_my_courses, test);
        this.context = context;
        this.test = test;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) 
    {
        LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        //inflater  dynamically loads the layout

        LinearLayout childList = (LinearLayout)findViewById(R.id.listLayout);
        View rowView = inflater.inflate(R.layout.childList, parent, false);

        //get the textView
        TextView textView = (TextView) rowView.findViewById(R.id.labelModuleCode);
        //set the text to the string values based on position
        textView.setText(test[position]);

        // Change item based on its position in the string array
        String modulePosition = test[position];             

        //return the layout
        return rowView;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T01:54:03.670

尝试将您的编辑`getView()`为以下之一：

```
 @Override
        public View getView(int position, View convertView, ViewGroup parent) 
        {
        LayoutInflater inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
      //inflater  dynamically loads the layout

        LinearLayout childList = (LinearLayout)findViewById(R.id.listLayout);
        convertView = inflater.inflate(R.layout.childList, null);

        //get the textView
        TextView textView = (TextView) convertView.findViewById(R.id.labelModuleCode);
        //set the text to the string values based on position
        textView.setText(test[position]);

        // Change item based on its position in the string array
        String modulePosition = test[position];

        //return the layout
        return convertView;
        } 
```

使用`getView()`'s `convertView`View 而不是你自己的`rowView`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:17:19.103

这是您可能想要的示例。[通过观看 Android 的 Romain Guy讨论适配器和效率](http://www.google.com/events/io/2009/sessions/TurboChargeUiAndroidFast.html)，了解我为什么使用 ViewHolder 和其他技巧：

```
class ListArrayAdapter extends ArrayAdapter<String> 
{
    //  You only need one copy of LayoutInflater
    private final LayoutInflater inflater;

    //create the ArrayAdpater
    public ListArrayAdapter(Context context, String[] test) 
    {
        // The layout here doesn't really matter since we don't use it
        super(context, R.layout.childList, test);
        inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) 
    {
        ViewHolder holder;
        if(convertView == null) {
            // Inflate the layout that you want for each row
            convertView = inflater.inflate(R.layout.childList, parent, false);

            holder = new ViewHolder();
            holder.code = (TextView) convertView.findViewById(R.id.labelModuleCode);
            holder.type = (TextView) convertView.findViewById(R.id.labelModuleType);

            // Add a reference in ViewHolder for your Button, find it like the TextViews and define its OnClickListener here too, eventually...

            convertView.setTag(holder);
        }
        else 
            holder = (ViewHolder) convertView.getTag();

        String module = getItem(position);
        //set the text to the string values based on position
        holder.code.setText(module);

        //return the layout
        return convertView;
    }

    class ViewHolder {
        TextView code;
        TextView type;
    }
} 
```

# javascript - 临时全局变量/函数和原型覆盖以编写 JS DSL

> ID：13150164
> 
> 赞同：1
> 
> 时间：2012-10-31T01:48:51.900
> 
> 标签：javascript, node.js, global-variables, dsl, prototype-programming

我正在为我正在开发的 JavaScript 路由框架探索各种选项，并且我想提供一个用 JavaScript 编写的 DSL 来定义路由器。

我有在 String 类上使用临时原型覆盖的想法（维护先前原型值的哈希，覆盖，运行 DSL 代码，将原型值重置为原来的值），如下所示：

```
DSL.run(function() {
  "hello".isSomething();
  "foo".isSomethingElse();
}); 
```

另一个想法是使用定义临时全局变量，然后在 DSL 完成运行后删除/重置它们。这样，如果您使用`window`（或任何全局对象）作为`this`上下文运行 DSL 闭包，我相信您应该能够执行以下操作：

```
DSL.run(function() {
  defineSomething("hello");
  defineSomethingElse("foo");
}); 
```

我知道我知道我应该非常小心原型重载和污染全局命名空间，但这似乎是一种非常本地化且易于清理的方法，可以防止此类事情发生。我的问题是，是否有任何其他考虑因素会阻止这成为现实？

我能想到的一个潜在问题是这是否适用于 Node.js 设置，其中代码存储在单独的模块中，全局变量彼此保持，我认为这会消除选项 B，但是字符串原型重载呢？这些是在模块之间共享的，对吗？例如，如果我包含设置字符串原型值的模块 A，那么这些原型值将在包含代码中可用，对吗？

另外，让我知道是否有人以前做过这种事情。我认为这是解决这类问题的一种聪明方法，我还没有见过类似的东西，但我想确保我没有遗漏一些非常明显和该死的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-12T05:23:42.167

使用`delete String.prototype[method]`.

```
var dsl = function(f){
  var _ = String.prototype;
  _.isSomething = function(){
    console.log('isSomething: '+this);
  }
  _.isSomethingElse = function(){
    console.log('isSomethingElse: '+this);
  }

  f();

  delete _.isSomething;
  delete _.isSomethingElse;
}

dsl(function(){
  "hello".isSomething(); // isSomething: hello
  "foo".isSomethingElse(); // isSomethingElse: foo
});

// "hello".isSomething(); // error "Object has no method 'isSomething'"
// "foo".isSomethingElse(); // error "Object has no method 'isSomethingElse'" 
```

# xml - XML 数据建模工具

> ID：13150166
> 
> 赞同：0
> 
> 时间：2012-10-31T01:49:32.530
> 
> 标签：xml, data-modeling

我想从为我的 Java 应用程序编写的 XML 创建模型类。有哪些好工具可以从我正在编写的 XML 转换自动生成的类？我的 XML 文件中的一个示例。

```
 <list name="NameValuePairListDefinition">
    <member target="NameValuePair" />
  </list>

  <structure name="PositiveIntegerList">
    <member name="list" target="PositiveIntegerListDefinition" />
  </structure> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:11:00.393

如果您正在使用 Java 并且想要生成类，我强烈建议您使用[XMLbeans](http://xmlbeans.apache.org/)。它带有一些不错的实用程序，包括：

*   **inst2xsd**：给定 xml ，它会生成 xsd

    例子

    `inst2xsd -enumerations never message.xml`

    （将生成 xsd 文件并禁用任何相同类型的枚举）

*   **scomp**：将模式编译成*jar*文件，这意味着它会为你生成一个非常好的可重用库，如果你没有，它包含一个基于模式命名空间（或以*noNamespace.something*开头）的类（或多个类）在您的 XML 中定义任何

    例子

    `scomp -jar yourschema mySchema.xsd`

    （创建**xmltypes.jar** - 这是您想要的 jar，只需将其重命名为聪明的名称，然后将其用于获取和设置、读取和写入值的双向解析）

*   最后，只需启动您的 java IDE 并为 scomp 创建的模式添加所有 xmlbeans JARS 和*JAR*

然后，您可以使用您的 xmldata 加载、创建、存储、操作，因为它只是您项目中的 java 对象；-)

基于*您的小 XML 片段的元素，您将使用大致如下所示的代码进行访问：*

 *```
 MyModel myModel = null;
 try {
    //full path to XML file
    File modelXML = new File("Model.xml");

    // Bind the incoming XML to an XMLBeans type.
    myModel = MyModel.Factory.parse(modelXML);
 } 
 catch (XmlException e) { e.printStackTrace(); } 
 catch (IOException e) { e.printStackTrace(); }
 catch (FileNotFoundException e) { e.printStackTrace();  }

 // Using the <structure> element.
 Structure structure = myModel.getStructure();
 Member member = structure.getMember();
 String target = member.getTarget(); // "PositiveIntegerListDefinition" 
```

注意：我还建议使用不是保留的 Java 关键字的元素名称，例如*list*，我不确定 XMLBeans 将如何处理它，但我假设它会稍微重命名它而不是重载。

这是一个可以派上用场的完整教程：http: [//xmlbeans.apache.org/documentation/tutorial_getstarted.html](http://xmlbeans.apache.org/documentation/tutorial_getstarted.html)

我假设您使用的是简单的直接 XML 调用或基于 REST 的 Web 服务，但如果您决定使用更详细的东西，例如 SOAP，还有[Apache CXF](http://cxf.apache.org/)和[Apache Axis2](http://axis.apache.org/axis2/java/core/)，它们可以轻松地从 SOAP XML 消息或 WSDL 生成 Java 类。*

# c# - 在 C# 和 Android 应用程序之间序列化数据的最简单方法

> ID：13150167
> 
> 赞同：0
> 
> 时间：2012-10-31T01:49:38.067
> 
> 标签：c#, android, serialization

我有一个用 C# 编写的桌面应用程序，它将与 Android 应用程序通信。通过 tcp/ip 连接在它们之间传递数据的最简单方法是什么？我对性能不太感兴趣，对易于实施更感兴趣。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T07:00:35.840

我自然不明白你的意思**`ease of implementation`**。但正如我猜想的那样，你应该需要这些：

**`In [C#]:`**

```
//util function
public static void WriteBuffer(BinaryWriter os, byte[] array) {
            if ((array!=null) && (array.Length > 0) && (array.Length < MAX_BUFFER_SIZE)) {
                WriteInt(os,array.Length);
                os.Write(array);
            } else {
                WriteEmptyBuffer(os);
            }
        }

//write a string
public static void WriteString(BinaryWriter os, string value)  {
            if (value!=null) {
                byte[] array = System.Text.Encoding.Unicode.GetBytes(value);
                WriteBuffer(os,array);
            } else {
                WriteEmptyBuffer(os);
            }
        } 
```

**`In [Java] Android:`**

```
/** Read a String from the wire.  Strings are represented by
 a length first, then a sequence of Unicode bytes. */
public static String ReadString(DataInputStream input_stream) throws IOException  
{
    String ret = null;
    int len = ReadInt(input_stream);
    if ((len == 0) || (len > MAX_BUFFER_SIZE)) {
        ret = "";
    } else {
        byte[] buffer = new byte[len];
        input_stream.readFully(buffer);
        ret = new String(buffer, DATA_CHARSET);
    }
    return (ret);
} 
```

对于进一步的结构数据，例如，您想在 C# 和 Java 之间发送对象，请使用**`XML Serialization in C#`**和**`XML Parser in Java`**。你可以在网上搜索这些；许多示例在[**Code Project**](https://www.codeproject.com/)网站上。

在 Android 部分，您可以使用**[XStream](http://xstream.codehaus.org/faq.html)**库以方便使用。

# c# - 使用 BackgroundWorker.Backgroundworker 显示命令提示符输出

> ID：13150171
> 
> 赞同：2
> 
> 时间：2012-10-31T01:50:22.150
> 
> 标签：c#, cmd

我有一个使用异步后台工作程序执行批处理文件的程序。这是代码：

```
public static void Execute(CmdObj obj, bool batch)
{
    CmdObj = obj;

    var theWorker = new BackgroundWorker();
    theWorker.RunWorkerCompleted += WorkerCompleted;
    theWorker.WorkerReportsProgress = true;

    if(batch)
    {
        theWorker.DoWork += WorkerBatchWork;
    }else{
        theWorker.DoWork += WorkerCommandWork;
    }
    theWorker.RunWorkerAsync();

}

private static void WorkerBatchWork(object sender, DoWorkEventArgs e)
{
    RunBatch(CmdObj);
}

private static void WorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    var temp = Path.GetDirectoryName(Assembly.GetExecutingAssembly().GetName().CodeBase);
    if (temp != null)
        ProgramPath = temp.Substring(6);

    WriteLog(CmdObj.Activity, false);
    WriteLog(CmdObj.Error, true);

    CmdObj.TheButton.Enabled = true;
}

private static void RunBatch(CmdObj obj)
{
    var process = new Process();
    var startInfo = new ProcessStartInfo
                        {
                            FileName = obj.SrcFile,
                            WindowStyle = ProcessWindowStyle.Normal,
                            CreateNoWindow = false,
                            RedirectStandardInput = true,
                            RedirectStandardOutput = false,
                            RedirectStandardError = true,
                            UseShellExecute = false
                        };

    try
    {
        if (!obj.SrcFile.ToLower().Trim().EndsWith(".bat"))
            throw new FileLoadException("Not a valid .bat file",obj.SrcFile);

        process.StartInfo = startInfo;
        process.Start();
        process.WaitForExit();

        //obj.Activity = process.StandardOutput.ReadToEnd();
        obj.Error = process.StandardError.ReadToEnd();

    }
    catch (Exception ex)
    {
        obj.Exception = ex;
    }
    finally
    {
        process.Close();
    }
}

class CmdObj
{
    public string Command { get; set; }
    public string SrcFile { get; set; }
    public string Activity { get; set; }
    public string Error { get; set; }
    public Exception Exception { get; set; }
    public Button TheButton { get; set; }
} 
```

所以当我运行这个程序并选择一个批处理文件来执行时，我得到一个空白的 CMD 窗口。当我的程序执行批处理文件时，有什么方法可以在 CMD 窗口中显示输出吗？或者，如果我可以将 CMD 输出发送到文本框或其他控件（实时），那也可以。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:18:52.717

由于您将以下属性之一设置为`true`，您将获得一个空白的黑色窗口

```
RedirectStandardInput
RedirectStandardOutput
RedirectStandardError 
```

这实际上会发生，因为您已经告诉您的应用程序从目标进程接收/发送输出/输入

我看到您正在尝试使用此行从批处理文件中获取输出

```
//obj.Activity = process.StandardOutput.ReadToEnd(); 
```

`RedirectStandardOutput`不幸的是，除非您设置为这样，否则这将不起作用，`True`以便您的应用程序能够读取目标批处理文件的输出。否则，输出将为空

**例子**

```
private void RunBatch(CmdObj obj)
{
    var process = new Process();
    var startInfo = new ProcessStartInfo
    {
        FileName = obj.SrcFile,
        WindowStyle = ProcessWindowStyle.Normal,
        CreateNoWindow = false,
        RedirectStandardInput = true,
        RedirectStandardOutput = true, //This is required if we want to get the output
        RedirectStandardError = true,
        UseShellExecute = false
    };

    try
    {

        if (!obj.SrcFile.ToLower().Trim().EndsWith(".bat"))
        throw new FileLoadException("Not a valid .bat file",obj.SrcFile);

        process.StartInfo = startInfo;
        process.Start();
        process.WaitForExit();

        obj.Activity = process.StandardOutput.ReadToEnd(); //Get the output from the target process
        obj.Error = process.StandardError.ReadToEnd();

    }
    catch (Exception ex)
    {
        obj.Exception = ex;
    }
    finally
    {
        process.Close(); //Terminate the process after getting what is required
    }
} 
```

**注意**:`UseShellExecute`必须是`False`为了使用`RedirectStandardOutput`

谢谢，
我希望你觉得这有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-06T09:31:42.573

你不需要打电话吗

```
 process.BeginErrorReadLine();
 process.BeginOutputReadLine(); 
```

进程开始后？如果我没记错的话，如果没有这个，我会遇到一些问题。

# java - 从线程中绘制图像

> ID：13150173
> 
> 赞同：0
> 
> 时间：2012-10-31T01:51:03.820
> 
> 标签：java, multithreading, image, graphics, concurrency

我正在制作一个程序，其中一个角色将在远离程序其余部分的线程中进行动画处理。

```
Thread trollAnimation = new Thread() {

    public void run() {
        if (battling) {
            frame++;

            switch (frame) {
            case 1: case 5: case 9:
                g.drawImage(troll1, 0, 0, null);
                break;
            case 2: case 4: case 6: case 8:
                g.drawImage(troll2, 0, 0, null);
                break;
            case 3: case 7:
                g.drawImage(troll3, 0, 0, null);
                break;
            case 10:
                g.drawImange(troll4, 0, 0, null);
                break;
            }

            if (frame == 10) {
                frame = 1;
            }
        }
    }
}; 
```

在显示 g.drawImage... 的每一行上，都会抛出一个错误，显示“g 无法解析”。除了绘制图像的问题，我如何在战斗== false时正确停止线程？

# django - Django/Sqlite 提高数据库性能

> ID：13150174
> 
> 赞同：2
> 
> 时间：2012-10-31T01:51:09.580
> 
> 标签：django, sqlite, denormalization

我们正在使用 django 开发一个在线学校日记应用程序。原型已经准备好，该项目将于明年投入使用，约有 500 名学生。最初我们使用 sqlite，并希望对于初始实现，这将表现得足够好。数据表用于获取上学日的详细信息（期间、班级、教师、教室，使用了许多表，并且在相当快的 PC 上访问数据库需要 67 毫秒。一旦一年开始，大部分数据可能是静态的对教室的小改动。我想提取每个学生每个学期的时间表，这样就不需要表连接了。我把这些数据放到一个学生的文本文件中，文件大小为 100K。阅读时间这个数据和处理它一天的时间表大约是 8ms。如果我在登录时预加载数据并将其存储在会话中，则登录时需要 7 毫秒，每次查询需要 2 毫秒。对于 500 名学生，使用这种方法会对 Web 服务器产生什么影响以及还有哪些其他选项（例如，将学生文本文件放入某种内存缓存而不是会话中？）不会有大量的数据输入，学生添加笔记，老师也是如此，所以它主要是检查时间表状态并查看当天或那一周存在哪些事件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T02:03:16.360

您的预期响应时间是多少，您每分钟的预期请求数是多少？请求的数据库访问时间的二十分之一秒（这可能是缓慢的部分）对我来说听起来不是问题。SQLite 应该在这种以读取为主的情况下表现良好。所以我不相信你甚至有性能问题。

如果您想要更快的响应，您可以考虑：

1.  首先，通过检查索引和分析单个检索以查找性能瓶颈，确保您拥有最佳响应时间。
2.  预先计算系统的静态部分并存储 HTML。您可以将 HTML 直接放回数据库或将其存储为磁盘文件。
3.  仅将数据库用作后备存储（以在服务器关闭时保留系统状态）并在系统启动时将整个事物读入内存结构。这消除了对数据的磁盘访问，尽管它限制您使用一台物理服务器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T02:04:21.253

这听起来像是过早的优化。67 毫秒几乎不比我们人类可以观察到有延迟的约 50 毫秒长。

SQLite 对数据的表示将比文本格式更有效，并且与您必须解析的文本文件不同，操作系统可以有效地缓存您在 RAM 中实际使用的数据库部分。

您可以锁定约 50MB 的 RAM 来缓存所有学生的数据的解析表示，但使用该 RAM 可能会获得更好的性能，例如 OS 磁盘缓存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T02:13:06.193

我同意其他一些建议使用 MySQL 或 PostgreSQL 而不是 SQLite 的答案。它不是为用作生产数据库而设计的。它非常适合为单用户应用程序（例如移动应用程序甚至桌面应用程序）存储数据，但在服务器应用程序中很快就会出现不足。使用 Django，切换到任何其他完全质押数据库后端是微不足道的。

[`select_related`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.select_related)如果您切换到其中之一，您应该不会真正遇到任何性能问题，特别是如果您将使用and进行所有必要的连接[`prefetch_related`](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.prefetch_related)。

如果您仍然需要更高的性能，考虑到“大部分数据是静态的”，您实际上可能希望将 Django 站点转换为静态站点（html 文件的集合），然后使用 nginx 或类似的东西为这些站点提供服务。我能想到的最简单的方法是编写一个 cron-job，它将遍历所有需要的 url-configs，从 Django 请求页面，然后将其保存为 html 文件。如果您想朝那个方向发展，您可能还想看看 Python 的静态站点生成器：[Hyde](http://ringce.com/hyde)和[Pelican](https://github.com/ametaireau/pelican)。

这种方法肯定会比任何缓存系统运行得更快，但是您将丢失站点的任何动态组件。如果您需要它们，那么缓存似乎是最好和最快的解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T02:04:14.583

您应该将 MySQL 或 PostgreSQL 用于生产数据库。sqlite3 不是一个好主意。

您还应该避免在登录时预加载数据。由于您的记录可以提前插入，因此请编写 django 管理命令并预先运行导入到您选择的数据库并设计您的模型，以便当用户登录时，用户已经能够访问和查看/编辑他或她相关数据（在应用程序上线之前预先插入）。从应用程序设计的角度来看，登录时的硬编码数据操作完全不合适。

[https://docs.djangoproject.com/en/dev/howto/custom-management-commands/](https://docs.djangoproject.com/en/dev/howto/custom-management-commands/)

设计您的 django 模型和使用自定义管理命令在应用程序上线之前正确插入记录的好处意味着您可以使用 django orm 在用户和他们的记录之间建立适当的关系。

我怀疑-根据您对上面所需内容的描述-您需要重新查看创建此应用程序的方法。

有 500 名学生，我们甚至不应该谈论缓存。如果您想要响应速度，您应该优先处理以下问题：-

1.  使用生产质量数据库
2.  正确设计您的应用程序用例并正确设计您的应用程序模型
3.  将您需要的任何数据预加载到生产数据库中
4.  前端优化优先（css/js压缩等）
5.  使用 django 调试工具栏来确定您的任何 sql 是否很慢并专门优化那些
6.  根据需要实现缓存（memcached 等）

作为一般准则。

# sql-server-2008-r2 - 使用用户进行 SQL Server 2008 R2 调试

> ID：13150176
> 
> 赞同：2
> 
> 时间：2012-10-31T01:51:15.627
> 
> 标签：sql-server-2008-r2

我需要想办法在 SQL Server Management Studio 2008 R2 的调试下运行。但是我有一些限制，我找不到解决方法：

*   用户需要是特定模式的所有者。
*   因此，用户不能拥有 SysAdmin 权限。这样做的原因是我们已经有许多存储过程，我们没有为 SQL 查询指定模式的名称。
*   由于用户需要具有 SysAdmin 权限，因此这与第一个要求相冲突，因为您无法修改系统管理员的 DEFAULT_SCHEMA。

据我所知，在 SQL Server 2008 中进行调试的唯一方法是获得系统管理员权限，因为这就是 M$FT 设计软件的方式。有什么可能的解决方法？

我知道推荐的答案可能是改变我们编写 SP 的方式或考虑重新设计数据库设计，但遗憾的是，这不是一个选择。

请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:42:45.537

取自[MSDN：运行 Transact-SQL 调试器](http://msdn.microsoft.com/en-us/library/ff878060.aspx)

> 我们建议在测试服务器而不是生产服务器上调试 Transact-SQL 代码，原因如下： 调试是一项高权限操作。因此，仅允许 sysadmin 固定服务器角色的成员在 SQL Server 中进行调试。在您调查多个 Transact-SQL 语句的操作时，调试会话通常会运行很长时间。会话获取的锁（例如更新锁）可能会保留很长时间，直到会话结束或事务提交或回滚。

如果您有疑虑，您可能想在 microsoft connect 站点上报告您的愿望： [http ://connect.microsoft.com/sqlserver](http://connect.microsoft.com/sqlserver)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T01:57:52.070

通过*在调试下运行，*您是否意味着要使用 T-SQL 调试器交互式地调试存储过程？

如果您在运行此程序时遇到问题，并且您的目标是调试代码，您还可以使用 SQL Profiler 来准确观察存储过程中正在执行的内容。它当然不支持断点和启动/停止，但它可以让您观察正在执行的内容。

# c++ - 返回内置类型的 const 值

> ID：13150177
> 
> 赞同：3
> 
> 时间：2012-10-31T01:51:16.767
> 
> 标签：c++, constants

为内置类型返回一个 const 值是一个好的习惯吗？

原因是：

```
const int F()
{
}

int y;
F(x) = y; 
```

如果返回值为 const，上述代码将无法编译。但是，如果不是，`F(x) = y;`则是一个非常隐蔽的错误。

由于为函数赋值没有意义，我在想总是为内置类型返回一个 const 值是一个很好的习惯吗？如果我总是为内置类型返回一个 const 值，有什么问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T09:40:25.880

`const`意味着在对象的生命周期内，对象的值不会改变。

标准本身指出，因此，const 对非类或非数组纯右值的纯右值没有意义。这样的表达式从不引用对象（至少如果表达式源自用户代码。语言本身可能会在引用绑定期间创建prvalues，它神奇地引用临时对象。恕我直言，不过，这些应该是xvalues）。因此，既然没有对象，就没有生命周期。因此，没有什么可以被认为是“const”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T01:55:33.020

无论如何，分配给这种类型的函数调用是不合法的。如果我尝试，g++ 会给我这个错误消息：

```
test.cpp: In function ‘int main()’:
test.cpp:8:8: error: lvalue required as left operand of assignment 
```

因此，您不需要`const`仅仅为了从编译器获得合适的诊断而声明返回值。

# excel - 如何从 excel 用户表单中删除 close(x) 选项？

> ID：13150186
> 
> 赞同：2
> 
> 时间：2012-10-31T01:52:20.793
> 
> 标签：excel, vba

如何从 excel 用户表单中删除 close(X) 选项？我得到了已经讨论过的以下链接。 [http://www.excelforum.com/excel-programming-vba-macros/694008-remove-user-form-b​​orders.html](http://www.excelforum.com/excel-programming-vba-macros/694008-remove-user-form-borders.html)

但是我得到了他们给的东西，请帮助我....

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T02:59:53.283

首先：确保您至少包含一种明显的关闭表单的方法！

我不会在点击关闭后用消息框打扰最终用户，而是完全隐藏关闭：

```
'//Find the userform's Window
Private Declare Function FindWindow Lib "user32" _
        Alias "FindWindowA" ( _
        ByVal lpClassName As String, _
        ByVal lpWindowName As String) As Long

'//Get the current window style
Private Declare Function GetWindowLong Lib "user32" _
        Alias "GetWindowLongA" ( _
        ByVal hWnd As Long, _
        ByVal nIndex As Long) As Long

'//Set the new window style
Private Declare Function SetWindowLong Lib "user32" _
        Alias "SetWindowLongA" ( _
        ByVal hWnd As Long, _
        ByVal nIndex As Long, _
        ByVal dwNewLong As Long) As Long

Const GWL_STYLE = -16
Const WS_SYSMENU = &H80000

Private Sub UserForm_Initialize()
   Dim hWnd As Long, lStyle As Long

   If Val(Application.Version) >= 9 Then
      hWnd = FindWindow("ThunderDFrame", Me.Caption)
   Else
      hWnd = FindWindow("ThunderXFrame", Me.Caption)
   End If

   '//Get the current window style and turn off the Close button
   lStyle = GetWindowLong(hWnd, GWL_STYLE)
   SetWindowLong hWnd, GWL_STYLE, (lStyle And Not WS_SYSMENU)
End Sub 
```

如果你想阻止通过 ALT-F4 关闭，那么也可以使用它：

```
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
      If CloseMode = vbFormControlMenu Then
        Cancel = True  
    End If
End Sub 
```

# tabs - 使用 Ajax 从 PartialView 加载的 jQuery 选项卡内容

> ID：13150191
> 
> 赞同：2
> 
> 时间：2012-10-31T01:53:00.900
> 
> 标签：tabs, rendering, partial-views

我正在使用 $.ajax() 加载 2 个 jQuery UI 选项卡，其中包含来自 ASP.NET MVC 3 PartialView 的数据。我将“/controller/action”指定为 URL。这工作正常，我可以加载两个选项卡，其中包含部分视图返回的内容。

我在 _layout.cshtml 中有一个保存按钮。单击保存按钮时，我想从所有选项卡中获取数据并将其作为 JSON 对象发送到控制器。我只想使用一个保存按钮将所有数据保存在选项卡而不是每个选项卡底部都有保存按钮。

问题是我只能从第一个选项卡中获取数据。当我尝试从另一个选项卡获取数据时出现“无可用源”错误。$('#some_id').change() 事件也不会为第二个选项卡中的控件触发。

请建议是否有更好的方法来实现这一点？我也想知道为什么在查看页面的源HTML时看不到PartialView生成的HTML？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T01:13:44.533

事实证明，这是为加载选项卡而发出的异步请求的问题。我使用 jQuery 选项卡的 load() 来解决这个问题。

# php - preg_replace... 从字符串中删除字符串

> ID：13150195
> 
> 赞同：0
> 
> 时间：2012-10-31T01:53:48.763
> 
> 标签：php, string, preg-replace

我想要做的是删除 c_*/ 的所有实例，其中 * 可以是任何数字或任何长度的字符。

```
$cano = 'www.example.com/example/example2/c_3/example4/';
$cano = preg_replace('c_*/', '', $cano); 
```

我一直对这些不好，因为我几乎不使用它们......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T01:55:34.993

我认为这会成功。

```
$cano = preg_replace('#c_[^/]+/#', '', $cano); 
```

`[^/]`匹配任何不是正斜杠的字符，意思`+`是“一个或多个”字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T01:56:29.557

试试这个：

```
$cano = 'www.example.com/example/example2/c_3/example4/';
$cano = preg_replace('#(?:c_.[^/]/)+#', '', $cano); 
```

# java - 当另一个任务正在运行时禁止一个任务

> ID：13150197
> 
> 赞同：0
> 
> 时间：2012-10-31T01:53:58.303
> 
> 标签：java, multithreading

因此，假设我在 for 循环中创建并启动了一堆线程，这些线程正在启​​动器线程的 run 方法中执行。还假设我希望能够中断启动器线程和该线程创建的所有线程，我通过一个按钮来执行此操作。

所以像这样的东西 -

```
try{
            for(int i = 0; i < n;i++){

                Worker currThread = new Worker(someArgs);
                workerThreads.add(currThread);
                currThread.start();
            }
        } catch (InterruptedException e){
            e.printStackTrace();
        } 
```

按钮-

```
public void actionPerformed(ActionEvent arg0) {

    List<Worker> threads = launchThread.getWorkerThreads();
        for(int i = 0; i < threads.size();i++){
            threads.get(i).interrupt();
        }
        launchThread.interrupt();

    } 
```

现在，假设我想让中断不能与线程创建同时发生。我认为这样做的一种方法是构造一个虚拟对象并将两段代码都放在一个锁中

```
synchronized(dummyObject){
//thread creation or interruption code here (shown above) 
} 
```

这种方式行得通吗？我问是因为我不确定如何测试它是否会。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T01:57:54.267

与创建线程分开启动线程。

```
for(int i = 0; i < n; i++) {
    Worker currThread = new Worker(someArgs);
    workerThreads.add(currThread);
}

// later
for (Worker w : workerThreads) {
    w.start();
} 
```

如果这还不够，您的`dummyObject`同步应该可以正常工作。

```
// You probably need to make this a (private final) field
Object lock = new Object();

// later
synchronized (lock) {
    for(int i = 0; i < n; i++) {
        Worker currThread = new Worker(someArgs);
        workerThreads.add(currThread);
        w.start();
    }
}

// later still
public void actionPerformed(ActionEvent arg0) {
    synchronized (lock) {
        // interruption code here
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:06:23.613

同步的概念保持不变，但要执行的底层操作很复杂。

正如您所指定的，有两种类型的互斥任务（线程创建和中断）。所以锁定几乎是这项工作的规范工具。

# visual-studio - 如何在 Visual Studio 类设计器中更改类的 z 顺序？

> ID：13150206
> 
> 赞同：4
> 
> 时间：2012-10-31T01:55:53.847
> 
> 标签：visual-studio, class-designer

也许我误解了 Visual Studio 中的类设计器的用途，但我真的很难在画布上的其他类后面显示扩展类。

我想要两个折叠的类，一个在另一个之上。然后当我展开上面的类时，它应该显示在下面的类之上，这样下面的类就不会阻碍上面的类的成员。

我意识到以正确的顺序添加我的类会做到这一点，但是当我想更改布局时，我不想重新添加所有控件。“发送到后面/发送到前面”按钮在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-06-12T11:52:38.587

不确定这仍然是一个问题，但我在 VS 2013 中以“类似 UML”的结构可视化事物时遇到了类似的问题。我发现或多或少简单的方法可能是更改 .layout 文件中的顺序：

![单击 .layout 链接](../Images/cc8ccb659fac4091e586ae38b7eb2112.png)

该示例希望显示如何执行以下操作：

第一个示例 - 动作在对象“下方”：

```
 <actionShape Id="..." absoluteBounds="..." customColor="...">
      <opaqueActionMoniker Id="..." LastKnownName="Action1" />
    </actionShape>
    <objectNodeShape Id="..." absoluteBounds="..." customColor="White">
      <objectNodeMoniker Id="..." LastKnownName="Object" />
    </objectNodeShape> 
```

第二个例子：我改变了订单。动作在对象之上：

```
 <objectNodeShape Id="..." absoluteBounds="..." customColor="White">
      <objectNodeMoniker Id="..." LastKnownName="Object" />
    </objectNodeShape>
    <actionShape Id="..." absoluteBounds="..." customColor="...">
      <opaqueActionMoniker Id="..." LastKnownName="Action1" />
    </actionShape> 
```

![Z 顺序已更改](../Images/e6cef559e412ba5af34c900e912656e0.png)

我知道，这可能不是最好的方法，但它是我发现的最好的方法。希望它对任何人都有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T16:15:11.720

抱歉挖掘了一篇旧帖子，但从外观上看，没有任何此类按钮，也没有在 Visual Studio 2012 中添加它们。根据我在[此处](http://social.msdn.microsoft.com/Forums/en-US/vsclassdesigner/thread/c0dd9246-0cbc-4837-a347-f8353447da53/)的 MSDN 论坛中找到的内容，这已经被提出过。我不确定该线程中的任何一张海报是否真的继续在 Microsoft Connect 中添加建议，因为它现在似乎都是 VS 2012，但我在[这里](http://visualstudio.uservoice.com/forums/121579-visual-studio/suggestions/3814347-add-bring-to-front-and-send-to-back-in-uml-dia)添加了一个请求。希望他们最终能解决这个问题。

# c# - 如何在 ServiceStack 的 onPost 方法中启动异步处理？

> ID：13150208
> 
> 赞同：1
> 
> 时间：2012-10-31T01:56:05.747
> 
> 标签：c#, asynchronous, backgroundworker, servicestack

我有一个简单的应用程序来处理从表单提交的文件。我正在尝试使用下面列出的代码异步运行文件处理。

不幸的是，在长时间运行`StaticProcessingMethod`完成后，返回了 http 响应。

提交时异步处理文件的正确方法是什么？

```
public override object OnPost(Item item)
{
    System.ComponentModel.BackgroundWorker worker = new System.ComponentModel.BackgroundWorker();
    worker.DoWork += new System.ComponentModel.DoWorkEventHandler(
        delegate(object o, System.ComponentModel.DoWorkEventArgs args)
        {
            StaticProcessingMethod(base.RequestContext.Files[0].InputStream);
        });

    worker.RunWorkerAsync();

    return new HttpResult("Processing started", ContentType.PlainText + ContentType.Utf8Suffix);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:15:38.237

我将有一个后台线程包装和注入作为一个依赖项，它只是将它需要处理的任务列表排队。例如：

```
public IBackgroundProcessor BackgroundProcessor { get; set; }

public object Post(Item item)
{
    BackgroundProcessor.Enqueue(
      new StaticProcessingTask(item, base.RequestContext.Files[0].InputStream));

    return new HttpResult("Processing started", 
        ContentType.PlainText + ContentType.Utf8Suffix);
} 
```

后台线程在 AppHost 中启动。将任务入队会将其入队并发队列并通知/唤醒后台睡眠线程，否则如果 bg 线程仍在运行，它会在处理完所有待处理任务后进入睡眠状态。

注意：上面的示例代码使用了[ServiceStack 改进的 New API](https://github.com/ServiceStack/ServiceStack/wiki/New-Api)。

# c++ - 如何在 CListCtrl 中将项目插入到第二列

> ID：13150209
> 
> 赞同：1
> 
> 时间：2012-10-31T01:56:11.710
> 
> 标签：c++, list, user-interface, mfc, edit

我是 MFC 和 BGCControlBar 的新手。
现在我打算使用定义为 CBCGPListCtrl ：

```
class BCGCBPRODLLEXPORT CBCGPListCtrl : public CListCtrl 
```

&

```
CBCGPListCtrl m_wndWatch; 
```

现在在演示代码中我打算更改：

```
int CWatchBar::OnCreate(LPCREATESTRUCT lpCreateStruct) 
{
    if (CBCGPDockingControlBar::OnCreate(lpCreateStruct) == -1)
        return -1;

    m_Font.CreateStockObject (DEFAULT_GUI_FONT);

    CRect rectDummy;
    rectDummy.SetRectEmpty ();

    // Create output pane:
        const DWORD dwStyle = WS_CHILD | WS_VISIBLE | WS_CLIPSIBLINGS | WS_VSCROLL | LVS_REPORT |  LVS_EDITLABELS ;

    m_wndWatch.Create (dwStyle, rectDummy, this, ID_LIST_1);
    m_wndWatch.SendMessage (LVM_SETEXTENDEDLISTVIEWSTYLE, 0,
                        LVS_EX_FULLROWSELECT | LVS_EX_GRIDLINES);
    m_wndWatch.InsertColumn (0, _T("Variable"), LVCFMT_LEFT, 100);
    m_wndWatch.InsertColumn (1, _T("Value"), LVCFMT_LEFT, 100);

    m_wndWatch.InsertItem (0, _T("m_nCount"));
    m_wndWatch.SetItemText (0, 1, _T("100"));

    m_wndWatch.SetFont (&m_Font);

    return 0;
} 
```

我得到的是一个列表（如图），我只能编辑第一列，数据不能保留。**如何编辑第二列文本并使数据可保留？**

![在此处输入图像描述](../Images/7ac757828ccaaa3adb88728b9fcf3df4.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:39:32.693

您需要一个网格控件而不是 CListCtrl（或派生类）。实际上，可以在其他专栏中添加对版本的支持，但这是一项繁琐的工作，而不是我向新手推荐的那种事情。

根据[他们网站的这个页面](http://www.bcgsoft.com/featuretour/tour194.htm)，他们有一个网格控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-12T19:34:31.187

为了使 MFC CListCtrl 可编辑，您需要做一些事情。这是一个非常广泛的概述，没有涉及太多细节：

1.  如上所述，这是一项相当多的工作，您需要从 CListCtrl 派生一个类，因为 CListCtrl 本身不允许您显式编辑所有列。

2.  您需要一个例程来计算您单击的特定单元格的行/列号，给定一个光标位置`CPoint`。

3.  在派生`CListCtrl`类中，您还需要一个方法来编辑选定的单元格，创建并显示`CEdit`适当大小的控件。

4.  创建一个派生`CEdit`控件，以便它发送`LVN_ENDLABELEDIT`消息并在完成时自毁。

可从此站点下载实现可编辑列表控件的 Visual Studio 2010 示例项目：

[http://www.technical-recipes.com/2014/making-a-mfc-list-control-editable/](http://www.technical-recipes.com/2014/making-a-mfc-list-control-editable/)

运行/调试示例后，您将获得一个示例对话框项目，该项目实现了可编辑的列表控件，如下所示：

![在此处输入图像描述](../Images/78d05df7eb526e4076e4f85dc1d69385.png)

# java - DiceRoll 程序使用数组，如何容纳多个玩家？

> ID：13150210
> 
> 赞同：1
> 
> 时间：2012-10-31T01:56:12.083
> 
> 标签：java

我正在尝试制作一个程序，该程序接受输入`#players`并`#dice`为每个玩家掷骰子任意次数。然后它输出卷和总数。

到目前为止，我已经设法开发了一个程序，该程序可以掷出与输入一样多的骰子，并将这些值存储在一个数组中，然后将其求和并输出。

不幸的是，我现在被困住了，因为当我试图让程序每次为新玩家再次执行此操作时，我真的不知道该怎么做。我知道它可能会与增量器一起使用，但我真的被复杂性弄得不知所措，甚至不知道我会在网上寻找什么。

这是我的代码：

```
package diceroll;

import java.util.ArrayList;
import java.util.Scanner;

public class DiceRoll {

public static void main(String[] args) {

int numplayers = 0, numdice = 0; // incrementers for #rolls and #players

  //  ArrayList<ArrayList> players = new ArrayList<ArrayList>();
 //   players.add(rolls);  /// adding list to a list
  //  System.out.println(players);

ArrayList<Integer> rolls = new ArrayList<>(); 

System.out.println("Enter the number of players.");
Scanner scan = new Scanner (System.in);
numplayers = scan.nextInt();

System.out.println("Enter the number of dice.");
numdice = scan.nextInt();

while (numdice > 0 ) {

Die die1 = new Die();
die1.roll();
rolls.add(die1.getFaceValue());

numdice--;}

System.out.println(rolls);

  //  sum for array, but i cant access the arraylength 

int total = 0;
for (int n : rolls)    //what does the colon : do ?
{total += n;

System.out.println("Dice total:" + total);
 }
} 
} 
```

还有一个基本`Die.java`类，它为面值分配一个随机数，并具有我用来随机化骰子的滚动方法。

输出：

运行：输入玩家人数。1 输入骰子的数量。4 [5, 4, 6, 6] 5 9 15

唯一的问题是改变玩家数量目前没有效果。21

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:14:29.003

`#dice`如果您想为所有玩家重复循环，您可能希望在 while 循环之外使用另一个循环。

-->这个`for(int i:rolls)`语句被读作`"for each integer 'i' in rolls"`这意味着，对于循环的每次迭代，rolls 中的值都分配给 y：

这相当于

```
for(int j=0;j<rolls.size();j++){
   i = rolls[j];
   // Other statements goes here.
} 
```

# php - Codeigniter 插入失败

> ID：13150217
> 
> 赞同：0
> 
> 时间：2012-10-31T01:56:44.733
> 
> 标签：php, mysql, codeigniter

我是codeigniter的新手。我正在尝试将 datat 插入 mysql 数据库到名为`class_record`. 我的控制器`add_record.php`编码如下：

```
class Add_record extends CI_Controller
    {
        function __construct()
        {
            parent::__construct();
        }

        function index()
        {
            $this->load->model('add_record_model');
        }
    } 
```

我的模型`add_record_model`如下：

```
class add_record_model extends CI_Model{

    function __construct(){
        parent::__construct();
    }
    function index(){
        $data = array(

            'roll_number' => 15,
            'student_name' => 'Dhrubajyoti Baishya',
            'branch_code' => 'CS'
        );

        $this->db->insert('class_record',$data);
    }
    } 
```

但是当我输入`http://localhost/codeigniter/index.php/add_record`url 时，数据并没有插入到数据库中。问题是什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:05:34.250

您实际上并没有在控制器中做任何事情，模型也没有您想象的索引功能。

你想要这样的东西：

```
class Add_record extends CI_Controller
{
    function __construct()
    {
        parent::__construct();
    }

    function index()
    {
        $this->load->model('add_record_model');
        $this->add_record_model->insertRecords();
    }
}

class add_record_model extends CI_Model{

function __construct(){
    parent::__construct();
}
function insertRecords(){
    $data = array(

        'roll_number' => 15,
        'student_name' => 'Dhrubajyoti Baishya',
        'branch_code' => 'CS'
    );

    $this->db->insert('class_record',$data);
}
} 
```

控制器按照它所说的做它控制的事情。通过加载模型，您所做的就是将模型函数暴露给控制器以直接使用。老实说，您也可以将数据从控制器传递给模型，您拥有的功能是一个很好的小测试功能，但真的没有。你真正想做的事情是这样的。

```
class Add_record extends CI_Controller
{
    function __construct()
    {
        parent::__construct();
    }

    function index()
    {
        $data = array(

        'roll_number' => 15,
        'student_name' => 'Dhrubajyoti Baishya',
        'branch_code' => 'CS'
    );
        $this->load->model('add_record_model');     
        $this->add_record_model->insertRecords($data);
    }
}

class add_record_model extends CI_Model{

function __construct(){
    parent::__construct();
}
function insertRecords($data){       

    $this->db->insert('class_record',$data);
}
} 
```

# java - OOP结构设计

> ID：13150219
> 
> 赞同：1
> 
> 时间：2012-10-31T01:57:11.380
> 
> 标签：java, oop, design-patterns, conceptual

我正在尝试设计“网络连接”以便于从服务器检索数据。但是，我面临一个设计问题。

我`NetworkUtil`将要使用的班级被设计为

```
class NetworkUtil
    public NetworkUtil(URL, resultType); // resultType might be XML or RAW
    public setListener(listener); // listener will notice when result has arrive
    public addPostData(key, value);
    public connect(); // connect start new thread, so result will shown in listener

interface NetworkUtilListener1
    public onNetworkFail();
    public onNetworkSuccess(URL, resultType, xml, raw);

interface NetworkUtilListener2
    public onNetworkFail();
    public onNetworkSuccessRAW(URL, resultType, raw);
    public onNetworkSuccessXML(URL, resultType, xml); 
```

一旦结果到达，我将检查 resultType 并使用该参数的结果。但是，在上面显示的 2 个示例（`NetworkUtilListener1`和`NetworkUtilListener2`）中，我考虑了将来使用更多`resultType`诸如 JSON、图像甚至我的自定义类型时的问题，因此我的团队可以轻松使用它。

`NetworkUtilListener1`将有长时间未使用的参数，例如

```
onNetworkSuccess(URL, resultType, raw, xml, json, image); 
```

这不是我认为的好设计。

`NetworkUtilListener2`将迫使使用它的具体类有很多空方法，因为大多数时候我们在每个项目上只喜欢 1 或 2 种类型的结果。

```
onNetworkSuccessRAW(URL, resultType, raw);
onNetworkSuccessXML(URL, resultType, xml);
onNetworkSuccessJSON(URL, resultType, json);
onNetworkSuccessImage(URL, resultType, image); 
```

任何人都可以在重新设计这个类结构时给我一些帮助，或者向我推荐我需要关注的设计模式。所以我可以有更好`NetworkListener`的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:01:02.000

使用多态性，而不是接收类型和结果：

```
public interface Result { ... }

public class XmlResult implements Result { ... } 
```

将来您可以根据需要添加任意数量。

```
public class JSonResult implements Result { ... } 
```

最后，你会有这个界面

```
interface NetworkUtilListener1
    public onNetworkFail();
    public onNetworkSuccess(URL, result); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:14:20.587

我不认为 N​​etworkUtil 应该担心格式类型。只需让 NetworkListener 将自身注册到 NetworkUtil 并让 NetworkUtil 成功通知侦听器。让 NetworkListener 担心类型，因为它们是唯一处理结果的。应该是这样的

```
class NetworUtil{
   registerListener( listener){ mylisteners.push( listener); }
   notifyListener(){ for(listener: mylisteners){ listener.onSuccess( myresult ); }
}

class Listener1{
   Listener1(){ registerWithNetworkUtil(); }
   void onSuccess(myresult){
       if(myresult.isXML){ parseXML(myresult); }
       else if(myresult.isJSON()){ parseJSON(myresult); }
       else if(myresult.isXXYYZZ()){ parseXXYYZZ(myresult); }
   }
} 
```

请注意，您可能需要一些方便的默认解析器，以便新的侦听器可以使用它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T02:35:45.360

这听起来像是经典[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)的解决方案：

让我们从重载 NetworkListener 方法开始：

```
interface NetworkListener {
    void onSuccess(XMLResult xml);
    void onSuccess(JSONResult json);
} 
```

然后，按照建议，让我们有几个结果的实现。他们每个人都能够通过调用适当的重载方法来通知侦听器。

```
interface Result {
    void notify(NetworkListener listener);
}

class XMLResult implements Result {

    @Override
    public void notify(NetworkListener listener) {
        listener.onSuccess(this);
    }

}

class JSONResult implements Result {

    @Override
    public void notify(NetworkListener listener) {
        listener.onSuccess(this);
    }
} 
```

现在，让我们看看示例网络侦听器实现的样子：

```
class SampleListner implements NetworkListener{

    @Override
    public void onSuccess(XMLResult xml) {
        // handle here
    }

    @Override
    public void onSuccess(JSONResult json) {
        // handle here

    }
} 
```

你的通知代码看起来有点像：

```
Result result = null;
for(NetworkListener listener: listeners){
   result.notify(listener);
} 
```

由于该模式严重依赖于方法重载，您可以添加一个接收 Result 对象的包罗万象的方法，这将保证如果创建了任何新的 Result 实现，如果您不添加进一步的重载，您仍然可以获得它们的默认处理方法。

# d - 从字符串 mixin 调用函数引用

> ID：13150220
> 
> 赞同：3
> 
> 时间：2012-10-31T01:57:23.147
> 
> 标签：d, dllexport

我已经导出了带有相当多样板的函数，并且正在尝试使用字符串混合来帮助隐藏混乱并对其进行修饰。问题是我不知道如何将匿名函数传递给字符串 mixin。如果可能的话，我想避免将函数写成字符串。

```
// The function that the anonymous function below ultimately gets passed to.
char* magic(F...)(string function(F) func) { ... }

string genDcode(string name, alias func)() {
    return xformat(q{
        extern(C) export char* %s(int blah) {
            // What would I inject into the string in place of 'func'
            // in order to call the 'func' passed into the template?
            return magic(func);
        }
    }, name);
}

// Calls a function to generate code to mix into the global scope.
// The anonymous function must allow abritrary parameters.
mixin(genDcode!("funcName", function(string foo, float bar) {
    return "Herpderp";
})); 
```

这当然不是全貌，大部分样板都被修剪了，但足以说明问题。我曾考虑将函数指针注入为 int，然后转换回可调用类型，但不出所料，您只能在运行时获取函数指针。

我尝试过 mixin 模板，它限制了函数传递问题，但链接器似乎无法找到从此类 mixin 生成的导出函数。它们似乎有一些额外的限定符，我不能在 DEF 文件中使用点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-04T22:27:15.643

老问题，但一个相对较新的特性可能有助于解决它： D 现在有一个 pragma(mangle) ，您可以将其放在 mixin 模板中以强制链接器使用特定名称：

```
mixin template genDcode(string name, alias func) {
          // pragma mangle is seen by the linker instead of the name...
        pragma(mangle, name) extern(C) export char* impl(int blah) {
            return magic(func);
        }
}

char* magic(F...)(string function(F) func) { return null; }

mixin genDcode!("funcName", function(string foo, float bar) {
     return "Herpderp";
}); 
```

# javascript - 从 Facebook 页面标签应用程序中删除滚动条？

> ID：13150221
> 
> 赞同：7
> 
> 时间：2012-10-31T01:57:29.467
> 
> 标签：javascript, html, css, facebook, facebook-apps

互联网上有数百篇关于此的帖子，其中很多都在 StackOverflow 上，但不幸的是，提到的解决方案似乎都不适合我。我花了 6 个小时的大部分时间修修补补，但没有成功。

这是我所拥有的：

*   我创建了一个 Facebook 应用程序并将其添加为页面选项卡。
*   我已在此处将应用程序添加到 Facebook 页面：[https ://www.facebook.com/pages/PARKROYAL-Darling-Harbour-Sydney/236917443012539?sk=app_195092900626979](https://www.facebook.com/pages/PARKROYAL-Darling-Harbour-Sydney/236917443012539?sk=app_195092900626979)

但我不能为我的生活设置 iFrame 的高度，以便我可以安全地移除滚动条！

这是我的 HTML 代码的结构：

```
<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="utf-8">

<title>PARKROYAL Magic Moments</title>

<link rel="stylesheet" href="css/normalize.css">
<link rel="stylesheet" href="css/style.css">

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>

</head>

<body>

<MAIN CODE HERE>

<div id="fb-root"></div>
<script src="http://connect.facebook.net/en_US/all.js"></script>
<script>
FB.init({
appId : '<APP-ID>',
status : true, // check login status
cookie : true, // enable cookies to allow the server to access the session
xfbml : true // parse XFBML
});
</script>

<script type="text/javascript">
window.fbAsyncInit = function() {
FB.Canvas.setSize( { height: 1642 } );
}
// Do things that will sometimes call sizeChangeCallback()
function sizeChangeCallback() {
FB.Canvas.setSize( { height: 1642 } );
}
</script>

</body>

</html> 
```

在我的 CSS 中，我还设置了 body { overflow:hidden }

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-31T05:49:13.577

Have you tried [FB.Canvas.setAutoGrow](https://developers.facebook.com/docs/reference/javascript/FB.Canvas.setAutoGrow/). You can use it like this:-

```
 <script type="text/javascript" src="http://connect.facebook.net/en_US/all.js"></script>
 <script type="text/javascript">
    window.fbAsyncInit = function() {
    FB.init({
      appId      : '235024806624460',
    });
    FB.Canvas.setAutoGrow();
    }
 </script> 
```

# html - 使复选框的大小更大

> ID：13150229
> 
> 赞同：-1
> 
> 时间：2012-10-31T01:58:28.927
> 
> 标签：html, css

我正在尝试使复选框更大。常规尺寸太小

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-11-28T09:51:38.463

尝试 CSS '转换'

```
input[type=checkbox] {
  -ms-transform: scale(2); 
  -moz-transform: scale(2); 
  -webkit-transform: scale(2); 
  -o-transform: scale(2); 
  transform: scale(2); } 
```

但它不适用于IE8。 [http://www.w3schools.com/cssref/css3_pr_transform.asp](http://www.w3schools.com/cssref/css3_pr_transform.asp)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T02:07:57.530

您可以使用图像来更改复选框的样式。

您还可以使用以下已在 Chrome 中测试的 CSS。但这在 Firefox 中不起作用：

```
input[type='checkbox'] {
    width: 4em;
    height: 4em;
} 
```

如需演示，请访问：[http ://www.456bereastreet.com/lab/styling-form-controls-revisited/checkbox/](http://www.456bereastreet.com/lab/styling-form-controls-revisited/checkbox/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T02:10:21.813

如果您想保持跨浏览器的兼容性，这很难实现。

您可能需要考虑一个输入替换插件，例如这个。

[http://blogs.digitss.com/javascript/jquery-javascript/jquery-fancy-custom-radio-and-checkbox/](http://blogs.digitss.com/javascript/jquery-javascript/jquery-fancy-custom-radio-and-checkbox/)

# string - Excel VBA - 从单元格中删除单个字符而不丢失剩余单元格内容的格式

> ID：13150231
> 
> 赞同：2
> 
> 时间：2012-10-31T01:58:43.347
> 
> 标签：string, excel, vba, replace, character

我正在尝试删除单元格中第一次出现的“<”和“>”，而不会丢失单元格其余内容的格式。

我在这里找了好几个地方，其他的都没有用。

这就是我想要做的：

说“A1”包含文本：

```
"This is <a> long string with several <occurrences> of a <special> character." 
```

无论如何，我要做的是从包含它们的第一个单词中删除“>”，在完美的世界中删除“<”，同时保持粗体格式以及“<”和“>”在包含它们的下一个单词上。

这只是在我遇到问题的代码之前执行的其他代码。

```
inTx = Range("A2").Value
outTx = Replace(inTx, "Init_Day", Range("A3").Value)
Range("A2").Value = outTx 
```

它将`<placeholder>`文本替换为实际文本，在这种情况下为两位数。

这是对我不起作用的代码：

```
SearchString = Range("A2").Value
Char1 = "<"
Char2 = ">"
For i = 1 To Len(SearchString)
    If Mid(SearchString, i, 1) = Char1 Then
        startPos = i
        Exit For
    End If
Next i
For i = 1 To Len(SearchString)
    If Mid(SearchString, i, 1) = Char2 Then
        endPos = i
        Exit For
    End If
Next i
Range("A2").Characters(startPos, endPos - startPos).Font.Bold = True
Range("A2").Characters(startPos - 1, 1).Delete 
```

在我到达最后一行之前，所有代码都可以正常工作：

```
Range("A2").Characters(startPos - 1, 1).Delete 
```

然后什么也没有发生。

我什至尝试过：

```
Range("A2").Characters(startPos - 1, 20).Delete 
```

依然没有...

我知道这应该很容易，但我似乎无法弄清楚。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:43:56.797

以下代码：

```
Sub Foo()
    Const Char1 As String = "<", Char2 As String = ">"
    Dim SearchString As String
    Dim i As Integer, startPos As Integer, endPos As Integer
    SearchString = Range("A2").Value
    startPos = InStr(SearchString, Char1)
    endPos = InStr(SearchString, Char2)
    Range("A2").Characters(startPos, endPos - startPos).Font.Bold = True
    Range("A2").Characters(startPos, 1).Delete
    Range("A2").Characters(endPos - 1, 1).Delete
End Sub 
```

变成这样：

`Some <bold> text I just <made> up.`

进入这个：

```
我刚刚<制作>了一些粗体文字。
```

那是你要找的吗？

# c# - 如何在 Canvas 上绘制文本

> ID：13150236
> 
> 赞同：1
> 
> 时间：2012-10-31T01:59:32.270
> 
> 标签：c#, windows-8, microsoft-metro

目前，我可以`Shape`通过`Canvas`

```
canvas.Children.Add(line);
canvas.Children.Add(polyLine);
//... 
```

但是，我们如何在其上绘制具有各种字体大小、字体类型……的文本呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T16:04:13.770

添加`TextBlock`到画布的孩子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T06:11:55.417

[在此示例](http://code.msdn.microsoft.com/InkPen-sample-in-CSharp-189ce853)中，它们不是在画布上绘图，而是检测指针移动，而不是在画布上添加线条形状。所以我认为你不能直接在画布上画画。还有一篇关于[绘图上下文](http://msdn.microsoft.com/en-us/library/system.windows.media.drawingcontext.aspx)的帖子，所以你可能想看看它。

# javascript - jQuery 在 Safari 中的行为不端

> ID：13150240
> 
> 赞同：0
> 
> 时间：2012-10-31T02:00:01.413
> 
> 标签：javascript, jquery, html, safari

我遇到了一个问题，即某些代码在所有浏览器中都能完美运行，直到我来到 Safari 时它给我带来了问题。我继承了这段代码，而且我不是 jQuery 专家，所以不用说我有点困惑：

```
var xt_begin=$('#begin')[0];            
xt_begin.currentTime = 0; 
xt_begin.play(); 
```

“#begin”是在使用此代码的 HTML 中设置的音频元素，并且 .play() 函数位于正在使用的 jQuery 插件中（[链接到插件](http://code.google.com/p/jquery-timer/)）。

在除 Safari 之外的所有浏览器中，播放被定义为好像 xt_begin 是该计时器类的对象。然而，在 safari 中，它仍然未定义并且代码停止工作。我不知道这是如何发生的或如何解决它。如果需要，我可以发布更多代码，任何帮助将不胜感激。

**更新

经过进一步调查，事实证明它是一个 DOM 元素，而且我有点厚。但是，出于某种原因，Safari 似乎在识别音频元素时遇到了问题。它将其标识为“对象 HTMLelement”，而 Firefox 将其显示为“对象 HTMLAudioElement”。我仍然对这个感到困惑。

**解决了

显然 Safari 需要在您的桌面上安装 quicktime 才能使用音频元素。这将使我正在修复的这个应用程序完全没用，但至少我现在知道了。感谢各位的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:04:48.910

真的只是一个评论。该声明：

```
var xt_begin = $('#begin')[0]; 
```

实际上与以下内容相同：

```
var xt_begin = document.getElementById('begin'); 
```

`xt_begin`DOM 元素或`undefined`(jQuery) 或`null`(plain JS)也是如此。它是哪一个？

无论如何，您可能应该遵循：

```
if (xt_begin) {
  /* do stuff with xt_begin */
} 
```

以避免错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:04:54.483

尝试：

```
var xt_begin = document.getElementById('begin'); 
```

而不是 jQuery 行。这适用于所有浏览器，并且至少会告诉您是否有 jQuery 问题或 Safari/网页问题。

# c# - 通过在 TCPClient 中使用 StreamReader.ReadLine() 从 TCPServer 缓冲区读取消息（数据）（ReadLine() 直到断开连接才会返回）

> ID：13150244
> 
> 赞同：0
> 
> 时间：2012-10-31T02:00:46.157
> 
> 标签：c#, tcpclient, streamreader, readline, tcpserver

![创建 TCPServer 的 hercules 程序](../Images/344be068b99269a7fef4111f872227f5.png) ![我的表格](../Images/96fbb6408778ad88378d2a67295c0c51.png)

我的方法有问题。我`StreamReader.ReadLine()`写了一个 C# 程序，但只有 TCPclient 端。我正在使用 Hercules 程序来创建 TCPServer。我输入了端口号并建立了连接。然后我运行我的程序并单击连接按钮。然后，我与 TCPServer 建立了联系。

我将数据从 TCPClient 发送到 Hercules(TCPServer) 没有问题。如图所示，我将字符串输入到“Entered to Send”EditText，然后单击`Send`按钮并发送字符串。（我们可以从*Received data*部分观察发送数据。）

到这里为止，我没有问题。发送部分后，我无法将数据从 hercules(TCPServer) 发送到 TCPClient。为了发送数据，我将数据写入 ***发送***部分并单击`Send`按钮。之后，要查看即将到来的数据，您应该单击`Show`按钮.....问题就在这里。我无法从*ReadStream Buffer*中读取数据。我调试了我的程序，发现有问题的部分是：

```
private void btnShow_Click(object sender, EventArgs e)
    {
        try
        {
            string gelen;
            gelen = read_stream.ReadLine();
            txtReceive.Text = gelen;
            MessageBox.Show(gelen, "you have message from server");
        }
        catch
        {
            MessageBox.Show("message could not taken !!!");
        }
    } 
```

在该`try`部分内线；

```
gelen = read_stream.ReadLine(); 
```

有问题 .ReadLine() 没有从缓冲区读取数据。这是有趣的部分，当您发送数据并单击`Show`按钮时，程序会冻结，但如果您`hercules.png`通过单击`Close`按钮关闭连接，`read_stream.ReadLine();`则会获取数据并放入***Received:*** EditText。

*   为什么在与 TCPServer 断开连接后需要数据？
*   可能是`\r\n` 字符有问题？
*   我以为它在等待下一个角色。所以，当我断开连接时它起作用了，因为它意识到三个不再是字符。我的问题是：

如何使用*read_stream.ReadLine();* 采取不断开连接发送数据？

```
 using System;
    using System.Collections.Generic;
    using System.ComponentModel;
    using System.Data;
    using System.Drawing;
    using System.Linq;
    using System.Text;
    using System.Windows.Forms;

    using System.Net;
    using System.Net.Sockets;

    using System.Threading;
    using System.Net.Sockets;
    using System.IO;
    using System.Drawing;
    using System.Collections;
    using System.ComponentModel;
    using System.Windows.Forms;
    using System.Data;

    namespace CSharpVeriDenemesi
    {
    public partial class Form1 : Form
    {
        //Burda server da tanımladıklarımızdan farklı olarak TcpClient sınıfı ile serverdan gelen bilgileri alıyoruz
    public TcpClient Client;
    private NetworkStream network_stream;
    private StreamReader read_stream;
    private StreamWriter write_stream;

    private string local_host = "localhost";
    private int port_number = 8001;
    public TcpListener listener;
    // IPAddress localAddress = IPAddress.Parse("127.0.0.1");

    public Form1()//form oluşunca otomatik oluşturulan fonksiyon
    {
        InitializeComponent();
    }

    private void btnConnect_Click(object sender, EventArgs e)//CONNECT
    {
        try
        {
            Client = new TcpClient(local_host, port_number);//İlk parametre bilgisayar adı ikincisi ise port numarasıdır.
            MessageBox.Show("Baglandi");
        }
        catch
        {
            MessageBox.Show("Baglanamadi");
            return;
        }
        network_stream = Client.GetStream();
        read_stream = new StreamReader(network_stream);
        write_stream = new StreamWriter(network_stream);

    }

    private void btnDisconnect_Click(object sender, EventArgs e)//DISCONNECT
    {
        txtSend.Text = "Disconnect clicked";
        try
        {
            write_stream.Close();
            read_stream.Close();
            network_stream.Close();
        }
        catch
        {
            MessageBox.Show("Düzgün kapatilamiyor !!!" );
        }
    }

    private void btnReset_Click(object sender, EventArgs e)//send ve receive text.box'larını resetliyor.
    {
        txtSend.Text = "";
        txtReceive.Text = "";     
        MessageBox.Show("Reset'e basıldı");          
    }

    private void Form1_Load(object sender, EventArgs e)//sayfa ilk açıldığında olcaklar için açılan dosya
    {

    }

    private void btnSend_Click(object sender, EventArgs e)//veriyi server'a gönderiyor
    {

        try
        {
            write_stream.WriteLine(txtSend.Text);
            write_stream.Flush();  //veriyi gönderiyor
            MessageBox.Show("Veri gönderildi");
        }
        catch {
            MessageBox.Show("Veri gönderilmedi !!!");          
        }            
    }

    private void btnShow_Click(object sender, EventArgs e)
    {
        try
        {
            string gelen;
            gelen = read_stream.ReadLine();
            txtReceive.Text = gelen;
            MessageBox.Show(gelen, "you have message from server");
        }
        catch
         {
            MessageBox.Show("message could not taken !!!");
        }
    }
    }
    } 
```

这是我的 main.cs 我忘了添加它。您可以编写它并尝试我的项目...注意：这是可移植的 hercules 的链接，您可以轻松运行它 [ [http://www.hw-group.com/products/hercules/index_en.html]](http://www.hw-group.com/products/hercules/index_en.html]) [3](http://www.hw-group.com/products/hercules/index_en.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T09:10:34.870

如果您的服务器端不使用，那么在使用 ReadLine() 函数时，您将始终需要在客户端**`Stream.WriteLine("something..");`**等待。**`End of line char (\r or \n or \r\n)`**

所以 ReadLine() 只有在连接关闭=>你的问题时才会完成。

你的代码：

```
 write_stream.WriteLine(txtSend.Text);
        write_stream.Flush();  //veriyi gönderiyor 
```

用于客户端，用于反馈服务器，与服务器发送数据没有任何意义。

通过逐个字符读取字符来尝试您的客户端，或使用 Read() 和特定长度的缓冲区。

# java - 如何在java中按日期自动制作交易代码？

> ID：13150245
> 
> 赞同：-5
> 
> 时间：2012-10-31T02:00:59.183
> 
> 标签：java, mysql

我很困惑如何根据日期创建java和mysql中的事务代码，帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:21:59.883

您只需要从 System.dat 获取日期值。有一些方法可以得到它：

在 Java 中获取日期 归档在：Java，编程 — 发表评论
2011 年 11 月 30 日

我给你举2个例子。

示例 1：

```
SimpleDateFormat df = new SimpleDateFormat("dd/MM/yyyy");
Calendar cal = Calendar.getInstance();
System.out.println(df.format(cal.getTime()));

Or youcan use Date instead of Calendar, like this:

SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy");
Date dt = new Date();
System.out.println(sdf.format(dt)); 
```

您可以操纵日期格式。

之后，您可以将该值操纵为您想要的交易代码之类的东西。喜欢

```
Int index = 0

String transcode;

transcode = sdf &index

index +=1 
```

只是更有创意。

# javascript - 使用 Core(Mediator) / Sandbox(Facade) / Module 模式创建松散耦合的多页面 JS 应用程序——建议？

> ID：13150251
> 
> 赞同：22
> 
> 时间：2012-10-31T02:02:43.850
> 
> 标签：javascript, module, javascriptmvc

我正在构建一个多页 javascript 应用程序。我已经阅读了很多设计模式，并使用松散耦合（发布/订阅事件）的核心/外观/模块方法创建应用程序。

我有一个非常好的系统，可以在部署时将我的所有模块文件和相关依赖项缩小并合并到一个外部 javascript 文件中。为我的应用程序最小化额外的 HTTP 请求是一个设计目标——因此我对 AMD（异步模块定义）不太感兴趣。

我正在使用 Nicholas Zakas 的演示文稿 **Scalable JavaScript Application Architecture中界定的指南**

[http://www.youtube.com/watch?v=vXjVFPosQHw](http://www.youtube.com/watch?v=vXjVFPosQHw)

&&

Addy Osmani 的**大型 JavaScript 应用程序架构模式** [http://addyosmani.com/largescalejavascript/](http://addyosmani.com/largescalejavascript/)

&&

这个高级教程，来自 Nettuts 的 Andrew Burgess，**编写模块化 JavaScript** [http://marketplace.tutsplus.com/item/writing-modular-javascript/128103/?ref=addyosmani&ref=addyosmani&clickthrough_id=90060087&redirect_back=true](http://marketplace.tutsplus.com/item/writing-modular-javascript/128103/?ref=addyosmani&ref=addyosmani&clickthrough_id=90060087&redirect_back=true)

我的问题是关于如何管理此应用程序的不同页面及其相关模块的建议。我还使用 Backbonejs 的路由器类 w/ballupton 的[History.js](https://github.com/balupton/History.js/)库来操作 HTML5 历史/状态 API 并在不刷新的情况下动态加载页面，同时保持对不支持 HTML 状态 API 的旧浏览器的向后兼容性。我的所有页面都共享一个通用代码库（单个缩小和压缩的 js 文件）。

这是我正在考虑在我的应用程序中使用的结构的概述： ![在此处输入图像描述](../Images/1f68b387ba61923a5ad4663f964d92c3.png)

它本质上是一种混合方法。上半部分由 Core/Facade/Module 模式和离散的模块组成，这些模块不直接相互交互并通过外观发布/订阅通知。

下半部分由我提出的应用程序结构组成，当状态/url改变时通知“主控制器”，主控制器执行任何全局操作（例如，如果尚未初始化，则初始化我的 UI 的标题和侧边栏菜单）并指示相关子控件运行它的 init() 方法（以及调用 destroy(); 在先前加载的任何控制器上）。每个子控制器（与 ex：主页、日历页面、预订页面等相关）从可用模块池中挑选模块并初始化它们。

这是一个好方法还是我走错了路？我可以看到模块仍然相互独立，这有利于可扩展性。

我还考虑过将路由器和控制器视为离散模块并让它们发布/订阅核心，并且每个控制器以某种方式初始化其页面所需的必要模块。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-02T20:02:52.723

我们为保持历史平稳运行所做的一件事是首先更改 URL。在更改 URL 时会触发事件，路由器将解析 url 然后找出要做什么。此事件也会在页面加载时自动触发。如果您单击一个链接，它只会更改 URL，这相当简单，并且将链接/按钮与应用程序逻辑完全分离。这似乎对我们的应用程序很有效。我们使用了 JQM，但我们放弃了他们的大部分路由器，因为我们从一些 XML 文件中读取了大部分指令，并且没有一堆 HTML 页面可以加载到主视口区域。

我经常看到主干应用程序使用路由器作为核心/中介。这是一个好主意。您可以简单地监听 URL 的更改事件，然后适当地更改页面。这个 Mediator 应该是一个单例，尽管单例更难进行单元测试。

我不一定同意 Backbone 的观点是它对“视图”的定义。视图有点像控制器中的一个动作（从某些角度来看）。那时我们在我们的应用程序中增加了一层分离。我们的视图向模板文件发出 ajax 请求，这些模板文件填充了一些 JSON 和 handlebars.js。我会说你的标题/侧边栏应该只是模板。如果你需要刷新它们，那么看看你可以如何做非常简单，否则你正在考虑创建 4 个新模块：列表的集合、每个项目的模型、集合视图和模型视图。我会将模板与一些更高级别的视图更紧密地结合起来，直到它们需要进一步分解（例如，一些“应用程序/主视图”）。

有了这个模板层，您也可以在不重新编译的情况下进行表面更改，这很好。任何时候您可以将内容放入“元”中，这都是一种胜利（除非它要求您阅读 XML (ha)）。作为奖励，您还可以单独缓存模板（或单独缓存它）。

不过，您的架构看起来确实不错，并且是解决问题的有效方法。我要给出的一个提示是不要预先设计。迭代是最好的。您将需要重构。无法提前 3-6 个月预见什么会使您的申请流程更加顺畅。

## 2013 年 12 月 18 日更新

现在有一天，我们正在使用木偶和更多的 osmani 技巧。在上述项目之上，我们使用 AMD 的替代格式：

```
define(function(require) {
    var myTemplate = require('hb!mytemplate.handlebars'),
        view = require('myview');
    ...
}); 
```

我们还将 marionette 应用程序类与提供请求/响应层的 wreqr 结合使用。这允许我们干净地设置应用程序范围的对象。它还允许我们在不明确说明类名的情况下定义类。这是沙盒的一个很好的方法。例如：

```
this.app.setHandler('CanvasClass', function() {
    return RaphaelCanvasView;
});

// elsewhere

this.app.request('CanvasClass').text('123', {x:1, y:2}); 
```

这一切似乎都很顺利。

您还应该检查 aura js 和 Web 组件。我们的目录结构有点模仿/预测这些概念，但还没有投资它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T15:35:58.323

我认为这是一个很好的方法。我一直在 2 个巨大的商业网络应用程序中开发类似的东西（减去主干，并使用自定义历史管理器）并且效果很好。我也没有使用 AMD，所有交互都由 pub/sub 处理。我最好的灵感之一（我相信你已经知道）是：[https ://github.com/aurajs/aura](https://github.com/aurajs/aura)

# java - 在 HTML 中查找包含文章内容的文本区域

> ID：13150253
> 
> 赞同：0
> 
> 时间：2012-10-31T02:03:00.873
> 
> 标签：java, html, string, web-scraping

最近我想通过 Java 获取 HTML 源代码中的信息。基本需求是获取 HTML 的主要内容区域。例如，以下是 HTML 源代码示例：

```
<html> 
  <head>
  <tilte>
     chinese charactor --中文
   <title>
  </head> 

      <body>
        <div>
        this is something area including Chinese charactor.,like meun I don't need,
        </div>
        <div>
   this is something area including Chinese charactor,like ads I don't need, 
        </div>
        <div>  
 this is  main content, include the content I need. almost every content is filled by         many  Chinese charactor.Like: 好好学习，天天向上。 我爱stackoverflow.谢谢你的帮助，非常感谢！
        </div>
        <div>  
 this is foot area, also including Chinese charactor ,but I don't need.
         </div>
        </body>
   </html> 
```

这个 HTML 源代码很简单；有许多不同和复杂的来源。我想通过java解析包含主要内容的div或其他元素区域。我想要的结果是：

```
<div>  
   This is main content, include the content I need. almost every content is filled by         many Chinese character like: 好好学习，天天向上。 我爱stackoverflow.谢谢你的帮助，非常感谢！
   </div> 
```

有数以万计的div，里面有不同的内容，div id是未知的或不同的。div 有许多不同的条件，例如 p 标签。有没有办法判断汉字的外观或分布来解析内容？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:23:37.483

我不能说我很确定你的目标是什么，但一个好的起点可能是在 Apache 的 HTTPComponents 包中。那里有很多工具可以发出 http 请求并将数据返回到字符串缓冲区（我认为你想要的）

在这里查看：

> [http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html#d5e43](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html#d5e43)

此外，在 HTTPComponents 主页上，大多数教程都有中文翻译——你知道，如果这对你有用的话:D

> [http://hc.apache.org/](http://hc.apache.org/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:13:23.590

我不能说我有信心理解这个问题，但您似乎想通过 Java 抓取 HTML 页面中的某个 div？

我必须这样做才能从遗留系统中抓取一些数据来测试新系统 - 看看[http://htmlunit.sourceforge.net/](http://htmlunit.sourceforge.net/)。基本上，它允许您像在浏览器中一样点击您想要的页面（所以即使您通常必须填写表格才能到达该页面，您也可以这样做），然后抓取不同部分的内容以多种不同的方式创建页面——例如，您可以获得所有 div 的集合，然后选择第三个，或者选择具有正确 CSS 类的 div，或者只使用 XPath。

# asp.net - 如何正确地将引导样式设置为寻呼机 Gridview ASP.Net

> ID：13150254
> 
> 赞同：2
> 
> 时间：2012-10-31T02:03:04.553
> 
> 标签：asp.net, gridview, twitter-bootstrap

我有一个 gridview 并想在该 gridview 中实现引导程序，我已经成功使用 Header 和 RowItem，但在 Pager Grid 视图中失败了。

**这是我的代码：**

```
<asp:GridView ID="GridNews" runat="server"  AllowPaging="True" PageSize="2" onpageindexchanging="GridNews_PageIndexChanging"
  CssClass="table table-hover table-striped table-condensed" GridLines="None"
  AutoGenerateColumns="False">
  <Columns>
    <asp:BoundField DataField="news_id" HeaderText="ID" Visible="false" />
    <asp:BoundField DataField="date" HeaderText="Date" ItemStyle-Width="50%" />
    <asp:TemplateField HeaderStyle-HorizontalAlign="Center" HeaderStyle-VerticalAlign="Middle" HeaderText="Title" ItemStyle-HorizontalAlign="Center" >
    <ItemTemplate>
      <asp:HyperLink ID="LinkEvents" runat="server" Target="_blank" navigateUrl='<%# "EventsDetail.aspx?choice=investor&ev=" + Eval("news_id") %>' Text='<%# Eval("title") %>'> 
       </asp:HyperLink>
    </ItemTemplate>
    </asp:TemplateField>
  </Columns> 
```

我错过了什么吗？

请帮助我，谢谢

# python - ipython：使用 %run 时重新导入模块

> ID：13150259
> 
> 赞同：18
> 
> 时间：2012-10-31T02:03:30.317
> 
> 标签：python, import, module, ipython

我喜欢 ipython，但我发现了 %run 的一个问题：当重复调用 %run 时，导入的模块不会重新加载。

假设文件 ex1.py 包含以下行：

```
import ex2
ex2.x.append(1)
print ex2.x 
```

文件 ex2.py 包含：

```
x = [] 
```

现在，从命令行运行 python ex1.py 每次都会重复打印 [1]。但是`%run ex1.py`从 ipython 内部调用会重复打印 [1]、[1,1]、[1,1,1] 等。这是因为模块 ex2.py 没有重新加载。所以我们有一个问题：ipython run-script 协议没有反映“现实世界”的行为。

笔记：

```
%load_ext autoreload
%autoreload 2 
```

没有*帮助*。仅当对 ex2.py 文件进行了更改时，这些行才会重新加载 ex2.py。如果我们不做任何更改，或者只对 ex1.py 进行更改，我们会得到不希望的行为。

有什么方法可以让 %run 的行为像这里的命令行一样吗？这似乎是使用 ipython 作为脚本测试环境的真正缺陷。（或者也许道德是一个模块不应该写入另一个模块的命名空间？）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-31T03:07:31.960

`%run ex1.py`（或任何与此相关的脚本）即使将 autoreload 扩展设置为 2，也不会对导入的模块进行深度重新加载。这是该`%run`命令在 ipython 中的工作方式的“缺陷”。

您将不得不明确调用

```
dreload(ex2) 
```

在再次执行之前进行深度重新加载`%run ex1.py`。

请参阅 - [http://ipython.org/ipython-doc/dev/api/generated/IPython.lib.deepreload.html](http://ipython.org/ipython-doc/dev/api/generated/IPython.lib.deepreload.html)

将来可能有计划`%run`自动进行深度重新加载，您可以找到这个问题，在撰写本文时，这仍然是一个悬而未决的问题，由用户在此处提出建议 - [https://github.com/ipython/ipython/问题/461](https://github.com/ipython/ipython/issues/461)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-18T17:04:41.927

我遇到了同样的问题。在我看来，这是 ipython 运行命令的不良影响——它不会重新加载导入的模块。

作者是对的：如果对ex2.py进行了更改，以下命令将有助于重新加载

```
%load_ext autoreload
%autoreload 2 
```

我最简单的解决方法是每次**修改导入的模块（在本例中为 ex2.py），并在 ipython 中执行以下命令**

```
%load_ext autoreload
%autoreload 2
%run ex1.py 
```

这有助于重新加载 ex2.py。

请注意，每次执行上述 3 行之前，都必须修改 ex2.py。只有这样才能重新加载模块 ex2。

# javascript - jQuery分页转到输入值更改的页面

> ID：13150264
> 
> 赞同：1
> 
> 时间：2012-10-31T02:04:04.910
> 
> 标签：javascript, jquery, input, pagination

我正在为我的网站创建一些分页，并希望使用输入元素在页面之间导航。

像下面的例子：

![分页示例](../Images/df806af369f6711daa74425a456a51d2.png)

输入需要按下“return”键才能触发脚本。

如果输入的值不在范围内，则会触发警报。例如，如果有 32 页，“请输入 1 到 32 之间的值”

这可以通过检测页面范围内的值变化并重定向到该页面来使用 jQuery 或 javascript 来完成吗？

我正在尝试在 Getty Images 上创建相同的设备：

[http://www.gettyimages.com.au/Search/Search.aspx?contractUrl=2&language=en-US&family=creative&p=ball&assetType=image&clarification=ball%3A60847](http://www.gettyimages.com.au/Search/Search.aspx?contractUrl=2&language=en-US&family=creative&p=ball&assetType=image&clarification=ball%3A60847)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-01T11:19:47.530

您可以使用*get*表单和不带 javascript 的 html5 来执行此操作：

```
<form class="pageNumberForm" type="GET">
    <input type="number" name="page" class="pageNumber" min="1" max="6" value="1" />
</form>​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

如果您使用的是 php，您可以填写最大页面和当前页面：

```
<form class="pageNumberForm" type="GET">
    <input type="number" name="page" class="pageNumber" min="1" max="[page maximum]" value="[current page]" />
</form>​ 
```

您可以添加 jquery validate 来验证不支持 html5 的浏览器的表单。

**编辑1：**

或者你可以添加这个 jquery 代码来做一些简单的验证，就像 getty 一样：

```
$('.pageNumberForm').submit(function() {
    var pageInput = $(this).children('.pageNumber').first();
    var pageInputValue = pageInput.val();

    if (pageInputValue < pageInput.attr('min') || pageInputValue > pageInput.attr('max') || !pageInputValue.match(/\d+/)) {
        alert('Please enter a value between ' + pageInput.attr('min') + ' and ' + pageInput.attr('max'));
        return false;
    }
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:14:14.510

要通过“return”键运行页面更改脚本，您应该使用`$('input').on('keypress')`事件并检查`event.which`属性（“return”应该是“13”）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-01T23:28:20.290

我的网站是 ASP，我使用了以下代码，它现在可以工作了。

```
<form type="get" onchange="return false">
<input type="number" name="page" id="page" min="1" max="5" value="1" /> 
```

我会尝试为不支持 HTML5 的浏览器添加一些 jQuery 验证，但它适用于 IE8，所以我对此很满意。

# python - 将winsound转换为linux平台？

> ID：13150267
> 
> 赞同：3
> 
> 时间：2012-10-31T02:04:48.503
> 
> 标签：python, linux

在不久前我正在编写的聊天脚本上，我使用 winsound python 库在收到新消息时播放“叮”声（ding.wav）。现在我想知道如何仅使用 .ogg 音频文件才能使这项工作适用于 linux。代码如下：

```
import sys
import util
import thread
import socket
import winsound

class ClientSocket():

rbufsize = -1
wbufsize = 0

def __init__(self, address, nickname=''):
    if type(address) == type(()) and type(address[0]) == type('') and type(address[1]) == type(1):
        pass
    else:
        print ('Address is of incorrect type. \n' +
              'Must be (serverHost (str), serverPort (int)).')
        sys.exit(1)

    if nickname:
        self.changeNick(nickname)
    else:
        self.changeNick(raw_input('Nickname: '))

    self.prompt_on = False
    self.address = address

def connect(self):
    self.connection=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    self.connection.connect(self.address)
    self.rfile = self.connection.makefile('rb', self.rbufsize)
    self.wfile = self.connection.makefile('wb', self.wbufsize)

    self.wfile.write('/nick ' + self.nickname + '\n')

def serve_forever(self):
    self.connect()

    thread.start_new_thread(self.acceptinput,())

    line = ""
    while line not in ('/exit','/quit', '/q'):
        self.prompt_on = True
        line = raw_input(self.prompt)
        self.prompt_on = False
        if line[:2] == '/n' or line[:5] == '/nick':
            self.changeNick(line.split(' ', 1)[1].strip())
        self.wfile.write(line + '\n')

    self.close()
    self.connection.shutdown(socket.SHUT_RDWR)
    self.connection.close()

def changeNick(self, newNick):
    self.nickname = newNick
    self.prompt = self.nickname+': '
    self.backspace = '\b' * len(self.prompt)

def acceptinput(self):
    while 1:
        data = self.rfile.readline().strip()
        if data:
            self.writedata(data)
            if 'Nickname successfully changed to' in data:
                self.changeNick(data.split('"')[1])

def writedata(self, data):
    if self.prompt_on:
        output = data if len(data) >= len(self.prompt) else data + ' ' * (len(self.prompt) - len(data))
        winsound.PlaySound("ding.wav", winsound.SND_FILENAME)
        sys.stdout.write(self.backspace + output + '\n' + self.prompt)
        sys.stdout.flush()
    else:
        print data

def close(self):
    if not self.wfile.closed:
        self.wfile.flush()
    self.wfile.close()
    self.rfile.close()

def main():
serverHost = raw_input('Server IP/Hostname: ')
if not serverHost:
    serverHost = util.getIP()
else:
    serverHost = socket.gethostbyname(serverHost)

serverPort = input('Server Port: ')
address = (serverHost, serverPort)

client = ClientSocket(address)
print 'Connecting to server on %s:%s' % (serverHost, serverPort)
client.serve_forever()

if __name__ == '__main__':
main() 
```

如果有人可以帮助我将其转换为播放 .ogg 文件，那就太棒了:)

谢谢，肖恩。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-11T21:48:04.480

最后，我最终使用了 pygame 库：

`import pygame`

`pygame.init()`

* * *

`pygame.mixer.music.load("ding.ogg")`

`pygame.mixer.music.play()`

# ruby-on-rails - FactoryGirl 和 Rspec 测试中 attributes_for 的含义

> ID：13150272
> 
> 赞同：39
> 
> 时间：2012-10-31T02:04:58.160
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rspec, attributes, factory-bot

浏览有关控制器测试的教程，作者给出了一个 rspec 测试测试控制器动作的示例。`attributes_for`我的问题是，他们为什么要使用这种方法`build`？`attributes_for`除了返回值的散列之外，没有明确的解释为什么使用它。

```
it "redirects to the home page upon save" do
  post :create, contact: Factory.attributes_for(:contact)
  response.should redirect_to root_url
end 
```

教程链接在这里：[http](http://everydayrails.com/2012/04/07/testing-series-rspec-controllers.html) ://everydayrails.com/2012/04/07/testing-series-rspec-controllers.html示例在开头主题部分`Controller testing basics`

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2012-10-31T02:14:47.373

`attributes_for`将返回一个哈希，而`build`将返回一个非持久对象。

给定以下工厂：

```
FactoryGirl.define do
  factory :user do
    name 'John Doe'
  end
end 
```

这是结果`build`：

```
FactoryGirl.build :user
=> #<User id: nil, name: "John Doe", created_at: nil, updated_at: nil> 
```

和结果`attributes_for`

```
FactoryGirl.attributes_for :user
=> {:name=>"John Doe"} 
```

我发现`attributes_for`对我的功能测试很有帮助，因为我可以执行以下操作来创建用户：

```
post :create, user: FactoryGirl.attributes_for(:user) 
```

使用时`build`，我们必须手动从`user`实例中创建属性哈希并将其传递给`post`方法，例如：

```
u = FactoryGirl.build :user
post :create, user: u.attributes # This is actually different as it includes all the attributes, in that case updated_at & created_at 
```

当我直接想要对象而不是属性哈希时，我通常使用`build`&`create`

如果您需要更多详细信息，请告诉我

# node.js - 快速请求被调用两次

> ID：13150277
> 
> 赞同：16
> 
> 时间：2012-10-31T02:05:50.773
> 
> 标签：node.js, http, express

为了学习 node.js，我正在创建一个小应用程序，它获取一些存储在 mongoDB 中的 rss 提要，处理它们并从这些提要中创建一个提要（按日期排序）。

它解析约 50 个 rss 提要的列表，其中包含约 1000 个博客项目，因此解析整个内容的时间很长，所以我放了以下内容`req.connection.setTimeout(60*1000);`以获得足够长的时间来获取和解析所有提要。

一切都运行得很好，但是请求被调用了两次。（我检查了wireshark，我不认为这与favicon有关）。

我真的不明白。

你可以在这里测试自己：http: [//mighty-springs-9162.herokuapp.com/feed/mde/20](http://mighty-springs-9162.herokuapp.com/feed/mde/20)（它应该创建一个包含最近 20 篇关于“mde”的文章的 rss 提要）。

代码在这里：[https ://github.com/xseignard/rss-unify](https://github.com/xseignard/rss-unify)

如果我们专注于有趣的部分：

我有这样定义的路线：`app.get('/feed/:name/:size?', topics.getFeed);`

是`topics.getFeed`这样的：

```
function getFeed(req, res) {
  // 1 minute timeout to get enough time for the request to be processed
  req.connection.setTimeout(60*1000);   

  var name = req.params.name;
  var callback = function(err, topic) {
  // if the topic has been found
  if (topic) {
    // aggregate the corresponding feeds
    rssAggregator.aggregate(topic, function(err, rssFeed) {
      if (err) {
        res.status(500).send({error: 'Error while creating feed'});
      }
      else {
        res.send(rssFeed);
      }
    },
    req);
  }
  else {
    res.status(404).send({error: 'Topic not found'});
  }};
  // look for the topic in the db
  findTopicByName(name, callback);
} 
```

所以没什么特别的，但是这个 getFeed 函数仍然被调用了两次。

那里有什么问题？任何想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-15T14:20:41.293

这让我烦了很久。很可能是 Firebug 扩展在后台发送每个 GET 请求的副本。尝试关闭 Firebug 以确保不是问题所在。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2020-06-12T17:01:43.617

[我在本地机器上使用Google Cloud Functions Framework](https://github.com/GoogleCloudPlatform/functions-framework-nodejs)（用于`express`处理请求）时遇到了同样的问题。每个`fetch`请求（在浏览器控制台和网页中）都会导致对服务器的两个请求。该问题与 CORS 有关（因为我使用了不同的端口），Chrome`OPTIONS`在实际调用之前进行了方法调用。由于`OPTIONS`我的代码中不需要方法，因此我使用了一个 if 语句来返回一个空响应。

```
if(req.method == "OPTIONS"){
    res.set('Access-Control-Allow-Origin', '*');
    res.set('Access-Control-Allow-Headers', 'Content-Type');
    res.status(204).send('');
} 
```

花了将近 3 个小时敲打我的头。感谢 user105279 的回答暗示了这一点。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-02T07:55:33.203

如果您的网站上有网站图标，请将其删除并重试。如果您的问题得到解决，请重构您的网站图标 url

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-02T19:30:34.893

I'm doing more or less the same thing now, and noticed the same thing.

I'm testing my server by entering the api address in chrome like this:

[http://127.0.0.1:1337/links/1](http://127.0.0.1:1337/links/1)

my Node.js server is then responding with a json object depending on the id.

I set up a console log in the get method and noticed that when I change the id in the address bar of chrome it sends a request (before hitting enter to actually send the request) and the server accepts another request after I actually hit enter. This happens with and without having the chrome dev console open.

IE 11 doesn't seem to work in the same way but I don't have Firefox installed right now.

Hope that helps someone even if this was a kind of old thread :)

/J

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-08-10T14:51:57.953

我要修复`listen.setTimeout`和`axios.defaults.timeout = 36000000`

节点js

```
var timeout = require('connect-timeout'); //express v4

//in cors putting options response code for 200 and pre flight to false
app.use(cors({ preflightContinue: false, optionsSuccessStatus: 200 }));

//to put this middleaware in final of middleawares
app.use(timeout(36000000)); //10min
app.use((req, res, next) => {
   if (!req.timedout) next();
});

var listen = app.listen(3333, () => console.log('running'));
listen.setTimeout(36000000); //10min 
```

反应

```
import axios from 'axios';

axios.defaults.timeout = 36000000;//10min 
```

经过2天的尝试

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-07-19T02:07:09.637

您可能不得不进一步增加超时。我还没有看到快速来源，但它只是在超时时发出声音，它会重试。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-04-30T23:43:48.893

就我而言，我的 Axios POST 请求被 Express 接收了两次，第一个没有正文，第二个带有正确的有效负载。从 Postman 发送的相同请求仅正确接收一次。事实证明，Express 是在不同的端口上运行的，所以我的请求是跨源的。这导致 Chrome 向同一个 url（POST url）发送了一个预检 OPTION 方法请求，而我在 Express 中的 app.all 路由也处理了那个请求。

```
app.all('/api/:cmd', require('./api.js')); 
```

将 POST 与 OPTIONS 分开解决了这个问题：

```
app.post('/api/:cmd', require('./api.js'));
app.options('/', (req, res) => res.send()); 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-12-06T04:41:10.703

确保你给 res.send(); axios 调用需要来自服务器的值，因此会在 120 秒后发回调用请求。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-04-16T17:07:13.047

我在使用 Express 4 时遇到了同样的问题。我相信这与它如何解决请求参数有关。`params`解决方案是通过例如在一个`if`块中检查它们来确保您得到解决：

```
app.get('/:conversation', (req, res) => {
    let url = req.params.conversation;

    //Only handle request when params have resolved
    if (url) {
        res.redirect(301, 'http://'+ url + '.com')
    }
}) 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-12-31T16:25:57.953

我遇到了同样的问题。然后我尝试添加return，它没有工作。但是当我添加 return res.redirect('/path');

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-10-30T21:12:22.557

我有同样的问题。然后我打开 Chrome 开发工具，发现`favicon.ico`是我的 Express.js 应用程序请求的。我需要修复注册中间件的方式。

[Chrome 开发工具截图](https://i.stack.imgur.com/6S1XY.png)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-04-02T09:51:08.893

我也有双重要求。在我的情况下，它是从 http 到 https 协议的转发。您可以通过比较来检查是否是这种情况

```
req.headers['x-forwarded-proto'] 
```

它将是“http”或“https”。我可以通过调整中间件触发的顺序来解决我的问题。

# mysql - MYSQL 选择多个值

> ID：13150281
> 
> 赞同：1
> 
> 时间：2012-10-31T02:06:58.440
> 
> 标签：mysql, select, numbers

```
$query = $query."AND `category` != '(1,2)') ORDER BY id DESC LIMIT $a , $b" ; 
```

长话短说，找不到上述 (1,2) 的正确语法，我不想用另一个 AND 重写，因为将来可能会出现更多值。

希望有人可以帮助我；）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:08:23.887

您应该使用`NOT IN`运算符。

```
$query = $query."AND `category` NOT IN (1,2)) ORDER BY id DESC LIMIT $a , $b" ; 
```

# javascript - 添加ajax后淘汰可观察数组未更新

> ID：13150287
> 
> 赞同：2
> 
> 时间：2012-10-31T02:08:00.110
> 
> 标签：javascript, ajax, knockout.js, ko.observablearray

我有一个复杂对象的可观察数组。初始加载很好，所有预期的数据看起来都很好。现在我正在将新项目发布到该数组。注意：可观察数组是通过 ASP.NET ajax web api 调用加载的。

就将新项目保存到数据库而言，发布一个新项目可以正常工作，但是我的 DOM 没有用新项目更新，我不知道我错过了什么。

这是整个 ViewModel

```
 function ClientList() {
    //data
    var self = this;
    self.initialized = ko.observable(false);
    self.clients = ko.observableArray();
    self.userId = ko.observable("");
    self.name = ko.observable("");
    self.logo = ko.observable("");
    self.projects = ko.observableArray();
    self.clientAddress = ko.observableArray();

    self.addClient = function () {
        var client = {
            UserId: self.userId,
            Name: self.name,
            Logo: self.logo,
        }
        client = ko.toJSON(client);
        lucidServer.addClient(client);
        self.clients.push(client);
    }.bind(self);

    (function () {
        $.ajax({
            url: lucidServer.getClients(1),
            success: function (data) {
                ko.mapping.fromJS(data, {}, self.clients);
                self.initialized(true);
            }
        });
    })();
};

function IncompleteStoriesList() {
    //data
    var self = this;
    self.initialized = ko.observable(false);
    self.stories = ko.observableArray();
    (function () {
        $.ajax({
            url: lucidServer.getIncompleteStory(1),
            success: function (data) {
                ko.mapping.fromJS(data, {}, self.stories);
                self.initialized(true);
            }
        });
    })();
};

function ViewModel() {
    var self = this;
    self.clientList = new ClientList();
    self.storyList = new IncompleteStoriesList();
}

ko.applyBindings(new ViewModel()); 
```

这是我正在执行 POST 的特定片段（在 ClientList() 函数中）。

```
self.addClient = function () {
        self.client = {
        UserId: self.userId(),
        Name: self.name(),
        Logo: self.logo(),
        }
    //make client object to send to server
    var client = ko.toJSON(self.client);
    lucidServer.addClient(client);
    //push the self.client to the observablearray of clients
    self.clients.push(self.client);
}.bind(self); 
```

我验证了它是位于客户端变量中的 JSON，并且没有抛出错误消息，所以我很困惑。添加项目并刷新整个页面后，它将显示在列表中。

编辑：这是相关的html：

```
<form data-bind="submit: clientList.addClient">
    <div>
        <label>userId</label>
        <input type="text" data-bind="value: clientList.userId" />
    </div>
    <div>
        <label>name</label>
        <input type="text" data-bind="value: clientList.name" />
    </div>
    <div>
        <label>logo</label>
        <input type="text" data-bind="value: clientList.logo" />
    </div>
    <button type="submit">Add</button>

    </form>

    <!-- ko ifnot: clientList.initialized -->
    <span>Loading...</span>
    <!-- /ko -->
    <ul data-bind="template:{name: 'clientList', foreach:clientList.clients}">
    </ul> 
```

外部模板如下所示：

```
<div id="clientListOutput">

    <li><span data-bind="text: name"></span>
        <div data-bind="template: {foreach: clientAddress}">
            <span data-bind="text: city"></span>
            <span data-bind="text: state"></span>
        </div>
        <hr />
        <ul data-bind="template: {foreach: projects}">
            <li>
                <span data-bind="text: name"></span>
                <span data-bind="text: summary"></span>
                <span data-bind="text: description"></span>
            </li>
        </ul>
    </li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:09:31.527

我很确定您的 HTML 中有错字。这是一个使用 ko.observablearray 的工作示例

HTML：

```
<form data-bind="submit: addItem">
    prop1: <input data-bind='value: prop1, valueUpdate: "afterkeydown"' />
    prop2: <input data-bind='value: prop2, valueUpdate: "afterkeydown"' />
    <button type="submit">Add</button>
    <p>Your items:</p>
    <div data-bind="foreach: items">
        <span data-bind="text: prop1"></span> &nbsp - &nbsp
        <span data-bind="text: prop2"></span>
        <br />
    </div>
</form> 
```

JS：

```
var SimpleListModel = function() {
    this.items = ko.observableArray();
    this.prop1 = ko.observable("");
    this.prop2 = ko.observable("");
    this.addItem = function() {
        this.items.push({prop1:this.prop1, prop2: this.prop2});
    }.bind(this);  // Ensure that "this" is always this view model
};

ko.applyBindings(new SimpleListModel()); 
```

[http://jsfiddle.net/NjSBg/2/](http://jsfiddle.net/NjSBg/2/)

我想你也有可能忘记应用绑定......

**编辑**

我为发布错误的小提琴而道歉，现在就一个。

```
self.addClient = function () {
    var client = {
        UserId: self.userId(),
        Name: self.name(),
        Logo: self.logo()
    }
    lucidServer.addClient(ko.toJSON(client));
    self.clients.push(client);
}.bind(self); 
```

*您添加括号以获取可观察对象的当前静态值*

# c++ - cin.get() 不阻塞

> ID：13150288
> 
> 赞同：1
> 
> 时间：2012-10-31T02:08:05.180
> 
> 标签：c++, windows

我一直在试图解决这个问题大约 2 个小时。无论我做什么， cin.get() 都不会暂停我的程序。即使是最简单的程序。像这样，

```
#include <iostream>

using namespace std;

int main ()
{
    cout << "Hello World! ";
    cin.get();
    return 0;
} 
```

这有什么问题？我尝试了很多方法，比如制作更多 cin.get'S 甚至系统暂停。我换了东西，没有任何效果。请帮忙！

# iphone - 用于 ios 应用程序的谷歌地图许可

> ID：13150290
> 
> 赞同：-1
> 
> 时间：2012-10-31T02:08:35.497
> 
> 标签：iphone, ios, google-maps, licensing

我开发了一个 iPhone 应用程序，它发送包含谷歌地图的电子邮件，使用谷歌静态地图 API 嵌入。该应用程序将在 iTunes 商店出售（即不是免费的）。

我需要获得 Google Maps Business 帐户吗？如果是这样，我什至如何申请帐户？

正确方向的一点将不胜感激。我联系了谷歌，但得到了默认回复，它创建了更多的问题，它回答了。例如它说：

“注意：a) 销售与 Google 地图集成的产品需要特别批准和相关的许可证升级。”

但它没有说明如何做到这一点。

任何提示将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:30:04.170

根据谷歌：

* * *

**使用限制**

Google Places API 具有以下查询限制：

1.  拥有 API 密钥的用户每 24 小时允许 1000 个请求。

2.  通过 API 控制台验证身份的用户每 24 小时允许 100 000 个请求。通过在控制台中启用计费，需要信用卡进行验证。我们要求您提供信用卡纯粹是为了验证您的身份。使用 Places API 不会从您的卡中收取费用。

    * * *

因此，您只需提供您的信用卡信息，无需支付任何费用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-19T12:17:35.973

如果应用程序出售，则不允许在 iPhone 上使用免费的 Google Maps API，除非您在 Google 商店中使用 Android。见 9.1.2 例外：[https ://developers.google.com/maps/terms](https://developers.google.com/maps/terms)

> 如果您的 Maps API 实施用于通过在线商店收费出售且可下载到可访问在线商店的移动设备的移动应用程序，则（免费访问）不适用。

在大多数情况下，商业 Maps Api 许可证过于昂贵。注意：这主要影响 Webviews，因为较新 iOS 上的内置 Mapkit 服务于 Apple Maps，而不是 Google Maps。

# wpf - 为什么我的 XAML 突然崩溃了？

> ID：13150291
> 
> 赞同：3
> 
> 时间：2012-10-31T02:08:52.350
> 
> 标签：wpf, xaml, windows-8, winrt-xaml

我在我在项目中创建的文件夹（“视图”）中向我的项目添加了一个“基本页面”。

起初一切都很好，但“突然”设计视图失败并显示：

*System.ObjectDisposedException 安全句柄已关闭*

这是 XAML（我还没有更改生成的默认 XAML 中的任何内容）：

```
<common:LayoutAwarePage
    x:Name="pageRoot"
    x:Class="TimeAndSpaceLines.View.SectionPage"
    DataContext="{Binding DefaultViewModel, RelativeSource={RelativeSource Self}}"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:TimeAndSpaceLines.View"
    xmlns:common="using:TimeAndSpaceLines.Common"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Page.Resources>

        <!-- TODO: Delete this line if the key AppName is declared in App.xaml -->
        <x:String x:Key="AppName">My Application</x:String>
    </Page.Resources>

    <!--
        This grid acts as a root panel for the page that defines two rows:
        * Row 0 contains the back button and page title
        * Row 1 contains the rest of the page layout
    -->
    <Grid Style="{StaticResource LayoutRootStyle}">
        <Grid.RowDefinitions>
            <RowDefinition Height="140"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Back button and page title -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Button x:Name="backButton" Click="GoBack" IsEnabled="{Binding Frame.CanGoBack, ElementName=pageRoot}" Style="{StaticResource BackButtonStyle}"/>
            <TextBlock x:Name="pageTitle" Grid.Column="1" Text="{StaticResource AppName}" Style="{StaticResource PageHeaderTextStyle}"/>
        </Grid>

        <VisualStateManager.VisualStateGroups>

            <!-- Visual states reflect the application's view state -->
            <VisualStateGroup x:Name="ApplicationViewStates">
                <VisualState x:Name="FullScreenLandscape"/>
                <VisualState x:Name="Filled"/>

                <!-- The entire page respects the narrower 100-pixel margin convention for portrait -->
                <VisualState x:Name="FullScreenPortrait">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="backButton" Storyboard.TargetProperty="Style">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PortraitBackButtonStyle}"/>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>

                <!-- The back button and title have different styles when snapped -->
                <VisualState x:Name="Snapped">
                    <Storyboard>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="backButton" Storyboard.TargetProperty="Style">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource SnappedBackButtonStyle}"/>
                        </ObjectAnimationUsingKeyFrames>
                        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="pageTitle" Storyboard.TargetProperty="Style">
                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource SnappedPageHeaderTextStyle}"/>
                        </ObjectAnimationUsingKeyFrames>
                    </Storyboard>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>
    </Grid>
</common:LayoutAwarePage> 
```

注意：我确实尝试根据“TODO”（它在 app.xaml 中）删除“appname”行，*但这*没有任何区别。该应用程序通过 F6 成功构建，但尝试重新加载设计器失败。

第二次尝试，这次使用空白 xaml 页面，然后粘贴我在 Kaxaml 中拼凑的一些 XAML，也失败了，这次出现错误消息：“*无法注册 System.Exception 包。（来自 HRESULT 的异常： 0x80073CF6)* "

此 XAML 为（截断）：

```
<Page
    x:Class="TimeAndSpaceLines.View.SectionN"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:TimeAndSpaceLines.View"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid MinHeight="600" ShowGridLines="True" Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="320">
                    </ColumnDefinition>
                    <ColumnDefinition MaxWidth="800">
                    </ColumnDefinition>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition>
                    </RowDefinition>
    . . . 
```

？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-01T18:56:10.367

我有同样的问题，似乎问题是VS在开始调试之前试图“部署”你的任何应用程序。但这种部署可能会被 Windows 本地组策略禁止。因此，您需要执行以下步骤：

1.  按 Win + X 打开运行对话框，输入 gpedit.msc 并回车；
2.  转到计算机配置 > 管理模板 > Windows 组件 > 应用程序包部署；
3.  双击“允许安装所有受信任的应用程序”，选择启用并选择确定；

它对我有帮助。

# json - 关于play2框架json知识

> ID：13150293
> 
> 赞同：-5
> 
> 时间：2012-10-31T02:09:11.437
> 
> 标签：json, playframework-2.0

play2 框架 json ：

```
case class P(
  val name: String,
  val age: Int,
  val address: String
)
val pList = List(
  P("a", 18, "USA"),
  P("b", 20, "USA")
)
Json.toJson(pList) 
```

为什么这不编译？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T09:07:42.467

请看[API](http://www.playframework.org/documentation/api/2.0.2/scala/index.html#play.api.libs.json.package)和play上的例子[！网站](http://www.playframework.org/documentation/2.0.4/ScalaJson)。它们提供了有关 JSON 的综合指南。由于该`play.api.libs.json`包仅包含七种 JSON 数据类型（`JsObject`、`JsNull`、`JsUndefined`、`JsBoolean`、和） `JsNumber`，因此您必须定义自己的格式。`JsArray``JsString`

**取自[API](http://www.playframework.org/documentation/api/2.0.2/scala/index.html#play.api.libs.json.package)：**

```
case class User(id: Long, name: String, friends: List[User])

implicit object UserFormat extends Format[User] {
  def reads(json: JsValue): User = User(
    (json \ "id").as[Long],
    (json \ "name").as[String],
    (json \ "friends").asOpt[List[User]].getOrElse(List()))
  def writes(u: User): JsValue = JsObject(List(
    "id" -> JsNumber(u.id),
    "name" -> JsString(u.name),
    "friends" -> JsArray(u.friends.map(fr => JsObject(List("id" -> JsNumber(fr.id),
    "name" -> JsString(fr.name)))))))
}

//then in a controller:
object MyController extends Controller {
   def displayUserAsJson(id: String) = Action {
      Ok(toJson( User(id.toLong, "myName", friends: List())))
   }
   def saveUser(jsonString: String)= Action {
     val user = play.api.libs.json.parse(jsonString).as[User]
     myDataStore.save(user)
     Ok
   }
} 
```

祝你好运！

# java - 使用 NullPointerException 进行日志记录？

> ID：13150294
> 
> 赞同：0
> 
> 时间：2012-10-31T02:09:18.393
> 
> 标签：java, swing, logging, log4j, nullpointerexception

> **可能重复：**
> [使用 log4j 在 Java 中记录运行时异常](https://stackoverflow.com/questions/2344654/log-runtime-exceptions-in-java-using-log4j)

我正在开发一个桌面应用程序。我用 Log4j 写日志。我怎样才能写日志`NullPointerException`？我没有预料到会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:18:25.960

如果您的意思是如何将异常打印到日志中，假设配置正常：

```
try {
     ....something
} catch(RuntimeException e) {
     log.error("Got unexpected exception", e);
} 
```

NullPointerException 继承自 RuntimeExepction，因此您可以使用上述代码安全地捕获它和任何其他运行时异常。上面的代码不会捕获任何继承自 Exception 但不是从 RuntimeException 继承的异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T02:18:46.450

如果我正确理解您的问题，您不想在整个代码中放置 Try catch 语句来处理 NullPointer 异常，因为它不是预期的。

处理的简单方法是在将对象引用用于任何操作之前进行空检查。此外，仅将这些空检查放在那些您可以预期它可能由于某些其他异常或错误情况而无法初始化的对象上。

IE

```
if (objectReference!=null)
           objectReference.CallSomeMethod(); 
```

另一个例子

```
String listofDefaulters =null;
  String defaulters = getDefauter();
/**you might expect that you will always get defaulters from the method call but it might happen dat it can return null value also. 
 So always put a null check where you are not 100% sure if value will not be null**/
  if (defaulters !=null)
     defaulters.doSomeOperation(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T02:25:27.360

如果你想做`aspect oriented programming`，你可能想写一个建议，`Exception`包括`NullPointerException`并执行下面的日志记录：

```
 @Aspect
 public class ExceptionLogging {
   private static Logger log = null;

   @Pointcut ("call(* *.*(..)))
   public void exceptionLogMethods(){
   }

   @AfterThrowing(pointcut="exceptionLogMethods()", throwing="e")
   public void handleException(Throwable ex, JoinPoint jointPoint) {
      log = Logger.getLogger(jointPoint.getThis().getClass());
      log.debug(jointPoint.getThis().getClass() + ex.getMessage());
   }
  } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T02:32:03.790

[`Preconditions`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html)您也可以在[Guava 库](http://code.google.com/p/guava-libraries/)中使用该类来自定义异常和消息。

如果引用是，则该方法[`Preconditions#checkNotNull(T, java.lang.Object)`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Preconditions.html#checkNotNull%28T,%20java.lang.Object%29)抛出 a 。`NullPointerException``T``null`

```
void method(String name) {
    Preconditions.checkNotNull(name, "The name is null.");

    // do something with the name
}

void otherMethod() {
    try {
        method("zerone"); // OK
        method(null); // throws NPE
    } catch(RuntimeExcetion e) {
        LOG.error(e.getMessage(), e);  // Message: "The name is null."
    }
} 
```

# google-app-engine - 在 Eclipse 中使用 Maven 导入 Google 库？

> ID：13150295
> 
> 赞同：1
> 
> 时间：2012-10-31T02:09:22.120
> 
> 标签：google-app-engine, google-api, google-api-java-client

我正在关注这个示例，[http://code.google.com/p/google-api-java-client/wiki/OAuth2Draft10](http://code.google.com/p/google-api-java-client/wiki/OAuth2Draft10)并粘贴了代码，但是以下行给出了错误（无法解决）：

```
import com.google.api.client.auth.oauth2.draft10.AccessTokenResponse;
import com.google.api.client.googleapis.auth.oauth2.draft10.GoogleAccessProtectedResource;
import com.google.api.client.googleapis.auth.oauth2.draft10.GoogleAccessTokenRequest.GoogleAuthorizationCodeGrant;
import com.google.api.client.googleapis.auth.oauth2.draft10.GoogleAuthorizationRequestUrl; 
```

同一页面说好的兄弟没问题只需将其添加到Maven：

```
<dependency>
  <groupId>com.google.api-client</groupId>
  <artifactId>google-api-client</artifactId>
  <version>1.11.0-beta</version>
</dependency> 
```

不幸的是，我不了解关于 Maven 的杰克。我没有 POM.XML（我创建了另一个项目，但仍然没有 pom.xml）。

# c# - C#循环一段代码（包含一个数组）

> ID：13150296
> 
> 赞同：0
> 
> 时间：2012-10-31T02:09:27.437
> 
> 标签：c#, arrays, loops

只是有点迷失在这里。我的问题是我编写了一个简单的代码块，允许用户选择一种水果。代码做了我想做的事情，除了一个问题，我需要它循环回到代码的开头，以便用户重新选择一个可选的水果。

但是，我似乎无法让它工作，但我怀疑问题在于我对循环的理解需要更多关注。我知道我需要一个初始化程序和某种条件来执行循环。我尝试了很多（疯狂的）事情，包括尝试像这样执行循环：**for (string[ ] fruitArray = {"Banana", "Apple", "Orange", "Pineapple"});** 但是编译器没有它，我想堆栈溢出社区也不会接受。任何帮助和建议表示赞赏。

```
{

            Console.WriteLine("\n", "\n");

            string[] fruitArray = {"Banana", "Apple", "Orange", "Pineapple"};

            Console.WriteLine("Please select your fruit: \n\n{0} \n{1} \n{2} \n{3}" + "\n", fruitArray[0], fruitArray[1], fruitArray[2], fruitArray[3]);
            string selection = Console.ReadLine();

            if (selection == fruitArray[0])
            {
                Console.WriteLine("\nYou have selected {0} ", fruitArray[0]);
            }
            else if (selection == fruitArray[1])
            {
                Console.WriteLine("\nYou have selected {0} ", fruitArray[1]);
            }
            else if (selection == fruitArray[2])
            {
                Console.WriteLine("\nYou have selected {0} ", fruitArray[2]);
            }
            else if (selection == fruitArray[3])
            {
                Console.WriteLine("\nYou have selected {0} ", fruitArray[3]);
            }
            else
            {
                Console.WriteLine("\nSelection not recognised. Please select fruit: ");
            }

         }

        Console.ReadKey();

    }
  }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:23:36.427

循环不退出

```
while (true)
            {
                Console.WriteLine("\n", "\n");

                string[] fruitArray = { "Banana", "Apple", "Orange", "Pineapple" };

                Console.WriteLine("Please select your fruit: \n\n{0} \n{1} \n{2} \n{3}" + "\n", fruitArray[0], fruitArray[1],
                                  fruitArray[2], fruitArray[3]);
                string selection = Console.ReadLine();

                switch (selection)
                {
                    case "Banana":
                        Console.WriteLine("\nYou have selected {0} ", fruitArray[0]);
                        break;

                    case "Apple":
                        Console.WriteLine("\nYou have selected {0} ", fruitArray[1]);
                        break;

                    case "Orange":
                        Console.WriteLine("\nYou have selected {0} ", fruitArray[2]);
                        break;

                    case "Pineapple":
                        Console.WriteLine("\nYou have selected {0} ", fruitArray[3]);
                        break;                    
                } 
            } 
```

带退出条件的循环

```
 var isLoop = true;

            do
            {
                Console.WriteLine("\n", "\n");

                string[] fruitArray = {"Banana", "Apple", "Orange", "Pineapple"};

                Console.WriteLine("Please select your fruit: \n\n{0} \n{1} \n{2} \n{3}"   + "\n", fruitArray[0],
                                  fruitArray[1],
                                  fruitArray[2], fruitArray[3]);
                string selection = Console.ReadLine();

                switch (selection)
                {
                    case "Banana":
                        Console.WriteLine("\nYou have selected {0} ", fruitArray[0]);
                        break;

                    case "Apple":
                        Console.WriteLine("\nYou have selected {0} ", fruitArray[1]);
                        break;

                    case "Orange":
                        Console.WriteLine("\nYou have selected {0} ", fruitArray[2]);
                        break;

                    case "Pineapple":
                        Console.WriteLine("\nYou have selected {0} ", fruitArray[3]);
                        break;
                    default:
                    isLoop = false;
                    break;
                }
            } while (isLoop); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T22:24:21.677

对于您的示例，这应该足够了：

```
string[] fruitArray = { "Banana", "Apple", "Orange", "Pineapple" };

Console.WriteLine("Please select your fruit: \n\n{0} \n{1} \n{2} \n{3}" + "\n", fruitArray[0], fruitArray[1],
                              fruitArray[2], fruitArray[3]);
string selection = Console.ReadLine();

Console.WriteLine("\nYou have selected {0} ", selection); 
```

可能我错过了一些东西，我会很高兴了解什么:)

此外，您可以通过迭代数组来改进第一条消息：

```
Console.WriteLine("Please select your fruit: \n");

for(int i=0;i<fruitArray.Length;i++)
{
    Console.WriteLine(fruitArray[i]);
} 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T02:17:05.397

C# 对于[http://msdn.microsoft.com/en-us/library/ch45axte.aspx](http://msdn.microsoft.com/en-us/library/ch45axte.aspx)

C# foreach [http://msdn.microsoft.com/en-us/library/ttw7t8t6.aspx](http://msdn.microsoft.com/en-us/library/ttw7t8t6.aspx)

```
string[] fruitArray = { "Banana", "Apple", "Orange", "Pineapple" };

        Console.WriteLine("Please select your fruit: \n");            
        foreach (string fruit in fruitArray)
        {
            Console.Write("\n{0}", fruit);
        }

        Console.WriteLine();

            string selection = Console.ReadLine();
            for (int index = 0; index < fruitArray.Length; index++)
            {
                if (fruitArray[index].Equals(selection))
                {
                    Console.WriteLine("\nYou have selected {0} ", fruitArray[index]);
                    break;
                }
            }

            foreach (string fruit in new[] {"Banana", "Apple", "Orange", "Pineapple" })
            {
                if (fruit.Equals(selection))
                {
                    Console.WriteLine("\nYou have selected {0} ", fruit);
                    break;
                }
            } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-02T13:17:21.607

The following code should do exactly what you want. Not only that, but it simplifies the need to even use block `if` statements or a `switch`, a simple `Array.FindIndex` is enough to determine if the input is valid or not. Also, I added an exit clause which so the user can quit the application when they are finished and to remove any cluttering of the UI I am clearing the console window after each "iteration".

```
 static void Main(string[] args)
    {
        var selection = "";
        while (selection != "q")
        {
            Console.WriteLine(Environment.NewLine);
            string[] fruitArray = { "Banana", "Apple", "Orange", "Pineapple" };

            Console.WriteLine("Please select your fruit (or Q to quit): \n\n{0} \n{1} \n{2} \n{3}", fruitArray[0], fruitArray[1], fruitArray[2], fruitArray[3]);
            Console.Write(Environment.NewLine + "-> ");
            selection = Console.ReadLine().ToLower();

            // valid option selected
            var index = Array.FindIndex(fruitArray, (fruit) => fruit.ToLower() == selection);
            if (index > -1)
            {
                Console.Write("\nYou have selected {0}.", fruitArray[index]);
                ContinuePrompt();
            }
            else if (selection != "q")
            {
                Console.Write("\nSelection not recognised.");
                ContinuePrompt();
            }
        }
     }

    static void ContinuePrompt()
    {
        Console.Write(" Press any key to continue...");
        Console.ReadKey();
        Console.Clear();
    } 
```

# clojure - 使用 ring format-params 中间件访问发布的 json

> ID：13150297
> 
> 赞同：2
> 
> 时间：2012-10-31T02:10:11.280
> 
> 标签：clojure, ring

我正在尝试使用 clojure 中的环制作一个非常简单的 API。我正在使用 rack.middleware.format-params 中间件将输出转换为 json，并将输入从 json 转换为 clojure 数据结构。

我的输出运行良好，但我无法终生访问通过 json 发送的参数。这是一些适用于获取请求的代码，但我无法让 POST 请求返回它收到的 json

```
(ns testing.core
  (:use [compojure.core]
        [ring.middleware.format-params :only [wrap-json-params]]
        [ring.middleware.format-response :only [wrap-json-response]]
        [ring.adapter.jetty])
  (:require [compojure.handler :as handler]))

(defroutes app-routes
  (GET "/"
       []
       {:body {:hello "world"}})

  (POST "/"
        {params :params}
        {:body params}))

(def app
  (-> (handler/api app-routes)
      (wrap-json-params)
      (wrap-json-response))) 
```

它只是返回这个：`{}`

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T03:32:36.703

我是个白痴，意识到我没有发送 json Content-Type 标头。希望没有其他人犯同样的愚蠢错误：P

# android - 删除 ICS 中 tabhost 的底部边框（ActionBarSherlock，v4 支持库）

> ID：13150308
> 
> 赞同：2
> 
> 时间：2012-10-31T02:11:15.680
> 
> 标签：android, android-tabhost, actionbarsherlock

我在 Android ICS (4.0.3) 上使用 ActionBarSherlock 和 v4 支持库。我试图弄清楚标签主机的底部边框在哪里定义并且可以自定义/删除。

![在此处输入图像描述](../Images/43e99023ae6ed9edc3cec0fb2c7f29b5.png)

参考下面的屏幕截图，我想删除活动选项卡的底部边框。活动标签视图本身没有底部边框，屏幕截图中看到的底部边框（红色圆圈）似乎来自底层标签主机或某处。我只是找不到要覆盖的样式或属性。您可以在选项卡部分下方看到的非常轻的 ~2-3px 阴影也是如此。也没有看到它在哪里定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T14:25:00.497

在您的主题中添加

```
<item name="android:windowContentOverlay">@null</item> 
```

# c++ - C++ ODBC未处理异常/访问冲突写入位置

> ID：13150311
> 
> 赞同：0
> 
> 时间：2012-10-31T02:11:31.983
> 
> 标签：c++, sql, exception, odbc, runtime-error

我正在编写一个 ODBC 数据库类，它包含一个成员函数，用于从给定查询中获取一系列属性和元组。

我在下面的语句中有一行代码导致在调试模式下抛出此运行时错误：

```
Unhandled exception at <mem loc> in <prog name>: 0xC0000005: Access violation writing location <mem loc>. 
```

这是`ERROR`指出违规行的代码：

```
SQLINTEGER length = 0;
vector<vector<string>> data;
this->sReturn = SQLFetch(this->sHandle);

while (this->sReturn == SQL_SUCCESS) {
  vector<string> tuple;

for (int i = 0; i < columnCount; i++) {
  SQLPOINTER value = "";

  switch (info[i].columnType) {
    case 0 : //SQL_UNKNOWN_TYPE
      throw DatabaseAttributeTypeUnknown("The database returned an attribute of an unknown type.");
      break;

    case 1 : //SQL_CHAR
      this->sReturn = SQLGetData(this->sHandle, i + 1, info[i].columnType, value,
        info[i].columnSize*sizeof(SQLCHAR),
ERROR   &length);
        break;

     //Some more cases
  }
} 
```

关于为什么会抛出此错误的任何想法？这是[关于 SQLGetData() 的 MSDN 文档](http://msdn.microsoft.com/en-us/library/windows/desktop/ms715441%28v=vs.85%29.aspx)，它为`length`.

感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:38:42.033

当编译器将可执行代码映射到源代码中的代码行时，它们通常无法区分被拆分为多行的语句中的行。因此，如果调试器说错误发生在特定行上，它实际上可以在整个语句中的任何位置，所以在某处：

```
this->sReturn = SQLGetData(this->sHandle, i + 1, info[i].columnType, value,
    info[i].columnSize*sizeof(SQLCHAR),
    &length); 
```

这里唯一不稳定的指针是`value`指向一个空静态字符串，所以指向一个包含空字节的单字符长数组。此外，根据编译器选项，此数组可以位于只读数据段中。虽然 SQLGetData() 认为它指向的位置至少为`info[i].columnSize*sizeof(SQLCHAR)`字节大小，并且它将从 SQL 列写入（而不是读取）数据。

我可能会错过其他细节，但我的第一个猜测是这就是导致内存访问冲突的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T08:16:01.850

In addition to what Frederic said. Are you compiling your code 64 bit? If so you'll find SQLGetData takes a pointer to an SQLLEN for the last argument not an SQLINTEGER:

```
SQLRETURN  SQL_API SQLGetData(SQLHSTMT StatementHandle,
                              SQLUSMALLINT ColumnNumber, SQLSMALLINT TargetType,
                              SQLPOINTER TargetValue, SQLLEN BufferLength,
                              SQLLEN *StrLen_or_Ind); 
```

An SQLLEN is 8 bytes in 64 bit windows not 4 bytes as SQLINTEGER is.

# c# - 带有 where 条件的 Linq 查询 (x && x) || (x & x)

> ID：13150312
> 
> 赞同：1
> 
> 时间：2012-10-31T02:12:10.703
> 
> 标签：c#, linq

```
char[] delimiter = new char[] {' '};

string[] names = name.Trim().Split(delimiter, StringSplitOptions.RemoveEmptyEntries);

employees = (List<CMSUser>)employees.Where(
                    e => 
                       (e.FirstName.Contains(names[0]) && e.LastName.Contains(names[1])) ||
                       (e.LastName.Contains(name[0]) && e.FirstName.Contains(name[1]))
                     ) 
```

上面，我正在尝试使用 Linq lambda 来查询员工列表。我需要将输入框中输入的搜索词拆分为空格字符，并使用它从员工列表匹配 (FirstName && LastName) OR (LastName && FirstName) 中提取包含由空格分隔的这两个搜索词。

我不知道我在查询条件下做错了什么。它返回列表中的所有员工，而不是提供那些匹配条件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T02:18:40.093

我认为问题发生在您的第二个 OR 子句中：

```
(e.LastName.Contains(name[0]) && e.FirstName.Contains(name[1]) 
```

`names`不应该`name`，否则分别获取`name`变量的第一个和第二个字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T04:19:09.310

将返回的 IEnumerable`Where()`转换为 List 应该不起作用。相反，您可以使用`ToList()`：

```
employees = employees.Where(
                    e => 
                       (e.FirstName.Contains(names[0]) && e.LastName.Contains(names[1])) ||
                       (e.LastName.Contains(names[0]) && e.FirstName.Contains(names[1]))
                     )
                      .ToList(); 
```

# c# - 如何将本地服务器用于 tweetsharp 应用程序

> ID：13150313
> 
> 赞同：0
> 
> 时间：2012-10-31T02:12:33.027
> 
> 标签：c#, twitter, tweetsharp

我制作了一个关于通过 tWitter 对用户进行身份验证的演示。

我想回调到这个网址`http://localhost:56501/home/authorize.`

当我尝试在我的应用程序设置中设置此 url 时，它不起作用。我收到 url 无效的错误。

有人帮助我让它在我身边工作。

我已经从这里运行了一些代码[https://github.com/danielcrenna/tweetsharp](https://github.com/danielcrenna/tweetsharp)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T20:15:06.993

首先，您需要在您的 twitter 应用程序 (http://dev.twitter.com/apps/) 中设置回调链接。将“localhost”替换为“127.0.0.1”。例如，我的看起来像 - http://127.0。0.1:31820 /Home/AuthorizeCallback

使用您的 ConsumerKey 和 ConsumerSecret 创建 TwitterService 实例。

```
var service = new TwitterService(_consumerKey, _consumerSecret); 
```

以下方法获取请求令牌：

```
public ActionResult Login()
        {
            var requestToken = service.GetRequestToken(CallBackURL);

            var url = service.GetAuthenticationUrl(requestToken);

            return Redirect(url.ToString());
        } 
```

它将用户重定向到 Twitter 登录表单。当用户输入他的凭据并提交表单时，它会重定向到您的回调链接。

```
public ActionResult AuthorizeCallback(string oauth_token, string oauth_verifier)
        {
            var requestToken = new OAuthRequestToken() {Token = oauth_token};
            var accessToken = service.GetAccessToken(requestToken, oauth_verifier);

            service.AuthenticateWith(accessToken.Token, accessToken.TokenSecret);

            var twitteruser = service.VerifyCredentials();

            return RedirectToAction("Index");
        } 
```

祝你好运！

# javascript - 单击时显示随机 div

> ID：13150315
> 
> 赞同：1
> 
> 时间：2012-10-31T02:12:54.550
> 
> 标签：javascript, jquery, colorbox

我正在使用 Colorbox Lightbox 脚本来调用页面上的隐藏 div。它工作得很好，但有一个问题。我有 15 个隐藏的 div。单击链接时，我希望每次都显示一个新的灯箱，而无需重复，直到全部显示为止。我不知道该怎么做。

这是我调用灯箱的代码：

```
$(".colorbox").colorbox({
    inline:true 
}); 
```

这是隐藏 div 的 HTML

```
<div class="hide">
 <div id="lightbox1">
    <!-- Content --> 
 </div>
 <div id="lightbox2">
    <!-- Content --> 
 </div>
 <!-- etc -->
</div> 
```

我将如何随机调用每个 div 直到全部显示然后重新开始？

还有一种方法可以在显示 div 1 - 15 后`id="last-div"`在重新启动之前显示最后一个 div ( )？

注意：所有 div 都将在单击时调用，我使用的是 jQuery 1.8.2。

我不知道从哪里开始，我已经看到使用脚本，`Math.random()`但我理解的不够多，无法完成这项工作。

***更新***

我已经尝试过 Ian 的回答，但灯箱没有显示（但我可以在控制台日志中看到脚本正在运行）

最初他在他的剧本中有这个：

```
$(selector).show(); 
```

我改成这样：

```
$(selector).colorbox({inline:true }); 
```

我需要做什么才能调用灯箱？

注意：不会抛出任何错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T03:20:29.753

所以我的想法与 Eric 的想法相似，但我想让它“完全”发挥作用。因此，我没有将所有 div 的引用存储在一个数组中，而是决定存储一个表示每个 div 的整数数组。我最终使用 jQuery 选择它们的方式是`"#lightbox + i"`，所以如果你没有这个确切的结构（其中 div 有一个像“lightbox”这样的 id 和一个 int - 从 1 到最后一个计数），那么你可以使用`.eq()`or `nth-child`。它不会是完全相同的结果，但它会产生相同的随机效果，只是以不同的方式完成。我找到了一个“随机化”数组的函数——我猜像 Eric 所做的`Shuffle`那样。但这是我从中得到它的地方 -[如何随机化（随机播放）JavaScript 数组？](https://stackoverflow.com/questions/2450954/how-to-randomize-a-javascript-array). 我不得不修改它以返回一个新数组，而不是修改传递给函数的数组。此外，我将所有内容都保留在`document.ready`范围内，而不是全局范围内，因此很多东西都被传递/返回。当我在全球范围内声明并没有传递它们之前它工作得很好`all`，`randomed`我只是认为这会“更好”，因为它们不是全球性的。

这是小提琴：

[http://jsfiddle.net/6qYCL/1/](http://jsfiddle.net/6qYCL/1/)

这是Javascript：

```
$(document).ready(function () {
    var all,
        randomed;

    all = generateAll();
    randomed = generateRandomed(all);

    $("#generator").on("click", function (evt) {
        evt.preventDefault();
        randomed = doNext(all, randomed);
    });
});

function generateAll() {
    // Generates the array of "all" divs to work on
    var a = [];
    var divs = $(".hide > div.lightbox");
    for (var i = 1; i <= divs.length; i++) {
        a.push(i);
    }
    console.log("List of divs available to toggle: " + a);
    return a;
}

function generateRandomed(all) {
    // Randomizes the original array
    randomed = fisherYates(all);
    console.log("Setting randomized array: " + randomed);
    return randomed;
}

function doNext(all, randomed) {
    $(".lightbox, #last-div").hide();

    if (randomed.length < 1) {
        console.log("All lightboxes toggled, showing last, then starting over");
        $("#last-div").show();
        randomed = generateRandomed(all);
    } else {
        var next = randomed.shift();
        var selector = "#lightbox" + next;
        console.log("Showing " + selector);
        $(selector).show();
        console.log("What's left: " + randomed);
    }

    return randomed;
}

// Randomizes an array and returns the new one (doesn't modify original)
function fisherYates ( myArray ) {
  var return_arr = myArray.slice(0);
  var i = return_arr.length;
  if ( i == 0 ) return false;
  while ( --i ) {
     var j = Math.floor( Math.random() * ( i + 1 ) );
     var tempi = return_arr[i];
     var tempj = return_arr[j];
     return_arr[i] = tempj;
     return_arr[j] = tempi;
  }
  return return_arr;
} 
```

它说明了到达列表的末尾并`#new-div`像您提到的那样显示，然后重新开始该过程。如果您查看浏览器的控制台，您可以“观察”初始化期间和单击链接时发生的情况。

我认为这与您正在寻找的内容很接近。我不确定哪个是更好的解决方案 - 存储对元素的引用或只是一个整数数组以循环并最终找到。我知道如何做到这一点有很多变化 - 何时/如何存储计数的东西，何时/如何随机化数组或检索随机值（以及如何跟踪已使用的值），在哪里存储所有参考资料，还有更多。我希望这至少有帮助！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T02:25:47.513

创建所有这些数组，然后随机播放该数组，然后每次点击时拉下一个。当您用完时，您可以根据需要重新填充阵列。

像这样的东西（使用[这个来源](http://css-tricks.com/snippets/javascript/shuffle-array/)`Shuffle`的方法）：

[**小提琴**](http://jsfiddle.net/EApHw/1/)

```
var array = $(".hide div").toArray(); // Add all divs within the hide div to an array
var randomArray = Shuffle(array); // Shuffle the array

$("a").click(function() {
    if (randomArray.length > 0)
        alert(randomArray.shift().innerHTML); // Show contents of div, as an example
    else
        alert("None left!");
    return false;
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-31T03:52:29.797

下面的解决方案通过将元素数组传递给函数来工作。随着每个 div 的显示，它被从数组中取出。然后从数组中剩下的 div 中随机挑选下一个。

```
// call this function on page load
function begin( ) { 

    var arr = $(".hide div").toArray();   
    // further elements can be added to arr i.e. last-div 
    showDivs( arr.length, arr );
}   

// begin displaying divs
function showDivs( numberOfDivs, divArray ) {
    var i, lastDiv;

    function nextDiv( ) {

        // depending on number of slides left get random number
        i = randomInt( numberOfDivs ); 
        if( lastDiv ) { $(lastDiv).hide() };

        $( divArray[ i ] ).fadeIn( 3000 );

        // now that this div has been displayed
        // remove from array and cache
        lastDiv = divArray.splice( i, 1 );

        numberOfDivs--;

        // no more divs to display
        if( numberOfDivs == 0 ) { return };

        setTimeout( nextDiv, 4000);
    }

    setTimeout( nextDiv, 1000);

}

// calculate next random index
function randomInt( divsLeft ) {
   var i = Math.random() * divsLeft;
   return Math.round( i );
} 
```

[在这里](http://jsfiddle.net/BMmAh/3/)提琴

# c#-4.0 - 为什么必须将重载运算符声明为 public？

> ID：13150320
> 
> 赞同：2
> 
> 时间：2012-10-31T02:13:15.610
> 
> 标签：c#-4.0, operator-overloading

我想在一个类中重载一个操作符，并将其私有化，以便它只能在类中使用。
但是，当我尝试编译时，我收到错误消息“用户定义的运算符 ... 必须声明为静态和公共的：

为什么他们必须公开？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-31T04:33:20.713

要回答您问题的一半，您可以查看 Eric Lippert 的博客文章。

[为什么 C# 中的重载运算符总是静态的？](http://blogs.msdn.com/b/ericlippert/archive/2007/05/14/why-are-overloaded-operators-always-static-in-c.aspx)

> 相反，当面对潜在的语言功能时，我们应该问自己的问题是“该功能的令人信服的好处是否证明所有成本都是合理的？” 成本远远超过设计、开发、测试、记录和维护功能的普通美元成本。还有更微妙的成本，比如，这个特性会不会让未来改变类型推断算法变得更加困难？这是否会导致我们进入一个如果不引入向后兼容性中断就无法进行更改的世界？等等。
> 
> 在这种特定情况下，引人注目的好处很小。如果你想在 C# 中有一个虚拟调度的重载运算符，你可以很容易地用静态部分构建一个。例如：

```
public class B {
    public static B operator+(B b1, B b2) { return b1.Add(b2); }
    protected virtual B Add(B b2) { // ... 
```

> 你有它。所以，好处很小。但是成本很大。C++ 风格的实例运算符很奇怪。例如，它们破坏了对称性。如果你定义一个接受 C 和 int 的 operator+，那么 c+2 是合法的，但 2+c 不是，这严重破坏了我们对加法运算符应该如何表现的直觉。

对于您的问题的另一部分：*为什么它们应该是 public*。

我无法找到任何真实的来源，但是 IMO，如果它们不会公开，并且只能在类中使用，那么可以使用简单的私有方法而不是重载运算符来完成。

您可能会看到 RB Whitaker 的博客文章

[运算符重载](http://rbwhitaker.wikidot.com/c-sharp-operator-overloading)

> 所有运算符重载都必须是公共的和静态的，这应该是有意义的，因为我们希望在整个程序中都可以访问运算符，并且因为它属于整个类，而不是类的任何特定实例。

# c# - 单击后禁用按钮

> ID：13150324
> 
> 赞同：1
> 
> 时间：2012-10-31T02:13:34.713
> 
> 标签：c#, winforms

我这里有 3 个按钮。

当我单击按钮 1 时，它将禁用按钮 1，然后启用第二个按钮，然后与到达最后一个按钮的过程相同。但我认为我的代码有问题。当我单击第一个按钮时它不会禁用

button1 被启用，而 button2 和 3 在加载时被禁用。

```
private void groupBox1_Enter(object sender, EventArgs e)
{
    Button btn = sender as Button;

    if (btn == button1)
    {
        button1.Enabled = false;
        button2.Enabled = true;
        button3.Visible = false;
        button3.Enabled = false;
        MessageBox.Show("button 1 disabled");
    }
    else if (btn == button2)
    {
        button1.Enabled = false;
        button2.Enabled = false;
        button3.Visible = true;
        button3.Visible = true;
        MessageBox.Show("button 2 disabled");
    }
    else if (btn == button3)
    {
        button1.Enabled = false;
        button2.Enabled = false;
        button3.Visible = false;
        button3.Visible = false;
        MessageBox.Show("button 3 disabled");
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T02:30:28.673

您是否订阅了正确的活动？它说 groupBox1_Enter。

```
Button[] buttons = null;  // Initialize somewhere with all the buttons.

void OnButtonClick(object sender, EventArgs e)
{
    for (int index = 0; index < buttons.Length; index++)
    {
        if (buttons[index] == sender)
        {
            buttons[index].Enabled = buttons[index].Visible = false;
        }
        else
        {
            buttons[index].Enabled = buttons[index].Visible = true;
        }
    }
} 
```

对不起，我错过了阅读你的帖子。下面按顺序

```
Button[] buttons = null;
        void OnButtonClick(object sender, EventArgs e)
        {
            int buttonIndex = Array.IndexOf(buttons, sender);
            for (int index = 0; index < buttons.Length; index++)
            {
                if (index == buttonIndex + 1)
                {
                    buttons[index].Enabled = buttons[index].Visible = true;
                }
                else
                {
                    buttons[index].Enabled = buttons[index].Visible = false;
                }
            }
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:40:39.863

检查每个按钮的属性中每个按钮的初始值是多少。

在更改按钮之前最好有一个初始化器来设置按钮的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-23T09:34:52.863

不要把代码放在 的`Enter`事件里面`GroupBox`，这个事件会有 groupoBow 为`sender`. 订阅`ButtonPressed`其中一个按钮的事件并最终使用相同的生成方法订阅`ButtonPressed`其他 2 个按钮的事件（如果您想使用`if-else`您编写的语句）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-01-05T15:40:42.930

也许你应该这样尝试：

```
private void groupBox1_Enter(object sender, EventArgs e)
{
    Button btn = sender as Button;

    if (btn == button1)
    {
        button1.Enabled = false;
        button2.Enabled = true;
        button3.Enabled = false;
        MessageBox.Show("button 1 is disabled");
    }
    else if (btn == button2)
    {
        button1.Enabled = false;
        button2.Enabled = false;
        button3.Enabled = true;
        MessageBox.Show("button 1 & button 2 are disabled");
    }
    else if (btn == button3)
    {
        button1.Enabled = false;
        button2.Enabled = false;
        button3.Enabled = false;
        MessageBox.Show("button 3 disabled");
    }
} 
```

这是你认为它必须工作的方式还是我弄错了？

# c - 在 C 中的结构中定义结构数组

> ID：13150326
> 
> 赞同：2
> 
> 时间：2012-10-31T02:13:52.247
> 
> 标签：c, dynamic, structure, allocation

嗨，我在定义结构中的结构数组时遇到了一些麻烦。这是我的想法，我需要一个名为 figure 的结构，其中包含图形的名称、坐标计数和坐标 (x,y)。每个图形可以有任意数量的坐标。我还需要能够为不断增加的坐标列表动态重新分配空间......请帮助我指出正确的方向。谢谢你，

泰勒

```
typedef struct {
  char fig_name[FIGURE_LEN + 1];
  int coordcount;
  /* here i need to declare an array of coord structures that 
     but i am not sure how to do this properly. I was originally
     going to try something like as follows */
  coords *pointer;
  pointer = malloc(sizeof(coords));
  pointer = coords figcoord[];
  /* however i am quite certain that this would not work */
} figure;

typedef struct {
  double x;
  double y;
} coords; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:22:24.457

朝正确的方向踢。尝试这样的事情。我很抱歉没有对`malloc()`调用进行错误检查，但你会得到大致的想法（我希望）：

```
#include <stdlib.h>

#define FIGURE_LEN  128

typedef struct
{
    double x;
    double y;
} coords;

typedef struct
{
    char fig_name[FIGURE_LEN + 1];
    int coordcount;
    coords *pointer;
} figure;

/* allocate a dynamic allocated figure */
figure* alloc_figure(char* name, int coordcount)
{
    figure *fig = malloc(sizeof(figure));
    fig->coordcount = coordcount;
    fig->pointer = malloc(sizeof(coords) * coordcount);
    strncpy(fig->fig_name, name, FIGURE_LEN);
    fig->fig_name[FIGURE_LEN] = 0;
    return fig;
}

/* release a dynamic allocated figure */
void free_figure(figure** ppfig)
{
    if (!*ppfig)
        return;

    free((*ppfig)->pointer);
    free(*ppfig);
    *ppfig = NULL;
}

int main(int argc, char *argv[])
{
    figure fig;
    fig.coordcount = 10;
    fig.pointer = malloc(10 * sizeof(coords));

    /* access fid.pointer[0..9] here... */
    fig.pointer[0].x = 1.0;
    fig.pointer[0].y = 1.0;

    /* don't  forget to free it when done */
    free(fig.pointer);

    /* dynamic allocation function use */
    figure *fig1 = alloc_figure("fig1", 10);
    figure *fig2 = alloc_figure("fig2", 5);

    fig1->pointer[9].x = 100.00;
    fig2->pointer[0].y = fig1->pointer[9].x;

    /* and use custom free function for releasing them */
    free_figure(&fig1);
    free_figure(&fig2);

    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T02:24:55.457

我认为这样的事情应该有效。

```
typedef struct {
  char* figNamePtr;
  int coordCount;
  Coords *cordsPointer;
  //void (*ReleaseMemory)(); // create this function.
} Figure;

typedef struct {
  double x;
  double y;
} Coords;

Figure * NewFigure(int coordCount){
    Figure * retVal = (Figure *) malloc(sizeof(Figure));

    /* Initialize Figure */
    retVal->figNamePtr = (char *) malloc(sizeof(char) * (FIGURE_LEN + 1));

    /* Set the Function pointer, 
       create a function named ReleaseMemory that free up the memory */
    //retVal->ReleaseMemory = ReleaseMemory;

    retVal->cordCount = coordCount

    retVal->cordsPointer = malloc(sizeof(Coords) * coordCount);

    return retVal;
} 
```

使用此代码，当您想创建一个新图形时，只需调用`NewFigure( )`带有必要参数的函数即可。使用完毕后，调用`ReleaseMemory()`.

希望能帮助到你！

# c# - 将静态对象从一个 dll 传递到另一个

> ID：13150327
> 
> 赞同：0
> 
> 时间：2012-10-31T02:14:05.253
> 
> 标签：c#

我知道，如果我有 2 个不同的 DLL，并且在每个 DLL 中我将同一个对象实例化为一个静态对象（例如，私有静态 MyObject objRandom = new MyObject();），则会创建它的 2 个实例。

如果我通过依赖注入将静态对象从 DllA 传递到 DllB 会怎样，我只会在堆栈中创建它的 1 个实例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:18:56.360

这取决于您的代码，但很可能是 1 个实例。静态是按 AppDomain 实例化的，而不是按 DLL 实例化的。您的 DLL 都加载到同一个应用程序域中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:22:06.117

对象不是静态的，引用是。您可以根据需要对同一实例进行尽可能多的引用。您的示例中的静态内容是您的类中的引用，因此包含的同一类的不同实例`static MyObject objRandom...`将具有相同的实例。

如果其他类以静态或非静态方式引用相同的对象，则可以。即使该类在另一个 DLL 中。

希望它澄清它是如何工作的。

# meteor - Meteor 0.5.0 示例不在 Windows 上运行

> ID：13150330
> 
> 赞同：2
> 
> 时间：2012-10-31T02:14:15.023
> 
> 标签：meteor

在 Windows Vista 上全新安装 Meteor 0.5.0。我没有得到基本的例子。创建empty'ish hello应用程序后也没有成功。shell 以管理员身份运行。Meteor 识别出我更改了​​源文件，但随后什么也没有。我在文件系统的哪个位置尝试这个并不重要。总是得到

```
Exited with code: -1073741819: 
```

例如

```
C:\Users\jawford\Meteor Apps\Examples>meteor create starter3
starter3: created.

To run your new app:
   cd starter3
   meteor

C:\Users\jawford\Meteor Apps\Examples>cd starter3

C:\Users\jawford\Meteor Apps\Examples\starter3>meteor
[[[[[ C:\Users\jawford\Meteor Apps\Examples\starter3 ]]]]]

Running on: http://localhost:3000/
Exited with code: -1073741819
Exited with code: -1073741819
Exited with code: -1073741819
Your application is crashing. Waiting for file change.
=> Modified -- restarting.
Exited with code: -1073741819
Exited with code: -1073741819
Exited with code: -1073741819
Your application is crashing. Waiting for file change.
^CTerminate batch job (Y/N)? y

C:\Users\jawford\Meteor Apps\Examples\starter3> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-29T08:26:18.383

如果您在使用 Windows 8 时遇到此问题，则需要更改节点可执行文件的兼容模式。

*   转到安装 Meteor 的文件夹
*   bin/node.exe 的打开属性
*   为 Windows 7 设置兼容模式

您现在应该能够像之前一样启动应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-01T17:08:30.747

这与未正确加载光纤有关。您可以尝试使用 运行`app/meteor/meteor.js`，`bin/node`两者都在 Program Files 的 Meteor 目录中。这可能会为您提供更多详细信息，为什么它会崩溃。在文件夹中运行测试也可能很方便，`lib/node_modules/fibers`这可能会指出 Fibers 行为不端的原因。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-06T11:32:47.170

退出代码 -1073741819 对应于 C0000005，表示访问冲突。

许多用户发现将兼容模式设置为“Windows 7”可以解决该问题，但并非总是如此，而且有证据表明它也发生在 Windows 7 上。

调查 win Meteor 0.5.9 上的后续问题，我发现 windows 上的纤维问题可以解释这个问题，我有一个暂定的修复。

请参阅：[https](https://github.com/TomWij/meteor/issues/66#issuecomment-15994548) ://github.com/TomWij/meteor/issues/66#issuecomment-15994548了解更多详情。

# php - PDO 插入不工作错误消息

> ID：13150331
> 
> 赞同：0
> 
> 时间：2012-10-31T02:14:15.900
> 
> 标签：php, mysql, pdo

我试图弄清楚为什么这不起作用我让它只添加一个表单条目然后添加电子邮件并且它破坏了它。这对 SQL 注入也安全吗？这是错误消息

```
ERROR: SQLSTATE[HY093]: Invalid parameter number: number of bound variables does not match number of tokens 
```

这是我的 insert.php 代码：

```
<?php 

try {
$conn = new PDO('mysql:host=localhost;dbname=info', 'blah', 'test');
$conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$stmt = $conn->prepare('INSERT INTO people (name, email) VALUES (:name, :email)');
$stmt->bindParam(':name', $POST_['name']);
$stmt->bindParam(':email', $_POST['email']);
$stmt->execute(array(':name' => $_POST['name']));
$stmt->execute(array(':email' => $_POST['email']));
#If one or more rows were returned...

} catch(PDOException $e){
    echo'ERROR: ' . $e->getMessage();
}

?> 
```

如果我只从表单中插入一个值，这是工作代码：

```
<?php 

try {
$conn = new PDO('mysql:host=localhost;dbname=encorem2_info', 'encorem2', 'Yamaha!32088!');
$conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$stmt = $conn->prepare('INSERT INTO people (name) VALUES (:name)');

$stmt->execute(array(':name' => $_POST['name']));

#If one or more rows were returned...

} catch(PDOException $e){
    echo'ERROR: ' . $e->getMessage();
}

?> 
```

这是我在单独文件中的 html 代码：

```
<!DOCTYPE html>

<html>
    <head>
        <title>Welcome!</title>

    </head>
    <body>

<form action="insert.php" method="post">
Name: <input type="text" name="name" id="name" />
Email: <input type="text" name="email" id="email"/>
<input type="submit" />
</form>

    </body>

</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:17:49.407

执行时绑定两个参数并跳过单独的`bindParam()`调用。

```
$stmt->bindParam(':name', $POST_['name']);
$stmt->bindParam(':email', $_POST['email']);
$stmt->execute(array(':name' => $_POST['name']));
$stmt->execute(array(':email' => $_POST['email'])); 
```

应该只是

```
$stmt->execute(array(':name' => $_POST['name'], ':email' => $_POST['email'])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:18:59.767

实际上，当您已经单独绑定了参数时，没有理由传递任何东西来执行。打电话

```
$stmt->execute(); 
```

在您的 bindParam 调用之后。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T02:19:36.623

您需要在[`bindParam`](http://php.net/manual/en/pdostatement.bindparam.php)OR中传递您的数据[`execute`](http://php.net/manual/en/pdostatement.execute.php)。更换会更简单

```
$stmt->bindParam(':name', $POST_['name']);
$stmt->bindParam(':email', $_POST['email']);
$stmt->execute(array(':name' => $_POST['name']));
$stmt->execute(array(':email' => $_POST['email'])); 
```

和

```
$stmt->execute(array(':name' => $_POST['name'],':email' => $_POST['email'])); 
```

# ruby-on-rails - 如何使用 Ruby on Rails 在生产环境中停止缓存布局？

> ID：13150334
> 
> 赞同：0
> 
> 时间：2012-10-31T02:14:22.357
> 
> 标签：ruby-on-rails, ruby-on-rails-3, caching

我正在构建一个 Rails 应用程序，允许管理员加载（和重新加载）一个 .erb 模板，该模板将用作布局。即application.html.erb

有时将已创建的模板更新到我的托管应用程序时，更改不会生效。如果我将不同名称的文件加载到同一个模板，这确实会显示更改。

这不是我本地环境的 DEV 中的问题，而是 PROD 的问题。是否有控制页面布局缓存的设置？动态内容没问题，但静态布局不会改变，除非我重新启动应用程序。如果您对此问题有任何出色的见解，或者是否需要更多解释，请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T06:31:03.050

刚刚想通了 - 将其添加到您的 production.rb 环境文件中；

```
config.action_view.cache_template_loading = false 
```

# algorithm - 和组合列表

> ID：13150340
> 
> 赞同：0
> 
> 时间：2012-10-31T02:15:21.317
> 
> 标签：algorithm

我需要一个算法来解决这个问题：

给定一组 n 个自然数 x1,x2,...,xn，一个数 S 和 k。用 sum S 形成从集合中选择的 k 个数字的总和（一个数字可以选择多次）。

换一种说法：列出 S 的所有可能组合，有界：n<=256, x<=1000, k<=32

例如

```
 problem instance: {1,2,5,9,11,12,14,15}, S=30, k=3
  There are 4 possible combinations
  S=1+14+15, 2+14+14, 5+11+15, 9+9+12\. 
```

有了这些界限，使用蛮力是不可行的，但我认为动态编程是一种好方法。

该方案是： 表 t，其中 t[m,v] = 由 m 个数组成的总和 v 的组合数。

```
1\. Initialize t[1,x(i)], for every i.   
2\. Then use formula t[m,v]=Sum(t[m-1,v-x(i)], every i satisfied v-x(i)>0), 2<=m<=k.   
3\. After obtaining t[k,S], I can trace back to find all the combinations. 
```

困境是 t[m,v] 可以通过重复的交换组合增加，例如，由于 16=15+1 和 1+15，t[2,16]=2。此外，最终结果 f[3,30] 很大，因为 1+14+15, 1+15+14, ...,2+14+14,14+2+14,...

如何摆脱对称排列？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T04:03:17.313

您可以通过对选择 x 元素的方式进行排序来消除排列。使您的表格成为三重`t[m, v, n]`=由 中的数字`v`组成的总和组合`m`数`x1..xn`。现在观察`t[m, v, n] = t[m, v, n-1] + t[m-1, v-x_n, n]`。这通过仅以与它们在 x 中的出现相反的顺序生成和数来解决排列问题。例如，它会生成 15+14+1 和 14+14+2，但不会生成 14+15+1。

（您可能不需要填写整个表格，因此您可能应该懒惰地计算；实际上，这里可能需要一个记忆递归函数。）

# c# - 常量不能标记为静态

> ID：13150343
> 
> 赞同：100
> 
> 时间：2012-10-31T02:16:22.747
> 
> 标签：c#

我正在尝试像这样声明一个 PI 常量：

```
public static const double PI = Math.PI; 
```

但为什么我会收到这个错误？

```
The constant 'Calendar.NewCalendar.PI' cannot be marked static 
```

* * *

## 回答 #1

> 赞同：205
> 
> 时间：2012-10-31T02:23:11.167

`const`暗示`static`（您不需要实例来引用该`const`值）。

我还想补充一点：当您使用 a 链接（引用）程序集时`public const`，该值将被**复制**到您的程序集中。因此，如果`const`引用程序集中的值发生更改，您的程序集仍将具有最初编译的值。

如果这种行为是*不可接受*的，那么您应该考虑将字段设为`public static readonly`字段。

*Lib.dll，以二进制形式提供：*

```
public class Foo {
    public const int HATS = 42;
    public static readonly int GLOVES = 33;
} 
```

*App.exe，引用 Lib.dll：*

```
Foo.HATS    // This will always be 42 even if the value in Lib.dll changes,
            // unless App.exe is recompiled.

Foo.GLOVES  // This will always be the same as Foo.GLOVES in Lib.dll 
```

* * *

来自[MSDN](https://msdn.microsoft.com/en-us/library/e6w8fe1b.aspx)：

> 不要创建一个常量来表示您希望随时更改的信息。例如，不要使用常量字段来存储服务的价格、产品版本号或公司的品牌名称。这些值会随着时间而改变，并且由于**编译器会传播常量**，因此使用您的库编译的其他代码必须重新编译才能看到更改。

来自[DotNetPerls](http://www.dotnetperls.com/readonly)：

> DLL。当您使用`const`字段或声明时，C# 编译器实际上将`const`变量的值直接嵌入到 IL 代码中。因此，它本质上将 删除`const`为一个单独的实体。
> 
> 注意：如果依赖 a 的程序在值更改`const`后没有重新编译，它们可能会中断 [*因为它们将继续使用以前的值*]。`const`

 ** * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-10-31T02:18:06.153

根据定义，常量是静态的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-31T02:17:50.717

你不能有静态常量。尝试 readonly 而不是 const 或简单地删除“static”，因为“const”无论如何都是隐含的静态。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-10-31T02:19:33.703

在编译期间不能在代码中替换常量，而不是在运行时替换，因此不需要静态与实例定义。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-08-25T08:00:11.943

所有常量声明都是隐式静态的，并且 C# 规范声明禁止（冗余）包含 static 修饰符。我相信这是为了避免读者看到两个常量时可能发生的混淆，一个声明为静态的，一个未声明——他们可以很容易地假设规范中的差异意味着语义上的差异。话虽如此，并没有禁止冗余指定访问修饰符，这也是默认访问修饰符，可以选择。例如，可以将（具体）方法显式标记为私有，尽管这是默认方法。规则似乎是在没有选择的情况下（例如接口中的方法声明），禁止使用冗余修饰符。哪里有选择，哪里就允许。*

# python - 从文件中提取单词，然后列出文件以及包含这些单词的行号

> ID：13150345
> 
> 赞同：1
> 
> 时间：2012-10-31T02:16:56.303
> 
> 标签：python, bash

我有一个名为 Strings.h 的文件，我用它来本地化我拥有的应用程序。我想搜索我所有的类文件，找出我是否以及在哪里使用每个字符串，并输出每个字符串的类和行号。

我的想法是使用 Python，但也许那是适合这项工作的错误工具。另外，我有一个基本算法，但我担心运行时间太长。你能写这个脚本来做我想做的事，或者只是建议一个更好的算法吗？

Strings.h 看起来像这样：

```
#import "NonLocalizedStrings.h"

#pragma mark Coordinate Behavior Strings
#define LATITUDE_WORD NSLocalizedString(@"Latitude", @"used in coordinate behaviors")
#define LONGITUDE_WORD NSLocalizedString(@"Longitude", @"used in coordinate behaviors")
#define DEGREES_WORD NSLocalizedString(@"Degrees", @"used in coordinate behaviors")
#define MINUTES_WORD NSLocalizedString(@"Minutes", @"Used in coordiante behaviors")
#define SECONDS_WORD NSLocalizedString(@"Seconds", @"Used in DMSBehavior.m")

... 
```

该脚本应获取以#define 开头的每一行，然后列出出现在#define 之后的单词（例如）LATITUDE_WORD

伪代码可能是：

```
file = strings.h
for line in file:
  extract word after #define
  search_words.push(word) 

print search_words
[LATITUDE_WORD, LONGITUDE_WORD, DEGREES_WORD, MINUTES_WORD, SECONDS WORD] 
```

在获得单词列表后，我的伪代码类似于：

```
found_words = {}
for word in words:
   found_words[word] = []

for file in files:
  for line in file:
    for word in search_words:
      if line contains word:
        found_words[word].push((filename, linenumber))   

print found_words 
```

因此，找到的单词看起来像：

```
 {
   LATITUDE_WORD: [
                    (foo.m, 42),
                    (bar.m, 132) 
                  ],
   LONGITUDE_WORD: [
                    (baz.m, 22),
                    (bim.m, 112) 
                  ],

 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T02:39:18.650

这个 [in bash] 怎么样？

```
$ pattern="\\<($(grep '^#define ' Strings.h | cut -d' ' -f2 | tr '\n' '|' | sed 's/|$//'))\\>"
$ find project_dir -iname '*.m' -exec egrep -Hno "${pattern}" {} + > matches 
```

输出：

```
project_dir/bar.m:132:LATITUDE_WORD
project_dir/baz.m:22:LONGITUDE_WORD
project_dir/bim.m:112:LONGITUDE_WORD
project_dir/foo.m:42:LATITUDE_WORD 
```

**编辑**：我已经更改了上面的代码以将其输出重定向到文件`matches`，因此我们可以使用它来显示从未找到的单词：

```
for word in $(grep '^#define ' Strings.h | cut -d' ' -f2)
do
    if ! cut -d':' -f3 matches | grep -q "${word}"
    then
        echo "${word}"
    fi
done 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T03:38:14.397

所以，看起来你的想法是对的。以下是您所拥有的一些优点和缺点。

**优点：**

*   如果您使用 Python，您的伪代码几乎会逐行直接转换为您的脚本。
*   你可以学习更多关于 Python 的知识（对于这样的事情有很好的技能）。

**缺点：**

*   Python 的运行速度将比已发布的其他一些基于 bash 的解决方案慢一些（如果您有很多文件要搜索，这将是一个问题）。
*   您的 Python 脚本将比这些其他解决方案长一点，但您的输出也可以更灵活一点。

**答：** 因为我熟悉 Python，而这正是您最初要求的，所以您可以使用更多代码：

```
#!/usr/bin/env python

# List the files you want to search here
search_files = []
word_file = open('<FILE_PATH_HERE>', 'r')

# Allows for sorted output later.
words = []

#Contains all found instances.
inst_dict = {}

for line in word_file:
    if line[0:7] == "#define":
        w = line[7:].split()[0]
        words.append(w)
        inst_dict[w] = []

for file_name in search_files:
    file_obj = open(file_name, 'r')
    line_num = 0
    for line in file_obj:
        for w in words:
            if w in line:
                inst_dict[w].append((file_name,line_num))
        line_num += 1

# Do whatever you want with 'words' and 'inst_dict'
words.sort()
for w in words:
    string = w + ":\n"
    for inst in inst_dict[w]:
        string += "\tFile: " + inst[0] + "\n"
        string += "\tLine: " + inst[1] + "\n"
    print string 
```

我没有测试代码的搜索部分，所以使用“原样”需要您自担风险。祝你好运，随时提出问题或根据需要扩充代码。您的请求非常简单并且有很多解决方案，所以我希望您了解它是如何工作的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T08:03:44.533

此解决方案使用`awk`and `globstar`（后者需要 Bash 4）。我认为可以进一步改进，但认为这是一种草稿。

```
shopt -s globstar

awk 'NR==FNR { if ($0 ~ /^#define/) found[$2]=""; next; } 
     {
       for (word in found){
         if ($0 ~ word) 
           found[word]=found[word] "\t" FILENAME ":" FNR "\n";
       } 
     }
     END { for (word in found) print word ":\n" found[word]}
    ' Strings.h **/*.m 
```

使用您发布的 Strings.h 片段，这是我得到的输出类型（我编写了一些测试文件）

```
LATITUDE_WORD:
    lala1.m, 2
    lala3.m, 1

DEGREES_WORD:
    lala2.m, 5

SECONDS_WORD:

MINUTES_WORD:
    lala3.m, 3

LONGITUDE_WORD:
    lala3.m, 2 
```

p/s：`globstar`由于我现在使用的 bash 是 v3（pfff！） ，因此尚未对此进行测试

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T02:24:33.167

你应该试试 ：

```
grep -oP '^#define\s+\K\S+' strings.h 
```

如果您`grep`缺少该`-P`选项：

```
perl -lne 'print $& if /^#define\s+\K\S+/' strings.h 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T02:37:54.063

这是一个 Python 程序。它可能可以减少并变得更简单，但它确实有效。

```
import re
l=filecontent.split('\n')
for item in l:
  if item.startswith("#define"):
    print re.findall("#define .+? ", item)[0].split(' ')[1] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-31T02:53:53.593

```
#!/bin/bash
# Assuming $files constains a list of your files
word_list=( $(grep '^#define' "${files[@]}" | awk '{ print $2 }') ) 
```

# javascript - 检测手势事件中使用的手指数

> ID：13150351
> 
> 赞同：7
> 
> 时间：2012-10-31T02:17:42.527
> 
> 标签：javascript, dom-events, gesture

我想实现一个功能，当用户使用两根手指进行缩放时缩放对象。

我正在尝试使用`gesturechange`事件来实现它，但我发现只要手指数超过一就会触发事件。当用户使用太多手指操作对象时，我想停止缩放（很难获得正确的位置和比例）。

我可以在`gesturechange`发射时检测手指的数量吗？我知道`touchstart`事件有一个 event.touches.length 可以得到它。但我想知道`gesturechange`事件中的相同属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-22T08:18:48.463

实际上，这仅在 IOSX 设备上是可能的。Android 不会将此信息公开给 javascript。例如，您有：

```
document.ongesturechange=function(e)
{
    //e.scale
    //fingers=e.touches.length;
}; 
```

事件，但这仅适用于 iphone/ipad。

一些 jquery 库，如[http://jgestures.codeplex.com/](http://jgestures.codeplex.com/)可以帮助在 android 上模拟手势事件。

# c# - 如何将WPF应用程序最小化到桌面右下角？

> ID：13150355
> 
> 赞同：0
> 
> 时间：2012-10-31T02:18:01.710
> 
> 标签：c#, wpf

有谁知道如何通过单击某个按钮将 wpf 窗口最小化到右下角？我希望当我单击 X 按钮时发生这种情况。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:23:21.280

NotifyIcon 控件用于向系统托盘添加项目。我认为它不存在于 WPF 中，但您应该能够在您的应用程序中使用 winforms 之一。

从头开始实施有一些 WPF 示例。
[http://visualstudiogallery.msdn.microsoft.com/aacbc77c-4ef6-456f-80b7-1f157c2909f7](http://visualstudiogallery.msdn.microsoft.com/aacbc77c-4ef6-456f-80b7-1f157c2909f7)

# sql - 如何显示第一行，取决于一个值

> ID：13150356
> 
> 赞同：1
> 
> 时间：2012-10-31T02:18:01.387
> 
> 标签：sql, sql-server, sql-server-2005

我应该建立一个查询来显示产品是否第一次通过了质量测试。例如，如果产品# 1234 未通过第一次测试，则不显示该值。我正在运行 SQL Server 2005。我在想可能使用`COALESCE`语句或 case when 语句，任何帮助将不胜感激。这是一些示例数据：

```
product#  test result   datetime
1102494    Fail         20111129:07:57:50.203
1102494    pass         20111130:16:48:28.140
1102496    pass         20111129:11:09:32.140
1102498    pass         20111129:08:21:10.218 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T02:40:24.703

仅显示第一个结果，并且仅当第一个结果是“通过”时。

```
select *
  from (
select *, rn=row_number() over (partition by [product#] order by [datetime] desc)
  from tests
     ) x
 where rn=1 and result = 'pass'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T02:23:59.313

你不能选择 where test_result = 'pass' 吗？也许我误解了你的问题

# git - 强制删除缓存

> ID：13150365
> 
> 赞同：6
> 
> 时间：2012-10-31T02:19:04.767
> 
> 标签：git

我可以知道终端中强制从 GIT 中删除缓存的命令是什么吗？

据我所知，要删除 GIT 是 git rm --cached thefilename

但现在我收到一个错误

错误：“tutorial.h”的暂存内容与文件和 HEAD 都不同（使用 -f 强制删除）

那么，我可以知道我将如何删除它吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-31T02:31:10.027

```
git rm --cached -f thefilename 
```

# c# - 如何打开两个单独的（默认）浏览器窗口而不是新标签

> ID：13150366
> 
> 赞同：5
> 
> 时间：2012-10-31T02:19:18.733
> 
> 标签：c#, browser, process.start

我正在尝试使用 C#并排打开两个单独的浏览器**窗口。**我试过使用`Process.Start(url)`，但这会导致 Chrome 打开新标签而不是新窗口。这似乎适用于 IE，但是我希望有可以与不同类型的浏览器一起使用的代码，即：IE、Chrome、Firefox 和 Safari。如何检测默认浏览器，然后并排打开两个单独的窗口？此外，我希望能够将两个窗口彼此相邻放置，这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-07-03T20:27:05.210

如果您想在 chrome 中打开新窗口而不是新选项卡，此代码对我有用

```
 Process process = new System.Diagnostics.Process();
  process.StartInfo.FileName = "chrome";
  process.StartInfo.Arguments = <yoururl> + " --new-window"; 
  process.Start(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T02:20:01.817

这更多是关于浏览器的配置方式，而不是从 C# 调用进程的方式。在这两种情况下，系统都会简单地调用分配给处理 URL 的默认程序。该命令可能有也可能没有参数，但通常它会简单地调用`chrome.exe <url>`并从那里`chrome.exe`决定如何处理参数。

我知道的唯一方法是检查注册表（在 下`HKEY_CLASSES_ROOT\http\shell\open\command`）并解析字符串值。一旦您知道特定的浏览器，您就可以使用命令行参数来控制演示。当然，这是特定于 Windows 的，管理起来可能很麻烦。

如果浏览器不支持从命令行设置几何图形，则需要使用[FindWindow](http://msdn.microsoft.com/en-us/library/ms633499%28VS.85%29.aspx)和[SetWindowPos](http://msdn.microsoft.com/en-us/library/ms633545%28VS.85%29.aspx)（使用 P/Invoke）来操作窗口位置。

我不确定您的应用程序，但嵌入[WebBrowser 控件](http://msdn.microsoft.com/en-us/library/3s8ys666.aspx)会满足您的需求吗？然后，您将完全控制演示文稿。

# android - ADT Eclipse 依赖错误

> ID：13150369
> 
> 赞同：0
> 
> 时间：2012-10-31T02:19:41.413
> 
> 标签：android, eclipse-plugin, adt

尝试在新解压缩的 Eclipse 中安装 ADT 插件，但遇到此问题，知道吗？

```
Cannot complete the install because of a conflicting dependency.
  Software being installed: Android DDMS 20.0.3.v201208082019-427395 (com.android.ide.eclipse.ddms.feature.group 20.0.3.v201208082019-427395)
  Software currently installed: Eclipse IDE for Java EE Developers 1.3.0.20100617-0521 (epp.package.jee 1.3.0.20100617-0521)
  Only one of the following can be installed at once: 
    Eclipse UI 3.6.1.M20100826-1330 (org.eclipse.ui 3.6.1.M20100826-1330)
    Eclipse UI 3.6.2.M20110203-1100 (org.eclipse.ui 3.6.2.M20110203-1100)
    Eclipse UI 3.6.0.I20100603-1100 (org.eclipse.ui 3.6.0.I20100603-1100)
  Cannot satisfy dependency:
    From: Android DDMS 20.0.3.v201208082019-427395 (com.android.ide.eclipse.ddms.feature.group 20.0.3.v201208082019-427395)
    To: org.eclipse.ui 3.6.2
  Cannot satisfy dependency:
    From: Eclipse IDE for Java EE Developers 1.3.0.20100617-0521 (epp.package.jee 1.3.0.20100617-0521)
    To: org.eclipse.epp.package.jee.feature.feature.group [1.3.0.20100617-0521]
  Cannot satisfy dependency:
    From: Java EE IDE Feature 1.3.0.20100617-0521 (org.eclipse.epp.package.jee.feature.feature.group 1.3.0.20100617-0521)
    To: org.eclipse.platform.feature.group [3.6.0.v20100602-9gF78GpqFt6trOGhL60z0oEx3fz-JKNwxPY]
  Cannot satisfy dependency:
    From: Eclipse Platform 3.6.0.v20100602-9gF78GpqFt6trOGhL60z0oEx3fz-JKNwxPY (org.eclipse.platform.feature.group 3.6.0.v20100602-9gF78GpqFt6trOGhL60z0oEx3fz-JKNwxPY)
    To: org.eclipse.rcp.feature.group [3.6.0.v20100519-9OArFKvFtsd7WLUKh-DcYTS]
  Cannot satisfy dependency:
    From: Eclipse RCP 3.6.0.v20100519-9OArFKvFtsd7WLUKh-DcYTS (org.eclipse.rcp.feature.group 3.6.0.v20100519-9OArFKvFtsd7WLUKh-DcYTS)
    To: org.eclipse.ui [3.6.0.I20100603-1100] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:38:35.170

您现在使用的是哪个版本的 Eclipse？我认为最新的 adt 至少需要 3.6.2 eclipse。

# javascript - 一个接受参数但在构造函数体内没有“变量”的对象构造函数，数据在哪里？

> ID：13150375
> 
> 赞同：4
> 
> 时间：2012-10-31T02:20:43.667
> 
> 标签：javascript, parameters, constructor, attributes, closures

参数提供的数据存储在哪里？是`var first`隐式创建的吗？

```
function Student(first){
   this.getFirst = function(){
     return first;
   }
} 
```

经测试：

`var myStudent = new Student("ross");`

`console.log(myStudent);`// 学生 { getFirst=function() }

`console.log(myStudent.getFirst());`// 罗斯

`console.log(first);`// 引用错误，首先没有定义

`console.log(myStudent.first);`// 不明确的

`for(var x in myStudent){ console.log(x); }`// 获取第一个

我的第二个问题是我是否正确理解这些：

[JavaScript 构造函数中的“var”变量会发生什么？](https://stackoverflow.com/questions/11955538/what-happens-with-var-variables-inside-a-javascript-constructor)

[“var”变量、“this”变量和“global”变量 - 在 JavaScript 构造函数中](https://stackoverflow.com/questions/11957191/var-variables-this-variables-and-global-variables-inside-a-javascript-c)

...该`getFirst`函数是否创建一个闭包并保存构造函数参数值的状态，如果我`var first`在构造函数主体中使用 a 是否可以将其视为“封装”？此外，*任何*内部函数都将所有参数值保存在“关闭状态”中，还是只保存内部函数引用的参数值？

非常感谢您的想法。这是我关于 SO 的第一个问题，但几乎每天都使用该网站作为参考，所以谢谢你。我的编程知识有限，如果我使用了蹩脚的术语，请原谅，很高兴在需要的地方澄清。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T02:37:09.303

`first`参数在本地存储到作为构造函数的函数中，因此它内部的任何地方都`Student()`在范围内。

更有趣的是，您分配给的匿名内部函数正在`this.getFirst`关闭*该*值。`first`因此，即使在构造函数完成执行后，内部函数也会保持对变量的引用。

这也适用于常规函数，而不仅仅是构造函数：

```
function makeCounter() {
   var count = 1;
   return function() { return count++; };
}

var counter = makeCounter();
console.log(counter());  // 1
console.log(counter());  // 2
console.log(counter());  // 3 
```

如果使用得当，这种方法可用于在 JavaScript 中实现“私有”变量，因为闭包中捕获的值无法从外部访问。

正因为如此，结果证明闭包是捕获其范围内的所有变量还是仅捕获它使用的变量都无关紧要，因为无论如何您都无法“进入”这些封闭变量。（尽管在实践中通常只捕获使用的值，以便运行时可以垃圾收集其余的值，因为它们是不需要的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:33:36.563

为了进一步了解您的要求，这不是关于创建 a `var`，而是在您的实例中，该函数还保留了`arguments`数组。

您的函数可以愉快地在两者上创建闭包。通过从您的函数返回函数，只要您不覆盖这些函数
，那些返回的函数（或具有作为方法的函数的对象）就可以访问任何和所有`vars`and 。`arguments`

闭包的魔力。

# linux - epoll_wait返回EPOLLERR时如何获取errno？

> ID：13150377
> 
> 赞同：14
> 
> 时间：2012-10-31T02:20:47.893
> 
> 标签：linux, epoll

有没有办法找出特定 fd的`errno`何时`epoll_wait`返回？`EPOLLERR`

是否有任何关于错误性质的进一步信息？

**编辑：**

添加更多信息以防止歧义

`epoll_wait`等待多个文件描述符。当你打电话`epoll_wait`给它时，你会传递一个结构数组`epoll_event`：

```
struct epoll_event {
           uint32_t     events;    /* Epoll events */
           epoll_data_t data;      /* User data variable */
       }; 
```

该结构与您用于向 epoll 添加文件描述符的`epoll_data_t`结构具有相同的细节：`epoll_ctl`

```
typedef union epoll_data {
           void    *ptr;
           int      fd;
           uint32_t u32;
           uint64_t u64;
       } epoll_data_t; 
```

我正在寻找的是当 epoll 正在等待的文件描述符之一出现错误时会发生什么。

即：`(epoll_event.events & EPOLLERR) == 1`- 有没有办法找出文件描述符上错误的更多细节？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-21T07:30:06.230

使用 getsockopt 和 SO_ERROR 获取套接字上的未决错误

```
int       error = 0;
socklen_t errlen = sizeof(error);
if (getsockopt(fd, SOL_SOCKET, SO_ERROR, (void *)&error, &errlen) == 0)
{
    printf("error = %s\n", strerror(error));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-26T19:10:22.770

只是一个小问题：您的测试将无法正常工作，原因有两个。如果 EPOLLERR 被定义为 0x8，那么您的测试会将 8 与 1 进行比较（因为 == 的优先级高于 &），给您一个 0，然后将其与事件掩码相加。

你想要的是： (epoll_event.events & EPOLLERR) != 0 来测试设置的 EPOLLERR 位。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-31T05:14:50.530

epoll_wait 在发生错误时返回 -1 并适当地设置 errno。有关更多信息，请参阅“man 2 epoll_wait”。

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2012-10-31T08:41:02.107

包括 errno.h 并使用 perror 查看错误消息。基本上错误来自 epfd 或中断，它不会来自您集合中的文件描述符。

# 包括“errno.h”

```
if(epoll_wait() == -1)
    {
      perror("Epoll error : ");
    } 
```

# javascript - 侦听 TCP 数据包如何获取数据并使用 node.js 发送 UDP

> ID：13150378
> 
> 赞同：1
> 
> 时间：2012-10-31T02:20:52.473
> 
> 标签：javascript, node.js, tcp, proxy, udp

我正在尝试在端口上侦听 TCP 数据包，然后从中获取数据并将其转发到 UDP 端口。原因是在 UDP 端口上侦听的软件只接受 UDP，但我想使用 javascript websockets 向它发送仅使用 TCP 的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:30:11.583

WebSockets 不仅仅是一个简单的 TCP 套接字。该协议基本上是一个 HTTP 升级握手（包含一些 WebSockets 特定的安全握手）。

如果你只是监听一个端口并盲目地转发数据，它是行不通的，因为浏览器实际上无法建立 WebSocket 连接。

您是否考虑过使用[socket.io](http://socket.io)来处理 WebSocket 端的事情？

然后很简单，只需用于[`dgram`](http://nodejs.org/api/dgram.html)通过 UDP 发送数据：

```
io.sockets.on('connection', function (socket) {
  socket.on('sendudp', function (data) {
    var buf = new Buffer(data), udp = dgram.createSocket("udp4");

    udp.send(buf, 0, buf.length, 41234, "localhost", function(err, bytes) {
      udp.close();
    });
  });
}); 
```

显然用所需的目标端口和主机替换`41234`and 。`localhost`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T09:48:31.027

没有“TCP 数据包”之类的东西，因此无法接收。TCP 呈现一个字节流。您的 UDP 接收器所期望的数据报是否与您在 TCP 流上接收到的数据相对应，只有您自己知道，但您需要意识到这是非常有问题的。

# javascript - 从json动态生成复选框列表

> ID：13150379
> 
> 赞同：2
> 
> 时间：2012-10-31T02:21:00.420
> 
> 标签：javascript, jquery, json, checkboxlist

我正在根据 json 数据的内容动态生成复选框列表：

临时通道格式： `[{"FairWay":"A"},{"FairWay":"B"}, {"FairWay":"C"}, {"FairWay":"D"}]`

```
var topics = tempfairway;
var topicContainer = $('ul#fairway_list');
$.each(topics, function (iteration, item) { topicContainer.append(
$(document.createElement("li")).append(
$(document.createElement("input")).attr({
        id: 'topicFilter-' + item,
        name: item, 
        value: item,
        type: 'checkbox',
        checked: true
        })
        //onclick
        .click(function (event) {
         var cbox = $(this)[0];
         alert(cbox.value);
         })
).append(
$(document.createElement('label')).attr({
'for': 'topicFilter' + '-' + item
}).text(item)
   )
     )
}); 
```

复选框生成正确的数字，但我得到的是 [object Object] 而不是球道的名称。

有想法该怎么解决这个吗？

还有几个问题要补充：-如果我只想在 tempfairway 中显示唯一值怎么办？-.Click 设置为获取单个复选框的值，如果我想遍历所有复选框并获取在用户未选择其中任何一个的情况下选择的所有复选框的值怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:30:37.223

在行中：

```
> $.each(topics, function (iteration, item) { 
```

item 是一个类似的对象`{"FairWay":"A"}`，所以你有：

```
> .text(item) 
```

你可能想要：

```
 .text(item.FairWay) 
```

对于`item`. 或者您可以将值存储在变量中并使用它：

```
var fairwayName = item.FairWay;
...
.text(fairwayName); 
```

# c# - 单元格内的 ITextSharp 图像定位

> ID：13150380
> 
> 赞同：2
> 
> 时间：2012-10-31T02:21:12.557
> 
> 标签：c#, pdf, itextsharp

我试图在 ITextSharp 的表格单元格中偏移图像的位置。下面是一些伪代码，概述了我的一些尝试，这些尝试似乎都不会影响图像的定位。我特别想将图像的中间与单元格的左边框对齐，但我什至根本不知道如何移动图像。

```
doc.Open();
var table = new PdfPTable(1);
var cell = new PdfPCell();
var image = Image.GetInstance(); //etc

image.SetAbsolutePosition(-10, 0); //no effect
image.Left -= 10; //no effect
image.IndentationRight = 10; // no effect

cell.AddElement(image);
table.Rows.Add(new PdfPRow(new PdfPCell[] { cell }));
doc.Add(table); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T08:54:18.267

将图像添加到单元格时，使用绝对位置或更改图像的属性不会产生影响。如果我正确解释了您的问题，您希望为单元格定义一个填充，以便左侧有 10pt 的空间。只需在单元格对象上使用适当的填充方法（在 iText 中，就是`cell.setPaddingLeft(10);`）。

# php - 为列选择“as”命名法

> ID：13150383
> 
> 赞同：-1
> 
> 时间：2012-10-31T02:21:56.940
> 
> 标签：php, mysql, select, recordset

看起来很简单，但我在这里做错了什么？我只想要给定供应商 ID 的列中的最大值。我可以`as`在记录集中使用该子句吗？

```
$query = mysql_query("SELECT max(container_no) as newcontainer 
  FROM FETE_profiles WHERE vendor_id = '$mvendorid'");

while($rst = mysql_fetch_array($query)) {
    print $rst[newcontainer] . "<br/>";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:30:07.590

是的，你能想到......
但是当你想打印它时，只需像这样添加单引号
`$rst['newcontainer']`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:08:22.080

试试这样

```
$query = "SELECT max(container_no) as newcontainer 
      FROM FETE_profiles WHERE vendor_id = ".$mvendorid." ";

    $result = $mysql->execute_sql_query($query);
    while(@$rows = mysql_fetch_array($result))
     {
        print $rows['newcontainer ']. "<br/>";
    } 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-31T11:46:12.530

让它工作每个人都感谢您的所有回答。这是上面的代码，将供应商 ID 推送到该 sql 语句中，该语句在配置文件表中没有代表行。

呃！好吧，当您没有同行评审的奢侈时，就会发生这种情况:-)

# oracle - 如何通过 nocycle 使用 Oracle Connect

> ID：13150386
> 
> 赞同：1
> 
> 时间：2012-10-31T02:22:34.410
> 
> 标签：oracle

如何在sql（oracle）中通过nocycle使用oracle connect？

```
where connect_by_iscycle = 1 
CONNECT BY NOCYCLE (prior cowner, prior ctable) = ANY (powner, ptable); 
```

以上条件给了我一个错误，**ORA-00904 'NOCYCLE' 无效标识符**

如果我评论 'CONNECT BY NOCYCLE' 行，我会收到错误： **ORA-00904 'connect_by_iscycle' 无效标识符**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T04:07:02.480

什么版本的甲骨文？我似乎记得 CONNECT BY 是在一个版本中发布的，而 NOCYCLE 等是在更高版本中发布的。我发现一个参考说明 NOCYCLE 在 9i 中不可用，即使 CONNECT BY 是

# ruby-on-rails - 为什么时间戳都被 Rails 和 Postgres 延迟了？

> ID：13150387
> 
> 赞同：0
> 
> 时间：2012-10-31T02:23:00.917
> 
> 标签：ruby-on-rails, datetime

我正在使用以下内容来显示创建思考条目的时间：

```
<%= l musing.created_at, :format => "%d/%m/%y at %I:%M %p" %> 
```

并且时间延迟了 5 个小时，例如，如果我在“2012-10-30 19:21:35 -0700”产生一个思考，这是显示的时间：

```
31/10/12 at 02:21 am  by me@benigeri.com 
```

# mysql - 扩展的 ASCII 字符显示为 MySQL db 中的垃圾是通过 perl 插入的

> ID：13150392
> 
> 赞同：1
> 
> 时间：2012-10-31T02:23:39.667
> 
> 标签：mysql, perl, extended-ascii

我有一个 MySQL 'articles' 表，我正在尝试使用 SQLyog 进行以下插入。

```
insert into articles (id,title) values (2356606,'Jérôme_Lejeune'); 
```

这工作正常，当我进行选择查询时数据显示正常。

问题是，当我通过我的 perl 脚本执行相同的插入查询时，名称会出现一些垃圾字符，而不是数据库中的 é 和 ô。我需要知道如何通过我的脚本正确存储名称。执行插入的代码部分是这样的。

```
$sql_insert = "insert into articles (id,title) values (?,?)";
$sth_insert = $dbh->prepare($sql_insert);
$sth_insert->execute($id,$title); 
```

$id 和 $title 具有正确的所需数据，我在插入它们之前已通过打印检查过这些数据。请协助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T03:08:14.050

你已经打开了蠕虫的*字符编码*罐，在你解决这个问题并让它得到解决之前，你需要学习很多东西。

您可能已经习惯于思考如何将文本字符编码为一串位。例如在ASCII编码下，使用8位字符串`01000001`（65）来表示`A`字符。当您开始考虑有多少种不同的语言以及有多少种不同的字符时，您很快就会意识到 8 位编码不会让您走得太远。因此，许多其他字符编码已经激增。一些最受欢迎的是[`latin1`(ISO-8859-1)](http://en.wikipedia.org/wiki/ISO/IEC_8859-1)和[`UTF-8`](http://en.wikipedia.org/wiki/UTF-8). 这两种编码都可以呈现`é`和`ô`字符，但它们使用完全不同的位串来表示它们。当您写入文件（或终端）或向数据库添加一行时，Perl 和 MySQL 对输出流的字符编码有一个概念。读取数据时也会使用编码。如果您不知道这种编码是什么，那么在存储和检索数据时说数据看起来不错/看起来很糟糕是没有任何意义的。

Perl 和 MySQL 可以通过正确的设置处理这两种编码以及更多。您选择使用哪种编码并不像确保应用程序的所有部分都使用相同的编码那么重要。但是你应该选择一种编码

1.  可以编码你需要的所有字符（对于这个问题，你提到了`é`and `ô`，但是还有其他的吗？将来呢？）
2.  应用程序的所有部分（前端、数据库、后端）都支持

以下是一些建议阅读，可帮助您朝着正确的方向前进：

*   [`Encode`](http://search.cpan.org/perldoc?Encode)Perl的模块
*   [MySQL中的字符集](http://dev.mysql.com/doc/refman/5.0/en/charset-syntax.html)
*   （其他人应该随时推荐其他链接）

我不能对 MySQL 说太多，但是 Perl 中的字符编码支持正在迅速发展（这并不是说它不好）。最新版本的 Perl 将对 ASCII 以外的字符提供最好的支持（对于最晦涩的字符集）和最好的特性（例如，正则表达式和字符类）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T20:15:57.883

有几件事要遵循。

首先，您必须确保 Perl 理解在您的程序和 DB 之间移动的数据被编码为 UTF-8（我希望您的数据库和表设置正确）。为此，您需要在连接到数据库时大声说出来，如下所示：

```
 my($dbh) = DBI->connect(
     'dbi:mysql:test',
     'user',
     'password',
     {
         mysql_enable_utf8 => 1,
     }      
); 
```

接下来，您需要将数据发送到输出，并且必须将其设置为将数据解码为 UTF-8。为此，我喜欢非常好的模块：

```
use utf8::all; 
```

但是这个模块不是核心，所以你可能也想自己设置它`binmode`：

```
binmode STDIN, ":utf8"; 
binmode STDOUT, ":utf8"; 
```

如果您处理网页，则必须确保该浏览器理解您正在发送编码为 UTF-8 的数据。为此，您应该确保您的 HTTP 标头包含编码：

```
Content-Type: text/html; charset=utf-8; 
```

并使用 HTML META-tag 设置它：

```
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
```

现在你应该把你的路盖好。

# c++ - openGL 2D 移动和对象 1 个单位

> ID：13150393
> 
> 赞同：0
> 
> 时间：2012-10-31T02:23:51.883
> 
> 标签：c++, opengl, 2d, glut

我对如何通过按键移动对象有一些疑问。我要做的就是按下键盘上的向上按钮并使对象移动一个单位。

```
void display(){

    //Clear Window
    glClear(GL_COLOR_BUFFER_BIT);

    glPushMatrix();
    glBegin(GL_POLYGON);
    glColor3f(1.0, 0.0, 0.0);
    glVertex2f(-0.1, -0.2);
    glVertex2f(-0.1, 0.2);
    glVertex2f(0.1, 0.2);
    glVertex2f(0.1, -0.2);
    glEnd();
    glPopMatrix();
    glFlush();
}

void keyboardListener(int key)
{  
    if( key == GLUT_KEY_UP) 
    {
        glTranslatef(1.0, 0.0, 0.0);
        glutPostRedisplay(); 
    }
} 
```

缺少什么或我不理解什么概念？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T07:18:15.227

用这个：

```
#include <stdio.h>
#include <gl/glut.h>

GLfloat rotation = 90.0;
float posX = 0, posY = 0, posZ = 0;

void reshape(int width, int heigth){
    /* window ro reshape when made it bigger or smaller*/

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();

    //clip the windows so its shortest side is 2.0
    if (width < heigth) {
        glOrtho(-2.0, 2.0, -2.0 * (GLfloat)heigth / (GLfloat)width, 2.0 * (GLfloat)heigth / (GLfloat)width, 2.0, 2.0);
    }
    else{
        glOrtho(-2.0, 2.0, -2.0 * (GLfloat)width / (GLfloat)heigth, 2.0 * (GLfloat)width / (GLfloat)heigth,2.0 , 2.0);
    }
    // set viewport to use the entire new window
    glViewport(0, 0, width, heigth);
}

void rect(){
    glBegin(GL_POLYGON);
    glColor3f(1.0, 0.0, 0.0);
    glVertex2f(-0.1, -0.2);
    glVertex2f(-0.1, 0.2);
    glVertex2f(0.1, 0.2);
    glVertex2f(0.1, -0.2);
    glEnd();

}

void display(){
    //Clear Window
    glClear(GL_COLOR_BUFFER_BIT);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    glPushMatrix();
    glTranslatef(posX,posY,posZ);
    rect();
    glPopMatrix();
    glFlush();
}

void init(){
    // set clear color to black
    glClearColor(0.0, 0.0, 0.0, 0.0);

    // set fill color to white
    glColor3f(1.0, 1.0, 1.0);

    //set up standard orthogonal view with clipping
    //box as cube of side 2 centered at origin
    //This is the default view and these statements could be removed
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluOrtho2D(-1.0, 1.0, -1.0, 1.0);

}
float move_unit = 0.1f;
void keyboardown(int key, int x, int y)
{
    switch (key){
        case GLUT_KEY_RIGHT:
            posX+=move_unit;;
            break;

        case GLUT_KEY_LEFT:
            posX-=move_unit;;
        break;

        case GLUT_KEY_UP:
            posY+=move_unit;;
            break;

        case GLUT_KEY_DOWN:
            posY-=move_unit;;
        break;

        default:
         break;
    }
    glutPostRedisplay();
}

int main(int argc, char** argv){

    //initialize mode and open a windows in upper left corner of screen
    //Windows tittle is name of program

    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB);
    glutInitWindowSize(500,500);
    glutInitWindowPosition(0, 0);
    glutCreateWindow("Practice 1");
    glutDisplayFunc(display);
    init();
    glutSpecialFunc(keyboardown);
    glutMainLoop();

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:29:13.020

最简单的方法是做这样的事情

```
float posX = 0, posY = 0, posZ = 0;

void display(){
  glClear(GL_COLOR_BUFFER_BIT);
  glTranslate(posX,posY,posZ);
  drawPolygon();
  //...
}

void keyboardListener(int key){
  if(key == GLUT_KEY_RIGHT){ posX++; }
  else if(key == GLUT_KEY_LEFT){ posX--; }
  //..similar for up/down
  glutPostRedisplay();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-23T10:56:09.433

此代码绘制一个圆圈，并在按下左、右、上或下键时移动。

```
#include <cmath>
#include <stdio.h>
float posX = 0.01, posY = -0.1, posZ = 0;

void circ() {
    glColor3f(0.0, 0.0, 1.0);
    glBegin(GL_TRIANGLE_FAN);
    for (int i = 0; i <= 300; i++) {
        angle = 2 * PI * i / 300;
        x = cos(angle) / 20;
        y = sin(angle) / 20;
        glVertex2d(x, y);
    }
    glEnd();
}

void display() {
    glClearColor(1.0, 1.0, 1.0, 0.0);
    glClear(GL_COLOR_BUFFER_BIT);

    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    gluOrtho2D(-1.0, 1.0, -1.0, 1.0);

    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();

    glPushMatrix();
    glTranslatef(posX, posY, posZ);
    circ();
    glPopMatrix();

    glutSwapBuffers();
}

**float move_unit = 0.02f;
void keyboardown(int key, int x, int y) {
    switch (key) {
    case GLUT_KEY_RIGHT:
        posX += move_unit;
        break;
    case GLUT_KEY_LEFT:
        posX -= move_unit;
        break;
    case GLUT_KEY_UP:
        posY += move_unit;
        break;
    case GLUT_KEY_DOWN:
        posY -= move_unit;
        break;
    default:
        break;
    }
glutPostRedisplay();
}**

int main(int argc, char** argv) {
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB);
    glutInitWindowSize(600, 500);
    glutInitWindowPosition(0, 0);
    glutCreateWindow("Example");
    glutDisplayFunc(display);
    glutSpecialFunc(keyboardown);
    glutMainLoop();
} 
```

# jquery - 元素不淡出

> ID：13150396
> 
> 赞同：0
> 
> 时间：2012-10-31T02:24:01.787
> 
> 标签：jquery, hide, fadeout

我有 2 个 div，一旦称为“容器”的元素可见，就需要淡出，问题是元素之一，“导航”像它假设的那样淡出，但元素“backtotop”似乎隐藏起来淡出。

我不确定为什么会发生这种情况，即使我放置 .fadeOut(3000) 元素只是在隐藏之前延迟，而不会淡出。

```
var startY = $('#container').position().top + $('#container').outerHeight();

$(window).scroll(function(){
checkY();
});

function checkY(){
if( $(window).scrollTop() > startY ){
    $('#backToTop, #navigation').fadeIn(600);
}else{
    $('#backToTop, #navigation').fadeOut(600);
}
}

checkY(); 
```

# ios5 - iOS：在后台接收媒体

> ID：13150397
> 
> 赞同：5
> 
> 时间：2012-10-31T02:24:10.323
> 
> 标签：ios5, ios4, udp, voip, pjsip

我正在开发基于 SIP 和 VoIP 的 iOS 应用程序，要求该应用程序即使在后台也应该连续运行。我正在使用 pjsip lib。

我知道要在免费中运行 iOS 应用程序，我们需要这个

*   在 Info.plist 中使用 voip 值设置 UIBackgroundModes 键

*   创建了一个我传递给 setKeepAliveTimeout:handler: 的处理程序，以保持连接处于活动状态

但我只想，如果我的应用程序在后台运行，我可以通过（RTP/RTCP）接收 UDP 数据包，同时保持 UDP 端口始终打开。

我已经浏览了这些帖子：

*   [iPhone VOIP 在后台](https://stackoverflow.com/questions/9910005/iphone-voip-in-background)

*   [iOS 上的 VoIP 套接字 - 未收到通知](https://stackoverflow.com/questions/12057151/voip-socket-on-ios-no-notifications-received)

但是，我还不清楚即使应用程序在后台或前台，我们是否可以连续获取 UDP 数据包。

因此，如果有任何数据传入 iOS 客户端应用程序，该应用程序应该能够通知用户。

请提出建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-03T16:28:55.367

为了在后台运行 VoIP 应用程序并在服务器上注册，应该在 iOS 上使用 TCP。当发生某些事情时，您可以触发本地通知。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-17T08:52:11.273

我认为您可以在应用程序在后台运行时设置本地通知，并通过通知指示来电的用户。当用户进入应用程序时，您可以显示来电。

在下面的链接中，检查 [**后台执行和多任务处理**以及**安排本地通知的传递**](https://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/ManagingYourApplicationsFlow/ManagingYourApplicationsFlow.html#//apple_ref/doc/uid/TP40007072-CH4-SW20)

IE 因为你在你的 Info.plist 中设置了 UIBackgroundModes 键，你的应用程序将支持长时间运行的任务。因此，在 applicationDidEnterBackground 方法中添加一个方法，该方法在有呼叫时创建 UILocalNotification。UILocalNotifications 会通过警报消息和您选择的语气通知用户。因此，一旦通知用户并且用户进入应用程序，应用程序将进入前台，您可以在其中添加方法让他接听电话。

在 LocalNotification 的警报正文中，您可以将调用者的信息发送给用户。

**编辑：** [在此链接中](http://forum.twilio.com/twilio/topics/auremoteio_accept_incoming_voip_call_in_the_background_using_twilio_on_ios_5_1)[查看**Paul Richter**](http://forum.twilio.com/twilio/topics/auremoteio_accept_incoming_voip_call_in_the_background_using_twilio_on_ios_5_1)的答案，他说

```
VOIP mode gives you the ability to have code running to notify you of a call coming in
 but you're not going to be able to record audio from the background. If you look at how
Voip apps work, when a call comes in a Local Notification is sent informing the user 
that a call is coming in. The User then must accept the call which will bring the 
application to the foreground at which point from the audio side of things you can 
activate your session and proceed with the phone call. 
```

尽管与您正在使用的库不完全相关，但他对该过程给出了不错的解释。

希望这可以帮助。

# sharepoint-2010 - SSRS 报告查询 SharePoint 列表给出错误“已添加具有相同键的项目”。

> ID：13150406
> 
> 赞同：1
> 
> 时间：2012-10-31T02:26:00.693
> 
> 标签：sharepoint-2010, reporting-services

我有一个包含两个数据集的 SSRS 报告：项目（ID、项目、状态）和任务（ID、标题、分配对象、项目）。我有一个用于任务的 tablix，它使用 Lookup 函数引用 Projects 数据集中的值。

当我按需运行报告时，它运行良好。当它作为订阅运行时，它会记录错误“已添加具有相同密钥的项目”。当我研究这个错误时，大多数文章都引用了不同的字段名称，但是当我尝试更改项目数据集中的字段名称时，我收到错误“数据集‘项目’的字段表达式引用字段‘ID’。报告项表达式只能引用当前数据集范围内的字段，或者如果在聚合内，则只能引用指定的数据集范围"

我只想要一个加入两个列表并且可以作为订阅生成的报告。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-02T02:40:25.953

这听起来像是权限问题。当您按需运行报告时，它会使用您的帐户“登录”到 SharePoint。当您将报表作为订阅运行时，它使用在 SSRS 服务器上运行 SQL Server 代理服务的帐户。也许该帐户没有足够的权限来访问 SharePoint 列表？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T15:44:11.340

仅供参考，我使用临时表来包含我的所有选择语句，包括一些 UNION ALL 例如：使用 TEMP_TABLE (name, lastname, region) as ( SELECT name, lastname, region FROM table....UNION ALL select bname,blastname ,bregion FROM table2 UNION ALL ........当我调用临时表来调用报告的所有列时，我使用的是 SELECT * from TEMP_TABLE，这是我的巨大错误。出于某种原因，当我打电话时TEMP TABLE 我必须使用每个“列名”（例如：SELECT name、lastname、region FROM TEMP_TABLE）而不是使用 SELECT *

# jquery - 完整日历 jQuery！我可以通过点击只选择一个时间段吗？

> ID：13150407
> 
> 赞同：2
> 
> 时间：2012-10-31T02:26:15.517
> 
> 标签：jquery, user-interface, calendar, fullcalendar, timeslots

在[http://arshaw.com/fullcalendar/制作的日历“FullCalendar”中](http://arshaw.com/fullcalendar/)

我需要用户只能通过在议程周视图模式中单击来选择一个时间段！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T08:50:02.690

您可以提供的信息越多，我们可以提供的相关答案就越多。据我了解，您可以通过将 dayclick 与 select 方法结合使用来做到这一点。[http://arshaw.com/fullcalendar/docs/selection/select_method/](http://arshaw.com/fullcalendar/docs/selection/select_method/)

使用 dayclick 监听一个时间段选择，然后使用 select 方法选择给定的时间段。我自己没有对此进行测试，但理论上它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-27T04:24:09.853

首先定义您的插槽分钟数

```
MINUTES_FOR_SLOT = 60; 
```

然后使用您的时隙分钟创建日历，并验证所选开始日期和结束日期之间的差异，如果分钟差异大于`MINUTES_FOR_SLOT`则返回 false

```
 $('#calendar').fullCalendar({
                defaultView  : 'agendaWeek',
                slotMinutes  : MINUTES_FOR_SLOT,
                select: function(start, end) {

                    var a = moment(start.toString("yyyy-MM-dd HH:mm"));
                    var b = moment(end.toString("yyyy-MM-dd HH:mm"));
                    var diffMinutes = b.diff(a, 'minutes')
                    if(diffMinutes > MINUTES_FOR_SLOT) {
                        alert("multiple slot selection is not available");
                        return false;            
                    }
                },
             }); 
```

# java - 使用数组反转Java中的数字

> ID：13150410
> 
> 赞同：0
> 
> 时间：2012-10-31T02:26:35.507
> 
> 标签：java, arrays, numbers, reverse, modulus

所以，我应该写一个程序来确定**Ermips**。我已经弄清楚了其余的部分，但我不确定如何**正确反转数字**。我应该使用数组来反转它。

例如，数字 357。

我使用 mod 运算符获取最后一位数字并将其放入数组的第一个索引中。

`357%10 = 7`

`myArray[0] = 7`

`357/10 = 35`剩下的

使用剩余的 35 重新开始。

`35%10 = 3`

`myArray[1] = 3`

`35/10 = 3 for a remainder`

ETC。 ...

我需要基本上循环这个，所以我可以做任何长度的数字来反转它。

然后，在我拥有该数组之后，显示该数组以反向生成数字....753。

```
public class Reverse {
        public static void main(String[]args) {
        int n = 357;
        int MAX_NUMBERS = 20;
        int currentNumber = 0;
        int reverseNumber = 0;
        int remain = 0;
        int sum = 0;

                  int [] holdDigits = new int [MAX_NUMBERS];

        int exp = holdDigits.length;
        System.out.println("exp: " + exp);
        int index = 0;

                  //sum array
       int count = holdDigits.length;
       while (count > 0){
        holdDigits[index] = n%10;
        System.out.println(index + "index: " + holdDigits[index]);
        n = n/10;
        System.out.println("remainder: " + n);

        count--;

        index++;
        }

        while (index < holdDigits.length){
        reverseNumber += holdDigits[index]*Math.pow(10,count-exp);
        index--;
        System.out.println("sum so far: " + sum);
        }

    System.out.println("Number reversed: " + reverseNumber);
         }//end of main
    }//end of class 
```

* * *

现在完全明白了，感谢**Yogendra Singh**！看看这个：

```
 public class Reverse2 {

    public static void main(String[]args) {

    int n = 76495;
    int MAX_NUMBERS = 20;
    int reverseNumber = 0;
    int index = 0;  

    //declare an array to hold the digits while reversing
    int [] holdDigits = new int [MAX_NUMBERS];

    //the exponent is the number of spaced used in the array
    int exp = holdDigits.length;  

    //while the number is greater than 0, use mod to put the right-most
    //digit in index 0, divide the remaining number and increase the index
    //to put it in the next open slot of the array.
    while (n > 0){
        holdDigits[index] = n%10;
        n = n/10;
        index++;
    }

    //decrease the index by one so it doesn't add the remaining zero as
    //a placeholder in the number
    index--;

    //count is the index because below, you subtract it, making the display
    //of the array reversed.
    int count= index;

    //while the index is greater than zero, by starting at the last filled 
    //slot of the array, the reverse number is added onto each time by 
    //multiplying the number times 10 to the power of whichever place it
    //is which happens to be the index. 
    //EXAMPLE: to turn 7 into 700, multiply by 7x10^3
    while (index >= 0 ){
        reverseNumber += holdDigits[count-index]*Math.pow(10,index);

        //lower the index to do the next number of the array
        index--;
    }

    System.out.println("Reversed number: " + reverseNumber);

    }//end of main

}//end of class 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:46:46.640

代码中存在一些问题，如下所示：

1.  运行第一个循环，直到除法余数为 0
2.  计算除法过程中找到的数字
3.  在第一个循环后将索引减 1，因为它在 while 循环中后加 1

示例更正的代码如下：

```
 int exp = holdDigits.length;
    System.out.println("exp: " + exp);
    int index = 0;
    while (n > 0){
        holdDigits[index] = n%10;
        System.out.println(index + "index: " + holdDigits[index]);
        n = n/10;
        System.out.println("remainder: " + n);
        index++;
    }
    index--;
    int count= index;
    while (index >=0 ){
        reverseNumber += holdDigits[count-index]*Math.pow(10,index);
        index--;
        System.out.println("sum so far: " + sum);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-13T11:24:46.310

如果您已经得到答案，我深表歉意，但这是使用带有 for 循环的数组获取反向数字的一种简短方法。

```
 var val = prompt("enter number");
    var New = val.split("");
    var arr1 = [];
    console.log(New);
    for (i = New.length - 1; i >= 0; i--) {
        arr1 += New[i]  + ',';
    } console.log(arr1); 
```

# regex - 为什么 BASH_REMATCH 不适用于带引号的正则表达式？

> ID：13150411
> 
> 赞同：25
> 
> 时间：2012-10-31T02:26:37.330
> 
> 标签：regex, bash

代码是这样的：

```
#!/bin/bash
if [[ foobarbletch =~ 'foo(bar)bl(.*)' ]]
 then
     echo "The regex matches!"
     echo $BASH_REMATCH
     echo ${BASH_REMATCH[1]}
     echo ${BASH_REMATCH[2]}
 fi 
```

当我尝试运行它时，它不显示任何内容：

```
bash-3.2$ bash --version
GNU bash, version 3.2.48(1)-release (x86_64-apple-darwin12)
Copyright (C) 2007 Free Software Foundation, Inc.
bash-3.2$ /bin/bash test_rematch.bash
bash-3.2$ 
```

有人对此有想法吗？

* * *

## 回答 #1

> 赞同：60
> 
> 时间：2012-10-31T02:27:56.317

在您的 bash 正则表达式中，您应该删除引号。这就是为什么那行不通。

如果你有空间，我建议使用这种方式：

```
#!/bin/bash
x='foo bar bletch'
if [[ $x =~ foo[[:space:]](bar)[[:space:]]bl(.*) ]]
then
    echo The regex matches!
    echo $BASH_REMATCH      
    echo ${BASH_REMATCH[1]} 
    echo ${BASH_REMATCH[2]} 
fi 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-08-19T18:09:26.027

您还可以将带引号的正则表达式分配给变量：

```
#!/bin/bash

x='foobarbletch'

foobar_re='foo(bar)bl(.*)'

if [[ $x =~ $foobar_re ]] ; then
    echo The regex matches!
    echo ${BASH_REMATCH[*]}
    echo ${BASH_REMATCH[1]}
    echo ${BASH_REMATCH[2]}
fi 
```

这不仅支持简单的引用，而且为正则表达式提供了一个有助于提高可读性的名称。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2012-10-31T02:49:25.263

感谢您的调试语句 ，`echo The regex matches!`您应该已经注意到 没有问题`BASH_REMATCH`，因为 if 语句的计算结果为`false`。

在 bash 中，使用 with 的正则表达式是不加`=~`引号的。如果右侧的字符串被引用，则将其视为字符串文字。

如果您想在正则表达式中包含空格，请使用适当的字符类，或者如果您需要空格，请转义您的空格。

# c++ - 模板运算符重载函数上的未定义符号

> ID：13150412
> 
> 赞同：4
> 
> 时间：2012-10-31T02:26:42.227
> 
> 标签：c++, templates, namespaces, operator-overloading

我有这个函数声明：

```
template<class T>
a::A& a::A::operator<<(T out) {
    std::cout << out;
    return (*this);
} 
```

这个函数定义：

```
namespace a {
    ...
    class A {
        ...
        template<class T> A& operator<<(T); 
```

我称之为：

```
a::A b;
b << 1; 
```

这是Makefile：

```
app: main.o A.o
    g++ main.o A.o -o app

main.o: main.cpp
    g++ -c main.cpp

A.o: A.cpp
    g++ -c A.cpp 
```

它给了我：

> 未定义符号：a::A& a::A::operator<< <int>(int)

这是为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T02:43:51.367

`T`一旦实际知道（即`int`在您的情况下）所代表的类型，函数模板将在编译时转换为实际函数。`main.cpp`但是，在编译之前情况并非如此。在`A.cpp`编译时，模板函数并未实例化为实际函数，因此生成的目标文件不包含该函数的二进制版本。

有两种方法可以解决这个问题。

1.  在头文件中包含函数定义。也就是说，使

    ```
    template<class T>
    a::A& a::A::operator<<(T out) {
        std::cout << out;
        return (*this);
    } 
    ```

    头文件的一部分，并从`.cpp`文件中删除函数定义。

    这样做的效果是*任何* `.cpp`包含该头文件的文件都将能够使用模板的*任何*实例化，即对于`T`.

2.  或者，在以下内容中包含显式模板实例化语句`A.cpp`：

    ```
    template a::A& a::A::operator<<(int out); 
    ```

    这将导致编译器在编译时实际实例化模板`A.cpp`，并将编译后的函数包含在目标文件中。因此链接器可以在链接`main.o`和`A.o`在一起时找到它，一切都很好。缺点是它仅适用于`int`您为其提供显式实例化的特定类型（在本例中，仅适用于 ）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-31T02:49:21.010

尝试将您的定义更改为：

```
template<class T>
a::A& a::A::operator<< <T> (T out) {
    std::cout << out;
    return (*this);
} 
```

?

（确保它在头文件中）

# java - 在运行时加载 JAR 文件类时出错

> ID：13150415
> 
> 赞同：2
> 
> 时间：2012-10-31T02:27:20.233
> 
> 标签：java, jar, classloader, classnotfoundexception, urlclassloader

我正在尝试将 JAR 文件添加到类路径并在运行时从 JAR 文件加载所有类。这是我为此任务编写的代码（此类扩展 URLClassLoader）

```
public void loadJar(final String fName) throws IOException, IllegalAccessException, ClassNotFoundException {
    final File file = new File(fName);
    if (file.exists() && getFileExtension(file.getName()).equalsIgnoreCase("jar")) {
        addURL(file.toURI().toURL());
        for(final URL url : getURLs()){
            System.out.println(url.toString());
        }
        final ZipFile jarFile = new ZipFile(file, ZipFile.OPEN_READ);
        final Enumeration<ZipEntry> entries = (Enumeration<ZipEntry>) jarFile.entries();
        while (entries.hasMoreElements()) {
            final String className = getClassCanonicalName(entries.nextElement());
            if (className != null) {
                loadClass(getClassCanonicalName(entries.nextElement()));
            }
        }
    }
}

private String getFileExtension(final String fileName) {
    return fileName.substring(fileName.lastIndexOf(".") + 1);
}

private String getClassCanonicalName(final ZipEntry entry) {
    final String entryName = entry.getName();
    if (getFileExtension(entryName).toLowerCase().endsWith("class")) {
        return entryName.replaceAll(File.separator, ".");
    } else {
        return null;
    }
} 
```

但是，即使通过 getURLs 确实表明 jar 文件已添加到此加载器中，我仍不断收到类实体的 ClassNotFoundException。

这个问题的原因是什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:34:48.540

```
return entryName.replaceAll(File.separator, "."); 
```

在 Windows 上，这将失败。它应该是在*任何*平台 上制作的 Zip`/`的分隔符。`ZipEntry`

 *因此，将其替换为：

```
return entryName.replaceAll("/", "."); 
```

还要去掉类名。SSCCE EG：

```
import java.io.*;
import java.net.*;
import java.util.zip.ZipEntry;
import java.util.zip.ZipInputStream;

public class URLClassLoaderTest extends URLClassLoader {

    public URLClassLoaderTest(URL[] arg0) {
        super(arg0);
    }

    public void loadJar(URL urlOfJar) throws IOException, IllegalAccessException, ClassNotFoundException {
        if (getFileExtension(urlOfJar.getFile()).equalsIgnoreCase("jar")) {
            addURL(urlOfJar);
            for(final URL url : getURLs()){
                System.out.println(url.toString());
            }
            final ZipInputStream zis = new ZipInputStream(urlOfJar.openStream());
            ZipEntry ze = zis.getNextEntry();
            while (ze!=null) {
                final String className = getClassCanonicalName(ze);
                if (className != null) {
                    loadClass(getClassCanonicalName(ze));
                }
                ze = zis.getNextEntry();
            }
        }
    }

    private String getFileExtension(final String fileName) {
        return fileName.substring(fileName.lastIndexOf(".") + 1);
    }

    private String getClassCanonicalName(final ZipEntry entry) {
        final String entryName = entry.getName();
        if (getFileExtension(entryName).toLowerCase().endsWith("class")) {
            String s = entryName.substring(0,entryName.length()-6);
            s = s.replaceAll("/", ".");
            System.out.println(s);
            return s;
        } else {
            return null;
        }
    }

    public static void main(String[] args) throws Exception {
        URL[] url = {new URL("http://pscode.org/lib/mime.jar")};
        URLClassLoaderTest uclt = new URLClassLoaderTest(url);
        uclt.loadJar(url[0]);
    }
} 
```

## 输出

```
http://pscode.org/lib/mime.jar
org.pscode.mime.MimeType$1
org.pscode.mime.MimeType$1
org.pscode.mime.MimeType$2
org.pscode.mime.MimeType$2
org.pscode.mime.MimeType
org.pscode.mime.MimeType 
```*

# python - Python，10 的倍数 if 语句

> ID：13150417
> 
> 赞同：6
> 
> 时间：2012-10-31T02:27:53.057
> 
> 标签：python

> **可能重复：**
> [如何检查一个数字是否可以被另一个数字整除（Python）？](https://stackoverflow.com/questions/8002217/how-do-you-check-whether-a-number-is-divisible-by-another-number-python)

所以我正在用python为我正在做的一门课程编写一个“秒表游戏”，我想要它这样当计时器停在一个整数上时，玩家会得到一个点。

我认为“整数”将是 10 的倍数，因为格式类似于 a;bc:d，并且计时器以十分之一秒的速度运行。

我需要你的帮助是我该怎么说，“哦，嘿，如果他停在 10 的倍数上，给他一分”。

我一生都无法弄清楚如何指定 10 的倍数。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-31T02:30:18.843

使用`%`（模运算）。例如：

```
>>> 100%10
0
>>> 101%10
1 
```

基本上，`x%y`返回 的余数的值`x/y`，因此如果余数是`0`，`x`则 可以被 整除`y`。因此，如果`x%10`返回的不是零，`x`则不能被 10 整除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T02:29:02.933

您应该尝试`modulo`在脚本中使用 a 。

看 ：

```
>>> if not 10 % 10:
...     print "OK"
... 
OK
>>> if not 9 % 10:
...     print "OK"
... 
>>> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T02:30:20.510

如果一个数是 10 的倍数，则除以 10 时的余数将为 0。在 Python 中，您可以使用`%`运算符获得除法的余数。例如：

```
print 13 % 10  # 3 
```

^(这有点过于简单化了。`%`（模数/模数）与负操作数的余数不同。)

# oracle - 从 Oracle 数据库在 Google 电子表格中插入或更新数据

> ID：13150421
> 
> 赞同：1
> 
> 时间：2012-10-31T02:28:20.947
> 
> 标签：oracle, google-apps-script, oracle-apex

我想知道如何从 Oracle 数据库中插入或更新 Google 电子表格中的数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:56:30.870

驻留在电子表格容器或其他地方的 Apps 脚本可以从 oracle 获取数据并更新您的电子表格，但我认为没有任何简单的方法可以从 Oracle 端更新电子表格。对于编程，Oracle 使用 PLSQL，但我还没有找到任何将电子表格 API 与 PLSQL 一起使用的解决方案。

最好编写 Apps 脚本代码，该代码将由时间驱动的触发器运行，并在 Oracle 表中查找更改并在电子表格中进行更新。这是在 Apps 脚本中使用[JDBC 服务](https://developers.google.com/apps-script/jdbc)的参考链接。

# android - Android：应用程序在单击快速操作项时崩溃

> ID：13150425
> 
> 赞同：0
> 
> 时间：2012-10-31T02:28:54.377
> 
> 标签：android, android-asynctask, quickaction

在我的应用程序中，我在单个选项卡下打开多个活动。在其中一个选项卡中，我有快速行动。我想在单击快速操作项时打开另一个活动，但是当我这样做时应用程序崩溃了。我使用活动组来维护一项活动下的多项活动。我的第一个选项卡包含列表视图。在列表视图的项目单击上，我正在打开另一个活动。我也想通过快速操作的项目单击打开相同的活动。我在下面发布我的代码。

**快速行动的代码**

```
quickAction = new QuickAction(this, QuickAction.VERTICAL);

    ActionItem nextItem     = new ActionItem(ID_DOWN, "About TIE", getResources().getDrawable(R.drawable.dzologo));
    ActionItem prevItem     = new ActionItem(ID_UP, "About LKS", getResources().getDrawable(R.drawable.dzologo));

        prevItem.setSticky(true);
        nextItem.setSticky(true);

      final QuickAction quickAction = new QuickAction(this, QuickAction.VERTICAL);

        //add action items into QuickAction
        quickAction.addActionItem(nextItem);
        quickAction.addActionItem(prevItem);

//Set listener for action item clicked
        quickAction.setOnActionItemClickListener(new QuickAction.OnActionItemClickListener() {

            public void onItemClick(com.dzo.tie.quickaction.QuickAction source,
                    int pos, int actionId) {

                if(actionId == ID_DOWN)
                {
                    Intent  iInfo = new Intent(Awesome.this, TIEInfo.class);
                    startActivity(iInfo);
                    quickAction.dismiss();
                }//if
            }           
        }); 
```

**添加标签规范的代码**

```
addTab("Home", R.drawable.tab_home, TabGroup1Activity.class);

//Add tab method
private void addTab(String labelId, int drawableId, Class<?> c)
{
    Intent intent = null;
    intent = new Intent(this, c);

    TabHost.TabSpec spec = tabHost.newTabSpec("tab" + labelId); 
    View tabIndicator = LayoutInflater.from(this).inflate(R.layout.tab_indicator, getTabWidget(), false);
    TextView title = (TextView) tabIndicator.findViewById(R.id.title);
    title.setText(labelId);
    ImageView icon = (ImageView) tabIndicator.findViewById(R.id.icon);
    icon.setImageResource(drawableId);      
    spec.setIndicator(tabIndicator);    
    spec.setContent(intent);

    tabHost.addTab(spec);   
} 
```

**Tabgroup1 活动**

```
public class TabGroup1Activity extends TabGroupActivity{

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    startChildActivity("MenuActivity", new Intent(getParent(), MenuActivity.class));
}
} 
```

**OnItem 单击菜单活动中的列表视图**

```
 public void onItemClick(AdapterView<?> parent, View v, int pos, long id)
{
    handleClick(pos);
}

private void handleClick(int position) 
{
    if(position==0)
    {
        Intent  tieInfoIntent = new Intent(getParent(), TIEInfo.class);
        TabGroupActivity parentActivity = (TabGroupActivity)getParent();
        parentActivity.startChildActivity("TIEInfoActivity", tieInfoIntent);
    }//if
} 
```

**TIEInfo** 我想在项目单击快速操作时打开此活动。

```
public class TIEInfo extends Activity 
{
WebView webTieInfo;
String contents;
HeaderBar headerbar;
private String infoUrl = "https://www.tradeineu.com/tie_app/aboutTie.php";
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    init();
        new InfoAsyncTask(getParent(), infoUrl, webTieInfo).execute();
}//onCreate

private void init()
{
    setContentView(R.layout.tieinfo);
    headerbar = (HeaderBar)findViewById(R.id.headerBar);
    headerbar.setTitle("Info");
    webTieInfo = (WebView)findViewById(R.id.webTieInfo);
    webTieInfo.setVerticalFadingEdgeEnabled(true);
    webTieInfo.setVerticalScrollBarEnabled(true);
    webTieInfo.setScrollBarStyle(View.SCROLLBARS_OUTSIDE_OVERLAY);
}//init
}//TIEInfo 
```

**Logcat 跟踪**

```
10-31 07:50:49.148: E/AndroidRuntime(1012): FATAL EXCEPTION: main
10-31 07:50:49.148: E/AndroidRuntime(1012): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.dzo.tie/com.dzo.tie.TIEInfo}: java.lang.NullPointerException
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.os.Handler.dispatchMessage(Handler.java:99)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.os.Looper.loop(Looper.java:137)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.ActivityThread.main(ActivityThread.java:4745)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at java.lang.reflect.Method.invokeNative(Native Method)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at java.lang.reflect.Method.invoke(Method.java:511)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at dalvik.system.NativeStart.main(Native Method)
10-31 07:50:49.148: E/AndroidRuntime(1012): Caused by: java.lang.NullPointerException
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.AlertDialog.resolveDialogTheme(AlertDialog.java:142)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.AlertDialog.<init>(AlertDialog.java:98)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.ProgressDialog.<init>(ProgressDialog.java:77)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at com.dzo.tie.asynctask.InfoAsyncTask.onPreExecute(InfoAsyncTask.java:43)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.os.AsyncTask.executeOnExecutor(AsyncTask.java:586)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.os.AsyncTask.execute(AsyncTask.java:534)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at com.dzo.tie.TIEInfo.onCreate(TIEInfo.java:31)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.Activity.performCreate(Activity.java:5008)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
10-31 07:50:49.148: E/AndroidRuntime(1012):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023) 
10-31 07:50:49.148: E/AndroidRuntime(1012):     ... 11 more 
```

从日志中，我了解到应用程序在 AsyncTask 的 onPreExecute() 内部的以下语句中崩溃。但是，我无法指出真正的原因。

```
pd = new ProgressDialog(ctx); 
```

**异步任务**

```
public class InfoAsyncTask extends AsyncTask<Void, Void, JSONObject>
{
Context ctx;
ProgressDialog pd; 
JSONParser jsonParser;
String url;
WebView webInfo;
public static TieInfoDAO tieInfoDao;
public static ComplianceInfoDAO complianceInfoDAO;
public static TAXInfoDAO taxDAO;
public static LogisticsDAO logisticsDAO;
public static LegalDAO legalDAO;
public static SmartAppDAO smartAppDAO;
private final String TAG = "InfoAsyncTask";

public InfoAsyncTask(Context ctx, String url, WebView webInfo) 
{
    this.ctx = ctx;
    this.url = url;
    this.webInfo = webInfo;
}//Constructor

@Override
protected void onPreExecute() 
{
    pd = new ProgressDialog(ctx);
    pd.setMessage("Please wait...");
    pd.show();
    Log.v(TAG, "onPreExecute called");
}//onPreExecute

protected JSONObject doInBackground(Void... params) 
{
    jsonParser = new JSONParser();
    JSONObject jsonObject = jsonParser.getJSONFromUrl(url);
    Log.v(TAG, "doInbackground called");
    return jsonObject;
}//doINBackground

@Override
protected void onPostExecute(JSONObject jsonObject) 
{
    String contents = null;

    if(url.contains("aboutTie"))
    {
        tieInfoDao = ParsedInfoData.getTIEInfo(jsonObject);
        contents = tieInfoDao.getInfo();
        showWebView(contents);
    }//if   
    else if(url.contains("compliance"))
    {
        complianceInfoDAO = ParsedComplianceInfoData.getComplianceInfo(jsonObject);
        contents = complianceInfoDAO.getComplianceInfo();
        showWebView(contents);
    }//else if
    else if(url.contains("tax"))
    {
        taxDAO = ParsedTaxData.getTaxInfo(jsonObject);
        contents = taxDAO.getTaxInfo();
        showWebView(contents);
    }//else if
    else if(url.contains("logistics"))
    {
        logisticsDAO = ParsedLogisticsData.getLogisticsInfo(jsonObject);
        contents = logisticsDAO.getLogisticsInfo();
        showWebView(contents);
    }//else if
    else if(url.contains("legal"))
    {
        legalDAO = ParsedLegalInfo.getLegalInfo(jsonObject);
        contents = legalDAO.getLegal_Info();
        showWebView(contents);
    }//else if
    else if(url.contains("smart_app"))
    {
        smartAppDAO = ParsedAppData.getAppInfo(jsonObject);
        contents = smartAppDAO.getAppInfo();
        showWebView(contents);
    }//else if
    pd.dismiss();
    Log.v(TAG, "onPostExecute called");
}//onPostExecute

private void showWebView(String contents) 
{
    if ((ctx.getResources().getConfiguration().screenLayout & 
            Configuration.SCREENLAYOUT_SIZE_MASK) == 1)
    {     
        contents = "<html><head>"
                  + "<style type=\"text/css\">body{color: #A17339;" +
                  "font-size:10px;" +
                  "text-align:justify;}"
                  + "</style></head>"
                  + "<body>"                          
                  + contents
                  + "</body></html>";
            Log.v(TAG+" onPostExecute if ldpi", "font setting for ldpi");
    }
    else if ((ctx.getResources().getConfiguration().screenLayout & 
            Configuration.SCREENLAYOUT_SIZE_MASK) == 2) 
    {     
        contents = "<html><head>"
              + "<style type=\"text/css\">body{color: #A17339;" +
              "font-size:12px;" +
              "text-align:justify;}"
              + "</style></head>"
              + "<body>"                          
              + contents
              + "</body></html>";
        Log.v(TAG+" onPostExecute if mdpi", "font setting for mdpi");
    } 
    else if ((ctx.getResources().getConfiguration().screenLayout & 
            Configuration.SCREENLAYOUT_SIZE_MASK) == 3)
    {     
        contents = "<html><head>"
              + "<style type=\"text/css\">body{color: #A17339;" +
              "font-size:18px;" +
              "text-align:justify;}"
              + "</style></head>"
              + "<body>"                          
              + contents
              + "</body></html>";
        Log.v(TAG+" onPostExecute if hdpi", "font setting for hdpi");
    }
    else if ((ctx.getResources().getConfiguration().screenLayout & 
            Configuration.SCREENLAYOUT_SIZE_MASK) == 4) {     
        contents = "<html><head>"
              + "<style type=\"text/css\">body{color: #A17339;" +
              "font-size:28px;" +
              "text-align:justify;}"
              + "</style></head>"
              + "<body>"                          
              + contents
              + "</body></html>";
        Log.v(TAG+" onPostExecute if xhdpi", "font setting for xhdpi");
    }
    //tieInfoObj.setInfo(contents);
    webInfo.loadData(contents, "text/html", "utf-8");
}//showWebView
}//TieInfoAsyncTask 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T05:34:13.720

```
new InfoAsyncTask(getParent(), infoUrl, webTieInfo).execute(); 
```

`getParent()`有点暴躁，只有当您`Activity`嵌入父母*时才有效。*因此，在这种情况下，它似乎会导致`null`.

请尝试以下操作，因为您是`AsyncTask`从一个 中创建的`Activity`，它也是一个`Context`：

```
new InfoAsyncTask(this, infoUrl, webTieInfo).execute(); 
```

# ruby-on-rails - 将具有 UTC 时间的变量转换为秒整数 (Ruby)

> ID：13150432
> 
> 赞同：1
> 
> 时间：2012-10-31T02:30:18.360
> 
> 标签：ruby-on-rails, ruby

我有一个与 UTC 时间相关的变量，例如：

```
 offer_ends_at => Sun, 25 Nov 2012 07:59:59 UTC +00:00, 
```

我的目标是创建一个新变量，并将 Time 转换为秒整数。我尝试了一些方法，例如

```
 seconds = offer_ends_at.to_time.to_i 
```

我最终得到了一个时代。我正在寻找一个实际整数，其中包含距离日期发生的秒数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:34:22.003

我你想要“一个实际的整数，其中包含距离日期发生的秒数。”，然后你可以将你得到的时间戳减去当前时间戳，即：

```
seconds = offer_ends_at.to_time.to_i - Time.now.to_i 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T02:40:16.213

其实不用放`to_i`，只需减去两次（[`Time#-`](http://ruby-doc.org/core-1.9.3/Time.html#method-i-2D)方法）即可：

```
seconds = offer_ends_at.to_time - Time.now 
```

# php - 如何在单独的页面中回显某些内容

> ID：13150439
> 
> 赞同：4
> 
> 时间：2012-10-31T02:30:50.593
> 
> 标签：php

我不知道这是否可行，但在此页面上我有以下代码：

```
$moduleHTML  = "";  

 while($sqlstmt->fetch()) { 
    $moduleHTML .= "<option value='$dbModuleId'>" . $dbModuleId . " - " . $dbModuleName . "</option>".PHP_EOL;  
    $outputmodule = ""; 
        $outputmodule .= "<p><strong>Module:</strong> " . $dbModuleId .  " - "  . $dbModuleName . "</p>"; 
} 
```

`$outputmodule`但我想在另一个页面中回显变量。所以下面是另一个页面的代码，其中包括链接上面的脚本（module.php）的ajax，它包含回显的位置以及它包含模块下拉菜单的一部分的位置：

```
 <script type="text/javascript">

    function getModules() { 
    var course = jQuery("#coursesDrop").val(); 
    jQuery('#modulesDrop').empty(); 
    jQuery('#modulesDrop').html('<option value="">Please Select</option>'); 
    jQuery.ajax({ 
    type: "post", 
    url:  "module.php", 
    data: { course:course }, 
    success: function(response){ 
    jQuery('#modulesDrop').append(response); 
    } 
    }); 

    }

    </script> 

...

<?

$moduleHTML = "";  
$moduleHTML .= '<select name="modules" id="modulesDrop">'.PHP_EOL; 
$moduleHTML .= '<option value="">Please Select</option>'.PHP_EOL;  
$moduleHTML .= '</select>';

echo $outputmodule;

... 
```

问题是我收到上述回声的未定义错误。我的问题是，如何`$dbModuleId and $dbModuleName`将 module.php 页面中的内容回显到 editsession.php 页面（上面的脚本）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:39:19.193

php 脚本是在不同请求期间调用的，还是相互包含的？如果请求不同，您可以将变量存储在 $_SESSION 中，并在请求之间使用它。如果在同一个请求中，那么变量将在同一范围内可用，或者您可以使用 global 关键字跨范围共享。

[http://php.net/manual/en/features.sessions.php](http://php.net/manual/en/features.sessions.php)

[http://php.net/manual/en/language.variables.scope.php](http://php.net/manual/en/language.variables.scope.php)

通常不推荐使用全局变量。还有全局数组的东西。仅取决于您是否在同一请求中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:59:21.150

如果您不想使用会话，您可以将您的值作为 json 数组传回，然后对其进行解码并使用 jquery 附加您的值

```
 $outputArray = array();  

     while($sqlstmt->fetch()) { 
        $outputArray['moduleHTML'] = "<option value='$dbModuleId'>" . $dbModuleId . " - " . $dbModuleName . "</option>".PHP_EOL;  

        $outputArray['outputModule']  = "<p><strong>Module:</strong> " . $dbModuleId .  " - "  . $dbModuleName . "</p>"; 
    } 
    echo json_encode($outputArray); 
```

然后在你的页面上

```
<script type="text/javascript">

function getModules() { 
    var course = jQuery("#coursesDrop").val(); 
    jQuery('#modulesDrop').empty(); 
    jQuery('#modulesDrop').html('<option value="">Please Select</option>'); 
    jQuery.ajax({ 
        type: "post", 
        url:  "module.php", 
        data: { course:course }, 
        success: function(response){
            var outputjQuery.parseJSON(response)
            jQuery('#modulesDrop').append(output.moduleHTML); 
            jQuery('#outputModule').html(output.outputModule); 
       });
    }); 

}

</script> 

...

<?

$moduleHTML = "";  
$moduleHTML .= '<select name="modules" id="modulesDrop">'.PHP_EOL; 
$moduleHTML .= '<option value="">Please Select</option>'.PHP_EOL;  
$moduleHTML .= '</select>';
$moduleHTML .= '<div id="outPutModule"></div>;

echo $moduleHTML; 
```

# iphone - Cocos2D检查精灵是否不在屏幕上？

> ID：13150445
> 
> 赞同：0
> 
> 时间：2012-10-31T02:31:17.847
> 
> 标签：iphone, xcode, cocos2d-iphone, sprite

我使用此代码向上触发：

```
- (void)ccTouchesEnded:(NSSet *)touches withEvent:(UIEvent* )event
{

//Spawn the bullet
CCSprite * projectile = [CCSprite spriteWithFile:@"Projectile.png" rect:CGRectMake(0, 0,    17.5, 10)];
projectile.position = ccp(donk.position.x , 50);
[self addChild:projectile];

//Actualy Fire
[projectile runAction: [CCMoveTo actionWithDuration:.2 position: ccp (donk.position.x , 350)]];

} 
```

它像我想要的那样工作，但是我如何使用 if 语句来检查弹丸是否离开屏幕顶部，以便我可以将其移除？

我尝试使用这个：

```
 if (projectile.position.y >= 330) {
    CCLOG(@"Removed");
    [self removeChild:projectile cleanup:YES];
} 
```

但我忘记了 touchesended 只被调用一次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T04:27:12.093

想想什么*时候*应该检查子弹是否在屏幕外。不是在它被解雇的同时，对吧？

有很多方法可以做到这一点。

*   您已经有一个 moveTo 操作。CCActions 可以有回调来告诉你它们何时完成；见标题。

*   您可以定义一个 update: 方法并使用 scheduleUpdates 启用它，以便能够测试每一帧的位置。

*   如果您使用物理引擎，您可以为屏幕边缘制作“墙”并移除子弹以响应碰撞检测。

可能还有其他方法。看看框架提供了什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-14T13:19:10.847

那这个呢：

```
[projectile runAction:[CCSequence actions:
                       [CCMoveTo actionWithDuration:.2 position:ccp(donk.position.x,350)], 
                       [CCCallBlock actionWithBlock:^{
        [projectile removeFromParentAndCleanup:YES];
    }], 
                        nil]]; 
```

（未测试）

# ios - 在 iOS6 中 viewForAnnotation 之后调用 didSelectAnnotationView

> ID：13150446
> 
> 赞同：2
> 
> 时间：2012-10-31T02:31:27.903
> 
> 标签：ios, mapkit

我在 iOS 5 中使用 MapKit，并且`didSelectAnnotationView`之前正确调用了该函数`viewForAnnotation`。但是，在 iOS 6 中，`didSelectAnnotationView`在`viewForAnnotation`. 我如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:03:06.033

你确定这是怎么回事？我的代码最初导致我得出相同的结论，直到我在其他位置设置断点。

如果您`didSelectAnnotationView`（在某些时候）调用地图视图，`addAnnotation`那么您的日志消息或断点可能会误导您。

我注意到 iOS5 和 iOS6 之间的区别在于，在`addAnnotation`使用时，在 iOS5 中调用之前会有延迟，`viewForAnnotation`而在 iOS6 中它会立即发生。我不得不更改我的代码中的操作顺序（所以`addAnnotation`最后调用），但除此之外，相同的代码适用于两个版本的 iOS。

# c++ - Efficient unsigned-to-signed cast avoiding implementation-defined behavior

> ID：13150449
> 
> 赞同：103
> 
> 时间：2012-10-31T02:32:10.630
> 
> 标签：c++, casting, integer, language-lawyer, integer-overflow

I want to define a function that takes an `unsigned int` as argument and returns an `int` congruent modulo UINT_MAX+1 to the argument.

A first attempt might look like this:

```
int unsigned_to_signed(unsigned n)
{
    return static_cast<int>(n);
} 
```

But as any language lawyer knows, casting from unsigned to signed for values larger than INT_MAX is implementation-defined.

I want to implement this such that (a) it only relies on behavior mandated by the spec; and (b) it compiles into a no-op on any modern machine and optimizing compiler.

As for bizarre machines... If there is no signed int congruent modulo UINT_MAX+1 to the unsigned int, let's say I want to throw an exception. If there is more than one (I am not sure this is possible), let's say I want the largest one.

OK, second attempt:

```
int unsigned_to_signed(unsigned n)
{
    int int_n = static_cast<int>(n);

    if (n == static_cast<unsigned>(int_n))
        return int_n;

    // else do something long and complicated
} 
```

I do not much care about the efficiency when I am not on a typical twos-complement system, since in my humble opinion that is unlikely. And if my code becomes a bottleneck on the omnipresent sign-magnitude systems of 2050, well, I bet someone can figure that out and optimize it then.

Now, this second attempt is pretty close to what I want. Although the cast to `int` is implementation-defined for some inputs, the cast back to `unsigned` is guaranteed by the standard to preserve the value modulo UINT_MAX+1\. So the conditional does check exactly what I want, and it will compile into nothing on any system I am likely to encounter.

However... I am still casting to `int` without first checking whether it will invoke implementation-defined behavior. On some hypothetical system in 2050 it could do who-knows-what. So let's say I want to avoid that.

Question: What should my "third attempt" look like?

To recap, I want to:

*   Cast from unsigned int to signed int
*   Preserve the value mod UINT_MAX+1
*   Invoke only standard-mandated behavior
*   Compile into a no-op on a typical twos-complement machine with optimizing compiler

[Update]

Let me give an example to show why this is not a trivial question.

Consider a hypothetical C++ implementation with the following properties:

*   `sizeof(int)` equals 4
*   `sizeof(unsigned)` equals 4
*   `INT_MAX` equals 32767
*   `INT_MIN` equals -2^(32) + 32768
*   `UINT_MAX` equals 2^(32) - 1
*   Arithmetic on `int` is modulo 2^(32) (into the range `INT_MIN` through `INT_MAX`)
*   `std::numeric_limits<int>::is_modulo` is true
*   Casting unsigned `n` to int preserves the value for 0 <= n <= 32767 and yields *zero* otherwise

On this hypothetical implementation, there is exactly one `int` value congruent (mod UINT_MAX+1) to each `unsigned` value. So my question would be well-defined.

I claim that this hypothetical C++ implementation fully conforms to the C++98, C++03, and C++11 specifications. I admit I have not memorized every word of all of them... But I believe I have read the relevant sections carefully. So if you want me to accept your answer, you either must (a) cite a spec that rules out this hypothetical implementation or (b) handle it correctly.

Indeed, a correct answer must handle *every* hypothetical implementation permitted by the standard. That is what "invoke only standard-mandated behavior" means, by definition.

Incidentally, note that `std::numeric_limits<int>::is_modulo` is utterly useless here for multiple reasons. For one thing, it can be `true` even if unsigned-to-signed casts do not work for large unsigned values. For another, it can be `true` even on one's-complement or sign-magnitude systems, if arithmetic is simply modulo the entire integer range. And so on. If your answer depends on `is_modulo`, it's wrong.

[Update 2]

[hvd's answer](https://stackoverflow.com/a/13208789/768469) taught me something: My hypothetical C++ implementation for integers is *not* permitted by modern C. The C99 and C11 standards are very specific about the representation of signed integers; indeed, they only permit twos-complement, ones-complement, and sign-magnitude (section 6.2.6.2 paragraph (2); ).

But C++ is not C. As it turns out, this fact lies at the very heart of my question.

The original C++98 standard was based on the much older C89, which says (section 3.1.2.5):

> For each of the signed integer types, there is a corresponding (but different) unsigned integer type (designated with the keyword unsigned) that uses the same amount of storage (including sign information) and has the same alignment requirements. The range of nonnegative values of a signed integer type is a subrange of the corresponding unsigned integer type, and the representation of the same value in each type is the same.

C89 says nothing about only having one sign bit or only allowing twos-complement/ones-complement/sign-magnitude.

The C++98 standard adopted this language nearly verbatim (section 3.9.1 paragraph (3)):

> For each of the signed integer types, there exists a corresponding (but different) *unsigned integer type*: "`unsigned char`", "`unsigned short int`", "`unsigned int`", and "`unsigned long int`", each of which occupies the same amount of storage and has the same alignment requirements (3.9) as the corresponding signed integer type ; that is, each *signed integer* type has the same object representation as its corresponding *unsigned integer* type. The range of nonnegative values of a signed integer type is a subrange of the corresponding unsigned integer type, and the value representation of each corresponding signed/unsigned type shall be the same.

The C++03 standard uses essentially identical language, as does C++11.

No standard C++ spec constrains its signed integer representations to any C spec, as far as I can tell. And there is nothing mandating a single sign bit or anything of the kind. All it says is that *non-negative* signed integers must be a subrange of the corresponding unsigned.

So, again I claim that INT_MAX=32767 with INT_MIN=-2^(32)+32768 is permitted. If your answer assumes otherwise, it is incorrect unless you cite a **C++** standard proving me wrong.

* * *

## 回答 #1

> 赞同：79
> 
> 时间：2012-11-03T11:39:30.497

Expanding on user71404's answer:

```
int f(unsigned x)
{
    if (x <= INT_MAX)
        return static_cast<int>(x);

    if (x >= INT_MIN)
        return static_cast<int>(x - INT_MIN) + INT_MIN;

    throw x; // Or whatever else you like
} 
```

If `x >= INT_MIN` (keep the promotion rules in mind, `INT_MIN` gets converted to `unsigned`), then `x - INT_MIN <= INT_MAX`, so this won't have any overflow.

If that is not obvious, take a look at the claim "If `x >= -4u`, then `x + 4 <= 3`.", and keep in mind that `INT_MAX` will be equal to at least the mathematical value of -INT_MIN - 1.

On the most common systems, where `!(x <= INT_MAX)` implies `x >= INT_MIN`, the optimizer should be able (and on my system, is able) to remove the second check, determine that the two `return` statements can be compiled to the same code, and remove the first check too. Generated assembly listing:

```
__Z1fj:
LFB6:
    .cfi_startproc
    movl    4(%esp), %eax
    ret
    .cfi_endproc 
```

The hypothetical implementation in your question:

*   INT_MAX equals 32767
*   INT_MIN equals -2^(32) + 32768

is not possible, so does not need special consideration. `INT_MIN` will be equal to either `-INT_MAX`, or to `-INT_MAX - 1`. This follows from C's representation of integer types (6.2.6.2), which requires `n` bits to be value bits, one bit to be a sign bit, and only allows one single trap representation (not including representations that are invalid because of padding bits), namely the one that would otherwise represent negative zero / `-INT_MAX - 1`. C++ doesn't allow any integer representations beyond what C allows.

***Update***: Microsoft's compiler apparently does not notice that `x > 10` and `x >= 11` test the same thing. It only generates the desired code if `x >= INT_MIN` is replaced with `x > INT_MIN - 1u`, which it can detect as the negation of `x <= INT_MAX` (on this platform).

[Update from questioner (Nemo), elaborating on our discussion below]

I now believe this answer works in all cases, but for complicated reasons. I am likely to award the bounty to this solution, but I want to capture all the gory details in case anybody cares.

Let's start with C++11, section 18.3.3:

> Table 31 describes the header `<climits>`.
> 
> ...
> 
> The contents are the same as the Standard C library header `<limits.h>`.

Here, "Standard C" means C99, whose specification severely constrains the representation of signed integers. They are just like unsigned integers, but with one bit dedicated to "sign" and zero or more bits dedicated to "padding". The padding bits do not contribute to the value of the integer, and the sign bit contributes only as twos-complement, ones-complement, or sign-magnitude.

Since C++11 inherits the `<climits>` macros from C99, INT_MIN is either -INT_MAX or -INT_MAX-1, and hvd's code is guaranteed to work. (Note that, due to the padding, INT_MAX could be much less than UINT_MAX/2... But thanks to the way signed->unsigned casts work, this answer handles that fine.)

C++03/C++98 is trickier. It uses the same wording to inherit `<climits>` from "Standard C", but now "Standard C" means C89/C90.

All of these -- C++98, C++03, C89/C90 -- have the wording I give in my question, but also include this (C++03 section 3.9.1 paragraph 7):

> The representations of integral types shall define values by use of a pure binary numeration system.(44) [*Example*: this International Standard permits 2’s complement, 1’s complement and signed magnitude representations for integral types.]

Footnote (44) defines "pure binary numeration system":

> A positional representation for integers that uses the binary digits 0 and 1, in which the values represented by successive bits are additive, begin with 1, and are multiplied by successive integral power of 2, except perhaps for the bit with the highest position.

What is interesting about this wording is that it contradicts itself, because the definition of "pure binary numeration system" does not permit a sign/magnitude representation! It does allow the high bit to have, say, the value -2^(n-1) (twos complement) or -(2^(n-1)-1) (ones complement). But there is no value for the high bit that results in sign/magnitude.

Anyway, my "hypothetical implementation" does not qualify as "pure binary" under this definition, so it is ruled out.

However, the fact that the high bit is special means we can imagine it contributing any value at all: A small positive value, huge positive value, small negative value, or huge negative value. (If the sign bit can contribute -(2^(n-1)-1), why not -(2^(n-1)-2)? etc.)

So, let's imagine a signed integer representation that assigns a wacky value to the "sign" bit.

A small positive value for the sign bit would result in a positive range for `int` (possibly as large as `unsigned`), and hvd's code handles that just fine.

A huge positive value for the sign bit would result in `int` having a maximum larger than `unsigned`, which is is forbidden.

A huge negative value for the sign bit would result in `int` representing a non-contiguous range of values, and other wording in the spec rules that out.

Finally, how about a sign bit that contributes a small negative quantity? Could we have a 1 in the "sign bit" contribute, say, -37 to the value of the int? So then INT_MAX would be (say) 2^(31)-1 and INT_MIN would be -37?

This would result in some numbers having two representations... But ones-complement gives two representations to zero, and that is allowed according to the "Example". Nowhere does the spec say that zero is the *only* integer that might have two representations. So I think this new hypothetical is allowed by the spec.

Indeed, any negative value from -1 down to `-INT_MAX-1` appears to be permissible as a value for the "sign bit", but nothing smaller (lest the range be non-contiguous). In other words, `INT_MIN` might be anything from `-INT_MAX-1` to -1.

Now, guess what? For the second cast in hvd's code to avoid implementation-defined behavior, we just need `x - (unsigned)INT_MIN` less than or equal to `INT_MAX`. We just showed `INT_MIN` is at least `-INT_MAX-1`. Obviously, `x` is at most `UINT_MAX`. Casting a negative number to unsigned is the same as adding `UINT_MAX+1`. Put it all together:

```
x - (unsigned)INT_MIN <= INT_MAX 
```

if and only if

```
UINT_MAX - (INT_MIN + UINT_MAX + 1) <= INT_MAX
-INT_MIN-1 <= INT_MAX
-INT_MIN <= INT_MAX+1
INT_MIN >= -INT_MAX-1 
```

That last is what we just showed, so even in this perverse case, the code actually works.

That exhausts all of the possibilities, thus ending this extremely academic exercise.

Bottom line: There is some seriously under-specified behavior for signed integers in C89/C90 that got inherited by C++98/C++03\. It is fixed in C99, and C++11 indirectly inherits the fix by incorporating `<limits.h>` from C99\. But even C++11 retains the self-contradictory "pure binary representation" wording...

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2012-11-03T17:34:40.287

This code relies only on behavior, mandated by the spec, so requirement (a) is easily satisfied:

```
int unsigned_to_signed(unsigned n)
{
  int result = INT_MAX;

  if (n > INT_MAX && n < INT_MIN)
    throw runtime_error("no signed int for this number");

  for (unsigned i = INT_MAX; i != n; --i)
    --result;

  return result;
} 
```

It's not so easy with requirement (b). This compiles into a no-op with gcc 4.6.3 (-Os, -O2, -O3) and with clang 3.0 (-Os, -O, -O2, -O3). Intel 12.1.0 refuses to optimize this. And I have no info about Visual C.

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-09-15T18:56:38.707

The original answer solved the problem only for `unsigned` => `int`. What if we want to solve the general problem of "some unsigned type" to its corresponding signed type? Furthermore, the original answer was excellent at citing sections of the standard and analyzing some corner cases, but it did not really help me get a feel for why it worked, so this answer will try to give a strong conceptual basis. This answer will try to help explain "why", and use modern C++ features to try to simplify the code.

## C++20 answer

The problem has simplified dramatically with [P0907: Signed Integers are Two’s Complement](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0907r4.html) and the [final wording P1236](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1236r1.html) that was voted into the C++20 standard. Now, the answer is as simple as possible:

```
template<std::unsigned_integral T>
constexpr auto cast_to_signed_integer(T const value) {
    return static_cast<std::make_signed_t<T>>(value);
} 
```

That's it. A `static_cast` (or C-style cast) is finally guaranteed to do the thing you need for this question, and the thing many programmers thought it always did.

## C++17 answer

In C++17, things are much more complicated. We have to deal with three possible integer representations (two's complement, ones' complement, and sign-magnitude). Even in the case where we know it must be two's complement because we checked the range of possible values, the conversion of a value outside the range of the signed integer to that signed integer still gives us an implementation-defined result. We have to use tricks like we have seen in other answers.

First, here is the code for how to solve the problem generically:

```
template<typename T, typename = std::enable_if_t<std::is_unsigned_v<T>>>
constexpr auto cast_to_signed_integer(T const value) {
    using result = std::make_signed_t<T>;
    using result_limits = std::numeric_limits<result>;
    if constexpr (result_limits::min() + 1 != -result_limits::max()) {
        if (value == static_cast<T>(result_limits::max()) + 1) {
            throw std::runtime_error("Cannot convert the maximum possible unsigned to a signed value on this system");
        }
    }
    if (value <= result_limits::max()) {
        return static_cast<result>(value);
    } else {
        using promoted_unsigned = std::conditional_t<sizeof(T) <= sizeof(unsigned), unsigned, T>;
        using promoted_signed = std::make_signed_t<promoted_unsigned>;
        constexpr auto shift_by_window = [](auto x) {
            // static_cast to avoid conversion warning
            return x - static_cast<decltype(x)>(result_limits::max()) - 1;
        };
        return static_cast<result>(
            shift_by_window( // shift values from common range to negative range
                static_cast<promoted_signed>(
                    shift_by_window( // shift large values into common range
                        static_cast<promoted_unsigned>(value) // cast to avoid promotion to int
                    )
                )
            )
        );
    }
} 
```

This has a few more casts than the accepted answer, and that is to ensure there are no signed / unsigned mismatch warnings from your compiler and to properly handle integer promotion rules.

We first have a special case for systems that are not two's complement (and thus we must handle the maximum possible value specially because it doesn't have anything to map to). After that, we get to the real algorithm.

The second top-level condition is straightforward: we know the value is less than or equal to the maximum value, so it fits in the result type. The third condition is a little more complicated even with the comments, so some examples would probably help understand why each statement is necessary.

## Conceptual basis: the number line

First, what is this `window` concept? Consider the following number line:

```
 |   signed   |
<.........................>
          |  unsigned  | 
```

It turns out that for two's complement integers, you can divide the subset of the number line that can be reached by either type into three equally sized categories:

```
- => signed only
= => both
+ => unsigned only

<..-------=======+++++++..> 
```

This can be easily proven by considering the representation. An unsigned integer starts at `0` and uses all of the bits to increase the value in powers of 2\. A signed integer is exactly the same for all of the bits except the sign bit, which is worth `-(2^position)` instead of `2^position`. This means that for all `n - 1` bits, they represent the same values. Then, unsigned integers have one more normal bit, which doubles the total number of values (in other words, there are just as many values with that bit set as without it set). The same logic holds for signed integers, except that all the values with that bit set are negative.

The other two legal integer representations, ones' complement and sign-magnitude, have all of the same values as two's complement integers except for one: the most negative value. C++ defines everything about integer types, except for `reinterpret_cast` (and the C++20 `std::bit_cast`), in terms of the range of representable values, not in terms of the bit representation. This means that our analysis will hold for each of these three representations as long as we do not ever try to create the trap representation. The unsigned value that would map to this missing value is a rather unfortunate one: the one right in the middle of the unsigned values. Fortunately, our first condition checks (at compile time) whether such a representation exists, and then handles it specially with a runtime check.

The first condition handles the case where we are in the `=` section, which means that we are in the overlapping region where the values in one can be represented in the other without change. The `shift_by_window` function in the code moves all values down by the size of each of these segments (we have to subtract the max value then subtract 1 to avoid arithmetic overflow issues). If we are outside of that region (we are in the `+` region), we need to jump down by one window size. This puts us in the overlapping range, which means we can safely convert from unsigned to signed because there is no change in value. However, we are not done yet because we have mapped two unsigned values to each signed value. Therefore, we need to shift down to the next window (the `-` region) so that we have a unique mapping again.

Now, does this give us a result congruent mod `UINT_MAX + 1`, as requested in the question? `UINT_MAX + 1` is equivalent to `2^n`, where `n` is the number of bits in the value representation. The value we use for our window size is equal to `2^(n - 1)` (the final index in a sequence of values is one less than the size). We subtract that value twice, which means we subtract `2 * 2^(n - 1)` which is equal to `2^n`. Adding and subtracting `x` is a no-op in arithmetic mod `x`, so we have not affected the original value mod `2^n`.

## Properly handling integer promotions

Because this is a generic function and not just `int` and `unsigned`, we also have to concern ourselves with integral promotion rules. There are two possibly interesting cases: one in which `short` is smaller than `int` and one in which `short` is the same size as `int`.

### Example: `short` smaller than `int`

If `short` is smaller than `int` (common on modern platforms) then we also know that `unsigned short` can fit in an `int`, which means that any operations on it will actually happen in `int`, so we explicitly cast to the promoted type to avoid this. Our final statement is pretty abstract and becomes easier to understand if we substitute in real values. For our first interesting case, with no loss of generality let us consider a 16-bit `short` and a 17-bit `int` (which is still allowed under the new rules, and would just mean that at least one of those two integer types have some padding bits):

```
constexpr auto shift_by_window = [](auto x) {
    return x - static_cast<decltype(x)>(32767) - 1;
};
return static_cast<int16_t>(
    shift_by_window(
        static_cast<int17_t>(
            shift_by_window(
                static_cast<uint17_t>(value)
            )
        )
    )
); 
```

Solving for the greatest possible 16-bit unsigned value

```
constexpr auto shift_by_window = [](auto x) {
    return x - static_cast<decltype(x)>(32767) - 1;
};
return int16_t(
    shift_by_window(
        int17_t(
            shift_by_window(
                uint17_t(65535)
            )
        )
    )
); 
```

Simplifies to

```
return int16_t(
    int17_t(
        uint17_t(65535) - uint17_t(32767) - 1
    ) -
    int17_t(32767) -
    1
); 
```

Simplifies to

```
return int16_t(
    int17_t(uint17_t(32767)) -
    int17_t(32767) -
    1
); 
```

Simplifies to

```
return int16_t(
    int17_t(32767) -
    int17_t(32767) -
    1
); 
```

Simplifies to

```
return int16_t(-1); 
```

We put in the largest possible unsigned and get back `-1`, success!

### Example: `short` same size as `int`

If `short` is the same size as `int` (uncommon on modern platforms), the integral promotion rule are slightly different. In this case, `short` promotes to `int` and `unsigned short` promotes to `unsigned`. Fortunately, we explicitly cast each result to the type we want to do the calculation in, so we end up with no problematic promotions. With no loss of generality let us consider a 16-bit `short` and a 16-bit `int`:

```
constexpr auto shift_by_window = [](auto x) {
    return x - static_cast<decltype(x)>(32767) - 1;
};
return static_cast<int16_t>(
    shift_by_window(
        static_cast<int16_t>(
            shift_by_window(
                static_cast<uint16_t>(value)
            )
        )
    )
); 
```

Solving for the greatest possible 16-bit unsigned value

```
auto x = int16_t(
    uint16_t(65535) - uint16_t(32767) - 1
);
return int16_t(
    x - int16_t(32767) - 1
); 
```

Simplifies to

```
return int16_t(
    int16_t(32767) - int16_t(32767) - 1
); 
```

Simplifies to

```
return int16_t(-1); 
```

We put in the largest possible unsigned and get back `-1`, success!

## What if I just care about `int` and `unsigned` and don't care about warnings, like the original question?

```
constexpr int cast_to_signed_integer(unsigned const value) {
    using result_limits = std::numeric_limits<int>;
    if constexpr (result_limits::min() + 1 != -result_limits::max()) {
        if (value == static_cast<unsigned>(result_limits::max()) + 1) {
            throw std::runtime_error("Cannot convert the maximum possible unsigned to a signed value on this system");
        }
    }
    if (value <= result_limits::max()) {
        return static_cast<int>(value);
    } else {
        constexpr int window = result_limits::min();
        return static_cast<int>(value + window) + window;
    }
} 
```

## See it live

[https://godbolt.org/z/74hY81](https://godbolt.org/z/74hY81)

Here we see that clang, gcc, and icc generate no code for `cast` and `cast_to_signed_integer_basic` at `-O2` and `-O3`, and MSVC generates no code at `/O2`, so the solution is optimal.

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-03T07:29:21.637

You can explicitly tell the compiler what you want to do:

```
int unsigned_to_signed(unsigned n) {
  if (n > INT_MAX) {
    if (n <= UINT_MAX + INT_MIN) {
      throw "no result";
    }
    return static_cast<int>(n + INT_MIN) - (UINT_MAX + INT_MIN + 1);
  } else {
    return static_cast<int>(n);
  }
} 
```

Compiles with `gcc 4.7.2` for `x86_64-linux` (`g++ -O -S test.cpp`) to

```
_Z18unsigned_to_signedj:
    movl    %edi, %eax
    ret 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-10-31T03:26:47.383

If `x` is our input...

If `x > INT_MAX`, we want to find a constant `k` such that `0` < `x - k*INT_MAX` < `INT_MAX`.

This is easy -- `unsigned int k = x / INT_MAX;`. Then, let `unsigned int x2 = x - k*INT_MAX;`

We can now cast `x2` to `int` safely. Let `int x3 = static_cast<int>(x2);`

We now want to subtract something like `UINT_MAX - k * INT_MAX + 1` from `x3`, if `k > 0`.

Now, on a 2s complement system, so long as `x > INT_MAX`, this works out to:

```
unsigned int k = x / INT_MAX;
x -= k*INT_MAX;
int r = int(x);
r += k*INT_MAX;
r -= UINT_MAX+1; 
```

Note that `UINT_MAX+1` is zero in C++ guaranteed, the conversion to int was a noop, and we subtracted `k*INT_MAX` then added it back on "the same value". So an acceptable optimizer should be able to erase all that tomfoolery!

That leaves the problem of `x > INT_MAX` or not. Well, we create 2 branches, one with `x > INT_MAX`, and one without. The one without does a strait cast, which the compiler optimizes to a noop. The one with ... does a noop after the optimizer is done. The smart optimizer realizes both branches to the same thing, and drops the branch.

Issues: if `UINT_MAX` is really large relative to `INT_MAX`, the above might not work. I am assuming that `k*INT_MAX <= UINT_MAX+1` implicitly.

We could probably attack this with some enums like:

```
enum { divisor = UINT_MAX/INT_MAX, remainder = UINT_MAX-divisor*INT_MAX }; 
```

which work out to 2 and 1 on a 2s complement system I believe (are we guaranteed for that math to work? That's tricky...), and do logic based on these that easily optimize away on non-2s complement systems...

This also opens up the exception case. It is only possible if UINT_MAX is much larger than (INT_MIN-INT_MAX), so you can put your exception code in an if block asking exactly that question somehow, and it won't slow you down on a traditional system.

I'm not exactly sure how to construct those compile-time constants to deal correctly with that.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-31T03:30:08.230

`std::numeric_limits<int>::is_modulo` is a compile time constant. so you can use it for template specialization. problem solved, at least if compiler plays along with inlining.

```
#include <limits>
#include <stdexcept>
#include <string>

#ifdef TESTING_SF
    bool const testing_sf = true;
#else
    bool const testing_sf = false;
#endif

// C++ "extensions"
namespace cppx {
    using std::runtime_error;
    using std::string;

    inline bool hopefully( bool const c ) { return c; }
    inline bool throw_x( string const& s ) { throw runtime_error( s ); }

}  // namespace cppx

// C++ "portability perversions"
namespace cppp {
    using cppx::hopefully;
    using cppx::throw_x;
    using std::numeric_limits;

    namespace detail {
        template< bool isTwosComplement >
        int signed_from( unsigned const n )
        {
            if( n <= unsigned( numeric_limits<int>::max() ) )
            {
                return static_cast<int>( n );
            }

            unsigned const u_max = unsigned( -1 );
            unsigned const u_half = u_max/2 + 1;

            if( n == u_half )
            {
                throw_x( "signed_from: unsupported value (negative max)" );
            }

            int const i_quarter = static_cast<int>( u_half/2 );
            int const int_n1 = static_cast<int>( n - u_half );
            int const int_n2 = int_n1 - i_quarter;
            int const int_n3 = int_n2 - i_quarter;

            hopefully( n == static_cast<unsigned>( int_n3 ) )
                || throw_x( "signed_from: range error" );

            return int_n3;
        }

        template<>
        inline int signed_from<true>( unsigned const n )
        {
            return static_cast<int>( n );
        }
    }    // namespace detail

    inline int signed_from( unsigned const n )
    {
        bool const is_modulo = numeric_limits< int >::is_modulo;
        return detail::signed_from< is_modulo && !testing_sf >( n );
    }
}    // namespace cppp

#include <iostream>
using namespace std;
int main()
{
    int const x = cppp::signed_from( -42u );
    wcout << x << endl;
} 
```

* * *

**EDIT**: Fixed up code to avoid possible trap on non-modular-int machines (only one is known to exist, namely the archaically configured versions of the Unisys Clearpath). For simplicity this is done by not supporting the value -2^(*n*-1) where *n* is the number of `int` value bits, on such machine (i.e., on the Clearpath). in practice this value will not be supported by the machine either (i.e., with sign-and-magnitude or 1’s complement representation).

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-06T01:33:52.110

I think the int type is at least two bytes, so the INT_MIN and INT_MAX may change in different platforms.

[Fundamental types](http://en.cppreference.com/w/cpp/language/types)

[≤climits≥ header](http://www.cplusplus.com/reference/clibrary/climits/)

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-05-01T18:26:41.840

My money is on using memcpy. Any decent compiler knows to optimise it away:

```
#include <stdio.h>
#include <memory.h>
#include <limits.h>

static inline int unsigned_to_signed(unsigned n)
{
    int result;
    memcpy( &result, &n, sizeof(result));
    return result;
}

int main(int argc, const char * argv[])
{
    unsigned int x = UINT_MAX - 1;
    int xx = unsigned_to_signed(x);
    return xx;
} 
```

For me (Xcode 8.3.2, Apple LLVM 8.1, -O3), that produces:

```
_main:                                  ## @main
Lfunc_begin0:
    .loc    1 21 0                  ## /Users/Someone/main.c:21:0
    .cfi_startproc
## BB#0:
    pushq    %rbp
Ltmp0:
    .cfi_def_cfa_offset 16
Ltmp1:
    .cfi_offset %rbp, -16
    movq    %rsp, %rbp
Ltmp2:
    .cfi_def_cfa_register %rbp
    ##DEBUG_VALUE: main:argc <- %EDI
    ##DEBUG_VALUE: main:argv <- %RSI
Ltmp3:
    ##DEBUG_VALUE: main:x <- 2147483646
    ##DEBUG_VALUE: main:xx <- 2147483646
    .loc    1 24 5 prologue_end     ## /Users/Someone/main.c:24:5
    movl    $-2, %eax
    popq    %rbp
    retq
Ltmp4:
Lfunc_end0:
    .cfi_endproc 
```

# verilog - Verilog中的二进制补码

> ID：13150452
> 
> 赞同：4
> 
> 时间：2012-10-31T02:32:31.850
> 
> 标签：verilog

我一直在尝试构建一个模块，该模块返回（3位）输入的二进制补码表示（第一位是符号）。我认为以下代码在概念上是正确的，但我可能遗漏了它的结构：当我尝试编译时，出现以下错误：

```
(vlog-2110) Illegal reference to net "f_o".
(vlog-2110) Illegal reference to net "f_o".
(vlog-2110) Illegal reference to net "f_o". 
```

搜索该错误表明它通常在同时使用变量作为输入和输出时出现，但这不是我的情况。你能指出错误在哪里吗？

```
module ca2 (a_i,f_o);
  input  [2:0] a_i;
  output [2:0] f_o;

  always @(a_i[2:0] or f_o[2:0])
  begin
    if (a_i[2] == 1)
    begin
      f_o[2]   = a_i[2];
      f_o[1:0] = (~a_i[1:0] + 'b1);
    end
    else
    begin
      f_o = a_i;
    end
  end
endmodule 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:43:15.763

在 Verilog 中，在大多数情况下，未声明的标识符被视为隐式连线声明。由于 f_o 没有被声明，编译器认为它是一个连线，而不是一个变量。这会导致编译器抱怨所有的分配。

```
// What was typed
module ca2 (a_i,f_o);
  input  [2:0] a_i;
  output [2:0] f_o;

// What the compiler implicitly declares
  wire   [2:0] a_i;
  wire   [2:0] f_o; 
```

要修复它，您可以声明变量或同时声明端口和变量。

```
module ca2 (a_i,f_o);
  input  [2:0] a_i;
  output [2:0] f_o; 
  reg [2:0] f_o;

module ca2 (a_i,f_o);
  input      [2:0] a_i;
  output reg [2:0] f_o; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T07:31:59.550

`f_o`需要声明为 reg。`output reg [2:0] f_o`.

另外我不确定你在计算什么，这不是标准的二进制补码。

```
module ca2 (
  input      [2:0] a_i,
  output     [2:0] twos_comp,
  output     [2:0] also_twos_comp
);

  assign      twos_comp = ~a_i + 1'b1;
  assign also_twos_comp = -a_i ;
endmodule 
```

您可能正在处理编码输入，但 twos_complement 是否定我希望符号位 (MSB) 改变的数字。尽管我们将其称为符号位，但它也包含有关值的信息，因此不能仅仅将其剥离并保持数字不变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-07-27T10:10:29.873

第一种解决方案->在时序电路中，输出必须是reg的形式。接下来我们需要知道，在二进制补码中，我们从零位开始到最后，所以条件不正确。如果零位为一，则零位不变，其余位变为不变。

```
module ca2 (input  [2:0] a_i,output reg [2:0] f_o);
  always @(a_i[2:0] or f_o[2:0]) begin
    if (a_i[0] == 1'b1) begin
      f_o[0] = a_i[0];
      f_o[2:1] = (~a_i[2:1]);
    end
    else
    if(a_i[1]==1'b1) begin
      f_o[1:0] = a_i[1:0];
      f_o[2] = (~a_i[2]);
    end
    else
    if(a_i[2] == 1'b1) begin
      f_o = a_i ;
     end
  end
endmodule 
```

第二种解决方案 -> 在二进制数中，如果我们从零中减去数字，我们会得到二进制补码。

```
module ca2 (input [2:0] a_i,output reg [2:0] f_o);
  always @(a_i[2:0] or f_o[2:0]) begin
    f_o = 3'b000 - a_i ;
  end
endmodule 
```

第三种解决方案->所有位都变为非，最后将它们添加到第一个（3'b000 = 3'b0）

```
module ca2 (input [2:0] a_i,output reg [2:0] f_o);
  reg [2:0] finish ;
  always @(a_i[2:0] or f_o[2:0]) begin
    finish = (~a_i);
    f_o = finish + 3'b001 ;
  end
endmodule 
```

# ruby - 黄瓜数据工厂，watir

> ID：13150454
> 
> 赞同：5
> 
> 时间：2012-10-31T02:33:23.550
> 
> 标签：ruby, testing, cucumber, watir, ui-automation

我们有一个独立的测试自动化团队，只负责自动化 watir+cucumber 功能测试用例。他们的代码库没有附加到其他开发人员正在开发的 rails 应用程序，而是保持独立。到目前为止，我们已经自动化了几个测试用例，现在我们遇到的问题是，一些（watir/cucumber 规范）测试用例需要一些数据预先存在于数据库中，所以它（测试用例）应该只关注问题 stmt，而不是创建任何数据要求本身。

例如，如果它必须检查评级是否对帖子有效，它要求帖子对象应该预先存在并且它只检查评级。并且不创建第一个帖子对象，然后检查其评级。

这里最好的方法是什么？就像我们有用于轨道单元测试的固定装置和工厂女孩一样，黄瓜规格有什么？或者我们应该只在这里使用特性吗？这些测试人员可能不知道所有存在的模型，他们是否知道它们以便通过调用 Rails-Model 接口来使用固定装置。

我的想法是，当我们编写功能文件时，它不应该指向或谈论任何看起来像元数据的模型。Watir/specs 测试用例应该只知道“Web-application”/browser 只是作为与应用程序交谈/处理的接口。他们不应该知道任何其他接口（夹具/模型）。因此，他们应该通过使用他们知道的单一界面自己创建自己的数据。

同样，我想知道的是，是否有任何 ruby​​ 库/代码，给定表名、列名和值（都最像fixture yml），以及 db 参数。它只会将它们插入到数据库中，而不需要 Rails 环境的上下文。因此，那些将环境与 Rails Web 开发人员隔离的测试人员能够独立工作。Rails 固定装置或工厂女孩似乎与 Rails 很好地结合在一起。还是我不正确？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T17:38:59.693

就像 Chirantan 说的，你可以用 Factory girl 和黄瓜。由于需要您的工厂在测试单元或 RSpec 中，您可以在黄瓜的 env.rb 文件或任何自定义配置文件中执行相同的操作。

[http://robots.thoughtbot.com/post/284805810/gimme-three-steps](http://robots.thoughtbot.com/post/284805810/gimme-three-steps)

[http://www.claytonlz.com/2010/03/zero-to-tested-with-cucumber-and-factory-girl/](http://www.claytonlz.com/2010/03/zero-to-tested-with-cucumber-and-factory-girl/)

[http://www.andhapp.com/blog/2009/11/07/using-factory_girl-with-cucumber/](http://www.andhapp.com/blog/2009/11/07/using-factory_girl-with-cucumber/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-08T22:02:57.393

使用 cucumber 时，Given 语句设置了测试情况：

```
Given I have a basic user with a password 
```

当语句触发测试：

```
When the user logs in 
```

然后语句检查测试结果

```
Then they see the basic menu 
```

数据在 Given 语句中加载。

# php - 获取 Gmail API 上带有附件的邮件列表

> ID：13150457
> 
> 赞同：0
> 
> 时间：2012-10-31T02:34:14.873
> 
> 标签：php, gmail, google-api

所以我必须构建一个浏览器扩展来提取所有带有扩展的电子邮件。然而，我很茫然，如何去做。我本质上需要的是扩展程序提取电子邮件列表，其中包含关于它们是否带有附件的描述。现在我尝试了 gmail atom 提要，但它只显示未读电子邮件，也没有提供有关该消息的大量信息。是否有另一种方法来做到这一点。

是否有类似 gmail 的 API 可以轻松、无缝地完成所有这些工作。我觉得我错过了一些明显的东西。我知道我在这里含糊不清，但我真的不知道如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:49:28.103

可以使用 IMAP 搜索“has:attachment”来完成。示例和描述可以在以下资源下找到：

*   [**developers.google.com - Google Apps 平台 - Google Developers**](https://developers.google.com/google-apps/gmail/oauth_overview)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-14T03:03:33.033

我知道这是一个很老的问题，但自从这个问题发布以来，谷歌已经发布了一个 WEB API 来使用 gmail。

[https://developers.google.com/gmail/api/](https://developers.google.com/gmail/api/)

# php - 高级 PHP 开发人员会在哪里找到 getActiveEntries() 方法？

> ID：13150460
> 
> 赞同：0
> 
> 时间：2012-10-31T02:34:43.883
> 
> 标签：php, oop

## 关注点分离或单一责任原则

“可能已经有你的答案”的问题下拉列表中的大多数问题仅解释“理论”，而不是回答我的简单问题的具体示例。

## 我想要完成的事情

我有一个名为 GuestbookEntry 的类，它映射到名为“guestbook”的数据库表中的属性。很简单！

最初，我有一个名为 getActiveEntries() 的静态方法，它检索在数据库中有条目的所有 GuestbookEntry 对象的数组。然后在学习如何正确设计 php 类的同时，我学到了两件事：

1.  静态方法是不可取的。
2.  关注点分离

## 我的问题：

处理关注点分离，如果 GuestbookEntry 类应该只负责管理单个留言簿条目，那么这个 getActiveEntries() 方法应该去哪里？我想学习绝对正确的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T14:13:01.163

我想这个问题实际上有两个项目：

1.  正如@duskwuff 指出的那样，静态方法本身并没有错。如果您知道它们的警告（例如“ [Late Static Binding](http://php.net/manual/en/language.oop5.late-static-bindings.php) ”）和限制，它们只是另一个可以使用的工具。但是，对与 DB 的交互进行建模的方式确实会影响关注点分离，例如单元测试。

2.  由于不同的原因，没有“绝对正确的方法”来做持久性。原因之一是每种解决方法都有不同的权衡。哪个更适合您的项目很难说。另一个重要的原因是语言不断发展，因此新的语言特性可以改进框架处理事物的方式。因此，与其寻找完美的方法，不如考虑使用关系数据库来实现 OO 持久性的不同方法：

    *   使用[活动记录](http://en.wikipedia.org/wiki/Active_record_pattern)模式。到目前为止，您所做的看起来像是 Active Record 样式，因此您可能会觉得它很自然。活动记录的优点是易于掌握，但往往与数据库紧密耦合（当然这取决于实现）。从关注点分离的角度来看，这很糟糕，并且可能会使测试复杂化。
    *   使用 ORM（如[Doctrine](http://www.doctrine-project.org/)或[Propel](http://www.propelorm.org/)）。在这种情况下，大部分繁重的工作都由框架完成（BD 映射、外键、级联删除、一些标准查询等），但您必须适应框架规则（例如，我记得在使用Doctrine 1 在项目中处理层次结构的方式。AFAIK 这些事情在 Doctrine 2 中得到了解决）。
    *   推出您自己的框架以适应您的项目需求和您的编程风格。这显然是一项耗时的任务，但你会学到很多东西。

作为一般的经验法则，我尽量让我的领域模型独立于 DB 之类的东西，主要是因为单元测试。单元测试应该在您编程时一直运行，因此它们应该运行得很快（我在编程时总是保持终端打开，并且在应用更改后我不断切换到它以运行整个套件）。如果您必须与数据库交互，那么您的测试将会变慢（任何中型系统都会有 100 或 200 个测试方法，因此这些方法应该以毫秒为单位运行才能有用）。

最后，有不同的技术来处理与 DB 通信的对象（例如模拟对象），但一个好的建议是始终在您的域模型和 DB 之间留一个层。这将使您的模型对更改更加灵活并且更易于测试。

编辑：我忘了提到[DAO](http://en.wikipedia.org/wiki/Data_access_object)方法，也在@MikeSW 回答中说明。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T08:21:17.513

GetActiveEntries 应该是一个存储库/DAO 的方法，它将返回一个 GuestBookEntry 数组。该存储库当然可以实现一个接口，因此在这里您可以轻松进行测试。

我不同意为此使用静态方法，因为这显然是一个持久性访问问题。GuestBookEntry 应该只关心“业务”功能，而不关心数据库。这就是为什么使用存储库很有用，该对象将把业务层连接到数据库层。

**编辑**我的 php 生锈，但你明白了。

```
public interface IRetrieveEntries
{
    function GetActiveEntries();
}

public class EntriesRepository implements IRetrieveEntries
{
    private $_db;
    function __constructor($db)
    {
       $this->_db=$db;
     }

    function GetActiveEntries()
    {
      /* use $db to retreive the actual entries
       You can use an ORM, PDO whatever you want 
         */
      //return entries;
    }

  } 
```

您将在需要访问功能的任何地方传递接口，即您不会将代码耦合到实际存储库。您还将使用它进行单元测试。关键是您将真正的数据访问封装在 GetActiveEntries 方法中，应用程序的其余部分将不知道数据库。

关于存储库模式，您可以阅读我写的[一些教程（忽略使用的 C#，这些概念在任何语言中都有效）](http://www.sapiensworks.com/blog/post/2012/02/22/The-Repository-Pattern-Explained.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T04:44:48.467

不要再猜测自己了。静态方法`getActiveEntries()`是解决此问题的完全合理的方法。

您正在寻找的“企业”解决方案可能涉及创建 GuestbookEntryFactory 对象、将其配置为获取活动条目并执行它。这很愚蠢。静态方法是一种工具，这对他们来说是完全合适的工作。

# c - 使用 memcpy 复制不同类型的数组

> ID：13150462
> 
> 赞同：2
> 
> 时间：2012-10-31T02:34:57.300
> 
> 标签：c

我读过[这个](https://stackoverflow.com/questions/4944252/using-memcpy-to-copy-a-structure)，[这个](https://stackoverflow.com/questions/4932012/copying-one-structure-to-another)和[这个](https://stackoverflow.com/questions/4931123/copying-one-structure-to-another)，但没有一个回答我想知道的

一组 PId（每个 3 个字节）从保存到原始数组 ( `buffer`) 中的硬件返回。该设备准确返回 84 个字节。

然后我需要将这些 PId 复制到一个或多个数组，该数组可由该设备的 API 库读取。

这是我的代码

```
#pragma pack (1)
typedef unsigned char PId[3];
typedef PId PIDs[28];

int GetList(PId* plist){

    unsigned char buffer[84];

    //... Reads the data from hardware memory to buffer
    if (RunCMD(0xCD, &buffer)){
        // buffer has the correct data now 'AAAA...'

        memcpy(&plist,buffer, 84);

        printf("%02X%02X%02X\n", buffer[0], buffert[1], buffer[2]); 
        printf("%02X%02X%02X\n", buffer[3], buffer[4], buffer[5]); 

        return 0;
    } 
    return 1;
}

int main(void) {
    ...

    PId plist_a;
    GetList(&plist_a);

    printf("%02X%02X%02X\n", plist_a[0][0], plist_a[0][1], plist_a[0][2]); 
    printf("%02X%02X%02X\n", plist_a[1][0], plist_a[1][1], plist_a[1][2]); 
    ...
} 
```

不知何故，这段代码没有将正确的数据复制到`PIDs`数组中。`buffer`有正确的数据，但之后`memcpy`，`pids`没有相同的数据。

我知道我做错了什么，但我找不到。

如果有帮助，我正在用 Windows 编译我的`GCC`代码`ARM CPU`

编辑：我很抱歉让大家感到困惑，实际上代码是有效的，但是我错过了一部分代码。我更正了。 `pids`不是类型`PIDs`，它是指向它的指针。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T03:30:48.800

看看[这个问题的答案](https://stackoverflow.com/questions/4523497/typedef-fixed-length-array)。您可能不想`typedef`直接使用 s 数组。

尝试这样的事情：

声明：

```
#pragma pack (1)

typedef struct PId
{
    unsigned char pid[3];
} PId;

typedef struct PIDs
{
    PId pids[28];
} PIDs; 
```

然后，对于 memcpy...

其他人指出您正在传递指针，例如`PId* plist`，但您正在尝试使用 memcpy like `memcpy(&plist, buffer, 84);`。该`&`符号会让您感到困惑，因为它会引用指针本身的地址。你想要的是：

```
//plist should probably be a pointer to PIDs, not PId
int GetList(PIDs* plist){

    unsigned char buffer[84];

    //... Reads the data from hardware memory to buffer
    if (RunCMD(0xCD, &buffer)){
        // buffer has the correct data now 'AAAA...'

        //remove the & symbol
        memcpy(plist,buffer, 84);

    //etc
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T04:25:24.287

请注意，对于数组，您不需要传递地址。做就是了

```
memcpy(pids, buffer, 84); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T02:46:16.087

我很困惑为什么这甚至可以编译。代替

```
typedef PIDs PId[28]; 
```

你需要

```
typedef PId PIDs[28]; 
```

使用 a `typedef`，您将新类型的名称放在变量通常所在的位置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T03:05:17.557

这可能有效：

```
#pragma pack (1)

struct PId{
  unsigned char pid[3];
};

int main(){    
  unsigned char buffer[84];
  struct PId pids[28];

  /* buffer gets populated somewhere here */    

  memcpy(pids, buffer, 84);
} 
```

# xml - 在哪里声明一个 simpleType 以便它可以在同一个 XSD 中的多个元素中使用？

> ID：13150465
> 
> 赞同：3
> 
> 时间：2012-10-31T02:35:15.710
> 
> 标签：xml, xsd, simpletype

现在我有一个看起来像这样的 XSD 文件（例如 FOO_SCHEMA.xsd）：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" 
elementFormDefault="qualified" attributeFormDefault="unqualified">
    <xs:element name="FOO">
        <xs:annotation>
            <xs:documentation>Comment</xs:documentation>
        </xs:annotation>
        <xs:complexType>
            <xs:sequence>
                <xs:element name="BAR1" type="xs:string" />
                <xs:element name="BAR2" type="xs:string" />
                <xs:element name="BAR3" type="xs:string" />
                <xs:element name="BAR4" type="xs:string" />
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

我想修改两个元素（比如 BAR1 和 BAR2）以使用一次。我知道如何将它用于其中之一，

```
<xs:element name="BAR1">
   <xs:simpleType>
       <!-- my type definition here -->
   </xs:simpleType>
</xs:element> 
```

但我想在两个（甚至更多）元素中使用它，我不确定如何在不复制相同的简单类型定义的情况下做到这一点。从谷歌搜索，似乎我需要用名称声明类型

但我不知道在哪里放置这个声明。我尝试将它放在与 xs:complexType 和其他几个级别相同的级别，但它被架构验证器拒绝。知道把这个声明放在哪里吗？任何的想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T02:42:09.890

XSD 文件中的所有可引用组件都必须直接放在`xs:schema`元素下方。换句话说，你的全局简单类型声明必须是`FOO`元素的兄弟。

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" 
elementFormDefault="qualified" attributeFormDefault="unqualified">
    <xs:element name="FOO">
        <xs:annotation>
            <xs:documentation>Comment</xs:documentation>
        </xs:annotation>
        <xs:complexType>
            <xs:sequence>
                <xs:element name="BAR1" type="BAR" />
                <xs:element name="BAR2" type="BAR" />
                <xs:element name="BAR3" type="xs:string" />
                <xs:element name="BAR4" type="xs:string" />
            </xs:sequence>
        </xs:complexType>
    </xs:element>
    <xs:simpleType name="BAR">
        <xs:restriction base="xs:string">
            <xs:pattern value="BAR"/>
        </xs:restriction>
    </xs:simpleType>
</xs:schema> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T02:46:06.660

定义全局并使用 type 属性来指定类型。

```
 <xs:simpleType name="test">
    <xs:annotation>
      <xs:documentation>
        Defines a string that is between 1 and 300 chars
      </xs:documentation>
    </xs:annotation>
    <xs:restriction base="xs:string">
      <xs:minLength value="1" />
      <xs:maxLength value="300" />
    </xs:restriction>
  </xs:simpleType>

  <xs:element name="foo">
    <xs:complexType>
      <xs:attribute type="test" name="bar"/>
    </xs:complexType>   
  </xs:element> 
```

# php - Jquery 无需刷新即可提交（无需验证）

> ID：13150471
> 
> 赞同：2
> 
> 时间：2012-10-31T02:36:00.800
> 
> 标签：php, jquery, ajax, smarty

我有一个工作正常的标签表单，通过一些服务器验证，我想添加一个 Jquery 来提交内容而不刷新：

```
<form method="post" action="tags">
  <div>
        <input type="hidden" name="id" value="getId()" />
        <input type="text" name="tag" />
        <input type="submit" value="Add" name="add" />
    </div>
</form> 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:40:20.753

查看[jQuery 表单插件](http://www.malsup.com/jquery/form/)。使用它，您可以提交表单而无需重新加载页面，如下所示：

```
<form id="aForm" action="target.php" method="post>
    ...
</form>
<script type="text/javascript">
    $(document).ready(function() {
        $("#aForm").ajaxForm();
    });
</script> 
```

该`ajaxForm()`函数还支持可以传递给标准[jQuery $.ajax](http://docs.jquery.com/Ajax/jQuery.ajax#toptions)函数的所有选项（例如回调函数）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T02:42:46.533

```
 $(document).ready(function() {
  $(form).submit( function() { // could use $(#submit).on('click', function(){ as well
   $.ajax({
     url: 'yourposturl',
     data: $(form).serialize(),
     Success: function() {
         alert('ok');
     }
   }); //end ajax   

  return false;
   }); //end submit()
 }); 
```

应该采用所有形式的变量，将它们序列化以便服务器可以接收，返回 false 是这样页面在提交时不会刷新（停止传播和默认）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T02:39:40.950

添加 JQuery javascript 库

将提交变成按钮

```
 <button id="submitbutton" >Add</button> 
```

将 ID 添加到您的输入

```
<input type="text" id="tag" name="tag" /> 
```

并将 jquery 添加到单击按钮...

```
<script type="text/javascript">
    $(document).ready(function() {
     $("#submitbutton").button().click(function(){
     $.post("tags.php",{id: $("#id").val(), tag: $("#tag").val()});
  });
});
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T02:42:44.767

```
<form method="post" action="tags">
  <div>
        <input type="hidden" name="id" value="getId()" />
        <input type="text" name="tag" />
        <input class="button" type="button" value="Add" name="add" />
    </div>
</form>

$(function(){
   $('.button').click(function(){
       var data = $('form').serializeToObject();
       $.post('tags.php', data);
   });
});

// jQuery Extension to serialize a selector's elements to an object
$.fn.serializeToObject = function () {
    var o = {};
    var a = this.serializeArray();

    $.each(a, function () {
        if (o[this.name] !== undefined) {
            if (!o[this.name].push) {
                o[this.name] = [o[this.name]];
            }
            o[this.name].push(this.value || '');
        } else {
            o[this.name] = this.value || '';
        }
    });
    return o;
}; 
```

# mysql - MySQL 5.5.25中需要给参数“log-output = TABLE”分配多个表

> ID：13150472
> 
> 赞同：1
> 
> 时间：2012-10-31T02:36:02.703
> 
> 标签：mysql

有没有办法将多个表分配给 my.cnf 中的参数“log-output = TABLE”？我想继续旋转表格，备份并在旋转后截断表格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T07:18:53.493

您不能在此参数中设置多个表。您只能设置“TABLE”、“FILE”、“NONE”或“TABLE,FILE”。

如果要存储日志然后清除日志表，则将数据从日志表复制到另一个表，然后 - 截断日志表。

[选择一般查询和慢查询日志输出目标](http://dev.mysql.com/doc/refman/5.6/en/log-destinations.html)。

# objective-c - 升级到 iOS 6 和 RootViewController 方向不正确

> ID：13150473
> 
> 赞同：2
> 
> 时间：2012-10-31T02:36:34.530
> 
> 标签：objective-c, ios, ios6

我正在将旧版应用程序升级到仅支持横向的 iOS 6。当我在 iPhone 模拟器或 iPhone 4 上运行应用程序时，根视图控制器的方向是纵向模式，而它应该是横向模式。但是，键盘最初处于正确的位置。此外，当我旋转设备时，键盘会保持其初始方向，并且根视图永远不会改变方向。

在项目设置的 Supported Interface Orientations 部分，选择 Landscape Left 和 Landscape Right 按钮。在pList文件中，Initial Interface Orientation设置为Landscape（右home键），Supported interfaceorientation设置为Landscape（右home键）和Landscape（左home键）。

此外，在根视图控制器中，我已替换此代码：

```
 - (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
// Return YES for supported orientations.
BOOL rotate = NO;

if (interfaceOrientation == UIInterfaceOrientationLandscapeLeft || interfaceOrientation == UIInterfaceOrientationLandscapeRight)
    rotate = YES;

return rotate;
 } 
```

使用此代码：

```
 - (NSUInteger)supportedInterfaceOrientations {

return UIInterfaceOrientationMaskLandscape;

 }

 - (BOOL)shouldAutorotate {

return YES;

 } 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:11:24.020

我在将旧版应用程序更新到 iOS 6 时遇到了同样的情况。您可以查看该帖子以获取我的解决方案：

[旋转在 iOS6 上表现不同](https://stackoverflow.com/questions/12536645/rotation-behaving-differently-on-ios6/12540375#12540375)

总而言之，您需要将主窗口`rootViewController`属性设置为自定义导航控制器实现`shouldAutorotate`，`supportedInterfaceOrientation`然后瞧，它应该可以正常工作！

# xcode4 - 故事板 segue 调用序列

> ID：13150475
> 
> 赞同：0
> 
> 时间：2012-10-31T02:36:39.353
> 
> 标签：xcode4, uistoryboardsegue

我有一个按钮，它在同一个视图上调用一个方法。该按钮生成数据并将我带到另一个 MapViewControlelr 。我在第一个视图上有“prepareForSegue”方法。但是 prepareForSegue 在按钮单击后首先被调用。结果，我的变量没有从方法调用中更新。知道有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:24:15.233

我认为您应该使用 GCD 异步加载数据，然后执行 segue，如下所示：

```
dispatch_queue_t queue = dispatch_queue_create("queue", NULL);  
dispatch_release(queue);

dispatch_async(queue, ^(void) {
    // Generate data

    // Main queue
    dispatch_async(dispatch_get_main_queue(), ^(void) {
        // perform segue
            [self performSegueWithIdentifier: @"MySegue" sender: self];
    });
}); 
```

此外，不要将 segue 从 button 配置到 newViewController - 将其**从 mainViewController 配置到 newViewController**然后使用`performSegueWithIdentifier`方法

# java - Java：如何传递表示 Enum 类的值？

> ID：13150477
> 
> 赞同：3
> 
> 时间：2012-10-31T02:36:55.400
> 
> 标签：java, class, generics, enums

动机：我想构建一个枚举，代表某些值族的所有可能值（我在这里犹豫说“类”）。枚举将有额外的方法、字段，甚至可能实现其他接口。然后我想将此枚举传递给另一个方法，它将迭代所有可能的值（使用`Enum.values()`并做一些工作。

我研究过，发现 enum`Foo`实际上变成了`Foo extends Enum<Foo>`. 这就是为什么我不能扩展枚举。我试图将我的方法参数定义为：

```
myMethod(Class<?> bar) {...}
myMethod(Class<? extends Enum> bar) {...}
myMethod(Class<? extends Enum<?>> bar) {...} 
```

但是当我尝试一些基本的方法时，在方法内部：

```
int i = bar.values().length; 
```

它失败。有没有其他方法可以做到这一点（或避免这样做）？

注意：我可以传递枚举的实际实例并使用它`bar.getDeclaringClass()`来查找枚举类（而不是实例），但这很丑陋。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-31T02:43:14.657

尝试使用以下内容：

```
<E extends Enum<E>> void myMethod(Class<E> enumType) {
    E[] values = enumType.getEnumConstants();
    ...
} 
```

从[`getEnumConstants()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#getEnumConstants%28%29)文档中：

> 如果此 Class 对象不表示枚举类型，则返回此枚举类的元素或 null。

**编辑：**如果您使用不同的枚举类型实现共享接口，您可以修改您的方法以便能够调用接口方法。例如：

```
interface Fooable {
    void foo();
}

...

<E extends Enum<E> & Fooable> void myMethod(Class<E> enumType) {
    E[] values = enumType.getEnumConstants();
    for (E value : values) {
        value.foo();
    }
} 
```

# ios - iOS 是否支持 HTTP 流水线？

> ID：13150481
> 
> 赞同：1
> 
> 时间：2012-10-31T02:37:15.280
> 
> 标签：ios, http, pipelining

我想知道 iOS 是否支持[HTTP 管道](http://en.wikipedia.org/wiki/HTTP_pipelining)，或者我是否必须自己创建请求的[正文](https://developers.google.com/prediction/docs/reference/v1.5/batch#example)。`multipart/mixed`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T14:22:56.330

是的，ios 5 支持 HTTP 流水线，但还没有真正尝试过使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-09-30T15:29:03.113

是的。

如果您提出请求，您应该指定 httpShouldUsePipelining。

```
var request = URLRequest(url: URL(string: "SOME_URL")!)

request.httpShouldUsePipelining = true 
```

# php - 使用 PHP 连接到 SQLite - 无法连接

> ID：13150483
> 
> 赞同：1
> 
> 时间：2012-10-31T02:37:19.233
> 
> 标签：php, sqlite

我正在尝试使用 PHP 连接到 SQLite。我通过将 CSV 文件导入三个表的表来创建数据库。但是，我无法使用以下代码进行连接：

```
$dbhandle = sqlite_open('db/pokedex.db', 0666, $error);
if(!$dbhandle) die ($error); 
```

这将返回以下错误：

`Warning: sqlite_open() [function.sqlite-open]: file is encrypted or is not a database in /pokedex/configpokedexdb-sqlite.php on line 12 file is encrypted or is not a database`

谷歌搜索告诉我我可能有版本不匹配。尽管在我的 phpinfo() 中发现了一些 SQLite3 提及，但我认为这可能仍然是一个问题，因此我尝试了以下建议的代码：

```
try
{
    //connect to SQLite database

    $dbhandle = new PDO("sqlite:db/pokedex.db"); //sqlite:VPN0.sqlite
   // echo "Handle has been created ...... <br><br>";

}
catch(PDOException $e)
{
    echo $e->getMessage();
    echo "<br><br>Database -- NOT -- loaded successfully .. ";
    die( "<br><br>Query Closed !!! $error");
} 
```

之后我收到以下错误：

`Warning: sqlite_exec() expects parameter 1 to be resource, object given in /home/rawdco81/public_html/pokedex/index-sqlite.php on line 53`

在此之前，我尝试运行`new PDO("sqlite:VPN0.sqlite");`站点提供的内容，但这显然是错误的，因为它根本没有指向我的 .db 文件。您将在函数调用旁边的注释中看到这段代码。

我很难连接到数据库......这样做的正确方法是什么？

另外，我正在运行 PHP 版本 5.2.13。

已编辑：我在错误的位置粘贴了错误的错误消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:48:27.763

现在我仔细观察..，我认为您在第二个代码段*中连接成功！*不过，您不应该同时`sqlite_exec`使用`PDO`；这是 SQLite 的两个不同的 PHP 接口。

第一段代码被炸的原因是遗留库不支持 PDO v3。`sqlite_exec`一旦您尝试针对`PDO`我认为的对象运行，第二段代码就会被轰炸。

我敢打赌，如果你`var_dump($dbhandle);`在 try/catch 之后加上 a，你会看到你有一个初始化的 PDO 对象。

只需阅读有关使用 PDO 运行查询的内容，您就应该很成功了！

# eclipse - Eclipse 窗口生成器 VS Netbeans GUI 生成器

> ID：13150484
> 
> 赞同：7
> 
> 时间：2012-10-31T02:37:23.020
> 
> 标签：eclipse, netbeans

我将为 abuntu OS 启动一个 J2SE 项目。我尝试了 Netbeans GUI builder 和 Eclipse windowbuilder。

两个都不错，拖拽，双击创建类似VisualStudio的事件处理程序。

但是我对**Netbeans**进行了研究，[有人](http://myblog.chaiware.org/2011/11/eclipse-window-builder-vs-netbeans-gui.html)说：

> Matisse 的第二个主要缺陷是它不够好，您将组件放在网格上，Matisse 然后使用组件的属性创建一个 XML，然后为网格上的组件生成 Java 代码。看起来很酷，但随后您决定要在表单中的某处添加按钮或调整组件的大小 - 此过程可能会导致所有 gui 混淆，将相邻的组件扔到不同的地方 - 修复它可能会很痛苦脖子。即使您设法将所有组件放置在它们应该放置的位置，但手动更改了一些生成的 netbeans 代码 - 您遇到了一个大问题，除非重新开始，否则您可能无法摆脱这个问题。

最新的netbeans上是否仍然存在该错误？什么是优点。和缺点。Netbeans GUI builder 和 Eclipse Windowbuilder 之间？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T11:08:41.477

我从 6.x 开始使用 NetBeans，从来没有遇到过这样的问题。调整组件的大小，添加一些新的，甚至处理生成的代码等非常容易，到目前为止没有任何问题。此外，NB 有一个可视化调试器和一个改进的 GridBagLayout 定制器（都是从 7.1 开始的）。

到目前为止没有使用 Eclipse Windowbuilder，但我猜它也有能力。每个人都有自己的 gui 构建器标准。顺便提一句。这篇文章的作者似乎非常关注 eclipse（*“在最好的 IDE 上 - eclipse”*）

很抱歉，我不能给你一个像“A 的优缺点，B 的优缺点”这样的答案——正如我所说的，我以前从未使用过 Eclipse Windowbuilder。对我来说没有必要这样做，我可以用 netbeans 构建一个没有问题/非常容易/快速的 gui（甚至比使用 Visual Studio 更好）。在我看来，一切都像我想要的那样工作:-)

如果您同时使用了这两种 IDE，那么在一个 IDE 上可能会有您喜欢或不喜欢的东西，但另一个可以做得更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T05:33:19.840

就个人而言，虽然 WindowBuilder 是一个在 Eclipse 中使用的非常强大的工具，但我发现它更笨重（老实说，如果这是唯一的选择，我更喜欢手动编写 Swing GUI）

Matisse 是一个更好的选择，因为前面提到的网格编辑器，我也更喜欢 Matisse 处理事件处理程序而不是 WindowBuilder 的方式。Matisse 做得好的另一件事是，它将更多属性合并到 GUI 元素设置中，其中 WindowBuilder 遍历了一个非常小的可变功能列表（让您潜入一堆自动生成的代码来更改一个简单的属性）。

Eclipse 确实有一个可用的 matisse 版本，尽管该插件不是免费的（查找 myeclipse）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-02T19:49:48.893

我同时使用了 Eclipse 和 Netbeans，

Eclipse -WindowBuilder 是一个强大的工具，易于修改。但是会导致更多的代码问题。很长一段时间后，您将获得 Spagetti-Codes 来解决问题。遇到问题时，您无法打开 Desing 层。

Netbeans 生成代码非常容易，您可以更改它，但更难的是，有时您不能。但是我没有得到任何（只有少数，我的错误）任何代码问题......或者等等，如果你遇到关于组件的问题；您可以随时轻松获取默认设置。

注意：这只是我的想法！

# ruby-on-rails - 如何将 gem 版本指定为旧版本？

> ID：13150485
> 
> 赞同：1
> 
> 时间：2012-10-31T02:37:30.893
> 
> 标签：ruby-on-rails

我尝试使用特定版本的 gem，正如 Michael Hartl 的 ruby​​ on rails 教程所指定的那样。

我输入了`$ gem update --system 1.8.24`

但我得到了这个输出：

`Latest version currently installed. Aborting.`

如何防止此命令中止？教程说明我必须使用 1.8.24 版本。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T07:16:12.603

我们可以使用以下命令来更新 gem 版本。

```
 gem update --system -v (version_number)

     using this we can do downgrading the version also. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T07:55:06.703

当您从某个随机版本降级时，您可能会遇到问题。您必须将您的 ruby​​gem 更新到最新版本，然后使用

```
gem update --system version_number 
```

要升级到最新版本，请执行

```
gem update --system 
```

# tsql - 获取数字的整数部分

> ID：13150486
> 
> 赞同：26
> 
> 时间：2012-10-31T02:37:53.440
> 
> 标签：tsql

所以我有一个小数表，比如说

```
id    value
2323   2.43
4954  63.98 
```

我想得到

```
id    value
2323      2
4954     63 
```

T-SQL 中是否有一个简单的函数可以做到这一点？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-31T02:41:41.407

```
SELECT FLOOR(value) 
```

[http://msdn.microsoft.com/en-us/library/ms178531.aspx](http://msdn.microsoft.com/en-us/library/ms178531.aspx)

FLOOR 返回小于或等于指定数值表达式的最大整数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-31T02:42:46.587

假设您可以截断小数部分，您可以这样做： `SELECT Id, CAST(value AS INT) INTO IntegerTable FROM NumericTable`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-06-20T14:19:16.587

FLOOR,CAST... 不返回带负数的整数部分，解决方案是为整数部分定义一个内部过程：

```
DELIMITER //
DROP FUNCTION IF EXISTS INTEGER_PART//

CREATE FUNCTION INTEGER_PART(n DOUBLE)

RETURNS INTEGER

DETERMINISTIC 

BEGIN

IF (n >= 0) THEN RETURN FLOOR(n);
            ELSE RETURN CEILING(n);      
END IF;

END
//

MariaDB [sidonieDE]> SELECT INTEGER_PART(3.7);
+-------------------+
| INTEGER_PART(3.7) |
+-------------------+
|                 3 |
+-------------------+
1 row in set (0.00 sec)

MariaDB [sidonieDE]> SELECT INTEGER_PART(-3.7);
+--------------------+
| INTEGER_PART(-3.7) |
+--------------------+
|                 -3 |
+--------------------+
1 row in set (0.00 sec) 
```

在您可以在这样的查询中使用该过程之后：

```
 SELECT INTEGER_PART(value) FROM table; 
```

如果您不想在数据库中定义内部过程，可以将 IF 放在这样的查询中：

```
 select if(value < 0,CEILING(value),FLOOR(value)) from table ; 
```

# drupal - Drupal 7 模块依赖

> ID：13150491
> 
> 赞同：3
> 
> 时间：2012-10-31T02:38:09.023
> 
> 标签：drupal, module, drupal-7, drupal-modules

我目前正在开发一个贷款申请网站，其中包含系统所需的许多模块。我设法创建了 4 个模块。为了说明我的问题，情况如下。

```
Module 1
Module 2 - dependent on Module 1
Module 3 - dependent on Module 1
Module 4 - dependent on Module 2 
```

现在，如果我启用模块 4 而不启用其他 3 个模块，drupal 要求我安装模块 2 和模块 1，因为它是模块 4 的先决条件。我的问题是安装顺序如下所示？

```
Module 1
Module 2
Module 4 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T04:46:49.200

是的，他们将按该顺序安装。

[问题 833192](http://drupal.org/node/833192)解决了这个问题，并于 2010 年 6 月得到解决。

您还可以查看[includes\install.core.inc](http://api.drupal.org/api/drupal/includes!install.core.inc/7)的源代码来验证这一点。搜索“始终先安装所需的模块”，您将找到负责确保首先安装依赖项的代码。

# mongodb - MongoDB 和多个 C# 客户端线程

> ID：13150495
> 
> 赞同：11
> 
> 时间：2012-10-31T02:38:49.023
> 
> 标签：mongodb, mongodb-.net-driver

我有一个要连接的 MongoDB 主实例。我正在使用 C# 驱动程序（最新版本）来连接和使用 MongoDB。

我的客户端应用程序是多线程的，因此进程将以不同的时间间隔定期运行以生成报告。当多个线程在运行时，我调用驱动程序上的各种函数（例如 server.DatabaseExists(...)），我总是遇到异常。

“请求的名称有效，但未找到请求类型的数据”

```
 at System.Net.Dns.GetAddrInfo(String name)
   at System.Net.Dns.InternalGetHostByName(String hostName, Boolean includeIPv6)
   at System.Net.Dns.GetHostAddresses(String hostNameOrAddress)
   at MongoDB.Driver.MongoServerAddress.ToIPEndPoint(AddressFamily addressFamily) in C:\work\rstam\mongo-csharp-driver\Driver\Core\MongoServerAddress.cs:line 195
   at MongoDB.Driver.MongoServerInstance.GetIPEndPoint() in C:\work\rstam\mongo-csharp-driver\Driver\Core\MongoServerInstance.cs:line 339
   at MongoDB.Driver.Internal.MongoConnection.Open() in C:\work\rstam\mongo-csharp-driver\Driver\Internal\MongoConnection.cs:line 368
   at MongoDB.Driver.Internal.MongoConnection.GetNetworkStream() in C:\work\rstam\mongo-csharp-driver\Driver\Internal\MongoConnection.cs:line 574
   at MongoDB.Driver.Internal.MongoConnection.SendMessage(MongoRequestMessage message, SafeMode safeMode, String databaseName) in C:\work\rstam\mongo-csharp-driver\Driver\Internal\MongoConnection.cs:line 555
   at MongoDB.Driver.MongoCursorEnumerator`1.GetReply(MongoConnection connection, MongoRequestMessage message) in C:\work\rstam\mongo-csharp-driver\Driver\Core\MongoCursorEnumerator.cs:line 295
   at MongoDB.Driver.MongoCursorEnumerator`1.GetFirst() in C:\work\rstam\mongo-csharp-driver\Driver\Core\MongoCursorEnumerator.cs:line 253
   at MongoDB.Driver.MongoCursorEnumerator`1.MoveNext() in C:\work\rstam\mongo-csharp-driver\Driver\Core\MongoCursorEnumerator.cs:line 141
   at MongoDB.Driver.MongoDatabase.GetCollectionNames() in C:\work\rstam\mongo-csharp-driver\Driver\Core\MongoDatabase.cs:line 645
   at MongoDB.Driver.MongoDatabase.CollectionExists(String collectionName) in C:\work\rstam\mongo-csharp-driver\Driver\Core\MongoDatabase.cs:line 297 
```

运行一个线程不会导致此问题。我知道 MongoDB 是线程安全的，所以我不知道原因和补救措施。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-07-24T10:02:09.273

我发现的唯一“解决方案”是回收托管我的网站\服务调用 mongo 客户端的应用程序池。

# python - PyQt4 - 检测全局鼠标点击

> ID：13150497
> 
> 赞同：0
> 
> 时间：2012-10-31T02:39:18.243
> 
> 标签：python, user-interface, mouseevent, pyqt4, global

我正在处理的一个小项目的一部分涉及“校准”要截屏的屏幕坐标。
通过“屏幕”，我指的是整个桌面，而不是我的 GUI 窗口。

当出现 QDialog 窗口（我已对其进行子类化）时，会校准坐标。
提示用户单击屏幕上的几个位置。
我需要该程序记录屏幕上任何地方发生的所有鼠标点击的位置 - 那些不会本地触发 QDialog mouseEvent 的位置，因为它们在此窗口之外。

显然覆盖 mouseEvent 方法不起作用，因为 QDialog 没有收到点击。

如何捕获全局鼠标单击，以便在单击屏幕的任何部分时触发事件并将其发送到 QDialog？

（我更喜欢基于 Qt 的解决方案，但如果需要，我可以向其他库开放）。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T05:21:25.000

有一些跨平台示例说明如何使用[http://pypi.python.org/pypi/autopy/0.51执行此操作](http://pypi.python.org/pypi/autopy/0.51)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T05:16:24.043

我假设这是不可能的，而是使用 pyHook，让 Qt 泵送消息。

# php - WHERE OR 子句无法正常运行

> ID：13150500
> 
> 赞同：3
> 
> 时间：2012-10-31T02:39:23.657
> 
> 标签：php, mysql, sql, codeigniter

我正在尝试选择具有某些 id 的类别，而 sql 查询的行为非常奇怪，请看一下：

```
 SELECT * FROM (`feeds`) WHERE  `cat_id` =1 OR 2 OR 3 LIMIT 0 , 30 
```

结果包括一个 cat_id 为 4 的项目，见这张图：

[![看这里](../Images/5aa8c34a6641ca6cde0b5707cbb56ad8.png)](https://i.stack.imgur.com/dW16Z.png)

我需要这个工作，脚本这样做：用户指定一个国家，脚本获取具有该国家 ID 的所有类别，然后脚本必须选择具有这些类别 ID 的所有提要。最后一部分是从前面的部分中获取包含所有提要 ID 的帖子。这就像一个新闻网站，提要是导入的 RSS 提要。任何帮助将不胜感激！顺便说一句，我正在为此使用 codeigniter。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-31T02:42:34.820

试试这个：

```
SELECT * FROM `feeds`
WHERE  `cat_id` in (1 ,2 , 3)
LIMIT 0 , 30 
```

你不能给

```
`cat_id` =1 OR 2 OR 3 
```

它应该是

```
`cat_id` =1 OR `cat_id` =2 OR `cat_id` =3 
```

或者

```
`cat_id` in (1,2,3) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:43:41.043

试试这个

```
SELECT * FROM (`feeds`) WHERE  `cat_id` =1 
OR `cat_id` =2  OR `cat_id` =3  LIMIT 0 , 30 
```

# jquery - 使用 JQUERY 禁用带有单选框的 tr

> ID：13150501
> 
> 赞同：0
> 
> 时间：2012-10-31T02:39:30.973
> 
> 标签：jquery

我有如下代码：

```
$(document).ready(function(){
        $(".trHide input:radio").attr('disabled',true);
     });
 <tr>
      <td><ul type="circle">
          <li>9\. Capacité à rendre compte</li>
        </ul></td>
      <td></td>
      <td><input class="validate[required] radio" type="radio" name="number9" value="1" <?php if($value['9.CapasityRendre'] == 1):?>checked='checked'<?php endif; ?>></td>
      <td><input class="validate[required] radio" name="number9" type="radio" value="2" <?php if($value['9.CapasityRendre'] == 2):?>checked='checked'<?php endif; ?>></td>
      <td><input class="validate[required] radio" name="number9" type="radio" value="3" <?php if($value['9.CapasityRendre'] == 3):?>checked='checked'<?php endif; ?>></td>
      <td><input class="validate[required] radio" name="number9" type="radio" value="4" <?php if($value['9.CapasityRendre'] == 4):?>checked='checked'<?php endif; ?>></td>
      <td><input class="validate[required] radio" name="number9" type="radio" value="5" <?php if($value['9.CapasityRendre'] == 5):?>checked='checked'<?php endif; ?>></td>
    </tr>
    <tr class="trHide">
      <td><ul type="circle">
          <li>10\. Capacité à faire des choix et à prendre des décisions</li>
        </ul></td>
      <td></td>
      <td><input class="validate[required] radio" type="radio" name="number10" value="1"<?php if($value['10.CapaciteFair'] == 1):?>checked='checked'<?php endif; ?>></td>
      <td><input class="validate[required] radio" name="number10" type="radio" value="2"<?php if($value['10.CapaciteFair'] == 2):?>checked='checked'<?php endif; ?>></td>
      <td><input class="validate[required] radio" name="number10" type="radio" value="3"<?php if($value['10.CapaciteFair'] == 3):?>checked='checked'<?php endif; ?>></td>
      <td><input class="validate[required] radio" name="number10" type="radio" value="4"<?php if($value['10.CapaciteFair'] == 4):?>checked='checked'<?php endif; ?>></td>
      <td><input class="validate[required] radio" name="number10" type="radio" value="5"<?php if($value['10.CapaciteFair'] == 5):?>checked='checked'<?php endif; ?>></td>
    </tr> 
```

**我需要：**

我想禁用 tag 中的所有单选框`<tr class="trHide">`。

**问题：**

它不起作用。我将如何解决这个问题？请任何人帮助我，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T04:17:11.987

尝试禁用而不是 true，如下所示

```
$(document).ready(function(){
    $(".trHide input:radio").attr('disabled','disabled');
}); 
```

# iphone - iPhone 的 facebook 连接按钮

> ID：13150503
> 
> 赞同：1
> 
> 时间：2012-10-31T02:40:04.017
> 
> 标签：iphone, ios, facebook

我正在使用 Facebook Connect 制作 iOS 应用程序。但我找不到“Facebook Connect 按钮”。我在哪里可以找到“Facebook Connect 按钮”？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:09:28.683

如果您的意思是“XCode XIB 编辑器中的 Facebook Connect 按钮在哪里？”，那么 XCode 中就没有 Facebook Connect 按钮。您必须使用[Facebook SDK](https://developers.facebook.com/ios/)来执行此操作。

*旁注：在谷歌上搜索，它在第一页上。是的，谷歌是你的朋友。真的。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T04:18:56.660

我假设您已经为 web 集成了 facebook connect，并且您正在搜索 fb-connect-button。

我过去也搜索过这个东西。您不能将 FBML 用于 ios。您将不得不使用“矩形按钮”和“fb-connect-button”图像作为其背景。@F. X 向您推荐的教程有足够的详细信息来说明如何实现身份验证和其他主要功能。

# bash - 从一些日志中 grep 一些表达式，并且只选择那些具有积极结果的表达式

> ID：13150510
> 
> 赞同：0
> 
> 时间：2012-10-31T02:40:50.123
> 
> 标签：bash, grep

我正在使用“zgrep”从一些 apache/nginx 日志中查找一些 ip，我需要一种方法来仅对正面结果进行排序。

我正在使用这个：

```
for i in `cat /var/tmp/list_of_ip.txt`; do
    zgrep -arcH $i /webstats/some_website/*/*.2012-10-1{7..9}* ;
done 
```

有很多日志文件。我只想知道哪些返回了积极的结果。

他们中的大多数会`0`在最后打印表明没有找到任何东西，有些会打印匹配的数量。如何仅选择那些并在文件中输出结果？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T04:11:13.027

您希望避免每个日志文件多次解压缩，因此您应该使用：

```
zgrep -l -F -f /var/tmp/list_of_ip.txt /webstats/some_website/*/*.2012-10-1{7..9}* 
```

这将解压日志文件一次，`grep`以`fgrep`模式 ( `-F`) 运行并从文件 ( ) 中读取要查找的单词列表（IP 地址）`-f /var/tmp/list_of_ip.txt`，并仅列出包含一个或多个匹配 IP 的文件的文件名地址 ( `-l`)。 `fgrep`mode 查找没有元字符的单词；如果您需要元字符，我认为您可以使用`grep -E`（带有`-f`选项）。您可以根据需要添加您的设置`-r`选项；`-arcH`在这种情况下，其他人是多余的。

正如选项所报告的，在 Mac OS X 10.7.5 上使用`zgrep (gzip) 1.3.12`和进行了一些临时测试。`grep (GNU grep) 2.5.1``--version`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T04:01:49.650

想我已经明白了..，只需在其中扔另一个`grep`文件，在它们的末尾包含“：0”的结果！

```
for i in `cat /var/tmp/list_of_ip.txt`
do zgrep -arcH $i /webstats/some_website/*/*.2012-10-1{7..9}* | grep -v :0$
done 
```

# git - 使用 chef 将部署的提交哈希写入文件

> ID：13150512
> 
> 赞同：1
> 
> 时间：2012-10-31T02:41:07.947
> 
> 标签：git, chef-infra

使用 Chef 将当前部署的提交哈希写入 version.txt 文件的最佳方法是什么，类似于 Etsy 的做法？这就是我想出的。

```
execute "update_version" do
   command git log -1 --format="%H" > public/version.txt
   creates "#{app_config['deploy_dir']}/current/public/version.txt"
   owner app_user
   group app_group
   action:run
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T11:04:27.677

```
 owner app_user
   group app_group 
```

可能不适用于执行资源 [http://wiki.opscode.com/display/chef/Resources#Resources-Execute](http://wiki.opscode.com/display/chef/Resources#Resources-Execute)

我可能会做类似的事情

```
bash "update_revision" do
   code "git log -1 --format="%H" > public/version.txt"
   creates "#{app_config['deploy_dir']}/current/public/version.txt"
end

file "public/version.txt" do
  owner app_user
  group app_group
  mode  0644
end 
```

或者，您可以创建一个包含类似内容的模板

```
<%= shell_out!('git log -1 --format="%H"') %> 
```

并使用类似的模板资源

```
template( "public/version.txt") do
      owner app_user
      group app_group
      mode  0644
end 
```

# button - 按返回按钮并重新加载

> ID：13150514
> 
> 赞同：0
> 
> 时间：2012-10-31T02:41:19.740
> 
> 标签：button, reload, back

是不可能加`window.location.reload()`的`window.history.go(-1)`吗？像这样

```
<input type="button" value="Back" onclick="window.history.go(-1), window.location.reload()"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T05:07:22.517

您不能一次触发 2 个浏览器事件，因此您需要输入逻辑。

火 window.location.reload()

然后在其上捕获事件并刷新页面的页面，这种情况基本上在您的主模板或公共 Js 文件中。您可以使用 Jquery 来实现这一点。

# php - 使用日期范围和复选框搜索 SQL

> ID：13150516
> 
> 赞同：0
> 
> 时间：2012-10-31T02:41:26.300
> 
> 标签：php, sql, search, checkbox

我一直在尝试开发一个代码，其中我有一个表单来根据日期范围和复选框状态搜索 SQL 表。

我已经制定了日期的搜索查询，但我无法使用复选框使其工作。我想在一次搜索中结合这两个功能，但我想不通。

例如：在“ **01/01/2012** ”和“ **12/31/2012** ”之间搜索，其中状态为“DONE! **(Checkbox=Checked)** ”。

这是我用来进行搜索的代码：

表格

```
<form method = "post" action = "<?php echo $_SERVER['PHP_SELF'];?>">
        <table>
            <tr>
                <td style="text-align:center; padding-top:15px;">
                    <span>From&nbsp:</span>
                    <input type = "date" name = "OLD">
                    To:
                    <input type = "date" name = "NEW">
                    Status:
                    <input type='checkbox' name='Status' value='DONE'/>
                </td>
            </tr>
            <tr>
                <td style="text-align:center; padding-top:15px;">
                    <button type = "submit" name = "search" value = "Search" class="button orange">Search</button>
                    <button type = "reset" value = "Clear" class="button orange">Reset</button>
                </td>   
            </tr>
        </table>
    </form> 
```

PHP的

```
<?php
    if(!isset($_POST['search']))
    {
    ?>

    <?php
    }
    else
    {
        $OLD = trim($_POST['from']);
        $NEW = trim($_POST['to']);

        $connection = mysql_pconnect("HOST", "USER", "PASS") or die("Connection failed. ".myslq_error());
        mysql_select_db("DATABASENAME") or die("Unable to select db. ".mysql_error());
        $query = "SELECT * FROM table WHERE Date >= '$OLD' AND Date <= '$NEW' ORDER BY date ASC";
        $result = mysql_query($query) or die(mysql_error());

        echo "<table class='table' id='SearchResult' cellspacing='0' cellpadding='0'>";
            echo "<tr class='rowa'><b>";
                echo "<td class='col1 cell'>Name</td>";
                echo "<td class='col2 cell'>Last Name</td>";
            echo "</tr>";
        echo "</table>";
        while($record = mysql_fetch_object($result))
        {   
        echo "<table class='table' id='SearchResult' cellspacing='0' cellpadding='0'>";
            echo "<tr class='rowb'>";
                echo "<td class='col1 cell'>".$record->Name."</td>";
                echo "<td class='col2 cell'>".$record->LastName."</td>";
            echo "</tr>";       
        echo "</table>";
        }       
    }
?> 
```

谁能带领我以正确的方式实现这一目标？！非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:19:51.890

你可以这样做：

```
else
{
    $OLD = trim($_POST['from']);
    $NEW = trim($_POST['to']);
    $status = isset($_POST['Status']) ? "AND status = 'DONE' " :"AND status = 'NOT DONE' ";

    $connection = mysql_pconnect("HOST", "USER", "PASS") or die("Connection failed. ".myslq_error());
    mysql_select_db("DATABASENAME") or die("Unable to select db. ".mysql_error());
    $query = "SELECT * FROM table WHERE Date >= '$OLD' AND Date <= '$NEW' ".$status."ORDER BY date ASC";
    $result = mysql_query($query) or die(mysql_error()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:21:49.690

我认为查询组合必须是这样的：

```
$query = "SELECT * FROM table WHERE 1 = 1 "
if ($_POST['MyCheckbox']=="checked")
  $query = $query . " and Date >= '$OLD' AND Date <= '$NEW' ORDER BY date ASC"; 
```

# javascript - div 滑块反向

> ID：13150518
> 
> 赞同：1
> 
> 时间：2012-10-31T02:41:33.143
> 
> 标签：javascript, jquery

这是 divslider 示例的链接：http: [//jsfiddle.net/jtbowden/ykbgT/light/](http://jsfiddle.net/jtbowden/ykbgT/light/)

但是在这个例子中，div是从右向左移动的

但我现在想将 div 从左移到右.. 这个网站里面已经有一个编辑器。所以请帮我反向移动div。因为在我的代码上我想去两边

```
$('.box').click(function() {
    $('.box').each(function() {
        if ($(this).offset().left < 0) {
            $(this).css("left", "150%");
        } else if ($(this).offset().left > $('#container').width()) {
            $(this).animate({
                left: '50%',
            }, 500 );
        } else {
            $(this).animate({
                left: '-150%',
            }, 500 );
        }
    });
});​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:19:47.333

这是对我的 JS Fiddle 有用的方法：

```
$('.box').click(function() {
    $('.box').each(function() {
        if ($(this).offset().left < 0) {
           $(this).animate({
                left: '50%',
            }, 500 );
        } else if ($(this).offset().left > $('#container').width()) {
            $(this).css({
                'left': '-150%',
            } );
        } else {
            $(this).animate({
                left: '150%',
            }, 500 );
        }
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T04:20:47.413

你是这个意思吗？

```
#box1 {
    background-color: green;
    left: 150%; /* changed this */
}
#box3 {
    background-color: red;
    left: -150%; /* changed this */
}
​ 
```

和

```
$('.box').click(function() {
    $('.box').each(function() {
        if ($(this).offset().left > $('#container').width()) {
            $(this).css("left", "-150%");
        } else if ($(this).offset().left < 0) {
            $(this).animate({left:'50%'},500);
        } else {
            $(this).animate({left:'150%'},500);
        }
    });
});​ 
```

# python - 索引超出范围错误Python贪婪方法

> ID：13150520
> 
> 赞同：0
> 
> 时间：2012-10-31T02:41:43.703
> 
> 标签：python, indexing, greedy, outofrangeexception

您好，我目前从以下代码中收到索引超出范围错误：（我将先发布代码，然后再发布错误）

# 主文件：

```
import Knapsack_Test

size = 10
W = 2*size
knapsack = Knapsack_Test.Knapsack_Test()

for i in range(1, 10):   

    knapsack.greedy_knapsack_test(size, W)  

    size = size + 10*i
    W = 2*size 
```

# 类文件（仅贪心函数）：

```
def greedy_knap(self, v, w, W):

    knap_array = []

    for i in range(1, len(v)):
        #The index out of range error occurs here:
        knap_array[i] = [v[i],w[i]] 

    sort_order = self.sort.merge_sort(knap_array)

    weight = 0
    value = 0

    knap_sac= []

    n = len(knap_array)
    j = 0
    profit = 0
    while weight < W and j < n:

        if weight + knap_array[i][1] <= W:

            knap_sac.append(knap_array[i])
            weight = weight + knap_array[i][1]
            profit = profit + knap_array[i][0]

        j = j + 1

    return profit 
```

# 测试文件（贪心函数）：

```
def greedy_knapsack_test(self, size, W):
    v = []
    w = []
    for i in range(1,size):
        v.append(random.randint(1,1000))
    for i in range(1,size):
        w.append(random.randint(1,1000))
    start = time.time()
    self.knapsack.greedy_knap(v, w, W)
    end = time.time() - start
    return end 
```

# 错误：

```
Traceback (most recent call last):
  File "\\minerfiles.mst.edu\dfs\users\asadmb\Desktop\Programming 3\Knapsack_Main.py", line 10, in <module>
    knapsack.greedy_knapsack_test(size, W)
  File "\\minerfiles.mst.edu\dfs\users\asadmb\Desktop\Programming 3\Knapsack_Test.py", line 31, in greedy_knapsack_test
    self.knapsack.greedy_knap(v, w, W)
  File "\\minerfiles.mst.edu\dfs\users\asadmb\Desktop\Programming 3\KnapsackClass.py", line 30, in greedy_knap
    knap_array[i] = [v[i],w[i]]
IndexError: list assignment index out of range 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:50:24.280

```
knap_array = []

for i in range(1, len(v)): #The index out of range error occurs here:
    knap_array.append([v[i],w[i]]) 
```

您不能通过引用它们来创建列表元素。

# android - 向 Django 后端验证 Android 或 iPhone 应用程序

> ID：13150521
> 
> 赞同：6
> 
> 时间：2012-10-31T02:42:07.413
> 
> 标签：android, iphone, ios, django, django-authentication

我有一个用 Django 构建的 webapp。它可以很好地在网络上使用，但现在我正在构建一个 Android 应用程序。我不确定如何安全地对 Django 后端的 Android 应用程序进行身份验证。

这个 webapp 有用户配置文件。用户可以使用 Web 界面注册/登录/注销。的相关部分`urls.py`如下所示：

```
urlpatterns += patterns('',
  url(r'^accounts/login/$', 'django.contrib.auth.views.login', name='login'),
  url(r'^accounts/logout/$', 'django.contrib.auth.views.logout', name="logout"),
) 
```

我的理解是，在用户成功完成后`accounts/login`，浏览器上会存放一些 cookie，用于其余的连接。这个对吗？

在 Android 设备上，给定用户名和密码，向 Django 后端验证用户身份的正确或最佳方式是什么？我需要像在浏览器中一样获取 cookie 还是有更好的方法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-31T15:23:55.780

有几种方法可以进行身份​​验证，但使用现有的 Django 会话支持和它使用的 cookie 可能是最好的方法。

当您连接到启用了[会话中间件](https://docs.djangoproject.com/en/1.4/topics/http/sessions/)（您需要登录）的 Django 页面时，它将设置一个会话 cookie（通常称为“sessionid”，尽管[您可以自定义它](https://docs.djangoproject.com/en/1.4/topics/http/sessions/#session-cookie-name)）。登录状态的用户（未登录）存储在服务器端由该会话 ID 链接的会话中（除非您使用的是[基于 cookie 的会话](https://docs.djangoproject.com/en/dev/topics/http/sessions/#using-cookie-based-sessions)，但这是另一个帖子的项目）。

因此，您的 Android 应用只需获取登录页面，取出 sessionid（和[csrftoken](https://docs.djangoproject.com/en/dev/ref/contrib/csrf/)）cookie，然后使用用户名、密码、sessionid 和 csrftoken 发布帖子。

这是最简单的方法。还有更复杂的选项，主要涉及制作一个返回 JSON 的自定义视图，并且通常开始为您的移动应用程序提供一个 API，而不是让它们假装它们是浏览器，但这在 Django 方面有点复杂。

# c - 打印内容链表

> ID：13150525
> 
> 赞同：1
> 
> 时间：2012-10-31T02:42:24.850
> 
> 标签：c

我知道如何打印列表的信息，但我的文件内容出现倒置！

```
void imprimi_tabuleiro(Tabuleiro* tabu)
{
    Tabuleiro* aux; // p auxiliar a prcorrer o tabuleiro
    for (aux = tabu; aux != NULL ; aux = aux ->Prox)
    {
        printf("\n%s %s %s %d\n ", aux ->casa , aux ->proxcasa , aux ->regracasa , aux ->energia);
    }
} 
```

例如我的文件是：

```
1 2 0 0

3 4 5 7

1 9 0 4

```

当我运行代码时出现

```
1 9 0 4

3 4 5 7

1 2 0 0

```

我该如何改变呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T06:48:00.923

原因可能是您有一个单一的链表，当您将条目添加到列表时，您将它们添加到列表的*头部*。

一个解决方案是跟踪列表的尾部，然后添加到那里。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T06:50:49.487

即使您似乎有一个双向链表，但看起来您是在前面插入条目，而不是在列表的尾部。这肯定会解释反向排序。

你能展示你的阅读和插入代码吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T13:55:12.907

我知道了 ！

```
abuleiro* inserir_tabuleiro(Tabuleiro* Tab, char casa[] , char proxcasa[] , char regracasa[], int energia) 
```

{

```
Tabuleiro* Novo  = cria(casa , proxcasa ,  regracasa,  energia); //cria novo no

Tabuleiro* anterior = NULL; //ponteiro p o anterior
Tabuleiro* p= Tab; // p percorrer

while(p!=NULL ){

            anterior = p ;
            p = p->Prox;

}

if(anterior==NULL)
{
    Novo->Prox = Tab;

    Tab = Novo;
}
else
{
    Novo->Prox = anterior->Prox;
    anterior->Prox = Novo;
}

return Tab; 
```

}

谢谢大家！！

# python - 如何使用python正确读取和修改文件

> ID：13150529
> 
> 赞同：1
> 
> 时间：2012-10-31T02:42:39.513
> 
> 标签：python, string, text, file-io

我正在尝试从文件中删除所有（非空格）空白字符并用逗号替换所有空格。这是我当前的代码：

```
def file_get_contents(filename):
  with open(filename) as f:
    return f.read()

content = file_get_contents('file.txt')
content = content.split
content = str(content).replace(' ',',')
with open ('file.txt', 'w') as f:
  f.write(content) 
```

当它运行时，它将文件的内容替换为：

```
<built-in,method,split,of,str,object,at,0x100894200> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T02:52:09.157

您遇到的主要问题是您将方法分配`content.split`给内容，而不是调用它并分配其返回值。如果您`content`在该分配之后打印出来，它将是：`<built-in method split of str object at 0x100894200>`这不是您想要的。通过添加括号来修复它，使其成为方法的调用，而不仅仅是对它的引用：

```
content = content.split() 
```

我想你在解决这个问题后可能仍然有问题。`str.split`返回一个列表，然后您将使用它调整回字符串`str`（在尝试用逗号替换空格之前）。这会给你方括号和引号，你可能不想要，而且你会得到一堆额外的逗号。相反，我建议使用这样的`str.join`方法：

```
content = ",".join(content) # joins all members of the list with commas 
```

我不确定这是否是你想要的。using`split`将替换文件中的所有换行符，因此您最终将得到一行，其中包含许多用逗号分隔的单词。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:51:56.737

拆分内容时，忘记调用该函数。此外，一旦你拆分，它就是一个数组，所以你应该循环替换东西。

```
def file_get_contents(filename):
  with open(filename) as f:
    return f.read()

content = file_get_contents('file.txt')
content = content.split() <- HERE
content = [c.replace(' ',',') for c in content]
content = "".join(content)
with open ('file.txt', 'w') as f:
  f.write(content) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T03:49:54.463

如果您正在寻找替换字符，我认为您最好使用 python 的 re 模块进行正则表达式。示例代码如下：

```
import re

def file_get_contents(filename):
  with open(filename) as f:
    return f.read()

if __name__=='__main__':
    content = file_get_contents('file.txt')
    # First replace any spaces with commas, then remove any other whitespace
    new_content = re.sub('\s', '', re.sub(' ', ',', content))
    with open ('new_file.txt', 'w') as f:
      f.write(new_content) 
```

它比一直尝试拆分更简洁，并为您提供更多灵活性。还要注意您使用代码打开和读取的文件有多大 - 您可能需要考虑使用行迭代器或其他东西，而不是一次读取所有文件内容

# java - java - 获取在线的用户名列表

> ID：13150535
> 
> 赞同：1
> 
> 时间：2012-10-31T02:42:57.877
> 
> 标签：java, session, servlets

我想在线获取用户列表。在链接[http://viralpatel.net/blogs/jsp-servlet-session-listener-tutorial-example-in-eclipse-tomcat/](http://viralpatel.net/blogs/jsp-servlet-session-listener-tutorial-example-in-eclipse-tomcat/)中，我可以看到用于获取在线用户数量的代码。

我想我需要一个 ArrayList 来获取并存储 sessionCreated(HttpSessionEvent event) 中的用户名，然后显示这个列表。

请建议这是否是正确的方法，或者是否有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:00:37.997

您应该创建一个类似于以下内容的新侦听器：

```
import javax.servlet.http.HttpSessionEvent;
import javax.servlet.http.HttpSessionListener;
import javax.servlet.http.HttpSession;
import java.util.List;
import java.util.ArrayList;

public class SessionCounter implements HttpSessionListener {
    private List sessions = new ArrayList();

public SessionCounter() {
}

public void sessionCreated(HttpSessionEvent event) {
    HttpSession session = event.getSession();
    sessions.add(session.getId());

    session.setAttribute("counter", this);
}

public void sessionDestroyed(HttpSessionEvent event) {
    HttpSession session = event.getSession();
    sessions.remove(session.getId());

    session.setAttribute("counter", this);
}

public int getActiveSessionNumber() {
    return sessions.size();
}
} 
```

之后，您将此类添加到 web.xml

```
<web-app>
    <listener>
        <listener-class>
           SessionCounter
        </listener-class>
    </listener>
</web-app> 
```

现在，当您可以计算没有活跃用户时：

```
 SessionCounter counter = (SessionCounter) session.getAttribute("counter");
 counter.getActiveSessionNumber() 
```

# java - 显式删除 JPA 关系

> ID：13150537
> 
> 赞同：2
> 
> 时间：2012-10-31T02:43:06.313
> 
> 标签：java, jpa, eclipselink, ejb-3.1

我对在 JPA 中管理关系有点困惑。基本上我有两个具有一对多关系的实体

一个配置可以有一个或多个与之关联的电子邮件列表。

```
@Entity
public class Config {
    @OneToMany(mappedBy="owner",cascade=CascadeType.ALL, fetch=FetchType.EAGER)
    private List<Email> emailReceivers;
}
@Entity
public class Email {
    @ManyToOne
    private Config owner;
} 
```

在 EJB 和更新/合并操作期间，我将编辑与配置关联的电子邮件列表，我认为我不需要在我的电子邮件实体上显式调用删除操作，我只需通过删除电子邮件来管理关系我的配置电子邮件列表。

```
@Stateless
public class ConfigFacadeImpl implements ConfigFacade{
    @EJB
    private ConfigDao configDao;
    @EJB
    private EmailDao emailDao;

    @Override
    public void update(Config Config, List<Email> emailsForDelete) {
        if(emailsForDelete!=null && emailsForDelete.size() > 0){
            for(Email emailTemp: emailsForDelete){
                Email email = emailDao.find(emailTemp.getId());
                emailDao.delete(email);  // Do I need to explicitly call the remove??
                config.getEmailReceivers().remove(email);
            }
        }
        configDao.update(config);
    }
} 
```

如果我不执行删除并且只从列表中删除它，它不会删除我的表格行。

UI 和数据库现在不同步，因为 UI 不会显示我已删除的电子邮件，但是当您检查数据库时，行仍然存在。

是必需的吗？如果我只是在我的实体中删除它，我认为 JPA 会为我处理这个问题。

**更新**

在进行任何更改之前，我已经调整了我的代码以首先从数据库中获取实体，但它仍然没有删除我的子电子邮件实体。我想知道这是否是 apache derby 问题。（这是正确的方法，因为我将我的实体从我的 JSF 托管 bean 传递到我的 EJB 中，所以我需要先从数据库中获取同步。）

```
@Override
public void update(Config config, List<Email> emailsForDelete) {
    Config configTemp = configDao.find(config.getId());
    if(emailsForDelete!=null && emailsForDelete.size() > 0){
        for(Email emailTemp: emailsForDelete){
            configTemp.getEmailReceivers().remove(emailTemp);
        }
    }
    configDao.update(config);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:52:47.253

由于您已经定义了 cascade type = `CascadeType.ALL`，因此 JPA 应该负责删除。`Explicit Delete`声明**不是必需**的。

这两个语句不是必需的：

```
 Email email = emailDao.find(emailTemp.getId());
     emailDao.delete(email);  // Do I need to explicitly call the remove?? 
```

相反，您可能只想在其中找到匹配项`emailReceiver`并`config.getEmailReceivers()`删除匹配`EmailReceivers`项。无需`Email`从数据库加载实体。

编辑：要删除孤立对象，您可能需要包含`CascadeType.DELETE_ORPHAN`级联属性以及`CascadeType.ALL`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T12:45:12.390

[这与为什么合并不是在一对多关系上级](https://stackoverflow.com/questions/13153237/why-merging-is-not-cascaded-on-a-one-to-many-relationship/13158129#13158129)联中的问题相同

基本上，JPA 只能级联您集合中的实体。因此，从集合中删除的子对象的更改永远不会放入上下文中，因此不能推送到数据库中。在这种情况下，oneToMany 由多音返回指针控制，因此除非子元素也被合并，否则即使集合更改也不会显示。一旦从树中修剪出一个子节点，就需要单独管理和合并它，以便获取对它的更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-09T22:51:40.423

使用 JPA 2.0，您可以在父实体中使用选项 orphanRemoval=true

例子：

```
@Entity
public class Parent {
    ...

    @OneToMany(mappedBy="parentId",cascade=CascadeType.ALL, orphanRemoval=true)
    private List<Child> childList;
    ...

} 
```

# javascript - jQuery html5 标签更改为 div

> ID：13150538
> 
> 赞同：-1
> 
> 时间：2012-10-31T02:43:11.993
> 
> 标签：javascript, jquery

如何更改`<footer id="tt"></footer>`使用`<div id='tt'></div>`jQuery 有没有办法轻松更改标签？非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:46:28.637

您可以使用`replaceWith`方法：

```
$('#tt').replaceWith(function(){
   return '<div id="' + this.id + '"></div>'
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:47:08.513

您可以使用`replaceWith()`

```
var $foot=$('#tt'), html=$foot.html();

$foot.replaceWith( $('<div id="tt">').append(html) ) 
```

# symfony - 这条 Symfony2 路线有什么问题？

> ID：13150543
> 
> 赞同：1
> 
> 时间：2012-10-31T02:43:49.733
> 
> 标签：symfony, routing

我已经使用注释设置了一条路线。在我看来是对的，Symfony2 说这是错误的。这是路线：

```
@Route("/news/{id}/{slug}", name="newsarticle") 
```

这是我认为与路线匹配的示例 URL：

> [http://somesite.com/news/202/my-news-title](http://somesite.com/news/202/my-news-title)

这是功能骨架：

```
public function newsArticleAction($id, $slug)
{

} 
```

我在这里想念什么？我收到 500 错误，日志显示：

> [2012-10-30 20:36:35] request.INFO：匹配路由“newsarticle”（参数：“_controller”：“App\SiteBundle\Controller\DefaultController::newsArticleAction”，“id”：“202”，“ slug": "my-news-title", "_route": "newsarticle") [] [] [2012-10-30 20:36:36] app.INFO: From listener: The "newsarticle" route has some missing强制参数（“id”）。[] [] [2012-10-30 20:36:36] request.CRITICAL：Symfony\Component\Routing\Exception\MissingMandatoryParametersException：“newsarticle”路由缺少一些强制参数（“id”）。（未捕获的异常）在 /home/user/app/cache/prod/classes.php 第 676 行 [] []

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-31T09:48:51.303

此错误*不是*在将 URL 与路由匹配时出现，而是在从路由生成 URL 时出现。

在您的项目中搜索`path('newsarticle'`或`generateUrl('newsarticle'`。您应该尝试在不传递所有需要的参数的情况下生成 URL — 类似于：

```
{{ path('newsarticle', {'slug': news.slug} }} 
```

虽然它必须看起来像：

```
{{ path('newsarticle', {'id': news.id, 'slug': news.slug} }} 
```

# asp.net-mvc-3 - 多租户 MVC 应用程序中的自定义 RoleProvider

> ID：13150548
> 
> 赞同：0
> 
> 时间：2012-10-31T02:44:17.200
> 
> 标签：asp.net-mvc-3, multi-tenant, roleprovider

我需要为 MultiTenant Web 应用程序开发自定义 RoleProvider。在数据库级别，我们有一个将用户与角色与租户相关联的表。

![在此处输入图像描述](../Images/ceeb17582c8d42e67135ffebc5057b65.png)

我的问题是 RoleProvider 获取用户角色只是将用户作为参数传递，我们需要考虑租户。

在 RoleProvider 实现中，我们有：

```
public override string[] GetRolesForUser(string username)
{
    //Code to retrieve roles from repo
} 
```

由于角色适用于特定租户中的用户，我们需要：

```
public override string[] GetRolesForUser(string username, int tenantId)
{
    //Code to retrieve roles from repo
} 
```

当前租户存储在 ControllerBase 类中（所有控制器都继承自该类）。

Membership 和 Role Providers 在一个单独的项目中，所以我看不到使用当前租户的方法。我想我可以在 web 应用程序项目中创建我的自定义 RoleProvider。

关于如何实现将租户作为输入的一部分的 RoleProvider 接口的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T15:54:25.930

好吧，只是为了告诉你我在我的情况下做了什么：

由于我们的路线是 `http://[tenantName].[domain]/[App]/[Area]`我们最终`[tenantName]`从请求中获取的形式，因为它是唯一的，并且使用租户和`UserName`作为参数的那个，我可以在我们的`UsersInTenants'`表上进行选择。

使用 cookie 作为传递附加信息的一种方式也可以做到这一点。

因此，您可以使用 cookie 访问请求，但是对于我研究的内容，在大多数情况下，会话尚未初始化。

希望能帮助到你！

# javascript - 如何打开 Web Socket？

> ID：13150549
> 
> 赞同：1
> 
> 时间：2012-10-31T02:44:32.037
> 
> 标签：javascript, jquery, websocket

我正在尝试打开一个套接字-> PHP 页面以从中获取数据，但我不确定如何打开它：

```
var socket = new WebSocket("ws://myurl.com/sockets/socket.php");  

if(socket.onopen)
    alert("Open");
else
    alert("Not Open"); 
```

我在我的索引中链接了最新版本的 jQuery（在此脚本的链接上方），我的 PHP 文件中没有任何内容 - 只是为了看看我是否可以打开连接。我错过了什么或做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T03:02:07.403

WebSockets 需要服务器上的协议支持；具体来说，支持带有 WebSockets 安全标头的 HTTP 升级握手。简单地将 WebSocket 指向 PHP 脚本是行不通的，因为 PHP 脚本使用 HTTP，而 WebSocket 不是 HTTP——它是一种完全不同的协议（尽管它基于 HTTP）。

如果你想在 PHP 中使用 WebSockets，你需要使用一个[专门的](http://socketo.me/) [库](https://github.com/nicokaiser/php-websocket) [来实现](https://github.com/varspool/Wrench)WebSockets 协议（我没有使用这些；它们只是[谷歌的第一个结果](https://www.google.com/search?q=php+websocket)）。

当然，Apache 和 PHP 并不是实时工作的最佳工具。我会使用 Node（以及出色的[socket.io](http://socket.io)包），它旨在处理大量并发、持久的连接。

# iphone - 根据选择的 TableView 单元格加载数据

> ID：13150550
> 
> 赞同：0
> 
> 时间：2012-10-31T02:44:34.937
> 
> 标签：iphone, ios, xcode

我有一个表格视图。我希望我的应用能够像 iPhone 上的“通讯录”应用一样工作。当您在应用程序中选择一个人时，它会转到一个包含用户名和电话号码的视图。选择哪个单元格无关紧要，它总是进入相同的视图，但数据不同。我怎样才能达到同样的目的？**我想要一个视图控制器，并且我希望每个单元格将某些数据加载到呈现的视图控制器上**！我想使用 NSUserDefaults （如果可能的话）。任何帮助都会很棒，谢谢！

PS我知道这是一个广泛的问题，但我不确定在哪里可以找到我搜索过的答案。再次感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T04:50:47.893

您创建一个名称（字符串）数组并在表格视图中显示这些名称。然后，一旦选择了名称，您就可以将其作为字符串保存在 NSUserDefaults 中。

```
- (void) tableView: (UITableView *) tableView didSelectRowAtIndexPath: (NSIndexPath *) indexPath
{
     NSString *selectedString = [namesArray objectAtIndex:[indexPath row]];
     NSUserDefaults *infoSaved = [NSUserDefaults standardUserDefaults];
     [infoSaved setObject:selectedString forKey:@"theName"];
     [infoSaved synchronize];
     [self performSegueWithIdentifier:@"segueToMoreInfo" sender:self];
} 
```

然后在您的第二个视图控制器中，您从包含 NSDictionary 项的 NSDictionary 加载信息。

```
-(void) loadData {
     NSUserDefaults *infoSaved = [NSUserDefaults standardUserDefaults];
     NSString *theName = [infoSaved objectForKey:@"theName"];
     NSDictionary *currentNameToDisplay = [itemsDictionary objectForKey:theName];
     // then you can set your labels with information in that NSDictionary item
     [nameLabel setString:[currentNameToDisplay objectForKey:@"userName"];
     [ageLabel  setString:[currentNameToDisplay objectForKey:@"userAge];
} 
```

那将是一个简单的基本结构。您可以将包含项目的主要名称 NSDictionary 保存到 plist 文件中，或者更好地将字典保存在 NSUserDefaults 中。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T02:53:11.230

> 我想要一个视图控制器，并且我希望每个单元格将某些数据加载到呈现的视图控制器上！

没问题。用户点击单元格，您的表的代表会收到一条`-tableView:didSelectRowAtIndexPath:`消息。假设表的委托和数据源都是管理表的视图控制器（因为这是一个非常常见的设置）。因此视图控制器查看单元格的索引路径，从它保存其数据的任何位置获取相关数据，使用连接到点击单元格的数据实例化详细视图控制器，然后推送它。

您可能缺少的部分是存储表中显示的数据的某种模型。表的视图控制器需要了解模型，因为它是表的数据源。它已经需要知道在哪里可以找到足够的数据来配置表格中的每个单元格。如果您使用相同的模型来存储详细数据，您将能够使用它来配置详细视图控制器。

**示例：**假设您有一张只有一个部分的表格。该表的简单模型可以是字典数组。当您的表格视图控制器需要填充单元格时，它使用`row`索引路径的索引作为数组的索引来获取字典，并使用它来设置单元格。当用户点击一个单元格时会发生完全相同的事情：您使用`row`从索引路径从数组中获取正确的字典，然后使用它来设置详细视图控制器。你甚至可以将整个字典传递给细节视图控制器，让细节视图控制器得到它需要的东西。这样，表格视图控制器就不必担心详细视图控制器显示的具体细节。

# python - 为什么我的代码会打印其他字符？密码

> ID：13150551
> 
> 赞同：2
> 
> 时间：2012-10-31T02:44:56.493
> 
> 标签：python

我只想打印字母，但它会打印 ASCII 的特殊字符。我的代码：

```
import string
def caesar(shift):
    alphabet = string.ascii_lowercase + string.ascii_uppercase
    dict={}
    emptylist=[]
    int(shift)
    for x in alphabet:
        emptylist.append(x)
        code = ""
        for letters in emptylist:
            code = chr(ord(letters) + shift)
            dict[letters]=code
    return dict
caesar(12) 
```

我的输出：

> 'm': 'y', 'l': 'x', 'o': '{', 'n': 'z', 'q': '}', 'p': '|', 's ': '\x7f', 'r': '~', 'u': '\x81', 't': '\x80', 'w': '\x83', 'v': '\x82' , 'y': '\x85', 'x': '\x84', 'z': '\x86'

正确的输出：

> 'm'：'y'，'l'：'x'，'o'：'a'，'n'：'z'，'q'：'c'，'p'：'b'，'s '：'e'，'r'：'d'，'u'：'g'，'t'：'f'，'w'：'i'，'v'：'h'，'y'： 'k'，'x'：'j'，'z'：'l'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T02:52:42.697

使用`ord()`和更改字符代码不会将生成的字符限制在您的字典中。

我只是在你的字典中找到字母的索引，移动它，然后使用模运算符：

```
import string

def caesar(shift):
    alphabet = string.ascii_uppercase  # <- Change it back to what you had before
                                       #    and see what will happen.
    mapping = {}

    for letter in alphabet:
        index = alphabet.index(letter)
        mapping[letter] = alphabet[(index + shift) % len(alphabet)]

    return mapping 
```

测试（字典不保留顺序，因此很难阅读）：

```
>>> caesar(12)
{'A': 'M', 'C': 'O', 'B': 'N', 'E': 'Q', 'D': 'P', 'G': 'S', 'F': 'R', 'I': 'U', 'H': 'T', 'K': 'W', 'J': 'V', 'M': 'Y', 'L': 'X', 'O': 'A', 'N': 'Z', 'Q': 'C', 'P': 'B', 'S': 'E', 'R': 'D', 'U': 'G', 'T': 'F', 'W': 'I', 'V': 'H', 'Y': 'K', 'X': 'J', 'Z': 'L'} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-31T02:55:41.957

让我们特别看一个错误：`o: '{'`.

注意`ord('o')`是 111，所以让我们看一下 中`chr`的整数`range(111,130)`：

从 开始`o`，移动 12 位，将您带到`{`角色：

```
In [75]: ' '.join([chr(x) for x in range(111,130)])
Out[75]: 'o p q r s t u v w x y z { | } ~ \x7f \x80 \x81'
          ^ 1 2 3 4 5 6 7 8 9 ...12 
```

所以你得到不正确输出的原因是因为你的公式

```
code = chr(ord(letters) + shift) 
```

没有考虑到如果班次将您从与`a-z`or相关联的顺序中反弹出来会发生什么`A-Z`。（请注意， 和 的 ord 范围`a-z`也不`A-Z`连续！）

* * *

以下是有关如何修复的提示：

```
In [82]: alphabet = string.ascii_lowercase + string.ascii_uppercase

In [83]: alphabet.index('o')
Out[83]: 14

In [84]: alphabet[alphabet.index('o')+12]
Out[84]: 'A' 
```

但

```
In [85]: alphabet[alphabet.index('O')+12] 
```

结果`IndexError: string index out of range`。那是因为`len(alphabet)`是 52，并且

```
In [91]: alphabet.index('O')+12
Out[91]: 52 
```

不知何故，我们需要 52 回绕到 0。您可以使用[`%`模运算符](http://docs.python.org/2/reference/expressions.html#binary-arithmetic-operations)来做到这一点：

```
In [92]: 52 % 52
Out[92]: 0 
```

# php - mysql_real_escape_string 和 strip_slashes 问题

> ID：13150552
> 
> 赞同：0
> 
> 时间：2012-10-31T02:45:00.240
> 
> 标签：php, mysql

我`$_POST`通过 PHP 将表单导入到 MYSQL DB 中，其中包含像“O'Hara”这样的撇号，然后我得到斜杠。我知道 mysql_real_escape_string 使用斜杠来防止这样的事情，但是我如何检查带有撇号的字符串的数据库？

例子：

```
$name = mysql_real_escape_string(stripslashes($_POST['full_name']));
$check = mysql_query("SELECT * FROM `stadiums` WHERE `stadium_name` LIKE '%$name%' LIMIT 0, 10") or die(mysql_error()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:48:12.980

尝试

```
$name = $_POST['full_name'];
if (get_magic_quotes_gpc()) {
  $name = stripslashes($name);
}
$name = mysql_real_escape_string($name);
$check = mysql_query("SELECT * FROM `stadiums` 
  WHERE `stadium_name` LIKE '%$name%' LIMIT 0, 10") or die(mysql_error()); 
```

`stripslashes`仅在[`magic quotes`](http://php.net/manual/en/security.magicquotes.php)启用时用于输入。

# c++ - 如何将二进制数据文件中的信息读入结构数组 C++

> ID：13150553
> 
> 赞同：1
> 
> 时间：2012-10-31T02:45:05.227
> 
> 标签：c++, arrays, structure

我是 C++ 初学者。我有一个保存员工信息的结构数组。我可以将值放入结构中，将这些值写入二进制 dat 文件，然后将值读回程序中，以便将其显示到控制台。这是我的问题。关闭程序后，我无法获取文件以将文件中的数据读回内存 - 而是读取“垃圾”。

我尝试了一些事情，然后在我的书中读到了这个：

> **注意**：包含指针的结构不能使用本节的技术正确存储到磁盘。这是因为如果在程序的后续运行中将该结构读入内存，则不能保证所有程序变量都位于相同的内存位置。

我很确定当我尝试打开具有先前存储的信息的 .dat 文件并尝试将其读入结构数组时，会发生这种情况。

如果这有助于澄清我的问题，我可以发送我的代码示例。任何建议，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:28:40.370

一般来说（因为我没有你的代码）有两个原因你通常不应该只将结构或类的字节写入文件：

*   正如你的书所提到的，写一个指向磁盘的指针是没有意义的，因为你只是存储一个随机地址而不是那个地址的数据。您需要写出数据本身。

*   您*尤其*不应该尝试使用类似 `fwrite(file, myStruct, sizeof(myStruct))`. 编译器有时会在结构中的变量之间放置空字节，以便让处理器更快地读取它们 - 这称为[填充](http://en.wikipedia.org/wiki/Data_padding)。使用不同的编译器或为不同的计算机体系结构编译可能会以不同的方式填充结构，因此在一台计算机上正确打开的文件可能无法在另一台计算机上正确打开。

有很多方法可以将数据写入文件，可以是二进制格式，也可以是 XML 等人类可读的格式。无论您选择使用哪种方法（每种方法都有优点和缺点），它们中的每一种都涉及将您关心的每条数据一个一个地写入保存，然后将它们一个一个地读回。Java 或 C# 等高级语言可以通过存储有关对象的元数据来自动执行此操作，但这是以更多的内存使用和更慢的程序执行为代价的。

# php - 无法在控制台中运行 PHP 文件

> ID：13150555
> 
> 赞同：0
> 
> 时间：2012-10-31T02:45:29.680
> 
> 标签：php

使用命令：

```
$output = shell_exec("/usr/bin/php /path/to/my/file.php");
echo $output; 
```

得到这个结果：

```
 string(1208) "Content-type: text/html string(1165) "Content-type: text/html string(1122) "Content-type: text/html string(1079) "Content-type: text/html string(1036) "Content-type: text/html string(994) "Content-type: text/html string(952) "Content-type: text/html string(910) "Content-type: text/html string(868) "Content-type: text/html string(826) "Content-type: text/html string(784) "Content-type: text/html string(742) "Content-type: text/html string(700) "Content-type: text/html string(658) "Content-type: text/html string(616) "Content-type: text/html string(574) "Content-type: text/html string(532) "Content-type: text/html string(490) "Content-type: text/html string(448) "Content-type: text/html string(406) "Content-type: text/html string(364) "Content-type: text/html string(322) "Content-type: text/html string(280) "Content-type: text/html
Warning: shell_exec() [function.shell-exec]: Unable to execute '/usr/bin/php /home/zumblemo/public_html/ad/../test.php' in /home/zumblemo/public_html/ad/test.php on line 5
bool(false) " " " " " " " " " " " " " " 
```

它现在应该只输出单词“Test”。
我不明白。当我像这样启动 Python 文件时，它可以工作。
托管支持说这同样适用于 PHP 文件。

路径是 100% 正确的（当它们不正确时 - 它只是给出 NULL 结果，就像它应该的那样）

PS：太好了！php-cli 工作。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T02:55:33.960

看起来您的脚本正在递归调用自身，直到达到递归限制。看起来 php 可能是 php-cgi 的符号链接。尝试调用 php-cli。

# c# - python和c#函数中结果的区别

> ID：13150557
> 
> 赞同：0
> 
> 时间：2012-10-31T02:45:49.620
> 
> 标签：c#, python, raspberry-pi

我正在使用 C#/Mono 和 Python 玩 Raspberry Pi。我目前正在将一些代码从 Python 转换为 C#，并且返回的值不同。

当调整电位器并重复采样这些函数时，我在 Python 中得到 0-1023，在 C# 中得到 0-2047。

造成这种差异的原因是什么？我对 Python 非常陌生。

在 python 中，此函数产生一个介于 0 和 1023 之间的值（调整电位计时）。

```
def readadc(adcnum, clockpin, mosipin, misopin, cspin):
    if ((adcnum > 7) or (adcnum < 0)):
            return -1
    GPIO.output(cspin, True)

    GPIO.output(clockpin, False)  # start clock low
    GPIO.output(cspin, False)     # bring CS low

    commandout = adcnum
    commandout |= 0x18  # start bit + single-ended bit
    commandout <<= 3    # we only need to send 5 bits here
    for i in range(5):
            if (commandout & 0x80):
                    GPIO.output(mosipin, True)
            else:
                    GPIO.output(mosipin, False)
            commandout <<= 1
            GPIO.output(clockpin, True)
            GPIO.output(clockpin, False)

    adcout = 0
    # read in one empty bit, one null bit and 10 ADC bits
    for i in range(12):
            GPIO.output(clockpin, True)
            GPIO.output(clockpin, False)
            adcout <<= 1
            if (GPIO.input(misopin)):
                    adcout |= 0x1

    GPIO.output(cspin, True)

    adcout >>= 1       # first bit is 'null' so drop it
    return adcout 
```

在 c# 中，它似乎返回 0 - 2047。

```
static int returnadc(int adcnum, GPIO.GPIOPins clockpin, GPIO.GPIOPins mosipin,
 GPIO.GPIOPins misopin, GPIO.GPIOPins cspin)
    {
        int commandOut = 0;
        GPIOMem cpPin = new GPIOMem(clockpin, GPIO.DirectionEnum.OUT);
        GPIOMem moPin = new GPIOMem(mosipin, GPIO.DirectionEnum.OUT);
        GPIOMem miPin = new GPIOMem(misopin, GPIO.DirectionEnum.IN);
        GPIOMem cspPin = new GPIOMem(cspin, GPIO.DirectionEnum.OUT);

        cspPin.Write(true);
        cpPin.Write(false);
        cspPin.Write(false);

        commandOut = adcnum;

        commandOut |= 0x18;
        commandOut <<= 3;
        for (int x = 1; x <6 ; x++)
        {
            if ((commandOut & 0x80) > 0)
            {
                moPin.Write(true);
            }
            else
            {
                moPin.Write(false);
            }
            commandOut <<= 1;
            cpPin.Write(true);
            cpPin.Write(false);

        }

        int adcout = 0;
        for (int xx = 1; xx < 13; xx++)
        {
            cpPin.Write(true);
            cpPin.Write(false);
            adcout <<= 1;
            if (miPin.Read())
            {
                adcout |= 0x1;
            }
        }
        cspPin.Write(true);

        return adcout;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:48:44.523

在您的 Python 实现结束时，您正在移出一点分辨率：

```
adcout >>= 1       # first bit is 'null' so drop it
return adcout 
```

您的 C# 实现中不存在相同的代码：

```
return adcout; 
```

右移一位相当于除以二。因此，C# 版本将返回两倍高的值是有道理的。

# sql - Noob 关注：T-SQL 嵌套子查询

> ID：13150562
> 
> 赞同：1
> 
> 时间：2012-10-31T02:46:12.117
> 
> 标签：sql, tsql

我有一个名为 nobel 的表，其中包含以下字段：年、主题和获胜者。

这张表代表了多年来在各种学科中的诺贝尔奖获得者。

我正在寻找获得物理奖但没有获得化学奖的年份。

我在想答案看起来像下面这样：

```
SELECT yr FROM nobel 
WHERE subject ('Chemistry') IN (SELECT subject FROM nobel WHERE subject = 'Physics') 
```

我相当确定我的语法错误......而且我不确定我是否走在正确的道路上。帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T02:52:17.800

试试这个：

```
SELECT yr 
FROM nobel n1 
WHERE n1.subject = 'Physics'
AND yr NOT IN (SELECT yr FROM nobel WHERE subject = 'Chemistry') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:00:36.027

除非您使用的是 SQL Server 2000，否则[EXCEPT](http://msdn.microsoft.com/en-us/library/ms188055.aspx)可以在 2005+ 上运行。

```
 SELECT yr
      FROM nobel 
     WHERE subject = 'Chemistry'
EXCEPT
    SELECT yr
      FROM nobel
     WHERE subject = 'Physics' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-31T07:12:47.390

下面的代码将为您提供所需的结果。

```
 SELECT n1.yr
    FROM nobel n1
    WHERE subject = 'physics'
        AND NOT EXISTS (
            SELECT yr
            FROM nobel n2
            WHERE subject = 'chemistry' AND n2.yr = n1.yr
            ) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T02:52:14.133

我想你可能走错了路。您拥有的 where 子句本质上是在说 where 'Chemistry' = 'Physics' 这永远不会是真的。

我认为你需要做的是找出物理和化学的获奖年份，然后找到只有物理获奖的年份。

```
SELECT yr
FROM Nobel
LEFT JOIN
(
  SELECT SUM(1), yr
  FROM  Nobel
  WHERE subject = 'Chemistry'
  Group By yr
) as Chemistry
ON Chemistry.yr = Nobel.Yr
LEFT JOIN
(
  SELECT SUM(1), yr
  FROM  Nobel
  WHERE subject = 'Physics'
  Group By yr
) as Physics
ON Physics.yr = Nobel.yr

WHERE Physics.YR IS NOT NULL AND Chemistry.Yr IS NULL

GROUP BY yr 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-31T02:52:40.323

我们可以做两个派生表并将它们连接起来。

```
SELECT c.Year FROM 
c (SELECT Year, COUNT(*) FROM nobel where subject = 'chem' GROUP By Year) INNER JOIN
p (SELECT Year, COUNT(*) FROM nobel where subject = 'phy' GROUP By Year) ON c.Year = p.Year
WHERE c.Count != 0 and p.Count = 0 
```

# firefox - Firefox中的Textarea光标颜色

> ID：13150564
> 
> 赞同：1
> 
> 时间：2012-10-31T02:46:17.000
> 
> 标签：firefox, cursor, textarea, placeholder

我在页面中有一个简单的文本区域，当它为空时有一个占位符。我已将 css 中的 textarea 设置为白色文本和透明背景。我的文档正文非常暗，因此黑色文本显示效果不佳。这在 Chrome、IE 等中都可以正常工作。但是在 Firefox 中，当框为空时，占位符文本显示为正确的颜色，但是当您单击框（焦点）时，光标开始为黑色，直到您开始输入。如果您删除您键入的内容，占位符文本会返回并且光标再次变为黑色。如果您不仔细观察，则看起来好像您单击了一个不起作用的控件。

**人们如何解决这个问题？**

我的 CSS：

```
.statementInput {
    width: 500px;
    height: 50px;
    background-color: transparent;
    color:white;
    border:none;
} 
```

文本区域行：

```
<textarea class="statementInput" id="st1" placeholder="Type something here"></textarea> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-15T17:56:54.347

至少在 Firefox ESR 31 和 36 中已修复此问题。以下 css 片段会在深色背景上产生白色光标。

```
.textInput:focus {
    color: white;
}
```

[错误 830608](https://bugzilla.mozilla.org/show_bug.cgi?id=830608)指出它自 19 年以来已被修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T17:35:42.267

如果我没记错的话，这是一个[最近出现在 Firefox](https://support.mozilla.org/it/questions/936421)中的 bug ，[也被标记为 bug](https://bugzilla.mozilla.org/show_bug.cgi?id=769405)。

我在自己的工作中也遇到过这个错误，我必须说这非常令人沮丧。除非有人找到解决方法，否则我认为我们只需要等待开发人员发布修复它的新版本 Firefox。

# multithreading - 多个线程但只允许使用一个方法

> ID：13150566
> 
> 赞同：0
> 
> 时间：2012-10-31T02:46:30.443
> 
> 标签：multithreading, concurrency, race-condition, locks, condition-variable

所以基本上我所处的情况是我有一堆线程，每个线程在一周内都在做不同的计算。在一周结束时，每个线程调用函数 X() 然后开始计算下一周并重复此循环。

但是，只允许一个线程实际执行方法 X() 中的操作，并且只有当所有线程都到达方法 X() 时。此外，在使用方法 X() 的一个线程完成之前，没有一个线程可以继续前进。

所以我很难实现这一点。我觉得我需要使用条件变量，但我仍然对线程和诸如此类的东西感到不安。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T05:11:01.250

[屏障](http://en.wikipedia.org/wiki/Barrier_%28computer_science%29)在这里是一种有用的同步方法。

在 pthreads 中，您可以使用两个屏障，每个屏障都初始化为一个要求，但有多少线程正在运行。第一个在线程完成计算后同步线程，第二个在其中一个调用`X()`. 方便的是，[pthread_barrier_wait](http://pubs.opengroup.org/onlinepubs/9699919799/functions/pthread_barrier_wait.html)将选择 N 个等待线程中的一个且只有一个来实际调用`X()`：

```
void *my_thread(void *whatever) { // XXX error checking omitted
  while (1) {
    int rc;

    do_intense_calculations();

    // Wait for all calculations to finish
    rc = pthread_barrier_wait(&calc_barrier);

    // Am I nominated to run X() ?
    if (rc == PTHREAD_BARRIER_SERIAL_THREAD) X();

    // Wait for everyone, including whoever is doing X()
    rc = pthread_barrier_wait(&x_barrier);
} 
```

Java 的带有 Runnable 参数的[CyclicBarrier可以让你用一个屏障做同样的事情。](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/CyclicBarrier.html)（Runnable 在所有各方到达之后但在任何一方被释放之前运行。）

# clojure - deftype 与 defrecord

> ID：13150568
> 
> 赞同：34
> 
> 时间：2012-10-31T02:46:53.953
> 
> 标签：clojure, clojurescript

虽然`defrecord`是 Clojure 中定义“实体”的首选形式（对于一般情况），但在 ClojureScript 中，可以找到更多对 . 的引用，如[各种](http://himera.herokuapp.com/synonym.html)[文档](https://stackoverflow.com/a/9021998/569050)`deftype`中所反映的那样。

两种形式有什么区别？应该更喜欢哪一个？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-10-31T20:40:02.577

`deftype`创建一个实现协议的基本对象。

`defrecord`创建一个实现协议的不可变持久映射。

使用哪个取决于您想要什么。你想要一个完整的 ClojureScript 数据结构吗？然后使用记录。你只是想要一个除了满足协议之外什么都不做的简单的东西吗？然后使用类型。

您引用的这两个文档使用类型，因为它们试图在最基本的级别上说明协议，并且可以说类型比记录更少“进行”。

但是，在 Clojure/ClojureScript 中，大多数实际使用的类对象事物都需要将数据字段与对象一起存储，因此您应该强调使用记录，出于同样的原因，您应该使用 Clojure 的任何不可变集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-02-01T21:03:53.387

根据[DEFTYPE VS DEFRECORD](https://lispcast.com/deftype-vs-defrecord/)，您应该区分*编程构造*和*域构造*。

`deftype`用于编程构造，`defrecord`用于需要自定义类型的域构造。

希望这可以帮助。

# ruby-on-rails - Rails MVC 命名约定是否适用于复数形式为“-ies”的单词（例如回复）？

> ID：13150569
> 
> 赞同：7
> 
> 时间：2012-10-31T02:46:59.793
> 
> 标签：ruby-on-rails

我正在考虑创建一个名为`Reply`. 我想知道 Rails 是否知道它的复数形式 is`replies`和 not `replys`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-31T02:53:55.280

我相信它在内部依赖于[复数方法](http://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-pluralize)，因此您可以在 rails 控制台中检查特定复数的结果是什么：

```
"reply".pluralize
=> "replies" 
```

所以你的问题的答案是肯定的；）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T02:58:34.843

Rails 可能知道也可能不知道任何单词的复数形式，但如果不知道，您可以通过将其添加到`config/initializers/inflections.rb`.

# zend-framework2 - Zend 框架 2：模块名称“默认”是否被禁止？

> ID：13150572
> 
> 赞同：1
> 
> 时间：2012-10-31T02:47:14.023
> 
> 标签：zend-framework2

我刚刚创建了一个名为“Default”的模块，应用程序似乎在此时停止工作。

这是我使用的脚本（它适用于除“默认”之外的任何其他名称）：

```
#!/bin/bash

die () {
    echo >&2 "$@"
    exit 1
}

[ "$#" -eq 1 ] || die "1 argument required (module name), $# provided"

cd module;

#add check if module name already exists

var="$1"
OUTPUT=${var,,}
echo $OUTPUT

mkdir -pv $1/{config,src/$1/{Controller,Form,Model},view/$OUTPUT/$OUTPUT};

cd $1;

echo "<?php
// module/$1/Module.php
namespace $1;

class Module
{
    public function getAutoloaderConfig()
    {
        return array(
            'Zend\Loader\ClassMapAutoloader' => array(
                __DIR__ . '/autoload_classmap.php',
            ),
            'Zend\Loader\StandardAutoloader' => array(
                'namespaces' => array(
                    __NAMESPACE__ => __DIR__ . '/src/' . __NAMESPACE__,
                ),
            ),
        );
    }

    public function getConfig()
    {
        return include __DIR__ . '/config/module.config.php';
    }
}
" > Module.php;

echo "<?php
// module/$1/autoload_classmap.php:
return array();
" > autoload_classmap.php;

echo "<?php
// module/$1/config/module.config.php:
return array(
    'controllers' => array(
        'invokables' => array(
            '$1\Controller\\$1' => '$1\Controller\\$1Controller',
        ),
    ),
    'view_manager' => array(
        'template_path_stack' => array(
            '$OUTPUT' => __DIR__ . '/../view',
        ),
    ),
);
" > config/module.config.php;

echo "Updating application.config"
sed -i '/modules..=>.array/,/),/ { /[^(,]$/ s//&,\n        '\'$1\''/ }' ../../config/application.config.php;

echo "Success" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T16:44:26.243

您不能使用 php 保留字作为命名空间（另请参阅[php 手册](http://www.php.net/manual/en/language.namespaces.rationale.php)）。您可以命名`_Default`左右`Default_`，但`Default`本身是不允许的。

# python - 将 time.struct_time 转换为列表

> ID：13150580
> 
> 赞同：0
> 
> 时间：2012-10-31T02:48:46.060
> 
> 标签：python

在 Python 中，如何转换`time.struct_time`诸如

```
time.struct_time(tm_year=2012, tm_mon=10, tm_mday=1, tm_hour=0, tm_min=0, tm_sec=0, tm_wday=0, tm_yday=275, tm_isdst=-1) 
```

到一个列表，例如

```
[2012, 10, 1, 0, 0, 0, 0, 275, -1] 
```

我的动机：我将`time.struct_time`像前者这样的对象存储在一个 json 文件中，当我检索它们时，它们就像后者一样是列表。我需要将一个这样的列表与一个`time.struct_time`; 因此我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:54:06.927

调用`list()`构造函数将做你需要的：

```
>>> t = time.localtime()
>>> list(t)
[2012, 10, 30, 22, 54, 25, 1, 304, 1] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T02:55:30.920

用 转换它`list(obj)`，例如：

> `>>>`a = time.gmtime()
> `>>>`a
> time.struct_time(tm_year=2012, tm_mon=10, tm_mday=31, tm_hour=2, tm_min=53, tm_sec=4, tm_wday=2, tm_yday=305, tm_isdst=0)
> `>>>`列表( a)
> [2012, 10, 31, 2, 53, 4, 2, 305, 0]

# c# - 命令按钮集合的通用方法

> ID：13150581
> 
> 赞同：-2
> 
> 时间：2012-10-31T02:49:15.893
> 
> 标签：c#, windows-phone-7

我们如何为命令按钮的集合提供单一的通用方法。我收集了 digit(0, 1,2..) 命令按钮，并且需要为所有这些按钮提供单一事件方法，因为它们具有相似的行为。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T02:59:57.797

事件委托的模式是使用两个参数。一个是发送者，另一个是事件参数。你可以根据发件人做一些事情，或者你可以在标签中放一些东西

```
void OnButtonClick(object sender, EventArgs e)
        {
            Button button = sender as Button;

            object data = button.Tag;
            DoSomething(data);
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:23:17.450

您可以通过[Multicast Delegates实现此目的](http://msdn.microsoft.com/en-us/library/ms173175.aspx)

1.  以这种方式定义`GenericButtonClick`事件处理程序：

    ```
    void OnGenenicButtonClick(object sender, EventArgs e)
    {
        var btn = sender as Button;
        // ... do something ...
    } 
    ```

2.  以这种方式分配`GenericButtonClick`事件委托（在`Load`事件处理程序中）：

    ```
    cmdBtn1.Click += OnGenenicButtonClick;
    cmdBtn2.Click += OnGenenicButtonClick;
    //... 
    ```

参考：

*   也可以看看[Simple Delegate（委托）与Multicast delegates的区别](https://stackoverflow.com/questions/2192219/simple-delegate-delegate-vs-multicast-delegates)

# c# - MVC4 扩展 SimpleMembership

> ID：13150584
> 
> 赞同：1
> 
> 时间：2012-10-31T02:49:55.437
> 
> 标签：c#, asp.net-mvc-4, simplemembership

我正在考虑将旧应用程序迁移到 MVC4，但还不能修改数据库。现有的数据库已经有它自己的用户/组/成员表设置（我可能会以一种相当古怪的方式添加，但它可以工作）。

使用 MVC3 风格的 MembershipProviders，我可以自行扩展登录所需的内容、检查角色权限、修改用户属性等，但我不知道如何使用 MVC4 实现这一点，它是 SimpleMembership，然后是如何使用 OpenAuth将其作为另一种登录方式。

我一直在环顾四周，但网上似乎很少有关于它的内容，有什么想法吗？

如果有人知道另一个类似的提供者也会这样做，我不需要 SimpleMembership 实现。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T15:11:18.937

SimpleMembership 就像它的名字一样：简单。因此，如果您想扩展成员资格提供程序以满足您对角色和成员资格的复杂要求，这不是一个好的选择。如果您确实必须将您的应用程序升级到 mvc4，只需执行此操作，然后重用您的应用程序中退出的 ASP.Net Membership。它仍然在 mvc4 上正常运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-28T17:39:32.527

要尝试的一件事是仅使用 SimpleMembership 并添加尽可能多的角色来弥补当前的“属性”。取决于您所说的“属性”是什么意思。如果您只想向 UsersProfile 表添加其他列，这很容易做到。然后 SimpleMembership API 可以访问这些新列，就像它访问默认 MVC4 Internet 应用程序中的内置列一样。项目。

你看过[这个 SO 线程吗？](https://stackoverflow.com/questions/12435252/how-to-create-custom-additional-fields-in-userprofile-in-mvc4)

# knockout.js - knockoutJS，事件被触发，但是 event.which 仍然未定义

> ID：13150586
> 
> 赞同：3
> 
> 时间：2012-10-31T02:50:11.053
> 
> 标签：knockout.js, knockout-2.0

这是我的代码。

```
 <input type="text" placeholder="Add New Tag" data-bind="value: tagToAdd, valueUpdate: 'afterkeydown', event: { keypress: addOnEnter }" /> 
```

这是我的淘汰赛代码。

```
 self.addOnEnter = function (event) {

        console.log(event.which);

        var keyCode = (event.which ? event.which : event.keyCode);
        if (keyCode === 13) {
            self.addTag();
        }
        return true;
    }; 
```

当我在输入字段中输入某些内容时，我会记录事件，并不断返回未定义。我不知道为什么我无法捕捉到哪个事件被触发。

你可以在 jsFiddle 上测试我的代码。 [http://jsfiddle.net/GBLNR/6/](http://jsfiddle.net/GBLNR/6/)

只需在输入字段中输入任何内容，然后从控制台查看结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T03:13:11.127

Knockout 将当前数据上下文作为第一个参数传递给处理程序。`event`是第二个论点。

因此，您的函数的签名需要是：

```
self.addOnEnter = function(data, event) {

} 
```

或者，处理此问题的一种好方法是通过自定义绑定，例如：

```
//a custom binding to handle the enter key (could go in a separate library)
ko.bindingHandlers.enterKey = {
    init:function (element, valueAccessor, allBindingsAccessor, data, context) {
        var wrappedHandler, newValueAccessor;

        //wrap the handler with a check for the enter key
        wrappedHandler = function (data, event) {
            if (event.keyCode === 13) {
                valueAccessor().call(this, data, event);
            }
        };

        //create a valueAccessor with the options that we would want to pass to the event binding
        newValueAccessor = function () {
            return { keyup:wrappedHandler };
        };

        //call the real event binding's init function
        ko.bindingHandlers.event.init(element, newValueAccessor, allBindingsAccessor, data, context);
    }
}; 
```

现在你只需`enterKey`对你的函数使用这个绑定，`addOnEnter`它只需要处理你的数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-18T09:30:44.043

修改了 Niemeyer 对以下代码的回答，以防止输入键事件冒泡。`textarea`当您想避免元素中的换行时很有用。

```
ko.bindingHandlers.enterPressed = {
  init: function (element, valueAccessor, allBindingsAccessor, viewModel) {
    // Wrap the handler with a check for the enter key.
    var wrappedHandler = function (data, event) {
      if (event.keyCode === 13) {
        valueAccessor().call(this, data, event);
        return false;
      } else {
        return true; // Allow event to bubble.
      }
    };

    // Create a valueAccessor with the options that we would want to pass to the event binding.
    var newValueAccessor = function () {
      return { keypress: wrappedHandler }; // Using keypress instead of keyup.
    };

    // Call the real event binding's init function.
    ko.bindingHandlers.event.init(element, newValueAccessor, allBindingsAccessor, viewModel);
  }
}; 
```

# android - 重定向时Android DownloadManager不工作

> ID：13150587
> 
> 赞同：2
> 
> 时间：2012-10-31T02:50:18.370
> 
> 标签：android, download, download-manager

我正在开发一个应用程序，该应用程序将在通过 oAuth 2 进行身份验证后通过 Rails Heroku 服务器下载存储在 Amazon S3 上的 zip 文件。流程如下：

1.  请求通过 oAuth2 在 Heroku 上运行的服务器进行身份验证。
2.  接收 oAuth2 访问令牌。
3.  请求从服务器下载 zip 文件（将 oAuth 令牌作为承载传递）。
4.  服务器授权请求并重定向到包含过期签名的 Amazon S3 URL（以阻止任何人在未经身份验证的情况下下载内容）。

此时，我希望 DownloadManager 只遵循重定向并从 S3 获取 zip 文件，但是它失败了。有什么办法可以解决这个问题吗？还是仅仅是 DownloadManager 的限制？

我是 Android 新手，还没有完全掌握最好的调试方法，所以我没有太多的输出可以给你看。但是，似乎`DownloadManager.COLUMN_STATUS == DownloadManager.STATUS_FAILED`并且`DownloadManager.COLUMN_REASON`正在返回“占位符”！

编辑 - 这是我正在使用的代码。编辑以隐藏客户端等...

```
 @Override
public void onListItemClick(ListView l, View v, int position, long id) {
    Log.i("ChapterListActivity", "Item clicked: " + id);

    final DownloadManager downloadManager = (DownloadManager)getSystemService(Context.DOWNLOAD_SERVICE);

    Uri uri = Uri.parse("http://myapphere.herokuapp.com/api/v1/volumes/2.zip");

    DownloadManager.Request request = new Request(uri);

    String accessToken = getSharedPreferences("keyhere", MODE_PRIVATE).getString("access_token", null); 

    Log.i("SLEChapterListActivity", "Getting file with access token... " + accessToken);

    request.addRequestHeader("Authorization", "Bearer " + accessToken);
    long reference = downloadManager.enqueue(request);

    IntentFilter filter = new IntentFilter(DownloadManager.ACTION_DOWNLOAD_COMPLETE);

    BroadcastReceiver receiver = new BroadcastReceiver() {
        @Override
        public void onReceive(Context context, Intent intent) {
            long downloadReference = intent.getLongExtra(DownloadManager.EXTRA_DOWNLOAD_ID, -1);
            Log.i("ChapterListActivity", "Download completed");

            Query query = new Query();
            query.setFilterById(downloadReference);

            Cursor cur = downloadManager.query(query);

            if (cur.moveToFirst()) {
            int columnIndex = cur.getColumnIndex(DownloadManager.COLUMN_STATUS);
            if (DownloadManager.STATUS_SUCCESSFUL == cur.getInt(columnIndex)) {
                String uriString = cur.getString(cur.getColumnIndex(DownloadManager.COLUMN_LOCAL_URI));

                File mFile = new File(Uri.parse(uriString).getPath());

            } else if (DownloadManager.STATUS_FAILED == cur.getInt(columnIndex)){
                String statusResult = cur.getString(cur.getColumnIndex(DownloadManager.COLUMN_REASON));
                Toast.makeText(context, "FAILED " + statusResult, Toast.LENGTH_SHORT).show();
            } else if (DownloadManager.ERROR_TOO_MANY_REDIRECTS == cur.getInt(columnIndex)){
                String statusResult = cur.getString(cur.getColumnIndex(DownloadManager.COLUMN_REASON));
                Toast.makeText(context, "TOO MANY REDIRS " + statusResult, Toast.LENGTH_SHORT).show();
            }
        }
        }
    };

    registerReceiver(receiver, filter);

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-03T20:03:15.510

I've found in [Download Manager sources](https://android.googlesource.com/platform/frameworks/base/+/refs/heads/master/core/java/android/provider/Downloads.java) (line 500):

> 3xx: redirects (not used by the download manager)

It's not supported, yet.

In my current project, downloads are made in two steps:

1.  Get Amazon url from our own server via oAuth2
2.  Enqueue DownloadManager with the Amazon url.

If you don't like the two step process, I don't, then take a look at [RoboSpice](https://github.com/octo-online/robospice) project, it has similar philosophy as DownloadManager.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-09T19:08:28.397

# javascript - 如何使用 java 脚本静音和自动播放 youtube 频道播放器？

> ID：13150589
> 
> 赞同：1
> 
> 时间：2012-10-31T02:50:24.460
> 
> 标签：javascript, youtube, autoplay, mute

您好，这是我第一次在网上提问。我想在我的 wordpress 网站中嵌入一个 youtube 频道播放器。我正在使用来自[http://code.google.com/p/jq-youtube-player/](http://code.google.com/p/jq-youtube-player/)的代码。所以我希望这个播放器在加载时自动播放并且音频静音。我只能将自动播放设置为打开，但不知道如何使音频静音。我正在[http://jsfiddle.net/NmvA9/490/](http://jsfiddle.net/NmvA9/490/)上尝试一些东西，但我是 java 脚本的初学者，所以需要帮助。

代码是这样的

```
(function() {
    function createPlayer(jqe, video, options) {
        var ifr = $('iframe', jqe);
    if (ifr.length === 0) {
        ifr = $('<iframe scrolling="no">');
        ifr.addClass('player');
    }
    var src = 'http://www.youtube.com/embed/' + video.id + '?enablejsapi=1';
    if (options.playopts) {
        src += '?';
        for (var k in options.playopts) {
            src+= k + '=' + options.playopts[k] + '&';
        }  
        src += '_a=b';
    }
    ifr.attr('src', src);
    jqe.append(ifr);  
}

function createCarousel(jqe, videos, options) {
    var car = $('div.carousel', jqe);
    if (car.length === 0) {
        car = $('<div>');
        car.addClass('carousel');
        jqe.append(car);

    }
    $.each(videos, function(i,video) {
        options.thumbnail(car, video, options);
    });
}

function createThumbnail(jqe, video, options) {
    var imgurl = video.thumbnails[0].url;
    var img = $('img[src="' + imgurl + '"]');
    if (img.length !== 0) return;
    img = $('<img>');    
    img.addClass('thumbnail');
    jqe.append(img);
    img.attr('src', imgurl);
    img.attr('title', video.title);
    img.click(function() {
        options.player(options.maindiv, video, $.extend(true,{},options,{playopts:{autoplay:1}}));
    });
}

var defoptions = {
    autoplay: false,
    user: null,
    carousel: createCarousel,
    player: createPlayer,
    thumbnail: createThumbnail,
    loaded: function() {},
    playopts: {
        autoplay: 0,
        egm: 1,
        autohide: 1,
        fs: 1,
        showinfo: 0
    }
};
player.mute():Void

$.fn.extend({
    youTubeChannel: function(options) {
        var md = $(this);
        md.addClass('youtube');
        md.addClass('youtube-channel');
        var allopts = $.extend(true, {}, defoptions, options);
        allopts.maindiv = md;
        $.getJSON('http://gdata.youtube.com/feeds/users/' + allopts.user + '/uploads?alt=json-in-script&format=5&callback=?', null, function(data) {
            var feed = data.feed;
            var videos = [];
            $.each(feed.entry, function(i, entry) {
                var video = {
                    title: entry.title.$t,
                    id: entry.id.$t.match('[^/]*$'),
                    thumbnails: entry.media$group.media$thumbnail
                };
                videos.push(video);
            });
            allopts.allvideos = videos;
            allopts.carousel(md, videos, allopts);
            allopts.player(md, videos[0], allopts);
            allopts.loaded(videos, allopts);
        });
    }
});

 })();

$(function() {
$('#player').youTubeChannel({user:'youtube'});
}); 
```

如果在此代码中将自动播放设置为“1”

```
var defoptions = {
    autoplay: false,
    user: null,
    carousel: createCarousel,
    player: createPlayer,
    thumbnail: createThumbnail,
    loaded: function() {},
    playopts: {
        autoplay: 0,
        egm: 1,
        autohide: 1,
        fs: 1,
        showinfo: 0
    }
}; 
```

它会自动播放视频，但添加“静音”值似乎不起作用。我想我需要以其他方式将其静音，但不知道如何...所以请帮忙谢谢

# javascript - 在提交按钮上为事件侦听器编写对象的更好方法？

> ID：13150590
> 
> 赞同：0
> 
> 时间：2012-10-31T02:50:47.173
> 
> 标签：javascript, object, singleton, addeventlistener

我写了一个简单的登录页面。我想为提交按钮使用 javascript 事件侦听器。我的目标是通过使用对象来提高我的 javascript 写作效率和清洁度。我选择了一个单例对象函数，因为永远只有一个实例。这就是我所拥有的，我想知道一种更好的方法来编写 javascript 部分。我只包含了 html 部分来说明正在发生的事情：

```
<head>
    <link rel="stylesheet" href="css/login_main.css"></link>

</head>

<body>
    <form action="index.php" method="post">
    <div id="enter">Enter Username :<span class="blinkme">>_</span><input class="inputs" type="text" name="uname" maxlength="20" autofocus="autofocus"/></div>
    <div id="enter">Enter Password :<span class="blinkme">>_</span><input class="inputs" type="password" name="pword" maxlength="20"/></div>
    <div id="done"><a href="">[< Submit >]</a></div>
    </form>

</body>
            <script style="text/javascript" src="js/login_main.js"></script>
            </html> 
```

本地主机 js # cat login_main.js

```
 var formStuff = function () {
          var variables = {
        done : document.getElementById("done"),
          }

        function getSubmit () {
            docuement.forms[0].submit();
        }

        return {
            submitForm: getSubmit,
                done: function () { return variables.done; },
        }
    }();

    window.onload = formStuff.done.addEventListener("click", formStuff.getSubmit, false); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:03:37.633

简单的说：

```
<div id="done"><a href="javascript:document.forms[0].submit()">[< Submit >]</a></div> 
```

或者（但你应该删除 <a ...>）：

```
document.getElementById("done").addEventListener("click", function() {
  document.forms[0].submit()
}, false); 
```

# python - 为什么这个 Python 函数没有返回未来？

> ID：13150592
> 
> 赞同：1
> 
> 时间：2012-10-31T02:51:02.650
> 
> 标签：python, google-app-engine

我正在使用带有 NDB 的 Google App Engine。为简洁起见，我删除了很多代码，但保留了基本问题。我收到一个错误`'list' object has no attribute 'get_result'`

```
def get_future(keys):
    future = ndb.get_multi_async(keys)
    important_value = ... # get important value
    return {"future" : future, "value" : important_value}

dic = get_future(keys)
future = dic['future']
# error `'list' object has no attribute 'get_result'`
items = future.get_result() 
```

当我应该得到一个未来时，为什么我会得到一个列表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T02:58:21.977

`get_multi_async`实际上返回一个`future`对象列表，因此您需要调用`.get_result()`这些对象。

[官方定义](https://developers.google.com/appengine/docs/python/ndb/functions#get_multi_async)：

> **ndb.get_multi_async(keys, **ctx_options)**
> 
> 异步获取由传递的键序列标识的实体。
> 
> **论据**
> 
> ```
> keys
>  -Sequence of keys
> 
> **ctx_options 
>  -Context options 
> ```
> 
> **返回 Future 对象的列表**。如果未找到密钥，则每个未来的结果都是一个模型实例或 None 。

# php - 在意外的 T_ENCAPSED 和空白处收到解析错误

> ID：13150594
> 
> 赞同：0
> 
> 时间：2012-10-31T02:51:35.737
> 
> 标签：php

我在下面的第一行代码中收到错误消息：

> 解析错误：语法错误，意外的 T_ENCAPSED_AND_WHITESPACE，期待 T_STRING 或 T_VARIABLE 或 T_NUM_STRING 在 ... 第 184 行

如何在下面的代码中修复此错误：

```
$assessmentform = "<form action='echo htmlentities($_SERVER['PHP_SELF']);' method='post'>
<p>Assessments: echo $sessionHTML; </p>
<p><input id='sessionSubmit' type='submit' value='Submit Assessment' name='sessionSubmit' /></p>      
</form>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T02:53:19.287

您不能从字符串内部调用函数

尝试

```
$assessmentform = "<form action='".htmlentities($_SERVER['PHP_SELF'])."' method='post'>
<p>Assessments: {$sessionHTML} </p>
<p><input id='sessionSubmit' type='submit' value='Submit Assessment' name='sessionSubmit' /></p>      
</form>"; 
```

# c - GMP GNU 代码中的错误？

> ID：13150598
> 
> 赞同：2
> 
> 时间：2012-10-31T02:51:58.407
> 
> 标签：c, gmp

当我运行此代码时，出现错误“分段错误（核心转储）”。但是不使用 mpz_get_str 就可以了。

```
#include<stdio.h>
#include<gmp.h>
int main()
{
char *A;
mpz_t P,Q;
mpz_init(P);
mpz_init(Q);
mpz_set_str(P,"1201858877187548528922917",10);
mpz_set_str(Q,"1248833599132922783100713",10);

mpz_t PHI,E,K,d;
mpz_init(PHI);
mpz_init(E);
mpz_init(K);
mpz_init(d);

mpz_sub_ui(PHI,P,1);
mpz_sub_ui(K,Q,1);
mpz_mul(PHI,PHI,K);
mpz_set_str(E,"37",10);
mpz_gcd(d,E,PHI);
gmp_printf("d=%Zd\n",d);
mpz_invert(d,E,PHI);
gmp_printf("d=%Zd\n",d);
A=mpz_get_str(A,2,d);

mpz_mul(K,d,E);
mpz_sub_ui(K,K,1);
mpz_divexact(K,K,PHI);

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T03:11:35.497

您应该将您的初始化`char *A`为 NULL 或 0，否则（如果它不是 NULL 或 0 偶然），GMP 将尝试写入随机内存地址，这将导致段错误。

来自 GMP 文档： http: [//gmplib.org/manual/Converting-Integers.html](http://gmplib.org/manual/Converting-Integers.html)

> 如果 str 为 NULL，则使用当前分配函数分配结果字符串（请参阅自定义分配）。该块将是 strlen(str)+1 个字节，这对于字符串和空终止符来说已经足够了。
> 
> 如果 str 不为 NULL，它应该指向一个足够大的存储块，即 mpz_sizeinbase (op, base) + 2。两个额外的字节用于可能的减号和空终止符。

# ant - 如何迭代 ant 属性并作为 arg 传递给 exec

> ID：13150603
> 
> 赞同：3
> 
> 时间：2012-10-31T02:52:24.007
> 
> 标签：ant

我有一个属性文件，我想将所有键和值传递给命令，我该怎么做？

说属性文件看起来文件

```
size=small
perf=true 
```

蚂蚁任务看起来像

```
 <exec executable="${prog}" failonerror="true">
<!-- I want to add all properties from file as argument here, -->
    </exec> 
```

这样在运行时，行为与

```
<exec executable="${prog}" failonerror="true">
   <arg value = "size"/>
   <arg value = "small"/>
   <arg value = "perf"/>
   <arg value = "true"/>
</exec> 
```

我怎样才能做到这一点？谢谢

编辑：

按照 Vadzim 的建议，我现在正在使用脚本。

```
<property file="test.properties" prefix="testproperty"/>
<target name = "test1">
<script language="javascript"> <![CDATA[
  properties = project.getUserProperties()
  echo = project.createTask( "echo" );
  anotation = project.getProperty("testproperty.size")
  echo.setMessage(anotation);
  echo.perform();
  for(key in properties) {
    echo.setMessage(key);
    echo.perform();
    echo.setMessage(properties[key]);
    echo.perform();
  }
]]> </script>
</target> 
```

但是，getProperty() 正在工作，但 getProperties 仅包含诸如 notify() 之类的 java 函数

```
$ant test1
test1:
     [echo] small
     [echo] notifyAll
     [echo] function notifyAll() {/*
     [echo] void notifyAll()
     [echo] */}
     [echo] values
     [echo] function values() {/*
     [echo] java.util.Collection values()
     [echo] */}
     [echo] containsKey
     [echo] function containsKey() {/*
     [echo] boolean containsKey(java.lang.Object)
     [echo] */}
     [echo] entrySet
     [echo] function entrySet() {/*
     [echo] java.util.Set entrySet()
     [echo] */}
     [echo] keySet
     [echo] function keySet() {/*
     [echo] java.util.Set keySet()
     [echo] */}
     [echo] put
     [echo] function put() {/*
     [echo] java.lang.Object put(java.lang.Object,java.lang.Object)
     [echo] */}
     [echo] contains
     [echo] function contains() {/*
     [echo] boolean contains(java.lang.Object)
     [echo] */}
     [echo] empty
     [echo] false
     [echo] equals
     [echo] function equals() {/*
     [echo] boolean equals(java.lang.Object)
     [echo] */}
     [echo] notify
     [echo] function notify() {/*
     [echo] void notify()
     [echo] */}
     [echo] class
     [echo] class java.util.Hashtable
     [echo] elements
     [echo] function elements() {/*
     [echo] java.util.Enumeration elements()
     [echo] */}
     [echo] keys
     [echo] function keys() {/*
     [echo] java.util.Enumeration keys()
     [echo] */}
     [echo] isEmpty
     [echo] function isEmpty() {/*
     [echo] boolean isEmpty()
     [echo] */}
     [echo] size
     [echo] function size() {/*
     [echo] int size()
     [echo] */}
     [echo] putAll
     [echo] function putAll() {/*
     [echo] void putAll(java.util.Map)
     [echo] */}
     [echo] clear
     [echo] function clear() {/*
     [echo] void clear()
     [echo] */}
     [echo] wait
     [echo] function wait() {/*
     [echo] void wait()
     [echo] void wait(long)
     [echo] void wait(long,int)
     [echo] */}
     [echo] containsValue
     [echo] function containsValue() {/*
     [echo] boolean containsValue(java.lang.Object)
     [echo] */}
     [echo] toString
     [echo] function toString() {/*
     [echo] java.lang.String toString()
     [echo] */}
     [echo] hashCode
     [echo] function hashCode() {/*
     [echo] int hashCode()
     [echo] */}
     [echo] clone
     [echo] function clone() {/*
     [echo] java.lang.Object clone()
     [echo] */}
     [echo] get
     [echo] function get() {/*
     [echo] java.lang.Object get(java.lang.Object)
     [echo] */}
     [echo] getClass
     [echo] function getClass() {/*
     [echo] java.lang.Class getClass()
     [echo] */}
     [echo] remove
     [echo] function remove() {/*
     [echo] java.lang.Object remove(java.lang.Object)
     [echo] */}

BUILD SUCCESSFUL
Total time: 0 seconds 
```

迭代 getProperties() 结果的正确方法是什么？

非常感谢任何建议

编辑2：

[jbeard4](https://stackoverflow.com/users/366856/jbeard4)[在这里](https://stackoverflow.com/a/3481911/302959)有一个很好的解释。关于javascript问题。所以正确的方法是

```
<script language="javascript"> <![CDATA[
  properties = project.getUserProperties()
  var keyIter = properties.keySet().iterator();
  while(keyIter.hasNext()) {
    var key = keyIter.next();
    var value = properties.get(key);
    echo.setMessage(key+value);
    echo.perform();
  }
]]> </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T06:17:28.313

我认为这只能通过自定义[脚本](http://ant.apache.org/manual/Tasks/script.html)代码来实现。

参见例如[是否可以从 javascript scriptdef 任务调用 ant 任务？](https://stackoverflow.com/questions/12608430/is-it-possible-to-call-ant-task-from-a-javascript-scriptdef-task).

只需遍历[project.getProperties()并](http://api.dpml.net/ant/1.6.4/org/apache/tools/ant/Project.html#getProperties%28%29)[通过 API](http://www.jajakarta.org/ant/ant-1.6.1/docs/en/manual/api/org/apache/tools/ant/taskdefs/ExecTask.html#createArg%28%29)添加 exec args 。

# visual-studio - asp.net 可部署程序集

> ID：13150606
> 
> 赞同：3
> 
> 时间：2012-10-31T02:52:40.810
> 
> 标签：visual-studio, assemblies, dll

我们有一些程序集没有被我们的解决方案直接引用，但我们正在使用的其他库需要这些程序集。

我注意到在 VS 2010 中，您可以添加一个可部署的程序集文件夹，这会导致其中的文件在构建时被复制到 bin，这似乎在 2012 年被删除，因为所有微软的东西现在都可以在 nuget 中使用。

实现相同效果的最佳方法是什么，我可以在我的项目中添加一个文件夹并添加一个构建后复制任务以将所有内容复制到 bin 中，还是有更好的方法来解决这个问题。

目前，dll位于项目根目录中，并将它们的构建操作设置为我收集的内容，使它们被复制到bin中，但是我想让它更简单一点，而不必依赖于将事物设置为内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T13:45:46.273

老实说，您所做的并不是一种糟糕的处理方式，而且我们在日常工作中一直这样做的方式只是将程序集作为参考添加到我们的解决方案中；然而，这确实意味着它们会污染 Intellisense。

或者，[Phil Haack 在博客](http://haacked.com/archive/2011/05/25/bin-deploying-asp-net-mvc-3.aspx)中写道，您可以创建一个名为的文件夹`_bin_deployableAssemblies`并将文件放入其中；`bin`作为默认构建操作的一部分，Visual Studio 2010 会自动将它们复制到您的文件夹中。

显然，这不适用于 TFS`msbuild`脚本，因此[Dev Stop 的](http://thedevstop.wordpress.com/about/)家伙[在博客上写了关于如何](http://thedevstop.wordpress.com/2012/03/01/_bin_deployableassemblies-and-msbuild/)使用自定义脚本`Target`来使用 TFS 的博客。`msbuild`

如果`_bin_deployableAssemblies`不再在 Visual Studio 2012 中工作，我猜您可以根据 Dev Stop 的 TFS 构建操作向项目文件添加构建操作？

# jquery - rails 不显眼的 js 和自定义资产清单文件

> ID：13150609
> 
> 赞同：0
> 
> 时间：2012-10-31T02:53:09.860
> 
> 标签：jquery, ruby-on-rails-3, unobtrusive-javascript

我有一个清单文件，如下所示：

```
# director.js

//= require jquery
//= require jquery_ujs
//= require jquery-ui-1.8.22.custom.min
//= require_tree ./tablet/director 
```

这与我的 application.js 文件几乎相同，除了 require_tree 指向另一个目录。我的布局文件看起来有以下内容：

```
= javascript_include_tag "director" 
```

我已经在我的环境/development.rb 文件中使用预编译了我的资产

```
config.assests.precompile += %w{ director.js } 
```

但由于某种原因，我不显眼的 javascript 无法正常工作。当我尝试执行控制器的删除操作时，它会查找显示操作，但是打开 firebug 显示所有 jquery 文件都已加载。我真的不知道发生了什么。此外，当我将 javascript_include_tag 更改为包含“应用程序”时，它工作正常。我不确定我错过了什么导致这种情况。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:22:30.170

environment/development.rb 告诉我你这样做是为了开发。据我所知，您并不想在开发环境中进行预编译。但是，您必须添加该生产线。

# c#-4.0 - 如何动态获取 TFS 字段值？

> ID：13150614
> 
> 赞同：0
> 
> 时间：2012-10-31T02:53:21.470
> 
> 标签：c#-4.0

有一种情况，例如“我在 TFS 中有一个字段值刚刚被我的团队成员更改。我可以立即将该更改字段的值获取到应用程序中吗？”.. 请告诉我如何实现这一点使用 C#.net .. 在此先感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T22:14:51.180

您要么想查看 SOAP 订阅，要么编写一个 tfs 服务器插件来将更新转发到您的应用程序。我可能会建议做这两个选项中的后者。

[Team Foundation Server 2010 与订阅者的事件处理](http://blog.hinshelwood.com/team-foundation-server-2010-event-handling-with-subscribers/)

如果您的应用程序必须不遗漏任何更新（例如，您正在编写同步），您可能希望将服务总线作为插件和应用程序之间的传输。

或者，您可以使用轮询更新方法，查看每个工作项历史记录以查看它是否已更改。似乎还有很多工作，没有真正的好处。

# c++ - 我如何让我的程序计算掉最低分数的平均值？

> ID：13150616
> 
> 赞同：0
> 
> 时间：2012-10-31T02:53:45.410
> 
> 标签：c++, average

下面是我的代码：它运行良好，但如何让它平均用户输入的所有分数，但在计算之前降低最低分数？我已经插入了一些代码，但我认为它是错误的，因为我无法让它正常工作。有没有更短、最简单的方法来编写该代码？还是最好的写法？谢谢你。

```
#include <iostream>
#include <iomanip>
using namespace std;

//void sortArray(double arr[], int numTest, int scoreNum);
//void displayArray(double arr[], int numTest, int scoreNum);

int main()
{
    //To dynamically allocate an array, Accumulator, to hold the average scores.
    double *score;      
    double total = 0;  
    double average; 

    //int for counter, to hold the number of test scores.
    int count; 
    int numTest; 

    // To obtain the number of test scores the user would like to enter.
    cout << "How many test scores would you like to enter? " << endl;
    cin >> numTest; 

    //Dynamically allocates an array large enough to hold the amount of test scores to enter.
    score = new double[numTest];

    //Get the test scores.
    cout << "Enter the test score desired. " << endl;
    for (count = 0; count < numTest; count++)
    {
        cout << "Score " << (count + 1) << ": ";
        cin >> score[count];
    }

    //sortArray(score, numTest, scoreNum); (Need to get this part to work)
    //displayArray( score, numTest, scoreNum); (Need to get this part to work)

    //Calculate the total test scores.
    for (count = 0; count < numTest; count++)
    {
        total += score[count];
    }

    //Calculate the test scores average minus the lowest score. (I need help here - is this how I drop the lowest score?)
    average = total / numTest;

    //Display the results
    cout << fixed << showpoint << setprecision(2);
    cout << "Test Scores Average with the lowest dropped is: " << average << endl;

    //Free dynamically allocated memory
    delete [] score;
    score = 0; // Makes score point to null.

    system("pause");
    return 0;
}

/* void sortArray(double arr[], int numTest, int scoreNum)
{
    double num = 0;
    int posNum = 0;
    for (int i = 0; i < numTest; i++)
    {
        for (int x = (i + 1); x < numTest; x++)
        {
            if ( arr[i] > arr[x] )
            {
                num = score[i];
                posNum = scoreNum[i];
                arr[i] = arr[x];
                scoreNum[i] = scoreNum[x];
                arr[x] = num;
                scoreNum[x] = posNum;
            }
        }
    }
}

void displayArray(double arr[], int numTest, int scoreNum)
{
    double average = 0.0;
    double sum = 0.0;
    int x;
    for (int i = 0; i < numTest; i++)
    {
        for (x = 1; x < numTest; x++)
        {
            sum += arr[x];
        }
    }

    average = sum(numTest - 1);

    cout << fixed << showpoint << setprecision(2) << endl;
    cout << "The average of all test scores dropping the lowest is: " << average << endl;
}
*/ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T03:04:57.323

在我们开始之前，您应该考虑使用`std::vector`数组来代替原始指针。

```
// instead of:
double *score = new double[numTest];

// use:
std::vector<double> scores;
scores.resize(numTest); 
```

关于你的问题：

首先，您需要对分数进行排序以找到最低的：

```
// partial_sort will find the first n (here, 1) items, and leave the remainder
std::partial_sort(&score[0], &score[1], &score[numTest]); 
```

接下来，获取除最低值之外的所有值的平均值：

```
auto avg = std::accumulate(&score[1], &score[numTest], 0.0) / (numTest - 1); 
```

（这是跳过所有错误处理；例如，您应该检查`numTest`大于 1。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:02:15.593

获得所有分数后，遍历它们以找到最低的分数。一个简单的迭代就可以正常工作：

```
int lowest = score[0];
for(count = 1; count < numTest; count++)
{
    if(score[count] < lowest) lowest = score[count];
} 
```

现在`lowest`将保持最低分。你可以从你的总数中减去它并除以`numTest-1`，你应该已经准备好了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T03:07:27.937

为了有效地做到这一点（避免尽可能多的指令），您可以在对值求和的同时跟踪最低分数，因此只需循环一次您的分数。

```
double lowest = MAX_SCORE;
//Calculate the total test scores.
for (count = 0; count < numTest; count++)
{
    if (score[count] < lowest)
        lowest = score[count];
    total += score[count];
}
total -= lowest;
average = total / (numTest - 1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T11:20:00.430

```
std::vector<double> scores;
// populate scores here
double lowest = scores[0];
double sum = scores[0];
for (int i = 1; i < scores.size(); ++i) {
    lowest = std::min(lowest, scores[i]);
    sum += scores[i];
}
sum -= lowest;
sum /= scores.size() - 1; 
```

# cuda - 了解 GPU 堆内存和驻留扭曲

> ID：13150618
> 
> 赞同：0
> 
> 时间：2012-10-31T02:53:54.287
> 
> 标签：cuda

驻留扭曲的数量是否也受到用户指定的堆大小的限制？

例如，如果每个线程需要分配 1 MB 内存并且堆设置为总共 32 MB（我假设 cudaLimitMallocHeapSize 用于每次内核启动而不是每个线程的堆使用，对吗？）。设备上只允许一个扭曲是真的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:31:08.083

内核启动（或warp 或块的发布）将不受堆大小的限制。相反，如果不能满足每个线程请求分配的已发布线程数（已达到每个线程 malloc，但未达到相应的空闲），内核启动将失败。您不妨参考[堆内存分配部分](http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#heap-memory-allocation)CUDA C 程序员指南。该部分给出了每个线程分配的示例代码，您可以轻松地修改该代码以向自己证明这种行为。只需调整堆大小和启动的线程（或块）数量即可查看达到堆限制时的行为。是的，cudaLimitMallocHeapSize 实际上用于整个设备上下文，因此它适用于在相关调用 cudaDeviceSetLimit() 之后的所有内核启动。这不是每个线程的限制。另请注意，存在一些分配开销。将堆大小设置为 128MB 并不意味着所有 128MB 都可用于后续设备 malloc 操作。提到设备 malloc 操作只能在 CC 2.0 及更高版本上可能也很有用。

# javascript - Javascript日期字符串转换

> ID：13150621
> 
> 赞同：3
> 
> 时间：2012-10-31T02:54:04.490
> 
> 标签：javascript, date, casting

我有一个系统，它返回一个 JSON 对象，其中包含字符串格式的日期。

这些日期的格式为“格林威治标准时间 2012-10-19 06:05:38”（不......我被这样困住了）

所以我需要把它变成一个日期对象 (d) 准备输出为 d.toLocaleDateString()

在 chrome 中，只需将字符串传递给新的 Date 即可完美运行（Bad bad Chrome - 使 Eric 变得懒惰），但在 FF 和 IE 中它当然会失败

我可以通过拆分字符串来修复它，但它并不漂亮，而且我还没有想出处理来自 GMT 的偏移量。

一定有更优雅的方式……？

我敢肯定这里有人可以在一行中完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:34:54.363

它不是一个单行的，但如果你知道你所有的日期都是格林威治标准时间，那么类似下面的东西应该可以工作：

```
function parseDate(dateString) {
    // [y, m, d, hr, min, sec]
    var parts = dateString.match(/\d+/g);

    // Months are 0-indexed
    parts[1] -= 1;

    return new Date(Date.UTC.apply(Date, parts));
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T03:12:14.093

如果我是你，并且可以访问收集该信息（并输出它）的服务器端脚本，我会将日期转换为 unix 时间戳，然后使用 Date 构造函数轻松地进行 Javascript 处理。

**编辑：**[`strtotime()`](http://php.net/manual/en/function.strtotime.php)如果您使用 PHP，您可以使用函数将字符串日期转换为数字 unix 时间戳。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T03:12:55.557

如果您知道确切的格式，则可以使用 Moment.js 之类的库：Moment.js[文档](http://momentjs.com/docs/)。

解析：

```
var dateString = "2012-10-19 06:05:38 GMT".replace(" GMT", "");
var date = moment(dateString, "YYYY-MM-DD HH:mm:ss"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-31T03:43:14.187

您可以手动解析 dateString，并准确传递 Date 构造函数：<a href="https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date" rel="nofollow ">https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date

```
 var dateString = "2012-10-19 06:05:38 GMT".split(" "),
       date = dateString[0].split("-"),
       time = dateString[1].split(":");

   var dateObj = new Date(date[0],date[1]-1,date[2],time[0],time[1],time[2]); 
```

# mysql - 应用程序无法在 ubuntu 上启动，但在 windows 上启动时没有任何问题

> ID：13150624
> 
> 赞同：2
> 
> 时间：2012-10-31T02:54:17.817
> 
> 标签：mysql, maven, ubuntu, glassfish-3, ejb-3.1

我的应用程序在启动期间加载了很多数据。重新启动 glassfish 后，在应用程序初始化过程大约 15 分钟后，开始在日志文件中发出以下警告

```
WARNING|glassfish3.1.2|com.sun.grizzly.config.GrizzlyServiceListener|_ThreadID=27;_ThreadName=Thread-2;|GRIZZLY0023: Interrupting idle Thread: admin-thread-pool-4848(3).|#] 
```

毕竟整个过程失败并出现错误：

```
 [#|2012-10-30T16:26:08.404-0400|WARNING|glassfish3.1.2|com.sun.grizzly.config.GrizzlyServiceListener|_ThreadID=27;_ThreadName=Thread-2;|GRIZZLY0023: Interrupting idle Thread: admin-thread-pool-4848(3).|#]

[#|2012-10-30T16:26:08.624-0400|INFO|glassfish3.1.2|javax.enterprise.resource.webcontainer.jsf.config|_ThreadID=61;_ThreadName=Thread-2;|Initializing Mojarra 2.1.12 ( 20120814-1522) for context ''|#]

[#|2012-10-30T16:26:09.126-0400|SEVERE|glassfish3.1.2|javax.faces|_ThreadID=61;_ThreadName=Thread-2;|Application was not properly initialized at startup, could not find Factory: javax.faces.application.ApplicationFactory. Attempting to find backup.|#]

[#|2012-10-30T16:26:09.136-0400|SEVERE|glassfish3.1.2|javax.enterprise.resource.webcontainer.jsf.config|_ThreadID=61;_ThreadName=Thread-2;|Critical error during deployment: 
com.sun.faces.config.ConfigurationException: Factory 'javax.faces.application.ApplicationFactory' was not configured properly.
    at com.sun.faces.config.processor.FactoryConfigProcessor.verifyFactoriesExist(FactoryConfigProcessor.java:305)
    at com.sun.faces.config.processor.FactoryConfigProcessor.process(FactoryConfigProcessor.java:219)
    at com.sun.faces.config.ConfigManager.initialize(ConfigManager.java:362)
    at com.sun.faces.config.ConfigureListener.contextInitialized(ConfigureListener.java:223)
    at org.apache.catalina.core.StandardContext.contextListenerStart(StandardContext.java:4750)
    at com.sun.enterprise.web.WebModule.contextListenerStart(WebModule.java:550)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:5366)
    at com.sun.enterprise.web.WebModule.start(WebModule.java:498)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:917)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:901)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:733)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:2018)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1669)
    at com.sun.enterprise.web.WebApplication.start(WebApplication.java:109)
    at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:461)
    at com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:212)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.IllegalStateException: Could not find backup for factory javax.faces.application.ApplicationFactory. 
    at javax.faces.FactoryFinder$FactoryManager.getFactory(FactoryFinder.java:1011)
    at javax.faces.FactoryFinder.getFactory(FactoryFinder.java:343)
    at com.sun.faces.config.processor.FactoryConfigProcessor.verifyFactoriesExist(FactoryConfigProcessor.java:303)
    ... 45 more
|#]

[#|2012-10-30T16:26:09.137-0400|SEVERE|glassfish3.1.2|org.apache.catalina.core.StandardContext|_ThreadID=61;_ThreadName=Thread-2;|PWC1306: Startup of context  failed due to previous errors|#]

[#|2012-10-30T16:26:09.139-0400|SEVERE|glassfish3.1.2|org.apache.catalina.core.StandardContext|_ThreadID=61;_ThreadName=Thread-2;|PWC1305: Exception during cleanup after start failed
org.apache.catalina.LifecycleException: PWC2769: Manager has not yet been started
    at org.apache.catalina.session.StandardManager.stop(StandardManager.java:873)
    at org.apache.catalina.core.StandardContext.stop(StandardContext.java:5571)
    at com.sun.enterprise.web.WebModule.stop(WebModule.java:527)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:5384)
    at com.sun.enterprise.web.WebModule.start(WebModule.java:498)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:917)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:901)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:733)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:2018)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1669)
    at com.sun.enterprise.web.WebApplication.start(WebApplication.java:109)
    at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:301)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:461)
    at com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:212)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
|#]

.................................................................

[#|2012-10-30T16:26:10.070-0400|INFO|glassfish3.1.2|org.eclipse.persistence.session.file:/home/ayksolutions/glassfish3/glassfish/domains/domain1/applications/ejb-timer-service-app/WEB-INF/classes/___EJB__Timer__App|_ThreadID=61;_ThreadName=Thread-2;|Communication failure detected when attempting to perform read query outside of a transaction. Attempting to retry query. Error was: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLNonTransientConnectionException: Connection closed by unknown interrupt.
Error Code: 40000
Call: SELECT COUNT("TIMERID") FROM "EJB__TIMER__TBL" WHERE ("APPLICATIONID" = ?)
    bind => [1 parameter bound]
Query: ReportQuery(name="countTimersByApplication" referenceClass=TimerState sql="SELECT COUNT("TIMERID") FROM "EJB__TIMER__TBL" WHERE ("APPLICATIONID" = ?)").|#]

[#|2012-10-30T16:26:10.071-0400|INFO|glassfish3.1.2|org.eclipse.persistence.session.file:/home/ayksolutions/glassfish3/glassfish/domains/domain1/applications/ejb-timer-service-app/WEB-INF/classes/___EJB__Timer__App|_ThreadID=61;_ThreadName=Thread-2;|Communication failure detected when attempting to perform read query outside of a transaction. Attempting to retry query. Error was: Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLNonTransientConnectionException: No current connection.
Error Code: 40000
Call: SELECT COUNT("TIMERID") FROM "EJB__TIMER__TBL" WHERE ("APPLICATIONID" = ?)
    bind => [1 parameter bound]
Query: ReportQuery(name="countTimersByApplication" referenceClass=TimerState sql="SELECT COUNT("TIMERID") FROM "EJB__TIMER__TBL" WHERE ("APPLICATIONID" = ?)").|#]

[#|2012-10-30T16:26:10.079-0400|WARNING|glassfish3.1.2|org.eclipse.persistence.session.file:/home/ayksolutions/glassfish3/glassfish/domains/domain1/applications/ejb-timer-service-app/WEB-INF/classes/___EJB__Timer__App|_ThreadID=61;_ThreadName=Thread-2;|Local Exception Stack: 
Exception [EclipseLink-4002] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.DatabaseException
Internal Exception: java.sql.SQLNonTransientConnectionException: No current connection.
Error Code: 40000
Call: SELECT COUNT("TIMERID") FROM "EJB__TIMER__TBL" WHERE ("APPLICATIONID" = ?)
    bind => [1 parameter bound]
Query: ReportQuery(name="countTimersByApplication" referenceClass=TimerState sql="SELECT COUNT("TIMERID") FROM "EJB__TIMER__TBL" WHERE ("APPLICATIONID" = ?)")
    at org.eclipse.persistence.exceptions.DatabaseException.sqlException(DatabaseException.java:333)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.processExceptionForCommError(DatabaseAccessor.java:1494)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:636)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.executeCall(DatabaseAccessor.java:535)
    at org.eclipse.persistence.internal.sessions.AbstractSession.basicExecuteCall(AbstractSession.java:1717)
    at org.eclipse.persistence.sessions.server.ServerSession.executeCall(ServerSession.java:566)
    at org.eclipse.persistence.sessions.server.ClientSession.executeCall(ClientSession.java:207)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:207)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeCall(DatasourceCallQueryMechanism.java:193)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.executeSelectCall(DatasourceCallQueryMechanism.java:264)
    at org.eclipse.persistence.internal.queries.DatasourceCallQueryMechanism.selectAllRows(DatasourceCallQueryMechanism.java:646)
    at org.eclipse.persistence.internal.queries.ExpressionQueryMechanism.selectAllRowsFromTable(ExpressionQueryMechanism.java:2611)
    at org.eclipse.persistence.internal.queries.ExpressionQueryMechanism.selectAllReportQueryRows(ExpressionQueryMechanism.java:2554)
    at org.eclipse.persistence.queries.ReportQuery.executeDatabaseQuery(ReportQuery.java:846)
    at org.eclipse.persistence.queries.DatabaseQuery.execute(DatabaseQuery.java:844)
    at org.eclipse.persistence.queries.ObjectLevelReadQuery.execute(ObjectLevelReadQuery.java:1040)
    at org.eclipse.persistence.queries.ReadAllQuery.execute(ReadAllQuery.java:392)
    at org.eclipse.persistence.queries.ObjectLevelReadQuery.executeInUnitOfWork(ObjectLevelReadQuery.java:1128)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.internalExecuteQuery(UnitOfWorkImpl.java:2871)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1516)
    at org.eclipse.persistence.internal.sessions.AbstractSession.retryQuery(AbstractSession.java:1586)
    at org.eclipse.persistence.sessions.server.ClientSession.retryQuery(ClientSession.java:593)
    at org.eclipse.persistence.internal.sessions.UnitOfWorkImpl.retryQuery(UnitOfWorkImpl.java:5464)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1552)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1498)
    at org.eclipse.persistence.internal.sessions.AbstractSession.executeQuery(AbstractSession.java:1463)
    at org.eclipse.persistence.internal.jpa.EJBQueryImpl.executeReadQuery(EJBQueryImpl.java:485)
    at org.eclipse.persistence.internal.jpa.EJBQueryImpl.getSingleResult(EJBQueryImpl.java:773)
    at com.sun.ejb.containers.TimerBean.countTimersByApplication(TimerBean.java:215)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.glassfish.ejb.security.application.EJBSecurityManager.runMethod(EJBSecurityManager.java:1052)
    at org.glassfish.ejb.security.application.EJBSecurityManager.invoke(EJBSecurityManager.java:1124)
    at com.sun.ejb.containers.BaseContainer.invokeBeanMethod(BaseContainer.java:5388)
    at com.sun.ejb.EjbInvocation.invokeBeanMethod(EjbInvocation.java:619)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.EjbInvocation.proceed(EjbInvocation.java:571)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.doAround(SystemInterceptorProxy.java:162)
    at com.sun.ejb.containers.interceptors.SystemInterceptorProxy.aroundInvoke(SystemInterceptorProxy.java:144)
    at sun.reflect.GeneratedMethodAccessor85.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at com.sun.ejb.containers.interceptors.AroundInvokeInterceptor.intercept(InterceptorManager.java:861)
    at com.sun.ejb.containers.interceptors.AroundInvokeChainImpl.invokeNext(InterceptorManager.java:800)
    at com.sun.ejb.containers.interceptors.InterceptorManager.intercept(InterceptorManager.java:370)
    at com.sun.ejb.containers.BaseContainer.__intercept(BaseContainer.java:5360)
    at com.sun.ejb.containers.BaseContainer.intercept(BaseContainer.java:5348)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandler.invoke(EJBLocalObjectInvocationHandler.java:214)
    at com.sun.ejb.containers.EJBLocalObjectInvocationHandlerDelegate.invoke(EJBLocalObjectInvocationHandlerDelegate.java:88)
    at $Proxy242.countTimersByApplication(Unknown Source)
    at com.sun.ejb.containers.EJBTimerService._destroyTimers(EJBTimerService.java:840)
    at com.sun.ejb.containers.EJBTimerService.destroyAllTimers(EJBTimerService.java:834)
    at org.glassfish.ejb.startup.EjbDeployer.clean(EjbDeployer.java:378)
    at org.glassfish.internal.data.EngineInfo.clean(EngineInfo.java:129)
    at org.glassfish.internal.data.EngineRef.clean(EngineRef.java:175)
    at com.sun.enterprise.v3.server.ApplicationLifecycle$1.actOn(ApplicationLifecycle.java:303)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:465)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:389)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:348)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:363)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1085)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:95)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1291)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1259)
    at com.sun.enterprise.v3.admin.AdminAdapter.doCommand(AdminAdapter.java:461)
    at com.sun.enterprise.v3.admin.AdminAdapter.service(AdminAdapter.java:212)
    at com.sun.grizzly.tcp.http11.GrizzlyAdapter.service(GrizzlyAdapter.java:179)
    at com.sun.enterprise.v3.server.HK2Dispatcher.dispath(HK2Dispatcher.java:117)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$Hk2DispatcherCallable.call(ContainerMapper.java:354)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:849)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:746)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1045)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:228)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722)
Caused by: java.sql.SQLNonTransientConnectionException: No current connection.
    at org.apache.derby.impl.jdbc.SQLExceptionFactory40.getSQLException(Unknown Source)
    at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)
    at org.apache.derby.impl.jdbc.Util.newEmbedSQLException(Unknown Source)
    at org.apache.derby.impl.jdbc.Util.noCurrentConnection(Unknown Source)
    at org.apache.derby.impl.jdbc.EmbedConnection.checkIfClosed(Unknown Source)
    at org.apache.derby.impl.jdbc.EmbedConnection.setupContextStack(Unknown Source)
    at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source)
    at org.apache.derby.impl.jdbc.EmbedConnection.prepareStatement(Unknown Source)
    at org.apache.derby.iapi.jdbc.BrokeredConnection.prepareStatement(Unknown Source)
    at com.sun.gjc.spi.base.ConnectionHolder.prepareStatement(ConnectionHolder.java:562)
    at com.sun.gjc.spi.jdbc40.ConnectionWrapper40.prepareCachedStatement(ConnectionWrapper40.java:255)
    at com.sun.gjc.spi.jdbc40.ConnectionWrapper40.prepareCachedStatement(ConnectionWrapper40.java:52)
    at com.sun.gjc.spi.ManagedConnection.prepareCachedStatement(ManagedConnection.java:993)
    at com.sun.gjc.spi.jdbc40.ConnectionWrapper40.prepareStatement(ConnectionWrapper40.java:173)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.prepareStatement(DatabaseAccessor.java:1474)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.prepareStatement(DatabaseAccessor.java:1423)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseCall.prepareStatement(DatabaseCall.java:697)
    at org.eclipse.persistence.internal.databaseaccess.DatabaseAccessor.basicExecuteCall(DatabaseAccessor.java:585)
    ... 84 more
Caused by: java.sql.SQLException: No current connection.
    at org.apache.derby.impl.jdbc.SQLExceptionFactory.getSQLException(Unknown Source)
    at org.apache.derby.impl.jdbc.SQLExceptionFactory40.wrapArgsForTransportAcrossDRDA(Unknown Source)
    ... 102 more
|#]

[#|2012-10-30T16:26:10.082-0400|WARNING|glassfish3.1.2|javax.enterprise.system.container.ejb.com.sun.ejb.containers|_ThreadID=61;_ThreadName=Thread-2;|EJB5184:A system exception occurred during an invocation on EJB TimerBean, method: public int com.sun.ejb.containers.TimerBean.countTimersByApplication(long)|#]
............. 
```

该错误出现在我的两台基于 *nix 的机器上，但是相同的应用程序版本通常可以从我基于 Windows 的开发人员机器上的数据库中的相同数据开始。如果数据库包含较少的数据，它在基于 *.nix 的机器上也没有问题。

该应用程序是用 Maven 构建的。它有几个模块，包括三个 Web 应用程序和使用 mysql RDBMS 的 EJB/JPA 模块。

服务器环境（应用程序无法启动）

```
OS: ubuntu 11.10 x64
AS: glassfish 3.2.1
java: 1.7.0_09-b05(initially it was 1.7.0_03, i've upgrade it with no effect) 
```

基于 Windows 的开发者机器（应用程序可以毫无问题地启动）

```
OS: win7 x64
AS: glassfish 3.2.1
java: 1.7.0_07-b10 
```

我有另一台带有 ubuntu x32 的服务器。与几乎相同的环境。该应用程序与所描述的基于 Ubuntu 的机器上存在相同的问题。我使用相同的 Glassfish 版本和相同的脚本在所有主机上配置它。

任何想法可能是什么原因。谢谢。

PS。我将尝试更新版本的GF，看看它是否能解决问题。Glassfish 升级到 3.1.2.2 版没有帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T15:45:44.020

这似乎是一个超时问题。可以在这里找到解决方案

[http://www.java.net/forum/topic/glassfish/glassfish/admin-thread-pool-idle-timeout#comment-826307](http://www.java.net/forum/topic/glassfish/glassfish/admin-thread-pool-idle-timeout#comment-826307)

# java - “java.sql.SQLException：SAVEPOINT _667166fe_13ab4b3e3de__8000 不存在”嵌套事务回滚中发生异常？

> ID：13150626
> 
> 赞同：1
> 
> 时间：2012-10-31T02:54:47.800
> 
> 标签：java, mysql, exception, jdbc

类用户{

```
public static void main(String arg[]) throws SQLException {
    Connection con = DBConnect.getConnection();
    con.setAutoCommit(false);
    PreparedStatement pstmt;
    System.out.println(con.getMetaData().supportsSavepoints()); // true
    try {
        pstmt = con.prepareStatement("insert into emp(emp_id, emp_name, salary, address, contact_number)values(?,?,?,?,?)");
        pstmt.setInt(1, 1);
        pstmt.setString(2, "a");
        pstmt.setDouble(3, 8);
        pstmt.setString(4, "s");
        pstmt.setInt(5, 9);
        pstmt.executeUpdate();
        con.commit();
        Savepoint sp = con.setSavepoint();
        if (myMethod(con)) {
            /**
             * I want to rollback the nested transaction if any error occur
             */
            con.rollback(sp);
        }
    } catch (SQLException e) {
        e.printStackTrace();
    }
}

public static boolean myMethod(Connection con) throws SQLException {

    PreparedStatement pstmt;
    try {
        pstmt = con.prepareStatement("insert into emp(emp_id, emp_name, salary, address, contact_number)values(?,?,?,?,?)");
        pstmt.setInt(1, 2);
        pstmt.setString(2, "G");
        pstmt.setDouble(3, 8);
        pstmt.setString(4, "G");
        pstmt.setInt(5, 10);
        pstmt.executeUpdate();
        con.commit();
    } catch (SQLException e) {
        e.printStackTrace();
    }
    return true;
} 
```

}

在上面的代码中，如果任何条件失败，我想回滚嵌套事务。我在提交第一个事务后创建了一个保存点。我遇到了一个异常

```
java.sql.SQLException: SAVEPOINT _667166fe_13ab4b3e3de__8000 does not exist
at com.mysql.jdbc.MysqlIO.checkErrorPacket(MysqlIO.java:2928)
at com.mysql.jdbc.MysqlIO.sendCommand(MysqlIO.java:1571)
at com.mysql.jdbc.MysqlIO.sqlQueryDirect(MysqlIO.java:1666)
at com.mysql.jdbc.Connection.execSQL(Connection.java:2988)
at com.mysql.jdbc.Statement.executeUpdate(Statement.java:935)
at com.mysql.jdbc.Statement.executeUpdate(Statement.java:873)
at com.mysql.jdbc.Connection.rollback(Connection.java:4777)
at com.User.main(User.java:31) 
```

我想知道嵌套事务是否会回滚？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T03:24:13.547

由于您已经在调用`con.commit();`before 和 after(in myMethod() method) `Savepoint sp = con.setSavepoint();`，因此没有`savepoint`抱怨。

`COMMIT removes all the save points.`请参阅此处的文档：

1.  [Oracle SAVEPOINT 语句](http://docs.oracle.com/cd/B19306_01/appdev.102/b14261/savepoint_statement.htm)
2.  [SQLite 保存点](http://www.sqlite.org/lang_savepoint.html)

`commit`如果您想设置保存点，请移除呼叫。

在代码的当前状态下，如果成功，所有事务都已提交，因此不可能回滚。

# c - C动态创建结构数组，其中包括可变大小的二维数组

> ID：13150630
> 
> 赞同：1
> 
> 时间：2012-10-31T02:55:47.890
> 
> 标签：c, arrays, dynamic, struct

> **可能重复：**
> [如何创建动态大小的结构数组？](https://stackoverflow.com/questions/260915/how-can-i-create-a-dynamically-sized-array-of-structs)

我是 C 新手，在线学习真的很有帮助，但现在我真的被困住了。我想要一个结构数组 ACout，大小为 ACcount

```
typedef struct{
int outcount;
int *lingoout;
double **likegoout;
} ACout; 
```

// int outcount 是数组 lingoout 的大小，likegoout 是一个二维数组，其中行数为 outcount，列数为 4

//int outcount 将被计算并且对于每个 ACout 都会不同。

```
int ACcount=0; //global, outside main

in main (){
 //HOW TO INITIALIZE THE ARRAY OF STRUCTS???
 //LIKE THIS?
  ACout* ACout_array = (ACout *) calloc (1, sizeof (ACout));
  if ( ACout_array == NULL) {
printf("Cannot allocate initial memory for data\n");
exit(1);
   }
 }

in some function {
ACcount++;
//int lingoout is computed here, as n; 
//also array lingout, as lin[n] 
//2d array likegoout, as likeout[n][4] is ready here

//how can I write a function to add one more structs to the array?
addarray(ACcount, AC_array);

//how can I put my calculated values to the structs?

 AC_array[ACcount]->outcount=n;
AC_array[ACcount]->lingoout=lin;
AC_array[ACcount]->likegoout=likeout;

}

void addACarray (ACout **ACout_array, int ACcount) {

  ACout *temp = (ACout*)realloc(*ACout_array, (ACcount * sizeof(ACout)));

  if(temp == NULL) {
    printf("Cannot allocate growarray memory!\n");
  }
  else
    *ACout_array = temp;
} 
```

谢谢你的帮助！非常感激！！！---海伦

# cross-compiling - 交叉编译，为什么“检查我们是否在交叉编译......不”？

> ID：13150631
> 
> 赞同：4
> 
> 时间：2012-10-31T02:55:52.320
> 
> 标签：cross-compiling, binutils

我正在尝试自己编译跨平台工具链。

当我编译binutils-2.22时，它成功但为什么出现“检查我们是否正在交叉编译......没有”？我想它应该是“是”，对吧？

我的主机是运行 ubuntu 的 i686，我的目标是 arm。

```
~/telink_linux/build-tools/binutils-2.22$ ./configure --prefix=/home/shuaihan/telink_linux/tools --target=arm-linux
checking build system type... i686-pc-linux-gnu
checking host system type... i686-pc-linux-gnu
checking target system type... arm-unknown-linux-gnu
...
checking whether we are cross compiling... no
...
configure: creating ./config.status
config.status: creating Makefile 
```

在此之后，我“make”和“makeinstall”，创建了 arm-linux-*。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T02:58:27.290

因为您没有交叉编译 binutils；您正在编译跨 binutils。如果您正在编译 ARM binutils*以在 ARM 上运行*，或者如果您正在编译 ARM binutils 以在*第三个*平台（i686-linux 和 arm-linux 都不是）上运行，那么该消息将显示“是”。

# python - 使用 QProcess 输出 youtube-dl

> ID：13150633
> 
> 赞同：1
> 
> 时间：2012-10-31T02:56:04.733
> 
> 标签：python, ubuntu, qt4, qprocess, youtube-dl

我对 python 很陌生，并且正在学习这种强大的语言。我设法编写了以下脚本。它确实得到了部分输出（只有两行），我不知道出了什么问题！请帮我。

```
#!/usr/bin/env python
#-*- coding: utf-8 -*-

from PyQt4 import QtCore, QtGui
from PyQt4.QtCore import (QProcess,QRect,SIGNAL,SLOT,QString,QStringList,qDebug)
from PyQt4.QtGui import (QMainWindow,QWidget,QPushButton,QTextEdit,QApplication)

class YTDL (QtGui.QMainWindow):
    def __init__ (self,parent=None):
        super(YTDL,self).__init__(parent)

        self.resize(400,300)
        self.setWindowTitle("Youtube-dl output using QProcess")

        self.__init_Components()
        self.__ui_event_handler()

    def __init_Components(self):
        self.proc = QProcess()
        self.cw = QWidget(self)

        self.btn = QPushButton(self.cw)
        self.btn.setText("Run")
        self.btn.setGeometry(QRect(270,10,110,27))

        self.te = QTextEdit(self.cw)
        self.te.setReadOnly(True)
        self.te.setOverwriteMode(False)
        self.te.setGeometry(QRect(10,40,380,170))

        self.setCentralWidget(self.cw)

    def __ui_event_handler(self):
        self.connect(self.btn, SIGNAL('clicked()'),self.Button_Clicked)

    def Button_Clicked(self):
        args = '-ct -f 18 --extract-audio --audio-quality 320k --audio-format mp3 -k http://www.youtube.com/watch?v=OiPO_TAAZPc'
        cmd = 'youtube-dl'
        self.proc.setWorkingDirectory("~/Videos/Folder1")
        self.connect(self.proc, SIGNAL('readyRead()'),self._read)
        self.proc.setOpenMode(self.proc.ReadWrite)
        self.proc.start(cmd ,args)
        if not self.proc.waitForStarted():
            exit(1)

    def _read(self):
        s = self.proc.readAllStandardOutput()
        qDebug (s)
        print (s)
        self.te.append(QString(s)) 

def main():
    import sys
    app = QApplication(sys.argv)
    ytdl = YTDL()
    ytdl.show()
    sys.exit(app.exec_())

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-03T04:29:53.337

我想我自己想通了。这是下面的所有改进版本。如果有什么需要改进的地方，我会欢迎任何建议。

类 YTDL (QtGui.QMainWindow): def **init** (self,parent=None): super(YTDL,self)。**初始化**（父）

```
 self.resize(400,350)
    self.setWindowTitle("Youtube-dl output using QProcess")

    self.__init_Components()
    self.__ui_event_handler()

def __init_Components(self):
    self.proc = QProcess()
    self.cw = QWidget(self)

    self.btn = QPushButton(self.cw)
    self.btn.setText("Run")
    self.btn.setGeometry(QRect(270,10,110,27))

    self.te = QTextEdit(self.cw)
    self.te.setReadOnly(True)
    self.te.setOverwriteMode(False)
    self.te.setGeometry(QRect(10,40,380,170))

    self.progbar = QProgressBar(self.cw)
    self.progbar.setGeometry(QRect(10,220,380,18))
    self.progbar.setRange(0,100)
    self.progbar.setValue(0)
    self.progbar.show()

    self.setCentralWidget(self.cw)

def __ui_event_handler(self):
    self.connect(self.btn, SIGNAL('clicked()'),self.Button_Clicked)
    self.connect(self.proc, SIGNAL('readyReadStandardOutput()'),self._read)
    self.connect(self.proc, SIGNAL('readyReadStandardError()'),self._readError)

def Button_Clicked(self):

    args = "-ct -f 18 --extract-audio --audio-quality 320k --audio-format mp3 -k http://www.youtube.com/watch?v=SjUrib_Gh0Y"
    cmd = "youtube-dl"
    cmd = cmd + " " + args 
    print (cmd)
    self.proc.setWorkingDirectory("~/Videos/Folder1")
    self.proc.setOpenMode(self.proc.ReadWrite)
    self.proc.start(cmd)
    self.proc.waitForStarted()

def _read(self):
    s = str(self.proc.readAllStandardOutput())

    download_progress_exp = re.compile(r'.\d+\.\d+\%', re.MULTILINE)
    progbarresult = download_progress_exp.findall(s)
    i = 0
    if progbarresult != []:
        for i in range(0,len(progbarresult)):
            self.progbar.setValue(float(progbarresult[i].strip("%")))
            self.te.append(QString(s))

def _readError(self):
    self.te.append(str(self.proc.readAllStandardError())) 
```

# python - 在 Python 中，如何存储列表的最后一个元素？

> ID：13150638
> 
> 赞同：0
> 
> 时间：2012-10-31T02:56:30.063
> 
> 标签：python, list

假设我有列表 x = []。我需要跟踪该列表中的最后一个元素。我可以使用变量 last = x[-1] 来做到这一点，但是如果 x 为空，这当然会产生索引错误。我该如何解释这一点，以便在 x 为空时不会出现错误？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-31T02:59:06.107

您可以使用[条件表达式](http://docs.python.org/2/reference/expressions.html#conditional-expressions)：

```
 last = x[-1] if x else None 
```

在空列表的情况下放置任何你想要的东西来代替 None。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T02:58:18.147

您可以尝试`x[-1:]`返回一个包含最后一个元素的列表，或者如果是空列表，则*返回*`x`一个空列表。当然，如果您想将该元素用于某事，您仍然需要检查它是否存在。

# validation - struts validate方法发生错误时如何更改默认输入？

> ID：13150640
> 
> 赞同：1
> 
> 时间：2012-10-31T02:56:35.863
> 
> 标签：validation, input, struts, action, forward

在 struts-config.xml 文件中，action 元素有一个 input 属性，当 actionForm 的 validate 方法返回一些错误时使用该属性。

```
<action
  path="/somepath"
  attribute="someForm"
  input="/some.jsp"
  name="someForm"
  parameter="status"
  scope="request"
  type="cn.mycompany.struts.action.SomeAction"/> 
```

但是我想在 validate 方法中发生错误时更改此输入属性，因为我有多个页面提交到此操作，并且我希望将其转发到当前提交页面。

我该怎么做，请帮助我。

# tomcat - 如何让tomcat在反向代理后面工作？

> ID：13150646
> 
> 赞同：1
> 
> 时间：2012-10-31T02:57:34.057
> 
> 标签：tomcat, nginx, reverse-proxy

我有一个 Tomcat 服务器，它在 $myip:8080 上运行良好。当我在 $myip:8080/test() 上提交表单时，它会跳转到 $myip:8080/test/get_result 并给出正确的结果。

为了在访问 $myip/services/test 时看到 $myip:8080/test 的结果，我重写了 nginx 配置中的 url 并使其指向 $myip:8080。配置如下所示：

```
location /services/ {
 rewrite /services/(.*) /$1 break;
  proxy_pass http://127.0.0.1:8080;
   proxy_set_header Host $host;
} 
```

可以访问 $myip/services/test，但是当我提交表单时，它会跳转到 $myip/services/get_result。我应该怎么做才能让它跳转到 $myip/services/test/get_result 呢？

谢谢

# c++ - 无法通过 cpp-netlib 发送发布请求

> ID：13150649
> 
> 赞同：0
> 
> 时间：2012-10-31T02:58:18.930
> 
> 标签：c++, cpp-netlib

我在 Visual Studio 2010 中使用 cpp-netlib-0.9.4。我有一个函数 make_header，如下所示：

```
http::client::request* Interface::make_request_header(const string& uri) {
    string url = host_ + uri;
    string json_type = "application/json";
    http::client::request* req = new http::client::request(url);
    req->add_header(make_pair("X-AUTH-TOKEN", token_));
    req->add_header(make_pair("Content-Type", json_type));
    req->add_header(make_pair("Accepts", json_type));
    return req;
} 
```

一个 get 请求工作得很好，类似于：

```
http::client client;
http::client::request* req = make_request_header(my_uri);
http::client::response res = client.get(*req); 
```

但是 POST 请求会引发异常/核心转储。否则我已经检查了多次，它似乎每次都在 chrome dev http 客户端扩展上工作。我用于发布请求的 URL 是：

```
http://myhost.com/commands?query=my query 
```

在上面的例子中，我尝试

```
http::client client;
http::client::request* req = make_request_header("http://myhost.com/commands?query=my query");
http::client::response res = client.post(*req);   // FAILS AT THIS STEP. 
```

任何想法为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T06:43:17.687

查询参数不能包含空格，您必须对其进行 URL 编码。

空格是`%20`您的查询应该看起来像

```
http://myhost.com/commands?query=my%20query 
```

# android - 如何使用简单的代码确定方形图像数组的操作

> ID：13150654
> 
> 赞同：1
> 
> 时间：2012-10-31T02:58:36.533
> 
> 标签：android, image, onclick, action, onclicklistener

我开始学习 Android 应用程序开发，所以我正在开发一些小应用程序来练习编程并更好地理解一些东西。

情况如下：

我有 25 个正方形图像作为 5x5 数组，我想指定不同的操作来单击每个图像。

我将图像 ID 声明为矩阵元素：

```
square11, square12, ... square15
square21, square22, ... square25
  ...      ...            ...
square51, square52, ... square55 
```

我试图做这样的事情：

```
public void onClick(View v){
    switch(v.getId()){
        case R.id.square11:
            //do something
            break;
        case R.id.square12:
            //do something
            break;
        case R.id.square13:
            //do something
            break;
        case R.id.square14:
            //do something
            break;
        //and all other cases...
    }
} 
```

但显然它不起作用。我错过了什么`OnClickListener`吗？

可能这是一个新手的问​​题，但我希望有人能提供帮助。我真的查看了其他代码，但它们似乎没有帮助。

问题是，你知道我做错了什么吗？更好的是，您知道是否有更好更清洁的方法来做到这一点？

非常感谢！

此致，

拉斐尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:18:01.720

你调用这些视图的 setOnClickListener 方法吗？

我认为使用[`GridView`](http://developer.android.com/reference/android/widget/GridView.html)and[`AdapterView.OnItemClickListener`](http://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html)是一种更好的方法。

# mingw - 在 Linux for Windows 上交叉编译 gtkmm 会出现错误“无法识别的选项 '-pthread'”

> ID：13150658
> 
> 赞同：5
> 
> 时间：2012-10-31T02:59:08.467
> 
> 标签：mingw, cross-compiling, gtkmm, mingw-w64

我正在尝试编译简单的“Hello World！” gtkmm[教程](http://developer.gnome.org/gtkmm-tutorial/3.0/sec-basics-simple-example.html.en)中提供的 gtkmm 源代码，在 Linux 上使用 mingw 制作 Windows 可执行文件。

我可以通过以下命令行执行编译的源代码：`g++ main.cpp -o bin `pkg-config gtkmm-3.0 --cflags --libs``在 linux 上，一切**正常**，但是当我尝试使用时`i686-w64-mingw32-g++ main.cpp -o bin `pkg-config gtkmm-3.0 --cflags --libs``，它无法显示此错误：

```
i686-w64-mingw32-g++: error: unrecognized option ‘-pthread’ 
```

有什么我想念的并且必须在编译之前安装吗？

此外，是否有一个简洁的交叉编译教程（尤其是关于 gtk+ 或 gtkmm）？我搜索了很多，但没有什么有用的。

# java - Android程序写入模拟器但不写入手机

> ID：13150659
> 
> 赞同：2
> 
> 时间：2012-10-31T02:59:16.667
> 
> 标签：java, android

我正在尝试编写一个 Android 程序来接受输入，然后将数据写入手机内部存储器上的文件。当我在模拟器上执行我的程序时，它会按照我的预期创建一个文件，但是当我尝试在我的手机上执行它时，文件似乎没有被创建。我在这个网站上环顾四周，似乎在任何地方都找不到解决我的问题的方法（一些类似的，但对我没有任何帮助）我希望你们能就我的问题向我提供建议做错了。

```
FileOutputStream fos = null;
String x = "Sample String";
    try{
            fos = openFileOutput("answers.txt", MODE_PRIVATE);
            fos.write(x.getBytes());

        } catch (IOException e) {
            e.printStackTrace();
        }    

    try {
           fos.close();
         } catch (IOException e) {
            e.printStackTrace();
    } 
```

在模拟器上，我可以在 DDMS 中的“data/data/com.example.helloandroid/files/answers.txt”中找到该文件。在电话上，如果我尝试在 DDMS 中打开数据文件夹，它会显示它是一个空目录。我已经在我的清单中添加了这一行：

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

我似乎想不出还有什么我可能做错的事情。提前感谢您的帮助，不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:17:31.613

您的代码一切正常，您在手机中看不到文件的唯一原因是：您的手机不是 Root！根您的手机，然后只需使用 RootExplorer（或任何其他应用程序）也可以在与模拟器相同的目录中查看您的结果！除此之外，为什么不打印文本？确保您的文件是在 fos.close() 添加 bufferReader 后创建的，并尝试将数据放入 String 然后打印它！然后你可以在 LogCat 中看到结果

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T04:47:38.893

您的代码很好，但就像其他人所说的 Eclipse 中的 DDMS 没有正确访问 /data/data 所在的内部存储。[您可以在http://developer.android.com/guide/topics/data/data-storage.html](http://developer.android.com/guide/topics/data/data-storage.html)找到对不同类型 Android 存储的参考

获得访问权限的一种方法是根您的设备。

另一种方法是安装 userdebug 版本。

然而，最简单的方法是通过[adb](http://developer.android.com/tools/help/adb.html)`run-as`的未记录选项。这允许您访问应用程序拥有的文件，即使它们位于内部存储中。

要验证是否正在创建您感兴趣的文件，请在命令行输入：

```
adb shell run-as com.example.helloandroid ls -l /data/data/com.example.helloandroid/files/ 
```

要获取特定文件的内容，请在命令行中输入：

```
adb shell run-as com.example.helloandroid cat /data/data/com.example.helloandroid/files/answers.txt 
```

# php - 这段代码对 SQL 注入安全吗

> ID：13150660
> 
> 赞同：3
> 
> 时间：2012-10-31T02:59:20.563
> 
> 标签：php, mysql, pdo

我想让我的代码尽可能安全地免受任何类型的攻击，我希望对我在下面使用的简单代码有所了解。如果它易受攻击，如何使其更安全以及为什么会很棒的任何指示。我已经读过，使用准备好的语句是防止攻击的最佳实践。

```
<?php 

    try {
    $conn = new PDO('mysql:host=localhost;dbname=test', 'user', 'XXXXX');
    $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $stmt = $conn->prepare('INSERT INTO people (name, email) VALUES (:name, :email)');

    $stmt->execute(array(':name' => $_POST['name'], ':email' => $_POST['email']));

    #If one or more rows were returned...

    } catch(PDOException $e){
        echo'ERROR: ' . $e->getMessage();
    }
    echo "Added $_POST[name] with email $_POST[email] succsessfully";
    $conn = null;
    ?> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T03:03:22.033

看起来您可以安全地避免 SQL 注入，但您现在在 echo 中遇到了 XSS 问题。确保在回显之前始终清理/转义用户输入。

```
echo "Added $_POST[name] with email $_POST[email] succsessfully"; 
```

应该成为

```
echo "Added" . htmlspecialchars($_POST['name']) . "with email" . htmlspecialchars($_POST['email']) . "succsessfully"; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-31T03:02:19.373

由于准备好的语句，它是 SQL 注入安全的。但请记住，在浏览器中回显这些变量可能会导致 XSS 问题。最好始终确保您的用户输入是干净的，通常 htmlspecialchars 足以输出，更好的是在将用户输入提交到数据库之前清理用户输入。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-31T03:05:12.333

是的，在 SQL 查询中使用参数可以降低 SQL 注入攻击的可能性。但我会清理从 POST 收到的数据，还要检查它是否存在。

```
$name = isset($_POST['name']) ? htmlspecialchars($_POST['name']) : NULL;
$email = isset($_POST['email']) ? htmlspecialchars($_POST['email']) : NULL;
$stmt->execute(array(':name' => $name, ':email' => $email)); 
```

请记住，如果您传递 null，则这些数据库字段应接受 null 值

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-31T03:12:13.267

出于习惯，我也会考虑使用[bindParam](http://php.net/manual/en/pdostatement.bindparam.php) .. 我的理解是 PDO 会进行类型检查（这对 PARAM_STR 并不重要），这可能会使您免受其他一些攻击向量的影响。

（并添加 XSS sanitizing Skatox、Ryan 和 John 提及。）

```
$name = isset($_POST['name']) ? htmlspecialchars($_POST['name']) : NULL;
$email = isset($_POST['email']) ? htmlspecialchars($_POST['email']) : NULL;
stmt = bindParam(':name',$name, PDO::PARAM_STR);
stmt = bindParam(':email',$email, PDO::PARAM_STR);
$stmt->execute(); 
```

# java - 为什么 int 没有改变？爪哇

> ID：13150667
> 
> 赞同：0
> 
> 时间：2012-10-31T02:59:57.320
> 
> 标签：java

有人可以告诉我如何在以下代码中获取 int x 的值：当我左右移动方块时，Test 的输出保持为 500。

我希望测试中的线程在每次循环时都获取 x 的值，但 x 始终为 500（来自线程），即使 x 的值在 Drawing.java 中发生变化。请帮我解决一下这个。

```
package block;

public class Test extends Drawing implements Runnable{
Thread collision = new Thread(this);

public Test() {
    collision.start();
}

@Override
public void run() {

    while(true) {
        System.out.println(x);
    }
}

} 
```

* * *

```
package block;

import java.awt.Canvas;
import java.awt.Color;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.util.logging.Level;
import java.util.logging.Logger;

public class Drawing extends Canvas implements Runnable, KeyListener{
Thread thread = new Thread(this);

int x = 500;
int y = 540;
public Drawing() {        
    setSize(1000, 800);
    addKeyListener(this);
    thread.start();
}

public void update(Graphics g) {
    g.setColor(Color.WHITE);
    g.fillRect(0, 0, 1000, 700);
    paint(g);
}

public void paint(Graphics g) {
    g.setColor(Color.cyan);
    g.fillRect(x, y, 50, 50);
}

@Override
public void run() {
    while(true) {
        repaint();
        try {
            Thread.sleep(100);
        } catch (InterruptedException ex) {
            Logger.getLogger(Drawing.class.getName()).log(Level.SEVERE, null, ex);
        }

    }

}

@Override
public void keyTyped(KeyEvent ke) {

}

@Override
public void keyPressed(KeyEvent ke) {
    if(ke.getKeyCode() == KeyEvent.VK_LEFT) {
        x -= 5;
    }
    if(ke.getKeyCode() == KeyEvent.VK_RIGHT) {
        x += 5;
    }
}

@Override
public void keyReleased(KeyEvent ke) {

}

} 
```

编辑： - - - - - - - - - -

```
package block;

import javax.swing.JFrame;

public class Block extends JFrame{

    Test test = new Test();

    public Block() {
        setSize(1000, 700);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLocationRelativeTo(null);        
        add(new Drawing());        
        setVisible(true);
        createBufferStrategy(2);
    }

    public static void main(String[] args) {
        new Block();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:12:01.120

您正在创建多个实例，`x`因为您没有正确使用继承。当您调用`new Test()`时，将创建 a 的一个实例`Test`（其中包含 a `Drawing`，其中包含一个 member `x`），然后调用 to`new Drawing()`创建 a 的另一个实例`Drawing`（其中包含一个*不同*的member `x`）。

要解决此问题，您可以将对对象的*引用*传递给构造函数，并通过引用访问成员。`Drawing``Test``x`

# c++ - C ++：在字符串中移动语义#append

> ID：13150670
> 
> 赞同：6
> 
> 时间：2012-10-31T03:00:29.823
> 
> 标签：c++, c++11, move-semantics

我需要将一些字符串合并为一个，并且出于有效的原因，我想在这种情况下使用移动语义（当然这些字符串将不再使用）。所以我尝试了

```
#include <iostream>
#include <algorithm>
#include <string>

int main()
{
    std::string hello("Hello, ");
    std::string world("World!");
    hello.append(std::move(world));
    std::cout << hello << std::endl;
    std::cout << world << std::endl;
    return 0;
} 
```

我想它会输出

```
Hello, World!
## NOTHING ## 
```

但它实际上输出

```
Hello, World!
World! 
```

`append`如果替换为，将导致相同的结果`operator+=`。这样做的正确方法是什么？

我在 debian 6.10 上使用 g++ 4.7.1

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-31T03:04:18.773

您不能将 a`string`移入另一个的*一部分*`string`。这将需要新`string`的有效地拥有两个存储缓冲区：当前的和新的。然后它必须神奇地使这一切都是连续的，因为 C++11 需要`std::string`在*连续的*内存中。

简而言之，你不能。

# javascript - 玉扩展和包含无缘无故覆盖文件

> ID：13150674
> 
> 赞同：0
> 
> 时间：2012-10-31T03:00:41.890
> 
> 标签：javascript, pug

SlideBase.jade

```
.slideWrap
    .slideInner
         block slides 
```

slideSet1.jade

```
extends SlideBase

append slides
    .slide set1slide1
    .slide set1slide2
    .slide set1slide3 
```

slideSet2.jade

```
extends SlideBase

append slides
    .slide set2slide1
    .slide set2slide2
    .slide set2slide3 
```

输出.jade

```
#mySlides
    p some copy
    #slideZone
          include slideSet1.jade
          include slideSet2.jade 
```

预期结果：

```
<div id="mySlides>
    <p>some copy</p>
    <div id="slideZone>
         <div class="slideWrap>
              <div class="slideInner>
                    <div class="slide">set1slide1</div>
                    <div class="slide">set1slide2</div>
                    <div class="slide">set1slide3</div>
              </div>
         </div>
         <div class="slideWrap>
              <div class="slideInner>
                    <div class="slide">set2slide1</div>
                    <div class="slide">set2slide2</div>
                    <div class="slide">set2slide3</div>
              </div>
         </div>
    </div>
</div> 
```

实际结果：

```
<div id="mySlides>
    <p>some copy</p>
    <div id="slideZone>
         <div class="slideWrap>
              <div class="slideInner>
                    <div class="slide">set1slide1</div>
                    <div class="slide">set1slide2</div>
                    <div class="slide">set1slide3</div>
              </div>
         </div>
         <div class="slideWrap>
              <div class="slideInner>
                    <div class="slide">set1slide1</div>
                    <div class="slide">set1slide2</div>
                    <div class="slide">set1slide3</div>
              </div>
         </div>
    </div>
</div> 
```

Jade 编译器不会获取 slideSet2.jade，而是在其位置重复 slideSet1.jade。我在这里做错了什么？

**披露：**

我正在使用 Jade 0.27.2 版的 Codekit 运行；并且任何接受的答案都可以解决为什么它在我的环境中不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T07:50:02.843

此问题已在较新版本的翡翠中得到修复。CodeKit 的版本应该是最新的。

# google-api - 仅选择时间戳对应于当前月份的行

> ID：13150675
> 
> 赞同：0
> 
> 时间：2012-10-31T03:01:06.333
> 
> 标签：google-api, google-sheets

我开始尝试使用 Google SpreadSheets 作为数据库进行一些实验，为此我从不同来源收集数据并通过电子表格 API 将它们插入工作表中。

每行都有一个值（B 列）和一个时间戳（A 列）。

```
+---------------------+------+
|        ColA         | ColB |
+---------------------+------+
| 13/10/2012 00:19:01 |   42 |
| 19/10/2012 00:29:01 |  100 |
| 21/10/2012 00:39:01 |   23 |
| 22/10/2012 00:29:01 |    1 |
| 23/10/2012 00:19:01 |   24 |
| 24/10/2012 00:19:01 |    4 |
| 31/10/2012 00:19:01 |    2 |
+---------------------+------+ 
```

我想要做的是以编程方式将 B 列中所有行的总和添加到不同的单元格中，其中 A 列等于当前月份。

有什么我可以使用的功能吗？或者任何人都可以指出我如何创建一个可能做这样的事情的自定义函数的正确方向？我知道如何使用 MySQL 来做到这一点，但我找不到 Google SpreadSheets 的任何东西

在此先感谢您提供正确方向的任何提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:29:09.480

原生电子表格功能可以吗？

`=ArrayFormula(SUMIF(TEXT(A:A;"MM/yyyy");TEXT(GoogleClock();"MM/yyyy");B:B))`

# batch-file - 在批处理文件中使用 errorlevel 来了解程序是否正常退出

> ID：13150676
> 
> 赞同：11
> 
> 时间：2012-10-31T03:01:31.510
> 
> 标签：batch-file

我们有一个程序偶尔会崩溃。客户从计划任务运行程序。当程序以某个参数运行时，程序作为接口引擎运行，创建一个文件，然后将该文件ftp'到另一个服务器，供另一个程序导入。

我想知道我是否可以让计划任务改为运行批处理文件。批处理文件将运行程序并`errorlevel`在程序退出时进行检查。如果`errorlevel`不等于零，则批处理文件将再次运行程序。有人看到我`errorlevel`在批处理文件中使用的计划有问题吗？

这是批处理文件的示例：

```
:start    
myPgm.exe intfc    
if errorlevel <> 0 then start 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-06-12T22:10:35.077

我会这样写：

```
:start
myPgm.exe intfc
IF %errorlevel% NEQ 0 GOTO :error
GOTO :end
:error
echo There was an error.
EXIT 1
:end
echo End.
EXIT 0 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T03:45:05.400

你的 IF 语句是错误的。它应该读

```
if %errorlevel% neq 0 goto start 
```

或者您的脚本可以读取

```
:start
myPgm.exe intfc || goto start 
```

# css - 纵向模式下移动设备页面底部的间隙

> ID：13150682
> 
> 赞同：2
> 
> 时间：2012-10-31T03:03:01.863
> 
> 标签：css, android-layout, mobile

当我在计算机上浏览我的网站时，所有主流浏览器中的一切看起来都很好，但是，当我在 Android 手机上查看时，页脚下方有一个巨大的空白。这只发生**在纵向模式**和所有安卓浏览器中。当我以横向模式查看它时，所有浏览器中的差距都消失了。

我尝试使用视口元标记“播放”，但没有帮助。

我网站的宽度：1300 像素和高度：100%。此外，页脚有 padding-bottom:0; 边距底部：0；

什么可能导致此问题仅在纵向模式下发生？

更新：页面的高度似乎不足以填满我的手机的整个屏幕，所以有这个差距。当我浏览页面时，它会根据网站宽度完全缩小。如何让它根据站点的高度放大，从而消除底部间隙？

请帮忙

PS 不幸的是，我无法为您提供该网站的链接，因为它位于本地服务器上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T21:35:36.407

好，朋友们。我设法修复它。可能不是世界上最好的解决方案，但总比没有好。所以我所做的是通过使用视口 minimum-scale=0.6 强制最小缩放。

此修复后没有底部间隙。

# cuda - 在将 CUDA 与 MATLAB 一起使用时，是否可以从 mex 接口分配固定内存？

> ID：13150685
> 
> 赞同：6
> 
> 时间：2012-10-31T03:03:29.240
> 
> 标签：cuda, mex

我读[了这个 pdf](http://www.systematics.co.il/mathworks/News/Pdf/2009/nvidia.pdf)并且我已经使用 CUDA 和 mex 很长一段时间了。我想知道 Fermi 和 Kepler 等新一代 GPU 是否允许从 MATLAB 分配固定内存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T00:39:26.440

我试过[了](http://codepad.org/9wpuiNTB) ，结果很好。因此，我相信在将 CUDA 与 MATLAB 一起使用时，可以从 mex 接口分配固定内存。

# xna - XNA spritebatch 和 primative 使用不同的轴具有相同的效果

> ID：13150688
> 
> 赞同：0
> 
> 时间：2012-10-31T03:03:55.060
> 
> 标签：xna, directx, monogame

我正在使用 monogame 3.0 (XNA-C#) 开发横向卷轴游戏。我正在使用 TriangleStrip 来绘制地面，并使用 spritebatch 来绘制栅栏。我希望栅栏在地面上，但它似乎使用了不同的轴（负而不是正）。为了对齐，我需要翻转栅栏并使用负 x 和 y。精灵和图元都使用相同的视图矩阵和项目。

为什么 spritebatch 在使用相同矩阵时需要负轴，而图元使用正轴？

```
protected override void Initialize()
{
    viewMatrix = Matrix.CreateLookAt(new Vector3(0, 0, 1), Vector3.Zero, new Vector3(0,1, 0));
    projectionMatrix = Matrix.CreateOrthographicOffCenter(0,GraphicsDevice.Viewport.Width,  
                        0, GraphicsDevice.Viewport.Height, 0f, 200f) *Matrix.CreateScale(new Vector3(.5f, .5f, 1f));

    GraphicsDevice.RasterizerState.CullMode = CullMode.None;

    _groundBasicEffect = new BasicEffect(GraphicsDevice);
    _groundBasicEffect.View = viewMatrix;
    _groundBasicEffect.Projection = projectionMatrix;
    _groundBasicEffect.VertexColorEnabled = true;
    _groundBasicEffect.World = world;

    _fenceBasicEffect = new BasicEffect(GraphicsDevice);
    _fenceBasicEffect.View = Matrix.CreateLookAt(new Vector3(0, 0, 1), Vector3.Zero, new Vector3(0,1,  0));
    _fenceBasicEffect.Projection = projectionMatrix;
    _fenceBasicEffect.TextureEnabled = true;
    _fenceBasicEffect.World = world;     

    base.Initialize();
}
protected override void LoadContent()
{
        _spriteBatch = new SpriteBatch(GraphicsDevice);
        fenceTexture = this.Content.Load<Texture2D>(@"Fence1");
        vertexData = new VertexPositionColor[8];
        vertexData[0] = new VertexPositionColor(new Vector3(0, 0, 0), Color.Black);
        vertexData[1] = new VertexPositionColor(new Vector3(0, 400, 0), Color.Black);
        vertexData[2] = new VertexPositionColor(new Vector3(200, 0, 0), Color.Black);
        vertexData[3] = new VertexPositionColor(new Vector3(200, 400, 0), Color.Black);
        vertexData[4] = new VertexPositionColor(new Vector3(300, 0, 0), Color.Black);
        vertexData[5] = new VertexPositionColor(new Vector3(300, 430, 0), Color.Black);
        vertexData[6] = new VertexPositionColor(new Vector3(1200, 0, 0), Color.Black);
        vertexData[7] = new VertexPositionColor(new Vector3(1200, 430, 0), Color.Black);
        vertexBuffer = new VertexBuffer(GraphicsDevice, typeof(VertexPositionColor), vertexData.Length, BufferUsage.None);
        vertexBuffer.SetData(vertexData);

    }
protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.White);
        GraphicsDevice.SetVertexBuffer(vertexBuffer);

        _groundBasicEffect.CurrentTechnique.Passes[0].Apply();
        GraphicsDevice.DrawUserPrimitives<VertexPositionColor>(PrimitiveType.TriangleStrip, vertexData, 0, vertexData.Length -2);

        _spriteBatch.Begin(0, null, null, null, null, _fenceBasicEffect);
        _spriteBatch.Draw(fenceTexture, Vector2.Zero, new Rectangle(0, 0, 1130, 221), Color.White, 0, new Vector2(0, 200), 1, SpriteEffects.None, 0);
        _spriteBatch.End();
        base.Draw(gameTime);
    } 
```

**它看起来如何...** ![它看起来如何](../Images/401d901233904aa2d0c5383657318ab8.png)

**我希望它看起来如何...** ![我希望它看起来如何](../Images/0275748e62879c7206825a437faec907.png)

为了获得这种外观，我需要将栅栏的绘制更改为...

```
_spriteBatch.Draw(fenceTexture, Vector2.Zero, new Rectangle(0, 0, 1130, 221), Color.White, 0, new Vector2(0, -400), 1, SpriteEffects.FlipVertically, 0); 
```

# android - MAC地址更改后Android无法连接到wifi

> ID：13150690
> 
> 赞同：2
> 
> 时间：2012-10-31T03:04:23.783
> 
> 标签：android, wifi, mac-address

我有一个运行 primos Rom 的 HTC 启发的植根 android。在我使用“ip link set wlan0 address”更改我的 MAC 地址后，我的手机将不再连接到受密码保护的 WiFi。这可以解决吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T07:26:38.430

密码保护与 MAC 地址更改无关。

> 1.  验证您的新 MAC 地址的格式是否有效： [http ://en.wikipedia.org/wiki/MAC_address#Address_details](http://en.wikipedia.org/wiki/MAC_address#Address_details)
> 2.  检查您的路由器设置并确保您没有启用 MAC 过滤路由器可能已配置为仅接受预定义的 MAC 地址或它们的范围。
> 3.  刷新你的 arp 缓存。这将释放旧 MAC 地址和分配的 IP 之间可能存在的任何绑定。
> 4.  释放和更新您的 IP。

顺便说一句，MAC 地址是与制造时特定设备相关的属性。通常，您不应该更改它。

# java - 在 JSF 2.0 中使用带有验证的 selectOneMenu

> ID：13150691
> 
> 赞同：1
> 
> 时间：2012-10-31T03:04:24.250
> 
> 标签：java, jsf-2

我正在尝试使用 JSF 2.0 构建一个下拉菜单，并在使用在菜单中选择“请选择”提交表单时添加验证。

```
<h:selectOneMenu id="templateMenu" value="#{bean.list}" required="true" requiredMessage="Please select a value.">
    <f:selectItem itemLabel="Please Select" noSelectionOption="true" />
    <f:selectItem itemLabel="Item01" itemValue="1"/>
    <f:selectItem itemLabel="Item02" itemValue="2"/>
    <f:selectItem itemLabel="Item03" itemValue="3"/>
    <f:selectItem itemLabel="Item04" itemValue="4"/>
    <f:validateRequired/>
</h:selectOneMenu> 
```

但是，当我提交选择了“请选择”的页面时，验证不会触发，它只是停留在同一页面中。

如果有人知道发生了什么请你能帮我吗？

非常感谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T03:44:14.373

您需要`h:message`您的 selectOneMenu。这将显示 of 的`requiredMessage`消息`selectOneMenu`。

```
<h:message for="templateMenu"/>
<h:selectOneMenu id="templateMenu" value="#{csvUploadBean.selectedTemplate}"  required="true" requiredMessage="This value is required.">
    .....
</h:selectOneMenu> 
```

# php - php文件下载的输出缓冲

> ID：13150692
> 
> 赞同：0
> 
> 时间：2012-10-31T03:04:29.090
> 
> 标签：php, http-headers, download

我可以做这样的事情吗？

```
ob_start();
header("Content-Type: application/msword");
header("Content-Disposition: attachment; filename=".$title);
header("Content-Length: ".$size);
header("Content-Transfer-Encoding: binary");
readfile($path);
ob_end_flush(); 
```

目前我正在下载正确命名的文件，但文件的内容是包含上述代码的 php 的 html 输出。

我已经验证了 $path 是正确的。错误的 $size 会导致这种情况发生吗？我也尝试在 ob_start() 之后直接使用 ob_flush()。

编辑：下面的当前代码：

```
if (file_exists($path)){
    ob_start();
    header("Content-Type: application/msword");
    header("Content-Disposition: attachment; filename=".$title);
    header("Content-Length: ".filesize($path));
    header("Content-Transfer-Encoding: binary");
    readfile($path);
    ob_end_flush();
    die();
    } else die ("Not Found"); 
```

上面的代码会导致同样的问题。文件已下载，命名正确，显然存在且大小正确，但文件的内容是页面的 html 输出。

提前致谢

我刚刚注意到这是在下载（错误）文件的最后：“int（14）内容”

但我并没有故意在我的代码中的任何地方输出这个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:07:42.627

也许一些调试可能会有所帮助：

```
if (file_exists($path)) {
  ob_start();
  header("Content-Type: application/msword");
  header("Content-Disposition: attachment; filename=".$title);
  header("Content-Length: ".filesize($path));
  header("Content-Transfer-Encoding: binary");
  readfile($path);
  ob_end_flush();
  die(); // To not send the HTML afterwards
} else die("Not found"); 
```

# ruby-on-rails - “找不到 Rake” - 在 OS X 10.8 上安装新的 Ruby on Rails

> ID：13150693
> 
> 赞同：0
> 
> 时间：2012-10-31T03:04:34.937
> 
> 标签：ruby-on-rails, ruby, xcode, rake, rvm

```
尝试在 OS X 10.8 上安装 RoR。Mac 和 RoR 的新手！

遵循这里的指示：
http://www.justinball.com/2012/10/22/install-rvm-on-mac-osx-mountain-lion/

已安装 XCode、命令行工具、XQuartz、Homebrew、gcc、最新 RVM，已执行
“rvm pkg install openssl”，最后是“rvm install 1.9.3”

在此过程中出现了一些错误消息，我稍后会提供。
但是，根据以下情况，安装似乎成功：

$ 类型 rvm | 头-n1
rvm 是一个函数
$导轨-v
导轨 3.2.8
红宝石--版本
ruby 1.9.3p286（2012-10-12 修订版 37165）[x86_64-darwin12.2.0]

安装过程中的错误/警告包括：
警告：无法在 mxcl/master/vim 上点击 homebrew/dupes/vim
获取 ruby​​ 解释器时出错。停止安装。

创建了一个名为“agile”的新目录，更改为该目录并执行：
“轨道新演示”
在输出的第一行得到“`mkdir': Permission denied”

然后尝试“sudo rails new demo”
在输出的第一行得到“Could not find Rake”

（本文末尾提供了完整输出。）

尝试了各种方法来查看 rake、rails、ruby 或 rvm 是否有问题，但似乎一切都恢复正常了。

Michaels-MacBook-Pro:敏捷 mh$ rake --version
耙子，版本 0.9.2.2
Michaels-MacBook-Pro：敏捷 mh$ whereis rake
/usr/bin/rake
Michaels-MacBook-Pro:agile mh$ which rake
/Users/mh/.rvm/gems/ruby-1.9.3-p286@global/bin/rake
Michaels-MacBook-Pro：敏捷 mh$ 哪个 gem
/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/gem
Michaels-MacBook-Pro：敏捷 mh$ rvm 信息

红宝石-1.9.3-p286：

  系统：
    uname: "Darwin Michaels-MacBook-Pro.local 12.2.0 Darwin Kernel Version 12.2.0: Sat Aug 25 00:48:52 PDT 2012; root:xnu-2050.18.24~1/RELEASE_X86_64 x86_64"
    系统：“下载”
    bash: "/bin/bash => GNU bash，版本 3.2.48(1)-release (x86_64-apple-darwin12)"
    zsh: "/bin/zsh => zsh 4.3.11 (i386-apple-darwin12.0)"

  转速：
    版本：“ rvm 1.16.17 () by Wayne E. Seguin，Michal Papis [https://rvm.io/]”
    更新：“7 小时 52 分 30 秒前”

  红宝石：
    翻译：“红宝石”
    版本：“1.9.3p286”
    日期：“2012-10-12”
    平台：“x86_64-darwin12.2.0”
    补丁级别：“2012-10-12 修订版 37165”
    full_version：“ruby 1.9.3p286（2012-10-12 修订版 37165）[x86_64-darwin12.2.0]”

  家园：
    宝石：“/Users/mh/.rvm/gems/ruby-1.9.3-p286”
    红宝石：“/Users/mh/.rvm/rubies/ruby-1.9.3-p286”

  二进制文件：
    红宝石：“/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/ruby”
    irb：“/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/irb”
    宝石：“/Users/mh/.rvm/rubies/ruby-1.9.3-p286/bin/gem”
    耙子：“/Users/mh/.rvm/gems/ruby-1.9.3-p286@global/bin/rake”

  环境：
    路径：“/Users/mh/.rvm/gems/ruby-1.9.3-p286/bin:/Users/mh/.rvm/gems/ruby-1.9.3-p286@global/bin:/Users/mh/ .rvm/rubies/ruby-1.9.3-p286/bin:/Users/mh/.rvm/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/opt /X11/bin:/usr/local/git/bin"
    GEM_HOME：“/Users/mh/.rvm/gems/ruby-1.9.3-p286”
    GEM_PATH: "/Users/mh/.rvm/gems/ruby-1.9.3-p286:/Users/mh/.rvm/gems/ruby-1.9.3-p286@global"
    MY_RUBY_HOME：“/Users/mh/.rvm/rubies/ruby-1.9.3-p286”
    IRBRC：“/Users/mh/.rvm/rubies/ruby-1.9.3-p286/.irbrc”
    红宝石：“”
    宝石：“”

Michaels-MacBook-Pro：敏捷 mh$ 类型 rvm | 头-n1
rvm 是一个函数

==================================================== ==================
Michaels-MacBook-Pro:agile mh$ rails new demo
      创造  
/Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:247:in `mkdir': 权限被拒绝 - /Users/mh/agile/demo (Errno ::EACCES）
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:247:in `fu_mkdir'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:221:in `block (2 levels) in mkdir_p'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:219:in `reverse_each'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:219:in `block in mkdir_p'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:205:in `each'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/fileutils.rb:205:in `mkdir_p'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:51:in `block in invoke!'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:133:in `call'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:133:in `invoke_with_conflict_check'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:50:in `invoke!'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions.rb:95:in `action'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/actions/empty_directory.rb:15:in `empty_directory'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/lib/rails/generators/app_base.rb:103:in `create_root'
    来自 (eval):1:in `create_root'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/task.rb:27:in `run'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:120:in `invoke_task'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `block in invoke_all'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `each'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `map'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/invocation.rb:126:in `invoke_all'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/group.rb:238:in `dispatch'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/thor-0.16.0/lib/thor/base.rb:425:in `start'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/lib/rails/commands/application.rb:38:in `'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/lib/rails/cli.rb:15:in `'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/custom_require.rb:36:in `require'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/gems/railties-3.2.8/bin/rails:7:in `'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/rails:19:in `load'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/rails:19:in `'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `eval'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `'
Michaels-MacBook-Pro:agile mh$ sudo rails 新演示
/Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/dependency.rb:247:in `to_specs': 找不到 rake (>= 0.8\. 7) 在 [actionmailer-3.2.8、actionpack-3.2.8、activemodel-3.2.8、activerecord-3.2.8、activeresource-3.2.8、activesupport-3.2.8、arel-3.0.2、builder-3.0 中。 4、erubis-2.7.0、hiking-1.2.1、i18n-0.6.1、journey-1.0.4、json-1.7.5、mail-2.4.4、mime-types-1.19、multi_json-1.3.6、 polyglot-0.3.3, rack-1.4.1, rack-cache-1.2, rack-ssl-1.3.2, rack-test-0.6.2, rails-3.2.8, railties-3.2.8, rdoc-3.12, sprockets-2.1.3、thor-0.16.0、tilt-1.3.3、treetop-1.4.12、tzinfo-0.3.34] (Gem::LoadError)
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:777:in `block in activate_dependencies'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:766:in `each'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:766:in `activate_dependencies'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems/specification.rb:750:in `activate'
    来自 /Users/mh/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/site_ruby/1.9.1/rubygems.rb:1232:in `gem'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/rails:18:in `'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `eval'
    来自 /Users/mh/.rvm/gems/ruby-1.9.3-p286/bin/ruby_noexec_wrapper:14:in `'

```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T05:16:15.820

使用这个资源，它会为你安装一切：[Rails Installer](http://railsinstaller.org)

# c# - 使用 DLL 中的可用方法创建新的 Web 服务

> ID：13150700
> 
> 赞同：1
> 
> 时间：2012-10-31T03:05:31.180
> 
> 标签：c#, wcf, web-services

我有一个解决方案文件（即 DLL 文件）。我想创建公开 DLL 文件方法的 webservice/WCF 服务。以便其他团队可以使用 webservice 而不是 DLL 引用

只是我们不能添加 DLL 作为对另一个项目的引用，因为另一个项目正在 java 中使用。所以我提供了 DLL 文件并要求我使用 DLL 文件相关方法创建一个 web 服务（WCF 也可以）。

请帮助我，我的问题是如何在新创建的 web 服务中公开 DLL 方法？

webservice/wcf 任何事情都应该没问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:20:02.450

当然可以！

如果您无法编辑 DLL：

只需创建一个普通的 Web 服务解决方案，然后创建要在 DLL 中公开的 Web 方法。

然后只需在每个 web 方法中调用相应的 DLL 方法即可。

如果可以编辑DLL，只需将项目转为webservice项目并暴露相应的方法即可

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:23:06.927

您可以尝试创建一个引用此 DLL 文件的 WCF 服务，您可以从服务合同中的 Operation contract() 调用 DLL 中的函数。

并且可以从您的其他 java 项目中调用这些操作合同。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T03:23:38.897

这个初学者[教程](http://www.codeproject.com/Articles/406096/A-beginners-tutorial-for-understanding-Windows)非常好，应该让你指向正确的方向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T12:38:25.877

您可以从 WebService 应用程序公开所有 dll。添加对 WebService 项目的引用

```
[WebMethod]
public bool CheckLogin(string username, string password)
        {
            bool status = false;

            SqlCommand Command = new SqlCommand();
            try
            {
               Command.CommandText="Select count(*) from CM_Users where username='"+username+"' and passwd='"+password+"'";
               Command.Connection=DbConnection.OpenDbConnection();
                  // this is Assembly Loaded from Application

               int count=(int)Command.ExecuteScalar();

                if(count>0)
                    status=true;
                else
                    status=false;

                DbConnection.CloseDbConnection(Command.Connection);

            }
            catch (SqlException expmsg)
            {
                DbConnection.CloseDbConnection(Command.Connection);

            }

            return status;

        } 
```

# javascript - Facebook like 按钮不与 document.write() 一起显示；

> ID：13150702
> 
> 赞同：0
> 
> 时间：2012-10-31T03:05:56.323
> 
> 标签：javascript, facebook

我有一个示例代码：

```
<html xmlns:fb="http://www.facebook.com/2008/fbml">
  <head>
    <script language="javascript" type="text/javascript">
    window.checkDoesLike = function() {
      FB.api({ method: 'pages.isFan', page_id: '40796308305' }, function(resp) {
        if (resp) {
            alert("You have like this pages");
        } else {
            //<![CDATA[
            document.write('<fb:like href="http://www.facebook.com/coca-cola" layout="button_count" show_faces="false" width="450" action="like" font="arial" colorscheme="light"></fb:like>');
            //]]>
        }
      });
    };
    </script>
  </head>
  <body onload="checkDoesLike()">
    <div id="fb-root"></div>
    <script language="javascript" type="text/javascript">
    // Load the SDK Asynchronously
    (function(d){
        var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        d.getElementsByTagName('head')[0].appendChild(js);
    }(document));
    </script>
  </body>
</html> 
```

当我运行代码时，facebook 喜欢不显示（虽然我在页面[http://www.facebook.com/coca-cola](http://www.facebook.com/coca-cola)中不喜欢），如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:09:23.343

将 XFBML 标签添加到页面后，您需要调用[FB.XFBML.parse()](https://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/)

# java - 在Java中将字符数组转换为字符串

> ID：13150703
> 
> 赞同：13
> 
> 时间：2012-10-31T03:05:57.220
> 
> 标签：java, string, char

我有一个`Character`数组（不是 char 数组），我想通过组合数组中的所有字符将其转换为字符串。

我已经尝试了以下给定的`Character[] a`：

```
String s = new String(a) //given that a is a Character array 
```

但这不起作用，因为 a 不是 char 数组。我将不胜感激任何帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-31T03:09:43.147

```
Character[] a = ...
new String(ArrayUtils.toPrimitive(a)); 
```

`ArrayUtils`是[Apache Commons Lang](http://commons.apache.org/lang/)的一部分。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-31T03:42:28.863

最有效的方法很可能是这样的：

```
Character[] chars = ...

StringBuilder sb = new StringBuilder(chars.length);
for (Character c : chars)
    sb.append(c.charValue());

String str = sb.toString(); 
```

笔记：

1.  使用 StringBuilder 可以避免创建多个中间字符串。
2.  提供初始大小可避免重新分配。
3.  使用`charValue()`避免调用`Character.toString()`...

但是，除非性能是一个重要问题，否则我可能会选择@Torious 的优雅答案。

* * *

顺便说一句，JLS 表示允许编译器使用等效的 StringBuilder 代码优化字符串连接表达式……但它不批准跨多个语句的优化。因此是这样的：

```
 String s = ""
    for (Character c : chars) {
        s += c;
    } 
```

可能会做很多单独的连接，创建（和丢弃）很多中间字符串。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-10-31T03:08:52.900

迭代和连接方法：

```
Character[] chars = {new Character('a'),new Character('b'),new Character('c')};

StringBuilder builder = new StringBuilder();

for (Character c : chars)
    builder.append(c);

System.out.println(builder.toString()); 
```

**输出：**

> 美国广播公司

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-31T03:12:50.183

首先将 to 转换`Character[]`为`char[]`，并用于`String.valueOf(char[])`获取 String ，如下所示：

```
 char[] a1 = new char[a.length];
    for(int i=0; i<a.length; i++) {
        a1[i] = a[i].charValue();
    }
    String text = String.valueOf(a1);
    System.out.println(text); 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-31T03:29:04.130

它可能很慢，但对于踢球来说，这是一个与其他方法不同的丑陋单线 -

```
Arrays.toString(characterArray).replaceAll(", ", "").substring(1, characterArray.length + 1); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-03-23T21:22:35.300

可能有点矫枉过正，但在 Java 8 上你可以这样做：

```
Character[] chars = {new Character('a'),new Character('b'),new Character('c')};

String value = Arrays.stream(chars)
                .map(Object::toString)
                .collect( Collectors.joining() ); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2012-10-31T03:11:03.953

在每个索引处，调用 toString 方法，并将结果连接到您的 String s。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-31T03:16:33.160

如何创建自己的方法来遍历字符数组列表，然后将每个值附加到新字符串。

像这样的东西。

```
public String convertToString(Character[] s) {
   String value;

   if (s == null) {
     return null;
   }

   Int length = s.length();
   for (int i = 0; i < length; i++) {
     value += s[i];
   }

   return value;
} 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-04-17T16:18:07.767

实际上，如果你有 Guava，你可以使用`Chars.toArray()`来产生`char[]`然后简单地将结果发送到`String.valueOf()`.

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-08-03T08:53:42.680

```
int length = cArray.length;
String val="";
for (int i = 0; i < length; i++)
    val += cArray[i];
System.out.println("String:\t"+val); 
```

# passwords - H2数据库密码恢复

> ID：13150705
> 
> 赞同：2
> 
> 时间：2012-10-31T03:06:36.267
> 
> 标签：passwords, h2, recovery, sa

我们有成千上万的用户使用 H2 数据库，有时，不知何故，有人忘记了密码。

**有没有办法至少恢复 SA 用户密码**？

当然，我告诉他们，如果数据库被盗，没有人会高兴……

无论如何，为了所有受影响的用户，我需要确定。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T08:01:18.770

不，不可能恢复任何用户的密码，因为密码不存储在数据库文件中。相反，[密码和随机盐一起被散列](http://h2database.com/html/advanced.html#security_protocols)，并且只存储散列和盐。随机盐可防止[彩虹攻击](https://stackoverflow.com/questions/1012724/what-exactly-is-a-rainbow-attack)。顺便说一句，在服务器模式下，不传输密码 - 仅传输哈希。有关详细信息，请参阅[文档](http://h2database.com/html/advanced.html#security_protocols)。

但是，如果[数据库未加密](http://h2database.com/html/features.html#file_encryption)，则可以从数据库文件中提取数据。

# html - li background hover 改变背景

> ID：13150707
> 
> 赞同：0
> 
> 时间：2012-10-31T03:07:13.377
> 
> 标签：html, css, html-lists, background-image

我正在尝试两个在完全变化`<li>`的背景下创建一个翻转效果`<li>`。非活动状态的背景贴合，但翻转时背景关闭。下面是我的代码。

HTML：

```
<div class="sidebox">
<ul>
<li><a href="http://2020mediaonline.com/wptest/wp-login.php">Log in</a></li>
<li><a href="http://2020mediaonline.com/wptest/?feed=rss2">Entries</a></li>
<li><a href="http://2020mediaonline.com/wptest/?feed=comments-rss2" >Comments</a></li>
<li><a href="http://wordpress.org/">WordPress.org</a></li>
</ul>
</div> 
```

这是我的CSS：

```
div.sidebox ul {list-style-type:none;font:12px arial;}
div.sidebox ul li{background: url(images/right_ul_bg.jpg) no-repeat left;padding:10px 0 0 50px;}
div.sidebox ul li a{text-decoration:none;color:white;display:block;height:31px; width:247px;}
div.sidebox ul li a:hover{ background:#2f373c url(images/right_ul_bg_hover.jpg) -10px -50px;} 
```

这是一个现场示例[http://jsfiddle.net/cd7rR/](http://jsfiddle.net/cd7rR/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:49:04.330

您将悬停背景图像放在*anchor*上。原始背景图像在*list-item*上。*锚点*是偏移的，因为您在*list-item*上声明了填充。*这是一个在list-item*上带有悬停背景的演示。

```
div.sidebox ul li:hover{ background:url(http://2020mediaonline.com/wptest/wp-content/themes/Price_LawTheme/images//right_ul_bg_hover.jpg) no-repeat;}div.sidebox ul 
```

[http://jsfiddle.net/cd7rR/1/](http://jsfiddle.net/cd7rR/1/)

# javascript - 用于拖放绘图应用程序的 Canvas 与 jQuery

> ID：13150708
> 
> 赞同：2
> 
> 时间：2012-10-31T03:07:13.547
> 
> 标签：javascript, jquery, canvas, html5-canvas

我正在设计一个非常基本的、基于 Web 的绘图型应用程序（与桌面兼容就足够了），我的用户可以在其中将多个对象拖放到指定区域。

对象有不同的颜色和形状（只有基本的几何形状，如矩形、梯形等），用户可以调整它们的大小或旋转它们，然后保存设计（只是将对象的坐标发送到数据库）。

我正在学习如何从头开始设计。

**对于上述类型的网页应用，我应该主要使用jQuery还是应该使用HTML Canvas元素，优缺点是什么？**

我知道它们都基于 Javascript，但我要求我知道从哪个特定子集开始我的学习。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T03:12:54.607

我建议使用[KineticJS 之](http://www.kineticjs.com/)类的框架。jQuery 非常适合 DOM 操作（包括拖放），但不适用于图像处理（即使是像您这样的基本用例）。Canvas 对后者有好处，但您必须自己实现前者。

你可以尝试同时做这两个，但这会很尴尬（你必须一次处理多个画布，等等）。使用已经完成两者的库将为您节省大量精力。

**注意：**这仅指用户界面。为了向您的服务器来回发送数据，jQuery 具有简化[ajax](http://api.jquery.com/category/ajax/)调用的功能，具有良好的跨浏览器行为。其他框架可能也有类似的实用程序，但 jQuery 是我熟悉的，所以我推荐它。

# database - 我们如何为表作业子作业和合同设计数据库？

> ID：13150719
> 
> 赞同：0
> 
> 时间：2012-10-31T03:08:45.533
> 
> 标签：database, relational-database

表之间的关系遵循这 1 个工作可能包含 0-M 子工作 = 1 ：M 0-M 子工作可能有 0-M 合同 = M ：M 我设计的表是

工作：工作ID

子作业：子作业ID

合同：合同ID

Subjob_Contract:SubjobID,ContractID

我面临的问题是当我们想要查看工作和合同时.....如果工作没有子工作，那么合同如何与工作联系起来

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:27:18.157

我会从表结构中消除作业和 SubJob 之间的区别。您可以使用 SubJob 表作为指向其他 Jobs 的链接，然后您只有一个 Job_Contract 引用。

然后，SubJob 将包含所有 Jobs 和它们的 SubJobs 之间的链接。

```
子工作：
 parent_job_id -- 对父作业的引用
 job_id -- 以前，您的 SubJobId

```

例子：

```
Select * from subjobs where subjobs.parent_job = {jobid}; 
```

返回一组包含实际上是作业 ID 的“subjobid”的所有子作业。

这样您就可以参考任何工作的合同。

# javascript - 如何解释 SVG 在拉斐尔？

> ID：13150721
> 
> 赞同：2
> 
> 时间：2012-10-31T03:09:01.493
> 
> 标签：javascript, svg, raphael

我一直在 illustrator 中制作一些插图，获取他们的 SVG 代码并使用 raphael.js 在屏幕上绘制它们，以便稍后在其上添加动画和交互性。当涉及到简单的形状和路径时，一切都很好。Path()、ellipse() 和 rec() 工作得很好。但是当我看到一个`<line>`提供 x1、y1、x2 和 y2 的元素时，我的 SVG XML 文件中有一些实例。我不知道我应该如何在拉斐尔中解释这一点并将其绘制到屏幕上。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T03:55:34.120

在 Raphael 中，您应该将线条转换为路径，这很简单......

```
paper.path( [ "M", x1, y1, "L", x2, y2 ] ); 
```

或者，如果您只想对值进行硬编码：

```
paper.path("M 10,10 L 30,30"); 
```

# git - 将 git 分支推送到尚未安装 git 的远程服务器

> ID：13150724
> 
> 赞同：1
> 
> 时间：2012-10-31T03:09:25.327
> 
> 标签：git, bash, unix, ftp

我有一个共享主机帐户，我有 SSH 和 FTP 访问权限，悬停我没有 root 访问权限，并且服务器没有安装 git。我很好奇设置一个监视脚本来监视我是否已提交/合并到分支 master（本地）并通过 FTP 将 master 分支上传到远程服务器是多么可行。

如果创建观察者太复杂，我可以手动（没有观察者脚本），也许使用 bash 脚本（我正在运行 Linux Mint），但我不知道如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:14:06.520

你可以试试[https://github.com/resmo/git-ftp#readme](https://github.com/resmo/git-ftp#readme)。它是一个不错且简单的 shell scipt，用于通过 FTP 上传（不依赖于任何其他语言）。它不需要在服务器端安装 git。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:15:51.900

看起来有人已经遇到了同样的难题，他的[解决方案在 Github 上](https://github.com/ezyang/git-ftp)。

这都是 Pythony，但即使它不适合你，也应该让你知道从哪里开始。

并且总是有[sitecopy](http://www.manyfish.co.uk/sitecopy/why.html)。

# c# - 一组点的“共线”测量

> ID：13150727
> 
> 赞同：1
> 
> 时间：2012-10-31T03:09:41.987
> 
> 标签：c#, xna, kinect

**背景**

我正在使用 XNA C# + Kinect 制作一个物理教学平台。用户可以使用对象设置场景，包括：

*   领域
*   堵塞
*   飞机

显而易见的有趣事情是使用不同的手势来表示一个对象。飞机似乎是最简单的，所以我打算从那里开始。

输入对象的流程是这样的：

1.  选择对象（通过手势识别）
2.  缩放对象
3.  旋转对象
4.  放置对象

**我的想法**

这是我的想法。我们跟踪上半身的 6 个关节：

*   左+右手腕
*   左 + 右肘
*   左+右肩

如果这组点是共线的，即双臂保持水平，我们会说这是一个平面的输入手势。

如果要使用我的想法，则需要确定这些点的共线程度，例如，某种算法将一组点的“共线性”作为区间 [0, 1] 中的浮点数返回。然后我可以说，例如，任何大于 0.9 的东西都将被接受为平面，从而允许一些错误空间。

或者

或者，“基于模板的姿势检测”的想法听起来很棒，如下链接所示：

[http://blogs.msdn.com/b/eternalcoding/archive/2011/08/02/kinect-toolkit-1-1-template-based-posture-detector-and-voice-commander.aspx](http://blogs.msdn.com/b/eternalcoding/archive/2011/08/02/kinect-toolkit-1-1-template-based-posture-detector-and-voice-commander.aspx)

但据我了解，这似乎是任何手势的通用学习算法。我倾向于自己写一些东西来尝试 Kinect。

**问题**

那么......有没有人知道任何现有的算法来确定一组点的“共线性”程度？

# java - 在java中查找字符串的所有大写字母

> ID：13150730
> 
> 赞同：9
> 
> 时间：2012-10-31T03:09:48.170
> 
> 标签：java, string, printing, uppercase, lang

因此，我试图在用户输入的字符串中查找所有大写字母，但我不断收到此运行时错误：

```
Exception in thread "main" java.lang.StringIndexOutOfBoundsException: 
String index out of range: 4
at java.lang.String.charAt(String.java:686)
at P43.main(P43.java:13) 
```

[我觉得很愚蠢，但我无法弄清楚这一点，oracle 甚至在关于java.lang.StringIndexOutOfBoundsException](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/StringIndexOutOfBoundsException.html)的页面上谈论 charAt

这是我查找大写字母并打印它们的代码：

```
import java.io.*;
import java.util.*;

public class P43{
   public static void main(String[] args){
      Scanner in = new Scanner(System.in);
      //Uppercase
      String isUp = "";
      System.out.print("Please give a string: ");
      String x = in.next();
      int z = x.length();
      for(int y = 0; y <= z; y++){
         if(Character.isUpperCase(x.charAt(y))){
            char w = x.charAt(y);
            isUp = isUp + w + " ";
         }
      }
      System.out.println("The uppercase characters are " + isUp);
      //Uppercase
   }
} 
```

我非常感谢任何输入和/或帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-31T03:10:38.900

```
for(int y = 0; y <= z; y++){ 
```

应该

```
for(int y = 0; y < z; y++){ 
```

记住数组索引从零开始。

[字符串长度](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#length%28%29)返回

> 字符串中 16 位 Unicode 字符的数量

因为循环从零开始，所以循环应该在长度为 1 处终止。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-31T03:18:08.863

数组索引超出范围是由于 for 循环未终止`length - 1`，它终止于`length` 大多数迭代 for 循环应采用以下形式：

```
for (int i = 0; i < array.length; i++) {
    // access array[i];
} 
```

字符串也是一样的。

也许更清洁的方法是：

```
String inputString; // get user input

String outputString = "";

for (int i = 0; i < inputString.length; i++) {
    c = inputString.charAt(i);
    outputString += Character.isUpperCase(c) ? c + " " : ""; 
}
System.out.println(outputString); 
```

编辑：忘记`String`不实现`Iterable<Character>`，愚蠢的Java。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-01-04T12:28:46.883

在 Java 8 中，您还可以使用 lambda。将 转换`String`为 a `IntStream`，使用过滤器仅获取大写字符并`String`通过将过滤后的字符附加到 a 来创建一个新字符`StringBuilder`：

```
Scanner in = new Scanner(System.in);
System.out.print("Please give a string: ");
//Uppercase
String isUp = in.next()
        .chars()
        .filter(Character::isUpperCase)
        .collect(StringBuilder::new, // supplier
                StringBuilder::appendCodePoint, // accumulator
                StringBuilder::append) // combiner
        .toString();
System.out.println("The uppercase characters are " + isUp);
//Uppercase 
```

灵感来自：

*   [Adam Bien - 串流串流](http://www.adam-bien.com/roller/abien/entry/java_8_streaming_a_string)
*   [最简单的打印`IntStream`方式`String`](https://stackoverflow.com/a/20268845/5223047)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-10-08T18:21:04.230

尝试这个...

**方法：**

```
public int findUpperChar(String valitateStr) {
    for (int i = valitateStr.length() - 1; i >= 0; i--) {
        if (Character.isUpperCase(valitateStr.charAt(i))) {
            return i;
        }
    }
    return -1;
} 
```

**用法：**

```
String passwordStr = password.getText().toString();

 .......

int len = findUpperChar(passwordStr);

if ( len != -1) {

      capitals exist.   

  } else {

      no capitals exist.            
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-31T04:26:44.717

嗨，在给定字符串中查找大写字符的简单步骤之一......

**程序**

```
import java.io.*;
public class testUpper 
{
    public static void main(String args[]) throws IOException
    {
        String data,answer="";
        BufferedReader br=new BufferedReader(new InputStreamReader(System.in));
        System.out.println("Enter any String : ");
        data=br.readLine();
        char[] findupper=data.toCharArray();
        for(int i=0;i<findupper.length;i++)
        {
            if(findupper[i]>=65&&findupper[i]<=91) //ascii value in between 65 and 91 is A to Z
            {
                answer+=findupper[i]; //adding only uppercase
            }
        }
        System.out.println("Answer : "+answer);
    }
} 
```

**输出**

输入任何字符串：

欢迎来到弦乐世界

答案： WTHSWRD

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-11T22:10:19.637

我知道的最简单的方法是使用正则表达式替换。

```
isUp = x.replaceAll("[^A-Z]", ""); 
```

简单来说，它使用一个正则表达式匹配任何不在 AZ 范围内的字符，并将其替换为一个空字符串。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-09-14T03:30:01.137

您可以在此处提高代码的可读性并从现代 Java 的其他一些特性中受益。请使用 Stream 方法来解决这个问题。另外，我建议将最少数量的库导入您的班级。请避免在导入时使用 .*。

```
import java.util.Scanner;

public class P43 {
    public static void main(String[] args) {
        Scanner in = new Scanner(System.in);
        System.out.print("Please give a string: ");
        String x = in.next();
        x.chars().filter(c -> Character.isUpperCase(c))
                .forEach(c -> System.out.print((char) c + " "));
    }
} 
```

**样本输入：**

在编辑器中保存更改

**样本输出：**

引用

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-09-17T16:51:21.373

```
import java.util.Scanner;
class Demo
{
    public static void main(String[] args)
    {
         StringBuilder s=new StringBuilder();
         Scanner input = new Scanner(System.in);
         System.out.println("Enter your String");
         String str= input.nextLine();

         for(int i=0; i<str.length(); i++)
         {
            if(Character.isUpperCase(str.charAt(i)))
            {
               System.out.print(str.charAt(i)+" ");
            }
         }
      }
} 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2018-10-04T17:32:23.187

```
public class Cama {

public static void main(String[] args) {
    String camal = "getStudentByName";
    String temp = "";
    for (int i = 0; i < camal.length(); i++) {
        if (Character.isUpperCase(camal.charAt(i))) {
            System.out.print(" " + Character.toLowerCase(camal.charAt(i)));
        } else if (i == 0) {
            System.out.print(Character.toUpperCase(camal.charAt(i)));
        }else{
            System.out.print(camal.charAt(i));
        }
    }
}
} 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2017-02-08T18:19:29.990

```
public static void main(String[] args) {
    Scanner input = new Scanner(System.in);
    System.out.println("Enter the number");
    String str= input.nextLine();

    int ascii;
    for(int i=0; i<str.length(); i++) {
        ascii = str.charAt(i);
        System.out.println(ascii);
        if (ascii >= 65 && ascii <= 90) {
            System.out.println("captal letter found ::: "+ascii);
        }
    }
} 
```

# ios - 弗兰克辅助功能已启用，但仍然出现错误

> ID：13150732
> 
> 赞同：2
> 
> 时间：2012-10-31T03:10:20.273
> 
> 标签：ios, cucumber, accessibility, acceptance-testing, frank

弗兰克一直工作到昨天。我不确定我做了什么把它搞砸了。在我安装了弗兰克并一直工作到昨天的一个项目中，我得到了：

```
PING FAILED!!!!!... 
```

现在留言。所以我创建了一个新项目并添加了 Frank 来测试它。我得到了测试输出的开始，但是当它实际尝试启动时，它说没有启用可访问性：

```
Feature: 
  As an iOS developer
  I want to have a sample feature file
  So I can see what my next step is in the wonderful world of Frank/Cucumber testing

  Scenario:                                             # features/my_first.feature:6
      Rotating the simulator for demonstration purposes
    Given I launch the app                              # features/step_definitions/launch_steps.rb:5
      ACCESSIBILITY DOES NOT APPEAR TO BE ENABLED ON YOUR SIMULATOR. Hit the home button, go to settings, select Accessibility, and turn the inspector on. (RuntimeError)
      ./features/step_definitions/launch_steps.rb:7:in `/^I launch the app$/'
  features/my_first.feature:8:in `Given I launch the app'
    Given the device is in landscape orientation        # frank-cucumber-0.9.5/lib/frank-cucumber/core_frank_steps.rb:135
    Given the device is in portrait orientation         # frank-cucumber-0.9.5/lib/frank-cucumber/core_frank_steps.rb:149
    Given the device is in landscape orientation        # frank-cucumber-0.9.5/lib/frank-cucumber/core_frank_steps.rb:135
    Given the device is in portrait orientation         # frank-cucumber-0.9.5/lib/frank-cucumber/core_frank_steps.rb:149

Failing Scenarios:
cucumber features/my_first.feature:6 # Scenario: 
  Rotating the simulator for demonstration purposes 
```

系统偏好设置 -> 辅助功能中的“启用辅助设备访问”复选框已被选中。所以我像错误所说的那样在移动设备模拟器上启用它（我以前从未在它工作时做过）。我在模拟器设置中打开了辅助功能检查器，但我仍然收到此错误。我重新启动了模拟器和我的笔记本电脑。我仍然得到错误。有任何想法吗？谢谢，

帕春

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T08:46:07.740

Recently, someone [gemified Frank for rubymotion](https://github.com/cyrusinnovation/motion-frank). It works well for me.

# .net - 在 MonoDevelop 和 Visual Studio 上使用构建后脚本制作项目的最佳方法是什么？

> ID：13150733
> 
> 赞同：24
> 
> 时间：2012-10-31T03:10:34.077
> 
> 标签：.net, linux, visual-studio, cross-platform, monodevelop

我有一个开源项目，我试图在其中允许在 MonoDevelop（包括 *nix）和 Visual Studio 上进行开发。我最近发现的一个需求是我需要将输出文件从一个目录复制到另一个（相对路径）。

然而，Windows 有`copy`命令，而 *nix 有`cp`命令。让它在两个平台上工作并解决这种命令差异的最佳方法是什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2016-02-23T06:29:29.090

在可能的情况下，如果您可以依靠内置的 MSBuild 任务而不是自定义 shell 脚本，则该行为通常可以在 xbuild（以及因此 MonoDevelop？）上运行而无需任何更改，因此不需要特定于平台的 *proj hack。

例如：

```
 <Target Name="AfterBuild">
          <Copy SourceFiles="foo.txt" DestinationFolder="$(OutDir)" />
 </Target> 
```

这是来自单声道文档： [http ://www.mono-project.com/archived/porting_msbuild_projects_to_xbuild/#prepostbuildevents](http://www.mono-project.com/archived/porting_msbuild_projects_to_xbuild/#prepostbuildevents)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2016-02-11T09:41:48.857

您可以使用该`$OS`变量根据环境进行不同的构建后事件。为此，您必须手动编辑 csproj，例如：

```
<PostBuildEvent Condition="'$(OS)' == 'Windows_NT' ">
    dir
</PostBuildEvent>
<PostBuildEvent Condition="'$(OS)' != 'Windows_NT'">
    ls
</PostBuildEvent> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-15T01:04:10.600

您可以使用 Python 之类的语言编写构建后脚本。或者您可以要求其他开发人员安装 GnuWin32 CoreUtils 作为安装 CygWin 的一个选项。CoreUtils 包括 cp。然后你可以无条件地使用cp。

# arrays - Bash 数组作为屏幕内的参数

> ID：13150735
> 
> 赞同：2
> 
> 时间：2012-10-31T03:10:55.620
> 
> 标签：arrays, bash, function, loops, gnu-screen

下面的代码没有像我预期的那样工作。我可能是因为我做错了，但我认为这可能是一个引用问题。

```
 #!/bin/bash 

    IFS=$'\n' 
    fortune_lines=($(fortune | fold -w 30))
    Screen_Session=$(mainscreen)
    Screen_OneLiner=$(screen -p 0 -S ${Screen_Session} -X stuff "`printf "say   ${fortune_lines[@]}\r"`")

    for var in "${Screen_OneLiner[@]}"
      do
        echo "${var}"
    done 
```

我认为我没有正确引用某些内容，因为当我尝试执行此操作时。我明白了。。

```
 line 5: mainscreen: command not found
    [screen is terminating 
```

本质上，我正在尝试添加此功能（有效）

```
 IFS=$'\n' 
    fortune_lines=($(fortune | fold -w 30)) 
```

到这个屏幕一个班轮

```
 screen -p 0 -S ${Screen_Session} -X stuff "`printf "say   ${fortune_lines[@]}\r"`" 
```

然后让它循环数组

```
 for var in "${ArrayName[@]}"
   do
      echo "${var}"

   done 
```

所以我不确定我离我想做的事情有多远（在代码中）。任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:47:39.223

这条线有问题

```
Screen_Session=$(mainscreen) 
```

您在此处使用命令替换，因此如果`mainscreen`不是有效命令，您将收到`command not found`错误消息。

也许您的意思是使用大括号而不是括号？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-18T10:57:03.490

*[由于将评论标记为答案的](https://meta.stackexchange.com/questions/82099/answering-comment-answered-questions)功能请求仍然被拒绝，因此我在此处复制上述解决方案。*

我设法让它工作...... [gist.github.com/4006586](http://gist.github.com/4006586) – user1787331

# mysql - 类似查询中的规范

> ID：13150741
> 
> 赞同：0
> 
> 时间：2012-10-31T03:11:33.877
> 
> 标签：mysql, sql, where, sql-like

我无法弄清楚这个查询有什么问题。我只想搜索特定类型，但此查询为我提供了其他类型的结果。真的很想得到一些帮助。此代码适用于我的第一个用 php 构建的网站。

```
SELECT * 
FROM news
WHERE (titel LIKE '%keyword%') AND genre='politics' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:40:50.840

首先，我建议阅读 MySQL 中的模式匹配。文档链接是：[http ://dev.mysql.com/doc/refman/5.0/en/pattern-matching.html](http://dev.mysql.com/doc/refman/5.0/en/pattern-matching.html)

SQL 模式匹配使您可以使用“_”匹配任何单个字符，使用“%”匹配任意数量的字符（包括零个字符）。在 MySQL 中，SQL 模式默认不区分大小写。此处显示了一些示例。使用 SQL 模式时不要使用 = 或 <>；请改用 LIKE 或 NOT LIKE 比较运算符。

**例子**

要查找以“b”开头的名称：

```
mysql> SELECT * FROM pet WHERE name LIKE 'b%';
+--------+--------+---------+------+------------+------------+
| name   | owner  | species | sex  | birth      | death      |
+--------+--------+---------+------+------------+------------+
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL       |
| Bowser | Diane  | dog     | m    | 1989-08-31 | 1995-07-29 |
+--------+--------+---------+------+------------+------------+ 
```

要查找以“fy”结尾的名称：

```
mysql> SELECT * FROM pet WHERE name LIKE '%fy';
+--------+--------+---------+------+------------+-------+
| name   | owner  | species | sex  | birth      | death |
+--------+--------+---------+------+------------+-------+
| Fluffy | Harold | cat     | f    | 1993-02-04 | NULL  |
| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL  |
+--------+--------+---------+------+------------+-------+ 
```

要查找包含“w”的名称：

```
mysql> SELECT * FROM pet WHERE name LIKE '%w%';
+----------+-------+---------+------+------------+------------+
| name     | owner | species | sex  | birth      | death      |
+----------+-------+---------+------+------------+------------+
| Claws    | Gwen  | cat     | m    | 1994-03-17 | NULL       |
| Bowser   | Diane | dog     | m    | 1989-08-31 | 1995-07-29 |
| Whistler | Gwen  | bird    | NULL | 1997-12-09 | NULL       |
+----------+-------+---------+------+------------+------------+ 
```

要查找恰好包含五个字符的名称，请使用“_”模式字符的五个实例：

```
mysql> SELECT * FROM pet WHERE name LIKE '_____';
+-------+--------+---------+------+------------+-------+
| name  | owner  | species | sex  | birth      | death |
+-------+--------+---------+------+------------+-------+
| Claws | Gwen   | cat     | m    | 1994-03-17 | NULL  |
| Buffy | Harold | dog     | f    | 1989-05-13 | NULL  |
+-------+--------+---------+------+------------+-------+ 
```

**您修改后的查询**

因此，您希望您的查询从 NEWS 表中选择行，并选择 TITLE 类似于关键字且 GENRE 等于特定字符串的所有内容。

以下是我将如何构建您的查询。此查询中不存在性能注意事项，但如果这是对大型表的频繁查询，您可能需要调查索引和其他性能增强器。

最初，您正在使用：

```
SELECT * FROM news WHERE (title LIKE '%keyword%') AND genre='politics' 
```

选项1：

```
SELECT *
FROM news
WHERE
title LIKE '%keyword%'
AND
genre = 'politics'; 
```

选项 2：

您应该考虑输入的来源以及是否需要在将字段插入查询之前对其进行参数化。使用参数可以带来更简洁、更灵活的代码，并提供安全性和类型检查。

尝试这样的事情。这个未经测试的代码，所以可能存在一些语法问题，但应该很接近。

```
private string title = "%title%";
private string genre = "genre";

using (MySqlConnection con = new MySqlConnection(connectionString))
{
  using (MySqlCommand cmd = new MySqlCommand())
  {
    cmd.Connection = con;
    cmd.CommandText 
      = "SELECT * FROM NEWS WHERE TITLE LIKE '@title' AND GENRE = @genre; ";
    cmd.Parameters.AddWithValue("@title", title);
    cmd.Parameters.AddWithValue("@genre", genre);
    using (MySqlDataReader drd = cmd.ExecuteReader())
    {
      while (drd.Read())
      {
        // Read from data reader
      }
    }
  }
} 
```

# knockout.js - KnockoutJs - 可观察的绑定和范围

> ID：13150743
> 
> 赞同：0
> 
> 时间：2012-10-31T03:11:40.677
> 
> 标签：knockout.js, requirejs

这里有两个示例：
示例 1：http: [//jsfiddle.net/TheMetalDog/yYAFJ/9/](http://jsfiddle.net/TheMetalDog/yYAFJ/9/)
示例 2：http: [//jsfiddle.net/TheMetalDog/yYAFJ/11/](http://jsfiddle.net/TheMetalDog/yYAFJ/11/)

在示例 1 中，一个 observable 位于 viewModel 之外，并且当您添加项目时，从选择列表中选择的标题会单独附加到模板项目。

```
var selectedTitle = ko.observable(); 
```

在示例 2 中，可观察对象位于 viewModel 内部，并且所有绑定到可观察对象的项目都会在您添加项目时同步和更新。

```
viewModel.selectedTitle = ko.observable(); 
```

在模块环境中或更具体地说，在 requirejs 中工作时，是否有获得示例 1 行为的推荐策略？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T05:31:54.083

目前尚不清楚您的代码试图做什么。似乎您有两个独立的视图模型，并且您希望它们相互交互。如果是这种情况，您可能想要使用[postbox](https://github.com/rniemeyer/knockout-postbox)。它将允许您将视图模型分开，但仍允许它们相互通信。

因此，您希望获取选定的标题，并在视图模型中创建新项目或子项目时使用它。

只是为了让它不碍事，你真的需要为`title`你的物品添加一个属性。将项目映射到另一个具有 observable 的对象`title`。

```
function Item(data) {
    var self = this;
    self.title = ko.observable(data.title); // add a 'title' property to all items
    self.name = ko.observable(data.name);

    // map any existing child items to new Items
    self.childItems = ko.observableArray(ko.utils.arrayMap(data.childitems, function (item) {
        return new Item(item);
    }));
} 
```

我认为最简单的方法是创建一个“add”和“addChild”主题并让您的视图模型订阅它。当您获得该主题的更新时，您可以使用该标题添加新项目。然后从您的外部来源，让它发布您希望使用的标题到适当的主题。

```
function ViewModel(data) {
    var self = this;

    // ...

    var i = 5;
    function newItem(title) {
        return new Item({
            title: title,
            name: i++,
            childItems: []
        });
    }
    ko.postbox.subscribe('add', function (title) {
        // a title was received for the `add` topic, add it
        self.items.push(newItem(title));
    });
    ko.postbox.subscribe('addChild', function (title) {
        // a title was received for the `addChild` topic, add it
        var firstItem = self.items()[0];
        if (firstItem) {
            firstItem.childItems.push(newItem(title));
        }
    });
} 
```

```
// add a new item using the selected title
ko.postbox.publish('add', selectedTitle());

// add a new child item using the selected title
ko.postbox.publish('addChild', selectedTitle()); 
```

我[更新了你的小提琴](http://jsfiddle.net/jeff1203/yYAFJ/14/)来展示你可能应该做什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T19:44:28.750

Knockout 2.2 的可观察对象的新 peek 函数可以处理这种情况。这是更新的 jsFiddle：http: [//jsfiddle.net/TheMetalDog/fD5kF/](http://jsfiddle.net/TheMetalDog/fD5kF/)

不同之处在于`.peek()`这里添加： `<span data-bind="text: $root.selectedTitle.peek()"></span>`

# android - Android - 在片段文本中看起来要小得多。很小很小...很小

> ID：13150744
> 
> 赞同：1
> 
> 时间：2012-10-31T03:11:58.710
> 
> 标签：android, fragment

不，真的，我没有做任何具体的事情。我正在关注这个教程：http: [//developer.android.com/training/basics/fragments/fragment-ui.html](http://developer.android.com/training/basics/fragments/fragment-ui.html)

我只是用 FragmentManager 的替换加载我的片段。

我试图在 Fragment 的布局中更改 textSize。我在其他设备上尝试过，其他 rom...我尝试在 FrameLayout 或 LinearLayout 中启动他...

没有什么可做的：>

我确定你用过 Fragment。我敢肯定它发生在你身上！告诉我。告诉我我需要知道的：）

作为随机数据，这里是：

我的片段布局：

```
<?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:layout_width="match_parent"
              android:layout_height="match_parent"
              android:orientation="horizontal"
              android:layout_margin="3dp">
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                  android:layout_width="match_parent"
                  android:layout_height="match_parent"
                  android:orientation="vertical"
                  android:layout_margin="7dp"
                  android:layout_weight="1">
        <TextView
                android:id="@+id/BillId"
                android:text="BillId : "
                android:layout_height="wrap_content"
                android:layout_width="match_parent"/>
        <TextView
                android:id="@+id/BuyerLastName"
                android:text="BuyerLastName : "
                android:layout_height="wrap_content"
                android:layout_width="match_parent"/>
        <TextView
                android:id="@+id/BuyerFirstName"
                android:text="BuyerFirstName : "
                android:layout_height="wrap_content"
                android:layout_width="match_parent"/>
        <TextView
                android:id="@+id/CarId"
                android:text="CarId : "
                android:layout_height="wrap_content"
                android:layout_width="match_parent"/>
    </LinearLayout>
    <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
                  android:layout_width="match_parent"
                  android:layout_height="match_parent"
                  android:orientation="vertical"
                  android:layout_margin="7dp"
                  android:layout_weight="1">
        <TextView
                android:id="@+id/BillIdValue"
                android:text="BillId"
                android:layout_height="wrap_content"
                android:layout_width="match_parent"/>
        <TextView
                android:id="@+id/BuyerLastNameValue"
                android:text="BuyerLastName"
                android:layout_height="wrap_content"
                android:layout_width="match_parent"/>
        <TextView
                android:id="@+id/BuyerFirstNameValue"
                android:text="BuyerFirstName"
                android:layout_height="wrap_content"
                android:layout_width="match_parent"/>
    <TextView
            android:id="@+id/CarIdValue"
            android:text="CarId"
            android:layout_height="wrap_content"
            android:layout_width="match_parent"/>
</LinearLayout> 
```

这是我的片段 Java 代码：

```
public class ShowCarFragment extends Fragment {

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.fragment_show_car, container, false);

    }
} 
```

在这里，我在 Activity 中启动片段：

```
if (getMaxPayne() >= 2) {
                getFragmentManager().beginTransaction()
                        .addToBackStack(null)
                        .replace(R.id.fragmentContainer, new ShowCarFragment())
                        .commit();
            } else {
                getFragmentManager().beginTransaction()
                        .addToBackStack(null)
                        .add(R.id.fragmentContainer, new ShowCarFragment())
                        .commit();
            } 
```

**谢谢亲爱的碎片大师。愿米奇的力量与你同在:)**

# gridview - LinearLayout 中的 GridViews ？

> ID：13150755
> 
> 赞同：2
> 
> 时间：2012-10-31T03:13:07.460
> 
> 标签：gridview, android-linearlayout

我们如何在 LinearLayout 中定义 GridViews ？我正在尝试遵循 XML 代码，但它对我不起作用。我必须在嵌套的 LinearLayout 中定义 GridView 吗？

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/parent_layout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

<GridView 
    android:id="@+id/gridview"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content"
    android:columnWidth="90dp"
    android:numColumns="auto_fit"
    android:verticalSpacing="10dp"
    android:horizontalSpacing="10dp"
    android:stretchMode="columnWidth"
    android:gravity="center"
/>

  <LinearLayout 
      android:id="@+id/droparea"
      android:layout_width="fill_parent"
      android:layout_height="wrap_content"
      android:layout_gravity="center"
      android:orientation="horizontal"
      android:background="#ff00ff00">

<TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:padding="@dimen/padding_medium"
        android:text="hello_world" />

  </LinearLayout>        

</LinearLayout> 
```

# mysql - mysql if 语句失败，不知道如何解决

> ID：13150757
> 
> 赞同：2
> 
> 时间：2012-10-31T03:13:17.727
> 
> 标签：mysql, if-statement

目前我有这个声明

```
IF(0.5 < SELECT (FLOOR(10*RAND()*pResourcium) AS TestVar FROM siegeverse.rooms rm) AS T))
THEN SELECT 'TEST' 
```

知道为什么会失败吗？如果所选元素大于 0.5，则尝试让它为每一行输出测试

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T03:20:50.687

此类标量比较上下文中的 SELECT 语句应仅返回一行。在您的情况下，它可能会返回多行，因此失败。以下重写的查询接近您感兴趣的内容：

```
IF EXISTS (SELECT * 
FROM
    (SELECT
         CASE 
             WHEN (FLOOR(10*RAND()*pResourcium) >= 0.5 THEN 'TEST'
             ELSE NULL
         END AS TestVar
     FROM 
         siegeverse.rooms rm
    ) AS A
WHERE A.TestVar IS NOT NULL)
THEN
     <run the stored procedure> 
```

# performance - GraphicsMagick 缩放和采样功能性能差异

> ID：13150758
> 
> 赞同：0
> 
> 时间：2012-10-31T03:13:24.403
> 
> 标签：performance, zooming, sample, graphicsmagick

我们使用 GM 进行图像压缩，并观察到缩放和采样函数之间的显着性能差异，我们假设这样做是一样的。

对 68k 图像使用缩放功能时，一个进程可能会消耗所有内核（12 核，2.4G Hz 机器）的所有 cpu 时间，吞吐量为 65/秒，响应时间平均为 469 毫秒，top 命令加载为11点左右，cpu使用率接近100%

在同一环境下使用示例函数，24个进程协同工作，吞吐量接近1000/秒，平均响应时间为37毫秒，top命令负载在3左右，cpu使用率在50%到80%之间波动

这两个功能的官方文档很简单，如下：

使用像素采样算法对图像进行采样调整大小：

空样本 ( const Geometry &geometry_ )

zoom 缩放（调整大小）图像到指定大小：

无效缩放 ( const Geometry &geometry_ )

图像处理后的效果类似，但差别很大。

1.  谁能解释使用这两个功能的不同情况，因为由于性能问题，我们可能会选择样本而不是缩放

2.  此外，谁能告诉我为什么缩放如此耗时。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T03:06:17.640

由于 GraphicsMagick 的性能较低，可能存在一些与系统相关的问题，例如缓存行抖动。-sample 选项使用简单的点采样，其中输出图像中的每个点从输入图像中选择一个点。-zoom 选项使用指定的过滤器（-filter）进行水平/垂直过滤，因此它提供高质量（取决于过滤器）。对于非常大的图像，我建议使用 -scale，它是一种窗口过滤器，它产生的结果几乎与 -zoom 一样好，但只使用一个 CPU 内核并且仍然非常快。

# android - Android Phonegap：调用 marker.setMap(null) 时未立即删除 Google Map 标记

> ID：13150760
> 
> 赞同：1
> 
> 时间：2012-10-31T03:13:36.017
> 
> 标签：android, google-maps, cordova, google-maps-api-3

当我使用 删除标记时`marker.setMap(null)`，它一直可见，直到我缩小到谷歌地图将其删除为止。

该标记在与 Windows 上的 Chrome 相同的 HTML 页面上被删除后不可见。

删除标记后，似乎没有正确刷新地图。

有问题的代码（标记应在 5 秒后消失）：

```
<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <script type="text/javascript" charset="utf-8" src="cordova-2.1.0.js"></script>
    <script type="text/javascript" charset="utf-8" src="jquery-1.8.2.min.js"></script>
    <style type="text/css">
      * {
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
          }
      html { height: 100%; }
      body { height: 100%; margin: 0; padding: 0 }
      #map_canvas { height: 100% }
    </style>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAQ7L1PL7pQzSuDfv9kTL_qE4Cp0wy8Oo8&sensor=true">
    </script>
    <script type="text/javascript">
      var theMap = null;
      function initialize() {
        var mapOptions = {
          zoom: 10,
          center: new google.maps.LatLng(37.7749295, -122.4194155),
          disableDefaultUI: true,
          mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        theMap = new google.maps.Map(document.getElementById('map_canvas'),
                                      mapOptions);
        navigator.geolocation.getCurrentPosition(
          function (position) {
            // successfully load position
            var lat = position.coords.latitude;
            var long = position.coords.longitude;
            theMap.setCenter(new google.maps.LatLng(lat, long), 21);
          },
          function (fail) {
                console.error("Failed to load GPS coordinates");
          }
        );
        var marker;
        function addMarker(itemid, lat, lon) {
                marker = new google.maps.Marker({
                        position: new google.maps.LatLng(lat, lon),
                        map: theMap
                });
        }
        addMarker('pokemon', 37.42841, -122.16960);
        setTimeout(function() {marker.setMap(null);}, 5000);
      }

    </script>
  </head>
  <body onload="initialize();">
    <div id="map_canvas" style="width:100%; height:100%; top:0px; z-index: 10"/>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T15:01:56.260

我认为，这与此处的问题相同：[Google Maps API v3 in PhoneGap:markers not drawing proper after move](https://stackoverflow.com/questions/13505692/google-maps-api-v3-in-phonegap-markers-not-drawing-properly-after-move/13512838#13512838)

尝试将 optimize: false 属性设置为标记：

```
new google.maps.Marker({
    map: map,
    optimized: false, 
    clickable: true
}); 
```

这应该解决它！

# php - 使用 Javascript/jquery 从单独的目录将 url 填充到 div 中

> ID：13150762
> 
> 赞同：1
> 
> 时间：2012-10-31T03:13:50.910
> 
> 标签：php, javascript, jquery, url

我的目标是让用户将照片上传到名为“userupload”的根目录中。所有这个文件夹将包含 .jpg 图像。

我现在想将所有图像路径从“userupload”目录调用到不同的 .php 页面到一个名为“content”的 div 中，如下所示：*`<p><img class=resizeme src="userupload/uploadimage1.jpg"></p>`*

**我找到了这个脚本，我只能返回图像文件名。这很好，但我不知道如何编辑代码以将其放置在正确的路径中。**

*“这将列出您在 url: 下定义的文件夹中的所有 jpg 文件：并将它们作为段落附加到 div。也可以使用 ul li 来完成。”*

```
$.ajax({
  url: "useupload",
  success: function(data){
     $(data).find("a:contains(.jpg)").each(function(){
        // will loop through 
        var images = $(this).attr("href");

        $('<p></p>').html(images).appendTo('#content')

     });
  }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:17:04.573

这是您可以使用的 PHP：

**image_listing.php**：

```
<?php

$imageLinks = array();
$dh = opendir("userupload");

while ( $file = readdir($dh) )
{
    $tempArray = explode(".",$file);
    if ( isset( $tempArray[1] ) && $tempArray[1] == "jpg" )
    {
        array_push( $imageLinks, 'http://example.com/userupload/' . $file );
    }
}
closedir($dh);

echo json_encode( $imageLinks ); 
```

这将返回一个链接数组，然后您可以在 JavaScript 中使用它们：

```
$.get('image_listing.php', function (array) {
    $.each(array, function(){
         $('#content').append('<p><img class="resizeme" src="' + this + '"></p>');
    });
}); 
```

这是一个可行的快速示例，但您可能应该构建一个 HTML 片段（而不是在循环中每次都访问 DOM）：

```
$.get('image_listing.php', function (array) {
    var container = $('<div'>);
    $.each(array, function(){
         container.append('<p><img class="resizeme" src="' + this + '"></p>');
    });
    $('#content').append( container.html() );
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:24:04.093

您发布的代码似乎依赖于配置为返回`userupload`文件夹的目录索引列表的网络服务器（因此可能无法在不同的网络服务器上工作 - 在服务器端执行此操作的正确方法是 Joseph Silber 建议的）。该列表包含指向相对 url 的链接。

考虑到您已经在工作，并且您的所有图像都在 下`userupload`，循环内的简单更改`.each`应该可以解决问题：

```
var images = 'userupload/' + this.href;
$('<p><img class="resizeme" src="' + images + '"></p>').appendTo('#content'); 
```

* * *

*考虑到您收到的评论* `src="userupload/mysite.com/uploadimage1.jpg"`：

```
var images = 'userupload/' + this.href.split('/')[1];
$('<p><img class="resizeme" src="' + images + '"></p>').appendTo('#content'); 
```

# python - 折叠空 gtk.CellRenderer

> ID：13150763
> 
> 赞同：1
> 
> 时间：2012-10-31T03:13:58.833
> 
> 标签：python, gtk, pygtk

我有一个`gtk.TreeViewColumn`包含 14 个`gtk.CellRendererPixbuf`属性的。它们中的大多数大部分时间都是空的（关联`TreeStore`值为`None`）。

这些图标总是间隔显示，好像它们都存在一样，但是我希望空单元格渲染器折叠，堆叠左侧的图标。

这是它当前的显示方式：

![在此处输入图像描述](../Images/bc4ef188dc2b45e2165bfb70c4d55045.png)

缺少的图标与 相关联`None`。

我查看了文档`TreeViewColumn`，`CellRenderer`但我很难过。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T08:15:50.610

解决方案是编写您自己的接受图标列表的 CellRenderer。看看[Getting Things GNOME 的这种渲染器的实现！](http://gtg.fritalk.com/)待办事项应用程序：

[http://bazaar.launchpad.net/~gtg/gtg/trunk/view/head:/GTG/gtk/browser/CellRendererTags.py](http://bazaar.launchpad.net/~gtg/gtg/trunk/view/head:/GTG/gtk/browser/CellRendererTags.py)

然后`tag_list`使用要显示的对象列表设置属性。（在应用程序中您可以显示纯色或图标）

结果如下所示（图标列表是第一列）：

![在此处输入图像描述](../Images/6a05dc4b6f38582a6135ba1769713672.png)

# iphone - iPhone - 无法振动 iPhone

> ID：13150766
> 
> 赞同：1
> 
> 时间：2012-10-31T03:14:09.327
> 
> 标签：iphone, objective-c, ios, xcode, iphone-vibrate

我正在使用这个

```
AudioServicesPlaySystemSound(kSystemSoundID_Vibrate); 
```

导入那个

```
#import <AudioToolbox/AudioServices.h> 
```

然后我得到了一个错误！

```
Undefined symbols for architecture armv7:"_AudioServicesPlaySystemSound 
```

这是为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:27:50.900

您可能还没有添加`AudioToolbox.framework`到您的项目中。

您可以在`Build Phases`目标配置部分执行此操作。在`Build Phases`选择下`Link Binary with Libraries`。确保`AudioToolbox.framework`在框架列表中。如果不是，请单击`+`底部的按钮并`AudioToolbox.framework`从列表中选择。

# oracle - Oracle全文，CONTAINS()的语法

> ID：13150767
> 
> 赞同：1
> 
> 时间：2012-10-31T03:14:15.147
> 
> 标签：oracle, full-text-search

```
contains(columnname, 'ABC')=0 
```

这意味着搜索不包含单词“ABC”的数据

```
contains(columnname, 'ABC and XYZ')=0
contains(columnname, 'ABC or XYZ')=0 
```

这2个sql是什么意思？我测试了它们，没有语法错误，但它们没有按我的预期工作，'and' 看起来像'or'，'or' 看起来像'and'，谁能帮忙解释一下？在 google 中找到的所有文档都是针对 contains()>0 的，这不是我需要的。

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T09:39:03.197

根据 oracle[文档](http://docs.oracle.com/cd/B19306_01/text.102/b14218/csql.htm#i997503)，`contains`功能：

> 返回所选每一行的相关性分数

如果你要求

```
contains(columnname, 'ABC')=0 
```

您实际上要求的分数`0`意味着：columnname doesn't contain 'ABC'

根据文档：

> 在 AND 查询中，返回的分数是最低查询词的分数
> 
> 在 OR 查询中，返回的分数是最高查询词的分数

因此，如果您要求：

```
contains(columnname, 'ABC and XYZ')=0 
```

那么如果 'ABC'**或**'XYZ' 有一个分数，`0`它的分数将最低，这就是你将从函数中得到的，所以你实际上是在要求：columnname doesn't contain 'ABC' or 'XYZ '（至少其中之一）。

同样的事情 `or`-

```
contains(columnname, 'ABC or XYZ')=0 
```

仅当 'ABC'**和**'XYZ' 都具有函数的分数时`0`才会返回`0`，所以您实际上是在要求： columnname 不包含 'ABC' 和 'XYZ' （两者）。

恕我直言，这种行为是正确的，因为它符合[De-Moragan 的法律](http://en.wikipedia.org/wiki/De_Morgan%27s_laws)

# python - cp: cannot stat ...没有这样的文件或目录

> ID：13150768
> 
> 赞同：0
> 
> 时间：2012-10-31T03:14:18.703
> 
> 标签：python, linux

在 python 脚本中，我发出命令：

```
def copy_file(csv_file):    #csv_file = "wpa-01.csv"
    subprocess.call(["cp",csv_file,"tempfile.csv"]) 
```

我得到错误：

```
cp: cannot stat 'wpa-01.csv' : No such file or directory 
```

-tempfile.csv 是一个有效文件，它是打开的 -我尝试在 wpa-01.csv 周围添加引号，即

```
subprocess.call(["cp","\"wpa-01.csv\"","tempfile.csv"]) 
```

-我尝试在'-'前面添加转义字符

-我尝试在文件名前面包含目录

- 我在本地 Linux 机器上使用 gedit（所以它不是 dos2unix 类型的解决方案），但脚本正在远程 Raspberry Pi 上运行

在每种情况下，我都会遇到相同的错误。我不知所措。有什么建议么？

***这是问题所在：“wpa-01.csv”是一个“实时”/“动态”文件。有一个活动进程正在实时更新该文件。我认为该文件必须是“死”/“静态”才能发出 cp 命令？这对我的目的来说并不理想。有没有办法解决这个问题，比如改变 mod 之类的？如果不是，我想我可以尝试找到替代解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:04:19.483

```
print "wpa-01.csv" in os.listdir(".") #make sure file really does exist
subprocess.call(["cp","\"wpa-01.csv\"","tempfile.csv"],shell=True) 
```

我的猜测是你需要设置 shell=True 以便它~~使用你的路径来查找 cp~~在你的shell中执行......~~如果你不使用 shell=True 它不会使用你的路径~~......

不幸的是，这只是一个猜测......

无论如何，这里有一些支持证据：

```
>>> subprocess.call("copy tmp5.py tmp55.py")
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "C:\Python26\lib\subprocess.py", line 470, in call
    return Popen(*popenargs, **kwargs).wait()
  File "C:\Python26\lib\subprocess.py", line 623, in __init__
    errread, errwrite)
  File "C:\Python26\lib\subprocess.py", line 833, in _execute_child
    startupinfo)
WindowsError: [Error 2] The system cannot find the file specified
>>> subprocess.call("copy tmp5.py tmp55.py",shell=True)
        1 file(s) copied.
0 
```

# ios - 可以显示或更改核心数据模型所基于的模型吗？

> ID：13150769
> 
> 赞同：0
> 
> 时间：2012-10-31T03:14:32.273
> 
> 标签：ios, xcode, core-data, version, xcdatamodel

我想看看我的每个模型都基于什么模型，并可能改变它。我无法在 Xcode 中找到任何地方可以做到这一点。似乎一旦您创建了一个新的模型版本，并选择了它所基于的模型（使用“编辑器/添加模型版本...”并使用“基于模型”下拉菜单选择以前的模型），就没有办法查看您的选择或更改它。

.xcdatamodeld 和 .xcdatamodel 文件是包，您可以通过右键单击/“显示包内容”来检查它们。.xcdatamodel 文件包含一个名为“contents”的 XML 文件，但似乎没有以前模型的版本：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<model name="" userDefinedModelVersionIdentifier="" type="com.apple.IDECoreDataModeler.DataModel" documentVersion="1.0" lastSavedToolsVersion="1811" systemVersion="11G63" minimumToolsVersion="Automatic" macOSVersion="Automatic" iOSVersion="Automatic">
    <entity name="Settings" syncable="YES">
        <attribute name="filterOrderArray" optional="YES" attributeType="Transformable" syncable="YES"/>
    </entity>
    <elements>
        <element name="Settings" positionX="160" positionY="192" width="128" height="60"/>
    </elements>
</model> 
```

我还查看了项目的 .xcodeproj 文件（也是一个包），发现 project.pbxproj 文件包含以下内容：

```
/* Begin XCVersionGroup section */
        CFE0A83E164F6CF40000C765 /* Filters.xcdatamodeld */ = {
            isa = XCVersionGroup;
            children = (
                CFE0A841164F6D100000C765 /* Filters 1.3.xcdatamodel */,
                CFE0A83F164F6CF40000C765 /* Filters 1.2.xcdatamodel */,
            );
            currentVersion = CFE0A841164F6D100000C765 /* Filters 1.3.xcdatamodel     */;
            path = Filters.xcdatamodeld;
            sourceTree = "<group>";
            versionGroupType = wrapper.xcdatamodel;
        };
/* End XCVersionGroup section */ 
```

同样，没有以前的版本信息，除非它在那些十六进制字符串中，但是 Xcode / Project Navigation 中 .xcdatamodel 文件的顺序似乎是由“children”参数决定的。

我还发现重命名模型版本会破坏以前的版本连接（这表明它存储在某个地方，而不仅仅是版本的顺序），如果这样做，initWithContentsOfURL 将返回一个 nil 模型：

```
NSManagedObjectModel *model = [[NSManagedObjectModel alloc] initWithContentsOfURL:momURL]; 
```

因此，据我所知，一旦创建模型，您就无法查看或更改模型所基于的模型。如果您需要清理模型层次结构，您必须有效地重新开始并重新创建每个需要的版本（至少您可以从旧模型中复制实体，这样您就不会完全从头开始）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T07:47:25.800

添加模型的新版本允许您对模型进行更改。以前的版本允许核心数据自动迁移在早期版本下创建的持久存储。如果您编辑旧版本，则此迁移会中断。然后你开始谈论重命名，这并没有真正的联系。谈论更改版本所基于的模型是没有意义的——它只是同一模型的新版本。

一旦您拥有多版本模型，您就可以通过在项目浏览器中通过您的模型展开显示三角形来浏览版本 IIRC。

# sql-server-2008-r2 - 实体框架代码第一个基类未映射到数据库

> ID：13150774
> 
> 赞同：9
> 
> 时间：2012-10-31T03:16:14.643
> 
> 标签：sql-server-2008-r2, ef-code-first, entity-framework-5

我在 C# 中首先使用实体​​框架代码，并且我有许多实体具有用于跟踪的相同列。我使用的列是 Active、IsDeleted、CreatedBy、ModifiedBy、DateCreated 和 DateUpdated。必须将这些属性添加到我想要跟踪的每个实体中似乎很乏味。我想要一个我的实体可以继承的基类，如下所示。

```
public abstract class TrackableEntity
{
    public bool Active { get; set; }
    public bool IsDeleted { get; set; }
    public virtual User CreatedBy { get; set; }
    public virtual User ModifiedBy { get; set; }
    public DateTime DateCreated { get; set; }
    public DateTime DateModified { get; set; }
} 
```

然后我可以从我的实体中的此类继承以具有这些属性，并且当生成数据库时，它将为每个实体提供这些列。

```
public class UserProfile : TrackableEntity, IValidatableObject
{
    public int Id { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string Email { get; set; }
    public string Phone { get; set; }

    public bool IsValid { get { return this.Validate(null).Count() == 0; } }

    public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
    {
        if (String.IsNullOrEmpty(FirstName))
            yield return new ValidationResult("First name cannot be blank", new[] { "Username" });

        if (String.IsNullOrEmpty(LastName))
            yield return new ValidationResult("Last cannot be blank", new[] { "Password" });

        //Finish Validation Rules
    }
} 
```

我真的很想减少代码重复并使用类似这样的某种方法，但我无法让它工作。我不断收到以下错误：

> 无法确定类型“Namespace.Models.User”和“Namespace.Models.User”之间关联的主体端。此关联的主体端必须使用关系流式 API 或数据注释显式配置。

我已经四处寻找了几天，但找不到我想做的事情的答案。我真的不想创建一个所有内容都链接到的单独表。我读过 TPT、TPH 和 TPC。TPC 似乎非常接近我想要的，但是在我几乎所有的桌子上共享 PK 是我绝对不想做的。

这是我希望我的表看起来像的示例。这些表将由从 TrackableEntity 继承的实体创建。

```
[UserProfile]
    [Id] [int] IDENTITY(1,1) NOT NULL
    [FirstName] [varchar](50) NOT NULL
    [LastName] [varchar](50) NOT NULL
    [Email] [varchar](255) NOT NULL
    [Phone] [varchar](20) NOT NULL
    [CreatedBy] [int] NOT NULL
    [ModifiedBy] [int] NOT NULL
    [DateCreated] [datetime] NOT NULL
    [DateModified] [datetime] NOT NULL
    [Active] [bit] NOT NULL
    [IsDeleted] [bit] NOT NULL

[CaseType]
    [Id] [int] IDENTITY(1,1) NOT NULL
    [Name] [varchar](50) NOT NULL
    [CreatedBy] [int] NOT NULL
    [ModifiedBy] [int] NOT NULL
    [DateCreated] [datetime] NOT NULL
    [DateModified] [datetime] NOT NULL
    [Active] [bit] NOT NULL
    [IsDeleted] [bit] NOT NULL 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-31T22:42:15.797

很可能您遇到此异常，因为您的`User`类也派生自`TrackableEntity`：

```
public class User : TrackableEntity 
```

结果是`User`实体现在包含两个继承的属性

```
public virtual User CreatedBy { get; set; }
public virtual User ModifiedBy { get; set; } 
```

按照惯例，Entity Framework 将假定两个属性之间的关系，即*以*这两个导航属性作为其两端的关系。因为导航属性是引用而不是集合 EF 推断出*一对一的*关系。因为在模型中未指定两个导航属性中的哪一个具有关系的相关外键，所以 EF 无法确定关系的主体和依赖关系 - 这会导致异常。

现在，这个问题可以通过显式定义主体和依赖来解决 - 正如异常所表明的那样。但是在您的模型中，约定 - 即假设*一对一的*关系 - 是不正确的。您实际上需要*两种*关系，一种来自`CreatedBy`（使用自己的外键），另一种来自`ModifiedBy`（使用另一个外键）。两种关系都是*一对多的*（因为 a`User`可以是许多其他用户的创建者或修改者）并且在关系的另一端没有导航集合。您必须使用 Fluent API 提供映射以覆盖约定并定义这两个一对多关系：

```
public class UnicornsContext : DbContext
{
    public DbSet<User> Users { get; set; }
    public DbSet<UserProfile> UserProfiles { get; set; }
    public DbSet<CaseType> CaseTypes { get; set; }
    // ... etc.

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Entity<User>()
            .HasOptional(u => u.CreatedBy)
            .WithMany()
            .Map(m => m.MapKey("CreatedBy")); // FK column name in DB table

        modelBuilder.Entity<User>()
            .HasOptional(u => u.ModifiedBy)
            .WithMany()
            .Map(m => m.MapKey("ModifiedBy")); // FK column name in DB table
    }
} 
```

请注意，我使用`HasOptional`了而不是`HasRequired`（这意味着数据库中的 FK 可以为空），因为 - 至少对于自动递增的 Ids - 您不能使用 a`CreatedBy`或被`ModifiedBy`设置来创建第一个用户 - 它只能指本身，但没有任何有效的 FK 值可以使用，因为第一个 PK 尚未创建。

（您也可以考虑避免`CreatedBy`or的关系和引用约束，`ModifiedBy`而仅将用户名存储为创建者和修改者，因为出于审计和跟踪目的，保存唯一人员的身份可能就足够了。您真的需要*导航*吗？从每个实体到它的创建者和修改者？即使你在特殊情况下需要它，你仍然可以手动加入到用户表中。如果用户从用户表中删除，只要名称仍然存在，会不会有问题存储在`CreatedBy`或`ModifiedBy`？）

只要不`DbSet`为抽象基类引入a，就不必处理任何继承映射...

```
public DbSet<TrackableEntity> TrackableEntities { get; set; } // NO! 
```

...或该类的 Fluent API 中的映射...

```
modelBuilder.Entity<TrackableEntity>()... // NO! 
```

...或将该类用作任何其他类中的导航属性：

```
public class SomeEntity
{
    //...
    public virtual TrackableEntity Something { get; set; } // NO!
    public virtual ICollection<TrackableEntity> Somethings { get; set; } // NO!
} 
```

使用这些中的任何一个，EF 将`TrackableEntity`作为一个实体进行推断，并在模型和数据库表之间引入继承映射（默认为 TPH）。否则`TrackableEntity`只是一个基类，并且基类中的每个属性都将被视为派生实体中的属性并映射到数据库表。

# css - HTTParty 类中的未定义方法

> ID：13150777
> 
> 赞同：1
> 
> 时间：2012-10-31T03:16:22.367
> 
> 标签：css, ruby-on-rails, image, api, httparty

我对rails有点陌生，每次我认为我会遇到它时，我都会碰壁。

我正在使用`HTTParty`这个[API](http://snapito.com/paid-api.jsp)。我只是想在我的索引视图中显示一个响应，以获得最低级别的 api 工作。

它在控制台中对我有用，但在我在 API 中测试时却没有。我得到一个

```
undefined method `picture' for Snapshots:Class 
```

我的索引视图错误。

这是 HTTParty 类

```
class Snapshots
  include HTTParty

  def initialize
    @sitename = "google.com"
  end

  def picture
    response = HTTParty.get("http://api.snapito.com/web/516e011353b62078731712566b01e143f56adf0b/full/diditmatter.herokuapp.com/lists")

    if respone.success?
      response
    end
  end
end 
```

这是我的列表控制器

```
def index
    @it_works = Snapshots.picture

    respond_with(@lists = List.all)
end 
```

这是列表视图

```
<%= @it_works %>

<h1 class="page-header">Projects at a glance</h1> 
<div class="span12 offset2"> 
 <% @lists.each do |list| %> 
  <div class="well row span4">
    <div class="span3">
    </div>  
    <div class="span4"> 
```

我在这里似乎忽略了什么？

编辑

@Benjamin 修复工作，但我遇到了一个我不确定是否与 Rails 相关的问题。我不确定我是否应该提出另一个问题。但是由于上下文在这里，我什至不确定如何搜索它，我必须在这里跟进。

该实例变量正在返回附加的屏幕截图。这与我从第一段中链接到的 API 调用它的方式有关吗？

![在此处输入图像描述](../Images/f7f2c0d944dd11b184bf38ccc686edef.png)我从来没有见过这个，所以不确定在哪里看或如何接近。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:29:19.743

您将该`picture`方法视为类方法。将其更改为：`@it_works = Snapshots.new.picture`

# angularjs - 如何从其他自定义指令动态添加自定义指令

> ID：13150778
> 
> 赞同：0
> 
> 时间：2012-10-31T03:16:27.207
> 
> 标签：angularjs

我创建了一个与数据表具有相似功能的指令，但它是为我们的应用程序定制的。我在指令范围内拥有的一件事是`columnDefinitions`. 该数组中的每个对象都有一个名为 的属性`data`。我已经对其进行了设置，因此如果将其设置为字符串，它会在实体上查找该属性，并且它是一个函数，它将使用实体调用该函数。所以基本上是这样的：

```
scope.getEntityData = function(entity, currColumnDefinitionData) {
            var entityData = null;
            if (angular.isString(currColumnDefinitionData))
            {
                entityData = entity[currColumnDefinitionData];
            }
            else if(angular.isFunction(currColumnDefinitionData))
            {
                entityData = currColumnDefinitionData(entity);
            }
            else
            {
                $log.error("Column defintion data property must be a string or a function. Cannot get entity data.");
            }
            return entityData;
        }; 
```

然后在我的指令模板中，是这样的：

```
<tr ng-repeat="currEntity in entities">
    <td ng-repeat="currColDef in columnDefinitions">
        {{getEntityData(currEntity, currColDef.data)}}
    </td>   
</tr> 
```

当我只需要输出一个字符串时，这很有效。我现在有一个案例，我希望它为该列中的数据插入指令。我首先让 data 属性等于 HTML 字符串。例如：

```
data: function(entity) {
        return '<div my-directive></div>';
    }, 
```

但是，这导致字符串刚刚被插入到表格单元格中（Angular 为我转义了文本）

我想知道的是如何设置我的指令，以便我可以将编译后的指令放入我的表格单元格中。我考虑过用某种方式告诉自己这是一个指令，然后用`$compile`服务编译它，但后来我不知道从我的函数中返回什么才能让它正常工作。任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T23:33:35.100

这就是我将如何做到的

指令：

```
angular.module('ui.directives').directive('uiCompile',
    [ '$compile', function(compile) {
      return {
        restrict : 'A',
        link : function(scope, elem, attrs) {
          var html = scope.$eval('[' + attrs['uiCompile'] + ']')[0];

          elem.html(html);
          compile(elem.contents())(scope);
        }
      }
    } ]); 
```

模板：

```
<tr ng-repeat="currEntity in entities">
    <td ng-repeat="currColDef in columnDefinitions" ui-compile="currColDef"></td>   
</tr> 
```

基本上，对于每个列定义，使用当前范围将内容编译为模板。

# php - 如何遍历 PHP 中的对象数组？用对象方法，类静态方法？

> ID：13150785
> 
> 赞同：0
> 
> 时间：2012-10-31T03:18:02.210
> 
> 标签：php, oop, static, iterator, iteration

我需要检查对象数组中的*任何*对象是否包含某个变量值。

IE 如果`$object_array`包含 15 个`$object`对象，我想知道其中是否有一个对象的`$type`属性设置为`$some_type`. 函数的内部并不那么重要，因为它访问`get`. `$object`我可以使用 foreach 或 array_walk 或其他任何东西。我的问题的症结是，我把这个方法放在哪里？

该函数如下所示：

```
public function hasSomeType($object_array,$some_type) {
    foreach($object_array as $object) {
      if($object->get('type') == '$some_type') {
        return true;
      }         
    }
    return false;
} 
```

所有被测试的对象都有一个 $type 属性，可以通过它们的公共`get`方法访问。

我应该把这个方法放在哪里？我应该使它成为`$object`类的静态方法吗？

或者我应该创建一个新类，并使用它的一个对象来执行这个操作。

我对 PHP 的内置结构（如“迭代器”）及其使用方式非常不熟悉。我不知道它们是否适用于我的情况。我将非常感谢我能得到的任何帮助。

谢谢你。

编辑：注意我修复了上面的功能。把“return false”放在正确的地方，把函数签名放进去。

EDIT2：更改了函数名称并添加了`$some_type`参数，以希望更清楚地表明我正在检查该`$type`属性的某些值。但是，问题仍然是“我应该把这个方法放在哪里”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:52:24.183

[http://ca3.php.net/manual/en/function.get-object-vars.php](http://ca3.php.net/manual/en/function.get-object-vars.php)

因为它是一个范围敏感的操作，所以将它放在类内部或外部都会产生差异结果，如果在类内部，私有成员在范围内。如果在外面，您将被限制在可见的范围内。

打破它只是为了解释这个想法：

```
class Bar {

   public function check( $type = 'int' ) {
       $vars = get_object_vars( $this );
       foreach( array_values( $vars ) as $v )
           if( stristr( $v, $type ) !== FALSE )
              return true;

       return false;
   }
} 
```

例如，如果您的类都扩展了 Bar，或者实现了该功能“检查”，那么您可以传递您正在寻找的内容。使用您的代码：

```
function checkArrayOfObjects( $object_array = array() )
{
    foreach($object_array as $object)
        if( is_object( $object ) /*&& $object instanceof Bar*/ && $object->check('int') )
            return true;
    return false;
} 
```

请注意，在您的初始代码中，它只会检查第一个对象；）

祝你好运。

此外，如果您过于简单化了您的问题，请查看 PHP 的 ReflectionClass [http://ca3.php.net/manual/en/class.reflectionclass.php](http://ca3.php.net/manual/en/class.reflectionclass.php)

*下面评论中的代码*

```
public function hasVarchar($object_array) { 
    foreach($object_array as $object) { 
        $vars = get_object_vars( $object ); 
        foreach( array_values( $vars ) as $v ) 
            if( stristr( $v, 'string') !== FALSE ) 
                return true; 
        }
        return false; 
     }
} 
```

# hadoop - 如何计算 Hadoop 的不同集合

> ID：13150788
> 
> 赞同：0
> 
> 时间：2012-10-31T03:18:12.280
> 
> 标签：hadoop, mapreduce

我有两个文件，如下所示。

对于文件 A

```
AA
BB
CC
DD
EE
FF 
```

对于文件 B

```
BB
CC
DD
UU
VV 
```

我的工作是找到那些出现在文件B中而不出现在文件A中的单词。你可以认为文件B只是一个文件，而文件A是一堆文件。

下面是我正在做的事情。

对于地图阶段：

```
emit(word,filename) 
```

对于减少阶段：

检查单词，

```
if COUNT(values)>1:
   ignore it. 
if COUNT(values)==1 and filename != A:
   ignore it.
emit(word) 
```

你有更好的解决方案吗？

**更新**

一个文件中没有重复条目。

此致，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T06:29:29.937

您的解决方案有问题。

```
if COUNT(values)>1:
   ignore it. 
for file A

AA
BB
CC
DD
EE
FF
for file B

BB
CC
DD
UU
VV
VV 
```

所以 VV 不会出现在错误的 ans 中。

* * *

（更改）答案：

减少 ：

```
 if(value.contains(FileName A) && value.contains(FileName B))
  ignore;
else if (value.contains(FileName A) && !value.contains(FileName B))
 ignore;
 else 
emit(key) 
```

* * *

# mysql - 数据库：表格设计/结构

> ID：13150791
> 
> 赞同：1
> 
> 时间：2012-10-31T03:18:57.357
> 
> 标签：mysql, database, database-design, phpmyadmin

我是数据库结构和设计的新手。目前，我正在创建一个课程目录，该目录将根据课程名称和日期匹配课程描述。我画了一张描述课程的表格，其中包括`course_code`和`name`所有其他相关信息。然后我又画了一张表格，将这些课程与授课时间联系起来。

我缺少归类为`all_year`. 我也错过了如何在专业下标记课程的方法。由于假设一门课程可以属于多个专业，因此将数据从一个专业放入另一个专业会迫使您重复数据。有什么想法可以在我的表格设计中实现这两件事吗？或有关如何重组我的设计的建议。如果可能的话，请告诉我一个要在我的`phpmyadmin`数据库中执行的查询。

餐桌课程示例

```
id serial
course_code text
description text 
```

course_dates 表示例

```
id serial
course_id serial
year date
semester 
```

表专业的例子

```
major_id int
course_id int 
```

因此，填充的数据库可能包含以下内容：

```
Table courses
id course_code description
1  INF1000     "Basic programming"
2  INF1001     "More basic programming" 
```

表 course_dates（春季 0 秋季 1 秋季）

```
id course_id year semester
1  1         2012 0
2  1         2013 1
3  2         2013 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:33:09.230

要将课程链接到专业 - 这是一对多的关系（一门课程到多个专业） - 您需要使用具有这种结构的链接表：

```
 table courses_majors
 major_id int
 course_id int 
```

记住也要索引这个表——它非常重要。然后你可以填充它，让一门课程甚至去许多专业和许多课程到一个专业（多对多关系）。

然后，您可以在此表中的表上运行联接：

`select * from courses left join courses_majors on courses.id = courses_majors.course_id left join majors on courses_majors.majors_id = majors.id`

当然，您可以添加 where 子句等。

另一种方法是创建专业表：

```
 majors
 id int
 name varchar 
```

然后在您的课程表中添加一个 major_id - 这只会为您提供从课程到专业的一对一关系，但许多课程可以加入专业。

至于每年，我会在数据库中添加一个字段来说明这一点，可能是一个很小的 ​​int 并将其设为 0 或 1。

# ruby-on-rails-3 - Rails 查询仅第一次返回结果

> ID：13150792
> 
> 赞同：1
> 
> 时间：2012-10-31T03:19:07.350
> 
> 标签：ruby-on-rails-3

我正在开发的应用程序中遇到异常问题。

我正在编写一个控制器/视图来生成一个 sitemap.xml 资源。我第一次通过在浏览器中查看它来测试它时，它工作得很好。

但是第二次，当我刷新视图时，没有返回页面结果，并且站点地图实际上是空的。

如果我对代码进行更改。只需添加一个空行或删除它，然后第一次正确生成站点地图。任何额外的刷新都是空的。

这是代码：

站点地图控制器

```
class SitemapController < ApplicationController
    layout nil

    def index
        @pages = Page.where(:publish => true)
        @base_url = "http://#{request.host_with_port}"
        headers['Content-Type'] = 'application/xml'
        def index
            respond_to do |format|
                format.xml
            end
        end
    end
end 
```

这是sitemap.xml.erb

```
<?xml version="1.0" ?>
<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
<% @pages.each do |page| %>
  <url>
    <loc><%= "#{@base_url}/#{page.permalink}" %></loc>
    <lastmod><%= page.updated_at %></lastmod>
    <priority>0.5</priority>
  </url>
<% end unless @pages.nil? %>
</urlset> 
```

和路线

```
match "/sitemap.xml", :to => "sitemap#index", :defaults => {:format => :xml} 
```

奇怪的是，它似乎在控制器的查询中。

```
@pages = Page.where(:publish => true) 
```

这会在连续尝试时返回 nil，但应用程序其他部分中的类似查询每次都有效。我尝试过使用 Page.all 和 Page.find :all 等替代方法，但问题仍然存在。

我还将它上传到 Heroku 上的应用程序，想知道它是否在我的环境中，但它也发生在那里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T03:32:57.770

你的`SitemapController#index`方法正在重新定义自己。为了澄清问题：

```
def fn
  def fn
    2
  end
  1
end

fn
# => 1
fn
# => 2 
```

请尝试：

```
class SitemapController < ApplicationController
    layout nil

    def index
        @pages = Page.where(:publish => true)
        @base_url = "http://#{request.host_with_port}"
        headers['Content-Type'] = 'application/xml'
        respond_to do |format|
            format.xml
        end
    end
end 
```

此外，[`sitemap_generator`宝石](https://github.com/kjvarga/sitemap_generator)效果很好。

# javascript - Javascript 正则表达式正前瞻

> ID：13150800
> 
> 赞同：1
> 
> 时间：2012-10-31T03:20:12.683
> 
> 标签：javascript, regex, debugging, syntax

将 aa 正则表达式的开头和结尾定义为捕获组中的边界的正确语法是什么`word`，如下所示：

```
var $classes = $( 'body' ).attr('class'); // string 'foo bar sub-theme-home';
var regex = /sub-theme-(?=(\b))/;
var sub_theme = regex.exec($classes);
console.log(sub_theme[0]); 
```

这是匹配`sub-theme-`的，虽然如果我需要将其包含在我的捕获中并进行字符串替换以将其删除，这很好，但我无法确定我的`(?-(\b))/`捕获组的正确语法。似乎有积极的前瞻，`sub-theme-`应该是省略的部分，`home`应该被捕获......帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T03:26:42.533

为什么不直接捕获您要查找的字符串？

```
var $classes = $( 'body' ).attr('class'); // string 'foo bar sub-theme-home';
var regex = /sub-theme-(\w+)/;
var sub_theme = regex.exec($classes);
console.log(sub_theme[1]); 
```

查看更多关于带括号的子字符串和[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/exec#Description)的结果`regex.exec(...)`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T03:27:38.867

试试这个：

```
var regex = /sub-theme-(\w+)/; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-31T03:33:55.440

Javascript RegExp 不支持某些高级正则表达式功能，例如lookbehindes、命名捕获组……这本书（面向 Web 开发人员的专业 Javascript，第 3 版）p136：

模式限制

> 尽管 ECMAScript 的正则表达式支持已经完全开发，但它确实缺少一些在 Perl 等语言中可用的高级正则表达式特性。ECMAScript 正则表达式不支持以下功能（有关更多信息，请参阅 www.regularexpressions.info）：

*   \A 和 \Z 锚点（分别匹配字符串的开头或结尾）
*   回顾
*   联合和交叉类
*   原子分组
*   Unicode 支持（一次匹配单个字符除外）
*   命名捕获组
*   s（单行）和 x（自由间距）匹配模式
*   条件句
*   正则表达式注释

尽管有这些限制，ECMAScript 的正则表达式支持对于完成大多数模式匹配任务来说还是足够强大的。

# html - 如何在图像顶部垂直和水平居中对齐描述？

> ID：13150805
> 
> 赞同：0
> 
> 时间：2012-10-31T03:21:07.940
> 
> 标签：html, css, image

# 编辑

我应该说我有多个图像要连续放置。mdk 提供的解决方案有效，但每个图像都出现在新行上。

我有描述和图像。我将描述覆盖在图像顶部。目前它在图像的底部左对齐。我想让描述在水平和垂直方向上居中对齐，但这样做有困难。使用的图像尺寸为 320 x 240。

```
 <!-- image -->
        <div style="position: relative; left: 0; top: 0;">

    <a href="test.html"> <img src = "test.png" style="position: relative; top: 0; left: 0; width: 320px;"></a>

        <!-- description div -->
        <div class='description'>
            <!-- description content -->
            <p class='description_content'>This is the description of the image</p> 
            <!-- end description content -->
        </div>
        <!-- end description div -->

    </div>
    <!-- end image div -->

</div>
<!-- end wrapper div --> 
```

# css

```
div.wrapper{
    float:left; /* important */
    position:relative; /* important(so we can absolutely position the description div */ 
    padding: 5px;
}
div.description{
    position:absolute; /* absolute position (so we can position it where we want)*/
    bottom:0px; /* position will be on bottom */
    left:0px;
    /* styling bellow */
    background-color:black;
    font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    font-size:18px;
    font-weight:900;
    color:white;
    opacity:0.75; /* transparency */
    filter:alpha(opacity=70); /* IE transparency */
}
p.description_content{
    padding:10px;
    margin:0px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T06:17:05.883

如果图像始终大小相同，您可以使用 css top 属性而不是 bottom 例如

```
div.description{
                top:130px;
                text-align:center;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T06:54:40.387

这是一个解决方案，在同一行上显示两个图像，使用 display:table 在包装上， display:table-cell 在描述上。然后您可以使用 vertical-align: middle 将文本垂直居中。使用垂直对齐比设置顶部更好，因为将顶部设置为固定数量不会考虑描述中的多行。

这是一个工作小提琴：http: [//jsfiddle.net/manishie/WSzE2/](http://jsfiddle.net/manishie/WSzE2/)

**HTML**

```
<div class="wrapper">
    <a href="test.html"> <img height=240 width=320 src = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQYm7nE5wc8NLS4tY4zzx-kamyn656ziK8Ma9fnmZLDASZS6oya4g"></a>
    <div class='description'>
        <p class='description_content'>This is the description of the image</p> 
    </div>
</div>

<div class="wrapper">
    <a href="test.html"> <img height=240 width=320 src = "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQYm7nE5wc8NLS4tY4zzx-kamyn656ziK8Ma9fnmZLDASZS6oya4g"></a>
    <div class='description'>
        <p class='description_content'>This is a multi line description of the image. abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc abc </p> 
    </div>
</div> 
```

**CSS**

```
div.wrapper{
    float:left; /* important */
    display: table;
    width: 320px;
    height: 240px;
}
div.wrapper img {
    position: absolute;   
    z-index: -100;        
}

div.description{
    display: table-cell;
    vertical-align: middle; /* to vertically center */
    text-align: center; /* to horizontally center */
}
p.description_content{
    color: white;
    background: grey;
}
​ 
```

# wordpress - 为什么我在保存帖子后（安装全局自定义字段后）在 wordpress 上得到一个空白页

> ID：13150807
> 
> 赞同：0
> 
> 时间：2012-10-31T03:21:29.940
> 
> 标签：wordpress

我刚刚安装了全局自定义字段，如下所示[http://digwp.com/2009/09/global-custom-fields-take-two/](http://digwp.com/2009/09/global-custom-fields-take-two/)

基本上我在我的主题/主题名/functions.php上添加了这个：

```
<?php

//Custom Theme Settings
add_action('admin_menu', 'add_gcf_interface');

function add_gcf_interface() {
    add_options_page('Global Custom Fields', 'Global Custom Fields', '8', 'functions', 'editglobalcustomfields');
}

function editglobalcustomfields() {
  // the html form (too long to bother you with)
}
    ?> 
```

现在，当我保存帖子时，我得到一个空白页。帖子确实被保存了。

你能以任何方式提供帮助吗？

我得到这两个错误

```
Notice: has_cap was called with an argument that is deprecated since version 2.0! Usage of user levels by plugins and themes is deprecated. Use roles and capabilities instead. in/www/newBlogs/w.sandbox/wp-includes/functions.php on line 2722

Warning: Cannot modify header information - headers already sent by (output started at /www/newBlogs/w.sandbox/wp-content/themes/boilerplate/functions.php:548) in/www/newBlogs/w.sandbox/wp-includes/pluggable.php on line 881 
```

谢谢

# debugging - 在 Visual Studio 中调试文件范围

> ID：13150808
> 
> 赞同：4
> 
> 时间：2012-10-31T03:21:38.903
> 
> 标签：debugging, scope, visual-studio-debugging

在 Visual Studio 2012 中，我有这个超级简单的 C++ 程序：

```
#include "stdafx.h"
#include <iostream>

int _tmain(int argc, _TCHAR* argv[])
{
    std::cout << std::cout;
    int i = 1;
    return 0;
} 
```

如果您想知道，“std::cout << std::cout”部分只是为了表明可以在函数范围内访问 std:cout - 是的，它旨在打印指向控制台的指针。

所以我在“int i = 1”处设置了一个断点。当断点触发时，我想从命令行窗口（或即时窗口）检查 std::cout，所以我输入：

> >Debug.Print std::cout

但它返回以下错误：

> 标识符“std”未定义

我不明白为什么会发生这种情况，std 应该在正在执行的函数的范围内。来自 #include 指令的任何其他内容也是如此，我只是无法使用 Debug.Print 检查它。我在 Visual Studio 2012 中使用什么来检查执行范围内可访问的所有内容？看来我只能使用 Debug.Print 访问局部变量。

# ios - 将基本 HTTP 身份验证标头添加到 AFHttpRequestOperation 和下载文件

> ID：13150815
> 
> 赞同：2
> 
> 时间：2012-10-31T03:23:22.163
> 
> 标签：ios, afnetworking

我在 AFHttpRequestOperation 中找不到任何可以添加 HTTP 标头的 API。看起来 AFHttpClient 具有这种支持，但所有示例似乎都使用 AFHttpClient 来发布数据而不是下载。

如何将自定义 Http 标头或身份验证标头添加到 AFHttpRequestOperation？

另外，有没有办法从内存中的 HTTP 服务器下载数据作为 NSData，而不是在使用 AFHttpRequestOperation 时直接将其写入文件？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T00:09:35.267

您是正确的，AFHTTPRequestOperation 中没有直接的方法来添加 HTTP 标头，幸运的是这是故意的。

AFHTTPRequestOperation 的设置一开始可能看起来很麻烦，但一旦你使用它就很有意义。

1.  创建一个 AFHTTPClient。`AFHTTPClient *client = [AFHTTPClient clientWithBaseURL:[NSURL URLWithString:@"http://mysite.com]];`

2.  使用适当的方法在 AFHTTPClient 中设置您的标头：
    `[client setDefaultHeader:@"key" value:@"value"];
    [client setAuthorizationHeaderWithUsername:@"username" password:@"password"];
    [client setAuthorizationHeaderWithToken:@"token"];`

3.  使用您的 AFHTTPClient 创建一个 NSURLRequest，这是关键
    `NSURLRequest *request = [client requestWithMethod:@"someMethod" path:@"somePath" parameters:nil];`

4.  使用您的 NSURLRequest 创建 AFHTTPRequestOperation
    `AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];`

从那里你准备好了。您可以使用`- setCompletionBlockWithSuccess:failure:`，也可以只使用`[operation start]`并做其他事情。但这应该与您想要的任何 HTTP 标头完美配合。

# symfony - 找不到类 Symfony2

> ID：13150825
> 
> 赞同：0
> 
> 时间：2012-10-31T03:24:46.617
> 
> 标签：symfony, ffmpeg, php-extension

我已经在我的服务器上安装了 ffmpeg.so 扩展。我想在我的 Symfony 2 应用程序中使用 ffmpeg-php 库。如果我做：

```
$ffmpeg = new ffmpeg_movie('movie.flv'); 
```

在一个独立的 php 文件中，它运行良好。但是如果我将相同的代码放入我的 Symfony2 控制器中，我会得到

```
Fatal error: Class 'Example\ExampleBundle\Controller\ffmpeg_movie' not found in... 
```

它必须与 Symfony 的命名空间选项有关，但我不确定如何解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:38:26.233

当您在特定命名空间中时，任何没有命名空间的类引用都将被视为该命名空间的本地类。在您的示例中，它`ffmpeg_movie`被视为`Example\ExampleBundle\Controller`命名空间类。

如果您想访问另一个名称空间，其中包括全局名称空间（包括 PHP 类、接口以及任何自定义的全局项），您有两种选择。

1.  使用它的完整命名空间（`\`用于全局）和类名访问它：

    ```
    $obj = new \ffmpeg_movie;
    $obj = new \DateTime; 
    ```

2.  使用以下方法引用外部类`use`：

    ```
    use ffmpeg_movie;
    use DateTime as AwesomeDateTimeClass;

    $obj = new ffmpeg_movie;
    $obj = new AwesomeDateTimeClass; 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:28:07.320

哎呀，原来你可以添加

```
use ffmpeg_movie; 
```

在控制器的顶部，与任何其他类相同。傻我。

# javascript - 使用 AngularJS 和 MeteorJS

> ID：13150826
> 
> 赞同：10
> 
> 时间：2012-10-31T03:24:46.360
> 
> 标签：javascript, model-view-controller, angularjs, meteor

所以我对这两种技术都很陌生。我的计划是使用 MeteorJS 实现他们使用 Backbone ( [https://github.com/philipkobernik/backbone-tunes](https://github.com/philipkobernik/backbone-tunes) ) 制作的 Peepcode Tunes 项目，然后尝试使用 MeteorJS 和 AngularJS 插件来实现它。有人已经在 Angular 中完成了这一切：[https ://github.com/angular/peepcode-tunes](https://github.com/angular/peepcode-tunes)

大多数事情都进行得很顺利。你可以看到我到目前为止在：

只是流星：[https](https://github.com/Jonovono/Meteor-peepcode-tunes) ://github.com/Jonovono/Meteor-peepcode-tunes 流星和 AngularJs：[https ://github.com/Jonovono/Meteor-angular-peepcode-tunes](https://github.com/Jonovono/Meteor-angular-peepcode-tunes)

我真的很喜欢使用 Angular 并能够从视图中传递一些东西，例如：

```
ng-click="pl.add(album)"> 
```

仅使用 Meteor 时，这似乎更复杂。

但是我有一个问题。假设我想在每次添加/删除专辑时保存播放列表。因此，如果页面被刷新，它仍然存在。我不知道做到这一点的最佳方法，当使用 AngularJS 和 Meteor 时，我很困惑应该如何做到这一点。

现在在使用 Angular 和 Meteor 时，我会做这样的事情：

```
$scope.Playlist = new Meteor.AngularCollection("playlist", $scope);
$scope.playlist = $scope.Playlist.findOne({});

    $scope.pl.add = function(album) {
    if ($scope.playlist.indexOf(album) != -1) return;
    $scope.playlist.push(album);
    $scope.playlist.$save();
}; 
```

但是，这似乎并没有将其保存到数据库中。但是，如果我要执行以下操作：

```
 album.title = "CHANGED"
    album.$save() 
```

似乎它会将其保存到数据库中。

我确信我只是错过了一些关于 Meteor 或 AngularJS 添加到它的小东西。任何启蒙都会很棒！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-02T22:15:30.800

这里的桥梁的创造者。你是从 github 上拉最新版本的吗？我还没有更新关于气氛的版本。对不起。.findOne 需要一些额外的代码，今晚会推送它。

[https://github.com/lvbreda/Meteor_angularjs](https://github.com/lvbreda/Meteor_angularjs)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-10-07T22:25:23.890

新桥的创建者在这里:)

由于不再维护旧桥，我们的团队编写并积极维护这个库 - [angular-meteor](https://github.com/Urigo/angular-meteor)，我们还发布了一个结合两者的教程 - [angular-meteor 教程](http://angularjs.meteor.com/tutorial)

很想听听你的想法！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-19T19:36:55.567

你可以使用Uri提到的角度流星+你可以看到更多可用的 [角度模块](https://atmospherejs.com/angularjs)

# javascript - 从文本文件中读取输入以获取谷歌图表 api 中的数据

> ID：13150828
> 
> 赞同：1
> 
> 时间：2012-10-31T03:25:08.257
> 
> 标签：javascript, jsp, google-visualization

我正在使用 Google Chart API 来实现饼图。他们网站上的示例：[https](https://code.google.com/apis/ajax/playground/?type=visualization#pie_chart) ://code.google.com/apis/ajax/playground/?type=visualization#pie_chart使用静态值来制作图表。

如果我想从文本文件中读取数据怎么办？我该怎么做呢？

# java - Android - 如何从 SQLite 数据库处理程序传递字符串 id

> ID：13150829
> 
> 赞同：0
> 
> 时间：2012-10-31T03:25:15.917
> 
> 标签：java, android, sqlite

我想从 SQLite 数据库传递一个用户 ID，但我很难弄清楚。我一直在做我的研究，但由于我的java技能水平低，我无法采取任何进一步的行动。请帮我解决这个问题，我们将不胜感激。

这是错误日志

```
10-30 23:04:13.795: E/AndroidRuntime(22860): FATAL EXCEPTION: main
10-30 23:04:13.795: E/AndroidRuntime(22860): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{com.app.android/com.app.android.MainActivity}: java.lang.NullPointerException
10-30 23:04:13.795: E/AndroidRuntime(22860):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1894)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1995)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at android.app.ActivityThread.access$600(ActivityThread.java:128)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1161)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at android.os.Handler.dispatchMessage(Handler.java:99)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at android.os.Looper.loop(Looper.java:137)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at android.app.ActivityThread.main(ActivityThread.java:4517)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at java.lang.reflect.Method.invokeNative(Native Method)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at java.lang.reflect.Method.invoke(Method.java:511)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:747)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at dalvik.system.NativeStart.main(Native Method)
10-30 23:04:13.795: E/AndroidRuntime(22860): Caused by: java.lang.NullPointerException
10-30 23:04:13.795: E/AndroidRuntime(22860):    at android.content.ContextWrapper.getApplicationContext(ContextWrapper.java:101)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at com.app.android.MainActivity.<init>(MainActivity.java:16)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at java.lang.Class.newInstanceImpl(Native Method)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at java.lang.Class.newInstance(Class.java:1319)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at android.app.Instrumentation.newActivity(Instrumentation.java:1027)
10-30 23:04:13.795: E/AndroidRuntime(22860):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1885) 
```

数据库处理程序类

```
public class DatabaseHandler extends SQLiteOpenHelper {

    private static final int DATABASE_VERSION = 2;

    private static final String DATABASE_NAME = "app";
    private static final String TABLE_LOGIN = "login";

    private static final String KEY_ID = "id";  
    private static final String KEY_NAME = "name";  

    public DatabaseHandler(Context context) {
        super(context, DATABASE_NAME, null, DATABASE_VERSION);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        String CREATE_LOGIN_TABLE = "CREATE TABLE " + TABLE_LOGIN + "("
                + KEY_ID + " INTEGER PRIMARY KEY,"          
                + KEY_NAME + " TEXT" + ")";
        db.execSQL(CREATE_LOGIN_TABLE);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {

        db.execSQL("DROP TABLE IF EXISTS " + TABLE_LOGIN);
        onCreate(db);
    }

    public void addUser(String id, String name) {
        SQLiteDatabase db = this.getWritableDatabase();

        ContentValues values = new ContentValues();
        values.put(KEY_ID, id); // id       
        values.put(KEY_NAME, name); // name     
        db.insert(TABLE_LOGIN, null, values);
        db.close(); 
    }

    public HashMap<String, String> getUserDetails(){
        HashMap<String,String> user = new HashMap<String,String>();
        String selectQuery = "SELECT  * FROM " + TABLE_LOGIN;

        SQLiteDatabase db = this.getReadableDatabase();
        Cursor cursor = db.rawQuery(selectQuery, null);

        cursor.moveToFirst();
        if(cursor.getCount() > 0){
            user.put("id", cursor.getString(1));            
            user.put("name", cursor.getString(2));          

        }
        cursor.close();
        db.close();

        return user;
    }

    public int getUserCount() {
        String countQuery = "SELECT  * FROM " + TABLE_LOGIN;
        SQLiteDatabase db = this.getReadableDatabase();
        Cursor cursor = db.rawQuery(countQuery, null);
        int rowCount = cursor.getCount();
        db.close();
        cursor.close();

        return rowCount;
    }

    public Cursor getUserID() {
        String qry = "SELECT id FROM " + TABLE_LOGIN;
        SQLiteDatabase db = this.getReadableDatabase();     
        Cursor cursor = db.rawQuery(qry, null);
        return cursor;

    }

} 
```

MainActivity 类

```
public class MainActivity extends Activity {

    DatabaseHandler db = new DatabaseHandler(getApplicationContext());

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        Cursor id = db.getUserID();

        if(id.equals("0065")){

        Intent tab1 = new Intent(getApplicationContext(), RequestActivity.class);                                           
        tab1.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(tab1);    

        finish();

        }else{

        Intent tab = new Intent(getApplicationContext(), ReceiveActivity.class);                
        tab.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(tab);

        finish();
    }

    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:36:27.933

我不认为错误真的存在。你在某处有一个 NullPointer。logcat中的错误是由以下原因引起的：

```
DatabaseHandler db = new DatabaseHandler(getApplicationContext()); 
```

你应该初始化那个 db 变量`onCreate()`

无论如何，您返回 ID 的正确方法应该是：

```
public int getUserID() {
    String qry = "SELECT id FROM " + TABLE_LOGIN;
    SQLiteDatabase db = this.getReadableDatabase();     
    Cursor cursor = db.rawQuery(qry, null);
    int res = id.getInt(id.getColumnIndex("id"));
    cursor.close();
    return res;
} 
```

（不要忘记关闭光标

# php - PHPExcel从定义的工作表生成数据到数组

> ID：13150831
> 
> 赞同：3
> 
> 时间：2012-10-31T03:25:39.683
> 
> 标签：php, mysql, phpexcel

我想先从我的 xlsx 文件生成一个数组，然后再将其插入 Mysql，所以我使用 phpexcel，因为这个已经足够好了（我从每个网站的评论中都知道）。但是当我尝试从 xlsx 定义的工作表中创建一个数组时出现问题，这是我的脚本：

```
<?php

error_reporting(E_ALL);
set_time_limit(0);

date_default_timezone_set('Europe/London');

?>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title>Automatic Importer</title>

</head>
<body>

<h1>PHPExcel Reader Example #07</h1>
<h2>Simple File Reader Loading a Single Named WorkSheet</h2>
<?php

/** PHPExcel_IOFactory */
include 'Classes/PHPExcel/IOFactory.php';

//$inputFileType = 'Excel5';
    $inputFileType = 'Excel2007';
//  $inputFileType = 'Excel2003XML';
//  $inputFileType = 'OOCalc';
//  $inputFileType = 'Gnumeric';
$inputFileName = 'file.xlsx';
$sheetname = 'My Sheet 4';

echo 'Loading file ',pathinfo($inputFileName,PATHINFO_BASENAME),' using IOFactory with a defined reader type of ',$inputFileType,'<br />';
$objReader = PHPExcel_IOFactory::createReader($inputFileType);
echo 'Loading Sheet "',$sheetname,'" only<br />';
$objReader->setLoadSheetsOnly($sheetname);
$objPHPExcel = $objReader->load($inputFileName);

echo '<hr />';

echo $objPHPExcel->getSheetCount(),' worksheet',(($objPHPExcel->getSheetCount() == 1) ? '' : 's'),' loaded<br /><br />';
$loadedSheetNames = $objPHPExcel->getSheetNames();
$sheetData = $objPHPExcel->getActiveSheet()->toArray(null,true,true,true);
var_dump($sheetData);

?>
<body>
</html> 
```

这是错误说：

```
Fatal error: Call to a member function cellExists() on a non-object in C:\xampp\htdocs\chi\import\Classes\PHPExcel\Calculation.php on line 3241 
```

有人可以告诉错误在哪里吗？我的 OOP 不好，谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T07:31:58.023

问题在于 PHPExcel 在评估时遇到问题的电子表格公式之一，当您调用 toArray() 时，第三个参数为 TRUE，告诉该方法评估工作表中的所有公式。昨晚我确实添加了一个修复程序，其中在公式中使用了一个包含对不存在单元格的引用的命名范围......一个会触发此消息的错误；但在这种情况下（在该特定行号处有错误），它看起来好像是一个引用不存在的工作表的公式。您只加载一个命名工作表的事实使这很可能。

如果可能，您能否“遍历电子表格”，在每个单元格上使用 getCalculatedValue() 来查找哪个单元格包含触发错误的公式；然后看看那个公式是什么？

或者，加载整个工作簿而不仅仅是一个单独的工作表，然后查看错误是否仍然存在。

我将研究修补计算引擎代码以防止此错误；但这确实意味着如果公式引用的工作表不可访问，则无法正确评估该公式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T04:03:33.780

您可以从设置 Xdebug 开始，这样可以更清楚地了解错误的来源。从这段代码中，我可以假设，由于某些错误或应该读取的工作表存在问题，xlsx 文件没有被读取。

# iphone - 表格视图部分标题中的选项卡式导航

> ID：13150844
> 
> 赞同：1
> 
> 时间：2012-10-31T03:27:25.693
> 
> 标签：iphone, ios, uitableview, code-reuse

我想模仿 pinterest 应用程序的个人资料页面的行为。

您可以在 Boards/Pins/Likes（tableview 部分标题）上进行选项卡，并且 tableview 会相应更改。

下面是用于说明这一点的屏幕截图。
![在此处输入图像描述](../Images/d106e6f1b56f6b748ebde5305b36ed5d.png) ![在此处输入图像描述](../Images/906fe6adec8513ece959be9337530b24.png)

假设我可以在单独的 viewController 中创建每个选项卡（板/引脚/喜欢）。
还假设我想重用每个 viewController 的代码，因为其他视图（例如选项卡栏上的“跟随”选项卡）看起来非常像其中一个（板/针/喜欢）。

我将如何共享表格标题和表格部分标题以及足够分离的代码，以便我可以重用它们中的大部分？

基本上，我有两个带有 tableview 的 viewControllers。
现在我想创建一个带有 tableView 标题/节标题的新 viewController，用户将使用 tab 键查看前两个 viewController 的视图之一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:00:34.380

我不认为该选项卡出现在 Table Header 中，而是它可能是一个 view subclassing `UISegmentedControl`。如果你想重用它，你可以在 xib 文件中创建接口并将它与你的视图控制器链接

尝试检查这个 github 项目[https://github.com/rs/SDSegmentedControl](https://github.com/rs/SDSegmentedControl)以获取自定义 UISegmentedControl

# php - 为“标准” php 网站使用 wordpress 主题

> ID：13150849
> 
> 赞同：0
> 
> 时间：2012-10-31T03:27:49.620
> 
> 标签：php, wordpress

我找到了一个我非常喜欢的 wordpress 主题，但是，我已经为我的表单/数据库以及 PHP 中的其他东西编写了所有代码。

我以前从未使用过 wordpress，但我只是下载了几个免费主题来看看发生了什么。我是否遗漏了什么，或者我可以剪掉我不需要的代码，基本上使用框架作为布局，然后在我想要的地方插入我的代码？我不想花几天的时间来意识到我犯了一个大错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:30:59.930

WordPress 主题有自己的结构来为 WordPress 工作。如果您需要使用该设计，您可以取出 style.css 并修改 DOM 以供自己使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T08:53:59.113

我会首先将主题加载到 Wordpress 的副本中。然后像其他人建议的那样复制样式表、js 和图像文件。我将从查看源代码复制的 HTML。

Wordpress 具有内部功能，从 .php 文件中复制需要一些工作来试图找出正在发生的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T08:59:20.663

如果您打算使用 Wordpress 并想编辑主题，请查看以下链接。您需要使用子主题才能更新您的主题（否则您的更改将被覆盖）。

*   [http://codex.wordpress.org/Child_Themes](http://codex.wordpress.org/Child_Themes)

*   [http://wordpress.org/extend/plugins/one-click-child-theme/](http://wordpress.org/extend/plugins/one-click-child-theme/)

# c# - 在掩码文本框中设置人口字段验证

> ID：13150851
> 
> 赞同：0
> 
> 时间：2012-10-31T03:27:50.120
> 
> 标签：c#, winforms, validation, currency, maskedtextbox

嗨，我是 C# 新手，我有一个问题`masked text box`

人口范围是 1,000 到 12,00,00,00,000

我的问题是，当在蒙版文本框中输入 1000 时，它将被视为 1,000，就像我输入 12000 时一样，它将被视为 12,000，就像默认排列在`,`.

我该怎么做？请提供任何解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T04:17:07.727

`Mask`属性设置是什么？尝试制作它：`#,##0`。

# c++ - 这是 Visual C++ 2008 的编译器错误吗

> ID：13150854
> 
> 赞同：-6
> 
> 时间：2012-10-31T03:28:16.933
> 
> 标签：c++, visual-c++, boost-asio

我正在使用 boost asio 编写一个简单的 memcached 客户端，但是，当在 Windows 7（64 位）的 Visual c++ 2008 下以发布模式编译时，如果我添加一个无辜的“std::string s;”，程序将引发访问冲突异常。在函数处理程序中。欢迎任何建议。

```
#include <iostream>
#include <boost/asio.hpp>
#include <string>
#include <boost/algorithm/string.hpp>

typedef boost::asio::buffers_iterator<boost::asio::const_buffers_1> iterator_t;
typedef boost::iterator_range<iterator_t> range_t;
static const std::string LINE_END_MARK = "\r\n";

int main(int argc, char* argv[])
{
    boost::asio::streambuf _buf;
    std::ostream os(&_buf);
    os<<"END\r\n";

    iterator_t cursor = boost::asio::buffers_begin(_buf.data());
    iterator_t end = boost::asio::buffers_end(_buf.data());

    std::ostream_iterator<char> it(std::cout," ");
    std::copy(LINE_END_MARK.begin(), LINE_END_MARK.end(), it);

    range_t r(cursor, end);
    if(!boost::ends_with(r, LINE_END_MARK))
        return 0;
    return 1;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:37:41.723

当您添加该“无辜”自动变量时，您正在更改该函数的堆栈框架的布局。发生的情况是，您（总是）破坏的堆栈上的某些变量被移动了。因此，当您以前丢弃一些未被注意到的内存位置时，您现在正在丢弃一些更重要的东西（例如返回地址）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:35:29.527

正如 Matt Ball 在评论中提到的，您的代码中出现错误的可能性*远大于*编译器错误的可能性，尤其是对于最近的编译器。如果您仍然确信这是一个编译器错误，您可以通过使用另一个编译器（例如 gcc 或其 Windows 端口 MinGW）进行编译来确认您的怀疑。

# c# - skydrive System.Dynamic.DynamicObject

> ID：13150863
> 
> 赞同：3
> 
> 时间：2012-10-31T03:29:40.727
> 
> 标签：c#, windows-runtime, onedrive

我正在尝试获取 SkyDrive 上已登录用户的所有文件夹的列表。

```
LiveOperationResult operationResult = await client.GetAsync("me/skydrive/files");
dynamic result = operationResult.Result; 
```

我希望能够做这样的事情：

```
Dictionary<string, object> folderData = (Dictionary<string, object>)result;
List<object> folders = (List<object>)folderData["data"];

foreach (object item in folders)
{
    Dictionary<string, object> folder = (Dictionary<string, object>)item;
    if (folder["name"].ToString() == "Folder Name")
    {
        showToastMessage(folder["id"].ToString());
        return;
    }
} 
```

但是，在这一行：

```
Dictionary<string, object> folderData = (Dictionary<string, object>)result; 
```

我收到一个错误：

> 无法将类型“System.Dynamic.DynamicObject”转换为“System.Collections.Generic.Dictionary”

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-31T03:34:47.797

问题是[`LiveOperationResult.Result`](http://msdn.microsoft.com/en-us/library/live/microsoft.live.liveoperationresult.result)不一定保证是`Dictionary<string, object>`. 然而，它被定义为一个`IDictionary<string, object>`.

请注意，您似乎甚至不需要将该`Result`属性转换为任何类型的字典；您应该能够使用该`dynamic`变量直接访问要迭代的列表。

```
List<object> folders = (List<object>)result.data; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:36:46.047

我认为您收到此消息是因为您已`result`使用以下代码声明

```
dynamic result = operationResult.Result; 
```

这将声明`result`为新`System.Dynamic.DynamicObject`的，因此，当我们说

```
Dictionary<string, object> folderData = (Dictionary<string, object>)result; 
```

您正在尝试将类型转换为不可能`result`的类型`System.Dynamic.DynamicObject`，这就是您收到错误的原因。`System.Collections.Generic.Dictionary`

谢谢，
我希望你觉得这有帮助:)

# boost - 当我使用 boost::archive::binary_iarchive 时，会发生错误：invalid signature

> ID：13150864
> 
> 赞同：1
> 
> 时间：2012-10-31T03:29:41.203
> 
> 标签：boost, computer-vision

当我想编译程序时--cvpr_2012_ffd。你可以从[http://blog.gimiatlicho.webfactional.com/?page_id=38](http://blog.gimiatlicho.webfactional.com/?page_id=38.I)得到它。我根据它的README编译程序。当我运行这个程序时，我遇到了一些错误。错误是这个

图像 pathdata/index_random_subset.txt 到 treesdata/trees_ffd/ 的图像路径路径到 treesdata/trees_headpose/tree_10 要加载。反序列化期间的存档异常：无效签名是树：data/trees_headpose/tree_000.txt 段错误

我发现这个错误出现在文件中：tree.hpp 像这样的代码

```
224     //check if file exist
225     std::ifstream ifs(path.c_str());
226     if (!ifs) {
227       std::cout << "Tree not found " << path << std::endl;
228       return false;
229     }
230 
231     //load tree
232     try {
233 //      boost::archive::binary_iarchive ia(ifs);
234       boost::archive::binary_iarchive ia(ifs);
235       ia >> *t;
236     } catch (boost::archive::archive_exception& ex) {
237       std::cout << "Archive Exception during deserializing:" << std::endl;
238       std::cout << ex.what() << std::endl;
239       std::cout << "it was tree: " << path << std::endl;
240     } catch (int e) {
241       std::cout << path << "EXCEPTION " << e << std::endl;
242 
243     } 
```

错误发生在行：234

有人遇到这个错误吗？如何解决这个问题？谢谢

# r - ggplot2 stat_binhex()：在改变绘图大小的同时保持 bin 半径

> ID：13150868
> 
> 赞同：4
> 
> 时间：2012-10-31T03:30:18.247
> 
> 标签：r, plot, ggplot2, data-visualization, hexagonal-tiles

我想找到一种方法来在不手动调整 binwidth 参数的情况下在 ggplot2 中调整 hexbin 图的大小时保持正六边形（所有边的长度相等）。

为了显示：

```
d <- ggplot(diamonds, aes(carat, price))+ 
  stat_binhex(colour="white")
try(ggsave(plot=d,filename=<some file>,height=6,width=8)) 
```

产生至少看起来很规则的六边形：![ggplot2 stat_binhex plot1](../Images/3f58f16aab4307baf25c8b39018a6307.png)

和

```
try(ggsave(plot=d,filename=<some other file>,height=6,width=12)) 
```

产生不规则的六边形：![ggplot2 stat_binhex plot2](../Images/66c8e7cc4d1a85975270a1d789515705.png)

该[文档](http://docs.ggplot2.org/0.9.2.1/stat_binhex.html)`binwidth = c(1, 1000)`描述了指定 bin 宽度的 binwidth 参数（例如）。我想要一个函数，当给定任何绘图大小时，它会返回正确的 binwidth 设置以创建正六边形。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-31T03:53:45.820

您的选择是设置`coord_fixed`适当的比例，以便绘图不会超出图形设备的大小

在这种情况下`5/17000`会显得合理

```
d <- ggplot(diamonds, aes(carat, price))+ 
  stat_binhex(colour="white") + coord_fixed(ratio = 5/17000) 
```

另一种选择是在考虑设备尺寸比率的情况下创建坐标尺寸的 binwidth 和比率。

除非坐标比是固定的（根据我的第一个示例），否则您不能期望将相同的绘图拉伸到宽 1.5 倍的窗口中，而绘图看起来不会被拉伸。

`x`因此，如果您将宽度拉伸 1.5 倍，则将尺寸 中的 binwidth 减小1.5 倍

```
d <- ggplot(diamonds, aes(carat, price))+ 
   stat_binhex(colour="white",bin.widths = c((5/45),17000/30 )) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T15:02:20.933

这是动态调整 binwidth 的解决方案。我已经包括处理纵向纵横比和明确规定的轴限制。

```
bins <- function(xMin,xMax,yMin,yMax,height,width,minBins) {
  if(width > height) {
    hbins = ((width/height)*minBins)
    vbins = minBins
  } else if (width < height) { 
    vbins = ((height/width)*minBins)
    hbins = minBins
  } else { 
    vbins = hbins = minBins
    }
  binwidths <- c(((xMax-xMin)/hbins),((yMax-yMin)/vbins))
  return(binwidths)
} 
```

例如这段代码：

```
h = 5
w = 5
yMin = min(diamonds$price)
yMax = max(diamonds$price)
xMin = min(diamonds$carat)
xMax = max(diamonds$carat)
minBins = 30

d <- ggplot(diamonds, aes(x = carat, y = price))+ 
  stat_binhex(colour="white", binwidth = bins(xMin,xMax,yMin,yMax,h,w,minBins))+
  ylim(yMin,yMax)+
  xlim(xMin,xMax)
try(ggsave(plot=d,filename=<some file>,height=h,width=w)) 
```

产量： ![格雷厄姆·杰弗里斯 - hexbin 情节 1](../Images/bfaa17954dd41e5f7848ed7102e361ee.png) 当我们改变宽度时：

```
w = 8
d <- ggplot(diamonds, aes(x = carat, y = price))+ 
  stat_binhex(colour="white", binwidth = bins(xMin,xMax,yMin,yMax,h,w,minBins))+
  ylim(yMin,yMax)+
  xlim(xMin,xMax)
try(ggsave(plot=d,filename=<some file>,height=h,width=w)) 
```

![格雷厄姆·杰弗里斯 - hexbin 情节 2](../Images/931c326aeefa5c293441fb5119a6f411.png)

或者改变高度：

```
h = 8
w = 5
d <- ggplot(diamonds, aes(x = carat, y = price))+ 
  stat_binhex(colour="white", binwidth = bins(xMin,xMax,yMin,yMax,h,w,minBins))+
  ylim(yMin,yMax)+
  xlim(xMin,xMax)
try(ggsave(plot=d,filename=<some file>,height=h,width=w)) 
```

![格雷厄姆·杰弗里斯 - hexbin 情节 3](../Images/7c09b95aa3efea8fbe4382865ed5fd3d.png)

我们还可以更改 x 和 y 限制：

```
h = 5
w = 5
xMin = -2

d <- ggplot(diamonds, aes(x = carat, y = price))+ 
  stat_binhex(colour="white", binwidth = bins(xMin,xMax,yMin,yMax,h,w,minBins))+
  ylim(yMin,yMax)+
  xlim(xMin,xMax)
try(ggsave(plot=d,filename=<some file>,height=h,width=w)) 
```

![格雷厄姆·杰弗里斯 - hexbin 情节 4](../Images/ac2328d35edd08fc9472bf1681a16341.png)

# c++ - 尝试使用 pin 工具从堆栈中打印寄存器的值

> ID：13150869
> 
> 赞同：1
> 
> 时间：2012-10-31T03:30:41.383
> 
> 标签：c++, c, debugging, instrumentation

我正在尝试使用 pin 工具在不同的例程中打印出堆栈。我能够获得所有的例程，但我对如何获取存储在该例程堆栈中的寄存器中的地址有点困惑。

我所拥有的是：

```
VOID SETRTN_CONTEXT(CONTEXT * ctxt)
{
   ADDRINT reg_address;

   PIN_SaveContext(ctxt, &m_ctxt);
   reg_address = PIN_GetContextReg(&m_ctxt, REG_STACK_PTR);
} 
```

在另一个函数中，我有这段代码调用该函数：

```
for(rtn = SEC_RtnHead(sec); RTN_Valid(rtn); rtn = RTN_Next(rtn) )
{
   RTN_Open(rtn);
   RTN_InsertCall(rtn, IPOINT_BEFORE, (AFUNPTR)SETRTN_CONTEXT,
      IARG_CONST_CONTEXT, IARG_THREAD_ID, IARG_END);
   RTN_Close(rtn);
} 
```

当例程调用该函数时，我有点困惑，因为我只得到一个结果，并且在附加 Pin 并等待几秒钟后得到它。

有什么针头可以帮助我解决这个问题吗？我知道我需要例程中的上下文才能获取寄存器，但我找不到任何将上下文作为对象返回的函数......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-10T21:38:39.847

在您的 RTN_InsertCall 中，您添加了线程 id，而在您的 SETRTN_CONTEXT 函数声明中，您没有收到线程 id...可能想要解决这个问题。

此外，在您的分析例程 SETRTN_CONTEXT 中，您实际上并没有保存应用程序外部的任何内容。如果 m_ctxt 是您在其他地方操作的全局变量，我可能是错的，除非您每次运行分析例程并以线程安全的方式都这样做，否则这怎么可能是正确的？

显然，您希望将信息写入某个文件或输出。我建议使用某种 xml 工具；这使得解析变得容易，如果你巧妙地编写你的 pintools，你可以通过遵守一些接口契约来交换输出的格式。

另外为了澄清您的困惑，您尝试在特定图像中的每个函数之前插入分析例程以运行；每次在该图像中调用该函数时，您的 SETRTN_CONTEXT 都会运行。

# java - Oracle：如何在容器生成的 jpa 查询 WHERE 子句中使用基于函数的索引

> ID：13150871
> 
> 赞同：1
> 
> 时间：2012-10-31T03:30:48.370
> 
> 标签：java, oracle, jpa, ejb, jpql

我们有一个数据表，其中有一个基于函数的索引（数据库是 Oracle）。但是在我们的 Java EE ejb 应用程序中，系统使用 jpa 查询访问数据。

但是为了强制 oracle 使用基于函数的索引而不是进行全表扫描，我需要一种方法来告诉 jpa 容器生成带有在 sql 查询的 WHERE 子句中的索引中定义的函数的 sql。

据我所知，我们必须使用本机查询来在生成的查询中创建自定义项。但是为了使用本机查询，我们必须进行许多代码更改。任何人都可以建议解决此问题的任何其他解决方法吗？

**索引：（**我们需要对 Dev_Id + Dev_Type 强制执行唯一约束，但有时 Dev_Id 可以为空，而 Dev_Type 可以重复。）

```
 (NVL2(Dev_Id, Dev_Id, NULL), NVL2(Dev_Id, Dev_Type, NULL)) 
```

**我们需要的查询：（**为了使用索引）

```
Select * from some_table where NVL2(Dev_Id, Dev_Id, NULL) = 'some_val'; 
```

**容器生成的查询：**

```
Select * from some_table where Dev_Id = 'some_val'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:49:50.337

也许创建一个视图并让 JPA 通过这是一种选择？

```
 CREATE VIEW SOME_VIEW AS SELECT SOME_TABLE.*,  
    NVL2(Dev_Id, Dev_Id, NULL) AS NVL_DEV_ID FROM SOME_TABLE;

 SELECT * FROM SOME_VIEW WHERE NVL_DEV_ID = ? 
```

还是表上计算函数的虚拟列？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-22T13:02:55.213

JPA 2.1 包含一个`FUNCTION`允许调用特定于 DB 的函数的运算符：

```
from SomeEntity where function('NVL2', devId, devId, null) = 'some_val'; 
```

如果您没有可用的 JPA 2.1 但正在使用 Eclipselink >= 2.4，您也可以使用`FUNCTION`，因为它可以作为 Eclipselink 扩展使用。

如果您有 Eclipselink 2.3.x，则没有`FUNCTION`，但您可以使用`FUNC`可用作 Eclipselink 扩展的等效版本。

# javascript - Steam API 使用 Javascript 获取 SteamID

> ID：13150879
> 
> 赞同：4
> 
> 时间：2012-10-31T03:32:40.713
> 
> 标签：javascript, jquery, ajax, steam

遇到了似乎是同源策略的东西，这引起了相当的头痛！

切入正题，我实际上是在仅提供用户名时尝试获取用户的 steam64id。

例如，我的用户名：“Emperor_Jordan” 我会去：

[http://steamcommunity.com/id/emperor_jordan?xml=1](http://steamcommunity.com/id/emperor_jordan?xml=1)

我需要的蒸汽车就在顶部。所以我想我会使用 JQuery Ajax 来获取它并解析出我需要的 id 以供以后使用（steamapi 使用需要 steam64id），如下所示。这是有问题的代码片段：

```
$.ajax({
url: "http://steamcommunity.com/id/emperor_jordan/?xml=1",
datatype: "xml",
complete: function()
{
    alert(this.url)
},
success: parse
});

function parse(xml)
{
    alert("parsing");
    _steamID = $(xml).find("steamID64").text();
} 
```

这里的问题是，虽然我确实收到了完成警报，但我从来没有看到“解析”。曾经。它永远不会得到那个回调，这让我相信我遇到了 SOP（同源策略）。

我是否以错误的方式接近这个，有解决方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-31T03:39:34.360

正确的。[您*遇到*了同源策略：](http://jsfiddle.net/mattball/M84kc/)

```
XMLHttpRequest cannot load http://steamcommunity.com/id/emperor_jordan/?xml=1\. Origin http://fiddle.jshell.net is not allowed by Access-Control-Allow-Origin. 
```

而且[看起来 Steam 不提供像 JSONP 这样的跨域解决方案](https://developer.valvesoftware.com/wiki/Steam_Web_API)。这意味着您又回到了旧的但可靠的解决方案：在您的服务器上获取数据，而不是在浏览器中。

* * *

关于 Steam Web API 的一些相关反馈：[https ://developer.valvesoftware.com/wiki/Steam_Web_API/Feedback#API_Considerations_for_Web_Developers](https://developer.valvesoftware.com/wiki/Steam_Web_API/Feedback#API_Considerations_for_Web_Developers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-12-07T07:29:10.473

您需要在 Heroku 中创建代理服务器才能获取数据。Cors 限制我们将数据直接调用到我们的浏览器，而不是服务器到服务器的交互。所以我们需要一个代理服务器来代表我们发送请求和接收数据。它对我有用。

提前致谢。

# ruby - heroku 重新订购 ruby on rails loop output of partials

> ID：13150881
> 
> 赞同：0
> 
> 时间：2012-10-31T03:33:00.010
> 
> 标签：ruby, loops, heroku, naming-conventions

我有一个呈现几个部分的页面；在我本地的mac上一切都很好，但是在我推送到heroku并访问页面后，部分的顺序是不同的！

我使用下面的代码渲染部分，并认为我使用文件命名约定控制了顺序。

html.erb：

```
<% Dir["app/views/partials/ws/*.html.erb"].each do |ws| %>
<%= render 'partials/ws/' + File.basename(ws,'.html.erb').slice(1..-1) %>
<% end %> 
```

部分使用命名约定：

```
_ws_01-why.html.erb
_ws_02-what.html.erb
_ws_03-who.html.erb
_ws_04-where.html.erb
_ws_05-when1.html.erb
_ws_06-how.html.erb 
```

Heroku 按以下顺序呈现：

```
_ws_01-why.html.erb
_ws_02-what.html.erb
_ws_06-how.html.erb
_ws_04-where.html.erb
_ws_05-when1.html.erb
_ws_03-who.html.erb 
```

我不确定 heroku 是如何解释命名约定/ruby 循环顺序的……想知道是否有更好的命名对流或逻辑可以添加到我的循环中来控制顺序？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:45:37.927

改变这个：

```
<% Dir["app/views/partials/ws/*.html.erb"].each do |ws| %> 
```

对此：

```
<% Dir["app/views/partials/ws/*.html.erb"].sort.each do |ws| %> 
```

你不能确定一个枚举器在所有情况下都会选择相同的顺序，除非你以某种方式强制它。

# javascript - 用于删除元素周围的一些空格的原始 JavaScript

> ID：13150882
> 
> 赞同：0
> 
> 时间：2012-10-31T03:33:03.747
> 
> 标签：javascript, anchor, whitespace, space

任何人都可以帮助找到一个原始的 JavaScript 解决方案来删除锚元素周围的一些空格。

我目前有一个嵌套在表格单元格中`&nbsp;`的锚点，并且在锚点之前有一个导致锚点（我将其设置为块元素）出现在下一行。

我很确定我知道如何使用 jQuery，但我想要一个原始的 JavaScript 解决方案，有人可以帮忙吗？

[例子](http://jsfiddle.net/mhksG/)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T04:33:59.677

此代码删除锚点前：

```
var s = document.getElementById('ttt').innerHTML;
s = s.replace(/&nbsp;[\s\r\n\t]*(<a)/gm, "$1");
document.getElementById('ttt').innerHTML = s; 
```

“ttt” - 您的表 id 属性。

# c# - WinForms 事件父滚动

> ID：13150883
> 
> 赞同：0
> 
> 时间：2012-10-31T03:33:08.147
> 
> 标签：c#, .net, winforms

我`FlowLayoutPanels`在表格上有两个：`PanelA`和`PanelB`。每个都将在运行时填充多个控件，以便面板滚动（即为`AutoScroll`真）。

这是问题所在：面板填充的每个控件都包含一个`ComboBox`. 因此，`MouseWheel`事件由组合框而不是面板使用。我希望`MouseWheel`面板使用事件。

如果子控件上没有可滚动控件，则`MouseWheel`事件会跳过子控件（它不处理它）并点击处理它的面板。如何设置我的子控件的组合框以忽略该`MouseWheel`事件？我可以告诉它重新引发事件吗？

每当其中一个子控件勾选“MouseEnter”事件时，我都尝试将焦点应用于父级；这解决了滚动问题，但也使子控件完全不可编辑。

我从挖掘中发现的其他东西涉及直接摆弄 Windows API，但我发现很难相信这样的东西是必需的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T16:04:57.663

我测试了以下代码，它似乎可以解决您的问题。基本上，当您单击“FlowLayoutPanel”或鼠标进入它时，您需要将其聚焦：

```
private void newCheckListQuestionPanel_Click(object sender, EventArgs e)
{
   newCheckListQuestionPanel.Focus(); //allows the mouse wheel to work after the panel is clicked
}
private void newCheckListQuestionPanel_MouseEnter(object sender, EventArgs e)
{
   newCheckListQuestionPanel.Focus(); //allows the mouse wheel to work after the panel has had the mouse move over it
} 
```

*   [资源](http://thewayofcoding.com/2008/02/c-net-programming-tip-flowlayoutpanel-mouse-scroll-wheel-not-working/)

# c - 来自 Solaris 的 Linux 内核加密 API

> ID：13150885
> 
> 赞同：2
> 
> 时间：2012-10-31T03:33:09.510
> 
> 标签：c, linux, cryptography, kernel, solaris

我正在将一些内核源代码从 Solaris 移植到 Linux，并且我有 7 个函数需要进行等效实现。在 Solaris 中，它们是：

```
 int crypto_create_ctx_template(crypto_mechanism_t *mech,
           crypto_key_t *key, crypto_ctx_template_t *tmpl, int kmflag)
void crypto_destroy_ctx_template(crypto_ctx_template_t tmpl)
 int crypto_mac(crypto_mechanism_t *mech, crypto_data_t *data,
           crypto_key_t *key, crypto_ctx_template_t tmpl, crypto_data_t *mac,
           crypto_call_req_t *cr)
 int crypto_decrypt(crypto_mechanism_t *mech, crypto_data_t *ciphertext,
           crypto_key_t *key, crypto_ctx_template_t tmpl,
           crypto_data_t *plaintext, crypto_call_req_t *cr)
 int crypto_encrypt(crypto_mechanism_t *mech, crypto_data_t *plaintext,
           crypto_key_t *key, crypto_ctx_template_t tmpl, crypto_data_t *ciphertext,
           crypto_call_req_t *cr)
 crypto_mech_type_t crypto_mech2id(crypto_mech_name_t name) 
```

我最好的猜测是 Solaris 中的加密 API 让我可以对缓冲区进行排队处理，并在任务完成时提供回调函数。

在Linux下，我最初想，我最好的选择是让_ctx_template做“很少，什么都不做”，并直接实现加密和解密（阻塞）并调用CB本身。最终，使用一个同时完成工作的内核线程。

有没有人做过任何内核加密工作？cryptodev 似乎是用于用户态工作的？

# javascript - 如何从文本区域以外的表单中捕获输入

> ID：13150886
> 
> 赞同：0
> 
> 时间：2012-10-31T03:33:11.747
> 
> 标签：javascript, jquery

在动态表单中，我有以下代码来捕获“输入”键。

```
$(document).bind('keypress', function (e) {  
  if (e.keyCode == 13) { 
    e.preventDefault();
  }
}); 
```

有时，有一个像 HTMLTextAreaElement 这样的元素接受“输入”键。

如何仅为 HTMLTextAreaElement 取消绑定 preventDefault。

TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:35:07.953

试试这个：

```
if (e.which == 13 && e.target.localName !== 'textarea') { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:40:30.397

```
$("html *:not(textarea)").bind('keypress', function (e) {  
  if (e.keyCode == 13) { 
    e.preventDefault();
  }
}); 
```

演示：http: [//jsfiddle.net/DerekL/4JWLb/](http://jsfiddle.net/DerekL/4JWLb/)

# php - 保存 PHP 会话文件以用于跟踪/统计/分析目的是一个好主意吗？

> ID：13150890
> 
> 赞同：0
> 
> 时间：2012-10-31T03:33:38.530
> 
> 标签：php, session-variables, web-analytics

我的网站上确实有 Google Analytics（与 adwords 相关联），并且尝试了许多其他软件包来跟踪访问者，但没有一个能提供我需要的详细信息。我的目标是保持每个 IP 访问的确切路径。

所有这些工具都通过向页面添加一段代码来工作，该代码会发送到他们的服务器以保存页面访问。

我突然想到，我可以将 IP 和面包屑保存在 SESSION 数组中，并每隔几分钟抓取一次会话文件目录，以便在文件过期之前保存它们。

后来我可以解码这些并进行各种数据挖掘。

这样我就不必修改代码，不必让每次页面访问都转到外部站点，而且我相信这比比方说……在每次页面访问时写入一个 mysql 记录要少。

出于任何我无法想象的原因，这会是一个坏主意吗？

感谢您的任何意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:38:36.227

我建议使用 Apache 访问日志。添加除默认值外所需的任何其他信息，并确保将会话 ID Cookie 记录在访问日志中。这将允许您在数据挖掘时对数据进行分组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:40:46.103

可以用 做邪恶的事情，但是，它是非常*安全*[的](https://stackoverflow.com/a/1181149/1216976)。你的计划看起来不错。`$_SESSION`

另一方面，用户通常不喜欢你在未经他们同意的情况下跟踪他们。确保您披露您将跟踪他们的一举一动的事实。

# jquery - 通过jquery提交时Spring表单无法绑定值

> ID：13150893
> 
> 赞同：1
> 
> 时间：2012-10-31T03:34:37.200
> 
> 标签：jquery, spring-mvc

我有一个有两种形式的 JSP。form1 用于搜索结果。form1返回的结果显示在form2中。form2 用于编辑结果。- 用于搜索号码的 fomr1

```
 <form:form name="form1" modelAttribute="form1" method="POST" action="doNumEnquiry.do"  id="form1">
            <form:input path="transactionID" type="text" id="trnxRef"/>
            <input type="submit"name="operation" id="searchBtn" value="search"/>
            <form:form> 
```

用于编辑的 formr2 在此处输入代码`数字

```
 <form:form name="form2" modelAttribute="form2" method="POST" id="form2">
            <c:forEach items="${form2.numberList}" var="obj">
            <form:radiobutton path="indexRadio" value="${obj.index}" id="indxRadio"/>
            <c:out value="${obj.customerRef}" />
            <input type="button" id="${obj.index}" name="operation" value="Go"/></span>
            </c:forEach>
            </form:form>
            </body> 
```

单击 Go 对接 Jquery 函数将被调用以提交 form2。

```
 $("input[type=button][value=Go]").click(function() {
            var urlVal="doModifyNumEnq.do";
            $("#form2").attr("action",urlVal+"?operation=Go");
            $("#form2").submit();
            }); 
```

两种形式都在调用 NumberController。Form1 是控制器的 doNumberSearch() 方法的模型属性。以下是控制器方法。

```
 @RequestMapping(value="doNumEnquiry.do", method=RequestMethod.POST, params="operation=Search")
            public ModelAndView doNumEnquiryWithSearchCriteria(@ModelAttribute("form1") NumberForm form, BindingResult result, HttpServletRequest request) {
            numberForm = nhNumberService.getNumEnquiryList(nhForm);
            return new ModelAndView("numberSearch", "form2", numberForm);
            } 
```

Form2 是控制器的 doModifyNumberSearch() 方法的模型属性。当我试图从模型属性 form2 中获取 indexRadio 值时，它返回为 null。由于我的服务类正在引发空指针异常。

```
@RequestMapping(value="doModifyNumEnq.do",
method=RequestMethod.POST,params="operation=Go")
public ModelAndView doModifyNumberRequest(@ModelAttribute("form2") NumberForm form, 
    BindingResult result,HttpServletRequest request){
    if(form.getIndexRadio() !=null){
        indexRad=form.getIndexRadio();
    }
    numberForm = nhNumberService.getNumEnquiryList(indexRad);
    return new ModelAndView("exoectedresult", "form", numberForm);
} 
```

请帮我解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T12:31:32.653

我认为这是发布到服务器的表单元素数据（不是表单本身）。您可以使用@RequestParam 直接在控制器方法中检索无线电值，如下所示

```
@RequestMapping(value="doModifyNumEnq.do",method=RequestMethod.POST,params="operation=Go") 
public ModelAndView doModifyNumberRequest(
    @RequestParam("indexRadio") String indexRad, 
    BindingResult result,
    HttpServletRequest request){ 

    numberForm = nhNumberService.getNumEnquiryList(indexRad); 
    return new ModelAndView("exoectedresult", "form", numberForm); 
} 
```

# java - 声明子类的实例

> ID：13150897
> 
> 赞同：-4
> 
> 时间：2012-10-31T03:35:06.467
> 
> 标签：java, subclass, instances

我创建了一个名为 bank 的类及其名为 ATM 的子类，我希望声明子类 ATM 的一个实例。当我如下所示声明它时，它给了我一个错误。

```
package bank;
import java.util.Scanner;
public class Bank {// Bank class
    protected int PIN,chequing_balance,savings_balance;
    public void set_PIN(int PIN){
   this.PIN= PIN;
}
public int get_PIN(){
    return this.PIN;
}
public void set_chequing_balance(int chequing_balance){
   this.chequing_balance=chequing_balance; 
}    
public int get_chequing_balance(){
    return chequing_balance;
}
public void set_savings_balance(int savings_balance){
   this.savings_balance=savings_balance; 
}    
public int get_savings_balance(){
    return savings_balance;
}

public class ATM extends Bank{// ATM is a subclass of Bank
    private void ATM(){
    PIN=1207605;
    chequing_balance=0;
    savings_balance=0;
}
    public void deposit_savings(int amount){
    this.savings_balance+=amount;
}
    public void withdrawl_savings(int amount){
    this.savings_balance-=amount;
}
        public void transfer_savings_to_chequing(int amount){
   this.chequing_balance+=amount;
   this.savings_balance-=amount;
}
        public void deposit_chequing(int amount){
    this.chequing_balance+=amount;
}
    public void withdrawl_chequing(int amount){
    this.chequing_balance-=amount;
}
        public void transfer_chequing_to_savings(int amount){
   this.savings_balance+=amount;
   this.chequing_balance-=amount;
}

}
    public static void main(String[] args) {
        int key,amount;
        ATM x= new ATM(); // declaration of instance of ATM subclass
        Scanner input= new Scanner(System.in);
       do{
           System.out.println("Please enter transaction type  1.Deposit, 2\. Withdraw 3\. Transfer ");
           key=input.nextInt();

        }while(key<1||key>3);
   do{
       System.out.println("Please enter desired amount");
       amount=input.nextInt();
   }while(amount<0);
   if (key==1)
   {
       System.out.println("Please enter account desired 1\. Chequing 2\. Savings");
       key=input.nextInt();
       if (key==1)
       {
           x.deposit_chequing(amount);
       }
       else if(key==2)
       {
           x.deposit_savings(amount);
       }    
   }
   else if (key==2)
   {
       System.out.println("Please enter account desired 1\. Chequing 2\. Savings");
       key=input.nextInt();
       if(key==1)
       {
           x.deposit_chequing(amount);
       }
       else if(key==2)
       {
           x.deposit_savings(amount);
       }
   }
   else if(key==3)
   {
    System.out.println("Please enter type of transaction you want 1\. Chequing to Savings 2\. Savings to Chequing");  
    key=input.nextInt();
    if (key==1)
    {
        x.transfer_chequing_to_savings(amount);
    }
    else if (key==2)
    {
        x.transfer_savings_to_chequing(amount);
    }
   }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:37:37.517

```
private void ATM(){ 
```

那是私有的，甚至不是构造函数，而是一种方法。构造函数不应该有返回类型。

此外，ATM 不应扩展银行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:41:02.987

您的构造函数不应声明应为的返回类型：

```
public ATM() {
   ....
} 
```

此外，当您有一个子类时，您必须使其通过 IS-A 测试。所有子类都应该对此测试说“是”，以便成为适当的子类。ATM IS-A 银行？嗯，不完全是。你可以为 ATM 设计一个超类，但 Bank 可能不是。一家银行可能拥有许多 ATM。ATM IS-A AccountAccessPoint 或 IS-A CashDispenser。但这更像是一种建模练习。

# c++ - 当客户端仅关闭发送的一半连接时，为什么 HTTP 服务器会关闭连接？

> ID：13150910
> 
> 赞同：0
> 
> 时间：2012-10-31T03:37:09.877
> 
> 标签：c++, c, windows, http, network-programming

> **可能重复：**
> [Winsock recv 关机后不工作](https://stackoverflow.com/questions/9846165/winsock-recv-not-working-after-shutdown)

我正在尝试通过 WinSock2 发送 HTTP 请求。我终于做到了，但是，当我关闭连接的发送一半时，我无法弄清楚为什么连接会关闭。

根据[RFC2616 sec8.1.4](http://www.w3.org/Protocols/rfc2616/rfc2616-sec8.html#sec8.1.4)：

> 当客户端或服务器希望超时时，它应该在传输连接上发出正常关闭。客户端和服务器都应该不断地观察传输关闭的另一端，并在适当的时候做出响应。
> 
> 服务器不应该在传输响应的过程中关闭连接，除非怀疑网络或客户端故障。

我想套接字仍然会接收消息，直到服务器没有要发送的内容，但服务器只是**意外**关闭了连接。

![alt](../Images/0ca8543778a44a16a246bce5fa28bdb3.png)

```
C:\Users\970067a\Desktop>gcc test.c -lWs2_32 && a
Bytes Sent: 59
Bytes received: 787
Bytes received: 222
Connection closed

C:\Users\970067a\Desktop>gcc test.c -lWs2_32 -D SHUTDOWN_SD_SEND && a
Bytes Sent: 59
Connection closed 
```

以下是我的部分源代码：

```
...

iResult = getaddrinfo("www.google.com", "http", &hints, &result);
if (iResult != 0) {
    printf("getaddrinfo failed: %d\n", iResult);
    WSACleanup();
    return 1;
}

...

int recvbuflen = DEFAULT_BUFLEN;

char *sendbuf = "GET / HTTP/1.1\r\nhost: www.google.com\r\nConnection: close\r\n\r\n";
char recvbuf[DEFAULT_BUFLEN];

// Send an initial buffer
iResult = send(ConnectSocket, sendbuf, (int)strlen(sendbuf), 0);
if (iResult == SOCKET_ERROR) {
    printf("send failed: %d\n", WSAGetLastError());
    closesocket(ConnectSocket);
    WSACleanup();
    return 1;
}

printf("Bytes Sent: %ld\n", iResult);

// shutdown the connection for sending since no more data will be sent
// the client can still use the ConnectSocket for receiving data
#ifdef SHUTDOWN_SD_SEND
iResult = shutdown(ConnectSocket, SD_SEND);
if (iResult == SOCKET_ERROR) {
  printf("shutdown failed: %d\n", WSAGetLastError());
  closesocket(ConnectSocket);
  WSACleanup();
  return 1;
}
#endif

// Receive data until the server closes the connection
do {
    iResult = recv(ConnectSocket, recvbuf, recvbuflen, 0);
    if (iResult > 0)
        printf("Bytes received: %d\n", iResult);
    else if (iResult == 0)
        printf("Connection closed\n");
    else
        printf("recv failed: %d\n", WSAGetLastError());
} while (iResult > 0);

// cleanup
closesocket(ConnectSocket);
WSACleanup();

... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T09:44:06.287

RFC 2616 中没有关于半关闭或关闭的内容。你不应该用 HTTP 来做这些事情。

# c++ - asio的源代码中关于iocp的代码在哪里可以得到？

> ID：13150914
> 
> 赞同：0
> 
> 时间：2012-10-31T03:37:42.813
> 
> 标签：c++, boost-asio, iocp

我想学习如何完美地使用iocp，但我找不到函数`CreateIoCompletionPort`。
翻遍了asio的所有文件，只找到了几个`.cpp`文件！
我如何/应该如何探索源代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:53:53.883

Asio 是高度模板化的库，所有代码都位于头文件中。你可以在[这里](http://svn.boost.org/svn/boost/trunk/boost/asio)找到它们。与下划线操作系统对话的 iocp 相关内容可以在[detail](http://svn.boost.org/svn/boost/trunk/boost/asio/detail)文件夹中找到。

首先，您可以查看截止日期计时器的实现。

1.  最后期限_timer.hpp，类型定义：
    1.  basic_deadline_timer.hpp，使用服务：
        1.  deadtime_timer_service.hpp，在以下位置实现：
            1.  detail/deadline_timer_service.hpp，使用：
                1.  详细信息/timer_scheduler.hpp，类型定义：
                    1.  detail/timer_scheduler_fwd.hpp，使用：
                        1.  详细信息/win_iocp_io_service.hpp，包括，
                            1.  detail/impl/win_iocp_io_service.ipp，实际实现在哪里。

:-)

# sql - SQL - 一段时间内的平均记录数

> ID：13150915
> 
> 赞同：2
> 
> 时间：2012-10-31T03:37:46.983
> 
> 标签：sql, sql-server-2008

我正在尝试在我们的一个数据库中为客户编制一些终身价值信息。

我们有一个 MS SQL Server 数据库，用于存储我们所有的客户/交易信息。

我的问题是我在 MS SQL Server（或一般的 SQL）方面没有太多经验 - 我希望能够对提取 AVG 贷款数量和基于 AVG 收入的数据库运行查询根据三个标准：

1.) 如果贷款被“批准”，则计入贷款 2.) 来自 customer_id 的贷款仅在第一笔贷款（首先由 date_created 字段标识）在某个 'mm/yyyy' 或之后才计算在内 3.) 我是能够指定在第一个“mm/yyyy”之后多少个月来统计要包含在 AVG 中的贷款/收入数量

这是数据库的样子：

```
customer_id   | loan_status | date_created      | revenue
111       | 'approved'  | 2010-06-20 17:17:09   | 100.00
222       | 'approved'  | 2010-06-21 09:54:43   | 255.12
333       | 'denied'    | 2011-06-21 12:47:30   | NULL
333       | 'approved'  | 2011-06-21 12:47:20   | 56.87
222       | 'denied'    | 2011-06-21 09:54:48   | NULL
222       | 'approved'  | 2011-06-21 09:54:18   | 50.00
111       | 'approved'  | 2011-06-20 17:17:23   | 100.00
... loads' of records ...
555       | 'approved'  | 2012-01-02 09:08:42   | 24.70
111       | 'denied'    | 2012-01-05 02:10:36   | NULL
666       | 'denied'    | 2012-02-05 03:31:16   | NULL
555       | 'approved'  | 2012-02-17 09:32:26   | 197.10
777       | 'approved'  | 2012-04-03 18:28:45   | 300.50
777       | 'approved'  | 2012-06-28 02:42:01   | 201.80
555       | 'approved'  | 2012-06-21 22:16:59   | 10.00
666       | 'approved'  | 2012-09-30 01:17:20   | 50.00 
```

如果我想查找 2012-01 年/之后的所有客户的平均交易数（已批准的交易）和每笔已批准交易的平均收入**，**以及在那之后的 4 个月内，我将如何查询数据库？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:54:02.840

像这样的东西（这里和那里可能有一些错别字）......

您可以先计算最低贷款日期：

select customer_id, min(date_created) from table t where loan_status = 'approved' group by customer_id

然后你可以加入它：

```
select customer_id,  count(date_created), avg(revenue) from table t 
join (
select customer_id,  min(date_created) as min_date from table t where loan_status = 'approved' group by customer_id ) s 
on t.customer_id = s.customer_id 
where t.date_created between s.min_date and DATEADD(month, 4, s.min_date) and t.loan_status = 'approved' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:55:07.537

重命名`tbl`为您的表名。
以格式指定日期**`YYYYMMDD`**。

```
select customer_id, AVG(revenue) average_revenue
from
(
    select customer_id
    from tbl
    group by customer_id
    having min(date_created) >= '20120101'
) fl
join tbl t on t.customer_id = fl.customer_id
where t.loan_status = 'approved'
  and date_created < '20120501' -- NOT including May the first, so Jan through Apr (4 months) 
```

如果您的意思是每个客户第一次贷款后的 4 个月，请给我留言，说明是 4 个日历月（例如 1 月 15 日至 5 月 15 日）还是第 4 个月的最后一天（1 月 15 日至 4 月 30 日） )，我会更新答案。

# prolog - 如何在序言中添加到列表末尾

> ID：13150916
> 
> 赞同：7
> 
> 时间：2012-10-31T03:37:56.560
> 
> 标签：prolog

我正在尝试将一项添加到序言中列表的末尾，但它一直失败。

```
insertAtEnd(X,[ ],[X]).
insertAtEnd(X,[H|T],[H|Z]) :- insertAtEnd(X,T,Z).    

letters([a,b,c]). 
```

我不明白为什么下面的这个不起作用。

```
insertAtEnd(d,letters(Stored),letters(Stored)). 
```

我也试图将此列表存储在变量 Stored through 中，但我不确定上述是否是正确的继续方式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-06-27T09:23:09.340

您可以使用[附加](http://www.swi-prolog.org/pldoc/man?predicate=append/3) 并将您的项目作为第二个列表

像这样：

insertAtEnd(X,Y,Z) :- 附加(Y,[X],Z)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-31T07:23:35.183

Prolog实现了*关系*计算模型，变量只能实例化，不能赋值。尝试

```
?- letters(Stored),
   insertAtEnd(d, Stored, Updated),
   write(Updated). 
```

# sql - SQL-如果其中一行具有列值，则使所有行都显示列值

> ID：13150923
> 
> 赞同：1
> 
> 时间：2012-10-31T03:38:44.310
> 
> 标签：sql, foxpro

我有一个 PICK 表的 SQL 语句，它返回订单的标题/详细信息记录。SQL中的一个字段基本上就是一个字段，说是否有危险品。如果订单上的单个产品有代码，则报告应显示其危险。

我遇到的问题是在 SQL 结果中，因为我将代码放在标题部分（而不是详细信息部分）的报告中，所以它只在第一行查找代码。

有没有办法通过 SQL 基本上说“如果其中一行有这个代码，让所有这些行都有这个代码”？我猜一个子选择会在这里工作......问题是，我使用的是基于 FoxPro 的遗留系统，而 FoxPro SQL 太糟糕了！

编辑：刚刚检查并且我正在运行 VFP8，SELECT 语句中的子查询已添加到 FVP9 中:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T20:43:33.050

在 VFP 8 和更早版本中，最好的办法是连续使用三个查询：

SELECT Header.HeaderId, Header.HeaderDescription, Detail.DetailId, Detail.DetailDescription, Detail.Dangerous, Danger.DangerousItems FROM Header INNER JOIN Detail ON Header.HeaderId = Detail.HeaderId INTO CURSOR csrDetail

SELECT HeaderId, COUNT(*) AS DangerousItems FROM Detail WHERE Dangerous GROUP BY HeaderId INTO CURSOR csrDanger

选择 csrDetail.*, csrDanger.DangerousItems 从 csrDetail.HeaderID = csrDanger.HeaderID 到 CURSOR csrResult

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T05:21:40.397

```
SELECT Header.HeaderId, Header.HeaderDescription, 
    Detail.DetailId, Detail.DetailDescription, Detail.Dangerous, 
    Danger.DangerousItems
FROM Header
INNER JOIN Detail ON Header.HeaderId = Detail.HeaderId
LEFT OUTER JOIN 
    (SELECT HeaderId, COUNT(*) AS DangerousItems FROM Detail WHERE Dangerous = 1 GROUP BY HeaderId) Danger ON Header.HeaderId = Danger.HeaderId 
```

如果`Danger.DangerousItems`> 0 则有危险​​。如果它是 Null，那么没有什么是危险的。

如果您不能进行嵌套查询，那么您应该能够为嵌套选择创建一个类似视图的对象（在 VFP8 中称为[查询）：](http://msdn.microsoft.com/en-us/library/aa979396%28v=vs.71%29.aspx)

```
SELECT HeaderId, COUNT(*) AS DangerousItems FROM Detail WHERE Dangerous = 1 GROUP BY HeaderId 
```

然后你可以离开加入吗？

# objective-c - 遍历字典数组以查找值

> ID：13150924
> 
> 赞同：4
> 
> 时间：2012-10-31T03:38:47.193
> 
> 标签：objective-c, ios, nsstring, nsarray, nsdictionary

我有一个字典数组，我想通过它找到一个匹配的值，然后我可以 Count == 数组的第 N 个项目

数组的每个项目看起来像这样

```
HMOD = 0;
MID = 39;
MOD = SOMETHING; // looking for this value
ID = 50; 
```

所以我想创建一个循环遍历数组，直到找到匹配的值，然后我使用计数中的数字作为对下一个视图中索引路径的引用。

我已经编写了这段代码，它无法正常工作......但希望它能让您了解我正在尝试创建的循环。

```
int count = 0;
while (singleName != [[ModArray valueForKey:@"MOD"] objectAtIndex:count]) {
                    count ++;
                    NSLog(@"%i", count);
                } 
```

SingleName 是一个 NSString，我用来匹配 ModArray 中的 MOD 值...任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-31T05:07:44.050

这是通过`valueForKey`在字典数组上使用的更简单的解决方案，

假设你`modArray`是这样的，

```
NSArray *modArray = [NSArray arrayWithObjects:[NSDictionary dictionaryWithObject:@"0" forKey:@"HMOD"],
                       [NSDictionary dictionaryWithObject:@"39" forKey:@"MID"],
                       [NSDictionary dictionaryWithObject:@"something" forKey:@"MOD"],
                       [NSDictionary dictionaryWithObject:@"50" forKey:@"ID"], nil]; 
```

并且`singleName`有一个值`"something"`

```
 NSString *singleName = @"something"; 
```

`array`从其中获取`modArray`具有键为的对象`"MOD"`，

```
 NSArray *array = [modArray valueForKey:@"MOD"]; 
```

检查是否`singleName`存在于 this 中`array`。如果是，则获取该对象的第一个索引，该索引与键为 " `MOD`" in的字典的索引相同`modArray`。

```
 if ([array containsObject:singleName]) {
        NSLog(@"%d", [array indexOfObject:singleName]);
    } else {
        NSLog(@"%@ is not present in the array", singleName);
    } 
```

**更新：** 如果您想以自己的方式进行操作，那么您使用的唯一错误是`!=`您应该使用`isEqualToString`. 你应该这样做，

```
int count = 0;
while (![singleName isEqualToString:[[modArray valueForKey:@"MOD"] objectAtIndex:count]]) {
                    count ++;
                    NSLog(@"%i", count);
                } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T03:56:15.907

您的代码从里到外看起来。你说你有一系列字典。假设`ModArray`是数组（基于名称），您可能会这样做：

```
NSUInteger count = 0;
for (NSDictionary *dict in ModArray) { // iterate through the array
    NSString *mod = dict[@"MOD"];      // get the value for MOD
    if ([mod isEqualToString:singleName]) {  // compare the two strings
        break;                         // they match so exit the loop
    }
    count++
}

// count has the index of the dictionary with the matching MOD value 
```

编辑：基于 ACB 纠正我对 的误解`NSArray valueForKey:`，唯一真正的问题是您使用 != 比较两个字符串。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-12-17T11:55:20.930

```
- This is Helpful when you search from Dictionary.

NSMutableArray *contentList;
NSMutableArray *filteredContentList;
BOOL isSearching;

// firstSection is array which already filled.
// contentList array for value of particular key
// filteredContentList is search array from actual array.

  - (void)searchTableList {
        NSString *searchString = searchBar.text;

        NSPredicate *filterPredicate = [NSPredicate predicateWithFormat:@"frame_code beginswith[c] %@", searchString];
        NSArray *filteredArr = [firstSection filteredArrayUsingPredicate:filterPredicate];
        if(contentList.count > 0)
            [contentList removeAllObjects];
        [filteredContentList addObjectsFromArray:filteredArr];
    }

    - (void)searchBarTextDidBeginEditing:(UISearchBar *)searchBar1 {

        if ([searchBar1.text length] != 0)
            isSearching = YES;
        else
            isSearching = NO;
    }

    - (void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText {
        NSLog(@"Text change - %d",isSearching);

        //Remove all objects first.
        [filteredContentList removeAllObjects];

        if([searchText length] != 0) {
            isSearching = YES;
            [self searchTableList];
        }
        else {
            isSearching = NO;
        }
        [tblFrameList_SComplete reloadData];
    }

    - (void)searchBarCancelButtonClicked:(UISearchBar *)searchBar {
        NSLog(@"Cancel clicked");
    }

    - (void)searchBarSearchButtonClicked:(UISearchBar *)searchBar {
        NSLog(@"Search Clicked");
        [self searchTableList];
    } 
```

# jquery-mobile - 更改 jQuery Mobile 水平分组单选按钮设置宽度：图例与输入拆分

> ID：13150927
> 
> 赞同：1
> 
> 时间：2012-10-31T03:39:16.740
> 
> 标签：jquery-mobile

我正在尝试自定义 jQuery Mobile 的水平分组单选按钮集的相对宽度。

默认情况下，这些的相对尺寸大致（仅通过眼睛）

*   .ui-controlgroup-label 25%
*   .ui-controlgroup-controls 75%

我试图在以下 html 上将此拆分更改为 50:50 ...

```
<div data-role="content">            

  <div data-role="fieldcontain">

    <fieldset data-role="controlgroup" data-type="horizontal" id="ps_test">

      <legend>
        Quite a bit of of text to put here from time to time ...
      </legend>

      <input type="radio" name="radio-choice-2" id="radio-choice-21" value="choice-1" checked="checked" />
      <label for="radio-choice-21">0</label>

      <input type="radio" name="radio-choice-2" id="radio-choice-22" value="choice-2"  />
      <label for="radio-choice-22">1</label>

      <input type="radio" name="radio-choice-2" id="radio-choice-23" value="choice-3"  />
      <label for="radio-choice-23">2</label>

      <input type="radio" name="radio-choice-2" id="radio-choice-24" value="choice-4"  />
      <label for="radio-choice-24">3</label>

      <input type="radio" name="radio-choice-2" id="radio-choice-25" value="choice-4"  />
      <label for="radio-choice-25">4</label>

      <input type="radio" name="radio-choice-2" id="radio-choice-26" value="choice-4"  />
      <label for="radio-choice-26">5</label>

      <input type="radio" name="radio-choice-2" id="radio-choice-27" value="choice-4"  />
      <label for="radio-choice-27">6</label>

    </fieldset>
  </div>

</div><!-- /content --> 
```

... 使用以下 css ...

```
.ui-controlgroup-label {
    width: 50%;
}

.ui-controlgroup-controls {
    width: 50%;
} 
```

……但这没有影响。我保存了一个代码示例以在[此处查看](http://jsfiddle.net/EC2Eh/)

你如何改变标签和按钮集的宽度？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T08:17:00.513

您的 CSS 不如 jQuery Mobile 中的 CSS 优先级高。如果你把它改成这样应该没问题：

```
.ui-field-contain .ui-controlgroup-label {
    width: 50%;
}

.ui-field-contain .ui-controlgroup-controls {
    width: 50%;
} 
```

下次只需使用 FireBug、Chrome 开发者工具、蜻蜓或 IE 开发者工具。

# ios - 如何在 uiimageview 的区域中添加 alpha

> ID：13150931
> 
> 赞同：0
> 
> 时间：2012-10-31T03:39:40.813
> 
> 标签：ios, xcode, uiimageview, uiimage, ios6

是否可以在同一图像的区域上添加 alpha 属性？例如

![没有阿尔法的正方形](../Images/08e966b38993c1bd0529deb4773816b7.png)

![带 alpha 的正方形](../Images/3f576cb455f065d91d94b804dbb4d3d7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T05:15:54.803

最简单的解决方案是将图像分开并将 alpha 保存为 png 的一部分，然后将图像视图组织为彼此齐平。

否则，我在常规视图中编写此快速代码，对图像执行相同操作（我对 Core Graphics 比较陌生，所以我确信有更好的方法来做到这一点 - 另外，我的示例图像是并排的):

```
-(void) drawRect {

    // GET THE CONTEXT, THEN FLIP THE COORDS (my view is 189 ponts tall)

    CGContextRef context = UIGraphicsGetCurrentContext();
    CGAffineTransform flip = CGAffineTransformMake(1, 0, 0, -1, 0, 189);
    CGContextConcatCTM(context, flip);

    // GET THE IMAGE REF

    UIImage *targetImage = [UIImage imageNamed:@"test.jpg"];
    CGImageRef imageRef = targetImage.CGImage;

    // SET THE COORDS

    CGRect imageCoords = CGRectMake(0, 0, 116, 189);
    CGRect imageCoordsTwo = CGRectMake(116, 0, 117, 189);

    // CUT UP THE IMAGE INTO TWO IMAGES

    CGImageRef firstImage = CGImageCreateWithImageInRect(imageRef, imageCoords);
    CGImageRef secondImage = CGImageCreateWithImageInRect(imageRef, imageCoordsTwo);

    // DRAW FIRST IMAGE, SAVE THE STATE, THEN SET THE TRANSPARENCY AMOUNT

    CGContextDrawImage(context, imageCoords, firstImage);
    CGContextSaveGState(context);
    CGContextSetAlpha(context, .4f);

    // DRAW SECOND IMAGE, RESTORE THE STATE

    CGContextDrawImage(context, imageCoordsTwo, secondImage);
    CGContextRestoreGState(context);

    // TIDY UP

    CGImageRelease(firstImage);
    CGImageRelease(secondImage);

} 
```

# scala - maven中scaladoc的多模块聚合

> ID：13150933
> 
> 赞同：5
> 
> 时间：2012-10-31T03:39:54.867
> 
> 标签：scala, maven-3, scaladoc, scala-maven-plugin

我有一个包含 5 个模块的父项目。我试图弄清楚如何将模块级 scaladoc 聚合到一个有凝聚力的站点中。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T21:27:23.957

如果可以选择将 Scala 文档汇总到整个 Java 项目文档中，请在此处查看我的答案：[https](https://stackoverflow.com/a/16288487/430128) ://stackoverflow.com/a/16288487/430128 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-23T16:20:26.530

通过将“Unidoc”集成到您的构建中，您可以使用 SBT 轻松完成此操作：

*   [https://github.com/akka/akka/blob/master/project/Unidoc.scala](https://github.com/akka/akka/blob/master/project/Unidoc.scala)

scala 的 maven 插件也支持聚合，但默认情况下只有直接模块，您可以更改默认行为（aggregateDirectOnly、forceAggregate）：

*   [http://davidb.github.com/scala-maven-plugin/doc-mojo.html](http://davidb.github.com/scala-maven-plugin/doc-mojo.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-23T15:45:36.470

Scaladoc2 不支持来自多源/多类路径的聚合（scaladoc 在 scalac 上运行，因此聚合意味着像有一个大项目一样的完整编译）。而 scala-maven-plugin 主要是 scala 命令的包装器。

聚合仅适用于现在已被放弃的 vscaladoc。

对不起

# python - 如何使用 ctypes 和 tesseract 3.0.2 识别数据而不是文件名？

> ID：13150937
> 
> 赞同：2
> 
> 时间：2012-10-31T03:40:48.767
> 
> 标签：python, ctypes, tesseract

`ctypes`我使用并`tesseract 3.0.2`参考[示例](http://code.google.com/p/tesseract-ocr/source/browse/trunk/contrib/tesseract-c_api-demo.py?spec=svn798&r=759)编写了一个片段：

```
import ctypes
from PIL import Image

libname = '/opt/tesseract/lib/libtesseract.so.3.0.2'
tesseract = ctypes.cdll.LoadLibrary(libname)
api = tesseract.TessBaseAPICreate()

rc = tesseract.TessBaseAPIInit3(api, "", 'eng')
filename = '/opt/ddl.ddl.exp654.png'

text_out = tesseract.TessBaseAPIProcessPages(api, filename, None, 0)
result_text = ctypes.string_at(text_out)
print result_text 
```

它将文件名作为参数传递，我不知道调用[API](http://code.google.com/p/tesseract-ocr/source/browse/trunk/api/capi.h)中的哪个方法来传递原始数据，例如：

```
tesseract.TessBaseAPIWhichMethod(api, open(filename).read()) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T04:31:46.080

我不能肯定地说，但我认为你不能将复杂的 python 对象传递给那个特定的 API，它不知道如何处理它们。您最好的选择是查看像[http://code.google.com/p/python-tesseract/](http://code.google.com/p/python-tesseract/)这样的包装器，它允许您使用文件缓冲区

```
import tesseract
api = tesseract.TessBaseAPI()
api.Init(".","eng",tesseract.OEM_DEFAULT)
api.SetVariable("tessedit_char_whitelist", "0123456789abcdefghijklmnopqrstuvwxyz")
api.SetPageSegMode(tesseract.PSM_AUTO)

mImgFile = "eurotext.jpg"
mBuffer=open(mImgFile,"rb").read()
result = tesseract.ProcessPagesBuffer(mBuffer,len(mBuffer),api) #YAY for buffers.
print "result(ProcessPagesBuffer)=",result 
```

**编辑**

[http://code.google.com/p/python-tesseract/source/browse/python-tesseract-0.7.4/debian/python-tesseract/usr/share/pyshared/tesseract.py](http://code.google.com/p/python-tesseract/source/browse/python-tesseract-0.7.4/debian/python-tesseract/usr/share/pyshared/tesseract.py)可能会为您提供以下见解你需要。

...

如果您不介意更换时会发生什么

```
text_out = tesseract.TessBaseAPIProcessPages(api, filename, None, 0) 
```

和

```
text_out = tesseract.ProcessPagesBuffer(mBuffer,len(mBuffer),api) 
```

# objective-c - @"" 和 @"123" 有什么不同吗？

> ID：13150939
> 
> 赞同：0
> 
> 时间：2012-10-31T03:40:52.403
> 
> 标签：objective-c, ios

当我测试方法“retainCount”时，我遇到了一个问题，如下所示：

```
NSString *s_afmt0 = [[NSString alloc] initWithFormat:@""]; //-1
NSString *s_afmt1 = [[NSString alloc] initWithFormat:@"123"]; //1
NSLog(@"s_afmt0:%d", [s_afmt0 retainCount]);
NSLog(@"s_afmt1:%d", [s_afmt1 retainCount]); 
```

结果：s_autf0:-1 s_autf1:1 我不知道为什么？为什么s_afmt0的retainCount是-1，s_autf1的retainCount是1。@""和@"123"有什么区别？谁能解释一下？谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-31T03:44:40.680

您将 retainCount 作为有符号整数打印，而实际上它是无符号整数（`NSUInteger`格式说明符为`%u`, not的类型`%d`）。-1 等价于`UINT_MAX`，表示对象没有retainCount。很可能 NSString 已经认识到给定的字符串是不可变的，并将指针分配给静态的 @"" 空 NSString，而不是在堆上放置一个。

实际上，您可以使用以下代码来确认这一点：

```
NSString* str1 = [[NSString alloc] initWithFormat:@""];
NSString* str2 = [[NSString alloc] initWithFormat:@""];

NSLog(@"string1: %p, string2: %p", str1, str2); 
```

上面的代码应该为 str1 和 str2 打印相同的指针地址，证实了我的理论，即 NSString 优化了这个特殊情况，确实如此：

```
06:46:30.142 StringTest[45214:303] string1: 0x7fff7d8acf90, string2: 0x7fff7d8acf90 
```

所以让我们看看这是否特定于 NSString。应该是这样，否则所有初始化为空字符串的 NSMutableString 对象都将指向同一个内存！

```
NSMutableString* str1 = [[NSMutableString alloc] initWithFormat:@""];
NSMutableString* str2 = [[NSMutableString alloc] initWithFormat:@""];

NSLog(@"string1: %p, string2: %p", str1, str2); 
```

输出：

```
06:53:36.688 StringTest[45278:303] string1: 0x10010a850, string2: 0x10010a890 
```

两个不同的内存位置。这样就完成了，Foundation 框架中的一个巧妙的小优化。TIL

编辑：

正如 bbum[指出的那样](http://www.friday.com/bbum/2011/12/18/retaincount-is-useless/)，你永远不应该依赖 retainCount，这是一个例子，如果你这样做，事情可能会出错

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:46:56.197

虽然您永远不应该使用`retainCount`，但您看到的最可能的原因是空字符串 @"" 被编译器视为特殊，因为它是如此常见的文字。

另外，为什么要使用带有字符串文字的字符串格式？我想这只是为了测试目的，但你应该有：

```
NSString *s_afmt0 = @""; // no need to use stringWithFormat here 
```

# c# - 为什么在 SSIS 包中连接到 DB2 时出现错误 58031？

> ID：13150941
> 
> 赞同：0
> 
> 时间：2012-10-31T03:41:17.250
> 
> 标签：c#, ssis

嗨，我正在尝试连接到 DB2，但它给出了一个错误

> ```
> [UDB Source [1]] Error: IBM.Data.DB2.DB2Exception: ERROR [58031] [IBM]
> SQL1031N  The database directory cannot be found on the indicated file
> system.  SQLSTATE=58031 
> ```

这是一个 SSIS 包，我在其中使用脚本组件连接到 DB2。但它没有打开连接。

我的一段代码是

```
string dbName = "GRTST";
string uid = "c001";
string pwd = "winter1";

DB2Connection conn = new DB2Connection();
conn.ConnectionString = "DataBase=" + dbName + ";" + "Uid=" + uid + ";" +"Pwd="+ pwd + ";";

conn.Open(); 
```

错误描述是

> [UDB 源 [1]] 错误：IBM.Data.DB2.DB2Exception：错误 [58031] [IBM] SQL1031N 在指示的文件系统上找不到数据库目录。SQLSTATE=58031
> 
> 在 Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.PrimeOutput(Int32 outputs, Int32[] outputIDs, PipelineBuffer[] buffers) 在 Microsoft.SqlServer.Dts.Pipeline 的 Microsoft.SqlServer.Dts.Pipeline.ScriptComponentHost.HandleUserException(Exception e) .ManagedComponentHost.HostPrimeOutput（IDTSManagedComponentWrapper100 包装器，Int32 输出，Int32[] outputIDs，IDTSBuffer100[] 缓冲区，IntPtr ppBufferWirePacket）

请提供您宝贵的建议，以便我继续前进。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T07:48:38.547

### 有问题的问题：

问题中的问题是您没有在连接字符串中指定要连接的服务器。以下链接显示了如何制定 DB2 连接字符串：

[IBM DB2 的连接字符串](http://www.connectionstrings.com/ibm-db2)

### 在 SSIS 中连接到数据库的适当方法：

话虽如此，您在问题中尝试做的**并不是**连接数据库的合适方式。您应该在 SSIS 项目级别创建一个数据源或在 SSIS 包中创建一个连接管理器以连接到您的 DB2 数据源。以下链接描述了如何使用 连接到 DB2 数据源`Microsoft OLE DB Provider for DB2`。

[使用 SSIS 连接到 DB2](http://www.bidn.com/blogs/PatrickLeBlanc/ssis/700/connecting-to-db2-using-ssis)

[从 SSIS 连接到 DB2 - 另一个链接](http://thirteendaysaweek.com/2010/05/16/connecting-to-db2-from-ssis/)

此外，这里是关于如何添加连接管理器的 MSDN 文档

[如何：在包中添加或删除连接管理器](http://msdn.microsoft.com/en-us/library/ms140237%28v=sql.105%29.aspx)

# command-line - 查找注册表项值的问题

> ID：13150942
> 
> 赞同：3
> 
> 时间：2012-10-31T03:41:22.480
> 
> 标签：command-line, batch-file, registry

我正在尝试制作一个批处理脚本来卸载用户很少参与的各种程序（只说我想卸载 A 组（例如，Google Chrome 和 Microsoft Office）），部分是为了工作，部分是为了娱乐和练习。这本身并不是不可能的，我已经可以通过调用 msiexec 并将其指向注册表中的卸载位置 (msiexec /x {xxxxx-xxxxx-xxxxxx-xxxx}) 来做到这一点。

唯一的问题是，这意味着每当程序更改注册表项时，就像更新经常发生的那样，我必须再次找到路径。因此，我正在尝试运行一段代码，该代码将搜索 HKLM\SOFTWARE\Mincrosoft\Windows\CurrentVersion\Uninstall 注册表位置，并且只要 DisplayName 返回某个值，不一定准确（比如“Chrome”），它存储注册表位置？（将放在 {xxxxxxx-xxxxxxx-xxxxxxx-xxxxxx} 中的部分）。

这样，程序只需找到程序并存储它们的位置，以便可以将它们作为变量卸载。我试过了，但据我所知，使用 reg 查询需要完整的位置。使用 reg query HKLM /f 不返回任何结果。我尝试了一系列不同的解决方法，但似乎没有任何效果。

这是我的代码的基本版本（我忽略了发布完整版本，因为其中大部分是重复的。主要是 case where's 和 if then 语句）

```
@echo off
:start
echo Hello
echo.
1: Uninstall Chrome

set /p choice="Enter Choice: "
if "%choice%"=="1" goto uninstall_chrome

:uninstall_chrome
reg query HKLM /f Chrome /t REG_SZ
::msiexec /x{uninstall location for the program} 
```

谢谢。

：：更新：：

我想到了。通过使用 Rob van der Woude 的一些代码，我现在能够做到这一点。这样做的代码是：

```
CALL :Uninstall "Program Name"

:Uninstall
SETLOCAL ENABLEDELAYEDEXPANSION
FOR /F "tokens=* %%A IN ('REG QUERY HKLM\SOFWARE\Microsoft\Windows\CurrentVersion\Uninstall /F "%~1" /D /S 2^>NUL ^| FINDSTR /R /B /C:"HKEY_"') DO (
REG QUERY "%%~A" /F DisplayName /V /E | FINDSTR /R /I /C:" DisplayName .* .*%~1" >NUL 2>&1
FOR /F "tokens=2*" %%B IN ('REG QUERY "%%~A" /F DisplayName /V /E 2^>NUL ^| FIND /I " DisplayName "') DO ECHO Program Name = %%C
FOR /F "tokens=7 delims=\" %%B IN ("%%~A") DO ECHO Unique Identifier = %%B
FOR /F "tokens=2*" %%B IN ('REG QUERY "%%~A" /F UninstallString /V /E ^| FIND /I " UninstallString "') DO %%C /qb
)
ENDLOCAL 
```

这将输出程序名称和唯一标识符，然后卸载程序，无需用户输入（“你想卸载 x 吗？”）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T05:19:45.810

我想到了。通过使用 Rob van der Woude 的一些代码，我现在能够做到这一点。这样做的代码是：

```
CALL :Uninstall "Program Name"

:Uninstall
SETLOCAL ENABLEDELAYEDEXPANSION
FOR /F "tokens=* %%A IN ('REG QUERY HKLM\SOFWARE\Microsoft\Windows\CurrentVersion\Uninstall /F "%~1" /D /S 2^>NUL ^| FINDSTR /R /B /C:"HKEY_"') DO (
REG QUERY "%%~A" /F DisplayName /V /E | FINDSTR /R /I /C:" DisplayName .* .*%~1" >NUL 2>&1
FOR /F "tokens=2*" %%B IN ('REG QUERY "%%~A" /F DisplayName /V /E 2^>NUL ^| FIND /I " DisplayName "') DO ECHO Program Name = %%C
FOR /F "tokens=7 delims=\" %%B IN ("%%~A") DO ECHO Unique Identifier = %%B
FOR /F "tokens=2*" %%B IN ('REG QUERY "%%~A" /F UninstallString /V /E ^| FIND /I " UninstallString "') DO %%C /qb
)
ENDLOCAL 
```

这将输出程序名称和唯一标识符，然后卸载程序，无需用户输入（“你想卸载 x 吗？”）

# javascript - 为什么 jQuery 将其原型别名为`fn`？

> ID：13150944
> 
> 赞同：1
> 
> 时间：2012-10-31T03:41:32.170
> 
> 标签：javascript, jquery, prototype

只需查看任何 jQuery 插件的源代码。总是如此

```
$.fn.pluginName = function() {
    foo('bar');
    return baz;
}; 
```

这个`fn`名字是从哪里来的，它只是一个简单的别名`$.prototype`，还是有其他用途？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:39:39.633

从[jquery源](https://github.com/jquery/jquery/blob/master/src/core.js#L84)：

```
jQuery.fn = jQuery.prototype = { 
```

它只是一个别名，一个捷径，就像how `jQuery`and `$`are一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:43:51.723

fn 是 jquery 库控制元素选择的一部分，因此`$.foo = function () {};`不会存在，`$('#a').foo();`但`$.fn.foo = function () {};`会存在。同样，`$.fn.foo`如果您尝试`$.foo();`. 它还使 this 关键字与当前使用的元素相关。而且您对“任何具有 fn 的 jquery 插件”的评论都是不正确的；）

# c - 逻辑运算符按位计算？

> ID：13150952
> 
> 赞同：0
> 
> 时间：2012-10-31T03:42:34.500
> 
> 标签：c, bit-manipulation

我现在正在研究一个难题....尝试 `if (x==5 || x==7)` 使用按位运算（在 C 中）编写。一直在研究它....无法弄清楚。

任何帮助，将不胜感激！谢谢

Ps 这不是家庭作业...试图学习考试。

编辑，因此格式类似于 `if (x _ _)`空格中的按位运算

SORRY 需要指定，只能是两个字符（运算符或数值） 所以`%8`例如

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:56:41.277

7d = 111b 和 5d = 101b

所以位 0 必须打开，位 1 不关心，位 2 必须打开，位 3-31 必须关闭。因此，屏蔽位 1 并测试 101b

所以你的测试变成 ((x & ~2) == 5)

然后向 Bing 或维基百科询问“卡诺图”，以便您可以自己减少表情。

汤姆在下面的回答也是正确的并且更简单。你可以写

```
((x & 5) == 5) 
```

这稍微快一点。也许我应该使用卡诺图！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-31T04:02:22.567

你可以用 '101' 和它，你得到 5 和 7 的相同结果，即 101。

# c++ - 这个 valgrind 错误是什么意思？

> ID：13150955
> 
> 赞同：6
> 
> 时间：2012-10-31T03:42:57.450
> 
> 标签：c++, linux, memory, valgrind, memory-leaks

我有一个用于绘制 OpenGL 文本的基本库，并且每当我使用 valgrind 来确保它是气密的。我不断收到一个不寻常的错误，在我看来好像 linux c++ 库有问题。我想看看你们是否可以发现我的错误或验证我所担心的，那就是我的 c++ 库有问题，需要更换。代码非常简单，但它同时使用 OpenGL 和 FreeImage，因此某些行没有意义。

这是字体系统.h：

```
#ifndef FONTSYSTEM_H
#define FONTSYSTEM_H

/*
    The Font System works by loading all the font images (max image size 32px^2) into memory and storing
  the OpenGL texture ID's into an array that can be access at all times. The DrawString() functions will
  search through the string for the specified character requested to draw and then it will draw a quad
  and paint the texture on it. Since all the images are pre-loaded, no loading of the images at load time
  is necessary, this is memory consuming but efficiant for the CPU. ALL functions WILL return a character
  string specifing errors or success. A function will work as long as it can and when an error happens,
  unless the error is fatal, the functions will NOT rollback changes! This ensures that during testing, a
  very certain bug can be spotted.
*/

#include <cstdio>
#include <cstdlib>
#include <iostream>
#include <string.h>
#include <assert.h>
#include <GL/gl.h>
#include <GL/glu.h>
#include <GL/glext.h>
#include <FreeImage.h>

#define REPORT(x) (std::cout<<x)
#define TIME clock()

class CFont
{
public:
    CFont();
    ~CFont();

    void DrawString(char *apString, int aiLetterSize, int aiX, int aiY);
    void DrawString(long anNumber, int aiLetterSize, int aiX, int aiY);
    void SetPath(char avPath[]);
    void SetupFont(); // This function will load as many images as possible into memory.

private:
    GLuint *mpTextIDs;
    int *mpDrawIDs;
    char *mpPath;

public:
    CFont(const CFont& a):
        mpTextIDs(a.mpTextIDs),
        mpDrawIDs(a.mpDrawIDs),
        mpPath(a.mpPath)
    {
        std::copy(a.mpTextIDs, a.mpTextIDs+128, mpTextIDs);
        std::copy(a.mpDrawIDs, a.mpDrawIDs+128, mpDrawIDs);
        std::copy(a.mpPath, a.mpPath + strlen(a.mpPath), mpPath);
    }

    CFont& operator=(const CFont& a)
    {
        GLuint *iTmpTex = new GLuint[128];
        int *iTmpDraw = new int[1024];
        char *vTmpPath = new char[4096];

        delete[] mpTextIDs;
        delete[] mpDrawIDs;
        delete[] mpPath;

        std::copy(a.mpTextIDs, a.mpTextIDs+128, iTmpTex);
        std::copy(a.mpDrawIDs, a.mpDrawIDs+128, iTmpDraw);
        std::copy(a.mpPath, a.mpPath + strlen(a.mpPath), vTmpPath);

        mpTextIDs = iTmpTex;
        mpDrawIDs = iTmpDraw;
        mpPath = vTmpPath;

        return *this;
    }
};

#endif // FONTSYSTEM_H 
```

这是fontsystem.cpp：

```
#include "fontsystem.h"

CFont::CFont()
{
    mpTextIDs = new GLuint[128];
    mpDrawIDs = new int[1024];
    mpPath = new char[4096];
}

CFont::~CFont()
{
    delete[] mpTextIDs;
    delete[] mpDrawIDs;
    delete[] mpPath;
}

void CFont::DrawString(char *apString, int aiLetterSize, int aiX, int aiY)
{
    // Sanity check!
    if(apString == NULL)
    {
        REPORT("{Gfx}["<< TIME<< "]Error: Drawing string is NULL! <Font System>\n");
        return;
    }

    if(aiLetterSize <= 0)
    {
        REPORT("{Gfx}["<< TIME<< "]Error: Letter size is less than zero! <Font System>\n");
        return;
    }

    // Search the string from most significant character to least significant.
    int iSelectIndex = 0;
    int iNumOfSymb = 0;
    for(size_t i = 0; apString[i] != '\0'; ++i)
    {
        iSelectIndex = apString[i] >= '0' && apString[i] <= '9' ? (apString[i] - '0') :
                       apString[i] >= 'A' && apString[i] <= 'Z' ? (apString[i] - 'A' + 10) :
                       apString[i] >= 'a' && apString[i] <= 'z' ? (apString[i] - 'a' + 10) :
                       apString[i] == ' ' ? 36 : // This is a special case, This see's if the current character is a space or not.
                       -1;

        if(iSelectIndex == -1)
        {
            return;
        }

        // Add the current selected character to the drawing array.
        mpDrawIDs[i] = iSelectIndex;
        ++iNumOfSymb;
    }

    // Go through and draw each and every character.
    for(size_t i = 0; apString[i] != '\0'/*static_cast<size_t>(iNumOfSymb)*/; ++i)
    {
        // Paint each qaud with the X,Y coordinates. After each quad has been successfully drawn,
        // Add the size to the X coordinate. NOTE: Each character is square!!!

        glBindTexture(GL_TEXTURE_2D, mpTextIDs[(uint)apString[i]]);

        int yPos = apString[i] != 'q' || apString[i] != 'j' || apString[i] != 'y' ? aiY : aiY + (aiLetterSize/2);

        glBegin(GL_QUADS);
            glTexCoord2d(0, 0);
            glVertex2d(aiX, yPos);

            glTexCoord2d(1, 0);
            glVertex2d(aiX + aiLetterSize, yPos);

            glTexCoord2d(1, 1);
            glVertex2d(aiX + aiLetterSize, yPos + aiLetterSize);

            glTexCoord2d(0, 1);
            glVertex2d(aiX, yPos + aiLetterSize);
        glEnd();

        // Now, increase the X position by the size.
        aiX += aiLetterSize;
    }
}

void CFont::DrawString(long anNumber, int aiLetterSize, int aiX, int aiY)
{
    // Sanity Check!
    if(aiLetterSize <= 0)
    {
        REPORT("{Gfx}["<< TIME<< "]Error: Letter size is less than zero! <Font System>\n");
        return;
    }

    // Convert the supplied number to a character string via snprintf().
    char *vTempString = new char[1024];
    snprintf(vTempString, 1024, "%ld", anNumber);

    // Next, run DrawString().
    DrawString(vTempString, aiLetterSize, aiX, aiY);
}

void CFont::SetupFont()
{
    // First Load The PNG file holding the font.
    FreeImage_Initialise(false);

    FIBITMAP *spBitmap = FreeImage_Load(FIF_PNG, mpPath, BMP_DEFAULT);

    if(!spBitmap)
    {
        REPORT("{Gfx}["<< TIME<< "]Error: Was Unable to opne/decode font bitmap! <FreeImage>\n");
        return;
    }

    // Do an image sanity check.
    if(!FreeImage_HasPixels(spBitmap))
    {
        REPORT("{Gfx}["<< TIME<< "]Error: The font bitmap contains nothing! <FreeImage>\n");
        return;
    }

    // Retrieve all the image data from FreeImage.
    unsigned char *pData = FreeImage_GetBits(spBitmap);
    int iWidth = FreeImage_GetWidth(spBitmap);
    int iHeight = FreeImage_GetHeight(spBitmap);
    size_t const ciCharWidth = iHeight;
    size_t const ciCharHeight = iHeight;

    // Cutup the PNG.
    int iFontElementSize = (ciCharWidth*ciCharHeight)*4; // The first two numbers, are the dimensions fo the element, the last number (4) is the number of color channels (Red Green Blue and Alpha)
    unsigned char *pElemBuff = new unsigned char[iFontElementSize]; // The temporary element buffer.

    // Create all 37 OpenGL textures. 0-9 and A-Z and finally space (' ')
    glGenTextures(128, mpTextIDs);

    for (size_t iCharIdx = 0; 128 > iCharIdx; ++iCharIdx)
    {
        // Create character texture.
        size_t const ciScanOfst = ciCharWidth * iCharIdx * 4;
        for (size_t iScanLineIdx = 0; ciCharHeight > iScanLineIdx; ++iScanLineIdx)
        {
            memcpy(pElemBuff + ciCharWidth * iScanLineIdx * 4,
                   pData + ciScanOfst + iWidth * (ciCharHeight - iScanLineIdx - 1) * 4,
                   ciCharWidth * 4);
        }

        // Create The OpenGL Texture with the current Element.
        glBindTexture(GL_TEXTURE_2D, mpTextIDs[iCharIdx]);
        glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA, 32, 32, 0, GL_RGBA, GL_UNSIGNED_BYTE, pElemBuff);

        // Create the correct texture environment to the current texture.
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP);
        glTexParameteri(GL_TEXTURE_2D, GL_GENERATE_MIPMAP, GL_TRUE);
    }

    // Do a little house cleaning!
    delete[] pElemBuff;
    FreeImage_Unload(spBitmap);
    FreeImage_DeInitialise();

    REPORT("{Gfx}["<< TIME<< "]Information: Font was created succesfully! <Font System>\n");
}

void CFont::SetPath(char avPath[])
{
    mpPath = avPath;
} 
```

Valgrind 报告如下：

```
Starting the FontSystem...
FontSystem Started!
==5058== Invalid free() / delete / delete[] / realloc()
==5058==    at 0x402A8DC: operator delete[](void*) (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==5058==    by 0x8048F03: CFont::~CFont() (fontsystem.cpp:14)
==5058==    by 0x8048DE0: main (main.cpp:13)
==5058==  Address 0x804972f is not stack'd, malloc'd or (recently) free'd
==5058== 
==5058== 
==5058== HEAP SUMMARY:
==5058==     in use at exit: 4,172 bytes in 3 blocks
==5058==   total heap usage: 153 allocs, 151 frees, 135,457 bytes allocated
==5058== 
==5058== 20 bytes in 1 blocks are still reachable in loss record 1 of 3
==5058==    at 0x402A5E6: calloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==5058==    by 0x64DB3AD: _dlerror_run (dlerror.c:142)
==5058==    by 0x444EC64: ??? (in /usr/lib/libGL.so.295.59)
==5058== 
==5058== 56 bytes in 1 blocks are still reachable in loss record 2 of 3
==5058==    at 0x402BE68: malloc (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==5058==    by 0x442860E: ??? (in /usr/lib/libGL.so.295.59)
==5058==    by 0xBE872481: ???
==5058==    by 0x4E45504E: ???
==5058== 
==5058== 4,096 bytes in 1 blocks are definitely lost in loss record 3 of 3
==5058==    at 0x402B454: operator new[](unsigned int) (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==5058==    by 0x8048EAC: CFont::CFont() (fontsystem.cpp:7)
==5058==    by 0x8048D68: main (main.cpp:7)
==5058== 
==5058== LEAK SUMMARY:
==5058==    definitely lost: 4,096 bytes in 1 blocks
==5058==    indirectly lost: 0 bytes in 0 blocks
==5058==      possibly lost: 0 bytes in 0 blocks
==5058==    still reachable: 76 bytes in 2 blocks
==5058==         suppressed: 0 bytes in 0 blocks
==5058== 
==5058== ERROR SUMMARY: 2 errors from 2 contexts (suppressed: 0 from 0) 
```

我希望你们能帮助我，因为这些似乎是我所有程序中的常见错误。作为一名编码员，我不太喜欢微妙但令人讨厌的错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-31T03:54:54.097

最突出的问题是这个：

```
==5058== Invalid free() / delete / delete[] / realloc()
==5058==    at 0x402A8DC: operator delete[](void*) (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==5058==    by 0x8048F03: CFont::~CFont() (fontsystem.cpp:14)
==5058==    by 0x8048DE0: main (main.cpp:13)
==5058==  Address 0x804972f is not stack'd, malloc'd or (recently) free'd
==5058== 
```

如您所见，它指的是 的第 14 行`fontsystem.cpp`，在 的析构函数中`CFont`，这里：

```
delete[] mpPath; 
```

显然，您尝试的`delete []`内容从未被动态分配，或者没有以正确的方式分配。怎么可能？构造函数中的相应语句看起来不错：

```
mpPath = new char[4096]; 
```

因此，`mpPath`在调用构造函数后，必须在某处更改了 的值。确实有这个功能：

```
void CFont::SetPath(char avPath[])
{
    mpPath = avPath;
} 
```

您可能会在某处调用它，试图将堆栈分配的数组传输给它。你不应该那样做。如果`CFont`负责分配和解除分配，则不应有一个函数尝试获取外部数组并为其设置成员指针。考虑替代方案，例如将数组的副本复制`avPath`到堆上新分配的数组中。并取消分配先前分配的一个。更好的是，使用`std::vector`或智能指针。

另一个问题是相关的：

```
==5058== 4,096 bytes in 1 blocks are definitely lost in loss record 3 of 3
==5058==    at 0x402B454: operator new[](unsigned int) (in /usr/lib/valgrind/vgpreload_memcheck-x86-linux.so)
==5058==    by 0x8048EAC: CFont::CFont() (fontsystem.cpp:7)
==5058==    by 0x8048D68: main (main.cpp:7) 
```

这是与同一成员相关的内存泄漏，`mpPath`. 当然，发生这种泄漏是因为`setPath`在没有取消分配现有数组的情况下重置了指针。和上面一样的问题。

The rest of the messages are related to various external library calls. Minor memory leaks you can probably not do much about.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-31T03:53:10.133

您丢失的 4096 字节可能来自这里：

```
void CFont::SetPath(char avPath[])
{
    mpPath = avPath;
} 
```

您只是在复制指针（并覆盖旧指针）；您需要像在代码的其他部分一样使用 strcpy 或使用 std::copy 。

# flex4 - Flex 错误，无法加载 SWC

> ID：13150961
> 
> 赞同：2
> 
> 时间：2012-10-31T03:43:17.587
> 
> 标签：flex4, flash-builder, swc

需要帮助解决 Flashbuilder 中一个非常奇怪的错误，其中 SWC 似乎神奇地出现并且给了我错误。Flashbuilder 无法识别 SWC 的所有更新。

![在此处输入图像描述](../Images/e9dd58e6b9b287fecdb247c8da4402b7.png)

在我的 Libs 文件夹中，其中没有 ._controls.swc 文件，但在 Flashbuilder 的构建路径中，它只是神奇地出现并给了我错误，我怀疑这是导致我原来的 controls.swc 无法更新的原因它的movieCLips库。

知道是什么原因造成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-01T03:00:41.860

我只是设法通过从我的源而不是从 flashbuilder 中删除 libs 文件夹来使其工作。然后创建一个新文件夹并将swc文件复制到新文件夹中。然后它工作。所以我想文件夹中一定有一些奇怪的隐藏文件..

感谢所有的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T10:17:10.290

尝试清理您的项目转到项目>清理，我认为这可能对您有用！

# java - 从 Trie 中提取数据

> ID：13150965
> 
> 赞同：1
> 
> 时间：2012-10-31T03:43:48.697
> 
> 标签：java, recursion

我已经实现了一个能够存储数据的通用 trie，但我的问题集中在从 trie 中提取它。这是我的 Trie 和 TrieNode 类，以及我的 getWords() 方法：

```
public class Trie<T extends Comparable<T>> 
{
    private TrieNode root;
    List<String> wordList = new ArrayList<String>();
    StringBuilder word = new StringBuilder();

    public Trie()
    {
        root = new TrieNode((T) " ");
    }

    private class TrieNode implements Comparable 
    {
        private T data;
        private int count;
        private boolean end;
        private List<TrieNode> children; //subnodes

        private TrieNode(T data)
        {
            this.data = data;
            count = 0;
            end = false;
            children = new ArrayList<TrieNode>();
        }
        }

    public List<String> getWords(Trie<T> t) throws Exception
    {
        List<String> words = getWords(t.root);
        return words;
    }

    private List<String> getWords(TrieNode node) throws Exception
    {
        if(node.data.equals(" "))
        {
            if(node.children.size() > 0)
            {
                for(TrieNode x : node.children)
                    return getWords(x);

                return wordList;
            }
            else
                throw new Exception("Root has no children");
        }
        else if(node.children.size() > 0 && node.end == false)
        {
            word.append(node.data);

            for(TrieNode x : node.children)
                return getWords(x);
        }
        else if(node.children.size() == 0 && node.end == true)
        {
            word.append(node.data);
            wordList.add(word.toString());
        }

        return null;
    }
} 
```

我正在我的主类中使用以下代码进行测试：

```
 Trie<String> a = new Trie<String>();
    String[] word = "Steve".split("");
    a.insert(word);

    System.out.println(a.search(word)); //it can find the word in the trie
    System.out.println(a.getWords(a)); //but returns null when traversing through it 
```

输出是：

```
 true
    null 
```

我的代码有什么问题，它无法正确遍历 trie 以提取存储在其中的单词？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:48:06.913

您的`getWords(TrieNode)`实施将提前返回：

```
// ...
else if(node.children.size() > 0 && node.end == false)
{
    word.append(node.data);

    for(TrieNode x : node.children)
        return getWords(x); // here
}
// ... 
```

该行在第一次迭代时通过返回第一个是什么来`return`打破`for`循环。一个可能的解决方法（我不确定我是否完全理解返回的逻辑含义）：`getWords(x)``x``getWords`

```
// ...
else if(node.children.size() > 0 && node.end == false)
{
    word.append(node.data);

    List<String> toReturn = new ArrayList<String>();
    for(TrieNode x : node.children) {
        toReturn.addAll(getWords(x));
    }

    return toReturn;
}
// ... 
```

# php - PHP 和 MySQL 使用 PDO 类

> ID：13150967
> 
> 赞同：1
> 
> 时间：2012-10-31T03:43:58.567
> 
> 标签：php, mysql, pdo

我正在尝试更新数据库，这是我的代码

```
if (isset($_GET['placeorder']))
{
    include 'includes/db.php';

    try
    {
    $newBalance = $_POST['balance'] + $_POST['oldbalance'];
    $sql = 'UPDATE customer SET
            balance = :balance
            WHERE id = :id';
    $s = $pdo->prepare($sql);
    $s->bindValue(':balance', $newBalance);
    $s->execute();
    }
    catch (PDOException $e)
    {
        $error = 'Could not add the new balance for the customer' . $e->getMessage();
        include  'result.php';
        exit(); 

    }
    header('Location: .');
    exit(); 
```

我要做的是更新来自已提交表单的客户的余额。`$s->execute();`如果我尝试回显该值，我可以一直获取代码中的值，`$newBalance`也就是说，在执行该行后它不会显示，页面变为空白。执行语句中发生了一些事情。`$s->execute()`它不允许我的代码继续。任何的想法？我是否以错误的方式使用 PDO 类。它没有到达“catch”声明。任何帮助都会很棒。最终结果是页面返回到它开始更新余额的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:47:27.070

您只是将值绑定到余额，而不是 id，您需要如下行：

```
$s->bindValue(':id', $id); 
```

在查询中使用它们之前，最好确保`$_POST['balance']`和`$_POST['oldbalance']`已设置好：

```
$balance = isset($_POST['balance'])? $_POST['balance'] : 0;
$oldbalance = isset($_POST['oldbalance'])? $_POST['oldbalance'] : 0;
$newbalance = $balance + $oldbalance; 
```

如果您没有收到错误，则可能没有错误报告，您可以通过添加`error_reporting(E_ALL);`到页面顶部来启用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:46:24.687

`var_dump()`两个变量`$_POST['balance']`& `$_POST['oldbalance']`。我相信他们会来的`string`。类型转换是解决方案之一。在这种情况下尝试类型转换以对 int/float 执行加法。

```
$newBalance = (int)$_POST['balance'] + (int)$_POST['oldbalance']; 
```

# linux - 这个shell脚本代码行是什么意思

> ID：13150968
> 
> 赞同：1
> 
> 时间：2012-10-31T03:44:09.180
> 
> 标签：linux, shell, unix, scripting

我需要一些帮助来理解以下 shell 脚本行，

```
apphome =     "`cd \`dirname $0\` && pwd && cd - >/dev/null`" 
```

我所理解的是，这是创建一个名为 apphome 的变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:49:00.880

这**不是**有效的 shell 代码。

外壳不允许有空格`=`

其余的，虽然这看起来很糟糕，但它尝试到`cd`脚本本身的目录，显示当前目录并最后`cd`回到最新的`cd`地方，将他的标准输出重定向`STDOUT`到`/dev/null`垃圾箱（这没有任何意义，`cd`只显示在`STDERR`失败时的标准错误，从不开启`STDOUT`）

如果您想以适当的简单方式执行此操作：

```
apphome="$(dirname $0)" 
```

这就是你所需要的。

**笔记**

反引号

`

用于旧式命令替换，例如

```
foo=`command` 
```

这

```
foo=$(command) 
```

建议使用语法。$() 内的反斜杠处理不那么令人惊讶，并且 $() 更容易嵌套。见[http://mywiki.wooledge.org/BashFAQ/082](http://mywiki.wooledge.org/BashFAQ/082)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-31T04:02:22.807

似乎为“apphome”变量分配了一个命令。该命令可以稍后执行。dirname 返回文件名的目录部分。$0 是该行包含的脚本的名称（如果我没记错的话）。现在，执行`dirname <name>`将返回一个目录，而 cd 将使用该值。因此，假设每个命令都成功，它将执行一行中的三个命令。命令是：

```
cd `dirname [脚本名称]`
密码
光盘 -

```

第一个命令会将目录更改为包含您的脚本的目录；第二个将打印当前目录；第三个会带你回到原来的目录。第三个命令的输出不会被打印出来。总之，它将打印出一个目录的名称，该目录包含包含相关行的脚本。至少，我是这样理解的。

# ios - 如何在 UITableviewcell 中隐藏或显示 uibutton

> ID：13150972
> 
> 赞同：1
> 
> 时间：2012-10-31T03:45:03.760
> 
> 标签：ios, uitableview, uibutton

我在 uitableviewcell 中创建了一个按钮

```
@interface MyMusicLibraryCell : UITableViewCell
{
    IBOutlet UIButton * rangeBtn ;
} 
```

在 .m 文件中

```
@synthesize rangeBtn;
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Initialization code 
        rangeBtn = [[UIButton alloc] init];
        rangeBtn = [UIButton buttonWithType:UIButtonTypeCustom];
        [rangeBtn setBackgroundImage:[UIImage imageNamed:@"fav_4.png"] forState:UIControlStateNormal];
        rangeBtn.frame = CGRectMake(260.0f, 10.0f, 20.0f, 20.0f);
        [self addSubview:rangeBtn];
    }

    return self;
} 
```

我想使用 rangeBtn 并在 cellForRowAtIndexPath 中添加一个 addTarget。我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T04:04:34.513

在按钮上添加一个`tag`，您可以按如下方式访问该按钮：

```
// initWithStyle
rangeBtn.tag = 1;

// cellForRowAtIndexPath
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier: @"cell"];
    UIButton *cellButton = (UIButton *)[cell viewWithTag: 1];

    // add target to the button
    [cellButton addTarget: self action: @selector(buttonPressed:) forControlEvent: UIControlEventTouchUpInside];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T04:07:12.567

将 rangeBtn.tag 设置为某个值（例如 100）。

然后在 cellForRowAtIndexPath 中使用：btn = [cell viewWithTag:100] 获取对按钮的引用

现在您可以为该按钮设置目标。

# android - 进度条不更新上传分段的位置

> ID：13150978
> 
> 赞同：0
> 
> 时间：2012-10-31T03:46:03.713
> 
> 标签：android, android-emulator

我有使用这样的多部分上传的代码，在这段代码中我添加了进度条

```
protected String doInBackground(String... args) {

            namapro = inputtitle.getText().toString();
            hargapro = inputprice.getText().toString();
            despro= inputdes.getText().toString();
            orderpro = inputorder.getText().toString();
            path = getIntent().getStringExtra("pathimage");         

            product.setTitle(namapro);
            product.setPrice(hargapro);
            product.setDesc(despro);
            product.setHow(orderpro);
            product.setImage(path);

                try{    

                    CustomMultipartEntity multipartContent = new CustomMultipartEntity(new ProgressListener()
                    {
                        @Override
                        public void transferred(long num)
                        {
                            int upload = ((int)((num/(float)totalSize)*100));
                            String progress = String.valueOf(upload);
                            publishProgress(progress);
                        }
                    });

                HttpEntity resEntity;
                HttpContext httpContext = new BasicHttpContext();
                HttpClient httpClient = new DefaultHttpClient();
                HttpPost post = new HttpPost(Constants.url_create_product);
                MultipartEntity reqEntity = new MultipartEntity(HttpMultipartMode.BROWSER_COMPATIBLE);
                File file= new File(path);
                FileBody bin = new FileBody(file);

                reqEntity.addPart("phone", new StringBody(mPhoneNumber));
                reqEntity.addPart("prod_title", new StringBody(namapro));
                reqEntity.addPart("prod_price", new StringBody(hargapro));
                reqEntity.addPart("prod_desc", new StringBody(despro));
                reqEntity.addPart("prod_order", new StringBody(orderpro));
                reqEntity.addPart("prod_image", bin);
                totalSize = reqEntity.getContentLength();
                post.setEntity(reqEntity);
                HttpResponse response = httpClient.execute(post);
                resEntity = response.getEntity();
                String response_str = EntityUtils.toString(resEntity);
                Gson gson = new Gson();
                gson.toJson(response_str);

                if (resEntity != null) {
                     //Log.i("RESPONSE",response_str);
                     runOnUiThread(new Runnable(){
                         public void run() {
                             try {

                                if(daftar.equalsIgnoreCase("2")){// sudah connect fb twitter
                                    Intent i = new Intent(productdetail.this, home.class);
                                    Toast.makeText(getApplicationContext(), "Upload success", Toast.LENGTH_LONG).show();

                                    startActivity(i);
                                    finish();
                                }
                                else if(daftar.equalsIgnoreCase("1")){ // belum connect fb dan twitter
                                    dialog();
                                }
                             }catch (Exception e) {
                                    e.printStackTrace();

                            }

                        }
                         });
                     }

            }catch (Exception ex){
                 Log.e("Debug", "error: " + ex.getMessage(), ex);
                 dialog_gagal();  
            }

            return null;  
        }                       

            protected void onPostExecute(String file_url) {
                    // dismiss the dialog once done
                    pDialog.dismiss();
            }   

            protected void onProgressUpdate(Integer...progress){
                pDialog.setProgress((int) (progress[0]));
                //pDialog.setProgress(pDialog.getMax()-bytesAvailable);
            } 
```

但是当我运行这段代码时，进度条没有显示progressBar 没有在进程中更新。我只看到 %0 和 %100。这个怎么解决？？你能帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T06:48:06.490

您上传的数据有多大（以字节为单位）？它可能太小以至于进度监听器只被调用一次：当它完成时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T10:55:54.387

您`totalSize`可能是 0，请尝试在您的 publishProgress 中将其注销

也尝试记录这个`totalSize = reqEntity.getContentLength();`

# c# - 从其他方法或异步访问文本框

> ID：13150979
> 
> 赞同：3
> 
> 时间：2012-10-31T03:46:14.900
> 
> 标签：c#, windows-phone-7, asynchronous

我对 C# 有点陌生，并且`textbox`在异步方法中检索值时遇到了一些问题。我是在 UI 中检索文本输入并在代码中使用它的线程。VS 2010 接受我的代码，但是当我开始调试时，它给了我以下异常 `Invalid cross-thread access`。想法？我错过了什么吗？

```
public void Response_Completed(IAsyncResult result)
{
    HttpWebRequest request = (HttpWebRequest)result.AsyncState;
    HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(result);

    using (StreamReader streamReader = new StreamReader(response.GetResponseStream()))
    {
        JObject rootObject = JObject.Load(new JsonTextReader(streamReader));

        string tracknum = trackid.Text; // Invalid cross-thread access exception
        string source = rootObject[tracknum]["source"].ToString();

        Deployment.Current.Dispatcher.BeginInvoke(() =>
        {
            //removed
        });
    }
} 
```

注意：我正在尝试在 Windows Phone 7 平台上执行此操作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-31T03:54:46.553

您应该在 UI 线程而不是其他线程上获取文本框值。[Invoke 方法](http://msdn.microsoft.com/en-us/library/zyzhdc6b.aspx)在 UI 线程上执行指定的委托：

```
string tracknum = (string)trackid.Invoke(new Func<string>(() => trackid.Text)); 
```

**编辑：**

在 Windows 手机上：

```
string tracknum = string.Empty;
Deployment.Current.Dispatcher.BeginInvoke(() =>
   {
       tracknum = trackid.Text;
       string source = rootObject[tracknum]["source"].ToString();
   }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:57:16.597

您将收到此类异常，因为您尝试从与创建对象不同的线程访问对象（尝试异步访问线程）

为了解决这个问题，我们需要在拥有控件底层窗口句柄的线程上执行一个委托。在这种情况下，我们可能会使用`Invoke(Delegate method)`

**例子**

```
public void Response_Completed(IAsyncResult result)
{
    this.Invoke((MethodInvoker)delegate
    {
         HttpWebRequest request = (HttpWebRequest)result.AsyncState;
         HttpWebResponse response = (HttpWebResponse)request.EndGetResponse(result);
         using (StreamReader streamReader = new StreamReader(response.GetResponseStream()))
         {
            JObject rootObject = JObject.Load(new JsonTextReader(streamReader));
            string tracknum = trackid.Text; // Invalid cross-thread access exception
            string source = rootObject[tracknum]["source"].ToString();
         }
    });
} 
```

`MethodInvoker`提供了一个简单的委托，用于调用具有 void 参数列表的方法。`Invoke`当调用控件的方法时，或者当您需要一个简单的委托但不想自己定义一个委托时，可以使用此委托。

谢谢，
我希望你觉得这有帮助:)

# python - 如何调试Django验证，找不到相关对象

> ID：13150980
> 
> 赞同：0
> 
> 时间：2012-10-31T03:46:16.680
> 
> 标签：python, django

我有错误：

```
Error: One or more models did not validate:
auth.permission: 'content_type' has a relation with model <class 'django.contrib.contenttypes.models.ContentType'>, which has either not been installed or is abstract. 
```

我在包中的任何地方都看不到 django.contrib.contenttypes.models.ContentType 的引用。

即使所有模型都在逗号内，我也会收到此错误。

我多次引用用户，但为什么会出现 content_type 错误呢？

Django==1.4.2

编辑：因为人们认为我的模块被命名为 auth，以下是它在整个项目中存在的位置：

模型.py

```
2: from django.contrib.auth.models import User 
```

设置.py

```
94: 'django.contrib.auth.middleware.AuthenticationMiddleware',
112: 'django.contrib.auth', 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T15:04:29.410

在设置 INSTALLED_APPS 下有

```
'django.contrib.contenttypes', 
```

失踪。jro 的票证链接很有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T07:41:15.150

您的问题很可能是 Kay Zhu 所暗示的：目前，您无法调用您的应用程序`auth`。该问题的简短版本`manage.py`取决于其他几个模块，其中一个是内置的`django.contrib.auth`. 请参阅[此票](https://code.djangoproject.com/ticket/16283)以获取更多信息。

解决方案是在您的`INSTALLED_APPS`元组中引用麻烦的模块，或者（如果您碰巧有一个名为 的应用程序`auth`）重命名导致名称冲突的模块。有一个删除此依赖项的[功能请求](https://code.djangoproject.com/ticket/8579)，但我现在不会等待。

# ruby-on-rails - Rails content_for和yield有什么区别？

> ID：13150983
> 
> 赞同：12
> 
> 时间：2012-10-31T03:47:01.907
> 
> 标签：ruby-on-rails

例如： `content_for(:stuff)`vs`yield :stuff`

我知道它们的实现方式略有不同，但有什么真正的功能差异吗？

是否有普遍接受的最佳实践？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-10-31T03:58:56.273

`yield`是您如何指定内容区域在布局中的位置。你可能有这样的事情：

```
<div>
  <h1> This is the wrapper!</h1>
  <%= yield :my_content %>
</div> 
```

`content_for`是您如何指定将哪些内容呈现到哪个内容区域。你可能有这样的事情：

```
<% content_for :my_content do %>
  This is the content.
<% end %> 
```

结果将是

```
<div>
  <h1> This is the wrapper!</h1>
  This is the content.
</div> 
```

它们是渲染过程的两端，`yield`指定内容的去向，并`content_for`指定实际内容*是*什么。

> 是否有普遍接受的最佳实践？

最佳实践是`yield`在您的布局和`content_for`视图中使用。有一个特殊的第二个用途 for `content_for`，你不给它块，它返回之前渲染的内容。这主要用于`yield`无法工作的辅助方法。在您的观点中，最好的做法是坚持`yield :my_content`回忆内容并`content_for :my_content do...end`渲染内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-31T03:51:20.367

屈服：

> yield 标识应该插入视图内容的部分

content_for：

> content_for 方法允许您将内容插入到布局中的命名 yield 块中。例如，此视图将适用于您刚刚看到的布局：

`yield :stuff`将抓取被推送的内容`content_for(:stuff)`

因此，使用`yield`您可以定义视图/布局中的部分，并`content_for`用于向这些部分添加内容。任何未命名`yield`的都会抓取所有其他内容。

[您可以通过阅读教程](http://guides.rubyonrails.org/layouts_and_rendering.html#understanding-yield)了解更多信息。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-16T19:21:50.903

调用 #content_for 将标记块存储在标识符中以供以后使用。为了在其他模板、帮助模块或布局中访问此存储的内容，您可以将标识符作为参数传递给 content_for。yield 仍可用于检索存储的内容，但在帮助模块中调用 yield 不起作用，而 content_for 则......更多：[http ://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html #method-i-content_for](http://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html#method-i-content_for)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-08-10T14:40:17.343

来自 Ruby on Rails API：

> 调用`content_for`将标记块存储在标识符中以供以后使用。为了访问其他模板、帮助模块或布局中存储的内容，您可以将标识符作为参数传递给`content_for`.
> 
> 注意：`yield`仍然可以用于检索存储的内容，但调用`yield`在帮助模块中`content_for`不起作用，而在。
> 
> 然后，您可以`content_for :not_authorized`在模板中的任何位置使用。

```
<%= content_for :not_authorized if current_user.nil? %> 
```

> 这相当于：

```
<%= yield :not_authorized if current_user.nil? %> 
```

> `content_for`但是，也可以在辅助模块中使用。

[https://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html#method-i-content_for](https://api.rubyonrails.org/classes/ActionView/Helpers/CaptureHelper.html#method-i-content_for)

# asp.net - 支持 Oracle 8i 的 .NET ORM

> ID：13150984
> 
> 赞同：0
> 
> 时间：2012-10-31T03:47:03.607
> 
> 标签：asp.net, oracle, orm, oracle8i

我的任务是使用 ASP.NET MVC3 重写 ColdFusion 应用程序。我想在这个应用程序中使用 ORM 来加速开发。

但是，我很难找到一个支持现有数据已经​​在其中的 Oracle 8i 数据库的数据库。

有谁知道任何可以解决这个问题的 ORM 系统？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T21:30:12.030

我更喜欢这个 - [http://bltoolkit.net/](http://bltoolkit.net/) 它实际上对 LINQ 的支持比 Linq2SQL 更好，而且它也有 Oracle 提供程序。它是一种轻量级但同时非常强大的功能。

# .net - 二维数组

> ID：13150986
> 
> 赞同：1
> 
> 时间：2012-10-31T03:47:13.470
> 
> 标签：.net, arrays, vb.net, multidimensional-array

我正在使用带有 Visual Basic 的 Visual Studio 2010。我有一个进入函数的动态二维数组。我无法弄清楚如何获得第一行的大小。

例如，假设这个数组被传递到函数中：

```
{{1, 0, 5, 4},
 {8, 1, 4, 4},
 {0, 1, 4, 4},
 {7, 7, 7, 4},
 {7, 7, 7, 4},
 {8, 1, 4, 4}} 
```

在这个例子中，我会得到 4，因为如果你看例如第一行它有 4 个元素。例如在这种情况下：

```
{{1, 0, 5, 4, 7, 7},
 {8, 1, 4, 4, 7, 7},
 {0, 1, 4, 4, 8, 8},
 {7, 7, 7, 4, 3, 3},
 {7, 7, 7, 4, 4, 4},
 {8, 1, 4, 4, 1, 9}} 
```

我会回来 6 因为行中有 6 个元素。数组总是 2d 的，并且行总是相同的长度。列大小未知，行大小未知。但是，如果我找出一行的行大小，那么如果有意义的话，所有行都是那个大小。

我试过这个 UBound(inArray, 1) 但它不起作用。请帮我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T03:50:04.377

看看使用[Array.GetUpperBound 方法](http://msdn.microsoft.com/en-us/library/system.array.getupperbound.aspx#Y0)

> 获取 Array 中指定维度的上限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-31T03:50:24.717

```
Dim i(,) As Integer = {{1, 0, 5, 4}, {8, 1, 4, 4}, {0, 1, 4, 4}, {7, 7, 7, 4}, {7, 7, 7, 4}, {8, 1, 4, 4}}
MsgBox(i.GetUpperBound(0)) 'first index
MsgBox(i.GetUpperBound(1)) 'second index
MsgBox(UBound(i, 1)) 'first index (UBOUND is 1-based)
MsgBox(UBound(i, 2)) 'second index (UBOUND is 1-based) 
```

对于二维数组`i(x,y)`，`GetUpperBound(0)`返回 的最大值`x`，并`GetUpperBound(1)`返回 的最大值`y`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-08-18T11:04:17.980

要查找 x 轴的长度，请使用 GetLength 函数。我已经尝试过 GetUpperBound 函数，但有时它被证明有点不可靠。请使用以下代码作为参考：

```
Dim array(1,10) As Double
Dim x as Integer = array.GetLength(0) - 1 'Will give you value of dimension x' 
```

# performance - 在 Apache Pig 中哪个更快：拆分然后联合或过滤和左连接？

> ID：13150987
> 
> 赞同：1
> 
> 时间：2012-10-31T03:47:15.260
> 
> 标签：performance, apache-pig

我目前正在处理 Pig Latin 中的一个大型输入表（10^7 行），其中该表在某些字段上被过滤、处理并将处理后的行返回到原始表中。当已处理的行返回到原始表中时，过滤器所基于的字段会发生更改，以便在后续过滤中忽略已处理的字段。

在 Apache Pig 中，首先根据过滤条件拆分已处理和未处理的表，应用处理并将两个表合并在一起，还是过滤第一个表，将进程应用于过滤后的表并执行左连接，是否更有效？使用主键的原始表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:40:51.453

我不能说哪一个实际上会运行得更快，我会简单地运行两个版本并比较执行时间:)

如果您选择第一个解决方案（拆分，然后连接），请确保在连接操作中**首先指定两个表中较小的（如果有的话）**（可能这将是新添加的数据）。[Pig 文档](http://pig.apache.org/docs/r0.7.0/cookbook.html#Take+Advantage+of+Join+Optimizations)建议这将导致性能改进，因为最后一个表“没有被带入内存，而是通过流式传输”。

# php - 为 Simplepie RSS 项目生成 div id 编号

> ID：13150990
> 
> 赞同：-1
> 
> 时间：2012-10-31T03:47:26.160
> 
> 标签：php, wordpress, rss, simplepie

我在 Wordpress 博客上使用 Simplepie 获取 RSS 提要。每个 RSS 项目都有一个 div 容器，我希望每个项目都有一个唯一的 id 号（类似于`<div id="div-#">`）。

如何为每个项目生成一个唯一编号？这是我正在使用的代码：

```
<ul>

<?php include_once(ABSPATH . WPINC . '/feed.php');
$rss = fetch_feed(http://www.example.com);
if (!is_wp_error( $rss ) ) :  
$maxitems = $rss->get_item_quantity(6); 
    $rss_items = $rss->get_items(0, $maxitems); 
    endif; ?>

<?php 
    if ($maxitems == 0) echo '<li>No items.</li>';
    foreach ( $rss_items as $item ) :  ?>

        <a href="<?php   echo $item->get_link();?>">

        <?php  
                echo '<li><div class="item-headline" id="div-">'.
                $item->get_title().
                '</div><div class="item-info">'.
                $item->get_description().
                '</div></li>';
            ?>

        </a>    

<?php endforeach; ?>

    </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T03:59:23.103

尝试类似：

```
<?php
foreach ($feed->get_items() as $item) {
    echo '<div id="item-<?php echo $num ?>">';
    // ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T04:34:17.483

用于[`get_id(true)`](http://simplepie.org/wiki/reference/simplepie_item/get_id)获取项目的唯一 MD5 哈希。

```
echo '<li><div class="item-headline" id="div-'.$item->get_id(true).'">'. 
```

# php - 一个带有两个提交按钮的输入文本字段，用于搜索单独的页面

> ID：13150994
> 
> 赞同：0
> 
> 时间：2012-10-31T03:47:53.767
> 
> 标签：php, url, isset

我有一个项目需要一个搜索表单，该表单根据用户正在寻找的内容搜索两个单独的 eBay 商店。

我想要一个带有两个提交按钮的输入字段。我在获取表单以指定从任一按钮调用哪个站点时遇到问题。我环顾四周并尝试了一些事情，但认为有人可能能够理顺我的语法等。

我有表格。

```
<form target="_blank" action="rp.php" method="get">

<input type="text">

<button name="replacement" type="submit">Search Replacement Parts</button>

<button name="performance" type="submit">Search Performance Parts</button>

</form> 
```

..我有PHP。

```
<?php

    if( isset($_GET['replacement']) ) {

        header("Location: http://www.example.com");
        exit;

    } else if {

        ( isset($_GET['performance']) ) {

        header("Location: http://www.example.com");
        exit;

    }

?> 
```

我想我走在正确的轨道上，只需要一点帮助。我不知道是否使用 POST 或 GET，GET 似乎对我来说更有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-31T04:01:23.273

您可以为此使用以下代码：

```
<form target="_blank" name="myform"  method="POST">

<input type="text" name="search">

<button  onclick="submit1('http://example1.com/')" >Search Replacement Parts</button>

<button onclick="submit1('http://example2.com/')" >Search Performance Parts</button>

</form>

<script>

   function submit1(url)
   {
      document.myform.action=url;
      document.myform.submit();
   }

</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-31T03:53:54.167

你的 PHP 有点偏离`elseif`，否则它应该“工作”

```
<?php
if ( isset($_GET['replacement']) ) {
    header("Location: http://www.example.com");
    exit;
} elseif ( isset($_GET['performance']) ) {
    header("Location: http://www.example.com");
    exit;
}
?> 
```

您可以使用 a`GET`或 a`POST`来执行此操作，但是 a`GET`将导致查询值在查询字符串中可见，并且在某些较旧的浏览器中大小有限。`POST`可能是首选，在这种情况下，您将在上面的代码中替换为，并`$_GET`在您的表单中更改为。`$_POST``method="get"``method="post"`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-31T03:55:53.003

我会为两个按钮使用相同的名称，每个按钮都有不同的值，然后在 php 代码中检查提交的值。

# c# - 有界 BlockingCollections 在添加期间会丢失数据吗

> ID：13150998
> 
> 赞同：6
> 
> 时间：2012-10-31T03:48:49.943
> 
> 标签：c#, multithreading, parallel-processing, concurrentdictionary, blockingcollection

我有一个 BlockingCollection(ConcurrentBag, 50000)，我试图为生产者线程使用 50,000 的非常小的有界容量，以最大限度地增加我可以在消费者线程的 ConcurrentDictionary 中处理的记录数。生产者比消费者快得多，否则会消耗大部分内存。

不幸的是，我立即注意到我的 ConcurrentDictionary 中的记录总数现在大大低于在我的测试数据执行时添加 50,000 的有界容量后应有的记录数。我读到 BlockingCollection 的 .add 方法应该无限期地阻塞，直到集合中有空间可以执行添加。然而，情况似乎并非如此。

**问题：**

1.  如果在 BlockingCollection 中的容量释放之前调用了太多 add 方法，BlockingCollection 的 .add 方法最终会超时还是静默失败？

2.  如果 #1 的答案是肯定的，那么在超出 Bounding Capacity 后我可以尝试多少次添加而不丢失数据？

3.  如果调用了许多 BlockingCollection .add() 方法，这些方法正在等待/阻塞容量并调用 CompleteAdding() 方法，那么那些等待/阻塞的添加会继续等待然后最终添加还是静默失败？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-03T19:27:59.423

如果您将 BlockingCollection 与 ConcurrentDictionary 一起使用，请确保您的代码中没有隐藏 BlockingCollection.TryAdd(myobject) 方法，并且将其误认为是 ConcurrentDictionary.TryAdd() 方法。如果 BlockingCollection 的 Bounding Capacity 已超出， BlockingCollection.TryAdd(myobject) 将返回 false 并丢弃产生“静默失败”的添加请求。

1.  BlockingCollection 的 .Add() 方法在大量超出 Bounding Capacity 后似乎不会“静默失败”或丢失添加。add() 方法最终会导致进程耗尽内存，如果有太多的 .add() 等待添加到容量过剩的 BlockingCollection。（这必须是流量控制问题的一个非常极端的情况）
2.  见#1。
3.  我自己的测试似乎表明，一旦调用 CompleteAdding() 方法，所有后续添加都会失败，如 MSDN 文档中所述。

**关于性能的最后说明**

与在同一过程中不使用 Bounding Capacity 和 .TryAdd() 相比，似乎（在我自己的情况下）在 BlockingCollection 上使用 Bounding Capacity 和 .Add() 非常慢。

通过实施我自己的边界容量策略，我取得了更好的性能结果。有很多方法可以做到这一点。三个选项包括与 Monitor.PulseAll() 一起使用的 Thread.Sleep()、Thread.Spinwait() 或 Monitor.Wait()。当使用其中一种策略时，也可以使用 BlockingCollection.TryAdd() 而不是 BlockingCollection.Add() 并且没有边界容量，而不会丢失任何数据或内存不足。这种方法似乎也能产生更好的性能。

**您可以根据哪种方案最适合生产者和消费者线程中的速度差异，从三个示例中进行选择。**

**Thread.Wait() 示例：**

```
//Check to see if the BlockingCollection's bounded capacity has been exceeded.
while (Tokens.Count > 50000)
{   //If the bounded capacity has been exceeded
    //place the thread in wait mode 
    Thread.Sleep(SleepTime);
} 
```

**Thread.SpinWait() 示例：**

```
//Check to see if the BlockingCollection's bounded capacity has been exceeded.
while (Tokens.Count > 50000)
{   //If the capacity has been exceeded
    //place the thread in wait mode 
    Thread.SpinWait(SpinCount);
} 
```

**Monitor.Wait() 示例**

这个例子需要在生产者和消费者端都有一个钩子。

**生产者代码**

```
//Check to see BlockingCollection capacity has been exceeded.
if (Tokens.Count > 50000)
{ 
    lock (syncLock)
    {   //Double check before waiting
        if (Tokens.Count > 50000)
        {
            Monitor.Wait(syncLock, 1000);
        }
    }
} 
```

**消费者守则**

```
//Check to see BlockingCollection capacity is back a normal range.
if (Tokens.Count <= 40000)
{ 
    lock (syncLock)
    {   //Double check before waiting
        if (Tokens.Count < 40000)
        {
            Monitor.PulseAll(syncLock);
        }
    }
} 
```

# android - 我点击按钮，可以向listView添加数据

> ID：13150999
> 
> 赞同：0
> 
> 时间：2012-10-31T03:48:55.073
> 
> 标签：android, listview

我在一个Activity中设置了一个Gribview和一个listview，在Gridview中有一个TextView和一个Button，我想要做的是，**当我点击按钮时，可以向listView添加数据。**并且按钮和listView在不同的布局中文件。

xml代码是：

```
<?xml version="1.0" encoding="utf-8"?>  
<LinearLayout  
  xmlns:android="http://schemas.android.com/apk/res/android"  
  android:id="@+id/root"  
  android:orientation="vertical"  
  android:layout_width="wrap_content"  
  android:layout_height="wrap_content"  
  android:layout_marginTop="5dp"  
  android:descendantFocusability="blocksDescendants" 
  >  

  <ImageView
  android:id="@+id/image"
  android:layout_width="180dp"
  android:layout_height="160dp"
  android:layout_gravity="fill"
  android:padding="4dp"
  android:scaleType="fitXY" />

  <LinearLayout android:orientation="horizontal" android:layout_width="wrap_content" android:layout_height="wrap_content">

  <LinearLayout android:orientation="vertical" android:layout_weight="1" android:layout_width="wrap_content" android:layout_height="wrap_content">

  <TextView  
  android:id="@+id/title"  
  android:layout_width="wrap_content"  
  android:layout_height="wrap_content"  
  android:layout_gravity="center"  
  android:gravity="center_horizontal" 
  android:text="prices"  
  />  
  <TextView  
  android:id="@+id/prices"  
  android:layout_width="wrap_content"  
  android:layout_height="wrap_content"  
  android:layout_gravity="center"  
  android:gravity="center_horizontal"  
  android:text="name"  
  />  
  </LinearLayout>
  <LinearLayout android:layout_width="0.0dip" android:layout_height="wrap_content" android:layout_weight="9" />
  <Button 
  android:id="@+id/add"  
  android:layout_width="45dip"  
  android:layout_height="45dip"  
  android:layout_gravity="center"  
  android:gravity="center_horizontal" 
  android:text="+" 
  android:layout_weight="0.2"
  android:textSize="12pt"
  />
  </LinearLayout>
</LinearLayout> 
```

我想实现当我点击按钮时，我选择的图像的序列号可以添加到 listView 中。

**添加：**

maybe I didn't say it clear.I have gridView and listView in one layout file.In the gridView I define an layout file ,which contain an ImageView and a Button.What I realize is ,when the app run,I have obtain the button's action in getView,What I want:in button events ,**how to write the position values in listView**.I haven't got the solution yet ,it really bother me ,thankx for any help.

**ADD2**:

Now I have achieved the `adapter.notifyDataSetChanged()`adding data in ListView.but I don't know how to obtain the string variable in Acitivity,the string variable is given by text(`TextView android:id="@+id/prices"`) in ListView to Activity.When I refresh View(`adapter.notifyDataSetChanged()`),I get "0". why?could anyone help?thank a lot.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T04:51:46.803

You'll need to begin by adding a ListView to your layout file, and adding a button handler.

Take a look at [Dynamically add elements to a listView Android](https://stackoverflow.com/questions/4540754/add-dynamically-elements-to-a-listview-android)

This links to a Stack Overflow question/answer that should get you started