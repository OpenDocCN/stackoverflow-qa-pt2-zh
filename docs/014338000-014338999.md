# StackOverflow 问答 14338000-14338999

# c# - 从 DataTable 创建唯一项数组

> ID：14338004
> 
> 赞同：0
> 
> 时间：2013-01-15T12:42:46.653
> 
> 标签：c#, arrays

我想从数据表列创建一组独特的项目。我知道如何创建数据视图...

```
DataView view = new DataView(table);
DataTable distinctValues = view.ToTable(true, "Column1", "Column2" ...); 
```

数组是否有类似的方法？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T12:45:27.273

您可以使用 LINQ

```
DataTable myDataTable = new DataTable();
//......
string[] uniqueItems = myDataTable.AsEnumerable()
                                  .Select(r=> r.Field<string>("MyColumn"))
                                  .Distinct()
                                  .ToArray(); 
```

;

# sql - 使用 linq 选择特定列：传输什么？

> ID：14338008
> 
> 赞同：10
> 
> 时间：2013-01-15T12:42:58.420
> 
> 标签：sql, linq, orm

我参考这个例子：[返回选定的指定列](https://stackoverflow.com/questions/819558/return-selected-specified-columns)

Quote: 如果 BlobDetails 不是 LINQ 实体，那么你可以直接这样做：

```
var qry = from b in dc.Blobs
          orderby b.RowVersion descending
          select new BlobDetails {
              Id = b.Id, Size = b.Size,
              Signature = b.Signature, RowVersion = b.RowVersion};

return qry.ToList(); 
```

我看到他们正在通过 ORM 工具 LINQ TO SQL 选择查询中的特定列。ORM 工具的批评者说，如果我没记错的话，ORM 工具从表中选择并返回整个对象，并限制了仅选择特定列的选项，就像通过经典 SQL 编程可以做到的那样。当然，当我看到这个例子时，我对此表示怀疑，但是，我仍然一直在问自己这个问题：数据库是只返回选定的列，还是返回整个对象，将列过滤留给ORM 工具？

在这个例子中，他们还有一个名为 Blobdetails 的类：

```
public class BlobDetails   
{  
    public int Id { get; set; }  
    public string Signature { get; set; }  
    public int Size { get; set; }  
    public System.Data.Linq.Binary RowVersion { get; set; }     
} 
```

每次我只想通过 LINQ 从表中选择几列时，是否需要创建自己的类？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-15T14:07:42.103

您无需创建新类即可从表中选择几列。您可以为此使用匿名类型。

```
var qry = from b in dc.Blobs
          orderby b.RowVersion descending
          select new { b.Id, b.Size, b.Signature, b.RowVersion};

return qry.ToList(); 
```

仅传输选定的列。使用普通 SQL 和使用 LINQ to SQL 之间没有区别。当您执行 LINQ 查询时，它会转换为普通 SQL 并执行。然后将结果映射到您的对象。

您可以使用 SQL Server Profiler 查看在服务器上生成和执行的查询。您还可以使用[LINQPad](http://www.linqpad.net/)查看您的查询将生成什么 SQL。在您的情况下，无论您使用 BlobDetails 还是匿名对象，查询都是相同的：

```
SELECT [t0].[Id], [t0].[Size], [t0].[Signature], [t0].[RowVersion]
FROM [Blobs] AS [t0]
ORDER BY [t0].[RowVersion] DESC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T13:52:58.147

我认为您第一个问题的答案已经在您提到的 POST 中。然而...

如果您`BlobDetails`不是 LINQ 实体，您可以简单地在`select`语句中使用它来定义（缩小）您的投影属性。例如：

```
var qry = from b in dc.Blobs
          select new BlobDetails { Id = b.Id, Size = b.Size } 
```

将编译为 SQL 查询，如`SELECT Id, Size FROM Blob ....`

*但如果`BlobDetails`是 LINQ 实体，您将需要使用该`AsEnumerable()`hack，否则您将获得`NotSupportedException: Explicit construction of entity type in query is not allowed`.*

```
var qry = from b in dc.Blobs.AsEnumerable()
          select new BlobDetails { Id = b.Id, Size = b.Size } 
```

**编辑**

正如@Chris Pitman 在他的评论中所说，这种`AsEnumerable()`方法可能会造成严重的瓶颈，因为在应用投影之前整个表将加载到内存中。**所以不推荐！**

*对于你的第二个问题：*

您需要为希望在方法范围之外轻松使用的对象创建自定义类。匿名对象的属性仅在已声明它们的范围内可见，并且匿名对象只能强制转换为 type `object`。

因此，如果您想从方法返回匿名对象，则返回类型必须是可枚举的，`object`或者`dynamic`正如@xeondev 在他的评论中所说的那样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T13:54:08.507

当您进行预测时，LINQ 确实只选择了那些列，并且没有什么可以阻止您根据需要实现它。所以在你的示例代码中

```
select new BlobDetails 
{
  Id = b.Id, 
  Size = b.Size,
  Signature = b.Signature, 
  RowVersion = b.RowVersion
}; 
```

仅选择 b.id、b.size、b.signature 和 b.rowversion。您可以使用 sql profiler 或调试器验证这一点，我似乎记得还有一个函数可以调用 datacontext 来获取运行的最后一个查询。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T12:53:48.910

无需创建自己的类，您可以返回匿名类型。你可以写这样的东西

```
var qry = from b in dc.Blobs
          orderby b.RowVersion descending
          select new {
              Id = b.Id, Size = b.Size,
              Signature = b.Signature, RowVersion = b.RowVersion};

return qry.ToList(); 
```

虽然方法的签名应该看起来像这样

```
public  IEnumerable<object> GetItems() 
```

或者

```
public dynamic GetItems() 
```

因此，如果您要像示例建议的那样在外部范围内使用 linq 查询的结果，强烈建议您创建自己的类。

# unix - 如何使用 sed 搜索行并替换行尾的字符串

> ID：14338010
> 
> 赞同：-1
> 
> 时间：2013-01-15T12:43:01.850
> 
> 标签：unix, sed, grep

我的要求是在文件中搜索应该有模式的行并在行尾`@$SQL_DIR`添加字符串。`$IDSS_LA_SCHEMA`谁能帮我.. ？？

问候， 拉杰什

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T12:45:28.930

使用 awk，`awk '/PATTERN/ {print $0, "STRING"}' /path/to/your/file`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T12:45:35.987

也许是这样的：

```
sed '/@\$SQL_DIR/ s/$/\$IDSS_LA_SCHEMA/' 
```

我试图做的是包含您指定的字符串的匹配行，并且对于其中的每一个，用第二个字符串替换结尾。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T12:47:54.093

```
> cat temp
ngkerng
egerger
erger
ghethe @$SQL_DIRand
jgnv
erger
> 
```

见下文：

```
> perl -pi -e 'if(/\@\$SQL_DIRand/){$_=~s/$/\$IDSS_LA_SCHEMA/;}' temp
>cat temp
ngkerng
egerger
erger
ghethe @$SQL_DIRand$IDSS_LA_SCHEMA
jgnv
erger
> 
```

***注意：这将执行就地附加。***

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T12:45:17.760

```
$ cat myfile.txt
some line
some other line, with @$SQL_DIR in it
$ sed -i 's/^\(.*@$SQL_DIR.*\)/\1$IDSS_LA_SCHEMA/' myfile.txt
$ cat myfile.txt
some line
some other line, with @$SQL_DIR in it$IDSS_LA_SCHEMA 
```

# c# - 如何在 asp.net c# 中创建下拉按钮？

> ID：14338015
> 
> 赞同：0
> 
> 时间：2013-01-15T12:43:22.533
> 
> 标签：c#, asp.net

有谁知道它看起来像按钮的属性的名称，但是一旦我们将鼠标指针放在它上面，它就会显示为下拉列表选项。我想在我的 asp.net 项目中使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T12:59:38.237

没有开箱即用的控件。这是使用 javascript 或 CSS 实现的效果

看看这个例子 [http://demos.9lessons.info/DropMenu/MyDemo.html](http://demos.9lessons.info/DropMenu/MyDemo.html)

您还应该为此搜索 jquery 插件。虽然你会得到现成的代码，但它肯定不会是服务器端控件。您可以选择创建用户控件或直接使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T12:47:03.737

不幸的是，asp.net 中没有这种开箱即用的控件。您可能想查看第三方控件或做一些 css 魔术。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T12:49:52.130

类似的东西可能是标准的（1）。但是如果你已经在使用它，我可以推荐你使用 Telerik 这里是一个例子（2）

[示例 2](http://msdn.microsoft.com/en-us/library/windows/desktop/dd940494%28v=vs.85%29.aspx)

[示例 2](http://demos.telerik.com/aspnet-ajax/ribbonbar/examples/items/defaultcs.aspx)

# single-sign-on - 使用 Jasper Server 4.7.0 配置 CAS 时出现问题

> ID：14338017
> 
> 赞同：4
> 
> 时间：2013-01-15T12:43:37.577
> 
> 标签：single-sign-on, cas, jasperserver

我在使用 Jasper Server 4.7.0 配置 CAS 时遇到问题。我已阅读 Authentication Cookbook 4.0 和以下网址：-

[CAS 集成](http://community.jaspersoft.com/wiki/integrating-cas-jasperreports-server)

请在下面找到相同的堆栈跟踪：-

```
java.lang.NullPointerException
    at com.jaspersoft.jasperserver.api.metadata.common.service.impl.hibernate.HibernateRepositoryServiceImpl.getResourcesCount(HibernateRepositoryServiceImpl.java:2192)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy13.getResourcesCount(Unknown Source)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at com.jaspersoft.ji.adhoc.service.EasyXMLizer.invoke(EasyXMLizer.java:44)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at com.jaspersoft.jasperserver.api.metadata.user.service.impl.PermissionsPrefetcher.invoke(PermissionsPrefetcher.java:78)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.security.intercept.method.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:66)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at com.jaspersoft.jasperserver.api.metadata.user.service.impl.PermissionsPrefetcher.invoke(PermissionsPrefetcher.java:78)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.security.intercept.method.aopalliance.MethodSecurityInterceptor.invoke(MethodSecurityInterceptor.java:66)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy17.getResourcesCount(Unknown Source)
    at com.jaspersoft.jasperserver.multipleTenancy.PathTransformationRepositoryService.getResourcesCount(PathTransformationRepositoryService.java:599)
    at com.jaspersoft.ji.adhoc.export.impl.AdhocUpgradeExecutorImpl.upgrade(AdhocUpgradeExecutorImpl.java:124)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:318)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy60.upgrade(Unknown Source)
    at com.jaspersoft.ji.adhoc.export.listeners.AdhocUpgradeListener.onApplicationEvent(AdhocUpgradeListener.java:25)
    at com.jaspersoft.ji.adhoc.export.listeners.AdhocUpgradeListener.onApplicationEvent(AdhocUpgradeListener.java:15)
    at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:97)
    at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:324)
    at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:929)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:467)
    at org.springframework.web.context.ContextLoader.configureAndRefreshWebApplicationContext(ContextLoader.java:384)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:283)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:111)
    at org.apache.catalina.core.StandardContext.listenerStart(StandardContext.java:4350)
    at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:4816)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:140)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:810)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:788)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:558)
    at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1051)
    at org.apache.catalina.startup.HostConfig.deployDirectories(HostConfig.java:977)
    at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:507)
    at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1322)
    at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:307)
    at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
    at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:89)
    at org.apache.catalina.util.LifecycleBase.setState(LifecycleBase.java:325)
    at org.apache.catalina.util.LifecycleBase.setState(LifecycleBase.java:305)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1036)
    at org.apache.catalina.core.StandardHost.startInternal(StandardHost.java:773)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:140)
    at org.apache.catalina.core.ContainerBase.startInternal(ContainerBase.java:1028)
    at org.apache.catalina.core.StandardEngine.startInternal(StandardEngine.java:278)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:140)
    at org.apache.catalina.core.StandardService.startInternal(StandardService.java:429)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:140)
    at org.apache.catalina.core.StandardServer.startInternal(StandardServer.java:662)
    at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:140)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:592)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:290) 
```

请在这方面提供帮助。

提前致谢。

# javascript - 带有链接区域的可拖动图像

> ID：14338018
> 
> 赞同：0
> 
> 时间：2013-01-15T12:43:48.117
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-draggable

我知道我可以通过使用使图像可拖动`$('#id').draggable();`
但是如果图像包含一些链接区域，则这些区域不能用于拖动。有没有办法告诉 jQuery 在单击（应打开该区域的定义 url）和拖动（只需移动整个图像）之间有所不同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:39:42.167

我找到了实现目标的方法。
图像和区域的代码必须放在 div 内：

```
<div id="overlayDiv">
    <img id="overlayImage" src="/Content/images/Overlay.png" usemap="#overlayMap" />
    <map name="overlayMap" id="overlayMap">
        [some areas]
    </map>
</div> 
```

然后你可以使 div 可拖动：

```
var stopPropagation = false;
$('body').mouseup(function () { stopPropagation = false; });
$('#overlayDiv').draggable({
    stop: function () {
        stopPropagation = true;
    }
}); 
```

因为我的区域没有定义 url 而只有 onclick-events，所以我可以检查 stopPropagation 变量并决定是否忽略点击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:01:45.710

似乎有一个选项可以防止#id 中的元素可拖动：[http ://api.jqueryui.com/draggable/#option-cancel](http://api.jqueryui.com/draggable/#option-cancel)

将此应用于您的链接元素，它们将是可点击的。

```
$("#id" ).draggable({ cancel: "a" }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T14:29:54.093

我认为这是不可能的，而且从你的 UI 角度来看也是不可取的。您无法判断用户已单击链接以“打开它”或“拖动它”。

因此，尝试更改链接上单击事件的默认行为会使用户感到困惑，这对用户体验不利。

# tomcat7 - 使用 Tomcat 进行负载平衡

> ID：14338021
> 
> 赞同：1
> 
> 时间：2013-01-15T12:43:54.237
> 
> 标签：tomcat7, load-balancing

这听起来可能是一个基本问题......但我对负载平衡的概念很陌生，几乎没有问题。

场景 - 我有 3 台 Tomcat 7 服务器，我想对其进行负载平衡。我读了几篇文章，发现使用 Apache HTTP Server 可以做到这一点。存在一个 worker.properties 文件，需要使用您想要负载平衡的服务器进行定义。现在的问题是，这需要在我启动 Apache HTTP 服务器之前完成。问题 - 如果我想在不重新启动 Apache HTTP 服务器的情况下动态添加更多 Tomcat 服务器怎么办。这可能吗 ？

问候阿贾克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:09:58.437

我发现了一篇关于 Tomcat 和 PAAS 的有趣文章：http: [//www.devx.com/Java/Article/48086](http://www.devx.com/Java/Article/48086)

您可能会在文章中找到您需要的内容。它描述了在集群中注册/注销新节点的机制。

HIH

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T12:36:06.707

Apache HTTPD 2.4 支持负载均衡器的动态重新配置。但是为此使用负载平衡器代理模块，而不是 mod_jk。

# extjs - 分页工具栏不显示自定义搜索结果

> ID：14338025
> 
> 赞同：2
> 
> 时间：2013-01-15T12:44:11.337
> 
> 标签：extjs, extjs4

我正在使用 ExtJs 的 pagingtoolbar，但是它不能正常工作。我有一个列出所有记录的网格，没问题，但是当我想分页自定义搜索结果时，它只会正确显示第一页，当我单击显示第二页时，它会返回原始 url（显示所有记录），但我希望商店网址仍然具有搜索网址。

原始网址：'historico-ocorrencia'

搜索网址：'historico-ocorrencia/search'

当我单击一个按钮时，会触发以下代码：

```
formSearch.submit({
                    url: 'historico-ocorrencia/search',
                    method: 'get',
                    params: {
                        dataInicial: time,
                        dataFinal: timeFinal
                    },
                    success: function(form, action) {
                        store.removeAll();
                        store.add(action.result.historicoOcorrencias);
                    },
                }); 
```

但是当我点击分页工具栏显示第二页时，上面的代码没有被触发，因为我没有点击按钮搜索。我想要一种使用 url 'historico-ocorrencia/search' 显示以下所有页面并仍然传递参数的方法。

谢谢，如果你有任何问题，请问我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T18:40:09.210

您应该将表单从提交按钮更改为常规按钮，并在该按钮的处理程序中执行以下操作：

```
handler: function (){
    store.getProxy().url = 'historico-ocorrencia/search';
    store.getProxy().extraParams.dataInicial = time;
    store.getProxy().extraParams.dataFinal = timeFinal;
    (a reference to your paging toolbar).doRefresh();
} 
```

您当前的事情不起作用的原因是因为您的商店总是为每个页面向服务器请求返回，而您没有做任何事情来更改它请求数据的方式，所以它只会以与它相同的方式执行请求一直。

# javascript - jQuery动画图像：左右翻转/旋转效果

> ID：14338026
> 
> 赞同：1
> 
> 时间：2013-01-15T12:44:17.727
> 
> 标签：javascript, jquery, html, css

我正在寻找适应这个非常简单有效的 jQuery 脚本： [jQuery to animate image from left to right?](https://stackoverflow.com/questions/7957962/jquery-to-animate-image-from-left-to-right) （感谢 DonamiteIsTnt）...

我想知道如何扩展它，以便您可以有效地使用带有“切换”动画的两个图像。例如，一只鸟飞到屏幕的右侧-翻转动画-小鸟出现飞回左侧-翻转动画-再次向右飞行。

“开关”动画我在想一些类似于 2D 图像的东西，它有效地自我转动（就像一条金鱼在碗里来回游动，以及它从玻璃前面向我们展示的样子）。

我不知道在这种情况下您是否会使用单个图像并将其从 30px 宽缩小到 0px 然后 -30px 等以另一种方式面对它。或者需要在右向图像和左向图像之间切换。无论哪种方式，让它动画化都会很酷。

我在这个网站上发现了类似的问题，指的是左右效果和翻转效果，但没有结合起来。所以任何帮助将不胜感激！

附带说明：我已链接到[http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js)

编辑：已经到了这一步......

```
 <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript">

    $(document).ready(function() {

function beeRight() {
    $("#b").animate({left: "+=300"}, 5000, "swing", beeLeft);
    $("#img").attr("src","rightArrow.gif");
}
function beeLeft() {
    $("#b").animate({left: "-=300"}, 5000, "swing", beeRight);
    $("#img").attr("src","leftArrow.gif");
}
beeRight();
    });
    </script>
    </head>

    <body>
<div id="b" style="position:absolute;"><img id="img" src="rightArrow.gif"></div>
    </body> 
```

然后我将如何添加动画图像交换，例如：[http](http://davidwalsh.name/demo/css-flip.php) ://davidwalsh.name/demo/css-flip.php - 不用说，不需要那么复杂。我希望用img而不是div来做到这一点。我了解如何在 CSS 中完成这样的事情，但我不知道如何将它与 jQuery/Javascript 结合起来。

再次感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:10:48.630

根据您定位的浏览器，您可以完全在 CSS3 中实现效果。使用几个类来表示开始和结束状态以及一些[`translatex transforms`](http://www.developerdrive.com/2012/02/moving-web-page-elements-using-the-css3-translate-transform/)处理[`scalex transforms`](http://www.w3schools.com/css3/css3_2dtransforms.asp)翻转。然后将 CSS`transition`属性添加到动画中。然后你可以使用任何你喜欢的东西来触发类的变化`:hover`，jQuery 计时器，元素点击等等。

# jquery - qtip2 模态模式在 IE7 中不起作用

> ID：14338029
> 
> 赞同：0
> 
> 时间：2013-01-15T12:44:19.680
> 
> 标签：jquery, internet-explorer-7, qtip2

我正在使用 qtip2 一切都很好，但模式提示在 IE7 中不起作用：

```
$(document).ready(function () {
    $('a[rel="master-modal-tip"]').each(function () {
        $(this).qtip(
        {
            content: { text: $('#' + $(this).attr('ttid')), title: { text: '', button: true} },
            position: { my: 'center', at: 'center', target: $(window) },
            show: { event: 'click', modal: { on: true, blur: false} },
            hide: false,
            style: { classes: 'master-modal-tip' }
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:31:44.450

我的 JQuery 版本是 1.4，我更新到最新版本（1.8.3），模式问题现在在 IE7 中运行良好。

# .htaccess - 基础 mod_rewrite 规则导致 500 内部服务器错误

> ID：14338031
> 
> 赞同：0
> 
> 时间：2013-01-15T12:44:24.920
> 
> 标签：.htaccess, mod-rewrite

我有这个非常基本的重写规则，无论我尝试什么，都会导致错误 500。

```
RewriteEngine On
RewriteRule ^folder/(.*) /folder/index.php?Alias=$1 [L] 
```

我的 httpd.conf 文件有以下内容：（这对我来说似乎没问题）

```
<Directory "/var/www/html">
    Options -Indexes FollowSymLinks
    AllowOverride All
    Order allow,deny
    Allow from all
   <IfModule mod_suphp.c>
        suPHP_Engine On
        suPHP_UserGroup webapps webapps
    SetEnv PHP_INI_SCAN_DIR
   </IfModule>
</Directory> 
```

关于可能出现问题的任何建议？我还尝试`$`在我的重写规则末尾添加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:14:34.243

重写引擎将重复循环，直到 URI 停止更改，或者达到内部重定向限制，从而引发 500 错误。您的规则的目标 URI`/folder/index.php`将被扔回重写引擎，并且您的相同规则的正则表达式匹配它，`^folder/(.*)`. 所以你需要添加某种条件来防止循环。

```
RewriteEngine On
RewriteCond %{REQUEST_URI} !^/folder/index\.php
RewriteRule ^folder/(.*) /folder/index.php?Alias=$1 [L] 
```

这很简单，如果规则已经以`/folder/index\.php`. 你也可以试试：

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^folder/(.*) /folder/index.php?Alias=$1 [L] 
```

这对条件的限制要小一些。仅当请求的 URI 未映射到现有文件或目录时才应用该规则。这假定当您尝试访问时*没有*`/folder/blahblah`目录或文件，并且您希望通过 index.php 路由它。*`blahblah`*

# css - 使 Bootstrap 3.0 输入组显示内联

> ID：14338037
> 
> 赞同：0
> 
> 时间：2013-01-15T12:44:48.163
> 
> 标签：css, forms, twitter-bootstrap, input, twitter-bootstrap-3

如果 twitter bootsrap 3.0 显示在一个没有中断的情况下，我目前正在努力从元素中制作。当我使包装器浮动时会发生什么输入元素被切断。

[请看这个jsfiddle](http://jsfiddle.net/BTAaU/9/)

```
 <form id="commentform" method="post" action="http://devsite.localhost/wp-comments-post.php" name="commentform">
   <span class="comment-form-author"><label class="obscure" for="author">Name</label><span class="input-group span2"><input type="text" placeholder="Name *" aria-required="true" tabindex="1" size="30" value="" name="author" id="author" /></span></span> <span class="comment-form-email"><label class="obscure" for="author">Email</label><span class="input-group span3"><input type="text" placeholder="Email *" aria-required="true" tabindex="2" size="30" value="" name="email" id="email" /></span></span> <span class="comment-form-url"><label class="obscure" for="url">Website</label><span class="input-group span3"><input type="text" placeholder="Website" tabindex="3" size="30" value="" name="url" class="input-medium" id="url" /></span></span>
   <div class="comment-form-comment">
      <textarea placeholder="Comment" aria-required="true" tabindex="4" rows="8" cols="45" name="comment" id="comment">
      </textarea>
   </div>
   <!-- #form-section-comment .form-section -->
   <p class="form-submit"><input type="submit" value="Post Comment" id="submit" name="submit" /> <input type="hidden" id="comment_post_ID" value="14" name="comment_post_ID" /> <input type="hidden" value="0" id="comment_parent" name="comment_parent" /></p>
</form> 
```

css

```
@import url('http://my-hardware.net/bs/bootstrap.css');

/* hiding content but not from screen readers, used in comments form */
.obscure {
  position: absolute !important;
  clip: rect(1px 1px 1px 1px); /* IE6, IE7 */
  clip: rect(1px, 1px, 1px, 1px);
}

.comment-form-email{
  display: block;
  float: left;
} 
```

为了显示的目的，我只是将我的尝试添加到我想要排列的 3 个输入之一。

有谁知道如何使这项工作？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-28T02:10:42.140

我认为这应该工作......

```
<div class="controls-row">
    <div class="control-group col col-lg-2">
        <div class="input-group">
            <span class="input-group-addon">X</span>
            <input type="text">
        </div>
    </div>
    <div class="control-group col col-lg-2">
        <div class="input-group">
            <span class="input-group-addon">Y</span>
            <input type="text">
        </div>
    </div>
</div> 
```

# c# - Windows 窗体中 CRUD 的更新功能错误

> ID：14338039
> 
> 赞同：1
> 
> 时间：2013-01-15T12:44:51.130
> 
> 标签：c#, ms-access

我是编程新手，所以请尽可能提供帮助！最近，我的任务是使用 C# 和 MS 访问做一个 CRUD Windows 窗体应用程序。

在我的更新功能中，我面临以下错误之一，我不确定为什么..我的数据也无法更新。

错误：`ArgumentException`未处理

> 输入字符串的格式不正确。无法存储在 staff_id 列中。预期类型是 Int32。

这是我的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using AcuzioSapp.AcuzioSecureStore_DatabaseDataSetTableAdapters;

namespace AcuzioSapp
{
    public partial class Update_Client : Form
    {
        private DataRow row;
        private ClientTableAdapter adapter;
        public Update_Client(DataRow row, ClientTableAdapter adapter)
        {
            InitializeComponent();
            this.row = row;
            this.adapter = adapter;
            textBox_id1.Text = Convert.ToString(row["c_id"]);
            textBox_name1.Text = Convert.ToString(row["c_name"]);
            textBox_address1.Text = Convert.ToString(row["c_address"]);
            textBox_cinfo1.Text = Convert.ToString(row["c_contactinfo"]);
            textBox_pinfo1.Text = Convert.ToString(row["profile_info"]);
            textBox_refno1.Text = Convert.ToString(row["c_8digitrefno"]);
            textBox_staffid1.Text = Convert.ToString(row["staff_id"]);
        }

        private void button_close_Click(object sender, EventArgs e)
        {
            Close();
        }

        private void button_update_Click(object sender, EventArgs e)
        {
            row["c_name"] = "textBox_name1";
            row["c_address"] = "textBox_address1";
            row["c_contactinfo"] = "int.Parse(textBox_cinfo1)";
            row["c_8digitrefno"] = "(textBox_pinfo1)";
            row["profile_info"] = "textBox_refno1";
            row["staff_id"] = "int.Parse(textBox_staffid1)";

            adapter.Update(row);
        }
    }
} 
```

感谢您的帮助和解释谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T12:48:10.833

那是因为您的列在您的 Access 数据库中被声明为整数，并且您尝试在其中插入一个字符串值。而且我还认为您不会在指定的表中获得正确的值，因为您通过常量字符串更新列`(row["profile_info"] = "textBox_refno1";)`，这会将**textBox_refno1**插入`profile_info`列而不是 TextBox 值。尝试这个 ：

```
row["staff_id"] = Convert.ToInt32(textBox_staffid1.Text); 
```

**更新：** 复制并粘贴以下代码，您将永远不会遇到任何问题：

```
 private void button_update_Click(object sender, EventArgs e)
    {
        row["c_name"] = textBox_name1.Text;
        row["c_address"] = textBox_address1.Text;
        row["c_contactinfo"] = int.Parse(textBox_cinfo1.Text);
        row["c_8digitrefno"] = textBox_pinfo1.Text;
        row["profile_info"] = textBox_refno1.Text;
        row["staff_id"] = int.Parse(textBox_staffid1.Text);

        adapter.Update(row);

        MessageBox.Show("Data has been updated");
    } 
```

希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T12:50:14.060

```
 row["c_name"] = textBox_name1.Text;
        row["c_address"] = textBox_address1.Text;
        ...
        int val;
        if(int.TryParse(textBox_staffid1.Text, out val))
        {
             row["staff_id"] = val;
        } 
```

我认为，您的文本框中的文本格式不正确。

# iphone - 当应用程序处于后台模式时，是否可以在 iPhone 中闪烁手电筒？

> ID：14338040
> 
> 赞同：4
> 
> 时间：2013-01-15T12:44:53.250
> 
> 标签：iphone, ios, objective-c, ios4

当应用程序处于后台模式时，是否可以在 iPhone 中闪烁手电筒？请给一些合适的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-09-10T14:37:02.883

已经给出了与您的这个问题类似的答案，请立即查看此链接

[应用程序在后台时，iPhone手电筒不工作](https://stackoverflow.com/questions/32136442/iphone-flashlight-not-working-while-app-is-in-background)

**这是正常行为。** Apple 的沙盒不允许您在应用程序处于后台时保持闪光灯打开。除非我们谈论的是越狱应用程序，否则没有解决方法。

**编辑：** Apple 对其系统的 API 使用非常严格。尤其是涉及到： - 用户隐私 - 电池寿命 - 用户体验

在手电筒的情况下，最后两项是相关的。Apple 不会让应用程序在不在前台时耗尽电池电量，iOS 用户已经习惯了手电筒、相机、麦克风……在进入后台时会立即禁用（某些后台模式下的麦克风除外）例）。

为了回答您对最初帖子的评论，iOS 控制着您的硬件。因此，由于 Apple 决定在用户​​关闭应用程序时不希望灯一直亮着，因此 iOS 只会在您的应用程序进入后台时关闭闪光灯。您的应用无权阻止它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T17:18:40.467

我的应用程序是一个音频播放器，所以它一直在后台运行。但是手电筒只有在前景时才有效。背景没有手电筒。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:03:41.523

尝试 AVCaptureDevice

[AVCaptureDevice](http://developer.apple.com/library/IOS/#documentation/AVFoundation/Reference/AVCaptureDevice_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40009520-CH1-SW90)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T13:08:37.357

在后台时，您的应用程序无法运行或从系统获取任何消息。唯一允许这样做的情况是：

1.  导航应用
2.  音频播放器
3.  网络电话

除非您正在设计上述任何内容，否则您无法向用户展示任何内容。如果您只想通知用户某事，您可以创建一个通知程序，即使您的应用程序在后台或完全关闭，它也会在用户窗口中弹出一条消息。用户可以单击该消息，然后他将返回您的应用程序

# linux - grep 某些文件中的模式并在每个文件中打印总和

> ID：14338048
> 
> 赞同：1
> 
> 时间：2013-01-15T12:45:15.983
> 
> 标签：linux, grep

我想在某些文件中 grep 模式并用文件名计算出现次数。知道，如果我使用

```
grep -r "month" report* | wc -l 
```

它将汇总所有文件中的所有实例。所以输出是一个单一的值`324343`。我想要这样的东西

```
report1: 3433
report2: 24399
.... 
```

grep 命令将显示文件名，但会打印每个实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T12:48:30.060

`grep -c`将为您提供每个文件的匹配计数：

```
grep -rc "month" report* 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T12:50:57.390

您需要将每个文件传递给 grep: `echo report* | xargs grep -c month`。

如果递归，使用`find report* -exec grep month -Hc '{}' \;`.

# datetime - Matplotlib：光标捕捉到带有日期时间轴的绘图数据

> ID：14338051
> 
> 赞同：6
> 
> 时间：2013-01-15T12:45:18.023
> 
> 标签：datetime, matplotlib, mouse-cursor

我有 3 个数据集的图，这些数据集在 x 轴上有日期时间对象。我想要一个光标捕捉数据并显示精确的 x 和 y 值。

我已经有一个“对齐光标”，但这仅适用于标量 x 轴。任何人都可以帮我修改对齐光标，使其也适用于日期时间 x 轴吗？

这是我的数据图： ![在此处输入图像描述](../Images/69a1b617f2453840b2b7d2a40f8a4d93.png)

```
import numpy as np
import matplotlib.pyplot as plot
import matplotlib.ticker as mticker
import matplotlib.dates as dates
import datetime
import Helpers

fig = plot.figure(1)
DAU = (  2,  20,  25,  60, 190, 210,  18, 196, 212)
WAU = ( 50, 160, 412, 403, 308, 379, 345, 299, 258)
MAU = (760, 620, 487, 751, 612, 601, 546, 409, 457)

firstDay = datetime.datetime(2012,1,15)

#create an array with len(DAU) entries from given starting day
dayArray = [firstDay + datetime.timedelta(days = i) for i in xrange(len(DAU))]

line1 = plot.plot(dayArray, DAU, 'o-', color = '#336699')
line2 = plot.plot(dayArray, WAU, 'o-', color = '#993333')
line3 = plot.plot(dayArray, MAU, 'o-', color = '#89a54e')

ax = plot.subplot(111)
dateLocator   = mticker.MultipleLocator(2)
dateFormatter = dates.DateFormatter('%d.%m.%Y')
ax.xaxis.set_major_locator(dateLocator)
ax.xaxis.set_major_formatter(dateFormatter)
fig.autofmt_xdate(rotation = 90, ha = 'center')

yMax = max(np.max(DAU), np.max(WAU), np.max(MAU))
yLimit = 100 - (yMax % 100) + yMax
plot.yticks(np.arange(0, yLimit + 1, 100))

plot.title('Active users', weight = 'bold')
plot.grid(True, axis = 'both')
plot.subplots_adjust(bottom = 0.2)
plot.subplots_adjust(right = 0.82)

legend = plot.legend((line1[0], line2[0], line3[0]),
                 ('DAU',
                 'WAU',
                 'MAU'),
                 'upper left',
                 bbox_to_anchor = [1, 1],
                 shadow = True)

frame = legend.get_frame()
frame.set_facecolor('0.80')
for t in legend.get_texts():
    t.set_fontsize('small')

#THIS DOES NOT WORK
cursor = Helpers.SnaptoCursor(ax, dayArray, DAU, 'euro daily')
plot.connect('motion_notify_event', cursor.mouse_move)

plot.show() 
```

这是我的模块“Helper”，其中包含“SnaptoCursor”类：（我从其他地方获得了基本的 SnaptoCursor 类并对其进行了一些修改）

```
from __future__ import print_function
import numpy as np
import matplotlib.pyplot as plot

def minsec(sec, unused):
    """
    Returns a string of the input seconds formatted as mm'ss''.
    """
    minutes = sec // 60
    sec = sec - minutes * 60
    return '{0:02d}\'{1:02d}\'\''.format(int(minutes), int(sec))

class SnaptoCursor():
    """
    A cursor with crosshair snaps to the nearest x point.
    For simplicity, I'm assuming x is sorted.
    """
    def __init__(self, ax, x, y, formatting, z = None):
        """
        ax: plot axis
        x: plot spacing
        y: plot data
        formatting: string flag for desired formatting
        z: optional second plot data
        """
        self.ax = ax
        self.lx = ax.axhline(color = 'k')  #the horiz line
        self.ly = ax.axvline(color = 'k')  #the vert line
        self.x = x
        self.y = y
        self.z = z
        # text location in axes coords
        self.txt = ax.text(0.6, 0.9, '', transform = ax.transAxes)
        self.formatting = formatting

    def format(self, x, y):
        if self.formatting == 'minsec':
            return 'x={0:d}, y='.format(x) + minsec(y, 0)

        elif self.formatting == 'daily euro':
            return u'day {0:d}: {1:.2f}€'.format(x, y)

    def mouse_move(self, event):
        if not event.inaxes: return

        mouseX, mouseY = event.xdata, event.ydata

        #searchsorted: returns an index or indices that suggest where x should be inserted
        #so that the order of the list self.x would be preserved
        indx = np.searchsorted(self.x, [mouseX])[0]

        mouseX = self.x[indx]
        #if z wasn't defined
        if self.z == None:
            mouseY = self.y[indx]
        #if z was defined: compare the distance between mouse and the two plots y and z
        #and use the nearest one
        elif abs(mouseY - self.y[indx]) < abs(mouseY - self.z[indx]):
            mouseY = self.y[indx]
        else:
            mouseY = self.z[indx]

        #update the line positions
        self.lx.set_ydata(mouseY)
        self.ly.set_xdata(mouseX)

        self.txt.set_text(self.format(mouseX, mouseY))
        plot.draw() 
```

当然这不起作用，因为我使用日期时间数组“dayArray”调用 SnaptoCursor，稍后应该将其与鼠标坐标进行比较。而且这些数据类型没有可比性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T10:36:54.367

我知道了！！！

SnaptoCursor 类的**init**方法中这两行的问题：

```
self.lx = ax.axhline(color = 'k')  #the horiz line
self.ly = ax.axvline(color = 'k')  #the vert line 
```

他们以某种方式弄乱了日期时间 x 轴（例如，序数高达 730,000），因此您只需初始化线条的坐标：

```
self.lx = ax.axhline(y = min(y), color = 'k')  #the horiz line
self.ly = ax.axvline(x = min(x), color = 'k')  #the vert line 
```

然后它工作得很好！

现在我将发布我的完整 SnaptoCursor 类，因为我已经修改了它，因此它可以接受单独的格式字符串，并且它最多可以占用 3 个输入数据图 - 根据您的鼠标位置捕捉到。

```
def percent(x, unused):
    """
    Returns a string of the float number x formatted as %.
    """
    return '{0:1.2f}%'.format(x * 100)

def minsec(sec, unused):
    """
    Returns a string of the input seconds formatted as mm'ss''.
    """
    minutes = sec // 60
    sec = sec - minutes * 60
    return '{0:02d}\'{1:02d}\'\''.format(int(minutes), int(sec))

class SnaptoCursor():
    """
    A cursor with crosshair snaps to the nearest x point.
    For simplicity, I'm assuming x is sorted.
    """
    def __init__(self, ax, x, y, formatting, y2 = None, y3 = None):
        """
        ax: plot axis
        x: plot spacing
        y: plot data
        formatting: string flag for desired formatting
        y2: optional second plot data
        y3: optional third plot data
        """
        self.ax = ax
        self.lx = ax.axhline(y = min(y), color = 'k')  #the horiz line
        self.ly = ax.axvline(x = min(x), color = 'k')  #the vert line
        self.x = x
        self.y = y
        self.y2 = y2
        self.y3 = y3
        # text location in axes coords
        self.txt = ax.text(0.6, 0.9, '', transform = ax.transAxes)
        self.formatting = formatting

    def format(self, x, y):
        if self.formatting == 'minsec':
            return 'x={0:d}, y='.format(x) + minsec(y, 0)

        if self.formatting == 'decimal':
            return 'x={0:d}, y={1:d}'.format(x, int(y))

        elif self.formatting == 'date decimal':
            return 'x={0:%d.%m.%Y}, y={1:d}'.format(x, int(y))

        elif self.formatting == 'decimal percent':
            return 'x={0:d}, y={1:d}%'.format(x, int(y * 100))

        elif self.formatting == 'float':
            return 'x={0:d}, y={1:.2f}'.format(x, y)

        elif self.formatting == 'float percent':
            return 'x={0:d}, y='.format(x) + percent(y, 0)

        elif self.formatting == 'daily euro':
            return u'day {0:d}: {1:.2f}€'.format(x, y)

    def mouse_move(self, event):
        if not event.inaxes:
            return

        mouseX, mouseY = event.xdata, event.ydata
        if type(self.x[0]) == datetime.datetime:
            mouseX = dates.num2date(int(mouseX)).replace(tzinfo = None)

        #searchsorted: returns an index or indices that suggest where mouseX should be inserted
        #so that the order of the list self.x would be preserved
        indx = np.searchsorted(self.x, [mouseX])[0]

        #if indx is out of bounds
        if indx >= len(self.x):
            indx = len(self.x) - 1

        #if y2 wasn't defined
        if self.y2 == None:
            mouseY = self.y[indx]

        #if y2 was defined AND y3 wasn't defined
        elif self.y3 == None: 
            if abs(mouseY - self.y[indx]) < abs(mouseY - self.y2[indx]):
                mouseY = self.y[indx]
            else:
                mouseY = self.y2[indx]

        #if y2 AND y3 were defined
        elif abs(mouseY - self.y2[indx]) < abs(mouseY - self.y[indx]):
            if abs(mouseY - self.y2[indx]) < abs(mouseY - self.y3[indx]):
                mouseY = self.y2[indx]
            else:
                mouseY = self.y3[indx]
        #lastly, compare y with y3
        elif abs(mouseY - self.y[indx]) < abs(mouseY - self.y3[indx]):
            mouseY = self.y[indx]
        else:
            mouseY = self.y3[indx]

        #update the line positions
        self.lx.set_ydata(mouseY)
        self.ly.set_xdata(mouseX)

        self.txt.set_text(self.format(mouseX, mouseY))
        plot.draw() 
```

# java - 同时按下多个键后释放键时不触发KeyListener

> ID：14338052
> 
> 赞同：1
> 
> 时间：2013-01-15T12:45:21.740
> 
> 标签：java, swing, awt, keylistener

我正在编写一个使用关键侦听器的小型应用程序。当一个特定的键被按下时，定时器启动，当该键被释放时，定时器停止。

现在，这仅在一次按下一个键时才能完美运行。当我同时按下 3 个键时，所有三个计时器都启动得很好。我遇到的问题是一个接一个地释放键。我尝试使用 InputMap 和 ActionMap 但遇到了另一个问题。

```
 import java.awt.event.*; 
  import javax.swing.*;
  public class KeyTest extends JFrame implements KeyListener{
  private static final int UP_TIMER_DELAY = 200;
  // a timer for button "Z"
  private Timer upTimer;
  // a timer for button "X"
  private Timer upTimer2;

  public static void main(String[] args) 
  { 
     new KeyTest(); 
  }

  public KeyTest() 
  { 
     this.addKeyListener(this);
     this.setSize(800,600); this.setVisible(true); 
  }

  public void keyPressed(KeyEvent e) 
  {
  //When Z is pressed
     if(e.getKeyCode()==90)
     {
        if (upTimer != null && upTimer.isRunning()) {
           return;
        }
        System.out.println("Button_Z is pressed");

        upTimer = new Timer(UP_TIMER_DELAY, 
              new ActionListener() {

                 @Override
                    public void actionPerformed(ActionEvent e) {

                 }
              });       
        //Starting the timer for Button "Z" if pressed      
        upTimer.start();
     } 
     else {
        if (upTimer != null && upTimer.isRunning()) {
           upTimer.stop();
           upTimer = null;
        } 
     }
    //When X is pressed
     if(e.getKeyCode()==88)
     {
        if (upTimer2 != null && upTimer2.isRunning()) {
           return;
        }
        System.out.println("Button_X is pressed");

        upTimer2 = new Timer(UP_TIMER_DELAY, 
              new ActionListener() {

                 @Override
                    public void actionPerformed(ActionEvent e) {

                 }
              });           
        upTimer2.start();
     } 
     else {
        if (upTimer2 != null && upTimer2.isRunning()) {
           upTimer2.stop();
           upTimer2 = null;
        }
     }
  }

  public void keyReleased(KeyEvent e) 
  {
  //When Z is released
     if(e.getKeyCode()==90)
     {

        if (upTimer != null && upTimer.isRunning()) {
           upTimer.stop();
           upTimer = null;
           System.out.println("Button_Z is released");
        }   
     }

     //When X is realeased
     else if(e.getKeyCode()==88)
     {

        if (upTimer2 != null && upTimer2.isRunning()) {
           upTimer2.stop();
           upTimer2 = null;
           System.out.println("Button_X is released");
        }  
     }
  }

  public void keyTyped(KeyEvent e) 
  { 
  // Do stuff. 
  } 
  } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:45:39.610

当您自己按下另一个键时，您取消计时器。

```
java.awt.event.KeyEvent[KEY_PRESSED,keyCode=90
Button_Z is pressed
Canceling Button_X timer
java.awt.event.KeyEvent[KEY_PRESSED,keyCode=90
java.awt.event.KeyEvent[KEY_PRESSED,keyCode=90
java.awt.event.KeyEvent[KEY_PRESSED,keyCode=88
Canceling Button_Z timer
Button_X is pressed
java.awt.event.KeyEvent[KEY_RELEASED,keyCode=88
Button_X is released
java.awt.event.KeyEvent[KEY_RELEASED,keyCode=90 // but timer already canceled 
```

# java - 简单的正则表达式来匹配包含的字符串 字符

> ID：14338056
> 
> 赞同：6
> 
> 时间：2013-01-15T12:45:34.257
> 
> 标签：java, regex

我正在编写这个正则表达式，因为我需要一种方法来查找没有 n 点的字符串，但我认为负面展望将是最好的选择，到目前为止我的正则表达式是：

```
"^(?!\\.{3})$" 
```

我读这篇文章的方式是，在字符串的开头和结尾之间，可能有或多或少的 3 个点，但不是 3 个。令我惊讶的是，这与`hello.here.im.greetings` 我期望匹配的不匹配。我正在用 Java 编写，所以它具有类似 Perl 的味道，我没有转义花括号，因为它在 Java 中不需要任何建议？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T12:47:05.463

你在正确的轨道上：

```
"^(?!(?:[^.]*\\.){3}[^.]*$)" 
```

将按预期工作。

你的正则表达式意味着

```
^          # Match the start of the string
(?!\\.{3}) # Make sure that there aren't three dots at the current position
$          # Match the end of the string 
```

所以它只能匹配空字符串。

我的正则表达式意味着：

```
^       # Match the start of the string
(?!     # Make sure it's impossible to match...
 (?:    # the following:
  [^.]* # any number of characters except dots
  \\.   # followed by a dot
 ){3}   # exactly three times.
 [^.]*  # Now match only non-dot characters
 $      # until the end of the string.
)       # End of lookahead 
```

按如下方式使用它：

```
Pattern regex = Pattern.compile("^(?!(?:[^.]*\\.){3}[^.]*$)");
Matcher regexMatcher = regex.matcher(subjectString);
foundMatch = regexMatcher.find(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T12:49:31.837

~~您的正则表达式仅匹配“不”三个连续的点。您的示例似乎表明您希望在句子中的任何位置“不”匹配 3 个点。~~

尝试这个：`^(?!(?:.*\\.){3})`

~~演示+说明：[http ://regex101.com/r/bS0qW1](http://regex101.com/r/bS0qW1)~~

请查看 Tims 的答案。

# php - 为什么用单引号括起来的字符串不会插入它在 PHP 中包含的变量名，而用双引号会插入？

> ID：14338059
> 
> 赞同：0
> 
> 时间：2013-01-15T12:45:46.673
> 
> 标签：php

> **可能重复：**
> [php中单引号和双引号字符串的区别](http://stackoverflow.com/questions/3446216/difference-between-single-quote-and-double-quote-string-in-php)

如果我们用双引号而不是单引号将字符串括起来，我们可以在文本字符串中包含变量的名称并在其位置插入值。

为什么它在单引号的情况下不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T12:47:50.130

这正是单引号和双引号之间的预期区别，当解释器可能需要替换某些内容时使用双引号，单引号告诉 php 字符串将保持原样..

# php - 将数据从一个 cli 应用程序传递到另一个应用程序的最佳方法是什么

> ID：14338066
> 
> 赞同：0
> 
> 时间：2013-01-15T12:46:25.517
> 
> 标签：php, ruby, shell, command-line, command-line-interface

例如，如何将数据从一个 cli 应用程序（例如 Ruby 脚本）传递到 PHP 脚本。我的意思是原始数据、文本、二进制文件等。由于使用临时文件的原始数据，参数也很糟糕。我知道的最后一件事是标准输入，标准输出。也许有人知道更好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T12:53:44.427

取决于这些程序的执行方式（相对于彼此）。如果一个停止并启动另一个，stdin/out 甚至转储文件可能会起作用（尽管它可能被认为是蹩脚的，但它确实可以完成工作！），如果有很多数据，您甚至可以考虑创建一个小型数据库SQLite 之类的数据库中的表。这也取决于数据之间传递的数据的易失性要求。

如果存在父/子进程关系，因此父进程启动子进程，您可能会考虑管道/fifo，或共享内存或消息队列或任何其他形式的 IPC。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T14:56:52.570

你在什么操作系统上？这决定了您可以使用什么。您应该使用平台常用的内容。在 *nix 系统上，我们使用管道 ( `|`)、套接字和数据文件，具体取决于应用程序。

确实没有一种方法可以做到这一点，它只取决于应用程序的类型和数据的类型。

如果您要移动文本列或 CSV 数据，您可以使用管道或文本文件。

如果您在 Ruby 应用程序之间移动哈希和对象，请使用 JSON 或“Marshall”数据和管道、套接字或文件。

如果您在语言之间移动数据，请使用 JSON、XML 或 YAML 以及这些数据路径之一。

我们经常将 JSON 用于我们的应用程序间数据格式，并编写代码以允许它在设置命令行标志时发出 JSON。这使我们能够轻松地用一个小的 REST 服务包装命令行应用程序并远程调用它们，将它们的结果发布到网络上。

话虽如此，并没有一个硬性规定来说明如何完成任何事情，只要与您的代码保持一致并遵循您正在使用的应用程序的风格即可。

# jenkins - Guice 注入测试在 Jenkins 上失败

> ID：14338069
> 
> 赞同：0
> 
> 时间：2013-01-15T12:46:30.633
> 
> 标签：jenkins, playframework-2.0, guice, sbt, jenkins-plugins

我的 Play 2.0.4 Java 项目有一个奇怪的问题。我能够使用“play clean test”或“sbt clean test”在本地成功运行所有测试。但是，当使用 sbt-launch.jar 或“sbt clean test”在 Jenkins 服务器上构建项目时，测试会失败，因为没有发生注入。其他不依赖于注入的测试可以通过。

Jenkins 和本地都运行相同版本的 sbt 并且都使用 Oracle Java。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:43:04.457

很奇怪，看起来詹金斯的工作和工作区不知何故损坏了。重新创建作业解决了这个问题。

# postgresql-9.2 - 与数据库“dbname”的连接失败：致命：用户“postgres”的密码验证失败

> ID：14338075
> 
> 赞同：1
> 
> 时间：2013-01-15T12:46:42.157
> 
> 标签：postgresql-9.2

我创建了 postgres db，导入备份，现在我想从 postgres db 进行新备份。这是我用过的命令：

```
createdb -U user dbname

psql -U user -f "C:\Program Files\PostgreSQL\9.2\bin\import\import.backup" dbname

pg_dump -U user -f "C:\Program Files\PostgreSQL\9.2\bin\backups\bobd.backup" dbname 
```

在最后一个命令之后我得到

```
pg_dump: [archiver (db)] connection to database "dbname" failed: FATAL:  password
authentication failed for user "postgres" 
```

如何解决？我使用相同的密码来导入数据库和进行备份，为什么第一种情况可以，第二种情况不行？

修改文件 pg_hba.conf 后（在受信任的情况下更改 md5）我得到错误

```
pg_dump: [archiver] could not open output file "C:\Program Files\PostgreSQL\9.2\ bin\backups\bobd.backup": Permission denied 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:39:53.810

通过以管理员身份打开命令提示符解决了该问题。开始——所有程序——附件——右键命令提示符——以管理员身份运行

# toggle - 已弃用的 jQuery Toggle 事件的等价物

> ID：14338078
> 
> 赞同：28
> 
> 时间：2013-01-15T12:46:47.427
> 
> 标签：toggle, jquery

jQuery 的[Toggle Event](http://api.jquery.com/toggle-event/)功能已作为 1.9 版的一部分[被删除。](https://github.com/jquery/jquery-migrate/blob/master/warnings.md#jqmigrate-jqueryfntogglehandler-handler-is-deprecated)

我像这样使用这个功能：

```
$('#example').toggle(function() {
    do stuff
}, function() {
    do stuff
}); 
```

现在 Toggle Event 消失了，重现此功能的最佳方式是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-15T12:48:19.867

加载 MIGRATE 并查看那里的代码

看到我的帖子关于同样的事情

[fn.toggle(handler(eventObject), handler(eventObject)...) 去哪儿了？](https://stackoverflow.com/questions/14301935/where-has-fn-toggle-handlereventobject-handlereventobject-gone)

我建议他们将其重命名为**fn.toggler**而不是删除它

这是代码 - 它是一个独立的 jQuery 插件，可以按原样使用。

```
jQuery.fn.toggle = function( fn, fn2 ) {
  // Don't mess with animation or css toggles
  if ( !jQuery.isFunction( fn ) || !jQuery.isFunction( fn2 ) ) {
    return oldToggle.apply( this, arguments );
  }
  // migrateWarn("jQuery.fn.toggle(handler, handler...) is deprecated");
  // Save reference to arguments for access in closure
  var args = arguments,
  guid = fn.guid || jQuery.guid++,
  i = 0,
  toggler = function( event ) {
    // Figure out which function to execute
    var lastToggle = ( jQuery._data( this, "lastToggle" + fn.guid ) || 0 ) % i;
    jQuery._data( this, "lastToggle" + fn.guid, lastToggle + 1 );
    // Make sure that clicks stop
    event.preventDefault();
    // and execute the function
    return args[ lastToggle ].apply( this, arguments ) || false;
  };
  // link all the functions, so any of them can unbind this click handler
  toggler.guid = guid;
  while ( i < args.length ) {
    args[ i++ ].guid = guid;
  }
  return this.click( toggler );
}; 
```

更短的，未经测试的版本：

```
(function( $ ){
  $.fn.toggler = function( fn, fn2 ) {
    var args = arguments,guid = fn.guid || $.guid++,i=0,
    toggler = function( event ) {
      var lastToggle = ( $._data( this, "lastToggle" + fn.guid ) || 0 ) % i;
      $._data( this, "lastToggle" + fn.guid, lastToggle + 1 );
      event.preventDefault();
      return args[ lastToggle ].apply( this, arguments ) || false;
    };
    toggler.guid = guid;
    while ( i < args.length ) {
      args[ i++ ].guid = guid;
    }
    return this.click( toggler );
  };
})( jQuery ); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-23T11:10:01.953

这也很有效。

```
$.fn.toggleClick = function(){

    var functions = arguments ;

    return this.click(function(){
            var iteration = $(this).data('iteration') || 0;
            functions[iteration].apply(this, arguments);
            iteration = (iteration + 1) % functions.length ;
            $(this).data('iteration', iteration);
    });
}; 
```

# php - php excel设置错误的单元格值

> ID：14338082
> 
> 赞同：0
> 
> 时间：2013-01-15T12:47:31.630
> 
> 标签：php, phpexcel

当我像这样设置单元格值时

```
->setCellValue('O' . $currentRow, 12000000000000111702) 
```

或者

```
->setCellValue('O' . $currentRow, "12000000000000111702") 
```

它正在生成值 1.2E+19 即 12000000000000000000 谁能告诉我原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:03:33.293

如果您需要将此值完全“按原样”保留而不是转换为浮点数（因为它对于 PHP int 来说太大了），那么您需要使用显式将该值设置为字符串

```
->setCellValueExplicit('O' . $currentRow, "12000000000000111702", PHPExcel_Cell_DataType::TYPE_STRING) 
```

您实际上不需要指定 PHPExcel_Cell_DataType::TYPE_STRING 因为 setCellValueExplicit() 无论如何都默认为该值。

# android - 在带有边框的 textView 内创建自定义 UI 组件按钮

> ID：14338084
> 
> 赞同：1
> 
> 时间：2013-01-15T12:47:38.867
> 
> 标签：android, button, coding-style, custom-controls

我创建了一个自定义按钮：

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true">
        <shape>
            <gradient android:startColor="#5a803f"
                android:endColor="#446c1a" android:angle="90" />
            <stroke android:width="5dp" android:color="#3d5e1d" />
            <corners android:radius="3dp" />
            <padding android:left="8dp" android:top="8dp"
                android:right="8dp" android:bottom="8dp" />
        </shape>
    </item>
    <item android:state_focused="true">
        <shape>
            <gradient android:startColor="#5a803f"
                android:endColor="#446c1a" android:angle="90" />
            <stroke android:width="5dp" android:color="#3d5e1d" />
            <corners android:radius="3dp" />
            <padding android:left="8dp" android:top="8dp"
                android:right="8dp" android:bottom="8dp" />
        </shape>
    </item>
    <item>

    </item>

</selector> 
```

但是我需要将此按钮放置在具有定义边距的黑色背景上，并在顶部和底部带有白色边框。而且这个背景不应该是可点击的。像这样的东西：

![在此处输入图像描述](../Images/013b04761daa4f5aed72894fe09bf081.png)

我该如何实施？借助此选择器或样式使用。请帮助提供代码示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:00:26.277

您可以使用选择器来实现它

```
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:drawable="@drawable/icon_button_disabled" android:state_enabled="false"/>
    <item android:drawable="@drawable/icon_button_pressed" android:state_pressed="true"/>
    <item android:drawable="@drawable/icon_button_focused" android:state_focused="true"/>
    <item android:drawable="@drawable/icon_button_normal"/>
</selector> 
```

按钮布局

```
 <?xml version="1.0" encoding="utf-8"?>
    <Button android:id="@+id/textAndIconBtn"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Text in the button"
        android:background="@drawable/button"
        android:drawableLeft="@drawable/star_icon"
        android:drawablePadding="5dip"
        android:textColor="#ffffffff"/> 
```

有关更多信息，您可以尝试[此链接](http://www.devahead.com/blog/2011/08/creating-a-custom-android-button-with-a-resizable-skin/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T10:08:04.933

我使用 TableLayout 解决了这个问题。在这种情况下，我的 TextView 看起来像：

```
 <TableRow
    android:id="@+id/tableRow3"
    style="@style/button_row"
    >
    <Button

        android:id="@+id/btnProceed"
        style="@style/custom_button"
        android:layout_centerHorizontal="true"
        android:text="Log In"
         />
    </TableRow> 
```

等所有 UI 元素。

# database - Drupal 7 - db_insert 返回错误

> ID：14338086
> 
> 赞同：1
> 
> 时间：2013-01-15T12:47:44.337
> 
> 标签：database, drupal, drupal-7

**我在Drupal 7**中尝试了一个简单的插入查询，但它总是返回错误。我也尝试了**db_insert**、**drupal_write_record**和**db_query**，但是每个函数都会返回各种错误。

我有一个**tabledrag_menu**表：

![在此处输入图像描述](../Images/ae22f09d72da54e6feac72ebc78bad55.png)

我有一个**$adat**数组：

```
Array
(
    [name] => Overview
    [weight] => 0
    [group] => left
    [checked] => 0
    [tid] => 96
    [nid] => 20
) 
```

使用 var_dump 它看起来像这样：

```
array(6) { ["name"]=>   string(8) "Overview"   ["weight"]=>   int(0)   ["group"]=>   string(4) "left"   ["checked"]=>   int(0)   ["tid"]=>   int(96)   ["nid"]=>   int(20) } 
```

我的代码，它给出了错误：

```
$id = db_insert('tabledrag_menu')->fields($adat)->execute(); 
```

当我使用**db_insert**时，它会返回以下错误消息：

> PDOException: SQLSTATE[42000]: 语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 'group, checked, tid, nid) 附近使用正确的语法 VALUES ('Overview', '0', 'left', '0', '96', '20 ')' 在第 1 行：INSERT INTO {tabledrag_menu} (name, weight, group, checked, tid, nid) VALUES (:db_insert_placeholder_0, :db_insert_placeholder_1, :db_insert_placeholder_2, :db_insert_placeholder_3, :db_insert_placeholder_4, :db_insert_placeholder_5); 数组（ [:db_insert_placeholder_0] => 概述 [:db_insert_placeholder_1] => 0 [:db_insert_placeholder_2] => 左 [:db_insert_placeholder_3] => 0 [:db_insert_placeholder_4] => 96 [:db_insert_placeholder_5] => 20）

我认为，这部分会导致错误，但我不知道如何解决它：

> 值（“概述”、“0”、“左”、“0”、“96”、“20”）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T13:44:40.430

Group 是 MySql 的保留字。尝试为该字段使用其他名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T12:53:25.570

尝试从整数列中的值中删除单引号。

例如改变这个

```
VALUES ('Overview', '0', 'left', '0', '96', '20') 
```

是这样的：

```
VALUES ('Overview', 0, 'left', 0, 96, 20) 
```

# android - 使用 RemoteView 设置位图不起作用

> ID：14338091
> 
> 赞同：3
> 
> 时间：2013-01-15T12:47:54.827
> 
> 标签：android, android-widget

我正在编写一个小部件，我需要下载并在布局上设置一个位图。我尝试过的一切似乎都不起作用。

我现在创建了一个测试位图来设置视图，[更新]这工作。

```
 Bitmap.Config config = Bitmap.Config.ARGB_8888;
  Bitmap bitmap = Bitmap.createBitmap(imageActiveWidth, imageHeight, config); 
  Canvas canvas =  new Canvas(bitmap); // Load the Bitmap to the Canvas
  Paint paint = new Paint();
  paint.setColor(0xFFFFCCFF);
  canvas.drawRect(0, 0, imageActiveWidth, imageHeight, paint); 
  views.setImageViewBitmap(resId, bitmap); 
```

使用资源文件确实有效：

```
 Bitmap placeholderBitmap = BitmapFactory.decodeResource(context.getResources(), R.drawable.placeholder_medium);
  views.setImageViewBitmap(imageSlotId, placeholderBitmap); 
```

但是，使用下载的位图似乎不起作用。（异步任务下载位图后，我有一个方法 setBitmap 是一行：

```
 views.setImageViewBitmap(resId, proxy); 
```

结果 - 屏幕只是白色，没有位图

我真的不知道如何让它工作，因为我需要能够下载位图并设置它们。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T14:41:30.813

找到了解决方案。我认为它与这个错误有关： [http ://code.google.com/p/android/issues/detail?id=8489](http://code.google.com/p/android/issues/detail?id=8489)

通过 setBitmap 方法更改为以下解决：

```
private void setBitmap(RemoteViews views, int resId, Bitmap bitmap){
    Bitmap proxy = Bitmap.createBitmap(bitmap.getWidth(), bitmap.getHeight(), Bitmap.Config.ARGB_8888);
    Canvas c = new Canvas(proxy);
    c.drawBitmap(bitmap, new Matrix(), null);
    views.setImageViewBitmap(resId, proxy);
} 
```

我需要打电话： `AppWidgetManager.getInstance(context).updateAppWidget(appWidgetId, views);`
**在设置位图之后。**

出于某种原因，当我回到它时，这不起作用。我的视图是一个 AdapterViewFlipper，所以我使用了上述方法并调用了`widgetManager.notifyAppWidgetViewDataChanged(appWidgetId, R.id.content);`导致位图呈现的调用。

# excel - 仅在主列表中也找到值时才粘贴值的宏

> ID：14338092
> 
> 赞同：1
> 
> 时间：2013-01-15T12:48:01.927
> 
> 标签：excel, vba

我有几列日期，我将它们提炼成一个主列表，其中包含每个列表共有的所有日期。因此，必须在所有其他列中找到此列表中的任何值。

我有多个数据表，跨多个工作表（其中一列中有日期，相邻列中有值），日期列是从这些工作表中的每个数据表提供的，因此这些工作表可能包含未找到的日期在主列表中。

我想将主列表中包含的所有日期及其对应值复制并粘贴到每个工作表上的相邻列中。

示例（全部列在单独的工作表上，在 F13:GX 范围内）（使用列表 1、列表 2、列表 3 等的工作表名称）。工作簿中的所有工作表都将包含一个列表，除了一个称为“封面”的列表）。清单 1

```
22/12/2012 1
23/12/2012 2
24/12/2012 3 
27/12/2012 4
28/12/2012 5 
```

清单 2

```
22/12/2012 2
23/12/2012 10
24/12/2012 11
28/12/2012 15 
```

清单 3

```
22/12/2012 2
23/12/2012 17
28/12/2012 22
29/12/2012 33 
```

我希望它复制并粘贴日期和值

```
22/12/2012 
23/12/2012 
28/12/2012 
```

对于每个列表，并将它们粘贴到范围 H13:I15

所以我会得到所需的输出。

清单 1

```
22/12/2012 1 22/12/2012 1
23/12/2012 2 23/12/2012 2
24/12/2012 3 28/12/2012 5 
27/12/2012 4
28/12/2012 5 
```

清单 2

```
22/12/2012 2  22/12/2012 2
23/12/2012 10 23/12/2012 10
24/12/2012 11 28/12/2012 15
28/12/2012 15 
```

清单 3

```
22/12/2012 2  22/12/2012 2
23/12/2012 17 23/12/2012 17
28/12/2012 22 28/12/2012 22
29/12/2012 33 
```

跳过值时不会有空格。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T05:29:37.180

最简单的解决方案是使用公式而不是宏。

对于给出的示例，在每个“列表”表的 H3 中输入此公式：

`=IFERROR(INDEX(MasterList,ROW()-ROW(F$13)+1),"")`

I3中的这个：

`=IF(H13="","",INDEX(G:G,MATCH(H13,F:F,0)))`

根据需要复制/填写公式。

`MasterList`是一个命名范围，指的是日期的主列表。一个动态示例，假设主列表从名为“Master”的工作表的单元格 A1 开始（列中没有其他内容），将是：

`=Master!$A$1:INDEX(Master!A:A,COUNTA(Master!A:A))`

如果愿意，您可以将其直接插入到上面的第一个公式中。

**注意：**我使上面的第二个公式尽可能简单。因此，如果 F1:F12 范围内有任何日期（或数字等价物）与主列表匹配，它将中断。

如果您*真的*想要/需要一个宏解决方案，那么以下“相当简单”的解决方案应该可以解决问题：

```
Public Sub PasteMasterDates()

  Dim fn As WorksheetFunction: Set fn = Application.WorksheetFunction

  Dim wkstWorkSheet As Worksheet
  Dim varMasterArray As Variant
  Dim varDatesArray As Variant
  Dim varValuesArray As Variant
  Dim lngMasterUBound As Long
  Dim lngMasterIndex As Long
  Dim lngMatchIndex As Long
  Dim varNumberFormat As Variant

  With Worksheets("Master")
    With Range(.Range("A1:B1"), .Range("A1").End(xlDown))
      varNumberFormat = .Cells(1).NumberFormat
      varMasterArray = fn.Transpose(fn.Transpose(.Cells))
      lngMasterUBound = UBound(varMasterArray, 1)
    End With
  End With
  For Each wkstWorkSheet In Application.Worksheets
    With wkstWorkSheet
      If .Name Like "List *" Then
        With Range(.Range("F13"), .Range("F13").End(xlDown))
          varDatesArray = fn.Transpose(.Cells)
          varValuesArray = fn.Transpose(.Cells.Offset(ColumnOffset:=1))
          For lngMasterIndex = 1 To lngMasterUBound
            lngMatchIndex = fn.Match(varMasterArray(lngMasterIndex, 1), varDatesArray, 0)
            varMasterArray(lngMasterIndex, 2) = varValuesArray(lngMatchIndex)
          Next lngMasterIndex
          With .Cells.Offset(ColumnOffset:=2).Resize(RowSize:=lngMasterUBound)
            .NumberFormat = varNumberFormat
            .Resize(ColumnSize:=2) = varMasterArray
          End With
        End With
      End If
    End With
  Next wkstWorkSheet

End Sub 
```

**要点：**

1.  根据上面的公式解决方案，假定主列表位于名为“Master”的工作表中。
2.  虽然现在即使在 F1:F12 范围内有与主列表匹配的日期/数字，这仍然有效，但如果在 F13 上方或左侧插入行，*它将中断。*在你修复宏之前，就是这样。
3.  自动允许在“列表”表中添加/插入日期，或添加更多这些表。
4.  粘贴值的日期格式从主列表中的第一个日期复制而来。
5.  出于速度原因，工作表数据被加载到 VBA 数组中。在将结果写回工作表之前，所有计算都在这些数组上完成。

**注意：**由于我假设您已经在运行一个宏来生成主列表（如果不是不可能的话，仅通过公式这样做会很困难），您可以在使用之前修改我的宏以构建主列表，就像您目前所做的那样。
或者，您可以构建和使用它，而无需实际将其保存到工作表中。我建议将所有“列表”工作表数据加载到数组数组中，同时使用字典构建主列表。然后再次循环数组数组，这次使用主列表生成结果。

**编辑：**

此版本的宏允许主列表中的日期不在其他每个列表中。

```
Public Sub PasteMasterDates2()

  Const cMasterSheetName As String = "Master"
  Const cMasterStart As String = "A1"
  Const cLikeListSheetName As String = "List *"
  Const cListStart As String = "F13"

  Dim fn As WorksheetFunction: Set fn = Application.WorksheetFunction

  Dim wkstWorkSheet As Worksheet
  Dim varMasterArray As Variant
  Dim varDatesArray As Variant
  Dim varValuesArray As Variant
  Dim avarPasteDatesArray() As Double
  Dim avarPasteValuesArray() As Double
  Dim lngMasterUBound As Long
  Dim lngListUBound As Long
  Dim lngPasteUBound As Long
  Dim lngMasterIndex As Long
  Dim lngMatchIndex As Long
  Dim varNumberFormat As Variant

  With Worksheets(cMasterSheetName)
    With Range(.Range(cMasterStart), .Range(cMasterStart).End(xlDown))
      varNumberFormat = .Cells(1).NumberFormat
      varMasterArray = fn.Transpose(.Cells)
      lngMasterUBound = UBound(varMasterArray)
    End With
  End With
  For Each wkstWorkSheet In Application.Worksheets
    With wkstWorkSheet
      If .Name Like cLikeListSheetName Then
        With Range(.Range(cListStart), .Range(cListStart).End(xlDown))
          varDatesArray = fn.Transpose(.Cells)
          varValuesArray = fn.Transpose(.Cells.Offset(ColumnOffset:=1))
          lngListUBound = UBound(varDatesArray, 1)
          ReDim avarPasteDatesArray(1 To lngListUBound)
          ReDim avarPasteValuesArray(1 To lngListUBound)
          lngPasteUBound = 0
          For lngMasterIndex = 1 To lngMasterUBound
            lngMatchIndex = 0
            On Error Resume Next
            lngMatchIndex = fn.Match(varMasterArray(lngMasterIndex), varDatesArray, 0)
            On Error GoTo 0
            If lngMatchIndex _
            Then
              lngPasteUBound = lngPasteUBound + 1
              avarPasteDatesArray(lngPasteUBound) = varDatesArray(lngMatchIndex)
              avarPasteValuesArray(lngPasteUBound) = varValuesArray(lngMatchIndex)
            End If
          Next lngMasterIndex
          If lngPasteUBound _
          Then
            ReDim Preserve avarPasteDatesArray(1 To lngPasteUBound)
            ReDim Preserve avarPasteValuesArray(1 To lngPasteUBound)
            With .Cells.Offset(ColumnOffset:=2).Resize(RowSize:=lngPasteUBound)
              .NumberFormat = varNumberFormat
              .Cells = fn.Transpose(avarPasteDatesArray)
              .Offset(ColumnOffset:=1) = fn.Transpose(avarPasteValuesArray)
            End With
          End If
        End With
      End If
    End With
  Next wkstWorkSheet

End Sub 
```

# java - 如何正确中断 JAX-RS AJAX 请求

> ID：14338097
> 
> 赞同：7
> 
> 时间：2013-01-15T12:48:11.060
> 
> 标签：java, ajax, rest, jboss, jax-rs

我有一个 Java EE 应用程序部署到 JBoss 7.1.1.Final。该应用程序利用 JAX-RS 向客户端提供 REST 服务。其中一项服务保持客户端连接，直到通过`BlockingQueue`. 到目前为止，这似乎工作正常。但是，即使删除了应用程序部署/应用程序关闭，连接也会保持打开状态。它甚至可以防止 JBoss 关闭。

所以我试图通过`@PreDestroy`回调中断等待线程来执行干净关闭。该服务如下所示：

```
@Path("/mypath")
@SessionScoped
public class MyResource implements Serializable {
  private static final long serialVersionUID = 1L;

  @Inject
  private EntityManager em;

  private Thread thread = null;

  @GET
  @Path("/{id:[0-9][0-9]*}")
  @Produces({
    MediaType.TEXT_PLAIN,
    MediaType.TEXT_XML
  })
  public Response getObjects(@PathParam("id") long id) {
    MyGroup group = this.em.find(MyGroup.class, id);
    if (group == null) {
      return Response.status(Status.NOT_FOUND)
          .entity("Group not found\n")
          .build();
    }

    if (group.isEmpty()) {
      return Response.status(Status.PRECONDITION_FAILED)
          .entity("Group is empty\n")
          .build();
    }

    BlockingQueue<?> queue = ... // Get queue for group

    this.thread = Thread.currentThread();
    try {
      MyObject object = queue.take();
    } catch (InterruptedException e) {
      return Response.noContent().build();
    }

    return Response.ok(object)
        .type(MediaType.TEXT_XML)
        .build();
  }

  @PreDestroy
  public void shutdown() {
    if (this.thread != null) {
      this.thread.interrupt();
    }
  }
} 
```

它似乎工作，有点......客户端收到预期的响应。但是，JBoss 会打印此异常：

```
13:38:44,489 ERROR [org.jboss.as.txn] JBAS010151: Unable to get transaction state: java.lang.IllegalStateException
    at org.jboss.msc.value.InjectedValue.getValue(InjectedValue.java:47)
    at org.jboss.as.txn.deployment.TransactionRollbackSetupAction.teardown(TransactionRollbackSetupAction.java:43)
    at org.jboss.as.web.ThreadSetupBindingListener.unbind(ThreadSetupBindingListener.java:61) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:195) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]
    at java.lang.Thread.run(Thread.java:636) [rt.jar:1.6.0_18]

13:38:44,492 ERROR [org.apache.catalina.connector.CoyoteAdapter] An exception or error occurred in the container during the request processing: java.lang.RuntimeException: java.lang.IllegalStateException
    at org.jboss.as.web.ThreadSetupBindingListener.unbind(ThreadSetupBindingListener.java:67) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:195) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]
    at java.lang.Thread.run(Thread.java:636) [rt.jar:1.6.0_18]
Caused by: java.lang.IllegalStateException
    at org.jboss.msc.value.InjectedValue.getValue(InjectedValue.java:47)
    at org.jboss.as.connector.deployers.processors.CachedConnectionManagerSetupProcessor$CachedConnectionManagerSetupAction.teardown(CachedConnectionManagerSetupProcessor.java:83)
    at org.jboss.as.web.ThreadSetupBindingListener.unbind(ThreadSetupBindingListener.java:61) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    ... 8 more 
```

那感觉不对。中断这种等待请求的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-02T15:37:09.027

您正在中断由容器创建的线程，因此容器无法完成线程本身。您可以使用状态变量来检查线程是否应该结束，而不是中断，例如（将其解释为伪代码）：

```
while( ! stopped ) {
    MyObject object = queue.poll(25, TimeUnit.MILLISECONDS);

    return Response.ok(object)
        .type(MediaType.TEXT_XML)
        .build();
}

return Response.noContent().build(); 
```

并设置停止`true`在`@PreDestroy`. 还有[AsyncResponse](http://docs.oracle.com/javaee/7/api/javax/ws/rs/container/AsyncResponse.html)功能。您可以将所有打开的请求存储在列表中，然后在`@PreDestroy`.

# r - 按时间间隔将数据集转换为一行

> ID：14338100
> 
> 赞同：0
> 
> 时间：2013-01-15T12:48:22.837
> 
> 标签：r, format

*例子*

以下是个人的一些数据`id = 1`：

```
id time status
--------------
1  t    status 
```

`t`是某个事件发生的时间，并且`status`是`1`事件是否发生或未`0`发生（在这种情况下`t`是研究的持续时间）。

说介于和`t`之间。`a2``a3`

我的目标是将我的数据转换为以下内容：

```
id period start stop status
---------------------------
1  1     0     a1   0      
1  2     a1    a2   0      
1  3     a2    t    status 
```

个人 1 的总时间分为三个区间，其中没有事件，`(0, a1)`并且`(a1, a2)`

*问题*

你能想出一种有效的方法来编写一个输入数据集和向量`a=(a1, a2, ..., aK)`并输出转换后的数据集的 R 函数吗？

* * *

**编辑**

**第 1 部分** 我被问到一个具体的例子。这是一个：

```
 id time status
    --------------
    1  5    1 
```

和`a1=1`, `a2=3`, `a3=7`.

**第 2 部分**我还被要求展示我的尝试。这里是

```
> data <- data.frame(id=1, time=5, status=1)
> a <- c(1, 3, 7)
> N <- nrow(data)
> data$period <- ifelse(data$time < a[1], 1,
+                       ifelse(data$time < a[2], 2,
+                              ifelse(data$time < a[3], 3, 4)))
> 
> 
> dataTemp1 <- data.frame(matrix(nrow=N, ncol=ncol(data)))
> names(dataTemp1) <- names(data)
> dataTemp2 <- data.frame(matrix(nrow=N, ncol=ncol(data)))
> names(dataTemp2) <- names(data)
> dataTemp3 <- data.frame(matrix(nrow=N, ncol=ncol(data)))
> names(dataTemp3) <- names(data)
> dataTemp4 <- data.frame(matrix(nrow=N, ncol=ncol(data)))
> names(dataTemp4) <- names(data)
> 
> for(j in 1:N)
+ {
+   if(data[j, "period"] == 1){
+     data[j, "start"] <- 0
+     data[j, "stop"] <- data[j, "time"]
+   } else if(data[j, "period"] == 2){
+     dataTemp1[j, c("id", "time", "period")] <-
+       data[j, c("id", "time", "period")]
+     dataTemp1[j, "start"] <- 0
+     dataTemp1[j, "stop"] <- a[1]
+     dataTemp1[j, "status"] <- 0
+     
+     data[j, "start"] <- a[1]
+     data[j, "stop"] <- data[j, "time"] 
+   } else if(data[j, "period"] == 3){
+     dataTemp1[j, c("id", "time", "period")] <-
+       data[j, c("id", "time", "period")]
+     dataTemp1[j, "start"] <- 0
+     dataTemp1[j, "stop"] <- a[1]
+     dataTemp1[j, "status"] <- 0
+     
+     dataTemp2[j, c("id", "time", "period")] <-
+       data[j, c("id", "time", "period")]
+     dataTemp2[j, "start"] <- a[1]
+     dataTemp2[j, "stop"] <- a[2]
+     dataTemp2[j, "status"] <- 0
+     
+     data[j, "start"] <- a[2]
+     data[j, "stop"] <- data[j, "time"]     
+   } else if(data[j, "period"] == 4){
+     dataTemp1[j, c("id", "time", "period")] <-
+       data[j, c("id", "time", "period")]
+     dataTemp1[j, "start"] <- 0
+     dataTemp1[j, "stop"] <- a[1]
+     dataTemp1[j, "status"] <- 0
+     
+     dataTemp2[j, c("id", "time", "period")] <-
+       data[j, c("id", "time", "period")]
+     dataTemp2[j, "start"] <- a[1]
+     dataTemp2[j, "stop"] <- a[2]
+     dataTemp2[j, "status"] <- 0
+     
+     dataTemp3[j, c("id", "time", "period")] <-
+       data[j, c("id",  "time", "period")]
+     dataTemp3[j, "start"] <- a[2]
+     dataTemp3[j, "stop"] <- a[3]
+     dataTemp3[j, "status"] <- 0
+     
+     data[j, "start"] <- a[3]
+     data[j, "stop"] <- data[j, "time"] 
+   }
+ }
> 
> dataTemp1 <- dataTemp1[complete.cases(dataTemp1), ]
> dataTemp2 <- dataTemp2[complete.cases(dataTemp2), ]
> dataTemp3 <- dataTemp3[complete.cases(dataTemp3), ]
> dataTemp4 <- dataTemp4[complete.cases(dataTemp4), ]
> 
> data <- rbind(data, dataTemp1, dataTemp2, dataTemp3, dataTemp4)
> data[, "period"] <- ifelse(data[, "start"] == 0, 1,
+                            ifelse(data[, "start"] == a[1], 2,
+                                   ifelse(data[, "start"] == a[2], 3,
+                                          ifelse(data[, "start"] == a[3], 4,
+                                                 5))))
> data <- data[order(data$id, data$start),
+              c("id", "period", "start", "stop", "status")]
> data
  id period start stop status
2  1      1     0    1      0
3  1      2     1    3      0
1  1      3     3    5      1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:44:08.517

我会把它写成一个适当的可重现的解决方案：

```
df <- data.frame( id=1, time=5, status=2)
a <- c(1, 3, 7)

res.fn <- function(df, a) {
    id <- rep(1, length(a))
    period <- 1:length(a)
    start <- c(0, a[1:(length(a)-1)])
    stop <- c(a[1:(length(a)-1)], df$time)
    status <- c(rep(0, length(a)-1), df$status)
    data.frame(id, period, start, stop, status)
}
> res.fn(df, a)

  id period start stop status
1  1      1     0    1      0
2  1      2     1    3      0
3  1      3     3    5      2 
```

# ruby-on-rails - Rails 最佳实践误报未使用的方法

> ID：14338102
> 
> 赞同：3
> 
> 时间：2013-01-15T12:48:24.780
> 
> 标签：ruby-on-rails, ruby, false-positive, rbp

我正在使用 Rails 最佳实践来验证我自己的代码。

```
./app/controllers/news_items_controller.rb:2 - remove unused methods (NewsItemsController#new)
./app/controllers/news_items_controller.rb:2 - remove unused methods (NewsItemsController#create)
./app/controllers/news_items_controller.rb:2 - remove unused methods (NewsItemsController#edit)
./app/controllers/news_items_controller.rb:2 - remove unused methods (NewsItemsController#update)
./app/controllers/news_items_controller.rb:2 - remove unused methods (NewsItemsController#destroy)
./app/controllers/pages_controller.rb:1 - remove unused methods (PagesController#new)
./app/controllers/pages_controller.rb:1 - remove unused methods (PagesController#create)
./app/controllers/pages_controller.rb:1 - remove unused methods (PagesController#edit)
./app/controllers/pages_controller.rb:1 - remove unused methods (PagesController#update)
./app/controllers/pages_controller.rb:1 - remove unused methods (PagesController#destroy)
./app/controllers/registrations_controller.rb:2 - remove unused methods (RegistrationsController#update)
./app/controllers/registrations_controller.rb:8 - remove unused methods (RegistrationsController#after_sign_up_path_for)
./app/controllers/registrations_controller.rb:1 - remove unused methods (RegistrationsController#new)
./app/controllers/registrations_controller.rb:1 - remove unused methods (RegistrationsController#create)
./app/controllers/registrations_controller.rb:1 - remove unused methods (RegistrationsController#edit)
./app/controllers/registrations_controller.rb:1 - remove unused methods (RegistrationsController#destroy)
./app/controllers/static_controller.rb:2 - remove unused methods (StaticController#new)
./app/controllers/static_controller.rb:2 - remove unused methods (StaticController#create)
./app/controllers/static_controller.rb:2 - remove unused methods (StaticController#edit)
./app/controllers/static_controller.rb:2 - remove unused methods (StaticController#update)
./app/controllers/static_controller.rb:2 - remove unused methods (StaticController#destroy) 
```

这里的动作大多是未使用的方法。唯一的问题是这些动作甚至没有定义......我尝试使用`remove_method`但没有成功。

例如， news_items_controller 只有`index`and`show`而路由只定义`index`and `show`。

我的班级定义如下：`NewsItemsController << StaticController << ApplicationController << ActionController::Base`

我的猜测是 ActionController::Base 正在定义它们，有趣的是它没有显示“ApplicationController”......

这是StaticController的内容

```
# encoding: utf-8                                                                                                                                                                                     
class StaticController < ApplicationController
end 
```

并且没有路线指向`StaticController`。

还有routes.rb

```
 ActiveAdmin.routes(self)

  scope "(:locale)", :locale => /ru|en/ do
    devise_for :users, :controllers => { :registrations => "registrations" }

    resources :news_items, only: [:show, :index]
    resources :pages, :only => [:show]

    root to: "home#index"
  end

  root to: "home#index" 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-09-08T13:55:21.600

Rails 最佳实践经常沉迷于显示误报。在这种情况下，我不会太相信 RBP 并继续在 rails_best_practices.yml 文件中完全排除这些操作。

例如 ：

```
RemoveUnusedMethodsInControllersCheck: { except_methods: ['YourController#search'] } 
```

# svn - SVN如何在服务器上存储分支？

> ID：14338105
> 
> 赞同：1
> 
> 时间：2013-01-15T12:48:33.047
> 
> 标签：svn, branch

我试图了解 Subversion 如何在服务器端存储分支代码。它是根据提交 ID 存储源差异还是在分支中复制源代码？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T12:52:37.620

[**SVN 图书 | Using Branches**](http://svnbook.red-bean.com/en/1.7/svn.branchmerge.using.html)告诉我们（检查“廉价副本”部分）：

> Subversion 的存储库有一个特殊的设计。当您复制一个目录时，您不必担心存储库会变得庞大——Subversion 实际上不会复制任何数据。相反，它 **会创建一个指向现有树的新目录条目。如果您是一位经验丰富的 Unix 用户，您会认识到这与硬链接背后的概念相同。**随着对复制目录下的文件和目录的进一步更改，Subversion 继续尽可能地使用这个硬链接概念。只有在需要区分不同版本的对象时，它才会复制数据。

您可能会发现 SVNBook 非常有帮助。

# php - 通过 https://defuse.ca/php-pbkdf2.htm 使用 pbkdf2 哈希算法对用户进行身份验证

> ID：14338107
> 
> 赞同：0
> 
> 时间：2013-01-15T12:48:38.117
> 
> 标签：php, hash, login, web, salt

在用户输入登录电子邮件和密码后，我目前正在使用 md5 对用户进行身份验证：

```
if($_POST['submit']=='Login')
{
    // Checking whether the Login form has been submitted

// Will hold our errors
$err = array();

if(!$_POST['email'] || !$_POST['main_password'])
    $err[] = 'All the fields must be filled in!';

if(!count($err))
{
    // Make this an integer.
    $_POST['rememberMe'] = (int)$_POST['rememberMe'];

    try {

        $sql = "SELECT id,email FROM ld_customers WHERE email = :cust_email AND password = :cust_password";
        $stmt = $iws_db->prepare($sql);

        $stmt->bindParam(':cust_email', $_POST['email'], PDO::PARAM_STR, 255);
        $stmt->bindParam(':cust_password', md5($_POST['main_password']) , PDO::PARAM_STR, 256);

        $stmt->execute();   
        $row = $stmt->fetch();

    if($row['email'])
    {

        // If everything is OK login and write the users data to the session.
        $_SESSION['email']=$row['email'];
        $_SESSION['id'] = $row['id'];
        $_SESSION['rememberMe'] = $_POST['rememberMe'];

        // Store some data in the session

        setcookie('iwsRemember',$_POST['rememberMe']);
    }

    else $err[]='Wrong email and/or password!';

    /*** close the database connection ***/
    $iws_db = null;
    }
    catch(PDOException $e)
    {
    echo $e->getMessage();
    }
}

if($err)
$_SESSION['msg']['login-err'] = implode('<br />',$err);
// Save the error messages in the session

header("Location: index.php");
    exit;
} 
```

但我现在想通过[https://defuse.ca/php-pbkdf2.htm使用](https://defuse.ca/php-pbkdf2.htm)**PBKDF2**进行身份验证。这是他们的代码片段：

```
 <?php

define("PBKDF2_HASH_ALGORITHM", "sha256");
define("PBKDF2_ITERATIONS", 10000);
define("PBKDF2_HASH_BYTES", 24);
define("PBKDF2_SALT_BYTES", 24);

define("HASH_SECTIONS", 4);
define("HASH_ALGORITHM_INDEX", 0);
define("HASH_ITERATION_INDEX", 1);
define("HASH_SALT_INDEX", 2);
define("HASH_PBKDF2_INDEX", 3);

function create_hash($password)
{
    // format: algorithm:iterations:salt:hash
    $salt = base64_encode(mcrypt_create_iv(PBKDF2_SALT_BYTES, MCRYPT_DEV_URANDOM));     
    return PBKDF2_HASH_ALGORITHM . ":" . PBKDF2_ITERATIONS . ":" .  $salt . ":" . 
        base64_encode(pbkdf2(
            PBKDF2_HASH_ALGORITHM,
            $password,
            $salt,
            PBKDF2_ITERATIONS,
            PBKDF2_HASH_BYTES,
            true
        ));
}

function validate_password($password, $good_hash)
{
    $params = explode(":", $good_hash);
    if(count($params) < HASH_SECTIONS)
       return false; 
    $pbkdf2 = base64_decode($params[HASH_PBKDF2_INDEX]);
    return slow_equals(
        $pbkdf2,
        pbkdf2(
            $params[HASH_ALGORITHM_INDEX],
            $password,
            $params[HASH_SALT_INDEX],
            (int)$params[HASH_ITERATION_INDEX],
            strlen($pbkdf2),
            true
        )
    );
}

function slow_equals($a, $b)
{
    $diff = strlen($a) ^ strlen($b);
    for($i = 0; $i < strlen($a) && $i < strlen($b); $i++)
    {
        $diff |= ord($a[$i]) ^ ord($b[$i]);
    }
    return $diff === 0; 
}

function pbkdf2($algorithm, $password, $salt, $count, $key_length, $raw_output = false)
{
    $algorithm = strtolower($algorithm);
    if(!in_array($algorithm, hash_algos(), true))
        die('PBKDF2 ERROR: Invalid hash algorithm.');
    if($count <= 0 || $key_length <= 0)
        die('PBKDF2 ERROR: Invalid parameters.');

    $hash_length = strlen(hash($algorithm, "", true));
    $block_count = ceil($key_length / $hash_length);

    $output = "";
    for($i = 1; $i <= $block_count; $i++) {
        // $i encoded as 4 bytes, big endian.
        $last = $salt . pack("N", $i);
        // first iteration
        $last = $xorsum = hash_hmac($algorithm, $last, $password, true);
        // perform the other $count - 1 iterations
        for ($j = 1; $j < $count; $j++) {
            $xorsum ^= ($last = hash_hmac($algorithm, $last, $password, true));
        }
        $output .= $xorsum;
    }

    if($raw_output)
        return substr($output, 0, $key_length);
    else
        return bin2hex(substr($output, 0, $key_length));
}
?> 
```

我尝试以这种方式实现这一点：

```
 if($_POST['submit']=='Login')
    {
        // Checking whether the Login form has been submitted

    // Will hold our errors
    $err = array();

    if(!$_POST['email'] || !$_POST['main_password'])
        $err[] = 'All the fields must be filled in!';

    if(!count($err))
    {
        // Make this an integer.
        $_POST['rememberMe'] = (int)$_POST['rememberMe'];

        try {

            $sql = "SELECT id,email FROM ld_customers WHERE email = :cust_email";
        $stmt = $iws_db->prepare($sql);

        /*** bind the paramaters ***/
        $stmt->bindParam(':cust_email', $_POST['email'], PDO::PARAM_STR, 255);

        $stmt->execute();

        $row = $stmt->fetch();

                    if(!validate_password($_POST['main_password'], $row['password']))
                    {
                     exit("Password error!");
                    }
                     else
                    {
                     if($row['email'])
             {
              // If everything is OK login and write the users data to the session.
        $_SESSION['email']=$row['email'];
        $_SESSION['id'] = $row['id'];
        $_SESSION['rememberMe'] = $_POST['rememberMe'];

        // Store some data in the session

        setcookie('iwsRemember',$_POST['rememberMe']);    

        }
                    else
                    {
                    $err[]='Wrong email and/or password!';
                    }
                   }

    /*** close the database connection ***/
    $iws_db = null;
    }
    catch(PDOException $e)
    {
    echo $e->getMessage();
    }
}

if($err)
$_SESSION['msg']['login-err'] = implode('<br />',$err);
// Save the error messages in the session

header("Location: index.php");
exit; 
```

我没有成功实施它，每次它退出时都说**密码错误！**我认为问题在于获取存储的加密密码并将其与用户输入的密码进行比较。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:17:22.013

我认为它应该是这样的：

```
 $sql = "SELECT id,email FROM ld_customers WHERE email = :cust_email";
    $stmt = $iws_db->prepare($sql);

    $stmt->bindParam(':cust_email', $_POST['email'], PDO::PARAM_STR, 255);

    $stmt->execute();   
    $row = $stmt->fetch();
if($row['email'])
{
  if(!validate_password($_POST['main_password'], $row['password']))
  {
     exit("Password error!");
  }
  else
  {
    echo'Logged in!';
  }
}
else
   echo"email doesn't exist"; 
```

您正在创建 MD5 哈希而不是使用库的函数。

# vba - Office Word：使用 VBA 为每个字母设置不同的颜色

> ID：14338111
> 
> 赞同：0
> 
> 时间：2013-01-15T12:48:45.370
> 
> 标签：vba

我有一个 doc(docx) 文件，我希望每个单词的每个字母都有不同的颜色。

字母 a (A) - 颜色红色字母 b (B) - 颜色蓝色等

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:18:53.027

我只是在此处添加它是为了完整性，或者如果您已经有一个现有的模块并且知道如何在没有宏窗口的情况下执行它）。另外，我假设此时只有一个文档在 word 中打开，如果处理多个文档，一个特定文档，则需要添加功能（只需修改“Set X =”行即可）.. .

```
Sub ColorizeLetter()
'
' ColorizeLetter Macro
'
'
Dim D As Range
Dim C As Characters
Dim X As Document

Set X = Word.Documents.Item(1)

For I = 1 To X.Words.Count
    Set D = X.Words.Item(I)
    For J = 1 To D.Characters.Count
       S$ = D.Characters.Item(J).Text
       Select Case S$
        Case "A"
            D.Characters.Item(J).Font.ColorIndex = wdRed
        Case "B"
            D.Characters.Item(J).Font.ColorIndex = wdBlue
       End Select

    Next
Next
End Sub 
```

只需在 Select Case 块中为其他字符添加您想要的颜色，您应该一切顺利......希望这会有所帮助。

# c# - 如何在本地模式下的报表查看器中以不同格式发送渲染报表，如 pdf、excel、word 和修改报表查看器的工具栏

> ID：14338114
> 
> 赞同：1
> 
> 时间：2013-01-15T12:48:47.620
> 
> 标签：c#, asp.net

我有一个与报告查看器控件版本 = 10.0.0.0 相关的问题，我在本地模式下的报告查看器上显示 SSRS 报告（.rdl）文件。我在报表查看器的查找控件中遇到以下问题，

1.  当我在呈现的报告中搜索任何文本并且如果找到文本但我的报告向上移动并单击查找下一个用户时，必须一次又一次地滚动。

2.  在我们单击查找下一个搜索文本的最后一次出现之后，显示的消息和查找控件的文本框将为空白，但我希望文本不应该为空白。我该怎么做。

我想知道我们在报表查看器的 Find Control 中有多少控制权。

# javascript - getJSON 在 IE 中不适用于 Youtube

> ID：14338130
> 
> 赞同：0
> 
> 时间：2013-01-15T12:49:33.533
> 
> 标签：javascript, ajax, json, youtube-api, getjson

在这个函数中，我使用 JSON 从 Youtube 检索数据。此功能在 Chrome 和 Mozilla 中有效。但它在 IE 中不起作用。

```
 function test(url){

      var youtube_id = url.replace(/^[^v]+v.(.{11}).*/,"$1");
     $.getJSON('http://gdata.youtube.com/feeds/api/videos/'+youtube_id+'?v=2&alt=json', function(data) {
      var title = data.entry.title.$t;
      var description = data.entry.media$group.media$description.$t;
      var thumbnail = data.entry.media$group.media$thumbnail[0].url;
       var imgdata = "<img src ='"+thumbnail+"' />";

    alert(title);
      });
      // alert(youtube_id);// Use these variables somewhere

  } 
```

你能帮助我吗 ？

提前谢谢！！！

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-15T15:07:12.450

这是因为 IE（直到 IE 10）不支持[跨域资源共享](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)。

当您使用 Firefox、Safari、Chrome、Opera 等发出请求时，浏览器首先`OPTIONS`向服务器发出请求，并在标头中查找`Access-Control-Allow-Origin`，向浏览器解释允许哪些外国站点向该域发出请求.

gdata API 的标头是：

```
HTTP/1.1 200 OK
X-GData-User-Country: US
Content-Type: application/json; charset=UTF-8
Access-Control-Allow-Origin: *
Expires: Tue, 15 Jan 2013 15:02:28 GMT
Date: Tue, 15 Jan 2013 15:02:28 GMT
Cache-Control: private, max-age=300, no-transform
Vary: *
GData-Version: 2.1
ETag: W/"C0EGQn47eCp7I2A9WhNbEks."
Last-Modified: Tue, 15 Jan 2013 14:53:43 GMT
Transfer-Encoding: chunked
X-Content-Type-Options: nosniff
X-Frame-Options: SAMEORIGIN
X-XSS-Protection: 1; mode=block
Server: GSE 
```

该`Access-Control-Allow-Origin: *`标头表示允许在此页面上调用任何外部页面（即，不是从与所访问的 API 相同的协议、主机和端口提供的页面）。

但是，IE 不能正确支持该标准。

但是，您可以使用 gdata API 支持的 JSONP 标准来规避这种情况。

更改您的`$.getJSON`调用以`?`在 URL 的末尾包含 a。这就是您向[jQuery 解释您想使用 JSONP](http://api.jquery.com/jquery.getJSON)进行调用的方式，这确实允许外部站点。

例如：

```
var youtube_id = url.replace(/^[^v]+v.(.{11}).*/,"$1");
     $.getJSON('http://gdata.youtube.com/feeds/api/videos/'+youtube_id+'?v=2&alt=json?', function(data) {
        var title = data.entry.title.$t;
        var description = data.entry.media$group.media$description.$t;
        var thumbnail = data.entry.media$group.media$thumbnail[0].url;
        var imgdata = "<img src ='"+thumbnail+"' />";
        alert(title);
      }); 
```

# kendo-ui - 单击复选框时禁用剑道日期选择器

> ID：14338132
> 
> 赞同：8
> 
> 时间：2013-01-15T12:49:46.260
> 
> 标签：kendo-ui, jquery-ui-datepicker

我在输入框中有两个剑道日期选择器和一个复选框，我想一直用当前日期显示剑道日期选择器。但仅当用户选中复选框时，它们才会启用/可选择/可编辑。

复选框

```
<input type="checkbox" id="RequredFilter" /> 
```

2 个剑道日期选择器。

```
<input type="text" id="DateFrom" />
<input type="text" id="DateTo" /> 
```

我尝试了各种方法，例如禁用文本框等，但日期选择器只是继续工作/显示..

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-01-15T13:46:31.830

启用/禁用 DatePicker 的特殊方法称为**enable** - 检查[此](http://demos.kendoui.com/web/datepicker/api.html)演示。

```
$('#RequredFilter').click(function(e){
    if($(this).is(':checked')){
        $('#DateFrom').data('kendoDatePicker').enable(true);
        $('#DateTo').data('kendoDatePicker').enable(true);
    }
    else{
        $('#DateFrom').data('kendoDatePicker').enable(false);
        $('#DateTo').data('kendoDatePicker').enable(false);
    }
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-03-04T20:27:06.857

这是一种略有不同的方法：

```
$(document).ready(function() {
    $("#RequredFilter").change(function() {
        $('#DateFrom').data('kendoDatePicker').enable(this.checked);
        $('#DateTo').data('kendoDatePicker').enable(this.checked);
    });
}); 
```

# c# - 中间的 C# 子字符串

> ID：14338134
> 
> 赞同：4
> 
> 时间：2013-01-15T12:49:48.073
> 
> 标签：c#, string, substring

我有以下数据：

```
D:\toto\food\Cloture_49000ert1_10_01_2013.pdf
D:\toto\food\Cloture_856589_12_01_2013.pdf
D:\toto\food\Cloture_66rr5254_10_12_2012.pdf 
```

如何提取日期部分？例如：

```
D:\toto\food\Cloture_49000ert1_10_01_2013.pdf --> 10_01_2013
D:\toto\food\Cloture_856589_12_01_2013.pdf --> 12_01_2013
D:\toto\food\Cloture_66rr5254_10_12_2012.pdf --> 10_12_2012 
```

我的想法是使用`LastIndexOf(".pdf")` 然后倒数 10 个字符。

如何使用子字符串或其他方法解决此问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T12:53:57.803

*[`Substring`](http://msdn.microsoft.com/en-us/library/hxthx5h6.aspx)*在这种情况下使用。

> 从此实例中检索子字符串。子字符串从指定的字符位置开始。

试试这样；

```
string s = "D:\\toto\\food\\Cloture_490001_10_01_2013.pdf";
string newstring = s.Substring(s.Length - 14, 10);
Console.WriteLine(newstring); 
```

这是一个*[`DEMO`](http://ideone.com/uWaGhs)*.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T12:52:24.563

你不需要找到索引`.pdf`

```
path.Substring(path.Length - 14, 10) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T12:54:32.933

我会用正则表达式来做到这一点。

```
^[\w:\\]+cloture_(\d+)_([\d_]+).pdf$ 
```

将匹配第二组中的日期。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-15T12:52:43.110

如果文件名始终采用该格式，您可以执行如下粗略的操作：

```
string filename = @"D:\toto\food\Cloture_490001_10_01_2013.pdf";

string date = filename.Substring(filename.Length - 14, 10); 
```

这将从 中得到一个子字符串`10_01_2013.pdf`，它有 14 个字符长，但只取第一个`10`字符，留下`10_01_2013`.

但是，如果文件名采用不同的格式并且日期可能出现在名称中的任何位置，您可能需要考虑使用正则表达式之类的东西来进行匹配`##_##_####`并将其提取出来。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T12:52:20.267

试试这个方法：

```
string dateString = textString.Substring(textString.Length-14, 10); 
```

也见这里：[只从字符串中提取最右边的 n 个字母](https://stackoverflow.com/questions/1722334/c-extract-only-right-most-n-letters-from-a-string)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T12:55:39.110

如果你想使用 LastIndexOf 那么

```
string str = @"D:\toto\food\Cloture_490001_10_01_2013.pdf";
string temp = str.Substring(str.LastIndexOf(".pdf") - 10, 10); 
```

你可以像这样解析它

```
DateTime dt;
if(DateTime.TryParseExact(temp, "MM_dd_yyyy", CultureInfo.InvariantCulture, DateTimeStyles.None, out dt))
{
    //valid 
}
else
{
    //invalid
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-15T12:57:25.283

我会同意你使用`LastIndexOf`“.pdf”的想法，然后倒数。或者使用该[`Path.GetFileNameWithoutExtension`](http://msdn.microsoft.com/en-us/library/system.io.path.getfilenamewithoutextension.aspx)方法只获取名称，然后取最后 10 个字符。

如果文件名的路径发生变化（可能会），这些方法都将继续工作，并且不依赖幻数（除了定义我们感兴趣的子字符串长度的那个）来找到正确的位置在字符串中。

# java-ee-6 - 容器关闭的 JCR 会话导致重复尝试关闭会话

> ID：14338140
> 
> 赞同：1
> 
> 时间：2013-01-15T12:50:00.603
> 
> 标签：java-ee-6, jackrabbit, jcr, jca, content-repository

在我的 EJB 中，我使用 JCR 会话来存储文件。然后我注销会话并引发 CDI 事件。观察 CDI 事件的 EJB 然后创建一个新的 JCR 会话，它希望在其中使用存储的文件。（注意：我必须添加延迟才能使其正常工作，因为由于某种原因，文件在存储后无法直接使用）。在使用该文件完成该方法后，我还注销了此会话。但是 15 分钟后，我收到异常“尝试在 session-a84d60ac-1c8f-4cad-bc5a-84102b12f8e5-385 已经关闭后关闭它。” 使用堆栈跟踪：

```
Stack trace of the duplicate attempt to close session-c7bc3b30-9a5f-4922-bf80-8f197c583370-389 
 at org.apache.jackrabbit.core.session.SessionState.close(SessionState.java:280) ~[jackrabbit-core-2.4.2.jar:na] 
 at org.apache.jackrabbit.core.SessionImpl.logout(SessionImpl.java:943) [jackrabbit-core-2.4.2.jar:na] 
 at org.apache.jackrabbit.core.XASessionImpl.logout(XASessionImpl.java:392) [jackrabbit-core-2.4.2.jar:na] 
 at org.apache.jackrabbit.jca.JCAManagedConnection.cleanup(JCAManagedConnection.java:169) [jackrabbit-jca-2.4.2.jar:na] 
 at ... 
```

1小时后：

```
Unclosed session detected. The session was opened here: java.lang.Exception: Stack Trace 
 at org.apache.jackrabbit.core.SessionImpl.<init>(SessionImpl.java:222) ~[jackrabbit-core-2.4.2.jar:na] 
 at org.apache.jackrabbit.core.SessionImpl.<init>(SessionImpl.java:239) ~[jackrabbit-core-2.4.2.jar:na] 
 at org.apache.jackrabbit.core.XASessionImpl.<init>(XASessionImpl.java:99) ~[jackrabbit-core-2.4.2.jar:na] 
 at ... 
```

我相信这是因为应用程序服务器（Glassfish v.3.1.2.2）试图关闭我已经关闭的会话。但是当我不关闭任何会话时，我也会收到一个异常，它说已达到池大小限制。我怎样才能避免我的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T08:12:32.017

看起来您在 XA 事务中使用 Jackrabbit。

我在使用 JBoss 时遇到了类似的问题，我通过使用与 EJB 不同的非 XA 数据源解决了这个问题。查看更多信息：http: [//jackrabbit.510166.n4.nabble.com/How-to-handle-XA-Transactions-td521875.html](http://jackrabbit.510166.n4.nabble.com/How-to-handle-XA-Transactions-td521875.html)

# javascript - Angularjs - Jquery 加载

> ID：14338142
> 
> 赞同：0
> 
> 时间：2013-01-15T12:50:04.750
> 
> 标签：javascript, jquery, angularjs, loading

我这里发生了一些奇怪的事情。

我得到以下指令：

```
app.directive('addscroller', function () {
        return function (scope, elm, attrs) {
                // jQuery Script triggern
                // AngularJS: jQuery(selector) = element. 
                    elm.ready(function () {
                        elm.nanoScroller({ alwaysVisible: true });     
                    })       
        }
    }); 
```

我将其添加到此代码中：

```
<div ng-show="datenschutz" class="alldealermodal">  
    <p ng-show="loading">Loading...</p>
    <div>  
        <h1 class="headline">DATENSCHUTZ</h1>
        <div class="closebtndiv"><a href="#" ng-click="datenschutz=false" class="closebutton">Close</a></div>
        <div class="clear"></div>
        <div class="nano" addscroller>  
        <div class="content"><p>BIG LONG TEXT</p></div> 
        </div>
     </div>
     <div class="fadeout"></div>
</div> 
```

点击这个链接，

```
<p><a href="#"  ng-click="datenschutz=!datenschutz" class="datenschutz">Datenschutz</a></p> 
```

它会打开覆盖层“datenschutz”，如上所示（ng-show="datenschutz"）。切换效果很好但是....

当我在页面显示后直接打开 div 时，我看到滚动条正在加载并且看起来很好。有用。
但是，如果我等待片刻，只需几秒钟，然后打开“datenschutz”-overlay，滚动条就不会加载，也根本不会加载。

对于第二个叠加层，我有类似的东西，这也发生了。

**编辑/更新：**
我发现问题在于，jQuery 无法将脚本应用于隐藏的元素。当我在 ng-repeat 中的 $last 元素（在 div 内部）加载之前快速打开 div 时，它可以工作，因为 div 是可见的。

有谁知道解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:56:03.137

解决方案 1（快速而肮脏）：
使用 AngularUI fpr “ui-toggle”指令。它将 ui-hide 或 ui-show 作为类切换到元素中。
后来使用了这个CSS：

```
.ui-show {opacity:1;visibility: visible;}
.ui-hide {opacity:0;visibility: hidden;} 
```

在 Chrome 24 和 Firefox 18 中为我工作。

如果有人有其他解决方案，请发布。我的解决方案可能不是最好的。

# mysql - 计算行数并仅获取表中的最后一行

> ID：14338146
> 
> 赞同：3
> 
> 时间：2013-01-15T12:50:21.070
> 
> 标签：mysql, sql, select

我有一个表`employeexam`，它的结构和数据是这样的：

```
--------------------------------------------------------
| id | course_id   | employee_id | degree | date
--------------------------------------------------------
| 1  |  1          | 3           | 8      | 2013-01-14
| 2  |  2          | 4           | 15     | 2013-01-14
| 3  |  2          | 4           | 17     | 2013-01-15
-------------------------------------------------------- 
```

期望的结果是：

```
---------------------------------------------------------------------------
| id | course_id   | employee_id | degree | date        | numOfTakingExams 
---------------------------------------------------------------------------
| 1  |  1          | 3           | 8      | 2013-01-14  | 1
| 3  |  2          | 4           | 17     | 2013-01-15  | 2
--------------------------------------------------------------------------- 
```

我的 MySQL 查询：

```
SELECT DISTINCT(employeexam.employee_id) as employeeid, 
                employeexam.*, 
                exam.numOfTakingExams 
     FROM employeexam
     JOIN (
            SELECT employee_id , COUNT(employee_id ) as numOfTakingExams 
            FROM employeexam  
            GROUP BY employee_id
          ) exam
     ON exam.employee_id  = employeexam.employee_id 
     ORDER BY employeexam.id DESC 
```

这可以正确输出`numOfTakingExams`值，但我不能只选择他最后一次参加考试的数据。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T12:57:01.310

```
SELECT  a.*, b.numOfTakingExams
FROM    employeeExam a
        INNER JOIN
        (
            SELECT  employee_id,
                    MAX(date) max_Date,
                    COUNT(*) numOfTakingExams 
            FROM    employeeExam
            GROUP BY course_ID, employee_id
        ) b ON  a.employee_id = b.employee_id AND
                a.date = b.max_Date 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/a390f/3)

`ID`如果设置为，您还可以通过最大值获取最新记录，`AUTO_INCREMENT`下面的查询产生与上面查询相同的结果，

```
SELECT  a.*, b.numOfTakingExams
FROM    employeeExam a
        INNER JOIN
        (
            SELECT  employee_id,
                    MAX(id) max_Date,
                    COUNT(*) numOfTakingExams 
            FROM    employeeExam
            GROUP BY course_ID, employee_id
        ) b ON  a.employee_id = b.employee_id AND
                a.id = b.max_Date 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/a390f/5)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:03:19.867

您是否尝试过加入自身？在第一个中，您选择包含“最后一次考试”的 ID，在第二个中，您加入您需要的东西。类似于以下内容：

```
select A.* FROM
employeexam A INNER JOIN (
    SELECT EMPLOYEE_ID, MAX(DATE)
    FROM EMPLOYEEXAM
    GROUP BY EMPLOYEE_ID
) B
ON A.EMPLOYEE_ID = B.EMPLOYEE_ID AND
A.DATE = B.DATE 
```

当然，假设每个 Employee_id 的日期是唯一的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T12:58:03.130

试试这个查询 -

```
SELECT
  t1.id, t1.course_id, t1.employee_id, t1.degree, t1.date, t2.numOfTakingExams
FROM
  mployeexam t1
  JOIN (
        SELECT employee_id, MAX(date) date, COUNT(*) numOfTakingExams
        FROM mployeexam
        GROUP BY employee_id
    ) t2
    ON t1.employee_id = t2.employee_id AND t1.date = t2.date 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T13:09:42.900

```
SELECT x.*
     , y.ttl
  FROM employeexam x 
  JOIN 
     ( SELECT course_id
            , employee_id
            , MAX(date) max_date
            , COUNT(*) ttl 
         FROM employeexam 
        GROUP 
           BY course_id
            ,employee_id
     ) y 
    ON y.course_id = x.course_id 
   AND y.employee_id = x.employee_id 
   AND y.max_date = x.date; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T13:01:47.640

```
SELECT  ee.*, num_exams
FROM    (
        SELECT  employee_id, COUNT(*) AS num_exams
        FROM    employeexam
        GROUP BY
                employee_id
        ) eed
JOIN    employeeexam ee
ON      ee.id =
        (
        SELECT  id
        FROM    employeeexam eei
        WHERE   eei.employee_id = eed.employee_id
        ORDER BY
                eei.employee_id DESC, eei.date DESC, eei.id DESC
        LIMIT 1
        ) 
```

这将正确处理在一个日期进行多次考试的情况。

# java - 有没有办法将数据附加到 Bukkit ItemStack？

> ID：14338147
> 
> 赞同：3
> 
> 时间：2013-01-15T12:50:21.553
> 
> 标签：java, module, minecraft, bukkit

好的，我正在尝试将数据附加到 Minecraft Bukkit ItemStack。我想要它，所以它掉落的实体也有它，但这是可选的。如果我不能直接执行此操作，是否有其他方法可以在该项目通过玩家及其库存槽时保留一段数据（java int，java string）？谢谢！

编辑：这是一个代码示例。

```
package path.to.the.package;

import org.bukkit.event.*;
import org.bukkit.event.PlayerInteractEvent;
import org.bukkit.plugin.java.JavaPlugin;

public ExamplePlugin extends JavaPlugin
{
  public List<ItemStack> stacks = new ArrayList<ItemStack>();
  public boolean onCommand(CommandSender sender, Command cmd, String label, String[] args)
  {
    if(cmd.getName().equalsIgnoreCase("tester123"))
    {
      ItemStack stack = new ItemStack(272, 0, (byte)0);
      Player p = (Player)sender;
      stacks.add(stack);
      p.getLocation().getWorld().dropItem(player.getLocation(), stack);
    }
    return true;
  }

  @EventHandler(priority = EventPriority.HIGHEST)
  public void onItemStackRightClick(PlayerInteractEvent e)
  {
    Player player = e.getPlayer();
    for(ItemStack item : items)
    {
      if(player.getItemInHand() == item)
      {
        //What I DO want is something like: if(item.getPluginData(this, "KEY") == "SPECIAL")
        //And I would have set it like: item.setPluginData(this, "KEY", "SPECIAL");
        player.sendMessage("You got one of our SPECIAL stone swords!!!!");
      }
    }
  }
} 
```

我启动了这个例子，但是当我用一把特殊的剑右键单击时它不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-21T02:01:22.310

我会使用 ItemStack.getItemMeta() 来设置知识值：

```
import java.util.ArrayList;
import java.util.List;

import org.bukkit.command.Command;
import org.bukkit.command.CommandSender;
import org.bukkit.entity.Player;
import org.bukkit.event.*;
import org.bukkit.event.player.PlayerInteractEvent;
import org.bukkit.inventory.ItemStack;
import org.bukkit.inventory.meta.ItemMeta;
import org.bukkit.plugin.java.JavaPlugin;

public class ExamplePlugin extends JavaPlugin
{
  public List<ItemStack> stacks = new ArrayList<ItemStack>();
  public boolean onCommand(CommandSender sender, Command cmd, String label, String[] args)
  {
    if(cmd.getName().equalsIgnoreCase("tester123"))
    {
      ItemStack stack = new ItemStack(272, 0, (byte)0);

      Player p = (Player)sender;
      stacks.add(stack);
      ItemMeta i = stack.getItemMeta();

      List<String> lore = new ArrayList<String>();
      lore.add("Special");
      i.setLore(lore);

      p.getLocation().getWorld().dropItem(((Player)sender).getLocation(), stack);
    }
    return true;
  }

  @EventHandler(priority = EventPriority.HIGHEST)
  public void onItemStackRightClick(PlayerInteractEvent e)
  {
    Player player = e.getPlayer();

      if(player.getItemInHand().getItemMeta().hasLore())
      {
          if (player.getItemInHand().getItemMeta().getLore().get(0).equals("Special"))
          {
              player.sendMessage("You got one of our SPECIAL stone swords!!!!");
          }
      }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:04:03.727

有[http://jd.bukkit.org/apidocs/org/bukkit/metadata/Metadatable.html](http://jd.bukkit.org/apidocs/org/bukkit/metadata/Metadatable.html)您可以在其中以键值方式存储数据。看起来它已经提供了一个存储/检索数据的接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-23T19:04:03.820

如果你想存储不可见的数据（而不是传说），只需使用`metadata`：

来自 Samer Alsayegh 的好文章 -> [http://sameralsayegh.com/how-to-use-metadata/](http://sameralsayegh.com/how-to-use-metadata/)

# sql - 选择然后更新这些记录，然后在存储过程中返回它们

> ID：14338148
> 
> 赞同：6
> 
> 时间：2013-01-15T12:50:21.610
> 
> 标签：sql, sql-server

我想做一个 SELECT 来获取 ID 列表，根据这些 ID 进行更新，然后返回这些记录。

我猜是这样的，我只是不知道语法：

```
 SELECT WebHookLogIDs = FROM WebHookLog 
                WHERE Processing=0
                    AND Processed=0
                        AND Paused=0
                            ORDER BY FailCount ASC, WebHookLogID DESC

    UPDATE WebHookLog
        SET Processing = 1
            WHERE WebHookLogID IN(WebHookLogIDs)

    SELECT * FROM WebHookLog 
            WHERE WebHookLogID IN(WebHookLogIDs) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T12:57:07.583

我认为将数据放在**Temp 表**中比在其中插入数据更好

因为最后你想返回那些记录，所以你需要使用临时表

```
DECLARE @Table1 TABLE (WebHookLogIDs INT)

Insert into @Table1(WebHookLogIDs )
SELECT WebHookLogIDs  FROM WebHookLog 
                WHERE Processing=0
                    AND Processed=0
                        AND Paused=0
                            ORDER BY FailCount ASC, WebHookLogID DESC

    UPDATE WebHookLog
        SET Processing = 1
            WHERE WebHookLogID IN( select WebHookLogIDs from @Table1)

    SELECT * FROM WebHookLog 
            WHERE WebHookLogID IN(select WebHookLogIDs from @Table1)
    DROP TABLE @Table1 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T12:53:46.867

您不能`UPDATE`使用`SELECT`相同的 SQL 语句。但是，您可以像这样选择 ID 而不是`UPDATE`：`JOIN`

```
UPDATE w1
SET w1.Processing = 1
FROM WebHookLog w1
INNER JOIN WebHookLog w2  ON w1.WebHookLogID = w2.WebHookLogID 
                         AND w2.Processing    = 0
                         AND w2.Processed     = 0
                         AND w2.Paused        = 0; 
```

稍后，您可以执行另一个`SELECT`子句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T12:52:56.727

像这样的东西？

```
更新 WebHookLog
设置处理 = 1
WHERE WebHookLogID IN ( SELECT WebHookLogIDs = FROM WebHookLog
                WHERE 处理=0
                    AND 已处理=0
                        和暂停=0)

从 WebHookLog 中选择 *
WHERE WebHookLogID IN(WebHookLogIDs)

```

# c# - 格式化 Excel 单元格（货币）

> ID：14338156
> 
> 赞同：19
> 
> 时间：2013-01-15T12:51:06.823
> 
> 标签：c#, excel, format, currency

我为 Excel 开发了一个加载项，因此您可以将 MySQL 数据库中的一些数字插入特定的单元格。现在我尝试将这些单元格格式化为货币，我有两个问题。1\. 在格式化单元格上使用公式时，总和例如显示为：“353,2574€”。我该怎么做才能以适当的方式显示它？2\. 有些单元格是空的，但也必须用货币格式化。当使用与求和公式相同的格式并输入内容时，只显示数字。没有“€”，什么都没有。那是什么？我指定了一个 Excel.Range 并使用它来格式化范围

```
sum.NumberFormat = "#.## €"; 
```

但我也试过

```
sum.NumberFormat = "0,00 €";
sum.NumberFormat = "#.##0,00 €"; 
```

有人知道吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-01-15T13:29:26.203

这个对我有用。我有 excel 测试应用程序，将货币格式化为 2 位小数，逗号作为千位分隔符。下面是在 Excel 文件中写入数据的控制台应用程序。

确保您已引用 Microsoft.Office.Interop.Excel dll

```
using System.Collections.Generic;
using Excel = Microsoft.Office.Interop.Excel;
namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            var bankAccounts = new List<Account> {
                new Account { ID = 345678, Balance = 541.27},
                new Account {ID = 1230221,Balance = -1237.44},
                new Account {ID = 346777,Balance = 3532574},
                new Account {ID = 235788,Balance = 1500.033333}
};
            DisplayInExcel(bankAccounts);
        }
        static void DisplayInExcel(IEnumerable<Account> accounts)
        {
            var excelApp = new Excel.Application { Visible = true };
            excelApp.Workbooks.Add();
            Excel._Worksheet workSheet = (Excel.Worksheet)excelApp.ActiveSheet;
            workSheet.Cells[1, "A"] = "ID Number";
            workSheet.Cells[1, "B"] = "Current Balance";
            var row = 1;
            foreach (var acct in accounts)
            {
                row++;
                workSheet.Cells[row, "A"] = acct.ID;
                workSheet.Cells[row, "B"] = acct.Balance;

            }
            workSheet.Range["B2", "B" + row].NumberFormat = "#,###.00 €";
            workSheet.Columns[1].AutoFit();
            workSheet.Columns[2].AutoFit();
        }
    }
    public class Account
    {
        public int ID { get; set; }
        public double Balance { get; set; }
    }
} 
```

输出

![在此处输入图像描述](../Images/8f845a54be33b1d997ff1f5a473892ba.png)

# java - 从 java 中读取 c 套接字挂起/阻塞

> ID：14338161
> 
> 赞同：0
> 
> 时间：2013-01-15T12:51:15.437
> 
> 标签：java, c, sockets

Java 和 C 之间的套接字有问题。我有一个 C 程序，它创建一个套接字并开始侦听。Java客户端完成它的工作，在某些情况下打开一个套接字并写入它并尝试从中读取，但这会阻塞。

下面是 C 程序的套接字部分：

```
int sockfd, newsockfd, portno;
socklen_t clilen;
char buffer[256];
char wbuffer[256];
struct sockaddr_in serv_addr, cli_addr;
int n;

sockfd = socket(AF_INET, SOCK_STREAM, 0);
if (sockfd < 0)
        cout << "ERROR opening socket" << endl;
bzero((char *) &serv_addr, sizeof(serv_addr));
portno = 23456;
serv_addr.sin_family = AF_INET;
serv_addr.sin_addr.s_addr = INADDR_ANY;
serv_addr.sin_port = htons(portno);
int on = 1;
if (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &on, sizeof(on)) < 0)
        cout << "Couldn't set socket params!" << endl;
int so = bind(sockfd, (struct sockaddr *) &serv_addr, sizeof(serv_addr));
while(so < 0) {
        cout << "ERROR on binding" << endl;
        sleep(1);
        so = bind(sockfd, (struct sockaddr *) &serv_addr, sizeof(serv_addr));
}
listen(sockfd,5);
clilen = sizeof(cli_addr);
newsockfd = accept(sockfd, (struct sockaddr *) &cli_addr, &clilen);
if (newsockfd < 0)
        cout << "ERROR on accept" << endl;
bzero(buffer,256);
//cout << "Socket created!" << endl;
n = read(newsockfd,buffer,255);
if (n < 0)
        cout << "Error reading from socket" << endl;
 if (strcmp(buffer, "power\n") == 0) {
         // Do stuff
     strcpy(wbuffer, "off\n");
         }
     //sleep(1);
     n = write(newsockfd,wbuffer,strlen(wbuffer));
     if (n < 0)
         cout << "ERROR writing to socket" << endl;
}
//cout << "message: " << buffer << endl;
close(newsockfd);
close(sockfd); 
```

Java方面：

```
Socket socket3 = new Socket("localhost", 23456);
PrintWriter out3 = new PrintWriter(socket3.getOutputStream(), true);
BufferedReader in = new BufferedReader(new InputStreamReader(socket3.getInputStream()));
out3.write("power" + "\n");
//String status = in.readLine();
log.debug("Wrote power");
StringBuffer buffer = new StringBuffer();
while (true) {
    int ch = in.read();
    log.debug("in.read()");
    if ((ch < 0) || (ch == '\n')) {
        break;
    }
    buffer.append((char) ch);
}
String status = buffer.toString();
out3.close();
in.close();
socket3.close(); 
```

写作工作，我做了一些调试，它是阅读，特别是 in.read()，这是最后完成的事情。

我可能在 Java 方面遗漏了一些东西，因为 C 测试客户端可以很好地读取输出。

希望有人对如何使这项工作有一些想法，我对任何解决方案持开放态度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T14:03:14.760

您的 C++ 代码非常糟糕。`read(2)`考虑如果返回小于 then会发生什么`6`。总的来说：

```
n = read(newsockfd,buffer,255);

if (n < 0)
    cout << "Error reading from socket" << endl;

// continuing processing after an error - BAD

// not paying attention to n - BAD
if (strcmp(buffer, "power\n") == 0) {
     // Do stuff
     strcpy(wbuffer, "off\n");
}

// potentially writing zero bytes here - BAD
n = write(newsockfd,wbuffer,strlen(wbuffer));

if (n < 0)
     cout << "ERROR writing to socket" << endl;

} // WHERE DID THIS PAREN COME FROM? 
```

所以解决这些问题。检查[`tcpdump(1)`](http://www.tcpdump.org/tcpdump_man.html)或[wireshark](http://www.wireshark.org/)你在电线上得到的东西。在两面打印您的输入。你可能会发现你的假设在某个地方是错误的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:01:48.643

事实证明，问题实际上不在阅读部分，而是在写作部分。我忘记刷新输出，所以它实际上并没有开始阅读，或者有什么可以阅读的。添加刷新后读取工作正常，我什至可以使用 readline() 使代码更简单。

我只写入套接字的其他情况有效，因为在关闭流时调用了刷新，这让我失望。

C 代码很讨厌，我需要清理它并实际处理异常。

无论如何，感谢大家帮助我，如果没有答案，发现我的错误需要更长的时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:01:17.150

也许问题是你正在阅读一个整数：

```
int ch = in.read() 
```

您是否尝试将其更改为：

```
char ch = in.read() 
```

或者在比较之前将整数转换为 char：

```
if((char) ch == '\n' || ch < 0) 
```

我现在想不出别的了……

# android - 谷歌地图路线 - 哪个 API？

> ID：14338163
> 
> 赞同：3
> 
> 时间：2013-01-15T12:51:18.520
> 
> 标签：android, google-maps

我正在尝试获取从用户当前位置到我正在构建的应用程序中用户定义位置的路线。这似乎应该是一件相对容易的事情，但我被困在使用哪个 API 上。

现在我已经设法连接到[谷歌方向 API](https://developers.google.com/maps/documentation/directions/)，但它返回的 JSON 非常奇怪（他们在任何地方都添加了一个 \n 以使其易于阅读），这表明这个 API 不是正确的对于移动。

我还看到为此目的推荐了 google places API，但我似乎无法从文档中找到如何使用它。

任何帮助都非常感谢，因为我只是很困惑

编辑：只是为了澄清问题是我应该使用哪个 API 来获取地图的方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:10:49.580

我不记得我从哪里得到它，但这些课程对我有很大帮助，它包括如果你想绘制路线。

谷歌解析器.java

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import com.google.android.maps.GeoPoint;
import com.monumentos.log.Logger;

public class GoogleParser extends XMLParser implements Parser {
    /** Distance covered. **/
    private int distance;

    public GoogleParser(String feedUrl) {
            super(feedUrl);
    }

    /**
     * Parses a url pointing to a Google JSON object to a Route object.
     * @return a Route object based on the JSON object.
     */

    public Route parse() {
            // turn the stream into a string
            final String result = convertStreamToString(this.getInputStream());
            //Create an empty route
            final Route route = new Route();
            //Create an empty segment
            final Segment segment = new Segment();
            try {
                    //Tranform the string into a json object
                    final JSONObject json = new JSONObject(result);
                    //Get the route object
                    final JSONObject jsonRoute = json.getJSONArray("routes").getJSONObject(0);
                    //Get the leg, only one leg as we don't support waypoints
                    final JSONObject leg = jsonRoute.getJSONArray("legs").getJSONObject(0);
                    //Get the steps for this leg
                    final JSONArray steps = leg.getJSONArray("steps");
                    //Number of steps for use in for loop
                    final int numSteps = steps.length();
                    //Set the name of this route using the start & end addresses
                    route.setName(leg.getString("start_address") + " to " + leg.getString("end_address"));
                    //Get google's copyright notice (tos requirement)
                    route.setCopyright(jsonRoute.getString("copyrights"));
                    //Get the total length of the route.
                    route.setLength(leg.getJSONObject("distance").getInt("value"));
                    //Get any warnings provided (tos requirement)
                    if (!jsonRoute.getJSONArray("warnings").isNull(0)) {
                            route.setWarning(jsonRoute.getJSONArray("warnings").getString(0));
                    }
                    /* Loop through the steps, creating a segment for each one and
                     * decoding any polylines found as we go to add to the route object's
                     * map array. Using an explicit for loop because it is faster!
                     */
                    for (int i = 0; i < numSteps; i++) {
                            //Get the individual step
                            final JSONObject step = steps.getJSONObject(i);
                            //Get the start position for this step and set it on the segment
                            final JSONObject start = step.getJSONObject("start_location");
                            final GeoPoint position = new GeoPoint((int) (start.getDouble("lat")*1E6), 
                                    (int) (start.getDouble("lng")*1E6));
                            segment.setPoint(position);
                            //Set the length of this segment in metres
                            final int length = step.getJSONObject("distance").getInt("value");
                            distance += length;
                            segment.setLength(length);
                            segment.setDistance(distance/1000);
                            //Strip html from google directions and set as turn instruction
                            segment.setInstruction(step.getString("html_instructions").replaceAll("<(.*?)*>", ""));
                            //Retrieve & decode this segment's polyline and add it to the route.
                            route.addPoints(decodePolyLine(step.getJSONObject("polyline").getString("points")));
                            //Push a copy of the segment to the route
                            route.addSegment(segment.copy());
                    }
            } catch (JSONException e) {

                    Logger.appendLog( "Google JSON Parser - " + feedUrl);
            }
            return route;
    }

    /**
     * Convert an inputstream to a string.
     * @param input inputstream to convert.
     * @return a String of the inputstream.
     */

    private static String convertStreamToString(final InputStream input) {
    final BufferedReader reader = new BufferedReader(new InputStreamReader(input));
    final StringBuilder sBuf = new StringBuilder();

    String line = null;
    try {
        while ((line = reader.readLine()) != null) {
            sBuf.append(line);
        }
    } catch (IOException e) {
            Logger.appendLog( "Google parser, stream2string");
    } finally {
        try {
            input.close();
        } catch (IOException e) {
            Logger.appendLog( "Google parser, stream2string");
        }
    }
    return sBuf.toString();
}

    /**
     * Decode a polyline string into a list of GeoPoints.
     * @param poly polyline encoded string to decode.
     * @return the list of GeoPoints represented by this polystring.
     */

    private List<GeoPoint> decodePolyLine(final String poly) {
            int len = poly.length();
            int index = 0;
            List<GeoPoint> decoded = new ArrayList<GeoPoint>();
            int lat = 0;
            int lng = 0;

            while (index < len) {
            int b;
            int shift = 0;
            int result = 0;
            do {
                    b = poly.charAt(index++) - 63;
                    result |= (b & 0x1f) << shift;
                    shift += 5;
            } while (b >= 0x20);
            int dlat = ((result & 1) != 0 ? ~(result >> 1) : (result >> 1));
            lat += dlat;

            shift = 0;
            result = 0;
            do {
                    b = poly.charAt(index++) - 63;
                    result |= (b & 0x1f) << shift;
                    shift += 5;
            } while (b >= 0x20);
                    int dlng = ((result & 1) != 0 ? ~(result >> 1) : (result >> 1));
                    lng += dlng;

            decoded.add(new GeoPoint(
                    (int) (lat*1E6 / 1E5), (int) (lng*1E6 / 1E5)));
            }

            return decoded;
            }
} 
```

解析器.java

```
public interface Parser {
    public Route parse();
} 
```

路由.java

```
import java.util.ArrayList;
import java.util.List;

import com.google.android.maps.GeoPoint;

public class Route {
    private String name;
    private final List<GeoPoint> points;
    private List<Segment> segments;
    private String copyright;
    private String warning;
    private String country;
    private int length;
    private String polyline;

    public Route() {
            points = new ArrayList<GeoPoint>();
            segments = new ArrayList<Segment>();
    }

    public void addPoint(final GeoPoint p) {
            points.add(p);
    }

    public void addPoints(final List<GeoPoint> points) {
            this.points.addAll(points);
    }

    public List<GeoPoint> getPoints() {
            return points;
    }

    public void addSegment(final Segment s) {
            segments.add(s);
    }

    public List<Segment> getSegments() {
            return segments;
    }

    /**
     * @param name the name to set
     */
    public void setName(final String name) {
            this.name = name;
    }

    /**
     * @return the name
     */
    public String getName() {
            return name;
    }

    /**
     * @param copyright the copyright to set
     */
    public void setCopyright(String copyright) {
            this.copyright = copyright;
    }

    /**
     * @return the copyright
     */
    public String getCopyright() {
            return copyright;
    }

    /**
     * @param warning the warning to set
     */
    public void setWarning(String warning) {
            this.warning = warning;
    }

    /**
     * @return the warning
     */
    public String getWarning() {
            return warning;
    }

    /**
     * @param country the country to set
     */
    public void setCountry(String country) {
            this.country = country;
    }

    /**
     * @return the country
     */
    public String getCountry() {
            return country;
    }

    /**
     * @param length the length to set
     */
    public void setLength(int length) {
            this.length = length;
    }

    /**
     * @return the length
     */
    public int getLength() {
            return length;
    }

    /**
     * @param polyline the polyline to set
     */
    public void setPolyline(String polyline) {
            this.polyline = polyline;
    }

    /**
     * @return the polyline
     */
    public String getPolyline() {
            return polyline;
    }

}

RouteOverlay.java

public class RouteOverlay extends Overlay {
/** GeoPoints representing this routePoints. **/
private final List<GeoPoint> routePoints;
/** Colour to paint routePoints. **/
private int colour;
/** Alpha setting for route overlay. **/
private static final int ALPHA = 200;
/** Stroke width. **/
private static final float STROKE = 4.5f;
/** Route path. **/
private final Path path;
/** Point to draw with. **/
private final Point p;
/** Paint for path. **/
private final Paint paint;

/**
 * Public constructor.
 * 
 * @param route Route object representing the route.
 * @param defaultColour default colour to draw route in.
 */

public RouteOverlay(final Route route, final int defaultColour) {
        super();
        routePoints = route.getPoints();
        colour = defaultColour;
        path = new Path();
        p = new Point();
        paint = new Paint();
}

@Override
public final void draw(final Canvas c, final MapView mv,
                final boolean shadow) {
        super.draw(c, mv, shadow);

        paint.setColor(colour);
        paint.setAlpha(ALPHA);
        paint.setAntiAlias(true);
        paint.setStrokeWidth(STROKE);
        paint.setStyle(Paint.Style.STROKE);

        redrawPath(mv);
        c.drawPath(path, paint);
}

/**
 * Set the colour to draw this route's overlay with.
 * 
 * @param c  Int representing colour.
 */
public final void setColour(final int c) {
        colour = c;
}

/**
 * Clear the route overlay.
 */
public final void clear() {
        routePoints.clear();
}

/**
 * Recalculate the path accounting for changes to
 * the projection and routePoints.
 * @param mv MapView the path is drawn to.
 */

private void redrawPath(final MapView mv) {
        final Projection prj = mv.getProjection();
        path.rewind();
        final Iterator<GeoPoint> it = routePoints.iterator();
        prj.toPixels(it.next(), p);
        path.moveTo(p.x, p.y);
        while (it.hasNext()) {
                prj.toPixels(it.next(), p);
                path.lineTo(p.x, p.y);
        }
        path.setLastPoint(p.x, p.y);
} 
```

}

段.java

```
 import com.google.android.maps.GeoPoint;

public class Segment {
    /** Points in this segment. **/
    private GeoPoint start;
    /** Turn instruction to reach next segment. **/
    private String instruction;
    /** Length of segment. **/
    private int length;
    /** Distance covered. **/
    private double distance;

    /**
     * Create an empty segment.
     */

    public Segment() {
    }

    /**
     * Set the turn instruction.
     * @param turn Turn instruction string.
     */

    public void setInstruction(final String turn) {
            this.instruction = turn;
    }

    /**
     * Get the turn instruction to reach next segment.
     * @return a String of the turn instruction.
     */

    public String getInstruction() {
            return instruction;
    }

    /**
     * Add a point to this segment.
     * @param point GeoPoint to add.
     */

    public void setPoint(final GeoPoint point) {
            start = point;
    }

    /** Get the starting point of this 
     * segment.
     * @return a GeoPoint
     */

    public GeoPoint startPoint() {
            return start;
    }

    /** Creates a segment which is a copy of this one.
     * @return a Segment that is a copy of this one.
     */

    public Segment copy() {
            final Segment copy = new Segment();
            copy.start = start;
            copy.instruction = instruction;
            copy.length = length;
            copy.distance = distance;
            return copy;
    }

    /**
     * @param length the length to set
     */
    public void setLength(final int length) {
            this.length = length;
    }

    /**
     * @return the length
     */
    public int getLength() {
            return length;
    }

    /**
     * @param distance the distance to set
     */
    public void setDistance(double distance) {
            this.distance = distance;
    }

    /**
     * @return the distance
     */
    public double getDistance() {
            return distance;
    }

} 
```

XMLParser.java

```
import java.io.IOException;
import java.io.InputStream;
import java.net.MalformedURLException;
import java.net.URL;

import com.monumentos.log.Logger;

public class XMLParser {
    // names of the XML tags
    protected static final String MARKERS = "markers";
    protected static final String MARKER = "marker";

    protected URL feedUrl;

    protected XMLParser(final String feedUrl) {
            try {
                    this.feedUrl = new URL(feedUrl);
            } catch (MalformedURLException e) {
                Logger.appendLog( "XML parser - " + feedUrl);
            }
    }

    protected InputStream getInputStream() {
            try {
                    return feedUrl.openConnection().getInputStream();
            } catch (IOException e) {
                Logger.appendLog(  "XML parser - " + feedUrl);
                    return null;
            }
    }
} 
```

希望它会帮助你。

调用api示例：

```
 Parser parser;

        String jsonURL = "http://maps.googleapis.com/maps/api/directions/json?";
        final StringBuffer sBuf = new StringBuffer(jsonURL);
        sBuf.append("origin=");
        sBuf.append( points.get(0).getLatitudeE6()/1E6);
        sBuf.append(',');
        sBuf.append(points.get(0).getLongitudeE6()/1E6);
        sBuf.append("&destination=");
        sBuf.append(points.get(points.size()-1).getLatitudeE6()/1E6);
        sBuf.append(',');
        sBuf.append(points.get(points.size()-1).getLongitudeE6()/1E6);

        sBuf.append("&sensor=true&mode="+routeMode);

        Logger.appendLog(sBuf.toString());

        parser = new GoogleParser(sBuf.toString());

        Route r =  parser.parse(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T12:59:30.000

[您可以使用google http java client](http://code.google.com/p/google-http-java-client/wiki/JSON)解析它们。试试这个[例子](http://www.androidhive.info/2012/08/android-working-with-google-places-and-maps-tutorial/)

# c# - 动态控件 - 清除容器中所有控件的替代方法

> ID：14338168
> 
> 赞同：0
> 
> 时间：2013-01-15T12:51:25.733
> 
> 标签：c#, asp.net, dynamic-controls

我正在使用动态控件进行一些测试。这里的代码：

ASPX 页面

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
        <asp:DropDownList ID="DropDownList1" runat="server" AutoPostBack="True" 
            onselectedindexchanged="DropDownList1_SelectedIndexChanged">
            <asp:ListItem Value="0">Nothing</asp:ListItem>
            <asp:ListItem Value="1">Two buttons</asp:ListItem>
        </asp:DropDownList>
        <asp:Panel ID="Panel1" runat="server">
        </asp:Panel>
    </div>
    </form>
</body>
</html> 
```

后面的代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        if (ViewState["CreateDynamicButton"] != null)
        {
            CreateControls();
        }
    }
    protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
    {
        CreateControls();
    }

    void Button_Click(object sender, EventArgs e)
    {
        Button b = (Button)sender;

        Response.Write("You clicked the button with ID " + b.ID);
    }

    private void CreateControls()
    {
        if (DropDownList1.SelectedValue.Equals("1"))
        {
            Panel1.Controls.Clear();

            Button b1 = new Button();
            b1.ID = "b1";
            b1.Text = "Button 1";

            Button b2 = new Button();
            b2.ID = "b2";
            b2.Text = "Button 2";

            b1.Click += new EventHandler(Button_Click);
            b2.Click += new EventHandler(Button_Click);

            Panel1.Controls.Add(b1);
            Panel1.Controls.Add(b2);

            ViewState["CreateDynamicButton"] = true;
        }
    }
} 
```

此代码有效，但正如您所见，我`Panel1.Controls`在添加按钮之前删除了所有控件，因为当我第二次选择创建它们时，我得到了重复控件 ID 的例外。

我认为对于两个按钮，操作非常快，但是如果控件数量较多，则制作时间会更长。您能否建议我在没有此解决方法的情况下在 PostBack 之后重新生成控件的更好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:03:14.600

`private bool ControlsCreated = false;` 在您的方法中创建一个类变量，`CreateControls`然后检查

```
if (!ControlsCreated) {
    //your code to create controls
} 
```

这确保控件只创建一次。如果稍后您需要重新创建控件（下拉列表值已更改），只需清除容器并将 ControlsCreated 设置为 false。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T12:58:30.923

对于初学者，如果您想永久删除控件（在这种情况下为按钮），您最好使用 Dispose 方法吗？清除控件的面板不会处理它，这将解释已经在使用的 ID。无论面板中有多少控件，您都可以执行一个简单的循环来执行此操作；

```
foreach(Control control in Container)
{
  control.Dispose();
} 
```

另外，要创建按钮，我看到您只是将它们命名为 btn1、btn2 等等。您也可以循环执行此操作；

```
for(int i = 0; i >= yourInt; i++)
{
  Button b = new Button();
  b.ID = "b" + i;
  b.Text = "Button " + i;
} 
```

}

# javascript - Backbone.js 集合获取不起作用

> ID：14338169
> 
> 赞同：1
> 
> 时间：2013-01-15T12:51:35.487
> 
> 标签：javascript, backbone.js, backbone.js-collections

```
var sgt1 = Backbone.Collection.extend({
        model: sgt2
    });

var a = new sgt1();
a.add({attr1: 'asd'}); 
```

好的，到目前为止它是有效的，但是：

`a.get(0)`返回未定义

和

`a.at(0)`返回一个 obj

为什么`get`返回`undefined`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T12:55:33.827

通过模型字段而不是像 with 那样的索引来`get()`查询集合。请参阅[文档](http://backbonejs.org/#Collection-get)。`id``at()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T12:56:11.420

`a.get(0)`按 ID 获取。它与`at`按索引位置获取的不同。由于您的模型还没有 ID，`get`因此无法使用。

# php - Code Igniter auto_link() 弄乱了我的电子邮件地址

> ID：14338170
> 
> 赞同：1
> 
> 时间：2013-01-15T12:51:39.477
> 
> 标签：php, codeigniter

使用 auto_link() 将副本从 CMS 控制的页面输出到前端。我在存储的副本中有 2 个电子邮件地址，recruit@ 和 bankrecruit@。

当我查看前端时，第一封电子邮件，recruit@，被自动链接成为一个链接的电子邮件地址，但第二个成为银行，然后是招聘@电子邮件链接。这显然不是我所期望的。

auto_link() 匹配所有的recruit@ 情况，在这种情况下，bankrecruit@ 正在被转换，因为它首先找到recruit@ 并将其转换。

如果我删除recruit@ 然后bankrecruit@ 工作正常。此外，如果我将名称更改为 bank@，那么两个地址都按预期工作。

有解决方案吗？

```
<p>This is the address a@test.com</p>
<p>This is the second address ba@test.com</p> 
```

脚本是：

```
auto_link($content) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:58:53.157

正如@cryptic 所指出的，这是 auto_link 方法中的一个错误。（[参见源代码](https://github.com/EllisLab/CodeIgniter/blob/2.1-stable/system/helpers/url_helper.php#L423)）他们在输出中查找所有电子邮件地址，然后将所有电子邮件地址替换`str_replace`为锚定版本。所以...

```
<p>This is the address a@test.com</p>
<p>This is the second address ba@test.com</p> 
```

变成

```
<p>This is the address <a ...>a@test.com</a></p>
<p>This is the second address b<a ...>a@test.com</a></p> 
```

在第一次通过电子邮件`a@test.com`。在第二封电子邮件中，他们尝试`ba@test.com`用锚定版本替换，但`str_replace`找不到地址，它已经被替换了。

您可以通过以下方式实施自己的修复：

1.  扩展 URL 助手的 auto_link 方法。[查看文档](http://ellislab.com/codeigniter/user-guide/general/helpers.html)
2.  将 CodeIgniter 源中的 auto_link 方法复制到新的 Helper 中。
3.  仅替换第一次出现的字符串。[请参阅此 SO 线程](https://stackoverflow.com/questions/1252693/php-str-replace-that-only-acts-on-the-first-match)。

例如：

```
$str = str_replace($matches['0'][$i], safe_mailto($matches['1'][$i].'@'.$matches['2'][$i].'.'.$matches['3'][$i]).$period, $str); 
```

变成

```
$str = preg_replace('/' . $matches['0'][$i] . '/', safe_mailto($matches['1'][$i].'@'.$matches['2'][$i].'.'.$matches['3'][$i]).$period, $str, 1); 
```

那应该为你解决它。我建议不要修改系统的 URL_Helper，你以后可能会遇到一些迁移问题。

希望这可以帮助。

# ios - 获取 Web 目录中的图像 URL

> ID：14338173
> 
> 赞同：0
> 
> 时间：2013-01-15T12:51:43.283
> 
> 标签：ios, xcode

我想获取所有图像的 URL，或者说 Web 目录 (www.abcde.com/images) 中的“JPEG”文件。我只想将他们的 URL 放在一个数组中。我无法管理。你能帮我解决这个问题吗？

提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T12:55:34.030

创建一个服务器端脚本（例如 php），它为您提供该目录中所有图像的列表，格式为 xml 或 json。从 iOS 向该脚本发送请求，获取 xml 或 JSON 解析它并使用图像 url。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:11:55.187

假设您可以访问索引文件，您可以简单地通过 NSURL 加载整个 html 文件并删除链接行。但是，当您想要搜索（“蜘蛛或爬行”）更复杂文档中的链接时，这将不起作用（或几乎不起作用）。在 iOS 上，我建议您使用简单但功能强大的“hpple”框架（[https://github.com/topfunky/hpple](https://github.com/topfunky/hpple)）。它用于解析html。您可以使用它搜索某些 html 元素，例如`<a href...>`构造。

带有 hpple 的示例可能如下所示：

```
NSURL *url = [NSURL URLWithString:@"whatver.com/images"];
NSData *data = [NSData url];
TFHpple *hppleParser = [TFHpple data];
NSString *images = @"//img"; // grabbs all image tags
NSArray *node = [hppleParser searchWithXPathQuery:images] 
```

[在http://www.raywenderlich.com/14172/how-to-parse-html-on-ios](http://www.raywenderlich.com/14172/how-to-parse-html-on-ios)找到一个更大的例子

# typescript - 打字稿编译器错误：无法将“{}[]”转换为“数组”

> ID：14338174
> 
> 赞同：0
> 
> 时间：2013-01-15T12:51:49.910
> 
> 标签：typescript, tsc

我在使用此打字稿代码时遇到编译器错误:)

我已经像这样定义了 playerBullets：

```
playerBullets: Array = Array[40]; 
```

并尝试这样做：

```
this.playerBullets = this.playerBullets.filter(function (bullet) {
    return bullet.active;
}); 
```

但是这段代码在市场上出现了红色语法错误：

> WebUI/ts/game.ts(89,19)：预期的变量、类、接口或模块 WebUI/ts/game.ts(88,29)：无法将 '{}[]' 转换为 'Array'

如果我将定义更改为：

```
playerBullets  = []; 
```

它有效，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T14:02:49.380

您需要像这样定义数组：

```
playerBullets: bullet[] = new Array(40); 
```

整体代码如下所示：

```
interface bullet{
     active :bool;
}

var playerBullets:bullet[] = new Array(40)

playerBullets = playerBullets.filter( function (bullet) {
    return bullet.active;
}); 
```

* * *

当然你不必定义子弹类型（但如果你使用你可能想要的打字稿）

```
var playerBullets:any = new Array(40)

playerBullets = playerBullets.filter( function (bullet) {
    return bullet.active;
}); 
```

# vb.net - ASP.Net 使其适用于不同格式的 jsonstring

> ID：14338175
> 
> 赞同：0
> 
> 时间：2013-01-15T12:51:53.710
> 
> 标签：vb.net, json

我已经创建了这个 vb.net 文件，当我发送这样的字符串时它正在工作：

```
?data={"id":"12345","timestamp":"2012-03-03 12:00:00","latitude":"23.41223","longitude"="54.12345"} 
```

但我也希望它使用这样的格式：

```
?id=12345&timestamp=2012-03-03 12:00:00&latitude=23.41223&longitude=54.12345 
```

我如何在我的 vb.net 文件中进行这项工作

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load    
        If Not String.IsNullOrEmpty(Request.QueryString("data")) Then
            Dim data As String = Request.QueryString("data")

            Dim myObj As New MyObject
            Dim properties() As PropertyInfo = myObj.GetType().GetProperties()
            Dim values() As String = Server.UrlDecode(data).Replace("[", "").Replace("]", "").Replace("{", "").Replace("}", "").Replace(""":""", """=""").Split(New Char() {","}, StringSplitOptions.RemoveEmptyEntries)
            For Each value As String In values
                Dim keyValue() As String = value.Split(New Char() {"="}, StringSplitOptions.RemoveEmptyEntries)
                For Each prop As PropertyInfo In properties
                    If prop.Name.ToLower = keyValue(0).ToLower.Replace("""", "") Then
                        prop.SetValue(myObj, keyValue(1).Replace("""", ""), Nothing)
                    End If
                Next
            Next

        lblText1.Text = String.Format("ID: {0}", myObj.ID)
        lblText2.Text = String.Format("Longitude: {0}", myObj.Longitude)
        lblText3.Text = String.Format("Latitude: {0}", myObj.Latitude)
        lblText4.Text = String.Format("Timestamp: {0}", myObj.Timestamp)

    Cmd.Parameters.Clear()      
    Cmd.Parameters.AddWithValue("@ID", myObj.ID)
    Cmd.Parameters.AddWithValue("@Longitude", myObj.Longitude)
    Cmd.Parameters.AddWithValue("@Latitude", myObj.Latitude)
    Cmd.Parameters.AddWithValue("@Timestamp", myObj.Timestamp)

    Con.ConnectionString = "Data Source=servert\sql;Initial Catalog=table;Integrated Security=True"
        Cmd.Connection = Con
        Con.Open()
    Cmd.CommandText = "IF EXISTS (SELECT 1 FROM Locatie WHERE id = @ID) " & Environment.NewLine & _
                  "  BEGIN UPDATE Locatie SET Longitude = @Longitude, Latitude = @Latitude, Timestamp = @Timestamp WHERE id=@ID END " & Environment.NewLine & _
                  "ELSE " & Environment.NewLine & _
                  "   BEGIN INSERT INTO Locatie VALUES (@ID, @Longitude, @Latitude, @Timestamp) END "

     Reader = Cmd.ExecuteReader

        Reader.Close()
       Con.Close()
       Con.Dispose()

        End If

    End Sub

    Public Class MyObject
        Private _ID As String
        Private _Longitude As String
        Private _Latitude As String
        Private _Timestamp As String

        Public Property ID As String
            Get
                Return _ID
            End Get
            Set(value As String)
                _ID = value
            End Set
        End Property

        Public Property Longitude As String
            Get
                Return _Longitude
            End Get
            Set(value As String)
                _Longitude = value
            End Set
        End Property

        Public Property Latitude As String
            Get
                Return _Latitude
            End Get
            Set(value As String)
                _Latitude = value
            End Set
        End Property

        Public Property Timestamp As String
            Get
                Return _Timestamp
            End Get
            Set(value As String)
                _Timestamp = value
            End Set
        End Property

    End Class

</script> 
```

可能键必须在此处，因此还有第二个选项，其中第二个字符串被拆分，将值设置为 id、经度、纬度和时间戳：

```
 Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load   
        If Not String.IsNullOrEmpty(Request.QueryString("data")) Then
            Dim data As String = Request.QueryString("data")

            Dim myObj As New MyObject
            Dim properties() As PropertyInfo = myObj.GetType().GetProperties()
            Dim values() As String = Server.UrlDecode(data).Replace("[", "").Replace("]", "").Replace("{", "").Replace("}", "").Replace(""":""", """=""").Split(New Char() {","}, StringSplitOptions.RemoveEmptyEntries)
            For Each value As String In values
                Dim keyValue() As String = value.Split(New Char() {"="}, StringSplitOptions.RemoveEmptyEntries)
                For Each prop As PropertyInfo In properties
                    If prop.Name.ToLower = keyValue(0).ToLower.Replace("""", "") Then
                        prop.SetValue(myObj, keyValue(1).Replace("""", ""), Nothing)
                    End If
                Next
            Next 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T18:33:34.607

检查查询字符串。如果字符串以数据开头，则使用第一种方法为变量分配值，否则通过获取查询字符串的值为变量分配值。

例子：

```
If Not String.IsNullOrEmpty(Request.QueryString("data")) Then
    'Use reflection logic
Else
    MyObj.Longitude = Request.QueryString("longitude")
End If 
```

**编辑**

提供的 Page_Load 子例程中的实现示例。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load 
    Dim myObj As New MyObject

    If Not String.IsNullOrEmpty(Request.QueryString("data")) Then
        Dim data As String = Request.QueryString("data")

        Dim properties() As PropertyInfo = myObj.GetType().GetProperties()
        Dim values() As String = Server.UrlDecode(data).Replace("[", "").Replace("]", "").Replace("{", "").Replace("}", "").Replace(""":""", """=""").Split(New Char() {","}, StringSplitOptions.RemoveEmptyEntries)
        For Each value As String In values
            Dim keyValue() As String = value.Split(New Char() {"="}, StringSplitOptions.RemoveEmptyEntries)
            For Each prop As PropertyInfo In properties
                If prop.Name.ToLower = keyValue(0).ToLower.Replace("""", "") Then
                    prop.SetValue(myObj, keyValue(1).Replace("""", ""), Nothing)
                End If
            Next
        Next
    Else
        If Not (String.IsNullOrEmpty(Request.QueryString("id")) Then
            myObj.ID = Request.QueryString("id")
        Else
            myObj.ID = "Not set"
        End If

        If Not (String.IsNullOrEmpty(Request.QueryString("longitude")) Then
            myObj.Longitude = Request.QueryString("longitude")
        Else
            myObj.Longitude = "Not set"
        End If

        If Not (String.IsNullOrEmpty(Request.QueryString("latitude")) Then
            myObj.Latitude = Request.QueryString("latitude")
        Else
            myObj.Latitude = "Not set"
        End If

        If Not (String.IsNullOrEmpty(Request.QueryString("timestamp")) Then
            myObj.Timestamp = Request.QueryString("timestamp")
        Else
            myObj.Timestamp = "Not set"
        End If  
    End If

    lblText1.Text = String.Format("ID: {0}", myObj.ID)
    lblText2.Text = String.Format("Longitude: {0}", myObj.Longitude)
    lblText3.Text = String.Format("Latitude: {0}", myObj.Latitude)
    lblText4.Text = String.Format("Timestamp: {0}", myObj.Timestamp)

    'Rest of sub here
End Sub 
```

# css - 媒体查询 - 视口的高度是否大于宽度？

> ID：14338178
> 
> 赞同：2
> 
> 时间：2013-01-15T12:51:59.033
> 
> 标签：css, responsive-design, media-queries

是否可以使用 CSS3 媒体查询来询问：

'视口的高度是否大于宽度'？

或者：

'视口的宽度是否大于高度'？

我希望我的图像在两个方向上都是流畅的！

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T13:03:18.047

为此，您可以使用以下媒体查询：

```
orientation:portrait
orientation:landscape 
```

我无法向您提供有关媒体查询的更多信息，因为我还没有研究过它们。请确保它们受到您希望支持的设备的支持。

至于 CSS：不，您无法使用 CSS 检测视口的宽度和高度。CSS 不是一种编程语言，而是一种样式语言。除非您使用 CSS 预处理器（Sass、Less），否则您将无法用它做任何智能的事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T13:09:22.663

Alien 先生在某些技术上可能是对的，因为我不是程序员。但是，如果您想重新设计布局或根据屏幕是横向（宽度大于高度）还是纵向（高度大于宽度）模式进行调整，您绝对可以使用 css 媒体查询。

[http://www.w3.org/TR/css3-mediaqueries/#media0](http://www.w3.org/TR/css3-mediaqueries/#media0)

# windows-runtime - 多语言 WinRT 应用程序

> ID：14338191
> 
> 赞同：0
> 
> 时间：2013-01-15T12:52:42.767
> 
> 标签：windows-runtime, multilingual

是否有任何内置工具可以支持 WinRT 中的多语言应用程序？例如，我有几个按钮，其文本内容为“添加”、“删除”、“编辑”，在英语中应该是“Dodaj”、“Usun”、“Edytuj”等等。我可以自动将此文本设置为用户语言吗？（以及如何自动检测用户语言？）。我可以使用语言模型并将按钮内容绑定到 ViewModel 属性，但没有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:42:24.283

这得到了很好的支持，MS 在这里有一个很好的示例：http: [//code.msdn.microsoft.com/windowsapps/Application-resources-and-cd0c6eaa](http://code.msdn.microsoft.com/windowsapps/Application-resources-and-cd0c6eaa)

如果元素是数据绑定的，则使用 x:uid 设置“静态”内容的文本不起作用。例如，您的视图模型中有一个包含用户名视图模型的可观察集合，您尝试执行以下操作（伪代码！！）：-

```
<List ItemSource={Binding Users}>
  <List.ItemTemplate>
      <DataTemplate>
          <StackPanel>
              <TextBlock x:uid="ByUser"/>
              <TextBlock Text={Binding Username}/>
          </StackPanel>
      </DataTemplate>
  </List.ItemTemplate>      
</List> 
```

应该设置第一个文本框的文本（基于 uid ByUser）不会被设置。我通过将全球化服务包装起来并将`ResourceLoader`其传递到我的“UsersName”视图模型来解决这个问题，然后我将公开一个名为 ByUserText 的属性，并对其进行绑定。不理想，希望这会得到解决。

您需要使用全球化服务的唯一另一件事是消息框等。

这是我传递的全球化服务：-

```
using Windows.ApplicationModel.Resources;

public class GlobalisationService : IGlobalisationService
{
    private readonly ResourceLoader resourceLoader;
    public GlobalisationService()
    {
        resourceLoader = new ResourceLoader();
    }
    public string GetString(string key)
    {
        try
        {
            return resourceLoader.GetString(key);
        }
        catch
        {
            return "NOT FOUND: " + key;
        }
    }

    public string this[string key]
    {
        get
        {
            return GetString(key);
        }

    }
} 
```

# eclipse - Webdriver 脚本在 FF17 中运行良好，但在 IE7 中无法运行

> ID：14338196
> 
> 赞同：0
> 
> 时间：2013-01-15T12:53:09.577
> 
> 标签：eclipse, firefox, internet-explorer-7, stack-trace, selenium-webdriver

下面的 Webdriver 脚本对 FF17 工作正常，但在 IE-7 中出现错误。我更改了 IE 的保护模式。仍然没有输出。

公共类驱动程序{

```
DefaultSelenium selenium;
private WebDriver driver;
private StringBuffer verificationErrors = new StringBuffer();
@Before
public void setUp() throws Exception {

    driver = new InternetExplorerDriver();
    driver.manage().timeouts().implicitlyWait(30, TimeUnit.SECONDS);        
}
@Test
public void testTimeWebdriver(){

    try {

        WebElement userName, passWord, submit;
        driver.manage().getCookies();

        driver.get("http://www.google.co.in/");
        //driver.manage().;
                                                                                                                                                                                                                                   driver.findElement(By.id("gbqfq").sendKeys("hello"));

        driver.findElement(By.id("gbqfba")).click();

        WaitForPageToLoad wait = new WaitForPageToLoad();
        wait.setTimeToWait(30000);

        } catch (Exception e) {
        System.out.println(e);
    }

}
@After
public void tearDown() throws Exception {
    driver.quit();
    String verificationErrorString = verificationErrors.toString();
    if (!"".equals(verificationErrorString)) {
        fail(verificationErrorString);
    }
} 
```

获取 IE 时出错：错误：无法找到名称 == 用户 ID 的元素（警告：服务器未提供任何堆栈跟踪信息）；持续时间或超时：30.07 秒有关此错误的文档，请访问：[http](http://seleniumhq.org/exceptions/no_such_element.html) ://seleniumhq.org/exceptions/no_such_element.html 构建信息：版本：'2.8.0'，修订：'14056'，时间：'2011- 10-06 12:41:26' 系统信息：os.name：'Windows XP'，os.arch：'x86'，os.version：'5.1'，java.version：'1.6.0_38' 驱动程序信息：驱动程序.version: RemoteWebDriver

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:03:05.037

WebDriver 不支持`IE7`. 你可以使用`IE8 or higher version`它。

# vbscript - 在宏中通过命令行重新加载 QlikView 文档时出错

> ID：14338202
> 
> 赞同：0
> 
> 时间：2013-01-15T12:53:27.910
> 
> 标签：vbscript, qlikview

我在重新加载 QlikView 文档时遇到问题。当我使用命令执行批处理文件时：

```
"C:\Program Files (x86)\QlikView\Qv.exe" /r "C:\QlikViewMount\reloadvictim.qvw" 
```

文件重新加载正常。

但是，当我将它放入 QlikView 宏 (VBScript) 时，它给了我“未知命令行选项”。这是我使用的：

```
strCommand = chr(34) & "C:\Program Files (x86)\QlikView\Qv.exe"  & chr(34) & "/r" & chr(34) & "C:\QlikViewMount\reloadvictim.qvw" & chr(34) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T11:27:13.097

语法

```
 strCommand = chr(34) & " " .... 
```

让我觉得您想在[qlikview](/questions/tagged/qlikview "显示标记为“qlikview”的问题")中重新加载数据。

为什么不按*CTRL+R*？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-09T10:50:48.807

您的命令行似乎缺少参数两侧的几个空格`/r`，下面应该可以解决您的问题：

```
strCommand = chr(34) & "C:\Program Files (x86)\QlikView\Qv.exe" & chr(34) & " /r " & chr(34) & "C:\QlikViewMount\reloadvictim.qvw" & chr(34) 
```

# javascript - 三.js粒子形成形状

> ID：14338203
> 
> 赞同：2
> 
> 时间：2013-01-15T12:53:29.810
> 
> 标签：javascript, three.js

我一直在关注本教程（[http://creativejs.com/tutorials/three-js-part-1-make-a-star-field/](http://creativejs.com/tutorials/three-js-part-1-make-a-star-field/)），一切都很好，但我想知道我是如何可以修改脚本，这样当粒子到达终点时会有某种形式的回调。我已经修改了教程中的代码，所以它反转了粒子移动的方式。

我想要尝试创建的是一堆粒子聚集在一起形成一个正方形，是否可以使用教程中的代码作为开始并在此基础上构建，或者我应该在别处寻找并重新开始？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:10:53.207

如果您创建与模型的顶点数量相同数量的粒子，并将粒子移向顶点的位置，这不是很容易吗？

```
var p = emitter.geometry.vertices;  // the vertices (particles) of your particle emitter
var m = model.geometry.vertices;    // the vertices of the target model

for(var i in p) {
    p[i].x = (p[i].x + m[i].x) / 2;
    p[i].y = (p[i].y + m[i].y) / 2;
    p[i].z = (p[i].z + m[i].z) / 2;
} 
```

# editor - Sublime Text 2 创建模板

> ID：14338206
> 
> 赞同：0
> 
> 时间：2013-01-15T10:37:17.197
> 
> 标签：editor

我想构建一个项目特定模板以包含在新创建的 PHP 文件中，就像 Eclipse 一样，如下所示，

```
 /**
 * @file test.theme.inc
 * DESCRIPTION LINE 1
 * DESCRIPTION LINE 2
 * DESCRIPTION LINE 3
 * @name test.theme.inc
 * @created Dec 21, 2012
 * @author Aneek
 * @version $Id:$
 * @copyright  
 * Proprietary and Confidential
 * Copyright (C) 2012 Company name. All Rights Reserved.
 */ 

```

我怎样才能制作这样的模板来使用？

# c++ - 奇怪的条件格式

> ID：14338207
> 
> 赞同：2
> 
> 时间：2013-01-15T12:53:40.610
> 
> 标签：c++, conditional-statements

在我围绕这个美丽事物的广阔而危险的位面进行的无尽旅程中，`The Internet`我遇到了一位神秘的、年迈的、白胡子的巫师，他的名字不能被提及。尽管非常强大，但死亡很快就把他带走了。

就在他咽下最后一口气之前，他递给我一个卷轴，一边昏倒一边低声说

*`Take this and spread the knowledge`*

在他死后不久，他的身体就变成了能量，纯粹的能量传遍了整个宇宙。

卷轴包含这段代码：

```
#include <iostream>
int main()
{
    int x = 3;
    while(2 <= x <= 5)
        std::cout << x++;
} 
```

直到今天，谜团仍然存在：

**条件如何评估？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-15T12:54:54.743

总是为真，因为`2<=x`要么计算为`1`要么`0`，两者都是`<=5`。

所以这实际上是一个无限循环：

```
while( (2 <= x) <= 5)
    std::cout<<x++; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T13:05:05.627

好吧，这个卷轴的作者想要表达一个我们称之为*链式运算符符号*的条件，这在数学中是众所周知的（也许巫师是数学家？）：

```
Let x ∈ ℜ, 2 ≤ x ≤ 5\. Then ... 
```

通常，这在 C++、C、Java 和许多其他具有类似表达式评估逻辑的语言中是不可能的。有一些库可以启用这样的功能，但另一方面会引入冗长，因为您必须首先包装其中一个参数。此外，它对于程序员来说不是很可读。

如果您使用向导在此卷轴上所做的语言编写表达式，它将*从左到右*计算：

```
while ( (2 <= x) <= 5 )
    ... 
```

总是`true`, 因为`2 <= x`是`true`or并且分别隐式转换为or`false`的整数值,总是小于或等于.`1``0``5`

为了表达数学家想要的条件，你必须使用语法

```
while ( (2 <= x) && (x <= 5) )
    ... 
```

或使用实用函数来准确表达这一点：

```
template<class T>
bool between(const T& arg, const T& min, const T& max) {
    return !(arg < min) && !(max < arg);
}

while ( between(x, 2, 5) )
    ... 
```

请注意我是如何在 中编写条件的`between`：它只需要实现`operator<(T, T)`，从而简化自定义类型的实现。

# java - 在 Linux 平台上使用 SuperCSV 编写 CSV 文件

> ID：14338213
> 
> 赞同：0
> 
> 时间：2013-01-15T12:53:53.590
> 
> 标签：java, linux, unix, csv, supercsv

我正在使用 SuperCSV 读取和写入 csv 文件。我面临的问题是，在 Unix/Linux 系统下，我将**“^M”**字符附加到每行的末尾，这很烦人。

我该如何处理/解决这个问题。

```
beanWriter = new CsvBeanWriter(new FileWriter(this.file), CsvPreference.STANDARD_PREFERENCE);
final CellProcessor[] processors = getProcessors();
beanWriter.write(writeBean, header, processors); 
```

部分代码我如何准确地使用 SuperCSV

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T12:55:48.953

就像[文档](http://supercsv.sourceforge.net/apidocs/org/supercsv/prefs/CsvPreference.html)和[网站](http://supercsv.sourceforge.net/preferences.html)说的那样，使用`CsvPreference.EXCEL_PREFERENCE`.

# c# - Code First 禁止外键生成

> ID：14338215
> 
> 赞同：0
> 
> 时间：2013-01-15T12:54:05.557
> 
> 标签：c#, ef-code-first, entity-framework-5

我们有一个包含许多实体的数据库，我以三个实体 Case、Task 和 Note 为例。任何实体都可以有注释，我们决定采用以下数据库设计。

```
Case:
  - CaseId
  - Title

Task:
  - TaskId
  - Title

Note:
  - NoteId
  - Desc
  - ParentId (will contain the PK of Case/Task etc but without FK constraint) 
```

POCO 如下：

```
Case
{
  CaseId
  Title
  Notes
}

Task
{
  TaskId
  Title
  Notes
} 
```

我们不希望有引用约束，因为这些注释不会被删除。我们可以使用`EDMX`并希望使用 Code First 方法对此进行建模。我们已经搜索了 SO 并查看了多态关联等的建议。如果给定这种设计，首先使用代码建模的最佳方法是什么？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:01:41.767

我建议您使用继承 - 从您的描述中可以看出：

```
public class EntityWithNotes
{
  public int Id { get; set; }
  public string Title { get; set; }
  public Collection<Note> { get; set; }
}

public class Note
{
  public int Id { get; set; }
  public string Description { get; set; }
  public int ParentId { get; set; }
}

public class Case : EntityWithNotes { /* ...*/ }
public class Task : EntityWithNotes { /* ...*/ } 
```

...并使用外键关联。引用约束不仅仅与删除有关。

# python - 使用中间件类通过应用引擎进行移动检测的简单场景

> ID：14338217
> 
> 赞同：1
> 
> 时间：2013-01-15T12:54:09.287
> 
> 标签：python, google-app-engine, jinja2

我是应用程序引擎和 python 的新手，我只是想了解事物的工作原理。

我有一个简单的应用程序，有一个映射的 url (/)。我尝试使用的所有类都在应用程序的基本目录中。

这是我的 main.py - 我要做的就是使用中间件类将变量传递给模板，这样我就可以根据设备类型渲染页面的不同部分。

```
import webapp2
import jinja2
import os
from useragents import search_strings

jinja_environment = jinja2.Environment(
    loader=jinja2.FileSystemLoader(os.path.dirname(__file__)))

class MainPage(webapp2.RequestHandler):
    def get(self):

    template = jinja_environment.get_template('templates/index.html')
    self.response.out.write(template.render())

app = webapp2.WSGIApplication([('/', MainPage)],
                          debug=True)

class Middleware(object):
@staticmethod
def process_request(request):
    """Adds a "mobile" attribute to the request which is True or False
       depending on whether the request should be considered to come from a
       small-screen device such as a phone or a PDA

    //rest of class is [here][1]
    """ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:51:46.593

```
import webapp2
import jinja2
import os
from useragents import search_strings

jinja_environment = jinja2.Environment(
    loader=jinja2.FileSystemLoader(os.path.dirname(__file__)))

class MainPage(webapp2.RequestHandler):
    def get(self):
    #i don't know if you want to overwrite self.request but here it is
    self.request = Middleware.process_request(self.request)
    template = jinja_environment.get_template('templates/index.html')
    self.response.out.write(template.render())

app = webapp2.WSGIApplication([('/', MainPage)],
                          debug=True)

class Middleware(object):
@staticmethod
def process_request(request):
    """Adds a "mobile" attribute to the request which is True or False
       depending on whether the request should be considered to come from a
       small-screen device such as a phone or a PDA

    //rest of class is [here][1]
    """ 
```

# html - 我可以在 Windows Server 2012 上使用 HTML5 为 Windows 8 编写和运行 Metro 应用程序吗？

> ID：14338220
> 
> 赞同：1
> 
> 时间：2013-01-15T12:54:17.707
> 
> 标签：html, windows-8, microsoft-metro, windows-server-2012

我需要学习编写 Windows 8“Windows Store”应用程序（以前称为 Metro）。我拥有 Windows Server 2012 的许可证，而不是 Windows 8。问题是，我可以运行和编写 Metro 应用程序（用 HTML 5 编写）在 Windows Server 2012 上？我有可以安装在服务器上的 Visual Studio 2012。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T14:22:20.787

不，你不能。Metro 应用程序仅支持 Windows 8。

您可以安装 SDK [LINK](http://msdn.microsoft.com/en-us/windows/hardware/hh852363.aspx#Requirements)并在模拟器上运行应用程序。

# c - GNU getopt() 的 -W 选项是做什么用的？

> ID：14338223
> 
> 赞同：4
> 
> 时间：2013-01-15T12:54:20.150
> 
> 标签：c, linux, unix, command-line

引用自[POSIX.1-2008 关于**`-W`**option](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html)的描述，

> ( **`-W`**capital-W) 选项应保留给供应商选项。

引用自 Linux 手册页，[GNU getopt 处理**`-W`**选项如下](http://www.kernel.org/doc/man-pages/online/pages/man3/getopt.3.html)：

> 如果***optstring***包含**W**后跟`semicolon`( ; )，则将**`-W foo`**其视为长选项**`--foo`**。（POSIX.2 为实现扩展保留了**-W选项。）**

有人可以以更清晰的方式（直截了当）解释上述句子并解释为什么这样的选项有用吗？

上面的陈述让我感到困惑，因为我认为`getopt`(not `getopt_long`, `getopt_long_only`) 只理解短选项。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T13:08:43.773

查看：[http ://www.gnu.org/software/gnuprologjava/api/gnu/getopt/Getopt.html](http://www.gnu.org/software/gnuprologjava/api/gnu/getopt/Getopt.html)

> 长选项也可以使用特殊的 POSIX 参数格式（我强烈反对）来指定。通过放置“W;”来启用这种输入形式 （是的，'W' 然后是分号）在有效的选项字符串中。这导致 getopt 将“-W”后面的名称视为长选项的名称。例如，“-W outputdir=foo”等同于“--outputdir=foo”。该名称可以紧跟在“-W”之后，如下所示：“-Woutputdir=foo”。选项参数的处理方式与普通长选项相同。如果“-W”后面的字符串不代表有效的长选项，则 getopt() 返回“W”，调用者必须决定要做什么。否则 getopt() 返回一个长选项值，如下所述。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T13:08:53.430

文档有点不清楚，我的解释是关于的部分 `-W`仅适用于`getopt_long()`并且`getopt_long_only()`出于这个原因。

幸运的是，GNU C 库是开源的。:)

在内部，所有这三个函数都是通过调用一个工作函数（`_getopt_internal()`）来实现的，并且处理`-W`是在该函数内部完成的。但是，如果没有可用的长选项定义（从 调用时就是这种情况`getopt()`，它将返回`'W'`.

查看[这个提交](http://sourceware.org/git/?p=glibc.git;a=commitdiff;h=01636b2140cd1281202b89f7103249ed598065c4;hp=9895c8bc62759a2d7abf95654fb2aefe5677a930)，或者直接点击阅读[posix/getopt.c](http://sourceware.org/git/?p=glibc.git;a=blob;f=posix/getopt.c;h=3fa5a4d6d1fd95d5c902d04bf140c750c175c2b5;hb=01636b2140cd1281202b89f7103249ed598065c4)。

# jquery - 获取前一个 div 的元素

> ID：14338224
> 
> 赞同：0
> 
> 时间：2013-01-15T12:54:22.123
> 
> 标签：jquery, html

我有以下代码：

```
 <ul>
    <li id="1">same html structure as below...</li>
    .....
    <li id="42">
    <div class="input-prepend">
       <button class="btn btn-small companyListBtn addMarkerBtn btn-primary btn-warning" type="button">   </button>                                                                                   
       <input class="input-medium companyListInput" maxlength="60" type="text"/>
       <button class="companyListBtn editCompanyBtn" type="button"></button>
    </div>
    <div id="42Div" class="companyAddressDiv">
       <input type="text" id="test" class="companyAddress" placeholder="Enter the Address"/>
       <button  class="btn btn-small compAddressSubmit" style="height:30px;margin-top:-9px;" type="button"></button>
    </div>
    </li>
    </ul> 
```

现在在下面的代码中，我试图更改位于同一列表中的**addMarkerBtn**上的信息.... :(因为有多个具有相同结构的列表)

```
 $(document).on('click','.compAddressSubmit', function () {
    var addMarkerBtn = $(this).prev("div.row").find('.addMarkerBtn');
    //wanna make changes to the addMarkerButton .. something like..
    addMarkerBtn.removeClass('btn-primary btn-warning').addClass('btn-success');
    } 
```

尝试了最接近（），下一个（），但无法让它工作。任何帮助请...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T12:58:14.073

[父母](http://api.jquery.com/parents/)

```
 var addMarkerBtn = $(this).parents("li").find('.addMarkerBtn'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:01:51.947

尝试这个

```
var addMarkerBtn = $(this).parents().eq(2).find('.addMarkerBtn'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T12:57:02.057

~~如果有多个 div 包含`#compAddressSubmit`，则您的文档无效。`id`值**必须**是唯一的。听起来你的按钮`id` `compAddressSubmit`应该把它作为一个类来代替。~~

~~假设您进行了更改，那么：（~~ *我看到您在问题中进行了更改。）*

所以：

```
$(document).on('click','.compAddressSubmit', function () {
    var addMarkerBtn = $(this).closest("div.companyAddressDiv").prev().find('.addMarkerBtn');
    addMarkerBtn.removeClass('btn-primary btn-warning').addClass('btn-success');
} 
```

`$(this).closest("div.companyAddressDiv")`找到`companyAddressDiv`包含按钮。`prev`转到前一个元素（在`div`它上面），然后在该元素中`find(".addMarkerBtn")`找到按钮`div`。

如果结构有可能发生变化，使得 之前的元素`div.companyAddressDiv`不是您想要的，您可以使用`.prevAll("div.input-prepend").first()`它`div`而不是`.prev()`.

# heroku - 如何在 Heroku 之外使用我的新遗物帐户？

> ID：14338225
> 
> 赞同：0
> 
> 时间：2013-01-15T12:54:22.513
> 
> 标签：heroku, newrelic

我已经`New Relic`为托管在 上的 Rails 应用程序配置了一个帐户`Heroku`。现在我想`New Relic`直接访问该站点以设置对未托管在`Heroku`. 问题是它不允许我使用我的电子邮件注册或登录，因为它说我已经使用该电子邮件存在。

我必须创建一个独立帐户`New Relic`吗？有没有办法用同一个帐户管理`Heroku`和非应用程序？`Heroku`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T16:35:34.473

是的，您可以将 Heroku 和非 Heroku 应用程序与 New Relic 一起使用。您最好的选择是在[http://support.newrelic.com](http://support.newrelic.com)上开一张票，他们会帮助您。

设置完成后，您将在登录时登陆非 Heroku 帐户，但随后可以切换到 Heroku 帐户。（您的 Heroku 帐户的链接也将按预期工作。）

# ios - UITextView 内的 iOS 可点击文本

> ID：14338229
> 
> 赞同：7
> 
> 时间：2013-01-15T12:54:39.907
> 
> 标签：ios, objective-c, click, uitextview, hyperlink

有没有办法制作 UITextView 的可点击部分。其实我想让文字像

> 点击上方的“注册”，即表示您同意服务条款和隐私声明

其中服务条款应该是一个链接，而隐私声明应该是另一个链接。通过点击那些我应该做点什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T13:30:11.527

我使用[这个项目用上面的代码做到了](https://github.com/mattt/TTTAttributedLabel)

```
- (void)_configureTermsLabel
{
    self.termsOfUseLabel.hidden = YES;
    self.termsAndConditionsLabel = [[TTTAttributedLabel alloc] initWithFrame:self.termsOfUseLabel.frame];
    self.termsAndConditionsLabel.font = [UIFont systemFontOfSize:14];
    self.termsAndConditionsLabel.lineBreakMode = UILineBreakModeWordWrap;
    self.termsAndConditionsLabel.numberOfLines = 0;

    NSString *termsStr = NSLocalizedString(@"Terms of use", @"Terms of use");
    NSString *privacyStr = NSLocalizedString(@"Privacy Policy", @"Privacy Policy");
    NSString *andStr = NSLocalizedString(@"and", @"and");
    NSString *conductStr = NSLocalizedString(@"Code of conduct", @"Code of conduct");
    NSString *termsAndConditionsStr = [NSString stringWithFormat:@"%@ - %@ %@ %@", termsStr,
                                       privacyStr, andStr, conductStr];
    self.termsAndConditionsLabel.text = termsAndConditionsStr;

    NSString *languageCode = [[GLQAppDelegate sharedDelegate] languageIdentifier];
    NSURL *termsURL = [NSURL URLWithString:[NSString stringWithFormat:kGLQTermsOfUseURL, languageCode]];
    NSURL *privacyURL = [NSURL URLWithString:[NSString stringWithFormat:kGLQPrivacyPolicyURL, languageCode]];
    NSURL *conductURL = [NSURL URLWithString:[NSString stringWithFormat:kGLQCodeOfConductURL, languageCode]];

    NSRange termsRange = [self.termsAndConditionsLabel.text rangeOfString:termsStr];
    NSRange privacyRange = [self.termsAndConditionsLabel.text rangeOfString:privacyStr];
    NSRange conductRange = [self.termsAndConditionsLabel.text rangeOfString:conductStr];

    [self.termsAndConditionsLabel addLinkToURL:termsURL withRange:termsRange];
    [self.termsAndConditionsLabel addLinkToURL:privacyURL withRange:privacyRange];
    [self.termsAndConditionsLabel addLinkToURL:conductURL withRange:conductRange];
    self.termsAndConditionsLabel.delegate = self;

    self.termsAndConditionsLabel.userInteractionEnabled = YES;
    [self.scrollView addSubview:self.termsAndConditionsLabel];
} 
```

# c# - 在最后一个字符前插入一个点

> ID：14338235
> 
> 赞同：1
> 
> 时间：2013-01-15T12:55:05.803
> 
> 标签：c#, string-formatting

是否可以从`int a = 456;`使用 string.Format 中获取类似“45.6”的字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T12:59:06.140

数学运算在不同的文化中可能会产生不同的结果。你可能会得到`,`而不是`.`. 尝试这个

```
var aStr = a.ToString();
var res = aStr.Insert(aStr.Length - 1, ".") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T13:03:53.490

除以 10（作为两倍）。

您还需要考虑当前的文化。要始终获得一个点，请使用`InvariantCulture`.

为避免浮点不精确问题（例如 45 -> 4.49999999），请确保通过指定“0.0”格式仅打印第一个数字。

```
int i = 123;
var s = String.Format (CultureInfo.InvariantCulture, "{0:0.0}", i / 10.0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:19:47.720

```
 int a = 456;
        String aString = String.Format("{0}{1}{2}", a / 10, ".", a % 10); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T13:25:21.670

```
Int32 a = 456;

String aString = a.ToString();
aString = aString.Insert((aString.Length - 1), ".") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T13:14:50.053

您可以使用 IFormatProvider 来实现。（可以定制成任何格式）

```
int val = 456;  
string s = string.Format(new CustomerFormatter(),"{0:1d}", val);
string s1 = string.Format(new CustomerFormatter(), "{0:2d}", val);
Console.WriteLine(s); //45.6
Console.WriteLine(s1); //4.56

 public class CustomerFormatter : IFormatProvider, ICustomFormatter
{
    public object GetFormat(Type formatType)
    {
        if (formatType == typeof(ICustomFormatter))
            return this;
        else
            return null;
    }

    public string Format(string format, object arg, IFormatProvider formatProvider)
    {
        if (!this.Equals(formatProvider))
        {
            return null;
        }
        else
        {
            string customerString = arg.ToString();
             switch (format)
            {
                case "1d":
                    return customerString.Insert(customerString.Length - 1, ".");
                case "2d":
                    return customerString.Insert(customerString.Length - 2, ".");

                default:
                    return customerString;
            }
        }
    }
} 
```

# php - php中的智能差异

> ID：14338236
> 
> 赞同：0
> 
> 时间：2013-01-15T12:55:07.563
> 
> 标签：php, algorithm, comparison, diff, configuration-files

我正在用 php 编写智能差异。这将用于比较两个文件，其内容是两个时间段的路由器配置。作为输出，我需要对差异进行彩色突出显示，或者如果它在不同的位置（行）。

例如输入一：

> 185.255.0.0/26是子网，**1个**子网
> 172.16.0.0/16是直连，Vlan **50**

输入二：

> 185.255.0.0/26是子网，**15个**子网
> 172.16.0.0/16是直连，Vlan **5**

现在我可以通过计算列文森距离矩阵来愚蠢地识别线条是否相同或相似。你能告诉我任何其他可以帮助 mi 解决突出差异的算法吗？我可能需要类似的算法，例如在颠覆中使用或在总指挥官中进行比较。你能告诉我在哪里可以看吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:19:51.970

如果添加或删除实际行，可能不是最有效的方法并且非常有限（您需要一些方法来检测它，有多种方法可以做到这一点（参见 Waleed Khan 评论中的链接））。

但是，如果您首先检查总字符串以查看它是否不同，该怎么办。如果不同，您可以将总字符串（源和目标）拆分为标记并比较各个标记。这样你就可以准确地告诉（并突出显示）总字符串的哪一部分不同。

# ruby-on-rails - 添加自定义用户角色 spree 1.3.1

> ID：14338237
> 
> 赞同：0
> 
> 时间：2013-01-15T12:55:08.843
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.1, ruby-on-rails-3.2, spree

我正在使用**spree 1.3.1**和**Devise gem**进行身份验证，我需要添加一个名为“**合作伙伴”的用户****角色**，他可以在管理区域查看订单，但不能创建/编辑/更新/删除任何订单。

 **提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:45:17.373

有`app/models/partner_ability.rb`档案。

然后对角色使用以下基于角色的`read`权限`partner`-

```
class PartnerAbility
  include CanCan::Ability

  def initialize(user)
    user ||= User.new
    if user.has_role? "partner"
      can :read, Product
    end
  end
end 
```

在此之后还要添加以下内容 `config/initializers/spree.rb`-

```
Ability.register_ability(PartnerAbility) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-25T12:40:27.950

```
In db/seed.rb file we can directly add admin user in spree..

for example 

puts 'SETTING UP DEFAULT USER LOGIN'

user1 = User.create! :title => 'Mr', :first_name => 'Jack', :last_name => 'Jackson', :email => 'jack@g.com', :password => '123qwe', :password_confirmation => '123qwe', :phone => '123452345'
puts 'New user created: ' << user1.first_name

user2 = User.create! :title => 'Mr', :first_name => 'Sev', :last_name => 'Raj', :email => 'sa@g.com', :password => '123qwe', :password_confirmation => '123qwe', :phone => '123452345'
puts 'New user created: ' << user2.first_name

puts 'New user created: ' << user4.first_name

user2.add_role :admin 
```**

# java - 不明白如何使用 Drive API

> ID：14338238
> 
> 赞同：0
> 
> 时间：2013-01-15T12:55:11.403
> 
> 标签：java, android, google-drive-api

我正在尝试在我们的应用程序中实现 Google Drive 功能并遇到这样的问题：使用此代码

```
try {
    // File's binary content
    java.io.File fileContent = new java.io.File(Environment.getExternalStorageDirectory() + "/miniclipId.txt");
    FileContent mediaContent = new FileContent("text/plain", fileContent);

    // File's metadata.
    File body = new File();
    body.setTitle(fileContent.getName());
    body.setMimeType("text/plain");

    FileList file = service.files().list().execute();
    if (file != null) {
        //showToast("Photo uploaded: " + file.getTitle());
        //startCameraIntent();
    }
} catch (UserRecoverableAuthIOException e) {
      startActivityForResult(e.getIntent(), REQUEST_AUTHORIZATION);
} catch (IOException e) {
      showToast(e.getMessage());
} 
```

我正在尝试将简单的文本文件发送到 Google 驱动器，但运气不好，我得到了这个例外：

```
{
  "code": 403,
  "errors": [
    {
      "domain": "usageLimits",
      "message": "Access Not Configured",
      "reason": "accessNotConfigured"
    }
  ],
  "message": "Access Not Configured"
} 
```

我在 google API Console 中启用了 Drive API，输入了 SHA1 调试指纹，并且应用程序的包名称与在 API 控制台中输入的完全相同。请问有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-18T12:47:11.490

只需重新注册您的应用程序或删除旧的 Oauth Id 并创建一个新的，您就不会再出现此错误： [https ://cloud.google.com/console#/project](https://cloud.google.com/console#/project)

[https://groups.google.com/forum/#!topic/gs-discussion/9Ri4AwdHqDg](https://groups.google.com/forum/#!topic/gs-discussion/9Ri4AwdHqDg)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-01T11:52:29.123

我在 2 个月前遇到了同样的错误。我的问题是 .android 文件夹有一些损坏的数据（我认为是密钥库），所以我从另一台我正在开发并解决它的 PC 上复制了该文件夹。也许它有帮助......无论如何，如果您没有该文件夹的备份，我将再次创建密钥库并在 API 控制台中输入新证书 SHA1。见[google drive api 错误 403 访问未配置](https://stackoverflow.com/questions/16731196/google-drive-api-error-403-access-not-configured)

# php - 在mac上发送邮件的gmail设置

> ID：14338245
> 
> 赞同：-1
> 
> 时间：2013-01-15T12:55:36.897
> 
> 标签：php, gmail

我正在使用mac OS雪豹，我有邮件问题，我不确定它是关于gmail还是php mail() func。它不工作。我是这样写的（只是为了测试）。

```
mail('something@example.com', 'My Subject', 'My Message'); 
```

我完成了 * 我需要使用后缀配置，但它不起作用（无法获取邮件）。任何帮助，只需要解释事情是如何工作的。我在谷歌上搜索了 3-4 个小时，但什么也没有（没有找到正确的答案）。是的，我正在使用本地服务器。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:02:55.303

只是一个提示 - 如果某些东西不起作用，请在指责 gmail 或 php 函数之前尝试找出代码的问题。这些已经过数百万人在现场环境中的测试和重新测试。

您是否安装并配置了邮件服务器？您是否启用了 Apache sendmail？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T12:58:42.730

如果您的应用程序托管在本地主机中，则邮件将无法发送。上传到实时服务器并检查它。（您需要一个邮件服务器来发送邮件）

# android - Android：是否可以使用 openFileOutput 函数创建媒体文件

> ID：14338248
> 
> 赞同：2
> 
> 时间：2013-01-15T12:55:53.400
> 
> 标签：android, file

我创建了文件，即 txt 文件并使用 openFileOutput fn 将值存储到其中。此函数在 data/data/app_name/files 文件夹中创建 txt 文件。现在我正在尝试将 .mp3 文件等媒体文件保存到该 data/data/app-name 文件夹中。是否可以这样做？

提前致谢。

```
fOut = openFileOutput("a.txt", MODE_PRIVATE);

                    OutputStreamWriter osw = new OutputStreamWriter(fOut);

                    String aa="hi";

                    osw.write(aa);

                    osw.flush();
                    osw.close(); 
```

这就是我将文件写入数据/数据/应用程序名称文件夹的方式.. Nw 我正在尝试编写一个 mp3 文件，但 osw.write(aa) 接受字符串或字符数组..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:06:04.020

`Context.openFileOutput()`([参考](http://developer.android.com/reference/android/content/Context.html#openFileOutput%28java.lang.String,%20int%29)) 创建一个`FileOutputStream`能够写入二进制数据的对象（参见[write()](http://developer.android.com/reference/java/io/FileOutputStream.html#write%28byte%5B%5D,%20int,%20int%29)方法），所以答案是肯定的，它可以用来写入媒体文件。

# c# - sitecore 缩短网址似乎不起作用

> ID：14338250
> 
> 赞同：2
> 
> 时间：2013-01-15T12:55:58.073
> 
> 标签：c#, sitecore

我正在尝试缩短我公司使用 sitecore 开发的网站的网址。我一直在这里查看 Alex Shyba 的博客文章[和](http://sdn.sitecore.net/upload/sitecore6/sc62keywords/dynamic_links_sc62_a4.pdf)[此处](http://sitecoreblog.alexshyba.com/2012/02/have-sitecorecontent-in-your-link-time.html)的Sitecore 文档，但它似乎不起作用。我想缩短的是从到`localhost:8081/sitecore/Content/Sites/HeinzABCID/Dapur.aspx``localhost:8081/Dapur.aspx`

该网址是由`LinkManager.GetItemUrl()`方法生成的。我的代码如下所示以获取选项和链接。

```
UrlOptions opt = (UrlOptions)UrlOptions.DefaultOptions.Clone();
opt.SiteResolving = Sitecore.Configuration.Settings.Rendering.SiteResolving;
linkToResep.NavigateUrl = LinkManager.GetItemUrl(citem, opt); 
```

在我的配置中，`web.config`我已经将配置如下。

```
<linkManager defaultProvider="sitecore">
  <providers>
    <clear/>
    <add name="sitecore" type="Sitecore.Links.LinkProvider, Sitecore.Kernel"
         addAspxExtension="true"
         alwaysIncludeServerUrl="false"
         encodeNames="true"
         languageEmbedding="asNeeded"
         languageLocation="filePath"
         shortenUrls="true"
         useDisplayName="true"/>
  </providers>
</linkManager> 
```

我的 web.config 中的`configuration/sitecore/sites/site`with`name="website"`部分如下。

```
<site name="website" virtualFolder="/" physicalFolder="/" rootPath="/sitecore/Content/Sites/HeinzABCID" startItem="/Home" database="web" domain="extranet" allowDebug="true" cacheHtml="true" htmlCacheSize="10MB" registryCacheSize="0" viewStateCacheSize="0" xslCacheSize="5MB" filteredItemsCacheSize="2MB" enablePreview="true" enableWebEdit="true" enableDebugger="true" language="en" disableClientData="false"/> 
```

我没有任何其他站点，只有默认站点（shell、登录、管理员、服务、modules_shell 和 modules_website）。

这是我网站的网站结构。

```
/sitecore/content/sites
    +Sites
    +---+HeinzABCID
        +---+Dapur
            +Search
            +Other Items 
```

请帮我 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-04-22T07:22:30.530

我遇到了类似的问题，/sitecore/content/site 出现在我的 URL 中。

就我而言，这是错误的站点上下文 - 运行 sitecore shell 上下文而不是网站上下文。这是用于切换的代码：

```
// Store the current site context name
string oldSiteName = Sitecore.Context.GetSiteName();

// Change the website context
Sitecore.Context.SetActiveSite("website");

// Generate the link
string url = LinkManager.GetItemUrl(item);

// Change back to the old site context
Sitecore.Context.SetActiveSite(oldSiteName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T20:11:00.523

看起来您的站点配置不正确。根据您的 Sitecore 树，我认为应该是：

```
<site name="website" virtualFolder="/" physicalFolder="/" rootPath="/sitecore/Content/Sites" startItem="/HeinzABCID" database="web" domain="extranet" allowDebug="true" cacheHtml="true" htmlCacheSize="10MB" registryCacheSize="0" viewStateCacheSize="0" xslCacheSize="5MB" filteredItemsCacheSize="2MB" enablePreview="true" enableWebEdit="true" enableDebugger="true" language="en" disableClientData="false"/> 
```

您可能还想查看 Sitecore SDN 上的这篇文章，以在单个 Sitecore 实例中配置多个站点： [Sitecore SDN：配置多个站点](http://sdn.sitecore.net/Articles/Administration/Configuring%20Multiple%20Sites/Configuring%20Sites%20in%20web,-d-,config%20File.aspx)

根据本文档，URL 将相对于您的“网站”站点标签中定义的“startItem”创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-31T18:08:22.963

使用正则表达式替换我成功地缩短了 URL。我还可以设法在多个站点上使用它。

```
public static string ShortenURL(string URLToShorten)
{
    return Regex.Replace(URLToShorten,@"sitecore/content/sites/[\w]{1,}/","");
} 
```

可以在[此处](http://adityayedija.wordpress.com/2013/03/31/sitecore-shortening-url-for-your-seo-sake/)找到包含 SEO 的解决方案的完整描述。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-02T06:19:30.027

It may also help if your site definition has a targethostname defined.

# c# - 应用程序中的自定义字体

> ID：14338251
> 
> 赞同：0
> 
> 时间：2013-01-15T12:55:58.533
> 
> 标签：c#, c++, xna, windows-phone-8, monogame

在我的应用程序中，我想添加使用自定义字体的功能。

用户从我的服务器上的列表中选择字体，下载并在应用程序中使用。

如何执行将呈现字体的应用程序部分？如何在不使用 xaml 的应用程序中执行此操作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T22:46:29.763

您即将开始的任务可能会涉及大量代码，因为字体中的字符需要先渲染到纹理，然后才能渲染为 SpriteBatch 的一部分。

通常，这通过内容管道在 XNA 中起作用。您选择一个字体文件并在 XML 中设置字体属性，然后内容内容管道将此信息编译为可以加载和呈现的 xnb 资源。问题是，这一切都发生在编译时，因此在运行时很难做到。

参考：[http ://rbwhitaker.wikidot.com/drawing-text-with-spritefonts](http://rbwhitaker.wikidot.com/drawing-text-with-spritefonts)

另一种方法是使用 BMFont 之类的工具将字体预渲染到纹理并编写自己的渲染器。我曾经使用这种技术写过一个教程。然而，这几乎是一样的，只是您用 BMFont 工具替换了 XNA 内容管道。

[http://www.craftworkgames.com/blog/tutorial-bmfont-rendering-with-monogame/](http://www.craftworkgames.com/blog/tutorial-bmfont-rendering-with-monogame/)

考虑到这一点，如果您想实现这一点，您可能需要编写自己的代码，以便在运行时加载每种字体后将其渲染为纹理。在加载字体时，您还需要跟踪纹理上每个字形的矩形。为了节省纹理空间并支持更大的字体大小，您可能还需要考虑纹理打包和排除某些字符。

# ios - 点击 MKPolygonView

> ID：14338252
> 
> 赞同：1
> 
> 时间：2013-01-15T12:56:00.217
> 
> 标签：ios, objective-c, mkmapview

我已经`MKPolygonView's`在`MKMapkView`. 现在我想识别何时在地图上触摸了多边形。还要用其他颜色标记那个多边形。

我有一个解决方案可以使用 longpress 处理程序来做到这一点。这不是最好的解决方案。

还有另一种简单的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T12:59:00.457

是的，使用 UILongPressGestureRecogniger，所有手势识别器都易于使用。

# linq - Linq 2 SQL 左加入单声道

> ID：14338254
> 
> 赞同：0
> 
> 时间：2013-01-15T12:56:08.670
> 
> 标签：linq, linq-to-sql, mono

我无法在 Mono 中获得休闲请求：没有加入它会起作用。当我只选择 t1 它也可以工作，但我不能从两个表中选择一些东西。我想我想要一个左连接，我总是在 t1 中有条目，如果 NameOfFile 与 FileName 匹配，那么我想要加入表。

额外问题：我的查询何时执行？当我运行 foreach 循环时？

```
var result = (
            from t1 in db.Table1 
            join t2 in db.Table2 on t1.FileName equals t2.NameOfFile
            into joinDep                
            from t3 in joinDep.DefaultIfEmpty () 
            select new 
            {
            Time = t1.WriteTime,
            Name = t2.NameOfFile

            }
        )
        .OrderByDescending (c => c.Time.Date)
        .Take (10);
foreach (var entry in result)
{
    Console.WriteLine (entry.Name );
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:01:17.877

用这个：

```
var query = from t1 in db.Table1 
            join t2 in db.Table2 on t1.FileName equals t2.NameOfFile into gj
            from joinDep in gj.DefaultIfEmpty ()
            select new 
            {
               Time = t1.WriteTime,
               Name = joinDep.NameOfFile
            };

var result = query.OrderByDescending (c => c.Time.Date)
                .Take (10); 
```

是的。`Take`使用延迟执行。

# entity-framework - EF5 迁移更新-数据库-脚本错误

> ID：14338257
> 
> 赞同：43
> 
> 时间：2013-01-15T12:56:19.640
> 
> 标签：entity-framework, entity-framework-5, entity-framework-migrations

我一直在使用带有试用许可证的 Visual Studio 2012 RC，没有任何问题。我昨天购买了 Visual Studio 2012 Professional，安装了最新版本，并安装了 Update 1。

我有一个多年来一直在研究的解决方案/项目。它有许多迁移。我在这个最新版本中运行了我的第一个版本`add-migration TableX_NewField`。`update-database -sourcemigration:TableX_PreviousNewField`

他们俩都跑得没有问题。

然后我跑了`update-database -script -sourcemigration:TableX_PreviousNewField`，收到以下信息：

```
PM> update-database -script -sourcemigration:TableX_PreviousNewField
Applying code-based migrations: [201301151003149_TableX_NewField].
Applying code-based migration: 201301151003149_TableX_NewField.
System.Runtime.InteropServices.COMException (0x8004000C): User canceled out of save dialog (Exception from HRESULT: 0x8004000C (OLE_E_PROMPTSAVECANCELLED))
  at EnvDTE.ItemOperations.OpenFile(String FileName, String ViewKind)
  at System.Data.Entity.Migrations.Utilities.DomainDispatcher.OpenFile(String fileName)
  at System.Data.Entity.Migrations.Utilities.DomainDispatcher.OpenFile(String fileName)
  at System.Data.Entity.Migrations.Extensions.ProjectExtensions.NewSqlFile(Project project, String contents)
  at System.Data.Entity.Migrations.UpdateDatabaseCommand.<>c__DisplayClass2.<.ctor>b__0()
  at System.Data.Entity.Migrations.MigrationsDomainCommand.Execute(Action command)
User canceled out of save dialog (Exception from HRESULT: 0x8004000C (OLE_E_PROMPTSAVECANCELLED)) 
```

我已经运行了 Windows 更新。使用 NuGet 检查更新。重新启动了我的电脑。还是有错误。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-02-05T22:15:05.450

我注意到在 Visual Studio 中，转到 SQL 菜单、Transact-SQL 编辑器、新查询...给出了一个对话框，说明工具无法与安装的服务器一起使用。安装 SQL Server Data Tools - 2012 年 12 月更新（[Sql Server Data Tools](http://msdn.microsoft.com/en-us/jj650015)）修复了问题

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T19:08:44.730

此问题已解决。我卸载然后安装，问题没有解决。然后我同时做了两件事；所以我不知道哪个解决了这个问题：

1.  已删除 %temp% 中的所有文件夹和文件。
2.  跑 devenv /resetsettings。

希望这可以帮助遇到类似问题的任何人。

# delphi - firemonkey中的自定义网格

> ID：14338262
> 
> 赞同：1
> 
> 时间：2013-01-15T12:56:43.543
> 
> 标签：delphi, firemonkey, delphi-xe3

我们正在将当前的 vcl 应用程序合并到 Firemonkey。当前最大的问题是创建一个带有一些自定义列的 tgrid。

我需要一个包含组合框单元格的列，以及每个单元格中包含多个复选框的列。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:25:24.353

看看我的帖子[http://monkeystyler.com/blog/entry/firemonkey-grid-basics-custom-cells-and-columns](http://monkeystyler.com/blog/entry/firemonkey-grid-basics-custom-cells-and-columns)，它解释了 FireMonkey 网格的基础知识以及如何创建自定义列。

这是另一篇使用泛型为任何组件类创建列的帖子[http://monkeystyler.com/blog/entry/a-firemonkey-grid-column-for-any-control](http://monkeystyler.com/blog/entry/a-firemonkey-grid-column-for-any-control)

使用第二种方法，使用多个复选框创建一个组件，然后创建一个使用它的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-03T13:48:23.833

**任何覆盖 TColumn 类的 CreateCellControl 方法的解决方案都不再起作用**。新的 API 提供了一个名为 TGridModel 的类，它通过 OnCreateCustomEditor 事件允许您动态创建网格单元格的编辑组件。但是我仍然找不到使用此方法的任何示例。

```
procedure TForm1.MyOnCreateCustomEditor(Sender: TObject; const Column: TColumn; var Control: TStyledControl);
var
  idx: Integer;
begin
  idx := Column.Model.IndexOfColumn(Column);
  case idx of
    // Create controls here
  end;
end;

procedure TForm1.OnCreate(Sender: TObject);
begin
  inherited;
  Grid1.Model.OnCreateCustomEditor := MyOnCreateCustomEditor;
end; 
```

# image-processing - 在 windows phone 中检测文档的边缘

> ID：14338264
> 
> 赞同：1
> 
> 时间：2013-01-15T12:56:52.580
> 
> 标签：image-processing, windows-phone, edge-detection

我需要在 Windows Phone 7 的捕获图像中检测文档的角/边缘。我不能使用 openCV，因为 WP 7 不支持本机代码库。

任何人都可以建议我一些可以用于此目的的算法或开源库。

我想在另一个 SO 问题中发布的 Windows Phone 应用程序上做类似的事情：[DETECT the Edge of a Document in iPhoneSDK](https://stackoverflow.com/questions/8921256/detect-the-edge-of-a-document-in-iphonesdk)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:51:48.980

您可以尝试使用 A-Forge 来完成此任务。A-forge .NET 具有强大的功能，我认为在 windows phone 上使用它不会有问题

# django - 在 Django 请求时动态控制缓存最大年龄

> ID：14338271
> 
> 赞同：1
> 
> 时间：2013-01-15T12:57:03.197
> 
> 标签：django, cache-control

在 Django 中，我可以使用类似这样的东西来管理请求[的缓存最大年龄：](https://docs.djangoproject.com/en/1.0/topics/cache/#controlling-cache-using-other-headers)

```
from django.views.decorators.cache import cache_control

@cache_control(max_age=3600)
def my_view(request):
    # ... 
```

如何在视图函数中设置不同的*值*`max_age`，以便它可以取决于内容是什么？*`request`*

 *例子：

```
def my_view(request):
    if is_good_to_cache(request):
        # set max_age to 36000
    else:
        # set max_age to 42 
    # ... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T14:28:23.827

就像[利用](https://github.com/django/django/blob/master/django/views/decorators/cache.py#L34)[internal](https://github.com/django/django/blob/master/django/views/decorators/cache.py#L34)`cache_control`一样，直接放：[`patch_cache_control`](https://github.com/django/django/blob/master/django/views/decorators/cache.py#L34)

```
from django.utils.cache import patch_cache_control

def my_view(request):
    if is_good_to_cache(request):
        max_age = 36000
    else:
        max_age = 42 
    resp = render(...)
    patch_cache_control(resp, max_age=max_age)
    return resp 
```*

# inno-setup - 如何更改自定义页面上的下一步/取消按钮标题？

> ID：14338282
> 
> 赞同：6
> 
> 时间：2013-01-15T12:57:39.610
> 
> 标签：inno-setup

如何更改自定义页面上的下一步/取消按钮标题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T13:07:29.943

您可以使用：

```
procedure CurPageChanged(CurPageID: Integer);
begin
  if CurPageID = YourPageName.ID then begin
    WizardForm.NextButton.Caption := SetupMessage(msgButtonInstall);  
//or := 'YourNewNextButtonText' or := ExpandConstant('{cm:YourCmTitleForNext}')
    WizardForm.CancelButton.Caption := ExpandConstant('{cm:YourCmTitleForCancel}');
  end; //begin + end to make changes only for this single page
end; 
```

# api - Eclipse 中的 IProject.setDescription 使用什么设计模式

> ID：14338286
> 
> 赞同：5
> 
> 时间：2013-01-15T12:57:59.317
> 
> 标签：api, design-patterns

我正在设计一个具有特定模式的 API，但不知道该模式是否有名称。它类似于 GoF（四人组）中的命令模式，但不完全一样。

我可以找到的一个简单示例是在 Eclipse 中，您可以在其中操作项目 ( `IProject`)，而不是通过调用项目上更改其状态的方法，而是通过以下 3 步过程：

1.  *将其状态提取*到描述符对象 ( `IProjectDescription`) 中`getDescription`
2.  *在描述符上设置*属性。例如`setName`
3.  *将*描述符应用回原始项目`setDescription`

一般原则似乎是你有一个复杂的对象作为具有许多潜在相互依赖的属性的框架的一部分，而不是直接处理该对象，一次一个属性，你将属性提取到一个简单的数据对象中，操纵它, 并将其应用回来。

它具有命令模式的一些属性，因为数据对象像命令一样封装了所有更改 - 但它不是真正的命令，因为您不会在对象上*执行*它，它只是表示对象的状态。

它还具有事务 API 的一些属性，通过`set...`调用一次完成所有更改，如果任何一个属性更改失败，您允许整个修改有效地“回滚”。但是，虽然这是该方法的一个优势，但这并不是它的真正主要目的。更重要的是，您可以在没有这种方法的情况下实现事务性质，只需将事务方法添加到 API（如`commit`和`rollback`）

我确实想利用这种模式有两个优点 - 尽管我没有看到它们被上面的 eclipse 示例利用：

1.  您可以在底层对象的实现发生变化时表示其有意义的状态。这对于升级或从不同类型的表示复制状态很有用。假设我发布了一个新版本的 API，我在其中创建了一个对象 Foo2，它是我的旧 Foo1 的全新形式，但两者具有相同的基本属性。要将 Foo1 升级为 Foo2，我可以将这些属性提取为 FooState。foo2.setFooState(foo1.getFooState) 就这么简单。解释和表示属性的方式封装在 Foos 中，并且可以完全不同。

2.  我可以使用我的简单数据对象来持久化和传输底层对象的状态，而持久化对象本身会复杂得多。因此，我可以将 Foo 的状态提取为 FooState，并将其作为简单的 XML 文档保存，然后通过“加载”并应用它来将其应用到某个新对象。或者我可以将 FooState 作为 JSON 对象简单地传输到 Web 服务，而 Foo 本身太大且太复杂而无法传输。（或者服务调用两端的对象完全不同，比如Foo1和Foo2）

无论如何，我在任何地方都找不到这种模式的名称或示例，无论是在[四人组设计模式](http://en.wikipedia.org/wiki/Design_Patterns)中，还是在 Martin Fowler 的[综合“bliki”中](http://martinfowler.com/tags/API%20design.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T01:04:13.097

Martin Fowler 在他[的《企业应用程序架构原理》一书中描述的](http://www.martinfowler.com/books/eaa.html)[数据传输对象](http://martinfowler.com/eaaCatalog/dataTransferObject.html)(DTO)似乎是为了您在第 2 点中描述的目的。

DTO 是对它所代表的更复杂的领域模型的相当简单的提取。

Fowler 描述了将 DTO 与汇编器结合使用可以使 DTO 独立于它应该表示的实际域对象（或对象）。汇编器知道如何从域对象创建 DTO，反之亦然。他还提到 DTO 需要可序列化以保持/传输其状态。您在第 2 点中描述的内容似乎与此描述相符。

您在第 1 点中描述的内容似乎不是预期目的，但使用此模式似乎绝对可以实现。

我不确定您是否浏览了他的书的 Pattern 目录或书本身。本书本身更详细地描述了这一点。

您可能还想查看来自 Oracle 的[传输对象](http://www.oracle.com/technetwork/java/transferobject-139757.html)定义，Fowler 在这里说[这](http://martinfowler.com/bliki/ValueObject.html)就是他所描述的 DTO。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-25T14:08:50.610

并非每个设计都记录为单个设计模式，实际上大多数系统设计都是多种模式的组合。

但是，您正在做的其中一部分是使用 IProjectDescription 使用[Memento](http://en.wikipedia.org/wiki/Memento_pattern)，但是您的似乎是多态变体。将出现在模式目录中的模式视为基本起点而不是最终结果。模式在本质上应该被扩展和组合。

[命令模式](http://en.wikipedia.org/wiki/Command_pattern)可以为您提供Commit 和 RollBack（Do/Undo），并以这种方式将其与 Memento 结合是一种非常常见的方法。在带有 HttpRequest 和 HttpResponse 的 Java Servlet API 中也可以看到同样的情况。

# django - Django 翻译返回相同的字符串

> ID：14338287
> 
> 赞同：1
> 
> 时间：2013-01-15T12:58:01.610
> 
> 标签：django, internationalization, gettext

我正在建立一个新的小项目来尝试在 Django 1.4.3（英语和荷兰语）中使用 i18n。但我认为我错过了一步，因为它没有翻译字符串。

谁能告诉我我需要做什么才能获得翻译后的字符串？我该如何调试？

**设置.py**：

```
gettext = lambda s: s
LANGUAGES = (
  ('nl', gettext('Dutch')),
  ('en', gettext('English')),
)

LOCALE_PATH= (
  '/var/www/test/locale',
)
# django.middleware.locale.LocaleMiddleware is also included @ MIDDLEWARE_CLASSES 
```

**urls.py**文件：

```
urlpatterns = i18n_patterns('',
    #home
    url(r'^$','bday.views.home',name="index"),
) 
```

**项目中的views.py**：

```
from django.utils.translation import ugettext as _
def home(request):
  text=_("Welcome!")
  return HttpResponse("LANG[{}], TEXT[{}]".format( request.LANGUAGE_CODE, text ) ) 
```

/var/www/test/locale/ **nl** /LC_MESSAGES/django. **宝**

```
#: bday/views.py:16
msgid "Welcome!"
msgstr "Welkon in Nederlands" 
```

/var/www/test/locale/ **en** /LC_MESSAGES/django. **宝**

```
#: bday/views.py:16
msgid "Welcome!"
msgstr "Welcome in English" 
```

消息确实被编译，我得到：

```
./manage.py compilemessages
processing file django.po in /var/www/test/locale/nl/LC_MESSAGES
processing file django.po in /var/www/test/locale/en/LC_MESSAGES 
```

但在我的应用程序中，我得到：

```
$ curl "http://www.host.com:8000/nl/" 
LANG[nl], TEXT[Welcome!]
$ curl "http://www.host.com:8000/en/" 
LANG[en], TEXT[Welcome!] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:00:25.003

你设置了LOCALE_PATHS[吗](https://docs.djangoproject.com/en/1.4/ref/settings/#locale-paths)`settings.py`？

这仅适用于您在项目目录中有翻译的情况。

# mdx - 在哪里可以找到 MDX 解释器？

> ID：14338289
> 
> 赞同：-1
> 
> 时间：2013-01-15T12:58:02.277
> 
> 标签：mdx, multidimensional-array

我想学习一些多维表达式查询语言。我已经找到了足够的理论信息。现在，我想要一个地方来编写和测试我自己的查询。

在哪里可以找到 MDX 解释器？是可下载的还是在线可用的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T00:43:37.700

您可以在 MDX 模式下使用[Saiku 演示。](http://demo.analytical-labs.com/)它加载了常见的 Foodmart 2000 示例数据仓库，可为您提供大量分析场景供您使用。这是开源 Mondrian OLAP 引擎的开源前端。

要启用 MDX 模式，请从下拉列表中选择一个 Cube，然后按![MDX 模式](../Images/d307f63a68b009b5334d0988c1a411e2.png)图标。

# c# - WCF 服务缓存所有请求

> ID：14338294
> 
> 赞同：2
> 
> 时间：2013-01-15T12:58:23.777
> 
> 标签：c#, .net, wcf

我正在尝试编写 WCF 服务，其中一种方法将捕获所有请求。计划将其托管在独立的可执行文件中。这是合同：

```
[ServiceContract]
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single, ConcurrencyMode = ConcurrencyMode.Multiple, AddressFilterMode = AddressFilterMode.Any)]
public class Proxy
{
    [WebInvoke(UriTemplate = "*", Method = "*")]
    public string Test(Stream input)
    {
        return "Test";
    }
} 
```

这是托管代码：

```
static void Main(string[] args)
{
    var uri = new Uri("http://localhost:2535/");
    var binding = new WebHttpBinding();

    var host = new ServiceHost(new Proxy(), uri);
    host.AddServiceEndpoint(typeof(Proxy), binding, uri);
    host.Open();
    Console.ReadKey();
} 
```

但是，当我将浏览器指向时，`localhost:2535`我只会看到有关服务的信息以及未启用元数据的事实。当我得到类似`localhost:2535/bla-bla-bla/`错误的东西时：

> 由于 EndpointDispatcher 的 ContractFilter 不匹配，接收方无法处理带有 Action '' 的消息。这可能是因为合约不匹配（发送方和接收方之间的操作不匹配）或发送方和接收方之间的绑定/安全不匹配。检查发送方和接收方是否具有相同的合同和相同的绑定（包括安全要求，例如消息、传输、无）。

坦率地说，我不明白我错过了什么......非常感谢帮助我回到正确的轨道上。

**编辑：**通过向端点显式添加`WebHttpBehavior`行为来解决。结果代码变为：

```
static void Main(string[] args)
{
    var uri = new Uri("http://localhost:2535/");
    var binding = new WebHttpBinding();

    var host = new ServiceHost(new Proxy(), uri);
    host.AddServiceEndpoint(typeof(Proxy), binding, uri).Behaviors.Add(new WebHttpBehavior());
    host.Open();
    Console.ReadKey();
} 
```

我仍在寻找更详细的解释为什么它会以这种方式工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:09:42.013

尝试添加到您的端点的行为 WebHttpBehavior，像这样

```
host.AddServiceEndpoint(typeof(Proxy), binding, uri).Behaviours.Add(new WebHttpBehavior()); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:17:15.837

`ServiceContract`您的属性直接在实现您的服务的类上定义，这看起来有点奇怪。通常你会在定义服务的接口上定义它。此处示例：-
[MSDN ServiceContractAttribute](http://msdn.microsoft.com/en-us/library/system.servicemodel.servicecontractattribute.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T14:57:06.657

要启用元数据交换，您需要`ServiceMetadataBehavior`像这样添加

```
ServiceMetadataBehavior serviceBehaviour = new ServiceMetadataBehavior() { HttpGetEnabled = true, HttpGetUrl = new Uri(String.Format("{0}/mex", endpointUrl)) }; 
Host.Description.Behaviors.Add(serviceBehaviour); 
```

然后使用 localhost:2535/mex 检索服务元数据。如果成功，请查看您的 Test 方法是否包含在元数据中。如果失败，请尝试配置[WCF 跟踪](http://msdn.microsoft.com/en-us/library/ms733025.aspx)以获取更详细和用户友好的错误消息。还要确保你用 OperationContract 属性标记了你的方法。

希望能帮助到你。

# .htaccess - HTTP Basic Auth 仅适用于特定路径

> ID：14338304
> 
> 赞同：2
> 
> 时间：2013-01-15T12:59:11.747
> 
> 标签：.htaccess, authentication, wshttpbinding

我想限制对特定路径使用 HTTP Basic Auth 的访问，以便有人访问`/foo/bar`时会收到身份验证表单提示，但不会提示`/(.*)`。

我使用`mod_rewrite`所以我不能像往常那样把`.htaccess`一个文件夹放在里面。

# java - 如何从 OpenCms 中的 CmsResource 获取上次发布日期

> ID：14338306
> 
> 赞同：1
> 
> 时间：2013-01-15T12:59:19.610
> 
> 标签：java, opencms

我无法获得资源的最后发布日期。OpenCms API 无法做到这一点。 [http://files.opencms.org/javadoc/core/org/opencms/file/CmsResource.html](http://files.opencms.org/javadoc/core/org/opencms/file/CmsResource.html)

这很奇怪，它必须存储在某个地方，因为 OpenCms Workplace 在 History 选项中显示此信息。

![OpenCms Workplace 中资源的历史](../Images/0f0eef8a590005fd9a2b560f2e81c627.png)

CmsResource 类中的方法 getDateReleased() 始终返回 DATE_RELEASED_DEFAULT，直到您设置资源的可用性。

有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T12:46:29.710

最后，我通过挖掘 OpenCms 的源代码来实现这一点。我在 getListItems 方法中找到了解决方案：

[https://github.com/alkacon/opencms-core/blob/branch_8_5_x/src/org/opencms/workplace/commons/CmsHistoryList.java](https://github.com/alkacon/opencms-core/blob/branch_8_5_x/src/org/opencms/workplace/commons/CmsHistoryList.java)

所以我构建了这个方法来从任何资源中获取最后发布的日期：

```
public static Date getLastPublishedDate(CmsJspActionElement cms, CmsResource resource) throws Exception {
    CmsObject cmso = cms.getCmsObject();
    String sitePath = cmso.getSitePath(resource);

    if (cmso.readAllAvailableVersions(sitePath).size() > 0) {
        I_CmsHistoryResource histRes = cmso.readAllAvailableVersions(sitePath).get(0);
        int publishTag = histRes.getPublishTag();
        CmsHistoryProject project = cmso.readHistoryProject(publishTag);            
        return new Date(project.getPublishingDate());                                   
    } else {
        return null;
    }   
} 
```

如果返回 NULL，则资源尚未发布。

# javascript - 在javascript中获取文本框onchange的值

> ID：14338307
> 
> 赞同：2
> 
> 时间：2013-01-15T12:59:23.683
> 
> 标签：javascript, jquery

```
<!DOCTYPE html>
<html>
<head>
  <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5/jquery.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
  <style type="text/css">
    #slider { margin: 10px; }
  </style>
 <input type="text" value="" id="rateToPost"/>
<script type="text/javascript">
     var my = document.getElementById("rateToPost").onchange();
     alert(my);
</script>
  <div style="width:75px;height:48px;">
  <div style="width: 5px;margin-left: 10px;">1</div>
  <div style="width: 5px;margin-left: 38px;margin-top: -10px;">2</div>
  <div style="width: 5px;margin-left: 70px;margin-top: -13px;">3</div>
  <div style="width: 5px;margin-left: 98px;margin-top: -12px;">4</div>
  <div style="width: 5px;margin-left: 124px;margin-top: -12px;">5</div>
  </div>

  <script>
  $(document).ready(function() {
    $("#slider").slider({
                range: "min",
                value: 2,
                min: 1,
                max: 5,
    //this gets a live reading of the value and prints it on the page
                slide: function( event, ui ) {
                    $( "#ratingResult" ).text( ui.value );
                },
//this updates the value of your hidden field when user stops dragging
            change: function(event, ui) { 
                $('#rateToPost').attr('value', ui.value);
            }});
  });
  </script>

</head>
<body style="font-size:62.5%;">
<div id="slider"></div>
</body>
</html> 
```

在上面的脚本中，我使用了一个滑块进行评分。但这里的问题是我必须获取文本框值 onchange 并突出显示相应的评级数字背景。但我无法获取价值。任何人都可以帮助解决这个问题。提前致谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T13:10:08.780

使用 jQuery 试试这个：

```
$('#rateToPost').on("change", function () {
  alert($(this).val());
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T13:05:23.177

由于`$('#rateToPost')`是表单元素：使用[val()](http://api.jquery.com/val/)方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T13:04:44.397

```
assign value: $('#rateToPost').val(ui.value);
read value: var res = $('#rateToPost').val(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T13:07:01.523

```
 $('#rateToPost').keyup(function(){
       $('#slider').slider({value: this.value});
    }); 
```

演示[http://jsbin.com/azosab/2/edit](http://jsbin.com/azosab/2/edit)

# java - JPanel mouseMove 动作上的 JToolTip

> ID：14338311
> 
> 赞同：2
> 
> 时间：2013-01-15T12:59:39.953
> 
> 标签：java, swing, jpanel, jtooltip

我正在尝试创建一个`JToolTip`超过`JPanel`. 这个想法是，用户在 J 上移动，`Panel (mouseMove)`光标后面将是工具提示。但我不知道，如何将工具提示设置为`JPanel`. 我的意思是，我通过光标（in ）创建了 的实例`JToolTip`，然后我不知道如何将这个新的工具提示设置为面板（如）。`setLocation``mouseMove``JPanel.setToolTip(newJToolTip)`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:04:56.703

`JPanel`您可以在using上设置工具提示`setToolTipText()`。当鼠标光标停止时，将显示工具提示。如果您不再需要此行为，只需再次调用该方法`null`作为参数。

# php - 从会话中回显用户名而不在每个控制器中定义

> ID：14338325
> 
> 赞同：0
> 
> 时间：2013-01-15T13:00:26.210
> 
> 标签：php, codeigniter, session, session-variables

> **可能重复：**
> [从会话代码点火器的视图中回显用户](https://stackoverflow.com/questions/14336122/echo-user-in-view-from-sessions-code-igniter)

我不想在每个控制器中定义和存储用户，然后将其传递给视图。这是我的控制器：

登录控制器：

```
class LoginController extends CI_Controller {
    function index(){       
        $new['main_content'] = 'loginView';
        $this->load->view('loginTemplate/template', $new);          
    }

    function verifyUser(){

    //getting parameters from view 
    $data = array(
            'username' => $this->input->post('username'),
            'password' => $this->input->post('password')
    );      

    $this->load->model('loginModel'); 
    $query = $this->loginModel->validate($data);

    if ($query){             
        //if the user c validated data variable is created becx we want to put username in session

            $data = array(
                'username' => $this->input->post('username'),
                 'is_logged_in' => true 
            );

           $this->session->set_userdata($data);
           redirect('sessionController/dashboard_area');
    }else{
        $this->index();
    }
}
function logout()
{
    $this->session->sess_destroy();
    $this->index();
}
}

?> 
```

我的控制器，我存储在核心文件夹中，所以现在每个控制器都扩展了这个控制器。我认为这个控制器可以自定义，所以我可以在扩展这个控制器的每个视图页面中访问用户：

```
 class MY_Controller extends CI_Controller{
        function __construct(){
    parent::__construct();
    $this->is_logged_in();

    }   
    function dashboard_area(){
    $data['main_content'] = 'dashboardView';
    $this->load->view('dashboardTemplate/template', $data);         
    }

function is_logged_in()
{
    $is_logged_in = $this->session->userdata('is_logged_in');

    if(!isset($is_logged_in) || $is_logged_in != true)
    {
        echo 'You don\'t have permission to access this page.';
        redirect('loginController');
    }
}

           }
?> 
```

这是我简单的一个成员控制器，它扩展了上述控制器：在索引函数中，我存储用户名，然后传递到我不想做的视图中：

```
 class CategoryController extends MY_Controller {
   function index(){         
    $data['main_content'] = 'categoryView';         
    $username= $this->session->userdata('username');
    $data['username']=$username;
    $this->load->view('dashboardTemplate/template',$data);
      } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:08:18.453

你可以`$this->session->userdata('username')`在你的视图中调用。

它存储在会话中，因此您不必将其从控制器传递给视图。

**更新每条评论；**
如果您想根据基本控制器（例如用户）加载视图，我将使用[模板库](http://williamsconcepts.com/ci/codeigniter/libraries/template/)并将模板设置为在基本控制器的构造中使用。

例如（使用这个[模板库](http://williamsconcepts.com/ci/codeigniter/libraries/template/)）；

```
class MY_User extends CI_Controller {
   public __construct() {
      parent::__construct();
      $this->is_logged_in();
      $this->template->set_template('user');
   }
}

class MY_Admin extends CI_Controller {
   public __construct() {
      parent::__construct();
      $this->is_logged_in();
      $this->template->set_template('admin');
   }
} 
```

# ruby-on-rails - mongoid 不可变记录

> ID：14338326
> 
> 赞同：1
> 
> 时间：2013-01-15T13:00:27.150
> 
> 标签：ruby-on-rails, mongoid

我正在构建一个 Rails 3.2 应用程序，我必须将 Sidekiq 作业封装在一个单独的模型中，以维护关系并处理插入和删除。

我使用 Mongoid 作为我的主要 ORM，我想问我如何制作不可变的记录。

这意味着在（初始化和）创建作业之后，除了删除记录之外，不接受任何更改。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T08:42:35.837

假设您的 Rails 应用程序是唯一的 MongoDB 客户端，您可以在模型层实现不变性逻辑：

```
class Job
    include Mongoid::Document
    before_validation { false if changed? && persisted? }
end 
```

第一次调用`save`或调用`create`new`Job`时，数据将成功保存。调用时，对对象的进一步更改不会写入数据库`save`。的行为`delete`将不受影响。

**为什么这有效**

`before_validation`如果返回 false，则取消持久性：

> 如果 before_validation 回调的返回值可以评估为 false，则该过程将中止并且 Base#save 将返回 false。如果 ActiveRecord::Validations#save! 调用它会引发 ActiveRecord::RecordInvalid 异常。不会将任何内容附加到错误对象。

**方法参考**

1.  [改变了吗？](http://api.rubyonrails.org/classes/ActiveModel/Dirty.html#method-i-changed-3F)如果任何字段是脏的，则返回 true

2.  [坚持？](http://api.rubyonrails.org/classes/ActiveRecord/Persistence.html#method-i-persisted-3F)如果此对象的某个版本保存在数据库中，则返回 true

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-16T15:38:41.070

我扩展了塞巴斯蒂安的[出色回答](https://stackoverflow.com/a/14354233/551557)，以使行为更清晰。

```
class Job
  include Mongoid::Document

  field :msg, type: String

  validate :immutability

  def immutability
    if changed? && persisted?
      errors[:base] << "#{self.class.name} is immutable and cannot be modified after it has been persisted"
    end
  end
end 
```

这是它的工作原理：

```
> job = Job.create(msg: 'Hello')
=> #<Job _id: 55a7ccb76d61634e87000000, msg: "Hello">
> job.update_attributes!(msg: 'Goodbye')
Mongoid::Errors::Validations:
Problem:
  Validation of Job failed.
Summary:
  The following errors were found: Job is immutable and cannot be modified after it has been persisted
Resolution:
  Try persisting the document with valid data or remove the validations.
        from /...
> job.destroy!
=> true 
```

这有两个主要好处：

1.  错误消息比您使用`before_validation`( `Calling update_attributes! on Job resulted in a false return from a callback.`)得到的解释性强得多
2.  它遵循 Mongoid 关于[不将回调用于域逻辑的](http://mongoid.org/en/mongoid/docs/callbacks.html#callbacks)建议：对域逻辑*使用回调是一种糟糕的设计实践，并且可能导致在链中的回调停止执行时难以调试的意外错误。我们建议仅将它们用于横切关注点，例如排队后台作业。*

# java - 从正则表达式输出中删除空字符串

> ID：14338327
> 
> 赞同：2
> 
> 时间：2013-01-15T13:00:28.180
> 
> 标签：java, regex, string

我有看起来像这样的字符串： `[item 1, item2, item3]`

我想要的输出是：

```
item 1
item2
item3 
```

我写了这段代码：

```
String text = "[item 1, item2, item3]";
String[] text_output = text.split(", |\\[|\\]");
for(String item:text_output)
    fileOutStream.write(("\n"+item).getBytes()); 
```

并且我得到的输出是正确的，不同之处在于输出数组中的第一个元素是一个空字符串。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:02:03.310

您已请求在 处拆分字符串，`[`因此`]`系统服从并将 之前的空白空间`[`视为您的第一个元素。您可以通过多种方式进行操作：

1.  `text.replaceAll("\\[|\\]", "")`拆分前使用；
2.  硬编码拆分前第一个和最后一个字符的消除`text.substring(1, text.length()-1)`：
3.  使用**正匹配**而不是负匹配：

    ```
    Pattern.compile("[^,\\[\\]]+").matcher().find() 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:02:46.273

当您尝试拆分并且第一个字符是您要拆分的字符时，就会发生这种情况。您应该创建一个新数组，而不是选择第一个元素（空元素）。

```
String[] text_output = text.substring(1).split(", |\\[|\\]"); 
```

如果您只想删除第一个字符，您可以使用它，您将获得所需的输出。请记住，当您尝试拆分并且第一个字符是拆分之一时会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:04:07.733

首先是空字符串，因为您也正在使用它进行拆分`\\[`，因此第一个元素`[`在您的字符串中。只需忽略您的第一个元素。

# svn - 新存储库上的 SVN 本地历史记录

> ID：14338328
> 
> 赞同：0
> 
> 时间：2013-01-15T13:00:34.810
> 
> 标签：svn, history, local, assembla

感谢这篇文章： [如何将我的本地 svn 项目导入新创建的 svn 存储库并保留历史信息](https://stackoverflow.com/questions/10184289/how-to-import-my-local-svn-project-to-new-created-svn-repository-and-keep-histor)，我知道可以将本地 SVN 历史记录导出到新存储库。

但是，我如何使用 Assembla 存储库做同样的事情，是否有技巧或软件可以做这样的事情？

提前谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:32:57.310

对于 Assembla，如果您在 Source/SVN - Import/Export 选项卡“导入转储”中启用了空存储库，并使用它来导入您的转储。

# sql - 连接两个 MSSQL 表（唯一值）

> ID：14338332
> 
> 赞同：0
> 
> 时间：2013-01-15T13:01:03.773
> 
> 标签：sql, sql-server, distinct-values

我的 SQL Server 数据库中有两个要加入的表：

**人员表：**

```
PersonId   Name    DeviceId
001        John    11111
002        Eric    22222
003        Steve   33333 
```

**设备表：**

```
DeviceId  Date
11111     2013-02-01
11111     2013-02-02
11111     2013-02-03
22222     2013-02-03
22222     2013-02-01 
```

我想要的结果如下

```
PersonId   Name   DeviceId  Date         IsRegistered
001        John   11111     2013-02-03       1
002        Eric   22222     2013-02-03       1
003        Steve  33333     null             0 
```

因此，如您所见，我想要表之间的连接，并且只想要唯一值。数据字段应该是最后注册的（最新日期）。如果此人在日期字段中具有值，`IsRegistered`则应具有值 0

如果有人知道我该如何解决这个问题，我将不胜感激

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:10:35.850

*   [SQLFIDDLE 演示](http://www.sqlfiddle.com/#!2/a9be4/4)

询问：

```
SELECT 
  p.*, d.maxdate
FROM persons p
left join
(  SELECT id, MAX(date) MaxDate
   FROM device   
   GROUP BY id
) d  ON p.deviceid = d.id
     ORDER BY d.maxdate DESC;

| PERSONID |  NAME | DEVICEID |                         MAXDATE |
-----------------------------------------------------------------
|        1 |  John |    11111 | February, 03 2013 02:00:00+0000 |
|        2 |  Eric |    22222 | February, 03 2013 00:00:00+0000 |
|        3 | Steve |    33333 |                          (null) | 
```

我看到您还需要`isRegistered`列，这里是：

*   SQLFIDDLE WITH 最后一列添加

询问：

```
SELECT 
    p.*, d.maxdate, case when d.maxdate is null then 0 else 1 end as isRegistered
    FROM persons p
    left join
    (  SELECT id, MAX(date) MaxDate
       FROM device   
       GROUP BY id
    ) d  ON p.deviceid = d.id
         ORDER BY d.maxdate DESC
    ; 
```

结果：

```
| PERSONID |  NAME | DEVICEID |                         MAXDATE | ISREGISTERED |
--------------------------------------------------------------------------------
|        1 |  John |    11111 | February, 03 2013 02:00:00+0000 |            1 |
|        2 |  Eric |    22222 | February, 03 2013 00:00:00+0000 |            1 |
|        3 | Steve |    33333 |                          (null) |            0 | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:04:18.030

试试这个：

```
SELECT 
  p.PersonId,
  p.Name,
  p.DeviceId,
  d.MaxDate AS "Date",
  CASE 
    WHEN d.deviceID IS NULL THEN 0 
    ELSE 1 
  END AS IsRegistred
FROM Person  p
LEFT JOIN
(
  SELECT  DeviceId, MAX(Date) MaxDate
  FROM Device
  GROUP BY DeviceId
) d ON p.DeviceId = d. DeviceId; 
```

## [SQL 小提琴演示](http://www.sqlfiddle.com/#!3/00df0/16)

这会给你：

```
| PERSONID |  NAME | DEVICEID |                            DATE | ISREGISTRED |
-------------------------------------------------------------------------------
|        1 |  John |    11111 | February, 03 2013 02:00:00+0000 |           1 |
|        2 |  Eric |    22222 | February, 03 2013 02:00:00+0000 |           1 |
|        3 | Steve |    33333 |                          (null) |           0 | 
```

* * *

**或者：**使用排名功能`ROW_NUMBER()`，您可以这样做：

```
WITH CTE
AS
(
    SELECT
      p.PersonId,
      p.Name,
      p.DeviceId,
      d.deviceID AS ddeviceID,
      d.Date,
      ROW_NUMBER() OVER(PARTITION BY p.PersonID, p.DeviceId 
                        ORDER BY Date DESC) rownum
    FROM Person p
    LEFT JOIN Device d ON p.DeviceId = d. DeviceId
) 
SELECT
  PersonID,
  Name,
  DeviceId,
  Date,
  CASE 
    WHEN ddeviceID IS NULL THEN 0 
    ELSE 1 
  END AS IsRegistred
FROM CTE
WHERE  rownum = 1; 
```

## [更新的 SQL Fiddle 演示](http://www.sqlfiddle.com/#!3/00df0/15)

这会给你同样的结果。

# c++ - 将文本插入文件（未输入结束行）

> ID：14338340
> 
> 赞同：3
> 
> 时间：2013-01-15T13:01:37.867
> 
> 标签：c++, linux, file, endl

我有一个奇怪的问题：

我将文件读入 buf 并尝试在 ssh (Linux) 中运行它。

我的文件包含：

```
We 
I
a 
```

所以这是我的缓冲区：

![在此处输入图像描述](../Images/d377f4e0e1dbca7c56dd4b618f3e453e.png)

现在我创建一个新文件并将 buf 粘贴到这个新文件中：

```
FILE*nem_file_name;
nem_file_name= fopen("email1.clear","wb"); //create the file if not exist.
fwrite (buf, sizeof(char), strlen(buf),nem_file_name); //write the new sensored mail to the file. 
```

在这种情况下，文件：email1.clear 已创建，但它包含以下内容： `We Ia`

当我将其复制到剪贴板并将其粘贴到该主题时，它被粘贴为：

```
We 
I
a 
```

为什么我的文件中没有“结束行”？我希望它像我在剪贴板中的一样：/

**更新** 我尝试通过以下方式手动创建 buf：

```
char buf[10];
buf[0] = 'W';
buf[1] = 'e';
buf[2] = 32;
buf[3] = 13;
buf[4] = 10;
buf[5] = 'I';
buf[6] = 13;
buf[7] = 10;
buf[8] = 'a';
buf[9] = 0; 
```

（请注意，我没有将文件读入 buf，而是手动进行）

接着：

```
FILE*nem_file_name;
nem_file_name= fopen("email1.clear","wb"); //create the file if not exist.
fwrite (buf, sizeof(char), strlen(buf),nem_file_name); 
```

并且文件`email1.clear`是按照我的意愿创建的：

```
We
I
a 
```

我无法理解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:44:11.060

它是一个文本，为什么将它写入二进制文件（`"wb"`）？只需使用文本文件，一切都应该没问题（`b`读取文件和写入文件时从文件打开模式中删除）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:44:38.793

调试器屏幕截图实际上是来自您的 linux 环境吗？还是您在 Windows 调试器上创建它？

这取决于您如何阅读原始文件。如果您使用的是文本模式（`r`或`rt`在`fopen`通话中），Linux 会在阅读过程中将 CRLF (13,10) 转换为单个 LF (10) 字符。当以二进制模式（如您的代码）将其写入新文件时`wb`，它将保持单个 LF。

记事本不能将单个 LF 字符作为换行符处理，但是，您的网络浏览器显然可以。

**更新**：
不同操作系统对行尾字符的处理方式不同。在文本模式下打开文件时，在读/写期间处理差异并转换为系统模式/从系统模式转换。在二进制模式下，字节按原样读取和写入，无需转换（[fopen 文档](http://cplusplus.com/reference/cstdio/fopen/)）。

这取决于程序应该在哪里运行以及哪些客户端应该读取输出（Linux/Windows）。当您的代码在 linux 上运行时，从 linux 读取文本文件并生成要在 linux 中使用的文本文件，使用文本模式（同样适用于 windows）。如果您需要混合平台，您可能必须自己转换线端。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-15T13:07:08.557

I think strlen(buf) will return the size of buf **without** the null char that marks end of string. You can try and write to your file like this:

```
fwrite (buf, sizeof(char), strlen(buf), nem_file_name);
char eos = '\0';
fputc (eos, nem_file_name); 
```

Just my guess. Good luck!

# java - Java：带有状态的 ASCII 随机行文件访问

> ID：14338350
> 
> 赞同：4
> 
> 时间：2013-01-15T13:01:57.653
> 
> 标签：java, io

有没有比创建满足以下标准的流文件阅读器类更好的 [预先存在的可选 Java 1.6] 解决方案？

*   给定一个任意大尺寸的 ASCII 文件，其中每一行都以`\n`
*   对于某些方法的每次调用，`readLine()`从文件中读取随机行
*   并且在文件句柄的整个生命周期内，没有调用`readLine()`应该返回同一行两次

更新：

*   最终必须读取所有行

上下文：文件的内容是从 Unix shell 命令创建的，以获取给定目录中包含的所有路径的目录列表；有数百万到十亿个文件（在目标文件中产生数百万到十亿行）。如果有某种方法可以在创建期间将路径随机分布到文件中，这也是可接受的解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T13:28:24.867

为了避免在您的情况下可能无法读取整个文件，您可能希望使用 a[`RandomAccessFile`](http://docs.oracle.com/javase/7/docs/api/java/io/RandomAccessFile.html)而不是标准 java `FileInputStream`。使用`RandomAccessFile`，您可以使用该`seek(long position)`方法跳到文件中的任意位置并开始阅读。代码看起来像这样。

```
RandomAccessFile raf = new RandomAccessFile("path-to-file","rw");
HashMap<Integer,String> sampledLines = new HashMap<Integer,String>();
for(int i = 0; i < numberOfRandomSamples; i++)
{
    //seek to a random point in the file
    raf.seek((long)(Math.random()*raf.length()));

    //skip from the random location to the beginning of the next line
    int nextByte = raf.read();
    while(((char)nextByte) != '\n')
    {
        if(nextByte == -1) raf.seek(0);//wrap around to the beginning of the file if you reach the end
        nextByte = raf.read();
    }

    //read the line into a buffer
    StringBuffer lineBuffer = new StringBuffer();
    nextByte = raf.read();
    while(nextByte != -1 && (((char)nextByte) != '\n'))
        lineBuffer.append((char)nextByte);

    //ensure uniqueness
    String line = lineBuffer.toString();
    if(sampledLines.get(line.hashCode()) != null)
        i--;
    else
       sampledLines.put(line.hashCode(),line);
} 
```

在这里，`sampledLines`应该在最后保留您随机选择的行。您可能需要检查您是否还没有随机跳到文件末尾以避免在这种情况下出现错误。

**编辑：**我把它换到文件的开头，以防你到达结尾。这是一个非常简单的检查。

**编辑 2：**我通过使用`HashMap`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T13:20:43.413

预处理输入文件并记住每个新行的偏移量。使用 a`BitSet`来跟踪使用的行。如果你想节省一些内存，那么记住每 16 行的偏移量；跳入文件并在 16 行的块内进行顺序查找仍然很容易。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T13:25:32.873

由于您可以填充线条，因此我会按照这些线条做一些事情，并且您还应该注意，即使那样，对于 a`List`可以实际容纳的内容也可能存在限制。

每次您想读取该行并将其添加到 a 时使用一个随机数`Set`也可以，但是这可以确保文件被完全读取：

```
public class VeryLargeFileReading
    implements Iterator<String>, Closeable
{
    private static Random RND = new Random();
    // List of all indices
    final List<Long> indices = new ArrayList<Long>();
    final RandomAccessFile fd;

    public VeryLargeFileReading(String fileName, long lineSize)
    {
        fd = new RandomAccessFile(fileName);
        long nrLines = fd.length() / lineSize;
        for (long i = 0; i < nrLines; i++)
            indices.add(i * lineSize);
        Collections.shuffle(indices);
    }

    // Iterator methods
    @Override
    public boolean hasNext()
    {
        return !indices.isEmpty();
    }

    @Override
    public void remove()
    {
        // Nope
        throw new IllegalStateException();
    }

    @Override
    public String next()
    {
        final long offset = indices.remove(0);
        fd.seek(offset);
        return fd.readLine().trim();
    }

    @Override
    public void close() throws IOException
    {
        fd.close();
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T15:00:08.860

如果文件的数量*确实*是任意的，那么在内存使用方面（或 IO 时间，如果在文件而不是列表或集合中跟踪），跟踪处理的文件似乎可能存在相关问题。*保留不断增长*的选定行列表的解决方案也会遇到与时序相关的问题。

我会考虑以下几点：

1.  创建*n 个*“桶”文件。*n*可以根据考虑到文件数量和系统内存的因素来确定。（如果*n*很大，您可以生成*n*的子集以保持打开的文件句柄。）
2.  每个文件的名称都经过哈希处理，并进入适当的存储桶文件，根据任意标准“分片”目录。
3.  读入存储桶文件内容（只是文件名）并按原样处理（散列机制提供的随机性），或者选择 rnd(n) 并随时删除，提供更多随机性。
4.  或者，您可以填充并使用随机访问的想法，在选择时从列表中删除索引/偏移量。

# ios - 多文档绘图应用程序核心数据方法

> ID：14338352
> 
> 赞同：1
> 
> 时间：2013-01-15T13:02:06.930
> 
> 标签：ios, objective-c, core-data

我有一个工作绘图应用程序，它使用核心数据数据库来存储绘图。它允许用户创建多个文档，但我只使用一个具有多个绘图实体的数据库。

现在我正在对应用程序进行一些重大改进，并且我正在努力做正确的事情。我认为做这种应用程序的方法是使用**UIManagedDocument**。

我的猜测是，我应该为每张绘图使用一个 UIManagedDocument，这样它们就会在磁盘上保存为独立的文档，但我无法在任何地方找到任何这样的示例。

如果这是正确的方法（我不确定），我需要知道：

*   如何检索创建的所有文档（图纸）的列表？
*   如何保存绘图的预览图像？我将它保存在 UIManagedDocument 中还是其他地方？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T16:55:49.250

也许你可以以这篇文章为起点： [http ://www.informit.com/articles/article.aspx?p=1842295&seqNum=10](http://www.informit.com/articles/article.aspx?p=1842295&seqNum=10)

UIManagedDocument 的主要思想是每个文档都有自己的 managedObjectContext，它保存在文档的包中。

> 如何检索创建的所有文档（图纸）的列表？

要显示本地图纸列表，您只需在集合视图中显示存储目录内容。
在处理存储在 iCloud 中的文档时，Apple 建议使用[NSMetadataQuery](http://developer.apple.com/library/ios/#documentation/General/Conceptual/iCloud101/SearchingforiCloudDocuments/SearchingforiCloudDocuments.html)。

> 如何保存绘图的预览图像？我将它保存在 UIManagedDocument 中还是其他地方？

为了在包中存储附加信息（如您的文档预览），UIManagedDocument 提供了 [writeAdditionalContent:toURL:originalContentsURL:error：](http://developer.apple.com/library/ios/documentation/uikit/reference/UIManagedDocument_Class/Reference/Reference.html#//apple_ref/occ/instm/UIManagedDocument/writeAdditionalContent%3atoURL%3aoriginalContentsURL%3aerror%3a)

还请记住，NSDocument/UIDocument 是控制器类（而不是模型类）。

# cryptography - pgpdump 输出分析

> ID：14338355
> 
> 赞同：1
> 
> 时间：2013-01-15T13:02:43.290
> 
> 标签：cryptography, rsa, bouncycastle, openpgp

我已经使用`pgpdump`了一个加密文件（通过 BouncyCastle）来获取有关它的更多信息，并找到了几行关于部分开始、部分继续和部分结束的信息。所以我想知道这到底是在描述什么。它是纯文本的某种碎片吗？

此外，在 RSA 算法之后，位计数代表什么？在这种情况下，它是 1022 位，但我见过 1023 和 1024 位的文件。

![转储输出](../Images/de3215b7c4266f9218bc852f0c54b50f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:54:01.790

[这篇 tumblr 帖子](http://mrmekon.tumblr.com/post/12808217363)很好地解释了部分身体长度。OpenPGP 消息由给定长度的数据包组成。有时对于大型输出（或者对于来自 GnuPG 的数据包，短消息），会有部分正文长度指定另一个标头将显示，告诉读者继续阅读来自帖子：

> *部分正文长度*告诉解析器： “我知道这个数据包中至少还有 N 个字节。在多 N 个字节之后，将有另一个标头告诉您是否还要读取多少字节。” 我猜这个想法是，您可以在数据流进入时对其进行加密，而不必知道它何时结束。也许您正在对语音进行 PGP 加密，或者正在对一些未播出的电视进行加密。我不知道。它可以是无限长的——你可以继续在其中扔更多的部分正文长度标头，每个标头可以处理高达 1 GB 的长度。每千兆字节它都会通知解析器：“是的，还有更多！”</p>

因此，在您的屏幕截图中，pgpdump 读取 8192 字节，然后遇到另一个标头，说要读取另外 2048 字节。在 2k 字节之后，它到达另一个 1037 字节的标头，依此类推，直到最后一个 continue 标头。489 字节之后是消息的结尾

1022 位是公共模数的长度。它总是接近 1024（如果您有 1024 位密钥），但最终可能会比最初选择的 RSA 参数略短。尽管它们比这略短，但它们仍被称为“1024 位密钥”。

# c# - 如何同时创建两个没有顺序 ID 的数据库记录

> ID：14338360
> 
> 赞同：0
> 
> 时间：2013-01-15T13:02:58.237
> 
> 标签：c#, java, mysql, sql, sql-server

我们目前有一个用户登录的网站。

我们有一个带有 userId 的用户表。

我们现在希望用户有一个重复的个人资料，这与他们的主要个​​人资料完全分开。这需要是一个秘密档案。

现在我们可以只将两条记录添加到数据库中，但 id 将是连续的（直到我们达到很高的注册命中率），因此用户可以锻炼 userId 将与更高的一个 ID 相关联。

我意识到这不是一个理想的解决方案，但它是一个大型软件项目的后期更改，因此我们试图尽可能务实，同时尽可能少地更改代码。

选项：

1.  关闭自动增量 ID，并构建我们自己的 keyGeneration 表。从 0 开始一张表，在 1000000000 开始一张秘密表。然后我们可以关闭用户表中的自动递增 ID，并使用这些密钥。

问题是，运行键 1,1000000000,2,1000000001,3,1000000002 是否会导致大量索引问题？我们是否必须一直强制重建索引？

1.  我们只为第二个配置文件 id 键入一个单独的表，再次从 10000000000 开始。然后我们修改所有代码以检查 id > 999999999 并翻转服务器端的逻辑，以便查找正常工作。

意味着在从前端将用户 ID 传递到站点的任何地方进行检查。

由于我们没有做太多，（我们显然主要是安全地获取登录用户的 userId，它可能没那么糟糕。

无论如何，只是想知道是否有人对此有任何想法？

///////编辑

为了进一步说明这一点，想象在 stackoverflow 或 facebook 上，您有 2 个可以控制的配置文件，它们之间没有链接。就像 Facebook 上的多个用户都可以充当主页帐户一样，但没有从该帐户返回到真实用户个人资料的链接。

本质上是为了不破坏参照完整性或重新编写太多代码，我真的想将一个 ID (int) 传递回这些帐户的前端。然后整个系统就像它所做的那样继续滴答作响。

指南可能很酷！但这会产生性能开销（不是我真正关心的；），但这也意味着编写大量代码来处理传递给前端的 Guids（不是我们依赖前端变量是正确的）但这就是为什么我建议上面的高 int 解决方案。由于我们仍然在后台潜伏着 ASP.NET 成员资格，我几乎认为这可能会很好，但是 A）我们计划有一天删除那个（或迁移到简单的成员资格）b）我们在用户表中使用顺序 Guid 生成来提高性能（在需要之前再次抱歉谈论优化）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:08:39.197

由 Web 服务提供的 Guid 随机数。很多解决方案。我宁愿使用 GUID。

那说：这是一个业务密钥，我仍然会使用自动增量风格的技术密钥来实现参照完整性。

# iphone - 如何锁定 UITable 以防止滚动到表格中的项目之外

> ID：14338367
> 
> 赞同：0
> 
> 时间：2013-01-15T13:03:07.893
> 
> 标签：iphone, ios, objective-c, uitableview

我有一个`UITableView`向上滚动太远，直到`UITableView`向上滚动中的项目列表然后大量空白跟随它的地步。

我怎样才能停止`UITableView`滚动额外的空间？

希望我描述得足够好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:10:37.257

我认为这可能对你有用。调用`reloadData`表后运行此代码：

```
if (table.contentSize.height < table.frame.size.height) 
{
   table.scrollEnabled = NO;
}
else 
{
   table.scrollEnabled = YES;
} 
```

这里 ,`table.frame.size.height`是屏幕上显示的对象的实际大小（您可以在 Interface Builder 中看到），而,和`table.contentSize.height`的高度是相加的。`the header``the footer``height of every cell`

我在这里找到它：[当内容适合屏幕时如何禁用 UITableView 表中的滚动](https://stackoverflow.com/questions/7410845/how-to-disable-scrolling-in-uitableview-table-when-the-content-fits-on-the-scree)

希望你也能从他们给出的答案中得到一些东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:13:22.653

这将解决您的问题

```
TableView.bounces=NO; 
```

这将删除空单元格

```
TableView.separatorStyle = UITableViewCellSeparatorStyleNone; 
```

# svg - SVG中单个对象的多个过滤器

> ID：14338380
> 
> 赞同：9
> 
> 时间：2013-01-15T13:03:33.320
> 
> 标签：svg, svg-filters

我想在我的圈子上放两个过滤器。（也许更多）

我试过做：

```
filter="url(#f1);url(#f2)" 
```

和：

```
filter="url(#f1,#f2)" 
```

和：

```
filter="url(#f1 #f2)" 
```

但它们都不起作用。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-15T14:35:26.553

您可以在一个过滤器中添加多个效果，但是如果您想将过滤器堆叠起来，请首先对对象进行分组，然后将另一个过滤器应用于您的对象。

```
<g filter="url(#f2)">
<rect width="90" height="90" stroke="green" stroke-width="3" fill="yellow" filter="url(#f1)"/>
</g> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2020-09-18T15:55:40.300

我知道这是一个非常古老的问题，但是对于引用此问题的人，您也可以将过滤器功能与空格分开-`filter="url(#f1) url(#f2)"`应该可以

见：[https ://css-tricks.com/almanac/properties/f/filter/](https://css-tricks.com/almanac/properties/f/filter/)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-04-29T14:56:59.443

例如，从标识 feColorMatrix 开始，并将结果命名为 currentGraphic。将其用作每个过滤器元素包/事务开始的“输入”，并用作包的最终操作的“结果”。下一个元素包在 'in'='currentGraphic' 等处获取它。

# jquery - 如何将此列表重新创建为普通逗号分隔？

> ID：14338385
> 
> 赞同：0
> 
> 时间：2013-01-15T13:03:44.647
> 
> 标签：jquery

我有以下字符串

```
w[]=18&w[]=2&w[]=2[]=2 
```

我想创建一个 jQuery 函数，让它像这样用逗号分隔：

```
18,2,2,2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:16:55.930

采用正则表达式方式，假设示例中的非数字键和数值，我将`match()`直接使用所有数字。这将返回一个数组，其中包含字符串中所有匹配的数字（不是数字）：

```
var query_string  = 'w[]=18&w[]=2&w[]=2[]=2';
var numbers_array = query_string.match(/\d{1,}/g); 
```

如果您随后需要 CSV 字符串，则可以使用分隔符`join()`将数组值：`,`

```
var numbers_csv = numbers_array.join(','); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:05:54.830

您可以使用`String#replace`与任何非数字匹配的正则表达式，并删除前导逗号：

```
var str = "w[]=18&w[]=2&w[]=2[]=2";
str = str.replace(/\D+/g, ',').substring(1); 
```

[实例](http://jsbin.com/umudap/1)| [资源](http://jsbin.com/umudap/1/edit)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:07:05.483

**UPDATE**: It is much easier to just use [`substring()`](http://www.w3schools.com/jsref/jsref_substring.asp) and [`split()`](http://www.w3schools.com/jsref/jsref_split.asp):

```
var myArray = str.substring(4).split("&w[]="); 
```

(Assuming that the missing `&w` is a typo!)

*   `substring(4)` thows away the first for characters: `w[]=`
*   `split()` splits the string into elements using `&w[]=` as separation string.

* * *

*Old solution:*

Just find the `w[]=` occurrences and replace the occurrences with a `,` using the [`replace()`](http://www.w3schools.com/jsref/jsref_replace.asp) function

```
var str="w[]=18&w[]=2&w[]=2[]=2";
var fixedStr=str.replace(/\&/g,",").replace(/\w?\[\]\=/g,""); 
```

To convert the string into an array (I suppose you mean 'array' when you say 'list'), you need to [`split()`](http://www.w3schools.com/jsref/jsref_split.asp) it at the `,`s:

```
var myArray = fixedStr.split(","); 
```

# networking - 传输的套接字类型

> ID：14338388
> 
> 赞同：0
> 
> 时间：2013-01-15T13:04:02.947
> 
> 标签：networking, tcp, websocket, udp

我计划使用 TCP、UDP 和 web 套接字而不是 HTTP 进行客户端-服务器通信。但是我有一个问题，我应该使用什么套接字类型来处理从客户端传输到服务器的大数据。例如 ：

```
{
"name": "Product",
"properties": {
    "id": {
        "type": "number",
        "description": "Product identifier",
        "required": true
    },
    "name": {
        "type": "string",
        "description": "Name of the product",
        "required": true
    },
    "price": {
        "type": "number",
        "minimum": 0,
        "required": true
    },
    "tags": {
        "type": "array",
        "items": {
            "type": "string"
        }
    },
    "stock": {
        "type": "object",
        "properties": {
            "warehouse": {
                "type": "number"
            },
            "retail": {
                "type": "number"
            }
        }
    }
} 
```

}

对于像这样的数据同步传输，在什么情况下应该使用以下选项？或者何时使用同步和异步传输选项？

```
1- TCP
2- UDP
3- WEB SOCKET 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:29:10.550

对于大多数数据传输系统来说，UDP 是个坏主意。TCP 是一个不错的选择，但您会发现对 HTTP 的客户端语言支持通常更易于使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:54:34.590

如果要发送大量数据，需要确认（如果数据很重要），则使用 TCP。

如果你想发送少量数据，不想确认（如果数据不是很重要），那么使用 UDP。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T23:52:11.560

Web Socket 只是 TCP 上的一个层。

UDP 不适合大型传输，因为您必须自己实现大部分 TCP 才能使其正常工作。

这就留下了一个选择。

# c++ - 正则表达式在 C++ 代码中的“=”周围添加空格，我做错了什么？

> ID：14338391
> 
> 赞同：1
> 
> 时间：2013-01-15T13:04:07.513
> 
> 标签：c++, regex

我想创建一个正则表达式，它允许我在 C++ 代码中的赋值运算符周围添加空格（因为我更喜欢这种风格），例如，这样

```
x=something 
```

变成

```
x = something 
```

但

```
if(y==x) 
```

不会变成

```
if(y = = x) 
```

等等，包括`!=`, `<=`,`>=`

我对正则表达式比较陌生，并尝试了以下方法：

```
(?<![\s=])(=)(?!=) 
```

我认为这将是一个很好的开端，但这似乎不匹配。有人可以在这里解释一下我对正则表达式的不理解吗？

**编辑**

使用 Code::Blocks IDE 中不匹配的正则表达式的示例

![Code::BLocks 正则表达式尝试](../Images/85ddcd723e8f27b1b5e392db0e3fd1a5.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:11:01.747

尝试这样的事情：`(?<![<>=!])\s*=\s*(?!=)`替换为`=`.

或者

`([^<>=!])\s*=\s*([^=])`替换为`\1 = \2`

由于模式没有锚定，因此需要两个环视断言。

实际上，您自己的正则表达式只是`<>`在字符类中丢失了。我已经改进了一点，看看演示。

第一个正则表达式的演示+解释：[http](http://regex101.com/r/kU1hP2) ://regex101.com/r/kU1hP2 第二个正则表达式的演示+解释：[http ://regex101.com/r/lK1oQ3](http://regex101.com/r/lK1oQ3)

注意：`\s`匹配空格！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:40:19.620

这并不能涵盖所有内容。

如果你想要空间，你需要考虑更多。

试试这个 [http://regex101.com/r/oJ8jJ3](http://regex101.com/r/oJ8jJ3)

```
((!|<|>|=|\+|%)=|=) 
```

并使用 \1 分隔符

在某些风格的正则表达式中，可能如下所示：

```
s/((!|<|>|=|\+|%)=|=)/ \1 /g 
```

祝你好运！PS 考虑的案例：

```
x=something
if(y==x)
if(y <=x)
if(y>=x)
y+=x;
y%=x; 
```

# javascript - 如何在WordPress中使用php自动将选项中的值发布到输入值

> ID：14338394
> 
> 赞同：1
> 
> 时间：2013-01-15T13:04:19.607
> 
> 标签：javascript, wordpress, select, input, option

```
<script type="text/javascript">
function changeValue(){
var option=document.getElementById('category').value;

if(option=="$category"){
        document.getElementById('title').value="<php echo $category;?>";
}
    else {
        donothing
    }

}
</script>

<select name="category" id="category" class="cat">
<option class="level-0" value="86" selected="selected">Op1</option>
<option class="level-0" value="93"> Op 2</option>
<option class="level-0" value="125"> Op 3</option>
</select>

<label for="title"><?php _e('Title', 'variable'); ?> <span title="required">*    </span></label> <input type="text" class="text" name="title" id="title" value="//Here is the thing I do not know what to put here”?>" /> 
```

大家好：

我阅读了另一篇文章并提出了一种方法，一旦该人从其中一个选项中进行选择，该选项的名称将自动填充标题输入字段的值。我怎样才能做到这一点？我尝试了很多次，回声只是没有这样做。请帮忙！

谢谢你

**已清除，但下面有更多更新问题----------------------------------------------------** 我似乎看不到得到了我的表单的脚本工作。我尝试通过写入插入脚本：

```
<?php
//( I put the function script into a separated .js file, only function itself is included in the .js file)
echo '<script type="text/javascript" src="autocat.js">';
echo '</script>';
?> 
```

将上面的代码放入生成表单的我的 php 文件中。

我尝试在表单标签开始之前插入它，但似乎根本不起作用......你知道可能是什么错误吗？Chrome表示脚本状态已取消。

为了清楚起见，下面的代码在 autocat.js 中：

```
function changeValue(val){ 
document.getElementById('title').value= obj[obj.selectedIndex].innerHTML;
} 
```

Chrome 还报道了：

加载资源失败：服务器响应我的 autocat.js 文件的状态为 404（未找到）

**更新**
我清除了上面的错误，但是现在代码还可以，但是当我触发表单时，似乎 onChange 没有运行...可能是因为表单在 PHP 生成表单之前解析了 javaScript 吗？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:15:53.843

看来您对 php 和 javascript 有点困惑。表单对象之间的交互只能使用 javascript 来完成。如果您需要来自 php 文件的更多数据，请使用 AJAX 调用。为了简单起见，请检查一下。希望能帮助到你。

HTML

```
<select name="category" id="category" class="cat" onChange="changeValue(this.value)">
<option class="level-0" value="86" selected="selected">Op1</option>
<option class="level-0" value="93"> Op 2</option>
<option class="level-0" value="125"> Op 3</option>
</select>

<label for="title">
    <span title="required">*</span>
</label>
<input type="text" class="text" id="title" name=""> 
```

JavaScript

```
function changeValue(val){
    document.getElementById('title').value = val;
} 
```

工作示例

[http://jsbin.com/onosex/1/edit](http://jsbin.com/onosex/1/edit)

**编辑**

要获取选项标签值（文本、html，无论你怎么称呼它），请使用它。

**onChange 部分现在传递对象本身而不仅仅是值**

HTML

```
<select name="category" id="category" class="cat" onChange="changeValue(this)">
<option class="level-0" value="86" selected="selected">Op1</option>
<option class="level-0" value="93"> Op 2</option>
<option class="level-0" value="125"> Op 3</option>
</select>

<label for="title">
    <span title="required">*</span>
</label>
<input type="text" class="text" id="title" name=""> 
```

JavaScript

```
function changeValue(obj){
    document.getElementById('title').value= obj[obj.selectedIndex].innerHTML;
} 
```

工作示例

[http://jsbin.com/onosex/3/edit](http://jsbin.com/onosex/3/edit)

# sql - 使用 SELECT 作为 JOIN 的值

> ID：14338401
> 
> 赞同：1
> 
> 时间：2013-01-15T13:04:58.467
> 
> 标签：sql, select, join

我有一张`ItemPropertyValue`独特`ID`的桌子`PropertyID`

```
ID IDProperty Value ItemID
1  1            1    5 
2  2            2    6
3  3            2    10
4  4            2    15 
```

还有一张桌子叫`PropertyCategory`

```
IDProperty  Value  Name
1           1      First Option
1           2      Second Option
2           1      Another option 
```

我想要什么 -`PropertyID`从第一个表`ItemPropertyValue`中选择`ItemID = 10` ，然后`join`选择`second table PropertyCategory`

所以我有这样的东西：

```
IDProperty  Value  Name
1           1      First Option
1           2      Second Option
2           1      Another option 
```

我试过这个，但有一个错误。没有像 PropertyID 这样的列

```
 SELECT * FROM PropertyCategory JOIN 
    (SELECT ItemPropertyValue.IDProperty AS PropertyID
    WHERE ItemPropertyValue.IDItem = '10') 
    ON PropertyCategory.IDProperty = PropertyID 
```

我该怎么做？

MS SQLServer（如果有）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:08:30.183

尝试别名子选择

```
SELECT * FROM PropertyCategory JOIN 
(SELECT ItemPropertyValue.IDProperty AS PropertyID
WHERE ItemPropertyValue.IDItem = '10') a
ON PropertyCategory.IDProperty = a.PropertyID 
```

此外，这可以很好地与外部`WHERE`子句中发生的过滤进行常规连接，例如

```
SELECT *
FROM PropertyCategory
JOIN ItemPropertyValue ON PropertyCategory.IDProperty = ItemPropertyValue.IDProperty
WHERE ItemPropertyValue.IDProperty = '10' 
```

最后，如果您碰巧正在使用 SQL Server 并且*真的*想在子选择类型的语句中执行此操作，我建议您检查`CROSS APPLY`或`OUTER APPLY`使用这样的应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T13:08:20.230

使用表别名：

```
SELECT * 
    FROM PropertyCategory 
    JOIN 
        (SELECT ItemPropertyValue.IDProperty AS PropertyID 
            WHERE ItemPropertyValue.IDItem = '10') as T
        ON PropertyCategory.IDProperty = T.PropertyID 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T13:11:23.643

我会去像

```
SELECT * FROM ItemPropertyValue JOIN PropertyCategory 
```

ON ItemPropertyValue.IDProperty = PropertyCategory.IDProperty WHERE ItemPropertyValue.ItemID=10

您可以通过将 * 替换为字段来限制 SELECT 中的几个字段。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T13:12:55.073

你做得很好，只需在表名中添加别名就可以了

```
SELECT * FROM PropertyCategory a JOIN 
        (SELECT ItemPropertyValue.IDProperty AS PropertyID
        WHERE ItemPropertyValue.IDItem = '10')  b
        ON a.IDProperty = b.PropertyID 
```

# tableview - TableView 中的 JavaFX 设置选择

> ID：14338407
> 
> 赞同：7
> 
> 时间：2013-01-15T13:05:16.970
> 
> 标签：tableview, javafx

如何在 TableView 中设置选择？我希望默认选择第一个索引。

```
productTable.selectionModelProperty().set(value); 
```

这是正确的吗？应该`value`是什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-15T13:27:04.927

提供`TableViewSelectionModel`多种选择方法：

```
productTable.getSelectionModel().selectFirst(); 
```

即使是默认值也应该由某个地方的某个人选择。在你的情况下，是你;)，在一些 init 块中运行上面的代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-09-18T21:00:15.857

通常，`TableViewSelectionModel.select(int index)`或者，如果您没有索引，但您确实有想要选择的对象，则`TableViewSelectionModel.select(T object)`. 文档[在这里](https://openjfx.io/javadoc/15/javafx.controls/javafx/scene/control/TableView.TableViewSelectionModel.html#select(int))。

# r - 简单的ggplot直方图的困难

> ID：14338410
> 
> 赞同：10
> 
> 时间：2013-01-15T13:05:31.977
> 
> 标签：r, ggplot2

我是 R 的绝对初学者，所以请原谅这个问题的简单性。我无法在 R 中加载文件并从一列数据制作直方图。这是我的代码：

```
library('ggplot2')
df <- read.csv('/PATH/TO/FILE', sep=' ', head=FALSE)
vals <- df[,2]
qplot(df, data=vals, geom="histogram")

Error: ggplot2 doesn't know how to deal with data of class numeric 
```

谁能告诉我问题是什么？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-05-11T03:13:29.023

如果您需要频率直方图，请尝试以下代码：

```
ggplot() + aes(vals)+ geom_histogram(binwidth=1, colour="black", fill="white") 
```

# bash - 如何使用 shell 脚本从字符串中删除尾随字符？

> ID：14338416
> 
> 赞同：13
> 
> 时间：2013-01-15T13:06:09.557
> 
> 标签：bash, shell, cut

如何使用 shell 脚本从特定字符串中删除最后*n 个字符？*

这是我的输入：

```
ssl01:49188,,,
ssl01:49188,
ssl01:49188,,,,,
ssl01:49188,ssl999999:49188,,,,,
ssl01:49188,abcf999:49188,,,,, 
```

输出应采用以下格式：

```
ssl01:49188
ssl01:49188
ssl01:49188
ssl01:49188,ssl999999:49188
ssl01:49188,abcf999:49188 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-01-15T13:11:29.600

**要使用指定切割字符串中的最后 n 个字符**来回答您的问题的标题，您可以使用 Bash 中的子字符串提取功能。

```
me@home$ A="123456"
me@home$ echo ${A:0:-2}  # remove last 2 chars
1234 
```

但是，根据您的示例，您似乎想要**删除所有尾随逗号**，在这种情况下您可以使用`sed 's/,*$//'`.

```
me@home$ echo "ssl01:49188,ssl999999:49188,,,,," | sed 's/,*$//'
ssl01:49188,ssl999999:49188 
```

或者，对于纯粹的 Bash 解决方案，您可以使用子字符串删除：

```
me@home$ X="ssl01:49188,ssl999999:49188,,,,,"
me@home$ shopt -s extglob
me@home$ echo ${X%%+(,)}
ssl01:49188,ssl999999:49188 
```

`sed`如果需要将转换应用于整个文件，我将使用该方法，如果目标字符串已经在 bash 变量中，则使用 bash 子字符串删除方法。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-15T13:09:00.393

与`sed`：

```
sed 's/,\+$//' file 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T13:09:20.447

我想你需要删除那些不必要`,`的

```
sed 's/,,//g;s/\,$//g' your_file 
```

测试：

```
> cat temp
ssl01:49188,,,
ssl01:49188,
ssl01:49188,,,,,
ssl01:49188,,,
ssl01:49188,
ssl01:49188,,,,,
ssl01:49188,ssl999999:49188,,,,,
ssl01:49188,abcf999:49188,,,,,
> sed 's/,,//g;s/\,$//g' temp
ssl01:49188
ssl01:49188
ssl01:49188
ssl01:49188
ssl01:49188
ssl01:49188
ssl01:49188,ssl999999:49188
ssl01:49188,abcf999:49188
> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T13:13:55.477

使用 sed：

```
sed 's/,,*$//g' file 
```

# windows-phone-8 - connect bluetooth shield with windows phone 8

> ID：14338421
> 
> 赞同：0
> 
> 时间：2013-01-15T13:06:24.380
> 
> 标签：windows-phone-8, sphero-api

i'm trying to listen for incomming bluetooth-connections from a bluetooth sheild to my WindowsPhone8 device. Is there any way to connect WindowsPhone8 with bluetooth sheild?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:17:07.063

只要远程设备支持蓝牙串行端口协议 (BT-SPP) 并支持配对，您应该能够从 WP8 向其打开 BT-SPP 套接字。

这是连接到 Sphero @ [http://www.developer.nokia.com/Community/Wiki/What%27s_new_in_Windows_Phone_8#Bluetooth:_Phone_to_device的代码示例](http://www.developer.nokia.com/Community/Wiki/What%27s_new_in_Windows_Phone_8#Bluetooth:_Phone_to_device)

这是连接到 Mindwave 移动耳机 @ [http://metroeeg.codeplex.com/wikipage?title=Standalone&referringTitle=Home的代码示例](http://metroeeg.codeplex.com/wikipage?title=Standalone&referringTitle=Home)

# javascript - Doing a super.requestRectangleOnScreen Android

> ID：14338424
> 
> 赞同：0
> 
> 时间：2013-01-15T13:06:53.627
> 
> 标签：javascript, android, html, cordova

I use `PhoneGap` for `Android`

I have some inputs... by clicking on one of them I open a div on all screen (the **same** div) by clicking on the two input everything is normal, but in the third appears to me the following error message in console:

```
Doing a super.requestRectangleOnScreen 
```

What does this mean? **It gives me problems on overriding the back button** ..

Full log output:(When click on input with problem)

```
01-15 15:13:40.360: D/navcache(2231): cursorInputFieldAction cursor=8ef220, cursorFrame=a8cf78
01-15 15:13:40.360: D/navcache(2231): CachedFrame::previousInputField this=a8cf78, start=8ef220, begin=8eee38 end=8ef540
01-15 15:13:40.360: D/navcache(2231): CachedFrame::nextInputField this=a8cf78, start=8ef220, begin=8eee38 end=8ef540
01-15 15:13:40.360: D/navcache(2231): cursorInputFieldAction next=8ef284, prev=0, action=4
01-15 15:13:40.372: D/SoftKeyboardDetect(2231): Ignore this event
01-15 15:13:40.563: D/SoftKeyboardDetect(2231): Ignore this event
01-15 15:13:40.778: V/webview(2231): OnSizeChanged: Enter 
01-15 15:13:41.336: D/SoftKeyboardDetect(2231): Ignore this event
01-15 15:13:41.336: E/webtextview(2231): ....Doing a super.requestRectangleOnScreen.... 
```

Full log output:(When click on input without problem)

```
01-15 15:17:29.813: D/navcache(2231): cursorInputFieldAction cursor=6ac13c, cursorFrame=81aba0
01-15 15:17:29.813: D/navcache(2231): CachedFrame::previousInputField this=81aba0, start=6ac13c, begin=6abcf0 end=6ac3f8
01-15 15:17:29.813: D/navcache(2231): CachedFrame::nextInputField this=81aba0, start=6ac13c, begin=6abcf0 end=6ac3f8
01-15 15:17:29.813: D/navcache(2231): cursorInputFieldAction next=6ac1a0, prev=6ac0d8, action=5
01-15 15:17:29.836: D/SoftKeyboardDetect(2231): Ignore this event
01-15 15:17:30.196: V/webview(2231): OnSizeChanged: Enter 
01-15 15:17:30.598: D/SoftKeyboardDetect(2231): Ignore this event
01-15 15:17:30.598: I/dalvikvm(2231): Jit: resizing JitTable from 4096 to 8192
01-15 15:17:30.680: D/SoftKeyboardDetect(2231): Ignore this event 
```

the Error input:

```
 <input onkeydown="X();" onclick="OpenOnScreen();" oninput="XXX();" type="text"  id="ErrorInp"  /> 
```

the Good input:

```
 <input onkeydown="X();" onclick="OpenOnScreen();" oninput="XXX();"  type="text" id="GoodInp" /> 
```

the DIV that open on all screen:

```
<div id="OpenDiv">
           ...
        </div> 
```

Style:

```
#OpenDiv
{
    background-color: yellowGreen;
    width: 100%;
    height: 100%;
    position: absolute;
    z-index: 7000;
    display: none;
} 
```

Function OpenOnScreen:

```
function OpenOnScreen() {
    $('#OpenDiv').css('display', 'block');
} 
```

When I define the height of the div to 80% I do not get this error message and the back button works, why is this happening? (I need its height will be 100%)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:33:16.413

此输出不是错误。它只是请求此视图的矩形在屏幕上可见。如果 View 维护了关于其内容的哪一部分有趣的概念，则应该调用它。例如，文本编辑视图应该在其光标移动时调用它。

我猜，不能告诉你为什么（我看不到你的代码） phonegap 正在访问当前**View中的矩形****Rect**对象。所以忽略这个，这只是一个后台java通知。

 **我在此输出中看不到任何真正的错误，因此我认为您的问题出在 javascript 方面。**

# arrays - Reading data from excel into a vector

> ID：14338437
> 
> 赞同：1
> 
> 时间：2013-01-15T13:07:28.080
> 
> 标签：arrays, excel, clojure

How do i read in data from csv files into a vector of vectors.

In other words each row would be a vector and each column would be an element inside the vector. It would be like a 2D array [row][col]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:02:07.000

您应该简单地使用现有的 csv 库，例如[clojure-csv](https://github.com/davidsantiago/clojure-csv)或[data.csv](https://github.com/clojure/data.csv)。

例如 data.csv 就像

```
(require '[clojure.data.csv :as csv]
         '[clojure.java.io :as io])

(with-open [in-file (io/reader "in-file.csv")]
  (doall
    (csv/read-csv in-file))) 
```

（示例取自[这里](https://github.com/clojure/data.csv#example-usage)）

`csv/read-csv``vec`将返回一个惰性向量序列，您可以使用（如果您真的需要）将其转换为字符串向量的向量。

# php - PHP & jQuery datetime picker

> ID：14338440
> 
> 赞同：0
> 
> 时间：2013-01-15T13:07:34.647
> 
> 标签：php, jquery, datepicker

I am using the jQuery datetime picker to take the user input .

I have dateformat like `dateFormat: "d-MM-yy", in my jQuery setting it returns the date like

```
15-January-2013 20:00 
```

Unfortunately my php db accepting the value in `2013-01-20 20:00` format

I can use php `strotime()` to parse the date exactly like `2013-01-15 20:00` but this can causes the timezone error so i want to `2013-01-15 20:00` as a raw string to the php side .

Is their any way so that user can see like `15-January-2013 20:00` in input box and my php program will get the `2013-01-15 20:00` value .

**Update**

I want `15-January-2013 20:00` to be `2013-01-15 20:00` in php side

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:27:45.260

The jQuery Datepicker supports an alternate form field. This field can be hidden and you can set it up to fill it with a more php friendly date string.

Example:

```
<input type="hidden" id="phpDate" />
<input type="text" id="date" /> 
```

JavaScript

```
$( "input#date" ).datetimepicker({ altField: "#phpDate", altFormat: "yy-mm-dd", altTimeFormat:"HH:mm" }); 
```

See the [Datepicker altField/altFormat documentation](http://api.jqueryui.com/datepicker/#option-altField) and the [Datetimepicker options](http://trentrichardson.com/examples/timepicker/#tp-options) for details.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:22:01.943

这就是我在 php 文件中所做的插入数据库（MySql）

```
DateTime::createFromFormat('d-m-Y', $date)->format('Y-m-d') 
```

它仅用于日期，因为我单独使用时间。如果您在 php.net 上查看，不难弄清楚如何一起更新日期和时间。

# ruby-on-rails - Rails，Ransack，HABTM - 多选时为空结果

> ID：14338448
> 
> 赞同：0
> 
> 时间：2013-01-15T13:07:55.453
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

我有一个表格：

```
<%= f.collection_select :carburants_id_eq_all, Carburant.order(:name), :id, :name, {}, { multiple: true } %> 
```

当我只选择 1 个 Carburant 时，它会正常呈现结果，但如果我选择超过 1 个 Carburant，则结果为空。

这是我在 'index.html.erb' 中的表格：

```
<%= search_form_for @search do |f| %>

  <%= f.label :title_cont, "Name contains" %>
  <%= f.text_field :title_cont %>

  <%= f.collection_select :carburants_id_eq_all, Carburant.order(:name), :id, :name, {}, { multiple: true } %>

  <%= f.submit "Search" %>
<% end %> 
```

我在“post_controller.rb”中的索引操作：

```
def index
  @search = Post.search(params[:q])
  @posts = @search.result(distinct: true)
end 
```

我的 post.rb、carburant.rb 和 category.rb 模型：

```
class Category < ActiveRecord::Base
  attr_accessible :carburant_id, :post_id
  belongs_to :carburant
  belongs_to :post
end

class Post < ActiveRecord::Base
  attr_accessible :content, :title, :carburant_ids
  has_many :categories
  has_many :carburants, through: :categories
end

class Carburant < ActiveRecord::Base
  attr_accessible :name
  has_many :categories
  has_many :posts, through: :categories
end 
```

我的数据库shema：

```
ActiveRecord::Schema.define(:version => 20130114004613) do
     create_table "carburants", :force => true do |t|
        t.string   "name",       :limit => nil
        t.datetime "created_at"
        t.datetime "updated_at"
     end

    create_table "categories", :force => true do |t|
      t.integer  "post_id"
      t.integer  "carburant_id"
      t.datetime "created_at",   :null => false
      t.datetime "updated_at",   :null => false
    end

    create_table "posts", :force => true do |t|
     t.string   "title"
     t.text     "content"
     t.datetime "created_at"
     t.datetime "updated_at"
    end

   create_table "recherches", :force => true do |t|
    t.string   "title"
    t.integer  "carburant_id"
    t.datetime "created_at",   :null => false
    t.datetime "updated_at",   :null => false
   end
end 
```

提前谢谢你。

**编辑1：**

我尝试在我的表格中将 :carburants_id_eq_all 替换为 :carburants_id_eq_any 只是为了测试，它与 EQ_ANY 谓词完美配合，但仍然不能与 EQ_ALL 配合使用。

# android - Android 手机中服务器 HTTP 响应的状态码打印在响应正文中

> ID：14338449
> 
> 赞同：0
> 
> 时间：2013-01-15T13:07:57.800
> 
> 标签：android, httpresponse, core

我正在为 Android 使用[http://hc.apache.org/httpcomponents-core-ga/httpcore/examples/org/apache/http/examples/ElementalHttpServer.java](http://hc.apache.org/httpcomponents-core-ga/httpcore/examples/org/apache/http/examples/ElementalHttpServer.java) 。

我使用以下代码设置响应：

```
HttpResponse getResponse = new BasicHttpResponse(HttpVersion.HTTP_1_1, 404, "Not Found");
getResponse.setEntity(new StringEntity(new String("The requested resource " + target + " could not be found due to mismatch!!")));  
conn.sendResponseHeader(getResponse);
conn.sendResponseEntity(getResponse); 
```

我在 Mozilla Poster 或浏览器中的响应具有标头 404 和响应正文：

```
The requested resource  could not be found due to mismatch!!HTTP/1.1 200 OK 
```

如何仅获取 HTTP 正文字符串？为什么我得到 HTTP/1.1 200 OK 作为响应。我没有在我的代码中设置它。任何帮助表示赞赏。

![在此处输入图像描述](../Images/b8e39e95372937b238008779e9f57ecd.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:12:03.367

使用[`ResponseHandler`](http://svn.apache.org/repos/asf/httpcomponents/httpclient/branches/4.0.x/httpclient/src/examples/org/apache/http/examples/client/ClientWithResponseHandler.java). 一行代码。有关使用它的示例 Android 项目，请参见[此处](http://github.com/commonsguy/cw-android/tree/master/Service/WeatherPlus/)和[此处](http://github.com/commonsguy/cw-andtutorials/tree/master/15-HttpClient/Patchy/)。

```
public void postData() {
    // Create a new HttpClient and Post Header
    HttpClient httpclient = new DefaultHttpClient();
    HttpPost httppost = new HttpPost("http://www.yoursite.com/user");

    try {
        // Add your data
        List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
        nameValuePairs.add(new BasicNameValuePair("id", "12345"));
        nameValuePairs.add(new BasicNameValuePair("stringdata", "AndDev is Cool!"));
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

        // Execute HTTP Post Request
        ResponseHandler<String> responseHandler=new BasicResponseHandler();
        String responseBody = httpclient.execute(httppost, responseHandler);
        JSONObject response=new JSONObject(responseBody);
    } catch (ClientProtocolException e) {
        // TODO Auto-generated catch block
    } catch (IOException e) {
        // TODO Auto-generated catch block
    }
} 
```

[在 - http://www.androidsnippets.org/snippets/36/](http://www.androidsnippets.org/snippets/36/)添加这篇文章和完整的 HttpClient 的组合

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:25:54.823

这可能会帮助你......我认为这`response` 是你需要的

```
HttpClient client = new DefaultHttpClient();

        HttpResponse httpResponse;

        try {
            httpResponse = client.execute(request);
            responseCode = httpResponse.getStatusLine().getStatusCode();
            message = httpResponse.getStatusLine().getReasonPhrase();

            HttpEntity entity = httpResponse.getEntity();

            if (entity != null) {

                InputStream instream = entity.getContent();
                response = convertStreamToString(instream);

                // Closing the input stream will trigger connection release
                instream.close();
            }

        } catch (ClientProtocolException e) {
            client.getConnectionManager().shutdown();
            e.printStackTrace();
        } catch (IOException e) {
            client.getConnectionManager().shutdown();
            e.printStackTrace();
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-18T09:03:23.507

我定义的 handle() 方法有问题。我为每个请求创建一个新的 HttpResponse 而不是使用传入的响应

```
public void handle(HttpRequest request, HttpResponse response, HttpContext context) 
```

# hibernate - Hibernate 4 - 未启用 getGeneratedKeys() 支持

> ID：14338450
> 
> 赞同：7
> 
> 时间：2013-01-15T13:08:03.327
> 
> 标签：hibernate, generator, sequence

我们处于将休眠模式从 3.6 升级到 4.1.9 的模式，我遇到了一个错误

> `[#|2013-01-14T18:33:46.519+0530|INFO|glassfish3.1.1|javax.enterprise.system.std.com.sun.enterprise.server.logging|_ThreadID=122;_ThreadName=Thread-3;|2013-01-14 18:33:46,518 [http-thread-pool-8080(5)] ERROR envId{} - sesId{} - com.spmsoftware.webframework.exception.ExceptionHandlerUtil[31]-Unhandled exception! org.hibernate.AssertionFailure: getGeneratedKeys() support is not enabled at org.hibernate.engine.jdbc.internal.StatementPreparerImpl.checkAutoGeneratedKeysSupportEnabled(StatementPreparerImpl.java:93) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.engine.jdbc.internal.StatementPreparerImpl.prepareStatement(StatementPreparerImpl.java:112) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.id.SequenceIdentityGenerator$Delegate.prepare(SequenceIdentityGenerator.java:106) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.id.insert.AbstractReturningDelegate.performInsert(AbstractReturningDelegate.java:55) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:2936) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.persister.entity.AbstractEntityPersister.insert(AbstractEntityPersister.java:3447) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.action.internal.EntityIdentityInsertAction.execute(EntityIdentityInsertAction.java:81) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:362) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.engine.spi.ActionQueue.addResolvedEntityInsertAction(ActionQueue.java:203) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.engine.spi.ActionQueue.addInsertAction(ActionQueue.java:183) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.engine.spi.ActionQueue.addAction(ActionQueue.java:167) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.event.internal.AbstractSaveEventListener.addInsertAction(AbstractSaveEventListener.java:320) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.event.internal.AbstractSaveEventListener.performSaveOrReplicate(AbstractSaveEventListener.java:287) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.event.internal.AbstractSaveEventListener.performSave(AbstractSaveEventListener.java:193) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.event.internal.AbstractSaveEventListener.saveWithGeneratedId(AbstractSaveEventListener.java:126) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.ejb.event.EJB3PersistEventListener.saveWithGeneratedId(EJB3PersistEventListener.java:78) ~[hibernate-entitymanager-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.event.internal.DefaultPersistEventListener.entityIsTransient(DefaultPersistEventListener.java:208) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:151) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.event.internal.DefaultPersistEventListener.onPersist(DefaultPersistEventListener.java:78) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.internal.SessionImpl.firePersist(SessionImpl.java:843) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:818) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.internal.SessionImpl.persist(SessionImpl.java:822) ~[hibernate-core-4.1.9.Final.jar:4.1.9.Final] at org.hibernate.ejb.AbstractEntityManagerImpl.persist(AbstractEntityManagerImpl.java:865) ~[hibernate-entitymanager-4.1.9.Final.jar:4.1.9.Final]`

当我尝试持久化具有以下定义的休眠实体时会出现此错误

```
@Entity
@Table(name = "ACCESS")
@GenericGenerator(name = "auth-generator",
    strategy = "sequence-identity",
    parameters = @org.hibernate.annotations.Parameter(name = "sequence", value = "ACCESS_SEQ"))
 public class Access implements Identifiable {
    private Long id;

   @Id
   @GeneratedValue(generator = "auth-generator")
   @Column(name = "ROW_IDENTIFIER", nullable = false)
    public Long getId() {
        return id;
    }
 } 
```

在比较 3.6 的休眠源代码时，我看到在为 SequenceIdentityGenerator 创建准备好的语句时，休眠不检查“hibernate.jdbc.use_get_generated_keys”（AbstractBatcher - 506）和版本 4.1.9（StatementPreparerImpl - 112）。

因此，我们的应用程序升级失败。知道这种变化背后的原因是什么吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-19T14:59:50.340

我陷入了同样的问题。终于找到了出路。将此行放在您的 hibernate.cfg.xml 文件中。

```
<property name="hibernate.jdbc.use_get_generated_keys">true</property> 
```

并且可以在以下位置找到参考和解释：

[http://www.jarvana.com/jarvana/view/hibernate/hibernate/3.0.2/hibernate-3.0.2-sources.jar!/org/hibernate/jdbc/AbstractBatcher.java?format=ok](http://www.jarvana.com/jarvana/view/hibernate/hibernate/3.0.2/hibernate-3.0.2-sources.jar!/org/hibernate/jdbc/AbstractBatcher.java?format=ok)

# php - PHP pdo查询执行错误

> ID：14338451
> 
> 赞同：0
> 
> 时间：2013-01-15T13:08:05.023
> 
> 标签：php, sql-server, pdo

我将 php 与 pdo 一起使用并`pdo_dblib`执行长选择查询（在这种情况下）。如果我直接在 sql 中运行此查询，我会收到结果，但如果我从 php 运行它，我会收到

`207 General SQL Server error: Check messages from the SQL Server [207] (severity 16) [(null)]`

我`debugDumpParams`用来查看准备后的查询是什么，但它只从查询中转储前 500 个字符，这可能是问题所在。这是一些配置参数还是一个错误？

操作系统：Slackware PHP：5.4.7 pdo_dblib - 由我自己编译 freetds - 来自[http://slackbuilds.org/](http://slackbuilds.org/)

[PDO::debugDumpParams 的输出是否有最大值？](https://stackoverflow.com/questions/13016978/is-there-a-maxium-to-the-output-of-pdodebugdumpparams)

**编辑：**

代码：

```
<?php
$dsn = 'dblib:host=XXXXXXXX;dbname=XXXXX';
$username='XXXXX';
$password='XXXXXXX';

$query = "select * from (
                select Row_Number() over (order by 
                order_status.id desc) as RowIndex,  
                order_status.id as ID,
                order_status.caller_type_id as CALLER_TYPE_ID,
                order_status.phone as PHONE,
                order_status.order_number as ORDER_NUMBER,
                order_status.caller_client_data_id as CLIENT_DATA_ID,
                order_status.caller_contact_phone_id as CALLER_CONTACT_PHONE_ID,
                order_status.record_date as DATE,
                order_status.call_date as CALL_DATE,
                order_status.call_time as jueCALL_TIME,
                order_status.username as USERNAME,
                client_data.ID as CALLER_ID,
                client_data.client_type_id as CLIENT_TYPE_ID,
                client_data.name as NAME,
                client_data.person as PERSON,
                client_data.country_id as COUNTRY_ID,
                client_data.city as CITY,
                client_data.street as STREET,
                client_data.street_number as STREET_NUMBER,
                client_data.living_complex as LIVING_COMPLEX,
                client_data.building as BUILDING,
                client_data.entrance as ENTRANCE,
                client_data.floor as FLOOR,
                client_data.apartment as APARTMENT,
                client_data.postal_code as POSTAL_CODE,
                client_data.description as DESCRIPTION,
                client_data.email as EMAIL,
                country.name as COUNTRY,
                client_type.type as CLIENT_TYPE,
                caller_type.name as CALLER_TYPE,
                contact_phone.phone as CALLER_CONTACT_PHONE
                from order_status order_status
                inner join client_data client_data on client_data.id = order_status.caller_client_data_id
                inner join client_type client_type on client_type.id = client_data.client_type_id
                inner join country country on country.id = client_data.country_id
                inner join caller_type caller_type on caller_type.id = order_status.caller_type_id
                inner join contact_phone on contact_phone.id = order_status.caller_contact_phone_id
             where 1=1 ) as Sub Where Sub.RowIndex >= ? and Sub.RowIndex < ?";

$db = new PDO($dsn, $username, $password);
$prepare = $db->prepare($query, array(PDO::ATTR_CURSOR => PDO::CURSOR_FWDONLY));
$bind = array(1, 11);
if (!$prepare->execute($bind)) {
    $prepare->debugDumpParams();
} else {
    echo "success";
} 
```

输出：

```
SQL: [1841] select * from (
                select Row_Number() over (order by 
                order_status.id desc) as RowIndex,  
                order_status.id as ID,
                order_status.caller_type_id as CALLER_TYPE_ID,
                order_status.phone as PHONE,
                order_status.order_number as ORDER_NUMBER,
                order_status.caller_client_data_id as CLIENT_DATA_ID,
                order_status.caller_contact_phone_id as CALLER_CONTACT_PHONE_ID,
                order_status.record_date as DATE,
                order_status.call_date as CALL_DATE,
                order_status.call_time as jueCALL_T
Params:  2
Key: Position #0:
paramno=0
name=[0] ""
is_param=1
param_type=2
Key: Position #1:
paramno=1
name=[0] ""
is_param=1
param_type=2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T08:31:45.177

我为失去你的时间而道歉。我发现我的错误 - 在 MSSQL 中连接到 2 个不同的数据库。

如果我在 freetds 配置中启用转储文件，仍然会出现PS`Segmentation fault`错误，但我仍然不知道如何设置`debugDumpParams`为输出超过 500 个字符[PDO::debugDumpParams 的输出是否有最大值？](https://stackoverflow.com/questions/13016978/is-there-a-maxium-to-the-output-of-pdodebugdumpparams)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T06:17:06.373

在服务器上为 PDO 进程设置 TDSDUMP 环境变量。该日志将捕获您需要的缺失消息和详细信息。

# wpf - 要标记的 C# WPF 类属性

> ID：14338453
> 
> 赞同：1
> 
> 时间：2013-01-15T13:08:17.127
> 
> 标签：wpf, class, properties, label

我有以下课程：

```
class MyTimer
{
    class MyTimerInvalidType : SystemException
    {
    }
    class MyTimerNegativeCycles : SystemException
    {
    }

    private Timer timer = new Timer(1000);
    private int cycles = 0;

    public int Cycle
    {
        get
        {
            return this.cycles;
        }

        set
        {
            if(value >= 0)
                this.cycles = value;
            else
                throw new MyTimerNegativeCycles();
        }
    }

    private void timer_Tick(object sender, ElapsedEventArgs e)
    {
        try
        {
            this.Cycle--;
        }
        catch
        {
            this.Cycle = 0;
            timer.Stop();
        }
    }

    public MyTimer()
    {
        this.Cycle = 20;

        timer.Elapsed += new ElapsedEventHandler(timer_Tick);
        timer.Start();
    }
} 
```

在我的 MainWindow 类中，我有一个列表，我在按下按钮时添加了一个 MyTimer：

```
private List<MyTimer> timers = new List<MyTimer>();

private void testbtn_Click(object sender, RoutedEventArgs e)
{
    timers.Add(new MyTimer());
} 
```

我试图将标签作为引用传递给 MyTimer 类并对其进行更新，但这不起作用（无法从另一个线程访问 UI 元素）。

在标签中显示 MyTimer.Cycle 以便在每次更改值时更新的好方法是什么？

我必须能够将每个 MyTimer 与代码“绑定”到不同的标签（或根本不将其绑定到标签）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:18:07.840

解决问题的最简单方法是使用[DispatchTimers](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)。调度计时器使用 Windows 消息队列而不是线程来调度计时器滴答事件。这将使您没有跨线程问题。请记住，您不再在其他线程上工作，并且如果您执行任何计算成本很高的操作，可能会锁定 UI。此外，由于消息队列上调度的性质，时间不太准确。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:23:40.737

在 WPF 中，您将拥有一个与您的视图 (XAML) 关联的 ViewModel (C#)。
如果您不熟悉 MVVM，请阅读此内容。

然后 ViewModel 将公开一个属性（我们称之为 Cycle），View 将在该属性上绑定：

```
<Label Content="{Binding Cycle}" /> 
```

然后，如果必须从另一个线程更新 ViewModel 中的值，请执行以下操作：

```
Application.Current.Dispatcher.Invoke(new Action(() => 
{
    //Update here
})); 
```

这将在 UI 线程上执行更新逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:49:23.697

您应该使用标签属性的[`BeginInvoke`](http://msdn.microsoft.com/en-us/library/cc190824.aspx)or[`Invoke`](http://msdn.microsoft.com/en-us/library/hh199416.aspx)方法[`Dispatcher`](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherobject.dispatcher.aspx)来更改标签上的任何内容或调用它的任何方法：

```
private void timer_Tick(object sender, ElapsedEventArgs e)
{
    try
    {
        this.Cycle--;
        this.label.Dispatcher.BeginInvoke(new Action(
            () => { label.Text = this.Cycle.ToString(); } ));
    }
    catch
    {
        this.Cycle = 0;
        timer.Stop();
    }
} 
```

[`Dispatcher`请参阅类](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcher.aspx)或[`Dispatcher`属性](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatcherobject.dispatcher.aspx)的备注部分。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T14:41:38.243

如果您是 WPF 的新手，我强烈建议您阅读一些有关[DataBinding](http://msdn.microsoft.com/en-us/library/ms752347.aspx)和[Data Templating](http://msdn.microsoft.com/en-us/library/ms742521.aspx)的内容。

首先，在旧的 UI 模型（如 Windows 窗体）中显示 Windows 数据的最简单方法一直是在代码隐藏中设置一些 UI 属性。这在 WPF 中发生了巨大的变化，现在的目标是让 UI 查看业务对象（如您的 MyTimer）并相应地设置 UI。

首先，我们需要将您的业务对象公开给您的应用程序的 xaml。

```
Me.DataContext = new MyTimer(); 
```

这会将 Window/UserControl 的数据上下文设置为 a`new MyTimer();`因为该`DataContext`属性自动基于从父 UI 元素到子 UI elelement（除非子定义它自己的`DataContext`），所以 Window/UserControl 中的每个元素现在都将具有`DataContext`这个对象的。

接下来我们可以创建一个绑定到这个对象的属性。默认情况下，所有绑定都相对于`DataContext`它所在的控件。

```
<Label Content="{Binding Cycle}" /> 
```

所以在前面的例子中，绑定是在标签的 content 属性上。所以在这种情况下，它会自动将 Content 设置为 DataContext (MyTimer) 中的“Cycle”属性的值！

然而，有一个问题。如果您按原样运行此示例，WPF 将在表单加载时获取该值，但它不会再次更新标签！这里更新 UI 的关键是实现`INotifyPropertyChanged`接口。

每当属性（例如您的 Cycles）发生更改时，此接口都会简单地告诉任何侦听器。很棒的是 Bindings 自动支持这个接口，并且会在你的源实现时自动传播更改`INotifyPropertyChanged`。

```
public class MyTimer : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private int cycles;

    public int Cycles
    {
        get
        {
            return cycles;
        }
        set
        {
            if (cycles < 0)
            {
                throw new ArgumentOutOfRangeException("value", "Cycles cannot be set to a number smaller than 0.");
            }
            else if(value <> cycles)
            {
                cycles = value;

                if (PropertyChanged != null)
                {
                    PropertyChanged(Me, new PropertyChangedEventArgs("Cycles"))
                }
            }
        }
    }

    //insert your constructor(s) and timer code here.
} 
```

瞧！您的计时器现在将使用它的循环属性更新 UI。

但是，您还注意到您将 MyTimer 对象存储在列表中。如果您要将它们放在一个`ObservableCollection`（默认实现`INotifyCollectionChanged`- INotifyPropertyChanged 的​​集合变体）中，您可以做其他巧妙的技巧：

在您的 Window/UserControl 构造函数中：

```
ObservableCollection<MyTimer> timers = New ObservableCollection<MyTimer>();
timers.Add(New MyTimer());
DataContext = timers; 
```

然后你可以在你的 xaml 中一次显示它们：

```
<ItemsControl ItemsSource="{Binding}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <Label>
                <TextBlock Text="{Binding StringFormat='Cycles Remaining: {0}'}" />
            </Label>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

# asp-classic - 使用 Classic ASP 和 ImageMagick 将 SVG 转换为 PNG

> ID：14338457
> 
> 赞同：0
> 
> 时间：2013-01-15T13:08:20.477
> 
> 标签：asp-classic, svg, imagemagick-convert

我正在尝试使用 ImageMagick 将 SVG 转换为 PNG。

从命令行将 SVG 转换为 PNG 效果很好：

```
Convert -size 200x200 svglogo.svg generatedimage.png 
```

它产生了一个我期待的.png。

然而，

```
Img.Convert "-size", "200x200", "C:\myApp\temp\svglogo.svg", "C:\myApp\temp\pleasemakethiswork.png" 
```

生成了一个只有白色背景的空白 .png。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T15:34:42.980

尝试这个：

Img.Convert "C:\myApp\temp\svglogo.svg", "-resize=200x200", "C:\myApp\temp\pleasemakethiswork.png"

# data-binding - 如何在 AngularJS 中使用收音机和复选框绑定到复杂对象？

> ID：14338466
> 
> 赞同：11
> 
> 时间：2013-01-15T13:08:47.350
> 
> 标签：data-binding, checkbox, radio-button, angularjs

假设我们有一组通过项目服务公开的项目：

```
{ id: '123', name: 'Yeoman', watchers: '1233', ... }
{ id: '123', name: 'Grunt', watchers: '4343', ... } 
```

然后，我们有一个表格来选择您喜欢的项目：

```
Select favorite project:
%label.radio(ng-repeat="project in Project.query()")
  %input(type="radio" ng-model="data.favoriteProject" value="{{project.id}}") {{project.name}} 
```

这会将choices.favoriteProject 设置为所选项目的id 值。通常，我们需要访问相关对象，而不仅仅是 id：

```
John's favorite project:
{{Project.get(data.favoriteProject).name}} 
```

我正在寻找的是一种将收音机和复选框直接绑定到对象本身而不是 id 的方法，所以我们可以这样做

```
John's favorite project:
{{data.favoriteProject.name}} 
```

反而。这可以通过 ng-options 使用 select 指令来实现，但是我们如何使用收音机和复选框来做到这一点？如果可能的话，我仍然想使用 id 进行匹配而不是引用。

为了澄清，这是我正在寻找的一个例子

```
Select favorite project:
%label.radio(ng-repeat="project in Project.query()")
  %input(type="radio" ng-model="data.favoriteProject" value="{{project}}" ng-match="id") {{project.name}} 
```

它说：“请将 data.favoriteProject 绑定到实际的项目对象并使用 id 检查它们是否匹配（而不是引用）”。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-16T06:20:43.240

**[更新]**

`ngValue`在发现似乎没有记录的指令后，我完全改变了我的答案。它允许您绑定对象，而不仅仅是字符串作为`ngModel`单选按钮输入的值。

```
<label ng-repeat="project in projects">
  <input type="radio" ng-model="data.favoriteProject"
    ng-value="project">{{project.name}}</input>
</label>

<p>Your favorite project is {{data.favoriteProject.name}}.</p> 
```

这使用引用来检查，而不仅仅是 ID，但我认为在大多数情况下，这就是人们要寻找的。如果您*非常*严格地只想根据 ID 进行匹配，您可以使用下面的**[Old Answer]**，或者甚至更好，只需创建一个函数——例如`projectById(projectId)`，您可以使用它来根据其 ID 查找项目。

我已经更新了 JSFiddle 来演示：http: [//jsfiddle.net/BinaryMuse/pj2GR/](http://jsfiddle.net/BinaryMuse/pj2GR/)

* * *

**[旧答案]**

也许您可以利用`ng-change`单选按钮指令的属性来实现您想要的。考虑这个 HTML：

```
<p>Select your favorite project:</p>
<label ng-repeat="project in projects">
  <input type="radio" ng-model="data.favoriteProjectId" value="{{project.id}}"
         ng-change="data.favoriteProject = project">
    {{project.name}}
  </input>
</label>

<p>Your favorite project is {{data.favoriteProject.name}}.</p> 
```

`ng-change`例如，您也可以在内部调用一个函数`setfavoriteProject(project)`——但为了简单起见，我在这里没有这样做。

这是一个演示该技术的工作 jsFiddle：http: [//jsfiddle.net/BinaryMuse/pj2GR/7/](http://jsfiddle.net/BinaryMuse/pj2GR/7/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T21:08:58.963

不需要 ng-change（而且我不确定，编写这样的内联代码是否是一种好习惯。另一方面，角度指令本身离它并不太远）。为什么不这样做（也适用于 ng-repeat）：

小提琴：http: [//jsfiddle.net/JohannesJo/VeZxh/3/](http://jsfiddle.net/JohannesJo/VeZxh/3/)

代码：

```
<body ng-app="app">
<div ng-controller='controller'>
<input type = "radio" ng-model = "oSelected"  value = "{{aData[0]}}">
<input type = "radio" ng-model = "oSelected"  value = "{{aData[1]}}">
<div>test:     {{oSelected}}</div>
</div>
</body>

app = angular.module('app',[]);

app.controller('controller', function($scope){
$scope.aData = [
    {o:1},
    {o:2}
];
$scope.oSelected = {};
}); 
```

编辑：我也许应该提到这不适用于复选框，因为值将是真或假。此外，共享模型将导致所有复选框同时被选中或取消选中。

# c++ - 将结构对象作为参数传递给线程

> ID：14338470
> 
> 赞同：1
> 
> 时间：2013-01-15T13:08:56.940
> 
> 标签：c++, multithreading

此代码成功运行，MQStruct 构造函数也初始化了值，我可以在 ExecuteThread 函数中看到，但在 TestFunction 中，我得到了 MQStruct 的垃圾值。

我将 struct "&MQStructObj" 的地址传递给 _beginthreadex 以获取参数，这就是我猜的问题

```
struct MQStruct {
    MQStruct()
    {
        pointer=NULL;
        serviceName=NULL;
        durability=0;
        msgType=0;
        msgHeader=0;
        msgId=NULL;
        payload=NULL;
        payloadSize=0;
        ttl=0;
        priority=0;
    }

    void* pointer;
    wchar_t *serviceName; 
    int durability; 
    int msgType; 
    int msgHeader; 
    wchar_t *msgId; 
    wchar_t *payload; 
    int payloadSize; 
    int ttl; 
    int priority;
};

int ExecuteThread() {

    HANDLE   heartBeatThread;
    unsigned int hbThreadID;
    int result = 0;

        MQStruct MQStructObj;
        MQStructObj.pointer=this;

    heartBeatThread = (HANDLE)_beginthreadex(NULL, 0 , &TestFunction, &MQStructObj, 0/*CREATE_SUSPENDED*/, &hbThreadID);

    if ( heartBeatThread == 0 )
    {
        result = -1;
        LogEvent(DEBUG_LOG,0, "Fail to create thread");
    }

    CloseHandle(heartBeatThread);

    return result;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:11:49.933

你猜对了。

您将局部变量的地址传递给您的 thread-proc-startup，然后离开作用域（并销毁进程中的对象）。在您的线程过程中对该对象的引用是在未定义的行为之后。

动态分配一个`new`并让线程处理`delete`它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T13:12:28.873

`MQStructObj`在堆栈上声明，因此将超出范围并可能在`ExecuteThread`完成后立即被覆盖。

如果你想在这里使用堆栈对象，你需要添加一些同步来允许你的新线程在返回`MQStructObj`之前复制。`ExecuteThread`

或者，通常最好，您可以`MQStructObj`动态分配并让新线程在空闲时清理它

```
MQStruct* MQStructObj = new MQStruct();
MQStructObj->pointer=this;
heartBeatThread = (HANDLE)_beginthreadex(NULL, 0 , &TestFunction, MQStructObj, 0, &hbThreadID);
if ( heartBeatThread == 0 ) { // error
    delete MQStructObj;
    result = -1;
}
// ownership of MQStructObj transferred to new thread 
```

# jquery - jQuery 显示水平缩放多个标记

> ID：14338472
> 
> 赞同：0
> 
> 时间：2013-01-15T13:09:03.213
> 
> 标签：jquery

我正在寻找 jQuery 解决方案来在水平刻度线上显示 4 个值。这些值是最小值、最大值、平均值和电流。它不是二维图。只是在一条水平线上的一个简单的 4 个点，标记指向这些点。

为了展示我想要实现的目标，这是一个草图

![在此处输入图像描述](../Images/7c65a842cf6192a6b37c4a5eedbec3d0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:18:58.087

我首先想到的是[jQuery UI 滑块](http://jqueryui.com/slider/)。它支持多个句柄，如果仅用于显示目的，您可以将其禁用。

```
$(function() {
    $mySlider = $("#slider-range");
    $mySlider.slider({

      min: 0,
      max: 1000,
      values: [ 75, 125, 175, 225 ],
      slide: function( evt, ui ) {
          a = [];
          for(var i=0; i<ui.values.length; i++) {
              a.push(ui.values[i]);
          }

          $( "#amount" ).val( "$" + a.join(" - " + "$") );
      }
    });

    $( "#amount" ).val(
      ["$" + $mySlider.slider("values", 0),
       "$" + $mySlider.slider("values", 1),
       "$" + $mySlider.slider("values", 2),
       "$" + $mySlider.slider("values", 3)].join(" - ")
    );
}); 
```

## [小提琴](http://jsfiddle.net/5TTm4/583/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:32:07.273

查看[jQuery Slider 插件](http://egorkhmelev.github.com/jslider/)，我认为它会满足您的需求并且很容易实现。

**编辑**

要使其只读，您可以在滑块顶部放置一个透明元素，从而防止用户手动移动它。

# c# - 我可以为使用套接字而不是“Windows 商店应用程序库”的 Windows 商店应用程序编写一个库吗？

> ID：14338475
> 
> 赞同：1
> 
> 时间：2013-01-15T13:09:20.313
> 
> 标签：c#, sockets, windows-store-apps

我正在编写一个库，该库使用 Windows 商店应用程序使用的 UDP 套接字。

Windows 商店应用程序可以引用直接使用 Winsock 的本机库吗？

Windows 商店应用程序是否可以引用为 .Net 4.5 编写的 CLR 库，该库使用 System.Net 中的套接字。

或者我是否必须将库编写为 Windows 商店应用程序库并使用 Windows.Networking.Sockets API？

（我怀疑我知道答案只是为了确定。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T15:17:29.620

> Windows 商店应用程序可以引用直接使用 Winsock 的本机库吗？

不，Store 验证器将拒绝任何尝试使用 Winsock 函数的程序。

> Windows 商店应用程序是否可以引用为 .Net 4.5 编写的 CLR 库，该库使用 System.Net 中的套接字。

您不能编写这样的库。选择 .NETCore 配置文件（PCL 或应用商店应用程序）会阻止使用 System.Net.Socket 类。它只是丢失了，会产生编译错误。

需要使用 WinRT Windows.Networking.Sockets.DatagramSocket 类型才能使 UDP 进入应用商店应用程序。此类型与在应用程序清单中强制执行请求的网络功能的应用商店应用沙箱兼容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T14:55:30.653

我做过类似的事情，但最终答案是否定的。

您基本上使用可移植类库来完成大部分工作，并抽象出任何基于套接字的工作。然后在类库和 Windows 存储类库中创建抽象的实现。

这很好用，我强烈推荐这个，但我不敢回答你的问题，你不能。

# java - 如何使用 JFrame 在另一台显示器上打开另一个 JFrame 窗口？

> ID：14338480
> 
> 赞同：1
> 
> 时间：2013-01-15T13:09:30.050
> 
> 标签：java, swing, jframe, awt, multiple-monitors

我正在编写一个旨在在两个监视器系统上工作的程序。我必须分离`JFrame`对象，并让它成为默认值，第一个框架实例打开。然后，用户必须将该帧拖到特定的监视器上，或者将其留在原处。当他们单击该框架上的按钮时，我希望程序在对面的监视器上打开第二个框架。

那么，我如何确定一个框架对象在哪个监视器上，然后告诉另一个框架对象在对面打开？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:21:20.620

查看GraphicsEnvironment，你可以很容易地找出每个屏幕的边界和位置。之后，只需要处理帧的位置即可。

在此处查看小型演示示例代码：

```
import java.awt.Frame;
import java.awt.GraphicsDevice;
import java.awt.GraphicsEnvironment;
import java.awt.Point;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.SwingUtilities;

public class TestMultipleScreens {

    private int count = 1;

    protected void initUI() {
        Point p = null;
        for (GraphicsDevice gd : GraphicsEnvironment.getLocalGraphicsEnvironment().getScreenDevices()) {
            p = gd.getDefaultConfiguration().getBounds().getLocation();
            break;
        }
        createFrameAtLocation(p);
    }

    private void createFrameAtLocation(Point p) {
        final JFrame frame = new JFrame();
        frame.setTitle("Frame-" + count++);
        frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        final JButton button = new JButton("Click me to open new frame on another screen (if you have two screens!)");
        button.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                GraphicsDevice device = button.getGraphicsConfiguration().getDevice();
                Point p = null;
                for (GraphicsDevice gd : GraphicsEnvironment.getLocalGraphicsEnvironment().getScreenDevices()) {
                    if (!device.equals(gd)) {
                        p = gd.getDefaultConfiguration().getBounds().getLocation();
                        break;
                    }
                }
                createFrameAtLocation(p);
            }
        });
        frame.add(button);
        frame.setLocation(p);
        frame.pack(); // Sets the size of the unmaximized window
        frame.setExtendedState(Frame.MAXIMIZED_BOTH); // switch to maximized window
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new TestMultipleScreens().initUI();
            }
        });
    }

} 
```

然而，请考虑仔细阅读[多个 JFrame 的使用，好/坏做法？](https://stackoverflow.com/a/9554657/418556)因为它们带来了非常有趣的考虑。

# c# - CUDAfy.NET 给出 Win32Exception：系统找不到指定的文件

> ID：14338482
> 
> 赞同：8
> 
> 时间：2013-01-15T13:09:40.043
> 
> 标签：c#, .net, cudafy.net

我通过 NuGet添加了对[CUDAfy.NET库的引用。](http://cudafy.codeplex.com/)

```
<package id="CUDAfy.NET" version="1.12.4695.21111" targetFramework="net45" /> 
```

当我运行我的程序时，我点击了`Win32Exception`：

> 该系统找不到指定的文件

这发生在程序的第一行：

```
CudafyModule km = CudafyTranslator.Cudafy(); 
```

异常对象没有任何迹象表明他们正在尝试加载什么文件。

我怎样才能解决这个问题？

**编辑**

使用 .NET 4.0 在 VS2010 中运行 Codeplex 下载的捆绑示例时，我看到了相同的异常。

轨迹轨迹为：

```
at System.Diagnostics.Process.StartWithCreateProcess(ProcessStartInfo startInfo)
at Cudafy.CudafyModule.Compile(eGPUCompiler mode, Boolean deleteGeneratedCode)
at Cudafy.Translator.CudafyTranslator.Cudafy(ePlatform platform, eArchitecture arch, Version cudaVersion, Boolean compile, Type[] types)
at Cudafy.Translator.CudafyTranslator.Cudafy(ePlatform platform, eArchitecture arch, Type[] types)
at Cudafy.Translator.CudafyTranslator.Cudafy() 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T13:33:13.590

将 VS 设置为在抛出异常时中断`ProcessStartInfo`会在调试器的本地窗格中显示堆栈顶部的对象。

相关属性为：

```
FileName = nvcc
Arguments = -m64 -arch=sm_12 "c:\<path>\CUDAFYSOURCETEMP.cu" -o "c:\<path>\CUDAFYSOURCETEMP.ptx" --ptx 
```

[本文](http://www.codeproject.com/Articles/202792/Using-Cudafy-for-GPGPU-Programming-in-NET)中的一些信息说明必须安装*CUDA Toolkit 。*很公平。

> 确保 C++ 编译器 (cl.exe) 在搜索路径上。NVCC的这个设置其实是整个过程中最艰难的阶段，请大家坚持。仔细阅读您遇到的任何错误 - 很可能它们与找不到 cl.exe 或没有 32 位或 64 位 CUDA 工具包有关。

那篇文章讨论了工具包的第 4 版，但第 5 版现在可用，并且自 CUDAfy v1.1 起支持。

从[https://developer.nvidia.com/cuda-downloads下载](https://developer.nvidia.com/cuda-downloads)

请注意，CUDA Toolkit 5.0 的 64 位版本是 942 MB 下载。如果您安装所有内容，则需要额外的 2815 MB。仅该工具包就需要 928 MB。

**编辑**安装 CUDA Toolkit 5.0 后，程序`CudafyCompileException`在同一源代码行失败：

> 编译错误：nvcc：致命错误：在 PATH 中找不到编译器“cl.exe”

搜索我的系统驱动器：

```
C:\>dir /s cl.exe 
```

这显示了来自 VS 10.0 和 11.0 的许多不同版本的编译器/链接器。显然只`cl.exe`支持版本 9 和 10，所以我选择了 VS10.0 amd64 版本，我在我的`PATH`环境变量中包含以下内容：

> C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\bin\amd64

您的路径可能会有所不同，具体取决于您的 CPU。我建议运行搜索以查看您的选项。

请注意，`PATH`如果您已经打开了环境变量，则必须在更改环境变量后重新启动 VS。

采取这些步骤后，我的基本程序运行成功。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-19T02:04:00.477

如果您在某个时候安装了 CUDA Toolkit v7.5，但意识到最新版本的[CUDAfy](https://cudafy.codeplex.com/)支持 CUDA 7.0，也可能会发生这种情况。从控制面板卸载 CUDA 7.5 时，某些文件/文件夹可能仍然存在。您应该手动删除这些。您可以使用 CUDAfyViewer 查看正在访问的 CUDA Toolkit 版本。

# android - 绘制饼图的轮廓

> ID：14338485
> 
> 赞同：1
> 
> 时间：2013-01-15T13:09:46.580
> 
> 标签：android, graph, achartengine, pie-chart

我正在使用图表引擎绘制图形，它工作正常，但我需要在饼图中添加轮廓？怎么做

我已经检查过了

[关联](https://groups.google.com/forum/?fromgroups=#!topic/achartengine/iuJIUXxNsLY)

图表应该是这样的

[图形图像](http://imageshack.us/photo/my-images/713/techpiechart.gif/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:12:12.597

这还不支持。您可以在 AChartEngine 跟踪器中创建问题并要求实施。

# css - 从背景图像中删除指针事件

> ID：14338486
> 
> 赞同：-1
> 
> 时间：2013-01-15T13:09:47.957
> 
> 标签：css

考虑一个***半透明*** `background-image`的阻塞`pointer-events`它下面的 css 链接。我想让链接即使在这张图片下方也能正常工作。

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:16:04.797

如果一个元素与另一个元素重叠，您将无法单击它，很简单。

您可以将链接放在叠加层的顶部，但您将失去对这些链接的影响。这不是优雅的，但我想它会工作。

```
a {
    position: relative; /* set them relative, keeping their position */
    z-index: 1000;      /* set z-index to move it in front */
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:20:37.127

不要这么想！
通常，最古老的图像盗窃方法之一是将图像放在透明图像后面。
但如果它对您非常重要，您可以使用一些常用方法（例如 html 图像映射或使用某些 svg 功能）在该图像上制作热点。如果有阴影之类的效果或类似的效果，您可以使用 css3 用代码制作它们

# jquery - Fancybox 2.1.0 从图库中排除触发图像

> ID：14338490
> 
> 赞同：3
> 
> 时间：2013-01-15T13:09:59.370
> 
> 标签：jquery, fancybox, fancybox-2

> **可能重复：**
> [Fancybox 多个链接到同一个画廊，没有重复](https://stackoverflow.com/questions/13359115/fancybox-multiple-links-to-same-gallery-without-duplication)

我正在使用 fancybox 2.1.0 和 jQuery 1.8.3 来加载图片库，但它并没有按照我想要的方式工作。我有一个大的主图像，然后是一组画廊缩略图。单击主图像或缩略图打开fancybox 画廊。

问题是缩略图中还包含主图像，所以当画廊启动时，我得到第一张图像重复：1.jpg、1.jpg、2.jpg、3.jpg 等。

我希望主图像触发画廊灯箱，但不包含在其中，但我似乎无法正确处理。非常感谢任何建议！

我的标记：

```
<a class="product-image fancybox" data-fancybox-group="gallery" id="main-image" title="" href="1.jpg">
  <img id="image" src="1.jpg" height="320" width="320" alt="" title="" />
</a>

<ul>
  <li>
    <a class="fancybox" data-fancybox-group="gallery" href="1.jpg" title="Image 1">
      <img src="1.jpg" width="100" height="100" alt="" />
    </a>
  </li>
  <li>
    <a class="fancybox" data-fancybox-group="gallery" href="2.jpg" title="">
      <img src="2.jpg" width="100" height="100" alt="" />
    </a>
  </li>
  <li>
    <a class="fancybox" data-fancybox-group="gallery" href="3.jpg" title="">
      <img src="3.jpg" width="100" height="100" alt="" />
    </a>
  </li>

</ul> 
```

我的脚本：

```
var $j = jQuery.noConflict(); 
$j(document).ready(function() {
    $j('.fancybox').fancybox({
        nextEffect: 'fade',
        prevEffect: 'fade',
        helpers: {
            title : {
                type : 'float'

            }
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:21:51.327

试试这个：html（删除`fancybox`主img中的类）并附`rel`加到`data-fancybox-group`

```
 <a class="product-image" data-fancybox-group-rel="gallery" id="main-image" title="" href="1.jpg">
  <img id="image" src="1.jpg" height="320" width="320" alt="" title="" />
</a>

<ul>
  <li>
    <a class="fancybox" data-fancybox-group="gallery" href="1.jpg" title="Image 1">
      <img src="1.jpg" width="100" height="100" alt="" />
    </a>
  </li>
  <li>
    <a class="fancybox" data-fancybox-group="gallery" href="2.jpg" title="">
      <img src="2.jpg" width="100" height="100" alt="" />
    </a>
  </li>
  <li>
    <a class="fancybox" data-fancybox-group="gallery" href="3.jpg" title="">
      <img src="3.jpg" width="100" height="100" alt="" />
    </a>
  </li>
</ul> 
```

js

```
 $('a.product-image').click(openFancybox);

function openFancybox(){
 $.fancybox.open($(this).attr('data-fancybox-group-rel'));
} 
```

[请参阅此处的](http://fancyapps.com/fancybox/#docs)文档API 方法 [很酷，此代码未经测试] ;)] 祝你好运

# ios - 秒表和计时器

> ID：14338491
> 
> 赞同：0
> 
> 时间：2013-01-15T13:10:01.950
> 
> 标签：ios, xcode, nsdate, nstimer

我想使用 NSDate 和 NSTimer 来检索按下开始按钮和停止按钮之间经过的时间，并以秒为单位显示时间。然后我想用时间来计算。我知道如何获得时间，但它总是采用这样的格式 2013-01-15 14:01:55.369。如何从另一个中减去一个时间以获得秒数。我不确定如何使用 NDDate 和 NSTimer。这应该很容易，但我有点卡在这里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:13:19.710

```
//Make two properties `NSDate *startDate, *endDate`

//in the action method of start Button 
startDate=[NSDate date];

//in the action method of stop Button
stopDate=[NSDate date];
long elapsedSeconds=[stopDate timeIntervalSinceDate:startDate];
NSLog(@"Elaped seconds:%ld seconds",elapsedSeconds); 
```

请检查我的[项目](http://www.keepandshare.com/doc/5387039/timerstopwatch-3-zip-43k?da=y)是否有秒表之类的东西，这可能对你很方便

检查此代码，大部分需求都在这里解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:14:44.370

您可以使用

```
- (NSTimeInterval)timeIntervalSinceDate:(NSDate *)date 
```

以秒为单位获取接收器与给定日期之间的时间间隔。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:13:23.943

要从 NSData 获取当前时间，请使用：

```
[[NSData data] timeIntervalSince1970]; 
```

并从您的 NSTime 值中减去它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T13:13:55.197

`timeIntervalSinceDate`在开始日期和结束日期之间使用。

# hive - 将包含空格的数据导入 Hive

> ID：14338495
> 
> 赞同：2
> 
> 时间：2013-01-15T13:10:14.870
> 
> 标签：hive

我正在将 csv 文件中的数据导入 Hive。我的表包含字符串和整数。但是，在我的输入文件中，整数周围有空格，所以看起来像这样：

```
some string,     2    ,another string  ,    7    , yet another string 
```

不幸的是，我无法控制提供文件的程序的格式。

当我使用（例如）导入数据时：

```
CREATE TABLE MYTABLE(string1 STRING, alpha INT, string2 STRING, beta INT, string3 STRING) 
ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' 
```

然后我所有的整数都设置为 NULL。我假设这是因为额外的空格使解析失败。有没有解决的办法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T20:52:04.713

您可以执行多阶段导入。在第一阶段，将所有数据保存为`STRING`，在第二阶段使用`trim()`删除空格，然后将数据保存为`INT`. 您还可以考虑使用 Pig 从源文件中读取数据作为原始文本，然后使用正确的数据类型将其写入 Hive。

**编辑**

如果您可以将源文件作为外部表指向，您也可以一次性完成。

```
CREATE TABLE myTable(
    string1 STRING, alpha STRING, string2 STRING, beta STRING, string3 STRING
) ROW FORMAT DELIMITED FIELDS TERMINATED BY ',' LOCATION '\\server\path\file.csv'

INSERT INTO myOtherTable
SELECT string1,
       CAST(TRIM(alpha) AS INT),
       string2,
       CAST(TRIM(beta) AS INT),
       string3
FROM myTable; 
```

# javascript - Magento 响应 302 中的操作 ajax 调用（需要管理员登录）

> ID：14338496
> 
> 赞同：1
> 
> 时间：2013-01-15T13:10:16.670
> 
> 标签：javascript, ajax, magento, magento-1.4

我将在 Magento 块中发出一个 AJAX 请求，该请求在我自己的模块控制器中调用一个动作。但是这个请求的响应是302，如果我没有登录，会在管理员登录页面重定向。这个请求在前面，不需要管理员登录。

我的 JavaScript 代码：

```
var xmlhttp;
if(typeof XMLHttpRequest !== 'undefined') xmlhttp = new XMLHttpRequest();
xmlhttp.open("POST", "http://mac-4.local:8888/magento_sample_1.4.2/index.php/disponibilityshippingicon/disponibility/setcustomeraddressinsession/", true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send('city=' + jsonAddress['city'] + '&cp=' + jsonAddress['cp'] + '&country=' + jsonAddress['country']); 
```

我的控制器代码：

```
class ColisWeb_DisponibilityShippingIcon_DisponibilityController extends Mage_Adminhtml_Controller_Action
{

public function setcustomeraddressinsessionAction() {
    $params = $this->getRequest()->getParams();
    Mage::log("ColisWeb - Addresse du visiteur non poussé en session : " . $params['city'] . $params['cp'] . $params['country'], Zend_log::INFO);
    if (isset($params['city'], $params['cp'], $params['country'])) {

        //new Mage_Customer_Model_Address();
        $address =  Mage::getModel('customer/address');
        $address->setCity($params['city']);
        $address->setPostCode($params['cp']);

        $session = Mage::getSingleton('core/session');
        $session->setData('addressColisweb', $address);
        $session->setData('cityAddressColisweb', $params['city']);
        $session->setData('postCodeAddressColisweb', $params['cp']);
        $session->setData('contryAddressColisweb', $params['country']);

    }
    else {

    }

    $this->getResponse()->setHeader('Content-type', 'application/json', true) ;
    $result = array( 'status' => '200');
    $this->getResponse()->setBody(Mage::helper('core')->jsonEncode($result));   
}

}
?> 
```

我的 Magento 版本是 1.4.2

我希望有人能帮助我。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:27:44.790

Your controller extends `Mage_Adminhtml_Controller_Action` - it should be `Mage_Core_Controller_Front_Action` instead.

# unix - 如何编写脚本以不断重试 Yum 更新程序？

> ID：14338498
> 
> 赞同：0
> 
> 时间：2013-01-15T13:10:22.410
> 
> 标签：unix, yum

我的工作让我总是将新版本的程序发布到卫星服务器上，然后在运行的服务器上，我用它`yum update program`来更新程序。

但是，由于未知的原因，在大多数情况下，即使我将程序上传到卫星服务器，`yum update program`也无法很快得到更新。我总是必须等待，不断重试，等等。

所以任何人都可以告诉我如何编写脚本，所以

1.  `yum update program`如果没有可用的更新，它会继续重试
2.  如果更新可用，则强制在 yum 中更新
3.  成功更新后，脚本退出。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:25:07.600

有关 repo 中内容的数据被缓存。您应该`yum clean expire-cache`先运行，然后再运行`yum update`，以确保检测到更改。

# ios - 为什么我的 AmazonCredentials 对象无效？

> ID：14338501
> 
> 赞同：0
> 
> 时间：2013-01-15T13:10:29.860
> 
> 标签：ios, core-data, amazon-web-services

我正在测试将核心数据支持到 DynamoDB 上，并且我已经`AWSPersistenceDynamoDBIncrementalStoreDelegate`在我的应用程序委托上实现了，相关`credentials`方法是这样实现的：

```
- (AmazonCredentials *)credentials
{
    if(credentials==nil) {
        credentials = [[AmazonCredentials alloc] initWithAccessKey:@"ACCESS_KEY" withSecretKey:@"SECRET_KEY"];
    }
    return credentials;
} 
```

显然适当地替换了我的真实安全凭证（这不是在生产中实现它的方式，但我不想为我正在做的原型设置一个 TVM）。

但是，当我尝试这样创建时`Entity`：

```
Track *track = (Track*)[NSEntityDescription insertNewObjectForEntityForName:@"Track" inManagedObjectContext:appDelegate.managedObjectContext]; 
```

我收到以下错误：

```
error: Error Domain=com.amazonaws.coredata.AWSPersistenceDynamoDBClientErrorDomain Code=-1 "The operation couldn’t be completed. (com.amazonaws.coredata.AWSPersistenceDynamoDBClientErrorDomain error -1.)" UserInfo=0xa5363d0 {message=The protocol - (AmazonCredentials *)credentials didn't return a valid AmazonCredentials object.} 
```

我可以看到该`AmazonCredentials`对象已实例化并且具有正确的详细信息，并且我可以使用相同的凭据来建立`AmazonS3Client`会话并从存储桶下载文件，因此它们绝对有效。

有没有人看到这个/知道问题是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:14:25.050

好的，查看 Github 上的代码[https://github.com/aws/aws-sdk-ios/blob/master/src-persistence/AWSPersistenceDynamoDBIncrementalStore.m](https://github.com/aws/aws-sdk-ios/blob/master/src-persistence/AWSPersistenceDynamoDBIncrementalStore.m)它表明您必须使用三个 arg 构造函数，包括一个安全令牌使用 DynamoDB 来支持核心数据，如果在文档中提到这一点会很有用，但无论如何，总之你必须实现一个 TVM 才能做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T20:32:35.447

虽然当前 DynamoDB 客户端确实需要会话凭证，但这些凭证可以由安全令牌服务 (STS) 客户端提供，并且不需要实施 TVM。

[适用于 iOS 的 STS 客户端](http://docs.aws.amazon.com/AWSiOSSDK/latest/Classes/AmazonSecurityTokenServiceClient.html)

# c# - Winforms - 在另一个线程中调用方法

> ID：14338504
> 
> 赞同：2
> 
> 时间：2013-01-15T13:10:37.847
> 
> 标签：c#, winforms, c#-4.0

在与 winform 按钮不同的线程中调用方法以使 ui 不会冻结或产生延迟的最佳做法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T13:15:07.420

第一步从

*   [`BackgroundWorker`](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)

如果这不符合您的要求，或者您需要更高级的东西，您应该查看其中之一：

*   [`Task Parallel Library`](http://msdn.microsoft.com/en-us/library/dd460717.aspx)
*   [`ReactiveExtensions`](http://msdn.microsoft.com/en-us/data/gg577611.aspx)
*   [`async / await`](https://msdn.microsoft.com/en-us/library/mt674882.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T13:16:56.610

```
Invoke((MethodInvoker) delegate {
    DoSomething();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:18:56.193

您应该调用`Control.Invoke`or ，请参阅[此处](http://weblogs.asp.net/justin_rogers/pages/126345.aspx)`BeginInvoke`的深入参考。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-15T13:29:42.440

你可以这样做

```
 Dispatcher.BeginInvoke(DispatcherPriority.Background, new Action(() =>
 {         
      //DO SOMETHING         
 } 
```

# c# - 尝试将代码转换为存储逗号分隔的枚举字符串

> ID：14338505
> 
> 赞同：1
> 
> 时间：2013-01-15T13:10:44.957
> 
> 标签：c#, .net, enums

我正在尝试转换以下内容：

```
public IEnumerable<string> MyProperty
{
    get
    {
        if (String.IsNullOrWhiteSpace(Record.MyProperty)) return new string[] { };
        return Record
            .MyProperty
            .Split(new[] { '.' }, StringSplitOptions.RemoveEmptyEntries)
            .Select(r => r.Trim())
            .Where(r => !String.IsNullOrEmpty(r));
    }
    set { Record.MyProperty = value == null ? null : String.Join(",", value); }
} 
```

处理一个`enum`，但我失败了（这是一个词吗？）。

我正在尝试这样的事情：

```
string.Split(new[] ',', Record.MyProperty).Select
    (r => (MyEnum)Enum.Parse(typeof(MyEnum), r)); 
```

进行解析，但再次“失败”。

有什么指导吗？谢谢。

**更新：**

我正在尝试将此数据保存为`string`. 因此，如果用户选择四个中的三个`enums`，它将因此保存为字符串：“Choice1，Choice2，Choice3”。

上面的代码是一个代理`public string MyProperty { get; set; }`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T15:49:02.663

您应该在传递给的数组周围添加一些大括号`Split`，并将其作为实例方法调用，而不是静态方法。

```
Record.MyProperty.Split(',')
                 .Select(r => (MyEnum)Enum.Parse(typeof(MyEnum), r)); 
```

那对你有用吗？

# python - mod_python 没有名为 _apache 的模块

> ID：14338506
> 
> 赞同：2
> 
> 时间：2013-01-15T13:10:46.593
> 
> 标签：python, apache2, mod-python

我正在尝试运行我下载的 python 程序。它需要 mod_python 所以我从源代码安装了最新版本。

我还在 Ubuntu 12.04 上运行 Python 2.7。

当我运行 python 文件时，出现以下错误：

```
from mod_python import apache
  File "/usr/local/lib/python2.7/dist-packages/mod_python/apache.py", line 30, in <module>
    import _apache
ImportError: No module named _apache 
```

这个错误似乎在 mod_python 而不是我下载的程序中。

谁能帮我解决这个问题？我已经尝试安装不同版本的 mod_python，但仍然无法让它工作。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T13:39:40.433

_apache 在 Apache 启动时由 mod_python 模块安装。因此，只有在 mod_python 下执行的脚本才能真正导入它。

# java - 如何使用 rest-client API 将附件添加到现有的 JIRA 问题

> ID：14338507
> 
> 赞同：0
> 
> 时间：2013-01-15T13:10:47.033
> 
> 标签：java, attachment, jira-rest-java-api

我可以使用其余客户端 API 创建 jira 问题，但我无法将 screeshot/附件附加到现有`JIRA`问题。如果有人能提供一个非常感谢的解决方案，那将非常有帮助。

我刚刚编写了以下代码片段，用于将 jpeg 文件附加到现有的`JIRA Issue`. 但后来我遇到了“线程“主”中的异常`java.lang.NoClassDefFoundError: org/apache/commons/httpclient/HttpConnectionManager"`

代码片段：-

私有静态字符串 addAttachment（字符串附件文件路径）抛出 URISyntaxException，FileNotFoundException{

```
 final java.net.URI jiraServerUri = new java.net.URI("https://oliveits.atlassian.net");
    FileInputStream fileStreamPath = new FileInputStream(attachmentfilenamepath);
    JerseyJiraRestClientFactory factory = new JerseyJiraRestClientFactory();
    NullProgressMonitor pm = new NullProgressMonitor();
    System.out.println("Server Url  :"+jiraServerUri);
    JiraRestClient restClient = factory.createWithBasicHttpAuthentication(jiraServerUri,"mobileqa","MobileQA1234");
    Issue issue1 = restClient.getIssueClient().getIssue(newKey, pm);
    final java.net.URI AttachmentUri = new java.net.URI(jiraServerUri+"/rest/api/2/issue/"+newKey+"/attachments");
    System.out.println("URI    :"+issue1.getAttachmentsUri());
    //restClient.getIssueClient().addAttachment(pm,issue1.getAttachmentsUri(), fileStreamPath , imageName);
    restClient.getIssueClient().addAttachment(pm, AttachmentUri, fileStreamPath, imageName);
    return attachmentfilepath;
} 
```

例外：-

```
Exception in thread "main" java.lang.NoClassDefFoundError: org/apache/commons/httpclient/HttpConnectionManager
at com.atlassian.jira.rest.client.internal.jersey.JerseyJiraRestClientFactory.create(JerseyJiraRestClientFactory.java:34)
at com.atlassian.jira.rest.client.internal.jersey.JerseyJiraRestClientFactory.createWithBasicHttpAuthentication(JerseyJiraRestClientFactory.java:39)
at com.jtricks.JTricksRESTClient.addAttachment(JTricksRESTClient.java:157)
at com.jtricks.JTricksRESTClient.main(JTricksRESTClient.java:101)
Caused by: java.lang.ClassNotFoundException: org.apache.commons.httpclient.HttpConnectionManager
at java.net.URLClassLoader$1.run(Unknown Source)
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
... 4 more 
```

刚刚将丢失的 jar 文件添加到类路径中。但我得到了一个例外，如下所述。

异常 Msg-1：com.sun.jersey.api.client.ClientHandlerException：Java 类 com.sun.jersey.multipart.MultiPart 和 Java 类型类 com.sun.jersey.multipart.MultiPart 和 MIME 的消息体编写器媒体类型多部分/表单数据；边界=边界_1_18541827_1358346116249 未找到

异常消息 2：com.sun.jersey.api.client.ClientHandlerException：Java 类 com.sun.jersey.multipart.MultiPart 和 Java 类型类 com.sun.jersey.multipart.MultiPart 和 MIME 的消息体编写器媒体类型多部分/表单数据；边界=边界_1_18541827_1358346116249 未找到

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:15:37.807

您的问题来自无法找到`org.apache.commons.httpclient.HttpConnectionManager`课程。在您的类路径中查找`commons-httpclient`JAR。

# c++ - 获取应用程序目录中的文件列表

> ID：14338514
> 
> 赞同：1
> 
> 时间：2013-01-15T13:11:08.777
> 
> 标签：c++, windows, winapi, visual-c++

我正在为 win32 控制台开发 C++ 应用程序

我需要在我的应用程序目录中获取文件列表

（例如，如果我的应用程序已启动，`C:\arash\app\`我需要此文件夹中的文件列表）

我在header中搜索并找到`FindFirstFile`了函数，但是这个函数需要一个目录路径。`windows.h`

我可以使用此功能获取应用程序运行目录中的文件列表吗？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T16:41:34.857

使用`GetModuleFileName()`NULL 模块句柄来获取 .exe 文件的路径和文件名。然后，您可以剥离文件名部分，并根据需要使用剩余的路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:16:50.613

当前工作目录是“ `.`”。

如评论中所述，这不一定是您想要的目录。

# php - 如何获取特定用户的 Facebook 活动提要

> ID：14338516
> 
> 赞同：0
> 
> 时间：2013-01-15T13:11:22.520
> 
> 标签：php, facebook-graph-api, facebook-php-sdk

有谁知道如何获取与应用 id 关联的用户的活动提要？

我可以使用此代码获取与应用 ID 关联的用户列表

```
<?php 
    require "facebook.php";
    $facebook = new Facebook(array(
        'appId'  => '',
        'secret' => '',
    )); 
    $user = $facebook->getUser();
    if ($user) {
      try {
            $result = $facebook->api(array(
            "method"    => "fql.query",
            "query"     => "SELECT uid, name, pic_square, activities FROM user
            WHERE uid IN (SELECT uid1 FROM friend WHERE uid2 = me()) and  is_app_user"
        ));
    echo "<pre>"; 
    print_r($result);
?> 
```

**输出**

```
Array
(
    [0] => Array
        (
            [uid] => 14529121124
            [name] => Saurabh
            [pic_square] => http://profile.ak.fbcdn.net/hprofile-ak-ash4/187195_1452918224_6692287_q.jpg
            [activities] => 
        )

    [1] => Array
        (
            [uid] => 100000565666371
            [name] => Abhijeet
            [pic_square] => http://profile.ak.fbcdn.net/hprofile-ak-prn1/157718_100000289210371_1409561577_q.jpg
            [activities] => 
        )

) 
```

现在我只想获取与此**（54975723243503）app_id**关联的这两个用户**（用户 ID：14529121124、100000565666371 ）的活动提要。**

 *** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:17:32.890

使用图形 API：[https ://developers.facebook.com/docs/reference/api/user/](https://developers.facebook.com/docs/reference/api/user/)

在该页面中搜索“提要”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T14:23:25.633

您需要查询 FQL[流](https://developers.facebook.com/docs/reference/fql/stream)表或 Graph API feed 对象：

由于您使用的是 FQL，我将举一个使用 FQL 的示例。我做了一些快速测试，该`stream`表不允许您使用`IN`关键字从多个源中选择流，因此您需要进行两次单独的调用，第一次获取`user_id`s，第二次获取流。

尝试这个：

```
$queries = array();
$i = 0;
foreach ($result as $item) {
   $queries['user_stream'.$i] =>
     "SELECT source_id, created_time, message, attachment FROM stream 
        WHERE source_id = " . $item['uid'];
   $i++;
}

$result2 = $facebook->api(array(
        "method"    => "fql.multiquery",
        "queries"     => json_encode($queries)
         )); 
```**

# java - java远程调试Tomcat app：JVM为什么不监听？

> ID：14338520
> 
> 赞同：12
> 
> 时间：2013-01-15T13:11:39.773
> 
> 标签：java, tomcat7, remote-debugging

我想远程调试在 Tomcat 7 中运行的应用程序。Tomcat 在 Win2008 服务器上作为服务运行。我在 Tomcat 的 Java 配置面板中的 Java 选项中添加了以下内容： `-Xdebug -Xrunjdwp:transport=dt_socket,address=4711,server=y,suspend=n`并打开了我的工作站上的防火墙和该端口的服务器。但是当我尝试在我的工作站上从 IntelliJ 9 进行调试时，我收到一条错误消息`Unable to open debugger port : java.net.ConnectException "Connection timed out: connect"`。jvm 是标准的 Sun/Oracle 64 位 JVM 版本 1.6.0_27。

`ManagementFactory.getRuntimeMXBean().getInputArguments()`我通过访问部署到 Tomcat 的应用程序并将结果记录到日志文件来验证命令行参数是否正在使用中。我在我的工作站和服务器上通过 Wireshark 验证了端口 4711 上的 TCP 请求是从我的电脑发送并到达服务器的，但没有答案。在服务器上运行`netstat -a`不会显示在此端口上侦听的进程。所以我假设 Tomcat/JVM 不会启动远程调试。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-15T13:28:20.887

You need to put -Xdebug and -Xrunjdwp... on *separate lines* in the Java panel of the Tomcat Service Configuration Panel.

So having:

```
-Xdebug -Xrunjdwp:transport=dt_socket,address=4711,server=y,suspend=n 
```

will not work, but:

```
-Xdebug
-Xrunjdwp:transport=dt_socket,address=4711,server=y,suspend=n 
```

will.

# java - 如何使用 JAXB 编写深度 XML 文档？

> ID：14338525
> 
> 赞同：1
> 
> 时间：2013-01-15T13:11:54.037
> 
> 标签：java, xml, jaxb, marshalling

我正在尝试创建一个结构比我见过的其他示例更复杂的 XML 文档。这是我的尝试，使用三个类：

*   带类，标识图像上的垂直颜色带。目前，它只有一个 X 值，它在图像上的位置。
*   程序类，“程序”表示某种图像的模板。它包含图像上的波段数、程序名称和波段对象列表。
*   一个 ProgramList 类，包含一个程序列表。

## 乐队类代码：

```
@XmlRootElement(name = "Band")
@XmlType(propOrder = { "x" })
public class Band {
    private int x;

    public Band() {
        x = 0;
    }

    public int getX() {
       return x;
    }

    public void setX(int x) {
        this.x = x;
    }
} 
```

## 程序类代码：

```
@XmlRootElement(name = "Program")
@XmlType(propOrder = { "numBands" , "programName", "bandList"})
public class Program {

   private int numBands;
   private String programName;
   private ArrayList<Band> bandlist;

   public void Program() {
      Band band1 = new Band();
      band1.setX(14);
      bandlist.add(band1);

      Band band2 = new Band();
      band2.setX(24);
       bandlist.add(band2);
   }

   public void setNumBands(int nb) {
       numBands = nb;
   }

   @XmlElement(name = "numBands")
   public int getNumBands() {
       return numBands;
   }

   public void setProgramName(String pn) {
       programName = pn;
   }

   @XmlElement(name = "programName")
   public String getProgramName() {
        return programName;
   }

   public void setBandList(ArrayList<Band> bl) {
       bandlist = bl;
   }

   @XmlElementWrapper(name = "bandlist")
   public ArrayList<Band> getBandList() {
       return bandlist;
   }
} 
```

## ProgramList 类代码：

```
@XmlRootElement()
@XmlType(propOrder = {"programList"})
public class ProgramList {

  private ArrayList<Program> programlist;
  public void ProgramList()   {
     Program program1 = new Program();
     program1.setNumBands(2);
     program1.setProgramName("Program 1");
     programlist.add(program1);

     Program program2 = new Program();
     program2.setNumBands(2);
     program2.setProgramName("Program 2");
     programlist.add(program2);        
  }

  public void setProgramList(ArrayList<Program> programlist) {
      this.programlist = programlist;
  }

  @XmlElementWrapper(name = "programlist")
  public ArrayList<Program> getProgramList() {
      return programlist;
  }
} 
```

## 编组代码：（尝试编写它的另一个类的一部分）

```
private void writeXML() throws JAXBException, IOException  {
    ProgramList pl = new ProgramList();

    JAXBContext context = JAXBContext.newInstance(ProgramList.class);
    Marshaller m = context.createMarshaller();
    m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, Boolean.TRUE);
    m.marshal(pl, new File("program.xml"));
} 
```

这一切都编译好，并且没有例外地运行。但是 XML 文档看起来像这样：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ProgramList/> 
```

不是我所期望的。我预计 ProgramList 对象的实例化会创建两个程序，每个程序都有两个波段，并且整个事情最终都在 XML 文件中。

我做这一切都错了吗？

我也试过这条线：

```
JAXBContext context = JAXBContext.newInstance(new Class[] {ProgramList.class, Program.class, Band.class}); 
```

结果相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:22:41.850

以下不是构造函数，因为它具有`void`返回类型。它只是一个与构造函数同名的方法。这意味着此逻辑未运行以填充您的对象模型。

```
public void ProgramList()   {
     Program program1 = new Program();
     program1.setNumBands(2);
     program1.setProgramName("Program 1");
     programlist.add(program1);

     Program program2 = new Program();
     program2.setNumBands(2);
     program2.setProgramName("Program 2");
     programlist.add(program2);        
  } 
```

它应该是：

```
public ProgramList()   {
     programlist = new ArrayList<Program>(2);

     Program program1 = new Program();
     program1.setNumBands(2);
     program1.setProgramName("Program 1");
     programlist.add(program1);

     Program program2 = new Program();
     program2.setNumBands(2);
     program2.setProgramName("Program 2");
     programlist.add(program2);        
} 
```

**注意：** 由于 JAXB 是按异常配置的，因此您添加了许多不必要的注释。以下内容应该有所帮助：

*   [http://blog.bdoughan.com/2012/07/jaxb-no-annotations-required.html](http://blog.bdoughan.com/2012/07/jaxb-no-annotations-required.html)

# android - 来电屏幕上的活动弹出窗口

> ID：14338526
> 
> 赞同：6
> 
> 时间：2013-01-15T13:11:54.973
> 
> 标签：android

我正在尝试覆盖来电屏幕 - 我知道我无法更改它，所以我试图在顶部弹出一个活动。

我的代码工作正常，除非手机空闲了几分钟。

我的代码：

**AndroidManifest.xml：**

```
<?xml version="1.0" encoding="utf-8" ?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="com.example.myfirstapp"
      android:versionCode="7"
      android:versionName="7">
    <uses-sdk android:minSdkVersion="7" android:targetSdkVersion="10"></uses-sdk>
    <uses-permission android:name="android.permission.READ_PHONE_STATE"/>
    <uses-permission android:name="android.permission.MODIFY_PHONE_STATE"/>
    <uses-permission android:name="android.permission.CALL_PHONE" />

    <application android:label="@string/app_name" android:icon="@drawable/ic_launcher">
        <receiver android:name=".MyPhoneBroadcastReceiver" android:enabled="true">
            <intent-filter android:priority="99999">
                <action android:name="android.intent.action.PHONE_STATE" />
            </intent-filter>
        </receiver>
        <activity
            android:name=".Call" >
        </activity>
    </application>
</manifest> 
```

**MyPhoneBroadcastReceiver.java：**

```
public class MyPhoneBroadcastReceiver extends BroadcastReceiver{

    public void onReceive(final Context context, Intent intent) {

        Thread pageTimer = new Thread(){
            public void run(){
                try{
                    sleep(700);
                } catch (InterruptedException e){
                    e.printStackTrace();
                } finally {
                    Intent i = new Intent();
                    i.setClass(context, Call.class);
                    i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                    i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                    i.addFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);  
                    i.addFlags(WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED);
                    i.putExtra("INCOMING_NUMBER", incomingNumber);
                    i.setAction(Intent.ACTION_MAIN);
                    i.addCategory(Intent.CATEGORY_LAUNCHER);
                    context.startActivity(i);
                }
            }
        };
        pageTimer.start();
    }
} 
```

**调用.java：**

```
package com.example.myfirstapp;

import android.app.Activity;
import android.os.Bundle;

public class Call extends Activity{
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        getWindow(). addFlags(WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED);
        getWindow().addFlags(Intent.FLAG_ACTIVITY_REORDER_TO_FRONT);
        getWindow().addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        setContentView(R.layout.main);
    }
} 
```

顺便说一句-我尝试在睡眠（700）之前等待屏幕唤醒，但没有帮助（在 MyPhoneBroadcastReceiver.java 中）

```
...
try {      
    if (pm.isScreenOn()) {
        sleep(700);
    } else {
        while (!pm.isScreenOn()) {
            // Do nothing...
        }
        sleep(700);
    }
}
... 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-22T11:45:06.567

当电话屏幕关闭并且有来电时，还有更多工作要做（醒来，处理键盘保护视图......）因此通话中的活动需要更长的时间才能显示出来，这会导致您的情况通话活动开始于通话活动开始之前->通话活动在顶部
没有通话活动需要显示的确切时间（您已经尝试过，发现700毫秒是不够的）

我的解决方案：不断跟踪呼叫活动的状态：

*   如果它仍然在顶部并且用户没有关闭它（或任何要关闭的条件），只需使用处理程序继续跟踪
*   如果有任何其他活动转到前台，则呼叫活动尝试回到顶部

我的示例活动：

```
public class MainActivity extends Activity {
    private ActivityManager mActivityManager;
    private boolean mDismissed = false;

    private static final int MSG_ID_CHECK_TOP_ACTIVITY = 1;
    private static final long DELAY_INTERVAL = 100;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        Window window = getWindow();
        window.addFlags(WindowManager.LayoutParams.FLAG_DISMISS_KEYGUARD);

        mActivityManager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
        mHandler.sendEmptyMessageDelayed(MSG_ID_CHECK_TOP_ACTIVITY,
                DELAY_INTERVAL);
    }

    private Handler mHandler = new Handler() {
        public void handleMessage(android.os.Message msg) {
            if (msg.what == MSG_ID_CHECK_TOP_ACTIVITY && !mDismissed) {
                List<RunningTaskInfo> tasks = mActivityManager
                        .getRunningTasks(1);
                String topActivityName = tasks.get(0).topActivity
                        .getClassName();
                if (!topActivityName.equals(MainActivity.this
                        .getComponentName().getClassName())) {
                    // Try to show on top until user dismiss this activity
                    Intent i = new Intent();
                    i.setClass(MainActivity.this, MainActivity.class);
                    i.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                    i.addFlags(WindowManager.LayoutParams.FLAG_SHOW_WHEN_LOCKED);
                    startActivity(i);
                }
                sendEmptyMessageDelayed(MSG_ID_CHECK_TOP_ACTIVITY,
                        DELAY_INTERVAL);
            }
        };
    };

} 
```

# grails - 从插件调用服务

> ID：14338528
> 
> 赞同：0
> 
> 时间：2013-01-15T13:11:59.883
> 
> 标签：grails, plugins, service, groovy

我们可以从插件调用服务吗？例如我有一个插件，它有自己的域，那么现在我们可以从这个域调用主应用程序的服务吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T13:38:13.300

您可以在 Bootstrap.groovy 中自己注入它，因为此时所有内容都已初始化。也许更好的方法是用类似的东西自动连接它：

```
def ctx = grailsApplication.mainContext
ctx.beanFactory.autowireBeanProperties(instance, AutowireCapableBeanFactory.AUTOWIRE_BY_NAME, false) 
```

其中 instance 是插件中的某个对象。

另一种方法是使用 Bean PostProcessors [http://www.intelligrape.com/blog/tag/bean-post-processing/](http://www.intelligrape.com/blog/tag/bean-post-processing/)

此外，我真的推荐“Programming Grails”一书，您可以在其中阅读有关此类问题以及如何解决它们的信息。

# ios - UITableViewCell - 如何获取指向重新排序控件的指针？

> ID：14338529
> 
> 赞同：0
> 
> 时间：2013-01-15T13:12:02.993
> 
> 标签：ios, objective-c

我可以很容易地获得对单元格的引用

```
cell = [self.tableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]]; 
```

但是在编辑/重新排序模式下，我需要参考单元格右侧的小句柄。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:30:08.643

您可以使用此代码找到它，但重新排序控制是 private-api

```
for (UIView *view in cell.subviews) {
    if ([NSStringFromClass([view class]) isEqualToString:@"UITableViewCellReorderControl"]) {
        // 'view' is the reorder control
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T14:37:36.347

您需要`editingAccessoryView`在您的单元格上使用该属性：

```
cell = [self.tableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]];
UIView *editingAccessory = cell.editingAccessoryView; 
```

# php - 使用php将sql postgres查询导出到excel

> ID：14338532
> 
> 赞同：2
> 
> 时间：2013-01-15T13:12:14.913
> 
> 标签：php, sql, postgresql

嘿伙计们，我有我正在开发的这个 php 应用程序，我希望它能够正确地将数据导出到 excel 文档中，以便每个列标题都与该列中的所有数据一起导出。这是我到目前为止所拥有的，但它无法正常工作，因为所有列都显示在一行中。我怎样才能实现我想要的？有人请帮助我。这是当前的实现：

```
<?php require_once('connections/pgconn.php');

function cleanData(&$str)
{
$str = preg_replace("/\t/", "\\t", $str);
$str = preg_replace("/\r?\n/", "\\n", $str);
if(strstr($str, '"')) $str = '"' . str_replace('"', '""', $str) . '"';
}

// filename for download
$filename = "website_data_" . date('Ymd') . ".xls";

header("Content-Disposition: attachment; filename=\"$filename\"");
header("Content-Type: application/vnd.ms-excel");

$flag = false;
$result = pg_query("SELECT to_char (a.CALLDATE,'yyyymm') as month,min(a.calldate) as      start_time,max(a.calldate) as end_time,
     ceil(SUM (a.CALLDURATION::integer) / 60) AS minutes,
     COUNT (DISTINCT a.IDENTIFIANT) AS distinct_callers,
a.zoneiddest as country_code,b.country
FROM cdr_data a,COUNTRY_CODES b
WHERE  a.CALLSUBCLASS = '002'
     AND  a.CALLCLASS = '008'
and a.zoneiddest::integer > 0
AND SUBSTR (a.CALLEDNUMBER, 1, 2) NOT IN
('77', '78', '75', '70', '71', '41', '31', '39', '76','79')

and not substr(a.zoneiddest , 1 ,3) in ('254','255','256','211','257','250','256')
and trim(a.zoneiddest)  = trim(b.country_code)
GROUP BY to_char (a.CALLDATE,'yyyymm') ,a.zoneiddest,b.country
ORDER BY 1") or die('Query failed!');

while(false !== ($row = pg_fetch_assoc($result))) {
if(!$flag) {
  // display field/column names as first row
  echo implode("\t", array_keys($row)) . "\r\n";
  $flag = true;
}
array_walk($row, 'cleanData');
echo implode("\t", array_values($row)) . "\r\n";
}
exit;
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T09:08:36.120

我建议将您的查询导出为 CSV，告诉 PHP 创建一个 HTTP 响应为“ **application/ms-excel** ”内容类型，以便 IE 将自动启动 Excel，该 Excel 将在具有列名的列中导入 CSV：

```
$query = "COPY (SELECT .... ) TO '/path/reachable/with/php/file.csv' CSV;" 
```

这样，您可以将 CSV 作为文件保存在服务器上，并在 PHP 中尽可能多地检索它。

```
$file = file_get_contents('/path/reachable/with/php/file.csv');
header('Content-Type: application/ms-excel');
echo $file; 
```

# java - AtomicInteger 和 volatile

> ID：14338533
> 
> 赞同：31
> 
> 时间：2013-01-15T13:12:21.230
> 
> 标签：java, multithreading, thread-safety, atomic, volatile

我知道`volatile`允许可见性，`AtomicInteger`允许原子性。因此，如果我使用 volatile `AtomicInteger`，是否意味着我不必再使用任何同步机制？

例如。

```
class A {

    private volatile AtomicInteger count;

    void someMethod(){
        // do something
        if(count.get() < 10) {
            count.incrementAndGet();
        }
} 
```

这是线程安全的吗？

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-01-15T13:19:07.693

我相信这`Atomic*`实际上给出*了*原子性和波动性。因此，当您致电 (say) 时`AtomicInteger.get()`，您一定会获得*最新*的价值。这记录在`java.util.concurrent.atomic` [包文档](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/package-summary.html)中：

> 原子访问和更新的记忆效应通常遵循 volatile 的规则，如 Java™ 语言规范第 17.4 节所述。
> 
> *   get 具有读取 volatile 变量的记忆效应。
> *   set 具有写入（分配）易失性变量的记忆效应。
> *   lazySet 具有写入（分配）易失性变量的记忆效应，除了它允许对后续（但不是先前）内存操作进行重新排序，这些操作本身不会对普通的非易失性写入施加重新排序约束。在其他使用上下文中，> -lazySet 可能在清空时应用，为了垃圾收集，一个永远不会再次访问的引用。
> *   weakCompareAndSet 以原子方式读取和有条件地写入变量，但不会创建任何发生前的顺序，因此对于除weakCompareAndSet 的目标之外的任何变量的先前或后续读取和写入不提供任何保证。
> *   compareAndSet 和所有其他读取和更新操作（例如 getAndIncrement）具有读取和写入 volatile 变量的记忆效应。

现在如果你有

```
volatile AtomicInteger count; 
```

该`volatile`部分意味着每个线程都将使用最新的`AtomicInteger`引用，并且它`AtomicInteger`意味着您*还将*看到该对象的最新值。

需要这个并不常见（IME） - 因为通常您不会重新分配`count`以引用不同的对象。相反，您将拥有：

```
private final AtomicInteger count = new AtomicInteger(); 
```

在这一点上，它是一个`final`变量的事实意味着所有线程都将处理同一个对象 - 而它是一个`Atomic*`对象的事实意味着它们将看到该对象中的最新值。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-08-30T06:45:17.230

我会说不，它不是线程安全的，如果您将线程安全定义为在单线程模式和多线程模式下具有相同的结果。在单线程模式下，计数永远不会超过 10，但在多线程模式下可以。

问题是`get`and`incrementAndGet`是原子的，但 an`if`不是。请记住，非原子操作可以随时暂停。例如：

1.  `count = 9`目前。
2.  线程 A 运行`if(count.get() <10)`并获取`true`并停在那里。
3.  线程 B 运行`if(count.get() <10)`并获得`true`，因此它运行`count.incrementAndGet()`并完成。现在`count = 10`。
4.  线程 A 恢复并运行`count.incrementAndGet()`，现在`count = 11`在单线程模式下永远不会发生。

如果你想让它线程安全而不使用`synchronized`哪个更慢，试试这个实现：

```
class A{

final AtomicInteger count;

void someMethod(){
// do something
  if(count.getAndIncrement() <10){
      // safe now
  } else count.getAndDecrement(); // rollback so this thread did nothing to count
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-02T13:03:35.460

要保持原始语义并支持多线程，您可以执行以下操作：

```
public class A {

    private AtomicInteger count = new AtomicInteger(0);

    public void someMethod() {

        int i = count.get();
        while (i < 10 && !count.compareAndSet(i, i + 1)) {
            i = count.get();
        }

    }

} 
```

这避免了任何线程看到计数达到 10。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-23T07:05:51.057

答案在这段代码中

[http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/concurrent/atomic/AtomicInteger.java](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/concurrent/atomic/AtomicInteger.java)

这是 AtomicInteger 的源代码。该值是易变的。所以，AtomicInteger 在里面使用了 Volatile。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-29T16:13:46.763

您的查询可以分两部分回答，因为您的查询中有 2 个问题：

1）参考Oracle的原子变量教程文档： [https ://docs.oracle.com/javase/tutorial/essential/concurrency/atomicvars.html](https://docs.oracle.com/javase/tutorial/essential/concurrency/atomicvars.html)

java.util.concurrent.atomic 包定义了支持对单个变量进行原子操作的类。所有类都有 get 和 set 方法，其工作方式类似于对 volatile 变量的读取和写入。也就是说，一个集合与同一变量上的任何后续获取具有发生前的关系。原子 compareAndSet 方法也具有这些内存一致性特性，适用于整数原子变量的简单原子算术方法也是如此。

所以原子整数确实在内部使用了 volatile ，正如这里的其他答案所提到的。因此，使您的原子整数易失是没有意义的。您需要同步您的方法。

您应该在 Udemy 上观看 John Purcell 的免费视频，其中显示了当多个线程尝试修改 volatile 关键字时失败。简单而美丽的例子。 [https://www.udemy.com/course/java-multithreading/learn/lecture/108950#overview](https://www.udemy.com/course/java-multithreading/learn/lecture/108950#overview)

如果您将 John 示例中的 volatile 计数器更改为原子变量，则可以保证他的代码不使用 sunchronized 关键字就可以成功，就像他在教程中所做的那样

2）来到你的代码：假设线程1开始行动，“someMethod”做一个get并检查大小。有可能在 getAndIncrement 执行之前（例如，由线程 1），另一个线程（例如线程 2）启动并将计数增加到 10，然后退出；之后，您的线程 1 将恢复并将计数增加到 11。这是错误输出。这是因为您的“someMethod”无论如何都不会受到同步问题的保护。我仍然建议您观看 john purcell 的视频，看看 volatile 失败的地方，以便您更好地理解关键字 volatile。在他的例子中用 atomicinteger 替换它，看看它的神奇之处。

# c++ - 将方法作为指向函数的指针传递

> ID：14338534
> 
> 赞同：2
> 
> 时间：2013-01-15T13:12:23.273
> 
> 标签：c++, multithreading, pointers, function-pointers

> **可能重复：**
> [成员函数的函数指针](https://stackoverflow.com/questions/12514447/function-pointer-for-a-member-function)

我有一个问题，在一个类中，我有这个方法：`virtual void start(void *(*ptr)(void*), void *);`
在另一个类中，我想用这个方法调用 start ：`void *Room::run(void *p)`。

所以我尝试这样做：`thread->start(&Room::run, 0);`但编译器不想要它，因为：`cannot convert parameter 1 from 'void *(__thiscall Room::* )(void *)' to 'void *(__cdecl *)(void *)'`

我该如何解决？模板？还是有更明显的解决方案？
谢谢 ！

PS：准确地说，我需要它来制作线程（[http://linux.die.net/man/3/pthread_create](http://linux.die.net/man/3/pthread_create)）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:21:25.430

在 C++ 中，指向（独立）函数的指针和指向方法的指针是完全不同的野兽，不能混为一谈。

如果您想将指向成员函数的指针传递给需要指向函数的 API，那么典型的解决方案是使用一个小的包装函数：

```
class Room {
public:
  void run();
  // other members omitted

  // wrapper function
  static void* run_wrapper(void* p)
  {
    static_cast<Room*>(p)->run();
    return NULL;
  }
}; 
```

你像这样使用它：

```
thread->start(Room::run_wrapper, myRoomPointer); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:43:35.067

我强烈建议不要将函数指针转换为`void *`指针，因为在 c++ 和可能的 c 中，大小可能不同。

总的来说，您的解决方案不是很 C++。诚然，使用 ac 库有点棘手。这是我在当前项目中使用的方法：-

```
class ThreadBase
{
public:
  ThreadBase ()
  {
  }

  virtual ~ThreadBase ()
  {
    // TODO - inform thread to stop, using a message or a signal or something
    // and then wait for the thread to terminate
    void
      *return_value = 0;

    pthread_join (m_thread_handle, &return_value);
  }

  void Run ()
  {
    if (pthread_create (&m_thread_handle, 0, ThreadFunction, this))
    {
      // error - throw an exception or something
    }
  }

private:
  static void *ThreadFunction (void *param)
  {
    ThreadBase
      *thread = static_cast <ThreadBase *> (param);

    thread->Main ();

    return 0;
  }

  virtual void Main () = 0;

private:
  pthread_t
    m_thread_handle;
}; 
```

然后从 ThreadBase 派生实现特定版本：

```
class SomeThread : public ThreadBase
{
private:
  void Main ()
  {
    // do something
  }
}; 
```

您可能想要更改`Main`以返回退出代码并将其从线程传回。`Main`如果它处于无限循环中（例如，如果它是一个正在消耗某种消息的侦听器），您需要一种方法来退出。

# c# - 计算字符串中笑脸的出现次数

> ID：14338536
> 
> 赞同：1
> 
> 时间：2013-01-15T13:12:29.733
> 
> 标签：c#, regex, string

我正在创建一个计算字符串中所有出现的**笑脸的方法。**（我已经创建了另一种查询数据库以获取笑脸字符串的方法。）

我希望这种方法能够检测到`:-):-)`两次事件。这是我尝试过的：

```
public static int Occurrences(string input)
{
    int count = 0;

    Smileys list = SmileyDAL.GetAll();

    foreach (var item in list)
    {
        count += new Regex(item.Key).Matches(input).Count;

    }

    return count;
} 
```

但是调用此方法时出现此错误：

> 解析“;-)”- ) 太多。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:15:01.800

您需要转义`)`字符，替换：

```
count += new Regex(item.Key).Matches(input).Count; 
```

和：

```
count += new Regex(Regex.Escape(item.Key)).Matches(input).Count; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T13:15:50.423

```
new Regex(Regex.Escape(item.Key)) 
```

您必须转义搜索字符串中的正则表达式字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:21:37.530

这是另一个不使用正则表达式的选项

```
public static int Occurences(string input)
{
    // Put all smileys into an array.
    var smileys = SmileyDAL.GetAll().Select(x => x.Key).ToArray();

    // Split the string on each smiley.
    var split = input.Split(smileys, StringSplitOptions.None);

    // The number of occurences equals the length less 1.
    return split.Length - 1;
} 
```

# php - 一次身份验证并在它之后使用数据库会话进行身份验证？

> ID：14338539
> 
> 赞同：0
> 
> 时间：2013-01-15T13:12:42.800
> 
> 标签：php, validation, session, authentication, login

目前我有代码，对用户进行身份验证并将身份验证用户名和密码保存在数据库会话中，每个请求都会得到验证。

我正在考虑更改验证方法以仅对用户进行一次身份验证并在数据库会话中保持成功身份验证，但如果他是会话用户并且已经验证，则不要再次验证用户。

这种新方法会更安全吗？还是我应该在每个请求上验证用户，即使它保存在会话中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:21:32.940

你应该做这个：

*   在数据库中保留用户名和**加密**密码表（加密 = 至少加盐和散列）
*   让您的用户向您发送用户名和密码，可能是经过哈希处理的客户端，然后再次检查哈希
*   检查凭据一次并在会话中设置一些内容，将用户标记为已通过身份验证

您永远不应该保留密码明文，并且您不应该在会话表中存储额外的身份验证数据。即使您在每次请求时检查它们，实际上您只是在检查您的远程用户（即他的 cookie）是否在您的会话中第一次提供了正确的用户名和密码......如果您刚刚设置，您可以获得相同的确切结果会话中的变量...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:25:31.123

与其将用户的身份验证状态存储在数据库中，不如使用 cookie。使用一个晦涩的变量名来存储加密的 unix 身份验证时间戳，以使观察者更难理解。这样做的好处是，如果您使用可逆密码，则需要进行简单的计算来检查会话是否到期。

这也消除了一大堆会导致速度变慢的数据库访问。

正如@Palantir 提到的，在数据​​库中以加密方式存储密码。当用户提供密码时，执行相同的加密并比较存储的版本

# r - plotrix 图形和 ggplot2 图形并排

> ID：14338541
> 
> 赞同：0
> 
> 时间：2013-01-15T13:12:43.597
> 
> 标签：r, ggplot2, plotrix

> **可能重复：**
> [在 R 图形窗口中组合基本图形和 ggplot 图形](https://stackoverflow.com/questions/14124373/combine-base-and-ggplot-graphics-in-r-figure-window)

我想并排绘制一个 plotrix 图形和一个 ggplot2 图形。我该怎么办？下面是一次不成功的尝试（`gg1`图中没有出现）。

```
library(ggplot2)
library(gridExtra)
library(plotrix)

Mvalues <- matrix(rpois(9,1), ncol=3)
Mcolors <- matrix(rpois(9,5), ncol=3)

g1 <- color2D.matplot(x=Mvalues, show.values=2, cellcolors=Mcolors, 
        xlab="x", ylab="y", axes=FALSE, vcex=0.4)
gg1 <- grob(g1) 
gg2 <- ggplot(diamonds, aes(clarity, fill=cut)) + geom_bar(position="dodge") 

grid.arrange(gg1,gg2,ncol=2) 
```

# php - 使用 jQuery $.post 将 XML 数据发送到服务器

> ID：14338543
> 
> 赞同：1
> 
> 时间：2013-01-15T13:12:56.533
> 
> 标签：php, javascript, jquery, xml

我正在浏览其他问题和帖子，但找不到答案。

我需要将数据发送到 PHP 文件，该文件将数据保存到服务器。一些数据只是字符串变量，其中一个变量是 XML 数据。我尝试使用以下代码来做到这一点：

```
$.post(
    "save.php",
    { 
        userId: _UserId, 
        pName: _pName, 
        pId: _pId, 
        xml: $(_xml).find("main").text()
    },
    function () { 
        console.log("Saved"); 
    }
); 
```

XML 文档也是如此`_xml`，我正在尝试将整个 XML 保存在服务器中。POST 有效，但问题是它只保存文本，没有`<>`括号。

如何正确地将 XML 数据发送到服务器？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:16:54.840

> POST 有效，但问题是它只保存文本，没有 <> 括号。

尝试`html()`改用。我知道在这种情况下名称可能不正确，但底层方法不会删除当前包含的元素。

```
xml: $(_xml).find("main").html() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:33:53.860

试试这个方法：

```
$.ajax({
type : "POST",
url : "Save.php",
data : {
    method : "Save",
    userId: _UserId, 
    pName: _pName, 
    pId: _pId, 
    xml: escape(xmlString)
},
dataType : "json",
cache : false,
success : function(data) {
// Process return status data here
}
}); 
```

注意：您需要在服务器端解码 xml 字符串。

# heroku - 我尝试过的每个端口上的 Heroku 上的 Socket.io 404es

> ID：14338545
> 
> 赞同：0
> 
> 时间：2013-01-15T13:13:07.937
> 
> 标签：heroku, socket.io

我正在运行该应用程序，但它没有找到 socket.io 并给了我 404。

这是客户：

```
<script src="http://game-test-1.herokuapp.com/socket.io/socket.io.js"></script>
<script>var socket = io.connect('http://game-test-1.herokuapp.com');</script> 
```

这是服务器：

```
 var express = require('express'),
    routes = require('./routes'),
    user = require('./routes/user'),
    http = require('http'),
    path = require('path'),
    express = require("express"),
    app = express(),
    server = http.createServer(app),
    io = require('socket.io').listen(server);

server.listen(80); 
```

我尝试更改端口并这样做`http://game-test-1.herokuapp.com:81/...`，但这给了我一个错误

如何正确链接 socket.io？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T15:50:08.327

Heroku 要求您的应用程序侦听 Heroku 选择的端口。Heroku 会在启动您的应用程序时通过`PORT`环境变量告诉您​​的应用程序这个端口。如果您在任何其他端口上侦听，Heroku 将忽略它并在 60 秒后终止您的应用程序。

您用户的浏览器仍将端口 80 用于 HTTP 流量，将 443 端口用于 HTTPS 流量。Heroku 的路由层位于用户浏览器和您的应用程序之间，它将通过 Heroku 为您的应用程序指定的端口将 HTTP 流量发送到您的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T15:19:00.747

Heroku 开发中心有[关于在 Heroku 上使用 socket.io 的指南](https://devcenter.heroku.com/articles/using-socket-io-with-node-js-on-heroku)。特别是，您需要以下配置：

```
// assuming io is the Socket.IO server object
io.configure(function () { 
  io.set("transports", ["xhr-polling"]); 
  io.set("polling duration", 10); 
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-16T21:08:22.747

这是因为 Heroku 目前不支持 Websockets（据我所知）为了使用 socket.io，您需要强制它回退到 xhr 长轮询方法。

# ruby - \ / 运算符在ruby正则表达式中如何工作？

> ID：14338546
> 
> 赞同：0
> 
> 时间：2013-01-15T13:13:19.543
> 
> 标签：ruby, ruby-1.9.3

我正在使用 Ruby 1.9.3。只是通过 Ruby 教程。现在我只是坚持一个正则表达式正在工作的声明，并且也给出了 put 。`\/`但与运营商逻辑混淆。

***正则表达式-1***

`Today's date is: 1/15/2013.`（细绳）

`(?<month>\d{1,2})\/(?<day>\d{1,2})\/(?<year>\d{4})`（表达）

***正则表达式-2***

`s = 'a' * 25 + 'd' 'a' * 4 + 'c'`（细绳）

`/(b|a+)*\/ =~ s #=>`（ 表达）

现在无法理解`\/`和`=~`运算符在 Ruby 中是如何工作的。

有人能帮我理解同样的吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:16:09.760

`\`用作转义字符。在这种情况下，它用于指示下一个字符是正常字符，不应提供某些特殊功能。通常`/`将结束正则表达式，因为正则表达式由`/`. 但在前面`/`加上一个`\`基本上说“我不是告诉你在我使用这个时结束正则表达式`/`，我希望它作为正则表达式的一部分。”

正如李指出的那样，您的第二个正则表达式无效，特别是因为您从未以正确的`/`. 您转义最后一个`/`，使其只是一个纯文本字符，因此正则表达式挂起。这就像在做`str = "hello`。

作为另一个例子，通常`^`在正则表达式中用于指示字符串的开头，但这样做`\^`意味着您只想使用`^`正则表达式中的字符。

`=~`说“正则表达式是否匹配字符串？” 如果有匹配，则返回匹配开始的索引，否则返回`nil`。有关详细信息，请参阅[此问题](https://stackoverflow.com/questions/5781362/ruby-operator)。

**编辑：**请注意，`?<month>`, `?<day>`,`?<year>`东西是分组的。似乎您可以对正则表达式进行一些更新，请查看[此附录](http://www.tutorialspoint.com/ruby/ruby_regular_expressions.htm)以了解所有不同的特殊字符的作用。

# mysql - 数据库设计，我的数据库合理吗？一个主键到多个外键？

> ID：14338552
> 
> 赞同：0
> 
> 时间：2013-01-15T13:13:34.503
> 
> 标签：mysql, database, one-to-many, rationale

我有一个想法，我想执行并且在涉及表之间的关系时对我的数据库设计非常生疏。我希望能够在 3 个`<input type="text">`字段中输入 3 种成分并搜索所有包含这些成分的食谱。

我有3张桌子...

*   配料
*   食谱
*   菜单

粗体的列是我的主键，我希望斜体的列是外键。

示例 - iName 是 iName1 iName2 和 iName3 的主键。

* * *

# 配料

**iName** - iType

# 食谱

**mName** - *iName1* - *iName2* - *iName3* - 方法

# 菜单

*mName* - mDiscription - 过敏

* * *

我的问题是......我的表之间的关系是否足够有效，可以满足我的需求？例如，如果我想加入查询会是什么

```
SELECT mName, mDiscripton, mAllergy
FROM menu
WHERE iName1 = input etc etc 
```

对这个主题的任何启示都会有很大的帮助，我已经有一个表版本的数据库并且我使用的查询工作正常，我只想重新设计我的数据库并修改我的查询以适应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:20:09.827

请不要使用 1..n 列来保存两个表之间的 n..m 连接。

由于您可以在不同的食谱中使用一种成分，因此您需要一个匹配的表格。这些通常称为table1_2_table2，或者在您的情况下称为recipe2ingredient。在那里你存储两个表的主键（在大多数情况下作为该表上的组合主键，因为它通常是有意义的）

菜单和食谱也应如此，因为您可能希望在多个菜单中使用一个食谱。

所以

```
Table 1 - Menu    (ID, Name, ... whatever columns you need on top of that)
Table 2 - Recipe (ID, Name, ...whatever columns you could desire)
Table 3 - Menu2Recipe( IdMenu, IdRecipe)
Table 4 - Ingredient (ID, Name, measurement unit)
Table 5 - Ingredient2Recipe( IdRecipe, IdIngredient, Amount ) 
```

我希望这对你来说有点清楚。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:21:58.917

您的设计缺少一张桌子以提高效率；从您的配方表中删除 iName1 到 iName3 并添加一个映射表“recipe_ingredients”，其中包含配方和一种成分的外键。然后，对于每个食谱，您将在该表中拥有一到多行（看我的示例）。但是：您可以轻松搜索使用某种成分的所有食谱。如有必要，您可以在一份食谱中使用 10000 种成分。

餐桌菜单与食谱有何关联？菜单是否总是包含一个食谱？否则，还要为该关系添加一个映射表。

```
SELECT mName, mDiscription, mAllergy 
    FROM menu
        JOIN recipe ON recipe.mName = menu.mName
        JOIN recipe_ingredients ON recipe_ingredients.mName = recipe.mName
    WHERE recipe_ingredients.iName = 'whatever' 
```

# javascript - YUI Compressor 使用 .net 端口抛出 javascript 错误

> ID：14338555
> 
> 赞同：0
> 
> 时间：2013-01-15T13:13:52.413
> 
> 标签：javascript, yui, yui-compressor

我有以下 javascript 块：

（它本质上是 jquery.caret 库）

```
(function($,len,createRange,duplicate){
    $.fn.caret=function(options,opt2){
        var start,end,t=this[0],browser=$.browser.msie;
        if(typeof options==="object" && typeof options.start==="number" && typeof options.end==="number") {
            start=options.start;
            end=options.end;
        } else if(typeof options==="number" && typeof opt2==="number"){
            start=options;
            end=opt2;
        } else if(typeof options==="string"){
            if((start=t.value.indexOf(options))>-1) end=start+options[len];
            else start=null;
        } else if(Object.prototype.toString.call(options)==="[object RegExp]"){
            var re=options.exec(t.value);
            if(re != null) {
                start=re.index;
                end=start+re[0][len];
            }
        }
        if(typeof start!="undefined"){
            if(browser){
                var selRange = this[0].createTextRange();
                selRange.collapse(true);
                selRange.moveStart('character', start);
                selRange.moveEnd('character', end-start);
                selRange.select();
            } else {
                this[0].selectionStart=start;
                this[0].selectionEnd=end;
            }
            this[0].focus();
            return this
        } else {
            // Modification as suggested by Андрей Юткин
           if(browser){
                var selection=document.selection;
                if (this[0].tagName.toLowerCase() != "textarea") {
                    var val = this.val(),
                    range = selection[createRange]()[duplicate]();
                    range.moveEnd("character", val[len]);
                    var s = (range.text == "" ? val[len]:val.lastIndexOf(range.text));
                    range = selection[createRange]()[duplicate]();
                    range.moveStart("character", -val[len]);
                    var e = range.text[len];
                } else {
                    var range = selection[createRange](),
                    stored_range = range[duplicate]();
                    stored_range.moveToElementText(this[0]);
                    stored_range.setEndPoint('EndToEnd', range);
                    var s = stored_range.text[len] - range.text[len],
                    e = s + range.text[len]
                }
            // End of Modification
            } else {
                var s=t.selectionStart,
                    e=t.selectionEnd;
            }
            var te=t.value.substring(s,e);
            return {start:s,end:e,text:te,replace:function(st){
                return t.value.substring(0,s)+st+t.value.substring(e,t.value[len])
            }}
        }
    }
}(jQuery,"length","createRange","duplicate"); 
```

但是，如果我通过 YUI 压缩器运行它，它就不起作用。它在第 1 行引发错误

我用[http://compressorrater.thruhere.net/](http://compressorrater.thruhere.net/)来测试这个....

使用 www.jslint.com 我可以看到它说有一个不安全的字符第 1 行，字符 0。

我不知道如何解决这个问题....理想情况下，我仍然想使用 YUI Compressor，因为它有一个很好的 .net 端口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:13:07.783

这是因为有问题的文件中有一个字符（jquery.caret）

我在这里写了一篇博客：

[http://www.alexjamesbrown.com/blog/development/syntax-error-using-yahoo-yui-compressor-net-port-works-using-java-version/](http://www.alexjamesbrown.com/blog/development/syntax-error-using-yahoo-yui-compressor-net-port-works-using-java-version/)

# wordpress - 无法在 iframe 中访问 WordPress 仪表板

> ID：14338559
> 
> 赞同：4
> 
> 时间：2013-01-15T13:13:56.367
> 
> 标签：wordpress, iframe, x-frame-options

我在[http://foo.example.com](http://foo.example.com)上有一个 iframe，它的目标是[http://bar.example.com](http://bar.example.com)。

在[http://bar.example.com](http://bar.example.com)上是 WordPress 安装。我可以查看该页面并单击所有页面并发布，但是当我尝试转到后端时，我得到了

```
Refused to display document because display forbidden by X-Frame-Options. 
```

并且请求被中止。

根据[这个问题](https://stackoverflow.com/questions/6666423/overcoming-display-forbidden-by-x-frame-options)，我添加了这个成功发送的标头：

```
header('X-Frame-Options: GOFORIT'); 
```

还有什么可以限制对仪表板（和登录屏幕）的访问？

我可以访问两个子域，也可以使用 htaccess

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-04-20T06:19:39.540

这是一个更好的解决方案，当您更新 Wordpress 时不会中断：

```
remove_action( 'login_init', 'send_frame_options_header' );
remove_action( 'admin_init', 'send_frame_options_header' ); 
```

如果您使用的是 Apache，这是另一种解决方案。把它扔到你的 .htaccess 中：

```
<IfModule mod_headers.c>
    Header unset X-Frame-Options
    Header always unset X-Frame-Options
</IfModule> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T20:51:09.237

据此，在 WordPress Answers 中，[在登录页面收到“此内容无法在框架中显示”错误时](https://wordpress.stackexchange.com/a/81611/12615)，WordPress 会发送一个特殊的标头

```
X-Frame-Options: SAMEORIGIN 
```

防止[点击劫持](http://en.wikipedia.org/wiki/Clickjacking#Server_and_client)。因此，将管理员嵌入为 iframe。

可以消除此标头，从 中删除几个操作`wp-includes/default-filters.php`，但风险自负。

> 有人可能会使用非常相似的名称注册一个域，将您的登录信息嵌入到后台 iframe 中，并在您尝试输入登录凭据时记录下来。

**请阅读 WPSE 的完整问答。**

# mysql - MYSQL：计算特定整数在列中出现的次数，然后计算其中有多少？

> ID：14338564
> 
> 赞同：3
> 
> 时间：2013-01-15T13:14:31.350
> 
> 标签：mysql, select, count, group-by

我有一张桌子，上面有这样的数字

```
Report used                  UserID

 1                             2

 1                             2

 1                             2

 2                             2 
```

在这种情况下，我希望计算“报告使用”列中的 1，这会给我值 3。我可能会在此列中为不同的用户找到其中的一些，所以我想计算有多少次我找到 3 个 1。

我试过使用 SELECT COUNT 来计算特定的数字，但如果你关注我，我不确定如何计算这个数字。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:22:13.860

尝试这个：

```
SELECT userid, COUNT(reportused) onescount 
FROM tablename 
WHERE reportused = 1
GROUP BY userid 
```

还要检查这个：

```
SELECT COUNT(userid) 
FROM (SELECT userid, COUNT(reportused) onescount 
      FROM tablename 
      WHERE reportused = 1
      GROUP BY userid) a 
WHERE onescount = 3 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:46:01.040

如果我做对了：

```
select Report_used,RU_count,count(*) 
from
(select Report_used, UserID, count(*) RU_Count 
    from t 
    group by Report_used, UserID) t1
group by Report_used,RU_count; 
```

# c++ - 用 auto 声明块

> ID：14338572
> 
> 赞同：2
> 
> 时间：2013-01-15T13:14:51.757
> 
> 标签：c++, objective-c, c++11, clang, objective-c-blocks

我可以用 auto 声明 ObjC 块吗？

```
auto fun = ^(int x) { NSLog(@"%d", x); }
fun(5); 
```

我无法为此制定出有效的语法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-10T03:20:48.020

您`;`在`fun`. 否则，你的语法是正确的，Clang 将在`-std=c++11 -fblocks`模式下接受它，用于 C++ 或 Objective-C++ 输入。（请注意，块实际上是一个正交扩展，它不是 Objective-C 的一部分。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T06:20:34.970

auto 关键字是 c++11 关键字。Objective-c 是 c 而不是 c++ 的超集，因此不包含 c++ 的属性，而是包含 c。至于objective-c++，我不认为clang 在所有新的c++11 特性上都是最新的，尤其是在构建objective-c++ 的编译器中。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:31:38.950

我不认为 C++/Objective-C++ 中的 auto 关键字在 Objective-C 中使用。

至于为您的示例声明块变量，以下将在 Objective-C 中工作

```
void(^fun)(int x) = ^(int x) {
NSLog(@"%d",x);
};

fun(5); 
```

有关块的更多声明选项，这里有一个很好的[答案](https://stackoverflow.com/questions/9201514/block-declaration-syntax-list)

# ipad - 仅在 iOS 6 上使用带有横向的 iPad 中的 UIImagePicker

> ID：14338573
> 
> 赞同：1
> 
> 时间：2013-01-15T13:14:58.873
> 
> 标签：ipad, ios6, orientation, uiimagepickercontroller, landscape

我正在制作一个仅支持横向的 iPad 应用程序，在该应用程序中我使用以下代码调用照片库

```
UIImagePickerController *imagePicker = [[UIImagePickerController alloc] init];
imagePicker.delegate = self;
imagePicker.sourceType =
UIImagePickerControllerSourceTypePhotoLibrary;
imagePicker.mediaTypes = [NSArray arrayWithObjects: (NSString *) kUTTypeImage, nil];

self.iPadPopoverController = [[UIPopoverController alloc] initWithContentViewController:imagePicker];
[self.iPadPopoverController setDelegate:self];
[self.iPadPopoverController presentPopoverFromRect:CGRectMake(490, 638, 44, 44) inView:self.view permittedArrowDirections:UIPopoverArrowDirectionDown animated:YES]; 
```

但是，这会导致崩溃，但有以下异常：

```
Uncaught exception: Supported orientations has no common orientation with the application, and shouldAutorotate is returning YES 
```

**崩溃的原因：**

经过研究，我发现崩溃是由于即使界面方向`UIImagePickerController`为.`Portrait``Landscape`

**我如何尝试解决它：**

在阅读了 [iOS6 发行说明](http://developer.apple.com/library/ios/#releasenotes/General/RN-iOSSDK-6_0/_index.html)和之前发布的几个问题之后；我发现导致崩溃的方法是在 Application Delegate 的

```
- (NSUInteger)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window 
```

显而易见的解决方案是让它返回`UIInterfaceOrientationMaskLandscape|UIInterfaceOrientationMaskPortrait`

但是，我希望我的应用程序`Landscape`只支持！`Boolean`所以我的第一个解决方案是在 App Delegate中添加一个标志并将其设置为`YES`在我调用它之前并在我关闭它之后`UIImagePickerController`设置回它。`NO`

它奏效了，但我对此并不满意，感觉就像一个混乱的解决方案。所以相反，我让方法检查它的调用者，如果它是初始化的函数，`UIImagePickerController`那么方法将返回`UIInterfaceOrientationMaskPortrait`。

```
-(BOOL) iPadPopoverCallerFoundInStackSymbols{
    NSArray *stackSymbols = [NSThread callStackSymbols];

    for (NSString *sourceString in stackSymbols) {
       if ([sourceString rangeOfString:@"[UIViewController(PhotoImport) importPhotoFromAlbum]"].location == NSNotFound) {
           continue;
       }else{
           return YES;
       }
   }
   return NO;
} 
```

该解决方案适用于模拟器和设备。

**这是奇怪的部分**

将我的应用程序提交到商店后，我的所有用户都报告说，只要他们访问照片库，应用程序就会崩溃。我查看了崩溃报告，发现由于上述异常而发生了崩溃。我不明白为什么会这样。

所以我就这个问题向苹果提交了一份 TSI（技术支持事件）。他们回答说，应用程序归档后堆栈符号不可读，这就是为什么我的检查总是失败的原因。

他们还建议通过首先将项目存档到`.ipa`文件中并通过 iTunes 安装来在设备上进行测试，以便将来检测到类似的问题。

**太好了，但我的问题仍然存在**

有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:50:57.487

1.  在 info.plist 中声明所有方向都支持。

2.  您不再需要 method `application:supportedInterfaceOrientationsForWindow:`，因此可以将其删除。

3.  子类根视图控制器

添加以下方法：

```
- (BOOL)shouldAutorotate {
    return YES;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return UIInterfaceOrientationIsLandscape(interfaceOrientation);
}

- (NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskLandscape;
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation {
    if (UIInterfaceOrientationIsLandscape(self.interfaceOrientation)) {
        return self.interfaceOrientation;
    } else {
        return UIInterfaceOrientationLandscapeRight;
    }
} 
```

如果您呈现模态视图控制器并且不希望它们被旋转，那么您也需要将此代码添加到它们的根控制器中。

# mysql - GraphDatabase (Neo4J) vs Relational database (MySql) - 查询特定表的特定列

> ID：14338575
> 
> 赞同：4
> 
> 时间：2013-01-15T13:15:00.420
> 
> 标签：mysql, neo4j, rdbms, graph-databases

当查询即将在特定表和特定列中搜索特定数据时，关系数据库（如 MySql）是否比 Neo4j 等图形数据库执行得更好。

例如，如果查询是：“**搜索在巴黎发生的所有事件**”。

为简单起见，我们假设 MySql 将有一个`Event`带有“City”索引的表来优化这种查询。

Neo4j 呢？有人可能认为图形数据库必须遍历所有图形才能检索相关事件……但是，可以使用 Neo4j 创建一些索引作为其文档精确度。

对于这种分析/统计请求，为什么 RDMBS 会比它更快？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T14:37:24.957

正如您已经提到的：您将为此目的创建索引。Neo4j 中的默认索引提供程序是[lucene](http://lucene.apache.org/)，它*非常*快并且允许细粒度的索引和查询可能性。

索引可用于节点或关系，并且（通常）跟踪已在节点或关系的某些属性上设置了哪些值。

您通常必须在应用程序代码中进行索引，除非您使用 neo4j 的[自动索引功能](http://docs.neo4j.org/chunked/stable/auto-indexing.html)，该功能会自动索引所有节点和/或与给定属性的关系。

因此，像“搜索在巴黎发生的所有事件”这样的查询绝对没有问题，并且在使用索引时非常高效。

# c# - 如何从 Google Geocoding API 填充 TextBox 返回

> ID：14338577
> 
> 赞同：2
> 
> 时间：2013-01-15T13:15:01.880
> 
> 标签：c#, asp.net, google-maps

我想`TextBox` 在用户输入一些地址的地方实现功能，并且从该用户的 Google API 返回地址将选择正确的地址。他会选择我的街道、邮编、国家、城市都会自动填写的地址。

我正在尝试但没有成功（我的 aspx 页面的一小部分）

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true&libraries=places"></script>

<script type="text/javascript">

   var placeSearch,autocomplete;
   var component_form = {
   'route': 'short_name',
    'route': 'long_name',
    'locality': 'long_name',
    'administrative_area_level_1': 'short_name',
    'country': 'long_name',
    'postal_code': 'postal_code'
  };

  function initialize() {
    autocomplete = new google.maps.places.Autocomplete(document.getElementById('autocomplete'), { types: [ 'geocode' ] });
    google.maps.event.addListener(autocomplete, 'place_changed', function() {
      fillInAddress();
    });
  }

  function fillInAddress() {
    var place = autocomplete.getPlace();

    for (var component in component_form) {
      document.getElementById(component).value = "";
      document.getElementById(component).disabled = false;
    }

    for (var j = 0; j < place.address_components.length; j++) {
      var att = place.address_components[j].types[0];
      if (component_form[att]) {
        var val = place.address_components[j][component_form[att]];
        document.getElementById(att).value = val;
      }
    }
  }

  function geolocate() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(function(position) {
        var geolocation = new google.maps.LatLng(position.coords.latitude,position.coords.longitude);
        autocomplete.setBounds(new google.maps.LatLngBounds(geolocation, geolocation));
      });
    }
  }
</script> 
```

我的 .aspx 页面是这样的

```
 <div onload="initialize();"> 
```

```
<asp:UpdatePanel ID="UpdatePanelTabContainer" runat="server">
      <ContentTemplate>
       <table width="100%">
         <tr>
           <td>
               street
           </td>
            <td>
              <asp:TextBox ID="txtPickupStreet" runat="server" MaxLength="100" Width="162px" placeholder="Enter your address" AutoPostBack="true"  onFocus="javascript:geolocate()"></asp:TextBox>
           </td>
      </tr>
        <tr>
            <td>
                Postal Code
            </td>
             <td>
                <asp:TextBox ID="txtPickupPC" runat="server" MaxLength="11" Width="90px" />
             </td>
        </tr>

            </table>
    </ContentTemplate>
            </asp:UpdatePanel> 
```

在这里，用户将输入 street`TextBox` 他将获得相关结果并选择之后将全部`TextBox` 填充。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T15:55:24.473

好的，您的代码存在一些问题。

我为你做了一个[工作演示](http://jsbin.com/avikox/2/edit)。

我确实使用 jQuery 进行添加，但如果您不使用 jQuery，我相信您可以替换它。

**`component_form`对象是错误的**
*，它应该看起来像这样*

```
var component_form = {
'txtPickupUnitNumber': 'subpremise',
'txtPickupStreetNumber': 'street_number',
'txtPickupStreetName': 'route',
'txtPickupSuburb': 'locality',
'txtPickupPC': 'postal_code',
'txtPickupState': 'administrative_area_level_1',
'txtPickupCountry': 'country' 
```

};

数组键是 的`id`，`textbox`值是 google places 结果`address_component`类型的名称。

**该`geolocate`功能没有做任何有用**
的事情 您正在将自动完成搜索范围设置为**一个**lat/lng 坐标。边界应该是纬度/经度的集合。如果您在与此表单相同的页面上显示地图，您可以执行以下操作。

```
function geolocate() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            // set the map to the user locations
            map.setCenter(new google.maps.LatLng(position.coords.latitude,position.coords.longitude));
            // use the viewport as the search bounds
            autocomplete.setBounds(map.getBounds()));
      });
    }
} 
```

`fillInAddress`需要更改该函数以处理新`component_form`数组。

```
function fillInAddress() {
    var place = autocomplete.getPlace();
    // if you use jQuery then you can delete this and just set the attr to true in the fillFormInput function
    for (var component in component_form) {
        document.getElementById(component).value = "";
        document.getElementById(component).disabled = false;
    }

    for (var j = 0; j < place.address_components.length; j++) {
        var att = place.address_components[j].types[0];
        fillFormInput(att, place.address_components[j].long_name);
    }
}

// This new function searchs for the textbox that corresponds to the address_component type name
function fillFormInput(att, val) {
    for (var c in component_form) {
        if (component_form[c] === att) {
            $('#'+c).val(val);
        }
    }
} 
```

# android - Intent.getExtras() 总是返回 null

> ID：14338579
> 
> 赞同：5
> 
> 时间：2013-01-15T13:15:03.100
> 
> 标签：android, android-intent

我正在尝试通过`onCreate`我想“重定向”的通知和事件来运行活动。为此添加对`Intent`课堂信息的思考。一个重要的特性是生成通知的类是通过服务执行的。`getApplicationContext`我从类提供的方法中检索上下文`android.app.Application`。每当我调用方法`getExtras()`时返回`null`。我究竟做错了什么？

```
public class OXAppUpdateHandler {

    private void addNotification(Context context, int iconID,
           CharSequence tickerText, CharSequence title, CharSequence content) {

        CharSequence notificationTicket = tickerText;
        CharSequence notificationTitle = title;
        CharSequence notificationContent = content;

        long when = System.currentTimeMillis();

        Intent intent = new Intent(context, MainActivity_.class);
        intent.setFlags(
            Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP);
        intent.putExtra(OPEN_UPDATE_ACTIVITY_KEY, 1);

        PendingIntent pendingIntent = 
            PendingIntent.getActivity(context, 0, intent, 0);

        NotificationManager notificationManager = 
            (NotificationManager) context.getSystemService(
                Context.NOTIFICATION_SERVICE);
        Notification notification = 
            new Notification(iconID, notificationTicket, when);
        notification.setLatestEventInfo(context, notificationTitle, 
                                        notificationContent, pendingIntent);
        notificationManager.notify(NOTIFICATION_ID, notification);
    }

    public static boolean isUpdateStart(Intent intent) {
        Bundle bundle = intent.getExtras();
        boolean result = bundle != null && 
                         bundle.containsKey(OPEN_UPDATE_ACTIVITY_KEY);
        if (result) {
            bundle.remove(OPEN_UPDATE_ACTIVITY_KEY);
        }
        return result;
        }
    }

    @EActivity(R.layout.activity_main)
    public class MainActivity extends Activity {
        @Override
        protected void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            if (OXAppUpdateHandler.isUpdateStart(getIntent())) {
                startActivity(new Intent(this, UpdateActivity_.class));
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-15T23:03:21.543

我要探出窗外，猜猜你的问题出在这里：

```
PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent, 0); 
```

您正在传递`intent`并`getActivity()`期望您将获得`PendingIntent`与您的匹配`Intent`并包括您的附加功能。不幸的是，如果`PendingIntent`系统中已经有一个与您匹配的浮动对象`Intent`（**不**考虑您的`Intent`额外内容）`getActivity()`，那么它将返回给您`PendingIntent`。

要查看这是否是问题所在，请尝试以下操作：

```
PendingIntent pendingIntent = PendingIntent.getActivity(context, 0, intent,
                    PendingIntent.FLAG_UPDATE_CURRENT); 
```

这表示如果系统中已经有一个`PendingIntent`与您的某个位置匹配的，它应该用您的参数`Intent`中的那些替换额外的。`intent`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-15T13:47:56.867

(1) 检查[此处](https://stackoverflow.com/questions/4114443/android-use-an-intent-to-send-data-to-my-activity)以确保您正确使用 put/get extras，因为我没有看到您在其中添加数据的代码。

(2) 看起来您没有调用 get intent 和 get extra，因此实际上没有从捆绑包中获取任何内容（假设存在信息）。如果您正在检查布尔值，您应该获取放置在包中的数据，如下所示：

```
Bundle bundle = getIntent().getExtras();

if (bundle.getBooleanExtra("WHATEVER"){
   //whatever you want to do in here
} 
```

# java - 排序集变换

> ID：14338580
> 
> 赞同：0
> 
> 时间：2013-01-15T13:15:04.320
> 
> 标签：java, guava, comparator, compareto, sortedset

我有以下情况：

```
SortedSet<MyClass> sortedSet = ...;
SortedSet<HeavyToCompare> newSet = ...;
for (MyClass m: sortedSet ){
newSet.add(m.getHeavyToCompare())    
} 
```

我想避免对 newSet 重新排序，因为 HeavyToCompare 比较起来非常昂贵。相反，我想保留插入顺序（与原始集相同）。我知道我可以创建一个始终返回 -1 的简单比较器，但这违反了 compareTo 的合同。这里的最佳做法是什么？我需要类似的东西

```
SortedSet<K> result = Sets.transformAndKeepOrder(SortedSet<T> from, Function<T, K> function) 
```

更新：我无法更改 SortedSet，这是一项要求

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:25:45.640

您可以使用 a [`LinkedHashSet`](http://docs.oracle.com/javase/6/docs/api/java/util/LinkedHashSet.html)，它是`Set`按插入顺序迭代的 a ：

```
Set<HeavyToCompare> newSet = new LinkedHashSet<HeavyToCompare>(); 
```

但是，它不是一个`SortedSet`，但希望这不是一个要求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:18:57.523

我会尝试记录`sortedSet`出现在对象中的位置。然后您可以在调用重比较之前比较位置。

您如何实现这一点将取决于您的更多代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T15:54:39.727

您可以使用 Guava 对比较顺序进行硬编码[`Ordering.explicit`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/collect/Ordering.html#explicit%28java.util.List%29)。但是，这会产生有限的`SortedSet`. 具体来说，它的比较方法（`headSet`等）只有在它们的参数是集合的成员时才有效。毕竟，`Ordering.explicit`只知道如何比较您提供的值。更具体地说：

```
// In the real code, this values list will be computed in your loop:
List<Integer> values = Arrays.asList(2, 4, 6, 8);

Comparator<Integer> comparator = Ordering.explicit(values);
SortedSet<Integer> set = Sets.newTreeSet(comparator);
set.addAll(values);
set.headSet(4); // OK: [2]
set.headSet(5); // exception: "Cannot compare value: 5" 
```

# c++ - 从指针调用重载运算符

> ID：14338582
> 
> 赞同：2
> 
> 时间：2013-01-15T13:15:05.157
> 
> 标签：c++, operator-overloading

我有一个简单的 C++ 测试类，它`char * operator()`运行良好。问题是，当我在堆上创建它时，我无法使用它。

```
test t;
printf(t); 
```

可以，但是

```
test *t=new test();
printf(t); 
```

不是。除了 printf(*t) 有什么办法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T13:18:47.663

隐式转换`char*`可能听起来是个好主意，但相信我，它不是。猜猜为什么`std::string`没有。只需编写一个`c_str`方法并调用`printf("%s", t->c_str())`. 或者更好的是，`operator<<`为你的班级超载。如果您向我们展示课程，我们可以为您提供帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:28:01.637

Given that you really need to convert *a pointer* (which has to be correctly initialized, by the way...) to a `char*`, this isn't possible.

You can only implement operators for *values* (or references) of your class within the class. Some operators can be defined outside of the class, but casting operators aren't (for example, `operator+` can be implemented outside, taking two parameters).

Given the fact that arithmetic operators can be implemented outside of classes (`operator<<` is an arithmetic operator), you can implement a stream operator for output to, for example, `std::cout`, **even with pointers**.

```
std::ostream & operator <<(std::ostream & o, const test & t) {
    return o << t.toString();  // use std::string here, not c-strings!
}
std::ostream & operator <<(std::ostream & o, const test * t) {
    return o << t->toString(); // use std::string here, not c-strings!
} 
```

**See live**: [http://ideone.com/BZfcji](http://ideone.com/BZfcji)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:17:07.803

您需要先*分配*内存`test *t`才能使用它，否则您的指针不会指向任何内存。

你这样做：

```
test * t= new test(); 
```

完成后，您还必须再次释放它：

```
delete t; 
```

另外`*t`你想用什么打印`printf`？它指向的地址，或者它的成员的一些内容？如果是后者，您应该重载适当的运算符来执行此操作。

另一件事，不要`printf`在 C++ 中使用。在你的课堂上使用`std::cout`和超载。`operator<<``test`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T13:22:54.053

您可以将堆对象存储为*引用*，而不是指针。

```
test *my_heap_object = new test();
test &t = *my_heap_object;
// now you can use 't', as if it was local,
// instead of dereferencing the pointer each time.
printf(t);
t.do_something();
t++; 
```

更多解释可以在[wikipedia](http://en.wikipedia.org/wiki/Reference_%28C++%29)上找到。

# ruby-on-rails-3 - 在 RestKit 使用的 API 中使用accepts_nested_attributes_for

> ID：14338583
> 
> 赞同：2
> 
> 时间：2013-01-15T13:15:06.420
> 
> 标签：ruby-on-rails-3, restkit, nested-attributes

我想公开一个 API 方法，该方法创建一个包含参与者数组的专辑。此方法将在带有 RestKit 的 iOS 设备上使用。

我应该如何构建 Rails API？我应该如何配置 Restkit？

```
class Album < ActiveRecord::Base
  has_many :participants
  has_many :users, :through => :participants
  accepts_nested_attributes_for :participants, :allow_destroy => true

AlbumsController
  def create
    @album = Album.new(params[:album])
    @album.save 
```

# mahout - 了解 mahout 分类输出

> ID：14338586
> 
> 赞同：2
> 
> 时间：2013-01-15T13:15:07.637
> 
> 标签：mahout

我已经使用 20newsGroupExample 为三个类别 Category_A、Category_B、Category_C 训练了 mahout 模型，现在我想使用这个模型对我的文档进行分类。有人可以帮我理解我从这个模型中得到的输出吗？

这是我的输出

{0:-2813549.8786637094,1:-2651723.736745838,2:-2710651.7525975127}

根据文档的输出类别为 1，但预期类别为 2。我是正确的还是我的代码中缺少某些东西？

```
public class NaiveBayesClassifierExample {

public static void loadClassifier(String strModelPath, Vector v)
        throws IOException {
    Configuration conf = new Configuration();

    NaiveBayesModel model = NaiveBayesModel.materialize(new Path(strModelPath), conf);
    AbstractNaiveBayesClassifier classifier = new StandardNaiveBayesClassifier(model);

    Vector st = classifier.classifyFull(v);
    System.out.println(st.asFormatString());
    System.out.println(st.maxValueIndex());
    st.asFormatString();
}

public static Vector createVect() throws IOException {
    FeatureVectorEncoder encoder = new StaticWordValueEncoder("text");
    Analyzer analyzer = new StandardAnalyzer(Version.LUCENE_36);

    String inputData=readData();

    StringReader in = new StringReader(inputData);

    TokenStream ts = analyzer.tokenStream("body", in);

    CharTermAttribute termAtt = ts.addAttribute(CharTermAttribute.class);
    Vector v1 = new RandomAccessSparseVector(100000);

    while (ts.incrementToken()) {
        char[] termBuffer = termAtt.buffer();
        int termLen = termAtt.length();
        String w = new String(termBuffer, 0, termLen);
        encoder.addToVector(w, 1.0, v1);
    }
    v1.normalize();
    return v1;
}

private static String readData() {
    // TODO Auto-generated method stub

    BufferedReader reader=null;
    String line, results = "";
    try{
    reader = new BufferedReader(new FileReader("c:\\inputFile.txt"));

    while( ( line = reader.readLine() ) != null)
    {
        results += line;
    }
    reader.close();

    }
    catch(Exception ex)
    {
        ex.printStackTrace();
    }
    return results;
}

public static void main(String[] args) throws IOException {
    Vector v = createVect();
    String mp = "E:\\Final_Model\\model";
    loadClassifier(mp, v);
} 
```

}

# php - 将多个通知合并为一个

> ID：14338588
> 
> 赞同：3
> 
> 时间：2013-01-15T13:15:18.190
> 
> 标签：php, mysql, select, group-by

我正在重新创建我的通知系统，使其能够将许多通知合并为一个。它可以显示“9 人已回答您的问题”，而不是显示“亚当已回答您的问题”的 9 行。

我当前的通知表如下所示：

```
notification_id (PK) | recipient_id | sender_id | type | foreign_id | date | viewed 
```

Recipient_id 是接收通知的人。Sender_id 是它的来源。类型是什么样的通知，所以我知道它应该说什么，“xx已回答”或“xx喜欢你的帖子”。Foreign_id 可以是问题的 ID。

哪个是创建这个“组合”系统的最佳方式？当有新答案时我应该更新通知并说另一个人也回答了，或者查询是否应该计算有多少相同的foreign_id。你怎么看？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:33:13.463

试试这个：

```
SELECT foreign_id, SUM(IF (TYPE= 'like', 1, 0)) likecnt, 
       SUM(IF(TYPE = 'answer', 1, 0)) anscnt 
FROM notification 
GROUP BY foreign_id 
```

**编辑：检查这个**

```
SELECT n.foreign_id, n.sender_id
FROM notifications n 
INNER JOIN (SELECT foreign_id, MAX(DATE) DATE 
            FROM notifications 
            GROUP BY foreign_id, user_id
           )  a ON n.foreign_id = a.foreign_id AND n.date = a.date 
```

# jquery - 滚动事件处理，如 Twitter 和 Facebook

> ID：14338590
> 
> 赞同：1
> 
> 时间：2013-01-15T13:15:21.473
> 
> 标签：jquery, html, css, scroll, jquery-events

我一直在尝试将**滚动**事件绑定到页面上的元素，并在滚动时加载更多内容，例如 Twitter 或 Facebook。

### HTML

```
<div id="main-content">
    <ul class="event-list big row" id="event-list">
    ...
    </ul>
</div> 
```

### CSS

```
#main-content {
    width: 984px;
    overflow: visible;
    margin: 0 auto;
    color: #101010;
    width: 974px;
    padding: 10px 0 7px 0;
}
#main-content .event-list.big {
   width: 1080px;
   padding: 0 0 20px 0;
} 
```

### JS代码

```
$('#event-list').scroll(function() {
    var curScroll = $(this)[0].scrollTop,
        maxScroll = $(this)[0].scrollHeight - $(this).height();

    console.log(curScroll, ' :: ', maxScroll);

    if ((curScroll >= maxScroll - 200) && !loading) {
        loading = true;

        $(this)[0].scrollTop = curScroll;

        $('.loading').fadeIn('fast');

        if (page <= $('.page').length) {
            loadMore();
        }
    }
}); 
```

`scroll`当我滚动它甚至不会打印出**curScroll**和**maxScroll**时，不会触发该事件。

什么可能导致问题，也许是 CSS 样式错误或我的**js**代码错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:21:47.403

见[http://api.jquery.com/scroll/](http://api.jquery.com/scroll/)

滚动事件仅在窗口、框架、iframe 等元素上触发，`overflow: (scroll|auto)`并且它们的内容必须大于可用的宽度/高度。所以我建议你添加

```
#event-list {
    overflow: auto;
} 
```

如果你想监听用户滚动到特定元素的时间，你应该监听 window 的滚动事件，然后检查滚动坐标。

```
$(window).scroll(function() { /** ... **/ }); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T13:48:53.667

这是一个我认为您想要触发滚动事件的工作示例。通过设置“溢出：滚动”将 div 用作可滚动区域。注意：只有在初始加载时列表足够长时，您才会收到滚动事件。（请参阅 main-content 上的 height 属性。我将把 ajax 的加载留给你。:)

CSS

```
 #main-content {
    width: 984px;
    overflow: scroll;
    margin: 0 auto;
    color: #101010;
    width: 974px;
    height: 100px;
    padding: 10px 0 7px 0;
}
#main-content .event-list.big {
   width: 1080px;
   padding: 0 0 20px 0;
} 
```

脚本

```
$(document).ready(function() {
            $('#main-content').scroll(function() {
              var curScroll = $(this)[0].scrollTop,
                  maxScroll = $(this)[0].scrollHeight - $(this).height();

              console.log(curScroll, ' :: ', maxScroll);

              if ((curScroll >= maxScroll - 200) && !loading) {
                  loading = true;

                  $(this)[0].scrollTop = curScroll;

                  $('.loading').fadeIn('fast');

                  if (page <= $('.page').length) {
                      loadMore();
                  }
              }
            });
        }); 
```

HTML

```
<div id="main-content">
    <ul class="eventlist big row" id="event-list">
      <li>1</li>
      <li>2</li>
      <li>3</li>
      <li>4</li>
      <li>5</li>
      <li>6</li>
      <li>7</li>
      <li>8</li>
      <li>9</li>
      <li>0</li>
      <li>1</li>
      <li>2</li>
      <li>3</li>
      <li>4</li>
      <li>5</li>
    </ul>
</div> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-11-27T10:50:51.967

当您设置身体的 css 属性时，例如

```
body {height: 100%;overflow: auto;} // or visible
Now, $(window).scroll();  will not work. 
```

它将导致 jquery 滚动事件不起作用，因为 dom 不可滚动。因此，您必须删除溢出属性或将其设置为滚动。

# c++ - 诺基亚N95可以编译运行C/C++程序吗？

> ID：14338593
> 
> 赞同：1
> 
> 时间：2013-01-15T13:15:31.263
> 
> 标签：c++, c, smartphone

我有一部诺基亚 N95。最近我为我的手机找到了一个 Python 解释器。所以我为我的手机搜索 C++ 编译器但徒劳无功。任何 C++ 编译器真的适用于我的手机吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:18:13.243

诺基亚 N95 运行 SymbianOS。[您可以在此处](http://www.developer.nokia.com/info/sw.nokia.com/id/ec866fab-4b76-49f6-b5a5-af0631419e9c/S60_All_in_One_SDKs.html)下载 S60 第三版 SDK 。它可以使用一[小部分编译器](http://www.developer.nokia.com/Community/Wiki/GCCE)来构建；最适合您的可能是 GCCE - 一种可以在 Windows 上使用的 ARM 交叉编译器。

构建过程很简单但不标准。 [此页面](http://www.developer.nokia.com/Community/Wiki/How_do_I_start_programming_for_Symbian_OS%3F)应该可以帮助您入门。

# java - 如何为以下代码在两个不同的线程中运行 ActionListenters

> ID：14338600
> 
> 赞同：-1
> 
> 时间：2013-01-15T13:15:56.387
> 
> 标签：java, swing, awt, scope, actionlistener

我制作了这个程序来在 java 中播放 mp3 文件。以下代码播放 mp3 文件，但在播放时无法停止...我在两个按钮上添加了两个单独的 ActionListener 但它不适用于停止按钮...

```
import java.io.*;    
import javax.swing.*;
import java.awt.event.*;
import javazoom.jl.player.Player;  
import java.io.FileInputStream;

    public class Play2 extends JFrame
    {  
    JButton b,b1;
    JTextField t;

    Play2()
    {
        JFrame j=new JFrame("MusicPlayer");
        j.setSize(300,300);
        j.setDefaultCloseOperation(EXIT_ON_CLOSE);
        b=new JButton("Play");
        b1=new JButton("Stop");
        JPanel p=new JPanel();
        t=new JTextField(20);
        p.add(t);
        p.add(b);
        p.add(b1);
        j.add(p);
        j.setVisible(true);

    }
    public void awt()
    {
    b.addActionListener(
            new ActionListener(){
                  public void actionPerformed(ActionEvent ae){
                try  
                    {  

            String fname=t.getText();
            File directory = new File(fname);

            boolean isDirectory = directory.isDirectory();

            if (isDirectory) 
             {
                    // It returns true if directory is a directory.
                System.out.println("the name you have entered is a directory  : "  +  directory);  
                    //It returns the absolutepath of a directory.
                    System.out.println("the path is "  +  directory.getAbsolutePath());
             }
            else
            {
                    // It returns false if directory is a file.
                System.out.println("the name you have entered is a file  : " + directory);
                    //It returns the absolute path of a file.
                    System.out.println("the path is "  + directory.getAbsolutePath());
            }
                String s=directory.getAbsolutePath();

                s=s.replace("\\","/") ;

                    FileInputStream fis=new FileInputStream(s);  
                    final Player playMp3=new Player(fis);  

                    playMp3.play(); 
        }
        catch(Exception e){
            System.out.println(e);}
        }//end actionPerformed
      }//end ActionListener
    );//end addActionListener()

    b1.addActionListener(
      new ActionListener(){
        public void actionPerformed(
                                  ActionEvent ae){
          //Terminate playback before EOF
                    try  
                    {  

            String fname=t.getText();
            File directory = new File(fname);

            boolean isDirectory = directory.isDirectory();

            if (isDirectory) 
             {
                    // It returns true if directory is a directory.
                System.out.println("the name you have entered is a directory  : "  +  directory);  
                    //It returns the absolutepath of a directory.
                    System.out.println("the path is "  +  directory.getAbsolutePath());
             }
            else
            {
                    // It returns false if directory is a file.
                System.out.println("the name you have entered is a file  : " + directory);
                    //It returns the absolute path of a file.
                    System.out.println("the path is "  + directory.getAbsolutePath());
            }
                String s=directory.getAbsolutePath();

                s=s.replace("\\","/") ;

                    FileInputStream fis=new FileInputStream(s);  
                    final Player playMp3=new Player(fis);  

                    playMp3.close(); 
        }
        catch(Exception e){
            System.out.println(e);}
        }//end actionPerformed
      }//end ActionListener
    );//end addActionListener()

    }

        public static void main(String[]args)  
        {  
        Play2 f=new Play2();
        f.awt();    
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:15:38.323

您在这里所做的是使用播放按钮侦听器占用 EDT（事件调度线程）。

当您单击播放按钮时，一个 ActionEvent 将被发布到事件队列。如果您随后按下停止按钮，则会将另一个 ActionEvent 发布到 EventQueue。

EDT 将开始处理事件队列中的第一个事件（播放事件）。在这种情况下，您调用EDT`play()`上 (mp3) 类的方法。`Player`该`play()`方法不断循环，直到播放完整个 mp3。在这整个时间内，另一个事件（停止事件）将在事件队列中等待轮到它执行。所以当最后轮到stop事件执行时，mp3已经播放到最后了，stop命令比较多余。

* * *

**主要问题：**您不应该在 EDT 上执行冗长的任务。

**解决办法：**确保 play 方法在非 EDT 线程上执行，使用[SwingWorker 类](http://docs.oracle.com/javase/6/docs/api/javax/swing/SwingWorker.html)调用该`Player.play()`方法。

**参考**：[Swing UI 的 Event-Dispatch Thread Rules（在线文章）](http://www.javaworld.com/community/node/7717)（您可能会感兴趣阅读此内容。尤其是“**从不延迟 EDT** ”部分中的信息，其中包含有关此特定问题的信息）

# java - Android 活动中的 ScheduledExecutorService

> ID：14338606
> 
> 赞同：0
> 
> 时间：2013-01-15T13:16:06.857
> 
> 标签：java, android, multithreading

```
private ScheduledFuture<?> future;
private ScheduledExecutorService scheduler = Executors.newScheduledThreadPool(1);

Runnable runnable = new Runnable() {
     @Override
     public void run() {
              //my code...

     }
};
future = scheduler.scheduleAtFixedRate(runnable, 0, 15,TimeUnit.SECONDS); 
```

我在 android 活动中有上述代码。所以，我按下一个按钮，然后进入下一个活动。如果我按下后退按钮或明确地（从按钮）再次转到上一个活动，是否有可能创建第二个计时器？

换句话说， Executors.newScheduledThreadPool(1) 是否验证我可运行对象将仅由一个线程执行并且我不会有例如两个不同的任务，它们都将每 15 秒运行一次？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-21T10:22:40.087

从文档[http://developer.android.com/reference/java/util/concurrent/ScheduledThreadPoolExecutor.html](http://developer.android.com/reference/java/util/concurrent/ScheduledThreadPoolExecutor.html)

```
 public ScheduledFuture<?> scheduleAtFixedRate (Runnable command, long initialDelay, long period, TimeUnit unit) 
```

在 API 级别 1 中添加 创建并执行一个周期性操作，该操作首先在给定的初始延迟后启用，随后在给定的周期内启用；也就是说，执行将在 initialDelay 之后开始，然后是 initialDelay+period，然后是 initialDelay + 2 * period，依此类推。如果任务的任何执行遇到异常，则后续执行将被抑制。否则，任务只会通过取消或终止执行者来终止。**如果此任务的任何执行时间超过其周期，则后续执行可能会延迟开始，但不会同时执行。**

因此，AFAIU 池 1 的大小和 scheduleAtFixedRate 确保只有一个线程在运行。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-15T13:27:14.227

我认为即使您切换活动，您的 Runnable 也会继续运行，因为活动上下文将由操作系统保存。

您应该在调用 Activity 的 onPause 或 onStop 时停止线程，方法是：

```
future.cancel(true); 
```

然后，如果您回到活动，您可以再次安排 Runnable。

# php - PHP中的LinkedIn自动登录脚本

> ID：14338611
> 
> 赞同：2
> 
> 时间：2013-01-15T13:16:31.460
> 
> 标签：php, api, linkedin

如何使用 PHP 创建 LinkedIn 自动登录脚本？我听说 LinkedIn API，这是一个简单的分步教程吗？

更新：我希望我的脚本是：一旦我打开我的页面，它将自动登录到 LinkedIn。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:20:08.483

使用 REST API 将您的消息发布到用户墙并获得令牌 [http://developer.linkedin.com/documents/exchange-jsapi-tokens-rest-api-oauth-tokens](http://developer.linkedin.com/documents/exchange-jsapi-tokens-rest-api-oauth-tokens)

希望这可能有效。

# python - Matplotlib：带有 imshow 的特定颜色

> ID：14338615
> 
> 赞同：0
> 
> 时间：2013-01-15T13:16:39.433
> 
> 标签：python, matplotlib

我有一些 3D 数据，例如Z`d=[x, y, z, f]` 中的一列数字在哪里`z`，用作颜色信息。

`f`是一个标志，它是

1.  0 如果`x`并且`y`有一些特定的值（丑^^）
2.  1 如果`x`并且`y`没问题

所以对于好的数据`d[ d[:,3] == 1 ]` 我想生成一个配置文件

```
plt.imshow(resampled.T, extent=extent, vmin=MIN, vmax=MAX, origin='lower') 
```

对于丑陋的数据`d[ d[:,3] == 0 ]`，我只想使用特定的颜色，例如**黑色**

有没有办法意识到这一点？

**编辑**：结合@eumiro 和@Rutger Kassies 的评论，我现在得到以下结果 ![在此处输入图像描述](../Images/86c42cf4767f8233c1a48a910268d6a4.png)

我认为这是令人满意的。为了完整起见（或者可能有一些我不知道的优化^^），这里是代码和[数据](https://dl.dropbox.com/u/8189209/data.txt)：

```
import numpy as np
from matplotlib.mlab import griddata
import matplotlib
import matplotlib.pyplot as plt

def plotprofile(x, y, z0, name='dummy', save=1):
    #plt.figure()
    N = 50j
    z = z0[:,0]
    extent = (min(x), max(x), min(y), max(y))
    xs,ys = np.mgrid[extent[0]:extent[1]:N, extent[2]:extent[3]:N]
    resampled = griddata(x, y, z, xs, ys)

    cmap = plt.get_cmap()
    cmap.set_bad(color = 'k', alpha = 1.)
    #plt.imshow(resampled.T, cmap='Greys', extent=extent, origin='lower', interpolation='spline36')
    plt.imshow(resampled.T,  cmap=cmap, extent=extent, origin='lower',  vmin=min(z),  vmax=-min(z),interpolation='spline36')

cbar=plt.colorbar()
s=20
plt.ylabel(r"$y$", size=s)
plt.xlabel(r"$x", size=s)
plt.xlim([x.min(),x.max()])
plt.ylim([y.min(),y.max()])

if save:
    for end in ["pdf", "png", "eps"]:
        print "save %s.%s"%(name,end)
        plt.savefig("%s.%s"%(name,end))
else:
    plt.show()
plt.clf()

if __name__ == '__main__':
    filename = 'data.txt'
    data = np.loadtxt(filename)
    x = data[:,0]
    y = data[:,1]
    z = data[:,3:]
    plotprofile(x, y, z,  'dummy', 0) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:21:39.770

你不能通过使用 f 来掩盖 z 来在 z 中创建一个正常的颜色图吗？

```
dd = d[:, :3]
dd[:,2] = dd[:,2] * d[:,3] 
```

然后转换成这样的图像：

```
M = dd.max(0)
m = dd.min(0)

x = np.arange(m[0], M[0] + 1)
y = np.arange(m[1], M[1] + 1)
[X, Y] = np.meshgrid(x, y)

Z = np.zeros_like(X)

for num in range(0,size(dd, 0)):
    Z[dd[num, 0], dd[num, 1]] = dd[num, 2] 
```

现在您应该能够`Z`像普通图像或表面一样绘制`[X, Y]`

# javascript - 如何在谷歌应用脚 本中使用 setValues 屏蔽值？

> ID：14338617
> 
> 赞同：5
> 
> 时间：2013-01-15T13:16:47.320
> 
> 标签：javascript, google-apps-script, google-spreadsheet-api

我正在使用谷歌应用程序脚本来构建自定义电子表格。为了提高脚本的渲染速度，我首先构建了一个输出值数组，然后用于`setValues()`一次构建电子表格。

当我尝试将公式添加到电子表格中时，`setFormulas()`它也会覆盖我的所有值。所以现在我遇到了一个`setValues()`覆盖我的公式并`setFormulas()`覆盖我的值的案例。

有没有办法可以为输出数组中的特定元素指定掩码值，以便这些元素不会覆盖电子表格中已有的数据？

理想情况下，我会将输出数组的每个元素初始化为此屏蔽值，然后只有非屏蔽元素会显示在电子表格中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-14T01:25:28.793

对于通过 Google 找到此内容的任何人，使用 setValues() 公式现在似乎可以在新工作表中使用。

更具体地说，我使用这样的代码在工作表上完成工作后将公式放回：

```
function setValuesAndFormulas() {
  var sheet = SpreadsheetApp.getActive().getActiveSheet();
  var range = sheet.getDataRange();
  var values = range.getValues();
  var formulas = range.getFormulas();

  for (var i = 0; i < values.length; i++) {
    for (var j = 0; j < values[i].length; j++) {
      if (formulas[i][j].charAt(0) == "=") {
        values[i][j] = formulas[i][j];
      }
    }
  }

  range.setValues(values);
} 
```

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T14:47:19.197

`setValues()`不幸的是， or`setFormulas()`方法都不支持屏蔽。如果为方法提供了公式，则`setValues()`它应该正确设置它，因此您可以在一次调用中同时设置值和公式`setValues()`。

```
range.setValues([['foo', '=LEN("bar")']]); 
```

# java - 无法使用java下载文件

> ID：14338622
> 
> 赞同：-3
> 
> 时间：2013-01-15T13:16:59.300
> 
> 标签：java, upload, download

我刚刚实现了一个 jsp 程序来将文件上传到我的 PC 文件夹中。此文件夹的路径是`E:\UploadedFile`. 我要下载的文件名是`assad.xml`（我刚刚上传的那个）。这就是我尝试下载它的方式。如果我错了，请检查我的代码并纠正我。

```
<%@page import="java.io.*,java.net.*"%>

 <%
  System.setProperty("http.proxyHost", "192.168.1.10");
    System.setProperty("http.proxyPort", "8080");
 try {
    /*
     * Get a connection to the URL and start up
     * a buffered reader.
     */
    long startTime = System.currentTimeMillis();  
    System.out.println("Connecting to URL...\n");  
    URL url = new URL("E://UploadedFiles/");
    url.openConnection();
    InputStream reader = url.openStream();  
    /*
     * Setup a buffered file writer to write
     * out what we read from the website.

     */
    FileOutputStream writer = new FileOutputStream("E:/assad.xml");
    byte[] buffer = new byte[153600]; // Buffer for 150K blocks at a time
    int totalBytesRead = 0;
    int bytesRead = 0;
    System.out.println("Reading ZIP file 150KB blocks at a time.\n");  

    while ((bytesRead = reader.read(buffer)) > 0){  
       writer.write(buffer, 0, bytesRead);
       buffer = new byte[153600];
       totalBytesRead += bytesRead;
    }  
    long endTime = System.currentTimeMillis();  

    System.out.println("Done. " + (new Integer(totalBytesRead).toString()) + " bytes
  read (" + 
           (new Long(endTime - startTime).toString())+ " millseconds).\n");
    writer.close();
    reader.close();
 }catch (MalformedURLException e){
    e.printStackTrace();
 }
 catch (IOException e){
    e.printStackTrace();
 }

 %> 
```

我刚刚上传文件的文件夹的名称是**UploadedFiles**，它位于**E: drive**中。我要下载的文件的名称是**assad.xml**。它在此文件夹中可用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:25:22.123

可能你倒置了文件名，就像 Renjith 说的那样。如需更一致的 API，请查看：[http ://hc.apache.org/httpcomponents-core-ga/index.html](http://hc.apache.org/httpcomponents-core-ga/index.html)

# haskell - 如何限制异构列表中的类型？

> ID：14338628
> 
> 赞同：0
> 
> 时间：2013-01-15T13:17:30.833
> 
> 标签：haskell, dsl, gadt

我目前正在尝试创建一个（某种）类型安全的 xml，例如嵌入到 Haskell 中的语法。最后，我希望实现这样的目标：

```
tree = group [arg1 "str", arg2 42] 
         [item [foo, bar] []
         ,item [foo, bar] []
         ] 
```

其中 group 和 item 是 kind `Node :: [Arg t] -> [Node c] -> Node t`。如果这没有任何意义，那很可能是因为我不知道自己在做什么:)

我现在的问题是如何使类型系统阻止我向`Node`. 例如`Node`s 类型`Group`only 可能有类型参数，`Arg1`但`Arg2`s`Item`可能有类型参数`Foo`和`Bar`。

我想底线问题是：*我如何限制异构列表中的类型？*

* * *

我试图实现的（用户）语法示例：

```
group .: arg1 "str" .: arg2 42
    item .: foo .: bar
    item .: foo .: bar 
```

其中 (.:) 是在节点中设置参数的函数。这将表示具有一些包含两个项目的参数的组。

此外，还会有一些（伪）定义，例如：

```
data Node = Node PossibleArguments PossibleChildNodes

type Group = Node [Arg1, Arg2] [Item]
type Item  = Node [Foo, Bar] [] 
```

我正在寻找一种通过类型检查器捕获使用错误的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:55:22.283

你所拥有的对我来说听起来不像你需要一个异构的列表。也许你正在寻找这样的东西？

```
data Foo = Foo Int

data Bar = Bar Int

data Arg = StringArg String | IntArg Int | DoubleArg Double

data Tree = Group Arg Arg [Item]

data Item = Item Foo Bar

example :: Tree
example = Group (StringArg "str") (IntArg 42)
            [Item (Foo 1) (Bar 2), Item (Foo 12) (Bar 36)] 
```

请注意，我们甚至可以创建一个`Arg`不同“子类型”的列表。例如，`[StringArg "hello", IntArg 3, DoubleArg 12.0]`。不过，它仍然是一个同类列表。

===== 编辑 =====

有几种方法可以处理“默认参数”的情况。假设`Bar`项目中的参数是可选的。我的第一个想法是，虽然用户指定它可能是可选的，但当我存储数据时，我想包含默认参数。这样，确定默认值与实际使用它的代码是分开的。因此，如果用户指定 a`Foo`为 3，但未提供 a `Bar`，并且默认值为`Bar 77`，那么我将我的项目创建为：

```
Item (Foo 3) (Bar 77) 
```

这样做的好处是对这个对象进行操作的函数不需要担心默认值；就它们而言，这两个参数将始终存在。

然而，如果你真的想在你的数据结构中省略默认参数，你可以这样做：

```
data Bar = Bar Int | DefaultBar

example = Group (StringArg "str") (IntArg 42)
            [Item (Foo 1) (Bar 2), Item (Foo 12) DefaultBar] 
```

甚至：

```
data Item = Item Foo Bar | ItemWithDefaultBar Foo 
```

===== 编辑#2 =====

所以也许你可以使用这样的东西：

```
data ComplicatedItem = ComplicatedItem 
    {
      location :: (Double, Double),
      size :: Int,
      rotation :: Double,
      . . . and so on . . .
    }

defaultComplicatedItem = ComplicatedItem { location = (0.0,0.0), size = 1, rotation = 0.0), ... } 
```

要创建`ComplicatedItem`，用户只需指定非默认参数：

```
myComplicatedItem = defaultComplicatedItem { size=3 } 
```

如果向`ComplicatedItem`类型添加新参数，则需要更新`defaultComplicatedItem`，但 for 的定义`myComplicatedItem`不会改变。

您还可以覆盖该`show`函数，以便在打印时省略默认参数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T13:04:15.003

根据随后的讨论，听起来您想要的是创建一种 DSL（域特定语言）来表示 XML。

一种选择是将你的 DSL*嵌入*到 Haskell 中，这样它就可以出现在 Haskell 源代码中。通常，您可以通过定义所需的类型并提供一组函数来处理这些类型来做到这一点。*听起来这就是你希望做的。*但是，作为*嵌入式*DSL，它会受到一些限制，这就是您遇到的问题。也许有一个聪明的技巧可以做你想做的事情，也许是涉及类型函数的事情，但我目前想不出任何东西。如果您想继续尝试，可以添加标签`dsl`并`gadt`在您的问题中，引起比我更了解这些东西的人的注意。或者，您可以使用类似 [Template Haskell](http://www.haskell.org/haskellwiki/Template_Haskell "模板 Haskell")或者[废弃你的样板文件](http://www.haskell.org/haskellwiki/Scrap_your_boilerplate "Scrap_your_boilerplate")，让你的用户省略一些信息，这些信息会在 Haskell “看到”它之前被“填充”。

另一种选择是拥有一个外部 DSL，您可以使用 Haskell 对其进行解析。您可以定义 DSL，但直接使用 XML 和合适的 DTD 可能会更容易。当然，有用于解析 XML 的 Haskell 库。

# jsf-2 - primefaces 自动完成并正确搜索。但它不能正常工作

> ID：14338629
> 
> 赞同：1
> 
> 时间：2013-01-15T13:17:32.100
> 
> 标签：jsf-2, primefaces

我使用 primefaces 自动完成并正确搜索。当我单击 Save 时，显示此错误消息。

```
/entryPages/usDistributorDetails/Create.xhtml @95,71 itemLabel="#{territory.territoryName}": Property 'territoryName' not found on type java.lang.String 
```

我的 xhtml 代码：

```
 <p:autoComplete id="territoryId11"
     value="#{usDistributorDetailsController.selected.territoryId}"
     completeMethod="#{usDistributorDetailsController.completeTerritory}"
     var="territory" itemLabel="#{territory.territoryName}"
     itemValue="#{territory.territoryId}"
     size="37"
     style="width: 264px" >

</p:autoComplete> 
```

我的 Java 代码：

```
public List<UsTerritory> completeTerritory(String query11) {

    List<UsTerritory> results = new ArrayList<UsTerritory>();
    List<UsTerritory> territoryListA = getJpaTerritoryController().findUsTerritoryEntities();

    for (UsTerritory abc : territoryListA) {

         if (abc.getTerritoryName().startsWith(query11)) {
            results.add(abc);
        }

    }

    return results;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:33:16.750

在使用 POJO 时，您可能必须使用转换器。看看：[Primfaces Autocomplete Pojo](http://www.primefaces.org/showcase/ui/autoCompletePojo.jsf)

# php - 如何通过 JAXL 发送 Facebook 聊天消息？

> ID：14338632
> 
> 赞同：2
> 
> 时间：2013-01-15T13:17:54.437
> 
> 标签：php, xmpp, facebook-chat

我正在尝试以用户的名义使用 JAXL 发送直接消息（使用 xmpp_login 进行身份验证的应用程序）。在[jaxl facebook 聊天示例](https://github.com/abhinavsingh/JAXL/blob/v3.x/examples/xfacebook_platform_client.php)中，存在一个消息回显结构，它仍然将收到的 XMPPStanza 重定向到发送者。但是尝试生成 XMPPStanza 发送并没有执行任何操作

```
$client->send($stanza); 
```

这是我的 XMPPStanza 初始化代码

```
$stanza = new XMPPMsg(null);
$stanza->from = $client->full_jid->to_string();
$stanza->to = 'example-facebook-id@chat.facebook.com';
$stanza->type = 'chat';
$stanza->body = 'test message';
$client->send($stanza); 
```

总结一下，如何通过 JAXL 以客户端的名义从服务器发送消息？

**编辑**

我忘了提到我正在使用 JAXL v3，并考虑附加完整的代码和系统配置会更有帮助。

```
<?php

define('FACEBOOKBOT_PHP', TRUE);

// Include XMPP Engine 'JAXL'
// Path might be alter in time.
// require_once ROOT_DIR.'/JAXL/jaxl.php';
require_once '/var/www/JAXL/jaxl.php';
require_once '/var/www/JAXL/xmpp/xmpp_msg.php';

function sendMessage($client)
{

    //  // $stanza = new XMPPMsg(null);
//  // $stanza->from    = $client->full_jid->to_string();
//  // $stanza->to      = $to;
//  // $stanza->type    = 'chat';
//  // $stanza->body    = 'test message 1';

//  // foreach ($stanza->childrens as $value)
//  // {
//  //  $value->ns = 'jabber:client';
//  // }

//  // $client->send($stanza);

    $msg = new XMPPMsg(array('to'=>'example-user-id-and-it-got-to-work-i-checked-on-below-echo-stanza@chat.facebook.com'), 'test message');
    $client->send($msg);

    _info("test messages sent");
}

$user = 'gokhanbarisaker'; // my user id (www.facebook.com/gokhanbarisaker)
// $user = $argv[1];    // User name or facebook id
$jidSuffix = '@chat.facebook.com';  // Facebook chat account suffix
$appKey = 'example-app-key';    // Taken from developer.facebook.com
// $appKey = $argv[2];  // Facebook app token
$accessToken = 'example-access-token';  // Facebook user token - tried both app token tool on developer.facebook.com and token provided after user login both posses xmpp-login permission
// $accessToken = $argv[3];

$client = new JAXL( array(  // (required) credentials
                            'jid' => $user.$jidSuffix,
                            'fb_app_key' => $appKey,
                            'fb_access_token' => $accessToken,

                            // force tls (facebook require this now)
                            'force_tls' => true,
                            // (required) force facebook oauth
                            'auth_type' => 'X-FACEBOOK-PLATFORM',

                            // (optional)
                            //'resource' => 'resource',

                            'log_level' => JAXL_INFO,
                            'priv_dir'  => '.'
                        ));

$client->add_cb('on_auth_success', function()
{
    global $client;
    _info("got on_auth_success cb, jid ".$client->full_jid->to_string());
    $client->set_status("available!", "dnd", 10);

    // Here is the part where i tried to send message. In addition, i tried to call this function wherever i can on the code.
    sendMessage($client);
});

$client->add_cb('on_auth_failure', function($reason)
{
    global $client;
    $client->send_end_stream();
    _info("got on_auth_failure cb with reason $reason");

});

$client->add_cb('on_chat_message', function($stanza)
{
    global $client;

    // echo back incoming message stanza
    $stanza->to = $stanza->from;
    $stanza->from = $client->full_jid->to_string();
    $client->send($stanza);

    _info("echo message sent");

    sendMessage($client);
});

$client->add_cb('on_disconnect', function()
{
    _info("got on_disconnect cb");
});

$client->start();

echo "done\n";

?> 
```

系统配置：

*   Ubuntu 12.04.01 LTS
*   阿帕奇 2.2.22
*   PHP 5.3.10

要执行的终端命令；

*   > php facebookbot.php

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T06:06:19.027

尝试：

```
$msg = new XMPPMsg(array('to'=>'example-facebook-id@chat.facebook.com'), 'test message');
$client->send($msg); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T15:27:18.570

您应该尝试一些事情，看看它们是否可以帮助您调试：

1.  设置`'log_level' => JAXL_DEBUG,`并检查日志以查看 Jaxl 向 facebook 发送的确切内容。如果可以的话，用传出的节更新问题，以便我们可以在这里验证什么是真正的错误。
2.  如果您使用 facebook id 发送消息，请记住您需要发送消息`'to'=>'-4@chat.facebook.com'`。注意**负**号。
3.  Facebook 在捕捉网络中的垃圾邮件发送者方面非常聪明。如果您试图在短时间内发送太多类似的消息，Facebook 服务器将向机器人回复适当的错误（他们甚至可以暂时禁用您的聊天帐户）。检查日志以查看您是否从 facebook 服务器收到任何此类错误响应。

# date - 如何将 vim 文件的顺序部分复制到新文件中并用日期命名这些文件？

> ID：14338634
> 
> 赞同：0
> 
> 时间：2013-01-15T13:18:03.427
> 
> 标签：date, vim, macros, filenames, date-arithmetic

我有长度超过 100000 行的文件。

我想取前 n 行，剪切它们，然后将它们粘贴到一个名为 s20130115.txt（表示开始日期）的新文件中，然后保存并关闭新文件。然后我想取接下来的 n 行，剪切它们，并将它们粘贴到一个名为 20130116.txt 的文件中，然后保存并关闭新文件。

我想继续该过程，直到原始文件为空。

有什么想法吗？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:46:11.110

如果可能，您将希望使用`awk`其他脚本编辑工具来执行此操作；它会为你节省很多重复。所以我假设你不能出于某种原因；也许每次的行数都不一样，没有比看更好的方法了。

`:w`您可以使用带有范围的命令将文件中的行写入新文件。例如：

*   如果键入`10:w foo.txt``Enter`，它将从光标位置开始占用十行并将它们写入文件“foo.txt”。然后，您可以使用 删除这 10 行`10dd`。
*   您可以键入`:1,10w foo.txt``Enter`将文件的第 1-10 行写入“foo.txt”（从文件开头开始计数，无论光标位置如何）。输入删除`:1,10d``Enter`。
*   `V`您可以通过按住并移动光标来选择一系列行。选择范围后，键入`:w foo.txt``Enter`以写入行。`gv`用;再次选择相同的范围 然后你可以删除`d`.

# html - 响应式布局中元素两侧的边距相等

> ID：14338639
> 
> 赞同：4
> 
> 时间：2013-01-15T13:18:20.703
> 
> 标签：html, css, responsive-design

您好我正在尝试创建一个响应式布局，其中我有三个不同大小的元素，并且我希望所有屏幕的中间元素两侧的边距相等。

这是我的 HTML 和 CSS

```
<section class="container">
    <div href="/" class="pull-left logo"><img src="/images/logo.jpg"></a>
    <div class="slogan pull-left"><img src="/images/slogan.jpg"></div>
    <div class="pull-left support"></div>
</section>

<style>
 .pull-left
{
  float-left;
}
.slogan 
{
  margin: 0 17%;
}    
</style> 
```

由于徽标和支持部分是固定大小的。以上 Css 适用于一种分辨率，但随着屏幕尺寸的减小，边距不会保持不变。

任何想法如何实现这一目标？

编辑：这是小提琴。[http://jsfiddle.net/VdYua/22/](http://jsfiddle.net/VdYua/22/) 最初在 .slogan div 的两边都有相等的边距。但是在重新调整大小时，最后一个 div 转到下一行。我希望在没有制动布局的情况下减少余量。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-15T14:06:16.237

你在寻找这样的[东西](http://jsfiddle.net/LHCbk/)吗？

HTML：

```
<div class="centered">This is some content in the centered DIV</div> 
```

CSS：

```
.centered { background: #888; margin: 0 auto; width: 50%; } 
```

使用`margin: 0 auto`将使元素水平居中，这意味着它将具有“两边的边距相等”

使用上述方法时，您必须在元素上设置宽度，但如图所示，您可以使用百分比宽度（正如我想象的那样，您很可能会使用响应式布局）

但是，您不能在浮动元素上使用此技术，因此您可能希望在 CSS 中添加类似这样的内容：

```
.container { margin: 0 auto; width: 50%; } 
```

如果我误解了您的问题，请告诉我。

**编辑：**针对下面的评论，我认为我已经成功实现了您正在寻找的东西，请参阅this [fiddle](http://jsfiddle.net/VA4P6/)

HTML：

```
<section class="header">

  <div href="/" class="logo"><img src="/images/logo.jpg" /></div>

  <div class="slogan"><img src="/images/slogan.jpg" /></div>

  <div class="support"></div>

</section> 
```

CSS：

```
.header { padding: 0 50px 0 300px; position: relative; }

.logo, .support { background: red; height: 50px; position: absolute; top: 0; }
.support { background: blue; right: 0; width: 50px; }
.logo { left: 0; width: 300px; }

.slogan { background: black; height: 50px; margin: 0 auto; width: 50px; } 
```

The positioning/padding aspect of things isn't particularly pretty (if the width of .support or .logo change, you have to change that in the css) however I *think* this is the only safe way of doing it with pure HTML/CSS in a cross browser way (I'd be interested to see anyone elses take on it though), the important this is that it works and is completely valid.

# php - 异或两个十六进制字符串

> ID：14338640
> 
> 赞同：3
> 
> 时间：2013-01-15T13:18:22.997
> 
> 标签：php, xor

我想在 php 中对两个字符串（十六进制编码）进行异或。我曾尝试使用运算符 ^，但我只得到 0。我该怎么做？为什么是错的？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T13:30:47.080

```
<?php 
    $s1 = 'ABCDEF1234567890';
    $s2 = '0987654321ABCDEF';
    $x = bin2hex(pack('H*',$s1) ^ pack('H*',$s2));
?> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T13:22:08.937

```
$x = dechex(hexdec($s1) ^ hexdec($s2)); 
```

[http://codepad.org/fgRfAPAI](http://codepad.org/fgRfAPAI)

您最初遇到的问题是，十六进制字符串实际上是一个字符串。当您对字符串使用二进制运算符时，它使用字符代码作为字节值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-19T18:34:41.133

基于@KingCrunch 在这里的回答和评论，我编写了这个简单的循环来比较八位位组并建立答案。有趣的是，这与@lawlor 的答案具有相同的结果。

```
$key1 = 'ABCDEF1234567890ABCDEF1234567890';
$key2 = '0987654321ABCDEF0987654321ABCDEF';

$key1_octets = str_split($key1, 2);
$key2_octets = str_split($key2, 2);
$xor = '';
foreach ($key1_octets as $id => $key1_octet) {
  $xor .= dechex(hexdec($key1_octets[$id]) ^ hexdec($key2_octets[$id]));
}
print $xor;

print bin2hex(pack('H*',$key1) ^ pack('H*',$key2)); 
```

我实际上不确定其中任何一个是否是有效的结果，但我提出这个是为了反馈，以防它帮助其他人在不知道如何处理八位字节的情况下查看@KingCrunch 的答案。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T13:21:25.963

[在应用XOR](http://es1.php.net/manual/en/language.operators.bitwise.php)[运算符](http://es1.php.net/manual/en/language.operators.bitwise.php)之前，您需要使用[hex2bin()](http://php.net/hex2bin)对它们进行解码。[`^`](http://es1.php.net/manual/en/language.operators.bitwise.php)

**更新：**我总是忘记这个函数需要 PHP/5.4 或更高版本，这可能是个问题。在这种情况下，您需要使用不太直观的[pack()](http://php.net/pack)函数：

```
$binary = pack('H*', $hexadecimal); 
```

# android-fragments - 选择 DatePicker 后 AddFragment 崩溃 AddFragment 被“删除”并重新“添加”到 MainAcitivty

> ID：14338644
> 
> 赞同：0
> 
> 时间：2013-01-15T13:18:27.957
> 
> 标签：android-fragments, android-dialogfragment

我有一个包含 3 个片段的主要活动。

```
 public void getAddFragment() {  
    FragmentTransaction transaction = fragMgr.beginTransaction();
    //toggle active fragments
    hFragActive = false;
    bFragActive = false;
    aFragActive = true;

    aFragment.setRetainInstance(true);

    transaction.remove(hFragment);
    transaction.remove(bFragment);

    transaction.add(R.id.container, aFragment, TAG_TOGGLABLE_FRAG);

    transaction.commit();       
} 
```

我能够从一个跳转到另一个并且字段值被保留，因为我正在添加/删除......我的问题是“AddFragment”上的日期字段我可以首先启动并翻转所有选项菜单（3个片段）如果我不改变任何东西，它就可以正常工作。如果我更改任何文本等仍然可以。一旦我打开日期选择器对话框（子片段）并更新我的 AddFragment 我就没事了，直到我离开 AddFragment 并回来。它与此崩溃：

日志猫：

```
 01-14 16:20:42.068: D/ActivityLifecycle(32483): onCreate, savedInstanceState is null
01-14 16:20:42.099: D/FragmentLifecycle(32483): onAttach attach to com.example.optionfragmenttest.Main
01-14 16:20:42.099: D/FragmentLifecycle(32483): onCreate savedInstanceState is null
01-14 16:20:42.099: D/FragmentLifecycle(32483): onCreateView savedInstanceState is null
01-14 16:20:42.099: D/FragmentLifecycle(32483): savedInstanceState is NULL
01-14 16:20:42.099: D/FragmentLifecycle(32483): onActivityCreated savedInstanceState is null
01-14 16:20:42.099: D/FragmentLifecycle(32483): onStart
01-14 16:20:42.107: D/ActivityLifecycle(32483): onStart
01-14 16:20:42.107: D/ActivityLifecycle(32483): onResume
01-14 16:20:42.107: D/FragmentLifecycle(32483): onResume
01-14 16:20:42.115: D/FragmentLifecycle(32483): onPause
01-14 16:20:42.115: D/ActivityLifecycle(32483): onPause
01-14 16:20:42.139: D/libEGL(32483): loaded /vendor/lib/egl/libEGL_POWERVR_SGX540_120.so
01-14 16:20:42.139: D/libEGL(32483): loaded /vendor/lib/egl/libGLESv1_CM_POWERVR_SGX540_120.so
01-14 16:20:42.154: D/libEGL(32483): loaded /vendor/lib/egl/libGLESv2_POWERVR_SGX540_120.so
01-14 16:20:42.224: D/OpenGLRenderer(32483): Enabling debug mode 0
01-14 16:20:42.232: D/FragmentLifecycle(32483): onSaveInstanceState
01-14 16:20:42.232: D/ActivityLifecycle(32483): onSaveInstanceState
01-14 16:20:42.232: D/FragmentLifecycle(32483): onStop
01-14 16:20:42.232: D/ActivityLifecycle(32483): onStop
01-14 16:20:42.240: D/onCreateOptionsMenu(32483): onCreateOptionsMenu, menu is not null
01-14 16:20:42.435: D/FragmentLifecycle(32483): onStart
01-14 16:20:42.435: D/ActivityLifecycle(32483): onStart
01-14 16:20:42.521: D/ActivityLifecycle(32483): onResume
01-14 16:20:42.521: D/FragmentLifecycle(32483): onResume
01-14 16:20:49.428: D/FragmentLifecycle(32483): onPause
01-14 16:20:49.428: D/FragmentLifecycle(32483): onStop
01-14 16:20:49.428: D/FragmentLifecycle(32483): onDestroyView
01-14 16:20:49.428: D/FragmentLifecycle(32483): onDestroy
01-14 16:20:49.428: D/FragmentLifecycle(32483): onDetach
01-14 16:20:49.428: D/AddFragment(32483): onAttach attach to com.example.optionfragmenttest.Main
01-14 16:20:49.428: D/AddFragment(32483): onCreate savedInstanceState is null
01-14 16:20:49.428: D/AddFragment(32483): onCreateView savedInstanceState is null
01-14 16:20:49.467: D/dalvikvm(32483): GC_FOR_ALLOC freed 135K, 2% free 10969K/11143K, paused 18ms, total 19ms
01-14 16:20:49.490: D/AddFragment(32483): savedInstanceState is NULL
01-14 16:20:49.514: D/AddFragment(32483): onActivityCreated savedInstanceState is null
01-14 16:20:49.537: D/AddFragment(32483): Calendar instance
01-14 16:20:49.537: D/AddFragment(32483): post-OnClicListener
01-14 16:20:49.537: D/AddFragment(32483): onStart
01-14 16:20:49.537: D/AddFragment(32483): onResume
01-14 16:20:51.146: D/AddFragment(32483): datepicker touched
01-14 16:20:51.217: D/dalvikvm(32483): GC_CONCURRENT freed 100K, 2% free 11284K/11463K, paused 14ms+13ms, total 44ms
01-14 16:20:53.779: D/DateDialogFragment(32483): OnDateSet
01-14 16:20:53.810: D/DateDialogFragment(32483): OnDateSet
01-14 16:20:55.646: D/AddFragment(32483): onPause
01-14 16:20:55.646: D/AddFragment(32483): onDestroyView
01-14 16:20:55.654: D/AddFragment(32483): onDestroy
01-14 16:20:55.654: D/AddFragment(32483): onDetach
01-14 16:20:55.654: D/FragmentLifecycle(32483): onAttach attach to com.example.optionfragmenttest.Main
01-14 16:20:55.654: D/FragmentLifecycle(32483): onCreate savedInstanceState is null
01-14 16:20:55.654: D/FragmentLifecycle(32483): onCreateView savedInstanceState is null
01-14 16:20:55.662: D/FragmentLifecycle(32483): savedInstanceState is NULL
01-14 16:20:55.662: D/FragmentLifecycle(32483): onActivityCreated savedInstanceState is null
01-14 16:20:55.662: D/FragmentLifecycle(32483): onStart
01-14 16:20:55.662: D/FragmentLifecycle(32483): onResume
01-14 16:20:56.693: D/FragmentLifecycle(32483): onPause
01-14 16:20:56.693: D/FragmentLifecycle(32483): onStop
01-14 16:20:56.693: D/FragmentLifecycle(32483): onDestroyView
01-14 16:20:56.693: D/FragmentLifecycle(32483): onDestroy
01-14 16:20:56.693: D/FragmentLifecycle(32483): onDetach
01-14 16:20:56.693: D/AddFragment(32483): onAttach attach to com.example.optionfragmenttest.Main
01-14 16:20:56.693: D/AddFragment(32483): onCreate savedInstanceState is null
01-14 16:20:56.693: D/AddFragment(32483): onCreateView savedInstanceState is null
01-14 16:20:56.732: D/AddFragment(32483): savedInstanceState is NULL
01-14 16:20:56.873: D/AddFragment(32483): onActivityCreated savedInstanceState is null
01-14 16:20:56.881: D/AddFragment(32483): Calendar instance
01-14 16:20:56.889: D/AddFragment(32483): post-OnClicListener
01-14 16:20:56.889: D/AndroidRuntime(32483): Shutting down VM
01-14 16:20:56.889: W/dalvikvm(32483): threadid=1: thread exiting with uncaught exception (group=0x40f36300)
01-14 16:20:56.889: E/AndroidRuntime(32483): FATAL EXCEPTION: main
01-14 16:20:56.889: E/AndroidRuntime(32483): java.lang.IllegalStateException: No activity
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1075)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1070)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.support.v4.app.FragmentManagerImpl.dispatchActivityCreated(FragmentManager.java:1861)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.support.v4.app.Fragment.performActivityCreated(Fragment.java:1474)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:931)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1088)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:682)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1444)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:429)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.os.Handler.handleCallback(Handler.java:615)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.os.Looper.loop(Looper.java:137)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at android.app.ActivityThread.main(ActivityThread.java:4745)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at java.lang.reflect.Method.invokeNative(Native Method)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at java.lang.reflect.Method.invoke(Method.java:511)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
01-14 16:20:56.889: E/AndroidRuntime(32483):    at dalvik.system.NativeStart.main(Native Method)
01-14 16:20:58.435: I/Process(32483): Sending signal. PID: 32483 SIG: 9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-19T21:34:43.830

对于任何感兴趣的人，这是我遇到此异常时使用的解决方法：

```
public class CustomFragment extends Fragment {
    private static final Field sChildFragmentManagerField;
static {
    Field f = null;
    try {
        f = Fragment.class.getDeclaredField("mChildFragmentManager");
        f.setAccessible(true);
    } catch (NoSuchFieldException e) {
        Log.e(LOGTAG, "Error getting mChildFragmentManager field", e);
    }
    sChildFragmentManagerField = f;
}

@Override
public void onDetach() {
    super.onDetach();

    if (sChildFragmentManagerField != null) {
        try {
            sChildFragmentManagerField.set(this, null);
        } catch (Exception e) {
            Log.e(LOGTAG, "Error setting mChildFragmentManager field", e);
        }
    }
}

... 
```

}

# opengl - 如何渲染到 OpenGL Cubemap 纹理的一个面

> ID：14338650
> 
> 赞同：2
> 
> 时间：2013-01-15T13:18:53.780
> 
> 标签：opengl, framebuffer, rendertarget

我正在制作一个立方体贴图渲染目标类。我已经有一个可以正常工作的 2D 了。但是对于这个立方体贴图渲染目标类，我希望能够按照我的意愿渲染到特定的面。也许我想在“X+”面上渲染圆形，但在“Y+”面上渲染三角形。

这就是我的班级的样子

```
class CRenderTarget 
{
private:
    //frame buffer to render on
    unsigned  m_uifboHandle;

    //depth stencil 
    unsigned  m_uiDepthStencilHandle;

    //the texture we will render on
    unsigned  m_uiTextureHandle;

public:
    CCubeRenderTarget( void );

    ~CCubeRenderTarget( void );

    void Create( unsigned uiHeightWidth = 512,
             int iInternalFormat = 0x1908 ); //GL_RGBA

    void Bind( void );

    void UnBind( void );
} 
```

这就是我的创建函数的样子

```
void Create( unsigned uiHeightWidth, int iInternalFormat )
{
        //generate our variables
    glGenFramebuffers(1, &m_uifboHandle);
    glGenRenderbuffers(1, &m_uiDepthStencilHandle);
    glGenTextures(1, &m_uiTextureHandle);

    // Initialize FBO
    glBindFramebuffer( GL_FRAMEBUFFER, m_uifboHandle);

    glBindTexture( GL_TEXTURE_CUBE_MAP, m_uiTextureHandle);

    // Pre-allocate the correct sized cube map
    glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_Z, 0, iInternalFormat, uiHeightWidth, uiHeightWidth, 0, GL_RGB, GL_UNSIGNED_BYTE, NULL);
    glTexImage2D(GL_TEXTURE_CUBE_MAP_NEGATIVE_Z, 0, iInternalFormat, uiHeightWidth, uiHeightWidth, 0, GL_RGB, GL_UNSIGNED_BYTE, NULL);
    glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_X, 0, iInternalFormat, uiHeightWidth, uiHeightWidth, 0, GL_RGB, GL_UNSIGNED_BYTE, NULL);
    glTexImage2D(GL_TEXTURE_CUBE_MAP_NEGATIVE_X, 0, iInternalFormat, uiHeightWidth, uiHeightWidth, 0, GL_RGB, GL_UNSIGNED_BYTE, NULL);
    glTexImage2D(GL_TEXTURE_CUBE_MAP_POSITIVE_Y, 0, iInternalFormat, uiHeightWidth, uiHeightWidth, 0, GL_RGB, GL_UNSIGNED_BYTE, NULL);
    glTexImage2D(GL_TEXTURE_CUBE_MAP_NEGATIVE_Y, 0, iInternalFormat, uiHeightWidth, uiHeightWidth, 0, GL_RGB, GL_UNSIGNED_BYTE, NULL);

    glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
    glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
    glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
    glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
    glTexParameteri(GL_TEXTURE_CUBE_MAP, GL_TEXTURE_WRAP_R, GL_CLAMP_TO_EDGE);

    // Must attach texture to framebuffer. Has Stencil and depth
    glBindRenderbuffer(GL_RENDERBUFFER, m_uiDepthStencilHandle);
    glRenderbufferStorage(GL_RENDERBUFFER, /*GL_DEPTH_STENCIL*/GL_DEPTH24_STENCIL8, uiHeightWidth, uiHeightWidth );
    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, m_uiDepthStencilHandle);
    glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_STENCIL_ATTACHMENT, GL_RENDERBUFFER, m_uiDepthStencilHandle);

    glBindFramebuffer(GL_FRAMEBUFFER, 0);
} 
```

这就是我的绑定函数的样子

```
void Bind( void )
{
    glBindFramebuffer( GL_FRAMEBUFFER, m_uifboHandle );
} 
```

//这就是我的解绑函数的样子

```
void Unbind( void )
{
    glBindFramebuffer( GL_FRAMEBUFFER, 0 );
} 
```

过去一周我做了很多研究。我似乎无法找到一种方法，我可以通过一些方法来绑定我的整个立方体贴图，而不是绑定我的立方体贴图的一个面。这是我的总体目标。我知道在 DirectX 中，您只需抓取 6 个面并手动处理它们，但我如何手动处理 openGL 立方体贴图上的每个面？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T13:40:10.767

绑定帧缓冲区后，您需要指定应该定位的纹理级别。它应该是这样的：

```
glBindFramebuffer( GL_FRAMEBUFFER, m_uifboHandle );
glFramebufferTexture2D( GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_CUBE_MAP_POSITIVE_X, m_uiTextureHandle, 0); 
```

# sql-server - 恢复到新服务器后缺少对称密钥和主密钥

> ID：14338657
> 
> 赞同：1
> 
> 时间：2013-01-15T13:19:12.970
> 
> 标签：sql-server, encryption, sql-server-2012

我在以前的服务器上有一个 SQL 数据库，其中我有一个使用以下语法创建的主密钥和证书：

```
CREATE MASTER KEY ENCRYPTION BY PASSWORD = 'AReallyReallyReallySecurePassword!!!!!'
CREATE CERTIFICATE CPCertificate01 WITH SUBJECT = 'CP Certificate'
CREATE SYMMETRIC KEY SSN_Key_01 WITH ALGORITHM = TRIPLE_DES ENCRYPTION BY CERTIFICATE CPCertificate01 
```

我已经完成了这个数据库的备份，现在将它恢复到一个新的服务器上（SQL Server 的全新安装）。

当我尝试对数据库运行命令时，出现此错误：

> **找不到对称密钥“SSN_Key_01”，因为它不存在或您没有权限。**

但是，如果我运行此代码...

```
select * from sys.symmetric_keys 
```

...我可以看到结果集中列出了 SSN_Key_01。

我还收到与不存在的主密钥有关的其他错误。

谁能指导我如何在不丢失任何数据的情况下在新服务器上重新创建加密设置？如果需要，我仍然可以访问旧服务器。谢谢。

# java - Magento XML-RPC API - 从 Java 创建货件

> ID：14338658
> 
> 赞同：3
> 
> 时间：2013-01-15T13:19:13.217
> 
> 标签：java, api, magento, xml-rpc

我正在尝试使用 XML-RPC API 从我的第三方应用程序为 magento 订单创建发货。当我只使用订单增量 ID 调用“sales_order_shipment.create”时，一切正常，但如果我尝试使用订单增量 ID 和一组项目和数量进行相同的调用，它会显示“请求的订单不是存在。” 这是为什么？我做错了什么？itemQuantity 应该是什么类型）

这是我的代码

```
package magentoapiclient;

import java.net.MalformedURLException;
import java.net.URL;
import java.util.HashMap;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;
import org.apache.xmlrpc.XmlRpcException;
import org.apache.xmlrpc.client.XmlRpcClient;
import org.apache.xmlrpc.client.XmlRpcClientConfigImpl;

public class XMLRPCAPIClient {

    public static void main(String[] args) {
        createShipment("100000005", 5, 1.0);
    }

    public static XmlRpcClient prepareClient() throws MalformedURLException {
        XmlRpcClientConfigImpl config = new XmlRpcClientConfigImpl();
        config.setServerURL(new URL("myHost"));
        XmlRpcClient client = new XmlRpcClient();
        client.setConfig(config);
        client.setTypeFactory(new MyTypeFactory(client));
        return client;
    }

    public static void createShipment(String orderIncrementId, int itemId, double quantity) {
        try {
            XmlRpcClient client = prepareClient();
            String sessionId = login("myUser", "myKey", client);
            System.out.println(sessionId);
            Object[] request = {orderIncrementId, new HashMap()};
            client.execute("call", new Object[]{sessionId, "sales_order_shipment.create", request});
            endSession(sessionId, client);
        } catch (XmlRpcException | MalformedURLException ex) {
            Logger.getLogger(XMLRPCAPIClient.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    public static String login(String user, String password, XmlRpcClient client) throws XmlRpcException {
        String sessionId = (String) client.execute("login", new Object[]{user, password});
        return sessionId;
    }

    public static void endSession(String sessionToken, XmlRpcClient client) throws XmlRpcException {
        client.execute("endSession", new Object[]{sessionToken});
    }
} 
```

正如你在行中看到的

> Object[] request = {orderIncrementId, new HashMap()};

我尝试发送一个实际上应该包含订单商品 ID 和数量的 hashMap。我还尝试发送一个对象数组，但它对其中任何一个都不起作用。如果 Map 或 Array 都不可用，那还有什么办法呢？

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-27T20:19:08.950

订单 ID 和订单增量 ID 不同。您应该发送订单增量 ID。

[http://www.magentocommerce.com/api/soap/sales/salesOrder/sales_order.info.html](http://www.magentocommerce.com/api/soap/sales/salesOrder/sales_order.info.html)

# c++ - C ++ int数组中的foreach

> ID：14338660
> 
> 赞同：10
> 
> 时间：2013-01-15T13:19:23.267
> 
> 标签：c++, visual-c++, c++11

我是 C++ 新手，我正在编写以下代码。我需要遍历调用函数中的所有插件 - `testFunction`. 我知道这在 C# 中有效，但这段代码不起作用。谁能指出用 C++ 做的正确方法？

```
#include "stdafx.h"
#include <iostream>
#include "resource.h"

int testFunction(char* tester);
int _tmain()
{
    int mainProd=2;
    int Addons[]={7,8,9,10};

    testFunction(mainProd,Addons);

}
void testFunction(int mainProd,int addons[])
{
    for(int x = 0 ; addons.length;++x) ---- Not working 
    {
        std::cout<< addons[x];
    }
} 
```

* * *

我尝试按照你们的以下建议来实现向量

```
#include "stdafx.h"
#include <iostream>
#include "resource.h"
#include <vector>

void testFunction(std::vector<int> addons);

int _tmain(int argc, _TCHAR* argv[])
{

    std::vector<int>  Addons ;
    for(int i = 0 ;i<10;++i)
    {
        Addons.push_back(i);
    }
     testFunction(Addons);
}

void testFunction(std::vector<int> addons)
{
    for(int i =0 ; i<addons.size();++i)
    {
        std::cout<<addons.at(i);
    }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-15T13:21:44.767

数组（原始数组）在作为参数传递给函数时衰减为指针，因此您的数组没有大小信息。

您需要将数组的长度显式传递给函数才能在函数内部知道它。

或者，更好的是，使用 a`std::vector`然后您将`.size()`在需要时始终可用。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-15T13:25:43.657

正如 Tony 建议的那样，除了使用向量之外，您还可以使用模板并通过引用传递数组，以便编译器推断出数组的大小：

```
template<int N>
void testFunction(int mainProd,int (&addons)[N])
{
    for(int x = 0; x < N; ++x) // ---- working 
    {
        std::cout<< addons[x];
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-15T14:20:39.963

您在 C++ 中使用 C# 的概念，但是，即使我们假设两种语言相似，它们也不相同。

C++ 中 ranged-for 的语法[如下](http://www.stroustrup.com/C++11FAQ.html#for)：

```
for (type identifier : container) // note the ':', not ';'
{
    // do stuff
} 
```

如果你有[C++11 编译器](https://wiki.apache.org/stdcxx/C%2B%2B0xCompilerSupport)，你可以用它来*调味*。

顺便说一句，您似乎在代码中使用了属性：

```
for(int x = 0 ; addons.length;++x) // what is lenght?
{
    std::cout<< addons[x];
} 
```

C++ 中没有这样的东西，如果你想调用一个对象方法，你需要将它作为一个函数来调用：

```
// assuming that the object 'addons' have a method
// named 'length'  that takes no parameters
addons.length(); 
```

但是这个`addons`变量不是一个对象，是一个数组（看看[这个教程](https://stackoverflow.com/questions/4810664/how-do-i-use-arrays-in-c)），所以它没有一个名为的方法或属性`length`；如果您需要知道它的长度以便对其进行迭代，您可以在某些情况下使用`sizeof`运算符（有关更多信息，请参阅教程）。

假设这`addons`是一个容器：

```
typedef std::vector<addon> Addons;
Addons addons; 
```

如果你想使用 C++11 range-for 对其进行迭代，你可以这样写：

```
for (addon a : addons)
{
    // do stuff with a.
} 
```

希望能帮助到你。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-15T13:41:33.403

如果您要使用`std::vector`or `std::array`，您可以使用`std::foreach`,

```
std::vector<int> addons = {7,8,9,10};
std::array<int, 4> addons = {7,8,9,10}; // Only use one of these...
std::foreach(addons.begin(), addon.end(), [](int i) {
    std::cout << i
}); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-08-28T18:45:44.210

代码正在处理这个

for (int i = 0; i < (end(array) - begin(array)); i++)

返回最大尺寸

测试数组是否为空

```
array::empty 
```

数组元素

```
array::size 
```

数组大小

```
sizeof() 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-03-29T16:09:53.100

如果你不想使用任何 STL 容器，你只需要通过对函数的引用来传递数组。这里的问题是，如果没有数组的确切大小，您就无法定义这样的参数。您可以克服这个限制，将函数设为模板，将大小定义为模板参数：

```
#include <iostream>

template<int N>
void testFunction(int mainProd,int (&addons)[N])
{
    for(int x = 0 ; x < N; ++x)
    {
        std::cout<< addons[x];
    }
}

int main()
{
    int mainProd=2;
    int Addons[]={7,8,9,10};

    testFunction(mainProd,Addons);
    return 0;
} 
```

# unit-testing - CakePHP 应用程序中的单元测试脚本

> ID：14338661
> 
> 赞同：0
> 
> 时间：2013-01-15T13:19:25.807
> 
> 标签：unit-testing, cakephp, phpunit

我使用 CakePHP 开发了一个交易应用程序。现在我想使用 PHPUnit 编写单元脚本。我已经在我的服务器上安装了 PHPUnit，并且测试核心测试工作正常。还安装了 Xdebug 用于代码分析。当我要为现有应用程序编写脚本时，它不起作用。我能够在模型中编写登录方法的单元脚本。但是不能为剩余的方法编写脚本。

```
<?php

App::uses('User', 'Model');

class UserTest extends CakeTestCase {
    public $fixtures = array('app.user');
    public $dropTables = false;
    public function setUp() {
        parent::setUp();
        $this->User = ClassRegistry::init('User');
    }

    public function testLogin() {
         $result = $this->User->find('count', array(
            'conditions' => array(
                // making some assumptions about the test data here
                'email' => 'test.user@gmail.com',
                'password' => 'f1054da373ace628dc73b8ec52eb28072b074940',
            ),));
        $expected = 1;
        $this->assertEquals($expected, $result);
    }

}
?> 
```

它运行良好。但我无法为其余方法编写脚本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T20:11:26.503

尝试使用 bake 和 bake 测试以开始使用正确的测试结构：

```
cake bake test 
```

这可能有助于按照 Cake 期望的测试结构方式将您推向写入方向。它还将创建空方法来测试控制器中的所有方法。

你能更具体地说明什么不起作用吗？

# javascript - javascript：不同的语法相同的答案

> ID：14338667
> 
> 赞同：-4
> 
> 时间：2013-01-15T13:19:53.533
> 
> 标签：javascript

```
<input type="checkbox" id="alert1" value="111">
<input type="checkbox" id="alert2" value="222">
<input type="checkbox" id="alert3" value="333">
<input type="button" onclick="checkBox()" value="check">

function checkBox(){

   var alert1 = document.getElementById('alert1').checked;
   var alert2 = document.getElementById('alert2').checked;
   var alert3 = document.getElementById('alert3').checked;

   if(alert1 == 1 && alert2 == 2 && alert3 == 1){
      do somthing...
   }

   if(alert1 == 1 || alert2 == 2 || alert3 == 1){
      do somthing...
   }
} 
```

如果我只喜欢其中一个条件为“真”，我该怎么办。此语法将两个条件都显示为“真”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:24:37.393

我希望我能正确理解想要什么...给你

```
var onlyOne = (alert1 == 1) + (alert2 == 1) + (alert3 == 1);
if (onlyOne == 1)
{
   // do stuff
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:28:21.510

我很难理解你需要什么。希望这就是你所追求的

```
function (){
  if(alert1 == 1 && alert2 == 2 && alert3 == 1){
    //do some stuff
  } else if (alert1 == 1 || alert2 == 2 || alert3 == 1){
    //do other stuff
  }
} 
```

# php - 没有发现在 404 页面显示两次？

> ID：14338669
> 
> 赞同：0
> 
> 时间：2013-01-15T13:20:05.300
> 
> 标签：php, wordpress

在 404.php 页面中，我的原始消息显示正确，但我还在页脚中收到第二条消息，我检查了所有文件并在 Google 上搜索了很多关于这个问题的信息，但没有得到任何结果。

这是活生生的例子：[http ://www.rapyemen.org/?page_id=181](http://www.rapyemen.org/?page_id=181)

任何人都可以帮助解决获得两条 404 消息的问题吗？

这是我的 404.php 代码：

```
 <div id="container">

        <?php 
            // action hook for placing content above #content
            nd_abovecontent();

            // filter for manipulating the element that wraps the content 
            echo apply_filters( 'nd_open_id_content', '<div id="content">' . "\n\n" );

            // action hook for placing content above #post
            nd_abovepost(); 
        ?>

            <div id="post-0" class="post error404">

        <div class="entry-content">
            <p><?php _e( 'Apologies, but we were unable to find what you were looking for. Perhaps searching will help.', 'thematic' ) ?></p>
        </div><!-- .entry-content -->

        <form id="error404-searchform" method="get" action="<?php echo home_url(); ?>/">
            <div>
                <input id="error404-s" name="s" type="text" value="<?php the_search_query(); ?>" size="40" />
                <input id="error404-searchsubmit" name="searchsubmit" type="submit" value="<?php esc_attr_e( 'Find', 'thematic' ); ?>" />
            </div>
        </form>

            </div><!-- .post -->

            <?php 
                // action hook for placing content below #post
                nd_belowpost(); 
            ?>

        </div><!-- #content -->

        <?php 
            // action hook for placing content below #content
            nd_belowcontent(); 
        ?> 

    </div><!-- #container -->

<?php
// action hook for placing content below #container
nd_belowcontainer();

// calling the standard sidebar 
nd_sidebar();

// calling footer.php
get_footer();
?> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-15T13:25:00.360

好像没有页面 id 被调用`118`。

例如你的`Contact Us page work fine with page id of`208`。

确保您传递了正确的页面 ID。

# java - 在运行时替换 jar 时发生 ClassNotFoundException

> ID：14338672
> 
> 赞同：1
> 
> 时间：2013-01-15T13:20:11.237
> 
> 标签：java, classloader

我运行一个打包在A.jar 中的java 应用程序，其中使用了B.jar 中的一些类。

所有相关的 jar 都放在一个特定的目录中，该目录包含在类路径中。

程序是这样的：

```
main(){

    run method ClassA.M1() in A.jar;  //the method may keep running for 2 minutes

    do some other prepare;

    call method ClassB.M2 in B.jar;

} 
```

当程序运行M1时，我手动将B.jar替换为较新的版本（名称也是B.jar）。

但是，程序抛出 ClassNotFoundException。

然后，再次启动程序，它工作正常。

所以，我的问题是：为什么抛出 ClassNotFoundException，因为 jar 路径和 jar 名称没有改变，类加载器应该加载它没有任何麻烦。

请给我一些指示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:50:33.317

您不能在运行时通过将 jar 文件替换为具有相同名称的文件来简单地更改它们，因为类加载器可能已经从中加载了一些类。

如果您需要支持此类行为，则需要研究可提供热替换机制的库或框架。

这里有两篇文章可以帮助你更好地理解类加载器：

*   [Java 类加载器基础 (1996)](http://www.javaworld.com/jw-10-1996/jw-10-indepth.html)
*   [了解 Java 类加载器 (2001)](http://www.ibm.com/developerworks/java/tutorials/j-classloader/section2.html)

Stack OverFlow 上有很多关于这个主题的文章，甚至还有相关的问题，我建议你阅读更多。

# html - 使元素在媒体屏幕上对齐已更改

> ID：14338673
> 
> 赞同：0
> 
> 时间：2013-01-15T13:20:14.497
> 
> 标签：html, css

当屏幕的 x 轴或 y 轴高于或小于另一个轴时，我有两个 div 会改变它们的位置。您可以在 JsFiddle 示例中对其进行测试。

[JSFIdle](http://jsfiddle.net/czQTT)

当两个 div 的位置发生变化时，我的 ButtonToolbar 元素位置变得混乱。如何解决这个定位问题？

我试过使用位置`position:relative`，但没有设法让它工作。有任何想法吗？希望你能理解我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:29:48.627

让我们希望我明白你的问题是什么。在媒体查询中，您应该更改“dhFieldset”的显示方式。

所以它会是这样的：

**正常位置：**

```
.dhFieldset{
   color: white;
   font-size:6px;
   width: 27px;
   height:80px;
   background-color:green;

} 
```

**在屏幕顶部：**

```
@media screen and (max-aspect-ratio: 1/1) { 
.dhFieldset{
   color: white;
   font-size:6px;
   height: 27px;
   width:80px;
   margin-left:22px;
   float:left;   
} 
```

这是[更新的 jsFiddle](http://jsfiddle.net/czQTT/1/)。

希望能帮助到你！！干杯。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:31:49.177

而不是在屏幕顶部显示时使用`position:relative`try `float:left`on 。`.dhFieldset`

```
@media screen and (max-aspect-ratio: 1/1) { 
    .dhFieldset{
      color: white; 
      height: 35px;
      width:80px;
      margin-left:22px;
      float:left;
} 
```

此外，如果您不希望它们低于其他 - 您将需要设置`min-width`为`.dhButtonToolbar`. 就像在[这里](http://jsfiddle.net/czQTT/4/)完成的那样 或者您可以将 dhFieldset 的宽度更改为百分比宽度。

# google-maps - 谷歌地图触发事件不起作用

> ID：14338679
> 
> 赞同：-2
> 
> 时间：2013-01-15T13:20:49.083
> 
> 标签：google-maps, google-maps-api-3

我已经实现了谷歌地图事件触发器。但是，似乎没有触发/调用任何事件。所以我在代码上方添加了函数初始化，因为 glob var 位于另一个文件中。但是，出现了新问题，标签消失了。

几个问题：1）是否正确添加了全局变量？2）我是否必须将 google.maps.event 添加到选项卡构造函数中？3）我尝试了很多，但地图似乎仍然坏了。有什么解决方案吗？

```
 ?>        
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
    <script type="text/javascript">

    var map;
    function initialize() {
        var latLng = new google.maps.LatLng(<?php echo $geo_latitude;?>, <?php echo $geo_longitude;?>);
        Demo.map = new google.maps.Map(Demo.mapContainer, {
            <?php 
            if(get_option('ptthemes_scale_factor')){ 
                $ptthemes_scale_factor = get_option('ptthemes_scale_factor');
            } else {
                $ptthemes_scale_factor = 13;
            }
            ?>
            zoom: <?php echo $ptthemes_scale_factor;?>,
            center: latLng,
            <?php 
            if($map_type=='Road Map' || $map_type=='Satellite Map'|| $map_type=='Terrain Map'){
                if($map_type=='Satellite Map') { 
                    $map_type = SATELLITE; 
                } elseif($map_type=='Terrain Map') { 
                    $map_type = TERRAIN; 
                } else { 
                    $map_type = ROADMAP; 
                } 
                ?>
                mapTypeId: google.maps.MapTypeId.<?php echo $map_type;?>
            <?php 
            } else {
            ?>
               mapTypeId: google.maps.MapTypeId.ROADMAP
            <?php 
            }
            ?>
        });
        var marker = new google.maps.Marker({
            position: latLng, 
            map: Demo.map,
            title:"<?php echo trim($post->post_title);?>"
        });     

        jQuery.noConflict();
        jQuery(document).ready(function($) {
            jQuery("#tabs").tabs();
        });
        $(function() {
            $("#tabs").tabs({
                activate: function(e, ui) {                                
                    google.maps.event.trigger(Demo.map, "resize");
                }
            });
        });
    }
    </script> 
```

全局变量在这里定义：

```
init: function() {
    var latLng = new google.maps.LatLng(<?php echo $geo_latitude;?>, <?php echo $geo_longitude;?>);
    Demo.map = new google.maps.Map(Demo.mapContainer, {
        <?php 
        if(get_option('ptthemes_scale_factor')) { 
            $ptthemes_scale_factor = get_option('ptthemes_scale_factor');}
        else {
             $ptthemes_scale_factor = 13;
        }
        ?>
        zoom: <?php echo $ptthemes_scale_factor;?>,
        center: latLng,
        <?php 
        if($map_type=='Road Map' || $map_type=='Satellite Map'|| $map_type=='Terrain Map'){
            if($map_type=='Satellite Map') { 
                $map_type = SATELLITE; 
            } elseif($map_type=='Terrain Map') { 
                 $map_type = TERRAIN; 
            } else { 
                $map_type = ROADMAP; 
            } ?>
            mapTypeId: google.maps.MapTypeId.<?php echo $map_type;?>
            <?php 
        } else {
        ?>
        mapTypeId: google.maps.MapTypeId.ROADMAP
        <?php 
        }
        ?>
    });
    var marker = new google.maps.Marker({
        position: latLng, 
        map: Demo.map,
        title:"<?php echo trim($post->post_title);?>"
    });   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:24:06.037

您遇到了 JavaScript 解析错误。第 484 行有一个额外的右大括号`}`。修复它并查看您的问题是否仍然存在。

# c# - Enumerable.ElementAt 有什么意义 ?

> ID：14338680
> 
> 赞同：6
> 
> 时间：2013-01-15T13:20:55.667
> 
> 标签：c#, .net, ienumerable

`IEnumerable<T>`公开一个枚举器，因此可以枚举对象。此接口公开的索引没有任何内容。`IList<T>`是关于索引的，因为它公开了`IndexOf`方法。

那么 Enumerable.ElementAt 的意义何在？我刚刚阅读了这个 LINQ 扩展方法的[文档：](http://msdn.microsoft.com/en-us/library/bb299233%28v=vs.110%29.aspx)

> 返回序列中指定索引处的元素。

嗯，是的，它是关于一个**序列**，而不仅仅是一个`IEnumerable`. 阅读注释：

> 如果源的类型实现了 IList，则该实现用于获取指定索引处的元素。否则，此方法获取指定元素。

好的，所以如果具体类型实现了继承自的东西`IList<T>`（这是一个实际的序列），那么它与`IndexOf()`. 如果不是，它会迭代直到达到索引。

这是一个示例场景：

```
// Some extension method exposed by a lib
// I know it's not a good piece of code, but let's say it's coded this way:
public static class EnumerableExtensions
{
    // Returns true if all elements are ordered
    public static bool IsEnumerableOrdered(this IEnumerable<int> value)
    {
        // Iterates over elements using an index
        for (int i = 0; i < value.Count() - 1; i++)
        {
            if (value.ElementAt(i) > value.ElementAt(i + 1))
            {
                return false;
            }
        }

        return true;
    }
}

// Here's a collection that is enumerable, but doesn't always returns
// its objects in the same order
public class RandomAccessEnumerable<T> : IEnumerable<T>
{
    private List<T> innerList;
    private static Random rnd = new Random();

    public RandomAccessEnumerable(IEnumerable<T> list)
    {
        innerList = list.ToList();
    }

    public IEnumerator<T> GetEnumerator()
    {
        var listCount = this.innerList.Count;
        List<int> enumeratedIndexes = new List<int>();

        for (int i = 0; i < listCount; i++)
        {
            int randomIndex = -1;
            while (randomIndex < 0 || enumeratedIndexes.Contains(randomIndex))
            {
                randomIndex = rnd.Next(listCount);
            }

            enumeratedIndexes.Add(randomIndex);
            yield return this.innerList[randomIndex];
        }
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }
}

// Here's some test program
internal class Program
{
    private static void Main()
    {
        var test0 = new List<int> { 0, 1, 2, 3 };
        var test1 = new RandomAccessEnumerable<int>(test0);

        Console.WriteLine("With List");
        Console.WriteLine(test0.IsEnumerableOrdered()); // true
        Console.WriteLine(test0.IsEnumerableOrdered()); // true
        Console.WriteLine(test0.IsEnumerableOrdered()); // true
        Console.WriteLine(test0.IsEnumerableOrdered()); // true
        Console.WriteLine(test0.IsEnumerableOrdered()); // true

        Console.WriteLine("With RandomAccessEnumerable");
        Console.WriteLine(test1.IsEnumerableOrdered()); // might be true or false
        Console.WriteLine(test1.IsEnumerableOrdered()); // might be true or false
        Console.WriteLine(test1.IsEnumerableOrdered()); // might be true or false
        Console.WriteLine(test1.IsEnumerableOrdered()); // might be true or false
        Console.WriteLine(test1.IsEnumerableOrdered()); // might be true or false

        Console.Read();
    }
} 
```

因此，`RandomAccessEnumerable`可能会以随机顺序返回枚举对象，您不能依赖简单的`IEnumerable<T>`界面来假设您的元素已编入索引。所以你不想`ElementAt`使用`IEnumerable`.

在上面的例子中，我认为`IsEnumerableOrdered`应该需要一个`IList<T>`参数，因为它意味着元素是一个序列。我实际上找不到该`ElementAt`方法有用且不易出错的场景。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T13:29:44.027

有很多`IEnumerable`类型，例如数组或列表。所有`IList`类型（[`Array`](http://msdn.microsoft.com/en-us/library/czz5hkty.aspx)也实现）都有一个[**索引器**](http://msdn.microsoft.com/en-us/library/5y536ey6.aspx)，您可以使用它来访问特定索引处的元素。

`Enumerable.ElementAt`如果可以成功转换序列，则将使用此选项`IList`。否则将被枚举。

所以这只是一种方便的方式来访问所有类型的给定索引处的元素`IEnumerable`。

这样做的好处是您可以稍后更改类型，而无需更改所有出现的`arr[index]`.

对于它的价值，这里是反射（ILSpy）方法来演示我所说的：

```
public static TSource ElementAt<TSource>(this IEnumerable<TSource> source, int index)
{
    if (source == null)
    {
        throw Error.ArgumentNull("source");
    }
    IList<TSource> list = source as IList<TSource>;
    if (list != null)
    {
        return list[index];
    }
    if (index < 0)
    {
        throw Error.ArgumentOutOfRange("index");
    }
    TSource current;
    using (IEnumerator<TSource> enumerator = source.GetEnumerator())
    {
        while (enumerator.MoveNext())
        {
            if (index == 0)
            {
                current = enumerator.Current;
                return current;
            }
            index--;
        }
        throw Error.ArgumentOutOfRange("index");
    }
    return current;
} 
```

# node.js - 使用restify时如何支持cors

> ID：14338683
> 
> 赞同：47
> 
> 时间：2013-01-15T13:21:02.083
> 
> 标签：node.js, cors, restify

我有一个使用 restify 模块创建的 REST api，我想允许跨域资源共享。最好的方法是什么？

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2013-01-24T17:09:40.637

您必须设置服务器以设置跨源标头。不确定是否有内置的使用功能，所以我自己写了。

```
server.use(
  function crossOrigin(req,res,next){
    res.header("Access-Control-Allow-Origin", "*");
    res.header("Access-Control-Allow-Headers", "X-Requested-With");
    return next();
  }
); 
```

我从本教程中找到了这个。[http://backbonetutorials.com/nodejs-restify-mongodb-mongoose/](http://backbonetutorials.com/nodejs-restify-mongodb-mongoose/)

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2013-03-06T02:49:57.083

最新版本的 Restify 提供[了一个插件来处理 CORS](http://restify.com/#cors)。

所以你现在可以像这样使用它：

```
server.use(restify.CORS({

  // Defaults to ['*'].
  origins: ['https://foo.com', 'http://bar.com', 'http://baz.com:8081'], 

  // Defaults to false.
  credentials: true,

  // Sets expose-headers.
  headers: ['x-foo']   

})); 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-10-08T08:59:47.913

这对我有用：

```
var restify = require('restify');

var server = restify.createServer();

server.use(restify.CORS());

server.opts(/.*/, function (req,res,next) {
    res.header("Access-Control-Allow-Origin", "*");
    res.header("Access-Control-Allow-Methods", req.header("Access-Control-Request-Method"));
    res.header("Access-Control-Allow-Headers", req.header("Access-Control-Request-Headers"));
    res.send(200);
    return next();
});

server.get('/test', function (req,res,next) {

    res.send({
        status: "ok"
    });
    return next();
});

server.listen(3000, function () {
    console.log('%s listening at %s', server.name, server.url);
}); 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-04-12T21:26:46.773

这对我有用：

```
function unknownMethodHandler(req, res) {
  if (req.method.toLowerCase() === 'options') {
      console.log('received an options method request');
    var allowHeaders = ['Accept', 'Accept-Version', 'Content-Type', 'Api-Version', 'Origin', 'X-Requested-With']; // added Origin & X-Requested-With

    if (res.methods.indexOf('OPTIONS') === -1) res.methods.push('OPTIONS');

    res.header('Access-Control-Allow-Credentials', true);
    res.header('Access-Control-Allow-Headers', allowHeaders.join(', '));
    res.header('Access-Control-Allow-Methods', res.methods.join(', '));
    res.header('Access-Control-Allow-Origin', req.headers.origin);

    return res.send(204);
  }
  else
    return res.send(new restify.MethodNotAllowedError());
}

server.on('MethodNotAllowed', unknownMethodHandler); 
```

我这段代码取自[https://github.com/mcavage/node-restify/issues/284](https://github.com/mcavage/node-restify/issues/284)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2017-10-09T04:55:24.203

CORS 插件已弃用，取而代之的是[https://github.com/Tabcorp/restify-cors-middleware](https://github.com/Tabcorp/restify-cors-middleware)。（来源：[https](https://github.com/restify/node-restify/issues/1091) ://github.com/restify/node-restify/issues/1091 。）

以下是有关如何使用的示例代码

```
const corsMiddleware = require('restify-cors-middleware')

const cors = corsMiddleware({
  preflightMaxAge: 5, //Optional
  origins: ['http://api.myapp.com', 'http://web.myapp.com'],
  allowHeaders: ['API-Token'],
  exposeHeaders: ['API-Token-Expiry']
})

server.pre(cors.preflight)
server.use(cors.actual) 
```

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-02-22T11:53:42.557

如果有人在 2018 年 2 月遇到这个问题，似乎有一个错误已经被引入，我无法让它`restify-cors-middleware`工作。

我现在正在使用这个工作：

```
server.pre((req, res, next) => {
   res.header("Access-Control-Allow-Origin", "*");
   next();
}); 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2014-08-27T16:15:15.627

为了启用 CORS 进行基本身份验证，我执行了以下操作。`.pre`在使用方法而不是方法`.use`之前它不起作用

```
server.pre(restify.CORS({
  origins: ['https://www.allowedip.com'],  // defaults to ['*']
  credentials: true,
  headers: ['X-Requested-With', 'Authorization']
}));
server.pre(restify.fullResponse());

function unknownMethodHandler(req, res) {
    if (req.method.toLowerCase() === 'options') {
      var allowHeaders = ['Accept', 'Accept-Version', 'Content-Type', 'Api-Version', 'Origin', 'X-Requested-With', 'Authorization']; // added Origin & X-Requested-With & **Authorization**

      if (res.methods.indexOf('OPTIONS') === -1) res.methods.push('OPTIONS');

      res.header('Access-Control-Allow-Credentials', true);
      res.header('Access-Control-Allow-Headers', allowHeaders.join(', '));
      res.header('Access-Control-Allow-Methods', res.methods.join(', '));
      res.header('Access-Control-Allow-Origin', req.headers.origin);

      return res.send(200);
   } else {
      return res.send(new restify.MethodNotAllowedError());
   }
}

server.on('MethodNotAllowed', unknownMethodHandler); 
```

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2013-10-06T23:15:04.913

我在我的 restify 基础应用程序上这样做：

```
//setup cors
restify.CORS.ALLOW_HEADERS.push('accept');
restify.CORS.ALLOW_HEADERS.push('sid');
restify.CORS.ALLOW_HEADERS.push('lang');
restify.CORS.ALLOW_HEADERS.push('origin');
restify.CORS.ALLOW_HEADERS.push('withcredentials');
restify.CORS.ALLOW_HEADERS.push('x-requested-with');
server.use(restify.CORS()); 
```

您需要先使用restify.CORS.ALLOW_HEADERS.push 方法将您想要的标头推送到restify，然后使用CORS 中间件来启动CORS 功能。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2017-11-20T23:01:41.187

以前的大多数答案都来自 2013 年，并且使用了已弃用的示例！解决方案（至少在 2017 年）如下：

```
npm install restify-cors-middleware 
```

然后在您的服务器 javascript 文件中：

```
var corsMiddleware = require('restify-cors-middleware');

var cors = corsMiddleware({
  preflightMaxAge: 5,
  origins: ['*']
});

var server = restify.createServer();

server.pre(cors.preflight);
server.use(cors.actual); 
```

并添加任何其他适合您的选项。我的用例是创建一个 localhost 代理来解决开发过程中的浏览器 CORS 问题。仅供参考，我使用 restify 作为我的服务器，但是我从服务器（以及到服务器）的 POST 与 Axios 一起使用。我的偏好在那里。

[restify-cors-middleware 的 npm 列表](https://www.npmjs.com/package/restify-cors-middleware)

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-05-28T17:43:47.650

这在我的情况下就足够了：

```
var server = restify.createServer();
server.use(restify.fullResponse());
server.get('/foo',  respond(req, res, next) {
   res.send('bar');
   next();
}); 
```

没有必要`server.use(restify.CORS());` 另外，似乎`server.use()`调用必须在`server.get()`调用之前才能工作。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2019-01-19T10:57:52.160

这对我有用restify 7

```
server.pre((req, res, next) => {

    res.header('Access-Control-Allow-Origin', req.header('origin'));
    res.header('Access-Control-Allow-Headers', req.header('Access-Control-Request-Headers'));
    res.header('Access-Control-Allow-Credentials', 'true');
    // other headers go here..

    if(req.method === 'OPTIONS') // if is preflight(OPTIONS) then response status 204(NO CONTENT)
        return res.send(204);

    next();

}); 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-03-20T01:23:39.137

我正在使用 Restify 7.2.3 版本，这段代码非常适合我。您需要安装 restify-cors-middleware 插件。

```
const corsMiddleware = require('restify-cors-middleware')

const cors = corsMiddleware({
    preflightMaxAge: 5, //Optional
    origins: ['http://ronnie.botsnbytes.com', 'http://web.myapp.com'],
    allowHeaders: ['API-Token'],
    exposeHeaders: ['API-Token-Expiry']
})

server.pre(cors.preflight)
server.use(cors.actual) 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2018-12-28T09:13:11.800

```
 const cors = require('cors');

   const server = restify.createServer();

   server.use(cors()); 
```

这对我有用

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2019-05-10T11:56:46.917

```
const restify = require('restify');
const corsMiddleware = require('restify-cors-middleware');

const cors = corsMiddleware({
  origins: ['*']
});

const server = restify.createServer();
server.pre(cors.preflight);
server.use(cors.actual);

server.get('/api/products', (request, response) => {
  response.json({ message: 'hello REST API' });
});

server.listen(3000, () => console.info(`port 3000`)); 
```

... 是一种蛮力解决方案，尽管您应该非常小心地这样做。

# batch-file - 在脚本之间通过引用传递参数

> ID：14338691
> 
> 赞同：2
> 
> 时间：2013-01-15T13:21:36.000
> 
> 标签：batch-file, cmd

[http://ss64.com/nt/syntax-args.html](http://ss64.com/nt/syntax-args.html)中的文章“通过引用传递”提到以下内容：

> 除了在命令行上传递数字或字符串值外，还可以传递一个变量名，然后使用该变量在脚本或子程序之间传输数据。

但是我该怎么做呢？当我设置变量的值并传递它的名称时

```
set parm=42
call sub.bat parm 
```

我如何使用它`sub.bat`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T14:04:53.387

通过延迟扩展

```
@echo off
setlocal
set var1=value1
set var2=value2
call :sub var1
call :sub var2
exit /b

:sub
setlocal enableDelayedExpansion
echo %~1=!%~1!
exit /b 
```

- 输出 -

```
var1=value1
var2=value2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:28:48.757

Reference them by name, 2.bat run from 1.bat will inherit the same environment block, so

1.BAT

```
set parm=42
echo parm is '%parm%'
call 2.bat
echo parm is '%parm%' 
```

2.BAT

```
set parm=XXX%parm%XXX 
```

Would print:

```
parm is '42'
parm is 'XXX42XXX' 
```

(Using `call sub.bat %parm%` would make a copy of `parm` available to sub.bat in `%1`)

# asp.net-mvc - ASP.NET MVC、Knockout、Web API - 格式问题

> ID：14338695
> 
> 赞同：1
> 
> 时间：2013-01-15T13:21:45.633
> 
> 标签：asp.net-mvc, rest, asp.net-mvc-4, knockout.js, asp.net-web-api

我正在使用 ASP.NET MVC / WebAPI 和 Knockout 来生成我的视图。我试图弄清楚我应该在哪里处理格式化、url 生成等（我通常会在我的控制器中执行并返回一个视图模型）。

让我的 WebAPI 返回带有预格式化数据的视图模型是一种好的做法，还是应该把它留给调用者？

请注意 API 仅由我的应用程序使用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T00:08:31.150

我的建议如下：

*   WebApi 控制器动作提供/消费数据（json 数据） - Http 动词动作

*   在您的淘汰视图模型上，它包含获取/保存等 json 数据的方法，这些数据在准备好填充数据的文档上调用

*   默认标记由控制器在初始加载时返回的 MVC 视图创建，然后可以动态完成任何进一步的操作（内联或模板；本机或淘汰赛）

在我看来，WebApi 不应该返回完整的视图模型。它应该只返回视图模型使用的数据。api 点不应该是特定于实现的，并且允许淘汰消耗以及任何其他客户端。

高温高压

# cxf - CXF2.7.2 + Weblogic 12c + Java 1.7

> ID：14338720
> 
> 赞同：3
> 
> 时间：2013-01-15T13:23:21.100
> 
> 标签：cxf, java-7, weblogic12c, wss4j, xmlsec

运行**Weblogic 12c的****CXF**应用程序存在问题。例外情况如下：

 **```
org.apache.jcp.xml.dsig.internal.dom.DOMXMLSignatureFactory cannot be cast to javax.xml.crypto.dsig.XMLSignatureFactory 
```

这里有趣的是**DOMXMLSignatureFactory**扩展了**XMLSignatureFactory**。我试过调试，没有找到原因。**XMLSec-1.5.3**代码在以下行失败： `XMLSignatureFactory fac = (XMLSignatureFactory)ps.newInstance(null);`

```
private static XMLSignatureFactory findInstance(String mechanismType,
    Provider provider) {

    if (provider == null) {
        provider = getProvider("XMLSignatureFactory", mechanismType);
    }
    Provider.Service ps = provider.getService("XMLSignatureFactory",
                                              mechanismType);
    if (ps == null) {
        throw new NoSuchMechanismException("Cannot find " + mechanismType +
                                           " mechanism type");
    }
    try {
        XMLSignatureFactory fac = (XMLSignatureFactory)ps.newInstance(null);
        fac.mechanismType = mechanismType;
        fac.provider = provider;
        return fac;
    } catch (NoSuchAlgorithmException nsae) {
        throw new NoSuchMechanismException("Cannot find " + mechanismType +
                                           " mechanism type", nsae);
    }
} 
```

实例化类“ **org.apache.jcp.xml.dsig.internal.dom.DOMXMLSignatureFactory** ”有声明：

```
public final class DOMXMLSignatureFactory extends XMLSignatureFactory {
...
} 
```

**有任何想法吗？**

完整的堆栈跟踪：

```
 org.apache.cxf.interceptor.Fault: org.apache.jcp.xml.dsig.internal.dom.DOMXMLSignatureFactory cannot be cast to javax.xml.crypto.dsig
.XMLSignatureFactory
        at org.apache.cxf.ws.security.wss4j.policyhandlers.AsymmetricBindingHandler.doSignBeforeEncrypt(AsymmetricBindingHandler.java
:195)
        at org.apache.cxf.ws.security.wss4j.policyhandlers.AsymmetricBindingHandler.handleBinding(AsymmetricBindingHandler.java:98)
        at org.apache.cxf.ws.security.wss4j.PolicyBasedWSS4JOutInterceptor$PolicyBasedWSS4JOutInterceptorInternal.handleMessage(Polic
yBasedWSS4JOutInterceptor.java:165)
        at org.apache.cxf.ws.security.wss4j.PolicyBasedWSS4JOutInterceptor$PolicyBasedWSS4JOutInterceptorInternal.handleMessage(Polic
yBasedWSS4JOutInterceptor.java:89)
        at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:271)
        at org.apache.cxf.endpoint.ClientImpl.doInvoke(ClientImpl.java:530)
        at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:463)
        at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:366)
        at org.apache.cxf.endpoint.ClientImpl.invoke(ClientImpl.java:319)
        at org.apache.cxf.frontend.ClientProxy.invokeSync(ClientProxy.java:96)
        at org.apache.cxf.jaxws.JaxWsClientProxy.invoke(JaxWsClientProxy.java:133)
        at $Proxy197.getProcessingEventDetails(Unknown Source)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at com.paradase.top.green.hill.client.MiraclesPosterServlet.doPost(MiraclesPosterServlet.java:666)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:751)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:844)
        at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:242)
        at weblogic.servlet.internal.StubSecurityHelper$ServletServiceAction.run(StubSecurityHelper.java:216)
        at weblogic.servlet.internal.StubSecurityHelper.invokeServlet(StubSecurityHelper.java:132)
        at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:338)
        at weblogic.servlet.internal.ServletStubImpl.execute(ServletStubImpl.java:221)
        at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.wrapRun(WebAppServletContext.java:3284)
        at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3254)
        at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)
        at weblogic.security.service.SecurityManager.runAs(SecurityManager.java:120)
        at weblogic.servlet.provider.WlsSubjectHandle.run(WlsSubjectHandle.java:57)
        at weblogic.servlet.internal.WebAppServletContext.doSecuredExecute(WebAppServletContext.java:2163)
        at weblogic.servlet.internal.WebAppServletContext.securedExecute(WebAppServletContext.java:2089)
        at weblogic.servlet.internal.WebAppServletContext.execute(WebAppServletContext.java:2074)
        at weblogic.servlet.internal.ServletRequestImpl.run(ServletRequestImpl.java:1513)
        at weblogic.servlet.provider.ContainerSupportProviderImpl$WlsRequestExecutor.run(ContainerSupportProviderImpl.java:254)
        at weblogic.work.ExecuteThread.execute(ExecuteThread.java:256)
        at weblogic.work.ExecuteThread.run(ExecuteThread.java:221)
Caused by: java.lang.ClassCastException: org.apache.jcp.xml.dsig.internal.dom.DOMXMLSignatureFactory cannot be cast to javax.xml.cryp
to.dsig.XMLSignatureFactory
        at javax.xml.crypto.dsig.XMLSignatureFactory.findInstance(XMLSignatureFactory.java:202)
        at javax.xml.crypto.dsig.XMLSignatureFactory.getInstance(XMLSignatureFactory.java:292)
        at org.apache.ws.security.message.WSSecSignature.init(WSSecSignature.java:126)
        at org.apache.ws.security.message.WSSecSignature.<init>(WSSecSignature.java:119)
        at org.apache.cxf.ws.security.wss4j.policyhandlers.AbstractBindingBuilder.getSignatureBuilder(AbstractBindingBuilder.java:172
3)
        at org.apache.cxf.ws.security.wss4j.policyhandlers.AsymmetricBindingHandler.doSignature(AsymmetricBindingHandler.java:546)
        at org.apache.cxf.ws.security.wss4j.policyhandlers.AsymmetricBindingHandler.doSignBeforeEncrypt(AsymmetricBindingHandler.java
:147)
        ... 35 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T16:45:00.967

CXF 使用 WSS4J 和 wss4j 版本 1.6.7 有这个 bug。您可以尝试升级到 wss4j 1.6.9 吗？CXF 2.7.3 可能会帮您解决这个问题。此更新解决了我在 ServiceMix 4.5.0 中运行的问题。**

# android - Android：在电子邮件中将多个文件作为附件发送

> ID：14338722
> 
> 赞同：0
> 
> 时间：2013-01-15T13:23:31.887
> 
> 标签：android, email

> **可能重复：**
> [使用 Intent 的 Android 多个电子邮件附件](https://stackoverflow.com/questions/2264622/android-multiple-email-attachments-using-intent)

我已经知道可能有类似的问题，因为我从一个答案中得到了我当前的代码。但我面临一些问题，最初我认为它是 gmail 应用程序，但后来我尝试使用其他电子邮件客户端和同样的问题。 **代码： -**

```
ArrayList<Uri> uris = null;
        try {
            uris = logger.getSiteFilePaths(siteIndex);
        } catch (BaseLoggerException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        Intent emailIntent = new   Intent(android.content.Intent.ACTION_SEND_MULTIPLE);
        emailIntent.setType("application/octet-stream");
        emailIntent.addFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION); 
        emailIntent.putExtra(Intent.EXTRA_EMAIL,"");
        emailIntent.putExtra(Intent.EXTRA_SUBJECT, "Bl\u00fc-Test Log");
        emailIntent.putExtra(Intent.EXTRA_TEXT, "Please find the attachments.");
        emailIntent.putParcelableArrayListExtra(Intent.EXTRA_STREAM, uris);
        startActivity(Intent.createChooser(emailIntent, "Email:")); 
```

文件路径准确

```
**e.g. --** file:///storage/sdcard0/BAPISandy_test1.csv 
```

问题：- 在 Gmail 应用程序中似乎附加了文件，但是当您发送电子邮件时，它在通知栏中显示“无法显示附件”。如果尝试使用其他电子邮件客户端，它不会将文件显示为附件。 **系统信息：--** 三星 Galaxy Tab 2 (7 inch) Android 4.1.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:28:12.807

对不起，很难找到像`"/"`文件路径中丢失这样的小错误，这实际上会导致问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-23T20:19:50.663

今天我的 Note 2 和一位拥有 SG3 的客户也犯了这个错误。我做了一些挖掘，发现了以下内容。

如果我请求外部存储设备名称 - *Environment.getExternalStorageDirectory().getName()*（我使用它，因为我的目标是版本 7） - 我得到'sdcard0'，如果我添加我的文件名并将其传递给电子邮件或 gmail那么任何人都不会添加附件。如果我手动编辑“sdcard0”末尾的零并传递“sdcard”+我的文件名，那么一切正常。在 JB 之前，这似乎都不是问题，或者如果我在始终返回“sdcard”的模拟器中的 JB 下运行此代码。

我不确定是否应该使用不同的代码，或者这是否是操作系统报告路径和电子邮件系统使用它的方式不一致。（我原以为 sdcard0 应该指向与 sdcard 相同的位置 - 但有些东西不起作用）

我可能只是修补我的代码以去除零（我知道这是丑陋和危险的）。除非其他人有任何好主意:)

编辑：我在下面添加了我的代码，以防其他人发现它有用。

```
 // try and grab the log file

            String logFile = File.separator + getResources().getString(R.string.app_name) + File.separator + "logs" + File.separator + Constants.SMS_FILE;
            String extStorage = Environment.getExternalStorageDirectory().getName();

            // The following is a kludge for the Samsung (and maybe more) JB devices that don't allow you to add a file with the SDCARD0 external storage
            // link

            File nf = new File(extStorage, logFile);
            if (!nf.exists()) {
                // OK we can't find the file - say so and see if we are hiding behind SDCARD0

                Log.w(getLocalClassName() + ".shouldOverrideUrlLoading", "File: " + extStorage + logFile + " Doesn't exist - trying again");
                if (extStorage.matches("(?i)SDCARD(?-i)[0-9]")) {
                    // OK we've got a SDCARDx scenario - let's see if the file exists without the x
                    String extStorageFix = extStorage.replaceFirst("(?i)SDCARD(?-i)[0-9]", extStorage.substring(0, 6)); // try it without the 0,1,2 etc
                    nf = new File(extStorageFix, logFile);
                    if (!nf.exists()) {
                        // OK we're in the pooh now - can't find the log file so just say so and try to exit without attaching it.
                        Log.w(getLocalClassName() + ".shouldOverrideUrlLoading", "File: " + extStorageFix + logFile + " Doesn't exist either - giving up");
                        Toast.makeText(
                                getApplicationContext(),
                                "Unable to attach Log file from\n" + extStorage + logFile + "\n" + extStorageFix + logFile
                                        + "\nPlease add it manually if possible", Toast.LENGTH_LONG).show();
                    } else {
                        // Hurrah we found it - remember we did so and carry on
                        extStorage = extStorageFix;
                        Log.w(getLocalClassName() + ".shouldOverrideUrlLoading", "Found logfile at: " + extStorage + logFile);
                    }
                }

            }

            if (Debug.ON) {
                Log.d(getLocalClassName() + ".shouldOverrideUrlLoading", "Filepath = " + "file://" + File.separator + extStorage + logFile);
            }
            i.putExtra(Intent.EXTRA_STREAM, Uri.parse("file://" + File.separator + extStorage + logFile));**strong text** 
```

# php - 从经典 ASP 页面调用 PHP+CURL 函数

> ID：14338723
> 
> 赞同：0
> 
> 时间：2013-01-15T13:23:31.950
> 
> 标签：php, curl, asp-classic, xmlhttprequest

我有一个捕获“HTTP 301”响应的 php + curl 函数。该页面名为 get_header.php，位于文件夹 /exe 中：

```
function getheader($url)
// Use curl to fetch the HTTP Headers
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_HEADER, 1); // just the header
curl_setopt($ch, CURLOPT_NOBODY, 1); // not the body
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$output = curl_exec($ch);
preg_match('/Location: (.*)\n/', $output, $matches);
// if no redirect header then return the original url
return isset($matches[1]) ? $matches[1] : $url;
}
echo(getheader($_GET['url'])); 
```

但是，我需要在经典的 asp 页面中使用这个脚本。我试图通过 HTTP 调用它：

```
Dim x: Set x = CreateObject("MSXML2.ServerXMLHTTP")     
Dim y: y = "http://mysite.com/exe/get_header.php?url=" & url
x.Open "GET", y, false 
x.Send()
Dim z: z = x.ResponseText 
```

尽管它有效，但这并不是理想的解决方案，因为两个页面都在同一个域中。事实上，它已经导致请求变慢。那么我该如何解决这个问题呢？理想的解决方案是我的 PHP 函数的 vbscript 或 javascript 版本。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T12:03:18.640

这是解决方案：

```
Dim x: Set x = CreateObject("WinHttp.WinHttpRequest.5.1")
x.Option(6) = False
x.Open "GET", url, false
x.Send()
If x.status = 301 Then
Dim z: z = x.getResponseHeader("Location")
End If 
```

感谢 FAngel 的回复！

# asp.net - theForm.__EVENTVALIDATION

> ID：14338724
> 
> 赞同：0
> 
> 时间：2013-01-15T13:23:37.087
> 
> 标签：asp.net, forms

```
theForm.__EVENTVALIDATION.value 
```

我明白了：这是什么意思？以及如何编码？

```
"jSp677t39HyhECAmULmdU/ya3EVJgkk8dokDchVgxoH1wOfuygSJwIY8Nxw+5+Le3r3JZ49UYhuxPKvdaGyMv1JyCPLXT0tWnpJryLqScc8a5QCNfiRu5ufIEjsqOCKdGMFTd33wdI3QJM2+ElSwe9V7K/8HiEXBYwvR/bXh8Xvrtkh8XspsxF0ADYMnzWTlUvk0ODQRofXwlYcAfUZ4wuzjG+X1b2G4mjON1zYPO6c4TGlofRap39VyxZ6RX2pBYLtcwahOUo6nX4zD7ICJeSu4mkIoo/W5eW9qWRClbEWgA6NZs/dyTlT/TB9q7xtx/ghBfogHOddtsOWQxSQzyFcz0xYLOKdtqbf6uzpwgBz3vBsbevNoXwG0KIjCz+fxW8yaEzpcywZBAxJV4vzXRLFu39Mti5PHXpGJ0C7iEQ7Vc2Ema9sNNF1wpCzdc0j50+tXhw==" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T17:14:06.030

事件验证功能旨在最大程度地降低攻击者篡改回传到服务器的值的风险。可以在[http://msdn.microsoft.com/en-us/library/system.web.ui.page.enableeventvalidation.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.page.enableeventvalidation.aspx)找到该功能的简要说明。[如果您搜索http://www.bing.com/search?q=event+validation](http://www.bing.com/search?q=event+validation)，会有很多关于此功能的博客文章。

至于字段值，它是一个不透明的字符串。它并不意味着可以被应用程序破译。

# java - 来自 json 或 xml 字符串的对象构造函数

> ID：14338726
> 
> 赞同：0
> 
> 时间：2013-01-15T13:23:43.673
> 
> 标签：java, xml, json, constructor

我正在开发一种随处可见 json 的服务。但是，我使用的提供程序之一`XML`用作序列化格式，因此我希望能够使用相同的接口进行解析（和吐出）`JSON`。`XML`

问题是，我不知道`XML`可以让我轻松覆盖构造函数的类型或对象。希望澄清我的观点，这里有一些代码：

```
public class JsonData {
    private Hashtable<String, Variant> map = new Hashtable<String, Variant>();

    public JsonData() {
    }

    public JsonData(String jsonString) {
        this.deserialize(jsonString);
    } 
```

理想情况下，我希望第三个构造函数执行以下操作：

```
 public JsonData(XMLString jsonString) {
        this.xmldeserialize(jsonString);
    } 
```

请注意两个相关的构造函数如何将纯字符串作为参数。

任何指针？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:29:58.197

您可以使用静态方法从 json 或 xml 字符串创建对象：

```
public static JsonData fromJson(String json) {
    JsonData data = new JsonData();
    data.deserializeJson(json);
    return data;
}

public static JsonData fromXml(String xml) {
    JsonData data = new JsonData();
    data.deserializeXml(xml);
    return data;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:38:11.087

您不能只检查输入是 json 还是 xml（使用正则表达式）并调用适当的方法进行反序列化。像

```
public JsonData(String jsonString) {
   if(isValidJson(jsonString){
        this.deserialize(jsonString);
   } else {
        this.xmldeserialize(jsonString);
   }
} 
```

# asp.net - asp.net 实体框架 - 加入 + 会员用户的复杂查询

> ID：14338727
> 
> 赞同：0
> 
> 时间：2013-01-15T13:23:45.450
> 
> 标签：asp.net, sql, entity-framework

我有 2 张桌子。用户 - 拥有 userID、userMainGroup 和 userMinorGroup 任务 - TaskId、UserId

我的目标是：我有当前的 CurrentuserId，我想向他展示由与他相同的 MainGroup 的用户创建的所有任务。

在 SQL 中，我会写：

```
Select *
From Tasks Left join Users on tasks.Id=users.id
Where users.MainGroup=CurrentuserMainGroup; (var) 
```

我如何使用实体框架来做到这一点？

我知道要加入，我需要编写如下内容：

```
var tasks = from t in db.tasks
            from u in db.users
            where t.Id=u.Id
            select new {t.Id, t.name....} 
```

但是我在哪里将条件放在 MainGroup 上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:03:07.990

建议您使用导航属性而不是手动编码的联接：

```
from t in db.Tasks
where t.User.MainGroup == currentuserMainGroup
select new {t.Id, t.name.... , t.User.Name, ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:35:08.267

你可以试试这样

```
var data= (from con in db.tasks
          let UserMainGroup = db.users.where(x=>x.id==con.id).FirstOrDefault()
          where  UserMainGroup.MainGroup=CurrentuserMainGroup
          select new {
          ID=con.id,
          Name=con.name
          }).ToList(); 
```

我想这会对你有所帮助.......

# php - joomla 2.5 独立 php JText::_() 不工作

> ID：14338730
> 
> 赞同：1
> 
> 时间：2013-01-15T13:24:03.267
> 
> 标签：php, joomla, module

我有一个生成图像的独立文件，我包含了 joomla 框架。此文件在页面上显示为图像。$_SESSION 为空并且 getUser 返回 NULL。JText 不知道要加载什么 module.language 文件以及用户的默认语言是什么。如何访问此信息/对象？

我的代码：

```
//define constant
define( '_JEXEC', 1 );
define( 'DS', DIRECTORY_SEPARATOR ); 

//joomla installation
define( 'JPATH_BASE', '../..' );

//include joomla core files
require_once( JPATH_BASE . DS . 'includes' . DS . 'defines.php' );
require_once( JPATH_BASE . DS . 'includes' . DS . 'framework.php' );
require_once( JPATH_BASE . DS . 'libraries' . DS . 'joomla' . DS . 'factory.php' );

$echo = JText::_("MOD_MYMODULE_TEXT");

header("Content-type: image/png");
Graph::render($echo); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T09:33:07.313

用这个：

```
$lang =& JFactory::getLanguage();
$lang->load('mod_sample',JPATH_ROOT,'fa-IR'); 
```

或起诉这个，自动检测语言：

```
$mainframe =& JFactory::getApplication('site');
$mainframe->initialise();

$lang =& JFactory::getLanguage();
$lang->load('mod_sample',JPATH_ROOT); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-17T08:21:00.047

If you have been working with a component and have been using `JText::` successfully, and recently you have created a plugin and to your surprise the `JText::` class is not working, then please read below.

The Plugin uses its own language files. To load a language file automatically based on system language in `Joomla! 3.x` you need to use the following code.

```
$this->loadLanguage('', JPATH_BASE); 
```

Furthermore you shall need to have a language file with the name based on the plugin name as follows.

```
<Language>.plg_<Plugin Type>_<Plugin name>.ini 
```

So lets say your plugin name is `coolblue` and you are writing for the English (`en-GB`) language, and this plugin is of type `authentication`. So your file name would be ..

```
en-GB.plg_authentication_coolblue.ini 
```

And you can store the language strings there. And `Joomla!` will load your language files for you, no need to discreetly specify any language or file.

# javascript - 从外部源加载 javascript 资源，当它被 403 状态阻止时

> ID：14338731
> 
> 赞同：1
> 
> 时间：2013-01-15T13:24:06.517
> 
> 标签：javascript, download, greasemonkey, userscripts

由于某种原因，我的 ISP 阻止了以下 URL：

```
http://assets.tumblr.com/javascript/prototype_and_effects.js 
```

Chrome 控制台状态：

```
Failed to load resource: the server responded with a status of 403 (URLBlocked) 
```

结果是我无法正确使用*Tumblr*，因为许多功能都依赖于这个脚本。我已经联系了我的 ISP 并要求他们停止阻止此 URL，但同时我想对此做点什么。

如何从外部加载此资源？它可以是书签解决方案、用户脚本/Greasemonkey 或任何其他你能想到的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T20:08:08.540

[403 状态](http://en.wikipedia.org/wiki/List_of_HTTP_status_codes#403)意味着*服务器*(assets.tumblr.com) 阻止了请求，而不是您的 ISP。服务器这样做的最常见原因是（a）因为您没有以足够的访问权限登录，和/或（b）服务器没有收到它想要的引荐来源标头和/或 cookie，和/或（c ) 请求来自服务器已列入黑名单的 IP 地址。使用代理服务器可以为某些站点触发任何或所有这些。

这意味着，如果您或您的代理服务器被阻止访问该文件，那么用户脚本将使用的注入远程 javascript 的标准方法也将被阻止。

为了解决这个问题，**Greasemonkey 可以从本地副本回填 javascript 文件**。去做这个：

1.  创建文件，`Insure Tumbler has prototype.user.js`，如下所示。将它放在不在`temp`您机器上的文件夹中的目录中。
2.  下载您引用[的`prototype_and_effects.js`文件](http://assets.tumblr.com/javascript/prototype_and_effects.js)并将其放在同一文件夹中。您可能必须使用不同的（或不使用代理）或不同的浏览器配置文件，或其他任何东西。（对我来说，它下载得很好，只需右键单击前面的链接。）
3.  使用 Greasemonkey 安装脚本。（Firefox：*文件*->*打开*( `Ctrl``O`) 将起作用。）
4.  该脚本测试`Prototype`和`Effect`库，如果缺少一个，则在本地加载它们。*让 Tumblr 再次工作可能*需要更多，但如果是这样，那超出了这个问题的范围。
5.  在 Firefox+Greasemonkey 中工作。应该在 Chrome+Tampermonkey 中工作（未测试），*在*不支持的地方`@resource`不起作用，例如直接 Chrome。

```
// ==UserScript==
// @name     _Backfill Prototype and Effect libraries on Tumblr pages
// @match    http://tumblr.com/*
// @match    http://www.tumblr.com/*
// @match    https://tumblr.com/*
// @match    https://www.tumblr.com/*
// @resource PandE_src  prototype_and_effects.js
// @grant    GM_getResourceText
// ==/UserScript==

//-- Does this page load prototype_and_effects.js?
var protoScriptNode = document.querySelector ("script[src*='prototype_and_effects']");
if (protoScriptNode) {
    //console.log ("Page uses prototype_and_effects.js.");

    //-- Are Prototype and Effects loaded?
    var P   = unsafeWindow.Prototype;
    var E   = unsafeWindow.Effect;
    if (P  &&  P.Version  &&  E  &&  E.BlindDown) {
        //console.log ("Everything's loaded, no action needed.");
    }
    else {
        //console.log ("Loading prototype_and_effects.js");
        var PandE_src           = GM_getResourceText ("PandE_src");
        var scriptNode          = document.createElement ('script');
        scriptNode.type         = "text/javascript";
        scriptNode.textContent  = PandE_src;
        var targ                = document.getElementsByTagName ('head')[0];
        targ.appendChild (scriptNode);
    }
}
else {
    //-- No action needed
    //console.log ("Page doesn't use prototype_and_effects.js.");
} 
```

# c++ - 是否可以在 C++ 中实现无锁映射

> ID：14338732
> 
> 赞同：22
> 
> 时间：2013-01-15T13:24:11.153
> 
> 标签：c++, algorithm, dictionary, lock-free

我们正在开发基于 C/S 的网络应用程序，我们发现添加到 std::map 的锁太多，导致服务器性能变差。

我想知道是否可以实现无锁地图，如果可以，如何实现？那里有开源代码吗？

编辑：实际上我们使用 std::map 来存储套接字信息，我们根据套接字文件描述进行了封装，以包含一些其他必要的信息，例如 ip 地址、端口、套接字类型、tcp 或 udp 等。

总而言之，我们有一张全球地图说

```
map<int fileDescriptor, socketInfor*> SocketsMap, 
```

那么每个用于发送数据的线程都需要访问 SocketsMap，并且在从 SocketsMap 读取或写入 SocketsMap 之前必须添加互斥锁，这样会因为 SocketsMap 中添加的锁而大大降低整个应用程序的并发度。

为了避免并发级别的问题，我们有两种解决方案： 1\. 分别存储每个 socketInfor* 2\. 使用某种无锁映射。

我想找一些无锁的地图，因为这个解决方案所需的代码更改比解决方案1要少得多。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-15T13:32:34.147

实际上有一种方法，虽然我自己没有实现它，但有一篇关于无[锁地图的论文使用](http://erdani.com/publications/cuj-2004-12.pdf)著名 C++ 专家 Andrei Alexandrescu 的危险指针。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-10-28T21:50:03.463

是的，我已经使用“拆分有序列表”概念在 C++ 中实现了无[锁无序映射](https://github.com/Qarterd/Honeycomb/blob/master/src/common/Honey/Thread/LockFree/UnorderedMap.h)( [docs )。](https://qarterd.github.io/Honeycomb/Doxygen/html/classhoney_1_1lockfree_1_1_unordered_map.html)它是一个自动扩展容器，支持 64 位 CAS 上的数百万个元素，没有 ABA 问题。在性能方面，它是一头[野兽](http://www.cs.nyu.edu/~lerner/spring11/proj_splitoredered.pdf)（参见第 5 页）。它已经过数百万随机操作的[广泛测试](https://github.com/Qarterd/Honeycomb/blob/master/test/Test.cpp#L215)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T14:31:52.817

HashMap 会适合吗？看看[Intel Threading Building Blocks](http://threadingbuildingblocks.org/)，他们有一个有趣的并发映射。我不确定它是无锁的，但希望您对良好的多线程性能感兴趣，而不是特别对无锁感兴趣。你也可以检查[CityHash](http://code.google.com/p/cityhash/) lib

编辑：

实际上 TBB 的哈希映射不是无锁的

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-12-24T08:45:20.160

如果你使用 C++11，你可以看看[facebook/folly的 AtomicHashMap](http://github.com/facebook/folly)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-15T14:09:48.190

**[您可以使用乐观设计](http://en.wikipedia.org/wiki/Optimistic_concurrency_control)或[事务性内存](http://en.wikipedia.org/wiki/Transactional_memory)**来实现映射。

如果两个操作同时处理映射并且一个正在更改映射结构的机会相对较小，则此方法特别有效 - 并且您不希望每次都锁定开销。

但是，有时会发生碰撞，您将不得不以某种方式导致它（通常通过回滚到最后一个稳定状态并重试操作）。

如果您的硬件支持足够好的原子操作 - 这可以通过[比较和交换 (CAS)](http://en.wikipedia.org/wiki/Compare-and-swap)轻松完成- 您可以单独更改参考（并且无论何时更改地图，您都在使用地图的副本，而不是原始地图，并仅在您提交时将其设置为主要）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-11-30T00:06:40.603

我很惊讶没有人提到它，但是 Click Cliff 已经[在 J​​ava 中实现了一个无需等待的哈希映射](https://github.com/boundary/high-scale-lib/blob/master/src/main/java/org/cliffc/high_scale_lib/NonBlockingHashMap.java)，我相信它可以移植到 C++，

# carrierwave - 如何使用 CarrierWave def 文件名

> ID：14338734
> 
> 赞同：1
> 
> 时间：2013-01-15T13:24:15.103
> 
> 标签：carrierwave

我正在使用 CarrierWave gem 上传图像。问题是，如果有人在浏览器中打开网络终端，他们可以很容易地找到图像的名称。所以我只想通过在部署到服务器时重命名图像文件来避免它。所以我可以使用文件名。但问题就在这里。“文件名”方法根本没有在我的代码中执行。这是我的上传文件。

```
def store_dir
    "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
  end

  # Provide a default URL as a default if there hasn't been a file uploaded:
  # def default_url
  #   "/images/fallback/" + [version_name, "default.png"].compact.join('_')
  # end

  # Process files as they are uploaded:
  # process :scale => [200, 300]
  #
  # def scale(width, height)
  #   # do something
  # end

  # Create different versions of your uploaded files:
  version :thumb do
     process :resize_to_limit => [100, 100]
  end

  # Add a white list of extensions which are allowed to be uploaded.
  # For images you might use something like this:
  def extension_white_list
    %w(jpg jpeg gif png)
  end

  # Override the filename of the uploaded files:
  # Avoid using model.id or version_name here, see uploader/store.rb for details.
  # def filename
  #   "something.jpg" if original_filename
  # end
  def filename
    logger.info "*******inside filename method"
  end

end 
```

提前致谢

# c++ - 调试 VS2010 中整数数据类型的可视化工具

> ID：14338735
> 
> 赞同：0
> 
> 时间：2013-01-15T13:24:16.557
> 
> 标签：c++, visual-studio-2010

在我的代码库中，我有几个`long`变量实例来存储日期（自特定日期以来的天数）。

有没有办法在 VS2010 中创建可视化工具，以便在调试时我可以在`long`值旁边获得实际日期？除了基本的东西，我找不到关于可视化工具的太多文档。具体来说：

是否可以为整数类型创建可视化工具？（并保持初始值可见）

是否可以在可视化器中进行一些小计算？（我需要计算一个与我`long`所指的日期相对应的字符串）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:32:08.707

我将为这个结构创建一个可视化器：

```
struct DaysAfter
{
    long mDays;
}; 
```

然后在调试器中将您需要的内容转换为这种类型。

```
*(DaysAfter*)&this->m_date 
```

# c# - 如何将 app.config 文件转换为 XML？

> ID：14338736
> 
> 赞同：1
> 
> 时间：2013-01-15T13:24:17.257
> 
> 标签：c#, parsing, app-config, converter

我使用它从 app.config 文件中获取内容：

```
string content = File.ReadAllLines(
                        AppDomain.CurrentDomain.SetupInformation.ConfigurationFile) 
```

以这种方式解析配置后，如何将`app.config`文件转换为 XML？解析的最佳实践是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:27:03.670

除非你用它做一些特别的事情，否则你不应该直接读取`app.config`文件，而是使用[`ConfigurationManager`](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx)类来读取它。如果您真的想将其读取为 XML，请使用[XmlDocumen.Load()](http://msdn.microsoft.com/it-it/library/875kz807.aspx)函数，但请记住，将配置解析为 XML 文件是一种无意的使用方式。

# c# - 使用 CSharpCodeProvider 进行慢速动态编译

> ID：14338738
> 
> 赞同：2
> 
> 时间：2013-01-15T13:24:18.397
> 
> 标签：c#, .net, performance, csharpcodeprovider

我试图将动态编译与标准编译进行比较。而且动态编译似乎要慢很多。根据我的基准，慢了 1400%。

这是生成调用动态编译代码的委托的方法：

```
public static Function Eval(string sCSCode)
{
    CSharpCodeProvider c = new CSharpCodeProvider();
    ICodeCompiler icc = c.CreateCompiler();
    CompilerParameters cp = new CompilerParameters();

    cp.ReferencedAssemblies.Add("system.dll");

    cp.CompilerOptions = "/optimize";
    //cp.GenerateInMemory = true;
    StringBuilder sb = new StringBuilder("");

    sb.Append("using System;\n");

    sb.Append("namespace CSCodeEvaler{ \n");
    sb.Append("public class CSCodeEvaler{ \n");
    sb.Append("public double sin(double x) { return Math.Sin(x); }");
    sb.Append("public double cos(double x) { return Math.Cos(x); }");
    sb.Append("public double sqrt(double x) { return Math.Sqrt(x); }");
    sb.Append("public const double PI = Math.PI;");
    sb.Append("public double Calculate(double x, double y){\n");
    sb.Append("return " + sCSCode + "; \n");
    sb.Append("} \n");
    sb.Append("} \n");
    sb.Append("}\n");

    CompilerResults cr = icc.CompileAssemblyFromSource(cp, sb.ToString());
    if (cr.Errors.Count > 0)
    {
        throw new Exception("ERROR: " + cr.Errors[0].ErrorText);
        return null;
    }

    System.Reflection.Assembly a = cr.CompiledAssembly;
    object o = a.CreateInstance("CSCodeEvaler.CSCodeEvaler");
    Type t = o.GetType();
    MethodInfo mi = t.GetMethod("Calculate");

    return delegate(double x, double y)
    {
        object[] oParams = new object[2];
        oParams[0] = x;
        oParams[1] = y;
        object s = mi.Invoke(o, oParams);
        return (double)s;
    };
} 
```

这是我为测试其性能而创建的代码：

```
private double f1(double x, double y)
{
    return Math.Sin(x) + Math.Cos(y);
}

private void button1_Click(object sender, EventArgs e)
{
    double sum = 0;
    long t1 = DateTime.Now.Ticks;                
    for (double x = 0; x <= 500; x += 0.1)
    {
        for (double y = 0; y <= 500; y += 0.1)
        {
            sum += f1(x, y);
        }
    }
    t1 = DateTime.Now.Ticks - t1;

    sum = 0;
    var f2 = FunctionConstructor.Eval("Math.Sin(x) + Math.Cos(y)");
    long t2 = DateTime.Now.Ticks;            
    for (double x = 0; x <= 500; x += 0.1)
    {
        for (double y = 0; y <= 500; y += 0.1)
        {
            sum += f2(x, y);
        }
    }
    t2 = DateTime.Now.Ticks - t2;
    long dt = t2 - t1;
    double q = dt / (double)t1;
    MessageBox.Show("WITHOUT dynamic compilation: " + t1 + "\n" + "WITH dynamic compilation: " + t2 + "\n" + "Calculation without dynamic compilation was " + dt + " ticks (" + (q-1)*100 + "%) slower");
} 
```

根据我的测试，动态编译要慢得多。这可以以某种方式解决吗？也许问题出在我进行基准测试的方式上？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:59:58.393

您正在调用一个花费*很少*时间的方法。这使得调用该方法的开销成为影响代码速度的主要因素。动态调用和无法内联方法都是时间杀手。您可以通过在 Calculate 方法中移动内部循环来查看差异。例如：

```
 sb.Append("public double Calculate(double x, double y){\n");
    sb.Append("double sum = 0; for (; y <= 500; y += 0.1) {\n");
    sb.Append("sum += " + sCSCode + ";\n");
    sb.Append("} return sum;\n"); 
```

和

```
 long t2 = DateTime.Now.Ticks;
    for (double x = 0; x <= 500; x += 0.1) {
        sum += f2(x, 0);
    }
    t2 = DateTime.Now.Ticks - t2; 
```

你会看到差异消失了。没有简单的解决方法。问题并不完全在于动态调用代码很慢，而是允许抖动优化器生成最佳机器代码使其速度非常快。这当然是一个功能，而不是一个错误。

# bash - 在 bash 中使用 sed 添加到预定行的末尾

> ID：14338739
> 
> 赞同：1
> 
> 时间：2013-01-15T13:24:25.570
> 
> 标签：bash, sed

我有一个格式为：

```
C 1 1 2
H 2 2 1
C 3 1 2
C 3 3 2
H 2 3 1 
```

我需要在特定行的末尾添加“f”，例如第三行，所以输出将是：

```
C 1 1 2
H 2 2 1
C 3 1 2 f
C 3 3 2
H 2 3 1 
```

从谷歌搜索来看，我似乎需要使用 sed，但我找不到任何关于如何具体执行我想要的示例。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:27:53.873

You are looking for [this article on sed](http://www.grymoire.com/Unix/Sed.html). Specifically, the section on [restricting to a line number](http://www.grymoire.com/Unix/Sed.html#uh-26). An example:

```
sed '3 s/$/f/' < yourFile 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:26:45.780

```
awk 'NR==3{$0=$0" f"}1' your_file 
```

# css - 垂直居中css

> ID：14338743
> 
> 赞同：1
> 
> 时间：2013-01-15T13:24:41.150
> 
> 标签：css, vertical-alignment, centering

给出的代码：

[http://jsfiddle.net/95u9Q/](http://jsfiddle.net/95u9Q/)

```
#wrapper_login {
    position: absolute;
    top: 50%;
    width: 100%;
    height: 1px;
    background: black;
}

#login {
    z-index: 22;
    width: 300px;
    height: 400px;
    margin: -200px auto 0 auto;
    background: #000;
} 
```

居中工作正常！问题是：如果窗口高度低于 400 像素，则完整的 #login 应该是可见且可滚动的。当前滚动条可见，但看不到完整的#login，滚动条只是不包含整个#login。

我认为这是因为绝对位置和负边距顶部，我也不知道如何改进代码，所以它应该以它应该的方式工作。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:28:08.333

Your parent container that is `#wrapper_login` should have a **relative position** instead. and the child container `#login` the position of absolute for this to work seamless across different Resolutions. You could use top and left values for `#login` to set it at the right postion.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:28:12.657

Looks like a job for a media query

```
@media screen and (max-height: 400px) {
 #wrapper_login { position: static; }
 #login { margin: 0 auto; }
} 
```

[http://jsfiddle.net/95u9Q/2/](http://jsfiddle.net/95u9Q/2/)

# hibernate - 休眠查询的条件部分

> ID：14338744
> 
> 赞同：0
> 
> 时间：2013-01-15T13:24:44.373
> 
> 标签：hibernate, hql

这是对复杂查询的简化。

我想检索一个具体的新事件的详细信息（具有已知的传递 idNew）。

问题是我不知道如何告诉休眠 sql 引擎我想检索该记录的字段，这与新文件**是否**有关联文件无关。

我不知道如何用最后一个子句（和 newsWfL​​ocalFiles.idNewsWfL​​ocal = newsWfL​​ocal.idNewsWfL​​ocal）编写 conexion

```
Query query = this.sessionFactory.getCurrentSession().createQuery(
    "select news.idNews, newsWfLocal.title, newsWf.date, newsWfLocalFiles.url" +
    " from News news, NewsWf newsWf, NewsWfLocal newsWfLocal, NewsWfLocalFiles newsWfLocalFiles" +
    " where news.idNews = :idNews" +
    " and newsWf.news.idNews = news.idNews" +
    " and newsWf.idNewsWf = newsWfLocal.idNewsWf" +
    " and newsWfLocal.idLocal = 1" +
    " and newsWfLocalFiles.idNewsWfLocal = newsWfLocal.idNewsWfLocal"); 
```

我想关键是正确地构建**表单**句子，但我不知道该怎么做。

这些是表之间的关系：

新闻一对多 NewsWf

新闻Wf 一对多 新闻WfLocal

新闻WfLocal 一对一新闻WfLocalFiles

使用下一个表单子句，我觉得我接近解决方案，但检索到的“localFile”仍然为空，尽管在该字段不为空的情况下：

```
from News news join news.newsWfs newsWfs join newsWfs.newsWfsLocal newsWfsLocal left outer join newsWfsLocal.newsWfLocalFiles newsWfLocalFiles 
```

这里是一对一映射的详细信息：

在**NewsWfL​​ocal.xml**中：

```
<one-to-one name="newsWfLocalFiles" class="com.sample.mdl.NewsWfLocalFiles" fetch="select" lazy="false" ></one-to-one> 
```

在**NewsWfL​​ocalFiles.xml**中：

```
<one-to-one name="newsWfLocal" class="com.sample.mdl.NewsWfLocal" fetch="select" lazy="false"></one-to-one> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:58:11.817

你不需要完全写出你的 SQL，hibernate 会为你生成它。

我正在对您的实体进行一些假设，但这可能很简单，例如：

```
Query query = session.createQuery("select news from News news "
           +"join news.wf wf "
           +"where news.id=:id and wf.local=:local")
query.setParameter("id",id);
query.setParameter("local", local);
List list = query.list();
for(News news: list)
{
    if(!news.getWf().getLocal().getFiles().isEmpty())
    {

    }
} 
```

在休眠中，连接只能使用在您的实体中定义的多对一/一对一/一对多关联，例如

```
Query query = session.createQuery("select news from News news "
           +"join news.wf wf "
           +"join wf.local local "
           +"join local.files file ") 
```

对于一对一和多对一，甚至隐式地进行连接。

```
Query query = session.createQuery("select news from News news "
           +"where news.id=:id and news.wf.local.id=:idLocal ") 
```

这将隐式连接三个表。这不适用于一对多，但是，`news.wf.local.files.name=...`因为 local.files 是一对多的，所以会产生错误（自休眠 3.3 起）。

见[http://docs.jboss.org/hibernate/orm/3.5/reference/en/html/queryhql.html#queryhql-joins](http://docs.jboss.org/hibernate/orm/3.5/reference/en/html/queryhql.html#queryhql-joins)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T09:30:12.117

我发现这是一个与休眠处理**一对一/零**映射的方式有关的问题。

在 Google 中发现的一些棘手技术对我不起作用。

将一对一/零（在 NewsWfL​​ocal 和 NewsWfL​​ocalFiles 之间）映射更改**为一对多**关系可以解决问题。

对于没有关联文件的 newsWfsLocal 实例，仍然需要**左外连接：**

```
from News news join news.newsWfs newsWfs join newsWfs.newsWfsLocal newsWfsLocal left outer join newsWfsLocal.newsWfLocalFiles newsWfLocalFiles 
```

# c# - 使用 htmlagilitypack 提取所有 iframe 标记

> ID：14338745
> 
> 赞同：1
> 
> 时间：2013-01-15T13:24:45.620
> 
> 标签：c#, html, html-agility-pack

我正在使用 htmlagilitypack 来提取几个 html-tags。继承人我做什么：

```
 HtmlDoc = new HtmlDocument();
        StringReader sr = new StringReader(decodedHTML);
        HtmlDoc.Load(sr);
        sr.close();
        var anchor_tags = HtmlDoc.DocumentNode.SelectNodes("//" + HTML.TAG_ANCHOR + "[@" + HTML.ATTRIBUT_HREF + "]");
        var embed_tags = HtmlDoc.DocumentNode.SelectNodes("//" + HTML.TAG_EMBED + "[@" + HTML.TAG_EMBED_SRC + "]");
        var iframe_tags = HtmlDoc.DocumentNode.SelectNodes("//" + HTML.TAG_IFRAME + "[@" + HTML.TAG_IFRAME_SRC + "]");
        var img_tags = HtmlDoc.DocumentNode.SelectNodes("//" + HTML.TAG_IMG + "[@" + HTML.TAG_IMG_SRC + "]");
        var audio_tags = HtmlDoc.DocumentNode.SelectNodes("//" + HTML.TAG_AUDIO);       // may contain inner-html
        var object_tags = HtmlDoc.DocumentNode.SelectNodes("//" + HTML.TAG_OBJECT);     // may contain inner-html
        var video_tags = HtmlDoc.DocumentNode.SelectNodes("//" + HTML.TAG_VIDEO);       // may contain inner-html 
```

其中 decodedHTML 是打包在字符串中的 html 页面。之后我检查上面的变量是否为空

```
 if (anchor_tags != null)
        {
            ExtractLinks_AnchorTags(anchor_tags);
        }
        if(audio_tags != null)
        {
            ExtractLinks_AudioTags(audio_tags);
        }
        if(embed_tags!=null)
        {
            ExtractLinks_EmbedTags(embed_tags);
        }
        if (iframe_tags != null)
        {
            ExtractLinks_iFrameTags(iframe_tags);
        }
        if (img_tags != null)
        {
            ExtractLinks_ImgTags(img_tags);
        }
        if (object_tags != null)
        {
            ExtractLinks_ObjectTags(object_tags);
        }
        if (video_tags != null)
        {
            ExtractLinks_ObjectTags(video_tags);
        } 
```

其中一些肯定是空的，因为大多数 extractLinks 方法甚至都没有被调用。例如，当我访问 youtube 时。com 。有几个 iframe-tags 并且代码无法识别它们。

编辑：

当我删除 iframe 时`"[@" + HTML.TAG_IFRAME_SRC + "]"`，iframe 被识别，但我只想提取具有 src 属性的 iframe。它的正确 xpath 语法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:55:02.830

HtmlAgilityPack 不加载元素的内容`iframe`。

为了`iframe`检查. `src`_ `iframe`_`HtmlDocument`

在此过程中，请注意以下可能的问题：

*   该`src`属性可能包含一个相对 URI。例如，如果您访问`http://www.example.com`并看到一个`iframe`has `src="/samplePage"`，您应该首先将其转换为绝对 URI（在这种情况下，`http://www.example.com/samplePage`）

*   有些`iframe`元素可能没有`src`标签，因为它是在浏览器中呈现文档时通过 javascript 动态添加的。也可以`iframe`使用 javascript 创建整个元素，如果您只是执行常规的`HttpWebRequest`. 在这种情况下，您必须分析页面上存在的 javascript 并在您的程序中复制该逻辑。

## 更新

`iframe`具有`src`属性的元素的 XPath 表达式为：`//iframe[@src]`

# c# - C#/.Net - 快速解析 XML / XML -> Json

> ID：14338748
> 
> 赞同：3
> 
> 时间：2013-01-15T13:24:52.213
> 
> 标签：c#, xml, json, xml-parsing, xmlconvert

我是 XML 新手，因为现在我只使用过 Json:( 我有一个 XML 文件，它看起来像这样：

```
<AdapterCards>
    <cards type="MCS">
        <card>
            <id>id1</id>
            <description>desc1</description>
            <mccode>code1</mccode>
        </card>
        <card>
            <id>id2</id>
            <description>desc2</description>
            <mccode>code2</mccode>
        </card>
    </cards>
    <cards type="MCM">
        <card>
            <id>id3</id>
            <description>desc3</description>
            <mccode>code3</mccode>
        </card>
        <card>
            <id>id4</id>
            <description>desc4</description>
            <mccode>code4</mccode>
        </card>
    </cards>
    <cards type="F"/>
    <cards type="B"/>
</AdapterCards> 
```

我想将它解析为一个 json 字符串，它应该如下所示：

```
{[{'type': 'mcs', 'id': 'id1', 'description': 'desc1', 'mccode': 'code1'},
  {'type': 'mcs', 'id': 'id2', 'description': 'desc2', 'mccode': 'code2'},
  {'type': 'mcm', 'id': 'id3', 'description': 'desc3', 'mccode': 'code3'},
  {'type': 'mcm', 'id': 'id4', 'description': 'desc4', 'mccode': 'code4'}
]} 
```

我的问题是我根本没有使用过 XML（是的，真丢脸）。你能否给我一些关于如何快速解析 xml 的线索（我有它在一个流上，我把它上传到服务器上）。我已经搜索了一些 XML 到 Json 的转换器，但是不可能找到适合我需要的，因为我需要一种“特殊”格式。

谢谢你的答案:)！我正在使用 C#。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:57:10.563

最近，我不得不自己为同一类型的事情编写一个定制的解决方案。我使用 XSLT 完成了它，使用`XslCompiledTransform`该类来运行 XML 输入和输出 JSON。

这需要一些工作，但应该可以帮助您了解基础知识（它是从我所做的工作中复制粘贴的，已更改为~~几乎~~适合您的需求）：

**适配器卡.XML**

```
<AdapterCards>
    <cards type="MCS">
        <card>
            <id>id1</id>
            <description>desc1</description>
            <mccode>code1</mccode>
        </card>
        <card>
            <id>id2</id>
            <description>desc2</description>
            <mccode>code2</mccode>
        </card>
    </cards>
    <cards type="MCM">
        <card>
            <id>id3</id>
            <description>desc3</description>
            <mccode>code3</mccode>
        </card>
        <card>
            <id>id4</id>
            <description>desc4</description>
            <mccode>code4</mccode>
        </card>
    </cards>
    <cards type="F"/>
    <cards type="B"/>
</AdapterCards> 
```

**适配器卡.XSL**

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output indent="no" omit-xml-declaration="yes" method="text" encoding="UTF-8" media-type="text/x-json" />

<xsl:variable name="smallcase" select="'abcdefghijklmnopqrstuvwxyz'" />
<xsl:variable name="uppercase" select="'ABCDEFGHIJKLMNOPQRSTUVWXYZ'" />

    <!-- Main template for escaping strings; used by above template and for object-properties 
       Responsibilities: placed quotes around string, and chain up to next filter, escape-bs-string -->
    <xsl:template name="escape-string">
        <xsl:param name="s"/>
        <xsl:text>"</xsl:text>
        <xsl:call-template name="escape-bs-string">
            <xsl:with-param name="s" select="$s"/>
        </xsl:call-template>
        <xsl:text>"</xsl:text>
    </xsl:template>

    <!-- Escape the backslash (\) before everything else. -->
    <xsl:template name="escape-bs-string">
        <xsl:param name="s"/>
        <xsl:choose>
            <xsl:when test="contains($s,'\')">
                <xsl:call-template name="escape-quot-string">
                    <xsl:with-param name="s" select="concat(substring-before($s,'\'),'\\')"/>
                </xsl:call-template>
                <xsl:call-template name="escape-bs-string">
                    <xsl:with-param name="s" select="substring-after($s,'\')"/>
                </xsl:call-template>
            </xsl:when>
            <xsl:otherwise>
                <xsl:call-template name="escape-quot-string">
                    <xsl:with-param name="s" select="$s"/>
                </xsl:call-template>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:template>

    <!-- Escape the double quote ("). -->
    <xsl:template name="escape-quot-string">
        <xsl:param name="s"/>
        <xsl:choose>
            <xsl:when test="contains($s,'&quot;')">
                <xsl:call-template name="encode-string">
                    <xsl:with-param name="s" select="concat(substring-before($s,'&quot;'),'\&quot;')"/>
                </xsl:call-template>
                <xsl:call-template name="escape-quot-string">
                    <xsl:with-param name="s" select="substring-after($s,'&quot;')"/>
                </xsl:call-template>
            </xsl:when>
            <xsl:otherwise>
                <xsl:call-template name="encode-string">
                    <xsl:with-param name="s" select="$s"/>
                </xsl:call-template>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:template>

    <!-- Replace tab, line feed and/or carriage return by its matching escape code. Can't escape backslash
       or double quote here, because they don't replace characters (&#x0; becomes \t), but they prefix 
       characters (\ becomes \\). Besides, backslash should be seperate anyway, because it should be 
       processed first. This function can't do that. -->
    <xsl:template name="encode-string">
        <xsl:param name="s"/>
        <xsl:choose>
            <!-- tab -->
            <xsl:when test="contains($s,'&#x9;')">
                <xsl:call-template name="encode-string">
                    <xsl:with-param name="s" select="concat(substring-before($s,'&#x9;'),'\t',substring-after($s,'&#x9;'))"/>
                </xsl:call-template>
            </xsl:when>
            <!-- line feed -->
            <xsl:when test="contains($s,'&#xA;')">
                <xsl:call-template name="encode-string">
                    <xsl:with-param name="s" select="concat(substring-before($s,'&#xA;'),'\n',substring-after($s,'&#xA;'))"/>
                </xsl:call-template>
            </xsl:when>
            <!-- carriage return -->
            <xsl:when test="contains($s,'&#xD;')">
                <xsl:call-template name="encode-string">
                    <xsl:with-param name="s" select="concat(substring-before($s,'&#xD;'),'\r',substring-after($s,'&#xD;'))"/>
                </xsl:call-template>
            </xsl:when>
            <xsl:otherwise>
                <xsl:value-of select="$s"/>
            </xsl:otherwise>
        </xsl:choose>
    </xsl:template>

    <xsl:template match="card">
        <xsl:text>{</xsl:text>

        <xsl:text>"type":</xsl:text>
        <xsl:call-template name="escape-string">
            <xsl:with-param name="s" select="translate(../@type, $uppercase, $smallcase)"/>
        </xsl:call-template>

        <xsl:text>,"id":</xsl:text>
        <xsl:call-template name="escape-string">
            <xsl:with-param name="s" select="id"/>
        </xsl:call-template>

        <xsl:text>,"description":</xsl:text>
        <xsl:call-template name="escape-string">
            <xsl:with-param name="s" select="description"/>
        </xsl:call-template>

        <xsl:text>,"mccode":</xsl:text>
        <xsl:call-template name="escape-string">
            <xsl:with-param name="s" select="mccode"/>
        </xsl:call-template>

        <xsl:if test="following::card">},</xsl:if>
        <xsl:if test="not(following::card)">}</xsl:if>
    </xsl:template>

    <xsl:template match="/AdapterCards">
        <xsl:text>{[</xsl:text>

        <xsl:apply-templates select="cards/card" />

        <xsl:text>]}</xsl:text>
  </xsl:template>
</xsl:stylesheet> 
```

**C＃**

```
// Load XML document
XmlDocument xmlDoc = new XmlDocument();
xmlDoc.Load("AdapterCards.XML");

// Transform the XML into JSON
XslCompiledTransform transformer = new XslCompiledTransform();
using (var xslStylesheetFile = File.Open("AdapterCards.XSL", FileMode.Open))
{
    using (var xmlReader = new XmlTextReader(xslStylesheetFile))
    {
        transformer.Load(xmlReader);
    }
}
var sourceNavigator = xmlDoc.CreateNavigator();
using (MemoryStream ms = new MemoryStream())
{
    transformer.Transform(sourceNavigator, null, ms);
    ms.Position = 0;
    using (var sr = new StreamReader(ms))
    {
        return sr.ReadToEnd(); // <-- this is your JSON
    }
} 
```

我在 Notepad++ 中执行了上面的 XSL，得到了以下结果：

```
{[{"type":"mcs","id":"id1","description":"desc1","mccode":"code1"},
{"type":"mcs","id":"id2","description":"desc2","mccode":"code2"},
{"type":"mcm","id":"id3","description":"desc3","mccode":"code3"},
{"type":"mcm","id":"id4","description":"desc4","mccode":"code4"}]} 
```

~~如您所见，它们需要的地方缺少逗号。但它几乎就在那里！~~

~~更新了 XSL 和现在在正确位置使用逗号的输出。接下来要解决的是“类型”的情况。我想您可能需要使用 XSL 2.0 来访问[xpath 函数](http://www.w3schools.com/xpath/xpath_functions.asp) `fn:lower-case()`。~~

**EDIT3 ：**[在这个答案的帮助](https://stackoverflow.com/questions/586231/how-can-i-convert-a-string-to-upper-or-lower-case-with-xslt)下， Done-case 现在被翻译为更低。

参考：

*   [xml2json-xslt](http://code.google.com/p/xml2json-xslt/issues/attachmentText?id=14&aid=-222068157203175897&name=xml2json.xsl&token=72c32fb729e2dc417d20647f67f64675)
*   [如何使用 XSLT 将字符串转换为大写或小写？](https://stackoverflow.com/questions/586231/how-can-i-convert-a-string-to-upper-or-lower-case-with-xslt)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:43:13.133

使用包含辅助方法的 JsonConvert 类用于此精确目的：

```
// To convert an XML node contained in string xml into a JSON string   
XmlDocument doc = new XmlDocument();
doc.LoadXml(xml);
string jsonText = JsonConvert.SerializeXmlNode(doc);

// To convert JSON text contained in string json into an XML node
XmlDocument doc = (XmlDocument)JsonConvert.DeserializeXmlNode(json); 
```

此处的文档：[使用 Json.NET 在 JSON 和 XML 之间进行转换](http://james.newtonking.com/projects/json/help/index.html?topic=html/ConvertingJSONandXML.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-10-22T15:57:54.740

这是使用开源库[Cinchoo ETL将 xml 转换为 json 文件的另一种简单方法](https://www.nuget.org/packages/ChoETL.JSON/)

```
using (var r = new ChoXmlReader("*** Xml file path ***")
       .WithXPath("//cards")
       )
{
    using (var w = new ChoJSONWriter("*** Json file path ***")
          )
        w.Write(r.SelectMany(r1 => ((dynamic[])r1.cards??new dynamic[]{}).Select(c => new { r1.type, c.id, c.description, c.mccode })));
} 
```

小提琴示例：[https ://dotnetfiddle.net/Yzcaiw](https://dotnetfiddle.net/Yzcaiw)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-01-15T13:40:46.453

```
XDocument xDoc = XDocument.Load(queryURL);                               
var x1 = from el in xDoc.Root.Descendants("results").Descendants("div").Descendants("div").Descendants("span").Attributes("class")
where el.Value == "pr"
  select el.Parent.Value;                
   stockFeed.Price = Decimal.Parse(x1.First().ToString()); 
```

LINQ 是提取数据的最佳方式。

# sql - 试试 Catch - 资源强度？

> ID：14338755
> 
> 赞同：3
> 
> 时间：2013-01-15T13:25:14.280
> 
> 标签：sql, sql-server, sql-server-2008

我读过在 SQL Server 存储过程中使用 Try Catch 块可以占用大量服务器资源。我的问题是它使用了多少资源？

我目前在我的 sproc 进行大量数据更改时使用 Try Catch 块和事务，这对于防止不正确的数据进入数据库以及记录错误非常有用，但我想使用这种方法在我所有的存储过程中进行编程。

它有多大的不同？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T14:24:25.367

零。使用 TRY/CATCH 的代码消耗的资源与不使用 TRY/CATCH 的代码完全相同，唯一的区别是前者通常比后者更正确。事实上，TRY/CATCH 代码在出现错误时*效率*更高，因为代码流直接跳转到 catch 块，并避免运行请求/存储过程中的其余语句，只是在最后回滚。

只是为了记录，我不相信在每条语句之后编写检查@@ERROR的代码甚至是*远程*可行的替代方案。

> 我上大学的时候在书里读过

可以肯定的是，阅读不是指带有 TRY/CATCH 的 T-SQL 代码，而是指有或没有异常的 C++ 代码（JVM 或 IL）。回到黑暗时代，关于添加异常处理代码是否会对性能产生影响（是的，确实有）以及我们是否应该将其视为一个因素（不，我们不应该，具有异常处理的代码早已赢得了这一点）存在争议由于*正确性*而战斗）。但是从您的观点来看，这个讨论完全没有用：运行 T-SQL 的后端引擎是用异常处理编译的，您对此无能为力。同样，这对您的 T-SQL 代码的影响为 0。

# tree - 具有可选运算符 + 自定义 AST 节点的 ANTLR 表达式

> ID：14338756
> 
> 赞同：0
> 
> 时间：2013-01-15T13:25:14.993
> 
> 标签：tree, antlr, optional

最近我不得不为以下表达式制作语法：

```
rule1 & rule2 & rule3 => produces binary tree 
  (AndNode (AndNode RuleNode(rule1) RuleNode(rule2)) RuleNode(rule3))
rule1 | (rule2 & rule3) => produces binary tree
  (OrNode RuleNode(rule1) (AndNode RuleNode(rule2) RuleNode(rule3))) 
```

RuleNode、AndNode 和 OrNode 是我的类，稍后将在评估整个表达式时使用它们。rule1、rule2 等只是我领域中的概念，与解析器或词法分析器规则无关。

这是语法：

```
RULE      : ('a'..'z'|'A'..'Z')('a'..'z'|'A'..'Z'|'0'..'9')*;
QUOTE     : '\'';
PARAM     : QUOTE ( ~('\'') )* QUOTE;
LPAREN    : '(';
RPAREN    : ')';
DELIMITER : ',';
AND       : '&';
OR        : '|';
WS        : (' ' | '\t')+ {$channel = HIDDEN;};

params    : LPAREN! PARAM (DELIMITER! PARAM)* RPAREN!;
rule      : RULE<RuleNode>^ params?;

expr      : andexpr;
andexpr   : orexpr (AND<AndNode>^ orexpr)*;
orexpr    : atom (OR<OrNode>^ atom)*;
atom      : rule | LPAREN! expr RPAREN!;

parse     : expr; 
```

在我要求将 AND 运算符设为默认值之前，一切都运行良好，因此我可以编写如下示例：

```
rule1 rule2 rule3
rule1 | (rule2 rule3) 
```

我尝试以不同的方式指定 anexpr 规则：

1)

```
andexpr   : orexpr+ -> (^(AND<AndNode> orexpr))+; 
```

结果 - 生成的树不是二叉树，甚至没有 AndNode 作为根：

```
(nil RuleNode(rule1) RuleNode(rule2) RuleNode(rule3)) 
```

2)

基于[ANTLR Tree Construction](http://www.antlr.org/wiki/display/ANTLR3/Tree+construction)（Operators section）的第一个示例，我还尝试了：

```
andexpr   : (a=orexpr->$a) (b=orexpr -> ^(AND<AndNode> $andexpr $b))*; 
```

结果 - 与 1 中相同的扁平树）

如果我从 2) 中删除自定义节点：

```
andexpr   : (a=orexpr->$a) (b=orexpr -> ^(AND $andexpr $b))*; 
```

然后解析器产生二叉树：

```
(AND (AND RuleNode(rule1) RuleNode(rule2)) RuleNode(rule3)) 
```

但不幸的是 AND 不是我的自定义 AndNode。我怀疑它与 AndNode 构造有关 - 在原始示例中需要 '&' 的构造函数是

```
AndNode(Token token) { this.token = token; } 
```

但是对于带有可选'&'的语法，我必须实现一个新的

```
AndNode(int type) { } 
```

它不再接受 Token 作为参数。

请帮我为这种情况编写规则，以便我同时拥有二叉树和自定义节点！我被困住了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:00:13.067

您应该可以使用`^({new AndNode(AND)} ...`而不是`^(AND<AndNode> ...`.

# opengl - JOGL 在 atio6axx.dll 中抛出错误

> ID：14338757
> 
> 赞同：0
> 
> 时间：2013-01-15T13:25:17.347
> 
> 标签：opengl, driver, jogl

在尝试使用 JOGL 进行一些 OpenGL 开发时，我不断收到以下错误：

```
# Problematic frame:
# C  [atio6axx.dll+0x73a32] 
```

在网络上搜索直接指向 AMD 视频驱动程序，并强烈建议更新我的驱动程序。

问题：我有一台 HP Pavilion dv6-3206ax，它实际上有两个 GPU，一个高功率且速度快，一个低功率且可能较慢。标准的 AMD Catalyst 安装不喜欢这种配置，所以我只能使用来自 HP 支持站点的驱动程序。

显卡是：ATI Mobility Radeon HD 6550 和 AMD M880G 与 ATI Mobility Radeon HD 4250

注意：我*可以*通过导航到 AMD Radeon 显示驱动程序目录来强制安装 6550 的最新驱动程序，这确实允许 JOGL 运行。但这也会导致我的笔记本电脑过热。

他们已经两年没有更新了，我已经有了最新的。帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-11T05:23:59.257

从“手动卸载驱动程序”部分尝试这个小伙子做了什么。

多么传奇！ [http://us.battle.net/wow/en/forum/topic/6794729581](http://us.battle.net/wow/en/forum/topic/6794729581)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:25:17.347

我找到了各种各样的解决方案。如果我使用 ATI PowerXpress 手动选择“Power Saving GPU”，OpenGL 可以工作。这对我目前的目的来说已经足够了。

我必须从 HP 支持网站下载并安装最新的 AMD 高清显卡驱动程序才能让 ATI PowerXPress 正常工作。

# mysql - MySQL 查询忽略 where 子句的索引

> ID：14338764
> 
> 赞同：1
> 
> 时间：2013-01-15T13:25:25.530
> 
> 标签：mysql, indexing, explain

我有一个表，其中有一列名为“日期”。

桌子看起来像这样

```
CREATE TABLE IF NOT EXISTS `offers_log_archive` (
                    ...
                    `date` date DEFAULT NULL,
                    ...
                    KEY `date` (`date`)
                ) ENGINE=InnoDB 
```

我对此表执行以下查询：

```
SELECT 
    *
FROM 
    offers_log_archive as ola
WHERE 
    ola.date >= "2012-12-01" and
    ola.date <= "2012-12-31" 
```

然后我做了以下事情：

```
explain (SELECT 
    *
FROM 
    offers_log_archive as ola
WHERE 
    ola.date >= "2012-12-01" and
    ola.date <= "2012-12-31" ); 
```

这个解释的结果是

```
id  select_type  table type possible_keys key  key_len ref  rows    Extra
1   SIMPLE       ola   ALL  date          NULL NULL    NULL 6206460 Using where 
```

为什么我会得到 ALL 类型？据我所知，这基本上意味着查询将检查表中的每一行并忽略日期索引。虽然我希望mysql会使用它。

这里发生了什么，为什么忽略日期索引？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:04:18.300

列中的几乎所有值都在查询范围内，因此索引不仅几乎无用（它不会增加任何价值），而且使用索引实际上比简单的表扫描*要昂贵*得多.

### 编辑

尝试首先[`ANALYZE`](http://dev.mysql.com/doc/refman/5.0/en/analyze-table.html)在桌子上运行：

```
ANALYZE TABLE MYTABLE 
```

如果这没有帮助，请尝试更改要使用的语法`BETWEEN`：

```
WHERE ola.date BETWEEN '2012-12-01' AND '2012-12-31' 
```

# java - Mule ESB 3.3 Mulecontext 注册表弹出

> ID：14338765
> 
> 赞同：1
> 
> 时间：2013-01-15T13:25:26.227
> 
> 标签：java, mule, mule-studio

我最近[在这里](https://stackoverflow.com/questions/14279894/how-would-i-go-about-accessing-a-string-object-stored-in-the-registry-form-a-flo)问了一个问题，我问如何从 Mule Flow 中引用 mule 注册表中的 String 对象。这已成功回答我当前的问题是在流程初始化之前我无法在注册表中填充它。

因此，在以下部分 (password="#app.registry['password']]) 中始终使用 null 并且我的连接失败：

```
<sfdc:config name="ConfigurableSalesforceConnection"username="${sfdc.username}"password="#app.registry['password']]"securityToken="${sfdc.securityToken}"doc:name="Salesforce" url="${sfdc.url}" /> 
```

除其他外，我还为我的流程添加了一个侦听器，但这添加的值太晚了，流程已经被初始化。

```
<notifications>
    <notification event="CONTEXT"/>
    <notification-listener ref="Initializer"/>
</notifications>
<spring:beans>
    <spring:bean id="Initializer" name="Initializer"
        class="initializer.InitAccountSync" />
</spring:beans> 
```

我的问题由两部分组成，首先有没有办法在启动后重新初始化流程，和/或如何在所述初始化之前将值存储在 mule-context 注册表中？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:36:31.480

注册表与 Spring 共享，您可以使用 SpEL 或 MethodInvokingFactoryBean 注册一些 java.lang.String bean。

但是，对于这种情况，如果您不在 mule 外部检索它，我建议您使用杠杆[jasypt](http://blogs.mulesoft.org/encrypting-passwords-in-mule/)。

# asp-classic - 用“0”填充月份

> ID：14338770
> 
> 赞同：0
> 
> 时间：2013-01-15T13:25:40.447
> 
> 标签：asp-classic, vbscript

这是我的代码：

```
If FinalMonth = "" OR FinalYear = ""  Then
    FinalMonth = Month(Now())
    FinalYear = Year(Now())
End If

Select Case(FinalMonth)
    Case "01","03","05","07","08","10","12"
        FinalDay = "31"
    Case "04","06","09","11"
        FinalDay = "30"
    Case "02"
        If ( (FinalYear Mod 4) <> 0 ) Then
            FinalDay = "28"
        Else
            FinalDay = "29"
        End If
End Select 
```

我想在每个示例的数字 1（一月）之前将我的月份设置为 0，最后设置为 Month 01。请问我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:38:26.473

你可以;

```
If FinalMonth = "" OR FinalYear = ""  Then
    FinalMonth = Month(Now())
    FinalYear = Year(Now())
End If

'get last day of month - add 1 month then deduct 1 day
FinalDay = Day(DateSerial(FinalYear, FinalMonth + 1, 1) - 1)

'pad month
if (FinalMonth < 10) then FinalMonth = "0" & FinalMonth 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-10T10:25:14.323

那这个呢 ？

```
<%=Right("0" & Day(now()), 2)%>-<%=Right("0" & Month(now()), 2)%>-<%=Year(now())%> 
```

输出 : 10-02-2018

# tfs - TFS、NuGet、包还原 寻找需要更新的项目？

> ID：14338776
> 
> 赞同：0
> 
> 时间：2013-01-15T13:25:45.947
> 
> 标签：tfs, nuget

所以过去几天我一直在设置 NuGet，制作我们内部库的包，更新我们的项目，让我们的 TFS 构建服务器进行构建。这一切都太棒了！现在我遇到了一个问题，在 NuGet 和包还原之前，我可以在 TFS 中搜索 .dll 文件，例如，我可以在 TFS 中搜索 Company.Common.dll 并使用以下命令查找使用此 dll 的所有项目：

> tf dir "$/*Company.common.dll" /recursive /server:http://tfs-server:8080

现在，在我们开始使用 NuGet 并使用包还原后，dll 文件 Company.Common.dll 将不会出现在使用它的项目的 TFS 中。这意味着我无法使用上述搜索命令来查找我要更新的 .dll 文件

我正在考虑编写一个 powershell 脚本，该脚本将在 TFS 中找到所有 packages.config 文件并将它们下载到一个文件夹结构中，该文件夹结构指示不同项目在 TFS 中的位置。然后我会遍历 packages.config 文件来找出哪些项目使用了我想要更新的特定 NuGet 包。

这样做的原因当然是我们所有的项目都应该在有更新时更新 Common.dll。

我想知道是否有人已经解决了这个“问题”，所以我不必再次发明轮子，或者对此有一些观点或建设性意见。我想核心问题是这样的：

当有多个团队在 TFS 中创建/更新项目时，您如何处理跨所有项目更新包？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T00:28:41.960

一种解决方案是使用“repositoryPath”NuGet 配置设置并使其指向中央 UNC 共享。更多细节在这里@http [://docs.nuget.org/docs/release-notes/nuget-2.1](http://docs.nuget.org/docs/release-notes/nuget-2.1)。

如果需要，您可以使用 NuGet.exe Update packageName -RepositoryPath xxx -Source xxx 命令更新特定包。

# maven-3 - 手动安装maven插件进行离线模式操作

> ID：14338777
> 
> 赞同：1
> 
> 时间：2013-01-15T13:25:46.700
> 
> 标签：maven-3

由于我在 settings.xml 中启用了离线模式，如何手动安装 maven 插件？

例如我下载了 maven-clean-plugin-2.4.1.jar。但我不知道在哪里放置它以及如何安装它。

试过[http://maven.apache.org/plugins/maven-install-plugin/usage.html](http://maven.apache.org/plugins/maven-install-plugin/usage.html)但我无法安装。请帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:29:34.270

这是类似的问题。希望这可以帮助您离线安装 maven 插件。 [Maven：如何在离线模式下安装插件](https://stackoverflow.com/questions/3312132/maven-how-to-install-a-plugin-in-offline-mode)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T21:31:21.573

我建议上网一次并运行

```
mvn dependency:go-offline 
```

依赖插件的[下线](http://maven.apache.org/plugins/maven-dependency-plugin/go-offline-mojo.html)目标将是“解决所有项目依赖，包括插件和报告及其依赖。”

# java - 持续集成工具 (TeamCity) 中的集成测试

> ID：14338779
> 
> 赞同：0
> 
> 时间：2013-01-15T13:25:58.387
> 
> 标签：java, continuous-integration, teamcity, integration-testing

如何使用 TeamCity 在每次构建时执行自动化集成测试？

通常会有以下步骤：

1.  从代码库签出；
2.  建造;
3.  部署;
4.  启动服务器；
5.  在服务器上运行测试。

问题是这些步骤相互依赖。在第 4 步之前一切正常。在这里您启动服务器，但在第 4 步完成之前它不会进入第 5 步。但如果第 4 步完成，服务器将停止，因此第 5 步的测试将没有服务器可工作。

我想到的唯一解决方法是非常奇怪和**丑陋**（我不知道它是否真的有效）：首先在守护线程中触发测试，该线程最初应该等待 2 分钟（让服务器有时间开始）; 由于该线程是一个守护线程，JVM 可以停止，而该线程仍然继续触发测试。在此之后，它可以进入启动服务器的下一步，直到服务器启动，计时器耗尽并触发测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:23:22.780

这取决于“启动服务器”的含义。我们正是这样做的，但我们将“启动服务器”视为实际启动服务器 - 当服务器完全正常运行时，该步骤结束。然后我们添加第 6 步“停止服务器”。在第 5 步中，我们使用 TeamCity 的 NUnit 运行程序来运行测试。它工作得很好。

# c# - 从 DirectoryEntry 中提取组名

> ID：14338783
> 
> 赞同：0
> 
> 时间：2013-01-15T13:26:27.933
> 
> 标签：c#, active-directory

当我使用下面的代码获取组列表时，我得到一个代表组名的长字符串

> CN=group.xy.admin.si,OU=Other,OU=Groups,OU=03,OU=UWP 客户,DC=WIN,DC=CORP,DC=com

但我只想获取在本例中为**group.xy.admin.si的组名**

```
 public static List<string> GetGroups(DirectoryEntry de)
   {
       var memberGroups = de.Properties["memberOf"].Value;

       var groups = new List<string>();

       if (memberGroups != null)
       {
           if (memberGroups is string)
           {
               groups.Add((String)memberGroups);
           }
           else if (memberGroups.GetType().IsArray)
           {
               var memberGroupsEnumerable = memberGroups as IEnumerable;

               if (memberGroupsEnumerable != null)
               {
                   foreach (var groupname in memberGroupsEnumerable)
                   {

                       groups.Add(groupname.ToString());
                   }

               }
           }

       }
       return groups;
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:01:41.337

这里有两个选项：

*   使用您必须从 AD 检索组对象的 distinctName，使用其“名称”属性
*   使用正则表达式提取组名

正则表达式的伪代码：

```
string Pattern = @"^CN=(.*?)(?<!\\),.*";
string group = Regex.Replace(groupname.ToString(), Pattern, "$1");
groups.Add(group); 
```

名称可以包含由“\”转义的“，”，因此即使您有名为“Foo，Bar”的组，此正则表达式也应该可以正常工作

# c# - 如何将 GridView 的一行内容发送到另一个页面？

> ID：14338784
> 
> 赞同：1
> 
> 时间：2013-01-15T13:26:29.757
> 
> 标签：c#, asp.net, visual-studio-2010, web

我在网格中`GridView` 有一个`BoundFields`和一个。`Button`我想触发`OnClick`按钮的事件以打开一个新窗口，并获取整行的内容来编辑它......我该怎么做？我不想使用`QueryString`，我认为`Session`这不是最好的方法，所以还有其他安全的方法吗？

Obs：我`GridView`从页面内部`DataBase`使用 a获取我的内容。对我来说比大多数人都难，因为我曾经在 WebForms 上编程，这是我第一次使用 web =\`SqlDataSource``aspx`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T16:13:10.660

我使用 Sessions 解决了：

```
Session["login"].ToString() = TxtLogin.ToString(); 
```

并检索信息：

```
TxtTeste.Text = Session["login"].ToString(); 
```

# sqlplus - 向 sqlplus 发送查询

> ID：14338785
> 
> 赞同：2
> 
> 时间：2013-01-15T13:26:31.777
> 
> 标签：sqlplus

我有一个脚本文件，它将查询发送到 sqlplus 并将输出发送到其他输出文件。然而，这个输出文件包含一些来自 sqlplus 的信息——某种问候。

```
SQL*Plus: Release 11.2.0.3.0 Production on Tue Jan 15 12:30:40 2013                         

Copyright (c) 1982  2011     Oracle.  All rights reserved.                  

Connected to:                           
Oracle Database 11g Enterprise Edition Release 11.2.0.3.0 - 64bit Production                            
With the Partitioning    Real Application Clusters   Automatic Storage Management    OLAP               
Data Mining and Real Application Testing options 
```

有没有办法执行脚本，这样这个问候就不会成为文件的一部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-25T01:25:01.077

您可以`sqlplus -s`在连接到数据库时使用该选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-05-28T20:39:30.917

```
Execsqlstatement1="select
'ZZZ|'
||count(*) total
from table1"

$ORACLE_HOME/bin/sqlplus user/tneal01 << Eossql
    set lines 80
    set pages 50000
    set timing on
    spool /user/tneal01/SPOOL/output.`date +%Y-%m-%d`.tmp
    $Execsqlstatement1
    /
    spool off
    quit;
Eossql 
```

现在，如果除了输出文件中的结果之外您不想要任何东西，您可以在脚本中执行以下操作：

```
grep 'ZZZ' $OutPutDir/$OutPutFile.$today.tmp|cut -d"|" -f2- >$OutPutDir/$OutPutFile.$today.txt 
```

这是一个完整的例子，说明为什么这样做：

```
#!/bin/ksh

today=`date "+%Y-%m-%d"`
OutPutDir="/users/ttead01/SPOOL"
OutPutFile="output"

#add sql statements here

Execsqlstatement1="select
'ZZZ|'
||count(*) total
from users"

#adding connection details here

$ORACLE_HOME/bin/sqlplus tead01/rangers $SQLPLUS -s / << Eossql
    set lines 80
    set pages 50000
    set timing on
    spool /users/ttead01/SPOOL/output.`date +%Y-%m-%d`.tmp
    $Execsqlstatement1;
    spool off
    quit;
Eossql

#check to make sure no ORA errors in the query

grep "ORA-" $OutPutDir/$OutPutFile.$today.tmp
if [ $? -eq 0 ]
then
    echo "LOG MESSAGE sql select failed"

 exit 1
fi

#Seach for ZZZ and cut out junk and send only result to a .txt file

grep 'ZZZ' $OutPutDir/$OutPutFile.$today.tmp|cut -d"|" -f2- >$OutPutDir/$OutPutFile.$today.txt

#Remove the .tmp file if .txt was created

if [ $? -eq 0 ]
then
  /usr/bin/rm -f $OutPutDir/$OutPutFile.$today.tmp
else
    exit 1
fi 
```

现在进行测试：

bash-3.2$ test.sh

```
Copyright (c) 1982, 2010, Oracle.  All rights reserved.

SQL> set autocommit on;
SQL> rem set linesize 132;
SQL> define _editor = vi
SQL> alter session set nls_date_format = 'YYYYMMDD HH24MISS';

Session altered.

SQL> SQL> SQL> SQL> SQL>   2    3    4    5    6    7    8
TOTAL
--------------------------------------------
ZZZ|32

Elapsed: 00:00:00.17 
```

现在让我们看看输出的 .txt 文件：

```
bash-3.2$ cat output.2016-05-28.txt
32
bash-3.2$ 
```

# build - Jenkins：当 SCM 触发任何构建时，按特定顺序触发相关构建

> ID：14338789
> 
> 赞同：1
> 
> 时间：2013-01-15T13:26:53.793
> 
> 标签：build, jenkins, hudson, integration, polling

假设我有三个工作，A、B 和 C。它们都运行相互交互的集成测试。C依赖于B，B依赖于A。

当 SCM 轮询触发三个项目中的任何一个时，有没有办法按顺序触发 A，然后是 B，然后是 C？

例如，我将代码签入 A，几分钟后，我将代码签入 C。我需要先构建 A，然后构建 B 以运行集成测试，然后构建 C。但我无法通过传统的轮询间隔来保证这一点。

我查看了参数化构建插件，但如果没有无限循环的构建，我无法找到一种方法。

编辑：下面的答案似乎是最好的选择，但我正在使用 Mercurial 并且找不到检查多个 Mercurial 存储库的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-08-05T02:10:17.500

诚然这是一个陈旧的问题，但如果您仍在处理这个问题（或者其他人遇到这个问题，就像我在搜索类似问题时所做的那样），我有一个替代方案：

*   Job A1 - 轮询 repo A 但不同步，触发 Job A2
*   Job B1 - 轮询 repo B 但不同步，触发 Job A2
*   Job C1 - 轮询 repo C 但不同步，触发 Job A2
*   Job A2 - 当前的 Job A，触发 Job B2
*   Job B2 - 当前的 Job B，触发 Job C2
*   作业 C2 - 当前作业 C

“不同步”可能不是必需的（它只会在相关作业上再次同步），但会保留当前链的确切功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T14:17:56.457

一种方法是将作业 A 配置为始终触发作业 B，将作业 B 配置为始终触发作业 C。这将确保它们按您需要的顺序运行。

现在，您希望对 3 个作业中的任何一个进行 SCM 更改以启动该链。在 Job A 中，您可以对所有 3 个存储库位置进行 SCM 签出（只是不要在 Job A 中使用它们）。

这样，轮询将适用于所有 3 个位置，将触发 Job A 进而触发您想要的正确链

# java - 在 Libgdx 库中使用 getSpectrum()

> ID：14338791
> 
> 赞同：10
> 
> 时间：2013-01-15T13:27:02.107
> 
> 标签：java, android, libgdx, fft, spectrum

我知道您首先想到的是“在文档中查找”，但是文档并不清楚。

我使用该库来获取 FFT，并遵循以下简短指南： [http ://www.digiphd.com/android-java-reconstruction-fast-fourier-transform-real-signal-libgdx-fft/](http://www.digiphd.com/android-java-reconstruction-fast-fourier-transform-real-signal-libgdx-fft/)

使用时会出现问题：

```
 fft.forward(array);
   fft_cpx=fft.getSpectrum();
   tmpi = fft.getImaginaryPart();
   tmpr = fft.getRealPart(); 
```

“fft_cpx”、“tmpi”、“tmpr”都是浮点向量。虽然“tmpi”和“tmpr”用于计算幅度，但“fft_cpx”不再使用。

我认为 getSpectrum() 是 getReal 和 getImaginary 的联合，但值都不同。也许，getSpectrum 的结果是复数，但它们的表示是什么？

我试过没有`fft_cpx=fft.getSpectrum();`，它似乎工作正常，但我想知道它是否真的有必要，getSpectrum()、getReal() 和 getImaginary() 之间有什么区别。

文档位于： http: [//libgdx-android.com/docs/api/com/badlogic/gdx/audio/analysis/FFT.html](http://libgdx-android.com/docs/api/com/badlogic/gdx/audio/analysis/FFT.html)

> **公共浮动[] getSpectrum()**
> 
> 返回： 最后一次 FourierTransform.forward() 调用的频谱。
> 
> **公共浮动[] getRealPart()**
> 
> 返回：最后一次 FourierTransform.forward() 调用的实部。
> 
> **公共浮动[] getImaginaryPart()**
> 
> 返回： 最后一次 FourierTransform.forward() 调用的虚部。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-02T13:40:27.153

getSpectrum() 返回复数的绝对值。

是这样计算的

```
for (int i = 0; i < spectrum.length; i++) {
    spectrum[i] = (float)Math.sqrt(real[i] * real[i] + imag[i] * imag[i]);
} 
```

# windows-phone-7 - 如何保存锁定屏幕的用户设置？

> ID：14338796
> 
> 赞同：0
> 
> 时间：2013-01-15T13:27:11.910
> 
> 标签：windows-phone-7, windows-phone-8

我开发了一个 windows phone 应用程序，当它处于活动状态时可以正常工作。但是现在我想在屏幕被锁定的情况下运行相同的应用程序。

我知道我们必须使用以下代码来实现相同的目的。

PhoneApplicationService.Current.UserIdleDetectionMode = IdleDetectionMode.Disabled;

但是如何保存用户为“在锁定屏幕下运行”切换选项所做的设置更改。这样下次用户再次启动此应用程序时，我会将其设置为用户上次所做的设置。

我想出的一种方法是使用IsolatedStorageSettings。让我知道是否有更好的方法来保存用户设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:14:06.627

隔离存储设置很好。

# c# - EventHandler is not working for dynamic control

> ID：14338798
> 
> 赞同：1
> 
> 时间：2013-01-15T13:27:15.193
> 
> 标签：c#, asp.net, .net

I have referred [Error with the event handlers of dynamic linkbutton](https://stackoverflow.com/questions/8770425/error-with-the-event-handlers-of-dynamic-linkbutton) . It says to add event handlers in `Page_Init` or `Page_Load`. I tired following code. But the event handler is not fired when I click on the dynamic added link buttons. What need to be corrected here?

Note: The dynamic LinkButton controls are added in the click event of a button after some business validations (the business code is not given for brevity)

**Markup**

```
<form id="form1" runat="server">
<div>
    <asp:LinkButton ID="lnkTest" runat="server" OnClick="LinkButton_Click">Static LinkButton</asp:LinkButton>
    <br />
    <asp:Button ID="btnAdd" runat="server" Text="Add" OnClick="btnAdd_Click" />
    <br />
    <asp:PlaceHolder ID="plhDynamicLinks" runat="server"></asp:PlaceHolder>
</div>
</form> 
```

**Code Behind**

```
 protected void Page_Load(object sender, EventArgs e)
    {

        foreach (Control ctrl in plhDynamicLinks.Controls)
        {
            LinkButton dynamicButton = (LinkButton)ctrl;
            dynamicButton.Click += new EventHandler(LinkButton_Click);
        }

        if (Page.IsPostBack)
        {

        }
    }

    protected void Page_Init(object sender, EventArgs e)
    {
        int x = 0;

        foreach (Control ctrl in plhDynamicLinks.Controls)
        {
            LinkButton dynamicButton = (LinkButton)ctrl;
            dynamicButton.Click += new EventHandler(LinkButton_Click);
        }
    }

    protected void LinkButton_Click(object sender, EventArgs e)
    {
        LinkButton clickedControl = (LinkButton)sender;
        Response.Write(clickedControl.ID +" Link Button Clicked");
    }

    protected void btnAdd_Click(object sender, EventArgs e)
    {
        plhDynamicLinks.Controls.Clear();

        LinkButton button1 = new LinkButton();
        button1.ID = "D1";
        button1.Text = "1";
        plhDynamicLinks.Controls.Add(button1);

        LinkButton button2 = new LinkButton();
        button2.ID = "D2";
        button2.Text = "2";
        plhDynamicLinks.Controls.Add(button2);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T12:39:33.077

必须在 Page_Load/ Page_Init 本身中注册所有必需的动态控件的事件处理程序。[在动态控制的事件处理程序的工作](https://stackoverflow.com/questions/14364332/dynamic-controls-event-handlers-working)中可以看到一个工作示例

**标记**

```
<form id="form1" runat="server">
<div>
    <asp:Button ID="btnAdd" runat="server" Text="Add" OnClick="btnAdd_Click" />
    <br />
    <asp:PlaceHolder ID="plhDynamicLinks" runat="server"></asp:PlaceHolder>
</div>
</form> 
```

**代码背后**

```
 protected void Page_Load(object sender, EventArgs e)
    {

        if (Page.IsPostBack)
        {
            LinkButton lnk1 = new LinkButton();
            lnk1.ID = "D1";
            lnk1.Text = "A";
            //Event handler must be registered in the Page_Load/Page_Init
            lnk1.Click += new EventHandler(LinkButton_Click);
            plhDynamicLinks.Controls.Add(lnk1);

            LinkButton lnk2 = new LinkButton();
            lnk2.ID = "D2";
            lnk2.Text = "B";
            lnk2.Click += new EventHandler(LinkButton_Click);
            plhDynamicLinks.Controls.Add(lnk2);

            LinkButton lnk3 = new LinkButton();
            lnk3.ID = "D3";
            lnk3.Text = "C";
            lnk3.Click += new EventHandler(LinkButton_Click);
            plhDynamicLinks.Controls.Add(lnk3);

            LinkButton lnk4 = new LinkButton();
            lnk4.ID = "D4";
            lnk4.Text = "D";
            lnk4.Click += new EventHandler(LinkButton_Click);
            plhDynamicLinks.Controls.Add(lnk4);

        }
    }

    protected void LinkButton_Click(object sender, EventArgs e)
    {
        PopulateLinksBasedOnCriteria();
        LinkButton clickedControl = (LinkButton)sender;
        Response.Write(DateTime.Now.ToString()+"___"+ clickedControl.ID + " Link Button Clicked" );
    }

    protected void btnAdd_Click(object sender, EventArgs e)
    {
        PopulateLinksBasedOnCriteria();
    }

    private void PopulateLinksBasedOnCriteria()
    {
        plhDynamicLinks.Controls.Clear();

        if (DateTime.Now.Second < 30)
        {
            LinkButton linkButton1 = new LinkButton();
            linkButton1.ID = "D1";
            linkButton1.Text = "1";
            plhDynamicLinks.Controls.Add(linkButton1);

            LinkButton linkButton2 = new LinkButton();
            linkButton2.ID = "D2";
            linkButton2.Text = "2";
            plhDynamicLinks.Controls.Add(linkButton2);
        }
        else
        {
            LinkButton linkButton3 = new LinkButton();
            linkButton3.ID = "D3";
            linkButton3.Text = "3";
            plhDynamicLinks.Controls.Add(linkButton3);

            LinkButton linkButton4 = new LinkButton();
            linkButton4.ID = "D4";
            linkButton4.Text = "4";
            plhDynamicLinks.Controls.Add(linkButton4);
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T12:48:20.707

必须在每次回发时重新创建动态控件，这篇[文章](http://www.singingeels.com/Articles/Dynamically_Created_Controls_in_ASPNET.aspx)是关于如何持久化动态控件及其状态的一个很好的链接。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-01-12T12:57:41.303

将 javascript`onClick`属性添加到动态控件并设置控件事件所需的隐藏字段值。`Onclick`动态网格的意志`postback`和意志得到隐藏场值。如果隐藏字段有值，则在页面加载中调用一个方法来完成工作，并在`null`完成工作后完成。

# vb.net - Unable to set focus on ToolStrip button

> ID：14338801
> 
> 赞同：1
> 
> 时间：2013-01-15T13:27:21.177
> 
> 标签：vb.net, select, button, focus, toolstrip

I have tried to research this all morning and found no solution that worked for me.

I have a `ToolStrip`, with several `buttons` on it. I am unable to get figure out how to select any of the buttons when using `tab`. I did find that it would systematically select the `toolstrip` but showed no visual indication of that. I only found this out by hitting the `left arrow key` each time I hit tab.

So my question is, how can I get one button on the `toolstrip(Button1)` to be selected *(so that when I would hit enter, it would automatically use the button)* by hitting the tab button.

I have turned the `TabStop = True` and the `TabStop` on the main UC is also set to True. I have assigned the `ToolStrip` a final Index number also. But still nothing gets highlight, but it's focused. I want the `Button1` to be focused when I focus the `ToolStrip`.

Thanks for your help in advance!

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-27T07:36:56.180

```
ToolStrip.Focus()

Button.Select() 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-23T08:36:25.920

除了第一个 Button 或任何元素之外，您不能将焦点设置到 toolStrip 中的任何按钮。所以不要尝试。浪费时间……我已经试过了……那个。

# google-chrome - KnockoutJS freeze in Chrome during unloading

> ID：14338807
> 
> 赞同：0
> 
> 时间：2013-01-15T13:27:47.843
> 
> 标签：google-chrome, knockout.js, knockout-mapping-plugin

I use **ko.mapping** pluging for binding a complex model (f.e. Project having list of branches, each having list of Tasks). Data are refreshed let's say every 10 seconds with ajax request and updated by the following function: **ko.mapping.fromJS(data, viewModel);**

After several updates and leaving page (or page Refresh) in Chrome is one core of my CPU busy and page leaving takes about 10s to a minute. Situation in Firefox looks better, but observed rarely.

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:01:30.603

当 CPU 受到重击时，您是否在调试器中查看过 Project 对象中有多少分支？值得检查映射是否正在更新分支，而不是在每次更新时创建新分支。

# bash - In a shell script how to validate if a given host name belongs to localhostname family

> ID：14338808
> 
> 赞同：3
> 
> 时间：2013-01-15T13:27:48.703
> 
> 标签：bash, shell, networking

In a shell script how to validate if a given host name is localhost

for example :-

```
localhost
127.0.0.1
myhostname.com
::1 
```

all belong to same machine name, Is there any way to identify that a given host name belongs to localhostname family

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:28:16.520

通常所有本地主机名都在 /etc/hosts 文件中：

```
grep -c machine_name /etc/hosts 
```

如果机器名称在 localhost 中，则上面的命令返回 1 或更大，否则为 0。

例如：

```
grep -c myhostname.com /etc/hosts
1

grep -c google.com /etc/hosts
0 
```

不确定这是否正是您正在寻找的，但我希望它会有所帮助。

注意部分匹配，例如，如果您在 /etc/hosts 中有 'myhost'`grep -c host`也会返回 1。在这种情况下，您需要使用正则表达式或使用 cut、awk 和类似工具解析 /etc/hosts 文件。或者使用以下命令：

```
grep -c  '\bmachine name\b' 
```

要跳过评论，请使用以下命令：

```
grep -v '^#.*' /etc/hosts | grep -c machine_name 
```

所以完整的命令是

```
grep -v '^#.*' /etc/hosts | grep -c '\bmachine_name\b' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:05:28.410

你可以检查

```
sysctl kernel.hostname 
```

IE

```
sysctl kernel.hostname | grep -c "my_hostname" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-20T12:10:24.980

我使用以下内容来检查提供的主机名是否与 localhost 相同：

```
hostname_ip(){
   host "$1" | sed -e 's/.* \([^ ]*[^ .]\)\.*$/\1/'
}

normalize_hostname(){
   local normalized="$1"
   grep -q "^\(\([0-9]{1,3}\)\.\)\{3\}\([0-9]{1,3}\)$" <<< "$normalized" || normalized="$(hostname_ip "$normalized")"
   normalized="$(hostname_ip "$normalized")"
   echo "$normalized"
}

myname="$(normalize_hostname "$(hostname)")"
argname="$(normalize_hostname "$1")"

if [[ "$myname" == "$argname" || "$argname" == "localhost" ]]; then
   ... 
```

首先，通过运行两次将提供的参数标准化为**主机实用程序设置的格式。**如果提供了 IP 地址——通过正则表达式检查——只运行一次。

然后将该值与**主机名**实用程序的规范化值或字符串“localhost”进行比较。

# javascript - 从 TinyMCE 编辑器获取内容

> ID：14338809
> 
> 赞同：2
> 
> 时间：2013-01-15T13:27:51.400
> 
> 标签：javascript, asp.net-mvc-4, tinymce

我正在尝试从 TinyMCE 获取内容，但它只返回 null。它在对话框中加载的问题。对话框视图：

```
<form>
  <textarea name="content" cols="40" rows="25" id="tinymce"> 
    Dette er noget tekst
        </textarea>
</form>

<input class="close" onclick="get_editor_content()" name="submit" type="submit" value="Kontakt Oline" style="float: right" id="contenttiny" />
<script type="text/javascript">
  tinyMCE.init({
    // General options
    mode: "textareas",
    theme: "advanced",
    plugins: "autolink,lists,spellchecker,pagebreak,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,inlinepopups,insertdatetime,preview,media,searchreplace,print,contextmenu,paste,directionality,fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras,template",
</script> 
```

打开对话框的视图：

```
<a class="openDialog" data-dialog-id="emailDialog" data-dialog-title="Kontakt/prospekt" href="/Home/tinymce">Contact US</a>

<div id="result"></div>

<script type="text/javascript">
  $.ajaxSetup({ cache: false });
  $(document).ready(function () {

    $(".openDialog").live("click", function (e) {
      e.preventDefault();
      $("<div ></div>")
        .addClass("dialog")
        .attr("id", $(this).attr("data-dialog-id"))
        .appendTo("body")
        .dialog({
          title: $(this).attr("data-dialog-title"),
          close: function () { $(this).remove() },
          modal: true,
          position: ['center', 40],
          minWidth: 670,
          resizable: false
        })
        .load(this.href);
    });
  });

  $(".close").live("click", function (e) {
    e.preventDefault();

    var content = tinyMCE.get('tinymce').getContent(); //$("#contenttiny").val();
    $.ajax({
      type: "POST",
      url: "/Home/tinymce",

      data: { "content": content },

      success: function (data) {

        $("#result").html(data.nameret);
        $(".dialog").dialog("close");
      },

      error: function (data) {
        alert("There was error processing this");
        $(this).closest(".dialog").dialog("close");
      }
    });

  });
</script> 
```

控制器：

```
[HttpPost]
public ActionResult tinymce(string content)
 {    /*Your other processing logic will go here*/
  return Json(new
  {
    nameret = content
  }, JsonRequestBehavior.

  AllowGet);
} 
```

PS[我用这个例子来创建模态对话框](http://amitraya.blogspot.dk/2012/09/modal-dialog-form-view-using-jquery.html)。这是一个部分视图。可以在主索引视图中从 tinymce 获取内容。但不在ajax调用中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T07:27:39.897

问题的解决方案相当简单。原因是 tinymce 正在返回 html 文本，默认情况下是不允许的。解决方案是改用`[ValidateInput(false)]`Controller 方法。

# ios - 添加双换行符而不是一个

> ID：14338811
> 
> 赞同：1
> 
> 时间：2013-01-15T13:27:52.543
> 
> 标签：ios, objective-c, nsstring, core-text

我正在将新行添加到字符串中，如下所示：

```
unichar newLineChar = NSNewLineCharacter;
NSString *newLineCharAsStr = [NSString stringWithCharacters:&newLineChar length:1];
NSString * newLine = [[NSString alloc] initWithString: newLineCharAsStr];
[finalString appendString: newLine]; 
```

但是在 Core Text 中呈现的结果给了我两个换行符。即两个文本块之间的空行。我只想终止一行并在新行上开始下一行（即之间没有空行）。

如果我删除了 appendString，那么文本会连续流动（即没有添加换行符），所以我可以确认我没有意外添加两次换行符。我也尝试过`NSCarriageReturnCharacter`, `NSLineSeparatorCharacter`and`NSParagraphSeparatorCharacter`以及`\r`and `\n`，但这在所有情况下都会发生。

我觉得我可能找错地方了，但有人能帮忙吗？

*更新*：我从下面提供的链接之一收集核心文本中的 '\n'*结束*一个段落，在当前行下方插入一个换行符。这可以解释为什么总是插入换行符。所以我想精炼的问题是，Core Text 中的什么会简单地换行而不是插入断句？即期望的结果是

第 1
行。第 2 行。

而不是：

第 1

行。第 2 行。

这就是我目前得到的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:37:07.220

检查此代码：

在第 3 行，我使用`newLineChar`了而不是你的`paraChar`

```
NSMutableString *finalString=[[NSMutableString alloc]initWithString:@"hi all"];

unichar newLineChar = '\n';    
NSString *newLineCharAsStr = [NSString stringWithCharacters:&newLineChar length:1];
NSString * newLine = [[NSString alloc] initWithString: newLineCharAsStr];
[finalString appendString: newLine];

[finalString appendString:@"bye now"];

 NSLog(@"==>%@",finalString); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:38:17.257

这确实是在[不使用换行符的情况下定义核心文本段落的变体答案？](https://stackoverflow.com/questions/9343787/define-core-text-paragraphs-without-using-newline-character)正如特洛伊木马所建议的那样。根本没有办法强制 Core Text 将换行符视为那样，而不是换行符。

因此，缩小段落间距以使 '\n' 只换行的唯一方法是将核心文本段落属性中的 'kCTParagraphStyleSpecifierParagraphSpacing' 和 'kCTParagraphStyleSpecifierParagraphSpacingBefore' 设置为 0.0，这就是我所做的 - 现在一切都很好.

# security - Is Shadow DOM able to secure elements?

> ID：14338817
> 
> 赞同：17
> 
> 时间：2013-01-15T13:28:10.873
> 
> 标签：security, dom, widget, web-component, shadow-dom

## Goal: an encapculated widget

Suppose I'm the developer of a widget showing a list of friends, such as:

> *Your friends Michael, Anna and Shirley love this webpage!*

## First approach: script that creates `span`

Naively, I create a script which places this information in a `span` on the website. However, the owners of ExampleSite can now access the names of your friends by simple DOM operations!
That's a big **privacy / security** issue.

## Second approach: an `iframe`

I don't want ExampleSite to have access to their friends' names. So instead, I let website owners add the widget with an `iframe`:

```
<iframe src="http://fakebook.com/friends?page=http%3A%2F%2Fexample.org%2F"></iframe> 
```

This works, because the owners of ExampleSite cannot scrape the contents of the `iframe`. However, this whole `iframe` thing is rather ugly, because it **does not integrate** into the styling of the website, while a `span` does.

## Desired approach: Shadow DOM

When reading about [Shadow Dom](http://www.html5rocks.com/en/tutorials/webcomponents/shadowdom/) yesterday, I wondered whether that could be a solution to both issues. It would allow me to have a script that creates a `span` the original website cannot access:

```
var host = document.querySelector('#friends');
var root = host.webkitCreateShadowRoot();
root.textContent = 'Your friends Michael, Anna and Shirley love this webpage!'; 
```

However, **does a Shadow DOM hide its contents from the surrounding page?**
The assumption here is that nobody except my script can access `root`, but is that correct?

The [Shadow DOM spec](http://www.w3.org/TR/shadow-dom/) after all says that it offers *functional encapsulation*, but I actually want *trust encapsulation*. And while the Component Model Use Cases actually list [this use case](http://www.w3.org/2008/webapps/wiki/Component_Model_Use_Cases#Like.2F.2B1_Button), I'm not sure whether Shadow DOM realizes the necessary *confinement* property.

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T20:39:59.013

它没有，但它正在开发中：[https ://www.w3.org/Bugs/Public/show_bug.cgi?id=20144](https://www.w3.org/Bugs/Public/show_bug.cgi?id=20144)

信任的封装将涉及为每个影子树创建一个新的脚本上下文，这对于大多数场景来说都是多余的。但是，正如 bug 所说，我们将添加一个允许这样做的标志（详细信息待定）。

# ruby-on-rails - Ruby-aware completion using neocomplcache in vim

> ID：14338825
> 
> 赞同：1
> 
> 时间：2013-01-15T13:28:25.533
> 
> 标签：ruby-on-rails, ruby, vim, neocomplcache

Suppose I'm writing a custom validation method in a Rails model:

```
validate :customer_must_be_valid 
```

And then I'm writing this method for validation:

```
def cust<TAB> 
```

And neocomplcache does not present me with the completion for `customer_must_be_valid`.

Basically the problem is that symbols are not treated as possible method names when doing completion. How can I fix this?

For reference, here's my [vimrc](https://github.com/pjg/dotfiles/blob/master/.vimrc).

### UPDATE

When pressing `Ctl``x` `Ctl``o` it doesn't show, but when I press `Ctl``x` `Ctl``p` it **does** show me the completion for the method name.

# asp.net-web-api - ASP.NET WebApi 自定义序列化

> ID：14338826
> 
> 赞同：6
> 
> 时间：2013-01-15T13:28:35.667
> 
> 标签：asp.net-web-api

我有一个返回 DataRow 对象的操作方法。不幸的是，webapi 序列化程序没有正确序列化对象。有没有什么地方可以为这种特定类型放置自定义序列化代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T14:04:56.653

您可能希望创建一个自定义 MediaTypeFormatter，它在其 CanWrite 方法中为 DataRow 类型的对象返回 true。

这是如何编写和注册自己的格式化程序的一个很好的起点：

[http://www.asp.net/web-api/overview/formats-and-model-binding/media-formatters](http://www.asp.net/web-api/overview/formats-and-model-binding/media-formatters)

# iphone - sqlite3 选择查询在 IOS6 中挂起

> ID：14338832
> 
> 赞同：0
> 
> 时间：2013-01-15T13:28:48.533
> 
> 标签：iphone, ios, objective-c, sqlite

我可以在 iOS5 中接收来自 .sql 文件（sqlite）的数据，但在 ios6 中。该应用程序正在挂起..

如果查询是`select * from Table`那么完美

如果查询是，`select *from Table order by ID DESC`那么应用程序正在挂起

有时应用程序会挂起`(sqlite3_open([dbPath UTF8String],&db) == SQLITE_OK)`

有时会挂

```
while(sqlite3_step(compiledStatement) == SQLITE_ROW)
{
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:33:42.263

完成语句并在每次执行操作时正确关闭连接，那么您应该可以使用 sqlite。如果语句没有最终确定，那么您将进入您需要处理的 SQLITE_BUSY、SQLITE_LOCKED 等状态。如果应用程序挂起，则意味着您的主线程被阻塞。以下是一个示例 sqlite 操作。

```
-(int)keyIdForImgId:(int)ImgId
{

    @同步（自我）
    {
        int keyId=0;

        sqlite3 *数据库=无；
        if (sqlite3_open([[self getDBPath] UTF8String], &database) == SQLITE_OK) {

            const char *sql = "SELECT keyId From SomeTableName WHERE imageId=?";
            sqlite3_stmt *selectstmt=nil;
            如果（sqlite3_prepare_v2（数据库，sql，-1，&selectstmt，NULL）== SQLITE_OK）{

                sqlite3_bind_int(selectstmt, 1, ImgId);

                而（sqlite3_step（selectstmt）== SQLITE_ROW）
                {

                    keyId = sqlite3_column_int(selectstmt, 0);

                }

            }
            sqlite3_finalize(selectstmt);
            sqlite3_close（数据库）；
        }
        返回密钥ID；

    }
}

```

# responsive-design - 为什么这个网站不能在 smarthpone 上正确扩展？

> ID：14338834
> 
> 赞同：0
> 
> 时间：2013-01-15T13:29:00.957
> 
> 标签：responsive-design, scale, viewport, screen-orientation

我正忙于开发[投资组合网站](http://haendehoch.nl/wp)。该网站应具有响应性，即：在较小的屏幕上浏览时应完全显示该网站。

我添加了元视口标签，但它似乎不起作用。目前，您需要水平滚动才能查看完整内容。我希望它最初缩放到视口的宽度

```
<meta name="viewport" content="width=device-width, initial-scale=1"> 
```

我想我错过了一些东西，但不知道是什么..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T20:11:24.460

我在视口方面遇到了各种问题。最后，我刚刚删除了那个愚蠢的东西的所有痕迹，现在一切似乎都正确缩放了。可能是当前的移动浏览器足够智能，可以在不使用视口的情况下进行缩放。当然，我也在使用媒体查询。

# mysql - 选择特定字段的值超过同一字段最大值一半的行

> ID：14338837
> 
> 赞同：3
> 
> 时间：2013-01-15T13:29:09.520
> 
> 标签：mysql, sql, select-query

我想知道是否有一种方法可以选择特定字段的值超过同一字段最大值一半的行。

例如，我们有一个包含 3 个字段（id、name、rate）的结果集，其中 rate 是一个别名。如果 max rate 是`70`这样，则查询应该返回所有行`rate > 35`（即`35`的一半`70`）。

就像是：

```
SELECT * FROM (A heavy and large select)as r WHERE r.rate > MAX(rate) / 2 
```

请注意，我不知道最大速率是多少，并且想在单个查询中完成。

**update**
main select 是一个非常繁重的查询，而 rate 是一个别名，因此使用 subquery for max rate 需要再次编写该繁重的查询。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:35:02.027

它基本上像你说的那样编码：

```
select * from mytable
where rate > (select max(rate) from mytable) / 2: 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T13:32:52.670

```
with cts as 
(select max(rate) as maxRate
from tableName 
)
select *
from tableName a join cts b 
on a.rate > maxRate/2 
```

尚未测试，但应该可以

对于 mysql

```
select *
from tableName a join (select max(rate) as maxRate from tableName) b 
on a.rate > b.maxRate/2 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T13:47:15.613

我认为这个未经测试的代码可能有效，

按 id、name、rate > max(rate)/2 从表组中选择 id、name、rate；

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T13:37:26.460

```
SELECT * 
FROM table a
 INNER JOIN 
   (SELECT 
      id
      ,MAX(rate) / 2 AS max_rate 
    FROM table
    GROUP BY id) b ON a.id = b.id
WHERE rate > max_rate 
```

# java - java.lang.NoSuchFieldError: APPLICATION_CONTEXT_ID_PREFIX

> ID：14338839
> 
> 赞同：1
> 
> 时间：2013-01-15T13:29:12.263
> 
> 标签：java, spring, spring-mvc

我在运行我的项目时收到此错误，结果最终是 404。该项目是在 Spring 框架上制作的。

我阅读了很多帖子，发现要么混合了罐子，要么有额外的罐子。之后我尝试整理我的罐子。以下列表是我的构建路径中的内容：

```
antlr-2.7.6.jar  
asm.jar  
asm-attrs.jar  
cglib-2.2.jar  
commons-beanutils-1.7.0.jar  
commons-collections-3.1.jar  
commons-digester-1.8.jar  
commons-email-1.0.jar  
commons-fileupload-1.1.1.jar  
commons-io-1.2.jar  
commons-lang-2.5.jar  
commons-logging-1.1.1.jar  
displaytag-1.0-b3.jar  
dom4j-1.6.1.jar  
ehcache-1.1.jar  
hibernate3.jar  
hibernate-jpa-2.0-api-1.0.0.Final.jar  
hibernate-validator-4.0.2.GA.jar  
hsqldb.jar  
itext-2.1.3.jar  
javassist-3.12.0.GA.jar  
jdom.jar  
jstl-1.2.jar  
jta-1.1.jar  
log4j-1.2.14.jar  
msbase.jar  
mssqlserver4v65.jar  
msutil.jar  
mysql.jar  
mysql-connector-java-5.1.15-bin.jar  
ojdbc14.jar  
persistence-api-1.0.jar  
poi-3.0-alpha2.jar  
servlet-2.3.jar  
slf4j-api-1.6.6.jar  
slf4j-log4j12-1.5.6.jar  
slf4j-simple-1.6.6.jar  
spring-asm-3.0.3.RELEASE.jar  
spring-beans-3.0.3.RELEASE.jar  
spring-context-3.0.3.RELEASE.jar  
spring-core-3.0.3.RELEASE.jar  
spring-expression-3.0.3.RELEASE.jar  
spring-hibernate3-2.0.8.jar  
spring-web-3.0.3.RELEASE.jar  
spring-webmvc-3.0.3.RELEASE.jar  
sqljdbc4.jar  
standard.jar  
tree.jar  
validation-api-1.0.0.GA.jar  
wloracle.jar  
wlsqlserver.jar 
```

这是堆栈跟踪

```
SEVERE: Error loading WebappClassLoader
  delegate: false
  repositories:
    /WEB-INF/classes/
----------> Parent Classloader:
org.apache.catalina.loader.StandardClassLoader@ca2dce
org.springframework.web.servlet.DispatcherServlet
java.lang.ClassNotFoundException: org.springframework.web.servlet.DispatcherServlet
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1360)
    at org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1206)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1083)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:981)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4058)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:4364)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardHost.start(StandardHost.java:719)
    at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)
    at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:443)
    at org.apache.catalina.core.StandardService.start(StandardService.java:516)
    at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)
    at org.apache.catalina.startup.Catalina.start(Catalina.java:578)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
    at java.lang.reflect.Method.invoke(Unknown Source)
    at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:288)
    at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:413)

SEVERE: Servlet.service() for servlet jsp threw exception
org.apache.jasper.JasperException: The absolute uri: http://java.sun.com/jsp/jstl/core cannot be resolved in either web.xml or the jar files deployed with this application
    at org.apache.jasper.compiler.DefaultErrorHandler.jspError(DefaultErrorHandler.java:51)
    at org.apache.jasper.compiler.ErrorDispatcher.dispatch(ErrorDispatcher.java:409)
    at org.apache.jasper.compiler.ErrorDispatcher.jspError(ErrorDispatcher.java:116)
    at org.apache.jasper.compiler.TagLibraryInfoImpl.generateTLDLocation(TagLibraryInfoImpl.java:315)
    at org.apache.jasper.compiler.TagLibraryInfoImpl.<init>(TagLibraryInfoImpl.java:148)
    at org.apache.jasper.compiler.Parser.parseTaglibDirective(Parser.java:420)
    at org.apache.jasper.compiler.Parser.parseDirective(Parser.java:483)
    at org.apache.jasper.compiler.Parser.parseElements(Parser.java:1433)
    at org.apache.jasper.compiler.Parser.parse(Parser.java:133)
    at org.apache.jasper.compiler.ParserController.doParse(ParserController.java:216)
    at org.apache.jasper.compiler.ParserController.parse(ParserController.java:103)
    at org.apache.jasper.compiler.Compiler.generateJava(Compiler.java:153)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:314)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:294)
    at org.apache.jasper.compiler.Compiler.compile(Compiler.java:281)
    at org.apache.jasper.JspCompilationContext.compile(JspCompilationContext.java:566)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:317)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:337)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:266)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:803)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:290)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:206)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:233)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:128)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:286)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:844)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:583)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:447)
    at java.lang.Thread.run(Unknown Source) 
```

我删除了许多我认为重复的罐子。
我的问题是所有这些罐子是否足够或是否有重复？
请帮助，这个404正在杀死我......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:31:51.697

你有很多重复的罐子：

```
antlr
jta
mysql-connector
javassist
mssqlserver 
```

在继续之前，我会确保您只有一个，确定您需要的版本并包含该版本。

如果您不确定如何执行此操作，请告诉我们您是如何导入依赖项的。

查看您所看到的堆栈跟踪和导致错误的简化 Spring 上下文也会很有帮助。

* * *

如果你看这个问题：[JasperException: absolute uri: http://java.sun.com/jsp/jstl/core cannot be resolve](https://stackoverflow.com/questions/2427486/org-apache-jasper-jasperexception-the-absolute-uri-http-java-sun-com-jsp-jst)

您需要确保您拥有正确版本的 JSTL，也许一旦您删除了重复的 JSTL，它可能会修复该错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:56:09.753

我的猜测是删除 spring.jar 和 spring-1.2.6.jar ；它们与 spring*3.0.3.RELEASE.jars 冲突

在使用 spring 框架时，我的两分钱将使用 maven。

# c# - 删除 MS 图表中 x 轴的端点

> ID：14338843
> 
> 赞同：1
> 
> 时间：2013-01-15T13:29:30.243
> 
> 标签：c#, graph, mschart

我有一个图表（见附图），我想删除端点“2060”和“2020”。我希望间距保持不变。但我想隐藏标签 2060 和 2020。有没有办法可以使用 MS Chart 以编程方式实现这一点？

![删除结束标签](../Images/86647b786fb592a2161c200281a46c5d.png)

创建轴的代码：

```
 var area = new ChartArea();

        chart.ChartAreas.Add(area);
        chart.ChartAreas[0].Position.X = 5;
        chart.ChartAreas[0].Position.Y = 10;
        chart.ChartAreas[0].Position.Height = 80;
        chart.ChartAreas[0].Position.Width = 80;
        chart.ChartAreas[0].AxisX.LabelStyle.Font = font10Point;
        chart.ChartAreas[0].AxisY.LabelStyle.Font = font10Point;
        chart.ChartAreas[0].AxisX.Title = "Target Date Fund";
        chart.ChartAreas[0].AxisY.Title = "% Up Capture";

        chart.ChartAreas[0].AxisX.TitleFont = font10Point;
        chart.ChartAreas[0].AxisX.MajorGrid.LineColor = Color.Transparent;
        chart.ChartAreas[0].AxisY.MajorGrid.LineColor = Color.Black;
        chart.ChartAreas[0].BorderColor = Color.Black;
        chart.ChartAreas[0].Position = new ElementPosition(0, 10, 75, 85);

        chart.Series[0].YAxisType = AxisType.Secondary;
        chart.ChartAreas[0].AxisY.LabelStyle.Enabled = false;
        chart.ChartAreas[0].AxisX.Crossing = 2060; 
        chart.ChartAreas[0].AxisX.IsReversed = true;
        area.AxisX.Minimum = 2020; 
        area.AxisX.Maximum = 2060; 
        area.AxisX.Interval = 10;
        area.AxisX.LineWidth = int.Parse("5");
        area.AxisX.MajorTickMark.LineWidth = int.Parse("5");
        area.AxisY.MajorTickMark.LineWidth = int.Parse("5");

        area.AxisY.Minimum = area.AxisY2.Minimum = 0;
        area.AxisY.Maximum = area.AxisY2.Maximum = 120;
        area.AxisY.Interval = area.AxisY2.Interval = 20;
        area.AxisY.LineWidth = int.Parse("5"); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T14:27:14.813

您可以使用[`LabelStyle.IsEndLabelVisible`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datavisualization.charting.labelstyle.isendlabelvisible.aspx)属性：

```
area.AxisX.LabelStyle.IsEndLabelVisible = false; 
```

# indentation - 如何防止“缩进”将大括号移动到下一行？

> ID：14338849
> 
> 赞同：0
> 
> 时间：2013-01-15T13:29:44.057
> 
> 标签：indentation

我在 C++ 中有几个空的内联函数定义，如下所示：

```
class C
{
    void foo(){}
    void bar(){}
}; 
```

现在，如果我跑`indent -st -i4 -nut test.cc`只是为了修复我得到的缩进

```
class C
{
    void foo ()
    {
    }
    void bar ()
    {
    }
}; 
```

但我只想在不移动花括号的情况下修复缩进！

我怎样才能做到这一点？

# java - 如何在 PHP / JAVA 组合中找到 Java 可执行文件/对象？

> ID：14338851
> 
> 赞同：-1
> 
> 时间：2013-01-15T13:29:53.353
> 
> 标签：java, php, zend-framework2

我最近有一个项目，它似乎是 PHP 和 Java 的混合使用 zend 桥 ( [http://files.zend.com/help/previous-version/Zend-Server-5-IBMi/java_bridge_component.htm](http://files.zend.com/help/previous-version/Zend-Server-5-IBMi/java_bridge_component.htm) )。有一个这样的块 {code} $Catalog = new Java("CatalogFinder"); {代码} 。有人可以告诉我如何找到“目录查找器”文件 /executable 吗？我知道 Zend 调用 JAVA 并代理对象，但我需要查看 java 文件本身，但我不知道如何找到它。免责声明：我知道这是一个愚蠢的问题；也许我应该在 Java 论坛上问它？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:36:49.250

查找名为“CatalogFinder.java”（源代码）或“CatalogFinder.class”（编译类）的文件。后者可能嵌入在 ZIP 或 JAR 文件中。

# asp.net-mvc - 调试时 Visual Studio 不更新 cshtml 文件

> ID：14338857
> 
> 赞同：3
> 
> 时间：2013-01-15T13:30:11.973
> 
> 标签：asp.net-mvc, debugging, razor, visual-studio-2012

我对我的 cshtml 文件进行了一些更改以调试错误（当然是一匹马）。但是即使我保存了文件，当我实际调试时这些更改也没有反映出来？这是非常奇怪的行为。CSHTML 文件是否缓存在某个神奇的目录中？如果是在哪里。如果不是，我怎样才能清除我的缓存以调试问题？

**更新：查看加载的模块**

在回忆起我如何调试附加到 WCF 服务的一些问题后，我决定看看是否可以在我的机器上找到本地加载的符号。我能够导航到临时 ASP.net Files\root 目录。他们我搜索了一直困扰我的 cshtml 文件。我得到的是带有附加后缀的文件名.a2269a6c_CBMResult.ccu。有没有人知道该文件名的含义以及它与原始文件的关系。如果我删除它，asp.net 会重新生成文件并因此刷新 cshtml 文件吗？

# jquery - jQuery 表格排序器

> ID：14338861
> 
> 赞同：1
> 
> 时间：2013-01-15T13:30:24.897
> 
> 标签：jquery, tablesorter

是否可以仅使用 jQuery tablesorter 隐藏某些列的过滤器？前三列不需要过滤器（它们只会使表格更长）。

```
<table id="userTable"  class="table-sorter table table-striped table-bordered">
    <thead>
        <tr>
            <th>
                <input type="checkbox" /></th>
            <th></th>
            <th></th>
            <th></th>
            <th>Login
            </th>
            <th>Email
            </th>
            <th>Company
            </th>
            <th>LastName
            </th>
            <th>FirstName
            </th>
            <th>ZipCode
            </th>
            <th>City
            </th>
            <th class="filter-select" data-placeholder="Select">Country
            </th>
        </tr>
    </thead> 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T13:36:03.807

我不记得 jQuery 有一个原生的 tablesorter 插件，所以我认为你使用这个：[http ://tablesorter.com/docs/](http://tablesorter.com/docs/)

如果您低头看配置选项。您将看到“标题”可用于通过传递选项手动禁用标题排序：`{ 0: { sorter: false}, 1: {sorter: false} }`这将禁用前 2 列的排序。

只需阅读该文档，您就应该得到它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T08:53:57.897

我通过隐藏前四个输入字段来解决它。

```
// remove filters from first 4 columns
        for (var i = 0; i < 4; i++) {
            $('input[data-column='+i+']').hide();
        } 
```

不知道这是否是正确的方式。但它的工作原理。格茨丹尼

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T09:12:07.523

如果您只想隐藏它们，那么您可以执行以下操作：

```
// Index starts at 0 so you want to hide elem 0, 1, 2 and 3
$('input:lt(4)').hide(); 
```

这隐藏了第一个输入。示例：http: [//jsfiddle.net/VWkJZ/](http://jsfiddle.net/VWkJZ/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T14:05:22.843

看起来您正在使用我的[tablesorter](http://mottie.github.com/tablesorter/docs/)分支和过滤器小部件。因此，为特定列禁用过滤器所需要做的就是将类名添加`filter-false`到`th`：

```
<table id="userTable"  class="table-sorter table table-striped table-bordered">
    <thead>
        <tr>
            <th class="filter-false">
                <input type="checkbox" /></th>
            <th class="filter-false"></th>
            <th class="filter-false"></th>
            <th class="filter-false"></th>
            <th>Login</th> 
```

这样做是它仍然将过滤器添加到过滤器行，但输入被禁用。然后你需要做的就是添加这个css：

```
/* hide disabled filter inputs */
.tablesorter-filter.disabled {
  display: none;
} 
```

这是我上面描述[的演示。](http://jsfiddle.net/Mottie/abkNM/217/)

# windows-8 - 使用javascript在Windows 8应用程序中从本地主机列出文件和文件夹

> ID：14338862
> 
> 赞同：0
> 
> 时间：2013-01-15T13:30:25.040
> 
> 标签：windows-8

如何在 Windows 8 应用程序中使用 JavaScript 而不是使用文件选择器在 localhost 中列出文件和文件夹？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:06:19.710

我认为“本地主机”是指应用程序的本地存储中的内容？即，ms-appdata:///local?

[如果是这样，您可以获取对本地文件夹](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.applicationdata.localfolder.aspx)顶级存储的引用。然后使用[StorageFolder](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.storagefolder.aspx)的方法（如[GetFilesAsync](http://msdn.microsoft.com/en-us/library/windows/apps/br227276.aspx)和[GetFoldersAsync](http://msdn.microsoft.com/en-us/library/windows/apps/br227280.aspx)）来导航层次结构。有一些重载使用[CommonFolderQuery](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.search.commonfolderquery.aspx)来实现一些附加功能。

如果您尝试访问该机器上文件系统的其他方面，则需要向用户请求许可（通过文件/文件夹选择器），但是一旦授予该许可，它包括所有子文件夹，您可以保留您通过[AccessCache](http://msdn.microsoft.com/en-us/library/windows/apps/br207498.aspx)获得该权限的事实，并且不要在后续运行中询问。

# spring-annotations - Spring数据和neo4j的正确注释配置是什么

> ID：14338863
> 
> 赞同：5
> 
> 时间：2013-01-15T13:30:26.130
> 
> 标签：spring-annotations, spring-data-neo4j

我正在尝试使用带有`@configuration`类的 Neo4j 配置 Spring-data，但我找不到任何关于如何正确执行此操作的参考资料，并且我在下一个问题之后遇到了一个问题。到目前为止，这是我拼凑起来的：

```
package reservation.configuration;

import org.neo4j.graphdb.GraphDatabaseService;
import org.neo4j.kernel.EmbeddedGraphDatabase;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.neo4j.config.EnableNeo4jRepositories;
import org.springframework.data.neo4j.repository.GraphRepositoryFactory;
import org.springframework.data.neo4j.support.Neo4jTemplate;
import org.springframework.data.neo4j.support.mapping.Neo4jMappingContext;

@Configuration
@EnableNeo4jRepositories("reservation.repository.neo4j")
public class Neo4jConfig {

    private static final String STORE_ID = "helloworld";

    @Bean
    public GraphDatabaseService graphDatabaseService() {
        return new EmbeddedGraphDatabase(STORE_ID);
    }

    @Bean
    public Neo4jTemplate neo4jTemplate() {
        return new Neo4jTemplate(graphDatabaseService());
    }

    @Bean
    public GraphRepositoryFactory graphRepositoryFactory() {
        return new GraphRepositoryFactory(neo4jTemplate(), neo4jMappingContext());
    }

    @Bean
    public Neo4jMappingContext neo4jMappingContext() {
        return new Neo4jMappingContext();
    }
} 
```

我在启动应用程序时遇到的例外情况如下。有什么建议么？

```
java.lang.IllegalStateException: No persistence exception translators found in bean factory. Cannot perform exception translation.
    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.detectPersistenceExceptionTranslators(PersistenceExceptionTranslationInterceptor.java:142)
    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.setBeanFactory(PersistenceExceptionTranslationInterceptor.java:118)
    at org.springframework.data.repository.core.support.TransactionalRepositoryProxyPostProcessor.<init>(TransactionalRepositoryProxyPostProcessor.java:66)
    at org.springframework.data.repository.core.support.TransactionalRepositoryFactoryBeanSupport.setBeanFactory(TransactionalRepositoryFactoryBeanSupport.java:85)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeAwareMethods(AbstractAutowireCapableBeanFactory.java:1506)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1474)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:524)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:461)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:295)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:223)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:292)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:589)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:932)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:479)
    at org.springframework.web.servlet.FrameworkServlet.configureAndRefreshWebApplicationContext(FrameworkServlet.java:647)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:598)
    at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:661)
    at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:517)
    at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:458)
    at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:138)
    at javax.servlet.GenericServlet.init(GenericServlet.java:160)
    at org.apache.catalina.core.StandardWrapper.initServlet(StandardWrapper.java:1228)
    at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1147)
    at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:1043)
    at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4957)
    at org.apache.catalina.core.StandardContext$3.call(StandardContext.java:5284)
    at org.apache.catalina.core.StandardContext$3.call(StandardContext.java:5279)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
    at java.util.concurrent.FutureTask.run(FutureTask.java:138)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
    at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T17:36:32.300

从以下内容扩展后，我设法将其归结为`Neo4jConfiguration`：

```
@Configuration
@EnableNeo4jRepositories("reservation.repository.neo4j")
public class Neo4jConfig extends Neo4jConfiguration {

    private static final String DB_PATH = "/Temp/neo4j";

    @Bean
    public GraphDatabaseService graphDatabaseService() {
        return new EmbeddedGraphDatabase(DB_PATH);
    }
} 
```

这似乎工作得很好。

# jquery - 检查是否单击了按钮并在单击功能之外返回警报

> ID：14338865
> 
> 赞同：1
> 
> 时间：2013-01-15T13:30:31.083
> 
> 标签：jquery, click

我想看看是否单击了按钮。如果它被单击，则在单击函数之外返回警报。这是我的代码：

```
$(document).ready(function() {
  var test = 0;
  $('body').on('click', '#publish', function() {
    test = 1;
  });

  if(test == 1) {
    alert('jay!');
  }
}); 
```

不是它在单击时不显示警报窗口。为什么？我必须在 click 函数中使用 if 语句吗？我希望此代码按原样工作。

[http://jsfiddle.net/edgren/TXERr/](http://jsfiddle.net/edgren/TXERr/)

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T13:33:26.083

您的代码无法工作，因为该`if`语句是在单击事件之前执行的。（并且作为旁注：作为一种良好做法，始终在比较中使用三等式）

改为

```
$(document).ready(function() {
  var test = 0;

  function checkTest() {
    if(test === 1) {
       alert('jay!');
    }
  }

  $('body').on('click', '#publish', function() {
    test = 1;
    checkTest();
  });

}); 
```

# jquery - jQuery - toggleClass 向上箭头和向下箭头图标更改

> ID：14338866
> 
> 赞同：1
> 
> 时间：2013-01-15T13:30:33.623
> 
> 标签：jquery, toggleclass

我有两个容器，每个容器都有自己的标题和箭头图标，以指示切换可以发生的方向。

加载时，容器 1 以向上箭头图标打开（表示内容可以折叠）。加载时，容器 2 以向下图标关闭（表示内容可以展开）。

当我单击其中任何一个时，我想使用 slideToggle 和 toggleClass 来防止另一个框关闭，从而允许用户查看两个框内的内容以及折叠两者的能力。

单击每个标题时，如何确保箭头图标交替出现？

最重要的部分是容器 1 在装载时打开，容器 2 在装载时关闭。（导致加载时出现相反的图标）

提前致谢！

```
<xsl:template name="Alert-Wrapper">
<xsl:variable name="Rows" select="/dsQueryResponse/Rows/Row" />
<div id="alert-wrapper">

    <div class="accordion-header expandable-header">
        <span class="accordion-header-style">New Alerts</span>
    </div>

    <div class="alert-item-container expandable-content">
        <xsl:for-each select="$Rows">
            <xsl:call-template name="alert-items"/>
        </xsl:for-each>    

        <div class="view-more-alerts">
            <a href="www.google.com">
                <span class="view-more-image"><img src="/mountney.co.uk/images/Red-Arrow-View-More.png"></img></span>
                <span class="view-more-text">View more alert items</span>
            </a>
        </div>              
    </div>          
    <div class="clear"></div>
</div> 
```

以下 jquery 处理内容的展开和折叠。

```
 $('.expandable-header').click(function(){

    $(this).next('.expandable-content').slideToggle('slow');    

    }); 
```

我只需要修改'.accordion-icon'背景图片来改变（这是标题的背景图片）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:44:55.260

最简单的解决方案，没有 jQuery 动画：

```
$(function(){
  $('.header').click(function(){
    $(this).closest('.container').toggleClass('collapsed');
  });
}); 
```

使用 CSS3 过渡的演示：http: [//jsfiddle.net/AMzfe/](http://jsfiddle.net/AMzfe/)

# algorithm - 需要 Graph 算法的解决方案

> ID：14338870
> 
> 赞同：3
> 
> 时间：2013-01-15T13:30:48.163
> 
> 标签：algorithm, graph

问题：

给定所有航班的时间表，找出飞机运营商所需的最少飞机数量。

因此，给定所有航班的时间表（来源、目的地、出发时间、旅程持续时间），我们需要找到运营商所需的最少飞机数量。

当飞机完成一次旅行时。开始另一趟旅程至少需要 50 分钟。

编辑：我无法提出解决方案..

我尝试将每次旅行作为一个节点制作一个图。如果第一个节点的目的地与第二个节点的源相同，并且第二个节点的开始时间是旅程完成后的 50 分钟，那么第一个节点到第二个节点之间存在有向边的第一个节点。

任何帮助将不胜感激如何进行..

注意：我在微软的一次采访中被问到这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T18:41:13.003

如果我没听错的话，有起点城市和终点城市，我们需要找到以最少航班从起点城市到达目的地城市的方式。那样可以么？

我如何看待动态规划的解决方案，让我们可以使用仅使用航班`dp[i][j]`到达城市的最佳时间。一开始，所有元素都设置为。我们将尝试在每一步更新它。因此，算法将如下所示：`i``j``dp``infinity`

```
 dp[0][0] = 0;
    priority_queue< pair<int,int> >  q;
    q.Add( make_pair(0,0) );
    /*in q we store pair, where first is time of arrival in city,
        and the second is THAT city.*/

        while there are element is queue {
           x = the first one element ( where time is the smallest )
           remove first element from queue
            if x.city == destination city 
                 break cycle;
           then 
              for all j
                 if dp[x.city][j] < x.time + 50 
                     for all flights(from, to) where from==x.city we try to update
                         if( dp[to][j+1] < dp[x.city][j] + 50 + jurney_duration ) {
                             dp[to][j+1] = dp[x.city][j] + 50 + jurney_duration ;
                            q.add( make_pair(dp[x.city][j] + 50 + jurney_duration, to) );
                      }
              } 
```

所以，要找到答案，我们只需要找到最小的`x`where `dp[final_dest][x] != infinity`，这`x`就是答案。

效率将是`O(n*n*m)`，因为`while-cycle`我们的主体只会运行`n`次数（ where `n - number of cities`），而循环有两个循环`n`和`m`。我们将`for-cycle`仅先运行 n 次，因为该路径将使用少于`N`航班 - 没有理由返回您之前所在的城市。

**编辑：** 实际上，如果我们将像[邻接列表](http://en.wikipedia.org/wiki/Adjacency_list)这样的航班信息存储起来，我们可以获得更好的效率：O(n*m)，因为例如，如果编号为 m 的城市与m [i]`i`相邻，我们将得到 N*m [0] + N*m [1] + ... + N*m [N] = N*(m [0] + m [1] + ... + m [n] ) = N*M，因为 m [i] th 的总和 == M. (M 代表航班总数）。 [有关优先级队列的更多详细信息](http://en.wikipedia.org/wiki/Priority_queue)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T14:19:12.357

正如问题所述，它实际上非常简单。

```
Order the flight list by the departure time. 
Start with 0 planes.
For every flight, 
  look if there's a plane available at the source at the time of departure
  If yes, select it, else add a new plane and select it.
  Mark the plane as available at the destination at time of arrival + preparation
Return # of planes used 
```

### 笔记

*   这个算法不允许飞机比时间表中的其他航班飞行，这就是我理解这个问题的方式。如果允许，这种贪婪的解决方案将不再适用。
*   这很容易，因为它与现实世界的情况相去甚远。如果将例如价格和容量引入问题，它会变得更加棘手

# firefox-addon - 如何在 Mozilla Firefox 扩展中检测当前选项卡的 mime 类型？

> ID：14338874
> 
> 赞同：1
> 
> 时间：2013-01-15T13:31:00.597
> 
> 标签：firefox-addon, mime-types, firefox-addon-sdk, pdf.js

我正在尝试做与[这里](https://stackoverflow.com/questions/4921175/how-can-i-detect-the-current-tabs-mime-type-in-a-google-chrome-extension)问题中所问相同的事情，唯一的意义区别是使用 Mozilla Firefox 而不是 Google Chrome / Chromium。

我已经尝试使用[Mozilla JetPack](https://wiki.mozilla.org/Jetpack) SDK，到目前为止，使用 Mozilla 的 pdf.js 查看器加载的所有内容似乎都被读取为`text/html`. 在 Firefox 中使用 Jetpack（甚至 XUL）是否有正确的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:30:45.563

`document.baseURI`我认为您可以通过检查属性是否设置为来检测使用 pdf.js 呈现的 pdf`"resource://pdf.js/web/"`

# gwt - gwt 分离列表

> ID：14338875
> 
> 赞同：2
> 
> 时间：2013-01-15T13:31:00.733
> 
> 标签：gwt

谁能向我解释一下，分离列表是什么，可以在网络上如此频繁地找到“具有现有父小部件的小部件可能不会添加到分离列表中”。我找不到解释或任何背景信息，只有错误消息。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T14:50:42.997

作为[内存泄漏缓解](https://code.google.com/p/google-web-toolkit/wiki/DomEventsAndMemoryLeaks)的一部分（IE 中大多数情况下，如果不是唯一需要的话），GWT 具有*附加*和*分离*小部件的概念。每当您将一个小部件作为子小部件添加到另一个*附加*小部件时，该子小部件及其所有子小部件也会被*附加*，并且相反，当您从其*附加*的父小部件中删除一个小部件时，它会与其所有子部件一起*分离*。当一个小部件被分离时，它应该释放所有可能导致内存泄漏的资源。

上面构建了*附加*小部件的树，但是树需要一个根。有两种这样的根*附加*小部件::`RootPanel`总是附加的，通过`wrap()`ping 现有 DOM 元素创建的小部件也会自动*附加*。

当页面卸载时，GWT 确保分离所有小部件以避免内存泄漏。为此，它在所谓的*分离列表中跟踪**根附加*的小部件，并确保应该是*根*小部件的小部件实际上是根（即它们的元素不包含在另一个小部件的 DOM 子树中）。此规则的唯一例外是因为它代表所有其他小部件所在的文档。**`RootPanel.get()``<body>`**

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:50:04.310

分离列表是页面卸载时要分离的小部件列表（[来源](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/RootPanel.html#detachOnWindowClose%28com.google.gwt.user.client.ui.Widget%29)，只猜测其中一个来源）。
基本上（以下不是完整的解释，如果您愿意阅读官方 google 文档，GWT 有很好的文档说明），在 GWT 中，当您创建一个小部件时，该小部件在添加到 RootPanel 之前不会显示，或者附加到 RootPanel 的任何小部件（成为其父级）。有一些操作（例如我之前指出的链接）会导致小部件与 RootPanel 分离；但是，您不能调用`RootPanel.detachNow(widget)`嵌入在父级中的小部件。这样的调用将导致您要求的异常。**

# graph-algorithm - 在无向加权树中找到最长的路径

> ID：14338877
> 
> 赞同：1
> 
> 时间：2013-01-15T13:31:04.810
> 
> 标签：graph-algorithm

我有一棵树，其中每条边都被分配了一个权重（一个可以是正数或负数的实数）。我需要一种算法来找到最大总权重的简单路径（即路径中边的权重之和最大的简单路径）。路径开始或结束的节点没有限制。

我有一个可能的算法，但我不确定它是否有效，我正在寻找一个证据。这里是：

1.  选择任意节点*u*并运行 DFS( *u* ) 以找到从*u*开始的最大权重简单路径。让 ( *u* , *v* ) 成为这条路径。
2.  运行 DFS( *v* ) 以找到从*v*开始的最大权重简单路径。让这条路径是（*v*，*z*）。

那么 ( *v* , *z* ) 是最大权重的简单路径。该算法在图的大小上是线性的。谁能告诉我它是否有效，如果有效，请提供证据？

**注意：**对于具有循环的一般图，[最长路径问题是 NP-Hard。](http://en.wikipedia.org/wiki/Longest_path_problem)但是，我在这里只考虑树。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:41:51.680

如果您允许负权重，请考虑以下示例：

```
a<->b : -5000
a<->c : 1
b<->d : 1
b<->e : 1 
```

最长的路径是*d<->b<->e*，长度为 2

随便挑*一个*开始。DFS 返回距离为 1 的*c*。第二个 DFS 返回距离为 1 的*a*。但是*a<->c*不是最长的路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T15:28:34.703

如果您确定图中没有循环，我会尝试以下操作：

```
function findLongestPath(tree)
begin

   all_paths := {}

   for each neighbour 
      all_paths.append(create_path(this_node, findLongestPath(three - current_node))

   sort_descending(all_paths)
   return  all_paths[0];
end 
```

该算法可以进一步优化以仅存储最佳路径而不是一组（无需存储所有可能的路径和排序）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T14:46:59.040

这是它有效的证明。该算法找到一对节点 x0,y0 使得 max_x d(x,x0) = max_y d(x0,y)（即 x0 和 y0 是彼此最远的节点）。对于任何这样的对，d(x0,y0) 是直径。证明：设 x*,y* 为两个节点 st d(x*,y*) 为直径。存在节点 r 和 s，因此路径看起来像 x0--r--s--y0 和 x*--r--s--y*。假设 d(x0,y0) < d(x*,y*)，则 d(x0,y*) > d(x0,y0) 或 d(y*,x0) > d(y0,x0)，矛盾x0 和 y0 是彼此最远的点这一事实。因此 d(x0,y0)=d(x*,y*)

# joomla - Joomla Component 2.5 数据从模型查看QUERY麻烦

> ID：14338878
> 
> 赞同：0
> 
> 时间：2013-01-15T13:31:06.897
> 
> 标签：joomla, components

我正在开发一个 Joomla Component 2.5，目前我正忙于从我的模型中检索数据。我正在使用以下查询来检索数据：

**在我的模型中：**

```
 public function test() {
    $db = JFactory::getDbo();

    $query = $db->getQuery(true);
    $query ->select(array('desc')) ->from('PC_APIData');

    $db->setQuery($query);

    $results = $db->loadObjectstdClass();

} 
```

**在我的 view.html.php 中：**

```
 $InternetModelInternet = &$this->getModel('Internet');
    $test = $InternetModelInternet->test();
    $getData = $InternetModelInternet->getData();

    var_dump($getData); 
```

我可以检索数据的唯一方法是使用 vardump 它向我显示我需要的数据。但是我怎样才能在返回或回声中解决这个问题？因为当我使用其中之一时，结果为 NULL。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T14:23:58.023

在你的模型中试试这个。

```
 public function test() {
    $db = JFactory::getDbo();

    $query = $db->getQuery(true);
    $query ->select(array('desc')) ->from('PC_APIData');

    $db->setQuery($query);

    $results = $db->loadObjectstdClass(); 
     //loadObjectList,loadObject or any other methods you can use for fetching based on list or single row. any way the result return as array.
    return $result;

    } 
```

在你看来

```
 $InternetModelInternet = &$this->getModel('Internet');
 $test = $InternetModelInternet->test();
 echo "<pre>";
 print_r($test). 
```

根据您的查询条件，结果应该是数组，可以是列表或单个。

您应该以任何方式从模型返回结果，然后只有您才能在视图或控制器中获得它。有关 Joomla db 查询的更多详细信息，[请查看此处](http://docs.joomla.org/Accessing_the_database_using_JDatabase/2.5#The_Query)

您也可以像这样编写查询。

```
 $db = JFactory::getDbo();
 $sql ="your detailed query";
 $db->setQuery($sql);
 $db->query();
 $res = $db->loadObjectList();
 return $res; 
```

希望这可以帮助你..

# facebook - Facebook Like 显示负数

> ID：14338879
> 
> 赞同：5
> 
> 时间：2013-01-15T13:31:08.557
> 
> 标签：facebook, facebook-like

我的 Facebook Canvas 应用页面上的“赞”按钮不起作用： [https ://apps.facebook.com/bzodiac/](https://apps.facebook.com/bzodiac/)

1.  星座下方的点赞按钮，上面写着“爱你的星座？” 弹出评论框，但是，它立即消失并且按钮的数量没有增加。
2.  如果刷新页面，按钮将显示为灰色，好像它已经“喜欢”但在计数框中显示“0”。
3.  将鼠标悬停在按钮上并单击小“X”以“不喜欢” - 您会看到计数设置为 -1。
4.  在整个过程中，没有类似的提要发布到时间线或通知中 - 没有。
5.  如果我切换到“推荐”文本，它工作正常。

总而言之，like 按钮似乎已损坏。有趣的是，如果我将其切换为“推荐”，它会突然按预期工作。

这是我喜欢按钮的标记：

```
<div class="fb-like" data-href="<?php echo $horoscopeFBObjectUrl; ?>" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false"></div> 
```

点赞按钮`data-href`指向这个页面：[https](https://bzodiac.herokuapp.com/fbObject.php?sign=pisces) `pisces` ://bzodiac.herokuapp.com/fbObject.php?sign=pisces是根据你的星座替换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T22:28:10.823

参考：[https ://developers.facebook.com/docs/reference/plugins/like/migration/](https://developers.facebook.com/docs/reference/plugins/like/migration/)

> 如果您还没有，您可能需要添加所有必需的 og:tags。

**为迁移做准备**

迁移生效时，在其网站上使用 Like Button 社交插件的 Facebook 开发人员应准备以下内容：

1.  所有使用 Like Button 社交插件的 Open Graph 对象页面都应包含 fb:app_id Open Graph 元标记。即使未指定 fb:app_id 元标记，Like 按钮仍将继续起作用，但通过指定此元标记，开发人员将能够使用他们拥有的 Like 按钮测试迁移。
2.  fb:app_id 应设置为 Facebook 应用程序的应用程序 ID，表示 Open Graph 对象所在的特定站点或产品。

# android - 如何在 android 项目中使用 ActionbarSherlock & ViewPagerIndicator

> ID：14338881
> 
> 赞同：0
> 
> 时间：2013-01-15T13:31:11.857
> 
> 标签：android, actionbarsherlock, viewpagerindicator

我如何使用 ActionBar Sherlock 和 ViewPageerIndicaor ？我想设置操作栏和标签指示器，可以吗？坦克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T16:42:06.240

ViewPageIndicator 是 ViewPager 的扩展看看这两种实现你会看到一些类似的方法，如果我正确识别它，逻辑顺序应该是这样的：

viewpageindicator 包含 viewpager 和 viewpageradapter，因此不是直接在 viewpager 上设置适配器，而是需要在指示器上设置它

# ruby-on-rails - Ruby on Emacs Package Installation

> ID：14338882
> 
> 赞同：0
> 
> 时间：2013-01-15T13:31:16.493
> 
> 标签：ruby-on-rails, ruby, emacs, ruby-mode

In reference to [indent ruby code on the fly in emacs](https://stackoverflow.com/questions/11305600/indent-ruby-code-on-the-fly-in-emacs), how do I make a minor mode fire up automatically after a major mode is entered?

Basically, when I open a Ruby file (which opens in `ruby-mode`), I would like `electric-indent-mode` to start up automatically.

Also, I tried installing `ruby-end` but it is not working. I copied the `ruby-end.rb` into `~/.emacs.d` and added the following into `init.el`:

```
(add-to-list 'load-path "ruby-end")
(require 'ruby-end) 
```

I also `ruby-end.pl` and I get the same error. Here is the result of `--debug-init`'s error:

```
Debugger entered--Lisp error: (file-error "Cannot open load file" "ruby-end")
2   require(ruby-end)
3   eval-buffer(#<buffer  *load*> nil "/Users/nayef/.emacs.d/init.el" nil t)  ; Reading at buffer position 1392
4   load-with-code-conversion("/Users/nayef/.emacs.d/init.el" "/Users/nayef/.emacs.d/init.el" t t)
5   load("/Users/nayef/.emacs.d/init" t t)
6   #[0 "^H\205\262^@     \306=\203^Q^@\307^H\310Q\202;^@ \311=\204^^^@\307^H\312Q\202;^@\313\307\314\315#\203*^@\316\202;^@\313\307\314\317#\203:^@\320\nB^R$
7   command-line()
8   normal-top-level() 
```

Any ideas? Does anyone have pointers on Ruby on Rails development in Emacs? I use command-line based text Emacs 24.2.1.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T19:54:11.407

要解决您在这里遇到的具体问题，`load-path`应该包含目录，而不是文件路径。所以，试试这个：

```
(add-to-list 'load-path (expand-file-name "~/.emacs.d"))
(require 'ruby-end) 
```

顺便说一句，我还是更喜欢旧的`ruby-electric`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T14:27:22.437

`electric-indent-mode`是一种全局次要模式（即它适用于所有模式中的所有缓冲区），因此只需在 .emacs 中启用一次，无需使用钩子。

# c++ - 未找到使用表达式模板化的静态 constexpr 成员函数

> ID：14338887
> 
> 赞同：13
> 
> 时间：2013-01-15T13:31:39.623
> 
> 标签：c++, templates, c++11, constexpr, using-directives

对于以下代码

```
#include <array>

template<unsigned MaxP, typename type>
struct kernel
{
  static constexpr unsigned max_pole(unsigned P)
  { return P>MaxP? MaxP:P; }

  template<unsigned P>
  using array = std::array<type,max_pole(P)>;          // wrong?

  template<unsigned P>
  static void do_something(array<P> const&, array<P>&);
}; 
```

gcc 4.7.0 (g++ -c -std=c++11) 给出

```
error: ‘max_pole’ was not declared in this scope 
```

这是正确的（编译器的行为）吗？请注意，如果我通过在指示的行上`max_pole`替换它来解决`kernel::max_pole`，它编译得很好。

**编辑**报告给 bugzilla，被接受为 bug c++/55992，见[http://gcc.gnu.org/bugzilla/show_bug.cgi?id=55992](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=55992)。gcc 4.7.x 和 4.8.0 也会出现。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T13:39:53.757

您的模板可以使用 Clang 3.2 正常编译。我坚信这是一个 GCC 错误（顺便说一句，它也存在于 GCC 4.7.2 中）。GCC 4.8.0 的更改说明似乎没有提到任何此类错误修复。

另请注意，如果您删除 的声明，编译错误就会消失`do_something<>`，这不会有任何区别。

还有一个提示：虽然这个模板**不能**在 GCC 4.7.2 上编译：

```
template<unsigned MaxP, typename type>
struct kernel
{
    static constexpr unsigned max_pole(unsigned P)
    { return P>MaxP? MaxP:P; }

     template<typename T>
     using array2 = int[max_pole(3)]; // ERROR!

     static void do_something(array2<int> const&, array2<int>&);
}; 
```

这个模板**确实**编译：

```
template<unsigned MaxP, typename type>
struct kernel
{
    static constexpr unsigned max_pole(unsigned P)
    { return P>MaxP? MaxP:P; }

     // template<typename T>  <--- removed
     using array2 = int[max_pole(3)]; // OK

     static void do_something(array2 const&, array2&);
}; 
```

由于`max_pole`在**这两种情况下**都是*不合格的独立名称*，因此查找策略在两种情况下都应该相同，但事实并非如此。对我来说，这将其视为一个错误。

# javascript - “显示”有效，“隐藏”无效。Javascript

> ID：14338893
> 
> 赞同：0
> 
> 时间：2013-01-15T13:32:02.337
> 
> 标签：javascript, toggle

我有以下用于显示/隐藏切换的 JS 脚本。我不得不保持这种格式，因为它处理的元素很多而且格式很差，而且在 jQuery 中制作它太麻烦了。

正如标题所说，“显示”事件正在工作，而“隐藏”则没有。而且由于我是一个完整的 JS 菜鸟，我想知道您是否可以帮助我。这是代码：

```
function toggle(obj) {
  for (var  i = 0; i< 50; i++) {
    var name = 'q' + i;
    var inchide_obj=document.getElementById(obj);
    if (inchide_obj && inchide_obj.style && inchide_obj.style.display == "block") {
      inchide_obj.style.display = "none";
    }
  }
  var deschide_obj=document.getElementById(obj);
  if (deschide_obj && deschide_obj.style) {
    deschide_obj.style.display = "block";
    deschide_obj.focus();
  }
} 
```

html 暗示了一些文本块，每个文本块都有自己的类、q1、q2 等。提前感谢您的帮助:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T13:39:28.960

您当前的代码首先尝试隐藏元素 50 次，并最终无条件地在最后显示它。我相信你正在寻找这个：

```
function toggle(id) {
    var obj = document.getElementById(id);
    if (obj && obj.style) {
        if(obj.style.display != "block") {
            obj.style.display = "block";
        } else {
            obj.style.display = "none";
        }
    }
} 
```

# c# - 如何只创建一次根标签

> ID：14338898
> 
> 赞同：0
> 
> 时间：2013-01-15T13:32:11.937
> 
> 标签：c#, xml

试图从 FileStreame Writer 类的 xml 文件创建 XML 文件，但它给了我一个错误`Unexpected XML declaration. The XML declaration must be the first node in the document, and no white space characters are allowed to appear before it.`

它创建`<?xml version='1.0' encoding='utf-8' standalone='yes'?>`和根元素标签两次我的代码

```
using (FileStream fileStream = new FileStream(_logFilePath, FileMode.OpenOrCreate, FileAccess.ReadWrite, FileShare.ReadWrite))
                {
                    XmlDocument xmlDoc = new XmlDocument();
                    string currentDateTime = DateTime.Now.ToString("yyyyMMddHHmmss");
                    xmlDoc.Load(fileStream);
                    XmlElement newelement = xmlDoc.CreateElement("LogData");
                    XmlElement xmlLogID = xmlDoc.CreateElement("LogID");
                    XmlElement xmlLogDateTime = xmlDoc.CreateElement("LogDateTime");
                    XmlElement xmlLogType = xmlDoc.CreateElement("LogType");
                    XmlElement xmlLogFlag = xmlDoc.CreateElement("LogFlag");
                    XmlElement xmlLogApplication = xmlDoc.CreateElement("LogApplication");
                    XmlElement xmlLogModule = xmlDoc.CreateElement("LogModule");
                    XmlElement xmlLogLocation = xmlDoc.CreateElement("LogLocation");
                    XmlElement xmlLogText = xmlDoc.CreateElement("LogText");
                    XmlElement xmlLogStackTrace = xmlDoc.CreateElement("LogStackTrace");

                    xmlLogID.InnerText = _logIDPrefix + currentDateTime + randomNumber;
                    xmlLogDateTime.InnerText = currentDateTime;
                    xmlLogType.InnerText = ((LogTypes)Convert.ToInt32(logType)).ToString();
                    xmlLogFlag.InnerText = logFlag;
                    xmlLogApplication.InnerText = _logApplication;
                    xmlLogModule.InnerText = logModule;
                    xmlLogLocation.InnerText = logLocation;
                    xmlLogText.InnerText = logText;
                    xmlLogStackTrace.InnerText = logStackTrace;

                    newelement.AppendChild(xmlLogID);
                    newelement.AppendChild(xmlLogDateTime);
                    newelement.AppendChild(xmlLogType);
                    newelement.AppendChild(xmlLogFlag);
                    newelement.AppendChild(xmlLogApplication);
                    newelement.AppendChild(xmlLogModule);
                    newelement.AppendChild(xmlLogLocation);
                    newelement.AppendChild(xmlLogText);

                    xmlDoc.DocumentElement.AppendChild(newelement);
                    xmlDoc.Save(fileStream); 
```

这个代码被执行了不止一次，但我只是想防止创建`<?xml version='1.0' encoding='utf-8' standalone='yes'?>`和根元素 twise

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:37:54.340

您正在调用`Load`（这会将流留在现有文件的*末尾*），然后调用`Save`. 不要在同一个流上这样做。您*可以*重新定位它，但如果新文档较短，您最终会遇到问题。（现在不会，但将来可能会。）

我强烈建议您将其分为三个部分：

*   创建一个只读取并加载现有文档的流
*   修改内存中的文档
*   创建一个只写入的流（截断现有文件），并保存文档

# asp.net - 在 asp.net mvc 3 中使用 System.Diagnostics.TextWriterTraceListener 将日志信息写入文件

> ID：14338900
> 
> 赞同：0
> 
> 时间：2013-01-15T13:32:15.800
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, linq-to-sql, logging

在我的 asp.net mvc 3 应用程序中，我想跟踪由 Linq To Sql 生成的 SQL 代码。我想把它写在一个文件中。这是我所做的：

web.config 更改：

```
<system.diagnostics>
<trace autoflush="true" indentsize="4">
  <listeners>
    <add name="myListener" 
         type="System.Diagnostics.TextWriterTraceListener" 
         initializeData="LogLinqToSql.log" />
    <remove name="Default" />
  </listeners>
</trace>
</system.diagnostics> 
```

我创建了一个应该有助于写入文件的类（刚刚在一个教程中找到它）：

```
public class LogLinqToSql : TextWriter
{
    public override void Write(string value)
    {
        Debug.Write(value);
    }
    public override void Write(char[] buffer, int index, int count)
    {
        Debug.Write(new String(buffer, index, count));
    }
    public override System.Text.Encoding Encoding
    {
        get { return System.Text.Encoding.UTF8; }
    }
} 
```

以及用于从存储库获取项目并使用视图模型的 StoreController 操作方法 Content 的更改（mabby 因为它我的代码不起作用）：

```
#define TRACE 

public ViewResult Content(string category, int page = 1)
{
    var context = new WebStoreDataContext();

     Trace.WriteLine("StoreController.Content BEGINS");
     context.Log = Console.Out;

     var model = new StoreContentViewModel
            {
                Items = _itemsRepository.GetItems()
                             .Where(i => category == null || (i.Product != null && i.Product.Category == category))
                             .OrderBy(i => i.ItemId)
                             .Skip((page - 1) * PageSize)
                             .Take(PageSize),

                // initializing other properties
            };

        context.Log = new LogLinqToSql();
        context.SubmitChanges();
        Trace.WriteLine("StoreController.Content ENDS");
        Trace.WriteLine("");

        return View(model);         
} 
```

只有“BEGIN”和“END”行出现在 .log 文件中。

那么，我是在做完全错误的事情吗？还有另一种方法可以将日志信息写入文件，或者我只需要修复某些部分？？？

提前感谢您的帮助！

**编辑：**

还尝试了此操作方法：

```
context.Log = new StreamWriter(@"C:\Users\Aleksey\repos\2\WebStore\WebStore\LogLinqToSql.log"); 
```

但是我得到一个 IOException: 该进程无法访问此文件，因为该文件已被其他进程使用。

这是[同一个问题](https://stackoverflow.com/questions/6948085/how-do-you-get-linq-to-sql-output)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T17:38:42.917

我只需要将 context.Log 放入创建实际查询的数据模型类中。这是 ItemsRepository 类的方法：

```
public IEnumerable<Item> GetItems(string category)
    {
        // writing info into Trace file
        _dataContext.Log = Console.Out;

        var result = _dataContext.Items.Where(
            i => category == null || (i.Product != null && i.Product.Category == category))
                                 .OrderBy(i => i.ItemId);

        _dataContext.Log = new LogLinqToSql();
        _dataContext.SubmitChanges();
        return result;
    } 
```

# javascript - 单击按钮时如何移动轮播项目？

> ID：14338904
> 
> 赞同：2
> 
> 时间：2013-01-15T13:32:41.557
> 
> 标签：javascript, jquery, jquery-plugins

我正在使用[水车轮播](http://code.google.com/p/proyectofinalingles/source/browse/trunk/js/jquery.waterwheelCarousel.js?r=19)我想根据我的按钮点击调用移动功能

这是我的代码：

```
 function myFunction()
{
 $("#waterwheel-carousel-default").waterwheelCarousel().moveOnce(true);
} 
```

它给了我一个错误

> TypeError: 'undefined' 不是函数（评估 '$("#waterwheel-carousel-default").waterwheelCarousel().

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T14:07:50.807

在左侧按钮中写下：

```
$("#waterwheel-carousel-default").find('.carousel-controls .carousel-prev').trigger('click'); 
```

在右键中写下：

```
$("#waterwheel-carousel-default").find('.carousel-controls .carousel-next').trigger('click'); 
```

试试这个。

# asp.net - 不存在的图像返回状态代码 200 而不是 400

> ID：14338905
> 
> 赞同：0
> 
> 时间：2013-01-15T13:32:46.283
> 
> 标签：asp.net, web-config, http-status-code-404, http-status-codes, custom-error-pages

我执行以下代码来检查图像是否存在：

```
 public bool DoesImageExist(string imageUrl)
{
    bool exists = false;
    try
    {
        HttpWebRequest request = (HttpWebRequest)System.Net.WebRequest.Create(imageUrl);
        request.Timeout = 5000;
        using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
        {
            exists = (response.StatusCode == HttpStatusCode.OK);
        }
    }
    catch
    {
        exists = false;
    }

    return exists;
} 
```

这工作正常并为不存在的图像返回 404，但是由于我在 web.config 中打开 customErrors，它开始返回 200 状态 ok，因为它请求的图像返回 404 并重定向到错误处理程序页面返回 200 状态 ok。有没有办法解决这个问题来防止 customErrors 页面返回 200 ok 或为图像工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:09:19.407

通过将此代码放入我的通用处理程序页面（我在 customErrors 中设置），我为遇到相同问题的任何人找到了解决此问题的快速方法

```
if (Request.Params.ToString().Contains("jpg") || Request.Params.ToString().Contains("png"))
        Response.StatusCode = 404; 
```

这基本上会强制它为任何 jpeg/png 图像返回 404，但是对于所有其他错误，它会强制显示通用页面。

# objective-c - 目标 C：为变量赋值创建自定义类型值

> ID：14338907
> 
> 赞同：0
> 
> 时间：2013-01-15T13:32:53.270
> 
> 标签：objective-c

我正在尝试创建一个可以从数据源调用的值，该值将确定另一个变量接收的内容。这听起来令人困惑，但基本上我希望我的变量设置为以下任一值（取决于数据源所说的）：

```
variable = variableValue/2; 
```

或者

```
variabel = 0; 
```

variableValue 是一个可以动态更改的属性。无论如何，我如何使用来自我的数据源的布尔值或整数值来选择上述任一选项。我做一个枚举吗？

我敢肯定有一个简单的解决方案，但它逃脱了我。谢谢阅读！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:36:39.520

我不完全理解你的问题，但你不能用 if 结构来检查吗？

```
bool test = YES;

if(test == YES)
{
    // select 1
}
else
{
    // select 2
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T14:08:20.543

如果是常数值，则使用常数。

```
#define kVariableValue           123 
```

或者

```
static int variableValue = 123; 
```

# php - Facebook 图表的 url 没有返回正确的链接

> ID：14338917
> 
> 赞同：0
> 
> 时间：2013-01-15T13:33:17.320
> 
> 标签：php, facebook, facebook-graph-api, hyperlink

我在我网站的几个空间中使用 facebook 共享链接，但是对于某些图像，推到 facebook 墙的用户上的帖子不会显示图像。图片链接是

[http://mysite.org/files/campaign/image/originals/18/Sans%20titre-3.jpg](http://mysite.org/files/campaign/image/originals/18/Sans%20titre-3.jpg)

所以我尝试在 facebook 的调试器中输入这个链接，然后我得到了那个[链接](http://developers.facebook.com/tools/debug/og/object?q=http://primagora.org/files/campaign/image/originals/18/Sans%2520titre-3.jpg)。问题是对应的打开图链接是

```
http://graph.facebook.com/195459563930903 and the json which it's supporting is http://primagora.org/files/campaign/image/originals/18/Sans\u002520titre-3.jpg 
```

这是facebook的缓存问题吗？（因为我必须处理我必须转义的 facebook 的共享名称参数，而对于这个名称包含错误转义空格的特定图像，facebook 的共享根本不起作用）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:36:25.583

主要是因为图片文件太大

# python - 请解释来自 argparse 模块的代码片段背后的原因

> ID：14338919
> 
> 赞同：11
> 
> 时间：2013-01-15T13:33:26.053
> 
> 标签：python, argparse

我正在查看实现动作的内置[argparse._AppendAction的源代码，并对](http://docs.python.org/2/library/argparse.html#action)[它的实现方式](http://hg.python.org/cpython/file/1f66fc397c8d/Lib/argparse.py#l946)`"append"`感到困惑：

```
 def __call__(self, parser, namespace, values, option_string=None):
        items = _copy.copy(_ensure_value(namespace, self.dest, []))
        items.append(values)
        setattr(namespace, self.dest, items) 
```

分解它：

*   `_ensure_value`就像`dict.setdefault`属性一样。也就是说，如果`namespace`有一个带有名称的属性，`self.dest`则返回它，如果没有，则将其设置为`[]`并返回。
*   `_copy.copy(x)`只返回一个浅拷贝。什么时候`x`是一个列表，它完全一样`list(x)`（但速度较慢）。
*   然后将该项目附加到从 获取的列表的*副本*`namespace`中。
*   最后， 的`self.dest`属性`namespace`被副本覆盖，这应该会导致旧列表被垃圾收集。

为什么要以如此迂回和低效的方式进行，为每个附加项扔掉一个完整的列表？为什么这还不够？

```
 def __call__(self, parser, namespace, values, option_string=None):
        items = _ensure_value(namespace, self.dest, [])
        items.append(values) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T14:04:55.443

我不是实施方面的专家，所以（*免责声明*）这只是一个猜测。`default=...`使用此实现，用户可以在调用中将列表作为 a 传递，`add_argument`而不会在 argparse 中发生突变。也许出于某种原因，开发人员需要这种类型的安全性。

你提到的效率低下真的没什么大不了的。它用于解析命令行参数，因此在大量使用的情况下，每个程序可能只调用此函数 10 次。

* * *

我已经对此进行了测试，实际上，如果我使用以下脚本（`argparse_temp`只需将其中的位置`argparse.py`复制到当前目录，以便我可以使用它）：

```
import argparse_temp as argparse

lst = [1,2,3]
parser = argparse.ArgumentParser()
parser.add_argument('-l',default=lst,action='append')
print parser.parse_args()
print lst 
```

这打印（当称为：） `python test1.py -l 4`：

```
Namespace(l=[1, 2, 3, '4'])
[1, 2, 3] 
```

`argparse`原样，但是：

```
Namespace(l=[1, 2, 3, '4'])
[1, 2, 3, '4'] 
```

与您提议的更改。

如果您打印由 返回的操作`add_argument`，您将获得：

```
_AppendAction(option_strings=['-l'], dest='l', nargs=None, const=None, default=[1, 2, 3, '4'], type=None, choices=None, help=None, metavar=None) 
```

可以想象 argparse 依赖于实现中其他地方的操作。（注意`default`这里也发生了变异）。

# javascript - 是否可以提取数据：画布元素的图像？

> ID：14338923
> 
> 赞同：9
> 
> 时间：2013-01-15T13:33:42.623
> 
> 标签：javascript, html, canvas, base64

> **可能重复：**
> [将 Canvas 元素转换为图像并存储在数据库中](https://stackoverflow.com/questions/9493947/converting-canvas-element-to-image-and-storing-in-database)

我有一个画布元素，我想要这个元素的“data:image/png;base64”。可以提取这个吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-15T13:37:05.720

您可以使用[Canvas 的 toDataURL 函数](http://msdn.microsoft.com/en-us/library/ie/ff975241%28v=vs.85%29.aspx)。它完全符合您的要求。

```
var dataURLstring = canvas.toDataURL(); 
```

MDN 文档：[HTML 画布](https://developer.mozilla.org/en-US/docs/DOM/HTMLCanvasElement)

> 返回一个 data: URL，其中包含由 type 指定的格式的图像表示（默认为 PNG）。

# c# - 为什么这个单元测试不包括我的属性设置器？

> ID：14338927
> 
> 赞同：-1
> 
> 时间：2013-01-15T13:33:56.960
> 
> 标签：c#, asp.net, asp.net-mvc-3, nunit

我正在使用 NUnit 编写单元测试用例。在测试这个属性时，我得到了 getter 的覆盖率，而不是 setter 的覆盖率。为什么？

```
private string name = null;

public string Name
{
    get { return this.name; }
    set
    {
        if (!String.IsNullOrEmpty(value) && value.StartsWith("@"))
        {
            name = value.Remove(0, 1);
        }
        else
        {
            name = value;
        }
    }
} 
```

单元测试：

```
[Test]
public void TestNameHaveValue()
{
    classobject.Name = "@test";
    //Assert
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:45:44.703

从您的评论看来，您的意思是您没有在此类的 getter 上获得代码覆盖率。好吧，你不会 - 因为你没有读取属性值。

您需要断言类似：

```
Assert.AreEqual("test", classObject.Name); 
```

完成任务后。

# javascript - 如何在这个 jqplot 脚本中旋转 x 轴标签

> ID：14338930
> 
> 赞同：3
> 
> 时间：2013-01-15T13:34:17.153
> 
> 标签：javascript, jqplot

下面是基于 jqplot 条形图示例的脚本的一部分。我正在尝试旋转 x 轴刻度标签，因为它们重叠我已经导入了 TickRender 插件，但是当我将以下代码添加到图表下方的脚本时，根本无法打印。

你能告诉我如何正确地做到这一点。

```
tickRenderer: $.jqplot.CanvasAxisTickRenderer ,
  tickOptions: {
     angle: -30,
     fontSize: '10pt'
  } 
```

//jqplot脚本

```
$(document).ready(function(){
        $.jqplot.config.enablePlugins = true;
        var s1 = [2314,2053,94,70,2541,2626,2551,2515,2147,116,82,2536,2560,2558,2465,2127,103,73,2546,2554,2583,2527,2235,104,88,2515,2604,2641,2532,2142];
        var ticks = ['01/11/2012','02/11/2012','03/11/2012','04/11/2012','05/11/2012','06/11/2012','07/11/2012','08/11/2012','09/11/2012','10/11/2012','11/11/2012','12/11/2012','13/11/2012','14/11/2012','15/11/2012','16/11/2012','17/11/2012','18/11/2012','19/11/2012','20/11/2012','21/11/2012','22/11/2012','23/11/2012','24/11/2012','25/11/2012','26/11/2012','27/11/2012','28/11/2012','29/11/2012','30/11/2012'];

        plot1 = $.jqplot('chart1', [s1], {
            // Only animate if we're not using excanvas (not in IE 7 or IE 8)..
            animate: !$.jqplot.use_excanvas,
            seriesDefaults:{
                renderer:$.jqplot.BarRenderer,
                pointLabels: { show: true }

            tickRenderer: $.jqplot.CanvasAxisTickRenderer ,
                tickOptions: {
                angle: -30,
                fontSize: '10pt'
                }

            },
            axes: {
                xaxis: {
                    renderer: $.jqplot.CategoryAxisRenderer,
                    ticks: ticks
                }

            },
            highlighter: { show: false }
        });

        $('#chart1').bind('jqplotDataClick',
            function (ev, seriesIndex, pointIndex, data) {
                $('#info1').html('series: '+seriesIndex+', point: '+pointIndex+', data: '+data);
            }
        );
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T02:38:53.683

尝试这个，

```
 axesDefaults: {
            tickRenderer: $.jqplot.CanvasAxisTickRenderer ,
            tickOptions: {
                angle: -90,
                fontSize: '10pt'
            }
        },
        axes: {
            xaxis: {
                renderer: $.jqplot.CategoryAxisRenderer,
                ticks: ticks
            },
    } 
```

或者

```
axes: {
       xaxis: {
              renderer:$.jqplot.DateAxisRenderer,
              ticks: ticks,
              tickRenderer: $.jqplot.CanvasAxisTickRenderer ,
              tickOptions: {
                           angle: -90,
                           fontSize: '10pt'
                           }
              }
      } 
```

或者

```
axes: {
           xaxis: {
                  renderer:$.jqplot.DateAxisRenderer,
                  ticks: ticks,
                  rendererOptions:{
                                 tickRenderer: $.jqplot.CanvasAxisTickRenderer ,
                                 tickOptions: {
                                              angle: -90,
                                              fontSize: '10pt'
                                              }
                                 }
                }
      } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-28T08:57:05.650

[包括来自http://www.jqplot.com/examples/rotated-tick-labels.php](http://www.jqplot.com/examples/rotated-tick-labels.php)的以下文件

```
 <script class="include" type="text/javascript" src="js/jquery.jqplot.chartCode.js"></script>

    <script type="text/javascript" src="js/plugins/jqplot.dateAxisRenderer.js"></script>
    <script type="text/javascript" src="js/plugins/jqplot.canvasTextRenderer.js"></script>
    <script type="text/javascript" src="js/plugins/jqplot.canvasAxisTickRenderer.js"></script>
    <script type="text/javascript" src="js/plugins/jqplot.categoryAxisRenderer.js"></script>
    <script class="include" type="text/javascript" src="js/plugins/jqplot.pointLabels.js"></script>
    <script class="include" type="text/javascript" src="js/plugins/jqplot.barRenderer.js"></script>
    <script class="include" type="text/javascript" src="js/plugins/jqplot.pieRenderer.js"></script> 
```

# ruby - 没有抽象类的 Rails STI（单表继承）

> ID：14338933
> 
> 赞同：1
> 
> 时间：2013-01-15T13:34:37.860
> 
> 标签：ruby, ruby-on-rails-3, sti

**背景**

我有一个 rails 3 应用程序，它有一个以`A`对应表命名的模型`as`。现在我需要一个新模型`B`，它的工作原理与此一模一样，`A`但有一些其他的关联和方法（除了 中的那些`A`）。

**问题**

我决定使用 STI（单表继承）。我知道我可以做类似`A < BaseModel`and`B < BaseModel`的事情，但是已经**有很多**代码假设一个名为的表`as`，它需要太多的工作。

所以我正在尝试做`B < A`，哪里`A`不是抽象的。我将该`type`列添加到`as`. 现在模型`B`完美运行，但是模型`A`对继承一无所知并且完全忽略了该`type`列，所以当我这样做时，`A.create!`它说该列`type`不能为空。也`A.all`返回`B`行。

**我试过的**

*   `A`使用列的默认值`type`。*这有效，但只能解决部分问题*
*   `A`在模型中使用默认范围。*这种方法的问题是它过滤掉`B`了两个模型的所有行*

**问题**

*   我如何`B < A`在 Rails 中完成，没有一个模型是抽象的？
*   还有其他不错的选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T19:19:15.463

最简单的解决方案可能是创建一个新的基类并同时拥有`A`并`B`扩展它。

基类会将其表名设置为指向您当前的`A`表 ( `as`)：

```
class NewBaseClass < ActiveRecord::Base
  self.table_name = `as`
end

class A < NewBaseClass
  # ...
end

class B < NewBaseClass
  # ...
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T14:14:46.360

尝试：

```
class A< ActiveRecord::Base
      self.abstract = false
end 
```

**另一种方法：**

我会创建另一个模型，称为`C`自包含的模型。它将包括具有所有属性的表。最后是模型`A`，并且与模型`B`有一个多态的 has_one 关系`C`。

# php - 邮件功能或 PHPMailer 不工作

> ID：14338936
> 
> 赞同：-1
> 
> 时间：2013-01-15T13:34:49.153
> 
> 标签：php

``我的服务器上安装了 wordpress，一切正常，我尝试使用 PHP mail() 函数在模板上添加联系表单，它在远程托管服务器上运行良好，但是当我尝试传输相同的在托管服务器上成功运行到我工作的本地服务器的代码，它不发送任何电子邮件。服务器可能有什么问题？我处理表单的代码是：

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:45:51.707

[http://php.net/manual/en/function.mail.php](http://php.net/manual/en/function.mail.php)

你也可以试试梨包。从这里下载：http: [//pear.php.net/package/Mail](http://pear.php.net/package/Mail)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:50:36.883

将 PEAR 用于电子邮件是更好的选择。来自谷歌的搜索结果之一 - [http://email.about.com/od/emailprogrammingtips/qt/PHP_Email_SMTP_Authentication.htm](http://email.about.com/od/emailprogrammingtips/qt/PHP_Email_SMTP_Authentication.htm)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:41:56.830

服务器上的 SMTP 服务器是否正常工作？您可以使用 telnet 在 Windows 中进行测试：http: [//support.microsoft.com/kb/323350](http://support.microsoft.com/kb/323350)

您还应该尝试编写和运行一个仅调用 php 邮件功能的小脚本，独立于 wordpress。

```
<?php
$to      = 'nobody@example.com';
$subject = 'the subject';
$message = 'hello';
$headers = 'From: webmaster@example.com' . "\r\n" .
    'Reply-To: webmaster@example.com' . "\r\n" .
    'X-Mailer: PHP/' . phpversion();
mail($to, $subject, $message, $headers);
?> 
```

您可以将其作为参考阅读：http: [//php.net/manual/en/function.mail.php](http://php.net/manual/en/function.mail.php)

# jquery - how to send image using ajax post?

> ID：14338945
> 
> 赞同：1
> 
> 时间：2013-01-15T13:35:15.927
> 
> 标签：jquery

Is this possible to send image or video file through jquery ajax post method?yes or no?

```
 $.ajax({
            type: 'POST',
            url: "url?json",
            data: {image:},
            success: function (o) {

            },
            dataType:"json"
     }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:48:02.127

No. Uploading a file need a full postback.

You can simulate an ajax call posting to a hidden iFrame (so your page don't change). Then checking the content of the iFrame using jquery/javascript you can see if the upload was successful and do a refresh of certain part of your screen.

**If you are using ASP.NET MVC3 or MVC4 here is an example (I'm using this):** [http://www.dustinhorne.com/post/2011/11/16/AJAX-File-Uploads-with-jQuery-and-MVC-3.aspx](http://www.dustinhorne.com/post/2011/11/16/AJAX-File-Uploads-with-jQuery-and-MVC-3.aspx)

**If you want a more generic way of doing it in JS:** [http://tips.itliveweb.com/ajax/upload-image-using-iframe-javascript-ajax.html](http://tips.itliveweb.com/ajax/upload-image-using-iframe-javascript-ajax.html)

# java - 如何获取文件的完整路径？

> ID：14338947
> 
> 赞同：1
> 
> 时间：2013-01-15T13:35:19.450
> 
> 标签：java, file, servlets, security

> **可能重复：**
> [如何从 Firefox 3 中的 HTML 输入表单获取文件路径](https://stackoverflow.com/questions/81180/how-to-get-the-file-path-from-html-input-form-in-firefox-3)

有什么方法可以在`input file tag`不使用 3rd 方 API 的情况下获取文件的完整路径？

```
<form method="post" action="SendTheFileName">
                <div id="Files_to_be_shared"> 
                      <input type="file" id="File" name="FileTag" />
                      <input type="submit" value="Share" /> 
               </div>
 </form> 
```

*来自 servlet 的片段：*

```
String fileName = request.getParameter("FileTag"); 
```

我现在从上面的 java 代码中得到的只是所选文件的名称。如何获取文件的完整路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T15:46:23.990

这个问题已经在其他线程中得到了回答，我认为这两个中的任何一个都可以帮助你：

[如何在 jsp 中使用 <input id="file" name="file" type="file" size="60" > 获取完整路径](https://stackoverflow.com/questions/6955832/how-to-get-full-path-using-input-id-file-name-file-type-file-size-60)

[如何在javascript中使用输入类型文件获取文件的完整路径？](https://stackoverflow.com/questions/4244256/how-to-get-full-path-of-file-using-input-type-file-in-javascript)

只是为了进一步完成我的答案，并且由于您向其中添加了 java 标记，因此我将在此处包含一小段代码，其中显示了您可以从文件中获取的一些最常见的信息，但从 java 的角度来看：

```
package test;

import java.io.File;
import java.io.IOException;

public class FilePaths {

    public static void main(String[] args) throws IOException {

        String[] fileArray = { 
                "C:\\projects\\workspace\\testing\\f1\\f2\\f3\\file5.txt", 
                "folder/file3.txt",
                "../testing/file1.txt", 
                "../testing", 
                "f1/f2"
        };

        for (String f : fileArray) {
            displayInfo(f);
        }

    }

    public static void displayInfo(String f) throws IOException {
        File file = new File(f);
        System.out.println("========================================");
        System.out.println("          name:" + file.getName());
        System.out.println("  is directory:" + file.isDirectory());
        System.out.println("        exists:" + file.exists());
        System.out.println("          path:" + file.getPath());
        System.out.println(" absolute file:" + file.getAbsoluteFile());
        System.out.println(" absolute path:" + file.getAbsolutePath());
        System.out.println("canonical file:" + file.getCanonicalFile());
        System.out.println("canonical path:" + file.getCanonicalPath());
    }

} 
```

# jquery - 使用列表的属性创建对象数组

> ID：14338948
> 
> 赞同：2
> 
> 时间：2013-01-15T13:35:28.157
> 
> 标签：jquery, arrays, object

我想从列表中的值/属性创建一个对象数组，但以下不起作用：

```
$('ul.list').each(function() {
        var localproducts = [];
        $(this).find('li').each(function(){
                var $itm = $(this);
                localproducts.push( dataid : $itm.attr('data-id'), data-package: $itm.attr('data-package'), package-id: ($itm.children('.packageid').text()) );
            });
        catalogue.push(localproducts);  

        }); 
```

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T13:37:20.743

对象应在花括号内定义`{}`。键应该用引号引起来。

工作代码：

```
$('ul.list').each(function() {
    var localproducts = [];
    $(this).find('li').each(function(){
            var $itm = $(this);
            localproducts.push({
                'dataid' : $itm.attr('data-id'), 
                'data-package' : $itm.attr('data-package'), 
                'package-id' : ($itm.children('.packageid').text())
            });
        });
    catalogue.push(localproducts);  
}); 
```

# gwt - 使用 gwt:compileReport 生成编译报告

> ID：14338950
> 
> 赞同：1
> 
> 时间：2013-01-15T13:35:35.993
> 
> 标签：gwt, report, gwt-maven-plugin

我正在尝试从我的 maven-gwt 项目生成编译报告。

根据[这个](https://developers.google.com/web-toolkit/doc/latest/DevGuideCompileReport "谷歌开发网站 - GWT")站点，我应该在生成的源文件夹中看到生成的报告。但是，当我运行其中任何一个时：

`mvn gwt:compile-report`,
`mvn gwt:compile-report -DcompileReport`,
`mvn gwt:compile-report -DcompileReport=true`,
`mvn gwt:compile-report -DcompileReport=Test`

我得到：

`[WARNING] No compile reports found, did you compile with compileReport option set ?`

在我的`pom.xml`文件中，我将报告内容设置为：

```
<reporting>
    <plugins>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>gwt-maven-plugin</artifactId>
            <version>2.5.0</version>
            <reportSets>
                <reportSet>
                    <id>Report</id>
                <reports>
                    <report>Test</report>
                </reports>
                </reportSet>
            </reportSets>
        </plugin>
    </plugins>
</reporting> 
```

**编辑：**

Pom 更改为：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>gwt-maven-plugin</artifactId>
    <version>2.5.0</version>
    <executions>
      <execution>
        <goals>
          <goal>compile</goal>
          <goal>test</goal>
          <goal>i18n</goal>
          <goal>generateAsync</goal>
        </goals>
        <configuration>
          <draftCompile>true</draftCompile>
          <compileReports>true</compileReports>
          <sources>
            <source>target/generated-sources/gwt</source>
          </sources>
        </configuration>
      </execution>
    </executions>
    <!-- Plugin configuration. There are many available options, -->
    <!--see gwt-maven-plugin documentation at codehaus.org -->
    <configuration>
      <runTarget>Bondegard.html</runTarget>
      <compileReports>true</compileReports>
      <logLevel>SPAM</logLevel>
      <hostedWebapp>${webappDirectory}</hostedWebapp>
      <i18nMessagesBundle>pl.spot.bondegard.bondegard.client.Messages</i18nMessagesBundle>
    </configuration>
  </plugin> 
```

而且仍然没有报告。还有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:52:29.353

编译报告在构建期间创建（`gwt:compile`激活[编译报告](http://mojo.codehaus.org/gwt-maven-plugin/compile-mojo.html#compileReport)），`gwt:compile-report`仅将其发布到您的 Maven 站点。

# json - WebAPI、HTTPS 和 CORS

> ID：14338952
> 
> 赞同：0
> 
> 时间：2013-01-15T13:35:48.070
> 
> 标签：json, https, asp.net-web-api, cors

一直在努力让它工作，基本上我试图在我的项目中将 JSON 提交到 WebAPI 控制器。

我添加了一个“CorsHandler”来处理 OPTIONS 请求，并且数据已成功跨域发送，到目前为止一切顺利。

问题是当我添加属性“ApiHttps”时，我从浏览器收到错误消息。

```
OPTIONS https://localhost:44302/Api/Form/Submit/1 Resource failed to load 
```

ApiHttps 类是这样的

```
public class ApiHttps : AuthorizationFilterAttribute
{
    public override void OnAuthorization(HttpActionContext actionContext)
    {
        if (actionContext.Request.RequestUri.Scheme != Uri.UriSchemeHttps && actionContext.Request.Method != HttpMethod.Options)
        {
            actionContext.Response = new HttpResponseMessage(System.Net.HttpStatusCode.Forbidden)
            {
                ReasonPhrase = "HTTPS Required"
            };
        }
        else
        {
            base.OnAuthorization(actionContext);
        }
    }
} 
```

有什么我做错了或看过了吗？

我只需要能够通过 https 跨域发送 json 数据 :-) 如果您需要更多信息，请询问！

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T20:16:46.230

我已经发布了一堆关于问题的代码：

[CORS - Ajax 错误函数将返回 401 的 API 请求的错误代码报告为 0](https://stackoverflow.com/questions/14268706/cors-ajax-error-function-reports-error-code-as-0-for-an-api-request-returning)

它正在使用 MVC4，但应该为您提供使其正常工作所需的一切（除了我的问题所要求的身份验证方面）

# java - 将函数作为静态类传递给 Java 中的快速数字

> ID：14338953
> 
> 赞同：0
> 
> 时间：2013-01-15T13:35:48.550
> 
> 标签：java, function, static, numerics

我想在java中进行一些数值计算，并使操作真正模块化，我想将函数作为其他函数的参数传递。我正在搜索，通常它是在 java 中使用扭曲函数的类来完成的。我真的不需要实例化这些类（里面没有数据），我想让它尽可能快（在某处写了最终静态方法由 JIT 编译器内联）。所以我做了这样的东西

```
public static class Function2 {
  public static float eval(float a, float b){ return Float.NaN; }  
}

public static class FAdd extends Function2 {
  public static float eval(float a, float b){ return a+b; }  
}

public static class Fmult extends Function2 {
  public static float eval(float a, float b){ return a*b; }  
}

void arrayOp( float [] a, float [] b, float [] out, Function2 func ){
  for (int i=0; i<a.length; i++){     out[i] = func.eval( a[i], b[i] );   }
}

float [] a,b, out;

void setup(){
  println( FAdd.eval(10,20) );
  arrayOp( a,b, out, FAdd );
} 
```

然而，当我尝试将它传递给arrayOp时，它会打印错误：“找不到像FAdd这样的东西”，即使println（FAdd.eval（10,20））工作正常。因此，由于某种原因，似乎不可能将静态类作为参数传递。

你有什么建议来解决这样的任务？我实际上希望 FAdd 类似于宏，并且 arrayOp 是 polymorf （行为取决于我传入的宏）。但理想的情况是在编译时（而不是在运行时）解决它以提高数值速度。编译的结果应该和我写的一样

```
void arrayAdd( float [] a, float [] b, float [] out ){
  for (int i=0; i<a.length; i++){     out[i] = a[i]  + b[i];    }
}
void arrayMult( float [] a, float [] b, float [] out ){
  for (int i=0; i<a.length; i++){     out[i] = a[i] * b[i];   }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:40:53.757

您是否考虑过使用枚举？

```
private void test() {
  test(3.0f, 4.0f, F.Add);
  test(3.0f, 4.0f, F.Sub);
  test(3.0f, 4.0f, F.Mul);
  test(3.0f, 4.0f, F.Div);
  float[] a = {1f, 2f, 3f, 4f, 5f};
  float[] b = {4f, 9f, 16f, 25f, 36f};
  test(a, b, F.Add);
  test(a, b, F.Sub);
  test(a, b, F.Mul);
  test(a, b, F.Div);
}

private void test(float[] a, float[] b, F f) {
  System.out.println(Arrays.toString(a) + " " + f + " " + Arrays.toString(b) + " = " + Arrays.toString(f.f(a, b, f)));
}

private void test(float a, float b, F f) {
  System.out.println(a + " " + f + " " + b + " = " + f.f(a, b));
}

public enum F {
  Add {
    @Override
    public float f(float x, float y) {
      return x + y;
    }

    @Override
    public String toString() {
      return "+";
    }
  },
  Sub {
    @Override
    public float f(float x, float y) {
      return x - y;
    }

    @Override
    public String toString() {
      return "-";
    }
  },
  Mul {
    @Override
    public float f(float x, float y) {
      return x * y;
    }

    @Override
    public String toString() {
      return "*";
    }
  },
  Div {
    @Override
    public float f(float x, float y) {
      return x / y;
    }

    @Override
    public String toString() {
      return "/";
    }
  };

  // Evaluate to a new array.
  static float[] f(float[] x, float[] y, F f) {
    float[] c = new float[x.length];
    for (int i = 0; i < x.length; i++) {
      c[i] = f.f(x[i], y[i]);
    }
    return c;
  }

  // All must have an f(x,y) method.
  public abstract float f(float x, float y);

  // Also offer a toString - defaults to the enum name.  
  @Override
  public String toString() {
    return this.name();
  }
} 
```

印刷：

```
3.0 + 4.0 = 7.0
3.0 - 4.0 = -1.0
3.0 * 4.0 = 12.0
3.0 / 4.0 = 0.75
[1.0, 2.0, 3.0, 4.0, 5.0] + [4.0, 9.0, 16.0, 25.0, 36.0] = [5.0, 11.0, 19.0, 29.0, 41.0]
[1.0, 2.0, 3.0, 4.0, 5.0] - [4.0, 9.0, 16.0, 25.0, 36.0] = [-3.0, -7.0, -13.0, -21.0, -31.0]
[1.0, 2.0, 3.0, 4.0, 5.0] * [4.0, 9.0, 16.0, 25.0, 36.0] = [4.0, 18.0, 48.0, 100.0, 180.0]
[1.0, 2.0, 3.0, 4.0, 5.0] / [4.0, 9.0, 16.0, 25.0, 36.0] = [0.25, 0.22222222, 0.1875, 0.16, 0.1388889] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:43:03.427

您要实现的实际上是[匿名函数](http://en.wikipedia.org/wiki/Anonymous_function)或 lambda 表达式的功能，它在 JSR 335（Java 编程语言的 Lambda 表达式）中，将在 Java 8 中提供。目前，只有匿名内部类接近。stackoverflow中的这个问题（[Java 中函数指针的最接近的替代品是什么？ ）可能会对您有所帮助。](https://stackoverflow.com/questions/122407/whats-the-nearest-substitute-for-a-function-pointer-in-java)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T13:54:03.170

您正在做出一些巨大的假设，即最快的代码只有在它是最终的静态方法时才会是。你很可能是错的，应该专注于正确地构建它并测试性能。

一种方法是使用敌人的，如上所述。我想说你应该做的是与 eval 函数有一个接口。然后，您可以传入接口的实现。

Java VM 将实现对代码的适当优化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T13:55:17.913

静态方法不能被覆盖，但您可以使用匿名类来实现：

```
public static class Function2 {
    public float eval(float a, float b){ return Float.NaN; }  
}

arrayOp(a, b, out, new Function2() {
    public float eval(float a, float b){
        return FAdd.eval(a, b);
    }}); 
```

请注意，Function2 中 eval() 的方法声明不是静态的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T11:05:04.023

我做了一些测试，似乎真的没有必要在现代机器上尝试优化它。

机器 1 -（我的旧家用电脑）32 位 WinXP，Intel Pentium 3，（我不确定 java 版本）对于 float.mult 和 float.add 两种操作，静态版本的速度快 2 倍以上

```
static  100000000 [ops]  406.0 [s]  4.06 [ns/op] 
dynamic 100000000 [ops]  1188.0 [s]  11.88 [ns/op] 
```

但是对于 float Sqrt 差异已经很小了

```
static  100000000 [ops]  922.0 [s]  9.22 [ns/op] 
dynamic 100000000 [ops]  1172.0 [s]  11.719999 [ns/op] 
```

机器 2 -（我的工作电脑） - 64 位 ubuntu 12.04LTS，Intel Core5，java 版本“1.6.0_12-ea，Java(TM) SE 运行时环境（build 1.6.0_12-ea-b02），Java HotSpot(TM) 64 位服务器 VM（内部版本 11.2-b01，混合模式）结果要好得多（对于 float.add）：

```
static  1000000000 [ops]  1747.0 [s]  1.7470001 [ns/op] 
dynamic 1000000000 [ops]  1750.0 [s]  1.75 [ns/op] 
```

所以 - 我认为处理器或 JIT 已经足够聪明了，无论如何都不需要优化这个函数传递。

注意： -没有传递函数的**静态**平均解决方案（我只是手动将操作内联到循环中）， -当我使用传递函数作为动态对象实例（不是静态类）时的**动态平均解决方案。**JIT 似乎理解类中没有动态数据，因此无论如何它都会在编译时解决它。

**所以我的动态解决方案很简单：**

```
public class Function2 {
  public float eval(float a, float b){ return Float.NaN; }  
}

public class FAdd extends Function2 {
  public float eval(float a, float b){ return a+b; }
}

public class FMult extends Function2 {
  public float eval(float a, float b){ return a*b; }  
}

public void arrayOp( float [] a, float [] b, float [] out, Function2 func ){
  for (int i=0; i<a.length; i++){     out[i] = func.eval( a[i], b[i] );   }
}

final int m = 100;
final int n = 10000000;
float t1,t2;
float [] a,b, out;
a = new float[n];   b = new float[n];   out = new float[n];
t1 = millis();
Function2 func = new FMult(); 
for (int i=0;i<m;i++) arrayOp( a,b, out, func );
t2 = millis();
println( " dynamic " +(n*m)+" [ops]  "+(t2-t1)+" [s]  "+ 1000000*((t2-t1)/(n*m))+" [ns/op] " ); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-15T13:53:20.087

您实际上是在实现中混合了实例和类。当你有一个这样声明的方法时：

```
void arrayOp( float [] a, float [] b, float [] out, Function2 func ){
   for (int i=0; i<a.length; i++){     out[i] = func.eval( a[i], b[i] );   }
} 
```

您基本上是在说您期望 class 的实例`Function2`，而不是真正的 class 参数。此语句在语法上也不正确：

```
arrayOp( a,b, out, FAdd ); 
```

因此，假设您想将类本身发送给一个方法，那么您的 arrayOp 声明将如下所示：

```
void arrayOp( float [] a, float [] b, float [] out, Class func ){ 
```

当你调用这个方法时，你会以这种方式传入参数：

```
arrayOp( a,b, out, FAdd.class ); 
```

但是静态方法不能通过继承覆盖。你需要一个完全不同的实现来实现你的目标。那就是说@OldCurmudgeon 为您的问题提供了一个非常好的解决方案。考虑使用它。

# android - 如何在 Android 上的地图 v2 上获取中心位置？

> ID：14338955
> 
> 赞同：4
> 
> 时间：2013-01-15T13:36:07.753
> 
> 标签：android, google-maps

*我想在我的Android*应用程序中搜索中心位置，

我正在使用*Android Google Maps v2*。

我知道我可以在使用后获得屏幕顶部*的**纬度*和经度，但是如何确定中心位置？*`Projection.fromScreenLocation`*

 ** * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T13:45:27.200

尝试使用`googleMap.getCameraPosition().target`

有关更多信息，请参阅[http://developer.android.com/reference/com/google/android/gms/maps/model/CameraPosition.html#target](http://developer.android.com/reference/com/google/android/gms/maps/model/CameraPosition.html#target)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-17T12:48:58.970

李先生，韩国人。

首先，您必须阅读[此 Android 官方指南](https://developers.google.com/maps/documentation/android/)

[其次，请从Android指南的Here中](https://developers.google.com/maps/documentation/android/intro#sample_code)获取参考上述文档的示例代码

三、你可以在下面的示例代码中找到你想知道的；

```
private void setUpMap() {
    mMap.setMyLocationEnabled(true); // if "false", MyLocation Button disappears.

} 
```

最后，请阅读[这个很好的教程](http://wptrafficanalyzer.in/blog/showing-current-location-in-google-maps-using-api-v2-with-supportmapfragment/)，你会得到很好的帮助。

有关 Google Maps API ve 的更多信息，请与居住在首尔的我联系。*

# php - 如何在 cron 作业中包含文件？

> ID：14338956
> 
> 赞同：0
> 
> 时间：2013-01-15T13:36:09.703
> 
> 标签：php, wordpress, cron

我在 MediaTemple (gs) 主机上运行 cron 作业，命令如下：

```
php5 /home/144061/data/test.php 
```

在 php 文件里面，还有 include 语句所在的位置。

cron 作业返回错误：

```
Warning: include(../domains/test.com/html/wp-blog-header.php): failed to open stream: No such file or directory in /nfs/c10/h02/mnt/144061/data/delete_seen.php on line 3

Warning: include(): Failed opening '../domains/test.com/html/wp-blog-header.php' for inclusion (include_path='.:/usr/local/php-5.3.15/share/pear') in /nfs/c10/h02/mnt/144061/data/delete_seen.php on line 3 
```

我希望能够在我的 cron 文件中包含 wordpress 标头，以便我可以在我的 cron 脚本中使用 wordpress 函数和数据库连接，我的 include 语句有什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-01-18T09:20:05.943

我用`set_include_path('/path/to/my/folder/');` 和之后 解决了`include('my-script.php')`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-14T19:15:01.157

如果有人仍在为此苦苦挣扎，请注意您的包含路径必须相对于您的 CRON 路径运行目录。否则，它将找不到您尝试包含的文件。例如，在 Cpanel 中，我使用了以下内容：`require('home/yourdomain/public_html/wp-load.php')`.

此外，您应该包含而不是包含标题，`wp-load.php`它包含所有核心 Wordpress 功能。

# ajax - 如何为 Ajax 请求永久修复 301 Moved

> ID：14338962
> 
> 赞同：2
> 
> 时间：2013-01-15T13:36:39.377
> 
> 标签：ajax, symfony, http-status-code-301

我的 ajax 请求在我的主机上以完美的方式运行，但是每当应用程序安装在服务器上时，所有请求的状态都是“301 永久移动”。

我已经调试了 3 天，但没办法。我不知道为什么我会得到这个。我正在使用 Symfony2。

这是服务器端的请求：

```
$('#edit').click(function () {
    var $validEmail = $('#mail').validator({
        type: 'error',
        rules: [{
            control: 'email',
            message: 'Format invalide'
        }]
    });
    var $validpost_code = $('#post_code').validator({
        type: 'error',
        rules: [{
            control: 'required',
            message: 'Code postal obligatoire'
        }]
    });
    var $validRs = $('#rs').validator({
        type: 'error',
        rules: [{
            control: 'required',
            message: 'Raison sociale obligatoire'
        }]
    });
    var $validAddr = $('#addr').validator({
        type: 'error',
        rules: [{
            control: 'required',
            message: 'Adresse obligatoire'
        }]
    });
    var $validPhone_number = $('#phone_number').validator({
        type: 'error',
        rules: [{
            control: 'required',
            message: 'Tel obligatoire'
        }]
    }) && $('#phone_number').validator({
        type: 'error',
        rules: [{
            control: 'phone',
            message: 'Format requise mask: +33 # ## ## ## ##'
        }]
    });

    var $validCountry = $('#country').validator({
        type: 'error',
        rules: [{
            control: 'required',
            message: 'Ville obligatoire'
        }]
    });
    var $validTown = $('#town').validator({
        type: 'error',
        rules: [{
            control: 'required',
            message: 'Pays obligatoire'
        }]
    });
    var $valid3897 = $('#3897').validator({
        type: 'error',
        rules: [{
            control: 'required',
            message: 'Forme juridique obligatoire obligatoire'
        }]
    });
    if ($validEmail && $validpost_code && $validRs && $validAddr && $validPhone_number && $validTown && $valid3897 && IsPosInteger($('#post_code').find('input').val())) {
        var data = {
            name: $('#name').find('input').val(),
            id: "{{client.id}}",
            post_code: $('#post_code').find('input').val(),
            rs: $('#rs').find('input').val(),
            address: $('#addr').find('input').val(),
            email: $('#mail').find('input').val(),
            effectif: $('#efectif').find('input').val(),
            turnover: $('#turnover').find('input').val(),
            siteWeb: $('#site').find('input').val(),
            phone_number: $('#phone_number').find('input').val(),
            country: $('#country').find('input').val(),
            town: $('#town').find('input').val(),
            fax: $('#number').find('input').val(),
            kbis: $('#bis').find('input').val(),
            vat: $('#vat').find('input').val(),
            legal_form: $('#3897').find('select').val(),
            active: $('#active').attr('checked'),
            groupe: $('#groupe').find('input').val(),
            business_sector: $('#sa').find('input').val()
        };
        $("#site_content").block();
        $.ajax({
            url: "{{url('Update_client')}}",
            type: "POST",
            dataType: 'json',
            data: {
                data: ODEANCE.toJson(data)
            },
            success: function (updateResponse) {
                if (updateResponse) {
                    $("#site_content").unblock(),
                    jAlert('Modification effectuée  avec sucées ', 'Modification') //,
                    //document.location=document.location
                }
            }
        });
    } else {
        jAlert('Veuillez vérifier les formats de vos champs', 'Modification');
    }
}); 
```

这里是控制器中的方法：

```
public function updateClientAction() {
    try {
        //Getting sended data 
        $data = $this->getRequest()->get('data');
        $data = \json_decode(\stripslashes($data));
        $spi = $this->get('spi');
        $clientManager = $spi->getClientManager();
        $updateResponse =($clientManager->update($data) == true ) ?  1 : 0;
        return new Response($updateResponse);
    } catch (\Exception $ex) {
        $updateResponse = 0;
        return new Response($updateResponse);
    }
} 
```

似乎请求的响应无法返回（请求的）原始位置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T14:16:07.653

1.  尝试直接浏览`{{url('Update_client')}}`
2.  `{{url('Update_client')}}`如果输出正确，请检查您的 html 源代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T13:42:39.343

几天后，现在问题已解决。这是 http 和 https 请求之间的冲突，所以我所做的就是用这条线强制我的应用程序到 https 端是 security.yml

```
access_control:        
      - { path: ^/,role: ROLE_USER, requires_channel: https } 
```

谢谢大家^^

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-15T20:34:21.140

万一这对其他人有帮助 - 我只是遇到了同样的问题，并通过使用 path() 而不是 url() 解决了它。使用 url() 调用被定向到 http，然后被重定向到 https，这很可能导致 301。使用 path() 调用被直接定向到 https。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-16T16:55:46.493

从 routing.yml 中的模式中删除尾部斜杠

# java - 为什么“F”+“alse”不是==“False”？

> ID：14338965
> 
> 赞同：13
> 
> 时间：2013-01-15T13:36:53.537
> 
> 标签：java, string-comparison

> **可能重复：**
> [如何比较 Java 中的字符串？](https://stackoverflow.com/questions/513832/how-do-i-compare-strings-in-java)

我不明白为什么声明的变量不一样。

前代码：

```
 String firstPart = "F";
 String whole = "False";
 String connected = firstPart + "alse";
 System.out.println(connected == whole); 
```

现在这会产生一个布尔值，我认为它会是“真的”，但事实并非如此，结果是错误的，我不明白为什么。

有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-15T13:38:14.413

您正在比较参考，而不是值。

您需要使用`equals`：

```
connected.equals(whole); 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-15T13:39:47.640

这个

```
String connected = firstPart + "alse"; 
```

创建一个*新* `String`对象，带有一个新的底层 char 数组和一个新的引用。

因此，当您比较参考文献（使用'==''）时，您将不会得到匹配。如果你比较实际的对象内容，`equals()`那么你会得到你想要的结果（因为`String.equals()`比较底层 char 数组的内容）

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-15T13:38:25.327

您应该使用比较字符串`equals()`。像这样：

`System.out.println(connected.equals(whole));`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T13:42:34.087

Java 不是 JavaScript - 比较运算符不同：

在 java`==`中的意思是“这两个对象是*同一个*实例吗？”，对应于 JavaScript 的`===`操作符。

在 java`.equals()`中 for String 的意思是“字符是否相同”，对应于 JavaScript 的`==`操作符。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-15T13:43:42.643

经验法则：`==`比较对象引用，而不是对象值。覆盖`equals`是定义对象之间相等性的标准方法（`String`包括在内，因为它是一个类，而不是原语）。

`firstPart`,`whole`并`connected`定义一个新的`String`each，所以它们的引用是不同的，即使`connected`和`whole`匹配`String`池中的相同，因为`==`不会考虑值。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-15T13:42:00.060

您应该使用 .equals() 方法来比较字符串...

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-01-15T13:42:00.180

本质上，只有 PDT 可以用 == 检查。这些是 byte、short、int、long、float、double、boolean、char，当然还有引用。由于您获得的两个引用是不同的对象，因此结果将是错误的。

对于任何 ADT（或对象），您必须使用 equals() 方法。所有 Java 对象都有它们，您也必须为自己的对象实现它。对于 String 对象，这已为您完成，并比较字符以测试相等性。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-15T13:41:35.503

当您使用“==”来比较字符串时，这意味着您想要比较它们的参考值而不是它们的值，在这种情况下将返回 false。

您需要使用`equals`将根据字符串所持有的值比较字符串的方法。

# android - Android Edittext 无法将光标移动到特殊位置（如第一行末尾）

> ID：14338967
> 
> 赞同：0
> 
> 时间：2013-01-15T13:36:55.993
> 
> 标签：android, cursor, android-edittext, move

**多行时，强文本**Android`edittext`小部件无法将光标移动到行尾（例如第一行的末尾）。
我们可以使用`Selection.setSelection`将光标设置到某个位置，但我们不能将其移动到第一行的末尾。

# windows-phone-7 - 我们可以在 Windows Phone 8 上安装 Windows Phone 7 SDK 开发的应用程序吗？

> ID：14338971
> 
> 赞同：0
> 
> 时间：2013-01-15T13:37:07.037
> 
> 标签：windows-phone-7, window, windows-phone-8, windows-phone-7.1.1

请推荐某人。我是新的 Wndows Phone 开发人员。我们可以在 Windows Phone 8 上安装 Windows Phone 7 SDK 开发的应用程序吗？

我已经在我的系统上安装了 Windows 7，当我尝试下载并安装 Windows Phone 8 SDK 时，微软表示 Windows Phone 8 SDK 需要 Windows 8。这是 SDK 的下载链接：http: [//www.microsoft.com/en-in/download/details.aspx?id=35471](http://www.microsoft.com/en-in/download/details.aspx?id=35471)

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T14:29:26.600

当然，所有 Windows Phone 7 应用程序都可以在 Windows Phone 8 上运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:47:01.117

只是为了做出明确的回答：是的，你可以。我一直这样做。您将需要一台装有 WP8 SDK（包括 7 SDK）的 64 位 Windows 8 机器才能将您的 WP7 应用程序部署到 WP8 手机。它以它一贯的方式工作：只需从 VS 中运行（唯一的区别是您不需要 Zune 来部署到 WP8 设备）。您还可以使用 WP 应用程序部署工具在 VS2012 之外部署任何 .xap 文件（即使它是在 Win7 机器上构建的，但您仍然需要使用该工具部署 Win8+WP8 SDK）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T14:50:31.067

当您拥有 Windows Phone 8 SDK 时，您还可以为 Windows Phone 7 开发应用程序。WP8 有一些新功能。当您不使用此功能时，应用程序将在 Windows Phone 7 上成功运行。 [http://www.phonearena.com/news/Will-Windows-Phone-77.5-apps-work-on-Windows-Phone-8_id34959](http://www.phonearena.com/news/Will-Windows-Phone-77.5-apps-work-on-Windows-Phone-8_id34959)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T13:44:04.473

你自己说的。您的系统上安装了 Windows 7，并且 Windows Phone 8 SDK 需要安装了 Windows 8 的系统。所以，答案是否定的。

如果我没记错的话，使用 Windows Phone 7.5 SDK 开发的应用程序可以“转换”为 Windows Phone 8 应用程序。为此，您必须在安装了新的 Windows Phone 8 SDK 的 Visual Studio 2012 中打开 7.5 解决方案。我不确定这是否有效，但这适用于将 Windows Phone 7 应用程序转换为 Windows Phone 7.5 应用程序。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-01-15T14:58:45.840

如果你想为 Windows Phone 8 开发应用程序，你必须将你的操作系统更新到 Windows 8，然后安装 WP8 SDK 就可以了。
如果您不想安装 Windows 8，只需下载[Windows Phone 7.1 SDK](http://www.microsoft.com/en-us/download/details.aspx?id=27570)并在 Windows 7 上使用它。为 Windows Phone 7 开发的应用程序可以在 Windows Phone 8 设备上正常运行。

# android - Air for Android - 通过菜单和调用共享是否存在错误？

> ID：14338973
> 
> 赞同：2
> 
> 时间：2013-01-15T13:37:16.703
> 
> 标签：android, air, share

我正在使用适用于 Android 的 Air 创建一个消息传递应用程序。我想让其他应用程序**通过**菜单选项共享文本到我的应用程序。我的应用程序在菜单中列出，但在调用后只收到一个空字符串。这是一个已知的错误？

调用事件：

```
NativeApplication.nativeApplication.addEventListener(InvokeEvent.INVOKE, onAppInvoke);

function onAppInvoke(event:InvokeEvent):void {
 info.text = event.arguments.toString()
} 
```

app.xml 清单：

```
<allowBrowserInvocation>true</allowBrowserInvocation>
  <android>
    <manifestAdditions>
      <![CDATA[
        <manifest android:installLocation="auto">
<uses-permission android:name="android.permission.INTERNET"/>
            <application>             
          <activity>
 <intent-filter>
  <action android:name="android.intent.action.SEND" />
  <category android:name="android.intent.category.DEFAULT" />
  <data android:mimeType="text/*"/>
  </intent-filter>            
                    <intent-filter>
                        <action android:name="android.intent.action.MAIN"/>
                        <category android:name="android.intent.category.LAUNCHER"/>
                    </intent-filter>
                    <intent-filter>
                        <action android:name="android.intent.action.VIEW"/>
                        <category android:name="android.intent.category.BROWSABLE"/>
                        <category android:name="android.intent.category.DEFAULT"/>
                        <data android:scheme="myapp"/> 
                    </intent-filter>
                        </activity>
            </application>
        </manifest>
    ]]>
    </manifestAdditions>
  </android> 
```

欢迎任何想法！

# android - Android EditText 删除键停止工作

> ID：14338976
> 
> 赞同：1
> 
> 时间：2013-01-15T13:37:23.537
> 
> 标签：android, android-edittext, key

我已经在这个问题上工作了 3 天，但我无处可去，

好的，我有一个编辑文本框，

```
 <EditText
     android:id="@+id/inputSearch"
     android:layout_width="match_parent"
     android:layout_height="0dp"
     android:inputType="textNoSuggestions"
     android:hint="Search contacts...."
     android:visibility="invisible"
     android:singleLine="true" 
    /> 
```

在 ListView ( [https://github.com/woozzu/IndexableListView](https://github.com/woozzu/IndexableListView) )的顶部

```
 <com.mb.contactlist.IndexableListView
        android:id="@+id/tab_contact_list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:divider="@color/d_gray"
        android:dividerHeight="1dp"
        android:fastScrollEnabled="true"
        android:focusable="true"
        android:longClickable="true"
        android:paddingLeft="10dp"
        android:paddingRight="30dp" >
    </com.mb.contactlist.IndexableListView> 
```

很简单，所以我的 CursorAdapter 实现了 SectionIndexer，Filterable

```
 @Override
    public Cursor runQueryOnBackgroundThread(CharSequence constraint) 
   {
        Log.d(""," Cursor chars = " + constraint);
        StringBuilder buffer = null;
        String[] args = null;
        if (constraint != null) 
        {
            //Activity activity = (Activity) iContext;
            buffer = new StringBuilder();
            buffer.append(ContactsContract.Contacts.HAS_PHONE_NUMBER + " > 0 AND ");
            buffer.append(ContactsContract.Contacts.IN_VISIBLE_GROUP + " == 1 AND ");
            buffer.append("UPPER( " + ContactsContract.Contacts.DISPLAY_NAME + ")");
            buffer.append(" like ? ");
            args = new String[]{"%" + constraint.toString().toUpperCase() + "%"};

            Cursor c  = iContext.getContentResolver().query(ContactsContract.Contacts.CONTENT_URI, 
                null, 
                buffer.toString(), 
                args, 
                "UPPER(" + ContactsContract.Contacts.DISPLAY_NAME + ") ASC");

            Log.d(""," Cursor count = " + c.getCount());
            return c; 
        }
        Log.d(""," returning null");
        return null;  
    } 
```

以上是我的过滤器查询...所以到目前为止一切都很好...

inputSearch = (EditText) root.findViewById(R.id.inputSearch); // 搜索 // 文本

```
inputSearch.addTextChangedListener(new TextWatcher() 
{
    public void afterTextChanged(Editable s) 
    {
            lst.setTextFilterEnabled(true);
            lst.setFilterText(s.toString());                
    }
     } 
```

所以我想要做的就是允许某人在列表视图中搜索联系人，该部分工作正常并且工作正常。直到您错过输入名称并想按退格键，第一个删除命令才起作用，然后就是这样，您无法从编辑文本中删除更多字符...

我究竟做错了什么？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T18:25:48.653

我使用的是magictextview，这导致了这个问题。

# javascript - 如何确定正在删除页面上的元素的 javascript？

> ID：14338986
> 
> 赞同：1
> 
> 时间：2013-01-15T13:38:02.877
> 
> 标签：javascript

我有一个 html 页面，在经过一定时间后，会从 DOM 中删除或删除特定元素。

该元素是一个 id 为“workspace”的 div。

页面中加载了*许多*第三方脚本，一段时间后，“工作区”元素被删除，但我不知道为什么。

如何确定哪个 javascript 库正在删除“工作区”元素？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T13:40:32.473

如果您使用的是 chrome，您可以转到元素选项卡，右键单击元素（在删除之前），然后单击 break on... -> 子树修改。当这个元素被改变时，这应该会破坏 javascript 的权利。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T13:43:15.520

使用 Chrome，并在“元素”检查器中找到该元素。

*   如果可以看到元素，请右键单击它，然后选择“检查元素”。
*   如果看不到元素，请通过在菜单中选择以下选项来调出“元素”检查器：

    **查看 | 开发商 | 开发者工具**

在“元素”检查器中右键单击元素的名称或节点，然后在弹出菜单中选择以下内容：

*   **休息 | 节点移除**

现在调试器将在项目被删除时启动！

# javascript - 定时器不工作

> ID：14338987
> 
> 赞同：-2
> 
> 时间：2013-01-15T13:38:10.183
> 
> 标签：javascript, jquery

我的问题是计时器没有正确暂停。当我点击暂停时，它看起来已经停止但实际上它继续循环，当我点击开始时，它不会从我暂停的地方继续，而是从它到达的位置继续。

```
<div class="stopwatch">
    <span>00:00:00,000</span><br />
    <div class="btn start">play</div>
    <div class="btn pause">pause</div>
    <div class="btn reset">reset</div>
</div> 
```

```
$(function (){  
    var reload = 1000/60;  
    var timer = null;  
    var startTime = 0;  
    var btn = $('.stopwatch a');  
    var count = $('.stopwatch span');  
    var pause = false;

    $('.pause').click(function (){
        pause = true; 
    });
    $('.start').click(function (){
        pause = false; 
    });
    $('.reset').click(function (){
        return ( (count.text('00:00:00,000')) && (timer = 0) );
    });

    function zero(num, length) {  
        if ( typeof(length) == 'undefined' ) length = 2;  

        while ( num.toString().length < length ) {  
            num = '0' + num;  
        }  
        return num;  
    }  

    function zero_format(time){  
        return zero(time.getUTCHours()) + ':' + zero(time.getMinutes()) + ':' + zero(time.getSeconds()) + ',' + zero(time.getMilliseconds()); 
    }  

    $('.start').click( function (){  
        if ( !timer ){  
            startTime = new Date();  
            timer = setInterval( function (){  
                if ( pause ){
                    return;
                }

                var currentTime = new Date(new Date() - startTime);  
                count.text(zero_format(currentTime));  
            }, reload);
        }
        return false;
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:45:54.567

您需要调整 startTime 变量，因为您仍在计算与第一次按下 start 时创建的 datetime 的时间差异

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:46:45.403

你有两个处理程序`$('.start')`。

试试这个：[现场演示](http://jsfiddle.net/ryXMy/)

```
$('.start').click(function (){  
    if ( !timer ){  
        startTime = new Date();  
        timer = setInterval( function (){  
            if ( pause ){
                return;
            }

            var currentTime = new Date(new Date() - startTime);  
            count.text(zero_format(currentTime));  
        }, reload);
    } else {
        pause = false; 
    }

    return false;
}); 
```

并**删除**这个：

```
$('.start').click(function (){
    pause = false; 
}); 
```

**更新 1**

如果您需要秒表，而不是单圈计时器，那么这里是代码：[现场演示](http://jsfiddle.net/H3ds3/)

```
var savedTime;
var additional = 0;

$('.pause').click(function (){
    savedTime = new Date(); 
    pause = true; 
});

$('.reset').click(function (){
    count.text('00:00:00,000');
    clearInterval(timer);
    timer = null;
    additional = 0;
});

$('.start').click( function (){  
    if ( !timer ){  
              startTime = new Date();  
        timer = setInterval( function (){  
            if ( pause ){
                return;
            }

            currentTime = new Date(new Date() - startTime - additional);  
            count.text(zero_format(currentTime));  
        }, reload);

        pause = false;
    }

    if(pause == true) {
        additional += new Date() - savedTime;
        pause = false; 
    }

   return false;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T13:51:17.367

我会提升`currentTime`到外部范围并跟踪外部范围中最后一次滴答的时间。然后在每个滴答声中，`currentTime`通过添加最后一个滴答声和当前滴答声之间的差异来更新，而不是自开始以来的时间。这样它就会被适当地暂停。

此外，您还需要`currentTime`在第一次暂停时添加并在重新启动时重置最后一个刻度。

# mysql - MySQL 连接和第二个表中的字段作为结果中的列

> ID：14338996
> 
> 赞同：0
> 
> 时间：2013-01-15T13:38:28.673
> 
> 标签：mysql, join

我想知道我的方法是否足够、可能，我该怎么做？

假设您有 2 个 MySQL 表：

**表A**

```
ID   alias     
--   --
11   banner_a
26   banner_b 
```

**表 B**

```
Column  Type
pid         int(10) 
lang    varchar(2)  
field   varchar(255)    
value   text 
```

以及表 B 的示例数据：

```
id  lang    field               value

26  da      banner_type         single
26  da      priority            5
26  da      timing              5

26  de      banner_type         single
26  de      priority            1
26  de      timing              10 
```

所以，假设我想从表 A 中选择所有/一些记录，以及它们的相关字段，其中包含表 B 中的值，按 lang 分组。其中表 B 中的字段被选择为 MySQL 中的常规列，它的值将是字段的值。

期待看到这样的结果：

结果记录1：

```
id 26
alias banner_b
lang da
banner_type single
priority 5
timing 5 
```

结果记录2：

```
id 26
alias banner_b
lang de
banner_type single
priority 5
timing 5 
```

几年前我做过类似的事情，我想是用 COALESCE 做的，但这不是我想要的。

如果有的话，我应该从哪里开始？:-)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:42:17.013

试试这个：

```
SELECT
  b.id, 
  b.lang,
  MAX(CASE WHEN b.field = 'banner_type' THEN b.value END) AS 'banner_type',
  MAX(CASE WHEN b.field = 'priority' THEN b.value END) AS 'priority',
  MAX(CASE WHEN b.field = 'timing' THEN b.value END) AS 'timing'
FROM TableA a
INNER JOIN TableB b ON a.ID = b.ID
GROUP BY b.id, b.lang; 
```

## [SQL 小提琴演示](http://www.sqlfiddle.com/#!2/32bf7/7)

这会给你：

```
| ID | LANG | BANNER_TYPE | PRIORITY | TIMING |
-----------------------------------------------
| 26 |   da |      single |        5 |      5 |
| 26 |   de |      single |        1 |     10 | 
```

**请注意：**在我使用的查询中`MAX`。因为，`id lang`表中的每个组`TableB`都有两个值，`BANNER_TYPE | PRIORITY | TIMING`所以您想要每个组的哪个值？

# java - HTTP Put 设置内容类型

> ID：14338997
> 
> 赞同：0
> 
> 时间：2013-01-15T13:38:30.530
> 
> 标签：java, http, content-type, http-put

如何将 HTTP Put 的内容类型设置为 xxxx+xml？

我指的是这个链接[Android 中的解决方案，通过 HTTP POST (SOAP) 发送 XML](https://stackoverflow.com/questions/2559948/android-sending-xml-via-http-post-soap)。当我们像这样设置内容类型时很好，我的意思是 xml 是随请求一起提供的：

```
httppost.setHeader("Content-Type","application/soap+xml;charset=UTF-8"); 
```

但是当我将**soap**类型更改为自定义时，xml会在请求中消失（我在wireshark上看到），如下所示：

```
httppost.setHeader("Content-Type","application/vnd.oma-pcc+xml;charset=UTF-8"); 
```

然后，我尝试只放置 xml，所以请求再次正常：

```
httppost.setHeader("Content-Type","application/xml;charset=UTF-8"); 
```

我想知道内容类型的确切规则是什么，而不是与 xml 类型一起使用，以便 xml 仍然存在。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T15:00:30.097

假设您使用的是 4.1.3 或更高版本的 HTTPClient -

在构建实体时，您可以选择指定用于某些实体的 POST 或 PUT 操作的内容。

有一个[ContentType](http://hc.apache.org/httpcomponents-core-ga/httpcore/apidocs/org/apache/http/entity/ContentType.html)对象应该用来指定它。

使用工厂方法 .create() 您可以使用字符集指定 mimetype - 框架将使用 ContentType 来正确发出有问题的标头。

示例 API 调用：

`ContentType.create("application/vnd.oma-pcc+xml", CharSet.forName("UTF-8"));`

**注意 HttpClient 4.1.2 的编辑**

在 4.1.2 的情况下，当您为 post 或 put 操作创建实体时，使用 setContentType(String) 设置***实体***上的内容类型而不是***执行***（HttpPost 或 HttpPut）。这在 4.1.3 及更高版本中已弃用。

# vb.net - 使用组合框 VB.NET 进行数据库记录搜索

> ID：14338998
> 
> 赞同：0
> 
> 时间：2013-01-15T13:38:32.300
> 
> 标签：vb.net, sql-server-2005, combobox

我尝试使用 cmbo 框在 sql 数据库中搜索数据记录。在此“附近的语法不正确”之后显示错误“找不到多部分标识符“System.Data.DataRowView”。我的代码如下。

```
 Private Sub BTNEDIT_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles BTNEDIT.Click
    refreshComboBox()
    CMBID.SelectedText = "Select"
 End Sub

 Private Sub refreshComboBox()
    getConnect()
    Try
        Conn.Open()
        Dim strSQL As String = "SELECT * FROM EMPLOYEE ORDER BY EMP_ID ASC"
        Dim da As New SqlDataAdapter(strSQL, Conn)
        Dim ds As New DataSet
        da.Fill(ds, "EMPLOYEE")
        CMBID.DataSource = ds.Tables(0)
        CMBID.DisplayMember = "EMP_ID"
        CMBID.ValueMember = "ID"
        CMBID.SelectedValue = 0
        CMBID.Invalidate()
    Catch ex As Exception
        MessageBox.Show(ex.Message)
    Finally
        Conn.Close()
    End Try
End Sub

Private Sub CMBID_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles CMBID.SelectedIndexChanged
    Dim gend As String
    getConnect()
    Dim strSQL As String = "SELECT * FROM EMPLOYEE WHERE EMP_ID=" & CMBID.Text & ""
    Try
        Dim da As SqlDataAdapter = New SqlDataAdapter(strSQL, Conn)
        Dim ds As DataSet = New DataSet
        da.Fill(ds, "EMPLOYEE")
        Dim dt As DataTable = ds.Tables("EMPLOYEE")
        Dim row As DataRow
        For Each row In dt.Rows
            ID.Text = row("ID")
            TXTNAME.Text = row("EMP_NAME")
            TXTFNAME.Text = row("EMP_FNAME")
            gend = row("EMP_GENDER")
            If gend = "MALE" Then
                RBMALE.Checked = True
                RBFEMALE.Checked = False
            ElseIf gend = "FEMALE" Then
                RBFEMALE.Checked = True
                RBMALE.Checked = False
            End If
            DTPEMPDOB.Value = row("EMP_DOB")
            TXTCASTE.Text = row("EMP_CAST")
            CMBDEPT.Text = row("EMP_DEPART")
            CMBDESIG.Text = row("EMP_DESIG")
            DTPEMPDOJ.Value = row("EMP_DOJ")
            MTXTSAL.Text = row("EMP_SALARY")
            MTXTPFESI.Text = row("EMP_PF_ESI")
            TXTBRANCH.Text = row("EMP_BRANCH")
            MTXTCONTACT.Text = row("EMP_CONTACT")
            RTXTADDRESS.Text = row("EMP_ADDRESS")
        Next row
    Catch ex As Exception
        MessageBox.Show(ex.Message)
    Finally
        Conn.Close()
    End Try
End Sub 
```

请尝试检查我的代码并给我解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T13:53:43.280

```
 Dim strSQL As String = "SELECT * FROM EMPLOYEE ORDER BY EMP_ID ASC"
    Dim da As New SqlDataAdapter(strSQL, Conn)
    Dim ds As New DataSet
    da.Fill(ds, "EMPLOYEE")
    CMBID.DataSource = ds.Tables(0)
    CMBID.DisplayMember = "EMP_ID"
    CMBID.ValueMember = "ID"
    CMBID.SelectedValue = Nothing
    //CMBID.Invalidate()

Private Sub CMBID_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles CMBID.SelectedIndexChanged
{
  If clientComboBox.SelectedValue Is Nothing Then
Return
  End If

  If CMBID.SelectedValue.toString() = "System.Data.DataRowView" Then
Return
  End If
   //Do stuff

} 
```

# mysql - 使用 If 或 Case（或任何其他方法）根据国家/地区代码增加值

> ID：14338999
> 
> 赞同：0
> 
> 时间：2013-01-15T13:38:34.017
> 
> 标签：mysql, sql

我有这样构建的表，它为每个用户分配一个唯一的 articleId，从零开始。

```
CREATE TABLE `articles` (
  `artcId` INT(10) NOT NULL AUTO_INCREMENT,
  `artcUserId` INT(10) NOT NULL DEFAULT '0',
  `artcStackId` INT(10) NOT NULL DEFAULT '0',
  `artcTitle` VARCHAR(200) NULL DEFAULT NULL,
  PRIMARY KEY (`artcUserId`, `artcId`)
)
COLLATE='utf8_general_ci'
ENGINE=MyISAM; 
```

还有一个部分为每篇文章分配一个运行序列号（artcStackId）。你会在代码中看到。

问题是，是否可以根据用户所在的国家/地区分配一个 artcStackId ？该国家/地区代码将来自 php。

例如：如果是美国则从 10001+1 开始，如果其英国从 20001+1 开始，如果其 CA 则从 30001+1 开始，以此类推。

有可能做到这一点吗？

我当前的 SQL 查询如下：

```
insert into articles (artcUserId, artcStackId, artcCountry, artcTitle)
select 4,IFNULL((MAX(artcStackId)+1) ,0),'US','Hello World'
FROM articles; 
```

但我想要它的方式必须像（这只是一个示例 sql）：

```
insert into articles (artcUserId, artcStackId, artcCountry, artcTitle)
select 4, IF artcCountry = 'US' then (selct MAX(artcStackId)+1
                                      where artcCountry = 'US'),
       'US','Hello World'
FROM articles; 
```

我希望你能明白。

![在此处输入图像描述](../Images/b8d58bac3ddb5ea886be5b896f170aa7.png) ![在此处输入图像描述](../Images/3890bd7b83001e1c9ffa4680f748f105.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T13:53:21.590

我建议你使用触发器：

```
CREATE TRIGGER ins_articles
BEFORE INSERT ON articles
FOR EACH ROW
  SET new.artcStackId=coalesce(
    (select max(artcStackId)
    from articles
    where artcCountry = new.artcCountry)+1,1)
; 
```

或类似的东西：

```
CREATE TRIGGER ins_articles
BEFORE INSERT ON articles
FOR EACH ROW
  SET new.artcStackId=coalesce(
    (select max(artcStackId)
    from articles
    where artcCountry = new.artcCountry)+1,

    case when new.artcCountry = 'US' then 10001
         when new.artcCountry = 'UK' then 20001
         when new.artcCountry = 'CA' then 30001
    end)
; 
```

[看到它在这里工作](http://sqlfiddle.com/#!2/da57d/1)。然后您可以在不指定列 artcStackId 的情况下插入，因为它会自动计算。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T13:45:03.497

`artcStackId`从技术上讲，这将起作用，但您可能会在重负载期间遇到重复值的问题。它也不太可能非常有效。

```
INSERT INTO articles (artcUserId,artcStackId,artcCountry,artcTitle) 
SELECT 4,MAX(artcStackId)+1,'US','Hello World' 
FROM articles
WHERE artcCountry = 'US' LIMIT 1 
```

此外，这假设该 article 表已经具有该国家/地区的至少一行。

更好的选择可能是有一个`country`带有`nextStackId`值的表。在事务中，更新该表中的下一个堆栈 ID，选择更新后的值，将其用于插入，然后提交事务。那应该安全得多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T16:00:02.680

如果您创建一个名为 Cities 的新表，其中 idCity 和 numberBeg 作为字段，并且您将知道从哪个数字开始计数的关系，会发生什么情况