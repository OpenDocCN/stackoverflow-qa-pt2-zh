# StackOverflow 问答 12715000-12715999

# sql - 有没有一种更简单、更快捷的方法来删除具有对其他表的外键引用的表？

> ID：12715001
> 
> 赞同：5
> 
> 时间：2012-10-03T18:56:48.567
> 
> 标签：sql, sql-server, tsql, foreign-keys, sql-drop

我有一个新表，其中包含对许多现有表的外键引用。当我第一次创建新表时，我通过以下方式创建了外键：

```
ALTER TABLE [dbo].[NewTable] WITH CHECK ADD FOREIGN KEY([SectionDatabaseID])
REFERENCES [dbo].[Section] ([SectionDatabaseID])

ALTER TABLE [dbo].[NewTable] WITH CHECK ADD FOREIGN KEY([TermDatabaseID])
REFERENCES [dbo].[Term] ([TermDatabaseID]) 
```

上述方式将使用它自己的自动命名约定为外键约束生成名称。

但是，我想删除新表，因为我需要通过从头开始创建它来进行一些重大修改。

显然，如果我只是执行一个 drop 语句，SQL Server 数据库会抱怨说新表有对其他表的外键引用。

我听说过运行以下脚本来确定存在哪些外键，以便我们可以删除它们：

```
use perls;
SELECT 'ALTER TABLE ' + TABLE_SCHEMA + '.[' + TABLE_NAME +
'] DROP CONSTRAINT [' + CONSTRAINT_NAME + ']'
FROM information_schema.table_constraints
WHERE CONSTRAINT_TYPE = 'FOREIGN KEY' and TABLE_NAME = 'NewTable' 
```

以上将给出基本上显示我需要运行的更改语句的结果。

我需要更自动化的东西。为什么我必须单独删除每个外键约束，然后只能删除表？

我想以更简单的方式删除表格。它必须比我上面需要做的更容易。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T19:12:29.920

关系数据库旨在强制执行数据库完整性。您的陈述可能会破坏为保护数据质量而精心添加的约束。自动从生产数据库中删除完整性约束对公司来说可能是一场灾难。所以在开发 SQL 语言时，很容易删除被其他表引用的表在重要任务的优先级上并不高。借助用于企业数据的数据库引擎，该产品更适合 DBA 而不是临时用户。

想要删除在外键中引用的多个表的原因是什么？你能确定你不会破坏别人的查询吗？

假设您正在开发一个非关键系统，您编写脚本来编写放置脚本的方法是我所知道的最佳解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T19:21:54.387

是的，您必须先放下 FK。我之前遇到过这种情况，并且只编写了自动化任务所需的脚本。替换下面的 DBName 和 TABLENAME。

*对所有人的警告：此脚本将删除特定表（或表组）以及所有 FK 约束！请谨慎使用，并在执行此类主要操作之前始终进行数据库备份。*

```
 use DBName
    /* 
    SCRIPT TO DROP TABLES WITH FK'S, INDEXES 
    https://mellodev.snipt.net/drop-tables-with-fk-contraints/
    */

    set nocount on

declare @tables table (tablename varchar(255));
insert into @tables
select name from sys.tables where name in 
('TABLENAME')

-- Iterate tables, drop FK constraints and tables
declare @tablename varchar(255);
declare cTable cursor for
select tablename from @tables
open cTable
fetch next from cTable into @tableName
while @@FETCH_STATUS=0
begin
    -- Identify any FK constraints
    declare @fkCount int;
    SELECT @fkCount = COUNT(*)
    FROM sys.foreign_keys
    WHERE referenced_object_id = object_id(@tablename)

    -- Drop any FK constraints from the table
    if (@fkCount>0) begin
        declare @dropFkSql nvarchar(max);set @dropFkSql='';
        declare @fkName nvarchar(max);
        declare cDropFk cursor for  
            SELECT 'ALTER TABLE [' + OBJECT_NAME(parent_object_id) + '] DROP CONSTRAINT [' + name + ']',name
            FROM sys.foreign_keys
            WHERE referenced_object_id = object_id(@tablename)
        open cDropFk
        fetch next from cDropFk into @dropfksql,@fkName
        while @@FETCH_STATUS=0
        begin       
            exec sp_executesql @dropFkSql;

            select 'Dropped FK Constraint: ' + @fkName
            fetch next from cDropFk into @dropfksql,@fkName
        end
        close cDropFk
        deallocate cDropFk          
    end

    -- Drop the table
    declare @dropTableSql nvarchar(max);
    set @dropTableSql='DROP TABLE [' + @tablename + ']';
    exec sp_executesql @dropTableSql;

    select 'Dropped table: ' + @tablename

    fetch next from cTable into @tableName
end
close cTable
deallocate cTable 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T19:34:38.767

如果您使用的是 MSSQL，那么您可以使用我编写的这个脚本从数据中清除整个数据库，而不会删除表本身。

```
use [MyDataBase]
GO

EXEC sp_MSForEachTable 'ALTER TABLE ? NOCHECK CONSTRAINT ALL';

select tbl.* into dbo.DeleteQueries from (SELECT 'DELETE ' + name + ';' as query
FROM sys.tables
WHERE name <> 'DeleteQueries')  as tbl

Declare @query nvarchar(100)

While (Select Count(*) From dbo.DeleteQueries Where query <> '') > 0
Begin
    Select Top 1 @query = query From dbo.DeleteQueries Where query <> ''

    exec(@query);

    Update dbo.DeleteQueries Set query = '' Where query = @query 

End

DROP TABLE dbo.DeleteQueries

EXEC sp_MSForEachTable 'ALTER TABLE ? CHECK CONSTRAINT ALL' 
```

您可以在“select into”查询的 where 子句中添加不想清除的表。希望这可以帮助

# c++ - 在 CMake 中添加 C++0x 支持

> ID：12715005
> 
> 赞同：12
> 
> 时间：2012-10-03T18:57:14.060
> 
> 标签：c++, c++11, cmake

我在 CMake 中配置了一个相当大的应用程序。我最近添加了几个使用 C++0x 功能的类，它破坏了构建，因为 CMake 未配置为使用 C++0x 支持进行编译。如何将其添加为 CMake 的选项？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-03T18:59:44.217

您需要将标志添加到`CMAKE_CXX_FLAGS`：

```
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++0x") 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-03T19:21:04.873

我将此片段用于 GCC，但它是一种更复杂的方式：

```
if(CMAKE_COMPILER_IS_GNUCXX)
   SET(ENABLE_CXX11 "-std=c++11")

   EXECUTE_PROCESS(COMMAND "${CMAKE_CXX_COMPILER} -dumpversion" OUTPUT_VARIABLE GCC_VERSION)
   if (GCC_VERSION VERSION_LESS 4.7)
      SET(ENABLE_CXX11 "-std=c++0x")
   endif()

   SET(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${ENABLE_CXX11}")
endif() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T19:27:30.943

我有以下模块：

```
$ cat FindCXX11.cmake
# - Finds if the compiler has C++11 support
# This module can be used to detect compiler flags for using C++11, and checks
# a small subset of the language.
#
# The following variables are set:
#   CXX11_FLAGS - flags to add to the CXX compiler for C++11 support
#   CXX11_FOUND - true if the compiler supports C++11
#
# TODO: When compilers starts implementing the whole C++11, check the full set

include(CheckCXXSourceCompiles)
include(FindPackageHandleStandardArgs)

set(CXX11_FLAG_CANDIDATES
    # GNU and Intel Linux
    "-std=c++0x"
    # Microsoft Visual Studio, and everything that automatically accepts C++11
    " "
    #Intel Windows
    "/Qstd=c++0x"
    )

set(CXX11_TEST_SOURCE
"
class Matrix
{
public:
    Matrix(int a, int b, int c, int d)
        : data {a, b, c, d}
    {}

private:
    int data[4];
};

int main()
{
    int n[] {4,7,6,1,2};
    for (auto i : n)
        Matrix mat (3,5,1,2);
    return 0;
}
")

foreach(FLAG ${CXX11_FLAG_CANDIDATES})
    set(SAFE_CMAKE_REQUIRED_FLAGS "${CMAKE_REQUIRED_FLAGS}")
    set(CMAKE_REQUIRED_FLAGS "${FLAG}")
    unset(CXX11_FLAG_DETECTED CACHE)
    message(STATUS "Try C++11 flag = [${FLAG}]")
    check_cxx_source_compiles("${CXX11_TEST_SOURCE}" CXX11_FLAG_DETECTED)
    set(CMAKE_REQUIRED_FLAGS "${SAFE_CMAKE_REQUIRED_FLAGS}")
    if(CXX11_FLAG_DETECTED)
        set(CXX11_FLAGS_INTERNAL "${FLAG}")
        break()
    endif(CXX11_FLAG_DETECTED)
endforeach(FLAG ${CXX11_FLAG_CANDIDATES})

set(CXX11_FLAGS "${CXX11_FLAGS_INTERNAL}")

find_package_handle_standard_args(CXX11 DEFAULT_MSG CXX11_FLAGS)
mark_as_advanced(CXX11_FLAGS) 
```

我用它来检查编译器是否支持我正在使用的 C++11 的子集（实际上现在这是多余的，因为我正在使用更多）。很容易进一步构建它并添加更多功能，并添加其他编译器开关。实际上，如果我没记错的话，到目前为止我发现的唯一通过此测试的编译器是 GCC >= 4.6 和 Clang >= 3.1。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-20T21:38:03.200

如[this answer](https://stackoverflow.com/a/20165519/648162)所示，最好使用`target_compile_features`要求支持您需要的特定功能。

这可以更好地解释/记录您的代码所需的功能，跨平台兼容，并且如果所需功能在其编译器中不可用，将为用户提供更有用的错误消息。

在此选项的[手册页中：](https://cmake.org/cmake/help/v3.1/command/target_compile_features.html)

> ```
> target_compile_features 
> ```
> 
> 将预期的编译器功能添加到目标。
> 
> ```
> target_compile_features(<target> <PRIVATE|PUBLIC|INTERFACE> <feature> [...]) 
> ```
> 
> 指定编译给定目标时所需的编译器功能。如果该特性没有在 CMAKE_C_COMPILE_FEATURES 变量或 CMAKE_CXX_COMPILE_FEATURES 变量中列出，那么 CMake 会报错。如果使用该功能需要额外的编译器标志，例如`-std=gnu++11`，该标志将被自动添加。

可以用这个宏测试的（希望是完整的）特性列表在[这里](https://cmake.org/cmake/help/v3.1/prop_gbl/CMAKE_CXX_KNOWN_FEATURES.html#prop_gbl:CMAKE_CXX_KNOWN_FEATURES)。

# android - 在android的锁定屏幕下运行

> ID：12715006
> 
> 赞同：0
> 
> 时间：2012-10-03T18:57:23.357
> 
> 标签：android

我是一名 Windows 手机开发人员，将我的应用程序移植到 android。我是安卓新手...

Windows Phone 有一个“锁定模式”，用户可以在其中锁定手机以摆脱口袋拨号和其他意外手势等问题。锁定模式与关闭手机不同。如果我们将应用程序设置为这样，当手机处于锁定模式时，我们的 WP7 应用程序可以继续在前台运行。

在Android中有这样的锁定模式吗？当手机处于锁定模式时，我们是否需要做一些特别的事情才能继续在前台运行？我们可以检测到我们何时在锁定模式下运行吗？谢谢，加里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:19:35.960

当屏幕关闭时，手机就关闭了。如果您想在屏幕熄灭时继续处理，您可以按住[唤醒锁](http://developer.android.com/reference/android/os/PowerManager.WakeLock.html)，这将使 CPU 保持开启状态。最好这将在服务而不是前台活动中完成

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:01:34.237

Android没有这样的东西。当您的应用程序不再通过该`onPause()`方法可见以及当它通过该方法再次可见时，您将收到通知`onResume()`。[在这个链接](http://developer.android.com/reference/android/app/Activity.html)上有更多关于`Activity`生命周期的信息。

# multithreading - 多线程死锁

> ID：12715010
> 
> 赞同：1
> 
> 时间：2012-10-03T18:57:48.117
> 
> 标签：multithreading, deadlock

线程 1：

```
putQ
setFlag 
```

话题二：</p>

```
while (1) {
waitFlag
processQ
clearFlag
} 
```

这是一道面试题。我不确定线程​​1是否有while循环。但答案就像线程2重新进入while循环时，两个线程进入死锁。

谁能告诉我死锁的条件是什么？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:02:23.073

我看到的一个有问题的场景是线程 1 ( `T1`) 在短时间内两次调用有问题的代码。这是一个可能的行动方案：

*   `T2: waitFlag`
*   `T1: putQ`
*   `T1: setFlag`
*   `T2: processQ`
*   `T1: putQ`
*   `T1: setFlag`
*   `T2: clearFlag`

如果`T1`不再将任何内容放入队列，`T2`则永远不会处理第二个项目。但这不是僵局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:06:20.200

假设第一个块周围有一个循环，我相信这个例子试图引起人们注意信号量计数的重要性。示例中的“标志”不计算在内，因此多次通过第一个循环将多个项目放入队列中，但标志只能“设置”一次，因此第二个循环只能触发一次。信号量将在上层循环中为每个循环计数一次，`V`这样第二个循环将根据需要运行多次，同时减少计数`P`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:30:58.627

我认为OP的评论是正确的：

1.  **@Gray**：这很可能不是死锁，而是竞争条件。然而，应用程序被卡住而不处理队列，所以它是一个锁。

2.  **@Wug**：这可能是“微不足道的情况”，虽然`thread 1`已经放入队列并更新了标志，但`thread 2`永远不会注意到。请参阅下面的行动方案。

潜在的锁定情况：

*   T2：`ProcessQ`元素 0（处理前一个元素）
*   T1：`PutQ`元素 1
*   T1：`SetFlag`
*   T2：`ClearFlag`
*   T2：`waitFlag`

元素 1 可能永远不会被处理。

**编辑：**

当然，下一个问题是：`how do you fix that?`

答案将是`Conditional Variable`（有关详细信息，请参阅`pthread_cond_init`和其他人）：

*线程 1：*

```
PutQ
LockMutex
SetFlag
CondSignal
UnlockMutex 
```

*线程 2：*

```
while (1) {
    LockMutex
    while (FlagIsUnset)
       CondWait
    FlagUnset
    UnlockMutex
    ProcessQ
} 
```

# sitecore - 用户登录时，Sitecore.Context.User 在 Web 服务中返回匿名

> ID：12715012
> 
> 赞同：0
> 
> 时间：2012-10-03T18:57:50.483
> 
> 标签：sitecore, sitecore6

Web 服务列在`IgnoreurlPrefixes`列表中，我猜这与它有关。我有另一个服务*未*在该列表中列出，它返回登录用户。（不要让事情变得过于复杂，但我不清楚为什么我能够让一项服务可调用，而另一项服务不是基于它是否在`IgnorURLPrefixes`列表中。）

所以问题是：当从 Web 服务调用时，如何`Sitecore.Context.User`返回已登录的用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:31:22.517

您没有 Sitecore 上下文，因为请求的页面被 Sitecore 忽略，因此不被它处理。如果您需要 Sitecore 上下文，则不能将 URL 列在`IgnorURLPrefixes`列表中...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:17:41.993

正如另一个答案指出的那样，`Siteocre.Context`当 URL 列在`IgnoreURLPrefixes`. 最好的办法是在`httpRequestBegin`管道中添加一个处理器，在 Sitecore 尝试解析项目之前中止请求。这样，上下文至少可以部分可用。

[使用 MVC 路由执行此操作的示例](https://stackoverflow.com/questions/1308226/sitecore-and-asp-net-mvc)很多。

# ios - 为什么我不应该在 iOS 上将数据存储为文件？

> ID：12715017
> 
> 赞同：0
> 
> 时间：2012-10-03T18:58:11.780
> 
> 标签：ios, database, storage

如果我需要存储大约 100 个实体的集合，每个实体都有几 KB 的数据，如果我选择将它们作为文件保存和读取，而不是使用 Core Data 或 sqlite 或任何其他实体，我会遇到什么问题其他数据库？

我很可能一次只需要使用几个，我计划在内存中读取、解析和加载它们，使用它们，然后在它们不再使用时释放它们。此外，我永远不需要在其中搜索数据，我将始终通过他们的 ID 访问它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:03:48.097

数据库为您提供的是表示数据片段之间的关系、完整性维护、事务支持以及用于快速搜索和访问的索引。（嗯，所有这些，还有更多......）

另一方面，当您必须处理非结构化或非统一数据时，数据库的效率是出了名的低 - 像图像这样的二进制 blob、每个具有不同松散定义模式的 XML 文件等等。因此，例如，为什么没有人将关系数据库用于缓存目的。

因此，您是否应该使用 Core Data（或其他数据库）或文件实际上取决于这些文件的内容、它们之间的关系以及您需要对它们做什么。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:04:02.970

嵌入大量文件非常好 - 我怀疑文件系统非常有效。如果您需要在某些属性上访问或过滤它们，或者部分读取数据，或者用它们做其他花哨的事情，这就是数据库派上用场的地方。

# typescript - TypeScript 包管理

> ID：12715020
> 
> 赞同：15
> 
> 时间：2012-10-03T18:58:25.707
> 
> 标签：typescript

看起来 TypeScript 有一个不错的模块系统，但这是否取代了对 requirejs 之类的需求？换句话说，当你“编译”一个 typescript 包时，它会为你处理所有依赖解析吗？示例将不胜感激！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-03T19:07:20.533

TypeScript 没有运行时模块加载器。您仍然需要提供一个在运行时使用的模块加载器，例如 require js。TypeScript 支持生成与 commonJS（用于 node.js 脚本）和 AMD 加载器（例如 requireJS）兼容的 JavaScript 代码。要指定使用哪一个，请使用“amd”或“commonjs”将“--module”切换到编译器。

以下是在 TypeScript 中导出模块的方法：

```
export module depModule { 
    export class A { 
    }
} 
```

这是使用 --module amd 开关生成的 JavaScript 代码：

```
define(["require", "exports"], function(require, exports) {
    (function (depModule) {
        var A = (function () {
            function A() { }
            return A;
        })();
        depModule.A = A;
    })(exports.depModule || (exports.depModule = {}));
}) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T19:11:12.870

TypeScript 可以生成适用于 AMD 兼容的依赖加载器（如 requirejs）或 commonjs 环境（如 Node.js）的代码。您可以使用编译器的 --module 选项来控制它。编译器本身不会在运行时处理依赖关系解析，这取决于您的工作，但它会尝试在编译时解析依赖关系，以便它可以为您提供类型信息。

您可以在 CodePlex 的测试目录中看到使用模块的项目示例，例如[这个。](http://typescript.codeplex.com/SourceControl/changeset/view/09ec53d6c21d#tests/projects/relative%20-%20global/consume.ts)编译这些测试项目的输出是 .js 文件，可以使用例如 requirejs（如果您通过 --module amd）或 Node（如果您通过 --module commonjs）加载。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-04T18:46:58.090

如果您的应用程序仅由 typescript 模块/文件组成，则可以不使用模块加载器或其他依赖项管理。您需要将所有依赖项包含在注释引用中，并使用编译器的 --out 选项。例如：

```
tsc --out compiled.js app.ts 
```

这会将 app.ts 及其所有依赖项（包括依赖项的依赖项）生成的 js 放入compiled.js。然后可以将生成的文件直接包含在带有 script 标签的 html 文件中。也可以缩小。不支持在运行时加载模块

# webgl - 置换贴图UV贴图？

> ID：12715021
> 
> 赞同：4
> 
> 时间：2012-10-03T18:58:33.613
> 
> 标签：webgl, three.js, textures, uv-mapping, heightmap

## 概括

我正在尝试将置换贴图（高度贴图）应用于一个相当简单的对象（六边形平面），但我得到了一些意想不到的结果。我正在使用灰度，因此，我的印象是我的高度图应该只影响我的网格的 Z 值。但是，我创建的置换贴图在 X 和 Y 平面上拉伸了网格。此外，它似乎没有使用我创建的所有其他纹理都成功应用到的 UV 映射。

## 模型和 UV 贴图

这是我的六边形网格及其在 Blender 中对应的 UV 贴图的参考图像。

![六边形模型和 UV 贴图](../Images/f46e08e3a15f228f7a660839dcdf0172.png)

## 漫反射和置换纹理

这些是我通过 Three.JS 应用到我的网格的漫反射和置换贴图纹理。

![六边形漫反射和置换纹理](../Images/171a2bfcf712bf37debe8aba0ec06b26.png)

## 渲染

当我在没有置换贴图的情况下渲染平面时，您可以看到六边形平面保持在线条内。但是，当我添加置换贴图时，它显然会影响顶点的 X 和 Y 位置，而不是仅影响 Z，从而将平面很好地扩展到线条上。

![六边形平面渲染——带和不带置换贴图](../Images/f9f194d16c4629a7d5fe125ccc514618.png)

## 代码

这是相关的 Three.js 代码：

```
 // Textures
    var diffuseTexture = THREE.ImageUtils.loadTexture('diffuse.png', null, loaded);
    var displacementTexture = THREE.ImageUtils.loadTexture('displacement.png', null, loaded);

    // Terrain Uniform
    var terrainShader = THREE.ShaderTerrain["terrain"];
    var uniformsTerrain = THREE.UniformsUtils.clone(terrainShader.uniforms);

  //uniformsTerrain["tNormal"].value = null;
  //uniformsTerrain["uNormalScale"].value = 1;

    uniformsTerrain["tDisplacement"].value = displacementTexture;
    uniformsTerrain["uDisplacementScale"].value = 1;

    uniformsTerrain[ "tDiffuse1" ].value = diffuseTexture;
  //uniformsTerrain[ "tDetail" ].value = null;
    uniformsTerrain[ "enableDiffuse1" ].value = true;
  //uniformsTerrain[ "enableDiffuse2" ].value = true;
  //uniformsTerrain[ "enableSpecular" ].value = true;

  //uniformsTerrain[ "uDiffuseColor" ].value.setHex(0xcccccc);
  //uniformsTerrain[ "uSpecularColor" ].value.setHex(0xff0000);
  //uniformsTerrain[ "uAmbientColor" ].value.setHex(0x0000cc);

  //uniformsTerrain[ "uShininess" ].value = 3;
  //uniformsTerrain[ "uRepeatOverlay" ].value.set(6, 6);

    // Terrain Material
    var material = new THREE.ShaderMaterial({
        uniforms:uniformsTerrain,
        vertexShader:terrainShader.vertexShader,
        fragmentShader:terrainShader.fragmentShader,
        lights:true,
        fog:true
    });

    // Load Tile
    var loader = new THREE.JSONLoader();
    loader.load('models/hextile.js', function(g) {
      //g.computeFaceNormals();
      //g.computeVertexNormals();
        g.computeTangents();
        g.materials[0] = material;

        tile = new THREE.Mesh(g, new THREE.MeshFaceMaterial());
        scene.add(tile);
    }); 
```

## 假设

我目前正在考虑为什么这可能会出错的三种可能性：

1.  UV 贴图不适用于我的置换贴图。
2.  我错误地制作了置换贴图。
3.  我错过了将位移锁定为仅 Z 的过程中的关键步骤。

当然，秘密选项＃4 以上都不是，我**真的**不知道我在做什么。或上述的任何混合物。

## 现场示例

[您可以在此处](https://dl.dropbox.com/u/108094925/Stack%20Overflow/Displacement%20Map/tile.html)查看实时示例。

如果有对此主题有更多了解的人可以指导我，我将不胜感激！

***编辑 1***：根据建议，我已经注释掉`computeFaceNormals()`和`computeVertexNormals()`. 虽然它确实略有改进，但网格仍在变形。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T20:27:38.153

在您的地形材质中，设置`wireframe = true`，您将能够看到正在发生的事情。

你的代码和纹理基本上没问题。当您在加载程序回调函数中计算顶点法线时会出现问题。

几何图形外环的计算顶点法线稍微向外点。这很可能是因为`computeVertexNormals()`它们是通过平均每个相邻面的面法线来计算的，并且模型“边”（黑色部分）的面法线被平均到构成这些顶点的顶点法线计算中“帽”的外圈。

结果，“帽”的外环在位移图下方向外扩展。

编辑：果然，直接从你的模型，外环的顶点法线指向外面。内环的顶点法线都是平行的。也许 Blender 正在使用相同的逻辑来生成顶点法线`computeVertexNormals()`。

![顶点法线](../Images/4f0e5e118260d4c46a02632db0c4189a.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:32:15.897

问题是如何构造对象，因为位移沿法线向量发生。

代码在这里。

[https://github.com/mrdoob/three.js/blob/master/examples/js/ShaderTerrain.js#L348-350](https://github.com/mrdoob/three.js/blob/master/examples/js/ShaderTerrain.js#L348-350)

```
"vec3 dv = texture2D( tDisplacement, uvBase ).xyz;", 
```

这需要置换纹理的 rgb 向量。

```
"float df = uDisplacementScale * dv.x + uDisplacementBias;", 
```

这仅需要矢量的红色值，因为 uDisplacementScale 通常为 1.0，而 uDisplacementBias 为 0.0。

```
"vec3 displacedPosition = normal * df + position;", 
```

这会沿着法线向量移动位置。

所以要解决您更新法线或着色器的问题。

# ios - UITableView 使用通知编辑？

> ID：12715024
> 
> 赞同：1
> 
> 时间：2012-10-03T18:58:36.073
> 
> 标签：ios, uitableview, nsnotification, setediting

我有一个带有编辑/完成按钮的 UITableView。当它进入编辑模式时，我想进行一些更改。目前，我已经覆盖了 setEditing:animated，但这似乎很可疑。tableView进入编辑模式时是否有通知发送，还是我应该坚持setEditing？

# mysql - grails生产jdbc池commons-dbcp vs tomcat 7 jndi

> ID：12715028
> 
> 赞同：2
> 
> 时间：2012-10-03T18:59:09.367
> 
> 标签：mysql, tomcat, grails, jndi, apache-commons-dbcp

什么是 tomcat grails jdbc 访问的推荐生产配置？

commons-dbcp 还是 tomcat jndi 轮询？

有人对此配置有性能或轶事建议吗？

我们一直在使用 Grails 和 tomcat jndi 解决配置和可能的事务问题，我们正在尝试决定是要投入更多时间来调试这些问题，还是只使用 commons-dbcp。

这可能被认为是[tomcat-dbcp vs commons-dbcp](https://stackoverflow.com/questions/4711943/tomcat-dbcp-vs-commons-dbcp)的副本，但我正在寻找有关 Grails 的性能数据和建议。

如果重要的话，我们正在使用 MySQL :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T15:09:37.663

我建议您观看：调试 Grails 数据库性能

[http://skillsmatter.com/podcast/groovy-grails/debugging-grails-database-performance](http://skillsmatter.com/podcast/groovy-grails/debugging-grails-database-performance)

# java - 我可以制作一个 Eclipse 键盘快捷键来切换控制台的视图吗？

> ID：12715030
> 
> 赞同：2
> 
> 时间：2012-10-03T18:59:13.030
> 
> 标签：java, eclipse

我并不总是想要它，我在笔记本电脑屏幕上，所以最好有代码的垂直屏幕空间，然后仅在我需要时启用控制台。我知道我可以打开它，但它似乎只适用于打开它，再次触发快捷方式不会隐藏它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T19:22:39.370

您可以将**Preferences > General > Keys中的***Minimize Active View 或 Editor*命令绑定 到您想要的任何组合键，如果您在控制台中执行此操作，它将最小化它。但是，当您这样做时，它将最小化与控制台共享停靠空间的所有视图。您可以使用*Alt+Shift+Q,C*再次调出它，但这会将控制台显示为浮动视图，它不会将停靠栏最大化到其原始位置。在这个浮动控制台中按*Esc*，它就会消失。

 ****如果你能忍受这个，那么它可能没问题。

另一种方法是使用*Ctrl+M*最大化代码视图，以防您只想专注于代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T19:29:22.560

您可以为此目的定义不同的**视角。**

查看[如何在 Eclipse 中添加透视图](https://stackoverflow.com/questions/627914/how-to-add-perspectives-in-eclipse)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T19:32:49.457

您可以在 Preferences > General > Keys 中添加或编辑现有快捷方式（或按 Ctrl+3，键入 Keys 并选择）...在控制台中键入以过滤掉所有不相关的快捷方式。

![钥匙](../Images/a3e9169066bb5fc6fe04827c91e5000b.png)

这是一篇包含更多细节的文章和一个视频:)

[http://eclipse.dzone.com/articles/how-manage-keyboard-shortcuts](http://eclipse.dzone.com/articles/how-manage-keyboard-shortcuts)****

# jquery - 对象中值的jQuery计数

> ID：12715034
> 
> 赞同：-1
> 
> 时间：2012-10-03T18:59:32.517
> 
> 标签：jquery, underscore.js

我有一个对象返回 -

```
[[1234, 3], [3245, 14], [3421, 0], [1231, 40]] 
```

我想用 JQuery 算作 3+14+0+40 吗？我知道下划线 js 在 1.4 版中有 countBy 。我们没有安装 1.4。在 jQuery 中有很短的方法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:02:20.300

只需编写一个简单的迭代，

```
var data = [[1234, 3], [3245, 14], [3421, 0], [1231, 40]];

var total = 0;

for (var i = 0; i < data.length; i++) {
    total += data[i][1];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:02:32.857

当你使用下划线时，你可以使用`_.reduce`函数：

```
_.reduce(theArray, function(memo, ar) { return memo + ar[1]; } ,0); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:02:34.923

这是javascript任务

```
var sum = 0;
for (var i=array.length; i--;) {
   sum += array[i][1];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T19:04:02.217

为什么不（承认您的数组在 var 选项卡中）

```
var res = 0;
for(var i = 0; i < tab.length; i++) {
    res += tab[i][tab[i].length - 1];
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T19:04:32.497

为什么你需要 jQuery 呢？这是基本的 JavaScript 101

```
var t = 0; // The total
var i;
for (i = 0;  i < a.length; i++) {
  t += a[i][1]
} 
```

# c++ - LibXML2 xmlGetProp() - 没有匹配的函数

> ID：12715042
> 
> 赞同：1
> 
> 时间：2012-10-03T18:59:48.223
> 
> 标签：c++, xcode, macos, libxml2, xcode4.5

嗨，我在 XCode 4.5 中运行 libxml2 并且遇到了 xmlGetProp() 函数的问题。XCode 说调用没有匹配的函数。

我已经添加`${SDK_DIR}/usr/include/libxml2`到我的 Header Search Path 并在 Link Binary With Libaries 中添加了 libxml2.dylib。

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-11T16:34:26.700

确保将第二个参数强制转换为 const xmlChar *

翼

uri = xmlGetProp(cur, (const xmlChar *)"PV");

# ios - 内存使用量随着时间的推移不断增加（GLKit - iOS）

> ID：12715046
> 
> 赞同：1
> 
> 时间：2012-10-03T19:00:09.553
> 
> 标签：ios, memory, glkit, vertex-buffer, glkbaseeffect

我几乎完成了我的应用程序。其中一个视图使用 GLKit。我只是记忆有问题。基本上发生的情况是，当显示 GLKView 时，内存消耗不断增加（通过 Instruments 看到）。在某个时刻，它显然会崩溃。我对GLKit不太了解，所以希望你能帮助我。

问题是我正在显示的 3d 箭头。如果我不画它，所有其他的东西都不会造成任何问题。这是包含箭头顶点数据的头文件：

```
#import <GLKit/GLKit.h>

struct arrowVertexData
{
    GLKVector3      vertex;
    GLKVector3      normal;
    GLKVector2      texCoord;
};
typedef struct arrowVertexData arrowVertexData;
typedef arrowVertexData* vertexDataPtr;

static const arrowVertexData MeshVertexData[] = {
    {/*v:*/{{-0.000004, 0.0294140, -0.0562387}}, /*n:*/{{0.000000, 1.000000, 0.000000}}, /*t:*/{{0.500000, 0.333333}}},
... etc... 
```

这是绘制代码：

```
- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect {
    glClearColor(0.0f, 0.0f, 0.0f, 0.0f);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

    [self.arrowEffect prepareToDraw];
    //glGenVertexArraysOES(1, &arrowVertexArray);
    //glBindVertexArrayOES(arrowVertexArray);

    glGenBuffers(1, &arrowVertexBuffer);
    glBindBuffer(GL_ARRAY_BUFFER, arrowVertexBuffer);
    glBufferData(GL_ARRAY_BUFFER, sizeof(MeshVertexData), MeshVertexData, GL_STATIC_DRAW);

    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, sizeof(arrowVertexData), 0);
    glEnableVertexAttribArray(GLKVertexAttribNormal);
    glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_TRUE, sizeof(arrowVertexData), (void *)offsetof(arrowVertexData, normal));
    glBindVertexArrayOES(arrowVertexArray);

    // Render the object with GLKit

    glDrawArrays(GL_TRIANGLES, 0, sizeof(MeshVertexData) / sizeof(arrowVertexData));

    //reset buffers
    glBindBuffer(GL_ARRAY_BUFFER, 0);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);

    //disable atttributes
    glDisableVertexAttribArray(GLKVertexAttribNormal);
    glDisableVertexAttribArray(GLKVertexAttribPosition);
} 
```

有什么建议吗？非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T06:07:15.050

每次调用 drawInRect 时，您都在创建一个新的顶点缓冲区 (VBO)，并且永远不会删除它们。GLGenBuffers 和 GLBindBuffer 设置了一个新的缓冲区并使其成为当前缓冲区，但真正的损害是由 GLBufferData 完成的，它将数据**复制**到新的缓冲区中。

glBindBuffer(GL_ARRAY_BUFFER, 0); 将 GL 重置为不使用缓冲区，并且 glDisableVertexAttribArray(GLKVertexAttribPosition); 告诉 GL 不要再在缓冲区中查找位置数据，但是这些调用都没有做任何事情来释放内存。如果您想每次都释放内存，则需要调用 GLDeleteBuffers(1, &arrowVertexBuffer); 释放内存。

更好的方法是在启动时生成缓冲区并在终止时将其删除，并挂在 arrowVertexBuffer 上，每次都根据需要重新绑定和解除绑定，就像重置指针一样出售，假设程序的其他部分正在修改 GL状态。

看起来您也开始使用顶点数组对象 (VAO)，这将是另一种捕获状态以供重用的方式，尽管最好等到 VBO 正常工作后再尝试。VBO 和 VAO 都是缓存状态的方法，它们随着时间的推移而发展，以减少每次通过渲染循环的负载，但 VAO 投下了更广泛的网络，这可能会使正确处理变得更加棘手。

作为一般建议，您可以通过添加更通用和流行的标签（例如 [Open GL]）来获得对此类问题的更多关注。

Another debugging tool you should definitely try is OpenGL Profiler. If you did not install it with XCode, look it up in the documentation and you should find a link to download the graphic tools package. The resources window will allow you to track the buffer objects in use.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:58:48.100

您是否尝试过在 Xcode 中运行静态分析器？

它非常擅长指出未释放的分配内存之类的东西。

要使用它，请将鼠标按住“运行”按钮并从下拉列表中选择“分析”。

如果它确实找到了任何东西，它通常会用蓝色指出它们，你可以看到这些行追溯到内存被分配和未释放的位置，等等......

让我知道这是否有任何影响。

# xcode - 为什么 xibs 中使用的图像不显示在应用程序范围的搜索中

> ID：12715057
> 
> 赞同：2
> 
> 时间：2012-10-03T19:00:46.877
> 
> 标签：xcode, xib

我正在处理一个大型项目并删除未使用的图像资产。我一直在使用 cmd+shift+f 对给定的图像名称执行项目范围的搜索。我一直认为这是可行的，直到我意识到如果我将图像视图设置为在界面构建器中显示图像，则图像引用不会出现在我的搜索中。

为什么应用程序范围的搜索不在 xib 文件中查找值？

下面是重新创建问题的示例项目中的图像。我在 xib 中分配了 img2，但正如您在搜索结果中看到的那样，找不到 img2.png。

![项目运行的屏幕截图，并将 img2.png 加载到 imageview2 中。 这可以在imageview的image属性中看到](../Images/999ef16208c587630997c41faf978e07.png)

# hibernate - 在域类初始化中使用编码器

> ID：12715061
> 
> 赞同：1
> 
> 时间：2012-10-03T19:01:04.987
> 
> 标签：hibernate, grails

有趣的问题：

我有一个看起来像的域类

```
class Dummy {
    String key = (''+new Date()).encodeAsSHA256()
} 
```

当我尝试启动我的应用程序时，我收到一条很长的堆栈跟踪/错误消息说明

```
Invocation of init method failed; nested exception is org.hibernate.InstantiationException: could not instantiate test objectmad.Dummy
...
Caused by MissingMethodException: No signature of method: java.lang.String.encodeAsSHA256() is applicable for argument types: () values: [] 
```

现在，如果我删除`.encodeAsSHA256()`，以开发模式启动应用程序并重新插入编码，它可以工作:-)

所以基本上，代码在@运行时工作，但似乎@初始化时间，String类还没有为编码器准备好。

知道如何在不创建自定义构造函数的情况下解决此问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:14:31.870

找到了解决办法：编码器也可以直接调用，但是要知道正确的包...

```
import org.codehaus.groovy.grails.plugins.codecs.SHA256Codec

class Dummy {
    String key = SHA256Codec.encode(''+new Date())
} 
```

...解决问题...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:04:21.780

为什么*不是*构造函数？这属于构造函数...

# java - 为什么我的 for 循环不会停止；尽管是布尔表达式？

> ID：12715062
> 
> 赞同：1
> 
> 时间：2012-10-03T19:01:08.127
> 
> 标签：java, drjava

列出的最后一个 for 循环（int 变量 n 和 o）。我对任何类型的编程都很陌生，在我们的介绍性课程中，我们使用 Dr Java 和一些基本媒体材料来制作本质上是龟笔的东西。它在显示器上绘制东西。

我的最后一个 for 循环似乎（在我眼中）说它应该在 n<=o 时启动，它们是第一个。所以它启动。然后它应该更新，以便 n=2 不是 <=o (1).. 但它只是继续无限循环最后一部分......

```
import Media.*;
import static java.lang.Math.*;

public class DiamondTiles2 {

private TurtleDisplayer display;
private Turtle            steve;

public DiamondTiles2 (){

  display = new TurtleDisplayer();
  steve = new Turtle();
  display.placeTurtle(steve);

  steve.setSpeed(15);
  steve.forward(140);             // Moves Steve to the furthest right he needs to be
  steve.left(PI/2);
  steve.forward((float)1.5*(40*sqrt(3.0)));  // Moves Steve to the top (up 1.5 times the height of a diamond)
  steve.left(PI/6);
  steve.penDown();

  for (int m=1 ; m<=4 ; m++){
    for (int j=1 ; j<=7 ; j++){  //Diamond Drawing
      steve.forward(40);
      steve.left(2*PI/3);        
      steve.forward(40);
      steve.left(PI/3);
      steve.forward(40);
      steve.left(2*PI/3);
      steve.forward(40);
      steve.left(PI/3);
      for (int i=1 ; i<=1 ; i++){
        steve.penUp();
        steve.left(PI/3);
        steve.forward(40);
        steve.right(PI/3);
        steve.penDown();
        for (int k=1 ; j>=7 ; k++){
          for (int n=1, o=1 ; n<=o ; n=n+2){
            steve.right(7*PI/6);
            steve.forward((float)40*(sqrt(3.0)));
            steve.left(PI/2);
            steve.forward(280);
            steve.left(2*PI/3);*
          }
        }
      }
    }
  }  
  display.close();
}; 
```

基本上最终结果应该是最后一个循环 (n,o) 仅每 j 的 7 个循环启动一次。它所做的是绘制 7 颗钻石，然后 n,o 循环将其向下移动以开始新的一行，然后它将再绘制 7 颗钻石！但它只是无限期地上下移动..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T19:02:32.383

你检查`j`而不是`k`.

这个：`for (int k=1 ; j>=7 ; k++)`

应该：`for (int k=1 ; k<=7 ; k++)`

此外，您不递增`o`，因此它始终为零，并且最里面的循环每次只运行一次。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:03:21.780

看看你的这个循环：

```
for (int k=1 ; j>=7 ; k++) {
    ...
} 
```

当`j`取值为 时`7`，这个循环永远不会结束，因为它`j`的内部没有改变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:04:44.473

休息时间在哪里？

```
for (int k=1 ; j>=7 ; k++){ 
```

# php - 检测文件是否被更改

> ID：12715064
> 
> 赞同：1
> 
> 时间：2012-10-03T19:01:21.217
> 
> 标签：php, ftp

我经常收到“文件意外结束”错误，我认为它们只发生在包含的文件上，而不是基本文件本身。但无论如何，只要我上传文件，同时用户碰巧加载使用正在上传的文件的页面，它们就会发生。

我将如何检测文件是否正在上传？或者有什么方法可以配置我的 FTP 客户端（我使用 FileZilla）在上传时读取锁定文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:03:49.810

您应该上传到一个临时目录，并用旧文件切换完全上传的文件。

# matlab - 用额外的参数调用 setter？- MATLAB

> ID：12715065
> 
> 赞同：1
> 
> 时间：2012-10-03T19:01:23.047
> 
> 标签：matlab, matlab-class

在具有相关属性的类中`c`，我想`c`使用等于`'a'`or的第三个参数调用 setter `'b'`，选择要更改的独立属性以进行设置`c`。

代码是

```
classdef test < handle
    properties
        a
        b
    end
    properties (Dependent = true)
        c
    end

    methods
        function c = get.c(obj)
            c = obj.a + obj.b;
        end

        function obj = set.c(obj, value, varargin)
            if(nargin == 2)
                obj.a = value - obj.b;
            end

            if(nargin == 3 && argin(3) == 'a') % how do I enter this loop?
                obj.a = value - obj.b;
            end

            if(nargin == 3 && argin(3) == 'b') % or this?
                obj.b = value - obj.a;
            end

        end
    end
end 
```

此调用有效：

```
myobject.c = 5 
```

但是如何使用等于`'a'`or的第三个参数调用 setter `'b'`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T06:34:42.393

你不能。`set`总是只接受两个参数。您可以使用附加的依赖属性来解决它：

```
classdef test < handle

    properties
        a
        b
    end

    properties (Dependent = true)
        c
        d
    end

    methods
        function c = get.c(obj)
            c = obj.a + obj.b;
        end
        function d = get.d(obj)
            d = c;
        end

        function obj = set.c(obj, value)                
            obj.a = value - obj.b;
        end
        function obj = set.d(obj, value)                
            obj.b = value - obj.a;
        end

    end
end 
```

或通过选择不同的语法和/或方法：

```
myObject.set_c(5,'a')  %// easiest; just use a function
myObject.c = {5, 'b'}  %// easy; error-checking will be the majority of the code
myObject.c('a') = 5    %// hard; override subsref/subsasgn; good luck with that 
```

或其他有创意的东西:)

# actionscript-3 - IntelliJ IDEA 上的 Flash sdk

> ID：12715066
> 
> 赞同：1
> 
> 时间：2012-10-03T19:01:26.207
> 
> 标签：actionscript-3, flash, plugins, intellij-idea

我正在尝试从头开始学习 actionScript 3.0，并建议我使用 Intellij IDEA 进行开发。但是我真的很难在其中安装 Flash SDK。有人可以帮我吗？请不要让我参考文档，我已经尝试过并且失败了。谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T20:00:11.020

**它仅适用于终极版**

as3项目IDEA的基本设置是：

1.  安装和解压（如果需要）Flex SDK

2.  打开 Idea 后，选择`File`-> `Project Structure`（即使项目没有打开或创建）

3.  在`SDK`部分中，按`+`第二列顶部并`Flex SDK`从下拉列表中选择

4.  选择文件夹，你之前解压过 Flex SDK 的地方（你有子文件夹的地方`bin`，`frameworkds`等等）

5.  返回到窗口中的`Project`部分。`Project Structure`

6.  从下拉列表中选择默认项目 SDK（近`New...`按钮）

7.  按确定。

现在，您已准备好创建项目（通过`File`-> `New Project...`）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-01T22:31:43.237

此外，3.6 SDK 下载确实搞砸了权限。IntelliJ 会让我选择文件夹，但只是静静地什么都不做。

我必须在选择`sudo chmod -R a+r [sdk dir]`后`sudo chmod -R a+x [sdk dir]/frameworks`让它实际添加 SDK。

做第一个，看看它是否有效，我对我的 chmod'ing 非常冷酷无情，但该`frameworks`目录**根本没有**权限。至少，它需要是`+rx`。

# ios - iOS Core Graphics 中的“形状爆裂”笔画

> ID：12715070
> 
> 赞同：1
> 
> 时间：2012-10-03T19:01:42.080
> 
> 标签：ios, core-graphics, stroke

有没有办法通过抚摸 CGPathRef 在 Core Graphics 中创建以下效果？

[![IMG](../Images/a9f97ad0355c293b1d06d4ec1b6de4a9.png)](https://i.stack.imgur.com/oXclT.png)

如果可能*的*话，使用 Core Graphics 绘制会比简单地沿着路径绘制径向椭圆 CGImageRef 更有效吗？

编辑：澄清：我希望笔画的中心部分为 100% 不透明度，边缘从 100% 不透明度淡出到 0% 不透明度。

编辑 2：另外，我打算在 MKOverlayView 中使用此绘图来突出显示用户的路径......所以不确定模糊过滤器是否足够高效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T21:44:10.277

带有阴影的圆顶粗路径可能是您的最佳解决方案。这将涉及：

```
CGContextSetLineWidth()
CGContextSetLineCap()
CGContextSetShadowWithColor() 
```

您需要一个零偏移阴影，并且您需要尝试使用半径和模糊参数来获得您想要的效果。

# python - Google 电子表格 API 列标题

> ID：12715072
> 
> 赞同：1
> 
> 时间：2012-10-03T19:01:49.173
> 
> 标签：python, google-sheets, google-spreadsheet-api, google-data-api

我在 python 中使用 Google 电子表格 API，但无法获取工作表的 ListView 的列标题。

有谁知道如何获得这些头衔？我只能找到下划线前面的哈希。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T10:16:53.260

看看我创建的这个[库](https://github.com/yoavaviram/python-amazon-simple-product-api)，它是电子表格 API 的简单包装器，旨在使您所面临的情况更易于处理。

# c# - 如何在使用 ControlTemplate 时重现 TreeViewItem 中显示的文本？

> ID：12715073
> 
> 赞同：0
> 
> 时间：2012-10-03T19:02:00.857
> 
> 标签：c#, wpf, wpf-controls, controltemplate, treeviewitem

我正在尝试修改 TreeView 以在其子项的上方和下方显示 TreeViewItem 值，例如：

```
foo
|bar
||baz
|biz 
```

会成为

```
foo
|bar
||baz
| baz
|bar
|biz
 biz
foo 
```

下面提供了当前控件模板的修剪表示，但不保证此代码段可以编译：

```
<ControlTemplate TargetType="{x:Type TreeViewItem}">
  <Grid>
     <Grid.ColumnDefinitions>
        <ColumnDefinition MinWidth="19"
                          Width="Auto"/>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>
      <Grid.RowDefinitions>
         <RowDefinition Height="Auto"/>
         <RowDefinition/>
         <RowDefinition Height="Auto"/>
      </Grid.RowDefinitions>
      <ToggleButton x:Name="Expander"
                    IsChecked="{Binding Path=IsExpanded,
                    RelativeSource={RelativeSource TemplatedParent}}"
                    ClickMode="Press"/>
      <Border Name="Bd"
              Grid.Column="1"
              Background="{TemplateBinding Background}"
              BorderBrush="{TemplateBinding BorderBrush}"
              BorderThickness="{TemplateBinding BorderThickness}"
              Padding="{TemplateBinding Padding}">
        <ContentPresenter x:Name="PART_Header"
                          ContentSource="Header"
                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"/>
      </Border>
      <ItemsPresenter x:Name="ItemsHost"
                      Grid.Row="1"
                      Grid.Column="1"
                      Grid.ColumnSpan="2"/>
      <TextBlock Text="Some Binding Goes Here"
                 Grid.Row="2"
                 Grid.Column="1"
                 Grid.ColumnSpan="2"/>
    </Grid>
  </ControlTemplate> 
```

重复的条目不会有子项，它只是显示值。到目前为止，我可以使用 ControlTemplate 修改 TreeView ContainerStyle 以在可视树中的适当位置插入 TextBlock。应该使用什么数据绑定来获取适当的显示值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T23:45:40.943

为什么不再使用 a `ContentPresenter`？

```
<ContentPresenter ContentSource="Header"
                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                  Grid.Row="2"
                  Grid.Column="1"
                  Grid.ColumnSpan="2"/> 
```

# vba - Excel VBA：在文件夹中的多个工作簿上循环工作表的简单副本

> ID：12715074
> 
> 赞同：1
> 
> 时间：2012-10-03T19:02:08.487
> 
> 标签：vba, loops, excel

在它从工作簿 x1 复制并粘贴工作表它还应该将工作表的标题“x”重命名为单元格 B3。这应该在移至下一个工作簿之前完成。

它需要为 workBOOK x1 到 x100 执行此操作。不过，我不能按名称引用工作簿，因为它们每个都被命名为一个文本字符串，而这不是真正的可排序方法。

我知道的这段代码有效，将“x”从“x1”复制到“xmaster”，以及重命名工作表并断开链接，如下所示：

```
 Sub CombineCapExFiles()
    Sheets("Capital-Projects over 3K").Move After:=Workbooks("CapEx Master File.xlsm").Sheets _
        (3)
    ActiveSheet.Name = Range("B3").Value

    Application.DisplayAlerts = False

For Each wb In Application.Workbooks
    Select Case wb.Name
            Case ThisWorkbook.Name, "CapEx Master File.xlsm"
                ' do nothing
            Case Else
                  wb.Close
    End Select
Next wb

    Application.DisplayAlerts = True

End Sub 
```

“激活上一个”窗口不起作用，也不知道如何修复它的那部分。

但是，我不确定如何构建它以遍历目录中的所有工作簿。

我应该使用这个：？

```
MyPath = "C:\directory here"
strFilename = Dir(MyPath & "\*.xlsx", vbNormal) 'change to xlsm if needed ?

If Len(strFilename) = 0 Then Exit Sub ' exit if no files in folder

Do Until strFilename = ""
    'Your code here
    strFilename = Dir()    
Loop 
```

另一个限制是它不需要在 xmaster 上运行宏（它会出错，因为它没有工作表“x”，它将从以前的工作簿中重命名。）

谢谢！马修

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:32:56.987

像这样？（未测试）

```
Option Explicit

Sub LoopFiles()

Dim strDir As String, strFileName As String
Dim wbCopyBook As Workbook
Dim wbNewBook As Workbook
Dim wbname as String   

strDir = "C:\"
strFileName = Dir(strDir & "*.xlsx")

Set wbNewBook = Workbooks.Add 'instead of adding a workbook, set = to the name of your master workbook
wbname = ThisWorkbook.FullName

 Do While strFileName <> ""
    Set wbCopyBook = Workbooks.Open(strDir & strFileName)
    If wbCopyBook.FullName <> wbname Then
        wbCopyBook.Sheets(1).Copy Before:=wbNewBook.Sheets(1)
        wbCopyBook.Close False
        strFileName = Dir()
    Else
        strFileName = Dir()
    End If
Loop

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:33:34.607

该位将用于避免在 xmaster 上运行宏。

```
xmaster = "filename for xmaster"
MyPath = "C:\directory here"
strFilename = Dir(MyPath & "\*.xls*", vbNormal) 'this will get .xls, .xlsx, .xlsm and .xlsb files
If Len(strFilename) = 0 Then Exit Sub ' exit if no files in folder

Do Until strFilename = ""
    If strFileName = xmaster Then ' skip the xmaster file
        strFilename = Dir() 
    End If
    'Your code here
    strFilename = Dir()    
Loop 
```

但另一方面我也帮不上忙。我在您的代码中没有看到任何激活上一个窗口部分。

# c# - 从 C# 中的电子表格中提取时出现错误“指定的转换无效”

> ID：12715078
> 
> 赞同：2
> 
> 时间：2012-10-03T19:02:20.230
> 
> 标签：c#, excel, import

我有一个 C# 程序，它应该从一个小的四列电子表格 (.xlsx) 中提取数据。它读取第一列很好，但是当它到达第二列时，我收到以下错误：

“指定的演员表无效”

我检查并重新检查了单元格的格式，第一列和第二列之间没有区别，第一列读得很好。以下是电子表格中第一行的值。每个值代表一个单独的列。

> 121220 330004 双 02/22/2012

这是我正在使用的代码。Id 变量加载得很好，这是导致问题的 courseCode。

```
string connectionString = @"Provider=Microsoft.ACE.OLEDB.12.0;"
    + "Data Source=C:\Projects\sym_AgentServices_INT\Book1.xlsx;"
    + "Extended Properties='Excel 8.0;HDR=Yes;IMEX=1'";
string queryString = "SELECT * FROM [CE$]";

try
{
    OleDbDataReader reader;
    using (OleDbConnection connection = new OleDbConnection(connectionString))
    {
        OleDbCommand command = new OleDbCommand(queryString, connection);
        connection.Open();
        reader = command.ExecuteReader();

        while (reader.Read())
        {
            string Id = "";
            string courseCode = "";
            string partner = "";
            string effectiveDate = "";
            string expirationDate = "";

            Id = reader.GetString(0);
            courseCode = reader.GetString(1);
            partner = reader.GetString(2);
            effectiveDate = reader.GetString(3);
            expirationDate = reader.GetString(4);
        }
    }
} 
```

编辑

我在运行时分析了 reader 对象，发现以下内容：通过多次扩展 base 并打开 System.Data.OleDb.OleDbDataReader 的 _bindings 属性，我发现那里只有一个条目（“0”） . 但是，如果我打开 0，然后展开 _columnBindings 属性，我会发现值 0 - 4。

从阅读器（“reader.GetString(x)”）中提取数据时，我的语法是否不正确？

最终编辑

我强烈建议不要使用 .GetString(x)，而是直接使用 reader[x].ToString()。这解决了问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:40:29.097

当我使用 reader[n].ToString() 时，错误消失了：

```
 string connectionString = @"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=d:\temp\Book1.xlsx; Extended Properties='Excel 8.0;HDR=Yes;IMEX=1'";
        string queryString = "SELECT * FROM [CE$]";

        OleDbDataReader reader;
        using (OleDbConnection connection = new OleDbConnection(connectionString))
        {
            OleDbCommand command = new OleDbCommand(queryString, connection);
            connection.Open();

            DataSet ds = new DataSet("Book1");

            IDataAdapter adapter = new OleDbDataAdapter(queryString, connection);
            adapter.Fill(ds);

            reader = command.ExecuteReader();

            while (reader.Read())
            {
                string Id = "";
                string courseCode = "";
                string partner = "";
                string effectiveDate = "";
                string expirationDate = "";

                Id = reader[0].ToString();
                courseCode = reader[1].ToString();
                partner = reader[2].ToString();
                effectiveDate = reader[3].ToString();
                expirationDate = reader[4].ToString();

                //Id = reader.GetString(0);
                //courseCode = reader.GetString(1);
                //partner = reader.GetString(2);
                //effectiveDate = reader.GetString(3);
                //expirationDate = reader.GetString(4);
            }
        } 
```

这是我的测试数据集...

```
ID  Course Code     Partner Effective Date Expiration Date
100 5               MS      10/3/2012       10/3/2013
200 21-400          Oracle  10/3/2012       10/3/2013
300                 Goog    10/3/2012       10/3/2013 
```

# jquery - jquery bxslider 记住在窗口调整大小 reloadShow() 函数上的幻灯片

> ID：12715081
> 
> 赞同：2
> 
> 时间：2012-10-03T19:02:31.667
> 
> 标签：jquery, window-resize, bxslider

在项目中使用 BxSlider jQuery 内容滑块 ( [http://bxslider.com/](http://bxslider.com/) )。我在窗口调整大小时使用“reloadShow() 函数，以便内容重新对齐到中心。

reloadShow() 函数正在工作，但每次都会将我的幻灯片重置为第一张。相反，我想记住它所在的幻灯片并重新加载到该幻灯片。

这是我的 JS：

```
$(function(){
    // assign the slider to a variable
    slider = $('#slider').bxSlider(
    {
        controls: false,
        auto: false
    });

    // assign a click event to the external thumbnails
    $('.thumbs a').click(function()
    {
        var thumbIndex = $('.thumbs a').index(this);
        // call the "goToSlide" public function
        slider.goToSlide(thumbIndex);

        // remove all active classes
        $('.thumbs a').removeClass('pager-active');
        // assisgn "pager-active" to clicked thumb
        $(this).addClass('pager-active');
        // very important! you must kill the links default behavior
        return false;

    });

    // assign "pager-active" class to the first thumb
    $('.thumbs a:first').addClass('pager-active');

    $(window).resize(function(e)
    {
        slider.reloadShow();
    });

}); 
```

# c# - 修改对象时填充组合框

> ID：12715085
> 
> 赞同：0
> 
> 时间：2012-10-03T19:02:37.037
> 
> 标签：c#, .net, combobox

我会尽量做到直截了当。我在 datagridview 上有一个客户列表，而且我有一个表单，允许我添加新客户端或修改它。添加新客户端时我没有问题，但是在修改时我找不到填充某些文本框和组合框的方法。组合框应该显示城市，文本框应该显示地址。代码如下

```
 private void Modificar()
    {
        if (dgCliente.Rows.Count == 0)
        {
            return;
        }
        DataGridViewRow row = dgCliente.SelectedRows[0];
        Cliente cliente = (Cliente)row.Tag;

        tcClientes.SelectedTab = tpGeneral;
        //txtActividad.Text = cliente.Actividad;
        txtApellido.Text = cliente.Apellido;
        if (cliente.Categoria == Categoria.Cliente)
        {
            rbCliente.Checked = true;
        }
        else
        {
            rbProveedor.Checked = true;
        }

        txtCelular.Text = cliente.Telefono.Celular;
        txtTelefonoComercial.Text = cliente.Telefono.TelComercial;
        txtTelefonoDeposito.Text = cliente.Telefono.TelDeposito;
        txtTelPart.Text = cliente.Telefono.TelPart;
        txtFax.Text = cliente.Telefono.Fax;
        txtRazonSocial.Text = cliente.RazonSocial;
        txtCodigo.Text = cliente.Id.ToString();
        txtContacto.Text = cliente.Contacto;
        txtEmail.Text = cliente.Email;
        cliente.CuentaCorriente = new CuentaCorriente();
        txtCuenta.Text = cliente.CuentaCorriente.NumeroCuenta;
        cliente.Domicilio = new Domicilio();
        //cliente.Domicilio.Localidad.CodigoPostal = new CodigoPostal();
        txtCalle.Text = cliente.Domicilio.Calle;
        cliente.Domicilio.Localidad = new Localidad();
        SeleccionarLocalidad(cliente.Domicilio.Localidad);
        txtDepto.Text = cliente.Domicilio.Departamento;
        txtNumero.Text = cliente.Domicilio.Numero;
        txtPiso.Text = cliente.Domicilio.Piso;

        cliente.Domicilio.Localidad = GetLocalidadSeleccionada();
        //cliente.Domicilio.Localidad.Provincia = new Provincia();
        //txtProvincia.Text = cliente.Domicilio.Localidad.Provincia.NombreProv;
        //cliente.Domicilio.Pais = new Pais();
        //txtPais.Text = cliente.Domicilio.Localidad.Pais.NombrePais;            
        cliente.Identificacion = new Identificacion();
        txtNroDni.Text = cliente.Identificacion.Dni;
        txtCuit.Text = cliente.Identificacion.Cuit;
        txtNroCuil.Text = cliente.Identificacion.Cuil;
        txtNroCi.Text = cliente.Identificacion.Ci;
        txtNroLc.Text = cliente.Identificacion.Lc;
        txtNroLe.Text = cliente.Identificacion.Le;
        txtNombre.Text = cliente.Nombre;
        txtObservaciones.Text = cliente.Observaciones;
        txtPagWeb.Text = cliente.PagWeb;
        //cliente.Sexo = new Sexo();
        //cliente.Sexo = GetSexoSeleccionado();
        //cliente.SituacionIva = new SituacionIva();
        //cliente.SituacionIva = GetSituacionAnteIvaSeleccionada();
        txtObservaciones.Text = cliente.Observaciones;

        btnModificarCliente.Enabled = true;
        btnAceptar.Enabled = false;
        tsbGuardar.Enabled = false;
    }

    private void SeleccionarLocalidad(Localidad localidad)
    {
        cbbLocalidad.SelectedItem = localidad;
    } 
```

修改客户信息时，电话、手机或传真的文本框填充了正确的数据，但应该显示地址（domicilio）的文本框和应该显示城市的组合框不是......我希望我很清楚足以让你明白我的担心。请提前帮助和谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:11:16.700

我不确定这是否正确，但似乎这就是您要问的。此方法将允许您将文本插入到数据网格中的 ComboBox 单元格中。

```
 private void ChangeComboBoxCellItems(int RowIndex, int ColumnIndex,string TextToAdd)
    {
        //this line finds the correct row and cell
        DataGridViewComboBoxCell ComboBoxCell = (DataGridViewComboBoxCell)dataGridView1.Rows[RowIndex].Cells[ColumnIndex];

        //this line inserts the text into the combobox items
        ComboBoxCell.Items.Add(TextToAdd);

        //This sets the display text to the string you added to the combobox
        ComboBoxCell.Value = TextToAdd;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:38:15.890

这是客户类

```
public class Cliente
    {
    public int Id { get; set; }
    public int Codigo { get; set; }
    public string Nombre { get; set; }
    public string Apellido { get; set; }
    public string RazonSocial { get; set; }
    public string Email { get; set; }
    public DateTime FechaIngreso { get; set; } 
    public Domicilio Domicilio { get; set; } // residencial
    public Domicilio DomicilioComercial { get; set; }
    public Domicilio DomicilioFiscal { get; set; } // para envio de facturas o tramites
    public Telefono Telefono { get; set; }
    public Telefono Celular { get; set; }
    public Telefono Fax { get; set; }
    public Telefono TelComercial { get; set; }
    public Telefono TelDeposito { get; set; }
    public string Contacto { get; set; }
    public SituacionIva SituacionIva { get; set; } // Si es resp. inscripto,monotributista o exento      
    public Identificacion Dni { get; set; }
    public Identificacion Cuil { get; set; }
    public Identificacion Cuit { get; set; }
    public Identificacion Lc { get; set; }
    public Identificacion Le { get; set; }
    public Identificacion Ci { get; set; }
    public ListaDePrecios ListaDePrecios { get; set; }
    public Vendedor Vendedor { get; set; }
    public string Actividad { get; set; }
    public Categoria Categoria { get; set; } // Si es cliente, provedor etc
    public Sexo Sexo { get; set; } // Masc o femenino        
    public string PagWeb { get; set; }
    public CuentaCorriente CuentaCorriente { get; set; }
    public string Observaciones { get; set; }
    public Identificacion Identificacion { get; set; }
} 
```

}

# nunit - 为什么我的测试方法没有执行？

> ID：12715088
> 
> 赞同：0
> 
> 时间：2012-10-03T19:02:54.320
> 
> 标签：nunit, testcasesource

我有一个相当复杂的集成测试，每个不同的测试用例都需要大量数据。

我的测试用例类如下：

```
public class TestCases
{
  public static IEnumerable MatchingCases
  {
    get
    {
      yield return
        new SearchSetup
        {
         MinimumMatches = 1,
         BulletinSetups = new List<BulletinSetup>
                      {
                        new BulletinSetup
                          {
                            ParameterSetups = new List<ParameterSetup>
                                     {
                                       new ParameterSetup
                                         {
                                          FieldName = "Number",
                                          ParameterName = "@Number",
                                          Value = "TBS1001" + DateTime.Now.ToLocalTime()
                                         }
                                     }
                          }
                      },
         FilterValues = new Dictionary<string, object> { { "Number", "TBS1001" } }
        };
    }
  }
} 
```

我的测试方法的标题是：

```
[Test, TestCaseSource(typeof(TestCases), "MatchingCases")]
public void Search_VariableFilter_NoAccountTeam_ResultIncludesExpected(SearchSetup searchSetup) 
```

当我运行测试时，它返回不确定。当我单步执行代码时，我发现正在访问 MatchingCases 属性 getter，并且 yield return 语句在没有问题的情况下执行，但是没有调用测试方法本身——或者更确切地说，是不可预测的。

看，我已经写过一次这个问题，然后我尝试将测试类移出 testfixture 范围。当我这样做时，代码执行了一次，所以我放弃了我的问题。然后它停止执行了......

为什么我的测试方法没有被调用？

编辑：预测问题 - 这些是正在使用的支持类：

```
public class ParameterSetup
{
    public string ParameterName { get; set; }
    public string FieldName { get; set; }
    public object Value { get; set; }
}

public class BulletinSetup
{
    public List<ParameterSetup> ParameterSetups { get; set; }
}

public class SearchSetup
{
    public List<BulletinSetup> BulletinSetups { get; set; }
    public int MinimumMatches { get; set; }
    public Dictionary<string, object> FilterValues { get; set; }
} 
```

更新 - 第二天

关闭并重新加载 Visual Studio，并在不进行任何更改的情况下重新运行测试后，测试代码会重复执行。我开始怀疑这是一个暂时的故障。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T12:11:15.597

由于重新加载 VS，测试方法执行得很好。我把它归结为一个小故障来解决这个问题。

# python - SDE 的 ListFeatureClasses() 故障

> ID：12715089
> 
> 赞同：2
> 
> 时间：2012-10-03T19:02:55.630
> 
> 标签：python, gis, arcgis, arcpy

我正在使用 arcpy 在我的 SDE 中的每个要素数据集上运行 ListFeatureClasses() - 该行如下所示：

```
FDS = arcpy.ListFeatureDatasets()
for FD in FDS: 
  arcpy.env.workspace = FD
  print arcpy.ListFeatureClasses() 
```

但是对于我知道（并且可以从中加载数据）的一些特征数据集，没有返回任何内容。有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-08-03T17:17:09.780

**尝试这个：**

在循环之前设置工作区：

`env.workspace = r"/path/to/geodatabase"`

设置要素数据集列表：

`datasets = arcpy.ListDatasets("*", "FeatureClass")`

设置一个列表以包含要素数据集：

`fds = [fc for fc in datasets]`

遍历获取其要素类的要素数据集：

`for fd in fds: fc = arcpy.ListFeatureClasses("*", "ALL", fd) print "{}: {}".format(fd, fc)`

* * *

**完整片段：**

```
from arcpy import env
import arcpy

env.workspace = r"path/to/geodatabase"

datasets = arcpy.ListDatasets("*", "FeatureClass")

fds = [fc for fc in datasets]

for fd in fds:
    fc = arcpy.ListFeatureClasses("*", "ALL", fd)
    print "{}: {}".format(fd, fc)` 
```

[ListFeatureClasses (arcpy)](http://resources.arcgis.com/en/help/main/10.2/index.html#/ListFeatureClasses/03q300000023000000/)

# css - iframe 内的媒体查询，或没有框架的 SCORM

> ID：12715095
> 
> 赞同：1
> 
> 时间：2012-10-03T19:03:25.237
> 
> 标签：css, iframe, media-queries, scorm

我有一个响应式设计（使用媒体查询）基于网络的培训（WBT）课程。默认情况下，出于可访问性等问题，此 WBT 不使用任何框架。

但是，当从 SCORM LMS 部署时，它使用充当框架集的文件来进行 SCORM 通信。像这样：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Title of Course Here</title>
        <script src="../common/scripts/scorm.js"></script>

        <style>
            html, body {margin:0; overflow:hidden; padding:0;}
            html, body, iframe {border:0; height:100%; width:100%;}
        </style>
    </head>
    <body>
        <iframe src="index.htm" frameborder="0">
            iframes are not supported by your browser. 
            You can access the pages directly <a href="index.htm">here</a>.
        </iframe>
    </body>
</html> 
```

此页面连接到 SCORM API，并包括`onunload`发送 SCORM 提交和终止命令。

**问题**

当通过移动浏览器查看此页面时，CSS 媒体查询（在内容中）将被忽略，iframe 本身的大小也是如此。这显然很糟糕，因为所有的媒体查询魔法现在都毫无价值。

**可能的解决方案**

两种可能的解决方案（我可以看到）是：

1.  让媒体查询在 iframe 中工作。
2.  在没有框架集的情况下启用 SCORM 通信。

可悲的是，这些解决方案似乎都不可行/不可行。关于如何在没有框架的情况下保持与 SCORM 的通信的任何想法？或者，如何让媒体查询在 iframe 中工作？

**编辑1：**

我研究得越深入，我就越认为解决方案 2 更可取。在移动设备上处理 iframe 似乎是各种痛苦。我在内容框架上使用了response.js（被黑客入侵以始终运行），这确实按预期工作，但后来我遇到了滚动问题。

**编辑2：**

第三种解决方案可能是在 LMS 和 WBT 之间提供一个中间窗口。这个窗口，带有“不要关闭这个窗口”的消息，可以保存对 SCORM API 的引用。从用户体验的角度来看，它并不那么优雅，但它似乎是这 3 种解决方案中最简单的一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-17T22:10:30.647

我知道这已经很晚了，但我想知道您是否尝试过在`<meta>`包含 iframe/frameset 的页面上的标签上设置视口设置：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes"> 
```

由于 iframe 和框架的处理方式（调整大小以适应内容），这可能不适用于 iOS...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T00:03:07.427

第二个选项将起作用，您可以使用计时器将 LMSset() 发送到 API。一些新的浏览器，比如 Chrome，在 onunload 上有问题。计时器解决了它。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-06-06T11:29:40.063

我遇到了同样的问题，只需将此代码放在 html 页面的头部并享受...

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-
scale=1.0,     user-scalable=yes"> 
```

# c# - XNA 矢量数学运动

> ID：12715096
> 
> 赞同：0
> 
> 时间：2012-10-03T19:03:25.380
> 
> 标签：c#, xna, vectormath

我正在用 c# xna 为我在大学的游戏设计课制作一个自上而下的 2D rpg 游戏。我正在尝试创建一个简单的 AI，将敌人移向玩家。目前我的代码如下

```
 /// <summary>
    /// method to move the enemy
    /// </summary>
    /// <param name="target">the position of the target</param>
    /// <returns>the new position to be moved to</returns>
    public virtual Vector2 move(Vector2 target)
    {
        Vector2 temp = (target - Position); // gets the difference between the target and position
        temp.Normalize();                   // sets the vector to unit vector
        temp *= moveSpeed;                  // sets the vector to be the length of moveSpeed
        float x = temp.X;
        float y = temp.Y;
        float xP, yP;
        double angle = Math.Acos(((x * direction.X) + (y * direction.Y)) / (temp.Length() * direction.Length())); //dot product finds the angle between temp and direction
        angle *= agility;                                                                                        //gets the angle to move based on agility
        xP = (float)(Math.Cos(angle) * (x - direction.X) - Math.Sin(angle) * (y - direction.Y) + x); 
        yP = (float)(Math.Sin(angle) * (x - direction.X) - Math.Cos(angle) * (y - direction.Y) + y);            // these lines rotate the point x,y around the direction vector by angle "angle"
        return new Vector2(xP, yP);
    } 
```

目标在更新方法中正确传递：

```
 /// <summary>
    /// updates the enemy
    /// </summary>
    public void update()
    {
        this.Position = move(Game1.player.Position);
    } 
```

但敌人根本不动。我在构造函数中添加了代码，确保敏捷性和移动速度不为 0。更改这些值没有任何作用。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:11:36.367

在您的代码中，您返回此（方向角代码）：

```
xP = (float)(Math.Cos(angle) * (x - direction.X) - Math.Sin(angle) * (y - direction.Y) + x);  
yP = (float)(Math.Sin(angle) * (x - direction.X) - Math.Cos(angle) * (y - direction.Y) + y);            // these lines rotate the point x,y around the direction vector by angle "angle" 

return new Vector2(xP, yP); 
```

但是您需要将其退回以进行移动：

```
temp *= moveSpeed;                  // sets the vector to be the length of moveSpeed    
float x = temp.X;    
float y = temp.Y; 
...

return new Vector2(x, y); 
```

# html - 是否可以在 HTML SVG 元素中包含 PDF？

> ID：12715098
> 
> 赞同：0
> 
> 时间：2012-10-03T19:03:29.023
> 
> 标签：html, svg

我有一个 PDF 文件，我想将其放入 HTML SVG 元素中。有谁知道这是否可能？我已经浏览了[其他](https://developer.mozilla.org/en-US/docs/SVG)[几个](http://www.w3.org/Graphics/SVG/) [资源](http://msdn.microsoft.com/en-us/library/gg589526%28v=vs.85%29.aspx)，并且在没有任何运气的情况下完成了我能想到的尽可能多的不同 Google 搜索。

我最接近的是在[http://svg-wow.org/filterEffects/twirl.svg](http://svg-wow.org/filterEffects/twirl.svg)嵌入图像的样本。如果我尝试使用 PDF 执行此操作，则只会显示第一页。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:47:13.440

你试过[这个](https://github.com/mozilla/pdf.js)。也许不完全是您正在寻找的东西（没有 svg） - 但非常接近。

# forms - 从商店中的对象列表中选择的表单字段

> ID：12715099
> 
> 赞同：1
> 
> 时间：2012-10-03T19:03:31.713
> 
> 标签：forms, extjs, sencha-touch-2, store, picker

我是 Sencha 的新手，试图实现一个 Sencha 表单面板，其中包含一个从商店中的对象列表中选择的字段。这似乎是一个足够基本的模式，必须有一个简单的解决方案。我有一个模型，它定义了一个返回名称/id 对的 json 数组（位置）的 ajax 端点：

```
Ext.define('MyApp.model.Place', {
    extend: 'Ext.data.Model',
    config: {
        fields: [
            {name: 'name', type: 'string'},
            {name: 'id', type: 'int'},
        ],
        proxy: {
            type: 'ajax',
            url: '/m/places/',
            reader: {
                type: 'json',
                rootProperty: 'places',
            },
        },
    },
}); 
```

还有一家商店：

```
Ext.define('MyApp.store.Place', {
    extend: 'Ext.data.Store',
    requires: ['MyApp.model.Place'],
    config: {
        model: 'MyApp.model.Place',
        autoLoad: true,
        sorters: [
            {
                property : 'name',
                direction: 'ASC',
            },
        ],
    },
}); 
```

我想要一个用于地名的只读文本字段和一个用于提交地点 ID 的隐藏字段：

```
{
    xtype: 'textfield',
    name: 'place_name',
    label: 'Place',
    readOnly: true,
    listeners: {
        focus: function () {
            var place_picker = Ext.create('Ext.Picker', {
                slots: [
                    {
                        name: 'place_name',
                        title: 'Choose a Place',
                        store: Ext.create('MyApp.store.Place'),
                        itemTpl: '{name}',
                        listeners: {
                            itemtap: function (obj, index, target, record, e, eOpts) {
                                var form = Ext.getCmp('entityform');
                                form.setValues({
                                    place_name: record.get('name'),
                                    place_id: record.get('id'),
                                });
                                // how to dismiss the picker?
                                obj.parent.hide();
                            },
                        },
                    },
                ]
            });
            Ext.Viewport.add(place_picker);
            place_picker.show();
        },
    },
},
{
    xtype: 'hiddenfield',
    name: 'place_id',
}, 
```

此时，点击该字段会导致选择器从底部向上滑动并显示加载动画，但它没有被地名列表填充，尽管我可以看到 ajax 请求已经发出并且它已经返回了预期的 json 文档。

我会在这里停下来问问我是否走在正确的轨道上，还是有更好的方法？

为什么选择器没有填充 ajax 请求的结果？我对 itemTpl 的使用不正确吗？

我是否以适合 sencha 的方式设置表单字段？

我应该如何关闭 itemtap 上的选择器？我不知何故怀疑我使用 hide() 是正确的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-11T06:59:02.590

选择器插槽有一个数据配置，它是一个对象数组。它应该具有带有文本和值的特定格式。

```
slots :[
    data : [{
text : someValue,
value : someValue1,}] ] 
```

您需要将具有字段文本和值的对象添加到插槽。

# regex - VIM：选择一个正则表达式，然后应用一个命令

> ID：12715101
> 
> 赞同：5
> 
> 时间：2012-10-03T19:03:35.993
> 
> 标签：regex, vim, text

我想将一大组标识符从小写更改为大写。我有一个文件，其中包含多个（数百个）以`q_`. 我构建了一个定义此匹配的正则表达式：`(q_\w*)`现在我想应用`~`命令使它们全部大写（它们当前是小写）。我觉得 VIM 完全有能力做到这一点，但我的技能还没有，你能帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T19:10:11.373

如果要对整个标识符进行大写，对于文件中的每个标识符，请使用以下替换命令：

```
%s/q_\w\+/\U&/g 
```

这里的技巧在于`&`替换模式，它引用了整个匹配。这将替换`q_identifier1`为`Q_IDENTIFIER1`.

如果您只想大写`q`，那么您可以使用：

```
%s/q_\(\w\+\)/Q_\1/g 
```

现在`q_identifier1`将改为：`Q_identifier1`

如果您想大写*除 之外*的所有内容`q_`，请使用：

```
%s/q_\(\w\+\)/q_\U\1/g 
```

现在`q_identifier1`将改为：`q_IDENTIFIER1`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:36:40.703

您也可以为此使用宏：

*   搜索您的模式：`/q_\w*`
*   开始录制宏：`qq`
*   大写并找到下一个：`llve~n`
*   停止录制宏：`q`
*   必要时重复：`666@q`

但仅此而已，否则它将换行并变回小写（或者您可以关闭`wrapscan`或`ignorecase`暂时关闭）。

# javascript - knockout.js 未正确设置选择选项

> ID：12715107
> 
> 赞同：2
> 
> 时间：2012-10-03T19:03:59.107
> 
> 标签：javascript, select, knockout.js, option

也许我误解了这是如何工作的。我想使用 knockout.js 来填充选择元素选项。我正在使用以下标记来实现这一点：

```
<select data-bind="options: type_options, optionsText: function(item) {
            return item.text;
        }, optionsValue: function(item) {
            return item.value;
        }, optionsCaption:'Select a type...',
        value: type"> 
```

以下是相关型号代码：

```
 var myModel = {
    type: ko.observable(),

    type_options: ko.observableArray([
        {text: "String 1", value:1},
        {text: "String 2", value:2},
        {text: "String 3", value: 3},
        {text: "String 4", value: 4},
        {text: "String 5", value: 5}
    ]),
 } 
```

现在下拉列表正确呈现，所有正确的文本和值，但是当我从下拉列表中选择一个选项时，它没有正确设置“类型”的值。

例如，如果我选择了标记为“String 4”的选项，并在浏览器中运行以下命令：

```
myModel.type() 
```

我希望它返回值“4”。相反，我得到对象整个对象：

```
Object
     text: "String 4"
     value: 4
     __proto__: Object 
```

我的问题是如何根据选项的 value 属性而不是整个对象来设置类型的值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T19:07:53.433

好吧，您应该能够在选项数组而不是函数中传递变量的文本。我不知道这是否是导致问题的原因，但您的标记看起来会更好

```
<select data-bind="options: type_options, optionsText: 'text', optionsValue: 'value', optionsCaption:'Select a type...', value: type"></select> 
```

那应该可以满足您的需求，完整示例请参见[小提琴](http://jsfiddle.net/Rynan/cTmR8/)。

# domain-driven-design - 领域驱动设计外部系统和技术依赖

> ID：12715114
> 
> 赞同：1
> 
> 时间：2012-10-03T19:04:22.017
> 
> 标签：domain-driven-design

我正在使用领域驱动的设计概念设计一个系统，但我正在努力解决一些问题。“域”本质上是我工作的公司的业务系统。我也在使用依赖注入。所以，在我的模型中，我有与任何典型业务系统相关的东西（员工、订单、发票、存款等）。现在我正在尝试创建一个现金过帐应用程序，用户（又名员工）可以在其中创建存款并将其应用于未付发票。我遇到的问题是我们还使用外部业务系统（Microsoft Dynamics Nav）来处理我们的会计交易。所以本质上我正在处理两个不同的数据库。因此，对于现金过帐应用程序，我对域对象 Deposit 和 DepositLine 进行了建模。我的域中还有一个 IDepositRepository 接口，负责保存存款。要从系统中获取存款，我只想直接从数据库中获取。但是，为了创建存款，我必须使用 Dynamics Nav Web 服务，因为在幕后执行某些我不知道的逻辑。我开始研究反腐败层的概念，在该层中，我可以将我的存款对象版本转换为适合 Web 服务的存款对象。所以这就是我现在所设想的：为了创建存款，我必须使用 Dynamics Nav Web 服务，因为在幕后执行某些我不知道的逻辑。我开始研究反腐败层的概念，在该层中，我可以将我的存款对象版本转换为适合 Web 服务的存款对象。所以这就是我现在所设想的：为了创建存款，我必须使用 Dynamics Nav Web 服务，因为在幕后执行某些我不知道的逻辑。我开始研究反腐败层的概念，在该层中，我可以将我的存款对象版本转换为适合 Web 服务的存款对象。所以这就是我现在所设想的：

## 领域层

```
- Models
    - Deposit
    - DepositLine
- Repositories
    - IDepositRepository 
```

## 基础设施层

```
- Data
    - Repositories
        - DepositRepository
- DynamicsNav
    - Services
        - INavCashManagementService
    - Translators
        - IDepositTranslator
    - Adapters
        - INavAdapter 
```

现在我想我可以像这样实现 DepositRepository ：

```
public class DepositRepository
{
    private INavCashManagementService navCashManagementService;

    public DepositRepository(INavCashManagementService navCashManagementService)
    {
        this.navCashManagementService = navCashManagementService;
    }

    public Deposit GetDeposit(int id)
    {
        // use nhibernate to get directly from the database
    }

    public void SaveDeposit(Deposit deposit)
    {
        this.navCashManagementService.CreateDeposit(deposit);
    }
} 
```

首先，这是一个合适的设计吗？我的下一个问题是用户还必须“发布”存款。Nav Web 服务也必须用于运行发布例程。但是，这更像是一个业务流程而不是持久性问题，所以我认为它不适合存储库。所以我想知道我应该如何/在哪里调用发布程序。我应该像这样创建域服务：

```
public class CashPostingDomainService
{
    private INavCashManagementService navCashManagementService;

    public CashPostingDomainService(INavCashManagementService navCashManagementService)
    {
        this.navCashManagementService = navCashManagementService;
    }

    public void PostDeposits()
    {
        this.navCashManagementService.PostDeposits();
    }
} 
```

我对域驱动设计的一个困惑是外部依赖。CashPostingDomainService 类现在对 Nav 没有外部依赖吗？我知道实现不在域层中，但是接口本身不是使其成为依赖项吗？发送电子邮件等其他技术问题也是如此。如果我有一个 IEmailService 接口，并且想在存款过帐后发送电子邮件，我会将该接口注入 CashPostingDomainService 类吗？或者这会是应用程序工作流程的一部分吗？那么这些选项中的哪一个最有意义（如果有的话）：

## 1

```
public class DepositController
{
    private ICashPostingDomainService cashPostingDomainService;
    private IEmailService emailService;

    public DepositController(
        ICashPostingDomainService cashPostingDomainService, 
        IEmailService emailService)
    {
        this.cashPostingDomainService = cashPostingDomainService;
        this.emailService = emailService;
    }

    public void PostDeposits()
    {
        this.cashPostingDomainService.PostDeposits();
        this.emailService.NotifyDepositsPosted();
    }
} 
```

## 2

```
public class DepositController
{
    private ICashPostingDomainService cashPostingDomainService;

    public DepositController(
        ICashPostingDomainService cashPostingDomainService)
    {
        this.cashPostingDomainService = cashPostingDomainService;
    }

    public void PostDeposits()
    {
        this.cashPostingDomainService.PostDeposits();
    }
}

public class CashPostingDomainService
{
    private INavCashManagementService navCashManagementService;
    private IEmailService emailService;

    public CashPostingDomainService(
        INavCashManagementService navCashManagementService,
        IEmailService emailService)
    {
        this.navCashManagementService = navCashManagementService;
        this.emailService = emailService;
    }

    public void PostDeposits()
    {
        this.navCashManagementService.PostDeposits();
        this.emailService.NotifyDepositsPosted();
    }
} 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T14:06:21.870

> 这是一个合适的设计吗？

对我来说似乎很好。重要的是您的存储库要忘记导航方面的事情，并让反腐败层处理它。您可能想在[这里](https://stackoverflow.com/questions/909264/ddd-anti-corruption-layer-how-to)查看类似的示例。

> 我知道实现不在域层中，但是接口本身不是使其成为依赖项吗？

您可能会有这种感觉，因为您的（假设是不可知的）服务接口的名称包含“Nav”。为了反映可以将 Nav*或*任何其他 ERP 作为实现的服务抽象，您应该将其重命名为`ICashManagementService`.

> 如果我有一个 IEmailService 接口，并且想在存款过帐后发送电子邮件，我会将该接口注入 CashPostingDomainService 类吗？或者这会是应用程序工作流程的一部分吗？

选择其中一个是您的架构决定。

选项 1\. 意味着发送电子邮件是存款发布域操作的固有部分。如果您使用您的域模块并在另一个应用程序中重复使用它，那么发布存款将自动导致发送一封电子邮件，无论该应用程序是关于什么的。在您的上下文中，这可能是正确的做法，或者您可能想让事情变得更通用（例如，在操作后发送反馈，但在域服务中没有决定该反馈是否应该是邮件、日志文件等.)

选项 2\. 意味着在发布存款后发生的事件序列是特定于应用程序的，即在用例级别而不是业务/域级别。由控制器（或应用程序服务）决定采取哪些操作 - 发送电子邮件或其他任何内容。因此，基于您的领域层的不同应用程序可能会决定采取不同的操作。如果其中几个选择发送邮件，这也意味着这些应用程序之间可能存在代码重复。

# ruby-on-rails - Rails 4 edge 安装在 mt lion 上

> ID：12715118
> 
> 赞同：11
> 
> 时间：2012-10-03T19:04:37.123
> 
> 标签：ruby-on-rails

如何在我的 Mac 上安装 rails 4.0，最前沿（git 上的主分支）？我可以用 RVM 做吗？

我这样做是为了开始升级一个项目，而不是一个新项目。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-26T06:54:36.077

铁轨4来了！！！

`gem install rails --version 4.0.0.beta1 --no-ri --no-rdoc`

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-03T19:11:29.247

在您的 gemfile 中：

```
gem 'rails', :git => 'git://github.com/rails/rails.git'
gem 'arel',  :git => 'git://github.com/rails/arel.git'
gem 'rack',  :git => 'git://github.com/rack/rack.git' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T17:37:25.887

确保您使用的是最新的 Ruby 1.9.3 补丁级别。

```
git clone https://github.com/rails/rails.git
ruby rails/railties/bin/rails new APPNAME --dev
cd APPNAME
bundle install
bundle exec rails s 
```

通过这种方式，bundler 从您的本地目录结构中引用 gem 源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-28T05:41:53.960

```
gem install rails --version 4.0.0 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-10-03T19:13:48.377

这是一个可靠的答案

[http://stufftohelpyouout.blogspot.com/2012/09/install-local-edge-rails-40-beta-and.html](http://stufftohelpyouout.blogspot.com/2012/09/install-local-edge-rails-40-beta-and.html)

过程或多或少保持不变。您需要从 git 中检出 rails，然后使用它来生成新文件。

--pre 标志应该很快就会起作用:)

# javascript - 如何在 asp.net mvc 3 中完全禁用 javascript 验证

> ID：12715125
> 
> 赞同：0
> 
> 时间：2012-10-03T19:05:04.433
> 
> 标签：javascript, asp.net-mvc-3, validation, client-side

我想编写将发送到浏览器的所有代码，以便完全控制它。

为此，我需要完全禁用 aps.net mvc 提供的 javascript 验证。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T19:17:21.960

我不确定我是否完全理解您的问题，但请尝试将 web.config 中“ClientValidationEnabled”和“UnobtrusiveJavaScriptEnabled”的值更改为 false：

```
 <add key="ClientValidationEnabled" value="false" />
 <add key="UnobtrusiveJavaScriptEnabled" value="false" /> 
```

希望这可以帮助！

# javascript - JQuery将onclick字符串添加到不属于类的锚点

> ID：12715126
> 
> 赞同：0
> 
> 时间：2012-10-03T19:05:11.843
> 
> 标签：javascript, jquery

我有一些通过读取一些 json 加载的 html 代码。在该数据中有一些链接。

我需要添加`onclick="myfunction();"`到这些链接的锚点。

由于我不希望更改任何其他链接，因此我已向所有内部链接（未导入的链接）添加了一个类。

我需要的是一些 jquery 可以做到这一点：

如果链接还没有去`class="internal"`然后添加 onclick="myfunction();"**

所以如果链接看起来像：

```
<a href="" class="internal">Click me</a> 
```

然后什么也没做

但如果是这样：

```
<a href="">Click me</a> 
```

然后改成这样：

```
<a href="" onclick="myfunction();">Click me</a> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:07:47.723

使用[非](http://api.jquery.com/not/)选择器

```
$('a').not('.classname').click(function() { ... }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:08:05.287

使用[`not`伪选择器](http://api.jquery.com/not-selector/)：

```
$('a:not(".internal")').on('click', function () {
    // click handler code here
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T19:09:06.960

只是，不要。

除非您有*非常具体的原因`onclick`在 HTML 上使用显式属性*（而且我想不出您想要这样做的充分理由），否则只需使用`$('a:not(.internal)').on('click', myfunction);`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T19:09:02.093

**将this**参数传递给您的函数

```
onclick="myfunction(this);"

function myfunction(elem){
    if(elem.className == '' || elem.className !== 'internal') return;

} 
```

或者您可以从 HTML 中删除您的事件并使用 jQuery 添加它。

```
<a href="">Click me</a> then it's changed to this: <a href="" >Click me</a>

$('body').on('click' ,  'a' , function(e) {

     if( e.target.className == '' || e.target.className !== 'internal') e.preventDefault();

     myfunction()
}); 
```

这只会添加点击事件

# objective-c - cocos2d 带视图控制器

> ID：12715127
> 
> 赞同：2
> 
> 时间：2012-10-03T19:05:14.353
> 
> 标签：objective-c, opengl-es, uiviewcontroller, cocos2d-iphone

我在我的游戏中使用 cocos2d 和视图控制器。我想使用以下代码使用 cocos2d 场景调用视图控制器

```
PlayAgainViewController* playAgain = [[PlayAgainViewController alloc] initWithNibName:@"PlayAgainViewController" bundle:nil];
    [[[CCDirector sharedDirector] openGLView] addSubview:playAgain.view]; 
```

它在游戏场景中添加视图控制器视图，但不通过使用在 openGl 视图上添加的视图来调用另一个视图控制器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T10:02:27.767

非常感谢您的回答。as：

```
 [[CCDirector sharedDirector] pause];
    PlayAgainViewController* playAgain = [[PlayAgainViewController alloc] initWithNibName:@"PlayAgainViewController" bundle:nil];
    AppDelegate* app = (AppDelegate*)[[UIApplication sharedApplication] delegate];
    [app.navigationController pushViewController:playAgain animated:YES]; 
```

它对我有很大帮助并解决了我的问题。但是现在我面临一个新问题，即当我使用您的答案从 cocos2d 层调用视图控制器时，它的工作非常好:)，但是当我想调用另一个调用 EAGLView 的视图控制器时，使用以下代码：

```
 if([[CCDirector sharedDirector] isPaused])
     [[CCDirector sharedDirector] replaceScene:[Game scene]];
 else 
     [[CCDirector sharedDirector] runWithScene:[Game scene]]; 
```

它显示白屏。我认为问题在于质地。你能告诉我如何在调用视图控制器时释放层中使用的纹理吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T08:31:51.733

//如果 UR_COCOS2D_VERSION_2_0

```
 AppController *app =  (AppController*)[[UIApplication sharedApplication] delegate];    
  [app.navController presentModalViewController:playAgain animated:YES]; 
```

//Cocos2D 1.0，在appDelegate中使用viewController属性。

```
 AppDelegate* app = (AppDelegate*)[[UIApplication sharedApplication] delegate];              
 [app.viewController presentModalViewController:playAgain animated:YES]; 
```

# java - 如何比较两个图像的相似性（与 MD5 不完全匹配）？

> ID：12715130
> 
> 赞同：3
> 
> 时间：2012-10-03T19:05:28.243
> 
> 标签：java, php, android, ubuntu, ocr

如何拍摄两张图像并比较它们以查看它们的相似程度？

我不是在谈论使用 MD5 比较两个精确的图像。我正在比较的两个图像将完全不同，有时尺寸也可能不同。

以口袋妖怪卡片为例：我将扫描每张卡片的高清图像。我希望用户能够用他们的手机为他们的口袋妖怪卡片拍照，并且我希望能够将它与我的扫描图像进行比较，然后确定他们拍照的是哪张卡片。

处理不必直接在手机上完成，卸载到 Web 服务是一种选择，但请注意，我的知识在编程语言上有些有限（几乎仅限于 PHP/JAVA/Android）。我使用的服务器是我自己的 Ubuntu 服务器，所以如果有帮助的话，我可以从 php 访问 exec 命令。

起初，我认为以前有人会这样做（比较两张图片）。我尝试使用 php 和 imageik 使用我发现声称可以做我正在尝试的事情的示例（使用 compareImages() ），但它根本不起作用。关于做这样的事情似乎没有太多（如果有的话）文档，这就是为什么我如此卡住。我所寻找的只是朝着正确的方向前进。

我的第二个想法是尝试使用 OCR 仅提取卡片的标题，然后将其与标题数据库进行比较并显示与该标题相关的图像。到目前为止，我首先尝试使用 phpocr，但它根本不起作用，因为我理解它需要单色图像。接下来，我直接从服务器上的控制台尝试了 tesseract，虽然它比 phpocr 做得更好，但扫描图像上超过 80% 的字符要么错误要么不正确，因此来自智能手机的质量较低的图像真的会有烦恼。

我还尝试了适用于 Android 的 OpenCV，但无法让任何示例正常工作。

有没有人做过这样的事情，或者至少使用了可以完成我正在寻找的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:53:42.787

有两个不同的任务 - 识别感兴趣的区域（可以使用 Haar 级联完成 - 与面部检测相同）和识别图像的识别可以
使用不变矩技术完成（如 Hu 矩 - 足以计算苏联坦克在卫星图像上，所以它对口袋妖怪有好处）。不变矩的好特性是在质量低的情况下结果的软退化——你会得到一个符号的概率列表——比如这是 80% 的皮卡丘和 30% 的其他东西。

我们正在开发基于不变矩的 OCR 库，以便在 android 中使用：

[https://sourceforge.net/projects/javaocr/](https://sourceforge.net/projects/javaocr/)

（纯java，速度合理，demos子目录下有android示例。这里是基于javaocr的app，它会识别黑底白字电话号码并拨打： https: [//play.google.com/store/apps/ details?id=de.pribluda.android.ocrcall&feature=search_result#?t=W251bGwsMSwyLDEsImRlLnByaWJsdWRhLmFuZHJvaWQub2NyY2FsbCJd](https://play.google.com/store/apps/details?id=de.pribluda.android.ocrcall&feature=search_result#?t=W251bGwsMSwyLDEsImRlLnByaWJsdWRhLmFuZHJvaWQub2NyY2FsbCJd) )

您还可以考虑一些瞄准帮助，以便用户定位符号正确匹配（所以第一个任务将使用真正的智力）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:44:07.900

你应该决定你需要什么样的相似性比较。有几何算法。他们使用边缘检测，然后尝试匹配两个图像中检测到的边缘。在处理具有相同形状的不同颜色对象时，它们可能很有用。还有一些算法更多地基于颜色相似性。他们比较图像中的颜色以及它们的分布方式。

如果您正在寻找一个具体的算法，您可能应该看看[Hough Transform](http://en.wikipedia.org/wiki/Hough_transform)。

# objective-c - 关闭视图时 performSelectorInBackground 导致随机崩溃

> ID：12715131
> 
> 赞同：0
> 
> 时间：2012-10-03T19:05:33.907
> 
> 标签：objective-c, ios, exc-bad-access, nsthread, nsautoreleasepool

我的这部分代码发生了一些随机崩溃：

```
-(void) goBack {

        [self performSelectorInBackground:@selector(addActivityIndicator) withObject:nil];

        [self.navigationController popViewControllerAnimated:YES];

        }

- (void)addActivityIndicator {
        @autoreleasepool {

            UIActivityIndicatorView *activityView = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleWhite];

            UIBarButtonItem * barButton = [[UIBarButtonItem alloc] initWithCustomView:activityView];

            [activityView startAnimating];

            self.navigationItem.leftBarButtonItem = barButton;

        }
    } 
```

当我想退出这些方法所在的屏幕时，另一个 ViewController 必须处理一些数据。为了通知用户正在进行处理，我在导航栏中的左侧按钮中添加了一个活动指示器。

问题是有时我会得到一个`exc_bad_access`in`addActivityIndicator`方法。频率非常随机，有时 XCode 在末尾显示错误`@autoreleasepool`，有时在行`self.navigationItem.leftBarButtonItem = barButton;`

我想有时我的 viewController 被破坏但线程仍在运行并尝试访问不再存在的对象的 navigationItem。但我不确定这是否是问题所在，也不知道如何解决。

我在我的项目中使用 ARC，这个问题出现在我测试的所有 iOS 版本中。

拜托，任何人都可以向我解释发生了什么，我该如何解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T19:08:50.233

你永远不应该在后台做 UIKit 的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:12:15.110

通过调用`[self performSelectorInBackground:@selector(addActivityIndicator) withObject:nil];`，您正在后台线程上更新 UI。您应该只在主线程上更新 UI。

**编辑**

根据您的评论，您试图在视图弹出之前更新 UI。这样做的方法是：

```
[self addActivityIndicator]

[navigationController performSelector:@selector(popViewControllerAnimated:) withObject:[NSNumber numberWithBool:YES] afterDelay:0]; 
```

你也可以看看`dispatch_after`

# c++ - c++抽象类接受派生类参数

> ID：12715132
> 
> 赞同：2
> 
> 时间：2012-10-03T19:05:36.430
> 
> 标签：c++, polymorphism, abstract-class

我想用一个成员函数创建一个类，该函数引用另一个类，其中两个类都派生自抽象类。我收到一个编译器错误，指出类 Container 是抽象的，因为它没有实现 addElem()。

```
class Ielem
{
public:
  virtual void action() = 0;
};

class Elem: public Ielem
{
public:
  void action() {};
  void extra() {};
};

class Icontainer
{
public:
  virtual void addElem(Ielem &elem) = 0;
};

class Container: public Icontainer
{
public:
  void addElem(Elem &elem) { elem.extra(); };
};

int main(int argc, char* argv[])
{
  Elem e;
  Container c;
  c.addElem(e);

  return 0;
} 
```

看起来这应该可行，因为任何对 Elem 的引用也是对 Ielem 的引用。如果我让 Container::addElem 引用一个 Ielem，它就会编译。但是 Container::addElem() 不能调用 Elem::extra() 除非我使用 dynamic_cast，这在我正在使用的嵌入式编译器上不可用，或者常规转换，它不是类型安全的。

建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:10:22.327

这是错误的方式：基类`Icontainer`指定`addElem`可以将*任何* `Ielem`对象作为参数，但在派生类中您*只* `Elem`接受. 这是一个“较窄”的类型，因此违反了基类中指定的“我接受`Ielem`你扔给我的任何东西”的约定。

我认为模板将是这里的解决方案。你甚至不再需要基类了。像这样的东西：

```
class Elem
{
public:
  void action() {};
  void extra() {};
};

template<typename ElemType>
class Container
{
public:
  void addElem(ElemType &elem) { elem.extra(); };
};

int main(int argc, char* argv[])
{
  Elem e;
  Container<Elem> c;
  c.addElem(e);

  return 0;
} 
```

作为奖励，您现在可以`Container`与*任何*具有`extra()`函数的类型一起使用，并且它可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:34:49.963

问题只是您的虚拟方法与旨在重载它的具体方法没有相同的签名；所以编译器将它完全视为一个不同的函数并抱怨你没有实现`void addElem(Ielem &elem)`. 这是一种您可能不想要的解决方案——

```
class Icontainer
{
public:
  virtual void addElem(Elem &elem) = 0;  //Ielem -> Elem
}; 
```

这取决于您的所有其他约束，但我认为我会做什么——以及似乎符合一般设计准则的做法，例如 Sutter 和 Alexandreascu，将创建一个具有完整接口的中间抽象类——

```
class Melem: public Ielem
{
public:
  // void action() {}; //Already have this form Ielem
  void extra() = 0;
}; 
```

接着

```
class Icontainer
{
public:
  virtual void addElem(Melem &elem) = 0;
};

class Container: public Icontainer
{
public:
  void addElem(Melem &elem) { elem.extra(); }; 
     //*Now* we're implementing Icontainer::addElem
}; 
```

# java - 如何在用户角色中实现开始和结束日期

> ID：12715134
> 
> 赞同：1
> 
> 时间：2012-10-03T19:05:42.520
> 
> 标签：java, hibernate, web-applications, spring-mvc

我正在开发一个带有用户帐户的网络应用程序。我有三个系统角色和几个用户。我已经以这种方式实现了它（为了更好地理解而进行了简化）：

```
 @Table(name = "user")
    public class User {

        @Id
        private String id;

        @Column(name = User.COLUMN_LOGIN)
        private String login;

        @Column(name = User.COLUMN_PASSWORD)
        private String password;

        @ManyToMany(cascade = CascadeType.DETACH, fetch = FetchType.EAGER)
        @JoinTable(name = "role_to_user",
                joinColumns={@JoinColumn(name = "userId")},
                 inverseJoinColumns={@JoinColumn(name = "roleId")})
        private Set<Role> roles = new LinkedHashSet<Role>();
   }

   @Table(name = "role")
   public class Role {

        @Id
        private String id;

        @Column(name = Role.COLUMN_ROLETYPE)
        private int roletype;
   } 
```

将角色分配给用户的日期和结束此分配的日期的最佳方法是什么？我的想法是将列 startDate 和 endDate 添加到名为的绑定表中`role_to_user`，但我不知道如何告诉它休眠:)

这是个好主意还是有更好的方法来做到这一点？

谢谢， Ondrej

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:24:25.867

您的设计假设是正确的。有人说，在现实生活中*，多对多的*关系非常少见。您需要第三个表/对象，我们称之为“RoleAssignment”：

```
@Entity
@Table(name = "role_to_user")
public class RoleAssignment {

    @ManyToOne
    private User user;

    @ManyToOne
    private Role role;

    private Date startDate;

    private Date endDate;

} 
```

当然需要在`User`课堂上进行一些调整：

```
@ManyToMany()
private Set<RoleAssignment> roles = new HashSet<>(); 
```

现在，您可以同时浏览`User`和`Role`过滤非活动角色。

# javascript - “文档准备就绪”应该在 IE 上像这样工作吗？

> ID：12715136
> 
> 赞同：2
> 
> 时间：2012-10-03T19:05:55.560
> 
> 标签：javascript, jquery, onload, document-ready, domcontentloaded

出于各种原因，包括学习，我正在制作一个小型 javascript 框架。

因此，我想实现“文档就绪”功能，所以我去检查 jQuery 如何`DOMContentLoaded`在 IE < 9 上伪造。

问题是，它似乎没有按应有的方式工作。在 IE8 和一个好的浏览器中检查[这个小提琴。](http://jsfiddle.net/Camilo/PFWmS/)

逻辑是：应用 css 使 div 开始为红色，然后在“准备好”时使其变为蓝色，在加载时使其变为绿色。此外，还有三个带有虚假 URL 的 img 标签，因此在准备和加载之间存在综合滞后。

**应该发生什么：**
如果有的话，div 不应显示为红色超过一瞬间。理想情况下，首先看到的应该是蓝色。然后，当浏览器在无效图像上超时时，绿色。

**在 IE8 上会发生什么：**
div 保持红色，直到所有图像“加载”（在此合成示例中为超时），然后变为绿色。

再一次，我并不是在要求修复，我是在问一个框架在 IE8 上的行为是否正确（我不再关心 IE 6-7），或者这是否正在发生由于我以某种方式滥用 jQuery。

PS：我知道如何手动绑定事件，我正在询问更多关于这是否是预期/可接受/错误/我的错误。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T19:15:01.553

我将按预期工作。

jQuery 正在`document.readyState`为不支持的浏览器使用`DOMContentLoaded`. 仅当页面的资源完成加载`document.readyState`时才等于。`complete`

[https://developer.mozilla.org/en-US/docs/DOM/document.readyState](https://developer.mozilla.org/en-US/docs/DOM/document.readyState)

他们没有在“交互式”上这样做可能有一个很好的理由，但我对此并不积极。

编辑：这是您在 document.readyState == interactive 上更新的小提琴

[http://jsfiddle.net/PFWmS/7/](http://jsfiddle.net/PFWmS/7/)

它适用于 IE7 和 IE8

**编辑**

jQuery 不使用“交互式”的原因是因为它在 IE9 中触发得太早了。

[http://bugs.jquery.com/ticket/12282#comment:25](http://bugs.jquery.com/ticket/12282#comment:25)

我认为可能有更好的方法来处理导致 IE7 和 8 正确的准备时间，同时仍然在 IE9 中正常工作

# python - Python、WSGI、多处理和共享数据

> ID：12715139
> 
> 赞同：26
> 
> 时间：2012-10-03T19:06:06.573
> 
> 标签：python, multiprocessing, mod-wsgi, wsgi

我对 mod_wsgi 的多处理功能以及将在具有多处理能力的 WSGI 服务器上执行的 WSGI 应用程序的一般设计有点困惑。

考虑以下指令：

```
WSGIDaemonProcess example processes=5 threads=1 
```

如果我理解正确，mod_wsgi 将产生 5 个 Python（例如 CPython）进程，并且这些进程中的任何一个都可以接收来自用户的请求。

文档说：

> 共享数据需要对所有应用程序实例可见，无论它们在哪个子进程中执行，并且一个应用程序对数据所做的更改立即可供另一个应用程序使用，包括在另一个子进程中执行的任何操作，外部数据存储，例如必须使用数据库或共享内存。普通 Python 模块中的全局变量不能用于此目的。

但在这种情况下，当人们想要确保应用程序在任何 WSGI 条件下（包括多处理条件）运行时，它会变得非常繁重。

例如，一个包含当前连接用户数量的简单变量——它应该是进程安全的从 memcached 读/写到 memcached 还是一个 DB 或（如果这种超出标准的库机制可用）共享记忆？

并且代码会像

```
counter = 0

@app.route('/login')
def login():
    ...
    counter += 1
    ...

@app.route('/logout')
def logout():
    ...
    counter -= 1
    ...

@app.route('/show_users_count')
def show_users_count():
    return counter 
```

在多处理环境中表现不可预测？

谢谢！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-08T13:28:03.113

您的问题有几个方面需要考虑。

首先，apache MPM 和 mod_wsgi 应用程序之间的交互。如果您在嵌入式模式下运行 mod_wsgi 应用程序（`WSGIDaemonProcess`不需要`WSGIProcessGroup %{GLOBAL}`），您将从 apache MPM 继承多处理/多线程。这应该是最快的选项，并且您最终会拥有多个进程和每个进程的多个线程，具体取决于您的 MPM 配置。相反，如果您在守护程序模式下运行 mod_wsgi ，使用`WSGIDaemonProcess <name> [options]`and `WSGIProcessGroup <name>`，您可以很好地控制多处理/多线程，但开销[很小](http://code.google.com/p/modwsgi/wiki/PerformanceEstimates)。

在单个 apache2 服务器中，您可以定义零个、一个或多个命名的`WSGIDaemonProcess`es，并且每个应用程序都可以在这些进程之一中运行 ( `WSGIProcessGroup <name>`) 或以嵌入模式运行`WSGIProcessGroup %{GLOBAL}`。

您可以通过检查`wsgi.multithread`和`wsgi.multiprocess`变量来检查多处理/多线程。

使用您的配置`WSGIDaemonProcess example processes=5 threads=1`，您有 5 个独立的进程，每个进程都有一个执行线程：没有全局数据，没有共享内存，因为您无法控制生成子进程，但 mod_wsgi 会为您完成。为了共享全局状态，您已经列出了一些可能的选项：进程接口的数据库、某种基于文件系统的持久性、守护进程（在 apache 之外启动）和基于套接字的 IPC。

正如 Roland Smith 所指出的，后者可以通过以下方式使用高级 API 来实现[`multiprocessing.managers`](http://docs.python.org/library/multiprocessing.html#managers)：在 apache 之外创建并启动`BaseManager`服务器进程

```
m = multiprocessing.managers.BaseManager(address=('', 12345), authkey='secret')
m.get_server().serve_forever() 
```

在您的应用程序中，您`connect`：

```
m = multiprocessing.managers.BaseManager(address=('', 12345), authkey='secret')
m.connect() 
```

上面的例子是假的，因为`m`没有注册有用的方法，但是[在这里](http://docs.python.org/library/multiprocessing.html#using-a-remote-manager)（python 文档）你会发现如何在你的进程中创建和*代理*一个对象（就像`counter`你的例子中的）。

对您的示例的最后评论，使用`processes=5 threads=1`. 我知道这只是一个例子，但在现实世界的应用程序中，我怀疑性能将与以下方面相当`processes=1 threads=5`：只有在“单进程多线程”的预期性能提升时，您才应该进入多处理中共享数据的复杂性模型很重要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-05T19:30:30.860

从有关 wsgi 的进程和线程的文档中：

> 当 Apache 在有多个子进程的模式下运行时，每个子进程将包含每个 WSGI 应用程序的子解释器。

这意味着在您的配置中，有 5 个进程，每个进程有 1 个线程，将有 5 个解释器并且没有共享数据。您的计数器对象对于每个解释器都是唯一的。您需要构建一些自定义解决方案来计算会话数（一个您可以与之通信的常见过程，某种基于持久性的解决方案等）或者，这绝对是我的建议，使用预构建的解决方案（Google Analytics 和 Chartbeat 是很棒的选择）。

我倾向于认为使用全局变量来共享数据是一种全球滥用的大形式。在我进行并行处理的大多数环境中，这都是一个错误和可移植性问题。如果您的应用程序突然要在多个虚拟机上运行怎么办？无论线程和进程的共享模型如何，这都会破坏您的代码。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-07T14:03:06.087

如果您正在使用`multiprocessing`，则有[多种方法](http://docs.python.org/library/multiprocessing.html#sharing-state-between-processes)可以在进程之间共享数据。[值](http://docs.python.org/library/multiprocessing.html#multiprocessing.Value)和[数组](http://docs.python.org/library/multiprocessing.html#multiprocessing.Array)仅在进程具有父/子关系（它们通过继承共享）时才有效。如果不是这种情况，请使用 a[`Manager`](http://docs.python.org/library/multiprocessing.html#managers)和[`Proxy`](http://docs.python.org/library/multiprocessing.html#proxy-objects)对象。

# opengl-es - 如何正确地将多边形分组到数组中？

> ID：12715144
> 
> 赞同：0
> 
> 时间：2012-10-03T19:06:21.847
> 
> 标签：opengl-es, rendering

我想在 OpenGL ES 中渲染一个场景，但是我有一个问题。

因为 ES 中没有立即模式，并且用单多边形缓冲区模拟立即模式很慢，所以我不能只切换纹理并跳过不可见的多边形，所以我必须对我的多边形进行分组。

以下是不同多边形的特征：

*   漫反射纹理（mipmapped，很多）。
*   光照贴图纹理（打包，最多 64 个纹理）。
*   能见度。

起初我想只按可见区域对多边形进行分组，但我找不到使用纹理索引数组的方法。

那么，如何正确制作要渲染的多边形缓冲区？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T18:48:06.700

我将使用纹理子组创建可见性组。Quake 使用 64 个 128x128 光照贴图，我将用一个 1024x1024 光照贴图替换它们，因为现代硬件支持这种大小的纹理。

# hibernate - 子类属性上的 hql

> ID：12715145
> 
> 赞同：6
> 
> 时间：2012-10-03T19:06:27.677
> 
> 标签：hibernate, polymorphism, hql

我有一个类 A 和子类 B 和 C，它们具有不同的属性。我该怎么做：a from A a where (a.class = B and a.specific-property-of-b = "y") or (a.class = C and a.specific-property-of-c =“z”）

是否有可能让 hibernate 明白当它是某个类的实例时，它可以访问它的特定属性，或者不可能做这样的事情，我必须这样做：

a from A a where a.id in (select b.id from B b where b.specific-property-of-b = "y") 或 a.id in (select c.id from C c where c.specific- c 属性 = "z")

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T20:40:08.423

你按照你的建议去做：

```
select a from A a 
where (a.class = B and a.specificPropertyOfB = 'y')
or (a.class = C and a.specificPropertyOfC = 'z') 
```

唯一不能正常工作的事情（根据我的经验）是如果您在两个子类中定义了两个具有相同名称的持久字段。

# php - 如何从隐藏字段设置会话？

> ID：12715147
> 
> 赞同：0
> 
> 时间：2012-10-03T19:06:40.230
> 
> 标签：php, codeigniter

我可以选择让某人在我的页面上以访客身份结帐而无需登录。这`controller`将重定向所有结帐提交，如下所示：

*   如果用户已登录（检查会话）`session->userdata`。如果他们已登录 ->`redirect('checkout_process')`
*   如果用户未登录 ->`redirect('login')`

在登录页面上，他们是一个按钮，上面写着`checkout as guest`如何通过会话让用户以访客身份结帐，而无需在他们单击此按钮时强制他们登录？

# entity-framework - 以下代码是否违反持久性无知规则

> ID：12715150
> 
> 赞同：0
> 
> 时间：2012-10-03T19:06:53.337
> 
> 标签：entity-framework, design-patterns, orm, domain-driven-design

a) *域实体*不应包含与持久性相关的代码，因此它们应该是*Persistence Ignorant* **PI**。但是假设*域模型* **DM**是使用*实体框架*设计的，并假设*服务层* 通过*Linq-to-Entities对***POCO** *域实体*执行 CRUD 操作，我们是否会认为*服务层直接或通过**域模型*访问 DAL ：

 ***```
class CustomerService
{
       public string doSomething( ... )
       {
                ...
                var customer = context.Customers.Where( ... );
                ...
        }
       ...
} 
```

b)在**DM中使用***Linq-to-Entities*是否违反**PI** 规则？例如，以下实体是否违反 PI：****`Customer`****

 ****```
class Customer
{
       public string InterestedWhatOtherCustomerOrdered( ... )
       {
                ...
                var orders = context.Orders.Where( ... ); // does this violate PI rule?
                ...
        }
       ...
} 
```

**回复卢克·麦格雷戈：**

一种）

> 是的，它直接引用上下文。更好的方法是使用 Customer 的内部导航属性来执行相同的操作，

所以*导航属性*应该联系*上下文*？！但是由于*导航属性*也存在于域模型中，我们难道不能说通过直接联系*上下文*，它们也会违反**PI**吗？

b) 根据*Fowler 的关于 Data Mapper 的 PEAA 章节*，可以从*Data Mapper*中提取域代码所需的任何方法到接口类中，然后域代码可以使用该接口类。**当使用EF**而不是手写的*Data Mapper*时，如何以不违反**PI**的方式准确地做到这一点？

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:09:52.607

是的，它直接引用上下文。更好的方法是使用 Customer 的内部导航属性来执行相同的操作，

```
class Customer
{
       public string InterestedWhatOtherCustomerOrdered( ... )
       {
                ...
                var orders = this.Orders;
                ...
        }
       ...
} 
```

或为此函数创建一个单独的查询类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T10:17:51.630

a) DDD 中有不同风格的服务。域层服务不应引用实体框架上下文，因为它会将域与特定的持久性方式紧密耦合 - 与域实体相同，见下文。相比之下，应用层服务可以使用上下文（例如调用`SaveChanges()`），因为它知道当前的工作单元以及*什么时候*应该持久化。

b) 正如卢克所说，是的，它确实违反了 PI，因为实体框架上下文是特定于持久性的。在您的实体中，您应该使用与持久性无关的方式来获取所需的订单。

我不太明白你的`InterestedWhatOtherCustomerOrdered()`方法做了什么（为什么要返回一个字符串？...）但你可以有：

```
class Customer
{
       public string InterestedWhatOtherCustomerOrdered( ... )
       {
                ...
                var orders = OrderRepository.GetOtherCustomerOrdersByInterest(...);
                ...
        }
       ...
} 
```

前提是这`Orders`是一个聚合根。如果不是，您可以使用域层服务，该服务转向基础设施层服务进行查询，或者直接从他们自己的聚合根中询问订单。*******

# html - CSS3 过渡问题

> ID：12715151
> 
> 赞同：0
> 
> 时间：2012-10-03T19:07:01.920
> 
> 标签：html, css

所以我无法让过渡在这里工作，悬停时可以切换图像，我已经在另一个网站上使用了这个过渡，并且在同一台机器和浏览器上使用时工作得很好但是在这个网站上我目前正在构建过渡没有它.... 这是 HTML 和 CSS

```
<div class="grid_4">
<h3 class="foot">
Say Hello! 
</h3>
<h3 class="descripfoot">
<div class="grid_2">
<a class="testicon" title="flickr Link" align="left" href="http://www.flickr.com"></a>
</div>
    some description text goes hereeeee

</h3>
</div>

a.testicon
{
    background: url("../images/testicon.png");
    width:140px;
    height: 140px;
    border-radius: 7px 7px 7px 7px;
    display: inline-block;

 }

a.testicon:hover,a.testicon:focus,a.testicon:active
{
width:140px;
height: 140px;
    border-radius: 7px 7px 7px 7px;
    display: inline-block;
   -webkit-transition: background .3s linear 0s;
-moz-transition: background .3s linear 0s;
background: url("../images/testicon2.png");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:39:45.700

这对我来说很好：http: [//jsfiddle.net/LWsVt/2/](http://jsfiddle.net/LWsVt/2/)

```
a.testicon
{
    background: url(http://lorempixel.com/200/200) center center no-repeat;
    background-size: 200px 200px;
    width:140px;
    height: 140px;
    border-radius: 7px 7px 7px 7px;
    display: inline-block;
    -webkit-transition: background .3s linear 0s; /* obviously declare all vendor prefixes here */
 }

a.testicon:hover,a.testicon:focus,a.testicon:active
{
    background-image: url(http://lorempixel.com/400/400);
    outline:none;
}​ 
```

注意我简化了 CSS 并去掉了多余的属性声明。

# c - 随机数生成器帮助不产生随机数 - C

> ID：12715152
> 
> 赞同：3
> 
> 时间：2012-10-03T19:07:03.730
> 
> 标签：c, random, numbers, generator

我正在制作一个小的 C 程序来类似于游戏代码破坏者或 Mastermind。到目前为止，这是我的代码。到目前为止，它所做的只是生成一个“随机”代码并打印代码的数组。每次我编译它时，它都会生成相同的 2、2、6、3 数组。谁能帮我有一个真正的随机数生成器？

```
#include<stdio.h>
#include<math.h>
#include<stdlib.h>
#include<time.h>
#define CODELENGTH 4
#define NUMSYMBOLS 6
const int LOW = 1;
const int HIGH = 6;

 void genCode (int MasterCode[])
{
int i=0;
int k;
while (i < 4){

MasterCode[i] =rand() %(HIGH-LOW+1)+LOW;
    i++;

}//end while loop.
for ( k = 0 ; k < 4; k++ ) {
    printf( "%d ", MasterCode[ k ] );
}

printf( "\n" );
  }

 void getGuess (int guess[])
 {
int b[ 4 ];
int number = 0;

printf( "Please enter your list of 4 numbers between 1 and 6: " );
int j;
int k;
for ( j = 0 ; j < 4; j++ ) {
    scanf( "%d", &number );
    b[ j ] = number;
}

printf( "Your array has these values: " );

for ( k = 0 ; k < 4; k++ ) {
    printf( "%d ", b[ k ] );
}

printf( "\n" );
}

 int main (int argc, char **argv)
{
int MasterCode[4];
genCode(MasterCode);

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T19:08:29.387

您需要在使用之前播种随机数生成器`rand()`。这通常是这样完成的：

```
srand(time(NULL)); 
```

更多信息可[在此处](http://www.cplusplus.com/reference/clibrary/cstdlib/srand/)获得。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T20:20:59.587

真正的随机生成器很昂贵。
rand() 函数生成一个看似随机的序列，但它始终相同。
该行
`srand(time(NULL));`
只会将其初始化为某个值，该值很可能每次都不同，这将为您提供您想要的。
对于一个游戏来说，这可能就足够了。如果您需要更进一步并拥有更随机的序列，您可以尝试根据用户输入生成一些内容，例如击键时间、鼠标移动和时间。
这与没有专用硬件的情况差不多。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:12:40.813

我所做的是删除了我最初为范围设置的等式，将其切换为更简单的东西，然后我在 main.js 中添加了种子生成器。

```
 #include<stdio.h>
 #include<math.h>
 #include<stdlib.h>
 #include<time.h>
 #define CODELENGTH 4
 #define NUMSYMBOLS 6

 void genCode (int MasterCode[])
 {
int i=0;
int k;
while (i < 4){

MasterCode[i] =rand() %6 +1;
    i++;

}//end while loop.
for ( k = 0 ; k < 4; k++ ) {
    printf( "%d ", MasterCode[ k ] );
}

printf( "\n" );
 }

 void getGuess (int guess[])
 {
int b[ 4 ];
int number = 0;

printf( "Please enter your list of 4 numbers between 1 and 6: " );
int j;
int k;
for ( j = 0 ; j < 4; j++ ) {
    scanf( "%d", &number );
    b[ j ] = number;
}

printf( "Your array has these values: " );

for ( k = 0 ; k < 4; k++ ) {
    printf( "%d ", b[ k ] );
}

printf( "\n" );
 }

 int main (int argc, char **argv)
 {
srand ( time(NULL) );
int MasterCode[4];
genCode(MasterCode);

} 
```

# javascript - 检查函数中是否缺少参数

> ID：12715157
> 
> 赞同：29
> 
> 时间：2012-10-03T19:07:23.213
> 
> 标签：javascript

这是检查函数中缺少参数的正确方法吗？这适用于所有浏览器吗？IE怎么样？

```
function getName(name){
    name = name != null ? name : "default";
    return name;
} 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2012-10-03T19:17:12.440

检查参数的方式取决于您传递给函数的信息类型，以及您希望函数如何处理极端情况。

在大多数情况下，您可以使用：

```
...
bar = bar || ...default value here...
... 
```

但是，当您想要传递虚假值（`false`, `0`, `NaN`, `''`, `undefined`, `null`）时可能会出现问题：

```
function foo(bar) {
  bar = bar || 5
  console.log(bar)
}

foo()          // 5
foo(undefined) // 5
foo(null)      // 5
foo(1)         // 1
foo(0)         // 5, probably not what you wanted
```

相反，您可以检查`undefined`：

```
...
if (bar == undefined) {
    bar = 5
}
... 
```

...但是使用松散检查允许`null`和`undefined`被覆盖（`null == undefined`）：

```
function foo(bar) {
  if (bar == undefined) {
      bar = 5
  }
  console.log(bar)
}

foo()          // 5
foo(undefined) // 5
foo(null)      // 5
foo(1)         // 1
```

因此，`===`通常首选严格的相等比较 ( ) ( `null !== undefined`)：

```
function foo(bar) {
  if (bar === undefined) { 
      bar = 5
  }
  console.log(bar)
}

foo()          // 5
foo(undefined) // 5
foo(null)      // null
foo(1)         // 1
```

ES2015 引入了[默认参数](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Default_parameters)，本质上等同于严格检查`undefined`：

```
function foo(bar = 5) {
  console.log(bar)
}

foo()          // 5
foo(undefined) // 5
foo(null)      // null
foo(1)         // 1
```

This could lead to trouble if you need to know whether `undefined` was passed as a parameter.

If you want to be absolutely certain that you're not passing up an argument that was provided, you can check the number of arguments passed to the function:

```
...
if (arguments.length < 1) {
  bar = 5
}
... 
```

Which means that you can successfully pass `undefined` as an argument while also choosing to use a different default:

```
function foo(bar) {
  if (arguments.length < 1) {
    bar = 5
  }
  console.log(bar)
}

foo()          // 5
foo(undefined) // undefined
foo(null)      // null
foo(1)         // 1
```

* * *

If you have multiple parameters, you may want to use multiple defaults. I've recently found a use case for fallthrough on a switch statement, although [the utility is questionable](https://stackoverflow.com/questions/12537937/implicit-fall-through-code-smell-or-elegant-design):

```
function foo(bar, baz, fizz, buzz) {
  switch (arguments.length) {
    case 0:
      bar = 1;
      //continue; might as well point out that implicit fall-through is desired
    case 1:
      baz = 2;
      //continue;
    case 2:
      fizz = 3;
      //continue;
    case 3:
      buzz = 4;
      //continue;
  }
  console.log(bar, baz, fizz, buzz)
}

foo()               // 1 2 3 4
foo(10)             // 10 2 3 4
foo(10, 20)         // 10 20 3 4
foo(10, 20, 30)     // 10 20 30 4
foo(10, 20, 30, 40) // 10 20 30 40
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2012-10-03T19:08:34.917

你可以做：

```
name = name || 'default'; 
```

这表示如果`name`未定义或虚假（`null`, `0`, `""`, `false`, `{}`, `[]`），请将其设置为`"default"`.

js(h|l)int 会抱怨它，但它至少可以追溯到 IE7。它根本不是无效代码，也不是依赖于一些未记录的行为。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-10-03T19:08:23.123

正确的检查方法是

```
if (typeof name === "undefined") {
    // ...
} 
```

当然，调用者仍然可以通过调用来“愚弄”您`getName(undefined)`，当提供了参数但检查仍会将其标记为未提供时。但这确实是一种病态的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T19:09:16.553

是的，这适用于所有浏览器，但如果您想查看它是否已定义，您可以使用：

```
function getName(name){
   name = typeof(name) !== "undefined" ? name : "default";
   return name;
} 
```

# google-chrome - 使用 CSS 或 Jquery 删除搜索字段中的默认 Google Chrome 麦克风图标？

> ID：12715159
> 
> 赞同：1
> 
> 时间：2012-10-03T19:07:23.700
> 
> 标签：google-chrome, microphone

是否可以使用 CSS 或 Jquery 在搜索字段中删除默认的 Google Chrome 麦克风图标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:15:13.680

如果你看一下`https://google.com`，你会发现驱动麦克风图标的是什么`x-webkit-speech=""`

我做了一个检查元素并删除了那个位，麦克风图标不再出现。如果您不想在您的网站中显示麦克风，也许您可​​以尝试不包括该`x-webkit-speech`位？

`<input id="gbqfq" class="gbqfif" name="q" type="text" autocomplete="off" value="" style="border: none; padding: 0px; margin: 0px; height: auto; width: 100%; background-image: url(data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw%3D%3D); background-color: transparent; position: absolute; z-index: 6; left: 0px; outline: none; background-position: initial initial; background-repeat: initial initial; " x-webkit-speech="" x-webkit-grammar="builtin:search" lang="en" dir="ltr" spellcheck="false">`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-23T01:39:11.757

另一种选择是使用伪元素来隐藏麦克风图标（这适用于旧版本的 Chrome，我不确定是否`x-webkit-speech`不再受支持，因为 Chrome 中现在有功能更强大的 Web Speech API）。

每当我需要隐藏图标时，我一直在使用这个 CSS

```
input::-webkit-input-speech-button {
    display : none;
} 
```

尽管正如该问题的其他答案所暗示的那样，`x-webkit-speech`如果您不希望显示麦克风，则使用该属性可能没有多大意义。如果您想了解 Web Speech API， HTML5Rocks 在[http://updates.html5rocks.com/2013/01/Voice-Driven-Web-Apps-Introduction-to-the-Web-Speech-API](http://updates.html5rocks.com/2013/01/Voice-Driven-Web-Apps-Introduction-to-the-Web-Speech-API)上有一篇很好的文章，其中包括语音合成和语音识别。

# java - Jena TDB 插入语句导致空字段

> ID：12715167
> 
> 赞同：2
> 
> 时间：2012-10-03T19:08:07.270
> 
> 标签：java, rdf, sparql, jena, tdb

我正在使用 Jena API 在 Jena TDB 中插入和更新三元组。我的设计是这样的，每个插入操作都在事务控制中。例如：

```
dataset.begin (ReadWrite.WRITE)
try
{
    // 1st insert operation
    dataset.commit()
} finally {
    dataset.end();
}

dataset.begin (ReadWrite.WRITE)
try
{
    // 2nd insert operation
    dataset.commit()
} finally {
    dataset.end();
} 
```

之后，当我使用 READ transaction 查询 TDB 时，我注意到一些条目（主题、谓词或宾语）是空的。即使我没有使用嵌套事务，为什么它会以这种方式运行？

## 插入代码

```
 public class UpdateTDB2 {

    String directory = "C://myTDB//";
    Dataset dataset = TDBFactory.createDataset(directory);
    public static final String RDFPrefix = "PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>";
    public static final String XSDPrefix = "PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>";
    public static final String MYPrefix = "PREFIX myprefix: <http://www.myexample.com/mySchema#>";

    public static void main(String[] args) {
        UpdateTDB2 obj = new UpdateTDB2();
        obj.createActionInstance();
        obj.createStateInstance();

    }

    public static void execUpdate(String sparqlUpdateString,
            GraphStore graphStore) {
        UpdateRequest request = UpdateFactory.create(sparqlUpdateString);
        UpdateProcessor proc = UpdateExecutionFactory.create(request,
                graphStore);
        proc.execute();
    }

    private void updateTriple(String sparqlUpdateString) {

        dataset.begin(ReadWrite.WRITE);
        try {
            GraphStore graphStore = GraphStoreFactory.create(dataset);
            execUpdate(sparqlUpdateString, graphStore);
            dataset.commit();

        } finally {
            dataset.end();
        }
    }

    private void createActionInstance() {

        String subject = new StringBuffer("myprefix:").append("LS_1_user")
                .toString();
        String predicate = "rdf:type";
        String object = "myprefix:Action";

        String insertString = createInsertString(subject, predicate, object);
        String sparqlInsertString = createSparqlString(insertString);
        updateTriple(sparqlInsertString);
    }

    private void createStateInstance() {

        String subject = new StringBuffer("myprefix:").append("LS_1_user_LicState")
                .toString();
        String predicate = "rdf:type";
        String object = "myprefix:State";

        String insertString = createInsertString(subject, predicate, object);
        String sparqlInsertString = createSparqlString(insertString);
        updateTriple(sparqlInsertString);
    }

    private String createInsertString(String subject, String predicate,
            String object) {
        String insertString = new StringBuffer("INSERT DATA { ")
                .append(subject).append(" ").append(predicate).append(" ")
                .append(object).append(" }").toString();

        return insertString;
    }

    private String createSparqlString(String str) {
        String sparqlString = StrUtils.strjoinNL(UpdateTDB2.XSDPrefix,
                UpdateTDB2.RDFPrefix, UpdateTDB2.MYPrefix, str);

        System.out.println(sparqlString);
        return sparqlString;
    }

} 
```

## 查询代码

```
public class QueryTDB3 {

    public static void main(String[] args) {
        String directory = "C://myTDB//" ;
        Dataset dataset = TDBFactory.createDataset(directory) ;

        dataset.begin(ReadWrite.READ) ;
        try
        {
            // Do some queries
            String sparqlQueryString1 = "SELECT (count(*) AS ?count) { ?s ?p ?o }" ;

            String sparqlQueryString2 = "SELECT * { ?s ?p ?o }" ;
            execQuery(sparqlQueryString2, dataset) ;
            execQuery(sparqlQueryString1, dataset) ;
        } finally
        {
            dataset.end() ;
        }
    }

    public static void execQuery(String sparqlQueryString, Dataset dataset)
    {
        Query query = QueryFactory.create(sparqlQueryString) ;
        QueryExecution qexec = QueryExecutionFactory.create(query, dataset) ;
        try {
            ResultSet results = qexec.execSelect() ;

            ResultSetFormatter.out(results) ;

          } finally { qexec.close() ; }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T12:50:10.090

您正在运行哪个版本的代码？

如果您显示的代码（第一部分）确实在两个单独的运行中运行（因此有两个 JVM），那么这可能是由于 TDB 中的一个已知且已修复的错误。它仅存在于相对较新的版本中。

请尝试 Jena 2.7.4-SNAPSHOT 的开发版本。

# php - 使用 php 在状态更新中标记朋友

> ID：12715175
> 
> 赞同：1
> 
> 时间：2012-10-03T19:08:46.257
> 
> 标签：php, facebook, json, facebook-graph-api

如果您在 Facebook 上发布状态更新或分享链接，则可以选择将您的朋友标记为“与您同在”。这与使用 @ 符号标记它们不同。

这是一个例子： http: [//www.facebook.com/karin.ohara.98/posts/111246132363889](http://www.facebook.com/karin.ohara.98/posts/111246132363889)

它显示了与艾莉森·弗雷泽在一起的人

我正在尝试自己在 php 中编写代码。它适用于正常状态更新。首先我得到朋友列表，然后尝试添加一个'with'参数。使用 chrome web 开发者工具并没有提供太多关于 facebook 如何做到这一点的信息。不工作

```
shuffle($friends);

        $with = array();

        for($i = 0; $i < 2; $i++)
        {
            if($i < count($friends))
                array_push($with, array("tag_uid" => $friends[$i]));
        }

        $fields = array('name'          => $status['title'],
                        'message'       => $status['message'],
                        'caption'       => $status['caption'],
                        'with' => json_encode($with)),
                        'description'   => $status['desc'],
                        'link'          => $url,
                        'picture'       => $status['img']);

        $result = HTTP_POST("https://graph.facebook.com/" . $account->id . "/feed?access_token=$access_token",  // full URL to query 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T09:08:40.547

> 首先我得到朋友列表，然后尝试添加一个'with'参数。

*创建*帖子*时*没有“with”参数。

 *要将用户标记为与海报同在，您必须使用该`tags`参数——正如此处*明确*描述的那样，[https://developers.facebook.com/docs/reference/api/user/#posts](https://developers.facebook.com/docs/reference/api/user/#posts)

请注意，您还必须指定一个工作地点。*

# android - 流式传输 Android 屏幕

> ID：12715176
> 
> 赞同：0
> 
> 时间：2012-10-03T19:08:47.823
> 
> 标签：android, streaming, screenshot

我目前正在开发一个应用程序，其最终目标是大致类似于适用于 iDevices 的 Android 版本的 Air Play。

流媒体和所有这些都很容易，但我也希望能够包括游戏。这样做的问题是我必须流式传输屏幕。

我已经查看了有关截屏的各种事情（尤其是[这个问题](https://stackoverflow.com/questions/3067586/how-to-capture-the-android-device-screen-content)及其衍生问题），但我担心频率/延迟。玩游戏时，任何低于 15-20 fps 的速度根本不会降低它，而且我不确定到目前为止我所看到的方法是否可行。

有谁知道这样的事情是否合理，如果可以，会采取什么措施？

编辑：为了更清楚，我基本上是在尝试为 Android 创建一种更有限的“远程桌面”形式。本质上，捕获设备当前正在执行的操作（电影、游戏等）并将其复制到另一台设备上。

我最初的想法是简单地抓取音频缓冲区和帧缓冲区并将它们通过套接字传递到另一个设备，但我担心我所看到的用于捕获帧缓冲区的方法对于预期用途来说太慢了。我看到人们在一些更常见的访问帧缓冲区的方法上发表了 3 FPS 限制的评论以及诸如此类的评论。

我正在寻找的是一种在没有这些限制的情况下获取缓冲区的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:38:52.010

当您提到“流式传输”视频游戏时，我不确定您要完成什么。

但如果你想模仿 AirPlay，你需要做的就是通过蓝牙/互联网连接到设备并允许声音。然后保存结果或进行相应处理。

但是视频游戏不会“流式传输”屏幕，因为移动设备无法处理大量工作负载。还有其他问题，例如，如果该人在玩游戏时失去互联网连接，您将如何处理游戏？最重要的是，这将需要大量服务器来支持后端和带宽上的游戏工作负载。

但是，如果您正在尝试创建在线游戏。基本上，您需要做的就是从服务器发送和接收消息。这很简单。如果您想“串流”到另一台设备，只需将移动设备连接到扬声器或电视。几乎所有的移动视频游戏或应用程序都只是通过 JSON 或类似的方式发送简单的消息。这减少了开销，语法简单，并且可以跨多个平台使用。

听起来你应该看看这个（转发）： [https ://stackoverflow.com/questions/2885533/where-to-start-game-programming-for-android](https://stackoverflow.com/questions/2885533/where-to-start-game-programming-for-android)

如果不是，这更像是一个关于如何实现视频游戏的开放性问题。

# javascript - 为什么从 textarea 复制到 div 并返回不保存状态？

> ID：12715188
> 
> 赞同：0
> 
> 时间：2012-10-03T19:09:06.033
> 
> 标签：javascript, formatting

当我将代码从 textarea 复制到 div 然后返回时，内容不再相同。

```
<!doctype html>
<html>
<head>
</head>
<body>
<textarea id="ta" rows="10" cols="120"><p> "Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation <ul><li>sfsD</li><li>sf234fw</li></ul> ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum." </p></textarea>
<br>
<button>Button</button>
<div id="container"></div>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script type="text/javascript">
        $('button').click(function(){
            $('#container').html($('#ta').val());
            $('#ta').val($('#container').html());
        });
    </script>
</body>
</html> 
```

因此，当我将文本从 textarea 复制到 div 时，一切都很好。但是当我从 div 复制回 textarea 时，现在的值是

```
<p> "Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. 
Ut enim ad minim veniam, quis nostrud exercitation </p>
<ul><li>sfsD</li><li>sf234fw</li></ul> ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in 
reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, 
sunt in culpa qui officia deserunt mollit anim id est laborum." <p></p> 
```

我不确定为什么会发生这种情况或如何解决？！有任何想法吗？这发生在 FF 和 chrome 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:13:14.367

利用`$('#ta').val($('#container').text());`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:13:59.447

我可以看到的不同之处在于您非法放置标记，`ULs`不允许在`P`标签内...基本上有问题的两个浏览器都会破坏`P`它们找到其他块级元素的位置 - 它们基本上是为您自动更正您的标记.

如果您要复制他们返回给您的标记作为您放置在 textarea 中的标记，那么下次您测试按钮时不会有任何更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T19:14:22.257

`val()`返回值（这可能意味着许多不同的东西，具体取决于元素是什么），同时`html()`返回标记。

您不能混合和匹配这两个调用并期望您的输入与您的输出匹配 - 选择一个或另一个来满足您的需求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T19:10:43.620

因为`html()`返回标记。也许你需要`[text()](http://api.jquery.com/text/)`.

# objective-c - 分组 NSOperation 在同一个对象上工作并检测它们何时在 iOS 中完成

> ID：12715191
> 
> 赞同：1
> 
> 时间：2012-10-03T19:09:27.910
> 
> 标签：objective-c, multithreading, nsblockoperation

我有一个 iOS 应用程序，其中 5 个 NSBlockOperation 每个生成一个 NSArray 对象，并将其添加到一个共享的同步 NSMutableArray 中，该 NSMutableArray 用作 UITableView 数据源。

该操作彼此独立，一旦完成，我需要启动 UITableView 数据重新加载。

不幸的是，我找不到使用 NSOperation 的方法。我需要使用另一个多线程设计吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:16:32.173

将您的重新加载数据调用添加到另一个 NSOperation，它具有`addDependency:`其他五个操作作为其依赖项（请参阅 参考资料）。然后在其他完成之前不会执行它。

请务必将您的 UI 调用包装在一个 GCD 调度中到主线程。

从 NSOperation 参考：

> 依赖项是一种按特定顺序执行操作的便捷方式。您可以使用 addDependency: 和 removeDependency: 方法为操作添加和删除依赖项。默认情况下，具有依赖关系的操作对象在其所有依赖的操作对象都完成执行之前不会被视为就绪。然而，一旦最后一个依赖操作完成，操作对象就准备好并能够执行。

# apache - 如何使用 Apache 将子域转发到同一 IP 地址上的新端口？

> ID：12715195
> 
> 赞同：16
> 
> 时间：2012-10-03T19:09:48.817
> 
> 标签：apache, dns, web, subdomain, portforwarding

我有一个 NAS/服务器 24/7 在家里运行，并在其上运行许多不同的服务。我现在有一个指向它的域名，并且想知道是否可以创建指向不同服务的不同端口的子域。例如：

*   [http://subsonic.mydomain.com](http://subsonic.mydomain.com) --> XXX.XXX.XXX.XXX:4040
*   [http://minecraft.mydomain.com](http://minecraft.mydomain.com) --> XXX.XXX.XXX.XXX:25565
*   [http://files.mydomain.com](http://files.mydomain.com) --> XXX.XXX.XXX.XXX:4082

我有一个单一的 D-LINK 路由器，当前端口将所有这些端口转发到我的 IP 为 192.168.0.104 的 NAS/服务器。

编辑：服务器正在运行 Ubuntu 12.04。

我需要运行什么服务或代理才能识别子域并相应地路由流量？或者我可以使用 apache 虚拟主机来处理这个问题，因为这些子域将进入端口 80，而 apache 正在监听哪个端口？或者虚拟主机不是这样工作的？

任何信息、想法或提示都会有所帮助/有用。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-04T17:55:24.190

有两种方法可以做到这一点。您可以使用您的 VirtualHost 部分，`httpd.conf`也可以在`.htaccess`. （假设子域解析为与您的网络服务器相同的 IP）

在`httpd.conf`：

```
<VirtualHost *:80>
    ServerName subsonic.mydomain.com
    redirect / http://mydomain.com:4040/
</VirtualHost> 
```

在`.htaccess`：

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^subsonic\.mydomain\.com$ [NC]
RewriteRule ^(.*)$ http://mydomain.com:4040/$1 [R=301] 
```

文档：
-[创建基于名称的虚拟主机的指南](http://httpd.apache.org/docs/current/vhosts/name-based.html)
-[核心](http://httpd.apache.org/docs/current/mod/core.html)，包括[VirtualHost](http://httpd.apache.org/docs/current/mod/core.html#virtualhost)和[NameVirtualHost](http://httpd.apache.org/docs/current/mod/core.html#namevirtualhost)
-[重定向](http://httpd.apache.org/docs/current/mod/mod_alias.html#redirect)
- [mod_rewrite 指南](http://www.workingwith.me.uk/articles/scripting/mod_rewrite)

# python - Python：AttributeError：'NoneType'对象没有属性'append'

> ID：12715198
> 
> 赞同：11
> 
> 时间：2012-10-03T19:09:57.070
> 
> 标签：python, list

我的程序看起来像

```
# global
item_to_bucket_list_map = {}

def fill_item_bucket_map(items, buckets):
    global item_to_bucket_list_map

    for i in range(1, items + 1):
        j = 1
        while i * j <= buckets:
            if j == 1:
                item_to_bucket_list_map[i] = [j]
            else:
                item_to_bucket_list_map[i] = (item_to_bucket_list_map.get(i)).append(j)
            j += 1
        print "Item=%s, bucket=%s" % (i, item_to_bucket_list_map.get(i))

if __name__ == "__main__":
    buckets = 100
    items = 100
    fill_item_bucket_map(items, buckets) 
```

当我运行它时，它会抛出我

`AttributeError: 'NoneType' object has no attribute 'append'`

不知道为什么会发生这种情况？当我已经在每个开始时创建一个列表时`j`

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-10-03T19:11:43.223

实际上您存储`None`在这里： `append()`更改列表并返回`None`

```
 item_to_bucket_list_map[i] = (item_to_bucket_list_map.get(i)).append(j) 
```

例子：

```
In [42]: lis = [1,2,3]

In [43]: print lis.append(4)
None

In [44]: lis
Out[44]: [1, 2, 3, 4] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:15:25.300

```
[...]
for i in range(1, items + 1):
    j = 1
    while i * j <= buckets:
        if j == 1:
            mylist = []
        else:
            mylist = item_to_bucket_list_map.get(i)
        mylist.append(j)
        item_to_bucket_list_map[i] = mylist
        j += 1
    print "Item=%s, bucket=%s" % (i, item_to_bucket_list_map.get(i)) 
```

然而`while`，循环可以简化为

```
 for j in range(1, buckets / i + 1): # + 1 due to the <=
        if j == 1:
            mylist = []
        else:
            mylist = item_to_bucket_list_map.get(i)
        mylist.append(j)
        item_to_bucket_list_map[i] = mylist 
```

# windows - 使用 DOS 替换文件的特定行

> ID：12715201
> 
> 赞同：1
> 
> 时间：2012-10-03T19:10:08.143
> 
> 标签：windows, batch-file, cmd, dos

我有一个 XML 文件，我需要使用 DOS 命令将第 7 行替换为我自己的行。这该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T18:53:21.087

我的建议是基于您通过编号而不是内容来识别行的事实

```
@echo OFF
REM Say LINE 7 to be removed
SETLOCAL ENABLEDELAYEDEXPANSION
SET LOWER=6
SET UPPER=8
SET INDEX=0
SET MYLINE="this is my new line"
SET OUTFILE=%~n1.new%~x1
>%OUTFILE% (
    for /F "tokens=*" %%L in (%1) do (SET /A INDEX += 1
        IF !INDEX! LEQ %LOWER% (echo %%L) ELSE break
    )
    echo %MYLINE%
    more +%UPPER% %1
) 
```

*   需要回显，因为我们进行了大规模重定向
*   循环中的计数器需要 ENABLEDELAYEDEXPANSION
*   您只需将 xml 文件作为参数传递给脚本。

高温高压

# javascript - 在 javascript 认为文档“准备好”之前，如何让我的 jasmine 测试装置加载？

> ID：12715207
> 
> 赞同：15
> 
> 时间：2012-10-03T19:10:20.717
> 
> 标签：javascript, jquery, ruby-on-rails, tdd, jasmine

我相当确定问题在于设置为在 $(document).ready 上运行的 jquery 绑定没有可用的夹具 html。因此，当我发生旨在通过 jquery 函数更改 DOM 的事件时，什么也没有发生，我的测试也失败了。[我在这里](https://stackoverflow.com/questions/11191966/jquery-triggerclick-not-working-with-jasmine-jquery)看到了这个问题的“解决方案”，但是对我有用的解决方案需要更改我的工作 jquery 函数以与 .live 方法而不是 .click 方法绑定。我对此有两个问题。首先，我不想更改我的工作代码，以便测试能够正确通过。测试框架应该测试代码是否可以在应用程序中工作，其中 DOM 加载和 javascript 绑定以正确的顺序发生。我对解决方案的第二个问题是 .on 和 .delegate 由于某种原因都不起作用，最终起作用的唯一方法是使用当前正在弃用的 .live 方法。总之，我想弄清楚如何更改我的测试或测试框架本身，以便在 $(document).ready 中运行的函数之前加载固定装置。

我正在使用rails 3.2.8，并且设置了两个不同的分支来进行茉莉花测试。其中一个分支使用 jasminerice gem，另一个使用 jasmine-rails gem。Javascript 和 jQuery（使用 .live 方法时）测试在这两种设置中都正确通过。

这是使用茉莉花的分支的描述：

以下是我的 Gemfile.lock 文件中描述 jasmine 和 jQuery 设置的行：

```
jasminerice (0.0.9)
  coffee-rails
  haml
jquery-rails (2.1.3)
  railties (>= 3.1.0, < 5.0)
  thor (~> 0.14) 
```

Jasminerice 默认包含[jasmine-jquery](https://github.com/velesin/jasmine-jquery)扩展。jasmine-jQuery 扩展提供了我在测试中使用的 toHaveText 方法。

直接位于 spec/javascripts 目录中的测试文件 jasmine_jquery_test.js 包含以下内容：

```
#= require application

describe ("my basic jasmine jquery test", function(){

    beforeEach(function(){
        $('<a id="test_link" href="somewhere.html">My test link</a>').appendTo('body');
    });

    afterEach(function(){
        $('a#test_link').remove();
    });

    it ("does some basic jQuery thing", function () {
        $('a#test_link').click();
        expect($("a#test_link")).toHaveText('My test link is now longer');
    });

    it ("does some the same basic jQuery thing with a different trigger type", function () {
        $('a#test_link').trigger('click');
        expect($("a#test_link")).toHaveText('My test link is now longer');
    });

});
describe ('subtraction', function(){

    var a = 1;
    var b = 2;

    it("returns the correct answer", function(){
        expect(subtraction(a,b)).toBe(-1);
    });

}); 
```

我位于 app/assets/javascripts 目录中的 javascript 文件 tests.js 包含以下内容：

```
function subtraction(a,b){
    return a - b;
}

jQuery (function($) {
/* 
    The function I would rather use - 
    $("a#test_link").click(changeTheTextOfTheLink)
    function changeTheTextOfTheLink(e) {
        e.preventDefault()
        $("a#test_link").append(' is now longer');
    }
*/

    $("a#test_link").live('click', function(e) {
        e.preventDefault();
        $("a#test_link").append(' is now longer');
    });

}); 
```

我位于同一 app/assets/javascripts 目录中的 application.js 文件具有以下内容：

```
//= require jquery
//= require jquery_ujs
//= require bootstrap
//= require vendor
//= require_tree . 
```

jasmine-rails 分支的描述可以在我的[第一个 jasmine test 相关 stackoverflow question](https://stackoverflow.com/questions/12358051/why-is-the-jquery-code-not-executing-or-at-least-not-appearing-to-execute-in-m)的内容中找到。

因此，如果有人知道如何操作测试，以便在加载装置后运行 $(document).ready 函数，我非常想听听您的想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-10T00:49:55.970

将 jQuery 直接添加到 html 夹具对我来说可以获得所需的行为。这并不完全是这个问题的答案，但我开始相信它是目前可用的最佳解决方案。我在 jasmine-rails gem 设置中所做的更改，我还没有在 jasminerice 分支中尝试过。

这是我的测试文件：

```
describe ("my basic jasmine jquery test", function(){

    beforeEach(function(){
        loadFixtures('myfixture.html');
    });

    it ("does some basic jQuery thing", function () {
        $('a#test_link').click();
        expect($("a#test_link")).toHaveText('My test link is now longer');
    });

    it ("does the same basic jQuery thing with a different event initiation method", function () {
        $('a#test_link').trigger('click');
        expect($("a#test_link")).toHaveText('My test link is now longer');
    });

});
describe ('substraction', function(){

    var a = 1;
    var b = 2;

    it("returns the correct answer", function(){
        expect(substraction(a,b)).toBe(-1);
    });

}); 
```

这是我的夹具文件：

```
<a id="test_link" href="somewhere.html">My test link</a>

<script>
    $("a#test_link").click(changeTheTextOfTheLink)
    function changeTheTextOfTheLink(e) {
        e.preventDefault()
        $("a#test_link").append(' is now longer');
    }
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-06T03:40:07.973

就个人而言，我认为这是一个错误 jasmine-jquery。我通过使我的装置成为 SpecRunner.html 的一部分来“解决”这个问题。不理想，但它适用于简单的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-08T11:51:20.513

你试过 jasmine-jquery 吗？

[https://github.com/velesin/jasmine-jquery](https://github.com/velesin/jasmine-jquery)

从它的github页面，

> jasmine-jquery 为 Jasmine JavaScript 测试框架提供了两个扩展：
> 
> 一组用于 jQuery 框架的自定义匹配器 用于处理规范中的 HTML、CSS 和 JSON 固定装置的 API

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-19T08:41:08.420

我使用[dom_munger](https://github.com/cgross/grunt-dom-munger)为我自动生成夹具，因此在夹具中手动添加 jquery 代码对我来说不是一个选项。我一直在寻找相同的答案，而我现在能想到的最佳解决方案是在 jQuery 中使用事件委托。

例如，不要这样写：

```
$('#target').click(function(){
    // Do work
}); 
```

做这个：

```
$(document).on('click', '#target', function(){
    // Do work
}); 
```

通过这种方式，监听器被附加到文档，该文档在加载夹具之前存在。因此，当#target 上发生点击事件时，它会冒泡到文档中。文档检查源是否匹配第二个参数 - '#target'。如果匹配，将调用处理函数。

我知道这有一些限制，例如初始化插件，但它确实解决了部分问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-04-14T13:40:49.463

我对这里描述的方法采取了稍微不同的方法来解决这个限制。

免责声明：我为 Microsoft 工作，因此未经法律批准，我无法在此处发布我的实际源代码，因此我将仅描述一种行之有效的方法。

我没有尝试改变`document.ready`工作方式，而是修改了 jasmine-jquery 源以支持一个调用的函数，该函数`fixturesReady`需要一个回调。

本质上，这是在 IIFE 中定义的，并为每个事件名称私有地保存一组回调，这些回调在触发器上进行迭代。

然后在这个块上你可以放置触发器：

```
jasmine.Fixtures.prototype.load = function() {
  this.cleanUp()
  this.createContainer_(this.read.apply(this, arguments))

  fixturesReady.trigger("loaded", arguments); // <----- ADD THIS

} 
```

因此，现在在您的测试中，您可以针对以下代码进行编码：

```
fixturesReady(yourCallback) 
```

而且您知道当`yourCallback`被调用时，您可以安全地在 DOM 中查询您的夹具元素。

此外，如果您使用`async.beforeEach`jasmine 插件，您可以这样做：

```
async.beforeEach(function(done){

    fixturesReady(done);

    ...

    loadFixtures("....");

}); 
```

希望对您有所帮助，并为您提供解决此问题的一些想法。

注意：如果需要，请记住在您的插件中清除`afterEach`块中的任何回调:)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-04-25T13:11:58.143

自从提出这个问题（并接受了答案）以来已经有一段时间了。

这是一种更好的方法来构建测试并加载脚本以使用 jasmine 进行测试。

模板/link.tmpl.html

```
<a id="test_link" href="somewhere.html">My test link</a> 
```

js/test-link.js

```
$("a#test_link").click(changeTheTextOfTheLink)
function changeTheTextOfTheLink(e) {
    e.preventDefault()
    $("a#test_link").append(' is now longer');
} 
```

规格/链接-test.spec.js

```
describe ("my basic jasmine jquery test", function(){

    jasmine.getFixtures().fixturesPath = ''

    var loadScript = function(path) {
      appendSetFixtures('<script src="' + path + '"></script>');
    };

    beforeEach(function(){
        loadFixtures('templates/link.tmpl.html');
        loadScript('js/test-link.js');
    });

    it ("does some basic jQuery thing", function () {
        $('a#test_link').click();
        expect($("a#test_link")).toHaveText('My test link is now longer');
    });

    it ("does the same basic jQuery thing with a different event initiation method", function () {
        $('a#test_link').trigger('click');
        expect($("a#test_link")).toHaveText('My test link is now longer');
    });

}); 
```

规格赛跑者

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>Spec Runner</title>

  <link rel="stylesheet" type="text/css" href="lib/jasmine-2.0.3/jasmine.css">
  <script type="text/javascript" src="lib/jasmine-2.0.3/jasmine.js"></script>
  <script type="text/javascript" src="lib/jasmine-2.0.3/jasmine-html.js"></script>
  <script src="lib/jasmine-2.2/boot.js"></script>

  <script type="text/javascript" src="lib/jquery-2.1.3.min.js"></script>
  <script type="text/javascript" src="lib/jasmine-jquery.js"></script>

  <script type="text/javascript" src="specs/link-test.spec.js"></script>
</head>

<body>
</body>
</html> 
```

# c++ - 在 Ubuntu 中选择超时错误 - Opencv

> ID：12715209
> 
> 赞同：8
> 
> 时间：2012-10-03T19:10:35.633
> 
> 标签：c++, c, ubuntu, opencv, webcam

我正在尝试为我最后一年的项目设置 OpenCv，但遇到了一些问题。[按照本](http://karytech.blogspot.ie/2012/05/opencv-24-on-ubuntu-1204.html)教程，我成功地在 Ubuntu 中设置了它。

我现在遇到的问题是保持这个[示例](http://docs.opencv.org/doc/tutorials/objdetect/cascade_classifier/cascade_classifier.html)程序运行。该程序是使用网络摄像头进行人脸检测。

它运行良好 3 或 4 秒，然后捕获卡在窗口中的单个帧上。控制台显示以下输出。

```
tom@ubuntu:~/College/opencv/faceDetect_sample$ make
./faceDetect --cascade="haarcascade_frontalface_alt.xml" --nested-cascade="haarcascade_eye_tree_eyeglasses.xml"
VIDIOC_QUERYMENU: Invalid argument
VIDIOC_QUERYMENU: Invalid argument
VIDIOC_QUERYMENU: Invalid argument
init done 
opengl support available 
select timeout
select timeout
select timeout
select timeout
select timeout
select timeout
^Cmake: *** [run] Interrupt 
```

如果有人知道从这里去哪里，我真的很感激一些帮助！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-03T19:23:00.577

试试这个：

```
modprobe uvcvideo nodrop=1 timeout=6000 
```

如果可行，只需通过编辑 /etc/modprobe.d/modprobe.conf 使更改永久化

尝试将超时增加到一个非常大的数字。那应该可以解决问题，或者至少对我有用。只是对 select 的调用没有返回就绪描述符，这可能是由视频驱动程序或设备一引起的。

如果这不起作用，

启用模块跟踪：

```
sudo echo 0xffff > /sys/module/uvcvideo/parameters/trace 
```

运行程序直到发现错误，并尽快停止。然后禁用跟踪：

```
sudo echo 0 > /sys/module/uvcvideo/parameters/trace 
```

搜索`dmesg`错误消息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-08T16:10:45.007

如果我们在代码中添加以下几行，就可以解决它：

```
VideoCapture capture(<device id>);
capture.set(CV_CAP_PROP_FRAME_WIDTH , 352);
capture.set(CV_CAP_PROP_FRAME_HEIGHT , 288); 
```

以下是一个很好的链接，详细解释了解决方案：http: [//derekmolloy.ie/beaglebone/beaglebone-video-capture-and-image-processing-on-embedded-linux-using-opencv/](http://derekmolloy.ie/beaglebone/beaglebone-video-capture-and-image-processing-on-embedded-linux-using-opencv/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-05-27T09:09:10.723

我的罗技 C920 也有同样的问题。我尝试了以下解决方案但没有成功。但是，它与 C930e 网络摄像头一起工作就像一个魅力，所以我猜 V4L API 与它有关。

# asp.net - 使面板可见时转到页面顶部

> ID：12715213
> 
> 赞同：0
> 
> 时间：2012-10-03T19:10:54.800
> 
> 标签：asp.net, panel

我正在设置一个简单的 2 面板表单。我在我的 aspx 页面上创建了这个按钮：

```
<asp:Button runat='server' ID='NextButton' Text='Half Way There Proceed' OnClick='StepTwoPanel_Click' /> 
```

然后这是在我的 aspx.cs 文件中：

```
protected void StepTwoPanel_Click(object sender, EventArgs e)
{

 StepOnePanel.Visible = false;

 StepTwoPanel.Visible = true;
} 
```

当我使用它时，它可以完美地从面板一转到面板二。只有一个小问题。他们没有将用户带到第二个面板的顶部，而是在面板的底部附近，正是他们在单击第一个面板中的按钮时在页面上的位置。

我的问题是，当按钮单击使第二个面板可见时，它如何也将页面引导回顶部？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:51:51.580

使 MaintainScrollPositionOnPostBack = false; 当 MaintainScrollPositionOnPostback 属性设置为 true 时，用户将返回到页面上的最后一个位置。 [http://www.c-sharpcorner.com/UploadFile/yogesh12/PostBack12292006050702AM/PostBack.aspx](http://www.c-sharpcorner.com/UploadFile/yogesh12/PostBack12292006050702AM/PostBack.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:39:47.400

您能否使用 Javascript 滚动到您想要的位置？

*你的按钮：*

```
<asp:Button runat='server' OnClientClick="ScrollTheThing" ID='NextButton' Text='Half Way There Proceed' OnClick='StepTwoPanel_Click' /> 
```

*它的 Javascript 处理程序：*

```
function ScrollTheThing()  {

    // Code to scroll where you need

} 
```

对于究竟如何执行滚动，这些可能会给出一些想法： [http ://www.mediacollege.com/internet/javascript/page/scroll.html](http://www.mediacollege.com/internet/javascript/page/scroll.html)

[http://www.west-wind.com/weblog/posts/2006/Feb/24/Retrieving-Browser-Scroll-Position-in-JavaScript](http://www.west-wind.com/weblog/posts/2006/Feb/24/Retrieving-Browser-Scroll-Position-in-JavaScript)

# iphone - 使用故事板视图或单独的 nib 在 iOS 中自定义弹出窗口

> ID：12715214
> 
> 赞同：3
> 
> 时间：2012-10-03T19:10:56.537
> 
> 标签：iphone, objective-c, ios, popup, storyboard

在 iOS 中显示弹出窗口的最正确/最有效/最新的方式是什么？

A la TweetBot：

![在此处输入图像描述](../Images/5e03a72ca43c66ae461241c7eebd243d.png)

**我用过的方法：**

*   从单独的 nib 显示一个弹出窗口并使用 loadNibNamed

*   从主情节提要弹出一个带有 instantiateViewControllerWithIdentifier 的弹出窗口

*   纯粹以编程方式创建/呈现弹出窗口*

*我宁愿不使用这种方法，因为我的弹出窗口有一个相当复杂的自定义 UI

此外，一旦我从上述任何方法加载场景，我不知道如何将弹出窗口中的 UI 元素与插座/操作（协议？代表？）

如果您能指出我正确的方向，以最正确的方式创建/显示/使用弹出窗口，那就太棒了。

让我知道如果我太模糊，我可以添加更多细节。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:21:19.267

**编辑**：

嗯，输入我的答案后才看到你的截图。要做到这一点，您可以使用 UIAlertView 提供的功能。我很确定 TweetBot 的人也是这样做的。此处的此[链接显示了一篇博客文章](http://mobile.tutsplus.com/tutorials/iphone/ios-5-sdk-uialertview-text-input-and-validation/)，可让您做您需要的事情。

除非你想疯狂定制，否则有几个解决方案可以让你完成它。[像这样](http://maniacdev.com/2012/04/open-source-completely-customizable-iphone-uialertview-replacement-control/)的东西

**完成编辑**

您可以使用的一件事是 Segue。假设您正在使用 StoryBoard，并且当您点击一个按钮并带来一个弹出视图时，您可以通过以下方式将它们连接起来：

```
-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender{
    if([[segue identifier] isEqualToString:@"ViewToBringIn"]) {
        ViewController *vc = [segue destinationViewController];
        vc.navigationItem.title = @"some title";
    }
} 
```

使用 Segues 的另一种方法是通过 StoryBoard UI。单击您想要的视图，这将在 Connection Inspector 中显示类似于屏幕截图的内容：

![Segues 连接检查器](../Images/f4961143286b6d6d5565790d79f3f529.png)

但是，如果您使用的是 nib 文件，那么您仍然可以通过代码创建它们并将它们推送到视图中（根据您想要的格式）。当然，视图的设计是通过 Interface Builder 完成的。

# eclipse - Eclipse：MarketplaceDiscoveryStrategy 失败并出现错误

> ID：12715215
> 
> 赞同：12
> 
> 时间：2012-10-03T19:11:01.473
> 
> 标签：eclipse, eclipse-marketplace

我刚刚在我的 Windows 7 64 位机器上安装了 Eclipse Helios 3.6.1 版。但是，当我想打开 Eclipse MarketPlace 时，我收到了这个错误：

MarketplaceDiscoveryStrategy 因错误而失败。

```
Unable to read repository at 
http://marketplace.eclipse.org/api/p?product=org.eclipse.epp.package.jee.product&os=win32&runtime.version=3.6.0.v20100505&client=org.eclipse.epp.mpc.core&java.version=1.7.0_07&product.version=1.3.2.20110218-0812&ws=win32\. 
Address family not supported by protocol family: connect 
```

请问有什么解决办法吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2014-08-21T05:19:06.237

您可以像这样解决您的问题，在 Eclipse IDE 中转到 Windows --> 首选项 --> 常规 --> 网络连接 --> 选择 Active provider to Direct --> 应用 --> 确定。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2021-03-12T15:28:25.500

我遇到了同样的问题，解决方法是从我的 JRE 复制我的 ...security/cacert 然后将其粘贴到我的 eclipse .....\eclipse\plugins\org.eclipse.justj.openjdk.hotspot.jre.full .win32.x86_64_15.0.1.v20201027-0507\jre\lib\security（将eclipse的cacert替换为JRE的cacert）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-09-04T15:42:36.700

验证您是否可以通过命令行访问该 URL。
如果您使用 VPN 连接，请断开 VPN 并重试。这个对我有用。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-10-26T01:00:59.380

我可以解决这个问题的唯一方法是将证书导入“cacerts”

以下是要遵循的步骤：

*   通过使用详细信息按钮复制 Eclipse 无法访问的链接，然后将其粘贴到谷歌浏览器并按 Enter。

在我的情况下，链接是： [https ://marketplace.eclipse.org/api/p?client=org.eclipse.epp.mpc.core&os=win32&platform.version=4.21](https://marketplace.eclipse.org/api/p?client=org.eclipse.epp.mpc.core&os=win32&platform.version=4.21)

*   就在浏览器中的链接旁边有一个锁定图标，将鼠标悬停在它上面，应该会显示“查看站点信息”

*   单击锁定图标->单击“连接安全”->单击“证书有效”，应弹出一个名为“证书”的对话框。

*   转到“详细信息”选项卡，然后单击“复制到文件...”按钮

*   按照导出向导步骤导出证书文件 (.CER) 以“DER 编码二进制 X.509 (.CER)”格式导出文件

*   将文件保存到名为“marketplacecert.cer”的桌面

*   现在将此证书文件复制到 eclipse 文件夹安装中 jre 所在的文件夹

    就我而言： C:\eclipse-cpp-2021-09-R-win32-x86_64\eclipse\plugins\org.eclipse.justj.openjdk.hotspot.jre.full.win32.x86_64_16.0.2.v20210721-1149\jre \lib\安全

    在此文件夹中，您应该找到一个名为“cacerts”的文件，我们将在其中通过“keytool.exe”导入证书

*   现在打开 CMD 提示符并转到文件夹：cd C:\eclipse-cpp-2021-09-R-win32-x86_64\eclipse\plugins\org.eclipse.justj.openjdk.hotspot.jre.full.win32.x86_64_16。 0.2.v20210721-1149\jre\lib\security

*   我们将不得不使用一个名为“keytool.exe”的工具来导入证书文件，该文件位于：“C:\eclipse-cpp-2021-09-R-win32-x86_64\eclipse\plugins\org.eclipse。 justj.openjdk.hotspot.jre.full.win32.x86_64_16.0.2.v20210721-1149\jre\bin" 从我们当前位置向上两个文件夹，要执行它，我们将使用相对路径 ....\bin\keytool。可执行程序

    在 CMD 提示符下运行以下命令： ....\bin\keytool.exe -import -alias alias -keystore cacerts -file marketplacecert.cer

    keytool.exe 将要求输入密码，即“changeit”

    keytool.exe 将要求信任证书，键入“yes”并按 Enter。

    完毕。现在重新启动 eclipse 和市场应该工作。

    有关更多详细信息，请参阅此链接： [https ://thebasictechinfo.com/java-8/pkixunable-to-find-valid-certification-path-to-requested-target-fix/](https://thebasictechinfo.com/java-8/pkixunable-to-find-valid-certification-path-to-requested-target-fix/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-24T08:58:25.123

这是因为您的电脑无法连接到[http://marketplace.eclipse.org/api/p?product=org.eclipse.epp.package.jee.product&os=win32&runtime.version=3.6.0.v20100505&client=org .eclipse.epp.mpc.core&java.version=1.7.0_07&product.version=1.3.2.20110218-0812&ws=win32](http://marketplace.eclipse.org/api/p?product=org.eclipse.epp.package.jee.product&os=win32&runtime.version=3.6.0.v20100505&client=org.eclipse.epp.mpc.core&java.version=1.7.0_07&product.version=1.3.2.20110218-0812&ws=win32)

您可以在 Windows--> Preferece --> 网络连接上设置网络代理。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-10-02T13:56:33.023

我有同样的问题，当您下载**Eclipse Standard 4.3.1**时会发生。您必须**为 Java EE Developers 下载 Eclipse IDE**。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-07-02T10:34:19.207

添加以下参数：

> -Djava.net.preferIPv4Stack=true

到 eclipse.ini 文件的末尾，它应该可以工作。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-01-24T18:39:36.680

卸载当前版本的 Java。去www.java.com，下载推荐的java版本。安装成功后。验证已安装 java（位于主页 - www.java.com）。那么应该工作......我的工作。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-09-16T08:48:41.117

**是的，我确实遇到了同样的问题。这是修复**

**问题**：

```
eclipse.buildId=4.21.0.I20210906-0500
    java.version=16.0.2
    java.vendor=Oracle Corporation
    BootLoader constants: OS=win32, ARCH=x86_64, WS=win32, NL=en_US
    Command-line arguments: -os win32 -ws win32 -arch x86_64 -product 
    org.eclipse.epp.package.jee.product
    org.eclipse.epp.mpc.core
**Error**
Thu Sep 16 13:07:14 IST 2021
Cannot complete request to https://marketplace.eclipse.org/api/p?client=org.eclipse.epp.mpc.core&os=win32&platform.version=4.21: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
org.eclipse.core.runtime.CoreException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target
at org.eclipse.epp.internal.mpc.core.transport.httpclient.HttpClientTransport.stream(HttpClientTransport.java:117) 
```

**解决方案：**

```
In order to resolve this issue, I copied my security/cacert file from my JRE (java-se-8u41/jre/lib/security/cacert) to my eclipse (/eclipse/../jre/lib/security/cacert) e.g. /eclipse/plugins/org.eclipse.justj.openjdk.hotspot.jre.full.win32.x86_64_16.0.2.v20210721-1149/jre/lib/security/cacert 
```

**参考：** 有关更多详细信息和分步指南以及屏幕截图，您可以参考以下网址：[https ://thebasictechinfo.com/java-8/pkixunable-to-find-valid-certification-path-to-requested -目标修复/](https://thebasictechinfo.com/java-8/pkixunable-to-find-valid-certification-path-to-requested-target-fix/)

享受

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-05-19T15:05:47.850

如果您在一个组织中，请尝试询问您的同事开发人员，该开发人员有一个活跃的市场来获取 casert.cer 文件并将其替换到您的 jdk

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2020-06-16T12:06:38.947

我们只是遇到了同样的问题，显然今天的答案就是等待它。这适用于在现代 2020.03 版本的 Eclipse 中遇到此问题的任何人。它是 Eclipse 服务器的问题，有时无法访问。等一小时左右再试一次..它应该可以工作，只要它之前工作过..

# java - SimpleDateFormat 忽略 Android 中的 DST 偏移量

> ID：12715216
> 
> 赞同：1
> 
> 时间：2012-10-03T19:11:04.057
> 
> 标签：java, android, time, timezone

在中欧，当前时区（截至 10 月 3 日）是：

CEST / UTC+2

`SimpleDateFormat`但是当我现在在Android中创建一个实例时......

```
dateTimeFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSZ"); 
```

...它`CET / UTC+1`作为时区返回。所以它忽略了此时必须仍然存在的 DST 偏移量。为什么是这样？

此外，当使用实例的（现已弃用）方法`getTimezoneOffset()`时`Date`，它会返回不一致的结果：

`(new Date()).getTimezoneOffset()`正确返回 -120（2 小时），同时`dateTimeFormat.parse("2012-10-03T22:00:00.000+0000").getTimezoneOffset()`返回 -60（1 小时）。

这怎么可能发生？我做错了什么还是这是一个已知的错误？

**注意：**我听说有些库可以提供更好的时间计算（例如 Joda Time），我现在经常听到 ;) 但是使用一些变通方法，您可以轻松地使用内置的 Java 时间库.

而且，当然，时区在我的机器上设置正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-09T09:03:35.157

我刚刚切换到 JODA，非常棒。

它在 Android 上也可以很好地使用此链接中的评论： [Android Java - Joda Date is slow](https://stackoverflow.com/questions/5059663/android-java-joda-date-is-slow) That make it run faster.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-12T08:31:33.173

我不知道我是否正确理解了您的用例，但是根据我在尝试此代码时的理解。

```
public static void main(String[] args) {
        SimpleDateFormat dateTimeFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSSZ");
        String date="2012-10-03T22:00:00.000+0000";
        try {
            System.out.println(dateTimeFormat.getTimeZone().getDisplayName());
            System.out.println("Today : "+new Date().toString()+ ", Timezone Offset :" +
                    +(new Date()).getTimezoneOffset());
            System.out.println("Parsed Date : "+
                    dateTimeFormat.parse(date).toString()
                    + ", Timezone Offset : "
                    +dateTimeFormat.parse(date).getTimezoneOffset());           
        } catch (ParseException e) {            
            e.printStackTrace();
        }
    } 
```

我得到了一致的输出，即：

```
Central European Time
Today : Wed Oct 03 09:44:56 CEST 2012, Timezone Offset : -120
Parsed Date : Wed Oct 03 23:00:00 CEST 2012, Timezone Offset : -120 
```

# tsql - 从大表中选择使用 LIKE 时 SQL Server 2012 性能不佳

> ID：12715217
> 
> 赞同：2
> 
> 时间：2012-10-03T19:11:08.533
> 
> 标签：tsql, sql-server-2012, sqlperformance

我有一个大约 1M 行的表，并针对它运行以下 SQL：

```
select * from E where sys like '%,141,%' 
```

执行需要 2-5 秒（返回约 10 行），我需要它至少快 10 倍，这是 SQL Server 2012 可以实现的吗？

**示例`sys`值（`sys`值长度范围为 5 到 1000 个字符）：**

```
1,2,3,7,9,10,11,12,14,17,28,29,30,33,35,37,40,41,42,43,44,45,46,47,48,50,51,53,55,63,69,
72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,97,109,110,111,113,117,
119,121,122,123,124,130,131,132,133,134,135,139,141,146 
```

**表的 DDL：**

```
CREATE TABLE [dbo].[E](
    [o] [int] NOT NULL,
    [sys] [varchar](8000) NULL,
    [s] [varchar](8000) NULL,
    [eys] [varchar](8000) NULL,
    [e] [varchar](8000) NULL,
 CONSTRAINT [PK_E] PRIMARY KEY CLUSTERED 
(
    [o] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T19:16:12.943

您的`like`子句导致全表扫描。

如果您想要此查询的即时性能，您将需要一个包含以下字段的一对多表：

```
E_Key  <-- Foreign Key, points to primary key of E table
sys    <-- Each record contains one number, not multiple numbers 
           separated by commas 
```

然后，您可以索引`sys`，并使用普通的 WHERE 子句。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T19:23:17.190

如果您无法更改表架构，则可以启用[全文搜索](http://msdn.microsoft.com/en-us/library/ms142571.aspx)并在表上创建全文索引，然后执行以下操作：

```
select * from E where CONTAINS(sys, ",141,") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-25T23:12:59.030

I realize this is an older post but...

If you're absolutely hell bent on storing denormalized data in a table, convert it to XML so you can at least index it.

However, the best thing to do would be to normalize that data by splitting it out into a one to many lookup table (as robert Harvey suggested above).

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T19:19:25.397

LIKE 运算符总是会变慢，因为这会强制 SQL Server 扫描每一行以查找您要查找的数据。下面是 LIKE 的替代方法，它可能会更好一些（尽管仍会扫描数据）。

```
SELECT * FROM E WHERE CHARINDEX(',141,', sys) > 0 
```

# android - 设置内容视图（R.layout.Main）；Main 无法解析或不是字段

> ID：12715221
> 
> 赞同：4
> 
> 时间：2012-10-03T19:11:20.883
> 
> 标签：android, android-widget, javadoc

这是一个简单的程序开始（对你来说很简单，对我来说不是）eclipse。我想通过单击一个按钮来更改文本，但它不起作用。

这是代码：

```
package com.example.androidcourse;  

import android.app.Activity;  
import android.os.Bundle;  
import android.view.View;  
import android.view.View.OnClickListener;  
import android.widget.Button;  
import android.widget.TextView;  
import android.R.layout;  

public class MainActivity extends Activity {  

@Override 
public void onCreate(Bundle savedInstanceState) {  
super.onCreate(savedInstanceState);  
setContentView(R.layout.Main);  

Button btn = (Button) findViewById(R.id.but_action); 
final TextView text = (TextView) findViewById(R.id.txt_caption);  
btn.setOnClickListener(new OnClickListener() {  

@Override  
public void onClick(View v) {
text.setText("New bingo...");  
}  
});  
}  
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-04T12:08:55.543

首先构建您的项目。如果它不起作用，则从导入中删除 android.R.layout 并使用包中的布局。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-04T12:33:10.487

```
setContentView(R.layout.Main); 
```

你有名为 Main 的布局吗？据我所知，大写字母与布局名称不能很好地混合。如果你使用它，你会得到一些像这样的错误

> 基于文件的资源名称必须以小写字母开头。

请检查并重命名您的布局文件。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-05-21T14:37:50.190

首先检查布局 XML 的名称（`YourProject/res/layout/your_main.xml`项目文件夹的名称）。

代替：

```
setContentView(R.layout.**Main**); 
```

和：

```
setContentView(R.layout.**your_main**);   // 'your_main' Your layout xml file name. 
```

我的是**activity_main** .xml，我用“ **main** ”替换了它。

我只是一个初学者。我可能错了，但这解决了我的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-09-08T21:48:54.773

只需输入：import android.R.layout；这解决了我的问题，希望它也能解决你的问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2020-03-26T06:48:06.413

通过 alt+ Enter 在每个需要 import 的类上删除所有导入并重新生成，这对我有用。

# jquery - 带有动画功能的jQuery切换不透明度

> ID：12715223
> 
> 赞同：1
> 
> 时间：2012-10-03T19:11:27.530
> 
> 标签：jquery

我写了一个 jquery 函数，从那里我尝试用 animate 函数切换不透明度，但我的代码不起作用。谁能告诉我错在哪里。谢谢

```
 jQuery.fn.blindToggle = function (speed, easing, callback) {
            var _opacity = 0;
            var h = this.height() + parseInt(this.css('paddingTop')) + parseInt(this.css('paddingBottom'));
            $(this).toggle(function () {
                _opacity = 0;
            },
            function () {

                _opacity = 1;
            });
            alert(_opacity);
            return this.animate({ opacity: _opacity,
                marginTop: parseInt(this.css('marginTop')) < 0 ? 0 : -h
            }, speed, easing, callback);
        }; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T19:37:47.617

[jQuery`animate`](http://api.jquery.com/animate/)为您尝试做的事情提供了一个快捷方式：

```
$(this).animate({"opacity": "toggle"}); 
```

然后你就不需要自己实现那个逻辑了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:27:59.077

`toggle`仅适用于元素属性，不适用于 var 值。这种情况下您可以简单地执行以下操作。

`_opacity = _opacity == 0 ? 1 : 0;`

*演示*：

*   [使用切换](http://jsfiddle.net/hLdT5/1/)不起作用
*   [使用如果](http://jsfiddle.net/hLdT5/)有效
*   [使用 toggleClass](http://jsfiddle.net/hLdT5/2/)作品

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T20:04:11.673

jQuery有甜蜜的功能

```
.fadeToggle() 
```

[文档。](http://api.jquery.com/fadeToggle/)

# ruby-on-rails - Rails：指定了：url的表单不能用作部分？

> ID：12715228
> 
> 赞同：0
> 
> 时间：2012-10-03T19:11:49.907
> 
> 标签：ruby-on-rails

嗨，我正在尝试将表单用作我的`albums`控制器/模型的新/编辑视图的一部分。但是，当我尝试编辑专辑时，它给了我错误：

`No route matches [PUT] "/users/22/albums"`

我认为这可能与我的表单有关`:url`。当我提交它以创建相册时，我的表单工作正常，但当我尝试编辑它时出现该错误。

我尝试在我的表格中取出`url: user_albums_path`，但是当我尝试创建新专辑时它只会给我一个错误。

`No route matches [POST] "/albums"`

有什么方法可以使表单适用于两种操作？我觉得 :url 不能在这两种操作中正确共存。

_form.html.erb

```
<%= form_for (@album), url: user_albums_path, :html => { :id => "uploadform", :multipart => true } do |f| %>
<div class="formholder">
    <%= f.label :name %>
    <%= f.text_field :name %>

    <%= f.label :description %>
    <%= f.text_area :description %>

    <br>

    <%=f.submit %>
</div>
<% end %> 
```

专辑控制器

```
class AlbumsController < ApplicationController

def index
  @user = User.find(params[:user_id])
  @albums = @user.albums.all

  respond_to do |format|
    format.html
    format.json { render json: @albums }
  end
end

def show
  @user = User.find(params[:user_id])
  @album = @user.albums.find(params[:id])
end

def update
  @user = User.find(params[:user_id])
  @album = @user.albums.find(params[:id])
  respond_to do |format|
    if @album.update_attributes(params[:album])
      format.html { redirect_to user_album_path(@user, @album), notice: 'Album successfully updated' }
    else
      format.html { render 'edit' }
    end
  end
end

def edit
  @user = User.find(params[:user_id])
  @album = @user.albums.find(params[:id])
end

def create
  @user = User.find(params[:user_id])
  @album = @user.albums.build(params[:album])
  respond_to do |format|
    if @user.save
      format.html { redirect_to user_album_path(@user, @album), notice: 'Album was successfully created.' }
      format.json { render json: @album, status: :created, location: @album}
    else
      format.html { render action: "new" }
      format.json { render json: @album.errors, status: :unprocessable_entity }
    end
  end 
end

def new
  @user = User.find(params[:user_id])
  @album = Album.new
end

def destroy
end 
```

结尾

请帮忙！

更新：

解决它！靠我自己！表格只需要`<%= form_for([@user, @album])...`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:41:28.547

尝试

```
<%= form_for [@user, @album] %> 
# other arguments can be inserted before the closing brace 
```

该语法正确地限定了资源路由

`@album`如果需要，请记住要有一个实例变量。您可以使用`@user.album.build`

# windows - 操作系统什么时候清除进程的内存

> ID：12715229
> 
> 赞同：1
> 
> 时间：2012-10-03T19:11:55.843
> 
> 标签：windows, linux, memory, memory-management

进程在某些操作系统上成功或异常终止，操作系统何时决定清除分配给该进程的内存（数据、代码等）；在退出时或当它想为新进程分配内存时？

在所有操作系统（winXP、Win7、linux、Mac）上，这种清除内存分配的过程是否相同？

我了解，页表具有该进程的虚拟地址和内存中实际物理地址的映射。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T20:07:29.760

操作系统如何回收进程资源可能（并且通常会）因操作系统而异。在 Windows 方面，源自 NT 的操作系统的行为相似，因此 win XP 和 win7 之间应该没有什么区别。请注意，在这种情况下询问“记忆”过于简单，因为有不同类型的记忆。例如，典型的 Windows 应用程序将具有堆栈内存、堆内存（有时是多个堆）、指令/静态内存，也许还有共享内存。大部分内存由进程单独拥有，Windows 将在进程终止（甚至异常终止）时回收它。

然而，共享内存可以（并且经常）有多个所有者。它与一个[Windows 句柄](https://stackoverflow.com/questions/902967/what-is-a-windows-handle)（可能被多个进程引用的内核级对象）相关联。句柄有一个引用计数，如果引用计数变为零，相关的资源就会被回收。这意味着共享内存可以比引用它的进程寿命更长。此外，进程可能会“泄漏”句柄，并且该句柄永远不会被回收。确保此类句柄正确关闭且不泄漏是程序员的责任；异常终止的可能性使这一责任复杂化。

附带说明一下，当 Windows“回收”内存时，它只是意味着内存可用于将来分配给其他进程等。实际的 1 和 0 通常会一直放在那里，直到操作系统分配内存*和*新所有者内存的主动覆盖它。所以“回收”并不意味着内存立即清零或类似的东西；在这件事上擦洗内存效率低下，而且通常是不必要的。如果您出于安全考虑而询问，则不应依赖操作系统；在进程将内存释放回操作系统之前，您需要自己清理内存。

如果您想了解更多关于现代 Windows 操作系统如何处理内存的信息，并且不介意进行一些挖掘，MSDN 上的 Windows API 文档有很多关于该主题的信息，但它有点分散。开始的好地方可能是 Windows 句柄和加载/卸载库/进程调用。 [如果我没记错的话，Windows 应用程序编程 (Richter)](https://rads.stackoverflow.com/amzn/click/com/1572319968)可能有一些不错的信息，但我现在手头没有副本可供检查。

希望对 Linux 内部更了解的人可以解决这个问题。这是特定于操作系统的东西，因此可能存在差异。值得注意的是，NT 之前的 Windows（例如 Windows 95,98 等）具有完全不同的进程内存模型。这些差异往往使操作系统在异常终止的情况下更难回收内存；一些用户发现如果他们运行不稳定的应用程序需要经常重启操作系统，以清理累积的内存泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T04:48:35.690

在 Linux 中，资源通常在进程终止时被释放。您可以在此处阅读有关 Linux 如何处理进程终止的信息：http: [//www.informit.com/articles/article.aspx? p=370047&seqNum=4](http://www.informit.com/articles/article.aspx?p=370047&seqNum=4)

还有一个 OOM 杀手，它可以在内存极低的情况下启动，我知道在嵌入式 Android 世界中已经发生了一些事情，但我并没有真正掌握它 LWN.net 可能有一些报道。

# sql - 防止 GROUP BY 中的行重复计数

> ID：12715231
> 
> 赞同：7
> 
> 时间：2012-10-03T19:12:00.983
> 
> 标签：sql, postgresql, join, aggregate-functions

这是我的架构和问题的基本内容：[http ://sqlfiddle.com/#!1/72ec9/4/2](http://sqlfiddle.com/#!1/72ec9/4/2)

请注意，周期表可以引用可变的时间范围 - 它可能是整个赛季，可能是几场比赛或一场比赛。对于给定的团队和年份，所有期间行都代表唯一的时间范围。

我编写了一个查询，它连接表并使用 GROUP BY period.year 来汇总一个赛季的分数（参见 sqlfiddle）。但是，如果教练在同一年有两个职位，则 GROUP BY 将计算同一时期的行两次。当一名教练担任两个职位但仍然总结一年由多个时期组成的时期时，我该如何放弃重复？如果有更好的方法来执行架构，如果您向我指出，我也会很感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T19:19:17.137

此相关答案中解释了**潜在问题**（加入具有多个匹配项的多个表）：

*   [两个 SQL LEFT JOINS 产生不正确的结果](https://stackoverflow.com/questions/12464037/two-sql-left-joins-produce-incorrect-result/12464135#12464135)

为了解决这个问题，我首先**简化并格式化**了您的查询：

```
select pe.year
     , sum(pe.wins)       AS wins
     , sum(pe.losses)     AS losses
     , sum(pe.ties)       AS ties
     , array_agg(po.id)   AS position_id
     , array_agg(po.name) AS position_names
from   periods_positions_coaches_linking pp
join   positions po ON po.id = pp.position
join   periods   pe ON pe.id = pp.period
where  pp.coach = 1
group  by pe.year
order  by pe.year; 
```

产生与原始结果相同但*不正确*的结果，但更简单/更快/更易于阅读。

*   `coach`只要您不使用列表中的列，就没有必要加入表格`SELECT`。我将其完全删除并用 替换了`WHERE`条件`where pp.coach = 1`。

*   你不需要`COALESCE`。`NULL`聚合函数中的值被忽略`sum()`。无需替代`0`。

*   使用表别名使其更易于阅读。

接下来，我这样**解决**了你的问题：

```
SELECT *
FROM  (
   SELECT pe.year
        , array_agg(DISTINCT po.id)   AS position_id
        , array_agg(DISTINCT po.name) AS position_names
   FROM   periods_positions_coaches_linking pp
   JOIN   positions                         po ON po.id = pp.position
   JOIN   periods                           pe ON pe.id = pp.period
   WHERE  pp.coach = 1
   GROUP  BY pe.year
   ) po
LEFT   JOIN (
   SELECT pe.year
        , sum(pe.wins)   AS wins
        , sum(pe.losses) AS losses
        , sum(pe.ties)   AS ties
   FROM  (
      SELECT period
      FROM   periods_positions_coaches_linking
      WHERE  coach = 1
      GROUP  BY period
      ) pp
   JOIN   periods pe ON pe.id = pp.period
   GROUP  BY pe.year
   ) pe USING (year)
ORDER  BY year; 
```

*   在加入之前分别汇总职位和期间。

*   在*第一个子查询* `po`列表位置只有一次`array_agg(DISTINCT ...)`。

*   在*第二个子查询* `pe`...

    *   `GROUP BY period`，因为教练每个时期可以有多个职位。
    *   `JOIN`*之后*的周期数据，然后聚合得到总和。

*db<>fiddle [here](https://dbfiddle.uk/?rdbms=postgres_13&fiddle=c8e9dc9194baf84f452571aa07e3182c)*
[旧[sqlfiddle](http://sqlfiddle.com/#!17/3d433/1)]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:23:48.490

在您的情况下，最简单的方法可能是划分职位：

```
select periods.year as year,
       sum(coalesce(periods.wins, 0))/COUNT(distinct positions.id) as wins,
       sum(coalesce(periods.losses, 0))/COUNT(distinct positions.id) as losses,
       sum(coalesce(periods.ties, 0))/COUNT(distinct positions.id) as ties,
       array_agg(distinct positions.id) as position_id,
       array_agg(distinct positions.name) as position_names
from periods_positions_coaches_linking join
     coaches
     on coaches.id = periods_positions_coaches_linking.coach join
     positions
     on positions.id = periods_positions_coaches_linking.position join
     periods
     on periods.id = periods_positions_coaches_linking.period
where coaches.id = 1
group by periods.year
order by periods.year; 
```

位置的数量可以衡量胜负和平局，因此将其分开会调整计数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T19:21:31.257

[如此处](http://sqlfiddle.com/#!1/72ec9/12)`distinct`所示使用

代码：

```
select periods.year as year,
sum(coalesce(periods.wins, 0)) as wins,
sum(coalesce(periods.losses, 0)) as losses,
sum(coalesce(periods.ties, 0)) as ties,
array_agg( distinct positions.id) as position_id,
array_agg( distinct positions.name) as position_names

from periods_positions_coaches_linking

join coaches on coaches.id = periods_positions_coaches_linking.coach
join positions on positions.id = periods_positions_coaches_linking.position
join periods on periods.id = periods_positions_coaches_linking.period

where coaches.id = 1

group by periods.year, positions.id
order by periods.year; 
```

# ssh - 为什么我可以 ping 服务器但无法通过 SSH 连接？

> ID：12715233
> 
> 赞同：38
> 
> 时间：2012-10-03T19:12:08.247
> 
> 标签：ssh, ping

当我 ping 我的服务器时，它会响应：

```
user@localhost:~$ ping my.server
PING my.server (111.111.111.11) 56(84) bytes of data.
64 bytes from my.server (111.111.111.11): icmp_req=1 ttl=42 time=38.4 ms
64 bytes from my.server (111.111.111.11): icmp_req=2 ttl=42 time=50.0 ms
64 bytes from my.server (111.111.111.11): icmp_req=3 ttl=42 time=58.6 ms
^C
--- my.server ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2003ms
rtt min/avg/max/mdev = 38.419/49.037/58.637/8.287 ms 
```

但是当我尝试 ssh 时（我一直在做的事情，并且过去几个小时一直在同一个连接上做），它挂起：

```
user@localhost:~$ ssh my.server 
```

[http://speedtest.net](http://speedtest.net)说我的连接下载速度为 1.5 Mbps，上传速度为 0.4 Mbps。

ssh挂起是否有原因？

* * *

答案中提供的建议的结果

来自@nsfyn55

```
user@localhost:~$ telnetmy.server 22 
Trying 111.111.111.11...
Connected to my.server
Escape character is '^]'.
SSH-2.0-OpenSSH_4.3
Connection closed by foreign host. 
```

来自@vahid：

```
user@localhost:~$ nc -v -w 1 111.111.111.111 -z 22
nc: timeout cannot be negative 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-10-03T19:18:55.313

ping（ICMP 协议）和 ssh 是两种不同的协议。

1.  可能是 ssh 服务未运行或未安装

2.  防火墙限制（本地到服务器，如 iptables 甚至 sshd 配置锁定）或（保护传入网络托管 111.111.111.111 的流量的外部防火墙）

首先检查 ssh 端口是否已启动

```
nc -v -w 1 111.111.111.111 -z 22 
```

如果成功，则 ssh 应该进行通信，如果没有，则在解除限制或启动 ssh 之前它将永远不会工作

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-03T19:23:50.320

找出两条信息

*   目标 ssh 服务器的主机名或 IP 是什么
*   ssh 守护进程监听的端口（默认为 22 端口）

`$> telnet <hostname or ip> <port>`

假设守护程序已启动并正在运行并在该端口上侦听，它应该建立一个 telnet 会话。可能的原因：

*   ssh 守护进程未运行
*   主机正在使用其软件防火墙阻止目标端口
*   一些中间网络设备正在阻塞或过滤目标端口
*   ssh 守护进程正在监听非标准端口
*   TCP 包装器已配置并正在过滤掉您的源主机

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-10-03T19:15:59.857

在服务器上，尝试：

```
netstat -an 
```

并查看是否`tcp port 22`已打开（`findstr`在 Windows 或`grep`Unix 中使用）。

# php - 无法获取 php 脚本来 ping 特定端口和 IP

> ID：12715237
> 
> 赞同：0
> 
> 时间：2012-10-03T19:12:28.143
> 
> 标签：php, ping

我一直在尝试 ping 特定的 IP 和端口以检查它是在线还是离线。如果我将端口设置为 80，它可以工作，但任何其他端口都说它不工作。我可以通过游戏、telnet 等连接到端口

```
//Connection Info
$ip = "*******"; //IP
$port = "2302"; //Port

//Connection
$sock = @fsockopen( $ip, $port, $num, $error, 2 ); //2 is the ping time, you can sub what you need

//Check Status

if( !$sock ){

//Closed
        echo( "It appears to be closed" );

}

if( $sock ){

//Open
        echo( "It appears to be open" );
        fclose($sock);

} 
```

这是我得到的错误

```
Warning: fsockopen() [function.fsockopen]: unable to connect to *******:2302 (No connection could be made because the target machine actively refused it. ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:16:12.030

> 如果我将端口设置为 80，它可以工作，但任何其他端口都说它不工作。

这使它看起来很像防火墙问题（在生成端或接收端）。

您确定运行此代码的服务器允许*任何通信，*除了受限的端口范围吗？端口 25、81、110、443 和 8080 怎么样？

# wpf - 制作自定义（/模板化）ScrollViewer 或 ListBox 以了解要查看的项目

> ID：12715242
> 
> 赞同：0
> 
> 时间：2012-10-03T19:12:44.553
> 
> 标签：wpf, mvvm, listbox, scrollviewer, listboxitems

我正在尝试在 WPF c# 中创建一个类似全景的控件，该控件可以滚动到/只显示一组水平网格中的一个网格。我需要公开允许我从 ScrollViewer 或 ListBox 中的任何网格上的各种控件（使用 InteractionTrigger 就足够了）向前/向后滚动的命令。

我希望每个内部网格的大小都适合它们所在的用户控件的实际高度/宽度（如平铺页面），不需要任何滚动条，并且最终将缓动效果/状态应用于每个滚动位置。

如果这太模糊/令人费解，请告诉我。

提前致谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:21:01.080

简单的解决方案：

路径列表框。下载了 PathListBox 工具包（用于 PathListBoxScrollBehavior），将容量设置为 1，并使用模板化的 InteractionTriggers 将我的网格上的各种源对象绑定到 InvokeCommandAction 增量/减量命令。然后我添加了缓动效果/GoToStateActions。

我意识到这有点作弊，但我仍然会寻找“真正的”方法来使用从 ListBox 和/或 ScrollViewer 派生的自定义控件模板来做到这一点。

# objective-c - 具有区域设置兼容性的自定义 UIPickerView

> ID：12715243
> 
> 赞同：1
> 
> 时间：2012-10-03T19:12:45.380
> 
> 标签：objective-c, ios, datetime, nsdateformatter

我正在从 UIPickerView 制作自定义 TimePicker。我让它工作得很好，除了显示时间。我希望它像 the 一样运行，`UIDatePicker`以便它遵循用户`Locale`设置。如果他们选择了法语，则时间应以 24 小时格式显示。如果他们有美国，它应该以 12 小时格式显示。

`hoursArray`我有一个从 0 到 23的数组。然后我运行此代码将其转换为所需的格式。但是，如果在“设置”->“国际”部分中设置了该选项，则不想更改为 24 小时格式

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setLocale:[NSLocale currentLocale]];//[[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"]];
[dateFormatter setDateFormat:@"H"];
NSDate *tempDate = [dateFormatter dateFromString:[hoursArray objectAtIndex:row]];
[dateFormatter setDateFormat:@"h"];

return [dateFormatter stringFromDate:tempDate]; 
```

我尝试更改`[dateFormatter setDateFormat:@"h"];`为，`[dateFormatter setDateFormat:@"H"];`因为 Apples 文档说用户的个人区域设置将覆盖它，但情况似乎并非如此。

如何`dateFormatter`正确遵循用户区域设置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T06:16:59.217

就我而言，覆盖用户偏好效果很好，这对我来说是件坏事。！！！尝试将日期格式化程序的语言环境设置为

```
[dateFormatter setLocale:[NSLocale systemLocale]]; 
```

如果这不起作用，请尝试删除您设置区域设置的代码，因为 NSDateFormatter 会自动考虑用户设置。

# java - 如何检查字符串中的字符是数字还是字母

> ID：12715246
> 
> 赞同：60
> 
> 时间：2012-10-03T19:13:20.170
> 
> 标签：java

我让用户在程序中输入单个字符，并将其存储为字符串。我想知道如何检查输入的字符是字母还是数字。我有一个 if 语句，所以如果它是一个字母，它会打印出它是一个字母，对于一个数字也是如此。到目前为止我的代码不起作用，但我觉得我很接近。感谢您提供的任何帮助。

```
 System.out.println("Please enter a single character: ");
  String character = in.next();

  System.out.println(character);

  if (character.isLetter()){
    System.out.println("The character entered is a letter.");
  }
  else (character.isDigit()){
    Syste.out.println("The character entered is a digit."); 
```

* * *

## 回答 #1

> 赞同：74
> 
> 时间：2012-10-03T19:15:46.877

你可以使用：

```
 if (Character.isLetter(character.charAt(0))){
    .... 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2012-10-03T19:17:28.010

您可以使用 Character 类中的现有方法。看看文档：

[http://download.java.net/jdk7/archive/b123/docs/api/java/lang/Character.html#isDigit(char)](http://download.java.net/jdk7/archive/b123/docs/api/java/lang/Character.html#isDigit%28char%29)

所以，你可以做这样的事情......

```
String character = in.next();
char c = character.charAt(0);
...
if (Character.isDigit(c)) { 
    ... 
} else if (Character.isLetter(c)) {
    ...
}
... 
```

如果您想确切地知道这是如何实现的，您可以随时查看 Java 源代码。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-10-27T23:43:14.293

嗯，你们忘记了`Character.isLetterOrDigit`方法：

```
boolean x;
String character = in.next();
char c = character.charAt(0);
if(Character.isLetterOrDigit(charAt(c)))
{ 
  x = true;
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-10-03T19:59:51.670

这有点棘手，您在键盘上输入的值是一个字符串值，因此您必须使用方法来定位第一个字符，`line.chartAt(0)`其中 0 是第一个字符的索引，并将该值存储在 char 变量中，就像`char c= line.charAt(0)` 现在一样通过使用方法[`isDigit()`](http://download.java.net/jdk7/archive/b123/docs/api/java/lang/Character.html#isDigit%28char%29)和[`isLetter()`](http://download.java.net/jdk7/archive/b123/docs/api/java/lang/Character.html#isLetter%28char%29)类`Character`，您可以区分数字和字母。

这是您的程序的代码：

```
import java.util.Scanner;

class Practice
{
 public static void main(String[] args)
  {
   Scanner in = new Scanner(System.in);
   System.out.println("Input a letter"); 
   String line = in.nextLine();
   char c = line.charAt(0);
   if( Character.isDigit(c))
   System.out.println(c +" Is a digit");
   else if (Character.isLetter(c))
   System.out.println(c +" Is a Letter");
  }

} 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-10-03T19:21:24.650

通过使用[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)：

```
boolean isChar = character.matches("[a-zA-z]{1}");
boolean isDigit = character.matches("\\d{1}"); 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2012-10-03T19:23:03.417

```
char charInt=character.charAt(0);   
if(charInt>=48 && charInt<=57){
    System.out.println("not character");
}
else
    System.out.println("Character"); 
```

查找 ASCII 表以查看 int 值是如何硬编码的。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-06-19T05:22:33.330

这是如何检查给定字符是否为字母的方法

```
public static void main(String[] args) {

    Scanner sc = new Scanner(System.in);
    char c = sc.next().charAt(0); 
    if((c >= 'a' && c <= 'z') || (c >= 'A' && c <= 'Z'))
         System.out.println(c + " is an alphabet.");
    else
        System.out.println(c + " is not an alphabet.");
} 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2012-10-03T19:16:15.467

```
 char temp = yourString.charAt(0);
     if(Character.isDigit(temp))
     {
         ..........
     }else if (Character.isLetter(temp))
     {
          ......
      }else
     {
      ....
     } 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-03-15T11:17:57.933

```
import java.util.*;

public class String_char 
{

    public static void main(String arg[]){   

        Scanner in = new Scanner(System.in);
        System.out.println("Enter the value");
        String data;
        data = in.next();

        int len = data.length();
        for (int i = 0 ; i < len ; i++){
            char ch = data.charAt(i);

            if ((ch >= '0' && ch <= '9')){
                System.out.println("Number ");
            }
            else if((ch >= 'a' && ch <= 'z') || (ch >= 'A' && ch <= 'Z')){
            System.out.println("Character");
            }
            else{
                System.out.println("Symbol");
             }
        }
    } 
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-01-28T12:50:31.343

您可以通过正则表达式执行此操作，如下所示您可以使用此代码

```
EditText et = (EditText) findViewById(R.id.editText);
String NumberPattern = "[0-9]+";
String Number = et.getText().toString();

if (Number.matches(NumberPattern) && s.length() > 0)
{ 
    //code for number
}
else
{
    //code for incorrect number pattern
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-10-03T19:17:01.300

您需要将字符串转换为字符..

```
String character = in.next();
char myChar = character.charAt(0);

if (Character.isDigit(myChar)) {
   // print true
} 
```

检查[字符](http://docs.oracle.com/javase/7/docs/api/java/lang/Character.html)以获取其他方法..

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2015-11-05T06:03:28.207

我编写了一个示例程序，用于检查字符串中是否包含数字！我想它也将用于此目的。

```
public class test {
    public static void main(String[] args) {
        String c;
        boolean b;

        System.out.println("Enter the value");
        Scanner s = new Scanner(System.in);
        c = s.next();
        b = containsNumber(c);
        try {
            if (b == true) {
                throw new CharacterFormatException();
            } else {
                System.out.println("Valid String \t" + c);
            }
        } catch (CharacterFormatException ex) {
            System.out.println("Exception Raised-Contains Number");

        }
    }

    static boolean containsNumber(String c) {
        char[] ch = new char[10];
        ch = c.toCharArray();

        for (int i = 0; i < ch.length; i++) {
            if ((ch[i] >= 48) && (ch[i] <= 57)) {
                return true;
            }
        }
        return false;
    }
} 
```

`CharacterFormatException`是用户定义的异常。建议我是否可以进行任何更改。

# javascript - 检查 HTML 表单复选框，但确保调用侦听器

> ID：12715248
> 
> 赞同：1
> 
> 时间：2012-10-03T19:13:33.470
> 
> 标签：javascript, html, event-listener

> **可能重复：**
> [手动触发 onchange 事件](https://stackoverflow.com/questions/2856513/trigger-onchange-event-manually)

我想设置为选中的表单中有一个复选框。这很容易：

```
var checkbox = document.getElementById("mycheckbox");
checkbox.checked = true; 
```

但我想这样做以便调用 onChange 侦听器。我该怎么做呢？

# javascript - Twitter Bootstrap 转换冲突原型

> ID：12715254
> 
> 赞同：4
> 
> 时间：2012-10-03T19:14:02.333
> 
> 标签：javascript, jquery, twitter-bootstrap, prototypejs

我使用您页面上有效的演示中的标记为 Twitter Bootstrap 的 Collapse 功能创建了一个小提琴：http: [//jsfiddle.net/Rymd7/1/](http://jsfiddle.net/Rymd7/1/)

然后有一次，我添加了对prototypejs的引用，折叠功能在单击几次后停止在每个手风琴组上工作。 [http://jsfiddle.net/p5SAy/1/](http://jsfiddle.net/p5SAy/1/) 我不确定问题是什么或如何纠正它。

这是一个引导问题还是有办法解决这个问题并使这两个 js 库存在于同一页面上？

我试过 jQuery noConflict 没有成功，但任何帮助表示赞赏。如果你能给我寄回一个很棒的工作小提琴……或者任何见解。

谢谢。-约翰

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-04T10:29:16.897

您正在同时使用 jQuery 和 Prototype 而没有`jQuery.noConflict()`. 后

```
<script type='text/javascript' src='http://code.jquery.com/jquery-1.7.js'></script>
<script type='text/javascript' src="http://ajax.googleapis.com/ajax/libs/prototype/1.7.0/prototype.js"></script> 
```

此行导致 javascript 错误：

```
$(window).load(function(){ 
```

修改后的小提琴： http: [//fiddle.jshell.net/ymbsr/5/](http://fiddle.jshell.net/ymbsr/5/) -在不同的浏览器中打开[http://fiddle.jshell.net/ymbsr/5/show/ 。](http://fiddle.jshell.net/ymbsr/5/show/)

附言

删除 jQuery/Prototype 冲突后，我可以看到 Chrome 21 和 Opera 12.02 手风琴转换永远不会结束（`bootstrap-collapse.js` `Collapse.transition`启动转换但从`complete()`未被调用）。对同一元素的进一步调用将`Collapse.show()/hide()`在 之后退出`if (this.transitioning) return`。

在 Firefox 15.0.1 中，手风琴工作正常。

聚苯乙烯

这种奇怪的行为是两个特征的结果：

1.  `this.$element.trigger('hide')`(in `Collapse#transition()`) 尝试调用元素中是否存在`$element.hide()`方法- 这是[设计使然](http://api.jquery.com/trigger/)：`hide()`

    > 注意：对于普通对象和 DOM 对象，如果触发的事件名称与对象上的属性名称匹配，如果没有事件处理程序调用 event.preventDefault()，jQuery 将尝试将该属性作为方法调用。如果不需要此行为，请改用 .triggerHandler() 。

    在每个支持 HTML 元素的浏览器中使用 Prototype 元素原型扩展`$element`肯定会有`hide()`方法，它实际上是通过设置隐藏元素`element.style.display = 'none'`。

2.  在当前版本的 Chrome 和 Opera 中，如果元素被隐藏（具有样式） ，则不会触发过渡结束事件（`webkitTransitionEnd`、`oTransitionEnd`、之一）。Firefox 更成功地结束了它的转换，但[在某些情况下也可能不会触发事件](https://developer.mozilla.org/en-US/docs/CSS/Using_CSS_transitions#Detecting_the_completion_of_a_transition)：`otransitionend``display: none`

    > 注意：如果过渡被中止，则不会触发“transitionend”事件，因为动画属性的值在过渡完成之前已更改。

如何修复它：

1.  提交错误`bootstrap-collapse.js`- 它不应[仅依赖于过渡结束事件](http://heydanno.com/blog/2010/03/07/detecting-transition-event-support/)

2.  提交一个错误`bootstrap-collapse.js`- 它的`hide`事件与其他框架相交（至少与 Prototype 有交叉，但任何其他扩展元素原型的框架可能会受到影响）。

3.  `Collapse#transition()`从[http://fiddle.jshell.net/ymbsr/7/](http://fiddle.jshell.net/ymbsr/7/)`bootstrap-collapse.js`临时修补- 禁用事件触发或更改事件名称。

    ```
    jQuery.fn.collapse.Constructor.prototype.transition = function (method, startEvent, completeEvent) {
      var that = this
        , complete = function () {
            if (startEvent.type == 'show') that.reset();
            that.transitioning = 0;
            that.$element.trigger(completeEvent);
          }
      //this.$element.trigger(startEvent);
      //if (startEvent.isDefaultPrevented()) return;
      this.transitioning = 1;
      this.$element[method]('in');
      (jQuery.support.transition && this.$element.hasClass('collapse')) ?
          this.$element.one(jQuery.support.transition.end, complete) :
          complete();
    }; 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-01T20:29:48.367

我正在使用 Magento，并且多年来一直存在[引导程序/原型问题](http://www.softec.lu/site/DevelopersCorner/BootstrapPrototypeConflict)。我没有运气就尝试了以上所有方法。哈你不会相信什么有效！

我将原型作为要加载的第一个脚本之一，并让所有其他脚本在之后加载。这对我有用。我不知道为什么我没有早一点尝试。

# php - 累积数组

> ID：12715255
> 
> 赞同：2
> 
> 时间：2012-10-03T19:14:05.960
> 
> 标签：php, math

我有这个数组：

```
$a = array(1, 2, 3, 4, 5, 7, 8, 10, 12); 
```

是否有将其转换为的功能：

```
$b = array(1, 1, 1, 1, 2, 1, 2, 2); 
```

所以基本上：

```
$b = array ($a[1]-$a[0], $a[2]-$a[1], $a[3]-$a[2], ... ,$a[n]-$a[n-1]); 
```

这是我到目前为止的代码：

```
$a = $c = array(1, 2, 3, 4, 5, 7, 8, 10, 12);
array_shift($c);
$d = array();
foreach ($a as $key => $value){
   $d[$key] = $c[$key]-$value;
}
array_pop($d); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:19:28.557

没有内置函数可以为您执行此操作，但您可以将代码合二为一。`$c`此外，您可以使用常规`for`循环来遍历这些值，而不是创建第二个数组：

```
function cumulate($array = array()) {
    // re-index the array for guaranteed-success with the for-loop
    $array = array_values($array);

    $cumulated = array();
    $count = count($array);
    if ($count == 1) {
        // there is only a single element in the array; no need to loop through it
        return $array;
    } else {
        // iterate through each element (starting with the second) and subtract
        // the prior-element's value from the current
        for ($i = 1; $i < $count; $i++) {
            $cumulated[] = $array[$i] - $array[$i - 1];
        }
    }
    return $cumulated;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:21:55.493

我认为 php 没有内置函数。有很多方法可以解决这个问题，但你已经写了答案：

```
$len = count($a);
$b = array();
for ($i = 0; $i < $len - 1; $i++) {
  $b[] = $a[$i+1] - $a[$i];
} 
```

# javascript - 触发 textarea ctrl-z 撤消缓冲区更新

> ID：12715261
> 
> 赞同：1
> 
> 时间：2012-10-03T19:14:37.520
> 
> 标签：javascript, jquery, buffer, undo-redo

我有一个文本区域，它相当大，有很多数据。我希望`ctrl`+`z`撤消缓冲区更频繁地更新，可能是每次用户点击输入时。默认情况下，据我所知，缓冲区仅在 textarea on blur 或 on `ctrl`+ `y`/ `ctrl`+时更新`z`。

我不想在他们每次按 Enter 时都模糊文本区域。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:18:11.943

你可以模糊和设置焦点背靠背，以便更频繁地设置撤消状态吗？

基本上，听按键，然后按回车键，进行切换。在某些情况下它可能会出现故障，但我认为它会起作用。要捕捉在回车键后快速输入的字符，请将焦点设置在主框后面的框上的小文本输入上，然后在重新聚焦时添加任何丢失的文本。

# unix - PHPUnit & ZF2：错误“找不到名称，无法描述任何东西”

> ID：12715263
> 
> 赞同：0
> 
> 时间：2012-10-03T19:14:55.533
> 
> 标签：unix, phpunit, zend-framework2

谁能解释这个错误可能意味着什么？

我正在尝试使用 ZF2 设置 phpunit 测试，但每次尝试运行 phpunit 命令时，都会出现此错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T08:44:59.983

如果您通过 Composer 安装 PHPUnit，您可能会收到此错误消息。没有任何与 ZF2 相关的东西。

在[这个提交](https://github.com/sebastianbergmann/phpunit/commit/43433ef6101fe17c037d03dd12921ab94a666ae1)中，塞巴斯蒂安修复了这个问题。

您只需要更新到“3.7.x-dev”而不是“>=3.7.1”或类似的东西

# python - 如何使用 DataNitro 和 python 保存 excel 文件

> ID：12715267
> 
> 赞同：2
> 
> 时间：2012-10-03T19:15:07.923
> 
> 标签：python, excel, datanitro

我有一个 python 脚本，可以使用 DataNitro excel 插件（免费的）从数据库查询中生成一个 excel 工作表，现在我想保存文件，然后通过电子邮件发送，但 DataNitro 文档只包括使用单元格和工作表，DataNitro API 中是否有方法调用或任何其他解决方法来保存文件？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-05T23:18:32.727

DataNitro 创始人在这里 - 我刚刚为您添加了将工作簿保存到 DataNitro API 的功能。感谢您指出这一点！您需要从 [https://www.datanitro.com下载最新版本的 DataNitro](https://www.datanitro.com)

这是保存工作簿并通过电子邮件发送的 Python 2 代码：[https ://github.com/datanitro/blog/blob/master/save_and_email/save_and_send.py](https://github.com/datanitro/blog/blob/master/save_and_email/save_and_send.py)

您可以在此处找到 save() 和 save_copy() 的文档：[https ://datanitro.com/docs.html#sheets](https://datanitro.com/docs.html#sheets)

请让我知道你在想什么。谢谢！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:22:37.673

我认为您正在寻找类似 smtplib 的东西。这将允许您从 python 发送电子邮件和附件。

在此处了解更多信息：http: [//www.blog.pythonlibrary.org/2010/05/14/how-to-send-email-with-python/](http://www.blog.pythonlibrary.org/2010/05/14/how-to-send-email-with-python/)

文档： [http ://docs.python.org/library/smtplib.html](http://docs.python.org/library/smtplib.html)

# xml - pugixml：无法获取孩子/无法迭代

> ID：12715270
> 
> 赞同：0
> 
> 时间：2012-10-03T19:15:22.513
> 
> 标签：xml, xml-parsing, pugixml

我是第一次使用[pugixml](https://pugixml.googlecode.com/svn/tags/latest/docs/manual/access.html)，但无法将文件正确加载到内存中。

我的 XML 测试文档：

```
<?xml version="1.0"?>
<node>
</node> 
```

我使用以下代码加载文档并获取孩子：

```
pugi::xml_document doc;
pugi::xml_parse_result result = doc.load("test.xml");
if (result)
{
    Log(L"XML [%s] parsed without errors", L"test.xml");

    pugi::xml_node node = doc.child(L"node");
    if (node)
        Log(L"it works");
    else
        Log(L"it does not work");

    doc.save_file(L"test.xml");
}
else
{
    Log(L"XML [%s] parsed with errors", L"test.xml");
    Log(L"XML Error description: %s", result.description());
    Log(L"XML Error offset: %d", result.offset);
} 
```

输出：

```
XML [test.xml] parsed without errors

it does not work 
```

执行后的 XML 文件：

```
<?xml version="1.0"?> 
```

（使用 doc.save_file 函数时数据丢失）

编译器：MS Visual Studio 2010 Ultimate

语言：C++

构建：UNICODE/x64

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T05:39:33.090

您的代码不是打开文件而是解析字符串“test.xml”。使用`doc.load_file("test.xml")`.

`doc.load("test.xml")`没有返回任何错误，因为 pugixml 不拒绝根级 PCDATA（但也不解析它）。这不是一个理想的决定，但不清楚是否存在明显更好的替代方案 - 解析文档片段和解析不生成任何节点（即`"<!--comment-->"`没有`pugi::parse_comments`）的有效片段存在复杂性。

# mysql - 从另一个数据库和函数赋值 - MySQL 变量范围

> ID：12715271
> 
> 赞同：0
> 
> 时间：2012-10-03T19:15:22.260
> 
> 标签：mysql, scope, user-defined-functions, multiple-databases

我正在使用 MySQL 制作一份报告，显示特定日期范围和项目的计费小时数。复杂性在于每个项目的日期范围是可变的（不同的开始月份和开始日期）。此信息来自另一个数据库/表中的值。

我在 MySQL 中有以下 UDF：

```
DELIMITER //

CREATE FUNCTION TimeLeft(startday INT, today INT) RETURNS INT
DETERMINISTIC
BEGIN
DECLARE s INT;
   IF startday < today THEN SET s = 0;
     ELSE SET s = 1;
     END IF;
   RETURN s;
END //

DELIMITER; 
```

我在以下查询中使用该函数，它应该采用 TimeLeft 函数中返回的值来确定每个项目的开始月份 (month(curdate())-@xx) 和开始日期 (@yy) 的值计算小时数：

```
AND time_records.record_date >= concat('2012/', month(curdate())-@xx , '/' , @yy) 
```

以下是我为@xx 和@yy 设置值的方式：

```
SET @xx = 0; #this is the value that we will use to manipulate the month for the date range
SET @yy = 0;
@yy:= SELECT start_day_of_month FROM dashboard.client; #this doesn't seem to work
SELECT @xx:= TimeLeft(@yy,dayofmonth(curdate())); 
```

我遇到了一些问题：

1.  @yy 没有得到值 - 可能我的语法错误？
2.  变量设置在代码的顶部，因此它们不会因每个项目而发生应有的变化（每个项目应该有不同的@xx 和@yy，因为每个项目都有不同的开始和结束日期）。

这是完整的查询：

```
#below is where I assign the variables

SET @xx = 0; #this is the value that we will use to manipulate the month for the date range
SET @yy = 0;
@yy:= SELECT start_day_of_month FROM dashboard.client; #this doesn't seem to work
SELECT @xx:= TimeLeft(@yy,dayofmonth(curdate()));

# below is the MySQL query that is meant to use the variables assigned above

SELECT X.expr1 AS 'Project Name', @monthly_hours - SUM(X.expr2) AS 'Hours Billed
FROM 
  (SELECT 
    projects.name AS expr1
    , sum(time_records.value) AS expr2
  FROM project_objects
  INNER JOIN projects
    ON projects.id = project_objects.project_id
  INNER JOIN time_records
    ON time_records.parent_id = project_objects.id
  WHERE time_records.parent_type = 'Task' 
  AND time_records.record_date >= concat('2012/', month(curdate())-@xx , '/' , @yy)  
  AND time_records.record_date <= curdate()
  GROUP BY projects.name

  UNION

  SELECT 
    projects.name AS expr1
    , sum(time_records.value) as expr2
  FROM projects
  INNER JOIN time_records
    ON projects.id = time_records.parent_id
  WHERE time_records.parent_type = 'Project'
  AND time_records.record_date >= concat('2012/', month(curdate())-@xx , '/' , @yy)     
  AND time_records.record_date <= curdate() 
  GROUP BY projects.name) X
GROUP BY X.expr1 
```

我认为我在哪里分配变量@xx 和@yy 存在一些问题。这些应该为每个单独的项目完成，因此将它们放在顶部可能不是最好的主意。我也不确定我是否正确分配了@yy 值。它应该查询另一个数据库中的表的字段的值，但它不断在@yy 分配给该字段时抛出语法错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:38:12.067

`@yy`为inside赋值`select`：

```
SELECT @yy:= start_day_of_month FROM dashboard.client; 
```

# python - python客户端tcp套接字可以用于多次发送吗？

> ID：12715273
> 
> 赞同：0
> 
> 时间：2012-10-03T19:15:29.657
> 
> 标签：python, sockets, network-programming

我尝试使用套接字进行 2 次发送。第一个成功，下一个没有。从[http://docs.python.org/howto/sockets.html](http://docs.python.org/howto/sockets.html) 看来，应该允许多次发送。无论好坏，我真的不需要从套接字读取。我使用了 twisted，但就目前的目的而言，如果我能提供帮助，我想坚持使用套接字（部分原因是我在已经使用 twisted 进行通信的应用程序中使用它。这是一个单独的连接）。

“当连接完成后，socket s 可以用来发送请求页面的文本。同一个socket会读取回复，然后被销毁。没错，被销毁。客户端sockets通常只用于一个交换（或一小组顺序交换）。”

发送成功的返回值 = 35 发送失败的返回值 = 32

进行一些小的编辑以删除任何业务逻辑的代码。

```
self._commandSock = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

def sendPrereqs(self,id,prereqs):
    self._commandSock.connect(self._commandConnection)
    #parse prereqs
    temp = prereqs.split(',')
    for pair in temp:
        tup = pair.partition(':')
        try:
            command = 'some command'
            logging.info('sending command: ' + command)
            ret = self._commandSock.send(command)
            if ret == None:
                logging.info('send called successfully: ' + command)
            else:
                logging.info('socket returned non-None: ' + str(ret))
        except:

            print 'Unexpected Exception ', sys.exc_info()[0]()
            print sys.exc_info()
            #logging.info('Unexpected Exception '+ str(sys.exc_info()[0]()))
            #logging.info(' ' + str(sys.exc_info()))
    self._commandSock.close()` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:49:07.730

> 发送成功的返回值 = 35 发送失败的返回值 = 32
> 
> 文档说成功发送应该返回无。

不，它没有。[文档](http://docs.python.org/library/socket.html#socket.socket.send)说：

> **返回发送的字节数。**应用程序负责检查所有数据是否已发送；如果仅传输了部分数据，则应用程序需要尝试传输剩余数据。有关此概念的更多信息，请参阅 Socket Programming HOWTO。

您还没有解释“失败”的含义。调用成功返回，`send`几乎可以肯定它已将 32 个字节放入套接字写入缓冲区。

如果您认为它失败的唯一原因是它返回了正确的值，那么答案显然是它没有失败。

如果其他事情出了问题，那么在更高的层次上可能会出现各种各样的事情。一个可能的情况是：服务器（特别是如果它是由不太了解套接字的人编码的）被编码为期望`recv()`35 字节之一`recv()`和 32 字节之一。但它实际上得到了一个`recv()`67 字节，并且永远等待第二个，而第二个永远不会到来。没有规则保证`send()`流 (TCP) 套接字上的每个套接字都对应`recv()`另一侧的一个。您需要创建某种类型的流协议来划分单独的消息。

同时，您所指的报价无关紧要。它描述了简单的 Web 浏览器如何使用客户端套接字：它们建立连接，进行一次发送，接收所有数据，然后销毁连接。我知道它为什么会误导您，您可能需要提交文档错误以对其进行改进。但现在，请忽略它。

如果您想确保客户端发送正确的数据，而问题出在服务器上，有两种简单的方法可以做到这一点：

1.  使用[netcat](http://en.wikipedia.org/wiki/Netcat)作为一个简单的替代服务器（例如，`nc -kl 6000`用实际端口替换“6000”）并确保它记录您认为服务器应该看到的内容。

2.  使用[Wireshark](http://www.wireshark.org/)观察客户端和服务器之间的连接。

确认问题出在服务器端后，您需要调试服务器。如果您需要这方面的帮助，最好在一个新问题中完成，您可以在其中发布服务器代码而不是客户端，并解释（此处带有链接）您确定客户端正在发送正确的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:20:04.050

该文档仅指一种常见情况。您可以根据需要随时在所有套接字上调用[`send`](http://docs.python.org/library/socket.html#socket.socket.send)、[`sendall`](http://docs.python.org/library/socket.html#socket.socket.sendall)和[`sendto`](http://docs.python.org/library/socket.html#socket.socket.sendto)——只要套接字未关闭。

请注意，这些方法返回发送的字节数，32 和 35 仅表示您第一次发送了 32 个字节，第二次发送了 35 个字节。

无异常返回的事实`socket.send`意味着数据已传递给操作系统，但并不意味着它实际上到达了端点（或已被那里的应用程序正确读取）。

# c# - Windows 窗体应用程序的可插入 UI 组件？

> ID：12715276
> 
> 赞同：0
> 
> 时间：2012-10-03T19:15:40.743
> 
> 标签：c#, winforms

我们的应用程序包含许多模块，这些模块可以在安装和运行后动态推送到我们的应用程序。所有这些模块都可能需要在 UI 上进行一些显示。所以我想我们可以构建一个 UI exe，它可以从 DLL（或任何其他类型的程序集）加载 UI 组件。假设 module1 和 module2 在机器上处于活动状态，我们将在 UI 的左框架显示“module1”和“module2”。如果用户单击“module1”，右侧框架将打开 module1 的屏幕，该屏幕是从与 module1 一起向下推的另一个程序集（例如 DLL）加载的。

只是想知道这种可插入的 UI 架构是否甚至可以在 Windows 窗体中使用。我在互联网上进行了一些搜索，但没有找到任何有用的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T21:10:53.167

是的，这是可能的，我自己已经做到了。

最好的方法是在程序之外创建第二个 DLL。在该 DLL 中，您定义了插件将实现的接口。然后在主 EXE 中让窗体加载目录中的所有 DLL，并查看它是否包含实现该接口的任何类。在您的插件 DLL 中，您还引用了相同的 DLL 并让您的模块实现该接口。您希望所有插件通用的任何功能都需要放入，`IMyPlugin`因为这是您将在 UI 中投射所有内容的界面，因此只有这些功能可见。

```
//In a 2nd project that compiles as a DLL
public interface IMyPlugin
{
    Control GetControl();
}

///////////////////

//In your main project
private List<IMyPlugin> pluginsList;   

private void MainForm_Load(object sender, EventArgs e)
{ 
    foreach(string pluginPath in Directory.EnumerateFiles(Application.StartupPath + @"\Plugins\", "*.dll"))
    {
        try
        {
            //load the assembly
            Assembly pluginAssembly = Assembly.LoadFrom(pluginPath);

            //Find all types defined in the assembly.
            Type[] types = pluginAssembly.GetTypes();

            //Filter the types to only ones that implment IMyPlugin
            var plugins = types.Where(x => typeof(IMyPlugin).IsAssignableFrom(x));

            //Filter the plugins to only ones that are createable by Activator.CreateInstance
            var constructablePlugins = plugins.Where(x => !x.ContainsGenericParameters && x.GetConstructor(Type.EmptyTypes) != null);

            foreach (var pluginType in constructablePlugins)
            {
                //instantiate the object
                IMyPlugin plugin = (IMyPlugin)Activator.CreateInstance(pluginType);

                pluginsList.Add(plugin);
            }
        }
        catch (BadImageFormatException ex)
        {
            //ignore this exception -- probably a runtime DLL required by one of the plugins..
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.ToString(), "MainForm.MainForm_Load()");
        }
    }

    //Suspend the layout for the update
    this.SuspendLayout();
    this.someFlowLayoutPanelToStoreMyPlugins.SuspendLayout();

    foreach(IMyPlugin plugin in pluginsList)
    {
        this.someFlowLayoutPanelToStoreMyPlugins.Controls.Add(plugin.GetControl());
    }
    //resume the layout
    this.someFlowLayoutPanelToStoreMyPlugins.ResumeLayout(false);
    this.someFlowLayoutPanelToStoreMyPlugins.PerformLayout();
    this.ResumeLayout();
}

//////////////////////

// In your plugin DLL.

public class Plugin : UserControl, IMyPlugin
{
    public Plugin()
    {
        //The code in the main form requires there be a public 
        //  no parameter constructor (either explicitly or implicitly),
        //  UserControls usually have one anyway for InitializeComponent.

        InitializeComponent();
    }

    public Control GetControl()
    {
        return this;
    }

    // The rest of your code.
} 
```

注意：这段代码只是复制和粘贴了我的很多代码，我不知道它是否能完美地工作，但这会让你接近你需要去的地方。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:07:28.250

这是很有可能的，而且它并不特定于 WinForms。您需要一种方法来要求模块在某个时候将其 UI 提供给您。例如：您的模块将实现一个接口，并且它将有一个返回[Panel](http://msdn.microsoft.com/en-us/library/e63s4df3.aspx)的方法。当你调用它时，你可以在你的 UI 上用它做任何事情。

例如：您的右侧面板可以是可以托管面板的东西。

您的界面可能如下所示

```
interface IModule
{
    ...
    Panel GetUI();
    ...
} 
```

因此，当用户单击左窗格中的模块时，您将运行类似这样的操作。

```
var selectedModule = GetSelectedModule() 
// this method will do the Reflection to load your assemblies, 
// go through the Types, filter every type that implement IModule and load them.
// then get an instance of the module. (Let me know if you want help on Reflection)

if (!GetConfiguration().IsModuleEnables(selectedModule))
    return; // module not enabled. Ignore click ???

rightPane.Children.Clear();
rightPane.Children.Add(selectedModule.GetUI());
// might want to dock the module as 'Fill' as well. 
```

我认为您最好在应用程序中保持模块的“已激活”状态，而不是询问模块是否已启用（流氓模块可以一直返回 true。）

希望这可以帮助。

**更新：**为了保证安全，我建议您将模块加载到单独的[AppDomain](http://msdn.microsoft.com/en-us/library/system.appdomain.aspx)中。尽管您可能在它们之间传递 UI 对象时遇到问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T20:43:56.507

我还没有尝试过，所以我不能保证它会起作用，但据我所见，它应该可以。

如果在构建 exe 时知道模块列表，则只需更新组件 dll 即可更新任何组件的功能。如果您在 dll 中包含某种方式来切换给定组件是否处于活动状态，您可以使用稍后添加功能的虚拟组件“填充”dll。例如：

```
using ComponentLibrary;
class Program
{
  static void Main()
  {
    //...
    if (Module1.IsActive()) listModules.Add(Library.Module1);
    if (Module2.IsActive()) listModules.Add(Library.Module2);
  }
  listModules_click()
  {
     // var m = clicked-on-module
     if (m is Module1)
     {
       component = new Module1();
     }
     else if (m is Module2)
     {
       component = new Module2();
     }
  }
}

namespace ComponentLibrary
{
  abstact class Module : Component
  {
     public abstract bool IsActive();
  }
  public class Module1 : Module
  {
     public bool IsActive() { return true; }
  }
  public class Module2 : Module
  {
     public bool IsActive() { return false; }
  }  
} 
```

稍后，您对 Module2 进行编码，并将其`IsActive()`结果替换为`true`. 但是签名没有改变，所以你不需要重新编译exe。在那之前，没有办法真正启动 Module2。

# c# - 如何导出 c# 函数以便可以从非托管环境中调用它？

> ID：12715277
> 
> 赞同：2
> 
> 时间：2012-10-03T19:15:43.600
> 
> 标签：c#

我想知道如何导出函数以便在其他编程语言中使用它？

我想在非托管编程语言中使用 dll 函数。

我能做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:26:05.193

可能有用的两篇文章……听起来相当痛苦：

*   [托管/非托管代码互操作性概述](http://msdn.microsoft.com/en-us/library/ms973872.aspx)
*   [向 COM 公开 .NET Framework 组件](http://msdn.microsoft.com/en-us/library/zsfww439.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:28:58.503

您需要使用该命令对您的 .NET 程序集运行[regasm.exe](http://msdn.microsoft.com/en-us/library/tzat5yw6%28VS.80%29.aspx)`/tlb` ，然后从 C++ 引用输出类型库 (tlb)。

我以前做过很多次，这可能会很痛苦，尤其是当你去部署它的时候。我推荐使用这个`/codebase`开关，当它的类在 COM 上下文中被实例化时，它会告诉注册表在哪里可以找到你的 .NET 程序集。这样可以很容易地在注册表中找到并在必要时对其进行调整。

# gcc - GCC LTO 是否执行跨文件死代码消除？

> ID：12715286
> 
> 赞同：2
> 
> 时间：2012-10-03T19:16:13.957
> 
> 标签：gcc, dead-code, lto

说我有一个功能

```
void do_something() {
    //....
    #ifdef FEATURE_X
        feature_x();
    #endif
    //....
} 
```

我可以毫无问题地编译和运行它；如果我想要我可以通过的功能`-D FEATURE_X`并且它可以工作。

但是，如果我想`do_something`放入另一个文件怎么办（并且每次我决定更改选项时都不必重新编译该文件）。如果它在同一个文件中，我假设

```
const int FEATURE_X=0;

void do_something() {
    //....
    if(FEATURE_X) {
        feature_x();
    }
    //....
} 
```

将正确使用死代码消除，消除调用。如果我把它放在另一个文件中，没有 LTO，

```
extern const int FEATURE_X;

void do_something() {
    //....
    if(FEATURE_X) {
        feature_x();
    }
    //....
} 
```

它不会删除代码（它无法知道）。那么，启用链接时优化后，编译器是否可以检测`FEATURE_X`链接时的值，确定代码是否被使用，并在适当时将其删除？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-07T17:54:16.483

GCC 确实删除了跨模块无法访问的功能，但它无法确定您最后一个测试用例中的代码已死，因为 FEATURE_X 的常量值确定得太晚了。

如果您将使用 -D 方式或将您`const int FEATURE_X=0;`放入每个模块中，那么是的，代码将被消除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-25T17:37:59.143

如果不是引用的代码：

```
extern const int FEATURE_X;

void do_something() {
    //....
    if(FEATURE_X) {
        feature_x();
    }
    //....
} 
```

如果它是用这样的链接时间变量完成的：

```
extern const int FEATURE_X;

void do_something() {
    //....
    if(NULL != &FEATURE_X) {
        feature_x();
    }
    //....
} 
```

然后在链接器指令文件中，定义

```
define exported symbol FEATURE_X = 0x0 
```

无论如何在链接时优化它吗？

# asp.net-mvc - ASP.NET MVC 中的条件路由

> ID：12715289
> 
> 赞同：0
> 
> 时间：2012-10-03T19:16:30.490
> 
> 标签：asp.net-mvc, asp.net-web-api

我会尽量简单地描述我的问题。我有几个在运行时动态加载的控制器。这些控制器为不同的合作伙伴托管多个 Web api。我想要实现的是在访问控制器之前在 URL 中有一个前缀。换句话说，我有Partner1 和Partner2。他们都有一些控制器，例如

伙伴 1：服务 1 控制器，服务 2 控制器 2。Partner2：Api1Controller、Api2Controller等

现在我想实现以下目标。我希望 partner1 的控制器只能通过 URL 中的 Partner1 前缀访问，例如[http://somehost.com/Partner1/Service1](http://somehost.com/Partner1/Service1)，但我不希望 Api1Controller 可以从[http://somehost.com/Partner1/访问Api1](http://somehost.com/Partner1/Api1)，但它应该可以从[http://somehost.com/Partner2/Api1](http://somehost.com/Partner2/Api1)访问。

有什么方法可以实现我的目标吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:09:27.640

一个不优雅的解决方案可能是使用 2 个单独的路由映射：

```
routes.MapRoute(
    "partner1", 
    "partner1/{controller}/{action}",
    new { contoller =  Service1Controller, action = "Index" },  
    new { contoller = @"(Service1Controller)|(Service2Controller)"}
);

routes.MapRoute(
    "partner2", 
    "partner2/{controller}/{action}",
    new { controller = Api1Controller, action = "Index" },   
    new { contoller = @"(Api1Controller)|(Api2Controller)"}
); 
```

MapRoute 的第 4 个参数将约束定义为正则表达式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T21:15:26.243

您可以创建一个自定义 ActionFilter 来查看请求和用户并确定路由是否有效。如果不是，那么您可以返回一些 ActionResult 重定向或向用户返回错误。

# prolog - Prolog插入排序

> ID：12715293
> 
> 赞同：4
> 
> 时间：2012-10-03T19:16:42.247
> 
> 标签：prolog, sorting

有一个简单的 Prolog 插入排序算法：

```
sorting([A|B], Sorted) :- sorting(B, SortedTail), insert(A, SortedTail, Sorted).
sorting([], []).

insert(A, [B|C], [B|D]) :- A @> B, !, insert(A, C, D).
insert(A, C, [A|C]). 
```

它在正常列表中表现良好：

```
?- sorting([5, 4, 9, 1, 3, 8], X).
X = [1, 3, 4, 5, 8, 9]. 
```

但我还需要排序列表的子列表包含其中的任何一个：

```
?- sorting([2, 5, [5, 4, 3], [6, 3], 4, 8], X).
X = [2, 4, 5, 8, [5, 4, 3], [6, 3]]. 
```

现在是什么回报。和

```
?- sorting([2, 5, [5, 4, 3], [6, 3], 4, 8], X).
X = [2, 4, 5, 8, [3, 4, 5], [3, 6]]. 
```

我需要返回什么。那么我怎样才能对子列表进行排序呢？提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2017-01-08T14:50:18.613

# 我提供了这个简单的解决方案：

在排序列表中插入元素

```
insert(X, [], [X]):- !.
insert(X, [X1|L1], [X, X1|L1]):- X=<X1, !.
insert(X, [X1|L1], [X1|L]):- insert(X, L1, L). 
```

使用插入排序算法原理

```
insertionSort([], []):- !.
insertionSort([X|L], S):- insertionSort(L, S1), insert(X, S1, S). 
```

# c++ - 使用 CMake 查找使用 CLang 编译的 Boost

> ID：12715294
> 
> 赞同：6
> 
> 时间：2012-10-03T19:16:46.080
> 
> 标签：c++, boost, cmake, clang

我已经使用[rubenvb](http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win32/Personal%20Builds/rubenvb/clang-3.1-release/)的 CLang 构建在 Windows 上编译了 Boost 1.51.0。我实际上使用 MinGW 编译了 b2：

```
bootstrap mingw
... compiling b2 using mingw... 
```

然后我用 CLang 编译了库：

```
b2 toolset=clang stage --stagedir=. --build-type=complete --with-regex ... 
```

顺便说一句，即使我指定`--build-type=complete`lib 目录中没有 DLL，但我在某处读到 CLang 在 Windows 上的链接仍然存在问题，所以这可能是原因。无论如何，静态库对我来说很好。我得到了这些文件`%BOOST_ROOT%\lib`：

```
libboost_regex-clang31-1_51.lib
libboost_regex-clang31-d-1_51.lib
libboost_regex-clang31-mt-1_51.lib
libboost_regex-clang31-mt-d-1_51.lib
libboost_regex-clang31-mt-s-1_51.lib
libboost_regex-clang31-mt-sd-1_51.lib
libboost_regex-clang31-s-1_51.lib
libboost_regex-clang31-sd-1_51.lib 
```

现在，如果我从命令行用 CLang 编译一些东西，一切正常。当我尝试让 CMake 找到 Boost 库时，问题就出现了：它根本找不到它们。我试过这个 CMakeFiles.txt：

```
cmake_minimum_required (VERSION 2.8)
project(ccc)

# Setting/unsetting this does not change anything.
set(Boost_USE_STATIC_LIBS ON)

find_package(Boost COMPONENTS regex REQUIRED)

include_directories(${Boost_INCLUDE_DIR})
link_directories(${Boost_LIBRARY_DIRS})

add_executable(ccc main.cpp)

target_link_libraries(ccc
    ${Boost_REGEX_LIBRARY}
    ) 
```

使用 MinGW（和 Boost 的 MinGW 编译版本）构建它可以工作。如果我尝试使用 CLang（在设置`CC=clang`,`CXX=clang++`和之后`BOOST_ROOT=C:/misc/boost/clang-1_51_0`）它不会：

```
D:\Desktop\ppp>cmake -G "MinGW Makefiles" ..\ccc
-- The C compiler identification is Clang 3.1.0
-- The CXX compiler identification is Clang 3.1.0
-- Check for working C compiler: C:/misc/clang/bin/clang.exe
-- Check for working C compiler: C:/misc/clang/bin/clang.exe -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working CXX compiler: C:/misc/clang/bin/clang++.exe
-- Check for working CXX compiler: C:/misc/clang/bin/clang++.exe -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
CMake Error at C:/misc/cmake/share/cmake-2.8/Modules/FindBoost.cmake:1191 (message):
  Unable to find the requested Boost libraries.

  Boost version: 1.51.0

  Boost include path: C:/misc/boost/clang-1_51_0

  The following Boost libraries could not be found:

          boost_regex

  No Boost libraries were found.  You may need to set BOOST_LIBRARYDIR to the
  directory containing Boost libraries or BOOST_ROOT to the location of
  Boost.
Call Stack (most recent call first):
  CMakeLists.txt:5 (find_package)

CMake Error: The following variables are used in this project, but they are set to NOTFOUND.
Please set them or make sure they are set and tested correctly in the CMake files:
Boost_REGEX_LIBRARY (ADVANCED)
    linked by target "ccc" in directory D:/Desktop/ccc

-- Configuring incomplete, errors occurred! 
```

但是，如果我手动编译它再次工作：

```
clang++ main.cpp -I%BOOST_ROOT% -L%BOOST_ROOT%\lib -llibboost_regex-clang31-1_51
...Ok, and the executable works 
```

手动设置`BOOST_LIBRARYDIR`也不行。也不使用反斜杠`\`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T20:26:51.583

查看文件“C:/misc/cmake/share/cmake-2.8/Modules/FindBoost.cmake”，您可以找到与您可以使用的 Boost 相关的所有变量的列表。您需要的是`Boost_COMPILER`（`Boost_DETAILED_FAILURE_MSG`也可用于诊断问题）：

```
#   Boost_COMPILER               Set this to the compiler suffix used by Boost
#                                (e.g. "-gcc43") if FindBoost has problems finding
#                                the proper Boost installation 
```

# jquery-plugins - jquery插件冲突-显示无成为硬刷新的默认选项，但默认情况下不是

> ID：12715296
> 
> 赞同：0
> 
> 时间：2012-10-03T19:16:50.760
> 
> 标签：jquery-plugins, conflict

我正在使用两个 jquery 插件：

英雄轮播和内容悬停。

最初，当我加载页面时，内容悬停正常工作，但是当我在页面上执行硬刷新时，它似乎默认为 display:none。

我尝试禁用英雄轮播插件，这解决了问题，但我不知道两个插件之间的冲突可能在哪里。

我将粘贴所有代码，但这意味着粘贴两个巨大的 jquery 块，可以在[此处](http://tonysandwich.co.uk/mk1golf)找到处于当前状态的站点内容悬停插件当前位于滑块下方的左下角图像中。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:21:02.593

拿这两个脚本：

```
<script>
$(document).ready(function(){
    $('.hero-carousel').heroCarousel({
        easing: 'easeOutExpo',
         css3pieFix: true
    });
});
</script>
<script>
$('#d1').contenthover({
    overlay_background:'#F25342',
    overlay_opacity:0.8
});
</script> 
```

像这样把它们放在一起：

```
<script>
$(document).ready(function(){
    $('.hero-carousel').heroCarousel({
        easing: 'easeOutExpo',
        css3pieFix: true
    });

    $('#d1').contenthover({
        overlay_background:'#F25342',
        overlay_opacity:0.8
    });
}); 
</script> 
```

我没有看到任何脚本绑定您的第二个轮播功能。我也没有看到这里提供的缓动库：http: [//gsgd.co.uk/sandbox/jquery/easing/](http://gsgd.co.uk/sandbox/jquery/easing/)你需要它，因为你在上面的轮播函数中使用了缓动。

# javascript - 正则表达式删除脚本标签允许在 javascript 中的某些类型

> ID：12715297
> 
> 赞同：0
> 
> 时间：2012-10-03T19:16:56.730
> 
> 标签：javascript, regex

我需要一个类似的正则表达式

```
/<script[^>]*>([\\S\\s]*?)<\/script>/img 
```

我将用它来替换脚本标记，除非它与某种类型的脚本匹配，我们在我的应用程序中有配色方案并且必须通过，但必须删除注入任何其他内容。

这是允许的

```
<script type="colorScheme">..</script> 
```

必须删除其他任何内容，但我不能完全正确的正则表达式，我也不能在 dom 节点中转换它。

文档片段不保留头部和头部中包含的标签。你们在评论中请参阅[我可以将整个 HTML 文档加载到 Internet Explorer 中的文档片段中吗？](https://stackoverflow.com/questions/7474710/can-i-load-an-entire-html-document-into-a-document-fragment-in-internet-explorer)

万分感谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:17:50.743

据我了解，您需要的是一个匹配其中 XXX 可以是一组有效值的正则表达式。

如果是这种情况，您需要这样的正则表达式：

```
/<script type="(value1|value2|value3)">(.*?)<\/script>/img 
```

在 Javascript 中：

```
var regexp = /<script type="(value1|value2|value3)">(.*?)<\/script>/img;
var match = regex.exec(regexp);
console.log('type: ' + match[1]);
console.log('body: ' + match[2]); 
```

希望有帮助:)

# php - 在 composer 中指定 PSR-0 命名空间的根

> ID：12715300
> 
> 赞同：3
> 
> 时间：2012-10-03T19:16:59.760
> 
> 标签：php

我目前有以下 composer.json 文件：

```
{
    "require": {
        "slim/slim": "2.*"
    },
    "autoload": {
        "psr-0": { "App": "app/" }
    }
} 
```

我正在尝试在 app 文件夹中实例化一个类，但自动加载器正在寻找：

```
/var/www/framework/app//App/App.php 
```

显然第二个参数是包含命名空间的文件夹，而不是命名空间的根目录。我怎样才能让它加载：

```
/var/www/framework/app/App.php 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:45:08.497

最简单的解决方案是将文件夹从`app`to重命名`App`并设置

```
"psr-0": { "App": "." } 
```

我想你需要一个自定义的自动加载器。但是，我建议遵循一些经过验证的用例：

```
src/App/App.php 
```

和

```
"psr-0": { "App": "src" } 
```

看起来很奇怪，但我必须说，我永远不会只调用命名空间或类（甚至两者）`App`；）它什么也没说，并且使用别名 ( `use MyApplication as App`) 没有理由再写尽可能短的标识符。

# c++ - C++ 设计：带有布尔选项的函数

> ID：12715301
> 
> 赞同：5
> 
> 时间：2012-10-03T19:17:00.027
> 
> 标签：c++, boolean, flags

我有一个关于 C++ 中“良好设计实践”的问题。我正在用 C++11 编写一个数值库，并且我使用了大量的元编程和基于模板的技术。但我有一个非常基本的问题：

考虑一个可以有两个非常接近的行为的函数，除了一个可以由布尔标志激活的选项。我只考虑开发人员可以设置/取消设置的标志，而不考虑可以在运行时设置/取消设置的标志。有3种设计可能性：

* * *

1) 编写两个名称中带有显式选项的函数：

```
myFunctionFlag1(...);
myFunctionFlag2(...); 
```

2）使用模板参数：

```
template<bool Flag> myFunction(...); 
```

3）使用可变参数：

```
myFunction(..., const bool flag); 
```

* * *

就良好的设计实践而言，哪种解决方案可以接受/不可接受？如果有最好的解决方案，它是哪一个，为什么？如果有最坏的解决方案，它是哪一个，为什么？

编辑：对于所考虑的函数，运行时开销可以被认为是微不足道的，所以这不是最关键的一点。

编辑2：我知道这三个都有效。但由于我的图书馆会有用户，它需要有一个可靠/好的设计。

选项 2 是否常见（因为在我看来这是一个很好的折衷方案）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-03T19:31:52.073

以上都不是。布尔标志对代码的可读性很不利。如果标志控制的功能足够小以至于使用单个函数有意义，则使用单个函数，但不要`bool`用作标志的类型。相反，使用具有有用名称的枚举器的枚举：

```
enum class MyFunctionMode { EnableFoo, DisableFoo };

void myFunction(..., MyFunctionMode mode); 
```

这种模式使得在调用站点很容易理解为函数提供了哪些选项。可以使用标志组合多个选项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:24:20.550

我的建议是使用选项 1。

注释：

1.  最简单明了的。它没有运行时开销。
2.  我没有看到足够的理由（如果给出更多细节，可能仍然存在）使用这种方法。它比选项 1 更复杂。
3.  此变体具有运行时开销。它仍然可以在非时间/CPU 关键代码中使用。如果你的函数很大（超过 100 行），那么这个变体会变得更有吸引力，

我的 2 美分。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:26:36.447

您的第一个解决方案重复了代码，这是没有人愿意做的事情。

在第三个中是可以接受的，但 if 语句将在运行时进行评估，并且意味着浪费时间。

模板一似乎是合适的。if 语句将在编译时`if (true)`或`if (false)`在编译时出现，编译器将对其进行优化，就好像它们没有 if 语句一样。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T19:29:18.607

你可以做所有你知道的三个。

```
void fun_that_does_stuff();
void fun_that_does_something_else();

template < bool F >
void fun_that_does_stuff_or_something();
template < >
void fun_that_does_stuff_or_something<true>() { fun_that_does_stuff(); }

... blah blah. 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T19:44:06.613

复制非平凡代码是最糟糕的选择。如果这两个函数只是分派给实际有趣的函数，那么它可能是正确的选择。当然，这两个函数可以分派到模板版本，但它们可以更好地指示差异是什么，`true`或者`false`可以做什么。

另一个问题是函数的实际使用方式：如果它们本身是从具有相同配置或可以派生标志选择的配置的函数调用的，则使用不同的名称会变得相当烦人甚至不可维护：您最终会得到必须有条件地调用函数：

```
(flag? &myFunctionFlag1: &myFunctionFlag2)(...); 
```

其他两个版本之间的选择归结为一个问题：支票重要吗？如果是这样，则模板是唯一的选择。如果不是，您可以选择任何一个版本，我敢打赌，匿名投票会投票支持运行时版本：当我向他们展示一个微不足道的模板时，我的大多数同事的眼睛都会眨眨眼。

# c# - 我的（好？）以编程方式在 Excel 中制作下拉列表的方法（VSTO）

> ID：12715303
> 
> 赞同：0
> 
> 时间：2012-10-03T19:17:06.073
> 
> 标签：c#, excel, drop-down-menu, vsto

这是我为在 Excel 单元格中制作下拉列表而编写的方法，方法是从同一工作表/工作簿中的某个范围内获取可能的值。

```
private void MakeDropDownList(string strSrcSheetName, string strDestSheetName, string strSrcRange, string strDestCell)
    {
        var currentSheet = Application.Sheets[strDestSheetName];

        var inv = Application.Sheets[strSrcSheetName];

        var items = inv.Range[strSrcRange];

        var list_items = new List<string>();

        foreach (Excel.Range cell in items)
        {
            list_items.Add(cell.Value2.ToString());
        }

        Range xlsRange;
        xlsRange = currentSheet.Range[strDestCell];

        Excel.DropDowns xlDropDowns;
        Excel.DropDown xlDropDown;
        xlDropDowns = ((Excel.DropDowns)(currentSheet.DropDowns(Missing.Value)));
        xlDropDown = xlDropDowns.Add((double)xlsRange.Left, (double)xlsRange.Top, (double)xlsRange.Width, (double)xlsRange.Height, true);

        //Add item into drop down list
        for (int i = 0; i < list_items.Count; i++)
        {
            xlDropDown.AddItem(list_items[i], i + 1);
        }
    } 
```

要使用它，我可以像这样调用它：

```
MakeDropDownList("Units", "ReceiveBonds", "B1:B5", "E9:E18"); 
```

但是，最终的结果是这样的：

![Excel 下拉列表](../Images/c955b98aaac87ed196f5e44a37ca163e.png)

如您所见，下拉列表小于`E`列宽，**更糟糕的是，在我从下拉列表中选择一个值后，单元格保持其原始值**，即`Choose Unit`.

难道我做错了什么？

我想要的是：

*   要么让这个下拉列表看起来像 Excel 的常规验证下拉列表，要么。
*   能够触发事件将列表中的选定值设置到相应的单元格。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-01-23T11:32:34.113

之前加 的就行`ColumnWidth`了。

```
 if (checkModifiers() && (checkKey(Keys.F3)))
        {
            Workbook wb = Globals.ThisAddIn.Application.ActiveWorkbook;
            Worksheet ws = Globals.ThisAddIn.Application.ActiveSheet;
            Microsoft.Office.Interop.Excel.Range rng = (Microsoft.Office.Interop.Excel.Range)Globals.ThisAddIn.Application.ActiveCell;
            int row = rng.Row;
            int column = rng.Column;

            Range cell = ws.Cells[row, column];
            cell.ColumnWidth = 50;
            try
            {
                drd.Add("One");
                drd.Add("Two");
                drd.Add("Three");
                Microsoft.Office.Interop.Excel.DropDown xlDropDown;
                Microsoft.Office.Interop.Excel.DropDowns xlDropDowns;
                xlDropDowns = ((Microsoft.Office.Interop.Excel.DropDowns)(ws.DropDowns(Missing.Value)));
                xlDropDown = xlDropDowns.Add((double)cell.Left, (double)cell.Top, (double)cell.Width, (double)cell.Height, true);
                for (int i = 0; i < drd.Count; i++)
                {
                    xlDropDown.AddItem(drd[i], i+1);
                }
            }catch (Exception ex)
            {
                MessageBox.Show(ex.ToString());
            }
        } 
```

# php - PHP Prepared MySQL 语句已开始添加引号

> ID：12715308
> 
> 赞同：3
> 
> 时间：2012-10-03T19:17:28.950
> 
> 标签：php, mysql, mysqli

所以我一直在使用准备好的语句和一些项目，它是与 MySQL 数据库交互的一种非常好的干净方式，但今天我遇到了一个奇怪的问题。

我准备好的语句已经开始在 sql 语句中添加额外的 ' ，对于我来说，我不知道为什么......

所以这里是代码：

```
<?php

    $sortby="ORDER BY submit_date DESC";
    $offset = 3;

    $sql = "SELECT img_id, img_name, submit_date FROM tbl_images WHERE img_active='y' :sortby LIMIT :offset, 9";

    $stmt = $this->_db->prepare($sql);
    $stmt->bindParam(":sortby", $sortby, PDO::PARAM_STR);
    $stmt->bindParam(":offset", $offset, PDO::PARAM_INT);
    $stmt->execute();

?> 
```

所以上面没有返回任何东西，所以查看数据库日志，这就是查询的样子

```
SELECT img_id, img_name, submit_date FROM tbl_images WHERE img_active='y' 'ORDER BY submit_date DESC' LIMIT 3, 9 
```

它似乎在“ORDER BY submit_date DESC”周围放置了一组额外的''，但还没有围绕偏移量？

谁能发现这个问题让我发疯:)

先感谢您！

解决方案，感谢发帖的人，你是对的，我将字段分成几部分，就像一个魅力。下面的代码解决方案：

```
<?php

    $sortfield="submit_date";
    $sortway="DESC"
    $offset = 3;

    $sql = "SELECT img_id, img_name, submit_date FROM tbl_images WHERE img_active='y' ORDER BY :sortfield :sortway LIMIT :offset, 9";

    $stmt = $this->_db->prepare($sql);
    $stmt->bindParam(":sortfield", $sortfield, PDO::PARAM_STR);
    $stmt->bindParam(":sortway", $sortway, PDO::PARAM_STR);
    $stmt->bindParam(":offset", $offset, PDO::PARAM_INT);
    $stmt->execute();

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:26:42.593

查看以下文档[`mysqli_stmt::prepare`](http://www.php.net/manual/en/mysqli-stmt.prepare.php)：

> 标记仅在 SQL 语句中的某些位置是合法的。例如，它们可以在 INSERT 语句的 VALUES() 列表中使用（以指定行的列值），或者在与 WHERE 子句中的列进行比较以指定比较值时。

基本上，查询的任何结构都不允许成为绑定参数。这种方式只能发送数据。

PDO 的准备好的语句以相同的方式有效地工作。但是，在您的情况下，PDO 有点愚蠢，因为它在“模拟准备”模式下运行（这是默认设置，但您应该将其关闭以充分利用 PDO）。它基本上自己完成所有替换，而不是将查询和数据分别发送到服务器。它看到数据是一个字符串，并认为“啊哈，一个字符串：我需要在这个周围加上引号”。因此，您最终会得到格式错误的查询。

解决方案不是使用绑定参数构建查询的结构部分。要么用连接替换它们，要么（这更好）为不同的设置提供替代查询字符串。这是最安全的方式：任何涉及串联的事情都是不安全的秘诀。

哦，然后关闭 PDO 仿真准备！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:27:10.553

您想要 string interpolate `$sortby`，而不是将其绑定为转义和引用的 SQL 文字。

（但请注意不要插入不受信任的 SQL 片段！）

*参数绑定用于将文字值*替换为查询，我们通常指的是纯数字或字符串。参数不适用于 SQL 标识符（如表或列名），也不适用于语法元素。

PDO 被解释`$sortby`为文字字符串，这就是您要求它执行的操作：

```
SELECT ... WHERE image_active='y' 'literal string substituted here' ... 
```

您肯定会使用该查询生成语法错误。

有点令人困惑的是，MySQL*确实*允许 LIMIT 子句的参数占位符。这很方便，但对于那些熟悉其他 RDBMS 的人来说却是令人惊讶的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T19:19:49.133

使用 PDO，您不应在 WHERE 子句或 ON 子句之外使用准备好的语句绑定变量替换。如果你这样做了——任何字符串——都会被引用（正如他们应该的那样）。虽然 $offset 整数绑定可能有效，但您不应该这样做。您应该只用字符串替换该值（在将其与有效值的白名单数组进行比较之后）。

```
 $sql = "SELECT img_id, img_name, submit_date FROM tbl_images WHERE img_active='y' $sortby LIMIT $offset, 9"; 
```

# python - 试图识别目录中最新的和次新的文件

> ID：12715309
> 
> 赞同：2
> 
> 时间：2012-10-03T19:17:38.197
> 
> 标签：python

我正在尝试识别目录中最新的和第二个最新的文件。这是我打算使用的代码：

```
CONFIGS = "/Users/root/dev/config-files/"
allConfigs = sorted(os.listdir(CONFIGS), key=os.path.getctime)
t1 = "%s/%s" % (CONFIGS, allConfigs[-1])
t2 = "%s/%s" % (CONFIGS, allConfigs[-2]) 
```

我遇到了这个错误，我不知道为什么：

```
MBA:dev root$ python
Python 2.7.3 (default, Apr 19 2012, 00:55:09) 
[GCC 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2335.15.00)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
>>> import os
>>> CONFIGS = "/Users/root/dev/config-files/"
>>> allConfigs = sorted(os.listdir(CONFIGS), key=os.path.getctime)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/genericpath.py", line 64, in getctime
    return os.stat(filename).st_ctime
OSError: [Errno 2] No such file or directory: 'newest.txt'
>>> 
```

有人有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T19:18:41.707

`os.listdir`返回*相对*名称，因此您必须使用`os.path.join`使它们成为绝对名称：

```
allConfigs = sorted(os.listdir(CONFIGS),
    key=lambda p: os.path.getctime(os.path.join(CONFIGS, p)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-19T07:26:01.610

我认为它缺少右括号：

```
allConfigs = sorted(os.listdir(CONFIGS),
   key=lambda p: os.path.getctime(os.path.join(CONFIGS, p))) 
```

# jquery - socket.on() 和 socket.emit() 失败

> ID：12715310
> 
> 赞同：0
> 
> 时间：2012-10-03T19:17:45.503
> 
> 标签：jquery, node.js, socket.io, multiplayer

我正在努力做到这一点，当用户按下按钮时，div 的背景将为所有用户改变颜色。但这并没有发生。这是我的问题`socket.on`和`socket.emit`。这是我的代码。

**服务器端**

```
var express = require('express');
var routes = require('./routes');
var io = require('socket.io');

var app = express();
var server = require('http').createServer(app);

app.configure(...);

app.get('/', routes.index);

server.listen(3000, function(){
    console.log('Listening on port 3000');
});

//Attach socket.io
var io = io.listen(server);

io.sockets.on('connection', function (socket) {
    console.log('connection established');
    socket.on('background change event', function(button){
        console.log(button);
        if(button == 'button_1')
            socket.emit('background change', 'red');
        else if(button == 'button_2')
            socket.emit('background change', 'green');
        else if(button == 'button_3')
            socket.emit('background change', 'blue');
    });
}); 
```

**客户端**

```
var socket = io.connect();

$(document).ready(){
    var buttons = [$('#button_1'), $('#button_2'), $('#button_3')];
    $.each(buttons, function(i, val){
        val.click(function(){
            console.log('clicked ' + val.attr('id'));
            socket.emit('change background event', val.attr('id'));
        });
    });

    socket.on('change background', function(color){
        console.log(color);
        $('#change_my_background').css('background-color',color);
    });
}); 
```

当我连接到页面时，服务器会记录`connection established`下来，所以我们至少做到了这一点。然后我单击一个按钮，客户端记录`clicked button_1`，这是最后的记录。因此，问题似乎在于`socket.emit('change background event', val.attr('id'))`or `socket.on('background change event', function(button){...})`。

我曾尝试更改我的 socket.emit 语句以在一些 socket.io 示例中的对象中发送 id，但这也不起作用。**那么我需要改变什么来完成这项工作？**

PS这是我的版本信息：

```
node.js    0.8.11
express    3.0.0rc4
socket.io  0.9.10 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:39:13.487

在客户端，你有`socket.on("change background", function...)`而不是`background change`，这是你在服务器上执行的发射。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:41:07.963

在您的客户端代码中，事件`change background event`在它等待的服务器上被命名`background change event`

# ruby-on-rails - 验证表单中的虚拟属性：未定义的方法“有效？” for :name:Symbol

> ID：12715314
> 
> 赞同：0
> 
> 时间：2012-10-03T19:18:10.270
> 
> 标签：ruby-on-rails

在发送之前，我想验证是否存在表单中有两个字段。但问题是控制器的模型在数据库中没有这些字段，所以我尝试制作虚拟属性。我不太确定如何让它工作。

我尝试在模型中执行此操作，称为“Find_number”

```
class FindNumber < ActiveRecord::Base

    attr_accessor :name
    attr_accessor :original_number

    validates :name, presence: true
    validates :original_number, presence: true

end 
```

以及 Find_numbers 控制器的创建操作中的以下内容

```
def create
    @user = current_user
    client = Twilio::REST::Client.new(@user.twilio_account_sid, @user.twilio_auth_token)

    search_params = {}
      %w[in_postal_code near_number contains].each do |p|
        search_params[p] = params[p] unless params[p].nil? || params[p].empty?
      end

    local_numbers = client.account.available_phone_numbers.get('US').local
    @numbers = local_numbers.list(search_params)

    if :name.valid? && :original_number.errors.any?
        unless @numbers.empty?
        render 'find_numbers/show'
        else
        flash.now[:error] = "Sorry, We Couldn't Find Any Numbers That Matched Your Search! Maybe Something Simpler?"    
        render 'find_numbers/new'
        end
    else
    flash.now[:error] = "Sorry, We Couldn't Find Any Numbers That Matched Your Search! Maybe Something Simpler?"    
    render 'find_numbers/new'   
    end     
end 
```

当我输入信息时，我得到了错误

```
undefined method `valid?' for :name:Symbol 
```

我可能错误地调用了 :name 和 :original_number 属性，并且双 if then 语句看起来很新奇 :P。

如果：name.valid，我需要替换什么？&& :original_number.errors.any? ，以确保它验证？或者还有很多我想念的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:32:42.000

我认为您混淆了“控制器”和“模型”之间的界限。控制器对您编写的模型内部的验证一无所知。`FindNumbersController`控制器被调用和模型被调用这一事实`FindNumber`在共享功能方面并没有任何意义。

您需要使用传入的参数显式创建模型的实例，并让模型对实例执行验证

```
find_number = FindNumber.new(params.slice(:name, :original_number)) 
```

然后你可以询问整个实例是否有效

```
find_number.valid? 
```

或者特定字段是否有任何错误消息

```
find_number.errors[:field].any? 
```

所以，`:name.valid?`变成`find_number.errors[:name].empty?`和`:original_number.errors.any?`变成`find_number.errors[:original_number].any?`

# java - Java Networking：解释 Socket 中的 InputStream 和 OutputStream

> ID：12715321
> 
> 赞同：15
> 
> 时间：2012-10-03T19:18:40.973
> 
> 标签：java, sockets, inputstream, outputstream

我通过使用创建了一个服务器`ServerSocket`。之后，我使用创建了客户端`Socket`，并连接到该服务器。

之后，我用 InputStream 做“一些事情”，OutputStream 取自 Socket 对象。但是，我不太了解 inputStream 和 outputStream 。这是我的简单代码：

```
private Socket sock = null;
private InputStream sockInput = null;
private OutputStream sockOutput = null;

...
            String msg = "Hello World";
            byte[] buffer = null;

            try {
                sockOutput.write(msg.getBytes(), 0, test.length());
                sockOutput.write("Hello StackOverFlow".getBytes(), 0, test.length());
                buffer = new byte[test.length()];
                sockInput.read(buffer, 0, test.length());
                System.out.println(new String(buffer));
                sockInput.read(buffer, 0, test.length());
                System.out.println(new String(buffer));
            } catch (IOException e1) {
                e1.printStackTrace();
                } 
```

结果将是：“Hello World”和“Hello StackOverFlow”。

这是服务器端代码：

```
private int serverPort = 0;
    private ServerSocket serverSock = null;

    public VerySimpleServer(int serverPort) {
        this.serverPort = serverPort;

        try {
            serverSock = new ServerSocket(this.serverPort);
        }
        catch (IOException e){
            e.printStackTrace(System.err);
        }
    }

    // All this method does is wait for some bytes from the
    // connection, read them, then write them back again, until the
    // socket is closed from the other side.
    public void handleConnection(InputStream sockInput, OutputStream sockOutput) {
        while(true) {
            byte[] buf=new byte[1024];
            int bytes_read = 0;
            try {
                // This call to read() will wait forever, until the
                // program on the other side either sends some data,
                // or closes the socket.
                bytes_read = sockInput.read(buf, 0, buf.length);

                // If the socket is closed, sockInput.read() will return -1.
                if(bytes_read < 0) {
                    System.err.println("Server: Tried to read from socket, read() returned < 0,  Closing socket.");
                    return;
                }
                System.err.println("Server: Received "+bytes_read
                                   +" bytes, sending them back to client, data="
                                   +(new String(buf, 0, bytes_read)));
                sockOutput.write(buf, 0, bytes_read);
                // This call to flush() is optional - we're saying go
                // ahead and send the data now instead of buffering
                // it.
                sockOutput.flush();
            }
            catch (Exception e){
                System.err.println("Exception reading from/writing to socket, e="+e);
                e.printStackTrace(System.err);
                return;
            }
        }

    }

    public void waitForConnections() {
        Socket sock = null;
        InputStream sockInput = null;
        OutputStream sockOutput = null;
        while (true) {
            try {
                // This method call, accept(), blocks and waits
                // (forever if necessary) until some other program
                // opens a socket connection to our server.  When some
                // other program opens a connection to our server,
                // accept() creates a new socket to represent that
                // connection and returns.
                sock = serverSock.accept();
                System.err.println("Server : Have accepted new socket.");

                // From this point on, no new socket connections can
                // be made to our server until we call accept() again.

                sockInput = sock.getInputStream();
                sockOutput = sock.getOutputStream();
            }
            catch (IOException e){
                e.printStackTrace(System.err);
            }

            // Do something with the socket - read bytes from the
            // socket and write them back to the socket until the
            // other side closes the connection.
            handleConnection(sockInput, sockOutput);

            // Now we close the socket.
            try {
                System.err.println("Closing socket.");
                sock.close();
            }
            catch (Exception e){
                System.err.println("Exception while closing socket.");
                e.printStackTrace(System.err);
            }

            System.err.println("Finished with socket, waiting for next connection.");
        }
    }

    public static void main(String argv[]) {
        int port = 54321;
        VerySimpleServer server = new VerySimpleServer(port);
        server.waitForConnections();
    } 
```

我的问题是：

1.  当我使用时`sockOutput.write`，我可以通过`sockInput.read`. 所以，那些消息已经被保存了，对吧？如果这是真的，它是保存在我创建的服务器上还是刚刚保存在其他东西中，例如`Socket Object`.

2.  如果我已写入套接字 String A1, A2,... An 那么我将分别收到 A1, A2, ... An String，对吗？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2012-10-03T19:49:05.927

套接字是一种抽象，您可以使用它通过网络与某些东西进行通信。见下图...

在 Java 中，要通过套接字发送数据，您会从其中获取`OutputStream`(1)，然后写入`OutputStream`（输出一些数据）。

要从套接字读取数据，您需要获取它的`InputStream`, 并从第二个流中读取输入。

您可以将流视为连接到墙上插座的一对*单向管道。*墙的另一边发生的事情不是你的问题！

在您的情况下，服务器有另一个套接字（连接的另一端）和另一对流。它使用它的`InputStream`(2) 从网络读取数据，并使用它的`OutputStream`(3) 通过网络将*相同*的数据写回您的客户端，客户端通过它的`InputStream`(4) 完成往返再次读取它。

```
 Client                                                     Server

1\. OutputStream -->\                                     /--> 2\. InputStream -->
                    Socket <--> network <--> ServerSocket                       |
4\. InputStream  <--/                                     \<--3\. OutputStream <-- 
```

**更新：**回复评论：

请注意，流和套接字只发送原始字节；在这个抽象级别，他们没有“消息”的概念。因此，如果您发送 X 字节和另一个 X 字节，然后读取 X 字节并读取另一个 X 字节，那么您的系统就像有两条消息一样，因为这就是您划分字节的方式。

如果您发送 X 字节和另一个 X 字节，然后读取长度为 2X 的回复，那么您*可能*能够读取单个组合“消息”，但正如您所注意到的，流的底层实现可以选择何时传递字节块，因此它可能会返回 X 字节，然后 X 字节，稍后，或一次 2X，或 0.5X 四次......

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-03T19:25:07.147

`InputStream`并且`OutputStream`是两个完全独立的流。您写入其中的内容与您从另一个中读取的内容没有*先验*关系。`InputStream`为您提供服务器决定发送给您的任何数据。我还想评论您的这段代码：

```
sockOutput.write(msg.getBytes(), 0, test.length());
sockOutput.write("Hello StackOverFlow".getBytes(), 0, test.length()); 
```

您使用字符串的长度`test`（代码中未显示），这与您作为第一个参数传递的字节数组无关。这可能会导致`ArrayIndexOutOfBoundsException`您预期的消息被截断或截断。

## 对您更新的问题的附加评论

查看您的服务器端代码，它的编写并不完全正确。您需要`try { handleConnection(...); } finally { socket.close(); }`确保在发生错误后以及正常完成时进行适当的清理。您的代码永远不会关闭服务器端的任何内容。

最后，也是最关键的一点，您的整个代码的编写方式可能会导致死锁。通常你需要一个单独的线程来读写；否则可能会发生以下情况：

1.  您尝试将一些数据写入输出；
2.  服务器读取它并尝试响应您输入的数据；
3.  但是，由于缓冲区太小，您无法发送所有内容，因为服务器想先发送一些内容给您，然后接收其余内容；但是在您发送所有您拥有的东西之前，您不会到达接收部分。

# jquery - '$' 未定义

> ID：12715325
> 
> 赞同：1
> 
> 时间：2012-10-03T19:19:18.513
> 
> 标签：jquery

无论我是否将 jQuery $.ajax 调用放入 a 中，我都会收到此错误 `$(document).ready(function() {`。这是在 ASP.NET MVC .cshtml 文件上。

```
 <script type="text/javascript">
    $(document).ready(function() {

        $.ajax({
            url: '/api/courses',
            success: function(data) {
                var list = $('#courses');
                for (var i = 0; i < data.length; i++) {
                    var course = data[i];
                    list.append('<li id="' + course.id + '">' + course.name + '</li>');
                }
            }
        });
    }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T19:22:52.177

确保首先引用 JQuery。类似于（使用 MS CDN）：

```
<script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.2.min.js" type="text/javascript"></script> 
<script type="text/javascript">
    $(document).ready(function() {
        $.ajax({
            url: '/api/courses',
            success: function(data) {
                var list = $('#courses');
                for (var i = 0; i < data.length; i++) {
                    var course = data[i];
                    list.append('<li id="' + course.id + '">' + course.name + '</li>');
                }
            }
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-27T15:44:12.477

在具有 IE 11 的本地网络上的服务器上，它也可能是兼容性视图问题。

有关更多详细信息，请参阅我对这个问题的回答：['$' 未定义。如何在空的 ASP.NET MVC 4 项目中使用 jQuery 2.0.1？](https://stackoverflow.com/questions/16862643/is-undefined-how-to-use-jquery-2-0-1-in-empty-asp-net-mvc-4-project/24455736#24455736)

# php - 我无法从 XML 文件中读取代码

> ID：12715326
> 
> 赞同：0
> 
> 时间：2012-10-03T19:19:18.417
> 
> 标签：php, xml, xmldom

我已将 javascript 代码保存在 xml 文件中。但是当我得到它时显示为空的 xml 标记。

**XML 代码**

```
<ad>
  <Name> Ad 1 </Name>
  <place> 1 </place>
  <Type> code </Type>
  <content>
     <script type="text/javascript">
      <!--
        google_ad_client = "pub-*********";
        /* 160x600, 28/08/09 */
        google_ad_slot = "*********";
        google_ad_width = 160;
        google_ad_height = 600;
      //-->
     </script>
     <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
     </script>
  </content>
</ad> 
```

`content`当我使用 PHP DOMDocument获取标签时，我发现它是空的，当我检查页面源代码时，我发现它是空的，不存在 javascript。虽然当我带来另一个标签的值时，如`Name`,`Type`显示没有问题。我对 PHP 代码毫无疑问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:22:10.690

您的 XML 无效。

引号必须是`&quot;`等等，在你的 JavaScript 中。如果您不想这样做，则必须将其包装在 CDATA 块中。

```
<script>
<![CDATA[
    ...code...
]]>
</script> 
```

[https://stackoverflow.com/a/66900/362536](https://stackoverflow.com/a/66900/362536)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:03:35.893

解决方案是我们必须`<![CDATA[`在所有 javascript 之前和所有 javascript`]]>`之后添加，如下所示：

```
<![CDATA[
    <script type="text/javascript">
     <!--
     google_ad_client = "pub-***********";
     /* 160x600, 28/08/09 */
     google_ad_slot = "-***********"";
     google_ad_width = 160;
     google_ad_height = 600;
     //-->          
   </script>
   <script type="text/javascript"
    src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
   </script>
]]> 
```

最终形式如下：

```
<ad>
  <Name> Ad 1 </Name>
  <place> 1 </place>
  <Type> code </Type>
  <content>
   <![CDATA[
     <script type="text/javascript">
      <!--
        google_ad_client = "pub-*********";
        /* 160x600, 28/08/09 */
        google_ad_slot = "*********";
        google_ad_width = 160;
        google_ad_height = 600;
      //-->
     </script>
     <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
     </script>
    ]]>
  </content>
</ad> 
```

# git - 我可以将 git 暂存区域的更改发送到代码审查（到任何代码审查工具）吗？

> ID：12715330
> 
> 赞同：3
> 
> 时间：2012-10-03T19:19:30.147
> 
> 标签：git, git-commit

我了解到 git 有不同文件状态的概念： 1\. 新 2\. 修改 3\. 暂存 4\. 已提交

经过大量搜索后，我发现如果我想将代码审查发送到任何工具，我必须提交到本地存储库并将其推送到某个中央存储库集以进行代码审查（通过任何代码审查工具，例如 Gerrit） .

现在，假设文件在开始代码审查过程之前处于状态 A，并且它经历了 10 次以上的审查返工，即 10 次以上的修改，即 10 次以上的本地存储库提交，最后文件处于状态 B，最终应该被提交。

从状态 A 到 B 完成了 10 次提交。

假设这 10 个，4 个提交位于文件的同一部分/部分。

所以，最后，当我将审查并接受文件的最终状态 B 推送到主中央存储库时，我将不得不进行 10 次提交，其中一些中间提交需要返工，即不需要的提交。

但我不想要那些不需要的提交。

据我所知，我对最终状态 B 感兴趣，只需一次提交即可将其推送到存储库。

所以我正在寻找任何这样的方法/工具，它允许发送 git 分阶段的更改以供审查。审稿人将审阅。如果他拒绝并建议一些更改，那么我会取消之前的更改。应用建议的更改，暂存这些更改并再次发送以供审核。

因此，最终当代码审查接受时，我将进行一次提交我的分阶段更改，并且只需要一次最终推送。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:29:17.683

无法在 git 存储库中推送未提交的更改。但是，您可以使用不同的分支来实现您想要的。您可以在开发分支上工作，并根据需要进行尽可能多的提交。您可以将它们推送到远程服务器上的某个开发分支。审阅者接受更改后，您可以将提交合并到主分支中。如果需要，可以使用 git rebase将提交[合并](https://stackoverflow.com/questions/4936778/git-merge-commits)为一个提交。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-24T13:42:56.710

```
git push origin stash@{0}^1:refs/heads/tmp/for-code-review 
```

这将推动您的隐藏*索引*可供审查

*   将“origin”替换为其他人可以访问的任何遥控器
*   将“@{0}”替换为您想要查看的任何存储编号
*   如果您希望查看隐藏的*文件系统*更改，请删除“^1”部分。
*   如果您希望查看隐藏的索引和隐藏的文件系统，请先推送索引（使用 ^1），然后推送非索引（无 ^1）。

* * *

以下是为什么最好使用独特创建的单独分支的原因：

*   如果代码审查通过，您可能会在某处合并您的更改。你不能将 stash 合并到任何东西中。
    *   父母的历史是丑陋的。您的两个存储提交都共享同一个父级。“WIP”在技术上是一个合并提交，但这并不能真正说明正在发生的事情。
    *   提交消息很糟糕。
*   有了一个分支，您实际上可以根据代码审查的反馈更改您的代码——这就是代码审查的全部意义所在。你可以添加更多的提交、删除提交、rebase、squash 等等。你不能用 stash 来做到这一点。（或变基等）

对我来说，我觉得我真的不需要“说服”任何人使用分支，因为每个尝试使用像这样（或其他方式）的 stash 的人都会自己发现正确/更好/更简单的方法是只需使用侧分支进行工作/代码审查。又名`git branch bugfix/xyz; edit...; git push origin bugfix/xyz;`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T14:50:39.447

我相信大多数代码审查工具都会有差异，所以只需使用“git diff”来生成要审查的代码的适当差异。

至于将您的多个提交合并为一个，嗯，有不止一种方法可以做到：

1.  您可能想在[手册页](https://www.kernel.org/pub/software/scm/git/docs/git-merge.html)上`--squash`查看`git merge`. 或阅读[这篇](https://stackoverflow.com/questions/5308816/how-to-use-git-merge-squash)SO 文章。

2.  或者，您可以在您的 dev 分支上本地执行您想要的所有提交，但在合并到主线之前，使用`git rebase`将它们压缩在一起。有关详细信息，请参阅[手册页](https://www.kernel.org/pub/software/scm/git/docs/git-rebase.html)或阅读[此](https://stackoverflow.com/questions/4936778/git-merge-commits)SO 文章。

# servlets - 如何在 java 中为 Servlet 上下文添加别名？

> ID：12715331
> 
> 赞同：2
> 
> 时间：2012-10-03T19:19:31.847
> 
> 标签：servlets, static, context.xml, aliases

我有一个在 Tomcat 下运行的 servlet。我需要提供一些文件，我想我们可以从外部（到 WEB-APP）目录中将它们称为半静态的（偶尔会更改......它们由应用程序的另一部分更新）。我设法通过将以下内容添加到 META-INF 目录中的 context.xml 来做到这一点

```
<Context aliases="/working_dir=c:/apache_tomcat_working_dir" ></Context> 
```

这很好用，在我的 HTML 中，我将文件称为

```
<img src="/myWebbApp/working_dir/fixpermin_zoom.png"> 
```

在我的 web.xml 里面 WEB-INF 我让默认服务器处理 png 文件如下

```
<!-- use default for static serving of png's, js and css, also ico -->
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.png</url-pattern>
</servlet-mapping> 
```

所以这很好用。但我想从 java 代码内部设置外部目录，而不是通过编辑 context.xml 文件。

现在在`init()`servlet 的方法中我可以得到 ServletContext。

```
 ServletContext sc =  getServletContext(); 
```

如果我在调试器中检查这个变量`sc`，我可以看到几个级别的别名字符串，请参见附图。如何以编程方式获取此别名字符串？我已经检查了 ServletContext 文档，但我找不到它很有帮助。非常感谢任何帮助。

[![serverletcontext 的调试视图](../Images/907b8cf265474464ef5a03853ce31b36.png)](https://i.stack.imgur.com/HsvER.png)
[（来源：[choicecomp.com](http://choicecomp.com/javadebugging/jdebug2.png)）]

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-06T20:07:55.120

这是我根据不同操作系统动态设置 Tomcat7 上下文别名的工作代码。当然你可以改进它

```
public class ContextListener implements ServletContextListener {
@Override
public void contextInitialized(ServletContextEvent sce) {
    ServletContext context = sce.getServletContext();

    // tomcat 7.x
    try {
        MBeanServer mBeanServer = MBeanServerFactory.findMBeanServer(null).get(0);
        ObjectName name = new ObjectName("Catalina", "type", "Server");
        Object server = mBeanServer.getAttribute(name, "managedResource");

        Object service = server.getClass().getMethod("findService", String.class).invoke(server, "Catalina");  //StandardService[Catalina]
        Object connectors = service.getClass().getMethod("findConnectors").invoke(service);
        Object engine = service.getClass().getMethod("getContainer").invoke(service);  //StandardEngine[Catalina]
        Object host = Array.get(engine.getClass().getMethod("findChildren").invoke(engine), 0);  //StandardHost[Catalina]
        Object stdContext = Array.get(host.getClass().getMethod("findChildren").invoke(host), 0);  //StandardContext[Catalina]
        Object mapper = stdContext.getClass().getMethod("getMapper").invoke(stdContext);
        //just a clean up step(remove the host)
        Field f1 = mapper.getClass().getDeclaredField("context");
        f1.setAccessible(true);
        Object ct = f1.get(mapper);

        Field f2 = ct.getClass().getDeclaredField("resources");
        f2.setAccessible(true);
        Object rs = f2.get(ct);

        Field f3 = rs.getClass().getDeclaredField("dirContext");
        f3.setAccessible(true);
        Object dc = f3.get(rs);

        mapper.getClass().getMethod("removeHost",String.class).invoke(mapper, host.getClass().getMethod("getName").invoke(host));
        //add the host back with all required aliases
        switch (OsCheck.getOperatingSystemType()) {
            case Windows:
                dc.getClass().getMethod("setAliases",String.class).invoke(dc,"/img/avatars=" + winAvatarAlias);
                break;
            default:
                dc.getClass().getMethod("setAliases",String.class).invoke(dc,"/img/avatars=" + linuxAvatarAlias);
                break;
        }
        String ports = "";
        for (Object o :(Object[]) connectors ) {
            ports = ports + (Integer)o.getClass().getMethod("getPort").invoke(o) + " ";
        }
        log.info("Tomcat 7.x detected, service {}, engine {}, host {}, stdContext {}, server port: {}",
                service.getClass().getMethod("getName").invoke(service),
                engine.getClass().getMethod("getName").invoke(engine),
                host.getClass().getMethod("getName").invoke(host),
                stdContext.getClass().getMethod("getDisplayName").invoke(stdContext),
                ports);
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

}

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-04T15:01:54.177

我找到了另一种方法`StandardContext.setAliases`。在下面找到 Tomcat 7.0.30 的完整工作代码片段。

```
 MBeanServer mBeanServer = MBeanServerFactory.findMBeanServer(null).get(0);
        ObjectName name = new ObjectName("Catalina", "type", "Server");
        Server server = (Server) mBeanServer.getAttribute(name, "managedResource");
        StandardEngine engine = (StandardEngine) server.findService("Catalina").getContainer();
        StandardContext context = (StandardContext) engine.findChild(engine.getDefaultHost()).findChild(getServletContext().getContextPath());
        context.setAliases("myAlias");
        //infact aliases should be proper e.g. below 
        //context.setAliases("/aliasPath1=docBase1,/aliasPath2=docBase2");
        Mapper mapper = context.getMapper();
        mapper.removeHost(engine.getDefaultHost());
        mapper.addHost(engine.getDefaultHost(), new String[]{"myAlias"}, engine.getDefaultHost());
        mapper.addHostAlias(engine.getDefaultHost(), "myAlias");
        //infact aliases should be proper e.g. below 
        //mapper.addHostAlias(engine.getDefaultHost(), "/aliasPath1=docBase1,/aliasPath2=docBase2"); 
```

请在下面找到我的调试器屏幕截图：

在代码片段执行之前： ![在此处输入图像描述](../Images/d2e6788f787650676f6468f11bb31c25.png) ![在此处输入图像描述](../Images/f3e791b08982693408a021cb84896bfd.png)

代码片段执行后： ![在此处输入图像描述](../Images/c0e50978fb3113c2f33c3c62e198d541.png) ![在此处输入图像描述](../Images/2eac8be0d3a8669d2550bc00339dd898.png)

希望这更有帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T19:44:13.010

正如您在调试器中看到的，您的上下文是 Tomcat 的上下文对象`org.apache.catalina.core.StandardContext`

您可以在 Tomcat 6 及以下版本中尝试以下步骤：

```
 StandardEngine engine = (StandardEngine) ServerFactory.getServer().findService("Catalina").getContainer();
    StandardContext context = (StandardContext) engine.findChild(engine.getDefaultHost()).findChild(getServletContext().getContextPath());
    Mapper mapper = context.getMapper(); 
```

`addHostAlias(String HostName, String alias)`现在您可以使用Mapper 类的方法添加主机别名。

```
 mapper.addHostAlias(engine.getDefaultHost(), "myAlias"); 
```

这是 Tomcat 7 的代码片段：

```
 MBeanServer mBeanServer = MBeanServerFactory.findMBeanServer(null).get(0);
    ObjectName name = new ObjectName("Catalina", "type", "Server");
    Server server = (Server) mBeanServer.getAttribute(name, "managedResource");
    StandardEngine engine = (StandardEngine) server.findService("Catalina").getContainer();
    StandardContext context = (StandardContext) engine.findChild(engine.getDefaultHost()).findChild(getServletContext().getContextPath());
    Mapper mapper = context.getMapper();
    mapper.addHostAlias(engine.getDefaultHost(), "myAlias"); 
```

如果映射器中没有主机，请尝试以下操作：

```
 MBeanServer mBeanServer = MBeanServerFactory.findMBeanServer(null).get(0);
    ObjectName name = new ObjectName("Catalina", "type", "Server");
    Server server = (Server) mBeanServer.getAttribute(name, "managedResource");
    StandardEngine engine = (StandardEngine) server.findService("Catalina").getContainer();
    StandardContext context = (StandardContext) engine.findChild(engine.getDefaultHost()).findChild(getServletContext().getContextPath());
    Mapper mapper = context.getMapper();
    //just a clean up step(remove the host)
    mapper.removeHost(engine.getDefaultHost());
    //add the host back with all required aliases 
    mapper.addHost(engine.getDefaultHost(), new String[]{"myAlias"}, engine.getDefaultHost()); 
```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-07-08T16:00:34.517

基于 Khanh 的方法，这是一个适用于嵌入式 maven tomcat (v.7.0.62) 的上下文侦听器。

请注意差异（“Tomcat”而不是“Catalina”并且没有 findService(“Catalina”)），以便该方法适用于嵌入式 tomcat。与 Khanh 相比，我使用常规方法而不是反射来获取 BaseDirContext 对象。

最后，您应该注意，您需要在 BaseDirContext 对象而不是 StandardContext 对象上调用 setAliases()！在内部，StandardContext 的 setAliases() 只是一个 setter，而 BaseDirContext 的 setAliases() 做了很多其他的事情，因此已经运行的 tomcat 确实注册了您的新别名。

```
import org.apache.catalina.Container;
import org.apache.catalina.Server;
import org.apache.catalina.Service;
import org.apache.catalina.core.StandardContext;
import org.apache.catalina.core.StandardEngine;
import org.apache.log4j.Logger;
import org.apache.naming.resources.BaseDirContext;
import org.apache.naming.resources.ProxyDirContext;

import javax.management.MBeanServer;
import javax.management.MBeanServerFactory;
import javax.management.ObjectName;
import javax.servlet.ServletContext;
import javax.servlet.ServletContextEvent;
import javax.servlet.ServletContextListener;

public class AliasesContextListener implements ServletContextListener {
    private static Logger log = Logger.getLogger(AliasesContextListener.class);

    @Override
    public void contextInitialized(ServletContextEvent sce) {
        try {
            String aliases = "/foo=C:\\bar";

            //get current tomcat server, engine and context objects
            MBeanServer mBeanServer = MBeanServerFactory.findMBeanServer(null).get(0);
            ObjectName name = new ObjectName("Tomcat", "type", "Server");
            Server server = (Server) mBeanServer.getAttribute(name, "managedResource");
            Service[] services = server.findServices();
            StandardEngine engine = (StandardEngine) services[0].getContainer();
            Container defaultHostContainer = engine.findChild(engine.getDefaultHost());

            ServletContext servletContext = sce.getServletContext();
            StandardContext standardContext = (StandardContext) defaultHostContainer.findChild(servletContext.getContextPath());
            ProxyDirContext proxyDirContext = (ProxyDirContext) standardContext.getResources();
            BaseDirContext baseDirContext = (BaseDirContext) proxyDirContext.getDirContext();

            //modify the aliases entry
            baseDirContext.setAliases(aliases);
        } catch (Exception e) {
            log.error("error while setting aliases in context listener", e);
        }
    }

    @Override
    public void contextDestroyed(ServletContextEvent sce) {
        //not implemented
    }
} 
```

# neural-network - 神经网络，一个简单的计数器

> ID：12715332
> 
> 赞同：0
> 
> 时间：2012-10-03T19:19:34.690
> 
> 标签：neural-network

是否可以创建一个 ANN，它在输出中获取一些数据只是增加一些计数器？例如，每次传递都会增加使用 4 个输出神经元的二进制表示给出的数字。我记得读过给定相同的输入，输出应该相同。那有可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T13:47:54.390

如果坚持神经网络的原始概念，我认为这实际上是不可能的，神经网络是函数的组合，每个函数都将前一层输出的加权和作为输入并产生单个输出值。通常训练权重以在某些输入值上重现已知输出。我相信您指的是反向传播算法以某种方式更新权重，并且使其中一个权重作为*计数器*工作的想法实际上没有任何意义。

# c# - 使用按错误顺序排序的指令

> ID：12715340
> 
> 赞同：70
> 
> 时间：2012-10-03T19:20:24.603
> 
> 标签：c#, visual-studio-2012, powercommands

我在 Visual Studio 2012 中使用 Power Commands 扩展。我选中了选项以在保存时删除和排序使用。问题是 System.Xxx 指令最后排序，这导致了样式分析错误：

> SA1208：系统 using 指令必须放在所有其他 using 指令之前。

**保存前：**

```
using System;
using System.Diagnostics.CodeAnalysis;
using Foo; 
```

**保存后：**

```
using Foo;
using System;
using System.Diagnostics.CodeAnalysis; 
```

这在 VS 2010 中可以正常工作（首先是 System.Xxx）。有人知道如何纠正这个问题吗？

注意：即使它没有导致 SA 错误，我仍然希望系统指令优先。

* * *

## 回答 #1

> 赞同：146
> 
> 时间：2012-10-03T19:26:19.633

转到“快速启动”（Ctrl+Q）并键入“使用”并按`Enter`。

然后更改以下设置：

![使用排序选项](../Images/461f0a363e81793f9837fc2269ffec62.png)

这是一个令人讨厌的默认设置，我不知道微软为什么选择它，它违背了我见过的所有以前的标准。

**编辑：** 感谢[奥斯卡](https://stackoverflow.com/users/83111/oskar)，我们有一个[理由](https://connect.microsoft.com/VisualStudio/feedback/details/775702/organize-usings-no-longer-puts-system-references-first-bug-or-feature-change)：

> 默认行为发生变化的原因是 Windows App Store 应用程序更喜欢使用“Windows. *' 在文件的顶部，而不是 'System.* '

# tomcat - 请求上下文路径 Grails Spring Security

> ID：12715341
> 
> 赞同：0
> 
> 时间：2012-10-03T19:20:28.840
> 
> 标签：tomcat, grails, nginx, spring-security

基本问题是我们是否需要以 ROOT.war 的身份运行我们的战争，才能通过 Spring Security 获得正确的上下文路径？

背景：

我们有一个使用 spring 安全插件的 grails 应用程序。它由 nginx 代理，并且战争没有在 tomcat 中作为 ROOT.war 运行。

```
Web site: https://www.example.com
Login: https://www.example.com/login 
```

战争名称是 foo.war 并且 nginx 正在代理请求到`http://tomcat:8080/foo`

Spring 安全性正在使用：`${request.contextPath}`

我们是否将应用程序安装为 ROOT.war，或者我们可以修改 grails spring security 中的上下文路径变量？

在路径中使用 /foo 设置了 spring security auth cookies ...并且我们的会话管理无法正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T23:05:36.227

@Ian-Roberts 是正确的。

你不能只使用`grails.app.context = '/foo'`or `grails.app.context = '/'`。我似乎 Tomcat 搞乱了应用程序上下文，所以你必须将它作为 ROOT.war 运行。

指示：

*   您确实需要`grails.app.context = '/'`在 Config.groovy 中才能执行 grails run-app
*   圣杯战争 ROOT.war
*   将您的战争文件复制到您的 tomcat webapps 文件夹中的 ROOT.war 中。
*   创建一个 ROOT.xml 文件

$TOMCAT_CONF/Catalina/localhost 中的 ROOT.xml

```
<Context path="" antiResourceLocking="false" privileged="true" >
                  <Resource name="jdbc/****x" 
              auth="Container" 
              type="javax.sql.DataSource"
              maxActive="300" 
             edited :)
              />
           <Resource name="jdbc/***" 
              auth="Container" 
             edited :)
            />
</Context> 
```

因为我收到了 URL 映射错误。哦，不要试图在 AppBase 之外进行战争，因为 tomcat 不会扩展它，所有的地狱都会爆发:)

# objective-c - MRC中的ARC __block行为等效？

> ID：12715342
> 
> 赞同：0
> 
> 时间：2012-10-03T19:20:31.787
> 
> 标签：objective-c, automatic-ref-counting, objective-c-blocks

如您所知，在 ARC 中，`__block`块中使用的对象指针类型的变量由块保留。因此，采取以下简化示例：

```
__block id foo = getObject();
void (^aBlock)() = ^ {
    NSLog(@"%@", foo);
    foo = getObject();
}
runBlockAsynchronouslyMultipleTimes(aBlock); 
```

所指向的对象`foo`由块保留，这样当块运行（异步）时，该对象仍然有效并且可以打印。当我们在块内进行赋值时，ARC 像任何其他强引用一样管理它（旧值被释放，新值被保留）。（分配迫使我们首先使用`__block`。）当不再需要该块时，ARC 以某种方式释放其`foo`在该点指向的保留对象（它没有泄漏）。

好的，现在假设我想在 MRC 下做同样的事情（为什么不重要；这是关于语言的问题）。如您所知，`__block`块中使用的对象指针类型的变量不会被 MRC 中的块保留。这很好；我们将自己管理它（毕竟这是 MRC）。所以尝试看起来像这样：

```
__block id foo = [getObject() retain];
void (^aBlock)() = ^ {
    NSLog(@"%@", foo);
    [foo release];
    foo = [getObject() retain];
}
runBlockAsynchronouslyMultipleTimes(aBlock);
// where to release foo? 
```

大部分都是直截了当的——对象最初是由我们手动保留的；在块内部，当我们重新分配指针时，我们会酌情释放并保留新值。

但随之而来的问题是：当块不再需要时，我们如何释放对象？由于我们手动管理内存，理想情况下我们应该在块被释放时手动释放对象。但似乎没有一个简单的方法可以做到这一点。

我可能会想到一种方法：使用关联引用将对象绑定到块。但是然后要重新分配块内的关联引用，块需要对自身的引用，因此块变量也需要，`__block`并且在设置变量之前需要复制块。这一切都很丑陋。或者，我们将对象放在一个可变的容器对象中，然后由块保留；但这也很丑陋。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:11:23.763

可变容器尽可能干净。您可以创建一个带有单个`object`属性的简单包装器来稍微清理它，然后您将从属性访问器中获得内存管理。

一种看起来更干净但实际上有点混乱的方法是拥有一个不可变的包装器，它接受一个指针，并在释放该指针时释放该指针。

```
@interface ObjectReleaser : NSObject {
    id *objectPointer;
}
- (id)setObjectPointer:(id *)pointer;
- (void)captureMe;
@end

@implementation ObjectReleaser
- (void)setObjectPointer:(id *)pointer {
    if(!objectPointer && pointer) {
        objectPointer = pointer;
        [*objectPointer retain];
    }
}
- (void)dealloc {
    if(objectPointer) [*objectPointer release];
    [super dealloc];
}
- (void)captureMe {} // Blocks can call this to capture the object
@end 
```

该块将捕获并保留该对象，因为它不是`__block`. 您将`__block`像往常一样修改您的对象，使用所有正确`retain`的 s 和`release`s。然后，当块被释放时，它将释放释放器，然后释放器将被释放并释放指针当前指向的任何东西。

```
__block id foo = getObject();
ObjectReleaser *releaser = [[ObjectReleaser alloc] init];
void (^aBlock)() = ^ {
    [releaser captureMe];
    NSLog(@"%@", foo);
    [foo release];
    foo = [getObject() retain];
}
aBlock = [aBlock copy];
[releaser setObjectPointer:&foo]; 
```

请注意，您不需要`foo`仅为块保留，因为发布者会为您执行此操作。您*必须*在复制块*后*设置释放者的指针，因为副本会更改`foo`' 的指针。这也是为什么在函数返回后保存堆栈变量的指针是安全的：该变量实际上并不在堆栈上。

# asp.net - 如何将 asp.net mvc 3 中的绑定建模到已创建的实例？

> ID：12715344
> 
> 赞同：0
> 
> 时间：2012-10-03T19:20:32.257
> 
> 标签：asp.net, asp.net-mvc

我正在尝试让模型绑定与现有对象一起使用。我对 MVC 很陌生，所以如果方法不好，请原谅我。

我们有一个很大的病人对象。该过程是，首先加载患者，将其存储在会话中，然后跨多个页面进行编辑。我们不希望每次发生模型绑定时都创建一个新实例，因为只编辑了一部分属性。患者处于临时状态，直到发生硬保存，然后患者被保存到数据库中。

我试图利用 asp.net mvc 3 中的模型绑定，但意识到每次发生时都会创建一个新实例。

我不确定如何完成这项任务。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:27:35.050

为了解决这个问题，我创建了一个自定义模型绑定器，如下所示：

```
public class PatientModelBinder : IModelBinder
{
    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        var patientId = int.Parse(bindingContext.ValueProvider.GetValue("patientId").AttemptedValue);

        var session = HttpContext.Current.Session;
        Patient patient;

        //Add logic to search session for the right patient here.

        return patient;
    }
} 
```

然后，您可以使用以下行在 global.asax 文件的 Application_Start 方法中连接 ModelBinder：

```
System.Web.Mvc.ModelBinders.Binders.Add(typeof(Patient), new PatientModelBinder()); 
```

然后，您在 PatientId 中执行的任何操作都会从会话中提取一个水合的 Patient 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T21:53:58.000

您可以使用 TryUpdateModel 将 Request.Form 中的数据绑定到现有对象。像这样的东西：

```
ActionResult SomeControllerAction()
{
    var model = Session["Model"]; // get object from model
    if(!TryUpdateModel(model))
       //return validation
    else
       // do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-04T14:45:46.843

我同意@Jeffrey 使用自定义模型绑定器，但`IModelBinder`我不会实现，而是从类继承`DefaultModelBinder`并且只覆盖该`CreateModel`方法。

该`CreateModel`方法是每次都实例化 Model 类的新实例的方法，因此在该方法中，我将检查会话是否具有患者实例，如果是，我将返回该实例。

```
 public class CustomModelBinder: DefaultModelBinder
  {
    protected override object CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, System.Type modelType)
    {
      // check if the session has patient instance and if yes return that.

      return base.CreateModel(controllerContext, bindingContext, modelType);
    }
  } 
```

注册此模型绑定器后，我将指定操作方法需要包含哪些属性才能使用该`Bind`属性更新模型。

前任。

```
public ActionResult UpdatePatientNameOnly(Patient patient[Bind(Include="First, Last")])
{
}

public ActionResult UpdatePatientAge(Patient patient[Bind(Include="Age")])
{    
} 
```

**重要**：我没有测试过这个

# php - 如果 table1 中存在，则从 table2 中删除

> ID：12715347
> 
> 赞同：-2
> 
> 时间：2012-10-03T19:20:44.490
> 
> 标签：php, mysql

我有 2 张桌子。table1 有 200 万条记录，table2 有 1100 万条记录我想从 table2 中删除 table1 我如何在 MySQL 中执行此操作，对于这个数据计数需要多少？谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:28:45.367

听起来您想删除表 2 中与表 1 中的记录匹配的所有记录。如果是这样，您可以使用子查询。我不确定这对您拥有的记录数量有多有效，但以下应该有效：

```
DELETE FROM table2 where table2.phonenumber IN (select phonenumber from table1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:29:43.783

```
SELECT Table2.* FROM Table2   JOIN Table1 ON Table2.phone = Table1.phone WHERE Table2.phone is not null

DELETE Table2.* FROM Table2   JOIN Table1 ON Table2.phone = Table1.phone WHERE Table2.phone is not null 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T19:30:10.640

```
Delete from table2
where number in (Select number from table1) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T19:27:12.713

尝试加入，然后从加入中删除

```
SELECT tbl1.MyId FROM table1 tbl1
JOIN table2 on tbl1.phonenumber = tb2.phonenumber 
```

然后从中删除

如

```
DELETE FROM Table2 WHERE MyID IN
(SELECT tbl1.MyId FROM table1 tbl1
JOIN table2 on tbl1.phonenumber = tb2.phonenumber) 
```

这是sql代码，不确定mysql有什么变化

祝你好运！

# xml - 按字母顺序对 xml 属性进行排序

> ID：12715355
> 
> 赞同：0
> 
> 时间：2012-10-03T19:21:28.370
> 
> 标签：xml

我想要

```
<node a="2" d="1" c="2"> 
```

转换为

```
<node a="2" c="2" d="1"> 
```

你能用更少的努力提出一些解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T23:00:23.740

使用 XML 规范化库。XML 规范形式要求属性按字母顺序排列（以便通过在字节级别比较两个文档来比较它们是否相等）。

# android - 如何将默认的 Android 填充设置为没有填充的元素？

> ID：12715361
> 
> 赞同：2
> 
> 时间：2012-10-03T19:21:58.693
> 
> 标签：android, padding

假设我刚刚添加了两个标准小部件——CheckBox 和 CheckedTextView。第一个有很好的、清晰的填充，尽管我没有设置任何填充，并且 .xml 文件中没有设置填充。另一个没有任何填充。

现在，我可以通过反复试验从 CheckBox 中获取填充的值（固定）。但我的问题是如何以某种动态方式设置它——即如果在 Android 7.0 中 CheckBox 的填充将是“20sp”并且我设置了“10sp”（因为它现在是 10sp——我正在弥补）那么我的两个小部件将具有不同的填充。

我想有一个一致的填充。那么如何设置`"?android/default_padding"`填充？

*澄清：我有兴趣使用系统默认填充，而不是对我在所有小部件上组成的相同值进行硬编码。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:53:23.553

我在 API 级别 10（以及所有其他 Android 平台上）中为您查找了它：左，右：6dp；顶部，底部：12dp。默认按钮的内边距为 10dp；所以据我所知，没有默认填充。但在大多数情况下，10dp 是好的。此外，它实际上取决于您设备的屏幕尺寸。您必须像 Daniel 建议的那样声明自己喜欢的填充。例如：在您的 Values 文件 10dp 和 values-large 中可能是 15。

编辑：这是 Android 2.3.3 上 mdpi 的默认复选框：

![在此处输入图像描述](../Images/bdb9b2f2413e51b58b005458398a9697.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:29:38.253

您可以在资源中创建一个名为 dimens.xml 的 xml 文件，然后添加如下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<resources>
<dimen name="default_padding">10dp</dimen>
</resources> 
```

然后你从你的布局中调用这样的东西：

```
android:padding="@dimen/default_padding" 
```

我认为这是一种一致的工作方式:) 祝你好运！！！

# asp.net - 如果桌面版本没有移动视图，则显示通用移动页面

> ID：12715362
> 
> 赞同：1
> 
> 时间：2012-10-03T19:22:07.663
> 
> 标签：asp.net, mobile, asp.net-mvc-4

目前，我有一个桌面应用程序，它的一些视图可用于移动设备。我添加了在桌面版和移动版之间切换的功能。但是，如果用户在一个没有移动版的页面上并切换到移动版，就会发生一堆坏事......有没有办法告诉 MVC4 去一个“对不起，这不是在如果当前视图的移动版本不存在，则为 Mobile yet”页面？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T15:08:14.423

这就是我最终做的。我创建了一个 HasMobileVersion 属性来装饰所有具有相应移动版本的 View 方法。我没有显示“抱歉”页面，而是将用户重定向到根 URL（移动版本必须存在那里）。这是它的代码：

```
/// <summary>
/// This attribute specifies which views have Mobile versions available.
/// </summary>
[AttributeUsage(AttributeTargets.Method, AllowMultiple = false, Inherited = false)]
public class HasMobileVersionAttribute : ActionFilterAttribute
{

    #region << Constructors >>

    /// <summary>
    /// Default constructor.
    /// </summary>
    public HasMobileVersionAttribute()
    {
        // Nothing to do
    }

    #endregion

    #region << Overridden Methods >>

    /// <summary>
    /// Allows a View to switch between mobile and desktop versions, ensuring that if a page does not have a mobile version that
    /// it sends the user to the root page.
    /// </summary>
    /// <param name="ac">Request data.</param>
    public override void OnActionExecuting(ActionExecutingContext ac)
    {
        ac.Controller.ViewBag.HasMobileVersion = true;
    }

    #endregion

} 
```

我们声明了一个链接（好吧，图标），允许用户在移动设备和桌面设备之间切换。此链接将从 ViewBag 中检查 HasMobileVersion == true。如果是，一旦用户处于移动模式，它将使用当前 URL 作为返回 URL。如果这不存在，那么我们强制移动链接将使用的返回 URL 作为站点“/”的根。您必须竭尽全力装饰所有具有移动页面的视图，但效果很好。

编辑：

为了在移动/桌面之间切换，我们有一个 ViewSwitcher 控制器。如果您在_Layout，显然您将切换到Mobile版本。如果您在 _Layout.Mobile 中，您将转到桌面。该属性仅用于确定当前页面是否有可供查看的移动版本。在移动端，桌面版本始终存在（否则，您也必须创建 HasDesktopVersion 属性）。这是该代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.WebPages;
using System.Web.Mvc;

public class ViewSwitcherController : Controller
{

    #region << Views >>

    /// <summary>
    /// Allows the user to swicth between mobile and desktop versions of the site.
    /// </summary>
    /// <param name="mobile">True if the user should view the mobile version; false if the user should view the desktop version.</param>
    /// <param name="returnUrl">Original URL.</param>
    /// <returns>RedirectResult to original URL.</returns>
    public RedirectResult SwitchView(bool mobile, string returnUrl)
    {
        if (Request.Browser.IsMobileDevice == mobile)
            HttpContext.ClearOverriddenBrowser();
        else
            HttpContext.SetOverriddenBrowser(mobile ? BrowserOverride.Mobile : BrowserOverride.Desktop);

        return Redirect(returnUrl);
    }

    #endregion

} 
```

这是获取讨论结果的 URL 的 Razor：

```
@Url.Action("SwitchView", "ViewSwitcher" , new { mobile = true, returnUrl = ViewBag.HasMobileVersion != null && ViewBag.HasMobileVersion ? Request.Url.PathAndQuery : "/" }) 
```

在移动端，mobile 将 = false。

# javascript - $.each() 对象属性可能为空

> ID：12715367
> 
> 赞同：0
> 
> 时间：2012-10-03T19:22:20.113
> 
> 标签：javascript, jquery

我有一个对象数组，可能会或可能不会在其属性中填充一个数组。对 null x 调用 $.each(x,function(){}) 会导致类型错误

```
try{
  var a = {};
  $.each(a.doesnotexist,function(k,v){})
} catch(e) {
  console.log(e.message)
} 
```

我已经看到了在空对象上使用 $.extend 并将该值传递给 $.each() 的建议。这两种方法似乎都对我有用，而且看起来更简单，有什么缺点吗？

```
//some test values, not guaranteed properties are populated
var a = [
  {v: [1,2,3,4,5], w: [1,2,3,4,5,6]},
  {v: [1,2,3,4,5]},
  {w: [1,2,3,4,5]},
  {v: [1,2,3], w: []},
  {v: null}
];

for (i =0; i < a.length; i++) {if (a[i].v) $.each(a[i].v,function(k,v){});}
for (i =0; i < a.length; i++) {$.each(a[i].v||[],function(k,v){});} 
```

第二个对我来说似乎最干净。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:38:47.623

您可以使用[`in`运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/in)来检查对象中是否存在属性。

```
for (var i = 0; i < a.length; ++i) {
  if ("v" in a[i]){ 
    $.each(a[i].v, function(k,v) {
      ...
    });
  }
} 
```

并且，使用[`instanceof`运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/instanceof)检查正确的变量类型。

```
if ("v" in a[i] && a[i].v instanceof Array) { ... } 
```

与短路评估相比，这一评估不易受真值的影响。

```
$.each(a[i].v || [], ...); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:30:12.993

您甚至可以快捷方式第一个到

```
a[i].v && $.each(a[i].v, function(k,v){}); 
```

`$.each`会给普通对象带来一些开销。

我的建议是制作一个这样的空安全`for`循环包装器：

```
function nullsafeForEach(arr, fun) {
  var i, len;
  if (!arr || !arr.length || !fun) {
    return;
  }
  for (i = 0, len = arr.length; i < len; ++i) {
    fun(arr[i]);
  };
} 
```

并考虑缓存`a.length`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:33:52.323

你可能的意思是`undefined`，不是`null`。在 JavaScript 中，还没有值的变量被设置为`undefined`.

就个人而言，我最喜欢解决方案＃2。这是我会做的。但是，您应该记住，如果这是其他人将来可能会维护的代码，那么使用方法 #1 并没有什么坏处。方法#1 在它所做的事情上更加明显，因此对于可能不熟悉短路逻辑运算符（例如`||`）的人来说更易于维护。

此外，方法 #2 比方法 #1 稍微慢一点，因为如果`a[i].v`是[falsy](http://11heavens.com/falsy-and-truthy-in-javascript) ，它需要实例化一个空数组。但是开销可以忽略不计，因此除非出于某种原因这是性能关键或内存关键的代码，否则您可以使用方法 #2。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T19:34:32.213

另一种可能性是过滤第一个数组。

```
function hasV(item) { return !!item.v; }
function doWork(k, v) { /* do your work */ }

$.each($.grep(a, hasV), doWork); 
```

* * *

或者使用本机方法来做同样的事情。

```
function hasV(item) { return !!item.v; }
function doWork(v, k) { /* do your work */ }

a.filter(hasV).forEach(doWork); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T19:37:30.473

这是您可能想要做的更清晰的版本（使用清晰、详细的检查）

```
for(var i in a)
{
    if(typeof a[i] == 'object' && typeof a[i].v != 'undefined')
    {
        $.each(a[i].v,function(k,v){  });
    }
} 
```

`a[i].v`如果你想变得非常好，你也可以检查一下长度是否合适！

# emacs - Emacs 将当前缓冲区的密码复制到剪贴板

> ID：12715376
> 
> 赞同：0
> 
> 时间：2012-10-03T19:23:07.693
> 
> 标签：emacs

我的`.emacs`文件中有以下函数来获取当前缓冲区在迷你缓冲区中的路径：

```
(defun show-file-name ()
  "Show the full path file name in the minibuffer."
  (interactive)
  (message (buffer-file-name)))
(defalias 'pwd 'show-file-name) 
```

我的问题是，如何修改此功能以**将**路径复制到**剪贴板？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:37:30.540

```
(defun show-file-name ()
  "Show the full path file name in the minibuffer."
  (interactive)
  (kill-new (buffer-file-name))
  (message (buffer-file-name))) 
```

# jquery - 对我的 jquery 动画稍作修改

> ID：12715377
> 
> 赞同：0
> 
> 时间：2012-10-03T19:23:08.710
> 
> 标签：jquery, jquery-animate

这是我的动画的 JsFiddle：http: [//jsfiddle.net/cCAPk/](http://jsfiddle.net/cCAPk/)

如果你看它，你可以看到当 div 回到他原来的位置时，黑色方块是空的几秒钟。我不希望这种情况发生。如果在 css 中添加溢出：隐藏，您可以清楚地看到 div 的结束位置和重新开始的时间。

我该如何解决？

而且我认为我没有最好的方法来计算动画何时重新开始......

有什么帮助吗？

这是JS：

```
function loop2() {
  var lenght = $('#digit8').html().replace(/[^0-9]/gi, "").length;
  var top = $('#digit8').css("top");
  var max = "-" + (lenght -1) * 45 + "px";

   $('#digit8').animate({
      top: "-=45"
   }, 300, function() {

    if(top == max ){
        $('#digit8').css("top","45px");    
    }
});
}

 for (i=0; i<5; i++)
 {
  var number = Math.floor(Math.random()*9);              
  $("#digit8").append(number+" ");
}

setInterval("loop2()",600);​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:57:22.100

这是我想出的：http: [//jsfiddle.net/cCAPk/2/](http://jsfiddle.net/cCAPk/2/)

我更改了生成器以在非文本处创建元素，以便更轻松地删除。循环将包装器向上移动 45px 并在回调时删除第一个元素并将其放在末尾（将包装器向下移动 45px 以计入）。

一个较少 DOM 操作密集的解决方案是不使用回调：http: [//jsfiddle.net/cCAPk/3/](http://jsfiddle.net/cCAPk/3/)

这有一个我试图用第一个解决方案解决的问题：最后一个元素和第一个元素之间的动画与其他元素不同（将 div 向上移动时看不到最后一个元素）。

# applescript - 使用 AppleScript 获取 CPU 使用率

> ID：12715382
> 
> 赞同：0
> 
> 时间：2012-10-03T19:23:16.537
> 
> 标签：applescript, cpu-usage

我有一个 AppleScript：

```
on run
    set pathName to "/Users/Alexander/Documents/GeekTool/DiskCapacityMeter"
    set usedSpace to (do shell script "df -hl | grep 'disk0s2' | awk '{sub(/%/, \"\");print $5}'") as integer

    set theNumber to (round (usedSpace / 5)) * 5

    do shell script ("cp " & pathName & "/img/" & theNumber & ".png " & pathName & "/temp.png")
end run 
```

（下载自：[这里](http://cl.ly/ANko)）

我想改变这个脚本来显示我的 CPU 使用率而不是我的磁盘容量，因为我真的不知道任何 AppleScript，我不知道如何改变它。

我只知道我需要更改这部分：

```
(do shell script "df -hl | grep 'disk0s2' | awk '{sub(/%/, \"\");print $5}'") 
```

给我我的 CPU 使用率而不是我的磁盘容量.. 如果有可能以这种方式获得我的 CPU 使用率？

编辑* 有 11 张图片与此脚本 (0-10.png) 相关联，第 12 张图片 (temp.png) 根据脚本生成的数量更改为前 11 张中的一张。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T21:22:09.650

我不知道这有多准确，但单个时间点的 CPU 使用率有很大差异：

```
ps axo %cpu | awk '{s+=$1}END{print s}' 
```

这将更不准确，因为 top 本身使用大量 CPU：

```
top -l1 -n0 | sed -En 's/^CPU usage: ([^%]*)% user, ([^%]*)%.*/\1+\2/p' | bc 
```

# objective-c - 需要打字

> ID：12715383
> 
> 赞同：0
> 
> 时间：2012-10-03T19:23:20.897
> 
> 标签：objective-c, ios

我有一个带有 NSDictionary 的初始化程序的类：

```
-(id)initWithVector:(NSDictionary *) vectorDictionary; 
```

当我尝试将其传递给 NSDictionary 时，它给了我一个错误：

> 将“VectorClass * _strong”发送到参数类型“NSDictionary *”的不兼容点类型

代码：

```
// myVectorList is an array of dictionaries
for (NSDictionary *vector in self.myFielder.myVectorList)
{
    if ([vector isKindOfClass:[NSDictionary class]])
    {
        // hardcoded for testing purposes 
        if ([[vector objectForKey:HANDLE] isEqualToString:@"pt07p48u17aj75qx8n2fri9jlkrc262yt8"])
        {
            // GET THE WARNING ON PASSING "VECTOR"
            VectorClass *vector = [[VectorClass alloc] initWithVector:vector];

            [vector retrieveVectorAttributeTable];
            [vector retrieveVectorMetadataTable];
        }
    }
} 
```

如果我键入（NSDictionary *）向量，则没有警告。

vector 应该是字典，那为什么我会收到警告？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T19:25:05.133

您对两个不同的变量使用相同的名称。最里面的变量是`VectorClass`在同一行中定义的类型，因此编译器尝试将其传递给`init`方法，而不是更改其名称：

```
VectorClass *vectorC = [[VectorClass alloc] initWithVector:vector];
[vectorC retrieveVectorAttributeTable];
[vectorC retrieveVectorMetadataTable]; 
```

# proxy - 6in4 隧道中的虚拟主机，允许 ipv4 访问（NON-DUALSTACK）

> ID：12715384
> 
> 赞同：1
> 
> 时间：2012-10-03T19:23:23.780
> 
> 标签：proxy, web-hosting, ipv6, tunnel

我正在使用 gogo6client 为具有 6in4 隧道的网站提供服务。它可以通过 ipv6 本机客户端访问，但不能通过 ipv4 访问。出于网络设置的原因，我无法在 ipv4 端的 NAT 中转发端口 80。我想知道是否有办法翻译或代理入站 ipv4 流量以查看我的 ipv6 站点。

也许也可以将 ipv4 客户端路由到 6in4 隧道，但在运行中，无需安装客户端。

我知道这个站点（ ipv6proxy.prolocation.net ）允许 ipv4 网站访问 ipv6 网络，但是我要问的是相反的。这可能吗？

-td8f4

# php - 如何在提交时跳转到锚点 - 而不是页面顶部

> ID：12715387
> 
> 赞同：0
> 
> 时间：2012-10-03T19:23:28.900
> 
> 标签：php, html

在这个页面上，我有一个怀孕计算器脚本：[http](http://taranakimidwife.co.nz/index.php) ://taranakimidwife.co.nz/index.php ？... 项目编号=104

目前，计算是按下页面跳回顶部。我希望它转到锚点#pregcalc。明白我的意思了吗？这是脚本：

* * *

```
<?php
<?php if(!empty($_POST['calculator_ok'])):
   //last cycle date
   $date="$_POST[dateyear]-$_POST[datemonth]-$_POST[dateday]";

   //convert to time
   $lasttime=mktime(0,0,0,$_POST['datemonth'],$_POST['dateday'],$_POST['dateyear']);

    // next period start
    $next_period=$lasttime + $_POST['days']*24*3600;
    $next_period=date("F d, Y",$next_period);

   //first fertile day
   $firstdaytime=$lasttime + $_POST['days']*24*3600 - 16*24*3600;
   $firstday=date("F d, Y",$firstdaytime);

   //last fertile day
   $lastdaytime=$lasttime + $_POST['days']*24*3600 - 12*24*3600;
   $lastday=date("F d, Y",$lastdaytime);

   //have to adjust due date?
   $diff=$_POST['days'] - 28;

   //due date $date + 280 days
   $duedatetime=$lasttime + 280*24*3600 + $diff*24*3600;
   $duedate=date("F d, Y",$duedatetime);

   ?>
   <div class="calculator_table">
   <p>Here are the results based on the information you provided:</p>
    <!-- <p>Your next <b>menstrual period</b> is expected to start on <strong><?php echo $next_period?></strong>.</p> -->
   <!--<p>You next <b>most fertile</b> period is <strong><?php echo $firstday?> to <?php echo $lastday?></strong>.</p> -->
   <p>Your estimated <b>due date</b> is <strong><?php echo $duedate?></strong>.</p>
   <p align="center"><input type="button" value="Calculate again!" onclick="window.location='http://<?php echo $_SERVER['HTTP_HOST'];?><?php echo $_SERVER['REQUEST_URI']?>'"></p>
   </div>
<?php else:
   //the calculator comes here
   ?>
   <div class="calculator_table">
   <form method="post">
     <p>Please select the first day of your last menstrual period:</p>
   <p><?php echo date_chooser("date",date("Y-m-d"))?></p>
   <p>Usual number of days in your period: <select name="days">
   <?php
   for($i=20;$i<=45;$i++)
   {
      if($i==28) $selected='selected="true"';
      else $selected='';
      echo "<option $selected value='$i'>$i</option>";
   }
   ?>
   </select></p>
   <p align="center"><input type="submit" name="calculator_ok" value="Calculate"></p>
   </form>
   </div>
<?php endif;

//to print a date chooser - get name and value in mysql date format
function date_chooser($name,$value="")
{
   $months=array('','January','February','March','April','May','June','July','August',
   'September','October','November','December');

   if(empty($value)) $value=date("Y-m-d");

   $parts=explode("-",$value);

   $day=$parts[2]+0;
   $month=$parts[1]+0;
   $year=$parts[0];

   $chooser="";

   $chooser.="<select name='".$name."month'>";
   for($i=1;$i<=12;$i++)
   {
      if($i==$month) $selected='selected="true"';
      else $selected='';
      $chooser.="<option $selected value='$i'>$months[$i]</option>";
   }
   $chooser.="</select> / ";

   $chooser.="<select name='".$name."day'>";
   for($i=1;$i<=31;$i++)
   {
      if($i==$day) $selected='selected';
      else $selected='';
      $chooser.="<option $selected value='$i'>$i</option>";
   }
   $chooser.="</select> / ";

   $chooser.="<select name='".$name."year'>";
   for($i=(date("Y")-1);$i<=2050;$i++)
   {
      if($i==$year) $selected='selected';
      else $selected='';
      $chooser.="<option $selected>$i</option>";
   }
   $chooser.="</select> ";   

   return $chooser;
}
?> 
```

# unit-testing - 如何在猫鼬中记录错误，但可以进行单元测试？

> ID：12715392
> 
> 赞同：3
> 
> 时间：2012-10-03T19:24:02.200
> 
> 标签：unit-testing, node.js, mongoose, winston

我想在使用 mongoose 的数据访问层中记录错误。

如何使单元测试变得容易？**将猫鼬**（数据访问+中间件）与**温斯顿**（记录器）集成的最佳方法是什么。

谢谢，

帕维尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-01T02:44:02.643

这是我如何`mongoose`与`winston`.

```
// Create the mongoose instance
var mongoose = require('mongoose');
mongoose.connect(...); // etc. 
```

* * *

```
// Create the winston logger
var winston = require('winston')
  , logger = new (winston.Logger)({
      transports: new (winston.transports.Console)({
        uncaughtException: true,
        level: 'debug',
        colorize: 'true'
      }),
    }); 
```

* * *

```
// Configure mongoose for debug
mongoose.set('debug', function (collectionName, method, query, doc, options) {
  logger.info('mongo collection: %s method: %s', collectionName, method);
}); 
```

# java - 如何将 JFrame (java swing) 窗口上传到 HTML 页面

> ID：12715395
> 
> 赞同：0
> 
> 时间：2012-10-03T19:24:12.780
> 
> 标签：java, html, swing, jframe, java-web-start

我们在 HTML 中是否有任何标签用于上传 JFrame 窗口。我知道使用标签在 HTML 中嵌入 appletviewer。我们有 JFrame 的替代标签吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:26:10.243

不，没有这样的 html 标签。

您可以将 Swing 应用程序作为 applet 或使用 JNLP 启动。

# javascript - 这个 JSON 编码怎么不正确？

> ID：12715399
> 
> 赞同：0
> 
> 时间：2012-10-03T19:24:19.520
> 
> 标签：javascript, json, object, format

我在另一个网站上看到了一个 JSON 代码，如下所示：

```
var jquerycssmenu={

fadesettings: {overduration: 350, outduration: 100}

...

} 
```

所以我正在编写自己的代码，但它没有用，我不知道为什么：

```
var CityCountry={
    CityCountryOrigin: {City: Vancouver, Country: Canada}
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T19:26:31.670

当然是不正确的。不同之处在于“来自另一个站点的 JSON”中的值是数字文字，但在您的中它是（应该是）字符串 - 因此应该引用，如下所示：

```
var CityCountry = {
    CityCountryOrigin: {
      City:    'Vancouver', 
      Country: 'Canada'
    }
}; 
```

严格来说，这两个片段都不是 JSON：它们使用所谓的[JavaScript 对象文字](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Values,_variables,_and_literals#Object_literals)代替。

> 对象字面量是对象的零或多对属性名称和关联值的列表，用花括号 ({}) 括起来。

# jain-sip - jainsip processResponse 未调用

> ID：12715405
> 
> 赞同：1
> 
> 时间：2012-10-03T19:25:03.847
> 
> 标签：jain-sip

我已经成功地使用 jainsip 注册客户。方法 processRequest 正在工作。我正在从代理向电话发送邀请并且电话正在响铃。邀请的源端口是 5060，ip 是服务器的 ip。我使用嗅探器验证 100Trying 和 180Ringing 是否从客户端发送到端口 5060 上的服务器/代理。服务器上注册了两个客户端，如前所述，processRequest 正在工作，但 100Trying 和 180Ringing 响应没有被拾取由 SIpListener 或方法 processResponse 只是不被调用。我正在使用这些罐子：

```
<dependency>
  <groupId>javax.sip</groupId>
  <artifactId>jain-sip-api</artifactId>
  <version>1.2.1.4</version>
</dependency>
<dependency>
  <groupId>javax.sip</groupId>
  <artifactId>jain-sip-ri</artifactId>
  <version>1.2.167</version>
</dependency> 
```

我正在使用此代码发送邀请：

```
ClientTransaction clientTransaction = sipProviderStatic.getNewClientTransaction(inviteRequest);
clientTransaction.sendRequest(); 
```

注册顺利进行，所以这不是防火墙问题，我什至尝试将其关闭。

有人有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T04:13:56.743

首先，如果您通过发送请求并获得如下响应在两个模拟器中进行测试，则必须重定向端口：

转到命令而不是输入“telnet localhost 5554”并为另一个模拟器输入相同的内容

而不是输入“redir add udp:5070:5070”作为服务器代码和

比为发送请求的客户端代码输入“redir add udp:5060:5060”...你可以看到这两个模拟器之间的请求和响应

# c# - 无法将“System.Web.UI.WebControls.Button”类型的对象转换为“System.Web.UI.WebControls.CheckBox”类型

> ID：12715407
> 
> 赞同：2
> 
> 时间：2012-10-03T19:25:04.930
> 
> 标签：c#, asp.net

我正在尝试使用复选框让用户选择要从 DataList 中删除的项目。这就是我的编码方式：

```
protected void deleteItems_Click(object sender, EventArgs e)
{
    foreach(DataListItem item in pricing.Items)
    {
        bool IsChecked;
        IsChecked = ((CheckBox)item.FindControl("Delete")).Checked;
        string rowNum = ((Label)item.FindControl("lblRowNum")).Text;

        if (IsChecked)
        {
            //delete each checked item   
            DB.Execute("DELETE FROM ItemWearablePricing WHERE WearablePriceingID = " + rowNum);
        }
    }
} 
```

无法将“System.Web.UI.WebControls.Button”类型的对象转换为“System.Web.UI.WebControls.CheckBox”类型。

我不确定我在做什么会导致这种情况，但我相信有人会指出一些显而易见的事情。

任何人都可以提供的任何帮助将不胜感激，谢谢。另外，可能需要的任何其他代码我都会尽力提供。感谢任何可以提供帮助的人。

我得到了错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:26:32.123

大概`item.FindControl("Delete")`是返回 a `Button`，而不是 a `CheckBox`。仔细检查控件的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:29:24.883

`id`html上的“删除”与a有关`<asp:Button`而不是`<asp:CheckBox`

# jquery - 解释一下这个 jQuery 选择器？

> ID：12715409
> 
> 赞同：6
> 
> 时间：2012-10-03T19:25:08.347
> 
> 标签：jquery, internet-explorer

我正在尝试调试另一个开发人员的代码，但我一生都无法弄清楚这个变量中存储了什么：

```
var dl = $("<dl>",{class: 'my_class'}); 
```

此行在 IE8 及更低版本中生成“预期的标识符、字符串或数字”错误消息，但没有其他浏览器，我试图弄清楚是否有其他方法可以用不同的语法完成同样的事情.

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T19:26:34.510

它正在创建一个`dl`元素（包装在一个 jQuery 对象中），其`class`属性值为`my_class`. 有关此函数形式的更多信息，请参阅[jQuery 文档](http://api.jquery.com/jQuery/#jQuery2)。

您收到错误是因为`class`它是 JavaScript 中的保留字。您可以通过引用它来修复它：

```
var dl = $("<dl>", { "class": "my_class" }); 
```

或者，您可以`className`改为设置属性（您不必在任何浏览器中引用）：

```
var dl = $("<dl>", { className: "my_class" }); 
```

请注意，ES5 规范说您*可以*使用保留字作为属性名称。但是由于您显然需要支持旧版本的 IE，因此您将不得不忘记这一点并引用它们。如果您只是放弃对低于版本 9 的 IE 的支持，则根本不必更改代码；）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:26:43.580

`class`是 JavaScript 中的保留字，你应该用引号括起来：

```
var dl = $("<dl/>",{'class': 'my_class'}); 
```

# sql - 如何根据标识符拆分列数据

> ID：12715410
> 
> 赞同：0
> 
> 时间：2012-10-03T19:25:09.673
> 
> 标签：sql, oracle10g

我正在使用 oracle 数据库。我的列 1234~2345~3456~4567 中有这种格式的数据。

我需要一个查询来根据标识符'〜'拆分列中的数据，以便我可以在标识符第二次出现之后挑选出值。我可以知道谁能做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:51:54.100

看看 [https://blogs.oracle.com/aramamoo/entry/how_to_split_comma_separated_string_and_pass_to_in_clause_of_select_statement](https://blogs.oracle.com/aramamoo/entry/how_to_split_comma_separated_string_and_pass_to_in_clause_of_select_statement)

# grails-2.0 - 如何使用验证约束标签？

> ID：12715413
> 
> 赞同：1
> 
> 时间：2012-10-03T19:25:25.040
> 
> 标签：grails-2.0

如何在`<g:select/>`我的视图标签中自动使用域模型中的验证约束，或者这是不可能的？

在我的域类中，我有一个`int`带有`size`约束的属性：

```
int texture
static constraints = {
  texture range:0..8
} 
```

现在，在我看来，我想使用一个选择来允许用户选择正确的值。我目前有这个：

```
<g:form action="save">
  <div class="fieldcontain  ">
        <label for="foamScore.texture">
            Foam Texture

        </label>
        <g:select name="foamScore.texture" from="${0..8}"/>
    </div>
</g:form> 
```

如果可能的话，我想避免重复`0..8`视图中的部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T15:31:11.627

Grails jquery-validation-ui 插件将使用服务器端 GORM 约束执行客户端验证。这样可以避免在客户端重复验证逻辑。这是插件 [http://grails.org/plugin/jquery-validation-ui的链接](http://grails.org/plugin/jquery-validation-ui)

# apache - Apache Whirr 没有在 EC2 上使用我的 whirr.location-id 参数

> ID：12715414
> 
> 赞同：0
> 
> 时间：2012-10-03T19:25:48.780
> 
> 标签：apache, hadoop, amazon-ec2, hbase

我一直在使用 Apache Whirr(0.8.0) 使用 CDH ami 在 EC2 上创建 Hadoop+HBase 集群，结果发现 Whirr 没有使用我的 whirr.location-id 参数。当我创建集群时，我特别将它作为参数 --location-id=us-west-2 传递，并且我还将它作为 whirr.location-id=us-west-2 添加到 whirr 配方中，但是当我启动它们总是在 us-east-1 区域中创建的集群。我的猜测是 CDH 的 Whirr 配方覆盖了该区域，我想知道是否有任何方法可以禁用它或强制特定的 EC2 区域？

# hadoop - 在 HDFS 上找不到 Oozie 作业配置应用程序目录

> ID：12715416
> 
> 赞同：5
> 
> 时间：2012-10-03T19:25:50.970
> 
> 标签：hadoop, workflow, hdfs, cloudera, oozie

我在我的 Linux 机器上安装了 Cloudera 的伪分布式版本，并成功运行了一些简单的 MapReduce 示例。但是，我试图让 Oozie 工作，并且在尝试执行简单的工作流程时收到的错误完全让我感到困惑：

```
tim@phocion:~$ oozie version
Oozie client build version: 3.1.3-cdh4.0.1 
```

根据文档，将预打包的示例复制到 HDFS 并执行：

```
tim@phocion:~$ oozie job -oozie http://phocion:11000/oozie -config /user/tim/examples/apps/map-reduce/job.properties -run
Error: E0504 : E0504: App directory [hdfs://phocion:8020/user/tim/examples/apps/map-reduce] does not exist 
```

检查文件是否存在：

```
tim@phocion:~$ hdfs dfs -ls /user/tim/examples/apps/map-reduce
Found 3 items
-rwxr-xr-x   1 tim tim        995 2012-10-03 14:47 /user/tim/examples/apps/map-reduce/job.properties
drwxrwxr-x   - tim tim       4096 2012-10-03 14:47 /user/tim/examples/apps/map-reduce/lib
-rwxr-xr-x   1 tim tim       2559 2012-10-03 14:47 /user/tim/examples/apps/map-reduce/workflow.xml 
```

确实如此。我可以连接到 phocion:8020 吗？

```
tim@phocion:~$ telnet phocion 8020
Trying 127.0.1.1...
Connected to phocion.
Escape character is '^]'. 
```

我可以。所以，基本上，我完全不知道这个错误试图告诉我什么——这个文件夹确实存在。我假设错误太模糊，无法完全传达问题所在，但我几乎没有发现任何东西可以为我指明正确的方向。

我也可以用其他 3rd 方教程复制这个错误。

花了很多时间翻阅配置文件，以至于不想再看电脑了。也许我在这里过度思考这个问题，但任何帮助将不胜感激。

编辑：添加完整的 job.properties （与默认值没有太大不同）：

```
nameNode=hdfs://phocion:8020
jobTracker=phocion:8021
queueName=default
examplesRoot=examples
oozie.wf.application.path=${nameNode}/user/${user.name}/${examplesRoot}/apps/map-reduce
outputDir=map-reduce 
```

更多编辑：当文件夹不存在时，我得到同样的错误，在我把 if 放回 hdfs 之后。最后的想法是它的权限问题， chmod 777 仍然得到同样的错误。命令行上传递的完整 HDFS 路径不能解决问题。在 oozie 甚至 root 帐户下运行它都不起作用：

```
tim@phocion:~$ oozie job -oozie http://phocion:11000/oozie -run -config /home/tim/examples/apps/map-reduce/job.properties -Doozie.wf.application.path=hdfs://phocion:8020/user/tim/examples/apps/map-reduce
Error: E0504 : E0504: App directory [hdfs://phocion:8020/user/tim/examples/apps/map-reduce] does not exist
tim@phocion:~$ hdfs dfs -put examples/ /user/tim/
12/10/04 13:26:43 INFO util.NativeCodeLoader: Loaded the native-hadoop library
tim@phocion:~$ oozie job -oozie http://phocion:11000/oozie -run -config /home/tim/examples/apps/map-reduce/job.properties -Doozie.wf.application.path=hdfs://phocion:8020/user/tim/examples/apps/map-reduce
Error: E0504 : E0504: App directory [hdfs://phocion:8020/user/tim/examples/apps/map-reduce] does not exist
tim@phocion:~$ hdfs dfs -chmod -R 777 /user/tim/examples/
12/10/04 13:28:16 INFO util.NativeCodeLoader: Loaded the native-hadoop library
tim@phocion:~$ oozie job -oozie http://phocion:11000/oozie -run -config /home/tim/examples/apps/map-reduce/job.properties -Doozie.wf.application.path=hdfs://phocion:8020/user/tim/examples/apps/map-reduce
Error: E0504 : E0504: App directory [hdfs://phocion:8020/user/tim/examples/apps/map-reduce] does not exist
tim@phocion:~$ sudo -u oozie oozie job -oozie http://phocion:11000/oozie -run -config /home/tim/examples/apps/map-reduce/job.properties -Doozie.wf.application.path=hdfs://phocion:8020/user/tim/examples/apps/map-reduce
[sudo] password for tim: 
Error: E0504 : E0504: App directory [hdfs://phocion:8020/user/tim/examples/apps/map-reduce] does not exist
tim@phocion:~$ sudo -u root oozie job -oozie http://phocion:11000/oozie -run -config /home/tim/examples/apps/map-reduce/job.properties -Doozie.wf.application.path=hdfs://phocion:8020/user/tim/examples/apps/map-reduce
Error: E0504 : E0504: App directory [hdfs://phocion:8020/user/tim/examples/apps/map-reduce] does not exist 
```

这个命令理论上应该有效吗？

```
tim@phocion:~$ hdfs dfs -ls hdfs://phocion:8020/user/tim/examples/apps/map-reduce
ls: `hdfs://phocion:8020/user/tim/examples/apps/map-reduce': No such file or directory 
```

这会在执行 oozie 命令后显示在 hadoop-hdfs 日志中：

```
2012-10-04 13:50:00,152 INFO org.apache.hadoop.hdfs.server.namenode.FSEditLog: Starting log segment at 113297
2012-10-04 13:50:00,874 INFO org.apache.hadoop.hdfs.server.namenode.TransferFsImage: Opening connection to http://localhost.localdomain:50090/getimage?getimage=1&txid=113296&storageInfo=-40:2092007576:0:cluster8
2012-10-04 13:50:00,875 ERROR org.apache.hadoop.security.UserGroupInformation: PriviledgedActionException as:hdfs (auth:SIMPLE) cause:java.net.ConnectException: Connection refused
2012-10-04 13:50:00,876 WARN org.mortbay.log: /getimage: java.io.IOException: GetImage failed. java.net.ConnectException: Connection refused
        at java.net.PlainSocketImpl.socketConnect(Native Method)
        at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:351)
        at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:213)
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:200)
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
        at java.net.Socket.connect(Socket.java:529)
        at java.net.Socket.connect(Socket.java:478)
        at sun.net.NetworkClient.doConnect(NetworkClient.java:163)
        at sun.net.www.http.HttpClient.openServer(HttpClient.java:395)
        at sun.net.www.http.HttpClient.openServer(HttpClient.java:530)
        at sun.net.www.http.HttpClient.<init>(HttpClient.java:234)
        at sun.net.www.http.HttpClient.New(HttpClient.java:307)
        at sun.net.www.http.HttpClient.New(HttpClient.java:324)
        at sun.net.www.protocol.http.HttpURLConnection.getNewHttpClient(HttpURLConnection.java:970)
        at sun.net.www.protocol.http.HttpURLConnection.plainConnect(HttpURLConnection.java:911)
        at sun.net.www.protocol.http.HttpURLConnection.connect(HttpURLConnection.java:836)
        at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1172) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T23:54:58.630

除了 HarshJ 的评论，请检查您的错误消息：

```
Error: E0504 : E0504: App directory [hdfs://phocion:8020/user/tim/examples/apps/demo] does not exist 
```

以及您提供的 hadoop fs -ls 清单：

```
/user/tim/examples/apps/map-reduce/ 
```

并发挥不同之处：

```
/user/tim/examples/apps/demo
/user/tim/examples/apps/map-reduce/ 
```

尝试如下配置：

```
oozie.wf.application.path=/user/tim/examples/apps/map-reduce 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-07T06:48:38.020

我遇到了同样的问题，并通过导出正确的 oozie url 解决了这个问题。

要导出，您应该使用以下命令

```
export OOZIE_URL=http://someip:11000/oozie 
```

要获取此 oozie url，您需要使用 hue 连接集群并导航到 Workflows，您可以在其中找到名为`oozie`. 在这个里面，你应该看到将列出许多属性的**仪表。**寻找属性**oozie.servers**。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-08-04T11:38:04.560

您需要做的是`-copyFromLocal`将示例文件夹复制到作业配置中指定的位置。

# c# - 在撕下标签上激活窗口移动

> ID：12715424
> 
> 赞同：0
> 
> 时间：2012-10-03T19:26:29.217
> 
> 标签：c#, wpf

我有一个带有选项卡项的选项卡控件。当用户将其从选项卡控件中“撕下”时，我想在其自己的窗口中打开一个特定的选项卡。我知道在创建窗口和将选项卡项移动到该窗口方面该怎么做。

但是，我似乎无法弄清楚如何在创建后将窗口保留在鼠标下，当它被撕下时；所以用户交互是无缝的。

我在 tabitem 的代码中有这个：

```
 protected override void OnPreviewMouseMove(MouseEventArgs e)
        {
            base.OnPreviewMouseMove(e);
            if(e.LeftButton == MouseButtonState.Pressed && _startPoint != null)
            {
                Point position = e.GetPosition(null);

                if (Math.Abs(position.Y - _startPoint.Value.Y) > SystemParameters.MinimumVerticalDragDistance)
                {
                    Point cursor = Utils.GetCursorPosition();
                    var w = new AttachableWindow(){WindowStartupLocation = WindowStartupLocation.Manual, Left = cursor.X, Top=cursor.Y};
                    w.Show();
                    _startPoint = null;
                    e.Handled = true;
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:34:05.400

使用 DragMove 方法让窗口移动：

```
w.Loaded += (sender, args) =>
                        {
                            (sender as Window).DragMove();
                        }; 
```

编辑：请注意，在加载的事件中执行此操作会导致窗口部分呈现。我认为激活事件是一个更好的选择。

# java - 为什么 synchronizedCollection() 静态工厂方法的输入参数中没有有界通配符？

> ID：12715426
> 
> 赞同：1
> 
> 时间：2012-10-03T19:26:30.203
> 
> 标签：java, generics, bounded-wildcard

我正在阅读 Java 教程，偶然发现了一些我不理解的东西。在 Collections 线索中，他们谈论[Wrapper 实现](http://docs.oracle.com/javase/tutorial/collections/implementations/wrapper.html)，我注意到两个静态工厂方法 -

```
public static <T> Collection<T> synchronizedCollection(Collection<T> c);

public static <T> Collection<T> unmodifiableCollection(Collection<? extends T> c); 
```

我想知道为什么同步包装器不使用有界通配符？ie 为什么synchronizedCollection的签名不是如下？

```
public static <T> Collection<T> synchronizedCollection(Collection<? extends T> c); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:31:55.490

`Collection<? extends T> c`这样你只能得到东西但不能添加到它，这在 的情况下是有意义的`unmodifiableCollection`，对于方法，参数应该只充当生产者。但是在 的情况下`synchronizedCollection`，它是同步的但仍然是修改的，它也应该能够添加和删除，所以它必须是`Collection<T> c`，它应该充当生产者和消费者。

这可能有助于了解[什么是 PECS（生产者扩展消费者超级）？](https://stackoverflow.com/q/2723397/738746)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-03T19:55:46.627

我认为`unmodifiableCollection`是错误的。两种方法都打算包装`Collection<T>`为`Collection<T>`，没有理由更改类型参数。

当然，接受 a 更灵活`Collection<? extends T>`，因此调用者可以请求将 a 转换`Collection<Integer>`为不可修改的`Collection<Integer>`or `Collection<Number>`or`Collection<Object>`等​​。但是谁需要呢？只读`Collection<Integer>`在各方面​​都比`Collection<Number>`无论如何都要好。

如果输入类型本身包含通配符，例如

```
Collection<? extends Number> someNumbers = ...; 
```

`unmodifiableCollection(Collection<? extends T>)`我们可以做

```
 Collection<Number> readonlyNumbers 
                             = unmodifiableCollection(someNumbers);
          Collection<Object> readonlyObjects 
                             = unmodifiableCollection(someNumbers); 
```

但`unmodifiableCollection2(Collection<T>)`我们必须

```
Collection<? extends Number> readonlyNumbers 
                             = unmodifiableCollection2(someNumbers);
Collection<? extends Object> readonlyObjects  
                             = unmodifiableCollection2(someNumbers); 
```

第二个版本更混乱，但它可能在政治上更正确。

# java - 如果条件匹配，如何检测部分 URL 和输出值？

> ID：12715429
> 
> 赞同：0
> 
> 时间：2012-10-03T19:26:32.187
> 
> 标签：java, javascript, jsp, analytics, jsp-fragments

如果浏览器地址栏中的页面 URL 以“搜索”结尾，我需要创建一个特殊条件。到目前为止，在我的 .jpsf 文件中，我有以下代码：

```
<c:choose>
    <c:when test="${SOMETHINGHERE eq 'Search'}">
        <c:out value="Search" />
    </c:when>
    <c:otherwise>
        <c:out value="${topCat}" />|<c:out value="${subCatA}" />|<c:out value="${subCatB}" />|<c:out value="${subCatC}" />
    </c:otherwise>
</c:choose> 
```

我可以在该`SOMETHINGHERE`部分中放置什么来检测 URL 是否包含搜索字词？浏览此处的帖子并在 Google 上搜索并没有让我找到任何有效的答案。

我也尝试添加`<% String currentPDP = request.getParameter("search")%>` ，但它返回了 500 错误，可能是因为 _Search 没有正确设置为参数（它在 URL 的末尾硬编码）并且代码格式不正确。

我是 JSP 的新手，必须在工作中学习，所以我感谢您的耐心和您可以提供的任何帮助。非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:14:32.887

首先，您要导入 Functions 标记：

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %> 
```

然后，您可以使用：

```
${fn:contains(pageContext.request.requestURI, 'Search')} 
```

或者，如果你不关心这个案子

```
${fn:containsIgnoreCase(pageContext.request.requestURI, 'Search')} 
```

这将允许您通过 URI 搜索 term `Search`。

如果运行脚本的完整 url 是`http://www.example.com/site/search.jsp`，那么`responseURL`应该返回`/site/search.jsp`。上面的示例在第二种情况下将返回 true，因为 'Search' 在 URI 字符串中（第一种情况由于大写而失败）。

它不包括查询参数，这将涉及不同的检查。

# java - 在繁重的进程下无法更新 Swing 组件

> ID：12715432
> 
> 赞同：1
> 
> 时间：2012-10-03T19:26:34.853
> 
> 标签：java, multithreading, swing, event-dispatch-thread, invokelater

我在一个匿名`SwingWorker`线程下运行一个非常繁重的进程。同时，我正在使用进度条向 GUI 报告进度。然而，Swing 线程让我陷入了困境。它根本没有及时更新任何东西。我不知道该怎么做，因为我尝试从`SwingWorker`线程和外部更新 GUI，但都拒绝工作。

## **如何在繁重的工作线程运行时可靠地更新 Swing UI？**

### 我尝试过的事情

这不起作用（有或没有在`invokeLater`命令中换行）。

```
new LocalCompressor(compressor).execute();

while (!compressionDone) {
    SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
            int percent = compressor.getPercentDone();
            progressBar.setValue(percent);
            statusLabel.setText(percent);
        }
    });
} 
```

* * *

此外，尝试从并发测量线程更新 UI 不起作用：

```
class LocalCompressor extends SwingWorker<Void, Void> {

    // [...]

    public LocalCompressor(Compressor compressor) {
        this.compressor = compressor;

        // [...]
    }

    @Override
        protected Void doInBackground() {

            final Thread t1 = new Thread(new Runnable() {

                @Override 
                public void run(){
                    compressor.compress();
                }
            });

            final Thread t2 = new Thread(new Runnable() {

                @Override
                public void run() {

                    t1.start();

                    while (t1.isAlive()) {
                        updateUI(compressor.getPercentDone());
                    }
                }

            });

            t2.start();

            return null;
        }

        // [...]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:39:11.713

你并没有真正使用你的 SwingWorker。工人本身已经是一个线程。如果您有可能将长时间运行的代码放入 中`doInBackground()`，请将其放在那里。然后只需调用`publish(Integer)`您的实际进度并处理您在`process(List<Integer>)`-method 中获得的块。在 process() 中，您可以更新 gui，它位于 EDT 上。

编辑：实际上，你现在正在做的是在几个while循环中轮询，这有点耗电。这就是为什么我认为它对你的算法中的事件更好，每次你得到一个百分比或每次循环开始新一轮或类似的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T20:05:17.260

扩展此处提供的答案和建议，这是一种编码方式。我假设压缩器本身没有能力做回调，但你可以问它完成的百分比。

在 swingworker 线程 (doInBackground) 中，我们启动真正的压缩线程。然后在后台线程中启动轮询循环，每秒更新几次 UI。要通知 UI 线程，请调用 publish。这将导致在事件线程中定期调用被覆盖的方法进程。从这里我们可以安全地更新进度条和状态标签。

```
public class LocalCompressor extends SwingWorker<Void, Integer>
{
   private Compressor compressor;

   public LocalCompressor(Compressor compressor)
   {
      this.compressor = compressor;

      // [...]
   }

   @Override
   protected void done()
   {
      System.out.println("Compression is done.  Going to do something with it...");
   }

   @Override
   protected void process(List<Integer> chunks)
   {
      for (Integer percent : chunks)
      {
         progressBar.setValue(percent);
         statusLabel.setText(percent);      
      }
   }

   @Override
   protected Void doInBackground() throws Exception
   {
      final Thread t1 = new Thread(new Runnable()
      {
         @Override
         public void run()
         {
            compressor.compress();
         }
      });

      t1.start();

      while (t1.isAlive())
      {
         int percentDone = compressor.getPercentDone();
         publish(percentDone);
         Thread.sleep(200);
      }
      return null;
   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T21:21:52.283

您是否尝试过使用 a 的非常简单和基本的方法`SwingWorker`？就像@Zhedar 之前所说的那样，SwingWorker 本身已经是一个线程。所以删除你的内螺纹（`t1`，`t2`），然后使用你的耗时`compress()`方法`doInBackground()`。

*一些*非常基本的东西，如下所示：

```
class LocalCompressor extends SwingWorker<Void, Integer> {

    // .....
    // Your constructor here
    // .....

    @Override
    protected Void doInBackground() throws Exception {
        compress();
        return null;
    }

    @Override
    protected void process(List<Integer> chunks) {
        for (Integer chunk : chunks) {
            progressBar.setValue(chunk);
            statusLabel.setText(chunk);
        }
    }
} 
```

现在这个`compress()`方法应该被移动到里面`SwingWorker`并且它必须有某个地方 a `publish()`，在你的情况下它可能是`publish(getPercentDone())`或者其他什么。

```
private void compress() {

    // .....

    publish(getPercentDone());

    // .....

} 
```

这就是通常使用`SwingWorker`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T19:39:43.650

我假设（你知道这是怎么回事）调用`LocalCompressor.execute()`被阻塞。如果是这种情况，您的 while 循环将在全部完成之前不会运行，然后您就违背了在 UI 上获得稳定更新流的目的。

试试这个或类似的东西：

```
 LocalCompressor comp = new LocalCompressor(compressor);

    SwingUtilities.invokeLater(new Runnable() {

        @Override
        public void run() {
            while (!compressionDone) {
                int percent = compressor.getPercentDone();
                progressBar.setValue(percent);
                statusLabel.setText(percent);
            }
        }
    });
    comp.execute();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T20:45:25.733

您可以使用生产者/消费者模式...

这是一个**非常基本**的概念......

```
public class ProducerComsumer {

    public static void main(String[] args) {
        new ProducerComsumer();
    }

    public ProducerComsumer() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {

                JPanel panel = new JPanel(new GridBagLayout());
                panel.setBorder(new EmptyBorder(12, 12, 12, 12));

                JProgressBar progressBar = new JProgressBar();
                panel.add(progressBar);

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(panel);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);

                Producer producer = new Producer();
                producer.start();

                Consumer consumer = new Consumer(producer, progressBar);
                consumer.start();
            }
        });
    }

    public class Producer extends Thread {

        private volatile float progress;
        private volatile boolean done;

        public Producer() {
            setPriority(NORM_PRIORITY - 1);
            setDaemon(true);
        }

        public float getProgress() {
            return progress;
        }

        public boolean isDone() {
            return done;
        }

        @Override
        public void run() {
            done = false;
            for (int index = 0; index < Integer.MAX_VALUE; index++) {
                progress = (float) index / (float) Integer.MAX_VALUE;
            }
            done = true;
            System.out.println("All done...");
        }
    }

    public class Consumer extends Thread {

        private Producer producer;
        private JProgressBar progressBar;

        public Consumer(Producer producer, JProgressBar progressBar) {
            setDaemon(true);
            setPriority(NORM_PRIORITY - 1);
            this.producer = producer;
            this.progressBar = progressBar;
        }

        public JProgressBar getProgressBar() {
            return progressBar;
        }

        public Producer getProducer() {
            return producer;
        }

        @Override
        public void run() {
            while (!producer.isDone()) {
                updateProgress();
                try {
                    sleep(1000);
                } catch (InterruptedException ex) {
                    Logger.getLogger(ProducerComsumer.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
            updateProgress();
        }

        protected void updateProgress() {
            SwingUtilities.invokeLater(new Runnable() {
                @Override
                public void run() {
                    int progress = Math.round(getProducer().getProgress() * 100f);
                    System.out.println("Update progress to " + progress);
                    getProgressBar().setValue(progress);
                }
            });
        }
    }
} 
```

玩转这些`Thread.setPriority`价值观，看看它是否有任何不同

# php - 获取主文件夹

> ID：12715434
> 
> 赞同：2
> 
> 时间：2012-10-03T19:26:38.503
> 
> 标签：php

直到今天，我还在使用那段代码来定位 public_html 来计算要返回的文件夹以导入文件：

```
$config_path = array_reverse(explode( DIRECTORY_SEPARATOR , getcwd()));
$co = 0;
foreach($config_path as $val){
    if($val == "public_html")
        break;
    $co += 1;
}
$config_path = '';

if($co != 0){
    for($i = 0 ; $i < $co ; $i++){
        $config_path .= '../';
    }
} 
```

然后我就这样使用它：

```
require_once ($config_path.'core/db-class.php'); 
```

那段代码对我很有帮助，尽管我觉得它限制了我，因为当我使用 WAMP 时，我需要拥有 public_html 文件夹等

我正在寻找类似的 php 函数 -`getMainRoot()`

所以我可以做类似的事情

```
require_once (getMainRoot().'core/db-class.php'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:27:56.317

使用`$_SERVER['DOCUMENT_ROOT']`php 变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:33:10.613

一个人总是可以使用，但是在运行*内部 Web 服务器*或*从命令行*`$_SERVER['DOCUMENT_ROOT']`中不起作用。

 **如果您的应用程序有一个*单一的入口点*，您`index.php`可以在那里进行定义：

```
define( 'ROOT_PATH', __DIR__ ); 
```

并从那里开始使用它。**

# jquery - 使用 jQuery 创建 URL 值数组

> ID：12715440
> 
> 赞同：0
> 
> 时间：2012-10-03T19:26:50.170
> 
> 标签：jquery, arrays, url

我有许多通过 URL 传递的值，我需要在数组中捕获这些值，以替换页面上的文本元素。例如：

网址：[http ://www.domain.com/?client=ClientName&project=ProjectName](http://www.domain.com/?client=ClientName&project=ProjectName)

我希望有一个简单的 html 将插入值。例如

```
<ul>
  <li>Client: <span class="client"></span></li>
  <li>Project: <span class="project"></span></li>
</ul> 
```

这应该产生：

*   客户：客户名称
*   项目：项目名称

数据片段可能需要在页面上多次写入，因此需要使用带有类的 span 标签。

任何人都可以建议如何使用 jQuery 来实现这一点。提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:59:59.507

我认为你需要这样的东西：http: [//jsfiddle.net/8WTA6/2/](http://jsfiddle.net/8WTA6/2/)

```
var params = window.location.search.substring(1).split('&');
for (var i = 0; i < params.length; i++) {
    var param = params[i].split('=');
    $("." + param[0]).html(param[1]);
} 
```

# java - 如何创建逆变换矩阵

> ID：12715447
> 
> 赞同：4
> 
> 时间：2012-10-03T19:27:22.487
> 
> 标签：java, math, matrix, transformation, inverse

我正在用 Java 开发一个 OpenGL 项目，它已经到了我想在我自己的代码中创建转换矩阵的地步，所以我可以使用它们来进行世界到屏幕的点转换，反之亦然. 我创建了一个支持转换的 Matrix 类，这一切都很好。但是，我实际上很难弄清楚如何创建逆变换。

所以我的问题是：

*   给定一个任意仿射 (4x4) 变换矩阵，如何创建逆变换矩阵？有些矩阵是不可逆的吗？反转变换矩阵有哪些限制和注意事项？

从我的研究中，我听到了各种这样做的方法，最简单的方法是转置然后否定矩阵。但是，这似乎并没有真正起作用。我听说这种方法不适用于某些矩阵，甚至某些矩阵是不可逆的。

我正在寻找的不仅仅是“插入这个方程”的答案，因为我实际上想了解当我反转矩阵时发生了什么。这也排除了“只使用这个库”的答案。我将来可能会搬到矩阵库，但现在我想自己创建它。

编辑：在任何人问之前，这*不是*家庭作业。这是一个个人项目。

编辑：显然这里有计算逆矩阵的完整策略列表：[http ://en.wikipedia.org/wiki/Invertible_matrix](http://en.wikipedia.org/wiki/Invertible_matrix)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:34:45.237

这是我在计算机图形课程中使用的一些代码，基本上我使用 Gauss Jordan 消元来计算矩阵的逆。对于可逆矩阵，其行列式值必须不等于 0。虽然我没有在我的代码中处理过这种情况，但我不会为你做这一切。

```
Matrix4* Matrix4::FindInverse(Matrix4 &a){

int n = R;
int i = 0;
int j = 0;
float pivot = 0;
Matrix4* invA = NULL;
//TODO: Check whether the matrix is invertible.Else Return
invA = new Matrix4();
invA->SetMatrix4(1,0,0,0, 0,1,0,0, 0,0,1,0, 0,0,0,1);

for(i = 0; i < n; i++){
    pivot = a.v[i][i];

    if(pivot != 1.0 and pivot != 0){
        for(int t = i; t < n; t++){
            a.v[i][t] = a.v[i][t]/pivot;
            invA->v[i][t] = invA->v[i][t]/pivot;
        }
    }

    //Update to the new pivot which must be 1.0
    pivot = a.v[i][i];

    for(j = 0; j < n; j++){
        if( j==i ){
            continue;

        }
        else{
            float l = a.v[j][i]/pivot;
            for(int m = 0; m < n; m++){
                a.v[j][m] = a.v[j][m] - l * a.v[i][m];
                invA->v[j][m] = invA->v[j][m] - (l * invA->v[i][m]);
            }
        }
    }
}
return invA; 
```

}

# python - Python：TypeError：'int'对象不可订阅

> ID：12715448
> 
> 赞同：0
> 
> 时间：2012-10-03T19:27:27.660
> 
> 标签：python

我编写了一个程序来计算外尔群的根。但是，我收到以下错误。

```
Traceback (most recent call last):
  File "./rootsAn.py", line 58, in <module>
    equals = isequal(x[0],y[0])
TypeError: 'int' object is unsubscriptable 
```

我已经查过了这个错误，但据我所知，`x[0]`并且`y[0]`都是数组，而不是`ints`. 我的代码是：

```
def innerprod(a,b):
    x = 0
    y = 0
    while x < len(a):
        y += a[x]*b[x]
        x += 1
    return y

def isequal (a,b):
    x = len(a)- 1
    y = 0
    counter = 0
    while y < x:
        if a[y] == a[x]:
            counter+=1
        else:
            counter +=0
        y += 1
    if counter == x:
        return True
    else:
        return False

simplerootsht = []
simpleroots = []
positiverootsht=[]
positiveroots = []
dim = 3

n = 0
while n < dim-1:
        x = []
        s = 0
        while s < dim:
            if s == n:
                x.append(1)
            elif s == n + 1:
                x.append(-1)
            else:
                x.append(0)
            s += 1
        simplerootsht.append([x,1])
        simpleroots.append(x)
        n += 1
for c in simpleroots:
    positiveroots.append(c)
for d in simplerootsht:
    positiverootsht.append(d)

print positiverootsht

for x in positiverootsht:
    for y in simplerootsht:
        equals = isequal(x[0],y[0])
        if equals == True:
            pass
        print x[0], y[0]
        b = innerprod(x[0], y[0])
        a = len(x[0])
        if b == 0:
            pass
        else:
            r = x[1]
            q = r - b
            print r, q
            x = 1
            while x < q: 
                z = [sum(pair) for pair in zip(x[0], x*y[0])]
                if z not in positiveroots:
                    positiveroots.append(z)
                    positiverootsht.append([z,x[1] + y[1]])
                x += 1 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:30:15.387

```
for x in positiverootsht: 
```

positiverootsht 是一个整数列表.. 当你迭代它们时，它们会在 x 中给出整数.. 所以，x 实际上是一个 int.. 它们不能像`isequal()`方法中的 x[0] 那样下标..

`y`.. 它也是一种类型`int`。

**所以，下面的行将不起作用： -**

```
equals = isequal(x[0],y[0]) 
```

相反，您可以更改您在循环中使用的变量以使其工作.. 因为 then`x`将仅像您在方法中之前声明的那样充当列表..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:32:22.510

在您的示例`x`中，遍历`positiverootsht`. `positiveroots`被添加到 from `simpleroots`which has ints. 所以`x`和`y`都是整数。

您正在重用变量，因此虽然`x`之前是一个数组，但您使用以下几行将其转换为 int：

```
for x in positiverootsht:
    for y in simplerootsht: 
```

# c# - Visual Studio 右大括号扩展

> ID：12715452
> 
> 赞同：2
> 
> 时间：2012-10-03T19:27:46.040
> 
> 标签：c#, visual-studio-2010

当在 IDE 中看不到左大括号时，将覆盖右大括号后面的代码段名称的 Visual Studio 扩展是什么？直到最近它对我来说都很好，我不知道它在哪里。我安装了带有 ReSharper 6.1 和 Productivity Power Tools 的 VS2010。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:33:04.927

VSCommands 是您正在寻找的。 [http://visualstudiogallery.msdn.microsoft.com/d491911d-97f3-4cf6-87b0-6a2882120acf](http://visualstudiogallery.msdn.microsoft.com/d491911d-97f3-4cf6-87b0-6a2882120acf)

# java - 将 ListView 的选定项作为字符串或文本视图获取时的 ClassCastException

> ID：12715456
> 
> 赞同：2
> 
> 时间：2012-10-03T19:28:07.770
> 
> 标签：java, android

我得到**运行时错误**异常：

```
java.lang.ClassCastException: android.widget.TwoLineListItem cannot be cast to android.widget.TextView 
```

我的 Activity 扩展了 Activity而**不是**ListActivity ，这是我的布局结构：

```
<LinearLayout ...> <ListView ...></ListView> </LinearLayout> 
```

**爪哇：**

```
 ListView lv1 = (ListView) findViewById(R.id.listViewXMLdata);
    ArrayAdapter<String> arrAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_2,
        android.R.id.text2, getResources().getStringArray(R.array.countries));

    lv1.setAdapter(arrAdapter);

    lv1.setOnItemClickListener(new OnItemClickListener() {          
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {              
            lView.getItemAtPosition(position);

            String itemSelected = ((TextView) view).getText().toString();
            Toast.makeText(getApplicationContext(), "Clicked Position Number " + position + ": " + itemSelected ,
                    Toast.LENGTH_SHORT)
                    .show();

        }
    }); 
```

我唯一主要关心的是在我的列表中获取字符串（选择的项目）。

**注意 1**：我没有在任何数据库上工作。

**注意 2**：我已经尝试将其转换为 CharSequence itemSelected = ((TextView) view).getText().toString() 但仍然出现运行时错误。

仅当我开始选择列表中的项目时才会发生运行时错误。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-03T19:38:24.337

`android.R.layout.simple_list_item_2`有一个小部件作为它的根，它有`TwoLineListItem`两个孩子（两个`TextViews`），两行文本。将此小部件转换为 a`TextView`将失败，您在`logcat`. 搜索所需`TextView`的`findViewById`：

```
String itemSelected = ((TextView) view.findViewById(android.R.id.text2)).getText().toString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:39:28.503

您的 ListView 正在加载 TwoLineListItem 类型，并且您正在尝试将 View 转换为以下行中的 TextView：

```
String itemSelected = ((TextView) view).getText().toString(); 
```

将其更改为：

```
String itemSelected = ((TwoLineListItem) view).getText1().getText(); 
```

应该管用。

编辑：

Android 文档位于：http: [//developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html](http://developer.android.com/reference/android/widget/AdapterView.OnItemClickListener.html) 说：

> **public abstract void onItemClick (AdapterView parent, View view, int position, long id)**
> 
> 自：单击此 AdapterView 中的项目时要调用的 API 级别 1 回调方法。
> 
> 如果实施者需要访问与所选项目关联的数据，他们可以调用 getItemAtPosition(position)。
> 
> 参数
> 
> **parent** 单击发生的 AdapterView。
> 
> **view** 被点击的 AdapterView 中的视图（这将是适配器提供的视图）
> 
> **position** 视图在适配器中的位置。
> 
> **id** 单击的项目的行 id。

因此，作为参数传递给该方法的视图实际上是 TwoLineListItem，您应该将视图转换为的类型。

一旦获得对 TwoLineListItem 的引用，您就可以访问它的任何公共成员，包括两个 TextView：

> **公共TextView getText1()**
> 
> 自：API 级别 1 返回 ID 为 text1 的项目的句柄。
> 
> 返回 ID 为 text1 的项目的句柄。
> 
> **公共TextView getText2** ()
> 
> 自：API 级别 1 返回 ID 为 text2 的项目的句柄。
> 
> 返回 ID 为 text2 的项目的句柄。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-19T08:35:24.063

此外，您可以查看`android.R.layout.simple_list_item_2`，然后您会发现布局 xml 如下：

```
 <TwoLineListItem xmlns:android="http://schemas.android.com/apk/res/android" 
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:minHeight="?attr/listPreferredItemHeight"
        android:mode="twoLine"
        android:paddingStart="?attr/listPreferredItemPaddingStart"
        android:paddingEnd="?attr/listPreferredItemPaddingEnd">

        <TextView android:id="@id/text1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="8dp"
        android:textAppearance="?attr/textAppearanceListItem" />

        <TextView android:id="@id/text2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/text1"
        android:layout_alignStart="@id/text1"
        android:textAppearance="?attr/textAppearanceListItemSecondary" />

    </TwoLineListItem> 
```

有`TwoLineListItem`两个`TextView`s。希望这可以帮助。

# ruby-on-rails - 如何修复与 bootstrap-sass gem 样式表资产相关的 Ruby on Rails 参数错误？

> ID：12715458
> 
> 赞同：1
> 
> 时间：2012-10-03T19:28:19.487
> 
> 标签：ruby-on-rails, twitter-bootstrap, sass

我有一个基于 Michael Hartl 的 Rails 教程的 Ruby on Rails Web 应用程序。过去一周，我试图在我拥有的服务器上运行生产设置。当前设置包括 Ubuntu Server 12.04 LTS、RVM、Ruby 1.9.3、Rails 3.2.8、Apache2、MySQL 和Passenger。

我能够在网络上获取该应用程序，但它有一个错误。Ubuntu 机器在浏览器中显示错误（如下所示）。但是，除非我预编译我的资产，否则我的 Windows 7 开发机器上不存在该错误。我基于 twitter bootstrap-sass gem 的样式表资产似乎是罪魁祸首。如果我删除 custom.css.scss 的内容，应用程序加载没有错误，但显然没有样式。如果我只包含@import "bootstrap"；custom.css.scss 文件中的语句仍然有错误。我还尝试了 gem bootstrap-rails 并遇到了同样的错误。如果您需要更多信息来回答问题，请告诉我。谢谢！

显示 /home/cdysert/railsprojects/testapp/app/views/layouts/application.html.erb 其中第 5 行提出：

> 参数数量错误（1 代表 0）（在 /home/cdysert/railsprojects/testapp/app/assets/stylesheets/custom.css.scss 中）

提取的源代码（第 5 行附近）：

```
2: <html>
3:   <head>
4:     <title><%= full_title(yield(:title)) %></title>
5:     <%= stylesheet_link_tag "application", media: "all" %>
6:     <%= javascript_include_tag "application" %>
7:     <%= csrf_meta_tags %>
8:     <%= render 'layouts/shim' %> 
```

自定义.css.scss

```
@import "bootstrap";

/* mixins, variables, etc. */

$grayMediumLight: #eaeaea;

@mixin box_sizing {
-moz-box-sizing: border-box; 
-webkit-box-sizing: border-box; 
box-sizing: border-box;
}

/* universal */

html {
overflow-y: scroll;
}

body {
padding-top: 60px;
}

section {
overflow: auto;
}

textarea {
resize: vertical;
}

.center {
text-align: center;
h1 {
margin-bottom: 10px;
}
}

/* typography */

h1, h2, h3, h4, h5, h6 {
line-height: 1;
}

h1 {
font-size: 3em;
letter-spacing: -2px;
margin-bottom: 30px;
text-align: center;
}

h2 {
font-size: 1.7em;
letter-spacing: -1px;
margin-bottom: 30px;
text-align: center;
font-weight: normal;
color: $grayLight;
}

p {
font-size: 1.1em;
line-height: 1.7em;
}

/* forms */

input, textarea, select, .uneditable-input {
border: 1px solid #bbb;
width: 100%;
padding: 10px;
height: auto;
margin-bottom: 15px;
@include box_sizing;
}

#error_explanation {
color: #f00;
ul {
list-style: none;
margin: 0 0 18px 0;
}
}

.field_with_errors {
@extend .control-group;
@extend .error;
}

/* header */

#logo {
float: left;
margin-right: 10px;
font-size: 1.7em;
color: white;
text-transform: uppercase;
letter-spacing: -1px;
padding-top: 9px;
font-weight: bold;
line-height: 1;
&:hover {
color: white;
text-decoration: none;
}
}

/* footer */

footer {
margin-top: 45px;
padding-top: 5px;
border-top: 1px solid $grayMediumLight;
color: $grayLight;
a {
color: $gray;
&:hover { 
color: $grayDarker;
}
}  
small { 
float: left; 
}
ul {
float: right;
list-style: none;
li {
float: left;
margin-left: 10px;
}
}
}

/* sidebar */

aside {
section {
padding: 10px 0;
border-top: 1px solid $grayLighter;
&:first-child {
border: 0;
padding-top: 0;
}
span {
display: block;
margin-bottom: 3px;
line-height: 1;
}
h1 {
font-size: 1.6em;
text-align: left;
letter-spacing: -1px;
margin-bottom: 3px;
}
}
}

.gravatar {
float: left;
margin-right: 10px;
}

.stats {
overflow: auto;
a {
float: left;
padding: 0 10px;
border-left: 1px solid $grayLighter;
color: gray;
&:first-child {
padding-left: 0;
border: 0;
}
&:hover {
text-decoration: none;
color: $blue;
}
}
strong {
display: block;
}
}

.user_avatars {
overflow: auto;
margin-top: 10px;
.gravatar {
margin: 1px 1px;
}
}

/* users index */

.users {
list-style: none;
margin: 0;
li {
overflow: auto;
padding: 10px 0;
border-top: 1px solid $grayLighter;
&:last-child {
border-bottom: 1px solid $grayLighter;
}
}
}

/* microposts */

.microposts {
list-style: none;
margin: 10px 0 0 0;

li {
padding: 10px 0;
border-top: 1px solid #e8e8e8;
}
}
.content {
display: block;
}
.timestamp {
color: $grayLight;
}
.gravatar {
float: left;
margin-right: 10px;
}
aside {
textarea {
height: 100px;
margin-bottom: 5px;
}
}

/* miscellaneous */

.debug_dump {
clear: both;
float: left;
width: 100%;
margin-top: 45px;
@include box_sizing;
} 
```

宝石文件

```
source 'https://rubygems.org'

gem 'rails', '3.2.8'
gem 'bootstrap-sass', '2.0.4'
gem 'bcrypt-ruby', '3.0.1'
gem 'will_paginate', '3.0.3'
gem 'bootstrap-will_paginate', '0.0.6'
gem 'jquery-rails', '2.0.2'
gem 'mysql2', '0.3.11'
gem 'vincenty', '1.0.3'

group :development, :test do
  gem 'rspec-rails', '2.11.0'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
  gem 'sass-rails',   '3.2.5'
  gem 'coffee-rails', '3.2.2'
  gem 'uglifier', '1.2.3'
  gem 'therubyracer', '0.10.2'
end

group :test do
  gem 'capybara', '1.1.2'
end 
```

# cpu - 哪些 CPU 指令最耗电？

> ID：12715461
> 
> 赞同：9
> 
> 时间：2012-10-03T19:28:43.470
> 
> 标签：cpu, cpu-usage, power-management

背景是这样的：下周我们的办公室将有一天没有暖气，因为维护。室外温度预计在 7 到 12 摄氏度之间，因此可能会变冷。便携式电加热器太少，无法满足所有人的需求。

但是，在我大约 6 到 8 平方米的办公室里，有一个大的 honkin （3 岁）工作站（HP xw8600 和 3.0 GHz 四核 Xeon）应该能够输出几百瓦的热量。运行[Furmark](http://www.ozone3d.net/benchmarks/fur/)将使 GPU 最大化，但我不确定如何最好地使用 CPU。

上次我在冷办公室时，我要么编译得更频繁，要么只是启动了运行 Norton Commander 的 4-8 个 DOSBox:es，但我认为使用 SSE1-2-3-4、MMX 等可以做得更好，即可以做的东西每个周期的工作量更多。

**那么，哪些 CPU 指令在每个周期切换最多的晶体管，从而导致 CPU 消耗最多的功率，从而释放出最大的热量？**

*如果我有可用的功率计，那么我可以对自己进行基准测试，但我认为这对 SO 人群来说将是一个有趣的挑战。:)*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-11T02:49:48.860

对于您的特定目标，如果您真的想将您的系统用作热发生器，您需要首先确保冷却系统运行良好（将热量从盒子中排出）。今天的处理器被设计为在达到临界温度时自行调节，当使用适当的散热器并且处理器处于 TDP 时会发生这种情况（[热设计功率](http://en.wikipedia.org/wiki/Thermal_design_power)是使用正常程序的处理器的最大功率）。如果您有更好的散热器和良好的通风（箱式风扇？），假设您的电源可以处理它，您可能会超越 TDP。如果你关掉风扇，你基本上会马上达到热极限。

更明确地说，燃烧最多的单个指令通常是在缓存中丢失并进入内存的加载指令。为了保证未命中，您需要分配一块比最后一级 CPU 缓存更大的内存并在该内存周围跳跃。最大功率情况下的跳跃模式有点复杂，因为您试图同时在缓存层次结构的每个级别上获得最大的未命中数。如果您有 3 级高速缓存，在给定的时间段内，您对 L1 的未命中率可能比对 L2 的未命中率要多于对 L3 的未命中率，而不是对 DRAM 页面的未命中率。（并且您的处理器的特定设计将对未命中有一个总限制。）在未命中之间，指令并不重要，但我'

有趣的是，运行 GPU 可能会限制使用未命中到 L3 缓存产生的热量，因为内存可能会被 GPU 阻塞。在这种情况下，您应该确保对 L3 的所有访问都是命中，但您在其他级别中丢失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-11T20:49:25.310

对于 GeForce 显卡，我的 CudaMFLOPS 程序（免费）对于在显卡上获得高温非常方便。如果您有适当的卡详细信息，请参见：

[http://www.roylongbottom.org.uk/cuda1.htm#anchor8](http://www.roylongbottom.org.uk/cuda1.htm#anchor8)

我发现使用 L1 缓存中的数据执行 SSE 指令的测试通常会产生最高的 CPU 温度。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-11T18:27:34.603

对于 CPU，使用 Prime95。那是轻量级的，可以很好地加载所有内核。不过，您不会真的从 3ghz xeon 中获得太多热量。那个时代的芯片通常适用于平均冷却超过 4ghz，而高端水回路接近 5ghz。使用 6 核芯片 @ >4ghz 并添加额外电压，您可能会达到 200w TDP，但使用该系统，您将幸运地将 cpu 提高到 100w。

至于 GPU，Heaven Benchmark 非常适合快速升温。同样，除非您拥有高端卡，否则不太可能产生几百瓦的热量。AMD gpus 上的另一种选择（也许 nvidia 也是？）是使用 crpto 货币挖掘软件，也许得到一个安装了挖掘 linux 发行版并准备就绪的 USB 记忆棒。您还可以在同一台钻机上使用 Prime95，因为采矿软件使用的 CPU 时间非常少。

实际上，我用电脑的热量让几个房间在冬天保持温暖，很少需要额外的加热。这是通过一个加密货币采矿设备完成的，该设备有 4 个 gpus，24/7 全天候在 ~80 摄氏度下运行，并带有一个箱式风扇，用于在房间内循环空气。那台钻机有一个 1300W 的 PSU。我是否可以建议，与其尝试使用电脑保暖，不如多穿点衣服？

# list - SML：列表上的映射函数，其函数采用超过 1 个参数

> ID：12715464
> 
> 赞同：1
> 
> 时间：2012-10-03T19:29:00.113
> 
> 标签：list, map, sml

我有一个 SML 中的 N 个元素的列表。

我想对该列表中的每个元素应用一个函数，所以我使用了 map。

但是我要应用的函数有多个这样的参数：

```
 foo a b (c, d) 
```

其中 a 是我从列表中使用的元素， bc 和 d 是预定义的变量，每次都相同。

我这样声明我的函数：

```
 fun foo2 = map foo aList b (c,d) 
```

但我得到一个运算符和操作数错误，这是意料之中的，但我可以想到任何其他方法来做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T20:22:00.973

```
fun foo2 list = map (fn x => foo x b (c, d)) list 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T20:06:22.210

如果更改 foo 的 args 的顺序会最方便；当然，您可以制作一个包装器：

```
fun foo_swapped_args b (c,d) a = foo a b (c, d) 
```

然后你可以做

```
map (foo_swapped_args b (c,d)) aList 
```

# python - Django 文件浏览器异常。我不明白怎么了

> ID：12715469
> 
> 赞同：1
> 
> 时间：2012-10-03T19:29:08.783
> 
> 标签：python, django, django-filebrowser

我正在努力让它发挥作用。我有很多错误，但这个是最奇怪的。请帮助我理解这里出了什么问题。这是日志：

```
KeyError at /
'filebrowser'
Request Method: GET
Django Version: 1.4
Exception Type: KeyError
Exception Value:    'filebrowser'
Exception Location: /home/vhosts/malinnikov.tomsk.ru/private/new_malinnikov/filebrowser/sites.py in get_default_site, line 88
Python Executable:  /opt/python27/django/1.4/bin/python
Python Version: 2.7.0 
```

模板渲染期间出错：在模板 /home/vhosts/malinnikov.tomsk.ru/httpdocs/templates/index.html 中，第 69 行出错

```
59  {% endblock %}
60  
61  {% block content %}
62      {% if cover_photos %}
63          <div id="cover-photos">
64          {% for object in cover_photos %}
65              <div class="cover-photo {% if forloop.last %}cover-photo-last {% endif %}">
66                  {% if object.link %}
67                      <a href="{{ object.link }}">{% else %}
68                      <a href="{% url gallery_index_page %}">{% endif %}<img
69                      src="{% version object.photo.path 'big' %}"
70                      {% if object.photo_in_gallery.title %}
71                          title="{{ object.photo_in_gallery.title }}"
72                          alt="Фотография {{ object.photo_in_gallery.title }}"
73                      {% endif %}
74                      /></a>
75                  {% if user.is_authenticated %}
76                      <div class="delete-link">
77                          <a
78                              title="Удалить фото"
79                              target="_blank" 
```

它是异常所在的 filebrowser/sites.py 中的函数代码。

```
78\. def get_default_site(app_name='filebrowser'):
79\. """
80\. Returns the default site. This function uses Django's url resolution method to
81    obtain the name of the default site.
82\.  """
83\. # Get the name of the default site:
84\. resolver = get_resolver(get_urlconf())
85\. name = 'filebrowser'
86.
87\. # Django's default name resolution method (see django.core.urlresolvers.reverse())
88\. app_list = resolver.app_dict[app_name]
89\. if not name in app_list:
90\.   name = app_list[0]
91\.    
92\. return get_site_dict()[name] 
```

我忘了说当我尝试在控制台中运行时会发生此错误：

```
manage.py loaddata ~/httpdocs/data-backup.json 
```

DB 为空时不会发生此错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-07T19:40:18.397

我得到了它。只是文件浏览器版本错误。

# f# - 如何制作一个模仿 Array.sum 的通用 Array.sumPair？

> ID：12715470
> 
> 赞同：1
> 
> 时间：2012-10-03T19:29:11.247
> 
> 标签：f#, inline

我想总结一个`('a* 'b)`数组

```
let inline sumPair (array: ('a * 'b)[]) =
    let array1, array2 = array |> Array.unzip
    (Array.sum array1, array2 |> Array.sum) 
```

显然这并不理想。我想也许一种方法是定义`+`and `zero`of my `tuple`，并使用内置的`Array.sum`，但找不到任何相关的教程。有什么帮助吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T19:46:33.983

```
let inline sumPair source = 
  let inline zero() = LanguagePrimitives.GenericZero
  Seq.fold (fun (xAcc, yAcc) (x, y) -> (xAcc + x, yAcc + y)) (zero(), zero()) source 
```

正如您在评论中所说的那样，它应该尽可能高效，我认为没有任何东西可以击败命令式版本：

```
let inline sumPair source = 
  let mutable xAcc = LanguagePrimitives.GenericZero
  let mutable yAcc = LanguagePrimitives.GenericZero
  for x, y in source do
    xAcc <- xAcc + x
    yAcc <- yAcc + y
  (xAcc, yAcc) 
```

它应该比第一个需要更少的分配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:43:36.560

如果您担心创建临时数组，这里有一个使用序列的简洁版本：

```
let inline sumPair (array: _ []) =
    Seq.sumBy fst array, Seq.sumBy snd array 
```

一个稍长但可能更有效的变体是：

```
let inline sumPair (array: _ []) =
        array |> Seq.map fst |> Seq.sum, array |> Seq.map snd |> Seq.sum 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-04T00:11:43.140

这是另一种方式。这不需要您使用 GenericZero：

```
let inline sumPair (array : (^T * ^U)[]) =
    array
    |> Array.reduce (fun (x0, y0) (x1, y1) ->
        (x0 + x1), (y0 + y1)) 
```

编辑：或者，如果您想要最大程度地兼容`Array.sum`（如 Daniel 建议的那样），只需添加一个空数组检查：

```
let inline sumPair (array : (^T * ^U)[]) =
    if Array.isEmpty array then
        LanguagePrimitives.GenericZero, LanguagePrimitives.GenericZero
    else
        array
        |> Array.reduce (fun (x0, y0) (x1, y1) ->
            (x0 + x1), (y0 + y1)) 
```

此代码不会完全内联（IL 仍将调用 Array.reduce），但如果您有一个巨大的数组，它确实具有可并行化的好处。

# android - 从共享首选项中获取布尔值总是返回 false

> ID：12715480
> 
> 赞同：0
> 
> 时间：2012-10-03T19:29:48.020
> 
> 标签：android, sharedpreferences

我将我的布尔值存储在我的偏好活动中：

```
OnPreferenceChangeListener locaListener = new OnPreferenceChangeListener() {    
            public boolean onPreferenceChange(Preference preference, Object newValue) {
                SharedPreferences.Editor editor = getPreferences(MODE_PRIVATE).edit();
                if(newValue.toString().trim().equals("true")){
                    editor.putBoolean("locationEnabled", true);
                }else if (newValue.toString().trim().equals("false")){
                    editor.putBoolean("locationEnabled", false);
                }
                editor.commit();
                return true;
            }
        }; 
```

并尝试在我的主要活动中像这样检索它：

```
SharedPreferences prefs = PreferenceManager.getDefaultSharedPreferences(this);
boolean prefLocationEnabled = prefs.getBoolean("locationEnabled", false); 
```

与字符串相同的方法可以完美运行，但使用布尔值似乎总是返回默认值，即 false。有人知道我在做什么错吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:40:35.363

一旦你在保存和加载时调用 getPreferences(MODE_PRIVATE)，你就调用 PreferenceManager.getDefaultSharedPreferences(this);

我认为这不是相同的偏好。仅使用其中一种

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-05T15:05:52.427

试试这个代码。如果您给出参数，如 true 或 false，它将返回您给出的值。

```
Boolean tmp = null;
tmp = sharedPreferences.getBoolean("key", tmp.getBoolean("")); 
```

它给你你得到的价值。

# php - 不区分大小写的用户名和密码盐

> ID：12715483
> 
> 赞同：0
> 
> 时间：2012-10-03T19:29:58.643
> 
> 标签：php, passwords, case-sensitive, salt

我有登录系统

例如，`Joe`可以使用用户名登录`joe`而没有任何问题。

目前，我正在使用使用用户名作为盐的密码加密。这会造成登录问题。例如，

```
SELECT * FROM `users` WHERE LOWER(`username`) = LOWER(`:username`)
$stmt->bindValue(':username', $_POST['user']); 
```

这工作正常。问题涉及密码：

```
SELECT * FROM `users` WHERE LOWER(`username`) = LOWER(`:username`)
   AND `password` = :password
$stmt->bindValue(':username', $_POST['user']);
$stmt->bindValue(':password', encrypt($_POST['password'], $_POST['user'])); //encrypt(password, salt) 
```

如您所见，密码加密不会检查数据库，因为用户已登录`joe`而不是`Joe`

有没有解决方法，或者我应该使用其他东西作为盐？如果是这样，我应该用什么作为盐？这是我的加密功能：

```
function encrypt($password, $salt) {
    return base64_encode(mcrypt_encrypt(MCRYPT_RIJNDAEL_256, md5($salt), $password, MCRYPT_MODE_CBC, md5(md5($salt))));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:32:35.457

首先，`strtolower($_POST['user'])`用作盐有什么问题？看起来它会起作用。

现在一般来说，盐应该是不可预测的。用户名并不是真的那么不可预测，所以虽然这不会是世界末日，但如果您用随机生成的适度长度的字符串替换用户名（它不必是加密强度随机的，只是不可预测）。

但**这里最大的问题是使用 MD5**，一段时间以来一直被认为是不安全的。如果您切换到其他哈希函数，安全性将会提高；SHA-1 并不是一个特别糟糕的选择（它确实有一个不受欢迎的特性：计算速度很快），但最适合此类应用的是具有可变负载因子的哈希函数，例如`bcrypt`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:52:53.017

这里有几个问题：

1.  盐的大小写敏感性
2.  您的密码“加密”方法

第一个问题是你所问的，所以让我们来看看。

因此，您的密码使用用户名加盐，并且您希望能够使用用户在登录期间输入的用户名作为加盐。如果您确定盐的标准化方案，这将起作用。不要在输入时使用它，而是在函数中使用它之前将其转换为小写或大写。

另一种选择是对数据库执行两个查询：一个是在存储用户名时提取用户名，第二个是实际检查密码。这不是最佳的，但它确实是你的麻烦中最少的。

> 有没有解决方法，或者我应该使用其他东西作为盐？如果是这样，我应该用什么作为盐？

既然你问了，让我们看看第二个问题：你的密码“加密”方法。

出于多种原因，尝试发明自己的密码散列/加密方案绝不是一个好主意。您最好的选择是使用已经被广泛接受的密码散列方案，例如 bcrypt 或 PBKDF2 的一些衍生产品。这些都很棒，因为它们都包括盐渍和键拉伸。它们被设计为很慢（相对而言，无论如何），因此暴力破解这些类型的哈希在计算上非常昂贵。

使用上述密码散列方案之一也将解决您的第一个问题，因为这些方案使用内置的每用户盐。根据您选择实施这些方案的方式，您将不需要（不应该）提供自己的盐。顶级库将为您生成盐。

尝试查看这些库以进行密码散列：

*   [Openwall 的 PasswordHash 类](http://openwall.com/phpass/ "Openwall 的 PasswordHash")- 为 PHP4 编写，但也适用于最新版本。支持 bcrypt，但如果不支持 bcrypt（PHP < 5.3，主要是），将回退到它自己的方案。
*   [Anthony Ferrara's (ircmaxell's) PHP Password Library](https://github.com/ircmaxell/PHP-PasswordLib "PHP密码库") - 很棒的库，但需要 PHP 5.3+。
*   [我自己的 PHPassLib](https://github.com/rchouinard/phpass "PHPPassLib") - 类似于 Anthony 的库，但实现方式不同。3.x 分支试图更像 Python 的 PassLib。还需要 PHP 5.3+。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T19:32:39.257

跳过 SQL`lower`并使用 PHP 的[`strtolower()`](http://php.net/manual/en/function.strtolower.php). 这样，您的用户名将全面一致。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T19:37:48.487

您遇到的问题是用户名不应用作盐的原因之一。哈希密码的更好方法是使用`crypt()`. 你只需要生成一个随机盐来使用它。它返回的字符串包含哈希和哈希算法，因此您可以根据需要更改算法或难度，而无需重写代码。只要您的哈希是 7 位安全的，整个字符串就会是安全的，所以您不需要`base64_encode()`任何东西。

# search - 如何在 Elasticsearch 中针对多个位置字段进行 geo_distance 过滤

> ID：12715486
> 
> 赞同：0
> 
> 时间：2012-10-03T19:30:08.737
> 
> 标签：search, search-engine, elasticsearch, django-haystack

每个文档我有任意数量的位置数据点（最多 80 个）。我想对这些位置执行 geo_distance 过滤器。elasticsearch 文档声称：

```
 The geo_distance filter can work with multiple locations / points per document. 
  Once a single location / point matches the filter, the document will be included in the filter. 
```

从未明确说明如何实现这一目标。我假设您必须提前定义位置的数量，以便您的索引文档看起来包含这些嵌套字段：

```
 {
"pin" : {
    "location" : {
        "lat" : 40.12,
        "lon" : -71.34
    }
  }
}

{
"alt_pin" : {
    "location" : {
        "lat" : 41.12,
        "lon" : -72.34
    }
}
} 
```

我假设你会以某种方式过滤 pin.location 和 alt_pin.location 。

如果我有任意数量的位置（pin1、pin2、pin3、...）怎么办？我可以做这样的事情：

```
"pin" : {
    "locations" : [{
        "lat" : 41.12,
        "lon" : -72.34
    }, {
        "lat" : 41.12,
        "lon" : -72.34
    }]
}
} 
```

会有一些变化吗？也许使用 geo_hashes 而不是 lat/lng 坐标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T03:45:12.330

多个`location`值可以表示为`location`字段数组。尝试这个：

```
{
    "pin": [
        {
            "location" :{
                "lat": 40.12,
                "lon": -71.34
            }
        },
        {
            "location" :{
                "lat": 41.12,
                "lon": -72.34
            }
        }
    ]
} 
```

# arduino - 带有 Arduino Uno 的 Android ADK - 在 ADK 的 usb.cpp 中返回非零 @dispatchPkt

> ID：12715490
> 
> 赞同：1
> 
> 时间：2012-10-03T19:30:20.420
> 
> 标签：arduino

我必须`rcode`在`4`newIntransfer() 的这一行：

```
rcode = dispatchPkt(tokIN, ep, nak_limit) 
```

可能是什么错误？

我正在将 Huawei y200t 4.03 与[Arduino Uno](http://arduino.cc/en/Main/ArduinoBoardUno)和[ITead USB](http://www.simplelabs.co.in/content/itead-usb-host-shield-arduino) [shield](http://www.arduino.cc/en/Main/ArduinoShields)连接起来。我没有连接任何外部电源。

# dart - 不能从 dart:io 应用程序到 dart:html 应用程序的 spawnUri()？

> ID：12715492
> 
> 赞同：2
> 
> 时间：2012-10-03T19:30:40.670
> 
> 标签：dart, dart-isolates

这可能吗？也就是说，我试过了，还是不行。但理论上应该是可能的，不是吗？我只是来回传递消息，隔离内存空间等。

```
import 'dart:io';
import 'dart:isolate';

main(){
  final sp = spawnUri('path/to/dart_html_app.dart');
} 
```

抛出：

```
IsolateSpawnException: 'Do not know how to load 'dart:html' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T15:47:11.160

正如有人已经说过的那样，您不能`dart:html`在 VM 中导入（至少在这一点上）。您的解决方案是将应用程序拆分为两个库，您要生成的库不使用`dart:html`.

你到底想做什么？如果你认为你可以通过隔离让浏览器和虚拟机对话，那是行不通的。隔离使用 VM 中的线程池和浏览器上的 Web Worker（如果可用）。

如果您只想“从这个 URI 加载代码并像新隔离中的任何代码一样执行它”，那么这当然是可能的——为什么不呢？你只需要重构你的代码库，这样你就不会导入，`dart:html`除非你真的需要它。

# session - 会话超时杀死 aspnet 数据库中的“记住我”cookie

> ID：12715493
> 
> 赞同：1
> 
> 时间：2012-10-03T19:30:45.647
> 
> 标签：session, sitecore, sitecore6, remember-me, aspnetdb

我试图了解这是否有意义：

```
1\. User logs in, checks "remember me" checkbox.
2\. User logs out.
3\. User comes back and is automatically logged in. 
```

基本上，这正是您所期望的。这意味着它正在工作。这里有点奇怪：

```
1\. User logs in, checks "remember me" checkbox. (Or logs in using remember me.)
2\. User is inactive for over 20 minutes, so the session times out.
3\. User clicks a link and is sent to the sign in page.  
4\. User closes browser, then opens again.  They are taken to the sign in page. 
```

当该用户的会话由于不活动而到期时，似乎该用户的“记住我”已关闭。我试图在文档中找到有关此的内容，但无济于事。如果这是预期的行为，那很酷，但我想确认一下。

我们首先使用 Sitecore.Security.Authentication 管理器设置 cookie。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-18T08:49:45.483

首先，重要的是要知道即使是“记住我”令牌也有验证：“cookie”会在一段时间后过期，并且它是可配置的，即使它有一个默认值。您需要检查默认值。

其次，由于单点注销，“记住我”cookie 应该在注销后被删除（正如[@adam](https://stackoverflow.com/users/12280/adam)在他的评论中所说）。**记住我会记住跨会话的用户**，但如果他注销则不会。可以这样想：如果您有 Facebook 或 Google 帐户，并且在单击“记住我”后登录。然后你注销，然后再回来。系统将再次要求您提供凭据！（如果不是您尝试登录？您是否希望 Facebook 在您退出后仍能记住您？）

记住我的实际用途是这样的：您登录到一个网站，然后关闭您的浏览器（无需注销！），然后通过关闭浏览器您“丢失”会话。当您重新打开浏览器时，您将获得一个新会话。然后记住我开始工作：您无需再次输入凭据即可访问该网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:36:23.157

以我的经验，“记住我”功能从来没有正常工作过。似乎是一个永远存在的错误。如果太难记住，我通常只让我的浏览器存储 Sitecore 的登录信息。

# mysql - mysql中的分组数据

> ID：12715496
> 
> 赞同：0
> 
> 时间：2012-10-03T19:30:54.057
> 
> 标签：mysql

不能将表存储在表中吗？假设我有一个用户列表，每个用户都可以是一台或多台服务器的管理员。如果用户是管理员，那么我需要为每个服务器存储“过期”、“类型”列。那么如何更好地存储这些信息呢？我不想做这样的列：

Server1_Expired Server1_Type Server2_Expired Server2_Type 等。

我也可以为每个服务器创建表并存储相同的内容，但这看起来很荒谬。

如果很难理解，我很抱歉，我只是不知道如何解释。请试着理解我:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:38:55.213

创建一个名为`admin_servers`并有几列的表...`id, admin_id, server_id, type, expired`

此表创建管理员和服务器之间的链接。对于每一行，您还有一个`type`和`expired`值。

# c++ - tr1::hash 为 uint64_t

> ID：12715498
> 
> 赞同：2
> 
> 时间：2012-10-03T19:31:10.623
> 
> 标签：c++, linux, tr1

我正在尝试散列一个 64 位整数，

```
uint64_t temp = ...;
return tr1::hash<uint64_t>(temp); 
```

但是我得到了错误，

```
error: no matching function for call to ‘std::tr1::hash<long long unsigned int>::hash(uint64_t&)’ 
```

为什么这不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T19:47:51.530

`hash`是一*类*。你必须制作一个对象：

```
return std::tr1::hash<uint64_t>()(temp);
//                            ^^^^ 
```

# php - FuelPHP：两个问题——数据库和自定义函数

> ID：12715499
> 
> 赞同：0
> 
> 时间：2012-10-03T19:31:12.387
> 
> 标签：php, pdo, fuelphp

我对 FuelPHP 很陌生。

我的第一个问题是放置自定义函数的最佳位置是什么？现在，我刚刚在 app/classes 文件夹中创建了一个新文件 func.php 并像访问它一样`$func = new Func; $func->function_name();`- 我认为这不是最好的方法。

其次，对于我正在制作的东西，我将需要大量自定义查询。通常，我只是使用 PDO 的准备好的语句并执行它们，但我不确定如何使用 DB::query() 来清理用户输入，而不必清理每个单独的变量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:28:14.067

PHP 无法实现自动加载功能，所以很多人都使用类，就像您所做的那样...更多信息可在此 SO anwser 中找到：[Autoloader for functions](https://stackoverflow.com/questions/4737199/autoloader-for-functions)

对于准备好的陈述，你得到了：[http ://docs.fuelphp.com/classes/database/usage.html#binding](http://docs.fuelphp.com/classes/database/usage.html#binding)

如果你愿意，你仍然可以使用普通的旧 PDO，这是完全可能的。

# php - 如何卸载编译好的php

> ID：12715501
> 
> 赞同：18
> 
> 时间：2012-10-03T19:31:14.933
> 
> 标签：php, linux, makefile

我用 make install 安装了 php。现在我转到我编译我的 php 的目录并执行`make uninstall`. 它抛出这个错误`make: *** No rule to make target 'uninstall'. stop.`。

到底是怎么回事？

Centos6

PHP 5

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-03T19:34:55.510

如果没有“卸载”目标，则没有任何自动卸载和删除文件的方法。

如果幸运的话，你在一个 100% 专用目录（例如 /opt/your/php）中构建了你的 php，那么卸载可能就像删除这个专用目录一样简单，因为在构建/编译时生成的所有内容都将包含在这个目录中。

# shopify - Shopify 元字段的限制

> ID：12715506
> 
> 赞同：2
> 
> 时间：2012-10-03T19:31:43.950
> 
> 标签：shopify

我想知道 Shopify 中的实体可以拥有的元字段数量有什么限制。例如，在一个产品对象的给定命名空间下，你能有 1000 个唯一的键值对吗？有硬性限制吗？

请注意，我已经查阅了 Shopify 的 Metafield API 页面 ( [http://api.shopify.com/metafield.html](http://api.shopify.com/metafield.html) ) 上的文档，但它只说明了以下限制：

命名空间最多 20 个字符，键最多 30 个字符。

感谢帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T15:11:21.710

没有硬性限制，但是如果您要存储这么多信息，您可能需要考虑在本地进行，因为检索它会变得很痛苦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-12-14T23:33:32.307

迄今为止，我们应用于任何给定元素的最多元字段是**5434**。我们有一个当前包含这么多元字段的集合，而且它似乎工作正常！

我不建议这样做，因为如果需要手动干预，通过 Postman 查找和删除任何内容是一场噩梦。但这当然是可能的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-01T20:38:23.590

如果您有以下 MyNS.Key1 = 1 MyNS.Key2 = 2 ... MyNS.Key1000 = 1000

您应该能够像 products.metafields.MyNS[someKey] 一样访问它

所以不太难找回，或者我错过了其他东西

# cocos2d-iphone - cocos2d scaleX - 仅缩放中间部分

> ID：12715507
> 
> 赞同：1
> 
> 时间：2012-10-03T19:31:46.147
> 
> 标签：cocos2d-iphone, scale

我想为短菜单和长菜单使用菜单图像，当我缩放图像时，边缘看起来很糟糕。是否可以只缩放精灵的中间部分，或者有没有办法做我想做的事？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:18:49.813

您需要使用一种称为**9 Slice Scaling**的技术。它涉及将图像切成 9 个切片，以便只有中间部分在两个方向上缩放，而边缘仅向上/向下或向左/向右缩放以保留它们。

[我在GitHub 上](https://gist.github.com/1108677)有一个开源实现，它运行良好。

# date - 重叠日期范围内的累积天数

> ID：12715508
> 
> 赞同：2
> 
> 时间：2012-10-03T19:31:49.617
> 
> 标签：date, crystal-reports, report, range

我使用水晶报表 11。

我想做的是计算学生参加我们众多课程之一的独特天数。如果一个学生参加了 3 个日期重叠的课程，我只想每天数一次并得到一个数字。

使用学生的示例：

```
Algebra Jan 1 to Jan 10: 10 days
Science Jan 4 to Jan 11: 8 days
English Jan 9 to Jan 13: 4 days 
```

我希望答案是 13。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T03:06:56.090

好点子。如果他们总是超过一圈，那么这将起作用

创建一个公式，根据患者查找最大结束日期和最小开始日期。然后减去每个公式。

即：最大值（{xxx.enddate}，{xxx.patient}） - 最小值（{xxx.startdate}，{xxx.patient}）

如果计划日期之间存在间隔，这将不起作用，因为它将包括它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T06:43:45.483

按患者姓名对字段进行分组并使用

```
DistinctCount() 
```

可能会有所帮助。

# javascript - 如何使用 D3 绘制配置项及其依赖关系图？

> ID：12715511
> 
> 赞同：2
> 
> 时间：2012-10-03T19:32:02.503
> 
> 标签：javascript, d3.js, configuration-management, change-management, itil

我是 D3 的新用户，我正在尝试思考如何最好地实现我们的配置项的映射。

我正在寻找的本质上是一个树图（我认为），但具有相互关联的依赖关系。

## 数据

我正在使用 ITIL 风格的配置项，如逻辑服务、应用程序、机器等，它们构成了我们为客户提供的 IT 服务。

我将提供的 JSON 数据将来自我正在定义的 WebAPI 服务，因此可以返回数据，但这是必要的。

## 目标

我需要克服：

*   **配置项的名称**（“服务 A”、“服务器 1”、“数据库 XYZ”等）
*   配置项**类型**（用图标或颜色表示——现在不太重要）
*   那些**依赖最少**的东西在顶部
    *   即，服务由构成它的所有事物表示——应用程序、数据库等，我希望按照从服务向下的顺序排列层次结构。
*   所有元素之间的**关系，****不是严格分层**的。
    *   多个服务可能依赖于一个应用程序
    *   多个应用程序可能依赖于多个数据库，而这些数据库可能依赖于一个数据库服务器。
*   如果可能的话，可以通过单击从上到下关注树的一个分支（尽管这可能会在*以后*出现）

一旦我开始了解它，我想在 GitHub 上设置一些简单的东西，看看我是否可以使用 D3 为 IT 服务管理世界做出贡献。

## 问题

从哲学上讲，D3 是否旨在支持这种性质的可视化，实现它的最佳途径是什么？

谢谢！

# methods - 从私有 actionPerformed 方法访问类变量

> ID：12715512
> 
> 赞同：0
> 
> 时间：2012-10-03T19:32:07.110
> 
> 标签：methods, null, private

# 在下面的代码中，我不知道为什么从 jButton1ActionPerformed 方法访问时变量 uNomba 和 list 的值为 NULL。感谢您对我如何成功执行“new NewPlayer(uNomba, count, check, list).load();”的帮助。这样所有的值都传递给 NewPlayer 类。谢谢你。

第一类——即NewPlayer类

```
package mysound;

import java.awt.event.KeyEvent;
import java.awt.event.KeyListener;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.List;
import javax.swing.JFrame;
import javax.swing.JPanel;

public class NewPlayer extends JPanel implements KeyListener, Runnable{
boolean isUpPressed, isDownPressed, isSpacePressed, isDone;
static JFrame f;
int spacebars=0;
boolean within;
public List spacebarLogMs = new ArrayList(); 
public List numSbar = new ArrayList();
Calendar cal = Calendar.getInstance();
LogResult logNow = new LogResult();
String directory;
String tabname; //table name used in the database connection
String bdir;
private int uNomba; //user number obtained from NewSound class
private String target;
private int incr;
private int userno;
private boolean moveon=true;
private List randlist;
private List numlist;

public void load() {
    f = new JFrame();
    f.setSize(600,300);
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    f.setContentPane(this);
    f.setVisible(true);     
    setFocusable(true);
    addKeyListener(this);
    new Thread(this).start();
}

public NewPlayer() {   

}

public NewPlayer(int UNOMBA, List NUMLIST){
    this.uNomba = UNOMBA; //user number obtained from NewSound class
    this.numlist=NUMLIST;
}    
public NewPlayer(int USERNO, int INCR, boolean MOVEON, List NUMLIST){
    this.userno=USERNO;
    this.incr=INCR;
    this.moveon=MOVEON;
    this.numlist=NUMLIST;
}

public void keyTyped(KeyEvent ke) {
}

public void keyPressed(KeyEvent ke) {
    switch(ke.getKeyCode()) {
        case KeyEvent.VK_UP: isUpPressed = true; break;
        case KeyEvent.VK_DOWN: isDownPressed = true; break;
        case KeyEvent.VK_SPACE: isSpacePressed = true; 

        numSbar.add(System.currentTimeMillis());
            System.out.println("That was a spacebar. "+spacebars++);
            System.out.println("Current time: "+numSbar);
            break;
    }
}

public void keyReleased(KeyEvent ke) {
    switch(ke.getKeyCode()) {
        case KeyEvent.VK_UP: isUpPressed = false; break;
        case KeyEvent.VK_DOWN: isDownPressed = false; break;
        case KeyEvent.VK_SPACE: isSpacePressed = false; break;
    }
}

public void closePrj(){
    f.dispose();
}

public void run() { //introduce a target sound

   String targetChoice;
   int tIndex;       
   int i;
   bdir="C:\\Users\\Abiodun\\Desktop\\testdata\\main\\zero\\atext\\"; //dir for text files

   MainPlayer items =  new MainPlayer (uNomba);

   i=incr;
   while(moveon){
       System.out.println("Counter i: "+i+" Numlist: "+numlist);
       if (i<numlist.size()){
            int num = (int) numlist.get(i);
            System.out.println("Num :"+num);
            items.selectTarget(num);           
            items.selectChallenge(num);
            items.playChallenge();
            new WriteTime(bdir).tagTime(numSbar);
            items.dataLogger();
            moveon=false;
            new Continue (uNomba, i, moveon, numlist).load();
       }

   }
}
} 
```

第二类即Continue类

```
public class Continue extends javax.swing.JDialog {
    private int count;
    private int usernumb;
    private boolean check;
    private int uNomba;
    private String cdirectory;
    private String cbdir;
    private String ctabname;
    private String ctarget;
    private List list;

/**
 * Creates new form Continue
 */
public Continue(java.awt.Frame parent, boolean modal) {
    super(parent, modal);
    initComponents();
}

public Continue(int CUNOMBA, int COUNT, boolean CHECK, List NLIST){
    this.uNomba = CUNOMBA; //user number obtained from NewSound class
    this.count=COUNT;
    this.check=CHECK;
    this.list=NLIST;
}

private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {                                         
    // TODO add your handling code here:
    new NewPlayer().setVisible(false);//closePrj();
    count++;
    check=true;
    new NewPlayer(uNomba, count, check, list).load();        
            System.out.println("Continue: UserNumber: "+uNumb+", Count: "+count+", Check: "+check+", nList"+lst);
    this.setVisible(false);         
} 
```

谢谢斯格罗。这是我刚刚添加的内容：我在 NewPlayer 类中创建了以下内容： Continue ct = new Continue (new NewPlayer(uNomba, i, moveon, numlist));

在 Continue Class 中，私有 NewPlayer np;

```
public Continue (NewPlayer npy){
    this.npy=np;
} 
```

回顾一下，我遇到的主要问题是我无法从 Continue 类访问从 NewPlayer 类传递的值。我在 Continue 类的以下构造函数中测试了值，但在 Continue 类的其他任何地方都没有。

```
public Continue(int CUNOMBA, int COUNT, boolean CHECK, List NLIST){
    this.uNomba = CUNOMBA; //user number obtained from NewSound class
    this.count=COUNT;
    this.check=CHECK;
    this.nlist=NLIST;

   System.out.println("Continue-constructor - uNomba: "+uNomba+", nList: "+list); //works fine! but not outside this constructor.
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:42:05.733

您必须使用正确的构造函数创建 Continue 对象或创建 Default 构造函数。

您还想打印 System.out.println 中不存在的变量 uNumb。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:38:16.567

这段代码甚至可以编译，你没有构造函数默认值（没有字段）。这个：

```
public Continue(java.awt.Frame parent, boolean modal) { 
```

和这个：

```
public Continue(int CUNOMBA, int COUNT, boolean CHECK, List NLIST){ 
```

这不会编译：

```
Continue ctn = new Continue(); 
```

# php - 如何将数组中的所有键增加 1？

> ID：12715514
> 
> 赞同：41
> 
> 时间：2012-10-03T19:32:09.983
> 
> 标签：php, arrays

将数组中的所有键增加 1 的最简单解决方案是什么？

**前：**

```
$arr[0] = 'a';
$arr[1] = 'b';
$arr[2] = 'c'; 
```

**后：**

```
$arr[1] = 'a';
$arr[2] = 'b';
$arr[3] = 'c'; 
```

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-10-03T19:34:38.470

您可以使用

```
$start_zero = array_values($array); /* Re-Indexing Array To Start From Zero */ 
```

如果你想从索引 1 开始使用

```
$start_one = array_combine(range(1, count($array)), array_values($array)); 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2012-10-03T19:40:36.683

好吧，有一种非常简单的方法可以做到：

```
$arr = array('a', 'b', 'c');
array_unshift($arr, null);
unset($arr[0]);
print_r($arr);
/* 
Array
(
    [1] => a
    [2] => b
    [3] => c
)
*/ 
```

当然，仅适用于简单的*密集*阵列。

这是最简单的（但既是单线又适用于密集和稀疏数组）的方式：

```
$arr = array_flip(array_map(function($el){ return $el + 1; }, array_flip($arr))); 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2012-10-03T19:34:40.660

我不确定你为什么要这样做，但你应该能够循环：

```
$new_array = array();
foreach($arr as $key => $value){
   $new_array[$key+1] = $value;
}
$arr = $new_array; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-10-03T19:35:51.307

```
$count = count($arr);
for($i=$count; $i>0; $i--){
    $arr[$i] = $arr[$i-1];
}
unset($arr[0]); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-07-23T20:29:59.773

我知道这个问题已经很老了，但我最近遇到了一个类似的问题，并想出了一个很好的单行代码来解决任何类型的数组，使用任意整数作为起始键：

```
$array = array_combine(array_keys(array_fill($starting_index, count($array), 0)), array_values($array)); 
```

$starting_index 是您想要的初始整数键的任何值，例如 3。

这甚至可以与包含复杂对象的数组一起使用，这与使用 array_flip 的解决方案不同，并且不会像其他一些解决方案那样限制您从 0 或 1 开始索引。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-08-26T12:33:29.630

我不确定这是否有资格作为一个班轮，但这是一种不同的方式

```
$result = array_reduce(array_keys($arr),function($carry,$key) use($arr){
     $carry[$key+1] = $arr[$key]; 
     return $carry;
},[]); 
```

# c++ - 为什么我的结构中映射的构造函数不起作用？

> ID：12715515
> 
> 赞同：0
> 
> 时间：2012-10-03T19:32:12.637
> 
> 标签：c++, stl, map, constructor

这是我拥有的结构，我正在尝试为此编写默认构造函数。

```
struct Cnode
{
typedef std::map<char, int> nextmap;
typedef std::map<char, int> prevmap;

Cnode() : nextmap(), prevmap() {} //error
Cnode(const nextmap2, const prevmap2) : nextmap(nextmap2), prevmap(prevmap2) {}

}; 
```

请帮助我了解此错误的含义：

```
Type 'nextmap'(aka 'map<char,int>') is not a direct or virtualbase of 'Cnode'
Type 'prevmap'(aka 'map<char,int>') is not a direct or virtualbase of 'Cnode' 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T19:33:18.490

因为`nextmap`and`prevmap`不是变量，而是类型。正如`typedef`（它定义了一个类型）所清楚地表明的那样。

你的意思：

```
struct Cnode
{
std::map<char, int> nextmap;
std::map<char, int> prevmap;

Cnode() : 
  nextmap(), prevmap() {}
Cnode(const std::map<char, int>& nextmap2, const std::map<char, int>& prevmap2) : 
  nextmap(nextmap2), prevmap(prevmap2) {}

}; 
```

或者这可能会消除您的困惑：

```
struct Cnode
{
typedef std::map<char, int> MapOfCharToInt;  //defines a new type

MapOfCharToInt nextmap;                      //defines variables
MapOfCharToInt prevmap;                      //of that type

Cnode() : 
   nextmap(), prevmap() {} 
Cnode(const MapOfCharToInt& nextmap2, const MapOfCharToInt& prevmap2) : 
   nextmap(nextmap2), prevmap2(prevmap2) {}

}; 
```

# security - 如何通过多种方式处理帐户创建和登录

> ID：12715518
> 
> 赞同：1
> 
> 时间：2012-10-03T19:32:21.160
> 
> 标签：security, authentication, oauth

# 认证流程设计

在创建允许用户通过多种方式（facebook、twitter、本地帐户）注册和登录的服务时，通过多种方式处理帐户创建和验证的最佳方式是什么？

## 换句话说

想象一下这种情况：

*   用户通过发送他（或可能任何人）的**电子邮件**和**密码**（被散列等）创建一个普通帐户
*   为**方便起见**，用户可以立即访问他们新创建的帐户（*无需验证他们的电子邮件地址*）
*   然后，用户尝试使用外部 oAuth 服务登录：Twitter、Facebook 等
*   使用 facebook 登录时，发现已经（手动）使用相同的电子邮件地址创建了一个帐户

## 处理这个问题的最佳方法是什么？

我正在尝试提出一个既用户友好（方便）又安全的解决方案，可能的安全漏洞让我感到害怕。

## 例子

以**网络服务“Mixlr”**为例，让我们看看他们是如何处理这个问题的：

*   **我用****您**的电子邮件地址创建了一个帐户（对您来说很糟糕）
*   Mixlr 立即让我登录并让我开始使用他们的服务（这很方便）
*   他们还会向我发送一封电子邮件以验证我的帐户（即使我已经在使用它）
*   **您**决定要加入 Mixlr，因此您创建了一个帐户....但您选择使用**Facebook**来创建您的 Mixlr 帐户，而不是使用经典的注册过程
*   有趣的是，**Facebook会发回****我**用来创建**我**的帐户的相同电子邮件地址
*   Mixlr 决定“合并”这些帐户，只需将您的**Facebook**帐户添加为他们的服务中的新“连接帐户”

## 问题就在于此

如果**我仍然登录，使用该服务，从技术上讲，我对****您的** **Facebook**帐户有一些小的控制权....

这不是不安全……坦率地说，有点粗略吗？

然而，Mixlr 不允许用户在没有验证/确认其电子邮件地址的情况下“第二次”登录。

从本质上讲，我不知道为了方便和安全，中间立场是什么，而不首先要求用户在注册期间验证他们的电子邮件地址。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T17:07:44.463

这将是我对如何处理这个问题的建议：

**案例 1：用户在您的网站上创建帐户**

*   由于您的要求是用户无需验证其电子邮件地址即可直接访问该站点，因此您至少应该暂时进行此操作。如果他没有及时激活账号，你应该删除或者停用账号。
*   提供用于连接其他帐户（Facebook、Twitter 等）的按钮，与他们提供的电子邮件地址无关

**案例 2：用户点击*Login with ...***

*   从提供商处获取用户的电子邮件地址
    *   如果您的服务器上已经有该电子邮件的帐户，请向用户显示一个屏幕，他可以在其中登录该帐户，如果成功连接两个帐户
    *   如果他还不知道就让他
        *   创建本地帐户
        *   登录并使用不同的电子邮件地址连接本地帐户
        *   或者只是将他作为没有本地帐户的特殊用户登录（取决于您是否要支持此用例）

你当然不应该将未经验证的内容与经过验证的内容相匹配，因此 Mixlr 在这里做了一些非常糟糕的事情。在您连接它们之前，用户应该始终必须批准**这两个帐户（即同时登录两个帐户）。**

请注意，对于某些提供商，您也无法确定向他们报告的电子邮件地址是否经过验证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-06T16:13:14.540

我只想说不要将未经验证的帐户与通过 facebook 或其他方式创建的帐户合并，并且通过第三方服务创建的帐户将优先，因为他们必须使用该帐户进行身份验证。

# android - 当我启动我的应用程序时，如何强制我的 SQLiteOpenHelper 中的 onCreate 运行？

> ID：12715521
> 
> 赞同：1
> 
> 时间：2012-10-03T19:32:25.597
> 
> 标签：android, database, sqlite

我正在为 Android 编写一个应用程序。如果我第一次启动它会`onCreate`按预期运行。它不会再次运行。没关系，但我想强制它运行。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:51:34.600

转到设置 -> 应用程序 -> 管理应用程序，找到应用程序并清除数据。这将删除数据库和下次启动应用程序时调用的`onCreate(...)`原因。`SQLiteOpenHelper`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:37:40.513

以不同的方式做。onCreate 的内容放入不同的方法中。然后从 oncreate 调用这个方法。并且还调用此方法而不是强制调用 oncreate。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T19:56:41.163

将所需的代码写入`onStart()`而不是`onCreate()`.

`onStart()`每次您的应用重新启动时都会调用。`onCreate()`仅当 android 销毁活动或您从设置中强制停止它时才会调用while 。

# regex - 正则表达式匹配 FrontPage 2003 中的多个空格

> ID：12715525
> 
> 赞同：0
> 
> 时间：2012-10-03T19:32:38.783
> 
> 标签：regex, frontpage

我使用 FrontPage 2003，并且我想使用一个查找空格（多个空格）的正则表达式。这会忽略 1 个空格，但只匹配多个空格（在文本中，在 html 代码中找不到）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-02-22T22:40:21.793

只是为了更新......我最近正在使用 FrontPage 的奇怪 RegEx，并记得一些关于 stackoverflow 的问题，所以我查了一下。好的，FP 的 RegEx 确实有问题，所以你在 PCRE 中搜索大约 8 个字符的东西，你最好在 FP 中拼出很长的路来避免问题。

**要在 FrontPage 的源代码**部分中查找 2 个或更多相邻的空格，您需要`&nbsp;`在重复 OR 中查找，在它之前或之后有一个空格。要创建正确的搜索/替换以充分利用它，我们需要记住：

首先，FP 的编辑器将任何多于一个空格的序列转换为仅一个空格（通常）在前面加上一个重复的数字，`&nbsp;`以便空格的总数相同，但是在源代码中出现的内容如下所示：

`&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`（注意实际的空白空间在最后）

这就是 FP 编辑器使用 7 个空格键轻按时所做的事情。

其次，请注意，如果您在组附近添加一堆空格（甚至只是一个），就像上面 FP 编辑器创建的组一样，它可以将其添加为普通的空白字符，或者可以将其添加为`&nbsp;`--取决于它与什么相邻。

`&nbsp;`因此，当您使用 WYSIWIG 编辑器随着时间的推移添加多个空格时，您可以轻松地以重复和交替的空格和字符结束，然后 FP 将您添加的新空格转换为混合`&nbsp;`字符和空格字符，只需将它们附加到任何其他空格那里，`&nbsp;`仅当新添加的空格导致两个空格彼此相邻时，才将空格转换为。FrontPage 从来没有真正遍历整个文件来查找由空格和`&nbsp;`字符交替组成的空格字符串，因此您可以在一个大而长的字符串中混杂两者。它们将交替出现，在这种交替中，可以有重复的`&nbsp;`字符，但可能不会重复 ascii 空格。

[因此，要构建 FrontPage RegEx（我之前的帖子中提供了](https://stackoverflow.com/questions/12715525/regex-to-match-more-than-one-space-in-frontpage-2003/47878557#47878557)一个指向解释 FPRE (LOL) 差异的好页面的链接）——您需要以四种形式中的任何一种找到任意 2 个相邻的空格：

`&nbsp;`（最常见的，`&nbsp;`后面跟一个空格）

...或相反：（`&nbsp;`空格然后是`&nbsp;`）

...或 2 个或更多重复`&nbsp;`代码：`&nbsp;&nbsp;`没有空格

...或者，很少有两个普通空格： `...很少见，因为 FP 编辑器不知何故没有删除 - 注意通常这是因为它们不在可见的 HTML 文本中，而是在 HTML 标记或脚本或其他东西中，所以将它们替换为只有一个**可能**不会弄乱这些元素，但要注意。`

 `好的，让我们一起做...

我们需要构造一个正则表达式（使用 FrontPage 的怪异和错误的正则表达式）查找/替换。

我们的 FIND 必须要求至少存在上述四种可能的两个相邻空间排列中的一种：两个相邻的相同类型的空间，或者每个相邻的一个。否则，RegEx 模式必须 - 不 - 与文本匹配，以避免替换可能无害的 SINGLE 空格，但为什么要使用不必要的东西呢？

对于这种可能出现在 4 种可能排列（上图）中的 2 个相邻空格的模式，我们将使用一组圆括号（我们不需要在这里捕获 - 奇怪的 FP RegEx 中的捕获是用花括号完成的，顺便说一句）。

在这些圆括号内，我们将放置所有 4 种可能匹配的模式，并用竖线 | 分隔它们。指示“或”命令。然后在大括号之后，我们将放置一个 + 分隔符，表示我们需要找到这 4 个组合中的至少一个才能进行模式匹配。（同样，否则我们不会处理 2 个或更多空格，我们会跳过它。）

然后，由于任何类型的空格都可能出现在我们的匹配模式之前或之后——假设存在一个大而凌乱的长串交替类型的空格，并且这些在 FrontPage 中很常见——我们将添加一些可选的交替空间类型，两者都使用正常空格和`&nbsp;`, 到我们的搜索字符串，在每个之后我们将使用 * 分隔符，表示可以有 0 个或多个这样的东西，如果有，它们匹配。我们将在我们最重要的圆括号中放置一系列这些，然后在它们之后放置另一个系列。为什么？尽可能多地获取相邻空间，并尽可能多地进行查找/替换操作，而无需重复查找/替换操作以找出所有非常长的杂乱内容。

因此，如果我们像这样进行搜索，无论您的页面随着时间的推移变得多么混乱，您都不太可能需要在一个页面或整个站点上多次运行它，除非您有一个非常大的空间-mess，在这种情况下，只需再次运行它。保证第二次就全部搞定。（我在一个非常混乱的 FP 页面上尝试了它……它得到了所有的东西。）

这里是。是的，我们可以在 PCRE 甚至在 FrontPage 中将其缩短很多，但不要尝试，因为 FP RegEx 是错误的，它会遗漏一些东西或过度选择一些东西，或者更糟糕的是，如果你让它想太多，它只会锁定或崩溃 FP。

查找和替换 FIND：YES-在源代码中查找 YES-使用正则表达式 NO-匹配大小写 NO-仅查找整个单词

`*(\&nbsp\;)* *(\&nbsp\;)* *( \&nbsp\;|\&nbsp\; | \&nbsp\;\&nbsp\;)+ *(\&nbsp\;)* *(\&nbsp\;)* *`

（顺便说一句，上面的字符串以纯空格开头——ASCII Hex 20。它以星号结尾。）

替换为：（ `&nbsp;` 没有前导或尾随空格）

运行它，你就完成了。首先在一个凌乱的页面上尝试以确保。

这是在 FrontPage 2003 上创建的，使用 FP RegEx 比旧版本要好一些，但 FP 2002 大致相同。

是的，它又大又丑，但同样，不要过度思考 FP RegEx，也不要让 IT 做任何思考，否则它只会让你崩溃或搞砸搜索/替换。只需使用那个又长又丑的大东西就可以了。

祝你好运。这将起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:22:05.123

您可以使用正则表达式`/ {2,}/`匹配 2 个或更多空格。不知道正则表达式在 FrontPage 中是如何工作的，因为我不使用它，所以我真的不能提供更多的细节。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T23:12:47.867

我不熟悉 FrontPage 和 Notepad++ 以及您可能/必须在它们的上下文中使用的正则表达式引擎，所以我将把自己限制在一些一般性的评论中。

要在文本中查找匹配项（两个或更多空格），但不在 html 标记中（即在 < 和 > 之间），您可以使用如下正则表达式模式：

```
<.*?>|(?<spaces>\s{2,}) 
```

如果您的正则表达式引擎中的 {n,} 说明符有问题，您可以将 \s{2,} 替换为 \s\s+

此外，如果 < 和/或 > 是正则表达式引擎中的特殊（元）字符，则需要对它们进行分隔。（同样，我不熟悉 FrontPage 和 Notepad++ 环境。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-19T00:49:36.133

Frontpage 不允许在其代码编辑器中使用两个连续的空格——Frontpage 编辑器会自动`&nbsp;`将 html 代码中的第二个和任何连续的连续空格更改为 (ASCII Non-Breaking Space)。

在编辑过程中，或者即使它只是对站点重新计算或其他任务进行“内务管理”，它也会在不询问您的情况下执行此操作，并找到您可能使用其他编辑器添加的双倍空间。

但是，如果您在代码框中以这种方式编辑它，它将允许您在`&nbsp;`元素中散布空格，或者至少它在最新版本的 FP2003 中是这样，所以它可能仍然是这种方式。

此外，它会在编辑器中的一行末尾允许一个空格，然后在编辑器的下一行，它会允许另一个空格，并且它*通常*不会转换为`&nbsp;`- 但有时会根据编辑器的感知而有所不同需要转换那些。例如，它在转换多个空格时更具侵入性，即使在代码中以行分隔，如果它在 span 标签或 div 标签内，或者有时在表格单元格中（尤其是嵌套时）。

FrontPage 被构建为具有侵入性，并阻止您按照当时松散的 html 标准做它认为您不应该做的事情。（是的，它几乎没有达到那些微不足道的标准，并且标签和样式也很混乱，但它确实尝试过，而且它产生的内容通常在大多数浏览器上都是完全可见的，即使在今天也是如此。）

所以你会想找到：（空格）`&nbsp;`或它的相反顺序，并将它们全部替换`&nbsp;`为安全。

您可以在 FrontPage 自己的 Search/Replace 中执行此操作并检查 _IGNORE WHITE SPACE，以便它跨越 HTML 代码行中的中断并跨越代码中仅用于简化编码的选项卡。

如果你的 RegEx 很聪明，你可以创建一个捕获组，它可以找到这两种方法中的任何一种来表达一个空间，你将最小值设置为 2，最大值设置为你想要的最大值......比如 200。

如果您在“正常”PCRE RegEx 中执行此操作，则看起来像这样（匆忙输入，因此可能不完全正确，但您明白了）：

```
([ \&nbsp\;]{2,200}) 
```

但是 FrontPage 有它自己的 RegEx，它随着 FrontPage 的每个新版本而改变，只是为了让它变得有趣。括号的使用几乎都与 PCRE RegEx 不同，我认为选择捕获组的方式需要分组符号的不同位置。

FrontPage 自己的一组 RegEx 特殊字符现在随着站点的消失而被稀疏记录，但这里有许多参考：http:
[//www.softpanorama.org/Office/Frontpage/regular_expressions.shtml](http://www.softpanorama.org/Office/Frontpage/regular_expressions.shtml)

指向这些特殊 RegEx 规则的 Microsoft Office 链接已失效，但我将其放在下面，并且它仍然被 MSDN 上的许多页面和 MS 的各种帮助论坛中的其他地方链接到：

[http://office.microsoft.com/assistance/preview.aspx?assetid=hp030923241033&ctt=4&origin=ch063729491033](http://office.microsoft.com/assistance/preview.aspx?assetid=hp030923241033&ctt=4&origin=ch063729491033)

请记住，您始终可以使用允许您使用更标准的 RegEx 来浏览文件并查找和替换所有内容的编辑器，而不必担心屈服于 FrontPage 古怪的 RegEx 规则。此类编辑包括：

NoteTabPro、Note++、jEdit、UltraEdit、...更多

请记住，如果您从 FrontPage 软件外部编辑 FrontPage 页面，您需要在完成后转到**工具 >**重新计算超链接并重新输入该软件。如果您没有更改任何链接，那么这样做并不是必需的——因为基本​​上执行该操作只是为每个更改的文件更新“影子”.htm(l) 文件——影子文件位于 /_vti_cfg/ 的子目录中文件所在的目录，它主要只是跟踪实际 .htm(l) 文件内的链接。然后收集该信息并将站点地图/链接地图/导航地图记录在网站的根目录的 /_vti_pvt/ 目录中，在该目录中，它会在文件中构建一个巨大的链接列表（双向），名称如下：linkinfo.btr还有 doctodep.btr 和 deptodoc.btr。

上面的 ^^^ 非常重要（重新计算链接），即使您认为在 FrontPage 之外使用文件时**没有**干扰任何超链接，原因如下：

即使您仅通过 FTP 发布，使用 -no- FP 服务器扩展，您仍然需要这些文件是最新的。当您通过 FTP 发布时，从技术上讲，FrontPage 将此视为使用 DTI（设计时包含）而不是服务器包含，因此它会**预先合并**您的页眉/页脚等，并调整许多位置相对关系的超链接，并且确实如此这一切都在放置页面之前。所以你仍然需要这些 /_vti_whatever/ 目录和它们在你的设计端（MS-Win PC）上的各种文件来处理任何 FrontPage 功能仍然可行，即使你的服务器上没有（危险的！）FPSE。

（切题，但有价值：如果您在 FrontPage 中使用大型网站（仍然）并通过 FTP 上传，您需要快速进行这些重新计算**并****快速**创建网站报告，因此请找到向您展示如何使用 MkLink 或其他方式的页面之一将您的 \Cache\IE 设置为 RAMdisk 或至少 SSD 驱动器上的位置，因为那时 \Cache\IE\FrontPageTempDir 位于更快的驱动器上。当我清理 FP2003 并使用它来更新包含 60,000 个文件的旧站点时520 万个链接，我将它设置为缓存在 RAMdisk 上，它会在几分钟内重新计算，而旧方法需要几个小时。页面报告相同或更快的速度，即使结果是 500 万个链接或 60k 的列表文件。）

 **无论哪种方式，始终： 在您更改 FrontPage 客户端软件之外的任何文件后，**工具 > 重新计算超链接。**

最后一个是删除重复空格——在发布设置中有一个“删除重复空格”复选框，您可以在其中选择“优化已发布的 HTML”。确切的复选框可能在 FP2002 之后消失了，或者可能消除了作为不可更改默认值的“优化”选项内置的重复空间。您可以在您的版本上进行测试。

人们可能会嘲笑 FrontPage，它的编辑器现在创建的 HTML 是有问题的，但它速度很快，可以处理很多文件，并且在您不想迁移时仍然可以正常工作。它创建的 HTML 代码不是最新的，嵌套表可能会显示所有奇怪的东西，尤其是在 Firefox 中，通常在 Chrome 中......但是，您可以迁移到几乎相同的（现在免费，并且旧且不受支持）Microsoft ExpressionWeb 4。然后您可以选择您的 HTML 标准，包括 XHTML-transitional 或 HTML5（前者效果更好）。但是这样做，您会失去很多您在 FrontPage 中用于报告、拖放和一堆其他东西的东西。您获得了不可编辑的区域，这些区域可能很挑剔，但功能齐全，并且您最终会减少更清洁上传的开销。

简介： 不要太在意在 FrontPage 中尝试这样做。从可以快速处理它的编辑器中执行此操作，然后运行您的重新计算。应该没问题，除了FP编辑器下半部分（WYSIWYG部分）的站点的视觉外观通常依赖于多个空间来显示布局，但是……嘿，2003年现在已经是15年前了。:-)

最好的给你。**`

# apache - apache 服务器：将所有 url 请求重定向到 index.php

> ID：12715528
> 
> 赞同：1
> 
> 时间：2012-10-03T19:32:41.260
> 
> 标签：apache, .htaccess, redirect

我在我的 Mac 上使用 apache 服务器，一切正常。

现在我有一个网页，它`index.php`非常复杂： 在`index.php`中，它需要像这样的 url：`localhost/~username/hostname/page_a`。其内容`page_a`实际上是`.php`存储在`content`文件夹中的文件。所以在 中`index.php`，它只是解析`page_a`，并做一个 include: '' 来呈现请求页面。

但是在`.htaccess`中，重定向规则没有正确配置。

例如，如果我点击一个链接：`localhost/~username/hostname/page_a`，有没有办法将这个url重定向到`index.php`，同时该url仍然是`localhost/~username/hostname/page_a`，这样`index.php`才能正确解析和呈现它？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T21:13:17.880

这取决于它如何`index.php`处理请求。如果它只是在`$_SERVER`变量`'REQUEST_URI'`中查找请求的文件，那么你不需要传递任何东西。如果它查找查询字符串参数，则您的重写规则需要传递它。

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php [L] 
```

或者，如果您需要将查询字符串参数传递给它：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /index.php?url=$1 [L,QSA] 
```

如果规则中没有`R`标志或 an `http://`，则浏览器上的 URL 地址栏不会更改。如果有人`http://localhost/~username/hostname/page_a`在他们的浏览器中输入，`/~username/hostname/page_a`请求将被发送到服务器，重写规则将在内部将其重写为`/index.php`，并且 php 脚本可以查找请求并正确路由它，或者如果第二个规则在参数中`$_SERVER['REQUEST_URI']`查找用来。`/~username/hostname/page_a``$_GET['url']`

# javascript - jquery同位素过滤器完成后触发警报

> ID：12715533
> 
> 赞同：2
> 
> 时间：2012-10-03T19:32:58.097
> 
> 标签：javascript, jquery, jquery-plugins, jquery-isotope

我有 jquery isotope setup 并创建了一些过滤器。当我创建我选择一个过滤器时，同位素会做一个很好的小动画。我想在动画结束时触发警报。

此示例演示了发生的动画：

[http://isotope.metafizzy.co/demos/filtering.html](http://isotope.metafizzy.co/demos/filtering.html)

有任何想法吗？

这是点击过滤器的代码：

```
$('.filter').on( 'click', 'a', function( event ) {
        event.preventDefault();
        var $this = $(this);
        // don't proceed if already selected
        if ( $this.hasClass('selected') ) {
            return false;
        }

        // console.log('hello world');
        var $optionSet = $this.parents('.option-set');
        var group = $optionSet.attr('data-filter-group');
        options.comboFilters[ group ] = $this.attr('data-filter-value');
        $.bbq.pushState( options );

        // COUNT
        var $filtered = $('#isotope-container').data('isotope').$filteredAtoms;
        // get count of all filtered item
        alert($filtered.length);
        // get count of all filtered items that match a selector
        //$filtered.filter('.blue').length;
  }); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-04T01:20:34.100

从 v1.5 ( [changelog](https://github.com/desandro/isotope#changelog) ) 开始，Isotope 提供了一个回调来做到这一点；它在[Isotope 的介绍](http://isotope.metafizzy.co/docs/introduction.html)中有所描述（只需搜索页面`callback`）：

> 此外，您可以在选项对象之后指定回调。该功能将在动画完成后触发。

```
onAnimationFinished = function(){
  // code to be executed after the animation finishes
};

$('#container').isotope({ filter: '.my-selector' }, onAnimationFinished); 
```

对于实时示例，请查看[此 jsFiddle](http://jsfiddle.net/J5qFq/)，它在通过复选框输入更改过滤器或窥视[Isotope 的回调测试](http://isotope.metafizzy.co/tests/callbacks.html)源并搜索`changeBGColor`.

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-05-26T13:36:11.847

他们都没有为我工作。相反，我使用了事件部分中的解释：http: [//isotope.metafizzy.co/events.html](http://isotope.metafizzy.co/events.html)

```
function onLayout() {
        // What to do when layout fully rendered
    }
    // bind event listener
    $isotope.isotope( 'on', 'layoutComplete', onLayout ); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-18T19:22:48.120

这对我使用 Isotope 2.0 不起作用。我也没有使用 jQuery，所以香草 JS 的用法可能不同。

无论哪种方式，如果有人遇到这个问题，我可以使用 2.0 的事件回调：`iso.on('layoutComplete', myFunction)`.

有关同位素事件的更多信息：http: [//isotope.metafizzy.co/events.html](http://isotope.metafizzy.co/events.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-10T20:10:38.933

这些都不适合我。我不确定它是否是最新版本的同位素和/或 jQuery 2.1.1。无论如何，我在[github](https://github.com/metafizzy/isotope/issues/732)上找到了一个解决方案：

$isotope.bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd", myFunction);

# javascript - 无法在 Firefox 的 Window 上收听 DOMMouseScroll

> ID：12715535
> 
> 赞同：0
> 
> 时间：2012-10-03T19:33:06.323
> 
> 标签：javascript, jquery, events, firefox, scroll

我遇到了一个与 Firefox 的鼠标滚轮（DOMMouseScroll）事件相关的问题。我有一个标题 div、一个内容 div 和一个页脚 div。我希望用户能够在页眉和页脚上滚动页面，但不能在内容上滚动，因为它有一个地图对象（flash 对象）并且鼠标滚轮应该放大和缩小。

我正在使用 jQuery 1.8 和 Firefox 15.0.1。我花了几乎一整天的时间试图弄清楚这一点，在我看来这应该可行：

```
var isFireFox = (navigator.userAgent.indexOf('Firefox') != -1); 
var scrollEv = (isFireFox)? 'DOMMouseScroll' : 'mousewheel';

$(document).on(scrollEv, HandleScroll);

function HandleScroll(e)
{
    var sender = event.srcElement;

    alert(sender.id + " has sent event: " + e.type);

    if (sender.id == "viewerContent" || sender.id == "mapObject")
    {
        alert("Event is being blocked");
        e.stopPropagation();
        e.preventDefault(); 
    }
} 
```

我已经阅读了无数的帖子、线程和博客，我读到的所有内容都说这应该在 IE、Chrome 和 Firefox 中工作。当然，它在 FireFox 中不起作用。它甚至没有进入“HandleScroll”功能。另外，我认为甚至应该可以做一些更简单的事情，比如：

```
$('#viewerContent').on(scrollEv, false);
$('#mapObject').on(scrollEv, false); 
```

我是否忽略了一些简单的事情或什么？

谢谢您的帮助，

吉尔曼

**添加 ：**

按照 Fabrício Matté 的建议，我也尝试了这个：

```
$('#viewerContent').scroll(HandleScroll);
$('#mapObject').scroll(HandleScroll); 
```

还有这个 ：

```
$('#viewerContent').on('scroll', HandleScroll);
$('#mapObject').on('scroll', HandleScroll); 
```

无济于事！

**再次添加：**

jcubic 建议我使用此页面上的插件：[github.com/brandonaaron/jquery-mousewheel](http://github.com/brandonaaron/jquery-mousewheel)

我不太确定它是如何工作的，我是否应该通过脚本标记简单地将脚本包含在我的页面中，然后调用所提供链接示例中所示的方法之一？

谢谢

**进一步补充：**

我得到了插件工作，这很容易。但是，这并不能解决我的问题。它确实适用于标准 div，但它似乎不适用于包含 flash 内容的 div。我开始认为这是一个 flash 或 firefox 错误，可能在此处详述：http: [//cookbooks.adobe.com/post_Workaround_to_support_mouse_wheel_for_FireFox_with-13086.html](http://cookbooks.adobe.com/post_Workaround_to_support_mouse_wheel_for_FireFox_with-13086.html)

如果有人能证实这一点，我将不胜感激。

**另一个不起作用的解决方案：**

按照 sethetter 的建议，我尝试了这个：

```
var isOverContent;

$('#viewerContent').on('mouseover', function(){isOverContent = true;});
$('#viewerContent').on('mouseout', function(){isOverContent = false;});

document.onscroll = HandleScroll;

function HandleScroll(e)
{       
    if (isOverContent)
    {               
        console.log("Tried to block event");
        e.stopPropagation();  // Apparently, the "scroll" event cannot be prevented or canceled.
        e.preventDefault(); 
    }
} 
```

这允许我检测用户何时在 FireFox 中滚动查看器内容。但是，阻止默认和停止传播事件不起作用。页面不断滚动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T13:18:22.260

根据此页面（http://bytes.com/topic/javascript/answers/160971-window-onscroll-firefox），您可以尝试 window.onscroll = scrollHandler; 试一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T15:21:41.070

在 sethetter 建议的基础上，我最终写了这个：

```
<script type="text/javascript">
  var isFireFox = (navigator.userAgent.indexOf('Firefox') != -1);   

  if (!isFireFox)
  {
      $('#viewerContent').on('mousewheel', false);
      $('#mapObject').on('mousewheel', false);
  }     
  else if (isFireFox)
  {
    var isOverContent;                                                   
    var lastPosY;

    $('#viewerContent').on('mouseover', function(){isOverContent = true;});
    $('#viewerContent').on('mouseout', function(){isOverContent = false;});

    window.onscroll = HandleScroll;
  }

  function HandleScroll(e)
  { 
    if (isOverContent)
    {                   
      $(window).scrollTop(lastPosY);    
    }
    else
    {
      lastPosY = $(window).scrollTop();
    }
  }
</script> 
```

它并不漂亮，但它适用于 Firefox 和其他浏览器。当在 flash 对象上滚动时，它确实会发出一种故障效果，但它会阻止用户滚动页面。此外，似乎故障效果在 Firefox 中最不明显，因此我为 IE 和 Chrome 保留了更好的解决方案。

由于 sethetter 让我走上了正确的道路，我将他的答案标记为解决方案。

干杯!

吉尔曼

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-28T12:53:47.763

只是看到类似的问题并使用

```
onwheel 
```

代替

```
onDomMouseScroll 
```

可以解决我的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-18T08:33:03.367

我在[firefox+jquery 鼠标滚轮滚动事件错误](https://stackoverflow.com/questions/13274326/firefoxjquery-mousewheel-scroll-event-bug)中找到了一个解决方案。

通过以下代码检查它：

```
$(document).bind("mousewheel DOMMouseScroll", function (e) {
            e.stopImmediatePropagation();
            e.stopPropagation();
            e.preventDefault();

            var delta = parseInt(e.originalEvent.wheelDelta || -e.originalEvent.detail);

            alert(delta);
            return false;
        }); 
```

祝你好运。

# objective-c - 在objective-c中使用八进制格式的NSLog显示对象

> ID：12715536
> 
> 赞同：0
> 
> 时间：2012-10-03T19:33:08.913
> 
> 标签：objective-c, nslog, octal

我想以八进制显示文件的权限。下面的代码有效，但仅以十进制显示权限。任何想法如何将结果转换为八进制？%o 没有显示正确的结果。

```
NSString *path=@"/somepath";
NSFileManager *fm = [NSFileManager defaultManager];
NSArray *contents = [fm contentsOfDirectoryAtPath:path error:NULL];
NSString* fullPath = nil;

for(NSString* node in contents) {

    fullPath = [NSString stringWithFormat:@"%@%@",path,node];
    NSDictionary *fileAttributes = [fm attributesOfItemAtPath:fullPath error:NULL];

    unsigned *posix=(unsigned *)[fileAttributes valueForKey:NSFilePosixPermissions];
    NSLog(@"Permissions:%@", posix); //shows 420 decimal. I need to show 644 octal

} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:42:12.103

您可以使用格式`%o`以八进制输出。但是，`fileAttributes`字典包含`NSNumber`对象，因此您需要执行以下操作才能使其工作：

```
NSNumber *posixPermissions = [fileAttributes valueForKey:NSFilePosixPermissions];
NSLog(@"Permissions: %o", [posixPermissions shortValue]); 
```

# php - 如何正确使用动态页面的会话

> ID：12715547
> 
> 赞同：0
> 
> 时间：2012-10-03T19:33:49.600
> 
> 标签：php, mysql, session, dynamic, craigslist

这是我的问题的第二部分：

[创建/编辑 php 动态页面](https://stackoverflow.com/questions/12682660/creating-editing-a-php-dynamic-page)

我现在正在尝试将代码放在一起。如果您不想看我问题的第一部分，那么我会告诉您，我正在试验并制作一个允许用户发布特定城市活动的网站。首先用户使用下拉菜单选择状态，然后在下一页他们使用下拉菜单选择城市。一旦选择了城市，他们就会被带到 city.php，在这里我们使用数据库中的查询来显示人们为该特定城市发布的事件。无论如何，我想扩展城市并将 city.php 变成指向 events.php、jobs.php 或 forsale.php 的链接的索引。当用户点击其中一个链接时，仍会记住特定的城市，并会进行查询以提取这些信息。我只是在编码时遇到问题：

城市下拉菜单中的代码：

```
while($result = mysqli_fetch_array($doQuery)){
// $result contains id (cid) and name (cname) for each city
// $result - current row
// here we add HTML code for option "dynamically"
    echo "<option value='".$result["cid"]."'>".$result["cname"]."</option>";
    session_start();
    $_SESSION['cname'] = $city; 
```

来自 city.php 的代码：

```
session_start();
$_SESSION['cname'] = $city;
// import dbconnect.php
// we use require(not include) to stop the script if such file does not exist
// we use "once" because we do not need to establish dbconnection if it already exists
require_once("dbconnect.php");
// all data which we get from cityByState.php are stored in $_POST superglobal array
// in our case we have only one field "city" so we can get city id from $_POST["city"]
// also we use intval function for security purposes. It converts variable to integer.
$cityId = intval($_REQUEST["city"]);
// query which gets all info about required city
$query = "select * from cities where id=$cityId";
// run the query and handle possible errors
if(!($doQuery = mysqli_query($db, $query))){
    echo "Can not get info about the city!"; exit();
} 
```

我只是一个初学者，似乎无法理解如何正确使用会话来让我的网站正常工作。我也不确定我会用什么来确保我可以在 city.php 的子页面（事件、工作、待售）上进行正确的查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:01:20.260

一方面，您应该在开始的 php 标记下开始您的会话。至少为了其他人稍后查看此代码。

所以这篇庞大的帖子基本上是说“如何将选定的城市设置为会话变量并使用它从数据库中获取结果？”

好的，让我们从选择表单开始。让我们通过突破 php 并以正确的方式编写好的 ol html 来修改您的代码。始终避免在 php 中编写 html`(echo '<a href="">'... etc)`

```
<form id="city_select" action="" method="post">
    <fieldset>
        <select name="city">
        <?php while($result = mysqli_fetch_array($doQuery)): ?>
            <option value="<?php echo $result["cid"]; ?>" <?php echo ($result['cid'] == $_SESSION['city_id'] ? 'selected="selected"' : ''); ?>><?php echo $result["cname"]; ?></option>
        <?php endwhile; ?>
        </select>
        <input type="submit" name="submit" value="Submit">
    </fieldset>
</form> 
```

如果你不知道，这条线是一个[三元](http://php.net/manual/en/language.operators.comparison.php)运算符。您可以在该链接上看到一个示例...

```
<?php echo ($result['cid'] == $_SESSION['city_id'] ? 'selected="selected"' : ''); ?> 
```

它只是说如果行城市 ID 等于会话城市 ID，则添加`selected="selected"`到该选项的 html 中。

现在，在 php - 表单中您的操作属性指向的地方，您处理此请求......

```
<?php 
session_start();

if(isset($_POST['city']))
{
    $_SESSION['city_id'] = $_POST['city'];
    //you can do other processing here, like redirecting to the last page viewed to prevent double posting and that annoying re-submit form popup, etc
}
?> 
```

现在至少你的下拉菜单应该记住最后选择的城市。下一步是让您的结果关注该选择。显然你需要正确地逃避 $_SESSION['city_id'] 但对于这个例子让我们假设你已经这样做了......

```
$query = "select * from cities where id=".$_SESSION['city_id']; 
```

有很多方法可以改善这一点，甚至尝试开始都是危险的。我假设您使用的是过程式编程习惯而不是 OOP，您知道转义用户输入，并且您对 php 有基本的了解。如果您有任何具体问题，我可以更新这篇文章。

# iis-7.5 - AppPool 关闭可执行参数是否有内置参数

> ID：12715550
> 
> 赞同：2
> 
> 时间：2012-10-03T19:33:53.013
> 
> 标签：iis-7.5, application-pool

在 Rapid-Fail 保护模式下使用 IIS 应用程序池时，可以在失败时调用可执行文件。有哪些内置参数可用？

![在此处输入图像描述](../Images/76f9b860322ac666a3cfe3abe69545e0.png)

因此，例如调用重新平衡负载平衡器与刚刚关闭的网站的 IP 和主机头？

有这样的吗？

`c:\temp\lbsdk.exe {IP} {hostheader} {identity}`

该文档没有提及任何此类内置函数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-01T19:21:57.043

我知道这是一篇旧帖子，但我正在查找同样的问题，我发现了这篇博文：[http ://weblog.west-wind.com/posts/2006/Dec/19/IIS-7-and-快速故障保护](http://weblog.west-wind.com/posts/2006/Dec/19/IIS-7-and-Rapid-Fail-Protection)

根据最后一条评论（Cees meuleman 2012 年 2 月 24 日@凌晨 3:14）

他使用以下方法让应用程序池自动重置。

```
Shutdown executable: c:\Windows\System32\inetsrv\Appcmd.exe
Shutdown parameters: start APPPOOL <your website> 
```

或者，您可以选择执行 iisreset，如果失败则重新启动服务器：

```
Shutdown executable: c:\Windows\System32\iisreset.exe
Shutdown parameters: /rebootonerror 
```

# macos - 是否有将 linux 构建转换为 mac 构建的一般策略？

> ID：12715551
> 
> 赞同：1
> 
> 时间：2012-10-03T19:34:01.430
> 
> 标签：macos, opencv, build, cmake, distribution

我正在尝试构建一个软件库 cvBlobs，旨在帮助人们使用 python opencv 跟踪 blob。原则上应该可以构建和安装 linux 发行版，但是，实际上我不知道如何做到这一点。使用 CMake 不起作用。

一般来说，要做到这一点，人们会采取什么方法？步骤是什么？许多人想在 Mac OSX 环境中使用这个库，但是他们无法通过安装。

一个好的答案可能是一般性的，也可能是针对我的问题的。

[http://code.google.com/p/cvblob/](http://code.google.com/p/cvblob/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T22:16:02.910

[CMake](http://www.cmake.org/)是一个很棒的跨平台构建系统。我总是使用这个平台编写我的跨平台应用程序，这样我就可以在 Mac/Windows/Linux 上轻松构建软件。

有一次我什至配置[了 CMake 来构建一个 Debian 包来安装](https://stackoverflow.com/q/7249440/176769)我正在开发的 python 应用程序。

# css - CSS 将登录按钮粘贴到顶部

> ID：12715552
> 
> 赞同：0
> 
> 时间：2012-10-03T19:34:02.017
> 
> 标签：css, button

我想做这样的事情：

[http://puu.sh/1b5jU](http://puu.sh/1b5jU)

所以我在这里做了一些事情，但是当它在引导容器内时，它在所有屏幕上看起来都不一样，960px：

[http://justxp.plutohost.net/slyfiles/index.html](http://justxp.plutohost.net/slyfiles/index.html)

它在朋友屏幕上的样子：

[http://puu.sh/1b51h](http://puu.sh/1b51h)

这是所有的CSS

```
.delogin {
width: 70px;
height: 20px;
background-color: #443b28;
-webkit-border-radius: 0px 0px 7px 7px;
border-radius: 0px 0px 7px 7px;
position: absolute;
margin-left: 51%;
-webkit-transition: all 100ms ease-in-out;
        -moz-transition: all 100ms ease-in-out;
        -ms-transition: all 100ms ease-in-out;
        -o-transition: all 100ms ease-in-out;
        transition: all 100ms ease-in-out;
}

.login {
width: 70px;
height: 20px;
background-color: #443b28;
-webkit-border-radius: 0px 0px 7px 7px;
border-radius: 0px 0px 7px 7px;
position: absolute;
margin-left: 51%;
right: 0px;
-webkit-transition: all 100ms ease-in-out;
        -moz-transition: all 100ms ease-in-out;
        -ms-transition: all 100ms ease-in-out;
        -o-transition: all 100ms ease-in-out;
        transition: all 100ms ease-in-out;
}
.login:hover{
width: 70px;
height: 20px;
background-color: #443b28;
-webkit-border-radius: 0px 0px 7px 7px;
border-radius: 0px 0px 7px 7px;
position: absolute;
margin-left: 51%;
top: 5px;
-webkit-transition: all 100ms ease-in-out;
        -moz-transition: all 100ms ease-in-out;
        -ms-transition: all 100ms ease-in-out;
        -o-transition: all 100ms ease-in-out;
        transition: all 100ms ease-in-out;
}

#login {
float: right;
margin-right: 11px;
font-weight: bold;
font-size: 11px;
color: #fff;
-webkit-transition: all 100ms ease-in-out;
        -moz-transition: all 100ms ease-in-out;
        -ms-transition: all 100ms ease-in-out;
        -o-transition: all 100ms ease-in-out;
        transition: all 100ms ease-in-out;
  }
  #lock {
  background-image: url("../img/lock.png");
  width: 13px;
  height: 10px;
  position: absolute;
  top: 5px;
  left: 7px;
-webkit-transition: all 100ms ease-in-out;
        -moz-transition: all 100ms ease-in-out;
        -ms-transition: all 100ms ease-in-out;
        -o-transition: all 100ms ease-in-out;
        transition: all 100ms ease-in-out;
  } 
```

HTML：

```
 <div class="delogin">
      <div class="login">
             <div id="lock"></div>
             <span id="login"><a href="login.php">LOGIN</a></span>
      </div>
  </div> 
```

如果需要，这是整个 HTML\CSS：

[http://pastebin.com/qJkA99nW](http://pastebin.com/qJkA99nW)

问题：

如何将登录按钮粘贴到 960px 网格系统内的右侧而不使菜单将任何像素移动到任何一侧？让它在所有屏幕、浏览器上看起来都一样或相似？

我从来没有见过这种关于如何制作像这样的粘性按钮的问题或教程。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:41:07.620

添加`position: relative`到您的`.container`

```
.container {
    margin-left: auto;
    margin-right: auto;
    position: relative; /* this */
} 
```

然后设置按钮的位置

```
.delogin {
    -moz-transition: all 100ms ease-in-out 0s;
    background-color: #443B28;
    border-radius: 0 0 7px 7px;
    height: 20px;
    margin-left: 51%;
    position: absolute;
    right: 0; /* this */
    width: 70px;
} 
```

# c# - 调用线程必须是 STA，因为许多 UI 组件在 WPF 中都需要此错误。在 form.show()

> ID：12715554
> 
> 赞同：10
> 
> 时间：2012-10-03T19:34:17.830
> 
> 标签：c#, wpf, sta

首先，我已经阅读了网站上类似问题的几个答案，但老实说，我发现它们有点令人困惑（由于我缺乏经验而不是答案！）。我正在使用 FileSystemWatcher() 类来监视文件夹以查找正在创建/更改的文件。一旦事件发生，我想在项目中加载另一个表单。当新表单上的构造函数尝试执行时，我没有加载表单，而是收到错误消息。我只使用一个线程 - 我没有尝试在不同的线程下加载表单。我的代码如下

```
 //MainWindow
 public static void FolderWatcher()
  {
        FileSystemWatcher fsWatcher = new FileSystemWatcher();
        fsWatcher.Path = "C:\\dump";
        fsWatcher.Filter = "*";
        fsWatcher.NotifyFilter = NotifyFilters.LastAccess | NotifyFilters.LastWrite
        | NotifyFilters.FileName | NotifyFilters.DirectoryName;
        fsWatcher.Created += new FileSystemEventHandler(OnChanged);
        fsWatcher.EnableRaisingEvents = true;    
  }

  public static void OnChanged(object source, FileSystemEventArgs e)
  {
       var imagePreview = new ImagePreview();
       imagePreview.Show();
  }

  //SecondForm
  public partial class ImagePreview : Window
  {
        public ImagePreview()
        {
              InitializeComponent(); //error occurs here
        }
  } 
```

希望您能提供帮助，非常感谢。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-10-03T19:38:11.053

使用多少线程并不重要。只有一条规则：您创建 UI 的任何线程都必须是 STA。

如果您只有一个线程，那么这个线程必须是 STA。:-) 为了使主线程成为 STA，您需要使用以下`STAThread`属性`Main`：

```
[STAThread]
static void Main(string[] args)
{
    // ... 
```

如果你只是创建一个标准的 WPF 应用程序，主线程已经标记了所需的属性，所以应该不需要更改。

请注意，来自的事件`FileSystemWatcher`可能来自框架内部创建的其他线程。（您可以通过在 中设置断点来检查`OnChanged`。）在这种情况下，您需要将窗口创建*转发到 STA 线程。*如果您的应用程序是 WPF 应用程序，则可以通过以下方式完成：

```
public static void OnChanged(object source, FileSystemEventArgs e)
{
    var d = Application.Current.Dispatcher;
    if (d.CheckAccess())
        OnChangedInMainThread();
    else
        d.BeginInvoke((Action)OnChangedInMainThread);
}

void OnChangedInMainThread()
{
    var imagePreview = new ImagePreview();
    imagePreview.Show();
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-03T19:59:51.873

您正在从非 UI 线程调用 UI 内容（即从非 UI 线程`FileSystemWatcher`触发事件）。

我写了一个扩展方法，我在我的唯一一个 WPF 项目中使用过（呃）：

```
public static class DispatcherEx
{
    public static void InvokeOrExecute(this Dispatcher dispatcher, Action action)
    {
        if (dispatcher.CheckAccess())
        {
            action();
        }
        else
        {
            dispatcher.BeginInvoke(DispatcherPriority.Normal,
                                   action);
        }
    }
} 
```

所以现在，在使方法成为非静态方法之后，您可以访问 MainWindow Dispatcher，您可以在事件回调中执行此操作：

```
public void OnChanged(object source, FileSystemEventArgs e)
{
    this.Dispatcher.InvokeOrExecute(()=>{
       var imagePreview = new ImagePreview();
       imagePreview.Show();
    });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T19:43:53.237

使用主窗口的调度程序。通常每个应用程序只有一个 UI 线程，否则您可能会从 WPF 获得“无效的跨线程访问”异常。

文件系统观察程序在不同的线程上引发其事件，并且调度程序可用于使该代码在 UI 线程中运行。

在该事件处理程序中使用 Dispatcher.BeginInvoke 就可以了。:)

# jquery - 使用 JQuery 进行页面导航

> ID：12715555
> 
> 赞同：1
> 
> 时间：2012-10-03T19:34:19.313
> 
> 标签：jquery

我正在开发一个网络应用程序。这个网络应用程序有 4 个选项卡。当用户单击选项卡时，我希望内容类似于此站点滑入：[http](http://carrotcreative.com) ://carrotcreative.com 。

是否有推荐的 jQuery 插件来提供此功能？我似乎找不到一个好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:27:54.520

您可以使用简单的 jquery 代码来做到这一点。您需要将所有页面放在 2 个 div 中，一个将使用 animate 移动，外部的一个将用作掩码，这样您就不会有滚动条

```
<ul id="nav">
  <li>page1</li>
  <li>page2</li>
</ul>

<div class="mask">
  <div class="container">
    <div class="page">
    </div>
    <div class="page">
    </div>
  </div>
</div>

.mask { overflow: hidden; }
.page { float: left; } 
```

然后使用动画

```
$container = $('.container');
$pages = $container.find('.page');
$('#nav li').each(function(i) {
  $(this).click(function() {
     $container.stop().animate('margin-left', -$pages.eq(i).offest().left);
  });
}); 
```

这应该可以，但我没有测试它。

# c - Cortex M3 的引导加载程序

> ID：12715556
> 
> 赞同：11
> 
> 时间：2012-10-03T19:34:20.970
> 
> 标签：c, arm, bootloader, keil, cortex-m

我正在使用 mbed 的 LPC 1768 板（使用 cortex M3 cpu），我想在这里实现一些目标，主要是从 SD 卡升级用户应用程序，我正在编写两个程序，首先是引导加载程序/纳米内核，然后一个用户应用程序（helloworld 将作为开始）：

*   Bootloader/nano-kernel 在 0x00 地址运行，它会做一些检查并最终抓取 SD 卡上的二进制文件
*   Bootloader/nano-kernel 将在地址 0x9000 复制此二进制文件（稍后可能需要更改，但 bootloader/nano-kernel 不使用此空间，所以应该没问题）
*   引导加载程序在 0x9000 + 4 处跳转到用户应用程序

SD卡很容易解决，我在跳跃部分有问题。下面是跳转函数的代码。

```
void run(void) {

  void (*user_code_entry)(void);

  unsigned *p;   
  SCB->VTOR = (USER_FLASH_START & 0x1FFFFF80);

  // Load contents of second word of user flash - the reset handler address
  // in the applications vector table
  p = (unsigned *)(USER_FLASH_START +4); // USER_FLASH_START is 0x9000

  user_code_entry = (void (*)(void))p;

  // Jump to user application
  user_code_entry(); 
```

}

所以我编译了（我使用的是 Keil uvision4）用户应用程序将起始地址更改为 0x9000。如果我对我的板子进行编程（使用 flashmagictool），然后手动跳转（仍然使用 flashmagictool）到 0x9004（0x9000 + 4），用户应用程序将运行，所以我相信编译工作正常，因此用户应用程序可以在 0x9000 运行。

但是如果我运行引导加载程序/纳米内核，这个不会跳转到用户应用程序，不幸的是我无法调试，我不确定发生了什么......我也试过不使用 SD 副本部分，所以我首先对引导加载程序进行编程，基本上只是跳转到 0x9004。然后我对位于 0x9000 的用户应用程序进行编程。如果我重新启动开发板，引导加载程序会运行但不会跳转到用户应用程序。我检查了内存，似乎两个程序（引导加载程序 + 用户应用程序）都是正确的并且在正确的位置。

我确定我在这里遗漏了一些东西，我应该查看任何低级代码吗？我已经阅读了在线文档的音调，并且从我找到的示例中，他们以与我相同的方式跳转到用户代码......非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-03T23:33:40.213

Cortex M3 只能在 Thumb 模式下运行。因此，您总是必须跳转到`address +1`，否则会产生故障。

你试一试：

`user_code_entry = (void (*)(void))(USER_FLASH_START +4 +1);`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-22T07:11:51.067

只需阅读 NXP 网站上的 AN10866 文档即可。您已加载 PC 和堆栈指针，然后跳转到复位中断：

```
__asm void boot_jump( uint32_t address ){
   LDR SP, [R0]     ;Load new stack pointer address
   LDR PC, [R0, #4] ;Load new program counter address
}

void execute_user_code(void)
{
    /* Change the Vector Table to the USER_FLASH_START 
    in case the user application uses interrupts */
    SCB->VTOR = USER_FLASH_START & 0x1FFFFF80;

    boot_jump(USER_FLASH_START);
} 
```

# ruby-on-rails - 在选中复选框的情况下接收所有对象，rails 3.2.8

> ID：12715563
> 
> 赞同：0
> 
> 时间：2012-10-03T19:34:39.020
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

我正在发送系统私人消息。

我想在选中复选框的情况下捕获所有对象，如果用户单击垃圾箱，则发送到垃圾箱操作，如果单击垃圾邮件，则发送到消息控制器内的垃圾邮件操作。你可以看到下一张图片：

![在此处输入图像描述](../Images/9a5d6ea43b16b4199a3ae2cfebd227f8.png)

这是我的复选框 html：

```
<input class="check" id="506c82001d41c82198000056" name="506c82001d41c82198000056" type="checkbox" value="506c82001d41c82198000056"> 
```

生成：

```
<%= check_box_tag m.id, m.id, false, :class => "check" %> 
```

删除和垃圾邮件按钮是带有格式的链接：

```
<%= link_to "Delete", delete_message_path %>
<%= link_to "Spam", spam_message_path %> 
```

**如何将标有复选框检查的结果发送到每个操作？**

非常感谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:10:36.237

如果您想要一个纯 html 实现，您可以将表单路由到单个控制器操作，然后从那里处理删除和垃圾邮件逻辑或重定向到这些操作。

以你的形式

```
<%= form_tag('/messages_cleanup', method: :put) %>
  <%= submit_tag "Delete" %>
  <%= submit_tag "Spam" %>

  <%= message.each do |m| %>
    <%= check_box_tag m.id, m.id, false, :class => "check" %>
  <% end %>
<% end %> 
```

你可以有两个提交标签，它们指向某个 url，比如`/messages_cleanup`哪个有`match /messages_cleanup, :to => 'messages#cleanup'`.

然后在您的消息控制器中，您可以检查该`params[:commit]`字段中的提交类型。

```
def cleanup
  case params[:commit]
    when "Delete"
      # either handle delete logic here or redirect to delete path
    when "Spam"
      # either handle spam logic here or redirect to spam path
  end
end 
```

# windows-8 - 在后台 Windows 8 Metrostyle 应用 Javascript 中下载大约 8 到 12 mb 的文件

> ID：12715565
> 
> 赞同：1
> 
> 时间：2012-10-03T19:34:39.810
> 
> 标签：windows-8

我是 Windows 8 开发新手。我想要做的只是在后台进行简单的下载，如果应用程序被杀死或者它没有处于暂停或运行状态，则下载不应该停止。任何我可以学习和前进的链接都受到高度赞赏。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:49:31.507

有两个关键资源应该可以回答您的大部分问题（并为您提供一些启动源代码）：

[背景转移样本](http://code.msdn.microsoft.com/windowsapps/Background-Transfer-Sample-d7833f61)

[后台任务简介（Word doc）](http://www.microsoft.com/en-us/download/details.aspx?id=27411)

# jeditable - 可编辑的可编辑例程未触发

> ID：12715568
> 
> 赞同：0
> 
> 时间：2012-10-03T19:34:41.263
> 
> 标签：jeditable

以下是我的代码。双击事件没有被 jeditable 捕获和执行。

javascript:

```
$(document).ready(function(){
    $(".edit_area").editable('http://my_cgi_url', {
        event       : 'dblclick',
        type        : 'textarea',
        rows        : 3,
        cols        : 30,
        cancel      : 'Cancel',
        submit      : 'Save',
        indicator   : '<img src="images/indicator.gif">',
        placeholder: 'Double Click to enter text',
        tooltip : 'Double Click to edit...',
        name        : 'comment'
     });

    //Please note there is another peice of code which is capturing clikc events inside the table columns,
    // which goes like this...
    //I doubt it is catching the double-click before the above function....
    //I am not sure how to make the editable catch the doubleclick event??....

    var rowi, coli, cellval;  //global as called in other subroutine too....
    $(".mytbl tbody tr").live('click',function (e) {
        rowi = this.rowIndex;
        coli = e.target.cellIndex;
        cellval = $('tr').eq(rowi).find('td').eq(coli).text();
        var propvalue = $('tr').eq(0).find('th').eq(coli).text();
        //and some other functions.....
    });
}); 
```

HTML SAMPLE 一个表记录：edit_area div 的 id 对于每个表行都是唯一的。

在页面加载后通过 ajax 调用添加表格 - 因此页面加载时页面中不存在 id/div 等。只有 div mytbldiv 始终存在于页面上。

```
<div id="mytbldiv">
    <table class="mytbl" border="1">
        <tr><th>header1</th><th>Header2</th></tr>
        <tr><td>A</td><td><div class="edit_area" id="uniqelementid_forthisrow">text_to_edit</div></td></tr>
    </table>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T23:48:24.563

必须使用将新表添加到页面的 javascript 代码运行可编辑项。这样它就可以正确地附加到元素并按需要工作。

# excel - TEXT 函数在两个不同的电子表格中返回不同的值

> ID：12715572
> 
> 赞同：0
> 
> 时间：2012-10-03T19:34:57.050
> 
> 标签：excel, excel-formula

我对以下内容感到困惑：

*   在电子表格 A 上，`=TEXT(41432, "mm/dd/yyyy")`返回 06/07/2013
*   在电子表格 B 上，`=TEXT(41432, "mm/dd/yyyy")`返回 06/08/2017

都在同一台电脑上！这是怎么回事？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T19:38:04.693

检查文件上的选项：文件\选项\高级\向下滚动到计算此工作簿时，您会看到其中一个工作簿已激活使用 1904 日期系统。

1904 默认在 Mac 上使用，而不是在 PC 上

查看[这篇 microsoft kb 文章](http://support.microsoft.com/kb/180162)了解更多详细信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:52:45.403

要更新文件中的日期，您可以使用此宏。这将比手动更新更快。

```
Sub UpdateDates()
Dim sht As Worksheet, rg As range

'turn off updates to speed up code execution
With application
    .ScreenUpdating = False
    .EnableEvents = False
    .Calculation = xlCalculationManual
End With

For Each sht In ActiveWorkbook.Worksheets
    For Each rg In sht.UsedRange.SpecialCells(xlCellTypeConstants, xlNumber).Cells
        If IsDate(rg) Then rg = rg - 1462 'adjust + / - 1462 depending on your needs
    Next rg
Next sht

With application
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculation = xlCalculationAutomatic
End With

End Sub 
```

# matlab - 如果不增加值，则为空分配值（Matlab）

> ID：12715574
> 
> 赞同：3
> 
> 时间：2012-10-03T19:35:10.643
> 
> 标签：matlab

在matlab中是否可以检查一个值是否为空，如果它是空的，则分配一个值，否则（如果它不为空）在分配期间增加值？

例如：

在这段代码中，我递增`majorityList{l}`，虽然在开始时这个单元格是空的（不是 0），因此我不能递增它。这意味着我需要先检查一下，然后才能增加它。这可以在分配过程中完成吗？

```
 majorityList{l,2} = 'test'; 
 majorityList{l}=  majorityList{l}+1; 
```

我写的一个解决方案是：

```
if length(majorityList{l})==0 
     majorityList{l} = 0;
     majorityList{l} = majorityList{l} +1;
else
    majorityList{l} = majorityList{l} +1; 
 end 
```

虽然对于如此简单的事情来说这看起来相当难看......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T19:40:45.783

用于[`isempty`](http://www.mathworks.se/help/matlab/ref/isempty.html;jsessionid=8256e47aa83f3da44e2e258b2b29)那个

```
if ~isempty(var)
   var=var+1;
end 
```

另一方面，如果您不知道该变量是否存在，请使用[`exist`](http://www.mathworks.se/help/matlab/ref/exist.html).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T20:28:40.467

*如果您要递增单值变量*，而不是按元素递增矩阵，则可以执行单线、无检查器

```
var = sum(var) + 1; 
```

对于空矩阵，Sum 将为 0，`var`否则为实际值（作为单元素总和）。[根据空矩阵](http://www.mathworks.com/help/matlab/math/empty-matrices-scalars-and-vectors.html#f1-86384)上运算符的非空输出，sum 将为空值和非空值提供正确的输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T20:09:33.973

如果您知道要在循环中递增它，最简单的解决方案就是`majorityList`在循环外初始化为零：

```
majorityList{1} = 0;
while loop==running
    majorityList{1} = majorityList{1}+1;
end 
```

# syntax - 什么时候应该使用 clojure 箭头宏？

> ID：12715577
> 
> 赞同：18
> 
> 时间：2012-10-03T19:35:20.323
> 
> 标签：syntax, clojure, macros, operators

在尝试保持功能风格时，我很难理解何时应该更喜欢：

```
(-> [1 2 3] reverse last) 
```

超过：

```
(last (reverse [1 2 3])) 
```

当我在一个项目中遇到这两种风格时，我发现它打破了我的流程，因为我必须在考虑函数组合和考虑中间值状态之间切换。

我应该在什么时候使用哪个？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-03T20:51:50.213

我大多避免使用`->`单参数函数；当您拥有多参数函数时，它会更有用，因为它可以让您将每个函数保持在其“额外参数”旁边，而不会被焦点对象遮挡。

而且，你不必选择一个或另一个极端：我最喜欢的事情之一`->`是它允许你以任何顺序编写函数，你可以利用这种自由以任何方式编写代码你认为是最具可读性的。例如，也许您想强调您正在获取集合的最后一个，并且在上下文中它首先被反转的事实是无趣的：

```
(last (-> [1 2 3] (reverse))) 
```

或者也许倒车很重要，最后很无聊：

```
(-> (reverse [1 2 3]) (last)) 
```

顺便说一句，请注意我在这里写了`(last)`和`(reverse)`，而不是仅仅`last`，`reverse`即使`->`宏隐式地为你插入括号，如果你把它们排除在外。这是故意的：虽然它不是一种非常流行的风格，但我认为在给定的形式中始终使用括号是个好主意`->`。有几个原因：

*   这意味着当`(-> (blah) (fn [x] (+ 1 (* x 5))))`奇怪地扩展时你不会感到惊讶，因为你习惯于认为它`->`采用一种形式而不是一种功能。
*   它保持“这里是一个开括号”和“正在调用一个函数”之间的链接。能够对特定函数的调用进行 grep 非常好，这也是一个很好的视觉提示。如果省略括号，则调用函数时不会发出视觉信号。
*   `->`它在具有一些一元函数和其他多参数函数的多行中看起来更规则。例如：

    ```
    (-> attrs
        (update :sessions inc)
        frobnicate
        save-to-disk
        (get :uuid)) 
    ```

    把这两个东西放在中间是不是很恶心，看起来和其他东西都不一样？

我见过的唯一一个省略`()`s 的论点是它节省了两个打字字符，这根本不是一个论点。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-10-03T20:15:52.600

我的简短经验法则是**“哪个更接近于更具陈述性的英语句子”。**如果您将它们粗略地翻译成描述性的句子，我倾向于选择更准确地说明正在产生的事物的句子，而不是描述创建结果的过程的选项。有些人会想选择另一种方式。这些东西总是口味问题。

例如：

*   `(last (reverse [1 2 3]))`几乎是“最后倒车 1 2 3”
*   `(-> [1 2 3] reverse last)`有点像“从 1 2 3，反向，最后”

我发现第一个更具声明性，在这种情况下会选择它，其他人会选择不同的。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-10-04T04:09:57.767

由于它们在功能上是相同的，所以要考虑的主要问题是**哪个使代码更具可读性和可维护性？**

这基本上是一个判断电话。

`->`在以下情况下通常很有用：

*   您想非常清楚地表明您有一系列操作要按顺序执行
*   您可能希望在将来插入新步骤。简单 - 只需添加一个新行/表格。
*   您的步骤有一些额外的参数（很明显这些参数是步骤的一部分）
*   否则，深度嵌套的函数调用会令人困惑（尽管如果这确实是一个问题，还有其他重构方法......）

`(f (g x))`style 在其他情况下很有用：

*   它通常是一种更自然的数学运算/计算风格，因为它更接近于数学函数符号
*   它更灵活，因为它不要求传递的值必须始终是第一个 (with `->`) 或最后一个 (with `->>`) 参数
*   它没有想象额外的论点的精神开销

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-03T21:07:11.680

我同意那些已经回答的人，但我要补充一点，如果你和很多使用 C 的人一起工作，后一种格式可能对他们来说更易读，而如果你和很多 C# 大师一起工作，他们会更熟悉以前的格式与扩展方法。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-10-04T02:48:01.007

其他答案没有错，但我只想补充一点，`->`对我来说真正有意义的时候是你想强调应用了一系列操作。从左到右阅读意味着您自然会看到计算函数的顺序，一旦您超过 2 或 3 层嵌套，这真的很有帮助。使用长手形式，您有时必须在脑海中解析括号，深入到最低级别，然后返回以了解正在发生的事情。

# jquery - 在 jquery UI 对话框中，是否可以将模态对话框放在另一个模态对话框的顶部

> ID：12715579
> 
> 赞同：15
> 
> 时间：2012-10-03T19:35:28.053
> 
> 标签：jquery, jquery-ui, modal-dialog, jquery-ui-dialog

我有一个使用 jquery UI 对话框的模式对话框。我现在想在用户更改第一个对话框中的字段时弹出另一个对话框。两者都应该是模态的。

这是否可能，因为我尝试将这段代码放在那里，但似乎没有弹出任何内容。当从常规页面单击时，以下代码可以正常工作（其中带有 id 的选择控件：selectDropdownThatICanChange）但是如果我正在更改的同一个选择控件本身就是一个对话框，则对话框（“打开”）行什么也不做。更改事件触发并调用 open 方法，但没有弹出任何内容。

```
$("#secondModalDialog").dialog({
    resizable: false,
    height: 'auto',
    autoOpen: false,
    title: "Warning",
    width: 400,
    modal: true,
    buttons: {
        'Close': function () {
            $("#secondModalDialog").dialog('close');
        }
    }
});

$('#selectDropdownThatICanChange').live("change", function () {
    $("#secondModalDialog").dialog('open');
}); 
```

这是对话框（只是一个 div）

```
<div id="secondModalDialog" style="display:none">
      This is a test <br/> This is  atest
</div> 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-09T05:07:07.313

UI 对话框不是单例的 您可以根据需要打开任意数量的对话框。默认情况下，它们是堆叠的。但是当 Dialog 获得焦点时，它会出现在其他对话框的前面。

这是我为你创建的小提琴。[从第一个对话框打开对话框](http://jsfiddle.net/n725A/1/)

```
// HTML:
<div id="dialog-modal" title="Basic modal dialog">
    Adding the modal overlay screen makes the dialog look more prominent because it dims out the page content.
    <select id="dialogSelect">
        <option>123</option>
         <option>234</option>       
    </select>
</div>
<div id="another-dialog-modal" title="2nd Modal :O">
    Second Modal yayyay
</div>

// JS:
$( "#dialog-modal" ).dialog({
    height: 300,
    modal: true,
    buttons: {
        Cancel: function() {
            $(this).dialog('close');
        }
    }
});
$("#dialogSelect").change(function(){
    $( "#another-dialog-modal" ).dialog('open');
});
$( "#another-dialog-modal" ).dialog({
    autoOpen: false,
    modal: true,
    buttons: {
        Cancel: function() {
            $(this).dialog('close');
        }
    }
}); 
```

我在第一个对话框上放了下拉菜单，在更改事件上我在第一个对话框上方打开了另一个对话框。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-04-28T02:05:48.683

只是想让未来的发现者知道。可以使用 z-index 将 modalWidget 放在另一个之上。我正在使用 jquery ui 1.10.3。

你的方法是，你给你的对话框构造函数一个对话框类。

```
$("#secondModalDialog").dialog({
    title: 'Title',
    dialogClass: 'ModalWindowDisplayMeOnTopPlease',
    width: 200,
    height: 200
}); 
```

然后在你的 CSS 中，你指定一个比第一个对话框使用的更高的 z-index。

```
.ModalWindowDisplayMeOnTopPlease {
    z-index: 100;
} 
```

您可能需要使用 firebug 或一些开发工具检查它使用的是哪个 z-index 来检查它是使用哪个 z-index 实例化的。在第一个模态小部件上，我的默认 z-index 为 90。窗口代码看起来像这样：

```
<div id="firstModalDialog" class="ui-dialog-content ui-widget-content" style="width: auto; min-height: 0px; max-height: none; height: 737px;">
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-09T02:12:33.957

您可以打开任意数量的模式，默认行为是按照它们打开的顺序堆叠。

# [演示：jsFiddle](http://jsfiddle.net/MadLittleMods/JFpQZ/)

```
$('#dialog-modal').dialog({
    height: 300,
    modal: true,
    buttons: {
        'Another Modal': function() {
            $('#another-dialog-modal').dialog('open');
        },
        Cancel: function() {
            $(this).dialog('close');
        }
    }
});

$('#another-dialog-modal').dialog({
    autoOpen: false,
    buttons: {
        Cancel: function() {
            $(this).dialog('close');
        }
    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T20:03:23.610

正如评论中指出的[sushanth reddy](https://stackoverflow.com/users/941272/sushanth-reddy)，设置对话框的 z-index：

```
$("#secondModalDialog").dialog({
    resizable: false,
    height: 'auto',
    autoOpen: false,
    title: "Warning",
    width: 400,
    modal: true,
    zindex: 1001, // Default is 1000
    buttons: {
        'Close': function () {
            $("#secondModalDialog").dialog('close');
        }
    }
}); 
```

参考：[http ://docs.jquery.com/UI/API/1.8/Dialog#option-zIndex](http://docs.jquery.com/UI/API/1.8/Dialog#option-zIndex)

# ruby-on-rails - 编写@instances.count > 0 的更好方法

> ID：12715580
> 
> 赞同：6
> 
> 时间：2012-10-03T19:35:33.607
> 
> 标签：ruby-on-rails, ruby

我有这个代码：

```
<% if  @states.count > 0 %>  # @states is an active record collection 
```

我只是觉得应该有更好的方法来写这个。

我正在寻找类似的东西：

```
<% if  @states.not_empty? %> 
```

我意识到这是微小的变化，但它会是一个受欢迎的清理。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T19:37:23.903

你可能想要 ActiveRecord 的`any?`

[http://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-any-3F](http://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-any-3F)

```
<% if @states.any? %>
    Do stuff here if @states has at least one result
<% end %> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-03T19:36:40.503

怎么样

```
<% unless @states.empty? %> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-03T20:10:24.897

[http://apidock.com/rails/ActiveRecord/Base/exists%3F/class](http://apidock.com/rails/ActiveRecord/Base/exists%3F/class)

```
if @states.exists? 
```

# objective-c - 弹出窗口内的 UItableview

> ID：12715583
> 
> 赞同：0
> 
> 时间：2012-10-03T19:35:39.640
> 
> 标签：objective-c, xcode, cocoa-touch

我想在另一个视图控制器中弹出一个表格视图。所以我在主视图控制器和按钮的动作事件中有一个按钮，我有以下代码。

```
SettingsViewController *mySettings = [[SettingsViewController alloc] initWithStyle:UITableViewStylePlain];
UINavigationController *settingsNavigator = [[UINavigationController alloc] initWithRootViewController:mySettings];
settingsPopover = [[UIPopoverController alloc] initWithContentViewController:settingsNavigator];
mySettings.title = @"Custom Settings";

[settingsPopover setDelegate:self];
[settingsPopover setPopoverContentSize:CGSizeMake(320, 400)];
[settingsPopover presentPopoverFromBarButtonItem:sender permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES]; 
```

tableviewcontroller 位于故事板内部，其中一个静态单元格中有一个标签。

问题：tableview 正在弹出。但是，标签是不可见的。有任何想法吗？

顺便说一句，我已经从 SettingsViewController 中删除了默认的 tableview 事件。

谢谢大家的建议。

干杯，普拉萨德。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:41:30.567

您只能将静态 UITableViews 与故事板一起使用。如果您不使用情节提要，则可以创建一个情节提要，其中只有 1 个视图控制器，并在其中包含一个静态 UITableView。确保将视图控制器的类分配给 SettingsViewController 类。您必须为您的视图控制器指定一个标识符。

```
UIStoryboard *settingsViewControllerStoryboard = [UIStoryboard storyboardWithName:@"<storyboard filename>" bundle:nil];
SettingsViewcontroller *mySettings = [settingsViewControllerStoryboard instantiateViewControllerWithIdentifier:@"<controller identifier>"]; 
```

# ios - NSBlock 的 iOS NSMethodSignature（或编码）

> ID：12715586
> 
> 赞同：5
> 
> 时间：2012-10-03T19:35:42.983
> 
> 标签：ios, objective-c-blocks, encode

我需要一种在运行时检查给定块的参数数量和参数类型的方法（我需要这个用于我当前正在编写的一些对象映射库，我正在将字符串格式的值映射到选择器，块也需要相同） .

我尝试了以下示例中的代码，但由于某种原因，它对我不起作用，并且为字符串描述返回 nil。

你知道在运行时评估块签名的方法吗（最好是 iPhone 应用商店提交的 afe）？

这是我使用的代码：

```
struct BlockDescriptor {
unsigned long reserved;
unsigned long size;
void *rest[1];
};

struct Block {
void *isa;
int flags;
int reserved;
void (*invoke)(struct __block_literal_1 *);
struct BlockDescriptor *descriptor;
};

enum {
BLOCK_HAS_COPY_DISPOSE = (1 << 25),
BLOCK_HAS_CTOR = (1 << 26), // helpers have C++ code
BLOCK_IS_GLOBAL = (1 << 28),
BLOCK_HAS_STRET = (1 << 29), // IFF BLOCK_HAS_SIGNATURE
BLOCK_HAS_SIGNATURE = (1 << 30),
};

static const char *BlockSig(id blockObj)
{
struct Block *block = (void *)blockObj;
struct BlockDescriptor *descriptor = block->descriptor;

assert(block->flags & BLOCK_HAS_SIGNATURE);

int index = 0;
if(block->flags & BLOCK_HAS_COPY_DISPOSE)
    index += 2;

return descriptor->rest[index];
}

-(NSString*)signatureForBlock:(id)block {
NSString* sig = [NSString stringWithUTF8String:BlockSig(block)];

sig = [sig substringFromIndex:1]; // remove c
NSArray* components = [sig componentsSeparatedByCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@"0123456789?"]];
sig = [components componentsJoinedByString:@""];

return sig;
} 
```

然后做：

```
NSString * (^block)(int, NSArray *) = ^NSString * (int i, NSArray * a){
    return @"Oh, yeah!";
};
NSLog(@"signature %s", BlockSig(block)); // ==> this returns null 
```

资料来源： [检查 Objective-C 块类型？](https://stackoverflow.com/questions/9048305/checking-objective-c-block-type) [https://github.com/mikeash/MABlockForwarding/blob/master/main.m](https://github.com/mikeash/MABlockForwarding/blob/master/main.m)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T20:12:49.203

使用[CTBlockDescription](https://github.com/ebf/CTObjectiveCRuntimeAdditions#getting-runtime-information-about-blocks)，您可以获得作为[`NSMethodSignature`](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/nsmethodsignature_Class/Reference/Reference.html)对象所需的所有运行时信息。用法很简单：

```
NSString * (^block)(int, NSArray *) = ^NSString * (int i, NSArray * a){
    return @"Oh, yeah!";
};
NSMethodSignature *signature = [[[CTBlockDescription alloc] initWithBlock:block] blockSignature];
NSLog(@"signature %@", [signature debugDescription]); 
```

这将输出以下签名：

```
signature <NSMethodSignature: 0x6844900>
    number of arguments = 3
    frame size = 12
    is special struct return? NO
    return value: -------- -------- -------- --------
        type encoding (@) '@'
        flags {isObject}
        modifiers {}
        frame {offset = 0, offset adjust = 0, size = 4, size adjust = 0}
        memory {offset = 0, size = 4}
    argument 0: -------- -------- -------- --------
        type encoding (@) '@?'
        flags {isObject}
        modifiers {}
        frame {offset = 0, offset adjust = 0, size = 4, size adjust = 0}
        memory {offset = 0, size = 4}
    argument 1: -------- -------- -------- --------
        type encoding (i) 'i'
        flags {isSigned}
        modifiers {}
        frame {offset = 4, offset adjust = 0, size = 4, size adjust = 0}
        memory {offset = 0, size = 4}
    argument 2: -------- -------- -------- --------
        type encoding (@) '@'
        flags {isObject}
        modifiers {}
        frame {offset = 8, offset adjust = 0, size = 4, size adjust = 0}
        memory {offset = 0, size = 4} 
```

# sharepoint - 如何在仅对特定组可见的共享点中添加自定义操作

> ID：12715590
> 
> 赞同：4
> 
> 时间：2012-10-03T19:36:20.407
> 
> 标签：sharepoint, sharepoint-2010

我想在 c# 代码中为共享点列表创建自定义操作。

我正在使用**SPUserCustomAction**类型，我只需要为特定用户显示此项目（用户出现在特定组中）

位置设置为“Microsoft.SharePoint.StandardMenu”；

如何在代码中指定只有少数属于我的自定义组的用户可以看到此菜单项？有链接吗？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T19:50:00.577

`Rights`属性是你的朋友。在这里，您可以设置显示自定义操作所需的权限，如下所示：

```
Rights = "ViewListItems" 
```

权利基于`SPBasePermission`您可以[在此处找到](http://msdn2.microsoft.com/en-us/library/microsoft.sharepoint.spbasepermissions.aspx)的枚举。

另请参阅有关[安全修剪自定义操作](http://community.bamboosolutions.com/blogs/bambooteamblog/archive/2008/10/15/security-trimmed-custom-actions.aspx)的博客文章。

# vim - 一些 Surround.vim 命令不起作用

> ID：12715593
> 
> 赞同：2
> 
> 时间：2012-10-03T19:36:35.353
> 
> 标签：vim, plugins

刚刚安装了环绕.vim 插件，一些命令没有按预期工作。我以[这个问题](https://stackoverflow.com/questions/10258143/surround-two-words-with-quotes-in-vim)为例

```
This is a lo*ng line and I want to highlight two words 
```

a`ys2aw"`应该将以上内容更改为

```
This is a "long line" and I want to highlight two words 
```

但对我来说它改变了它

```
This is a g and I want to highlight two words 
```

其他时候完全没有影响！我认为这与被拉出的寄存器中的内容有关。

当我打字时`ys`，在右下角我可以看到它很快变为`g@`

最后，我很确定没有其他插件会通过发出`verbose map yss`命令进行干扰：

```
 n  yss           <Plug>Yssurround
    Last set from ~/.vim/plugin/surround.vim                                                                                                                     
 n  ys            <Plug>Ysurround
    Last set from ~/.vim/plugin/surround.vim 
```

有谁知道这里出了什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:52:44.537

我想通了，为了更容易在 vim 和其他所有内容之间复制/粘贴，我的`.vimrc`文件中有以下规则：

```
set clipboard=unnamedplus 
```

这使得`surround.vim`行为不正确。相反，我所做的是将以下行添加到我的`.vimrc`文件中，以允许我打开/关闭此所需的行为

```
nnoremap <leader>hf :set clipboard=unnamedplus<CR>
nnoremap <leader>fh :set clipboard-=unnamedplus<CR> 
```

现在`surround.vim`正常工作

# sql - 参数问题

> ID：12715594
> 
> 赞同：1
> 
> 时间：2012-10-03T19:36:39.537
> 
> 标签：sql, parameters

感谢您的支持以了解以下代码有什么问题：

```
SELECT [Name] As Milestone, [Start], [Outgoing tasks] As OTask 
FROM [Sheet1$] 
WHERE [Main project] = 'Company A' AND [Main link] = 'Project 1' 
AND [Task class] = 'Company' 
AND [Start] > (SELECT [Start] 
               FROM [Sheet1$] 
               WHERE [Main project] = 'Company A' 
               AND [Main link] = 'Project 1' 
               AND [Name] = OTask 
               AND [Incoming tasks] = Milestone) 
```

我实际上想要做的是获取`Name`在其继任者 ( ) 之后发生的注册表 ( `Outgoing tasks`)。

我的参数（里程碑和 OTask）有问题吗？

```
ERROR: NO VALUE GIVEN FOR ONE OR MORE REQUIRED PARAMETERS 
```

谢谢！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:41:51.613

问题是您在 where 条件中使用了别名。

它应该看起来像这样

```
SELECT [Name] As Milestone, [Start], [Outgoing tasks] As OTask 
FROM [Sheet1$] 
WHERE [Main project] = 'Company A' AND [Main link] = 'Project 1' 
AND [Task class] = 'Company' 
AND [Start] > (SELECT [Start] 
               FROM [Sheet1$] 
               WHERE [Main project] = 'Company A' 
               AND [Main link] = 'Project 1' 
               AND [Name] = [Outgoing tasks]
               AND [Incoming tasks] = [Name]) 
```

你必须`OTask`替换`[Outgoing tasks]`_`Milestone``[Name]`

# java - SWT - 需要关于文本框/表格/添加和删除值的建议

> ID：12715596
> 
> 赞同：2
> 
> 时间：2012-10-03T19:36:43.680
> 
> 标签：java, layout, dialog, swt

我真的很想就如何处理以下要求提供一些建议。

我将创建一个新对话框。在对话框中我想要 2 个框。1 个带有填充值的框，另一个为空。我还需要一个添加和删除按钮。他们会将选定的值从一个框移动到另一个框。

这是我需要编码的示例。

![在此处输入图像描述](../Images/d1f3b502b57e8992b7cab2dd346c81dd.png)

1.  我会使用文本框或表格吗？
2.  盒子和盒子会在同一个组件中吗？
3.  是否可以在删除按钮上添加添加按钮？

我真的在寻找有关使用框或表格以及如何布局组件以实现类似上图的建议的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:47:10.140

看看[`DualList`](http://code.google.com/a/eclipselabs.org/p/opal/wiki/DualList)蛋白石项目。这应该正是您想要的。

![在此处输入图像描述](../Images/8fdffab5d4aba3ee0d9cd3596b2b2926.png)

如果你想自己做，可以使用两个`Table`s，每个只有一列，或者两个`List`s。

布局将是：

```
Composite(GridLayout, 3 columns)
|
|- First List/Table
|
|- Composite(GridLayout, 1 column)
|  |- Button add
|  |- Button delete
|
|- Second List/Table 
```

**编辑**：

事实上，设计的东西非常相似，作为对不同问题的答案。看看我的回答[here](https://stackoverflow.com/a/12743043/1449199)。

# c++ - 我是否必须在每次阅读后使用 ifstream 进行搜索？

> ID：12715604
> 
> 赞同：3
> 
> 时间：2012-10-03T19:37:32.813
> 
> 标签：c++, file-io, binaryfiles

这是我从任何大小的文件中读取的循环，并且每次写入一个 1016 字节的 char* 数据包 1016 字节，然后发送它（发送尚未包括在内）。

seekg() 是必要的吗？或者读取是否已经将指针移动到下一个块的前面？

```
ifstream file (packet.message, ios::in|ios::binary|ios::ate);
if(file.is_open()) {
    size = file.tellg();
    file.seekg(0, ios::beg);
    for(int i = 0; !ios::eof; i++) {
        memset(packet.message,0,1016*sizeof(char));
        file.read(packet.message,1016*sizeof(char));
        file.seekg(i*1016*sizeof(char));
    }
} 
```

我知道这不是写入文件的问题，因为您只需一直写到最后，直到文件大小合适。

编辑：在 if 语句中添加了全部代码。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T19:38:40.040

这不是必需的。从上次看到文件指针的位置继续读取，就像写入一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:50:49.043

我敢打赌，文件没有在`std::ios_base::binary`mode 下打开，并且 the`memset()`和 the`seekg()`都被用来掩盖产生的效果：两者都不需要，尽管如果读取文件，您可能需要清除文件末尾的尾随字节部分记录。

顺便说一句：您总是想在阅读**后**检查流的状态：

```
while (in.read(buffer, size)) {
    ...
} 
```

还有：`sizeof(char) == 1`。

# css - Google Web 字体与实际字体文件 - 适用于所有设备

> ID：12715614
> 
> 赞同：7
> 
> 时间：2012-10-03T19:38:13.173
> 
> 标签：css, fonts, latency, webfonts, google-webfonts

我正在寻找使用Joesfin Sans。它列在 Google 网络字体中。我也有 .eot、.svg、.ttf 和 .woff。这意味着与文件完全兼容（据我所知）。

我的主要问题是：哪个更好？谷歌字体加载速度更快吗？是否更兼容？还是我应该坚持这些文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T20:02:04.657

如果您想要快速简便的解决方案，请嵌入字体加载器代码并继续。谷歌经常为其服务添加更多选项/功能。

就个人而言，我更喜欢从 Google 下载文件并手动使用它们。由于有一个专门用于*下载*您选择的字体的 Google 用户界面（并通过阅读许可协议），我相信这是合法使用，但我不是律师。

我为什么要这样做？

*   我在访问 Google 字体时遇到了延迟（200-300 毫秒）。虽然这并不可怕，但我的大多数服务器环境响应速度更快，并且字体是页面的重要先决条件。访问单独域（即浏览器对不同主机的并行化）的任何好处都将丢失。

*   我已手动修剪字体文件以删除所有不需要的字形。这会导致较小的文件大小。

*   IE8 支持——它似乎`.eot`并不总是被下载。

这些原因大多是轶事，但我自己管理字体文件要快乐得多。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T21:40:07.853

在生产环境中使用服务器上的实际字体文件会更好，因为：

1.  它更健壮。考虑当互联网连接（从用户的位置）到 Google 服务器不工作时会发生什么。一般来说，不要无缘无故地依赖远程托管服务。
2.  平均而言，它可能会快一点。
3.  你在掌控之中。谷歌在关闭或更改服务（例如付费服务）方面有着悠久的历史。
4.  谷歌提供字体的方式有一些错误。

自然，您至少需要像 Google 一样尝试覆盖不同的平台（使用不同的字体文件格式）。

# iphone - Xcode addSubview 具有唯一名称

> ID：12715617
> 
> 赞同：1
> 
> 时间：2012-10-03T19:38:21.510
> 
> 标签：iphone, ios, xcode, uiimageview, uiimage

我有一个创建 UIImageView 并允许用户从库中选择图像的按钮。

它还以 var 的形式递增，称为“数量”

如果他再次按下按钮，它会做同样的事情。他按了多少次。

```
 -(void)imagePickerController:(UIImagePickerController *)picker
didFinishPickingMediaWithInfo:(NSDictionary *)info
{

    UIImageView *subView;    
    CGRect frame = CGRectMake(60, 100, 200, 200);
    subView = [[UIImageView alloc] initWithFrame:frame];

    NSString *mediaType = [info
                           objectForKey:UIImagePickerControllerMediaType];
    [self dismissModalViewControllerAnimated:YES];
    if ([mediaType isEqualToString:(NSString *)kUTTypeImage]) {
        UIImage *image = [info 
                          objectForKey:UIImagePickerControllerOriginalImage];

        subView.image = image;
        if (newMedia)
            UIImageWriteToSavedPhotosAlbum(image, 
                                           self,
                                           @selector(image:finishedSavingWithError:contextInfo:),
                                           nil);
    }
    else if ([mediaType isEqualToString:(NSString *)kUTTypeMovie])
    {
        // Code here to support video if enabled
    }

    [self.view addSubview:subView];  
    amount += 1;

    NSLog(@"%d", amount);
} 
```

我需要给每个子视图一个唯一的名称，例如 subView1,subView2,subView3....... 以便我以后可以引用它们。

我怎样才能唯一地识别它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:54:06.203

You can't give them names. You have a couple of options for easily identifying them later.

The first is to subclass `UIVIew` and add an `NSString` property where you store the name. You can then iterate through the parent view's subviews, check to ensure the subview you're looking at it is of your new subclass, and then check it's name. The major advantage of this method is that your subviews can have whatever identifying data you want. A disadvantage is the need to check for class type, etc... slightly clunky, but often better coding.

The other option is to use `UIView`'s tag property, which is an `NSInteger`. You can give each subview its own tag. Two advantages to this system: it's built into `UIView`, and you can use the parent view's `viewWithTag` method to find a particular subview (though that's somewhat risky due to the fact that tags aren't unique by default and nothing prevents you from assigning the same tag to multiple subviews).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:43:55.303

您可以使用标签属性

```
[subview setTag:999]; 
```

...通过使用访问子视图`viewWithTag`

```
[self.view bringSubviewToFront:[subview viewWithTag:999]]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T19:45:33.187

每个视图都有一个名为 的 NSInteger 属性`tag`。

```
subview.tag = amount; 
```

稍后，当您需要引用特定的子视图时：

```
referencedSubview = [self.view viewWithTag:x];
if (referencedSubview != nil) {
 //do whatever
} else {
 //No subview with this tag
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T19:49:46.543

You could use an `NSMutableDictionary` and then create an `NSString` from the `amount` variable - like `[NSString stringWithFormat:@"view%d",amount]`. Then use this name to serve as the key for your view. This is guaranteed to not run into any potential conflicts with tag numbering, and will let you keep track of views across view hierarchies as well, if you need to.

# c# - 如何使用 SqlCommand 返回多个结果集？

> ID：12715620
> 
> 赞同：65
> 
> 时间：2012-10-03T19:38:37.230
> 
> 标签：c#, sql-server, ado.net

我可以执行多个查询并`SqlCommand`只执行一次返回它们的结果吗？

* * *

## 回答 #1

> 赞同：99
> 
> 时间：2012-10-03T19:43:16.417

请参阅[SqlDataReader.NextResult](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldatareader.nextresult.aspx)（调用[SqlCommand.ExecuteReader](http://msdn.microsoft.com/en-us/library/9kcbe65k.aspx)返回一个 SqlDataReader ）：

> 在读取批处理 Transact-SQL 语句的结果时，将数据读取器推进到下一个结果 [集]。

例子：

```
string commandText = @"SELECT Id, ContactId
FROM dbo.Subscriptions;

SELECT Id, [Name]
FROM dbo.Contacts;";

List<Subscription> subscriptions = new List<Subscription>();
List<Contact> contacts = new List<Contact>();

using (SqlConnection dbConnection = new SqlConnection(@"Data Source=server;Database=database;Integrated Security=true;"))
{
    dbConnection.Open();
    using (SqlCommand dbCommand = dbConnection.CreateCommand())
    {
        dbCommand.CommandText = commandText;
        using(SqlDataReader reader = dbCommand.ExecuteReader())
        {
            while(reader.Read())
            {
                subscriptions.Add(new Subscription()
                {
                    Id = (int)reader["Id"],
                    ContactId = (int)reader["ContactId"]
                });
            }

            // this advances to the next resultset 
            reader.NextResult();

            while(reader.Read())
            {
                contacts.Add(new Contact()
                {
                    Id = (int)reader["Id"],
                    Name = (string)reader["Name"]
                });
            }
        }
    }
} 
```

其他示例：

*   [C# 多个结果集](http://csharp.net-informations.com/data-providers/csharp-multiple-resultsets.htm)
*   [使用 SqlDataReader 执行返回多个结果集的查询：SqlCommand Select « ADO.Net « C# / CSharp 教程](http://www.java2s.com/Tutorial/CSharp/0560__ADO.Net/ExecutingaQueryThatReturnsMultipleResultSetswithSqlDataReader.htm)

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2012-10-03T19:40:32.227

创建一个`Stored Procedure`有多个选择的，并填充`DataSet`.

```
using (SqlConnection conn = new SqlConnection(connection))
{
    DataSet dataset = new DataSet();
    SqlDataAdapter adapter = new SqlDataAdapter();
    adapter.SelectCommand = new SqlCommand("MyProcedure", conn);
    adapter.SelectCommand.CommandType = CommandType.StoredProcedure;
    adapter.Fill(dataset);
    return dataset;
} 
```

对于存储过程中的每个选择，返回的数据集`DataTable`的 Tables 数组中都有一个。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-06-19T09:49:11.677

无论您使用临时文本查询还是存储过程，“dapper”之类的工具都可以让这变得非常简单；例如：

```
using(var multi = conn.QueryMultiple(sql, args))
{
    var customers = multi.Read<Customer>().AsList(); // first grid
    var regionName = multi.ReadFirstOrDefault<string>(); // second grid
    var addresses = multi.Read<Address>().AsList(); // third grid
    // todo: use those things
} 
```

也可以通过可选参数读取单个网格*而无需*缓冲（作为阅读器本身的打开） 。`IEnumerable<T>``Read[<T>]`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-08-23T20:41:58.877

我调用一个 sproc 并获得多个带有对象的结果集，所以你最终得到一个

```
List<List<Dictionary<string, object>>> 
```

然后在 multiResultsSet 每个结果集

```
List<Dictionary<string, object>> 
```

它们可以转换为[它们的类型](https://stackoverflow.com/questions/972636/casting-a-variable-using-a-type-variable)并根据需要转换为模型。

使用所需的一切设置 sproc 命令后，将其传递给：

```
 private static List<List<Dictionary<string, object>>> ProcessReader(SqlCommand command)
    {
        var tables = new List<List<Dictionary<string, object>>>();
        using (var reader = command.ExecuteReader())
        {
            do
            {
                var table = new List<Dictionary<string, object>>();
                while (reader.Read())
                    table.Add(Read(reader));
                tables.Add(table);
            } while (reader.NextResult());
        }
        return tables;
    } 
```

并且 Read() 相当简单。

```
 private static Dictionary<string, object> Read(IDataRecord reader)
    {
        var row = new Dictionary<string, object>();
        for (var i = 0; i < reader.FieldCount; i++)
        {
            var val = reader[i];
            row[reader.GetName(i)] = val == DBNull.Value ? null : val;
        }
        return row;
    } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-12T18:21:48.063

我正在使用字典方法。您可以使用 Newton Json 将其转换为 json。这样你就不会被类型和 IDataRecord 束缚

```
public List<List<Dictionary<string, object>>> ExecuteSqlReader(string cmd, int commandTimeout = 30, CommandType commandType = CommandType.Text)
        {
           var sqlCmd = new SqlCommand(cmd);
           var allRecord = new List<List<Dictionary<string, object>>>();
            using (var connection = GetSqlConnection(commandTimeout, commandType, ref sqlCmd))
            {
                using (var reader = sqlCmd.ExecuteReader())
                {
                    if (reader.HasRows)
                    {
                        var result = new List<Dictionary<string, object>>();
                        while (reader.Read())
                        {
                            result = GetTableRowData(reader);
                        }

                        allRecord.Add(result);
                    }
                    while (reader.NextResult())
                    {
                        if (reader.HasRows)
                        {
                            var result = new List<Dictionary<string, object>>();
                            while (reader.Read())
                            {
                                result = GetTableRowData(reader);
                            }
                            allRecord.Add(result);
                        }
                    }
                }
            }
            return allRecord;
        } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-30T17:50:12.973

这就是我用来返回多个结果集的方法。

```
public abstract class BaseRepo
{
    private string _connectionString;

    protected BaseRepo(string connectionString)
    {
        _connectionString = connectionString;
    }

    private SqlConnection GetSqlConnection(int commandTimeout, CommandType commandType, ref SqlCommand sqlCmd)
    {
        var connection = new SqlConnection(_connectionString);
        connection.Open();
        sqlCmd.Connection = connection;
        sqlCmd.CommandTimeout = commandTimeout;
        sqlCmd.CommandType = commandType;
        return connection;
    }

    protected int ExecuteSql(SqlCommand sqlCmd, int commandTimeout = 30, CommandType commandType = CommandType.Text)
    {
        using (var connection = GetSqlConnection(commandTimeout, commandType, ref sqlCmd))
        {
            return sqlCmd.ExecuteNonQuery();
        }
    }

    protected IEnumerable<T> ExecuteSqlReader<T>(Func<IDataRecord, T> CreateObject, SqlCommand sqlCmd, int commandTimeout = 30, CommandType commandType = CommandType.Text)
    {
        using (var connection = GetSqlConnection(commandTimeout, commandType, ref sqlCmd))
        {
            using (var reader = sqlCmd.ExecuteReader())
                return ExecuteReader(CreateObject, reader);
        }
    }

    protected Tuple<IEnumerable<T1>, IEnumerable<T2>> ExecuteSqlReader<T1,T2>(Func<IDataRecord, T1> CreateObject1, Func<IDataRecord, T2> CreateObject2,  SqlCommand sqlCmd, int commandTimeout = 30, CommandType commandType = CommandType.Text)
    {
        using (var connection = GetSqlConnection(commandTimeout, commandType, ref sqlCmd))
        {
            using (var reader = sqlCmd.ExecuteReader())
            {
                var result1 = ExecuteReader(CreateObject1, reader).ToList();
                var result2 = ExecuteReader(CreateObject2, reader).ToList();
                return Tuple.Create<IEnumerable<T1>, IEnumerable<T2>>(result1, result2);
            }
        }
    }

    protected Tuple<IEnumerable<T1>, IEnumerable<T2>, IEnumerable<T3>> ExecuteSqlReader<T1, T2, T3>(Func<IDataRecord, T1> CreateObject1, Func<IDataRecord, T2> CreateObject2, Func<IDataRecord, T3> CreateObject3, SqlCommand sqlCmd, int commandTimeout = 30, CommandType commandType = CommandType.Text)
    {
        using (var connection = GetSqlConnection(commandTimeout, commandType, ref sqlCmd))
        {
            using (var reader = sqlCmd.ExecuteReader())
            {
                var result1 = ExecuteReader(CreateObject1, reader).ToList();
                var result2 = ExecuteReader(CreateObject2, reader).ToList();
                var result3 = ExecuteReader(CreateObject3, reader).ToList();
                return Tuple.Create<IEnumerable<T1>, IEnumerable<T2>, IEnumerable<T3>>(result1, result2, result3);
            }
        }
    }

    protected Tuple<IEnumerable<T1>, IEnumerable<T2>, IEnumerable<T3>, IEnumerable<T4>> ExecuteSqlReader<T1, T2, T3, T4>(Func<IDataRecord, T1> CreateObject1, Func<IDataRecord, T2> CreateObject2, Func<IDataRecord, T3> CreateObject3, Func<IDataRecord, T4> CreateObject4, SqlCommand sqlCmd, int commandTimeout = 30, CommandType commandType = CommandType.Text)
    {
        using (var connection = GetSqlConnection(commandTimeout, commandType, ref sqlCmd))
        {
            using (var reader = sqlCmd.ExecuteReader())
            {
                var result1 = ExecuteReader(CreateObject1, reader).ToList();
                var result2 = ExecuteReader(CreateObject2, reader).ToList();
                var result3 = ExecuteReader(CreateObject3, reader).ToList();
                var result4 = ExecuteReader(CreateObject4, reader).ToList();
                return Tuple.Create<IEnumerable<T1>, IEnumerable<T2>, IEnumerable<T3>, IEnumerable<T4>>(result1, result2, result3, result4);
            }
        }
    }

    private IEnumerable<T> ExecuteReader<T>(Func<IDataRecord, T> CreateObject, SqlDataReader reader)
    {
        while (reader.Read())
        {
            yield return CreateObject(reader);
        }
        reader.NextResult();
    }
} 
```

然后我就这样继承它：

```
public class ReviewRepo : BaseRepo
{
    public ReviewRepo(string connectionString) : base(connectionString) { }

    public ReviewPageableResult GetAllReviews(string productType, string serviceType, int pageNumber, int itemsPerPage, string sortBy, string sortDirection)
    {
        var parameters = new List<SqlParameter>
        {
            new SqlParameter("ProductRefDescription", productType),
            new SqlParameter("ServiceRefDescription", serviceType),
            new SqlParameter("ZipCodes", "NULL"),
            new SqlParameter("PageNumber", pageNumber),
            new SqlParameter("ItemsPerPage", itemsPerPage),
            new SqlParameter("SortBy", sortBy),
            new SqlParameter("SortDirection", sortDirection)
        };
        var cmd = new SqlCommand("dbo.GetReviews");
        cmd.Parameters.AddRange(parameters.ToArray());
        var results = ExecuteSqlReader(CreateReview, CreateReviewPageableResult, cmd, commandType: CommandType.StoredProcedure);
        var reviewResult = results.Item2.Single();
        reviewResult.Items = results.Item1;
        return reviewResult;
    }

    public ReviewPageableResult GetReviewsByZip(string productType, string serviceType, string zipCodes, int pageNumber, int itemsPerPage, string sortBy, string sortDirection)
    {
        var parameters = new List<SqlParameter>
        {
            new SqlParameter("ProductRefDescription", productType),
            new SqlParameter("ServiceRefDescription", serviceType),
            new SqlParameter("ZipCodes", zipCodes),
            new SqlParameter("PageNumber", pageNumber),
            new SqlParameter("ItemsPerPage", itemsPerPage),
            new SqlParameter("SortBy", sortBy),
            new SqlParameter("SortDirection", sortDirection)
        };
        var cmd = new SqlCommand("dbo.GetReviewsByZipCodes");
        cmd.Parameters.AddRange(parameters.ToArray());
        var results = ExecuteSqlReader(CreateReview, CreateReviewPageableResult, cmd, commandType: CommandType.StoredProcedure);
        var reviewResult = results.Item2.Single();
        reviewResult.Items = results.Item1;
        return reviewResult;
    }

    private Review CreateReview(IDataRecord record)
    {
        return new Review
        {
            PageReviewId = (int)record["PageReviewId"],
            ProductRefId = (Guid)record["ProductRefId"],
            ServiceTypeRefId = Convert.IsDBNull(record["ServiceTypeRefId"]) ? Guid.Empty : (Guid)record["ServiceTypeRefId"],
            TerritoryId = Convert.IsDBNull(record["TerritoryId"]) ? Guid.Empty : (Guid)record["TerritoryId"],
            FirstName = $"{record["FirstName"]}",
            LastName = $"{record["LastName"]}",
            City = $"{record["City"]}",
            State = $"{record["State"]}",
            Answer = $"{record["Answer"]}",
            Rating =(double)record["Rating"],
            SurveyDate = (DateTime)record["SurveyDate"]
        };
    }

    private ReviewPageableResult CreateReviewPageableResult(IDataRecord record)
    {
        return new ReviewPageableResult
        {
            AverageRating = (double)record["AverageRating"],
            Count1Stars = (int)record["Count1Stars"],
            Count2Stars = (int)record["Count2Stars"],
            Count3Stars = (int)record["Count3Stars"],
            Count4Stars = (int)record["Count4Stars"],
            Count5Stars = (int)record["Count5Stars"],
            ItemsPerPage = (int)record["ItemsPerPage"],
            PageNumber = (int)record["PageNumber"],
            TotalCount = (int)record["TotalCount"],
        };
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-09-27T16:22:14.240

试试这个

```
Dim dt1, dt2, dt3As New DataTable
    Dim command As SqlCommand
    Dim adapter As New SqlDataAdapter
    Dim ds As New DataSet
    Dim Sql1, Sql2, Sql3 As String

    Sql1 = "select id, CurName from Table1 where IS_Deleted=0 order by id"
    Sql2 = "select id ,Item from Table2 order by id"
    Sql3 = "select id ,SellPrice from Table3 order by id"

    Try

        conn1.Open()
        command = New SqlCommand(Sql1, conn1)
        command.CommandType = CommandType.Text
        adapter.SelectCommand = command
        adapter.Fill(ds, "dt1")

        adapter.SelectCommand.CommandText = Sql2
        adapter.Fill(ds, "dt2")

        adapter.SelectCommand.CommandText = Sql3
        adapter.Fill(ds, "dt3")

        adapter.Dispose()
        command.Dispose()
        conn1.Close()

        cmbCurrency.DataSource = ds.Tables("dt1") 
        cmbCurrency.DisplayMember = "CurName"
        cmbCurrency.ValueMember = "id"
        cmbCurrency.SelectedIndex = -1 
        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''|

        cmbGroups.DataSource = ds.Tables("dt2") 
        cmbGroups.DisplayMember = "Item"                                    
        cmbGroups.ValueMember = "id"                                        
        cmbGroups.SelectedIndex = -1                                        
        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''|

        cmbUnits.DataSource = ds.Tables("dt3")  
        cmbUnits.DisplayMember = "SellPrice" 
        cmbUnits.ValueMember = "id" 
        cmbUnits.SelectedIndex = -1                                         
        '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''|

    Catch ex As Exception
       MessageBox.Show(ex.ToString())
    End Try 
```

如需更多帮助[http://vb.net-informations.com/dataset/dataset-multiple-tables-sqlserver.htm](http://vb.net-informations.com/dataset/dataset-multiple-tables-sqlserver.htm)

# asp.net-mvc-4 - ASP.Net MVC 4 在登录期间获取角色以重定向到适当的页面

> ID：12715625
> 
> 赞同：1
> 
> 时间：2012-10-03T19:38:59.980
> 
> 标签：asp.net-mvc-4, roleprovider

我正在尝试将用户重定向到登录时的相应页面。所以我检查他们是否在某个角色中，然后根据成员身份进行重定向。但是， Roles.IsUserInRole() 似乎不起作用。另外，当我使用 Roles.GetRolesForUser("username") 我得到“System.String[]”。我在 mvc4 中使用默认的 simplemembership。我可以看到在数据库中创建的用户并链接到适当的角色。此外，当我使用 [Authorize Roles..] 时效果很好。这是我的登录名（几乎是添加了我的角色检查和重定向的默认登录名。

```
public ActionResult Login(LoginModel model, string returnUrl)
        {
            if (ModelState.IsValid && WebSecurity.Login(model.UserName, model.Password, persistCookie: model.RememberMe))
            {   //Get list of roles to print
                Session["FName"] = Roles.GetRolesForUser(model.UserName);
                if(Roles.IsUserInRole(model.UserName,"User")){
                    return RedirectToAction("Index","UserLanding");
                    Session["FName"] = "User in User group";
                }
                return RedirectToLocal(returnUrl);
            }

            // If we got this far, something failed, redisplay form
            ModelState.AddModelError("", "The user name or password provided is incorrect.");
            return View(model);
        } 
```

我希望当用户登录“用户”组时，他们会被重定向到 UserLanding Congroller 索引页面。但是，它们总是被重定向到主页。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T11:41:08.967

您可以手动验证用户，以便您可以访问识别特定用户的会员类别，然后您可以访问所有与用户相关的数据，如角色等。

这是您在访问角色之前必须添加以手动验证用户的代码，

```
 Membership.ValidateUser("Username", "PASSWORD");
 FormsAuthentication.SetAuthCookie(usermaster.Useremail, true); 
```

希望这对你有帮助。拉吉

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T20:33:40.967

我猜你不能访问 Roles.IsUserInRole 或 GetRolesForUser 直到重定向之后，因此是空值。我在基于角色的授权下找到了[这个](http://techbrij.com/978/custom-roleprovider-authorization-asp-net-mvc)。如果有人有办法直接在数据库中访问角色而无需通过角色，我可以使用它。但与此同时，我将按照文章中的建议实现额外的重定向。

# ruby-on-rails - Devise 和 Rails - Devise::RegistrationsController#create 中的 ArgumentError

> ID：12715627
> 
> 赞同：11
> 
> 时间：2012-10-03T19:39:04.007
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, devise

当新用户提交新用户注册表单时，他们会收到以下错误消息。我怀疑是因为 devise/registrations_controller.rb 不存在。

我是否需要创建此文件夹结构和控制器，或者我可以修改 routes.rb 以避免搜索不存在的控制器？

错误：

```
 ArgumentError in Devise::RegistrationsController#create

 wrong number of arguments (0 for 1)
 Rails.root: C:/Users/COMPAQ/Documents/NetBeansProjects/RailsBlog

 Parameters:

 {"utf8"=>"✓",
  "authenticity_token"=>"xxxxxxxxxxxxxxxxxxxxxx/c=",
  "user"=>{"email"=>"foo@bar.com",
  "password"=>"[FILTERED]",
  "password_confirmation"=>"[FILTERED]"},
  "commit"=>"Sign up"} 
```

路线.rb：

```
RailsBlog::Application.routes.draw do

  devise_for :users 
```

用户.rb（模型）：

```
class User < ActiveRecord::Base
  # Include default devise modules. Others available are:
  # :token_authenticatable, :confirmable,
  # :lockable, :timeoutable and :omniauthable
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :password_confirmation, :remember_me
  attr_accessible :name, :email, :password, :password_confirmation
  has_secure_password

  #has_many :microposts, dependent: :destroy
  #has_many :relationships, foreign_key: "follower_id", dependent: :destroy
  #has_many :followed_users, through: :relationships, source: :followed

  #has_many :reverse_relationships, foreign_key: "followed_id",
           #class_name:  "Relationship",
           #dependent:   :destroy
  #has_many :followers, through: :reverse_relationships, source: :follower

  before_save { |user| user.email = email.downcase }
  before_save :create_remember_token

  validates :name, presence: true, length: { maximum: 50 }
  VALID_EMAIL_REGEX = /\A[\w+\-.]+@[a-z\d\-.]+\.[a-z]+\z/i
  validates :email, presence:   true,
            format:     { with: VALID_EMAIL_REGEX },
            uniqueness: { case_sensitive: false }
  validates :password, presence: true, length: { minimum: 6 }
  validates :password_confirmation, presence: true

  def feed
    Micropost.from_users_followed_by(self)
  end

  def following?(other_user)
    relationships.find_by_followed_id(other_user.id)
  end

  def follow!(other_user)
    relationships.create!(followed_id: other_user.id)
  end

  def unfollow!(other_user)
    relationships.find_by_followed_id(other_user.id).destroy
  end

  private

  def create_remember_token
    self.remember_token = SecureRandom.urlsafe_base64
  end

end 
```

追溯 - 我看过但无法确定问题出在哪里：

```
devise (2.1.2) lib/devise/models/database_authenticatable.rb:109:in `password_digest'
activemodel (3.2.1) lib/active_model/errors.rb:254:in `block in add_on_blank'
activemodel (3.2.1) lib/active_model/errors.rb:253:in `each'
activemodel (3.2.1) lib/active_model/errors.rb:253:in `add_on_blank'
activemodel (3.2.1) lib/active_model/validations/presence.rb:9:in `validate'
activesupport (3.2.1) lib/active_support/callbacks.rb:310:in `_callback_before_185'
activesupport (3.2.1) lib/active_support/callbacks.rb:484:in `_run__875543711__validate__219075599__callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.1) lib/active_support/callbacks.rb:385:in `_run_validate_callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:81:in `run_callbacks'
activemodel (3.2.1) lib/active_model/validations.rb:212:in `run_validations!'
activemodel (3.2.1) lib/active_model/validations/callbacks.rb:53:in `block in run_validations!'
activesupport (3.2.1) lib/active_support/callbacks.rb:425:in `_run__875543711__validation__219075599__callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.1) lib/active_support/callbacks.rb:385:in `_run_validation_callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:81:in `run_callbacks'
activemodel (3.2.1) lib/active_model/validations/callbacks.rb:53:in `run_validations!'
activemodel (3.2.1) lib/active_model/validations.rb:179:in `valid?'
activerecord (3.2.1) lib/active_record/validations.rb:69:in `valid?'
activerecord (3.2.1) lib/active_record/validations.rb:77:in `perform_validations'
activerecord (3.2.1) lib/active_record/validations.rb:50:in `save'
activerecord (3.2.1) lib/active_record/attribute_methods/dirty.rb:22:in `save'
activerecord (3.2.1) lib/active_record/transactions.rb:241:in `block (2 levels) in save'
activerecord (3.2.1) lib/active_record/transactions.rb:295:in `block in with_transaction_returning_status'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/database_statements.rb:190:in `transaction'
activerecord (3.2.1) lib/active_record/transactions.rb:208:in `transaction'
activerecord (3.2.1) lib/active_record/transactions.rb:293:in `with_transaction_returning_status'
activerecord (3.2.1) lib/active_record/transactions.rb:241:in `block in save'
activerecord (3.2.1) lib/active_record/transactions.rb:252:in `rollback_active_record_state!'
activerecord (3.2.1) lib/active_record/transactions.rb:240:in `save'
devise (2.1.2) app/controllers/devise/registrations_controller.rb:15:in `create'
actionpack (3.2.1) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.1) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.1) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.1) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.1) lib/active_support/callbacks.rb:436:in `_run__853675117__process_action__862668662__callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.1) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.1) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.1) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.1) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.1) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.1) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.1) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.1) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.1) lib/action_controller/metal/params_wrapper.rb:205:in `process_action'
activerecord (3.2.1) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.1) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.1) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.1) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.1) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.1) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:66:in `call'
actionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:66:in `dispatch'
actionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:30:in `call'
actionpack (3.2.1) lib/action_dispatch/routing/mapper.rb:40:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.1) lib/action_dispatch/routing/route_set.rb:589:in `call'
warden (1.2.1) lib/warden/manager.rb:35:in `block in call'
warden (1.2.1) lib/warden/manager.rb:34:in `catch'
warden (1.2.1) lib/warden/manager.rb:34:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:35:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/cookies.rb:338:in `call'
activerecord (3.2.1) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.1) lib/active_record/connection_adapters/abstract/connection_pool.rb:443:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.1) lib/active_support/callbacks.rb:405:in `_run__805649291__call__219075599__callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.1) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.1) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.1) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.1) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.1) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.1) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.1) lib/action_dispatch/middleware/static.rb:53:in `call'
railties (3.2.1) lib/rails/engine.rb:479:in `call'
railties (3.2.1) lib/rails/application.rb:220:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.1) lib/rails/rack/log_tailer.rb:14:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
C:/RUBY/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/webrick/server.rb:191:in `block in  start_thread' 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-10-03T19:59:51.303

`Devise::RegistrationsController`存在[于 Devise gem](https://github.com/plataformatec/devise/tree/master/app/controllers/devise)中，因此您无需创建它。

**更新**：出现错误是因为您使用`has_secure_password`的是自制认证解决方案。Devise 不需要它（它处理密码本身的加密）。摆脱那条线！

它导致您的应用程序崩溃的原因是它希望`password_digest`成为您模型上的一个属性，并[验证它的存在](https://github.com/rails/rails/blob/3-2-stable/activemodel/lib/active_model/secure_password.rb#L43)。当它进行验证时，它会尝试读取属性，但它得到的是 Devise 的`password_digest`方法（它希望接收密码作为参数，所以`ArgumentError`当它没有得到时引发一个）。

# asp.net-mvc-4 - 在一个 StyleBundle 中使用多个 CDN 链接

> ID：12715628
> 
> 赞同：13
> 
> 时间：2012-10-03T19:39:05.187
> 
> 标签：asp.net-mvc-4

我有以下代码：

```
bundles.UseCdn = true;

var fontPath = "http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,600";

var commonCss = new StyleBundle("~/css/common").Include(
    "~/Content/less/myless.less",
    "~/Content/css/opensans.css", // local copy of the font path above
    "~/Content/less/mylessoverrides.less",
    "~/Content/css/font-awesome.css");

commonCss.Transforms.Add(new CssMinify());
bundles.Add(commonCss); 
```

上面的代码工作得很好。但是，我想从上面的 CDN 链接加载 opensans.css。我还想将其保留为一个捆绑包并保持捆绑包顺序不变。以下代码将引发错误：

```
var commonCss = new StyleBundle("~/css/common").Include(
    "~/Content/less/myless.less",
    "http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,600",
    "~/Content/less/mylessoverrides.less",
    "~/Content/css/font-awesome.css");

The URL 'http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,600'
is not valid. Only application relative URLs (~/url) are allowed. 
```

一种解决方法是将其拆分为三个捆绑包，但这与捆绑包的全部目的背道而驰：

```
var commonCss1 = new StyleBundle("~/css/common1").Include(
    "~/Content/less/myless.less");

var commonCss2 = new StyleBundle("~/css/common2", fontPath).Include(
    "~/Content/css/opensans.css");

var commonCss3 = new StyleBundle("~/css/common3").Include(
    "~/Content/less/mylessoverrides.less",
    "~/Content/css/font-awesome.css"); 
```

最终的解决方案是执行以下操作：

```
var commonCss = new StyleBundle("~/css/common").Include(
    "~/Content/less/myless.less",
    new { fontPath, "~/Content/css/opensans.css" },
    "~/Content/less/mylessoverrides.less",
    "~/Content/css/font-awesome.css"); 
```

有没有其他人设法解决这个问题或设法扩展允许这种行为的框架？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T03:53:43.030

你可以使用

```
@import url("http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,400,600"); 
```

您希望它在本地 css 文件中的位置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T00:40:35.660

我认为这仍在开发中，请查看最近的 SO 问题： [ASP 捆绑中的绝对 URL](https://stackoverflow.com/questions/13682671/absolute-url-in-asp-bundle)

# objective-c - UIPanGestureRecognizer 之后的 CABasicAnimation

> ID：12715632
> 
> 赞同：0
> 
> 时间：2012-10-03T19:39:15.557
> 
> 标签：objective-c, ios6, cabasicanimation, uipangesturerecognizer

我想在使用将它拖到屏幕上其他地方的`CALayer`a 后将其动画化回其初始位置 。`UIPanGestureRecognizer`

这是我所拥有的：

```
@interface ViewController () {
    CGPoint defaultButtonPosition;
    CGPoint lastPosition;
}
@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    defaultButtonPosition = _roundShape.layer.position;

    self.view.backgroundColor = [UIColor blackColor];

    [_roundShape displayShape];

    [self.view.layer addSublayer:_roundShape.layer];

}

//code so I can drag my CALayer
- (IBAction)dragShape:(UIPanGestureRecognizer *)sender
{
    CGPoint translation = [sender translationInView:self.view];
    sender.view.center = CGPointMake(sender.view.center.x + translation.x, sender.view.center.y + translation.y);
    [sender setTranslation:CGPointMake(0, 0) inView:self.view];

    lastPosition = sender.view.center;

    if (sender.state == UIGestureRecognizerStateEnded) {
        NSLog(@"Pan ended");
        [self animateBackToOriginalPosition];

       _roundShape.center = lastPosition;
    }
}

- (void)animateBackToOriginalPosition
{        
    CABasicAnimation *moveBackToOriginalPosition = [CABasicAnimation animationWithKeyPath:@"position"];
    moveBackToOriginalPosition.timingFunction = [CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionLinear];

    moveBackToOriginalPosition.fromValue = [NSValue valueWithCGPoint:lastPosition];
    moveBackToOriginalPosition.toValue = [NSValue valueWithCGPoint:defaultPosition];
    moveBackToOriginalPosition.repeatCount = 0;
    moveBackToOriginalPosition.duration = 1.0;
    [_roundShape.layer addAnimation:moveBackToOriginalPosition forKey:@"position"];

} 
```

这段代码产生的动画与我想要的相差甚远。当我放开正在拖动的 CALayer 时，它突然消失并从看似随机的位置动画到 lastPosition 而不是我设置的 toValue (=defaultPosition)。之后，CALayer 不再可见。

似乎当我拖动 CALayer 时，位置属性并没有改变，因为 NSLog 总是告诉我它仍然处于默认位置。这就是我尝试使用的`_roundShape.center = lastPosition;`原因，但这只会导致 CALayer 消失。没有这个，CALayer 会在屏幕上保持可见。

我希望我能很好地解释我的问题。我很想听听我在代码中犯了哪些新手错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:11:11.463

尝试使用转换矩阵，它更容易并且适合临时转换。当您希望图层转换到其原始位置时，您只需将 trans 矩阵与单位矩阵相等（这样您也不需要保留您的 prev 位置）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:00:07.923

尝试使用 nslog 或 printf 了解 CGPoint defaultButtonPosition 的坐标（并将其正确输入到 CAAnimation 代码中）。“消失视图”大部分时间来自远离可见窗口的坐标：这里，默认点是在将图层添加到视图之前设置的，但最后一个位置是在之后设置的。尝试更改此设置，或致电

```
 convertPoint: toView: 
```

# r - ggplot2 - 带有堆栈和闪避的条形图

> ID：12715635
> 
> 赞同：49
> 
> 时间：2012-10-03T19:39:34.290
> 
> 标签：r, ggplot2

我正在尝试使用`ggplot2`一个变量堆叠并躲避另一个变量来创建条形图。

这是一个示例数据集：

```
df=data.frame(
  year=rep(c("2010","2011"),each=4),
  treatment=rep(c("Impact","Control")),
  type=rep(c("Phylum1","Phylum2"),each=2),
  total=sample(1:100,8)) 
```

我想创建一个条形图，其中`x=treatment`，`y=total`堆叠变量是`type`，躲避变量是`year`。当然，我可以做一个或另一个：

```
ggplot(df,aes(y=total,x=treatment,fill=type))+geom_bar(position="dodge",stat="identity")

ggplot(df,aes(y=total,x=treatment,fill=year))+geom_bar(position="dodge",stat="identity") 
```

但不是两者都有！感谢任何可以提供建议的人。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-10-03T19:49:40.910

这是使用刻面而不是躲避的替代方法：

```
ggplot(df, aes(x = year, y = total, fill = type)) +
    geom_bar(position = "stack", stat = "identity") +
    facet_wrap( ~ treatment) 
```

![在此处输入图像描述](../Images/34d256c2d9ab7bcb9adf7221befefe63.png)

随着泰勒的建议改变：`+ theme(panel.margin = grid::unit(-1.25, "lines"))`

![在此处输入图像描述](../Images/e8c2fd480414d2d7f2b8d8de5290e864.png)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2018-04-26T13:48:47.650

您可以`interaction(year, treatment)`将 x 轴变量用作`dodge`.

```
library(dplyr)
library(ggplot2)

df=data.frame(
  year=rep(c("2010","2011"),each=4),
  treatment=rep(c("Impact","Control")),
  type=rep(c("Phylum1","Phylum2"),each=2),
  total=sample(1:100,8)) %>% 
  mutate(x_label = factor(str_replace(interaction(year, treatment), '\\.', ' / '),
                          ordered=TRUE))

ggplot(df, aes(x=x_label, y=total, fill=type)) +
  geom_bar(stat='identity') +
  labs(x='Year / Treatment') 
```

![](../Images/5639c774cccff40e86ba4b2e6f125e8f.png)

由[reprex 包](http://reprex.tidyverse.org)（v0.2.0）于 2018 年 4 月 26 日创建。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-10-03T19:48:25.380

您可以获得的最接近的方法是在`dodged`条形周围绘制边框以突出显示堆叠`type`值。

```
ggplot(df, aes(treatment, total, fill = year)) + 
geom_bar(stat="identity", position="dodge", color="black") 
```

![在此处输入图像描述](../Images/64e2d6b6ff1083b155c670f18bdda6d8.png)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-10-06T10:54:30.563

它可以完成，但是它很棘手/繁琐，您基本上必须将条形图分层。

这是我的代码：

```
library(tidyverse)

df=data.frame(
  year=rep(c(2010,2011),each=4),
  treatment=rep(c("Impact","Control")),
  type=rep(c("Phylum1","Phylum2"),each=2),
  total=sample(1:100,8))

# separate the by the variable which we are dodging by so 
# we have two data frames impact and control
impact <- df %>% filter(treatment == "Impact") %>% 
  mutate(pos = sum(total, na.rm=T))

control <- df %>% filter(treatment == "Control") %>% 
  mutate(pos = sum(total, na.rm=T))

# calculate the position for the annotation element
impact_an <- impact %>% group_by(year) %>% 
  summarise(
    pos = sum(total) + 12
    , treatment = first(treatment)
  )

control_an <- control %>% group_by(year) %>% 
  summarise(
    pos = sum(total) + 12
    , treatment = first(treatment)
  )

# define the width of the bars, we need this set so that
# we can use it to position the second layer geom_bar 
barwidth = 0.30

ggplot() +
  geom_bar(
    data = impact
    , aes(x = year, y = total, fill = type)
    , position = "stack"
    , stat = "identity"
    , width = barwidth
  ) + 
  annotate(
    "text"
    , x = impact_an$year
    ,y = impact_an$pos
    , angle = 90
    , label = impact_an$treatment
  ) +
  geom_bar(
    data = control
    # here we are offsetting the position of the second layer bar
    # by adding the barwidth plus 0.1 to push it to the right
    , aes(x = year + barwidth + 0.1, y = total, fill = type)
    , position = "stack"
    , stat = "identity"
    , width = barwidth
  ) +
  annotate(
    "text"
    , x = control_an$year + (barwidth * 1) + 0.1
    ,y = control_an$pos
    , angle = 90
    , label = control_an$treatment
  ) +
  scale_x_discrete(limits = c(2010, 2011)) 
```

[![堆叠躲避 barchar](../Images/f146eea5885240fe3d9b4772df3e5920.png)](https://i.stack.imgur.com/dR2mm.png) 这并不能很好地扩展，但是您可以通过多种方式对其进行编码以使其适合您的情况，归功于我最初从以下帖子中学到了这种方法：[https ://community.rstudio.com/t/ ggplot-position-dodge-with-position-stack/16425](https://community.rstudio.com/t/ggplot-position-dodge-with-position-stack/16425)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2021-02-09T10:45:00.547

你可以玩一些阿尔法：

```
df %>% 
  group_by(year, treatment) %>% 
  mutate(cum_tot = cumsum(total)) %>% 
  ggplot(aes(treatment, cum_tot, fill =year)) + 
  geom_col(data = . %>% filter( type=="Phylum1"), position = position_dodge(width = 0.9), alpha = 1) +
  geom_col(data = . %>% filter( type=="Phylum2"), position = position_dodge(width = 0.9), alpha = 0.4) +
  geom_tile(aes(y=NA_integer_, alpha = factor(type))) + 
  scale_alpha_manual(values = c(1,0.4)) 
```

[![在此处输入图像描述](../Images/d5b55eaea9deaae671d75222144b8b77.png)](https://i.stack.imgur.com/epIEw.png)

现在您可以添加`theme(panel.background = element_rect(fill ="yellow"))`一些背景填充来混合颜色：

[![在此处输入图像描述](../Images/dee02d038f0ff5071180abcc3506f0a4.png)](https://i.stack.imgur.com/orbvR.png)

最后，您必须使用 inkscape 修复图例。

# macos - 在 OSX 上更新 emacs

> ID：12715641
> 
> 赞同：3
> 
> 时间：2012-10-03T19:39:51.823
> 
> 标签：macos, emacs, updates

我尝试使用以下命令将我的 emacs (22.1) 更新到较新版本：

```
 $ sudo port -u upgrade emacs
Warning: port definitions are more than two weeks old, consider using selfupdate
--->  Scanning binaries for linking errors: 100.0%
--->  No broken files found. 
```

现在`emacs --version`仍然返回'22'，显然意味着它还没有更新。

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T19:44:45.453

```
sudo port selfupdate
sudo port -u upgrade emacs 
```

# winapi - 如何使用 FormatMessage c++ 获取仅英文消息

> ID：12715646
> 
> 赞同：11
> 
> 时间：2012-10-03T19:40:18.337
> 
> 标签：winapi, locale

我正在尝试使用格式消息来获取仅英文值

MSDN 指定以下内容

```
DWORD WINAPI FormatMessage(
  _In_      DWORD dwFlags,
  _In_opt_  LPCVOID lpSource,
  _In_      DWORD dwMessageId,
  _In_      DWORD dwLanguageId,
  _Out_     LPTSTR lpBuffer,
  _In_      DWORD nSize,
  _In_opt_  va_list *Arguments
); 
```

对于 dwLanguageId 参数，

> 请求消息的语言标识符。如果 dwFlags 包含 FORMAT_MESSAGE_FROM_STRING，则忽略此参数。
> 
> 如果您在此参数中传递特定 LANGID，则 FormatMessage 将仅返回该 LANGID 的消息。如果函数找不到该 LANGID 的消息，它将 Last-Error 设置为 ERROR_RESOURCE_LANG_NOT_FOUND。如果您传入零，则 FormatMessage 按以下顺序查找 LANGID 消息：
> 
> 1.  语言中立
> 2.  线程 LANGID，基于线程的语言环境值
> 3.  用户默认 LANGID，基于用户的默认语言环境值
> 4.  系统默认 LANGID，基于系统默认语言环境值
> 5.  美国英语
> 
> 如果 FormatMessage 没有找到任何上述 LANGID 的消息，它会返回任何存在的语言消息字符串。如果失败，则返回 ERROR_RESOURCE_LANG_NOT_FOUND。

这是否意味着，如果值为 5，它将返回英文消息？

你能澄清一下吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-03T20:07:55.830

文档中的数字 5 表示当您将零作为参数值传递时，美国英语是第五种语言，`FormatMessage`它将尝试使用前四个选项并失败后。`5`这与传递该函数参数的值无关。

要请求英语消息，请传入美国英语的 LANGID 值，您可以使用`MAKELANGID(LANG_ENGLISH, SUBLANG_ENGLISH_US)`. 该`FormatMessage`文档链接到[有关语言标识符](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318691.aspx)的文档，该文档又链接到[语言标识符常量和字符串](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318693.aspx)的页面。

# html - 将 DIV 拉伸到页面底部，并在其上方添加一个元素

> ID：12715648
> 
> 赞同：1
> 
> 时间：2012-10-03T19:40:26.793
> 
> 标签：html, css

我尝试将 DIV 拉伸到页面底部，并在其上方添加一个元素。这基本上是可行的，但是它上面的元素的高度被添加到了 DIV 中。

请参阅 jsFiddle 示例：http: [//jsfiddle.net/CjKFX/](http://jsfiddle.net/CjKFX/)

如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:47:41.053

**CSS：**

```
html, body {height: 100%;}

#header, #headline { position:absolute; width:100%; top:0; }

#header {height: 100px; z-index:1; background-color:#f40; }
#headline {height: 100%; top:100px; margin-top:-100px; background: #000;} 
```

**HTML**

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
        <header id="header">
            header
        </header>

        <section id="headline">
            section
        </section>

    </body>
</html> 
```

[http://jsfiddle.net/Zeggw/](http://jsfiddle.net/Zeggw/)

​</p>

# google-sheets - =MATCH() 返回错误值

> ID：12715658
> 
> 赞同：4
> 
> 时间：2012-10-03T19:41:07.937
> 
> 标签：google-sheets, match, google-sheets-formula

为什么[这](https://docs.google.com/spreadsheet/ccc?key=0AiNJOiic9NfFdG9GeXM4S21iWWp0MU9pMWtucUpMQ3c)不起作用？我在每个地区的于韦斯屈莱市拥有芬兰不同政党的投票份额。

每一行显示一个地区，每一列都有每一方的选票份额。我想添加一列，谷歌电子表格将找出哪一列在该特定行上具有最大值，然后返回该列标题行上的文本。

换句话说，我想添加“最大的政党专栏”，以显示哪个政党在每个地区获得了最大的选票份额。

我认为应该可以使用 =max()-function 找出最大值，然后使用 =match() 函数给出行上具有最大值的单元格的列索引号，最后使用 =index() -函数从标题行返回派对的名称。

任何想法我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T19:44:29.533

MATCH 需要为您的案例提供第三个零参数（以获得完全匹配）。将公式更改为

`=INDEX(C$1:M$1,MATCH(MAX(C2:M2),C2:M2,0))`

# python - How to create REST API application using python Bottle framework and how to deploy it on apache server?

> ID：12715660
> 
> 赞同：3
> 
> 时间：2012-10-03T19:41:13.720
> 
> 标签：python, api, bottle

I want to create one sample application for api's using python Bottle framework, I want to deploy that application on apache server as well, I use following sample code,

```
from bottle import route, run, template

@route('/hello/:name')
def index(name='World'):
    return template('<b>Hello {{name}}</b>!', name=name)

@route('/events/:id', method='GET')
def get_event(id):
    return dict(name = 'Event ' + str(id))
run(host='localhost', port=8082) 
```

by using above code, How I can create sample application and how I can deploy that sample application on server. How can achieve this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-07T07:23:20.507

[**@phihag**](https://stackoverflow.com/users/35070/phihag), go through these articles by Miguel Grinberg, [@miguelgrinberg](http://twitter.com/miguelgrinberg) ~ [http://blog.miguelgrinberg.com/category/REST](http://blog.miguelgrinberg.com/category/REST)

Start with this article, "**[Designing a RESTful API with Python and Flask](http://blog.miguelgrinberg.com/post/designing-a-restful-api-with-python-and-flask)**" ~ and if need be install Flask, go through the steps.

Then re-write the application in Bottle. Bottle is a simple framework to use and is so close to Flask I re-wrote the code reading through the example in Bottle. There is a more [detailed tutorial](http://blog.miguelgrinberg.com/post/designing-a-restful-api-using-flask-restful) that you can look at once you have the basics.

It's worth the effort.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-05T14:07:37.357

Try to use the "method=GET/POST/PUT/DELETE"

recipes-api.py

```
import json
import os
from bottle import route, run, static_file, request

config_file = open( 'config.json' )
config_data = json.load( config_file )
pth_xml     = config_data["paths"]["xml"]

@route('/recipes/')
def recipes_list():
    paths = []
    ls = os.listdir( pth_xml )
    for entry in ls:
        if ".xml" == os.path.splitext( entry )[1]:
            paths.append( entry )
    return { "success" : True, "paths" : paths }

@route('/recipes/<name>', method='GET')
def recipe_show( name="" ):
    if "" != name:
        return static_file( name, pth_xml  )
    else:
        return { "success" : False, "error" : "show called without a filename" }

@route('/recipes/_assets/<name>', method='GET')
def recipe_show( name="" ):
    if "" != name:
        return static_file( name, pth_xml + "_assets/" )
    else:
        return { "success" : False, "error" : "show called without a filename" }

@route('/recipes/<name>', method='DELETE' )
def recipe_delete( name="" ):
    if "" != name:
        try:
            os.remove( os.path.join( pth_xml, name + ".xml" ) )
            return { "success" : True  }
        except:
            return { "success" : False  }

@route('/recipes/<name>', method='PUT')
def recipe_save( name="" ):
    xml = request.forms.get( "xml" )
    if "" != name and "" != xml:
        with open( os.path.join( pth_xml, name + ".xml" ), "w" ) as f:
            f.write( xml )
        return { "success" : True, "path" : name }
    else:
        return { "success" : False, "error" : "save called without a filename or content" }

run(host='localhost', port=8080, debug=True) 
```

config.json

```
{
    "paths" : {
        "xml" : "xml/"
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-27T07:59:28.363

Here you have explanation how to deploy bottle app in apache with the use of WSGI: [http://bottlepy.org/docs/dev/deployment.html#apache-mod-wsgi](http://bottlepy.org/docs/dev/deployment.html#apache-mod-wsgi)

As far as application is concerned you need to best REST compliant so learn about REST and bottle, here is a good tutorial which I used: [http://myadventuresincoding.wordpress.com/2011/01/02/creating-a-rest-api-in-python-using-bottle-and-mongodb/](http://myadventuresincoding.wordpress.com/2011/01/02/creating-a-rest-api-in-python-using-bottle-and-mongodb/)

# perl - Perl：如何将信息传递给模块中的函数？

> ID：12715661
> 
> 赞同：1
> 
> 时间：2012-10-03T19:41:25.283
> 
> 标签：perl, perl-module

这里对 Perl 完全陌生。无论如何，我被分配了一项任务，我在网上找到了一个 perl 模块，它*完全*符合我的要求。

[矩阵](http://jaspar.genereg.net/html/DOWNLOAD/jaspar_CORE/non_redundant/by_tax_group/vertebrates/matrix_only/matrix_only.txt)

[文档](http://tfbs.genereg.net/DOC/)

这是 perl 模块的文档——在 Ext 下有一个叫做 pwmsearch 的文档，它完全符合我的需要。

所以我试着写一个脚本，开始是这样的：

```
#!/usr/bin/env perl -w

use strict; 
use TFBS::Ext::pwmsearch; #this was how the documentation said in synopsis part for pwmsearch so I figured this was how to do it 
```

问题是我无法弄清楚我应该如何将对象传递给 pwmsearch。上面文档中显示的 pwmsearch 的源代码说它需要 $matrixobj 和 $seqobj，我已经将它们存储为文件矩阵和序列。

因此，在搜索了我可以尝试的内容之后，我尝试了以下操作：

```
pwmsearch('matrix','sequence'); 
```

或者

```
open FILE, 'matrix.txt' or die "Couldn't open file";
$matrix.=<FILE>
close FILE;

open FILE, 'sequence' or die "Couldn't open file";
$seq.=<FILE>
close FILE;
pwmsearch($matrix,$seq) 
```

但是所有这些都使 perl 以各种错误对我咆哮。我做错了什么，我能做些什么来解决它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T08:34:25.827

以下是如何生成 pwm 矩阵对象的文档：[http ://tfbs.genereg.net/DOC/TFBS​​/Matrix/PWM.html](http://tfbs.genereg.net/DOC/TFBS/Matrix/PWM.html)

```
use TFBS::Matrix::PWM;
my $matrixstring = <<ENDMATRIX
 0.61 -3.16  1.83 -3.16  1.21 -0.06
-0.15 -2.57 -3.16 -3.16 -2.57 -1.83
-1.57  1.85 -2.57 -1.34 -1.57  1.14
 0.31 -3.16 -2.57  1.76  0.24 -0.83
ENDMATRIX;
my $pwm_matrix_in = TFBS::Matrix::PWM->new(-matrixstring => $matrixstring,
                 -name         => "MyProfile",
                 -ID           => "M0001"
                ); 
```

PWMSearch 文档：[http ://tfbs.genereg.net/DOC/Ext/pwmsearch.html](http://tfbs.genereg.net/DOC/Ext/pwmsearch.html)

它需要五个输入变量：$matrixobj、$seqobj、$threshold、$start、$end，如果我没看错，最后 3 个是可选的。

seqobj 很可能是 Bio::Seq 兼容对象。从文件创建一个新对象：文档： http://metacpan.org/pod/Bio:: [SeqIO](http://metacpan.org/pod/Bio%3a%3aSeqIO)

```
use Bio::SeqIO;
my $seqobj_in  = Bio::SeqIO->new(-file => "inputfilename" ,
                           -format => 'Fasta');

use strict; 
use TFBS::Ext::pwmsearch;
TFBS::Ext::pwmsearch::pwmsearch($pwm_matrix_in,$seqobj_in); 
```

我希望这可以帮助你。

# c# - Linq to Entity Select，排除第一个结果行？

> ID：12715663
> 
> 赞同：0
> 
> 时间：2012-10-03T19:41:27.790
> 
> 标签：c#, asp.net-mvc, linq, entity-framework

我有一个 Linq to Entity Select 语句，它当前正在从数据库中返回所有行。由于第一行数据包含标题信息，是否可以从结果集中排除第一行？

```
var surveyProgramType = surveyProgramTypeRepository
                        .Find()
                        .OrderBy(x => x.ProgramType); 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T19:42:52.673

采用`.Skip()`

```
var surveyProgramType = surveyProgramTypeRepository
    .Find()
    .OrderBy(x => x.ProgramType)
    .Skip(1); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:44:24.890

```
var surveyProgramType = surveyProgramTypeRepository
    .Find()
    .OrderBy(x => x.ProgramType).Skip(1); 
```

# c# - 在 ASP.NET MVC 3 中为控制器设置默认操作（而不是索引）

> ID：12715667
> 
> 赞同：23
> 
> 时间：2012-10-03T19:41:43.723
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, routes, asp.net-mvc-routing

我有一个`Dashboard`用 3 个动作调用的控制器：`Summary`、`Details`和`Status`，它们都不接受 ID 或任何其他参数。我希望 URL像那样`/Dashboard`路由到控制器的`Summary`操作，但我无法找出添加路由的正确方法。在中，我有以下内容：`Dashboard``/Dashboard/Summary``Global.asax.cs`

```
routes.MapRoute(
    "Default", // Route name
    "{controller}/{action}/{id}", // URL with parameters
    new {controller = "Home", action = "Index", id = UrlParameter.Optional} // Parameter defaults
    );

routes.MapRoute(
    "/Dashboard",
    "Dashboard",
    new { controller = "Dashboard", action = "Summary" }
    ); 
```

对于第二部分，我也尝试过：

```
routes.MapRoute(
    "/Dashboard",
    "{controller}",
    new { controller = "Dashboard", action = "Summary" }
    ); 
```

和

```
routes.MapRoute(
    "/Dashboard",
    "{controller}",
    new { action = "Summary" }
    ); 
```

但我在尝试访问时总是得到 404 `/Dashboard`。我很确定我遗漏了关于 to 参数格式的一些东西`MapRoute`，但我不知道它是什么......

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-10-03T19:46:06.357

将 Dashboard 路由移到 Default 路由之前：

```
routes.MapRoute(
    "Dashboard",
    "Dashboard/{action}",
    new { controller = "Dashboard", action = "Summary" }
);

routes.MapRoute(
    "Default", // Route name
    "{controller}/{action}/{id}", // URL with parameters
    new {controller = "Home", action = "Index", id = UrlParameter.Optional} // Parameter defaults
); 
```

路线的顺序改变了一切。另外，请注意我对`Dashboard`路线所做的更改。第一个参数是路由的名称。其次是 URL，它匹配以 开头的 URL `Dashboard`，并允许在`Dashboard`控制器中执行其他操作。如您所见，它将默认为`Summary`操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-03T19:45:53.757

您需要最后声明“默认”包罗万象的路线。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-05T10:56:04.980

这为任何控制器 asp.net 设置默认操作：

```
routes.MapRoute("Dashboard", "{controller}/{action}", 
defaults: new { controller = "Dashboard", action = "Summary" }); 
```

# javascript - 如何在 Parse.com/backbone.js 中保存对象顺序

> ID：12715670
> 
> 赞同：0
> 
> 时间：2012-10-03T19:41:45.403
> 
> 标签：javascript, jquery, ajax, backbone.js, parse-platform

我有一个属于用户的文件夹列表，我希望他们能够通过拖放来重新排序。我可以让拖放正常工作，但我不知道如何保存结果。我正在使用 Parse，我认为这意味着我必须检索每个对象，更改 order 属性，然后重新保存它......但这似乎不起作用，因为它们都以相同的顺序出现。

在排序然后执行 .sortable('toArray') 之后，我有一个文件夹 id 数组，前面带有单词 'folder'，所以它看起来像 ["folder_ab9gu3nd"、"folder_kwkgiutyqo"、"folder_s856skt8w"]。

所以，我想用命令 0 保存文件夹 ab9gu3nd，用命令 1 保存 kwkgiutyqo，用命令 2 保存 s856skt8w。

这是我的代码（“结果”是具有文件夹 ID 的数组）：

```
 for(var ii=0; ii<result.length; ii++) {
                            // Get actual id
            var folderId = result[ii].replace('folder_', '');
            var folderOrder = ii;
            var folder = Parse.Object.extend("Folder");
            var query = new Parse.Query(folder);
            query.get(folderId, {
                success: function(folder) {
                    // The object was retrieved successfully.
                    folder.set('order', folderOrder);
                    folder.save();
                }
            });
        } 
```

当我运行它时，所有文件夹都以“2”的顺序结束，就好像 ii 的最终值用于所有文件夹一样。我该如何阻止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:13:44.330

你被两件事愚弄了：

1.  您`var`在循环中的 s 被提升到周围的功能，它们不是循环的本地。
2.  您的`success`处理程序是异步触发的，它们是**完全相同的`folderOrder`**闭包。

对于第一个，就 JavaScript 而言，您的循环实际上看起来像这样：

```
function whateverItIsCalled() {
    var folderId, folderOrder, folder, query, ii;
    //...
    for(ii = 0; ii < result.length; ii++) {
        //...
        folderOrder = ii;
        //...
    }
    //...
} 
```

所以`folderOrder`整个函数只有一个，你的循环只是`ii`在每次迭代时分配给它。

第二个问题是常见的“循环中的 AJAX”问题：您正在构建一系列匿名函数，这些函数是对同一`folderOrder`变量的闭包。这样做的结果是所有三个`success`处理程序最终都引用了相同的`folderOrder`值，并且在它们被触发时，循环将完成并`folderOrder`具有循环中的最后一个值；在您的情况下，最后一个值为 2。

要解决您的问题，您只需将单独`folderOrder`的值放入各种`success`处理程序中。一种方法是使用函数来生成成功处理程序：

```
function makeSuccess(folderOrder) {
    return function(folder) {
        folder.set('order', folderOrder);
        folder.save();
    }
} 
```

进而：

```
query.get(folderId, {
    success: makeSuccess(folderOrder)
}); 
```

另一种常见的方法是使用自执行函数来有效地为循环体创建一个不同的范围：

```
for(var ii = 0; ii < result.length; ii++)
    (function(ii) {
        // Same stuff you currently have...
    })(ii); 
```

您采用哪种方法是个人喜好问题。

# python - 使用矩阵乘法进行 numpy 模板匹配

> ID：12715673
> 
> 赞同：5
> 
> 时间：2012-10-03T19:41:56.757
> 
> 标签：python, numpy, template-matching

我试图通过沿图像移动模板来将模板与二进制图像（仅黑白）匹配。并返回模板和图像之间的最小距离，以及该最小距离确实出现的相应位置。例如：

图像：

```
0 1 0
0 0 1
0 1 1 
```

模板：

```
0 1
1 1 
```

该模板在位置 (1,1) 与图像最匹配，然后距离将为 0。到目前为止，事情并不太难，我已经得到了一些可以解决问题的代码。

```
def match_template(img, template):
    mindist = float('inf')
    idx = (-1,-1)
    for y in xrange(img.shape[1]-template.shape[1]+1):
        for x in xrange(img.shape[0]-template.shape[0]+1):
        #calculate Euclidean distance
        dist = np.sqrt(np.sum(np.square(template - img[x:x+template.shape[0],y:y+template.shape[1]])))
        if dist < mindist:
            mindist = dist
            idx = (x,y)
    return [mindist, idx] 
```

但是对于我需要的大小的图像（500 x 200 像素之间的图像和 250 x 100 之间的模板），这已经需要大约 4.5 秒，这太慢了。而且我知道使用矩阵乘法可以更快地完成同样的事情（在 matlab 中，我相信这可以使用 im2col 和 repmat 来完成）。谁能解释我如何在 python/numpy 中做到这一点？

顺便提一句。我知道有一个 opencv matchTemplate 函数可以完全满足我的需要，但是由于我稍后可能需要稍微更改代码，所以我更喜欢我完全理解并且可以更改的解决方案。

谢谢！

编辑：如果有人可以向我解释 opencv 如何在不到 0.2 秒的时间内做到这一点，那也很棒。我看了一眼源代码，但这些东西对我来说总是很复杂。

编辑2：赛通代码

```
import numpy as np
cimport numpy as np

DTYPE = np.int
ctypedef np.int_t DTYPE_t

def match_template(np.ndarray img, np.ndarray template):
    cdef float mindist = float('inf')
    cdef int x_coord = -1
    cdef int y_coord = -1
    cdef float dist
    cdef unsigned int x, y
    cdef int img_width = img.shape[0]
    cdef int img_height = img.shape[1]
    cdef int template_width = template.shape[0]
    cdef int template_height = template.shape[1]
    cdef int range_x = img_width-template_width+1
    cdef int range_y = img_height-template_height+1
    for y from 0 <= y < range_y:
        for x from 0 <= x < range_x:
            dist = np.sqrt(np.sum(np.square(template - img[ x:<unsigned int>(x+template_width), y:<unsigned int>(y+template_height) ]))) #calculate euclidean distance
            if dist < mindist:
                mindist = dist
                x_coord = x
                y_coord = y
    return [mindist, (x_coord,y_coord)]

img = np.asarray(img, dtype=DTYPE)
template = np.asarray(template, dtype=DTYPE)
match_template(img, template) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T15:24:44.160

一种可能的方法是通过卷积（可以是蛮力或 FFT）。矩阵乘法 AFAIK 不起作用。您需要将数据与模板进行卷积。并找到最大值（您还需要进行一些缩放以使其正常工作）。

```
xs=np.array([[0,1,0],[0,0,1],[0,1,1]])*1.
ys=np.array([[0,1],[1,1]])*1.
print scipy.ndimage.convolve(xs,ys,mode='constant',cval=np.inf)
>>> array([[  1.,   1.,  inf],
       [  0.,   2.,  inf],
       [ inf,  inf,  inf]])

print scipy.signal.fftconvolve(xs,ys,mode='valid') 
>>> array([[ 1.,  1.],
           [ 0.,  2.]]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T14:41:01.497

可能有一种奇特的方法可以使用纯 numpy/scipy 魔法来完成这项工作。但是，直接进入 Cython 来完成这项工作可能会更容易（当您将来查看代码时也更容易理解）。[在http://docs.cython.org/src/tutorial/numpy.html](http://docs.cython.org/src/tutorial/numpy.html)有一个很好的将 Cython 与 numpy 集成的教程。

编辑：我对您的 Cython 代码进行了快速测试，对于 500x400 img 和 100x200 模板，它运行了约 15 秒。经过一些调整（消除了 numpy 方法调用和 numpy 边界检查），我在 3 秒内完成了它。这对你来说可能还不够，但它显示了这种可能性。

```
import numpy as np
cimport numpy as np
cimport cython
from libc.math cimport sqrt

DTYPE = np.int
ctypedef np.int_t DTYPE_t

@cython.boundscheck(False)
def match_template(np.ndarray[DTYPE_t, ndim=2] img, np.ndarray[DTYPE_t, ndim=2] template):
    cdef float mindist = float('inf')
    cdef int x_coord = -1
    cdef int y_coord = -1
    cdef float dist
    cdef unsigned int x, y
    cdef int img_width = img.shape[0]
    cdef int img_height = img.shape[1]
    cdef int template_width = template.shape[0]
    cdef int template_height = template.shape[1]
    cdef int range_x = img_width-template_width+1
    cdef int range_y = img_height-template_height+1
    cdef DTYPE_t total
    cdef int delta
    cdef unsigned int j, k, j_plus, k_plus
    for y from 0 <= y < range_y:
        for x from 0 <= x < range_x:
            #dist = np.sqrt(np.sum(np.square(template - img[ x:<unsigned int>(x+template_width), y:<unsigned int>(y+template_height) ]))) #calculate euclidean distance
            # Do the same operations, but in plain C
            total = 0
            for j from 0 <= j < template_width:
                j_plus = <unsigned int>x + j
                for k from 0 <= k < template_height:
                    k_plus = <unsigned int>y + k
                    delta = template[j, k] - img[j_plus, k_plus]
                    total += delta*delta
            dist = sqrt(total)
            if dist < mindist:
                mindist = dist
                x_coord = x
                y_coord = y
    return [mindist, (x_coord,y_coord)] 
```

# javascript - HTML 5/Javascript 画布加载图像错误

> ID：12715678
> 
> 赞同：0
> 
> 时间：2012-10-03T19:42:28.050
> 
> 标签：javascript, image, html, canvas

我正在尝试在函数中加载图像，但图像未显示在屏幕上。没有控制台错误，所以我不知道为什么它不起作用。代码：

```
var canvas = document.getElementById('canvas');
ctx = canvas.getContext('2d');

var score = 0;
var menuImg = new Image();
menuImg.src = "images/Startscreen.png";

gamemenu();

//The menu screen
function gamemenu(){
    ctx.drawImage(menuImg,0,0);
} 
```

调用函数时应该绘制图像但它没有绘制，有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:51:11.370

加载图像是一个异步过程，因此您需要为“加载”事件添加事件处理程序。

```
menuImg = new Image();
menuImg.addEventListener("load", function () {
    gamemenu();
}, false); 
```

因为我们大量使用画布和精灵渲染，所以我在我的项目中定期处理这个问题。

更新：这是[MDN](https://developer.mozilla.org/en-US/docs/Canvas_tutorial/Using_images)关于这个主题的页面。

# java - Java中的奥术isPrime方法

> ID：12715679
> 
> 赞同：10
> 
> 时间：2012-10-03T19:42:33.870
> 
> 标签：java, regex, primes

考虑以下方法：

```
public static boolean isPrime(int n) {
    return ! (new String(new char[n])).matches(".?|(..+?)\\1+");
} 
```

我从来都不是正则表达式大师，所以任何人都可以完全解释这种方法实际上是如何工作的吗？*此外*，与确定整数是否为素数的其他可能方法相比，它是否有效？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T19:57:08.227

首先，请注意，此正则表达式适用于一元计数系统中表示的数字，即

```
1       is 1
11      is 2
111     is 3
1111    is 4
11111   is 5
111111  is 6
1111111 is 7 
```

等等。实际上，可以使用任何字符（因此`.`表达式中的 s），但我将使用“1”。

其次，注意这个正则表达式匹配*复合*（非素数）数字；因此，否定检测素性。

* * *

**解释：**

表达式的前半部分，

```
.? 
```

表示字符串 "" (0) 和 "1" (1) 是匹配的，*即不是素数*（根据定义，[尽管可以争论](http://en.wikipedia.org/wiki/Prime_number#Primality_of_one)。）

后半部分用简单的英语说：

> 匹配长度至少为 2 的最短字符串，例如 "11" (2)。现在，看看我们是否可以通过重复来匹配整个字符串。“1111”（4）匹配吗？“111111”(6) 匹配吗？“11111111”(8) 匹配吗？等等。如果不是，则再次尝试下一个最短的字符串“111”(3)。等等。

您现在可以看到，如果原始字符串不能与其子字符串的*倍数*匹配，那么根据定义，它是素数！

顺便说一句，非贪婪运算符`?`是使“算法”从最短开始并向上计数的原因。

* * *

**效率：**

通过各种论点，这很有趣，但肯定不是有效的，其中一些我将在下面进行合并：

*   正如@TeddHopp 所指出的，众所周知的埃拉托色尼筛法不会费心检查整数的倍数，例如 4、6 和 9，在检查 2 和 3 的倍数时已经“访问过”。唉，这个正则表达式方法详尽地检查每个较小的整数。

*   正如@PetarMinchev 指出的那样，一旦我们达到数字的平方根，我们就可以“短路”多重检查方案。我们应该能够，因为*大于*平方根的因子必须与小于平方根的因子配对*（*否则两个大于平方根的因子会产生大于数字的乘积），如果存在这个更大的因子，那么我们应该已经遇到（并因此匹配）较小的因素。

*   正如@Jesper 和@Brian 简明扼要地指出的那样，从非算法的角度来看，考虑正则表达式如何通过*分配内存来存储 string*开始，*例如* `char[9000]`9000。嗯，这很容易，不是吗？;)

*   正如@Foon 所指出的，存在概率方法可能对更大的数字更有效，尽管它们可能并不总是正确的（改为使用伪素数）。但也有确定性测试 100% 准确，并且比基于筛分的方法更有效。[Wolfram's](http://mathworld.wolfram.com/PrimalityTest.html)有一个很好的总结。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-03T20:05:42.423

素数的一元特征以及它为什么起作用已经被讨论过了。所以这是一个使用传统方法和这种方法的测试：

```
public class Main {

    public static void main(String[] args) {
        long time = System.nanoTime();
        for (int i = 2; i < 10000; i++) {
            isPrimeOld(i);
        }
        time = System.nanoTime() - time;
        System.out.println(time + " ns (" + time / 1000000 + " ms)");
        time = System.nanoTime();
        for (int i = 2; i < 10000; i++) {
            isPrimeRegex(i);
        }
        time = System.nanoTime() - time;
        System.out.println(time + " ns (" + time / 1000000 + " ms)");
        System.out.println("Done");
    }

    public static boolean isPrimeRegex(int n) {
        return !(new String(new char[n])).matches(".?|(..+?)\\1+");
    }

    public static boolean isPrimeOld(int n) {
        if (n == 2)
            return true;
        if (n < 2)
            return false;
        if ((n & 1) == 0)
            return false;
        int limit = (int) Math.round(Math.sqrt(n));
        for (int i = 3; i <= limit; i += 2) {
            if (n % i == 0)
                return false;
        }
        return true;
    }
} 
```

这个测试从 2 开始计算这个数字是否是 9,999 的素数。下面是它在相对强大的服务器上的输出：

```
8537795 ns (8 ms)
30842526146 ns (30842 ms)
Done 
```

因此，一旦数字变得足够大，它的效率就会非常低。（对于高达 999，正则表达式的运行时间约为 400 毫秒。）对于小数字，它很快，但以传统方式生成高达 9,999 的素数仍然比以旧方式生成高达 99 的素数更快（ 23 毫秒）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T19:51:04.100

这不是检查数字是否为素数的真正有效方法（它检查每个除数）。

一种有效的方法是检查除数高达`sqrt(number)`. 这是如果你想确定一个数字是否是素数。否则，有更快的概率素性检查，但不是 100% 正确。

# php - php 片段在 sublime text 2 中不起作用？

> ID：12715685
> 
> 赞同：1
> 
> 时间：2012-10-03T19:43:04.523
> 
> 标签：php, code-snippets, sublimetext2

我正在尝试使用 PHP 设置 sublime text 2，但是在使代码段正常工作时遇到了一些麻烦。我已经加载了一个 PHP 项目，并看到语法正确设置为 PHP。当我转到首选项 -> 浏览 -> 包 _>php 时，我可以看到许多我无法激活的 PHP 片段，包括 $_files $_get ,$ *post。据我所知，这些选项卡触发器是'$* _'

```
<snippet>
<content><![CDATA[\$_COOKIE['${1:variable}']]]></content>
<tabTrigger>$_</tabTrigger>
<scope>source.php</scope>
<description>COOKIE['…']</description>
</snippet> 
```

但这不会生成任何显示的片段，当我在 php 文件中尝试它时。

谁能给我建议下一步该怎么做？

谢谢，

账单。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-07T17:55:22.387

适用于我的 Sublime Text 2，但仅在`<?php ?>`标签内，而不仅仅是在名为 .php 的文件中。

在标签中键入“$_ + TAB”`<?php ?>`会列出所有 $_ Snippets COOKIE、FILES、ENV 等...

我接下来的步骤是：

*   其他片段是否有效？
*   您是否创建了一个可以推翻 $_ 的代码段？
*   重新安装;-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-27T05:52:11.087

您启用了 php 的源代码，您只能在您的 php 文件中调用此代码段。

1.  创建新文件并另存为`somename.php`
2.  写`<?php`在之后
3.  输入`$_`并点击`TAB`或`Ctrl + Space`

它生成代码片段，让我们快乐编码。

# php - 在 PHP 中解析和写入文件

> ID：12715688
> 
> 赞同：1
> 
> 时间：2012-10-03T19:43:16.747
> 
> 标签：php, file-io

我试图打开一个充满文本文件的目录，然后逐行读取每个文件，将每行中的信息写入一个新文件。在我试图迭代的目录中的每个文本文件中，信息的形成如下：

```
JunkInfo/UserName_ID_Date_Location.Type 
```

所以我想打开这些文本文件中的每一个，并以以下形式在我的新文件中写入一行：

```
UserName,ID,Date,Location,Type 
```

这是我到目前为止提出的代码：

```
<?php

$my_file = 'info.txt';
$writeFile = fopen($my_file, 'w') or die('Cannot open file:  '.$my_file); //implicitly creates file

$files = scandir('/../DirectoryToScan');
foreach($files as $file)
{
    $handle = @fopen($file, "r");
    if ($handle) 
    {
        while (($buffer = fgets($handle, 4096)) !== false) 
        {
            $data = explode("_", $buffer);
            $username = explode("/", $data[0])[1];
            $location = explode(".", $data[3])[0];
            $type = explode(".", $data[3])[1];

            $stringToWrite = $username . "," . $data[1] . "," . $data[2] . "," . $location . "," . $type;

            fwrite($writeFile, $stringToWrite);
        }

        if (!feof($handle)) 
        {
             echo "Error: unexpected fgets() fail\n";
        }
        fclose($handle);
    }
}

fclose($writeFile);
?> 
```

所以我的问题是，这似乎不起作用。我只是从来没有发生过任何事情——输出文件从未被写入，我不知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:51:30.183

这条线有一个潜在的问题`scandir()`：

```
$files = scandir('/../DirectoryToScan'); 
```

该路径以 a 开头`/`，这意味着它正在查找服务器的根目录。所以，它试图读取的目录是`/DirectoryToScan`. 要修复它，您只需删除前导`/`. 当然，这可能是此示例的示例路径，可能实际上并不适用于现实，或者您的系统根目录中确实有一个名为 that 的目录 - 在这些情况下，请随意忽略此位 =P。

下一件事是当您使用`fopen()`正在迭代的文件时。`scandir()`返回文件*名*，而不是完整路径。您每次都需要连接目录名称和文件：

```
$dir = '../DirectoryToScan/';
$files = scandir($dir);
foreach($files as $file) {
    $handle = @fopen($dir . $file, "r"); 
```

我目前正在运行旧版本的 PHP，因此从返回函数直接访问数组索引，例如 with `explode("/", $data[0])[1]`，对我不起作用（它是在[PHP 5.4](http://php.net/manual/en/language.types.array.php#example-87)中添加的）。

除此之外，您的其余代码看起来应该可以正常工作（减去我可能忽略的任何潜在逻辑/数据错误）。

# java - Java：从多个数组中的重复项中获取平均时间

> ID：12715689
> 
> 赞同：0
> 
> 时间：2012-10-03T19:43:28.230
> 
> 标签：java, arrays

我正在编写一个 Java 类来解析具有以下内容的文件：

```
[thread 16] INFO - L3: createOrder: min [239.0] max [1245.0] average [488.06]  
[thread 16] INFO - L3: translateBarCode: min [9.0] max [132.0] average [31.1]  
[thread 11] INFO - L3: createOrder: min [258.0] max [2458.0] average [506.31]  
[thread 13] INFO - L3: createOrder: min [243.0] max [1303.0] average [542.57]  
[thread 11] INFO - L3: translateBarCode: min [9.0] max [104.0] average [29.79] 
[thread 13] INFO - L3: translateBarCode: min [9.0] max [129.0] average [37.94] 
[thread 5] INFO - L3: createOrder: min [269.0] max [1269.0] average [479.95]   
[thread 5] INFO - L3: translateBarCode: min [9.0] max [124.0] average [30.34]  
[thread 3] INFO - L3: createOrder: min [236.0] max [1238.0] average [492.35]   
[thread 3] INFO - L3: translateBarCode: min [10.0] max [108.0] average [32.04] 
[thread 16] INFO - L3: changeOrder: min [662.0] max [4204.0] average [1379.84] 
[thread 17] INFO - L3: createOrder: min [236.0] max [1335.0] average [521.18]  
[thread 16] INFO - L3: translateBarCode: min [10.0] max [112.0] average [34.87]
[thread 17] INFO - L3: translateBarCode: min [10.0] max [103.0] average [36.45]
[thread 13] INFO - L3: changeOrder: min [617.0] max [4094.0] average [1520.84] 
[thread 13] INFO - L3: translateBarCode: min [9.0] max [108.0] average [31.38] 
[thread 11] INFO - L3: changeOrder: min [620.0] max [4099.0] average [1316.38] 
[thread 5] INFO - L3: changeOrder: min [647.0] max [4154.0] average [1384.15]  
[thread 5] INFO - L3: translateBarCode: min [8.0] max [110.0] average [31.42]  
...
... 
```

我能够使用基本的 substr 和 Collections.sort 类型的东西成功地将它变成类似这样的 CVS 格式：

```
API, Min, Max, Average
capturePayment, 232.0, 1800.0, 687.68
capturePayment, 268.0, 1853.0, 761.44
capturePayment, 301.0, 2612.0, 753.69
capturePayment, 309.0, 2632.0, 766.31
...
... 
```

我的问题是我想将所有重复的 API 时间平均到每个 API 的一个条目中（即每个 API 的平均最小/最大/平均值）。原始文件中有重复项，并且未排序，因此我不确定如何继续。

我最大的问题是 API 的数量并不总是相同的，即可能有 10 个 capturePayment 调用，但有 20 个 createOrders。否则我有一个大致工作的模型。有人可以给我一些指示吗？

[编辑]

使用下面的“registerAPI”解决方案，我就快到了。计算的平均值与 Excel 中应基于的平均值略有不同。这是我的代码。我唯一的想法可能是从 Strings 转换为 Doubles 会破坏精度？

```
 while ((line = br.readLine()) != null) {
        if (line.contains("L3")) {
            int x,y;
            x = line.indexOf("L3: ") + "L3: ".length();
            y = line.indexOf(":", x);
            String name = line.substring(x,y).trim();
            x = line.indexOf("min [") + "min [".length();
            y = line.indexOf("]", x);
            String min = line.substring(x,y).trim();
            x = line.indexOf("max [") + "max [".length();
            y = line.indexOf("]", x);
            String max = line.substring(x,y).trim();
            x = line.indexOf("average [") + "average [".length();
            y = line.indexOf("]", x);
            String average = line.substring(x,y).trim();
            pStreamArray.add(name + ", " + min + ", " + max + ", " + average);
            double[] apiValues = new double[3];
            apiValues[0] = Double.valueOf(min);
            apiValues[1] = Double.valueOf(max);
            apiValues[2] = Double.valueOf(average);
            parseAPILogs.registerAPI(name, apiValues);
        }
    }

    Iterator iterator = averagePerAPI.keySet().iterator();
    while (iterator.hasNext()) {
        String key = iterator.next().toString();
        double[] values = averagePerAPI.get(key);
        String valueString = "";
        for (int i = 0; i < values.length; i++) {
            valueString += values[i] + ", ";
        }
        System.out.println(key + " " + valueString); 
        pStreamCombined.println(key + " " + valueString);
    } 
```

[编辑]

我在上面的代码中发现了数学缺陷 - 3 个数字的平均值不等于前两个数字的平均值，然后平均到第三个数字。

示例：(395+415+412)/3=407.33

(395+415)/2=405 (405+412)/2=408.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:55:44.397

正如我所看到的，您可以使用`Map`一个普通的容器来实现这一点。

容器是一个具有当前总和的类`MIN`，`MAX`并`AVERAGE`与当前计数一起：

```
public class APIData {

    private double min;
    private double max;
    private double average;
    private int amount;

    public void addValues(double[] values) {
        min += values[0];
        max += values[1];
        average += values[2];
        amount++;
    }

    public double getAPIMin() {
        return min / amount;
    }

    public double getAPIMax() {
        return max / amount;
    }

    public double getAPIAverage() {
        return average / amount;
    }

} 
```

在地图上：

```
Map<String,APIData> averagePerAPI = new LinkedHashMap<String,int[]>(); 
```

此映射的键是 API 的名称，值是`double`大小为 3的数组，`{MIN, MAX, AVERAGE}`由于上述代码的逻辑，您可以按特定顺序保存该数组。

最后，您只需使用地图提供的不同方法来管理地图。例如，`registerAPI`保存 API 数据的方法会更新现有数据。

```
public void registerAPI(String apiName, double[] apiValues) {
    if(!averagePerAPI.containsKey(apiName)) {
        APIData data = new APIData();
        data.addValues(apiValues)
        averagePerAPI.put(apiName, data);
    } else {
        averagePerAPI.get(apiName).addValues(apiValues);
    }
} 
```

当您想知道 API 的特定值时，您只需调用`getAPIMin()`或`getAPIMax()`方法`getAPIAverage()`。

# sql - 选择一列至少包含一个不在白名单中的字符的行

> ID：12715694
> 
> 赞同：2
> 
> 时间：2012-10-03T19:43:40.670
> 
> 标签：sql, sql-server

我正在将一些敏感数据从低安全性加密转换为更高安全性的加密（特别是从 CFMX_COMPAT 转换为具有 256 位密钥的 AES）。我打算使用 Hex 对我的 AES 加密字符串进行编码，而 CFMX_COMPAT 极有可能使用特殊字符，因此查找尚未转换的记录应该像（伪代码）一样简单：

```
select from table where column has at least one character not in [A-Z0-9] 
```

这在 SQL 中可能吗？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T20:08:30.743

我找到[了这个文档](http://msdn.microsoft.com/en-us/library/ms188342.aspx)，但我不知道在一个简单的 LIKE 子句中它是可能的。惊人的！

```
select top 10 foo
from bar
where foo like '%[^A-Z0-9]%' 
```

# jsf-2 - 如何在用户详细信息页面中显示动态照片

> ID：12715697
> 
> 赞同：1
> 
> 时间：2012-10-03T19:43:52.427
> 
> 标签：jsf-2, path, primefaces, graphicimage

> **可能重复：**
> [使用 p:graphicImage 显示数据库中的图像](https://stackoverflow.com/questions/8207325/display-image-from-database-with-pgraphicimage)

我想从存储在数据库中的 url 显示一张照片，所以我使用如下

```
 <h:panelGrid columns="1">
                    <p:graphicImage value="#{userController.photo}"/> 
                </h:panelGrid> 
```

photo 属性是一个指向照片位置的 url 字符串

```
public String getPhoto() {
   String path = new File("").getAbsolutePath();
   ph =ejbPhoto.find(current.getIdPhoto()); 
   System.out.println("+PHOTO +++++++++++++++"+path+"\\"+ph.getPhotoName()); 
   return path+"\\"+ph.getPhotoName();
} 
```

system.out.println 显示图像的正确路径，但在显示页面中未显示照片，所以有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T20:38:20.057

首先，`new File("").getAbsolutePath()`返回当前工作目录。即在发出命令启动服务器时打开的本地磁盘文件系统目录。**不**保证每次启动服务器时该值都相同。这取决于服务器的启动方式。例如，在 IDE 中，或在命令控制台中，或通过服务等。

您绝对不应该让您的业务逻辑依赖于这种环境不一致。

其次，生成的 HTML`<img src>`必须指向 URL（HTTP 路径），而不是本地磁盘文件系统路径。即必须通过 URL 单独下载图像的网络浏览器`http://example.com/contextname/images/foo.png`（而不是必须自动将它们嵌入到 HTML 代码中的网络服务器）。您当前的代码方法仅在`new File("")`指向已部署 web 应用程序的公共 Web 内容文件夹时才有效，这是非常非常不可能的。

您应该确保这些`<img src>`指向一个有效的 HTTP URL，正是您可以在 webbrowser 的地址栏中复制粘贴的那个。

* * *

目前尚不清楚您为什么要这样设计它以及您的业务限制是什么，因此无法发布合适的答案如何正确解决它。所以这里有几个链接显示（轻微）解决这个问题的不同方法：

*   [如何向 PrimeFaces p:graphicImage 显示服务器路径图像？](https://stackoverflow.com/questions/10844869/how-to-show-the-server-path-image-to-primefaces-pgraphicimage)
*   [在 Java Web 应用程序中从应用程序服务器外部提供静态数据的最简单方法](https://stackoverflow.com/questions/1812244/simplest-way-to-serve-static-data-from-outside-the-application-server-in-a-java)
*   [使用 <h:graphicImage> 或 <img> 标签从 webapps / webcontext / deploy 文件夹外部加载图像](https://stackoverflow.com/questions/4543936/load-the-image-from-outside-of-webcontext-in-jsf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-04T04:12:06.720

我的两分钱。使用图像 URL 可能会将您的目录结构暴露给任何有`firebug`或类似的人。因此，可能会发生许多不好的事情，如果我能提供帮助，我不喜欢使用与我的应用程序服务器的文件系统相关的文件路径。如果您的实现支持它，我建议您使用 primefaces 的[DynaImage从数据库中提供图像](http://www.primefaces.org/showcase-labs/ui/dynamicImage.jsf)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-03T22:09:47.453

解决方法很简单，照片的路径在netbeans项目的web文件夹下（Project\build\web\photo）

```
<h:panelGrid columns="1" width="50%" >
                    <p:graphicImage value="/photo/#{userController.photo}"/> 
  </h:panelGrid> 
```

在照片获取方法中我放了：

```
public String getPhoto() {

   ph =ejbPhoto.find(current.getIdPhoto()); 
   if(ph==null) return "noPhoto.png";
   System.out.println(ph.getPhotoName()); 
   current=null;
    return ph.getPhotoName();
} 
```

并且照片名称包含扩展名。

# forms - 垃圾邮件机器人会填写只有文件字段的表单吗？

> ID：12715700
> 
> 赞同：0
> 
> 时间：2012-10-03T19:43:58.047
> 
> 标签：forms, spam

我有一个*只有*一个文件字段的公共表单。垃圾邮件机器人也填写这种表格吗？我需要验证码吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:59:05.970

如果您允许不受限制的访问，是的。您需要显示验证码，并希望允许用户注册（注册也应由验证码强制执行）。

# css - 每个 ul 标签都需要特定的背景图片

> ID：12715713
> 
> 赞同：0
> 
> 时间：2012-10-03T19:44:53.300
> 
> 标签：css

这些天我正在学习CSS..

我正在使用嵌套的 ul li，您能告诉我如何为每个 Ul 实现相同的背景图像吗？下面是代码：

```
<ul class="display_BG_Blue_arw">
  <li>Coffee</li>
  <li>Tea
    <ul class="display_BG_Red_arw">
    <li>Black tea</li>
    <li>Green tea</li>
    </ul>
  </li>
  <li>Milk</li>
</ul> 
```

其中 class="display_BG_Blue" --> ul 标记的每个 li 都应将背景图像显示为蓝色箭头 &&

class="display_BG_Red_arw" --> ul 标记的每个 li 都应将背景图像显示为红色箭头

顺便说一句，我在哪里可以轻松找到这些东西的小尺寸背景图像..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:48:38.393

`li`根据父元素选择元素：

```
.display_BG_Blue_arw > li {
    background-image: url(/path/to/blue_arrow.png);
    background-repeat: no-repeat; /* or whatever... */
    background-position: 0 50%; /* or whatever... */
}

.display_BG_Red_arw > li {
    background-image: url(/path/to/red_arrow.png);
    background-repeat: no-repeat; /* or whatever... */
    background-position: 0 50%; /* or whatever... */
} 
```

组合器的使用`>`是指定只有那些`li`直接属于 的后代/子元素的元素`.display_BG_Red_arw`将使用红色箭头设置样式，以防止`li`嵌套`ul`/`ol`元素中的元素被设置为具有相同背景的样式。

参考：

*   [CSS（第 3 级）组合器，位于 W3.org](http://www.w3.org/TR/css3-selectors/#combinators)。
*   [CSS（第 3 级）选择器，位于 W3.org](http://www.w3.org/TR/css3-selectors/#selectors)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:00:43.237

```
ul.display_BG_Blue_arw > li{
  background-image: url(/path/to/blue_arrow.png);
  background-repeat: no-repeat; /* or whatever... */
  background-position: 0 50%; /* or whatever... */
}

ul > li ul.display_BG_Blue_arw li{
  background-image: url(/path/to/blue_arrow.png);
  background-repeat: no-repeat; /* or whatever... */
  background-position: 0 50%; /* or whatever... */
} 
```

或者

```
ul > li ul li{
  background-image: url(/path/to/blue_arrow.png);
  background-repeat: no-repeat; /* or whatever... */
  background-position: 0 50%; /* or whatever... */
} 
```

# php - 如何呈现我的 WHERE 条件以正确返回行？

> ID：12715714
> 
> 赞同：-1
> 
> 时间：2012-10-03T19:44:55.767
> 
> 标签：php, pdo

我正在努力找出为什么我的查询返回零行。我已经广泛尝试在[这个问题](https://stackoverflow.com/questions/12689103/why-does-my-query-with-named-parameters-return-a-blank-result)上解决这个问题，但没有得到体面的结果。

它的要点是：

```
 $mydate=date("Y-m-d",strtotime("-3 months"));

    $foo_query=$DBH->prepare("SELECT * FROM BarTable WHERE postdate = :postdate AND postdate > '$mydate' ORDER BY postdate DESC");
    $foo_query->execute( array('postdate' => $_REQUEST['postdate']) ); 
```

**编辑：这个查询应该说取日期，将其设置为过去三个月，并将其命名为 $mydate。然后从 BarTable 中取出 postdate 大于 $mydate 的所有字段，然后执行查询。**

刚刚有人向我指出，我所说的是我正在选择 postdate 等于 3 个月前并且大于`$mydate`.

我不明白我怎么这么说。`:postdate`不等于 3 个月前，因此`postdate = :postdate`不能选择 postdate 等于 3 个月前的行。

为了正确显示我的行，我之前输入了`WHERE postdate > '$mydate'`.

如何键入`postdate = :postdate AND postdate > '$mydate'`以便我使用参数并确保根据大于选择数据`$mydate`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:51:01.307

如果我理解正确（我完全不确定），你想要`OR`而不是`AND`：

```
$foo_query=$DBH->prepare("SELECT * FROM BarTable WHERE postdate = :postdate **OR** postdate > '$mydate' ORDER BY postdate DESC");
```

这样，您将同时获得 3 个月前的帖子和发布在`:postdate`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:51:19.667

您需要为`postdate`. 此外，要满足两个条件`postdate = :postdate and postdate > $mydate`，您需要`OR`在查询中使用。

```
$mydate=date("Y-m-d",strtotime("-3 months"));
$foo_query=$DBH->prepare("SELECT * FROM BarTable WHERE postdate = :postdate OR postdate > '$mydate' ORDER BY postdate DESC");
$foo->bindParam(':postdate', $_REQUEST['postdate'], PDO::PARAM_STR);
$foo_query->execute(); 
```

或与您在问题中提到的类似，您`:`在分配时错过了`:postdate`,

```
 $mydate=date("Y-m-d",strtotime("-3 months"));
 $foo_query=$DBH->prepare("SELECT * FROM BarTable WHERE postdate = :postdate OR postdate   '$mydate' ORDER BY postdate DESC");
 $foo_query->execute( array(':postdate' => $_REQUEST['postdate']) ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T20:16:36.503

如果你想做参数绑定，你可以试试这个，假设你的 postdate 是一个**日期字段**：

```
$foo_query=$DBH->prepare("
   SELECT * FROM BarTable 
   WHERE postdate = :postdate AND postdate > '$mydate' ORDER BY postdate DESC");
$foo_query->bindParam(':postdate', $_REQUEST['postdate'], PDO::PARAM_STR);
$foo_query->execute(); 
```

但是，如果您的 postdate 是**时间戳**，它应该如下所示：

```
$foo_query=$DBH->prepare("
   SELECT * FROM BarTable 
   WHERE postdate = :postdate AND postdate > '$mydate' ORDER BY postdate DESC");
$foo_query->bindParam(':postdate', $_REQUEST['postdate'], PDO::PARAM_INT);
$foo_query->execute(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T19:54:16.283

我推荐“之间”：

```
$foo_query=$DBH->prepare(
  "SELECT * FROM BarTable 
  WHERE postdate between ':somedate' AND '$mydate' 
  ORDER BY postdate DESC"); 
```

# jquery - 在 Firefox 中，'fadeIn' 不起作用

> ID：12715718
> 
> 赞同：0
> 
> 时间：2012-10-03T19:45:24.107
> 
> 标签：jquery

我有以下代码：

```
<style type="text/css">
body
{
    display:none;
}
</style>
<script type="text/javascript" src="jquery-1.8.1.js"></script>
<script type="text/javascript">
$(function(){
    $('body').fadeIn();
    //$('body').css("display","block");
});
</script>
<title>Insert title here</title>
</head>
<body>
    123456
</body>
</html> 
```

但是，fadeIn 不起作用，并且 $('body').css("display","block") 没有任何问题，有什么问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:55:48.527

我认为这与您将 HTML 正文的 css 设置为`display:none;`. 请参阅此示例，其中我只使用 div 而不是整个主体，它适用于 FF：http: [//jsfiddle.net/T3uX7/2/](http://jsfiddle.net/T3uX7/2/)。

您可以在尝试淡入淡出时看到相同的代码不起作用：http `<body>`: [//jsfiddle.net/T3uX7/4/](http://jsfiddle.net/T3uX7/4/)。

要让它工作，只需使用 a`div`来淡入，而不是整个身体。

# ios5 - iOS从https url下载tar文件

> ID：12715721
> 
> 赞同：0
> 
> 时间：2012-10-03T19:45:46.507
> 
> 标签：ios5, https, download, nsurlconnection

我正在尝试从 https url 下载文件。使用 http 可以正常工作，但对于 https 就不行了。我将在下面发布我当前的代码，但出于个人目的，我不想发布用于 URL 的 IP 地址，因此我将在其位置放置“ipAddress”。我应该提到 https 来自自签名证书。

```
-(void)downloadPDF: (NSInteger)numDay {

NSString *homeDir = NSHomeDirectory();

NSString *filePath = [NSString stringWithFormat: @"%@/%@%@%@", homeDir, @"Documents/", @"File", @".tar"];
NSString *dirPath = [NSString stringWithFormat: @"%@/%@", homeDir, @"Documents/"];
    NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"%@%@", @"ipAddress", @'File", @".tar"]];

NSData *urlData = [NSData dataWithContentsOfURL:url];
[urlData writeToFile:filePath atomically:YES];
[mywebview loadRequest:[NSURLRequest requestWithURL:[NSURL fileURLWithPath:filePath]]];

} 
```

我已经尝试了很多其他的东西，从使用 NSURLConnection 到下载整个库，但我一定错过了一些东西。我也有：

```
- (void)connection:(NSURLConnection *)connection willSendRequestForAuthenticationChallenge:(NSURLAuthenticationChallenge *)challenge{

} 
```

在我的应用程序委托 .m 文件中，如其他文件中所述。任何帮助将不胜感激，如果您需要更多信息，请在评论中告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:53:19.153

https 需要完全限定的域地址 (FQDA)。它不适用于IP。

# c# - SQL Server，C#，ntext，nvarchar，不等于怎么用

> ID：12715725
> 
> 赞同：1
> 
> 时间：2012-10-03T19:46:03.320
> 
> 标签：c#, sql-server

首先，我想说我知道这可以通过数据库中的列数据类型更改来解决，但这不是一种选择，因为数据库来自不受我控制的旧系统。

我想查询数据库并找到类似的内容：

```
where Field1<>@Field1Value Or Field2<>@Field2Value 
```

Where`Field1`和`Field2`are`nvarchar`和`ntext`列。

有没有办法用 SQL 做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:51:28.383

将 ntext 转换为 nvarchar：

```
cast(Field1 as nvarchar(max)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T22:11:44.370

`LIKE`是您要查找的运算符。

您可以使用以下方法简单地查询您的列：

```
where column2 NOT LIKE <value1> 
```

这将返回与其他列相同的结果`<>`。

顺便说一句，`ntext datatype`未来的 sql-server 版本将不再支持。

请参阅[已弃用的 MSDN ntext](http://msdn.microsoft.com/en-us/library/ms187993.aspx)

# android - 缩放时图像与其他图像重叠

> ID：12715727
> 
> 赞同：3
> 
> 时间：2012-10-03T19:46:15.093
> 
> 标签：android, imageview, android-linearlayout, image-scaling, overlapping

我以编程方式将 ImageView 元素添加到水平线性布局中。然后我在 ImageView 资源之一上将 scaleX 和 scaleY 属性设置为“2”。图像被正确缩放，但它不会移动其他 ImageView 元素，而不是与它们重叠。我不喜欢图像与其他图像重叠。我该如何解决？这是我的代码：

```
 int resources[] = {R.drawable.desert, R.drawable.koala, R.drawable.jellyfish,
                       R.drawable.lighthouse, R.drawable.desert};

    for(int i=0; i<5; i++) {
        ImageView logo = new ImageView(this);
        logo.setLayoutParams(new LinearLayout.LayoutParams(100, 75));
        logo.setImageResource(resources[i]);
        logosContainer.addView(logo);
    }

    ImageView middleImage = (ImageView) logosContainer.getChildAt(2);
    middleImage.setScaleX(middleImage.getScaleX() * 2);
    middleImage.setScaleY(middleImage.getScaleY() * 2); 
```

代码的结果如下所示：http: [//imageshack.us/a/img15/2811/scaleal.jpg](http://imageshack.us/a/img15/2811/scaleal.jpg)

您可以清楚地看到缩放后的图像与其他图像重叠。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:58:48.313

当您离开循环时，您的 ImageViews 已经被测量并放置在容器中。您必须刷新布局才能完成这项工作，这很[棘手](https://stackoverflow.com/questions/5991968/how-to-force-an-entire-layout-view-refresh%20doesn%27t%20work)，并且通常会导致“删除所有视图并再次添加它们”。那么为什么不在循环中进行“缩放”呢？

```
for(int i=0; i<5; i++) {
   ImageView logo = new ImageView(this);
   if(i==middleImageIndex){
      logo.setLayoutParams(new LinearLayout.LayoutParams(100*2, 75*2,1));
   } else {
      logo.setLayoutParams(new LinearLayout.LayoutParams(100, 75,1));
   }
   logo.setImageResource(resources[i]);
   logosContainer.addView(logo);
} 
```

最后一个参数 (100,75, **1** ) 是视图的[权重](http://developer.android.com/reference/android/widget/LinearLayout.LayoutParams.html#attr_android:layout_weight)，它确保每个 ImageView 同等重要且不会重叠。

另一个注意事项：setScale 需要 API 级别 11 或更高，这可能会减少[很多用户](http://developer.android.com/about/dashboards/index.html)

# c# - 在 varchar 列上使用 NULL 进行查询

> ID：12715729
> 
> 赞同：0
> 
> 时间：2012-10-03T19:46:38.223
> 
> 标签：c#, sql, sql-server, linq, linq-to-sql

如何将 null 作为值传递给从 linq 到 sql 的字符串（varchar）列？我正在尝试查询表，其中某些行的列（例如 Col_A）为 NULL，而其他行的值为“NotNull”（字符串）。

```
string s = null;

var query = (from r in context.Table1
            where r.Col_A == s
            select r).ToList(); 
```

这将返回 0 行。但是如果我将 s 设置为“NotNull”，我会按预期返回行。

任何指针都会有所帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T19:55:46.497

有一个烦人的错误，在某些情况下，以下可能会有所不同：

```
where x.Foo == null 
```

对比

```
where x.Foo == s 
```

`s`执行时碰巧在哪里`null`。基本上，在某些用例中，它最终可能会错误地使用：

```
WHERE [x].[Foo] = @p3 
```

有`@p3`一个`null`值，但显然这在符合 ANSI 的 SQL 中是不明智的。

我建议如果您正在测试参数值可能在哪里`null`，特例它并使用C# 中的***文字对查询进行编码。*** `null`我确实有一些代码可以使用表达式访问器来在事后应用这个，但是对于 special-case 来说更容易`null`。所以：

```
var query = // some core query

if(s == null) { query = query.Where(x => x.Foo == null); }
else { query = query.Where(x => x.Foo == s); } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:48:51.247

你试过 DBNull.Value 吗？那是 .net 的 DB 相当于 null。

# permissions - 如何为规范文件中的所有目录和所有文件提供特定模式？

> ID：12715730
> 
> 赞同：-1
> 
> 时间：2012-10-03T19:46:44.637
> 
> 标签：permissions, installation, rpm

我不能依赖 umask，因为我的机器不使用 umask 来设置权限。有没有办法指定某个根目录的所有子目录（及其子目录等）都具有一定的权限，同样，同一根目录的所有子文件在 %规范文件的文件部分。

如果没有，我将不得不运行一些外部 bash 脚本来获取每个单独文件的规范文件语法，并将该输出复制到规范文件的 %files 部分，这将非常乏味。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T22:51:26.833

如果您查看[在线的各种参考资料](http://www.rpm.org/max-rpm-snapshot/s1-rpm-specref-files-list-directives.html)，`%defattr()`则使用鲜为人知的第四个目录参数。

# ajax - jsf 1.2 中的 ajax 行为

> ID：12715731
> 
> 赞同：1
> 
> 时间：2012-10-03T19:46:48.953
> 
> 标签：ajax, jsf, jsf-1.2

我有一个 selectonlistbox，我想在每次进行/更改选择框选择时重新加载一个面板网格。我尝试只使用 jsf 1.2。

我知道使用 a4j 或 faces 2 可以轻松完成，但如果有人知道在 jsf 1.2 中实现这一目标的任何好方法，我将不胜感激。

一个简单的例子也会有很大帮助。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T20:07:36.657

您基本上需要创建一个自定义 Ajax 感知[`ViewHandler`](http://docs.oracle.com/javaee/5/api/javax/faces/application/ViewHandler.html)以及一个自定义 XML[`ResponseWriter`](http://docs.oracle.com/javaee/5/api/javax/faces/context/ResponseWriter.html)和[自定义标记](http://docs.oracle.com/javaee/5/tutorial/doc/bnalj.html)，它们生成所需的 JavaScript 代码来执行`XMLHttpRequest`工作和 HTML DOM 操作。这也是大多数第 3 方 JSF 1.x 组件库所做的。它们都是开源的，所以你可以看看它的源代码，通过例子来学习他们是如何做到的。毕竟这是一个初学者，但不是一项简单的工作，因为它需要深入了解 HTTP、HTML DOM、JavaScript 和 XMLHttpRequest 的工作原理。很快就会犯一个小错误，初学者需要很长时间才能找到并真正理解它。

您最好的选择实际上是为 JSF 1.2 采用支持 ajax 的组件库（例如，包含 Ajax4jsf的[RichFaces 3.x ），或者只是](http://jboss.org/richfaces)[迁移到 JSF 2.0](https://stackoverflow.com/questions/4441713/migrating-from-jsf-1-2-to-jsf-2-0/4532870#4532870)（JSF 1.2 已经超过 6 年了，而 JSF 2.0 是在将近 3 年前引入的已经；JSF 1.x 基本上是历史）。

然而，这个特殊的功能需求也可以在没有 ajax 的情况下完成，尽管有点笨拙，当然如果表单验证起作用的话。这是一个基本的启动示例，只需指示 JavaScript 在下拉列表更改时提交父表单：

```
<h:form>
    <h:selectOneMenu value="#{bean.selected}" onchange="this.form.submit()">
        <f:selectItem itemValue="one" />
        <f:selectItem itemValue="two" />
        <f:selectItem itemValue="three" />
    </h:selectOneMenu>
    <h:panelGroup rendered="#{bean.selected == 'one'}">
        One was selected.
    </h:panelGroup>
    <h:panelGroup rendered="#{bean.selected == 'two'}">
        Two was selected.
    </h:panelGroup>
    <h:panelGroup rendered="#{bean.selected == 'three'}">
        Trree was selected.
    </h:panelGroup>
</h:form> 
```

这将在下拉列表更改时同步提交整个表单，就像您按下提交按钮一样。但是，如前所述，如果您在同一个表单的其他地方执行验证，则必须引入相当多的技巧`immediate="true"`并`valueChangeListener`阻止对所有其他表单元素的验证。有关一些详细示例，另请参阅[填充子菜单](http://balusc.blogspot.com/2007/10/populate-child-menus.html)。

一个完全不同的替代方案是仅将*所有内容*呈现到 HTML 响应并使用 CSS 将其隐藏`display:none`，然后在属性`element.style.display`中引用的某些 JS 函数中使用 JavaScript 切换显示。`onchange`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-14T15:45:21.623

我认为更好的选择是迁移到 JSF 2。如果您想使用 JSF 1.2 进行此操作，请使用一些 JS 库（例如 JQuery 或原型）并在事件上调用您的 JS 函数并使用带有面板网格的模板页面的 URL 调用 AJAX 更新程序和逻辑（例如：/mypanaelGrid.jsf）。

# ruby-on-rails - Textmate 无法识别 rails 项目中的咖啡脚本？

> ID：12715733
> 
> 赞同：0
> 
> 时间：2012-10-03T19:46:56.757
> 
> 标签：ruby-on-rails, coffeescript, textmate

出于某种原因，我的 js.coffee 文件无法识别咖啡脚本？在底部页脚格式显示纯文本。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:50:25.997

安装在这里找到的咖啡脚本包：

[https://github.com/jashkenas/coffee-script-tmbundle](https://github.com/jashkenas/coffee-script-tmbundle)

# asp.net - 使用 VS2010 创建显示记录详细信息的报告

> ID：12715734
> 
> 赞同：0
> 
> 时间：2012-10-03T19:47:07.190
> 
> 标签：asp.net, reporting-services, rdlc

有没有办法我可以设计一个报告（使用 VS2010，ASP.Net），它将按以下格式列出客户：

ID：1
名称：Joe Bloggs
地址：地址 1
城市
ZIP
State1

ID：2
姓名：Steve Brown
地址：地址 2
City2
ZIP2
State2
...

我可以有这样的格式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T03:44:45.133

是的，用于`List`遍历每条记录并为每个员工添加项目模板。在您的情况下，您应该按 EmplyeeID 字段对列表进行分组，这将使每个`ListItem`显示一个员工的单个记录。

在列表中放置：每个字段有 5 个标签，例如 ID、名称等。在每个标签旁边放置一个文本框并将其附加到列表元素提供的 DataSet 字段。

这是一个示例：[使用列表 - MSDN](http://msdn.microsoft.com/en-us/library/ee224216%28v=sql.105%29.aspx)

# c# - 使用 LINQ to XML 查询带有前缀命名空间的 xml 子元素

> ID：12715738
> 
> 赞同：4
> 
> 时间：2012-10-03T19:47:11.183
> 
> 标签：c#, linq, linq-to-xml, xelement

所以我有一些通常看起来像这样的 XML

```
<wd:Data xmlns:wd="urn:com.foo.bar/GetResult">
    <wd:Result>
        <wd:field1>lorem</wd:field1>
        <wd:field2>ipsum</wd:field2>
        <wd:field3>dolor</wd:field3>
        <wd:field4>sit</wd:field4>
    </wd:Result>
</wd:Data> 
```

命名空间以“wd”为前缀

我希望能够获取其中的每个元素`<wd:Result>...</wd:Result>`并创建一个新元素`KeyValuePair<string, string>`，其中键是元素名称，值是元素的值，如下所示：

{"field1", "lorem"} {"field2", "ipsum"} {"field3", "dolor"} {"field4", "sit"}

我的斗争是命名空间前缀。我是 LINQ 的新手，但我总是能够得到这样的东西来处理这样的代码：

```
var data = XElement.Parse(theXml); 
XNamespace ns = "urn:com.foo.bar/GetResults"; 
var result = data.Elements(ns + "Result")
                 .Select(x => new KeyValuePair<string, string>(x.Name.LocalName, x.Value))
                 .ToList(); 
```

我应该如何查询这些数据以产生所需的结果？

我没有与 LINQ 结婚，所以无论社区感觉如何，我都可以接受。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-03T20:51:00.980

事实证明，我需要将 Descendants() 与 Elements() 结合起来

以下代码完全符合我的要求：

```
 var data = XElement.Parse(theXml);  
    XNamespace ns = "urn:com.foo.bar/GetResults";  
    var result = data.Descendants(ns + "Result")
                     .Elements()
                     .Select(x => new KeyValuePair<string, string>(x.Name.LocalName, x.Value))
                     .ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T20:38:19.413

好的，这不是一个完整的解决方案，但我认为您应该了解在 XML 中使用命名空间和使用 LINQ 读取数据的基本概念

以免说您已经将 XML 加载到内存中，这就是您如何访问它的方法

```
XDocument inventory = XDocument.Load("path_to_your_file.xml");

XNamespace vs = "urn:com.foo.bar/GetResult";
var names = doc.Descendants(vs + "Result")
           .Select(x => (string) x)
           .ToList(); 
```

这不是您 XML 结构的确切实现，但我认为您知道如何使用命名空间

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-04T19:15:33.803

您还可以使用 localname 属性并执行类似的操作

```
var names  = from n in xdoc.Descendants() where n.Name.LocalName == "Result" select n; 
```

# sql - Sql 选择联合计数

> ID：12715741
> 
> 赞同：0
> 
> 时间：2012-10-03T19:47:34.870
> 
> 标签：sql, sql-server

我有一个存储过程，它返回带有一堆联合的行。我要做的是查看 select 语句是否不产生任何行，如果是，则执行另一个脚本。

这是我在存储过程中使用的当前 sql 选择。请让我知道如何实现这一目标。

```
SELECT  name AS [Name],  address1 AS Address1, address2 AS Address2, city AS City,  1 AS DeliveryTypeKey, email AS Email,  
  ( SELECT TOP 1   c_phone_number   
    FROM phone WITH (NOLOCK)  
    WHERE value = @value) AS Fax 
    FROM #Cities x    
 INNER JOIN prov p WITH (NOLOCK) ON x.ckey = p.pkey  
 UNION 
SELECT  name AS [Name], address1 AS Address1, address2 AS Address2, city AS City,  1 AS DeliveryTypeKey, email AS Email,  
  ( SELECT TOP 1 c_phone_number   
    FROM phone WITH (NOLOCK)  
    WHERE value = @value) AS Fax 
    FROM #Cities1 x    
    INNER JOIN prov1 p WITH (NOLOCK) ON x.ckey = p.pkey  
 UNION 
 SELECT  name AS [Name], address1 AS Address1, address2 AS Address2, city AS City,  1 AS DeliveryTypeKey, email AS Email,  
  ( SELECT TOP 1 c_phone_number   
    FROM phone WITH (NOLOCK)  
    WHERE value = @value) AS Fax 
 FROM #Cities2 x    
 INNER JOIN prov2 p WITH (NOLOCK) ON x.ckey = p.pkey 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T10:43:51.577

使用 ROWCOUNT 函数检查是否返回了任何行：

```
DECLARE @table TABLE 
  ( 
     DATA INT 
  ) 

INSERT @table 
VALUES (0) 

SELECT * 
FROM   @table 
WHERE  DATA > 0 

IF @@ROWCOUNT = 0 
  SELECT 'run' 
ELSE 
  SELECT 'Don''t run' 
```

# javascript - 使用 JQuery 读取 XML 文件并将 XML 属性写入网页上的一系列 HTML 元素

> ID：12715743
> 
> 赞同：3
> 
> 时间：2012-10-03T19:47:36.550
> 
> 标签：javascript, jquery, xml, xml-parsing, attr

我在一个页面上有一个图像滑块，它读取一个名为“slider.xml”的 XML 文件，看起来像这样：

```
<slider>
<slide>
<link>http://www.example.com/1</link>
<path>http://image.jpg</path>
</slide>
</slider> 
```

有多个“幻灯片”元素，但出于空间原因我没有包括它们。我有一些看起来像这样的 HTML：

```
<body>
<div class="slide"></div>
<div class="slide"></div>
<div class="slide"></div>
<div class="slide"></div>
<div class="slide"></div>
</body> 
```

我想读取这个 XML 文件并将“链接”属性写入 HTML 页面上的“div”元素作为标题属性。我希望它看起来像这样：

```
<body>
<div class="slide" title="http://www.example.com/1"></div>
<div class="slide" title="http://www.example.com/2"></div>
<div class="slide" title="http://www.example.com/3"></div>
<div class="slide" title="http://www.example.com/4"></div>
<div class="slide" title="http://www.example.com/5"></div>
</body> 
```

到目前为止，我已经尝试过了，但没有任何运气：

```
$(document).ready(function () {
    $.ajax({
        type: "GET",
        url: "slider.xml",
        dataType: "xml",
        success: function(xml) {
            $(xml).find('slide').each(function(){
                var url = $(this).find('link').text();
                $('.slide').attr('title', url);
            }); 
        }   
    }); 
}); 
```

我在读取 XML 文件时没有问题，但是在解析 XML 属性并将其附加到各种 div 后遇到了问题。我应该创建一个循环并将 xml 属性存储在一个数组中吗？有一个更好的方法吗？

此外，我无法编辑 XML 或 HTML。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:13:49.430

你所有的 div 都将具有相同的标题，因为你调用`$('.slide')`which 将它们全部选中。

这应该有效：

```
$(document).ready(function () {
    var slide = $('.slide');
    $.ajax({
        type: "GET",
        url: "slider.xml",
        dataType: "xml",
        success: function(xml) {
            $(xml).find('slide').each(function(i){
                var url = $(this).find('link').text();
                slide.eq(i).attr('title', url);
            }); 
        }   
    }); 
}); 
```

# c# - 带有标题文本框的 AJAXFileUpload

> ID：12715749
> 
> 赞同：4
> 
> 时间：2012-10-03T19:47:58.670
> 
> 标签：c#, ajaxcontroltoolkit, asyncfileupload

非常坦率的。我只是在寻找能够在上传之前为文件添加标题的用户。（是的，我鼓励使用正确的文件名，但这不是重点。）

```
<asp:TextBox runat="server" ID="txtDocumentTitle" />
<ajaxToolkit:AjaxFileUpload runat="server" ID="ajxUploadNDA" OnUploadComplete="ajxUpload_Complete" Width="400px"   /><br />

    protected void ajxUpload_Complete(object sender, AjaxControlToolkit.AjaxFileUploadEventArgs e)
    {
        MyFile f = new MyFile();
        f.DocumentType = e.ContentType;
        f.FileBytes = e.GetContents();
        f.FileName = e.FileName;
        f.DocumentCategory = "Package Files";
        f.FileUploaded = DateTime.Now;
        f.DocumentTitle = txtDocumentTitle.Text;
        f.Save();

        DataBind();
    } 
```

但是，在设置断点时，txtDocumentTitle.Text 始终为空白。我似乎无法强制进行完整的回发或找到任何其他方式来获取该文本框的当前值。我可以允许用户在文件上传*后*编辑这些属性，但这不是我喜欢的设计，原因有几个。（它鼓励将值保留为默认值。）

我试过了：

```
 protected void Page_Init(object sender, EventArgs e)
    {
        ScriptManager.GetCurrent(Page).RegisterPostBackControl(ajxUploadNDA);
        ScriptManager.GetCurrent(Page).SupportsPartialRendering = false;
        ScriptManager.GetCurrent(Page).EnablePartialRendering = false;

    } 
```

我试过了

```
<ajaxToolkit:AjaxFileUpload runat="server" ID="ajxUploadNDA" OnUploadComplete="ajxUpload_Complete" Width="400px" onchange="if (confirm('Upload ' + this.value + '?')) this.form.submit();"  /> 
```

任何建议都会受到欢迎。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T00:15:37.130

I've sort of solved it by adding a button to "Set Document Title" which adds the value of the textbox to session. The ajxUpload_Complete function then uses this Session variable to set the title to that session value on upload.

It's sloppy for a couple reasons, but it's the best I could do.

On Page_Load:

```
if (!Page.IsPostBack && !ajxUploadNDA.IsInFileUploadPostBack)
{
  Session.Remove("DefaultDocumentCategory");
  lblDocumentCategory.Text = "Data Package Files";
  Session.Remove("DefaultDocumentTitle");
  lblDocumentTitle.Text = "Data Package File";
}

protected void btnChangeDocumentAttributes_Click(object sender, EventArgs e)
{
    lblDocumentCategory.Text = cboDocumentCategory.SelectedValue;
    lblDocumentTitle.Text = txtDocumentTitle.Text;
    Session["DefaultDocumentCategory"] = lblDocumentCategory.Text;
    Session["DefaultDocumentTitle"] = lblDocumentTitle.Text;
} 
```

I also added a dummy button to the page to force a postback refreshing my gridview that shows all the files uploaded.

```
<asp:Button ID="btnForcePostBack" runat="server" Text="" Style="background-color: Transparent; color: inherit; border-style: none;" />

protected void ajxUpload_Complete(object sender, AjaxControlToolkit.AjaxFileUploadEventArgs e)
{

    MyFile f = new MyFile();
    f.DocumentType = e.ContentType;
    f.FileBytes = e.GetContents();
    f.FileName = e.FileName;
    f.FileUploaded = DateTime.Now;

    if (Session["DefaultDocumentCategory"] == null || Session["DefaultDocumentCategory"].ToString() == string.Empty) f.DocumentCategory = "Data Package Files";
    else f.DocumentCategory = Session["DefaultDocumentCategory"].ToString();
    if (Session["DefaultDocumentTitle"] == null || Session["DefaultDocumentTitle"].ToString() == string.Empty) f.DocumentTitle = "Data Package File";
    else f.DocumentTitle = Session["DefaultDocumentTitle"].ToString();
    f.Save();
    ajxUploadNDA.Page.ClientScript.RegisterStartupScript(this.GetType(), "RefreshParent", "<script type='text/javascript'>var btn = window.parent.document.getElementById('btnForcePostBack');if (btn) btn.click();</script>");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-04T17:16:58.753

我无法得到任何其他答案。我最终将文本框放在了 ajax 更新面板上。然后我为文本框 OnTextboxChanged 创建了一个事件，该事件将值存储在会话中。然后我可以直接从会话中获取 UploadComplete 中的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T20:33:49.073

使用 ajax 上传时，您只能立即保存，然后第二步是单独调用从保存的位置获取文件并对其进行操作。我在使用 Uploadify 和 Uploadifive 进行多次异步上传时遇到了同样的问题。上传多个文件时，我的第一步是保存到临时位置，然后进行第二次调用以检索它、调整大小并将其保存到云（Azure 存储）。不可能设置断点，因为线程到处都是。这是一种奇怪的行为，特别是在上传单个文件时，但这是首先保存然后使用单独调用检索的最佳解决方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-08T08:50:14.200

问题是 AjaxFleUpload 控件使用隐藏框架来提交文件内容。您可以使用下面的脚本将文本框值传递给服务器：

```
Sys.Application.add_load(applicationLoadHandler);

function applicationLoadHandler() {
     var originalCreateForm = Sys.Extended.UI.AjaxFileUpload.prototype._createVForm;

     Sys.Extended.UI.AjaxFileUpload.prototype._createVForm = function () {
          originalCreateForm.call(this);

          var textBox = document.createElement("INPUT");
          textBox.setAttribute("type", "text");
          textBox.setAttribute("name", "<%= txtDocumentTitle.UniqueID %>");
          textBox.setAttribute("value", document.getElementById("<%= txtDocumentTitle.ClientID %>").value);

          this._vForm.appendChild(textBox);
     }
} 
```

`Request.Form`在服务器上，您可以从集合中获取用户输入：

```
var title = Request.Form[txtDocumentTitle.UniqueID]; 
```

# python - Python sum() 返回负值，因为总和对于 32 位整数来说太大了

> ID：12715750
> 
> 赞同：3
> 
> 时间：2012-10-03T19:48:10.560
> 
> 标签：python, integer, long-integer

```
x = [1, 2, 3, ... ]
y = sum(x) 
```

和`x`是2165496761，大于32位整数的限制所以`sum(x)`返回-2129470535。

如何通过将其转换为长整数来获得正确的值？

这是我的进口清单：

```
import math, csv, sys, re, time, datetime, pickle, os, gzip
from numpy import * 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-03T19:51:56.720

二十个 quatloos 说你正在使用`numpy`的 sum 函数：

```
>>> sum(xrange(10**7))
49999995000000L
>>> from numpy import sum
>>> sum(xrange(10**7))
-2014260032 
```

所以我敢打赌你已经`from numpy import *`或正在使用一些等效的界面。

要验证这一点，请尝试

```
print type(sum(x)) 
```

在此线程其他地方发布的示例中：

```
>>> sum([721832253, 721832254, 721832254])
-2129470535
>>> type(sum([721832253, 721832254, 721832254]))
<type 'numpy.int32'> 
```

编辑：有人欠我二十四分钱！要么不使用星形导入（最好），手动设置`dtype`：

```
>>> sum([721832253, 721832254, 721832254],dtype=object)
2165496761L 
```

或显式引用内置`sum`函数（可能给它一个更方便的绑定）：

```
>>> __builtins__.sum([721832253, 721832254, 721832254])
2165496761L 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T20:49:53.753

您获得此无效值的原因是您正在`np.sum`使用`int32`. 没有什么可以阻止您**不**使用 a`np.int32`而是 a `np.int64`or`np.int128` `dtype`来表示您的数据。例如，您可以使用

```
x.view(np.int64).sum() 
```

在旁注中，请确保您**从不**使用`from numpy import *`. 这是一种可怕的做法，你必须尽快改掉这种习惯。当您使用 时`from ... import *`，您可能会覆盖一些 Python 内置函数，这使得调试变得非常困难。典型的例子，你覆盖像`sum`or `max`...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T19:50:24.767

Python 以任意精度处理大量数字：

```
>>> sum([721832253, 721832254, 721832254])
2165496761 
```

总结一下吧！

为确保您不使用`numpy.sum`，请尝试使用`__builtins__.sum()`。

# nuget - NuGet - 大型企业系统上的新手问题

> ID：12715753
> 
> 赞同：0
> 
> 时间：2012-10-03T19:48:36.600
> 
> 标签：nuget, nuget-package

我刚刚继承了一个似乎使用 NuGet 的大型企业系统。

我刚刚阅读了有关 NuGet 的基础知识，所以请原谅我的问题的简单性。

有没有办法告诉 NuGet 更新和安装运行系统所需的所有包？我现在正在运行并查看失败的原因，然后猜测缺少哪些 NuGet 包。

（不，企业系统中没有文档或者很多代码注释，呃）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:52:06.843

从包管理器控制台尝试 Update-Package –Project ProjectName

Visual Studio -> 工具 -> 库包管理器 -> 包管理器控制台

[http://nuget.codeplex.com/wikipage?title=Updating%20All%20Packages](http://nuget.codeplex.com/wikipage?title=Updating%20All%20Packages)

如果解决方案配置为启用 Nuget 包还原，您也可以删除包文件夹并重建所有这些将获得所需的一切。如果您需要担心 javascript、配置等...我会尝试 Update-Package 路线

# php - 如何使用数组和条件获取表值

> ID：12715757
> 
> 赞同：0
> 
> 时间：2012-10-03T19:48:50.780
> 
> 标签：php, mysql, codeigniter, codeigniter-datamapper

我正在学习并决定制作一个带有后端和前端的 CodeIgniter 应用程序以用于学习目的，我遇到了以下疑问。您想从数据库中的一个表中获取所有数据并放入一个数组中，然后当第 1 列的值等于我确定的值时，我想在第 2 列中显示数据。

为了更好地说明我将举一个例子，请看下表。

```
ID      Option              Value
1       site_name           Test
2       site_description    Example of description site.
3       site_url            http://www.example.com
4       site_author         John Doe
5       site_lang           en 
```

现在假设我想在标签内的页面上显示此数据，例如我将使用“site_name”，对于网站的描述将是“site_description”等等。最好的方法是什么？

PS：我正在使用一个ORM Datamapper这个应用程序，有什么方法可以简化使用它的操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T03:39:58.700

你的问题很不清楚 - 如果我解释正确，并且如果你使用[Datamapper ORM](http://datamapper.wanwizard.eu/index.html)，你会这样做：

## 您的控制器 - `controllers/sites.php`：

```
<?php
class Sites extends CI_Controller{
    function __construct(){
        parent::__construct();
    }

    function get($id){
        $s = new Site($id);
        $data['site'] = $s->to_array();
        $this->load->view('sites', $data);
    }
} 
```

## 您的模型 - site.php：

```
<?php
class Site extends Datamapper{
    function __construct($id){
        parent::__construct($id);
    } 
} 
```

默认情况下，Datamapper ORM 不支持该`to_array()`方法，您必须启用它。进入`config/datamapper.php`并将最后一个`'extensions'`数组元素修改为：`$config['extensions'] = array('array');`

## 最后，在您看来 - `views/sites.php`：

```
<table>
    <thead>
        <tr>
            <th>ID</th>
            <th>Option</th>
            <th>Value</th>
        </tr>
    </thead>
    <tbody>
        <? foreach($sites as $sK => $sV):?>
            <tr>
                <td><?= $sV['id'];?></td>
                <td><?= $sV['option'];?></td>
                <td><?= $sV['value']?></td>
            </tr>
        <? endforeach;?>
    </tbody>
</table> 
```

然后`http://localhost/yourapp/sites/get/<id>`输入你的浏览器，`<id>`在你的数据库中实际上是一些合适的ID。

## 发表评论后编辑：

如果这些是站点范围的全局变量，我建议不要将它们存储在数据库中。调用数据库来获取这些信息是没有意义的。只需将其嵌入到您的 PHP 中即可。`define()`我这样做的方法是在我的前端`index.php`文件的顶部调用：

```
define('TITLE', "Some Title");
define('DEVELOPER', "Your Name");
define('DEVELOPER_EMAIL', 'youremail@example.com'); 
```

然后，这些将在您的应用程序中的任何位置为您提供。`<?= TITLE; ?>`例如，简单地调用将回显“Some Title”。

您也可以考虑使用`config/constants.php`.

# c++ - 我应该如何遍历 C++11 中的枚举类？

> ID：12715759
> 
> 赞同：8
> 
> 时间：2012-10-03T19:49:01.433
> 
> 标签：c++, enums, c++11

我应该如何遍历 C++11 中的枚举类？我希望我仍然不必添加 END 的最终枚举值，但我也无法使基于范围的循环工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T20:20:06.903

如果您确实需要遍历枚举类并且想要避免添加特殊的 END 符号，则可以为此目的定义自己的特征。

```
template<typename E> struct EnumTraits;

enum class E { V1, V2, V3 };
enum class F { X1, X2, X3 };

template<> struct EnumTraits<E> { static constexpr E LAST = E::V3; };
template<> struct EnumTraits<F> { static constexpr F LAST = F::X3; }; 
```

然后你可以写例如：

```
EnumTraits<E>::LAST 
```

获得 E 的“最终”值。当然，您仍然需要在此类上定义算术运算。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-15T19:26:33.240

您可以像这样进行处理器破解：

```
#define E_INITIALIZER_LIST { E1, E2, E3, E4 }

enum E E_INITIALIZER_LIST;
constexpr E ALL_VALUES_OF_E[] E_INITIALIZER_LIST; 
```

# php - 根据自定义字段名称按作者显示帖子

> ID：12715763
> 
> 赞同：0
> 
> 时间：2012-10-03T19:49:13.003
> 
> 标签：php, wordpress

我正在尝试显示作者的帖子的帖子标题 URL。

我需要在 2 个地方显示这个

1）仪表板（只有登录用户才能看到）

2) 公开资料页面上的公开信息

///

**1) 仪表板**

所以用户将被记录到仪表板，所以我想我可以根据当前用户 ID 获取 Post URL 并在页面上回显它？

我可以弄清楚如何获取当前用户 ID

```
get_currentuserinfo();
$userID = $current_user->ID; 
```

但不确定如何从那里获取/回显帖子标题。

**2）公共信息** 所以这将在公共个人资料页面中。我想显示我们正在查看的作者个人资料页面的帖子 URL。

在此配置文件模板上，我已经像这样显示用户名

```
<?php 
echo get_queried_object()->display_name;
 ?> 
```

所以我想我可以根据这个显示名称或我可以查询的其他对象以某种方式获取帖子 URL？

2个单独的问题，但在如何显示此信息方面寻求一些帮助。

干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T22:52:44.333

听起来你想使用`get_author_posts_url($userID)`.

这将带您进入（默认情况下）`site.com/author/author-nicename/`并使用 author.php 模板，它将显示该作者的帖子。

你需要回显这个值，顺便说一句，像这样：

```
<a href="<?php echo get_author_posts_url($userID); ?>"><?php echo $display_name; ?></a> 
```

# sql-server - TSQL 自连接获取结果

> ID：12715765
> 
> 赞同：0
> 
> 时间：2012-10-03T19:49:23.963
> 
> 标签：sql-server, tsql

我运行以下查询

```
Select * From
(
Select 
    GUID,
    MFG_CODE,
    STK_NAME,
    parentid,
    masteritem,
    ROW_NUMBER() over(order by guid) r
 From Fstock Where MasterItem=1 OR isNull(parentID, '')=''
 ) a
 Where r between 4716 And 4716 
```

我得到以下结果

```
GUID    MFG_CODE    parentid    masteritem  r
31955   369553         0            1       4717 
```

如您所见`GUID 31955`，实际上是`parentITEM`& 我需要在同一个查询中引入该父项的所有子项。

例如，如果我这样做：

```
Select * From Fstock where parentID = 31955 
```

它返回它的 3 个孩子

```
GUID
31956
31957
31958 
```

那么有没有办法将这两个查询组合在一起，我只想使用`row_number()`函数返回固定数量的行，但是那些返回的行有时包含 a `Parent ITem`，我想在同一个查询中返回这些父项的子项。

性能对我来说非常重要。

--- 编辑 ---- 我让它与以下查询一起工作，有人有其他想法吗？

```
With CTE

As
(

Select 
    GUID,
    Manufacturer,
    SELL_PRICE,
    MFG_CODE,
    parentid,
    masteritem,
    ROW_NUMBER() over(order by GUID) r
 From Fstock Where MasterItem=1 OR isNull(parentID, '')=''

 ) 

Select A.*,F.parentID From
(
 Select * From CTE
 Where r between 4717 And 6000  
) A
 Left join Fstock F on F.parentID = A.GUID
 Order by A.r 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:01:24.723

这是粗略且未经测试的，但我相信您正在寻找一个递归公用表表达式 (CTE)，它将为您组合父子关系。现在，从本质上讲，这并没有集成您在返回“固定行数”方面提到的任何行限制，我不确定如何解释，但下面的基本查询应该是您的开始。

```
With Products(GUID, MFG_CODE,STK_NAME, parentid,masteritem)
as
(
    Select GUID,MFG_CODE,STK_NAME,parentid,masteritem
      from fstock
     where masteritem=1 OR isNull(parentID, '')=''
    Union all
    Select f.GUID,f.MFG_CODE,f.STK_NAME,f.parentid,f.masteritem
      from fstock f
      inner join products g
         on f.parentid=g.guid
) 
```

# python - Scrapy Spider 返回 None 而不是 Item

> ID：12715771
> 
> 赞同：5
> 
> 时间：2012-10-03T19:49:50.590
> 
> 标签：python, python-2.7, web-scraping, scrapy

**我在下面找到了答案。简而言之，ItemPipeline 中的错误缩进导致它返回 None。**

我一直在尝试在 Scrapy 中编写 CrawlSpider，之前从未使用过 python。Spider爬取，调用回调函数，提取数据并填充项目，但它总是返回None。我已经通过打印文章调用对其进行了测试，一切正常。我已经尝试过使用 yield 和 return （尽管我仍然不明白其中的区别）。坦率地说，我没有想法。下面是回调函数。//edit 也添加了蜘蛛代码

```
class ZeitSpider(CrawlSpider):
name= xxxx
allowed_domains = ['example.com']
start_urls = ['http://www.example.com/%d/%d' %(JAHR,39)]
rules = (Rule(SgmlLinkExtractor(restrict_xpaths=('//ul[@class="teaserlist"]/li[@class="archiveteaser"]/h4[@class="title"]')),callback='parse_url',follow=True),)

    def parse_url(self,response):
        hxs = HtmlXPathSelector(response)

        article = Article()

        article['url']= response.url.encode('UTF-8',errors='strict')

        article['author']= hxs.select('//div[@id="informatives"]/ul[@class="tools"]/li[@class="author first"]/text()').extract().pop().encode('UTF-8',errors='strict')
        article['title']= hxs.select('//div[@class="articleheader"]/h1/span[@class="title"]/text()').extract().pop().encode('UTF-8',errors='strict')

        article['text']= hxs.select('//div[@id="main"]/p/text()').extract().pop().encode('UTF-8',errors='strict')

        article['excerpt'] = hxs.select('//p[@class="excerpt"]/text()').extract().pop().encode('UTF-8',errors='strict')
        yield article 
```

和项目定义

```
class Article(Item):
    url=Field()
    author=Field()
    text=Field()
    title=Field()
    excerpt=Field() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-04T07:11:21.010

好的，在使用 pdb 单步执行程序后，我发现了错误：

因为我有多个蜘蛛，我想写多个 ItemPipelines。为了让它们根据蜘蛛区分，我添加了一个

```
if spider.name=='SpiderName'
    return item 
```

注意缩进。管道没有返回任何内容，因此输出变为无。

更改缩进后，蜘蛛完美无瑕地工作。PEBCAC 的另一个例子。

# python - Pip 版本的边缘

> ID：12715772
> 
> 赞同：1
> 
> 时间：2012-10-03T19:49:53.600
> 
> 标签：python, macos, pip

我基本上与 Python 2.7 中描述的情况完全相同
[，系统、PIP 和 Virtualenv 仍在使用 2.6 - 如何将它们切换为使用 2.7](https://stackoverflow.com/q/10055260/165673)

也就是说，我的 mac 默认使用 Python 2.7，而 Pip 安装到 2.6

我按照[Ned Deily 的回答](https://stackoverflow.com/a/10055615/165673)，用我的默认 Python 安装了 easy_install，并用它来安装 Pip。

**现在我得到：**

```
$ which easy_install
/Library/Frameworks/Python.framework/Versions/2.7/bin/easy_install  
$ which pip
/Library/Frameworks/Python.framework/Versions/2.7/bin/pip 
```

**好吧，看起来不错。但是，我也得到了这个：**

```
$ pip --version
pip 1.0.2 from /Library/Python/2.6/site-packages/pip-1.0.2-py2.6.egg (python 2.6) 
```

并且 Pip*仍在*安装到 2.6。

我错过了什么？

* * *

**更新**：

也许这是一个线索 - 我刚刚运行了以下内容：

```
$ ls -la /usr/bin/python*  
-rwxr-xr-x  2 root  wheel  86000 May  4  2011 /usr/bin/python  
-rwxr-xr-x  5 root  wheel    925 May  4  2011 /usr/bin/python-config  lrwxr-xr-x  1 root  wheel     75 May  4  2011 /usr/bin/python2.5 ->
../../System/Library/Frameworks/Python.framework/Versions/2.5/bin/python2.5
lrwxr-xr-x  1 root  wheel     82 May  4  2011
/usr/bin/python2.5-config ->
../../System/Library/Frameworks/Python.framework/Versions/2.5/bin/python2.5-config
lrwxr-xr-x  1 root  wheel     75 May  4  2011 /usr/bin/python2.6 ->
../../System/Library/Frameworks/Python.framework/Versions/2.6/bin/python2.6
lrwxr-xr-x  1 root  wheel     82 May  4  2011
/usr/bin/python2.6-config ->
../../System/Library/Frameworks/Python.framework/Versions/2.6/bin/python2.6-config
-rwxr-xr-x  2 root  wheel  86000 May  4  2011 /usr/bin/pythonw lrwxr-xr-x  1 root  wheel     76 May  4  2011 /usr/bin/pythonw2.5 ->
../../System/Library/Frameworks/Python.framework/Versions/2.5/bin/pythonw2.5
lrwxr-xr-x  1 root  wheel     76 May  4  2011 /usr/bin/pythonw2.6 ->
../../System/Library/Frameworks/Python.framework/Versions/2.6/bin/pythonw2.6 
```

和

```
$ ls -la /usr/local/bin/python*     
lrwxr-xr-x  1 ykessler  wheel  68
Nov 14  2011 /usr/local/bin/python ->
../../../Library/Frameworks/Python.framework/Versions/2.7/bin/python
lrwxr-xr-x  1 ykessler  wheel  71 Nov 14  2011
/usr/local/bin/python-32 ->
../../../Library/Frameworks/Python.framework/Versions/2.7/bin/python-32
lrwxr-xr-x  1 ykessler  wheel  75 Nov 14  2011
/usr/local/bin/python-config ->
../../../Library/Frameworks/Python.framework/Versions/2.7/bin/python-config
lrwxr-xr-x  1 ykessler  wheel  71 Nov 14  2011
/usr/local/bin/python2.7 ->
../../../Library/Frameworks/Python.framework/Versions/2.7/bin/python2.7
lrwxr-xr-x  1 ykessler  wheel  74 Nov 14  2011
/usr/local/bin/python2.7-32 ->
../../../Library/Frameworks/Python.framework/Versions/2.7/bin/python2.7-32
lrwxr-xr-x  1 ykessler  wheel  78 Nov 14  2011
/usr/local/bin/python2.7-config ->
../../../Library/Frameworks/Python.framework/Versions/2.7/bin/python2.7-config
lrwxr-xr-x  1 ykessler  wheel  69 Nov 14  2011 /usr/local/bin/pythonw
-> ../../../Library/Frameworks/Python.framework/Versions/2.7/bin/pythonw
lrwxr-xr-x  1 ykessler  wheel  72 Nov 14  2011
/usr/local/bin/pythonw-32 ->
../../../Library/Frameworks/Python.framework/Versions/2.7/bin/pythonw-32
lrwxr-xr-x  1 ykessler  wheel  72 Nov 14  2011
/usr/local/bin/pythonw2.7 ->
../../../Library/Frameworks/Python.framework/Versions/2.7/bin/pythonw2.7
lrwxr-xr-x  1 ykessler  wheel  75 Nov 14  2011
/usr/local/bin/pythonw2.7-32 ->
../../../Library/Frameworks/Python.framework/Versions/2.7/bin/pythonw2.7-32 
```

所以看起来我的用户环境指向 2.7，但根环境指向 2.6？我该如何调和这两者？

* * *

**更新 2：**

好的，只是稍微转动一下螺丝：

```
$ sudo pip --version  
pip 1.2.1 from /Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/pip-1.2.1-py2.7.egg (python 2.7)
$ pip --version  
pip 1.0.2 from /Library/Python/2.6/site-packages/pip-1.0.2-py2.6.egg (python 2.6) 
```

所以我的根指向 2.6 但`sudo pip --version`指向 pip 2.7，而我的本地用户指向 2.7 但`pip --version`指向 pip 2.6

？？？我的大脑开始发麻。

现在我刚刚做了`sudo pip install {module}`，它在 2.7 中正确安装，但我希望我知道发生了什么......

* * *

**更新 3：回答 Ned 的问题：**

```
$ type pip  
pip is /Library/Frameworks/Python.framework/Versions/2.7/bin/pip  
$ echo $PATH  
/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/local/git/bin:/usr/X11/bin  
$ which pip  
/Library/Frameworks/Python.framework/Versions/2.7/bin/pip  
$ ls -l $(which pip)  
-rwxr-xr-x  1 ykessler  admin  358 Oct  3 15:30 /Library/Frameworks/Python.framework/Versions/2.7/bin/pip  
$ sudo bash  
bash-3.2# type pip  
pip is /Library/Frameworks/Python.framework/Versions/2.7/bin/pip  
bash-3.2# echo $PATH  
/Library/Frameworks/Python.framework/Versions/2.7/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/local/git/bin:/usr/X11/bin  
bash-3.2# ls -l $(which pip)  
-rwxr-xr-x  1 ykessler  admin  358 Oct  3 15:30 /Library/Frameworks/Python.framework/Versions/2.7/bin/pip 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:42:53.337

在我的系统上，我有几个 easy_installs：

```
$ ls /usr/bin/easy_install*
/usr/bin/easy_install       /usr/bin/easy_install-2.5   /usr/bin/easy_install-2.6   /usr/bin/easy_install-2.7 
```

以及几个点：

```
$ ls /usr/local/bin/pip*
/usr/local/bin/pip  /usr/local/bin/pip-2.5  /usr/local/bin/pip-2.6  /usr/local/bin/pip-2.7 
```

如您所说，您的用户环境似乎指向2.7，但系统指向2.6。在我看来，您有两个选择：

1.  您可以使用 Apple 设置来切换系统 python 版本：`$ defaults write com.apple.versioner.python Version 2.7`或`$ export VERSIONER_PYTHON_VERSION=2.7`. （有关[`man python`](https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/python.1.html)您的特定 OSX 版本的更多详细信息，请参阅。）
2.  您可以使用 pip python 特定版本。（例如`pip-2.7`：）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T20:59:08.187

您可能有 $PATH 问题或权限问题或两者兼而有之。尝试这个：

```
type pip
echo $PATH
which pip
ls -l $(which pip)
sudo bash
type pip
echo $PATH
ls -l $(which pip) 
```

更新：在两者下尝试的另一件事：

```
env | grep PYTHON
sudo bash
env | grep PYTHON 
```

然后我会查看`site-packages`目录的内容：

```
cd /Library/Frameworks/Python.framework/Versions/2.7
cd ./lib/python2.7/site-packages/
ls -al
more setuptools.pth 
```

还：

```
more $(which pip)
python2.7 -c 'import sys, pprint; pprint.pprint(sys.path)'
sudo python2.7 -c 'import sys, pprint; pprint.pprint(sys.path)' 
```

# objective-c - 目标 C - 如何用另一个词替换一个句子的所有词

> ID：12715775
> 
> 赞同：0
> 
> 时间：2012-10-03T19:50:08.433
> 
> 标签：objective-c, algorithm

假设我有这句话

“你好，我叫贝蒂！”

我需要用单词“thing”替换所有带有 3 个或更多字母的单词，同时保留大小写和标点符号。在 Objective C 中执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:56:57.653

我会用简单的计数器来解决这个问题，以计算以空格、句点或任何其他字符结尾的字母数量。那将是我当前的单词长度。

当您知道新字符串将使用的字母数量时，您再进行一次传递，只需复制较短的字母并用“事物”一词替换较长的字母（也可以在计数器的帮助下）。

您还可以跟踪较长单词的位置和长度，但这不是必需的。

# c# - 使用 Fluent API 向映射表添加新列

> ID：12715777
> 
> 赞同：1
> 
> 时间：2012-10-03T19:50:22.127
> 
> 标签：c#, entity-framework, fluent-interface

我有两个实体如下：

```
public class Project
{
    public int ID { get; set; }
    public string ProjectName { get; set; }
}

public Class FourteenSteps
{
    public int ID { get; set; }
    public string StepName { get; set; }
} 
```

我想将这两个映射到我正在使用 Fluent API 执行的一个实体中，如下所示：

```
modelBuilder.Entity<Project>()
    .HasMany(c => c.FourteenSteps)
    .WithMany(d => d.Projects)
    .Map(m => m.ToTable("FourteenStepStatus")
    .MapLeftKey("ProjectId")
    .MapRightKey("FourteenStepsId")); 
```

现在，新表“FourteenStepStatus”有两个字段，分别称为“ProjectId”和
“FourteenStepsId”。

我想向“FourteenStepStatus”添加一个名为“IsCompleted”的字段，它不属于其他两个实体。我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T14:31:55.440

我得到了如何添加数据的答案。通过将对象添加到上下文的 FourteenStepStatus 实体。谢谢你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T08:39:40.357

如果您想在联结表中添加其他字段，则不能将其用于多对多关系。您必须改为引入一个新实体`FourteenStepStatus`，映射其所有列并映射两个一对多关系：一个在`Project`and之间`FourteenStepStatus`，第二个在`FourteenSteps`and之间`FourteenStepStatus`。映射多对多关系仅适用于联结表仅包含键的情况。

# php - Ajax Mess 试图创建 SetInterval 函数

> ID：12715784
> 
> 赞同：-1
> 
> 时间：2012-10-03T19:50:58.617
> 
> 标签：php, jquery, ajax, arrays, intervals

好的，我之前问过一个问题，但我遇到了一个全新的问题。我在 PHP 脚本服务器端有一个 PHP 数组。我正在尝试编写一个客户端 Ajax 脚本来重新轮询 PHP 脚本以获取新数据并更新页面上显示的统计信息。

这是我确定我做得不对的 Ajax：

```
setInterval(function(getLatestInfo) 
{  
    $.ajax({
    type: 'POST',
    url: 'script.php',
    data: 'id=data',
    dataType: 'json',
    cache: false,
    success: function(getLatestInfo){
    $.getJSON(script.php, function(getLatestInfo){
    var result_array = JSON.parse(result);
    });
    $('#bit_rate').html(result_array[4]);
    $('#listeners').html(result_array[5]);
    $('#current_song').html(result_array[9]);
                });
            });
            }, 10000);//time in milliseconds 
```

这是PHP：

```
 <?php 
            Function getLatestInfo() {

$SERVER = 'http://chillstep.info:1984'; 
$STATS_FILE = '/status.xsl?mount=/test.mp3'; 
$LASTFM_API= '00000000000000000'; 

$ch = curl_init(); 

curl_setopt($ch,CURLOPT_URL,$SERVER.$STATS_FILE); 

curl_setopt($ch,CURLOPT_RETURNTRANSFER,1); 

$output = curl_exec($ch); 

curl_close($ch); 

$dp = array(); 

$search_for = "<td\s[^>]*class=\"streamdata\">(.*)<\/td>"; 
$search_td = array('<td class="streamdata">','</td>'); 

if(preg_match_all("/$search_for/siU",$output,$matches)) { 
   foreach($matches[0] as $match) { 
      $to_push = str_replace($search_td,'',$match); 
      $to_push = trim($to_push); 
      array_push($dp,$to_push); 
   } 
} 

$x = explode(" - ",$dp[9]); 

echo json_encode($dp);
            }
 ?> 
```

简而言之，我需要这个 ajax 脚本来更新和提取 PHP 变量 $dp，它是一个数组，将其解析出来，并创建 HTML 可用的字符串变量。并每 10 秒重复一次该过程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:50:37.050

在这种情况下不要使用 setInterval。在成功回调中再次调用原始函数。您还在 ajax 调用的成功回调中调用 getJSON - 这是重复调用。

例如

```
函数获取最新（）
{
  $.ajax({
  //其余的ajax参数
  成功：函数（结果）{
    var resultarray = $.parseJSON(results);
    $('#bit_rate').html(result_array[4]);
    $('#listeners').html(result_array[5]);
    $('#current_song').html(result_array[9]);
    获取最新（）；
  }
  });
}

```

# java - json导致崩溃 - Android

> ID：12715796
> 
> 赞同：1
> 
> 时间：2012-10-03T19:51:39.653
> 
> 标签：java, android, json

我正在使用 Json 和 PHP 将我的 android 应用程序与远程 mySql 数据库连接起来。但由于某种原因，JSON 解析器返回并错误提示 json 字符串存在问题。

json 字符串为：{"success":1,"message":"sit created."}

错误是：解析数据时出错 org.json.JSONException：JSONObject 文本必须以 {"success":1,"message":"sit created."} 的字符 1 处的 '{' 开头

谁能告诉我问题是什么，我无法弄清楚。

# android - 无法从 String[] 转换为 ArrayList

> ID：12715798
> 
> 赞同：0
> 
> 时间：2012-10-03T19:51:52.287
> 
> 标签：android, arrays, string, casting

我有一个要放入 ArrayList 的资源字符串数组，但是返回的数据类型是字符串数组。string[] 不能直接转换为 ArrayList 而不会收到以下错误：

无法从 String[] 转换为 ArrayList

如何将 String[] 数据类型转换为 ArrayList？

**编辑**

我有一个适配器，它的构造函数需要一个 ArrayList 和一个我想要填充它的资源字符串数组。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T20:05:58.497

如果您可以使用 a `List<String>`（而不是特别是 a `ArrayList<String>`），您可以使用：

```
List<String> list = Arrays.asList(stringArray); 
```

否则，您可以这样做：

```
ArrayList<String> list = new ArrayList<String>(Arrays.asList(stringArray)); 
```

但是，与其他建议的解决方案相比，后者的效率较低（在时间和对象创建计数方面）。它唯一的好处是它将代码精简到一行，并且一目了然。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T19:55:20.260

```
public ArrayList<String> arrayToArrayList(String[] array){
    ArrayList<String> arrayList = new ArrayList<String>(array.length);
    for(String string : array){
        arrayList.add(string);
    }

    return arrayList;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-03T19:55:32.397

这个怎么样

```
import java.util.Collections; 

String[] myStringArray = new String[] {"foo", "bar", "baz"}; 
List myList = new ArrayList(myStringArray.length);
Collections.addAll(myList, myStringArray); 
```

# java - 通过 Java Eclipse 进行 Android 开发：我正在导出，但它没有导出为 .apk 文件

> ID：12715800
> 
> 赞同：1
> 
> 时间：2012-10-03T19:51:54.223
> 
> 标签：java, android, eclipse, export, apk

我对 Java android 开发相当陌生，过去曾将我的应用程序导出为 .apk 文件，但是今天，它正在将其作为未知文件导出给我。我真的需要 .apk 文件。任何人都可以帮忙吗？谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:53:33.800

右键单击您的项目，单击 Android 工具 > 导出签名的应用程序包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:54:06.417

通常你可以添加`.apk`到文件名中，我会正常工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:59:05.720

如果您的项目构建，那么您只需进入项目的 bin 文件夹（通过资源管理器）并获取 .apk。（当然这不是正式签署的，但有利于测试）

# python - 运行时错误 (NZEC) Python

> ID：12715804
> 
> 赞同：0
> 
> 时间：2012-10-03T19:52:07.390
> 
> 标签：python, runtime-error

我正在尝试一个如下问题

```
 Master Shifu is organizing a quiz for Po. The quiz consists of N multiple-choice 
questions, conveniently numbered 0 through N-1\. For each question there are three possible answers labeled A, B, and C. For each question, exactly one of the three possible
answers is correct. You are given the information on correct answers as a String answers.
More precisely, answers[i] is the correct answer to the i-th question. This is of course unknown to Po.

    Po did not know the answer to any of the quiz questions. Being desperate, he with some
help from Tigress,Mantis,Crane,Viper and Monkey he got the answer script. However, the only
thing he could obtain was aggregate information on the answers that will be used. More 
precisely, Po now knows how many questions have the answer A, how many have the answer B, 
and how many have the answer C.

    When taking the quiz, Po will be given the questions one at a time, in the same order
that is used in answers. For each of the questions, he will use his intuition to pick one 
of the answers that are still possible. After he picks the answer for a question, Master 
Shifu will tell him the correct answer for that question. Po has noticed that sometimes he 
can rule out some of the answers when answering a question. Your task is to help Po by 
telling him the number of options he will choose from when answering i-th question.

Constraints:

1<=N<=50

Each character of answers will be 'A', 'B', or 'C'.

Input

First line will contain the number of test cases, T. Then T lines follow each containg the string of answers.

Output

Output an array of N numbers, where i-th element will tell the number of options Po will choose from when answering i-th question. 
```

我用python写的代码是

```
from collections import Counter
t = int(raw_input())
for i in range(t):
    po = []
    s = raw_input()
    a = Counter(s)
    options = 3
    for x in s:
        na = a['A']
        nb = a['B']
        nc = a['C']
        if na == 0 or nb == 0 or nc == 0:
            options = 2
        if (na == 0 and nb == 0) or (nb == 0 and nc == 0) or (nc == 0 and na == 0):
            options = 1
        if (na == 0 and nb == 0 and nc == 0):
            options = 0
        po.append(options)
        a[x] -= 1
    out = ""
    for x in po:
        out += str(x) + " "
    print out 
```

当我在 spoj 门户上运行代码时出现运行时错误（NZEC），但我更正了 ideone 上的输出（http://ideone.com/WseoQ）

```
Input:
4
AAAAA
AAABBB
CAAAAAC
BBCA 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T04:07:06.447

我怀疑由于输入中有额外的空格，您得到了 NZEC。您可以尝试立即获取输入并用空格对其进行标记。

```
from collections import Counter
import sys
tokenizedInput = sys.stdin.read().split()
t = int(tokenizedInput[0])
for i in range(t):
    po = []
    s = tokenizedInput[i+1] 
```

我希望这会有所帮助。

# c# - 如何 XML 反序列化 c# 中的数组数组？

> ID：12715805
> 
> 赞同：3
> 
> 时间：2012-10-03T19:52:09.397
> 
> 标签：c#, xml, xml-serialization

我正在尝试反序列化信用卡箱对象以在表单上进行品牌验证，但无法正确完成。内部对象没有反序列化，或者品牌的主要列表为空。谁能帮我一两个？

我的 XML 是这样的：

```
<?xml version="1.0" encoding="utf-8"?>
<Brands>
  <Brand type="visa">
    <Bins>
      <Bin enabled="true" value="123" />
      <Bin enabled="true" value="456" />
      <Bin enabled="true" value="789" />
    </Bins>
  </Brand>
  <Brand type="master">
    <Bins>
      <Bin enabled="true" value="987" />
      <Bin enabled="true" value="654" />
      <Bin enabled="true" value="321" />
    </Bins>
  </Brand>
</Brands> 
```

我最新的代码（它带来了brandsCollection *null*）是：

```
[XmlRoot("Brands")]
public class CreditCardBrand
{
    [XmlArray("Brands"), XmlArrayItem("Brand")]
    public CreditCardBrandCollection[] brandsCollection { get; set; }
}

public class CreditCardBrandCollection
{
    [XmlElement("Bins")]
    public CreditCardBrandBins[] binsCollection { get; set; }

    [XmlAttribute("type")]
    public CreditCardBrands brand { get; set; }
}

public class CreditCardBrandBins
{
    [XmlAttribute("value")]
    public string bin { get; set; }

    [XmlAttribute("enabled")]
    public bool enabled { get; set; }
} 
```

我想将此 xml 反序列化为一个品牌数组，每个品牌都有一个属性名称（类型）和一个与之关联的 bin 数组（只有启用的那些），所以我可以在启动时将它放在我的系统的内存中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:19:57.380

这实际上很容易。你只是混淆了——或者，更好的说法是，重复了——根元素声明和你给`brandsCollection`数组赋值的方式。您必须按如下方式更改声明：

```
[XmlRoot("Brands")]
public class CreditCardBrand
{
    [XmlElement("Brand")]
    public CreditCardBrandCollection[] brandsCollection { get; set; }
} 
```

这里`[XmlElement]`导致数组的每个元素由单个`<Brand>`标记表示。在您的原始代码中，您描述了一个必须如下所示的 XML：

```
<Brands>
    <Brands> <!-- duplicate Brands element here -->
        <Brand type="…">…&lt;/Brand>
        <Brand type="…">…&lt;/Brand>
        <Brand type="…">…&lt;/Brand>
        …
    </Brands>
</Brands> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T20:20:34.610

如果你想使用 Linq2Xml

```
XDocument xDoc = XDocument.Parse(xml); //or XDocument.Load(filename)
List<CreditCardBrand> brands =
            xDoc.Descendants("Brand")
            .Select(br => new CreditCardBrand()
            {
                Type = br.Attribute("type").Value,
                Bins = br.Descendants("Bin")
                            .Select(b => new CreditCardBin(){
                                Enabled = (bool)b.Attribute("enabled"),
                                Value = b.Attribute("value").Value,
                            }).Where(b => b.Enabled == true)
                            .ToList()

            })
            .ToList(); 
```

--

```
public class CreditCardBrand
{
    public string Type { get; set; }
    public List<CreditCardBin> Bins { get; set; }
}

public class CreditCardBin
{
    public string Value { get; set; }
    public bool Enabled { get; set; }
} 
```

# sql - 使用子查询选择多行

> ID：12715807
> 
> 赞同：2
> 
> 时间：2012-10-03T19:52:17.623
> 
> 标签：sql

问题是“显示所有职位与销售部门中任何人相同的员工的姓名”，但

```
SELECT name, job 
FROM Employer WHERE job=(SELECT job FROM employer WHERE dept = sales); 
```

不起作用，因为子查询返回多个值。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T19:55:09.493

尝试使用`in`

```
SELECT name, job 
    FROM Employer 
    WHERE job in (SELECT job FROM employer WHERE dept = sales); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:05:45.770

@Parado 有最简单的解决方案。但是请记住，`in`关键字实际上只是一个`join`. 例如，您的查询与以下内容相同：

```
SELECT e1.name, e1.job
FROM Employer e1
    JOIN Employer e2 on e1.job = e2.job
WHERE e2.dept = 'sales' 
```

# php - 更改表单以使用 jQuery 并避免页面刷新

> ID：12715808
> 
> 赞同：0
> 
> 时间：2012-10-03T19:52:29.513
> 
> 标签：php, jquery, css, forms

我正在尝试更改下面的表单标签以使用 jQuery。已经单击按钮将显示从行更改为列，反之亦然，但我想避免页面刷新。我真的是 jQuery 的新手，当我自己尝试改变它时，我不能诚实地说出我的错误是什么。

```
<form id="rowsToColumns" action="index.php?main_page=specials&disp_order=1" method="POST">
    <input type="hidden" name="style_changer" value="columns"/>
    <button type="submit" class="btn btn-large btn-primary" type="button">Change to Column</button>
</form>

<form id="columnsToRows" action="index.php?main_page=specials&disp_order=1" method="POST">
    <input type="hidden" name="style_changer" value="rows"/>
    <button type="submit" class="btn btn-large btn-primary" type="button">Change to Rows</button>
</form> 
```

我也在尝试让按钮在单击时调用不同的样式表。正如我上面提到的，显示从/到行/列更改不需要此样式表。实际页面是用php编写的，如下图：

```
<?php $this_page =  zen_href_link($_GET['main_page'], zen_get_all_get_params()); ?>
<div id="style_changer">
    <?php if($current_listing_style == 'rows') {?>
    <form id="rowsToColumns" action="<?php echo $this_page;?>" method="POST">
        <input type="hidden" name="style_changer" value="columns"/>
        <button type="submit" class="btn btn-large btn-primary" type="button">Change to Column</button>
    </form>
    <?php } else { ?>
    <form id="columnsToRows" action="<?php echo $this_page;?>" method="POST">
        <input type="hidden" name="style_changer" value="rows"/>
        <button type="submit" class="btn btn-large btn-primary" type="button">Change to Rows</button>
    </form>
    <?php } ?>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:57:06.733

如果问题是“如何更改表单以使用 jQuery 并避免页面刷新”，那么[jquery 表单插件](http://www.malsup.com/jquery/form/)就是您的朋友，因为它可以将任何 html 表单转换为 ajax 驱动的表单。

只需按照他们的说明进行操作，您就可以立即使用它（前提是您的表单已经按原样工作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:57:24.080

您可以通过阻止提交按钮上的默认操作来阻止默认表单提交。

```
 $('button[type=submit]').submit( function(e){

       e.preventDefault(); // Stops the form from submitting 
  }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:58:01.930

好吧，对于一个非常模糊的方法，您可以使用`$.ajax`并利用读取`<form>`的预先存在的属性来决定提交方法并将元素的值作为提交数据读取：

```
$('form').on('submit',function(e){
  var $form = $(this);
  // submit the form, but use the AJAX equiv. instead of a full page refresh
  $.ajax({
    'url'     : $form.attr('action'),
    'method'  : $form.attr('type'),
    'data'    : $form.serialize(),
    'success' : function(response){
      // process response (make CSS changes or whatever it is
      // a form submission would normally do)
    }
  });
  // prevent the normal submit and reload behavior as AJAX is now
  // handling the submission
  e.preventDefault();
}); 
```

但是，要使其正常工作，您将需要一些精简的 PHP 响应变体，仅用于 AJAX 请求（避免重新发送标头、脚本标签等，只返回 jQuery 可以用来制作的原始数据）用户界面决定）。

# android - android EditText：随着 inputType="textCapCharacters" 提示消失

> ID：12715809
> 
> 赞同：0
> 
> 时间：2012-10-03T19:52:36.190
> 
> 标签：android, xml

这可能是一个错误，或者我只是不明白为什么，但似乎`inputType="textCapCharacters"`在 a 上设置（或任何其他 inputType）`EditText`会使提示与`gravity="center"`.

以下是我的 xml 的摘录，其中`LinearLayout`定义了下图中可见的内容：

**a) 没有** `inputType="textCapCharacters"`

```
(...)
<LinearLayout 
    android:id="@+id/lin_cond1"
    android:layout_below="@id/v_cond_line1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="5dp"
    android:orientation="horizontal">
    <RadioButton 
        android:id="@+id/rb_cond_stake_normal"
        android:layout_width="0dp"
        android:layout_weight="15"
        android:layout_height="wrap_content"
        />
    <TextView 
        android:layout_width="0dp"
        android:layout_weight="25"
        android:layout_height="wrap_content"
        android:text="@string/define_stake"
        />
    <EditText 
        android:id="@+id/et_cond_enter_stake_normal"
        android:layout_width="0dp"
        android:layout_weight="20"
        android:layout_height="wrap_content"
        android:inputType="number"
        android:gravity="center"
        />
    <EditText 
        android:id="@+id/et_cond_currencies"
        android:layout_width="0dp"
        android:layout_weight="40"
        android:layout_height="wrap_content"
        android:maxLength="3"
        android:gravity="center"
        android:hint="@string/currency"
        />
</LinearLayout>
(...) 
```

**结果**

![在此处输入图像描述](../Images/1a4c31edbaa2a77489cd5c8c33b15206.png)

**b) 有** `inputType="textCapCharacters"`

```
(...)
<LinearLayout 
    android:id="@+id/lin_cond1"
    android:layout_below="@id/v_cond_line1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="5dp"
    android:orientation="horizontal">
    <RadioButton 
        android:id="@+id/rb_cond_stake_normal"
        android:layout_width="0dp"
        android:layout_weight="15"
        android:layout_height="wrap_content"
        />
    <TextView 
        android:layout_width="0dp"
        android:layout_weight="25"
        android:layout_height="wrap_content"
        android:text="@string/define_stake"
        />
    <EditText 
        android:id="@+id/et_cond_enter_stake_normal"
        android:layout_width="0dp"
        android:layout_weight="20"
        android:layout_height="wrap_content"
        android:inputType="number"
        android:gravity="center"
        />
    <EditText 
        android:id="@+id/et_cond_currencies"
        android:layout_width="0dp"
        android:layout_weight="40"
        android:layout_height="wrap_content"
        android:inputType="textCapCharacters"
        android:maxLength="3"
        android:gravity="center"
        android:hint="@string/currency"
        />
</LinearLayout>
(...) 
```

**结果**

![在此处输入图像描述](../Images/fa9d6032eebb24845fec894a95fe2db9.png)

我尝试过但没有成功的方法：
- 将提示文本也用大写字母
- 放在`inputType="textCapCharacters"`不同的位置

什么有效，但不需要：
- （如这里所见）删除`gravity="center"`. 但是为什么它不能仅在组合中起作用？离开正常`gravity`工作`inputType`。

那么有什么解决方案可以同时拥有 inputType 和重力吗？

# ios - 点亮 UIColor

> ID：12715810
> 
> 赞同：8
> 
> 时间：2012-10-03T19:52:45.317
> 
> 标签：ios, objective-c, swift, cocoa-touch, uicolor

昨天我遇到了一个需要减轻 UIColor 的情况，所以我创建了一个类别并添加了一个`lighten`方法。我认为将值乘以颜色的每个分量是直截了当的，但我的绿色开始变黄，所以我知道它必须更复杂。

我想出的解决方案是从 sRGB 转换为线性，乘以颜色，然后再转换回来。这似乎有效，但我不确定它是否“正确”。我在文档中找不到任何说明 UIColor 在 sRGB 空间中的内容。我也不是色彩科学家，所以我对所涉及的数学只有初步的了解。

无论如何，这是我的代码，我要求进行一些同行评审，看看是否有人对修改 UIColors 有更好的理解。

```
CGFloat sRGB2Linear(CGFloat x){
    CGFloat a = 0.055;
    if(x <= 0.04045){
        return x * (1.0 / 12.92);
    }else{
        return pow((x + a) * (1.0 / (1 + a)), 2.4);
    }
}

CGFloat linear2sRGB(CGFloat x){
    CGFloat a = 0.055;
    if(x <= 0.0031308){
        return x * 12.92;
    }else{
        return (1 + a) * pow(x, 1 / 2.4) - a;
    }
}

- (UIColor *)lighten:(CGFloat)value{
    const CGFloat *components = CGColorGetComponents([self CGColor]);
    CGFloat newR = (sRGB2Linear(components[0])+1)*value;
    CGFloat newG = (sRGB2Linear(components[1])+1)*value;
    CGFloat newB = (sRGB2Linear(components[2])+1)*value;
    newR = MAX(0, MIN(1, linear2sRGB(newR)));
    newG = MAX(0, MIN(1, linear2sRGB(newG)));
    newB = MAX(0, MIN(1, linear2sRGB(newB)));
    return [UIColor colorWithRed:newR green:newG blue:newB alpha:components[3]];
} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-26T07:24:16.467

这是我的 iOS5+ 解决方案，可以轻松更改相对亮度（一体式变亮和变暗）：

```
+ (UIColor*)changeBrightness:(UIColor*)color amount:(CGFloat)amount
{

    CGFloat hue, saturation, brightness, alpha;
    if ([color getHue:&hue saturation:&saturation brightness:&brightness alpha:&alpha]) {
        brightness += (amount-1.0);
        brightness = MAX(MIN(brightness, 1.0), 0.0);
        return [UIColor colorWithHue:hue saturation:saturation brightness:brightness alpha:alpha];
    }

    CGFloat white;
    if ([color getWhite:&white alpha:&alpha]) {
        white += (amount-1.0);
        white = MAX(MIN(white, 1.0), 0.0);
        return [UIColor colorWithWhite:white alpha:alpha];
    }

    return nil;
} 
```

它是这样调用的：

```
[self changeBrightness:someUiColor amount:1.1] 
```

使用 1.1 会增加 10% 的亮度；0.9 将亮度降低 10%。请注意，10% 是相对于纯白色而言的（即，10% 总是增加 0.1 的亮度。）如果您希望增加百分比以一致地使颜色变亮或变暗，而不管它们的初始亮度如何，这是预期的行为。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-03T20:20:01.047

您可以使用色调、饱和度和亮度。

使用获取旧值

```
- (BOOL)getHue:(CGFloat *)hue saturation:(CGFloat *)saturation brightness:(CGFloat *)brightness alpha:(CGFloat *)alpha 
```

然后调整亮度，并构造一个新的颜色：

```
- (UIColor *)initWithHue:(CGFloat)hue saturation:(CGFloat)saturation brightness:(CGFloat)brightness alpha:(CGFloat)alpha 
```

请记住，您需要将指针传递给第一个函数。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-03T00:37:43.617

Kof 在 Swift 中的回答：

```
extension UIColor {
    public func changeBrightness(b: CGFloat, saturation s: CGFloat = 1.0, hue h: CGFloat = 1.0) -> UIColor? {
        var hue : CGFloat = 0.0
        var saturation : CGFloat = 0.0
        var brightness : CGFloat = 0.0
        var alpha : CGFloat = 0.0

        if self.getHue(&hue, saturation: &saturation, brightness: &brightness, alpha: &alpha) {
            brightness *= b
            brightness = max(min(brightness, 1.0), 0.0)
            saturation *= s
            saturation = max(min(saturation, 1.0), 0.0)
            hue *= h
            hue = max(min(hue, 1.0), 0.0)

            return UIColor(hue: hue, saturation: saturation, brightness: brightness, alpha: alpha)
        }

        var white: CGFloat = 0.0
        if self.getWhite(&white, alpha: &alpha) {
            white += (b - 1.0)
            white = max(min(b, 1.0), 0.0)

            return UIColor(white: white, alpha: alpha)
        }

        return nil
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-06-16T11:09:27.440

尝试

```
- (UIColor *)mixColorWithWhiteAndAlpha:(CGFloat)alpha {
    CGFloat r, g, b, a;
    if ([self getRed:&r green:&g blue:&b alpha:&a])
        return [UIColor colorWithRed:r + (1 -r) * alpha
                               green:g + (1 -g) * alpha
                                blue:b + (1 -b) * alpha
                               alpha:a];
    return nil;
} 
```

它应该返回与您的颜色混合的白色

所以你可以将 alpha 设置为 0.2，我认为它会没问题

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-02-04T16:03:49.830

与白色混合是我发现不会扭曲原始颜色的唯一方法，就像在这个 Swift 扩展中一样：

```
extension UIColor {

    @objc func lighten(_ alpha: CGFloat) -> UIColor {
        var r: CGFloat = 0
        var g: CGFloat = 0
        var b: CGFloat = 0
        var a: CGFloat = 0
        guard self.getRed(&r, green: &g, blue: &b, alpha: &a) else { return self }
        return UIColor(red:r + (1.0-r) * alpha, green:g + (1.0-g) * alpha, blue:b + (1.0-b) * alpha, alpha: a)
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-06-27T12:48:12.260

我已经改进了 ank 的方法以允许修改饱和度和色调。

输入被视为百分比，因此`b`1.0 等于 100%（无变化）。要将亮度降低 30%，请设置`b`为 0.7。

```
+ (UIColor*)changeColor:(UIColor*)color brightness:(CGFloat)b saturation:(CGFloat)s hue:(CGFloat)h
{

    CGFloat hue, saturation, brightness, alpha;
    if ([color getHue:&hue saturation:&saturation brightness:&brightness alpha:&alpha]) {
        brightness *= b;
        brightness = MAX(MIN(brightness, 1.0), 0.0);
        saturation *= s;
        saturation = MAX(MIN(saturation, 1.0), 0.0);
        hue *= h;
        hue = MAX(MIN(hue, 1.0), 0.0);
        return [UIColor colorWithHue:hue saturation:saturation brightness:brightness alpha:alpha];
    }

    CGFloat white;
    if ([color getWhite:&white alpha:&alpha]) {
        white += (b-1.0);
        white = MAX(MIN(b, 1.0), 0.0);
        return [UIColor colorWithWhite:white alpha:alpha];
    }

    return nil;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-03-24T15:24:18.837

```
- (UIColor *)changeBrightnessToPercentage:(CGFloat)percentage {
    CGFloat hue, saturation, brightness, alpha;
    if ([self getHue:&hue saturation:&saturation brightness:&brightness alpha:&alpha]) {
        brightness += (percentage - 1.0);
        brightness = MAX(MIN(brightness, 1.0), 0.0);
        return [UIColor colorWithHue:hue saturation:saturation brightness:brightness alpha:alpha];
    }

    CGFloat white;
    if ([self getWhite:&white alpha:&alpha]) {
        white += (percentage - 1.0);
        white = MAX(MIN(white, 1.0), 0.0);
        return [UIColor colorWithWhite:white alpha:alpha];
    }

    return nil;
} 
```

**==1.0 是提供的颜色，>1.0 是较浅的颜色，<1.0 是较深的颜色。**

# java - 我的浏览器中每个片段的不同标题

> ID：12715815
> 
> 赞同：14
> 
> 时间：2012-10-03T19:53:09.277
> 
> 标签：java, android-actionbar, android-viewpager, title

我正在使用viewpager“tabs + swipe”，我想在actionBar中为每个片段设置不同的标题，这样当我切换时，标题就会改变。

我尝试了几件事但没有成功，只显示最后一个标题......并且当我切换时不再改变......

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-04T04:33:20.883

首先，让你的活动实现一个[`OnPageChangeListener`](http://developer.android.com/reference/android/support/v4/view/ViewPager.OnPageChangeListener.html).

然后，当您创建 时`ViewPager`，您可以使用[`mViewPager.setOnPageChangeListener(this)`](http://developer.android.com/reference/android/support/v4/view/ViewPager.html#setOnPageChangeListener%28android.support.v4.view.ViewPager.OnPageChangeListener%29)，以便您的活动在页面更改时接收回调。

最后，您需要实现`OnPageChangeListener`回调。你的`onPageSelected()`方法应该是这样的：

```
@Override
public abstract void onPageSelected(int position) {
    setTitle(getTitleFromPosition(position));
} 
```

其他两个回调可以为空。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-26T10:12:17.030

虽然这个问题有点过时，但我会建议我的解决方案。场景：选项卡+滑动，每个选项卡都有片段导航堆栈。因此，操作栏标题不仅可以通过切换和滑动选项卡来更改，还可以通过每个选项卡中的导航来更改。为了给每个片段提供标题，我声明`TitleProvider`了接口，所以如果片段有自定义标题，它必须实现这个接口。

```
public interface TitleProvider {
    CharSequence getTitle();
} 
```

下面是 custom `FragmentPagerAdapter`，用于处理切换、滑动、导航和标题更新：

```
public class TabsAdapter extends FragmentPagerAdapter implements
        TabHost.OnTabChangeListener, ViewPager.OnPageChangeListener {
    private final FragmentActivity activity;
    private final TabHost tabHost;
    private final ViewPager viewPager;
    private final ArrayList<Fragment> fragments = new ArrayList<Fragment>();
    private final Hashtable<Fragment, Stack<Class<?>>> fragmentBackstack = new Hashtable<Fragment, Stack<Class<?>>>();

    static class DummyTabFactory implements TabHost.TabContentFactory {
        private final Context context;

        public DummyTabFactory(Context context) {
            this.context = context;
        }

        @Override
        public View createTabContent(String tag) {
            View v = new View(context);
            v.setMinimumWidth(0);
            v.setMinimumHeight(0);
            return v;
        }
    }

    public TabsAdapter(FragmentActivity activity, TabHost tabHost,
                       ViewPager pager) {
        super(activity.getSupportFragmentManager());
        this.activity = activity;
        this.tabHost = tabHost;
        viewPager = pager;
        tabHost.setOnTabChangedListener(this);
        viewPager.setAdapter(this);
        viewPager.setOnPageChangeListener(this);
    }

    public void addTab(String tag, int drawableId, Fragment fragment,
                       int tabIndicatorId) {
        TabSpec tabSpec = tabHost.newTabSpec(tag);
        tabSpec.setContent(new DummyTabFactory(activity.getApplicationContext()));

        View tabIndicator = LayoutInflater.from(
                activity.getApplicationContext()).inflate(tabIndicatorId,
                tabHost.getTabWidget(), false);
        TextView title = (TextView) tabIndicator.findViewById(R.id.tab_title);

        if (fragment instanceof TitleProvider) {
            title.setText(((TitleProvider) fragment).getTitle());
        }

        ImageView icon = (ImageView) tabIndicator.findViewById(R.id.tab_icon);
        icon.setImageResource(drawableId);

        tabSpec.setIndicator(tabIndicator);

        fragments.add(fragment);
        tabHost.addTab(tabSpec);
        notifyDataSetChanged();
    }

    @Override
    public int getCount() {
        return fragments.size();
    }

    @Override
    public Fragment getItem(int position) {
        return fragments.get(position);
    }

    @Override
    public int getItemPosition(Object object) {
        int returnCode;
        if (fragments.contains(object)) {
            returnCode = POSITION_UNCHANGED;
        } else {
            returnCode = POSITION_NONE;
        }
        return returnCode;
    }

    @Override
    public void onTabChanged(String tabId) {
        int position = tabHost.getCurrentTab();
        viewPager.setCurrentItem(position);
        updateTitle();
    }

    @Override
    public void onPageScrolled(int position, float positionOffset,
                               int positionOffsetPixels) {
    }

    @Override
    public void onPageSelected(int position) {
        // Unfortunately when TabHost changes the current tab, it kindly
        // also takes care of putting focus on it when not in touch mode.
        // The jerk.
        // This hack tries to prevent this from pulling focus out of our
        // ViewPager.
        TabWidget widget = tabHost.getTabWidget();
        int oldFocusability = widget.getDescendantFocusability();
        widget.setDescendantFocusability(ViewGroup.FOCUS_BLOCK_DESCENDANTS);
        tabHost.setCurrentTab(position);
        widget.setDescendantFocusability(oldFocusability);
    }

    @Override
    public void onPageScrollStateChanged(int state) {
    }

    public void navigate(Fragment fromFragment, Fragment toFragment) {
        startUpdate(viewPager);

        FragmentTransaction transaction = activity.getSupportFragmentManager()
                .beginTransaction();
        transaction.remove(fromFragment);
        transaction.commit();

        Stack<Class<?>> backstack;
        if (fragmentBackstack.containsKey(fromFragment)) {
            backstack = fragmentBackstack.get(fromFragment);
            fragmentBackstack.remove(fromFragment);
        } else {
            backstack = new Stack<Class<?>>();
        }
        backstack.push(fromFragment.getClass());
        fragmentBackstack.put(toFragment, backstack);

        fragments.set(fragments.indexOf(fromFragment), toFragment);
        finishUpdate(viewPager);
        notifyDataSetChanged();
        updateTitle();
    }

    public Boolean navigateBack() {
        startUpdate(viewPager);
        Fragment fromFragment = fragments.get(viewPager.getCurrentItem());

        if (!fragmentBackstack.containsKey(fromFragment))
            return false;
        Stack<Class<?>> backstack = fragmentBackstack.get(fromFragment);
        if (backstack.isEmpty())
            return false;

        fragmentBackstack.remove(fromFragment);
        Fragment toFragment = Fragment.instantiate(activity, backstack.pop()
                .getName());
        fragmentBackstack.put(toFragment, backstack);

        fragments.set(fragments.indexOf(fromFragment), toFragment);

        FragmentTransaction transaction = activity.getSupportFragmentManager()
                .beginTransaction();
        transaction.remove(fromFragment);
        transaction.commit();

        finishUpdate(viewPager);
        notifyDataSetChanged();
        updateTitle();
        return true;
    }

    protected Fragment getCurrentFragment() {
        return fragments.get(viewPager.getCurrentItem());
    }

    protected void updateTitle() {
        Fragment fragment = getCurrentFragment();
        if (fragment instanceof TitleProvider) {
            activity.setTitle(((TitleProvider) fragment).getTitle());
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-18T15:07:16.457

```
@Override
        public void onPageSelected(int position) {
            tabHost.setSelectedNavigationItem(position);
            if (position == 0){
                setTitle(R.string.where_is_the_bus);
            }
            else if (position == 1){
                setTitle(R.string.bus_card);
            }
            else if (position == 2){
                setTitle(R.string.favo);
            } 
```

你可以像这样“这很容易，对吧？”

# python - 如何为多个变量分配任意值

> ID：12715816
> 
> 赞同：0
> 
> 时间：2012-10-03T19:53:14.310
> 
> 标签：python, expression

我的任务是编写一些函数来评估后缀、前缀和中缀表达式。这很好，花花公子，我已经完成了那部分任务，但是当我接受表达式时，我的问题就出现了。如果用户输入以“V”开头的字符串，我必须将“V”之后的整数分配给所需数量的变量。为了更清楚地说明，如果输入是“V ​​1 2 4 9”，我必须将 1 分配给字母 A，将 2 分配给字母 B，将 4 分配给字母 C，将 9 分配给字母 D。如果我按变量分配每个变量，则可以做到这一点。但这是一个漫长而艰巨的过程，我相信有更好的方法来做到这一点。我需要将整数值分配给变量的原因是因为当用户想要评估一个表达式时，它必须采用'-+AB*CF'的形式，例如，如果它是前缀符号表达式。当然，如果用户想要中缀或后缀，形式会发生变化，但要评估的值仍然是字母形式，就像我猜的数学一样。

如果这个问题不清楚，我很抱歉。显然这是家庭作业，但是我不需要代码或人来为我做这件事，只需对最佳方法进行一些说明就足够了。谢谢大家。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T19:55:44.410

将值存储在字典中：

```
import string

keys = string.ascii_uppercase
values = # make list of the values

variables = {keys[i]: val for i, val in enumerate(values)} 
```

现在您可以将值寻址`V 1 3 4`为`variables['A']`,`variables['B']`等。

# sql - #include 是否有 T-SQL 等价物，为什么

> ID：12715819
> 
> 赞同：1
> 
> 时间：2012-10-03T19:53:22.993
> 
> 标签：sql, sql-server, tsql

> **可能重复：**
> [TSQL 中的常量和包含文件](https://stackoverflow.com/questions/3243139/constants-and-include-files-in-tsql)

我一直在寻找与 C“#include”指令等效的 T-SQL。由于我还没有找到，我想知道

*   MS是否可能不包含任何类型的SQL文件包含/加入执行
*   如果不是，为什么
*   如果没有，有没有更好的方法让我一次执行多个 SQL 文件而无需复制粘贴或手动预编译

对于那些对我的动机感到好奇的人，我正在编写一组类似的查询，我发现外部化常量（来自枚举表）、预计算（制作一些测试输入表）和参数变量（我正在工作的子集）很方便上）。

据我所知，我不能真正使用存储过程或函数（而且我不喜欢用那些污染我的数据库的想法）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-03T20:57:17.243

您可以在 SSMS 或通过 sqlcmd 实用程序（命令行）查看在 SQLCMD 模式下执行。有一个`:r <file name>`命令允许您在当前执行会话中包含外部文件。因此，如果您`:r my_init_script.sql`在较大脚本的顶部附近包含一个，它可能会实现您所追求的。

请注意，这适用于 SQL 2005 及更高版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:33:07.880

您可以尝试使用存储过程。您将能够在每个命令中放置许多命令并使用参数来控制它们。此外，您可以根据需要串联调用不同的存储过程。如果你有一堆“常量”，你可以用一张表来存储它们，并根据需要选择它们。

# ruby-on-rails-3 - 将最后一个结果红宝石放入 if 语句中

> ID：12715823
> 
> 赞同：0
> 
> 时间：2012-10-03T19:53:34.050
> 
> 标签：ruby-on-rails-3

我是红宝石的新手。所以我正在试验并希望打印最后一个数组记录有点不同！这是代码：

```
 <h1>Wellcome to the Frige</h1>

<p> These are current inventory items: </p><br />
<% @frige.each do |items| %>
    <%
        if items == items.last
            %>
                And <%= items %> <br />
            <%
        else
            %>
                <%= items %> <br />
            <%
        end

     %>
<% end %>
<br />
<br />
<hr />
<%= link_to "Go tu the Shop", pages_frige_path %> 
```

结果如下：

欢迎来到弗里格

这些是当前库存项目：

西红柿 土豆 肉 薯条

Doties 乌兹维卡鲁

求救！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:57:22.607

最简单的答案是你不想要`if items == items.last`，你想要`if items == @frige.last`。

# cocoa - NSTableView 通过按“空格”选择行

> ID：12715826
> 
> 赞同：2
> 
> 时间：2012-10-03T19:53:42.603
> 
> 标签：cocoa, selection, nstableview

我没有找到关于这个问题的任何信息，我想知道是否可以通过按键盘上的空格键使 NSTableView （或子类）选择行，并通过按向上/向下键浏览行而不重置选择. 如果有人在 Windows 下使用它，我想让 nstableview 表现得像总指挥官的文件面板。我什至不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-23T20:00:34.147

您必须创建 NSTableView 类的子类。这是您如何做到这一点的基本示例。它使用空格键和鼠标右键处理选择，但它不处理鼠标右键拖动选择。

这个想法是在单选模式下使用 NSTableView 并实现替代选择。我们添加属性*markedRows*，然后使用它代替原来的*selectedRows*属性。

**FOTableView.h**

```
#import <Cocoa/Cocoa.h>

@interface FOTableView : NSTableView

@property (strong,nonatomic) NSMutableIndexSet *markedRows;

@end 
```

**FOTableView.m**

```
#import "FOTableView.h"

@implementation FOTableView

- (id)initWithFrame:(NSRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
    }

    return self;
}

-(NSMutableIndexSet *) markedRows
{
    if (!_markedRows) {
        _markedRows = [NSMutableIndexSet new];
    }
    return _markedRows;
}

- (void)drawRow:(NSInteger)row clipRect:(NSRect)clipRect
{
    if ([self.markedRows containsIndex:row]) {
        NSRect clipRect = [self rectOfRow:row];
        NSColor *color =  [NSColor colorWithCalibratedRed:0.932 green:0.046 blue:0.960 alpha:1.000];
        [color setFill];
        NSRectFill(clipRect);
    }

    [super drawRow:row clipRect:clipRect];
}

- (void)keyDown:(NSEvent *)theEvent
{
    NSString *keyString;
    unichar  keyChar;

    keyString = [theEvent charactersIgnoringModifiers];
    keyChar = [keyString characterAtIndex:0];
    NSInteger row = [self selectedRow];
    switch(keyChar){            
        case 32:
        {
             if (row != -1)
             {
                 if ([self.markedRows containsIndex:row]) {
                     [self.markedRows removeIndex:row];
                 }
                 else {
                     [self.markedRows addIndex:row];
                 }
             }
            [self selectRowIndexes:[NSIndexSet indexSetWithIndex:++row] byExtendingSelection:NO];
            [self setNeedsDisplay:YES];
            break;
        }

        default:
            [super keyDown:theEvent];
    }

    NSLog(@"key pressed: (%hu)%@", keyChar,keyString);
}

- (void)rightMouseDown:(NSEvent *)theEvent
{
    NSInteger row = [self rowAtPoint:[self convertPoint:[theEvent locationInWindow] fromView:nil]];
    if ([self.markedRows containsIndex:row]) {
        [self.markedRows removeIndex:row];
    }
    else {
        [self.markedRows addIndex:row];
    }

    [self setNeedsDisplay:YES];
}

@end 
```

# c# - 如何从 IQueryable 获取原始集合

> ID：12715827
> 
> 赞同：2
> 
> 时间：2012-10-03T19:53:44.410
> 
> 标签：c#, linq, iqueryable

考虑以下：

```
T[] itemArray = // initialized values
IQueryable<T> itemQuery = itemArray.AsQueryable().Where(*/some query*/).Skip(5).Etc() ... 
```

是否可以从中获取基础集合或数据集（在这种情况下`itemArray`）`itemQuery`？在我看来，如果在评估查询表达式时，必须根据原始集合对其进行评估，因此该集合必须存储在 IQueryable 中或由 IQueryable 引用。

如何才能做到这一点？

注意：
这是一个带有 MongoDB linq 驱动程序（来自 10gen）的更大项目的一部分，我们试图从基于 mongo 集合的 IQueryable 中提取原始 MongoCollection。尽管我们专门针对 MongoDB 使用 IQueryable<>，但这个问题的答案应该是 IQueryable<> 所固有的，因此独立于 MongoDB 驱动程序。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T19:58:24.293

最`IQueryable`有可能确实引用了底层集合（可能通过多个间接层），但它不会公开，因此您将无法访问它，至少不能以我认为的任何方式访问它会认为是*合理*的，而不是非常非常混乱的黑客行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-12T14:52:46.230

这是作弊，但也许在您的上下文中是有意义的：

```
interface IReferencedQueryable<T> : IQueryable<T>
{
    IEnumerable<T> Source { get; }
}

static class IReferencedQueryableExtensions
{
    public static IReferencedQueryable<T> AsReferencedQueryable<T>(
        this IEnumerable<T> source)
    {
        return ReferencedQueryable.From(source);
    }

    class ReferencedQueryable<T> : IReferencedQueryable<T>
    {
        public IEnumerable<T> Source { get; private set; }

        ReferencedQueryable(IEnumerable<T> source)
        {
            Source = source;
        }

        static IReferencedQueryable<T> From(IEnumerable<T> source)
        {
            return new ReferencedQueryable(source);
        }

        // all the IQueryable members would be 
        // implemented through AsQueryable()
        // ...
    }

    public static IReferencedQueryable<T> Where<T>(
        this IReferencedQueryable<T> source, 
        Expression<Func<T, bool>> predicate)
    {
        return ReferencedQueryable.From(
            ((IQueryable<T>)source).Where(predicate));
    }

    // do the same for all the Linq extension methos you want to support
} 
```

你会像这样使用它：

```
T[] itemArray = // initialized values
var itemQuery = itemArray.AsReferencedQueryable()
                         .Where(*/some query*/)
                         .Skip(5)
                         .Etc() ... 
```

当您需要您的源序列时，您可以通过`Source`成员访问它，可能通过`as`演员表。

```
var s = itemQuery.Source; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T19:58:43.210

不，每个查询都是独立执行的，剩下的就是查询本身的结果集。内存对象中没有任何内容包含原始集合，也没有对原始集合的任何可访问引用。考虑到原始集合现在可能为空或超出范围，即使允许这样做也是危险的。如果您需要原始集合，则需要将其保留在范围内，直到您完全完成它为止。

# python - 如何将科学计数法数字打印成相同的比例

> ID：12715828
> 
> 赞同：3
> 
> 时间：2012-10-03T19:53:47.087
> 
> 标签：python, numpy

我想在 python 中打印具有相同比例的科学计数法数字。例如，我有不同的数字`(1e-6, 3e-7, 5e-7, 4e-8)`，所以现在我想用`e-6`notation打印所有这些数字`(1e-6, 0.3e-6, 0.5e-6, 0.04e-6)`。那么如何打印呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:45:08.177

使用`log10`：

```
In [64]: lis= (1e-6, 3e-7, 5e-7, 4e-8)

In [65]: import math

In [66]: for x in lis:
    exp=math.floor(math.log10(x))
    num=x/10**exp              
    print "{0}e-6".format(num*10**(exp+6))
   ....:     
   ....:     
1.0e-6
0.3e-6
0.5e-6
0.04e-6 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T19:59:07.023

从数学上讲，附加`e-6`与乘以相同`1e-6`，对吧？

因此，您有一个数字`x`，并且您想知道如何`y`使用它`y * 1e-6 == x`。

因此，只需乘以 1e6，以非指数格式呈现，然后附加`e-6`为字符串：

```
def e6(x):
  return '%fe-6' % (1e6 * x,) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T20:59:43.480

当你使用 numpy 时，你一定要看看这个[`np.set_printoptions`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.set_printoptions.html)函数，特别是它的`formatter`参数，它需要一个像`{'float': formatting_function}`. 为您的特定情况使用最合适的格式化功能。

# python - 在 Flask 中，为什么这个 hello world 应用程序可以工作？

> ID：12715834
> 
> 赞同：6
> 
> 时间：2012-10-03T19:54:10.083
> 
> 标签：python, flask

查看 Flask 网站上默认的“Hello world”脚本：

```
from flask import Flask
app = Flask(__name__)

@app.route("/")
def hello():
    return "Hello World!"

if __name__ == "__main__":
    app.run() 
```

我对编程很陌生，所以我不明白这个脚本是如何工作的——这个`hello()`函数不会在任何地方调用，那么 Flask 是否只是显示找到的第一个函数的输出？如果我想在页面上显示两个或三个函数的输出怎么办？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-03T19:58:23.177

这一行：`@app.route("/")`将函数注册为 '/' 路由的处理程序。当浏览器查询“/”（根）时，应用程序会响应“Hello World！”。

该`@`语法称为装饰器。

[如何制作功能装饰器链？](https://stackoverflow.com/questions/739654/understanding-python-decorators)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-27T17:19:16.027

例如看一下这段代码：

```
def decorator(func):
    print "this function is called for " + func 
    def wrapper(*args, **kwargs):
            return func(*args, **kwargs)
    return wrapper

@decorator
def hello():
    return "Hello" 
```

将其保存到文件中并尝试一下，您会看到在定义 hello 后您会看到如下内容：

> 此函数为 <function hello at 0x241c70> 调用

# php - 如何使用 php 以 html 形式执行多个操作？

> ID：12715835
> 
> 赞同：0
> 
> 时间：2012-10-03T19:54:13.427
> 
> 标签：php, javascript, action

```
$i=0;
echo '<html><body>';
echo '<form name="Form1" enctype="multipart/form-data" action="'."https://xxx/".$uid[$i]."/send".'" method="POST">';
echo '<input name="message" type="text" value=""><br/><br/>';
echo '<input type="submit" value="SEND" /><br/>';
echo '</form>';
echo '</body></html>'; 
```

uid 数组有 500 个元素，因此应该执行 500 个操作。

我想执行这样的多个动作。我希望你能通过我的代码得到它。请告诉如何做到这一点或请提供一些替代方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T19:56:34.220

嗯，在这种情况下我要做的只是将表单发布到 1 个 php 页面，然后在该 php 页面上执行您想要完成的所有操作。我从未听说过将表格张贴到多个位置，并且认为这是不可能的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:04:20.340

如果您正在尝试做我认为您正在尝试做的事情，并且向您网站上的所有用户发送相同的消息，那么您做错了。

实现某种公告模块，所有用户都可以在他们的收件箱中看到。如果您不想向所有用户发送消息，而只想向较小的群组发送消息，请在您的网站中实施群组。

HTML 表单不能提交到多个位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T20:00:07.913

使用 javascript 函数提供操作 url 并提交。保留表单 target = "_parent" 但这似乎只是垃圾邮件。

# magento - 仅使用类别名称查找类别是否存在

> ID：12715836
> 
> 赞同：3
> 
> 时间：2012-10-03T19:54:14.863
> 
> 标签：magento, import

我正在为 Magento 构建一个自定义产品导入模块，并且以前从未与 Magento 合作过。

我有一个包含所有产品的 CSV 文件。其中一列包含产品应分配到的类别，用斜杠分隔。前任：

```
Jewelry / Rings / Diamond
Jewelry / Neckless / Diamond 
```

等等。

我遇到的问题是 Diamond 类别可以作为子类别存在于任意数量的父类别中。我的解决方案是打破路径（即 expload($categoryPath, "/"))

使用第一个示例（珠宝/戒指/钻石），我从商店根类别开始，检查它是否包含珠宝的子类别，如果包含，我获取该子类别的 ID 并递归地到达终点线，或者至少这是理论。

我遇到的问题就在这里...

```
$rootCategory = Mage::getModel('catalog/category') -> load($rootCategoryId);
$currentCategory = $rootCategory -> getChildrenCategories() -> loadByAttribute('name', $targetCategoryName); 
```

这会给我一个错误...“在非对象中调用成员函数 getName()”...我假设是因为 getChildrenCategories() 正在返回一个集合，而我无法对其调用 loadByAttribute。

如果这对任何人都有意义，请告诉我如何仅使用名称从根类别加载子类别。我希望如果 loadByAttribute 无法加载类别（因为它不存在），它将返回 False，然后我可以创建类别。

* * *

为了回应 Pavels 的建议，我尝试了：

```
$targetCategoryName = 'Jewelry';

$subCategories = $rootCategory
                    -> getChildrenCategories()
                    -> addAttributeToFilter('name',$targetCategoryName) 
                    -> setCurPage(1)
                    -> setPageSize(1)
                    -> load();

    $currentCategory = $subCategories
                    -> getFirstItem(); 
```

$currentCategory 的名称是“dummy-category”。过滤器似乎不起作用。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-04T08:58:23.007

根据您的问题，我认为您需要根据父类别按名称查找类别，即仅搜索其子类别？

如果是这样的话……

```
$childCategoryName = 'Bedroom';
$parentCategoryId = 10;

$parentCategory = Mage::getModel('catalog/category')->load($parentCategoryId);
$childCategory = Mage::getModel('catalog/category')->getCollection()
    ->addAttributeToFilter('is_active', true)
    ->addIdFilter($parentCategory->getChildren())
    ->addAttributeToFilter('name', $childCategoryName)
    ->getFirstItem()    // Assuming your category names are unique ??
;

if (null !== $childCategory->getId()) {
    echo "Found Category: " . $childCategory->getData('name');
} else {
    echo "Category not found";
} 
```

* * *

您的原始代码走在了正确的轨道上：

```
$currentCategory = $rootCategory -> getChildrenCategories() -> loadByAttribute('name', $targetCategoryName); 
```

但问题是它`$rootCategory->getChildrenCategories()`返回一个集合，因此您需要过滤它，而不是`loadByAttribute`对模型起作用。

但是，`$rootCategory->getChildrenCategories()`返回一个加载的集合，所以不幸的是你仍然无法过滤它。因此，我的答案中的代码略有不同 - 尽管其背后的逻辑相同。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T20:25:32.163

试试这个

```
<?php
$name = 'Furniture';
$categories = Mage::getResourceModel('catalog/category_collection');
$categories->addAttributeToFilter('is_active', 1)
        ->addAttributeToFilter('name', $name)
        ->setCurPage(1)->setPageSize(1)
        ->load();

if ($categories->getFirstItem()) {
    $category = $categories->getFirstItem();
    echo $category->getId();
} else {
    echo 'No category exists with the name ' . $name;
} 
```

# php - 在 PHP 中从 utf-8 十六进制代码转换为字符

> ID：12715840
> 
> 赞同：5
> 
> 时间：2012-10-03T19:54:37.697
> 
> 标签：php, utf-8

我有十六进制代码 c2ae，如何将其转换为 UTF-8 字符：®。对于任何十六进制代码，我都需要一个通用且简单的解决方案。

更新：这应该适用于任何 utf-8 十六进制代码，如 d0a6

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-03T20:35:17.277

```
function hexStringToString($hex) {
    return pack('H*', $hex);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-09-25T08:08:09.447

我敢肯定，自从 4 年前您提出这个问题以来，您一定已经找到了解决方案，但是当我在寻找东西时，我讨厌在 Google 上找到未回答的问题。

您可以使用以下方法在 PHP 中创建包含十六进制字符的字符串：

```
$string = "\xc2\xae";
$string2 = "\xd0\xa6";
echo $string;
echo $string2; 
```

哪个会输出`®Ц`。

PHP 的语言参考[在标题“双引号”下]。

您还可以使用`\22`语法使用八进制字符串，并且在 PHP7 中使用`\u`语法添加了 unicode 代码点支持。这需要`{}`围绕代码，如：`\u{1000}`.

快乐编码！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-03T07:14:41.303

首先，您需要安装 PHP 扩展“mbstring”。我在 Windows 上安装了 XAMPP，默认情况下安装了所有内容。接下来，我们使用以 mb_ 开头的函数，在我们的例子中是 mb_chr()。

例子：

```
<?php
echo mb_chr(0x1F621);
?> 
```

# php - 限制图片上传文件大小

> ID：12715841
> 
> 赞同：0
> 
> 时间：2012-10-03T19:55:06.143
> 
> 标签：php, upload, limit

目前我有php验证如下

```
if ($_FILES["file"]["size"] > 5120) 
{
$_SESSION['error'] = 'Upload FAILED, file is too large !';
header("Location: upload.php");
exit;
} 
```

但这似乎并没有阻止任何大文件的上传！非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T19:58:53.477

使用它来限制上传文件的大小：

```
$max_size = /* whatever */; //File Size in Bytes

if(filesize($_FILES['userfile']['tmp_name']) > $max_size) {
      die('The file you uploaded is too large.');
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T19:59:44.893

采用`upload_max_filesize`

可以在 php.ini、.htaccess、httpd.conf 或 .user.ini 中设置条目

[http://www.php.net/manual/en/ini.core.php#ini.upload-max-filesize](http://www.php.net/manual/en/ini.core.php#ini.upload-max-filesize)

# objective-c - 用objective-c打电话IOS6不起作用

> ID：12715845
> 
> 赞同：2
> 
> 时间：2012-10-03T19:55:15.887
> 
> 标签：objective-c, ios6

我试过下面的代码：

```
NSString *phoneStr = [[NSString alloc] initWithFormat:@"tel://%@",[[dCliente objectAtIndex:1] stringByReplacingOccurrencesOfString:@"-" withString:@""]];
NSURL *url = [[NSURL alloc] initWithString:phoneStr];
[[UIApplication sharedApplication] openURL:url ];
[phoneStr release];
[url release]; 
```

有人可以告诉我可能是什么问题吗？我用IOS6直接在iPhone上测试

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:08:23.350

这个怎么样：

```
NSString *phoneStr = [[NSString alloc] initWithFormat:@"tel:%@",[[dCliente objectAtIndex:1] stringByReplacingOccurrencesOfString:@"-" withString:@""]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T15:35:34.733

感谢您的回答，问题是 tel:// 和电话号码之间的空格。我这样做了：

```
stringByReplacingOccurrencesOfString:@" " withString:@"" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T20:08:01.060

去掉`//`中间`tel:`和数字。请参阅[iOS 5 电话链接不起作用](https://stackoverflow.com/questions/8233509/ios-5-tel-link-not-working)。

# c - 如何管理向上的管道和向下的进程二叉树？

> ID：12715848
> 
> 赞同：0
> 
> 时间：2012-10-03T19:55:31.167
> 
> 标签：c, fork, pipe, file-descriptor

我正在尝试创建一个进程的二叉树，其中每个父进程通过管道连接到它的两个子进程。

问题：父进程 A 创建两个进程（B 和 C）和两个管道，每个进程一个。它们的文件描述符存储在 fd 中。在第二次迭代中，B 产生了它的两个孩子。B 用新管道的文件描述符覆盖存储在 fd 中的文件描述符。在生成我的 n 个级别之后，唯一剩下的管道是其父节点的叶节点（向上一级）。

我已经测试了这个理论，唯一可以交流的东西是在树的底部，叶子到上一层。我必须做到这一点，这样叶子节点才能在树上一直与主进程通信。

我是管道的新手，所以我可能会离开我的解释。

我的理解是否正确，我应该怎么做才能解决这个问题？

示例代码：

```
#define READ 0
#define WRITE 1

int fd[2][2];

void
spawnChildren(int levels)
{
    if(levels == 0)
       return;

    pipe(fd[0]);
    //spawns 2 children at a single parent
    int pid = fork();
    //parent
    if(pid > 0)
    {
        close(fd[0][WRITE]);
        pipe(fd[1]);
        int pid2 = fork();
        //child B
        if(pid2 == 0)
        {
            close(fd[1][READ]);
            spawnChildren(levels-1);
            return;
        }
        //parent
        else
            close(fd[1][WRITE]);
    }
    //child A
    else
    {
        close(fd[0][READ]);
        spawnChildren(levels-1);
        return;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:21:59.580

如果我理解正确的话，根进程已经打开*了两个*fd 来与它的两个子进程进行通信。然后他们只是打开其他独立的管道。

*当他们是四个*时，根进程如何与它的侄子通信？

您需要保持*所有*fd 的打开状态；每个进程必须从其子进程获取输入，并将其传递给其父进程；你需要某种协议来整理它们。数据下降也是如此。

例如，根父想要与其左孩子的右孩子的左孩子进行通信：

*   它将 RL.HELLO WORLD 发送给它的左孩子
*   左孩子看到 R 并向其右孩子发送#L.HELLO WORLD
*   右孩子收到#L.HELLO WORLD 并向左孩子发送##.HELLO WORLD
*   左孩子收到##.HELLO WORLD 并知道消息是给它的

*   左边的孩子回答发送##.I HEAR YOU给它的父母

*   父母看到它的左孩子在说话，将最后一个#转换为L并向上发送
*   父母看到它的右孩子说#LI HEAR YOU 并发送 RL.I HEAR YOU
*   根从它的左孩子那里收到 RL.I HEAR YOU 并且知道是谁发起了它

当然，此时每个进程还必须有一个用于传入和传出消息的队列。

即使只在根和叶子之间进行通信也需要队列和消息传递；它只允许不使用“R#L”协议，但考虑到它的简单性，这是一个非常小的节省。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:46:24.317

您需要的是一个线程或进程侦听（读取）每个管道，然后将其写入相应的管道。基本上每个“节点”都需要两个线程或进程来执行此操作，每个子节点一个。

这不是非常可扩展的，并且根据您尝试做的事情，如果您不能更好地设计它，您可能需要重新评估。一个建议是让您的叶节点写入临时文件而不是管道，然后让您的顶层智能地读取这些文件，而不是尝试通过分叉管理所有这些管道。这样做可以大量减少“节点”的数量。只是一个想法。

# inheritance - 在 phing 构建文件中，当我导入另一个构建文件然后从该构建文件覆盖目标时，有没有办法执行父目标？

> ID：12715855
> 
> 赞同：1
> 
> 时间：2012-10-03T19:55:45.313
> 
> 标签：inheritance, import, phing

在 phing 构建文件中，当我导入另一个构建文件然后从该构建文件覆盖目标时，有没有办法执行父目标以“附加”功能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T11:24:52.627

是的，这是可能的：只需使用目标的全名，例如`$parentProjectname.$targetname`. 运行时也会列出这些

```
 $ phing -l 
```

# c# - 使用 interop.word 范围

> ID：12715858
> 
> 赞同：0
> 
> 时间：2012-10-03T19:55:46.920
> 
> 标签：c#, interop, ms-word, ms-office, office-interop

我无法弄清楚如何使用单词范围。我有要添加到 word 文件中的图片文件，但我不知道如何在图片之间添加文本和表格。我想要的结构是这样的：文本、表格、图片。然后重复。

但是，当我添加文本或表格时，它们都是在四张图片之后添加的区域，它们位于文件的顶部。我一直在阅读，我发现我需要使用范围来指定要放置表格/文本的位置，但是我找到的所有资源都只显示了如何在页面顶部添加。

表格： http: [//msdn.microsoft.com/en-us/library/w1702h4a.aspx](http://msdn.microsoft.com/en-us/library/w1702h4a.aspx) 文本：http: [//msdn.microsoft.com/en-us/library/6b9478cs.aspx](http://msdn.microsoft.com/en-us/library/6b9478cs.aspx)

这是我添加图片的方式：

```
 Word.Application wdApp = new Word.Application();
        wdApp.Visible = true;

        Document doc = wdApp.Documents.Add();

        foreach (var category in type){
                // add table/text
                doc.Application.Selection.InlineShapes.AddPicture(@path + "\\" + category + "_" + DateTime.Now.ToString(datePatt) + ".jpg");
            } 
```

我希望能够在图片之前添加我的文本/表格，但似乎我必须在文件中指定范围。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-05T18:19:20.310

这可能与您之前的问题之一重复：[如何使用 word interop 将项目一次添加到新行一个 word 文档](https://stackoverflow.com/questions/12718044/how-to-add-items-one-at-a-time-to-to-a-new-line-a-word-document-using-word-inter)

请参阅我之前对您的类似问题的回答：[https](https://stackoverflow.com/a/12751805/700926) ://stackoverflow.com/a/12751805/700926 - 它简要说明了如何完成此操作以及 C# 中的完整示例实现。

# c# - 互操作 Excel UsedRange

> ID：12715863
> 
> 赞同：0
> 
> 时间：2012-10-03T19:56:11.250
> 
> 标签：c#, excel, interop

我通过 C# 中的互操作 excel 对象使用 UsedRange 来获取工作表的最后一行。工作表是新创建的，仅编辑了 Name 属性。但是，当我得到 ws.UsedRange.Rows.Count 时，我得到了超过 10k。为什么这不给我 0 或 1？我怎样才能得到真正的最后一行？

```
Application xlApp = null;
            Worksheet temp;
            Range cell;
            int row;
            int col;
            int i;
                xlApp = new Application();
                xlApp.Visible = true;
                Workbook wbDetail = xlApp.Workbooks.Add();
                wbDetail.Worksheets.Add(Type.Missing, Type.Missing, 26, XlWBATemplate.xlWBATWorksheet);  
                i = 0;
                while(i < 29)
                {
                    temp = (Worksheet)wbDetail.Worksheets[i+1];
                    temp.Name = "TITLE_"+i
                    i++;
                }

         DateTime reqdate;
         i=0;
         while(i<29)
                {
                        temp = (Worksheet)wbDetail.Worksheets["TITLE_"+i];
                        int j = 0;
                        temp.get_Range("A1", Type.Missing).Value = "TITLE STUFF";
                        row = temp.UsedRange.Rows.Count;
                        while(j < 50)
                        {
                            cell = (Range)temp.Cells[row+1, j+1];
                            cell.Value = j;
                            j++;
                        }
                    }
                   i++
                }
                wbDetail.Save(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:21:10.423

在某些条件下（不确定它们是什么），Excel 将“使用”没有任何实际值的行（除了空白、空等）。

我过去这样做的方法是将工作表的值加载到数组*中，然后向后循环遍历数组的行，直到其中一列具有非空白值。

*- 我强烈建议不要`Cells[i,j]`在循环中调用。将值加载到数组中，然后遍历数组：

```
var tempValues = temp.Value;
...
while(j < 50)
{
    tempValues[row+1, j+1] = j
    j++;
}
temp.Value = tempValues 
```

# javascript - 当 javascript 更改容器大小时，Box-shadow 无法正确重新渲染。(IE9/10)

> ID：12715864
> 
> 赞同：1
> 
> 时间：2012-10-03T19:56:14.270
> 
> 标签：javascript, internet-explorer, css

我最近在 IE9 和 IE10 中交叉测试设计时遇到了这个问题。这是codepen上的简化版本。[http://codepen.io/jimmykup/full/DHeBC.com](http://codepen.io/jimmykup/full/DHeBC.com)（这里是实际问题的屏幕截图：http: [//i.imgur.com/xEQ52.png](http://i.imgur.com/xEQ52.png)）

1.  首先 jQuery 将一些 HTML 附加到容器中。
2.  当您将鼠标悬停在容器上时，我使用 .remove() 删除相同的 HTML。
3.  因为 HTML 被移除，父容器（带有 box-shadow）的高度发生了变化。
4.  在 IE9+ 中，box-shadow 保留在容器中，但它也留下了第二个阴影，盒子用来拉伸到的地方。

在最新版本的 Firefox、Chrome 和 Opera 中一切正常。IE9 和 10 是问题所在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-04T20:24:18.117

只需在带有阴影的元素上重新绘制即可。要导致重绘，请更改 z-index。在您的情况下，将其添加到您`$('form').hover`的删除后。您可以使用下面的代码将其更改为之前的 z-index，或者简单地将其设置为 1。

```
$('#lightning-deal').css('z-index', $('#lightning-deal').css('z-index')); 
```

# nginx - Nginx 没有在启用的站点中拾取站点？

> ID：12715871
> 
> 赞同：124
> 
> 时间：2012-10-03T19:56:56.620
> 
> 标签：nginx

经过10多个小时的研究，我还没有弄清楚为什么这不起作用！我正在尝试将我的本地主机移动到 /etc/nginx/sites-enabled/default 中的启用站点的文件夹。

它是来自站点可用文件夹的符号链接。使用以下配置时，我使用 localhost:8080 作为我的地址得到“无法连接”

nginx.conf (/usr/local/nginx/conf/nginx.conf):

```
user  www-data;
worker_processes  2;

events {
    worker_connections  1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;

    keepalive_timeout  65;

    include /etc/nginx/sites-enabled/*; 
} 
```

站点可用（/etc/nginx/站点可用/默认）：

```
server {
  listen   8080;
  root /home/myusername/myown/customdirectory;
  index index.php index.html index.htm;
  server_name localhost;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location /doc/ {
        alias /usr/share/doc/;
        autoindex on;
        allow 127.0.0.1;
        allow ::1;
        deny all;
    }

    error_page 404 /404.html;

    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
        root /usr/share/nginx/www;
    }

    location ~ \.php$ {
        fastcgi_split_path_info ^(.+\.php)(/.+)$;
        fastcgi_pass unix:/var/run/php5-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
    }

    location ~ /\.ht {
        deny all;
    }
} 
```

如果我将可用站点中的相关信息放在 nginx.conf 中，我可以让它工作，我只是不明白为什么它不能这样工作？

谢谢！

* * *

## 回答 #1

> 赞同：210
> 
> 时间：2013-01-01T04:22:22.860

我有同样的问题。这是因为我不小心使用了符号链接的相对路径。

你确定你使用了完整的路径，例如：

```
ln -s /etc/nginx/sites-available/example.com.conf /etc/nginx/sites-enabled/example.com.conf 
```

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2017-01-03T21:11:25.117

变化自：

```
include /etc/nginx/sites-enabled/*; 
```

至

```
include /etc/nginx/sites-enabled/*.*; 
```

解决了我的问题

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-01-03T22:00:44.157

包括`sites-available/default`在`sites-enabled/default`. 它只需要一行。

在`sites-enabled/default`（新配置版本？）：

*似乎包含路径是相对于包含它的文件*

```
include sites-available/default; 
```

请参阅[`include`文档](http://nginx.org/en/docs/ngx_core_module.html#include)。

* * *

我相信某些版本的 nginx 允许纯粹通过使用包含文件的相对路径的单行来包含/链接到其他文件。（至少在我一直使用的一些“继承”配置文件中是这样的，直到新的 nginx 版本破坏了它们。）

在`sites-enabled/default`（旧配置版本？）：

*似乎包含路径是相对于当前文件的*

```
../sites-available/default 
```

# redis - capistrano成功启动redis-server，但我登录时没有运行

> ID：12715874
> 
> 赞同：2
> 
> 时间：2012-10-03T19:57:03.397
> 
> 标签：redis, capistrano, vagrant

我有一个可以控制我的 redis 服务器的 capistrano 脚本。这是有问题的任务：

```
 %w[start stop restart].each do |cmd|
    desc "#{cmd}s redis-server"
    task cmd, :roles => :app do
      run "#{sudo} /etc/init.d/redis-server #{cmd}"
    end
  end

When I run this (deploying to a local vagrant VM) it says it's starts successfully:

    > cap local redis:start

    triggering load callbacks
  * executing `local'
Deploying branch master
    triggering start callbacks for `redis:start'
  * executing `multistage:ensure'
  * executing `redis:start'
  * executing "sudo -p 'sudo password: ' /etc/init.d/redis-server start"
    servers: ["192.168.33.10"]
Password: 
    [192.168.33.10] executing command
 ** [out :: 192.168.33.10] Starting redis-server:
 ** [out :: 192.168.33.10] redis-server.
    command finished in 2054ms 
```

但是，当我 ssh 进入时，redis-server 没有运行。如果我手动启动它，它就可以工作：

```
> sudo /etc/init.d/redis-server start 
```

我得到与上面相同的输出，只是这次进程保持运行。

查看日志，`/var/log/redis/redis.log`文件为空。

任何想法我做错了什么？我启动了其他类似的服务（nginx、unicorn、mysql 等），这些服务运行良好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-07T19:15:25.720

我相信一旦 ssh 连接终止，redis 进程就会结束。

尝试将*nohup*添加到您的脚本中：

```
run "#{sudo} nohup /etc/init.d/redis-server #{cmd}" 
```

# c# - 将 linq 查询语法转换为包含在 where 中的方法 synatx

> ID：12715877
> 
> 赞同：0
> 
> 时间：2012-10-03T19:57:06.217
> 
> 标签：c#, linq

我想把这个查询语法转换成方法语法，傻但是糊涂

```
List<int> x = new List<int>();
// code to fill list
from ug in DataContext.UserGroups
where (
    from f in x
    select f    
).Contains(ug.ID)
select ug; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:00:22.107

`var results = DataContext.UserGroups.Where(ug => x.Contains(ug.ID)).Select(ug => ug.ID);`

我想这就是你想要的。您在问题中输入的代码不是 100% 完整的。您是否只是想获取`UserGroups`int 列表中的 ID？如果您只想要该`UserGroups`匹配项，请删除`.Select`我的查询部分。

要获得该`UserGroups`匹配项：

`var results = DataContext.UserGroups.Where(ug => x.Contains(ug.ID));`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T20:01:41.733

如果我正确阅读了您的问题，这应该会给您想要的结果：

```
DataContext.UserGroups.Where(ug => x.Contains(ug.Id)) 
```

# javascript - 重置 jQuery IsoTope 过滤器和排序

> ID：12715885
> 
> 赞同：1
> 
> 时间：2012-10-03T19:57:24.387
> 
> 标签：javascript, jquery, jquery-plugins, jquery-isotope

我有许多 jQuery 同位素*过滤器*和一个*sort*。一切都很好，但我想创建一个**重置按钮**。

我尝试了以下方法（stackoverflow：[重置所有组合过滤器](http://stackoverflow.com/questions/10297558/isotope-reset-all-combination-filters)），但是虽然它似乎确实重置了项目（在第二次点击时），但它并没有重置过滤器按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T00:54:07.240

我只能假设您在写作时的意思是“它不会重置过滤器按钮**的外观”**

> [...] 它不会重置过滤器按钮。

如果是这种情况，并且您的过滤器按钮的外观是由 CSS 类控制的，就像在 Isotope 的示例中一样，您只需在用户单击“重置”时从过滤器按钮元素中删除所述 CSS 类“-按钮。

在例如[Isotope 的“组合过滤器”演示](http://isotope.metafizzy.co/demos/combination-filters.html)的源代码中，您会发现以下代码可以处理单击某个过滤器按钮时发生的所有事情：

```
// filter buttons
$('.filter a').click(function(){
  var $this = $(this);
  // don't proceed if already selected
  if ( $this.hasClass('selected') ) {
    return;
  }

  var $optionSet = $this.parents('.option-set');
  // change selected class
  $optionSet.find('.selected').removeClass('selected');
  $this.addClass('selected');

  // store filter value in object
  // i.e. filters.color = 'red'
  var group = $optionSet.attr('data-filter-group');
  filters[ group ] = $this.attr('data-filter-value');
  // convert object into array
  var isoFilters = [];
  for ( var prop in filters ) {
    isoFilters.push( filters[ prop ] )
  }
  var selector = isoFilters.join('');
  $container.isotope({ filter: selector });

  return false;
}); 
```

与您的问题相关的重要代码（希望如此）可以在以下几行中找到：

```
$optionSet.find('.selected').removeClass('selected');
$this.addClass('selected'); 
```

*   第一行从 $optionSet 中的所有元素中删除所有“选定”类（后者只是针对单个过滤器属性的一组按钮）
*   第二个为用户单击的元素设置“选定”类

# java - SWT 文本组件不会水平填充

> ID：12715886
> 
> 赞同：0
> 
> 时间：2012-10-03T19:57:37.367
> 
> 标签：java, layout, swt

我与 SWT 合作，在按我想要的方式布置事情时遇到了一些问题。本质上，我有一个`Text`对象，我希望它的宽度是它所在的组件的宽度。我可以使用`FillLayout`，但它下面的按钮也会变大，这不是我想要的。

这是一个屏幕截图来说明问题：
![在此处输入图像描述](../Images/a83f197bf873514168002f88722b0a77.png)

这是我用来重现的测试代码，并尝试解决问题：

```
import org.eclipse.swt.SWT;
import org.eclipse.swt.layout.GridData;
import org.eclipse.swt.layout.GridLayout;
import org.eclipse.swt.widgets.Button;
import org.eclipse.swt.widgets.Display;
import org.eclipse.swt.widgets.Shell;
import org.eclipse.swt.widgets.Text;
import org.eclipse.wb.swt.SWTResourceManager;

public class Test {

    public static void main(String[] args) {
        Display display = new Display();
        Shell shell = new Shell(display);

        shell.setBackground(SWTResourceManager.getColor(SWT.COLOR_WHITE));
        //setup the layout manager      
        GridLayout layout = new GridLayout(1, false);
        layout.horizontalSpacing = 0;
        layout.marginHeight = 0;
        layout.verticalSpacing = 5;
        layout.marginWidth = 0;
        layout.marginBottom = 20;
        layout.marginTop = 5;       

        shell.setLayout(layout);

        //create the text field
        Text inputField = new Text(shell, SWT.BORDER);
        GridData data =  new GridData();
        data.horizontalAlignment = GridData.FILL;
        data.grabExcessHorizontalSpace = true;
        inputField.setData(data);

        //create the button
        Button lookup = new Button(shell, SWT.PUSH);
        lookup.setText("Lookup");       

        shell.pack();
        shell.open();

        while (!shell.isDisposed()) {
            if (!display.readAndDispatch()) display.sleep();
        }
    }
} 
```

我认为这只是我没有在`GridData`对象上为 正确设置一些东西`inputField`，但不管它是什么，我绝对没有看到它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T20:25:54.087

您必须使用`setLayoutData()`来设置`GridData`not `setData()`：

```
Text inputField = new Text(shell, SWT.BORDER);
GridData data =  new GridData();
data.horizontalAlignment = SWT.FILL;
data.grabExcessHorizontalSpace = true;
inputField.setLayoutData(data); 
```

BTW：`GridData.FILL` [不推荐](http://help.eclipse.org/helios/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/swt/layout/GridData.html#FILL)使用，`SWT.FILL`改用。

# javascript - 在画布元素上绘制矢量：如何生成矢量字符串

> ID：12715888
> 
> 赞同：2
> 
> 时间：2012-10-03T19:57:42.650
> 
> 标签：javascript, html5-canvas, vector-graphics, kineticjs

对于我目前正在做的一个项目，我需要实现一个交互式画布元素。画布上会有一个形状，它被划分为多个子区域。用户应该能够从中选择子区域并对选定区域应用不同的颜色。[这些区域不是正方形或圆形，而是自定义路径]

这包含一些类似于我想要实现的东西。它使用动力学.js。它展示了如何使用 Kinetic.path() 方法绘制世界地图 - 每个国家都有矢量字符串。

请让我上线以获得类似的脚形/或任何其他形状。我应该如何获得这个向量字符串来绘制想要的形状？

这是最好的方法吗？

此文件 ( [http://raphaeljs.com/world/world.js](http://raphaeljs.com/world/world.js) ) 包含世界地图的矢量字符串。我不确定他们是如何生成它的。这就是我感兴趣的地方。

有没有办法从图片生成矢量字符串？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T21:32:30.573

使用 svg 编辑器（例如这个[在线 svg 编辑器](http://svg-edit.googlecode.com/svn/branches/2.5.1/editor/svg-editor.html)）。然后导入您的图片并使用路径追溯图片的元素。

# php - 解析包含图像数据的文本文件

> ID：12715889
> 
> 赞同：1
> 
> 时间：2012-10-03T19:57:52.800
> 
> 标签：php, javascript, regex

我已经能够使用来自[http://www.imagemagick.org](http://www.imagemagick.org)的 Imagemagick 从文本文件中读取数据。

我明白了

```
0,0: (255,255,255,  0)  #FFFFFF00  srgba(255,255,255,0)
1,0: (255,255,255,  0)  #FFFFFF00  srgba(255,255,255,0)
2,0: (255,255,255,  0)  #FFFFFF00  srgba(255,255,255,0)

40,23: (162,167, 32, 24)  #A2A72018  srgba(162,167,32,0.0941176)
41,23: (255,255,255,  0)  #FFFFFF00  srgba(255,255,255,0)
42,23: (162,166, 48, 40)  #A2A63028  srgba(162,166,48,0.156863)
43,23: (162,166, 47, 40)  #A2A62F28  srgba(162,166,47,0.156863) 
```

我不擅长正则表达式，我会使用什么样的表达式来获取开头的坐标和结尾的 rgba()。

好的，我有点想通这里的正则表达式是它的一部分

```
/rgba\([0-9]{1,3},[0-9]{1,3},[0-9]{1,3},[0-9]\.[0-9]{1-9}/gi 
```

但最后一部分与 rgba() 的小数部分不匹配。

好的，我知道它已经有一段时间了，我不确定我是否应该开始一个新线程

但我已经想出了如何删除以删除两个中间部分，所有括号和 srgba，还有零 alpha 的行，但不知何故它在文本文件中留下了一个开放空间。如果有任何人都可以看到的任何改进。

```
$fh = fopen("pcmanD.txt", "r");
$fg = fopen("pcmanJ.txt", "wt");
$new_array = ""; $parts = "";
while (!feof($fh)) {
    $line = fgets($fh);
    $lines[] = $line;
    $newword = "";
    $match1 ="/:\s?\s?\(\s?\s?\d+,\s?\s?\d+,\s?\s?\d+,\s?\s?\d+\)\s?\s?#[a-zA-Z0-9]{6,8}\s?\s?srgba/";
    $match2 ="/^\s\s?/";
    $match3 = "/\s\(/";
    $match4 = "/\)/";
    $match5 = "/[0-9]{1,3},[0-9]{1,3},[0-9]{1,3},[0-9]{1,3},[0-9]{1,3},0[^\.]/";

    $parts1 = preg_replace($match1,"", $line );
    $parts2 = preg_replace($match2,"", $parts1 );
    $parts3 = preg_replace($match3,",", $parts2 );
    $parts4 = preg_replace($match4,"", $parts3 );
    $parts5 = preg_replace($match5,"",$parts4);

    echo "<pre>";
    print_r($parts5);
    echo "</pre>";

    fwrite($fg, $parts5);
} 

fclose($fg);
fclose($fh); 
```

但是这段代码出现了新问题，我在比赛后的浮点数上得到了两倍或三倍。

```
$thisisit[] = "";
$thisisit2[] = "";
$countThis = 0;
$fh = fopen("sometext.txt", "r");
$new_array = ""; $parts = "";
while (!feof($fh)) {
    $line = fgets($fh);
    $line2 = $line;
    $newword = "";
    $match1 ="/^\s*?[\d]+,[\d]+/";
    $parts1 = preg_match($match1, $line, $regs);
    foreach($regs as $key => $lame) {
        $thisisit[] = $lame;
    }
    $match2 ="/(?:(\d{1,3},\d{1,3},))(\d{1,3},\d{1,3},\d{1,3},[01][\.]?[\d]*)/";
    $parts2 = preg_match($match2, $line2, $regs2);
    foreach($regs2 as $key2 => $lame2) {
        $thisisit2[] =$lame2;
    }
    $countLame = count($thisisit);
} 

echo "</script>";
$newCounter = 0;
for($i = 0; $i < (500); $i++) {
    echo  $thisisit[$i] . "<br />";
    echo $thisisit2[$newCounter] . "<br />" ;
    $newCounter = $newCounter +4;
}
fclose($fh); 
```

这是我正在处理的文本文件中的一些文本

```
 42,23,162,166,48,0.156863
 43,23,162,166,47,0.156863
 44,23,167,170,67,0.219608
 45,23,162,166,47,0.156863
 46,23,167,170,67,0.219608
 47,23,162,166,37,0.117647
 48,23,162,167,32,0.0941176
                                      86,23,163,167,40,0.12549
 87,23,160,164,47,0.164706
 88,23,188,190,122,0.352941
 86,24,233,234,197,0.486275
 87,24,251,250,250,1
 88,24,251,250,250,1
 89,24,251,250,250,1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:25:20.487

```
> '0,0: (255,255,255,  0)'.match(/^([^:]+) *: *\(([^)]+)\)/)
[ '0,0: (255,255,255,  0)',
  '0,0',
  '255,255,255,  0',
  index: 0,
  input: '0,0: (255,255,255,  0)' ] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:36:17.663

```
/^(\d+,\d+):.*\(([^)]*)\)$/ 
```

这应该将坐标拉入捕获组 1，并将 RGBA 值拉入组 2。但请注意，如果这对您很重要，使用字符串操作可能更有效。您可以拆分字符串`:`以获取坐标，然后拆分`srgba(` 并切掉颜色值的最后一个字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:05:07.360

# 示例 #1：

如果您有多条线路`$input`

### 代码

```
$input = '
    0,0: (255,255,255,  0)  #FFFFFF00  srgba(255,255,255,0)
    43,23: (162,166, 47, 40)  #A2A62F28  srgba(162,166,47,0.156863)
';
preg_match_all('~^\s*(.+?):.+srgba\((.+?)\)\s*$~m', $input, $match);
print_r($match); 
```

### 输出

```
Array
(
    [0] => Array
        (
            [0] => 0,0: (255,255,255,  0)  #FFFFFF00  srgba(255,255,255,0)
            [1] => 43,23: (162,166, 47, 40)  #A2A62F28  srgba(162,166,47,0.156863)
        )
    [1] => Array
        (
            [0] => 0,0
            [1] => 43,23
        )
    [2] => Array
        (
            [0] => 255,255,255,0
            [1] => 162,166,47,0.156863
        )
) 
```

# 示例 #2：

`$input`如果您有更深的正则表达式的单行：

### 代码

```
$input = '43,23: (162,166, 47, 40)  #A2A62F28  srgba(162,166,47,0.156863)';
preg_match('~^\s*(\d+),\s*(\d+):.+srgba\(\s*(\d+),\s*(\d+),\s*(\d+),\s*(.+?)\)\s*$~m', $input, $match);
print_r($match); 
```

### 输出

```
Array
(
    [0] => 43,23: (162,166, 47, 40)  #A2A62F28  srgba(162,166,47,0.156863)
    [1] => 43
    [2] => 23
    [3] => 162
    [4] => 166
    [5] => 47
    [6] => 0.156863
) 
```

# java - 支持 bean 中的 javax.el.PropertyNotFoundException

> ID：12715890
> 
> 赞同：1
> 
> 时间：2012-10-03T19:57:54.610
> 
> 标签：java, jsf, propertynotfoundexception

我有以下代码：

**otroDemo.java：**

```
package beans;

import java.io.Serializable;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ApplicationScoped;

@ManagedBean(name = "otroDemo")
@ApplicationScoped
public class otroDemo implements Serializable {

    private static final long serialVersionUID = 1L;

    private String valor;

    public otroDemo() {
        valor = "AAAA!!";
    }

    public String getValor() {
        return valor;
    }

    public void setValor(String valor) {
        this.valor = valor;
    }
} 
```

**otroDemo.xhtml**

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
...
<div id="contenido">
    <p:panel header="Blablabla" styleClass="panel">
        <h:outputText value="#{otroDemo.valor}" />
    </p:panel>
</div> 
```

我正在使用 JSF 2、PrimeFaces 3.4.RC1、Mojarra 2.1.12 和 Glassfish 3.1.2。

问题：我得到以下异常：

```
javax.el.PropertyNotFoundException: /otrodemo.xhtml @93,67 value="#{otroDemo.valor}": The class 'beans.otroDemo$Proxy$_$$_WeldClientProxy' does not have the property 'valor'.
    at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:111)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:194)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:182)
    at javax.faces.component.UIOutput.getValue(UIOutput.java:169)
    at com.sun.faces.renderkit.html_basic.HtmlBasicInputRenderer.getValue(HtmlBasicInputRenderer.java:205)
    at com.sun.faces.renderkit.html_basic.HtmlBasicRenderer.getCurrentValue(HtmlBasicRenderer.java:355)
    at com.sun.faces.renderkit.html_basic.HtmlBasicRenderer.encodeEnd(HtmlBasicRenderer.java:164)
    at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:875)
    at org.primefaces.renderkit.CoreRenderer.renderChild(CoreRenderer.java:59)
    at org.primefaces.renderkit.CoreRenderer.renderChildren(CoreRenderer.java:43)
    at org.primefaces.component.panel.PanelRenderer.encodeContent(PanelRenderer.java:192)
    at org.primefaces.component.panel.PanelRenderer.encodeMarkup(PanelRenderer.java:115)
    at org.primefaces.component.panel.PanelRenderer.encodeEnd(PanelRenderer.java:55)
    at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:875)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1786)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1782)
    at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1782)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:424)
    at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:124)
    at javax.faces.application.ViewHandlerWrapper.renderView(ViewHandlerWrapper.java:288)
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at 
com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722) 
```

而且我不太确定这里有什么问题。它以前有效，现在无效。你能帮我一把吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:47:40.663

> *我不太确定这里有什么问题。它以前有效，现在无效。*
> 
> ...
> 
> *当我清理我的项目时出现错误：无法删除文件 C:\Users...\NetBeansProjects...\build\web\WEB-INF\lib\sqljdbc4.jar*

服务器的工作文件夹显然变脏了。可以发生。有太多可能的因素会导致这种情况。服务器在开发过程中密集地进行热发布/热部署，并且可能在并发时刻，文件被锁定，从而由于某种原因忽略/取消了解锁，这反过来又导致在热部署期间无法进行清理。这可能是 IDE、服务器或使用的插件中的错误，谁知道呢。

您最好的选择是关闭服务器，然后执行通常的清理/重建/重新部署/重新启动过程。

# javascript - JQuery 脚本无法完全执行

> ID：12715892
> 
> 赞同：0
> 
> 时间：2012-10-03T19:58:02.177
> 
> 标签：javascript, jquery, userscripts

我正在编写一个用户脚本，它将一个元素插入到 tumblr 仪表板上，并使用从页面的另一部分提取的用户跟踪标签填充它。虽然我的脚本看起来应该可以工作，但到目前为止我所做的只是创建元素；元素的内容永远不会填充。

```
var jQuery, $ = null;

function addJQuery(callback) {
var p = null;

if(window.opera || window.navigator.vendor.match(/Google/)) {
    var div = document.createElement("div");
    div.setAttribute("onclick", "return window;");
    p = div.onclick();
}
else {
    p = unsafeWindow;
}

jQuery = $ = p.jQuery.noConflict();
callback();
}

var myFunction = function() {
jQuery('div#right_column ul#dashboard_controls_open_blog').after('<ul class="controls_section" id="tracked_tags"></ul>');
jQuery('div.tracked_tags a').each(function (i) {
    var tagID = jQuery(this).attr(id);
    var tagIDNumber = tagID.replace('tag_','');
    var tagName = jQuery(this).attr(href);
    var tagNameClean = tagName.replace('/tagged/','');
    var tagContent ='';
    tagContent += '<a href="'+tagName+'" id="'+tagID+'" class="tag">';
    tagContent += '<div class="hide_overflow">'+tagNameClean+'</div>';
    tagContent += '<span id="tag_unread_'+tagIDNumber+'" class="count" style=""></span></a>';
    tagContent += '<a class="sub_control" id="track_'+tagIDNumber+'" style="display:none;" onclick="track_tag('+tagIDNumber+', "n4av5kz9baBCv1PRCPUlT8X5K8", false);return false;">track</a>';
    tagContent += '<div class="remove_tag" id="untrack_'+tagIDNumber+'" onclick="if (confirm("Stop tracking this tag?")) {track_tag('+tagIDNumber+', "n4av5kz9baBCv1PRCPUlT8X5K8", true);} return false;">*</div>';
    tagContent += '<div id="tag_loader_'+tagIDNumber+'" class="tracked_tag_loader" style="display:none;"></div></li>';
    //tagContent += '<script type="text/javascript">new Effect.Appear("tag_unread_'+tagIDNumber+'");</script>';

    jQuery(tagContent).appendTo('div#right_column ul#tracked_tags');
    alert(tagID);

});

};

addJQuery(myFunction); 
```

[这是](http://jsfiddle.net/8DhPP/)JSFiddle 上的脚本，其中包含我正在使用的 HTML。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:46:12.477

JSFiddle 很有帮助，所以我在您的脚本中发现了几个错误。通常，hrefs 中的 javascript 没有正确转义。此外，您附加到错误的元素。

你可以看到[它工作](http://jsfiddle.net/cjPY4/)。

# perl - 使用 find 命令在文本编辑器中打开多个文件

> ID：12715894
> 
> 赞同：2
> 
> 时间：2012-10-03T19:58:06.933
> 
> 标签：perl, shell, unix, vim

我正在尝试使用此命令从命令行在 vim 中打开多个文件。出于某种原因，我遇到了错误，如下所示。

```
 $ find . -name edit.html.erb  \
     | perl -pi -e 's/^..//'   \
     | perl -pi -e 's/\n$/ /'  \
     | vim 
```

当我在没有“| vim”的情况下运行它时，如下命令：

```
 $ find . -name edit.html.erb  \
     | perl -pi -e 's/^..//'   \
     | perl -pi -e 's/\n$/ /' 
```

并得到这个输出：

```
 addresses/edit.html.erb claims/edit.html.erb emails/edit.html.erb owners/edit.html.erb packages/edit.html.erb users/edit.html.erb vessels/edit.html.erb voyages/edit.html.erb % 
```

我收到一个错误，可能与输出末尾的“%”标记有关。

这是输出和错误：

```
 Vim: Warning: Input is not from a terminal
 Vim: Error reading input, exiting...
 Vim: preserving files...
 Vim: Finished. 
```

我怎样才能解决这个问题？由于我是新手，因此不确定是哪个部分导致了错误，但我们将不胜感激！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-03T20:12:01.343

您将文件的内容作为键盘输入传递。我想你想要做的是`vim`在打开文件的情况下启动。我不知道`vim`，但这通常是通过将文件名作为参数传递来实现的。

在 bash 中，人们会使用：

```
vim $( find . -name edit.html.erb | perl -pe's/^..//' | perl -pe's/\n$/ /' ) 
```

（删除了无意义的使用`-i`。）

实际上，将换行符更改为空格是没有用的，删除前导也是`./`如此，所以您只需要：

```
vim $( find . -name edit.html.erb ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T20:03:18.773

让我们看看 vim 的文档：

```
SYNOPSIS
   vim [options] [file ..]
   vim [options] -
   vim [options] -t tag
   vim [options] -q [errorfile] 
```

这告诉我们，我们可以指定很多文件名作为命令行参数，并`-`表示“文件”将从 STDIN 加载。但这不是文件名，而是缓冲区内容！

让您的 Perl 脚本`exec`使用正确的参数进入 vim。

```
exec "vim", @filenames; 
```

或类似的。这将使您的工具链

```
 $ find . -name edit.html.erb  \
   | perl -pi -e 's/^..//'   \
   | perl -ne 'chomp; push @files, $_; }{ exec "vim", @files' 
```

（您真的确定要删除任何文件名的前两个字符吗？就是`s/^..//`这样。转义点以匹配文字`.`）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-03T20:09:19.840

进入标准输入`vim`不会做任何事情（无论如何都有帮助）。您想传递命令行参数，而不是输入。在`bash`中，为此使用反引号或`$(...)`语法。

```
vim `find . -name edit.html.erb | perl -pe's/^..//' | perl -pe's/\n$/ /'`
vim $(find . -name edit.html.erb | perl -pe's/^..//' | perl -pe's/\n$/ /') 
```

（`-i`Perl 的选项在这里也不做任何事情。当您在命令行上提供文件名时，该选项用于“就地”编辑文件。）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T22:00:18.550

不要忘记辅助操作系统：vim

```
:args `find . -name edit.html.erb`
:argadd `find . -name edit.html.js` 
```

甚至

```
:args **/edit.html.erb 
```

（另见 :argdelete、:args、:argdo 等）

（其他答案几乎击败了使用某些文件名参数调用 vim 的其他路径）

# java - 在 Java 中干净地停止监听 serversocket 的线程

> ID：12715895
> 
> 赞同：0
> 
> 时间：2012-10-03T19:58:09.413
> 
> 标签：java, multithreading, serversocket

我有一个正在处理的程序，主线程在其中初始化一个侦听器线程以侦听与 serverSocket 的传入连接

```
 /*
     * run - this will set up the server so that it is ready to listen.
     */
    public void run( serverVariables servVar, storageManager writer, storageVariables write, CoreVariables coreVar, serverFunctions serv, SQLFunctions SQL, SQLvariables SQLvar, netFunctions conn, netVariables netVar) {
        ControlFunctions cntrl = new ControlFunctions();
        util.doCommand("ifconfig eth0 " + servVar.ip);
        ListenerThread listen = new ListenerThread(servVar, coreVar, writer, serv, write, SQL, SQLvar, util);
        try {
            servVar.servSocket = new ServerSocket(servVar.port);
            listen.start();
            cntrl.getInput(util, clr.YELLOW, SQL, SQLvar, listen, conn, netVar);
        } catch (IOException e) {
            System.out.println("Could not read input stream");
            e.printStackTrace();
        }
    } 
```

然后等待来自服务器管理员的输入（在 cntrl.getInput() 中）。这一切都很好，但是我试图从 getInput 实现的主要功能是“halt”，它应该检查没有连接，然后停止侦听器及其本身。

这是侦听器线程：

```
 package server;

import java.io.IOException;

import net.netFunctions;
import net.netVariables;
import core.CoreVariables;
import utl.utilFunctions;
import utl.color;
import server.serverVariables;
import store.storageManager;
import store.storageVariables;
import conn.SQLFunctions;
import conn.SQLvariables;

public class ListenerThread extends Thread {
    color clr = new color();
    CoreVariables coreVar = new CoreVariables();
    utilFunctions util = new utilFunctions();
    netVariables netVar = new netVariables();
    storageManager writer = new storageManager();
    netFunctions conn = new netFunctions();
    storageVariables write = new storageVariables();
    serverFunctions serv = new serverFunctions();
    serverVariables servVar = new serverVariables();
    SQLFunctions SQL = new SQLFunctions();
    SQLvariables SQLvar = new SQLvariables();
    message msg = new message();

    public ListenerThread(serverVariables servVar, CoreVariables coreVar,
            storageManager writer, serverFunctions serv,
            storageVariables write, SQLFunctions SQL, SQLvariables SQLvar,
            utilFunctions util) {
        super("ListenerThread");
        this.coreVar = coreVar;
        this.util = util;
        this.writer = writer;
        this.write = write;
        this.serv = serv;
        this.servVar = servVar;
        this.SQL = SQL;
        this.SQLvar = SQLvar;
    }

    public void run() {
        util.outColored("Listener thread started", clr.CYAN);
        while (true) {
            try {
                new ConnectionThread(clr.GREEN, servVar.servSocket.accept(),
                        coreVar, util, writer, write, serv, servVar, SQL,
                        SQLvar).start();
            } catch (IOException e) {
                System.out.println("Failed to accept");
            }
        }
    }
} 
```

和 haltServer 功能：

```
private boolean haltServer(SQLFunctions SQL, SQLvariables SQLvar, utilFunctions util, String color, ListenerThread listen, netFunctions conn, netVariables netVar) {
    Socket s = null;
    boolean success = false;
    String result = null;
    int count = 0;
    //check for open connections
    SQL.doQuery("SELECT * FROM Clients WHERE Status != 0", SQLvar);
    try {
        while(SQLvar.resultSet.next()) {
            result = SQLvar.resultSet.getString("ClientID");
            util.outColored("Client " + result + " is still connected", color);
            count++;
        }
        if(count == 0) {
            listen.stop();
            success = true;
        }
        } catch (UnknownHostException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }catch (SQLException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return success;
} 
```

我知道 stop 已贬值，并考虑使用 interupted() 作为标志，但由于 serverSocket.accept() 调用，我认为这不会起作用。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:02:27.313

使用布尔标志来表示它是否应该中断：

```
private volatile boolean stop = false; 
```

然后创建一个名为 kill（不能停止）之类的方法，将标志设置为 true，然后关闭您的 ServerSocket：

```
public voic kill() {
    stop = true;
    serverSocket.close();
} 
```

然后，在这里几乎完成了，在将您的 ServerSocket 接受为 Socket 的代码行中，在 catch 块中，如下所示：

```
try {
   //accept server socket
} catch(IOException e) {
    if(stop)
        return;
    e.printStackTrace();
} 
```

因此，当您关闭 ServerSocket 时它不会打印错误，而只是停止尝试接受连接。最后一件事，将您的 while 循环更改为：

```
while(!stop) { ... 
```

只是为了确保它正确退出。

实际上我有一个服务器在我的计算机上运行，​​它使用以下代码：

```
 threadHandler = new ThreadPoolExecutor( maxThreads, maxThreads, 1, TimeUnit.MINUTES,
            new ArrayBlockingQueue<Runnable>( maxThreads, true ) );
    while (!serverTerminated) {
        try {
            final Socket connectionSocket = serversocket.accept();
            SocketHandler handler = new SocketHandler( this, connectionSocket );
            threadHandler.submit( handler );
        } catch (IOException e) {
            if (!serverTerminated)
                e.printStackTrace();
        }
    } 
```

# javascript - 如何从对象中获取属性

> ID：12715899
> 
> 赞同：0
> 
> 时间：2012-10-03T19:58:28.263
> 
> 标签：javascript

我正在尝试处理来自 ajax 的回调数据并且在循环数据时遇到问题。

我有

```
data.prototype.handleReturnData = function(data) {

} 
```

`data`是一个包含 4 个对象的对象。每个对象都有一个`test`and`test2`属性。

我如何获得这些属性？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:01:30.887

尝试使用 访问您的值`data[0]['test']`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T20:02:27.207

我会建议：

```
Object.getOwnPropertyNames(yourobject); 
```

这将获得所有属性名称，然后您可以使用这些名称循环或选择您的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T20:02:34.367

您可以使用 for-in 循环：

```
for (var prop in data) {
    if( data.hasOwnProperty(prop)) {
        // 'prop' refers to the property name
        // do something with data[prop] or data[prop].test
    }
} 
```

检查的目的`hasOwnProperty`是排除您可能不感兴趣的继承属性。这里的一些文档：[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...在](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for...in)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T20:01:23.077

尝试这个：

```
for (var i = 0; i < data.length; i++) {
    alert(data[i].test);
    alert(data[i].test2);
} 
```

# ios5 - Admob 横幅位置在 ipad/iphone 中不正确

> ID：12715902
> 
> 赞同：1
> 
> 时间：2012-10-03T19:58:33.897
> 
> 标签：ios5, cocos2d-iphone, objective-c-2.0

我已经在我的 2d 游戏中实现了 admob，我正在使用 cocos2d 开发这个游戏，任何人都可以帮助我设置位置 admob 横幅，我有一个纵向情绪的通用游戏，我想在设备底部显示横幅和当我从一个视图导航到另一个视图时要删除的横幅目前没有删除。这是我的代码：

```
-(void)onEnter
{
    [super onEnter];

     #ifdef ENABLE_ADMOB
   // AppDelegate *app=(AppDelegate*)[[UIApplication sharedApplication]delegate];

    viewController = [(AppDelegate *)[[UIApplication sharedApplication] delegate] viewController];

    // AppController *app =  (AppController*)[[UIApplication sharedApplication]   delegate];    
    // Create a view of the standard size at the bottom of the screen.
    // Available AdSize constants are explained in GADAdSize.h.

     mBannerView = [[GADBannerView alloc] initWithAdSize:kGADAdSizeBanner];

    // Specify the ad's "unit identifier." This is your AdMob Publisher ID.

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) 
    {
        mBannerView.adUnitID =@"a15062384653c9e"; 
    } 
    else
    {
        mBannerView.adUnitID =@"a15062392a0aa0a"; 
    }

    // Let the runtime know which UIViewController to restore after taking
    // the user wherever the ad goes and add it to the view hierarchy.

    //size

    mBannerView.rootViewController = viewController;
    [viewController.view addSubview:mBannerView];

    // Initiate a generic request to load it with an ad.
    [mBannerView loadRequest:[GADRequest request]];

     CGRect frame = mBannerView.frame;

    frame.origin.y = (viewController.view.bounds.size.height) ;

    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) 
    {
        CGSize AdSize = kGADAdSizeLeaderboard.size;

        frame.origin.y = 950; 
    } 
    else
    {
        CGSize AdSize = kGADAdSizeBanner.size;

        frame.origin.y = 430;
    }

    mBannerView.frame = frame;

    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.5];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];

    frame = mBannerView.frame;
    frame.origin.y = 430;

    mBannerView.frame = frame;
    [UIView commitAnimations];    

    #endif
}

-(void)showBannerView
 {
    if (mBannerView) 
    {
        [UIView animateWithDuration:0.5
                          delay:0.1
                        options: UIViewAnimationCurveEaseOut
                     animations:^
     {
         CGRect frame = mBannerView.frame;
         frame.origin.x = 0;
         mBannerView.frame = frame;
     } 
                     completion:^(BOOL finished)
     {
     }];
}

}

  -(void)hideBannerView
  {
      if (mBannerView) 
       {
           [UIView animateWithDuration:0.5
                          delay:0.1
                        options: UIViewAnimationCurveEaseOut
                     animations:^
     {
         CGRect frame = mBannerView.frame;
         frame.origin.y = -50.0f;
         mBannerView.frame = frame;
     } 
                     completion:^(BOOL finished)
     {
     }];
}

 }

 -(void)dismissAdView
  {
     #ifdef ENABLE_ADMOB
     if (mBannerView) 
     {
         [UIView animateWithDuration:0.5
                          delay:0.1
                        options: UIViewAnimationCurveEaseOut
                     animations:^
         {
         CGRect frame = mBannerView.frame;
         frame.origin.y = -50.0f;
         mBannerView.frame = frame;
     } 
                     completion:^(BOOL finished)
     {
         [mBannerView setDelegate:nil];
         [mBannerView removeFromSuperview];
         mBannerView = nil;

     }];

  }
 #endif  

 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-16T06:33:14.550

这是我在 iPhone 游戏中的 Admob 横幅的通用代码。

```
#import "GADBannerView.h"

typedef enum _bannerType
{
    kBanner_Portrait_Top,
    kBanner_Portrait_Bottom,
    kBanner_Landscape_Top,
    kBanner_Landscape_Bottom,
}CocosBannerType;

#define BANNER_TYPE  kBanner_Landscape_Bottom //change this on need basis

@interface MyMainMenu : CCLayer
{
    GADBannerView *mBannerView;
    CocosBannerType mBannerType;
    float on_x, on_y, off_x, off_y;
}

@implementation MyMainMenu

-(void)onEnter
{
    [super onEnter];
    [self createAdmobAds];
}

-(void)onExit 
{
    [self dismissAdView];
    [super onExit];
}

-(void)createAdmobAds
 {
    mBannerType = BANNER_TYPE;

    AppController *app =  (AppController*)[[UIApplication sharedApplication] delegate];
    // Create a view of the standard size at the bottom of the screen.
    // Available AdSize constants are explained in GADAdSize.h.

    if(mBannerType <= kBanner_Portrait_Bottom)
        mBannerView = [[GADBannerView alloc] initWithAdSize:kGADAdSizeSmartBannerPortrait];
    else
        mBannerView = [[GADBannerView alloc] initWithAdSize:kGADAdSizeSmartBannerLandscape];

    // Specify the ad's "unit identifier." This is your AdMob Publisher ID.
    mBannerView.adUnitID = MY_BANNER_UNIT_ID;

    // Let the runtime know which UIViewController to restore after taking
    // the user wherever the ad goes and add it to the view hierarchy.

    mBannerView.rootViewController = app.navController;
    [app.navController.view addSubview:mBannerView];

    // Initiate a generic request to load it with an ad.
    [mBannerView loadRequest:[GADRequest request]];

    CGSize s = [[CCDirector sharedDirector] winSize];

    CGRect frame = mBannerView.frame;

    off_x = 0.0f;
    on_x = 0.0f;

    switch (mBannerType)
    {
        case kBanner_Portrait_Top:
        {
            off_y = -frame.size.height;
            on_y = 0.0f;
        }
            break;
        case kBanner_Portrait_Bottom:
        {
            off_y = s.height;
            on_y = s.height-frame.size.height;
        }
            break;
        case kBanner_Landscape_Top:
        {
            off_y = -frame.size.height;
            on_y = 0.0f;
        }
            break;
        case kBanner_Landscape_Bottom:
        {
            off_y = s.height;
            on_y = s.height-frame.size.height;
        }
            break;

        default:
            break;
    }

    frame.origin.y = off_y;
    frame.origin.x = off_x;

    mBannerView.frame = frame;

    [UIView beginAnimations:nil context:nil];
    [UIView setAnimationDuration:0.5];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];

    frame = mBannerView.frame;
    frame.origin.x = on_x;
    frame.origin.y = on_y;

    mBannerView.frame = frame;
    [UIView commitAnimations];
}

-(void)showBannerView
{
    if (mBannerView)
    {
        [UIView animateWithDuration:0.5
                              delay:0.1
                            options: UIViewAnimationCurveEaseOut
                         animations:^
         {
             CGRect frame = mBannerView.frame;
             frame.origin.y = on_y;
             frame.origin.x = on_x;

             mBannerView.frame = frame;
         }
                         completion:^(BOOL finished)
         {
         }];
    }

}

-(void)hideBannerView
 {
    if (mBannerView)
    {
        [UIView animateWithDuration:0.5
                              delay:0.1
                            options: UIViewAnimationCurveEaseOut
                         animations:^
         {
             CGRect frame = mBannerView.frame;
             frame.origin.y = off_y;
             frame.origin.x = off_x;
         }
                         completion:^(BOOL finished)
         {
         }];
    }

}

-(void)dismissAdView
 {
    if (mBannerView) 
    {
        [UIView animateWithDuration:0.5
                              delay:0.1
                            options: UIViewAnimationCurveEaseOut
                         animations:^
         { 
             CGRect frame = mBannerView.frame;
             frame.origin.y = off_y;
             frame.origin.x = off_x;
             mBannerView.frame = frame;
         } 
                         completion:^(BOOL finished)
         {
             [mBannerView setDelegate:nil];
             [mBannerView removeFromSuperview];
             mBannerView = nil;

         }];
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-03T22:20:50.163

如果有人想在他的游戏中使用 admob，我也得到了解决方案和位置，他可以使用此代码，谢谢@raj，他帮助了我很多。

```
`

  -(void)onEnter
  {
  [super onEnter];

  #ifdef ENABLE_ADMOB
  // AppDelegate *app=(AppDelegate*)[[UIApplication sharedApplication]delegate];

   viewController = [(AppDelegate *)[[UIApplication sharedApplication] delegate]  viewController];

// AppController *app =  (AppController*)[[UIApplication sharedApplication] delegate];    
// Create a view of the standard size at the bottom of the screen.
// Available AdSize constants are explained in GADAdSize.h.

if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) 
{
 mBannerView = [[GADBannerView alloc] initWithAdSize:kGADAdSizeLeaderboard];
}
else {
    mBannerView = [[GADBannerView alloc] initWithAdSize:kGADAdSizeBanner];
}

// Specify the ad's "unit identifier." This is your AdMob Publisher ID.

if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) 
{
    mBannerView.adUnitID =@"a15062384653c9e"; 
} 
else
{
    mBannerView.adUnitID =@"a15062392a0aa0a"; 
}

// Let the runtime know which UIViewController to restore after taking
// the user wherever the ad goes and add it to the view hierarchy.

//size

mBannerView.rootViewController = viewController;
[viewController.view addSubview:mBannerView];

// Initiate a generic request to load it with an ad.
[mBannerView loadRequest:[GADRequest request]];

   CGRect frame = mBannerView.frame;

//  frame.origin.y = (viewController.view.bounds.size.height) ;

if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) 
{

   frame = mBannerView.frame;
    frame.origin.y = 950; 
    frame.origin.x = 20;
} 
else
{

   frame = mBannerView.frame;
    frame.origin.y = 430;
    frame.origin.x = 0;
}

 mBannerView.frame = frame;

[UIView beginAnimations:nil context:nil];
[UIView setAnimationDuration:0.5];
[UIView setAnimationCurve:UIViewAnimationCurveEaseOut];

mBannerView.frame = frame;
[UIView commitAnimations];    

#endif

 }

 -(void)showBannerView
  {
   if (mBannerView) 
  {
    [UIView animateWithDuration:0.5
                          delay:0.1
                        options: UIViewAnimationCurveEaseOut
                     animations:^
     {
         CGRect frame = mBannerView.frame;
         frame.origin.x = 0;
         mBannerView.frame = frame;
     } 
                     completion:^(BOOL finished)
     {
     }];
   }

 }

 -(void)hideBannerView
{
  if (mBannerView) 
   {
    [UIView animateWithDuration:0.5
                          delay:0.1
                        options: UIViewAnimationCurveEaseOut
                     animations:^
     {
         CGRect frame = mBannerView.frame;
         frame.origin.y = -50.0f;
         mBannerView.frame = frame;
     } 
                     completion:^(BOOL finished)
     {
     }];
  }

 }

 -(void)dismissAdView
{
 #ifdef ENABLE_ADMOB
if (mBannerView) 
{
    [UIView animateWithDuration:0.5
                          delay:0.1
                        options: UIViewAnimationCurveEaseOut
                     animations:^
     {
         CGRect frame = mBannerView.frame;
         frame.origin.y = -50.0f;
         mBannerView.frame = frame;
     } 
                     completion:^(BOOL finished)
     {
         [mBannerView setDelegate:nil];
         [mBannerView removeFromSuperview];
         mBannerView = nil;

     }];

 }
  #endif  

} 
```

`

# django - Django、CloudFront 和 respond.js

> ID：12715903
> 
> 赞同：3
> 
> 时间：2012-10-03T19:58:34.090
> 
> 标签：django, amazon-s3, amazon-cloudfront, django-compressor

我正在尝试让媒体查询在 IE 8 中运行，并且[Respond.js](https://github.com/scottjehl/Respond)在开发中运行良好。但是，当我将它部署到我的生产环境时，Respond.js 无法正常工作，这很神奇。我已按照 GitHub 上的说明使用 CDN 进行设置（我们使用 S3 和 Cloudfront），并且我已确保所有 javascript 和 respond-proxy.html 文件都可在我指定的 URL 中使用。

我目前的理论是，这是 Django 在某处停止了 Respond.js 的 AJAX，特别是，我的 Django 日志中的这一行证明了这一点：

```
WARNING Wed, 03 Oct 2012 15:22:13 +0000 base xxx xxxxxxx Not Found: /https://dxxxxxxxxxxxx.cloudfront.net/j/r/respond-proxy.html 
```

它似乎正在尝试`/https://d...`在本地服务器上查找。该行在每个页面请求中出现多次。

这是代码：

```
<link rel="stylesheet" type="text/css" media="screen" href="https://dxxxxxxxxxx.cloudfront.net/static/css/style.css" />
<script type="text/javascript" src="/static/js/respond.src.js"></script>
<link href="https://dxxxxxxxxxx.cloudfront.net/static/js/respond-proxy.html" id="respond-proxy" rel="respond-proxy" />
<link href="/static/js/respond.proxy.gif" id="respond-redirect" rel="respond-redirect" />
<script type="text/javascript" src="/static/js/respond.proxy.js"></script> 
```

请注意，我的 CSS 是使用 django-compressor 压缩的，我的其他 JS 也是如此。上面的代码在 {% compress %} 块之外。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-04T22:53:32.533

原来我需要破解 response.proxy.js 才能让它工作。我在 checkBaseUrl() 中注释掉了第 74 行：

```
//          href = bref + href; 
```

请注意，这可能是由我的页面上运行的其他 JS 引起的，并且可能不是（可能不是？）respond.proxy.js 中的错误。

# typescript - TypeScript：无法编写异构数组文字

> ID：12715909
> 
> 赞同：15
> 
> 时间：2012-10-03T19:58:47.750
> 
> 标签：typescript

我需要什么类型的断言来编译它？

```
class Foo {}
class Bar {}

var f =
[
    [Foo, [1, 2, 3]],
    [Bar, [7, 8, 9]],
]; 
```

错误：

```
Incompatible types in array literal expression 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-10-03T20:05:26.580

这将起作用：

```
class Foo {}
class Bar {}

var f: any[][] = [
    [Foo, [1, 2, 3]],
    [Bar, [7, 8, 9]],
]; 
```

这表示您有一个二维数组，其值可以是任何值（Foo、Bar、其他数组等）。您还可以对嵌套数组使用类型断言：

```
class Foo {}
class Bar {}

var f = [
    [<any>Foo, [1, 2, 3]],
    [<any>Bar, [7, 8, 9]],
]; 
```

内部数组中存在单个 any 会强制编译器将其类型推断为 any[]。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-12-23T00:30:07.567

看起来打字稿现在*确实*有异构数组。所以，由于这个问题是我在寻找这个问题时首先出现的，并且因为很难找到它，所以现在如何编写这段代码：

```
class Foo {}
class Bar {}

var f: [Foo|Bar, number[]][] =
    [[new Foo(), [1, 2, 3]],
     [new Bar(), [7, 8, 9]]]; 
```

（现在，如果这走上了模仿表达式的类型语法的道路，那么该类型也将获得`[Foo|Bar, [...number]][]`...的语法）

它甚至可以与函数参数一起使用，所以这个类型检查很好：

```
function foo([obj,nums]: [Foo|Bar, number[]]) {
  for (let i of nums) console.log(`i = ${i}`);
}

f.forEach(foo); 
```

和极端版本：

```
f.forEach(([obj,nums]: [Foo|Bar, number[]]) => {
  for (let i of nums) console.log(`i = ${i}`); }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-06-07T14:53:46.863

从 Typescript 1.4 开始，您可以进行类型联合。我能够做到这一点：

```
function zip<T, X> (array1: T[], array2: X[]): (T|X)[][] {
    return array1.map(function (v: T, i: number) { return [v, array2[i]]; });
} 
```

您将在您的案例中寻找的特定类型是：

```
(Foo|Bar|number[])[][] 
```

或者：

```
(typeof Foo|typeof Bar|number[])[][] 
```

# c# - Windows.Forms DragLeave 事件意外触发

> ID：12715910
> 
> 赞同：2
> 
> 时间：2012-10-03T19:58:49.427
> 
> 标签：c#, winforms, events, event-handling, drag-and-drop

自定义 UserControl`ChartControlShelf`包含一个`TableLayoutPanel`带有 3 个子控件的所有类型`Panel`。孩子没有事件处理程序。

`ShelfContainer`为 UserControl 添加所有事件处理程序`ChartControlShelf`：

```
ChartControlShelf chartControlShelf = new ChartControlShelf();
chartControlShelf.DragOver+=new DragEventHandler(chartControlShelf_DragOver);
chartControlShelf.DragLeave+=new EventHandler(chartControlShelf_DragLeave); 
```

……

```
private void chartControlShelf_DragOver(object sender, DragEventArgs e) {

        ChartControlShelf chartControlShelf = (ChartControlShelf)sender;

        if (chartControlShelf.panelControlShelf.PointToClient(Cursor.Position).Y < chartControlShelf.tlpChartControlShelf.Size.Height / 2) {
            chartControlShelf.panelInsertTop.BackColor = CustomColorsColors.DragEnter;
            chartControlShelf.panelInsertBottom.BackColor = CustomColorsColors.DragLeave;
        }
        else {
            chartControlShelf.panelInsertBottom.BackColor = CustomColorsColors.DragEnter;
            chartControlShelf.panelInsertTop.BackColor = CustomColorsColors.DragLeave;
        }
   }

    private void chartControlShelf_DragLeave(object sender, EventArgs e) {
        ChartControlShelf chartControlShelf = (ChartControlShelf)sender;
        chartControlShelf.panelInsertTop.BackColor = CustomColorsColors.DragLeave;
        chartControlShelf.panelInsertBottom.BackColor = CustomColorsColors.DragLeave;

    } 
```

为什么 *chartControlShelf_DragLeave***在**我的鼠标离开`ChartControlShelf`UserControl 之前触发？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T20:25:56.340

鼠标光标“属于”指针下方直接可见的控件。听起来很奇怪，当光标“进入”ChartControlShelf 内的某个控件时，它也“离开”了 ChartControlSelf。

# android - 如何制作一个跟随手机主题的应用程序？

> ID：12715913
> 
> 赞同：0
> 
> 时间：2012-10-03T19:58:54.353
> 
> 标签：android, android-theme

我制作了我的 Hello World 应用程序，3 个小部件，完全没有样式。我为 2.1 设置了最低 SDK，我在 Android 2.3 上测试我的应用程序。当我设计我的应用程序（在 Eclipse 中）并运行它时，我在白色上有黑色文本。

问题是手机主题（它是默认主题）是黑色的浅色文本。

由于我的主要小部件是`RelativeLayout`我尝试为它指定一个主题，`?android:style/Theme`但效果与以前相同。

那么如何制作一个完全符合手机主题的应用程序呢？我的意思是我根本不想自己做样式，如果主题是粉红色的红色文本，就这样吧，我的应用程序应该遵循这个。我不想使用任何硬编码的值（比如“固定黑色上的固定白色”，因为这些可能对我有用，而不是其他人）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T08:22:03.113

我找到了！;-) 我假设您在这里使用 Eclipse——转到您的清单、应用程序选项卡、主题编辑框。那里输入了一个值（不是我输入的），删除它，瞧——现在您的应用程序遵循手机主题。

**仅在一部手机上测试**——运行 Android 2.3。如需进一步参考，请在另一个 Android 版本上成功测试此答案后发表评论。

# php - MySQL 和 or 之间？

> ID：12715919
> 
> 赞同：0
> 
> 时间：2012-10-03T19:59:08.833
> 
> 标签：php, mysql

我有一个选择订单的查询，我想在两个日期之间进行选择。但我也想选择所有处于 3 或 4 种状态之一的订单。我有以下

```
SELECT *
WHERE  created BETWEEN '1296360000' AND '1322884800'
       AND order_status = 'pending'
        OR order_status = 'processing'
        OR order_status = 'payment_received'
        OR order_status = 'completed' 
```

但问题是它似乎选择了订单状态为这 4 个之一的所有内容。并且完全忽略了`BETWEEN`如果我将订单状态更改为`BETWEEN`在订单状态之后`OR`它仍然包括在`'1322884800'`

我应该在哪里放置中间值或如何执行此操作以在 X 和 Y 之间选择订单状态为 4（或 3、或 2 或 1）个值之一的订单？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:01:25.920

将`order_status`子句放在括号中（或者更好的是，使用 IN 列表）。

```
SELECT *
WHERE  created BETWEEN '1296360000' AND '1322884800'
       AND (order_status = 'pending'
        OR order_status = 'processing'
        OR order_status = 'payment_received'
        OR order_status = 'completed') 
```

按照您现在的方式，优先级被解释为：

```
SELECT *
WHERE  (created BETWEEN '1296360000' AND '1322884800'
       AND order_status = 'pending')
        OR order_status = 'processing'
        OR order_status = 'payment_received'
        OR order_status = 'completed' 
```

如果找到最后三个订单状态中的任何一个，这将评估为真，无论`created`日期如何。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T20:01:46.947

```
SELECT *
WHERE
    created BETWEEN '1296360000' AND '1322884800' AND
    order_status IN ('pending', 'processing', 'payment_received', 'completed') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T20:00:58.040

这是一个优先问题：

```
SELECT *
WHERE  created BETWEEN '1296360000' AND '1322884800'
   AND (order_status = 'pending'
    OR order_status = 'processing'
    OR order_status = 'payment_received'
    OR order_status = 'completed') 
```

OR 语句没有按照您期望的顺序进行评估 - 在 OR 部分周围放置括号以确保它们被正确评估。你也可以这样做：

```
SELECT *
WHERE  created BETWEEN '1296360000' AND '1322884800'
   AND order_status IN ('pending','processing','payment_received','completed') 
```

哪个更整洁。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-03T20:01:31.957

您需要封装 OR。或者使用这样的东西：

`SELECT * WHERE created BETWEEN '1296360000' AND '1322884800' AND order_status IN ('pending', 'processing','payment_received', 'completed')`

注意，不检查正确性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-03T20:13:32.763

或者

```
SELECT * 
WHERE created >= '1296360000' 
AND created <= '1322884800' 
AND order_status in ("pending", "processing", "payment_received", "completed") 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-10-03T20:03:42.870

```
SELECT *
WHERE  created BETWEEN '1296360000' AND '1322884800'
       AND ( order_status = 'pending'
        OR order_status = 'processing'
        OR order_status = 'payment_received'
        OR order_status = 'completed' ) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-10-03T20:03:45.137

您需要使用方括号明确定义优先级：

```
 SELECT *
 WHERE  created BETWEEN '1296360000' AND '1322884800'
   AND ( order_status = 'pending'
    OR order_status = 'processing'
    OR order_status = 'payment_received'
    OR order_status = 'completed') 
```

# javascript - 如何在不重复多次的情况下重复使用此脚本？（相对于 div-size 脚本调整字体大小）

> ID：12715920
> 
> 赞同：0
> 
> 时间：2012-10-03T19:59:16.653
> 
> 标签：javascript, jquery, font-size

我在网上找到了这段代码，它对我来说非常特别……但是，我需要它更特别一点……

此代码不适用于多个 div。我需要复制代码以使其工作并将类名 fmor newswrap 更改为 newsrap2 等等。这将导致像我这样的杂志网站有很多代码。

有人知道如何处理此代码以使其适用于多个 div 吗？

PS，目前我的 header.php 中有 15 个

```
$(document).ready(function() {
    var originalFontSize = 11.8;
    var sectionWidth = $('#newswrap8').width();

    $('#newswrap8 span').each(function(){
        var spanWidth = $(this).width();
        var newFontSize = (sectionWidth/spanWidth) * originalFontSize;
        $(this).css({"font-size" : newFontSize, "line-height" : newFontSize/0.9 + "px"});
    });
}); 
```

这是我使用的 HTML 代码

```
<div style="width:300px;">
<h3 id="newswrap8" style="margin:0px; font-size:12px;">
<span>
<a href="http://www.thelink.no">This is the page title</a>
</span>
</h3>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:45:59.220

没有 html-markup 很难测试，但想法是：

```
$(document).ready(function(){
    var originalFontSize = 11.8;
    $('[id^="newswrap"]').each(function(){
        var elm = $(this),
            sectionWidth = elm.width();

        elm.find('span').each(function(){
            var spanWidth = $(this).width();
            var newFontSize = (sectionWidth/spanWidth) * originalFontSize;
            $(this).css({"font-size" : newFontSize, "line-height" : newFontSize/0.9 + "px"});
        });
    });
}); 
```

# asp.net - 禁用没有 javascript 的锚链接

> ID：12715923
> 
> 赞同：3
> 
> 时间：2012-10-03T19:59:34.083
> 
> 标签：asp.net, html

让我们假设这有效：

```
<a href="target.html" enabled="<%# myboolean %>">Zelda</a> 
```

好的，但事实并非如此。我最接近这个设置的是什么？我基本上希望文本是链接或常规文本，具体取决于`myboolean`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:04:04.320

如果您真的想在链接和纯文本之间切换，您可以在代码中使用`if`语句。`asp.net`

```
<% if (myboolean) { %>
  <a href="target.html">Zelda</a>
<% } else { %>
  Zelda
<%} %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:03:28.630

您可以使用以下方法隐藏元素：

```
<a href="target.html" <%# myboolen ? "style=\"display:none;\"" : "" %>>Zelda</a> 
```

**或**禁用元素的 onlclick

```
<a href="target.html" <%# myboolen ? "onclick=\"javascript:return false;\"" : "" %>>Zelda</a> 
```

**或者**您可以通过使标签在服务器上运行并使用后面的代码来禁用元素的 onlclick

*前端*

```
<a href="target.html" runat="server" id="anchor">Zelda</a> 
```

*背后的代码*（你必须在你的绑定事件中通过它的外观来执行此操作）

```
anchor.attributes.add("onclick", "javascript:return false;"); 
```

无论您认为哪个最整洁 :)

# regex - TextEditor : 操作字符串的宏

> ID：12715924
> 
> 赞同：2
> 
> 时间：2012-10-03T19:59:35.383
> 
> 标签：regex, macros, automation, text-editor

我经常对字符串集进行一些操作，通常我可以在 Notepad++ 中使用正则表达式。很久以前，我记得使用一些可以记录动作并执行相同操作的工具。例如，假设我有这个字符串。请记住，这只是一个例子。

```
First Name,Last Name,Social Security 
```

我想将其转换为以下内容：

```
first_name("First Name"),last_name("Last Name"),social_security("Social Security") 
```

有没有办法使用一些文本编辑器来做到这一点？我经常有这些类型的要求。我记得用 vim 做类似的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:51:39.993

它可以使用 vim 宏来完成，但“简单”替换更适合

```
:s/\(^\|,\)\(\S\+\) \(\S\+\)\(,\|$\)/\l\2_\l\3("\2 \3")/g 
```

或者，您可以从内部为此使用`awk`( , 不管什么) ，例如：`sed``vim`

```
:%!awk 'BEGIN {FS=","} { print whatever you modified your columns }' 
```

使用宏，类似`q``a``y``t``,``P``i``(``"``ESC``f``,``i``"``)``ESC``F``2``SPACE``r``_``l``~``0``~``q`

但这只是部分有效......（对于第一列）基本上：

1.  `q``a`将宏记录到`a`寄存器中
2.  `y``t``,`（假设我们在该行的第一个字符上，这会拉到第一个`,`
3.  `P`将 yanked 测试放在实际光标位置之前（即行上的第一个字符）
4.  （保持光标位置）`i``(``"``ESC`插入`("`，然后离开插入模式
5.  `f``,``i``"``)``ESC`*找到下一个空格并在之前*插入`")`
**   `F``2``SPACE``r``_`向后找到第二个`space`，并替换为`_`*   `l``~``0``~``q`移动到下一个字符，然后将其大小写更改为更低，然后移动到行的第一个字符，并更改大小写，最后退出录制宏。*

 *然后通过正常模式运行宏`@``a`。

Vim 非常有能力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T20:33:04.550

您还可以尝试使用 java 多平台免费开源工具[jEdit](http://jedit.org/)。

它提供宏录制和编辑。

宏在[BeanShell](http://www.beanshell.org/)中转储/编写，jEdit 扩展了一组文档化的 API，允许通过宏实现您想要的任何内容。

[jEdit 社区](http://community.jedit.org/?q=filestore/browse/25)也共享许多宏脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T21:02:33.660

事实上，vim 允许你做这种事情。使用 Vim 宏功能，您可以在编辑器中录制和播放一系列动作。根据我的经验，它非常强大，比其他文本编辑器强大得多（因为在 vim 中编辑本身是基于命令序列的。）但是，如果您不熟悉 vim，则需要时间来学习如何使用 vim . 但它最终会导致高效的文本编辑和编码。

使用 vim 还有很多优点。互联网上也有很多文章解释它们。我建议在谷歌上搜索一下，这样你就可以自己决定了。*

# java - 使用扫描仪类的问题。System.out.println("请输入学生1的分数");后，跳过两个问题

> ID：12715926
> 
> 赞同：-2
> 
> 时间：2012-10-03T19:59:39.677
> 
> 标签：java, java.util.scanner

```
package findingthehighestscore;
import java.util.Scanner;

public class FindingTheHighestScore
{

public static void main(String[] args)
{
    Scanner kybd = new Scanner(System.in);
    // store students names  
    String student1;
    String student2;
    String student3;
    String tempStudent;

    // store students scores
    double score1;
    double score2;
    double score3;
    double tempScore;

    //Prompt user for input of each student and their score
    System.out.println("Please enter the name of Student 1");
    student1 = kybd.nextLine();

    System.out.println("Please enter the score of student 1");
    score1 = kybd.nextByte();

    System.out.println("Please enter the name of Student 2");
    student2 = kybd.nextLine();

    System.out.println("Please enter the score of student 2");
    score2 = kybd.nextByte();

    System.out.println("Please enter the name of Student 3");
    student3 = kybd.nextLine();

    System.out.println("Please enter the score of student 3");
    score3 = kybd.nextByte();

    //if score2 is greater then score1 then swap scores. Score 1 will be printed as highest score
    if(score2 > score1)
    {
       tempScore = score1;      
       score1 = score2;
       score2 = tempScore;           
       tempStudent = student1;           
       student1 = student2;          
       student2 = tempStudent;          
    }

     //if score3 is greater then score1 then swap scores.
    if(score3 > score1)
    {
       tempScore = score1;
       score1 = score3;          
       score3 = tempScore;           
       tempStudent = student1;           
       student1 = student3;           
       student3 = tempStudent;           
    }        
    System.out.print(student1 + " has the highest score of " + score1);       
} 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T20:00:41.167

代替 ：-

```
student1 = kybd.nextLine(); 
```

和： -

```
student1 = kybd.next(); 
```

**nextLine()**方法不会读取当前输入末尾的换行符。因此，换行符将在下一次调用时读取**。**`scanner.nextByte()`它读取的不是字节而是换行符。

所以，它基本上跳过下一行（因为它从上一个输入**中读取换行符**）并在下一行之后前进光标。所以，你的`nextByte()`方法只是被**跳过了**..

因此，要阅读换行符，您可以使用`next()`方法.. 这样，下一次迭代将没有任何内容可供阅读..

# java - Java JFrame 布局

> ID：12715932
> 
> 赞同：0
> 
> 时间：2012-10-03T19:59:58.367
> 
> 标签：java, swing, layout, jframe, jpanel

我正在制作一个简单的迷宫程序，用户可以在其中创建墙壁、路径、起点和终点，单击解决，迷宫将被解决。为此，我有一个大小为 640x480 的 java JFrame。在 JFrame 的左侧，我有一个 JPanel，左上角坐标为 0,0，大小为 480x480。这是绘制迷宫的区域，用户可以指定墙壁和路径。我遇到的问题是当我开始在屏幕右侧添加按钮和单选按钮时。我使用的每个布局（例如 boxlayout、springlayout、flowlayout 或网格布局）似乎都没有达到我想要的效果。我希望 JPanel 保持原样（在最右侧，大小为 480x480），并且按钮从 480 开始自上而下排列（因为这是 JPanel 结束的地方）。我想我需要的是指定布局开始的位置，而不是自动排列 JPanel。有什么办法可以做到这一点吗？还是我只需要一个空布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-11T11:06:40.280

看看我的这个答案：

[组件的定位（如何将几个按钮放置在相同大小的屏幕中心）](https://stackoverflow.com/questions/12835198/positioning-of-components-how-to-place-a-few-buttons-center-screen-same-size/12837118#12837118)

[Jframe 执行时大小不合适，有什么原因吗？](https://stackoverflow.com/questions/12774432/jframe-not-the-right-size-when-its-executed-any-reason-why/12780478#12780478)

您想要做的是在一组单选按钮上使用 JPanel 480x480。只需使用带有 PAGE_AXIS 的 BoxLayout 并按照链接中的指南进行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T20:07:02.213

我会使用 BorderLayout；将 480 方形面板放在中心，并将其最小、最大和首选尺寸设置为 480。（有一个问题，这是否是一个好主意，但你说你想要这个特定的尺寸。）

将另一个 JPanel 放在 SOUTH 中，让它根据您的需要自动排列您的按钮。有从左到右、一排或两排等排列的布局。

然后，您可以在中心 JPanel 中执行特定于创建墙壁和门的操作，并且用户可以调整窗口大小，按钮的布局管理器将执行您为此指定的操作。

# javascript - jQuery将项目附加到选择列表

> ID：12715940
> 
> 赞同：0
> 
> 时间：2012-10-03T20:00:48.927
> 
> 标签：javascript, jquery

我有一个带有选择列表的表单，如果没有列出用户需要的项目，他们可以通过另一个输入框添加它，然后该项目将附加到选择列表中。

```
$("#misc_userID").effect("transfer", { to: $("#group_misc_available") }, 500); 
```

现在，我的问题是，如果用户输入了一个多词项（例如“来自 HP 的 John”），则短语中的空格无法正确传输（通过 FireBug 见下文）：

```
<option hp="" from="" value="John">John from HP</option> 
```

我正在使用以下 jQuery 代码从[我的另一个问题](https://stackoverflow.com/questions/12712660/jquery-move-item-from-one-select-box-to-another-while-retaining-listing-order)中附加该项目：

```
$(document).ready(function() {
    $('select').change(function() {
        var $this = $(this);
        $this.siblings('select').append($this.find('option:selected')); // append selected option to sibling
        $('select', this.parent()).each(function(i,v){ // loop through relative selects
            var $options = $(v).find('option'); // get all options
            $options = $options.sort(function(a,b){ // sort by value of options
                return a.value - b.value;
            });
        (this).html($options); // add new sorted options to select
        });
    });   
}); 
```

这几乎就像我需要在传输之前对其进行编码，然后在之后进行解码。

我无法让 jsfiddle 工作，所以这里是代码：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js"></script>
</head>

<body>
<p>
    <input type="text" name="misc_userID" id="misc_userID" value="" size="30" max="100" />
</p>
<p>
    <input type="button" name="misc_AddUpdate_btn" id="misc_AddUpdate_btn" value="Save Contributor" />
</p>
<p>
    <select name="group_misc_available" size="10" multiple="multiple" id="group_misc_available" class="group_misc_selects_control" style="width:140px;">
        <option value="Option 1">Option 1</option>
        <option value="option 2">Option 2</option>
    </select>
    <img src="../Common/MultiSelect/img/switch.png" width="30" height="30" />
    <select name="group_misc_selected" size="10" multiple="multiple" id="group_misc_selected" class="group_misc_selects_control"  style="width:140px;">
    </select>
</p>
<script>
$(document).ready(function() {
    $('select').change(function() {
        var $this = $(this);
        $this.siblings('select').append($this.find('option:selected')); // append selected option to sibling
        $('select', $this.parent()).each(function(i,v){                 // loop through relative selects
            var $options = $(v).find('option');                         // get all options
            $options = $options.sort(function(a,b){                     // sort by value of options
                return a.value - b.value;
            });
            $(this).html($options);                                     // add new sorted options to select
        });
    });   
    $('#misc_AddUpdate_btn').click(function(){
            var contributor = $('#misc_userID').val();
            if ( (contributor==null) || (contributor=="") ){
                //    do nothing
                alert('You must enter the Miscellaneous Contributor first.');
            }
            else {
                //    console.log('button pressed');
                var path_to_save_contributor = '/vtil/ajax/GroupContributor_Misc_lookup.cfm';
                var data_to_send = 'misc_userID='+contributor;

                $("#misc_userID").effect("transfer", { to: $("#group_misc_available") }, 500);
                setTimeout(function() {AddElement(contributor);}, 500);
            }
        });

        function AddElement(contributor){
                    $('#misc_userID').val('');    // reset value back to null    
                    var UpdateItem=decodeURIComponent(contributor);
                    $("#group_misc_available").append('<option value=' + UpdateItem + '>' + UpdateItem + '</option>');
                }
    });
</script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:11:24.613

挑剔：

*   `this.parent()`应该是`$this.parent()`。
*   `(this).html($options);`应该是`$this.html($options);`（或者也许`$(this).html($options);`？）。

除了这些，`John%20from%20HP`可以转换为`John from HP`using `unescape()`，尽管我建议`decodeURIComponent()`在这种情况下使用 using 。（因为您`encodeURIComponent()`最初使用过。）

由于您无法对恢复的内容进行编码/解码`find()`（因为它是一个 jQuery 对象，而不是字符串），您可以像这样重新组织您的代码：

```
$this.find('option:selected')
     .html(decodeURIComponent($this.find('option:selected').html()))
     .appendTo($this.siblings('select')); 
```

[您可以在这个 jsFiddle](http://jsfiddle.net/yHfxd/)中看到正在运行的代码（这里忽略了排序代码）。

如果这段代码仍然不能正常工作，我们需要看一个实际的例子。

# windows - 全局描述符表

> ID：12715941
> 
> 赞同：9
> 
> 时间：2012-10-03T20:00:49.887
> 
> 标签：windows, operating-system, x86, intel

我一直在阅读有关虚拟内存（分段+分页）的英特尔手册。据我了解，有一个保存全局描述符表（GDT）的特殊寄存器。GDT 包含 NULL 描述符、本地描述符表、TSS 和段描述符。此外，几乎所有操作系统 (OS) 都有一个 GDT，并且在引导时加载并且无法更改（也许！！！）。我的问题是：

1.  所有这些信息（NULL、LDT、TSS 和段描述符）存储在哪里？它们在物理内存、RAM 还是本地硬盘中？
2.  段描述符是否与代码段 (ASM: CS)、数据段 (ASM: DS) 相同，如果是，则其中有多少存储在 GDT 中（是否只有一个 CS，一个 DS，...） ?
3.  Protable Executable (PE) Loader 是否操纵这些信息？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-10-04T00:09:00.500

> 所有这些信息（NULL、LDT、TSS 和段描述符）存储在哪里？它们在物理内存、RAM 还是本地硬盘中？

如果 CPU 没有在内部缓存 GDT 的内容，那么它可能需要时不时地访问它，也许一直都需要。CPU 不能直接从磁盘读取它，因为它不知道磁盘或上面的文件系统的任何信息，也不知道如何不干扰访问同一磁盘的操作系统。CPU 也不能依赖 OS 的帮助，因为 OS 在从磁盘获取某些东西的过程中，也可以让 CPU 从 GDT 获取一些东西。捕获 22。

您真的不希望将 GDT 换出到磁盘。如果不是因为上述原因，那么是因为性能影响。所以 GDT 总是在内存中，物理内存（=RAM）。

> 段描述符与代码段 (ASM: CS)、数据段 (ASM: DS) 是否相同，如果是，则其中有多少存储在 GDT 中（是否只有一个 CS，一个 DS，...） ?

段寄存器（CS、DS 等）包含段选择器，它们基本上是保护模式下 GDT（或 LDT）的索引，这些索引指向/选择描述符表中的段描述符。在真实和虚拟 8086 模式中它是相同的，除了不使用表，因为段位置和大小（我们从保护模式下的表中获得）不是任意的并且不需要查找，它们是立即计算的。

请注意，以下术语的含义不同，请勿混淆或互换使用：

*   段寄存器
*   段选择器
*   段描述符
*   段描述符表
*   部分

> Protable Executable (PE) Loader 是否操纵这些信息？

它不应该。至少不是直接的。大多数 Windows 程序在 CS、DS、ES、SS 中使用相同的段选择器值。这些选择器指向的 GDT 条目不会改变，它们是全局的并且在所有程序之间共享。

程序和线程之间通常唯一不同的是用于访问线程本地存储（TLS）的段（可能还有它的选择器）。FS 或 GS​​ 段寄存器保存指向该 TLS 段的选择器。并且所有对 TLS 的访问都是通过使用适当的段覆盖前缀（FS: 或 GS​​:）的指令完成的。TLS 对于每个线程都是唯一的。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-10-03T20:28:36.027

OSDev.org 对 GDT 进行了[很好](http://wiki.osdev.org/Global_Descriptor_Table)的介绍，然而，详细介绍其实现[的教程](http://wiki.osdev.org/GDT_Tutorial)更有趣。（您可能还对其较小、特权较低的表亲[LDT](http://en.wikipedia.org/wiki/Local_Descriptor_Table)感兴趣）

1.  GDT 驻留在主内存中，并使用线性地址（通过`LGDT`）加载，因此它可能位于分页内存中。

2.  是的（请参阅[词汇表](http://wiki.osdev.org/GDT_Tutorial#Survival_Glossary)），您可以存储您喜欢的任何段基础，[通常](http://wiki.osdev.org/GDT_Tutorial#Basics)，CS 和 DS 是最低限度的（如果使用`SYSENTER`/则需要用户+内核版本`SYSEXIT`）。

3.  不，它宁愿改变 LDT（因为 x86 提供了交换它们的工具，而不是 GDT，它需要设置实模式指令，并且在实模式和保护模式之间跳转是不可行的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-04T13:14:45.623

我同意上面的答案，但是对于问题 2 的更完整的答案是：
段描述符指定段的大小、段的访问权限和特权级别、段类型以及第一个字节的位置线性地址空间中的段（称为段的基地址）。所以段描述符不仅仅是 CS、DS、... 寄存器。

# c# - 解压缩 MemoryStream（包含 zip 文件）并获取文件

> ID：12715945
> 
> 赞同：46
> 
> 时间：2012-10-03T20:00:52.913
> 
> 标签：c#

我有一个内存流，其中包含`byte[]`格式的 zip 文件。有什么方法可以解压缩这个内存流，而不需要将文件写入磁盘？

一般来说，我`ICSharpCode.SharpZipLib.Zip.FastZip`用来解压缩文件，但是有没有办法解压缩内存流，可能是通过将文件存储为另一种文件`MemoryStream`或`byte[]`根据 zip 中存在的文件/文件夹的格式存储文件？

在这种情况下，我有什么办法可以使用 Memorymapped 文件功能？

* * *

## 回答 #1

> 赞同：123
> 
> 时间：2014-02-13T22:38:13.077

是的，[.Net 4.5 现在支持更多的 Zip 功能](http://msdn.microsoft.com/en-us/library/ms404280%28v=vs.110%29.aspx)。

这是基于您的描述的代码示例。

在您的项目中，右键单击 References 文件夹并添加对**System.IO.Compression的引用**

```
using System.IO.Compression;

Stream data = new MemoryStream(); // The original data
Stream unzippedEntryStream; // Unzipped data from a file in the archive

ZipArchive archive = new ZipArchive(data);
foreach (ZipArchiveEntry entry in archive.Entries)
{
    if(entry.FullName.EndsWith(".txt", StringComparison.OrdinalIgnoreCase))
    {
         unzippedEntryStream = entry.Open(); // .Open will return a stream
         // Process entry data here
    }
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-10-03T20:23:44.363

我们使用[DotNetZip](https://www.nuget.org/packages/DotNetZip/)，我可以将 zip 文件的内容从 a 解压缩`Stream`到内存中。下面是从流 ( ) 中提取特定命名文件`LocalCatalogZip`并返回流以读取该文件的示例代码，但在此基础上进行扩展很容易。

```
private static MemoryStream UnZipCatalog()
{
    MemoryStream data = new MemoryStream();
    using (ZipFile zip = ZipFile.Read(LocalCatalogZip))
    {
        zip["ListingExport.txt"].Extract(data);
    }
    data.Seek(0, SeekOrigin.Begin);
    return data;
} 
```

它不是您现在使用的库，但如果您可以更改，您可以获得该功能。

* * *

这是一个变体，它将`Dictionary<string,MemoryStream>`为 zip 文件的每个文件的内容返回 a。

```
private static Dictionary<string,MemoryStream> UnZipToMemory()
{
    var result = new Dictionary<string,MemoryStream>();
    using (ZipFile zip = ZipFile.Read(LocalCatalogZip))
    {
        foreach (ZipEntry e in zip)
        {
            MemoryStream data = new MemoryStream();
            e.Extract(data);
            result.Add(e.FileName, data);
        }
    }

    return result;
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-11-29T12:02:23.740

我刚刚遇到了类似的问题，我发现我认为似乎相当优雅的答案是使用[#ZipLib](http://www.icsharpcode.net/OpenSource/SharpZipLib/)（可使用nuget）并执行以下操作：

```
private byte[] GetUncompressedPayload(byte[] data)
{
    using (var outputStream = new MemoryStream())
    using (var inputStream = new MemoryStream(data))
    {
        using (var zipInputStream = new ZipInputStream(inputStream))
        {
            zipInputStream.GetNextEntry();
            zipInputStream.CopyTo(outputStream);
        }
        return outputStream.ToArray();
    }
} 
```

这似乎奏效了。希望这可以帮助。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-10-03T21:35:25.890

是的，从使用`FastZip`To更改`new ZipFile(stream)`，但这仅在您的流可以搜索时才有效。（只需使用您的 MemoryStream`new ZipFile(fs);`而不是像示例中那样读取文件流。）

```
C#
using ICSharpCode.SharpZipLib.Core;
using ICSharpCode.SharpZipLib.Zip;

public void ExtractZipFile(string archiveFilenameIn, string password, string outFolder) {
    ZipFile zf = null;
    try {
        FileStream fs = File.OpenRead(archiveFilenameIn);
        zf = new ZipFile(fs);
        if (!String.IsNullOrEmpty(password)) {
            zf.Password = password;     // AES encrypted entries are handled automatically
        }
        foreach (ZipEntry zipEntry in zf) {
            if (!zipEntry.IsFile) {
                continue;           // Ignore directories
            }
            String entryFileName = zipEntry.Name;
            // to remove the folder from the entry:- entryFileName = Path.GetFileName(entryFileName);
            // Optionally match entrynames against a selection list here to skip as desired.
            // The unpacked length is available in the zipEntry.Size property.

            byte[] buffer = new byte[4096];     // 4K is optimum
            Stream zipStream = zf.GetInputStream(zipEntry);

            // Manipulate the output filename here as desired.
            String fullZipToPath = Path.Combine(outFolder, entryFileName);
            string directoryName = Path.GetDirectoryName(fullZipToPath);
            if (directoryName.Length > 0)
                Directory.CreateDirectory(directoryName);

            // Unzip file in buffered chunks. This is just as fast as unpacking to a buffer the full size
            // of the file, but does not waste memory.
            // The "using" will close the stream even if an exception occurs.
            using (FileStream streamWriter = File.Create(fullZipToPath)) {
                StreamUtils.Copy(zipStream, streamWriter, buffer);
            }
        }
    } finally {
        if (zf != null) {
            zf.IsStreamOwner = true; // Makes close also shut the underlying stream
            zf.Close(); // Ensure we release resources
        }
    }
} 
```

* * *

如果您使用的是不可搜索的流，请使用 ZipInputStream。

```
// Calling example:
    WebClient webClient = new WebClient();
    Stream data = webClient.OpenRead("http://www.example.com/test.zip");
    // This stream cannot be opened with the ZipFile class because CanSeek is false.
    UnzipFromStream(data, @"c:\temp");

public void UnzipFromStream(Stream zipStream, string outFolder) {

    ZipInputStream zipInputStream = new ZipInputStream(zipStream);
    ZipEntry zipEntry = zipInputStream.GetNextEntry();
    while (zipEntry != null) {
        String entryFileName = zipEntry.Name;
        // to remove the folder from the entry:- entryFileName = Path.GetFileName(entryFileName);
        // Optionally match entrynames against a selection list here to skip as desired.
        // The unpacked length is available in the zipEntry.Size property.

        byte[] buffer = new byte[4096];     // 4K is optimum

        // Manipulate the output filename here as desired.
        String fullZipToPath = Path.Combine(outFolder, entryFileName);
        string directoryName = Path.GetDirectoryName(fullZipToPath);
        if (directoryName.Length > 0)
            Directory.CreateDirectory(directoryName);

        // Unzip file in buffered chunks. This is just as fast as unpacking to a buffer the full size
        // of the file, but does not waste memory.
        // The "using" will close the stream even if an exception occurs.
        using (FileStream streamWriter = File.Create(fullZipToPath)) {
            StreamUtils.Copy(zipInputStream, streamWriter, buffer);
        }
        zipEntry = zipInputStream.GetNextEntry();
    }
} 
```

来自[ICSharpCode Wiki的示例](https://github.com/icsharpcode/SharpZipLib/wiki/Zip-Samples)

# c# - 在其他事件中使用拖放光标

> ID：12715946
> 
> 赞同：0
> 
> 时间：2012-10-03T20:00:56.360
> 
> 标签：c#, .net, windows, vb.net

在我正在处理的程序的某些使用过程中，我需要在复制某些内容时使用带有小加号的小虚线框来显示拖放光标。在 DragEnter 事件处理程序中，我可以将 e.Effect 设置为 DragDropEffects.Copy，但我需要在应用程序的其他地方执行相同的操作，因为我没有可以使用的 DragEventArgs 对象。

没有在我的项目中添加一个新的光标文件并手动创建与 Microsoft 的光标匹配的图形，（我确信这样做存在某种法律问题）在 C# 或 VB 中是否有任何选项可以让我得到那个没有 DragEnter 事件的光标样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:17:43.880

对于最少的工作量，您可以使用 .NET 的“SizeAll”游标。虽然我认为这并不完全是您所指的拖放，但它是在 Windows 中移动某些东西的通用图像。要在 C# 中执行此操作，请使用：

```
this.Cursor = Cursors.SizeAll; 
```

或者在 VB .NET 中，使用：

```
Me.Cursor = Cursors.SizeAll 
```

如果该游标不适合您，这里有一个链接显示所有可用的 .NET 游标及其名称：[表单上的所有游标](http://www.authorcode.com/show-all-cursors/)

# asp.net - 尝试在 Apache Mono 上托管 .net Web 应用程序

> ID：12715949
> 
> 赞同：1
> 
> 时间：2012-10-03T20:00:59.330
> 
> 标签：asp.net, linux, web-applications, mono

我的小组一直在使用托管在运行 IIS 的 Windows 服务器上的 BugTracker.NET (http://ifdefined.com/bugtrackernet.html)。我们需要将它重新定位到运行 Apache 的 OpenSUSE 支持的 Intranet 站点。

不幸的是，我在这台机器上没有 root。我已经能够与管理员合作并运行实际的 Web 服务器进程，可以访问一些配置文件和 sudo 重新启动 Web 服务器的能力，但到目前为止无法查看日志文件（即痛苦）。

我可以在服务器上运行一个简单的网页，它表明安装了 Mono 模块（Mono 版本：2.0.50727.42；ASP.NET 版本：2.0.50727.42）。bugtracker.net 的安装基本上是为了运行

```
 where BTNET = name of instance and CD = current directory

    C:\windows\System32\inetsrv\appcmd.exe add app 
    /site.name: "Web Name" /path:/%BTNET% /physicalPath:"%CD%\www" 
```

什么相当于在 Apache/mono 下添加这样的应用程序？指定物理路径等？有关如何安装此应用程序的任何建议？因为它是一个第三方应用程序，上面完成了许多自定义配置，所以我的偏好是将应用程序原样复制到新的 Linux 服务器上，但这不起作用，因为它没有安装。此应用程序中没有安装功能，可用于在 Windows IIS 以外的任何设备上进行安装。

我浏览了许多示例和文档，但没有找到任何提供此信息的内容。提前感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T15:35:17.013

首先要做的是快速测试您的应用程序是否至少基本上在单声道下工作。

我猜您的 Bugtracker 应用程序是作为存档（.zip 或其他）提供的？

在你的 Linux 机器上的任何位置解压它，然后“cd”到这个应用程序的根目录并启动 Mono light 应用程序服务器：

```
xsp4 --port 8080 
```

然后你应该看看有没有什么事情发生。

稍后，您应该按照[这个官方教程](http://www.mono-project.com/Mod_mono)来配置 Apache 并将您的应用程序定义为 Mono/Asp.Net 应用程序

# php - 字段中每个值的 MYSQL 计数

> ID：12715950
> 
> 赞同：1
> 
> 时间：2012-10-03T20:01:09.403
> 
> 标签：php, mysql, sql

我有一个带有下表“响应”的数据库，其中包含一个 ID 和一个美国州：

```
*id   *state
1     CA
2     NY
3     NY
4     CO
5     DE 
```

我正在使用 PHP 输出美国 50 个州中每个州的总行数

所以，我的输出看起来像：
CA: 1
NY: 2
CO: 1
DE: 1
etc...

我知道我可以像这样运行 50 个查询：

```
SELECT * 
FROM  `responses` 
WHERE state='CA' 
```

我的问题是：有没有更有效的方法来处理这个问题，还是我需要运行 50 个查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-03T20:02:35.837

使用`GROUP BY`子句：

```
SELECT state, COUNT(*) FROM `responses` GROUP BY state; 
```

使用 GROUP BY有[很多很好的教程](http://www.w3schools.com/sql/sql_groupby.asp)，它是 SQL 最有用和最强大的特性之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T20:03:52.447

您可以使用 MySQL 的[`GROUP BY`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)子句，它将按以下方式对所有结果进行分组`state`：

```
SELECT
    state, COUNT(*) AS count
FROM
    `responses`
GROUP BY
    state; 
```

# c# - 添加枚举值会破坏二进制兼容性吗？

> ID：12715951
> 
> 赞同：15
> 
> 时间：2012-10-03T20:01:13.427
> 
> 标签：c#, enums, binary-compatibility

想象一下 DLL 中的这个枚举。

```
public enum Colors
{
    Red,
    Green
} 
```

添加枚举值会破坏二进制兼容性吗？如果我要更改它，现有的 EXE 会损坏吗？

```
public enum Colors
{
    Red,
    Green,
    Blue
} 
```

我看到了[这个答案](https://stackoverflow.com/a/4766907)，但它似乎解决了*插入*值的情况。如果我**只在末尾**添加值，可以吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-10-03T20:06:09.323

不，这不会破坏二进制兼容性（就像：程序集仍将加载等），因为枚举基本上是整数文字常量。在中间插入值显然是一个非常危险的想法，但您已经排除了它。

但是，它可能会导致您需要防范的许多其他问题：

*   某些代码（`switch`尤其是语句）可能无法预料到新值；从技术上讲，这也是一个问题，因为枚举没有经过值检查（枚举变量可以包含未定义的值）
*   任何查询可用枚举的东西都会得到不同的结果
    *   特别是，如果存在使用特定客户端尚未预期的枚举的数据，则序列化和反序列化可能会意外失败

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T20:16:26.440

应该没问题，假设你只追加到最后。但是，中断的风险来自于枚举值是隐式定义的，从 0 开始。因此，如果有人将值持久保存到数据库，则可能会更改它们映射到的值。

例如，如果您将枚举更改为：

```
public enum Colors
{
    Blue,
    Red,
    Green
} 
```

将这些值存储在数据库中的任何人都会看到曾经是红色的东西现在是蓝色的，而现在是绿色的东西现在是红色的。

理想情况下，您应该像这样定义您的枚举：

```
public enum Colors
{
    Red = 0,
    Green = 1
} 
```

然后，当你添加一个新的，你应该有：

```
public enum Colors
{
    Red = 0,
    Green = 1,
    Blue = 2
} 
```

这将有助于防止任何潜在的版本控制问题。

# matlab - 将灰度图像中像素的uint8值转换为matlab中的二进制值

> ID：12715953
> 
> 赞同：1
> 
> 时间：2012-10-03T20:01:20.050
> 
> 标签：matlab, binary

我有一个灰度图像，在灰度图像中，每个像素都有一个 uint8 值。例如，当我使用 时`myImage(2, 3)`，我收到一个介于 0 到 255 之间的对应像素值。现在我想将此值转换为 8 位的二进制数组。例如：如果`myImage(2, 3)`等于 15，那么我希望这个像素的转换值是`00001111`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:14:35.097

`dec2bin(15, 8)`以字符串形式返回`00001111`。这里，8 指定二进制字符串的最小长度。

有关完整信息，请参见[此处](http://www.mathworks.nl/help/matlab/ref/dec2bin.html)。

如果你想要它作为一个矩阵，你可以这样做：

```
binstring = dec2bin(pixelVal, 8);
m = str2num(binstring(:))'; 
```

其中，pixelVal 为 15，结果为`m = [0 0 0 0 1 1 1 1]`.

# jquery - 收到 500 错误

> ID：12715958
> 
> 赞同：2
> 
> 时间：2012-10-03T20:01:26.737
> 
> 标签：jquery, asp.net, ajax, json, web-services

我正在使用 JQuery 和 Ajax 与 ASP.Net Web 服务进行交互。这是Jquery代码：

```
$.jrpc = function(url, id, method, params, success, error) {
    var request = $.json_stringify({
       'jsonrpc': '2.0', 'method': method,
        'params': params, 'id': id});
    return $.ajax({
        url: url,
        data: "json=" + encodeURIComponent(request),
        success: success,
        error: error,
        contentType: 'application/json; charset=utf-8',
        dataType: 'json',
        async: true,
        cache: false,
        //timeout: 1,
        type: 'POST'});
}; 
```

这是网络服务代码：

```
[WebService(Namespace = "http://tempuri.org/")]
[WebServiceBinding(ConformsTo = WsiProfiles.BasicProfile1_1)]
[ScriptService]
public class Access : System.Web.Services.WebService
{

    [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public string EntryMethod(string json)
    {
        Requests d = JsonConvert.DeserializeObject<Requests>(json);
        Response resp = new Response();
        resp.jsonrpc = d.jsonrpc;
        resp.result = "Got the call!";
        resp.id = d.id;
        resp.error = null;
        JavaScriptSerializer response = new JavaScriptSerializer();
        string r = response.Serialize(resp);

        return r;
    }
} 
```

我收到此错误：

[AJAX] 错误 - 服务器响应为：{"Message":"Invalid JSON primitive: json.","StackTrace":" at System.Web.Script.Serialization.JavaScriptObjectDeserializer.DeserializePrimitiveObject()\r\n at System.Web .Script.Serialization.JavaScriptObjectDeserializer.DeserializeInternal(Int32 depth)\r\n 在 System.Web.Script.Serialization.JavaScriptObjectDeserializer.BasicDeserialize(字符串输入，Int32 depthLimit，JavaScriptSerializer 序列化程序)\r\n 在 System.Web.Script.Serialization .JavaScriptSerializer.Deserialize(JavaScriptSerializer 序列化程序，字符串输入，类型类型，Int32 depthLimit)\r\n 在 System.Web.Script.Serialization.JavaScriptSerializer.Deserialize[T](字符串输入)\r\n 在 System.Web.Script .Services.RestHandler.GetRawParamsFromPostRequest（HttpContext 上下文，JavaScriptSerializer 序列化程序)\r\n 在 System.Web.Script.Services.RestHandler.GetRawParams(WebServiceMethodData methodData, HttpContext context)\r\n 在 System.Web.Script.Services.RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)" "ExceptionType":"System.ArgumentException"}

使用 ASP.Net webservice 测试页面，这里是我的标题和请求字符串： Cache-Control: private, max-age=0 Date: Wed, 03 Oct 2012 19:47:16 GMT Content-Length: 149 Content-Type:文本/xml；charset=utf-8 服务器：ASP.NET 开发服务器/10.0.0.0 X-AspNet-Version：4.0.30319 连接：关闭

json=%7B%22jsonrpc%22%3A%222.0%22%2C%22method%22%3A%22test%22%2C%22params%22%3A%5B%5D%2C%22id%22%3A1%7D

这是我的 Ajax 调用的标头/请求字符串，它不起作用： Cache-Control: private Date: Wed, 03 Oct 2012 19:47:09 GMT Content-Length: 1062 Content-Type: application/json; charset=utf-8 jsonerror: true 服务器：ASP.NET 开发服务器/10.0.0.0 X-AspNet-Version：4.0.30319 连接：关闭

json=%7B%22jsonrpc%22%3A%222.0%22%2C%22method%22%3A%22test%22%2C%22params%22%3A%5B%5D%2C%22id%22%3A1%7D

关于我为什么会收到此错误的任何想法？我试过用谷歌搜索它，但没有一个结果真的对我有帮助。

编辑：

如果我使用：数据：“{'jsonrpc':'2.0','method':'test','params':[],'id':1}”,

我收到此错误：[AJAX] 错误 - 服务器响应为：{“消息”：“无效的 Web 服务调用，参数缺失值：\u0027json\u0027。”，“StackTrace”：“在 System.Web.Script.Services .WebServiceMethodData.CallMethod（对象目标，IDictionary `2 parameters)\r\n at System.Web.Script.Services.WebServiceMethodData.CallMethodFromRawParams(Object target, IDictionary`2 参数）\r\n 在 System.Web.Script.Services.RestHandler.InvokeMethod（HttpContext 上下文，WebServiceMethodData methodData，IDictionary`2 rawParams）\r\n 在 System.Web.Script .Services.RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)","ExceptionType":"System.InvalidOperationException"}

如果我使用： data: "json={'jsonrpc':'2.0','method':'test','params':[],'id':1}",

我收到此错误：[AJAX] 错误 - 服务器响应为： {"Message":"Invalid JSON primitive: json.","StackTrace":" at System.Web.Script.Serialization.JavaScriptObjectDeserializer.DeserializePrimitiveObject()\r\ n 在 System.Web.Script.Serialization.JavaScriptObjectDeserializer.DeserializeInternal(Int32 depth)\r\n 在 System.Web.Script.Serialization.JavaScriptObjectDeserializer.BasicDeserialize(String input, Int32 depthLimit, JavaScriptSerializer 序列化程序)\r\n 在 System. Web.Script.Serialization.JavaScriptSerializer.Deserialize（JavaScriptSerializer 序列化程序，字符串输入，类型类型，Int32 depthLimit）\r\n at System.Web.Script.Serialization.JavaScriptSerializer.Deserialize[T]（字符串输入）\r\n at System.Web.Script.Services.RestHandler.GetRawParamsFromPostRequest（HttpContext 上下文，JavaScriptSerializer 序列化程序)\r\n 在 System.Web.Script.Services.RestHandler.GetRawParams(WebServiceMethodData methodData, HttpContext context)\r\n 在 System.Web.Script.Services.RestHandler.ExecuteWebServiceCall(HttpContext context, WebServiceMethodData methodData)" "ExceptionType":"System.ArgumentException"}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T20:51:33.800

将数据：“json=”+encodeURIComponent(request)，更改为
数据：“{json:'”+encodeURIComponent(request)+“'}”，

见示例代码

```
 $.ajax("WebService.asmx/EntryMethod", {
        contentType: "application/json; charset=utf-8",dataType: "json",
        type: "POST", data: "{json:'value'}", success: function (r) { alert(r); },
        error: function (e) { alert(e); }
    }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T20:10:06.150

尝试从 data 属性中删除 'json='，并确保 encodeURIComponent(request) 是一个 json 对象，我猜它不是。

# bison - 语法规范解决 Shift/Reduce 冲突

> ID：12715961
> 
> 赞同：6
> 
> 时间：2012-10-03T20:01:32.610
> 
> 标签：bison, context-free-grammar, shift-reduce-conflict, jison

我正在使用 Jison (Bison) 创建一个简单的标记语言。我显然对此很陌生，但细微的变化效果很好。我只是不明白 S/R 冲突的根源。

两个词法分析器操作（具有不同的开始条件）返回“文本”似乎并不重要，我喜欢这个，因为它似乎允许语法有更少的规则，而且给用户的错误消息是一致的。无论上下文如何，我都尝试使“文本”规则通用，并且我还尝试为每个标记赋予不同的名称，但是当它们一起出现时，它似乎对 S/R 冲突没有任何影响。

解析器应该创建一个带有纯文本、子数组和各种特殊节点的 json 对象。

规格：

```
/* lexical grammar */
%lex

%s bracketed

%%

<bracketed>(\\.|[^\\\,\[\]])+       { yytext = yytext.replace(/\\(.)/g, '$1'); return 'Text'; }
<INITIAL>(\\.|[^\\\[])+             { yytext = yytext.replace(/\\(.)/g, '$1'); return 'Text'; }
"["                                 { this.begin('bracketed'); return '['; }
"]"                                 { this.popState(); return ']'; }
","                                 return ','
<<EOF>>                             return 'END'

/lex

%start template

%%    

template
    : sentence END
    ;

sentence
    : /* empty */
    | sentence Text
    | sentence '[' ']'
    | sentence '[' dynamic ']'
    ;

dynamic
    : sentence
    /*| dynamic ',' sentence*/
    ; 
```

警告：

```
Conflict in grammar: multiple actions possible when lookahead token is ] in state 5
- reduce by rule: sentence ->
- shift token (then go to state 6)

States with conflicts:
State 5
  sentence -> sentence [ .] #lookaheads= END Text [ ]
  sentence -> sentence [ .dynamic ] #lookaheads= END Text [ ]
  dynamic -> .sentence #lookaheads= ]
  sentence -> . #lookaheads= ] Text [
  sentence -> .sentence Text
  sentence -> .sentence [ ]
  sentence -> .sentence [ dynamic ] 
```

不同的生成器算法或多或少都有问题，但它们似乎都有问题。

谢谢！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-10-03T22:22:39.497

冲突从根本上来自以下两条规则：

```
sentence: sentence '[' Text ']'
        | sentence '[' sentenceList ']' 
```

原因是在看到 a`sentence`和 a`[`并查看下一个标记是`Text`之后，解析器不知道是移动`Text`，匹配第一条规则，还是将其`Text`视为`sentenceList`匹配第二条规则的开始。

现在，如果您有一个使用 2-token 前瞻的解析器生成器，这不会有问题，但 bison 是 LALR(1)（1 是一个 token 前瞻）。

您可以尝试以下几件事：

*   在词法分析器中进行额外的前瞻，以区分 Text-followed-by-] 和 Text-not-followed-by-] 作为两个不同的标记，然后重写规则以使用这两个标记。

*   使用 bison 的 %glr-parser 功能来使用 GLR 解析器。这将双向解析句子，然后丢弃不匹配的句子

*   重构语法以不需要 2-token 前瞻。

适用于您的情况的一种重构是重写`sentence`规则以使它们全部右递归而不是左递归：

```
sentence: /* empty */
        | Text sentence 
        | '[' ']' sentence
        | '[' Text ']' sentence
        | '[' sentenceList ']' sentence
        ; 
```

这避免了`sentence`（或任何其他以`sentence`诸如`sentenceList`开头的规则）以规则的空归约开始`sentence: /*empty*/`。因此，解析器可以`Text`在有问题的情况下自由移动 a ，将缩减推迟到它看到下一个标记。然而，它确实有内存使用的影响，因为它导致解析器本质上将整个输入转移到解析器堆栈，然后一次减少一个句子。

您可以做的另一个重构是将`[Text]`and`[]`构造包含到`[sentenceList]`：

```
sentence: /* empty */
        | sentence Text 
        | sentence '[' sentenceList ']'
        ;

sentenceList: sentence
            | sentenceList ',' sentence 
```

所以现在 a`sentenceList`是一个或多个用逗号分隔的句子（而不是两个或多个），并且在`sentence '[' sentenceList ']'`规则的操作中，您将检查`sentenceList`它是否是两个或多个句子并采取适当的行动。

# pdf - IE9 错误？打开 PDF 会在执行以下任何操作时出现白屏

> ID：12715967
> 
> 赞同：2
> 
> 时间：2012-10-03T20:01:52.363
> 
> 标签：pdf, iframe, internet-explorer-9, acrobat

当我们在 iframe 中打开包含 PDF 文件的页面时使用 IE9（不是 64 位），采取的任何其他操作都会破坏我们的 UI（完全白屏）。

这里举个例子。

使用此链接：[http ://unik.caij.qc.ca/default.aspx?&unikid=70131](http://unik.caij.qc.ca/default.aspx?&unikid=70131)

一旦您点击超链接`<-Retour à la liste des résultats`，您将看到一个空白屏幕，但 DOM 元素似乎在那里。

知道我们的代码、IE9、PDF 插件可能出了什么问题吗？是渲染问题吗？？

这只发生在 IE9 上。

我做了所有的 Windows 更新和 adobe reader X 更新。

# javascript - 如何取消延迟的 DOM 元素移除

> ID：12715968
> 
> 赞同：1
> 
> 时间：2012-10-03T20:01:53.103
> 
> 标签：javascript, jquery, settimeout

我试图在延迟后删除一个 DOM 元素。我还希望通过用户单击取消此删除（如果他们在计时器到期之前单击。这就是我所拥有的：

`<div class="delete">Delete me!</div>`

显然，我只显示相关来源。

```
$("div.delete").click(function() {
    var element = $(this),
        timeout = element.attr('data-timeout');
    if (timeout) {
        clearTimeout(timeout);
        element.removeAttr('data-timeout');
        element.text("Delete me!");
    } else {
        timeout = setTimeout(function() {
            element.remove();
            alert('Sniff, too late!');
        }, 2000);
        element.attr('data-timeout', timeout);
        element.text("Save me!");
    }
}); 
```

这行得通！我的问题

1.  有没有更好的办法？我第一次失败的尝试有多个处理程序。
2.  为什么它在 Javascript 1.7 中不起作用？

[http://jsfiddle.net/zhon/H8a9J/](http://jsfiddle.net/zhon/H8a9J/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-03T20:20:55.763

它不适用于 JavaScript 1.7，因为您使用的浏览器不支持它和/或它的嵌入方式。你的小提琴适用于 Firefox。

[http://en.wikipedia.org/wiki/Comparison_of_layout_engines_%28ECMAScript%29](http://en.wikipedia.org/wiki/Comparison_of_layout_engines_%28ECMAScript%29)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T20:10:46.890

您需要`timeout`在处理程序之外定义。

```
var timeout;
$("div.delete").click(function() {
    var element = $(this);
    if (timeout) {
        clearTimeout(timeout);
        timeout = undefined;
        element.text("Delete me!");
    } else {
        timeout = setTimeout(function() {
            element.remove();
            alert('Sniff, too late!');
        }, 2000);
        element.text("Save me!");
    }
}); 
```

我建议将代码附在其他函数中以添加处理程序，以避免使用超时 ID 混淆全局命名空间。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-10-03T20:04:52.717

制作`timeout`一个全局，并在用户单击时将其清除。

```
clearTimeout(timeout); 
```

# excel - ForEach 循环对象需要错误

> ID：12715971
> 
> 赞同：2
> 
> 时间：2012-10-03T20:02:00.970
> 
> 标签：excel, foreach, vba

**摘要：**我有一个使用循环在 A 列中循环的策略编号`for each`列表

**问题：**一切正常，除非 A 列中有一个空单元格，我的代码会删除整行（应该如此），但是当我尝试设置`policy`变量时出现`object required` 错误。我已经在我的代码中标记了发生错误的位置。

**问题：**如何删除空行而不`theCell`丢失其对象？

**编码：**

```
Dim theRange As Range
    Dim theSheet As Worksheet
    Dim theDate As String, policy As String, amount As String, details As String, entryDate As String

    Set theSheet = Sheets("OneDate")
    Set theRange = Range("A2:A" & theSheet.UsedRange.Rows.Count)

    For Each theCell In theRange                'FOR EACH POLICY IN COLUMN "A"

        If theCell.Value = "" Then

            theCell.EntireRow.Delete      '<-- Row deleted here
            MsgBox (theCell.Value)

        End If

        policy = theCell.Value            '<-- Error occurs here
        theDate = theCell.Offset(0, 1).Value
        theDate = UCase(Format(theDate, "ddMMMyy")) 
```

提前感谢您的帮助！:)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-03T20:18:54.527

这是一种不同的方式来做你想做的事。

离开循环。从之前的实验来看，如果您使用 for 循环遍历行，则每次删除一行时，您最终都会跳过删除行之后的行。此外，正如您所指出的，您删除的范围不能再被引用，因为您删除了它。

要根据第一列删除所有空白行，请将您的代码更新为：

```
Dim theRange As Range
        Dim theSheet As Worksheet
        Dim theDate As String, policy As String, amount As String, details As String, entryDate As String

        Set theSheet = Sheets("OneDate")
        Set theRange = Range("A2:A" & theSheet.UsedRange.Rows.Count)
'Editted in some perfunctory error trapping incase of no blank rows.
on error resume next
debug.print theRange.SpecialCells(xlCellTypeBlanks).count
on error goto 0
if err.number = 0 then
    theRange.SpecialCells(xlCellTypeBlanks).EntireRow.Delete
end if 
```

删除空白后，*然后*循环进行其他检查。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-03T20:05:11.060

我假设您只关心 theCell 如果它不为空。这是您的代码的更新，将 Else 添加到您的 If 结构中

```
Dim theRange As Range, lLastRow as long, lRowLoop as long
    Dim theSheet As Worksheet
    Dim theDate As String, policy As String, amount As String, details As String, entryDate As String

Set theSheet = Sheets("OneDate")
Set theRange = Range("A2:A" & theSheet.UsedRange.Rows.Count)
lLastRow =cells(rows.count,1).end(xlup).row

For lRowLoop=lLastRow to 2 step-1 'from last row to first row

    set theCell=cells(lRowLoop,1)

    If theCell.Value = "" Then

        theCell.EntireRow.Delete      '<-- Row deleted here
        MsgBox (theCell.Value)

    Else 

    policy = theCell.Value            '<-- Error occurs here
    theDate = theCell.Offset(0, 1).Value
    theDate = UCase(Format(theDate, "ddMMMyy"))

    End If 
```

# linux - 在 R 中停止 nohup 并行模拟

> ID：12715982
> 
> 赞同：2
> 
> 时间：2012-10-03T20:02:37.413
> 
> 标签：linux, r, multicore, nohup

我需要取消在 Linux 服务器上使用 R 启动的并行处理模拟。

昨晚我使用 ssh 连接到服务器并使用 nohup 命令从 shell 开始模拟： nohup R CMD BATCH mysimulation.R

mysimulation.R 文件使用 multicore 包中的 mclapply 命令生成额外的 R 实例以并行运行模拟。例如，当我在 shell 中运行 top 时，我看到 10 个不同的 R 实例正在运行，然后完成了一次模拟运行，然后再次开始以继续进行额外的模拟复制。

我几乎没有直接使用 Linux 服务器的经验（我的知识范围是 cd、ls 和上面提到的 nohup 命令）。我[四处寻找](https://stackoverflow.com/questions/8007380/how-to-kill-a-nohup-process)解决方案，并认为终止该过程可能有效。我试过了：

kill -9 mypid （表示它杀死了进程）。

但是，模拟继续运行。我可以看到 R 的实例继续运行、关闭和重生。谁能指出我的资源或指导我完成关闭此模拟所需的具体步骤？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:52:12.800

看来您需要一次杀死多个进程。[也许杀死所有子进程的最佳方法](https://stackoverflow.com/q/392022/1707274)帖子的答案之一 可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T00:30:38.900

您可能会看到[此页面](http://board.issociate.de/thread/245813/How-to-cancel-nohup.html)。我希望这会有所帮助

# sql-server - 为什么对更少行的全文查询比对更多行的相同查询慢？

> ID：12715986
> 
> 赞同：0
> 
> 时间：2012-10-03T20:02:53.490
> 
> 标签：sql-server, full-text-search, contains, database-performance

此查询需要 21 秒：

```
SELECT Top 50 ROW_NUMBER() OVER (ORDER BY aDate DESC) AS Row, aID, aHeadline, aAuthor, aDate, TopStory, SiteSectionID, PrintSection, aSummary, small_image, aBody FROM articles 
WHERE aLive = -1 AND full_story = -1 AND aDate >= '9/3/2012' AND aDate <= '10/3/2012' AND (Contains((aAuthor,aBody,aHeadline,aSubhead,aSummary), '"kodak"')) 
ORDER BY aDate DESC 
```

此查询需要 1 秒：

```
SELECT Top 50 ROW_NUMBER() OVER (ORDER BY aDate DESC) AS Row, aID, aHeadline, aAuthor, aDate, TopStory, SiteSectionID, PrintSection, aSummary, small_image, aBody FROM articles 
WHERE aLive = -1 AND full_story = -1 AND aDate >= '9/3/2002' AND aDate <= '10/3/2012' AND (Contains((aAuthor,aBody,aHeadline,aSubhead,aSummary), '"kodak"')) 
ORDER BY aDate DESC 
```

唯一不同的是日期范围。如果没有查询的包含部分，它们分别返回 255 和 39,106 行。

对我来说，对 39K 行的全文查询比对 255 行的查询要快，这没有任何意义。

没有包含的第二个查询需要将近 2 分钟。这让我更加困惑。

其他注意事项：

*   aDate 是具有非唯一索引的日期时间字段
*   aLive 是具有非唯一索引的 int 字段
*   full_story 是一个具有非唯一索引的 int 字段

# vb.net - 创建 Oracle 连接会导致 COM 类检索出错

> ID：12715989
> 
> 赞同：3
> 
> 时间：2012-10-03T20:03:04.990
> 
> 标签：vb.net, oracle

我正在用 VB.NET 编写一个应用程序，它要求我使用 Oracle 数据访问客户端查询一个 Oracle 数据库。然后，我使用称为 SCAPI 接口的东西来访问我们用于数据建模的应用程序的元数据。

我已将问题简化为仅通过单击表单上的按钮执行的两个功能。

当我单击表单上的按钮时执行此功能。它创建了一个 oracle 连接，但实际上并不执行任何查询（因为我已将其余部分注释掉，但仍然出现错误）：

```
Private Sub btnDisplayDirectories_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnDisplayDirectories.Click
    Dim ModelMart As String = "Data Source=...;User Id=...;Password=...;"
    Dim OraConn As New OracleConnection(ModelMart)
    OraConn.Open()
    OraConn.Close()
    OraConn.Dispose()
End Function 
```

此函数只是使用 SCAPI 接口创建应用程序对象：

```
Private Sub btnOpenModel_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)         Handles btnOpenModel.Click
    Dim oAPI As New SCAPI.Application
End Sub 
```

如果我启动应用程序没有问题，首先单击 btnOpenModel，然后单击 btnDisplayDirectories。如果我单击 btnDisplayDirectories，然后单击 btnOpenModel，我会在 btnOpenModel 的第一行收到一条错误消息：

```
Retrieving the COM class factory for component with CLSID {2B2219EB-EDE7-49EE-BB89-5A0B4A398A63} failed due to the following error: 80004005. 
```

我实际上已经尝试过了，我什至不必打开 Oracle 连接来得到这个错误，只需定义 Oracle 连接就会导致错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-05T18:27:13.653

我通过创建 SCAPI.Application 对象作为全局变量解决了这个问题。这会导致 SCAPI 在数据库对象之前获得它需要的任何资源。我无法弄清楚为什么 SCAPI 和 Oracle/ODBC 程序集不能相互配合。

# jquery - 如何使高度上升（向上滑动）并使内容显示出来？

> ID：12715990
> 
> 赞同：0
> 
> 时间：2012-10-03T20:03:10.393
> 
> 标签：jquery, html, css, jquery-animate

我今天玩了很长时间，试图在没有知识的情况下完成一些事情。但是我对这个解释做了一个JS小提琴，所以我希望有人能帮助我。

让我们进入正题。

我有4个小盒子。每个盒子都是 15x15px 就像这个[**Fiddle**](http://jsfiddle.net/H7fPD/2/)一样。

```
<div class="js-fiddleWrap">
    <div id="letterA">Letter A opened-content.</div>
    <div id="letterB">Letter B opened-content.</div>
    <div id="letterC">Letter C opened-content.</div>
    <div id="letterD">Letter D opened-content.</div>

    <nav class="collapseMenu">
        <ul>
            <li>A</li>
            <li>B</li>
            <li>C</li>
            <li>D</li>
        </ul>
    </nav>
</div>​ 
```

单击一个框动画开始，框变得更高（更长）并获得 45 像素而不是 15 像素。它也上升了，所以看起来它正在使用这个脚本上升。

```
$(document).ready(function() {
    var $collapseMenu = $('.collapseMenu li');

    $collapseMenu.on('click', function() {
        $(this).animate({
            'bottom': '30',
            'height': '45',
        });
    });
});​ 
```

虽然我做了这个，但我认为这是错误的。在这个动画之后，还有更多我无法完成的事情。

我有一些隐藏的内容，就像小提琴一样。示例 A、B、C 和 D 的内容。因此，每个被点击的框都会升起，显示内容，然后如果点击了相同或不同的框，则隐藏内容。

我也无法创建最小化的后退效果。意思是如果相同的框在它升起并显示内容后再次单击，它将回到默认位置。同样，如果单击不同的框，也会发生同样的事情。它将隐藏以前打开的框并将其最小化。

### [小提琴](http://jsfiddle.net/H7fPD/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T20:14:46.473

试试这个**[jsFiddle 例子](http://jsfiddle.net/j08691/H7fPD/4/)**

**jQuery**

```
var $collapseMenu = $('.collapseMenu li');
$collapseMenu.on('click', function() {
    $collapseMenu.stop(true,true).animate({
        'bottom': '0',
        'height': '15'
    });
    if($(this).height() != 45 ) $(this).stop(true,true).animate({
        'bottom': '30',
        'height': '45'
    });
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T20:24:59.963

一个简单的解决方案是使用 .toggle

```
$(document).ready(function() {
    var $collapseMenu = $('.collapseMenu li');

    $collapseMenu.toggle(
//odd clicks
    function(){
        $(this).animate({
            'bottom': '30',
            'height': '45',
        });
    },
//even clicks
    function(){
        $(this).animate({
            'bottom': '0',
            'height': '15',
        });
    });

});​ 
```

现在您可以向它添加额外的逻辑来检查是否有任何其他框被切换，或者简单地将所有其他框设置为底部：0；身高：15；单击任何框

# php - 如何使用 jquery-ajax 提交表单数据？

> ID：12715994
> 
> 赞同：0
> 
> 时间：2012-10-03T20:03:15.940
> 
> 标签：php, javascript, jquery, ajax

我不知道为什么我没有得到它。不管怎样，这让我难以置信。我浏览了 2 本书、网络教程和堆栈溢出帖子，但我仍然不明白。

我正在尝试构建一个搜索过滤器栏，用户可以在其中选择过滤器，并在单击“优化结果”时修改查询输出。

如何将用户使用 jquery/ajax 选择的任何表单单选框的值提交到 php 页面，该页面将根据输入显示结果，无需刷新页面。

1.  表格-->
2.  用户选择单选按钮值并单击提交-->
3.  表单数据通过 jquery/ajax 发送到 .php 页面，该页面的输出将在不刷新页面的情况下显示-->
4.  .php 文件处理用户输入并基于它创建输出

老实说，我浏览了很多不同的答案，但他们都认为读者比我对 javascript/jquery 有更深入的了解。

就像，我是否必须将 jQuery/ajax 放在运行我的提交按钮的“onclick”的函数中？还是我只是`.click`为我的按钮 ID 添加一个事件处理程序？

假设我是一个完整的 jQuery/ajax 菜鸟，有人可以向我解释这一切吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T20:16:52.397

您只需将 ajax 调用附加到单击提交按钮时来自表单的“提交”事件：

```
$('form').submit(function(e){
    e.preventDefault();
    $('.content').load(this.action+" .content", $(this).serialize(), function(){
        // code to execute after result display if needed
    });
    return false;
}); 
```

我假设您的结果显示在具有“内容”类的元素中。

1.  `$('form')`选择您的表格，您可以对其进行个性化设置
2.  `.submit`将事件处理程序附加到表单“提交事件
3.  `e.preventDefault()`并`return false`防止表单被实际提交
4.  `$('.content').load`将使用 ajax 调用结果填充“内容”类的元素
5.  `this.action`是提交表单的 URL
6.  `" +.content"`在这里只提取响应中的结果部分，而不是整个 html 页面
7.  `$(this).serialize()`将表单字段数据传递给 ajax 请求
8.  finally 显示结果后调用最后一个匿名函数，可用于触发一些视觉效果，表明结果已更新

# python - Python。将 2 个列表转换为一个字典对象

> ID：12715999
> 
> 赞同：2
> 
> 时间：2012-10-03T20:03:29.617
> 
> 标签：python, list, dictionary, list-comprehension

> **可能重复：**
> [将两个列表映射到 Python 中的字典](https://stackoverflow.com/questions/209840/map-two-lists-into-a-dictionary-in-python)

我有 2 个这样的列表： ['one', 'two', 'three'] 和 [1, 2, 3]

我想把它变成这样的字典 {'one':1, 'two':2, 'three':3}

问题是我必须使用理解。谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-03T20:04:32.103

```
keys=['one', 'two', 'three'] 
values= [1, 2, 3]
dictionary = dict(zip(keys, values)) 

>>> print dictionary
{'one': 1, 'two': 2, 'three': 3} 
```

看看[内置函数](http://docs.python.org/library/functions.html#zip)，它们通常会变得很方便。您可以从 Python 2.7 开始使用 dict 理解，但它们不应该是这样做的方法：

```
{k: v for k, v in zip(keys, values)} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-03T20:05:16.533

```
keys = ['one', 'two', 'three']
values = [1, 2, 3]
dict(zip(keys, values)) 
```

这已经是最pythonic的方式了。

如果你真的必须的话，你可以使用[dict comprehension](http://docs.python.org/reference/expressions.html#dictionary-displays)：

```
{k: v for k,v in zip(keys, values)} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-03T20:05:05.477

```
dict(zip(list1, list2)) 
```

可能是最好的方法。不要使用推导式，这是一个愚蠢的要求。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-03T20:13:47.817

好吧，如果你必须：

```
keys = ['one', 'two', 'three']
values = [1,2,3]
d = {a:b for a,b in zip(keys,values)} 
```

但说真的，只需使用`dict(zip(keys, values))`