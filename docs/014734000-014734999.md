# StackOverflow 问答 14734000-14734999

# mount - 改进 Proxmox PVE (OpenVZ) 服务器上的挂载参数如何

> ID：14734002
> 
> 赞同：0
> 
> 时间：2013-02-06T16:29:22.337
> 
> 标签：mount, openvz

我们正在尝试改进我们的分区和挂载点，同时通过拆分一些分区来迁移新的（Proxmox PVE 2）服务器，以便使用特定参数（如 noatime、data=writeback、barrier=0、nobh 等）改进挂载点web 文件、mysql 等 我们目前仅使用通过主机绑定挂载共享数据分区的 OpenVZ 容器。这是从主机 /data/xxxx 目录挂载的数据目录。该 /data 分区具有分配的特定参数。

我不确定是否：

*   容器上的绑定挂载继承了这种类型的任何挂载规范，还是需要在 VIDXXX.mount 文件上重新分配？

*   我知道有一个 vzctl 参数可以通过命令行强制它...“vzctl set veid --noatime yes --save”但是是否有任何其他形式（通过 conf 文件）包含“noatime”或其他挂载选项对于 VM 根本身，或者它们也将继承自 /var/lib/vz/ 挂载选项

*   如果系统根分区包含 noatime 等参数，PVE 本身是否存在任何问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-13T18:57:50.797

> [资源](http://www.howtoforge.com/openvz-mounting-host-devices-partitions-directories-in-a-container-with-bind-mounts-debian-ubuntu)

如果要添加 noatime 等挂载选项，可以将 -o 开关添加到挂载行，例如如下：

```
#!/bin/bash
. /etc/vz/vz.conf
. ${VE_CONFFILE}

SRC=/mnt/sdb1
DST=/var/lib/mysql
if [ ! -e ${VE_ROOT}${DST} ]; then mkdir -p ${VE_ROOT}${DST}; fi
mount -o noatime -n -t simfs ${SRC} ${VE_ROOT}${DST} -o ${SRC} 
```

使脚本可执行...

```
chmod +x /etc/vz/conf/101.mount 
```

# forth - 自定义解释器

> ID：14734008
> 
> 赞同：3
> 
> 时间：2013-02-06T16:29:39.273
> 
> 标签：forth

我正在尝试在[Gforth](http://en.wikipedia.org/wiki/Gforth)中编写解释器，但它不起作用。我得到的只是一个无限的列表 num num num ...

```
: ?refill
  source nip >in @ =
  if
    refill drop
  then
  ;

: inter
  begin
    ?refill
    bl word find dup
    if
      state @ =
      if
        ." comp "
        ,
      else
        ." exec "
        execute
      then
    else
      dup rot count >number
      if
        abort
      then
      drop drop state @
      if
        ." lit "
        ['] lit , ,
      else
        ." num "
      then
    then
  again
  ;

inter

: test 10 20 ; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T17:25:20.123

您的解释器确实可以工作，只是不会阻塞，请查看输出中的前几个单词：

```
num exec lit lit exec num num num ... 
```

但是，您将 a`0`留在堆栈上的某个地方，这就是您创建堆栈溢出的原因，您可以`~~`在代码中使用它来检查堆栈并跟踪 unconsumed `0`。

Bernd Paysan 向 GForth 介绍了[识别](http://www.complang.tuwien.ac.at/anton/euroforth/ef12/papers/paysan-recognizers-ho.pdf)器，我建议你看看它们，因为它们可以减轻你编写解释器的任务。

# php - 选中的每个 $_POST 复选框的 PHP MySQL INSERT 脚本

> ID：14734009
> 
> 赞同：-1
> 
> 时间：2013-02-06T16:29:41.150
> 
> 标签：php, mysql, checkbox, foreach

基本上，用户填写表格以输入产品，然后通过勾选这些用户的复选框来声明该产品是“特定于”用户的。

产品名称： foo

特定用户：

*   鲍勃
*   账单
*   本
*   抢

因此，用户可以“检查”1 个或多个用户来链接产品。

我已经设置了数据库表：

用户 | 用户名 | 姓名 |

产品 | 产品ID | 姓名 |

链接表 | 链接ID | 产品ID | 用户名 |

我想要发生的是当用户检查“Bill”和“Ben”并单击“提交”时，将产品添加到产品表中，返回新的 productID，在 INSERT 脚本上发生循环以添加将每个已检查用户的 productID 和 userID 记录到 LINKTABLE 中。

到目前为止，我已经完成了插入产品详细信息并返回 productID 的工作，但我正在努力使用循环将 productID 和 userID 插入到链接表中。

```
$product = $_POST["product"];

$sql = "INSERT INTO products ('name') VALUES ($product);
$result = mysql_query($sql);

$newProductID = mysql_insert_id(); 
```

我试过这个：

```
if(!empty($_POST['users'])) {
foreach($_POST['users'] as $userID)
    {
        $sql = "INSERT INTO linktable (productID, userID) VALUES (".$newProductID.", ".$userID.")";
        $result = mysql_query($sql) or die(mysql_error()."<br />".$sql);
    } 
```

但这引发了以下错误：

> 警告：在 .... 中为 foreach() 提供的参数无效

在“foreaach”循环的行上。

任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:33:42.720

`$_POST['users']` is going to be a string no? I haven't done PHP in a while, but you can't POST an array or anything, only a string. So your can't foreach over a string.

What type of data is `$_POST['users']`? Is it a list. I am more familiar with Coldfusion where you can loop over a list using different syntax, but I am pretty sure you'll have to check the data of your post variable and act on it accordingly.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:40:05.553

我怀疑这`$_POST['users']`不是一个数组。你的复选框在你的 html 中是什么样子的？他们需要看起来像这样：

```
<input type="checkbox" name="users[]" value="Bob">Bob
<input type="checkbox" name="users[]" value="Bill">Bill
<input type="checkbox" name="users[]" value="Ben">Ben 
```

注意名字`users[]`

现在你可以这样做：

```
foreach ($_POST['users'] as $user) {
    // do something
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:41:35.563

如果你想使用：

```
foreach($_POST['users'] as $userId) 
```

然后在 HTML 中需要一个复选框数组，并将`value`属性设置为 ID，如下所示：

```
Bob <input type="checkbox" name="users[]" value="101" />
Bill <input type="checkbox" name="users[]" value="102" />
Ben <input type="checkbox" name="users[]" value="103" /> 
```

注意`[]`名称中的使用，这使它成为一个数组。

# c++ - 列表视图组合框

> ID：14734014
> 
> 赞同：0
> 
> 时间：2013-02-06T16:29:46.440
> 
> 标签：c++, winapi, listview, combobox

我已将组合框添加到我的自定义列表视图中，并且我正在尝试将组合框的文本设置为当前的列表视图子项。

```
 case CBN_SELCHANGE:
                {
                    char txt[200];
                    ComboBox_GetText(hCombo, txt, 256);
                    int i = SendMessage(hListView, LVM_GETHOTITEM,0, 0);
                    ListView_SetItemText(hListView, i, 2, txt);
                } 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:17:41.777

列表视图“热”项是光标悬停在其上的项，并且仅在启用热跟踪和热选择时。[LVM_GETHOITEM](http://msdn.microsoft.com/en-US/library/bb774939%28v=vs.85%29.aspx)的 SDK 文档在解释什么是热门项目方面做得很差。[CListCtrl::GetHotItem](http://msdn.microsoft.com/en-US/library/hb54yxeb%28v=vs.80%29.aspx)文档提供了更多细节。

在您从组合框中进行选择时，光标不会悬停在列表框中的任何项目上，因此不会设置任何文本。

您可能希望获得选定的项目：

```
int i = ListView_GetNextItem(hListView, -1, LVNI_SELECTED); 
```

[这篇文章](https://stackoverflow.com/q/2690125/416627)有更多信息。

# java - Ivy.xml 和 selenium jar 保存在服务器上时的 Eclipse-Ivy-Selenium 配置

> ID：14734016
> 
> 赞同：0
> 
> 时间：2013-02-06T16:29:48.147
> 
> 标签：java, selenium, ivy

我们试图使用 Selenium-Eclipse-Ivy 自动化测试脚本。selenium jar 文件必须通过服务器上保存的 ivy.xml 和 ivysettings.xml 调用。我们不允许下载 Jar 文件或 XML 文件。我们无法理解如何使用这些 XML 文件来调用 jar。此外，我们不允许修改这些文件。请帮助我们，因为我们无法解决这个问题。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:59:43.490

与[设置](http://ant.apache.org/ivy/history/latest-milestone/use/settings.html)任务不同，常春藤[解析](http://ant.apache.org/ivy/history/latest-milestone/use/resolve.html)任务不支持“url”参数。这意味着“ivy.xml”必须存在于本地，而“ivysettings.xml”可以很高兴地存在于服务器上。

如果您真的不支持本地 ivy.xml 文件，我能想到的唯一选择是[缓存路径](http://ant.apache.org/ivy/history/latest-milestone/use/cachepath.html)任务，列出构建文件中的依赖项。

```
<ivy:cachepath pathid="compile.path">
    <dependency org="org.seleniumhq.selenium" name="selenium" rev="2.0rc2"/>
</ivy:cachepath> 
```

最后，我真的不明白你不允许下载jar文件是什么意思。

# jquery - 将 jQuery fadeIn() 插入函数

> ID：14734029
> 
> 赞同：0
> 
> 时间：2013-02-06T16:30:15.500
> 
> 标签：jquery, fadein

我正在使用一个预先存在的 jQuery 脚本，该脚本在旋转 div 时使用 .FadeOut。这样做的问题是 div 淡出，但下一个以某种方式旋转的 div 会卡入到位而不是淡入。我试图找出一种简单的方法来添加 .fadeIn() 而无需从头开始重建函数，但是我的 JS 技能让我失望了。有没有一种简单的方法来调整我缺少的这个脚本，或者我应该重建它？

```
function rotate() {
            $('div.divRT').each(function (index, value) {
                var nextDv = $(this).find('div.stDv:visible').next('div.stDv');
                if (nextDv.html() == null) {
                    nextDv = $(this).find('div.styDv:first-child');
                }
                $(this).find('div.stDv:visible').fadeOut(400, function () { nextDv.show(); });
            });

            timer = setTimeout(rotate, 4000);
        } 
```

有问题的部分是：

```
$(this).find('div.stDv:visible').fadeOut(400, function () { nextDv.show(); }); 
```

有没有办法在某处插入 .fadein(400) 以便在显示 nextDV 时它会淡入？

任何建议表示赞赏。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T16:31:15.993

只需替换`.show()`为`.fadeIn(400)`.

# android - Android 全局/常用函数

> ID：14734039
> 
> 赞同：2
> 
> 时间：2013-02-06T16:30:42.913
> 
> 标签：android, class, function, inheritance, global

今天刚开始学习 Android 开发，但我找不到任何关于如何定义`Helper`类或将全局加载的函数集合的信息，我将能够在我创建的任何 Activity 中使用它们。

我的计划是创建（至少现在）2 个几乎将在每个活动中使用的函数，并且必须在每个活动中定义相同的函数将是一团糟。

哪种方法是处理上述问题的正确方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:32:51.150

这将是 Java 中的静态方法。

[Java 静态方法](http://www.leepoint.net/notes-java/flow/methods/50static-methods.html)

在班级助手中，

```
public static void DoSomething(){
} 
```

可以从任何班级访问。

例子：

```
Helper.MyFunction(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T16:40:59.617

我想快速说明一下，您不应该为此目的将函数放在全局应用程序类中。通常发生的情况是，如果您有共享功能，则将其抽象并将代码放入：

*   静态方法
*   另一个包裹
*   实现您链接应用程序的功能的库
*   内容提供者

*您不*应该在类中明确实现此功能`Application`。扩展应用程序有*一些*用途，但这样做会导致代码异味，并且对于初学者来说是一种常见的反模式。如果您想要在您的应用程序中共享一堆功能，那么库是完美的解决方案（即使它只是您将代码分开到另一个包中）。这鼓励重用，并允许代码更清晰地分段和测试。

在 Java 中，通常有一个类或封装形式`*.util`来实现这一点。

（我猜你来自像 Rails 世界这样的规范，因为 Ruby 比 Java 更面向元编程，你通常使用不同的技巧。）

# r - 闪亮的 reactiveUI 挂起，同时对同一条件变量进行多个 uiOutput 调用

> ID：14734041
> 
> 赞同：5
> 
> 时间：2013-02-06T16:30:49.630
> 
> 标签：r, shiny

我正在尝试使用通过闪亮的下拉菜单插入和退出的滑块制作一个反应式 UI。我有一个带有响应式 UI 滑块的服务器（server.R）：

```
library(shiny)
shinyServer(function(input, output) {
  output$slider1 <- reactiveUI(function() {
    sliderInput("s1", "slide 1", min = 1,  max = 100, value = 1)  
  })

  output$slider2 <- reactiveUI(function() {
    sliderInput("s2", "slide 2", min = 1,  max = 100, value = 1)   
  }) 
}) 
```

我可以使用以下代码（ui.R）正常运行服务器：

```
library(shiny)
shinyUI(pageWithSidebar(
  headerPanel("Hello Shiny!"),
  sidebarPanel(

    selectInput("dataset", "number of buckets:", 
                choices = c(1,2,3)),

    conditionalPanel(
      condition = "input.dataset==2",
      uiOutput("slider1"),uiOutput("slider2")),

    conditionalPanel(
      condition = "input.dataset==1",
      sliderInput("s1", "slide 1", min = 1,  max = 100, value = 1) 
      )
  ),
  mainPanel(
  )
)) 
```

但是如果我尝试让两个条件面板都调用 uiOutput，服务器会冻结：

```
library(shiny)
shinyUI(pageWithSidebar(
  headerPanel("Hello Shiny!"),
  sidebarPanel(

    selectInput("dataset", "number of buckets:", 
                choices = c(1,2,3)),

    conditionalPanel(
      condition = "input.dataset==2",
      uiOutput("slider1"),uiOutput("slider2")),

    conditionalPanel(
      condition = "input.dataset==1",
      uiOutput("slider1") 
      )
  ),
  mainPanel(
  )
)) 
```

我玩过这个，发现任何时候使用相同的条件变量和多个 uiOutput 调用都会发生这种情况。有什么建议么？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-10-06T08:47:34.547

请参阅@Joe 的评论以获取答案。

基本上，`outputID`s 和`inputIDs`必须是唯一的；同一页面上具有相同 ID 的两个 UI 元素发出并出错。这是闪亮的反应性的限制。

@Jim 的解决方法是为客户端使用的每个输出或输入创建多个元素，例如

```
 output$slider2_1 <- ...
 output$slider2_2 <- ... 
```

# java - 使用内存分析器 (MAT) 的扫描程序 OutOfMemoryError 和 Java 堆转储分析

> ID：14734051
> 
> 赞同：1
> 
> 时间：2013-02-06T16:31:17.553
> 
> 标签：java, out-of-memory, heap-memory, heap-dump

我正在尝试分析我的 Java 小程序的堆转储，即使我增加了堆大小，如本文所示。[小程序：Java 堆空间](https://stackoverflow.com/questions/5026376/applet-java-heap-space)

现在我今天早上做了一些堆转储（是的..它可以进行数字转储），我试图用 MAT 和 Visual VM 1.3.5 分析它们。运行泄漏测试后，主要嫌疑人是 org.eclipse.jdt.internal.core.JavaModelManager 和 org.eclipse.jst.jee.archive.internal.ArchiveImpl .. 我在我的代码中没有使用这些。

Visual Vm 显示最高空间被 Byte[]、Int[]、Char[]、java.lang.string 和 short[] 类占用。我没有在我的程序中使用太多这些。我应该如何理解这个转储以及我的下一步应该是什么？如果需要，我可以发布转储的副本。

更新：在我的情况下，MAT 比视觉 VM 更好。从早上开始，我一直在进行转储（再次......数字转储）并使用这两种工具分析它们。虽然 VVM 在其泄漏嫌疑报告中显示 org.eclipse.jdt.internal.core.JavaModelManager 和 org.eclipse.jst.jee.archive.internal.ArchiveImpl 作为嫌疑人，但 Eclipse 内存分析器 (MAT) 显示我的摇摆应用程序正在文件夹中图像的缩略图（每个图像大约 100kb）并将它们显示为 JToggleButton。但是一旦添加了缩略图，JtoggleButton 的大小为 6MB。因此，如果文件夹中有 100 张图像，则图像的缩略图至少为 600MB。除此之外，我还需要用这个程序做其他事情。在这种情况下，MAT 有助于识别占用最多堆空间的确切对象。

谢谢DJ。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:22:28.573

1）我在运行程序的不同点使用 Jconsole 创建了堆转储，2）将它们导入内存分析器 3）运行泄漏可疑报告 4）观察最大实例的大小和它们的数量。这向我展示了问题，我试图解决它，但我不知道如何...... 至少很高兴我发现了 MAT，在我的情况下，它肯定比 Visual VM 更有帮助。希望它可以帮助别人。下面是我下一个问题的链接。

[摆动小程序.. jtogglebutton 大小为 6mb。我怎样才能减小尺寸](https://stackoverflow.com/questions/14737972/swing-applet-jtogglebutton-size-is-6mb-how-can-i-reduce-the-size)

# php - 显示列表中的前 5 个项目，隐藏/切换其他项目的显示 (PHP)

> ID：14734058
> 
> 赞同：0
> 
> 时间：2013-02-06T16:31:52.240
> 
> 标签：php, codeigniter

我想在列表中显示前 5 个名称，并将任何其他名称的显示切换为单个块。

我目前将名称列表作为数组对象，但如果解决方案更简单，我很乐意将其更改为数组。

这是我目前所拥有的 * *in* *complete 因为我不知道如何创建名称的隐藏 div：

PHP

```
 $names_count=0;
  echo '<div id='nameList' class='toggler'>';
  foreach($names as $name){
     echo '<a id='name'.$name->acct_id.'>'.$name->full_name.'</a>';
     if($names_count<=4){
       echo '</div><!--toggler div-->';
     } 
     else
        <div class='namesList' style='display:none'>
         //put additional names in hidden div?
        </div>          
     }
     $names_count++;
  } //endforeach 
```

JS: **更新**很抱歉造成混乱。这不是一个真正的 javascript 问题，所以我删除了该标签，但我包含以下 jQuery 代码片段以确保 PHP 的完整性

```
$('.toggler').click(function(){
   var id=this.id;
   $('#'+id).toggle();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:46:01.663

PHP

```
$names_count = 0;
echo '<div id="nameList" class="toggler">';
foreach($names as $name) {
    echo '<a id="name' . $name->acct_id . '">' . $name->full_name . '</a>';
    if ($names_count == 4) {
        echo '</div><div class="hidden">';
    }
    $names_count++;
} 
echo '</div>'; 
```

JS

```
$('.toggler').click(function(){
   $(this).next().toggle();
}); 
```

CSS

```
.hidden {
    display: none;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:25:40.353

这是一个带有两个`while`循环的示例。

```
$names = array('Bob', 'Andy', 'Tim', 'Max', 'Roger', 'John', 'Test');
$nameCount = count($names);
$nameIndex = 0;

echo '<div id="nameList" class="toggler">'; 

// Show the first 5 names.
while ($nameIndex < min(5, $nameCount)) {
    $name = $names[$nameIndex++];
    echo '<a id="name' . $name . '">' . $name . '</a>';
}

// Show the remaining names in a hidden div.
if ($nameIndex < $nameCount)
{       
    echo '<div class="hiddenNames" style="display:none">';
    while ($nameIndex < $nameCount) {
        $name = $names[$nameIndex++];
        echo '<a id="name' . $name . '">' . $name . '</a>';
    }
    echo '</div>';     
}

echo "</div>"; 
```

该代码产生以下输出。

```
<div id="nameList" class="toggler">
    <a id="nameBob">Bob</a>
    <a id="nameAndy">Andy</a>
    <a id="nameTim">Tim</a>
    <a id="nameMax">Max</a>
    <a id="nameRoger">Roger</a>
    <div class="hiddenNames" style="display:none">
        <a id="nameJohn">John</a>
        <a id="nameTest">Test</a>
    </div>
</div> 
```

如果您的名字少于 5 个，它也是安全的；该脚本将产生：

```
<div id="nameList" class="toggler">
    <a id="nameBob">Bob</a>
    <a id="nameAndy">Andy</a>
    <a id="nameTim">Tim</a>
</div> 
```

对于 JS，我可能会做一些类似的事情：

```
$('.toggler').click(function(){
   $('.hiddenNames').toggle();
}); 
```

即使代码更大，我发现从长远来看更容易遵循并且可能更容易维护。（观点）

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:40:11.813

要`<div>`隐藏：

`<div style="display: hidden"></div>`

然后 jQuery 应该使用 .toggle() 命令使其可见。

# c# - How could I find an element with similar ID in JS?

> ID：14734060
> 
> 赞同：0
> 
> 时间：2013-02-06T16:32:02.583
> 
> 标签：c#, javascript, asp.net

In my page I have labels that look like this:

```
ContentPlaceHolder1_gvGroups_lblName_0 
```

with corrosponding:

```
ContentPlaceHolder1_gvGroups_lblHidden_0 
```

I can assert that any *lblName has a corrosponding *lblHidden.

Now, I have some js:

```
//use to make any label with 'edit' class editable
function makeLabelsEditable() {

    $(".edit").focusout(function () {
        setLabel(this);
    });

    $(".edit").click(function () {
        editLabel(this);
    });
}

//used to edit labels
function editLabel(source) {
    source.innerHTML = '<input type="text" maxlength="40" value="' + source.innerHTML + '"/>';
    $(source).unbind('click');
    source.children[0].focus()
}

//used to edit labels
function setLabel(source) {

    if (source.children[0].value != '') {
        $(source).click(function () {
            editLabel(this);
        });
        source.innerHTML = source.children[0].value;
    }

} 
```

I can assert that anything marked with class edit will be valid.

I need to modify this code like so: //used to edit labels

```
function setLabel(source) {

    if (source.children[0].value != '') {
        $(source).click(function () {
            editLabel(this);
        });
        source.innerHTML = source.children[0].value;
        var hidden = someHowGetHiddenFromSource(source);
        hidden.innerHTML = source.children[0].value;
    }

} 
```

I'm sure this is possible, I just do not know how.

Essentially, it would be something like:

```
getElementByID(replace(source.id,'lblName','lblHidden')); 
```

I just do not know what JS / JQ functions can do that.

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:36:25.830

> 本质上，它会是这样的： `getElementByID(replace(source.id,'lblName','lblHidden'));`

几乎就是这样。它的：

```
var hidden = document.getElementById(source.id.replace('lblName', 'lblHidden')); 
```

`hidden`将是 DOM 元素。

或者使用 jQuery：

```
var hidden = $("#" + source.id.replace('lblName', 'lblHidden')); 
```

`hidden`将是一个包装元素的 jQuery 实例。

DOM 元素的`id`属性是一个字符串。JavaScript 字符串有一个`replace`函数，它在简单的情况下接受要替换的字符串和替换字符串。（除此之外还有更多内容，但这就是您在这种情况下所需要的。）

# java - Difference between Flash Scope and Request Scope

> ID：14734063
> 
> 赞同：0
> 
> 时间：2013-02-06T16:32:12.173
> 
> 标签：java, playframework, playframework-1.x

What is the difference between Flash Scope and View Scope?

Can someone please explain it with an example?

Regards,

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:37:31.370

[**来自 DOC 的 Flash 范围**](http://www.playframework.com/documentation/2.0/JavaSessionFlash)：

> Flash 作用域的工作方式与 Session 完全相同，但有两个不同之处：数据仅保留一个请求 Flash cookie 未签名，使用户可以对其进行修改。

例子：

```
public static Result index() {
  String message = flash("success");
  if(message == null) {
    message = "Welcome!";
  }
  return ok(message);
}

public static Result save() {
  flash("success", "The item has been created");
  return redirect("/home");
} 
```

**请求范围**是直截了当的，它仅针对特定请求存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-16T07:50:50.967

Flash 范围旨在解决当我们将 JSF 页面重定向到另一个页面时发生的数据交换问题。

在重定向 JSF 页面期间生成了两个请求。第一个请求是对源 JSF 页面的回发。第二个请求是对目标 JSF 页面的初始请求。第一个范围内的请求范围内的对象在第二个请求中被清除。

要克服这个问题，请在重定向到另一个 JSF 页面时使用 Flash 范围交换数据。

看更多：

*   [https://docs.oracle.com/javaee/6/api/javax/faces/context/Flash.html](https://docs.oracle.com/javaee/6/api/javax/faces/context/Flash.html)，或
*   [http://planet.jboss.org/post/learning_jsf2_using_flash_scope](http://planet.jboss.org/post/learning_jsf2_using_flash_scope)

# javascript - jQuery .change() not happening when dynamically adding content to a form field

> ID：14734064
> 
> 赞同：0
> 
> 时间：2013-02-06T16:32:23.063
> 
> 标签：javascript, jquery, html, onchange

This code populates a form from an API.

```
$('#shipper_search').click(function(){

    var searchBy = $('#shipper_search_by').val();
    var searchFor = $('#shipper_search_for').val();
    var warehouse = $('#warehouse').val();

    $.get('index.php?p=api&r=json&c=location&m=find&d=' + searchBy + '/' + searchFor + '/shipper/' + warehouse  , function(data, status){

        data = $.parseJSON(data);

        $('#shipper_name').val(data['body'][0]['location_name']);
        $('#shipper_address1').val(data['body'][0]['address1']);
        $('#shipper_address2').val(data['body'][0]['address2']);
        $('#shipper_city').val(data['body'][0]['city']);
        $('#shipper_state').val(data['body'][0]['state']);
        $('#shipper_zip').val(data['body'][0]['zip']);
        $('#shipper_country').val(data['body'][0]['country']);

        $('#shipper_contact_name').val(data['body'][0]['contact_name']);
        $('#shipper_contact_phone').val(data['body'][0]['phone']);
        $('#shipper_contact_fax').val(data['body'][0]['fax']);
        $('#shipper_contact_email').val(data['body'][0]['email']);

    });

}); 
```

Each time a field changes in that section the following code is supposed to run:

```
$('#shipperinfo').find('input:text').change(function(){

    var valid = 0;

    if($('#shipper_name').val().length > 0){
        valid++;
    }

    if($('#shipper_address1').val().length > 0){
        valid++;
    }

    if($('#shipper_city').val().length > 0){
        valid++;
    }

    if($('#shipper_state').val().length > 0){
        valid++;
    }

    if($('#shipper_zip').val().length > 0){
        valid++;
    }

    if($('#shipper_country').val().length > 0){
        valid++;
    }

    if(valid == 6) {

        $('#shipper_ok').removeClass('hide');

    } else {

        $('#shipper_ok').addClass('hide');

    }

}); 
```

When a user manually types the information into the field, the second function works perfectly. When, however, they use the search feature to populate the form the .change() doesn't seem to happen.

I've been searching for an age as to why, and I'm relatively new (~4 days) to jQuery/JS so I'm not sure how to begin to resolve this. Any suggestions or ideas are appreciated.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T16:35:46.750

当 JavaScript 更新字段时不会触发 change()。

最简单的解决方案是让元素之一触发更改方法

```
$('#shipper_contact_email').val(data['body'][0]['email']).trigger("change"); 
```

或者

```
$('#shipper_contact_email').val(data['body'][0]['email']).change(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:43:29.267

change does not work if you change its value dynamically, you have to do it manually.

i would do it like this.

```
$('#shipper_search').click(function(){

var searchBy = $('#shipper_search_by').val();
var searchFor = $('#shipper_search_for').val();
var warehouse = $('#warehouse').val();

$.get('index.php?p=api&r=json&c=location&m=find&d=' + searchBy + '/' + searchFor + '/shipper/' + warehouse  , function(data, status){

    data = $.parseJSON(data);

    $('#shipper_name').val(data['body'][0]['location_name']);
    $('#shipper_address1').val(data['body'][0]['address1']);
    $('#shipper_address2').val(data['body'][0]['address2']);
    $('#shipper_city').val(data['body'][0]['city']);
    $('#shipper_state').val(data['body'][0]['state']);
    $('#shipper_zip').val(data['body'][0]['zip']);
    $('#shipper_country').val(data['body'][0]['country']);

    $('#shipper_contact_name').val(data['body'][0]['contact_name']);
    $('#shipper_contact_phone').val(data['body'][0]['phone']);
    $('#shipper_contact_fax').val(data['body'][0]['fax']);
    $('#shipper_contact_email').val(data['body'][0]['email']);

    //here what i call it manually
    $('#shipperinfo').find('input:text').change();

});

}); 
```

and bind that function to that event.

```
function change_callback()
 {
    var valid = 0;

    if($('#shipper_name').val().length > 0){
        valid++;
    }

    if($('#shipper_address1').val().length > 0){
        valid++;
    }

    if($('#shipper_city').val().length > 0){
        valid++;
    }

    if($('#shipper_state').val().length > 0){
        valid++;
    }

    if($('#shipper_zip').val().length > 0){
        valid++;
    }

    if($('#shipper_country').val().length > 0){
        valid++;
    }

    if(valid == 6) {

        $('#shipper_ok').removeClass('hide');

    } else {

        $('#shipper_ok').addClass('hide');

    }

}

$('#shipperinfo').find('input:text').on('change', change_callback); 
```

try it and let me know if this work for you.

# google-app-engine - Do redundant ndb.Model.put_async() calls end up being sent only once to the datastore?

> ID：14734065
> 
> 赞同：3
> 
> 时间：2013-02-06T16:32:25.690
> 
> 标签：google-app-engine, app-engine-ndb

I have a NDB model that exposes a few instance methods to manipulate its state. In some request handlers, I need to call a few of these instance methods. In order to prevent calling `put()` more than once on the same entity, the pattern I've used so far is similar to this:

```
class Foo(ndb.Model):
    prop_a = ndb.StringProperty()
    prop_b = ndb.StringProperty()
    prop_c = ndb.StringProperty()

    def some_method_1(self):
        self.prop_a = "The result of some computation"
        return True

    def some_method_2(self):
        if some_condition:
            self.prop_b = "Some new value"
            return True
        return False

    def some_method_3(self):
        if some_condition:
            self.prop_b = "Some new value"
            return True
        if some_other_condition:
            self.prop_b = "Some new value"
            self.prop_c = "Some new value"
            return True
        return False

def manipulate_foo(f):
    updated = False
    updated = f.some_method_1() or updated
    updated = f.some_method_2() or updated
    updated = f.some_method_3() or updated
    if updated:
        f.put() 
```

Basically, each method that can potentially update the entity returns a bool to indicate if the entity has been updated and therefore needs to be saved. When calling these methods in sequence, I make sure to call `put()` if any of the methods returned `True`.

However, this pattern can be complex to implement in situations where other subroutines are involved. In that case, I need to make the *updated* boolean value returned from subroutines bubble up to the top-level methods.

I am now in the process of optimizing a lot of my request handlers, trying to limit as much as possibles the waterfalls reported by AppStat, using as much async APIs as I can and converting a lot of methods to tasklets.

This effort lead me to read the [NDB Async documentation](https://developers.google.com/appengine/docs/python/ndb/async), which mentions that NDB implements an *autobatcher* which combines multiple requests in a single RPC call to the datastore. I understand that this applies to requests involving different keys, but does it also apply to redundant calls to the same entity?

In other words, my question is: could the above code pattern be replaced by this one?

```
class FooAsync(ndb.Model):
    prop_a = ndb.StringProperty()
    prop_b = ndb.StringProperty()
    prop_c = ndb.StringProperty()

    @ndb.tasklet
    def some_method_1(self):
        self.prop_a = "The result of some computation"
        yield self.put_async()

    @ndb.tasklet
    def some_method_2(self):
        if some_condition:
            self.prop_b = "Some new value"
            yield self.put_async()

    @ndb.tasklet
    def some_method_3(self):
        if some_condition:
            self.prop_b = "Some new value"
            yield self.put_async()
        elif some_other_condition:
            self.prop_b = "Some new value"
            self.prop_c = "Some new value"
            yield self.put_async()

@ndb.tasklet
def manipulate_foo(f):
    yield f.some_method_1()
    yield f.some_method_2()
    yield f.some_method_3() 
```

Would all calls to `put_async()` be combined into a single `put` call on the entity? If yes, are there any caveats to using this approach vs sticking to manually checking for an *updated* return value and calling `put` once at the end of the call sequence?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-07T03:57:48.847

好吧，我咬紧牙关，在启用 AppStat 的测试 GAE 应用程序中测试了这 3 个场景，以查看正在进行的 RPC 调用：

```
class Foo(ndb.Model):
    prop_a = ndb.DateTimeProperty()
    prop_b = ndb.StringProperty()
    prop_c = ndb.IntegerProperty()

class ThreePutsHandler(webapp2.RequestHandler):
    def post(self):
        foo = Foo.get_or_insert('singleton')
        foo.prop_a = datetime.utcnow()
        foo.put()
        foo.prop_b = str(foo.prop_a)
        foo.put()
        foo.prop_c = foo.prop_a.microsecond
        foo.put()

class ThreePutsAsyncHandler(webapp2.RequestHandler):
    @ndb.toplevel
    def post(self):
        foo = Foo.get_or_insert('singleton')
        foo.prop_a = datetime.utcnow()
        foo.put_async()
        foo.prop_b = str(foo.prop_a)
        foo.put_async()
        foo.prop_c = foo.prop_a.microsecond
        foo.put_async()

class ThreePutsTaskletHandler(webapp2.RequestHandler):
    @ndb.tasklet
    def update_a(self, foo):
        foo.prop_a = datetime.utcnow()
        yield foo.put_async()

    @ndb.tasklet
    def update_b(self, foo):
        foo.prop_b = str(foo.prop_a)
        yield foo.put_async()

    @ndb.tasklet
    def update_c(self, foo):
        foo.prop_c = foo.prop_a.microsecond
        yield foo.put_async()

    @ndb.toplevel
    def post(self):
        foo = Foo.get_or_insert('singleton')
        self.update_a(foo)
        self.update_b(foo)
        self.update_c(foo)

app = webapp2.WSGIApplication([
    ('/ndb-batching/3-puts', ThreePutsHandler),
    ('/ndb-batching/3-puts-async', ThreePutsAsyncHandler),
    ('/ndb-batching/3-puts-tasklet', ThreePutsTaskletHandler),
], debug=True) 
```

第一个，`ThreePutsHandler`，显然最终调用了`Put`3 次。

![ThreePutsHandler AppStat 跟踪](../Images/9169a50e1eda275c6bee4965844f66d5.png)

但是，调用的其他 2 个测试`put_async()`以一次调用结束`Put`：

![ThreePutsAsyncHandler AppStat 跟踪](../Images/3b2bbb04d3842bb7e342ef72b2983239.png) ![ThreePutsTaskletHandler AppStat 跟踪](../Images/285221585acffce2c5bbac39304b43de.png)

*所以我的问题的答案是：是的，冗余的ndb.Model.put_async* () 调用正在由 NDB 的自动批处理功能进行批处理，并最终作为单个`datastore_v3.Put`调用。这些`put_async()`调用是否在 tasklet 中进行并不重要。

关于测试结果中观察到的数据存储写入操作数量的注释：正如 Shay 在评论中指出的那样，每个修改的索引属性值有 4 次写入加上实体的 1 次写入。所以在第一个测试（3 个顺序`put`）中，我们观察到 (4+1) * 3 = 15 个写操作。在其他 2 个测试（异步）中，我们观察到 (4*3) + 1 = 13 个写操作。

因此，底线是 NDB`put_async`对同一个实体进行批量多次调用，通过对数据存储的一次调用为我们节省了很多延迟，并且通过只写入一次实体为我们节省了一些写入操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T21:59:24.597

尝试注释对象本身，并在返回响应之前进行检查。就像 Zope 中的 _p_changed 属性一样。另一种选择可能是在返回之前需要写入的修改对象的请求/线程本地注册表。有关 GAE 中 threadlocal 的示例，请查看 google/appengine/runtime/request_environment.py

# build - How to query a TFS build from its URI using the api?

> ID：14734066
> 
> 赞同：1
> 
> 时间：2013-02-06T16:32:27.327
> 
> 标签：build, tfs, tfs-sdk

How do I get the IBuildDetail object from TFS using the the builds URI?

e.g. the URI is vstfs:///Build/Build/1546

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:46:38.283

在构建服务器类上使用 GetBuild() 方法。它需要一个 Uri 作为参数。

```
var buildDetail= buildServer.GetBuild(new Uri(builduri)); 
```

# ios - Pdf inside UIWebView with links to return to its first page

> ID：14734067
> 
> 赞同：1
> 
> 时间：2013-02-06T16:32:31.267
> 
> 标签：ios, objective-c, xcode, pdf, uiwebview

I'm currently working on an app, that displays one pdf inside of a UIWebView. That's working fine. The pdf gets loaded like this:

```
NSString *path = [[NSBundle mainBundle] pathForResource:@"file_name" ofType:@"pdf"];
NSURL *url= [NSURL fileURLWithPath:path];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
[webview loadRequest:request]; 
```

But the pdf also contains a link on each page to return to its first page (the table of contents). I have enabled user interaction and link detection inside the .xib file. When i tested it with the simulator or on device, it worked in some cases, depending on the iOS Version.

With iOS 4.3 (only simulator): Doesn't work. Links aren't recognized and are treated like normal text. (so i guess i won't support < iOS 5)

iOS 5.1 (Simulator and Device): Works fine. Each link returns me to the first page of the pdf. No problems so far.

iOS 6.0 (Simulator and Device): The first link i use works exactly once. When i try it again, nothing happens, no matter which link i use. After a completly restart of the app, it works again, but only once.

So, does somebody know a way to get it working with iOS 6 the same way as with iOS 5.1? I have read about a few similar problems where the solutions seems to be to draw the pdf per CGDPF* api and scan the pdf for links. (something like what is collected here: [Fast and Lean PDF Viewer for iPhone / iPad / iOs - tips and hints?](https://stackoverflow.com/questions/3889634/fast-and-lean-pdf-viewer-for-iphone-ipad-ios-tips-and-hints) ) But i would like to avoid that, if possible, because i don't need all the functions a pdf viewer could provide.

Hope there is another way and thanks for reading :)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-24T07:15:12.407

我最近遇到了这个问题。原因在于 iOS 6.1+，一旦您单击其中一个链接，您就会导航到不同的页面（第一页），并且您需要“返回”才能再次导航到文档中的任何页面。由于您正在显示与应用程序捆绑在一起的静态文档，您可能希望将这些页面链接替换为自定义链接并实现分页机制以跳转到所需的页面，例如：pdf://Page_1。如果您需要实现的只是转到第一页，那么您的分页机制可能就像将 Web 视图的滚动视图的内容偏移设置为 0 一样简单。

# c++ - MinGW 4.7.2 vs. Visual C++ 11.0 (2012) Benchmark

> ID：14734068
> 
> 赞同：12
> 
> 时间：2013-02-06T16:32:32.683
> 
> 标签：c++, visual-c++, mingw

I have been doing an experiment to choose between MinGW and MSVC. I decided to use [Adobe C++ Performance Benchmark](http://stlab.adobe.com/performance/) to do it. While MSVC's output was exceptionally faster on some operations, it was as slow on some other operations. I will add other parts of the benchmark suite when I have time to do them.

I have removed some of the benchmarks that has same results due to character limit, you can interpret them by the pattern I assume.

**System Information**

*   AMD Athlon(tm) 64 X2 Dual Core Processor 5200+ 2.70GHz
*   6GB DDR2 800MHz RAM
*   Windows 8

Any idea why the result is slow? Also, can this test's result to interpret a computer game performance (CPU physics engine maybe) because especially floating point benchmarks are slower?

-

**MinGW**

```
g++ -march=native -O3 -ffast-math -fomit-frame-pointer -momit-leaf-frame-pointer -flto -fwhole-program -ftree-loop-distribution

simple_types_loop_invariant.exe 

test                           description   absolute   operations   ratio with
number                                       time       per second   test0

 0                  "uint8_t variable add"   1.91 sec   836.38 M     1.00
 1          "uint8_t variable add hoisted"   0.08 sec   19277.11 M     0.04
 2        "uint8_t multiple variable adds"   1.93 sec   829.45 M     1.01
 3             "uint8_t variable subtract"   1.92 sec   832.47 M     1.00
 4   "uint8_t multiple variable subtracts"   2.57 sec   623.30 M     1.34
 5             "uint8_t variable multiply"   1.93 sec   831.17 M     1.01
 6  "uint8_t multiple variable multiplies"   2.56 sec   625.00 M     1.34
 7 "uint8_t multiple variable multiplies2"   1.92 sec   834.64 M     1.00
 8               "uint8_t variable divide"  10.83 sec   147.70 M     5.66
 9     "uint8_t multiple variable divides"  42.14 sec   37.97 M     22.03
10    "uint8_t multiple variable divides2"   1.93 sec   829.45 M     1.01
11       "uint8_t multiple variable mixed"   1.93 sec   828.16 M     1.01
12                  "uint8_t variable and"   1.92 sec   834.20 M     1.00
13         "uint8_t multiple variable and"   1.93 sec   828.59 M     1.01
14                   "uint8_t variable or"   1.93 sec   830.31 M     1.01
15          "uint8_t multiple variable or"   1.91 sec   836.38 M     1.00
16                  "uint8_t variable xor"   1.90 sec   840.78 M     0.99
17         "uint8_t multiple variable xor"   1.92 sec   832.47 M     1.00

Total absolute time for uint8_t loop invariant: 83.17 sec

test                           description   absolute   operations   ratio with
number                                       time       per second   test0

 0                  "int16_t variable add"   1.92 sec   835.51 M     1.00
 1          "int16_t variable add hoisted"   1.91 sec   835.95 M     1.00
 2        "int16_t multiple variable adds"   1.92 sec   833.33 M     1.00
 3             "int16_t variable subtract"   1.99 sec   804.83 M     1.04
 4   "int16_t multiple variable subtracts"   2.57 sec   622.81 M     1.34
 5             "int16_t variable multiply"   1.92 sec   832.47 M     1.00
 6  "int16_t multiple variable multiplies"   1.91 sec   838.57 M     1.00
 7 "int16_t multiple variable multiplies2"   1.92 sec   831.60 M     1.00
 8               "int16_t variable divide"  27.53 sec   58.11 M     14.38
 9     "int16_t multiple variable divides"  107.65 sec   14.86 M     56.21
10    "int16_t multiple variable divides2"   1.95 sec   819.67 M     1.02
11       "int16_t multiple variable mixed"   1.93 sec   828.16 M     1.01
12                  "int16_t variable and"   1.93 sec   828.16 M     1.01
13         "int16_t multiple variable and"   1.92 sec   831.60 M     1.00
14                   "int16_t variable or"   1.93 sec   829.88 M     1.01
15          "int16_t multiple variable or"   1.92 sec   832.90 M     1.00
16                  "int16_t variable xor"   1.93 sec   830.74 M     1.01
17         "int16_t multiple variable xor"   2.41 sec   665.00 M     1.26

Total absolute time for int16_t loop invariant: 167.16 sec

test                            description   absolute   operations   ratio with
number                                        time       per second   test0

 0                  "uint16_t variable add"   1.93 sec   830.74 M     1.00
 1          "uint16_t variable add hoisted"   0.16 sec   9937.89 M     0.08
 2        "uint16_t multiple variable adds"   1.93 sec   828.59 M     1.00
 3             "uint16_t variable subtract"   1.92 sec   835.07 M     0.99
 4   "uint16_t multiple variable subtracts"   2.56 sec   625.73 M     1.33
 5             "uint16_t variable multiply"   1.92 sec   835.07 M     0.99
 6  "uint16_t multiple variable multiplies"   2.55 sec   627.94 M     1.32
 7 "uint16_t multiple variable multiplies2"   1.92 sec   832.47 M     1.00
 8               "uint16_t variable divide"  16.08 sec   99.49 M     8.35
 9     "uint16_t multiple variable divides"  64.86 sec   24.67 M     33.68
10    "uint16_t multiple variable divides2"   1.92 sec   833.77 M     1.00
11       "uint16_t multiple variable mixed"   1.92 sec   832.03 M     1.00
12                  "uint16_t variable and"   1.92 sec   832.03 M     1.00
13         "uint16_t multiple variable and"   1.92 sec   832.03 M     1.00
14                   "uint16_t variable or"   1.93 sec   829.02 M     1.00
15          "uint16_t multiple variable or"   1.92 sec   834.20 M     1.00
16                  "uint16_t variable xor"   1.92 sec   835.07 M     0.99
17         "uint16_t multiple variable xor"   1.92 sec   834.20 M     1.00

Total absolute time for uint16_t loop invariant: 111.19 sec

test                           description   absolute   operations   ratio with
number                                       time       per second   test0

 0                  "int32_t variable add"   0.38 sec   4232.80 M     1.00
 1          "int32_t variable add hoisted"   0.33 sec   4878.05 M     0.87
 2        "int32_t multiple variable adds"   0.82 sec   1963.19 M     2.16
 3             "int32_t variable subtract"   0.64 sec   2500.00 M     1.69
 4   "int32_t multiple variable subtracts"   0.80 sec   2005.01 M     2.11
 5             "int32_t variable multiply"   2.10 sec   762.27 M     5.55
 6  "int32_t multiple variable multiplies"   8.33 sec   192.01 M     22.04
 7 "int32_t multiple variable multiplies2"   0.39 sec   4092.07 M     1.03
 8               "int32_t variable divide"  26.94 sec   59.39 M     71.27
 9     "int32_t multiple variable divides"  106.48 sec   15.03 M     281.68
10    "int32_t multiple variable divides2"   0.39 sec   4060.91 M     1.04
11       "int32_t multiple variable mixed"   0.50 sec   3187.25 M     1.33
12                  "int32_t variable and"   0.38 sec   4232.80 M     1.00
13         "int32_t multiple variable and"   0.40 sec   4030.23 M     1.05
14                   "int32_t variable or"   0.42 sec   3764.71 M     1.12
15          "int32_t multiple variable or"   0.42 sec   3855.42 M     1.10
16                  "int32_t variable xor"   0.41 sec   3950.62 M     1.07
17         "int32_t multiple variable xor"   0.38 sec   4244.03 M     1.00

Total absolute time for int32_t loop invariant: 150.49 sec

test                            description   absolute   operations   ratio with
number                                        time       per second   test0

 0                  "uint32_t variable add"   0.39 sec   4081.63 M     1.00
 1          "uint32_t variable add hoisted"   0.32 sec   4938.27 M     0.83
 2        "uint32_t multiple variable adds"   0.39 sec   4081.63 M     1.00
 3             "uint32_t variable subtract"   0.64 sec   2503.91 M     1.63
 4   "uint32_t multiple variable subtracts"   0.80 sec   2000.00 M     2.04
 5             "uint32_t variable multiply"   2.10 sec   761.54 M     5.36
 6  "uint32_t multiple variable multiplies"   2.11 sec   759.37 M     5.38
 7 "uint32_t multiple variable multiplies2"   0.39 sec   4092.07 M     1.00
 8               "uint32_t variable divide"  25.77 sec   62.08 M     65.75
 9     "uint32_t multiple variable divides"  105.98 sec   15.10 M     270.36
10    "uint32_t multiple variable divides2"   0.39 sec   4081.63 M     1.00
11       "uint32_t multiple variable mixed"   0.39 sec   4102.56 M     0.99
12                  "uint32_t variable and"   0.38 sec   4177.55 M     0.98
13         "uint32_t multiple variable and"   0.39 sec   4092.07 M     1.00
14                   "uint32_t variable or"   0.40 sec   4020.10 M     1.02
15          "uint32_t multiple variable or"   0.40 sec   4010.03 M     1.02
16                  "uint32_t variable xor"   0.39 sec   4071.25 M     1.00
17         "uint32_t multiple variable xor"   0.38 sec   4188.48 M     0.97

Total absolute time for uint32_t loop invariant: 142.03 sec

test                           description   absolute   operations   ratio with
number                                       time       per second   test0

 0                  "int64_t variable add"   0.80 sec   1997.50 M     1.00
 1          "int64_t variable add hoisted"   0.66 sec   2442.75 M     0.82
 2        "int64_t multiple variable adds"   1.66 sec   962.70 M     2.07
 3             "int64_t variable subtract"   1.30 sec   1233.62 M     1.62
 4   "int64_t multiple variable subtracts"   1.61 sec   991.33 M     2.01
 5             "int64_t variable multiply"   5.83 sec   274.40 M     7.28
 6  "int64_t multiple variable multiplies"  24.06 sec   66.50 M     30.04
 7 "int64_t multiple variable multiplies2"   0.85 sec   1880.14 M     1.06
 8               "int64_t variable divide"  43.13 sec   37.10 M     53.84
 9     "int64_t multiple variable divides"  166.87 sec    9.59 M     208.32
10    "int64_t multiple variable divides2"   0.79 sec   2025.32 M     0.99
11       "int64_t multiple variable mixed"   0.99 sec   1617.80 M     1.23
12                  "int64_t variable and"   0.79 sec   2033.04 M     0.98
13         "int64_t multiple variable and"   0.77 sec   2075.23 M     0.96
14                   "int64_t variable or"   0.79 sec   2030.46 M     0.98
15          "int64_t multiple variable or"   0.78 sec   2059.20 M     0.97
16                  "int64_t variable xor"   0.78 sec   2051.28 M     0.97
17         "int64_t multiple variable xor"   0.79 sec   2035.62 M     0.98

Total absolute time for int64_t loop invariant: 253.23 sec

test                            description   absolute   operations   ratio with
number                                        time       per second   test0

 0                  "uint64_t variable add"   0.78 sec   2064.52 M     1.00
 1          "uint64_t variable add hoisted"   0.66 sec   2435.31 M     0.85
 2        "uint64_t multiple variable adds"   0.79 sec   2025.32 M     1.02
 3             "uint64_t variable subtract"   1.29 sec   1241.27 M     1.66
 4   "uint64_t multiple variable subtracts"   1.60 sec   1001.88 M     2.06
 5             "uint64_t variable multiply"   5.98 sec   267.56 M     7.72
 6  "uint64_t multiple variable multiplies"   5.81 sec   275.48 M     7.49
 7 "uint64_t multiple variable multiplies2"   0.79 sec   2027.88 M     1.02
 8               "uint64_t variable divide"  38.20 sec   41.89 M     49.28
 9     "uint64_t multiple variable divides"  151.00 sec   10.60 M     194.83
10    "uint64_t multiple variable divides2"   0.79 sec   2020.20 M     1.02
11       "uint64_t multiple variable mixed"   0.78 sec   2064.52 M     1.00
12                  "uint64_t variable and"   0.78 sec   2056.56 M     1.00
13         "uint64_t multiple variable and"   0.79 sec   2030.46 M     1.02
14                   "uint64_t variable or"   0.77 sec   2080.62 M     0.99
15          "uint64_t multiple variable or"   0.79 sec   2020.20 M     1.02
16                  "uint64_t variable xor"   0.78 sec   2040.82 M     1.01
17         "uint64_t multiple variable xor"   0.77 sec   2069.86 M     1.00

Total absolute time for uint64_t loop invariant: 213.13 sec

test                         description   absolute   operations   ratio with
number                                     time       per second   test0

 0                  "float variable add"   0.41 sec   3874.09 M     1.00
 1          "float variable add hoisted"   0.33 sec   4923.08 M     0.79
 2        "float multiple variable adds"   0.41 sec   3892.94 M     1.00
 3             "float variable subtract"   0.39 sec   4081.63 M     0.95
 4   "float multiple variable subtracts"   1.37 sec   1170.45 M     3.31
 5             "float variable multiply"   0.33 sec   4892.97 M     0.79
 6  "float multiple variable multiplies"   0.32 sec   5079.37 M     0.76
 7 "float multiple variable multiplies2"   0.41 sec   3940.89 M     0.98
 8               "float variable divide"   0.33 sec   4907.98 M     0.79
 9     "float multiple variable divides"   0.33 sec   4833.84 M     0.80
10    "float multiple variable divides2"   0.40 sec   3970.22 M     0.98
11       "float multiple variable mixed"   0.40 sec   4050.63 M     0.96

Total absolute time for float loop invariant: 5.41 sec

test                          description   absolute   operations   ratio with
number                                      time       per second   test0

 0                  "double variable add"   0.80 sec   1990.05 M     1.00
 1          "double variable add hoisted"   0.65 sec   2457.76 M     0.81
 2        "double multiple variable adds"   0.79 sec   2017.65 M     0.99
 3             "double variable subtract"   0.82 sec   1960.78 M     1.01
 4   "double multiple variable subtracts"   2.72 sec   587.37 M     3.39
 5             "double variable multiply"   0.76 sec   2110.82 M     0.94
 6  "double multiple variable multiplies"   0.78 sec   2048.66 M     0.97
 7 "double multiple variable multiplies2"   0.80 sec   1995.01 M     1.00
 8               "double variable divide"   0.67 sec   2388.06 M     0.83
 9     "double multiple variable divides"   0.66 sec   2420.57 M     0.82
10    "double multiple variable divides2"   0.80 sec   2007.53 M     0.99
11       "double multiple variable mixed"   0.81 sec   1968.02 M     1.01

Total absolute time for double loop invariant: 11.07 sec
```

-

**Visual C++ 11.0**

```
cl /O2 /Ob2 /Oi /Oy /GL /MD /GS- /Gy /Qpar /arch:SSE2 /fp:fast /GR- simple_types_loop_invariant.cpp

simple_types_loop_invariant.exe 

test                           description   absolute   operations   ratio with
number                                       time       per second   test0

 0                  "uint8_t variable add"   0.17 sec   9638.55 M     1.00
 1          "uint8_t variable add hoisted"   0.11 sec   15094.34 M     0.64
 2        "uint8_t multiple variable adds"   0.89 sec   1801.80 M     5.35
 3             "uint8_t variable subtract"   0.17 sec   9638.55 M     1.00
 4   "uint8_t multiple variable subtracts"   3.51 sec   456.23 M     21.13
 5             "uint8_t variable multiply"   2.23 sec   719.10 M     13.40
 6  "uint8_t multiple variable multiplies"   4.48 sec   356.98 M     27.00
 7 "uint8_t multiple variable multiplies2"   1.29 sec   1239.35 M     7.78
 8               "uint8_t variable divide"  27.23 sec   58.76 M     164.03
 9     "uint8_t multiple variable divides"  108.58 sec   14.74 M     654.11
10    "uint8_t multiple variable divides2"   1.28 sec   1252.94 M     7.69
11       "uint8_t multiple variable mixed"   1.27 sec   1264.82 M     7.62
12                  "uint8_t variable and"   1.28 sec   1247.08 M     7.73
13         "uint8_t multiple variable and"   3.52 sec   454.16 M     21.22
14                   "uint8_t variable or"   1.28 sec   1254.90 M     7.68
15          "uint8_t multiple variable or"   3.54 sec   452.36 M     21.31
16                  "uint8_t variable xor"   1.27 sec   1256.87 M     7.67
17         "uint8_t multiple variable xor"   3.49 sec   457.93 M     21.05

Total absolute time for uint8_t loop invariant: 165.57 sec

test                           description   absolute   operations   ratio with
number                                       time       per second   test0

 0                  "int16_t variable add"   0.33 sec   4923.08 M     1.00
 1          "int16_t variable add hoisted"   0.21 sec   7804.88 M     0.63
 2        "int16_t multiple variable adds"   0.76 sec   2094.24 M     2.35
 3             "int16_t variable subtract"   0.32 sec   5063.29 M     0.97
 4   "int16_t multiple variable subtracts"   2.02 sec   790.12 M     6.23
 5             "int16_t variable multiply"   1.61 sec   995.64 M     4.94
 6  "int16_t multiple variable multiplies"   4.45 sec   359.31 M     13.70
 7 "int16_t multiple variable multiplies2"   1.13 sec   1418.44 M     3.47
 8               "int16_t variable divide"  27.24 sec   58.74 M     83.81
 9     "int16_t multiple variable divides"  109.33 sec   14.64 M     336.39
10    "int16_t multiple variable divides2"   0.97 sec   1654.60 M     2.98
11       "int16_t multiple variable mixed"   0.61 sec   2631.58 M     1.87
12                  "int16_t variable and"   1.12 sec   1433.69 M     3.43
13         "int16_t multiple variable and"   1.77 sec   904.47 M     5.44
14                   "int16_t variable or"   1.20 sec   1330.01 M     3.70
15          "int16_t multiple variable or"   1.77 sec   906.00 M     5.43
16                  "int16_t variable xor"   1.12 sec   1432.41 M     3.44
17         "int16_t multiple variable xor"   1.77 sec   905.49 M     5.44

Total absolute time for int16_t loop invariant: 157.70 sec

test                            description   absolute   operations   ratio with
number                                        time       per second   test0

 0                  "uint16_t variable add"   0.33 sec   4833.84 M     1.00
 1          "uint16_t variable add hoisted"   0.21 sec   7729.47 M     0.63
 2        "uint16_t multiple variable adds"   0.78 sec   2059.20 M     2.35
 3             "uint16_t variable subtract"   0.32 sec   5031.45 M     0.96
 4   "uint16_t multiple variable subtracts"   2.03 sec   786.63 M     6.15
 5             "uint16_t variable multiply"   1.61 sec   993.79 M     4.86
 6  "uint16_t multiple variable multiplies"   4.45 sec   359.71 M     13.44
 7 "uint16_t multiple variable multiplies2"   1.12 sec   1428.57 M     3.38
 8               "uint16_t variable divide"  27.15 sec   58.94 M     82.01
 9     "uint16_t multiple variable divides"  109.41 sec   14.62 M     330.53
10    "uint16_t multiple variable divides2"   2.42 sec   661.70 M     7.31
11       "uint16_t multiple variable mixed"   2.43 sec   658.71 M     7.34
12                  "uint16_t variable and"   2.53 sec   632.91 M     7.64
13         "uint16_t multiple variable and"   3.21 sec   498.75 M     9.69
14                   "uint16_t variable or"   2.52 sec   633.91 M     7.63
15          "uint16_t multiple variable or"   3.19 sec   501.25 M     9.64
16                  "uint16_t variable xor"   2.52 sec   634.92 M     7.61
17         "uint16_t multiple variable xor"   3.21 sec   498.29 M     9.70

Total absolute time for uint16_t loop invariant: 169.43 sec

test                           description   absolute   operations   ratio with
number                                       time       per second   test0

 0                  "int32_t variable add"   0.64 sec   2519.69 M     1.00
 1          "int32_t variable add hoisted"   0.41 sec   3902.44 M     0.65
 2        "int32_t multiple variable adds"   0.97 sec   1654.60 M     1.52
 3             "int32_t variable subtract"   0.63 sec   2539.68 M     0.99
 4   "int32_t multiple variable subtracts"   0.97 sec   1651.19 M     1.53
 5             "int32_t variable multiply"   2.01 sec   797.61 M     3.16
 6  "int32_t multiple variable multiplies"   4.17 sec   383.60 M     6.57
 7 "int32_t multiple variable multiplies2"   1.27 sec   1262.83 M     2.00
 8               "int32_t variable divide"  26.87 sec   59.55 M     42.31
 9     "int32_t multiple variable divides"  108.12 sec   14.80 M     170.27
10    "int32_t multiple variable divides2"   0.96 sec   1673.64 M     1.51
11       "int32_t multiple variable mixed"   0.52 sec   3082.85 M     0.82
12                  "int32_t variable and"   0.66 sec   2431.61 M     1.04
13         "int32_t multiple variable and"   0.98 sec   1626.02 M     1.55
14                   "int32_t variable or"   0.65 sec   2472.95 M     1.02
15          "int32_t multiple variable or"   0.96 sec   1673.64 M     1.51
16                  "int32_t variable xor"   0.65 sec   2480.62 M     1.02
17         "int32_t multiple variable xor"   0.95 sec   1682.44 M     1.50

Total absolute time for int32_t loop invariant: 152.36 sec

test                            description   absolute   operations   ratio with
number                                        time       per second   test0

 0                  "uint32_t variable add"   0.65 sec   2446.48 M     1.00
 1          "uint32_t variable add hoisted"   0.41 sec   3911.98 M     0.63
 2        "uint32_t multiple variable adds"   0.96 sec   1671.89 M     1.46
 3             "uint32_t variable subtract"   0.66 sec   2435.31 M     1.00
 4   "uint32_t multiple variable subtracts"   0.97 sec   1647.79 M     1.48
 5             "uint32_t variable multiply"   1.92 sec   834.64 M     2.93
 6  "uint32_t multiple variable multiplies"   4.45 sec   359.71 M     6.80
 7 "uint32_t multiple variable multiplies2"   1.30 sec   1230.77 M     1.99
 8               "uint32_t variable divide"  26.33 sec   60.77 M     40.26
 9     "uint32_t multiple variable divides"  99.86 sec   16.02 M     152.69
10    "uint32_t multiple variable divides2"   0.95 sec   1691.33 M     1.45
11       "uint32_t multiple variable mixed"   0.54 sec   2962.96 M     0.83
12                  "uint32_t variable and"   0.65 sec   2476.78 M     0.99
13         "uint32_t multiple variable and"   0.96 sec   1661.47 M     1.47
14                   "uint32_t variable or"   0.65 sec   2469.14 M     0.99
15          "uint32_t multiple variable or"   0.95 sec   1678.91 M     1.46
16                  "uint32_t variable xor"   0.65 sec   2461.54 M     0.99
17         "uint32_t multiple variable xor"   0.97 sec   1654.60 M     1.48

Total absolute time for uint32_t loop invariant: 143.81 sec

test                           description   absolute   operations   ratio with
number                                       time       per second   test0

 0                  "int64_t variable add"   1.30 sec   1233.62 M     1.00
 1          "int64_t variable add hoisted"   0.81 sec   1987.58 M     0.62
 2        "int64_t multiple variable adds"   1.96 sec   817.58 M     1.51
 3             "int64_t variable subtract"   1.30 sec   1226.99 M     1.01
 4   "int64_t multiple variable subtracts"   1.94 sec   825.17 M     1.49
 5             "int64_t variable multiply"   7.17 sec   223.06 M     5.53
 6  "int64_t multiple variable multiplies"  24.97 sec   64.08 M     19.25
 7 "int64_t multiple variable multiplies2"   1.97 sec   810.54 M     1.52
 8               "int64_t variable divide"  62.56 sec   25.58 M     48.24
 9     "int64_t multiple variable divides"  246.80 sec    6.48 M     190.29
10    "int64_t multiple variable divides2"   1.94 sec   824.74 M     1.50
11       "int64_t multiple variable mixed"   0.80 sec   2002.50 M     0.62
12                  "int64_t variable and"   1.28 sec   1249.02 M     0.99
13         "int64_t multiple variable and"   1.94 sec   823.89 M     1.50
14                   "int64_t variable or"   1.29 sec   1236.48 M     1.00
15          "int64_t multiple variable or"   1.94 sec   826.45 M     1.49
16                  "int64_t variable xor"   1.29 sec   1237.43 M     1.00
17         "int64_t multiple variable xor"   1.95 sec   822.62 M     1.50

Total absolute time for int64_t loop invariant: 363.21 sec

test                            description   absolute   operations   ratio with
number                                        time       per second   test0

 0                  "uint64_t variable add"   1.29 sec   1237.43 M     1.00
 1          "uint64_t variable add hoisted"   0.82 sec   1941.75 M     0.64
 2        "uint64_t multiple variable adds"   1.95 sec   820.93 M     1.51
 3             "uint64_t variable subtract"   1.30 sec   1226.05 M     1.01
 4   "uint64_t multiple variable subtracts"   2.06 sec   777.45 M     1.59
 5             "uint64_t variable multiply"   7.42 sec   215.78 M     5.73
 6  "uint64_t multiple variable multiplies"  26.28 sec   60.88 M     20.33
 7 "uint64_t multiple variable multiplies2"   1.97 sec   810.54 M     1.53
 8               "uint64_t variable divide"  61.84 sec   25.87 M     47.83
 9     "uint64_t multiple variable divides"  235.73 sec    6.79 M     182.31
10    "uint64_t multiple variable divides2"   1.98 sec   806.45 M     1.53
11       "uint64_t multiple variable mixed"   1.05 sec   1519.47 M     0.81
12                  "uint64_t variable and"   1.29 sec   1244.17 M     0.99
13         "uint64_t multiple variable and"   1.95 sec   821.78 M     1.51
14                   "uint64_t variable or"   1.29 sec   1236.48 M     1.00
15          "uint64_t multiple variable or"   1.94 sec   823.05 M     1.50
16                  "uint64_t variable xor"   1.29 sec   1242.24 M     1.00
17         "uint64_t multiple variable xor"   1.95 sec   819.67 M     1.51

Total absolute time for uint64_t loop invariant: 353.42 sec

test                         description   absolute   operations   ratio with
number                                     time       per second   test0

 0                  "float variable add"   0.65 sec   2450.23 M     1.00
 1          "float variable add hoisted"   0.41 sec   3892.94 M     0.63
 2        "float multiple variable adds"   1.60 sec   998.75 M     2.45
 3             "float variable subtract"   0.65 sec   2472.95 M     0.99
 4   "float multiple variable subtracts"   1.61 sec   996.88 M     2.46
 5             "float variable multiply"   0.63 sec   2531.65 M     0.97
 6  "float multiple variable multiplies"   1.30 sec   1231.72 M     1.99
 7 "float multiple variable multiplies2"   0.64 sec   2503.91 M     0.98
 8               "float variable divide"   0.65 sec   2457.76 M     1.00
 9     "float multiple variable divides"   1.29 sec   1240.31 M     1.98
10    "float multiple variable divides2"   0.65 sec   2476.78 M     0.99
11       "float multiple variable mixed"   0.97 sec   1646.09 M     1.49

Total absolute time for float loop invariant: 11.05 sec

test                          description   absolute   operations   ratio with
number                                      time       per second   test0

 0                  "double variable add"   1.33 sec   1203.91 M     1.00
 1          "double variable add hoisted"   0.84 sec   1911.59 M     0.63
 2        "double multiple variable adds"   3.20 sec   499.69 M     2.41
 3             "double variable subtract"   1.29 sec   1238.39 M     0.97
 4   "double multiple variable subtracts"   3.24 sec   493.83 M     2.44
 5             "double variable multiply"   1.29 sec   1237.43 M     0.97
 6  "double multiple variable multiplies"   2.59 sec   618.00 M     1.95
 7 "double multiple variable multiplies2"   1.28 sec   1247.08 M     0.97
 8               "double variable divide"   5.12 sec   312.44 M     3.85
 9     "double multiple variable divides"  31.99 sec   50.01 M     24.07
10    "double multiple variable divides2"   1.29 sec   1240.31 M     0.97
11       "double multiple variable mixed"   1.94 sec   824.74 M     1.46

Total absolute time for double loop invariant: 55.41 sec 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T16:58:36.900

我想补充一下 Mats 所说的内容（我第二个），你可以只编写你需要的特定应用程序，并在具有不同优化标志的成品上尝试两者（例如，你可以使用 -Ofast 标志从 gcc 或其他允许惰性除法的标志等），看看是否有任何显着差异。

但在此之前，您只需回答以下问题：

*   我的程序够快吗？大多数程序都不受 CPU 限制，或者如果它们是，您不需要*比**现在*更快。
**   我的程序大部分时间都浪费在哪里了？*   有没有更高效的算法？*   内存消耗如何？*   IO怎么样？*

 *要回答这些问题，您所需要的只是分析和算法基础（如果需要，还可以进行一些组装，但没有它您可以做很多事情）。除非两个编译器给出非常不同的结果（这不应该发生），否则您实际上并不关心哪个编译器可以让您在程序中节省 10 秒（10 分钟内）。

大多数时候，程序慢不是因为编译器，而是因为程序员。为了说明我的观点，您可以查看以下内容：http: [//blog.golang.org/2011/06/profiling-go-programs.html](http://blog.golang.org/2011/06/profiling-go-programs.html) 不，我不打算将您转换为任何其他编程语言！但是发布它的人给我留下了深刻的印象，我想你会的。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-06T16:42:49.000

Different compilers generate different code for different (types of) operations. Without compiling the code with both compilers and comparing the assembler code generated, it's pretty hard to answer why one is better/worse than the other.

It is also probably not a great idea to take what appears to be fairly trivial functions (I'm too lazy to actually download and look at the code - I'm just reading the benchmark names and with experience of similar benchmarks drawing this conclusion), and from that draw the conclusion that you get the same level of improvement on a much larger piece of code. If you have a loop that can be solved by using one instruction or two instructions, and one compiler decides to use the "two instructions" (for whatever arbitrary reason compilers decide these things), then the whole loop may be 30-50% slower with two instructions. But that doesn't mean that if you do something else in the loop, that adds another four instructions in both compilers, the loop is still that much faster, right?

Even minute differences in instruction ordering or alignment can sometimes make a big difference on benchmarks with very small loops.*

# vb.net - Loading many crystal reports causes app crash?

> ID：14734069
> 
> 赞同：0
> 
> 时间：2013-02-06T16:32:36.230
> 
> 标签：vb.net, memory, crystal-reports

In application, there are many crystal reports, and all of them load with one method (same way), one of them loads maybe every 5 or 10 seconds (for more clarification, there is a list view with many items, each of them if the user make double click on it, a crystal report open and shows data about that item)

The problem now, is when user opens more than 3 or 4 reports by double click (not at same time, close one and open another one), and then open another reports, the app crashes because of memory!

Edited: in Form Closed Event, I make Close() and Dispose() for the report document.

Note that the report is declared as general variable in form class, that for dispose it in form close event.

This is the rep form code :

```
Imports System.Drawing.Printing
Imports CrystalDecisions.Shared
Imports CrystalDecisions.CrystalReports.Engine
Imports System.Data.OleDb

Public Class rep

    Public isEm, isShown As Boolean
    Public repName As String
    Dim CurrentReport As CrystalDecisions.CrystalReports.Engine.ReportDocument
    Public onNumT As String
    Public cl As Boolean

    Function loadSource(ByVal placeType As String) As DataTable

        Dim Conn As New OleDbConnection(ConnectionString)
        Dim Command As New OleDbCommand
        Command.CommandType = CommandType.Text

        Select Case placeType
            Case "city"
                Command.CommandText = "select placeName as TT from places where placeType = 'مدينة' order by placeName"
            Case "port"
                Command.CommandText = "select placeType+' '+placeName as TT from places where placeType in('مطار','ميناء','حدود') order by placeName"
            Case "driver"
                Command.CommandText = "select driverName from drivers"
        End Select

        Command.Connection = Conn
        Dim dataadapter As New OleDb.OleDbDataAdapter(Command.CommandText, Conn)

        Try
            Dim dt As New DataTable
            dataadapter.Fill(dt)
            Return dt.Copy
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.MsgBoxRight + MsgBoxStyle.Exclamation)
        Finally
            dataadapter.Dispose()
            Conn.Dispose()
            Command.Dispose()
        End Try
    End Function

    Private Sub LogOn(ByVal poReport As CrystalDecisions.CrystalReports.Engine.ReportDocument, _
                      ByVal strServer As String, _
                      ByVal strTable As String, _
                      ByVal strUsername As String, _
                      ByVal strPassword As String)

        Dim lsMethod As String = System.Reflection.MethodBase.GetCurrentMethod().Name
        Dim loConnInfo As New CrystalDecisions.Shared.ConnectionInfo
        loConnInfo.ServerName = strServer
        loConnInfo.DatabaseName = strTable
        loConnInfo.UserID = strUsername
        loConnInfo.Password = strPassword
        Dim loTables As CrystalDecisions.CrystalReports.Engine.Tables
        Dim loTable As CrystalDecisions.CrystalReports.Engine.Table
        Dim loTableLogonInfo As CrystalDecisions.Shared.TableLogOnInfo
        loTables = poReport.Database.Tables

        For Each loTable In loTables
            loTableLogonInfo = loTable.LogOnInfo
            loTableLogonInfo.ConnectionInfo.ServerName = strServer
            loTableLogonInfo.ConnectionInfo.ServerName = strTable
            loTable.ApplyLogOnInfo(loTableLogonInfo)
        Next
    End Sub

    Sub loadReport()

        Cursor = Cursors.WaitCursor

        Select Case repName
            Case "moves1"
                CurrentReport = New moves1
                LogOn(CurrentReport, DataBasePath, DataBasePath, "Admin", "")
                movesPanel.BringToFront()
                CityMoves.DataSource = loadSource("city")
                CityMoves.ValueMember = "TT"
                Me.AcceptButton = showButtonMoves
                movTypeMoves.SelectedItem = "الكل"
            Case "moves2"
                CurrentReport = New moves2
                LogOn(CurrentReport, DataBasePath, DataBasePath, "Admin", "")
                movesPanel.BringToFront()
                CityMoves.DataSource = loadSource("city")
                CityMoves.ValueMember = "TT"
                Me.AcceptButton = showButtonMoves
                movTypeMoves.SelectedItem = "الكل"
            Case "arrTrip"
                CurrentReport = New arrivalReport
                LogOn(CurrentReport, DataBasePath, DataBasePath, "Admin", "")
                tripsPanel.BringToFront()
                portTrip.DataSource = loadSource("port")
                portTrip.ValueMember = "TT"
                tripCaption.Text = "تاريخ الوصول"
                Me.AcceptButton = showButtonTrip
            Case "leaTrip"
                CurrentReport = New leavingReport
                LogOn(CurrentReport, DataBasePath, DataBasePath, "Admin", "")
                tripsPanel.BringToFront()
                portTrip.DataSource = loadSource("port")
                portTrip.ValueMember = "TT"
                tripCaption.Text = "تاريخ المغادرة"
                Me.AcceptButton = showButtonTrip
            Case "transReports"
                CurrentReport = New transReports
                LogOn(CurrentReport, DataBasePath, DataBasePath, "Admin", "")
                Me.AcceptButton = trButton
                transportPanel.BringToFront()
            Case "MovesPayes"
                CurrentReport = New MovesPayes
                LogOn(CurrentReport, DataBasePath, DataBasePath, "Admin", "")
                EmptyMovesPanel.BringToFront()
                driverName.DataSource = loadSource("driver")
                driverName.ValueMember = "driverName"
                Me.AcceptButton = showButtonEmptymoves
            Case "MonthlyMovesPayes"
                CurrentReport = New MonthlyMovesPayes
                LogOn(CurrentReport, DataBasePath, DataBasePath, "Admin", "")
                EmptyMovesPanel.BringToFront()
                driverName.Visible = False
                drCaption.Visible = False
                Me.AcceptButton = showButtonEmptymoves
            Case "trShow"
                CurrentReport = New transReports
                LogOn(CurrentReport, DataBasePath, DataBasePath, "Admin", "")
                Me.AcceptButton = trButton
                hp.BringToFront()
                Me.AcceptButton = Nothing
                CurrentReport.SetParameterValue(0, onNumT)
                Report.ReportSource = CurrentReport
        End Select

        Cursor = Cursors.Default
    End Sub

    Private Sub rep_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load

        Me.Tag = Me.Text
        loadReport()
    End Sub

    Private Sub rep_Shown(sender As System.Object, e As System.EventArgs) Handles MyBase.Shown

        Cursor = Cursors.Default
        isShown = True
    End Sub

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles printt.Click

        Dim m As New CrystalDecisions.CrystalReports.Engine.ReportDocument
        Dim oo As New PrintDialog

        Try
            If Report.ReportSource Is Nothing Then Exit Sub Else m = Report.ReportSource
            oo.AllowSomePages = True

            If oo.ShowDialog() <> DialogResult.OK Then Exit Sub
            m.PrintToPrinter(oo.PrinterSettings, oo.PrinterSettings.DefaultPageSettings, False)
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.Exclamation + MsgBoxStyle.MsgBoxRight)
        Finally
            m.Dispose()
            oo.Dispose()
        End Try
    End Sub

    Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles send.Click

        If Report.ReportSource Is Nothing Then Exit Sub
        Dim mailf As New MailForm
        Dim reportt As New CrystalDecisions.CrystalReports.Engine.ReportDocument

        Try
            Cursor = Cursors.WaitCursor
            reportt = CurrentReport
            FileIO.FileSystem.CreateDirectory(Application.StartupPath & "\temp\")
        reportt.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, Application.StartupPath & "\temp\temp.pdf")
            If FileIO.FileSystem.FileExists(Application.StartupPath & "\temp\temp.pdf") = True Then mailf.addfile(Application.StartupPath & "\temp\temp.pdf") Else Exit Sub
            mailf.bodyy.Text = " "
            mailf.subject.Text = "شركة البركة"
            mailf.ShowDialog()
            Cursor = Cursors.Default
            Kill(Application.StartupPath & "\temp\temp.pdf")
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.Exclamation + MsgBoxStyle.MsgBoxRight)
        Finally
            reportt.Close()
            reportt.Dispose()
            mailf.Dispose()
        End Try
    End Sub

    Private Sub rep_FormClosing(sender As System.Object, e As System.Windows.Forms.FormClosingEventArgs) Handles MyBase.FormClosing

        Cursor = Cursors.Default
    End Sub

    Private Sub showButtonMoves_Click(sender As System.Object, e As System.EventArgs) Handles showButtonMoves.Click, showButtonEmptymoves.Click, showButtonTrip.Click, CityMoves.SelectedValueChanged, dateMoves.ValueChanged, DateTrip.ValueChanged, driverName.SelectedValueChanged, DriverDate.ValueChanged, dateMoves.ValueChanged, portTrip.SelectedValueChanged, trButton.Click, movTypeMoves.SelectedValueChanged

        Try
            If isShown = False Then Exit Sub
            If CurrentReport Is Nothing Then loadReport()
            Report.ReportSource = Nothing

            Select Case repName
                Case "moves1", "moves2"
                    CurrentReport.SetParameterValue("d1", dateMoves.Value)
                    CurrentReport.SetParameterValue("cit", CityMoves.GetItemText(CityMoves.SelectedItem).Replace("المدينة المنورة", "المدينة"))
                    CurrentReport.SetParameterValue("moveType", movTypeMoves.Text)
                    Report.ReportSource = CurrentReport
                Case "leaTrip", "arrTrip"
                    CurrentReport.SetParameterValue("d1", DateTrip.Value.ToShortDateString)
                    CurrentReport.SetParameterValue("customport", portTrip.GetItemText(portTrip.SelectedValue))
                    Report.ReportSource = CurrentReport
                Case "MovesPayes"
                    CurrentReport.SetParameterValue("drivername", driverName.GetItemText(driverName.SelectedValue))
                    CurrentReport.SetParameterValue("mont", DriverDate.Value.Month)
                    Report.ReportSource = CurrentReport
                Case "MonthlyMovesPayes"
                    CurrentReport.SetParameterValue("mont", DriverDate.Value.Month)
                    Report.ReportSource = CurrentReport
                Case "transReports"
                    CurrentReport.SetParameterValue(0, onNum.Text)
                    Report.ReportSource = CurrentReport
            End Select
        Catch ex As Exception
            MsgBox(ex.Message, MsgBoxStyle.MsgBoxRight + MsgBoxStyle.Exclamation)
        End Try
    End Sub

    Private Sub nMoves1_Click(sender As System.Object, e As System.EventArgs) Handles nMoves1.Click

        Report.ShowNextPage()
    End Sub

    Private Sub nfMoves1_Click(sender As System.Object, e As System.EventArgs) Handles nfMoves1.Click

        Report.ShowLastPage()
    End Sub

    Private Sub pMoves1_Click(sender As System.Object, e As System.EventArgs) Handles pMoves1.Click

        Report.ShowPreviousPage()
    End Sub

    Private Sub pfMoves1_Click(sender As System.Object, e As System.EventArgs) Handles pfMoves1.Click

        Report.ShowFirstPage()
    End Sub

    Private Sub rep_FormClosed(sender As System.Object, e As System.Windows.Forms.FormClosedEventArgs) Handles MyBase.FormClosed

        Report.ReportSource = Nothing
        CurrentReport.Close()
    End Sub
End Class 
```

What is the problem ?

Thank You Very Much

# python - Extracting a number from an unspaced string in Python

> ID：14734072
> 
> 赞同：1
> 
> 时间：2013-02-06T16:32:44.080
> 
> 标签：python

I need to extracted a number from an unspaced string that has the number in brakets for example:

```
"auxiliary[0]" 
```

The only way I can think of is:

```
def extract_num(s):    
   s1=s.split["["]
   s2=s1[1].split["]"]
   return int(s2[0]) 
```

Which seems very clumsy, does any one know of a better way to do it? (The number is always in "[ ]" brakets)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T16:35:03.710

您可以使用正则表达式（使用内置[`re`模块](http://docs.python.org/2/library/re.html)）：

```
import re

bracketed_number = re.compile(r'\[(\d+)\]')

def extract_num(s):
    return int(bracketed_number.search(s).group(1)) 
```

该模式匹配一​​个文字`[`字符，后跟 1 个或多个数字（`\d`转义表示数字字符组，`+`表示 1 个或多个），后跟一个文字`]`. 通过在部分周围加上括号`\d+`，我们创建了一个捕获组，我们可以通过调用`.group(1)`（“获取第一个捕获组结果”）来提取它。

结果：

```
>>> extract_num("auxiliary[0]")
0
>>> extract_num("foobar[42]")
42 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T16:36:12.130

我会使用正则表达式来获取数字。请参阅文档：[http ://docs.python.org/2/library/re.html](http://docs.python.org/2/library/re.html)

就像是：

```
import re
def extract_num(s):
  m = re.search('\[(\d+)\]', s)
  return int(m.group(1)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T16:36:56.363

```
print a[-2] 
```

* * *

```
print a[a.index(']') - 1] 
```

* * *

```
print a[a.index('[') + 1] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T16:40:03.080

```
for number in re.findall(r'\[(\d+)\]',"auxiliary[0]"):
    do_sth(number) 
```

# mysql - Select entries by day over the last 7 days

> ID：14734073
> 
> 赞同：0
> 
> 时间：2013-02-06T16:32:48.520
> 
> 标签：mysql, sql, datetime

I want to get the count of the registered users in the past 7 days, grouped.

```
+-----+------------+--------------+
| id  | username   | created      |
+-----+------------+--------------+
|  1  | Vlad       | 1360168194   |
+-----+------------+--------------+
|  2  | Test       | 1360168194   |
+-----+------------+--------------+ 
```

This is my table. I want to have 7 rows of results with the date of the day, and count(id) as the result for the users that registered.

I tried different solutions and none of them really fitted my needings. Are there any ideas?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:35:59.527

```
SELECT  DATE(FROM_UNIXTIME(columName)), COUNT(ID) totalCOunt
FROM    tableName
WHERE   DATE(FROM_UNIXTIME(columName)) BETWEEN CURDATE() + INTERVAL -7 DAY AND CURDATE()
GROUP   BY DATE(FROM_UNIXTIME(columName)) 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/26b50/3)

其他来源

*   [MySQL 日期和时间函数](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)

# ajax - Advanced Ajax Page Loader: Reload Bootstrap

> ID：14734075
> 
> 赞同：1
> 
> 时间：2013-02-06T16:32:49.973
> 
> 标签：ajax, wordpress, pageload

On my wordpress-site the blog page is different than the rest of the site. Therefore I built a second bootstrap.css and loaded it this way:

```
if( is_page_template('page-blog.php') )
{
    wp_enqueue_style('roots_bootstrap', get_template_directory_uri() . '/assets/css/blog/bootstrap.css', false, null);
    wp_enqueue_style('roots_bootstrap_responsive', get_template_directory_uri() . '/assets/css/blog/responsive.css', array('roots_bootstrap'), null);   
}else{
    wp_enqueue_style('roots_bootstrap', get_template_directory_uri() . '/assets/css/bootstrap.css', false, null);
    wp_enqueue_style('roots_bootstrap_responsive', get_template_directory_uri() . '/assets/css/responsive.css', array('roots_bootstrap'), null);
} 
```

But I need to use Advanced Ajax Page Loader and of course it doesnt work anymore. Is there a way to let AAPL reload my script and not only that: Reload the right one depending on the page I'm on?

# android - Android: Communication and coordination between UI-thread and other thread

> ID：14734077
> 
> 赞同：0
> 
> 时间：2013-02-06T16:32:58.753
> 
> 标签：android, multithreading, android-activity, android-asynctask

I'm using this AsyncTask for calling the skype page [https://login.skype.com/json/validator?new_username=username](https://login.skype.com/json/validator?new_username=myusername) for understand if a certain skype contact already exsists.

```
public class SkypeValidateUserTask extends AsyncTask<String, Void, String>{

protected String doInBackground(String...urls){
    String response = "";
    for(String url:urls){
        DefaultHttpClient client = new DefaultHttpClient();
        HttpGet httpGet = new HttpGet(url);
        try{
            HttpResponse execute = client.execute(httpGet);
            InputStream content = execute.getEntity().getContent();

            BufferedReader buffer = new BufferedReader(new InputStreamReader(content));

            String s="";
            while((s=buffer.readLine()) != null){
                response+=s;
            }
        }catch(Exception ex){
            ex.printStackTrace();
        }
    }
    return response;
}

public void onPostExecute(String result){
    String status="";
    try{    
        JSONObject obj=new JSONObject(result);
        status=obj.getString("status");
    }catch(Exception ex){
        ex.printStackTrace();
    }
    //Log.i("RISULTATO: ","STATO: "+status);

}
} 
```

The main activity call this task for getting skype validation user result. The code is:

```
String skype = "name.surname.example";  

if(!skype.equalsIgnoreCase("")){
            // check if the skype contact exists
            SkypeValidateUserTask task = new SkypeValidateUserTask();
            task.execute(new String[] {"https://login.skype.com/json/validator?new_username="+skype});  

                // here I need to obtain the result of the thread

        } 
```

My problems are:

1.  I need to get the result of the task (the String `status`) in the main activity.

2.  After the `task.execute` call, the next code in main activity is executed without wait for result returned from asynctask.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:34:42.847

使用 get() 方法从异步任务中获取结果是危险的，因为它阻塞了 UI 线程。使用这个线程，我提供了一个可重用的解决方案[回调机制来从异步线程获取结果而不阻塞 UI 线程](https://stackoverflow.com/questions/14253421/how-one-interface-can-be-used-for-different-background-android-tasks/14376233#14376233)

我在[lapslaz的帮助下实现了这一点](https://stackoverflow.com/users/1342413/laplasz)

```
public JsonData(YourActivityClass activity) 
{
    this.activity=activity;
    mProgressDialog = new ProgressDialog(activity);

}
protected void onPostExecute(String jsondata) {
    if (mProgressDialog != null || mProgressDialog.isShowing()){
        mProgressDialog.dismiss();
    }
    if(jsondata!=null) {
        activity.yourcallback(jsondata)
    }

}

And define the yourcallback() in YourActivityClass

private void yourcallback(String data) {
    jsonRecordsData=data;
    showRecordsFromJson();

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:41:11.320

在主线程上启动您的 AsyncTask。在 AsyncTask 的**preExecute**方法中，您可以启动 ProgressDialog 以向用户指示您正在执行的操作需要几秒钟。使用**doInBackground**执行长时间运行的任务（在您的情况下检查有效的 Skype 用户名）。完成后，将调用**onPostExecute 。**由于这在 UI 线程上运行，因此您可以处理结果并根据它执行进一步的操作。不要忘记在 onPostExecute 中关闭 ProgressDialog。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:15:14.033

从 AsyncTask 中获取结果很容易。. . 只是谷歌文档没有明确说明如何做到这一点。这是一个快速运行。

```
task.execute(params); 
```

将启动 AsyncTask 并将`doInBackground`您包含的任何参数传递给该方法。`doInBackground`完成后，它将其函数的结果传递`onPostExecute`给. 有人会认为这`onPostExecute`将能够退回您发送的任何内容。它没有。要获得`doInBackground`发送给`onPostExecute`您的结果，需要调用

```
task.get(); 
```

该`.get()`方法会自动等待任务完成执行，然后将返回的任何结果`onPostExecute`返回给 UI 线程。您可以将结果分配给您想要的任何变量并在此之后正常使用 - 例如

```
JSONObject skypeStuff = task.get() 
```

换句话说 - 就像 AsynTask 不会自行启动一样，它也不会自行返回。与您需要从 UI 线程相同的方式`.execute()`，您需要从 UI 线程调用`.get()`以提取任务的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T16:35:55.323

这就是为什么 asyncTask 在这里。您不能在 UI 线程中进行阻塞函数调用，因为这会使您的应用程序无响应。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T16:36:03.590

****在UI/主**线程上调用**OnPostExcute** 方法。您需要将逻辑移到那里以继续分析结果。**

 *** * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-06T16:38:08.797

如果您`AsyncTask`是主要活动的内部类，那么您可以在主要活动中调用一个函数并将其传递给`result`

由于它看起来不是，您可以在您的构造函数中创建构造函数`Async`并将其`Context`从您的主要活动传递给您，这样您就可以将变量传递回主要活动

此外，目的`AyncTask`是不阻塞您的线程，将您的逻辑放在将调用`UI`的单独函数中`AsyncTask`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-06T16:38:39.697

您需要在 AsyncTask 中实现回调机制。所以代替这个：

```
task.execute(...);
// use results of task 
```

你的结构应该是：

```
 task.execute(...);
    // go do something else while task has a chance to execute

public void statusAvailable(String status) {
    // use results of task
} 
```

并在`onPostExecute`：

```
public void onPostExecute(String result) {
    . . .
    status=obj.getString("status");
    activity.statusAvailable(status);
} 
```**

# c - gdb prints wrong values when modifying arguments

> ID：14734078
> 
> 赞同：9
> 
> 时间：2013-02-06T16:33:05.857
> 
> 标签：c, gdb

# System

Fresh install of codeblocks 12.11 + mingw pack.

*   win7 64
*   gcc 4.7.1
*   gdb 7.5

# Example code

Compiled with -g and no optimization.

```
#include <stdio.h>

void foo(int a, int b);

int main() {

    foo(400, 42);

    return 0;
}

void foo(int a, int b) {

    a = a - 10;
    b = a + 1;

    printf("y2 %d\n", b);

} 
```

# Problem

I put a breakpoint on "void foo(int a, int b)" and I look value of b as I step through the 3 lines. Either with the codeblocks debugging features or with the gdb command line, **the value of b is 42 instead of being 391**. The console output is correct, 391.

## GDB commands

```
C:\DebugTest>"C:\Program Files (x86)\CodeBlocks\MinGW\bin\gdb.exe"
GNU gdb (GDB) 7.5
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "i686-pc-mingw32".
For bug reporting instructions, please see:  
<http://www.gnu.org/software/gdb/bugs/>.
(gdb) file bin/Debug/DebugTest.exe
Reading symbols from C:\DebugTest\bin\Debug\DebugTest.exe...done.
(gdb) break foo
Breakpoint 1 at 0x401363: file C:\DebugTest\main.c, line 14.
(gdb) run
Starting program: C:\DebugTest\bin\Debug\DebugTest.exe
[New Thread 3596.0x658]

Breakpoint 1, foo (a=400, b=42) at C:\DebugTest\main.c:14
14          a = a - 10;
(gdb) print b
$1 = 42
(gdb) step
15          b = a + 1;
(gdb) print b
$2 = 42
(gdb) step
17          printf("y2 %d\n", b);
(gdb) print b
$3 = 42
(gdb) 
```

# Remarks

*   When the **same operations** are done **without** a function, with a and b as local variables inside main, the debug output is **correct**.
*   When compiled with gcc 4.4.1, the debug output is **correct**.

Any idea what could be wrong ? =)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T19:36:21.123

我在 gcc bugzilla 上搜索并发现了这个错误报告：

*   [错误 54218 - 使用 -O0 编译时函数参数的调试信息不​​正确”](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=54218)

尽管报告是关于 gcc 4.8 而我使用的是 4.7，但我尝试了建议的解决方法并且它有效！

**编译`-fvar-tracking`允许 GDB 在赋值后打印 b 的正确值。**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T22:17:45.090

gcc 不会为寄存器中的值正确生成调试信息——无论是已放入寄存器中的值还是由于调用约定而从那里开始的值。从至少 4.0 开始，这是 gcc 的一个长期存在的问题，并且使调试变得很棘手。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:38:23.563

有时优化器比调试器更聪明。尝试调试未优化的代码，或者逐步反汇编并直接观察硬件寄存器，而不是逐步通过 C 源代码行并观察调试器对变量的概念。

# asp.net - 浏览网站时保持 ASP.Net TreeView 节点折叠

> ID：14734081
> 
> 赞同：1
> 
> 时间：2013-02-06T16:33:12.577
> 
> 标签：asp.net, vb.net, treeview, nodes, collapse

我注意到在浏览 ASP.Net 网站时，TreeView 中的节点总是展开。

是否有我们可以在标记中包含的设置或属性，使 TreeView 节点保持折叠直到用户展开它们？

也许需要在代码隐藏文件中添加一些东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T21:53:14.703

我不认为你可以在标记中做到这一点。但在代码中是可能的 - 背后。查看此链接以获取一些示例代码：[折叠所有打开的节点](http://www.devcurry.com/2009/05/collapse-all-open-nodes-of-aspnet.html)。

我很确定我几年写的一个应用程序用一行代码折叠了整个树（就像你一样，我们发现它不断打开每个帖子）。如果此链接不起作用，我将发布我明天使用的代码。

我正在寻找的一行代码是

```
tv.CollapseAll(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T05:57:22.930

是的，它被称为[ExpandDepth](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.treeview.expanddepth.aspx)

ExpandDepth - 获取或设置第一次显示 TreeView 控件时展开的级别数。

如果要折叠所有节点，包括根节点，只需将其设置为 0

```
<asp:TreeView ExpandDepth="0" ... 
```

# c# - Run different applications on 2 monitors

> ID：14734082
> 
> 赞同：3
> 
> 时间：2013-02-06T16:33:17.843
> 
> 标签：c#

I have this C# project I'm working on, where I need to launch some videos on the second monitor and my application on the main monitor.

Is this possible to be done in C#? Launch some videos on monitor 2 in full screen and launch my application windows in full screen also.

So basically, I need to know how can select a specific screen and do something on it also how can I make an application launch in full screen.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-25T19:26:51.833

我认为实际上应该可以使用 Direct3D，而我自己没有这样做。

您应该能够识别您的监视器，并在每个监视器上执行适当的工作。

在您的情况下，我将创建两个不同的 Direct3D 设备，每个设备都有自己的资源（在两个不同的设备之间共享资源似乎是不可能的）。

以下是 MSDN 上的一些 Direct3D 示例：http: [//msdn.microsoft.com/en-us/library/windows/desktop/bb153298 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb153298(v=vs.85).aspx)

在这里您也可以找到在 MSDN 上创建 Direct3D 设备的方法：http: [//msdn.microsoft.com/en-us/library/windows/desktop/bb153258 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb153258(v=vs.85).aspx)

# php - How to access item URL's or _view template in TbGridView

> ID：14734083
> 
> 赞同：-1
> 
> 时间：2013-02-06T16:33:27.303
> 
> 标签：php, twitter-bootstrap, yii

Yii newbie...

How to access _view template in TbGridView, With a CListView, I can do it with:

```
'itemView' => '_view' 
```

But itemView is not an option with GridView

```
<?php $this->widget('bootstrap.widgets.TbGridView', array(
    'type'=>'striped bordered condensed',
    'dataProvider'=>$dataProvider,

)); ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T12:46:20.370

根本不可能，您应该使用[`CListView`](http://www.yiiframework.com/doc/api/1.1/CListView), 或 extends [`CGridView`](http://www.yiiframework.com/doc/api/1.1/CGridView)。

> 与[`CGridView`](http://www.yiiframework.com/doc/api/1.1/CGridView)在表格中显示数据项不同，它[`CListView`](http://www.yiiframework.com/doc/api/1.1/CListView) 允许使用视图模板来呈现每个数据项。结果，[`CListView`](http://www.yiiframework.com/doc/api/1.1/CListView)可以生成更灵活的渲染结果。

# python - Regex in python for extract informations of request

> ID：14734086
> 
> 赞同：0
> 
> 时间：2013-02-06T16:33:38.613
> 
> 标签：python, regex, request

I need extract information of a web page with python , in perl i use this code:

```
if($body =~ /info(.*)info/){
print $1;
} 
```

how to convert this code for python ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:37:07.313

尝试这样的事情：

```
import re

body = '' # your text here

for m in re.findall('info(.*)info', body):
    print m 
```

`re`在[文档](http://docs.python.org/library/re.html)中阅读更多信息

# ios - 如何检查沙盒服务器状态？（“无法连接到 iTunes 商店”）

> ID：14734088
> 
> 赞同：11
> 
> 时间：2013-02-06T16:33:45.107
> 
> 标签：ios, storekit

我正在使用这个优秀的教程开发应用内购买： [http](http://www.raywenderlich.com/21081/introduction-to-in-app-purchases-in-ios-6-tutorial) ://www.raywenderlich.com/21081/introduction-to-in-app-purchases-in-ios-6-tutorial 我收到一个错误“无法连接到 iTunes 商店”，这似乎与 Apple 的沙盒服务器关闭有关；除了谷歌搜索有关沙盒状态的推文外，还有其他方法可以确认它们的状态，否则很难（阅读可能）进行调试。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2014-01-16T16:13:29.483

晚了将近一年，但我现在面临同样的问题。据我所知，测试 iTunes 沙盒环境状态的最好方法是检查这个 url：

[http://sandbox.itunes.apple.com](http://sandbox.itunes.apple.com)

调试器输出中的一种`Http/1.1 Service Unavailable`方法`SSErrorHTTPStatusCodeKey=503`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-15T22:46:28.130

我会回答这个问题，以防其他人也遇到这个问题。我在应用商店中有一个使用问题中提到的教程构建的应用程序，它的性能完美无缺。不幸的是，根据我的经验，Apple Sandbox 服务器的可靠性可能是不确定的，除了在 Apple 论坛上发帖并希望得到确凿的答复之外，没有明显的地方可以在线检查。

正如其他人在 StackOverflow 上所说，关键是要确保：

1.  您在 itunesconnect.apple.com 上至少创建一个测试用户帐户
2.  确保没有与测试帐户关联的信用卡
3.  请勿使用测试帐户在您的测试设备上登录 iTunes。相反，请退出您登录的任何 iTunes Store 帐户。然后尝试购买 IAP。它会询问您的用户名和密码 - 给它您的测试用户名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-10-31T20:06:58.023

使用测试人员沙盒帐户时出现“无法连接到 iTunes 商店”错误。问题是我使用该帐户在我的 iPhone 上登录并确认了与测试帐户关联的电子邮件地址。

我通过在 Itunes Connect 的用户和角色下创建一个新的测试人员帐户解决了这个问题，并且从不使用该帐户登录我的设备。

在我的案例中出现错误的原因是，当我确认电子邮件地址时，该帐户已在 AppStore 中注册为生产帐户，并且不再用作沙盒帐户。

因此，如果您在设备上登录一次，该帐户将被注册为生产帐户，即使您再次退出，该帐户也无法在沙箱中使用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-05T08:17:12.787

用于测试 Sand Box 中的应用程序。按着这些次序

1.  要测试 IAP，我们必须在 itunesconnect.apple.com 创建一个测试用户

2.  转到“设置”并从所有活动帐户（邮件、iTunes 和 App Store、Game Center）中退出

3.  重新启动您的设备。

4.  在设备上运行您的应用程序。单击 IAP 按钮 -> 选择现有帐户 -> 输入步骤 1 中创建的 Apple ID 和密码。现在一切都会好起来的。

# c++ - 如何从 C++ 程序中打开自定义 I/O 流？

> ID：14734091
> 
> 赞同：2
> 
> 时间：2013-02-06T16:33:55.730
> 
> 标签：c++, io, stream, posix, file-descriptor

众所周知，有三个默认 I/O 流映射到标准库中的预定义对象：

*   0：`std::istream std::cin`
*   1：`std::ostream std::cout`
*   2：`std::ostream std::cerr`和`std::ostream std::clog`

但是，从（例如）bash 脚本中，您可以创建其他流（3,4，...）。

那么，您可以使用描述符 3 创建一个额外的输出流并将其绑定到一个`std::ostream custom`对象吗？如果是这样，怎么做？`std::ofstream`没有做到这一点，因为它会创建一个名为“3”的文件，这不是我想要的。

* * *

编辑：它不必是便携式的。如果它在 POSIX 上工作就足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:39:06.493

如果您需要您的程序是可移植的，这是不可能的。C++ 11 标准没有指定一个统一的方式来做到这一点。

但是，您可以定义自己的输出流缓冲区，该缓冲区覆盖`overflow()`和`xsputn()`虚函数，并使用系统特定的 API 将每个字符或字符序列写入具有指定描述符的流。

这些方面的东西：

```
class my_ostream_buf : public std::streambuf
{

public:

    my_ostream_buf(int fd) : _fd(fd) { }

protected:

    virtual int_type overflow (int_type c)
    {
        if (c != EOF)
        {
            char ch = c;
            if (write(_fd, &ch, 1) != 1)
            {
                return EOF;
            }
        }

        return c;
    }

    // This is not strictly necessary, but performance is better if you
    // write a sequence of characters all at once rather than writing
    // each individual character through a separate system call.
    virtual std::streamsize xsputn(const char* s, std::streamsize num)
    {
        return write(_fd, s, num);
    }

private:

    int _fd = 0;    

}; 
```

这就是你将如何使用它：

```
using namespace std;

int main()
{
    int fd = ...; // Any file descriptor
    my_ostream_buf buf(fd);

    ostream os(&buf); // Take care of the lifetime of `buf` here, or create your
                      // own class that derives from ostream and encapsulates an
                      // object of type my_ostream_buf

    os << "Hello" << endl;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:44:14.510

There's nothing provided for this in the standard. In a good implementation of IOStream, there should be some additional, implementation specific constructors for `std::filebuf`, which take a system file descripter (whose type will depend on the system), and create a filebuf from that. If not, you'll have to create your own streambuf. This can be more or less difficult, depending on what you need: if you're just need a simple, uni-directional stream (read or write, but not both), with no support for seeking and no code translation on input, it's relatively simple. (But you still have to be familiar with the system level requests, like `read` or `write`.) If you want to support everything that `filebuf` does, it is significantly more complicated.

## EDIT:

Just thought I'd add an example. Since you speak of `bash`, I'll suppose Unix:

```
class FdStreambuf : public std::streambuf
{
    int myFd;
    char buffer[1024];

    bool writeBuffer()
    {
        int len = pptr() - pbase();
        return len == 0 || write( myFd, pptr(), len ) == len;
    }

protected:
    int overflow( int ch )
    {
        int results = ch == traits::eof() ? 0 : ch;
        if ( pbase() != NULL ) {
            if ( ! writeBuffer() ) {
                results = traits::eof();
            }
        }
        setp( buffer, buffer + sizeof( buffer ) );
        sputc( ch );
        return ch;
    }

    int sync()
    {
        return writeBuffer() ? 0 : -1;
    }

public:
    FdStreambuf( int fd ) : myFd( fd ) {}
    int close()
    {
        sync();
        return ::close( myFd );
    }
};

class FdOStream : private FdStreambuf, public std::ostream
{
public:
    FdOStream( int fd )
        : FdStreambuf( fd )
        , std::ostream( this )
    {
    }
    void close()
    {
        if ( FdStreambuf::close() != 0 ) {
            setstate( std::ios_base::badbit );
        }
    }
}; 
```

(I think that's all that's necessary, but it's possible I've forgotten something.)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T23:30:29.443

我结合了[Andy](https://stackoverflow.com/a/14734199/430766)和[James](https://stackoverflow.com/a/14734315/430766)的答案，这就是我得到的（以防有人需要）

## 流.h

```
#pragma once

#include <ostream>
#include <unistd.h>

namespace util {
  class StreamWrapperImpl : public std::ostream {
    private:
      typedef std::streambuf* OwnedBufPtr;
      OwnedBufPtr const buf;
    public:
      StreamWrapperImpl(OwnedBufPtr buf)
      : std::ostream(buf)
      , buf(buf)
      {}
      virtual ~StreamWrapperImpl() {
        delete buf;
      }
  };
  template <typename Buf>
  class StreamWrapper : public StreamWrapperImpl {
    public:
      StreamWrapper()
      : StreamWrapperImpl(new Buf())
      {}
      template <typename Arg>
      StreamWrapper(Arg arg) // this could use some perfect forwarding in C++11
      : StreamWrapperImpl(new Buf(arg))
      {}
  };

  class FdStreamBuf : public std::streambuf {
    private:
      int fd;
    protected:
      virtual int_type overflow(int_type c) {
        if (c != EOF) {
          char const ch = c;
          if (write(fd, &ch, 1) != 1)
            return EOF;
        }
        return c;
      }
      virtual std::streamsize xsputn(char const* s, std::streamsize num) {
        return write(fd, s, num);
      }
    public:
      FdStreamBuf(int fd)
      : fd(fd)
      {
      }
  };
} 
```

# php - 更新 mysql_num_rows

> ID：14734093
> 
> 赞同：0
> 
> 时间：2013-02-06T16:33:55.950
> 
> 标签：php, mysqli

我尝试将一些 mysql 代码更新到 mysqli。我现在怎么说：如果有选择的东西......

php.net 说 mysql_num_rows 已被弃用，并为此功能提供其他替代方案，看起来更复杂： http: [//php.net/manual/en/function.mysql-num-rows.php](http://php.net/manual/en/function.mysql-num-rows.php)

在尝试了很多东西之后，我发现如果我只添加一个“i”，这很有效。它是正确的还是有更好的解决方案？既然这么容易，为什么php.net 连提都不提？：

```
$result = mysqli_query($con, "SELECT * FROM client");

    if (mysqli_num_rows($result)>0) {
        // do something 
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T12:24:29.703

在问了很多人之后，这似乎是正确的。似乎 php.net 接受 mysqli_num_rows：[http ://php.net/manual/es/mysqli-result.num-rows.php](http://php.net/manual/es/mysqli-result.num-rows.php)

我仍然不明白为什么当您查看 mysql_num_rows 时他们不说 mysqli_num_rows 是正确的。： http: [//php.net/manual/en/function.mysql-num-rows.php](http://php.net/manual/en/function.mysql-num-rows.php)。他们将您发送到其他解决方案这可能会造成很多混乱。

无论如何，我认为，这是有效的，它是更新的 mysqli：

```
$result = mysqli_query($con, "SELECT * FROM client");
    if (mysqli_num_rows($result)>0) {
        // do something 
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:36:09.920

直接来自手册：[fetch-assoc](http://php.net/manual/en/mysqli-result.fetch-assoc.php) & [num-rows](http://php.net/manual/en/mysqli-result.num-rows.php)

```
<?php
$link = mysqli_connect("localhost", "my_user", "my_password", "world");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$query = "SELECT ColumnList FROM client";

if ($result = mysqli_query($link, $query) && mysqli_num_rows($result) > 0) {
    ...
}

/* close connection */
mysqli_close($link);
?> 
```

# spring - 如何在 Tomcat 6 上拥有 web-fragment.xml

> ID：14734094
> 
> 赞同：2
> 
> 时间：2013-02-06T16:34:00.717
> 
> 标签：spring, maven, tomcat, web.xml

我想在许多 WAR 档案中分享一些来自*web.xml的定义。*我不想在许多*web.xml*中重复行。所以我创建了具有依赖关系的 Maven 模块。但现在我想分享*web.xml*。我看到*web-fragment.xml*在带有 Servlet 3.0 的 Tomcat 7 中工作，但有没有在 Tomcat 6 中工作的解决方案？

我尝试在 Tomcat 6 中使用 mywebapp/WEB-INF/lib/jar/META-INF/web-fragment.xml 但没有附加任何内容。有没有办法在 Tomcat 6 中共享 web.xml？

我正在使用 Spring 3，JSPX。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:20:51.157

因为 tomcat6 没有实现 servlet 3.0 规范。所以AFAIK没办法:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T13:39:26.117

非常hackish，但更改 $CATALINA_HOME/conf/web.xml 中的默认 web.xml

# php - 使用 WAMP 的 PHP 脚本显示带有标签的 HTML 输出

> ID：14734095
> 
> 赞同：0
> 
> 时间：2013-02-06T16:34:02.080
> 
> 标签：php, wamp

`enter code here`这是我在 Stack Overflow 上的第一篇文章，所以如果我太含糊，请原谅我，并且没有给你必要的信息来立即诊断我的问题！

我创建了一个使用表单上传图像的临时页面。然后表单发布到一个 php 页面，该页面重新采样图像并创建一个新图像，调整大小并裁剪。

我遇到的问题是，在图像上传到的 php 页面上，所有 PHP 代码都正确发布并按我预期的方式运行，但是所有 HTML 代码都显示在浏览器中而没有格式化。我不知道为什么，我以前从未遇到过这个问题。

这是上传表单页面的代码：

```
<! Image test: Testing the ability to upload an image, resize and crop. >
<! Idealy, this procedure would be performed on large images. >

<! Car Listing page images: 280 x 200 px >

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
   <?php require_once("baseopen.php"); ?>
   <?php

   if (isset($_POST['error1'])) {
    $error = "The file selected was not of the correct filetype.<br />
     Please select a different file to upload.";
   }

   ?>

   <html>
   <?php if (isset($error)) { echo $error; } ?>
   <p>Select an image of type <b>.JPG, .GIF, .PNG, or .BMP</b> to upload.</p><br />
   <form action="converter.php" method="post" enctype="multipart/form-data">
   <label for="image">Picture:</label>
   <input type="file" name="image"><br />
   <input type="submit" name="submit" value="Upload">
   </form>

   </html>

   <?php mysql_close($data); ?> 
```

这是我处理 PHP 时遇到的问题并输出所有 HTML 标记的内容。（请注意，PHP 已处理，不会显示在浏览器中。）

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html>
<?php
 if($_SERVER['REQUEST_METHOD'] == "POST") {
  $file = $_FILES['image']['name'];
  $servfile = $_FILES['image']['tmp_name'];
  echo "\$File: " . $file . "<br />";
  echo "\$servfile: " . $servfile . "<br /><br />";

  $filename = explode(".", $file);
  echo $filename[0] . "<br />";
  echo $filename[1] . "<br />";
  $filename[1] = strtolower($filename[1]);

  /* Begin execution once file extension is confirmed. */
  if ($filename[1] == "jpg" || $filename[1] == "gif" || $filename[1] == "png" || $filename[1] == "bmp") {
   echo "Successful recognition! <br />";
   crop($servfile, $filename[1], "280", "200");
  }
  /* Send back to main page with an error code. */
  else {
   echo "Error, dude!";
  }
 }

 function crop($filename, $type, $width, $height) {
  /* Create a new image from the proper filetype. */
  if ($type == "jpg") { $resource = imagecreatefromjpeg($filename); }
  if ($type == "gif") { $resource = imagecreatefromgif($filename); }
  if ($type == "png") { $resource = imagecreatefrompng($filename); }
  if ($type == "bmp") { $resource = imagecreatefrombmp($filename); }

  echo "Width is: " . imagesx($resource) . "<br />";
  echo "Height is: " . imagesy($resource) . "<br />";
  echo "Desired width is: " . $width . "<br />";
  echo "Desired height is: " . $height . "<br />";

  /* Check to make sure image is larger than needed size. */
  if ( ($width < imagesx($resource)) && ($height < imagesy($resource))) {
   echo "We can do this! <br />";

   $new = imagecreatetruecolor($width, $height);
   imagecopyresampled($new, $resource,
    0, 0, 0, 0, $width, $height, imagesx($resource), imagesy($resource));
    header('Content-type: image/jpeg');
    imagejpeg($new, "temp.jpg", 100);
    echo "<img src=\"temp.jpg\">";
  }
  /* Return with error that image is too small! */
  else { echo "Nope, not big enough."; }
  }
?>
</html> 
```

当前使用运行 PHP 5.3.5 的 WAMPSERVER。

测试服务器运行所有 PHP 页面都没有错误，除了我已经奋斗了几个星期的这个页面。

添加：在尝试上传名为“8.jpg”的图像时，Internet Explorer 中的输出是这样的。这是converter.php的实际视图输出：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html> $File: 8.jpg<br />$servfile: C:\wamp\tmp\php82F0.tmp<br /><br />8<br />jpg<br />Successful recognition! <br />Width is: 1680<br />Height is: 1050<br />Desired width is: 280<br />Desired height is: 200<br />We can do this! <br /><img src="temp.jpg"></html> 
```

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T21:06:52.077

提交图片上传时似乎有问题。这要么是由表单中的 enctype 引起的，要么是由为*image/jpeg的***mime_type**创建标头的*converter.php*引起的。

 ***无论哪种方式，在尝试了多个浏览器之后，代码将永远无法工作，并且 Chrome 会将页面显示为损坏的图像。

我解析了代码，使*converter.php成为一个***没有**输出的专有处理脚本。该脚本然后重定向到一个新的 PHP 页面，我将其命名为*ServedUp.php*。使用新调整大小的图像正确显示了结果。

我不确定这个冲突是在脚本中创建的，还是在服务器端的翻译中创建的。不用说，问题现在已经解决了。

谢谢大家的想法和意见。当另一个问题出现时，我一定会很快再次使用 Stack Overflow！***

# android - 在 webview 中添加搜索和地址栏

> ID：14734099
> 
> 赞同：0
> 
> 时间：2013-02-06T16:34:11.657
> 
> 标签：android, webview

我想添加一个文本输入框，它的行为应该类似于一个`webview`元素的谷歌搜索和地址栏。如何做到这一点？

# xamarin.ios - Mono 开发的 QuartzCore.framework

> ID：14734102
> 
> 赞同：2
> 
> 时间：2013-02-06T16:34:34.287
> 
> 标签：xamarin.ios, monodevelop, quartz-core

我对 Mono Develop 原生支持的 iOS 库很满意。但是当我需要一个 3rd 方库时，我就卡住了。

QuartzCore 是一个成功的库，但是是用 Objective-C 编写的。我知道 xamarin 支持绑定类型项目。 [http://docs.xamarin.com/ios/Guides/Advanced_Topics/Binding_Objective-C_Libraries](http://docs.xamarin.com/ios/Guides/Advanced_Topics/Binding_Objective-C_Libraries)

也许对于一个有 .a 扩展名的小项目来说很容易绑定。我想知道我是否需要尝试将 QuartzCore.framework 绑定到 Mono Develop 或者是否需要花费很多精力然后通过 Objective C 在 XCode 中进行编码。

有没有人试过这个绑定？还有一些其他项目已经绑定，例如 CorePlot [https://github.com/mono/monotouch-bindings/tree/master/CorePlot](https://github.com/mono/monotouch-bindings/tree/master/CorePlot)。

我无法决定我需要做什么。这会很容易还是会给我带来很多工作？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-07T14:41:42.420

我很确定 QuartzCore 已经绑定在 MonoTouch 中。我认为 QuartzCore 是 CoreAnimation 的一部分，这可能是你没有看到它的原因。

# gwt - 滚动到 CellTable 中的选定行

> ID：14734104
> 
> 赞同：2
> 
> 时间：2013-02-06T16:34:39.113
> 
> 标签：gwt

我有一个 GWT`CellTable`包含在`ScrollPanel`. `CellTable`设置为使用>`SingleSelectionModel<T`我正在以编程方式设置选定的行，这工作正常。但是，单元格表不会滚动到所选行。有没有办法既可以选择行又可以滚动以使所选行可见？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T19:58:04.010

Andrei 在正确的轨道上，但 setScrollTop(int) 给出了要滚动的像素数，而不是要滚动到的索引。有效的是：

```
myTable.getRowElement(index).scrollIntoView(); 
```

这会调整滚动以使元素可见。请注意，如果您的表格水平滚动，scrollIntoView() 会将其一直滚动到右侧以尝试显示所有单元格。我不想要这种行为，所以我随后打电话给：

```
myScrollViewThatContainsCellTable.scrollToLeft(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:05:35.840

尝试

```
myTable.getRowElement(index).setScrollTop(0); 
```

其中 index 是选定行的索引。

# java - 如何选择 jpeg 图像 rom android 画廊？

> ID：14734105
> 
> 赞同：0
> 
> 时间：2013-02-06T16:34:48.427
> 
> 标签：java, android, image, jpeg

我需要创建一个应用程序，从我的 Android 应用程序打开 Android 图库，我应该只能查看图库中的 .jpeg 图像，其他图像（如 .png 或任何其他格式）应该被删除。

有人可以建议如何做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:43:08.403

look this example for txt you can do the same with jpg files, just list the files and select only that you want to use. [Android: File list in ListView](https://stackoverflow.com/questions/11275668/android-file-list-in-listview). NOTE: The folder for gallery is Enviroment.DIRECTORY_DCIM

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:45:08.830

这是代码：

```
Intent intent = new Intent(); 
intent.setType("image/jpeg");
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
Main.this.startActivity(intent); 
```

但不确定是否所有 android 画廊应用程序都会额外支持该类型

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:47:08.473

干得好...

```
// Directory path here
String path = "PATH/TO/GALLERY"; 
File folder = new File(path);
File[] directoryListing = folder.listFiles(); 
for (int i = 0; i < listOfFiles.length; i++) {
    if (listOfFiles[i].isFile()) {
        files = listOfFiles[i].getName();
        if (files.endsWith(".JPG") || files.endsWith(".JPEG")) {
           // Handle your file here
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T16:52:16.657

```
Intent photoPickerIntent = new Intent(Intent.ACTION_PICK);
photoPickerIntent.setType("image/jpg");
startActivityForResult(photoPickerIntent, 1);    

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent imageReturnedIntent) { 
    super.onActivityResult(requestCode, resultCode, imageReturnedIntent); 

    switch(requestCode) { 
    case 1:
        if(resultCode == RESULT_OK){  
            Uri selectedImage = imageReturnedIntent.getData();
            InputStream imageStream = getContentResolver().openInputStream(selectedImage);
            Bitmap yourSelectedImage = BitmapFactory.decodeStream(imageStream);
        }
    }
} 
```

# javascript - 遍历 jquery data() 对象并将它们推送到另一个 data() 对象（数组）

> ID：14734106
> 
> 赞同：2
> 
> 时间：2013-02-06T16:34:51.703
> 
> 标签：javascript, jquery, jquery-data

如何将对象推送到`data()`作为数组的 jquery 对象中。我想最终得到`numbers`包含对象数组的 data 属性，我通过循环访问特定类的一些 html 来获取这些对象。我不明白如何将每个对象推入数组。

我的第一个问题是，如果我在一个对象中有一些数据，我如何查看整个对象。好像以前我能做到

`$('#div1').data('values', {'one' : 'UNO', 'two' : 'DUE'});` `console.log($('#div1').data('values'))`

Chrome 会给我一些可扩展的对象来查看。现在我只是看到`[object Object]`如果我这样做我仍然可以看到它们

`console.log($('#div1').data('values').one)`.

但是，如果我不确切知道对象中的内容，这似乎有点不方便`data()`。检查我离实现这一目标有多近会很有用。

一旦我将所有数据分配给它们各自的对象，

```
$(document).ready(function(){
  $('#div1').data('values', {'one' : 'UNO', 'two' : 'DUE'});
  $('#div2').data('values', {'three' : 'TRE', 'four' : 'QUATTRO'});
  $('#div3').data('values', {'five' : 'CINQUE', 'six' : 'SEI'});
  $('#div4').data('values', {'seven' : 'SETTE', 'eight' : 'OTTO'});
}); 
```

如何遍历这些对象（所有对象都具有共享类`add`）并将它们包含的对象`data.values`放入另一个`data()`对象中？在这里，我尝试在`body`的数据对象上执行此操作`numbers`：

```
 `$('body').data('numbers', []);` 
```

以便

```
$('body').data('numbers') =

['div1': {
    'one': 'UNO',
    'two': 'DUE'
},
'div2': {
    'three': 'TRE',
    'four': 'QUATTRO'
},
'div3': {
    'five': 'CINQUE',
    'six': 'SEI'
},
'div4': {
    'seven': 'SETTE',
    'eight': 'OTTO'
}] 
```

我的尝试失败了：

```
 $('.add').each(function (index, element) {
        $('body').data(numbers, {
            element.attr('id'): element.data('values')
        //could not understand how to use push here, though it seems likely that's the answer
     }); 
```

[jsbin](http://jsbin.com/ababoy/2/edit)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T16:41:54.213

JavaScript 没有关联数组，因此您必须使用 Object。然后对属性（键）名称使用[括号表示法：](http://api.jquery.com/Types/#Array_Notation)

```
var values = {};
$('.add').each(function (index, element) {
    values[element.id] = $(element).data('values');
});
$('body').data('numbers', values); 
```

[jsBin](http://jsbin.com/ababoy/4/edit)

关于您的`[object Object]`，您可能会在将对象输出到控制台之前不小心将其与对象进行字符串连接，否则这是您的 Chrome 控制台中的错误。

使用数组，您可以[`.push`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/push)将项目推送到数组的末尾：

```
var values = [];
$('.add').each(function (index, element) {
    values.push( $(element).data('values') );
}); 
```

[垃圾桶](http://jsbin.com/ababoy/7/edit)

在初始化数组并将其存储在元素`.data()`中之后，您可以稍后通过简单地获取对 Array 对象的引用并调用`.push()`它来将项目推入其中：

```
var values = [];
$('.add').each(function (index, element) {
    values.push( $(element).data('values') );
});
$('body').data('numbers', values);

$('body').data('numbers').push({'nueve': 'nine'});
//logs "nueve" too as Array/Objects/Functions are passed by reference and the
//previous command pushed an item into the Array object referenced ("stored")
//in the $('body').data('numbers')
console.log( $('body').data('numbers') ); 
```

[垃圾桶](http://jsbin.com/ababoy/11/edit)

# php - 使用表单时在 php 代码中插入 html 错误页面

> ID：14734114
> 
> 赞同：-1
> 
> 时间：2013-02-06T16:35:08.653
> 
> 标签：php, html, forms, embed

我有一个通过电子邮件发送详细信息的表格。当用户提交信息时，我已成功插入“谢谢”页面。

但是，当用户未正确填写详细信息时出现错误时，验证会选择此错误并显示未格式化的错误页面。

请问有人可以帮我格式化这个错误页面吗？我的网站是用 html 构建的，但表单使用的是 php 脚本。

这是我的 HTML 表单代码

```
<form name="contactform" method="post" action="send_form_email.php">
<table width="450px">
<tr>
<td valign="top">
<label class="standard" for="first_name">First Name *</label>
</td>
<td valign="top">
<input  color="#000000" background="#FFFFFF" type="text" name="first_name" maxlength="50" size="30">
</td>
</tr>
<tr>
<td valign="top">
<label class="standard" for="last_name">Last Name *</label>
</td>
<td valign="top">
<input  type="text" color="#000000" background="#FFFFFF" name="last_name" maxlength="50" size="30">
</td>
</tr>
<tr>
<td valign="top">
<label class="standard" for="email">Email Address *</label>
</td>
<td valign="top">
<input  type="text" color="#000000" background="#FFFFFF" name="email" maxlength="80" size="30">
</td>
</tr>
<tr>
<td valign="top">
<label class="standard" for="telephone">Telephone Number</label>
</td>
<td valign="top">
<input  type="text" color="#000000" background="#FFFFFF" name="telephone" maxlength="30" size="30">
</td>
</tr>
<tr>
<td valign="top">
<label class="standard" for="comments">Comments *</label>
</td>
<td valign="top">
<textarea  name="comments" color="#000000" background="#FFFFFF" maxlength="1000" cols="25" rows="6"></textarea>
</td>
</tr>
<tr>
<td colspan="2" style="text-align:center">
<input type="submit" value="Submit">
</td>
</tr>
</table>
</form> 
```

这是我的PHP代码：

```
// EDIT THE 2 LINES BELOW AS REQUIRED
$email_to = "my@email.com";
$email_subject = "New email from FM Fortune";

function died($error) {
    // your error code can go here
    echo "We are very sorry, but there were error(s) found with the form you submitted. ";
    echo "These errors appear below.<br /><br />";
    echo $error."<br /><br />";
    echo "Please go back and fix these errors in order to continue.<br /><br />";
    die();
}

// validation expected data exists
if(!isset($_POST['first_name']) ||
    !isset($_POST['last_name']) ||
    !isset($_POST['email']) ||
    !isset($_POST['telephone']) ||
    !isset($_POST['comments'])) {
    died('We are sorry, but there appears to be a problem with the form you submitted.');       
}

$first_name = $_POST['first_name']; // required
$last_name = $_POST['last_name']; // required
$email_from = $_POST['email']; // required
$telephone = $_POST['telephone']; // not required
$comments = $_POST['comments']; // required

$error_message = "";
$email_exp = '/^[A-Za-z0-9._%-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/';
if(!preg_match($email_exp,$email_from)) {
$error_message .= 'The Email Address you entered does not appear to be valid.<br />';
}
$string_exp = "/^[A-Za-z .'-]+$/";
if(!preg_match($string_exp,$first_name)) {
$error_message .= 'The First Name you entered does not appear to be valid.<br />';
}
if(!preg_match($string_exp,$last_name)) {
$error_message .= 'The Last Name you entered does not appear to be valid.<br />';
}
if(strlen($comments) < 2) {
$error_message .= 'The Comments you entered do not appear to be valid.<br />';
}
if(strlen($error_message) > 0) {
died($error_message);
}
$email_message = "FM Fortune query below.\n\n";

function clean_string($string) {
  $bad = array("content-type","bcc:","to:","cc:","href");
  return str_replace($bad,"",$string);
}

$email_message .= "First Name: ".clean_string($first_name)."\n";
$email_message .= "Last Name: ".clean_string($last_name)."\n";
$email_message .= "Email: ".clean_string($email_from)."\n";
$email_message .= "Telephone: ".clean_string($telephone)."\n";
$email_message .= "Comments: ".clean_string($comments)."\n";

// create email headers
$headers = 'From: '.$email_from."\r\n".
'Reply-To: '.$email_from."\r\n" .
'X-Mailer: PHP/' . phpversion();
@mail($email_to, $email_subject, $email_message, $headers);  
?>

This is where my Thank you html code goes.

<?php
}
?> 
```

谢谢你们的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:59:50.427

尝试这个：

```
if(!isset($_POST['first_name']) ||
    !isset($_POST['last_name']) ||
    !isset($_POST['email']) ||
    !isset($_POST['telephone']) ||
    !isset($_POST['comments'])) {
    header("Location: myErrorPage.html");       
} 
```

# javascript - 通过 JavaScript 从元素中删除 -webkit-transform

> ID：14734120
> 
> 赞同：1
> 
> 时间：2013-02-06T16:35:27.663
> 
> 标签：javascript, css, transform

我正在尝试解决此错误：[http](http://code.google.com/p/chromium/issues/detail?id=20574) ://code.google.com/p/chromium/issues/detail?id=20574考虑执行转换，然后在将元素定位在其结束位置时将其删除JavaScript。

我试过了

```
document.getElementById('popover').style.setProperty("-webkit-transform", "translate3d(0,0,0)") 
```

和

```
document.getElementById('popover').style.setProperty("-webkit-transform", "none") 
```

似乎没有任何效果。

如果我删除变换并手动定位元素，则固定元素的行为确实如此。

以下是转换本身：

```
#popover.open {
    display: block;
    position: relative;
    -webkit-animation: openpopup 0.2s 1;
    -webkit-animation-fill-mode: forwards;
} 
#popover.closed {
    -webkit-animation: closepopup 0.2s 1;
    -webkit-animation-fill-mode: forwards;
} 
@-webkit-keyframes openpopup {
    from {
        -webkit-transform: translate3d(0, 100%, 0);
    }
    to {
        -webkit-transform: translate3d(0, 0%, 0);
    }
}
@-webkit-keyframes closepopup {
    from {
        -webkit-transform: translate3d(0, 0%, 0);
    }
    to {
        -webkit-transform: translate3d(0, 100%, 0);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:56:24.860

Javascript 为您尝试更改的 css 属性使用了不同的名称。它被称为`WebkitTransform`。

`document.getElementById('popover').style.setProperty("WebkitTransform", "none");`应该管用。

# android - 如何在我的 Galaxy S3 Android 设备上的 Chrome 中执行检查元素？

> ID：14734124
> 
> 赞同：33
> 
> 时间：2013-02-06T16:35:37.457
> 
> 标签：android, google-chrome, chrome-for-android

如何在我的 Galaxy S3 Android 设备上的 Chrome 中执行检查元素？

我已经在网上尝试了一些指南，其中一个说使用这个 android SDK 东西来运行 adb forward tcp:9222 localabstract:chrome_devtools_remote，但所说的只是“错误：找不到设备”。

有人对如何做到这一点有任何想法吗？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2014-04-14T18:05:53.743

您现在可以在不使用 Android SDK 的情况下执行此操作。

在最新版本的 chrome 中（我正在使用 34.0.x）：

*   导航`chrome://inspect/`
*   查看`Discover USB Devices`
*   通过 USB 插入手机。应该会出现一个弹出窗口，请求允许连接到您的计算机。接受。

`chrome://inspect/`现在，您手机的页面上会出现一个项目，您可以单击`inspect`。开发工具将产生并瞧！

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2015-03-24T08:44:14.770

使用 Chrome 在 Android 上进行远程调试：试试这个[https://developer.chrome.com/devtools/docs/remote-debugging](https://developer.chrome.com/devtools/docs/remote-debugging)

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-05-08T10:44:03.507

**更新：2015 年 8 月 20 日**

**请注意，自从2**年前提出此问题以来，说明已更改。

因此，在较新版本的 Android 和适用于 Android 的 Chrome 上。你需要使用这个。

[https://developers.google.com/web/tools/setup/remote-debugging/remote-debugging?hl=en](https://developers.google.com/web/tools/setup/remote-debugging/remote-debugging?hl=en)

**原答案：**

我有 S3，它工作正常。我发现一个常见的错误是没有在 Chrome 移动设备中启用 USB 调试。您不仅必须在开发者选项下启用设备本身的 USB 调试，还必须转到手机上的 Chrome 浏览器并在那里的设置中启用它。

用 SDK 试试这个

1.  Chrome for Mobile - 设置 > 开发者工具 > [x] 启用 USB Web 调试
2.  设备 - 设置 > 开发者选项 > [x] USB 调试
3.  将设备连接到计算机
4.  通过执行以下命令在您的计算机上启用端口转发

    C:\adb forward tcp:9222 localabstract:chrome_devtools_remote

转到`http://localhost:9222`计算机上的 Chrome

***故障排除：***

如果您`command not found`在尝试运行时遇到`ADB`问题，请确保 Platform-Tools 在您的路径中，或者只使用您的 SDK 的整个路径并运行它

```
C:\path-to-SDK\platform-tools\adb forward tcp:9222 localabstract:chrome_devtools_remote 
```

如果你得到“ `device not found`”，然后运行`adb kill-server`，然后再试一次。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2013-08-01T13:21:03.620

首先，您需要 Android SDK 才能开始： http: [//developer.android.com/sdk/index.html](http://developer.android.com/sdk/index.html)但选择现有 IDE，以便您获得工具而不是所有 Android Studio。

在 Android 设备上的 Chrome Beta 中执行以下操作：

菜单 > 设置 > 开发者工具 > 启用 USB 调试

点击设备上的主页键，然后转到设置 > 开发人员选项 > 启用 USB 调试

[注意：如果您看不到开发人员选项，请转到设置 > 关于设备 > 然后多次点击内部版本号，最终您会看到一条消息，说明您现在是开发人员或类似内容]

通过 USB 将手机连接到计算机

在您的桌面上打开 Chrome Canary（我认为目前稳定版和 Beta 版存在问题）：

在地址栏中输入：chrome://flags 并启用 - “启用开发人员工具实验”，然后点击出现的重新启动按钮。

重新启动后，打开终端并运行 adb devices，您现在应该会看到您的设备出现在列表中。如果有，在 Canary 中转到 chrome://inspect，您将看到您的设备，所以现在单击检查。

这将为您在 Android 上的 Chrome 打开开发工具。

现在点击角落里的 cog，然后转到 Experiments > Enable Port Forwarding（如果你没有看到端口转发，你可能不在 Chrome Beta 中）

启用端口转发后，关闭并打开开发工具。

返回到 cog 并选择 Port Forwarding，然后输入您要转发的端口（即，对于本地计算机上的 locahost:9000，我将输入 9000 [Device port] 和 127.0.0.1:9000 [Target]

有一个错误打开，其中第一个端口被忽略，因此可能值得在第一行按 enter 并在第二行重新输入相同的详细信息。

您现在可以将 localhost:9000（或您的端口号）放入 Chrome for Android 并查看该站点并使用 DevTools 来检查页面。

本网站的反向端口转发部分下的更多详细信息：[https ://developers.google.com/chrome-developer-tools/docs/remote-debugging](https://developers.google.com/chrome-developer-tools/docs/remote-debugging)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-01-31T14:04:47.743

主要按照这里的指南[https://developers.google.com/chrome-developer-tools/docs/remote-debugging](https://developers.google.com/chrome-developer-tools/docs/remote-debugging)。但 ...

*   对于三星设备，不要忘记安装三星凯斯。
*   对我来说，它只适用于**Chrome Canary**，不适用于 Chrome。
*   您可能还需要安装 Android SDK。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-09-04T16:20:00.037

我有一个 S3 并使用了 Google 的本指南：

[https://developers.google.com/chrome-developer-tools/docs/remote-debugging](https://developers.google.com/chrome-developer-tools/docs/remote-debugging)

真的很简单，完美运行。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-06T16:38:26.670

我无法做到这一点，而是使用 Play Store 上可用的 view html 源应用程序来简单地查找元素。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-17T15:33:42.953

请记住，如果您想在 Windows 中使用 chrome inspect，除了在您的移动设备上启用 USB 调试外，您还应该安装适用于 Windows 的 USB 驱动程序。

您可以从此处的列表中找到所需的驱动程序：

[http://androidxda.com/download-samsung-usb-drivers](http://androidxda.com/download-samsung-usb-drivers)

此外，您应该使用比桌面版本更新的 Chrome 移动版。

# matlab - 在 Matlab 对象数组中设置属性

> ID：14734125
> 
> 赞同：1
> 
> 时间：2013-02-06T16:35:39.003
> 
> 标签：matlab

我正在使用 Matlab 中的结构和对象数组。我想尽快为某个数组的所有成员设置属性。

对于设置某个结构字段的问题，我找到了一个解决方案，涉及使用`arrayfun`and `setfield`。以下工作就像一个魅力：

```
myStru.id = 0;
myStru.name = 'blah';
arrayStru = repmat(myStru,10,1);  % Array of 10 elements. All of them have id=0
arrayStru = cell2mat( arrayfun( @(x,y)setfield(x,'id',y), arrayStru, (1:10)', 'UniformOutput', false ) ); % ids ranging from 1 to 10 :D 
```

问题是，对于对象，这不起作用。我知道这`setfield`是针对结构的，所以我尝试了其他一些替代方案。当我尝试以下操作时，会弹出最令人痛苦的错误：

```
arrayfun( @(x,y) eval(['x.id=y;']), arrayOfObjects, arrayOfValues, 'UniformOutput', false ); 
```

（该类是一个非常简单的类，它接受空构造函数并具有一个名为“id”的真正公共属性）。结果是：

```
Error using setFieldOfStructArray>@(x,y)eval(['x.id=y;']) (line 17)
Error: The expression to the left of the equals sign is not a valid target for an
assignment. 
```

**尽管**我在该行中放置了一个断点，但似乎可以以预期的效果执行该表达式。

我的两（三）个问题：

*   为什么上述解决方案会失败？我怎样才能让它工作？
*   我的最终目标是在对象数组中**快速简单地设置属性。**哪个是最好的技术？

（注意：我可以写循环，但是当我不得不这样做时我总是觉得很痒：P）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:53:21.767

我认为问题可能是您的属性可能是只读的，因为 setfield 也适用于类。

无论如何，有一些选择，如果你的类继承自 hgsetget，你可以使用 set 而不是 setfield。

你也可以使用

```
subsasgn(x,struct('type','.','subs','id'),y) 
```

代替

```
setfield(x,'id',y) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T20:41:24.270

如果可以使用值的单元格，它将被自动解释为结构数组

```
>> s = struct('a', num2cell(1:10)', 'b', 's')

s = 

10x1 struct array with fields:
    a
    b

>> [s.a]

ans =

     1     2     3     4     5     6     7     8     9    10

>> [s.b]

ans =

ssssssssss 
```

# oracle - 从 shell 脚本运行 sqlplus 时管理错误处理

> ID：14734131
> 
> 赞同：16
> 
> 时间：2013-02-06T16:35:49.400
> 
> 标签：oracle, shell, sqlplus, aix

```
#!/bin/sh

echo "Please enter evaluate database username"
read eval_user
echo "Please enter evaluate database password"
read eval_pass
echo "Please enter the database name"
read db_name

LOGFILE=shell_log.txt

$ORACLE_HOME/bin/sqlplus -s /nolog <<-EOF>> ${LOGFILE}
connect $eval_user/$eval_pass@$db_name
WHENEVER OSERROR EXIT 9;
WHENEVER SQLERROR EXIT SQL.SQLCODE;
DBMS_OUTPUT.put_line('Connected to db');
EOF

if [ $? != 0 ]
then 
echo "The upgrade script failed. Please refer to the log results.txt for more information"
echo "Error code $?"
exit 0;
fi 
```

我正在输入垃圾值，试图强制此脚本失败。但是，令人讨厌的是，它一直在继续前进，而没有提及任何错误代码。这里还需要做什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-12T09:26:21.753

麦克斯说的是对的。试试这个修改后的脚本

```
#!/bin/sh

echo "Please enter evaluate database username"
read eval_user
echo "Please enter evaluate database password"
read eval_pass
echo "Please enter the database name"
read db_name

LOGFILE=shell_log.txt

sqlplus -s /nolog <<-EOF>> ${LOGFILE}
WHENEVER OSERROR EXIT 9;
WHENEVER SQLERROR EXIT SQL.SQLCODE;
connect $eval_user/$eval_pass@$db_name
DBMS_OUTPUT.put_line('Connected to db');
EOF

sql_return_code=$?

if [ $sql_return_code != 0 ]
then
echo "The upgrade script failed. Please refer to the log results.txt for more information"
echo "Error code $sql_return_code"
exit 0;
fi 
```

请注意使用 sql_return_code 来捕获 SQLPLUS 返回码。

DBMS_OUTPUT 语句应该失败并出现错误 - “SP2-0734：未知命令开始......”。您可以在日志文件中找到错误消息。

在 SQLPLUS 11g 中可以使用错误记录工具来捕获 sp2 错误。请查看[http://tkyte.blogspot.co.uk/2010/04/new-thing-about-sqlplus.html](http://tkyte.blogspot.co.uk/2010/04/new-thing-about-sqlplus.html)了解更多信息。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-10T05:02:20.077

建立与数据库的连接后，您的语句可能会`whenever`被执行（因为您后来提到过它们）。试试下面的代码： -

```
$ORACLE_HOME/bin/sqlplus -s /nolog <<-EOF>> ${LOGFILE}
WHENEVER OSERROR EXIT 9;
WHENEVER SQLERROR EXIT SQL.SQLCODE;
connect $eval_user/$eval_pass@$db_name
DBMS_OUTPUT.put_line('Connected to db');
EOF 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-08-08T00:02:05.137

阿吉的回答是

```
WHENEVER SQLERROR EXIT SQL.SQLCODE; 
```

然后使用

```
sql_return_code=$? 
```

不正确（或在大多数情况下不正确）。请参阅下面的详细信息。

* * *

UNIX 操作系统中的 Shell 脚本最多可以返回 255 个代码。例如，“ORA-12703 不支持此字符集转换”返回代码应该是 12703，但它不适合 UNIX 8 位返回代码。
实际上，我只是做了一个测试并运行了一个错误的 SQL，该 SQL 因“ORA-00936：缺少表达式”而失败 -
sqlplus 返回 168（！）。
所以实际的返回码 936 被包装在 256 处，剩下的就被返回了。936%256=168。

在 Windows 上，这可能可以工作（未经测试），但在 UNIX 上则不行（如上所述进行了测试）。

唯一可靠的机制可能是将结果假脱机到日志文件中，然后执行类似的操作

```
tail -n 25 spool.log | egrep "ORA-" | tail -n 1 | cut -d: -f1 | cut -d- -f2 
```

所以它会 grep 假脱机日志文件，然后剪切实际最新的 ORA 代码。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-11T13:40:55.047

您输入假值的事实可能仅与登录有关。然后： [使用 Shell 脚本检查数据库连接](https://stackoverflow.com/questions/3779569/check-database-connectivity-using-shell-script)

`WHENEVER ...`用于 SQL 脚本执行期间的错误。一旦你成功连接到你的脚本（我现在假设这是你的问题），你应该得到管理的那种错误，`WHENEVER ERROR`因为你忘记`EXEC`了`DBMS_OUTPUT`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-08T20:48:54.257

您只能捕获 sql 错误或 os 错误。dbms_output 将在 sqlplus 级别本身失败，因此无论何时错误设置都不会影响它。

# regex - 如何使用正则表达式匹配具有唯一 ID 的 JSON 对象

> ID：14734135
> 
> 赞同：2
> 
> 时间：2013-02-06T16:35:56.720
> 
> 标签：regex, json, match

我有以下 JSON 对象：

```
{ 
  "fieldId": "id1", 
  "isVisibleInDetails": true, 
  "isVisibleInGrid": true, 
  "columnWidth": 142, 
}, 
{ 
  "fieldId": "id2", 
  "isVisibleInDetails": true, 
  "isVisibleInGrid": true, 
  "columnWidth": 100, 
}, 
{ 
  "fieldId": "id3", 
  "isVisibleInDetails": true, 
  "isVisibleInGrid": true, 
  "columnWidth": 159, 
} 
```

我想匹配以下内容：

```
{ 
  "fieldId": "id2", 
  "isVisibleInDetails": true, 
  "isVisibleInGrid": true, 
  "columnWidth": 100, 
}, 
```

我尝试使用正则表达式`(\{.*)id2(.*?)\},`，但匹配返回为：

```
{ 
  "fieldId": "id1", 
  "isVisibleInDetails": true, 
  "isVisibleInGrid": true, 
  "columnWidth": 142, 
}, 
{ 
  "fieldId": "id2", 
  "isVisibleInDetails": true, 
  "isVisibleInGrid": true, 
  "columnWidth": 100, 
}, 
```

谁能纠正我的正则表达式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T16:40:35.373

使用这个正则表达式`\{[^{]*id2[^}]*?\}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:41:01.113

我认为知道你想要做什么是一个非常重要的问题，但至少你可以使用这个正则表达式来得到你正在寻找的东西：

```
\{[^}]+?id2.*?\} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:41:03.713

你很接近..

```
\{[^{}]*id2[^{}]*\} 
```

使用`[^{}]*`而不是`.*?`

**或者**

```
 \{(?=[^{}]*id2).*?\} 
```

* * *

在您的正则表达式`.`中也会匹配`{`，`}`因此它会捕获其他人..使用`[^{}]`以避免匹配`{`，`}`

# google-maps - 谷歌地图自定义标记图标未出现

> ID：14734138
> 
> 赞同：0
> 
> 时间：2013-02-06T16:36:03.730
> 
> 标签：google-maps, google-maps-markers

我在使用自定义标记图标的谷歌地图上创建了自己的地图。当我使用我的 Google 帐户（[屏幕截图](http://i.stack.imgur.com/457fM.jpg)）登录时，这些图标看起来很好。[但是，当我将地图分享](https://maps.google.de/maps/ms?msid=207304257835995764264.0004d50bd479c35bfc590&msa=0&ll=49.008995,8.401022&spn=0.045547,0.077162&iwloc=0004d50bda79516f0fd31)给公众时，它们不会出现。

谁能解释一下为什么会这样？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:14:35.943

这些图标不公开。让它们公开可用或链接到那些公开可用的。从您的 KML：

[风格3](https://photos-1.dropbox.com/t/0/AAB5jRBjSQzFRwC_3prIMxcIAjUi0gYtLn-0yv5-Z0t50Q/10/8902804/png/32x32/6/_/1/2/Givebox.png/mHDsU8NZ4bX5F7DdqF-n6LRhWOZEf5c_L4z9SjgpnpU?size=32bf&prep_size=1024x768)

[风格4](https://photos-2.dropbox.com/t/0/AAD6t9o6b1MN8DD6lFbHPBhi4_9_KcLOi6MoWC66RsVvgA/10/8902804/png/32x32/6/_/1/2/Buecherschrank.png/PjQg39_walneLADs9FjOPe2ZR5AbiOCftvRpMF--uKU?size=32bf&prep_size=800x600)

[风格7](https://photos-5.dropbox.com/t/0/AAAj0BHi89UqEbl82Xekwv_MSGSyK8snTmeq7fWiMIsJlg/10/8902804/png/1024x768/2/1360155600/0/2/Alnatura.png/P3AKHe_CI1dGYRcGGXlOaq7LYfdqQRAMDTBDV5l2FQ0)

[风格2](https://photos-2.dropbox.com/t/0/AAD6t9o6b1MN8DD6lFbHPBhi4_9_KcLOi6MoWC66RsVvgA/10/8902804/png/32x32/6/_/1/2/Buecherschrank.png/PjQg39_walneLADs9FjOPe2ZR5AbiOCftvRpMF--uKU?size=32bf&prep_size=1024x768)

[风格1](https://photos-5.dropbox.com/t/0/AACa9wJPOnX92RX9ST6xUzIwLWObwjc6NPO3ZfMfI3inwQ/10/8902804/png/32x32/6/_/1/2/Alnatura.png/wdnr5qVd6wOSkvHXVaLrwKo06hHXGMXlgmFftuXiVMc?size=1024x768&size_mode=2)

[风格8](https://photos-1.dropbox.com/t/0/AAB5jRBjSQzFRwC_3prIMxcIAjUi0gYtLn-0yv5-Z0t50Q/10/8902804/png/32x32/6/_/1/2/Givebox.png/mHDsU8NZ4bX5F7DdqF-n6LRhWOZEf5c_L4z9SjgpnpU?size=32bf&prep_size=1024x768)

[风格5](https://photos-4.dropbox.com/t/0/AAAVwyBw8iR3pXIqh68ZrU8geV0GpCDKLe1a92SK4n912g/10/8902804/png/32x32/6/_/1/2/Fuellhorn.png/hNUYFJzUUn4XplF6IaGdlQ_OxOLEQAfgK-2OvL_etWk?size=32bf&prep_size=1024x768)

[风格6](https://photos-3.dropbox.com/t/0/AACQ6mOgHhqeOl1y70CTb3reXMu0isr5ULMJbFGhsWqxBw/10/8902804/png/32x32/6/_/1/2/Weltladen.png/A8U6UX7yHxohcoh_Xncs9fx5GaJnaefo6-PRLWHcqLU?size=32bf&prep_size=1024x768)

# ruby-on-rails - 列的默认值

> ID：14734143
> 
> 赞同：2
> 
> 时间：2013-02-06T16:36:21.243
> 
> 标签：ruby-on-rails, migration, default-value

我跑：

**rails 生成迁移 AddHidemsgColumnToPublishers hide_msg:boolean**

并创建了下一个文件：

```
class AddHidemsgColumnToPublishers < ActiveRecord::Migration
  def change
    add_column :publishers, :hide_msg, :boolean
  end
end 
```

我想将默认值设置为`hide_msg`false。

所以我尝试了：

**rails 生成迁移 add_default_value_to_hide_msg**

```
class AddDefaultValueToHideMsg < ActiveRecord::Migration
  def up
    change_column :publishers, :hide_msg, :boolean, :default => false
  end

  def down
    change_column :publishers, :hide_msg, :boolean, :default => nil
  end
end 
```

但我得到了错误：

```
rake db:migrate
==  AddHidemsgColumnToPublishers: migrating ===================================
-- add_column(:publishers, :hide_msg, :boolean, {:default=>false})
rake aborted!
An error has occurred, this and all later migrations canceled:

PG::Error: ERROR:  column "hide_msg" of relation "publishers" already exists
: ALTER TABLE "publishers" ADD COLUMN "hide_msg" boolean DEFAULT 'f' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T17:02:13.747

只是一个建议......不要在数据库中设置默认值，因为如果您想稍后更改它可能会遇到一些问题。

我认为如果你在你的模型中设置它会更好。

```
before_save :set_default_high_msg
def set_default_high_msg
  self.high_msg ||= false
end 
```

甚至在您的控制器中：

```
 def new
   @publisher = Publisher.new
   @publisher.high_msg ||= false
 ...
 end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:39:19.317

```
rake db:migrate
==  AddHidemsgColumnToPublishers: migrating ===================================
-- add_column(:publishers, :hide_msg, :boolean, {:default=>false}) 
```

上面的东西意味着它试图创建已经存在的colimn。如果你检查类名`AddHidemsgColumnToPublishers`。这意味着它会尝试执行您没有`default`价值的第一次迁移。这清楚地表明你做错了什么。

`publishers`已经有列`hide_msg`。所以检查控制台`table description`。`db`如果您没有任何值，`hide_msg`那么您可以手动`drop`列并重新运行`rake db:migrate`. 或者，您可以保持该列不变，然后创建迁移以添加`default value`.

```
change_column_default :publishers, :hide_msg, false 
```

文档：[http ://apidock.com/rails/ActiveRecord/ConnectionAdapters/SchemaStatements/change_column_default](http://apidock.com/rails/ActiveRecord/ConnectionAdapters/SchemaStatements/change_column_default)

# view - 如何在drupal 7的视图中将暴露的过滤器放在单独的块中

> ID：14734145
> 
> 赞同：3
> 
> 时间：2013-02-06T16:36:23.380
> 
> 标签：view, drupal-7

使用 drupal 6，我可以轻松地选择将暴露的过滤器放在一个单独的块中，然后我可以将它放在侧边栏上。我不知道如何在drupal 7中做到这一点。有人知道吗？谢谢，戴安娜

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T21:19:13.660

1.  创建页面视图

2.  调整设置

    > [![截屏](../Images/8f11640d5a3040daab330722d15786b8.png)](https://i.stack.imgur.com/flJ8H.png)

3.  确保展开高级选项卡

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-09T23:15:24.597

对于 D7 块，将“使用 AJAX”设置为“是”对我有用。

此外，同一页面上的两个块过滤相同的字段（但不同的数据/视图），似乎从一个块应用过滤器会影响两个块。不知道如何解决这个问题。

说明：在高级 -> 其他中，将“使用 AJAX”设置为是

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-02-07T19:53:22.013

对于 D7 使用模块 - Views Block Exposed Filter Blocks [https://www.drupal.org/project/views_block_filter_block](https://www.drupal.org/project/views_block_filter_block)

启用此模块后，您将在 Exposed Form fieldset 中看到新设置，请参见屏幕截图 -[示例](http://i.stack.imgur.com/sPFtg.png)

此解决方案也适用于面板。

# java - Java BO 中的 ConcurrentModificationException

> ID：14734147
> 
> 赞同：0
> 
> 时间：2013-02-06T16:36:26.967
> 
> 标签：java, exception

我在这段代码中得到一个 java.util.ConcurrentModificationException 并且似乎无法理解为什么或修复它。

在 BO 我有这个（权限是 BO 内的数组列表）

```
public void setPrivilegename(String privilegename) {
    this.privileges.add(privilegename); 
}

List<PrivilegeObjectBO> arraylist = new ArrayList<PrivilegeObjectBO>();if (rs != null)              {
    while (rs.next()) {        
        for (BO bo : arraylist) {
            if (bo.getRolepkey()==rs.getInt("ROLE_PKEY")) {                         
                bo.setPrivilegename(rs.getString("SP.NAME"));

            }else{
                BO newobj = new BO();
                newobj.setRolepriviledgepkey(rs.getInt("PRIVILEGE_PKEY"));
                newobj.setProticolpkey(protocol);                
                newobj.setPrivilegename(rs.getString("SP.NAME"));
                newobj.setRolepkey(rs.getInt("SRP.ROLE_PKEY"));
                arraylist.add(newobj);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T16:38:16.127

根据[ArrayList javadoc](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)

> 此类的 iterator 和 listIterator 方法返回的迭代器是快速失败的：如果在创建迭代器后的任何时间对列表进行结构修改，除了通过迭代器自己的 remove 或 add 方法之外的任何方式，迭代器将抛出 ConcurrentModificationException。

```
for (BO bo : arraylist) 
```

上面的 for-each 循环获取列表的迭代器和

```
 arraylist.add(newobj); 
```

您试图在不使用迭代器自己的方法的情况下修改列表，这会导致`ConcurrentModificationException`

这是[关于可能解决方案的讨论](https://stackoverflow.com/questions/11624220/java-adding-elements-to-list-while-iterating-over-it)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:40:14.393

在 java 中，当您在迭代集合时修改集合时，您总是会收到 ConcurrentModificationException。

可能的解决方案：对添加或删除的项目使用临时集合，并在迭代完成后添加或删除这些项目。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T16:38:11.493

您不能`ArrayList`使用 foreach 同时对其进行迭代和添加元素。

使用迭代器，如下所示：

```
Iterator<PrivilegeObjectBO> iterator = arraylist.iterator();
while (iterator.hasNext()) {
  ...
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T16:44:10.227

Maybe you can take a look at `Collections.synchronizedList(List<?>)` static method. It should return a thread safe `List` from the List object given, and you should not get the exception anymore.

Otherwise, you could try (if applicable) to set the method that accesses to the list synchronized, by adding the keyword `synchronized` in the method declaration.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T16:57:59.717

其他人已经指出，`add`-ing to a `ArrayList`while 迭代它是不允许的。

但是无论如何要解决您的问题，您*似乎*需要在尝试访问整个列表之前对其进行迭代`add`，因为您的循环似乎正在检查列表中的任何内容是否与您的行匹配以避免重复。在这种情况下，您*不想*在迭代列表时添加到列表中，因为直到最后您才知道列表是否有重复项。

所以只需遍历并检查是否找到匹配项：

```
List<PrivilegeObjectBO> arraylist = new ArrayList<PrivilegeObjectBO>();
if (rs != null) {
    while (rs.next()) {

        boolean found = false;
        for (BO bo : arraylist) {
             if (bo.getRolepkey() == rs.getInt("ROLE_PKEY")) {      
                 bo.setPrivilegename(rs.getString("SP.NAME"));
                 found = true;
             }
        }

        if (!found) {
            BO newobj = new BO();
            newobj.setRolepriviledgepkey(rs.getInt("PRIVILEGE_PKEY"));
            newobj.setProticolpkey(protocol);                
            newobj.setPrivilegename(rs.getString("SP.NAME"));
            newobj.setRolepkey(rs.getInt("SRP.ROLE_PKEY"));
            arraylist.add(newobj);
        }
    }
} 
```

除非你真的想为列表中已经存在的`BO`每个不匹配添加一个新`BO`的......

# android - 基于绘制的位图调整大小的 Android 画布问题

> ID：14734152
> 
> 赞同：0
> 
> 时间：2013-02-06T16:36:40.463
> 
> 标签：android, android-canvas

我有一个自定义视图，允许我在创建它时在其上绘制位图，然后用户可以用手指在其上绘制。

我的问题是画布填充了我的布局中可用区域的整个宽度/高度，但我希望它简单地匹配绘制的位图的大小，以便用户只能在图片上绘制。这似乎需要在 onSizeChanged 中完成，因为如果它们从纵向变为横向，我需要调整位图的大小。等等

我的代码：

```
class DrawingCameraPanel extends View implements OnTouchListener {

    public Canvas mCanvas;
    private Path mPath;
    private Paint mPaint;
    private ArrayList<Path> paths = new ArrayList<Path>();
    private Bitmap background;
    int width;
    int height;

    public Bitmap getOutputBitmap() {
        Bitmap.Config config = Bitmap.Config.RGB_565;
        Bitmap bitmap = Bitmap.createBitmap(width, height, config);
        Canvas canvas = new Canvas(bitmap);
        onDraw(canvas);
        return bitmap;
    }

    public DrawingCameraPanel(Context context) {
        super(context);
        setFocusable(true);
        setFocusableInTouchMode(true);
        this.setOnTouchListener(this);
        mPaint = new Paint();
        mPaint.setAntiAlias(true);
        mPaint.setDither(true);
        mPaint.setColor(Color.RED);
        mPaint.setStyle(Paint.Style.STROKE);
        mPaint.setStrokeJoin(Paint.Join.ROUND);
        mPaint.setStrokeCap(Paint.Cap.ROUND);
        mPaint.setStrokeWidth(6);
    }

    public DrawingCameraPanel(Context context, AttributeSet attrs) {
        super(context, attrs);
        setFocusable(true);
        setFocusableInTouchMode(true);
        this.setOnTouchListener(this);
        mPaint = new Paint();
        mPaint.setAntiAlias(true);
        mPaint.setDither(true);
        mPaint.setColor(Color.RED);
        mPaint.setStyle(Paint.Style.STROKE);
        mPaint.setStrokeJoin(Paint.Join.ROUND);
        mPaint.setStrokeCap(Paint.Cap.ROUND);
        mPaint.setStrokeWidth(6);
    }

    public DrawingCameraPanel(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
        setFocusable(true);
        setFocusableInTouchMode(true);
        this.setOnTouchListener(this);
        mPaint = new Paint();
        mPaint.setAntiAlias(true);
        mPaint.setDither(true);
        mPaint.setColor(Color.RED);
        mPaint.setStyle(Paint.Style.STROKE);
        mPaint.setStrokeJoin(Paint.Join.ROUND);
        mPaint.setStrokeCap(Paint.Cap.ROUND);
        mPaint.setStrokeWidth(6);
    }

    public void setPaintColor(int color) {
        mPaint.setColor(color);
    }

    public void setBackgroundPic(Bitmap bitmap) {
        this.background = bitmap;
        mCanvas = new Canvas();
        mPath = new Path();
        paths.add(mPath);
        mCanvas.save();
    }
    @Override
    protected void onSizeChanged(int w, int h, int oldw, int oldh) {
        super.onSizeChanged(w, h, oldw, oldh);
        width = w;
        height = h;
        background = resizeImage(background, w, h);
    }

    @Override
    protected void onDraw(Canvas canvas) {
        if (background != null) {
            canvas.drawBitmap(background, 0, 0, null);
        }
        for (Path p : paths) {
            canvas.drawPath(p, mPaint);
        }
    }

    public Bitmap resizeImage(Bitmap image, int maxWidth, int maxHeight) {
        Bitmap resizedImage = null;
        try {
            int imageHeight = image.getHeight();

            if (imageHeight > maxHeight)
                imageHeight = maxHeight;
            int imageWidth = (imageHeight * image.getWidth())
                    / image.getHeight();

            if (imageWidth > maxWidth) {
                imageWidth = maxWidth;
                imageHeight = (imageWidth * image.getHeight())
                        / image.getWidth();
            }

            if (imageHeight > maxHeight)
                imageHeight = maxHeight;
            if (imageWidth > maxWidth)
                imageWidth = maxWidth;

            resizedImage = Bitmap.createScaledBitmap(image, imageWidth,
                    imageHeight, true);
        } catch (OutOfMemoryError e) {

            e.printStackTrace();
        } catch (NullPointerException e) {
            e.printStackTrace();
        } catch (Exception e) {
            e.printStackTrace();
        }
        return resizedImage;
    }

    public void clear() {
        this.paths.clear();
        mPath = new Path();
        paths.add(mPath);
    }

    private float mX, mY;
    private static final float TOUCH_TOLERANCE = 4;

    private void touch_start(float x, float y) {
        mPath.reset();
        mPath.moveTo(x, y);
        mX = x;
        mY = y;
    }

    private void touch_move(float x, float y) {
        float dx = Math.abs(x - mX);
        float dy = Math.abs(y - mY);
        if (dx >= TOUCH_TOLERANCE || dy >= TOUCH_TOLERANCE) {
            mPath.quadTo(mX, mY, (x + mX) / 2, (y + mY) / 2);
            mX = x;
            mY = y;
        }
    }

    private void touch_up() {
        mPath.lineTo(mX, mY);
        // commit the path to our offscreen
        mCanvas.drawPath(mPath, mPaint);
        // kill this so we don't double draw
        mPath = new Path();
        paths.add(mPath);
    }

    @Override
    public boolean onTouch(View arg0, MotionEvent event) {
        float x = event.getX();
        float y = event.getY();

        switch (event.getAction()) {
        case MotionEvent.ACTION_DOWN:
            touch_start(x, y);
            invalidate();
            break;
        case MotionEvent.ACTION_MOVE:
            touch_move(x, y);
            invalidate();
            break;
        case MotionEvent.ACTION_UP:
            touch_up();
            invalidate();
            break;
        }
        return true;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:19:24.223

当然，`Canvas`如果布局的宽度和高度（很可能）设置为`match_parent`or ，为什么不占用布局中的所有空间`fill_parent`？（好吧，从技术上讲：`View`- 调整边界的是视图，而画布只是“跟随”它们）。

我认为你在这里重新发明轮子。我建议不要自己编写所有代码，而是：

*   子类`ImageView`而不是`View`.
*   调用`setAdjustViewBounds(true)`构造函数。这是重要的部分。这实际上将更改视图的边界以匹配包含的图像 - 它保留纵横比并确保图像适合布局提供的空间。
*   由于用户绘制的*背景*是透视*图像源*，因此`setBackgroundPic()`只需调用即可。`ImageView.setImageBitmap()`**`ImageView`**
***   保留所有绘图代码 - 即`OnTouchListener`实现。**

 **这里很酷的是您的自定义视图现在会自动调整大小。因此，您不必担心允许用户绘制的范围，因为它们会为您设置。**

# c++ - 命名空间“boost”中的“mutex”未命名类型

> ID：14734153
> 
> 赞同：2
> 
> 时间：2013-02-06T16:36:40.670
> 
> 标签：c++

当我尝试编译以下代码时出现此错误：

```
#include <boost/signals2/mutex.hpp>

class Log
{
    private:
        boost::mutex m_log;
...
} 
```

我尝试编译时得到的错误是：

```
error: ‘mutex’ in namespace ‘boost’ does not name a type 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T16:39:04.197

它在子命名空间中

```
boost::signals2::mutex 
```

# tridion - 内容交付 - 取消发布错误

> ID：14734168
> 
> 赞同：5
> 
> 时间：2013-02-06T16:37:35.843
> 
> 标签：tridion, tridion-2011, tridion-content-delivery

我们在 SDL Tridion 2011 Sp1 Hr 1 Content Delivery 中发现了一个非常奇怪的问题，即当我们取消发布内容时，发布将失败。

失败真的很奇怪。我们创建了两个结构组：

*   100个例子
*   400 其他

每个都包含相同的页面类型。页面包含标准元数据（文本字段等）

*   如果我在 SG 上取消发布 100 示例，所有文件都将被删除
*   如果我在 SG 上取消发布 400 Other ，则发布任务将失败（下面的 CD 日志片段）
*   如果我进入 400 Other SG 并选择所有要取消发布的文件，这很好
*   SG 项目在“目录”名称中不包含 SG 或奇怪的字符。

[我看到此 SDL Tridion 论坛帖子 ( https://forum.sdltridion.com/topic.asp?TOPIC_ID=7554](https://forum.sdltridion.com/topic.asp?TOPIC_ID=7554) )中引用了一个修补程序 - 'CD_2011.1.0.79212 - 累积修补程序' - 但版本号让我印象深刻的是 SDL Tridion 2011 Sp 1。

我已经安装了修补程序 CD_2011.1.1.83475（累积修补程序），但这并不能解决问题。

我还没有通过 SDL 支持提出此问题，因为我想首先将此信息发布给社区。

我的错误信息是：

> 无法在当前事务中存储项目，无法删除数据实体，未知实体：com.tridion.storage.ItemMeta_$$_javassist_26，未知实体：com.tridion.storage.ItemMeta_$$_javassist_26，无法删除数据实体，未知实体：com.tridion.storage.ItemMeta_$$_javassist_26，未知实体：com.tridion.storage.ItemMeta_$$_javassist_26 用于交易：tcm:0-24997-66560 2013-02-05 15:10:18,660 错误 DeployPipelineExecutor - 最后一次尝试处于阶段：事务的部署准备提交阶段失败：tcm:0-24997-66560 2013-02-05 15:10:18,661 错误

# php - 为什么我的服务器不接受大于 2MB 的文件？

> ID：14734184
> 
> 赞同：0
> 
> 时间：2013-02-06T16:38:22.193
> 
> 标签：php, file-upload, asihttprequest, vps

我有一个运行 XAMPP 并为我制作的 iPhone 应用程序提供服务的 VPS。

我使用**ASIHTTPRequest**将文件上传到服务器。

App向服务器发送文件，服务器只接受小于2MB的文件。

我还检查了 Wireshark 并发现了这个警告：

**PHP 致命错误：第 2 行的 c:/xxx/index.php 中超过了 60 秒的最大执行时间**

在第 2 行我写道：**session_start();**

在我的理论中，它们是阻止大文件进入我的服务器的两件事：

1.  某种文件大小限制
2.  每个动作的某种时间限制

我真的需要这方面的帮助。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:43:35.163

检查`php.ini`文件中的设置，当运行 XAMPP 时，可以在`*root*/php/`目录中找到这些设置。

```
#Make sure file uploads are turned on
file_uploads = On

#Change the max upload size to 100Mb
upload_max_filesize = 100M

#Change the max post size to 100Mb
post_max_size = 100M

#Change the max upload time to 900seconds
max_input_time = 900

#This is where you are seeing your problem as the script execution is timing out.
#Change the max execution time of the script to 900 seconds
max_execution_time = 900 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T16:44:38.843

检查文件中的以下几行`php.ini`：

```
upload_max_filesize = 2M
max_execution_time = 300 
```

之后您可能需要重新启动服务器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:45:48.167

错误说：`Maximum execution time of 60 seconds exceeded`

这让我觉得您的互联网连接速度很慢，因此上传时间超过`max_execution_time`

要查看`max_execution_time`当前是什么：

`$maxtime = ini_get(max_execution_time);`

`echo $maxtime;`

要使`max_execution_time`当前页面更大，请在 PHP 文件顶部输入以下行： `ini_set("max_execution_time", 600);?>`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T16:47:04.427

放在 index.php 的顶部：

```
<?php
ini_set('max_execution_time', 180); //Put the number of seconds that you want 
```

`upload_max_filesize`不能在运行时更改，因此您需要在您的`php.ini`

# mysql - 最好将文档/图像存储在 S3 服务器或主服务器数据库上？

> ID：14734192
> 
> 赞同：2
> 
> 时间：2013-02-06T16:38:41.250
> 
> 标签：mysql, upload, amazon-s3

我管理一个支持团队，该团队从各种工作场所（建筑、房地产、保险等）收集许可证信息。为了确保员工获得适当的许可并在他们的许可到期时通知他们，我们选择将“生效日期”范围存储在 MySQL 表中。格式如下所示：

```
ID  | personID | startDate  | endDate
========================================
1   |  111     | 2013-01-01 | 2014-01-01
2   |  222     | 2012-11-05 | 2012-12-31 
```

这部分很简单，但我们也在考虑将我们从个人收到的许可证副本存储在云中（可能是 Amazon S3）或通过 base_64 编码直接存储到 mysql 表中，而不是保存在内部 pc 上。许可证可以以扫描图像（jpg、png）或文档形式（可能仅限 PDF）的形式出现。

一种方法一定比另一种更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:07:02.273

一些 S3 专业人士：

*   MySQL 备份大小仍可管理
*   可以独立于文件存储进行数据库或托管调整
*   如果操作正确，文件可能会直接上传到 S3 存储桶，从而减少服务器上的负载

S3 的一些缺点：

*   如果这些是可搜索的 PDF，您会想要全文搜索吗？
*   必须显式删除 S3 文件（相对于简单的行删除）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T11:40:15.007

我同意 roryWoods 的观点，我想在一个地方管理所有数据，所以我尝试了编码和备份，并且成本大大降低，我发现[这个工具](http://www.backand.com)可以连接到我的数据库并提供对 S3 的访问权限。

# python - 请解释一下这个循环： for i in l: l.remove(i)

> ID：14734193
> 
> 赞同：0
> 
> 时间：2013-02-06T16:38:45.913
> 
> 标签：python

**例子：**

```
l = [1,2,3,4,5,6,7,8,9,0]

for i in l:
    print i,l
    l.remove(i) 
```

**回报：**

```
1 [1, 2, 3, 4, 5, 6, 7, 8, 9, 0]
3 [2, 3, 4, 5, 6, 7, 8, 9, 0]
5 [2, 4, 5, 6, 7, 8, 9, 0]
7 [2, 4, 6, 7, 8, 9, 0]
9 [2, 4, 6, 8, 9, 0] 
```

那么为什么只有 5 次旋转呢？我预计它会转 10 次。有人可以逐步向我解释吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T16:41:07.533

注意打印的数字是如何跳过列表中的一个数字的？那是因为， i 指向列表中的一个位置，一旦你删除`i`列表“移动”一个位置到左边，而不是`i`增加时，它实际上向右移动两个位置。因此，在第五次迭代之后，您将处于列表右侧`0`或列表之外的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:52:50.770

此问题与所使用的编程语言（在本例中为 Python）无关，并且当您在迭代集合时从集合中删除项目时会发生此问题。在这个例子中，每次循环迭代后，集合中当前项的索引自动增加 1 以指向下一项；当您删除一个项目时，项目向左移动一个，缺少一个项目。

防止这种情况的一种方法是以相反的顺序遍历列表。

```
for i in reversed(l):
    print( i,l)
    l.remove(i) 
```

生成：

```
0 [1, 2, 3, 4, 5, 6, 7, 8, 9, 0]
9 [1, 2, 3, 4, 5, 6, 7, 8, 9]
8 [1, 2, 3, 4, 5, 6, 7, 8]
7 [1, 2, 3, 4, 5, 6, 7]
6 [1, 2, 3, 4, 5, 6]
5 [1, 2, 3, 4, 5]
4 [1, 2, 3, 4]
3 [1, 2, 3]
2 [1, 2]
1 [1] 
```

# windows - Mac 和 Unix 的文件名限制？

> ID：14734195
> 
> 赞同：-2
> 
> 时间：2013-02-06T16:38:54.993
> 
> 标签：windows, macos, unix, filenames, restrictions

我正在构建一个允许用户指定文件名的 GUI。我的 GUI 必须在 Windows、UNIX 和 Mac 上工作，所以我编写了一个方法来检查 filePath 的有效性。我使用 MSDN 查找 Windows 文件名的限制，因此我的方法可以检查 Windows 系统上的任何路径。有人有 Mac 和 UNIX 上的文件名限制列表吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-06T16:44:02.077

这些限制更多地与文件系统有关，而不是与操作系统有关。查看此页面：[http ://en.wikipedia.org/wiki/Comparison_of_file_systems#Limits](http://en.wikipedia.org/wiki/Comparison_of_file_systems#Limits)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-06T16:44:05.927

可以[在 Wikipedia上找到一个很好的概述](http://en.wikipedia.org/wiki/Filename#Comparison_of_filename_limitations)

# javascript - 本地和全球范围的咖啡脚本

> ID：14734196
> 
> 赞同：3
> 
> 时间：2013-02-06T16:38:57.343
> 
> 标签：javascript, coffeescript

使用 javascript：

```
function myFunc() {
    var x = 5;
};

console.log(x); 
```

我得到`//undefined`了：

```
function myFunc() {
        x = 5;
    };

    console.log(x); 
```

我明白了`5`

有了这个`coffeescript`变量`var x = 5;`。`x = 5`

例如这是可能的吗？：

```
myFunc ->
  window.x = 5;

    console.log window.x 
```

代替：

```
myFunc ->
 x = 5;

 console.log x 
```

我的问题是**如何使用 CoffeeScript 区分局部变量的全局变量？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:37:43.930

对于全局范围，您应该使用如下函数：

```
myFunc = =>
  @x = 5;

myFunc()

console.log x 
```

生成代码示例：http: [//jsfiddle.net/Upward/wZ7w4/](http://jsfiddle.net/Upward/wZ7w4/)

# javascript - 工具提示与错误消息

> ID：14734205
> 
> 赞同：0
> 
> 时间：2013-02-06T16:39:22.970
> 
> 标签：javascript, jquery, tooltip

希望这是这个问题的正确堆栈。

我的工具提示与错误消息有问题。我的工具提示设置为在每个文本井中的“焦点”上显示，当您在井中使用标签时，它们会出现和消失，如果输入的数据不符合标准，它们会出现错误消息。问题是错误消息弹出然后焦点转移到下一个框关闭错误消息之前可以阅读。焦点会自动移回错误输入的框，但随后会出现原始工具提示。

如果字段不正确，是否有办法取消“更改焦点”或“模糊”功能，设置显示错误消息的时间或以某种方式延迟“模糊”，以便错误消息至少保留 5-10秒？

感谢您的时间和考虑温斯顿

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:38:57.790

在触发前 5 秒后，您可以使用`setTimeout`设置变量。`blur`如果不是这种情况，您可以在 setTimeout 处理程序中隐藏消息。

```
var focusAtLeastFiveSecondsAgo;
$(thing).focus(function(){
    showMessage();
    focusAtLeastFiveSecondsAgo = false;
    setTimeout(function(){
         focusAtLeastFiveSecondsAgo = true;
         if (!$(thing).is(":focus")){
              hideMessage();
         }
    }, 5000);
});
$(thing).blur(function(){
    if (focusAtLeastFiveSecondsAgo){
         hideMessage();
    }
}); 
```

请注意，我们检查元素是否仍然集中在 setTimeout 处理程序中。如果不是模糊已被触发但被忽略，因为该消息刚刚显示。

为了代码可读性，您可能需要为此创建一个 jQuery 插件来存储变量并处理最小延迟。

# java - 如何使用 Ant 自动重命名输出 apk 文件？

> ID：14734208
> 
> 赞同：5
> 
> 时间：2013-02-06T16:39:28.833
> 
> 标签：java, android, eclipse, ant

我目前正在和 Ant 一起做一些汽车品牌推广工作。我修改了默认的 build.xml 并设置了我自己的目标。我希望问的是，Ant Script 中是否有一种方法可以自动重命名 apk 文件，只需使用特定名称构建？

我目前在我的 build.xml 中有这个 Ant 目标设置：

```
<target name="release-brandA"
            depends="default, -set-release-mode, -release-obfuscation-check, -package, -post-package, -release-prompt-for-password, -release-nosign, -release-sign, -post-build"
            description="Builds the application in release mode for brandA.">
    <delete dir="${res}" />
    <copydir dest="${res}" src="${branding}/brandA" forceoverwrite="ture" />
    <replaceregexp flags="g" byline="false">
        <regexp pattern="import com.arthur.android(.*).R;"/>
        <substitution expression="import com.arthur.android.brandA.R;"/>
        <fileset dir="src" includes="**/*.java" />
    </replaceregexp>
    <replaceregexp flags="g" byline="false">
        <regexp pattern="package=&quot;com.arthur.android(.*)&quot;" />
        <substitution expression="package=&quot;com.arthur.android.brandA&quot;" />
        <fileset dir="" includes="AndroidManifest.xml" />
    </replaceregexp>
</target> 
```

有没有办法可以添加更多任务，让输出文件就像brandA.apk？

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-06T16:53:36.293

最终的 apk 文件名实际上由属性“out.final.file”定义

因此，您可以创建一个设置此属性的新任务：

```
<target name="-set-out-final-file">
    <property name="out.final.file" location="${out.absolute.dir}/brandA.apk" />
</target> 
```

最后，您只需要`-set-out-final-file`在调用调试或发布目标之前调用目标。

使用你的`release-brandA`任务，它会变成这样：

```
<target name="release-brandA"
        depends="default, -set-out-final-file, -set-release-mode, -release-obfuscation-check... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-29T13:03:43.667

[在这里](http://blog.matoski.com/articles/generating-filename-based-on-the-android-project-name-and-version-name-when-running-ant/)，我找到了更好的解释和更合适的方法来覆盖发布目标。

请参考部分：

```
<target
        name="release"
        depends="custom-set-release-mode, android_rules.release" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-18T09:00:06.673

它非常简单。参考此链接 [1]：[https ://ant.apache.org/manual/running.html](https://ant.apache.org/manual/running.html)

所以在上述情况下，我们需要像这样运行它，

**蚂蚁调试-Dout.final.file=brandA.apk**

就是这样。

# oracle - 在 oracle 中使用 csv

> ID：14734210
> 
> 赞同：0
> 
> 时间：2013-02-06T16:39:36.790
> 
> 标签：oracle, csv, clob

我有桌子：

```
create table data_table(
  id number,
  csv clob
); 
```

csv 包含如下数据：

```
CONST  ID  DATA_1  DATA_2 ..  DATA_N
100    1   asd     123    ..  df
100    2   fgh     346    ..  fg 
```

我必须按 id 查找行，并更改一些 DATA 值，然后保存。最好的方法是什么？

起初我想使用 DBMS_UTILITY.comma_to_table，但发现 [http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:1415803954123](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:1415803954123)

例子

前：

```
insert into data_table values(1, '100;1;asd;123;df;'||chr(10)||
                                 '100;2;fgh;346;fg;'||chr(10)  );

insert into data_table values(2, '101;2;fgh;346;ff;'||chr(10)||
                                 '101;3;gfd;456;gh;'}}chr(10)  );

execute csv_update(2); 
```

后

从 data_table 中选择 csv；

100;1;asd;123;df;
100;2; **XXX** ; **000** ;fg;

101;2; **XXX** ; **000** ;fg;
101;3;gfd;456;gh;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:19:41.303

我的决定：

```
PROCEDURE update_clob_csv_row_by_id(id in VARCHAR2)
IS
  f_regexp varchar2(250) := '\d+;('||id||');[^'||CHR(10)||']*'||CHR(10);
  f_old_line varchar2(2000);
  f_new_line VARCHAR2(2000);
  f_count_line NUMBER;
BEGIN
  FOR CR IN (SELECT * FROM data_table ) LOOP
    -- find count of row with id(it can be not unique)
    SELECT nvl(REGEXP_COUNT(csv ,f_regexp), 0) COUNT_LINE
    INTO f_count_line
    FROM data_table
    WHERE id = cr.id;
    -- update all csv row
    FOR I IN 1..f_count_line LOOP
      -- find by reg_pattern the row for update 
      SELECT REGEXP_SUBSTR(EXPORT_DATA, f_regexp, 1, I) SUBSTR_LINE  
      INTO f_old_line
      FROM card_export
      WHERE id = cr.id;
      -- form new line 
      f_new_line := REPLACE_VALUE_IN_ROW(f_old_line);
      -- replace the old value with new 
      UPDATE card_export SET
      EXPORT_DATA = REPLACE(EXPORT_DATA, f_old_line, f_new_line)
      WHERE ID  = CR.ID;           
    END LOOP;
  END LOOP;
END DELETE_CARD_CONF_DATA; 
```

# c++ - 为什么 C 选择某些运算符作为它们的符号？

> ID：14734212
> 
> 赞同：9
> 
> 时间：2013-02-06T16:39:40.007
> 
> 标签：c++, c, pointers, reference, operators

正如问题所说，出于教育目的，C为什么选择他们选择的运算符进行相应的操作。对于＆当然它只是简单地阅读“和”所以这是有道理的。但是，我看不到 & 和地址或 % 和模数或 * 和指针之间的联系。话虽如此，我也看不到指针与键盘上可用的任何真实符号之间的联系。为什么选择这些符号？他们只是任意的吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:44:45.307

如果您查看[ASCII 表](http://www.asciitable.com/)（标准化的前 128 个字符），您会发现字符的选择非常有限。对于这些运算符，他们根本没有其他符号选择。

除了 $、@ 和 `（反引号）字符外，所有可打印字符都被使用。

可能 C 开发的第一台计算机的字符集中没有这三个字符。

# oracle - 3层应用非联网？

> ID：14734215
> 
> 赞同：0
> 
> 时间：2013-02-06T16:39:50.370
> 
> 标签：oracle, networking, listener, virtualization, openldap

我有一个名为 Windchill 的系统，它在 CentOS 5.7 虚拟机中运行；该系统由apache、oracle 11g、listener、windchillDS(openLDAP)和一个java进程的应用程序核心（方法服务器）组成。全部安装在同一个虚拟机中（单片机）

我的问题与网络有关，系统在网络上运行流畅，但是一旦我拔下网线，它就会停止工作，并且方法服务器会因套接字超时错误而不断重启。

我不是 IT 专家，我管理系统的内部配置，我现在没有专家来帮助我，但我**迫切**需要让它在笔记本电脑中非联网运行，以便向客户展示。我只想提示问题可能出在哪里：oracle 是否运行非联网？我需要哪些配置才能让它在没有网络的情况下运行？也许问题出在听众身上？我想问题是由于数据库的套接字超时错误而导致的 oracle，但我不确定......

抱歉，这很长，可能需要更多解释，请随便问！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T11:43:41.647

我在另一个特定于 Windchill 产品的论坛中找到了这个提示（需要登录） [http://portal.ptcuser.org/p/fo/st/thread=52005&posted=1](http://portal.ptcuser.org/p/fo/st/thread=52005&posted=1)

解析IP与Linux配置有关：

```
"Edit your /etc/resolv.conf to look like this when not connected to a network:

domain local domain
search localdomain
nameserver 127.0.0.1" 
```

工作完美！

谢谢小伙伴们的及时解答！！！

# ruby-on-rails-3 - 测试嵌套属性的自定义验证操作

> ID：14734216
> 
> 赞同：0
> 
> 时间：2013-02-06T16:39:57.800
> 
> 标签：ruby-on-rails-3, rspec, factory-bot

我有一个自定义操作来验证子属性的数量。我把它放在父母的模型中：

```
class Location < ActiveRecord::Base
  has_many :blacklisted
  accepts_nested_attributes_for :blacklisted, :reject_if => lambda { |a| a[:mac].blank? }, :allow_destroy => true  
  ...
  validate :check_blacklisted_clients_count

  private

  def check_blacklisted_clients_count
    if self.blacklisted.reject(&:marked_for_destruction?).count > 25
      self.errors.add :base, "No more than 25 blacklisted clients allowed per location."
    end
  end 
```

当我通过浏览器添加时效果很好，但是我试图用 rspec 测试它，但我不能让它失败（或通过，无论你怎么看）。

```
 it "should not allow 26 blacklisted macs", :focus => true do 
    loc = FactoryGirl.create(:location_full)
    25.times do
      loc.blacklisted.create(mac: '00:22:33:44:55:66')
    end
    loc.blacklisted.create(mac: '00:22:33:44:55:66')
    puts loc.blacklisted.count
    .........

  end 
```

（我知道这实际上还没有测试任何东西——我只是想确保只创建了 25 个）。

我假设这是因为 blacklisted.rb 模型中没有验证。

我怎样才能得到 rspec 来测试这个验证？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T02:47:52.003

最直接的方法是编写一个添加少于 25 个列入黑名单的 MAC 的规范，以及另一个添加超过 25 个的规范，并测试前者有效，后者无效。

根据您对规范运行时的感觉，这可能会很好。如果测试太慢，您可能需要使用存根。例如：

```
let(:location) { Location.new }

it "should be invalid with more than 25 blacklisted MACs" do
  location.stub_chain(:blacklisted, :reject, :count) { 26 }
  location.should be_invalid
  location.errors(:base).should include("No more than 25 blacklisted clients allowed per location.")
end 
```

使用存根有其缺点——规范可能更脆弱，并且与实现的耦合过于紧密。另一方面，如果您要检查 25,000 个 MAC，则使用真实对象进行测试可能并不可行。

# c - 使用 c 计算文件中的新行

> ID：14734219
> 
> 赞同：-3
> 
> 时间：2013-02-06T16:40:04.733
> 
> 标签：c, counting

对于文本：`Hi\r\n how is it going \r\nareyouoay\r\n`; 答案应该是3，新行**并不** `\n`意味着严格`\r\n`，所以只是有`\n`不好

这是我的尝试，我做错了什么？

```
FILE  *fp = fopen(fileName, "r"); 
int c, lastchar;           
int lineCount= 0;
int i;

while ( (c=fgetc(fp)) != EOF ) {
    if ( c == 'r' && lastchar == '\\' && c+1== '\\' && c+2=='n')
        lineCount++;
    lastchar = c; 
    i++;
} 
```

该文本的输出应为 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:41:39.967

如果你必须一次做你的搜索字符，你可以使用类似下面的代码

```
int c;           
int lineCount= 0;
int i = 0;
char next[] = {'\\', 'r', '\\', 'n' };
while ( (c=fgetc(fp)) != EOF ) {
    if (c != next[i]) {
        i = 0;
    }
    else {
        if (i == sizeof(next) - 1) {
            i = 0;
            lineCount++;
        }
        else {
            i++;
        }
    }
} 
```

对于有限的输入文件大小，最好将整个文件读入内存，然后使用[strstr](http://linux.die.net/man/3/strstr)。或者，对于较大的输入，将块读入内存，使用`strstr`并考虑如何避免在块边界上丢失匹配项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:42:56.467

What you're doing wrong is, `\n` is 1 character, not multiple characters.

Hence to count the number of lines you gotta do this:

```
while ((c = fgetc(fp))!= EOF){
   if(c == '\n') lineCount++;
}

printf("No. of lines = %d", lineCount); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:00:37.417

字符`\r`和`\n`是单个字符，因此在阅读您的输入时，您不会`\\`在其中找到字符。此外，如果您在 Windows 上，您应该使用 mode 打开文件以`"rb"`二进制模式打开它，否则运行时将删除`\r`字符。

```
FILE  *fp = fopen(fileName, "rb");
int lastchar = 0;
int lineCount = 0;
int c;

while ((c = fgetc(fp)) != EOF) {
    if (lastchar == '\r' && c == '\n')
        lineCount++;
    lastchar = c;
}

printf("line count: %d\n", lineCount); 
```

如果你真的想计算四个字符的连续性`\\` `r` `\\` `n`，那么你可以这样做（看起来很奇怪，但也许你的输入中有引用的字符序列）：

```
FILE  *fp = fopen(fileName, "rb");
char prevchars[4] = { 0, 0, 0, 0 };
char fingerprint[4] = { '\\', 'r', '\\', 'n' };
int lineCount = 0;
int c, i;

while ((c = fgetc(fp)) != EOF) {
    if (memcmp(prevchars, fingerprint, 4) == 0)
        lineCount++;
    for (i = 1; i < 4; i++)
        prevchars[i - 1] = prevchars[i];
    prevchars[3] = (char)c;
}

printf("line count: %d\n", lineCount); 
```

# list - Scala 从元组列表中删除元素

> ID：14734221
> 
> 赞同：4
> 
> 时间：2013-02-06T16:40:05.967
> 
> 标签：list, scala

我是 scala 的新手，我试图从元组元素列表中删除它们的第一个值大于第二个值。

例如，从列表中：

```
val list =  List[(Int,Int)]((1,3),(3,1),(2,2)) 
```

我想获取列表：

```
val list =  List[(Int,Int)]((1,3),(2,2)) 
```

所以我使用了以下几行：

```
var newList = List[(Int, Int)]()
for (element <- list) {
    if (element._1 <= element._2) {
        newList ::= element;
    }
} 
```

但是对scala来说感觉很长..有没有更短的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-06T16:44:19.983

像 twillouer 和 tzofia 的解决方案，但使用模式匹配：

```
list filter { case (a, b) => a <= b } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-06T16:43:13.513

你可以简单地做：

```
list.filter(element => element._1 <= element._2) 
```

filter 函数过滤掉不满足给定布尔条件的元素。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-06T16:42:38.267

你可以像这样使用过滤器：

```
scala> val list =  List[(Int,Int)]((1,3),(3,1),(2,2)) 
list: List[(Int, Int)] = List((1,3), (3,1), (2,2))

scala>  val newList = list.filter(a => a._1 <= a._2)
newList: List[(Int, Int)] = List((1,3), (2,2)) 
```

或 filterNot 例如：

```
scala> val newList = list.filterNot(a => a._1 > a._2)
newList: List[(Int, Int)] = List((1,3), (2,2)) 
```

# bash - 如何将文件复制到远程机器的不同目录中

> ID：14734222
> 
> 赞同：0
> 
> 时间：2013-02-06T16:40:06.343
> 
> 标签：bash, unix, ssh, scp

如何将文件复制到远程机器的不同目录中？

例如：

*   我的服务器：10.10.0.1
*   远程服务器：10.10.0.2

我必须登录到 10.10.0.1（*通过 Putty*）。从这里，我必须将远程机器中的文件从 复制`/home/test/myFile.txt`到`/home/bkp/myFile.txt`.

**源文件夹和目标文件夹都在远程计算机中。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T16:42:42.523

假设您可以`ssh`将 10.10.22.12 作为“用户名”并且“用户名”对 /home/testBkp 具有写入权限：

```
scp /home/test/sample.txt username@10.10.22.12:/home/testBkp/sample.txt 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:43:24.503

使用 scp。例如：

```
scp file_to_copy user@server:/home/user/foldername/filename.ext 
```

# mysql - 在Mysql上查询相关表

> ID：14734226
> 
> 赞同：0
> 
> 时间：2013-02-06T16:40:17.320
> 
> 标签：mysql

我有 2 个与一对多索引相关的表。这是我第一次在这种情况下，我试图找出一个漂亮而智能的查询来检索数据。

*表名：* **问题**

*结构*：

```
id poll_id question 
```

*表名：* **答案**

*结构*：

```
id question_id answer 
```

**表*anwsers中的***question_id是***问题*表上**id**的一个前导键。**

 ***我需要检索给定**poll_id**的所有问题（以及相应的答案选项） 。到目前为止，我有这个查询：

```
'SELECT * FROM polls_questions pq, polls_answers WHERE `poll_id` = ' . $pid 
```

但是返回的数组效率非常低，重复了很多次。

对于 4 个问题的民意调查，我得到 35 个元素；

```
Array
(
    [0] => Array
        (
            [id] => 1
            [poll_id] => 1
            [question] => Domanda 1
            [atype] => 0
            [question_id] => 1
            [answer] => Risposta 1 domanda 1
        )

    [1] => Array
        (
            [id] => 1
            [poll_id] => 1
            [question] => Domanda 2
            [atype] => 0
            [question_id] => 1
            [answer] => Risposta 1 domanda 1
        )

    [2] => Array
        (
            [id] => 1
            [poll_id] => 1
            [question] => Domanda 3
            [atype] => 0
            [question_id] => 1
            [answer] => Risposta 1 domanda 1
        )

    [3] => Array
        (
            [id] => 1
            [poll_id] => 1
            [question] => Domanda 4
            [atype] => 0
            [question_id] => 1
            [answer] => Risposta 1 domanda 1
        )

    [4] => Array
        (
            [id] => 2
            [poll_id] => 1
            [question] => Domanda 1
            [atype] => 0
            [question_id] => 1
            [answer] => Risposta 2 domanda 1 (F: Domanda 3)
        )

    [5] => Array
        (
            [id] => 2
            [poll_id] => 1
            [question] => Domanda 2
            [atype] => 0
            [question_id] => 1
            [answer] => Risposta 2 domanda 1 (F: Domanda 3)
        )

    [6] => Array
        (
            [id] => 2
            [poll_id] => 1
            [question] => Domanda 3
            [atype] => 0
            [question_id] => 1
            [answer] => Risposta 2 domanda 1 (F: Domanda 3)
        )

    [7] => Array
        (
            [id] => 2
            [poll_id] => 1
            [question] => Domanda 4
            [atype] => 0
            [question_id] => 1
            [answer] => Risposta 2 domanda 1 (F: Domanda 3)
        )

    [8] => Array
        (
            [id] => 3
            [poll_id] => 1
            [question] => Domanda 1
            [atype] => 0
            [question_id] => 2
            [answer] => Risposta 1 domanda 2
        )

    [9] => Array
        (
            [id] => 3
            [poll_id] => 1
            [question] => Domanda 2
            [atype] => 0
            [question_id] => 2
            [answer] => Risposta 1 domanda 2
        )

    [10] => Array
        (
            [id] => 3
            [poll_id] => 1
            [question] => Domanda 3
            [atype] => 0
            [question_id] => 2
            [answer] => Risposta 1 domanda 2
        )

    [11] => Array
        (
            [id] => 3
            [poll_id] => 1
            [question] => Domanda 4
            [atype] => 0
            [question_id] => 2
            [answer] => Risposta 1 domanda 2
        )

    [12] => Array
        (
            [id] => 4
            [poll_id] => 1
            [question] => Domanda 1
            [atype] => 0
            [question_id] => 2
            [answer] => Risposta 2 domanda 2
        )

    [13] => Array
        (
            [id] => 4
            [poll_id] => 1
            [question] => Domanda 2
            [atype] => 0
            [question_id] => 2
            [answer] => Risposta 2 domanda 2
        )

    [14] => Array
        (
            [id] => 4
            [poll_id] => 1
            [question] => Domanda 3
            [atype] => 0
            [question_id] => 2
            [answer] => Risposta 2 domanda 2
        )

    [15] => Array
        (
            [id] => 4
            [poll_id] => 1
            [question] => Domanda 4
            [atype] => 0
            [question_id] => 2
            [answer] => Risposta 2 domanda 2
        )

    [16] => Array
        (
            [id] => 5
            [poll_id] => 1
            [question] => Domanda 1
            [atype] => 0
            [question_id] => 3
            [answer] => Risposta 1 domanda 3
        )

    [17] => Array
        (
            [id] => 5
            [poll_id] => 1
            [question] => Domanda 2
            [atype] => 0
            [question_id] => 3
            [answer] => Risposta 1 domanda 3
        )

    [18] => Array
        (
            [id] => 5
            [poll_id] => 1
            [question] => Domanda 3
            [atype] => 0
            [question_id] => 3
            [answer] => Risposta 1 domanda 3
        )

    [19] => Array
        (
            [id] => 5
            [poll_id] => 1
            [question] => Domanda 4
            [atype] => 0
            [question_id] => 3
            [answer] => Risposta 1 domanda 3
        )

    [20] => Array
        (
            [id] => 6
            [poll_id] => 1
            [question] => Domanda 1
            [atype] => 0
            [question_id] => 3
            [answer] => Risposta 2 domanda 3 (F: END POLL)
        )

    [21] => Array
        (
            [id] => 6
            [poll_id] => 1
            [question] => Domanda 2
            [atype] => 0
            [question_id] => 3
            [answer] => Risposta 2 domanda 3 (F: END POLL)
        )

    [22] => Array
        (
            [id] => 6
            [poll_id] => 1
            [question] => Domanda 3
            [atype] => 0
            [question_id] => 3
            [answer] => Risposta 2 domanda 3 (F: END POLL)
        )

    [23] => Array
        (
            [id] => 6
            [poll_id] => 1
            [question] => Domanda 4
            [atype] => 0
            [question_id] => 3
            [answer] => Risposta 2 domanda 3 (F: END POLL)
        )

    [24] => Array
        (
            [id] => 7
            [poll_id] => 1
            [question] => Domanda 1
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 1 domanda 4
        )

    [25] => Array
        (
            [id] => 7
            [poll_id] => 1
            [question] => Domanda 2
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 1 domanda 4
        )

    [26] => Array
        (
            [id] => 7
            [poll_id] => 1
            [question] => Domanda 3
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 1 domanda 4
        )

    [27] => Array
        (
            [id] => 7
            [poll_id] => 1
            [question] => Domanda 4
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 1 domanda 4
        )

    [28] => Array
        (
            [id] => 8
            [poll_id] => 1
            [question] => Domanda 1
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 2 domanda 4
        )

    [29] => Array
        (
            [id] => 8
            [poll_id] => 1
            [question] => Domanda 2
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 2 domanda 4
        )

    [30] => Array
        (
            [id] => 8
            [poll_id] => 1
            [question] => Domanda 3
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 2 domanda 4
        )

    [31] => Array
        (
            [id] => 8
            [poll_id] => 1
            [question] => Domanda 4
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 2 domanda 4
        )

    [32] => Array
        (
            [id] => 9
            [poll_id] => 1
            [question] => Domanda 1
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 3 domanda 4
        )

    [33] => Array
        (
            [id] => 9
            [poll_id] => 1
            [question] => Domanda 2
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 3 domanda 4
        )

    [34] => Array
        (
            [id] => 9
            [poll_id] => 1
            [question] => Domanda 3
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 3 domanda 4
        )

    [35] => Array
        (
            [id] => 9
            [poll_id] => 1
            [question] => Domanda 4
            [atype] => 0
            [question_id] => 4
            [answer] => Risposta 3 domanda 4
        )

) 
```

我可以只使用两个查询来解决这个问题，一个用于问题，一个用于答案，这将给我两个数组，但是这样做没有表之间的关系的意义。如何以最佳方式查询数据库并检索问题和答案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:44:34.883

您没有加入任何列上的表，因此您将获得笛卡尔结果集：

```
'SELECT * 
FROM polls_questions pq
INNER JOIN polls_answers pa
  on pq.id = pa.question_id 
WHERE `poll_id` = ' . $pid 
```

您应该使用`JOIN`在问题 ID 上加入表格的语法。这是为了确保您只返回带有答案的问题。否则，您将用每个答案返回每个问题。

我`INNER JOIN`在两个表之间使用了一个，它将返回两个表之间的匹配行。如果您想返回所有问题，即使答案中没有匹配的行，那么您需要一个`LEFT JOIN`.

如果您需要帮助理解连接语法，这里是[连接的一个很好的视觉解释](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:45:20.417

```
'SELECT * 
FROM polls_questions pq, polls_answers 
WHERE `poll_id` = ' . $pid . ' AND pq.id = polls_answers.question_id' 
```***

# hibernate - org.hibernate.MappingException：使用@JoinTable 的集合映射中的重复列

> ID：14734235
> 
> 赞同：7
> 
> 时间：2013-02-06T16:40:52.817
> 
> 标签：hibernate, jointable

我有以下（简化）情况：

表 A 的字段：

*   ID
*   常见的

表 AB 的字段：

*   援助
*   投标共同

表 B 的字段：

*   ID
*   常见的

并希望使用这样的 OneToMany 将其与实体映射（在表 A 上映射的主类中）：

```
@OneToMany(cascade = CascadeType.ALL, orphanRemoval = false, fetch = FetchType.LAZY)
@JoinTable(name = "AB", 
joinColumns= {
    @JoinColumn(name = "AID", referencedColumnName="ID"), 
    @JoinColumn(name = "COMMONID", referencedColumnName="COMMONID")},
inverseJoinColumns = {
    @JoinColumn(name = "BID", referencedColumnName="ID"), 
    @JoinColumn(name = "COMMONID", referencedColumnName="COMMONID")})
private Set<MyClassForB> list= new HashSet<MyClassForB>(); 
```

构建会话，我收到以下错误：

```
org.hibernate.MappingException: Repeated column in mapping for collection using @JoinTable list column: COMMONID 
```

我究竟做错了什么？考虑到我是 Hibernate 的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-14T10:04:22.883

尝试像这样添加可插入和可更新

```
@OneToMany(cascade = CascadeType.ALL, orphanRemoval = false, fetch = FetchType.LAZY)
@JoinTable(name = "AB", 
joinColumns= {
    @JoinColumn(name = "AID", referencedColumnName="ID", insertable = false, updatable = false), 
    @JoinColumn(name = "COMMONID", referencedColumnName="COMMONID", insertable = false, updatable = false)},
inverseJoinColumns = {
    @JoinColumn(name = "BID", referencedColumnName="ID", insertable = false, updatable = false), 
    @JoinColumn(name = "COMMONID", referencedColumnName="COMMONID", insertable = false, updatable = false)})
private Set<MyClassForB> list= new HashSet<MyClassForB>(); 
```

但是我不确定你是否能够更新这个集合，我的用例是只读的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-08-09T03:05:46.103

[![你的 ER 图](../Images/3fd49878ef306933ac0fed0799e9171f.png)](https://i.stack.imgur.com/DCRdf.png) 假设您允许您的 JPA 提供程序（例如 Hibernate）创建表...试试这个

```
Class A{
    @ManyToMany
    @JoinTable(
    name = "AB", 
    joinColumns = @JoinColumn(name = "A_Id"), 
    inverseJoinColumns = @JoinColumn(name = "B_Id")
    )
     private Set<B> blist= new HashSet<B>();
}

Class B{

     @ManyToMany(cascade = CascadeType.ALL, mappedBy = "A_Id")
    private Set<A> blist= new HashSet<A>();
} 
```

# ruby-on-rails - Rails CSRF 保护 + Angular.js：protect_from_forgery 让我在 POST 上注销

> ID：14734243
> 
> 赞同：130
> 
> 时间：2013-02-06T16:41:14.230
> 
> 标签：ruby-on-rails, angularjs, csrf, protect-from-forgery

如果`protect_from_forgery`在 application_controller 中提到了该选项，那么我可以登录并执行任何 GET 请求，但在第一个 POST 请求时，Rails 会重置会话，这会将我注销。

我`protect_from_forgery`暂时关闭了该选项，但想将它与 Angular.js 一起使用。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：277
> 
> 时间：2013-04-02T10:30:34.320

我认为从 DOM 读取 CSRF-value 不是一个好的解决方案，它只是一种解决方法。

这里是 angularJS 官网[http://docs.angularjs.org/api/ng.$http](https://docs.angularjs.org/api/ng/service/$http#cross-site-request-forgery-xsrf-protection)的文档形式 ：

> 由于只有在您的域上运行的 JavaScript 才能读取 cookie，因此您的服务器可以确信 XHR 来自在您的域上运行的 JavaScript。
> 
> 为了利用这一点（CSRF 保护），您的服务器需要在第一个 HTTP GET 请求时在名为 XSRF-TOKEN 的 JavaScript 可读会话 cookie 中设置一个令牌。在随后的非 GET 请求中，服务器可以验证 cookie 是否匹配 X-XSRF-TOKEN HTTP 标头

这是我根据这些说明的解决方案：

首先，设置cookie：

```
# app/controllers/application_controller.rb

# Turn on request forgery protection
protect_from_forgery

after_action :set_csrf_cookie

def set_csrf_cookie
  cookies['XSRF-TOKEN'] = form_authenticity_token if protect_against_forgery?
end 
```

然后，我们应该在每个非 GET 请求上验证令牌。
由于 Rails 已经使用类似的方法构建，我们可以简单地覆盖它以附加我们的逻辑：

```
# app/controllers/application_controller.rb

protected

  # In Rails 4.2 and above
  def verified_request?
    super || valid_authenticity_token?(session, request.headers['X-XSRF-TOKEN'])
  end

  # In Rails 4.1 and below
  def verified_request?
    super || form_authenticity_token == request.headers['X-XSRF-TOKEN']
  end 
```

* * *

## 回答 #2

> 赞同：79
> 
> 时间：2013-02-06T17:30:36.990

如果你使用默认的 Rails CSRF 保护 ( `<%= csrf_meta_tags %>`)，你可以像这样配置你的 Angular 模块：

```
myAngularApp.config ["$httpProvider", ($httpProvider) ->
  $httpProvider.defaults.headers.common['X-CSRF-Token'] = $('meta[name=csrf-token]').attr('content')
] 
```

或者，如果您不使用 CoffeeScript（什么！？）：

```
myAngularApp.config([
  "$httpProvider", function($httpProvider) {
    $httpProvider.defaults.headers.common['X-CSRF-Token'] = $('meta[name=csrf-token]').attr('content');
  }
]); 
```

如果您愿意，您可以仅在非 GET 请求上发送标头，如下所示：

```
myAngularApp.config ["$httpProvider", ($httpProvider) ->
  csrfToken = $('meta[name=csrf-token]').attr('content')
  $httpProvider.defaults.headers.post['X-CSRF-Token'] = csrfToken
  $httpProvider.defaults.headers.put['X-CSRF-Token'] = csrfToken
  $httpProvider.defaults.headers.patch['X-CSRF-Token'] = csrfToken
  $httpProvider.defaults.headers.delete['X-CSRF-Token'] = csrfToken
] 
```

另外，请务必查看[HungYuHei 的答案](https://stackoverflow.com/questions/14734243/rails-csrf-protection-angular-js-protect-from-forgery-makes-me-to-log-out-on/15761835#15761835)，它涵盖了服务器而不是客户端的所有基础。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2013-12-13T17:18:19.670

[angular_rails_csrf](https://github.com/jsanders/angular_rails_csrf) gem 自动添加对[HungYuHei](https://stackoverflow.com/questions/14734243/rails-csrf-protection-angular-js-protect-from-forgery-makes-me-to-log-out-on/15761835#15761835)对所有控制器的回答中描述的模式的支持：

```
# Gemfile
gem 'angular_rails_csrf' 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-05-28T15:53:38.063

合并所有先前答案的答案，它依赖于您正在使用`Devise`身份验证 gem。

首先，添加gem：

```
gem 'angular_rails_csrf' 
```

接下来，将`rescue_from`块添加到 application_controller.rb：

```
protect_from_forgery with: :exception

rescue_from ActionController::InvalidAuthenticityToken do |exception|
  cookies['XSRF-TOKEN'] = form_authenticity_token if protect_against_forgery?
  render text: 'Invalid authenticity token', status: :unprocessable_entity
end 
```

最后，将拦截器模块添加到您的 Angular 应用程序中。

```
# coffee script
app.factory 'csrfInterceptor', ['$q', '$injector', ($q, $injector) ->
  responseError: (rejection) ->
    if rejection.status == 422 && rejection.data == 'Invalid authenticity token'
        deferred = $q.defer()

        successCallback = (resp) ->
          deferred.resolve(resp)
        errorCallback = (resp) ->
          deferred.reject(resp)

        $http = $http || $injector.get('$http')
        $http(rejection.config).then(successCallback, errorCallback)
        return deferred.promise

    $q.reject(rejection)
]

app.config ($httpProvider) ->
  $httpProvider.interceptors.unshift('csrfInterceptor') 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-09T14:39:34.980

我看到了其他答案，并认为它们很棒并且经过深思熟虑。我让我的 Rails 应用程序使用了我认为更简单的解决方案，所以我想我会分享。我的 rails 应用程序带有这个默认值，

```
class ApplicationController < ActionController::Base
  # Prevent CSRF attacks by raising an exception.
  # For APIs, you may want to use :null_session instead.
  protect_from_forgery with: :exception
end 
```

我阅读了评论，这似乎是我想使用 angular 并避免 csrf 错误。我改成这样了

```
class ApplicationController < ActionController::Base
  # Prevent CSRF attacks by raising an exception.
  # For APIs, you may want to use :null_session instead.
  protect_from_forgery with: :null_session
end 
```

现在它起作用了！我看不出这不应该起作用的任何原因，但我很想听听其他海报的一些见解。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-04-17T14:06:52.587

我在我的应用程序中使用了 HungYuHei 回答中的内容。然而，我发现我正在处理一些其他问题，其中一些是因为我使用 Devise 进行身份验证，还有一些是因为我的应用程序默认设置：

```
protect_from_forgery with: :exception 
```

我注意到相关的[堆栈溢出问题和那里的答案](https://stackoverflow.com/questions/11845500/rails-devise-authentication-csrf-issue/)，我写了一篇更详细的[博客文章](http://technpol.wordpress.com/2014/04/17/rails4-angularjs-csrf-and-devise/)，总结了各种注意事项。该解决方案中与此处相关的部分在应用程序控制器中：

```
 protect_from_forgery with: :exception

  after_filter :set_csrf_cookie_for_ng

  def set_csrf_cookie_for_ng
    cookies['XSRF-TOKEN'] = form_authenticity_token if protect_against_forgery?
  end

  rescue_from ActionController::InvalidAuthenticityToken do |exception|
    cookies['XSRF-TOKEN'] = form_authenticity_token if protect_against_forgery?
    render :error => 'Invalid authenticity token', {:status => :unprocessable_entity} 
  end

protected
  def verified_request?
    super || form_authenticity_token == request.headers['X-XSRF-TOKEN']
  end 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-12-30T22:21:47.463

我发现了一个非常快速的破解方法。我所要做的就是：

一种。在我看来，我初始化了一个`$scope`包含令牌的变量，比如说在表单之前，或者在控制器初始化时更好：

```
<div ng-controller="MyCtrl" ng-init="authenticity_token = '<%= form_authenticity_token %>'"> 
```

湾。在我的 AngularJS 控制器中，在保存我的新条目之前，我将令牌添加到哈希中：

```
$scope.addEntry = ->
    $scope.newEntry.authenticity_token = $scope.authenticity_token 
    entry = Entry.save($scope.newEntry)
    $scope.entries.push(entry)
    $scope.newEntry = {} 
```

没有什么需要做的了。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-02-16T15:04:38.700

```
 angular
  .module('corsInterceptor', ['ngCookies'])
  .factory(
    'corsInterceptor',
    function ($cookies) {
      return {
        request: function(config) {
          config.headers["X-XSRF-TOKEN"] = $cookies.get('XSRF-TOKEN');
          return config;
        }
      };
    }
  ); 
```

它在angularjs方面工作！

# linux - Linux Alias，它有什么问题？

> ID：14734244
> 
> 赞同：0
> 
> 时间：2013-02-06T16:41:14.407
> 
> 标签：linux, alias

我有这个别名：

```
alias gi='grep -r -i $1 ./*' 
```

当我做

```
gi someString 
```

它执行 grep，但在我提供的字符串之外的其他字符串上，通常带有“p/”或其他类似的东西。

我正在使用类似的东西来获取历史记录：

```
alias gh='history | grep $1' 
```

效果很好。

编辑：根据 echo $SHELL，我在 /bin/bash shell 上。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:51:31.947

该`alias`机制仅代替一个词。同一行上的任何*其他*单词都保留在原处，因此通常只需替换命令并保留参数。这不适用于您的*grep*示例，因为您想重新排列该行。

现在，`$1`将引用shell 进程（或shell 函数）参数，在任何一种情况下，*都不*是在同一行上键入的单词。

在这种情况下，最好使用 shell*函数*，它应该适用于任何 Posix shell，包括 bash。

```
gi () {
  grep -r -i "$1" ./*
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:53:02.260

您不能将参数传递给`alias`，请参阅[此帖子](https://stackoverflow.com/questions/941338/shell-script-how-to-pass-command-line-arguments-to-an-unix-alias)了解详细信息。你需要的是一个函数。尝试一下：

```
function gi() {
grep -r -i "$1" ./*
} 
```

希望这可以帮助！

PS：至于为什么`alias gh='history | grep $1'`起作用是因为它与`alias gh='history | grep`. 静态`$1`设置时展开。`alias`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:50:31.653

试试这个别名：

```
alias gi='find . | xargs grep -i' 
```

如果您仍然只想使用别名来解决您的问题，这将起作用。

# javascript - 如何使用 Mocha 测试长时间超时？

> ID：14734245
> 
> 赞同：0
> 
> 时间：2013-02-06T16:41:16.387
> 
> 标签：javascript, node.js, testing, oauth, mocha.js

我正在测试一个无法访问代码的外部服务器，我只从服务器中知道它的协议[UMA](http://kantarainitiative.org/confluence/display/uma/Home)，与 Ouath 和外部端点相关的东西。

我一直在测试系统的所有主要功能，但是我需要测试我的服务器测试和外部测试之间交换令牌的超时。此超时设置为一小时，我想测试令牌过期后发生的一些行为。这个问题我不知道该怎么做......我的意思是我知道简单的让我的测试等待一个小时，但我相信有更好的方法。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T19:43:13.907

为什么不立即获得令牌，这就是您从现在开始继续使用的令牌。令牌是否在 5 分钟前或 5 个月前过期并不重要。

# c++ - 如何检查是否为给定的 UTC 偏移启用了夏令时？

> ID：14734250
> 
> 赞同：1
> 
> 时间：2013-02-06T16:41:32.123
> 
> 标签：c++, c, linux, redhat

我需要确定是否为 Linux（Redhat）中的给定 UTC 偏移启用了夏令时。我收到诸如 UTC+05:30 之类的输入。我检查了 zdump 命令的用法。当与时区名称一起使用时，我们可以检查输出中 isdst 的值以确定夏令时的状态。

> zdump -v /usr/share/zoneinfo/Asia/Kolkata | 2013 年

如上所述，zdump 需要区域名称。它不接受 UTC 偏移量。

我还尝试了如下本地时间功能。

```
time_t currtime;
struct tm * timeinfo;
timeinfo = localtime ( &currtime );
time_t local = mktime( timeinfo );
cout<<timeinfo->tm_isdst<<endl; 
```

上面的代码在日期时间设置中设置时区名称时有效。如果系统使用 UTC 时间，它就不起作用。当使用 UTC 时间时，我使用**gmtime而不是 localtime。**

请让我知道是否有任何方法可以使用 UTC 偏移量来确定是否启用了 dst。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T16:52:32.600

这一般是不可能的。许多国家/地区可能使用 UTC+05:30，每个国家/地区都有不同的夏令时政策。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T16:53:09.017

UTC 偏移量不足以确定是否启用 DST，因为某些司法管辖区不使用 DST。此外，那些确实有不同的时间表生效时间（例如，南半球的地方与北半球的地方）。您需要的是一个最新的表，其中包含使用 DST 的时区名称以及每个时区的 DST 开始和停止时间。

# php - UNION ALL 中的 COUNT 导致跳过预期结果

> ID：14734253
> 
> 赞同：0
> 
> 时间：2013-02-06T16:41:45.577
> 
> 标签：php, mysql, sql, database, join

我有一个简单的文章和评论表。我想显示文章及其评论。我想在同一张桌子上与一个带有评论的选择和另一个没有评论的选择联合。我有文章编号 1 有 1 条评论和文章编号 2 没有评论和文章编号 3 有 2 条评论。

文章表：

```
articles.id | articles.content
   1        |  test article
   2        |  test another
   3        |   test third 
```

评论表：

```
comments.id | comments.aid | comments.comment
  1         |   1          |  bad one
  2         |   3          |  very good
  3         |   3          |   good 
```

我使用以下查询来获取结果。

```
SELECT articles.id AS article_id,
comments.id AS comment_id,
comment
FROM articles
LEFT JOIN comments ON comments.aid = articles.id
UNION ALL
SELECT articles.id AS article_id,
NULL,
NULL
FROM articles
GROUP BY article_id
ORDER BY article_id DESC 
```

我得到的结果是正确的：

```
article_id | comment_id | comment
   3       | 3          | good
   3       | 2          | very good
   3       | NULL       | NULL
   2       | NULL       | NULL
   2       | NULL       | NULL
   1       | NULL       | NULL
   1       | 1          | bad one 
```

现在，如果我想计算评论，我也将 COUNT 添加到查询中，它变为：

```
SELECT articles.id AS article_id,
comments.id AS comment_id,
comment ,
COUNT(DISTINCT comments.id) AS count_comments
FROM articles
LEFT JOIN comments ON comments.aid = articles.id
UNION ALL
SELECT articles.id AS article_id,
NULL,
NULL ,
NULL
FROM articles
GROUP BY article_id
ORDER BY article_id DESC 
```

现在结果在添加计数列后发生了变化，并不是所有的行都被输出：

```
article_id | comment_id | comment   | count_comments
  3        | NULL       | NULL      |  NULL
  2        | NULL       | NULL      |  NULL  
  1        | NULL       | NULL      |  NULL
  1        | 1          | bad one   |  3 
```

现在除了第1条的评论不显示评论，ID（2）应该显示2次选择命令，ID（3）应该显示3次（第二次选择命令1次，第一次选择2次）选择命令，因为有 2 条评论）

我期望的正确结果：

```
article_id | comment_id | comment   | count_comments
   3       | 3          | good      |   2 
   3       | 2          | very good |   2
   3       | NULL       | NULL      |   NULL  
   2       | NULL       | NULL      |   NULL
   2       | NULL       | NULL      |   NULL
   1       | NULL       | NULL      |   NULL 
   1       | 1          | bad one   |    1 
```

我不知道为什么添加计数会导致问题。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:53:51.523

添加时，`count()`它仅影响第一个子查询。因此，该子查询仅返回一行而不是多行。

我今天在上传 SQL 时遇到问题，但我认为您想要这种形式的东西：

```
select articles.id AS article_id, comments.id AS comment_id, comment,
       COUNT(DISTINCT comments.id) AS count_comments
from ((subquery1) union all
      (subquery2)
     ) t
group by article_id
order by article_id desc 
```

我假设您正在尝试包含所有文章。你不需要`union all`. 您的第一个查询就足够了（因为`left join`）：

```
select articles.id AS article_id, comments.id AS comment_id, comment,
       COUNT(DISTINCT comments.id) AS count_comments
from articles left join
     LEFT JOIN comments ON comments.aid = articles.id
group by article_id
ORDER BY article_id DESC 
```

在您说正确的结果中，文章 2 有两行，都带有 NULL。这真的是你想要的吗？如果要添加它，请将其放在`order by`：

```
union all
select distinct article_id, NULL, NULL, NULL
from articles 
```

# url - Sencha：分享网址

> ID：14734254
> 
> 赞同：1
> 
> 时间：2013-02-06T16:41:51.267
> 
> 标签：url, extjs, share

我正在 Sencha Touch 2 中构建一个新闻阅读器。这个新闻阅读器中有一个“分享”按钮，但我不确定您将如何通过 URL 分享当前文章。

也就是说，如果我的 Sencha 站点的 URL 是：www.senchareader.com，那么我可以共享的唯一 URL 就是这个。

有没有办法在 Sencha 框架内创建类似 www.senchareader.com/article1234567 的东西？这样当某人点击 URL 时，它实际上会转到正在共享的文章？

希望这很清楚，如果不是，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T19:10:22.803

是的你可以。Sencha 使用 URL 哈希来支持浏览器历史记录。在 ExtJS 4.1.3 站点上查看[此示例，以及](http://docs.sencha.com/ext-js/4-1/#!/example/history/history.html)[此处的相关文档](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.util.History)。本质上，您将“令牌”（哈希）添加到历史记录中，然后监听更改以支持前进和后退按钮。但是，如果您使用的是 Sencha Touch 2，则通过在控制器中使用“路由”来支持历史记录会更容易一些。您可以在此处阅读[Sencha Touch 历史支持文档](http://docs.sencha.com/touch/2-1/#!/guide/history_support)。

执行此操作的代码会有所不同，具体取决于您使用的是 ExtJS 还是 Sencha Touch，但对于 ExtJS，它类似于以下内容：

```
...
Ext.History.init();
...
// something happens to change the url (like a user clicks on an article)
var newToken = '/article/'+article.id; // or whatever
var oldToken = Ext.History.getToken();
if (oldToken === null || oldToken.search(newToken) === -1) {
  Ext.History.add(newToken);
}
...
Ext.History.on('change', function(token) {
  // handle the token changing, most likely by showing the right article
}); 
```

# javascript - 从选择框中获取选定的值不起作用

> ID：14734258
> 
> 赞同：0
> 
> 时间：2013-02-06T16:42:00.850
> 
> 标签：javascript, html

我创建了一个函数，在单击时使用另一个选择框的值填充一个选择框，它对于系统中的大多数选择框都工作得很好，但我现在正在努力解决这个问题，哈哈：

用于测试所选值并在发现时发出警报的功能：

```
function updateSelectBox(parent, child){
    for(i = 0; i < document.getElementById(parent).length; i++){
        if(document.getElementById(parent).options[i].selected){
            alert(document.getElementById(parent).options[i].value);
    }
} 
```

选择此选项时不会发出警报：

```
<input type="hidden" name="data[Series][3][Profession][Profession]" value="" id="Professions3_">
<select name="data[Series][3][Profession][Profession][]" multiple="multiple" id="Professions3" onchange="updateSelectBox("Professions3", "Specialisms3");">
<option value="24">Scientist</option> 
```

选择时会发出警报：

```
<input type="hidden" name="data[Series][4][Profession][Profession]" value="" id="Professions4_">
<select name="data[Series][4][Profession][Profession][]" multiple="multiple" id="Professions4" onchange="updateSelectBox("Professions4", "Specialisms4");">
<option value="24">Scientist</option> 
```

这是来自不同选择框的完整 html 输出，也可以**工作**

```
<div class="input select"><label for="Zones">Zones</label><input type="hidden" name="data[Series][0][Zone][Zone]" value="" id="Zones_">
<select name="data[Series][0][Zone][Zone][]" multiple="multiple" id="Zones" onchange="updateSelectBox(&quot;Zones&quot;, &quot;Countries&quot;);">
<option value="4">Europe</option>
</select>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:25:11.047

这行不通。即使它在您的页面上运行，您帖子中的代码也无法运行：您的 JavaScript 缺少右括号，您在双引号内使用带有双引号的 HTLM，没有人能够运行它。所以让我们退后一步，把它改写成肯定会起作用的东西：

HTML

```
<select onchange="updateSelectBox(this);">
  <option value="0">Scientist 1</option>
  <option value="12">Scientist 2</option>
  <option value="24">Scientist 3</option>
</select> 
```

JS

```
function updateSelectBox(selectBox) {
  var sid = selectBox.selectedIndex;
  var selectedOption = selectBox.children[sid];
  console.log(selectedOption);
} 
```

现在我们至少有了一些我们知道可以使用的东西，使用最少的代码，我们可以重新构建。我建议使用它来构建您现在拥有的 HTML 和功能。例如，您肯定需要停止使用如此多的字符串和查找。特别是相信没有错别字的字符串会毁了你的一天（你有一个名为'Professions3_'的输入和一个名为'Professions3'的选择......这只是自找麻烦）

# regex - 如果 value 有多个数据，如何使用 Perl Regx 解析 [key=value]

> ID：14734259
> 
> 赞同：-2
> 
> 时间：2013-02-06T16:42:02.077
> 
> 标签：regex, perl

我无法解决以下问题，所以我使用 Perl 脚本在没有正则表达式的情况下进行解析，但我相信它有一个正则表达式。

*输入字符串*（没有换行符）：

```
ObjectAddress=120.146.128.250,ObjectName=psyseds-tt1y,ObjectClass=SCM F5,ObjectDescription=,Aliases=psyseds-tt1y.site.com.,NameService=A,PTR,DynamicDNSUpdate=A,PTR,CNAME 
```

*预期输出*：

```
ObjectAddress=120.146.128.250
ObjectName=psyseds-tt1y
ObjectClass=SCM F5
ObjectDescription=
Aliases=psyseds-tt1y.site.com.
NameService=A,PTR
DynamicDNSUpdate=A,PTR,CNAME 
```

我尝试了一些正则表达式来解析字符串，但我无法解析，因为它有多个具有`,`分隔值的项目。例如，NameService 有两个值 A,PTR。

请帮我建立正则表达式来解析上面。 `(.+?=.*?)`不拾取多个值。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T16:52:54.363

一般来说，您的格式似乎不是明确的——比如`A=B,C=D`可能意味着`A`映射到`B`和`C`映射到`D`，或者`A`映射到`B,C=D`——但是为了一个好的近似值，你可以写：

```
my @output = split /,(?=\w+=)/, $input; 
```

这将`$input`在逗号 ( `,`) 上拆分，附加限制是逗号必须后跟一个或多个“单词字符”（`\w`- 字母、数字、下划线）加等号。（这称为[*前瞻断言*](http://www.regular-expressions.info/lookaround.html)。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:51:24.383

你可以**匹配**这个正则表达式

```
(?<=^|,)(?<key>.*?)=(?<value>.*?)(?=,|$) 
```

您现在可以通过组名访问值

# java - 解析一个字符串到日期

> ID：14734261
> 
> 赞同：3
> 
> 时间：2013-02-06T16:42:06.320
> 
> 标签：java, string, date, simpledateformat

我要解析的字符串：

> 2013 年 11 月 10 日星期日 10:00:00 CET

我的代码：

```
substrings = "Sun Nov 10 10:00:00 CET 2013"

SimpleDateFormat parserSDF = new SimpleDateFormat("EEE MMM d HH:mm:ss ZZZ yyyy");
Date date = parserSDF.parse(substrings); 
```

编译器错误输出：

> java.text.ParseException：无法解析的日期：“Sun Nov 10 10:00:00 CET 2013”​​在 java.text.DateFormat.parse(Unknown Source) ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:50:39.760

可能您缺少正确的语言环境。试试这个，在你的例子中：

```
 SimpleDateFormat parserSDF = new SimpleDateFormat("EEE MMM d HH:mm:ss ZZZ yyyy", Locale.US); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:55:11.653

ZZZ 将尝试按照 RFC 822 时区格式化时区，请改用 zzz。

这是供参考[的JavaDoc链接](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-09-04T04:38:17.820

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-06T17:11:40.353

问题是 parserSDF 采用字符串而不是数组和 ParsePosition。我写这个是为了输出我认为你想要的。

```
import java.text.*;
public class Parser{
    public static void main(String[] args){
    String input = "Sun Nov 10 10:00:00 CET 2013";
    SimpleDateFormat parserSDF = new SimpleDateFormat("EEE MMM d HH:mm:ss ZZZ yyyy");
    System.out.println(parserSDF.parse(input, new ParsePosition(0)));
    }
} 
```

我建议查看API中的[SimpleDateFormat](http://docs.oracle.com/javase/7/docs/api/)和[ParsePosition](http://docs.oracle.com/javase/7/docs/api/java/text/ParsePosition.html)

# r - 在R中将列拆分为字符和数字

> ID：14734266
> 
> 赞同：0
> 
> 时间：2013-02-06T16:42:13.527
> 
> 标签：r

我将数据框拆分为`X`和`Y`。`X`有一列，`Y`大约`100`.

```
x <- subset(tbl, , select = ordernum)
y <- subset(tbl, select = -c(ordernum, paid1num, 
          weight, returnnum, order_only, multi_dep, sequence_id)) 
```

接下来，我与产生`X`with和的*每一列*相关联。`Y``frame``100 columns``a single row`

```
corr <- cor(x,y) 
```

接下来我转置，

```
corr.t <- t(corr) 
```

并且（截断的）结果如下所示：

```
 ordernum
HH_AFFORD_MOMS_BUY_GREEN      -0.0021281583
HH_AFFORD_SPORTS              -0.0047221159
HH_AFFORD_CLASSICAL_MUSIC     -0.0006594956
HH_AFFORD_HOME_DECOR           0.0052106766 
```

我想将这个名为`ordernum`的单列拆分为 2 列。`character`具有变量名称的字段和`numeric`具有相关性的字段。

我很感激任何指导。也许如果我使用`lm`, 而不是`cor`?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T16:47:39.817

您存储为的输出`corr.t`是 a `matrix`，您提到的“变量名”是矩阵的*行*名，可以使用`rownames()`.

要获得所需的输出，您只需执行以下操作：

```
data.frame(id = rownames(corr.t), val = c(t(corr.t))) 
```

一个更通用的解决方案 - 当您的矩阵不仅仅是一列时适用 - 将是：

```
data.frame(ID = rownames(your-matrix), 
           as.data.frame(your-matrix, 
                         row.names = 1:nrow(your-matrix))) 
```

最后一行，`row.names = 1:nrow(your-matrix)`，从输出中删除行名；它们不再需要，因为它们现在是您的数据框的一部分。

* * *

对于它的价值，您实际上并不需要专门转置您的数据来获得您想要的输出。这是一个示例，其中包含 R 可用的数据集之一，演示了您要实现的目标：

```
(mycor <- cor(swiss[, 1], swiss[, 2:5]))
#      Agriculture Examination  Education  Catholic
# [1,]   0.3530792  -0.6458827 -0.6637889 0.4636847

# Now, make it into a data.frame
data.frame(id = colnames(mycor), val = as.vector(mycor))
#            id        val
# 1 Agriculture  0.3530792
# 2 Examination -0.6458827
# 3   Education -0.6637889
# 4    Catholic  0.4636847 
```

# database - Using org-mode as a flat file database and sanitizing input

> ID：14734268
> 
> 赞同：5
> 
> 时间：2013-02-06T16:42:23.837
> 
> 标签：database, emacs, org-mode, bookmarks

I'd like to use an org-mode file as a flat file database that can be edited both programmatically and by hand. An example follows showing a list of bookmarks.

```
* Somebody's blog :: I like org-mode
:url: http://somebody.com/org
** Quotation 1
:date: 2013/01/13 08:32:11 EST
Very interesting observations here.
** Quotation 2
:date: 2013/01/13 08:33:46 EST
A marvelous code snippets

* Man bites dog
:url: http://newssite.com/today 
```

I'd like emacs or a webserver cgi-script or similar to edit such a file (in the example above, to add more bookmarks or more quotations to existing bookmarks).

The problem is when, e.g., accepting arbitrary selections from websites to insert under an org-mode heading, it becomes necessary to sanitize the input so that, at minimum, quoted lines starting with asterisks don't affect the file's structure: if a quotation starts with "* this is pathological example", and is inserted into the file under some heading, when I open the file in emacs, it'll appear as a new first-level (h1) heading.

How can I meet the twin goals of (i) an editable org-mode flat file database (this rules out escaping and all our XML tricks) and (ii) isolating arbitrary inputs?

*   anti-solution: #+BEGIN_QUOTE wouldn't work because lines starting with "* " are rendered as new headings.
*   possibility 1: box/rebox everything from the outside world: [http://www.emacswiki.org/emacs/BoxQuote](http://www.emacswiki.org/emacs/BoxQuote) this seems excessive though.

# soap - Cisco Unified Messenger SOAP (AXL) query, how to return all values?

> ID：14734271
> 
> 赞同：1
> 
> 时间：2013-02-06T16:42:38.260
> 
> 标签：soap, wsdl, cisco, cucm, cisco-axl

Using SOAP against CUCM's AXL web service, there are a number of query calls.
getLine getDeviceProfile getUser

and so on.

The WDSL shows:

```
 <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://www.cisco.com/AXL/API/8.5">
  <soapenv:Header/>
  <soapenv:Body>
    <ns:getDeviceProfile sequence="?">
      <!--You have a CHOICE of the next 2 items at this level-->
      <name>?</name>
      <uuid>?</uuid>
      <!--Optional:-->
      <returnedTags ctiid="?" uuid="?">
        <!--Optional:-->
        <name>?</name>
        <!--Optional:-->
        <description>?</description>
        <!--Optional:-->
        <product>?</product>
        <!--Optional:-->
        <model>?</model>
        <!--Optional:-->
        <class>?</class>
        <!--Optional:-->
        <protocol>?</protocol>
        <!--Optional:-->
        <protocolSide>?</protocolSide>
        <!--Optional:-->
        <userHoldMohAudioSourceId>?</userHoldMohAudioSourceId>
        <!--Optional:-->
        <vendorConfig>
          <!--You may enter ANY elements at this point-->
        </vendorConfig>
        <!--Optional:-->
        <versionStamp>?</versionStamp>
        <!--Optional:-->
        <traceFlag>?</traceFlag>
        <!--Optional:-->
        <mlppDomainId>?</mlppDomainId>
        <!--Optional:-->
        <mlppIndicationStatus>?</mlppIndicationStatus>
        <!--Optional:-->
        <preemption>?</preemption>
        <!--Optional:-->
        <lines>
          <!--You have a CHOICE of the next 2 items at this level-->
          <!--Zero or more repetitions:-->
          <line uuid="?" ctiid="?">
            <!--Optional:-->
            <index>?</index>
            <!--Optional:-->
            <label>?</label>
            <!--Optional:-->
            <asciiLabel>?</asciiLabel>
            <!--Optional:-->
            <display>?</display>
            <!--Optional:-->
            <dirn uuid="?">
              <!--Optional:-->
              <pattern>?</pattern>
              <!--Optional:-->
              <routePartitionName uuid="?">?</routePartitionName>
            </dirn>
            <!--Optional:-->
            <ringSetting>?</ringSetting>
            <!--Optional:-->
            <consecutiveRingSetting>?</consecutiveRingSetting>
            <!--Optional:-->
            <ringSettingIdlePickupAlert>?</ringSettingIdlePickupAlert>
            <!--Optional:-->
            <ringSettingActivePickupAlert>?</ringSettingActivePickupAlert>
            <!--Optional:-->
            <displayAscii>?</displayAscii>
            <!--Optional:-->
            <e164Mask>?</e164Mask>
            <!--Optional:-->
            <dialPlanWizardId>?</dialPlanWizardId>
            <!--Optional:-->
            <mwlPolicy>?</mwlPolicy>
            <!--Optional:-->
            <maxNumCalls>?</maxNumCalls>
            <!--Optional:-->
            <busyTrigger>?</busyTrigger>
            <!--Optional:-->
            <callInfoDisplay>
              <!--Optional:-->
              <callerName>?</callerName>
              <!--Optional:-->
              <callerNumber>?</callerNumber>
              <!--Optional:-->
              <redirectedNumber>?</redirectedNumber>
              <!--Optional:-->
              <dialedNumber>?</dialedNumber>
            </callInfoDisplay>
            <!--Optional:-->
            <recordingProfileName uuid="?">?</recordingProfileName>
            <!--Optional:-->
            <monitoringCssName uuid="?">?</monitoringCssName>
            <!--Optional:-->
            <recordingFlag>?</recordingFlag>
            <!--Optional:-->
            <audibleMwi>?</audibleMwi>
            <!--Optional:-->
            <speedDial>?</speedDial>
            <!--Optional:-->
            <partitionUsage>?</partitionUsage>
            <!--Optional:-->
            <associatedEndusers>
              <!--Zero or more repetitions:-->
              <enduser>
                <!--Optional:-->
                <userId>?</userId>
              </enduser>
            </associatedEndusers>
            <!--Optional:-->
            <missedCallLogging>?</missedCallLogging>
          </line>
          <!--Zero or more repetitions:-->
          <lineIdentifier>
            <!--Optional:-->
            <directoryNumber>?</directoryNumber>
            <!--Optional:-->
            <routePartitionName>?</routePartitionName>
          </lineIdentifier>
        </lines>
        <!--Optional:-->
        <numberOfButtons>?</numberOfButtons>
        <!--Optional:-->
        <phoneTemplateName uuid="?">?</phoneTemplateName>
        <!--Optional:-->
        <speeddials>
          <!--Zero or more repetitions:-->
          <speeddial>
            <!--Optional:-->
            <dirn>?</dirn>
            <!--Optional:-->
            <label>?</label>
            <!--Optional:-->
            <asciiLabel>?</asciiLabel>
            <!--Optional:-->
            <index>?</index>
          </speeddial>
        </speeddials>
        <!--Optional:-->
        <busyLampFields>
          <!--Zero or more repetitions:-->
          <busyLampField>
            <!--Optional:-->
            <blfDest>?</blfDest>
            <!--You have a CHOICE of the next 1 items at this level-->
            <!--Optional:-->
            <blfDirn>?</blfDirn>
            <!--Optional:-->
            <routePartition>?</routePartition>
            <!--Optional:-->
            <label>?</label>
            <!--Optional:-->
            <asciiLabel>?</asciiLabel>
            <!--Optional:-->
            <associatedBlfSdFeatures>
              <!--Zero or more repetitions:-->
              <feature>?</feature>
            </associatedBlfSdFeatures>
            <!--Optional:-->
            <index>?</index>
          </busyLampField>
        </busyLampFields>
        <!--Optional:-->
        <blfDirectedCallParks>
          <!--Zero or more repetitions:-->
          <blfDirectedCallPark>
            <!--Optional:-->
            <label>?</label>
            <!--You have a CHOICE of the next 2 items at this level-->
            <!--Optional:-->
            <directedCallParkId>?</directedCallParkId>
            <!--Optional:-->
            <directedCallParkDnAndPartition>
              <!--Optional:-->
              <dnPattern>?</dnPattern>
              <!--Optional:-->
              <routePartitionName uuid="?">?</routePartitionName>
            </directedCallParkDnAndPartition>
            <!--Optional:-->
            <labelAscii>?</labelAscii>
            <!--Optional:-->
            <index>?</index>
          </blfDirectedCallPark>
        </blfDirectedCallParks>
        <!--Optional:-->
        <addOnModules>
          <!--0 to 2 repetitions:-->
          <addOnModule uuid="?">
            <!--Optional:-->
            <loadInformation special="?">?</loadInformation>
            <!--Optional:-->
            <model>?</model>
            <!--Optional:-->
            <index>?</index>
          </addOnModule>
        </addOnModules>
        <!--Optional:-->
        <userlocale>?</userlocale>
        <!--Optional:-->
        <defaultProfileName>?</defaultProfileName>
        <!--Optional:-->
        <currentProfileName uuid="?">?</currentProfileName>
        <!--Optional:-->
        <loginTime>?</loginTime>
        <!--Optional:-->
        <loginDuration>?</loginDuration>
        <!--Optional:-->
        <singleButtonBarge>?</singleButtonBarge>
        <!--Optional:-->
        <joinAcrossLines>?</joinAcrossLines>
        <!--Optional:-->
        <loginUserId uuid="?">?</loginUserId>
        <!--Optional:-->
        <ignorePresentationIndicators>?</ignorePresentationIndicators>
        <!--Optional:-->
        <dndOption>?</dndOption>
        <!--Optional:-->
        <dndRingSetting>?</dndRingSetting>
        <!--Optional:-->
        <dndStatus>?</dndStatus>
        <!--Optional:-->
        <emccCallingSearchSpace uuid="?">?</emccCallingSearchSpace>
        <!--Optional:-->
        <alwaysUsePrimeLine>?</alwaysUsePrimeLine>
        <!--Optional:-->
        <alwaysUsePrimeLineForVoiceMessage>?</alwaysUsePrimeLineForVoiceMessage>
        <!--Optional:-->
        <softkeyTemplateName uuid="?">?</softkeyTemplateName>
        <!--Optional:-->
        <callInfoPrivacyStatus>?</callInfoPrivacyStatus>
        <!--Optional:-->
        <currentConfig>
          <!--Optional:-->
          <userHoldMohAudioSourceId>?</userHoldMohAudioSourceId>
          <!--Optional:-->
          <phoneTemplateName uuid="?">?</phoneTemplateName>
          <!--Optional:-->
          <mlppDomainId>?</mlppDomainId>
          <!--Optional:-->
          <mlppIndicationStatus>?</mlppIndicationStatus>
          <!--Optional:-->
          <preemption>?</preemption>
          <!--Optional:-->
          <softkeyTemplateName uuid="?">?</softkeyTemplateName>
          <!--Optional:-->
          <ignorePresentationIndicators>?</ignorePresentationIndicators>
          <!--Optional:-->
          <singleButtonBarge>?</singleButtonBarge>
          <!--Optional:-->
          <joinAcrossLines>?</joinAcrossLines>
          <!--Optional:-->
          <callInfoPrivacyStatus>?</callInfoPrivacyStatus>
          <!--Optional:-->
          <dndStatus>?</dndStatus>
          <!--Optional:-->
          <dndRingSetting>?</dndRingSetting>
          <!--Optional:-->
          <dndOption>?</dndOption>
          <!--Optional:-->
          <alwaysUsePrimeLine>?</alwaysUsePrimeLine>
          <!--Optional:-->
          <alwaysUsePrimeLineForVoiceMessage>?</alwaysUsePrimeLineForVoiceMessage>
          <!--Optional:-->
          <emccCallingSearchSpaceName uuid="?">?</emccCallingSearchSpaceName>
          <!--Optional:-->
          <deviceName>?</deviceName>
          <!--Optional:-->
          <model>?</model>
          <!--Optional:-->
          <product>?</product>
          <!--Optional:-->
          <deviceProtocol>?</deviceProtocol>
          <!--Optional:-->
          <class>?</class>
          <!--Optional:-->
          <addressMode>?</addressMode>
          <!--Optional:-->
          <allowAutoConfig>?</allowAutoConfig>
          <!--Optional:-->
          <remoteSrstOption>?</remoteSrstOption>
          <!--Optional:-->
          <remoteSrstIp>?</remoteSrstIp>
          <!--Optional:-->
          <remoteSrstPort>?</remoteSrstPort>
          <!--Optional:-->
          <remoteSipSrstIp>?</remoteSipSrstIp>
          <!--Optional:-->
          <remoteSipSrstPort>?</remoteSipSrstPort>
          <!--Optional:-->
          <geolocationInfo>?</geolocationInfo>
        </currentConfig>
        <!--Optional:-->
        <services>
          <!--Zero or more repetitions:-->
          <service uuid="?">
            <!--Optional:-->
            <telecasterServiceName uuid="?">?</telecasterServiceName>
            <!--Optional:-->
            <name>?</name>
            <!--Optional:-->
            <url>?</url>
            <!--Optional:-->
            <urlButtonIndex>?</urlButtonIndex>
            <!--Optional:-->
            <urlLabel>?</urlLabel>
            <!--Optional:-->
            <urlLabelAscii>?</urlLabelAscii>
            <!--Optional:-->
            <serviceNameAscii>?</serviceNameAscii>
            <!--Optional:-->
            <phoneService>?</phoneService>
            <!--Optional:-->
            <phoneServiceCategory>?</phoneServiceCategory>
            <!--Optional:-->
            <vendor>?</vendor>
            <!--Optional:-->
            <version>?</version>
            <!--Optional:-->
            <priority>?</priority>
          </service>
        </services>
        <!--Optional:-->
        <featureControlPolicy uuid="?">?</featureControlPolicy>
      </returnedTags>
    </ns:getDeviceProfile>
  </soapenv:Body>
</soapenv:Envelope> 
```

Now the `<returnedTags>` subtree controls what is returned. I was making some calls before and I was getting back all the values (Which is what I want) and then I went and made some changes (not sure what) and suddenly I started getting back only what I asked for.

Key for me is, what is the trick to get AXL to return all data it has on the object referenced, instead of explicitly listing them all in the request?

I.e. I would like a query as simple as:

```
 <soapenv:Envelope xmlns:ns="http://www.cisco.com/AXL/API/8.5" xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
  <soapenv:Header/>
  <soapenv:Body>
    <ns:getLine sequence="?">
      <uuid>{02CF73CE-140E-AD9A-9E0E-B56134636D71}</uuid>
      <returnedTags uuid="?"/>
    </ns:getLine>
  </soapenv:Body>
</soapenv:Envelope> 
```

And get back all the data populated on the Line. But if I just included an empty `<returnedTags/>` tag I get back nothing. If I list of empty nodes to show the attrs I want, I get back those explicit ones. So what do I send to get all attributes returned?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-16T14:14:48.860

虽然这个问题已经超过几个月了，但无论如何我都会试一试。最近我也参与了一个 cisco axl 项目。我还没有那么多经验，所以我可能错了。

我一直在处理 getPhone 和 getUser 请求（因为它们非常简单），我得到了一个完全填充的结果，查询很简单，如下所示：

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns="http://www.cisco.com/AXL/API/8.5">
   <soapenv:Header/>
   <soapenv:Body>
      <ns:getUser sequence="?">
         <!--You have a CHOICE of the next 2 items at this level-->
         <userid>ID</userid>
      </ns:getUser>
   </soapenv:Body>
</soapenv:Envelope> 
```

所以换句话说：也许你可以尝试从你的请求中删除。如 WSDL 所示，它是完全可选的。

# python - Slow defaultdict and mongoDB import from tab-delimited file. Can anyone spot my bottleneck?

> ID：14734272
> 
> 赞同：1
> 
> 时间：2013-02-06T16:42:38.967
> 
> 标签：python, mongodb, pymongo, defaultdict

So I'm trying to import about 80 million page views from a log file. I'm trying to put them in the database as sessions, i.e. groups of page views separated with 20 minutes in between.

So eventually, in my user database I would like each user to have a list of dictionary objects like so:

```
{
    'id': 'user1'
    'sessions':[
                    {
                        "start" : ISODate("2011-04-03T23:21:59.639Z"),
                        "end" : ISODate("2011-04-03T23:50:05.518Z"),
                        "page_loads" : 136
                    },
                    {
                        "start" : ISODate("another date"),
                        "end" : ISODate("later date"),
                        "page_loads" : 20
                    },
                ]
} 
```

Should be fairly simple. So I wrote this script:

```
howManyLinesTotal = 9999999 #i've done: wc -l in bash before to find the file size

blank_dict = {'page_loads':0, 'start':0, 'end':0}

latest_sessions = defaultdict(lambda: blank_dict)

for line in f: #opens a gigantic gzip file called "f"
    line = line.split('\t') #each entry is tab-delimited with: user \t datetime \t page_on_my_site

    user = line[1] #grab the data from this line in the file
    timestamp = datetime.utcfromtimestamp(float(line[2]))

    latest_sessions[user]['page_loads'] += 1 #add one to this user's current session

    if latest_sessions[user]['start'] == 0: #put in the start time if there isn't one
        latest_sessions[user]['start'] = timestamp

    if latest_sessions[user]['end'] == 0: #put in the end time if there isn't one
        latest_sessions[user]['end'] = timestamp
    else: #otherwise calculate if the new end time is 20 mins later
        diff = (timestamp - latest_sessions[user]['end']).seconds
        if diff > 1200: #if so, save the session to the database
            db.update({'id':user}, {'$push':{'sessions':latest_sessions[user]}})
            latest_sessions[user] = blank_dict
        else:
            latest_sessions[user]['end'] = timestamp #otherwise just replace this endtime

    count += 1
    if count % 100000 == 0: #output some nice stats every 100,000 lines
        print str(count) + '/' + str(howManyLinesTotal)

#now put the remaining last sessions in
for user in latest_sessions:
    db.update({'id':user}, {'$push':{'sessions':latest_sessions[user]}}) 
```

I'm getting about 0.002 seconds per line = 44 hours for an 80 million page view file.

This is with a 2TB 7200rpm seagate HDD, 32 GB of RAM and 3.4Ghz dualcore i3 processor.

Does this time sound reasonable or am I making some horrendous mistakes?

* * *

EDIT: We're looking at about 90,000+ users, i.e. keys in the defaultdict

* * *

EDIT2: Here's the cProfile output on a much smaller 106mb file. I commented out the actual mongoDB saves for testing purposes: [http://pastebin.com/4XGtvYWD](http://pastebin.com/4XGtvYWD)

* * *

EDIT3: Here's a barchart analysis of the cProfile: [http://i.imgur.com/K6pu6xx.png](http://i.imgur.com/K6pu6xx.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T17:27:42.540

我不能告诉你瓶颈在哪里，但我可以告诉你如何找到它。Python[内置了分析工具](http://docs.python.org/2/library/profile.html)，它会告诉你代码的每个部分花费了多少时间。将此工具用于脚本，就像运行一样简单：

```
python -m cProfile my_db_import_script.py 
```

`my_db_import_script.py`您的实际脚本的名称在哪里。此命令将执行的操作是运行附加了探查器的脚本。脚本完成后，它会打印出每个函数被调用了多少次，在它们里面总共花费了多少时间，以及累计，以及其他一些统计数据。

要将它与您的脚本一起使用，您需要处理可以在合理时间内完成的数据子集。从那里您将能够分析您发现的任何瓶颈。

优化代码的关键是永远不要假设您知道问题出在哪里。先测量，再测量。

***编辑：***

在浏览了您的个人资料结果后，这些是我印象深刻的几行：

```
ncalls  tottime  percall  cumtime  percall filename:lineno(function)

        1    0.000    0.000    0.000    0.000 gzip.py:149(_init_read)
        1    0.000    0.000    0.000    0.000 gzip.py:153(_read_gzip_header)
  2709407    5.543    0.000    8.898    0.000 gzip.py:200(read)
        2    0.000    0.000    0.000    0.000 gzip.py:23(read32)
  2242878    3.267    0.000    3.727    0.000 gzip.py:232(_unread)
   107984    0.266    0.000    3.310    0.000 gzip.py:237(_read)
        1    0.000    0.000    0.000    0.000 gzip.py:26(open)
   107979    0.322    0.000    1.258    0.000 gzip.py:287(_add_read_data)
        1    0.000    0.000    0.000    0.000 gzip.py:293(_read_eof)
        1    0.000    0.000    0.000    0.000 gzip.py:308(close)
        1    0.000    0.000    0.000    0.000 gzip.py:35(GzipFile)
  2242878    8.029    0.000   23.517    0.000 gzip.py:385(readline)
        1    0.000    0.000    0.000    0.000 gzip.py:4(<module>)
        1    0.000    0.000    0.000    0.000 gzip.py:434(__iter__)
  2242878    1.561    0.000   25.078    0.000 gzip.py:437(next)
        1    0.000    0.000    0.000    0.000 gzip.py:44(__init__)

  2242878    2.889    0.000    2.889    0.000 {built-in method utcfromtimestamp}
   107979    1.627    0.000    1.627    0.000 {built-in method decompress}
  2709408    1.451    0.000    1.451    0.000 {method 'find' of 'str' objects}
  2242880    1.849    0.000    1.849    0.000 {method 'split' of 'str' objects} 
```

您会注意到我已经突出显示了所有 gzip 代码。我对 gzip 模块不是很熟悉，所以我一直在查看[源代码](http://hg.python.org/cpython/file/2.7/Lib/gzip.py)。看起来这个模块正在做的是将普通文件（如接口）暴露给 gzip 数据。有几种方法可以加快速度。

1.  如果可行，您可以事先解压缩文件。这将摆脱 gzip 的一些开销。

2.  您可以开始优化文件的读取方式。[这是一个示例的链接](http://effbot.org/zone/readline-performance.htm)，该示例说明根据您一次读取的文件量，情况会如何不同。[在这个stackoverflow](https://stackoverflow.com/questions/5076024/in-python-is-read-or-readlines-faster)问题中也有一些很好的建议。

我还强调了转换时间戳会占用大量时间的事实，字符串操作函数也是如此。

归根结底，在这种规模上进行任何优化的最佳方法是运行基准测试，进行更改并重新运行。希望这是有启发性的！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T19:39:19.977

如果我正确理解 cProfile 输出，则瓶颈是 gzip 流阅读器。

列`cumtime`（“在函数上花费的时间，包括对其他函数的调用”）显示大约一半的运行时间（45.390 中的 25.078）花费在`gzip.py:437(next)`. 大部分时间都花在`gzip.py:385(readline)`.

不过，看起来磁盘 I/O 并不是瓶颈。更像是拆包逻辑本身。在使用常规 gzip 将其提供给程序之前尝试解压缩文件。注意 gzip 可以解压到标准输出；您的程序可以从标准输入读取它。

另一个消耗过多时间的函数是 utcfromtimestamp。如果可能，请尝试修改其逻辑。

试试这个：`gunzip gigantic_file.gz - | head -n 100000 > small_unpacked`，然后`small_unpacked`输入你的脚本，将它作为一个常规文件打开。再次配置文件。

# c++ - 如果另一个线程导致它在 Windows 上崩溃，我如何延迟销毁我的进程？

> ID：14734279
> 
> 赞同：0
> 
> 时间：2013-02-06T16:42:51.407
> 
> 标签：c++, multithreading, winapi

我正在编写一个 DLL，它由一个封闭源代码的专有程序加载，我无法控制。我还加载了一个同样晦涩难懂的专有 DLL。由于有时我必须通过我的 DLL 接口以非常低的延迟将命令中继到我加载的 DLL，因此我在初始化我的 DLL 时启动了一个单独的分离线程，并通过无锁队列向其发送未格式化的调试信息。因此，耗时的调试输出格式化和写入日志文件是异步完成的。问题是进程意外崩溃（我几乎可以肯定这不是我的错），而且我无法知道最后的调试信息是什么，因为我的分离线程在将其写入磁盘之前就被 Windows 杀死了。

所以这是我的问题：

*   如果专有程序崩溃以便我的分离线程在销毁之前运行更长时间，我可以以任何方式延迟销毁吗？
*   进程间通信会通过将我的分离线程移动到另一个 Windows 不会杀死的进程来解决我的问题吗？如果是这样，你会建议什么方法（我没有与 IPC 合作太多）
*   如果我使用 IPC，我如何知道何时终止我的“调试格式化过程”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:07:31.943

我认为即使使用 IPC，您也会遇到这样的情况：您的线程在进程故障期间可能有未写入的调试信息。大概你没有一直在进行调试，所以我认为你不需要一个单独的线程，只需要一个编译时或运行时选项来启用它。在终止之前，您可能可以完成`SetUnhandledExceptionFilter`该过程并做一些事情。

# python - 除非我指定路径，否则 Python IDLE 找不到文本文件

> ID：14734280
> 
> 赞同：2
> 
> 时间：2013-02-06T16:42:52.323
> 
> 标签：python, file

在我的 Python 书籍和 Python 文档中，这段代码应该足以打开一个文件：

```
f = open("file.txt", "r") 
```

但如果我这样做，我会收到一条错误消息，告诉我 file.txt 不存在。但是，如果我使用 file.txt 所在的整个路径，它会打开它：

```
 f = open("C:/Users/Me/Python/file.txt", "r") 
```

对此有解释吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T16:45:44.937

简而言之 - 直接搜索路径（当前工作目录）是 Python 将要查找的位置......（所以在 Windows 上 - 可能会假设 C:\Pythonxy）

是的，这取决于 Python/IDLE 的执行位置......它使用它的搜索路径：

```
>>> import os
>>> os.getcwd()
'/home/jon'

>>> open('testing.txt')
<open file 'testing.txt', mode 'r' at 0x7f86e140edb0> 
```

在 shell 中 - 更改目录...然后启动 Python/IDLE

```
jon@forseti:~$ cd /srv
jon@forseti:/srv$ idle

>>> import os
>>> os.getcwd()
'/srv'
>>> open('testing.txt')

Traceback (most recent call last):
  File "<pyshell#2>", line 1, in <module>
    open('testing.txt')
IOError: [Errno 2] No such file or directory: 'testing.txt' 
```

# windows-phone-7 - 从其他用户控件继承用户控件

> ID：14734290
> 
> 赞同：1
> 
> 时间：2013-02-06T16:43:20.337
> 
> 标签：windows-phone-7, windows-phone-8

我正在开发 Windows Phone 8 应用程序。希望有一些从特定用户控件继承的用户控件。我这样定义我的父用户控件：

公共抽象类 WidgetsUserControl : UserControl {

}

孩子喜欢：

公共部分类 childControl：WidgetsUserControl {

}

但它在定义抽象时出错，上面写着：“在声明类型'project1.WidgetsUserControl'时缺少部分修饰符；存在此类型的另一个部分声明”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:42:03.313

它抱怨您在 WidgetsUserControl 类的定义中没有“partial”关键字。您可能有一个 WidgetsUserControl 对应的 XAML 文件，该文件部分定义了该类，因此在这里，您需要指定它也部分定义。

```
public abstract partial class WidgetsUserControl : UserControl 
```

请注意，如果您朝着这个方向前进，那么您还需要使 childControl 定义保持一致。也就是说，在您将拥有的代码中：

```
public partial class childControl : WidgetsUserControl 
```

在 XAML 中，您还需要指定 childControl 是一个 WidgetsUserControl，而不仅仅是一个简单的 UserControl：

```
<project1:WidgetsUserControl>
</project1:WidgetsUserControl> 
```

虽然这会起作用，但您会遇到的一个问题是 Visual Studio 设计器会抱怨它无法创建 WidgetsUserControl 的实例（因为它是抽象的）。这使得可视化和编辑 childControl 有点困难。为了解决这个问题，我的建议是取消基础 WidgetsUserControl 中的“抽象”。如果您真的希望基类是抽象的，请参阅此处以获取其他建议：

[设计器中的抽象类](http://social.msdn.microsoft.com/Forums/en-US/winformsdesigner/thread/ddbc181f-dda4-48ba-94b3-194494c6b1e1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T11:43:05.590

```
This works good:
Code behind for parent user control:

    public abstract partial class WidgetsUserControl : UserControl {
        ...
        }

xaml for parent class:    
    <UserControl 
           ...
            xmlns:we="clr-namespace:project1"
            ...>

    </UserControl>

code behind for child user control:
    public partial class childControl : WidgetsUserControl {
    ...
    }

xaml for child user control:
    <we:WidgetsUserControl x:Class="project1.childControl"
       ...
        xmlns:we="clr-namespace:project1"
       ...>    
        <Grid x:Name="LayoutRoot" Background="{StaticResource PhoneChromeBrush}"></Grid>
    </we:WidgetsUserControl> 
```

# network-programming - 桌面应用程序是否需要 CAPTCHA？

> ID：14734295
> 
> 赞同：1
> 
> 时间：2013-02-06T16:43:29.297
> 
> 标签：network-programming, desktop-application, captcha

我正在为我们的大学编写一个**桌面应用程序。**用户在使用此软件之前需要*注册*，注册请求也会发送到我编写的服务器。所以我正在为某种网络应用程序而苦苦挣扎。（假设请求格式就像发送到任意端口号的 HTTP 请求一样简单）
但是现在我想知道是否有必要使用**CAPTCHA**保护注册过程？我是否需要确保注册请求不是由计算机生成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:59:53.603

由于您的申请是针对有限的用户组（仅限您的大学），我认为您**不需要**验证码，因为该组中的某人想要惹恼您的风险非常低。

此外，桌面应用程序的脚本（有点）比 Web 应用程序复杂，这也将降低风险。如果您正在为机器人注册而苦苦挣扎，您仍然可以将验证码作为更新发布，并且只接受更新版本的注册，不是吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:04:33.923

我认为这会激怒人类用户，我相信他们会成为你的所有用户。请注意，在网络上，只有一小部分用户是机器人。校园呢？校园里有多少台电脑需要担心？此外，所有这些计算机都由您认识的人监督，即使其中一台（甚至全部）安装了程序与您开玩笑，您也可以致电大学当局。所以如果我是你，我会把时间花在改善其他事情上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T20:26:58.907

不，您不需要 CAPTCHA。CAPTCHA 是由于 Web 浏览器施加的限制而制作的，同时仍希望网站提供广泛的可用性。您的应用程序没有这些限制。您的桌面应用程序可以实现它想要的任何安全方法，并且只需要分发给一组特定的客户端。

这并不意味着您不应该设置一些安全策略来阻止校园（或互联网）上的任何人远程登录到端口并创建帐户。这可以通过使用 PKI 并使用桌面应用程序分发唯一的私钥和公开的公钥来最容易地完成。然后，服务器可以在接受注册之前验证客户端是否拥有私钥（另外，您可以加密客户端/服务器之间的任何通信）。当然，任何有权访问桌面应用程序的人都可以获得私钥，但这至少比不做任何事情来证明他们可以注册帐户更安全。

# javascript - 防止 iframe 突破 HTML 5 / JS

> ID：14734296
> 
> 赞同：0
> 
> 时间：2013-02-06T16:43:32.237
> 
> 标签：javascript, html, iframe

我目前正在开发一个模仿 Firefox 响应式设计视图的行为和功能的 Chrome 扩展程序。

一切都快完成了，而且总体上运行良好。但是，如果可能的话，我遇到了一个我想规避的问题。我使用了一个`iframe`用户可以在大小等方面进行操作的工具，但是某些网站（包括 StackOverflow）不允许自己嵌入到 Frames 中（关于安全性的警告）。

有没有人有解决方案来防止这种行为？我不想为此使用服务器端代码。删除 iframe 以支持另一种方法也可以。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T16:45:29.493

这种行为不能被故意覆盖。如果一个站点声明它不想让自己被嵌入到框架中，那么你就无能为力了。

# php - PHP Soap Server : can't access to soap request parameters in my called class

> ID：14734297
> 
> 赞同：2
> 
> 时间：2013-02-06T16:43:34.880
> 
> 标签：php, soap, parameters

I can't access to parameters (thought everything seems to be fine, no error returned) :

```
<?php
// Class that is called by soap server handle function
class MyClass {
  // function that correspond to operation name in wsdl file
  public function MdBSpieGetInformationPasseport($myParam) {
  // This code is well executed

  // But how can i read here IDENTIFIANT parameter ?
  // It seems there's nothing in $myParam
  // I know i can read $HTTP_RAW_POST_DATA here 
  // but it should have been parsed automatically, no ?
  }
}

$server = new SoapServer('testWs.wsdl');
$server->setClass('MyClass');

$server->handle();
?> 
```

Here is the wsdl file (testWs.wsdl) :

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<wsdl:definitions xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" targetNamespace="wsTest" xmlns:spie="wsTest">

  <wsdl:types>
    <xsd:schema>
      <xsd:import schemaLocation="http://testws.local/?pg=xsd" namespace="wsTest" />
    </xsd:schema>
  </wsdl:types>

  <wsdl:message name="MdBSpieGetInformationPasseportInput">
    <wsdl:part element="spie:MdBSpieBovinRequest" name="parameters"/>
  </wsdl:message>

  <wsdl:message name="MdBSpieGetInformationPasseportOutput">
    <wsdl:part element="spie:MdBSpieGetInformationPasseportResponse" name="parameters"/>
  </wsdl:message>

  <wsdl:portType name="wsTestPortType">
    <wsdl:operation name="MdBSpieGetInformationPasseport">
      <wsdl:input message="spie:MdBSpieGetInformationPasseportInput"/>
      <wsdl:output message="spie:MdBSpieGetInformationPasseportOutput"/>
    </wsdl:operation>
  </wsdl:portType>

  <wsdl:binding name="wsTestBinding" type="spie:wsTestPortType">
    <soap:binding style="document" transport="http://schemas.xmlsoap.org/soap/http"/>
    <wsdl:operation name="MdBSpieGetInformationPasseport">
      <soap:operation soapAction="http://testWs.local/?pg=ws"/>
      <wsdl:input>
        <soap:body use="literal"/>
      </wsdl:input>
      <wsdl:output>
        <soap:body use="literal"/>
      </wsdl:output>
    </wsdl:operation>
  </wsdl:binding>

  <wsdl:service name="wsTest">
    <wsdl:port name="wsTestBinding" binding="spie:wsTestBinding">
      <soap:address location="http://testWs.local/?pg=ws" />
    </wsdl:port>
  </wsdl:service>

</wsdl:definitions> 
```

And the testWs.xsd file embedded :

```
<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:spie="wsTest" targetNamespace="wsTest" elementFormDefault="qualified">
   <xsd:element name="MdBSpieBovinRequest">
      <xsd:complexType>
         <xsd:sequence>
            <xsd:element name="Authentification" type="spie:typeAuthentificationRequest"/>
            <xsd:element name="Bovin" type="spie:typeBovinRequest"/>
         </xsd:sequence>
      </xsd:complexType>
   </xsd:element>

   <xsd:complexType name="typeAuthentificationRequest">
      <xsd:sequence>
         <xsd:element name="IDENTIFIANT">
            <xsd:simpleType>
               <xsd:restriction base="xsd:string">
                  <xsd:length value="20"/>
               </xsd:restriction>
            </xsd:simpleType>
         </xsd:element>
         <xsd:element name="MOT_DE_PASSE">
            <xsd:simpleType>
               <xsd:restriction base="xsd:string">
                  <xsd:maxLength value="12"/>
               </xsd:restriction>
            </xsd:simpleType>
         </xsd:element>
      </xsd:sequence>
   </xsd:complexType>

   <xsd:complexType name="typeBovinRequest">
      <xsd:sequence>
         <xsd:element name="CODE_PAYS">
            <xsd:simpleType>
               <xsd:restriction base="xsd:string">
                  <xsd:length value="2" />
               </xsd:restriction>
            </xsd:simpleType>
         </xsd:element>
         <xsd:element name="NUMERO_ANIMAL">
            <xsd:simpleType>
               <xsd:restriction base="xsd:string">
                  <xsd:maxLength value="12"/>
               </xsd:restriction>
            </xsd:simpleType>
         </xsd:element>
      </xsd:sequence>
   </xsd:complexType>

   <xsd:element name="MdBSpieGetInformationPasseportResponse">
      <xsd:complexType>
         <xsd:sequence>
            <xsd:element name="ReponseStandard" type="spie:typeReponseStandard"/>
            <xsd:element name="ReponseSpecifique" type="spie:typeReponseInformationPasseport" minOccurs="0"/>
         </xsd:sequence>
      </xsd:complexType>
   </xsd:element>

   <xsd:complexType name="typeReponseStandard">
      <xsd:sequence>
         <xsd:element name="Resultat" type="xsd:boolean"/>
         <xsd:element name="Anomalie" type="spie:typeAnomalie" minOccurs="0"/>
      </xsd:sequence>
   </xsd:complexType>

   <xsd:complexType name="typeAnomalie">
      <xsd:sequence>
         <xsd:element name="CODE_ANOMALIE">
            <xsd:simpleType>
               <xsd:restriction base="xsd:string">
                  <xsd:pattern value="/^9MdBSpie/"></xsd:pattern>
               </xsd:restriction>
            </xsd:simpleType>
         </xsd:element>
         <xsd:element name="SEVERITE_ANOMALIE" type="xsd:integer"/>
         <xsd:element name="MESSAGE_ANOMALIE" type="xsd:string"/>
      </xsd:sequence>
   </xsd:complexType>

   <xsd:complexType name="typeReponseInformationPasseport">
      <xsd:sequence>
         <xsd:element name="NUTRAV">
            <xsd:simpleType>
               <xsd:restriction base="xsd:string">
                  <xsd:length value="4"/>
               </xsd:restriction>
            </xsd:simpleType>
         </xsd:element>
         <xsd:element name="COPAIP">
            <xsd:simpleType>
               <xsd:restriction base="xsd:string">
                  <xsd:length value="2"/>
               </xsd:restriction>
            </xsd:simpleType>
         </xsd:element>
         <xsd:element name="NUNATI">
            <xsd:simpleType>
               <xsd:restriction base="xsd:string">
                  <xsd:maxLength value="12"/>
               </xsd:restriction>
            </xsd:simpleType>
         </xsd:element>
         <xsd:element name="SEXBOV" minOccurs="0">
            <xsd:simpleType>
               <xsd:restriction base="xsd:string">
                  <xsd:length value="1"/>
               </xsd:restriction>
            </xsd:simpleType>
         </xsd:element>
         <xsd:element name="CORABO" minOccurs="0">
            <xsd:simpleType>
               <xsd:restriction base="xsd:string">
                  <xsd:length value="2"/>
               </xsd:restriction>
            </xsd:simpleType>
         </xsd:element>
         <xsd:element name="DANAIS" type="xsd:date" minOccurs="0"/>
      </xsd:sequence>
   </xsd:complexType>

</xsd:schema> 
```

I use SoapUI to send soap request. Here is what i see in SoapUI request window :

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:wst="wsTest">
   <soapenv:Header/>
   <soapenv:Body>
      <wst:MdBSpieBovinRequest>
         <wst:Authentification>
            <wst:IDENTIFIANT>soapid</wst:IDENTIFIANT>
            <wst:MOT_DE_PASSE>soappasswd</wst:MOT_DE_PASSE>
         </wst:Authentification>
         <wst:Bovin>
            <wst:CODE_PAYS>soappays</wst:CODE_PAYS>
            <wst:NUMERO_ANIMAL>soapanimal</wst:NUMERO_ANIMAL>
         </wst:Bovin>
      </wst:MdBSpieBovinRequest>
   </soapenv:Body>
</soapenv:Envelope> 
```

Notice that wst: appeared and i don't know where it comes from. Is there an error in my sdl file ?

And in SoapUI response window :

```
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="wsTest">
   <SOAP-ENV:Body>
      <ns1:MdBSpieGetInformationPasseportResponse/>
   </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

Thank you for helping

PHP 5.3.9

EDIT : First error was in SoapServer instanciation ([http://www.php.net/manual/fr/soapserver.soapserver.php#102143](http://www.php.net/manual/fr/soapserver.soapserver.php#102143)) :

```
$server = new \SoapServer('http://myprojet.local?wsdl'); // correct 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T14:20:55.787

这是我的PHP，正在工作：

```
<?php
$client = new SoapClient("http://localhost/code/soap.wsdl");
$something =  $client->HelloWorld(array());
echo $something->HelloWorldResult;
die();

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-01T16:33:36.117

谢谢蒂埃里，

这是我按照您对我有用的建议使用的：

```
 $server = new SoapServer(null,array('uri' => $serviceURL)); 
```

问候，丹尼尔

# javascript - 将值插入模板AngularJS

> ID：14734301
> 
> 赞同：0
> 
> 时间：2013-02-06T16:43:44.400
> 
> 标签：javascript, html, angularjs

我有一个设置为 true/false 的标志，它改变了某些项目在页面上的显示方式。我在将值放入我的模板并让它实际工作时遇到了一些麻烦。普通的 HTML（不在模板内）可以正常工作。

```
restrict: 'E',
        scope: {
            speedDirection: "@",
            speedName: "@",
            value: "@",
            editElements: "="
        },
        template:
        '<div>'+
          '<p class="body-text">{{speedDirection}} '+
          '<input type="text" name="{{speedName}}" value="{{value}}" ng-show="editElements">'+
          '<span ng-hide="editElements">{{value}}</span>'+
          '</p>'+
        '</div>', 
```

我想使用 editElements 的动态模型值，而不仅仅是传递的值。这样，当它发生更改时，它将在显示的模板中反映更新。该变量在我存储测试数据的对象中定义：

```
function MyObject($scope) {
    $scope.editElements = true; 
```

有什么办法可以让它工作吗？我试过通过它（如上），使用“@”和 {{editElement}} 位等等。自定义 HTML 部分：

```
<speed-limit speed-direction="A to B:"
                    speed-name="reverse"
                    value="{{newObject.speedLimit[0]}}"
                    editElement="editElements">
                    </speed-limit> 
```

**更新：**我已经安装了 Batarang，它显示了我的自定义元素（速度限制）的特定部分具有“editElement：null”。但是，引用的其他区域 editElements 已正确设置。这是一些奇怪的范围问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:37:26.293

正如评论中所讨论的，属性名称可以使用相同的名称，但它必须是蛇形大小写，因此 edit-elements="editElements"：

```
<speed-limit speed-direction="A to B:"
     speed-name="reverse"
     value="{{newObject.speedLimit[0]}}"
     edit-elements="editElements">
</speed-limit> 
```

不要为此感到难过……我认为每个 Angular 开发人员都在这方面浪费了至少一个小时（或更多）的时间。

# sql - SQL: how to select only repeated values from same column?

> ID：14734302
> 
> 赞同：0
> 
> 时间：2013-02-06T16:43:46.403
> 
> 标签：sql

!!! there is a way to solve this problem using HAVING, but is there other simple way of doing it without use of HAVING ?

let's say I have a table t1 which has got two relations a and b.

```
-a  b
-1  2
-2  1
-3  4
-4  9
-8  5
-5  2
-6  5 
```

how do I print only the cases from column B that are repeating (in this case: 2 and 5)?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T16:51:25.093

如果您不想要`HAVING`子句，则可以使用子查询：

```
select t1.a, t1.b
from yourtable t1
inner join
(
  select count(*) tot, b
  from yourtable
  group by b
) t2
  on t1.b = t2.b
where t2.tot > 1 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/920b3/11)。

子查询将用于获取每个`b`值的计数。然后将结果连接到表中并过滤掉计数大于 1 的任何记录。

这给出了结果：

```
| A | B |
---------
| 1 | 2 |
| 8 | 5 |
| 5 | 2 |
| 6 | 5 | 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:36:05.570

除了已经很好的例子...... HAVING的例子：

```
SELECT * FROM 
(
 SELECT col_a t1
   FROM stack_test
 ) a,
 (
 SELECT col_b t2
   FROM stack_test
  GROUP BY col_b
  HAVING Count(*) > 1
 ) b
 WHERE t1 = t2
 /

 SQL>

  T1   T2
  -------
  2     2
  5     5 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:52:20.230

您可以使用聚合或联接来执行此操作。我更喜欢前者，但这里有一种方法：

```
select *
from t
where exists (select 1 from t t2 where t2.b = t.b and t2.a <> t.a) 
```

当然，这假设当`a`值相同时值不同`b`。

# php - 操作方法：根据用户的视图显示分类翻译

> ID：14734321
> 
> 赞同：0
> 
> 时间：2013-02-06T16:44:21.840
> 
> 标签：php, drupal, internationalization, drupal-7, drupal-views

我一直在试图弄清楚如何**根据当前用户的语言准确显示一组分类术语**。

我有：

*   安装了所有适当的模块（国际化、内容翻译、分类翻译、国际化视图等）
*   为每个分类术语设置翻译（英语/西班牙语）
*   通过“国际化视图”模块为“分类术语：语言”添加了过滤器。

不幸的是，它不会抛弃*西班牙语*条款。英语的工作正常。

任何有关如何使其工作或帮助的文章的链接都会有很大的帮助。

**提前致谢！！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T20:53:36.297

Since I don't have all of those installed and setup as well (and complete) as you do I decided to hunt around on forums. I found an article which seems like a similar problem to what you are having. The default language terms were always showing up in this post [Localize terms show always the default language](http://drupal.org/node/1070256).

Hopefully this post/article has some helpful information/steps on how to resolve this issue, check out post [13](http://drupal.org/node/1070256#comment-4454344) in that thread.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T15:48:01.510

这实际上可以通过国际化视图（[http://drupal.org/project/i18nviews](http://drupal.org/project/i18nviews)）来完成

我刚刚错误地配置了我的视图。这是一个很容易解决的疏忽。

我做了以下事情：

1.  创建分类词汇并将“多语言选项”设置为“翻译”。
2.  编辑每个条款并单击页面顶部的“翻译”选项卡。必须确保初始术语已选择“英语”作为语言。
3.  添加西班牙语翻译并保存
4.  创建了一个分类术语视图，该视图转储了每个术语名称
5.  将筛选条件之一设置为分类术语：语言（= 当前用户的语言）

中提琴。很容易。

# firefox - Firefox CSS3 转换不起作用

> ID：14734324
> 
> 赞同：3
> 
> 时间：2013-02-06T16:44:31.197
> 
> 标签：firefox, css, transition

[http://jsfiddle.net/Calum/5dqwJ/](http://jsfiddle.net/Calum/5dqwJ/)

CSS：

```
 textarea {
        height: 20px;
        margin: 20px;
        width: 585px;
        resize: none;
        overflow: hidden;
        vertical-align: top;
        transition: height 3s;
        -webkit-transition: height 3s;
        -moz-transition: height 3s;
        -o-transition: height 3s;
    } 
```

Javascript：

```
 $(document).ready(function () {

     $("textarea").focus(function (event) {
         if ($(this).val().length === 0) {
             $(this).height(100);
             $(this).css('resize', 'vertical');
             $(this).attr('placeholder', null);
         }
     });

     $("textarea").blur(function (event) {
         if ($(this).val().length === 0) {
             $(this).height(20);
             $(this).attr('placeholder', "Enter comment");
             $(this).css('resize', 'none');
         }
     });

 }); 
```

HTML：

```
<textarea placeholder='Enter comment'></textarea> 
```

在 Chrome、IE 和 Opera 中，当您关注 textarea 时，它会随着 CSS3 过渡而扩展和收缩。

当我对 FireFox 做同样的事情时，它不会为任何东西设置动画。

任何想法为什么？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:00:40.560

请参阅此页面了解转换

[https://developer.mozilla.org/en-US/docs/CSS/Tutorials/Using_CSS_transitions](https://developer.mozilla.org/en-US/docs/CSS/Tutorials/Using_CSS_transitions)

你可以完全通过 css 完成，无需使用 js

删除**$(this).height(20);** 和**$(this).height(100);** 从 JS 并将这个添加到 css

```
textarea:focus{
   height: 100px;    
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:02:06.127

好吧，--> [http://jsfiddle.net/FSEqT/](http://jsfiddle.net/FSEqT/)

```
textarea:focus {
height: 300px;
margin: 20px;
width: 585px;
resize: none;
overflow: hidden;
vertical-align: top;
}

textarea {
height: 200px;
margin: 20px;
width: 585px;

transition: height 3s;
-webkit-transition: height 3s;
-moz-transition: height 3s;
-o-transition: height 3s;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T17:11:33.407

如果`required`在 textarea 上添加属性，则可以使用[`:invalid`](https://developer.mozilla.org/en-US/docs/CSS/%3ainvalid)伪类来定位空的 textarea：

```
textarea {
    height: 100px;
    margin: 20px;
    width: 585px;
    resize: vertical;
    overflow: hidden;
    vertical-align: top;
    -webkit-transition: height .3s;
    -moz-transition: height .3s;
    -o-transition: height .3s;
    transition: height .3s;    
}

textarea:invalid{  /* single line*/
    height: 20px;
    resize: none;
}

textarea:focus{
    height: 100px;
    resize: vertical;
} 
```

[演示](http://jsfiddle.net/7YAVE)

（`box-shadow: none;`如果您不想要红色边框，请添加）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T16:59:42.857

您的代码中没有 css 转换。但是如果你想要它，下面的东西应该可以工作。只需在下面添加它`textarea {...}`。

```
textarea:hover {
  height: 100px;
} 
```

# php - 当 asp_tags = true 时，Netbeans 将无法识别 php 代码

> ID：14734328
> 
> 赞同：0
> 
> 时间：2013-02-06T16:44:44.540
> 
> 标签：php, netbeans

我已经在我的 PHP 配置中打开了[asp_tags](http://www.php.net/manual/en/ini.core.php#ini.asp-tags)，所以现在我可以像这样回显代码：

```
<body>
    <h1><%= $this->headerText %></h1>
</body> 
```

但是 Netbeans IDE 不会语法高亮或自动完成`<%`块中的任何内容。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:07:48.420

除了在 php.ini 中打开设置，您还应该在 netbeans 项目设置中打开它。

# https - 当运行提琴手 Outlook 停止工作时，我该如何解决这个问题？

> ID：14734329
> 
> 赞同：12
> 
> 时间：2013-02-06T16:44:45.320
> 
> 标签：https, outlook, fiddler

所以在我们的办公室里，我们一直遇到这个问题，当你提琴手时，Outlook 会断开连接。我们尝试了一些东西，但没有任何效果。有任何想法吗？

并且不要发布指向讨论此[https://groups.google.com/forum/?fromgroups=#!topic/httpfiddler/j5ojJ0s6KGg](https://groups.google.com/forum/?fromgroups=#!topic/httpfiddler/j5ojJ0s6KGg)的 google 组的链接， 这不起作用。因此，任何其他建议将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-06T18:18:24.620

工具->提琴手选项->HTTPS 我的同事将组合框更改为...仅来自浏览器。到目前为止，它似乎有效，但这可能最终不起作用。因此，任何有意见的人都会受到赞赏。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-03-18T09:45:17.957

我发现解决它的最佳方法是使用 Fiddler（具有讽刺意味的是）查看它需要哪些主机才能工作（即不断重新连接并添加它连接到的任何主机），直到它不再抛出错误，只需将它们保留在“跳过解密”框。对我来说，在这台计算机上，这有效：

```
snt405-m.hotmail.com
hotmail.com
outlook.office365.com 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2020-04-14T13:51:00.700

当我遇到这个问题时，我遇到了这个问题。我正在使用 Outlook for Office 365 并跳过 Outlook 连接到的主机的解密对我不起作用 - Outlook 在尝试连接时卡住了。对我有用的是在工具>选项>连接下将以下条目添加到“绕过Fiddler以获取以：开头的URL”：

```
*office.com; *office365.com; *live.com 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-06-29T02:08:57.667

这个列表大部分都有效，因为我在开发 API 时不能只对浏览器使用过滤器。

Fiddler -> 工具 -> 选项 -> HTTPS -> 跳过解密

在开发计算机上时，这些应排除 Teams / Outlook。如果您需要任何有问题的域，请小心。

```
*.microsoft.com;
*.msn.com;
*.outlook.com;
*.live.com;
*.office.com;
*.office.net;
*.office365.com;
*.skype.com; 
```

# c# - Modelstate 总是抱怨无效的日期时间

> ID：14734337
> 
> 赞同：1
> 
> 时间：2013-02-06T16:45:13.813
> 
> 标签：c#, asp.net-mvc, modelstate

我已在模型的属性之一中添加了此数据注释

```
 [DataType(DataType.Date), DisplayFormat(DataFormatString = "{0:dd/MM/yyyy}", ApplyFormatInEditMode = true)]
    public DateTime? LastLoginDate { get; set; } 
```

但是，每当我从编辑模式保存数据时，如果日期大于 12，模型状态总是说日期无效。

例如，

2012 年 1 月 12 日（有效） 2012 年 12 月 31 日（无效）

如何更正此问题，以便模型状态将 31/12/2012 识别为有效。

# r - 用于 CRAN 包的 Sonatype Nexus 代理？

> ID：14734339
> 
> 赞同：10
> 
> 时间：2013-02-06T16:45:22.730
> 
> 标签：r, nexus, cran, sonatype

我们的组织使用 Sonatype Nexus 来管理工件，无论它们是我们开发的内部托管的东西，还是像 Apache 或类似的其他存储库的代理。大多数东西都是基于 JAR 的。

我的小组在 R 中完成了大部分工作，我们想知道 1) 将我们的内部代码部署为 Nexus 中的 R 包，以及 2) 在 Nexus 中创建一个 CRAN 镜像的代理是否有意义。我想这需要一些胶水代码，但我对 Nexus 不是很满意，所以我不确定那会是什么样子。理想情况下，它可以让我们通过直接点击 Nexus 来安装 R 包，而不是先下载然后手动安装。

有人有建议或先例吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2018-03-09T07:52:40.680

由于 Sonatype 采用了下面提到的社区插件，因此默认安装中提供了对 CRAN 的 NXRM 3.20.0 支持。

对于较旧的 NXRM 版本，Nexus 社区有一个[插件](http://exchange.sonatype.com/details?extension=5135491292)，增加了对 CRAN 存储库的支持。你可以在[GitHub 上](https://github.com/sonatype-nexus-community/nexus-repository-r)找到它来自己安装。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-02-10T19:18:28.293

Nexus 现在从 3.20 版开始原生支持 R 包

查看发行说明：[https ://help.sonatype.com/repomanager3/formats/r-repositories#RRepositories-RRepositoryGroups](https://help.sonatype.com/repomanager3/formats/r-repositories#RRepositories-RRepositoryGroups)

我能够以相同的自动化创建 R 存储库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T20:10:12.397

将您的内部压缩包放在一个（如果您愿意，仅限内部）URL 上，然后您可以将[devtools](https://github.com/hadley/devtools) :: [install_url](https://github.com/hadley/devtools/blob/master/R/install-url.r)函数指向该 URL，怎么样？

# php - MongoDB 上的 PHP

> ID：14734343
> 
> 赞同：4
> 
> 时间：2013-02-06T16:45:29.437
> 
> 标签：php, mongodb, mongodb-php

我是使用 php 处理 MongoDB 的初学者。

我正在使用 Windows 8（64 位）、PHP 5.4.3、PHP Extension Build API20100525、TS、VC9 和 mongodb-win32-x86_64-2.2.2。

我尝试从 [https://github.com/mongodb/mongo-php-driver/downloads安装 mongodb 驱动程序](https://github.com/mongodb/mongo-php-driver/downloads)

下载第一个包，包内有10个驱动文件。我尝试了最后四个能够支持 php 5.4 的驱动程序中的每一个然后找到 php.ini 文件并将给定的相应行与驱动程序名称一起包含在内。（例如：extension=php_mongo-1.3.2RC1-5.4-vc9-x86_64.dll）

但他们都没有回应我。我尝试了以下示例代码来评估它们。

```
<?php

// connect
$m = new MongoClient();

// select a database
$db = $m->test;

// select a collection (analogous to a relational database's table)
$collection = $db->shafny;

// add a record
$document = array( "name" => "Anderson", "age" => 22 );
$collection->insert($document);

// find everything in the collection
$cursor = $collection->find();

// iterate through the results
foreach ($cursor as $document) {
echo $document["name"] . "\n";
}

?> 
```

我收到一条错误消息，

**致命错误：在第 5 行的 C:\Wamp\www\Mongo\test.php 中找不到类 'MongoClient'**

我希望由于缺少正确安装驱动程序而引发了这个未知的类错误。所以请任何人指导我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:56:51.643

如果您使用的是 WAMP，则应编辑 C:\wamp\bin\apache 的 bin 文件夹或 WAMP Apache PHP.ini 文件所在位置的 PHP.ini 文件。或者，如果您使用单独安装的 Apache，请编辑其 PHP.ini。我认为您已经编辑了 PHP 文件夹中的 PHP.ini。

# java - 在不重新编译实现类的情况下更改接口

> ID：14734345
> 
> 赞同：7
> 
> 时间：2013-02-06T16:45:33.963
> 
> 标签：java, exception, undefined-behavior, throws

我有以下课程

```
public abstract interface X 
{
    public abstract void f() throws java.io.IOException;
}

public class Y implements X 
{
    public void f() throws java.io.IOException 
    {
        throw new java.ioIOException("Hello");
    }

    public static void main(String [] args)
    {
        X x = new Y();
        try
        {
            x.f();
        }
        catch (IOException e)
        {
            System.out.println("Caught");
        }
    }

} 
```

现在我编译两者并得到`X.class`and `Y.class`。

现在我更改 X 以删除投掷

```
public abstract interface X 
{
    public abstract void f();
} 
```

显然，如果我重新编译 X 和 Y，Y 的编译将失败

```
Y.java:4: f() in Y cannot implement f() in X; overridden method does not throw j
ava.io.IOException 
```

但是，我只需要重新编译 X.java 并保留使用旧 X.java 编译的 Y.class。

在这种情况下会发生什么 - 它是否明确定义？

或者它是否属于未定义的类别 - 即任何事情都可能发生？

是否有任何保证 - 即，如果我总是在 Windows 下的 Java 1.6.32 下运行它，我能指望没有任何不好的事情发生吗？

更新：更新它是因为一些答案说我会`IncompatibleClassChangeError`在运行时得到一个。但我没有。

脚步

1) 如上所述编译 X.java 和 Y.java。运行 Y。

输出：被抓住

2) 更改 X.java 以注释掉抛出。重新编译 X.java。**不要**重新编译 Y.java。

运行 Y

输出：被抓住

我在 Windows 7 上运行 java

编译器

```
javac 1.6.0_35 
```

运行

```
java version "1.6.0_35"
Java(TM) SE Runtime Environment (build 1.6.0_35-b10)
Java HotSpot(TM) Client VM (build 20.10-b01, mixed mode, sharing) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T16:52:05.767

这是目前 Java 中的一个限制。创建一个扩展您当前接口的子接口，并在您确实需要时无例外地覆盖该方法。一般来说，这被称为“二进制更改”，并在代码运行时导致链接断开，并且在 JLS 中有明确的定义（有一整章，[JLS 13](http://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html)，您特别想要[JLS 13.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html#jls-13.5)）。

**编辑：**经过进一步调查，事实证明我错了。从[JLS 13.4.21 开始](http://docs.oracle.com/javase/specs/jls/se7/html/jls-13.html#jls-13.4.21)：

> 对方法或构造函数子句的更改`throws`不会破坏与预先存在的二进制文件的兼容性；这些子句仅在编译时检查。

但是，我仍然建议不要这样做，因为这意味着已检查的异常基本上可以在运行时变为未检查。

# c# - 使用 Linq 查询计算符合条件的孙元素

> ID：14734348
> 
> 赞同：0
> 
> 时间：2013-02-06T16:45:39.763
> 
> 标签：c#, lambda, linq-to-entities, entity-framework-5

我正在尝试确定当前用户是否对`ProjectDoc`. 此查询给我一个值 1。`ProjectDocVote`表中没有与`UserID`. `ViewBag.CurrentUserID`值是正确的。

```
 var count = Model.Project.ProjectDoc
       .Where(a => a.Current == true && a.DocType == "Cover")
       .Select(v => v.ProjectDocVote
              .SingleOrDefault(u => u.UserID == ViewBag.CurrentUserID)
       )
       .Count(); 
```

如何修复此查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:48:33.797

将`Select`和`SingleOrDefault`替换为`Any`：

```
var hasVoted = Model.Project.ProjectDoc
                    .Where(a => a.Current == true && a.DocType == "Cover")
                    .Any(v => v.ProjectDocVote
                               .Any(u => u.UserID == ViewBag.CurrentUserID)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:51:36.210

```
var count = Model.Project.ProjectDoc
   .Where(a => a.Current == true 
            && a.DocType == "Cover"
            && a.ProjectDocVote.Any(v => v.UserID == ViewBag.CurrentUserID))
   .Count(): 
```

# windows - QtConcurrent::run() 导致 QWaitCondition 销毁消息

> ID：14734352
> 
> 赞同：1
> 
> 时间：2013-02-06T16:45:54.090
> 
> 标签：windows, multithreading, qt

我正在尝试使用 QtConcurrent::run() 方法运行一个类的函数。线程运行并完全按照它应该的方式运行。但是，当线程结束时，我在控制台中收到此错误消息：

```
QWaitCondition: Destroyed while threads are still waiting 
```

它在 Linux 上运行良好，没有任何错误消息，但是当我关闭应用程序时，应用程序在 Windows 中崩溃

这是main函数的代码：

```
 int main(int argc, char *argv[])
    {
        QtSingleApplication a(argc, argv);

        if(a.isRunning()&&argc==2)
        {
            a.sendMessage(argv[1]);
            return 0;
        }

        else if (a.isRunning())
        {
              return 0;
        }

        testApp w;

        testApp.show();

        a.setQuitOnLastWindowClosed(false);
        if(argc==2)
        {
            w.showDialog(argv[1]);
        }

        QObject::connect(&a, SIGNAL(messageReceived(const QString&)),
                         &w, SLOT(showDialog(QString)));

        return a.exec();
    } 
```

**编辑：**

```
void MyClass::ready()
{
 QtConcurrent::run (this,&MyClass::start);
}

void MyClass::start()
{

  // do something
} 
```

# asp.net - GridView：排序列，显示/隐藏列

> ID：14734354
> 
> 赞同：0
> 
> 时间：2013-02-06T16:46:04.100
> 
> 标签：asp.net, vb.net-2010

好的...所以我正在尝试使用 GridView 显示我的数据库中的表中的数据。我需要更改列的显示顺序，并且需要根据用户浏览网站的语言（法语或英语）显示/隐藏某些列。

到目前为止，在我的代码中我有这个。数据通过数据源加载。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    LoadS25ATransactionsData()

End Sub

Private Sub LoadS25ATransactionsData()

    gvS25ATransactions.Visible = True
    gvS25ATransactions.DataSource = ViewS25A.GetS25ATransactions
    gvS25ATransactions.DataBind()

End Sub 
```

我尝试了很多方法来更改列的顺序并隐藏和显示其他但无济于事。请帮忙！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:05:50.430

您可以使用 GridView.Columns[0] 按索引隐藏列或按名称隐藏列，如下例所示。

```
<asp:GridView runat="server" ID="GridView1" 
   AutoGenerateColumns="False" OnPreRender="GridView_PreRender">
    <Columns>
        <asp:BoundField DataField="LastName" HeaderText="LastName" />
        <asp:BoundField DataField="FirstName" HeaderText="FirstName" />
    </Columns>
</asp:GridView>

protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
        var users = new List<User>
            {
                new User {FirstName = "John", LastName = "Doe"},
                new User {FirstName = "Marry", LastName = "Newton"},
                new User {FirstName = "Joe", LastName = "Black"}
            };

        GridView1.DataSource = users;
        GridView1.DataBind();
    }
}

protected void GridView_PreRender(object sender, EventArgs e)
{
    foreach (DataControlField column in GridView1.Columns)
        if (column.HeaderText == "FirstName")
            column.Visible = false;
} 
```

# php - PHP - PDO - Oracle - LONG - 数据太大而无法缓冲，截断以适应

> ID：14734361
> 
> 赞同：1
> 
> 时间：2013-02-06T16:46:26.660
> 
> 标签：php, oracle, pdo

我在 Oracle 中使用 PDO，当我尝试在“LONG”类型的列上使用“fetchAll”时，如果里面的数据超过 512 个字符，则会出现以下警告：

> 警告：PDOStatement::fetchAll() [pdostatement.fetchall]: 列 X 数据对于缓冲区来说太大，被截断以适合第 69 行的 (...)

PHP 版本 5.2.17 Oracle 版本：11g PDO 驱动程序：oci

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-07T13:15:56.210

我有一个类似的问题。选定的列之一是 oracle 时间戳数据类型，因此在我的情况下，帮助使用定义的日期格式封装此列，例如如下所示：

`SELECT TO_CHAR(column_name, 'YY/MM/DD HH24:MI:SS') as column_name FROM table`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:00:21.157

详细信息：即出现问题的列。在 varchar2( X ) 中，X = 所需大小。示例：从表中选择 cast(name_column AS varchar2(70))作为昵称；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-10-02T18:42:31.320

我在 2020 年使用 PHP 7.2 和最新版本的 PHP PDO OCI 库时仍然遇到这个问题。我的解决方案是改用 oci_connect，并使用它来拉长字段。

我发现一个很好的参考是使用：[https ://www.oracle.com/technical-resources/articles/fuecks-lobs.html](https://www.oracle.com/technical-resources/articles/fuecks-lobs.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-30T19:29:39.043

我有同样的问题，但在我的情况下，数据类型是 varchar。问题是我使用 varchar(3) 来存储诸如“NÃO”之类的东西。由于 'Ã' 使用超过 1 个字节来存储，所以当我尝试 fetchAll 时，我收到了相同的警告。

检查您存储的数值是否大于 Long 的大小。在 Oracle 中更改列的大小。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2019-04-05T05:27:55.297

你必须在oracle中改变varchar的大小，例如：如果你需要50个字符的另一个符号，你必须写

```
varchar2(100) 
```

在模型 yii 中你必须写`length 100`

# android - 活动对话框主题

> ID：14734364
> 
> 赞同：0
> 
> 时间：2013-02-06T16:46:39.723
> 
> 标签：android, android-activity, dialog

我正在创建一个 Android 小部件。我的小部件有一个视图，单击它会打开一个`Activity`看起来像`Dialog`.

我已经更新`AndroidManifest.xml`了这个活动的样式，就像一个对话框。

```
<activity 
    android:name=".Widget.Widget_OeffneDialog" 
    android:theme="@android:style/Theme.Dialog">
</activity> 
```

这太棒了。

现在我从这个小部件打开应用程序并单击主页按钮（应用程序现在在后台），然后单击对话框显示的 wdget - 但应用程序的其余部分显示在对话框后面。

像这儿： ![在此处输入图像描述](../Images/cf8613ef9427608a0b8b2be784e444fd.png)

我不想在对话框活动下方看到上一个活动 - 我该怎么做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T22:00:37.780

当您从启动器启动 Widget_OeffneDialog 活动时，Android 只是恢复当前在后台的实例 - 以及它包含的任何 backstack 和历史记录。

尝试强制您的小部件启动活动的新实例。

```
Intent intent = new Intent(this, A.class);
intent.setFlag(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(intent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:42:33.847

为此使用 Theme.Translucent。半透明主题不会使背景中的应用程序/视图变暗。请注意，半透明主题不使用动画，因此您可能需要更改它。这是来自 Android 源代码的主题 XML：

```
 <style name="Theme.Translucent">
    <item name="android:windowBackground">@android:color/transparent</item>
    <item name="android:colorBackgroundCacheHint">@null</item>
    <item name="android:windowIsTranslucent">true</item>
    <!-- Note that we use the base animation style here (that is no
         animations) because we really have no idea how this kind of
         activity will be used. -->
    <item name="android:windowAnimationStyle">@android:style/Animation</item>
</style> 
```

# android - 无法在 Eclipse 中安装 .apk 文件。为什么？

> ID：14734367
> 
> 赞同：-1
> 
> 时间：2013-02-06T16:46:51.520
> 
> 标签：android, device

我想在手机上运行程序。我的程序已运行，但是当我运行另一个程序时，Eclipse 在控制台选项卡中写入错误。为什么？问题出在哪里？

我用谷歌搜索，但找不到解决方案。我关闭Eclipse并再次打开，我关闭手机并再次打开，我在任务管理器等中结束adb，但Eclipse无法运行程序:(

```
Failed to install ServiceTutorial.apk on device '0A3C202B1601A00A': An existing connection was forcibly closed by the remote host
java.io.IOException: An existing connection was forcibly closed by the remote host
 Launch canceled! 
```

请帮我。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:49:34.933

确保 ：

*   您在 Android 设备的设置中将 USB 调试设置为“开启”
*   您的设备已在操作系统的设备管理器中注册
*   为您的设备安装了正确的 ADB 驱动程序。
*   您正在为在您的设备（或更早版本）上运行的 android 版本构建

如果它仍然不接受 .APK，请确保手动删除任何可能仍在运行或无法通过 Eclipse 从设备中删除的旧版本的 apk。

作为最后的手段，请尝试删除对您设备的 adb 引用，然后创建一个新设备。

# vbscript - VBScript MsgBox 总是报告错误。我需要在计算机上安装什么库？

> ID：14734368
> 
> 赞同：0
> 
> 时间：2013-02-06T16:46:51.407
> 
> 标签：vbscript

我试图让我的 VBScript 报告消息框中单击按钮的正确值。

```
intAnswer =  Msgbox("Enter Data", _
        4, "Answer")
msgbox(intAnswer)
If intAnswer = 6 Then
    Msgbox "You answered yes."
ElseIf intAnswer = 7 Then
    Msgbox "You answered no."
ElseIf intAnswer = 2 Then
    MsgBox "Cancelled."
End If 
```

但是，首先`msgbox(intAnswer)`总是报告“错误”。它从来不是我期望的 VBScript 常量，所以我从来没有得到任何 If Then Else 语句。

我已经尝试过`vbYesNo`，而不仅仅是`4`. 我认为他们的常量定义可能不在服务器上，但这没关系。

我究竟做错了什么？我怎样才能让我的`msgbox`反应保持不变？

编辑：这是一个在命令行上运行的 vbscript 一个 .vbs 文件（或从资源管理器中双击它）。

编辑：我已经尝试过，但在这种情况下`cint(intanswer)`我得到相同的结果为零。`0`

**编辑：进一步的测试表明它只发生在服务器上。本地机器工作正常。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:20:53.647

我发现了多余的代码。这是一个简单的错误。删除它。一切都很好。

# datacontext - 如何在 Breezejs 中使用 DataContexts？

> ID：14734370
> 
> 赞同：1
> 
> 时间：2013-02-06T16:46:56.233
> 
> 标签：datacontext, breeze

在我的应用程序计划中，有一个中央缓存模块。在这个模块中有我所说的上下文，大约有 20 个。每个 Context 都管理自己的一组我称之为 Inject 的对象（可能是 Breeze 所称的 Entities），这些对象保存应用程序中特定函数使用的值。每个上下文就像包装缓存模块内的自己的较小数据库。

我的主要问题是 Breeze 教程讨论了包装自己的 EntityManager 的 DataContext，它似乎与我的 Context 相似，但除了简短提及之外，我无法提供更多信息。DataContext 是 Breeze API 中的一个概念还是一个实际对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T04:01:32.113

Jay 正在谈论 .NET 中的服务器端。也许您在谈论客户端 JavaScript？如果是这样，请继续阅读；如果不是......坚持杰的回答。

在我们的客户端 JavaScript 应用程序中，我们经常编写一个模块，将 ViewModel 与 Breeze 隔离开来`EntityManager`。在一个示例中，这样的模块可能称为“dataservice.js”；它可以在另一个示例中称为“datacontext.js”。概念是相同的：您尝试封装数据访问细节（其中涉及 BreezeJS 组件，例如`EntityManager`），以便 ViewModel 使用更简单、更有意的接口。

这些 JS 模块不是 Breeze 的一部分。它们只是构建应用程序的推荐方法。

您可以根据需要编写尽可能多的这些“数据上下文”。每个都可以有自己的`EntityManager`实例，该实例缓存自己的一组实体，如果您愿意，您可以将该缓存视为“较小的 [内存] 数据库”。这种针对不同工作流程的“上下文化”在商业应用程序中非常常见。例如，您会看到我们谈论“沙盒编辑器”；每个沙箱都是它自己的“上下文”。

您经常需要将实体从一个“上下文”复制到另一个（而不是往返于服务器）。`EntityManager.exportEntities`使用and`EntityManager.importEntities`方法很容易做到这一点。您可以在**DocCode 示例中找到示例**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T20:43:18.687

Breeze 目前提供了两种包装“概念”上下文的服务器端实现。EFContextProvider用于包装 EF DbContext 或 ObjectContext，以及**可**用于包装任何对象集合的基本**ContextProvider 。**在微风示例 zip 中有一个名为“NoDb”的示例，它显示了如何使用 ContextProvider 来简单地包装可查询对象的集合。这两个类在 Breeze 下载页面上的任何 zip 中的 Breeze.WebApi 项目中都可用。

同样，NoDb 示例和相关文档应该使这个概念更加清晰。

# c# - C# 反射属性顺序

> ID：14734374
> 
> 赞同：3
> 
> 时间：2013-02-06T16:47:10.817
> 
> 标签：c#, reflection

我正在使用[https://stackoverflow.com/a/531388/528131](https://stackoverflow.com/a/531388/528131)中的代码从基础成功检索对象实例的所有属性，问题是派生类型的属性首先被迭代。由于协议的性质，我首先需要基本属性。

```
x |
y | B
z |
w | A 
```

B 和 A 是类，B 派生自 A。x、y、z 是 B 的属性，w 是 A 的属性

这是 A.GetProperties(); 的方案。正在返回。我需要这个：

```
w | A
x |
y | B
z | 
```

有什么方法可以完全按照该顺序获取字段？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-06T16:49:59.747

类型中的字段不是“有序的”。这些方法中项目的顺序是一个实现细节，强烈建议不要依赖它们。

您应该自己订购这些项目，并期望它们可以从任何位置开始，以确保您的程序是健壮的而不是脆弱的。

由于可以向每个属性询问声明它的类型，因此您可以在开始时创建一个查找，为层次结构中的每个类提供一个编号，从您开始的类型一直到`object`通过遍历`BaseType`属性`Type`并按顺序排列每个属性的声明类型的查找值：

```
public static IEnumerable<PropertyInfo> GetOrderedProperties(Type type)
{
    Dictionary<Type, int> lookup = new Dictionary<Type, int>();

    int count = 0;
    lookup[type] = count++;
    Type parent = type.BaseType;
    while (parent != null)
    {
        lookup[parent] = count;
        count++;
        parent = parent.BaseType;
    }

    return type.GetProperties()
        .OrderByDescending(prop => lookup[prop.DeclaringType]);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T16:54:25.700

反射子系统的文档说您不能依赖返回元素的顺序。

也就是说，根据我的经验，元素是按照源文件中的声明顺序返回的。在 Mono 或 .NET 的未来版本中，这可能是真的，也可能不是。

尽管有上述情况，如果您希望继续，您最好的选择是使用该`BindingFlags.DeclaredOnly`选项并手动遍历继承层次结构（在子类型之前扫描基本类型以使它们以正确的顺序排列）。您应该以这样一种方式编写代码，即单个声明类型的属性排序无关紧要（例如，按名称排序）；如果 .NET 框架的行为发生变化，这将使您的代码更加健壮。

[Fasterflect](http://fasterflect.codeplex.com)这样做（主要是为了能够过滤掉已被覆盖的虚拟属性）。它还具有帮助器来获取属性，无论是否过滤，使用它自己的和更强大的`Flags`选择器参数。

如果单个类型中元素的顺序不重要，您可以像这样获得列表（使用 Fasterflect）：

```
var properties = type.Properties().Reverse().ToList(); 
```

您应该知道，当以这种方式反映时（通过遍历并仅获取声明的属性），将包含多次覆盖的属性。Fasterflect 提供了从结果中过滤这些的选项：

```
var properties = type.Properties( Flags.InstancePublic | Flags.ExcludeBackingMembers ).Reverse().ToList(); 
```

如果您不想依赖该库，代码是开源的，因此您可以选择您需要的部分。可以在[这里看到](http://fasterflect.codeplex.com/SourceControl/changeset/view/41eae592599b#Fasterflect/Fasterflect/Extensions/Core/PropertyExtensions.cs)遍历算法（第 443 行）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-01-08T14:18:49.730

您所要做的就是通过声明类型进行分组并反转列表

```
 var publicProperties = typeof(T).GetProperties()
                .GroupBy(p => p.DeclaringType)
                .Reverse()
                .SelectMany(g => g)
                .ToArray(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T17:07:49.093

作为排序的替代方法：

```
PropertyInfo[] properties = type.GetProperties(...);
Array.Sort(properties, (pi1, pi2) =>
    {
        if (pi1.DeclaringType.IsSubclassOf(pi2.DeclaringType))
           return 1;
        else if  (pi2.DeclaringType.IsSubclassOf(pi1.DeclaringType))
            return -1;
        else
            return 0;
    }); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-02-06T16:59:19.433

您可以从 of 的实例中获取声明类型，`PropertyInfo`并按其与 的距离排序`Object`。

我会这样做：

```
void Main()
{
    typeof(B).GetProperties()
    .Select((x,i) => new {
        Prop = x,
        DeclareOrder = i,
        InheritanceOrder = GetDepth(x.DeclaringType),
    })
    .OrderByDescending(x => x.InheritanceOrder)
    .ThenBy(x => x.DeclareOrder)
    .Dump();
}

public class A
{
    public string W {get; set;}
}

public class B : A
{
    public string X {get; set;}
    public string Y {get; set;}
    public string Z {get; set;}
}

static int GetDepth(Type t)
{
    int depth = 0;
    while (t != null)
    {
        depth++;
        t = t.BaseType;
    }
    return depth;
} 
```

# heroku - 邪恶的PDF +fonts+heroku+rails3.2

> ID：14734375
> 
> 赞同：11
> 
> 时间：2013-02-06T16:47:11.757
> 
> 标签：heroku, fonts, ruby-on-rails-3.2, wicked-pdf

我使用[wicked_pdf](http://rubygems.org/gems/wicked_pdf)和 rails 3.2.11 和 ruby​​ 1.9.3 从 HTML 生成 PDF 并部署到 Heroku。

我的 pdf.css.scss.erb：

```
<% app_fullhost = Constants["app_fullhost"] %>

@font-face {
  font-family:'DosisMedium'; font-style:normal; font-weight:500;
  src: url(<%=app_fullhost%>/app/font/dosis/Dosis-Medium.ttf) format('woff');
}

*, body {
  font-family: "DosisLight", 'Times New Roman', 'Arial', sans-serif;
} 
```

确切的主机在哪里`app_fullhost`，在开发或生产中。

我的 pdf 布局包括：

```
%html{:lang => I18n.locale}
  %head
    %meta{:charset => "utf-8"}
    %title= content_for?(:title) ? yield(:title) : Settings.app_name
    = wicked_pdf_stylesheet_link_tag "pdf" 
```

在 production.rb 我有

```
config.assets.precompile +=%w(pdf.css) 
```

这在开发中没有问题，但在 Heroku 上，pdf 文件没有加载所需的字体。我还尝试了不同的解决方案，例如在 production.rb 中添加这些：

```
config.assets.paths << "#{Rails.root}/app/assets/fonts"
config.assets.precompile += %w(*.svg *.eot *.woff *.ttf) 
config.assets.precompile += %w(.svg .eot .woff .ttf) 
```

我也尝试改变（在 pdf.css.scss.erb 中）：

```
@font-face {
  font-family:'Dosis'; font-style:normal; font-weight:500;
  src: url('Dosis-Medium.ttf') format('woff');
} 
```

或者

```
@font-face {
  font-family:'Dosis'; font-style:normal; font-weight:500;
  src: url(<%= asset_path('Dosis-Medium.ttf')%>) format('woff');
} 
```

Heroku 上的字体 in`assets/fonts`和 in`public/app/font/dosis`和 url 正确响应：

```
..//myapp/app/font/dosis/Dosis-Medium.ttf" and 
..//myapp/assets/Dosis-Medium.ttf 
```

如何让字体加载到 Heroku？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-07-18T00:33:18.727

`wkhtmltopdf`，底层程序`wicked_pdf`，在通过 CSS 加载字体时是出了名的时髦。在某些系统上，它使用绝对路径，有时它需要相对路径。即使您正确获取了路径，它也可能会因不准确的 CSS 减速等而被抛出。仅在 SO 上就有很多关于此的问题。

我发现的最好、最灵活和最便携的解决方案是对您尝试使用的字体进行 Base64 编码，并将其直接包含到 CSS 文件中：

```
@font-face {
    font-family: 'OpenSans';
    src: url(data:font/truetype;charset=utf-8;base64,AAEAAAATAQA...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-06-18T18:45:49.883

我遇到了这个问题并遵循了 Arman H 概述的建议 - 我将字体转换为 base 64 并直接在 CSS/SCSS 文件中引用它。我遵循的其余步骤与原始问题中概述的步骤非常相似。

我在这里汇总了完整的描述（带有指向源代码的 github 链接）：http: [//apleroy.com/posts/custom-pdf-fonts-with-wicked_pdf-and-heroku](http://apleroy.com/posts/custom-pdf-fonts-with-wicked_pdf-and-heroku)

首先，我在字体目录中引用了字体。

```
<%# /fonts/custom_fonts.css.scss.erb %>
@font-face {
    font-family: "SourceSansPro-Light";
    src: url('<%= asset_path("SourceSansPro-Light.otf") %>');
} 
```

然后，为了对字体进行 base 64 编码，我使用了这个网站（已经在上面的评论中提到）：[http](http://www.opinionatedgeek.com/dotnet/tools/base64encode/) ://www.opinionatedgeek.com/dotnet/tools/base64encode/ 。base-64 编码输出是一个随机字符串，由数百行字母数字字符组成。我将此输出复制到新的 pdf.css.scss 文件中：

```
<%# /stylesheets/pdf.css.scss %>
@font-face {
  font-family: 'Source Sans Pro Light';
  src: url(data:font/truetype;charset=utf-8;base64,T1RUTw-----THIS IS HUNDREDS OF LINES LONG -------sGAnBSvO7nBqXQ==)
} 
```

在实际的 html 页面（转换为 PDF）中，我使用 wicked_pdf 样式表标签进行了引用 - 如原始问题中所述：

```
<%# views/pdf_pages/show.html.erb %>
<meta charset='utf-8' />
<%= wicked_pdf_stylesheet_link_tag "pdf" %> 
```

最后，我预编译了 pdf 样式表，以便将其包含在资产管道中，以便在 Heroku 上部署：

```
#application.rb
config.assets.precompile += ['pdf.css'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-08T20:22:21.007

让我看看我是否有这个权利：

服务器 1：构建 PDF，需要字体，然后从 URL 中提取它们这在 dev 本地工作，但在 heroku 上不工作。

日志中有什么东西吗？（你看到字体的 http 请求了吗？）

你说它没有加载正确的字体。它会爆炸，还是只是渲染好像它从未加载过字体（例如，字体获取上的 404）。

如果您不从heroku 中提取字体文件，这是否有效？（例如使用 aws 或来自另一个 URL 的其他字体作为测试）

您是否从当前正在运行的同一服务器进程中提取？您是否有多个 dyno 或多个 unicorn 进程可以处理当前进程（构建 pdf）和传入请求（提供字体文件）

我见过人们只运行一个测功机，但尝试运行两个 http 事件并遇到问题。如果您只有一个测功机（您没有另外提及），请添加另一个并查看会发生什么，或者添加另一个独角兽进程。

# c# - 在 XNA 中的 DrawableGameComponent 中获取窗口大小

> ID：14734379
> 
> 赞同：0
> 
> 时间：2013-02-06T16:47:25.267
> 
> 标签：c#, xna

我有一个`Avatar`继承自的对象`Microsoft.Xna.Framework.DrawableGameComponent`

我尝试在`Update`我的`Avatar`. 但我没有找到任何方法来获取窗口的宽度和高度。

该方法`GraphicsDeviceManager.DefaultBackBufferHeight`到目前为止不起作用。

我的构造函数：

```
 public Avatar(Game game)
        : base(game)
    {
        // TODO: Construct any child components here
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:50:21.967

尝试[`game.Window`](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.game_members.aspx)窗口。该类[`GameWindow`](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.gamewindow_members.aspx)有`ClientBounds`您正在寻找的成员。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T16:54:13.647

`Viewport`您可以使用这些属性获取活动的宽度和高度。

```
this.GraphicsDevice.Viewport.Width
this.GraphicsDevice.Viewport.Height 
```

默认情况下，活动`Viewport`将是整个窗口。

# macos - Mac OSX Mountain Lion 上的 SDL 1.3 构建错误

> ID：14734385
> 
> 赞同：0
> 
> 时间：2013-02-06T16:47:53.077
> 
> 标签：macos, build, sdl, osx-mountain-lion, llvm-gcc

我需要将 SDL 1.3 用于我想要开始工作的项目，但我在编译它时遇到问题。这是终端输出： http: [//pastebin.com/Ucq6fkfj](http://pastebin.com/Ucq6fkfj)

[我之前遇到了与此](https://stackoverflow.com/questions/7169981/compiling-sdl-from-source-on-a-mac-running-os-x-10-7-lion)问题中提到的相同的问题，并使用了它的答案。我有 Xcode 4.5.2 并且最近更新了我的 Xcode 命令行工具。我有 gcc 版本`i686-apple-darwin11-llvm-gcc-4.2`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T09:04:34.230

很可能您需要安装 X11 头文件。我最近在 OSX 中构建 SDL 没有问题，但遇到了这个。

检查这个（我的项目 wiki - OSX 第 3 点）： [http ://www.indielib.com/wiki/index.php?title=Building_IndieLib](http://www.indielib.com/wiki/index.php?title=Building_IndieLib)

而这个： [https://github.com/Themaister/RetroArch/wiki/Compilation-guide-(OS-X)](https://github.com/Themaister/RetroArch/wiki/Compilation-guide-%28OS-X%29)

禁用组装也会影响性能，所以我不推荐它。我使用 ./configure 没有禁用程序集。

# github - 如何使用 github deploy 在 Appharbor 中托管站点？

> ID：14734386
> 
> 赞同：1
> 
> 时间：2013-02-06T16:47:59.437
> 
> 标签：github, appharbor

我在 AppHarbor 中部署了一个 github 应用程序，AppHarbor 在它们之间建立了桥梁，但它不起作用。当我访问我的应用程序的主机名（[http://cesarmvcapp.apphb.com/](http://cesarmvcapp.apphb.com/)）时，它只显示文本“欢迎使用 nginx！”。我需要做什么才能使其工作？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:19:33.000

您是否检查过应用程序仪表板以确认已收到或部署任何构建？仪表板在这里：[https ://appharbor.com/applications/cesarmvcapp](https://appharbor.com/applications/cesarmvcapp)

您可能必须推送到 GitHub 才能构建任何东西。或者考虑再次运行设置流程。

# ios - 自定义委托有问题

> ID：14734390
> 
> 赞同：1
> 
> 时间：2013-02-06T16:48:05.373
> 
> 标签：ios, objective-c

我正在尝试实现一个简单的委托，但似乎遇到了一些问题。预期的结果是用户按下`UIView`链接到`UIViewController`via的按钮`Outlet`。我也使用`UISearchBarDelegate`which 工作得很好。我只是在调用我的自定义委托方法时遇到问题。

主视图控制器.h：

```
#import <UIKit/UIKit.h>
#import "CategoryFilterView.h"

@interface MainViewController : UIViewController <UISearchBarDelegate, catFilterDelegate>

@property (strong, nonatomic) IBOutlet UIView *switchViewOutlet;

// Instance Methods
- (void)searchBarLoad;

@end 
```

主视图控制器.m：

```
#import "MainViewController.h"

@interface MainViewController ()

@end

@implementation MainViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.

    CategoryFilterView *temp = [[CategoryFilterView alloc] initWithFrame:CGRectMake(0, 0, 320, 50)];
    temp.delegate = self;
    self.switchViewOutlet = temp;
    [self.view addSubview:self.switchViewOutlet];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)searchBarLoad {
    UISearchBar *search = [[UISearchBar alloc] initWithFrame:CGRectMake(0, 0, 320, 50)];
    search.delegate = self;
    search.showsCancelButton = YES;

    self.switchViewOutlet = search;
    [self.view addSubview:self.switchViewOutlet];

}

- (void)searchBarCancelButtonClicked:(UISearchBar *)searchBar {
    [self.switchViewOutlet removeFromSuperview];
    CategoryFilterView *temp = [[CategoryFilterView alloc] initWithFrame:CGRectMake(0, 0, 320, 50)];
    temp.delegate = self;
    self.switchViewOutlet = temp;
    [self.view addSubview:self.switchViewOutlet];
}

- (void)searchPressed {
    // Custom Delegate Method
    NSLog(@"Test"); // This is never called
    [self.switchViewOutlet removeFromSuperview];
    [self searchBarLoad];
}

@end 
```

CategoryFilterView.h：

```
#import <UIKit/UIKit.h>

@protocol catFilterDelegate <NSObject>

- (void)searchPressed;

@end

@interface CategoryFilterView : UIView

// Button Outlets
@property (strong, nonatomic) IBOutlet UIButton *byMeButtonOutlet; // Linked in .xib
@property (strong, nonatomic) IBOutlet UIButton *byFriendsButtonOutlet; // Linked in .xib
@property (strong, nonatomic) IBOutlet UIButton *searchButtonOutlet; // Linked in .xib

// Delegate
@property (assign, nonatomic) id<catFilterDelegate> delegate;

// Button Actions
- (IBAction)searchPressAction:(id)sender; // Linked with UIButton from .xib file

@end 
```

CategoryFilterView.m:

```
#import "CategoryFilterView.h"

@implementation CategoryFilterView

- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        // Initialization code        
        NSArray *subviewArray = [[NSBundle mainBundle] loadNibNamed:@"CategoryFilterView" owner:self options:nil];
        UIView *mainView = [subviewArray objectAtIndex:0];
        [self addSubview:mainView];    }
    return self;
}

- (IBAction)searchPressAction:(id)sender {
    NSLog(@"Test"); // This gets called when the user presses the button from MainViewController
    [self.delegate searchPressed];
}
@end 
```

如果需要，我可以提供更多信息。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:52:45.237

查看您的委托是否响应您尝试调用的选择器是一个好习惯。

我建议使用以下代码调用它：

```
if([self.delegate respondsToSelector:@selector(searchPressed)])
{
    NSLog(@"My delegate is not nil");
    [self.delegate searchPressed];
} 
```

这将告诉您您的委托是否设置正确。一个很大的可能性是您的委托是 nil，但是如果您在 nil 对象上调用选择器，它不会崩溃但不会做任何事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T18:01:22.337

我不确定你是如何设置的，但这对我有用。在 CategoryFilterView.xib 中，我用一个按钮创建了一个视图，该按钮连接到 CategoryFilterView.m 文件中的 IBAction searchPressAction:。我删除了该文件中的初始化代码（因此唯一的代码是该操作方法）。我在 CategoryFilterView xib 中设置 MainViewController 文件的所有者。然后在 MainViewController 中，我有这段代码来添加子视图：

```
- (void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];
    self.subviewArray = [[NSBundle mainBundle] loadNibNamed:@"CategoryFilterView" owner:self options:nil];
    UIView *mainView = [self.subviewArray objectAtIndex:0];
    CategoryFilterView *temp = (CategoryFilterView *)mainView;
    temp.delegate = self;
    self.switchViewOutlet = temp;
    [self.view addSubview:self.switchViewOutlet];
} 
```

您必须向 searchBarCancelButtonClicked: 方法添加类似的代码才能再次获取视图。

**编辑后：**

我不清楚您是否需要使用委托。如果您使 MainViewController 成为 nib 中视图的文件所有者，那么您可以将该视图中的任何按钮直接连接到 MainViewController.m 中的 IBActions，而无需使用委托。在这种情况下，您也不需要对该视图进行子类化——它可以只是一个 UIView。

# pdf - PDF 字段库

> ID：14734391
> 
> 赞同：-2
> 
> 时间：2013-02-06T16:48:14.097
> 
> 标签：pdf, libraries

是否有任何 JavaScript 库（或任何语言库）能够获取带有开放字段的 PDF 并用值填充它们？

# 编辑

由于这个问题似乎获得了负面反馈，我将进一步澄清我的需求。我希望能够拥有一个允许用户上传 PDF 的网络表单。获得 PDF 后，我想找到可编辑的字段并将它们与数据库中的信息一起输入。

我主要是在寻找一个能够读取 PDF 中的字段并更改它们的库。我见过[iText](http://itextpdf.com/)，但它并不是真的那么免费，而且支持似乎很不稳定（阅读：昂贵）。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T22:06:47.707

由于没有人知道该怎么做，这是我的解决方案（如果您正在开发 node.js 应用程序，这可能是最好的解决方案）。

[使用此库](https://github.com/countable/js-fdf)将数据库中的数据写入 .fdf 格式。FDF 文件是一种以 Adob​​e 友好格式存储数据的方式。

[生成之后，您可以使用PDFtk](http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/)命令行工具将 FDF 和 PDF 文件合并为一个合并的 PDF 。

PDFtk 的语法如下所示：

```
pdftk example.pdf fill_form formatted-data.fdf output merged.pdf 
```

完成后，您可以上传更改后的 .pdf。不客气，随机阅读此文的人。我花了一段时间才弄清楚所以希望这篇文章能节省你的时间。

# php - 如何在我的网站上以可读格式显示 Facebook 事件的 PHP UTC 时间戳？

> ID：14734392
> 
> 赞同：1
> 
> 时间：2013-02-06T16:48:14.740
> 
> 标签：php, facebook, events, timestamp, utc

我创建了这个页面[http://www.islandstreet.co.uk/events/](http://www.islandstreet.co.uk/events/)，它使用 Facebook API 从 Facebook 检索我的活动详细信息并将它们显示在我的网站上。

我需要解决的问题是日期显示为 UTC 时间戳。我似乎无法将它们转换为人类可读的格式，例如“2013 年 2 月 21 日星期四晚上 7 点”。

我并不完全了解 PHP，并且一直在使用教程来做到这一点。

这是我正在使用的代码；

```
<?php
//we have to set timezone to California
date_default_timezone_set('Europe/London');

//requiring FB PHP SDK
require 'facebook.php';

//initializing keys
$facebook = new Facebook(array(
    'appId'  => 'xxx',
    'secret' => 'xxx',
    'cookie' => true, // enable optional cookie support
));

//just a heading
echo "";
echo "";
echo "";
echo "";

//query the events
//we will select name, start_time, end_time, location, description this time
//but there are other data that you can get on the event table     (https://developers.facebook.com/docs/reference/fql/event/)
//as you've noticed, we have TWO select statement here
//since we can't just do "WHERE creator = your_fan_page_id".
//only eid is indexable in the event table, sow we have to retrieve
//list of events by eids
//and this was achieved by selecting all eid from
//event_member table where the uid is the id of your fanpage.
//*yes, you fanpage automatically becomes an event_member
//once it creates an event
$fql    =   "SELECT name, pic, start_time, end_time, location, description 
            FROM event WHERE eid IN ( SELECT eid FROM event_member WHERE uid = 163579547024154 ) 
            ORDER BY start_time asc";

$param  =   array(
'method'    => 'fql.query',
'query'     => $fql,
'callback'  => ''
);

$fqlResult   =   $facebook->api($param);

//looping through retrieved data
foreach( $fqlResult as $keys => $values ){
    //see here http://php.net/manual/en/function.date.php for the date format I used
    //The pattern string I used 'l, F d, Y g:i a'
    //will output something like this: July 30, 2015 6:30 pm

    //getting 'start' and 'end' date,
    //'l, F d, Y' pattern string will give us
    //something like: Thursday, July 30, 2015
    $start_date = date($values['start_time']);
    $end_date = date($values['end_time']);

    //getting 'start' and 'end' time
    //'g:i a' will give us something
    //like 6:30 pm

    //printing the data
    echo "<div class='event'>";
    echo "<div style='float: left; margin: 0 8px 0 0;'>";
        echo "<img src={$values['pic']} />";
    echo "</div>";
    echo "<div style='float: left;'>";
        echo "<div style='font-size: 26px'>{$values['name']}</div>";
        if( $start_date == $end_date ){
            //if $start_date and $end_date is the same
            //it means the event will happen on the same day
            //so we will have a format something like:
            //July 30, 2015 - 6:30 pm to 9:30 pm
            echo "<div>{$start_date}</div><div>{$start_time}</div>";
        }else{
            //else if $start_date and $end_date is NOT the equal
            //it means that the event will will be
           //extended to another day
           //so we will have a format something like:
           //July 30, 2013 9:00 pm to Wednesday, July 31, 2013 at 1:00 am
           echo "<div>on {$start_date}</div><div> {$start_time}</div>";
        }
        echo "<div>Location: " . $values['location'] . "</div>";
        echo "<div>More Info: " . $values['description'] . "</div>";
    echo "</div>";
    echo "<div style='clear: both'></div>";
    echo "</div>";

}

?>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js">
</script>
<script type='text/javascript'>
//just to add some hover effects
$(document).ready(function(){

$('.event').hover(
    function () {
        $(this).css('background-color', '#CFF');
    }, 
    function () {
        $(this).css('background-color', '#E3E3E3');
    }
);

});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:51:12.270

date 和 mktime 是你的朋友，这里是示例[http://www.anchorx.com/ali/2013/02/06/php-date-format-example/](http://www.anchorx.com/ali/2013/02/06/php-date-format-example/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:52:08.343

在 PHP 中，该`date()`函数接受两个参数，格式和时间戳。

```
string date ( string $format [, int $timestamp = time() ] ) 
```

因此，您将使用以下代码输出星期几（星期日至星期六）、月份（1 月至 12 月）、日期（1-31）、年份（2013）、字母`a`和`t`小时（12小时时钟）和`am`或`pm`：

```
 $start_date = date('l, F d, Y \a\t ga', $values['start_time']); 
```

[PHP 手册 - 日期参考](http://www.php.net/manual/en/function.date.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:52:59.743

```
// Format: Thursday 21st February 2013 at 7pm
date("l jS F Y \a\\t ga", $values['start_time']); 
```

[看到它在行动](http://codepad.viper-7.com/et9VsO)

# java - 如何在 Java 中更改部分 XML 属性？

> ID：14734396
> 
> 赞同：0
> 
> 时间：2013-02-06T16:48:36.300
> 
> 标签：java, xml, xml-parsing

我正在使用 org.w3c.dom 类进行大量 XML 解析/转换。

我有两个属性：“长度”和“验证”。

我已经解析了 XML 文档，在 Node 对象中有两个属性（例如 Node nodeLengthAttr = attr.getNamedItem("length");）

我想搜索“验证”属性并使用 .setTextContext 或类似方法在特定点输入长度值。所以验证将是“一些文本+长度+一些测试”。

我基本上想将属性视为字符串，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:06:00.993

听起来像一个

```
import org.w3c.dom;
//...
Attr attrValidation = (Attr)attr.getNamedItem("validation");
String value = attrValidation.getValue();
//Modify the string
//...
attrValidation.setValue(value); 
```

就是你要找的。没有更多的上下文很难说。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:06:07.603

如果您确定，您的`Node`实例是一个元素，请将其转换为`org.w3c.dom-Element`.

*   然后用于`Element.getAttribute()`获取属性值作为`String`.
*   创建修改后的字符串。
*   用 设置修改后的字符串`Element.setAttribute()`。

例子：

```
if(node instanceof Element) {
  Element el = (Element) node;
  String s = el.getAttribute("validation");
  String modified = ...
  el.setAttribute("validation", modified);
} 
```

# android - 在布局中添加图像

> ID：14734397
> 
> 赞同：0
> 
> 时间：2013-02-06T16:48:39.707
> 
> 标签：android, image, imageview

我想在现有布局中添加图像。我使用以下代码片段创建图像：http: [//www.inter-fuser.com/2009/12/android-reflections-with-bitmaps.html](http://www.inter-fuser.com/2009/12/android-reflections-with-bitmaps.html)

这个类创建一个带有正确图像的 ImageView。我想在这个布局中添加图像：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <include
        android:id="@+id/actionbar_back"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        layout="@layout/actionbar_back" />

    <LinearLayout
        android:id="@+id/ll_ueberschrift"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:background="@color/gray" 
        android:gravity="center"
        android:layout_below="@id/actionbar_back" >

        <TextView
            android:id="@+id/tv_ueberschrift"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Java" 
            android:layout_gravity="right" 
            android:textSize="30sp" />       
    </LinearLayout>

        <!--  ListRow Left sied Thumbnail image -->

    <LinearLayout
        android:id="@+id/ll_thumbnail" 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:padding="3dip"      
        android:layout_alignParentLeft="true"
        android:layout_marginRight="5dip"
        android:layout_marginTop="20dp"
        android:layout_below="@id/ll_ueberschrift" >

        <ImageView
            android:id="@+id/iv_objekt"
            android:contentDescription="@string/description"
            android:layout_width="120sp"
            android:layout_height="120sp"
            android:paddingLeft="5dp" />
    </LinearLayout>
<RelativeLayout> 
```

现在我尝试将图像添加到现有的 ImageView：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

   ...

   //Create an Image view and add our bitmap with reflection to it
   ImageView imageView = new ImageView(this);
   imageView.setImageBitmap(bitmapWithReflection);
   imageView.setPadding(5, 5, 5, 5);

    View linearLayout =  findViewById(R.id.ll_picture_and_reflection);
    ((LinearLayout) linearLayout).addView(imageView);
    setContentView(R.layout.objekt_einzeln); 
} 
```

但我只是得到“NullPointerException”。

有什么建议该怎么做或有什么不正确的吗？非常感谢

编辑：我的意思是“查看 linearLayout = findViewById(R.id.iv_objekt);”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:52:26.523

`setContentView`在您尝试引用 LinearLayout 之后，您正在执行此操作。做这个：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.objekt_einzeln); 

   //Create an Image view and add our bitmap with reflection to it
   ImageView imageView = new ImageView(this);
   imageView.setImageBitmap(bitmapWithReflection);
   imageView.setPadding(5, 5, 5, 5);

    View linearLayout =  findViewById(R.id.ll_picture_and_reflection);
    ((LinearLayout) linearLayout).addView(imageView);

} 
```

但即便如此，您所引用的 a`LinearLayout`不在您提供的 XML 中。

确保你先做`setContentView`，然后确保`LinearLayout`它实际上在你提供的布局中`setContentView`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:52:51.020

只需调用 setContentView(R.layout.objekt_einzeln); 在开始，然后设置图像视图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:53:24.317

`R.id.ll_picture_and_reflection`您指定的布局中不存在该 ID 。你的意思是`R.id.ll_thumbnail`？

`setContentView`在尝试和引用布局中的任何元素之前，您还需要使用。

# javascript - 自定义节点常量

> ID：14734401
> 
> 赞同：0
> 
> 时间：2013-02-06T16:48:53.487
> 
> 标签：javascript, node.js

在 Node JS 中有一个 __dirname 常量。

我可以用相同的形式定义自己的常量吗？

例如：

__根

或者

__myCrazyConstant

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:49:41.560

无论它包含多少个下划线，您都可以使用您想要的任何名称创建一个变量。

`const`您可以使用关键字创建一个常量：

```
const myContsant = 42;
myConstant = 0;
console.log(myConstant); // 42 
```

# asp.net-mvc-3 - 在 MVC 站点中使用 MVC SiteMapProvider 和 DynamicNodeProvider 进行 CRUD 操作

> ID：14734403
> 
> 赞同：1
> 
> 时间：2013-02-06T16:49:01.050
> 
> 标签：asp.net-mvc-3, asp.net-mvc-4, mvcsitemapprovider

我试图让 MvcSiteMapProvider 与一个执行一些 CRUD 操作的简单站点一起工作。我几乎完成了这一点，但在许多情况下我都会出现奇怪的行为。

首先，我使用标准层次结构创建了控制器和视图：
控制器
--> EquipoController
视图
--> Equipo --> 索引/详细信息/创建/编辑/删除...

接下来，定义了我的 mvc.sitemap

```
<mvcSiteMapNode title="Inicio" controller="Home">
  <mvcSiteMapNode title="Equipo" controller="Equipo">
    <mvcSiteMapNode title="Crear Equipo" action="Create"></mvcSiteMapNode>
    <mvcSiteMapNode title="Detalle Equipo" action="Details" dynamicNodeProvider="MvcApplication2.TestDynamicNodeProvider, MvcApplication2">
      <mvcSiteMapNode title="Editar Equipo" action="Edit"></mvcSiteMapNode>
      <mvcSiteMapNode title="Eliminar Equipo" action="Delete"></mvcSiteMapNode>
    </mvcSiteMapNode>
  </mvcSiteMapNode> 
```

请注意，编辑和删除操作嵌套在详细信息节点中。

接下来，我实现了 TestDynamicNodeProvider 类，如下所示： public class TestDynamicNodeProvider : DynamicNodeProviderBase { Entities db = new Entities();

```
 public override IEnumerable<DynamicNode> GetDynamicNodeCollection()
    {
        // Build value 
        var returnValue = new List<DynamicNode>();

        // Create a node for each album 
        foreach (var equipo in db.GEN_EQUIPO)
        {
            DynamicNode node = new DynamicNode();
            node.Title = equipo.DESCRIPCION;
            node.RouteValues.Add("id", equipo.ID);                
            yield return node;                
        }            
    }
} 
```

假设我在 GEN_EQUIPO 中有两个项目（EQUIPO_A 和 EQUIPO_B）。这些是我在每个视图中得到的面包屑：
索引：Inicio > Equipo（简单...）
详细信息视图（第二项）：Inicio > Equipo > EQUIPO_B（ok）
编辑视图（第二项）：Inicio > Equipo > **EQUIPO_A** > Editar Equipo（错误！）
删除视图（第二项）：Inicio > Equipo > **EQUIPO_A** > Eliminar Equipo（错误！）

我不明白为什么在编辑和删除视图中它总是使用列表中的第一项来构建面包屑。链接也错误（*Equipo/Details/1*应该是*Equipo/Details/2*）

我附上一个捕获以获取更多示例。

我不知道我做错了什么！任何想法？

![查看方向栏...然后到生成的链接。 另外，请注意 TALADRO 不是 TRONZADORA！](../Images/eb4253b698ee09bc5b81a8e86649442f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T07:11:06.713

您是否尝试将“preservedRouteParameters”添加到您的详细信息、编辑和删除节点？我假设您正在使用诸如“id”之类的字段，因此它看起来像：

保留的RouteParameters="id"

# android - HTML 加载 res/drawable 图像

> ID：14734406
> 
> 赞同：0
> 
> 时间：2013-02-06T16:49:19.807
> 
> 标签：android

我有这个 html 页面（assets/page.html），我想加载图像“res/drawable-xhdpi/image.png”。有一种方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:57:50.470

找到了解决方案！

我将 image.png 从 res 文件夹复制到 assets 文件夹（现在是 assets/image.png）。然后我只是对图像进行了搜索`src="image.png"`

# python - Python - 如何计算对象内数字的出现次数？

> ID：14734413
> 
> 赞同：0
> 
> 时间：2013-02-06T16:49:38.973
> 
> 标签：python

我需要计算对象中某个数字的出现次数。不知道该怎么做。

我可以通过这种方式访问​​这些值：

```
>>> formset_sample.forms[0]._raw_value('type')
>>> '1'
>>> formset_sample.forms[1]._raw_value('type')
>>> '2'
>>> formset_sample.forms[2]._raw_value('type')
>>> '2' 
```

这个对象有 len() = 3：

```
>>> len(formset_sample.forms)
>>> 3 
```

如何获得数字 2 的出现次数？在这种情况下，数字“2”恰好出现两次。

一些线索？

此致，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T16:53:50.027

我不清楚你想要达到什么目标。但也许该`map`功能可以帮助您：

```
 values = map(lambda x: x._raw_value('type'), formset_sample.forms)
 # alternate Syntax:
 values = [form._raw_value('type') for form in formset_sample.forms]
 print values 
```

应该给你数组

```
 ['1', '2', '2'] 
```

您可以将其输入`Counter`：

```
from collections import Counter
print Counter(values) 
```

应该是这样的

```
{ '1': 1, '2': 2 } 
```

因此，如果您想将所有内容放在一行中：

```
Counter([form._raw_value('type') for form in formset_sample.forms])["2"] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T16:53:08.990

这应该给你一个数字列表并计算 2 的数量：

```
l = [ f._raw_value('type') for f in formset_sample.forms ]
l.count('2') # I am assuming 2 is a string, or
l.count(2)   # if the number is stored as an integer 
```

现在您可以使用`l`排序、切片等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T16:55:25.813

这将生成一个字典，其中不同类型作为键，出现次数作为值：

```
import defaultdict
d = defaultdict(int)
for rv in formset_sample.forms:
  d[rv._raw_value_('type')] += 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T16:57:35.823

```
a = {1:1, 2:1, 3:2}
print a.values().count(1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T16:58:30.503

```
count = sum(f._raw_value('type') == '2' for f in formset_sample.forms) 
```

# cakephp - CakePHP 多选值未选中

> ID：14734416
> 
> 赞同：0
> 
> 时间：2013-02-06T16:49:41.623
> 
> 标签：cakephp

我的多项选择正在正确填充，并且已成功保存，但是，在编辑时未选择所选值。

我的表格 ->

```
echo $this->Form->inputs(array(
        ...
        'AnaestheticTechnique',
        ...
    )); 
```

我的 HABTM 关系

```
class PatientCase extends AppModel {
    public $hasAndBelongsToMany = array(
            'AnaestheticTechnique' =>
                array(
                    'className'              => 'AnaestheticTechnique',
                    'joinTable'              => 'anaesthetic_techniques_patient_cases',
                    'foreignKey'             => 'patient_case_id',
                    'associationForeignKey'  => 'anaesthetic_technique_id',
                    'unique'                 => true
                ),
    );
} 
```

在我的控制器中

```
 $anaestheticTechniques = $this->PatientCase->AnaestheticTechnique->find('list');
    $this->set(compact('anaestheticTechniques')); 
```

选择输入的名称生成为

> 数据[麻醉技术][麻醉技术][]

但是， $this 正在返回

> $this->data[麻醉技术][0][]

任何想法如何解决这一问题？

# delphi - 动态更改 CreateParams？

> ID：14734419
> 
> 赞同：6
> 
> 时间：2013-02-06T16:49:56.603
> 
> 标签：delphi, custom-controls, ownerdrawn

我有一个从 TCustomButton 派生的自定义按钮组件。

为了使它成为所有者，我已经像这样覆盖了 CreateParams：

```
procedure TMyButton.CreateParams(var Params: TCreateParams);
begin
  inherited CreateParams(Params);
  with Params do
  begin
    Style := Style or BS_OWNERDRAW;
  end;
end; 
```

我的按钮适用于我自己的绘画等，但我想做的是在对象检查器中提供一个布尔属性，它可以用来告诉我的按钮是否应该是所有者绘制的。

例如，如果启用了该属性，则按钮使用我自己的绘制例程作为所有者绘制按钮进行绘制，如果该属性被关闭，那么它应该绘制为主题 Windows 按钮样式（如常规 TButton）。

CreateParams 告诉我的按钮它应该是 ownerdawn，但我想提供一个选项来告诉按钮它是否应该是 ownerdrawn。通过在设计时或通过代码在运行时更改属性，我想告诉我的按钮是否要所有者绘制。

这有可能吗？如果可以，怎么做？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-06T16:54:26.767

添加属性并做出`CreateParams`相应的行为不是我想的问题。立即生效的新设置可能是。

`RecreateWnd`切换属性时调用。这将导致删除当前的 Windows 句柄并重新创建它，包括使用您覆盖的`CreateParams`例程。

总而言之：

```
type
  TMyButton = class(TButtonControl)
  private
    FOwnerDraw: Boolean;
    procedure SetOwnerDraw(Value: Boolean);
  protected
    procedure CreateParams(var Params: TCreateParams); override;
  published
    property OwnerDraw: Boolean read FOwnerDraw write SetOwnerDraw
      default False;
  end;

procedure TMyButton.CreateParams(var Params: TCreateParams);
const
  OwnerDraws: array[Boolean] of DWORD = (0, BS_OWNERDRAW);
begin
  inherited CreateParams(Params);
  Params.Style := Params.Style or OwnerDraws[FOwnerDraw];
end;

procedure TMyButton.SetOwnerDraw(Value: Boolean);
begin
  if FOwnerDraw <> Value then
  begin
    FOwnerDraw := Value;
    RecreateWnd;
  end;
end; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-06T16:56:24.250

你可以这样做：

1.  做一个`OwnerDraw`财产。
2.  测试该属性`CreateParams`并相应地切换行为。
3.  `RecreateWnd`每当属性更改时调用。

代替第 3 项，您可以通过调用来简单地更改窗口样式`SetWindowLong`。请确保`HandleAllocated`在尝试执行此操作之前进行测试。没有必要强制创建窗口。但是，您可能还需要在发生这种情况时强制执行绘制周期。

就个人而言，我想我会倾向于强制窗口娱乐。

# c# - 使用 Fluent NHibernate 和 MVC 3 的 SqlDateTime 溢出

> ID：14734425
> 
> 赞同：2
> 
> 时间：2013-02-06T16:50:22.373
> 
> 标签：c#, asp.net-mvc-3, fluent-nhibernate, sql-server-express

我正在使用 FNH 生成 ASP.NET MVC3 应用程序中使用的库的大约 30 个类的映射。我正在使用 MSSQL Express 10。我创建了一些代码，允许我用一些数据填充数据库以用于开发目的。但是，当我尝试保存 Account 实例时，我收到以下错误消息：

> System.Data.SqlTypes.SqlTypeException：SqlDateTime 溢出。必须介于 1753 年 1 月 1 日上午 12:00:00 和 9999 年 12 月 31 日晚上 11:59:59 之间。

这是因为 Account.CreationDate 属性是 DateTime。我环顾四周，MSSQL 和 .NET 中的 DateTime 实际上并不相同。我试过，通过 FNH 映射强制列是“datetime2”，但这似乎没有帮助。

这是我的 Account 类（简化）：

```
public class Account
{
    public virtual int Id { get; set; }
    public virtual string Comment { get; set;}
    public virtual DateTime CreationDate { get; set;}
    public virtual string Email { get; set;}
    public virtual string Password {get ; set;}
    public virtual string Locale {get; set;}

    public Account(string password, string email)
    {
        this.Email = email;
        SetNewPassord(password);
        this.CreationDate = DateTime.Now;
        this.Locale = "en-US";
    }
} 
```

FNH 映射：

```
public class AccountMap : ClassMap<Account>
{
    public AccountMap()
    {
        Id(x => x.Id);
        Map(x => x.Comment);
        Map(x => x.CreationDate);
        Map(x => x.Email);
        Map(x => x.Password);
        Map(x => x.Locale);
    }
} 
```

我称之为的代码：

```
 var compteAdmin = new Account("test", "noone@nowhere.com");
        compteAdmin.Locale = "fr-FR";
        var toto = compteAdmin.CreationDate;
        try
        {
            session.Save(compteAdmin);
        }
        catch (Exception ex)
        {
            throw new ConfigurationException("Account.CreationDate: " + compteAdmin.CreationDate.ToString() + " ; Exception: " + ex);
        } 
```

请注意，出于调试的目的，我抛出了一些异常。那个输出有点超现实！

> Account.Creation 日期：2/6/2013 5:32:29 PM；异常：System.Data.SqlTypes.SqlTypeException：SqlDateTime 溢出。必须介于 1753 年 1 月 1 日上午 12:00:00 和 9999 年 12 月 31 日晚上 11:59:59 之间。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-08T09:03:40.223

问题是 DateTime 属性没有设置为“可为空”，因此没有将此属性设置为“Null”，而是一直设置为 01/01/0001，因此触发了超出范围的错误。

`public virtual DateTime? CreationDate { get; set;}`因此，需要在类（即：）和映射（ ）中将属性设置为 Nullable `Map(x => x.CreationDate).Nullable;`。

否则，即使您将属性设置为`null`，它也会显示为 01/01/0001。一旦属性变为可空，它的值就真的是空的并且查询是成功的。

# caching - 可以使用 CachingWrapperFilter 简单地缓存每个搜索吗？

> ID：14734431
> 
> 赞同：4
> 
> 时间：2013-02-06T16:50:38.700
> 
> 标签：caching, lucene, lucene.net

使用 Lucene.Net 3.0.3 很容易将响应用户搜索而创建的每个查询简单地包装在[`CachingWrapperFilter`](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/all/org/apache/lucene/search/CachingWrapperFilter.html). 这是一个坏主意，因为 Lucene 会消耗越来越多的内存，还是 Lucene 会以智能的方式管理内存并释放缓存的项目？

我是否应该在包装在 CachingWrapperFilter 中的查询中有所选择？

```
Query query = .... 
QueryWrapperFilter queryFilter = new QueryWrapperFilter(query);
CachingWrapperFilter cachingFilter = new CachingWrapperFilter(queryFilter);
searcher.search(query, cachingFilter, 1); 
```

### 更新

Lucene.Net 的实现`CachingWrapperFilter`也使用与垃圾收集相关的机制。它实现了一个`WeakDictionary`使用类的实例作为键控的[`WeakReference`](http://msdn.microsoft.com/en-gb/library/system.weakreference.aspx)类。这是一个内置的 .Net 类，它包装任何对象并提供一种方法来检查该对象是否已被垃圾收集。这表明我的问题的答案是肯定的。Lucene 缓存的内存管理将受到控制，因为它本质上与运行时垃圾收集器相关联，并且只要缓存项仍然有效，就会对其进行维护。

### 再详细一点...

缓存的键由`IndexReader`包装在`WeakReference`. `IndexReader`管理它作为缓存键提供的对象。当它们不再有效时，它们将被丢弃并随后被垃圾收集。然后缓存可以通过 检测到这一点`WeakReference`并从缓存中删除该项目。

通过弱引用机制`IndexReader`可以断开和缓存的连接。通过`IndexReader`释放关键对象来控制缓存项的有效性，并且缓存会自行清理。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:26:27.213

在 Java Lucene 中，正在使用这个特定的缓存，[`WeakHashMap`](http://docs.oracle.com/javase/6/docs/api/java/util/WeakHashMap.html)这意味着一旦内存压力加剧，条目将被自动清除。如果在 .NET 中有对应物`WeakHashMap`，我希望它也会被使用。

# php - 不显示创建的 mongodb

> ID：14734435
> 
> 赞同：1
> 
> 时间：2013-02-06T16:50:49.110
> 
> 标签：php, mongodb

我正在使用 mongodb 做项目。所以在这里我编写了单独的函数来创建数据库。这是我的代码

```
 $conn = new \MongoClient('mongodb://example.com:27017', array("connect" => TRUE));
            $exist_dbs = $conn->listDBs();

            foreach ($exist_dbs["databases"] as $databse) {
                if ($databse['name'] == $db_name) {
                    $is_exist = true;
                }
            }

            if (!$is_exist) {
                $db = new \MongoDB($conn, $db_name);
                $status = true;
                $msg = 'database successfully created';

            } else {
                $status = false;
                $msg = 'database already exist';
            }
            $conn->close(); 
```

但在创建数据库后它没有显示。但是如果我像这样添加记录，

```
 $conn = new \MongoClient('mongodb://example.com:27017', array("connect" => TRUE));
            $exist_dbs = $conn->listDBs();

            foreach ($exist_dbs["databases"] as $databse) {
                if ($databse['name'] == $db_name) {
                    $is_exist = true;
                }
            }

            if (!$is_exist) {
                $db = new \MongoDB($conn, $db_name);
                $status = true;
                $msg = 'database successfully created';
                //new code
                $collection = new \MongoCollection($db, 'users');
                $obj = array("name" => "Madawa", "age" => "34");
                $collection->insert($obj);
            } else {
                $status = false;
                $msg = 'database already exist';
            }
            $conn->close(); 
```

它显示了数据库。是什么原因请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:38:48.193

当你说

```
$db = new \MongoDB($conn, $db_name); 
```

您不是在创建数据库，而是在创建可以访问数据库的对象。这并不意味着数据库确实存在或它确实存在，只是您现在拥有一个能够访问它的对象。所以你基本上说过“让我成为一个数据库对象来处理我的调用，我想选择 $db_name”，但这就是发生的一切。除非您将某些内容放入其中或对其执行某些操作，否则该数据库不存在。

# iphone - 如何确定是什么类型的中断导致 applicationWillResignActive 被调用

> ID：14734438
> 
> 赞同：0
> 
> 时间：2013-02-06T16:50:57.597
> 
> 标签：iphone, objective-c

如何确定触发 applicationWillResignActive 调用的中断类型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:33:58.343

我不认为你可以。您会收到通知有**中断**，但仅此而已。

# delphi - 如何自定义滚动条颜色？

> ID：14734441
> 
> 赞同：1
> 
> 时间：2013-02-06T16:51:06.380
> 
> 标签：delphi, scrollbar

我找到了一些如下示例代码，用于尝试自定义滚动条颜色：

```
HBRUSH CMainFrame::OnCtlColor(CDC* pDC, CWnd* pWnd, UINT nCtlColor)       
{ 
   HBRUSH hbr = CFrameWnd::OnCtlColor(pDC, pWnd, nCtlColor); 

   if(nCtlColor==CTLCOLOR_SCROLLBAR) 
      return m_brColor; 

   return hbr; 
} 
```

我发现以下代码不起作用：

```
procedure TForm1.WMCTLColor(var msg: TWMCTLCOLOR); message WM_CTLCOLOR; 
```

我怎样才能在德尔福中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:16:14.517

本机 api 中没有`WM_CTLCOLOR`消息。相反，您可以使用`CN_CTLCOLORSCROLLBAR`控件通知，它由 VCL 发送给子控件以响应 API 的[`WM_CTLCOLORSCROLLBAR`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb787573%28v=vs.85%29.aspx).

```
type
  TScrollBar = class(TScrollBar)
  protected
    procedure WMCtlColor(var Message: TWMCtlColorScrollbar); message CN_CTLCOLORSCROLLBAR;
  end;

procedure TScrollBar.WMCtlColor(var Message: TWMCtlColor);
begin
  Message.Result := CreateSolidBrush(RGB(255, 255, 0));
end; 
```

或者，如果您不想派生新控件，只要将滚动条放在窗体上：

```
 TForm1 = class(TForm)
    ...
  protected
    procedure WMCtlColorScrollbar(var Message: TWMCtlColorScrollbar);
      message WM_CTLCOLORSCROLLBAR;
    ...
  end;

procedure TForm1.WMCtlColorScrollbar(var Message: TWMCtlColorScrollbar);
begin
  if Message.ChildWnd = ScrollBar1.Handle then
    Message.Result := CreateSolidBrush(RGB(255, 255, 0));
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-21T06:49:10.950

这种改进避免了通过重复调用 CreateSolidBrush() 造成的内存泄漏

```
{ TMyScrollBar }
//******************************************************************************
constructor TMyScrollBar.Create(AOwner: TComponent);
begin
  inherited;
  FHBrush := CreateSolidBrush(ColorToRGB(FBackColor));
end;

//******************************************************************************
destructor TMyScrollBar.Destroy;
begin
  DeleteObject(FHBrush);
  inherited;
end;

//******************************************************************************
procedure TMyScrollBar.SetBackColor(const Value: Tcolor);
begin
  FBackColor := Value;
  DeleteObject(FHBrush);
  FHBrush := CreateSolidBrush(ColorToRGB(FBackColor));
end;

//******************************************************************************
procedure TMyScrollBar.WMCtlColor(var Message: TWMCtlColorScrollbar);
begin
  Message.Result := FHBrush;
end; 
```

# context-free-grammar - 语言不规则的半规则语法示例

> ID：14734442
> 
> 赞同：1
> 
> 时间：2013-02-06T16:51:08.510
> 
> 标签：context-free-grammar, regular-language, automata, language-theory

“半正则”文法是一种只允许以下形式的规则的文法：

```
X → y
X → y Y
X → Y y 
```

其中 X 和 Y 是任何单个非终结符，x 和 y 是任何单个终结符。

例如，这是语言 a+ b+ 的半正则文法

```
S → a S
S → a A
A → A b
A → b 
```

举一个语言不是正则语言的半正则语法的例子。一定要说明语言是什么以及为什么它不规则。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:29:21.783

关于什么

```
S := aT | -
T := Sb 
```

注意`-`表示空字符串；如果您愿意，可以用单个终端符号替换它，而不改变规律性。这就产生了语言`a^n b^n`，规范的非常规语言。您可以使用常规语言的抽水引理或 Myhill-Nerode 定理轻松证明这一点。

# c# - C#打印多页

> ID：14734444
> 
> 赞同：1
> 
> 时间：2013-02-06T16:51:14.323
> 
> 标签：c#, printing

这是我的代码，当我打印一页时工作正常，但是当我尝试打印不适合一页的内容时，它不会开始新页面，它只是接受偏移量更改并开始在第一页上书写.

有谁知道该怎么做？

```
private void printDocument_PrintPage(object sender, PrintPageEventArgs e)
{
    Graphics graphic = e.Graphics;

    Font font = new Font("Courier New", 12);
    float fontHeight = font.GetHeight();
    int startX = 10;
    int startY = 10;
    int offset = 0;

    float pageWidth = e.PageSettings.PrintableArea.Width;
    float pageHeight = e.PageSettings.PrintableArea.Height;

    foreach (string line in textRichTextBox.Lines)
    {
        graphic.DrawString(line, font, new SolidBrush(Color.Black), startX, startY + offset);
        offset += (int)fontHeight;// + 5

        if (offset >= pageHeight - (int)fontHeight)
        {
            e.HasMorePages = true;
            offset = 0;
        }
    }
    e.HasMorePages = false;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:57:44.333

您使用的 API 错误，[文档说](http://msdn.microsoft.com/en-us/library/cwbe712d.aspx)：

> 在 PrintPage 事件处理程序中，使用 PrintPageEventArgs 类的 Graphics 属性和文档内容来计算行长和每页行数。绘制完每一页后，检查是否是最后一页，并相应地设置 PrintPageEventArgs 的 HasMorePages 属性。引发 PrintPage 事件，直到 HasMorePages 为 false。此外，请确保 PrintPage 事件与其事件处理方法相关联。

您不能`HasMorePages`在循环中设置，只能在回调退出时设置。回调将被调用，直到您设置`HasMorePages`为 false

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:59:34.080

到达页面末尾后，您需要停止向打印机发送文本，仅将 HasMorePages 设置为 true 是不够的。您可以在此处添加一个[break 语句](http://msdn.microsoft.com/en-us/library/adbctzc4%28v=vs.80%29.aspx)，或者完全更改您的循环，并将您从列表中处理的最后一个位置保留在某个位置。

# java - 访问导入语句的 Java 注释处理 API

> ID：14734445
> 
> 赞同：8
> 
> 时间：2013-02-06T16:51:17.647
> 
> 标签：java, annotation-processing

我正在编写一个应该生成 java 代码的 AnnotationProcessor。它应该从某些现有接口生成派生接口。

为此，我需要找到原始输入代码的导入语句，以便将其输出到生成的 java 文件中。

如何才能做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-09-13T02:17:17.797

您无法使用注释处理器获取导入*语句。*但是，您可以获得的是该类使用的类型，这甚至更好。

源代码中的导入语句不足以分析类中使用了哪些类型，因为并非所有使用的类型都有导入语句。如果你真的只需要实际的语句，你可以直接[阅读源文件](https://stackoverflow.com/questions/6373145/accessing-source-code-from-java-annotation-processor)。

如果你只看陈述，会有一些问题：

*   完全限定的类名，例如属性`java.util.Date date;`
*   从同一个包中导入没有明确的导入语句
*   为文件中的所有类声明导入语句
*   未使用的导入语句可能会导致额外的混乱

* * *

使用注解处理器和[Mirror API](http://docs.oracle.com/javase/7/docs/jdk/api/apt/mirror/overview-summary.html)，您可以获得属性类型、方法参数、方法返回类型等 - 基本上是每个不在方法或块中的声明的类型。这应该足够好了。

您应该分析类的每个元素并将其类型存储在 Set 中。有一些[实用程序类](http://docs.oracle.com/javase/7/docs/api/javax/lang/model/util/package-summary.html)可以帮助完成这项任务。您可以忽略`java.lang`包中的任何类型，因为它始终是隐式导入的。

最小的注释处理器可能如下所示：

```
import javax.annotation.processing.AbstractProcessor;
import javax.annotation.processing.RoundEnvironment;
import javax.annotation.processing.SupportedAnnotationTypes;
import javax.annotation.processing.SupportedSourceVersion;
import javax.lang.model.SourceVersion;
import javax.lang.model.element.TypeElement;

@SupportedSourceVersion(SourceVersion.RELEASE_7)
@SupportedAnnotationTypes("*")
public class Processor extends AbstractProcessor {

    @Override
    public boolean process(Set<? extends TypeElement> annotations, RoundEnvironment roundEnv) {
        ImportScanner scanner = new ImportScanner();
        scanner.scan(roundEnv.getRootElements(), null);

        Set<String> importedTypes = scanner.getImportedTypes();
        // do something with the types

        return false;
    }

} 
```

此处的 Scanner 扩展`ElementScanner7`了它基于访问者模式。我们只实现了一些访问者方法并按种类过滤元素，因为并非所有元素实际上都可以包含可导入类型。

```
import java.util.HashSet;
import java.util.Set;

import javax.lang.model.element.ExecutableElement;
import javax.lang.model.element.TypeElement;
import javax.lang.model.element.TypeParameterElement;
import javax.lang.model.element.VariableElement;
import javax.lang.model.type.TypeKind;
import javax.lang.model.util.ElementScanner7;

public class ImportScanner extends ElementScanner7<Void, Void> {

    private Set<String> types = new HashSet<>();

    public Set<String> getImportedTypes() {
        return types;
    }

    @Override
    public Void visitType(TypeElement e, Void p) {
        for(TypeMirror interfaceType : e.getInterfaces()) {
            types.add(interfaceType.toString());
        }
        types.add(e.getSuperclass().toString());
        return super.visitType(e, p);
    }

    @Override
    public Void visitExecutable(ExecutableElement e, Void p) {
        if(e.getReturnType().getKind() == TypeKind.DECLARED) {
            types.add(e.getReturnType().toString());
        }
        return super.visitExecutable(e, p);
    }

    @Override
    public Void visitTypeParameter(TypeParameterElement e, Void p) {
        if(e.asType().getKind() == TypeKind.DECLARED) {
            types.add(e.asType().toString());
        }
        return super.visitTypeParameter(e, p);
    }

    @Override
    public Void visitVariable(VariableElement e, Void p) {
        if(e.asType().getKind() == TypeKind.DECLARED) {
            types.add(e.asType().toString());
        }
        return super.visitVariable(e, p);
    }

} 
```

此扫描器返回一组类型作为完全限定的路径。还有一些事情需要考虑和一些事情要实施：

*   该集合包含`java.lang`来自同一包的元素和类型
*   该集合包含泛型，例如`java.util.List<String>`
*   `TypeKind.DECLARED`不是唯一一种可导入类型的元素。还要检查`TypeKind.ARRAY`并获取它的实际声明类型。可以使用代替添加另一个`else if(e.asType().getKind() == TypeKind.ARRAY) // ...`类来代替`TypeKindVisitor7`
*   根据用例，可能会发现更多类型。例如，注释可以包含类作为参数。
*   对于 Java 1.6，使用各自的`ElementScanner6`, `TypeKindVisitor6`etc. 实现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-09-12T23:45:01.683

看起来没有办法从标准 SDK 类中获取导入语句（至少使用 SDK 5-6-7）。

不过，您可以使用来自 SUN/Oracle 的 tools.jar 中的一些类。

```
import com.sun.source.util.TreePath;
import com.sun.source.util.Trees;

public class MyProcessor extends AbstractProcessor {

    @Override
    public void init(ProcessingEnvironment env) {
        tree = Trees.instance(env);
    }

    @Override
    public boolean process(final Set<? extends TypeElement> annotations, final RoundEnvironment roundEnvironment) {
        for( Element rootElement : roundEnvironment.getRootElements() ) {
            TreePath path = tree.getPath(rootElement);
            System.out.println( "root element "+rootElement.toString() +" "+path.getCompilationUnit().getImports().size() );
        }
.... 
```

通过 maven 获取 Java 工具的 jar，参考[这个线程](https://stackoverflow.com/a/5756336/693752)。

应该有使用 TreePathScanner 的替代方法（也来自 tools.jar），但我从未触发过 visitImport 方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-05-20T06:08:02.713

```
<dependency>
    <groupId>org.jvnet.sorcerer</groupId>
    <artifactId>sorcerer-javac</artifactId>
    <version>0.8</version>
</dependency> 
```

使用这个依赖解决了这个问题，但不幸的是这次它支持到 Java 1.7，你不能正确编译 Java 1.8 源代码。我的解决方案有点 hack，但它可以在不使用此依赖项和 Java 1.8 源的情况下工作

```
public final class SorcererJavacUtils {
private static final Pattern IMPORT = Pattern.compile("import\\s+(?<path>[\\w\\\\.]+\\*?)\\s*;");

// com.sun.tools.javac.model.JavacElements
public static Set<String> getImports(Element element, ProcessingEnvironment processingEnv) {
    Elements elements = processingEnv.getElementUtils();
    Class<?> cls = elements.getClass();

    try {
        Method getTreeAndTopLevel = cls.getDeclaredMethod("getTreeAndTopLevel", Element.class);
        getTreeAndTopLevel.setAccessible(true);
        // Pair<JCTree, JCCompilationUnit>
        Object treeTop = getTreeAndTopLevel.invoke(elements, element);

        if (treeTop == null)
            return Collections.emptySet();

        // JCCompilationUnit
        Object toplevel = getFieldValue("snd", treeTop);

        return SorcererJavacUtils.<List<Object>>getFieldValue("defs", toplevel).stream()
                                                                               .map(Object::toString)
                                                                               .map(IMPORT::matcher)
                                                                               .filter(Matcher::find)
                                                                               .map(matcher -> matcher.group("path"))
                                                                               .collect(Collectors.toSet());
    } catch(Exception ignored) {
        return Collections.emptySet();
    }
}

private static <T> T getFieldValue(String name, Object obj) throws IllegalAccessException, NoSuchFieldException {
    Field field = obj.getClass().getDeclaredField(name);
    field.setAccessible(true);
    return (T)field.get(obj);
}

private SorcererJavacUtils() {
} 
```

}

# c - 链接到 Cmake 中不存在的共享库

> ID：14734449
> 
> 赞同：0
> 
> 时间：2013-02-06T16:51:25.443
> 
> 标签：c, linker, cmake, ld

我有一个 CMAKE 项目，我正在使用 pcap。在我的 cmake 文件中，我有以下内容：

```
target_link_libraries(mylib pcap) 
```

并安装在我的系统上我有以下

在 /usr/lib

```
/usr/lib/libpcap.so -> /usr/local/lib/libpcap.so 
```

在 /usr/local/lib

```
/usr/local/lib/libpcap.so.1.3.0
/usr/local/lib/libpcap.a
/usr/local/lib/libpcap.so -> /usr/local/lib/libpcap.so.1.3.0 
```

然而，当我构建代码并在可执行文件上运行 ldd 时，我得到了

```
libpcap.so.1 => not found 
```

所以问题是对 libpcap.so.1 的引用来自哪里，我该如何解决？无论是在我的 cmake 设置中还是在系统上更改某些内容。

编辑：我在我的系统上做了一个发现，而 libpcap.so.1 在系统上也绝对没有其他地方

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:37:44.647

此问题的可能解决方案如下：

1.  设置`PCAP_LIBRARIES`为要链接的库列表（我建议绝对路径）
2.  设置`PCAP_LIBRARIES_DIR`为库所在目录的列分隔列表
3.  设置要链接的库

    `target_link_libraries( mylib ${PCAP_LIBRARIES} )`

4.  相应地设置目标属性

    `SET_TARGET_PROPERTIES( myexe PROPERTIES INSTALL_RPATH ${PCAP_LIBRARIES_DIR} )`

# android - 每个 Activity 的 onPause 中的登录屏幕

> ID：14734457
> 
> 赞同：2
> 
> 时间：2013-02-06T16:51:36.287
> 
> 标签：android, android-activity

我正在尝试开发一个应用程序，其中每当用户切换到其他应用程序或按下主页按钮时都会调用登录类。

例如，我有两个活动 Activity1 和 Activity2。

*   Activity2 是从 Activity1 调用的，因此意味着 Activity1 进入 onPause 状态。
*   当用户切换到其他应用程序时，应从该活动调用登录类，并在成功验证后在同一点恢复。

目前，我正在每个 Activity 的 onPause 方法中为 Login 类创建一个意图。因此，当我从 Activity1 切换到 Activity2 时，正在执行 Activity1 的 onPause 方法，我无法切换到 Activity2。

简单来说，Login 类应该只在用户切换到其他应用程序或按下 Home 按钮时调用，而不是在应用程序处于前台时调用。

希望你能理解我的问题。谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:07:07.327

你将不得不自己实现这样的事情。Android 的应用程序概念不同于其他平台；用户不与应用程序交互，而是与单个应用程序组件（活动）交互。您可以在子类中实现这一点`Application`，但是即使在用户离开您的活动后（例如，通过按 HOME），系统也可以保留应用程序。

我为此类问题所做的一个解决方案是创建一个带有反映活动生命周期回调的生命周期回调的单例类（可能称为 LoginManager）。然后制作一个 BaseActivity 类，它获取单例，每个生命周期回调调用单例中的相应方法。通过这种方式，您可以跟踪您的活动在其生命周期中的时间并做出相应的反应。

我观察要开始、恢复、暂停或停止的活动。当打开一个activity时，当前的一个暂停，下一个被创建、启动、恢复（或重启并恢复），然后第一个被停止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T16:59:55.000

使用布尔标志。

```
boolean movingInApp = false;
....
movingInApp = true;
Intent intent...
.....
public void onPause() {
    if(!movingInApp) {
        //Show login
    }
}

public void onResume() {
    movingInApp = false;

} 
```

通过在启动任何意图等之前将值设置`movingInApp`为 true，您可以阻止您的应用显示登录屏幕。请记住稍后在您的`onResume()`方法中再次将其设置为 false。如果系统让你的应用程序进入后台，这将是错误的，并且会显示你的登录屏幕。

一个更好的方法是在一些 BaseActivity 中实现这个逻辑，并让你的所有其他活动继承自它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T16:59:40.570

在 Application 中覆盖`Application`和`set/reset`登录首选项`onCreate()/onTerminate()`。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T17:23:56.467

我不是 100% 清楚你现在是如何实现这个的，但根据描述，听起来你想实现这个 logIn 类`onResume()`而不是 in `onPause()`。如果您尝试让用户在每次活动回到前台时进行身份验证，那么我会执行以下操作：

(1) 将应用程序的最后状态存储到 SharedPreferences`onPause()`和/或`onStop()`

（2）`onResume()`或`onRestart()`使用意图将用户引导回登录活动（或根据您的操作方式自动进行身份验证）

(3) 如果认证成功，访问SharedPreferences中存储的最后一个状态，返回用户之前的行为

# javascript - 查看当前设置了哪些函数Interval'd

> ID：14734458
> 
> 赞同：0
> 
> 时间：2013-02-06T16:51:36.600
> 
> 标签：javascript, settimeout, setinterval

如何查看当前在 javascript中`setInterval`编辑或编辑的函数？`setTimeout`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T16:54:31.613

那是不可能的。您必须保留由 setInterval 或 setTimeout 返回的 id。保留 id 时，您还可以保留设置间隔或超时的函数名称。:-)

因此，您可以构建所有超时和间隔的列表。

然后你可以遍历这个数组并生成一个列表。

一个小例子：

```
var timeoutArray;

var oldSetTimeout = setTimeout;

setTimeout = function(){
    timeoutArray.push(oldSetTimeout(your_function, your_timeout));
} 
```

# javascript - 使用 for 循环更改对象引用 - Javascript

> ID：14734471
> 
> 赞同：0
> 
> 时间：2013-02-06T16:52:16.677
> 
> 标签：javascript, arrays, object, for-loop

```
 function calcul() {
        salaire = window.parseInt(document.myForm.txtSalaire.value);
        temps = window.parseInt(document.myForm.txtTemps.value);
        for (i = 0; i < monnaie.length; i++) {
            profit = monnaie[i] - (salaire/DIVISEUR) * temps;
            profit = profit.toFixed(3);
            document.myForm.txtMonnaie[i].value = monnaie[i] + "$";
            document.myForm.txtProfit[i].value = profit;
        }
    }
... <input type="text" name="txtMonnaie0"/> 
```

我想遍历所有输入以使用 i 作为参数将新值设置为 'name="txtMonnaie[]"' 和 txtProfit[]。

myForm.txtMonnaie 未定义。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:57:06.597

改变：

```
 document.myForm.txtMonnaie[i].value = monnaie[i] + "$";
 document.myForm.txtProfit[i].value = profit; 
```

到

```
 document.myForm["txtMonnaie" + i].value = monnaie[i] + "$";
 document.myForm["txtProfit" +i].value = profit; 
```

如果您有多个名称为`txtProfit0`, `txtProfit1`, `txtProfit2`, ... 的元素，浏览器将不会创建名称为 txtProfit in 的数组`document.myForm`。在那里你会找到一个属性列表，比如`document.myForm.txtProfit0`，`document.myForm.txtProfit1`......你可以使用索引访问它们，就像上面显示的一样

# java - 尝试加载 liferay 页面时出现未知错误

> ID：14734474
> 
> 赞同：0
> 
> 时间：2013-02-06T16:52:27.780
> 
> 标签：java, liferay

当我尝试加载已部署 2 个 portlet 并具有主题的页面时，出现以下错误

```
16:49:13,300 ERROR [http-bio-8080-exec-23][ThemeUtil:445] _SERVLET_CONTEXT_/templates/portal_normal.vm does not exist 
```

这可能是什么原因？

我无法加载页面本身。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T07:27:11.510

看来您的主题没有正确部署。

取消部署应用于页面的自定义主题，然后尝试加载页面，如果页面加载而不是确认它是导致问题的主题。

如果问题仍然存在，请重新启动服务器，然后检查页面是否加载。在此之后再次部署您的自定义主题。

有时您还需要清除`temp`文件夹，因为它保留了可能导致此类问题的陈旧数据。

这应该会给你一些线索来找出解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T05:58:08.463

它发生在我身上，我所做的是我不断停止，一次又一次地启动服务器。然后我做了很多次ant build，它自动得到了解决。它只是某种我们无法解决的冲突。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T07:09:03.370

尝试重新启动 Liferay 服务器，然后重新部署。

# mysql - 加入要更新的表

> ID：14734476
> 
> 赞同：1
> 
> 时间：2013-02-06T16:52:36.593
> 
> 标签：mysql, sql, sql-update, left-join

我可以这样做来更新一行吗？这是我第一次使用 a`LEFT JOIN`和`UPDATE`.

```
UPDATE comments AS r

LEFT JOIN items AS i 
        ON i.items_id = r.item_id
LEFT JOIN master_cat AS c
        ON c.cat_id = i.items_id  
SET r.good = r.good + 1 
WHERE i.item = '{$item}' AND c.category = '{$cat}' AND r.review = '{$review}'; 
```

它不会引发错误，但它会说 0 行受到影响，即使我已经确认我的变量可以使用正确的数据。（即使我对数据进行硬编码）。

**编辑**：我也尝试过内部连接，但也不起作用。

**编辑 2**：这实际上是我想要做的，我有这两个 queires，它们工作正常。我正在尝试将代码简化为一个。可以这样做：

```
 // This query returns rate_id which I use as "$review_id" in the second query.

     $query = "
     SELECT r.rate_id
     FROM comments as r
     LEFT JOIN items AS i 
         ON i.items_id = r.item_id
     LEFT JOIN master_cat AS c
         ON c.cat_id = i.cat_id
     WHERE r.review = '{$review}' 
        AND i.item = '{$item}' 
        AND c.category = '{$cat}';"; 

    $query = "
    UPDATE comments 
    SET good = good + 1 
    WHERE rate_id = '{$review_id}';"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T16:55:48.787

如果您要对表 c 进行外部联接，然后在表 c 中的字段上有一个 where 子句，那么您实际上就有了一个内部联接，因为如果联接条件未命中，where 子句将不匹配任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T16:56:03.330

你为什么想做一个`LEFT JOIN`？您没有使用连接表中的任何列来更新行...所以我假设连接表的目的是将要递增的行限制`comments`为仅在关联的表。

您受到 0 行影响的原因是您在`WHERE`子句中为左连接表放置了附加条件，这实际上是将每个表都`LEFT JOIN`变成了`INNER JOIN`.

假设这是您的查询的简化版本，并且您有其他原因想要使用`LEFT JOIN`，您可以通过将条件移动到您的`ON`子句中来解决此问题：

```
UPDATE comments AS r
    LEFT JOIN items AS i 
        ON i.items_id = r.item_id
        AND i.item = '{$item}' 
    LEFT JOIN master_cat AS c
        ON c.cat_id = i.items_id  
        AND c.category = '{$cat}' 
SET r.good = r.good + 1 
WHERE r.review = '{$review}'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T21:00:49.557

您的问题是在`UPDATE`语句中您有一个不匹配的连接（`cat_id`with `items_id`）：

```
LEFT JOIN master_cat AS c
        ON c.cat_id = i.items_id 
```

在`SELECT`（正在工作的）中，您可以正确地加入：

```
LEFT JOIN master_cat AS c
        ON c.cat_id = i.cat_id 
```

# node.js - 是否有任何 Node.JS 维护的库以使用 Amazon SES（电子邮件服务）？

> ID：14734479
> 
> 赞同：0
> 
> 时间：2013-02-06T16:52:41.447
> 
> 标签：node.js, amazon, amazon-ses

我意识到已经有一些关于此的帖子，但提到的大多数库至少有一年的历史（并且没有很多功能，如附件支持、检查退回等）。

有人知道 Node.js 使用 Amazon SES 维护的最佳库吗？

前任：

*   [node-amazon-ses](https://github.com/jjenkins/node-amazon-ses)不支持附件；如果发送成功则没有回调。但它确实有
    *   删除已验证的电子邮件地址
    *   获取发送配额
    *   获取发送统计信息
    *   ListVerifiedEmailAddresses
    *   发送电子邮件
    *   确认电子邮件地址

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T21:23:33.177

[适用于 Node.js](http://aws.amazon.com/sdkfornodejs)的AWS 开发工具包支持 SES。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-03T17:35:51.957

另一种选择是可以与 SES 一起使用的节点邮件模块： [https ://github.com/andris9/Nodemailer](https://github.com/andris9/Nodemailer)

这是一个带有 SES 和附件的示例： [https ://github.com/andris9/Nodemailer/blob/master/examples/example_ses.js](https://github.com/andris9/Nodemailer/blob/master/examples/example_ses.js)

不是一个功能齐全的 SES 库，但确实使发送到带有附件的 ses 更简单。

# c++ - 使用 Shell 排序对文件进行就地排序

> ID：14734482
> 
> 赞同：1
> 
> 时间：2013-02-06T16:52:47.547
> 
> 标签：c++, in-place

我被要求使用 shell 排序对文件进行就地排序（也使用快速排序，但我认为如果我找到一种方法，我将能够同时完成这两种方法）。我一直在想什么可能会有所帮助，但我找不到办法。我有一个数组的算法，但我想不出一种让它与文件一起工作的方法。

有什么办法可以做到这一点？

编辑：

在 André Puel 发布的代码的帮助下，我能够编写一些目前有效的代码，如果你想检查一下，这里是：

```
#include <iostream>
#include <iomanip>
#include <fstream>
#include <cstdlib>
#include <sstream>
using namespace std;

int toNum(const string &s) {
  stringstream ss(s);
  int n;
  ss >> n;
  return n;
}

string toStr(int n) {
  stringstream ss;
  ss << n;
  string s;
  ss >> s;
  return string(5 - s.size(),' ') + s;
}

int getNum(fstream &f,int pos) {
  f.seekg(pos*5);
  string s;
  for(int i = 0; i < 5; ++i) s += f.get();
  return toNum(s);
}

void putNum(fstream &f, int pos,int n) {
  f.seekp(pos*5);
  f.write(toStr(n).c_str(),5);
}

int main() {
  fstream input("entrada1",fstream::in | fstream::out);
  string aux;
  getline(input,aux);
  int n = aux.size() / 5,temp,j;

  int gaps[] = {701,301,132,57,23,10,4,1};
  int g = sizeof(gaps)/sizeof(gaps[0]);
  for(int k = 0; k < g; ++k) {
    for(int i = k; i < n; ++i) {
      temp = getNum(input,i);
      for(j = i; j >= k and getNum(input,j - k) > temp; j -= k) {
        putNum(input,j,getNum(input,j - k));
      }
      putNum(input,j,temp);
    }
  }
  input.close();
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:20:02.683

当你在 C++ 中打开一个文件时，你有两个指针。getter 指针和 putter 指针。它们指示您在文件中写入和读取的位置。

使用[seekp](http://www.cplusplus.com/reference/ostream/ostream/seekp/)，你可以告诉你想写的地方。使用[tellp](http://www.cplusplus.com/reference/ostream/ostream/tellp/)你知道你要在哪里写。每次你写东西时，推杆指针都会自动前进。

getter 指针也是如此，函数是[seekg](http://www.cplusplus.com/reference/istream/istream/seekg/)和[tellg](http://www.cplusplus.com/reference/istream/istream/tellg/)。

使用这些操作，您可以轻松地模拟一个数组。让我给你看一些代码：

```
class FileArray {
public:
    FileArray(const char* path) 
    : file(path, std::fstream::app|std::fstream::binary)
    {
        file.seekg(0,std::fstream::end);
        size = file.tellg();
    }

    void write(unsigned pos, char data) {
        assert(pos < size );
        file.tellp(pos);
        file.put(data);
    }

    char read(unsigned pos) {
        assert(pos < size);
        file.seekg(pos);
        return file.get();
    }
private:
    std::fstream file;
    std::size_t size;
} 
```

这是一种处理文件的幼稚方法，因为您假设随机访问。好吧，随机访问是正确的，但它可能会很慢。当您访问彼此靠近的数据（空间位置）时，文件流的工作速度更快。

尽管这是开始处理您的问题的好方法，但您将获得文件 IO 的经验，并且您将最终找出提高特定问题性能的方法。让我们保持婴儿的脚步。

我想让您注意的另一件事是，当您执行写入时，数据将被重定向到将写入文件的 fstream。我知道内核会尝试缓存这些东西，并优化速度，但如果你有某种缓存层来避免直接写入磁盘，那就更好了。

最后，我假设您正在处理字符（因为它会更容易），但是您可以处理其他数据类型，您只需要注意数据类型的索引和大小。例如，`long long`类型确实有 8 个字节的大小，如果您想访问*文件数组*中的第一个元素，您将访问位置 8*0，并且您必须读取 8 个字节。如果您想要第 10 个元素，您将访问位置 8*10 并再次读取 8 个字节的数据以构造该`long long`值。

# excel - Excel 2010 VBA/ADO 连接错误，带有 XL 源和文本输出

> ID：14734489
> 
> 赞同：1
> 
> 时间：2013-02-06T16:53:03.747
> 
> 标签：excel, vba, connection-string, ado

我正在使用带有宏的 Excel 2010 来访问另一个每日电子表格以提取数据以形成 FTP 记录文件。我遇到的具体问题是运行时连接错误。我得到的错误是“-2147467259(80004005)”：无法识别的数据库格式“C:\Work\Daily FTP Process\Excel DBs and Files\ftp.xlsx”。我只需要它知道在哪里看。这是手表的连接字符串：

> : ConnectionString : "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\Work\Daily FTP >Process\Excel DBs and Files\ftp.xlsx;" : 字符串 : Module1.XLFixedFieldFile

这是相关（或不相关）的代码：

```
Dim conn As Object
Dim cmd As Object
Dim psidRecSet As Object
Dim loopIndex As Long
Dim connString As String
Dim sqlString As String

Set conn = CreateObject("ADODB.Connection")
Set cmd = CreateObject("ADODB.Command")

connString = "Provider=Microsoft.ACE.OLEDB.12.0;" _
   & "Data Source=" & XLName & ";"
conn.Open connString    <==== Here is the line where it is breaking 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T15:48:55.047

解决了！有效的连接字符串如下：

```
 connString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source='" & XLName & 
    "';Extended Properties='Excel 12.0;HDR=NO;IMEX=1';" 
```

Remou，我试过了，但是出了点问题，出错了。在另一个论坛中找到的工作行的复制和粘贴是我的救赎。我很感激帮助。

对于使用此 y 解决问题的其他人，要使用 Excel 2010，我转到“工具/参考”并启用 Microsoft AcriveX 数据对象 6.1 库和 Microsoft ActiveX 数据对象 Recordset 6.0 库。

```
 Dim conn As Object
    Set conn = CreateObject("ADODB.Connection")
    connString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source='" & XLName & 
    "';Extended Properties='Excel 12.0;HDR=NO;IMEX=1';"
    conn.Open connString 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:28:50.277

你要：

```
 connString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" _ 
 & xlFile & ";Extended Properties='Excel 12.0 Xml;HDR=No;IMEX=1';" 
```

请注意扩展属性的引号。

您可能想阅读[http://support.microsoft.com/kb/257819](http://support.microsoft.com/kb/257819)，特别是 IMEX。

# python - nameError：全局名称 page_title 未定义

> ID：14734492
> 
> 赞同：0
> 
> 时间：2013-02-06T16:53:18.020
> 
> 标签：python, nameerror

我查看了许多现有的 nameErrors 和未定义的变量帖子，不幸的是无法解决我的问题。我对编程，尤其是 Python 比较陌生。

我有一个在 informcast_data.py 中定义的字典：

```
allLinks = {'Send or Edit Messages': {'link':'/InformaCast/admin?cmd=listMessages',   'page_title': 'Messages: Send or Edit Messages'} 
```

我正在将 informacast_data.py 导入 users.py：

```
from informacast.informacast_data import ICData 
```

然后我有一个函数，verify_links，它具有以下 for 语句：

```
for href_link in hrefs:
    if href_link.find(ICData.allLinks['page_title']['link'])!=-1:
        self.logger.debug("verify_links found=True for " + str(href_link))
        found=True 
```

如果我在 page_title 周围留下引号，我会得到一个 keyError，并且我被告知要删除引号，因为它是一个变量而不是字符串，当我删除引号时我会得到 nameError，我不确定如何继续。

以下是完整的追溯：

```
Traceback (most recent call last):
  File "C:\Users\jesse.sole\Jesse_Workspace\trunk\src\informacast\tests\users.py", line 17, in test_appadmin_role
    self.verify_role("appAdmin")
  File "C:\Users\jesse.sole\Jesse_Workspace\trunk\src\informacast\tests\users.py", line 78, in verify_role
    self.verify_links(sel, roleName)
  File "C:\Users\jesse.sole\Jesse_Workspace\trunk\src\informacast\tests\users.py", line 104, in verify_links
    if href_link.find(ICData.allLinks[page_title]['link'])!=-1:
NameError: global name 'page_title' is not defined 
```

提前感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T16:59:12.610

`allLinks`是一个嵌套字典。顶层没有`page_title`键，所以这就是为什么你会得到一个键错误：

```
>>> allLinks = {'Send or Edit Messages': {'link':'/InformaCast/admin?cmd=listMessages',   'page_title': 'Messages: Send or Edit Messages'}}
>>> allLinks['page_title']                                                                                                      
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
KeyError: 'page_title' 
```

*但是嵌套字典中*有这样一个键：

```
>>> allLinks['Send or Edit Messages']['page_title']
'Messages: Send or Edit Messages' 
```

我*认为*您想定义一个`page_title`具有以下值的变量`'Send or Edit Messages'`：

```
>>> page_title = 'Send or Edit Messages'
>>> allLinks[page_title]['link']
'/InformaCast/admin?cmd=listMessages' 
```

如果您遍历其中的键`allLinks`，则可以：

```
for href_link in hrefs:
    for page_title in ICData.allLinks:
        if href_link.find(ICData.allLinks[page_title]['link'])!=-1:
            self.logger.debug("verify_links found=True for " + str(href_link))
            found=True 
```

# iphone - 涉及 SIP 数据包的数据包嗅探 iphone 流量

> ID：14734501
> 
> 赞同：1
> 
> 时间：2013-02-06T16:53:43.523
> 
> 标签：iphone, sip, packet-sniffers

有没有办法使用 windows 或 Mac 嗅探 iphone 的传入和传出数据包，其中也包含 SIP 数据包？如果有人向我提供此类教程的链接会更好？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T19:20:24.673

你可以试试：

1) 安装网络协议分析器（在您的 MAC\Win 上），例如：[Wireshark](http://www.wireshark.org/about.html)（免费）或[Charles 代理](http://www.charlesproxy.com/)（试用版）

2) 在您的 MAC 上激活“国际共享”

3) 连接您的无线设备

4) 运行您的网络分析仪

您在每个站点上都有文档\帮助页面

# amazon-web-services - 将 wordpress 迁移到 Amazon Web Services

> ID：14734505
> 
> 赞同：2
> 
> 时间：2013-02-06T16:53:51.723
> 
> 标签：amazon-web-services, amazon-s3, amazon-ec2, amazon-rds

我打算将使用多个 wordpress 的网站移动到亚马逊服务。但是，我的每日访问量约为 22,000，有时甚至超过 90k，网络崩溃！但是，托管公司向我收取近 100 美元的费用，包括没有支持的支持，费用为 50 美元。平均带宽约为400GB。

请问我要多少钱？以及如何开始使用亚马逊服务？

亲切的问候

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T16:57:26.870

首先查看[亚马逊](http://aws.amazon.com/)提供的不同类型的托管，以及哪一种最适合您的网站。 [Amazon 的 EC2（弹性云计算）](http://aws.amazon.com/ec2/)是您可以在云中托管的服务器。

根据存储空间和带宽的多少，成本会有所不同。[他们的 EC2](http://aws.amazon.com/ec2/#pricing)页面上有一个有用的成本指南。他们为您需要的不同类型的服务器提供不同的定价。他们有按需的[现场实例](http://aws.amazon.com/ec2/spot-instances/)，可以在运行中打开和关闭。如果您需要服务器持续运行，您可以支付首付并拥有一个[预留实例](http://aws.amazon.com/ec2/reserved-instances/)来提供服务器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:59:06.747

您可以根据 AWS 提供的工具的当前使用情况计算费用。[http://calculator.s3.amazonaws.com/calc5.html](http://calculator.s3.amazonaws.com/calc5.html)

这也是一篇在 AWS 下开始使用 WordPress 的好文章。 [http://wp.tutsplus.com/tutorials/scaling-caching/deploy-your-wordpress-blog-to-the-cloud/](http://wp.tutsplus.com/tutorials/scaling-caching/deploy-your-wordpress-blog-to-the-cloud/)

AWS 还提供免费服务层级，前提是您的使用量保持在一定范围内。这在[http://aws.amazon.com/free/](http://aws.amazon.com/free/)中有详细说明。我还发现这个关于设置 EC2 实例的 YouTube 视频非常有帮助。[http://www.youtube.com/watch?v=JPFoDnjR8e8](http://www.youtube.com/watch?v=JPFoDnjR8e8)。据我了解，除非您的 WordPress 安装获得大量点击，否则您可能会属于免费套餐。

# c# - 将 XmlDocument() 与具有 xmlns 属性的节点一起使用？

> ID：14734509
> 
> 赞同：0
> 
> 时间：2013-02-06T16:54:22.813
> 
> 标签：c#, xml, xml-namespaces

我正在尝试使用 XmlDocument() 逐个节点读取 XML 文件并输出每个元素。

经过多次反复试验，我确定在我的节点上具有 xmlns 属性会导致没有节点从 SelectNodes() 调用返回。不知道为什么。

由于我无法更改输出格式并且无法访问实际的命名空间，我有哪些选择来解决这个问题？

此外，我还有一些具有子节点的元素。在循环通过 XML 文件时如何访问这些？IE，我需要解密 CipherValue 元素，但不确定如何访问该节点？

下面的示例：

```
doc.Load(@"test.xml");
XmlNodeList logEntryNodeList = doc.SelectNodes("/Logs/LogEntry");
Console.WriteLine("Nodes = {0}", logEntryNodeList.Count);
foreach (XmlNode xn in logEntryNodeList)
{
    string dateTime = xn["DateTime"].InnerText;
    string sequence = xn["Sequence"].InnerText;
    string appId = xn["AppID"].InnerText;
    Console.WriteLine("{0}    {1} {2}", dateTime, sequence, appId);
} 
```

示例 XML 如下所示：

```
<Logs>
<LogEntry Version="1.5" PackageVersion="10.10.0.10" xmlns="http://private.com">
  <DateTime>2013-02-04T14:05:42.912349-06:00</DateTime>
  <Sequence>5058</Sequence>
  <AppID>TEST123</AppID>
  <StatusDesc>
    <EncryptedData>
      <CipherData xmlns="http://www.w3.org/2001/04/xmlenc#">
        <CipherValue>---ENCRYPTED DATA BASE64---</CipherValue>
      </CipherData>
    </EncryptedData>
  </StatusDesc>
  <Severity>Detail</Severity>
</LogEntry>
<LogEntry Version="1.5" PackageVersion="10.10.0.10" xmlns="http://private.com">
  <DateTime>2013-02-04T14:05:42.912350-06:00</DateTime>
  <Sequence>5059</Sequence>
  <AppID>TEST123</AppID>
  <StatusDesc>
    <EncryptedData>
      <CipherData xmlns="http://www.w3.org/2001/04/xmlenc#">
        <CipherValue>---ENCRYPTED DATA BASE64---</CipherValue>
      </CipherData>
    </EncryptedData>
  </StatusDesc>
  <Severity>Detail</Severity>
</LogEntry>
</Logs> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:56:29.840

> 经过多次反复试验，我确定在我的节点上具有 xmlns 属性会导致没有节点从 SelectNodes() 调用返回。不知道为什么。

该`xmlns`属性有效地更改了元素内的默认命名空间，*包括该元素本身*。所以你的`LogEntry`元素的命名空间是`"http://private.com"`. 您需要在 XPath 查询中适当地包含它，可能通过[`XmlNamespaceManager`](http://msdn.microsoft.com/en-us/library/system.xml.xmlnamespacemanager.aspx).

（如果您可以改用 LINQ to XML，则可以*更*轻松地使用命名空间。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:07:29.563

您可以使用 Linq to Xml（如 Jon 所述）。这是根据名称空间解析您的 xml 文件的代码。结果是匿名对象的强类型序列（即 Date 属性的类型为 DateTime，Sequence 为整数，AppID 为字符串）：

```
XDocument xdoc = XDocument.Load("test.xml");
XNamespace ns = "http://private.com";
var entries = xdoc.Descendants("Logs")
                  .Elements(ns + "LogEntry")
                  .Select(e => new {
                      Date = (DateTime)e.Element(ns + "DateTime"),
                      Sequence = (int)e.Element(ns + "Sequence"),
                      AppID = (string)e.Element(ns + "AppID")
                  }).ToList();   

Console.WriteLine("Entries count = {0}", entries.Count);    

foreach (var entry in entries)
{
    Console.WriteLine("{0}\t{1} {2}", 
                      entry.Date, entry.Sequence, entry.AppID);
} 
```

# c# - C#：RunWorkerAsync() 不会触发 DoWork()

> ID：14734517
> 
> 赞同：3
> 
> 时间：2013-02-06T16:54:47.297
> 
> 标签：c#, .net, visual-studio-2010

我正在编写一个基于小型表单的应用程序来连接到 LDAP 服务器，并且我希望“连接”按钮在后台工作。所以我在 [这里关注信息和讨论](https://stackoverflow.com/questions/3065700/how-to-start-and-stop-a-continuously-running-background-worker-using-a-button)

但无论出于何种原因，我的代码似乎无法正常工作：我在 'worker.RunWorkerAsync();' 处设置了一个断点 它只是一步步穿过它。

我究竟做错了什么？我在 Visual Studio 2010 中工作，以防万一。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.DirectoryServices;
using System.Threading;

namespace ldapconnect
{

public partial class Form1 : Form
{
    private void Form1_Load(object sender, EventArgs e)
    {

    }

    public Form1()
    {
        InitializeComponent();
    }

    //server
    public string lds;
    //naming context
    public string root;

    public string username;
    public string password;

    BackgroundWorker worker = new BackgroundWorker();

    private void worker_DoWork(object sender, DoWorkEventArgs e)
    {
        worker = sender as BackgroundWorker;
        foreach (string s in connect(worker, e, lds + "/" + root, txt_user.Text.ToString(), txt_pass.Text.ToString()))
        {
            rtb_results.Text += s + "\r\n";
        }
    }

    private List<string> connect(BackgroundWorker worker, DoWorkEventArgs e, String serv, string usr, string pass)
    {
        //Directory search code taking server path and creds passed in from form
        DirectoryEntry conn = new DirectoryEntry(serv, usr, pass);
        DirectorySearcher ds = new DirectorySearcher(conn);

        //I only want users
        ds.Filter = "objectClass=user";

        List<string> sendBack = new List<string>();

        try
        {
            SearchResultCollection results = ds.FindAll();

            foreach (SearchResult result in results)
            {
                sendBack.Add(result.ToString());                    
            }                
        }
        catch (Exception ex)
        {
            sendBack.Clear();
            sendBack.Add(ex.ToString());
        }

        return sendBack;
    }

    //connect button start background worker
    private void btn_connect_Click(object sender, EventArgs e)
    {
        worker.RunWorkerAsync();
    }

    //Exit Button
    private void btn_close_Click(object sender, EventArgs e)
    {
        this.Close();
    }

    //set server path
    private void btn_server_Click(object sender, EventArgs e)
    {
        string serv = inputBox("ldap://", "IP or DNS Name of LDS Server", "");
        lds = serv;
        lbl_server.Text = lds;
    }

    //set default context
    private void btn_context_Click(object sender, EventArgs e)
    {
        string cntx = inputBox("In CN=,DC=,DC= Form:", "Default Naming Context", "");
        root = cntx;
        lbl_cntx.Text = root;
    }

    //VB interaction box
    private string inputBox(string a,string b,string c)
    {
        return Microsoft.VisualBasic.Interaction.InputBox(a, b, c);
    }

    private void btn_Defaults_Click(object sender, EventArgs e)
    {
        lds = "LDAP://127.0.0.1";
        root = "DC=USERS,DC=TEST,DC=LOCAL";
        txt_user.Text = "reader";
        txt_pass.Text = "password";
        lbl_server.Text = lds;
        lbl_cntx.Text = root;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-06T16:59:51.350

你永远不会把事件联系起来。

```
 public Form1()
    {
        InitializeComponent();
        worker.DoWork += new DoWorkEventHandler(worker_DoWork);
    } 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-06T16:58:27.337

你没有设置

`worker.DoWork += new DoWorkEventHandler(worker_DoWork);`

打电话之前`worker.RunAsync()`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T16:58:26.390

`RunWorkerAsync()`启动工作线程并立即返回，因此调试器似乎“单步执行”。`worker_DoWork()`在方法中设置断点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-09-05T05:12:43.150

如果您仍然有事件并且无法正常工作，请尝试以下操作

打电话

> System.Windows.Forms.Application.DoEvents();

在调用 RunWorkerAsync() 之前

# apache-poi - apache poi cellIterator 跳过空白单元格，但不在第一行

> ID：14734519
> 
> 赞同：14
> 
> 时间：2013-02-06T16:55:00.347
> 
> 标签：apache-poi

我正在创建一个 java 程序来读取一个 excel 表并创建一个逗号分隔的文件。当我运行带有空白列的示例 excel 文件时，第一行运行良好，但其余行跳过空白单元格。我已经阅读了将空白单元格插入行所需的代码更改，但我的问题是为什么第一行有效？？？？

* * *

```
public ArrayList OpenAndReadExcel(){
    FileInputStream file = null;
    HSSFWorkbook workBook = null;
    ArrayList <String> rows = new ArrayList();

    //open the file

    try {
         file = new FileInputStream(new File("Fruity.xls"));
    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        System.out.println("Could not open Input File");
        e.printStackTrace();
    }

    //  open the input stream as a workbook

        try {
             workBook = new HSSFWorkbook(file);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            System.out.println("Can't Open HSSF workbook");
            e.printStackTrace();
        }

        // get the sheet
        HSSFSheet sheet = workBook.getSheetAt(0);

        // add an iterator for every row and column
        Iterator<Row> rowIter = sheet.rowIterator();

        while (rowIter.hasNext())
        {

            String rowHolder = "";
            HSSFRow row = (HSSFRow) rowIter.next();
            Iterator<Cell> cellIter = row.cellIterator();
            Boolean first =true;
            while ( cellIter.hasNext())
            {
                if (!first)
                    rowHolder = rowHolder + ",";

                HSSFCell cell = (HSSFCell) cellIter.next();

                rowHolder = rowHolder + cell.toString() ;
                first = false;
            }

            rows.add(rowHolder);

        }

    return rows;

}
public void WriteOutput(ArrayList<String> rows) {

    // TODO Auto-generated method stub
    PrintStream outFile ;
    try {

        outFile = new PrintStream("fruity.txt");
        for(String row : rows)
        {   
            outFile.println(row);
        }
        outFile.close();

    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

}
-----
我在 .xls 文件中的输入（抱歉不知道如何在此处插入 Excel 表格）

名称 >>>>>>>>>> 原产国 >>>>>>>>> 国家产地>>>>>>> 等级>>>>>>
苹果月数>>>>>>>> 美国>>>>>>>>>>>>>>>>>>>>>> > 华盛顿 >>>>>>>>>>>>>> A >>>>>>>>> 6
橙 >>>>>> 美国 >>>>>>>>>>>>>>> >>>>>>>佛罗里达州>>>>>>>>>>>>>>>>一个>>>>>>>>> 9个
菠萝>>>>> 美国 >>>>>>>>>>>>>>>>>>>>>> 夏威夷 >>>>>>>>>>>>>>>>>> B >>>> >>>>> 10
草莓>>>>美国>>>>>>>>>>>>>>>>>>>>>>新泽西>>>>>>>>>>>>>> C >>>>>>>>>> 3

**我的输出文本文件**
Name ,Country of Origin,State of origin,,,,Grade,No of Months
Apple,USA,Washington,A,6.0
orange,USA,Florida,A, 9.0
菠萝,美国,夏威夷,B,10.0>>>> B >>>>>>>>> 10草莓>>>>美国>>>>>>>>>>>>>>>>>>>>>>新泽西>>>>> >>>>>>>>> C >>>>>>>>>> 3**我的输出文本文件**名称，原产国，原产国，，，等级，苹果，美国，华盛顿，A，月数， 6.0橙,USA,Florida,A,9.0菠萝,USA,Hawaii,B,10.0>>>> B >>>>>>>>> 10草莓>>>>美国>>>>>>>>>>>>>>>>>>>>>>新泽西>>>>> >>>>>>>>> C >>>>>>>>>> 3**我的输出文本文件**名称，原产国，原产国，，，等级，苹果，美国，华盛顿，A，月数， 6.0橙,USA,Florida,A,9.0菠萝,USA,Hawaii,B,10.03**我的输出文本文件**Name ,Country of Origin,State of origin,,,Grade,No of Months Apple,USA,Washington,A,6.0 orange,USA,Florida,A,9.0 pineapple,USA,Hawaii,B,10.03**我的输出文本文件**Name ,Country of Origin,State of origin,,,Grade,No of Months Apple,USA,Washington,A,6.0 orange,USA,Florida,A,9.0 pineapple,USA,Hawaii,B,10.0
草莓，美国，新泽西，C，3.0

* * *

```
Notice the two extra commas before the Grade column... This is because I have two blank columns there.<br/> 
```

其余输出中缺少这些额外的逗号。

我正在使用 Apache Poi-3.9-20121203.jar

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-06T17:11:00.090

您应该阅读Apache POI 网站上的[Iterate Over Rows and Cells 文档。](http://poi.apache.org/spreadsheet/quick-guide.html#Iterator)

CellIterator 将仅返回已在文件中定义的单元格，这主要意味着具有值或格式的单元格。excel 文件格式是稀疏的，并且不会费心存储既没有值也没有格式的单元格。

对于您的情况，您必须将格式应用于第一行，这会导致它们显示出来。

您需要通读[文档](http://poi.apache.org/spreadsheet/quick-guide.html#Iterator)并切换到按索引查找。这也将允许您完全控制如何在代码中处理空白单元格和从未使用过的单元格。

# facebook-graph-api - 如何在时间跨度内将所有评论添加到页面墙上

> ID：14734528
> 
> 赞同：0
> 
> 时间：2013-02-06T16:55:41.060
> 
> 标签：facebook-graph-api, facebook-c#-sdk

我正在寻找一个解决方案，我可以在页面墙上获得最后 50 条评论，或者在一小时内对页面墙上的所有评论和发布日期无关紧要，可以在 2 年前发布，但如果在一小时内得到评论，我需要得到它。我不想把所有的帖子都一一看。

感谢你的付出

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:21:19.737

第一个很容易。向此端点发出 API 调用：

```
/PAGE_NAME_OR_ID/feed?fields=comments.limit(50) 
```

您将被限制在 的正常范围内`feed`，因此此处返回的评论将仅为过去 30 天或 50 个帖子中的评论，以较少者为准。

如果您想要最后 50 条评论，则需要使用 FQL。

```
SELECT time, text, text_tags, post_id FROM comment WHERE post_id IN 
  (SELECT post_id FROM stream WHERE source_id IN 
     (SELECT id FROM profile WHERE username="cocacola") LIMIT 100) 
  ORDER BY time DESC LIMIT 50 
```

请记住，Facebook 的过滤算法在FQL*之后运行。*您可能需要大幅增加这些`LIMIT`值才能保证获得 50 个结果。

# c++ - 异常未解决的外部符号错误

> ID：14734530
> 
> 赞同：2
> 
> 时间：2013-02-06T16:55:42.200
> 
> 标签：c++, visual-studio-2010, dll, linker

我有一个使用 freetype 库编译得很好的项目。

从那时起，我的操作系统已重新安装，因此 Visual Studio 2010 也已重新安装。

我重新包含并重新安装了所有 .lib .dll 和头文件。出于某种原因，现在如果我使用发布配置运行程序，它运行得很好。但是，如果我切换到调试配置，它会在 freetype 库函数上给我来自链接器的未解决的外部符号错误。

现在，我确定这两种配置的 C++ 目录是相同的，因为我使用解决方案设置中的所有配置选项卡重新设置它们。除此之外，两种配置“附加目录/附加依赖项设置”也是如此，以相同的方式设置。

我可以在项目文件夹中的发布文件夹和调试文件夹之间找到的唯一区别是调试文件夹中存在一个名为“vc100.idb”的文件，这是一个最小的重建依赖文件。这看起来很有希望，但删除它没有产生任何结果，所以我把它放回去了。

您对可能导致配置编译之间存在这种差异的原因有任何想法吗？

最糟糕的是，我可以继续在发布配置上编程，但我宁愿不继续这条路，因为我真的很想知道这个问题的根源。

提前致谢，

盖伊

错误：

```
1>freetype.obj : error LNK2019: unresolved external symbol _FT_Glyph_To_Bitmap referenced in function "void __cdecl freetype::make_dlist(struct FT_FaceRec_ *,char,unsigned int,unsigned int *)" (?make_dlist@freetype@@YAXPAUFT_FaceRec_@@DIPAI@Z)
1>freetype.obj : error LNK2019: unresolved external symbol _FT_Get_Glyph referenced in function "void __cdecl freetype::make_dlist(struct FT_FaceRec_ *,char,unsigned int,unsigned int *)" (?make_dlist@freetype@@YAXPAUFT_FaceRec_@@DIPAI@Z)
1>freetype.obj : error LNK2019: unresolved external symbol _FT_Load_Glyph referenced in function "void __cdecl freetype::make_dlist(struct FT_FaceRec_ *,char,unsigned int,unsigned int *)" (?make_dlist@freetype@@YAXPAUFT_FaceRec_@@DIPAI@Z)
1>freetype.obj : error LNK2019: unresolved external symbol _FT_Get_Char_Index referenced in function "void __cdecl freetype::make_dlist(struct FT_FaceRec_ *,char,unsigned int,unsigned int *)" (?make_dlist@freetype@@YAXPAUFT_FaceRec_@@DIPAI@Z)
1>freetype.obj : error LNK2019: unresolved external symbol _FT_Done_FreeType referenced in function "public: void __thiscall freetype::font_data::init(char const *,unsigned int)" (?init@font_data@freetype@@QAEXPBDI@Z)
1>freetype.obj : error LNK2019: unresolved external symbol _FT_Done_Face referenced in function "public: void __thiscall freetype::font_data::init(char const *,unsigned int)" (?init@font_data@freetype@@QAEXPBDI@Z)
1>freetype.obj : error LNK2019: unresolved external symbol _FT_Set_Char_Size referenced in function "public: void __thiscall freetype::font_data::init(char const *,unsigned int)" (?init@font_data@freetype@@QAEXPBDI@Z)
1>freetype.obj : error LNK2019: unresolved external symbol _FT_New_Face referenced in function "public: void __thiscall freetype::font_data::init(char const *,unsigned int)" (?init@font_data@freetype@@QAEXPBDI@Z)
1>freetype.obj : error LNK2019: unresolved external symbol _FT_Init_FreeType referenced in function "public: void __thiscall freetype::font_data::init(char const *,unsigned int)" (?init@font_data@freetype@@QAEXPBDI@Z) 
```

**编辑**：好吧，这很奇怪。我已经从发布配置中的 include 和 library 目录设置中删除了**所有**freetype 目录信息，以及其他依赖项。并且发布的配置版本仍然有效！

这让我相信移动我的文件时缺少一些东西（与配置方面相比）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-24T13:26:32.093

我有同样的问题。

我通过 为平台（或者如果你使用它）编译`freetype`（ freetype-2.5.2\builds\windows\vc2010\freetype.sln ）解决方案来解决它。`x64``win32`

你会得到`.libs`这个平台的。

# asp-classic - IIS 7 上的 ASP:: HTTP/1.1 500 服务器错误

> ID：14734532
> 
> 赞同：0
> 
> 时间：2013-02-06T16:55:53.417
> 
> 标签：asp-classic

到目前为止，我只有部署 php 应用程序的经验。我第一次尝试使用 MSSQL 处理 asp，但仅使用跟踪页面（只是一个表中整体数据的快照），我收到 500 个服务器错误。这些是我在 IIS 部署期间遵循的步骤将文件夹（asp 输出）复制到根目录当我使用本地系统（windows 7 prof）时，我使用“全部未分配”和站点绑定上的新端口（81）{80 已经由 php 站点使用} 进入我的浏览器并输入“localhost:81/index.htm”，这又指向所需的 asp 页面，但我得到的不是包含数据的表，而是“HTTP/1.1 500 服务器错误”

有人可以帮忙吗？我确定我在 IIS 中缺少一些基本设置，但不确定是什么。

非常感谢 Yuvraj

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:00:50.647

你能更具体地说明你是如何设置的吗？例如，在 IIS 中创建新的“网站”时，您需要：

1.  创建一个本地作为您网站的根。在这种情况下，我正在创建一个名为“mysamplesite”的网站，并将根目录放在 c:\inetpub\wwwroot\mysamplesite 中。

![在此处输入图像描述](../Images/0f6408740ec9449b03fd57762f5efd33.png)

我在其中放置了一个名为 index.htm 的文件，其中包含以下内容：

![在此处输入图像描述](../Images/0b31a608f4dc56dd576cf1f0a5ff68d1.png)

2.  现在在 inetmgr（IIS 管理器）中，我右键单击站点并选择“添加 Web sSite ...”

![在此处输入图像描述](../Images/2803e544b31c9e2854d46943e01d49a7.png)

3.  在“添加网站”对话框中，我键入应用程序的名称。在这种情况下，MySampleSite。当我输入时，IIS 也在填写应用程序池的名称。我还输入了根目录的路径 (c:\inetpub\wwwroot\mysamplesite) 并将端口设置为 81。其他一切我都不管了。

![在此处输入图像描述](../Images/7512e1fd986fc5ad667789130c56186f.png)

由于 index.htm 已经在我的文档列表中，所以当我浏览它时会出现该站点。

![在此处输入图像描述](../Images/9c7bb4b1dcf83f5f8d8aa411e7403a4a.png)

你的 eventvwr 有什么显示吗？

# python - 如何按键访问pandas groupby数据框

> ID：14734533
> 
> 赞同：189
> 
> 时间：2013-02-06T16:55:54.167
> 
> 标签：python, pandas, dataframe, group-by, pandas-groupby

如何通过键访问 groupby 对象中相应的 groupby 数据框？

使用以下分组：

```
rand = np.random.RandomState(1)
df = pd.DataFrame({'A': ['foo', 'bar'] * 3,
                   'B': rand.randn(6),
                   'C': rand.randint(0, 20, 6)})
gb = df.groupby(['A']) 
```

我可以遍历它以获取键和组：

```
In [11]: for k, gp in gb:
             print 'key=' + str(k)
             print gp
key=bar
     A         B   C
1  bar -0.611756  18
3  bar -1.072969  10
5  bar -2.301539  18
key=foo
     A         B   C
0  foo  1.624345   5
2  foo -0.528172  11
4  foo  0.865408  14 
```

我希望能够通过其密钥访问组：

```
In [12]: gb['foo']
Out[12]:  
     A         B   C
0  foo  1.624345   5
2  foo -0.528172  11
4  foo  0.865408  14 
```

但是当我尝试这样做时，`gb[('foo',)]`我得到了这个奇怪`pandas.core.groupby.DataFrameGroupBy`的对象，它似乎没有任何与我想要的 DataFrame 对应的方法。

我能想到的最好的是：

```
In [13]: def gb_df_key(gb, key, orig_df):
             ix = gb.indices[key]
             return orig_df.ix[ix]

         gb_df_key(gb, 'foo', df)
Out[13]:
     A         B   C
0  foo  1.624345   5
2  foo -0.528172  11
4  foo  0.865408  14 
```

但这有点讨厌，考虑到大熊猫通常在这些事情上有多好。
这样做的内置方法是什么？

* * *

## 回答 #1

> 赞同：242
> 
> 时间：2013-02-06T17:00:27.800

您可以使用以下[`get_group`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.core.groupby.GroupBy.get_group.html)方法：

```
In [21]: gb.get_group('foo')
Out[21]: 
     A         B   C
0  foo  1.624345   5
2  foo -0.528172  11
4  foo  0.865408  14 
```

*注意：这不需要为每个组创建中间字典/每个子数据帧的副本，因此比使用`dict(iter(gb))`. 这是因为它使用 groupby 对象中已有的数据结构。*

* * *

您可以使用 groupby 切片选择不同的列：

```
In [22]: gb[["A", "B"]].get_group("foo")
Out[22]:
     A         B
0  foo  1.624345
2  foo -0.528172
4  foo  0.865408

In [23]: gb["C"].get_group("foo")
Out[23]:
0     5
2    11
4    14
Name: C, dtype: int64 
```

* * *

## 回答 #2

> 赞同：81
> 
> 时间：2013-06-25T16:27:52.617

用于数据分析的 Python 中的 Wes McKinney（pandas 的作者）提供了以下方法：

```
groups = dict(list(gb)) 
```

它返回一个字典，其键是您的组标签，其值是 DataFrames，即

```
groups['foo'] 
```

将产生您正在寻找的东西：

```
 A         B   C
0  foo  1.624345   5
2  foo -0.528172  11
4  foo  0.865408  14 
```

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2015-03-04T05:25:09.863

而不是

```
gb.get_group('foo') 
```

我更喜欢使用`gb.groups`

```
df.loc[gb.groups['foo']] 
```

因为通过这种方式，您也可以选择多个列。例如：

```
df.loc[gb.groups['foo'],('A','B')] 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-04-30T06:35:40.720

```
gb = df.groupby(['A'])

gb_groups = grouped_df.groups 
```

如果您正在寻找选择性 groupby 对象，请执行：gb_groups.keys()，并将所需的密钥输入以下 key_list..

```
gb_groups.keys()

key_list = [key1, key2, key3 and so on...]

for key, values in gb_groups.items():
    if key in key_list:
        print(df.ix[values], "\n") 
```

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2015-05-31T16:31:49.017

我正在寻找一种方法来对 GroupBy obj 的一些成员进行采样 - 必须解决发布的问题才能完成这项工作。

### 基于`some_key`列创建 groupby 对象

```
grouped = df.groupby('some_key') 
```

### 选择 N 个数据帧并获取它们的索引

```
sampled_df_i  = random.sample(grouped.indices, N) 
```

### 抢组

```
df_list  = map(lambda df_i: grouped.get_group(df_i), sampled_df_i) 
```

### 可选 - 将其全部转回单个数据框对象

```
sampled_df = pd.concat(df_list, axis=0, join='outer') 
```

# c++ - 按列访问矩阵的指针

> ID：14734535
> 
> 赞同：0
> 
> 时间：2013-02-06T16:55:58.120
> 
> 标签：c++, pointers, matrix

使用以下代码，我可以访问指向矩阵的指针所在的行：

```
#include <iostream>
int main(void) {
    const int size = 10;
    float **mat = new float*[size];
    int i,j;
    for (i = 0; i != size; ++i) {
        mat[i] = new float[size];
        for (j = 0; j != size; ++j) {
            mat[i][j] = i * size + j;
        }
    }
    float *p = mat[size-1];
    for (i = 0; i != size; ++i) {
        std::cout << p[i] << " ";
    }
    std::cout << std::endl;
    return 0;
} 
```

印刷：

```
90 91 92 93 94 95 96 97 98 99 
```

有没有办法让我也可以访问该列？非常感谢你:)

编辑：对不起，当我的问题被误解时。我需要的是一个指向矩阵垫中列的指针。我不认为这是可能的，是吗？

EDIT2：我基本上需要的是一个指针，以便我可以进行转换：

```
__m128 *m_ptr = (__m128*) p; 
```

每次额外的迭代都需要 O(n) ，因为我想对代码进行矢量化和加速，所以应该避免这种情况。行访问简单快捷。列访问也应该是可能的？？？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:59:57.753

好吧，如果您想访问*一行*的元素（而不是列，这是您已经访问的），那应该很简单：

```
for (i = 0; i != size; ++i)
{
     std::cout << mat[i][size - 1] << " ";
} 
```

顺便说一句，您的代码正在泄漏，因为您分配了从未释放的内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:02:39.727

列中的元素不能保证在内存中一个接一个...

# ios - 如何将iOS模拟器语言更改为瑞典语

> ID：14734540
> 
> 赞同：15
> 
> 时间：2013-02-06T16:56:20.113
> 
> 标签：ios, ios5, ios-simulator

我想将我的 ios 模拟器语言更改为瑞典语，但在设置中找不到。我现在能做些什么来获得瑞典语。

![在此处输入图像描述](../Images/f2336af25ed1a026432ecdb89d0ffe20.png)

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2017-07-30T08:48:24.550

也可以通过如下所示的方案设置来设置语言和区域：

[![在此处输入图像描述](../Images/88a3ed5bb4ab2046afcb87501f0d6f39.png)](https://i.stack.imgur.com/xrrGl.png)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-02-06T17:08:03.930

如果您正在尝试测试应用程序的本地化，那么有比更改设备上的语言更简单的方法。

您可以运行带有标志的应用程序以指示国家/地区：

即对于瑞典语，您可以使用国旗`-AppleLanguages (sv)`

当然，在模拟器或设备上，你不能正常运行带有标志的应用程序，除非你通过 Xcode 构建和运行它，你可以在其中为每个方案设置启动参数。

我用截图和一个示例项目更详细地写了这个：[https ://abizern.org/2012/03/18/simple-localisation-testing.html](https://abizern.org/2012/03/18/simple-localisation-testing.html)

这适用于模拟器和设备，您无需更改任何设备设置。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-06T17:00:56.460

选择`Svenska`。您可以像在真实设备上一样通过设置选择语言。语言以目标语言显示，而不是当前语言，如屏幕截图所示。

点击你想要的行，然后点击完成（在模拟器的情况下点击）。在设备上，确保您可以返回导航。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-30T12:38:25.283

对于 XCode 12

为此，请点击**活动方案**（活动模拟器左侧的应用程序名称），然后：

*   编辑方案
*   跑
*   选项
*   应用语言

# sql-server - 如何使用不同版本的 SQL Server Management Studio 在数据库之间移动数据？

> ID：14734545
> 
> 赞同：2
> 
> 时间：2013-02-06T16:56:32.970
> 
> 标签：sql-server, sql-server-2008, tsql

我在测试机器和生产机器上部署了一个数据库。测试数据库中有一些数据（表的列）我想复制到生产环境中。

当我尝试将备份恢复到生产盒时，我收到以下错误：

> *System.Data.SqlClient.SqlError：数据库备份在运行版本 10.50.1600 的服务器上。该版本与运行版本 10.00.4000 的此服务器不兼容。在支持备份的服务器上恢复数据库，或使用与该服务器兼容的备份。(Microsoft.SqlServer.Smo)*

是否有另一种方法可以将数据放入表中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:05:08.790

仅当您需要数据时才回答此问题（来自此处：[http ://sqlserverlearner.com/tag/the-database-was-backed-up-on-a-server-running-version-10-50-1600-that-版本与此服务器不兼容](http://sqlserverlearner.com/tag/the-database-was-backed-up-on-a-server-running-version-10-50-1600-that-version-is-incompatible-with-this-server)）：

*   在任务下编写所需的对象（表和数据），生成脚本，选择对象，并确保包括所有数据（可能还有模式）。将其带到一个新的查询窗口并保存 SQL 文件，然后在您的其他服务器上执行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:00:04.800

你可以

*   为相关数据生成 INSERT 语句
*   创建从测试到另一台服务器的链接服务器并针对该服务器运行 sql 语句
*   将目标服务器升级到 2008 R2（这不能掉以轻心）

您应该将您的环境保持在相同的版本/版本。SQL Server 还原不向后兼容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:01:43.423

这是恢复数据库时sqlserver版本不匹配的问题。这意味着无法将数据库服务器2008恢复到2005。它不支持更高版本到更低版本。

以下选项可用，

1.  您可以链接服务器并将表从一台服务器移动到另一台服务器

2.  生成sql脚本并在目标数据库中执行

使用以下 URL 生成插入脚本并将生成的脚本执行到目标服务器。

[http://www.codeproject.com/Articles/5598/Generating-INSERT-statements-in-SQL-Server](http://www.codeproject.com/Articles/5598/Generating-INSERT-statements-in-SQL-Server)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T17:02:18.087

使用带有数据的生成脚本，您可以选择 MSSQL 的版本。然后在您想要的服务器上运行输出的 SQL。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-06T17:06:03.323

理想情况下，您应该升级生产服务器以匹配您的测试环境，否则您的测试可能并不总是具有代表性。

但是，如果它们是不同的版本，则无法将数据库还原到旧版本的 SQL Server，您应该使用生成脚本命令来创建新表并插入数据，或者使用 SQL 比较/数据比较之类的工具来自 RedGate，它将为您完成所有这些工作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-06T18:50:53.877

您可以使用 redgate toolbelt 工具包在不同版本的 sql server 或 sql server to sql azure 或 sql azure to sql server database 之间同步数据。它非常易于使用。

# java - Android：为不同的类读取不同的.txt

> ID：14734549
> 
> 赞同：-1
> 
> 时间：2013-02-06T16:56:58.773
> 
> 标签：java, android, assets

大家好，我知道这可能是一个简单的问题，但我无法解决以下问题。我有不同的 .txt，我有不同的类。我需要为每个班级阅读特定的 txt。为此，我有一个类用于阅读不同的 txt，但我需要在每个类中阅读适当的 .txt。这是我的示例：在这里我阅读了 txt 并说出了我想阅读的 txt：

```
public void currentQuestion(Context context, int cat) {
    category = cat;

    String questionFile = ""; 
```

然后在每节课中，我都需要阅读特定的 txt。例如，在汽车类中，它将是 String questionFile = "cars.txt"; 等等。感谢您的时间

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:14:58.017

只需`getClass().getSimpleName()`在您想在应用程序中使用类名的地方使用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T16:59:47.697

好吧，如果您的文本文件与您的类名同名，那么您可以使用以下内容：

```
String filename = this.getClass().getSimpleName()+".txt" 
```

# jqgrid - Jqgrid 虚拟滚动以编程方式加载下一组行

> ID：14734550
> 
> 赞同：1
> 
> 时间：2013-02-06T16:57:01.380
> 
> 标签：jqgrid, jqgrid-asp.net, jqgrid-php, jqgrid-formatter, mvcjqgrid

我正在使用带有虚拟滚动的 Jqgrid，我正在加载网格中的前 25 条记录。当我单击按钮而不是使用滚动条向下滚动时，我希望基于某些操作来加载接下来的 25 条记录。

有没有办法用接下来的 25 条记录重新加载网格？

# php - urldecode 和从数据库中获取信息的问题

> ID：14734551
> 
> 赞同：0
> 
> 时间：2013-02-06T16:57:03.297
> 
> 标签：php, sql, urldecode

我曾经`urldecode`从以前的站点接收过会员 ID。URL 中显示了正确的 ID，但我无法从数据库中获取信息。

```
<?php

$id = urldecode(trim($_GET['memberID']));
$query = "SELECT * FROM members WHERE memberID = '".$id."'";

if ($result = $db->query($query)) {

while ($row = $result->fetch_assoc()){
    printf("%s (%s)\n", $row["memberID"], $row['name']);
}
}

?> 
```

我得到的只是一个空白屏幕。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:00:26.140

更改`mysql.error()`为`mysql_error()`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-06T16:58:30.787

$query = "SELECT * FROM members WHERE memberID = '".$id."'";

# r - 如何将后续列表元素组合成R中的新列表？

> ID：14734554
> 
> 赞同：1
> 
> 时间：2013-02-06T16:57:17.603
> 
> 标签：r, list, functional-programming

例如：我有一个矩阵列表，我想评估它们的差异，类似于 3-D 差异。所以如果我有：

```
m1 <- matrix(1:4, ncol=2)
m2 <- matrix(5:8, ncol=2)
m3 <- matrix(9:12, ncol=2)
mat.list <- list(m1,m2,m3) 
```

我想获得

```
mat.diff <- list(m2-m1, m3-m2) 
```

我找到的解决方案如下：

```
mat.diff <- mapply(function (A,B) B-A, mat.list[-length(mat.list)], mat.list[-1]) 
```

有没有更好的/内置的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:46:16.950

您可以使用`lapply`循环或其他方式执行此操作：

```
mat.diff <- lapply( tail( seq_along(mat.list), -1 ), 
                    function(i) mat.list[[i]] - mat.list[[ i-1 ]] ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:38:13.687

您可以使用`combn`生成矩阵的索引并对每个组合应用一个函数。

```
 combn(1:length(l),2,FUN=function(x) 
            if(diff(x) == 1)         ## apply just for consecutive index 
                  l[[x[2]]]-l[[x[1]]], 
                  simplify = FALSE)  ## to get a list 
```

使用@Arun 数据，我得到：

```
[[1]]
     [,1] [,2]
[1,]    4    4
[2,]    4    4

[[2]]
NULL

[[3]]
     [,1] [,2]
[1,]    4    4
[2,]    4    4 
```

# android - 映射一个对象android

> ID：14734559
> 
> 赞同：-4
> 
> 时间：2013-02-06T16:57:41.160
> 
> 标签：android

嗨，我正在尝试从地图中创建对象中的键/值数组。我在全局操作类中有一个函数，它通过传入具有值的对象来制定一个 url，将它们分解为一个字符串以添加到我的 url。有谁知道如何映射一个对象并将所有键/值提取到一个字符串？

这是我到目前为止所拥有的

```
public final static void startAPICallRequest(Context activityContext, String request, String apiLocation, Object postVarsObj, JSONObject getVarsObj){

            long unixTimeStamp = System.currentTimeMillis() / 1000L;

            Log.v("globals", "getVarsObj: " + getVarsObj);

                if(getVarsObj != null){

             Map map = (Map) getVarsObj;
             for (Object key : map.keySet()) {
                 ((Object) getVarsObj).toString();

            }

             Log.v("globals","map=" + map);

        }

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:24:12.343

声明时尝试使用参数`Map`

`Map<K,V> map = new Map<K,V>();`

`K`您要使用的数据类型在哪里，`key`以及`V`您将`value`在`Map`. 看起来您的价值将是 a`Object`而您的密钥可能是`String`. 然后将您的对象添加到`Map`with`map.put(k,v)`

# javascript - 淘汰赛 - 在视图模型中更新 observableArray

> ID：14734561
> 
> 赞同：1
> 
> 时间：2013-02-06T16:57:44.290
> 
> 标签：javascript, knockout.js

我希望将我的视图模型作为 JSON 字符串保存到数据库中。这个想法是我可以通过读回 JSON 并使用直接方法加载我的视图模型的数据来重新加载我的视图模型：

从淘汰赛文档：

```
// Load and parse the JSON
var someJSON = /* Omitted: fetch it from the server however you want */;
var parsed = JSON.parse(someJSON);

// Update view model properties
viewModel.firstName(parsed.firstName);
viewModel.pets(parsed.pets); 
```

这一切都很好，但是我已经初始化了我的模型并且我只是用我已经保存的模型来更新它，我看不到如何在数组的下拉列表中选择最初选择的条目。

换句话说，当我保存我的模型时，宠物下拉列表被选择为“猫”。然后我将下拉列表选择更改为“狗”。重新加载保存的模型时，我需要将下拉列表选择重置为“Cat”。

我对此有点担心，因为我有一些对象数组也需要从保存的模型中读取，而且看起来很难做到。

欢迎任何想法或建议:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T01:18:17.507

您正在寻找的是 Knockout 的映射插件。 [http://knockoutjs.com/documentation/plugins-mapping.html](http://knockoutjs.com/documentation/plugins-mapping.html)

它具有处理 JSON 到 observables 和返回的方法。

所以在你的例子中你可以这样做：

```
var viewModel = ko.mapping.fromJSON(someJSON); 
```

当您准备好返回服务器时：

```
var jsonData = ko.mapping.toJSON(viewModel); 
```

如果你需要的话，还有对象文字助手（ko.mapping.toJS & ko.mapping.fromJS）

# html - 如何在语义上标记诗歌文本？

> ID：14734564
> 
> 赞同：21
> 
> 时间：2013-02-06T16:57:50.203
> 
> 标签：html, meta-tags, semantics, semantic-web, semantic-markup

用什么写诗？

*   `pre`
*   `blockquote`
*   `code`
*   别的东西？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-02-07T14:48:15.593

不要使用[`code`](http://www.w3.org/TR/html5/text-level-semantics.html#the-code-element)（除非计算机代码*是*诗歌的一部分）。不要使用[`blockquote`](http://www.w3.org/TR/html5/grouping-content.html#the-blockquote-element)（除非你引用一首诗）。

### 空格/换行符：`pre`或`br`

您可以使用[`pre`元素](http://www.w3.org/TR/html5/grouping-content.html#the-pre-element). 该规范给出了一个（信息丰富的）示例：

> 下面展示了一首当代诗歌，它使用 pre 元素来保留其不寻常的格式，这构成了诗歌本身的内在部分。
> 
> ```
> <pre>                maxling
> 
> it is with a          heart
>                heavy
> 
> that i admit loss of a feline
>         so           loved
> 
> a friend lost to the
>         unknown
>                                 (night)
> 
> ~cdr 11dec07</pre> 
> ```

`pre`但是，如果诗歌包含“更多”而不仅仅是有意义的换行符，我只会使用该元素（例如，在此示例中，水平空格是有意义的）。

如果你有一首简单的诗，我会选择[`br`元素](http://www.w3.org/TR/html5/text-level-semantics.html#the-br-element)：

> `br`元素只能用于实际上是内容一部分的换行符，如诗歌或地址。

### 容器：`p`

对于大多数诗歌来说，[`p`元素](http://www.w3.org/TR/html5/grouping-content.html#the-p-element)是正确的候选者（当然也可以是*几个* `p`元素）。该规范有一个（信息丰富的）示例：

> ```
> <p>There was once an example from Femley,<br>
> Whose markup was of dubious quality.<br>
> The validator complained,<br>
> So the author was pained,<br>
> To move the error from the markup to the rhyming.</p> 
> ```

[还有](http://www.w3.org/TR/html5/dom.html#paragraph)：

> 例如，一个地址也是一个段落，就像一首诗中的表格、署名或节的一部分一样。

### 结构： ( `article`, `figure`)

根据上下文（内容、页面结构等），分段元素可能是合适的（[`article`](http://www.w3.org/TR/html5/sections.html#the-article-element)在大多数情况下）。

同样根据上下文，该[`figure`元素](http://www.w3.org/TR/html5/grouping-content.html#the-figure-element)可能是合适的：

> 在这里，一首诗的一部分是用 标记的`figure`。
> 
> ```
> <figure>
>  <p>'Twas brillig, and the slithy toves<br>
>  Did gyre and gimble in the wabe;<br>
>  All mimsy were the borogoves,<br>
>  And the mome raths outgrabe.</p>
>  <figcaption><cite>Jabberwocky</cite> (first verse). Lewis Carroll, 1832-98</figcaption>
> </figure> 
> ```

但是不要将这些一般用于所有诗歌，如果它们的使用正确，这真的取决于页面。

### 杂项 琐事

*   有人[提出](https://www.w3.org/Bugs/Public/show_bug.cgi?id=15683)了一个`poetry`元素（→ 拒绝）
*   有人[提出](http://microformats.org/discuss/mail/microformats-new/2007-October/000929.html)了诗歌的微格式
*   w3.org wiki 中的讨论：[Explicit Markup to Semantically Express Poetic Forms](http://www.w3.org/html/wg/wiki/PoeticSemantics) *（感谢链接，steveax）*
    *   另见：[在邮件列表中](http://lists.w3.org/Archives/Public/public-html/2007Oct/0048.html)
*   网站管理员 SE 上的类似问题：[如何在 HTML 中为 SEO 标记一首诗](https://webmasters.stackexchange.com/q/52944/17633)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-16T02:08:18.397

我寻找了相同的信息，同样地，没有找到任何明确的“最佳实践”——所以我想我只需要找出我自己的方法。根据规范，该`<p>`标记作为节标记确实有意义，其中行除以`<br>`s，但我发现该标记样式不能提供足够的灵活性。

具体来说，我想控制缩进。例如，如果一条线对于文本列的宽度来说太宽，它不应该只是中断：它的延续应该缩进。只有（据我所知）每行都是自己的块元素时，才能实现这种悬挂缩进。因此，在我的情况下，我将每首诗行都设置`<p>`为一个类（例如，“诗行”）。然后我可以使用以下 CSS：

```
.poetry-line {
    text-indent: -2em;
    margin-left: 2em;
} 
```

在另一个例子中，我发布的这首诗每隔一行缩进，在节的末尾有一些不规则的地方。我无法`<br>`在每行之间仅使用 s 来实现此效果。我必须为“缩进线”创建一个新类并手动应用它。

我只是分享我的经验。我想我的建议是你为每一行使用一个块级元素，用于格式化。这可能是 a `<p>`，或者我猜您可以使用 CSS 将 a`<span>`的“显示”设置为“阻止”。在任何情况下，我认为，规范`<br>`中行间带有 s 的示例不适用于大多数诗歌：每行都需要成为自己的元素。

# javascript - jQuery中remove()和detach()的区别

> ID：14734565
> 
> 赞同：0
> 
> 时间：2013-02-06T16:57:55.123
> 
> 标签：javascript, jquery

我有一个与 jQuery`.remove()`方法有关的问题。考虑这段代码：

```
var x;
$("#btn1").click(function() {
    x = $("p").remove();
});
$("#btn2").click(function() {
    $("body").prepend(x);
}); 
```

如果在单击按钮 2 时检查了代码，则恢复段落元素。听说`remove()`和`detach()`方法不一样。当`remove()`自己保留所有 jQuery 数据时，它们有何不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:02:20.307

`.remove()`从`jQuery.cache`. 此类数据包括自定义数据集`.data()`和 jQuery 事件模型所需的数据。

`.detach()`不会删除该数据。

`.remove()/.detach()`另外只需从 DOM 树中删除元素。这就像从数组中删除一个项目......即使它不再在数组中，项目本身也不会神奇地消失。特别是如果您像在代码中那样保留对它的引用。

# ios - 单例和委托

> ID：14734568
> 
> 赞同：3
> 
> 时间：2013-02-06T16:58:04.337
> 
> 标签：ios, objective-c, delegates, singleton

我阅读了有关单例和委托的足够信息。所以，我想我明白什么是单例。关于代表团，我仍然感到困惑。我理解委托的概念，但我需要创建我的协议来理解委托。

好的，我创建了单例来处理来自 CoreData 的实体。也许我错了，它不是单身，请告诉我。我的单身人士是 FetchData。

获取数据.h

```
#import <Foundation/Foundation.h>

@interface FetchData : NSObject <UIApplicationDelegate>

+(FetchData*) fetchData;

-(NSArray*)fetchLogin:(NSString*)name;
-(BOOL)newGroup:(NSString*)group forLogin:(NSString*)login;
-(NSMutableArray*)contactsForGroup:(NSString*)group;
-(BOOL)newContact:(NSString*)name surname:(NSString*)surname withDatas:(NSArray*)array;
//other methods 

@end 
```

获取数据.m

```
#import "FetchData.h"
#import "Contact.h"
#import "Login.h"
#import "Group.h"
#import "AppDelegate.h"

@interface FetchData ()
@property (nonatomic, strong) NSEntityDescription *loginEntity;
@property (nonatomic, strong) NSEntityDescription* groupEntity;
@property (nonatomic, strong) NSManagedObjectContext* context;
@property (nonatomic, strong) NSEntityDescription* contactEntity;
@property (nonatomic, strong) AppDelegate* appDelegate;
//other properties
@end

@implementation FetchData
@synthesize //my properties

+(FetchData*) fetchData
{
 static  FetchData* fetchData = nil;
 if (!fetchData) 
    fetchData = [[super allocWithZone:nil]init];
 return fetchData;
}

+(id)allocWithZone:(NSZone *)zone
{
 return [self fetchData];
}

//implementation my methods
@end 
```

所以，对我来说，现在使用 CoreData 非常容易。我只需要导入 FetchData 并简单地使用创建/删除/更改/添加/排序的方法...

SomeClass.m

```
#import "FetchData.h"
#define fetching [FetchData fetchData] 
```

但我认为我可以用于我的目标代表团。或者，与单例相比，这可能是最好的选择。所以我想为委托重新制作单例。我需要这个问题的帮助。我应该做什么？

如果我理解正确，我需要使用 FetchData.h、FetchData.m 中的所有方法创建协议，我可以不用更改就离开。在 SomeClass 我需要导入 FetchData 并添加我的协议。喜欢：

```
#import <Foundation/Foundation.h>

@protocol FetchingDelegate

//all methods from FetchData.h

@end

@interface FetchData : NSObject
@property (nonatomic, strong) id <FetchingDelegate> delegate;
@end 
```

获取数据.m

```
@interface FetchData()
//all properties without changing
@end

@implementation FetchData
@synthesize //all properties and delegate

//implementation of methods
@end 
```

某类

```
#import "FetchData.h"

@interface SomeClass : NSObject <FetchingDelegate>
@end

@implementation SomeClass

-(void)viewDidLoad
{
  FetchData* fetching = [FetchData new]
  fetching.delegate = self
}
//and now I can use any methods from protocol like [fetching anyMethod]
//such I used with singleton 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T17:32:29.220

单例的想法是您的整个应用程序都可以访问这一类。多个视图控制器可能需要来自您的数据库的数据。在您的情况下，我会更改您的`fetchData`方法（并且可能会更改其名称，因为它现在并不真正遵循约定）：

```
+(FetchData*) fetchData
{
    static FetchData *fetchData;
    dispatch_once_t token;
    dispatch_once(&token, ^{
        if (!fetchData) 
            fetchData = [super init];
    }
 return fetchData;
} 
```

委托用于一对一通信，这意味着一个对象有一个委托并将任何消息发送给该特定委托。

这意味着单例和委托不能很好地结合在一起。单例用于向多个接收者发送消息，而委托模式用于一对一通信。所以你有两个选择：你可以不使用单例并使用委托模式，或者你可以使用单例，并使用`NSNotificationCenter`通知观察者更改。

# css - 显示块，边距自动，指定宽度，不居中

> ID：14734572
> 
> 赞同：0
> 
> 时间：2013-02-06T16:58:22.997
> 
> 标签：css

```
.DOC {
    display:block;
    margin-left:auto;
    margin-right:auto;
    width:1265px;
} 
```

`.DOC`是标签`div`内部的一个`body`，但它不是居中的。为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:06:45.330

您的宽度*可能*是问题所在。尝试将其设置为较小的用于开发目的，例如 100px。

见这里，[http://jsfiddle.net/tJd5M/](http://jsfiddle.net/tJd5M/)

```
.DOC {
  display:block;
  margin: 0 auto;
  width:100px;
  background:orange;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:12:53.477

那应该工作

见[http://jsfiddle.net/yWkyE/](http://jsfiddle.net/yWkyE/)

```
.DOC
{
  width:100px;
  height:100px;
  margin:0 auto;
  background-color:#000000;
} 
```

页面上是否还有其他 CSS 可能会影响此 DIV？你的HTML是什么样的，你能提供一个样本吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:17:19.660

你的风格对我来说很好......

**添加边框将显示页面中心的 div 或不...**

```
.DOC {
    display:block;
    margin-left:auto;
    margin-right:auto;
    width:1265px;
    border:1px solid red;
} 
```

如果您想**将 Div 的内容对齐到中心**，请尝试以下样式

```
.DOC {
    display:block;
    margin-left:auto;
    margin-right:auto;
    width:1265px;
    border:1px solid red;
    text-align: center;
} 
```

**HTML**

```
<div  class="DOC">Sample Text</div> 
```

**最好减少宽度并尝试....它将显示准确性**

# c# - C# Excel - 将每个工作表保存到新工作簿

> ID：14734578
> 
> 赞同：5
> 
> 时间：2013-02-06T16:58:31.210
> 
> 标签：c#, excel

我有一个包含 25 个左右工作表的 Excel，我只想将每个工作表保存为它自己的新工作簿。当我运行代码时，它会复制整个工作簿而不是单个工作表。任何帮助都是极好的。

```
string FileDropLocation = @"C:\ExcelFiles";
        string file_FullFileName = @"C:\ts\Conversion\v2.xlsx";
        Microsoft.Office.Interop.Excel.Application app = new Microsoft.Office.Interop.Excel.Application();
        Microsoft.Office.Interop.Excel.Workbook workBook = app.Workbooks.Open(file_FullFileName, 0, true, 5, "", "", true, Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, "\t", false, false, 0, true, 1, 0);
for (int i = 0; i < workBook.Worksheets.Count; i++)
        {
            Microsoft.Office.Interop.Excel.Worksheet workSheet = (Microsoft.Office.Interop.Excel.Worksheet)workBook.Sheets[i+1];
            workSheet.SaveAs(FileDropLocation + "\\" + workSheet.Name);
        }
        workBook.Close(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T18:43:15.917

试试这个代替你当前的`for`循环和下面

```
 foreach(Worksheet sheet in workBook.Worksheets)
    {
        var newbook = app.Workbooks.Add(1);
        sheet.Copy(newbook.Sheets[1]);

        newbook.SaveAs(FileDropLocation + "\\" + sheet.Name);
        newbook.Close();
    }

    workBook.Close(); 
```

请注意，我相信`Workbooks.Add()`放置在默认的空白表（通常是 Sheet1）中，因此如果您只想要复制的表，则必须明确删除它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T19:00:05.307

我知道这行得通。

```
Microsoft.Office.Interop.Excel.Application xl = null;
            Microsoft.Office.Interop.Excel._Workbook wb = null;
            xl = new Microsoft.Office.Interop.Excel.Application();
            xl.SheetsInNewWorkbook = 1;
            xl.Visible = true;
            wb = (Microsoft.Office.Interop.Excel._Workbook)(xl.Workbooks.Add(Type.Missing));

            wb.SaveAs(FileDropLocation + "\\" + workBook.Sheets[i + 1].Name, Microsoft.Office.Interop.Excel.XlFileFormat.xlExcel8, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Microsoft.Office.Interop.Excel.XlSaveAsAccessMode.xlExclusive, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);
            wb.Close(true, Type.Missing, Type.Missing);
            xl.Quit();
            Microsoft.Office.Interop.Excel.Workbook destWorkbook = null;
            Microsoft.Office.Interop.Excel.Worksheet workSheet = null;
            Microsoft.Office.Interop.Excel.Worksheet newWorksheet = null;

            destWorkbook = app.Workbooks.Open(FileDropLocation + "\\" + workBook.Sheets[i + 1].Name + ".xls", false, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);
            workSheet = (Microsoft.Office.Interop.Excel.Worksheet)workBook.Sheets[i + 1];
            newWorksheet = (Microsoft.Office.Interop.Excel.Worksheet)destWorkbook.Worksheets.Add(Type.Missing, Type.Missing, Type.Missing, Type.Missing);
            app.DisplayAlerts = false;
            workSheet.Copy(Type.Missing,newWorksheet);
            destWorkbook.Save(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T18:30:46.843

...您需要在循环中创建一个新工作簿并将工作表移动到该工作簿。我在 VB 中编程，所以我猜，但你的 foo 循环内的代码应该是这样的：

```
Microsoft.Office.Interop.Excel.Workbook workBook2 = app.Workbooks.Add(Missing.Value)
Microsoft.Office.Interop.Excel.Worksheet workSheet = (Microsoft.Office.Interop.Excel.Worksheet)workBook.Sheets[i+1];
workSheet.Copy(workBook2.Sheets(1)) 
```

然后您可以添加代码以删除其他工作表等。

希望对您有所帮助。

# java - Java的'=='双打运算符

> ID：14734579
> 
> 赞同：9
> 
> 时间：2013-02-06T16:58:34.313
> 
> 标签：java, floating-point, equals-operator

此方法返回“真”。为什么 ？

```
public static boolean f() {
   double val = Double.MAX_VALUE/10;
   double save = val;
   for (int i = 1; i < 1000; i++) {
       val -= i;
   }
   return (val == save);
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-06T17:02:33.220

*您正在从一个巨大*的价值中减去一个很小的价值（小于 1000）。小值比大值小得多，以至于最接近理论结果的可表示值仍然是原始值。

基本上这是浮点数工作方式的结果。

想象一下，我们有一些十进制浮点类型（只是为了简单起见），它只在尾数中存储 5 个有效数字，以及 0 到 1000 范围内的指数。

你的例子就像写 10 ^(999) - 1000 ......想想当四舍五入到 5 个有效数字时结果会是什么。是的，*确切的*结果是 99999.....9000（有 999 位数字），但如果您只能用 5 个有效数字表示值，那么最接近的结果又是 10 ^(999)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:09:39.887

`Double.MAX_VALUE`如此之大，以至于 JVM 无法区分它和`Double.MAX_VALUE-1000`

如果从结果中减去小于“1.9958403095347198E292”的数字，`Double.MAV_VALUE`仍然是`Double.MAX_VALUE`.

```
System.out.println(  
            new BigDecimal(Double.MAX_VALUE).equals( new BigDecimal(  
                        Double.MAX_VALUE - 2.E291) )  
                ); 

System.out.println(  
           new BigDecimal(Double.MAX_VALUE).equals( new BigDecimal(  
                        Double.MAX_VALUE - 2.E292) )  
                       ); 
```

输出：

真的

错误的

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T17:04:34.480

当您设置`val`为 Double.MAX_VALUE/10 时，它被设置为大约等于 的值`1.7976931348623158 * 10^307`。从中减去 1000 之类的值将需要双精度表示，这是不可能的，因此它基本上`val`保持不变。

根据您的需要，您可以使用`BigDecimal`而不是`double`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-06T17:08:18.550

`Double.MAX_VALUE`与 1 或 1000 相比，这是一个巨大的数字。`Double.MAX_VALUE-1`通常等于`Double.MAX_VALUE`。所以你的代码在减去 1 或 1000 到`Double.MAX_VALUE/10`. 永远记住：

1.  `double`s 或`float`s 只是实数的近似值，它们只是有理数，在实数中分布不均
2.  您应该非常小心地在`double`s 或`float`s 之间使用不相近的算术运算符（还有许多其他规则，例如这样......）
3.  一般来说，永远不要使用`double`s 或者`float`如果你需要任意精度

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-06T17:02:50.797

double 没有足够的精度来执行您尝试的计算。所以结果与初始值相同。

`==`这与运营商无关。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-06T17:04:46.000

`val`是一个很大的数字，当从中减去`1`（或什`1000`至 ）时，结果不能正确地表示为一个`double`值。这个数字的表示`x`和`x-1`是一样的，因为`double`只有有限的位数来表示无限的数字。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-07T06:54:12.277

浮点计算的结果是最接近准确答案的可表示值。这个程序：

```
public class Test {
  public static void main(String[] args) throws Exception {
    double val = Double.MAX_VALUE/10;
    System.out.println(val);
    System.out.println(Math.nextAfter(val, 0));
  }
} 
```

印刷：

```
1.7976931348623158E307
1.7976931348623155E307 
```

这些数字中的第一个是您的原始 val。第二个是小于它的最大双倍。

当您从 1.7976931348623158E307 中减去 1000 时，确切答案在这两个数字之间，但非常非常接近 1.7976931348623158E307 而不是 1.7976931348623155E307，因此结果将四舍五入为 1.7976931348623155E3

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-06T17:17:13.657

因为`double`是[浮点数值](http://en.wikipedia.org/wiki/Floating_point)类型，是数值*逼近的一种方式。*浮点表示对数字进行编码，以便我们可以存储比通常更大或更小的数字。但是，并非所有数字都可以在给定空间中表示，因此多个数字会四舍五入为相同的浮点值。

作为一个简化的例子，我们可能希望能够在一些通常只能存储 -10 到 10 的小空间中存储范围从 -1000 到 1000 的值。所以我们可以将所有值四舍五入到最接近的千位并将它们存储在小空间中：-1000 编码为`-10`， -900 编码为`-9`， 1000 编码为`10`。但是如果我们想存储 -999 怎么办？我们可以编码的最接近的值是 -1000，因此我们必须将 -999 编码为与 -1000: 相同的值`-10`。

实际上，浮点方案比上面的例子复杂得多，但概念是相似的。数字的浮点表示只能表示所有可能的数字中的*一部分*，所以当我们有一个不能作为方案的一部分表示的数字时，我们必须将其四舍五入到最接近的可表示值。

在您的代码中，1000 以内的所有值都会`Double.MAX_VALUE / 10`自动四舍五入为`Double.MAX_VALUE / 10`，这就是计算机认为`(Double.MAX_VALUE / 10) - 1000 == Double.MAX_VALUE / 10`.

# javascript - 使用 Google Apps 脚本的工作流程 - 我需要在第一步中向用户发送电子邮件

> ID：14734582
> 
> 赞同：0
> 
> 时间：2013-02-06T16:58:41.440
> 
> 标签：javascript, html, function, variables, google-apps-script

我正在创建一个工作流程，将表单的正文通过电子邮件发送给该工作流程中的用户。我可以遍历用户并发送电子邮件，但我现在不知道如何为电子邮件正文传递“e”参数。我实际上已经有一个可以发送 body 的功能，但是我需要将其包含在我的步骤过程中（我认为）。

听到是我将发送电子邮件的代码

```
function sendEmail_(e) {

  var sheet = SpreadsheetApp.openById("0AuCblud0Ss7sdfA1bXZjYXA0Y0IhthkhUQm5vWG02MVE").getActiveSheet();

 var row = sheet.getLastRow()+1;

 sheet.getRange(row,3).setValue(row);

    var range = sheet.getRange(sheet.getLastRow(),1,1,23);
 range.setValues([[e.parameter.LastName,e.parameter.FirstName,row /*e.parameter.DivisionName*/,e.parameter.EffectiveDate,e.parameter.Status, 

          e.parameter.Network,e.parameter.EmployeeNewPosition,e.parameter.DivisionFolder,e.parameter.SpecificIndividual,
                    e.parameter.Email,e.parameter.username,e.parameter.who,e.parameter.Banner,e.parameter.RMS ,e.parameter.HAPPY,e.parameter.Sweeps,
                   e.parameter.Comcate,e.parameter.Netviewer,e.parameter.NetDispatcher,e.parameter.IMARS,"pending", e.parameter.DivHeadEmail,  e.parameter.Director]]);

   var body = '<form action= <form action = " https://sites.google.com/a/macros/wichitafallstx.gov/s/AKfycbxAOGO6q9ofauf34xlDA9sLG8sUXeZsuvQkDKATOQ/exec" method ="post">' +

      "<b>Last Name:</b>" + e.parameter.LastName +  '<br><br>' + 
 "<b>First Name:</b>" +  e.parameter.FirstName +  '<br><br>' + 
"<b>Division Name:</b>" + e.parameter.DivisionName +  '<br><br>' + 
"<b>Effective Date:</b>" + e.parameter.EffectiveDate +  '<br><br>' + 
  "<b>Employee Status:</b>" + e.parameter.Status +  '<br><br>' + 
    "<b>Network:</b>" + e.parameter.Network +  '<br><br>' + 
"<b>Employee New Position:</b>" + e.parameter.EmployeeNewPosition +  '<br><br>' + 
"<b>Division Folder:</b>" + e.parameter.DivisionFolder +  '<br><br>' + 
"<b>Specific Individual:</b>" + e.parameter.SpecificIndividual +   '<br><br>' + 
"<b>Email:</b>" + e.parameter.Email +  '<br><br>' + 
"<b>Username:</b>" + e.parameter.username +  '<br><br>' +  
"<b>who:</b>" + e.parameter.who +  '<br><br>' + 
"<b>Banner:</b>" + e.parameter.Banner + '<br><br>' + 
"<b>RMS:</b>" + e.parameter.RMS + '<br><br>' + 
  "<b>HAPPY:</b>" + e.parameter.HAPPY + '<br><br>' + 
    "<b>Sweeps:</b>" + e.parameter.Sweeps + '<br><br>' + 
      "<b>Comcate:</b>" + e.parameter.Comcate + '<br><br>' + 
        "<b>Netviewer:</b>" + e.parameter.Netviewer + '<br><br>' + 
          "<b>NetDispatcher:</b>" + e.parameter.NetDispatcher + '<br><br>' + 
            "<b>IMARS:</b>" + e.parameter.IMARS + 
      '<br />' + 
       '<br />' +    

         '<input type="hidden" name="row" value=" ' + row +' "/>' +
       '<input type="submit" value="Approve" onclick="approve()" />' +
         '</form>' 
            ; 

  //  var owners = e.parameter.DivHeadEmail;
//  var mail = MailApp.sendEmail(owners, "test",'' , {htmlBody:body});

} 
```

我需要通过这个“createStep”函数中的工作流程中的步骤从上面的代码中通过电子邮件发送 html 正文。我不知道如何将上面代码中的变量“body”引用到这个函数，或者即使我可以在这个函数中包含 html 正文。我该怎么做？

```
function createStep(approvers) {

 var step = new Object();//javascript object

  step['numberOfApprovers'] = approvers.length; //set number of approvers passed in array
 step['approvers'] = approvers.slice(0); //slice copies array 
  step['status'] = 'pending'; //set statust to pedning

  for (var i in approvers)
    step[approvers[i]] = 'pending'; //iterate field that indicates specific status

for (var m in approvers)
    step[approvers[m]] = MailApp.sendEmail(approvers, "test", "test",{htmlBody:body});

  return step

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T22:42:58.750

我会创建一个包含两个工作表的电子表格。第一个包含数据，第二个包含批准者列表。第一张表中的一列表示最后一个批准人。

因此，您的脚本会检查数据工作表中的行，并发送一封电子邮件，其中包含尚未批准的行的数据。它包括一个批准链接。接收方检查数据，然后单击链接进行批准。

这将他带到一个脚本，他必须在其中登录。脚本检查用户是否具有预期的批准者，如果确定，则增加数据表中批准者列中的值。当有更多的批准者时，继续循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T21:07:36.320

再想一想，并试图了解流程，为什么不创建一个仅在屏幕上显示信息的 Web 应用程序，其下方有一个“批准”按钮，并将该应用程序的链接发送给每个批准者？优点是您可以仅向登录用户授予对脚本的访问权限，并检查正确的人是否正在批准 - 使其更加安全。

请注意，您可以使用 ObjDB 库轻松地从电子表格中检索一行： [http ://www.harryonline.net/scripts/objdb-storing-data-with-google-apps-script/482](http://www.harryonline.net/scripts/objdb-storing-data-with-google-apps-script/482)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T20:46:39.200

如果要在两个函数中包含主体变量，请在函数外部声明变量：

```
var body;

function sendEmail_(e) {
  ...
  body = ...

}

function createStep(approvers) {
  ...
  sendEmail(..., {htmlBody:body}
  ..
} 
```

但是，我认为您不能将 POST 参数发送到脚本，GET 应该可以工作。但我自己没有试过。

# android - Android：谷歌加按钮加载永不停止

> ID：14734583
> 
> 赞同：3
> 
> 时间：2013-02-06T16:58:43.387
> 
> 标签：android, google-plus

我一直在按照本[教程](https://developers.google.com/+/mobile/android/recommend)来实现 Google +1 按钮。

我证实我是`ConnectionCallbacks.onConnected`从我的`PlusClient`听众那里得到的。

它向我显示了有多少人对此 +1，但是当我尝试单击按钮时，它开始加载并且永不停止。

有什么想法有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-07T10:35:44.940

我找到了解决方案：我在我的 +1 按钮上放了一个这样的监听器：

```
mPlusOneButton.setOnPlusOneClickListener 
```

如此处所述：[Android上的PlusOneButton如何知道用户是否点击了？](https://stackoverflow.com/questions/17695035/plusonebutton-on-android-how-to-know-if-user-has-clicked/17840419#17840419)

它创造了这个错误......

不要使用这个监听器！！！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-11-07T14:42:24.183

您必须先登录才能安全使用 +1 功能。

# sql - SQL 如果存在具有相同 ID 的行，则忽略空值

> ID：14734584
> 
> 赞同：0
> 
> 时间：2013-02-06T16:58:45.853
> 
> 标签：sql, sybase

我有一个包含以下数据的 Sybase 表（示例）：

```
Users:

 ID        Type         PlayerID
 --------  -----------  ------------------- 
 65823     1            (null)              
 65823     2            187                 
 91817     1            (null)                         
 37950     1            773                 
 37950     1            (null)              
 37968     1            (null)              
 37968     1            773                                
 72576     1            (null)              
 72576     1            (null) 
```

我想返回用户和类型的所有组合，但如果有**多个**特定用户/类型组合的示例，则只显示**不为 null**的记录。

例如，上表应返回以下内容

```
 ID        Type         PlayerID
 --------  -----------  ------------------- 
 65823     1            (null)           - although this is null the type/id is unique   
 65823     2            187              
 91817     1            (null)           - this is null but is a unique type/id              
 37950     1            773                                         
 37968     1            773              - this is included and the id/type that has a null player id isn't                              
 72576     1            (null)           - this is a unique type/id 
```

到目前为止，我已经研究了使用 group by、have 和 inner joins 的查询，但一直无法找到一种方法来匹配我正在寻找的结果。

我还查看了 group by 之类的东西，然后在 PlayerID 上使用 max，但聚合函数忽略了 null 值。

如何返回带有玩家 ID 的唯一 ID/类型对？

--

保罗的问题：

```
ID        Type         PlayerID
 --------  -----------  ------------------- 
 65823     2            187                        
 37950     1            773                                         
 37968     1            773 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:22:40.367

在 SQL 方面，您可以这样做：

```
select * from mytable t1 where playerId is not null
union
select * from mytable t2 where playerid is null 
   and not exists (
          select * from mytable t3 where t2.id=t2.id and t2.type=t3.type
       ) 
```

我不知道它会有多有效，但它会给你你想要的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:03:42.333

做什么

```
select  ID, type, max(PlayerID)
from    Users
group by ID, type 
```

返回？（我没用过sybase）

# android - onContextItemSelected 为片段调用了两次

> ID：14734586
> 
> 赞同：3
> 
> 时间：2013-02-06T16:58:51.540
> 
> 标签：android, android-listview, actionbarsherlock, android-viewpager, contextual-action-bar

我的应用程序有一个`ListView`，我正在`Contextual Action Bar`为 SDK 11 以上的设备使用一个，旧设备的旧弹出上下文操作。我知道有一种方法可以将 CAB 与旧设备一起使用，但我尝试实施它，发现对于最终将过时的设备来说，这是不值得的。我知道这是一些代码重复，但从理论上讲，我将摆脱旧的弹出操作（强调“理论上”）。

`onContextItemSelected`无论如何，当我使用模拟器时，CAB 工作正常，但是当我在该事件中设置断点时，旧设备的旧弹出操作似乎会命中两次。我刚刚开始`ViewPager`为我的应用程序实现一个，这在之前没有发生，`ViewPager`所以不确定这是否是导致问题的原因。

这是我正在使用的代码：

```
public class MyFragment extends SherlockListFragment
{
    private ListView mListView;
    private android.view.ActionMode mActionMode;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setHasOptionsMenu(true);
    }

    @Override
    public void onCreateContextMenu(final ContextMenu menu, final View v, final ContextMenuInfo menuInfo) 
    {
          super.onCreateContextMenu(menu, v, menuInfo);

         if (this.mActionMode != null) return;

          menu.add(1, 0, 0, "Delete");
          menu.add(1, 1, 0, "Save");
    }

    @Override
    public void onActivityCreated(final Bundle icicle)
    {    
        mListView = getListView();

        if(android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.HONEYCOMB)
        {   
            mListView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE_MODAL);

            mListView.setMultiChoiceModeListener(new MultiChoiceModeListener() {

                @Override
                public boolean onCreateActionMode(android.view.ActionMode mode, android.view.Menu menu) {
                    // Inflate the menu for the CAB
                    menu.clear();
                    menu.add(1, 1, 2, "Delete").setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);
                    menu.add(1, 3, 1, "Save").setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);

                    return true;
                }

                @Override
                public boolean onActionItemClicked(android.view.ActionMode mode, android.view.MenuItem item) {

                    mActionMode = mode;

                    if (item.getGroupId() == 1) 
                    {
                        switch(itemId)
                        {
                            case 0:
                                DeleteItem();
                                break;
                            case 1:
                                SaveItem();
                                break;
                        }
                    }
                }
            }
        }
    }

    @Override
    public boolean onContextItemSelected(final android.view.MenuItem item) {

        if (item.getGroupId() == 1) {

            final AdapterContextMenuInfo info = (AdapterContextMenuInfo)item.getMenuInfo();
            final Integer position = info.position;
            final int itemId = item.getItemId();

            switch(itemId)
            {
                case 0:
                    DeleteItem();
                    break;
                case 1:
                    SaveItem();
                    break;
            }
        }

        return super.onContextItemSelected(item);
    }

    @Override
    public void onPrepareOptionsMenu(Menu menu) {

        super.onPrepareOptionsMenu (menu);
    }

    @Override
    public void onCreateOptionsMenu(Menu menu, MenuInflater inflater) {
        inflater.inflate(R.menu.my_menu, menu);

        super.onCreateOptionsMenu(menu, inflater);
    }
} 
```

**ViewPager 代码**

```
public class Main extends SherlockFragmentActivity
{
    private static List<Integer> mIds;

    @Override
    public void onCreate(final Bundle icicle)
    {    
        super.onCreate(null);

        setContentView(R.layout.main);

        mViewPager = (ViewPager)findViewById(R.id.viewpager); //view pager exists, so we are using the portait layout

        if (mViewPager != null)
        {
            mIds = new ArrayList<Integer>();

            mIds.add(0);
            mIds.add(1);
            mIds.add(2);
        }
        else //in landscape
        {           
            ListFragment lf = (ListFragment)getSupportFragmentManager().findFragmentById(R.id.fragmentList);

            if (lf == null)
                lf = new ListFragment();

            DetailFragment df = (DetailFragment)getSupportFragmentManager().findFragmentById(R.id.fragmentDetail);

            if (df == null)
            {
                df = new DetailFragment();
                df.setArguments(getIntent().getExtras());   
            }

            getSupportFragmentManager().beginTransaction().add(R.id.fragmentList, lf).commit();
            getSupportFragmentManager().beginTransaction().add(R.id.fragmentDetail, df).commit();
        }
    }       

    private static class MyFragmentPagerAdapter extends FragmentStatePagerAdapter  {  

        public MyFragmentPagerAdapter(FragmentManager fm) {  
             super(fm);  
        }  

        @Override  
        public Fragment getItem(int index) {        
            //can't use getSupportFragmentManager().findFragmentById() here because I get a "Cannot make a static reference to the non-static method" error
            if (index == 0)
                return ListFragment.newInstance();
            else            
                return DetailFragment.newInstance(mIds.get(index-1));
        }  

        @Override
        public int getCount() {  
             return 4;
        }
   }  
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T01:23:09.700

这个问题的解决方案解决了我的问题：

[如何在多片段活动中处理 onContextItemSelected？](https://stackoverflow.com/questions/5297842/how-to-handle-oncontextitemselected-in-a-multi-fragment-activity)

使用`getUserVisibleHint()`在`onContextItemSelected`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-23T10:47:41.137

方法必须返回`true`以使用选择。 [文档在这里](https://developer.android.com/reference/android/app/Fragment.html#onContextItemSelected(android.view.MenuItem))

```
 @Override
    public boolean onContextItemSelected(final android.view.MenuItem item) {

        if (item.getGroupId() == 1) {

            final AdapterContextMenuInfo info = (AdapterContextMenuInfo)item.getMenuInfo();
            final Integer position = info.position;
            final int itemId = item.getItemId();

            switch(itemId)
            {
                case 0:
                    DeleteItem();
                    return true;
                case 1:
                    SaveItem();
                    return true;
            }
        }

        return super.onContextItemSelected(item);
    } 
```

# c# - User32.dll：未找到 RegisterHotkey

> ID：14734592
> 
> 赞同：2
> 
> 时间：2013-02-06T16:59:01.333
> 
> 标签：c#, .net, forms, user32, registerhotkey

我最近使用 Visual Studio 2010 在 Visual C# .NET 2010 中作为 Windows 窗体应用程序制作了一个程序。该程序通过 user32.dll 函数“RegisterHotkey”使用全局热键。一切正常。当按下注册的热键时（例如），我能够显示一个 MessageBox。然后，今天，在 Visual Studio 中出现一些奇怪的错误（与 Hotkey 无关）（实际上它只是一个未加载的图像）之后，RegisterHotkey 功能不再起作用。

我没有更改热键代码中的任何内容。

当我在 Visual Studio 中调试时，我没有任何异常。通过断点，我发现代码在 RegisterHotkey 函数处停止。当我从项目的“调试”文件夹中执行 .exe 文件时，程序显示一个错误，指出“在“user32”DLL 中找不到“入口点“RegisterHotkey”。

这很奇怪，因为它一直有效。

为了检查我的项目或代码是否是原因，我创建了一个新的 Windows 窗体应用程序并输入了代码：

```
using System.Runtime.InteropServices;
using System;
using System.Windows.Forms;

namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        [DllImport("user32", CharSet = CharSet.Ansi, SetLastError = true, ExactSpelling = true)]
        private static extern int RegisterHotkey(IntPtr Hwnd, int ID, int Modifiers, int Key);

        [DllImport("kernel32", EntryPoint = "GlobalAddAtomA", CharSet = CharSet.Ansi, SetLastError = true, ExactSpelling = true)]
        private static extern short GlobalAddAtom(string IDString);

        private void Form1_Load(object sender, EventArgs e)
        {
            int atomid = GlobalAddAtom("hallo");
            RegisterHotkey(this.Handle, atomid, 0, (int)Keys.A);
        }
    }
} 
```

这产生了同样的错误。尝试调用 RegisterHotkey 函数时发生错误。这次我尝试输入尽可能少的代码。

该表单没有控件，它应该在其 Load 事件中注册一个热键。

我的问题是：谁能告诉我为什么突然找不到RegisterHotkey？我在哪里犯错了吗？我该怎么做才能让它再次工作？

我尝试导入“user32.dll”而不是“user32”，但除了错误消息中的文本外，它没有改变任何内容。在那里，“user32”被“user32.dll”取代。

编辑：我不知道它是否相关，但我使用 Windows 7 Professional 64 位版本和 .NET 框架 4.0（不是客户端配置文件）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:04:32.547

这可能是因为函数名称是`RegisterHotKey`大写的**K**，而不是`RegisterHotkey`。

尝试完全按照[pinvoke.net](http://pinvoke.net/default.aspx/user32/RegisterHotKey.html)上的描述声明它：

```
[DllImport("user32.dll", SetLastError = true)]
[return: MarshalAs(UnmanagedType.Bool)]
static extern bool RegisterHotKey(IntPtr hWnd, int id, uint fsModifiers, uint vk); 
```

# soap - soapUI/Message Broker - 基于 SOAP 的测试流

> ID：14734593
> 
> 赞同：0
> 
> 时间：2013-02-06T16:59:03.987
> 
> 标签：soap, wsdl, soapui, messagebroker

这个可能很简单，但是找不到。我了解带有 SOAP 节点的流（例如 SOAP 输入）在 Message Broker 中作为 Web 服务公开。如何使用soapUI 使用它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T05:50:46.100

因为您应该有一个 WSDL 文件在您的肥皂节点中指定您的 Web 服务，所以您应该使用该 WSDL，将其导入到 soapUI 中，然后指定您的 WMB 机器的端点（我认为默认端口是 7080 或类似的东西）。这应该很简单。

# c# - 将自定义参数添加到安装包

> ID：14734596
> 
> 赞同：1
> 
> 时间：2013-02-06T16:59:07.880
> 
> 标签：c#, visual-studio, powershell, nuget

我正在构建一个使用工具文件夹中的 install.ps1 脚本的 nuget 包。我想在 install-package 命令中将参数传递给这个安装脚本。

所以在视觉工作室的包管理器中运行

安装包 mypackage -myparam 参数

然后将参数传递到工具文件夹内的 install.ps1 文件中。

这可能吗？有没有更好的方法来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:10:13.997

AFAIK 那是不可能的。Install-Package cmdlet 公开了一些选项，这些选项映射到NuGet 源中[InstallPackageCommand的属性。](http://nuget.codeplex.com/SourceControl/changeset/view/09e6046d6eaf#src/VsConsole/PowerShellCmdlets/InstallPackageCommand.cs)您可能会记录问题或提交此类功能的拉取请求？

与其尝试扩展 Install-Package cmdlet，不如创建自己的 cmdlet 并在安装后公开该 cmdlet（类似于 MVC 脚手架包）？

# c++ - 大型项目的通用接口

> ID：14734600
> 
> 赞同：0
> 
> 时间：2013-02-06T16:59:33.120
> 
> 标签：c++, paradigms

假设您正在编写一个更大的项目，并且您必须使用 3rd 方库。因此，您的完整项目将依赖于这些库。

我认为与其直接使用那些 3rd 方库，不如编写某种包装库或看起来像这样的接口。

```
void myMainloop(...){
    3rdpartyMainloop(...);
} 
```

因此，如果第 3 方库过时，我只需将其集成到我的包装库中即可切换到另一个库。

**这是一件好事吗？我有什么选择？**

我有点担心，如果我有两个本质上做同样事情但设计完全不同的库，那么不可能为两者找到通用接口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T18:08:17.090

您*可以*编写一个通用接口，以适应一个或多个第三方库。但是，如果您谈论的是 Qt 的大小和范围的库，则需要非常仔细的设计和规划，更不用说大量的开发工作了。您首先必须设计您的接口，然后为您希望能够插入的每个库实现这些接口。

归根结底，这是一个非常崇高的目标，你不可能最终得到任何真正“通用”的东西。充其量，您可能不得不将界面简化到无法利用每个库必须提供的许多功能的地步。此外，您可能会引入会降低应用程序性能的开销，因此如果性能至关重要，请记住这一点。

我会说只选择最适合您需求的库，除非您想自己推出，我对此表示怀疑。

# ruby-on-rails-3 - rails 3 root：不工作

> ID：14734602
> 
> 赞同：0
> 
> 时间：2013-02-06T16:59:36.503
> 
> 标签：ruby-on-rails-3, root

```
 SampleApp::Application.routes.draw do
  match '/', :to => 'pages#home'
  match '/contact', :to => 'pages#contact'
  match '/about', :to => 'pages#about'
  match '/help', :to => 'pages#help'
  root :to => 'pages#home'
  get "pages/home"
  get "pages/contact"
  get "pages/about"
  get "pages/help"

end 
```

这是我的 routes.rb 文件。根 :to => 'pages#home' 命令似乎不起作用，在我检查的网站源代码中，它链接到“”而不是 /pages/home。

是的，我删除了公共/索引

耙路线输出：

```
 /                        pages#home
      contact     /contact(.:format)       pages#contact
        about     /about(.:format)         pages#about
         help     /help(.:format)          pages#help
         root     /                        pages#home
   pages_home GET /pages/home(.:format)    pages#home
pages_contact GET /pages/contact(.:format) pages#contact
  pages_about GET /pages/about(.:format)   pages#about
   pages_help GET /pages/help(.:format)    pages#help 
```

# sql - 编写子选择查询

> ID：14734603
> 
> 赞同：1
> 
> 时间：2013-02-06T16:59:37.623
> 
> 标签：sql, sql-server-2008

我有两个具有一对多关系的表。我想编写一个查询，它输出表中的所有记录，其中包含一条记录，而表中只有一条记录有很多记录。

因此，具有许多记录的表首先显示出现次数最多的记录。如果出现相同的情况，那么它将按升序排列并显示第一条记录。

**表格1**

```
Col1 Col2 Col3
a1     1   4
a2     2   5
a3     3   6 
```

**表2**

```
Col1 Col4
a1     10
a1     11
a1     22
a1     11
a2     10
a2     11
a3     19
a3     22
a3     22
a3     23 
```

**查询输出：**

```
Col1 Col2 Col3 Col4
a1     1   4    11
a2     2   5    10
a3     3   6    22 
```

希望我说清楚了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:04:12.530

首先，您需要使用 group by 和 min() 从 table2 中获取最小的数字，然后加入 table1 以获取所需的列。我使用了左连接，因为我假设 table2 中可能没有匹配项，但`INNER JOIN`如果 table2 中始终有 1 个或多个相应记录，则可以将其更改为。

```
SELECT  a.col1, a.col2, a.col3, b.col4
FROM    table1 a
        LEFT JOIN (
                    SELECT  col1, col4 = MIN(col4)
                    FROM    table2
                    GROUP BY col1
                    ) b
            ON a.col1 = b.col1 
```

# python - 制表符分隔文件中的列表字典

> ID：14734604
> 
> 赞同：1
> 
> 时间：2013-02-06T16:59:37.857
> 
> 标签：python, list, csv, dictionary

我正在尝试将制表符分隔的文本文件加载到 python 程序中。它具有以下格式，

```
AAAAAA    1234    5678     90AB    QQQQ    JKL1
BBBBBB    QWER    TYUI     ASDF    QQQQ
CCCCCC    ZXCV    1234     PPPP
 ...
ZZZZZZ    1111 
```

简而言之，每行的列数是可变的，但总是至少有两列，并且一行中的每一列都是唯一的。我想将第一列用作键，然后将其余列加载到列表中，键指向它。我已经尝试按照其他线程中的建议查看 csv 模块，但我还没有找到一种方法让它对我有用。所以，是的，如果这应该更明显，非常抱歉，这是一个新手问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-06T17:01:46.703

simple`str.split`应该可以很好地拆分列。使用它，您只需要读取每一行并将其拆分为以第一个元素为键，其余为值的列：

```
with open(file) as fin:
     rows = ( line.split('\t') for line in fin )
     d = { row[0]:row[1:] for row in rows } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:40:43.697

```
import csv

d = {}
with open('tab_delimited_file.txt', 'rb') as csv_file:
    for row in csv.reader(csv_file, delimiter='\t'):
        d[row[0]] = row[1:]

print(d) 
```

输出：

```
{'AAAAAA': ['1234', '5678', '90AB', 'QQQQ', 'JKL1'],
 'CCCCCC': ['ZXCV', '1234', 'PPPP'], 
 'BBBBBB': ['QWER', 'TYUI', 'ASDF', 'QQQQ'],
 'ZZZZZZ': ['1111']} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-06T17:04:41.220

```
>>> import csv
>>> with open('eggs.csv', 'rb') as csvfile:
...     spamreader = csv.reader(csvfile, delimiter='\t', quotechar='|')
...     for row in spamreader:
...         print ', '.join(row)
Spam, Spam, Spam, Spam, Spam, Baked Beans
Spam, Lovely Spam, Wonderful Spam 
```

这只是如何获取分隔文件并打印行数据的示例。显然，这可以扩展并放入字典或列表或其他东西中。

更多信息（以及从哪里获取）：[http ://docs.python.org/2/library/csv.html](http://docs.python.org/2/library/csv.html)

# c# - JSON反序列化获取类型

> ID：14734615
> 
> 赞同：1
> 
> 时间：2013-02-06T16:59:59.250
> 
> 标签：c#, .net, json

```
class Program
{
    static void Main(string[] args)
    {
        string json = JsonConvert.SerializeObject(new Account { Name = "test" }, Newtonsoft.Json.Formatting.Indented,
        new JsonSerializerSettings { TypeNameHandling = TypeNameHandling.All, PreserveReferencesHandling = PreserveReferencesHandling.Objects });
        Console.Out.Write(json);
        while (true) 
        {
        }
    }
}

class Account {
    public String Name;
} 
```

嘿，我想进入 Json。我想反序列化一个对象。我想从字符串中获取类型信息。因此，当我反序列化时，我希望 json 自己识别类型而不指定它。那可能吗？

最好的问候，布赖恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T05:30:18.390

遗憾的是，Json.net 无法通过 json 推断类型，但如果您想动态操作 Json 对象，请查看 Newtonsoft.Json.Linq 命名空间中的 JToken、JObject 和 JArray 类型。你可以从这样的路径中读取 Json

```
var myObject = JObject.Parse(jsonString)
var someObject = myObject["myOtherObject"]["otherThing"];
var myString = (string) someObject["theString"]; 
```

我发现 Json.net 的这一部分非常有用，希望对您有所帮助:)

# sql-server-2008 - 在 SQL 代理作业中设置 SSIS 变量

> ID：14734616
> 
> 赞同：1
> 
> 时间：2013-02-06T17:00:01.807
> 
> 标签：sql-server-2008, ssis

我在 SQL Server 代理作业中运行 SSIS 包。在使用开发设置进行开发时，我需要为生产设置几个变量，例如一个日志变量，它传递用于文本文件连接字符串的路径。我使用“设置值”UI 对话框来设置此值，此作业步骤的生成命令行如下所示...

```
/SQL "\MyFolderInMSDB\MyPackage" /SERVER "mw-test"  /CHECKPOINTING OFF /SET "\package.variables[log].Value";"C:\Logs\Imports\mylog.log" /REPORTING E 
```

尝试设置变量似乎没有错误，但是当我运行作业时，它正在记录到我开发它时任务中定义的变量，而不是我作为上面的变量发送的路径。有人见过这样的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T18:27:53.383

假设您已经粘贴了 SQL 代理作业步骤信息并且没有重新输入，那么问题很可能是由于区分大小写。*SSIS*中的内容区分大小写，因此“log”的变量名称与“Log”不同。

```
/SQL "\MyFolderInMSDB\MyPackage" /SERVER "mw-test" /CHECKPOINTING OFF /SET "\Package.Variables[User::log].Properties[Value]";"C:\Logs\Imports\mylog.log" /REPORTING E 
```

上面@Bill 的示例也使用提供的路径区分大小写。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:17:49.560

试试这个：[http ://www.buildingmeaning.com/?p=171](http://www.buildingmeaning.com/?p=171)

看起来你们很亲近。可能只是改变

```
"\package.variables[log].Value" 
```

到

```
"\package.variables[log].properties[value]" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-29T22:43:52.110

我必须将 ConfiguredValue 标记为从 SSIS 包和配置中的 Executable 值读取

```
\Package\Variable Container.Executables\Variables[User::run_type].Properties[Value] 
```

否则，每次都会读取配置中的静态值。

# ios - 通过弱指针的弧和 nilling 属性

> ID：14734620
> 
> 赞同：1
> 
> 时间：2013-02-06T17:00:07.837
> 
> 标签：ios, objective-c, automatic-ref-counting

我在这里遇到一种情况，我想用弱引用属性来消除强属性。我的课看起来像这样；

```
@interface MyClass()
@property(nonatomic, strong) Man *man;
@property(nonatomic, strong) Women *women;
@property(nonatomic, weak) Person *passedPerson
@end 
```

我每次都将这个对象传递给新的视图控制器，有时我传递男性，而有时我传递女性，但我总是在弱引用中跟踪传递的对象，即。通过人。现在，当视图控制器返回时，基于当前传递的对象，我想通过弱引用指针将其归零。甚至可能吗？这不是我的确切情况，但是当我在呈现视图控制器中完成它们时，我有很多这样的对象需要被取消。如何才能做到这一点 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:35:32.000

当您需要中断引用循环时使用弱引用。在您展示的示例中，没有参考周期。但我假设你想保留`passedPerson`.

`man`您可以对and使用弱引用，并`women`在`passedPerson`. 然后，您可以`passedPerson`在完成它们时将其取消。

# string - 解析单元格和格式化字符串

> ID：14734621
> 
> 赞同：0
> 
> 时间：2013-02-06T17:00:17.370
> 
> 标签：string, excel

我需要使用 excel 数据表创建大量 SQL 插入语句。假设我有以下excel：

```
A             B              C
-----    ----    -----  >>>>  ----
TE            ZZ           Insert into TABLE (CODE, VAL) Values   ('&A1', '&B1');
TT            CC           Insert into TABLE (CODE, VAL) Values   ('&A2', '&B3');
EX            FF           Insert into TABLE (CODE, VAL) Values   ('&A3', '&B3'); 
```

我的输出应该是：

```
 Insert into TABLE (CODE, VAL) Values   ('TE', 'ZZ');
       Insert into TABLE (CODE, VAL) Values   ('TT', 'CC');
       Insert into TABLE (CODE, VAL) Values   ('EX', 'FF'); 
```

我无法实现它。我尝试使用**&A1, =A1**。

我应该拆分整个字符串并使用连接吗？

```
Insert into TABLE (CODE, VAL) Values   ('
A1
', '
B1
'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:04:07.667

你的 C 列应该有这样的公式：

```
="Insert into TABLE (CODE, VAL) Values   ('"&A1&"', '"&B1&"');" 
```

# jquery - Richfaces拖放-当dragSrouce在IE9的PopupPanel内时不显示拖动指示器

> ID：14734622
> 
> 赞同：1
> 
> 时间：2013-02-06T17:00:18.050
> 
> 标签：jquery, css, jsf, richfaces, z-index

我在 rch:popupPanel 中有一个拖放功能，并且拖动指示器总是出现在弹出面板的后面，我不知道如何解决这个问题，我试试这个，

```
.rf-ind-drag.default{
    z-index: 10000;
} 
```

但这只是修复Chrome，但IE9仍然遇到同样的问题，有没有人遇到过这个问题并且知道如何修复它？

# svn - 制作 svn 存储库的独立副本

> ID：14734632
> 
> 赞同：8
> 
> 时间：2013-02-06T17:00:50.240
> 
> 标签：svn

我正在尝试克隆存储库，但它应该是彼此的独立副本。这背后有什么魔力，还是只是使用 svn 客户端并对其进行克隆？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-06T17:04:33.970

试试[`svnadmin hotcopy`](http://svnbook.red-bean.com/en/1.7/svn.ref.svnadmin.c.hotcopy.html)。您可以在 svn book *（带有 Subversion 的版本控制）的*[repo 维护部分](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.tk)中查找它，特别是在[“存储库复制”](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.replication)部分中。还有该命令，但只有在尝试创建镜像时才需要此命令。 *`svnsync`*

 *引用这本书：“简单地进行递归目录复制会产生生成错误备份的风险。在 Berkeley DB 的情况下，文档描述了可以复制数据库文件的特定顺序，这将保证有效的备份副本。A FSFS 数据存在类似的排序。” FSFS 和 Berkeley DB 是常规 subversion 安装提供的两个数据库选项，FSFS 是默认设置。

示例用法（再次来自书中）：

```
$ svnadmin hotcopy /var/svn/repos /var/svn/repos-backup 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-16T12:37:16.177

使用[`svnrdump`](http://svnbook.red-bean.com/en/1.8/svn.reposadmin.maint.html#svn.reposadmin.maint.tk.svnrdump)工具通过 HTTPS 和 svn://（即远程）获取存储库转储（完整的修订历史）并将`svnadmin load`其放入新的干净存储库。请注意，为了获得完整的存储库转储，您必须对存储库中的所有树具有完全读取权限，否则转储可能不完整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-30T13:53:27.267

我正在尝试做同样的事情，基本上我所做的如下：

**svnadmin dump**（带有可选的***-r (revision number)***），我用它来转储我们代码的最新版本，然后只加载最新版本，但是如果你需要谁做了什么的完整历史，那么命令没有 -r：

```
svnadmin dump /path/to/repository > repo.dmp 
```

然后将其加载到新的存储库中

```
svnadmin load /path/to/new/repo < repo.dmp 
```*

# c# - 从类继承并添加附加属性

> ID：14734638
> 
> 赞同：3
> 
> 时间：2013-02-06T17:01:19.617
> 
> 标签：c#, class, inheritance

我在一个应用程序中有一个类 -**我无法更改**（旧版） - 它位于程序集（DLL 文件）内部：

```
public class ShippingMethod
{
    public string ShipMethodCode { get; set; }
    public string ShipMethodName { get; set; }
    public decimal ShippingCost { get; set; }

    public List<ShippingMethod> GetAllShippingMethods()
    {
    ......
    }
} 
```

我有第二个应用程序引用该程序集（DLL 文件），并且需要使用所有运输方法填充下拉列表。例如：“UPS - 3.25 美元”

问题是它需要为不同的货币使用正确的格式。例如：3.25 美元或 3.25 欧元，具体取决于名为 CountryID 的参数。

我编写了一个函数`String DisplayMoney(Decimal Amount, Integer CountryID)`，它将返回金额的正确格式。

现在我需要将此功能应用于每种运输方式并将其保存到新列表中。做这个的最好方式是什么？

我可以创建另一个名为 LocalizedShippingMethods 的类，如下所示：

```
public class LocalizedShippingMethod
{
    public ShippingMethod ShipMethod { get; set; }
    public string LocalizedShippingCost { get; set; }
} 
```

这是实现这一目标的最佳方法吗？有没有更好的方法使用继承来做到这一点？如果我使用继承，我如何将第一个列表中的值放入新列表中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:08:15.100

这确实是一个很好的方法。您可以使用一个非常快速的 Linq 查询将旧查询拉`List`入新查询：

```
List<LocalizedShippingMethod> Translate(List<ShippingMethod> oldList)
{
  return oldList.Select(a => new LocalizedShippingMethod
     {
         // Initialize properties according to however you translate them
     }).ToList();
} 
```

此外，为了使这更加简化和明显，您可以执行以下任何操作来帮助翻译：

*   `LocalizedShippingMethod`为它创建一个构造函数`ShippingMethod`并正确设置属性
*   在其上创建一个静态方法，`LocalizedShippingMethod`该方法接受 a`ShippingMethod`并返回一个初始化的`LocalizedShippingMethod`
*   创建一个`LocalizedShippingMethod`从 a 转换的运算符`ShippingMethod`
*   在 上创建一个扩展方法`ShippingMethod`，调用它`ToLocalized()`返回一个`LocalizedShippingMethod`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:07:24.403

如果为 ShippingMethod 类创建扩展方法会怎样？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:09:18.877

做到这一点的最佳方式是最*适合您的方式。* 如果您是必须维护此代码的人，那么什么会让您的生活变得最轻松？

一旦你回答了这个问题，*那*就是最好的解决方案。

# javascript - Rangy：创造一个新的亮点就是记住旧的亮点

> ID：14734641
> 
> 赞同：2
> 
> 时间：2013-02-06T17:01:21.147
> 
> 标签：javascript, rangy

我[在 Rangy 中使用荧光笔模块](http://code.google.com/p/rangy/wiki/HighlighterModule)。

我有一个`div`元素，它有一些 html。html 实际上是使用 ajax 从文件中加载的，我有一个按钮来执行此加载。

加载文本后，我可以选择显示的 html 的一部分并按我的“突出显示”按钮。这会调用一些 Rangy 代码并根据需要突出显示文本......

```
//called on document load
rangy.init();
cssApplier = rangy.createCssClassApplier(highlightClassName, { normalize: true });
highlighter = rangy.createHighlighter(document, "TextRange");
highlighter.addClassApplier(cssApplier);

//called on "Highlight" button click
highlighter.highlightSelection(highlightClassName, selection); 
```

出于复制的目的，请选择大部分作为第一个亮点。

接下来，我单击加载 html 按钮以重新加载 html。正如预期的那样，亮点消失了。但是现在我选择了另一个文本，它恰好与我所做的第一个突出显示重叠。现在，当我按下“突出显示”按钮时，由于某种原因，突出显示是上一个突出显示的那个。为什么会这样？

我知道必须与合并有关，但我不明白为什么。当我调试 JS 时，我可以看到选择 (from `rangy.getSelection()`) 是我所期望的。

[这是问题的 JSFiddle 复制](http://jsfiddle.net/8pMEt/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-08T19:08:48.007

`highlightSelection`我通过在每次通话之前重新创建荧光笔解决了这个问题。我不知道为什么会这样，但是荧光笔必须存储一些关于以前的高光的数据，这些数据用于高光合并或其他东西。

我的问题中的代码可以更改如下来解决问题：

```
//called on document load
rangy.init();
cssApplier = rangy.createCssClassApplier(highlightClassName, { normalize: true });

//called on "Highlight" button click
highlighter = rangy.createHighlighter(document, "TextRange");
highlighter.addClassApplier(cssApplier);
highlighter.highlightSelection(highlightClassName, selection); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-11T01:01:30.190

发生这种情况的原因是因为每个突出显示作为一对字符偏移量存在，而不是引用 DOM 中的实际范围，这意味着当 DOM 的某些部分被替换时，现有的突出显示仍然幸福地不知道并继续假设它们被应用到原来的字符范围。

你的解决方法很好。另一种方法是调用荧光笔的`removeHighlights()`方法：

```
highlighter.removeHighlights(highlighter.highlights); 
```

演示：http: [//jsfiddle.net/8pMEt/1/](http://jsfiddle.net/8pMEt/1/)

我将添加一个`removeAllHighlights()`方法来做同样的事情。

文档没有明确说明的一件事是突出显示旨在用于静态 DOM，或者至少是文本内容不变的 DOM。在创建高光后更改 DOM 显然会导致字符偏移消失，整个事情就会崩溃。

# delphi - 向客户发布部分源代码

> ID：14734642
> 
> 赞同：7
> 
> 时间：2013-02-06T16:18:38.550
> 
> 标签：delphi, pascal

我为一家公司编写了一个程序。他们想要源代码。

该程序使用我为多个客户的多个项目编写的代码。

我只想发布该程序使用的代码。因此，如果一个名为 Utils.pas 的共享文件包含十个函数，而该程序只使用其中两个，那么我想发布一个名为 Utils.pas 的文件，其中只有这两个函数。

代码是 Borland Pascal，使用 Delphi 编写的。

有谁知道我该怎么做？

澄清：我不是在询问许可。我希望客户只拥有他们的程序使用的源代码，而没有其他任何东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T19:26:10.867

将他们的代码从 utils.pas 中分解为 client_xxxx_utils.pas。向他们收取通常的费用，以完成这项工作、重建、冒烟测试等。问题解决了。

好的，万一弄清楚要修剪什么是一件苦差事……编译程序，然后查看 utils.pas 单元。通常，您会在边距中有蓝点，表示您可以设置断点。“死代码”的空白处不会有蓝点，因为该代码已被链接器消除。任何没有蓝点的东西都是他们不需要的。

对于更自动化的方法，也许 Peganza Pascal Analyzer 可以在其中一个报告中识别死代码。

这里有一些关于 SO 的相关问题，有类似的答案（有些是我的！）

[在 Delphi 中查找未使用的（又名“死”）代码](https://stackoverflow.com/questions/4226970/finding-unused-aka-dead-code-in-delphi)

[如何“自动”从使用条款中删除未使用的单位？](https://stackoverflow.com/questions/2200250/how-to-automatically-remove-unused-units-from-uses-clause)

# algorithm - 有没有一种算法可以从一系列音符中获取歌曲的音阶和调？

> ID：14734644
> 
> 赞同：13
> 
> 时间：2013-02-06T17:01:27.197
> 
> 标签：algorithm, midi, audio-processing

我有一系列 MIDI 音符以 MIDI 音符编号的形式存储在数组中。有没有一种算法可以让我得到这些音符所代表的歌曲的音调和音阶？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-07T15:56:14.703

如果您使用的是 Python，则可以使用 music21 工具包来执行此操作：

```
import music21
score = music21.converter.parse('filename.mid')
key = score.analyze('key')
print(key.tonic.name, key.mode) 
```

如果您关心密钥查找的特定算法，则可以使用它们而不是通用的“密钥”：

```
key1 = score.analyze('Krumhansl')
key2 = score.analyze('AardenEssen') 
```

等等。这些方法中的任何一种也适用于和弦。

（免责声明：music21 是我的项目，所以我当然对推广它有既得利益；但您可以查看 music21.analysis.discrete 模块，从那里为其他项目/语言获取想法。如果您有 MIDI 解析器， Krumhansl 算法并不难实现）。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-23T22:19:18.907

Carol Krumhansl 的算法是最著名的。基本思想非常简单。参考音高样本是从已知调的音乐中提取的，并移调到其他 11 个调。大调和小调必须分开处理。然后从未知调的音乐中抽取一个音高样本。这会为 24 个参考样本和一个未知样本中的每一个生成一个 12 分量的音调向量，例如：

```
[ I,        I#,      II,       II#     III,       IV,      IV#,   V,     V#,    VI,     VI#,   VII    ]
[ 0.30,  0.02,  0.10,  0.05, 0.25,  0.20,  0.03, 0.30,  0.05,  0.13, 0.10  0.15] 
```

计算未知基音向量和每个参考基音向量之间的相关系数，并选择最佳匹配。

Craig Sapp 编写了（受版权保护的）代码，可在[http://sig.sapp.org/doc/examples/humextra/keycor/获得](http://sig.sapp.org/doc/examples/humextra/keycor/)

David Temperley 和 Daniel Sleator 开发了一种不同的、更困难的算法，作为他们（受版权保护的）Melisma 软件包的一部分，可在 [http://www.link.cs.cmu.edu/music-analysis/ftp-contents.html获得](http://www.link.cs.cmu.edu/music-analysis/ftp-contents.html)

T. Eerola 和 P. Toiviainen 在他们的 Midi 工具箱中提供了 Krumhansl 算法的（免费）Matlab 版本： [https ://www.jyu.fi/hum/laitokset/musiikki/en/research/coe/materials/miditoolbox](https://www.jyu.fi/hum/laitokset/musiikki/en/research/coe/materials/miditoolbox)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-06T17:10:29.337

周围有[许多](https://www.google.co.uk/search?q=key%20finding%20algorithms&ie=utf-8&oe=utf-8&aq=t&rls=org.mozilla%3aen-GB%3aofficial&client=firefox-a)关键的查找算法，特别是 Carol Krumhansl 的算法（我见过的大多数论文总是引用 Krumhansl 的方法）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-02-11T18:58:57.147

假设没有键更改，一个简单的算法可以基于音级直方图（一个数组，每个音级有 12 个条目（每个音符在一个八度音阶中）），当你得到一个音符时，你在正确的条目中添加一个，然后在最后你很可能有两个最常见的音符，它们分别是 7 个半音（或条目），分别代表主音和主音，主音是你要找的音符，主音是上面的 7 个半音或下面的 5 个半音.

这种方法的好处是它与音阶无关，它依赖于主音和主音，这是两个最重要的音符，并且出现得更频繁。通过对乐曲的大细分的第一个和最后一个音符给予额外的权重，该算法可能会变得更加健壮。

至于检测音阶，一旦你有了键，你就可以在直方图中生成一个高于某个阈值的音符列表作为从那个根音符的偏移量，所以假设你检测到 A 的键（从具有 A 和 E更频繁地发生）并且您拥有的音符是 ACDEG 然后您将获得 offsets ，在[这样的数据库](http://photosounder.com/scales.html)`0 3 5 7 10`中搜索会为您提供“Minor Pentatonic”作为音阶名称。

# c# - 使用事件的 C# 线程通信

> ID：14734655
> 
> 赞同：2
> 
> 时间：2013-02-06T17:02:03.703
> 
> 标签：c#, multithreading, thread-safety

我想在下面实现一些生活 -

![在此处输入图像描述](../Images/198cf54ffa6b87d2797bc63f09e56c54.png)

我的应用程序将启动 UI 模块，从 UI 模块我将启动核心模块。核心模块将继续在不同的线程上运行。在核心模块中的特定操作上，我想引发 UI 模块订阅的事件。

基本上，我想将特定的枚举信息发送到 UI 模块。

请给我推荐一个模型。我正在努力实现它。

在这个模型中，这两个模块都会在任何阻塞的情况下运行吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:33:52.647

I would recommend using the BackgroundWorker Class

Checkout this tutorial [http://www.dotnetperls.com/backgroundworker](http://www.dotnetperls.com/backgroundworker)

Class reference [http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx](http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx)

Here how it goes in simple ways:

1.  Open your UI form (design view)
2.  Add a backgroundworker control on your UI form
3.  Open the properties pane and switch to events (lightning bolt icon)
4.  Double click on dowork and runworkercompleted events (this will generate event handlers)
5.  Go to the event handlers (in code)
6.  Now write your processing code in dowork handler and add the result you want to send to your ui module like so e.Result = your_enum (or any other Object);
7.  Next come to the runworkercompleted handler and typecast the RunWorkerCompletedEventArgs e (RunWorkerCompletedEventArgs object) to your enum (or object you returned from the dowork handler) and use it in UI as needed.
8.  Finally do not forget to initiate the backgroundworker : backgroundWorker1.RunWorkerAsync() from your UI mdoule

Remark: If you need to report progress periodically use the ReportProgress method of BackgroundWorker class. There are two overloads for this method: 1) [http://msdn.microsoft.com/en-us/library/ka89zff4.aspx](http://msdn.microsoft.com/en-us/library/ka89zff4.aspx) 2) [http://msdn.microsoft.com/en-us/library/a3zbdb1t.aspx](http://msdn.microsoft.com/en-us/library/a3zbdb1t.aspx)

The first one allows to report only the progress percentage and the second one you can use to pass in any object also if you will

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:25:48.863

您可以使用`Progress`带有`IProgress`接口的类来执行此操作。

1.  在您的 UI 上下文中`Progress`，使用您需要传递的任何数据的通用参数创建一个对象。

2.  当后台任务更新您时，订阅它的事件以执行您想做的任何事情。

3.  让后台任务接受一个类型的对象`IProgress`（`Progress`实现）并定期让它`Report`与相关数据一起使用。

每当调用该`ProgressChanged`事件时都会触发该事件，并且该对象将捕获其创建位置的当前同步上下文，这是一种奇特的说法，即该事件将在 UI 线程中触发。`Report``Progress`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:24:39.870

对我来说，这听起来像是中介者模式的经典用法。Mediator 允许断开连接的组件相互通信。

我只是碰巧在我自己的 MVVM 框架中有一个副本，你可以从这里获取：

[http://cinch.codeplex.com/SourceControl/changeset/view/70832#796984](http://cinch.codeplex.com/SourceControl/changeset/view/70832#796984)

也抢这个

[http://cinch.codeplex.com/SourceControl/changeset/view/70832#797008](http://cinch.codeplex.com/SourceControl/changeset/view/70832#797008)

我的实现允许您使用 Wea​​kReference 来执行此操作，因此不会保留强引用。它还允许订阅者使用属性连接方法来监听某些事件，并允许发布者广播 T 的新消息。

发布者/订阅者只需向 Mediator 注册

```
//done by both subscriber and publisher
Mediator.Instance.Register(this);

//Subscriber
[MediatorMessageSinkAttribute("DoBackgroundCheck")]
void OnBackgroundCheck(string someValue) { ... }

//publisher might typically do this
mediator.NotifyColleagues("DoBackgroundCheck", "Nice message"); 
```

当订阅者收到消息（WPF / Winforms 已经预先构建了这些消息）时，您可能需要使用自己的[SynchronizationContext](http://msdn.microsoft.com/en-gb/library/system.threading.synchronizationcontext.aspx)来将调用调度到正确的线程。

我还允许同步/aysynchronise 调用

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T17:18:24.110

`System.Threading.Thread`使用or `BackgroundWorker`or`Task`类应该很容易做到这一点。您可以使用其中任何一个在另一个线程上运行代码。

当您需要通知 UI 时，只需引发一个事件。要构建事件，请看这里：

[如何在 C# 中创建自己的事件？](https://stackoverflow.com/questions/623451/how-can-i-make-my-own-event-in-c)

然后您只需要确保调用`Invoke`以确保您在正确的线程上执行最终的 UI 更新代码。为此，请看一下：

[线程控制.调用](https://stackoverflow.com/questions/1423446/thread-control-invoke)

# php - 配置颠覆 (SVN) 后 Apache 未启动

> ID：14734656
> 
> 赞同：1
> 
> 时间：2013-02-06T17:02:04.780
> 
> 标签：php, apache, svn, xampp

我用 Apache 配置了 subversion 1.6.6。（我正在使用 XAMPP）
我遵循了 README.TXT 以及网络上的几篇文章。
这是我的步骤

1.  将 subversion 1.6.6 安装到 C:/Subversion
2.  将 C:/Subversion/bin 添加到路径
3.  将 mod_dav_svn.so、mod_authz_svn.so 复制到 Apache/modules
4.  重新启动的窗口
5.  取消注释 httpd.conf 文件中的两行

    LoadModule dav_module modules/mod_dav.so
    LoadModule dav_fs_module modules/mod_dav_fs.so

6.  并添加了两行

    LoadModule dav_svn_module modules/mod_dav_svn.so
    LoadModule authz_svn_module modules/mod_authz_svn.so

7.  然后添加

    <Location /svn>
    DAV svn
    SVNPath C:/repo/svn
    </Location>

在文件末尾

现在我正在尝试在 XAMPP 中启动 Apache，但它还没有启动。
给出以下信息

```
22:13:29  [apache]  Status change detected: running  
22:13:30  [apache]  Status change detected: stopped 
```

# algorithm - F# 从元组到枚举列表的转换

> ID：14734658
> 
> 赞同：0
> 
> 时间：2013-02-06T17:02:13.473
> 
> 标签：algorithm, list, f#, type-conversion, tuples

下面的代码源于欧几里德距离算法的工作。颜色表只是测试算法的工具。它可能是在重新发明轮子，但它本身很有用。任何 3 个 RGB 整数 (0-255) 都可以与最接近的 X11 颜色名称相关联。非常感谢[svick](https://codereview.stackexchange.com/users/2041/svick)的见解。

在当前代码中，ColorTable 在创建实例后通过 AddColor 方法进行初始化。但是，可以使用 loadrgb/colorinfo 组合从 Web 上拉下 X11 颜色表。

我在从 X11 rgb.txt 文件的在线版本初始化颜色表时遇到了最后一个问题。我需要将文本解析为 {Name: Values:} 列表。目前，结果在字符串元组中。我正在努力让“colorinfo”加载“ColorTable”。

```
// currently the color table is create via the AddColor method, however
// the initial values should be created with the loadrgb and colorinfo members
type MyFSColorTable() = 

// pull the X11 rgb.txt color table off the web in text format
  static let loadrgb =
    let url = "http://people.csail.mit.edu/jaffer/Color/rgb.txt"
    let req = WebRequest.Create(url)
    let resp = req.GetResponse()
    let stream = resp.GetResponseStream()
    let reader = new StreamReader(stream)
    let txt = reader.ReadToEnd()
    txt

// parse the text of the rgb.txt color table into a Name: Values: list
  static let colorinfo =
      loadrgb.Split([|'\n'|])
      |> Seq.skip 1
      |> Seq.map (fun line -> line.Split([|'\t'|]))        
      |> Seq.filter (fun values -> values |> Seq.length = 3)
      |> Seq.map (fun values -> string values.[0], string values.[2])
      |> Seq.map (fun (rgb, name) -> rgb.Split([|' '|]), name)
      |> Seq.map (fun (rgb, name) -> [|name, rgb.[0], rgb.[1], rgb.[2]|])

  // Mutable Color Table will be defined on-the-fly
  let mutable ColorTable = []
  // Euclidean distance between 2 vectors - float is overkill here
  static let Dist (V1: float[]) V2 =
    Array.zip V1 V2
      |> Array.map (fun (v1, v2) -> pown (v1 - v2) 2)
      |> Array.sum

//    Add new colors to the head of the ColorTable
  member x.AddColor name rgb = ColorTable <- {Name = name; Values = rgb}::ColorTable

//    Find nearest color by calculating euclidean distance of all colors, 
//    then calling List.minBy for the smallest 
  member x.FindNearestColor (rgb : float[]) =
    let nearestColor =
      ColorTable |> List.minBy (fun color -> Dist rgb color.Values)
    nearestColor.Name 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:41:13.717

目前，您的构造代码`colorinfo`会生成一个序列，其中包含一个数组，该数组只有一个元素，该元素是一个元组（包含四个字符串）。这意味着总体结果的类型是 - 在您当前的版本中 - `seq<(string * string * string * string) []>`：

```
 (...)
  |> Seq.map (fun (rgb, name) -> 
       [|name, rgb.[0], rgb.[1], rgb.[2] |] 
```

这可能不是有意的——如果你想创建一个包含四个字符串的数组，你需要使用分号而不是逗号`[| name; rgb.[0]; ... |]`，如果你想创建四元素元组，那么你可以省略元组周围的`[|`and 。`|]`

无法自动将数组或元组转换为命名记录类型（假设您有一个带有`Name:string`and的记录`Values:float[]`），因此最好的选择是在管道的最后一步进行此转换。您可以将上述内容替换为：

```
 |> Seq.map (fun (rgb, name) -> 
        { Name = name
          Values = [| float rgb.[0]; float rgb.[1]; float rgb.[2] |] })
  |> List.ofSeq 
```

我还在`List.ofSeq`片段的末尾添加了一个列表，以便您返回一个列表 - 这与您目前使用的类型相同`ColorTable`。

（或者，您可以说`Values = Array.map float rgb`，它将所有字符串转换`rgb`为浮点数并适用于数组的任何长度。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:21:56.333

您可以缩短代码，并`{Name: string; Values: float[]} list`根据需要返回，使用以下内容：

```
static let colorinfo =
  loadrgb.Split('\n')
    |> Seq.skip 1
    |> Seq.choose (fun line ->
      match line.Split('\t') with
      | [|rgb; _; name|] ->
        let values = rgb.Split(' ') |> Array.map float
        Some({Name=name; Values=values})
      | _ -> None)
    |> Seq.toList 
```

# c# - 使用c#将群组短信从PC发送到手机

> ID：14734663
> 
> 赞同：1
> 
> 时间：2013-02-06T17:02:21.227
> 
> 标签：c#

我可以从电脑向手机发送短信，但我无法从电脑发送多条短信。此代码运行成功，我正在通过 AT 命令发送消息，我搜索了谷歌甚至在 stackoverflow 中，给出的信息与我的要求不匹配，所以我正在编写下面的代码，如果你能给我一些建议，请告诉我。如果您想问我任何其他问题，请告诉我。

SMSForm.cs 文件

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;
using System.IO.Ports;
using Queue.Classes;

namespace Queue
{
public partial class SmsForm : Form
{
    public SmsForm()
    {
        InitializeComponent();
    }
    #region Private Variables

    SerialPort port = new SerialPort();
    clsSMS objclsSMS = new clsSMS();
    ShortMessageCollection objShortMessageCollection = new ShortMessageCollection();
    #endregion

    #region Private Methods

    #region Write StatusBar
    private void WriteStatusBar(string status)
    {

            statusBar1.Text = "Message: " + status;

    }
    #endregion

    #endregion

    private void btnOK_Click(object sender, EventArgs e)
    {
        try
        {
            //Open communication port 
            this.port = objclsSMS.OpenPort(this.cboPortName.Text, Convert.ToInt32(this.cboBaudRate.Text), Convert.ToInt32(this.cboDataBits.Text), Convert.ToInt32(this.txtReadTimeOut.Text), Convert.ToInt32(this.txtWriteTimeOut.Text));

            if (this.port != null)
            {
                this.gboPortSettings.Enabled = false;

                //MessageBox.Show("Modem is connected at PORT " + this.cboPortName.Text);
                this.statusBar1.Text = "Modem is connected at PORT " + this.cboPortName.Text;

                //Add tab pages
                this.tabSMSapplication.TabPages.Add(tabPage2);
                //  this.tabSMSapplication.TabPages.Add(tbReadSMS);
                //  this.tabSMSapplication.TabPages.Add(tbDeleteSMS);

                this.lblConnectionStatus.Text = "Connected at " + this.cboPortName.Text;
                this.btnDisconnect.Enabled = true;
            }

            else
            {
                //MessageBox.Show("Invalid port settings");
                this.statusBar1.Text = "Invalid port settings";
            }
        }
        catch (Exception ex)
        {
            ErrorLog(ex.Message);
        }
    }

    private void SmsForm_Load(object sender, EventArgs e)
    {
        try
        {
            #region Display all available COM Ports
            string[] ports = SerialPort.GetPortNames();

            // Add all port names to the combo box:
            foreach (string port in ports)
            {
                this.cboPortName.Items.Add(port);
            }
            #endregion

            //Remove tab pages
            this.tabSMSapplication.TabPages.Remove(tabPage2);

            //  this.tabSMSapplication.TabPages.Remove(tbReadSMS);
            //   this.tabSMSapplication.TabPages.Remove(tbDeleteSMS);

            this.btnDisconnect.Enabled = false;
        }
        catch (Exception ex)
        {
            ErrorLog(ex.Message);
        }
    }

    private void btnDisconnect_Click(object sender, EventArgs e)
    {
        try
        {
            this.gboPortSettings.Enabled = true;
            objclsSMS.ClosePort(this.port);

            //Remove tab pages
            this.tabSMSapplication.TabPages.Remove(tabPage2);
            //    this.tabSMSapplication.TabPages.Remove(tbReadSMS);
            //    this.tabSMSapplication.TabPages.Remove(tbDeleteSMS);

            this.lblConnectionStatus.Text = "Not Connected";
            this.btnDisconnect.Enabled = false;

        }
        catch (Exception ex)
        {
            ErrorLog(ex.Message);
        }
    }

    #region Error Log
    public void ErrorLog(string Message)
    {
        StreamWriter sw = null;

        try
        {
            WriteStatusBar(Message);

            string sLogFormat = DateTime.Now.ToShortDateString().ToString() + " " + DateTime.Now.ToLongTimeString().ToString() + " ==> ";
            //string sPathName = @"E:\";
            string sPathName = @"SMSapplicationErrorLog_";

            string sYear = DateTime.Now.Year.ToString();
            string sMonth = DateTime.Now.Month.ToString();
            string sDay = DateTime.Now.Day.ToString();

            string sErrorTime = sDay + "-" + sMonth + "-" + sYear;

            sw = new StreamWriter(sPathName + sErrorTime + ".txt", true);

            sw.WriteLine(sLogFormat + Message);
            sw.Flush();

        }
        catch (Exception ex)
        {
            ErrorLog(ex.ToString());
        }
        finally
        {
            if (sw != null)
            {
                sw.Dispose();
                sw.Close();
            }
        }

    }
    #endregion 

    private void sendsms_Click(object sender, EventArgs e)
    {
        try
        {

            if (objclsSMS.sendMsg(this.port, this.sim.Text, this.mssging.Text))
            {
                //MessageBox.Show("Message has sent successfully");
                this.statusBar1.Text = "Message has sent successfully";
            }
            else
            {
                //MessageBox.Show("Failed to send message");
                this.statusBar1.Text = "Failed to send message";
            }

        }
        catch (Exception ex)
        {
            ErrorLog(ex.Message);
        }
    }

}
} 
```

这是发送短信的类

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO.Ports;
using System.Threading;
using System.Text.RegularExpressions;

namespace Queue.Classes
{
 public class clsSMS
 {
    #region Open and Close Ports
    //Open Port
    public SerialPort OpenPort(string p_strPortName, int p_uBaudRate, int p_uDataBits, int p_uReadTimeout, int p_uWriteTimeout)
    {
        receiveNow = new AutoResetEvent(false);
        SerialPort port = new SerialPort();

        try
        {
            port.PortName = p_strPortName;                 //COM1
            port.BaudRate = p_uBaudRate;                   //9600
            port.DataBits = p_uDataBits;                   //8
            port.StopBits = StopBits.One;                  //1
            port.Parity = Parity.None;                     //None
            port.ReadTimeout = p_uReadTimeout;             //300
            port.WriteTimeout = p_uWriteTimeout;           //300
            port.Encoding = Encoding.GetEncoding("iso-8859-1");
            port.DataReceived += new SerialDataReceivedEventHandler(port_DataReceived);
            port.Open();
            port.DtrEnable = true;
            port.RtsEnable = true;
        }
        catch (Exception ex)
        {
            throw ex;
        }
        return port;
    }

    //Close Port
    public void ClosePort(SerialPort port)
    {
        try
        {
            port.Close();
            port.DataReceived -= new SerialDataReceivedEventHandler(port_DataReceived);
            port = null;
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }

    #endregion

    //Execute AT Command
    public string ExecCommand(SerialPort port, string command, int responseTimeout, string errorMessage)
    {
        try
        {

            port.DiscardOutBuffer();
            port.DiscardInBuffer();
            receiveNow.Reset();
            port.Write(command + "\r");

            string input = ReadResponse(port, responseTimeout);
            if ((input.Length == 0) || ((!input.EndsWith("\r\n> ")) && (!input.EndsWith("\r\nOK\r\n"))))
                throw new ApplicationException("No success message was received.");
            return input;
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }

    //Receive data from port
    public void port_DataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        try
        {
            if (e.EventType == SerialData.Chars)
            {
                receiveNow.Set();
            }
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }
    public string ReadResponse(SerialPort port, int timeout)
    {
        string buffer = string.Empty;
        try
        {
            do
            {
                if (receiveNow.WaitOne(timeout, false))
                {
                    string t = port.ReadExisting();
                    buffer += t;
                }
                else
                {
                    if (buffer.Length > 0)
                        throw new ApplicationException("Response received is incomplete.");
                    else
                        throw new ApplicationException("No data received from phone.");
                }
            }
            while (!buffer.EndsWith("\r\nOK\r\n") && !buffer.EndsWith("\r\n> ") && !buffer.EndsWith("\r\nERROR\r\n"));
        }
        catch (Exception ex)
        {
            throw ex;
        }
        return buffer;
    }

    #region Count SMS
    public int CountSMSmessages(SerialPort port)
    {
        int CountTotalMessages = 0;
        try
        {

            #region Execute Command

            string recievedData = ExecCommand(port, "AT", 300, "No phone connected at ");
            recievedData = ExecCommand(port, "AT+CMGF=1", 300, "Failed to set message format.");
            String command = "AT+CPMS?";
            recievedData = ExecCommand(port, command, 1000, "Failed to count SMS message");
            int uReceivedDataLength = recievedData.Length;

            #endregion

            #region If command is executed successfully
            if ((recievedData.Length >= 45) && (recievedData.StartsWith("AT+CPMS?")))
            {

                #region Parsing SMS
                string[] strSplit = recievedData.Split(',');
                string strMessageStorageArea1 = strSplit[0];     //SM
                string strMessageExist1 = strSplit[1];           //Msgs exist in SM
                #endregion

                #region Count Total Number of SMS In SIM
                CountTotalMessages = Convert.ToInt32(strMessageExist1);
                #endregion

            }
            #endregion

            #region If command is not executed successfully
            else if (recievedData.Contains("ERROR"))
            {

                #region Error in Counting total number of SMS
                string recievedError = recievedData;
                recievedError = recievedError.Trim();
                recievedData = "Following error occured while counting the message" + recievedError;
                #endregion

            }
            #endregion

            return CountTotalMessages;

        }
        catch (Exception ex)
        {
            throw ex;
        }

    }
    #endregion

    #region Read SMS

    public AutoResetEvent receiveNow;

    public ShortMessageCollection ReadSMS(SerialPort port, string p_strCommand)
    {

        // Set up the phone and read the messages
        ShortMessageCollection messages = null;
        try
        {

            #region Execute Command
            // Check connection
            ExecCommand(port, "AT", 300, "No phone connected");
            // Use message format "Text mode"
            ExecCommand(port, "AT+CMGF=1", 300, "Failed to set message format.");
            // Use character set "PCCP437"
            ExecCommand(port, "AT+CSCS=\"PCCP437\"", 300, "Failed to set character set.");
            // Select SIM storage
            ExecCommand(port, "AT+CPMS=\"SM\"", 300, "Failed to select message storage.");
            // Read the messages
            string input = ExecCommand(port, p_strCommand, 5000, "Failed to read the messages.");
            #endregion

            #region Parse messages
            messages = ParseMessages(input);
            #endregion

        }
        catch (Exception ex)
        {
            throw ex;
        }

        if (messages != null)
            return messages;
        else
            return null;

    }
    public ShortMessageCollection ParseMessages(string input)
    {
        ShortMessageCollection messages = new ShortMessageCollection();
        try
        {
            Regex r = new Regex(@"\+CMGL: (\d+),""(.+)"",""(.+)"",(.*),""(.+)""\r\n(.+)\r\n");
            Match m = r.Match(input);
            while (m.Success)
            {
                ShortMessage msg = new ShortMessage();
                //msg.Index = int.Parse(m.Groups[1].Value);
                msg.Index = m.Groups[1].Value;
                msg.Status = m.Groups[2].Value;
                msg.Sender = m.Groups[3].Value;
                msg.Alphabet = m.Groups[4].Value;
                msg.Sent = m.Groups[5].Value;
                msg.Message = m.Groups[6].Value;
                messages.Add(msg);

                m = m.NextMatch();
            }

        }
        catch (Exception ex)
        {
            throw ex;
        }
        return messages;
    }

    #endregion

    #region Send SMS

    static AutoResetEvent readNow = new AutoResetEvent(false);

    public bool sendMsg(SerialPort port, string PhoneNo, string Message)
    {
        bool isSend = false;

        try
        {

            string recievedData = ExecCommand(port, "AT", 300, "No phone connected");
            recievedData = ExecCommand(port, "AT+CMGF=1", 300, "Failed to set message format.");
            String command = "AT+CMGS=\"" + PhoneNo + "\"";
            recievedData = ExecCommand(port, command, 300, "Failed to accept phoneNo");
            command = Message + char.ConvertFromUtf32(26) + "\r";
            recievedData = ExecCommand(port, command, 3000, "Failed to send message"); //3 seconds
            if (recievedData.EndsWith("\r\nOK\r\n"))
            {
                isSend = true;
            }
            else if (recievedData.Contains("ERROR"))
            {
                isSend = false;
            }
            return isSend;
        }
        catch (Exception ex)
        {
            throw ex;
        }

    }
    static void DataReceived(object sender, SerialDataReceivedEventArgs e)
    {
        try
        {
            if (e.EventType == SerialData.Chars)
                readNow.Set();
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }

    #endregion

  }
 } 
```

这是获取和设置的另一个类：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.IO.Ports;
using System.Threading;
using System.Text.RegularExpressions;

namespace Queue.Classes
{
public class ShortMessage
{
    #region Private Variables
    private string index;
    private string status;
    private string sender;
    private string alphabet;
    private string sent;
    private string message;
    #endregion

    #region Public Properties
    public string Index
    {
        get { return index; }
        set { index = value; }
    }
    public string Status
    {
        get { return status; }
        set { status = value; }
    }
    public string Sender
    {
        get { return sender; }
        set { sender = value; }
    }
    public string Alphabet
    {
        get { return alphabet; }
        set { alphabet = value; }
    }
    public string Sent
    {
        get { return sent; }
        set { sent = value; }
    }
    public string Message
    {
        get { return message; }
        set { message = value; }
    }
    #endregion

}

public class ShortMessageCollection : List<ShortMessage>
{
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:13:47.957

我建议为此目的使用 GSMCOMM .NET 库 [http://www.scampers.org/steve/sms/libraries.htm](http://www.scampers.org/steve/sms/libraries.htm)

或者如果你有 nuget [http://nuget.org/packages/GSMComm/](http://nuget.org/packages/GSMComm/)

这个托管库将适合您的目的并为您提供易于使用的 api，因此我建议您使用它并尝试使用它。

# c++ - 如何从双向链表中获取节点内部的有效负载

> ID：14734664
> 
> 赞同：0
> 
> 时间：2013-02-06T17:02:26.727
> 
> 标签：c++, class, nested

```
template<class T> class CRevList
{
public:
//...constructor, destructor, etc;
  class Node //nested class   
  {
  public:
   friend class CRevList;

    Node() {m_next = 0;  m_prev = 0;}
    Node(const T &t) {m_payload = t;  m_next = 0;  m_prev = 0;}

    T Data() {return m_payload;}
    const T Data() const {return m_payload;}

    private:

      Node    *m_next;
      Node    *m_prev;
      T       m_payload;
  };
private: //for original class
  Node    *m_head, *m_tail;             // Head node
  unsigned size;
}; 
```

我做了很多尝试来从原始的双重链接类中获取节点的有效负载，不幸的是我遇到了错误。最像：

```
 error: request for member 'Data' in 'Temp1', which is of non-class type 'CRevList<int>::Node*' 
```

我一定是搞砸了两个类之间的指针或关系。

我试过了：

```
 //Find a node with the specified key
  const Node *Find(const T &t) const {  }
  Node *Find(const T &t) {
    Node * Temp1 = m_head;

    while(m_tail != Temp1){
            if(Temp1.Data() == t){
                    return Temp1;
            }

            Temp1 = Temp1->m_next;
    }
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:08:54.067

`Temp1`是类型`Node *`。因此，您应该调用`Temp1->Data()`而不是`Temp1.Data()`.

# macos - Mac OS X：如何在不升级 Mac OS X 的情况下升级 Mail.app

> ID：14734674
> 
> 赞同：0
> 
> 时间：2013-02-06T17:02:58.557
> 
> 标签：macos, email

我正在使用带有 Mac OS X 10.7 (Lion) 的 Mail.app 5.3 版。

如何在不购买 Mac OS X 10.8 的情况下升级 Mail.app 版本？（可能吗？）。

谢谢 ：）

# javascript - 使用 jQuery Mobile，onload 函数不会在 HTML 中触发

> ID：14734675
> 
> 赞同：4
> 
> 时间：2013-02-06T17:02:58.347
> 
> 标签：javascript, jquery, html, jquery-mobile

我有一个`index.html`具有以下语法的文件

```
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
</head>
<body>
<a href="occassion.html">
  <img class="frametoicon" src="img/occasion.png" />
</a>
</body>
</html> 
```

然后我的`occassion.html`页面具有`body onload`以下功能

```
 <html xmlns="http://www.w3.org/1999/xhtml">
 <head>
<title>Occassion</title>
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
<script>

    function loaded() {
        alert("hii");
    }
</script>
</head>
<body onLoad="loaded()">
</body>
</html> 
```

但是`onload`功能没有启动......如果我尝试刷新页面（`occassion.html`）然后`onload`功能被启动......为什么从导航时它不起作用`index.html`？

如果我删除 jQuery 文件，那么它会按预期工作....我缺少什么要添加的？

这也行不通

```
 $(document).ready(function () {
        loaded();
    }); 
```

编辑

我添加了

```
 <script>
    $(document).bind("pagechange", function (event, data) {
        console.log(data);
        var toPage = data.toPage[0].id;
        alert(toPage);
        if (toPage == "page2")
            alert("hello");
    });
</script> 
```

并将以下内容放入 occassion.html

```
<div data-role="page" id="page2">
 hello
 </div> 
```

令我惊讶的是，甚至警报（hello）都没有触发，但也没有显示 hello 并且警报（topage）是空的..

如何？少了什么东西

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-06T17:47:51.133

jQuery Mobile 使用 AJAX 将页面拉入 DOM，这就是它可以在页面之间转换的方式。当 jQuery Mobile 执行此操作时，它很有可能在`window.load`事件触发后执行此操作，因此该事件通常不会触发，除非您刷新页面（然后`window.load`会再次触发）。用户似乎有可能在`window.load`事件触发之前单击链接并加载它，但我不希望这是常态。

解决方法是使用 jQuery Mobile 特定事件，在这种情况下，您可能正在寻找`pageload`/ `pagecreate`/ `pageinit`，请在此处查看有关它们的文档：http: [//jquerymobile.com/demos/1.2.0/docs/api/events.html](http://jquerymobile.com/demos/1.2.0/docs/api/events.html)

这是一个如何工作的快速示例（此代码将位于中心并包含在每个文档中）：

```
$(document).on("pageinit", "#occasions", loaded); 
```

请注意，这`#occasions`将是`data-role="page"`场合页面中的元素。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T17:05:56.143

### 编辑

实际上，由于您使用 jquery mobile，因此您可能正在其他地方寻找问题。

因此，转到[jquery mobile api](http://jquerymobile.com/demos/1.2.0/docs/api/events.html)我们看到我们有点需要`pagechange`或`pageload`事件。

# sql - 带有删除表的 t-sql 中的临时表

> ID：14734676
> 
> 赞同：1
> 
> 时间：2013-02-06T17:03:06.763
> 
> 标签：sql, sql-server, tsql, pivot

有没有办法在 t-sql 中创建一个只有一列的临时表，加载它并检索数据？让我解释...

我有一个这样的存储过程：

```
SELECT @cols = STUFF(( SELECT DISTINCT TOP 100 PERCENT '],[' + cast(MonthYear as varchar(10)) FROM vCountByMonthYear    where 
    SiteGUID = @SiteGuid 
    and 
    MonthYear BETWEEN @StartDate AND @StopDate 
    ORDER BY '],[' + cast(MonthYear as varchar(10)) FOR XML PATH('') ), 1, 2, '') + ']' 

     SET @query = N'SELECT Wuc,LineCount, ' + @cols +' FROM (SELECT Wuc,MonthYear,LineCount,Value,OrderBy FROM vCountByMonthYear 
     where SiteGUID = ' + CHAR(39) + CONVERT(nvarchar(36), @SiteGuid) + CHAR(39) + 
     ' and MonthYear BETWEEN ' 
     + CHAR(39) 
     + CONVERT(nvarchar(10),@StartDate )
     + CHAR(39) 
     + ' AND ' 
     + CHAR(39) 
     + CONVERT(nvarchar(10),@StopDate )
     + CHAR(39) 
     + ' ) p 
     PIVOT ( Sum ([Value] ) FOR MonthYear IN ( '+ @cols +' ) ) AS pvt ORDER BY Wuc,OrderBy' 

     execute(@query) 
```

如果我修改视图，事情就会变得一团糟，但我需要从该视图中获取更多信息——一个 EventId 字段。如果将其添加到此查询中，我的结果都不好，所以我想我可以创建一个临时表并插入我需要的内容，然后从一个总是在之后立即运行的不同存储过程中查询临时表并将其删除。

那可行吗？如何删除刚刚查询的同一个存储区中的表？我是不是在想这个？

谢谢，里修

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:12:20.143

您可以创建一个全局临时表（使用 ## 而不是 # 定义）。由于 exec 在与存储过程不同的范围内运行，因此您将无法访问在存储过程范围内定义的临时表。然后，您可以在动态查询中访问该全局临时表，并在过程结束时将其删除。

但是，所有东西都可以访问这个全局表，所以要小心。

```
CREATE TABLE ##globalTmpTable (EventID INT) 
```

# gwt - GWT - AbsolutePanel and ProvidesResize + RequiresResize

> ID：14734689
> 
> 赞同：1
> 
> 时间：2013-02-06T17:03:44.143
> 
> 标签：gwt

I tried to implement [ProvidesResize](http://google-web-toolkit.googlecode.com/svn/javadoc/2.3/com/google/gwt/user/client/ui/ProvidesResize.html) interface to [com.google.gwt.user.client.ui.AbsolutePanel](http://google-web-toolkit.googlecode.com/svn/javadoc/2.3/com/google/gwt/user/client/ui/AbsolutePanel.html). Then I implemented RequiresResize to its supposed childs but it seems like method onResize() fails to be called or I didn't get it :(

So my question is... How to catch was an AbsolutePanel child widget resized or not and is it possible to?

P.S. GWT 2.2/2.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:40:00.363

Your panel itself could implement the `RequiresResize` interface and have the `onResize()` method do something like this (copied from [DeckLayoutPanel](http://code.google.com/p/google-web-toolkit/source/browse/tags/2.4.0/user/src/com/google/gwt/user/client/ui/DeckLayoutPanel.java#200)):

```
 public void onResize() {
    for (Widget child : getChildren()) {
      if (child instanceof RequiresResize) {
        ((RequiresResize) child).onResize();
      }
    }
  } 
```

Now if you make your panel a child of a `ProvidesResize` widget, the chain of onResize() calls should propagate through your panel to the children of your panel.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T21:24:28.153

HTML just doesn't tell you when something changes size. Major bummer.

What you CAN find out is when the window changes size. `RootLayoutPanel` listens for window size change events. When it hears one, it tells all its children, "Hey, you probably just changed size. Check it out." Then all of those children are supposed to tell all of THEIR children, "Hey, check your size, guys. Might be different."

So. Your `AbsolutePanel` that implements `ProvidesResize` has to be hooked into this process somehow. If you add it to `RootLayoutPanel`, you can get the message by *also* implementing `RequiresResize`. If you're not adding it into the `RootLayoutPanel` chain, you have to find out resize information yourself somehow. You could either listen for window size events, or trigger the size calculation when you know something else changed in the layout. Whatever you want. Unfortunately this can't be done for you unless you have a continuous chain of `RequiresResize` and `ProvidesResize` widgets all the way up to `RootLayoutPanel`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-07T03:00:16.587

You can do something simillar to [this](http://code.google.com/p/multi-platform/source/browse/trunk/library.gwt_client.GWT_UI/src/library/gwt_client/gwt_ui/widget_factory/flow_panel/FlowLayoutPanel.java?r=506)

# ruby-on-rails - 使用 accept_nested_attributes_for 更新关联的问题

> ID：14734692
> 
> 赞同：1
> 
> 时间：2013-02-06T17:03:47.567
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在尝试构建一个在更新父对象时更新关联的表单。我一直在尝试使用该`accepts_nested_attributes_for`选项，`attr_accessible`但仍然遇到`Can't mass-assign protected attributes`错误。

这是我的模型：

```
class Mastery < ActiveRecord::Base
  attr_accessible :mastery_id,
                  :name,
                  :icon,
                  :max_points,
                  :dependency,
                  :tier,
                  :position,
                  :tree,
                  :description,
                  :effects_attributes
  has_many :effects, :as => :affects, :dependent => :destroy, :order => 'effects.value'
  accepts_nested_attributes_for :effects
end

class Effect < ActiveRecord::Base
  attr_accessible :name,
                  :modifier,
                  :value,
                  :affects_id,
                  :affects_type
  belongs_to :affects, :polymorphic => true
end 
```

这是呈现表单的部分内容：

```
<%= semantic_form_for [ :manage, resource ], :html => {:class => 'default-manage-form' } do |f| %>
  <%= f.inputs do %>
    <% attributes.each do |attr| %>
      <%= f.input attr.to_sym %>
    <% end %>

    <% if resource.respond_to? :effects %>
      <% resource.effects.each do |effect| %>
        <hr>
        <%= f.inputs :modifier, :name, :value, :for => effect %>
      <% end %>
    <% end %>

    <%= f.actions do %>
      <%= f.action :submit %>
    <% end %>
  <% end %>
<% end %> 
```

我的表格用于包含多个效果记录的掌握记录。谁能明白我为什么会遇到这个错误以及我能做些什么来解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:28:59.700

我通过做两件事解决了这个问题：

1）更改要使用的表单结构`fields_for`和

2) 添加`:effects_attributes`到 Mastery 模型的 attr_accessible

这是新的表单代码：

```
<%= semantic_form_for [ :manage, resource ], :html => {:class => 'default-manage-form' } do |f| %>
  <%= f.inputs do %>
    <% attributes.each do |attr| %>
      <%= f.input attr.to_sym %>
    <% end %>

    <% if resource.respond_to? :effects %>
      <%= f.fields_for :effects do |b| %>
        <hr>
        <%= b.inputs :modifier, :name, :value %>
      <% end %>
    <% end %>

    <%= f.actions do %>
      <%= f.action :submit %>
    <% end %>
  <% end %>
<% end %> 
```

和成品模型：

```
class Mastery < ActiveRecord::Base
  attr_accessible :name,
                  :icon,
                  :max_points,
                  :dependency,
                  :tier,
                  :position,
                  :tree,
                  :description,
                  :effects_attributes
  has_many :effects, :as => :affects, :dependent => :destroy, :order => 'effects.value'
  accepts_nested_attributes_for :effects
end 
```

# python - 如何更新 matplotlib hexbin 图？

> ID：14734693
> 
> 赞同：5
> 
> 时间：2013-02-06T17:03:50.937
> 
> 标签：python, matplotlib, gtk

我有一个`matplotlib` `hexbin`嵌入在`GTK.Window`图表中的一些数据（x，y）。我希望在`plot`收到新数据时更新（通过`UDP`）。不过我遇到了一些麻烦。

我可以让它以几种不同的方式工作，但没有一个是“有效的”（意思是重绘`plot`需要太长时间）。我[在这里查看](https://stackoverflow.com/questions/4098131/matplotlib-update-a-plot)并尝试在建议的答案之后为我的 hexbin 建模，但根本无法让它工作。我不断收到以下错误：

`TypeError: 'PolyCollection' object is not iterable.`

我猜这`hexbins`不能以与 standard 相同的方式更新`plots`。

**示例代码：**

```
class graph:
    def __init__(self):
        self.window = gtk.Window()
        self.figure = plt.figure()
        self.ax = self.figure.add_subplot(111)
        self.canvas = FigureCanvas(self.figure)
        self.window.add(self.canvas)

        self.graph = None

    def plot(self, xData, yData):
        if len(xData) > 1 and len(yData) > 1:
            self.graph, = self.ax.hexbin(self.xData, self.yData) 
            ###############################################
            ####This is where the code throws the error####

    def update(self, xData, yData):
        self.graph.set_xdata(np.append(self.graph.get_xdata(), xData))
        self.graph.set_ydata(np.append(self.graph.get_ydata(), yData))
        self.figure.canvas.draw() 
```

**代码是这样使用的：**

```
graph = graph()
graph.plot(someXData, someYData)
# when new data is received
graph.update(newXData, newYData) 
```

这只是我如何使用代码的一个非常小的例子。我没有太多经验，`matplotlib`所以我可能会完全错误地解决这个问题。（这很可能是我正在做的事情）

所以我最终的问题是 -*你如何更新`matplotlib` `hexbin`情节？*

* * *

**编辑：**感谢danodonovan的回答，我改变了我的代码并删除了'，'之后`self.graph = self.ax.hexbin(...)`

抛出的新错误是：`AttributeError: 'PolyCollection' object has no attribute 'set_xdata'`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:16:43.570

该行：

```
 self.graph, = self.ax.hexbin(self.xData, self.yData) 
```

（如果那是您的堆栈跟踪抛出异常的地方）将是因为逗号，暗示这`self.ax.hexbin`是一个可迭代的对象。更改为

```
 self.graph = self.ax.hexbin(self.xData, self.yData) 
```

可能会停止`TypeError exception`. 下一次，在堆栈跟踪中再提供几行 - 这可能有助于澄清事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T20:28:41.810

我认为目前无法做到这一点，`hexbin`转换 x,y 列表 -> 多边形集合。这`polyCollection`只是一个顶点、边和面颜色的列表，我认为它不包含任何关于它是如何生成的语义信息。

最好的方法是核对旧的`hexbin`并用新的替换它。

如果您真的希望能够就地更新，请使用方形 2d 直方图（因此您可以使用`imshow`），或者您可以修改`hexbin`以返回补丁列表（而不是`polyCollection`）并跟踪您自己的分箱。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:33:12.620

要回答您预期的问题，而不是调用`set_xdata`类似`update_from`. 我不保证这会奏效，但我会尝试

```
def update(self, xData, yData):
    # update your data structures
    self.xData = np.append(self.xData, xData)
    self.yData = np.append(self.yData, yData)

    # create a new hexbin - not connected to anything, with the new data
    new_hexbin = self.ax.hexbin(self.xData, self.yData)

    # update the viewed hexbin from the new one
    self.graph.update_from(new_hexbin)
    self.figure.canvas.draw() 
```

请注意，如果没有更多代码或解释，这实际上只是猜测工作！这个类的文档在[这里](http://matplotlib.org/api/collections_api.html?highlight=polycollection#matplotlib.collections.PolyCollection)，[`update_from`](http://matplotlib.org/api/collections_api.html?highlight=polycollection#matplotlib.collections.Collection.update_from)方法来自[父类](http://matplotlib.org/api/collections_api.html?highlight=polycollection#matplotlib.collections.Collection)。

# algorithm - 将设备映射到电源插座的有效方法？

> ID：14734694
> 
> 赞同：1
> 
> 时间：2013-02-06T17:03:57.943
> 
> 标签：algorithm, automation

我有四个[网络电源开关](http://www.digital-loggers.com/lpc.html)，每个开关有八个遥控电源插座，总共有 32 个电源插座。我有一个连接到每个插座的被测设备。这些被测设备已联网并具有 SSH。它们被设计为在两分钟内启动，但由于是开发中的原型，它们有时需要十分钟才能启动。它们还容易随机崩溃、冻结或以其他方式变得无响应。

我正在寻找一种将设备映射到电源插座的可靠、高效、自动化的方法。我目前的方法可靠且自动化，但速度很慢：

```
turn off all outlets
for each outlet:
    turn outlet on
    wait ten minutes
    try to connect to all devices
    store all responsive devices in a list
    turn the outlet off
    try to connect to the devices in the responsive list
    if any are no longer responsive, map them to this outlet
turn on all outlets 
```

正如您可以计算的那样，每个插座大约需要 10 分钟，而 10 分钟 x 32 是 320 分钟，或超过 5 小时。我觉得必须有更好的方法，但我一直想不出任何办法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:18:48.113

让我们假设网点的编号从 0 到 31。

第一次尝试：打开所有奇数插座并注意哪些设备有响应

第二次尝试：打开所有在其编号的二进制表示中第二位为 1 的插座（即 2、3、6、7、10、11，...）

第三次尝试：打开所有在其编号的二进制表示中第三位为 1 的插座（即 4、5、6、7、12、13、14、15，...）

...

第五次尝试：打开所有数字> = 16的插座

现在，在某些尝试中，每台设备都有响应。如果您再次将结果写为二进制数，您将获得插座的编号。

例如，如果一个设备在尝试 5、3、2 中处于活动状态，而在 4 和 1 中处于非活动状态，我们得到 10110，即 22。所以这个设备必须连接到插座 22。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:57:43.857

笔记：

*   这是一种乐观的方法，您的设备工作得越好，它工作得越快越好
*   它使用的事实（如您`I have a device under test connected to each outlet.`所说）存在插座与设备的 1:1 映射

这个顺序基本上颠倒了你的顺序，因为这样你只需要等待 10 分钟（最多）一次 - 每个周期，见下文。

```
turn on all outlets
wait for all devices to become active for up to ten minutes
   (but interrupt waiting once you see a number of devices corresponding 
    to the number of outlets turned on)
store responsive devices
for each outlet:
    turn outlet off
    try to connect to all devices remaining on the responsive list
    if any are no longer responsive, map them to this outlet 
```

很可能您最终会得到一个尚未映射的设备和插座列表，因此您可以只使用未映射的插座重复此循环，直到没有插座或直到您用完时间。

因此，在最好的情况下（所有设备都在正常时间内正确启动），您的测试将在 2 分钟多一点的时间内结束。

# python - 获取值是熊猫数据框中的值的列名

> ID：14734695
> 
> 赞同：37
> 
> 时间：2013-02-06T17:04:03.993
> 
> 标签：python, dataframe, pandas

我试图在每个时间戳处查找数据框中的列名，其值与同一时间戳的时间序列中的列名匹配。

这是我的数据框：

```
>>> df
                            col5        col4        col3        col2        col1
1979-01-01 00:00:00  1181.220328  912.154923  648.848635  390.986156  138.185861
1979-01-01 06:00:00  1190.724461  920.767974  657.099560  399.395338  147.761352
1979-01-01 12:00:00  1193.414510  918.121482  648.558837  384.632475  126.254342
1979-01-01 18:00:00  1171.670276  897.585930  629.201469  366.652033  109.545607
1979-01-02 00:00:00  1168.892579  900.375126  638.377583  382.584568  132.998706

>>> df.to_dict()
{'col4': {<Timestamp: 1979-01-01 06:00:00>: 920.76797370744271, <Timestamp: 1979-01-01 00:00:00>: 912.15492332839756, <Timestamp: 1979-01-01 18:00:00>: 897.58592995700656, <Timestamp: 1979-01-01 12:00:00>: 918.1214819496729}, 'col5': {<Timestamp: 1979-01-01 06:00:00>: 1190.7244605667831, <Timestamp: 1979-01-01 00:00:00>: 1181.2203275146587, <Timestamp: 1979-01-01 18:00:00>: 1171.6702763228691, <Timestamp: 1979-01-01 12:00:00>: 1193.4145103184442}, 'col2': {<Timestamp: 1979-01-01 06:00:00>: 399.39533771666561, <Timestamp: 1979-01-01 00:00:00>: 390.98615646597591, <Timestamp: 1979-01-01 18:00:00>: 366.65203285812231, <Timestamp: 1979-01-01 12:00:00>: 384.63247469269874}, 'col3': {<Timestamp: 1979-01-01 06:00:00>: 657.09956023625466, <Timestamp: 1979-01-01 00:00:00>: 648.84863460462293, <Timestamp: 1979-01-01 18:00:00>: 629.20146872682449, <Timestamp: 1979-01-01 12:00:00>: 648.55883747413225}, 'col1': {<Timestamp: 1979-01-01 06:00:00>: 147.7613518219286, <Timestamp: 1979-01-01 00:00:00>: 138.18586102094068, <Timestamp: 1979-01-01 18:00:00>: 109.54560722575859, <Timestamp: 1979-01-01 12:00:00>: 126.25434189361377}} 
```

以及我想在每个时间戳匹配的值的时间序列：

```
>>> ts
1979-01-01 00:00:00    1181.220328
1979-01-01 06:00:00    657.099560
1979-01-01 12:00:00    126.254342
1979-01-01 18:00:00    109.545607
Freq: 6H

>>> ts.to_dict()
{<Timestamp: 1979-01-01 06:00:00>: 657.09956023625466, <Timestamp: 1979-01-01 00:00:00>: 1181.2203275146587, <Timestamp: 1979-01-01 18:00:00>: 109.54560722575859, <Timestamp: 1979-01-01 12:00:00>: 126.25434189361377} 
```

那么结果将是：

```
>>> df_result
                             value  Column
1979-01-01 00:00:00    1181.220328  col5
1979-01-01 06:00:00    657.099560   col3
1979-01-01 12:00:00    126.254342   col1
1979-01-01 18:00:00    109.545607   col1 
```

我希望我的问题足够清楚。任何人都知道如何获得 df_result？

谢谢

格雷格

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2020-08-18T21:26:41.877

只是想在*多*列可能具有值并且您想要列表中的*所有*列名的情况下添加它，您可以执行以下操作（例如，获取所有列名的值 = 'x'）：

```
df.apply(lambda row: row[row == 'x'].index, axis=1) 
```

这个想法是你将每一行变成一个系列（通过添加`axis=1`），列名现在变成系列的索引。然后，您使用条件（例如）过滤您的系列`row == 'x'`，然后获取索引值（也就是列名！）。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-02-06T18:02:07.100

这是一种可能不太优雅的方法：

```
df_result = pd.DataFrame(ts, columns=['value']) 
```

设置一个函数来获取包含值的列名（来自`ts`）：

```
def get_col_name(row):    
    b = (df.ix[row.name] == row['value'])
    return b.index[b.argmax()] 
```

*对于每一行，测试哪些元素等于该值，并提取 True 的列名。*

[`apply`](http://pandas.pydata.org/pandas-docs/dev/generated/pandas.DataFrame.apply.html)它（按行）：

```
In [3]: df_result.apply(get_col_name, axis=1)
Out[3]: 
1979-01-01 00:00:00    col5
1979-01-01 06:00:00    col3
1979-01-01 12:00:00    col1
1979-01-01 18:00:00    col1 
```

即使用 `df_result['Column'] = df_result.apply(get_col_name, axis=1)`.

.

注意：有很多事情发生，`get_col_name`所以也许需要进一步解释：

```
In [4]: row = df_result.irow(0) # an example row to pass to get_col_name

In [5]: row
Out[5]: 
value    1181.220328
Name: 1979-01-01 00:00:00

In [6]: row.name # use to get rows of df
Out[6]: <Timestamp: 1979-01-01 00:00:00>

In [7]: df.ix[row.name]
Out[7]: 
col5    1181.220328
col4     912.154923
col3     648.848635
col2     390.986156
col1     138.185861
Name: 1979-01-01 00:00:00

In [8]: b = (df.ix[row.name] == row['value'])
        #checks whether each elements equal row['value'] = 1181.220328  

In [9]: b
Out[9]: 
col5     True
col4    False
col3    False
col2    False
col1    False
Name: 1979-01-01 00:00:00

In [10]: b.argmax() # index of a True value
Out[10]: 0

In [11]: b.index[b.argmax()] # the index value (column name)
Out[11]: 'col5' 
```

*可能有更有效的方法来做到这一点......*

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-12-10T14:31:08.550

继安迪的详细回答之后，选择每行最高值的列名的解决方案可以简化为一行：

```
df['column'] = df.apply(lambda x: df.columns[x.argmax()], axis = 1) 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2021-08-22T14:20:46.600

## 用于[`df.eq()`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.eq.html)约 300 倍的加速`df.apply()`

与矢量化相比，其他答案很好，但速度很慢[`df.eq()`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.eq.html)：

```
df.loc[ts.index].eq(ts, axis=0).idxmax(axis=1)

# 1979-01-01 00:00:00    col5
# 1979-01-01 06:00:00    col3
# 1979-01-01 12:00:00    col1
# 1979-01-01 18:00:00    col1
# dtype: object 
```

*   [`loc[ts.index]`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html)返回`df`匹配`ts`时间戳的行
*   [`eq(ts, axis=0)`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.eq.html)将每个`ts`值与一行 ( `axis=0`) 进行比较`df`
    *   `eq(ts[:, None])`将是[numpy 广播](https://numpy.org/doc/stable/user/theory.broadcasting.html#array-broadcasting-in-numpy)等价物
*   [`idxmax(axis=1)`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.idxmax.html)返回每行中的第一个匹配列 ( `axis=1`)

[![矢量化 vs df.apply 时间](../Images/4aaa9060a2d46673edb615f500117476.png)](https://i.stack.imgur.com/2ZIjb.png)

^(*测试数据：*)
^(*`index = pd.date_range('2000-01-01', periods=n, freq='1T')`*)
^(*`df = pd.DataFrame(np.random.random(size=(n, 5)), index=index).add_prefix('col')`*)
^(*`ts = df.apply(np.random.choice, axis=1).sample(frac=0.9)`*)

* * *

## 用于[`np.isclose()`](https://numpy.org/doc/stable/reference/generated/numpy.isclose.html)更安全的浮动比较

除非您有特定原因来测试严格相等，[否则应该将浮点数与容差进行比较](https://stackoverflow.com/q/5595425/13138364)，例如，使用[`isclose()`](https://numpy.org/doc/stable/reference/generated/numpy.isclose.html)：

*   用于[`isclose()`](https://numpy.org/doc/stable/reference/generated/numpy.isclose.html)与 进行比较`df`，`ts`其中`[:, None]` [拉伸`ts`到与 相同的大小`df`](https://numpy.org/doc/stable/user/theory.broadcasting.html#array-broadcasting-in-numpy)：

    ```
    close = np.isclose(df.loc[ts.index], ts[:, None])

    # array([[ True, False, False, False, False],
    #        [False, False,  True, False, False],
    #        [False, False, False, False,  True],
    #        [False, False, False, False,  True]]) 
    ```

*   然后，和以前一样，使用[`idxmax(axis=1)`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.idxmax.html)提取每行的第一个匹配列：

    ```
    pd.DataFrame(close, index=ts.index, columns=df.columns).idxmax(axis=1)

    # 1979-01-01 00:00:00    col5
    # 1979-01-01 06:00:00    col3
    # 1979-01-01 12:00:00    col1
    # 1979-01-01 18:00:00    col1
    # dtype: object 
    ```

使用[`isclose()`](https://numpy.org/doc/stable/reference/generated/numpy.isclose.html)将与[`eq()`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.eq.html)（因此比：*快得多*）一样快`df.apply()`：

[![矢量化 eq 与 isclose 时序](../Images/3f68354a52371a7660cb7bad735f7eb4.png)](https://i.stack.imgur.com/vuouG.png)

* * *

[*请注意，如果您有更复杂的连接条件，请使用[`df.merge()`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html)、[`df.join()`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.join.html)或[`df.reindex()`](https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.reindex.html)。对于 OP 的问题，这些都是矫枉过正，但看起来像这样：*]

*   `df.merge(ts.rename('ts'), left_index=True, right_index=True)`
*   `df.join(ts.rename('ts'), how='right')`
*   `df.reindex(ts.index)`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-05-12T20:30:54.223

我试图创建一个新列来指示哪个现有列具有最大的行值。这给了我所需的字符串列标签：

```
df['column_with_biggest_value'] = df.idxmax(axis=1) 
```

# ios - 在 Storyboard 或 .xib 上拖动对象总是将其放在下面的对象内。为什么？

> ID：14734700
> 
> 赞同：1
> 
> 时间：2013-02-06T17:04:17.550
> 
> 标签：ios, xcode, storyboard, xib

我有一个 ScrollView 填充我的视图。我还有一些其他的东西。当我尝试将它们重新定位在顶部时，Xcode 坚持将它们放在 ScrollView 中。有没有我可以按下的键或其他东西来阻止这种情况的发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:26:26.153

麦克德拉蒙德，

我想知道同样的事情，最初对这种行为感到沮丧。所以我也有兴趣听到其他回应。但我可以分享一些可能会有所帮助的技巧。

1.  知道您视图中对象的顺序决定了 z 顺序的优先级。如果您需要处理特定对象，只需将其向上或向下移动以使其位于堆栈顶部。如果您无意中将对象彼此放在一起，您可以在对象树视图中移动以将其放入正确的视图中。

2.  知道您可以在定位/编辑时临时隐藏对象和调整对象大小，以允许其他对象可访问/可见。

3.  要知道，一旦您在情节提要或 .xib 上获得了一个对象，您就可以使用箭头键并通过显式设置 x、y、宽度、高度来移动它们。尽管这似乎是一个过于手动的过程，但我发现它确实没有那么糟糕，并且让我可以按照我想要的方式排列好东西。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T21:56:05.383

我认为这只是 Xcode 的众多怪癖之一。尝试将左侧栏中的元素列表拉到 Scroll View 上方，它应该将元素放在 Scroll View 上方。

# haskell - Haskell 无法推断类型相等

> ID：14734702
> 
> 赞同：1
> 
> 时间：2013-02-06T17:04:31.327
> 
> 标签：haskell, automatic-differentiation

我有以下代码，无法编译：

```
 import Numeric.AD

  data Trainable a b = forall n . Floating n =>  Trainable ([n] -> a -> b) (a -> b -> [n] -> n) 

  trainSgdFull :: (Floating n, Ord n) => Trainable a b -> [n] -> a -> b -> [[n]]
  trainSgdFull (Trainable _ cost) init input target =  gradientDescent (cost input target) init 
```

我想使用 Trainable 类型来表示可通过梯度下降训练的机器学习系统。第一个参数是传递函数，第二个参数是成本函数，a 是输入类型，b 是输出/目标类型，列表包含可学习的参数。编译器抱怨这个：

```
 src/MachineLearning/Training.hs:12:73:
Could not deduce (n1 ~ ad-3.3.1.1:Numeric.AD.Internal.Types.AD s n)
from the context (Floating n, Ord n)
  bound by the type signature for
             trainSgdFull :: (Floating n, Ord n) =>
                             Trainable a b -> [n] -> a -> b -> [[n]]
  at src/MachineLearning/Training.hs:12:3-95
or from (Floating n1)
  bound by a pattern with constructor
             Trainable :: forall a b n.
                          Floating n =>
                          ([n] -> a -> b) -> (a -> b -> [n] -> n) -> Trainable a b,
           in an equation for `trainSgdFull'
  at src/MachineLearning/Training.hs:12:17-32
or from (Numeric.AD.Internal.Classes.Mode s)
  bound by a type expected by the context:
             Numeric.AD.Internal.Classes.Mode s =>
             [ad-3.3.1.1:Numeric.AD.Internal.Types.AD s n]
             -> ad-3.3.1.1:Numeric.AD.Internal.Types.AD s n
  at src/MachineLearning/Training.hs:12:56-95
  `n1' is a rigid type variable bound by
       a pattern with constructor
         Trainable :: forall a b n.
                      Floating n =>
                      ([n] -> a -> b) -> (a -> b -> [n] -> n) -> Trainable a b,
       in an equation for `trainSgdFull'
       at src/MachineLearning/Training.hs:12:17
Expected type: [ad-3.3.1.1:Numeric.AD.Internal.Types.AD s n1]
               -> ad-3.3.1.1:Numeric.AD.Internal.Types.AD s n1
  Actual type: [n] -> n
In the return type of a call of `cost'
In the first argument of `gradientDescent', namely
  `(cost input target)' 
```

基本概念对吗？如果是，我怎样才能使代码编译？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T19:01:28.187

问题是

```
data Trainable a b = forall n . Floating n =>  Trainable ([n] -> a -> b) (a -> b -> [n] -> n) 
```

意味着在

```
Trainable transfer cost 
```

使用的类型`n`丢失了。所知道的是，有某种类型`Guessme`的`Floating`实例使得

```
transfer :: [Guessme] -> a -> b
cost :: a -> b -> [Guessme] -> Guessme 
```

您可以使用仅适用于或仅适用于或 ...的功能构建`Trainable`s`Complex Float``Double`

但在

```
trainSgdFull :: (Floating n, Ord n) => Trainable a b -> [n] -> a -> b -> [[n]]
trainSgdFull (Trainable _ cost) init input target =  gradientDescent (cost input target) init 
```

您正在尝试使用作为参数提供的`cost`任何类型。`Floating`

`Trainable`是为使用 type 而构建的，`n0`用户提供 type `n1`，这些可能相同也可能不同。因此编译器不能推断它们是相同的。

如果您不想制作`n`的类型参数`Trainable`，则需要使其包装适用于调用者提供的*每种* `Floating`类型的多态函数

```
data Trainable a b
    = Trainable (forall n. Floating n => [n] -> a -> b)
                (forall n. Floating n => a -> b -> [n] -> n) 
```

（需要`Rank2Types`，或者，因为它正在被弃用，`RankNTypes`）。

# php - 如何在magento中提交表单时添加“请稍候”弹出窗口

> ID：14734709
> 
> 赞同：1
> 
> 时间：2013-02-06T17:04:38.457
> 
> 标签：php, magento, magento-1.7

我在 magento 中有一个管理模块。提交表单后，我希望能够显示“请稍候”弹出窗口（与更改类别时获得的方式相同）。我目前没有使用任何 AJAX，但假设我需要使用 ajax 提交表单。我没有任何 phtml 文件，因为我的表单信息是以编程方式设置的（因为它是动态的）。

有人可以指出我在magento中使用“请稍候”的正确方向，无论是否有AJAX？

如果您需要有关我如何显示表单的更多信息，请告诉我，因为我不知道需要什么信息，也不想只是用随机片段填充我的帖子。

**解决**

只是为了清楚地保存评论：

我覆盖了默认的保存按钮来添加一个 JS onclick：

```
$this->_updateButton('save', 'onclick', 'submitForm()'); 
```

然后我使用了一个 JS 文件`layout.xml`

```
<reference name="head">
    <action method="addJs"><script>mymodule/javascript.js</script></action>
</reference> 
```

然后添加了一个JS函数：

```
function submitForm(){
    $('edit_form').request({
         onComplete: function()  { 
             window.location.href = document.URL; 
         }
     })  
} 
```

这为我整理了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-07-31T13:59:04.850

这是添加请等待微调器的最常见页面，所以我想我会在这里增加答案，以供我们这些在不通过 ajax 提交时希望在其中显示微调器但做一些其他 js 时找到此页面的人加工。

有一种非常简单的方法可以显示微调器（adminhtml 模板），即在您的页面中添加以下 js：-

```
Element.show('loading-mask');
/* do your js stuff here */
Element.hide('loading-mask'); 
```

请记住，任何执行的 ajax 都会隐藏您的加载掩码本身，因此如果单击按钮，您可能希望之后再次重新显示掩码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:13:23.297

默认情况下，在 magento admin 中，您使用以下代码提交的任何 ajax 都将显示“请稍候”

```
function submitForm(){
   new Ajax.Request(url, {
      method:'post',
      .....
   });
 }

$fieldset->addField('submit', 'submit', array(
      'label'     => Mage::helper('form')->__('Submit'),
      'required'  => true,
      'onclick' => "submitForm",
      'value'  => 'Submit()',
      'after_element_html' => '<small>Comments</small>',
      'tabindex' => 1
    )); 
```

看一看 @

[http://www.excellencemagentoblog.com/magento-admin-form-field](http://www.excellencemagentoblog.com/magento-admin-form-field)

[http://turnkeye.com/blog/magento-admin-form/](http://turnkeye.com/blog/magento-admin-form/)

# php - PHP OOP - 上传表单后 isset 和文件大小不起作用

> ID：14734711
> 
> 赞同：-4
> 
> 时间：2013-02-06T17:04:41.597
> 
> 标签：php, isset

我不知道代码是否正确，但 MAX FILE SIZE 不起作用

并且不要检查文件是否存在，也许我错误地实现了 isset 或者代码中有什么东西。

ps给我这个错误：

注意：未定义变量：ecc../ecc 中的内容。在第 23 行

注意：未定义变量：ecc../ecc 中的 fp。在第 24 行

这是代码：

```
<?php
interface ICheckImage {

         public function checkImage();

}           
abstract class ACheckImage implements ICheckImage {

         public $fileName;
         public $tmpName;
         public $filesSize;
         public $fileType;
         public $fp;
         public $conent;
         protected $mysqli; 

         public function __construct(){

             $this->fileName = $_FILES['userfile']['name'];
             $this->tmpName  = $_FILES['userfile']['tmp_name'];
             $this->filesSize = $_FILES['userfile']['size'];
             $this->fileType = $_FILES['userfile']['type'];
             $this->content = $content;
             $this->fp = $fp;
             $this->mysqli = new mysqli('localhost','root','root','test');

            }
    }           
class Check extends ACheckImage {

         public function checkImage(){

             if(isset($_POST['upload']) && $_FILES['userfile']['size'] > 0){

                 $this->fileName = $_FILES['userfile']['name'];
                 $this->tmpName  = $_FILES['userfile']['tmp_name'];
                 $this->filesSize = $_FILES['userfile']['size'];
                 $this->fileType = $_FILES['userfile']['type'];

                 $this->fp      = fopen($this->tmpName, 'r');
                 $this->content = fread($this->fp, filesize($this->tmpName));
                 $this->content = addslashes($this->content);
                 fclose($this->fp);

                 if(!get_magic_quotes_gpc()){

                     $this->fileName = addslashes($this->fileName);

                    }

                 if ($this->mysqli->query("INSERT INTO upload_images (name, size, type, content ) ".
                      "VALUES ('$this->fileName', '$this->filesSize', '$this->fileType', '$this->content')")){

                         echo "Upload avvenuto &nbsp";

                    }else{

                         echo "Errore &nbsp" . $this->mysqli->error; 

                        }   
                }
            }           
    }

$form = new Check();
$form->checkImage();    

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:14:36.713

您在哪里定义要传递给 ACheckImage 类中的 __construct() 的 $content 和 $fp 变量？

如果您真的想为变量设置空值，请尝试更改：

```
<?php
abstract class ACheckImage implements ICheckImage {

     public $fileName;
     public $tmpName;
     public $filesSize;
     public $fileType;
     public $fp;
     public $conent;
     protected $mysqli; 

     public function __construct(){

       if (count($_FILES)>0) {
         $this->fileName = $_FILES['userfile']['name'];
         $this->tmpName  = $_FILES['userfile']['tmp_name'];
         $this->filesSize = $_FILES['userfile']['size'];
         $this->fileType = $_FILES['userfile']['type'];
         $this->content = '';
         $this->fp = '';
         $this->mysqli = new mysqli('localhost','root','root','test');
       }

     }

}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:13:07.920

您的问题之一是：

```
 public $conent; 
```

您将它（在第 23 行）称为`$this->content`，然后将其设置为等于未定义的局部变量`$content`

相同的问题`$this->fp`。那时在您的构造函数中，您还没有定义局部变量`$fp`是什么，那么 PHP 应该如何知道呢？也许您应该将它传递给构造函数？

另外，如果我没记错的话，如果`MAX_FILE_SIZE`违反了，那么服务器上将不存在该文件，并且`$_FILES`不会填充该数组。

# apache - 在一个 VPS 上运行两个域

> ID：14734713
> 
> 赞同：0
> 
> 时间：2013-02-06T17:04:42.793
> 
> 标签：apache, dns, hosting, vps

这是我的 httpd.conf 文件

```
NameVirtualHost *:80

<VirtualHost *:80>
DocumentRoot /var/www/joshhornby
ServerName www.joshhornby.co.uk
</VirtualHost>

<VirtualHost *:80>
DocumentRoot /var/www/designerschool
ServerAlias www.designer-school.com
</VirtualHost> 
```

如果您访问 joshhornby.co.uk，那么您会看到它会将您带到正确的位置，并且该站点可以毫无问题地加载。前往designer-school.com 不会加载正确的文件，而只会加载没有样式表的joshhornby.co.uk。

我哪里错了？两个域都指向同一个 DNS，并且该 DNS 在同一台服务器上运行。我正在尝试在 VPS 上运行两个域。我试过谷歌搜索，但没有任何效果

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:22:34.180

经过大量的跟踪和错误，我终于得到了这个工作

名称虚拟主机 *:80

```
<VirtualHost *:80>
ServerName joshhornby.com
ServerAlias joshhornby.co.uk
DocumentRoot /var/www/joshhornby
ServerName www.joshhornby.co.uk
</VirtualHost>

<VirtualHost *:80>
ServerName joshornby.com
ServerAlias designer-school.com
DocumentRoot /var/www/designerschool
ServerAlias www.designer-school.com
</VirtualHost> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:13:10.110

```
NameVirtualHost *:80

<VirtualHost *:80>
ServerName www.joshhornby.co.uk
ServerAlias joshhornby.co.uk
DocumentRoot /var/www/joshhornby
ServerName www.joshhornby.co.uk</pre>
<VirtualHost>

<VirtualHost *:80>
ServerName www.designer-school.com
ServerAlias designer-school.com
DocumentRoot /var/www/designerschool
ServerAlias www.designer-school.com
</VirtualHost> 
```

# javascript - paper.js + soundmanager 声音表示

> ID：14734715
> 
> 赞同：1
> 
> 时间：2013-02-06T17:04:48.843
> 
> 标签：javascript, animation, canvas, soundmanager2, paperjs

我想在声音管理器提供的画布数据上实时绘制`waveformData`，让它看起来像一条均衡器线，像 [http://paperjs.org/tutorials/animation/creating-animations/#moving-multiple-items](http://paperjs.org/tutorials/animation/creating-animations/#moving-multiple-items)一样平滑移动。问题是一切都被重绘了，看起来不太顺利。任何想法如何改进它？

`

```
 paper.install(window);
   var soundOutput = [];

   $(document).ready(function(){
   soundManager.url = 'swf/';
   soundManager.flashVersion = 9;
   soundManager.useHTML5Audio = true;

   soundManager.onready(function() {
var song = soundManager.createSound({
       id: 'song',
       url: '4353.mp3',
       useWaveformData: true,
});
song.play();
var i = 0;
function data() {

  if (!(i % 4)) {
    for (n=0; n<20; n++) {
        soundOutput[n] = song.waveformData.left[n];
    }
  }
  i++;
  window.webkitRequestAnimationFrame(data);

}
data();
   });

canvas = document.getElementById("scene");
canvas.width = 632;
canvas.height = 660;
paper.setup('scene');
view.size = [500, 500];
var amount = 20;
var height = 60;

var path = new Path();
path.style = {
    strokeColor: new GrayColor(0.2),
    strokeWidth: 30,
    strokeCap: 'square'
};

for (var i = 0; i <= amount; i++) {
    path.add(new Point(i/amount * 500, 50));
}

   path.selected = true;
view.onFrame = function(event) {
    for (var i = 0; i <= amount; i++) {
        var segment = path.segments[i];

        segment.point.y = soundOutput[i] * 1000;
    }

}
  view.draw();

})` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T04:27:19.770

您可以尝试降低帧速率：

```
setTimeout(function(){
  webkitRequestAnimationFrame(data)
}, 1000 / 20); // 20fps. 
```

# .net - 使用 .NET 中的嵌套表调用 Oracle 存储过程

> ID：14734723
> 
> 赞同：2
> 
> 时间：2013-02-06T17:05:09.827
> 
> 标签：.net, oracle, stored-procedures

给定下表：

```
create table egyen (
  id number not null, 
  tajszam varchar2(9),
  nev varchar2(10),
  primary key(id)
); 
```

以及以下软件包：

```
create or replace package pck_egyen is
  type egyentab is table of egyen%rowtype;
  procedure list(ret$ out egyentab);
end pck_egyen;
/
create or replace package body pck_egyen is
  procedure list(ret$ out egyentab) is
  begin
    ret$ := egyentab();
    for rec in (select * from egyen) loop
      ret$.extend;
      ret$(ret$.count) := rec;
    end loop;
  end;
end pck_egyen;
/ 
```

有人可以为我提供一个使用 ODP.NET 11g 的有效 .NET 代码，该代码可以调用此存储过程，而无需以任何方式更改表或类型或包？我不知道如何设置 OracleParameter 来支持 pck_egyen.egyentab 类型...

我以前没有使用过UDT，我试了一下，但它无法识别包中嵌入的类型。全局类型不支持 %rowtype。好像我被卡住了。最初我想返回 ref 游标，就像一个魅力，但不是通过 dblink。太多愚蠢的限制。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T14:43:41.947

这是一个有趣的问题，特别是因为需要同时使用 .NET 来跨 dblink 使用数据和存储过程。不跨 dblinks 使用游标的限制导致您使用 pl/sql 表，但您不能在 .NET 中轻松使用这些表（无需经历设置和维护全局对象的痛苦）。

因此，我建议使用带有输出表参数的参考游标函数和过程。您将能够轻松地从 .NET 调用引用游标函数（无需跨 dblink 进行选择），并且对于 dblink 数据库工作，使用相应的过程。例如：

```
create table test1 (
    col1 number,
    col2 varchar2(10),
    col3 date default sysdate not null
);
insert into test1(col1,col2) values (1,'A');
insert into test1(col1,col2) values (1,'X');
insert into test1(col1,col2) values (2,'B');

commit;

CREATE OR REPLACE package TEST_PKG as
  type t_test1_tab is table of test1%rowtype;
  -- weak ref cursor
  function get_test1_cur (i_num in number) return sys_refcursor;
  -- uses rowtype for table
  procedure get_test1_tab(i_num in number, o_tab out t_test1_tab);
end;

CREATE OR REPLACE package body TEST_PKG as
  function get_test1_cur (i_num in number) return sys_refcursor is
    l_cur sys_refcursor;
  begin
    open l_cur for select * from test1 where col1=i_num;
    return l_cur;
  end;

  procedure get_test1_tab(i_num in number, o_tab out t_test1_tab) is
    l_rec test1%rowtype;
    l_tab t_test1_tab := t_test1_tab();
    l_cur sys_refcursor;
  begin
    l_cur := get_test1_cur(i_num);
    loop
      fetch l_cur into l_rec;
      exit when l_cur%notfound;
      l_tab.extend;
      l_tab(l_tab.last) := l_rec;
    end loop;
    close l_cur;
    o_tab := l_tab;
  end;

end; 
```

将所需的任何逻辑放入 ref 游标函数中。该过程只是调用函数并创建表（使用行类型）。

使用跨 dblink 进行 db 调用的过程：

```
declare
  l_tab test_pkg.t_test1_tab@dblinkA;
begin
  test_pkg.get_test1_tab@dblinkA(1, l_tab);
  -- show count
  dbms_output.put_line('Table has ' || l_tab.count || ' rows.');
end; 
```

使用该函数进行 odp.net 调用。例如（代码片段）：

```
OracleConnection con = new OracleConnection(connStr);

// create the command object and set attributes
OracleCommand cmd = new OracleCommand("test_pkg.get_test1_cur", con);
cmd.CommandType = CommandType.StoredProcedure;
cmd.BindByName = false;

// create parameter object for the cursor
OracleParameter p_refcursor = new OracleParameter();
// create any input parameters to the function
OracleParameter p_num = new OracleParameter();

p_refcursor.OracleDbType = OracleDbType.RefCursor;
p_refcursor.Direction = ParameterDirection.ReturnValue;
cmd.Parameters.Add(p_refcursor);

// add any input parameters
p_num.OracleDbType = OracleDbType.Int32;
p_num.Direction = ParameterDirection.Input;
p_num.Value = 1;
cmd.Parameters.Add(p_num);

// create a data adapter to use with the data set
OracleDataAdapter da = new OracleDataAdapter(cmd);

// create the data set
DataSet ds = new DataSet();

// fill the data set
da.Fill(ds); 
```

这种方法应该易于维护，因为您不仅使用的是行类型，而且过程只是调用函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T10:57:10.973

一种方法是使用一些 PL/SQL 将表对象中的数据读取到 PL/SQL 关联数组中，每列一个，然后使用 ODP.NET 读取这些数据：

```
 private const string PlSqlBlock = @"
        DECLARE
          l_egyen_tab  pck_egyen.egyentab;
        BEGIN
          pck_egyen.list(l_egyen_tab);
          FOR i IN 1..l_egyen_tab.COUNT
          LOOP
            :ids(i) := l_egyen_tab(i).id;
            :tajszams(i) := l_egyen_tab(i).tajszam;
            :nevs(i) := l_egyen_tab(i).nev;
          END LOOP;
        END;";

    public static void ListEgyenTable(OracleConnection con)
    {
        using (var cmd = new OracleCommand(PlSqlBlock, con))
        {
            OracleParameter idParam = cmd.Parameters.Add("ids", OracleDbType.Decimal);
            OracleParameter tajszamParam = cmd.Parameters.Add("tajszams", OracleDbType.Varchar2);
            OracleParameter nevParam = cmd.Parameters.Add("nevs", OracleDbType.Varchar2);

            int arraySize = 1000;
            int[] varcharArrayBindSize = Enumerable.Repeat(4000, arraySize).ToArray();

            foreach (OracleParameter param in cmd.Parameters)
            {
                param.Direction = ParameterDirection.Output;
                param.CollectionType = OracleCollectionType.PLSQLAssociativeArray;
                param.Size = arraySize;
                if (param.OracleDbType == OracleDbType.Varchar2)
                {
                    param.ArrayBindSize = varcharArrayBindSize;
                }
            }

            cmd.ExecuteNonQuery();

            if (idParam.Value is OracleDecimal[] && tajszamParam.Value is OracleString[] && nevParam.Value is OracleString[])
            {
                List<decimal> ids = (idParam.Value as OracleDecimal[]).Select(dec => dec.Value).ToList();
                List<string> tajszams = (tajszamParam.Value as OracleString[]).Select(str => str.Value).ToList();
                List<string> nevs = (nevParam.Value as OracleString[]).Select(str => str.Value).ToList();

                for (int i = 0; i < ids.Count; ++i)
                {
                    Console.WriteLine("Got id {0}, tajszam {1}, nev {2}", ids[i], tajszams[i], nevs[i]);
                }
            }
            else
            {
                Console.WriteLine("Sorry, returned data not as expected :(");
            }
        }
    } 
```

这里唯一的并发症是`arraySize`。该值至少需要从存储过程返回的行数，如果太小，您将得到 ORA-06513 'PL/SQL: index for PL/SQL table out of range for host language数组的错误。

我创建了你的表和包，并在表中插入了以下测试数据：

```
SQL> select * from egyen;

        ID TAJSZAM   NEV
---------- --------- ----------
         1 abc       defg
         2 def       mnop
         3 ghi       qrstu
         4 jkl       vwxyz 
```

当我运行上面的 C# 代码时，我得到以下输出：

```
得到 id 1, tajszam abc, nev defg
得到 id 2，tajszam def，nev mnop
Got id 3, tajszam ghi, nev qrstu
得到 id 4, tajszam jkl, nev vwxyz

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-09T10:44:10.420

尝试类似的东西

```
OracleCommand cmd = new OracleCommand();
cmd.CommandText = "pck_egyen.list";
cmd.CommandType = CommandType.StoredProcedure;
cmd.Connection = con;
cmd.Parameters.Add("ret$", OracleDbType.RefCursor, DBNull.Value, ParameterDirection.Output);

cmd.ExecuteNonQuery();

// Read the result set
OracleRefCursor orarefcur = (OracleRefCursor) cmd.Parameters[0].Value;
OracleDataReader dr = orarefcur.GetDataReader();    
while (dr.Read())
{
    System.Console.WriteLine(dr["tajszam"]);
} 
```

# java - 不以单词开头，不包含另一个单词，但以第三个单词结尾的字符串的正则表达式

> ID：14734724
> 
> 赞同：1
> 
> 时间：2013-02-06T17:05:10.837
> 
> 标签：java, regex

我必须详细说明一个应该与具有以下限制的字符串匹配的正则表达式：

*   字符串**不能**以`foo`
*   字符串**不能**包含`/foo`
*   字符串**必须**以`bar`

我想出了以下模式，但我很确定有更优雅和/或有效的解决方案：

```
String match = "quxfoobar";
String notMatch = "qux/foobar";
String notMatch2 = "fooquxbar";
String pattern = "(?!foo)(?!.+/foo).*bar";
boolean m = match.matches(pattern); 
```

感谢您的投入。

*注意：请注意，我使用 Java 的`String.matches()`方法来匹配我的模式与我的候选字符串。*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:58:44.817

为什么是正则表达式？对于固定字符串，已经有内置函数，应该比正则表达式方法快得多。

```
if (!str.startsWith("foo") && str.endsWith("bar") && !str.contains("/foo")) {
    // Do your stuff here
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:13:01.190

这个也可以满足您的需求：

```
^(?!foo)(/(?!foo)|[^/])*bar$ 
```

*   `^(?!foo)`: 字符串的开头不能跟`foo`
*   `(/(?!foo)|[^/])*`: 要么 a`/`后面没有`foo`, 要么任何字符但 a `/`, *n*次
*   `bar$`: 字符串必须以`bar`

[演示](http://fiddle.re/3hku)

但是经过一些测试，你的比我的快。由于我看不到任何其他基于正则表达式的*相关解决方案，我猜你的最终是最**优雅和/或最有效*的解决方案`;)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:14:09.717

正则表达式越长越复杂，性能越差。对于这样的事情，将输入与三个正则表达式进行匹配应该会更好并且更容易理解。

```
String match = "quxfoobar";
Pattern start = Pattern.compile("^foo");
Pattern contain = Pattern.compile("\\/foo");
Pattern end = Pattern.compile("bar$");
boolean m = (
   !start.matcher(match).find() &&
   !contain.matcher(match).find() &&
   end.matcher(match).find()
); 
```

编辑：由于在这种情况下三个正则表达式是否会更快存在一些问题，我写了一个基准。当我运行它时，单个正则表达式（取自另一个答案）的速度是使用三个单独的正则表达式运行的三倍。

```
import java.util.regex.*;
import java.util.*;

public class Test {

    private static final Pattern START = Pattern.compile("^foo");
    private static final Pattern CONTAIN = Pattern.compile("\\/foo");
    private static final Pattern END = Pattern.compile("bar$");

    private static final Pattern ONEPATTERN = Pattern.compile("^(?!foo)(\\/(?!foo)|[^\\/])*bar$");

    public static void main(String[] args){
        String[] in = createInput();
        timeOnePattern(in);
        timeThreePatterns(in);
        System.exit(0);
    }

    public static String[] createInput(){
        String[] words = {"foo","bar","baz","biz","/foo"};
        Random rand = new Random();
        String[] in = new String[10000];
        for (int i=0; i<in.length; i++){
            StringBuilder sb = new StringBuilder();
            for (int j=0; j<4; j++){
                sb.append(words[rand.nextInt(words.length)]);
            }
            in[i] = sb.toString();
        }
        return in;
    }

    public static void timeThreePatterns(String[] in){
        long startTime = System.nanoTime();
        for (String s: in){
            boolean b = (!START.matcher(s).find() && !CONTAIN.matcher(s).find() && END.matcher(s).find());
        }
        long endTime = System.nanoTime();
        System.out.println("Three regular expressionv took " + (endTime - startTime) + " nanoseconds.");
    }

    public static void timeOnePattern(String[] in){
        long startTime = System.nanoTime();
        for (String s: in){
            ONEPATTERN.matcher(s).matches();
        }
        long endTime = System.nanoTime();
        System.out.println("Single regular expression took " + (endTime - startTime) + " nanoseconds.");
    }
} 
```

# java - 使用 Jackson API 和 JAXB 注释将 JSON 转换为 XML，反之亦然

> ID：14734741
> 
> 赞同：2
> 
> 时间：2013-02-06T17:05:58.410
> 
> 标签：java, xml, json, jaxb, jackson

我正在尝试编写一个可以分别采用 XML 或 JSON 输入和输出 JSON 或 XML 的代码。即，如果我给 XML，它应该返回 JSON，如果我给 JSON，它应该给 XML 输出。

有人告诉我，使用 Jackson API 和 JAXB Annotations 可以做到这一点。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-06T18:36:00.803

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

下面是一个示例，说明如何使用 MOXy 的 JSON 绑定来支持此用例。

**JAVA模型**

下面是一个使用 JAXB 元数据注释的示例域模型。相同的元数据将用于对象到 XML 和对象到 JSON 的转换。

***顾客***

```
import java.util.List;
import javax.xml.bind.annotation.*;

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Customer {

    private int id;

    private String firstName;

    @XmlElement(nillable=true)
    private String lastName;

    private List<PhoneNumber> phoneNumbers;

} 
```

***电话号码***

```
import javax.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
public class PhoneNumber {

    @XmlAttribute
    private String type;

    @XmlValue
    private String number;

} 
```

**XML 输入**

下面是我们将使用的 XML 输入。请注意如何在元素`xsi:nil`上使用属性`lastName`来指示`null`值。还要注意`phoneNumbers`元素如何具有`type`属性。

```
<?xml version="1.0" encoding="UTF-8"?>
<customer>
   <id>123</id>
   <firstName>Jane</firstName>
   <lastName xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
   <phoneNumbers type="work">555-1111</phoneNumbers>
</customer> 
```

**演示代码**

***jaxb.properties***

要将 MOXy 指定为您的 JAXB 提供程序，您需要包含一个`jaxb.properties`在与域模型相同的包中调用的文件，其中包含以下条目（请参阅：[http ://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as -你的.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html)）：

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

***演示***

以下演示代码会将 XML 转换为域模型，然后再转换回 JSON。

```
import java.io.File;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.MarshallerProperties;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Customer.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum14734741/input.xml");
        Customer customer = (Customer) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.setProperty(MarshallerProperties.MEDIA_TYPE, "application/json");
        marshaller.setProperty(MarshallerProperties.JSON_INCLUDE_ROOT, false);
        marshaller.marshal(customer, System.out);
    }

} 
```

**JSON 输出**

请注意键的`null`值如何`lastName`表示为正确的 JSON。另请注意，`type`键如何不包含任何与它对应的特殊指示符，它是 XML 表示中的 XML 属性。

```
{
   "id" : 123,
   "firstName" : "Jane",
   "lastName" : null,
   "phoneNumbers" : [ {
      "type" : "work",
      "value" : "555-1111"
   } ]
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-08T18:59:07.620

当然，但不要认为它是在 XML 和 JSON 之间进行转换——这几乎是错误的做法，会导致兼容性问题——而是将 Java 对象 (POJO) 转换为 JSON 和 XML 或从 JSON 和 XML 转换。您可以为此使用一两个工具：一种常见的组合是将 Jackson 用于 JSON，将 JAXB 用于 XML，以发挥各自的优势。

也可以使用单个工具；Blaise 解释了 JAXB 实现如何提供帮助。同样，您可以同时使用 Jackson：对于 XML 部分，您需要使用[Jackson XML module](https://github.com/FasterXML/jackson-dataformat-xml)。有了Jackson，你可以使用Jackson自己的注解（首选），也可以使用JAXB注解来实现兼容性；两者都适用于 XML 和 JSON 用例。

在 Jackson 中使用 XML 模块与默认 JSON 处理没有太大区别，除了您`XmlMapper`需要`ObjectMapper`. 如果从 JAX-RS（如 Jersey）使用它，您可以使用[Jackson JAX-RS XML provider](https://github.com/FasterXML/jackson-jaxrs-xml-provider)。

# javascript - JavaScript：根据特定属性检查对象数组是否没有重复项？

> ID：14734744
> 
> 赞同：1
> 
> 时间：2013-02-06T17:06:05.867
> 
> 标签：javascript, dojo

我有一个对象数组，一个对象看起来像这样：

```
{name: "object1", type: "event", props: {internalid: 1}}
{name: "object2", type: "event", props: {internalid: 1}} 
```

我想遍历这些对象的数组，并且我想创建一个没有重复的对象的新数组（对我来说，如果两个项目在属性中具有相同`internalId`的`props`属性，则它们是重复的）

我想知道从原始数组中获取“唯一”对象并根据`internalId`属性进入新数组的最佳和最有效的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:24:54.003

您可以使用 Underscore 或 Lo-Dash 中的[uniq](http://underscorejs.org/)方法[轻松](http://lodash.com/)[实现](http://underscorejs.org/#uniq)这一点。如果您的数组已经排序，他们会稍微优化一下。这两个库都有详细记录的代码，因此您可以随时查看他们解决问题的方法。

这是一个例子：

```
var objs = [{
    name: "object1",
    type: "event",
    props: {
        internalid: 1
    }
}, {
    name: "object2",
    type: "event",
    props: {
        internalid: 1
    }
}, {
    name: "object3",
    type: "event",
    props: {
        internalid: 2
    }
}];

var result = _.uniq(objs, false, function (item) {
    return item.props.internalid;
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:55:34.403

这是一种使用 Dojo`array`功能的方法。过滤器使用一个临时对象，其中包含您已经遇到的 id。

```
require(["dojo/_base/array"], function(array){

    var data = []; // load the data

    var _lookup = {};
    var uniqueArray = array.filter(data, function(item) {
        var key = item.props.internalid;
        if(_lookup[key] !== true) {
            _lookup[key] = true;
            return true;
        }
        return false;
    });
    delete _lookup;

    //use uniqueArray
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:12:12.623

您最好的方法可能是创建一个新的空数组并简单地遍历原始数组，如果新数组中尚不存在元素（基于您的唯一定义），则将它们添加到新数组中。我没有看到您的解决方案比这更简单。

# gis - osm2pgsql 在数据库中的投影是什么？

> ID：14734746
> 
> 赞同：0
> 
> 时间：2013-02-06T17:06:06.463
> 
> 标签：gis, latitude-longitude, openstreetmap

我想在 osm2pgsql 制作的数据库中搜索以呈现地图图块。我发现这张表保存了节点的纬度和经度。但这些数字似乎不是度数系统或度分秒。这是查找德黑兰的查询结果。（这个城市的真实值为 lat="35.6884243" lon="51.4179604" 但获取的值为 lat="426776659" 和 lon="573163530"）

```
 id            lat          lon            tags
----------------------------------------------------------
 600129599     426776659     573163530       (Null) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-11T11:51:49.790

正在使用的投影是 EPSG:900913。这是一个球形墨卡托投影，其单位为米。

[这](https://gist.github.com/springmeyer/871897)是一些转换为十进制度的代码。

您还应该[在此处](https://gis.stackexchange.com/questions/34276/whats-the-difference-between-epsg4326-and-epsg900913)查找有关所使用的常见投影的讨论。

# c++ - 声明一个模板结构的实例

> ID：14734749
> 
> 赞同：0
> 
> 时间：2013-02-06T17:06:15.040
> 
> 标签：c++, templates, struct

我有以下节点：

```
template <class T>
struct ListItem
{
    T value;
    ListItem<T> *next;
    ListItem<T> *prev;

    ListItem(T theVal)
    {
        this->value = theVal;
        this->next = NULL;
        this->prev = NULL;
    }
 }; 
```

我必须声明这个列表项的一个实例。我知道如何声明一个不是模板的结构实例，如下所示：

```
node* x = new node;
 x = head; (or whatever) 
```

现在我该怎么做？如果我遵循上述程序，那么我认为我应该执行以下操作：

```
ListItem<T>* temp = new ListItem<T>; 
```

但编译器给出的错误是上面没有匹配的函数，并且 ListItem 需要 1 个参数。快速帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:08:10.010

您必须选择一种类型作为您的模板参数，并将一个值传递给您的构造函数，因为没有默认值。例如，相当于您对非模板所做的事情是：

```
ListItem<double>* temp = new ListItem<double>(3.1416); 
```

但这不仅仅是创建一个实例。它正在创建一个具有动态分配的实例，并初始化一个指向其位置的指针。如何“创建实例”很简单

```
ListItem<double> temp(3.1416); 
```

不过要小心指向动态分配对象的原始指针。你真的应该在这里使用[智能指针](http://en.wikipedia.org/wiki/Smart_pointer)。

请注意，您也可以为您的类提供默认构造函数：

```
template <class T>
struct ListItem
{
    T value;
    ListItem<T> *next;
    ListItem<T> *prev;

    ListItem() : value(), next(NULL), prev(NULL) {}
    ListItem(T theVal) : value(theVal), next(NULL), prev(NULL) {}
 }; 
```

请注意，我已将您的原始构造函数更改为使用初始化列表，因为这是执行此操作的首选方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:11:23.227

您需要为构造函数提供一个值！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T17:07:57.080

在表单中构建项目：

```
T* t = new T; 
```

使用`T`. 在您的情况下，您没有提供默认构造函数，并明确禁止编译器生成默认构造函数，因为您有一个带值的构造函数。

使用该构造函数采用以下形式：

```
T* t = new T(U); 
```

要使用代码中的具体示例：

```
// This will use the default constructor of ListItem<T>, which you _didn't_ provide
ListItem<T>* temp = new ListItem<T>;

// This will use single value constructor ListItem<int>(int), which you did provide.
ListItem<int>* temp = new ListItem<int>(7);

// The generic version would then be -- where T is actually default constructable
ListItem<T>* temp = new ListItem<T>(T()); 
```

例如，将值添加到类型的链表`int`需要您知道要添加的值：

```
int value_to_add = 5;
ListItem<int>* temp = new ListItem<int>(value_to_add); 
```

如果您的问题是关于如何分配“头”节点，这通常是指向列表中第一项的指针：

```
// pointer, does _not_ point to an instantiated value (yet)
ListItem<int>* head = nullptr;

// in the add function:
ListItem<int>* value = new ListItem<int>(value_to_add);

// if the list was empty...
if(nullptr == head)
   head = value;   // head now points to the first value 
```

# python - 如何从 Pylons 中的 URL 获取具有相同名称的多个参数？

> ID：14734750
> 
> 赞同：7
> 
> 时间：2013-02-06T17:06:21.643
> 
> 标签：python, url, parameters, pylons

所以不幸的是，我发现自己需要修改现有的 Pylons 应用程序来处理提供多个同名参数的 URL。类似于以下内容... domain:port/action?c=1&v=3&c=4

通常以这种方式访问​​参数...

```
from pylons import request
c = request.params.get("c")
#or
c = request.params["c"] 
```

这将在任何一种情况下都返回“4”作为值，因为在这些情况下忽略除最后一个值之外的所有值似乎是标准行为。我真正需要的是能够同时访问两者。我尝试打印出 request.params 并得到这样的东西......

```
NestedMultiDict([(u'c', u'1'),(u'v', u'3'),(u'c', u'4')]) 
```

我还没有找到一种方法来索引它，或者访问 c 的第一个值。

我发现了一个与此问题相关的[类似](https://stackoverflow.com/questions/353379/how-to-get-multiple-parameters-with-same-name-from-a-url-in-php)问题，但使用 PHP 解决了：

这些方面的东西对我来说效果很好，但也许一些 Python 代码适合 Pylons。有没有人处理过这样的事情？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-06T17:15:03.410

从文档 - [http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/glossary.html#term-multidict](http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/glossary.html#term-multidict)：

> multidict 一个有序字典，每个键可以有多个值。将方法 getall、getone、mixed、add 和 dict_of_lists 添加到普通字典接口。请参阅 Multidict 和 pyramid.interfaces.IMultiDict。

所以只需调用：

```
request.params.getall('c') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:28:30.103

作为练习，[另一个问题](https://stackoverflow.com/a/353437/1290420)中 PHP 的 Python 渲染（还包括一个虚拟参数来说明对 url 解码的需要）：

```
from urlparse import urlparse
from urllib import unquote

url = 'http://www.example.com/action?c=1&v=3&c=4&d=%3A%24%23%40%3D%3F%25%5EQ%5E%24'

url = urlparse(url)

params = url.query.split('&')
params = [ tuple(p.split('=')) for p in params ]
params = [ [unquote(p[0]), unquote(p[1])] for p in params ]

print params

# [['c', '1'], ['v', '3'], ['c', '4'], ['d', ':$#@=?%^Q^$']] 
```

# sql - 提高排序性能的索引？

> ID：14734752
> 
> 赞同：4
> 
> 时间：2013-02-06T17:06:33.903
> 
> 标签：sql, postgresql

我有一个相当复杂的查询，其中包括一个`ORDER BY`和一个`LIMIT`子句。当`ORDER BY`使用主键时，查询时间不到 5 毫秒。但是，如果我将查询更改`ORDER BY`为由不同的列（类型`FLOAT`）完成，响应时间会膨胀到超过 50 秒（高四个数量级！）。

现在，我认为问题是按主键排序的查询执行索引扫描，而按浮点列排序的查询执行顺序扫描并需要在最后进行排序。

我认为只需在 float 列上添加索引就足以让 Postgresql 以更智能的方式计划此查询。显然我错了。我可能错过了什么？

**编辑：**我`EXPLAIN ANALYZE`在发布问题之前确实运行过。因此，我的假设不仅仅是一个疯狂的猜测；但是，由于`EXPLAIN ANALYZE`运行的输出超过 30 行，因此尚不清楚为什么一个查询使用索引而另一个查询必须对所有行进行排序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T17:13:07.097

1.  对查询运行解释分析 - 这样您就不必猜测会发生什么。
2.  要优化查询，您通常必须阅读解释分析输出、查询，然后找出最佳行动方案。有时 - 它正在添加索引，有时 - 重写查询。但无法判断哪个最适合您的情况，因为我们看不到解释或查询。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:13:35.490

在没有看到查询的情况下很难破译正在发生的事情。我的猜测是查询计划能够基于具有主键的表进行连接，从而使数据保持正确的顺序。然后查询计划基本上是获取一行，在其他表中查找值，对它们进行处理，然后按顺序返回值。处理尽可能地进行`limit`。

当您将其替换为 中的另一列时`order by`，必须处理*所有行。*这些被排序并返回。它可能是基础表的大小，也可能是结果集的大小，导致处理时间更长。但是，根本原因是需要生成所有行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:10:57.817

对于返回许多行的查询，数据库使用非覆盖索引是不常见的。查表（从索引到表数据）的成本太高。将改为使用表扫描。

例如，

```
select name from people where name > 'N' order by birthdate 
```

数据库会使用索引`(birthday)`吗？从好的方面来说，行将以正确的顺序返回。不利的一面是，每一行都需要对该`name`列进行表查找。第二个要贵得多，因此不会使用索引。

上的索引`(birthday, name)`是不同的。它包括名称，因此不需要查找表。数据库可以使用索引以正确的顺序快速返回行。

包含查询所需的所有列的索引称为覆盖索引。确保您的索引包含查询使用的所有列，然后重试。

# ruby - 这个事件机器代码是如何工作的

> ID：14734754
> 
> 赞同：0
> 
> 时间：2013-02-06T17:06:36.640
> 
> 标签：ruby, eventmachine

`d`在下面的代码中，我从 redis 队列中读取数据，并在 redis 操作完成时触发本地可延迟变量的回调。

它工作正常，但我预计会得到一个错误，因为当方法`f`返回时变量`d`超出范围。或者是吗？

为什么这行得通？是因为使用`d`创建闭包的块并且这些闭包保持`d`活动状态吗？

```
require 'em-hiredis'

def f
  d = EM::DefaultDeferrable.new

  EM::Hiredis.connect.blpop('abcdef', 5).
    callback {|x| d.succeed x}.
    errback {|e| d.fail e}

  d.
    callback {|x| puts "value=#{x}"}.
    errback {|e| puts "error #{e}"}

  return nil
end

EM.run {f} 
```

编辑：请注意 EM::Hiredis 实例也是本地的，并且块附加到它。当 f 返回时，这些块不应该与 redis 连接一起消失吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:40:31.967

Ruby 块很有趣，因为它们包含对定义它们的范围的绑定。

这意味着您的 deferable 绑定在块内并且可用于块，即使该块在其他地方/稍后执行。

# javascript - android 2.3.5 上的 window.innerHeight 问题

> ID：14734757
> 
> 赞同：3
> 
> 时间：2013-02-06T17:06:50.973
> 
> 标签：javascript, android

首先：是的，我使用了谷歌，我什至进入了谷歌搜索结果的阴暗面。

在 Android 2.3.5 window.innerHeight 上使用 Android Nexus S 和默认浏览器会报告错误的值。

它报告 window.height 的值（应该是 452）减去键盘高度（207）。这特别发生在重新加载后（触摸地址栏并单击“开始”）。

此示例代码返回错误的结果：

```
$(function() {
    alert(window.innerHeight); // 245

    setTimeout(function() {
        alert(window.innerHeight); // 245
    }, 1000);
}); 
```

以下都返回错误的结果：

```
$(body).height(); // (way) too high
screen.height; // 245
window.outerHeight; // 600+
document.body.offsetHeight; //646
screen.height / window.devicePixelRatio - window.screenTop; //125.xxx; 
```

window.onResize 事件不会触发，但是，将其旋转两次确实可以解决高度问题（但我不能告诉我的客户这样做）。

我弄乱了视口。这是我目前的：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1, user-scalable=no target-densityDpi=160" /> 
```

我希望我错过了互联网上的一个利基角落，在那里可以使用 android 和 window.innerHeight 的圣杯（并且可以免费使用；）

因此，如果您知道任何解决方案，或者过去修复过类似问题的任何东西，请分享:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T22:27:01.363

我看到与您完全相同的问题，并且修复完全相同-旋转两次。

除此之外 - 等待不同的 Android 版本。

# ios - 数据保护/NSFileProtectionComplete - 通过 entitlements.plist 成功支持？

> ID：14734758
> 
> 赞同：9
> 
> 时间：2013-02-06T17:06:51.967
> 
> 标签：ios, entitlements, data-protection

我正在寻找加密应用程序中的用户数据，NSFileProtection 机制看起来非常适合这个。

这个[SO Question/Answer 线程](https://stackoverflow.com/questions/10004299/file-system-encryption-for-ios)向我指出了 WWDC 2011 Video [Securing iOS Apps](https://developer.apple.com/videos/wwdc/2011/?id=208) ，它给出了通过权利在应用程序中设置数据保护的“好得令人难以置信”的提示（从 33 分钟开始）。

所以，我为我的 iOS 5.x+ 应用程序尝试了这个，并遇到了它抱怨[Invalid Entitlements](https://stackoverflow.com/questions/9359596/the-executable-was-signed-with-invalid-entitlements-0xe8008016)的问题。

我已经通过 iOS 配置门户为特定应用程序配置了数据保护，并更新了我的应用程序配置，所以理论上我应该都设置好了，但我仍然得到错误。

如果我从权利中删除特定的 FileProtectionComplete 设置，应用程序将在没有无效权利错误的情况下运行。

在对此进行调查时，我还看到一些人的应用程序[被拒绝](https://stackoverflow.com/questions/12301161/invalid-code-signing-entitlements-data-protection-key-not-supported?rq=1)（在他们上传二进制文件时），因为这不受支持（或已弃用？）。请注意，我专门询问的是数据保护，而不是存折。

在这个阶段，我在想，也许真的是，“好得令人难以置信”。所以，我即将放弃这个神奇的权利标志，而是使用编程方法，将 NSFileProtectionComplete 添加为写入选项。

但是，在我这样做之前，任何人都可以确认他们已经能够通过使用权利标志成功添加数据保护吗？谢谢。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-06T21:59:20.427

`NSFileProtectionComplete`不再通过权利支持。相反，它是在配置文件中指定的。

我遇到了与您完全相同的问题。当我尝试在设备上构建和运行时，我收到以下警报：

> **可执行文件已使用无效权利进行签名。**
> 
> 您的应用程序的代码签名权利文件中指定的权利与您的配置文件中指定的权利不匹配。
> 
> (0xE8008016)。

在控制台中，它表现为以下错误：

> 5 月 6 日 16:18:13 XXXXX 已安装 [54]：权利“DataProtectionClass”具有配置文件不允许的值

最终，我找到了正确的设置。您必须登录到开发人员门户并在与您正在使用的配置文件关联的应用程序 ID 上启用数据保护。见下图：

![在此处输入图像描述](../Images/5a5af11de35ce255c26cdaf7473f5fb2.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T06:28:58.270

我已经尝试使用权利进行数据保护，并且效果很好。诀窍是确保 Xcode 项目中的权利文件条目与配置文件中的相同。

具体来说，权利文件和配置文件中的以下 2 个设置应该相同：-“com.apple.developer.default-data-protection”-我已将其设置为 NSFileProtectionComplete。“应用程序标识符” - 我没有在标识符中使用通配符，尽管我认为它应该也可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-02T19:17:05.647

使用通配符作为配置文件 ID（即 my.company.app.*）对我不起作用，因此必须创建一个新的完全合格的。它适用于我的 Entitlements.plist，如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" 
"http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>com.apple.developer.default-data-protection</key>
    <string>NSFileProtectionComplete</string>
    <key>get-task-allow</key>
    <false/>
</dict>
</plist> 
```

我的个人资料部分看起来像这样：....

```
<dict>
    <key>application-identifier</key>
    <string>xxx.my.company.app</string>
    <key>com.apple.developer.default-data-protection</key>
    <string>NSFileProtectionComplete</string>
    <key>get-task-allow</key>
    <false/>
    <key>keychain-access-groups</key>
    <array>
        <string>xxxxxxxx</string>
    </array>
</dict> 
```

……

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-14T09:04:17.880

要启用数据保护，请在 Xcode 中目标的 Capabilities 窗格中将其打开。

详细信息：[应用分发指南：添加功能](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppDistributionGuide/AddingCapabilities/AddingCapabilities.html)

# matlab - 用于符号求解的 Matlab 语法

> ID：14734765
> 
> 赞同：1
> 
> 时间：2013-02-06T17:07:21.870
> 
> 标签：matlab, symbolic-math

我有一个符号方程方程

`i = 1:n (i=1...n)`它采用随机值。

G_i = B_i + C_i * D_i 并且我有 B_i、G_i C_i 和 D_i 等于一些约束。

我必须通过matlab简化这样的方程。

我使用“符号”来定义每个符号，但我不知道如何定义“i”索引。

另外，我的第二个问题是如果我想将其更改为求和格式（symsum），其中 i=1...n 我如何编写代码以简化给定的一些约束。任何例子都对我理解有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:10:47.070

您要做的是创建一个符号值数组：[Matlab 文档](http://www.mathworks.com/help/symbolic/sym.html)展示了如何为 A 执行此操作，剩下的交给您。

```
A = sym('A',dim) 
```

然后你可以做类似的事情：

```
G(i)=b(i)+c(i)*d(i) 
```

# qt - QToolBar 的菜单延迟

> ID：14734767
> 
> 赞同：0
> 
> 时间：2013-02-06T17:07:27.680
> 
> 标签：qt

通过制作 QAction 并向其添加 QMenu，我在 QToolBar 上有一个菜单。当您单击图标时，如何消除菜单出现之前的延迟？

```
QToolBar *myToolBar = new QToolBar(this);
QAction *myAction = new QAction(helloIcon, tr("Hello"), this);
myToolBar->addAction(myAction);

helloMenu = new QMenu(this);
QAction *actionWorld = helloMenu->addAction(tr("World"));
QAction *actionUniverse = helloMenu->addAction(tr("Universe"));
myAction->setMenu(helloMenu); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-08T14:17:44.083

正确的方法是自己在工具栏中插入一个QToolButton而不是QAction。QToolButton 类有一个 popupMode 属性，您可以在其中设置所需的模式（延迟、即时弹出、菜单）。

这是一个工作示例：

```
QToolBar *myToolBar = new QToolBar(this);
QToolButton *myButton = new QToolButton();

QMenu *helloMenu = new QMenu(this);
QAction *actionWorld = helloMenu->addAction(tr("World"));
QAction *actionUniverse = helloMenu->addAction(tr("Universe"));

//set popup mode to InstantPopup so there will be no delay
myButton->setPopupMode(QToolButton::InstantPopup);
myButton->setMenu(helloMenu);
myButton->setIcon(helloIcon);
myButton->setText(tr("Hello"));

myToolBar->addWidget(myButton); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-12T15:19:55.107

这应该会有所帮助，但我不知道这是否是最好的解决方案：

```
#ifdef OS_WIN
#include <QWindowsStyle>

class FixPopupDelayWinStyle : public QWindowsStyle
{
public:
    int styleHint(StyleHint hint, const QStyleOption* opt = 0, const QWidget* widget = 0, QStyleHintReturn* returnData = 0 ) const
    {
        if (hint == QStyle::SH_ToolButton_PopupDelay)
            return 0;
        return QWindowsStyle::styleHint(hint, opt, widget, returnData);
    }
};
#endif

#ifdef OS_WIN
_toolBar_contains_action_with_Menu->setStyle(new FixPopupDelayWinStyle);
#endif 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T21:06:19.000

这是实现它的一种方法，以便在打开菜单时没有延迟：

主文件

```
#include "widget.h"
#include <QApplication>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    Widget w;
    w.show();

    return a.exec();
} 
```

小部件.h

```
#ifndef WIDGET_H
#define WIDGET_H

#include <QWidget>
#include <QMenu>
#include <QToolBar>

class Widget : public QWidget
{
    Q_OBJECT
public:
    explicit Widget(QWidget *parent = 0);

signals:

public slots:
    void on_myAction();
private:
    QMenu * helloMenu;
    QToolBar *myToolBar;
};

#endif // WIDGET_H 
```

小部件.cpp

```
#include "widget.h"
#include <QAction>
#include <QMenu>
#include <QWidget>

Widget::Widget(QWidget *parent) :
    QWidget(parent)
{
    myToolBar = new QToolBar(this);
    QAction *myAction = new QAction(tr("Hello"), this);
    myToolBar->addAction(myAction);

    helloMenu = new QMenu(this);
    QAction *actionWorld = helloMenu->addAction(tr("World"));
    QAction *actionUniverse = helloMenu->addAction(tr("Universe"));

    myAction->setMenu(helloMenu);

    QObject::connect(myAction, SIGNAL(triggered()), this, SLOT(on_myAction()));
}

void Widget::on_myAction()
{
    helloMenu->popup(myToolBar->mapToGlobal(myToolBar->geometry().bottomLeft()));
} 
```

* * *

## 使用 PopUp 的注意事项

在查看 的文档时[`QMenu::popUp()`](http://doc-snapshot.qt-project.org/4.8/qmenu.html#popup)，它指的是在检查几何之前设置 sizeHint。

> 使用 exec() 或 popup() 定位菜单时，请记住您不能依赖菜单的当前 size()。出于性能原因，菜单仅在必要时调整其大小，因此在许多情况下，节目前后的大小是不同的。相反，使用 sizeHint() 根据菜单的当前内容计算适当的大小。

因此，如果您有一个非常复杂的菜单，这可能会有所帮助：

`sizeHint`您应该在显示之前尝试计算；可能在您上面的代码之后不久。这可能会减少稍后显示菜单的时间。

```
helloMenu->sizeHint();

// or you can try
qDebug() << helloMenu->sizeHint(); 
```

如果这似乎没有帮助，您也可以尝试调用`adjustSize()`以`QMenu`查看它是否会更早地执行任何计算。

希望有帮助。

# jquery - 使用 jquery 填充可观察数组

> ID：14734768
> 
> 赞同：0
> 
> 时间：2013-02-06T17:07:27.677
> 
> 标签：jquery, knockout.js

我正在尝试理解淘汰赛语法并提出以下问题。

如果我有以下视图模型

```
var anotherObservableArray = ko.observableArray([
    { name: "Bungle", type: "Bear" },
    { name: "George", type: "Hippo" },
    { name: "Zippy", type: "Unknown" }
]); 
```

数组应该是空的，并且不包含上面的硬编码值。

我想用这段代码使用 jquery 填充它

```
$.getJSON('api/market', self.markets); 
```

我该怎么做，这个 getJSON 代码应该去哪里？谁能帮我举个例子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:18:52.093

您可以查看[文档](http://knockoutjs.com/documentation/json-data.html)

但基本上它应该是这样的

```
$.getJSON("/some/url", function(data) { 
    anotherObservableArray(data);
}) 
```

假设数据是一个 json 数组，否则将 observable 设置为类似`data.arrayProperty`或任何数组存储为

# ruby-on-rails - HAML 的语法错误

> ID：14734771
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:07:31.303
> 
> 标签：ruby-on-rails, haml

```
 header.clearfix{:role => "banner"}
      %h1.logo
        %span.company> Cerner
        Care
      %h2.application-name Welcome to the BigData application suite!
      %ul.button-bar
        %li
          %a{:href => "Logout"} Log Out
        %li
          %a{:href => "http://www.google.com", :target => "_blank"} Help
      %span.username 
      -unless current_user.nil?  
      #{current_user.display_name}
    %header.context.clearfix{:role => "banner"}
   %nav.navigation-bar.clearfix{:role => "navigation"}
  %h3.reader-details Account Management Tools
  %a.home{:href => root_path, :role => "link", :title => "Home"}Home
  %em
  %a{:href => "dsonboarding/index", :role => "link"} Data Source Onboarding
  %a{:href => "otherapp/index", :role => "link"} Some Other Application 
```

我想在显示用户名之前验证用户名是否为空，而 haml 给我上述代码的语法错误。如果我做错了什么，请告诉我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:11:57.250

为了呈现 ruby​​ 代码的输出，您需要使用“=”。

```
-unless current_user.nil?  
  =current_user.display_name 
```

除非异常发生在不同的行上。

我发现他们的[教程](http://haml.info/tutorial.html)很有帮助。

# php - actionscript3 没有得到 php 的响应

> ID：14734773
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:07:33.467
> 
> 标签：php, actionscript-3

我只是在做一个测试，但我什至无法让测试工作。我只想运行一个将日期返回到 flash 的 php，但它会返回整个代码。我不知道我做错了什么

这是我的 as3 代码：

```
import flash.net.URLLoader;
import flash.net.URLRequest;
import flash.events.Event;
import flash.net.URLLoaderDataFormat;
import flash.net.URLRequestMethod;

var ldr:URLLoader = new URLLoader()
ldr.dataFormat = URLLoaderDataFormat.BINARY;
ldr.addEventListener(Event.COMPLETE, onLoaded);
var req:URLRequest = new URLRequest("config_flash.php");
req.method = URLRequestMethod.POST;
ldr.load(req);

function onLoaded(evt:Event){
    trace(evt.target.data)
} 
```

我还尝试使用 URLLoaderDataFormat.TEXT 和 URLLoaderDataFormat.VARIABLES 我也尝试使用 URLRequestMethod.GET

现在的php：

```
<?php
    print "&serverDate=".date(j); 
?> 
```

无论我尝试什么，我唯一的输出就是代码本身：

```
<?php
    print "&serverDate=".date(j); 
?> 
```

有人可以看到我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:38:13.207

**将您的代码更改为以下内容**

```
var ldr:URLLoader = new URLLoader()
ldr.dataFormat = URLLoaderDataFormat.BINARY;
ldr.addEventListener(Event.COMPLETE, onLoaded);
var req:URLRequest = new URLRequest("http://localhost/flashtests/config_flash.php");
req.method = URLRequestMethod.POST;
ldr.load(req);

function onLoaded(evt:Event){
    trace(evt.target.data)
} 
```

关键是，您需要启用 Mac / Linux 机器 HTTP WebServer，并设置 localhost 所在的目录。

***这是一篇用于在Mac***上查找 localhost 的 SO 文章，根据版本，您的 Windows 机器有几篇文章。

[Mac 或 Mac OS X 中的 localhost 文件夹在哪里？](https://stackoverflow.com/questions/5365055/where-is-localhost-folder-located-in-macbook)

cd Library/WebServer/Documents/ 在 Mac 上，PHP 是默认安装的，很可能位于

```
/usr/lib/php 
```

**在命令行中测试您的 php 脚本以确保**

```
php http://localhost/flashtests/config_flash.php 
```

现在返回并运行 Flash 文档并运行它。**如果您的http 服务器已启用**并且机器上**安装了 php，则**应该调用您的 onLoadedEvent 。

# loops - Exchange 2010 将邮箱批量导出到 .pst

> ID：14734775
> 
> 赞同：0
> 
> 时间：2013-02-06T17:07:36.220
> 
> 标签：loops, export, exchange-server-2010, pst

我有一个 Exchange 2010 环境，在 6 个数据库中拥有大约 1000 个用户。它们都启用了存储在单独数据库中的存档。

我有获取数据库的备份软件，但我想通过直接从 Exchange 导出邮箱的 .pst 来补充这一点。我想获取给定数据库中的所有用户并导出到 .pst。我的命令如下所示：

```
foreach ($i in (Get-Mailbox -database Accounting)) {
    New-MailboxExportRequest -Mailbox $i -FilePath "\\server\D$\PSTBackup\test\Accounting\$($i.Alias).pst" -baditemlimit 50 -acceptlargedataloss
}

```

这样做的问题是它一次将它们全部导出（杀死我们的服务器资源），其中一半失败，因为一次运行太多。我想要一个脚本来一次备份大约 20 个邮箱。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:19:11.923

基本上你会想要创建一个新变量来保存结果 `Get-Mailbox -database Accounting)`

然后，您可以使用该变量的计数百分比或特定数字以编程方式确定批号。

`$myEmailBoxes = Get-Mailbox -database Accounting`

`$myEmailBoxes.count`应该给你列表中总共有多少个邮箱。不过，这可能不是 exchange powershell 的确切语法。在您进行测试时，您可能希望`Echo`将结果输出到输出中，以便您知道自己得到了预期的结果。

要批量处理事务，请使用“for”循环而不是 for each，并将其设置为您要批量处理的数量。

它看起来像下面这样：

```
$allMailboxes = Get-Mailbox -database Adjunct
$batchSize = 2
$currentBatchIndex = 0
$currentBatchMailboxes
# Call the function to start the process
batchMailboxes

function batchMailboxes {
                for (i = $currentBatchIndex; i < $currentBatchIndex + $batchSize; i++)
                {
                                $currentBatchMailboxes += $allMailboxes[i]
                                $currentBatchIndex++
                }

                exportBatchedMailboxes($currentBatchMailboxes)
                $batchStatus = getBatchedMailboxStatus($currentBatchMailboxes)

                if ($batchStatus == false) {
                                #Execute timer to get getBatchedMailboxStatus($currentBatchMailboxes)
                }
                else {
                                if ($currentBatchIndex < $allMailboxes.count - 1) {
                                                batchMailboxes
                                }
                }
}

function exportBatchedMailboxes ($exportMailboxes)
{
                foreach ($i in $exportMailboxes) {
                                New-MailboxExportRequest -Mailbox $i -FilePath "backuplocation\Adjunct\$($i.Alias).pst" -baditemlimit 50 -acceptlargedataloss
                }
}

function getBatchedMailboxStatus ($batch)
{
                # command for checking status needs to go here using a foreach loop
} 
```

这是完美运行的脚本的完整实现[http://blog.bluepegasusinc.com/index.php/batch-export-exchange-2010-mailbox-to-pst/](http://blog.bluepegasusinc.com/index.php/batch-export-exchange-2010-mailbox-to-pst/)

# xsd - 注册基于用户控件的表单 UI 控件 - 命名空间

> ID：14734785
> 
> 赞同：0
> 
> 时间：2013-02-06T17:08:04.637
> 
> 标签：xsd, c1-cms

标题为“注册基于用户控件的表单 UI 控件”的文档[http://docs.composite.net/Console/CreatingFormControls](http://docs.composite.net/Console/CreatingFormControls)说“您必须首先注册一个对您的组织私有的 XML 命名空间”，但没有解释如何。

所以我的问题是如何创建自己的命名空间？我是要创建一个 xml 架构还是可以 Composite-C1 导出基于全局数据类型的命名空间？任何帮助都会很棒。从未创建过 xml 模式（假设这是必需的）。

我已经创建了我的 asp 网络控件并将其添加到我的 c1 控制台，但是当我尝试添加新的新数据项时，它会产生错误：
ConfigurationErrorsException：找不到名称的配置

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T19:31:10.610

您可以通过分配一个 URI（在您控制的 URI 空间的一部分中）作为命名空间名称来创建 XML 命名空间，然后以适当的方式使用该命名空间名称，通常作为元素、属性的限定名称的一部分，以及您定义的其他对象。（如果这听起来含糊不清，那是因为它是。）

命名空间的功能（我在这里专门说的是 XML 命名空间，但我所说的大部分内容适用于人们称之为命名空间的其他东西）是为了防止不同人分配的名称之间的冲突。方法是说“您在命名空间中创建名称，我将在我的命名空间中创建名称，并且由于它们位于不同的命名空间中，因此我们的名称永远不会发生冲突。” 当然，只有当您遵循仅在您控制的 URI 空间部分中创建名称空间的规则（几乎从未明确说明，尽管它绝对是整个想法的核心）时，才能保证名称空间不同。您可以通过拥有一个域名，或通过拥有您的雇主拥有的域中 URI 路径的树结构的一部分，或通过其他方式来控制部分 URI 空间。

因此，创建名称空间的关键操作是识别名称并将其专用于用作名称空间名称的功能的抽象操作。如果您拥有自己的域名，这只是您必须做出的决定；如果您共享一个域，您可能需要在某处写下一些内容，这样您的同事就不会意外地将相同的 URI 声明为命名空间名称。（当然，将命名空间的一些文档放在有问题的 URI 中是一种很好的做法，但是没有老大哥来检查 Web 中的每个人都这样做。）

一旦您选择了命名空间名称并在您的组织中完成了防止组织内部冲突的任何操作，您引用的文档会告诉您必须在哪里写什么来告诉特定系统的注册表有关该名称的信息。主要是编辑一些配置文件并告诉他们你的小部件在哪里。我没有看到对 XSD 模式文档的任何要求（但我略读了很多）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T09:28:14.560

OK设法解决了这个问题。

我认为我需要一些 xml 命名空间的地方不正确。我所需要的只是一个空的命名空间引用。该错误与控件名称有关，与命名空间无关。

但是，我的问题确实与一般的命名空间 URI 有关，我相信 @CM Sperberg-McQuee 回答得很好。

# testing - Incisive Formal Verifier 安装 64 位

> ID：14734788
> 
> 赞同：2
> 
> 时间：2013-02-06T17:08:09.380
> 
> 标签：testing, verilog, installation-package, formal-verification

你知道我是否可以在 64 位模式下运行 Cadence Incisive Formal Verifier 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:21:38.740

这取决于您的版本，但对我来说：

```
$ ifv -help | grep 64
17:     +64bit                            Runs IFV in 64 bit mode 
```

启动它：

```
$ ifv temp.v
ifv: 10.20-s100:

$ ifv +64bit temp.v
ifv(64): 10.20-s100: //<-64 bit Version

setenv CDS_AUTO_64BIT
$ ifv temp.v
ifv: 10.20-s100: 
```

CDS_AUTO_64BIT 对我选的版本没有影响。

# github - GitHub，为未知后缀定义语言？

> ID：14734790
> 
> 赞同：1
> 
> 时间：2013-02-06T17:08:10.963
> 
> 标签：github, github-linguist

我有一个存储库，其中包含 Python 源代码，但文件后缀为`*.pyp`. 有没有办法将它“分配”给 Python 语言？（显示在标签、语法高亮等中）

我以为我在`.gitattributes`文件中看到了类似的东西..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T00:46:07.323

对于带有[**Shebang**](http://wikipedia.org/wiki/Shebang_%28Unix%29)的文件，在确定语言时会考虑 Shebang，但似乎与其他 [**标记**](http://github.com/github/linguist/blob/master/lib/linguist/samples.json)的权重相当。这似乎是一个很大的错误，因为 Shebang 应该明确定义文件的语言。这可能会导致突出显示[**问题**](http://github.com/github/linguist/issues/281)。

作为一种解决方法，您可以以注释的形式添加虚拟标记以“倾斜”以支持正确的语言。这是实验性的，但我[**很幸运**](http://github.com/svnpenn/dotfiles/blob/master/.cygwin#l2)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-13T07:55:25.493

> 我以为我在`.gitattributes`文件中看到了类似的东西..

是的，这可以使用[Linguist overrides](https://github.com/github/linguist#overrides)。你会想要：

```
*.pyp linguist-language=Python 
```

但是，[自 2014 年 6 月](https://github.com/github/linguist/pull/1258)（在您的问题日期之后）`.pyp`被语言学家认可。

# c# - 模板错误的泛型

> ID：14734791
> 
> 赞同：3
> 
> 时间：2013-02-06T17:08:14.180
> 
> 标签：c#, generics

我正在尝试制作模板类列表，将基类传递给模板。然而，这似乎是不允许的。有没有办法绕过这个限制，或者更恰当地重组我的代码？

这是一个抽象的例子：

```
using System;
using System.Collections.Generic;

namespace TempInherit
{
    abstract class Shape{}

    class Triangle : Shape{}
    class Square : Shape{}

    class ShapeHolder<T>{}

    class MainClass
    {
        public static void Main(string[] args)
        {
            // list of base class, add subclass - works
            List<Shape> shapes = new List<Shape>();
            shapes.Add(new Triangle());
            shapes.Add(new Square());

            // list of holders of base class, add holders of subclass - fails
            List<ShapeHolder<Shape>> shapeHolders = new List<ShapeHolder<Shape>>();
            shapeHolders.Add(new ShapeHolder<Triangle>());
            shapeHolders.Add(new ShapeHolder<Square>());
        }
    }
} 
```

产生：

> 错误 CS1502：“System.Collections.Generic.List>.Add(TempInherit.ShapeHolder)”的最佳重载方法匹配有一些无效参数 (CS1502) (TempInherit)
> 
> 错误 CS1503：参数`#1' cannot convert` TempInherit.ShapeHolder' 表达式键入 `TempInherit.ShapeHolder' (CS1503) (TempInherit)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T17:14:37.437

协方差问题：

您可以创建一个 interface `IShapeHolder<out T>`，因为接口上的泛型参数可以是协变的（但不是在类上）

类似的东西

```
public class Shape
    {
    }
    public class Triangle : Shape
    {
    }
    public class Square : Shape
    {
    }
    //T generic parameter is covariant (out keyword)
    public interface IShapeHolder<out T> where T : Shape
    {
    }
    public class ShapeHolder<T>  : IShapeHolder<T> where T: Shape
    { 
    } 
```

然后，

```
var shapes = new List<Shape>();
shapes.Add(new Triangle());
shapes.Add(new Square());

// list of holders of base class, add holders of subclass - fails no more
var shapeHolders = new List<IShapeHolder<Shape>>();
shapeHolders.Add(new ShapeHolder<Triangle>());
shapeHolders.Add(new ShapeHolder<Square>()); 
```

# nhibernate - 如何删除没有类和映射的表？

> ID：14734795
> 
> 赞同：0
> 
> 时间：2013-02-06T17:08:22.820
> 
> 标签：nhibernate

我正在使用 ASP.NET 的[SimpleMembership](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)，它使用我通过 Nhibernate 创建的用户表。SimpleMembership 自动创建 Membership 和 Roles 表（没有 Nhibernate），它与 User 表有一个外键（即：Membership 和 Roles 有一个属于我的 User 表的外键）。我没有这些*Membership*和*Roles*表的类或映射。

在我的 nunit 测试项目中，我在我的设置中创建了这些表，但是**我无法通过以下实现删除所有表。**

> var se = new SchemaExport(_configuration); se.Drop(true, true);

Drop() 无法删除 User 表，因为 Membership 和 Roles 表依赖于 User 表。我很确定在尝试删除 User 表之前我必须删除此 Membership 和 Roles 表。**如何手动删除*Membership*和*Roles*表而不为它们创建类和映射？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T08:12:35.110

我个人会删除所有数据，`session.Delete("from Object");`但您可以添加其他表以放入配置中：

```
config.CreateMappings(Dialect.GetDialect(config.Properties))
    .AddTable(catalog, schema, tablename, null, false, "drop"); 
```

也许必须在所有其他映射之前先添加表

# jquery - jQuery - 从文本创建 ul 列表

> ID：14734797
> 
> 赞同：1
> 
> 时间：2013-02-06T17:08:30.053
> 
> 标签：jquery, html-lists

我有一个文本块，我想更改为 ul 列表。为了确定文本会在哪里中断，我想我可以使用像 / 这样的字符，所以文本可能是。

```
 <p>
      /Red Car/Green Car/Black Car
    </p> 
```

我需要这样的清单。

```
 <ul>
      <li>Red Car</li>
      <li>Green Car</li>
      <li>Black Car</li>
    </ul> 
```

我一直在尝试这样做。

```
 $(function(){
        var list = '';
        $('.whatWeDo').find('=').each(function(){ //.whatWeDo id the <p>
            list += '<li>' + $(this).next() + '</li>';
        });
        var theList = $('ul').append(list);
        $('.whatWeDo').html(theList);
      }) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:14:52.027

尝试这个：

```
var items = $('p').text().trim().split('/');
$('p').replaceWith('<ul>');
for (var i = 0; i < items.length; i++) {
    if(items[i].length >0) $('ul').append('<li>' + items[i] + '</li>');
} 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/usQyP/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:23:24.073

`.find()`寻找一个 jQuery 选择器，而不是文本。

试试这个，它假装你的原始元素的 id 为`original`：

```
jQuery(function ($) {

    // Get your original list, and its text
    var $original = $('#original');
    var text = $original.text();

    // Split the text at every '/', putting the results into an array
    var listItems = text.split('/');

    // Set up a new list
    var $list = $('<ul></ul>');

    // Loop through the list array, adding an <li> for each list item
    listItems.each(function(item){
        $list.append('<li>' + item + '</li>');
    });

    // Replace the old element with the new list  
    $original.replaceWith( $list );

}); 
```

# jquery - 同位素 + 延迟加载：图像大小

> ID：14734800
> 
> 赞同：7
> 
> 时间：2013-02-06T17:08:42.893
> 
> 标签：jquery, jquery-isotope, lazy-loading

在我暴露我的问题之前要记住两件事：1.我不是程序员，因此我不知道我在做什么 2.像我很愚蠢一样和我说话，并且非常耐心（参见1.)

好吧，网站的设置方式有大约一百万个错误，但现在我只是想让 Isotope 与 Lazyload 一起工作。我可能已经阅读了有关该问题的每一个 stackoverflow，但到目前为止我还无法解决我的问题。我使用 Stacey 作为 CMS。基本上，我要实现的目标类似于 xxx.aestheticallyloyal.com（或者实际上是 www.imageworkshop.com/lazyload-portfolio），但在各自的项目页面中打开了可点击的缩略图排列的同位素/砌体样式。我尝试让 Infinitescroll 工作，但我不确定 Stacey 是否支持分页，因此我放弃了。输入延迟加载。

我让同位素工作正常。我可以单独让 Lazyload 正常工作。但是每当我尝试将两者混合时，我都会惨遭失败。问题是图像在完全加载之前由同位素组织，因此它们不会根据实际大小（可变）对齐，而是得到固定的宽度和高度（我可以固定宽度，这就是重点，但高度应该相应地缩放）。但是，如果我在此之后调整窗口大小，则会相应地调整网格。

这是我正在使用的代码：

```
 <script>
$(function () {
    var $window = $(window);
    var $container = $('#container');
    var $imgs = $("img.lazy");

    $imgs.lazyload({
        event: 'scroll',
        effect: 'fadeIn',
        failure_limit: Math.max($imgs.length - 1, 0),
        appear: function () {}
    });

    $(function () {
        $container.imagesLoaded(function () {
            $container.isotope({
                onLayout: function () {
                    $window.trigger("scroll");
                },
                itemSelector: '.photo'
            });
        });
    });

    $window.load(function () {
        $container.isotope('reLayout');
    });
});
    </script> 
```

这可能在很多方面都是错误的……我不知道。另外，按原样，我认为 reLayout 完全没有做任何事情，从那里我真的不知道该去哪里。任何人都可以看看我的网站 flow.blukaet.com 并让我知道如何整理这个烂摊子吗？（没关系左边的菜单，我什至还没有开始看）。谢谢。

**更新#1**

我一直在尝试使用另一个名为 Fasterize 的 Lazyload 脚本。事情似乎只是稍微好一点，但我仍然无法以正确的方式显示出现在首屏下方的图像。基本上任何加载到视口中的东西都会被同位素很好地分类，但剩余的图像不会根据它们的实际、最终、可见尺寸添加。我需要在 Isotope 中触发某些东西，以使其在加载新项目后重新排列它们。我不知道这是否可能。有人可以帮忙吗？这是您可以看到正在发生的事情的网站：flow.blukaet.com（上面的代码不再是实际的）。

**更新#2**

所以这是修改后的代码，这要归功于下面提供的答案（另外，这是使用fastize/lazyload而不是appelsiini的lazyload）：

```
<script>
$(window).load(function () {

var $container = $('#container');
var $imgs = $("img");

$container.imagesLoaded(function () {
    $container.isotope({
        itemSelector: '.photo'
    });
});

$(window).scroll(function () {
    $container.isotope('reLayout');
});
});
</script> 
```

它不是超级顺利，但它可以完成工作。

以前我尝试过一些类似的东西：

```
<script>
$(function () {

var $container = $('#container');
var $imgs = $("img");

$container.imagesLoaded(function () {
    $container.isotope({
        itemSelector: '.photo'
    });
});

$imgs.load(function () {
    $container.isotope('reLayout');
});
});
</script> 
```

它实际上运行得更顺畅，但不知何故给出了以下控制台错误：

> 无法在初始化之前调用同位素上的方法；试图调用方法“reLayout”

所以我不知道。

另一件需要注意的是，该代码适用于 FF 和 Opera。显然 Safari 完全忽略了延迟加载。我没有在 Chrome 和 IE 中测试过。如果有人想查看：flow.blukaet.com

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-17T23:51:39.217

嘘！我认为我们有一个最终的赢家。我修补了一些我找到的半解决方案——通过反复试验，请注意，因为我仍然不知道我在做什么——我想我终于做对了。控制台不再返回初始化错误，并且代码的行为似乎或多或少正确（我认为？！）。

```
<script>
$(document).ready(function () {

    var $container = $('#container');
    var $imgs = $("img");

    $container.imagesLoaded(function () {
        $container.isotope({
            itemSelector: '.photo'
        });
        $imgs.load(function () {
            $container.isotope('reLayout');
        }); 
    });
});
</script> 
```

所以'reLayout'不会在滚动时发生，但是当图像加载时，如果滚动没有完全通过，它们就不会卡住。

在 Safari 中，Lazyload 仍然可以为所欲为，而且像往常一样，我无法在 Chrome 和 IE 上进行测试，但在 FF 和 Opera 中似乎还可以。查看 flow.blukaet.com 以获取工作示例。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T20:24:08.123

我对响应式网格有同样的问题。检查这张图片，左边的网格没问题，右边的网格坏了。

![在此处输入图像描述](../Images/7bc7e21d34b470fe5e0ea4a0a86e6173.png)

网格被破坏是因为需要图像的特定高度，并且响应过程将高度值传递给“自动”。

所以在这里我们必须在加载图像时重新布局（给出特定的高度来处理）。

现在我找到的解决方案是在 scrool 上重新布局：

```
$(window).scroll(function() {
        $container.isotope('reLayout');
}); 
```

但我确信有更好的方法来做到这一点。

并尝试使用 freetile 的网格，发现它比其他的更好更轻。 [http://yconst.com/web/freetile/](http://yconst.com/web/freetile/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-21T15:02:35.460

虽然我遇到了同样的问题并且无法解决，但我意识到这只是一个警告。所以我只是通过在文件“jquery.isotope.min.js”（或 jquery.isotope.js）中注释掉控制台日志行来禁用它

```
var logError = function( message ) {
  if ( window.console ) {
    //window.console.error( message );
  }
}; 
```

# oracle - Oracle DB 异常：“确定数据库产品名称时出错：不支持的功能”

> ID：14734804
> 
> 赞同：1
> 
> 时间：2013-02-06T17:08:51.913
> 
> 标签：oracle, jdbc, flyway

我正在尝试对以下 Oracle 数据库使用 Flyway 2.0.3：

*   **Oracle 数据库：** Oracle 数据库 10g 企业版 10.2.0.5.0 版
*   **Oracle JDBC 驱动程序：** v9.0.2.0.0

尝试通过 maven (mvn flyway:info -e) 使用 Flyway 时，出现以下错误：

```
Caused by: java.sql.SQLException: Unsupported feature
    at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:134)
    at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:179)
    at oracle.jdbc.dbaccess.DBError.throwSqlException(DBError.java:269)
    at oracle.jdbc.dbaccess.DBError.throwUnsupportedFeatureSqlException(DBError.java:689)
    at oracle.jdbc.OracleDatabaseMetaData.getDatabaseMajorVersion(OracleDatabaseMetaData.java:4442)
    at com.googlecode.flyway.core.dbsupport.DbSupportFactory.getDatabaseProductName(DbSupportFactory.java:113)
    ... 27 more 
```

虽然如果我再试一次，但使用较新版本的驱动程序（v9.2+），flyway 工作正常:)

查看有问题的 OracleDatabaseMetaData.getDatabaseMajorVersion() 方法，我可以看到它明确抛出了“不支持的功能”SQLException。

我想知道flyway是否有理由不能满足这种可能性？

可能是疏忽（我可以考虑提交补丁）还是 Flyway 只能支持某些版本的 oracle 驱动程序（无论出于何种原因，而不是批评）。

干杯伙计们！！！

**更新：解决方法**

当我使用 maven 时，我在 flyway 插件定义中定义了更新版本的 oracle 驱动程序。项目仍然可以使用旧的驱动依赖，插件可以使用更新的版本：

```
<dependencies>
    <dependency>
        <groupId>com.oracle</groupId>
        <artifactId>ojdbc14</artifactId>
        <version>9.0.2.0.0</version>
    </dependency>
    ...
</dependencies>

<plugin>
    <groupId>com.googlecode.flyway</groupId>
    <artifactId>flyway-maven-plugin</artifactId>
    <version>2.0.3</version>
    <dependencies>
        <dependency>
            <groupId>com.oracle</groupId>
            <artifactId>ojdbc14</artifactId>
            <version>10.2.0.4.0</version>
        </dependency>
                ...
    </dependencies>
        ...
</plugin> 
```

# ember.js - 在 Trek 教程中通过 connectOutlet 显示登录被阻止

> ID：14734806
> 
> 赞同：0
> 
> 时间：2013-02-06T17:09:04.887
> 
> 标签：ember.js

我正在按照[http://trek.github.com/](http://trek.github.com/)此处的教程进行操作，但我遇到了障碍。

index.html 中的 Ember 代码：

```
<script type="text/x-handlebars" data-template-name="application">
<h2>Ember Committers:</h2>
{{outlet}}
</script>

<script type="text/x-handlebars" data-template-name="contributors">
{{#each person in controller}}
    {{person.login}}
{{/each}}
</script> 
```

app.js 中的 Ember 代码：

```
App = Ember.Application.create();

// Application default controller and view
App. ApplicationController = Ember.Controller.extend();
App.ApplicationView= Ember.View.extend( {
    templateName: 'application'
});

// Contributors controller and view...
App. AllContributorsController = Ember.ArrayController.extend();
App.AllContributorsView= Ember.View.extend( {
    templateName: 'contributors'
});

App.Router = Ember.Router.extend({
    root: Ember.Route.extend({
        index: Ember.Route.extend({
            route: '/',
            connectOutlets: function(router) {
                // Here we connect the allContributers data & template to the outlet in the application template.
                router.get('applicationController').connectOutlet('allContributors', [{login:'wycats'},{login: 'tomdale'}]);
            }
        })
    })      
}); 
```

此时，当我运行它时，我希望看到文本“Ember Committers:”以及通过 connectOutlet() 指定的两个登录名。

我只看到标题文本而不是登录名，我没有收到任何错误。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:37:57.557

[只有当我按照 emberjs.com 指南页面http://emberjs.com/guides/routing/defining-your-routes/](http://emberjs.com/guides/routing/defining-your-routes/)上的方式完成路线时，我才取得任何成功

您将通过以下方式定义路线

```
App.Router.map(function(){
    this.route('contributors');
}); 
```

此时，默认情况下，如果您转到 #/contributors，它会将贡献者模板放入 `{{outlet}}` （无需视图声明）。

如果您需要更改插座，您可以通过为贡献者创建一个路由（而不是路由器！这种混乱花费我一天的时间）来完成：

```
App.ContributorsRoute = Ember.Route.extend({
    connectOutlets: ...
}); 
```

# c++ - 如何在禁用 C++ 异常（VS2010）的情况下确保内存不足的稳健性？

> ID：14734807
> 
> 赞同：10
> 
> 时间：2013-02-06T17:09:08.897
> 
> 标签：c++, exception, dll, out-of-memory, robustness

我正在开发一个性能关键的动态链接库 (DLL)，它也应该具有相对较小的二进制大小。由于它没有明确抛出任何异常，我想完全禁用异常支持。但是，有一个例外（双关语意外）：当内存不足 (OOM) 时，我必须向应用程序报告错误代码，以便它有机会优雅地处理事情。代码库太大，无法单独检查每个分配并传播错误，并且包含我不应该接触的外部代码。所以我想在我的 DLL 导出函数中捕获 OOM 异常。

一个快速测试表明，当在 Visual C++ 2010 中禁用 C++ 异常（即没有 /EHa、/EHsc 或 /EHs 标志）时，它仍然会在分配过多内存时跳转到 catch(std::bad_alloc&) 块。

所以它似乎按预期工作。但是，我收到以下 1 级警告：“C4530：使用了 C++ 异常处理程序，但未启用展开语义。指定 /EHsc”。MSDN 说“在框架中自动存储的对象，在执行投掷的函数和捕获投掷的函数之间，不会被破坏”。

我会在这里失去什么？只要可以删除通过库创建的任何内容，并且应用程序可以重新开始（如果它愿意），就可以将事物置于未定义状态。是否存在无法恢复的泄漏内存的大风险？

DLL 是否使用单独的内存池？如果是这样，我可以在不需要应用程序卸载 DLL 的情况下清除它吗？我可以轻松地让我的库忽略任何进一步的（导出的）函数调用，直到应用程序执行重新初始化。

谢谢你的建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T00:48:02.003

一些预备知识：

我不知道在未启用异常处理的情况下抛出异常是否是未定义的行为或不符合标准，但您肯定不会从堆栈上的对象中获取堆栈展开/析构函数调用。

如果您使用 RAII 为互斥锁、文件、内存等编写 C++ 风格的代码，这是一件非常糟糕的事情。

然后继续，假设您的代码本质上是 C 风格的代码：

1) 如果您静态链接到 C 运行时库，您的 DLL 将不会与您的主应用程序共享堆。卸载 DLL 应该会释放泄漏的内存——但同样，请注意其他资源。

2）如果您动态链接到 C 运行时（很常见），那么您正在共享一个堆。您必须有一种方法来手动释放从 DLL 分配的任何内存。

让我自己在 DLL 边界问题上纠缠不清，我建议您进行快速基准测试，以了解您在启用异常方面付出的代价。根据您的平台和编译器，未引发的异常对性能的影响可以忽略不计。

# python - Tomcat 错误日志的正则表达式

> ID：14734808
> 
> 赞同：2
> 
> 时间：2013-02-06T17:09:12.643
> 
> 标签：python, regex, tomcat, logging

考虑以下 Tomcat 日志结构：

```
[06/Feb/2013:15:25:27 +0000] [Thread-10] DEBUG xxx.yyy.xxx.yyy.xxx.yyy.BlahBlahClass  - Reloading blah configuration: /somepath/xxx.yyy
[06/Feb/2013:15:25:27 +0000] [Thread-11] ERROR xxx.yyy.xxx.yyy.xxx.yyy.BlahBlahClass2  - [xxx.yyy] - Could not find the somethinh
[06/Feb/2013:15:25:27 +0000] [Thread-12] ERROR xxx.yyy.xxx.yyy.xxx.yyy  - error handling product : xxx.yyy  don't know where it is 
xxx.yyy.IOException: Could not find the feed with id [thisisfeedname_13601429613239870] in the feed repository or as a what?
    at xxx.yyy.xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:57)
    at xxx.yyy.xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:65)
    at xxx.yyy.xxx.yyy.xxx.yyy.flush(xxx.yyy:294)
    at xxx.yyy.xxx.yyy.DelayedLogger$xxx.yyy(Unknown Source)
Caused by: xxx.yyy.FileNotFoundException: /path/to/feeds/xxx.yyy (No such file or directory)
    at xxx.yyy.xxx.yyy(Native Method)
    at xxx.yyy.FileInputStream.<init>(xxx.yyy:120)
    at xxx.yyy.xxx.yyy.xxx.yyy.parse(xxx.yyy:248)
    at xxx.yyy.xxx.yyy$xxx.yyy(Unknown Source)
    at xxx.yyy.xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:41)
    at xxx.yyy.xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:13)
    at xxx.yyy.xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:54)
    at xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:176)
    at xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:151)
    at xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:143)
    at xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:127)
    at xxx.yyy.xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:63)
    at xxx.yyy.xxx.yyy.xxx.yyy.xxx.yyy(xxx.yyy:43)
    ... 3 more
[06/Feb/2013:15:25:27 +0000] [Thread-13] INFO  xxx.yyy.xxx.yyy.xxx.yyy  - constructing a new CSV feed resource
[06/Feb/2013:15:25:27 +0000] [Thread-14] DEBUG xxx.yyy.xxx.yyy.xxx.yyy.xxx.yyy  - number of feeds defined for the resource: 1
[06/Feb/2013:15:25:27 +0000] [Thread-15] INFO  xxx.yyy.xxx.yyy.xxx.yyy  - constructing a new CSV feed resource 
```

该日志由一个报告行组成，该报告行以大括号中的时间戳开始，可选地后跟堆栈跟踪。例如，`Thread-12`有以下堆栈跟踪，但线程 10 到 15 没有。

我想将每个日志事件转换为带有时间戳、错误类型（等）、消息和可选堆栈跟踪的 Python`ERROR`对象`INFO`。我尝试了以下正则表达式：

```
reg_str='^\[(.*?)\]\s+\[(.*?)\]\s+(\w+)\s*(.*)\s*$\s*(([^\[].*?$)*)'
reg=re.compile(reg_str, re.MULTILINE) 
```

[唉](http://mentalfloss.com/article/28737/words-used-incorrectly-alas)，只要有堆栈跟踪，正则表达式就会贪婪地匹配文本，直到日志结束。

如何重写正则表达式以正确匹配日志事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:41:54.270

首先，使贪婪的部分不贪婪；）

```
^\[(.*?)\]\s+\[(.*?)\]\s+(\w+)\s*(.*?)\s*$\s*(([^\[].*?$)*)
                                    ^ 
```

这是[一个 Rubular 链接](http://rubular.com/r/VXPBeGXyd4)。

但是，您可以在链接中看到，正则表达式的其余部分存在问题。首先，您需要做的是将最后一个`\s*` *放在*括号内，因为可选行可以缩进。其次，您需要使用否定前瞻而不是否定字符类，原因可能会使这个答案复杂化（但如果您愿意，我可以在评论中）。像这样：

```
^\[(.*?)\]\s+\[(.*?)\]\s+(\w+)\s*(.*?)\s*$((\s*(?!\[).*?$)*)
                                          ^^^^^^^^^^^ 
```

这是[另一个 Rubular 链接](http://rubular.com/r/ZgoJFeCioI)。

最后，最后一个捕获组并不是特别有用，所以...

```
^\[(.*?)\]\s+\[(.*?)\]\s+(\w+)\s*(.*?)\s*$((?:\s*(?!\[).*?$)*)
                                            ^^ 
```

这是[最后的 Rubular 链接](http://rubular.com/r/7KaD6dC0js)。

# c# - 一个 c# 项目中的 2 个表单或窗口（MS Visual Studio）

> ID：14734811
> 
> 赞同：1
> 
> 时间：2013-02-06T17:09:26.777
> 
> 标签：c#, windows, forms, screen, split

是否可以在一个项目中运行 2 个窗口？我想使用它，因为我的程序需要在投影屏幕上运行，并且需要在另一个屏幕上更改数据，不允许观看投影屏幕的人看到。

谢谢你的时间 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:12:44.730

是的。

当您的应用程序启动时，您可以显示多个表单。这是假设您使用的是双显示器，其中一个在投影仪上镜像。

例如：

主窗体：

```
MainForm_Load(object sender, EventArgs args)
{
 Form1 form1 = new Form1();
 Form2 form2 = new Form2();

 form1.Show();
 //Set location to screen 1

 form2.Show();
 //Set location to screen 2
} 
```

# php - 是否使用 MySQL 中的当前/默认字符集转换 BLOB？

> ID：14734812
> 
> 赞同：7
> 
> 时间：2013-02-06T17:09:35.293
> 
> 标签：php, mysql, perl, utf-8, pdo

1.  我有一个带有 BLOB 字段的表。
2.  表的字符集是 Latin1。
3.  我连接到数据库和“SET CHARACTER SET utf8”。
4.  然后我将二进制数据保存到该字段中。
5.  然后我检索数据，这不是我保存的（损坏）。

编码：

```
<?php
$pdo = new \PDO("mysql:host=127.0.0.1;dbname=***", '***', '***');

$pdo->exec('SET CHARACTER SET utf8');

$sql = "INSERT INTO pdo_blob (the_blob) VALUES(:the_blob)";
$insertStm = $pdo->prepare($sql);

$blob = (binary) file_get_contents('/home/***/test.pdf');
$insertStm->bindParam(":the_blob", $blob, \PDO::PARAM_LOB);
$insertStm->execute();

$selectStm = $pdo->prepare("SELECT the_blob FROM pdo_blob ORDER BY id DESC LIMIT 1");
$selectStm->execute();

$savedBlob = null;
$selectStm->bindColumn(1, $savedBlob, \PDO::PARAM_LOB);
$selectStm->fetch();

echo 'equal: ' . ((int) ($blob == $savedBlob)); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-07T07:17:53.830

# 简短的回答：

只需删除或注释掉下面的行，无论真正使用哪种数据库编码（ , 等），它都将始终`utf8`有效`latin1`：

```
$pdo->exec('SET CHARACTER SET utf8'); 
```

# 长答案：

这不是 PDO 错误，这是 MySQL 错误。

当实际数据库编码为`latin1`时，但您使用：

```
SET CHARACTER SET utf8 
```

（反之亦然：实际是`utf8`，但你使用`latin1`- 重要的部分是它是**不同**的），然后，据我所知，MySQL 将尝试对客户端和服务器之间的所有流量执行字符集转换（即使是`BLOB`！）。

如果您不使用`SET CHARACTER SET`语句，从我看到的脚本（PHP/PDO 或 Perl/DBI）连接字符集默认设置为数据库字符集，在这种情况下不会发生隐式转换。

显然，这种自动转换会杀死不希望发生任何转换的 BLOB。

我已经在 PHP/PDO 和 Perl/DBI 上对此进行了测试，并且问题很容易重现：如果使用带`latin1`编码和使用的数据库`SET CHARACTER SET utf8`（反之亦然），两者都会失败。

如果您想完全`UTF8`兼容，您应该使用以下方法更改数据库的编码：

```
ALTER DATABASE mydb CHARSET utf8; 
```

有了这个，一切都将使用`UTF8`，并且 BLOB 也将正常工作。

导致此损坏问题的最小文件是`blob.bin`单字节`0xFF`。在 Linux 上，您可以使用以下`printf`命令创建此测试文件：

```
printf "0xFF" > blob.bin 
```

现在，测试重现问题的脚本：

# PHP测试代码：

```
<?php
$dbh = new PDO("mysql:host=127.0.0.1;dbname=test");
# If database encoding is NOT utf8, uncomment to break it:
# $dbh->exec("SET CHARACTER SET utf8");

$blob1 = file_get_contents("blob.bin");
$sth = $dbh->prepare(
    "INSERT INTO pdo_blob (the_blob) VALUES(:the_blob)"
);
$sth->bindParam(":the_blob", $blob1, PDO::PARAM_LOB);
$sth->execute();

$sth = $dbh->prepare(
    "SELECT the_blob FROM pdo_blob ORDER BY id DESC LIMIT 1"
);
$sth->execute();

$blob2 = null;
$sth->bindColumn(1, $blob2, PDO::PARAM_LOB);
$sth->fetch();

if ($blob1 == $blob2) {
    echo "Equal\n";
} else {
    echo "Not equal\n";
    $arr1 = str_split($blob1);
    $arr2 = str_split($blob2);
    $i=0;
    for ($i=0; $i<count($arr1); $i++) {
        if ($arr1[$i] != $arr2[$i]) {
            echo "First diff: " . dechex(ord($arr1[$i])) . " != "
                                . dechex(ord($arr2[$i])) . "\n";
            break;
        }
    }
}
?> 
```

# Perl 测试代码：

```
#!/usr/bin/perl -w

use strict;
use DBI qw(:sql_types);

my $dbh = DBI->connect("dbi:mysql:host=127.0.0.1;dbname=test");
# If database encoding is NOT utf8, uncomment to break it:
# $dbh->do("SET CHARACTER SET utf8");
open FILE, "blob.bin";
binmode FILE;
read(FILE, my $blob1, 100000000);
close FILE;
my $sth = $dbh->prepare(
    "INSERT INTO pdo_blob (the_blob) VALUES(?)"
);
$sth->bind_param(1, $blob1, SQL_BLOB);
$sth->execute();
my ($blob2) = $dbh->selectrow_array(
    "SELECT the_blob FROM pdo_blob ORDER BY id DESC LIMIT 1"
);
print ($blob1 eq $blob2 ? "Equal" : "Not equal") , "\n"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T19:29:21.243

编辑：在 WAMP 服务器上

它不适用于 PDO API。您可以`base64_encode()`在插入之前和`base64_decode()`检索之后使用。它使数据膨胀`33%`，转换是一种开销。

如果 MySQLi API 是一个选项，那么这里有一些代码：

```
<?php
$mysqli = new mysqli('localhost', 'spark', 'spark123', 'test');

$sql = "INSERT INTO blob_tb (bdata) VALUES(?)";
$insertStm = $mysqli->prepare($sql);

$blob = NULL; //necessary
$insertStm->bind_param('b', $blob);

$blob = (binary) (file_get_contents('favicon.ico'));
$insertStm->send_long_data(0, $blob);

$insertStm->execute();
$insertStm->close();

$selectStm = $mysqli->prepare("SELECT bdata FROM blob_tb LIMIT 1");
$selectStm->execute();

$selectStm->bind_result($savedBlob);
$selectStm->fetch();
$selectStm->close();

$mysqli->close();

echo 'equal: ' . ((int) ($blob == $savedBlob));
// var_dump(($blob), strlen($blob));
// var_dump(($savedBlob), strlen($savedBlob));
// var_dump(get_defined_vars());

?> 
```

# visual-studio-2012 - 我可以更改 Visual Studio 2012 中组件的默认命名吗

> ID：14734816
> 
> 赞同：1
> 
> 时间：2013-02-06T17:09:59.713
> 
> 标签：visual-studio-2012

当我在表单上放置一个文本框时，VS2012 将创建一个默认名称。有没有办法改变这些默认值，使它们更接近我们的编码标准？

我知道我可以更改名称，但如果我可以将其自动化就更好了。

# mysql - 来自 vbscript 的表更新锁定

> ID：14734818
> 
> 赞同：0
> 
> 时间：2013-02-06T17:10:09.663
> 
> 标签：mysql, vbscript, locking

从这样的表：

```
ID  SEQUENCE
1    1 
```

我想在每次访问表时增加序列值。到目前为止，我想出了这个 vbscript：

```
Dim Result
On Error Resume Next
Result = GetSequential()
Set objFS = CreateObject("Scripting.FileSystemObject")
Set objFile = objFS.CreateTextFile("result_" & Result & ".txt", False)
if err.Number <> 0 then
   MsgBox err.Description & " (" & Err.Number & "): " & Result
end if
on error goto 0
wscript.echo "Next value: " & Result

Function GetSequential()
Dim cn, rs
Dim Sequential

Set cn = CreateObject("ADODB.Connection")
Set rs = CreateObject("ADODB.Recordset")
cn.connectionstring = "Driver={MySQL ODBC 5.2a Driver};Server=172.16.0.130;Database=testautostore;User=root;Password=aquilae"
cn.Open

Dim SqlCount
SqlCount = "select count(*) from counter where ID='1'"
rs.Open SqlCount, cn, adOpenStatic

If rs(0) = "1" Then 
    wscript.echo "Updating record..."
    Dim SqlUpdate
    SqlUpdate = "update counter set SEQUENCE=SEQUENCE + 1 where ID='1'"
    cn.Execute SqlUpdate

    Dim SqlSelect
    SqlSelect = "select SEQUENCE from counter where ID='1'"
    rs.Close
    rs.Open SqlSelect, cn, adOpenStatic

    Sequential = rs(0)
    wscript.echo "Result: " & Sequential
End if

rs.Close
Set rs = Nothing
cn.Close

GetSequential = Sequential
End Function 
```

单独运行时效果很好：

```
cscript testsequence.vbs 
```

但是当同时运行它多次时，不能保证获得唯一的序列号。这在启动这样的批处理文件时很明显：

```
for /l %%x in (1, 1, 25) do start cscript testsequence.vbs 
```

由于返回相同的序列值（文件已存在），在创建 result_?.txt 文件时会产生异常失败。

所以问题是如何锁定表更新操作？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T21:07:06.600

您似乎认为脚本中的更新和读取将是原子的：

*   进程 A 更新`sequence`
*   进程 A 读取`sequence`
*   进程 B 更新`sequence`
*   进程 B 读取`sequence`

然而，MySQL 默认启用了自动提交，因此每个语句都是自己运行的，来自并发进程的查询可能会变得混合：

*   进程 A 更新`sequence`
*   进程 B 更新`sequence`
*   进程 B 读取`sequence`
*   进程 A 读取`sequence`

这样 A 和 B 将读取相同的值，尽管两个进程都会增加它。

您需要将您的语句放在一个[事务](http://dev.mysql.com/doc/refman/5.6/en/commit.html)中并使用适当的[隔离级别](http://dev.mysql.com/doc/refman/5.6/en/set-transaction.html)。

# php - 请帮助我保存服务器响应我的 cURL GET 请求发送的数据

> ID：14734819
> 
> 赞同：1
> 
> 时间：2013-02-06T17:10:14.080
> 
> 标签：php, html, curl

我正在尝试通过实际做一些我可能觉得对自己有用的事情来学习 PHP。我的国家有一家博彩机构，它有一个网站，我可以通过输入票号来检查我是否中奖。我正在尝试编写一个 PHP 脚本来检查票的范围是否值得任何东西，所以我不必在他们的网站上手动输入每张票。

我设法做到了。但现在我想将从他们的服务器获得的响应保存在一个文件中。我遇到了严重的问题。我设法将详细信息保存到文件中，但我无法将脚本保存到运行脚本后在浏览器屏幕上看到的文件中。

这是代码：

```
<?php

function check($week, $base, $startcheck, $endcheck, $verbose = "true"){

// Set file path
$verbosePath = 'publicbet.txt';
echo "Saving the tickets to: <b>$verbosePath</b>\n";

// Initiate numbering
$i = 0;

// Initiate publicbet.ro IP
$ip = "80.86.107.93";

// Loop
while ($startcheck <= $endcheck){

    // Generate tickkey
    $tickkey = $week.$base.$startcheck;

    // get the current server time
    $time = date('d-m-Y H:i:s');

    // Open a new cURL resource
    $ch = curl_init();

    // Stuff
    curl_setopt($ch, CURLOPT_VERBOSE, true);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, false);
    curl_setopt($ch, CURLOPT_STDERR,$f = fopen($verbosePath, "a"));
    curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows NT 6.2; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0");

    // publicbet.ro may be checking the IP adress
    // from where the $tickkey is sent in order to
    // check for abnormalities; we will send the
    // IP adress of the website:)
    $headerarray = array(
        "X-Forwarded-For: $ip");

    // Set the URL and other options
    curl_setopt($ch, CURLOPT_URL, 'http://publicbet.ro/gettickinfo2.php?lang=ro&tickkey='.$tickkey);
    curl_setopt($ch, CURLOPT_REFERER, 'http://www.publicbet.ro/');
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_HTTPHEADER, $headerarray);

    // Executing cURL
    curl_exec($ch);

    // Close cURL resource, free up system resources
    curl_close($ch);
    fclose($f);

    // Showing informtion
    $v .= "<br />$i. At <b>$time</b> the server checked the tickkey: <b>$tickkey</b> and returned the tickket: ";
    if ($verbose == "true"){
        echo $v;
        $v = '';
    }

// Modifying values
$startcheck++;
$i++;

}

}

if ($_POST[week] && $_POST[base] && $_POST[startcheck] && $_POST[endcheck]){
check($_POST[week], $_POST[base], $_POST[startcheck], $_POST[endcheck]);
}
else {

?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>

<title>publicbet.ro</title>

</head>

<body>

<h1>Check your tickets here</h1>

<form action="<?php echo $_SERVER[PHP_SELF];?>" method="post">
    <table>
        <tbody>
            <tr>
                <td>week:</td>
                <td>base:</td>
                <td>start check:</td>
                <td>end check:</td>
            </tr>
            <tr>
                <td><input type="number" name="week" min="00" max="54" maxlength="2" size="2" value=""/></td>
                <td><input type="number" name="base" maxlength="11" size="11" value=""/></td>
                <td><input type="number" name="startcheck" maxlength="6" size="6" value=""/></td>
                <td><input type="number" name="endcheck" maxlength="6" size="6" value=""/></td>
            </tr>
        </tbody>
    </table>
    <br /><input type="submit" value="Check!" />
</form>

</body>

</html>

<?php } ?> 
```

所以请告诉我是否有任何方法可以做我愿意做的事情。我会很高兴的。

如果要测试脚本，请使用以下值： week: 05 base: 16010234203 start check: 350900 end check: 350920 。

它将返回 19 张假票和 1 张真票。我希望所有这些显示的文本都导出到文本文件而不是显示在我的屏幕上。

有没有办法做到这一点？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:24:41.150

设置`CURLOPT_RETURNTRANSFER`为`true`，然后在你做的地方`curl_exec()`，将它分配给这样的变量：

```
$data = curl_exec($ch) 
```

然后你可以像这样保存它：

```
file_put_contents('my_file.txt', $data); 
```

使用常量而不是字符串文字来表示真假等。我在你的函数参数中看到你所做`$verbose = "true"`的，这可以替换为`$verbose = true`.

您还在实际应该使用字符串文字的地方使用常量，例如`$_POST[base]`应该是`$_POST['base']`或`$_POST["base"]`

请不要那样使用`$_SERVER['PHP_SELF']`，它会让你非常容易受到 XSS 攻击等。你可以这样做`action=""`，它会发布到有问题的页面，比如`PHP_SELF`

你在哪里

```
if($_POST[base] .....) 
```

我建议这样做：

```
if(isset($_POST['base'], $_POST['somethingElse'], $_POST['anotherField'])) {
    // yay
} 
```

# jquery - jquery attr alt 复制到 attr 标题中

> ID：14734820
> 
> 赞同：0
> 
> 时间：2013-02-06T17:10:19.183
> 
> 标签：jquery

我编写了这个小 jQuery 代码片段来获取 alt 标记值并将相同的值应用于与 attr 标题相同的输入。这有效，但当我将其放入较大的 jQuery 文件时无效。所以我想知道我是否可以用一个链接的 jQuery 行而不是两个来写出来。

```
var modname = $("input").attr("alt");
$("input").attr("title",modname); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:12:47.887

如果要将所有输入的标题设置为 alt 属性的值，可以这样做：

```
$('input').attr('title', function(){ return $(this).attr('alt')} ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:15:44.053

你可以链接它（只有一个`<input>`），否则第一个找到的**'alt'**属性`<input>`将分配给`<input>`你的 DOM 中的所有其他属性

```
$('input').attr('title', $('input').attr('alt')); 
```

更好的是，如果你有不止一个`<input>`，就用它`.each()` *（如果你只有一个也可以`<input>`，它只是更干净）*

```
$("input").each(function(){
    $(this).attr("title", $(this).attr("alt"));
}); 
```

[就像在这个小提琴中](http://jsfiddle.net/SJUDy/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:13:04.240

这应该工作...

```
$("input").attr("title", $("input").attr("alt")); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T17:13:30.883

```
$('input').attr('title', function(index, item) { return $(item).attr('alt') }); 
```

# android - 安卓日历提供者

> ID：14734821
> 
> 赞同：0
> 
> 时间：2013-02-06T17:10:20.950
> 
> 标签：android, android-calendar

好吧，我的代码是：

```
public void onClick(View v) {

            if(task.isEventSet()==false)    {
                Calendar c=Calendar.getInstance();
                c.set((int)task.getTaskYear(),(int) task.getTaskMonth(), (int)task.getTaskDay(), (int)task.getTaskHour(), (int)task.getTaskMinute());
                Intent i=new Intent(Intent.ACTION_INSERT);
                i.setData(Events.CONTENT_URI);
                i.putExtra(Events._ID, task.getId());
                i.putExtra(Events.TITLE, task.getName());
                i.putExtra(Events.EVENT_LOCATION, task.getLocation());
                i.putExtra(CalendarContract.EXTRA_EVENT_BEGIN_TIME, c.getTimeInMillis());
                task.setEventSet(true);
                context=v.getContext();
                context.startActivity(i);
            } 
```

我的问题是当我单击一个图标时，日历应用程序会弹出，我可以在其中存储我的活动详细信息。假设我在设置事件的过程中按下取消或确定按钮，日历返回的响应代码是什么？我需要使用此响应代码来设置`task.setEventSet`取决于执行的操作..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:00:47.733

看看`startActivityForResult()`而不是`startActivity()`.

[http://developer.android.com/reference/android/app/Activity.html#startActivityForResult(android.content.Intent, int)](http://developer.android.com/reference/android/app/Activity.html#startActivityForResult%28android.content.Intent,%20int%29)

您将收到`onActivityResult()`带有响应代码的回调。

# iphone - 将常规新闻内容聚合器 iOS 应用程序作为报亭应用程序提交，是否允许？

> ID：14734823
> 
> 赞同：0
> 
> 时间：2013-02-06T17:10:28.407
> 
> 标签：iphone, ios, ipad, app-store, newsstand-kit

是否允许/有效将新闻应用程序发布为报亭应用程序？正在开发的应用程序基本上是一种跨特定类型的新闻文章聚合器，同时还允许用户在应用程序内共享/收藏/过滤内容。由于这看起来而且实际上更像是 webview 详细信息显示应用程序的常规表格列表，而不是显示杂志或 pdf 内容的列表，我很困惑是否可以将这样的应用程序作为报摊应用程序提交，因为它迎合特定的新闻应用用户（客户想法）。应用程序内容将由客户组织创建和管理，因此它不会只是在线内容的随机提要抓取器。也不会有任何订阅通过`IAP`或使用任何报刊亭的东西，除了将应用程序标记为报刊亭应用程序。这会导致拒绝吗？另外，报刊亭应用程序从新更新的内容（如定期出版的杂志）中获取报刊亭显示图标，而这个应用程序更像是一种常规类型，所以我不知道图标显示应该/将如何发生或工作？任何帮助和对指南的参考表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:16:51.517

从您的应用描述来看，我认为这肯定会被 Apple 拒绝。订阅可用性、定期（不超过季度）内容是 Apple 的准则要求，才能成为 Newsstand 应用程序。

订阅可用性是必需的，因为只有当用户可以为您的期刊内容购买订阅时，通过推送通知进行后台下载才有意义。这只会确保用户可以选择让您的应用程序可以通过推送通知在后台下载内容。

这是来自 Apple 的 ios 程序许可协议。您可以从您的开发者帐户中阅读它，顺便说一句，您必须接受这一点:)

3.5 您可以根据本附表 1 的条款，使用应用内购买 API 在特定地区免费提供应用内订阅，前提是许可应用根据下文第 3.7 节启用了报亭，并且您清楚且显着地向用户有关您的应用内订阅的以下信息： • 出版物或服务的标题 • 可以通过从设备中删除应用随时终止订阅 • 指向您的隐私政策和使用条款的链接

> 3.8 根据本附表 1 提供订阅服务的许可应用程序必须包含在 Apple 的报亭计划中，前提是除了第 3.5、3.6 和 3.7 段中规定的要求外，您： • 在 iTunes Connect 中启用许可应用程序作为报刊亭应用程序工具 • 授权 Apple 选择“Newsstand”作为许可应用程序的二级类别 • 利用应用内购买 API，包括任何附加代码，并遵守在 Newsstand 相关文档中不时确定和更新的任何其他要求iOS 开发人员库和 iTunes Connect 开发人员指南 • 为每个新问题提供更新的封面 • 确认许可应用程序的内容是期刊（例如，报纸或杂志）

# sql - SQL 代理作业关闭 Excel 过程

> ID：14734825
> 
> 赞同：0
> 
> 时间：2013-02-06T17:10:33.267
> 
> 标签：sql, excel, vbscript, agent

我想创建一个 SQL 作业来关闭所有打开的 excel 进程。我创建了一个可以双击运行的 VB 脚本。我试过了

`wscript C:\Apps\DestroyExcel.vbs`

使用类型 CmdExec。如何从 SQL 执行它以安排作业运行？

```
暗淡 objXL
出错时继续下一步
设置 objXL = GetObject(, "Excel.Application")

If Not TypeName(objXL) = "Empty" Then
    objXL.quit
别的
    msgbox "Excel 未运行。"
万一

```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:21:26.787

在 SSMS 中：

1.  转到 SQL Server 代理
2.  右键单击“作业”-> 新建作业
3.  输入信息
4.  在步骤部分中，单击新建
5.  对于类型，选择操作系统 (CmdExex)
6.  对于命令，键入：cscript C:\myscript.vbs
7.  设置你的时间表
8.  按确定

我相信应该这样做。

# php - 我可以使用 PHP tmpfile 创建的文件句柄 CURL POST 吗？

> ID：14734828
> 
> 赞同：3
> 
> 时间：2013-02-06T17:10:46.553
> 
> 标签：php, curl, temporary-files

假设我有一个使用 PHP 的 tmpfile() 函数创建的文件句柄数组，我可以使用 PHP curl 将文件作为附件发送吗？

通常，我会以 $postdata[fieldname] = '@path_to_file' 的形式创建一个关联数组，但由于我无法确定 tmpfile 的路径（我只有句柄），所以我不知所措。

动机：我不想单独从磁盘中清除这些 tmpfiles 的内容。我觉得 tmpfile 行为适合这个目的，但 curl 组件使事情复杂化。

*回答后考虑：Jay 的回答澄清了这一点，但我遇到了 tmpfile 的一个破坏交易的缺点：如果发生致命或突然终止进程，则会跳过“清理”行为，因此手动清除将是必要的故障安全。我认为没有任何方法可以规避通过文件系统并确保所有内容都被清理的过程，无论是否有 tmpfile。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T20:30:25.297

查看：[http ://us.php.net/manual/en/function.stream-get-meta-data.php](http://us.php.net/manual/en/function.stream-get-meta-data.php)

您可以执行以下操作：

```
$t = tmpfile();
$a = stream_get_meta_data($t);

$filename = $a['uri']; 
```

这个问题类似于：[使用文件句柄获取文件名（或删除文件）](https://stackoverflow.com/questions/5144583/getting-filename-or-deleting-file-using-file-handle)

# php - Joomla坚持要替换文章中的h1标签

> ID：14734840
> 
> 赞同：0
> 
> 时间：2013-02-06T17:11:32.507
> 
> 标签：php, content-management-system, joomla2.5, joomla-extensions

所以我已经阅读了网上关于这个的每一个主题，但似乎没有什么能解决我的问题。

作为 SEO 大修的一部分，我被要求在客户网站上用 h1 标签替换 h2 标签，但是 joomla 出于某种原因坚持不这样做，每当文章包含标签时，它“神奇地”被 h2 替换文章呈现。

我已经在模板中尝试了很多建议的覆盖方法，但到目前为止没有运气，我尝试搜索 joomla 源代码的所有部分，寻找一个用 h2 替换 h1 的函数，以便我可以摆脱它，没有运气。

所以我的问题是，我怎样才能让 joomla 在文章中停止将我的 h1 标签转换为 h2 标签？这种行为在哪里定义和/或我如何覆盖它并告诉它抓住这样做？

该网站正在使用 joomla 2.5

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:27:50.090

经过 3 个小时的来回搜索，我终于发现 SEO 插件 SH404 是罪魁祸首，显然它带有一个选项，可以将除一个之外的所有内容都重写为标签，此选项默认开启 -.-

不管怎么说，还是要谢谢你

# login - CloudFoundry 登录错误：“参数数量错误（1 对 2）”

> ID：14734844
> 
> 赞同：1
> 
> 时间：2013-02-06T17:11:33.413
> 
> 标签：login, cloud-foundry

我刚刚在 CloudFOundry 注册了一个新帐户，但无法通过 vmc 登录。

我将目标确定为[http://api.cloudfoundry.com](http://api.cloudfoundry.com)

这是 vmc info 命令的结果

```
VMware's Cloud Application Platform

target: http://api.cloudfoundry.com
version: 0.999
support: http://support.cloudfoundry.com 
```

当我运行以下命令时：

> vmc 登录 myemail@address.com --password myPasswd

我得到以下结果：

```
target: http://api.cloudfoundry.com

Authenticating... FAILED
ArgumentError: wrong number of arguments (1 for 2)
For more information, see ~/.vmc/crash 
```

这是 ~/vmc/crash 内容

```
Time of crash:   Wed Feb 06 11:57:38 -0500 2013

ArgumentError: wrong number of arguments (1 for 2)

vmc-0.4.7/lib/vmc/cli/start/login.rb:74:in `login'
vmc-0.4.7/lib/vmc/cli/start/login.rb:74:in `login'
interact-0.5.2/lib/interact/progress.rb:98:in `with_progress'
vmc-0.4.7/lib/vmc/cli/start/login.rb:72:in `login'
mothership-0.3.5/lib/mothership/base.rb:61:in `send'
mothership-0.3.5/lib/mothership/base.rb:61:in `run'
mothership-0.3.5/lib/mothership/command.rb:68:in `invoke'
mothership-0.3.5/lib/mothership/command.rb:82:in `instance_exec'
mothership-0.3.5/lib/mothership/command.rb:82:in `invoke'
mothership-0.3.5/lib/mothership/base.rb:50:in `execute'
vmc-0.4.7/lib/vmc/cli.rb:106:in `execute'
mothership-0.3.5/lib/mothership.rb:45:in `start' vmc-0.4.7/bin/vmc:11
/usr/bin/vmc:19:in `load' /usr/bin/vmc:19 
```

我不敢相信我无法获得有关此问题的搜索结果。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T19:56:30.477

我有同样的问题，这是一个解决方案：

找到 login.rb 文件（在我的电脑上：C:\Ruby193\lib\ruby\gems\1.9.1\gems\vmc-0.4.7\lib\vmc\cli\start\login.rb）

编辑此文件并找到行：

```
info[:token] = client.login(credentials) 
```

并重写为：

`info[:token] = client.login(credentials[:username], credentials[:password])`

它应该工作:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T20:56:33.437

我必须推荐 login.rb 作为解决方法。安装 --pre (0.5.0beta20) 产生了一个损坏的依赖关系：

```
Failed to load tunnel-dummy-vmc-plugin:
Unable to activate tunnel-dummy-vmc-plugin-0.0.2, because cfoundry-0.5.0 conflicts with cfoundry (~> 0.4.0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-11T17:22:11.993

这是与 gems -`vmc 0.4.7`和`cfoundry 0.4.20`. 这应该`cfoundry 0.4.21`在 2 月 8 日发布到 ruby​​gems 的版本中修复。

# wordpress - 将 Wordpress 用于静态网站

> ID：14734846
> 
> 赞同：3
> 
> 时间：2013-02-06T17:11:50.323
> 
> 标签：wordpress, wordpress-theming

我想创建一个静态网站并仅使用 wordpress 来“撰写”网站。我想创建一个只使用相同页眉和页脚的模板并更改页面内容（主页，联系 ecc dcc）。我的网站不是需要 CMS 的博客或任何其他类型的网站 我只想使用 Wordpress 只有一个页眉和页脚，并且不想在需要对其进行一些自定义时在所有页面中更改它。我希望我足够清楚！谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T22:00:16.340

您可以在自己的本地计算机上使用 WordPress（或任何其他 CMS）创建站点，然后使用[HTTrack](http://www.httrack.com/)等离线浏览器保存副本。然后将 HTTrack 保存的 HTML 上传到您的虚拟主机。

这将使您的站点更快，因为不需要在页面请求上执行 PHP，并且网络服务器将使用其默认缓存标头。（此外，您可以选择使用不支持 PHP 和 MySQL 的更便宜的主机。）

每次更改站点时，您都​​需要编辑实时 WordPress 版本，再次保存并重新上传文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-12-31T02:26:03.767

免责声明：我是[WP 静态 HTML 输出](https://wordpress.org/plugins/static-html-output-plugin)项目的开发人员。

它已经存在了几年，仍然有 5k+ 的活跃安装，但现在它增加了一些功能，它的全部目的是允许您使用 WordPress 进行站点开发并导出到静态 HTML 版本以提高速度、安全性和可移植性。

对于 OP，可能会使用基本的 FTP 发布选项。对于更高级的情况，有像[Netlify](https://www.netlify.com/)这样的服务，它可以从 Git 分支自动构建/部署您的静态站点。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T20:37:25.320

在**设置 | 阅读**管理页面，为您的首页显示选择一个静态页面。使用页面而不是帖子来构建您的网站。每个页面都将继承您网站的标准页眉和页脚。从**外观创建您的主菜单 | 菜单**管理页面将您的页面挂钩。根据需要使用小部件和标准 HTML 链接。然后使用众多可用主题之一来装扮您的网站。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-06-25T10:10:51.890

在这个表上有点晚了，但对于静态网站来说，Wordpress 似乎完全是矫枉过正。Wordpress 页面可以使用缓存插件进行缓存，但是当任何 Wordpress 站点加载时，每次加载页面时都会运行许多脚本和自定义 php 函数。

为什么不只是建立一个平面文件网站并简单地使用 PHP 包含您的页眉和页脚？设置起来要快得多，根据您的问题，这似乎正是您所需要的。

除此之外，您不会有站点或数据库的管理区域，只有服务器上的文件 - 这当然也会使您的站点不那么容易被黑客入侵。一个额外的好处是一个非常容易使用 Git 或 SVN 进行版本控制的站点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-26T20:31:23.973

如果有人想在 Wordpress 上使用静态站点生成器，这里有一个名为 WP Static 的脚本，它可以做到这一点：http: [//mossiso.com/code/make-wordpress-static](http://mossiso.com/code/make-wordpress-static)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-24T14:45:42.523

这个问题的另一个很好的解决方案是使用专门为此创建的特定软件。例如，对于 Mac，有一个名为[Hammer](http://hammerformac.com)的软件可以在您每次保存网站时“编译”您的网站，并将您的页眉和页脚包含在页面中。真的很有用。

# winforms - 以编程方式在 Telerik radgridview winforms 中创建层次结构

> ID：14734850
> 
> 赞同：1
> 
> 时间：2013-02-06T17:12:00.543
> 
> 标签：winforms, c#-4.0, telerik, radgridview

我想在未绑定数据的 radgridview 中创建层次结构。到目前为止，我还没有弄清楚如何去做。

我想你可以这样做：

```
Grid.Parent.Rows.Add(new object[] {}); 
```

和

```
Grid.Parent.Child.Rows.Add(new object[] {}); 
```

但我没有这样的运气。网格不能是数据绑定的。我有一个数据列表，我将遍历并创建层次结构。

我需要知道如何为该父节点创建父节点和子节点。我看到了模板并把它们弄乱了，但我只能让它与数据源一起工作。

有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T20:10:24.797

查看本文[以编程方式绑定到分层数据的](http://www.telerik.com/help/winforms/gridview-hierarchical-grid-binding-to-hierarchical-data-programmatically.html)**第二部分**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-31T05:36:59.747

// 数据绑定 radgridview 的代码

```
 void DataBInd()
        {

            var Source = Results.GetData(FromDate, Todate, drpLedger.Value);
            radGridLedgerAccount.DataSource = null;
            radGridLedgerAccount.DataSource = Source;
            FormatGrid();
            BindChildView();
            BindBarCharView(Source);
        } 
```

//绑定子视图的代码，即层次结构

```
 void BindChildView()
        {
            if (drpLedger.Value != null)
            {

                GridViewTemplate childview = new GridViewTemplate();
                childview.Caption = "Details";
                childview.DataSource = null;
                childview.DataSource = Source;
                this.radGridLedgerAccount.MasterTemplate.Templates.Add(childview);

                FormatChildView(childview);
                GridViewRelation relation = new GridViewRelation(this.radGridLedgerAccount.MasterTemplate);
                relation.ChildTemplate = childview;
                relation.ParentColumnNames.Add("months");
                relation.ChildColumnNames.Add("NameOfMonth");
                this.radGridLedgerAccount.Relations.Add(relation);

            }
        } 
```

# cordova - 使用 URL 启动浏览器的通用移动应用程序

> ID：14734857
> 
> 赞同：0
> 
> 时间：2013-02-06T17:12:25.810
> 
> 标签：cordova

我可以开发一个应用程序来启动带有 URL 的浏览器吗？我正在计划使用Phone Gap开发应用程序以支持IOS，Android和Windows Phone 8。请指导我提出宝贵的建议。这是我在 Mobile Project 的第一天。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-03T21:36:40.683

是的，你可以编写一个 iOS 应用程序，用特定的 URL 打开浏览器，但这几乎就是 PhoneGap 所做的，但没有浏览器 chrome（工具栏/URL 栏）所以......我认为 Phonegap 是你需要的 :)

# winrt-xaml - WinRT XAML 使用 Win8nl EventToCommandBehaviour 时如何获取文本框的当前文本

> ID：14734858
> 
> 赞同：0
> 
> 时间：2013-02-06T17:12:28.313
> 
> 标签：winrt-xaml

多年来，我一直试图弄清楚这一点，但我很困惑。

我有以下 XAML：

```
<TextBox x:Name="MyTextBox" Text="{Binding MyName, Mode=TwoWay}" Width="200">
            <WinRtBehaviors:Interaction.Behaviors>
                <Win8nl_Behavior:EventToCommandBehavior Event="TextChanged"  
                                                        Command="TextChangedCommand" 
                                                        CommandParameter="{Binding Text, ElementName=MyTextBox, Mode=OneWay}"/>
            </WinRtBehaviors:Interaction.Behaviors>

        </TextBox> 
```

在我的视图模型中：

```
 public ICommand TextChangedCommand
    {
        get
        {
            return new RelayCommand<string>((p) =>
            {
                var msg = new MessageDialog(string.Format("Hi there {0}", p));
                msg.ShowAsync();
            });
        }
    } 
```

但是我希望出现在 CommanParameter (p) 中的字符串值始终为空。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-15T18:36:44.870

您可以做的最好的事情是将文本值作为 CommandParameter 传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T01:25:40.450

行为不是可视树的一部分，因此它们无权访问 XAML 范围和执行 ElementName 绑定的能力。此[博客文章](http://julmar.com/blog/mark/?p=237)提供了更多详细信息和合适的解决方案。

# asp.net-mvc-4 - 动态添加 MVC4 显示模式

> ID：14734860
> 
> 赞同：0
> 
> 时间：2013-02-06T17:12:43.453
> 
> 标签：asp.net-mvc-4

在`Global.asax`中，我想根据我拥有的字符串数组动态添加多种显示模式，因此：

```
foreach (string displayModeId in myDisplayModeIds)
{
    modes.Insert(0, new DefaultDisplayMode(displayModeId)
        {
            ContextCondition = context =>
                context.Request["DisplayMode"] == displayModeId
        }
    );
} 
```

当然这不起作用，因为`displayModeId`需要在`ContextCondition`.

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:14:42.817

您可以在闭包中捕获它，这样它就不会在循环中从您身边跑开：

```
foreach (string displayModeId in myDisplayModeIds)
{
    string dmId = displayModeId;
    modes.Insert(0, new DefaultDisplayMode(displayModeId)
    {
        ContextCondition = context => context.Request["DisplayMode"] == dmId
    });
} 
```

# javascript - onLoad 事件在图像完成加载之前触发

> ID：14734866
> 
> 赞同：2
> 
> 时间：2013-02-06T17:12:56.100
> 
> 标签：javascript, jquery, onload

我在 JavaScript 中加载图像时遇到了一些问题。我希望按顺序加载一系列图像，即图像 2 仅在图像 1 完全完成加载时才开始加载。

我发现的问题是`onLoad`当图像完成加载时 JavaScript 方法不会触发，而是在图像开始加载时触发。因此，无论在队列中的哪个位置，最小的图像总是最先加载。我已经整理了[一个简单的例子来说明我](http://jsfiddle.net/Jm8MR/)在 JS fiddle 中的意思（HTML 和 JS 代码也在下面）。

有什么想法可以等到图像完全加载后再开始加载下一个图像-肯定不会那么难吗？

*注意：*我最初使用 jQuery`.load`函数编写它并得到相同的结果，这就是我在原始 JS 中搞砸的原因。

HTML 代码：

```
<ul>
    <li><img src="" alt="image 1" width="210" height="174"></li>
    <li><img src="" alt="image 2" width="210" height="174"></li>
    <li><img src="" alt="image 3" width="210" height="174"></li>
    <li><img src="" alt="image 4" width="210" height="174"></li>
    <li><img src="" alt="image 5" width="210" height="174"></li>
</ul>

<a href="#" id="loader">Load the images</a> 
```

JS代码：

```
 var imgArr = [
        "http://media.topshop.com/wcsstore/ConsumerDirectStorefrontAssetStore/images/colors/color7/cms/pages/static/static-0000038166/images/zine-HP-UK.jpg",
        "http://media.topshop.com/wcsstore/ConsumerDirectStorefrontAssetStore/images/colors/color7/cms/pages/static/static-0000038166/images/Valentine_UK.jpg",
        "http://media.topshop.com/wcsstore/ConsumerDirectStorefrontAssetStore/images/colors/color7/cms/pages/static/static-0000038166/images/crop_UK__.jpg",
        "http://media.topshop.com/wcsstore/ConsumerDirectStorefrontAssetStore/images/colors/color7/cms/pages/static/static-0000038166/images/hitlist_UK--.jpg",
        "http://media.topshop.com/wcsstore/ConsumerDirectStorefrontAssetStore/images/colors/color7/cms/pages/static/static-0000038166/images/chinese_new_year_UK_new_0402.jpg"
    ],
    totalImgs = imgArr.length,
    count = 0;

    function onLoaded(count) {
        console.log("fired onload "+count);
        var currentImg = $('li:eq('+count+') img');
        currentImg.attr('src', imgArr[count]).css('display','block');
        count++;
        if (count < totalImgs) {
            loadImg(count);
        };
    }

    function loadImg(count) {
        imgObj = new Image()
        imgObj.src = imgArr[count];
        imgObj.onLoad = onLoaded(count);                        
    }

    $('#loader').click(function() {
        loadImg(count);
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T17:16:15.997

这里的问题是，没有将处理函数分配给 的`onload`事件，`Image`而是 的返回值`onLoaded`。您需要说`imgObj.onload = onLoaded;`For the `currentImg`you can use `this`as 将在`Image`对象上调用处理程序。对于传递其他参数，需要另一种方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-17T05:41:12.147

看到 2 多年前有人问过这个错误，我确信你已经摆脱了这个错误；尽管如此，我认为为了他人的利益，我会指出我认为是你的错误。

您正在使用`imgObj.onLoad`而不是`imgObj.onload`. Javascript 区分大小写，并且没有原生的“onLoad”事件。

修复此问题后，其余代码应该可以正常工作。

# android - 崩溃日志中没有命名异常

> ID：14734869
> 
> 赞同：0
> 
> 时间：2013-02-06T17:12:58.853
> 
> 标签：android

我的应用程序在进行更新时崩溃了，但它没有告诉我异常是什么，只有一个空白，它通常会打印异常，这里是 logcat：

```
02-06 04:00:21.306 E/AndroidRuntime( 5582):     at com.myapp.services.MonthUpdateService.processIntent(MonthUpdateService.java:167)
02-06 04:00:21.306 E/AndroidRuntime( 5582):     at com.myapp.services.UpdateService.onHandleIntent(UpdateService.java:215)
02-06 04:00:21.353 I/ActivityManager(17864): Process com.myapp (pid 5582) has died.
02-06 04:00:21.353 W/ActivityManager(17864): Scheduling restart of crashed service com.myapp/.services.MonthUpdateService in 42414ms
02-06 04:05:29.853 I/ActivityManager(17864): Start proc com.myapp for service com.myapp/.services.MonthUpdateService: pid=5718 uid=10090 gids={3003, 1028}
02-06 04:05:46.009 E/AndroidRuntime( 5718):     at com.myapp.services.MonthUpdateService.processIntent(MonthUpdateService.java:167)
02-06 04:05:46.009 E/AndroidRuntime( 5718):     at com.myapp.services.UpdateService.onHandleIntent(UpdateService.java:215)
02-06 04:05:46.032 I/ActivityManager(17864): Process com.myapp (pid 5718) has died.
02-06 04:05:46.032 W/ActivityManager(17864): Service crashed 2 times, stopping: ServiceRecord{42be7440 com.myapp/.services.MonthUpdateService} 
```

它崩溃的代码：

```
catch( IOException e )
{
    //TODO Schedule a retry for IO Exception.
    Log.w( TAG,  e.getMessage() ); // LINE 167
} 
```

我想它一定是 a`NullPointerException`但这没有任何意义，因为`e`如果它到达那条线就不能为空，对吧？不过，更重要的问题是为什么日志中没有打印异常？

# c# - NHibernate 的 WCF 服务中的问题

> ID：14734871
> 
> 赞同：0
> 
> 时间：2013-02-06T17:13:03.040
> 
> 标签：c#, wcf, nhibernate

我正在尝试使用 Fluent NHibernate 和 WCF 创建一个服务层。如何使用 LazyLoad？例如，我会得到一些对象。该对象包含一个用 LazyLoad 映射的集合。所以，我的服务方法创建一个会话，检索对象并关闭会话。懒惰的收集呢？我的服务调用者不会访问数据，因为我没有打开的会话。如何治疗？

多谢你们！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:45:35.150

如果您连接到数据库，则只能使用 NHibernate 的延迟加载。

如果您想坚持使用 NHibernate 并通过 WCF 访问您的数据，您需要切换到预加载。

如果你愿意放弃 WCF，你可以让你的客户直接访问数据库。

如果您愿意放弃 Nhiberhate，您可以使用 WCF 数据服务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:52:31.450

延迟加载会发生，但它会在您的返回值被序列化为 WCF 响应时发生。例如，我们有这些类：

```
[DataContract]
public class Person
{
    [DataMember]
    public virtual string Name { get; set; }

    [DataMember]
    public virtual Address Address { get; set; }
}

[DataContract]
public class Address
{
} 
```

假设这`Person.Address`是懒惰的。您查询一个人，而不加载他的地址，并希望将此对象返回给客户端。

输入 WCF。WCF 将序列化所有的`[DataMember]`s，并且`Address`是其中之一。因此将调用 getter，如果您仍在您的`using (ISession)`范围内，它将执行延迟加载。如果您不使用`using`范围而只是定义一个变量`ISession`（您可能不会关闭），那么惰性查询也将执行。

# android - 复制 xml 代码时解析 XML 文件时出错

> ID：14734873
> 
> 赞同：0
> 
> 时间：2013-02-06T17:13:05.460
> 
> 标签：android, android-layout

我正在尝试创建横向布局，当我从纵向布局复制代码时出现错误：

解析 XML 时出错：未找到对象。

此错误出现在下面代码的第一行。

```
**?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#8B4513"
    android:orientation="vertical" >
    <TextView
        android:id="@+id/label1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:layout_marginTop="20dp"
        android:background="#2F4F4F"
        android:gravity="center"
        android:text="@string/rect"
        android:textAppearance="?android:attr/textAppearanceMedium" />
    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="#8B4513"
        android:orientation="horizontal" >
        <TextView
            android:id="@+id/label2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="30dp"
            android:layout_marginTop="50dp"
            android:background="#2F4F4F"
            android:gravity="center"
            android:text="@string/cm"
            android:textAppearance="?android:attr/textAppearanceMedium" />
        <EditText
            android:id="@+id/TextField1"
            android:layout_width="110dp"
            android:layout_height="21dp"
            android:layout_marginLeft="40dp"
            android:layout_marginTop="50dp"
            android:background="#2F4F4F"
            android:ems="10"
            android:gravity="center"
            android:inputType="text" />
   </LinearLayout>   
    </LinearLayout>** 
```

请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T18:10:30.547

**创建一个新布局并复制：**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/label1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center_horizontal"
        android:layout_marginTop="20dp"
        android:background="#2F4F4F"
        android:gravity="center"
        android:text="hello"
        android:textAppearance="?android:attr/textAppearanceMedium" />
    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="#8B4513"
        android:orientation="horizontal" >

        <TextView
            android:id="@+id/label2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="30dp"
            android:layout_marginTop="50dp"
            android:background="#2F4F4F"
            android:gravity="center"
            android:text="cm"
            android:textAppearance="?android:attr/textAppearanceMedium" />

        <EditText
            android:id="@+id/TextField1"
            android:layout_width="110dp"
            android:layout_height="21dp"
            android:layout_marginLeft="40dp"
            android:layout_marginTop="50dp"
            android:background="#2F4F4F"
            android:ems="10"
            android:gravity="center"
            android:inputType="text" />
   </LinearLayout>   

</LinearLayout> 
```

# .htaccess - URL 中的 & 和号

> ID：14734878
> 
> 赞同：1
> 
> 时间：2013-02-06T17:13:24.530
> 
> 标签：.htaccess, url, url-rewriting

我想弄清楚如何在 url 中使用 & 符号。

在这里看到它：http: [//www.indeed.co.uk/B&Q-jobs](http://www.indeed.co.uk/B&Q-jobs)我想做类似的事情。

不完全确定访问 url 时服务器将调用什么。

有没有办法使用 .htaccess 获取这样的请求并重写到特定文件？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T22:21:02.173

与号通常用于查询字符串。查询字符串是 URL 末尾的一个或多个变量，页面用于呈现内容、跟踪信息等。查询字符串通常如下所示：

```
http://www.website.com/index.php?variable=1&variable=2 
```

请注意 URL 中文件扩展名之后的第一个特殊字符是`?`. 这指定了查询字符串的开始。

在您的示例中，没有`?`，因此没有启动查询字符串。根据[RFC 1738](http://www.faqs.org/rfcs/rfc1738.html)，除了指定用途（将查询字符串中的变量链接在一起）之外，与号不是有效的 URL 字符，因此您提供的链接在技术上是无效的。

绕过这种无效性的方法以及可能发生的事情是重写。重写通知服务器根据模式或匹配显示特定文件。例如，可能适用于您的示例的 .htaccess 重写规则可能是：

```
RewriteEngine on
RewriteRule ^/?B&Q-(.*)$ /scripts/b-q.php?variable=$1 [NC,L] 
```

此规则将查找任何以 开头的 URL`http://www.indeed.co.uk/B&Q-`并显示其内容`http://www.indeed.co.uk/scripts/b-q.php?variable=jobs`。

有关 Apache 重写规则的更多信息，请查看其[官方文档](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)。

最后，我建议不要在 URL 中使用与号，即使在进行重写时也是如此，除非它们是查询字符串的一部分。URL 中的 & 符号的目的是在查询字符串中将变量串在一起。出于该目的使用它是不正确的，并且可能会在将来引起混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T22:08:32.137

像这样编码的 URI`/B&Q-jobs`被发送到服务器：`/B%26Q-jobs`. 但是，当它通过重写引擎发送时，URI 已经被解码，因此您希望实际匹配`&`字符：

```
Rewrite ^/?B&Q-jobs$ /a/specific/file.html [L] 
```

这使得当有人请求时`/B&Q-jobs`，他们实际上得到了内容`/a/specific/file.html`。

# c# - 以编程方式保护配置部分

> ID：14734879
> 
> 赞同：3
> 
> 时间：2013-02-06T17:13:29.823
> 
> 标签：c#, encryption, configuration, configuration-files

我一直在尝试编写一个工具来使用 RsaProtectedConfigurationProvider 来保护我的应用程序的 connectionStrings 设置。虽然有很多关于使用 aspnet_regiis.exe 命令行进行管理的教程，但我在通过 ConfigurationManager API 执行这些方面还没有发现太多。

也就是说，我对以**编程**方式管理它有几个问题：

1.  您可以指定使用机器或用户级别的密钥吗？
2.  你能识别并导出你正在使用的密钥吗？
3.  加密似乎需要手动授予用户对 C:\ProgramData\Microsoft\Crypto\RSA\MachineKeys （[source](http://www.infralution.com/phpBB2/viewtopic.php?p=7479&sid=54e0f41a9fdad587656b473b76256abc)）的访问权限。为什么？

先感谢您。

# java - 为 AWS Spot 实例请求实施幂等性

> ID：14734882
> 
> 赞同：6
> 
> 时间：2013-02-06T17:13:31.580
> 
> 标签：java, amazon-web-services, amazon-ec2

我正在使用 Java AWS SDK 发出 EC2 现货实例请求。与按需实例相反，[Spot 请求的 API](http://docs.aws.amazon.com/AWSEC2/latest/APIReference/ApiReference-query-RequestSpotInstances.html)没有任何类似的东西[`ClientToken`](http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Run_Instance_Idempotency.html)，因此不支持开箱即用的幂等性。

我能想到的最直接的方法是将`LaunchGroup`属性设置为唯一的 UUID；当我检查时，我打电话[`DescribeSpotInstanceRequests`](http://docs.aws.amazon.com/AWSEC2/latest/APIReference/ApiReference-query-DescribeSpotInstanceRequests.html)，看看我是否已经有同一个启动组的请求。

令我惊讶的是，在描述调用返回之前发送的现场请求之前似乎存在延迟。我为此编写了一个 JUnit 测试，似乎为了使其保持一致，我必须在两次调用之间设置至少 60 秒的超时时间（请求现场实例和描述现场实例请求）。我需要有 10 秒的粒度，因为我的请求可以在此时间间隔内被应用程序重复，以防出现任何故障 - 即在我发送请求后但在我读取从亚马逊返回的结果之前出现了中断。在这种情况下，我不想重复请求，我只想看到它已注册并继续前进。

```
@Test
public void testRunSpotInstances() throws Exception {

    activity.execute(execution);

    timeout(TIMEOUT);

    // shouldn't do anything
    activity.execute(execution);

    timeout(TIMEOUT);

    DescribeSpotInstanceRequestsResult result = client.describeSpotInstanceRequests(
            new DescribeSpotInstanceRequestsRequest().withFilters(new Filter()
                .withName("launch-group").withValues(BUSINESS_KEY)));

    assertThat(result.getSpotInstanceRequests()).hasSize(1);

    timeout(TIMEOUT);
} 
```

如果TIMEOUT设置为60s，则每次测试都有效；对于 40-50 秒，它会间歇性地工作。低于此的任何东西每次都会失败。

有没有人设法解决这个延迟？是否可以仅使用 AWS API 而不在客户端应用程序中保存状态来实现点请求的幂等性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-23T21:50:31.397

> 在这种情况下，我不想重复请求，我只想看到它已注册并继续前进。

如果你有一个 200 回来，那么它已经注册。它可能不会立即显示，但它已注册，您可以继续您的流程。

> 是否可以仅使用 AWS API 而不在客户端应用程序中保存状态来实现点请求的幂等性？

我不相信。我对亚马逊的 EMR 也有同样的问题。我解决它的方法是让一个组件负责观察集群。当我请求 EMR 集群时，我会返回一个集群 ID，然后将其传递给某个观察者。然后，当该集群更改状态时，观察者将调用我的其他组件。没有立即被 EMR 确认是一个有效的案例，不被视为例外。

我不知道这是否适合你。也许您可以尝试维护[SpotInstanceRequestId](http://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/ec2/model/SpotInstanceRequest.html#getSpotInstanceRequestId%28%29)。就我而言，我只将它们保存在内存中，但如果需要，您可以将它们持久保存在某个地方。

# visual-studio-2010 - 为什么当我将“生成调试信息”设置为“无”时，VB.Net 的 Visual Studio 2010 编译器仍会在我的 bin 文件夹中生成 pdb 文件

> ID：14734883
> 
> 赞同：2
> 
> 时间：2013-02-06T17:13:35.373
> 
> 标签：visual-studio-2010, compilation, pdb-files

1.  从 Project/bin 文件夹中删除所有 pdb 文件。
2.  在项目设置 -> Compi9le -> 高级中，将“生成调试信息”设置为“无”（而不是仅 pdb）。
3.  重新编译项目（在发布模式下，生成调试信息 == 无）。
4.  Visual Studio 在我的项目的 bin 文件夹中创建 pdb 文件，即使 Generate debug info 仍然是 None。

为什么？以及如何让 Visual Studio 停止生成这些 pdb 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:17:06.633

你确定你已经改变了它以获得正确的构建配置。例如。您为 Release 更改了它，但您正在调试下编译？

# ios - 使用 SDL 1.3 在 iOS 6.1 上返回键错误注册为“p”或“l”

> ID：14734885
> 
> 赞同：1
> 
> 时间：2013-02-06T17:13:36.603
> 
> 标签：ios, uikit, uitextfield, sdl

我在 iOS 6.1（在 iPad mini 上）上使用 SDL 1.3。然而，当我按下回车键时，它有时会被误读为“p”或“l”。

如果我将键盘更改为另一种语言并再次返回美国英语，问题就会消失，并且当我按下回车键时，我永远不会看到输入“p”或“l”。

我实际上可以看到“p”键被突出显示，即使我按下了返回键。任何人都可以建议修复或解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T06:29:38.993

我找到了解决这个问题的方法，我的文章在这里，部分是我对 SDL 的攻击：

[http://41j.com/blog/2013/02/iphone-sdl-1-3-sdl2-keyboard-disappearing-and-misregistration-issues/](http://41j.com/blog/2013/02/iphone-sdl-1-3-sdl2-keyboard-disappearing-and-misregistration-issues/)

# doctrine-orm - 可能的数据库配置问题

> ID：14734888
> 
> 赞同：0
> 
> 时间：2013-02-06T17:13:43.470
> 
> 标签：doctrine-orm, zend-framework2

我是一个新的 Zend 开发人员，我遇到了一些概念问题（尤其是在教义方面）。

我有一个名为 MyAuthenticationProcess 的类。此类试图通过在数据库上验证用户身份来验证用户身份。

正如我在互联网上看到的，为了与我的数据库通信，我应该实现 3 件事。

首先，我必须在我的 module.config.php 中添加这些行

```
'doctrine' => array(
    'driver' => array(
            __NAMESPACE__. '_driver' => array(
                    'class' => 'Doctrine\ORM\Mapping\Driver\AnnotationDriver',
                    'cache' => 'array',
                    'paths' => array(__DIR__ . '/../src/' . __NAMESPACE__ . '/Entity')
            ),
            'orm_default' => array(
                'drivers' => array(
                    __NAMESPACE__.'\Entity' => __NAMESPACE__.'_driver'      
                )       
            )   
    )       
), 
```

其次，我必须创建一个包含我的实体的文件。我在 Authentification/Entity/User.php 中创建了这个文件

这是这个文件的代码：

```
<?php
namespace Authentification\Entity;

use Doctrine\ORM\Mapping as ORM;
use Zend\InputFilter\InputFilter;
use Zend\InputFilter\Factory as InputFactory;
use Zend\InputFilter\InputFilterAwareInterface;
use Zend\InputFilter\InputFilterInterface;

   /**
 * A User table.
 *
 * @ORM\Entity
 * @ORM\Table(name="user")
 * @property string $login
 * @property string $password
 * @property int $id
 */

class User {

/**
 * @ORM\Id
 * @ORM\Column(type="integer");
 * @ORM\GeneratedValue(strategy="AUTO")
 */
protected $id;
/**
 * @ORM\Column(type="string")
 */
protected $login;

/**
 * @ORM\Column(type="string")
 */
protected $password;

/**
 * Magic getter to expose protected properties.
 *
 * @param string $property
 * @return mixed
 */
public function __get($property)
{
    return $this->$property;
}

/**
 * Magic setter to save protected properties.
 *
 * @param string $property
 * @param mixed $value
 */
public function __set($property, $value)
{
    $this->$property = $value;
}

}
?> 
```

最后，我将此配置添加到此文件中：config/autoload/local.php

```
 <?php

return array(

    'doctrine' => array(
        'connection' => array(
            'orm_default' => array(
                'driverClass' => 'Doctrine\DBAL\Driver\PDOMySql\Driver',
                'params' => array(
                    'host' => 'localhost',
                    'port' => '3306',
                    'user' => 'root',
                    'password' => '',
                    'dbname' => 'zf2tutorial',
                )
            )
        )
    ),
); 
```

我现在遇到的问题是访问我的数据库。估计是配置问题。

在我的 MyAuthenticationProcess 类中，我试图获取我的表“用户”的所有条目。但我不能。

这是我以前这样做的代码：

```
 $users = $this->getEntityManager()->getRepository('Authentification\Entity\User')->findAll()   ;
    var_dump($users) ; 
```

这是我得到的错误：

```
<br />
<b>Fatal error</b>:  Uncaught exception 'Zend\View\Exception\RuntimeException' with message 'Zend\View\Renderer\PhpRenderer::render: Unable to render template &quot;layout/layout&quot;; resolver could not resolve to a file' in xampp\htdocs\kjsencha\vendor\zendframework\zendframework\library\Zend\View\Renderer\PhpRenderer.php:457
Stack trace:
#0 xampp\htdocs\kjsencha\vendor\zendframework\zendframework\library\Zend\View\View.php(201): Zend\View\Renderer\PhpRenderer-&gt;render(Object(Zend\View\Model\ViewModel))
#1 xampp\htdocs\kjsencha\vendor\zendframework\zendframework\library\Zend\Mvc\View\Http\DefaultRenderingStrategy.php(126): Zend\View\View-&gt;render(Object(Zend\View\Model\ViewModel))
#2 [internal function]: Zend\Mvc\View\Http\DefaultRenderingStrategy-&gt;render(Object(Zend\Mvc\MvcEvent))
#3 xampp\htdocs\kjsencha\vendor\zendframework\zendframework\library\Zend\EventManager\EventManager.php(460): call_user_func(Array, Object(Zend\Mvc\MvcEvent)) in <b>\xampp\htdocs\kjsencha\vendor\zendframework\zendframework\library\Zend\View\Renderer\PhpRenderer.php</b> on line <b>457</b><br /> 
```

为了确保这是配置问题，我尝试使用以下方法了解连接是否已建立：

```
 $users = $this->getEntityManager()->getConnection()   ;
    var_dump($users) ; 
```

我很惊讶地看到用户等于 NULL。

你知道问题出在哪里吗？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T09:14:57.100

我终于找到了我的问题来自哪里=D

这是我数据库中的表结构。它与我的实体文件不相似，因此我对其进行了更改，现在它可以工作了。

希望我的帖子能帮助遇到同样问题的其他人。

# asp.net-mvc-3 - Html.DisplayFor （或其他 htmlhelpers ）

> ID：14734889
> 
> 赞同：1
> 
> 时间：2013-02-06T17:13:44.193
> 
> 标签：asp.net-mvc-3, razor

我有一个可能很基本的问题，但我真的不明白。所以它来了。

如果我有一个视图模板文件 ( .cshtml ) 并且有这样的代码行：

```
@Html.DisplayFor(m => m.CurrentPage.MainBody) 
```

如果我查看 DisplayFor 的声明，它看起来像这样：

```
public static MvcHtmlString DisplayFor<TModel, TValue>(this HtmlHelper<TModel> html,      Expression<Func<TModel, TValue>> expression); 
```

因此，这是一个采用 Expression 参数的扩展方法，但 TModel 和 TValue 似乎是通用的（显然您可以将 lambda 表达式发送到 Expression）。

这里的 lambda 表达式（ m => m.CurrentPage.MainBody ）怎么知道 m 是什么？

如果我有这样的 lamdba 表达式：

```
int[] numbers = { 5, 4, 1, 3, 9, 8, 6, 7, 2, 0 };
int oddNumbers = numbers.Count(n => n % 2 == 1); 
```

那么 (n => n % 2 == 1) 的上下文是逻辑的，lamdba 表达式用于计算每个元素的数字。

但是在上面的情况下，@Html.DisplayFor(m => m.CurrentPage.MainBody) 这里的上下文是什么？m 指的是什么？在这个特定的视图中，这是否以某种方式“神奇地”连接到@model？（在这种情况下是`@model PageViewModel<ArticlePage>`“）。

总而言之，表达式 ( m => m.CurrentPage.MainBody ) 中的 m 指的是什么？是否假定它以某种方式通过@model 引用视图中提供的模型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-06T17:18:25.650

> 这里的 lambda 表达式（ m => m.CurrentPage.MainBody ）怎么知道 m 是什么？

Html.DisplayFor 帮助器定义如下：

```
public static MvcHtmlString DisplayFor<TModel, TValue>(
    this HtmlHelper<TModel> html, 
    Expression<Func<TModel, TValue>> expression
)
{
    ...
} 
```

注意这个帮助器**只能**在强类型上调用`HtmlHelper<TModel>`。如果您没有带有模型的强类型视图，则不能使用`Html.DisplayFor`帮助程序，因为`Html`您在其上调用此扩展方法是简单的`HtmlHelper`而不是`HtmlHelper<TModel>`.

因此，当您有模型时，在您的视图中：

```
@model MyViewModel 
```

Html 属性是类型`HtmlHelper<MyViewModel>`，因此 DisplayFor 助手知道您的模型。

基本上，当您有一个强类型视图时，`Html.DisplayFor(m => m.CurrentPage.MainBody)`编译`Html.DisplayFor<MyViewModel, TheTypeOfYourMainBodyProperty>(m => m.CurrentPage.MainBody)`器可以从上下文中推断出通用参数，而您不需要显式地编写它们。

# java - Java按值传递还是按引用传递？

> ID：14734897
> 
> 赞同：0
> 
> 时间：2013-02-06T17:14:13.427
> 
> 标签：java, function, parameter-passing

我进行了 3 次测试以检查位图是按值传递还是按引用传递，但在运行以下代码后感到困惑：

```
public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    V v = new V(this);
    setContentView(v);
}

class V extends View{
    Bitmap b1;
    Bitmap b2;

    public V(Context context) {
        super(context);
        //load bitmap1
        InputStream is = getResources().openRawResource(R.drawable.missu);
        b1 = BitmapFactory.decodeStream(is);
        //testing start
        b2 = b1;
        //b1 = null; 
        //1.test if b1 and b2 are different instances
        if(b2 == null){
            Log.d("","b2 is null");
        }
        else{
            Log.d("","b2 still hv thing");
        }
        //2.test if b2 is pass by ref or value
        test(b2);
        if(b2 == null){
            Log.d("","b2 is null00");
        }
        else{ 
            Log.d("","b2 still hv thing00");
        }
                    //3.want to further confirm test2
        b2 = b2.copy(Config.ARGB_8888, true);
                    settpixel(b2); 
        if(b2.getPixel(1, 1) == Color.argb(255,255, 255, 255)){
            Log.d("","b2(1,1) is 255");
        }
        else{
            Log.d("","b2(1,1) is not 255");
        }
    }

    void test(Bitmap b){
        b = null;
    }
    void settpixel(Bitmap b){
        b.setPixel(1, 1, Color.argb(255,255, 255, 255));
    }
}} 
```

结果：

*   b2 仍然是高压的东西

*   b2 仍然是 hv thing00

*   b2(1,1) 是 255

问题是测试 2 和 3 相互矛盾。test2 表明 b2 是按值传递的，因为 b2 没有变为空。但是如果位图是按值传递的，那么在 test3 中，setPixel() 应该在 b2（函数范围内的那个）的副本上工作，但是为什么 b2（外部范围）会改变它的像素值？ps 加载的位图是深红色的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:22:45.487

这与 Java 的工作方式有关，而不是 Android 或 Bitmap 的工作方式。Java按*值传递**引用*。更详尽的解释可以在[http://www.javaworld.com/javaqa/2000-05/03-qa-0526-pass.html找到](http://www.javaworld.com/javaqa/2000-05/03-qa-0526-pass.html)

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:28:08.047

**JAVA 始终传递价值**

每次将变量传递给 java 的函数时，您都在复制它的引用，而当您从 java 中的函数获得结果时，`return`它就是对象引用的新副本。

`test()`现在这里是您的功能如何工作的逐步说明：

*   当你通过 b2 throw 调用 test(b2); 您将获得对 b2 对象 b 的新引用。
*   然后将该引用设置为 null。您不会影响范围之外的引用，因为无论如何您都无法访问它。

希望有帮助。请看一下这个详细的问题：

[Java 是“按引用传递”还是“按值传递”？](https://stackoverflow.com/questions/40480/is-java-pass-by-reference)*

# magento - 在不覆盖的情况下向 OPC 添加步骤：更新部分

> ID：14734898
> 
> 赞同：1
> 
> 时间：2013-02-06T17:14:14.677
> 
> 标签：magento, layout, checkout, observers

[所以这是](https://stackoverflow.com/questions/14607492/add-step-to-opc-without-overriding)这个问题的后续问题。
我在观察者的运输方法之前添加了一个步骤。我在获取用于更新步骤选项卡内容的 html 时遇到问题。尽管我尽了最大努力，它仍然加载运输方法步骤的 html 而不是我想要的 html。
这是观察者的代码：

```
public function gotoViesStep($observer)
{
    $response = $observer->getEvent()->getControllerAction()->getResponse();
    $body = $response->getBody();
    $result = Mage::helper('core')->jsonDecode($body);

    if (in_array('error', $result)) {
        return;
    }

    //if conditions are met, go to vies check
    if ($result['goto_section'] == 'shipping_method') {
        $quote = Mage::getSingleton('checkout/session')->getQuote();
        $shippingAddress = $quote->getShippingAddress();
        $countryId = $shippingAddress->getCountryId();

        if (($countryId != 'BE') && ($this->_countryInEU($countryId))) {
            $result['goto_section'] = 'vies';
            $result['allow_sections'][] = 'vies';
            $result['country_id'] = $countryId;

            $result['update_section'] = array(
                    'name' => 'vies',
                    'html' => $this->_getViesHtml()
                );

            $response->setBody(Mage::helper('core')->jsonEncode($result));
        }
    }
}

protected function _getViesHtml()
{
    $layout = Mage::getSingleton('core/layout');
    $update = $layout->getUpdate();
    $update->load('checkout_onepage_vies');
    $layout->generateXml();
    $layout->generateBlocks();
    $output = $layout->getOutput();
    return $output;
} 
```

以及该句柄的 layout.xml `checkout_onepage_vies`：

```
<checkout_onepage_vies>
    <remove name="right"/>
    <remove name="left"/>

    <block type="correctionvat/onepage_vies" name="root" output="toHtml" template="correctionvat/onepage/vies.phtml"/>
</checkout_onepage_vies> 
```

如果我直接放东西而不是尝试加载块，它就可以工作。IE，如果，而不是`'html' => $this->_getViesHtml()`I do `'html' => 'foobar'`，步骤的内容是`foobar`.

因此，就像 OnepageController 已经对输出/布局/块收费一样，我再次对其重新收费的尝试失败了。
有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T19:34:59.947

您面临的问题与添加的布局句柄列表有关。您需要在调用`load()`方法之前重置它们。`resetUpdates()`您还需要通过调用方法重置包含先前解析的 xml 的更新数组。

最后你`getViesHtml()`应该如下所示：

```
protected function _getViesHtml()
{
    $layout = Mage::getSingleton('core/layout');

    $layout->getUpdate()
         ->resetHandles()
         ->resetUpdates()
         ->load('checkout_onepage_vies');

    $layout->generateXml()
         ->generateBlocks();

    $output = $layout->getOutput();
    return $output;
} 
```

# php - jquery拖放与数据库

> ID：14734899
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:14:17.673
> 
> 标签：php, jquery, mysql, drag-and-drop

我正在处理拖放并将 ID 号存储在数据库中，我刚刚完成了这项工作，并且在所有浏览器中都运行良好，但问题是在 IE 8 或 9 中不起作用。

问题是在 IE 中不允许我拖动或移动那个我无法弄清楚如何解决这个问题的问题，并且浏览器的其余部分工作正常。

这是jQuery代码

```
<script type="text/javascript">
$(document).ready(function(){  
   function slideout(){
  setTimeout(function(){
  $("#response").slideUp("slow", function () {
      });

}, 2000);}

    $("#response").hide();
 $(function() {
 $("#list ul").sortable({ opacity: 0.8, cursor: 'move', update: function() {

 var order = $(this).sortable("serialize") + '&update=update'; 
 $.post("updateList.php", order, function(theResponse){
 $("#response").html(theResponse);
 $("#response").slideDown('slow');
 slideout();
 });   
 }   
 });
 });

}); 
</script> 
```

身体代码是

```
 <div id="response"> </div>
    <ul>
      <?php
                include("connect.php");
 $query  = "SELECT id, text FROM dragdrop ORDER BY listorder ASC";
 $result = mysql_query($query);
 while($row = mysql_fetch_array($result, MYSQL_ASSOC))
 {

 $id = stripslashes($row['id']);
 $text = stripslashes($row['text']);

 ?>
      <li id="arrayorder_<?php echo $id ?>"><?php echo $id?> <?php echo $text; ?>
        <div class="clear"></div>
      </li>
      <?php } ?>
    </ul>
  </div>
</div> 
```

任何人都可以帮我解决如何为 IE 进行拖放，如果有其他示例可以支持所有浏览器！

是

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:24:50.113

根据@jheilgeist 的说法，在 div 上添加 position:relative 会对其进行排序，即使它的行为有点奇怪。

它看起来像那些浏览器中的 jQuery UI 错误。

在此处查看更多信息：http: [//bugs.jqueryui.com/ticket/7546](http://bugs.jqueryui.com/ticket/7546)

# logic-programming - 将文件中的数据记录程序加载到 pyDatalog

> ID：14734901
> 
> 赞同：1
> 
> 时间：2013-02-06T17:14:20.717
> 
> 标签：logic-programming, pydatalog

我正在尝试使用 pyDatalog.load() 方法来加载一个小的 pyDatalog 程序。例如，我正在从[https://sites.google.com/site/pydatalog/加载阶乘样本](https://sites.google.com/site/pydatalog/)

```
from pyDatalog import pyDatalog
pyDatalog.create_atoms('factorial, N, F') # gives datalog capability to these words

def run_program():

    N = pyDatalog.Variable()
    F = pyDatalog.Variable()
    file_in = open("sample_datalog_program.dl", 'r')
    mc = file_in.read()
    print mc
    @pyDatalog.program()
    def _(): # the function name is ignored
        pyDatalog.load(mc)
        #pyDatalog.load("""
        #+ (factorial[1]==1)
        #(factorial[N] == F) <= (N > 1) & (F == N*factorial[N-1])
        #""")
        print(pyDatalog.ask('factorial[4]==F'))
    file_in.close()
    pass

if __name__ == "__main__":
    run_program() 
```

文件 sample_datalog_program.dl 包含以下内容：

```
"""
+ (factorial[1]==1)
(factorial[N] == F) <= (N > 1) & (F == N*factorial[N-1])
""" 
```

我究竟做错了什么？当我用接下来的 4 条注释行替换 pyDatalog.load(mc) 行时，它工作正常。

我得到的错误是：

```
 /usr/local/Cellar/python/2.7.3/Frameworks/Python.framework/Versions/2.7/bin/python2.7    run_datalog_program.py
pyDatalog version 0.12.0
Traceback (most recent call last):
  File "run_datalog_program.py", line 25, in <module>
    run_program()
  File "run_datalog_program.py", line 11, in run_program
    @pyDatalog.program()
  File "/usr/local/lib/python2.7/site-packages/pyDatalog/pyParser.py", line 191, in   add_program
    load(source_code, newglobals, defined, function=func_name)
  File "/usr/local/lib/python2.7/site-packages/pyDatalog/pyParser.py", line 154, in load
six.exec_(code, newglobals)
  File "/usr/local/lib/python2.7/site-packages/six.py", line 308, in exec_
    exec("""exec code in globs, locs""")
  File "<string>", line 1, in <module>
  File "_", line 1, in <module>
  File "/usr/local/lib/python2.7/site-packages/pyDatalog/pyDatalog.py", line 115, in load
    return pyParser.load(code)
  File "/usr/local/lib/python2.7/site-packages/pyDatalog/pyParser.py", line 133, in load
    spaces = r.match(line).group()
TypeError: expected string or buffer
"""
+ (factorial[1]==1)
(factorial[N] == F) <= (N > 1) & (F == N*factorial[N-1])
"""

Process finished with exit code 1 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T19:00:32.103

您不应混合使用 pyDatalog.load() API 和内联 API。请参阅[动态数据记录语句](https://sites.google.com/site/pydatalog/Datalog-in-python)（在页面底部）

以下是编写程序的方法：

```
from pyDatalog import pyDatalog

def run_program():

    file_in = open("sample_datalog_program.dl", 'r')
    mc = file_in.read()
    print mc
    pyDatalog.load(mc)
    file_in.close()
    print(pyDatalog.ask('factorial[3]==N'))

if __name__ == "__main__":
    run_program() 
```

sample_datalog_program.dl 中的代码应该是（不带三引号）：

```
+ (factorial[1]==1)
(factorial[N] == F) <= (N > 1) & (F == N*factorial[N-1]) 
```

# sql - 如何将事件处理程序中的执行 SQL 任务排除在父事务之外？

> ID：14734902
> 
> 赞同：0
> 
> 时间：2013-02-06T17:14:22.490
> 
> 标签：sql, sql-server-2008, ssis

我在 SSIS 中使用 SQL 事务，我必须*`Execute SQL Task`*启动、提交和回滚我的事务。所有事务任务都在一个*`Sequence Container`*. 我在包级别事件中执行错误处理并将错误记录到单独的数据库中。我遇到的问题是，当任何组件失败时，它会跳转到事件处理程序，但是当事务回滚时，它也会回滚错误日志记录。

错误日志记录发生在*事件处理程序**`Execute SQL Task`*内部

 *是否可以在 my 上明确指定*`Execute SQL Task`*它不是事务的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:19:29.113

建议您使用SSIS 事务处理。在序列容器上将 TransactionOption 设置为“必需”，在子任务上将其设置为“支持”。在 On Error 事件处理程序上将 TransactionOption 设置为 NotSupported，以便它在序列容器的事务之外起作用。

希望这会有所帮助，彼得*

# java - reducer 数量对集群节点数量的依赖性

> ID：14734903
> 
> 赞同：0
> 
> 时间：2013-02-06T17:14:25.800
> 
> 标签：java, linux, hadoop, mapreduce, reducers

我的 hadoop 程序使用一个映射器，它将输入数据分成一定数量的部分，这些部分在`/usr/countcomputers.txt`文件中设置（由映射器函数读取）。进一步在一个部分到达每个减速器。因此，在`/usr/countcomputers.txt`文件中设置的数字定义了减速器的数量。在这方面我有一个问题：reducers 仅在启动 TaskTracker 的恶魔的计算机上执行，或者在所有节点上执行，包括由 JobTracker 和 Secondary NameNode 启动的 NameNode 的哪些恶魔？对我来说，知道对这个问题的回答非常重要，因为`/usr/countcomputers.txt`文件中设置的数字取决于它，在程序中读取。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:27:32.373

只允许 tasktracker 运行 reducer（如果您为 property 配置了一个大于零的数字`mapreduce.tasktracker.reduce.tasks.maximum`）。

因此，您可以放心地假设只有在运行 tasktracker 的主机上，才会执行 reduce 任务。

# java - 实体名称无法正常运行

> ID：14734904
> 
> 赞同：0
> 
> 时间：2013-02-06T17:14:25.043
> 
> 标签：java, html, xhtml

尝试将 html 转换为 xhtml，但是当我将大于号更改为`&gt;`if 语句时不再起作用。同样的故事`&`和`<`标志。Cdata 也不起作用。

```
function length(elem){
    var input = elem.value;
    if(input.length &gt; 8){
        return true;
    }
    else{
        alert("Please enter equal to or more than 8 characters for username");
        return false;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:21:37.040

简单的解决方案：不要使用 XHTML。在大多数情况下，它的麻烦远远超过它的价值。

失败：将您的 JS 保存在外部文件中并通过`src`.

如果做不到这一点，请参阅编写 XHTML 并将其视为 HTML[的兼容性指南。](http://www.w3.org/TR/xhtml-media-types/#C_4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:23:00.857

在 HTML、XHTML 或 XML 中，没有理由“转义”“>”字符，除非您为了与“<”对称而这样做，通常需要转义。

在 XHTML 中， 的内容`script`被视为`#PCDATA`，这意味着实体引用被识别。`&gt;`可以，但这仅适用于真正*将*文档处理为 XHTML 的浏览器；在实践中，您需要声明一个 XML 内容类型并接受旧版本的 IE 会阻塞它的事实。显然，您没有这样做，因此实际上 HTML 规则适用，`script`内容被解析为纯文本，并且浏览器的 JavaScript 解释器得到字面意思`&gt;`并呕吐。在 HTML 模式下，无论 doctype 看起来是什么意思，`CDATA`section 都是杂乱无章的数据。

所以正如@Quentin 建议的那样，不要做XHTML。如果您确实*需要*使用 XHTML，请使用外部脚本。

# php - 如何对 PHP 数组进行 GROUP BY 和 SUM？

> ID：14734906
> 
> 赞同：1
> 
> 时间：2013-02-06T17:14:27.437
> 
> 标签：php, arrays, group-by, sorting

如何对这个数组进行分组和求和`evaluation_category_id`

```
Array
(
 [0] => Array
    (
        [id] => 60
        [evaluation_category_id] => 3
        [score] => 15
        [itemMaxPoint] => 20
    )
 [1] => Array
    (
        [id] => 61
        [evaluation_category_id] => 2
        [score] => 10
        [itemMaxPoint] => 20
    )

 [2] => Array
    (
        [id] => 62
        [evaluation_category_id] => 1
        [score] => 5
        [itemMaxPoint] => 20
    )

  [3] => Array
    (
        [id] => 63
        [evaluation_category_id] => 1
        [score] => 50
        [itemMaxPoint] => 200
    )

  [4] => Array
    (
        [id] => 64
        [evaluation_category_id] => 2
        [score] => 150
        [itemMaxPoint] => 200
    )

  [5] => Array
    (
        [id] => 65
        [evaluation_category_id] => 3
        [score] => 30
        [itemMaxPoint] => 50
    )
    .
    .
    .
 ) 
```

所以我得到这样的数组

```
 Array
  (
   [0] => Array
      (

    [evaluation_category_id] => 3
    [score] => 45
    [itemMaxPoint] => 70
   )

   [1] => Array
      (
    [evaluation_category_id] => 2
    [score] => 160
    [itemMaxPoint] => 220
   )

   [2] => Array
      (
    [evaluation_category_id] => 1
    [score] => 55
    [itemMaxPoint] => 220
   )
} 
```

我已经尝试过了，但它不起作用。请纠正我做错的地方

```
 public function test($data) {
    $groups = array();
    foreach ($data as $item) {
        $key = $item['evaluation_category_id'];
        if (!isset($groups[$key])) {
            $groups[$key] = array(
                'id' => $key,
                'score' => $item['score'],
                'itemMaxPoint' => $item['itemMaxPoint'],
            );
        } else {
            $groups[$key]['score'] = $groups[$key]['score'] + $item['score'];
            $groups[$key]['itemMaxPoint'] = $groups[$key]['itemMaxPoint'] +$item['itemMaxPoint'];
        }
    }
    return $groups;
} 
```

输出是

```
Array
(
 [2] => Array
    (
        [id] => 2
        [score] => 121 //121 because the given array is different.but its actually SUM all values of score
        [itemMaxPoint] => 300
    )

) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-07T08:31:40.163

我已经解决了。

```
public function getDateWiseScore($data) {
    $groups = array();
    foreach ($data as $item) {
        $key = $item['evaluation_category_id'];
        if (!array_key_exists($key, $groups)) {
            $groups[$key] = array(
                'id' => $item['evaluation_category_id'],
                'score' => $item['score'],
                'itemMaxPoint' => $item['itemMaxPoint'],
            );
        } else {
            $groups[$key]['score'] = $groups[$key]['score'] + $item['score'];
            $groups[$key]['itemMaxPoint'] = $groups[$key]['itemMaxPoint'] + $item['itemMaxPoint'];
        }
    }
    return $groups;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:21:54.450

你可以做一个 Foreach，为相等的键生成数组，然后为你想要求和的每个数组值生成 array_sum() :)

# playframework - Selenium 测试总是想打开 localhost

> ID：14734909
> 
> 赞同：1
> 
> 时间：2013-02-06T17:14:31.313
> 
> 标签：playframework, playframework-1.x

我想将我的 playFw 应用程序放到测试服务器上，并希望在其上运行测试。问题是，无论我对这些 application.conf 属性写什么：application.baseUrl、application.url，selenium 测试运行器都会尝试打开 localhost。

例如，我的测试应用程序在以下 url 下的服务器上运行：[http://testapp.example.com](http://testapp.example.com)。所以我可以打开 playFw 测试页面打开这个 url：[http://testapp.example.com/@tests](http://testapp.example.com/@tests)，它工作正常，我可以选择我想要运行的测试。当 selenium 测试运行时，它尝试从我的应用程序打开一个页面，出现以下错误消息： `open http://localhost:9000/event/abouttheevent Object #<HTMLIFrameElement> has no method 'getCurrentWindow'`

selenium 测试运行器尝试从 localhost 打开页面。在我使用的硒测试文件中`open('@@{Event.abouttheevent()}')`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-09-09T09:38:10.350

本地主机在 Selenium 测试运行程序中被[硬编码为 baseUrl](https://github.com/playframework/play1/blob/master/modules/testrunner/app/views/TestRunner/index.html#L365)（在多个位置）。我不确定他们为什么选择这个，但您可以[提交一个错误](http://play.lighthouseapp.com/projects/57987-play-framework/tickets/new)以从其中一位开发人员那里获得答案。

此时您唯一的选择是设置一个自动测试环境，该环境可以在服务器上运行，因此不会出现这些问题。或者在本地运行测试。

# postgresql - 如何在 PostgreSQL 中为基于 Web 的应用程序设置用户帐户

> ID：14734912
> 
> 赞同：4
> 
> 时间：2013-02-06T17:14:36.400
> 
> 标签：postgresql

我正在开发一个使用 PostgreSQL 作为后端数据库和 perl 处理脚本的基于 Web 的应用程序

我将登录信息保存在一个单独的文件中，类似于此处的建议在[哪里存储全局数据库连接参数](https://stackoverflow.com/questions/5135966/where-to-store-global-database-connection-parameters)，因此根据脚本需要实现的内容，它可能指向不同的登录凭据目前它是默认的 PostgreSQL 帐户，这显然需要更改。

我需要了解如何在 PostgreSQL 中设置用户帐户

我想我需要两个允许用户查询数据库，例如 web_user，另一个需要提交更改，例如 web_admin。

web_admin 账户需要登录网页

在 pgAdmin 或命令行中，我如何创建登录 Rolls 并提供所需的权限？

**编辑请澄清**

我曾尝试创建两个帐户，但不清楚这是否是正确的方法

```
CREATE USER web_user PASSWORD 'password1';
GRANT SELECT to web_user on Table1;   // Read Only
CREATE USER web_admin PASSWORD 'password2';
GRANT SELECT,INSERT,UPDATE,DELETE to web_admin on Table1;        // Read Insert and update / delete rows within a existing table but not able to create, alter or delete a Table  or column 
```

**编辑 2 哎呀**

所以我在 pgAdmin 窗口中执行了以下操作

```
 CREATE USER web_user PASSWORD 'password1';
 GRANT SELECT to web_user in schema PUBLIC;   // Read Only

 CREATE USER web_admin PASSWORD 'password2';
 GRANT SELECT,INSERT,UPDATE,DELETE to web_admin in schema PUBLIC 
```

web_user 帐户只允许对数据库进行读取访问 web_admin 帐户具有相同读取访问权限的问题

我试过 drop web_user & revoke by

```
revoke all privileges on database mydb from web_admin; 
```

但它失败并出现有关列出 mydb 中所有表的依赖项的错误

我试图查看 web_admin 实际拥有但无法查看的权限。

如何删除此帐户

grant web_user 的语法有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:21:20.480

要创建用户，您可以在 SQL中使用[CREATE USER命令。](http://www.postgresql.org/docs/current/interactive/sql-createuser.html)（与 相同`CREATE ROLE ... WITH LOGIN`） 之后使用[GRANT](http://www.postgresql.org/docs/current/interactive/sql-grant.html)来授予权限。

我不确定“默认 PostgreSQL 帐户”是什么意思。如果您正在谈论“postgres”帐户，它是超级用户，并且拥有一切权利。

特权和保护的主题相当复杂，我至少写过几次：

1.  [如何在 PostgreSQL < 9.0 中授予所有表的权限](http://www.depesz.com/2007/10/19/grantall/)
2.  [如何在 PostgreSQL > 9.0 中授予所有表的权限](http://www.depesz.com/2009/11/07/waiting-for-8-5-grant-all/)
3.  [如何保护您的数据库](http://www.depesz.com/2007/08/18/securing-your-postgresql-database/)

# javascript - Javascript - keyup 和 keydown 不起作用

> ID：14734918
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:14:47.653
> 
> 标签：javascript, keyup

看看我上传的图片。当有人单击 + 和 - 时，我现在使用 onclick 更改输入值。当有人点击鼠标开始增加价值时，我需要使用什么功能？我尝试使用 onkeyup、onkeydown 并且无法正常工作。

请对不起我的语言。

![http://i.stack.imgur.com/IuGCe.jpg](../Images/e465de4f523d106721b2b6db182b1fd7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:20:37.600

你的意思是这样的： [http ://remysharp.com/demo/pip_ticker.html](http://remysharp.com/demo/pip_ticker.html)

下面你有 jQuery func 的链接： [http ://remysharp.com/2006/12/15/jquery-mousehold-event/](http://remysharp.com/2006/12/15/jquery-mousehold-event/)

# loops - VBA如何将命名范围名称传递给公式而不是单元格内容

> ID：14734922
> 
> 赞同：0
> 
> 时间：2013-02-06T17:15:01.947
> 
> 标签：loops, excel, range, named, vba

我有 3 个范围，“AA”、“AB”和“AC”。

这些范围的*名称*在 A 列的第 1 页上......所以......

单元格 A1 包含两个字母“AA” 单元格 A2 包含 AB 单元格 A3 包含 AC

我需要一个公式来查看此列表（A1：A3）并拉入范围的名称并将它们粘贴到另一张纸上。

我可以用这段代码来实现这一点：

```
Range("AA").Copy Sheets(2).Range("B6") 
```

现在我需要一种方法来将“AA”替换为动态范围，例如 Cell(c,r)，这样公式就可以在列表中列出……因为这些命名范围的名称会在其他电子表格中发生变化，所以我可以对它们进行硬编码。

谢谢你的任何建议！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T15:15:44.810

使用单元格 A1 中的名称，

```
ActiveWorkbook.Names([A1].Value).RefersToRange.Copy 
```

将获得与您的代码段相同的副本。

# sql-server - 使用 SQL Server 将管理员与 Active Directory 中的用户相关联？

> ID：14734926
> 
> 赞同：0
> 
> 时间：2013-02-06T17:15:11.253
> 
> 标签：sql-server, sql-server-2008, active-directory

我一直在尝试编写一个在下拉列表中显示用户列表的 Active Directory 搜索器，但没有成功。

例如，如果您从用户下拉列表中选择一个用户，则该用户所属的一个或多个经理将填充第二个下拉列表，其中所选用户的经理作为列表上的第一个选项。

我可以处理下拉列表的级联，我一直遇到的问题是将用户与经理联系起来。

我转向 SQL Gurus 看看是否可以使用 SQL Server 从 Active Directory 中获取用户和与他们相关的管理器并填充 SQL Server 数据库。然后我可以使用我的 .NET 应用程序来填充下拉列表，如上所述。

我已经用谷歌搜索了网络，但结果却一无所获。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T22:12:08.433

您可以使用层次结构存储信息以保持经理和用户之间的关系。

有关详细信息，请参阅本教程，还有很多其他示例：

[教程：使用 hierachyid 数据类型](http://msdn.microsoft.com/en-us/library/bb677213.aspx)

# java - 实现方式：搜索、加载、打印

> ID：14734930
> 
> 赞同：0
> 
> 时间：2013-02-06T17:15:16.840
> 
> 标签：java

请查看我在代码中的评论以更好地解释事情。基本上有以下方法的问题。我可以运行加载方法，但我不确定用户输入的数字是否实际存储在数组中。

此外，搜索方法一直在扔东西，我认为它是一个循环。

有关更多信息，请参见下文。先感谢您。

```
import java.util.Scanner;
public class MyContainer {
private int[] values;
private int size;
public MyContainer(){
values=new int[50];
size=0;}

//Load Method - Display a message to the user 
//and get positive intergers from user
public void load()
{
int input;
Scanner in = new Scanner(System.in);
System.out.println("Enter a series of positive integers (Negative to Terminate): ");

input=in.nextInt();
while (input >=0) {
  values[size]=input;
  size++;
  input=in.nextInt();
}

}//End Load

//Compute Average from the above entered numbers
public double computeAverage() {
double avg= 0.0;
int count = 0;
while(values[size] >=0)
{avg = avg + values[size];
count++;
}
size = size + 1;
avg = avg / size;
return avg;

}

//Get user input to search for a number in the array
public boolean search(int myInt){

while(values[size] >=0) {
if (values[size] == myInt){
  return true;}
else{
  size++;}
}
return false;
}

 //print the position of the number
  public void print(){
   for(int i=0;i>=size;i++) {
   System.out.println("The number at position " + i + " is " + values[i]);
 }
 }
} 
```

这就是我到目前为止所拥有的。我还为上述容器创建了一个测试器类。

```
 class Tester {
   public static void main(String[] args) {
   MyContainer in = new MyContainer();
   in.load();
   in.computeAverage();
   in.search(); //i know for a fact this is wrong just stuck        
   in.print();    
 }
} 
```

任何建议/帮助将不胜感激。我的教授在教学上很糟糕，而且这本书只是部分解释了一些事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:31:03.270

我相信您遇到的主要问题是`size`变量的重用。在加载函数中，它将按预期工作，加载 10 个数字`size`将是 10，元素 0-> 9`values`将在其中包含数字。但是，当您达到`computeAverage`size 时仍然是 10。所以您处于无限循环中。

```
 while(values[size] >= 0) {
    avg = avg + values[size];
    count++;
 } 
```

您将检查的第一次迭代`values[10]`（这是错误的，记住有效元素仅在 0->9 中，如果`size`是 10）。下一次迭代`avg`和`count`增加但`size`保持不变，因此您将添加相同的数字`avg`并继续循环。您应该为您的 while 循环使用不同的条件`computeAverage`和`search`。最后输入退出的负数不会在数组中；您将需要使用其他东西。作为提示，它将涉及`count`and `size`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:21:54.990

您的 search() 方法具有您未传递的参数。

你把它声明为...

```
public boolean search(int myInt) {

    while (values[size] >= 0) {
        if (values[size] == myInt) {
            return true;
        } else {
            size++;
        }
    }
    return false;
} 
```

但是用...调用它

```
in.search(); 
```

这段代码甚至不会编译。为了论证起见，我将其设置为 5。

在你的`computeAverage()`方法中，这是一个无限循环......

```
while (values[size] >= 0) {
        avg = avg + values[size];
        count++;
    } 
```

# android - 通过其成员变量删除类实例是否有效？

> ID：14734931
> 
> 赞同：0
> 
> 时间：2013-02-06T17:15:19.723
> 
> 标签：android, c++, ios

好的，所以我想看看通过它的成员变量删除一个类是否安全？成员变量有一个指向其包含类的指针。这在 m_objectPtr->OnDestroy(); 之后在 android 上崩溃；被调用。它适用于 IOS 同事告诉我。我想知道这段代码是否有效。

```
class Object;
class ValueObject;
class SomeManager;

class DataInterface
{
public:
    virtual void OnDestroy(const ValueObject* value,void* data) = 0;
};

class destroyDelegate : public DataInterface
{
public:
    destroyDelegate(Object* obj) : m_objectPtr(obj)
    {
    }

    //...
    virtual void OnDestroy(const ValueObject* value,void* data)
    {
        m_objectPtr->OnDestroy();
    }
private:
    Object* m_objectPtr;
};

class Object
{
public:
    Object(SomeManager* manager,ValueObject* value) : 
    m_manager(manager), m_value(value), m_delegateObject(this)
    {
        // m_value calls OnDestroy when its being deleted. assume m_value is ref counted
        m_value->setDestroyCallBack(&m_delegateObject);
    }

    void OnDestroy()
    {
        m_manager->Destroy(this); // deletes this class and removes it from its std::list
    }
private:
    SomeManager* m_manager;
    ValueObject* m_value;
    destroyDelegate m_delegateObject;
};

// now some where in code m_value dies and calls on its member variable that inherits 
// DataInterface OnDestroy which chains down to deleting Object. 
```

# javascript - 不太确定我在这个脚本中缺少什么？

> ID：14734942
> 
> 赞同：-1
> 
> 时间：2013-02-06T17:16:03.243
> 
> 标签：javascript, jquery, shadowbox

我一直在努力让[Shadowbox](http://www.shadowbox-js.com/)与这个 CSS/Jquery 地图一起工作，我快到了，但由于某种原因，我不确定为什么我的 javascript 中不断出现错误。我知道我错过了一些东西，但我不确定是什么，我认为我需要重新审视它。

这是我的代码：

```
<script type="text/javascript">
$(function ($) {
    $("#map-usa").cssMap({
        size: 960,
        'onClick': function (e) {
            Shadowbox.init({
                players: ["iframe,html"]
            });
        });
    });
</script> 
```

我一直在通过 JS lint 运行它，但我不确定错误来自哪里。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:40:14.920

您忘记了`onClick`函数的右大括号 - 最后两个缩进`});`不匹配的原因：

```
jQuery(function($) {
    $("#map-usa").cssMap({
        size: 960,
        'onClick': function(e) {
            Shadowbox.init({
                players: ["iframe,html"]
            });
        } // <--
    });
}); 
```

# java - Log4j 登录到多个文件

> ID：14734944
> 
> 赞同：1
> 
> 时间：2013-02-06T17:16:12.707
> 
> 标签：java, logging, log4j

我尝试登录多个文件，但它不起作用..

这是配置

```
log4j.logger.org.net.portal=DEBUG, stdout, file

log4j.appender.file=org.apache.log4j.DailyRollingFileAppender
log4j.appender.file.DatePattern='.'yyyy-MM-dd'.log'
log4j.appender.file.Threshold=DEBUG
log4j.appender.file.File=C:/default.log
log4j.appender.file.layout=org.apache.log4j.PatternLayout
log4j.appender.file.layout.ConversionPattern="[%t] %d{HH:mm:ss,SSS} %-5p %l - %m%n"

log4j.appender.secondFile=org.apache.log4j.DailyRollingFileAppender
log4j.appender.secondFile.DatePattern='.'yyyy-MM-dd'.log'
log4j.appender.secondFile.Threshold=DEBUG
log4j.appender.secondFile.File=C:/secondfile.log
log4j.appender.secondFile.layout=org.apache.log4j.PatternLayout
log4j.appender.secondFile.layout.ConversionPattern="[%t] %d{HH:mm:ss,SSS} %-5p %l - %m%n"

log4j.additivity.myLogger=false
log4j.logger.myLogger=DEBUG, secondFile 
```

在代码中我得到像这样的记录器：

```
 private static final Logger loggerSmsOrdering = Logger.getLogger("myLogger"); 
```

第二个文件中没有任何内容。怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:18:03.710

我认为您必须将 secondFile 添加到记录器 log4j.logger.org.net.portal=DEBUG, stdout, file, secondFile

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-26T13:36:12.197

你可以像下面这样修改

```
 log4j.rootLogger =DEBUG,file,secondFile

    log4j.category.myLogger=DEBUG,file 
    log4j.additivity.myLogger=false

    log4j.category.myLogger=DEBUG,secondFile
    log4j.additivity.myLogger=false

    log4j.appender.file=org.apache.log4j.DailyRollingFileAppender
    log4j.appender.file.DatePattern='.'yyyy-MM-dd'.log'
    log4j.appender.file.Threshold=DEBUG
    log4j.appender.file.File=C:/default.log
    log4j.appender.file.layout=org.apache.log4j.PatternLayout
    log4j.appender.file.layout.ConversionPattern="[%t] %d{HH:mm:ss,SSS} %-5p %l - %m%n"

    log4j.appender.secondFile=org.apache.log4j.DailyRollingFileAppender
    log4j.appender.secondFile.DatePattern='.'yyyy-MM-dd'.log'
    log4j.appender.secondFile.Threshold=DEBUG
    log4j.appender.secondFile.File=C:/secondfile.log
    log4j.appender.secondFile.layout=org.apache.log4j.PatternLayout
    log4j.appender.secondFile.layout.ConversionPattern="[%t] %d{HH:mm:ss,SSS} %-5p %l - %m%n" 
```

# ruby-on-rails - 与 Rails 中的急切加载等效的功能

> ID：14734947
> 
> 赞同：0
> 
> 时间：2013-02-06T17:16:18.507
> 
> 标签：ruby-on-rails, ruby, database, ruby-on-rails-3, rails-activerecord

我正在尝试通过预先加载来优化我的代码，但是无论何时调用函数，都会在日志中执行查询。

```
@votes_list = Vote.joins(:user => :profile).where(:post_id => post.id)
@male_votes = @votes_list.where(:profiles => { :gender => 1 }).count
@female_votes = @votes_list.where(:profiles => { :gender => 2 }).count 
```

我试图在第一个查询之后进行一些查询，而无需从数据库中获取，该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:22:39.253

您希望为每次投票急切地加载用户及其个人资料。然后，您可以在个人资料上选择按性别划分的内存投票子集。

```
@votes_list = Vote.where(:post_id => post.id, :include => { :user => :profile })
@male_votes = @votes_list.select {|v| v.user.profile.gender == 1}
@female_votes = @votes_list.select {|v| v.user.profile.gender == 2} 
```

# c# - 未找到 Exchange WebService 引用

> ID：14734950
> 
> 赞同：0
> 
> 时间：2013-02-06T17:16:35.313
> 
> 标签：c#, web-services

我继承了一些使用 Microsoft Exchange Web 服务但无法编译的代码。我下载了最新的SDK并在项目中导入了Microsoft.Echange.WevbService.dll，然后引用了它

使用 Microsoft.Exchange.WebServices.Data；

但代码仍然无法编译。属于此命名空间的所有类都未解析，并且我不断收到错误消息。

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T09:23:15.137

对于 SDK v1.2 设置 Target Framework .NET 3.5（正常，不是“客户端配置文件”）对于 v.2.0 => .NET 4.0

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:04:46.387

EWS 曾经有 32 位和 64 位两种版本。我猜旧代码是 32....

这是我博客上关于让它运行的文章：[C#：使用 Exchange Web 服务从 Exchange 获取所有电子邮件](http://omegacoder.com/?p=454)。不幸的是，我在我的博客上的链接有效，但现在将一个放到一般的 MS 下载区域。

# ios - 访问属性时出现 EXC_BAD_ACCESS 异常

> ID：14734952
> 
> 赞同：2
> 
> 时间：2013-02-06T17:16:41.347
> 
> 标签：ios, objective-c, properties

我想创建一个类，我想使用类的属性名称和属性值将其序列化为 XML。为此，我在我的基类中创建了以下函数（我将从中派生所有其他类）：

```
- (NSString*) serialize
{
    unsigned int outCount, i;
    NSMutableString* s = [NSMutableString string];

    Class currentClass = [self class];
    while(currentClass != nil) {
        objc_property_t *properties = class_copyPropertyList([self class], &outCount);
        if(outCount > 0) {
            for(i = 0; i < outCount; i++) {
                objc_property_t property = properties[i];
                NSString *name = [NSString stringWithCString: property_getName(property) encoding: NSUTF8StringEncoding];
                [s appendFormat: @"<%@>%@</%@>", name, (NSString*)property, name];
            }
        }
        free(properties);
    }
    return (NSString*)s;
}

@end 
```

我假设所有属性都是（非原子的，强的）NSString*（现在 - 稍后会出现更复杂的代码）。现在由于某种原因，当我上线时

```
[s appendFormat: @"<%@>%@</%@>", name, (NSString*)property], name]; 
```

我收到 EXC_BAD_ACCESS 异常。我究竟做错了什么？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T17:28:29.670

属性作为 ac 字符串返回，而不是 NSString。只需更改格式以打印出 ac 字符串，而不是尝试转换它，如下所示：

```
 [s appendFormat: @"<%@>%s</%@>", name, property, name]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:42:20.533

找到了。只需使用

```
 NSString *value = [self valueForKey:name]; 
```

获取属性值...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T17:46:28.683

当您将 %@ 与对象一起使用时，编译器基本上会尝试通过调用该对象的描述方法来帮助您。您的 objc_property_t 变量不支持该方法。我认为它实际上是一个结构......你不能只是将它转换为 NSString。您需要决定要从中打印什么属性，然后从中检索该值。与您使用 property_getName 检索“name”属性所做的类似。

# java - Hibernate 移除 - 设置替换

> ID：14734955
> 
> 赞同：0
> 
> 时间：2013-02-06T17:16:48.690
> 
> 标签：java, hibernate, collections, persistence, set

我正在为我们较大的应用程序的某个部分删除 Hibernate，在这些应用程序中，我们一直看到数据库争用和死锁，这些问题永远无法被隔离或一致地重新创建。

父子关系，其中孩子在我们中被映射`.hbm.xml`为`Set`：Hibernate 使用他们自己的实现`Set`（特别是`PersistentSet`）。

我们`java.util.Set`在引用父母的孩子时对接口进行了正确/正确的编程。

我的问题：现在我需要退出 Hibernate，哪个实现与 Hibernate`java.util.Set`最相似（或非 Hibernate 世界中的最佳替代）`PersistentSet`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-09T03:40:18.080

弄清楚了。

Hibernate 在幕后的`PersistentSet`用途`java.util.HashSet`。因此，这将是`PersistentSet`删除 Hibernate 时的最佳替代品。

[Hibernate 3.2 JavaDoc 用于`PersistentSet`](http://docs.jboss.org/hibernate/orm/3.2/api/org/hibernate/collection/PersistentSet.html)

# session - RESTful 后端的前端框架

> ID：14734962
> 
> 赞同：7
> 
> 时间：2013-02-06T17:17:11.860
> 
> 标签：session, session-state, frontend

我正在使用 Spring 框架开发 RESTful 后端。所有服务都可以通过 HTTP 请求方法 ( `GET`, `POST`, `PUT`, `DELETE`) 访问。

你能告诉我前端框架的最佳组合是什么吗？

最好使用 SpringMVC 或 Backbone 之类的其他框架是否足够好？

如果我将 SpringMVC 用于 REST 后端，并将 SpringMVC 用于前端，那么首先为后端然后再为前端做同样的事情会不会是额外的工作？

最重要的是，我对如何使用前端进行会话管理感到困惑？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-01-22T23:13:26.323

**Templates**

Since you said "server-side" GUI, maybe you are thinking more along the lines of a template engine for creating HTML? This isn't really restful, but can be MVC like if you are forwarding from your Controller classes.

But PLEASE keep in mind that it would be a very BAD idea to try and generate XML or JSON data for consumption by RESTful clients (ajax) with either of these. Just say no to JSON creation from a template engine!

***JSP*** is pretty much the standard for Java EE at the moment, or is most widely used. All you need is a compliant server, such as Tomcat/Jetty.

```
http://www.oracle.com/technetwork/java/javaee/jsp/index.html 
```

***Thymeleaf*** It looks a lot cleaner than JSP, and has the added benefit of not allowing all the pitfalls that can happen with a JSP (and there are a lot).

```
http://www.thymeleaf.org/ 
```

**JavaScript:**

When you say you are creating a RESTful backend, most people would make the conclusion (and rightfully so) that you are trying to develop a JavaScript MVVM client/GUI.

***Kendo UI*** has a complete set of GUI widgets and MVVM framework that is specifically designed to work with a RESTful backend. But it's a paid for API.

[http://www.telerik.com/kendo-ui](http://www.telerik.com/kendo-ui)

***YUI3*** (Yahoo User Interface) has a variety of widgets as well, and I've seen a lot of jobs requesting this. It has the advantage of being free/OSS as well. Older version are deprecated.

[https://github.com/yui/yui3/wiki](https://github.com/yui/yui3/wiki)

***knockout.js*** has been my favorite for MVVM engines that I've actually had experience working with. And it's simple to learn, in my opinion.

[http://knockoutjs.com/](http://knockoutjs.com/)

***Angular.js*** Also free/oss, and works well with other GUI APIs.

```
https://angularjs.org/ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-01T05:02:37.160

如果您正在考虑制作 SPA（单页应用程序），请确保查看 AmpersandJS -> [http://ampersandjs.com/](http://ampersandjs.com/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T06:16:22.770

我建议您将**[Sencha Ext JS](http://www.sencha.com)**用于前端，它是最好的框架之一，并且可以与`RestFul back-end`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-01-22T20:38:38.793

这是一个很好的问题，但我认为没有专门为使用 REST 服务器后端而构建的服务器端框架。我认为您可以使用 Spring-MVC / Spring-Boot 来获得良好的开端，但您可能还想研究 Rails 或其他 Ruby 任何其他现代 Web 框架技术。

# gem - GitLab sidekiq 测试失败

> ID：14734968
> 
> 赞同：5
> 
> 时间：2013-02-06T17:17:23.187
> 
> 标签：gem, rake, gitlab

我正在按照此处的说明进行操作：

[https://github.com/gitlabhq/gitlabhq/blob/4-1-stable/doc/install/databases.md](https://github.com/gitlabhq/gitlabhq/blob/4-1-stable/doc/install/databases.md)

当我尝试运行测试时：

```
sudo -u gitlab -H bundle exec rake gitlab:env:info RAILS_ENV=production
sudo -u gitlab -H bundle exec rake gitlab:check RAILS_ENV=production 
```

第一个测试返回橙色标题，第二个测试显示 Sidekiq 错误：

```
Checking Sidekiq ...    

Running? ... no
  Try fixing it:
  sudo -u gitlab -H bundle exec rake sidekiq:start
  For more information see:
  doc/install/installation.md in section "Install Init Script"
  see log/sidekiq.log for possible errors
  Please fix the error above and rerun the checks.
Checking Sidekiq ... Finished 
```

当我运行时`sudo -u gitlab -H bundle exec rake sidekiq:start`，我收到以下错误：

```
rake aborted!
cannot load such file -- rb-inotify
/home/gitlab/gitlab/config/application.rb:9:in `<top (required)>'
/home/gitlab/gitlab/Rakefile:5:in `require'
/home/gitlab/gitlab/Rakefile:5:in `<top (required)>'
(See full trace by running task with --trace) 
```

当我运行跟踪时，我得到以下输出：

```
rake aborted!
cannot load such file -- rb-inotify
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `require'
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `block (2     levels) in require'
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `each'
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `block in require'
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `each'
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `require'
/usr/local/lib/ruby/gems/1.9.1/gems/bundler-1.2.3/lib/bundler.rb:128:in `require'
/home/gitlab/gitlab/config/application.rb:9:in `<top (required)>'
/home/gitlab/gitlab/Rakefile:5:in `require'
/home/gitlab/gitlab/Rakefile:5:in `<top (required)>'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/rake_module.rb:25:in `load'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/rake_module.rb:25:in `load_rakefile'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:583:in `raw_load_rakefile'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:89:in `block in load_rakefile'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:160:in `standard_exception_handling'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:88:in `load_rakefile'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:72:in `block in run'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:160:in `standard_exception_handling'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/lib/rake/application.rb:70:in `run'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/gems/rake-10.0.3/bin/rake:33:in `<top (required)>'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/bin/rake:23:in `load'
/home/gitlab/gitlab/vendor/bundle/ruby/1.9.1/bin/rake:23:in `<main>' 
```

我已经尝试手动安装`rb-inotify`来纠正这个问题：

```
sudo gem install rb-inotify 
```

它说它是成功的，但测试仍然不起作用！请指教！谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T17:53:44.030

那种命令：

```
 sudo -u gitlab -H bundle exec rake sidekiq:start 
```

不仅需要在 gitlab 克隆的 repo 中运行，还需要 a`RAILS_ENV=production`才能正常运行：

```
 sudo -u gitlab -H bundle exec rake sidekiq:start RAILS_ENV=production 
```

请参阅**[故障排除页面](https://github.com/gitlabhq/gitlab-public-wiki/wiki/Trouble-Shooting-Guide)**：

> *   **`Error`**:`no such file to load -- rb-inotify`运行时`rake`（见[#1752](https://github.com/gitlabhq/gitlabhq/issues/1752)）
> *   **`Problem`**: 任务在错误的环境中运行
> *   **`Solution`**: 添加`RAILS_ENV=production`到命令的末尾

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T17:20:11.903

显然我以错误的方式运行它。以这种方式运行它解决了它：

```
sudo -u gitlab -H bundle exec rake gitlab:check RAILS_ENV=production 
```

教程需要更新

# sql-server - 在层次结构中查找元素

> ID：14734971
> 
> 赞同：1
> 
> 时间：2013-02-06T17:17:30.007
> 
> 标签：sql-server, tsql, common-table-expression, hierarchical

我正在尝试使用`WITH`T-SQL 创建分层查询。我想做的是，例如，直接或间接地确定 John 是否是 Ryan 的老板？

我该如何为此编写查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:24:25.823

```
WITH BossOf AS(
   SELECT bossId, Id From Employees
       UNION ALL
   SELECT b.bossId, e.Id 
   FROM Employees AS e
   INNER JOIN BossOf b ON b.Id = e.bossId
)
SELECT * FROM BossOf
   WHERE Id = 'Ryan' 
```

就像你可以用 BossOf 做的一个例子......

```
WITH BossOf AS(
   SELECT bossId, Id From Employees
       UNION ALL
   SELECT b.bossId, e.Id 
   FROM Employees AS e
   INNER JOIN BossOf b ON b.Id = e.bossId
)
SELECT * FROM Employees
    WHERE Id IN (SELECT BossId 
                    FROM BossOf
                    Where Id = 'Ryan') 
```

甚至

```
WITH BossOf AS(
   SELECT bossId, Id From Employees
       UNION ALL
   SELECT b.bossId, e.Id 
   FROM Employees AS e
   INNER JOIN BossOf b ON b.Id = e.bossId
)
SELECT COUNT(*) FROM BossOf
   WHERE Id = 'Ryan'
   AND BossId = 'John' 
```

# oracle - 动态 SQL 接受表列作为过程中的输入

> ID：14734974
> 
> 赞同：0
> 
> 时间：2013-02-06T17:17:45.987
> 
> 标签：oracle, plsql, runtime-error, dynamic-sql, procedure

嘿，我正在尝试编写一个程序，在该程序中，用户可以`insert`将他想获得的列作为`parameter input`. 截至目前，当我运行测试时，`script`我收到此错误：

```
error -1 message error in ct_cu_act_medrecon_pg.spm_search_patientmedrecs =>ORA-00933: SQL command not properly ended 
```

该错误是指 中的`order by`部分`select statement`，当我删除它时，我收到一条错误消息：

```
error -1 message error in ct_cu_act_medrecon_pg.spm_search_patientmedrecs =>ORA-00904: "D"."P_INSERTDT_IN": invalid identifier 
```

这是规格：

```
procedure spm_search_patientmedrecs (
  p_columnsort_in  in varchar2, --which is sort column
  p_medmed_in      in varchar2, --first column
  p_planid_in      in varchar2, --second column
  p_detmed_in      in varchar2, --third column
  p_insertdt_in    in varchar2, --fourth column
  p_ascdesc_in     in varchar2, --asc or desc in order by
  p_return_cur_out out sys_refcursor,
  p_err_code_out   out number,
  p_err_mesg_out   out varchar2
); 
```

这是程序主体：

```
procedure spm_search_patientmedrecs (
  p_columnsort_in  in varchar2,
  p_medmed_in      in varchar2,
  p_planid_in      in varchar2,
  p_detmed_in      in varchar2,
  p_insertdt_in    in varchar2,
  p_ascdesc_in     in varchar2,
  p_return_cur_out out sys_refcursor,
  p_err_code_out   out number,
  p_err_mesg_out   out varchar2)
is
  lv_sql           varchar2(32767);
begin
  lv_sql := '';
  lv_sql := 'select h.p_medmed_in,
                    h.p_planid_in,
                    d.p_detmed_in,
                    d.p_insertdt_in
             from membermedicalreconcilationhdr h,
                  membermedicalreconcilationdet d
             where h.membermedreconciliationhdrskey = 
                   d.membermedreconciliationhdrskey
             order by h.p_columnsort_in p_ascdesc_in';
    p_err_code_out := 0;
    OPEN p_return_cur_out FOR lv_sql;
exception
  when others then
    p_err_code_out := -1;
    p_err_mesg_out := 'error in ct_cu_act_medrecon_pg.spm_search_patientmedrecs =>'||sqlerrm;
end spm_search_patientmedrecs; 
```

这是我的测试脚本：

```
set serveroutput on
declare 
  type tempcursor is ref cursor;
  v_cur_result tempcursor;
  errcode number;
  errmesg varchar2(1000);
begin
  ct_cu_act_medrecon_pg.spm_search_patientmedrecs
    ('primarymemberplanid',
     'membermedreconciliationhdrskey',
     'primarymemberplanid',
     'membermedreconciliationdetskey',
     'inserteddt',
     'ASC',
     v_cur_result,
     errcode,
     errmesg
     );

--  dbms_output.put_line(v_cur_result);
  dbms_output.put_line('error '||errcode||' message '||errmesg);
end; 
```

首先，我知道我如何处理错误不是最好的方法，但这就是要求我这样做的人想要的方式。

现在我不知道这是否可行`Oracle PL/SQL`，但如果是的话，我将非常感谢一些帮助，为我指明正确的方向。如果你们需要更多信息，请随时询问，我会尽我所能提供帮助（我只使用 SQL 和 PL/SQL 2 个月）。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:29:58.263

动态 SQL 意味着组装作为 SQL 语句执行的字符串。您的字符串硬编码参数名称，而您实际需要的是参数的内容。

像这样的东西：

```
lv_sql := 'select h.'||p_medmed_in||',
                    h.'||p_planid_in||',
                    d.'||p_detmed_in||',
                    d.'||p_insertdt_in||'
             from membermedicalreconcilationhdr h,
                  membermedicalreconcilationdet d
             where h.membermedreconciliationhdrskey = 
                   d.membermedreconciliationhdrskey
             order by h.'||p_columnsort_in||' '|| p_ascdesc_in; 
```

# delphi - 如何在 Delphi7 中使用现有的表单作为选项卡

> ID：14734976
> 
> 赞同：5
> 
> 时间：2013-02-06T17:17:48.787
> 
> 标签：delphi, pascal

我的 Delphi 7 应用程序包含我已经制作的多个表单。我现在想让每个单独的表单出现在单个容器表单的单独选项卡中。因为我是 Delphi 的新手，我不知道该采取什么方法，那么 Delphi 中有哪些方法可供我完成此任务？

谢谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-06T17:23:29.630

1.  创建一个页面控件，`TPageControl`.
2.  添加 7 页。
3.  创建您的 7 个表格。
4.  将每个表单添加到其标签表中。

最后一步如下：

```
Form1.Parent := TabSheet1;
Form1.Align := alClient;
Form1.BorderStyle := bsNone;
Form1.ParentBackground := True; 
```

由于您正在为 7 个表单和 7 个选项卡执行此操作，因此您需要在一个数组中执行此操作，并将上面的代码提取到一个方法中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-06T18:42:34.567

一个简单的方法是使用 ManualDock：

```
var
 i:Integer;
begin
    // caption of then new tab sheet will be the caption of the form

    Form2.ManualDock(Pagecontrol1);
    Form2.Show;

    // or as loop
    for I := 0 to 5 do
        begin
          With TForm2.Create(self) do
            begin

                ManualDock(Pagecontrol1);
                Show;
            end;
        end;
     Pagecontrol1.ActivePageIndex := 0;
end; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-06T22:03:59.643

而不是表单，使它们成为单独的框架，然后在对象`TFrame`上的各个选项卡中使用组件`TPageControl`来生成您想要的选项卡布局。这是一个无代码的解决方案。

# ruby - ruby aws-s3 的替代品

> ID：14734978
> 
> 赞同：1
> 
> 时间：2013-02-06T17:17:51.053
> 
> 标签：ruby, amazon-s3, installation

是否有 ruby​​ aws-s3 的替代品。
我已经安装了 aws-s3 (gem install aws-s3) 但在运行脚本时出错

```
ruby s3Metadata.rb
/usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in    
'gem_original_require': /usr/lib/ruby/gems/1.8/gems/builder-3.1.4/lib/builder/xmlbase.rb:183:  
syntax error, unexpected ',', expecting '|' (SyntaxError)   
        define_method(sym) do |*args, &block|    
                                     ^   
/usr/lib/ruby/gems/1.8/gems/builder-3.1.4/lib/builder/xmlbase.rb:192: syntax error,    unexpected kEND, expecting $end  from /usr/local/lib/site_ruby/1.8/rubygems   /custom_require.rb:31:in 'require'    
    from /usr/lib/ruby/gems/1.8/gems/builder-3.1.4/lib/builder/xmlmarkup.rb:14   
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in    'gem_original_require'   
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in 'require'   
    from /usr/lib/ruby/gems/1.8/gems/builder-3.1.4/lib/builder.rb:12   
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in    'gem_original_require'   
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:31:in 'require'   
    from /usr/lib/ruby/gems/1.8/gems/aws-s3-0.6.3/lib/aws/s3/extensions.rb:159:in    'require_library_or_gem'   
    from /usr/lib/ruby/gems/1.8/gems/aws-s3-0.6.3/lib/aws/s3.rb:12   
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:36:in    'gem_original_require'   
    from /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:36:in 'require'   
    from s3Metadata.rb:4`   

s3Metadata.rb:4   = `require 'aws/s3' 
```

谷歌搜索但没有解决方案....
我需要运行脚本来更新/添加亚马逊 S3 中的一些元数据。

`aws-s3 (0.6.3)`
有旧版本的 ruby`ruby 1.8.6 (2007-09-24 patchlevel 111) [x86_64-linux]`
​​ 我无法升级它会搞砸很多东西。ruby aws-s3 是否有解决方案或替代方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T17:37:28.300

[Rightscale AWS gem](https://github.com/rightscale/right_aws)也支持 s3。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T20:32:02.387

亚马逊提供了他们自己的 gem，叫做[`aws-sdk`](https://rubygems.org/gems/aws-sdk). 我不能保证它可以在 1.8.6 中工作，对于如此古老的 Ruby 版本，我认为您最好的选择是安装任何 gem 的非常早期版本，因为在更新的版本中很多人会迁移到 1.9。

# python - 仅当 mercurial 有任何更改时才运行提交

> ID：14734979
> 
> 赞同：2
> 
> 时间：2013-02-06T17:17:53.703
> 
> 标签：python, bash, mercurial, fabric

我和一个问这个问题的人有同样的问题：[How to git commit nothing without a error?](https://stackoverflow.com/questions/8123674/how-to-git-commit-nothing-without-an-error) 基本上我需要运行 hg commit，只有当我的存储库中有任何更改时。我正在使用fabric 来运行提交，所以如果没有更改，它将输出一个令人讨厌的错误。

```
local() encountered an error (return code 1) while executing 'hg commit...' 
```

这是上述线程的答案：

```
git add -A
git diff --quiet --exit-code --cached || git commit -m 'bla' 
```

它适用于 git，但我使用 Merucial。我不知道如何在 Mercurial 中做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T10:56:24.120

因此，正如 koopajah 和 Kent 在评论中所建议的那样，我可以使用`hg status`or的输出`hg diff`来查看是否有任何更改。Fabric 允许我用`capture=True`标志读取输出。

```
if local('hg status', capture=True):
    local('hg commit') 
```

很简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T17:42:34.513

从您在问题中链接到的页面上的 Tyler Eaves 的回答（并且不知道 Fabric），您可以执行以下操作：

```
with hide('warnings'):
  with settings(warn_only=True):
    run('hg commit -q ...') 
```

提交（如果有）将是安静的，因此如果没有提交文件，则不会报告。它也不会报告是否有*文件*提交，这可能不是你想要的:)

# apache-camel - camel-ftp 间歇性问题

> ID：14734983
> 
> 赞同：1
> 
> 时间：2013-02-06T17:18:04.853
> 
> 标签：apache-camel

我正在使用 camel-ftp 组件将文件上传到服务器。我随机得到以下异常并且 ftp 突然停止可能是什么问题。感谢任何指针。我使用的骆驼版本是2.10.1

```
|Caused by: org.apache.camel.component.file.GenericFileOperationFailedException: Cannot store file: 8000211d-5f40-4bac-920a-a2e5f2575870.gpg
|   at org.apache.camel.component.file.remote.SftpOperations.doStoreFile(SftpOperations.java:716)
|   at org.apache.camel.component.file.remote.SftpOperations.storeFile(SftpOperations.java:649)
|   at org.apache.camel.component.file.GenericFileProducer.writeFile(GenericFileProducer.java:249)
|   at org.apache.camel.component.file.GenericFileProducer.processExchange(GenericFileProducer.java:151)
|   at org.apache.camel.component.file.remote.RemoteFileProducer.process(RemoteFileProducer.java:49)
|   at org.apache.camel.util.AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge.process(AsyncProcessorConverterHelper.java:61)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.SendProcessor$2.doInAsyncProducer(SendProcessor.java:120)
|   at org.apache.camel.impl.ProducerCache.doInAsyncProducer(ProducerCache.java:292)
|   at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:115)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:73)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:91)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:330)
|   at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:220)
|   at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:45)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:303)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.Pipeline.process(Pipeline.java:117)
|   at org.apache.camel.processor.Pipeline.process(Pipeline.java:80)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:81)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:73)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:91)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:330)
|   at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:220)
|   at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:45)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:303)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.Pipeline.process(Pipeline.java:117)
|   at org.apache.camel.processor.Pipeline.process(Pipeline.java:80)
|   at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:45)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:122)
|   at org.apache.camel.processor.RouteInflightRepositoryProcessor.processNext(RouteInflightRepositoryProcessor.java:48)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:73)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.component.direct.DirectProducer.process(DirectProducer.java:61)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.SendProcessor$2.doInAsyncProducer(SendProcessor.java:120)
|   at org.apache.camel.impl.ProducerCache.doInAsyncProducer(ProducerCache.java:292)
|   at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:115)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:73)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:91)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:330)
|   at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:220)
|   at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:45)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:303)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.Pipeline.process(Pipeline.java:117)
|   at org.apache.camel.processor.Pipeline.process(Pipeline.java:80)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.ChoiceProcessor.process(ChoiceProcessor.java:81)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:73)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:91)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:330)
|   at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:220)
|   at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:45)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:303)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.Pipeline.process(Pipeline.java:117)
|   at org.apache.camel.processor.Pipeline.process(Pipeline.java:80)
|   at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:45)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:122)
|   at org.apache.camel.processor.RouteInflightRepositoryProcessor.processNext(RouteInflightRepositoryProcessor.java:48)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90)
|   at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:73)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
|   at org.apache.camel.component.direct.DirectProducer.process(DirectProducer.java:61)
|   at org.apache.camel.processor.UnitOfWorkProcessor.processAsync(UnitOfWorkProcessor.java:150)
|   at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:117)
|   at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:99)
|   at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:86)
|   at org.apache.camel.processor.UnitOfWorkProducer.process(UnitOfWorkProducer.java:63)
|   at org.apache.camel.impl.ProducerCache$2.doInProducer(ProducerCache.java:360)
|   at org.apache.camel.impl.ProducerCache$2.doInProducer(ProducerCache.java:331)
|   at org.apache.camel.impl.ProducerCache.doInProducer(ProducerCache.java:227)
|   at org.apache.camel.impl.ProducerCache.sendExchange(ProducerCache.java:331)
|   at org.apache.camel.impl.ProducerCache.send(ProducerCache.java:186)
|   at org.apache.camel.impl.DefaultProducerTemplate.send(DefaultProducerTemplate.java:115)
|   at org.apache.camel.impl.DefaultProducerTemplate.sendBody(DefaultProducerTemplate.java:119)
|   ... 59 more
|Caused by: 4: java.io.IOException: Pipe closed
|   at com.jcraft.jsch.ChannelSftp.put(ChannelSftp.java:500)
|   at com.jcraft.jsch.ChannelSftp.put(ChannelSftp.java:454)
|   at org.apache.camel.component.file.remote.SftpOperations.doStoreFile(SftpOperations.java:701)
|   ... 180 more
|Caused by: java.io.IOException: Pipe closed
|   at java.io.PipedInputStream.read(PipedInputStream.java:291)
|   at com.jcraft.jsch.Channel$MyPipedInputStream.updateReadSide(Channel.java:344)
|   at com.jcraft.jsch.ChannelSftp.put(ChannelSftp.java:466) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T11:06:26.483

由于您提到您有时能够成功执行操作，因此可能不存在权限问题。不知道是不是存储空间问题等等。

我建议最好的方法是尝试通过您正在使用的版本的源代码进行调试。您会发现在`org.apache.camel.component.file.remote.FtpOperations`Java 类中抛出了异常，并且 IOException 被包裹在那里。

但是，话虽如此 - 您也可以考虑拥有一个全局错误处理程序。这是一篇解释如何的文章：http: [//java.dzone.com/articles/camel-exception-handling](http://java.dzone.com/articles/camel-exception-handling)。它可以帮助理解到底出了什么问题。

# batch-file - Windows 批处理脚本 - 严格限制 findstr 的结果

> ID：14734986
> 
> 赞同：0
> 
> 时间：2013-02-06T17:18:33.563
> 
> 标签：batch-file

我正在尝试编写一个使用 FINDSTR 在文本文件中查找关键字的脚本。给定以下命令：

```
findstr /s "item1" source.txt >> output.txt 
```

我如何确保结果只提取那些包含“item1”而不是“item 14”的行？

我试过 /l 和 /C: 无济于事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T17:34:01.147

您可以使用正则表达式单词边界锚。

```
findstr /sr "\<item1\>" source.txt >> output.txt 
```

FINDSTR 将检测正则表达式元字符并自动将搜索字符串视为正则表达式。但最好使用该`/R`选项明确指定正则表达式搜索。

单词边界锚的 FINDSTR 实现非常不标准，但我认为它对你有用。请参阅[Windows FINDSTR 命令有哪些未记录的功能和限制？](https://stackoverflow.com/q/8844868/1012053)了解更多信息。答案的相关部分在标题为***“Regex word boundary”***的部分接近尾声。

# sublimetext2 - sublime text 2 的简单配色方案

> ID：14734992
> 
> 赞同：0
> 
> 时间：2013-02-06T17:18:47.760
> 
> 标签：sublimetext2

我正在为 sublime text 2 寻找一种浅色方案，但颜色很少，例如 2，如 eclipse 和 netbeans。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-14T12:50:53.253

[您可以在tmtheme-editor](http://tmtheme-editor.herokuapp.com)中预览和编辑大约 200 种配色方案在编辑器 的图库侧边栏上，您可以过滤浅色和深色配色方案

![在此处输入图像描述](../Images/3e3156f204b22347529c0be97cb6753e.png)

我希望你能找到你最喜欢的。

免责声明：我是 tmtheme-editor 的开发者

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:50:02.840

你可以试试 Earthsong 主题，它非常简单，可以在[github 上](https://github.com/daylerees/colour-schemes)找到——这里有一个它的截图。

![地歌之光](../Images/eadddcb0794d372ee196b7002facda35.png)

# c# - 如何对 BackgroundWorker + PRISM InteractionRequest 进行单元测试？

> ID：14734997
> 
> 赞同：5
> 
> 时间：2013-02-06T17:19:02.280
> 
> 标签：c#, unit-testing, mvvm, prism, backgroundworker

我的 WPF MVVM 应用程序中有一个重复出现的模式，它具有以下结构。

```
public class MyViewModel : NotificationObject
{
    private readonly IService _DoSomethingService;

    private bool _IsBusy;
    public bool IsBusy
    {
        get { return _IsBusy; }
        set
        {
            if (_IsBusy != value)
            (
                _IsBusy = value;
                RaisePropertyChanged(() => IsBusy);
            )
        }
    }

    public ICommand DisplayInputDialogCommand { get; private set; }
    public InteractionRequest<Notification> Error_InteractionRequest { get; private set; }
    public InteractionRequest<Confirmation> GetInput_InteractionRequest { get; private set; }

    // ctor
    public MyViewModel(IService service)
    {
        _DoSomethingService = service;

        DisplayInputDialogCommand  = new DelegateCommand(DisplayInputDialog);
        Error_InteractionRequest = new InteractionRequest<Notification>();
        Input_InteractionRequest = new InteractionRequest<Confirmation>();
    }

    private void DisplayInputDialog()
    {
        Input_InteractionRequest.Raise(
            new Confirmation() {
                Title = "Please provide input...",
                Content = new InputViewModel()
            },
            ProcessInput
        );
    }

    private void ProcessInput(Confirmation context)
    {
        if (context.Confirmed)
        {
            IsBusy = true;

            BackgroundWorker bg = new BackgroundWorker();
            bg.DoWork += new DoWorkEventHandler(DoSomethingWorker_DoWork);
            bg.RunWorkerCompleted += new RunWorkerCompletedEventHandler(DoSomethingWorker_RunWorkerCompleted);
            bg.RunWorkerAsync();
        }
    }

    private void DoSomethingWorker_DoWork(object sender, DoWorkEventArgs e)
    {
        _DoSomethingService.DoSomething();
    }

    private void DoSomethingWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        IsBusy = false;

        if (e.Error != null)
        {
            Error_InteractionRequest.Raise(
                new Confirmation() {
                    Title = "Error",
                    Content = e.Error.Message
                }
            );
        }
    }
} 
```

本质上，该模式描述了一个面向对话框的工作流，它允许用户在不锁定 UI 的情况下启动（并提供输入）长时间运行的操作。此模式的一个具体示例可能是“另存为...”操作，其中用户单击“另存为...”按钮，然后在弹出对话框中键入文件名的文本值，然后单击对话框确定按钮，然后观看旋转动画，同时将它们的数据保存在指定的文件名下。

在提供的代码示例中，启动此工作流将执行以下操作。

1.  引发`Input_InteractionRequest` `Raised`事件以在 UI 中显示一个对话框，以收集用户输入。

2.  调用`ProcessInput`回调（在用户完成对话框时触发）。

3.  检查上下文的`Confirmed`属性`InteractionRequest`以确定对话是确认还是取消。

4.  如果确认...

    1.  设置 IsBusy 标志。

    2.  启动 a`BackgroundWorker`以执行长时间运行的`_DoSomethingService.DoSomething()`操作。

    3.  取消设置 IsBusy 标志。

    4.  如果 DoSomething_DoWork 发生错误，则引发`Error_InteractionRequest` `Raised`事件以在 UI 中显示消息框，以通知用户操作不成功。

我想最大化这种模式的单元测试覆盖率，但我不太确定如何处理它。我想避免直接对非公共成员进行单元测试，因为这种模式的具体实现可能会随着时间而改变，实际上在我的应用程序中会因实例而异。我考虑了以下选项，但似乎都不合适。

1.  替换`BackgroundWorker`为`IBackgroundWorker`并通过 ctor 注入它。在测试期间使用同步`IBackgroundWorker`以确保在调用 DoWork/RunWorkerCompleted 方法之前不会完成单元测试。这将需要大量重构，并且也不解决测试`InteractionRequest`回调的问题。

2.  用于`System.Threading.Thread.Sleep(int)`允许`BackgroundWorker`操作在断言阶段之前完成。我不喜欢这样，因为它很慢，而且我仍然不知道如何在`InteractionRequest`回调中测试代码路径。

3.  `BackgroundWorker`将方法和`InteractionRequest`回调重构为可以同步和独立测试的[Humble Objects 。](http://xunitpatterns.com/Humble%20Object.html)这看起来很有希望，但构建它让我很难过。

4.  单元测试`DoSomethingWorker_DoWork`, `DoSomethingWorker_RunWorkerCompleted`, 和`ProcessInput`同步独立。这将为我提供所需的覆盖范围，但我将针对特定实现而不是公共接口进行测试。

对上述模式进行单元测试和/或重构以提供最大代码覆盖率的最佳方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-18T21:48:33.110

*编辑：请参阅下面的更新以获得更简单的替代方案（仅限 .NET 4.0+）。*

这种模式可以很容易地通过抽象接口背后的机制来测试，然后按照这个[问题](https://stackoverflow.com/questions/6455066/how-to-test-a-viewmodel-that-loads-with-a-backgroundworker)`BackgroundWorker`中的描述针对该接口进行测试。一旦界面背后的怪癖被掩盖，测试就变得简单了。`BackgroundWorker``InteractionRequest`

这是我决定使用的界面。

```
public interface IDelegateWorker
{
    void Start<TInput, TResult>(Func<TInput, TResult> onStart, Action<TResult> onComplete, TInput parm);
} 
```

此接口公开了一个`Start`接受以下参数的方法。

1.  `Func<TInput, TResult> onStart`- 与`BackgroundWorker.DoWork`. 这是您执行后台操作的主要工作的地方。这个委托应该接受一个类型的参数`TInput`并返回一个`TResult`应该传递给 onComplete 委托的类型的值。

2.  `Action<TResult> onComplete`- 与`BackgroundWorker.RunWorkerCompleted`. 这个委托将在 onStart 委托完成后被调用。这是您执行任何后处理工作的地方。这个委托应该接受一个类型的参数`TResult`。

3.  `TInput parm`- 传递给 onStart 委托的初始值（如果 onStart 委托不需要输入，则为 null）。类似于将参数值传递给`Backgroundworker.RunWorkerAsync(object argument)`方法。

然后，您可以使用依赖注入将`BackgroundWorker`实例替换为`IDelegateWorker`. 例如，重写`MyViewModel`现在看起来像这样。

```
public class MyViewModel : NotificationObject
{
    // Dependencies
    private readonly IService _doSomethingService;
    private readonly IDelegateWorker _delegateWorker; // new

    private bool _IsBusy;
    public bool IsBusy
    {
        get { return _IsBusy; }
        set
        {
            if (_IsBusy != value)
            {
                _IsBusy = value;
                RaisePropertyChanged(() => IsBusy);
            }
        }
    }

    public ICommand DisplayInputDialogCommand { get; private set; }
    public InteractionRequest<Notification> ErrorDialogInteractionRequest { get; private set; }
    public InteractionRequest<Confirmation> InputDialogInteractionRequest { get; private set; }

    // ctor
    public MyViewModel(IService service, IDelegateWorker delegateWorker /* new */)
    {
        _doSomethingService = service;
        _delegateWorker = delegateWorker; // new

        DisplayInputDialogCommand = new DelegateCommand(DisplayInputDialog);
        ErrorDialogInteractionRequest = new InteractionRequest<Notification>();
        InputDialogInteractionRequest = new InteractionRequest<Confirmation>();
    }

    private void DisplayInputDialog()
    {
        InputDialogInteractionRequest.Raise(
            new Confirmation()
            {
                Title = "Please provide input...",
                Content = new DialogContentViewModel()
            },
            ProcessInput
        );
    }

    private void ProcessInput(Confirmation context)
    {
        if (context.Confirmed)
        {
            IsBusy = true;

            // New - BackgroundWorker now abstracted behind IDelegateWorker interface.
            _delegateWorker.Start<object, TaskResult<object>>(
                    ProcessInput_onStart,
                    ProcessInput_onComplete,
                    null
                );
        }
    }

    private TaskResult<object> ProcessInput_onStart(object parm)
    {
        TaskResult<object> result = new TaskResult<object>();
        try
        {
            result.Result = _doSomethingService.DoSomething();
        }
        catch (Exception ex)
        {
            result.Error = ex;
        }
        return result;
    }

    private void ProcessInput_onComplete(TaskResult<object> tr)
    {
        IsBusy = false;

        if (tr.Error != null)
        {
            ErrorDialogInteractionRequest.Raise(
                new Confirmation()
                {
                    Title = "Error",
                    Content = tr.Error.Message
                }
            );
        }
    }

    // Helper Class
    public class TaskResult<T>
    {
        public Exception Error;
        public T Result;
    }
} 
```

`BackgroundWorker`这种技术允许您通过在测试时注入同步（或模拟）实现和在生产中注入异步实现来避免类`IDelegateWorker`的`MyViewModel`怪癖。例如，您可以在测试时使用此实现。

```
public class DelegateWorker : IDelegateWorker
{
    public void Start<TInput, TResult>(Func<TInput, TResult> onStart, Action<TResult> onComplete, TInput parm)
    {
        TResult result = default(TResult);

        if (onStart != null)
            result = onStart(parm);

        if (onComplete != null)
            onComplete(result);
    }
} 
```

您可以将此实现用于生产。

```
public class ASyncDelegateWorker : IDelegateWorker
{
    public void Start<TInput, TResult>(Func<TInput, TResult> onStart, Action<TResult> onComplete, TInput parm)
    {
        BackgroundWorker bg = new BackgroundWorker();
        bg.DoWork += (s, e) =>
        {
            if (onStart != null)
                e.Result = onStart((TInput)e.Argument);
        };

        bg.RunWorkerCompleted += (s, e) =>
        {
            if (onComplete != null)
                onComplete((TResult)e.Result);
        };

        bg.RunWorkerAsync(parm);
    }
} 
```

有了这个基础设施，您应该能够测试您的所有方面，`InteractionRequest`如下所示。请注意，我使用的是**MSTest**和**Moq**，并且根据 Visual Studio Code Coverage 工具已经实现了 100% 的覆盖率，尽管这个数字对我来说有点怀疑。

```
[TestClass()]
public class MyViewModelTest
{
    [TestMethod()]
    public void DisplayInputDialogCommand_OnExecute_ShowsDialog()
    {
        // Arrange
        Mock<IService> mockService = new Mock<IService>();
        Mock<IDelegateWorker> mockWorker = new Mock<IDelegateWorker>();
        MyViewModel vm = new MyViewModel(mockService.Object, mockWorker.Object);
        InteractionRequestTestHelper<Confirmation> irHelper
            = new InteractionRequestTestHelper<Confirmation>(vm.InputDialogInteractionRequest);

        // Act
        vm.DisplayInputDialogCommand.Execute(null);

        // Assert
        Assert.IsTrue(irHelper.RequestRaised);
    }

    [TestMethod()]
    public void DisplayInputDialogCommand_OnExecute_DialogHasCorrectTitle()
    {
        // Arrange
        const string INPUT_DIALOG_TITLE = "Please provide input...";
        Mock<IService> mockService = new Mock<IService>();
        Mock<IDelegateWorker> mockWorker = new Mock<IDelegateWorker>();
        MyViewModel vm = new MyViewModel(mockService.Object, mockWorker.Object);
        InteractionRequestTestHelper<Confirmation> irHelper
            = new InteractionRequestTestHelper<Confirmation>(vm.InputDialogInteractionRequest);

        // Act
        vm.DisplayInputDialogCommand.Execute(null);

        // Assert
        Assert.AreEqual(irHelper.Title, INPUT_DIALOG_TITLE);
    }

    [TestMethod()]
    public void DisplayInputDialogCommand_OnExecute_SetsIsBusyWhenDialogConfirmed()
    {
        // Arrange
        Mock<IService> mockService = new Mock<IService>();
        Mock<IDelegateWorker> mockWorker = new Mock<IDelegateWorker>();
        MyViewModel vm = new MyViewModel(mockService.Object, mockWorker.Object);
        vm.InputDialogInteractionRequest.Raised += (s, e) =>
        {
            Confirmation context = e.Context as Confirmation;
            context.Confirmed = true;
            e.Callback();
        };

        // Act
        vm.DisplayInputDialogCommand.Execute(null);

        // Assert
        Assert.IsTrue(vm.IsBusy);
    }

    [TestMethod()]
    public void DisplayInputDialogCommand_OnExecute_CallsDoSomethingWhenDialogConfirmed()
    {
        // Arrange
        Mock<IService> mockService = new Mock<IService>();
        IDelegateWorker worker = new DelegateWorker();
        MyViewModel vm = new MyViewModel(mockService.Object, worker);
        vm.InputDialogInteractionRequest.Raised += (s, e) =>
        {
            Confirmation context = e.Context as Confirmation;
            context.Confirmed = true;
            e.Callback();
        };

        // Act
        vm.DisplayInputDialogCommand.Execute(null);

        // Assert
        mockService.Verify(s => s.DoSomething(), Times.Once());
    }

    [TestMethod()]
    public void DisplayInputDialogCommand_OnExecute_ClearsIsBusyWhenDone()
    {
        // Arrange
        Mock<IService> mockService = new Mock<IService>();
        IDelegateWorker worker = new DelegateWorker();
        MyViewModel vm = new MyViewModel(mockService.Object, worker);
        vm.InputDialogInteractionRequest.Raised += (s, e) =>
        {
            Confirmation context = e.Context as Confirmation;
            context.Confirmed = true;
            e.Callback();
        };

        // Act
        vm.DisplayInputDialogCommand.Execute(null);

        // Assert
        Assert.IsFalse(vm.IsBusy);
    }

    [TestMethod()]
    public void DisplayInputDialogCommand_OnExecuteThrowsError_ShowsErrorDialog()
    {
        // Arrange
        Mock<IService> mockService = new Mock<IService>();
        mockService.Setup(s => s.DoSomething()).Throws(new Exception());
        DelegateWorker worker = new DelegateWorker();
        MyViewModel vm = new MyViewModel(mockService.Object, worker);
        vm.InputDialogInteractionRequest.Raised += (s, e) =>
        {
            Confirmation context = e.Context as Confirmation;
            context.Confirmed = true;
            e.Callback();
        };
        InteractionRequestTestHelper<Notification> irHelper
            = new InteractionRequestTestHelper<Notification>(vm.ErrorDialogInteractionRequest);

        // Act
        vm.DisplayInputDialogCommand.Execute(null);

        // Assert
        Assert.IsTrue(irHelper.RequestRaised);
    }

    [TestMethod()]
    public void DisplayInputDialogCommand_OnExecuteThrowsError_ShowsErrorDialogWithCorrectTitle()
    {
        // Arrange
        const string ERROR_TITLE = "Error";
        Mock<IService> mockService = new Mock<IService>();
        mockService.Setup(s => s.DoSomething()).Throws(new Exception());
        DelegateWorker worker = new DelegateWorker();
        MyViewModel vm = new MyViewModel(mockService.Object, worker);
        vm.InputDialogInteractionRequest.Raised += (s, e) =>
        {
            Confirmation context = e.Context as Confirmation;
            context.Confirmed = true;
            e.Callback();
        };
        InteractionRequestTestHelper<Notification> irHelper
            = new InteractionRequestTestHelper<Notification>(vm.ErrorDialogInteractionRequest);

        // Act
        vm.DisplayInputDialogCommand.Execute(null);

        // Assert
        Assert.AreEqual(irHelper.Title, ERROR_TITLE);
    }

    [TestMethod()]
    public void DisplayInputDialogCommand_OnExecuteThrowsError_ShowsErrorDialogWithCorrectErrorMessage()
    {
        // Arrange
        const string ERROR_MESSAGE_TEXT = "do something failed";
        Mock<IService> mockService = new Mock<IService>();
        mockService.Setup(s => s.DoSomething()).Throws(new Exception(ERROR_MESSAGE_TEXT));
        DelegateWorker worker = new DelegateWorker();
        MyViewModel vm = new MyViewModel(mockService.Object, worker);
        vm.InputDialogInteractionRequest.Raised += (s, e) =>
        {
            Confirmation context = e.Context as Confirmation;
            context.Confirmed = true;
            e.Callback();
        };
        InteractionRequestTestHelper<Notification> irHelper
            = new InteractionRequestTestHelper<Notification>(vm.ErrorDialogInteractionRequest);

        // Act
        vm.DisplayInputDialogCommand.Execute(null);

        // Assert
        Assert.AreEqual((string)irHelper.Content, ERROR_MESSAGE_TEXT);
    }

    // Helper Class
    public class InteractionRequestTestHelper<T> where T : Notification
    {
        public bool RequestRaised { get; private set; }
        public string Title { get; private set; }
        public object Content { get; private set; }

        public InteractionRequestTestHelper(InteractionRequest<T> request)
        {
            request.Raised += new EventHandler<InteractionRequestedEventArgs>(
                (s, e) =>
                {
                    RequestRaised = true;
                    Title = e.Context.Title;
                    Content = e.Context.Content;
                });
        }
    }
} 
```

**笔记：**

1.  另一种选择是使用商业版的**TypeMock**隔离（模拟）框架。这个框架非常适合遗留代码或不适合单元测试的代码。TypeMock 允许你模拟任何东西。我不会详细说明如何将其用于手头的问题，但仍然值得指出它是一个有效的选项。

2.  在 .NET 4.5 中，`BackgroundWorker`不推荐使用`async`/`await`模式。使用上述`IDelegateWorker`（或一些类似的）接口可以让您的整个项目迁移到`async`/`await`模式，而无需修改单个 ViewModel。

## 更新：

在实现了上述技术之后，我发现了一种更简单的 .NET 4.0 或更好的方法。要对异步流程进行单元测试，您需要某种方法来检测该流程何时完成，或者您需要能够在测试期间同步运行该流程。

Microsoft在 .NET 4.0 中引入了[任务并行库 (TPL) 。](http://msdn.microsoft.com/en-us/library/dd460717.aspx)这个库提供了一组丰富的工具来执行远远超出`BackgroundWorker`类能力的异步操作。实现异步操作的最佳方式是使用 TPL，然后`Task`从您的测试方法中返回 a。然后对以这种方式实现的异步操作进行单元测试是微不足道的。

```
[TestMethod]
public void RunATest()
{
    // Assert.
    var sut = new MyClass();

    // Act.
    sut.DoSomethingAsync().Wait();

    // Assert.
    Assert.IsTrue(sut.SomethingHappened);
} 
```

如果将任务暴露给单元测试是不可能或不切实际的，那么下一个最佳选择是覆盖任务的调度方式。默认情况下，任务计划在 ThreadPool 上异步运行。您可以通过在代码中指定自定义调度程序来覆盖此行为。例如，以下代码将使用 UI 线程运行任务。

```
Task.Factory.StartNew(
    () => DoSomething(),
    TaskScheduler.FromCurrentSynchronizationContext()); 
```

要以可单元测试的方式实现这一点，请使用依赖注入传递任务调度程序。然后，您的单元测试可以传入一个任务调度程序，该调度程序在当前线程上同步执行操作，您的生产应用程序将传入一个任务调度程序，该任务调度程序在 ThreadPool 上异步运行任务。

您甚至可以更进一步，通过使用反射覆盖默认任务调度程序来消除依赖注入。这使您的单元测试更加脆弱，但对您正在测试的实际代码的侵入性较小。有关其工作原理的详细解释，请参阅此[博客文章](http://www.jarrodstormo.com/2012/02/05/unit-testing-when-using-the-tpl/)。

```
// Configure the default task scheduler to use the current synchronization context.
Type taskSchedulerType = typeof(TaskScheduler);
FieldInfo defaultTaskSchedulerField = taskSchedulerType.GetField("s_defaultTaskScheduler", BindingFlags.SetField | BindingFlags.Static | BindingFlags.NonPublic);
defaultTaskSchedulerField.SetValue(null, TaskScheduler.FromCurrentSynchronizationContext()); 
```

不幸的是，这在单元测试程序集中无法按预期工作。这是因为单元测试（如控制台应用程序）没有 a `SynchronizationContext`，您将收到以下错误消息。

```
错误：System.InvalidOperationException：当前 SynchronizationContext 不能用作 TaskScheduler。
```

要解决此问题，您只需`SynchronizationContext`在测试设置中设置。

```
// Configure the current synchronization context to process work synchronously.
SynchronizationContext.SetSynchronizationContext(new SynchronizationContext()); 
```

这将消除错误，但您的某些测试可能仍会失败。这是因为默认`SynchronizationContext`帖子与 ThreadPool 异步工作。要覆盖它，只需子类化默认值`SynchronizationContext`并覆盖 Post 方法，如下所示。

```
public class TestSynchronizationContext : SynchronizationContext
{
    public override void Post(SendOrPostCallback d, object state)
    {
        Send(d, state);
    }
} 
```

有了这个，您的测试设置应该看起来像下面的代码，并且您的测试代码中的所有任务将默认同步运行。

```
// Configure the current synchronization context to process work synchronously.
SynchronizationContext.SetSynchronizationContext(new TestSynchronizationContext());

// Configure the default task scheduler to use the current synchronization context.
Type taskSchedulerType = typeof(TaskScheduler);
FieldInfo defaultTaskSchedulerField = taskSchedulerType.GetField("s_defaultTaskScheduler", BindingFlags.SetField | BindingFlags.Static | BindingFlags.NonPublic);
defaultTaskSchedulerField.SetValue(null, TaskScheduler.FromCurrentSynchronizationContext()); 
```

请注意，这不会阻止使用自定义调度程序启动任务。在这种情况下，您需要在使用依赖注入时传递该自定义调度程序，然后在测试期间传递一个同步调度程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-22T17:58:37.027

好问题。我将尝试您的选项 3，并稍作改动。

1.  使 InteractionRequest 可测试，以便测试方法可以选择是确认还是取消操作。因此，这允许测试各个路径。您可以使用 IoC 技术（控制反转）
2.  将 DoWork 和 RunWorkerCompleted 中的所有逻辑重构为单独的方法，这允许独立测试这些方法（如果需要）。
3.  然后添加一个新的标志 IsAsyncFlag 来指示是否需要异步执行。运行测试时关闭异步模式。

有很多强调测试覆盖率。但根据我的经验，很难实现 100% 的测试覆盖率，而且它永远不能成为代码质量的代名词。因此，我的重点是识别和编写可以为解决方案增加价值的测试。

如果您找到了更好的方法，请分享。

# linux - 设置Window tester pro linux。SWT 错误

> ID：14734998
> 
> 赞同：1
> 
> 时间：2013-02-06T17:19:03.013
> 
> 标签：linux, junit, eclipse-plugin, swt, window-tester

高，我在 Open Suse Linux x64 发行版上设置了 Google Window Tester，当我运行我的 Junit 插件测试时出现此错误。它的 RCP 插件应用程序。

```
Caused by: java.lang.RuntimeException: Failed to create widget reference for instance of org.eclipse.swt.custom.CBanner
   WindowTester: 201207141338 - linux,gtk,x86_64
 at com.windowtester.runtime.internal.factory.WTRuntimeManager.createReference(WTRuntimeManager.java:105)
 at com.windowtester.runtime.internal.factory.WTRuntimeManager.asReference(WTRuntimeManager.java:46)
 at com.windowtester.runtime.swt.internal.widgets.SWTWidgetReference.forWidget(SWTWidgetReference.java:325)
 at com.windowtester.runtime.swt.internal.widgets.SWTWidgetReference.asControlReferences(SWTWidgetReference.java:244)
 at com.windowtester.runtime.swt.internal.widgets.CompositeReference$1.call(CompositeReference.java:34)
 at com.windowtester.runtime.swt.internal.widgets.CompositeReference$1.call(CompositeReference.java:1)
 at com.windowtester.runtime.swt.internal.widgets.SWTUIExecutor.execute(SWTUIExecutor.java:142)
 at com.windowtester.runtime.swt.internal.widgets.SWTUIExecutor.run(SWTUIExecutor.java:97)
 ... 68 more 
```

似乎是窗口测试器运行时的问题，任何人曾经尝试过使用 Google 窗口测试器执行此操作并得到相同的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-26T08:14:33.223

不幸的是，WindowTester 还不支持 Linux x86_64 平台。

# go - golang：从 smtp.SendMail 读取多行错误响应

> ID：14734999
> 
> 赞同：0
> 
> 时间：2013-02-06T17:19:03.187
> 
> 标签：go

我正在使用这段代码：

```
err := smtp.SendMail(
    smtpHostPort,
    auth,
    sender,
    []string{recipient},
    []byte(message),
)
if err != nil {
    log.Printf("sendSmtp: failure: %q", strings.Split(err.Error(), "\n"))
} 
```

然而，多行错误响应似乎被截断：

```
 2013/02/06 11:54:41 sendSmtp: failure: ["530 5.5.1 Authentication Required. Learn more at"] 
```

如何获得完整的多行错误响应？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-04T17:55:32.220

对于记录，此错误已修复：

[https://code.google.com/p/go/issues/detail?id=5700](https://code.google.com/p/go/issues/detail?id=5700)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:28:15.473

错误不是多行字符串。

```
package main

import (
    "errors"
    "log"
    "strings"
)

func main() {
    err := errors.New("530 5.5.1 Authentication Required. Learn more at")
    log.Printf("sendSmtp: failure: %q", strings.Split(err.Error(), "\n"))
    err = errors.New("530 5.5.1 Authentication Required. Learn more at\nstackoverflow.com")
    log.Printf("sendSmtp: failure: %q", strings.Split(err.Error(), "\n"))
} 
```

输出：

```
2013/02/06 13:30:19 sendSmtp: failure: ["530 5.5.1 Authentication Required. Learn more at"]
2013/02/06 13:30:19 sendSmtp: failure: ["530 5.5.1 Authentication Required. Learn more at" "stackoverflow.com"] 
```