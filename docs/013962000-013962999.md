# StackOverflow 问答 13962000-13962999

# inflate-exception - 致命的运行时异常二进制 xml 文件参考？

> ID：13962000
> 
> 赞同：1
> 
> 时间：2012-12-19T22:01:58.657
> 
> 标签：inflate-exception

我得到以下致命的运行时异常（android 2.1）：

12-19 21:23:53.160: E/AndroidRuntime(279): 致命异常: main 12-19 21:23:53.160: E/AndroidRuntime(279): android.view.InflateException: 二进制 XML 文件行 #24: 错误膨胀类 com.michaelnovakjr.numberpicker.NumberPicker

在将命名空间从 com.michaelnovakjr 更改为不同的命名空间之后。

但是，我在整个源代码中找不到任何对 com.michaelnovakjr 的引用。

谁能告诉我在哪里看？

我已经清理了项目，重启了 Eclipse，创建了新的虚拟 Android 设备，以防万一留下任何东西/没有正确重建。

整个工作区由一个项目和一个库组成，现在都在命名空间 nl.computerhuys.TabNavUI 中。由于致命异常提到了“main”，我假设错误出现在 main.xml 中，其中有两个：一个在库中：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
<TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="Hello World, ACTIVITY_ENTRY_NAME"
    />
</LinearLayout> 
```

和项目中的一个：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
<TextView
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="Hello World, NumberPickerSample"
    />
</LinearLayout> 
```

logcat 错误消息中的第 24 行显然没有引用这些文件中的任何一个。那么我如何找出它所引用的 .xml 文件呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:22:23.683

刚找到。

实际上，在库的 dialog_number_picker.xml 中还有对旧命名空间的引用。通过查找项目中的所有 .xml 文件（windows 搜索）找到它，在 notepad++ 中打开所有文件，然后在所有打开的文件中进行字符串搜索...

现在工作正常。

# javascript - 如何使用 jQuery 从页面上的每个元素中删除类

> ID：13962001
> 
> 赞同：0
> 
> 时间：2012-12-19T22:01:59.240
> 
> 标签：javascript, jquery

我正在尝试从页面上的每个元素中删除特定的 CSS 类。我会做类似的事情：

```
$(body).removeClass('removethis');
$(body).each().removeClass('removethis'); 
```

我不知道这样做的正确方法。我这样做是为了在启用 javascript 时自动从页面上的每个元素中删除一个类。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T22:02:59.040

```
$(".removeThis").removeClass("removeThis"); 
```

这将从具有该类的每个元素中删除该类。

# jquery - 链接也向下滚动到另一个页面上的特定元素

> ID：13962004
> 
> 赞同：-1
> 
> 时间：2012-12-19T22:02:23.897
> 
> 标签：jquery, html

我如何创建一个指向另一个页面特定高度的链接？例如，指向另一个页面的最后一篇文章（特定 div）的链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:05:23.800

这很简单，你只需添加`#elementId`到链接中`<html-element id="elementId" />`就会被选中

如果您没有元素 ID，这是一种解决方法：

```
document.ready(function() { 
   if (document.URL.indexOf("scrollto=myTarget") !== -1) {
       $(".element element-textarea").attr("id","myTarget");
       window.location.href = "#myTarget";
   }
} 
```

现在你可以打电话了`http://www.asdf.com/myPage.whatever?scrollto=myTarget`。javascript 会找到字符串“scrollto=myTarget”（不是真正的 url 参数！）并因此向下滚动。

# python - 使用 Python 请求网页运行搜索

> ID：13962006
> 
> 赞同：6
> 
> 时间：2012-12-19T22:02:27.867
> 
> 标签：python, search, web

我有一个“Uniprot”格式的蛋白质名称列表，我想将它们全部转换为 MGI 格式。如果您访问 www.uniprot.org 并在“查询”栏中输入 uniprot 蛋白质名称，它将生成一个页面，其中包含有关该蛋白质的大量信息，包括其 MGI 名称（尽管页面更靠后）。

比如一个Uniprot名字是“Q9D880”，向下滚动可以看到它对应的MGI名字是“1913775”。

我已经知道如何使用 Python 的 urllib 从页面中提取 MGI 名称。我*不*知道该怎么做是编写 Python 代码来让主页运行“Q9D880”的查询。我的列表包含 270 个蛋白质名称，因此最好避免将每个蛋白质名称复制并粘贴到查询栏中。

我看到了“Python App 中的 Google 搜索”的帖子，我对这个概念有了更深入的理解，但我怀疑运行 google 搜索与在其他网站上运行搜索功能不同，比如 uniprot.org。

我正在运行 Python 2.7.2，但我愿意实施使用其他版本的 Python 的解决方案。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T22:20:21.883

更简单的方法是使用[`requests`](http://docs.python-requests.org/en/v1.0.0/)库。我为您提供的解决方案还使用 BeautifulSoup4 从页面中获取信息本身。

给定查询参数的字典，您所[要做的就是：](http://docs.python-requests.org/en/v1.0.0/user/quickstart/#passing-parameters-in-urls)

```
from bs4 import BeautifulSoup as BS
for protein in my_protein_list:
    text = requests.get('http://www.uniprot.org/uniprot/' + protein).text
    soup = BS(text)
    MGI = soup.find(name='a', onclick="UniProt.analytics('DR-lines', 'click', 'DR-MGI');").text
    MGI = MGI[4:]
    print protein +' - ' + MGI 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T22:14:03.750

运行搜索似乎在做一个 GET

```
http://www.uniprot.org/?dataset=uniprot&query=Q9D880&sort=score&url=&lucky=no&random=no 
```

最终将您重定向到

```
http://www.uniprot.org/uniprot/Q9D880 
```

因此，您应该能够使用`urllib`或 http 库（我使用`httplib2`）对该地址执行 GET，参数化 URL 中的蛋白质名称，以便您可以搜索所需的任何蛋白质名称。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T22:32:35.753

你也可以这样做[`PyQuery`](http://packages.python.org/pyquery/)：

```
>>> from pyquery import PyQuery as pq    
>>> url = "http://www.uniprot.org/uniprot/{name}"
>>> name = "Q9D880"
>>> response = pq(url=url.format(name=name))
>>> print html("a").filter(lambda e: pq(this).text().startswith("MGI:")).text()
MGI:1913775 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T22:22:39.337

查询在网址中，可以调用：
[http ://www.uniprot.org/uniprot/?query=1913775&sort=score](http://www.uniprot.org/uniprot/?query=1913775&sort=score)

我没有时间测试这个脚本，因为我没有安装 2.x，但是 2.x 中的代码应该是这样的：

```
import urllib
MGIName = "1913775"
print urllib.urlopen(
    "http://www.uniprot.org/uniprot/?query="+ MGIName +"&sort=score").read() 
```

我运行的 3.2 中的代码是这样的，它运行良好：

```
>>> import urllib.request
>>> MGIName = "1913775"
>>> print(urllib.request.urlopen("http://www.uniprot.org/uniprot/?query="+ MGIName +"&sort=score").read()) 
```

只需在名称列表上循环 MGIname

# objective-c - Objective-C NSImage，内存泄漏（任何建议）我正在使用 ARC

> ID：13962008
> 
> 赞同：1
> 
> 时间：2012-12-19T22:02:31.013
> 
> 标签：objective-c, macos, memory-leaks

如何解决此内存泄漏？我有 NSBezierPath 的集合吗？如何解决此内存泄漏？有什么建议吗？我正在使用 ARC。

```
int main(int argc, const char * argv[])
{
    @autoreleasepool {

        // insert code here...
        for(int j=0;j<5000;j++){
            NSLog(@"Hello, World!");
            NSSize imageSize = NSMakeSize(512, 512);
            NSImage *image = [[NSImage alloc] initWithSize:imageSize];
            //draw a line:
            for(int i=0;i<1000;i++){
                [image lockFocus];
                float r1 = (float)(arc4random() % 500);
                float r2 = (float)(arc4random() % 500);
                float r3 = (float)(arc4random() % 500);
                float r4 = (float)(arc4random() % 500);
                [NSBezierPath strokeLineFromPoint:NSMakePoint(r1, r2) toPoint:NSMakePoint(r3, r4)];
            }
            //...

            NSBitmapImageRep *imageRep = [[NSBitmapImageRep alloc] initWithFocusedViewRect:NSMakeRect(0, 0, imageSize.width, imageSize.height)];
            NSData *pngData = [imageRep representationUsingType:NSPNGFileType properties:nil];
            [image unlockFocus];

            NSString *jstring = [NSString stringWithFormat:@"%d", j];
            jstring = [jstring stringByAppendingString:@".png"];
            [pngData writeToFile:jstring atomically:YES];
        }
    }

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T22:06:32.217

修改后的答案，现在我知道您正在使用 ARC：

可能不是您在泄漏，而是您的自动释放池随着循环的每次迭代而变得越来越大，因为在循环完成之前自动释放池不会清空。

您需要做的是在循环中使用辅助自动释放池。这是您的代码的修订版本来说明这一点。

```
int main(int argc, const char * argv[])
{
    @autoreleasepool {
        // insert code here...
        for(int j=0; j<5000; j++) {
            NSLog(@"Hello, World!");
            NSSize imageSize = NSMakeSize(512, 512);
            @autoreleasepool {
                NSImage *image = [[NSImage alloc] initWithSize:imageSize];
                //draw a line:
                NSData *pngData;
                for(int i=0;i<1000;i++){
                    [image lockFocus];
                    float r1 = (float)(arc4random() % 500);
                    float r2 = (float)(arc4random() % 500);
                    float r3 = (float)(arc4random() % 500);
                    float r4 = (float)(arc4random() % 500);
                    [NSBezierPath strokeLineFromPoint:NSMakePoint(r1, r2) toPoint:NSMakePoint(r3, r4)];
                    //...

                    NSBitmapImageRep *imageRep = [[NSBitmapImageRep alloc] initWithFocusedViewRect:NSMakeRect(0, 0, imageSize.width, imageSize.height)];
                    pngData = [imageRep representationUsingType:NSPNGFileType properties:nil];
                    [image unlockFocus];
                }

                NSString *jstring = [NSString stringWithFormat:@"%d", j];
                jstring = [jstring stringByAppendingString:@".png"];
                [pngData writeToFile:jstring atomically:YES];
            }
        }
    }

    return 0;
} 
```

不过，你似乎还有另一个问题。您是否正在为文件构建完整路径？

# android - 删除所有本地日历事件有效，但会触发错误，即删除了太多事件

> ID：13962009
> 
> 赞同：5
> 
> 时间：2012-12-19T22:02:37.820
> 
> 标签：android, calendar

我使用以下方法在本地（ICS & JB）删除谷歌日历上的所有事件：

```
public void deleteAll(){
    String selection = "(" + CalendarContract.Events.CALENDAR_ID + " = ?)";
    String[] selectionArgs = new String[] { Integer.toString(this.calId) };
    ContentResolver cr = context.getContentResolver();
    int rows = cr.delete(CalendarContract.Events.CONTENT_URI, selection, selectionArgs);
    Log.d(TAG, rows + " events deleted");
} 
```

一切正常，但我收到一个烦人的警告：日历删除过多

```
Delete limit exceeded

 There are 21 deleted items for Calendar, account
 xxxxx.xxxxx@gmail.com.  What would you like to do?" 

Delete the items. 
Undo the deletes.  
Do nothing for now. 
```

显示错误的原因是什么，有人知道避免它的方法吗？我正在使用 HTC One-X

问候 R

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-06T19:56:52.140

遇到过几次，很烦！不幸的是，这是一个已知且持续存在的问题。有一个关于它的[现有错误报告](https://code.google.com/p/android/issues/detail?id=28862)，但它仍然没有得到纠正。

要解决此问题，您必须清除本地日历缓存。

为此，请在您的设备上执行以下操作：

**库存安卓：**

```
Settings > Applications > Manage Applications > Calendar Storage > Clear data 
```

**宏达感：**

```
Settings > Apps > All > Calendar Storage > Clear data 
```

一旦你这样做了，问题就会消失。

# cmake - 如何调查 imp.load_module 上的 python2 段错误

> ID：13962014
> 
> 赞同：2
> 
> 时间：2012-12-19T22:03:04.107
> 
> 标签：cmake, shared-libraries, swig, python-2.x, archlinux

我正在尝试使用Python 2.7.3 在 Arch Linux 上安装和使用[dolfin 。](https://aur.archlinux.org/packages/dolfin-bzr/)

找出导致此类分段错误的原因的最佳方法是什么？

```
$ python2 -c "import dolfin; print dolfin.__version__"
[3]    6491 segmentation fault (core dumped)  python2 -c "import dolfin; print 
dolfin.__version__" 
```

我尝试通过 gdb 检查核心文件：

```
$ sudo systemd-coredumpctl gdb 6491 
```

但它们总是被截断：

```
Reading symbols from /usr/bin/python2.7...(no debugging symbols
found)...done.
BFD: Warning: /var/tmp/coredump-wSi8DV is truncated: expected
core file size >= 39694336, found: 25165824.
warning: core file may not match specified executable file.
[New LWP 7056]
Cannot access memory at address 0x7fe70be0d148
Cannot access memory at address 0x7fe70be0d140 
```

我尝试在命令之间添加“打印”语句，并将问题跟踪到此 load_module 行，该行加载了一个由 swig 构建的模块：

```
fp, pathname, description = imp.find_module('_common', [dirname(__file__)])
print "_mod = imp.load_module('_common', \n\tfp=%s, \n\tpathname=%s, \n\tdescription=%s)" % ( fp, pathname, description)
_mod = imp.load_module('_common', fp, pathname, description) 
```

并且“打印”行打印以下内容，看起来正确：

```
_mod = imp.load_module('_common', 
        fp=<open file '_common.so', mode 'rb' at 0x282d150>, 
        pathname=_common.so, 
        description=('.so', 'rb', 3))
[1]    9039 segmentation fault (core dumped)  python2 -c "import dolfin; print dolfin.__version__" 
```

我尝试在模块开始时添加 sys.settrace 以获取更多信息，但这并没有发生。

因此，我检查了它尝试加载的共享库的链接：

```
$ ldd _common.so
    libexpat.so.1 => /lib64/libexpat.so.1 (0x00007f52fe960000)
    libavformat.so.54 => /lib64/libavformat.so.54 (0x00007f52fe61d000)
    libavcodec.so.54 => /lib64/libavcodec.so.54 (0x00007f52fd6bb000)
    libavutil.so.51 => /lib64/libavutil.so.51 (0x00007f52fd48d000)
    libswscale.so.2 => /lib64/libswscale.so.2 (0x00007f52fd240000)
    libvtkImaging.so.5.10 => /usr/lib/vtk-5.10/libvtkImaging.so.5.10 (0x00007f52fcb6e000)
    libvtkftgl.so.5.10 => /usr/lib/vtk-5.10/libvtkftgl.so.5.10 (0x00007f52fc960000)
    libfreetype.so.6 => /lib64/libfreetype.so.6 (0x00007f52fc6c1000)
    libQtGui.so.4 => /lib64/libQtGui.so.4 (0x00007f52fba1d000)
    libQtCore.so.4 => /lib64/libQtCore.so.4 (0x00007f52fb546000)
    libGL.so.1 => /lib64/libGL.so.1 (0x00007f52fb223000)
    libXt.so.6 => /lib64/libXt.so.6 (0x00007f52fafbc000)
    libvtkParallel.so.5.10 => /usr/lib/vtk-5.10/libvtkParallel.so.5.10 (0x00007f52faabd000)
    libvtkexoIIc.so.5.10 => /usr/lib/vtk-5.10/libvtkexoIIc.so.5.10 (0x00007f52fa877000)
    libvtkVolumeRendering.so.5.10 => /usr/lib/vtk-5.10/libvtkVolumeRendering.so.5.10 (0x00007f52f9fdf000)
    libQtWebKit.so.4 => /lib64/libQtWebKit.so.4 (0x00007f52f81f9000)
    libQtSql.so.4 => /lib64/libQtSql.so.4 (0x00007f52f7fb9000)
    libQtNetwork.so.4 => /lib64/libQtNetwork.so.4 (0x00007f52f7c81000)
    libvtkViews.so.5.10 => /usr/lib/vtk-5.10/libvtkViews.so.5.10 (0x00007f52f7993000)
    libvtkInfovis.so.5.10 => /usr/lib/vtk-5.10/libvtkInfovis.so.5.10 (0x00007f52f7357000)
    libpci.so.3 => /usr/lib/libpci.so.3 (0x00007f52f714b000)
    libxcb.so.1 => /usr/lib/libxcb.so.1 (0x00007f52f6f2b000)
    libcblas.so => /usr/lib/libcblas.so (0x00007f52f6d0a000)
    libssl.so.1.0.0 => /lib64/libssl.so.1.0.0 (0x00007f52f6a9f000)
    libcrypto.so.1.0.0 => /lib64/libcrypto.so.1.0.0 (0x00007f52f6696000)
    libhdf5_hl.so.7.4.0 => /lib64/libhdf5_hl.so.7.4.0 (0x00007f52f6465000)
    librtmp.so.0 => /lib64/librtmp.so.0 (0x00007f52f6249000)
    libva.so.1 => /lib64/libva.so.1 (0x00007f52f6031000)
    libxvidcore.so.4 => /lib64/libxvidcore.so.4 (0x00007f52f5d19000)
    libx264.so.128 => /lib64/libx264.so.128 (0x00007f52f59ca000)
    libvpx.so.1 => /lib64/libvpx.so.1 (0x00007f52f5729000)
    libvorbisenc.so.2 => /lib64/libvorbisenc.so.2 (0x00007f52f525a000)
    libvorbis.so.0 => /lib64/libvorbis.so.0 (0x00007f52f502d000)
    libtheoraenc.so.1 => /lib64/libtheoraenc.so.1 (0x00007f52f4def000)
    libtheoradec.so.1 => /lib64/libtheoradec.so.1 (0x00007f52f4bd4000)
    libspeex.so.1 => /lib64/libspeex.so.1 (0x00007f52f49bb000)
    libschroedinger-1.0.so.0 => /lib64/libschroedinger-1.0.so.0 (0x00007f52f46ef000)
    libopenjpeg.so.1 => /lib64/libopenjpeg.so.1 (0x00007f52f44c7000)
    libopencore-amrwb.so.0 => /lib64/libopencore-amrwb.so.0 (0x00007f52f42b3000)
    libopencore-amrnb.so.0 => /lib64/libopencore-amrnb.so.0 (0x00007f52f4088000)
    libmp3lame.so.0 => /lib64/libmp3lame.so.0 (0x00007f52f3e11000)
    libgsm.so.1 => /lib64/libgsm.so.1 (0x00007f52f3c06000)
    libglib-2.0.so.0 => /lib64/libglib-2.0.so.0 (0x00007f52f390f000)
    libgobject-2.0.so.0 => /lib64/libgobject-2.0.so.0 (0x00007f52f36c1000)
    libSM.so.6 => /lib64/libSM.so.6 (0x00007f52f34b9000)
    libICE.so.6 => /lib64/libICE.so.6 (0x00007f52f329c000)
    libXrender.so.1 => /lib64/libXrender.so.1 (0x00007f52f3091000)
    libfontconfig.so.1 => /lib64/libfontconfig.so.1 (0x00007f52f2e57000)
    libXext.so.6 => /lib64/libXext.so.6 (0x00007f52f2c43000)
    libnvidia-tls.so.310.19 => /lib64/libnvidia-tls.so.310.19 (0x00007f52f2a40000)
    libnvidia-glcore.so.310.19 => /lib64/libnvidia-glcore.so.310.19 (0x00007f52f054d000)
    libVPIC.so.5.10 => /usr/lib/vtk-5.10/libVPIC.so.5.10 (0x00007f52f0328000)
    libCosmo.so.5.10 => /usr/lib/vtk-5.10/libCosmo.so.5.10 (0x00007f52f00e0000)
    libsqlite3.so.0 => /lib64/libsqlite3.so.0 (0x00007f52efe33000)
    libgstapp-0.10.so.0 => /lib64/libgstapp-0.10.so.0 (0x00007f52efc27000)
    libgstinterfaces-0.10.so.0 => /lib64/libgstinterfaces-0.10.so.0 (0x00007f52efa14000)
    libgstpbutils-0.10.so.0 => /lib64/libgstpbutils-0.10.so.0 (0x00007f52ef7f0000)
    libgstvideo-0.10.so.0 => /lib64/libgstvideo-0.10.so.0 (0x00007f52ef5d4000)
    libgstbase-0.10.so.0 => /lib64/libgstbase-0.10.so.0 (0x00007f52ef37f000)
    libgstreamer-0.10.so.0 => /lib64/libgstreamer-0.10.so.0 (0x00007f52ef096000)
    libvtkalglib.so.5.10 => /usr/lib/vtk-5.10/libvtkalglib.so.5.10 (0x00007f52eee75000)
    libresolv.so.2 => /usr/lib/libresolv.so.2 (0x00007f52eec5e000)
    libXau.so.6 => /usr/lib/libXau.so.6 (0x00007f52eea5a000)
    libXdmcp.so.6 => /usr/lib/libXdmcp.so.6 (0x00007f52ee853000)
    libogg.so.0 => /lib64/libogg.so.0 (0x00007f52ee64d000)
    liborc-0.4.so.0 => /lib64/liborc-0.4.so.0 (0x00007f52ee3d1000)
    libpcre.so.1 => /lib64/libpcre.so.1 (0x00007f52ee16e000)
    libgthread-2.0.so.0 => /lib64/libgthread-2.0.so.0 (0x00007f52edf6b000)
    libffi.so.6 => /lib64/libffi.so.6 (0x00007f52edd63000)
    libuuid.so.1 => /lib64/libuuid.so.1 (0x00007f52edb5e000)
    libgmodule-2.0.so.0 => /lib64/libgmodule-2.0.so.0 (0x00007f52ed959000) 
```

我已经读到，段错误可能是由于共享库与使用（或链接到？）另一个库的不同版本构建的库链接引起的，但我如何找出导致问题的原因？谢谢。

**更新**

如果我用 ltrace 启动 Python 解释器，那么它就可以工作（这以前会导致上面的段错误）：

```
$ ltrace python2
__libc_start_main(0x400710, 1, 0x7fff640c6f38, 0x400810 <unfinished ...>
Py_Main(1, 0x7fff640c6f38, 0x7fff640c6f48, 0x400710Python 2.7.3 (default, Dec 12 2012,07:12:24) 
[GCC 4.7.2] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> from dolfin import *
>>> 
```

ltrace运行时为什么没有segfault？

**更新 2**

结果证明通过 CMake 配置 -DCMAKE_BUILD_TYPE=Debug 仍然允许将优化标志“-O”传递给 g++。我将尝试使用调试符号（标志“-g”）进行重建，看看情况如何。

**更新 3**

使用 -g 标志编译没有区别。

**更新 4**

直接从 gdb 运行不会暴露分段错误（可能它使用某种形式的 ltrace，如上所述）：

```
$ gdb --args python2 -c "import dolfin; print dolfin.__version__"
GNU gdb (GDB) 7.5.1
Copyright (C) 2012 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-unknown-linux-gnu".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /usr/bin/python2...(no debugging symbols found)...done.
(gdb) run
Starting program: /usr/bin/python2 -c import\ dolfin\;\ print\ dolfin.__version__
warning: Could not load shared library symbols for linux-vdso.so.1.
Do you need "set solib-search-path" or "set sysroot"?
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/usr/lib/libthread_db.so.1".
Traceback (most recent call last):
  File "/usr/share/gdb/auto-load/usr/lib/libgobject-2.0.so.0.3400.3-gdb.py", line 9, in <module>
from gobject import register
  File "/usr/share/glib-2.0/gdb/gobject.py", line 3, in <module>
    import gdb.backtrace
ImportError: No module named backtrace
1.0.0+
[Inferior 1 (process 8008) exited normally]
(gdb) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T01:11:53.087

> 我曾尝试通过 gdb 检查核心文件......但它们总是被截断

在实时进程上使用 GDB：

```
gdb --args python2 -c "import dolfin; print dolfin.__version__"
(gdb) run 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T22:38:08.413

我对 dolfin 也有类似的问题。罪魁祸首是英伟达驱动程序。我将它从最新版本回滚，一切又恢复了。我必须通过 /var/log/messages 找到核心转储，使用 gdb 运行它。顶部的某个地方是 nvidia 库。

# c# - 如何克隆 MemoryStream 对象？

> ID：13962015
> 
> 赞同：10
> 
> 时间：2012-12-19T22:03:07.510
> 
> 标签：c#, stream, xmlreader, memorystream

我有一个`MemoryStream`由`Stream`类型参数传递的对象
（`Stream`在 C# 中是抽象类）。

我想克隆他并`MemoryStream`在原件当前位置的一侧创建另一个对象，并从中创建一个新对象`XMLReader`，这样我就可以读取它的内容。

这就是我所做的，但它不起作用（调试标有**//*** ->的行`newReader`有`{None}`值）
**假设**：你在一个方法中并且有`Stream currentStream`参考。

```
var x = new XmlReaderSettings();
x.IgnoreWhitespace = true;  

 using (var newMemoryStream = new MemoryStream())
 {
         stream.CopyTo(newMemoryStream);

         using (var newReader = XmlReader.Create(newMemoryStream,x)) //*
         {

           Doing some stuff...

         }
 } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T22:08:51.483

确保像这样重置位置`newMemoryStream`：

```
newMemoryStream.Position = 0; 
```

在创建之后`stream.CopyTo(newMemoryStream);`但之前`XmlReader`

所以整个事情应该是这样的：

```
var x = new XmlReaderSettings();
x.IgnoreWhitespace = true;  

using (var newMemoryStream = new MemoryStream())
{
    stream.CopyTo(newMemoryStream);
    newMemoryStream.Position = 0;

    using (var newReader = XmlReader.Create(newMemoryStream,x)) //*
    {
        Doing some stuff...
    }
} 
```

此外，由于您在输入此方法之前在原始流上使用了另一个阅读器，因此请确保`Position`源流的 真正位于您想要的位置。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-20T11:11:24.610

我已经解决了我的问题！:)
缺少的东西标有`//*`。这是应该的代码：

```
var xmlReaderSettings = new XmlReaderSettings();

stream.Position = 0;//*
xmlReaderSettings.IgnoreWhitespace = true;
using (var newMemoryStream = new MemoryStream())
{
    stream.CopyTo(newMemoryStream);
    newMemoryStream.Position = 0;  //*
    using (var newReader = XmlReader.Create(newMemoryStream, xmlReaderSettings))
    {
        newReader.MoveToContent(); //*

        Doing some stuff...
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-05-05T14:07:14.347

您可以使用以下扩展方法克隆 a `MemoryStream`，包括其当前位置，并确保`MemoryStream`克隆后将原始位置重置为其原始位置：

```
public static MemoryStream Clone(this MemoryStream ms) {
    var pos = ms.Position;
    var ms2 = new MemoryStream();
    ms.CopyTo(ms2);
    ms.Position = pos;
    ms2.Position = pos;
    return ms2;
} 
```

# sql - SQL 按日期名称排序不起作用

> ID：13962016
> 
> 赞同：3
> 
> 时间：2012-12-19T22:03:09.053
> 
> 标签：sql, sql-server, tsql

我的查询是

```
USE MyDB

SELECT DATENAME(DD, s.requestdate)
FROM   sample_table s
WHERE  MONTH(s.requestdate) = 12
GROUP  BY DATENAME(DD, s.requestdate)
ORDER  BY DATENAME(DD, s.requestdate) DESC 
```

我期望的输出是按月中的一天降序排列的，但我的输出是这样排序的

```
9
8
 7....till 1 then 19, 18...till 11 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T22:05:22.167

[`DATENAME`](http://msdn.microsoft.com/en-gb/library/ms174395.aspx)返回一个字符串。

改为使用[`DATEPART(DD,s.requestdate)`](http://msdn.microsoft.com/en-us/library/ms174420.aspx)它返回一个整数并按照您的预期排序。

# php - 在php脚本中提交后重定向

> ID：13962020
> 
> 赞同：1
> 
> 时间：2012-12-19T22:03:18.023
> 
> 标签：php, javascript, html, header

我知道代码很长......但我希望我正在寻找的解决方案简单快捷。所以我有一个关于我的订单的会议。我有两种形式的回显，具体取决于该人是否已登录。首先，如果语句是用户是否已登录，它会执行所有这些操作（我知道代码并不完美，但它对我有用）。问题：下订单后如何将用户重定向到他们的帐户？我在 }else{... 不起作用之前尝试了 header 功能，直接将我带到了帐户页面。我在网上找不到代码，因为它们的表单都在 html 中，而不是在 php 中，所以标题不起作用。有什么建议？？？

```
<?php

    $memberOrder = "";
    $nonmemberOrder = "";

if(isset($_SESSION['id'])){

    include_once "connect_to_mysql.php";

    echo '<script type="text/javascript">

    function validate_form ( ) { 
    var numbers = /^[0-9]+$/;
    valid = true;

    if ( document.memberOrder.memberNumber.value == "" ) { 
    alert ( "Membership number must be entered." ); 
    valid = false;
    }
    if ( document.memberOrder.memberNumber.value.match(numbers)){
        valid = true;
    }else{
        alert ( "You must only have numbers entered as Membership Number.");
        valid = false;
    }
    if ( document.memberOrder.payment.value == "" ) { 
    alert ( "You must select a payment method." ); 
    valid = false;
    }
    if ( document.memberOrder.orderLinks.value == "" ) { 
    alert ( "You must insert a link to your order." ); 
    valid = false;
    }
    if ( document.memberOrder.size.value == "" ) { 
    alert ( "Size must not be blank." ); 
    valid = false;
    }
    if ( document.memberOrder.cost.value == "" ) { 
    alert ( "Cost must not be blank." ); 
    valid = false;
    }
    if ( document.memberOrder.cost.value.match(numbers)){
        valid = true;
    }else{
        alert ( "You must only have numbers entered as your item cost.");
        valid = false;
    }
    if (!document.memberOrder.checkbox.checked){
        alert ( "You must agree to terms before placing your order.");
        valid = false;
    }
    return valid;
    }
    </script>';

    $memberNumber = preg_replace("[^0-9]", "", $_POST['memberNumber']);
    $memberNumber = stripslashes($_POST['memberNumber']);
    $size = preg_replace("[^a-zA-Z]", "", $_POST['size']);
    $cost = preg_replace("[^0-9]", "", $_POST['cost']);
    $cost = stripslashes($_POST['cost']);
    $cost = strip_tags($cost);
    $color = preg_replace("[^a-zA-Z]", "", $_POST['color']);
    $color = stripslashes($_POST['color']);
    $color = strip_tags($color);
    $payment = $_POST['payment'];
    $orderLinks = $_POST['orderLinks'];

    $sql = mysql_query("INSERT INTO memberOrders (memberNumber, orderLinks, cost) VALUES 
                        ('$memberNumber', '$orderLinks', '$cost')") or die (mysql_error());

    $memberOrder = '<form action="order.php" method="post" name="memberOrder" id="memberOrder" onsubmit="return validate_form ( );">
                    <table cellpadding="10" width="500px">
                        <tr>
                            <td><div align="left">Membership Number</div></td>
                            <td><input type="text" name="memberNumber" id="memberNumber"  /></td>
                        </tr>
                        <tr>
                            <td><div align="left">Payment Type</div></td>
                            <td><input type="radio" name="payment" value="Bank Transfer" />Bank Transfer (recommended)<br/>
                                <input type="radio" name="payment" value="PayPal" />PayPal (additional 3% commission)<br/>
                                <input type="radio" name="payment" value="Western Union" />Western Union<br/>
                                <input type="radio" name="payment" value="MoneyGram" />MoneyGram<br/>
                            </td>
                        </tr>
                        <tr>
                            <td><div align="left">Link To Your Order</div></td>
                            <td><textarea rows="5" cols="20" name="orderLinks"  ></textarea></td>
                        </tr>
                        <tr>
                            <td><div align="left">Size</div></td>
                            <td><input style="width:50px" type="text" size="25px" name="size"  /></td>
                        </tr>
                        <tr>
                            <td><div align="left">Color</div></td>
                            <td><input type="text" size="25px" name="color"  /></td>
                        </tr>
                        <tr>
                            <td><div align="left">Cost of Your Item</div></td>
                            <td><input style="width:50px" type="text" name="cost"  /></td>
                        </tr>
                        <tr>
                            <td><div align="left">Order Agreement</div></td>
                            <td><input type="checkbox" name="checkbox" checked="checked" value="check" /><a href="#" id="agreement">View Order Agreement</a></td>
                        </tr>
                        <tr>
                            <td>&nbsp;</td>
                            <td><input type="submit" name="submit" value="Place Order!" /></td>
                        </tr>
                        </table>
</form>';
    echo $memberOrder;

    // Start assembly of Email Member the activation link
    $to = "yankeesmarket@gmail.com";
    // Change this to your site admin email
    $from = "$memberNumber";
    $subject = "Member Order Placed";
    //Begin HTML Email Message where you need to change the activation URL inside
    $message = '<html>
    <body bgcolor="#FFFFFF">
    Member Number:  '.$memberNumber.' <br/><br/>
    Payment Type:  '.$payment.' <br/><br/>
    Order Links:  '.$orderLinks.' <br/><br/>
    Size:  '.$size.' <br/><br/>
    Color: '.$color.' <br/><br/>
    Order Cost: '.$cost.' <br/><br/>
    </body>
    </html>';
    // end of message
    $headers = "From: $from\r\n";
    $headers .= "Content-type: text/html\r\n";
    $to = "$to";
    // Finally send the activation email to the member
    mail($to, $subject, $message, $headers);

}else{ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:08:49.003

您不能向浏览器写入任何内容并期望该`header`功能正常工作。为了设置标头，响应正文必须为空。

所以我建议做类似的事情：

```
if(isset($_POST['submit'])){
    // do the INSERT and whatnot
    // when finished call the header function
    header("Location: my_custom_page.php");
}
else{
    // output the form, javascript and what you need
} 
```

所以页面第一次加载时，它会进入`else`语句，因为你没有 POST 数据。这将打印出表单和验证 JavaScript。当表单被提交时，请求到达`if`，并下订单，然后客户端被重定向。

同样，在`if`声明中，您不得制作任何`echo`s。对此的一个非常糟糕的替代方法是回显一个执行重定向的小型 javascript（我**不**推荐这样做。永远）：

```
<script>window.location.href = 'my_custom_page.php';</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:12:28.160

以下是我将如何构建该过程：

1.  验证用户是否已登录
2.  验证电子邮件字段（存在、格式等）
3.  将数据存储在 MySQL 中。如果插入成功，是否继续邮寄？
4.  尝试邮寄信息。[如果成功，则使用标头](http://us1.php.net/manual/en/function.header.php)函数进行重定向。
5.  如果不成功，请继续输出页面和任何错误消息。

请记住，即使一个字符已输出或呈现到页面，您也无法更改页眉。

*此外，*您应该选择使用另一种邮件传递方式，因为`mail()`邮件将保证进入垃圾文件夹，因为它使用发件人标头中的服务器信息。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-19T22:14:09.210

如果你想使用 JS，你可以随时在 html 中执行：

```
<script>
  window.location.href = <?php echo $url; ?>
</script> 
```

# android - Android：获取光传感器的最大值

> ID：13962023
> 
> 赞同：6
> 
> 时间：2012-12-19T22:03:27.237
> 
> 标签：android, algorithm, android-sensors

对于我的应用程序，我需要获得光传感器的最大值。我认为所有具有光传感器（即 SensorManager.LIGHT_SUNLIGHT_MAX）的设备都是一样的，但根据在设备上进行的示例测试，我错了。

问题是使用 SensorListener 您只能知道值何时更改。

所以我的问题是：如何获得光传感器的最大值（假设用户可以在传感器前面放置一个强大的光，即光值> 最大传感器值）？

一个解决方案可能是着眼于价值增长，但我不知道如何管理它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-25T08:40:43.190

使用以下方法：

```
getMaximumRange() 
```

执行 ：

```
SensorManager sensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
Sensor lightSensor = sensorManager.getDefaultSensor(Sensor.TYPE_LIGHT);
maxvalue = lightSensor.getMaximumRange(); 
```

资源 ：

[http://developer.android.com/reference/android/hardware/Sensor.html#getMaximumRange](http://developer.android.com/reference/android/hardware/Sensor.html#getMaximumRange) ()

# spring - 为 DataSourceTransactionManager 设置自定义隔离级别

> ID：13962026
> 
> 赞同：0
> 
> 时间：2012-12-19T22:03:34.803
> 
> 标签：spring, transactions, isolation-level, transactionmanager

如何为 DataSourceTransactionManager 启用自定义隔离级别？

我的 spring 配置文件中有以下内容。

```
<bean id="transactionManager"class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
    <property name="dataSource" ref="myDataDource"/>    
</bean>

<bean id="myTransactionProxy" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean" abstract="true" lazy-init="false" autowire="default" dependency-check="default">
  <property name="transactionManager">
     <ref bean="transactionManager" /> 
  </property>
  <property name="transactionAttributes">
     <props>
        <prop key="cancel">PROPAGATION_REQUIRED,ISOLATION_READ_UNCOMMITTED,timeout_25,-Exception</prop>
     </props>
  </property>
</bean> 
```

但是当我尝试运行它时，它给了我以下错误。

```
org.springframework.transaction.InvalidIsolationLevelException: JtaTransactionManager does not support custom isolation levels by default - switch 'allowCustomIsolationLevels' to 'true' 
```

我没有使用 JtaTransactionManager，为什么会收到关于此的警告？以及如何为 DataSourceTransactionManager 启用自定义隔离级别？在文档中，提到这个类将支持自定义隔离级别，但我没有在网上找到任何示例。其中大部分仅适用于 JtaTransactionManager。只是想知道是否有人可以帮助我解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T15:15:28.513

`TransactionManager`可以是 DataSourceTransactionManager 或 JtaTransactionManager 或 JpaTransactionManager，无论是什么，我们都可以使用`@Transactional`注解配置隔离级别。

如果启用了`<tx:annotation-driven />`支持放置在 DAO 或服务级别上的注释的上下文文件，它会识别事务。

`isolation`的属性`@Transactional`将允许您配置它们。

`@Transactional(isolation = Isolation.READ_COMMITTED)` `public void save(Country country) { // do some operations }`

参考：[隔离级别](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/transaction/annotation/Isolation.html)，[事务性](http://static.springsource.org/spring/docs/2.0.x/api/org/springframework/transaction/annotation/Transactional.html)

我不确定配置 xml 文件

希望这可以帮助。:)

# php - 根据用户所在国家/地区显示 jquery 价格表

> ID：13962027
> 
> 赞同：1
> 
> 时间：2012-12-19T22:03:54.513
> 
> 标签：php, jquery, html, css

我是一名前端开发人员，我想对客户的网站做的是：我想在一个独特的页面上创建两个不同的价目表。我将在 jquery 和 css 中执行它们。我希望来自意大利的用户将看到价目表 n°1，而来自西班牙的用户将看到价目表 n°2。

意大利用户必须无法查看西班牙用户的价目表，反之亦然。

你能否给我一个关于如何实现这一点的提示，可能还有一些示例行？

谢谢大家最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:32:14.550

首先，您需要定义西班牙语和意大利语的含义，更具体地说，您将如何区分它们。

您可以检查浏览器设置（客户端，但根本不准确），或者您可以进行 IP 地理定位。这是在服务器端完成的，您可以使用不同的第三方服务。如果可用，您可以在客户端使用地理定位 API，但同样不准确，因为在桌面浏览器上，用户可以轻松更改其位置。

您将如何进行 IP 地理定位取决于服务器端技术和使用的服务。您可以使用 JSONP 之类的东西在客户端执行此操作，但同样不安全。

由于用户可以使用来自其他国家/地区的代理，因此甚至 IP 地理定位也无法完全证明。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:39:10.983

如果 jQuery 可以看到这两个版本，那么意大利人或西班牙人也可以通过查看代码来查看。

看看[http://dev.maxmind.com/geoip/mod_geoip2](http://dev.maxmind.com/geoip/mod_geoip2)。使用此模块，您的服务器上可以有 2 个不同的价目表（或 3 个 - 一个用于世界其他地区），并为用户提供适合他们国家/地区的价目表。

# internet-explorer-9 - Internet Explorer 9 策略设置正在影响 window.postMessage

> ID：13962032
> 
> 赞同：4
> 
> 时间：2012-12-19T22:04:15.477
> 
> 标签：internet-explorer-9

我有`window.postMessage`一个 JavaScript 文件。由于某些策略设置，这似乎在 IE9 中失败。我不知道这是什么政策。有谁知道它可能是哪一个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-16T22:36:11.693

我相信您正在寻找的关键是：

HKEY_CURRENT_USER\Software\Policies\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_CROSS_DOCUMENT_MESSAGING

如果设置了上述注册表项，则 IE（据我所知的所有版本）将为 window.postMessage 函数返回 undefined。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-03T08:52:33.747

让我在评论之外进一步阐述。正如你在这里看到的：

[http://javascript.info/tutorial/cross-window-messaging-with-postmessage](http://javascript.info/tutorial/cross-window-messaging-with-postmessage)

如果我在家中使用普通的 IE9 或在 browserstack.com 上使用的 IE9，则消息在 iframe 内可以正常加载。但是，如果我使用我们的 Intranet IE9，我会在 JS 控制台中收到以下错误：

```
SCRIPT16385: Not implemented

cross-window-messaging-with-postmessage, line 1 character 1
SCRIPT1002: Syntax error 
all.js, line 1 character 1 
```

这似乎是一些阻止 postMessage 调用的安全设置。

# rest - SOAPUI 错误：尝试从关闭的流中读取 JSON POST 以在 302 之后重定向到 GET

> ID：13962043
> 
> 赞同：3
> 
> 时间：2012-12-19T22:04:58.007
> 
> 标签：rest, testing, groovy, soapui

我正在尝试测试用于添加/更新成员记录的 Rest 服务 API 方法，具有以下详细信息： **参数**：post-body（JSON 文档）- 表示成员及其数据源的对象 **内容类型**：application/json **返回**：成功HTTP 302 - 重定向到获取

当我尝试在 SOAPUI 中进行测试时，出现以下错误：

搜搜日志：

```
Wed Dec 19 11:16:02 EST 2012:DEBUG:Attempt 1 to execute request
Wed Dec 19 11:16:02 EST 2012:DEBUG:Sending request: POST http://.............................................................. HTTP/1.1
Wed Dec 19 11:16:02 EST 2012:DEBUG:Receiving response: HTTP/1.1 302 FOUND
Wed Dec 19 11:16:02 EST 2012:DEBUG:Connection can be kept alive indefinitely
Wed Dec 19 11:16:02 EST 2012:DEBUG:Connection closed
Wed Dec 19 11:16:02 EST 2012:DEBUG:Connection shut down
Wed Dec 19 11:16:02 EST 2012:ERROR:An error occured [Attempted read from closed stream.], see error log for details
Wed Dec 19 11:16:02 EST 2012:ERROR:Exception in request: java.net.UnknownHostException: ANY URL as ENDPOINT
Wed Dec 19 11:16:02 EST 2012:ERROR:An error occured [ANY URL...], see error log for details
Wed Dec 19 11:16:02 EST 2012:INFO:Error getting response for [Rest_Srvc_Member_Put.Rsrc_Member_Put:Rest_Req_Member_Put]; java.net.UnknownHostException: ANY URL as ENDPOINT 
```

错误日志：

```
Wed Dec 19 11:16:02 EST 2012:ERROR:java.io.IOException: Attempted read from closed stream.
   java.io.IOException: Attempted read from closed stream.
    at org.apache.http.impl.io.ContentLengthInputStream.read(ContentLengthInputStream.java:166)
    at org.apache.http.impl.io.ContentLengthInputStream.read(ContentLengthInputStream.java:197)
    at org.apache.http.conn.EofSensorInputStream.read(EofSensorInputStream.java:155)
    at org.apache.http.util.EntityUtils.toByteArray(EntityUtils.java:100)
    at org.apache.http.entity.BufferedHttpEntity.<init>(BufferedHttpEntity.java:60)
    at com.eviware.soapui.impl.wsdl.submit.transports.http.HttpMethodSupport.getResponseBody(HttpMethodSupport.java:281)
    at com.eviware.soapui.impl.wsdl.submit.transports.http.support.methods.ExtendedPostMethod.getResponseBody(ExtendedPostMethod.java:128)
    at com.eviware.soapui.impl.wsdl.submit.transports.http.SinglePartHttpResponse.<init>(SinglePartHttpResponse.java:49)
    at com.eviware.soapui.impl.wsdl.submit.filters.HttpPackagingResponseFilter.httpRequest(HttpPackagingResponseFilter.java:85)
    at com.eviware.soapui.impl.wsdl.submit.filters.HttpPackagingResponseFilter.afterAbstractHttpResponse(HttpPackagingResponseFilter.java:50)
    at com.eviware.soapui.impl.wsdl.submit.filters.AbstractRequestFilter.afterRequest(AbstractRequestFilter.java:64)
    at com.eviware.soapui.impl.wsdl.submit.transports.http.HttpClientRequestTransport.sendRequest(HttpClientRequestTransport.java:297)
    at com.eviware.soapui.impl.wsdl.WsdlSubmit.run(WsdlSubmit.java:123)
    at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Wed Dec 19 11:16:02 EST 2012:ERROR:java.net.UnknownHostException: ...URL
   java.net.UnknownHostException: URL
    at java.net.InetAddress.getAllByName0(Unknown Source)
    at java.net.InetAddress.getAllByName(Unknown Source)
    at java.net.InetAddress.getAllByName(Unknown Source)
    at org.apache.http.impl.conn.DefaultClientConnectionOperator.resolveHostname(DefaultClientConnectionOperator.java:242)
    at com.eviware.soapui.impl.wsdl.support.http.SoapUIMultiThreadedHttpConnectionManager$SoapUIClientConnectionOperator.openConnection(SoapUIMultiThreadedHttpConnectionManager.java:274)
    at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:149)
    at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:121)
    at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:561)
    at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:415)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:754)
    at com.eviware.soapui.impl.wsdl.support.http.HttpClientSupport$Helper.execute(HttpClientSupport.java:236)
    at com.eviware.soapui.impl.wsdl.support.http.HttpClientSupport.execute(HttpClientSupport.java:345)
    at com.eviware.soapui.impl.wsdl.submit.transports.http.HttpClientRequestTransport.followRedirects(HttpClientRequestTransport.java:357)
    at com.eviware.soapui.impl.wsdl.submit.transports.http.HttpClientRequestTransport.sendRequest(HttpClientRequestTransport.java:256)
    at com.eviware.soapui.impl.wsdl.WsdlSubmit.run(WsdlSubmit.java:123)
    at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

非常感谢您为解决此问题提供的任何帮助。我正在使用 SOAPUI Pro 4.5.1 请尽快帮忙......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-27T13:02:57.460

尝试在以下文件中添加 IP 地址到主机名的映射：“C:\Windows\System32\drivers\etc\hosts”。

# magento - Magento 添加到购物车到购物车页面

> ID：13962060
> 
> 赞同：0
> 
> 时间：2012-12-19T22:05:49.520
> 
> 标签：magento, magento-1.7

我正在为一个站点使用 Magento CE 1.7。使用的主题覆盖了 Magento 中的默认行为，在将商品添加到购物车后，用户将被带到购物车页面；使用这个主题，用户仍然在同一个产品页面上，弹出一个 jquery 层以显示该项目已添加。

我希望用户每次将商品添加到购物车时都被带到购物车页面。我怎样才能做到这一点？

谢谢。-TM值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:10:45.083

像[这里](http://www.magentocommerce.com/boards/viewthread/296763/)一样填写return_url有帮助吗？所以你会得到类似的东西：

[http://www.example.com/checkout/cart/add?Product=76&qty=1&return_url=http%3A%2F%2Fwww.example.com%2Fcheckout%2Fcart%2F](http://www.example.com/checkout/cart/add?Product=76&qty=1&return_url=http%3A%2F%2Fwww.example.com%2Fcheckout%2Fcart%2F)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:12:39.547

修改设计以不通过 javascript 将项目添加到购物车，而是像 magento 默认行为一样转到链接？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:41:33.160

查找 app/code/community 和/或 app/code/local 中存在的自定义模块，并尝试找出可能执行此操作的模块 - 可能名为 AjaxCart 或类似名称。如果您发现了它，请尝试通过编辑文件 app/etc/modules/NAME_OF_THAT_MODULE.xml 并将已激活从 true 设置为 false 来停用它。然后测试是否恢复正常行为。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T22:43:14.307

看一看 @

/app/design/frontend/default/[主题]/template/catalog/product/view/addtocart.phtml

默认`onclick`方法应该是`productAddToCartForm.submit(this)`. 如果您的自定义模板具有相同的`onclick`方法，请查看基础和自定义主题 productAddToCartForm`submit()`方法。

```
<button type="button" title="<?php echo $buttonTitle ?>" class="button btn-cart" onclick="productAddToCartForm.submit(this)"><span><span><?php echo $buttonTitle ?></span></span></button> 
```

也看看@ Admin -> System -> Config -> Sales -> Checkout -> Shopping Cart -> After Add a Product Redirect to Shopping Cart

# ios - UIImageView 恢复到原始帧

> ID：13962061
> 
> 赞同：0
> 
> 时间：2012-12-19T22:05:52.087
> 
> 标签：ios, uiviewanimation

我的主页`viewController`打开`UIImageView`一个标志。`viewDidAppear`然后运行两个动画。徽标向上的翻译，以及`UITextField`. 当用户单击`UITextField textFieldDidBeginEditing`运行并将视图的框架设置为动画时（以允许用户查看`UITextField`键盘将覆盖的内容）。当用户单击键盘`textFieldDidEndEditing`运行的任何位置并动画视图的框架时。运行后`textFieldDidEndEditing`，我`UIImageView`又回到了原来的位置（在动画开始之前）。为什么会发生这种情况，我应该如何解决？谢谢。

```
static const CGFloat STARTPAGE_ANIMATION_TIME = 0.5;
-(void)viewDidAppear:(BOOL)animated{
    NSLog(@"viewDidAppear:");

    CGRect logoFrame = logoImage.frame;
    logoFrame.origin.y = 130;
    [UIImageView animateWithDuration:STARTPAGE_ANIMATION_TIME delay:STARTPAGE_ANIMATION_TIME options:UIViewAnimationCurveEaseInOut animations:^{
        logoImage.frame = logoFrame;
    } completion:^(BOOL finished) {
        NSLog(@"logoImageAnimation");
    }];

    [UIImageView animateWithDuration:STARTPAGE_ANIMATION_TIME delay:STARTPAGE_ANIMATION_TIME options:UIViewAnimationCurveEaseInOut animations:^{
        searchField.alpha = 1;
    } completion:^(BOOL finished) {
        NSLog(@"searchFieldAnimation");
    }];
}

CGFloat ANIMATED_DISTANCE = 200;
static const CGFloat KEYBOARD_ANIMATION_DURATION = 0.3;

- (void)textFieldDidBeginEditing:(UITextField *)textField{
    NSLog(@"textFieldDidBeginEditing:");

    CGRect viewFrame = self.view.frame;
    viewFrame.origin.y -= ANIMATED_DISTANCE;
    [UIView animateWithDuration:KEYBOARD_ANIMATION_DURATION animations:^{
        self.view.frame = viewFrame;
    } completion:^(BOOL finished) {
        NSLog(@"frameAnimationUp");
    }];
}

- (void)textFieldDidEndEditing:(UITextField *)textField{
    NSLog(@"textFieldDidEndEditing:");

    CGRect viewFrame = self.view.frame;
    viewFrame.origin.y += ANIMATED_DISTANCE;
    [UIView animateWithDuration:KEYBOARD_ANIMATION_DURATION animations:^{
        self.view.frame = viewFrame;
    } completion:^(BOOL finished) {
        NSLog(@"frameAnimationDown");
    }];
}

- (void)touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event{
    NSLog(@"touchesBegan:withEvent:");
    [self.view endEditing:YES];
    [super touchesBegan:touches withEvent:event];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:36:29.663

它可能与相互影响的动画有关。如果您在动画发生时开始编辑，这取决于时间，添加和减去一个值`y`是不可预测的。

在移动之前将原始帧保存在属性上，然后重置帧。当您处理多个重叠动画时，这将产生更可预测的结果。

# c++ - 安置一个 POD

> ID：13962063
> 
> 赞同：14
> 
> 时间：2012-12-19T22:06:04.230
> 
> 标签：c++, c++11, vector, emplace

> **可能重复：**
> [vector<struct> 上的 C++11 emplace_back？](https://stackoverflow.com/questions/13812703/c11-emplace-back-on-vectorstruct)

是否可以使用 POD 进行安置？它似乎在 Visual Studio 2012 中不起作用：

```
struct X
{
    int a;
    int b;
};

void whatever()
{
    std::vector<X> xs;
    X x = {1, 2};

    // okay
    xs.push_back(x);

    // okay
    xs.emplace_back(x);

    //error C2661: 'X::X': error C2661: no overloaded function takes 2 arguments
    xs.emplace_back(1, 2);
} 
```

这只是 Visual Studio 2012 的一个缺点，还是在 C++11 中放置 POD 根本不起作用？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-19T22:13:28.173

没有构造函数`X::X(int,int)`，这是您调用`emplace_back`将用来构造`X`对象的内容。容器用于`allocator_traits<A>::construct(allocator, p, args)`构造对象，其中`p`是指向某些分配空间的指针，并且`args`是传递给构造函数的参数。这是由`emplace_back`. 此`construct`函数调用`::new((void*)p) T(std::forward<Args>(args)...)`，因此它不使用统一初始化。

`xs.emplace_back({1, 2})`也将是一个错误，尽管可以使用列表初始化构造聚合。这是因为大括号括起来的初始值设定项列表不能被转发。

# hibernate - 通过用户名 DAO/hibernate 删除记录

> ID：13962072
> 
> 赞同：0
> 
> 时间：2012-12-19T22:07:05.927
> 
> 标签：hibernate, jakarta-ee, spring-mvc, dao

如何删除与一个用户关联的所有记录，例如，我想删除我的数据库中所有者当前登录用户的 5 条记录。这是我的代码：

```
public void deleteOrders() {

    Authentication auth = SecurityContextHolder.getContext()
            .getAuthentication();
    String user = auth.getName(); // get logged in username
    getHibernateTemplate().delete(
            "FROM " + Orders.class.getName() + " WHERE username='" + user
                    + "'");
} 
```

我正在尝试这样的事情，但它失败了，我无法继续前进。怎么做才对？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:29:28.447

[`HibernateTemplate.delete()`](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/orm/hibernate3/HibernateTemplate.html#delete%28java.lang.Object%29)将要删除的实体实例作为参数。它不需要 HQL 查询。

用于`bulkUpdate()`执行删除查询。甚至更好的是，忘记已弃用的 HibernateTemplate，直接使用 Hibernate API。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:25:02.053

好吧，这可能行不通，因为`class.getName()`包括包路径，但是如果您的类名与表名相同，则`getSimpleName()`可能会起作用：

```
"FROM " + Orders.class.getSimpleName() + " WHERE ..." 
```

但是，我倾向于做这样的事情：

```
entityManager.createNativeQuery("delete from orders where ...").execute(); 
```

# asp.net - 块读数据一段时间

> ID：13962076
> 
> 赞同：0
> 
> 时间：2012-12-19T22:07:15.603
> 
> 标签：asp.net, sql-server-2008

我在 asp.net webforms 中编写了 Web 应用程序，在那里我为用户提供了任务池，但我遇到了一些难题。当用户选择某个任务时，另一个用户应该不能选择相同的任务。

我的实际想法是将日期为“Period”的列添加到带有任务的表（sql server）中，当用户处理它时，它会更新，并且列“busy”。在后台会运行一些线程，每个线程都会更新这个日期。5分钟和一次将“忙碌”设置为1。（当用户打开带有任务的站点时开始）

在数据库中，我将有一份工作将开始每个前任。7 分钟，如果“期间”中的日期时间早于 5 分钟，则将“忙碌”列设置为 0，然后任务将返回池中。

因此，当用户完成任务时，工作会在一段时间后将其推回池中。当然，用户可以单击某个按钮并将忙 o 设置为 0。我想实现该任务在有人工作时不可用。我不知道这是否是好的方法。Mayby somene 对这种情况有任何经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T11:02:05.217

我认为这不是一个好方法。

您正在执行的任务基本上是实现功能的工作，如果您将其交付给客户，这是一个很大的问题。

我建议你使用锁定表。检查这个 [http://msdn.microsoft.com/en-us/library/aa213026(v=sql.80).aspx](http://msdn.microsoft.com/en-us/library/aa213026(v=sql.80).aspx)

此外，如果您在代码中使用数据库，强烈建议使用事务。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T11:19:21.560

这根本不是一个好方法。

首先，您正在为简单的事情创建一个过于复杂的解决方案。

您从定义任务的状态开始......例如：

*   待办的
*   忙（当用户打开并开始处理它时）
*   完成的

当用户打开任务时，您只需将任务直接更新为忙碌即可。当您调用 Update 语句时，数据库将只忍受一个客户端更改表的状态。

然后你得到行数，如果它是 1，那么你现在拥有任务的所有权，只有在这种情况下你返回任务信息，否则，只会引发错误。

您需要在 ASP.NET 中处理此错误。

例如：

```
UPDATE MY_TASKS SET STATUS = 'Busy' WHEN TASK_ID = 'some-id' AND TASK_STATUS <> 'Busy'

IF @@ROWCOUNT = 1
BEGIN
    SELECT * FROM MY_TASKS WHERE TASK_ID = 'some-id'

END
ELSE
BEGIN
    RAISERROR('Another user is working on this task', 16, 1) 
END 
```

您可以根据需要装饰此代码，设置最大周期，创建更多状态，控制状态之间的转换，就像在有限状态机中一样......但请不要试图用原子弹杀死苍蝇。

# ruby-on-rails - 如何重构嵌套的 case 语句（在这种情况下）？

> ID：13962077
> 
> 赞同：0
> 
> 时间：2012-12-19T22:07:21.290
> 
> 标签：ruby-on-rails, ruby, refactoring, switch-statement

我正在使用 Ruby on Rails 3.2.9 和 Ruby 1.9.3。我有以下`case`陈述：

```
case
when private?
  case
  when not_active? then [:a, :b, :c, :d]
  when active?     then raise "private cannot be active"
  else raise "not recognized"
  end
when shared?
  case
  when not_active? then [:a, :b, :c]
  when active?     then raise "shared cannot be active"
  else raise "not recognized"
  end
when public?
  case
  when not_active? then [:a, :b]
  when active?     then [:a]
  else raise "not recognized"
  end
else raise "not recognized"
end 
```

如何重构上面的代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T00:18:02.930

```
raise "not recognized" unless private? or shared? or public?
raise "not recognized" unless not_active? or active?
raise "private cannot be active" if private? and active?
raise "shared cannot be active" if shared? and active?

[:a, *(:b unless active?), *(:c unless public?), *(:d if private?)] 
```

* * *

通过更改错误消息，您可以使其更加舒适：

```
raise "visibility not recognized" unless private? or shared? or public?
raise "activeness not recognized" unless not_active? or active?
raise "active must be public" if active? and not public?

[:a, *(:b unless active?), *(:c unless public?), *(:d if private?)] 
```

顺便说一句，`inactive?`这将是一个比`not_active?`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:21:11.593

有组织的：

```
CONDITIONS = 
  {"private?" => {"not_active?" => [:a, :b, :c, :d],
                  "active?"     => "private cannot be active"},
  {"shared?"  => {"not_active?" => [:a, :b, :c],
                  "active?"     => "shared cannot be active"},
  {"public?"  => {"not_active?" => [:a, :b],
                  "active?"     => [:a]}}

def foo(it)
  value = "not recognised"
  CONDITIONS.each do |k, v|
    if it.send(k.to_sym)
      v.each do |inner_k, inner_v|
        if it.send(inner_k.to_sym)
          value = inner_v
        end
      end
    end
  end

  raise value if (value.class.name == "String")

  value
end 
```

在扩展的情况下，您只需要使 CONDITIONS 散列更大。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T00:19:48.893

干燥的恋物癖：

```
class Public
  def not_active; [:a, :b]; end
  def active; not_active.first; end
  def missing_method; false; end
end

class Shared < Public
  def not_active; super << :c; end
  def active; raise "#{self.class.name.underscore} cannot be active"; end
end

class Private < Shared
  def not_active; super << :d; end
end

state = active? ? :active : (not_active? ? :not_active : :missing_method)
(Private.new.send(state) if private?)||
(Shared.new.send(state) if shared?)||
(Public.new.send(state) if public?)||raise("not recognized") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T01:49:55.163

使用数组怎么样？

```
actions = [
    ['[:a, :b, :c, :d]', 'raise "private cannot be active"'],
    ['[:a, :b, :c]', 'raise "shared cannot be active"'],
    ['[:a, :b]', '[:a]']
]

x = [:private?, :shared?, :public?].find_index { |i| send(i) }
y = [:not_active?, :active?].find_index { |i| send(i) }

if x and y
    eval(actions[x][y])
else
    raise "not recognized"
end 
```

# javascript - 将 Angularjs 与服务器端模板一起使用

> ID：13962084
> 
> 赞同：1
> 
> 时间：2012-12-19T22:07:43.857
> 
> 标签：javascript, angularjs

出于 SEO 的目的，服务器会在初始加载时为给定的 URL 呈现完整的 html 模板。该站点使用 angularjs 检测 URL 路由并从 JSON API 呈现客户端模板。

例如，您导航到：**/blog/post-title**

服务器以**post-title**内容响应。Angular 加载，检测路由：**/blog/:post_slug**并开始加载 JSON 并从响应中呈现客户端模板。

**显然，在初始加载后**跟随链接时，Angular 所做的很好，但在第一次加载时，它会重复工作。

我的问题是是否有一种干净的方法来防止这种情况。

# hibernate - Hibernate + Mysql 没有数据库填充

> ID：13962085
> 
> 赞同：1
> 
> 时间：2012-12-19T22:07:44.340
> 
> 标签：hibernate

我正在尝试一个简单的教程。 [链接到教程](http://codeoncloud.blogspot.com/2012/04/hibernate-beginners-tutorial.html)

我已经按照那里写的所有步骤进行了操作，但仍然无法正常工作。这就是我得到的： ![在此处输入图像描述](../Images/eed38819b555a18b1d106f15f1710803.png)

这是我的主要内容：

```
 /*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package hibernatetest;

import org.hibernate.Session;
import org.hibernate.SessionFactory;

/**
 *
 * @author ktelfon
 */
public class HibernateTest {

    /**
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        // TODO code application logic here
        Session session = null;
        try {
            SessionFactory sessionFactory = new org.hibernate.cfg.Configuration().configure("hibernatetest/hibernate.cfg.xml").buildSessionFactory();
            session = sessionFactory.openSession();
            session.beginTransaction();

            System.out.println("Populating the database !");
            Customer customer = new Customer();
            customer.setCustomerName("Chathura");
            customer.setCustomerAddress("221B,Moratuwa");
            customer.setCustomerEmail("priyankarahac@gmail.com");

            session.save(customer);
            session.getTransaction().commit();

            System.out.println("Done!");
        } catch (Exception e) {
            System.out.println(e.getMessage());
        } finally {
            session.flush();
            session.close();
        }
    }
} 
```

这是我的cfg：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
  <session-factory>
    <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
    <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
    <property name="hibernate.connection.url">jdbc:mysql://localhost:3306/retailer?zeroDateTimeBehavior=convertToNull</property>
    <property name="hibernate.connection.username">root</property>
    <property name="hibernate.connection.password">root</property>
    <property name="show_sql">true</property>
    <mapping resource="hibernatetest/customersmapping.hbm.xml"/>
    <mapping/>
  </session-factory>
</hibernate-configuration> 
```

还有我的映射：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
  <class name="hibernatetest.Customer" table="customers">
  <id column="C_ID" name="customerID" type="int">
  <generator class="native">
  </generator></id>
  <property name="customerName">
  <column name="name">
  </column></property>
  <property name="customerAddress">
  <column name="address">
  </column></property>
  <property name="customerEmail">
  <column name="email">
  </column></property>
  </class>
</hibernate-mapping> 
```

这里有什么问题？为什么它不会填充我的数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:18:26.313

删除以下元素：

```
<mapping/> 
```

这会导致您的日志中出现异常：

> `<mapping>`配置中的元素未指定属性

我会尝试找到另一个教程，展示如何使用注释而不是 XML 文件进行映射，因为

*   注释更容易
*   注释是映射实体的标准 JPA 方式

# jquery - 下拉菜单 jquery

> ID：13962086
> 
> 赞同：0
> 
> 时间：2012-12-19T22:07:44.540
> 
> 标签：jquery, drop-down-menu

好吧，我知道我已经问过类似的问题，但我很绝望，我需要让这个下拉菜单工作。这是我的代码。

```
<div class="nav-menu">
    <ul class="menu-items">
        <li><a href="#" class="nav-home">Home</a></li>
        <li><a href="#" class="nav-about"About</a></li>
    </ul>
    <div id="dropdown-home" class="dropdown-menu">
        <ul class="dropdown-items">
            <li><a href="#">Something</a></li>
            <li><a href="#">Something else</a></li>
        </ul>
    </div>
    <div id="dropdown-about" class="dropdown-menu">
        <ul class="dropdown-items">
            <li><a href="#">Something</a></li>
            <li><a href="#">Something else</a></li>
        </ul>
    </div>
</div> 
```

我想要做的是，当我将光标悬停在类“nav-home”的元素上时，id 为“dropdown-home”的元素会以某种效果显示。我使用 jquery 尝试过，但我只是在学习，我不知道该怎么做。有人能帮我吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:30:40.340

但是有了这个，文本必须匹配 id .dropdown-[text]

```
 $('ul.menu-items li').on('mouseenter', function() {
        var text = $(this).text().toLowerCase();
       $('div.dropdown-menu').hide();  
       $('div#dropdown-'+text).show();          
    });

    $('ul.menu-items li').on('mouseout', function() {
        $('div.dropdown-menu').hide();        
    }); 
```

[http://jsfiddle.net/XpaB7/4/](http://jsfiddle.net/XpaB7/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:18:12.040

```
$('.menu-items a').hover(function(){
    $('div[id&='+$(this).prop('class').split('-')[1]+']').show();
}, function(){
    $('.dropdown-menu').hide();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:18:21.493

我会推荐[Bootstrap](http://twitter.github.com/bootstrap/index.html)。它具有内置的[下拉](http://twitter.github.com/bootstrap/components.html#dropdowns) [功能](http://twitter.github.com/bootstrap/javascript.html#dropdowns)，应该可以满足您的需求。

```
<div class="dropdown">
  <a class="dropdown-toggle" data-toggle="dropdown" href="#">Dropdown trigger</a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
    <li><a tabindex="-1" href="#">Action</a></li>
    <li><a tabindex="-1" href="#">Another action</a></li>
    <li><a tabindex="-1" href="#">Something else here</a></li>
    <li class="divider"></li>
    <li><a tabindex="-1" href="#">Separated link</a></li>
  </ul>
</div> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T22:18:56.240

试试这个

```
$('.nav-home, .nav-about').on({
    mouseenter: function() {
        var cls = $(this).attr('class').split('-')[1];
        var id = '#dropdown-' + cls;
        $('.dropdown-menu').hide();
        $(id).show();
    },
    mouseout: function() {
        $('.dropdown-menu').hide();
    }
});​ 
```

**[检查小提琴](http://jsfiddle.net/B8WKK/)**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T22:47:12.880

```
<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script>
<style>
    .menu-items, .menu-items a, .menu-items li {
        float:left;
        margin:0;
        list-style:none;
    }
    .menu-items li {
        min-width:150px;
    }
    .dropdown-items, .dropdown-items li {
        float:left;
        clear:both;
        list-style:none;
        margin:0;
        padding:0;
    }
    .dropdown-items {
        display:none;
    }
</style>
<div class="nav-menu">
    <ul class="menu-items">
        <li><a href="#" class="nav-home">Home</a>

            <ul class="dropdown-items">
                <li><a href="#">Something</a>

                </li>
                <li><a href="#">Something else</a>

                </li>
            </ul>
        </li>
        <li><a href="#" class="nav-about">About</a>

            <ul class="dropdown-items">
                <li><a href="#">Something</a>

                </li>
                <li><a href="#">Something else</a>

                </li>
            </ul>
        </li>
    </ul>
</div>
<script type="text/javascript">
    $('.menu-items li').not(":animated").hover(

    function () {

        $(this).find(".dropdown-items").fadeIn(200)
    },

    function () {

        $(this).find(".dropdown-items").fadeOut(200)
    });
</script> 
```

# vba - 自定义排序方法 Excel VBA

> ID：13962094
> 
> 赞同：0
> 
> 时间：2012-12-19T22:08:41.597
> 
> 标签：vba, sorting, excel

我有一列数字，必须像这样排序：

我在 A1 中有一个数字，这是我开始时的精确值 - `10`例如，然后我有如下数字： `9, 8.1, 11, 6, 10.5`

我的目标是从最小的差异中对它们进行分类。它的意思是：

```
10, 10.5, 11, 9, 8.1, 6. 
```

在 Java 中，它将由 compareTo 函数完成。有没有像VBA这样的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:31:16.603

如果不存在更清洁的方法，您可以尝试以下解决方法：

定义一个像这样的距离函数：**abs(x - from)**并按其结果排序，如果您想以透明方式应用排序，可能在临时/隐藏工作表中。

# visual-studio - RhoMobile 和 Visual Studio 2012

> ID：13962099
> 
> 赞同：0
> 
> 时间：2012-12-19T22:09:00.017
> 
> 标签：visual-studio, visual-studio-2012, rhomobile

只是出于兴趣，是否可以使用 Visual Studio 2012 提供的必备库编译 RhoMobile 应用程序。目前，我一直在使用 Visual Studio 2008 的演示进行所有编译，因此我想继续我的开发使用 Visual Studio 2012。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T17:37:58.870

如果您的目标是 Windows Mobile 或 Windows Embedded Handheld，则唯一的选择是使用 Visual Studio 2008。这不是 RhoMobile 的限制，但 Microsoft 决定不在 Visual Studio 2010 和 Visual Studio 2012 中包含对 Windows Mobile 的支持。

# php - 如何在来自 AJAX POST 调用的文件中不包含 htaccess 重定向

> ID：13962100
> 
> 赞同：3
> 
> 时间：2012-12-19T22:09:01.080
> 
> 标签：php, .htaccess

我有一个像这样的htaccess文件

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)/(.*)$ /us/index.php?state=$1&city=$2 [L] 
```

我有一个名为 getuser.php 的文件，它是一个从 index.php 中的 AJAX 调用调用的 php 文件。如果我不使用重定向调用工作正常，但由于重定向我有它干扰 AJAX 调用并从帖子重定向 getuser.php 调用，这只会导致 index.php 文件再次显示在顶部我的当前页面。有没有办法让重定向不与 AJAX 调用相互恐惧，这样它就可以在我的页面上简单地显示我的结果，而不会影响当前的重定向。

我尝试添加以下内容，这只会导致 AJAX 中断并且无法工作，因为它不允许对 getuser.php 文件进行调用。请提供任何帮助。

```
RewriteCond %{REQUEST_URI} !/getuser\.php 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:17:56.563

试试这个，L 标志应该告诉 apache 这是最后一条规则，只去请求的 url。

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^/getuser\.php$ $0 [L]
RewriteRule ^([^/]+)/(.*)$ /us/index.php?state=$1&city=$2 [R=301,L] 
```

# asp.net-mvc-3 - 如何使用用户名或 customerId 检索密码

> ID：13962104
> 
> 赞同：0
> 
> 时间：2012-12-19T22:09:10.347
> 
> 标签：asp.net-mvc-3, validation, model-view-controller, fluentvalidation

全部，

我正在开发一个 MVC3 c# 站点。我需要用户请求新密码的能力。要求是他们输入：

*   如果他们知道，他们的 customerId

*或者*

*   他们在一个文本框中选择的用户名

两者在数据库中都是唯一的。

一旦他们输入其中任何一个，“更改密码”链接就会通过电子邮件发送给他们。

我的问题是，我正在使用一个文本框让他们输入其中任何一个。

我怎么知道他们输入了什么？

我是否验证用户名，如果失败则验证 customerId。如果这两个都没有通过验证，那么我会向他们显示一条消息。

如果其中一项验证通过，我会向他们发送密码链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T05:10:35.490

您说您对用户名和customerId 都使用一个文本框。

这是设计错误的！

如果说客户 A 的用户名恰好是客户 B 的 customerId，你会怎么做？

我建议你有两个文本框，每个都正确标记为一个用于 customerId，另一个用于用户名，用户需要填写两者中的任何一个。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T09:25:07.180

如果 ID 是数值或遵循特定格式，那么您可以使用正则表达式来检查匹配项，然后将其视为 ID 或用户名。请注意，如果 ID 只是一个数字，那么调用 TryParse 来检查输入会更有效。

# command-line - 查找所有文件，然后对这些名称的所有文件进行 grep

> ID：13962105
> 
> 赞同：2
> 
> 时间：2012-12-19T22:09:12.590
> 
> 标签：command-line, grep, find

我想在目录上运行命令以打印出该目录中的所有文件，然后递归地打印所有文件以查找找到的文件名，基本上是检查并查看目录中的任何或文件中`grep`是否使用了 X 文件。如果发现 X 文件不在任何文件中，则打印它的名称。`PHP``HTML`

到目前为止，我有这个，我不知道如何传递给`grep`我所拥有的然后打印那些没有结果的东西。

```
find . -path ./images -prune -o -name '*' -type f -print | sed 's!.*/!!' 
```

我可以`exec`这样使用：

```
find . -path ./images -prune -o -name '*' -type f -exec grep -R '{}' ./* \; 
```

但是我无法`sed`摆脱`./dir/etc/`find 给我的文件名前面的 from 。

令我困惑的查询的另一部分是我无法弄清楚如何获取`grep`或查找打印那些没有结果的`grep`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:36:15.747

我认为这样的事情可能会有所帮助：

```
$ find . -type f -printf "%f\n" | grep --color -R -f - . 
```

在此示例中，`-printf "%f\n"`仅`find`返回文件名而不返回路径。结果是一个文件，用作 grep 的搜索模式，并作为输入传递给`stdin`using `-f -`。`-R`告诉 grep 递归搜索（你已经知道了）。使`--color`事情看起来不错。

要仅列出匹配的文件名，请使用`grep -l -R -f - .`. 然后要查找*没有*结果的文件，您必须找到不在该列表中的文件。

[这篇文章](https://stackoverflow.com/q/7306971/416627)可能会帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:05:30.190

用于`-exec`调用`basename`和管道到`grep`：

```
find ./images -maxdepth 1 -type f -exec basename {} \; | grep ... 
```

这将仅打印在`./images`.

# python - Python中的Prolog单例变量

> ID：13962107
> 
> 赞同：1
> 
> 时间：2012-12-19T22:09:19.843
> 
> 标签：python, unused-variables

我正在用python编写一组脚本，我来到了这个：

```
line = "a b c d e f g"
a, b, c, d, e, f, g = line.split() 
```

我很清楚这些是在实施过程中做出的决定，但python不应该（或确实）提供类似的东西：

```
_, _, var_needed, _, _, another_var_needed, _ = line.split() 
```

以及 Prolog 确实提供，以排除著名的`singleton variables`.

我不确定，但它不会避免不必要的分配吗？或者创建对`split`调用结果的引用不计入开销？

**编辑：**

抱歉，我的意思是：在 Prolog 中，就我而言，表达如下：

```
test(L, N) :-
    test(L, 0, N).
test([], N, N).
test([_|T], M, N) :-
    V is M + 1,
    test(T, V, N). 
```

表示的变量`_`是不可访问的，因为我认为对列表中确实存在的值的引用`[_|T]`甚至没有创建。

但是，在 Python 中，如果我使用`_`，我可以使用分配给 的最后一个值`_`，而且，我确实假设每个变量都发生了分配`_`——这可能被认为是一种开销。

我的问题是是否不应该（或是否有）一种语法来避免这种不必要的归属。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T22:11:26.677

`_`是一个完全有效的变量名，是的，您可以在解包操作中多次使用变量，因此您编写的内容将起作用。`_`将以该行中分配的最后一个值结束。一些 Python 程序员确实以这种方式使用它。

`_`被一些 Python 交互式 shell 用于特殊用途，这可能会使一些读者感到困惑，因此一些程序员*不会*出于这个原因使用它。

没有办法避免分配`str.split()`：它总是分割整行，并且总是分配结果字符串。只是，在这种情况下，他们中的一些人活得不长。但话又说回来，谁呢？

您可以避免*一些*分配，例如`re.finditer()`：

```
import re

fi = re.finditer(r"\S+", line)
next(fi)
next(fi)
var_needed = next(fi).group()
next(fi)
next(fi)
another_var_needed = next(fi).group()
# we don't care about the last match so we don't ask for it 
```

但是`next()`返回一个`Match`对象，因此它将被分配（并立即丢弃，因为我们没有将它保存在任何地方）。所以你真的只保存最后的分配。如果你的字符串很长，我猜你得到一个`Match`对象而不是字符串这一事实可以节省一些内存甚至时间；我*认为*匹配的字符串在您要求之前不会从源字符串中切出。你可以确定它。

您甚至可以将上述内容概括为一个仅从字符串返回所需标记的函数：

```
import re

def get_tokens(text, *toknums):
    toknums = set(toknums)
    maxtok = max(toknums)
    for i, m in enumerate(re.finditer(r"\S", text)):
        if i in toknums:
            yield m.group()
        elif i > maxtok:
            break

var1, var2 = get_tokens("a b c d e f g", 2, 5) 
```

但它仍然不是很漂亮。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T22:11:52.067

事实上，`_`在 Python 中是一个有效的标识符，人们经常用它来接受一个不再需要的值，所以你的代码已经是很棒的 Python。

`_`Python 中没有与Prolog 中的语法完全对应的语法。当你`_`在 Python 中使用时，它是一个真正持有对值的引用的真实变量。

也就是说，在运行 Python 程序时，有很多很多的对象被分配和释放。即使您可以控制一些地方，就像您展示的那样，这只是杯水车薪，并且不会影响程序的资源使用量。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T22:10:58.123

就语法而言

```
_, _, var_needed, _, _, another_var_needed, _ = line.split() 
```

是有效的蟒蛇。我会说它甚至是惯用的，虽然有点不寻常。

# php - 为什么 PHP_INT_MAX 这么小？

> ID：13962108
> 
> 赞同：3
> 
> 时间：2012-12-19T22:09:33.723
> 
> 标签：php, integer

转换为 GB，它就像 2 GB。

但是我现在在 32 位 Windows 上运行，我可以拥有比这更大的文件。

那么为什么 PHP 将这个数字限制为 2147483647 呢？如果 Windows 可以处理更大的数字，PHP 不应该也可以吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T22:17:04.543

2147483647 是您可以使用 32 位存储的最高有符号数。PHP 以这种方式存储它的数字，因为它们就是这样存储在您的计算机中的。再高一点，数学和一切都会变得复杂得多。Windows 也将使用 32 位数字。我不确定它如何处理大于 2 GB 的文件，但我猜在这些情况下它可以通过更复杂的代码以某种方式解决它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-19T22:24:15.067

2,147,483,647 是可以存储在 32 位中的最大数字。您的处理器只有 32 个插槽来填充位，比这更大的数字将更复杂，并且需要更多的开销来计算。相反，您可以拥有的最小数字是 -2,147,483,648，这也是因为没有更小的数字可以存储在 32 位中。

如果想在 32 位系统上计算更大的数字，则必须解决此限制。当然有解决方法，但在一般的 web 应用程序上不太可能需要。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-19T22:13:13.120

2,147,483,647 是有符号 4 字节值的最大值2 ^(31 -1。)您可能喜欢使用 long，即 2 ^(63) -1 = 9,223,372,036,854,775,807。

# ios - 尝试使用 RestKit 发出 POST 请求并将响应映射到 Core Data

> ID：13962109
> 
> 赞同：6
> 
> 时间：2012-12-19T22:09:37.400
> 
> 标签：ios, http, request, restkit, restkit-0.20

我正在使用 RestKit 框架，我想发出一个 POST HTTP 请求。响应是 JSON。我想将 JSON 响应自动放入 CoreData。

我不确切知道要调用什么方法来发出请求。我知道我应该使用`RKObjectManager`'s 方法，但我没有找到正确的方法。

我找到了这个方法`postObject:delegate:`，但我不知道要作为参数传递的对象。我也在文档中找到了这种方法：`loadObjectsAtResourcePath:usingBlock:`但我不能使用它，因为它告诉我：

```
No visible @interface for 'RKObjectManager' declares the selector 'loadObjectsAtResourcePath:usingBlock:' 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-12-20T05:08:05.957

弗拉德 - 首先，让我们回答你原来的问题：

我假设您正在使用 RestKit 0.20.0，但熟悉 RestKit 0.10.x API 并且正在咨询过时的信息。您应该转向的第一个地方是`RKObjectManager.h`- 标头始终是最新的，并且将包含有关可用方法的文档。接下来，您始终可以在[最新的 API 文档站点](http://restkit.org/api/latest/Classes/RKObjectManager.html)上查看由源代码构建的最新文档。

您在这里要做的是创建一个`RKObjectRequestOperation`：

```
NSDictionary *dictionary = @{ @"firstParam": @(12345), @"secondParam": @"whatever"};
NSMutableURLRequest *request = [objectManager requestWithObject:nil method:RKRequestMethodPOST path:@"/whatever" parameters:parameters];
RKObjectRequestOperation *operation = [objectManager objectRequestOperationWithRequest:request success:^(RKObjectRequestOperation *operation, RKMappingResult *result) {
    NSLog(@"Loading mapping result: %@", result);
} failure:nil]; 
```

如果您尝试以 Core Data 为目标，那么您将需要使用`RKManagedObjectRequestOperation`and `managedObjectRequestOperationWithRequest:success:failure:`. RestKit Github 站点上的 README.md 和标头文档中提供了其他示例，单元测试中还有大量代码供参考。

* * *

接下来，针对 JRG-Developer 的评论：

嗯，出于多种原因，这是一个非常糟糕的答案。（免责声明：我是 RestKit 的主要开发者）

首先，您使用的是什么版本的 RestKit？如果您使用的是最新版本（即在 0.20.x 预发布系列中），则加载对象集合的方法已被替换为更好的名称：`getObjectsAtPath:`. 这在 API 文档（[通过路径发出请求](http://restkit.org/api/latest/Classes/RKObjectManager.html#task_Making%20Object%20Requests%20by%20Path)）和[0.10 到 0.20 迁移指南](https://github.com/RestKit/RestKit/wiki/Upgrading-from-v0.10.x-to-v0.20.0)中都有完整的记录。

我怀疑这里的原始问题源于引用过时的文档以及最近的代码。

接下来，一旦你真正理解了这个库，你推荐的技术栈的设置和使用来完成与 RestKit 为你提供的相同的事情要复杂得多**。**

让我们逐点看一下：

1.  **AF网络**

    *   AFN 是一个出色的轻量级库，用于执行异步网络操作。如果您将 RestKit 视为一个包含许多用于实现客户端 API 的工具的工具箱，那么 AFN 就是锤子。
    *   我非常尊重 AFN，在 RestKit 0.20.x 中，我们抛弃了陈旧的自制网络库，转而使用 AFNetworking，因为它的设计优于自 iOS 3.0 以来一直存在的 RestKit 自定义网络堆栈。然而，单独的 AFN 并不能为您提供足够的火力来完全实现与 Core Data 集成的 API，而无需深入了解 Core Data 并自己实现大量同步代码。
    *   RestKit 的对象映射系统为您提供了一个高性能、一致的 API 来配置这些同步活动，而不是自己实现它们。这可以实现一些重要的性能优化，稍后我将返回。
2.  **JSONKit**

    *   JSONKit 是我高度重视的另一个库，但它可能不值得你花时间。与 相比`NSJSONSerialization`，JSONKit 的 JSON 解析速度更胜一筹——但只有几毫秒。
    *   作为为广泛部署的应用程序实现大型 API 客户端的人，我可以告诉您，您的时间不会花在 JSON 序列化/反序列化上，而是花在处理 JSON 反序列化后的代码上。
3.  **神奇唱片**

    *   MagicalRecord 是一个 Core Data 便利库，它为 Core Data 中的现有功能提供速记访问器。一旦你深入了解实现 HTTP 到 Core Data 同步方案的具体细节，它不会改善你的生活。您的问题与 Core Data 获取请求的语法过于冗长、维护对托管对象上下文的引用或获取 Core Data 堆栈设置无关**。**

因此，让我们暂时讨论一下实现将 API 建模为 Core Data 的 iOS / OS X 应用程序的**真正问题是什么：**

1.  **异步访问**
    *   您将遇到的第一个问题是您习惯于以同步的、面向主线程的方式进行编程，但是现在您需要触发一个加载 JSON 的 AFNetworking 请求，然后将其加载到您的对象模型中。没问题，只需等待`AFJSONRequestOperation`成功块中的回击并更新核心数据，对吗？错误的。现在您正在异步执行网络 I/O，然后在主线程上执行更新数据模型的**CPU 密集型**任务。现在您的应用程序性能很差，您不知道该怎么办。您如何将该同步移至后台？完成后如何通知 UI？
2.  **错误处理**
    *   当你遇到错误时会发生什么？遇到网络错误怎么办？网络操作完成，但访问 Core Data 时遇到错误怎么办？你打算怎么处理？你打算把这个错误处理代码放到你所有的控制器中吗？你将如何封装所有这些逻辑？
    *   您将如何处理服务器返回的错误？
3.  **唯一对象标识**
    *   好的，现在您已经加载了 JSON，并且想要将其放入 Core Data 中。伟大的。您将如何区分商店中的现有对象与需要创建的新对象？
    *   如果你弄错了，你现在有重复的对象。
    *   如果你做对了，但是从主线程上下文中做，你的 UI 被阻塞并且你的性能很糟糕。
    *   如果你做对了，但在后台线程上做，你可能会遇到并发问题。
    *   如果你做对了，但使用 fetch 请求访问持久存储以识别你的唯一对象，那么你现在遇到了性能问题。
4.  **删除孤立对象**
    *   将数据集与服务器同步后，您将如何处理从本地存储中删除服务器上不再存在的死对象？
5.  **表现**
    *   正如我在这篇咆哮的前几部分中提到的那样，所有道路最终都会导致性能。如果您实际上是在尝试构建可以大规模使用并取悦用户的东西，那么您将不得不应对严重的性能问题。晕头转向。

一旦您的应用程序成功，您将不得不应对许多额外的问题，包括可测试性、可维护性等。您对这些事情的考虑程度如何？

我想我的主要观点是（从我的角度来看）太常见了，以至于无法听到来自花生画廊的疯狂欢呼或嘲笑如何解决基本工程问题。现实情况是，具有**基本复杂性**的问题的解决方案将具有与正在解决的问题相关的学习曲线。

与尝试解决更大但更有趣的问题相比，获取离散的功能部分并确定令人满意的解决方案要容易得多。

但这并不意味着您将通过将一堆库捆绑在一起来产生更强大的解决方案，您听说这些库提供了问题子集的良好实现，而不是解决聚合问题的更大方法。

为什么没有人开源他们自己的 AFN/JSONKit/Core Data/MagicalRecord mashup 并在 RestKit 比 RestKit 好得多的情况下将它们从水中淘汰？

恐怕清醒的事实是：这并不容易。

干杯!

# php - 使用 PHPmyAdmin 在计时器上设置 SQL 查询

> ID：13962115
> 
> 赞同：3
> 
> 时间：2012-12-19T22:09:54.087
> 
> 标签：php, sql, phpmyadmin

我正在尝试在计时器上执行查询（每天一次）。

每次查询都是一样的。我从 excel 中获取数据并将其保存到我的计算机桌面。然后从`file.csv`PHPmyAdmin 更新。

在 phpmyadmin 中，我看不到任何从界面自动化的选项。有人可以免费帮我完成这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T23:31:49.227

-------------------- 更新（更好的答案 - 2014 年 1 月）--------------------

您可以使用 MySQL 偶数调度程序 ( [http://dev.mysql.com/doc/refman/5.1/en/events.html](http://dev.mysql.com/doc/refman/5.1/en/events.html) )。允许您在 MySQL 中设置在指定时间运行查询的事件。

手册中的样本

```
CREATE EVENT myevent
    ON SCHEDULE AT CURRENT_TIMESTAMP + INTERVAL 1 HOUR
  DO
    UPDATE myschema.mytable SET mycol = mycol + 1; 
```

------------------ 原始答案（2012 年 12 月） ------------------

最简单的方法是使用 CRON 作业或 Windows 任务计划程序作业来运行 mysql 命令：

```
mysql -u [username] -p[password] -e "UPDATE from 'filecsv'" 
```

笔记：

1.  这将在调度程序中显示您的密码。
2.  如果 mysql 不在您的路径中（调度程序将作为该路径运行），请在该行中指定路径。如果有疑问，请将“c:\progam files(x86)\mysql\bin\mysql”或 mysql.exe 所在的任何位置
3.  虽然 -u 和用户名之间以及 -e 和评论之间有一个空格，但 -p 和密码之间没有空格。

更多阅读： - Google for tech scheduler（添加您的 Windows 风格）[https://www.google.com.au/search?q=using+windows+task+scheduler](https://www.google.com.au/search?q=using+windows+task+scheduler) - MySQL 命令行“执行”（和其他选项）[http://dev.mysql.com/doc/refman/5.5/en/mysql-command-options.html#option_mysql_execute](http://dev.mysql.com/doc/refman/5.5/en/mysql-command-options.html#option_mysql_execute)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T22:33:56.117

据我所知，phpmyadmin 没有办法做到这一点，但是你可以从脚本中做到这一点，这将允许你在 linux 中创建一个 cronjob 或在 Windows 中创建一个计划任务，以将 CSV 导入你的数据库。phpMyAdmin 无论如何都会运行这样的命令。

您正在寻找的 SQL 命令是

```
load data ' . LOCAL_DATA . ' 
infile "/path_on_disk/file.csv" 
into table `table_name` ' . $details['import_options'] . ' 
(brand, sku, name, retail_price, url, image, short_category, stock_availability, freight_cost, retail_price, currency);'); 
```

LOCAL_DATA - 可以为空或字符串“LOCAL”。测试看看它是如何为你运行的，对于我的计算机我需要 LOCAL，对于我不需要的服务器。

$details['import_options'] - 可以是很多东西，最好的方法是测试它是如何为你的文件运行的。我过去用过

```
fields terminated by "," lines terminated by "\n" IGNORE 1 LINES 
```

或者

```
fields terminated by "\t" enclosed by "\"" lines terminated by "\n" IGNORE 1 LINES 
```

或者

```
fields terminated by "," optionally enclosed by "\"" lines terminated by "\n" IGNORE 1 LINES 
```

您可以在 php 中运行它以在您想要的表中获取您想要的文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T22:21:22.277

您最好安排一个 Cronjob 运行脚本来执行此操作。您可以创建一个 PHP 脚本来检查 Excel 文件，然后将其输入 MySQL。

[http://www.cyberciti.biz/faq/how-do-i-add-jobs-to-cron-under-linux-or-unix-oses/](http://www.cyberciti.biz/faq/how-do-i-add-jobs-to-cron-under-linux-or-unix-oses/) http://code.google.com/p/php-优秀/

或者，您可以使用 MySQL 中的事件调度程序来安排特定操作。但是，对于您的应用程序，PHP 或其他脚本语言可能更适合处理从 Excel 电子表格读取。

例子：

```
CREATE EVENT import_data
    ON SCHEDULE AT '2006-02-10 23:59:00'
    DO LOAD DATA LOCAL INFILE '/importfile.csv' INTO TABLE test_table
    FIELDS TERMINATED BY ','
    LINES TERMINATED BY '\n'
    (field1, filed2, field3); 
```

[http://dev.mysql.com/doc/refman/5.1/en/events.html](http://dev.mysql.com/doc/refman/5.1/en/events.html)

# html - 隔离富文本以保护页面上的其余 HTML？

> ID：13962120
> 
> 赞同：1
> 
> 时间：2012-12-19T22:10:20.743
> 
> 标签：html, xhtml, tinymce, rtf, rich-text-editor

我在评论表单上有一个 TinyMCE 富文本编辑器（工作工具）。我一直遇到问题，富文本中的编码和字符破坏了显示这些评论的页面上的其余 HTML。

有没有办法将一些富文本 HTML 代码隔离或限制在某种类型的容器中，以保护页面上的其余 HTML？

我一直在尝试搜索，但我想不出不会使谷歌结果超载的独特关键字 - 找不到任何东西。我还没有尝试过 iframe，但这似乎不是一个好主意。我有一个显示评论列表的模态窗口（通常可以有超过 50 条评论），并且在该窗口中有 50 个 iframe（如果它确实有效）对我来说听起来不对？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:36:44.863

唯一 100% 确定隔离 CSS 的方法：使用`Iframe`.

您只需要一个用于编辑器本身。将其交换到实时退出的位置。一次只有一个活跃的编辑器。

# php - php表单值未显示

> ID：13962121
> 
> 赞同：4
> 
> 时间：2012-12-19T22:10:29.577
> 
> 标签：php, forms

我的表单不会显示这些值，除非我将它们添加到所需的 = 数组中，并且并非所有内容都是必需的。因此，公司名、姓氏和电子邮件将显示在发送的电子邮件中，但不会显示电话和消息（我还有其他字段要添加）。

这是我的代码：

```
<?php

if(!$_POST) exit;

$email = $_POST['email'];

//$error[] = preg_match('/\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/i', $_POST['email']) ? '' : 'INVALID EMAIL ADDRESS';
if(!eregi("^[a-z0-9]+([_\\.-][a-z0-9]+)*" ."@"."([a-z0-9]+([\.-][a-z0-9]+)*)+"."\\.[a-z]{2,}"."$",$email )){
    $error.="Invalid email address entered";
    $errors=1;
}

if($errors==1) echo $error;
else{
    $values = array('firname','lasname','email','phone','message');
    $required = array('firname','lasname','email',);

    $your_email = "aasdasd@email.com";
    $email_subject = "Reservations Form: ".$_POST['subject'];
    $email_content = "new reservation:\n";

    foreach($values as $key => $value){
        if(in_array($value,$required)){
            if ($key != 'subject' && $key != '') {
                if( empty($_POST[$value]) ) { echo 'PLEASE FILL IN REQUIRED FIELDS'; exit; }
            }
            $email_content .= $value.': '.$_POST[$value]."\n";
        }
    }

    if(@mail($your_email,$email_subject,$email_content)) {
        header('Location: http://www.example.com/test/reservation-submission.html');
    } else {
        echo 'ERROR!';
    }
}
?>`

<form action="reservations.php" method="post" id="contactform">
      <ol>
        <li><label>First Name *</label>
          <input id="firname" name="firname" class="text" value="" />
        </li>
         <li><label>Last Name *</label>
          <input id="lasname" name="lasname" class="text" value="" />
        </li>
        <li><label>Email *</label>
          <input id="email" name="email" class="text" type="email" value="" />
        </li>
        <li><label>Phone Number *</label>
          <input id="phone" name="phone" class="text" value="" />
        </li>
        <li><label>Best Time To Call</label>
          <select name="best time to call" id="call" class="drop">
        <option selected="selected" value="Morning">Morning</option>
        <option value="Afternoon">Afternoon</option>
        <option value="Evening">Evening</option>
                </select>
        </li>
        <br />
        <li><label>Age</label>
          <select name="age" id="age" class="drop">
        <option selected="selected" value="25+">25+</option>
        <option value="21-24">21-24</option>
                </select>
        </li>
        <br />
        <li> <label> Rental *</label>
        <select name="rental" id="rental" class="drop">
        <option selected="selected" value="12 Passenger Van">12 Passenger Van</option>
        <option value="15 Passenger Van">15 Passenger Van</option>
        <option value="Cargo Van">Cargo Van</option>
                </select> </li>
                <br />
                <li> <label> Pick up Location *</label>
        <select name="location" id="location" class="drop">
        <option selected="selected" value="Select Location">Select Location</option>
        <option value="U-Save JFK">U-Save JFK</option>
        <option value="U-Save LGA">U-Save LGA</option>
                </select> </li>
                <br />
        <li><label>Estimated Mileage</label>
        <select name="mileage" id="mileage" class="drop">
        <option selected="selected" value="Under 100">Under 100</option>
        <option value="100-500">100-500</option>
        <option value="500+">500+</option>
                </select>
        </li>
        <br />
        <li><label>Pick Up Date *</label>
          <input id="pick-up-date" name="pick-up-date" class="date" value="MM/DD/YY" /> <a href="javascript:showCal('Calendar1')"><img class="cal" align="absmiddle" src="cal/cal.gif" border="0" alt="Calendar"></a> 
        </li>
        <br />
        <li><label>Pick Up Time *</label>
          <select class="drop" name="pick up time" id="Pick Up Time">
    <option value="12:00 am">12:00 am</option> <option value="12:30 am">12:30 am</option>
    <option value="01:00 am">01:00 am</option> <option value="01:30 am">01:30 am</option>
    <option value="02:00 am">02:00 am</option> <option value="02:30 am">02:30 am</option>
    <option value="03:00 am">03:00 am</option> <option value="03:30 am">03:30 am</option>
    <option value="04:00 am">04:00 am</option> <option value="04:30 am">04:30 am</option>
    <option value="05:00 am">05:00 am</option> <option value="05:30 am">05:30 am</option>
    <option value="06:00 am">06:00 am</option> <option value="06:30 am">06:30 am</option>
    <option value="07:00 am">07:00 am</option> <option value="07:30 am">07:30 am</option>
    <option value="08:00 am">08:00 am</option> <option value="08:30 am">08:30 am</option>
    <option value="09:00 am">09:00 am</option> <option value="09:30 am">09:30 am</option>
    <option value="10:00 am">10:00 am</option> <option value="10:30 am">10:30 am</option>
    <option value="11:00 am">11:00 am</option> <option value="11:30 am">11:30 am</option>
    <option value="12:00 pm">12:00 pm</option> <option value="12:30 pm">12:30 pm</option>
    <option value="01:00 pm">01:00 pm</option> <option value="01:30 pm">01:30 pm</option>
    <option value="02:00 pm">02:00 pm</option> <option value="02:30 pm">02:30 pm</option>
    <option value="03:00 pm">03:00 pm</option> <option value="03:30 pm">03:30 pm</option>
    <option value="04:00 pm">04:00 pm</option> <option value="04:30 pm">04:30 pm</option>
    <option value="05:00 pm">05:00 pm</option> <option value="05:30 pm">05:30 pm</option>
    <option value="06:00 pm">06:00 pm</option> <option value="06:30 pm">06:30 pm</option>
    <option value="07:00 pm">07:00 pm</option> <option value="07:30 pm">07:30 pm</option>
    <option value="08:00 pm">08:00 pm</option> <option value="08:30 pm">08:30 pm</option>
    <option value="09:00 pm">09:00 pm</option> <option value="09:30 pm">09:30 pm</option>
    <option value="10:00 pm">10:00 pm</option> <option value="10:30 pm">10:30 pm</option>
    <option value="11:00 pm">11:00 pm</option> <option value="11:30 pm">11:30 pm</option>
        </select>
        </li>
        <br />
        <li><label>Drop Off Date *</label>
          <input id="drop-off-date" name="Drop Off Date" class="date" value="MM/DD/YY" /> <a href="javascript:showCal('Calendar2')"><img class="cal" align="absmiddle" src="cal/cal.gif" border="0" alt="Calendar" /></a> 
        </li>
        <br />
        <li><label>Drop Off Time *</label>
          <select class="drop" name="Drop Off Time" id="Drop Off Time">
    <option value="12:00 am">12:00 am</option> <option value="12:30 am">12:30 am</option>
    <option value="01:00 am">01:00 am</option> <option value="01:30 am">01:30 am</option>
    <option value="02:00 am">02:00 am</option> <option value="02:30 am">02:30 am</option>
    <option value="03:00 am">03:00 am</option> <option value="03:30 am">03:30 am</option>
    <option value="04:00 am">04:00 am</option> <option value="04:30 am">04:30 am</option>
    <option value="05:00 am">05:00 am</option> <option value="05:30 am">05:30 am</option>
    <option value="06:00 am">06:00 am</option> <option value="06:30 am">06:30 am</option>
    <option value="07:00 am">07:00 am</option> <option value="07:30 am">07:30 am</option>
    <option value="08:00 am">08:00 am</option> <option value="08:30 am">08:30 am</option>
    <option value="09:00 am">09:00 am</option> <option value="09:30 am">09:30 am</option>
    <option value="10:00 am">10:00 am</option> <option value="10:30 am">10:30 am</option>
    <option value="11:00 am">11:00 am</option> <option value="11:30 am">11:30 am</option>
    <option value="12:00 pm">12:00 pm</option> <option value="12:30 pm">12:30 pm</option>
    <option value="01:00 pm">01:00 pm</option> <option value="01:30 pm">01:30 pm</option>
    <option value="02:00 pm">02:00 pm</option> <option value="02:30 pm">02:30 pm</option>
    <option value="03:00 pm">03:00 pm</option> <option value="03:30 pm">03:30 pm</option>
    <option value="04:00 pm">04:00 pm</option> <option value="04:30 pm">04:30 pm</option>
    <option value="05:00 pm">05:00 pm</option> <option value="05:30 pm">05:30 pm</option>
    <option value="06:00 pm">06:00 pm</option> <option value="06:30 pm">06:30 pm</option>
    <option value="07:00 pm">07:00 pm</option> <option value="07:30 pm">07:30 pm</option>
    <option value="08:00 pm">08:00 pm</option> <option value="08:30 pm">08:30 pm</option>
    <option value="09:00 pm">09:00 pm</option> <option value="09:30 pm">09:30 pm</option>
    <option value="10:00 pm">10:00 pm</option> <option value="10:30 pm">10:30 pm</option>
    <option value="11:00 pm">11:00 pm</option> <option value="11:30 pm">11:30 pm</option>
        </select>
        </li>
        <br />

        <li><label>Additional Infomation</label>
          <textarea id="message" name="message" rows="6" cols="50"></textarea>
        </li>
        <li class="button1">
          <input type="image" name="imageField" id="imageField" src="images/reserve-now-btn.png" class="send" />
          <div class="clr"></div>
        </li>
      </ol>
    </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:18:26.860

更改此部分：

```
foreach($values as $key => $value){
  if(in_array($value,$required)){
    if ($key != 'subject' && $key != '') {
      if( empty($_POST[$value]) ) { echo 'PLEASE FILL IN REQUIRED FIELDS'; exit; }
    }
    $email_content .= $value.': '.$_POST[$value]."\n";
  }
} 
```

至...

```
foreach($values as $key => $value){
  if(in_array($value,$required)){
    if ($key != 'subject' && $key != '') {
      if( empty($_POST[$value]) ) { echo 'PLEASE FILL IN REQUIRED FIELDS'; exit; }
    }
  }
  $email_content .= $value) .': '.$_POST[$value])."\n";
} 
```

为了简化，您将获取`$values`数组中的每个项目并在表单中搜索它。如果它在`$required`列表中，则检查它是否为空白。如果为空白，则显示错误消息。否则，您希望将其添加到将通过邮件 ( `$email_content`) 发送的消息中。

以前，“将其添加到电子邮件内容”部分仅在“如果需要”循环中执行。我将它向下移动，使其成为“for each`value`循环”的一部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:18:06.193

您应该从子句中移出该`$email_content`部分。`if(in_array($value,$required)){`上一级：

```
foreach($values as $key => $value){
   if(in_array($value,$required)){
     if ($key != 'subject' && $key != '') {
       if( empty($_POST[$value]) ) { echo 'PLEASE FILL IN REQUIRED FIELDS'; exit; }
     }
     // from here
   }
   $email_content .= $value.': '.$_POST[$value]."\n";  // to here
} 
```

因为您不仅希望将必填字段添加到内容中

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:19:47.363

您将 a 放置`{`在错误的位置，导致非必填字段被一起忽略。

```
foreach($values as $key => $value){
  if(in_array($value,$required)){
    if ($key != 'subject' && $key != '') {
      if( empty($_POST[$value]) ) { echo 'PLEASE FILL IN REQUIRED FIELDS'; exit; }
    }
  } // <- Good
  $email_content .= $value.': '.$_POST[$value]."\n";
//  } <- Wrong
} 
```

# cuda - 为什么多个 GPU CUDA 代码会失败？

> ID：13962122
> 
> 赞同：0
> 
> 时间：2012-12-19T22:10:37.127
> 
> 标签：cuda, gpu

我第一次拥有以下多 GPU CUDA 代码：

```
int main( void ) { 
    int count;
    cudaGetDeviceCount( &count );
    float** gtt = new float*[count];
    for (int i=0; i< count; i++) {
        cudaSetDevice(i);
        int j;
        cudaGetDevice(&j);
        printf("get device %d\n",j);
        cudaMalloc((void**)&gtt[i], 2*sizeof(float));
        cudaFree(gtt[i]);
    }   
} 
```

我在同一个节点上发现了 3 台设备，但在运行的第二个 GPU 上出现了段故障。我的 CUDA 版本为 4010，计算能力为 2.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T19:55:59.273

最终我发现了问题所在。我通过以下方式设置了 cuda 分析环境：

```
export COMPUTE_PROFILE=1
export COMPUTE_PROFILE_LOG=cuda_profile.log 
```

第二行导致问题。当不同的 gpus 写入同一个分析日志文件时，可能会发生一些冲突。将第二行更改为：

```
export COMPUTE_PROFILE_LOG=cuda_profile_%p_%d.log 
```

解决问题。

# c# - LINQ 如何得到它的结果

> ID：13962123
> 
> 赞同：1
> 
> 时间：2012-12-19T22:10:37.363
> 
> 标签：c#, linq, orm, coolstorage

我正在使用 CoolStorage 作为 ORM，并且对查询数据库的频率有疑问。

我正在返回一个团队列表，并且还想显示每个团队中包含的用户数量。我正在通过调用返回团队，`Team.List()`并且有 2 个选项我可以考虑如何返回用户数量。一种是向 Team 类添加一个属性，该属性返回其 [OneToMany] SysUsers 的计数，另一种是对`Team.List()`. 下面的代码演示了这两种方法，它们都返回相同的结果。

我试图了解这如何影响数据库交互，例如它会首先返回一个团队列表，然后对每个团队运行一个单独的查询以获取用户数量吗？如果我想再添加 2 个或 3 个字段，它会为每个附加字段运行另一个单独的查询吗？这两种方法有什么区别吗？

我担心的是，如果连接不好，即使是简单的查询也可能没有响应。

CoolStorage 中存在运行即席 SQL 查询的选项，对于更复杂的查询，我是否最好这样做？还是我什么都不担心？

```
CSList<Team> teams = Team.List();

// Counting number of objects
var d = from t in teams
        select new
        {
            TeamID = t.TeamID,
            TeamName = t.TeamName,
            NoUsers = t.SysuserTeams.Count
        };

// Using property added to Team class
var e = from t in teams
        select new
        {
            TeamID = t.TeamID,
            TeamName = t.TeamName,
            NoUsers = t.NumberOfUsers
        };

DataGridView dgv = this.dgvTeams;
dgv.DataSource = d.ToList();
// Same result as 
dgv.DataSource = e.ToList(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T11:22:03.933

从生成的 SQL 日志中看到它正在为 Teams 结果中的每一行运行一个新查询，我联系了 CoolStorage 开发人员，他们友好地回应了一个简洁的解决方案。

有两个选项，`OneToMany`属性 for`Sysusers`可以标记为，`[Prefetch]`或者可以为每个查询明确指定，例如`Team.List().WithPrefecth("Users")`. 无论哪种方式，它现在只对用户记录运行一个附加查询，而不是每行一个查询

# c# - 绑定 LinearAxis 间隔 WPF 工具包图表

> ID：13962124
> 
> 赞同：1
> 
> 时间：2012-12-19T22:10:43.320
> 
> 标签：c#, wpf

我的文件中有一个，我想`chartingToolKit`在我的文件中设置动态而不是静态的间隔。这就是我现在的做法：`XAML``LinearAxis``XAML`

```
<chartingToolkit:ColumnSeries.DependentRangeAxis>
    <chartingToolkit:LinearAxis FontSize="15" Foreground="Black" Interval="1"  Minimum="0" Orientation="Y" ShowGridLines="False" />
</chartingToolkit:ColumnSeries.DependentRangeAxis> 
```

我试图通过绑定来做到这一点：

```
<chartingToolkit:ColumnSeries.DependentRangeAxis>
    <chartingToolkit:LinearAxis FontSize="15" Foreground="Black" Interval="{Binding ChartingInterval}"  Minimum="0" Orientation="Y" ShowGridLines="False" />
</chartingToolkit:ColumnSeries.DependentRangeAxis> 
```

我的 .cs 文件中对 ChartingInterval 属性的绑定引用，如下所示：

```
public int ChartingInterval
{
    get
    {
        //Should contain more logic, obvious.
        return 1;    
    } 
} 
```

但这似乎不能正常工作。我怎样才能做到这一点？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:28:22.270

我认为这仅仅是因为您的数据上下文未设置在您拥有属性“ChartingInterval”的对象上。

你应该简单地设置它如下：

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:chartingToolkit="..."
        Title="MainWindow" Height="350" Width="525"
        DataContext="{Binding RelativeSource={RelativeSource Mode=Self}}">
    ...
    <chartingToolkit:ColumnSeries.DependentRangeAxis>
        <chartingToolkit:LinearAxis FontSize="15" Foreground="Black" Interval="{Binding ChartingInterval}"  Minimum="0" Orientation="Y" ShowGridLines="False" />
    </chartingToolkit:ColumnSeries.DependentRangeAxis>
    ...
</Window> 
```

您应该实现 INotifyPropertyChanged 以允许属性通知绑定其值已更改，因此绑定将更新目标值。

对不起我的英语不好

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-23T14:39:30.483

这是我在 C# 中为线条动态重置图表的代码。只需替换并消除不需要的行`LineSeries`。`ColumnSeries`也将`DataContext`名称替换为您的名称，样式是我在 XAML windows.resource 中的，因此您可以将其删除，依此类推。也许这将帮助您启动 C# 代码。

```
//dynamically recreate the chart series1
private void AddSeries()
{
    var series1 = new LineSeries();
    series1.SetBinding(LineSeries.ItemsSourceProperty, new Binding());
    series1.DataContext = Power;
    series1.DependentValueBinding = new Binding("Value");
    series1.IndependentValueBinding = new Binding("Key");
    series1.Style = (Style)this.Resources["LineSeriesStyle1"];

    //set initial values:
    LinearAxis independentaxis = new LinearAxis();
    independentaxis.Orientation = AxisOrientation.X;
    independentaxis.ShowGridLines = true;
    independentaxis.Maximum = 60;
    independentaxis.Minimum = 0;
    independentaxis.Title = "Time";
    independentaxis.ShowGridLines = true;
    series1.IndependentAxis = independentaxis;

    //set initial values:
    LinearAxis dependentaxis = new LinearAxis();
    dependentaxis.Orientation = AxisOrientation.Y;
    dependentaxis.ShowGridLines = true;
    dependentaxis.Maximum = 600;
    dependentaxis.Minimum = 0;
    dependentaxis.Title = "Force(n)";
    dependentaxis.ShowGridLines = true;
    series1.DependentRangeAxis = dependentaxis;
    chart1.Series.Add(series1);
} 
```

# c# - 在插入项目时设置 Radcombobox 值

> ID：13962128
> 
> 赞同：-1
> 
> 时间：2012-12-19T22:11:03.953
> 
> 标签：c#, telerik

我有一个 RadComboBox，我想将 Combobox 的值设置为刚刚创建的项目。如何获取创建的最后一项的索引以及如何设置控件？我试图像这样硬连线控件。谢谢。

```
 if (cmb_Contacts.SelectedIndex != 1 && cmb_Contacts.SelectedIndex != 0)
        {
            cmb_Contacts.DataValueField = mMgt.ContactID.ToString();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:20:15.127

这是一个简单的解决方案，您可以尝试声明一个变量来保存最后一个项目，然后获取当前 cmb_Contacts 中的项目数

```
int lastitem = 0;
lastitem = cmb_Contacts.Items.Count;
this.cmb_Contacts.SelectedIndex = lastitem - 1; 
```

# actionscript-3 - 防止从 RAM 中卸载位图

> ID：13962129
> 
> 赞同：0
> 
> 时间：2012-12-19T22:11:04.080
> 
> 标签：actionscript-3, actionscript, air

我在 AIR 项目中有 2 个大位图，想快速将它们的可见性切换给用户（同时只显示一个位图）。

我试图在应用程序启动时加载两个位图并将它们保存在内存中，这样我就可以立即显示第一个并隐藏第二个（反之亦然）。

但默认情况下，平台会在 30 秒后卸载隐藏位图：http: [//help.adobe.com/en_US/as3/mobile/WS4bebcd66a74275c3-576ba64d124318d7189-7ff8.html](http://help.adobe.com/en_US/as3/mobile/WS4bebcd66a74275c3-576ba64d124318d7189-7ff8.html)

此行为会导致将先前卸载的位图再次加载到 RAM 中的延迟。大约需要 10 秒，这太长了。

我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T00:30:07.637

首先，你很幸运`Bitmap`会加载。根据[LiveDocs](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html)：

> 在 AIR 1.5 和 Flash Player 10 中，BitmapData 对象的最大宽度或高度为 8,191 像素，像素总数不能超过 16,777,215 像素。（因此，如果 BitmapData 对象的宽度为 8,191 像素，则其高度只能为 2,048 像素。）在 Flash Player 9 及更早版本和 AIR 1.1 及更早版本中，限制为高度 2,880 像素和宽度 2,880 像素。

无论如何，与其保存`Bitmap`自身，不如保存`BitmapData`? 然后，每次要使图像可见时，您只需使用 BitmapData 创建一个新的位图。

如果它也有一个截止点（不明白为什么会这样），你可以尝试使用`BitmapData.getPixels()`which outputs a `ByteArray`. 每次您需要加载 Bitmap 时，您执行 a`BitmapData.setPixels( ByteArray )`然后将 BitmapData 添加到新的 Bitmap 对象。

请注意：最后一种方法会很慢，非常慢。

无论如何，您可能应该考虑减小图像的大小或查看平铺系统。请参阅[这篇](http://msdn.microsoft.com/en-us/library/bb259689.aspx)关于 Bing 地图磁贴系统的文章，了解在那里做什么（这是一篇很棒的、很好的文章，无论应用程序如何）。这显然比您需要的要复杂得多，但 256x256（必应和 Google 都使用）是平铺大图像的好尺寸。它足够小，可以快速按需加载，这样您就可以让它们在视口之外消失（`DisplayObject`舞台上的 s 越多，运行速度越慢）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-21T15:02:20.463

我们的项目中也遇到过类似的问题。我们发现，如果位图在最后 10 秒内未在屏幕上呈现，AIR 将删除已加载位图的未压缩图像数据。运行时会保留压缩的 PNG 或 JPG 数据，因此可以在下次需要渲染时按需重新解压缩图像。但是，当它必须解压缩大图像时，这会导致我们的应用程序出现相当大的延迟。

我们的修复包括从不从舞台上移除任何图像（需要稍后快速显示）：当应该移除图像时，将其设置为舞台顶部的 alpha 0.001。它不会在屏幕上显示，但 Flash 仍然必须渲染它。这个修复听起来对渲染性能来说很糟糕，但我们实际上并没有注意到舞台上悬挂的“几乎透明”位图有任何区别。

尽管进行了此修复，但您可能会遇到一些问题：如果屏幕上没有任何变化，则运行时甚至不会费心进行渲染传递。如果长时间（大约 10 秒）没有渲染，Flash 将再次开始丢弃不需要的位图，即使它们在舞台上可见。我们使用了另一种技术来强制 Flash 继续渲染：

1.  创建一个小矩形，alpha 设置为 0.001。将其添加到舞台的顶层。
2.  创建一个有 1 秒延迟的计时器，永远重复。
3.  每次触发定时器时，将矩形移动到舞台上的随机位置。

这将强制 Flash 至少每秒执行一次渲染过程。

注意：位图大小的限制在 AIR 3（和 Flash Player 11）中被完全删除。所以今天，如果您的图像可以放入 RAM，您就可以加载它！

# c# - 如何使用 SendMessage 将 BYTE* 发送到 c# 互操作？

> ID：13962130
> 
> 赞同：1
> 
> 时间：2012-12-19T22:11:05.427
> 
> 标签：c#, c++, sendmessage

如何发送数据*，然后像`byte[]`sendmessage 一样从 c# 中读取它？

```
SendMessage((HWND)fatwindow, OnRecvMessage, ??, ??); 
```

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:13:22.963

这是可能的，但通常这是通过 WM_COPYDATA 窗口消息完成的。

应该有很多例子，例如这里：[http ://boycook.wordpress.com/2008/07/29/c-win32-messaging-with-sendmessage-and-wm_copydata/](http://boycook.wordpress.com/2008/07/29/c-win32-messaging-with-sendmessage-and-wm_copydata/)

# security - 从移动设备安全地发送字符串到 C# 服务器

> ID：13962132
> 
> 赞同：0
> 
> 时间：2012-12-19T22:11:17.550
> 
> 标签：security, encryption, sniffer

我的应用程序发送到我的服务器用户的 Facebook 访问令牌/密码。

```
$.ajax { url:'http://www.mysite.com?accesstoken=**** / pass=**** .... 
```

我知道嗅探器威胁会使它变得危险。那是发送数据加密（没有https）的任何代码\工具吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T08:29:56.690

不，因为没有其他方法可以建立对从服务器发送的 JavaScript 代码的信任。您可以发送经过身份验证的 JavaScript，但您需要客户端上的某些东西来验证代码。

# python - Pandas 插值在 0.10 版中发生了变化？

> ID：13962133
> 
> 赞同：2
> 
> 时间：2012-12-19T22:11:18.357
> 
> 标签：python, pandas, interpolation

刚刚安装了 pandas 0.10.0，以下行创建现有列的插值版本失败：

```
prep_bcgps['lati'] = prep_bcgps['lat'].apply(pds.Series.interpolate)

TypeError: unbound method interpolate() must be called with Series instance as first argument (got float64 instance instead) 
```

有人可以指导我使用新语法吗？

谢谢，

卢克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:19:10.387

尝试：

```
prep_bcgps['lati'] = prep_bcgps['lat'].interpolate() 
```

例如：

```
df = pd.DataFrame({'X' : [1, None, 3, None, 5]})
print(df)
#     X
# 0   1
# 1 NaN
# 2   3
# 3 NaN
# 4   5

df['X'] = df['X'].interpolate()
print(df)
#    X
# 0  1
# 1  2
# 2  3
# 3  4
# 4  5 
```

# c++ - getcwd 有 wchar_t 版本吗？

> ID：13962140
> 
> 赞同：3
> 
> 时间：2012-12-19T22:12:10.247
> 
> 标签：c++, gcc, wchar-t, getcwd

我正在尝试这样做：

```
wchar_t buff[PATH_MAX];
wgetcwd( buff, PATH_MAX); 
```

我也试过_wgetcwd。Google 建议 _wgetcwd 在 dir.h 中，但我从未听说过这样的头文件。

我正在使用 GCC 4.3。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T22:15:12.880

如果这是一个 Unix/Linux 系统，那么寻找 wchar_t 版本的 getcwd 是没有意义的。这是因为所有文件名和目录名都只是字节，除了“/”和“\0”字符。您可以对它们使用 UTF-8 编码，但文件系统本身并不关心。

# ruby - 为什么不能在 Symbols 或 Fixnums 上定义单例方法？

> ID：13962147
> 
> 赞同：27
> 
> 时间：2012-12-19T22:12:37.753
> 
> 标签：ruby

有一些 Ruby 类不允许在它们的实例上定义单例方法。例如`Symbol`：

```
var = :asymbol

def var.hello
  "hello"
end

# TypeError: can't define singleton method "hello" for Symbol 
```

*我认为这可能是对所有直接值的限制，但它似乎适用于`nil`、`true`和`false`*`Fixnum`（但不适用于or的实例`Bignum`）：

```
var = true

def var.hello
  "hello"
end

var.hello #=> "hello" 
```

我不明白为什么 Ruby 允许在某些对象类而不是其他对象上定义单例方法。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-19T22:39:53.343

这与Matz[在此处](http://books.google.com/books?id=jcUbTcr5XWwC&pg=PA73&lpg=PA73&dq=immediate%20values%20singleton%20method&source=bl&ots=fIFlAe8xjy&sig=j7WgTA1Cft0WrHwq40YdTA50wk0&hl=en&sa=X&ei=0kHSUKCVB-bW0gHRxoHQAg&ved=0CD8Q6AEwAQ#v=onepage&q&f=false)描述的称为“立即值”的概念有关。

事实上，没有立即值应该允许单例方法。但是，在、 和的情况下`true`，实际上有支持这些值的单例类（或者该值实际上是单例类 - 我不确定这一点）。因此，您可以将单例实例添加到支持类，该类的表现就好像它是值本身一样。Numeric 和 Symbol 实例（显然）不是单例，并且无处保存单例方法。`false``nil`

# drupal - Drupal 6.x 根据角色向用户发送不同的欢迎邮件

> ID：13962149
> 
> 赞同：2
> 
> 时间：2012-12-19T22:12:46.920
> 
> 标签：drupal

我对 Drupal 几乎是全新的，我正在从事一个项目，我们的目标之一是在一组用户注册后向他们发送不同的注册电子邮件。我的想法是创建一个可以在电子邮件中使用的令牌，该令牌将由用户的角色确定。我进入了 user.module 并添加了这个。角色；

```
if($welcomer == 'Student Member'){
$copying = "SPECIAL EMAIL TEXT";
}
else{
$copying = "GENERAL EMAIL TEXT";
} ?> 
```

然后在令牌部分我设置了这个

```
<?php '!sendit' => $copying, ?> 
```

到目前为止，如果使用它，它什么也不做，即使 else 语句也无法触发。所以我的问题是，我该怎么做呢？这是最佳方式还是有更简单的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T12:03:24.180

[不要破解 Drupal 核心](http://drupal.org/best-practices/do-not-hack-core)，否则当您更新 Drupal 时，所有代码都将丢失。

我目前没有要测试的环境，所以这段代码没有经过测试，但你想要这样的东西：

```
function yourModuleName_form_user_register_alter(&$form, &$form_state) {
    // Add your own function to the array of submit callbacks
    $form['#submit'][] = 'yourModuleName_user_register_submit';
}

function yourModuleName_user_register_submit($form, &$form_state) {
    // I don't think this line is correct but don't have an environment to test in at the moment
    // Do a print_r here on $form_state['values'] and see where the user roles are stored
    $roles = $form_state['values']['roles'];

    if(in_array('Student Member', $roles) {
        // send student email here
    } elseif(in_array('Teacher Member', $roles) {
        // send teacher email here
    }
} 
```

# git - 误删svn远程配置，怎么办？

> ID：13962150
> 
> 赞同：1
> 
> 时间：2012-12-19T22:12:59.140
> 
> 标签：git, git-svn

我将 git 存储库设置为跟踪某个 svn 存储库。我定期将我的主分支更新到 svn 存储库：

```
git svn fetch
git rebase git-svn 
```

主分支没有修改。

然后，我把东西搞砸了，所以我决定清除我的本地 repo，并从上游再次克隆它。现在我的本地仓库丢失了任何与 svn 相关的信息。怎么重新设置？我担心 git 没有意识到 master 分支已经重新调整到某个版本。更糟糕的是，svn repo 的 URL 已更改。

# jquery - 查找元素旁边的图像

> ID：13962155
> 
> 赞同：1
> 
> 时间：2012-12-19T22:13:22.543
> 
> 标签：jquery, find, append

我正在尝试找到某个元素旁边最接近的 img 。这个元素可以是从 h1 到 div 的任何东西。找到这个 img 时，我想将它附加到一个 div 中。这对我不起作用：

```
img = $(this).parent().find('img').attr('scr');

$('#result').append('<img src="' + img + '"  />'); 
```

不知道为什么这不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:16:19.760

使用`closest()`和的组合`:has()`。

```
var img = $(this).closest(':has(img)').find('img').attr('src');

$('<img/>',{src: img}).appendTo('#result'); 
```

# php - 使用 CodeIgniter 进行身份验证 - 附加会话信息

> ID：13962161
> 
> 赞同：1
> 
> 时间：2012-12-19T22:13:46.443
> 
> 标签：php, codeigniter, session, authentication

很长一段时间以来，我一直是stackoverflow的狂热读者，现在轮到我提问了。

我遵循[http://net.tutsplus.com/tutorials/php/easy-authentication-with-codeigniter/](http://net.tutsplus.com/tutorials/php/easy-authentication-with-codeigniter/)教程并设法让它为我自己完美地工作，但是我需要稍微扩展系统。在验证用户之后，我需要能够拉出经过身份验证的人的其他行字段并存储在会话变量中，以便在其他控制器中用于将信息发送回数据库。

例如，我想在会话变量 $f_name 中有一个，我需要他们的 $username。我高高在上，找到了答案，但他们只会让我感到困惑。

我的模型：

```
class admin_model extends CI_Model {
 function __construct( )
 {

 }

 public function verify_user($user_id, $password)
 {
 $q = $this->db->where('user_id', $user_id)
 ->where('password', sha1($password))->limit(1)->get('users');

 if ( $q->num_rows > 0   ){
     return $q->row();
 }
return false;

}

} 
```

我的控制器：

```
class admin extends CI_Controller {

function __construct()
{
parent:: __construct();
session_start();

}

public function index()
{
    if ( isset($_SESSION['user_id'])){
        redirect('welcome');
    }
    $this->load->library('form_validation');
    $this->form_validation->set_rules('user_id', 'User ID', 'required|min_length[8]');
    $this->form_validation->set_rules('password', 'Password', 'required|min_length[4]');

    if ($this->form_validation->run() !==false){
       $this->load->model('admin_model');
      $res = $this
          ->admin_model
          ->verify_user(
          $this->input->post('user_id'),
          $this->input->post('password')
      );
   if ($res !== false) {
    $_SESSION['user_id'] = $this->input->post('user_id');
    redirect ('welcome');
   }

    }

    $this->load->view('login_view');
}

public function logout(){

    session_destroy();
    redirect ('admin');
}
} 
```

再次感谢大家，我期待您的回答\建议

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:32:04.857

有几件事：
-需要的`__construct()`函数（或者该函数可以被删除，因为它是空的）来继承代码点火器模型构造函数。 - 代码点火器和 PHP 会话是不同的。您正在使用 PHP 会话，这意味着您必须在要访问会话数据的每个页面上发送任何输出之前调用。这也可以通过打开 session.autostart 为 php.ini 中的每个页面设置`admin_model``parent::__construct`
`session_start()`

如果您想使用代码点火器会话，请查看此处： [http ://ellislab.com/codeigniter/user-guide/libraries/sessions.html](http://ellislab.com/codeigniter/user-guide/libraries/sessions.html)

## 2012 年 12 月 21 日更新

尝试从返回的数据库行设置会话变量：

`$_SESSION['f_name'] = $res->f_name;`并且`$_SESSION['username'] = $res->username;`与您设置会话用户 id 变量的位置相同。我假设您的数据库字段正在映射到您要用于 f_name 和 username 字段的字段。

# dwolla - 您可以取消/使 CheckoutId 无效吗？

> ID：13962163
> 
> 赞同：2
> 
> 时间：2012-12-19T22:13:51.193
> 
> 标签：dwolla

我正在使用异地网关，并且在选择 Dwolla 进行付款时锁定了我的购物车，但是如果用户取消，我希望能够解锁购物车并且不允许用户使用生成的 CheckoutId 进行购买。这有什么方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T22:27:37.590

只要您在对[https://www.dwolla.com/payment/request](https://www.dwolla.com/payment/request)（例如“https://www.myurl.com/redirect”）的请求中为“重定向”设置了值，客户取消将在这里结束：

```
https://www.myurl.com/redirect?error=failure&error_description=User Cancelled 
```

从那里，检查查询字符串是一件简单的事情。这部分取决于您的语言，但在 PHP 中，您可以`$_GET["error_description"]`查看它是否“用户已取消” - 如果是，请解锁购物车。下次用户完成结帐流程时，他们将触发另一个付款请求，该请求将以新的 CheckoutId 进行响应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T21:18:41.473

没有办法使结帐会话无效......但是另一方面，结帐会话在创建 15 分钟后或在第一次完全使用后会失效；以先到者为准...

# windows - 无法在 Windows 32 位上加载 SWT 库

> ID：13962165
> 
> 赞同：9
> 
> 时间：2012-12-19T22:14:06.657
> 
> 标签：windows, exception, dll, swt, 32-bit

我几乎完成了一个在 Linux 上开发的 Java 项目。现在我需要在 Windows 上构建和测试它。所以我在 Windows XP 32 位上安装了 Eclipse，并导入了我的项目。项目的所有依赖项都在 lib 文件夹中的 jar 文件中，在 Linux 上一切正常，但在 Windows XP 上出现以下错误：

```
Exception in thread "main" java.lang.UnsatisfiedLinkError: Could not load SWT library. Reasons: 
    no swt-pi-gtk-4234 in java.library.path
    no swt-pi-gtk in java.library.path
    Can't load library: C:\Documents and Settings\firzen\.swt\lib\win32\x86\swt-pi-gtk-4234.dll
    Can't load library: C:\Documents and Settings\firzen\.swt\lib\win32\x86\swt-pi-gtk.dll

    at org.eclipse.swt.internal.Library.loadLibrary(Library.java:331)
    at org.eclipse.swt.internal.Library.loadLibrary(Library.java:240)
    at org.eclipse.swt.internal.gtk.OS.<clinit>(OS.java:22)
    at org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:63)
    at org.eclipse.swt.internal.Converter.wcsToMbcs(Converter.java:54)
    at org.eclipse.swt.widgets.Display.<clinit>(Display.java:133)
    at gui.Frontend.<init>(Frontend.java:51)
    at Fighter.main(Fighter.java:18) 
```

我已经搜索了这些 DLL，但我没有找到它们。我在哪里可以下载这些 DLL 文件？

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T23:00:28.363

正确的 DLL 文件位于您特定平台的 swt.jar 中。您需要从[http://download.eclipse.org/eclipse/downloads/drops4/R-4.2.1下载适用于 Windows（不是 x86_64）的 SWT，例如“swt-4.2.1-win32-win32-x86.zip” -201209141800/#SWT](http://download.eclipse.org/eclipse/downloads/drops4/R-4.2.1-201209141800/#SWT)。

看起来您好像尝试过使用来自 linux SWT 的 swt.jar。那是行不通的。您需要为要支持的每个平台下载特定于平台的 SWT 包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-02T02:47:14.640

当我尝试执行 Eclipse 4.4.0 中包含的“Hello World SWT”教程时遇到了类似的问题。

在这种情况下，解决方案非常简单。我从 Craig Williams 在[http://www.eclipse.org/forums/index.php/t/261606/的回答中得到它](http://www.eclipse.org/forums/index.php/t/261606/)

“对我来说，解决方案位于标题为‘配置 Java 项目’的教程步骤中。进入项目属性并选择 Java 构建路径，然后确保您位于之前添加 SWT 项目的项目选项卡中。展开参考到 SWT 项目。在哪里说 Native library location 我发现当我按照教程进行操作时它说（无）。当我在教程前面添加它时，我单击编辑并在我的工作区中找到了 SWT 项目。选择它并单击好的。”

希望它可以帮助到此页面的其他人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-24T13:13:39.867

使用`*.jar`打开的窗口。转到 Java 构建路径。删除所有`org.eclipse.swt.gtk.linux`并替换为`org.eclipse.swt.win32`

# c++ - 这种情况下有什么样的多线程保护？

> ID：13962166
> 
> 赞同：4
> 
> 时间：2012-12-19T22:14:07.647
> 
> 标签：c++, multithreading, boost, boost-thread

我正在使用 C++，并且正在使用 boost 库 mutex、recursive_mutex 和其他同步对象。

我经常有以下模式：

*   无效重建所有（）。此功能进行了许多内部更改。
*   无效 DoSomethingA()。使用 RebuildAll 构建的东西做一些工作。
*   无效 DoSomethingB()。使用 RebuildAll 构建的东西做一些工作。
*   无效 DoSomethingC()。使用 RebuildAll 构建的东西做一些工作。
*   ...

可以从不同的线程调用这些函数。我希望能够并行执行 DoSomethingA()、DoSomethingB() 和 DoSomethingC()。但是当调用 RebuildAll() 时，我需要确保 DoSomething 函数没有被执行。

有什么可以帮助我保护这些功能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:22:22.700

这通常称为[读写](http://en.wikipedia.org/wiki/Readers%E2%80%93writer_lock)锁。读写锁的规则是：

*   可以在任何给定时间获取任意数量的读锁，可能是由不同的线程。
*   只有一位写入者才能获得锁，并且只有在所有读取者都完成时。
*   当作者拥有锁时，没有读者可以获取锁。

在您的示例中，`RebuildAll()`将是作家，而`DoSomethingA()`通过`DoSomethingC()`将是读者。

Boost 有一个读写锁的实现，称为[`boost::shared_mutex`](http://www.boost.org/doc/libs/1_39_0/doc/html/thread/synchronization.html#thread.synchronization.mutex_types.shared_mutex). 不过，这还没有在标准库中。

# c# - 存储过程不返回任何列

> ID：13962171
> 
> 赞同：0
> 
> 时间：2012-12-19T22:14:46.040
> 
> 标签：c#, sql-server, entity-framework, stored-procedures

我有以下存储过程：

```
 SET ANSI_NULLS ON
 GO
 SET QUOTED_IDENTIFIER ON
 GO
 ALTER PROCEDURE [dbo].[SearchMediaTitles] 

   @query varchar(50),
   @limit int = 6,
   @userId int
 AS
 SET FMTONLY OFF
 BEGIN

 declare @searchString varchar(52)

 set @searchString = '"' + @query +'*"'
 IF @userId!=NULL
 SELECT TOP (@limit) ID, Title from Media where CONTAINS([Title], @searchString)
 AND ID IN
  (
  SELECT FavoriteMedia_ID
  FROM dbo.UserMedia
  WHERE UserMedia_Media_ID=@userId
  )
 ELSE
 SELECT TOP (@limit) ID, Title from Media where CONTAINS([Title], @searchString)

 END 
```

在实体框架中，当我尝试将其映射为复杂类型的函数导入时，它说

> *选定的存储过程不返回任何列*

我在互联网上读到了这个，我发现我需要设置`SET FMTONLY OFF`，但是你可以看到它没有用。

有任何想法吗？

**编辑**：

我已更改`SELECT`为`*`并返回一个空结果。我认为这与上述问题有关

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T09:06:56.227

对于每个有同样问题的人，这就是我所做的。

首先，我将存储过程修改为一个简单的过程，如下所示：

```
 SELECT  [column1],[column2] FROM [table] 
```

我将其导入`Entity Framework`，创建了复杂类型和映射属性

然后我把它改回来并更新了模型，现在它可以工作了。我认为`Entity Framework`复杂的存储过程存在一些问题。根据我的阅读，它无法获得动态存储过程或使用`temp tables`.

PS：当我使用 Ajax 调用它时，我使用 `data.column1 and data.column2`. 如果我使用`data.value' it returns`undefined` 。

这有点奇怪。

**编辑：**就像马丁说的，但我不知道为什么它一开始就不起作用！谢谢你顺便说一句！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:59:39.223

我猜你在你的 prefix_term 上缺少单引号。所以这：

```
set @searchString = '"' + @query +'*"' 
```

应该：

```
set @searchString = CHAR(39) + '"' + @query +'*"' + CHAR(39) 
```

# xml - R xmlToDataFrame XML TEI

> ID：13962174
> 
> 赞同：0
> 
> 时间：2012-12-19T22:14:58.833
> 
> 标签：xml, r

Someonr 附带了一个 XML TEI（文本编码计划）来进行 R traitement ...我不是 XML 专家，也不是 TEI 专家（我不知道它是否格式正确）。我所有的尝试都是不成功......我的一份文件：

```
<?xml version="1.0" encoding="utf-8"?>
<TEI xmlns="http://www.tei-c.org/ns/1.0">
  <teiHeader>
    <fileDesc>
      <titleStmt>
        <title>Luxury Bound</title>
      </titleStmt>
      <publicationStmt>
        <p/>
      </publicationStmt>
      <sourceDesc>
        <msDesc>
          <msIdentifier>
            <country>unknown</country>
            <msName>unknown location (Hours by a follower of Jean Semont)</msName>
          </msIdentifier>
          <msContents>
            <msItemStruct/>
            <msItem>
              <p xml:id="content1">Hours (Tournai)</p>
            </msItem>
          </msContents>
          <physDesc>
            <decoDesc>
              <p>Information on the illustrations : </p>
              <p>Total number of illustrations : </p>
              <p>Number of miniatures : </p>
              <p>Number of historiated initials : </p>
              <p>Number of grisailles : </p>
              <p>Number of drawings : </p>
              <p>
                <listPerson type="miniaturists">
                  <person>
                    <persName>Jean Semont (follower)</persName>
                  </person>
                </listPerson>
              </p>
            </decoDesc>
.... 
```

我试过了 ：

```
library('XML')
doc<-xmlParse("luxud1.xml")
summary(doc)

$nameCounts

        catDesc        category               p           title         measure             val            date 
             11              11              10               6               4               4               3 
             ab       langUsage        language        origDate        persName             TEI      additional 
              2               2               2               2               2               1               1 
      adminInfo    availability            bibl         binding     bindingDesc          catRef       classDecl 
              1               1               1               1               1               1               1 
        country        decoDesc    encodingDesc          extent        fileDesc              hi         history 
              1               1               1               1               1               1               1 
       listBibl      listPerson      measureGrp      msContents          msDesc    msIdentifier          msItem 
              1               1               1               1               1               1               1 
   msItemStruct          msName            note      objectDesc          origin          person        physDesc 
              1               1               1               1               1               1               1 
      placeName       principal     profileDesc publicationStmt             ref          region      settlement 
              1               1               1               1               1               1               1 
     sourceDesc     supportDesc        taxonomy       teiHeader       textClass       titleStmt 
              1               1               1               1               1               1 

$numNodes
[1] 102 
```

如果我尝试过：

```
p<-xmlToDataFrame(doc,homogeneous=FALSE, nodes= getNodeSet(doc, "//persName") ) 
```

我有一个奇怪的事情......文件所有值的串联......你能给出好方法吗？谢谢你

# tcl - 如何使 doxygen 仅记录包中导出的 tcl 函数

> ID：13962175
> 
> 赞同：0
> 
> 时间：2012-12-19T22:15:05.387
> 
> 标签：tcl, doxygen

有没有一种简单的方法可以让 doxygen 只记录包中导出的 tcl 函数。配置文件中的命令可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T01:52:28.987

在 tcl 成为受支持的语言之前，我以前使用 doxygen 生成 Tcl 文档。有一个用于处理输入文件的配置选项。

```
FILTER_PATTERNS = *.tcl=bin\tcl_converter.bat 
```

其中 bin\tcl_converter.bat 只是一个启动自定义处理器的批处理脚本。在添加 tcl 支持之前，我们使用它来最小化地将 tcl 语法更改为 doxygen 可以理解的内容。但是，您可以在这里使用它来删除所有未导出的方法。编写一个处理器来删除所有未导出的过程将非常简单。就像是：

1.  读取输入文件（它将作为 [lindex $argv 0] 传递）到行数组中
2.  遍历所有查找导出命令的行
3.  遍历所有查找 procs 的行并匹配上面列出的导出命令
4.  将所有当前过程及其前导码保存在一个字符串中 - 如果它与导出的命令匹配，则在最后写入输出文件

一个适当的解析器会使这个万无一失，但可能是矫枉过正。您可以只查找命名空间的开头和 proc 的开头并设置状态机。启动命名空间后，只需将每一行附加到字符串并使用**info complete $accumulated_ns_string**进行测试。同样，一旦你看到一个**proc**命令，开始将这些行累积到一个不同的字符串中，并在每行之后继续检查**info complete $accumulated_proc_string**。一旦评估为真，您可以打印或不打印并重置字符串。

使用**完整的信息**将大大简化生活 - 所有的诡计都将跟踪命名空间并根据完全限定的导出名称评估完全限定的 proc 名称，以确定是否将其打印到输出文件。有一些代码发生在命名空间之外或动态生成的导出的病态案例，但这种方法在我之前的工作中与我们投入的所有内容相比效果很好。

# wcf - 在 Windows 之外使用 Web 服务 MEX 端点

> ID：13962176
> 
> 赞同：1
> 
> 时间：2012-12-19T22:15:11.877
> 
> 标签：wcf, web-services, soap, wsdl, endpoint

我想访问 Windows 托管的 Web 服务。我无法控制服务或其配置。使用 Visual Studio，我可以创建一个指向端点的服务引用，`https://example.com/PylonServices/AddressServiceEndpoint.svc/mex`并显示所有方法。

我想编写一个客户端来使用基于 Linux 的脚本语言（例如 PHP）访问此服务。但是，tt 似乎该服务不会通过 HTTP 使服务的 WSDL 文件可用，只有 MEX 可用。

当服务仅提供 MEX 端点时，如何让 PHP 创建 SOAP 客户端？如果需要，我很乐意使用另一种脚本语言（例如 Perl、Ruby、Python 等）。

# cakephp - 从插件 webroot 文件夹加载 PHP 文件作为 CSS 文件

> ID：13962179
> 
> 赞同：0
> 
> 时间：2012-12-19T22:15:21.180
> 
> 标签：cakephp, cakephp-1.3

如何执行 PHP 文件以生成 CSS，并将该文件放在我的插件 webroot 文件夹中。

例如;

/app/plugins/myplugin/webroot/css/style.php

如果我将 style.php 文件放在应用程序 webroot 文件夹中，那么它工作正常。当我将 PHP 文件移动到插件的 webroot 时，它不会加载。我收到一个 CakePHP 错误，说 CssController 不存在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:27:37.197

不要把它放在 webroot 中，只需让控制器的动作渲染 css。

这是一个做类似事情的例子，`JS`在这种情况下..

[控制器](https://github.com/Infinitas-Plugins/InfinitasPiwik/blob/master/Controller/InfinitasPiwikController.php#L8)和[视图](https://github.com/Infinitas-Plugins/InfinitasPiwik/blob/master/View/InfinitasPiwik/js/tracker.ctp)

默认情况下，路由是`/infinitas_piwik/infinitas_piwik/tracker.js`默认的，尽管很容易使用路由器将其更改为几乎任何东西。

# php - 使用 PHP 为位于文档根目录之外的流式传输视频文件提供服务

> ID：13962181
> 
> 赞同：1
> 
> 时间：2012-12-19T22:15:27.087
> 
> 标签：php, webserver, document-root

我正在编写一个文件浏览器/上传器，它允许用户预览图像和视频文件，而无需将文件下载到他们的硬盘上。出于隐私和安全原因，我将这些资产文件保存在文档根目录之外。我可以使用 GD 库生成图像预览，但是，我不确定如何为 Flash 播放器提供 SWF 或 FLV 文件进行播放。有没有办法让 PHP 通过[readfile()](http://bg2.php.net/readfile)提供一个临时文件？

它会像这样工作：`http://example.com/flv_serve.php?file=sample.flv`. 然后 readfile 将从`$_GET['file']`资产目录中抓取并将文件作为 FLV 转储到网络服务器。当然，它首先会验证访问flv_serve.php 的人是否具有会话对文件的权限。

有没有人必须处理类似的问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:29:31.740

我不确定流媒体，但如果你只想输出文件，我会这样做：

```
// authentication
header("Content-type: application/x-shockwave-flash");
readfile($filePath); 
```

我认为这会流式传输普通资源（图像、文本等），但不确定这是否适用于 Flash 以及它是否取决于播放器。

我做了这样的事情，我确信它确实流式传输良好，但不确定是否做了其他一些黑魔法来获得流式传输功能（这是一个相当大的项目）。

**底线：**如果您可以在网络服务器上传递文件并将其流式传输到播放器中，那么它也可以正常工作。

# ios - 如何编辑 XML 文件 flash cs6

> ID：13962184
> 
> 赞同：0
> 
> 时间：2012-12-19T22:15:38.740
> 
> 标签：ios, xml, flash, air

我现在正在使用 flash pro cs6 并发布为 ipa 文件（适用于 ios 的 AIR），我正在尝试编辑 XML 文件以删除 iTunes 所做的图标光泽效果。我在这里资助了一行代码

[从 Adob​​e Air iOS 应用程序中删除图标光泽效果？](https://stackoverflow.com/questions/11300130/remove-icon-gloss-effect-from-an-adobe-air-ios-app)

但是....好吧，在发布设置 (ios) 中，我无法替换由 flash pro 自动生成的 XML 文件。我无法编辑它并保存因为 flash pro cs6 覆盖了它。

请帮忙！这真是令人头疼！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T10:27:00.427

终于让它工作了...尝试使用其他地方建议的 Python 脚本在 swf 中启用高级遥测，然后欺骗 Flash CS6 将经过修改的 swf 打包。

多年来，我一直在让 Flash 使用我修改过的 swf，但后来 ipa 没有安装。当我尝试安装时，iPad 上出现错误……安装失败。

我欺骗Flash的方法如下。

在 myApp.swf 上运行脚本。

将发布文件名更改为 myApp2 或 myApp 是否为原始文件名。

在 Included 文件中包含 myApp.swf 以使其添加到 ipa 包中。

在发布设置的前两个选项卡上更改应用程序名称和应用程序 ID，以便它们最后没有 2。

确保版本号和最重要的应用程序 ID 与应有的相同。

结果生成的 myApp-app.xml 应该引用 myApp.swf 而不是 myApp2.swf

最终结果 - ipa 使用启用了高级遥测的旧 swf 安装

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T16:45:59.443

我不知道我是否正确理解了这个问题，但一个简单的解决方案是`app.xml`使用记事本或其他文本编辑器编辑文件，然后在文件属性上将其设置为只读。这样，Flash CS6 将无权覆盖您的文件并从 Flash CS6 进行正常的发布过程。

注意：经过测试并按预期工作。

# c# - 为什么 Excel.Application App.GetType().Name 返回 ComObject？

> ID：13962185
> 
> 赞同：0
> 
> 时间：2012-12-19T22:15:55.043
> 
> 标签：c#, excel, office-interop

使用 VisualStudio 2008，我创建了一个简单的 Excel 2007 加载项项目。

我添加如下代码...

```
var app = Application;
var members = app.GetType().GetMembers(BindingFlags.Public|
               BindingFlags.NonPublic|
               BindingFlags.Instance|
               BindingFlags.Static);
var typeName = app.GetType().Name; 
```

...到 ThisAddIn_Startup 方法（并解决对 System.Reflection 的缺失引用）。

当我运行代码时，typeName 是“_ *ComObject”。我期待像“Excel.ApplicationClass”这样的东西。而且，members 只包含 26 个成员，远远少于 Excel.Application 对象。单步执行代码，我将鼠标悬停在应用程序上，并显示了许多成员（所有成员都带有蓝色图标，这有点奇怪）。但是，显示的类型名称是“System.Runtime.Remoting.Proxies._TransparentProxy* ”，这又不是我所期望的。

在设计时，键入 app{dot} 以获取“Intelli-sense”会列出可供选择的各种成员，即它列出了所有 Excel.Application 成员。

此外，如果我运行 Powershell 脚本...

```
$obj = New-Object -ComObject excel.application
$obj | get-member 
```

...输出列出了所有 Excel.Application 成员。

那么，如何在运行时获取 C# 中所有 Excel.Application 成员的 MemberInfo 对象？

最后，以防万一，我在创建项目时选择 Excel 2007 加载项模板，然后转到属性->调试并告诉它启动 Excel 2010。这就是我希望构建一个 2007 加载项的方式也适用于 Office 2010。我为 Word 加载项做了一个非常相似的方法，结果与我预期的一样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-28T19:51:03.660

这个问题与“为什么”有关，我通过反思只有 26 个成员。我听从了皮特的建议并阅读了这篇文章，并使用...

```
var excel = Type.GetTypeFromProgID("Excel.Application");
var members = excel.GetMembers( ... ); 
```

...我能够找到超过 700 个成员。

但这仍然没有回答我的问题。我想知道为什么我不会使用正常反射来获得它。如果有人可以用很好的解释和一些文档参考来回复，我会将他们的标记为答案。

# database - 将 LIMIT OFFSET 与 SUM 一起使用会提供准确的数据吗？

> ID：13962188
> 
> 赞同：1
> 
> 时间：2012-12-19T22:16:29.780
> 
> 标签：database, postgresql

我相信我是一个相当简单的问题，我无法在 Stack 或 Google 土地上找到它。我有一个相当基本的选择语句，如下所示：

```
SELECT
    itemid,
    itemdiscription,
    SUM(quantity)
FROM     mytable
GROUP BY itemid, itemdescription
ORDER BY itemid
LIMIT    250
OFFSET   0; 
```

基本上，这是从超过 100k + 记录左右的表中提取的，或者更少，它是一个临时表。所以我想弄清楚的是提供可靠数据的 SUM 函数，因为相似的项目 id 之间可能有 30k 条记录。我最初的想法是这会执行查询，然后只返回前 250 个结果，但后来我想可能不是，所以我想我会要求社区确认这是如何工作的。

我使用 LIMIT/OFFSET 的主要原因是因为我正在从 PHP 执行查询，并且这些值是为性能而迭代的变量，所以我不处理使用大量内存的数组。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:45:14.103

正如文档所述，限制（或偏移）适用于“由查询的其余部分生成的行”，因此在应用限制或偏移之前考虑查询的结果。然后应用这些子句会影响这些结果。

[http://www.postgresql.org/docs/9.2/static/queries-limit.html](http://www.postgresql.org/docs/9.2/static/queries-limit.html)

这是使用 LIMIT 的几种方法的 SQL Fiddle

[http://www.sqlfiddle.com/#!12/08fa0](http://www.sqlfiddle.com/#!12/08fa0)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T03:57:06.433

首先，LIMIT 在处理完查询结果后对其进行处理。但是，如果服务器认为结果相同，则可以对此进行优化 - 例如，如果是索引字段，`SELECT x FROM t ORDER BY x LIMIT 1`它将工作得非常快。`x`

但是，如果你在这里使用 LIMIT/OFFSET 来提高性能或实现分页，你应该重新考虑你的方法。这是因为即使所有聚合字段都已编入索引并且 LIMIT 可以利用这一点，但当 OFFSET 增加时，总工作量也会增加，并且运行时间很快就会变得几乎与在没有 LIMIT 的情况下运行完整查询相同 - 非常昂贵。

如果您要保持 OFFSET 非常低（最好是 0），我强烈建议您添加复合索引`(itemid,itemdescription)`- 它应该使您的查询运行得更快，特别是如果您有许多行具有相同的`itemid`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T11:41:45.950

`EXPLAIN`你的查询，看看它是如何执行的。您会看到，这`LIMIT`是在分组后应用的。

# asp.net-mvc - 实现 IAuthorizationFilter 的过滤器的执行顺序

> ID：13962191
> 
> 赞同：2
> 
> 时间：2012-12-19T22:16:43.883
> 
> 标签：asp.net-mvc, ninject.web.mvc

我创建了一个名为 PrincipalFilter 的过滤器，实现了 IAuthorizationFilter 接口，以设置自定义的 IPrincipal 和 IIdentity。这是一个全局过滤器。我通过 Ninject (3.0) 使用依赖注入，所以我在 NinjectModule 中注册我的过滤器：

```
this.BindFilter<PrincipalFilter>(FilterScope.Global, 0); 
```

这工作正常。至少我是这么想的。

有一个案例就是问题所在。重要的事实是，我的自定义 IIdentity 的属性 IsAuthenticated 在用户名已知时并不总是返回 true（可以识别用户但未通过身份验证）。防伪令牌出现问题。生成令牌和验证令牌时，当前身份不一样：在一种情况下，这是 mvc 框架的通用身份，在另一种情况下，这是我的自定义身份。2 个身份返回相同的名称，但在某些情况下不会返回相同的 IsAuthenticate 值。用户的名称包含在防伪令牌中；但如果一个身份未经过身份验证，则令牌不使用身份的名称，而是使用一个空字符串。因此令牌无效，因为它包含的名称不是当前身份的名称。

因此，当身份具有名称但未经过身份验证时，标记为 ValidateAntiForgeryTokenAttribute 的操作会出现问题。这是因为 ValidateAntiForgeryTokenAttribute 在我的自定义 PrincipalFilter 之前执行。

所以我的问题是如何确保我的自定义 IAuthorizationFilter 将在 ValidateAntiForgeryTokenAttribute 之前执行？我在注册过滤器时尝试使用 FilterScope 参数，但没有成功。

# windows-runtime - 将 Windows 应用商店应用移植到 Windows RT

> ID：13962195
> 
> 赞同：1
> 
> 时间：2012-12-19T22:17:27.657
> 
> 标签：windows-runtime

移植现有 Windows 应用商店应用程序以使其在 Windows RT 平板电脑上运行时可能会出现哪些类别的问题？我对 C# XAML 游戏特别感兴趣，但其他情况也很相关（C++、JavaScript）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:49:14.753

不适用移植注意事项。由于抖动，托管应用程序已经顺利处理了处理器架构差异。这使得 32 位和 64 位操作系统和处理器之间的区别是不可见的，只要您的 pinvoke 是 kosher 并且您不依赖于古老的 32 位组件。

以同样的方式扩展到 Windows RT，如果机器有 ARM 内核，它就会有 ARM 抖动。WinRT 与架构无关。也消除了对 pinvoke 或 COM 的依赖问题，当您有这样的依赖项时，您将无法在应用商店中发布您的应用程序。WACK 会提前警告你的。

它只是工作。它就是这样设计的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T05:27:06.660

除了汉斯已经说过的，我想指出两点，你需要考虑：

*   对外部本机库的依赖：所有这些库都需要与 Windows Store 兼容，否则 WACK 验证将失败。但它们也需要适用于所有三种处理器架构：一旦开始使用它们，您就需要为应用程序的不同构建（x86、x64 和 ARM）创建三个，而不是为所有三个创建一个通用的。

*   不要忘记性能，尤其是因为您询问的是游戏。ARM 设备中的硬件通常较慢，因此您可能会在 ARM 设备上遇到性能问题，而在 Intel 设备上不会遇到这些问题。不幸的是，检查这一点的唯一方法是在物理设备上进行测试。

# sql - 在表员工上创建 SQL+ 创建触发器

> ID：13962196
> 
> 赞同：1
> 
> 时间：2012-12-19T22:17:33.667
> 
> 标签：sql, oracle

我有一张 EMP 表，我想创建一个触发器来“在雇用新下属时以员工的工资增加 100 个单位。

```
 CREATE TABLE EMP (EMPNO NUMBER(4) NOT NULL,
    ENAME VARCHAR2(10),
    JOB VARCHAR2(9),
    MGR NUMBER(4),
    HIREDATE DATE,
    SAL NUMBER(7, 2),
    COMM NUMBER(7, 2),
    DEPTNO NUMBER(2));

    INSERT INTO EMP VALUES (7499, 'ALLEN', 'SALESMAN', 7698, TO_DATE('20-FEB-1981', 'DD-MON-YYYY'), 1600, 300, 30);
    INSERT INTO EMP VALUES (7369, 'SMITH', 'CLERK',    7902, TO_DATE('17-DEC-1980', 'DD-MON-YYYY'), 800, NULL, 20);
    INSERT INTO EMP VALUES (7521, 'WARD',  'SALESMAN', 7698, TO_DATE('22-FEB-1981', 'DD-MON-YYYY'), 1250, 500, 30);
    INSERT INTO EMP VALUES(7566, 'JONES', 'MANAGER',  7839, TO_DATE('2-APR-1981',  'DD-MON-YYYY'), 2975, NULL, 20);
    INSERT INTO EMP VALUES (7654, 'MARTIN', 'SALESMAN', 7698,TO_DATE('28-SEP-1981', 'DD-MON-YYYY'), 1250, 1400, 30);
    INSERT INTO EMP VALUES (7698, 'BLAKE', 'MANAGER', 7839,TO_DATE('1-MAY-1981', 'DD-MON-YYYY'), 2850, NULL, 30);
    INSERT INTO EMP VALUES (7782, 'CLARK', 'MANAGER', 7839,TO_DATE('9-JUN-1981', 'DD-MON-YYYY'), 2450, NULL, 10);
    INSERT INTO EMP VALUES (7788, 'SCOTT', 'ANALYST', 7566,TO_DATE('09-DEC-1982', 'DD-MON-YYYY'), 3000, NULL, 20);
    INSERT INTO EMP VALUES (7839, 'KING', 'PRESIDENT', NULL,TO_DATE('17-NOV-1981', 'DD-MON-YYYY'), 5000, NULL, 10);
    INSERT INTO EMP VALUES (7844, 'TURNER', 'SALESMAN', 7698,TO_DATE('8-SEP-1981', 'DD-MON-YYYY'), 1500, 0, 30);
    INSERT INTO EMP VALUES (7876, 'ADAMS', 'CLERK', 7788,TO_DATE('12-JAN-1983', 'DD-MON-YYYY'), 1100, NULL, 20);
    INSERT INTO EMP VALUES (7900, 'JAMES', 'CLERK', 7698,TO_DATE('3-DEC-1981', 'DD-MON-YYYY'), 950, NULL, 30);
    INSERT INTO EMP VALUES (7902, 'FORD', 'ANALYST', 7566,TO_DATE('3-DEC-1981', 'DD-MON-YYYY'), 3000, NULL, 20);
    INSERT INTO EMP VALUES (7934, 'MILLER', 'CLERK', 7782,TO_DATE('23-JAN-1982', 'DD-MON-YYYY'), 1300, NULL, 10); 
```

我的触发器是：

```
CREATE TRIGGER salary_increase
  AFTER UPDATE OF sal ON emp
  FOR EACH ROW

BEGIN
  UPDATE emp SET sal = sal + 100.0
        WHERE sal='800';
END salary_increse;
/ 
```

结果：（`Trigger created.`我的问题-->工资没涨）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T04:39:54.097

您的触发器声明为`FOR EACH ROW`，这是正确的；但这意味着您不需要运行 UPDATE 来更改列的值，您可以直接更改它，例如：

```
CREATE TRIGGER salary_increase
  AFTER UPDATE OF sal ON emp
  FOR EACH ROW

BEGIN
  IF :NEW.sal = 800.0 THEN
    :NEW.sal = :NEW.sal + 100.0;
  END IF;
END salary_increse;
/ 
```

这只是一个示例 - 它使用了您自己的触发器所隐含的逻辑，但它没有实现您的分配所描述的逻辑（*“在雇用新下属时以员工的工资增加 100 个单位。”*）。我把它留给你作为练习。

# c++ - GDI 中的多边形函数

> ID：13962200
> 
> 赞同：0
> 
> 时间：2012-12-19T22:17:47.480
> 
> 标签：c++, winapi, gdi

我正在尝试创建一个在鼠标单击时将三角形/各种多边形绘制到窗口的程序。我将应用程序绘制到窗口，但是当窗口无效时我无法让它们重新绘制。

我刚刚尝试包含代码的重要部分。

当用户移动鼠标时，临时三角形将变大/变小。当他们松开鼠标左键时，三角形存储在结构中。这部分似乎工作正常，并且存储了每个三角形的信息。请记住，我目前没有在结构中使用厚度或颜色。

```
typedef struct
{

POINT pt[3];
unsigned int colour1;
unsigned int colour2;
unsigned int colour3;
unsigned int thickness;
unsigned int printOrder;

}Triangles;

Triangles temp_tri;
Triangles triangle_store[MAX_OBJECTS];
int triCount = 0;

case WM_LBUTTONDOWN:

if(triButtonPressed) //Faulty Feature
    {
        mouse_down_x = LOWORD(lParam);
        mouse_down_y = HIWORD(lParam);

        temp_tri.pt[0].x = mouse_down_x;
        temp_tri.pt[0].y = mouse_down_y;

        mouse_down = true;

    }

case WM_MOUSEMOVE:
if(triButtonPressed)
    {
        if(mouse_down)
        {
            temp_tri.pt[1].x= LOWORD(lParam);
            temp_tri.pt[1].y = HIWORD(lParam);
            temp_tri.pt[2].x= LOWORD(lParam) *2;
            temp_tri.pt[2].y= HIWORD(lParam) *2;

            InvalidateRect(hWnd,NULL,true);
        }
    }

case WM_LBUTTONUP:
else if(triButtonPressed)
    {
        temp_tri.pt[1].x = LOWORD(lParam);
        temp_tri.pt[1].y = HIWORD(lParam);
        temp_tri.pt[2].x= LOWORD(lParam) + 90;
        temp_tri.pt[2].y = HIWORD(lParam) + 90;
        printOrder++;
        temp_tri.printOrder = printOrder;
        triangle_store[triCount] = temp_tri;
        triCount ++;
        mouse_down = false;
    }

case WM_PAINT:

for(int  i =0; i<triCount; i++)
        {

            if(o == triangle_store[i].printOrder)
            {

                rePaintTriangles(backDC);
            }
        }

if(triButtonPressed)
    {
        if(mouse_down)
        {
            triangle(backDC);
        }
    }

void triangle(HDC hdc)
{

POINT pt[3];

pt[0].x = temp_tri.pt[0].x;
pt[0].y = temp_tri.pt[0].y; //Works fine. 
pt[1].x = temp_tri.pt[1].x;
pt[1].y = temp_tri.pt[1].y;
pt[2].x = temp_tri.pt[2].x;
pt[2].y = temp_tri.pt[2].y;

Polygon(hdc,pt,3);
}

void rePaintTriangles(HDC hdc)
{

Polygon(hdc,triangle_store[triCount].pt,3); //Doesn't Work

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:50:30.257

当您收到 WM_PAINT 消息时，您应该调用[`BeginPaint`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd183362%28v=vs.85%29.aspx)以获取您应该在其中进行绘画的 HDC。

# nlp - 哪些词要省略？

> ID：13962203
> 
> 赞同：0
> 
> 时间：2012-12-19T22:18:06.720
> 
> 标签：nlp, similarity, stop-words

我试图在两个句子之间找到一些相似性度量。我利用了两个词的个体语义相似性。但是字典中有很多单词是我从我的句子中提取出来的。我想从句子中删除一些我认为不能传达有关内容信息的单词。首先，我删除了字母较少的单词，但我认为这不合理，因为它也删除了一些信息丰富的单词。

看这里的一些句子的部分

```
"Despite the fact that ..."
"There's a debate such that ..."
"To sum up ..."
"Although ..., there is ..." 
```

如果我有一个包含这些单词的文本文件，我会将它们从我的字典中删除，只保留信息性单词。

是否有任何您知道的英语单词列表，以便我可以用来过滤我的字典？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:27:43.127

解决此类问题的一种方法是删除分布的头部和尾部。非常常见的词（即停用词）几乎不添加关于相似性的信息。相反，非常罕见的单词往往是拼写错误。您必须小心唯一性的阈值，这取决于您的语料库的来源和异质性：用户生成的输入往往包含比维基百科等精选来源的内容更多的独特拼写错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T16:33:41.127

有可用的常见“停用词”列表，例如，[这里](http://norm.al/2009/04/14/list-of-english-stop-words/)。

停用词也可能在某种程度上取决于域。例如，[美国专利全文数据库](http://www.uspto.gov/patft/help/stopword.htm)显然认为“权利要求”和“实施方案”非常普遍，我怀疑这对于非专利特定文件是正确的。

# math - 将线转换为多边形

> ID：13962204
> 
> 赞同：0
> 
> 时间：2012-12-19T22:18:08.207
> 
> 标签：math, language-agnostic

我正在尝试将一条线转换为一个非常细的多边形，但不知道如何考虑线的斜率/角度。

假设我有 x1,y1 和 x2,y2 的线段。如果这些值是 0,0 和 100,0（完全平坦的直线），我可以通过在两个 y 点上简单地添加 0.00001 来创建 2 个新点来创建一个非常薄的多边形。

我如何考虑线的斜率以实现与任何方向的线相同的效果？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:27:18.527

*您可以使用与 z 轴（即*三维）的叉积来确定与您的线成直角的线的方向。

```
(dx,dy,0) cross (0,0,1) 
```

事实证明，这些条款取消了，你得到的是（免责声明：我的标志可能是错误的）：

```
(-dy,dx,0) 
```

然后是规范化该方向（与您的线的长度相同）并乘以线宽的一半的情况。然后，您将线端偏移到您刚刚计算的方向（正数和负数版本）。

您需要根据线的方向进入哪个象限来计算手性，以便以正确的顺序（顺时针或逆时针）生成点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:25:18.953

找到一条垂直线，然后在这个方向上得到两个点，你将始终拥有相同的厚度。

向量 (x, y) 的两条垂线是 (-y, x) 和 (y, -x) 所以：

因为你的向量是 (x2 - x1, y2 - y1) 一个垂直于它的向量可能是：

(y1 - y2, x2 - x1) 或 (y2 - y1, x1 - x2)

只需选择一个，然后将其添加到每个点即可获得相应的点。假设您选择了第一个，您的两个额外点将是：

```
(x1 + d(y1 - y2), y1 + d(x2 - x1)) and (x2 + d(y1 - y2), y2 + d(x2 - x1)) 
```

其中 d 是您的线条粗细。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:28:16.073

假设 delta = 0.001

然后，您正在寻找的多边形是：

```
(x1, y1)
(x1 + 0.001 * (y2 - y1), y1 - 0.001 * (x2 - x1))
(x2 + 0.001 * (y2 - y1), y2 - 0.001 * (x2 - x1))
(x2, y2) 
```

# php - 无法断言 PHPUnit 中的参数类型

> ID：13962206
> 
> 赞同：1
> 
> 时间：2012-12-19T22:18:12.823
> 
> 标签：php, unit-testing, testing, phpunit

断言：

```
$chain->expects($this->once())
   ->method('addMethodCall')
   ->with(
       'addOptionsProvider',
       array(
          $this->isInstanceOf('Symfony\Component\DependencyInjection\Reference'),
          $this->equalTo(7)
       )
   ); 
```

`$chain`实际上是 的模拟对象`Definition`，这是我要测试的代码：

```
$definition->addMethodCall(
    'addOptionsProvider',
    array(new Reference($id), $priority)
); 
```

我正在开始 PHPUnit，所以我真的不知道我错过了什么。我发现断言论点真的很难理解。我已经包含了一个图像，其中包含断言和实际参数之间的视觉差异。

> PHPUnit_Framework_ExpectationFailedException ：方法名称的预期失败等于调用 1 次时的参数 1 调用 Symfony\Component\DependencyInjection\Definition::addMethodCall('addOptionsProvider', Array (...)) 与预期值不匹配。

![在此处输入图像描述](../Images/383bb1c51470ca4150e91a11a8005015.png)

**编辑**：实际上，我最终得到了这个：

```
$chain->expects($this->once())
    ->method('addMethodCall')
    ->with(
        $this->identicalTo('addOptionsProvider'),
        $this->logicalAnd(
            $this->isType('array'),
            $this->arrayHasKey(0),
            $this->arrayHasKey(1)
        )
    ); 
```

但是我不能“进入”数组值以进行进一步的断言！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:42:07.583

`->with()`具有与您期望的不同的方法签名。

`->with(string|PHPUnit_Framework_Constraint, ...)`

这意味着您不能只在其中传递一个数组，因为 PHPUnit 不够“聪明”，无法弄清楚您的意思。

模拟这个的最简单方法应该是：

```
->with(
   'addOptionsProvider',
   array(
      new Reference(1),
      7
   )
) 
```

因为它只会比较数组。

另一种模拟这个的方法（如果你需要对对象进行方法调用等等）是使用

```
->with($this->callback(function($arg)  { ... } )); 
```

并在那里做出你的断言。

对于一个复杂的例子，请参阅：[用具体值模拟 atLeastOnce，其余的并不重要](https://stackoverflow.com/questions/13550914/mock-atleastonce-with-concrete-value-the-rest-not-important/13551464#13551464)

# .net - 监控文件当前被另一个进程锁定/打开

> ID：13962211
> 
> 赞同：1
> 
> 时间：2012-12-19T22:18:26.897
> 
> 标签：.net, vb.net, filesystemwatcher, fileinfo

我的情况如下：

我有 1 个程序在运行时将其操作连续记录到 txt 文件中。它在运行时从不关闭文件。我不能修改这个程序。

我想用我的其他应用程序（用 VB.NET VS 2005 编写）监视这个文件。我的问题是，写入此日志的数据似乎没有立即注册。

我尝试使用 FileSystemWatch 来监视文件的更新。这种方法的问题是我不会立即收到正在写入数据的通知。使用资源管理器手动浏览到文件夹然后对其进行排序会触发更改的事件（不要问我为什么）。如果文件被其他应用程序关闭，我可能还会收到通知。

我也试过轮询文件并读取它的最后写入日期。这绝对只有在每次写入后都关闭文件时才有效。

是否有任何方法可以完成此监视，而无需应用程序写入日志关闭文件并重新打开它或手动访问正在写入的文件夹。

这是我的文件监视代码：

```
 If IO.File.Exists(recorder_path) Then
        Dim recorder_dir As String = recorder_path.Remove(recorder_path.LastIndexOf("\"))
        Dim recorder_name As String = recorder_path.Substring(recorder_path.LastIndexOf("\") + 1)

        recorder_watcher = New System.IO.FileSystemWatcher()
        recorder_watcher.Path = recorder_dir
        recorder_watcher.Filter = recorder_name
        recorder_watcher.NotifyFilter = NotifyFilters.Size
        AddHandler recorder_watcher.Changed, AddressOf recorder_update
        recorder_watcher.EnableRaisingEvents = True
    End If

    Private Sub recorder_update(ByVal source As Object, ByVal event_args As System.IO.FileSystemEventArgs)
        'Do Stuff
    End Sub 
```

我在 W7 和 XP 上运行这个应用程序并且只访问本地文件夹。

## **更新，另一种方法：**

下面的代码似乎工作得足够快：

```
 Dim new_txt As String = ""

    Dim fs As New FileStream(recorder_path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite)
    Dim file_reader = New StreamReader(fs)
    file_reader.ReadToEnd()

    While 1
        new_txt = ""
        System.Threading.Thread.Sleep(5)
        System.Windows.Forms.Application.DoEvents()

        new_txt += file_reader.ReadToEnd().ToUpper()
        If (new_txt.Length > 0)
           'Do stuff w/new txt
        End If
    End While 
```

每次日志记录过程写入文件时，这似乎都会给我更新。

谢谢，

伊恩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T07:02:16.663

事实上 FileSystemWatcher 不会给你太多，定期读取文件会有所帮助，但前提是文件以允许其他进程读取文件的共享模式打开。

另一种方法是使用文件系统过滤器驱动程序，它可以立即捕获所有写操作。如果驱动程序安装在文件所在的同一系统上，这将起作用（即过滤器不能在远程磁盘上工作）。

# eventbrite - 来自 event_list_attendees 的地址信息

> ID：13962213
> 
> 赞同：4
> 
> 时间：2012-12-19T22:18:52.043
> 
> 标签：eventbrite

有没有办法从 event_list_attendees 中获取与会者地址信息，而无需先自定义活动的订单？如果没有，是否可以从 API 自定义事件的订单？在查看方法列表时，我没有注意到该功能，而且我必须让我的用户在通过我编写的一些软件创建事件后访问 EventBrite 网站，这似乎很奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T00:06:26.493

如果您的订单尚未向与会者询问他们的地址信息，则无法从与会者列表中获取。

目前，无法从 API 自定义订单。

# java - 正则表达式 javax.servlet.Filter 与 Tuckey 的 UrlRewriteFilter

> ID：13962216
> 
> 赞同：2
> 
> 时间：2012-12-19T22:19:05.337
> 
> 标签：java, web-applications, servlet-filters, tuckey-urlrewrite-filter

Tuckey 的 UrlRewriteFilter (http://tukey.org/urlrewrite/) 可以通过额外的 javax.servlet.Filter 过滤请求吗？

真正的问题是 web.xml 的过滤器映射不允许正则表达式。我创建了自己的 RegexFilter，但想知道 Tuckey 的 UrlRewriteFilter 是否可以代替。把所有东西都放在一个地方就好了。

例如，如果我可以在 urlrewrite.xml 中添加类似这样的内容，那就太好了：

```
<filter>
    <url-pattern>^/news/([0-9]+)$</url-pattern>
    <filter-class>com.foo.bar.NewsFilter</filter-class>
</filter> 
```

# r - 如何指定图形以着色特定点？

> ID：13962221
> 
> 赞同：1
> 
> 时间：2012-12-19T22:19:47.593
> 
> 标签：r, colors, plot, rgl

我正在使用 R 中的**rgl**包在 3d 中绘制一个矩阵，并且想知道如何为两个重要组的点着色。我知道我试图用颜色识别的矩阵的行号。

```
plot3d(my3colmatrix) 
```

A组要突出显示的`288, 482, 621, 1304` 点是行：B组的点是行：`503, 727, 764, 904, 1412 1480, 1555`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:17:09.543

通常，R 中的绘图函数有一个“col”参数，它可以作为颜色向量给出，每行一个。

如果您定义 mycol（我的颜色）：

```
mycol <- rep("black", nrow) # where nrow is the number or rows
mycol[c(288, 482, 621, 1304)] <- "blue"
mycol[c(503, 727, 764, 904, 1412 1480, 1555)] <- "red" 
```

您可以使用 col 参数 col=mycol 突出显示要以不同颜色显示的点。

# c# - 有条件地转义特殊的 xml 字符

> ID：13962225
> 
> 赞同：6
> 
> 时间：2012-12-19T22:20:08.343
> 
> 标签：c#, xml, escaping, entityreference

我环顾四周，但找不到一个只能转义特殊 XML 字符的内置 .Net 方法： `<`, `>`, `&`, 如果它不是标签。`'``"`

例如，采用以下文本：

```
Test& <b>bold</b> <i>italic</i> <<Tag index="0" /> 
```

我希望将其转换为：

```
Test&amp; <b>bold</b> <i>italic</i> &lt;<Tag index="0" /> 
```

请注意，标签没有转义。我基本上需要将此值设置为 an `InnerXML`，`XmlElement`因此，必须保留这些标签。

我已经研究过实现我自己的解析器并`StringBuilder`尽可能地使用它来优化它，但它会变得非常讨厌。

我也知道可以接受的可以简化事情的标签（仅：br，b，i，u，blink，flash，Tag）。此外，这些标签可以是自闭合标签

```
(e.g. <u />) 
```

或容器标签

```
(e.g. <u>...</u>) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:54:21.773

*注意：这可能会被优化。这只是我为你快速敲门的东西。另请注意，我没有对标签本身进行任何验证。它只是在寻找包含在尖括号中的内容。`<sometag label="I put an > here">`如果在标签中找到尖括号（例如），它也会失败 。除此之外，我认为它应该做你所要求的。*

```
namespace ConsoleApplication1
{
    using System;
    using System.Text.RegularExpressions;

    class Program
    {
        static void Main(string[] args)
        {
            // This is the test string.
            const string testString = "Test& <b>bold</b> <i>italic</i> <<Tag index=\"0\" />";

            // Do a regular expression search and replace. We're looking for a complete tag (which will be ignored) or
            // a character that needs escaping.
            string result = Regex.Replace(testString, @"(?'Tag'\<{1}[^\>\<]*[\>]{1})|(?'Ampy'\&[A-Za-z0-9]+;)|(?'Special'[\<\>\""\'\&])", (match) =>
                {
                    // If a special (escapable) character was found, replace it.
                    if (match.Groups["Special"].Success)
                    {
                        switch (match.Groups["Special"].Value)
                        {
                            case "<":
                                return "&lt;";
                            case ">":
                                return "&gt;";
                            case "\"":
                                return "&quot;";
                            case "\'":
                                return "&apos;";
                            case "&":
                                return "&amp;";
                            default:
                                return match.Groups["Special"].Value;
                        }
                    }

                    // Otherwise, just return what was found.
                    return match.Value;
                });

            // Show the result.
            Console.WriteLine("Test String: " + testString);
            Console.WriteLine("Result     : " + result);
            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:40:37.143

我个人认为这是不可能的，因为您确实在尝试修复格式错误的 HTML，因此您无法使用任何规则来确定要编码的内容和不编码的内容。

无论您以何种方式看待它，`<<Tag index="0" />`都不是有效的 HTML。

如果您知道实际的标签，您可以创建一个可以简化事情的白名单，但是您将不得不更具体地解决您的问题，我认为您无法在任何情况下解决这个问题。

实际上，您的文本中实际上可能没有任何随机`<`或`>`乱七八糟的东西，这（可能）会大大简化问题，但是如果您真的想提出一个通用的解决方案....我希望你运气。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T23:19:21.623

这是一个您可以使用的正则表达式，它将匹配任何无效的`<`或`>`.

```
(\<(?! ?/?(?:b|i|br|u|blink|flash|Tag[^>]*))|(?<! ?/?(?:b|i|br|u|blink|flash|Tag[^>]*))\>) 
```

我建议将有效的标记测试表达式放入一个变量中，然后围绕它构建其余部分。

```
var validTags = "b|i|br|u|blink|flash|Tag[^>]*";
var startTag = @"\<(?! ?/?(?:" + validTags + "))";
var endTag = @"(?<! ?/?(?:" + validTags + "))/>"; 
```

然后就做`RegEx.Replace`这些。

# css - 如何在 QT 中为元素添加框阴影？

> ID：13962228
> 
> 赞同：2
> 
> 时间：2012-12-19T22:20:23.677
> 
> 标签：css, qt, user-interface

我试着做：`this->setStyleSheet("-webkit-box-shadow: 0px 0px 20px rgba(0, 0, 0, 1);")`我得到了错误：`Unknown property -webkit-box-shadow`。`box-shadow`和也是如此`-moz-box-shadow`。然而，Box-shadow 在 QWebView 中渲染得很好。有没有办法将这种效果添加到普通元素中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T22:37:07.460

查看 QFrame 的文档。有一个框架阴影属性。

[http://doc.qt.io/qt-5/qframe.html#Shadow-enum](http://doc.qt.io/qt-5/qframe.html#Shadow-enum)

# ruby - 将python字典转换为ruby数据结构

> ID：13962233
> 
> 赞同：0
> 
> 时间：2012-12-19T22:20:49.640
> 
> 标签：ruby, hash

我有一个算法，可以在 python 中存储 n x m 字符矩阵的坐标。例如

```
a b 
c d 
```

将存储为坐标字符对列表：

```
(0, 0) a    (0, 1) b   
(1, 0) c    (1, 1) d 
```

我的python代码如下

```
def init_coordination(self):

    list_copy = self.list[:]
    row = 0
    column = 0
    coordination = {}

    for char in list copy

        if column >= self.column:
            row += 1
            column = 0

        coordination[char] = (row, column)
        column += 1

    return coordination 
```

我正在尝试在 ruby​​ 中实现这个算法，我猜想在 ruby​​ 中最接近字典的数据结构是哈希。我需要一些关于以下 ruby​​ 代码的建议：

```
def self.init_coordination
    position = Hash.new("Coordination of char")
    row = 0
    column = 0
    @list.each do |char|
        if column < @column
            position[row, column] = char
            column = column + 1
        elsif column == @column
            column = 0
            row = row + 1
        elsif row == @row
            puts position
        end
    end 
```

另外，我将如何用 ruby​​ 表示一个列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:26:35.447

Ruby 中的列表称为[数组](http://www.ruby-doc.org/core-1.9.3/Array.html)。

```
arr = []
arr.push(0) # => [0]
arr.concat([1,2,3]) # => [0, 1, 2, 3]
arr2d = [[0,0],[0,1],[1,0],[1,1]] 
```

还有一种[Matrix 类型](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/matrix/rdoc/Matrix.html)可能更有效，并且可能有更多感兴趣的操作。

```
require 'matrix'
matrix = Matrix[[0,0],[0,1],[1,0],[1,1]]
matrix[0,0] # => 0 
```

# gdb - GDB 在 Popf 之后设置陷阱标志（可能的错误？）

> ID：13962237
> 
> 赞同：1
> 
> 时间：2012-12-19T22:21:33.683
> 
> 标签：gdb

看一看：

```
 (gdb) x/x $esp
       0xb720a621:  0x00000000
    (gdb) info register eflags
       eflags         0x200286  [ PF SF IF ID ]
    (gdb) x/5i $pc
    => 0x15a965d <tables+11901>:    popf   
       0x15a965e <tables+11902>:    mov    $0xd7fb0aa3,%ecx
       0x15a9663 <tables+11907>:    ret    $0x849d
       0x15a9666 <tables+11910>:    xor    (%ebx),%esi
       0x15a9668 <tables+11912>:    aam    $0x78
    (gdb) stepi
       0x015a965e in tables () from /usr/local/apache2/modules/libphp5.so
    (gdb) info register eflags
       eflags         0x202 [ IF ]
    (gdb) stepi
       0x015a9663 in tables () from /usr/local/apache2/modules/libphp5.so
    (gdb) info register eflags
       eflags         0x302 [ TF IF ] 
```

不确定为什么在下一条指令后设置 TF。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T15:02:59.200

我相信这是一个内核错误。`TF`单步时内核必须设置，但用户模式也可能正在修改`TF`。为了处理这个问题，内核尝试维护 who set `TF`：

```
 /* Set TF on the kernel stack.. */
    regs->flags |= X86_EFLAGS_TF;

    /*
     * ..but if TF is changed by the instruction we will trace,
     * don't mark it as being "us" that set it, so that we
     * won't clear it by hand later.
     *
     * Note that if we don't actually execute the popf because
     * of a signal arriving right now or suchlike, we will lose
     * track of the fact that it really was "us" that set it.
     */
    if (is_setting_trap_flag(child, regs)) {
            clear_tsk_thread_flag(child, TIF_FORCED_TF);
            return 0;
    } 
```

请注意，它甚至承认某些极端情况可能会使其迷失方向。更糟糕的是，`is_setting_trap_flag`它只检查指令是否会修改`TF`，而不检查它是否真的在设置它：

```
 switch (opcode[i]) {
    /* popf and iret */
    case 0x9d: case 0xcf:
            return 1; 
```

因此，`TF`即使它已被清除，它也会标记为用户设置。如果它是由内核设置的`get_flags`，它将尝试屏蔽`TF`如下：

```
 /*
     * If the debugger set TF, hide it from the readout.
     */
    if (test_tsk_thread_flag(task, TIF_FORCED_TF))
            retval &= ~X86_EFLAGS_TF; 
```

由于`TIF_FORCED_TF`已被错误地清除，此条件将不成立，因此`TF`实际上已由内核为单步执行设置的值将返回给调试器。

我认为这可以通过修改来解决，`is_setting_trap_flag`以便它检查堆栈中标志的新值，并且仅在实际设置`1`时才返回。`TF`

# html - 联系表单实际上没有创建提交按钮？我怎样才能解决这个问题？

> ID：13962238
> 
> 赞同：-5
> 
> 时间：2012-12-19T22:21:40.323
> 
> 标签：html

```
<div align="center">
    <fieldset>
        <form action="contact_submit.php" method="post">
            <i>Questions or comments? Would like to see new things on the site? Email any suggestions or concerns to the site administrator and you'll get a reply as soon as possible!</i><br/>
            <br/>
            Your Name
            <input type="text" name="cf_name">
            <br/>
            Your Email Address
            <input type="text" name="cf_email">
            <br/>
            Message
            <textarea name="cf_message">
            <br/>
            <input type="submit" value="Send">
            <br/>
            <input type="reset" value="Clear">
            <br/>
        </form>
    </fieldset>
</div> 
```

不知道如何解决？非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:24:52.830

你还没有关闭 textarea 标签

```
<textarea name="cf_message"></textarea> 
```

大概就这么简单吧！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:25:07.380

你没有关闭你的`<textarea>`

```
<textarea name="cf_message"></textarea>
----------------------------^^^^^^^^^^^ 
```

# ios - CoreData JSON 映射

> ID：13962239
> 
> 赞同：0
> 
> 时间：2012-12-19T22:21:56.693
> 
> 标签：ios, json, core-data, mapping

在我的 api 中，我有一个这样的 JSON 输出；

```
{
"restaurants": [{
    "Restaurant": {
        "id": "3",
        "name": "...",
        "slug": "...",
        "phone": "2161234567",
        "address": "...",
        "city_id": "34",
        "county_id": "426",
        "discount_type_id": null,
        "discount": "",
        "people_limit": "2",
        "reservations_required": false,
        "lat": "41.015608",
        "lon": "28.934834",
        "about": "...",
        "logo": "...",
        "logo_dir": "3",
        "photo_1": "...",
        "photo_2": null,
        "photo_3": null,
        "photo_dir": "3",
        "created": "2012-11-30 16:30:21",
        "modified": "2012-11-30 20:43:50",
        "deleted": true
    },
    "AvailabilityRestriction": [{
        "id": "1",
        "title": "...",
        "AvailabilityRestrictionRestaurant": {
            "id": "28",
            "restaurant_id": "3",
            "availability_restriction_id": "1"
        }
    }],
    "CuisineTag": [{
        "id": "3",
        "name": "...",
        "CuisineTagRestaurant": {
            "id": "47",
            "restaurant_id": "3",
            "cuisine_tag_id": "3"
        }
    }]
},

...
} 
```

餐厅有许多美食标签和可用性限制。还有一个城市表......同步它们的最佳方式是什么？

我必须先同步城市、美食标签和可用性限制，然后在创建餐厅时我会匹配它们？这是正确的方法吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:51:24.673

我会这样做......

您应该在餐厅对象中拥有所有“餐厅”属性（即限制、美食标签）。

这是一个例子：

```
{
    "Restaurants" : [
        { 
            "id" : "3",
            "name" : "...",
            "slug" : "...",
            "phone" : "2161234567",
            "address" : "...",
            "city_id" : "34",
            "county_id" : "426",
            "discount_type_id" : null,
            "discount" : "",
            "people_limit" : "2",
            "reservations_required" : false,
            "lat" : "41.015608",
            "lon" : "28.934834",
            "about" : "...",
            "logo" : "...",
            "logo_dir" : "3",
            "photo_1" : "...",
            "photo_2" : null,
            "photo_3" : null,
            "photo_dir" : "3",
            "created" : "2012-11-30 16:30:21",
            "modified" : "2012-11-30 20:43:50",
            "deleted" : true,
            "AvailabilityRestrictions" : [
                {
                    "id" : "1",
                    "title" : "..."
                },
                {
                    "id" : "2",
                    "title" : "..."
                }
            ],
            "CuisineTags" : [
                {
                    "id" : "3",
                    "name" : "..."
                }
            ]
        }
    ]
} 
```

也摆脱“餐厅”对象，它是不需要的。如果我有一个名为“餐厅”的数组。我只想在其中/从其中放置/获取餐厅。

我认为您的问题更多，但我无法理解您的需求。您是在谈论如何在 Core Data 中建立它们之间的关系吗？

如果您希望设置 cruisine 标签和城市之间的关系，或者我认为这是最好的方法，因为您可以遍历 JSON 响应，并且如果其中一个属性是列表，您可以确定列表并获取正确的托管对象并创建关系。

为了清楚起见，您应该将这些城市、预定义的巡航标签保留在不同的请求中。您希望保持 API 简单灵活。

# castle-windsor - 在 DAL 中将 log4net 与 Castle Windsor 一起使用

> ID：13962240
> 
> 赞同：3
> 
> 时间：2012-12-19T22:22:06.927
> 
> 标签：castle-windsor, log4net

我有一个图书馆，里面有我的 DAL。在其中，我使用 CastleWindsor 并配置了日志记录。

DAL 由 WCF 服务使用。在 WCF 服务中，我有 log4net.config：

```
<log4net>
    <appender name="AdoNetAppender" type="log4net.Appender.AdoNetAppender">
        <bufferSize value="100" />
        <connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
        <connectionString value="data source=MYMACHINE\SQLEXPRESS;initial catalog=GEMS;integrated security=true;persist security info=True" />
        <commandText value="INSERT INTO Application_Log ([Date],[Thread],[Level],[Logger],[Message],[Exception]) VALUES (@log_date, @thread, @log_level, @logger, @message, @exception)" />
        <parameter>
            <parameterName value="@log_date" />
            <dbType value="DateTime" />
            <layout type="log4net.Layout.RawTimeStampLayout" />
        </parameter>
        <parameter>
            <parameterName value="@thread" />
            <dbType value="String" />
            <size value="255" />
            <layout type="log4net.Layout.PatternLayout">
                <conversionPattern value="%thread" />
            </layout>
        </parameter>
        <parameter>
            <parameterName value="@log_level" />
            <dbType value="String" />
            <size value="50" />
            <layout type="log4net.Layout.PatternLayout">
                <conversionPattern value="%level" />
            </layout>
        </parameter>
        <parameter>
            <parameterName value="@logger" />
            <dbType value="String" />
            <size value="255" />
            <layout type="log4net.Layout.PatternLayout">
                <conversionPattern value="%logger" />
            </layout>
        </parameter>
        <parameter>
            <parameterName value="@message" />
            <dbType value="String" />
            <size value="4000" />
            <layout type="log4net.Layout.PatternLayout">
                <conversionPattern value="%message" />
            </layout>
        </parameter>
        <parameter>
            <parameterName value="@exception" />
            <dbType value="String" />
            <size value="2000" />
            <layout type="log4net.Layout.ExceptionLayout" />
        </parameter>
    </appender>
    <root>
        <level value="INFO" />
        <appender-ref ref="AdoNetAppender" />
    </root>
</log4net> 
```

我实际上在使用 WCF 服务的应用程序中使用了这个确切的配置文件，它工作得很好（使用 Castle Windsor w/Log4net），所以我很确定它没问题。log4net.config 文件位于 WCF 项目的根目录中，并部署到 IIS 中 WCF 服务的根目录中。

在我的 DAL 中，我有一个 LoggerInstaller：

```
public class LoggerInstaller : IWindsorInstaller
{
    public void Install(IWindsorContainer container, IConfigurationStore store)
    {
        container.AddFacility<LoggingFacility>(f => f.UseLog4Net());
    }
} 
```

在一个示例类中，我只是有一个属性：

```
public ILogger Logger { get; set; } 
```

Castle 将 Logger 的值设置为有效的记录器，但除了使用 WCF 服务的主应用程序之外，没有任何内容被记录到数据库中。

我不知道我搞砸了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T14:28:55.080

也许尝试指定您的配置文件：

```
f => f.UseLog4Net(AppDomain.CurrentDomain.SetupInformation.ConfigurationFile) 
```

# microcontroller - 将 Atmega8 的定时器代码实现到 Atmega16

> ID：13962256
> 
> 赞同：0
> 
> 时间：2012-12-19T22:23:32.100
> 
> 标签：microcontroller, code-conversion, atmega, winavr, atmega16

此代码片段是为 Atmega8 编写的，取自[使用 Atmega8 的 clapper 电路](http://www.electronics-lab.com/projects/mcu/020/index.html)。任何人都可以将这个代码片段转换为 Atmega16 并稍加解释。因为我正在尝试为 Atmega16 实现相同的功能并且在计时器部分遇到了一些问题。

```
#define BURST_TIME  70
#define READY_TIME  150
#define TIME_OUT    300

void timer_init()
{
    TIFR |= (1<<TOV0);      
    //set interrupt on overflow
    TIMSK |= (1<<TOIE0);
    TCNT0 = 223;
}

ISR (TIMER0_OVF_vect)
{       
    TCNT0 = 223;
    timer++;

    if (timer == BURST_TIME)
    {
        burst = 1;
        ready = 0;
    } else if (timer == READY_TIME)
    {
        burst = 0;
        ready = 1;
    } else if (timer == TIME_OUT)
    {
        timer = 0;
        burst = 0;
        ready = 0;
        first = 0;
        stop_timer();
    }
}

void start_timer()
{
    TCCR0 |= (1<<CS02);
}

void stop_timer()
{
    TCCR0 &= ~(1<<CS02);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-05T02:49:10.877

尝试使用芯片的 Atmel 数据表并比较定时器寄存器，您会找到所需的一切

Atmega8： http: [//www.atmel.com/images/doc2486.pdf](http://www.atmel.com/images/doc2486.pdf) 有用：注册摘要第 280 页

Atmega16： http: [//www.atmel.com/Images/doc2466.pdf](http://www.atmel.com/Images/doc2466.pdf) 有用：注册摘要第 331 页

您想使用定时器 0，那是一个 8 位定时器（Atmega16 上的第 71 页）

现在让我们试着分析一下代码

```
TIFR |= (1<<TOV0); // TIFR Thats the Timer/Counter0 Interrupt Flag Register
                   // TOV0: Timer/Counter0 Overflow Flag
                   // The bit TOV0 is set when an overflow occurs in Timer/Counter0.
                   // Datasheet page: 86

TIMSK |= (1<<TOIE0);  // Timer/Counter Interrupt Mask Register
                      // TOIE0: Timer/Counter0 Overflow Interrupt Enable
                      // When the TOIE0 bit is written to one, and the I-bit in the `status Register is set, the
                      // Timer/Counter0 Overflow interrupt is enabled

TCNT0 = 223; // TCNT0:  0 to 255 or 0x00 to 0xFF
             // with each clock it increases by 1
             // when the register hits 255, a Timer-Overflow is triggerd (ISR...)
             // The flag can be queried or used to trigger an interrupt.
             // Datasheet Page 85

TCCR0 |= (1<<CS02); // TCCR0: Timer/Counter Control Register
                    // CS02: Bit 2:0 – CS02:0: Clock Select
                    // This means that your running the Timer with a                               
                    // Prescaler of 256 (CPU frequency / 256)
                    // This line starts the Timer!
                    // Datasheet Page: 85

ISR (TIMER0_OVF_vect) // will be executed when a overflow is triggerd
{ 
    // Do something
    // Keep the execution time short in this section
} 
```

# ruby-on-rails-3 - 模型中默认范围内的参数

> ID：13962261
> 
> 赞同：3
> 
> 时间：2012-12-19T22:23:55.110
> 
> 标签：ruby-on-rails-3, devise

我正在使用 Devise 对用户进行身份验证。我需要根据我所有表中的 global_location_id 列显示/隐藏数据。当前 global_location_id 的值将来自 current_user.global_location_id。我尝试将以下默认范围添加到我的一个模型中：

```
class Artifact < ActiveRecord::Base
default_scope where(:global_location_id => current_user.global_location_id) 
```

但它给出了以下错误：

```
undefined local variable or method `current_user' for #<Class:0x8721840> 
```

为了规避 current_user 在模型中的不可用性，我在我的应用程序控制器中添加了以下内容

```
class ApplicationController < ActionController::Base
   def set_global_location_id
    @global_location_id = current_user.global_location_id
   end 
```

并从我的控制器调用该方法

```
class ArtifactsController < ApplicationController
   #Check to see if the user is logged in first
   before_filter :authenticate_user!
   before_filter :set_global_location_id 
```

更改模型中的默认范围以添加 @global_location_id

```
class Artifact < ActiveRecord::Base
  default_scope where(:global_location_id => @global_location_id) 
```

但这也不起作用。@global_location_id 已在应用程序控制器中正确设置。但它在模型中是空的。如何使它工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T02:03:07.850

不幸的是，您将无法与模型实例共享控制器中设置的实例变量（没有一些线程黑客）。这实际上是一件好事，因为否则它会像一个全局变量一样，这会给你带来更多的伤害而不是好处。

我实际上很难理解你为什么要这样做，因为它会在当前登录用户的状态和你的模型之间增加一些令人讨厌的耦合。如果您尝试在控制台中查找 Artifact，则 current_user 不存在，并且该实例变量将不可用，因此您会遇到一些严重的问题。

这是你退后一步，问问自己你真正想要做什么的时候。是否有任何理由需要根据当前用户的 global_location_id 隐式创建 default_scope？您可以只创建一个常规范围并在您的控制器中使用它吗？

```
class Artifact < ActiveRecord::Base
  scope :by_global_location_id, lambda {|id| where(:global_location_id => id) }
end

class ArtifactsController < ApplicationController
  def index
    @artifacts = Artifact.by_global_location_id(current_user.global_location_id)
  end
end 
```

这种方法的一个好处是阅读您的代码的人不必花费大量时间来跟踪 default_scope 是如何工作的。

# containers - 将 unique_ptr 与矢量和地图一起使用

> ID：13962262
> 
> 赞同：0
> 
> 时间：2012-12-19T22:23:57.333
> 
> 标签：containers, unique-ptr

我有一个名为 Info 的课程。

我尝试创建一个 unique_ptr 向量来保存此类的列表。

该映射包含作为字符串的键和作为值的 unique_ptr。

但是当我尝试从地图中检索值并尝试将其放入向量中以形成列表时，VS2010 编译器会给出错误：错误 C2664: 'void std::vector<_Ty>::push_back(_Ty &&)' ：无法将参数 1 从 'std::vector<_Ty>' 转换为 'std::unique_ptr<_Ty> &&'

```
vector<unique_ptr<Info>> sInfo;
QMap<QString,vector<unique_ptr<Info>>>::Iterator iterMap;
for(iterMap = map_sInfo.begin(); iterMap != map_sInfo.end(); ++iterMap)
{
    vector<unique_ptr<Info>>sValue = iterMap.value();
    sInfo.push_back((sValue)); //error C2664
} 
```

我如何提供有关此方面的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:40:10.310

正如错误消息所暗示的那样，您正在尝试推回整个 sValue 容器（这是 a`vector<unique_ptr<Info>>`而不是 a `unique_ptr<Info>`。正如您刚刚注意到的那样，这不太顺利。

你有几个选择。`sValue`首先，您可以遍历`push_back`每个元素的内容。其次，您可以使用 std::copy 在一个语句中添加元素：

```
std::copy(sValue.begin(), sValue.end(), std::back_inserter(sInfo); 
```

第三种选择是使用 std::vector 的`insert`函数一次性添加整个容器：

```
sInfo.insert(sInfo.end(), sValue.begin(), sValue.end()); 
```

# php - 创建 PDO 查询时参数中的数组

> ID：13962266
> 
> 赞同：3
> 
> 时间：2012-12-19T22:24:15.907
> 
> 标签：php, mysql, sql, pdo

我可以在参数
示例中使用几行吗

```
SELECT id, city_id FROM an_objects WHERE city_id IN (:arrCity) 
```

**(:arrCity) (1,2,3,4,5,6)**

但现在我已经这样做了

```
SELECT id, city_id FROM an_objects WHERE city_id IN (:1p, :2p, :3p, ...... :100p) 
```

而且非常糟糕

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:27:29.140

```
<?php

private function PDOBindArray(&$poStatement, &$paArray){ 
    foreach ($paArray as $k=>$v) {
        @$poStatement->bindValue($k, $v[0], $v[1]);
    }      
}

// the array structure should now look something like this

$inputArray = array(
    ':arrcity' => array($email, PDO::PARAM_STR), 
    ':another_variable' => array($pass, PDO::PARAM_INT)
);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T06:27:23.553

在这种情况下如何成为查询？

```
WHERE city_id IN (:1p, :2p, :3p, ...... :100p) 
```

在查询100个参数
这个方法中，例如我们只有5个参数

```
private function PDOBindArray(&$poStatement, &$paArray){ 
    foreach ($paArray as $k=>$v) {
        @$poStatement->bindValue($k, $v[0], $v[1]);
    }      
} 
```

# java - EasyMock 如何设置服务更新实例的状态？

> ID：13962267
> 
> 赞同：0
> 
> 时间：2012-12-19T22:24:17.577
> 
> 标签：java, unit-testing, easymock

我有一个如下所示的客户端类：

```
class MyClient{
    Service service;

    public MyClient(Service service){ ... }

    public boolean CoreFunction(Object arg1, Object arg2){
        Service.AnotherClass instance = new Service.AnotherClass(arg1, arg2);
        service.call(instance);
        if(instance.isSuccessful()) { ...; return true; }
        else { ...; return false; }
    }
} 
```

实例的 isSuccessful() 返回一个标志，该标志将由 service.call() 内部更新。如果 instance.isSuccessful() 是真假，我想测试逻辑。如何使用 EasyMock 来实现这一点？谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:48:20.273

您可以使用`IAnswer`拦截`service`呼叫并设置`successful`您的属性`instance`：

```
Service service = EasyMock.createMock(Service.class);

// andAnswer style
service.call(anyObject(Service.AnotherClass.class));
expectLastCall().andAnswer(new IAnswer<Object>() {
    public Object answer() throws Throwable {
        Service.AnotherClass arg = (Service.AnotherClass) EasyMock.getCurrentArguments()[0];
        arg.setSuccessful(true); // or false in another test
        return null;
    }
}); 
```

# android - Fragment、ImageLoader、Viewpager 和最后内存不足异常

> ID：13962274
> 
> 赞同：2
> 
> 时间：2012-12-19T22:24:54.940
> 
> 标签：android, android-viewpager, fragment, out-of-memory

我使用片段，它有一个viewpager。我将使用 ImageLoader 的图像放到 viewpager 中。如果我调用这个片段大约 10-15 次（它在选项卡上），我会看到内存不足异常。之后，图像无法在 viewpager 中显示。

这是我的代码。

```
 @Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {

    if (view == null) {
        view = inflater.inflate(R.layout.gununurunu_fragment, container,
                false);
    }
    shareSubject = getResources().getString(R.string.share_title);

    viewpager = (ViewPager) view.findViewById(R.id.starviewpager);
    viewpager.setOnPageChangeListener(new OnPageChangeListener() {

        @Override
        public void onPageSelected(int selected) {
            setPagerIndicator(viewpagerItemSize, selected);

        }

        @Override
        public void onPageScrolled(int arg0, float arg1, int arg2) {

        }

        @Override
        public void onPageScrollStateChanged(int arg0) {

        }
    });

    fillContents();

    return view;
}

private void fillContents(){
    lst = parser.lstProductOfDay;
                    ViewPagerAdapter adap = new ViewPagerAdapter(
                            getActivity(), lst);
                    viewpager.setAdapter(adap);
}

public class ViewPagerAdapter extends PagerAdapter {

    private final Context context;
    ArrayList<ProductOfDay> lstProductOfDay;

    public ViewPagerAdapter(Context context) {
        this.context = context;
    }

    public ViewPagerAdapter(Context context,
            ArrayList<ProductOfDay> lstProductOfDay) {
        this.context = context;
        this.lstProductOfDay = lstProductOfDay;
    }

    @Override
    public int getCount() {

        viewpagerItemSize = lstProductOfDay.size();
        return lstProductOfDay.size();
    }

    @Override
    public Object instantiateItem(View pager, int position) {

        ImageView img = new ImageView(context);
        img.setLayoutParams(new LayoutParams(
                ViewGroup.LayoutParams.WRAP_CONTENT,
                LayoutParams.WRAP_CONTENT));

        ImageLoader imgLoader = new ImageLoader(getActivity());
        String imageUrl = ApiAddress.getInstance().hostName
                + lstProductOfDay.get(position).getImage().getImageUri();
        imgLoader.DisplayImage(imageUrl, img);
        ((ViewPager) pager).addView(img, 0);

        return img;
    }

    @Override
    public void destroyItem(View pager, int position, Object view) {
        ((ViewPager) pager).removeView((ImageView) view);
    }

    @Override
    public boolean isViewFromObject(View view, Object object) {
        return view.equals(object);
    }

}

    // decodes image and scales it to reduce memory consumption
private Bitmap decodeFile(File f) {
    try {
        // decode image size
        BitmapFactory.Options o = new BitmapFactory.Options();
        o.inJustDecodeBounds = true;
        BitmapFactory.decodeStream(new FileInputStream(f), null, o);

        // Find the correct scale value. It should be the power of 2.
        //final int REQUIRED_SIZE = 98;
        //int width_tmp = o.outWidth, height_tmp = o.outHeight;
        int scale = 1;
        //while (true) {
        //  if (width_tmp / 2 < REQUIRED_SIZE
        //          || height_tmp / 2 < REQUIRED_SIZE)
        //      break;
        //  width_tmp /= 2;
        //  height_tmp /= 2;
        //  scale *= 2;
        //}

        // decode with inSampleSize
        BitmapFactory.Options o2 = new BitmapFactory.Options();
        o2.inSampleSize = scale;
        return BitmapFactory.decodeStream(new FileInputStream(f), null, o2);
    } catch (FileNotFoundException e) {
    }
    return null;
} 
```

**编辑：**

**从 ImageLoader getBitmap 函数解决的问题**

```
private Bitmap getBitmap(String url) {
    File f = fileCache.getFile(url);

    // from SD cache
    Bitmap b = decodeFile(f);
    if (b != null)
        return b;

    // from web
    try {
        Bitmap bitmap = null;
        URL imageUrl = new URL(url);
        HttpURLConnection conn = (HttpURLConnection) imageUrl
                .openConnection();
        conn.setConnectTimeout(30000);
        conn.setReadTimeout(30000);
        conn.setInstanceFollowRedirects(true);
        InputStream is = conn.getInputStream();
        OutputStream os = new FileOutputStream(f);
        Utils.CopyStream(is, os);
        os.close();
        bitmap = decodeFile(f);
        return bitmap;
    } catch (Throwable ex) {
        ex.printStackTrace();
        if (ex instanceof OutOfMemoryError)
            memoryCache.clear();
        return null;
    }
} 
```

# vb.net - VB - DTSLib.DTSExecResult - 编译错误 - Visual Basic 不支持自动化类型

> ID：13962277
> 
> 赞同：0
> 
> 时间：2012-12-19T22:25:02.350
> 
> 标签：vb.net, ssis, compiler-errors

```
Dim pkg As DTSLib.Package
Dim pkgResult As DTSLib.DTSExecResult 
```

此行（行：2）引发编译错误“Visual Basic 中不支持自动化类型”我正在尝试使用 pkgResult 来捕获在服务器上运行 dtsx 的结果

```
Set pkg = app.LoadFromDtsServer("\MSDB\", Server, True, pevents)
pkgResults = pkg.Execute() 
```

请注意：我添加了对“Microsoft DTS Runtime 1.0”的引用

VB 不支持类型 DTSLib.DTSExecResult 吗？

感谢您的帮助和时间。谢谢

# javascript - IE7/8 不显示 Fineuploader 按钮

> ID：13962283
> 
> 赞同：0
> 
> 时间：2012-12-19T22:25:36.243
> 
> 标签：javascript, css, internet-explorer-8, internet-explorer-7, fine-uploader

使用名为 Fineloader 的 JavaScript 插件来上传文件。我的代码如下，[现场演示位于此处](http://tapmeister.com/test/fineuploader-3.1/index.html)。出于某种原因，按钮和输入不显示使用 IE7 和我的笔记本电脑使用 IE8，但显示使用我的虚拟机和 IE8 以及 IE9/FF/等。任何使它可见的帮助将不胜感激。

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Fine Uploader - Basic</title>
    </head>
    <style>
        #upload-block {width: 280px;}
        button.gray {
            border:1px solid black;
            color: black;
            height: 25px;
        }
    </style>
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="fineuploader-3.1.js"></script>
    <script>
        $(document).ready(function() {
            var uploader = new qq.FineUploaderBasic({button: document.getElementById('uploader')});
        });
    </script>

    <body>
        <div>
            <label>FILE:</label>
            <div id="upload-block">
                <div id="uploader">
                    <input type="text" readonly id="myFilename">
                    <button class="gray">BROWSE</button>
                </div>
            </div>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T03:49:02.247

您的上传按钮有点奇怪。为什么要提供一个已经有文本输入的 div 以及一个按钮元素作为子元素？你知道吗？好的上传器还会添加一个文件输入元素作为按钮的子元素（在本例中为#uploader）？

我建议您将文本输入移到其他地方，尽管我不能肯定它会给您带来问题，因为在我看来一切都很好。虽然，我没有真正的 IE8 副本（我使用的是兼容模式，就像这里的其他海报一样）。

我建议您将上传按钮选项元素修改为如下所示：

```
<div id="uploader">
   <div>BROWSE</div>
</div> 
```

并将您的文本输入放在其他地方，也许作为#uploader 的兄弟。

另外，不要为您的上传者“按钮”使用按钮元素。IE 中的事件委托问题将阻止输入子项（由 Fine Uploader 添加）接收单击事件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T16:56:28.433

我正在使用fineuploader 3.3，但我相信这是同样的问题。实际上，它与您的代码无关，但精细上传器代码中的一个小错误 - 按钮在那里，它只是不可见:)，它可以被点击（在“文件”标签下方）

找到文件 util.js 和行

```
/**
 * Sets styles for an element.
 * Fixes opacity in IE6-8.
 */
css: function(styles) {
    if (styles.opacity !== null){
        if (typeof element.style.opacity !== 'string' && typeof(element.filters) !== 'undefined'){ 
```

并更改为

```
/**
 * Sets styles for an element.
 * Fixes opacity in IE6-8.
 */
css: function(styles) {
    if ((styles.opacity !== null) && (typeof styles.opacity !== 'undefined')) {
        if (typeof element.style.opacity !== 'string' && typeof(element.filters) !== 'undefined'){ 
```

（只有第一个 IF 是变化，其余代码在这里更容易找到）

在您的fineuploader-3.1.js 中，它有点难以找到，它位于文件开头的某个位置，只需小心更改IF 代码即可。

# java - 使用 JMS 调用 Tibco Web 服务

> ID：13962286
> 
> 赞同：-1
> 
> 时间：2012-12-19T22:25:49.283
> 
> 标签：java, web-services, jms, tibco

我在 tibco 中创建并部署了一个使用 JMS 连接的 Web 服务，

我想获得一个 java 类来连接到 tibco ems 服务器并使用 JMS 与该服务进行通信。

那可能吗 ？我将如何进行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:10:13.600

是的。有可能...您需要在此处提供有关用例和您正在使用的工具的更多信息，但您所要做的就是使用 JMS 请求 - 回复客户端侦听您从接收消息的队列/主题网络服务。请求/回复 JMS 模式的本质是使用消息，处理它，然后用响应回复。这对于 TIBCO BusinessWorks 来说非常简单。查看示例文件夹，因为它包含许多可用作起点的预定义示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T08:42:20.043

如果我理解正确，您想要做的是通过 JMS 调用 SOAP 服务。

这在 Java 中是可能的，并且已经在[此处](http://www.eaipatterns.com/RequestReplyJmsExample.html)进行了一般性讨论。将数据更改为具有 SOAP 请求，您就会得到答案。

您还可以通过 Google 搜索找到多个示例，说明如何做到这一点（请求回复 jms）。如果您想要 EMS 的示例，请将上述内容与 TIBCO 已经提供的示例相结合。

[TIBCO EMS 提供了请求回复](https://docs.tibco.com/pub/enterprise_message_service/6.0.1_january_2011/html/tib_ems_api_reference/api/javadoc/index.html?javax/jms/QueueRequestor.html)的示例。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-19T23:37:05.347

当您说“使用 JMS 与该 Web 服务通信”时，您有点迷失了方向。

通常，您通过 HTTP 协议与 Web 服务进行通信。JMS 是消息传递 API，通常用于对传入的 Web 服务请求进行排队以进行处理。

据我了解，您想要做的是构建一个连接到您的 Tibco Web 服务的 Web 服务客户端？

如果是这样，是的，这是可能的，Java EE 带有您可以使用的 Web 服务 API。Java EE 教程的 Web 服务章节是一个很好的起点：[http ://docs.oracle.com/javaee/6/tutorial/doc/bnayk.html](http://docs.oracle.com/javaee/6/tutorial/doc/bnayk.html)

# sql - 如何在sql中将“null”修改为“not null”

> ID：13962287
> 
> 赞同：2
> 
> 时间：2012-12-19T22:25:49.850
> 
> 标签：sql, sql-server, database, sql-server-2008

我有一张表，我需要从“null”更改为“not null”。

我有一个具有以下结构的表：

```
Created_By   Created_Date_Time   Modified_By    Modified_Date_Time
NULL            NULL                -1                 NULL
NULL            NULL                -1                 NULL
NULL            NULL                -1                 NULL 
```

我需要从`Modified_By`更改`-1`为`null`。

我正在尝试使用以下查询，但它给了我一个错误：

```
update BOM_Rules
set Modified_By = not null 
```

错误：

```
Cannot insert the value NULL into column 'Modified_By', table 'dbo.BOM_Rules'; column does not allow nulls. UPDATE fails. 
```

我确信我错过了一些重要的东西。也许`alter table`？

```
ALTER TABLE BOM_Rules
ALTER COLUMN Modified_By NVARCHAR(50) NOT NULL 
```

我正在使用 SQL2008R2。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T22:35:58.043

听起来 Modified_By 列不允许空值。尝试更改列以允许空值：

```
ALTER TABLE BOM_Rules
ALTER COLUMN Modified_By NVARCHAR(50) NULL 
```

# mongoose - 从 TypeScript 接口生成 Mongoose 模式？

> ID：13962292
> 
> 赞同：9
> 
> 时间：2012-12-19T22:26:16.787
> 
> 标签：mongoose, typescript

我一直在为我的应用程序中的所有类型和数据结构定义 TypeScript 接口，并且很快将面临将大多数数据结构复制为 Mongoose 模式定义的任务。

我想知道是否没有人制定了一个解决方案来从另一个自动生成一个？

我想避免维护本质上相同的东西的两个副本的负担。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:52:19.710

最简单的方法是使用一些易于解析的格式，并从中生成 Typescript 和 Mongoose 接口。以下是 JSON 格式的示例：

```
{ "name": "IThing",
  "type": "interface",
  "members": [
      { "name": "SomeProperty",
        "type": "String" },
      { "name": "DoStuff",
        "type": "function",
        "arguments": [
            { "name": "callback",
              "type": "function",
              "arguments": [],
              "return": "Number" }
        ] }
  ] } 
```

结构，甚至标记语言都可以根据您的需要进行更改。

上面会在 TypeScript 中产生类似这样的东西：

```
interface IThing {
    SomeProperty: String;
    DoStuff(callback: () => Number)
} 
```

这在猫鼬中：

```
var IThing = new Schema({
    "SomeProperty": "String"
});

IThing.methods.DoStuff = function (callback) {
    // TODO
}; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-10-11T15:06:58.140

有点晚了，但我们刚刚构建了一个工具来做到这一点，看看[mongoose-tsgen](https://github.com/Bounced-Inc/mongoose-tsgen)。此 CLI 工具会生成一个`index.d.ts`包含所有模式接口的文件，并且不需要您重写模式。每当您更改架构时，只需重新运行该工具。

# security - 如何隔离 Java EE 应用程序的逻辑层

> ID：13962293
> 
> 赞同：0
> 
> 时间：2012-12-19T22:26:20.123
> 
> 标签：security, ejb, layer

我不确定这实际上是一个真正的问题还是一个愚蠢的初学者问题。也许我错过了一些观点，这个问题相当琐碎，所以请多多包涵。

如果我猜对了，那么层和层之间的区别在于层与逻辑分离有关，而层则意味着应用程序部分的物理分离。

可以将层实现为单独的层，以保护应用程序免受用户直接调用（例如，对数据访问对象）的影响。但我的意图是以逻辑方式向用户客户端隐藏应用程序的较低层，这意味着实际上不使用单独的 jvm 或应用程序服务器。我该怎么做，这是否与包装的方式有关？（不同的档案，如 jar、war、ears 以隔离逻辑......）。

我实际上对为分层服务器应用程序提供安全性很感兴趣，因为它可能存在各种不受我控制的客户端。如果我要为客户端应用程序程序员提供高级服务的接口，我也必须使用 EJB 安全注释来保护低层。我希望通过将较低层标记为应用程序客户端无法访问来以更优雅的方式执行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T17:10:47.483

> 但我的意图是以逻辑方式向用户客户端隐藏应用程序的较低层，这意味着实际上不使用单独的 jvm 或应用程序服务器。

如果这些“用户客户端”在同一个 JVM 甚至同一个应用程序（例如同一个 .war、同一个 .ear）中运行，那么您所寻求的安全级别只是表面的。基本上，你是在保护你自己的同事或队友（*通常，“用户客户端”是外部客户端，从不同的机器上运行，通过 Internet 与你联系*）。

在 Java EE EAR 应用程序中存在一些分层，但这些层的存在是为了防止业务逻辑直接访问视图逻辑。例如，较低级别的层不能访问较高级别的层。这些层通过类加载器隔离相互保护。具体来说，每个 Web 模块都位于层次结构的底部，其他模块（甚至不是其他 Web 模块）无法直接访问其中的代码。EJB 模块是向下的一层，所有 Web 模块以及其他 EJB 模块都可以访问其中的代码。最后是顶层 EAR，它不算作一个模块，但可以包含实用程序代码，这些代码不能直接访问模块中的代码，但可以被所有模块使用（因此是跨层的，Web 模块）也可以直接访问）。

Java EE 中的模块系统似乎与您想要的不同。它隐藏了更高的层，而不是更低的层。

通过将多个“协作”应用程序部署到同一个应用程序服务器，可以实现额外级别的模块隔离。然后，您可以将 EJB bean 的远程接口定义为您试图隐藏的逻辑的网关（外观）。请注意，许多应用程序服务器也允许部署到同一 AS 的其他应用程序从 JNDI 请求本地 EJB，即使 EJB 规范不要求这样做（但也没有禁止）。

此外，还有私有和受保护访问修饰符的常用机制，但这些更适合保护您免受编码错误的影响。反射技巧很容易通过它们。

然后是安全经理。如果您不信任来自您自己的队友（“用户客户端”）的代码，您可能需要考虑使用这些代码。它们的使用可能具有挑战性，但可能正是您想要的。

# javascript - SVG 文本的动态样式

> ID：13962294
> 
> 赞同：2
> 
> 时间：2012-12-19T22:26:22.870
> 
> 标签：javascript, svg, d3.js

```
<svg>
    <text id="test" x="0" y="15"></text>
</svg> 
```

,

```
d3.select("#test").text("aaa"); 
```

或者

```
document.getElementById("test").textContent("aaa"); 
```

工作正常。但我需要为文本添加样式。现在：

```
d3.select("#test").text('aaa <tspan style="font-weight:bold">bbb</tspan> ccc'); 
```

不幸的是不起作用，因为参数被视为纯字符串。这个问题的最佳跨浏览器解决方案是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T13:07:46.267

## 工作解决方案

主要问题是 SVG 元素上没有`innerHTML`属性，您需要自己创建所有子节点。但是您可以通过仅使用此字符串创建一个临时 DOM 对象，将您的 HTML 字符串转换为样式化`tspan`的 s（没有）字符串解析魔法。之后，您可以使用 d3 创建正确的 tspans 元素。

```
var text  = d3.select("#test"), tmp = document.createElement("text");  //create tmp
tmp.innerHTML = 'aaa <tspan style="font-weight:bold">bbb</tspan> ccc'  //create HTML children (not yet an SVG!)
var nodes = Array.prototype.slice.call(tmp.childNodes)                 //create a real array from the childNodes variable
nodes.forEach( function(node) {
    text.append("tspan")
        .attr("style", node.getAttribute && node.getAttribute("style"))
        .text(node.textContent)
}) 
```

**剩余问题：**此解决方案不支持 tspan 中的子节点，这需要遍历源`childNodes`元素的tspans（或其他标签）。这最终将导致一个子 tspan 兼容的解析器完全解决这个问题。`style``append``tspan`

**编辑：**有一个更通用的[innerSVG 垫片](https://stackoverflow.com/questions/9723422/is-there-some-innerhtml-replacement-in-svg-xml)，也可以处理子节点。

## 破碎的解决方案

还有一些其他解决方案应该可以工作，但目前已被破坏。正如其他人已经指出的那样，`.html()`直接在 jQuery 或 d3 中使用是行不通的，因为它们依赖于`innerHTML`.

```
//not working
$("#test").html(...); d3.select("#test").html(...) 
```

通过 jQuery 复制和附加（类似于我的工作解决方案）也被破坏了。它创建了正确的 DOM，但未显示 tspan（在 Firefox 和 Chrome 中尝试过）：

```
//creates correct DOM, but disables/hides the created tspan
var tmp = $("<text>")
tmp.html('aaa <tspan style="font-weight:bold">bbb</tspan> ccc')
$("#test").append( Array.prototype.slice.call(tmp[0].childNodes) ) 
```

根据 W3C 规范，应该可以[混合](http://www.w3.org/TR/SVG/images/text/tspan01.svg)使用tspan 和 TextNode。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T00:48:27.917

```
var t = d3.select("#test")
t.append("tspan").text("aaa ");
t.append("tspan").text("bbb").style("font-weight","bold");
t.append("tspan").text(" ccc"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-19T22:33:21.687

```
document.getElementById("test").style.fontWeight="bold" 
```

以上改变了一切。

但是你可以试试 innerHTML 方法：

```
document.getElementById("test").innerHTML('aaa <tspan style=\"font-weight:bold\">bbb</tspan> ccc'); 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-12-19T22:42:35.457

尝试这个

```
d3.select("#test").html('aaa <tspan style="font-weight:bold">bbb</tspan> ccc'); 
```

# youtube-api - 显示可分配的 YouTube 类别列表

> ID：13962297
> 
> 赞同：0
> 
> 时间：2012-12-19T22:26:29.763
> 
> 标签：youtube-api, uipickerview, categories

我正在将视频从我的应用上传到 YouTube。我已经完成了，但有一个小问题。我使用选择器来允许用户选择视频的类别。我正在尝试使用 Apple 在其上传页面中列出的类别，其中包括“汽车和车辆”等项目。但是，如果您查看 YouTube 接受的类别，则该类别是“汽车”。为了解决这个问题，我使用“汽车和车辆”为选择器创建了数组，但后来我将它们转换为“汽车”。

我使用以下代码执行此操作。

```
pickerArray = [[NSMutableArray alloc ]init ];
    [pickerArray addObject: @"Autos & Vehicles" ];
    [pickerArray addObject:@"Comedy"];
    [pickerArray addObject:@"Education"];
    [pickerArray addObject:@"Entertainment"];
    [pickerArray addObject:@"Film & Animation"];
    [pickerArray addObject:@"Gaming"];
    [pickerArray addObject:@"Howto & Style"];
    [pickerArray addObject:@"Music"];
   [pickerArray addObject:@"News & Politics"];
    [pickerArray addObject:@"Nonprofits & Activism"];
    [pickerArray addObject:@"People & Blogs"];
   [pickerArray addObject:@"Pets & Animals"];
     [pickerArray addObject:@"Science & Technology"];
    [pickerArray addObject:@"Sports"];
    [pickerArray addObject:@"Travel & Events"];

    [catagoryPicker selectRow:1 inComponent:0 animated:NO];
    catagoryField1.text = [pickerArray objectAtIndex:[catagoryPicker selectedRowInComponent:0]];

//and then to convert this code

-(void)pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component{
    catagoryField1.text = [pickerArray objectAtIndex:row];

    if (catagoryField1.text == @"Comedy") {
        catagoryField.text =@"Comedy";
    }
    else if (catagoryField1.text == @"Autos & Vehicles") {
        catagoryField.text =@"Autos";}
    else if (catagoryField1.text == @"Gaming") {
        catagoryField.text =@"Games";}
    else if (catagoryField1.text == @"Education") {
        catagoryField.text =@"Education";}
    else if (catagoryField1.text == @"Entertainment") {
        catagoryField.text =@"Entertainment";}
    else if (catagoryField1.text == @"Film & Animation") {
        catagoryField.text =@"Film";}
    else if (catagoryField1.text == @"Howto & Style") {
        catagoryField.text =@"Howto";}
    else if (catagoryField1.text == @"Music") {
        catagoryField.text =@"Music";}
    else if (catagoryField1.text == @"News & Politics") {
        catagoryField.text =@"News";}
    else if (catagoryField1.text == @"Nonprofits & Activism") {
        catagoryField.text =@"Nonprofit";}
    else if (catagoryField1.text == @"People & Blogs") {
        catagoryField.text =@"People";}
    else if (catagoryField1.text == @"Pets & Animals") {
        catagoryField.text =@"Animals";}
    else if (catagoryField1.text == @"Science & Technology") {
        catagoryField.text =@"Tech";}
    else if (catagoryField1.text == @"Sports") {
        catagoryField.text =@"Sports";}
    else if (catagoryField1.text == @"Travel & Events") {
        catagoryField.text =@"Travel";}
} 
```

这适用于只有“游戏”这样的单个词，但在使用“汽车和车辆”时不起作用。如果我使用“汽车/车辆”它不起作用，但“汽车/车辆”可以。所以我假设空间的使用会搞砸一些事情。有人可以告诉我如何解决这个问题，以便我可以使用“汽车和车辆”。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-06-08T06:57:46.063

`All categories`根据然后`YouTube`使用进入：`country wise``GET Request`

```
https://www.googleapis.com/youtube/v3/videoCategories?key={your public access api key here}&part=snippet&regionCode=IN 
```

**注意**：regionCode 是参数值，是一个[ISO 3166-1 alpha-2](http://www.iso.org/iso/country_codes/iso_3166_code_lists/country_names_and_code_elements.htm)国家代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-28T02:28:15.827

这在[https://developers.google.com/youtube/2.0/reference#YouTube_Category_List中有解释](https://developers.google.com/youtube/2.0/reference#YouTube_Category_List)

基本上，每个类别都有一个`term`值（您传递给 API 的内容）和一个`label`值（您在 UI 中显示的内容）。这些文档解释了如何在 XML 文件中检索这些值的列表以及如何确定要显示的内容。

# jquery - jquery selectable 不能在动态加载的表上工作

> ID：13962301
> 
> 赞同：1
> 
> 时间：2012-12-19T22:26:43.530
> 
> 标签：jquery, ajax, dynamically-generated, selectable

我是 jQuery 的新手。我正在尝试在动态加载的（AJAX 调用）内容上选择表行，但它不起作用。它在标准的 HTML 页面*中工作；*以下作品：

```
<style>
    #feedback { font-size: 1.4em; }
    #selectable .ui-selecting { background: #FECA40; }
    #selectable .ui-selected { background: #F39814; color: white; }
    #selectable { list-style-type: none; margin: 0; padding: 0; width: 60%; }
    #selectable li { margin: 3px; padding: 0.4em; font-size: 1.4em; height: 18px; }
</style>
<script>
    $(function() {
        $("#selectable").selectable({
            filter: 'tr',
            selected: function(event, ui) {
                alert("row selected");
            }
        });
     });
</script>

<table id="selectable" border="1px">
    <tr><td>val1</td><td>Val2</td></tr>
    <tr><td>Val3</td><td>Val4</td></tr>
    <tr><td>Val5</td><td>Val5</td></tr>
</table> 
```

但是，如果我将这些数据加载到`div`using 中`$("my-div").html(same-data-from-ajax).trigger('create')`，则它不起作用。

这就是我所拥有的：

*   一键式主html
*   js与：

    ```
    $("#button").click(function {
        $.ajax({
            url: "./php/testselect.php", // this returns above html code
                cache: false,
                success: onSuccessSelect,
                error: onError
            });
    });
    function onSuccessSelect(data, status) {
        $("#my-div").html(data).trigger('create');
    } 
    ```

我做错什么了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:38:46.353

我相信在您的情况下最简单的解决方案是重新应用于`selectable`新创建的元素：

```
function onSuccessSelect(data, status) {
    $("#my-div").html(data).trigger('create');
    $("#my-div").find("#selectable").selectable({
        filter: 'tr',
        selected: function(event, ui) {
            alert("row selected");
        }
    });
} 
```

我还建议，如果您有多个表，您可能希望使其可选择，使用类而不是 id（例如：`<table class="selectable">`和`find(".selectable")`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:11:06.987

我有同样的问题，没有一个解决方案对我有用。似乎 selectable 可以应用于 onpageload javascript 执行。mgibsonbr 提供的小提琴对我不起作用。我所做的是一个黑客，这是一个肮脏的。

添加元素后，我只需从缓存中重新加载页面而不接触服务器。

location.reload();

# python - 包含复杂类型的 SWIG-ed C 结构的引用计数似乎没有按预期工作

> ID：13962305
> 
> 赞同：5
> 
> 时间：2012-12-19T22:26:52.667
> 
> 标签：python, struct, swig

我遇到了一个有趣的发现，与 SWIG 如何处理包含其他结构作为成员的 C 结构的引用计数有关。

我观察到，在我将结构子成员中的数据存储到其他 python 对象（lists/dicts）的情况下，我的 python SWIG 对象在我完成使用它们之前就被垃圾收集了。经过一番挖掘后，我发现 SWIG 结构成员似乎没有自己的独立引用计数，即使解释器表明它们是“Swig 对象”。因此，当我将结构子元素中的数据添加到我的列表中时，python 并不知道我已经添加了对该数据的引用。

我创建了一个简单的案例来演示。我 SWIG 编辑了以下 3 个结构：

**SWIG-ed C 结构：**

```
typedef struct
{
    unsigned long source;      
    unsigned long destination; 
} message_header;

typedef struct
{
    unsigned long data[120];    
} message_large_body;

typedef struct
{
    message_header       header;
    message_large_body   body;
} large_message; 
```

然后，我创建了一个有点等价的 python 类来将行为与纯 SWIG-ed 解决方案进行比较。

**有点等价的 Python 类**

```
class pyLargeMessage(object):
    def __init__(self):
        self.header = bar.message_header()
        self.body = bar.message_large_body() 
```

然后我在解释器中运行了以下测试。

**Python 解释器结果**

```
>>> y = pyLargeMessage()
>>> y
<__main__.pyLargeMessage object at 0x06C5E6B0>
>>> y.header
<Swig Object of type 'message_header *' at 0x06C5E700>
>>> sys.getrefcount(y.header)
3
>>> z = [y.header]
>>> sys.getrefcount(y.header)
3
>>> z += [y.header]
>>> sys.getrefcount(y.header)
4
>>>
>>> y = bar.large_message()
>>> y
<Swig Object of type 'large_message *' at 0x06C668E0>
>>> y.header
<Swig Object of type 'message_header *' at 0x06C66B60>
>>> sys.getrefcount(y.header)
1
>>> z = [y.header]
>>> sys.getrefcount(y.header)
1
>>> z += [y.header]
>>> sys.getrefcount(y.header)
1
>>> 
```

Python 实现的行为符合我的预期，但纯 SWIG 实现却没有。有人可以解释这里发生了什么吗？

我已经多次阅读了 SWIG 文档的各个部分，但找不到任何似乎可以直接解释这一点的内容。我已经了解了很多关于事情如何运作的知识，但是对于上述现象，我找不到任何明确的解释/解决方法。

想了很久，一遍又一遍地重新阅读结构和类、[代理类](http://www.swig.org/Doc2.0/SWIGDocumentation.html#Scripting_nn8)和[结构数据成员](http://www.swig.org/Doc2.0/SWIGDocumentation.html#SWIG_structure_data_members)部分并查看生成的包装器代码后，我仍然无法弄清楚为什么引用计数没有正常处理.

生成的 C 代码调用`SWIG_NewPointerObj`，最终（在大多数情况下）调用`PyObject_New`，而后者又应该（如 python 文档所述）返回一个新的引用。

***为标头*成员的 get-er 生成 SWIG 代码**

```
SWIGINTERN PyObject *_wrap_large_message_header_get(PyObject *self, PyObject *args) {
  PyObject *resultobj = 0;
  large_message *arg1 = (large_message *) 0 ;
  void *argp1 = 0 ;
  int res1 = 0 ;
  message_header *result = 0 ;

  if (args && PyTuple_Check(args) && PyTuple_GET_SIZE(args) > 0) SWIG_fail;
  res1 = SWIG_ConvertPtr(self, &argp1,SWIGTYPE_p_large_message, 0 |  0 );
  if (!SWIG_IsOK(res1)) {
    SWIG_exception_fail(SWIG_ArgError(res1), "in method '" "large_message_header_get" "', argument " "1"" of type '" "large_message *""'"); 
  }
  arg1 = (large_message *)(argp1);
  result = (message_header *)& ((arg1)->header);
  resultobj = SWIG_NewPointerObj(SWIG_as_voidptr(result), SWIGTYPE_p_message_header, 0 |  0 );
  return resultobj;
fail:
  return NULL;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T12:46:54.980

正如已经指出的，getter 返回的对象和`header`基本上`body`是一个轻量级代理对象，它为. 它不拥有该内存（它仍然由对象本身或 C 库“拥有”，具体取决于您创建它的方式）并且它不是副本。`header``body``struct``message`

即使它是一个副本，您的调用`sys.getrefcount`也总是会返回 1 - 每次调用 getter 都会返回一个新副本。

从 Python 的角度来看，如果你想确保你永远不会有一个悬空指针，有两种方法可以修复它：

1.  `header`getter 为/的副本返回一个代理，`body`它拥有它指向的内存。
2.  getter 返回一个代理，该代理持有对`message`自身的引用，因此即使`message`释放了它的引用计数也不能达到 0，而有代理对象引用它的一部分。

我已经整理了一个使用 SWIG 执行 #2 的示例。你的头文件保持不变，但是界面变成了：

```
%module test

%{
#include "test.h"
%}

%typemap(out) message_header * header %{
  // This expands to resultobj = SWIG_NewPointerObj(...) exactly as before:
  $result = SWIG_NewPointerObj(SWIG_as_voidptr($1), $1_descriptor, 0);
  // This sets a reference to the parent object inside the child
  PyObject_SetAttrString($result, "_parent", obj0);
%}

%include "test.h" 
```

这相当于说：

```
z = y.header
z._parent = y 
```

在 Python 中。

有了这个，我们现在可以运行：

```
y = test.large_message()
print(sys.getrefcount(y))
print(y.header)
z = [y.header]
print(sys.getrefcount(y))
z += [y.header]
print(sys.getrefcount(y)) 
```

正如预期的那样，它显示了`y`随着创建的每个子对象代理而增加的引用计数。因此，他们引用的内存不能过早地释放（至少不能通过 SWIG）。

您可以使用以下方法使其更通用并将其应用于多个类型/成员`%apply`：

```
%module test

%{
#include "test.h"
%}

%typemap(out) SWIGTYPE * SUBOBJECT %{
  $result = SWIG_NewPointerObj(SWIG_as_voidptr($1), $1_descriptor, 0);
  PyObject_SetAttrString($result, "_parent", obj0);
  assert(obj0);
  // hello world
%}

%apply SWIGTYPE * SUBOBJECT { message_header * header };
%apply SWIGTYPE * SUBOBJECT { message_large_body * body };

%include "test.h" 
```

# ios - 将 C 库 (libircclient) 实现到 iOS 项目 (i386/armv7/x64) 中的问题

> ID：13962307
> 
> 赞同：1
> 
> 时间：2012-12-19T22:27:10.890
> 
> 标签：ios, cocoa, gcc

我正在尝试构建一个支持 IRC 聊天的 iOS 应用程序。我发现以下库似乎很容易实现，并且还有一个如何在 Cocoa 中执行此操作的示例：

Sourceforge 上的 Libircclient (v1.0) IRCClient on GitHub by Jonasschnelli (v1.3)

（对不起，我不能添加超过 2 个超链接）

但是我在我的项目中不断收到这些错误：

架构 i386 的未定义符号：“_OBJC_CLASS_$_IRCClientSession”，引用自：ViewController.o ld 中的 objc-class-ref：未找到架构 i386 的符号

我按照这个答案进行了实施：

[iPhone - 为什么编译器在为 ARM 架构构建时找不到某些包含？](https://stackoverflow.com/questions/5878292/iphone-why-can-the-compiler-not-find-some-includes-when-building-for-arm-archi)

创建了一个 Cocoa 静态库项目，它实际上是为 iOS6 构建的，就像它描述的那样。但是，当我尝试在一个简单的 1 视图 iOS 项目中将 Cocoa 示例文件与可可静态库结合使用时，会弹出错误。所以在我的项目中，我有以下文件：

如问题中所述

```
- libircclient.c 
- included the ../include folder as header search which contains the .h files. 
```

从可可示例中，但删除包含到 cocoa.h

```
- IRCClientSessionDelegate.h 
- IRCClientSession.h
- IRCClientChannelDelegate.h
- IRCClientChannel.h 
```

我在 ViewController.m 中添加以下行（没有这些行，它构建时没有错误）：

```
#import "IRCClientSession.h"
IRCClientSession *  session = [[IRCClientSession alloc] init]; 
```

然后我尝试了第二个和第三个答案：调整armv7和i386的makefile（-arch armv7），但出现相同的i386错误。

我对这些命令不是很好，并且不确定错误实际上是什么意思。据我了解，我必须针对 iOS SDK 而不是针对我的 MAC 64 位 SDK 构建 C 文件。以为我是用 xcode 静态库做到的，但在实际使用它之后，它给了我 i386 错误。我猜 i386 是用于模拟器的。但是构建到设备会导致相同的 i386 错误。

任何帮助，将不胜感激！

[编辑：删除了 make 错误，因为我在 example 文件夹上进行了 make，在 src 文件夹中 make 有效]

# ruby-on-rails - 我想用类似 will_paginate 的东西对 gmaps4rails 的侧边栏进行分页

> ID：13962310
> 
> 赞同：0
> 
> 时间：2012-12-19T22:27:21.297
> 
> 标签：ruby-on-rails, will-paginate, gmaps4rails

我正在尝试做这样的事情：

```
@json = Location.near(request.remote_ip, 500).paginate(:page => params[:page], :per_page => 7).to_gmaps4rails 
```

但它不起作用。我不断得到这个：

```
undefined method `total_pages' for "[]":String 
```

# java - 使我的所有 ajax 响应不可缓存的简单方法

> ID：13962318
> 
> 赞同：0
> 
> 时间：2012-12-19T22:27:43.920
> 
> 标签：java, caching, jersey

我正在维护一个使用 Jersey 创建 RESTful API 的应用程序。

我想在所有这些上设置响应标头以关闭缓存。

我可以通过蛮力替换每个

```
Response.ok().build() 
```

和

```
Response.ok().cacheControl(noCache).build() 
```

`noCache`前面定义为

```
CacheControl noCache = new CacheControl();
noCache.setNoCache(true); 
```

（并对我构建的所有其他 Response 对象进行类似的更改）但是在所有 100 多个有返回值的地方进行此更改似乎是笨拙的。有没有一种简单的方法可以为我产生的所有响应设置首选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:30:03.837

除非泽西岛有魔法设置可以做到这一点，否则我能想到的一种方法是使用 AOP 库，如 AspectJ。您捕获 build() 方法的调用，并在之前执行 cacheControl。

但是，与进行 eclipse '搜索此方法的所有调用者并替换为其他内容'相比，这是否值得付出努力是值得怀疑的。

根据 DRY（不要重复自己）原则，一种更好的编程风格是抽象和集中构建响应的方式，这样当您需要更改它时，您只需在一个位置进行更改，而不是多个位置。也许您可以在这里应用服务模式（例如：创建一个 ResponseBuilderService）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T16:17:02.193

处理这个问题的正确位置是在 web 容器中；您使用的是哪一个（Jetty/Tomcat/Grizzly/等）？

# c++ - C++。当类 T 需要 A 类模板参数时，如何为 A 类定义 T 类模板参数？

> ID：13962320
> 
> 赞同：1
> 
> 时间：2012-12-19T22:28:00.210
> 
> 标签：c++, templates, design-patterns, template-meta-programming

Executor 类具有 P 类型的模板，它在构造函数中接受一个 P 对象。Algo 类有一个模板 E，也有一个 E 类型的静态变量。处理器类有模板 T 和一个 Ts 的集合。

问题我如何定义`Executor< Processor<Algo> >`和`Algo<Executor>`？这可能吗？我看不出有什么办法来定义它，它是一种“无限递归模板参数”

见代码。

```
template <class T>
class Processor { 
    map<string,T> ts;
    void Process(string str, int i)
    {
        ts[str].Do(i);
    }
} 

template <class P>
class Executor {
    P &p;
    Executor(P &inp) : p(inp) {}

    void Bar(string str, int i) {
        p.Process(str,i);
    }

    Execute(string str)
    {
    }
} 

template <class E>
class Algo
{
    static E e;

    void Do(int i) {}
    void Foo()
    {
        e.Execute("xxx");
    }
}

main ()
{
    typedef Processor<Algo> PALGO; // invalid
    typedef Executor<PALGO> EPALGO;
    typedef Algo<EPALGO> AEPALGO;

    Executor<PALGO> executor(PALGO());
    AEPALGO::E = executor;
} 
```

编辑***** ** *** ** *** ** *** ** *** ** *** ** *** ** *** ** *** *****

一点澄清。Executor 是一个提供服务的单例。所有的 Algo 对象都需要 Executor 的服务。Executor 有时会生成需要发送到特定 Algo 对象的报告。它们通过处理器被发送到正确的算法。

基本问题是需要 Algo 来定义 Executor 并且需要 Executor 来定义 Algo。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:26:28.870

尝试复制您的代码，不太确定您要实现的目标。对于初学者，这是我将其修改为：

```
 #include <string>   //Added
   #include <map>      //Added
   using namespace std;//Added

   template <class T>
   class Processor {    
      map<string,T> ts;    
      void Process(string str, int i) {        
         ts[str].Do(i);    
      }
   };

   template <class P>
   class Executor {
      Processor<P> &p;    //Was Proc ???
      Executor(P &p) : Processor<P>(p) {}    //Was Proc ???
      void Foo(string str, int i) {
         p.Process(str,i);
      }
      void Execute(string str){}  //Added return type void
   };

   template <class E>
   class Algo {
   public:                 //Added
      static E e;
      void Do(int i) {}
   };

   main () {
      typedef Processor< Algo<int> > PALGO; //Added template argument to Algo
      typedef Executor<PALGO> EPALGO;
      typedef Algo<EPALGO> AEPALGO;

      Executor<PALGO> executor(PALGO());
      AEPALGO::e = executor;
   } 
```

在 Executor 定义中将 Proc 修改为处理器 - （什么是 Proc？）并在 typedef Processor> PALGO 中为其提供模板参数；然后 AEPAGO::E --> 那是一个模板参数，而不是类 Algo 成员 - 所以 AEPAGO::e。现在您将收到一个更易于管理的错误。它需要一个复制构造函数来转换类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:36:00.430

AFAICS，你不能用*相同* `Executor`的类型做到这一点。否则你将不得不定义

```
Executor<Processor<Algo<Executor<Processor<Algo<...> > > > > > 
```

如果你用其他类型定义它，它可能会起作用，只要在技术上有意义

```
class X {
...
};

Executor<Processor<Algo<Executor<Processor<Algo<X> > > > > > 
```

或与`typedef`

```
class X {...};
typedef Processor<Algo<X> > PALGO;
typedef Executor<PALGO> EPALGO;
typedef Algo<EPALGO> AEPALGO;

Executor<PALGO> executor(PALGO()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T22:40:16.623

您可以使用继承。

```
class X : public Executor<Processor<Algo<X>>> {}; 
```

否则，这是不可能的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T01:34:14.320

由于 Executor 是一个单例，因此您可以将其定义移出 Algo，既可以在它自己的单例类中，也可以在 Executor 中。然后制作所有需要了解的关于 Executor 模板成员函数的 Algo 函数。

```
template <class P>
class Executor {

    static Executor e;

    P &p;
    Executor(P &p) : Proc(p) {}

    void Bar(string str, int i) {
        p.Process(str,i);
    }

    Execute(string str)
    {
    }

    public:
    static Executor& getE(){ return e;}
} 

class Algo
{

    void Do(int i) {}
    template <class E>
    void Foo()
    {
        E::getE().Execute("xxx");
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-20T02:44:26.923

解决了！看评论。// ***** *****

```
#include <string>
#include <map>
#include <iostream>
using namespace std;

template <class T>
class Processor {
public:
    map<string,T*> ts;
    void Process(string str, int i)
    {
        ts[str]->Do(i);
    }
};

template <class P>
class Executor  {
public:
    P &p;
    Executor(P &inp) : p(inp) {}

    void Bar(string str, int i) {
        p.Process(str,i);
    }

    void Execute(string str)
    {
        cout << " Executor::Execute " << str << endl;
    }
};

template <template <class> class E> //**********
class Algo
{
    string str;
public:
    Algo(const string &s) : str(s) {}

    static E<Processor<Algo>> *e; //**********

    void Do(int i) { cout << str << "::Do(" << i <<")"<< endl; }

    void Foo()
    {
        e->Execute(str);
    }
};

template <template <class> class E>
E< Processor<Algo<E> > >* Algo<E>::e;  //**********

int main(int argc, char **argv)
{
    typedef Algo<Executor> EALGO;
    typedef Processor<EALGO> PALGO;
    typedef Executor<PALGO> EPALGO;

    PALGO p;
    EPALGO executor(p);

    EALGO::e = &executor; //**********

    EALGO ealgo1("algo1"), ealgo2("algo2");

    p.ts["algo1"] = &ealgo1;
    p.ts["algo2"] = &ealgo2;
    ealgo1.Foo();
    ealgo2.Foo();
    executor.Bar("algo1",1111);
    executor.Bar("algo2",2222);

} 
```

# php - 我的递归函数中的问题

> ID：13962323
> 
> 赞同：4
> 
> 时间：2012-12-19T22:28:09.707
> 
> 标签：php, multidimensional-array

我正在设计评论系统，但我的递归函数存在一些问题。如果在下面查看此代码：

```
$list = array(
            array('id'=>1,'parent'=>0),
            array('id'=>2,'parent'=>1),
            array('id'=>3,'parent'=>0),
            array('id'=>4,'parent'=>0),
            array('id'=>5,'parent'=>4),
            array('id'=>6,'parent'=>4)
        );

$c = count($list);

$comment = array();

function setParentStyleComment($cmnt){
    return 'id: '.$cmnt['id'].' - parent: '.$cmnt['parent'].' - [PARENT]';
}

function setReplyStyleComment($cmnt){
    return 'id: '.$cmnt['id'].' - parent: '.$cmnt['parent'].' - [REPLY]';
}

function getComment($p) {
    global $comment,$list,$c;
    foreach($list as $L){
        if(($L['parent'] == 0 || $L['parent'] != $p) && $L['id'] != $p) 
        {
            $comment[] = setParentStyleComment($L);
            $x = $L['id'];
            array_shift($list);
            getComment($x);
        } 
        else if($L['id'] != $p) 
        {
            $comment[] = setReplyStyleComment($L);
            $x = $L['id'];
            array_shift($list);
            if($x < $c){
                getComment($x);
            }
        }
    }
}

getComment(0);  
echo "<pre>";
print_r($comment);
echo "</pre>\n<br/>"; 
```

上面的代码，有这个结果：

```
Array
(
[0] => id: 1 - parent: 0 - [PARENT]
[1] => id: 2 - parent: 1 - [REPLY]
[2] => id: 3 - parent: 0 - [PARENT]
[3] => id: 4 - parent: 0 - [PARENT]
[4] => id: 5 - parent: 4 - [REPLY]
[5] => id: 6 - parent: 4 - [PARENT]
) 
```

但它必须有这个结果：

```
Array
(
[0] => id: 1 - parent: 0 - [PARENT]
[1] => id: 2 - parent: 1 - [REPLY]
[2] => id: 3 - parent: 0 - [PARENT]
[3] => id: 4 - parent: 0 - [PARENT]
[4] => id: 5 - parent: 4 - [REPLY]
[5] => id: 6 - parent: 4 - [REPLY]
) 
```

我该如何解决这个功能问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T22:48:26.317

我认为您正在使一个简单的任务变得复杂....一个简单的循环就足够了

```
$final = array();
foreach ( $list as $value ) {
    $final[] = !$value['parent'] 
               ? setParentStyleComment($value)
               : setReplyStyleComment($value);
}

print_r($final); 
```

输出

```
Array
(
        [0] => id: 1 - parent: 0 - [PARENT]
        [1] => id: 2 - parent: 1 - [REPLY]
        [2] => id: 3 - parent: 0 - [PARENT]
        [3] => id: 4 - parent: 0 - [PARENT]
        [4] => id: 5 - parent: 4 - [REPLY]
        [5] => id: 6 - parent: 4 - [REPLY]
) 
```

[观看现场演示](http://eval.in/4948)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:48:16.627

递归？

```
$list    = array(
    array('id' => 1, 'parent' => 0),
    array('id' => 2, 'parent' => 1),
    array('id' => 3, 'parent' => 0),
    array('id' => 4, 'parent' => 0),
    array('id' => 5, 'parent' => 4),
    array('id' => 6, 'parent' => 4)
);

$comments = array_map(function($item) {
    return sprintf(
      'id: %d - parent: %d - [%s]', 
       $item['id'], $item['parent'], $item['parent'] ? 'REPLY' : 'PARENT');
}, $list);

echo "<pre>";
print_r($comments);
echo "</pre>\n<br/>"; 
```

如（完整）示例所示，这是一个简单的`array_map`操作。

# c# - Monodroid EditText 输入类型数字检测回车按键

> ID：13962327
> 
> 赞同：2
> 
> 时间：2012-12-19T22:28:26.007
> 
> 标签：c#, xamarin.android, android-edittext, event-handling, numbers

我正在尝试制作一个平板电脑应用程序，它有几个设置为 InputType="number" 的编辑文本字段，因此它看起来像一个小键盘，而不是整个键盘。这显然是因为我只想在该字段中输入数字。

但是，我想检测用户是否按下了 ENTER 键。如果他们这样做了，我想关闭软键盘——所以它比点击那个小向下箭头按钮来隐藏键盘更容易和更容易访问。我已经为屏幕上另一个接受所有字符（使用默认键盘）的编辑文本框做了这件事，而且效果很好。但是由于某种原因，当我尝试从数字键盘检测按键时，我无法这样做。

所以这是我似乎无法弄清楚的问题：当我在键盘上添加一个监听器时，没有任何效果。屏幕上似乎没有出现任何数字。如果我删除侦听器，小键盘会再次正常工作，但是我无法听到按下的回车键，所以我可以关闭软键盘。

所以，这就是我得到的：

```
 <EditText
          android:id="@+id/NumOfAdults_EditText"
          android:layout_width="70sp"
          android:layout_height="50sp"
          android:inputType="number"
          android:textSize="20sp"
          android:textStyle="bold"
          android:gravity="center"
          android:selectAllOnFocus="true"
            /> 
```

我像这样听它：

```
 var editTextBox = FindViewById<EditText>(Resource.Id.NumOfAdults_EditText);
          editTextBox.KeyPress += (intentSender, e) =>
          {
            if (e.Event.Action == KeyEventActions.Down && e.KeyCode == Keycode.Enter)
            {
                CloseSoftKeyboard();
                e.Handled = true;
            }
          }; 
```

那么有谁知道为什么当我这样做时，数字输入键停止工作？当 inputType 未设置为 number 或 phone 时，此代码完全可以正常工作。有趣的是，如果我在检测中添加 Make.Toast，我实际上可以看到按键工作（甚至可以让 Num0-9 显示）但屏幕上似乎又没有任何工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T23:04:29.863

您可以覆盖您的活动的**DispatchKeyEvent**方法并放入一些这样的代码。但是，所有按钮按下都会调用它，所以尽量限制它。

在此示例中，将*etTheIdOfYourEditTextControl*替换为您希望发生此行为的字段的实际名称。

```
public override bool DispatchKeyEvent(KeyEvent e)
    {
        if (this.CurrentFocus.Id == Resource.Id.etTheIdOfYourEditTextControl && (e.KeyCode == Keycode.NumpadEnter || e.KeyCode == Keycode.Enter))
        {
            InputMethodManager imm = GetSystemService(Context.InputMethodService) as InputMethodManager;
            if (imm != null)
                imm.HideSoftInputFromWindow(this.CurrentFocus.WindowToken, 0);

            return true;
        }

        return base.DispatchKeyEvent(e);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-29T04:37:20.400

已经很久了，但仍然显示解决方案：

```
if (...) // Handle some key
{
    ...
}
else if (...) // Handle another key
{
    ...
}
else
{
    e.Handled = false; // if you want that character appeared on the screen
} 
```

# django - django get requests - 从表单中获取俄语符号

> ID：13962332
> 
> 赞同：2
> 
> 时间：2012-12-19T22:29:22.243
> 
> 标签：django, encoding, utf-8, get, get-request

我的 forms.py 中有一个搜索表单：

```
class search_form(forms.Form):
    text = forms.CharField( widget = 
        forms.TextInput({ "placeholder": "введите слово" }) ) 
```

我的表格标题是

```
<form action='/search_results/' method='get'> 
```

然后我从我的基地获得财产

```
def search_results(request):
    context = {}
    if request.GET:
        form = search_form(request.GET)
        if form.is_valid():
            print form.cleaned_data['text']
            properties = PropertyText.objects.filter(value__icontains = 
                form.cleaned_data['text']) 
```

如果我使用拉丁符号 - 我会得到正确的结果，但是一旦我尝试搜索俄语单词，我就会失败。例如，我输入 word `для`（在我的文章中到处都是），但没有得到任何结果。`print form.cleaned_data['text']`给我一些奇怪的符号`ÑÑÐ¾`，所以也一样`print request.GET['text']`

`encode('utf-8')`没有结果，`decode('utf-8')`抛出异常`'ascii' codec can't encode characters in position 0-5: ordinal not in range(128)`

我`# -*- coding: utf-8 -*-`的views.py、forms.py 和urls.py 以及`<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />`我的模板中有

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T12:09:04.483

检查您的所有模板文件是否都以 utf-8 编码保存；另外，阅读有关[unicode 数据](https://docs.djangoproject.com/en/dev/ref/unicode/#templates)的 django 文档。

# jquery - 我可以将 jQuery.ajax 与 Angular JS promise api 一起使用吗？

> ID：13962334
> 
> 赞同：3
> 
> 时间：2012-12-19T22:29:28.150
> 
> 标签：jquery, cordova, angularjs

我在 Angular 服务中有一个 ajax 函数，它根据后端服务检查用户的凭据。我已经大大简化了通话。当我使用 $http 服务发出 AJAX 请求时，promise API 可以正常工作：

```
function isOnline(){
    return $http.get(constants.dataUrl)
           .success(function(){return})
           .error(function(){return;});
}
function checkCredentials(){
    var online = isOnline();
    var checkCreds = online.then(function(){
        alert("Get succeeded");
    },
    function(response){
        alert("Get did not succeed");
    });
    return checkCreds;
} 
```

我看到 then 中定义的函数被调用。但是，当我使用 jQuery ajax 方法时，resolve 和 defer 方法似乎不会传播并触发 online.then 中的正确方法。下面的代码不起作用：

```
function isOnline(){
    var defer = $q.defer();

    $.ajax({
      url: constants.dataUrl,
      dataType: 'json',
      beforeSend: function (xhr) {
        xhr.setRequestHeader('Authorization', basicAuthenticationToken());
      },
      error: function (xhr, ajaxOptions, thrownError) {
        alert("I am not online");
        defer.reject("I am not online");
      },
      success: function (data) {
        alert("I am online");
        defer.resolve(data);
      }
    });

    return defer.promise;
}
function checkCredentials(){
    var online = isOnline();
    var checkCreds = online.then(function(){
        alert("Get succeeded");
    },
    function(response){
        alert("Get did not succeed");
    });
    return checkCreds;
} 
```

我不能将 promise API 与普通的 jQuery ajax 方法一起使用吗？我想替换这些调用的原因与似乎不适用于 Angular $http 的复杂 PhoneGap 场景有关。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-20T01:29:57.443

Angularjs 需要被通知在它之外发生的变化。由于 ajax 事件正在由 jquery 处理，因此您需要进行应用。取决于你的函数在哪里（可能是 $scope 或 $rootScope）

```
defer.reject("I am not online");
$scope.$apply();

....
defer.resolve(data);
$scope.$apply(); 
```

这将使角度知道重新处理自己。这是上面的文档：[http ://docs.angularjs.org/api/ng.$ro​​otScope.Scope#$apply](http://docs.angularjs.org/api/ng.%24rootScope.Scope#%24apply)

每当您必须在 Angular 之外编写 javascript，但需要将其连接到其中时，您都可以使用此功能。

# perl - WWW::Mechanize::Firefox follow_link 不工作

> ID：13962336
> 
> 赞同：3
> 
> 时间：2012-12-19T22:29:42.237
> 
> 标签：perl, hyperlink, www-mechanize-firefox

我正在尝试关注 Perl 中的链接。我的初始代码：

```
use WWW::Mechanize::Firefox;
use Crypt::SSLeay;
use HTML::TagParser;
use URI::Fetch;
$ENV{PERL_LWP_SSL_VERIFY_HOSTNAME}=0; #not verifying certificate
my $url = 'https://';
$url = $url.@ARGV[0]; 

my $mech = WWW::Mechanize::Firefox->new;
$mech->get($url);

$mech->follow_link(tag => 'a', text => '<span class=\"normalNode\">VSCs</span>');
$mech->reload(); 
```

我在[这里](https://stackoverflow.com/questions/11320114/wwwmechanizefirefox-click-a-link)发现*标签*和*文本*选项以这种方式工作，但出现错误**MozRepl::RemoteObject: SyntaxError: The expression is not a legal expression**。我试图转义文本中的一些字符，但错误仍然相同。然后我改变了我的代码添加：

```
my @list = $mech->find_all_links();
my $found = 0;
my $i=0;
while($i<=$#list && $found == 0){
    print @list[$i]->url()."\n";
    if(@list[$i]->text() =~ /VSCs/){
    print @list[$i]->text()."\n";
    my $follow =@list[$i]->url();
    $mech->follow_link( url => $follow);
}
    $i++;
} 
```

但话又说回来了一个错误：没有**找到匹配'//a [（@href =“https://...**不是，请告诉我还有什么要补充的。谢谢大家的帮助。

这是我要关注的链接的部分：

```
<li id="1" class="liClosed"><span class="bullet clickable">&#160;</span><b><a href="/centcfg/vsc_list.asp?entity=allvsc&amp;selector=All"><span class="normalNode">VSCs</span></a></b>
      <ul id="1.l1">
        <li id="i1.i1" class="liBullet"><span class="bullet">&#160;</span><b><a href="/centcfg/vsc_edit.asp?entity=vsc&amp;selector=1"><span class="normalNode">First</span></a></b></li>
        <li id="i1.i2" class="liBullet"><span class="bullet">&#160;</span><b><a href="/centcfg/vsc_edit.asp?entity=vsc&amp;selector=2"><span class="normalNode">Second</span></a></b></li>
        <li id="i1.i3" class="liBullet"><span class="bullet">&#160;</span><b><a href="/centcfg/vsc_edit.asp?entity=vsc&amp;selector=3"><span class="normalNode">Third</span></a></b></li>
        <li id="i1.i4" class="liBullet"><span class="bullet">&#160;</span><b><a href="/centcfg/vsc_edit.asp?entity=vsc&amp;selector=4"><span class="normalNode">Fourth</span></a></b></li>
        <li id="i1.i5" class="liBullet"><span class="bullet">&#160;</span><b><a href="/centcfg/vsc_edit.asp?entity=vsc&amp;selector=5"><span class="normalNode">None</span></a></b></li>
</ul> 
```

我在 Windows 7 中工作，MozRepl 是 1.1 版，我使用的是 64 位的 Strawberry perl 5.16.2.1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T16:24:23.407

在使用给定的代码四处寻找之后，我能够使 W::M::F 以下列方式跟随链接：

```
use WWW::Mechanize::Firefox;
use Crypt::SSLeay;
use HTML::TagParser;
use URI::Fetch;

...

$mech->follow_link(xpath => '//a[text() = "<span class=\"normalNode\">VSCs</span>"]');
$mech->reload(); 
```

注意`xpath`给出的参数而不是`text`.

我没有仔细研究 W::M::F 源，但在后台它尝试将给定`text`参数转换为 XPath 字符串，并且如果`text`包含 XML/HTML 标记的数量，这是你的情况，它可能会驱动他疯了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:32:13.110

我建议您尝试：

```
$mech->follow_link( url_regex => qr/selector=All/ ); 
```

# dbus - 使用 qdbus 连接到信号

> ID：13962337
> 
> 赞同：2
> 
> 时间：2012-12-19T22:29:47.147
> 
> 标签：dbus, qdbus

`qdbus`调用方法时相当简单，但是可以用它连接到信号吗？签名：

```
signal void org.kde.kwin.Scripting.printError(QString text) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:29:06.007

从`#dbus`开始`irc.freenode.org`：

```
thiago | the command-line utility can only send calls
thiago | use dbus-monitor for that 
```

# html - 从表格单元格中的图像创建的异常间隙

> ID：13962338
> 
> 赞同：0
> 
> 时间：2012-12-19T22:29:48.790
> 
> 标签：html, css

```
<tr id='recent_tablerow_0'>
<td>Women's Health Initiative</td>
<td>Versions 1-5: passed embargo</td>
<td>
    <img src="./images/V.png" alt="V" height="24px" width="20.74px" border="0" s>
    <img src="./images/D.png" alt="D" height="24" width="20.74" border="0">
    <img src="./images/A.png" alt="A" height="24" width="20.74" border="0">
    <img src="./images/S.png" alt="S" height="24" width="20.74" border="0">
</td>
<td>55181</td>
<td>Partial Factorial Randomized, Double-Blind, Placebo-Controlled, Cohort, Longitudinal</td>
<td><a href="#">Links</a></td>
<td>N/A</td>
</tr> 
```

图像将其他单元格的所有其他元素向下推 24 像素。有没有人见过这个差距问题？

最终，我想删除这些图像并将它们替换为 's，并将图像作为背景图像。但是当我这样做时，仍然有一个间隙，图像似乎是空白的，神秘的。建议或类似经验将不胜感激。

![在此处输入图像描述](../Images/3c0156b22ccea04c90af120c0c0c9bfb.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T00:08:53.740

默认情况下，图像是内联元素。内联元素在底部有一点间隙，以解释字母的下降部分。您可以通过浮动图像来解决您的问题。

# java - 有没有办法在java中动态命名日志文件？

> ID：13962340
> 
> 赞同：3
> 
> 时间：2012-12-19T22:30:06.700
> 
> 标签：java, logging, slf4j, logback

我使用 logback 作为我的日志记录框架，并且有几个作业运行`main`具有不同参数的相同函数，并且希望为每个作业创建一个日志文件并用作业名称命名日志文件。

例如，如果我有`a,b,c`所有运行`MyClass.main()`但参数不同的作业，那么我希望看到`a-{date}.log, b-{date}.log, c-{date}.log`.

我可以通过在 my中`{date}`指定 a 来实现该部分，但我不确定如何（或者是否可能）动态创建文件名的前缀（作为作业的名称）。`<fileNamePattern>myjob-%d{yyyy-MM-dd}.log</fileNamePattern>``logback.xml`

有没有办法在 logback 中动态命名日志文件？是否有另一个日志框架使这成为可能？

作为一个后续问题，我是否只是采取了一种糟糕的方法来让多个作业`main`使用不同的参数调用相同的函数并且想要一个以每个作业命名的日志文件？如果是这样，是否有针对这种情况的标准/最佳实践解决方案？

编辑：我想在作业名称之后命名每个日志文件的原因是每个作业自然定义了一个“工作单元”，如果其中一个作业失败，我更容易找到合适的日志文件。我可以简单地为作业使用滚动日志文件，`a,b,c`但我发现查看日志并查明每个作业的开始和结束位置对我来说更加困难。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:34:51.257

我会使用你自己的日志记录。

```
public static PrintWriter getLogerFor(String prefix) {
     SimpleDatFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
     String filename= prefix + sdf.format(new Date());
     return new PrintWriter(filename, true); // auto flush.
} 
```

您可以编写一个简单的 LRU 缓存，例如使用 LinkedHashMap 来重用 PrintWriter。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:05:50.957

> 有没有办法在 logback 中动态命名日志文件？是否有另一个日志框架使这成为可能？

我不相信使用标准 logback.xml 文件配置的`out of the box`附加程序（`File`等）是不可能的。`RollingFile`要执行您想要的操作，您需要动态创建附加程序并将记录器分配给不同的附加程序。或者您需要发明一个新的附加程序，它足够聪明，可以根据记录器名称同时写入多个文件。

> 我是否只是采取了一种糟糕的方法来让多个作业调用具有不同参数的相同主函数并想要一个以每个作业命名的日志文件？

logback 的作者在[Mapped Diagnostic Context](http://logback.qos.ch/manual/mdc.html)`slightly discourage`部分解决了这个问题

> 将一个客户端的日志输出与另一个客户端区分开来的一种可能但稍微不鼓励的方法包括为每个客户端实例化一个新的单独的记录器。这种技术促进了记录器的扩散，并可能增加它们的管理开销。... 一种更轻的技术包括唯一地标记为给定客户端服务的每个日志请求。

然后他们继续讨论映射诊断上下文作为解决这个问题的方法。他们给出了一个 NumberCruncherServer 的例子，它同时为不同线程中的不同客户端处理数字。通过设置映射的诊断上下文和适当的日志记录模式，可以轻松确定哪些日志事件源自哪个客户端。然后，您可以简单地使用`grep`工具将感兴趣的日志记录事件分离到单独的文件中以进行详细分析。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T16:12:44.247

您可以使用 logback 鉴别器，因为鉴别器的键可以在`<FileNamePattern>`标签中使用。我可以想到两个选择：

**选项一：**

您可以使用[Mapped Diagnostic Context](http://logback.qos.ch/manual/mdc.html)鉴别器来实现日志分离，您需要使用每个作业设置一个不同的值`MDC.put();`

一旦你完成了 logback 配置上的 appender 将如下所示：

```
<appender name="SIFT" class="ch.qos.logback.classic.sift.SiftingAppender">
    <discriminator class="ch.qos.logback.classic.sift.MDCBasedDiscriminator">
        <key>jobName</key> <!-- the key you used with MDC.put() -->
        <defaultValue>none</defaultValue>
    </discriminator>
    <sift>
        <appender name="jobsLogs-${jobName}" class="ch.qos.logback.core.rolling.RollingFileAppender">
            <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
                <FileNamePattern>${jobName}.%d{dd-MM-yyyy}.log.zip</FileNamePattern>
                .
                .
                .
            </rollingPolicy>
            <layout class="ch.qos.logback.classic.PatternLayout">
                <Pattern>...</Pattern>
            </layout>
        </appender>
    </sift>
</appender> 
```

**选项二：**

实现自己的鉴别器-实现`ch.qos.logback.core.sift.Discriminator`-，根据线程名称进行鉴别。看起来像这样：

```
public class ThreadNameDiscriminator implements Discriminator<ILoggingEvent> {

    private final String THREAD_NAME_KEY = "threadName";

    @Override
    public String getDiscriminatingValue(ILoggingEvent event) {
    return Thread.currentThread().getName();
    }

    @Override
    public String getKey() {
    return THREAD_NAME_KEY;
    }

    // implementation for more methods
    .
    .
    .
} 
```

日志附加程序看起来像选项一，鉴别器类为`ThreadNameDiscriminator`，键为`threadName`。在此选项中，无需从您的作业中为 MDC 设置值，因此无需对其进行修改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T23:03:49.037

是的你可以。

首先你必须熟悉这两个概念：Logger 和 Appender。一般来说，你的代码获取一个Logger，然后调用debug()、warn()、info()等日志方法。Logger附加了Appender，Appender根据设置的配置将日志信息呈现给用户它。

熟悉后，您需要做的是为每个不同的作业类型动态创建一个具有不同文件名的 FileAppender，并将其附加到您的 Logger。

如果以上都没有意义，我建议你花一些时间阅读 logback 手册。

# iphone - Xcode 因“代码签名”错误而失败

> ID：13962341
> 
> 赞同：18
> 
> 时间：2012-12-19T22:30:13.000
> 
> 标签：iphone, ios, xcode, code-signing, xcrun

# 备用标题

（帮助搜索）

*   Xcode 'CodeSign 错误：需要代码签名'
*   Xcode：iPhone 应用程序代码设计错误
*   /usr/bin/codedesign 失败，退出代码为 1
*   Jenkins 因代码签名错误而失败
*   命令行构建失败并显示“未找到配置文件”
*   归档 Xcode 项目失败并出现配置错误
*   Xcode 中缺少签名证书

# 症状

该问题通过以下几种方式之一表现出来：

*   在设备上运行您的应用程序会导致引用“代码签名”或“签名证书过期”的错误

*   从命令行构建（或使用连续集成系统，例如[Jenkins](http://jenkins-ci.org)）失败并出现类似以下错误：

    ```
     Check dependencies
      Code Sign error: No unexpired provisioning profiles found that contain any of the keychain's signing certificates 
    ```

*   归档应用程序失败并出现“代码签名”或“签名证书过期”，其中运行或构建工作正常。

通常项目可能有多个配置，有时只有一个子集会失败。删除和重新生成配置文件无效。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-19T22:30:13.000

### [CODE_SIGN_IDENTITY 验证脚本。](https://github.com/rjstelling/Xcode-Project-Validate)

通常在使用版本控制的设置中，可以以可以插入`project.pbxproj`两行的方式合并。`CODE_SIGN_IDENTITY`这似乎在某些情况下会导致 Xcode 问题（如命令行构建或归档）。

一个tell-tail符号是`project.pbxproj`文件中与此类似的行（右键单击项目并选择“显示包内容...”）

```
"CODE_SIGN_IDENTITY[sdk=iphoneos*]" = "iPhone Developer";
CODE_SIGN_IDENTITY = "iPhone Distribution"; 
```

删除这些行之一将使您在构建设置中选择正确的值，并且项目应该再次正确构建。

我创建了简单的脚本来帮助诊断这个问题，可以在这里找到：[https ://github.com/rjstelling/Xcode-Project-Validate](https://github.com/rjstelling/Xcode-Project-Validate)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-08T23:35:52.627

我在一个开源 Github 项目中遇到了这个代码签名错误，我只想在我自己的设备上（而不是在商店或任何东西上）并且我没有付费会员帐户。

在这种情况下，同时（自 XCode 7 起）可以配置并允许您的应用程序未签名但受信任。

这一切都在这里解释：[https ://stackoverflow.com/a/4952845/828184](https://stackoverflow.com/a/4952845/828184)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-03T17:18:35.560

我有一个类似的问题，我可以在浪费了很多时间后解决。所以在这里写下我的解决方案，以防它对某人有所帮助。

我的 iOS 应用程序，过去 5 年来我一直在定期开发和部署/更新，最近遇到了类似的问题，通过 XCode Organizer 的最终“分发应用程序”开始显示错误“MyAppName.app 的代码签名失败 - 请参阅分发日志了解更多信息”。分发日志没有任何信息。

经过多次反复试验，我发现用于代码签名的证书不知何故损坏了。我[删除](https://help.apple.com/xcode/mac/current/#/dev97211aeac)了证书，它解决了问题。希望这可以帮助某人。

# c# - Linq将两个类合并为第三个？

> ID：13962342
> 
> 赞同：1
> 
> 时间：2012-12-19T22:30:13.810
> 
> 标签：c#, linq

我正在尝试将 2 个类合并到日期属性上的第三个类中，以绑定到我已经设置的图形。

```
public class Last30DaysHours
{
    public DateTime Date { get; set; }
    public float Hours { get; set; }
    public float LostHours { get; set; }
}

public class MachineHours
{
    public DateTime Date { get; set; }
    public float Hours { get; set; }
} 
```

进入

```
public class GraphLast30Days
{
    public DateTime Date { get; set; }
    public float Hours { get; set; }
    public float LostHours { get; set; }
    public float SelectedMachine { get; set; }
} 
```

到目前为止，我有这个几乎可以编译的 linq 语句。当前语句的错误是“当前上下文中不存在‘x’”。

我知道这意味着什么，但我不知道如何在语句中使其可访问。

```
IEnumerable<GraphLast30Days> last30DaysMachineHoursSelect = _last30DaysMachineHours
            .Select(p => (_last30Days
                            .Where(x => x.Date == p.Date)  <= 
                            (new GraphLast30Days { 
                                                    Date = x.Date, 
                                                    Hours = x.Hours, 
                                                    LostHours = x.LostHours, 
                                                    SelectedMachine = p.Hours 
                                                  }))); 
```

我的问题是如何使语句的后半部分可以访问 x 或者什么是更好的语句来实现相同的结果？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T22:37:56.943

你不会使用 join 按日期加入你的收藏（不确定我得到了正确的属性，但你明白了）：

```
IEnumerable<GraphLast30Days> last30DaysMachineHoursSelect = 
        from machineHours in _last30DaysMachineHours
        join last30 in _last30Days on machineHours.Date equals last30.Date
        select
        new GraphLast30Days { 
            Date = machineHours.Date, 
            Hours = machineHours.Hours, 
            LostHours = last30.LostHours, 
            SelectedMachine = machineHours.Hours
            }; 
```

或使用替代语法：

```
 var result = _last30DaysMachineHours.Join(_last30Days, graph => graph.Date, last30 => last30.Date, 
                                             (graph, last30) => new GraphLast30Days
                                                                {
                                                                        Date            = graph.Date,
                                                                        Hours           = graph.Hours,
                                                                        LostHours       = last30.LostHours,
                                                                        SelectedMachine = graph.Hours
                                                                }); 
```

如果您不想过滤掉缺失值，则需要进行左连接：

```
IEnumerable<GraphLast30Days> last30DaysMachineHoursSelect =
    from last30 in _last30Days
    from machineHours in _last30DaysMachineHours.Where (h => h.Date == last30.Date).DefaultIfEmpty()
    select
    new GraphLast30Days { 
        Date = last30.Date, 
        Hours = last30.Hours, 
        LostHours = last30.LostHours, 
        SelectedMachine = machineHours == null ? 0 : machineHours.Hours
        } 
```

# java - 抛出 Java Filenotfound 异常

> ID：13962348
> 
> 赞同：0
> 
> 时间：2012-12-19T22:30:40.250
> 
> 标签：java, io, filenotfoundexception

即使我在我所说的确切目录中有文件，也会为我的代码引发 FileNotFound 异常。我也试过`...new File("euler8.txt");...`没有成功。我的代码如下：

```
 private static void euler8() throws IOException
{   
    int current;
    int largest=0;
    int c =0;
    ArrayList<Integer> bar = new ArrayList<Integer>(0);
    File infile = new File("C:/Users/xxxxxxxx/workspace/Euler1/euler8.txt");
    BufferedReader reader = new BufferedReader(
            new InputStreamReader(
            new FileInputStream(infile),
            Charset.forName("UTF-8")));
    try
    {
        while((c = reader.read()) != -1) 
        {
            bar.add(c);
        }
    }
    finally{reader.close();}
    for(int i=0; i<bar.size(); i++)
    {
        current = bar.get(i) * bar.get(i+1) * bar.get(i+2) * bar.get(i+3) * bar.get(i+4);
        if(largest<current)
            largest = current;
    }
} 
```

它在做什么的图像：

[http://img163.imageshack.us/img163/7017/halpbk.png](http://img163.imageshack.us/img163/7017/halpbk.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T23:15:24.393

除了已建议的所有其他内容外，您可以检查您是否遇到此问题（我们在实验室中已经看到）：文件扩展名为两倍。换句话说，确保你`euler8.txt`的名字真的被称为而不是`euler8.txt.txt`，例如，因为隐藏扩展名，文件资源管理器会显示第一个，但如果你不记得它应该是第一个，它可能不会让你觉得奇怪隐藏扩展名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:44:24.313

正斜杠可以正常工作，并且是首选，因为它们可以在任何平台上工作（相对路径优于绝对路径）。确保您的路径按指定存在，并验证您对指向该文件的目录具有读取权限。例如，如果您以其他用户身份运行您的 java 程序，您可能没有“myuser”文件夹的读取权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T22:46:17.317

如果所有目录还不存在，则此代码将不起作用，因此我假设（希望我是正确的）您有错字或缺少文件夹。

我通常更喜欢`java.io.File`引用父目录，然后在后续文件引用中将其用作父目录，即：

```
File dir = new File("parentDir");
File inFile = new File(dir, "fileName"); 
```

此外，`java.io.File`有一个`exists()`返回 true 或 false 的方法，其后续`mkdir()`,`mkdirs()`和`createNewFile()`返回 true 或 false 如果它们实际创建了请求的文件。

也就是说，我将您的代码修改为以下内容，并在我的机器上执行；但我不知道你试图通过这个运行什么数据。

```
 int current;
    int largest = 0;
    int c = 0;
    ArrayList<Integer> bar = new ArrayList<Integer>(0);
    File dir = new File("C:/Users/myuser/workspace/Euler1");
    if(!dir.exists()){
        dir.mkdirs();
    }
    File infile = new File(dir, "euler8.txt");
    if(!infile.exists()){
        infile.createNewFile();
    }
    BufferedReader reader = new BufferedReader(
            new InputStreamReader(
            new FileInputStream(infile),
            Charset.forName("UTF-8")));
    try {
        while ((c = reader.read()) != -1) {
            bar.add(c);
        }
    } finally {
        reader.close();
    }
    for (int i = 0; i < bar.size(); i++) {
        current = bar.get(i) * bar.get(i + 1) * bar.get(i + 2) * bar.get(i + 3) * bar.get(i + 4);
        if (largest < current) {
            largest = current;
        }
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T22:52:37.673

反斜杠是非常不必要的。我运行了这个程序：

```
import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.nio.charset.Charset;

public class Test {
  public static void main(String[] args) throws IOException {
    File infile = new File("C:/Users/pats/workspace/test/euler8.txt");
    BufferedReader reader = new BufferedReader(new InputStreamReader(
        new FileInputStream(infile), Charset.forName("UTF-8")));
    try {
      String s;
      while ((s = reader.readLine()) != null) {
        System.out.println(s);
      }
    } finally {
      reader.close();
    }
  }
} 
```

这非常相似，它打印了我的文件的内容。

我认为您需要检查该文件是否存在以及您是否可以访问它。

# angularjs - AngularJS - 检测、停止和取消路由更改

> ID：13962351
> 
> 赞同：7
> 
> 时间：2012-12-19T22:30:55.027
> 
> 标签：angularjs

我可以在我的控制器中看到该事件`$routeChangeStart`，但我不知道如何告诉 Angular 留下来。我需要弹出类似“您要保存、删除还是取消？”之类的内容。如果用户选择取消，则停留在当前“页面”上。我没有看到任何允许侦听器取消路由更改的事件。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-20T01:25:40.510

您正在听错误的事件，我做了一些谷歌搜索，但在文档中找不到任何内容。对此的快速测试：

```
$scope.$on("$locationChangeStart", function(event){
    event.preventDefault();
}) 
```

在全局控制器中阻止了位置的改变。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-30T17:10:13.390

记录在案的方法是使用路由的 resolve 属性。

'$route' 服务文档说，如果任何 'resolve' 承诺被拒绝，就会触发 '$routeChangeError' 事件。[1](http://docs.angularjs.org/api/ng.%24route "$路由服务")这意味着您可以使用'$routeProvider' 来指定一个函数，该函数返回一个promise，如果您想阻止路由更改，该promise 稍后会被拒绝。

这种方法的一个优点是可以根据异步任务的结果来解决或拒绝承诺。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-10T23:45:14.220

```
$scope.$watch("$locationChangeStart", function(event){
    event.preventDefault(); 
}); 
```

> 你也可以这样做。这样做的好处是它不会通过带有 $on 的 if() 语句触发......正如您所看到的，无论条件是什么，下面的代码都会触发：

```
if(condition){ //it doesn't matter what the condition is true or false
  $scope.$on("$locationChangeStart", function(event){ //this gets triggered
     event.preventDefault();  
  }); 
} 
```

# asp.net-mvc - jQuery Ajax 表单提交失败

> ID：13962352
> 
> 赞同：1
> 
> 时间：2012-12-19T22:30:57.853
> 
> 标签：asp.net-mvc, jquery, jquery-mobile

我正在开发一个 MVC4 移动应用程序，它使用多个表单，这些表单通过 ajax 加载到布局的一个部分中。我已经关闭了 Ajax 的 jQuery 移动设备，因此我可以自己管理 Ajax。大多数表单工作正常，加载并通过 ajax 提交。但是，到目前为止，有一种表单拒绝触发表单提交并像其他表单一样通过 ajax 提交表单。首先，当用户单击添加联系人时会加载表单，这可以正常工作：

```
// Handle the add contact button click
$('#btnAddNewContact').on('click', function (e) {
    e.preventDefault();
    // Make sure a location was selected first.
    var locationID = $('#cboLocation').val();
    if (locationID.length === 0) {
        //$('#alertTitle').text('REQUIRED');
        $('#alertMsg').html("<p>A Contact must be associated with a Location.</p><p>Please select or add a Location first.</p>");
        $('#alertDialogDisplay').click();            
    } else {
        SaveOpportunityFormState();
        $.cookie('cmdLocationId', locationID, { path: '/' });
        $.mobile.loading('show');
        $.ajax({
            url: '/Contact/Add',
            type: 'GET',
            cache: false,
            success: function (response, status, XMLHttpRequest) {
                $('section.ui-content-Override').html(response);
                // Refresh the page to apply jQuery Mobile styles.
                $('section.ui-content-Override').trigger('create');
                // Force client side validation.
                $.validator.unobtrusive.parse($('section.ui-content-Override'));
            },
            complete: function () {
                $.cookie('cmdPreviousPage', '/Opportunity/Add', { path: '/' });                    
                AddContactLoad();
                ShowSearchHeader(false);
                $.mobile.loading('hide');
            },
            error: function (xhr, status, error) {
                // TODO - See if we need to handle errors here.
            }
        });
    }
    return false;
}); 
```

请注意，在成功加载表单后，该`AddContactLoad()`函数被触发。这工作正常，这里是代码：

```
function AddContactLoad() {
$('#contactVM_Phone').mask('(999) 999-9999? x99999');                
$('#frmAddContact').on('submit', function (e) {
    e.preventDefault();
    if ($(this).valid()) {
        $.mobile.loading('show');
        $.ajax({
            url: '/Contact/Add',
            type: 'POST',
            cache: false,
            data: $(this).serialize(),
            success: function (response, status, XMLHttpRequest) {
                if (!response) {  // Success
                    ReturnToAddOpportunity();
                } else {  // Invalid Form
                    $('section.ui-content-Override').html(response);
                    // Force jQuery Mobile to apply styles.
                    $('section.ui-content-Override').trigger('create');
                    // Force client side validation.
                    $.validator.unobtrusive.parse($('section.ui-content-Override'));
                    AddContactLoad();
                    $.mobile.loading('hide');
                }
            },
            complete: function () {

            },
            error: function (xhr, status, error) {
                // TODO - See if we need to handle errors here.
            }
        });
    }
    return false;
});
$('#btnCancel').on('click', function (e) {
    e.preventDefault();
    // See where add contact was called from.
    var previousPage = $.cookie('cmdPreviousPage');
    if (previousPage.indexOf("Detail") >= 0) {
        ReturnToOpportunityDetails();
    } else {
        ReturnToAddOpportunity();
    }
    return false;
}); 
```

}

如果我单击取消按钮，则会触发该代码，因此我知道这也可以正常工作。这是我的表单代码：

```
@using (Html.BeginForm("Add", "Contact", FormMethod.Post, new { @id = "frmAddContact" }))
{
@Html.ValidationSummary(true)
@Html.AntiForgeryToken()    

-- Form Fields Here --

<div class="savecancel" >
    <input type="submit" value="Save" data-mini="true", data-theme="b", data-inline="true" /> 
    <a href="#" id="btnCancel" data-role="button" data-inline="true" data-theme="b" data-mini="true">Cancel</a> 
</div>   
} 
```

如您所见，表单名为 frmAddContact，这就是`AddContactLoad()`函数将提交事件附加到的内容。为了保存我的唯一身份，我无法弄清楚为什么表单不像应用程序中的其他表单一样通过 ajax 帖子提交。我是否缺少某种初始化，我只是不知道。如果有人可以请帮助我真的很感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T23:12:33.997

事实证明，我为电话号码创建了一个自定义的不显眼的 Ajax 验证器，然后复制并粘贴它以对邮政编码执行相同的操作。不幸的是，在此过程中，我忘记重命名变量，因此导致问题的验证脚本中出现错误。同时，如果您正在阅读本文，您可能会记下此处的代码以及如何通过 Ajax 和 jQuery mobile 将 HTML 注入页面。我从来没有在书或网络上找到过它，它包含一些非常有用的方法和语法。在表单提交上，我检查空响应的原因是我只是从控制器返回 null 以验证表单是否有效并且保存工作在这种情况下，我将它们发送到不同的 HTML 注入，即它们最初来自的页面. 如果未返回 null，我会在该页面中注入包含原始表单和错误标记的 HTML，以便用户可以进行更正然后重新提交。我还调用了一个表单加载方法，该方法将处理程序附加到 HTML 中，一旦它被注入到主页中。希望这对某人有帮助！

# c++ - 另一个线程安全队列实现

> ID：13962353
> 
> 赞同：1
> 
> 时间：2012-12-19T22:31:04.390
> 
> 标签：c++, multithreading, pthreads, queue, mutex

我有一堂课，`Queue`我试图使线程安全。它具有以下三个成员变量：

```
 std::queue<T>   m_queue;
    pthread_mutex_t m_mutex;
    pthread_cond_t  m_condition; 
```

和一个推送和弹出实现为：

```
 template<class T> void Queue<T>::push(T value)
    {
        pthread_mutex_lock( &m_mutex );
        m_queue.push(value);
        if( !m_queue.empty() )
        {
            pthread_cond_signal( &m_condition );
        }
        pthread_mutex_unlock( &m_mutex );
    }

    template<class T> bool Queue<T>::pop(T& value, bool block)
    {
        bool rtn = false;
        pthread_mutex_lock( &m_mutex );
        if( block )
        {
            while( m_queue.empty() )
            {
                pthread_cond_wait( &m_condition, &m_mutex );
            }
        }
        if( !m_queue.empty() )
        {
            value = m_queue.front();
            m_queue.pop();  
            rtn = true;
        }
        pthread_mutex_unlock( &m_mutex );
        return rtn;
    } 
```

不幸的是，偶尔会有一些问题可能是此代码的错误。也就是说，有两个线程，有时线程 1 永远不会出来，`push()`有时线程 2 永远不会出来`pop()`（`block`参数是`true`），尽管队列不为空。

我知道还有其他可用的实现，但如果需要，我想尝试修复此代码。有人看到任何问题吗？

构造函数具有适当的初始化：

```
 Queue()
    {
        pthread_mutex_init( &m_mutex, NULL );
        pthread_cond_init( &m_condition, NULL );
    } 
```

和析构函数，相应的“销毁”调用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:46:32.907

正如 Paul Rubel 所提到的，您需要先初始化互斥锁。在这一点上，将互斥锁包装在一个将为您处理初始化和终结的类中可能是一个好主意。例如：

```
class mutex {
private:
    mutex(const mutex &m);
    mutex &operator=(const mutex &m);

    // OR inherit from boost::noncopyable
public:
    mutex() {
        pthread_mutex_init(&mut_, nullptr);
    }

    ~mutex() {
        pthread_mutex_destroy(&mut_);
    }

    pthread_mutex_t get() const { return mut_; }

private:
    pthread_mutex_t mut_;
}; 
```

值得注意的是[Boost.Threading](http://www.boost.org/libs/thread)库，其中包含编写得非常好的同步类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:27:30.697

这根本与您的问题无关，但您可以修复推送功能：

```
template<class T> void Queue<T>::push(T value)
{
    pthread_mutex_lock( &m_mutex );
    if( m_queue.empty() )
    {
        m_queue.push(value);
        pthread_cond_signal( &m_condition );
    }
    else
    {
        m_queue.push(value);
    }
    pthread_mutex_unlock( &m_mutex );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T16:00:26.413

我意识到在为 ARM 测试构建时出现了问题。解决方案是更新 pthreads 库。使用更新的 pthreads，一切运行良好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T22:34:51.927

您必须在使用前初始化互斥锁：[pthread_mutex_init](http://pubs.opengroup.org/onlinepubs/7908799/xsh/pthread_mutex_init.html)

```
//somewhere before push/pop
pthread_mutex_init(&m_mutex) 
```

# twitter-bootstrap - Bootstrap Navbar - Spyscroll 不工作和其他问题

> ID：13962356
> 
> 赞同：0
> 
> 时间：2012-12-19T22:31:25.127
> 
> 标签：twitter-bootstrap, scroll, nav

我看到了一些关于 spyscroll 问题的其他问题，但它们并不完全适用于我的情况。我正在尝试将一个简单的 spyscroll 函数应用于我网站的主页并将其应用于导航栏，但它似乎不起作用。

另外，我还想为这些相同的链接添加一个基本的滚动功能..Bootstrap 有滚动功能吗？我没有看到一个列出。最好的方法是什么？

该站点位于 debbierking.com/bootstrap。

请注意，我是 Bootstrap 的新手，我的 jquery 知识很少......

相关标记：

```
<body data-spy="scroll" data-target=".navbar">

  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">

        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
        <div class="nav-collapse">       
          <ul class="nav pull-right">
            <li class="active"><a href="#work">Work</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#contact">Contact</a></li>   
          </ul>
        </div><!-- /.nav-collapse -->

      </div><!-- /.container -->
    </div><!-- /.navbar-inner -->
  </div><!-- /.navbar -->

  <script src="js/bootstrap.js"></script>
  <script>
    $(document).ready(function() {
      $('.navbar').scrollspy()
    });
  </script>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:05:04.153

我认为问题在于您将`navbar`内部放置在`<head>`我认为没有意义的内部，引导[页面](http://twitter.github.com/bootstrap/javascript.html#scrollspy)上的示例清楚地`navbar`放置了`body`标签内部，还请检查此[示例](http://www.w3resource.com/twitter-bootstrap/scrollspy-tutorial.php)。

# xcode - 外部库 XCode

> ID：13962357
> 
> 赞同：1
> 
> 时间：2012-12-19T22:31:31.160
> 
> 标签：xcode, macos, dll, external, xcode4.5

谁能告诉我如何将库链接到 XCode 4.5 项目？

我必须将 GMP 库添加到 C++ 项目中才能使用它们的多精度数据类型。

我已经被困在这一点上很长时间了，任何评论都会有很大帮助......

**编辑：已解决**

Howto 发布在此链接：[Linking GMP to Xcode 4.5](https://stackoverflow.com/questions/13955996/linking-gmp-to-xcode-4-5)

# sql - 如何使用 IF...ELSE sql 语句进行多选？

> ID：13962358
> 
> 赞同：0
> 
> 时间：2012-12-19T22:31:41.207
> 
> 标签：sql, tsql

简单的学术项目。简单的程序。如果 Payments 表中已经存在某些内容 - 然后从该表中获取债务值，如果没有值 - 从 Tariff 表中获取它。但是为什么这样的条件不起作用呢？

```
ALTER PROCEDURE dbo.GetDebt
    (
    @LoanId int
    )
AS

    IF NOT EXISTS (SELECT top 1 * FROM Payment WHERE LoanId = @LoanId) 
    BEGIN
        SELECT (TotalLoan + ( ( TotalLoan / 100 ) * Interest))  as Debt FROM Loan L, Tariff T
        WHERE L.TariffIf = L.TariffId
    END
    ELSE
    BEGIN
        SELECT MIN(Debt) as Debt FROM Loan L 
        RIGHT OUTER JOIN Payment P -- Joins are cool.
        ON L.LoanId = P.LoanId
        WHERE P.LoanId = @LoanId 
    END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:33:34.247

像这样使用`BEGIN`和`END`围绕你的陈述：

```
IF (SELECT count(*) FROM Payment WHERE LoanId = @LoanId) = 0 
BEGIN

    SELECT (TotalLoan + ( ( TotalLoan / 100 ) * Interest))  as Debt FROM Loan L 
    RIGHT OUTER JOIN Tariff -- TODO: Add correct ON clause here
    WHERE L.LoanId = @LoanId

END
ELSE
BEGIN
    SELECT MIN(Debt) as Debt FROM Loan L 
    RIGHT OUTER JOIN Payment P -- Joins are cool.
    ON L.LoanId = P.LoanId
    WHERE P.LoanId = @LoanId 
END 
```

另请注意，您缺少一个会导致错误的`on`子句。`right outer joins`

也可能更有效地改变

```
IF (SELECT count(*) FROM Payment WHERE LoanId = @LoanId) = 0 
```

到

```
IF NOT EXISTS (SELECT * FROM Payment WHERE LoanId = @LoanId) 
```

关键词是“可能”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T22:46:34.757

If/Else 几乎总是对 sql 代码完全错误的方法。如果不了解更多有关您的表的信息，很难给您一个确切的示例，但您确实想要更像这样的东西：

```
SELECT COALESCE(P.Debt, TotalLoan + ( ( TotalLoan / 100 ) * Interest))  as Debt
FROM Loan L
LEFT JOIN Tariff T ON T.LoanID = L.LoanID
LEFT JOIN (SELECT LoanID, Min(Debt) As Debt FROM Payment GROUP BY LoanID) P
WHERE L.LoanID = @LoanID 
```

不需要 If/Else。

# mysql - 在 Rails 应用程序中存储操作列表

> ID：13962360
> 
> 赞同：3
> 
> 时间：2012-12-19T22:31:43.800
> 
> 标签：mysql, ruby-on-rails, database, web-applications

我需要一些建议。我正在制作一个学习起来有点复杂的应用程序。它有一个用户模型。用户注册后，我希望在他/她第一次（也是第一次）访问某些页面时出现一个模式对话框。例如，有“投票”页面和“创建投票”页面等。

实施此类帮助系统的最佳方式是什么？我想在我的用户模型中添加一个列，该列可以包含一个默认值列表，例如“投票、创建、共享”。当用户访问与这些操作之一相对应的页面时，如果该操作的名称仍在列表中，则会出现模式并且该操作的名称将从列表中删除。

这听起来合理吗？我知道在规范化数据库中，您不应该在单个字段中存储多个值。但是创建一个名为“actions”的表和另一个连接表来将用户与操作相关联似乎很疯狂。用户在网站上只能做 4 或 5 件事。

或者还有其他我想念的方法吗？提前感谢您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:40:46.250

您可能应该制作一个 UserTrigger 模型，该模型可用于“触发”这样的某些操作。在实践中它看起来像这样：

```
<% for_trigger(@user, :first_time_help) do %>
...help content...
<% end %> 
```

此方法的定义大致如下：

```
def for_trigger(model, name)
  if (model.triggers.where(:name => name.to_s).delete_all > 0)
    yield
  end
end 
```

较软的版本将有一个`should_trigger?`和`did_trigger!`方法对，其中一个将测试，另一个将实际删除触发器记录。对于大多数情况，这个单发应该足够好。

您的用户模型中的定义大致如下：

```
class User < ActiveRecord::Base
  has_many :triggers,
    :class_name => 'UserTrigger'
end

class UserTrigger < ActiveRecord::Base
  belongs_to :user
end 
```

`after_create`您必须在您的用户模型或任何其他需要它的模型上预先填充这些触发器记录。要重新设置触发器，只需重新添加记录。

# iphone - 可以使用 MDM 安装配置文件

> ID：13962361
> 
> 赞同：5
> 
> 时间：2012-12-19T22:31:52.793
> 
> 标签：iphone, provisioning, mdm

Apple 的移动设备管理协议参考第 44 页底部的状态

> 第三方企业应用程序需要配置文件才能运行。您可以使用 MDM 提供这些配置文件的最新版本，这样用户就不必手动安装这些配置文件、在配置文件过期时替换它们等等。为此，请通过 MDM 提供配置文件，而不是通过您的公司 Web 门户分发它们或与应用程序捆绑在一起。

这是否意味着我应该在安装之前从应用程序中删除或解绑 Embedded.mobileprovision？

或者这是否意味着，

在安装应用程序之前通过 MDM 服务器单独安装配置文件？

如果答案是第一个，如何在不破坏应用程序的情况下删除 Embedded.mobileprovision。如果答案是第二个，那么后续更新应用程序是否会弄乱 MDM 服务器安装的配置文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T02:09:16.507

第二个。MDM 服务器在安装应用程序之前在设备上安装配置文件。它通常是使用 MDM “设置设备”的一部分。

在那之后安装或更新应用程序将通过 MDM 完成，所以一切都保持不变。

更新的配置文件会被放在 MDM 上（由开发人员/管理员），然后用户设备上的 MDM 应用程序会通知用户更新。他们点击更新按钮，下载并安装新的配置文件。

**编辑 2014 年 3 月 12 日：** Apple 推出了设备注册计划 (DEP)，该计划现在允许“无接触”安装 MDM 配置文件、设置监督和静默安装应用程序，而无需将设备开箱即用。该系统基于：

1.  公司帐户购买所有设备（Apple 维护属于公司/帐户的序列号列表）
2.  公司告诉 Apple 哪个 MDM 有权进行更改。
3.  公司将 MDM 链接到 Apple。
4.  MDM 现在向 Apple 发送请求，Apple 向设备发送请求。

这将允许我们只拧，呃设置，我们购买的设备。有一些方法可以“切换”设备/序列号的所有权，它们并非都是在同一个帐户下购买的。

# dashboard - 开发指标仪表板

> ID：13962368
> 
> 赞同：0
> 
> 时间：2012-12-19T22:32:38.607
> 
> 标签：dashboard

我需要一个私人的、托管我自己的、在防火墙后面的仪表板，比如 Geckoboard 或 Ducksboard。

Atlassian 产品的小部件、Git、基于 Junit 的结果和 Splunk 将是理想的。

更多上下文 - Geckoboard 和 Ducksboard 对我来说看起来很棒，但我的 Atlassian 产品、Git 等都在防火墙后面。不能为 Geckoboard、Ducksboard 等打开防火墙。

我知道他们都有可以将数据推送到的 API，但我真的不想为上述产品编写自定义 REST 调用。

知道我可以在本地安装的任何类似仪表板吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-23T05:06:26.890

您可以查看 Dashing [http://shopify.github.io/dashing/](http://shopify.github.io/dashing/)

这是一个由 Shopify 人员编写的仪表板，用 Ruby 编写。

您可以在下面的链接中看到它支持的小部件列表，尽管我知道它并没有真正涵盖您所追求的内容。但是您应该能够编写自己的小部件。

[https://github.com/Shopify/dashing/wiki/Additional-Widgets](https://github.com/Shopify/dashing/wiki/Additional-Widgets)

我只玩了一点点，但似乎很容易上手。

# ruby - Ruby 模块变量访问器未按预期工作

> ID：13962369
> 
> 赞同：2
> 
> 时间：2012-12-19T22:32:41.593
> 
> 标签：ruby

所以我想要一个带有变量和访问方法的模块。
我的代码看起来像这样

```
module Certificates
  module Defaults

  class << self
    attr_accessor :address

    def get_defaults
      address = "something"
      make_root_cert
    end

    def make_root_cert
      blub = address
      # do somthing
    end
  end
end 
```

我用撬棒检查了它。
结果是

*   Certificates::Defaults 具有称为 address 和 address= 的方法。
*   如果我在 get_defaults 方法中调用地址，它会按预期返回“某物”
*   如果我在 make_root_cert 中调用它，它会返回 nil

我在另一个模块中使用了这种 attr_accessor 创建方式，并且效果很好。我希望我只是误解了 ruby​​ 的工作方式，有人可以解释为什么这个例子不起作用。也许使用 ruby​​ 对象模型的实现细节。

杰里米是对的。

## 我的发现

这对我来说似乎不一致。

*   如果您使用表达式“地址”并且未设置实例变量，则返回局部变量
*   如果已设置实例变量且未设置局部变量，则返回实例变量。
*   如果两者都已设置，则返回局部变量。

另一方面 address="test"**总是**设置局部变量。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T22:36:52.453

在您的`get_defaults`方法中，`address`是一个局部变量。要使用 setter，您必须输入以下内容：

```
self.address = "something" 
```

这将正确调用该`address=`方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-22T09:01:11.097

之所以会出现这种相当混乱的行为，是因为 Ruby 解释器将局部变量定义置于比方法调用更高的优先级。这里有一致性，但除非你事先知道它是如何工作的，否则很难看清楚。

鉴于 Ruby 中的很多东西都是对象和方法调用，因此很自然地假设变量定义是某种在某物（如内核或 main 或定义它的对象或其他任何东西）上调用的某种方法，并且结果变量是某种对象。如果是这样的话，你会猜测解释器会根据方法查找的规则解决变量定义和其他方法之间的名称冲突，并且如果它没有找到同名的方法，只会定义一个新变量首先是潜在的变量定义。

但是，变量定义不是方法调用，变量也不是对象。相反，变量只是对对象的引用，变量定义是解释器在语言表面下跟踪的东西。这就是为什么`Kernel.local_variables`返回一个符号数组，而没有办法获得某种局部变量对象的数组。

因此，Ruby 需要一组特殊的规则来处理变量和方法之间的名称冲突。非局部变量有一个特殊的前缀来表示它们的作用域（$、@ 等），它可以解决这个问题，但对于局部变量则不然。如果 Ruby 在方法之后需要括号，那也可以解决这个问题，但我们可以不必这样做。为了方便地引用不带前缀的局部变量和调用不带括号的方法，该语言默认假设您需要局部变量，只要它在范围内。它本来可以设计成另一种方式，但是你会遇到奇怪的情况，你定义了一个局部变量，并且它在程序中途被一些具有相同名称的遥远方法立即黯然失色，所以这样可能更好。

[*Ruby 编程语言*](http://shop.oreilly.com/product/9780596516178.do)，p。88，有这个说法：

> "...局部变量没有标点符号作为前缀。这意味着局部变量引用看起来就像方法调用表达式。如果 Ruby 解释器看到对局部变量的赋值，它知道它是一个变量并且`NameError`“ _

它继续解释为什么你`nil`在打电话`address`时得到`make_root_cert`：

> “因此，一般来说，在初始化之前尝试使用局部变量会导致错误。有一个怪癖——当 Ruby 解释器看到该变量的赋值表达式时，变量就会存在。即使是这种情况如果该赋值没有实际执行。存在但尚未赋值的变量将被赋予默认值`nil`。例如：
> 
> ```
>  a = 0.0 if false # This assignment is never executed
>    print a          # Prints nil: the variable exists but is not assigned
>    print b          # NameError: no variable or method named b exists" 
> ```

您使用的 setter 方法会`attr_accessor`导致解释器在调用 setter 方法之前创建一个变量，但必须调用它才能为该变量分配除`nil`. `address = "something"`in在被调用的方法中`get_defaults`定义了一个局部变量，该变量在方法`address`结束时超出范围。当你调用`make_root_cert`时，没有局部变量调用`address`，所以`address`你得到的getter方法`attr_accessor`被调用并返回`nil`，因为setter方法没有被调用给它一些其他值。`self.address=`让解释器知道您需要类方法`address=`而不是新的局部变量，从而解决歧义。

# c# - ASP.NET C# 登录时显示地址详细信息

> ID：13962370
> 
> 赞同：1
> 
> 时间：2012-12-19T22:32:41.347
> 
> 标签：c#, asp.net

在我的网站上，我试图让我的网站显示用户的地址详细信息，如果他们登录已经尝试了一个存储过程：

```
ALTER PROCEDURE dbo.showAddress
    @userid nvarchar(256)
AS
    SELECT Fullname, Address, County, Postcode FROM Addresses WHERE @userid = UserId
RETURN 
```

但我得到了一个关于期待用户 ID 的区域？我尝试通过后面的代码插入：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (User.Identity.IsAuthenticated)
    {
        SqlCommand oCMD = new SqlCommand();
        SqlConnection oCON = new SqlConnection();
        oCON.ConnectionString = ConfigurationManager.ConnectionStrings["ApplicationServices"].ConnectionString;
        oCON.Open();
        oCMD.Connection = oCON;
        oCMD.CommandType = CommandType.StoredProcedure;
        oCMD.CommandText = "showAddress";

        SqlDataReader oRDR = oCMD.ExecuteReader();
        oRDR.Read();
        txtName.Text = oRDR.GetString(oRDR.GetOrdinal("Fullname"));
        oCON.Close();
    }
} 
```

但这对我也不起作用。是否有一些代码可以输入如下：

txtPostcode.Text = "sql 连接；地址；全名";

任何帮助或建议表示赞赏....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:41:57.000

在我看来，您没有将 useid 参数传递给存储过程。

```
oCMD.Parameters.Add(new SqlParameter("@userId", User.UserId));//plz check the User object to find the id 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:39:02.323

在您的 C# 中，您需要添加 @userid 作为参数以传递给存储过程。

```
oCMD.Parameters.Add(new SqlParameter("@userid", userid)); 
```

显然，您需要从某个地方获取用户 ID，例如 User.Identity 对象。

# grails - g:include 在 _header.gsp 中不起作用

> ID：13962371
> 
> 赞同：1
> 
> 时间：2012-12-19T22:32:46.623
> 
> 标签：grails

我正在维护一个 grails 1.1.1 应用程序。如果我们从常规 gsp 中包含，则有一个包含代码可以工作。但是当我尝试从 _header.gsp 中包含它时，它不起作用。我使用完全相同的语句。它实际上调用了控制器中的方法，但视图中没有返回任何内容。以下是从常规 gsp 工作的代码

```
 <g:include controller="abcGenericComponent" action="visitOurBoardsComponent" /> 
```

这是控制器中的方法

```
def visitOurBoardsComponent = {
    def visitOurBoardsContent = abcGenericComponentService.getVisitOurBoardsComponent(request)
    log.debug "Calling vistitboards ${visitOurBoardsContent}"
    [visitOurBoardsContent: visitOurBoardsContent]
} 
```

日志语句显示在日志中。这意味着该方法正在执行。

这是包含的 gsp

```
<ul>
<g:each var="ourBoards"
        in="${visitOurBoardsContent}">

    <li>

        <a href="${ourBoards?.url}">${ourBoards?.displayName} </a>

    </li>

</g:each> 
```

# assembly - 我需要帮助才能理解这些组装说明

> ID：13962372
> 
> 赞同：0
> 
> 时间：2012-12-19T22:32:46.170
> 
> 标签：assembly

我发现这个 asm 指令在调用之前将参数推入堆栈，但我认为有一些无用的指令。

```
mov eax,esi
neg eax
sbb eax,eax
lea ecx,[esp+10h]
and eax,ecx
push eax 
```

我可以用以下内容替换这些说明：

```
lea ecx,[esp+10h]
push ecx 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:43:38.830

不，我不相信你所拥有的是等价的。`sbb`指令可能保留为零（全为 0 位）或负一（全为 1 位），这肯定会影响从指令中`eax`提取的值发生的情况。`ecx``and`

看起来原始代码将推送`esp+10h`或`0`，这取决于`esi`开始的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T06:13:46.823

您可以将这些指令替换为

```
lea  eax, [esp+10]
test esi, esi
cmovz eax, esi    ;; push zero (i.e. esi) iff esi==0
push eax 
```

或者

```
 test esi, esi
       jz   skip
       lea  esi, [esp+10]
skip:  push esi 
```

Neg 将从 0 中减去 eax 并产生进位标志，除非 eax==0; 设置进位标志时， sbb a,a 产生 -1（否则为 0），用作选择掩码。尚不清楚 cmov 指令是否会比分支更快。

# c# - .Net 是否有任何“暗启动”框架或库？

> ID：13962379
> 
> 赞同：4
> 
> 时间：2012-12-19T22:33:49.473
> 
> 标签：c#, asp.net, .net, asp.net-mvc, web

我希望开始在我们的生产站点（ASP.Net Webforms / MVC）中进行黑暗启动和加速。.Net 是否有任何现有的库或框架可以帮助解决这个问题，还是我只需要自己动手？

澄清：

我想构建一个功能并将其推送到生产中，而用户不会看到它，然后能够为特定用户、用户组、客户等打开或关闭该功能。

**编辑**

为此，可以使用其他语言的库/框架。

例子：

*   红宝石：[https ://github.com/jamesgolick/rollout](https://github.com/jamesgolick/rollout)
*   Python：[https ://github.com/asenchi/proclaim](https://github.com/asenchi/proclaim)

我即将开始建造一个，但想确保我不会重新发明轮子。

我的问题是：.Net 框架是否有类似的库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T14:25:21.743

看起来要搜索的术语不是“暗启动”，而是“功能鳍状肢”。我现在在 .Net 中找到了几个可以执行此操作的库：

*   Michael Sarchet 的鳍状肢：[https ://github.com/msarchet/flipper](https://github.com/msarchet/flipper)
*   蒂姆·斯科特的 FlipIt：[https ://github.com/timscott/flipit](https://github.com/timscott/flipit)

# visual-studio-2010 - app_code 文件夹

> ID：13962380
> 
> 赞同：0
> 
> 时间：2012-12-19T22:33:51.920
> 
> 标签：visual-studio-2010, app-code

通常，在更改代码隐藏时，我只复制 bin 文件夹中的 dll 文件来更新网站。

我对位于 app_code 文件夹中的代码文件进行了更改。

我已经发布了站点并使用大量 app_webxxx.dll 文件更新了 bin 文件夹。

现在我得到一个解析器错误：无法加载程序集'App_Web_syn42ext

是否可以只更新 dll 文件，还是每次我进行更改以使网站运行时都需要更新所有 aspx 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T05:36:14.253

你也需要这样做，你也需要更新网页，因为如果你在aspx页面中发布网页时会看到，在header标签上，cs文件的引用会自行升级。因此，每当您发布时，都会生成一些随机的 giud 并将其附加到文件名，基本上它引用名称空间。

因此，您还需要更新网页。

# ruby-on-rails - Rails 解析表单输入

> ID：13962383
> 
> 赞同：2
> 
> 时间：2012-12-19T22:34:22.470
> 
> 标签：ruby-on-rails

我正在使用一个表单将一些数据从控制器的一个部分传输到另一个部分（新创建），但我遇到了一些麻烦。当我在提交表单后尝试获取数据时，它只是给了我一个 nil 值。

这是表单代码：

```
<%= f.hidden_field :owner_id, :value => @tool.user_id %>
<%= f.hidden_field :tool_id, :value => @tool.id %>
<%= f.hidden_field :borrower_id, :value => current_user.id %> 
```

这是控制器中的创建操作：

```
 def create
    render text: params[:rental_agreement].inspect
    @rental_agreement = RentalAgreement.create
    @rental_agreement.owner_id = params[:owner_id]
    # render text: @rental_agreement.inspect
  end 
```

当我点击表单上的“提交”按钮时，我看到：

```
{"owner_id"=>"3", "tool_id"=>"1", "borrower_id"=>"4"} 
```

这很好，但是当我更改哪个检查呈现（注释掉顶行，取消注释底部）时，它显示的只是：

```
# 
```

如果我在 Rails 控制台中查看这个对象，其中的所有字段都是 nil（除了 id 和 created_at 字段）。

我只是想弄清楚如何将表单中的变量（owner_id、tool_id 和borrower_id）分配给rental_agreement 变量。任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:38:10.143

您的 create 方法似乎错误。试试这个。

```
def create
  @rental_agreement = RentalAgreement.new(params[:rental_agreement])
  @rental_agreement.save
end 
```

# eclipse - Eclipse Indigo STS + JBoss 工具

> ID：13962390
> 
> 赞同：2
> 
> 时间：2012-12-19T22:34:54.997
> 
> 标签：eclipse, spring, jboss-tools

我无法在我的 Indigo 上安装 JBoss Tools。我打开超市并为我的 Eclipse 安装当前版本，或者我尝试从链接（http://download.jboss.org/jbosstools/updates/stable/indigo/）打开安装新软件，但我仍然遇到同样的错误：

```
Cannot complete the install because of a conflicting dependency.
  Software being installed: JBoss Central Community 1.0.1.v20120715-0355-H112-Final (org.jboss.tools.community.central.feature.feature.group 1.0.1.v20120715-0355-H112-Final)
  Software currently installed: Spring IDE AOP Extension (optional) 3.1.0.201210040510-RELEASE (org.springframework.ide.eclipse.aop.feature.feature.group 3.1.0.201210040510-RELEASE)
  Only one of the following can be installed at once: 
    Mylyn Commons UI 3.8.1.v20120725-0100 (org.eclipse.mylyn.commons.ui 3.8.1.v20120725-0100)
    Mylyn Commons UI 3.6.1.v20110720-0100 (org.eclipse.mylyn.commons.ui 3.6.1.v20110720-0100)
    Mylyn Commons UI 3.8.2.v20120916-1200 (org.eclipse.mylyn.commons.ui 3.8.2.v20120916-1200)
    Mylyn Commons UI 3.8.0.v20120612-0600 (org.eclipse.mylyn.commons.ui 3.8.0.v20120612-0600)
    Mylyn Commons UI 3.6.0.v20110608-1400 (org.eclipse.mylyn.commons.ui 3.6.0.v20110608-1400)
  Cannot satisfy dependency:
    From: JBoss Central 1.0.1.v20120715-0355-H112-Final (org.jboss.tools.central 1.0.1.v20120715-0355-H112-Final)
    To: bundle org.eclipse.mylyn.commons.ui [3.6.0,3.8.0)
  Cannot satisfy dependency:
    From: JBoss Central 1.0.1.v20120715-0355-H112-Final (org.jboss.tools.central.feature.feature.group 1.0.1.v20120715-0355-H112-Final)
    To: org.jboss.tools.central [1.0.1.v20120715-0355-H112-Final]
  Cannot satisfy dependency:
    From: JBoss Central Community 1.0.1.v20120715-0355-H112-Final (org.jboss.tools.community.central.feature.feature.group 1.0.1.v20120715-0355-H112-Final)
    To: org.jboss.tools.central.feature.feature.group 1.0.0.qualifier
  Cannot satisfy dependency:
    From: Spring IDE AOP Extension (optional) 3.1.0.201210040510-RELEASE (org.springframework.ide.eclipse.aop.feature.feature.group 3.1.0.201210040510-RELEASE)
    To: org.springframework.ide.eclipse.feature.feature.group 0.0.0
  Cannot satisfy dependency:
    From: Spring IDE Configuration Graphical Editing 3.1.0.201210040510-RELEASE (org.springframework.ide.eclipse.config.graph 3.1.0.201210040510-RELEASE)
    To: bundle org.eclipse.mylyn.commons.ui [3.7.0,4.0.0)
  Cannot satisfy dependency:
    From: Spring IDE Core (required) 3.1.0.201210040510-RELEASE (org.springframework.ide.eclipse.feature.feature.group 3.1.0.201210040510-RELEASE)
    To: org.springframework.ide.eclipse.config.graph [3.1.0.201210040510-RELEASE] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-23T10:38:11.203

请尝试 Eclipse 3.7.2 Platform Runtime Binary INDIGO SR2 IDE for JAVA EE DEVELOPERS

然后去JBOSS工具。

按照这个链接 [http://www.jboss.org/tools/download/installation/update_3_3](http://www.jboss.org/tools/download/installation/update_3_3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-30T20:23:04.867

使用 Eclipse 靛蓝。

我先安装了 STS 插件。

然后当我尝试安装 Jboss 工具插件时。我收到了同样的错误。

我取消选中 JBoss Central Community 和 JBoss Tools Common - Mylyn。按下一步（这次没有错误）。

这样做之后，您必须重新启动 IDE。您现在应该拥有这两个插件。

# c# - 对列表进行分组和求和

> ID：13962393
> 
> 赞同：7
> 
> 时间：2012-12-19T22:35:04.800
> 
> 标签：c#, linq, lambda

我有这个`List<object[]>`

```
List<object[]> olst = new List<object[]>();

olst.Add(new object[] { "AA1", 1 });
olst.Add(new object[] { "AA2", 1 });
olst.Add(new object[] { "AA2", 1 });
olst.Add(new object[] { "AA1", 1 });
olst.Add(new object[] { "AA1", 1 }); 
```

从 开始`olst`，我需要制作一个新`List<object>`的来保存这个：

```
"AA1", 3
"AA2", 2 
```

换句话说，我需要对**olst[x][0]**进行分组并总结**olst[x][1]**。
我可以使用 for 循环，但我希望有人可以帮助我使用 lambda 表达式和/或 linq 来完成此操作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T22:45:10.033

使用[`GroupBy`](http://msdn.microsoft.com/en-us/library/bb534501.aspx)和[`Select`](http://msdn.microsoft.com/en-us/library/bb548891.aspx)：

```
List<object[]> newList = olst
    /* Group the list by the element at position 0 in each item */
    .GroupBy(o => o[0].ToString())
    /* Project the created grouping into a new object[]: */
    .Select(i => new object[]
    {
        i.Key,
        i.Sum(x => (int)x[1])
    })
    .ToList(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:50:20.187

这会将您的列表转换为从第一个值到具有相同第一个值的第二个值之和的字典映射。

```
var result = olst.GroupBy(entry => (String)entry[0])
                 .Select(group => new Object[]
                                  {
                                      group.Key,
                                      group.Sum(item => (Int32)item[1])
                                   })
                 .ToList(); 
```

我错过了说明结果应该是包含类型`List<Object>`的部分`Object[]`。如果反对者对原因发表评论会有所帮助。;)

# windows-phone-8 - 是否有适用于 WP8 应用程序的认证工具包？

> ID：13962397
> 
> 赞同：3
> 
> 时间：2012-12-19T22:35:26.377
> 
> 标签：windows-phone-8, app-certification-kit

我正在开发一个针对新 WP8 平台的新应用程序。

以前版本的 Phone SDK，如 WP7.1 或 WP7.5 SDK 包含特殊的工具包，用于在提交之前测试您的 XAP 是否存在一些明显的问题（如缺少一些强制图像文件）。

WACK for Win8 Desktop Apps 实现了类似的功能。

但是我找不到任何工具包来测试我的 WP8 应用程序。我发现的唯一选项是“Windows Phone 应用程序分析”为我提供了一些性能信息，但似乎没有对执行的 XAP 包进行基于静态规则的检查。

我错过了一些软件安装吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-19T22:47:19.030

对于 WP8 应用程序，在 VS2012 解决方案资源管理器中右键单击您的项目 ---> 单击“打开商店测试工具包”。[您可以在 MSDN @ http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh394032(v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh394032(v=vs.105).aspx)上阅读更多关于正在测试的内容

![开店测试套件](../Images/5a11d8ee58be345962f94e345ca12df3.png)

# css - Google Maps api v3 工具：视觉扭曲？

> ID：13962398
> 
> 赞同：22
> 
> 时间：2012-12-19T22:35:34.247
> 
> 标签：css, google-maps-api-3, css-position, appearance

我刚刚注意到 gMap 视图工具正在显示……相当不寻常。他们的区域似乎仍然被正确定义——我可以和他们互动，只是他们的外表看起来很乱。

我没有对任何地图块应用任何 CSS，我应用到地图容器的唯一 css 是`width:100%; height:100%; z-index:0;`（我通常这样做）。

我在页面上确实有其他元素，它们有`position:absolute;`和`position:fixed;`以及一些高`z-index`s（500 和 1000）。它们是否可能导致地图工具的视觉失真？

我在最新版本的 Chrome、Chrome Canary、Ffx、Safari 和 Opera（在 Mac OSX 上）中看到了同样奇怪的视觉失真。

我检查了开发工具/萤火虫，没有意外的 CSS 被应用到地图的容器或直接应用到它的工具。

![Google Maps Api v3：地图界面工具](../Images/e42dc4417614078c963a79fb8cbb5dd2.png)

这是确切的 HTML（我去掉了其他元素和 css，但奇怪的事情仍然发生）：

```
<html style="width:100%;height:100%;">
    <head>
        <link rel="stylesheet" href="shared/bootstrap/css/foundation.min.css">
        <link rel="stylesheet" href="shared/bootstrap/css/v2.2.2.min.css">
        <script
            type="text/javascript"
            src="http://maps.googleapis.com/maps/api/js?key=...">
        </script>
        <script type="text/javascript">
            function ginit() {
                var vancouver = new google.maps.LatLng(49.285415,-123.114982);
                var mapOptions = {
                    center: vancouver,
                    zoom: 15,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                var map = new google.maps.Map(
                    document.getElementById("map"),
                    mapOptions
                );
                var infowindow = new google.maps.InfoWindow(),
                    marker;
            }//ginit()
        </script>
    </head>
    <body onload="ginit();" style="width:100%;height:100%;">
        <div id="map" style="width:100%;height:100%;"></div>
    </body>
</html> 
```

***编辑***：看来问题来自 Foundation 和 Bootstrap 的组合：删除任何一个都可以解决问题。同样，页面上没有来自库的引用类的元素也没有关系，它会导致失真。

我试图把它放在一个小提琴中，但我无法加载 jsfiddle.net。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-01-13T18:50:03.630

对于面临同样问题的未来用户，这里是修复。

```
#map img{max-width: inherit;} 
```

像其他答案一样，这是最大宽度的问题。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-12-20T00:48:35.233

`{ img max-width:100% }`用于 Google 地图画布的Bootstrap 和 Foundation 集。这会导致地图控件出现失真。将 css 更改为`max-width:none;`. [[来源](https://github.com/twitter/bootstrap/issues/1552)]

**警告**：显然`img { max-width: 100% … }`对于响应式布局的图像自动调整大小是不可或缺的，因此请谨慎使用。[[来源](https://github.com/twitter/bootstrap/issues/1506#issuecomment-3757143)]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-18T14:36:44.347

Foundation 5 不仅破坏了 gmap，还破坏了 MapQuest。幸运的是 Goomap 和 Quest 都有类允许我们重载 F5 行为仅用于地图显示。

```
.google-map {
  height: 400px;  // no default height
  color: #191970; // default color for both text and background is white !!!
}

.quest-map {
  height:400px; 
  color: #191970;
}

// Fix Foundation bug with MapQuest
.mqa-display {
  img {max-width: none;}
  label { width: auto; display: inline; }
}

// Fix Foundation bug with GoogleMap
.gm-style {
  img { max-width: none; }
  label { width: auto; display: inline; }
} 
```

# c# - 二进制序列化重新加载 DLL 类

> ID：13962399
> 
> 赞同：0
> 
> 时间：2012-12-19T22:35:46.903
> 
> 标签：c#, serialization, dll

我正在尝试制作一个棋盘游戏框架，将每个游戏作为它们自己的插件类加载（通过依赖注入）。每个“游戏”都将是它自己的 DLL。因此，该插件处理加载游戏中“棋子”的正确资源、游戏板的正确图像、游戏所需的任何特殊逻辑等。

我建议的文件夹结构是

```
game.exe
plugins/
    /plugin1
        /textures
        plugin1.dll

    /plugin2
        /textures
        plugin2.dll 
```

当您开始游戏时，我让您使用文件管理器加载正确的dll（将来会完善），并且当其他客户端连接到您时，它会使他们也加载插件，或者无法连接如果你也没有那个游戏的dll。

加载代码示例如下：

```
Assembly assembly = Assembly.LoadFile(openPlugin.FileName);

string fullTypeName = "TestPlugin.TestPlugin";
Type dllType = assembly.GetType(fullTypeName);
IPlugin myType = (IPlugin)Activator.CreateInstance(dllType); 
```

我现在使用硬编码字符串作为类型名称，但这最终会改变。

为了和其他人一起玩，有一种网络架构，主要包括使用对象的二进制序列化。问题是当我反序列化插件 dll 中的类的对象时，系统想要从文件中重新加载 dll。当它尝试重新加载它时，它遵循正常规则并在 exe 目录中查找 dll（如果我将插件 dll 移动到主目录，这一切都有效）。

如果有帮助，这是二进制序列化的示例

```
public Stream SerializeObject(object obj)
{
    Stream stream = new MemoryStream();

    BinaryFormatter formatter = new BinaryFormatter();

    formatter.Serialize(stream, obj);

    return stream;
}

/// <summary>
/// Deserializes Objects
/// </summary>
/// <param name="stream">Stream containing the binary objects</param>
public T DeserializeObject<T>(byte[] data)
{
    Stream stream = new MemoryStream(data);
    IRemotingFormatter formatter = new BinaryFormatter();

    return (T)formatter.Deserialize(stream);
} 
```

我希望我可以让它不那么开放，但是我能做些什么来解决这个问题并保持我想要的目录结构？- 制作某种形式的自定义加载器以通过插件/递归搜索？- 为二进制序列化选择不同的方法？- 当我“加载”时，我是否没有正确地将类加载到“内存”中以供将来使用？

如果你读到这篇文章并说‘他为什么要那样做？:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:39:42.163

1）使用`Assembly assembly = Assembly.LoadFrom("dllPath");`代替`Assembly.LoadFile()`

2）由于你的插件有不同的名字，你可以把它们放在一个目录下，并在 app.config 中定义到这个目录的路径。

3）在主 AppDomain 之外加载 Dll 可能是个好主意，这样您就可以在不重新启动应用程序的情况下卸载它们，请参阅我的示例[here](https://stackoverflow.com/questions/13663068/how-to-find-dll-files-containing-nunit-tests/)

# mysql - 复杂的 mySQL 查询顺序

> ID：13962403
> 
> 赞同：10
> 
> 时间：2012-12-19T22:36:21.630
> 
> 标签：mysql

示例数据：

```
╔════╦════════════╦════════════╦═══════╦══════════ ═╦════════╗
║ ID ║ 开始 ║ 停止 ║ 用户 ║ 文件 ║ 大小 ║
╠════╬════════════╬════════════╬═══════╬══════════ ═╬════════╣
║ 1 ║ 1330133409 ║ 1330133410 ║ user1 ║ file1.zip ║ 300000 ║
║ 2 ║ 1330133409 ║ 1330133410 ║ user1 ║ file2.zip ║ 300500 ║
║ 3 ║ 1330133409 ║ 1330133410 ║ user2 ║ file1.zip ║ 300000 ║
║ 4 ║ 1330133409 ║ 1330133410 ║ user2 ║ file2.zip ║ 300500 ║
║ 5 ║ 1330133409 ║ 1330133410 ║ user1 ║ file3.zip ║ 500000 ║
║ 6 ║ 1330133409 ║ 1330133310 ║ user6 ║ file3.zip ║ 500000 ║
╚════╩════════════╩════════════╩═══════╩══════════ ═╩════════╝

```

我需要创建一个计算`PER_USER_AVERAGE_BANDWIDTH`where的 MySQL 查询，`PER_USER_AVERAGE_BANDWIDTH = SUM(SIZE) / (STOP - START)`然后按顺序`PER_USER_AVERAGE_BANDWIDTH`生成如下结果：

```
╔═══════╦════════════════════════════╗
║ 用户 ║ PER_USER_AVERAGE_BANDWIDTH ║
╠═══════╬════════════════════════════╣
║ 用户3 ║ 110.37 ║
║ 用户 1 ║ 100.25 ║
║ 用户 2 ║ 75.70 ║
╚═══════╩════════════════════════════╝

```

像泥一样清澈；）有人吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:53:22.963

直接平均

```
SELECT 
  `user`,
  AVG( size / ( stop - start ) ) per_user_average_bandwidth
FROM
  tab_dl
GROUP BY `user`
ORDER BY per_user_average_bandwidth DESC 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/67d0c/1/0)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:42:43.957

我认为您的平均值应该是总大小超过总持续时间，按用户分组：

```
SELECT   USER,
         SUM(SIZE) / SUM(STOP - START) AS PER_USER_AVERAGE_BANDWIDTH
FROM     my_table
GROUP BY USER
ORDER BY PER_USER_AVERAGE_BANDWIDTH DESC 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/df2e0/3/0)上查看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:44:16.677

这个查询应该这样做：

```
SELECT USER, (SUM(SIZE) / (STOP - START)) AS PER_USER_AVERAGE_BANDWIDTH
FROM table
GROUP BY USER, stop, start
ORDER BY PER_USER_AVERAGE_BANDWIDTH DESC 
```

这将为您提供每个唯一时间范围内每个用户的平均带宽（即，如果用户在时间 1 和时间 5 之间下载文件 1 和文件 2 以及在时间 1 和时间 10 之间下载文件 3，您将为用户获得 2 行）。

# android - Android Google Maps Api V2、GPS 位置监听器和地理编码

> ID：13962404
> 
> 赞同：0
> 
> 时间：2012-12-19T22:36:27.750
> 
> 标签：android, geolocation, gps, locationlistener, google-maps-android-api-2

***注意：这个问题与 MapView、MapViewActivity 或 GeoPoints 无关，该 api 已被弃用***

你好，

我在使用 android google maps api v2 时遇到问题。具体来说，我想确保地图在我的位置移动时平移，并且我想监听这些事件，以便获取该位置的字符串地址以及经度和纬度。

我现在肯定会得到这个，但我想听听变化。

我的问题是我只是不确定新地图做了多少以及该`LocationSource`对象将为我做什么。示例应用程序根本不使用 GPS。

我不确定是否需要实现 LocationListener 来访问 GPS 硬件。

我需要能够平移地图并即时获取地理编码地址（通过在检测到地图移动后运行地理编码方法）

有没有人使用 android google maps v2 进行地理编码？我现在在：

a) 不确定 LocationSource 是否真的在监听运动变化

b) 如何让我的地图对象发生移动变化以更新屏幕、坐标和运行地理编码

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T00:10:36.100

> a) 不确定 LocationSource 是否真的在监听运动变化

*如果您*正在使用`setLocationSource()`. 您将`OnLocationChangedListener`在您的`activate()`方法（`LocationSource`界面的一部分）中传递一个。当您获得新的位置修复时，您需要通过您选择的任何方式（例如，GPS）调用`onLocationChanged()`它。`OnLocationChangedListener`

> b) 如何让我的地图对象发生移动变化以更新屏幕、坐标和运行地理编码

通过调用`onLocationChanged()`，`OnLocationChangedListener`将`GoogleMap`通知新位置，如果该位置当前在地图上可见，将标记它，假设您调用`setMyLocationEnabled(true)`了`GoogleMap`。或者，您可以自己更新 a 的位置`Marker`以反映用户的位置。

地理编码完全独立于`GoogleMap`. 当您通过您选择的任何方式获取位置修复时，除了更新地图之外，您还可以运行您的地理编码逻辑。

# javascript - 大量行的 HTML5 SVG 与 Canvas？

> ID：13962406
> 
> 赞同：6
> 
> 时间：2012-12-19T22:36:35.293
> 
> 标签：javascript, html, canvas, svg, d3.js

问题：canvas 在以下情况下是否比 svg 更适合？

案例：我正在绘制一个与此类似的图表（使用 d3js 库）（但包含更多数据）：

[http://mbostock.github.com/d3/talk/20111116/iris-parallel.html](http://mbostock.github.com/d3/talk/20111116/iris-parallel.html)

它基于 svg，它适用于数千行（最多 5000 行），添加更多行（svg 路径）会显着降低性能（在页面中滚动变慢）

请记住：我需要添加鼠标事件（这在 svg 中很方便）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T22:42:16.687

通常`svg`更适合矢量图像，例如您的示例。但是`canvas`在现代浏览器中有很多好处，比如硬件加速，所以对于画线，只要缩放、平移等。不需要性能将使用`canvas`.

使用鼠标事件可能会很痛苦`canvas`，因为您必须手动跟踪所有内容，因此使用 5000+ 点`canvas`不会很有趣。然而，权衡将是一旦绘制了点，假设您只在页面表现良好时才绘制它们，而不管行数如何，因为它们都被绘制到光栅图像而不是`DOM`.

老实说，虽然找到它的最好方法是测试你目前使用画布的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T22:48:21.667

当性能成为问题时，切换到画布可能是一种选择。在这种情况下，您可以绘制一次画布。之后，它几乎被视为图像。绘图可能需要一些时间，但之后可以很快缩放。[请注意，可以使用 context.drawImage 方法（示例](http://www.phrogz.net/tmp/canvas_from_svg.html)）将渲染的 SVG 绘制到画布上。因此，您可以保留 SVG 生成代码以在后台创建 SVG，然后将其绘制到画布上。

但是请记住，一旦它在画布上，它就不会像 SVG 那样漂亮。当用户放大时，它会变得模糊或像素化，这取决于浏览器如何缩放图形。

画布上的点击事件可以通过两种方式处理。要么保留一组单击目标，然后将 onclick 事件处理程序添加到画布。当点击发生时，迭代数组并检查哪个最接近点击坐标。

另一种选择是使用[命中区域](http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#hit-regions)。这些必须定义为多边形路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T23:57:38.977

对上面所说的一切+1。在 SVG 上使用画布和使用 DOM 合成图像时，我看到了一些惊人的性能提升。

关于使用鼠标事件操作画布图像，我想像您所描述的图像的最佳方法是使用如下库将其抽象出来：

*   [http://paperjs.org](http://paperjs.org)
*   [http://kineticjs.com](http://kineticjs.com)
*   [http://www.createjs.com/#!/EaselJS](http://www.createjs.com/#!/EaselJS)

让你的代码远离画布本身，让库为你思考。

# jquery - DataTables Bootstrap 和 jquery ui 对话框

> ID：13962407
> 
> 赞同：0
> 
> 时间：2012-12-19T22:36:39.290
> 
> 标签：jquery, jquery-ui, datatables

我正在尝试将[DataTables Bootstrap](http://www.datatables.net/media/blog/bootstrap_2/)与 jQuery ui 一起使用。在我的表格单元格内部，我有打开对话框模式框的超链接，以编辑要发送到数据库的不同输入字段。在表加载时，此操作会正确触发，但如果使用表的排序或分页功能，则会中断，我会得到原始 Html 输出。该表正在使用以下内容进行初始化

```
/* Table initialisation */
$(document).ready(function() {
    $('#example').dataTable( {
        "sDom": "<'row'<'span8'l><'span12'f>r>t<'row'<'span6'i><'span6'p>>",
        "sPaginationType": "bootstrap",
        "oLanguage": {
            "sLengthMenu": "_MENU_ records per page"
        },

        "oTableTools": {
            "aButtons": [
                "copy",
                "print",
                {
                    "sExtends":    "collection",
                    "sButtonText": 'Save <span class="caret" />',
                    "aButtons":    [ "csv", "xls", "pdf" ]
                }
            ]
        }
    } );
} ); 
```

比在另一个 js 文件中我试图捕捉 jquery ui 事件

```
$(document).ready(function() {
    var dialog = $('#tabs').tabs(
                    {

                        select: function(ev, ui) {

                            //Setup Buttons to each Tab
                            switch(ui.index) {
                            case 0:
                                $('.ui-dialog-buttonpane').find("button").show().filter(":contains('Email senden')").hide(); 
                            break;

                            case 1:
                                $('.ui-dialog-buttonpane').find("button").show().filter(":contains('Speichern')").hide(); 
                            break;

                            case 2:
                                $('.ui-dialog-buttonpane').find("button").hide(); 
                            break;

                        }

                      }        
                }).dialog({ //codes});
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:27:53.877

我会改变一些事情：

1.  考虑使用[Bootstrap 的内置模式](http://twitter.github.com/bootstrap/javascript.html#modals)窗口而不是 jQuery UI 对话框窗口。我发现了一些 Bootstrap 和 jQuery UI 不能很好地协同工作的情况。如果您可以删除 jQuery UI 依赖项，那就更好了。

2.  使用[DataTable 的`mData`属性](http://www.datatables.net/usage/columns#mData)和列定义中的函数来动态创建触发模式窗口的链接/按钮。这样，当您的数据被排序/过滤时，它不会破坏启动窗口的触发器。

快速示例：

```
$(document).ready( function() {
  var oTable = $('#example').dataTable( {
    "aoColumnDefs": [ {
      "aTargets": [ 0 ],
      "mData": function ( source, type, val ) {
        return "<button data-id='" + source.my-id + "' class='edit-button btn'>Edit</button>";
      }
    } ]
  } );

  $(document).on('click', '.edit-button', function(e) {
    e.preventDefault();
    var id = $(e.target).data('id');
    $("#MyModal").modal();
  });
} ); 
```

# php - 自动导入 csv - ftp 或电子邮件？

> ID：13962409
> 
> 赞同：0
> 
> 时间：2012-12-19T22:36:40.130
> 
> 标签：php, mysql, email, csv, ftp

我的主要问题：是否有理由选择一个作为文件位置来自动更新 MySQL - FTP 或电子邮件？

我将有一个小的 csv 文件（1 行）和几个远程生成的图像文件，可以发送到 FTP 站点或电子邮件帐户。从那里我需要将 csv 文件更新到 MySQL 数据库中，然后该数据将立即反映在网站上。这需要每小时进行两次。

我已经查看了 Stack 和其他在线资源。似乎通过 ftp 可能更直接并且需要更少的知识（我只是一个平民！），这个 [Stack Question](https://stackoverflow.com/questions/7385418/import-csv-file-from-external-ftp-site)似乎让我大部分时间都在那里。

第二个问题是，我的基本事件顺序是否正确：

*   创建一个按计划调用 ftp 或电子邮件的 cron
*   将访问和读取 csv 文件的 PHP 脚本
*   PHP 打开数据库并更新表并从 ftp 或电子邮件中删除文件
*   用于更新网站的 HTML 中的 PHP 脚本

感谢您的观看以及您可以提供的任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T06:20:22.880

在这种情况下，我肯定会使用 FTP，电子邮件只会增加很多不必要的复杂性。

FTP：

*   导入脚本从磁盘读取 csv，你很好（假设导入脚本在文件上传的服务器上运行）

电子邮件：

*   导入脚本必须使用 pop3/imap 库并处理附件解码以获取文件内容
*   使用了更多的带宽（附件需要进行 MIME 编码，尤其是对于图像，这会增加很多）
*   您需要处理更多错误情况（延迟邮件、退回邮件、垃圾邮件隔离邮件丢失...）

至于你的第二个问题：听起来对我来说是正确的，尽管我不明白你所说的“HTML 中的 PHP 脚本看起来更新网站”是什么意思。如果您有一个动态网站（例如用 PHP 编写），它会在每次请求时检查数据库，这一步听起来没有必要。

# c# - 将 EntityFramework.Extended 添加到项目中

> ID：13962421
> 
> 赞同：3
> 
> 时间：2012-12-19T22:37:40.223
> 
> 标签：c#, entity-framework

我已使用 NuGet将`EntityFramework.Extended`（[链接）添加到我的项目中。](https://github.com/loresoft/EntityFramework.Extended)现在我面临一个问题；我如何使用它的`Update`功能与我的`dbContext`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T22:43:15.320

导入命名空间`using EntityFramework.Extensions`并使用`Update`（来自更新方法描述的示例）：

```
dbContext.Users.Update(
         u => u.Email.EndsWith(emailDomain),
         u => new User { IsApproved = false, LastActivityDate = DateTime.Now }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:44:13.760

您为 Update 指定 Where 谓词，如下所示：

```
context.tblToUpdate
       .Update(entry => condition, entryWithnewValues => new tblToUpdate{}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:45:28.097

更新：

```
YourDbContext context=new YourDbContext();
//update all tasks with status of 1 to status of 2
context.YourModels.Update(
    t => t.StatusId == 1, 
    t2 => new Task {StatusId = 2});

//example of using an IQueryable as the filter for the update
var yourmodel = context.YourModels.Where(u => u.FirstName == "firstname");
context.YourModels.Update(yourmodel , u => new YourModel {FirstName = "newfirstname"}); 
```

您应该有一个继承 DbContext 并具有公共 DbSet 的类，例如：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Data.Entity;

namespace YourNamespace.Models
{
    public class YourDBContext: DbContext
    {
         public DbSet<YourModel> YourModels { get; set; }
    }
} 
```

使用 EntityFramework.Extended 没有什么特别的要求

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-07-28T08:41:24.160

DbContext 上的 Extensions 方法现已消失。

支持的扩展方法仅在 IQueryable 上

[![在此处输入图像描述](../Images/d8bfbb3f85643927cedebbceffc8483c.png)](https://i.stack.imgur.com/R9rxe.png)

# css - 当正文在下方滚动时，如何在捏/缩放时在页面顶部保持固定的标题？

> ID：13962422
> 
> 赞同：3
> 
> 时间：2012-12-19T22:37:40.770
> 
> 标签：css, header, css-position

我有一个带有固定位置标题（Z-index:1000）的网页。页面的主体是较低的 z-index，并在页眉下方滚动。

当我在智能手机上捏/缩放页面时，页眉与网页分离并单独缩放，与正文重叠。

我希望标题保留在附加页面的顶部。

这是链接： [测试页](http://www.givemehope.com/test.htm)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T00:07:28.643

这一直是触摸屏设备的问题。我不相信有一个纯粹的 css 解决方案，因为捏/缩放会移动整个视口，而不仅仅是你正在触摸的元素。您可能不得不求助于基于 javascript 的解决方案。有关详细列表，请参见此处。 [http://bradfrostweb.com/blog/mobile/fixed-position/](http://bradfrostweb.com/blog/mobile/fixed-position/)

# python - 如何在python的内部for循环中打破while循环？

> ID：13962424
> 
> 赞同：10
> 
> 时间：2012-12-19T22:37:48.003
> 
> 标签：python, for-loop, while-loop, break

`while`在 for 循环中 i>10 时不会中断：

```
i = 0
x = 100
while i<=10:
    for a in xrange(1, x+1):
        print "ok"
        i+=1 
```

它打印了`"ok"`100 次。`while`当循环`i`达到 10时如何中断`for`循环？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-19T22:41:55.330

在内部循环“返回”之前，永远不会重新检查外部循环中的条件。如果您需要在每次`i`更改后都进行此检查，请改为执行以下操作：

```
while i<=10:
    for a in xrange(1, x+1):
        print "ok"
        i+=1
        if i > 10:
            break 
```

这`break`只会退出内部循环，但由于外部循环条件将评估为`False`，它也会退出。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-19T22:46:21.963

```
i = 0
x = 100
def do_my_loops():
  while i<=10:
    for a in xrange(1, x+1):
      print "ok"
      i+=1
      if time_to_break:
        return
do_my_loops() 
```

`time_to_break`您正在检查的条件在哪里。

或者一般来说：

```
def loop_container():
  outer_loop:
    inner_loop:
      if done:
        return

loop_container() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T22:54:44.833

问题是在内部循环完成之前不会检查外部循环的条件 - 此时`i`已经是 100。从我的角度来看，编写此代码并获得所需输出的正确方法是在内循环并在`i`达到 10 时将其中断。

```
for a in xrange(1, x+1):
    if i < 10:
        print "ok"
        i+=1
    else:
        break 
```

如果有其他原因导致您想在内部循环内部中断外部循环，也许您应该让我们了解细节以更好地理解它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-04T21:44:22.907

那这个呢？

```
x = True 
while x:
    for i in range(20):
        if i>5:
            x = False
            break
        else:
            print(i) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-23T21:47:03.403

```
booked = False
for i in range(100, 200):
    if booked:
        break
    while True:
        for x in range(1, 3):
            if booked:
                break
            result = 0
            if result == 1:
                booked = True
        break
    continue 
```

# jquery - 在结果中按函数制作 jquery 插件

> ID：13962427
> 
> 赞同：-3
> 
> 时间：2012-12-19T22:38:00.360
> 
> 标签：jquery, plugins

我正在尝试创建一个 jQuery 插件。

```
$.fn.examplePlugin = function(callback) {
    $.item = $(this);
    $(this).hide('fast',function () {
        callback('bla');
    });

    function show(a) {
       alert(a);
    }    

} 
```

并使用

```
$('form').examplePlugin(function(data)) {
    this.show(data); // need to return alert 'bla'
}); 
```

需要返回警报“bla”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:01:19.770

在您编辑之后，您的代码*几乎*可以完成您想要做的事情。只有几个问题：

1.  这条线的目的是什么？

    ```
    $.item = $(this); 
    ```

    您正在`$`引用元素的 jQuery 对象（别名）中创建一个字段。如果您调用插件 N 次，该字段将被覆盖 N 次。无论您试图完成什么，这都不是实现它的方法。

2.  您的功能`show`仅在闭包内部可用`function(callback) { ... }`，您无法从外部访问它。调用`this.show`不会做任何事情，你不应该尝试添加成员，`this`因为它引用了一个 DOM 元素。

    对于“正确”的做法，我建议阅读一些关于插件创作的教程，但作为一种快速解决方法，你为什么不将`show`函数作为参数传递给回调呢？

    ```
    $(this).hide('fast',function () {
        callback(show, 'bla');
    });

    ...

    $('form').examplePlugin(function(show, data) {
        show(data); // will perform (not return) "alert('bla')"
    }); 
    ```

# c# - 按钮将应用程序页面从主页切换到第 1 页

> ID：13962430
> 
> 赞同：1
> 
> 时间：2012-12-19T22:38:40.813
> 
> 标签：c#, windows-phone-7

我正在制作一个网络浏览器应用程序。当单击按钮 2 并关闭主页（浏览器+搜索栏等）时，我需要打开第 1 页（设置）。

后退按钮会回到主页吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:43:17.667

您可以使用[NavigationService在](http://msdn.microsoft.com/en-us/library/system.windows.navigation.navigationservice%28v=vs.92%29.aspx)[PhoneApplicationPage之间导航](http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.phone.controls.phoneapplicationpage%28v=vs.105%29.aspx)

举个简单的例子：

```
NavigationService.Navigate(new Uri("/page1.xaml",UriKind.Relative)); 
```

是的，手机上的后退按钮将在应用程序页面历史记录中向后移动。

# html - 将输入和单选按钮与不同位置的标签对齐

> ID：13962433
> 
> 赞同：0
> 
> 时间：2012-12-19T22:38:58.693
> 
> 标签：html, css

我有这个代码：

```
 <form action="#" method="get">
        <fieldset>
            <div>   
                <label for="profilephoto">Your profile photo</label>
                <input type="file" name="profilephoto" id="profilephoto" />
            </div>
            <div>
                <label for="firstname">Your first name</label>
                <input type="text" name="firstname" id="firstname" />
            </div>
            <div>
                <label for="lastname">Your last name</label>
                <input type="text" name="lastname" id="lastname" />
            </div>
            <div>
                <label for="gender">Gender</label>
                <input type="radio" name="gender" value="female" id="female" />
                <label for="female">Female</label>
                <input type="radio" name="gender" value="male" id="male" />
                <label for="male">Male</label>
            </div>
            <div>
                <label for="birthdategroup">Birth Date</label>
                <select name="Month">
                    <option value="none">- Month -</option>
                    <option value="January">January</option>
                    <option value="February">February</option>
                    <option value="March">March</option>
                    <option value="April">April</option>
                    <option value="May">May</option>
                    <option value="June">June</option>
                    <option value="July">July</option>
                    <option value="August">August</option>
                    <option value="September">September</option>
                    <option value="October">October</option>
                    <option value="November">November</option>
                    <option value="December">December</option>
                </select>
                    <select name="Day">
                    <option value="none">- Day -</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="22">30</option>
                    <option value="29">31</option>

                </select>
                <select name="year">
                    <option value="none">- Year -</option>
                    <option value="1993">1993</option>
                    <option value="1994">1994</option>
                    <option value="1995">1995</option>
                </select>
                <p>This is hidden by fault from your profile.</p>
            </div>
            <div>
                <label for="about">About you</label>
                <textarea id="about" rows="9" cols="30"></textarea>
            </div>
            <div>
                <label for="websiteaddress">Your website address
                </label>
                <input type="text" id="websiteaddress" name="websiteaddress" />
            </div>
            <div>
                <label for="websitename">Website name</label>
                <input type="text" id="websitename" name="websitename" />
            </div>
            <div>
                <span>preview profile</span> <input type="submit" value="save"/>
            </div>

        </fieldset>
    </form> 
```

所需的设计是这样的： http: [//d.pr/i/WZ0U](http://d.pr/i/WZ0U)

问题是，我试图通过向标签添加填充和宽度来对齐它，但鉴于单选按钮有自己的标签（男性和女性），它也会增加这些按钮之间的空间，这是不希望的。

我该如何设计这个？此外，由于每个单选按钮已经有自己的标签，因此使用第三个标签来表示“性别”真的合适吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:43:47.410

向标签添加类，例如，如果单选框标签需要不同的样式，则其他标签会向这些标签添加特定类：

```
<label class="radio">text</label>
<label class="input">text</label>
... 
```

然后使用css中的类：

代替

```
label {css code} 
```

利用

```
.radio {css code} 
```

依此类推，您可以为不同的标签赋予不同的 css。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:43:13.423

给“奇数”标签一个类名并单独设置它的样式。

此外，使用样式化的无序列表作为容器比 DIV 更好。

见：[http ://www.alistapart.com/articles/prettyaccessibleforms](http://www.alistapart.com/articles/prettyaccessibleforms)

# android - 通过单击按钮添加 ListView 项目

> ID：13962436
> 
> 赞同：0
> 
> 时间：2012-12-19T22:39:07.473
> 
> 标签：android, listview, button, user-input

经过几天的尝试、搜索和再次尝试，我想向你们寻求帮助。

我想通过单击带有随机用户输入项的按钮来填充 ListView。

这是我的 activity_main.xml 的示例图片

[http://s1.directupload.net/file/d/3109/x6qnnj5s_png.htm](http://s1.directupload.net/file/d/3109/x6qnnj5s_png.htm)

我尝试了此处和其他站点的严格代码片段，但每次我的虚拟设备说应用程序 test_1（进程 com.example.test_1）已意外停止。请再试一次。

我当前的代码是：

**activity_main.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
tools:context=".MainActivity" >

<ListView
    android:id="@+id/tPlanView"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_above="@+id/addTplan" >
</ListView>

<Button
    android:id="@+id/addTplan"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:text="Button" /> 
```

**list_item.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<EditText
    android:id="@+id/textIn"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true" />
<TextView 
    android:id="@+id/textOut"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"

    /> 
```

**MainActivity.java**

```
public class MainActivity extends ListActivity {

/** Items entered by the user is stored in this ArrayList variable */
ArrayList<String> list = new ArrayList<String>();

/** Declaring an ArrayAdapter to set items to ListView */
ArrayAdapter<String> adapter;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    /** Setting a custom layout for the list activity */
    setContentView(R.layout.activity_main);

    /** Reference to the button of the layout main.xml */
    Button btn = (Button) findViewById(R.id.addTplan);

    /** Defining the ArrayAdapter to set items to ListView */
    adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, list);

    /** Setting the event listener for the add button */
    btn.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            EditText edit = (EditText) findViewById(R.id.textIn);
            list.add(edit.getText().toString());
            edit.setText("");
            adapter.notifyDataSetChanged();

        }
    });

    /** Setting the adapter to the ListView */
    setListAdapter(adapter);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
} 
```

我很高兴有任何帮助。提前谢谢你:-)

**- - - - 更新 - - -**

日志猫

```
 12-19 22:45:02.854: D/AndroidRuntime(330): Shutting down VM
12-19 22:45:02.854: W/dalvikvm(330): threadid=1: thread exiting with uncaught exception (group=0x40015560)
12-19 22:45:02.864: E/AndroidRuntime(330): FATAL EXCEPTION: main
12-19 22:45:02.864: E/AndroidRuntime(330): java.lang.RuntimeException: Unable to start activity ComponentInfo{ de.example.test_1test_1/ de.example.test_1.MainActivity}: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.os.Looper.loop(Looper.java:123)
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.app.ActivityThread.main(ActivityThread.java:3683)
12-19 22:45:02.864: E/AndroidRuntime(330):  at java.lang.reflect.Method.invokeNative(Native Method)
12-19 22:45:02.864: E/AndroidRuntime(330):  at java.lang.reflect.Method.invoke(Method.java:507)
12-19 22:45:02.864: E/AndroidRuntime(330):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
12-19 22:45:02.864: E/AndroidRuntime(330):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
12-19 22:45:02.864: E/AndroidRuntime(330):  at dalvik.system.NativeStart.main(Native Method)
12-19 22:45:02.864: E/AndroidRuntime(330): Caused by: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.app.ListActivity.onContentChanged(ListActivity.java:243)
12-19 22:45:02.864: E/AndroidRuntime(330):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:210)
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.app.Activity.setContentView(Activity.java:1657)
12-19 22:45:02.864: E/AndroidRuntime(330):  at  de.example.test_1.MainActivity.onCreate(MainActivity.java:33)
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
12-19 22:45:02.864: E/AndroidRuntime(330):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
12-19 22:45:02.864: E/AndroidRuntime(330):  ... 11 more
12-19 22:45:05.964: I/Process(330): Sending signal. PID: 330 SIG: 9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:39:40.147

如果你要使用，`extends ListActivity`那么`ListView`在你的主布局中必须用这个 id 写成这样：

```
<ListView
    android:id="@android:id/list" <---------
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_above="@+id/addTplan" >
</ListView> 
```

至于主要问题查询，也许您会发现以下问题的答案很有用，因为它涵盖了相同的主题。

[单击eclipse中的按钮后如何显示项目？](https://stackoverflow.com/questions/13658682/how-to-display-item-after-clicked-the-button-in-eclipse/13660943#13660943)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:38:56.913

改变

```
<ListView
    android:id="@+id/tPlanView" 
```

到

```
<ListView
    android:id="@android:id/list" 
```

# jquery - 检测 jquery easy ui 组合框是否有焦点

> ID：13962442
> 
> 赞同：0
> 
> 时间：2012-12-19T22:39:58.597
> 
> 标签：jquery, combobox, jquery-easyui

假设我有一个这样的 jQuery EasyUI 组合框：

```
<input class="easyui-combobox" id="combobox" data-options="
    valueField: 'label',
    textField: 'value',
    data: [{
        label: 'java',
        value: 'Java'
    },{
        label: 'perl',
        value: 'Perl'
    },{
        label: 'ruby',
        value: 'Ruby'
}]" /> 
```

我如何检测组合框何时具有焦点，然后相应地执行一些操作？

我尝试过类似的东西：

```
$('#combobox').focus(function(){
    alert('FOCUS');
}); 
```

和

```
var combobox_panel = $('#combobox').combobox('panel');

combobox_panel.focus(function(){
    alert('FOCUS');
}); 
```

但这些都不起作用。请问有什么想法吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:49:54.047

那是因为原始输入被破坏并被新的“假”输入替换以使其美观。您可以尝试`combo-text validatebox-text`在一个元素上一起查找类并绑定到该元素。

```
$('.combo-text.validatebox-text').on('focus', function() {
    alert('here'); // warning, for some reason I keep alerting.
}); 
```

这并不完美，但它是一个开始。检查 Chrome 或 FF 中的输入元素，您将看到库如何构建新输入。

## 编辑

阅读您的评论后，您实际上只需要知道用户何时选择了一个值。

```
$('.combobox-item').on('click', function() {
    alert(this.textContent);
}); 
```

# jquery - 将值设置为固定模糊

> ID：13962447
> 
> 赞同：1
> 
> 时间：2012-12-19T22:40:30.683
> 
> 标签：jquery

我有一个用于插入美元金额的输入字段。如果用户输入“100”或“100”。我想使用 toFixed(2) 方法为该值添加两位小数。

这是一个[例子](http://jsfiddle.net/8d4Px/)

这是我尝试过的：

```
var j$ = jQuery.noConflict();

j$(document).ready(function() {
    j$('#ccAmt').blur(function() {
        j$(this).val(j$(this).val().toFixed(2));
    });
}); 
```

我在论坛上找到了几个例子，但我尝试的一切都没有奏效。我错过了什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:44:46.097

是`.val()`返回一个数字吗？尝试：

```
j$(this).val(parseFloat(j$(this).val()).toFixed(2)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:47:45.833

***[jsBin 演示](http://jsbin.com/evanax/4/edit)***

```
var j$ = jQuery.noConflict();

j$(document).ready(function($) {

    $('#ccAmt').blur(function() {
        var val = parseFloat( this.value ).toFixed(2);
        $(this).val( val );
    });

})(jQuery); 
```

# javascript - 无法检索 servlet 中设置的值

> ID：13962448
> 
> 赞同：1
> 
> 时间：2012-12-19T22:40:33.683
> 
> 标签：javascript, jsp, session, servlets, attributes

我相信，这是一个非常简单的问题，但我解决它的所有尝试都失败了。

简而言之：我有一个带有调用 Java Servlet 的表单的 JSP 文件。servlet 处理输入并返回一个变量（属性）并重定向回**同一个**jsp。我想让 jsp 使用**JavaScript**处理返回的属性，而不是 scriptlet。

JSP 代码（test.jsp）：

```
<html>
  ...
  <%@page language="java"
    import="java.sql.*" 
    import="java.util.*"
  %>
  ...
  <body>
    <script type='text/javascript'>
      var name = session.getAttribute("test");
      alert(name);
    </script>
    ...
  </body>
</html> 
```

和 Servlet 代码：

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) {
  request.getSession().setAttribute("test", "value");
  String redirectedPage = "/test.jsp";
  RequestDispatcher reqDispatcher = getServletConfig().getServletContext().getRequestDispatcher(redirectedPage);
  reqDispatcher.forward(request,response);
} 
```

我相信问题源于我声明的会话变量：

```
var name = session.getAttribute("test"); 
```

我也试过：

```
var name = (String) session.getAttribute("bob"); 
```

和：

```
String name = (String) session.getAttribute("bob"); 
```

我可以使用 scriptlet (<% %>) 从我的表单中访问此属性，但这不允许我修改/处理返回的属性，我需要这样做。

任何帮助是极大的赞赏。如果你觉得这个问题已经被问到/解决了（我已经搜索过），请礼貌地告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:44:32.073

您不能从 javascript 访问会话，但您当然可以在服务器端创建您的 javascript。

```
<script type='text/javascript'>
  var name = '<%= session.getAttribute("test") %>';
  alert(name);
</script> 
```

如果您无法 100% 控制实际值（甚至可能如此），最好转义字符串。否则，有人可能会注入破坏您的页面（最佳情况）或使某些 XSS 窃取用户数据或劫持用户会话的值。

使用 Apache commons *StringEscapeUtils* ( [JavaDoc](http://commons.apache.org/lang/api-2.0/org/apache/commons/lang/StringEscapeUtils.html) ) 它看起来像这样

```
<script type='text/javascript'>
  var name = '<%= StringEscapeUtils.EscapeJavaScript((String)session.getAttribute("test")) %>';
  alert(name);
</script> 
```

如果您要经常使用它（或者甚至可能只使用一次），我建议您创建一个标签，该标签采用属性名称并输出一个 javascript 安全字符串。也许作为*<MyJsTags:AttributeAsString name="test"/>*来避免脚本让您的 JSP 进入，如果您想在访问属性时强加新功能，它也会更容易。

# infinite-loop - 为什么这会造成无限循环？

> ID：13962453
> 
> 赞同：0
> 
> 时间：2012-12-19T22:41:00.553
> 
> 标签：infinite-loop

有人可以解释为什么这是一个无限循环吗？hurcdata2 中有大约 30 个应变值。我不明白问题是什么。

```
import java.util.Scanner;
import java.io.File;
import java.io.IOException;
public class Hurricanes2
{
public static void main(String[] args) throws IOException
{
    int i = 0;
    int hurricaneNumber = 0;
    String hurricanes = "";
    File fileName = new File("hurcdata2.txt");
    Scanner inFile = new Scanner(fileName);
    while (inFile.hasNext())
    {
        hurricaneNumber++;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:47:17.317

在您的`while`- 循环中，您应该调用`inFile.nextLine()`以使其处理文件中的每一行。

```
 while (inFile.hasNext()) {
     hurricaneNumber++;
     String line = inFile.nextLine();
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:47:37.940

正如@ElectricLlama 在评论中指出的那样，您需要推进文件指针以获取下一个令牌，否则`hasNext()`将始终为真。检查this [question](https://stackoverflow.com/questions/8352040/scanner-on-text-file-hasnext-is-infinite)和this [tutorial](http://forum.codecall.net/topic/50186-file-input-and-output/#axzz2FX6jIeiK) on File I/O in Java。

# c# - 包未从 C# 执行

> ID：13962454
> 
> 赞同：0
> 
> 时间：2012-12-19T22:41:01.440
> 
> 标签：c#, ssis

我有一个可以在 BIDS（或任何 MS 现在为 SSIS 调用 VS）和执行包实用程序中运行良好的包。

我尝试使用以下代码从 C# 运行它，但没有任何反应。.Execute 返回成功，ExecutionStatus 已完成。.Execute 需要几秒钟，而它应该需要一两分钟，并且它没有做它应该做的事情（加载源文件，将它们移动到其他地方等）

```
var pkgLocation = @"C:\ImportMetricsPackage.dtsx";
var app = new Microsoft.SqlServer.Dts.Runtime.Application();
var pkg = app.LoadPackage(pkgLocation, null);
var pkgResults = pkg.Execute(); 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:54:33.663

您是否尝试过捕获包事件？

```
MyEventListener eventListener = new MyEventListener();

var pkgLocation = @"C:\ImportMetricsPackage.dtsx";
var app = new Microsoft.SqlServer.Dts.Runtime.Application();
pkg = app.LoadPackage(pkgLocation, eventListener);
pkgResults = pkg.Execute(null, null, eventListener, null, null); 
```

事件监听类：

```
class MyEventListener : DefaultEvents
{
    public override bool OnError(DtsObject source, int errorCode, string subComponent, 
    string description, string helpFile, int helpContext, string idofInterfaceWithError)
    {
        // Add application-specific diagnostics here.
        Console.WriteLine("Error in {0}/{1} : {2}", source, subComponent, description);
        return false;
    }
} 
```

有关更多详细信息，请参阅[以编程方式加载和运行本地包](http://msdn.microsoft.com/en-us/library/ms136090.aspx)。

# objective-c - CCSprite 遵循随机路径

> ID：13962455
> 
> 赞同：0
> 
> 时间：2012-12-19T22:41:02.990
> 
> 标签：objective-c, cocos2d-iphone, ccsprite

我将如何创建随机路径并让精灵跟随它？
一旦它到达路径的尽头就暂停并开始新的路径，如果我需要还有不止一个？
我在想在屏幕上生成随机坐标并使用 CCMoveTo 但这会形成一条直线并且很无聊。我想复制飞来飞去的昆虫的行为。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T02:55:19.370

您可以使用`CCBeizierTo` 或`CCBezierBy` 例如：

```
#define randomPoint ccp(CCRANDOM_0_1()*[[CCDirector sharedDirector] winSize].width,CCRANDOM_0_1()*[[CCDirector sharedDirector] winSize].height)

ccBezierConfig bezier;

bezier.controlPoint_1 = randomPoint;

bezier.controlPoint_2 = randomPoint;

bezier.endPosition = randomPoint;

CCBezierBy* bez = [CCBezierBy actionWithDuration:5.0f bezier:bezier];

[sprite runAction:bez]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:07:19.523

这个简单的方法怎么样：有一个持续的速度向量，在替换你的动作之前`float vx, vy;`标准化它以确保恒定的速度。然而，在归一化之前，添加小的以零为中心的随机值，例如 between和to和。随机值的非常小的范围将为您提供平滑的持久路径，较大的范围将使路径不那么持久并且像昆虫一样抖动。另一种选择是在每次更新时再掷一次骰子，并且以非常低的概率对标准化和标准化之前进行非常大的更改，从而使您的昆虫在随机实例中非常突然地改变其路径。`sqrtf((vx * vx) + (vy * vy))``CCMoveTo``-0.3f``0.3f``vx``vy``vx``vy`

# javascript - 检测用户何时在 HTML5/Javascript 应用程序中拖动广告控件？

> ID：13962456
> 
> 赞同：5
> 
> 时间：2012-12-19T22:41:07.530
> 
> 标签：javascript, windows, html, windows-8, ads

嗨，我使用 Construct2 开发了一个游戏，并在导出项目附带的主 html 页面中包含了一个 AdControl。现在我注意到，当您从游戏画布拖动到广告上并释放时，它实际上并没有释放触摸。我的游戏依赖于特定的触摸，所以如果用户停止触摸屏幕，我实际上需要重置该触摸。我在这里遗漏了什么，或者是否有解决此问题的方法？我在 C# 中使用 WebBrowser 控件尝试了同样的事情，但没有遇到同样的问题。

我已经尝试了一些东西，比如 HTML 片段和用边距将 div 与画布分开，但它总是以相同的方式运行。我还尝试使用 Windows 运行时组件包含广告，但它看起来不允许您传递诸如 AdControl 之类的 UI 元素。有没有人有一些建议。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:47:00.630

这是一个工作示例，当手移到广告上时释放触摸：http: [//jsfiddle.net/ChaitanyaMunipalle/jn3kZ/](http://jsfiddle.net/ChaitanyaMunipalle/jn3kZ/)

您可以在这个 jsfiddle 中看到画布下方的所有触摸事件。

检查 HammerJs 的拖动、释放和其他触摸手势。您可以使用像普通 jquery 事件一样的触摸事件，例如

```
$('#canvasId').on('dragstart drag dragend release ....',callback); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-27T18:39:54.827

我需要查看您的代码才能为您提供最佳答案，但这个问题相当普遍。

如果您有这样的设置（使用 jQuery 进行概念演示）：

```
var mDown = false;

$("#myDiv").mouseDown(function(){
    mDown = true;
}).mouseMove(function(e){
    if (mDown)
       // do stuff
}).mouseUp(function(){
    mDown = false;
}); 
```

发生的情况是，如果您在 div 内部 mousedown，但在其外部 mouseup，则该标志永远不会清除，因为该 div 从未收到 mouseup 事件。

您需要做的是将 mouseup 事件附加到窗口或文档：

```
$(window).mouseUp(function(){
    mDown = false;
}); 
```

然后，无论您在何处释放鼠标按钮，它都会清除其“状态”。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-22T05:45:32.913

一些可能相关的问题和解决方案。

[AdControl 控制 Focus](http://social.msdn.microsoft.com/Forums/pl/winappswithcsharp/thread/260fde69-3738-49a3-b4f1-6514389d5efd) - 两种可能的解决方案。

1.  > 尝试将 IsEnabled 属性设置为 false。

2.  > 找到了一个稍微更有效的解决方法（它可以让您完全启用 AdControl）。
    > 
    > 1.  创建一个名为“ `_advertRefreshed`”的布尔字段。
    > 2.  在`ApplyTemplates`钩子`AdControl.Refreshed`事件期间，设置为`_advertRefreshed`true。
    > 3.  添加一个`OnLostFocus`实现逻辑的事件“如果当前焦点是 WebView 并且`_advertRefreshed`为 true，则将焦点设置回原始，然后在此测试之后`set _advertRefreshed`再次始终为 false”。

[KeyPress 被 AdControl 吞噬？](http://community.bingads.microsoft.com/ads/en/publisher/f/63/t/73548.aspx)- 讨论问题并确认上述解决方案#1。

[Microsoft AdControl 窃取焦点 - Windows 8 MonoGame](https://stackoverflow.com/questions/12965318/microsoft-adcontrol-stealing-focus-windows-8-monogame)

# sql - SQL 仅返回包含数字的文本

> ID：13962457
> 
> 赞同：0
> 
> 时间：2012-12-19T22:41:27.330
> 
> 标签：sql, sqlite

我有一个`.db`文件，其中包含来自 android 手机的联系人列表。我已经加入了两个表格，以在联系人旁边显示手机号码。但我试图显示只包含手机号码的记录。但是当我运行 SQL 语句时，它不会返回一个表。您需要记住一些已保存的电话号码以 +44 开头，而其他电话号码以 0 开头。

这是我的 SQL 语句：

```
select contacts.display_name, data.data1 as Phone_Number,
    contacts.times_contacted, contacts.last_time_contacted 
from contacts, data 
where contacts._id = data.raw_contact_id and data.data1 like '%[0-9]%' 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:02:51.960

在 SQL 中使用正则表达式的关键字是 REGEXP。以下查询应显示“data.data1”包含数字的任何行。

```
SELECT contacts.display_name, data.data1 AS Phone_Number,
    contacts.times_contacted, contacts.last_time_contacted 
FROM contacts, data 
WHERE contacts._id = data.raw_contact_id AND data.data1 REGEXP "[0-9]" 
```

编辑：正如我所说的那样。默认情况下，SQLite 似乎不支持正则表达式。它要求用户创建一个名为 regexp() 的函数来定义它应该如何完成。您使用的程序似乎没有为您创建功能。

[SQLiteSpy](http://www.yunqa.de/delphi/doku.php/products/sqlitespy/index)似乎是另一个 GUI 数据库管理器，它确实增加了对使用正则表达式的支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:31:04.390

```
SELECT cc.display_name, dd.data1 as Phone_Number
    , cc.times_contacted, cc.last_time_contacted 
FROM contacts cc
JOIN data dd ON cc._id = dd.raw_contact_id
WHERE (dd.data1 like '+44[0-9]%'
       OR dd.data1 like '0[0-9]%'
       )
     ; 
```

注意：我转换成 JOIN 语法，这样更容易阅读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T17:20:20.540

你到底想用什么来完成`data.data1 like '%[0-9]%'`？您是否只想显示字段`data.data1`包含一位或多位数字的记录？

我看到了两种方法：

1.  `(data.data1 LIKE '%0%' OR data.data1 LIKE '%1%' OR data.data1 LIKE '%2%' OR data.data1 LIKE '%3%' OR data.data1 LIKE '%4%' OR data.data1 LIKE '%5%' OR data.data1 LIKE '%6%' OR data.data1 LIKE '%7%' OR data.data1 LIKE '%8%' OR data.data1 LIKE '%9%')`, 丑陋且相当缓慢;

2.  `(data.data1 REGEXP '[0-9]+')`. 但是，由于 SQLite 的默认发行版[不包含内置的 RegEx 引擎](http://www.sqlite.org/lang_expr.html#regexp)，因此您必须自己添加该功能（或使用提供该功能的库或实用程序）。

否则，您将不得不使用 SQL 以外的其他方式执行过滤。

# c - 指针或返回两个值打印

> ID：13962462
> 
> 赞同：0
> 
> 时间：2012-12-19T22:41:46.213
> 
> 标签：c, return-value, precision, key-value-store

我正在尝试编写获取 2 个值或返回一个值的函数。所以当我想使用函数时，我得到的值是我认为的地址

```
int function (int a, int *b, *c){
    int value;
    value=a*2; 
    (*b)=value/10;
    (*c)=value%10;
}

int main(void){
    int val1,p1,p2,rest1,rest2;
    val1=150;
    function(val1,&p1,&p2);
    rest1=p1*2+p2;
    rest2=p2;
    printf("%d m %d end %d"rest1,rest2,&p2);
} 
```

我也想只退货一个

```
int funct2(int a){
    int array [2];
    int b=(65*a)/100;
    int c=b%1000;
    array[0]=b;
    array[1]=c;
    return array;
}

int main(void)
{
    int a=18;
    int array[2];
    array=funct2(a);
} 
```

也不行。

那么我如何构建函数来获取 2 个值或将这 2 个值作为一个值.. 请帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:59:08.277

这是不正确的：

```
printf("%d m %d end %d",rest1,rest2,&p2); 
```

最后一个参数 ,`&p2`是一个`int*`( 的地址`p2`) 但格式说明符是 a `%d`。改成：

```
printf("%d m %d end %d", rest1, rest2, p2); 
```

要返回两个`int`s，您可以定义 a`struct`并按值返回：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

struct int_pair
{
    int division_result, modulus_result;
};

struct int_pair function (const int a)
{
    const int value = a * 2;
    struct int_pair result;

    result.division_result = value / 10;
    result.modulus_result  = value % 10;

    return result;
}

int main()
{
    struct int_pair p = function(150);
    printf("%d %d\n", p.division_result, p.modulus_result);
    return 0;
} 
```

如果 C99`function()`可以使用复合文字作为返回值：

```
struct int_pair function (const int a)
{
    const int value = a * 2;
    return (struct int_pair) { value / 10, value % 10 };
} 
```

有关演示，请参见[http://ideone.com/8PFtHq](http://ideone.com/8PFtHq)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:46:39.610

在您尝试返回多个值时，

```
int funct2(int a){
int array [2];
int b=(65*a)/100;
int c=b%1000;
array[0]=b;
array[1]=c;
return array;
} 
```

您正在返回一个*未定义行为*的局部变量，这意味着该程序不再被认为是有效的。

只需传递一个数组`main`，更改就会传播回 main。

你的函数声明是这样的：

```
void funct2(int *a, int size){ //size is the number of elements 
```

来自 main() 的调用是这样的：

```
int a[2];
func(a, 2); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T04:40:17.553

第一个功能固定：

```
void function1 (int a, int *b, int *c){
    int value;
    value=a*2;
    (*b)=value/10;
    (*c)=value%10;
}

int main(void){
    int val1,p1,p2,rest1,rest2;
    val1=150;
    function1(val1,&p1,&p2);
    rest1=p1*2+p2;
    rest2=p2;
    printf("%d m %d end %d\r\n",rest1,rest2,&p2);
} 
```

第二个功能固定：

```
int* function2(int a){
    int* array = (int*)malloc(2);
    int b=(65*a)/100;
    int c=b%1000;
    array[0]=b;
    array[1]=c;
    return array;
}

int main(void)
{
    int a=18;
    int* array;
    array=function2(a);

    //You can access array[0] and array[1]
    //...

    free(array);
} 
```

# jquery - 如何使用 treeTable 显示功能？

> ID：13962467
> 
> 赞同：2
> 
> 时间：2012-12-19T22:41:59.543
> 
> 标签：jquery, plugins, treetable

我使用[treeTable 插件](http://ludo.cubicphuse.nl/jquery-plugins/treeTable/doc/#introduction) 来创建和操作树控件。我已将类分配到树的不同级别。对于最低级别，我有几个具有相同类的节点。

我正在尝试使用 API 的显示功能，但它只工作了一半。这些示例仅适用于一个节点：

```
$("#gq-report-list tr.er-level-4.child-of-tmpl-1").reveal(); // Works for one node
$("#gq-report-list tr.er-level-4").reveal(); // Works for one node
$("#gq-report-list").find(".er-level-4").closest('tr').reveal(); // Works for one node
$("#gq-report-list").find(".owner-shared").closest('tr').reveal(); // Works for one node 
```

我需要根据查找结果显示几个节点。在这个片段中，有 9 个节点要显示，但只有第一个节点是：

```
rows = $("#gq-report-list").find(".private"); // Works for one node, but there are 9
alert(rows.length);
rows.closest('tr').reveal(); 
```

有任何想法吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-09-27T13:19:51.793

```
$("#yourtreetable").treetable("reveal", "id"); 
```

# android - 设置背景颜色的异常

> ID：13962469
> 
> 赞同：3
> 
> 时间：2012-12-19T22:42:06.853
> 
> 标签：android, exception, resources

我有一个应该是白色背景和黑色文本的菜单，但我偶尔会遇到以下异常：

```
Resources$NotFoundException: Resource ID #0xffffffff 
```

显然这是设置背景颜色的方法，下面是一个代码片段：

```
final View view = f.createView( name, null, attrs );  
// sets the background color   
view.setBackgroundResource(Color.WHITE); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:46:18.383

使用[资源颜色的白色](http://developer.android.com/reference/android/R.color.html#white)。

```
view.setBackgroundResource(android.R.color.white) 
```

或设置背景颜色而不是资源

```
view.setBackgroundColor(Color.WHITE) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:46:33.333

您使用错误的方法设置颜色。

该`setBackgroundResource`方法使用可绘制对象设置背景，您可以使用`activity.getResources().getDrawable(ID)`.

但在你的情况下，你只需要设置颜色，所以只需使用方法`view.setBackgroundColor(Color.WHITE)`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T22:45:17.913

颜色没有资源使用此代码：

```
view.setBackgroundColor(Color.WHITE); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T22:45:22.417

您正在设置背景资源，而不是背景颜色。使用 setBackgroundColor 方法，而不是 setBackgroundResource

# python - Python break 函数在 true 时不会结束

> ID：13962471
> 
> 赞同：1
> 
> 时间：2012-12-19T22:42:08.890
> 
> 标签：python, while-loop, break

为什么 break 不会在 while true 结束并返回开始？

```
while True:
    print('This is a quiz')
    print('What is your name?')
    Name = input()
    print('Hello ' + Name + ', The quiz will now begin')
    import time
    time.sleep(2)
    question1 = "Question one: "
    answer1 = "True" and "true"
    print(question1)
    qanswer = input()

    if qanswer != answer1:
        print('Sorry, the answer is: ' + answer1)
        break

    if answer1 == qanswer:
            print("Correct! Here's the next question") 
```

我对python很陌生，所以我认为这只是对术语的简单滥用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T22:43:53.103

`break`存在整个`while`循环。

`continue`是您正在寻找的，返回到下一个`while`迭代。

您可以阅读有关控制流工具的更多信息，`break`并`continue`在官方文档中： http: [//docs.python.org/2/tutorial/controlflow.html#break-and-continue-statements-and-else-clauses-on-loops](http://docs.python.org/2/tutorial/controlflow.html#break-and-continue-statements-and-else-clauses-on-loops)

（您还有其他一些错误，正如其他人正确提到的那样）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:44:45.277

使用“continue”关键字，而不是“break”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:59:25.970

```
....
answer1 = ["True", "true"]
...
if not(qanswer in answer1):
    print('Sorry, the answer is: ' + answer1)
    break
else:
   print("Correct! Here's the next question") 
```

# java - JAXB DOM 节点解组省略元素

> ID：13962484
> 
> 赞同：2
> 
> 时间：2012-12-19T22:43:02.963
> 
> 标签：java, dom, jaxb, ogc

我正在从[OGC](http://www.opengeospatial.org/standards/wfs)解组一些 XML并遇到一个问题，即并非所有元素都进入最终对象。

这是示例 XML

```
 <?xml version="1.0"?>
    <wfs:CreateStoredQuery xmlns:wfs="http://www.opengis.net/wfs/2.0"
    xmlns:fes="http://www.opengis.org/fes/2.0" xmlns:gml="http://www.opengis.net/gml/3.2"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:myns="http://www.someserver.com/myns"
    xsi:schemaLocation="http://www.opengis.net/wfs/2.0
http://schemas.opengis.net/wfs/2.0/wfs.xsd"
    service="WFS" version="2.0.0">
         <wfs:StoredQueryDefinition id="urn:StoredQueries:FeaturesInPolygon">
        <wfs:Title>Features In Polygon</wfs:Title>
        <wfs:Abstract>Find all the features in a Polygon.</wfs:Abstract>
        <wfs:Parameter name="AreaOfInterest" type="gml:PolygonType" />
        <wfs:QueryExpressionText returnFeatureTypes="myns:Parks"
            language="urn:ogc:def:queryLanguage:OGC-WFS::WFS_QueryExpression"
            isPrivate="false">
            <wfs:Query typeNames="myns:Parks">
                <fes:Filter>
                    <fes:Within>
                        <fes:ValueReference>geometry</fes:ValueReference>
                        <gml:Polygon>
                            <gml:exterior>
                                <gml:LinearRing>
                                    <gml:posList>0 0 100 0 100 100 0 100 0 0</gml:posList>
                                </gml:LinearRing>
                            </gml:exterior>
                        </gml:Polygon>
                    </fes:Within>
                </fes:Filter>
            </wfs:Query>
        </wfs:QueryExpressionText>
    </wfs:StoredQueryDefinition>
</wfs:CreateStoredQuery> 
```

这是违规区域的 XSD

```
<xsd:complexType name="StoredQueryDescriptionType">
    <xsd:sequence>
        <xsd:element ref="wfs:Title" minOccurs="0" maxOccurs="unbounded"/>
        <xsd:element ref="wfs:Abstract" minOccurs="0" maxOccurs="unbounded"/>
        <xsd:element ref="ows:Metadata" minOccurs="0" maxOccurs="unbounded"/>
        <xsd:element name="Parameter"
            type="wfs:ParameterExpressionType"
            minOccurs="0" maxOccurs="unbounded"/>
        <xsd:element name="QueryExpressionText"
            type="wfs:QueryExpressionTextType"
            minOccurs="1" maxOccurs="unbounded"/>
    </xsd:sequence>
    <xsd:attribute name="id" type="xsd:anyURI" use="required"/>
</xsd:complexType>
<xsd:complexType name="ParameterExpressionType">
    <xsd:sequence>
        <xsd:element ref="wfs:Title" minOccurs="0" maxOccurs="unbounded"/>
        <xsd:element ref="wfs:Abstract" minOccurs="0" maxOccurs="unbounded"/>
        <xsd:element ref="ows:Metadata" minOccurs="0" maxOccurs="unbounded"/>
    </xsd:sequence>
    <xsd:attribute name="name" type="xsd:string" use="required"/>
    <xsd:attribute name="type" type="xsd:QName" use="required"/>
</xsd:complexType>
<xsd:complexType name="QueryExpressionTextType" mixed="true">
    <xsd:choice>
        <xsd:any namespace="##other" processContents="skip"
            minOccurs="0" maxOccurs="unbounded"/>
        <xsd:any namespace="##targetNamespace" processContents="skip"
            minOccurs="0" maxOccurs="unbounded"/>
    </xsd:choice>
    <xsd:attribute name="returnFeatureTypes"
        type="wfs:ReturnFeatureTypesListType" use="required"/>
    <xsd:attribute name="language" type="xsd:anyURI" use="required"/>
    <xsd:attribute name="isPrivate" type="xsd:boolean" default="false"/>
</xsd:complexType>
<xsd:simpleType name="ReturnFeatureTypesListType">
    <xsd:list itemType="xsd:QName"/>
</xsd:simpleType> 
```

搞砸的部分是 QueryExpressionTextType 下的 xsd:any。它具有属性 processContents="skip" 导致 JAXB 创建 DOM 对象而不是 JAXB 类。我想我以后只需使用 JAXB 上下文来解组 DOM 节点，这是我尝试过的一些示例代码。

```
public static void main(String[] args) throws Exception {
    InputStream in = new FileInputStream("test/res/createQuery.xml");
    JAXBContext context = JAXBContext.newInstance(
            net.opengis.gml.v_3_2_1.ObjectFactory.class,
            net.opengis.wfs.v_2_0_0.ObjectFactory.class,
            net.opengis.filter.v_2_0_0.ObjectFactory.class);
    Unmarshaller unmarshaller = context.createUnmarshaller();
    JAXBElement<?> jElem = (JAXBElement<?>) unmarshaller.unmarshal(in);
    CreateStoredQueryType create = (CreateStoredQueryType) jElem.getValue();
    List<StoredQueryDescriptionType> descriptions = create
            .getStoredQueryDefinition();
    StoredQueryDescriptionType desc = descriptions.get(0);
    List<QueryExpressionTextType> texts = desc.getQueryExpressionText();
    QueryExpressionTextType text = texts.get(0);
    List<Object> contents = text.getContent();
    Node node = (Node) contents.get(0);
    jElem = (JAXBElement<?>) unmarshaller.unmarshal(node);
    QueryType query = (QueryType) jElem.getValue();
    // prints[{http://www.someserver.com/myns}Parks]
    System.out.println(query.getTypeNames());
    // is false
    System.out.println(query.isSetAbstractSelectionClause());
} 
```

它可以很好地获取 Query 对象（包括 typeNames 属性）。但它会跳过 Filter 对象。Filter 对象继承自 AbstractSelectionClause，因此应该在返回的对象中设置它，但事实并非如此。我调试并检查了 DOM 元素并确认过滤器在 DOM 树中。

[为了获得我正在使用的 JAXB 对象，我从jvnet OGC 项目](http://java.net/projects/ogc/sources)中检查了 SVN 存储库，我确实必须编译 WFS 2.0 模式，但过滤器和 GML 模式已经完成。

任何见解将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T17:21:56.553

示例 XML 来自第 81 页的 OGC WFS 2.0 规范文档 (09-025r1)。有一个错字，过滤器的 xmlns 应为“http://www.opengis.org/fes/2.0” “http://www.opengis.net/fes/2.0”。JAXB 将其视为无法识别的元素并将其丢弃在地板上。

# iphone - 将多个杂志发布到报亭

> ID：13962485
> 
> 赞同：-3
> 
> 时间：2012-12-19T22:43:04.520
> 
> 标签：iphone, objective-c, ios, ios5, newsstand-kit

这可能吗？我想创建一项服务，使人们可以轻松地创建报亭杂志。

换句话说，他们会将杂志的内容放入我的服务中，然后我会在应用商店中为他们发布。这可能吗，还是苹果会拒绝？你怎么看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T00:53:45.597

您必须为每个注册的人发布一个应用程序。无法自动执行此过程并将应用程序添加到报亭（您必须手动提交每个应用程序）。唯一的可能性是创建一个报亭应用程序，从您的网站下载杂志信息，然后向用户显示各种杂志。但是，Apple 可能会拒绝该应用程序，因为它模仿了核心系统功能，而且这是杂志接触读者的一种非常不专业的方式。

# xamarin.ios - Monodevelop - 它何时保存 csproj 文件？

> ID：13962486
> 
> 赞同：3
> 
> 时间：2012-12-19T22:43:09.517
> 
> 标签：xamarin.ios, monodevelop, xamarin

当 MonoDevelop 崩溃（不幸的是经常发生）时，我通常不得不对似乎没有写入磁盘的项目重新进行更改。结果我的工作流程变成了-更改项目，重新启动monodevelop（希望在关闭期间保存更改）。我觉得这有点令人沮丧。理想情况下，UI 中应该有一个明确的保存按钮，这样我就知道我的更改是在我预期的时候编写的。我不确定在哪里提交增强请求 - 通过 Xamarin（因为这是使用 monotouch 的 monodevelop）？有人写过一个插件来做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T19:46:54.270

如果您的 MD 安装一切正常，则 Save All 命令/按钮应保存所有项目文件和解决方案。我经常使用这个命令作为保障。根据我的经验，点击保存只会保存您当前正在编辑的文件，而不会保存解决方案和项目文件。

# entity-framework-5 - 如何首先使用实体 框架 5 模型为每个层次结构生成表

> ID：13962491
> 
> 赞同：5
> 
> 时间：2012-12-19T22:43:17.250
> 
> 标签：entity-framework-5, ef-model-first, table-per-hierarchy

我首先使用带有实体框架 5 模型的 Visual Studio 2012。我想使用每个层次结构策略的表来生成我的数据库，但找不到该选项。Entity Designer Database Generation Power Pack 不适用于 Visual Studio 2012，或者我找不到它。

有人建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-18T18:01:20.843

Table Per Hierarchy 或俗称 (TPH) 描述了将继承类型映射到单个数据库表（在您的情况下为模型实体），该表使用鉴别器列将一个子类型与另一个子类型区分开来。当您在模型中创建继承时，这就是 Code First 约定默认推断表映射的方式。

例如，您可以通过这样做来完成这种方法

在 Visual Studio .edmx 编辑器中，右键单击表面，使用**Add –> Entity**

![例子](../Images/c461975a0205c0350fe20d7f79eaa9ca.png)

我添加了两个实体学生和教授，**基本类型将是人**，之后你应该有这样的东西

![模型](../Images/a12d920edea453eb225d2645a98d31ef.png)

有了这个，您可以创建每个层次模型的表。

# linux - 如何让 GNU-Screen 为所有用户共享 1 个屏幕？

> ID：13962495
> 
> 赞同：6
> 
> 时间：2012-12-19T22:43:32.917
> 
> 标签：linux, shell, centos, gnu-screen, multi-user

如何启动可作为根用户和默认用户访问的屏幕？因为现在当我使用以下命令以默认用户身份启动屏幕时：

```
screen -dmS test java $JAR nogui 
```

执行命令并登录到 Root-User 并尝试使用

```
screen -x test 
```

它会说，它不存在，因为屏幕是用户绑定的，AFAIK。

那么有没有办法将屏幕共享给所有用户？所以我可以通过任何用户的屏幕名称附加屏幕。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-21T05:04:03.087

您可以启用多用户，并将允许的用户添加到您的列表中，如下所示：

```
# userA opens a screen
screen -S test

# set multiuser
Ctrl-A :multiuser on

# add the user to join your session to the ACL list:
Ctrl-A :acladd root 
```

然后

```
# root get the screen by userA
screen -x userA/test 
```

[这个](http://blog.boreas.ro/2010/04/share-gnu-screen-sessions-with.html)和[这个](http://aperiodic.net/screen/multiuser)是推荐的。

# c++ - 在四叉树高度映射的地形上查找鼠标世界坐标 (3D)

> ID：13962499
> 
> 赞同：1
> 
> 时间：2012-12-19T22:43:44.053
> 
> 标签：c++, directx, logic, terrain, quadtree

我试图在世界坐标中找到鼠标位置，但找不到正确的代码。目前我用它来确定光线：

```
float pointX, pointY;
D3DXMATRIX projectionMatrix, viewMatrix, inverseViewMatrix, worldMatrix, translateMatrix, inverseWorldMatrix;
D3DXVECTOR3 direction, origin, rayOrigin, rayDirection;
bool intersect, result;

// Move the mouse cursor coordinates into the -1 to +1 range.
pointX = ((2.0f * (float)mouseX) / (float)m_screenWidth) - 1.0f;
pointY = (((2.0f * (float)mouseY) / (float)m_screenHeight) - 1.0f) * -1.0f;

// Adjust the points using the projection matrix to account for the aspect ratio of the viewport.
m_Direct3D->GetProjectionMatrix(projectionMatrix);
pointX = pointX / projectionMatrix._11;
pointY = pointY / projectionMatrix._22;

// Get the inverse of the view matrix.
m_Camera->GetViewMatrix(viewMatrix);
D3DXMatrixInverse(&inverseViewMatrix, NULL, &viewMatrix);

// Calculate the direction of the picking ray in view space.
direction.x = (pointX * inverseViewMatrix._11) + (pointY * inverseViewMatrix._21) + inverseViewMatrix._31;
direction.y = (pointX * inverseViewMatrix._12) + (pointY * inverseViewMatrix._22) + inverseViewMatrix._32;
direction.z = (pointX * inverseViewMatrix._13) + (pointY * inverseViewMatrix._23) + inverseViewMatrix._33;

// Get the origin of the picking ray which is the position of the camera.
origin = m_Camera->GetPosition(); 
```

这给了我射线的原点和方向。

但...

我使用带有高度图的自定义网格（不是来自 directX 的网格），分成四叉树，我不知道我的逻辑是否正确，我尝试使用截头锥来确定四叉树中的哪些节点是可见的，所以检查三角形的交点只在那些节点上，这里是这个代码：

注意* m_mousepos 是一个向量。

```
bool QuadTreeClass::getTriangleRay(NodeType* node, FrustumClass* frustum, ID3D10Device* device, D3DXVECTOR3 vPickRayDir, D3DXVECTOR3 vPickRayOrig){

    bool result;
    int count, i, j, indexCount;
    unsigned int stride, offset;
    float fBary1, fBary2;
    float fDist;
    D3DXVECTOR3 v0, v1, v2;
    float p1, p2, p3;

    // Check to see if the node can be viewed.
    result = frustum->CheckCube(node->positionX, 0.0f, node->positionZ, (node->width / 2.0f));

    if(!result)
    {
        return false;
    }

    // If it can be seen then check all four child nodes to see if they can also be seen.
    count = 0;
    for(i=0; i<4; i++)
    {
        if(node->nodes[i] != 0)
        {
            count++;
            getTriangleRay(node->nodes[i], frustum, device, vPickRayOrig, vPickRayDir);
        }
    }

    // If there were any children nodes then dont continue

    if(count != 0)
    {
        return false;
    }

        // Now intersect each triangle in this node

    j = 0;

    for(i=0; i<node->triangleCount; i++){

        j = i * 3;

        v0 = D3DXVECTOR3( node->vertexArray[j].x, node->vertexArray[j].y, node->vertexArray[j].z);
        j++;
        v1 = D3DXVECTOR3( node->vertexArray[j].x, node->vertexArray[j].y, node->vertexArray[j].z);
        j++;
        v2 = D3DXVECTOR3( node->vertexArray[j].x, node->vertexArray[j].y, node->vertexArray[j].z);

        result = IntersectTriangle( vPickRayOrig, vPickRayDir, v0, v1, v2, &fDist, &fBary1, &fBary2);

        if(result == true){

                        // intersection = true, so get a aproximate center of the triangle on the world

            p1 = (v0.x + v0.x + v0.x)/3;
            p2 = (v0.y + v1.y + v2.y)/3;
            p3 = (v0.z + v1.z + v2.z)/3;

            m_mousepos = D3DXVECTOR3(p1, p2, p3);

            return true;

        }

    }

}

bool QuadTreeClass::IntersectTriangle( const D3DXVECTOR3& orig, const D3DXVECTOR3& dir,D3DXVECTOR3& v0, D3DXVECTOR3& v1, D3DXVECTOR3& v2, FLOAT* t, FLOAT* u, FLOAT* v ){
    // Find vectors for two edges sharing vert0
    D3DXVECTOR3 edge1 = v1 - v0;
    D3DXVECTOR3 edge2 = v2 - v0;

    // Begin calculating determinant - also used to calculate U parameter
    D3DXVECTOR3 pvec;
    D3DXVec3Cross( &pvec, &dir, &edge2 );

    // If determinant is near zero, ray lies in plane of triangle
    FLOAT det = D3DXVec3Dot( &edge1, &pvec );

    D3DXVECTOR3 tvec;
    if( det > 0 )
    {
        tvec = orig - v0;
    }
    else
    {
        tvec = v0 - orig;
        det = -det;
    }

    if( det < 0.0001f )
        return FALSE;

    // Calculate U parameter and test bounds
    *u = D3DXVec3Dot( &tvec, &pvec );
    if( *u < 0.0f || *u > det )
        return FALSE;

    // Prepare to test V parameter
    D3DXVECTOR3 qvec;
    D3DXVec3Cross( &qvec, &tvec, &edge1 );

    // Calculate V parameter and test bounds
    *v = D3DXVec3Dot( &dir, &qvec );
    if( *v < 0.0f || *u + *v > det )
        return FALSE;

    // Calculate t, scale parameters, ray intersects triangle
    *t = D3DXVec3Dot( &edge2, &qvec );
    FLOAT fInvDet = 1.0f / det;
    *t *= fInvDet;
    *u *= fInvDet;
    *v *= fInvDet;

    return TRUE;
} 
```

请问这段代码对吗？如果是，那么我的问题一定与四叉树有关。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T09:47:04.297

遍历所有可见三角形以找到交点非常昂贵。如果您的高度图变得更好，成本将会增加。

对于我的高度图，我使用了不同的方法：

我从原点开始逐步搜索 clickray 上的高度。在每一步，当前位置都会沿射线移动并针对高度图的高度进行测试（因此您需要一个高度函数）。如果当前位置低于高度图，则通过额外的迭代再次搜索最后一个区间以找到更精细的位置。只要您的高度图在与步长有关的高度值中没有太高的频率（否则您可能会跳过峰值），这就会起作用。

# html - 导航中间的标志 - 如何垂直居中

> ID：13962510
> 
> 赞同：0
> 
> 时间：2012-12-19T22:44:37.783
> 
> 标签：html, css, navigation, html-lists

我正在尝试创建一个标题/导航栏，其中徽标的两侧都有导航选项，我希望所有这些都垂直居中。为了实现这一点，我正在使用`<li>`和`<li class>`元素，但在垂直居中时运气不佳。有任何想法吗？

HTML

```
<header>
    <nav>
        <ul>
            <li class="btn"><a href="#"><span>01</span>Home</a></li>
            <li class="btn"><a href="#"><span>02</span>Vendors</a></li>
            <li><a href="#"><img src="img/logo.png" alt="sews logo" /></a></li>
            <li class="btn"><a href="#"><span>03</span>Tickets</a></li>
            <li class="btn"><a href="#"><span>04</span>Blog</a></li>
        </ul>
    </nav>
</header> 
```

CSS

```
nav {
    margin: 40px auto;
    width: 600px;
    padding-bottom: 80px;
}

nav ul li {
    display: inline;
}

nav ul li a {
    margin:0 10px;
}

nav ul li.btn a {
    padding-top: -10px;
}

nav ul li a span {
    color: #e3c22a;

font-family: fanwood; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:52:15.710

`display: table cell`要垂直居中某些东西，除了`vertical-align: middle`容器元素之外，还应用 css 规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:51:16.780

如果链接和图片在同一个元素中，比如一个 div，你可以设置图片使用样式标签：vertical-align:middle;

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-19T22:52:11.280

`position relative`标题。`position absolute`图片。`left: 50%;`图片

# c# - 自定义 App.xaml.cs

> ID：13962512
> 
> 赞同：1
> 
> 时间：2012-12-19T22:44:45.303
> 
> 标签：c#, wpf, xaml

我正在尝试进行一些自定义以`App.xaml.cs`尝试设置一些行为/事件。主要是研究，没什么特别的。

但无论我做什么`App.xaml.class`都没有效果。我什至清空了这个`App.xaml.cs`类（里面什么都没有），WPF 程序仍然可以编译。

在我解开这个谜之前，我什至无法开始学习。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:49:00.213

没有什么奥秘。可以完全清空`App.xaml.cs`，因为它是一个部分类。`App.xaml`完全有能力独立站立。

要进行自定义，请查看[`Application`](http://msdn.microsoft.com/en-us/library/system.windows.application.aspx)MSDN 上的类，特别是“备注”下的部分，其中包含有关应用程序生命周期和应用程序范围对象（窗口、资源）的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T09:56:55.287

如果要进行自定义，可以实现 StartUp 事件，并在那里进行自定义。

您在 App.xaml 中定义事件：

```
<Application x:Class="Test.App"
                xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" 
                Startup="Application_Startup"> 
```

如果您删除 StartUpUri，您还可以自己实例化主窗口。

# javascript - 编写 javascript 时要记录的最有用的内容是什么

> ID：13962514
> 
> 赞同：0
> 
> 时间：2012-12-19T22:44:45.397
> 
> 标签：javascript, jquery, debugging, logging

我正在用 Javascript/JQuery 编写一些代码，其中涉及一些令人困惑的 DOM 操作，或者至少它们对我来说是因为我相对缺乏经验。

我尝试通过做几个`console.log()`s 来帮助自己，但问题是如果你只记录一个 DOM 元素，你会得到无用的信息，主要是`object Object`.

我想知道 HTML 元素最有用的通用属性是什么，以便我可以轻松地了解脚本在做什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:48:12.667

> 我想知道 HTML 元素最有用的通用属性是什么，以便我可以轻松地了解脚本在做什么？

不要使用日志记录进行调试。使用调试器进行调试。甚至 IE（8 及更高版本）也内置了调试器。如果您想知道代码在做什么，没有*什么*可以替代在调试器中逐步执行代码并检查各种变量等。

但在回答您的具体问题时，我想说我想查看 DOM 元素的`tagName`、`className`（例如，class[es]）和`id`（如果有的话）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T22:47:25.087

我会在检查控制台日志时使用 chrome，这些对象实际上是通过的，因此您可以展开并查看它们的所有属性。请记住，一些较旧的浏览器（IE8 或 7）不支持 console.log，它会引发 javascript 错误。

# ruby - 如何在 Rspec2 中创建主题辅助方法

> ID：13962517
> 
> 赞同：0
> 
> 时间：2012-12-19T22:45:08.433
> 
> 标签：ruby, rspec2

在 rpsec 2.12 中，我希望这个辅助方法定义能够工作：

```
module X
private
  def build_them(type)
    puts 'Catching the star'
  end  
end
context 'public/private instance methods' do
  subject{ Class.new { extend(::X) } }
  def subject.build(type)
    puts "Throwing a star"
    build_them(type)
  end
  it{ should respond_to :build}
end 
```

实际结果是失败的规范：

```
expected #<Class:0x00000002ea5f90> to respond to :build 
```

我希望这个例子能够通过

有关如何正确执行此操作的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T11:01:55.917

在不传递块的情况下调用`subject`实际上会以 proc 形式返回“主题”块。这意味着在您的代码中，当您这样做时：

```
def subject.build(type)
  #...
end 
```

您实际上是在*proc*本身上定义“构建”，而不是 proc 返回的对象。

在`it {...}`示例块中，预期是针对 proc 返回的对象执行的，因此如您所见，测试失败。

要使测试通过，您需要在“主题”块将返回的实际对象上定义“构建”方法：

```
module X
  private
    def build_them(type)
      puts 'Catching the star'
    end
end

describe 'public/private instance methods' do
  subject {
    extender = Class.new { extend(::X) }
    def extender.build
      puts "Throwing a star"
      build_them(type)
    end

    extender
  }

  it { should respond_to :build }
end 
```

注意`describe`必须作为顶层上下文，`context`必须嵌套

# mongodb - 如何在 mongodb 中将数据从一列移动到另一列？

> ID：13962521
> 
> 赞同：1
> 
> 时间：2012-12-19T22:45:11.747
> 
> 标签：mongodb

我想将我的数据从“demographic.education”列移动到“demographic.school”。我怎么能这样做？

例如：

```
db.users.update({"demographic.education":{$exists: true, $ne: ""}}, {$set: {"demographic.school":demographic.education}}) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:59:11.953

您可以`$rename`为此使用修饰符：

```
db.users.update({"demographic.education": {$exists: true, $ne: ""}}, {$rename: {"demographic.education": "demographic.school"}}) 
```

[文档](http://docs.mongodb.org/manual/reference/operator/rename/)

# sql-server - 可以为链接服务器调用设置每个查询的 SQL Server 远程查询超时吗？

> ID：13962528
> 
> 赞同：2
> 
> 时间：2012-12-19T22:45:38.417
> 
> 标签：sql-server, linked-server

对于链接服务器，我了解如何更改“远程查询超时”配置以提示对链接服务器的调用应在特定超时值内完成或回滚。这似乎适用于 SQL Server 引擎——是否可以在存储过程中更改提示，以便特定存储过程在需要时可以运行更长时间，但如果所有其他非提示 SPROC 运行时间较长，它们会更快超时?

链接查询超时在这里讨论：http: [//support.microsoft.com/kb/314530](http://support.microsoft.com/kb/314530)

将其设置为在 3 秒内超时的示例代码如下：

```
sp_configure 'remote query timeout', 3       
go 
reconfigure with override 
go 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T03:45:43.673

不建议在存储过程中更改它。 使用 更改时[`remote query timeout`是全局服务器设置](http://msdn.microsoft.com/en-us/library/ms189040.aspx)`sp_configure`，因此在存储过程中更改它会影响服务器上所有链接服务器的所有远程查询。

此外，执行`sp_configure`需要`ALTER SETTINGS`服务器权限，通常只有`sysadmin`并且`serveradmin`具有。将这些权限授予数据访问帐户将是一个安全问题，因为它们可能会通过`sp_configure`命令关闭您的服务器。

我的建议是创建一个具有不同名称的第二个链接服务器，您将只使用这个存储过程。您可以在 SSMS 中[为每个单独的链接服务器配置查询超时](http://msdn.microsoft.com/en-us/library/ms186839%28v=sql.105%29.aspx)。添加第二个链接服务器将使您能够使用不同的链接服务器客户端设置查询同一服务器。如果您使用普通的 SQL Server 链接服务器，则可能需要创建 DNS CNAME 来完成此操作。

# python - MySQLDB查询不返回所有行

> ID：13962529
> 
> 赞同：3
> 
> 时间：2012-12-19T22:45:42.427
> 
> 标签：python, mysql, python-2.7

我正在尝试在 Python 中使用 MySQLDB 进行简单的提取。

我有 2 张桌子（帐户和产品）。我必须查找 Accounts 表，从中获取 acc_id 并使用它查询 Products 表。

Products 表有 10 多行。但是当我运行这段代码时，每次运行它时它都会随机返回 0 到 6 行。

这是代码片段：

```
# Set up connection
con = mdb.connect('db.xxxxx.com', 'user', 'password', 'mydb')

# Create cursor
cur = con.cursor()

# Execute query 
cur.execute("SELECT acc_id FROM Accounts WHERE ext_acc = '%s'" % account_num ) # account_num is alpha-numberic and is got from preceding part of the program

# A tuple is returned, so get the 0th item from it
acc_id = cur.fetchone()[0] 
print "account_id = ", acc_id

# Close the cursor - I was not sure if I can reuse it
cur.close() 

# Reopen the cursor
cur = con.cursor() 

# Second query
cur.execute("SELECT * FROM Products WHERE account_id = %d" % acc_id)

keys = cur.fetchall()
print cur.rowcount # This prints incorrect row count

for key in keys: # Does not print all rows. Tried to directly print keys instead of iterating - same result :(
    print key

# Closing the cursor & connection
cur.close()
con.close() 
```

奇怪的是，我尝试使用调试器（Eclipse 上的 PyDev）单步执行代码，它正确地获取了所有行（存储在变量“键”中的值以及控制台输出都是正确的）。

我确信我的数据库有正确的数据，因为我在 MySQL 控制台上运行了相同的 SQL 并得到了正确的结果。

为了确保我没有不正确地关闭连接，我尝试使用`with con`而不是手动关闭连接，结果相同。

我做了[RTM](http://mysql-python.sourceforge.net/MySQLdb.html)，但我找不到太多可以帮助我解决这个问题的东西。

我哪里错了？

谢谢你。

**编辑**：我现在注意到另一个奇怪的事情。在该行 `cur.execute("SELECT * FROM Products WHERE account_id = %d" % acc_id)`中，我对 acc_id 值进行了硬编码，即创建它 `cur.execute("SELECT * FROM Products WHERE account_id = %d" % 322)`并返回所有行

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:51:39.047

这实际上不是一个答案，只是试图从与 RBK 的聊天中收集所有信息，排除了一堆潜在的问题，但仍然没有提出解释或解决方案，希望其他人可以发现问题或想到其他尝试。

这显然是这一行的东西：

```
cur.execute("SELECT * FROM Products WHERE account_id = %d" % acc_id) 
```

尤其是因为`322`替换了`acc_id`所有内容。（如下所示。）

这条线实际上有两个问题，这可能会妨碍您。您总是希望使用 DB-API 绑定而不是字符串格式（以及任何其他语言中的等价物），以避免 SQL 注入攻击、转义/转换/等的正确性以及效率。此外，DB-ABI 绑定和字符串格式化都需要一个`tuple`参数，而不是单个参数。（由于遗留原因，单个参数*通常*有效，但有时它不起作用，然后它只是令人困惑调试......最好不要这样做。）所以，这应该是：

```
cur.execute("SELECT * FROM Products WHERE account_id = %d", (acc_id,)) 
```

不幸的是，在聊天中讨论了这个问题并让你尝试了很多事情之后，我们无法在这里找到真正的问题。总结我们的尝试：

于是，我们尝试了：

```
cur.execute("SELECT COUNT(*) FROM Devices WHERE account_id = %s" , (333,)) 
print cur.fetchone()[0]

print 'account id =', acc_id
print type(acc_id)
cur.execute("SELECT COUNT(*) FROM Devices WHERE account_id = %s" , (acc_id,)) 
print cur.fetchone()[0] 
```

输出是：

```
10
account id = 333
<type 'long'>
2 
```

重复运行时，最后一个数字在 0-6 之间变化，而第一个数字始终为 10。 using`acc_id`与 using 没有任何不同`333`，但它确实如此。万一一个查询以某种方式“感染”下一个查询，没有前两行，其余的工作方式相同。

因此， using`acc_id`不可能与 using 不同`333`。然而，确实如此。

在聊天期间的某个时间点，我们显然从 Products 移到了 Devices，从 322 移到了 333，但无论如何，上面显示的测试肯定完全按照所示完成，并返回不同的结果。

也许他的 MySQLDb 版本有问题或安装不当。他将尝试寻找更新的版本，或其他 Python MySQL 库之一，看看它是否有所作为。

在这一点上，我的下一个最佳猜测是 RBK 无意中激怒了一些技术老练的恶作剧之神，但我什至无法想到其中的一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T00:26:59.947

我有点想通了这个问题。最后很傻。这是一个比赛条件！

这就是我的实际代码的组织方式：

* * *

```
 Code Block 1
 {code which calls an API which creates an entry in Accounts table &
 Creates corresponding entries in Product table(10 entries)} 
```

……

```
Code Block2
{The code I had posted in my question} 
```

* * *

问题是 API（在代码块 1 中调用）需要几秒钟才能将 10 个条目添加到 Product 表中。

当我的代码（代码块 2）运行提取查询时，没有添加所有 10 行，因此提取了 0 到 6 行之间的某个位置（当时添加了多少）。

为了解决这个问题，我在执行 SQL 查询之前让代码休眠了 5 秒：

```
Code Block 1
time.sleep(5)
Code Block 2 
```

当我硬编码 acc_id 时它起作用的原因是，我硬编码的 acc_id 来自一个宝贵的执行（每次运行都返回一个新的 acc_id）。它在单步调试器中工作的原因是手动单步执行就像给它一个睡眠时间。

对我来说，了解一点 API 的内部工作原理（即使它们应该像一个黑匣子）并在下次遇到类似问题时考虑这样的竞争条件对我来说是一个教训。

# c# - 将对象层次结构转换为对象数组

> ID：13962531
> 
> 赞同：0
> 
> 时间：2012-12-19T22:45:57.330
> 
> 标签：c#

所有，我想创建一个对象数组`foo[]`，其中的构造函数`Foo`是

```
public Foo(string name, string discription){} 
```

我有一个数据库对象，它有一个结构（为简单起见，不包括存储过程、函数或视图），比如

```
public class Database 
{
    public string name { get; set; }
    public string filename { get; set; }
    public List<Table> tables { get; set; }

    public Database(string name, string filename)
    {
        this.name = name;
        this.filename = filename;
    }
}

protected internal class Table 
{
    public string name { get; set; }
    public List<Column> columns { get; set;}

    public Table(string name, List<Column> columns)
    {
        this.name = name;
        this.columns = columns;
    }
}

protected internal class Column
{
    public string name { get; set; }
    public string type { get; set; }

    public Column(string name, string type, int maxLength, 
                  bool isNullable)  
    {
        this.name = name;
        this.type = type;
    }
} 
```

*我想知道向对象数组添加信息`Column`的最快方法？`Table``Foo[]`*

显然我能做到

```
List<Foo> fooList = new List<Foo>();
foreach (Table t in database.tables)
{
    fooList.Add(new Foo(t.Name, "Some Description"));
    foreach (Column c in t.columns)
        fooList.Add(new Foo(c.Name, "Some Description"));
}
Foo[] fooArr = fooList.ToArray<Foo>(); 
```

*但是有更快的方法吗？*显然，对于执行类似操作的查询，LINQ 可能会更慢，但我关心这里的速度，所以任何建议都会受到赞赏。也许使用 HashSet 将是要走的路，因为不会有重复的条目......

谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:48:50.170

您可以使用正确的大小初始化数组，并且只在没有后备列表的情况下使用它：

```
int size = db.tables.Sum(t => t.columns.Count + 1);
Foo[] fooArr = new Foo[size];
int currentSize = 0;
foreach (var tbl in db.tables)
{
    fooArr[currentSize++] = new Foo(tbl.Name, "Some Discription");
    foreach(var c in tbl.columns)
        fooArr[currentSize++] = new Foo(c.Name, "Some Discription");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T23:07:45.333

我会说将您的 foreach 循环更改为 for 循环，如此处所述[在 .NET 中，哪个循环运行得更快，“for”还是“foreach”？](https://stackoverflow.com/questions/365615/in-net-which-loop-runs-faster-for-or-foreach) 数据结构方面，您确实需要可变结构，除非您确切知道将要插入多少条记录到 fooList 中，否则您可以使用数组而不是列表。根据foreach vs for-loop问题的答案，假设它是正确的，List上的for循环比List上的foreach循环便宜2倍多，而数组上的循环比List上的循环便宜约2倍。

所以 2 改进将是：

1.  将 foreach 更改为 for

2.  使用 linq 根据@Tim Schmelter 计算数组的长度，并将 List 更改为 Array

# java - 如何为数据集描述创建 spock 风格的 DSL？

> ID：13962536
> 
> 赞同：4
> 
> 时间：2012-12-19T22:46:31.430
> 
> 标签：java, groovy, spock

我想要一个 spock 数据驱动规范格式的数据集描述：

```
'Key'   |    'Value'    |    'Comments'
1       |    'foo'      |    'something'
2       |    'bar'      |    'something else' 
```

这必须转换为类似 2D 数组的东西（或任何可能实现的东西）。

任何想法如何实现这个数据描述？

ps 最大的问题是换行检测，剩下的可以通过`or`Object的重载来实现`metaClass`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T00:30:42.203

该`|`运算符是左关联的，因此该表中的一行将被解析为：

```
('Key' | 'Value') | 'Comments' 
```

然后，您可以检测每一行的开始和结束位置是让`|`操作符返回一个包含其操作数的列表，然后为每个`|`询问左侧操作数（即`this`）是否是一个列表。如果是，则表示它是一行的延续；如果它不是一个列表，则意味着它是一个新行。

这是一个 DSL 的完整示例，它使用[Category](http://groovy.codehaus.org/gapi/groovy/lang/Category.html)来解析这些数据集，以避免覆盖 Object 元类上的内容：

```
@Category(Object)
class DatasetCategory {
    // A static property for holding the results of the DSL.
    static results

    def or(other) {
        if (this instanceof List) {
            // Already in a row. Add the value to the row.
            return this << other
        } else {
            // A new row.
            def row = [this, other]
            results << row
            return row
        }
    }
}

// This is the method that receives a closure with the DSL and returns the 
// parsed result.
def dataset(Closure cl) {
    // Initialize results and execute closure using the DatasetCategory.
    DatasetCategory.results = []
    use (DatasetCategory) { cl() }

    // Convert the 2D results array into a list of objects:
    def table = DatasetCategory.results
    def header = table.head()
    def rows = table.tail()
    rows.collect { row -> 
        [header, row].transpose().collectEntries { it } 
    }
}

// Example usage.
def data = dataset {
    'Key'   |    'Value'    |    'Comments'
    1       |    'foo'      |    'something'
    2       |    'bar'      |    'something else'
}

// Correcness test :)
assert data == [
    [Key: 1, Value: 'foo', Comments: 'something'],
    [Key: 2, Value: 'bar', Comments: 'something else']
] 
```

在此示例中，我将表解析为地图列表，但在 DSL 闭包运行后，您应该能够对 DatasetCategory 的结果执行任何操作。

# javascript - 轮询 api 时骨干集合不更新

> ID：13962539
> 
> 赞同：0
> 
> 时间：2012-12-19T22:46:34.220
> 
> 标签：javascript, backbone.js, backbone-events, backbone.js-collections

当通过端点轮询更新模型时，我在触发更改事件时遇到了一些麻烦。我很确定这是因为该集合实际上并未更新。我正在使用 Backbone 0.9.9 中的[新选项](http://backbonejs.org/#Collection-fetch)( `update: true`)，它试图智能地更新集合，而不是完全重置它。

`console.log(this)`当我在函数末尾插入 a时`updateClientCollection`，似乎在通过调用`this.clientCollection`时没有更新。但是，我确实看到端点正在被轮询，并且端点正在为客户端返回新的和不同的值。`updateClientCollection``setInterval`

```
managementApp.ClientListView = Backbone.View.extend({
  className: 'management-client-list',
  template: _.template( $('#client-list-template').text() ),

  initialize: function() {
    _.bindAll( this );
    this.jobId = this.options.jobId
    //the view owns the client collection because there are many client lists on a page
    this.clientCollection = new GH.Models.ClientStatusCollection();
    this.clientCollection.on( 'reset', this.addAllClients );
    //using the initial reset event to trigger this view's rendering
    this.clientCollection.fetch({
      data: {'job': this.jobId}
    });
    //start polling client status endpoint every 60s
    this.intervalId = setInterval( this.updateClientCollection.bind(this), 60000 );
  },

  updateClientCollection: function() {
    //don't want to fire a reset as we don't need new view, just to rerender
    //with updated info
    this.clientCollection.fetch({
      data: {'job': this.jobId},
      update: true,
      reset: false
    });
  },

  render: function() {
      this.$el.html( this.template() );
      return this;
  },

  addOneClient: function( client ) {
    var view = new managementApp.ClientView({model: client});
    this.$el.find( 'ul.client-list' ).append( view.render().el );
  },

  addAllClients: function() {
    if (this.clientCollection.length === 0) {
      this.$el.find( 'ul.client-list' ).append( 'No clients registered' );
      return;
    } 
    this.$el.find( 'ul.client-list' ).empty();
    this.clientCollection.each( this.addOneClient, this );
  }
});

managementApp.ClientView = Backbone.View.extend({
  tagName: 'li',
  className: 'management-client-item',
  template: _.template( $('#client-item-template').text() ),

  initialize: function() {
    _.bindAll( this );
    this.model.on( 'change', this.render );
  },

  render: function() {
    this.$el.html( this.template( this.model.toJSON() ) );
    return this;
  }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T02:18:02.280

从我可以从您的代码中收集到的信息来看，您仅对`reset`集合事件具有约束力。

根据文档，当您作为获取选项的一部分传递时，在获取后`Backbone.Collection`使用该方法。`.update()``{ update: true }`

[`Backbone.Collection.update()`](http://backbonejs.org/#Collection-update)为每个模型触发相关`add`的 ,`change`和事件。`remove`您还需要绑定到这些并执行相关功能来更新您的 UI。

在您的情况下，您可以将现有`addOneClient`方法绑定到`add`集合上的事件。

在您的`ClientView`课程中，您可以绑定到`change`和`remove`事件以分别重新渲染和删除视图。请记住使用[`listenTo()`](http://backbonejs.org/#Events-listenTo)，以便对象在它本身`ClientView`时可以轻松地清理事件。`remove()`

# html - 在 HTML 中选择标签

> ID：13962543
> 
> 赞同：0
> 
> 时间：2012-12-19T22:46:39.857
> 
> 标签：html

我正在尝试使用以下代码实现以下目标

```
<tr>
 <td width="2%"/>
  <td>[mc "Always Make List"]</td>
   <td>
    <select id="AML" NAME="ALWAYS_MAKE_LIST" style="margin-left:10px;" onchange="OnChange()">
    <option value="Y">Y</option>
    <option value="N">N</option>
    </select>
 </td>
</tr> 
```

我在下拉列表中获得了额外的空间。我需要将下拉列表中第一个元素的默认值设置为“Y”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:48:30.210

将 Y 选项行更改为`<option value="Y" selected="selected">Y</option>`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:52:47.100

将 selected="selected" 设置为默认选项。

```
<option value="Y" selected="selected">Y</option> 
```

# c# - c# / XNA 4.0-移动纹理以产生无限平面的错觉

> ID：13962549
> 
> 赞同：1
> 
> 时间：2012-12-19T22:47:08.077
> 
> 标签：c#, c#-4.0, math, xna, xna-4.0

在给定纹理位置和相机位置的情况下，我一直无法实现一种算法来移动纹理。图像中的前两张图片解释了我要完成的工作，但我不知道如何相应地移动它们。曾几何时，我创建了一个程序来执行此操作，但我已经失去了它。有任何想法吗？

如果有帮助，相机/视口的宽度和高度与纹理的宽度和高度相同。目标是让他们移动位置，给人一种无限平面的错觉。（无需绘制无限平面，哈哈。）

![前两个例子：](../Images/1bcd9c8fd7dbaf0f98a74c2a2b837003.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:12:43.583

你不需要移动你的区域，足以决定在哪里绘制它们。假设您有一个包含 N*M 块的地形（在这种情况下 N=M=2），它们中的每一个都是 A*A 的大小（在这种情况下，屏幕具有相同的大小，但这没关系），并且瓷砖不断地相互跟随。

```
int LeftColumn = Camera.X / A; // let it round to nearest lower int
int TopRow = Camera.Y / A;

LeftColumn = LeftColumn % N; // Calculate the first tile
TopRow = TopRow % M;

for (int i = LeftColumn+N; i < LeftColumn+2*N; i++)
  for (int l = TopRow+M; l < TopRow+2*M; l++)
  // you may check here if the tile is visible or not based on the screen size
  {
    Tile[i % N, l % M].Draw(i*A, l*A); // Or do whatever you like
  } 
```

这清楚吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-20T00:49:51.290

经过几个小时的反复试验，我终于想出了如何让区域/纹理/矩形相应地移动。对于那些想要解决方案的人，

```
 if ((int)Math.Abs(region.X - camPos.X) > region.Width * 2)
        {
            region.X += region.Width * 2;
        }

        if (camPos.X < region.X - region.Width)
        {
            region.X -= region.Width * 2;
        }

        if ((int)Math.Abs(region.Y - camPos.Y) > region.Height * 2)
        {
            region.Y += region.Height * 2;
        }

        if (camPos.Y < region.Y - region.Height)
        {
            region.Y -= region.Height * 2;
        } 
```

其中 camPos 是相机位置，而 region 是区域/纹理/矩形/其他。

此代码适用于 4 个正方形区域（2 个区域乘 2 个区域）。要更改更多区域，只需将 9 平方区域和 16 平方区域的所有 *2 分别更改为 *3 或 *4。

# ios - 在ios中等待sql查询响应

> ID：13962552
> 
> 赞同：1
> 
> 时间：2012-12-19T22:47:16.810
> 
> 标签：ios, sql, xcode

我正在使用 Xcode 创建一个 iOS 应用程序。我也在使用 SQL 服务器（xampp）。总体来说效果很好。但我在以下几点有问题：

- 我有一个带有表视图的视图控制器，我正在使用 SQL 查询的结果填充这个表（想象 taglist 是一个包含 12 行的数组）

```
- (void)viewDidLoad

[[API sharedInstance] commandWithParams:[NSMutableDictionary dictionaryWithObjectsAndKeys:@"listtags", @"command", nil] onCompletion:^(NSDictionary *json) {

    NSArray* result = [[NSArray alloc] initWithArray:[json objectForKey:@"result"]];
    taglist =[[NSMutableArray alloc] initWithArray:result];
    [taglist removeAllObjects];
    for(NSDictionary* i in result){
        [taglist addObject:[i objectForKey:@"tag"]];
    }
    NSLog(@"sql %u",taglist.count);
}];

NSLog(@"did load %u",taglist.count); 
```

}

tableviews 有两种必需的方法

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section{

NSLog(@"table %u",taglist.count);
return taglist.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"Cell" forIndexPath:indexPath];

NSLog(@"cell %u",taglist.count);
cell.textLabel.text = [taglist objectAtIndex:indexPath.row];

return cell; 
```

}

问题是因为获取查询结果需要一段时间，所以我的表方法使用空的 taglist 数组来填充。NSLogs 的输出是这样的

```
2012-12-19 14:35:41.470 iReporter[33507:c07] did load 0
2012-12-19 14:35:41.473 iReporter[33507:c07] table 0
2012-12-19 14:35:41.476 iReporter[33507:c07] cell 0
2012-12-19 14:35:41.479 iReporter[33507:c07] cell 0
2012-12-19 14:35:41.481 iReporter[33507:c07] cell 0
2012-12-19 14:35:41.483 iReporter[33507:c07] cell 0
2012-12-19 14:35:41.484 iReporter[33507:c07] cell 0
2012-12-19 14:35:41.486 iReporter[33507:c07] cell 0
2012-12-19 14:35:41.487 iReporter[33507:c07] cell 0
2012-12-19 14:35:41.489 iReporter[33507:c07] cell 0
2012-12-19 14:35:41.493 iReporter[33507:c07] cell 0
2012-12-19 14:35:41.564 iReporter[33507:c07] sql 12 
```

这意味着 taglist 数组在 viewDidload 、 numberofRows 和 cellForRow 函数之后是空的。但是当查询完成时，我可以获得正确的值。但是到那时我的表属性已经定义，所以它没有用，我的问题是，有没有办法等待该响应，并在确保它不为空之后使用它来创建表。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:51:16.020

从查询中获得结果并进行更新`taglist`后，调用`[self.tableView reloadData]`.

# powershell - Powershell：下载文件 404 但站点存在

> ID：13962558
> 
> 赞同：2
> 
> 时间：2012-12-19T22:47:33.680
> 
> 标签：powershell, url, download, http-status-code-404

我有一个看起来很简单的小问题......但我就是不明白！我尝试下载以下网站内容：[http](http://cspsp.gshi.org/) ://cspsp.gshi.org/ （如果您尝试通过[www.cspsp.gshi.org](http://www.cspsp.gshi.org)访问它，您会进入错误的页面......）

为此，我在 Powershell 中这样做：
`(New-Object System.Net.WebClient).DownloadFile( 'http://cspsp.gshi.org/', 'save.htm' )`

我可以使用 Firefox 访问该网站并轻松下载其内容，但 Powershell 总是输出类似的内容：（
`The remoteserver returned an Error: (404) Nothing found.`翻译自德语）。

我不确定我在这里做错了什么。谷歌等其他网站运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T02:29:38.407

看起来该站点依赖于`User-Agent`HTTP 客户端发送的请求标头，并且它`System.Net.WebClient`甚至不发送默认值（至少，当我访问我自己的本地服务器时它没有发送。）

无论哪种方式，这对我有用：

```
$request = (New-Object System.Net.WebClient)
$request.headers['User-Agent'] = "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.17 (KHTML, like Gecko) Chrome/24.0.1312.40 Safari/537.17"
$request.DownloadFile('http://cspsp.gshi.org/', 'saved.html') 
```

# c# - 如何加快 MonoTouch 编译时间？

> ID：13962562
> 
> 赞同：45
> 
> 时间：2012-12-19T22:47:57.877
> 
> 标签：c#, xamarin.ios, xamarin, compilation-time

[众所周知](http://www.joelonsoftware.com/articles/fog0000000043.html)，_

> 如果编译甚至需要 15 秒，程序员会在编译器运行时感到无聊并切换到阅读[The Onion](http://www.theonion.com)，这将吸引他们并扼杀数小时的生产力。

我们的 MonoTouch 应用程序需要 40 秒才能在 Macbook Air 上以调试/模拟器配置进行编译。

我们在解决方案中有大约 10 个程序集。
我们还使用`gcc_flags`.

我确信有一些我不知道的优化编译时间的方法，这可能与引用、链接器等有关。

我问这个问题是希望比我有更好知识的人会编译（不是双关语）一个提示和检查的列表，以减少调试构建的 MonoTouch 编译时间。

请**不要**建议硬件优化或与[MonoTouch](http://xamarin.com/monotouch)没有直接关系的优化。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-12-20T02:14:55.997

> ### Xamarin.iOS 6.4 中的构建时间改进
> 
> Xamarin.iOS 6.4 具有[显着的构建时间改进](https://devblogs.microsoft.com/xamarin/)，现在可以选择仅将更新的代码位发送到设备。你自己看：
> 
> [![构建时间改进](../Images/2a6df74b865bb206979af810192d68cf.png)](https://i.stack.imgur.com/nzN9C.png)
> [（来源：[xamarin.com](https://blog.xamarin.com/wp-content/uploads/2013/07/a.png)）]
> 
> [在Rolf 的帖子](https://devblogs.microsoft.com/xamarin/)中阅读更多内容并了解如何启用增量构建。

### 进化 2013 视频

此内容的更新和扩展版本可以在我在[Evolve 2013上发表的](https://channel9.msdn.com/events/Xamarin-Evolve/2016)**[高级 iOS 构建机制](https://channel9.msdn.com/events/Xamarin-Evolve/2016#session-37jlfjcqmn)**演讲的视频中看到。

### 原始答案

有几个因素会影响构建速度。但是，它们中的大多数对设备构建有更大的影响，包括您提到的托管链接器的使用。

**托管链接器**

对于**设备**，**Link all**是最快的，其次是**Link SDK**和（最后）**Don't link**。原因是链接器可以比 AOT 编译器更快地消除代码（净增益）。此外，较小的 .app 将更快地上传到您的设备。

对于模拟器**，不要链接**总是更快，因为没有 AOT（使用 JIT）。除非您想测试它们，否则不应使用其他链接选项（它仍然比进行设备构建更快）。

**设备技巧**

*   构建单一架构（例如 ARMv7）比 FAT 二进制文件（例如 ARMv7 + ARMV7s）更快。更小的应用程序也意味着上传到设备的时间更短；

*   *默认*的AOT 编译器（单声道）比使用 LLVM 编译器快很多。但是后者会生成更好的代码，并且还支持 ARMv7s、Thumb2；

*   如果您的 .app 中捆绑了大型资产，那么使用您的应用程序部署/上传它们（每次都必须签名）将需要时间。我写了[一篇](https://devblogs.microsoft.com/xamarin/)关于如何解决这个问题的博客文章——如果你有大量资产，它可以节省很多时间；

*   对象文件缓存在 MonoTouch 5.4 中实现。一些构建会快很多，但其他构建不会（当必须清除缓存时）更快（但绝不会变慢;-)。更多信息为什么这经常发生[在这里](https://forums.xamarin.com/discussion/605/incremental-aot)）。

*   调试构建需要更长的时间，因为符号、运行`dsymutil`以及由于它最终变得更大，需要额外的时间来上传到设备。

*   默认情况下（您可以将其关闭），发布版本将执行程序集的 IL 条带。这只需要一点时间 - 在将（较小的 .app）部署到设备时可能会恢复。

**模拟器技巧**

*   如前所述，尽量避免链接，因为这将花费更多时间并且需要复制程序集（而不是符号链接）；

*   使用本机库比较慢，因为在这种情况下我们无法重用共享的*simlauncher*主可执行文件，并且需要让 gcc 为应用程序编译一个（这很慢）。

终于每当有疑问的时候了！我的意思是您可以添加`--time --time`到您的项目`extra mtouch arguments`中以在每次操作后查看时间戳:-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T23:18:59.717

这并不是真正的答案，而是一个临时占位符，直到有更好的占位符。
我找到[了 Seb 的这句话](http://monotouch.2284126.n4.nabble.com/Slow-compile-time-for-device-dsymutil-taking-a-long-time-tp4657240p4657243.html)：

> 查看项目的构建选项并确保“链接器行为”位于默认的“链接 SDK 程序集”中。
> 
> 如果它显示“不链接”，那么您将经历*很*长的构建时间（其中很大一部分在 dsymutil 中）。

我不知道它是否仍然相关，因为当我选择此选项时，MonoDevelop 会显示一个警告标志，而且它似乎对性能影响不大。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T23:35:49.450

如果不了解它需要做的所有事情，你就不能指望你的编译器很快。更大的应用程序自然会花费更长的时间。不同的语言或相同语言的不同编译器可能会对编译代码所需的时间产生巨大影响。

我们有一个编译需要将近 2 分钟的项目。最好的解决方案是想办法减少编译代码的次数。

而不是一次又一次地尝试修复一行代码并重建。召集一群人一起讨论这个问题。或者创建一个包含 3 或 4 个您想要处理的事情的列表，完成它们然后进行测试。

这些只是一些建议，并不适用于所有情况。

# php - PHP在检查宽度和高度时防止远程图像下载超过5mb

> ID：13962576
> 
> 赞同：0
> 
> 时间：2012-12-19T22:49:04.050
> 
> 标签：php

我需要知道如何限制 PHP 下载超过 5mb 的文件，如果这样做会返回错误。但如果它通过了，我希望它检查宽度和高度。但我不希望它再次下载文件来检查宽度和高度。这是我当前的代码：

`<?php list($width, $height) = getimagesize('http://www.spacetelescope.org/static/archives/images/large/heic0601a.jpg'); echo $width.' x '.$height;`

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:51:32.897

因为 jpeg 图像实际上并未将其尺寸存储在文件中的某个位置，所以您无法执行此操作。

如果图像大于 5MB，为了防止它尝试获取图像的尺寸，您可以向服务器发出头部请求以获取文件的大小。有关如何执行此操作的信息，请参阅[PHP：无需下载文件的远程文件大小。](https://stackoverflow.com/questions/2602612/php-remote-file-size-without-downloading-file)

它会是这样的：

```
function getRemoteFileSize($remoteFile){
    $ch = curl_init($remoteFile);
    curl_setopt($ch, CURLOPT_NOBODY, true);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_HEADER, true);

    $data = curl_exec($ch);
    curl_close($ch);
    if ($data === false)
        return 0;

    if (preg_match('/Content-Length: (\d+)/', $data, $matches)) 
        return (int)$matches[1];

    return 0;
}

$remoteFile = 'http://www.spacetelescope.org/static/archives/images/large/heic0601a.jpg';

if(getRemoteFileSize($remoteFile) < 5 * 1024 * 1024){
    list($width, $height) = getimagesize($remoteFile); 
    echo $width.' x '.$height;
} 
```

# c#-4.0 - 重载接受`object`作为默认参数类型的方法

> ID：13962582
> 
> 赞同：5
> 
> 时间：2012-12-19T22:49:38.830
> 
> 标签：c#-4.0, overloading

我需要能够调用一个方法并传入一个未知类型的对象，然后调用正确的重载。`object`我还需要一个接受作为其参数类型的默认实现 。我所看到的是默认重载是唯一被使用过的重载。

这是我正在尝试做的事情的要点：

```
class Formatter
{
  private object Value;

  public Formatter(object val){
    Value = val;
  }

  public override string ToString()
  {
    return Format(Value);
  }

  private string Format(object value)
  {
    return value.ToString();
  }

  private string Format(DateTime value)
  {
    return value.ToString("yyyyMMdd");
  }
} 
```

好的，到目前为止一切顺利。现在我希望能够做到这一点：

```
public static class FancyStringBuilder()
{
  public static string BuildTheString()
  {
    var stringFormatter = new Formatter("hello world");
    var dateFormatter = new Formatter(DateTime.Now);
    return String.Format("{0} {1}", stringFormatter, dateFormatter);
  }
} 
```

结果`FancyStringBuilder.BuildTheString()`是`"hello world 2012-12-21 00:00:00.000"`，当我预期`"hello world 20121221"`

问题是`DateTime`没有调用接受 a 的重载，而是默认为接受 a 的重载`object`。 **如何在不使用凌乱的 switch 语句的情况下调用正确的方法？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:57:17.827

我认为这是因为类构造函数接受一个`object`as 参数，然后将该对象分配给`Value`也是一个`object`. 在那里调用 Format(object) 因为`Value`是类型`object`

试试这个

```
public override string ToString()
{
    if(Value is DateTime)
      return Format(Convert.ToDateTime(Value)); //this should call the right method

    return Format(Value); //works for other non-custom-format types e.g. String
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T00:12:43.257

在中，总是**调用**`Formatter.ToString()`覆盖。这是因为重载决议发生在编译时，而不是运行时。在编译时，唯一知道的是它是一个对象。`Formatter.Format(object)`**`Value`**

 **如果你真的想区分传入的类型，你需要在`Formatter`'s 的构造函数中这样做。`ToString()`在这种情况下，您可以立即调用并仅存储格式化的结果，而不是挂在对象上：

```
class Formatter
{
    string formattedValue;

    public Formatter(object value)
    {
        formattedValue = value.ToString();
    }

    public Formatter(DateTime value)
    {
        formattedValue = value.ToString("yyyyMMdd");
    }

    public string ToString()
    {
        return formattedValue;
    }
} 
```

请注意，这确实假设您的对象在创建`Formatter`对象和`Formatter.ToString()`调用时间之间没有变化，或者至少可以在`Formatter`创建时对字符串表示进行快照。

这也假设您在编译时知道传入的类型。如果您想要一个真正仅运行时的解决方案，则必须使用“is”运算符或`typeof()`比较。

如果您的目标只是提供基于传入类型的自定义 ToString() 格式，我可能会使用从类型映射到格式字符串的列表来实现：

```
static class Formatter
{
    private static List<Tuple<Type, string>> Formats;

    static Formatter()
    {
        Formats = new List<Tuple<Type, string>>();

        // Add formats from most-specific to least-specific type.
        // The format string from the first type found that matches
        // the incoming object (see Format()) will be used.
        AddMapping(typeof(DateTime), "yyyyMMdd");
        // AddMapping(typeof(...), "...");
    }

    private static void AddMapping(Type type, string format)
    {
        Formats.Add(new Tuple<Type, string>(type, format));
    }

    public static string Format(object value)
    {
        foreach (var t in Formats)
        {
            // If we find a type that 'value' can be assigned to
            // (either the same type, a base type, or an interface),
            // consider it a match, and use the format string.
            if (t.Item1.IsAssignableFrom(value.GetType()))
            {
                return string.Format(t.Item2, value);
            }
        }

        // If we didn't find anything, use the default ToString()...
        return value.ToString();
    }
} 
```

这样，调用代码如下所示：

```
Console.WriteLine(
    "{0} {1}",
    Formatter.Format(DateTime.Now),
    Formatter.Format("banana")); 
```**

# java - 搜索特定行的文本文件

> ID：13962585
> 
> 赞同：0
> 
> 时间：2012-12-19T22:49:56.953
> 
> 标签：java, parsing, java.util.scanner

我想在文本文件中搜索特定的文本行。如果我要查找的文本位于特定行，我想进一步阅读该行以获取更多输入。

到目前为止，我正在寻找 3 个标签。

```
@public
@private
@virtual 
```

如果我在一行上找到其中任何一个，我想阅读接下来会发生什么，例如，我可以有这样的一行：

```
@public double getHeight(); 
```

如果我确定我找到的标签是，`@public`那么我必须在空格之后执行以下部分，直到我到达分号。问题是，我真的想不出一种有效的方法来做到这一点而不会过度使用`charAt(..)`它看起来既不漂亮，但从长远来看对于大文件或连续多个文件来说可能都不好。

我想帮助有效地解决这个问题，因为我目前无法理解我将如何做到这一点。代码本身用于解析 C++ 文件中的注释，然后生成 Header 文件。伪代码部分是我卡住的地方。有人建议使用 BufferedReader，也有人建议使用 Scanner。我选择了 Scanner，因为它似乎是 BufferedReader 的替代品。

```
public void run() {
    Scanner scanner = null;
    String filename, path;
    StringBuilder puBuilder, prBuilder, viBuilder;
    puBuilder = new StringBuilder();
    prBuilder = new StringBuilder();
    viBuilder = new StringBuilder();
    for(File f : files) {
        try {
            filename = f.getName();
            path = f.getCanonicalPath();
            scanner = new Scanner(new FileReader(f));
        } catch (FileNotFoundException ex) {
            System.out.println("FileNotFoundException: " + ex.getMessage());
        } catch (IOException ex) {
            System.out.println("IOException: " + ex.getMessage());
        }
        String line;
        while((line = scanner.nextLine()) != null) {
            /**
             * Pseudo Code
             * if @public then
             *      puBuilder.append(line.substring(after white space) 
             *      + line.substring(until and including the semicolon);
             */
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:52:50.233

我可能会误解你..但你只是在寻找`String.contains()`吗？

```
if(line.contains("@public")){} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:55:39.143

```
if (line.startsWith("@public")) {
    ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T22:58:01.317

```
String tag = "";
if(line.startsWith("@public")){
   tag = "@public";
}else if{....other tags....}

line = line.substring(tag.length(), line.indexOf(";")).trim(); 
```

这为您提供了一个字符串，该字符串从标记的末尾（在本例中是公共的）开始，然后到分号前面的字符，然后修剪掉末尾的空格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T00:10:31.157

如果您允许使用开源库，我建议使用 apache common-io 和 common-lang 库。这些是广泛使用的 Java 库，它们将使您的生活更简单。

```
String text = null;
InputStream in = null;
List<String> lines = null;
for(File f : files) {
    try{
        in = new FileInputStream(f);
        lines = IOUtils.readLines(in);
        for (String line: lines){
            if (line.contains("@public"){
                text = StringUtils.substringBetween("@public", ";");
                ...
            }
        }

    }
    catch (Exception e){
        ...
    }
    finally{
        // alway remember to close the resource 
        IOUtils.closeQuietly(in);
    }
} 
```

# javascript - 通过单击按钮更改单独 div 中的信息

> ID：13962592
> 
> 赞同：2
> 
> 时间：2012-12-19T22:50:49.510
> 
> 标签：javascript, jquery, button, html

我正在尝试实现这种效果，但我确定编码不正确。我希望图像`DIV`在单击每个按钮时交换内容。这是我到目前为止所拥有的，但我确定代码不正确。有没有更好的方法来实现这一目标？谢谢，请原谅我的菜鸟问题。

**HTML：**

```
<div class="item-1 content-item">
    I am the 1st image content
</div>

<div class="item-2 content-item" style="display: none;">
    I am the 2nd image content
</div>

<div class="item-3 content-item" style="display: none;">
    I am the 3rd image content
</div>

<div class="item-1 content-item">
    I am the content for item 1
</div>

<div class="item-2 content-item" style="display: none;">
    I am the content for item 2
</div>

<div class="item-3 content-item" style="display: none;">
    I am the content for item 3
</div>

<ul>
    <li class="change-item" data-item="1">Item 1</li>
    <li class="change-item" data-item="2">Item 2</li>
    <li class="change-item" data-item="3">Item 3</li>
</ul> 
```

**jQuery：**

```
$('.change-item').click(function(){
    var this_item = $(this).attr("data-item");
    $('.content-item').hide();
    $('.item-' + this_item).fadeIn();  
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:47:37.973

尽管工作正常，但您可能会发现一些有用的提示。

1.  由于您的项目实际上是按数字分组的，而中间的东西是隐藏的，您可以将它们组合在一起。
2.  您应该考虑在标记中使用 id 属性。这更清楚地表明您的每个项目都是独一无二的，并使 javascript 运行得更快。
3.  你`<ul>`在技术上是有序的，所以它更恰当地是一个`<ol>`. 这是分裂的头发，会给你数字而不是要点，让你做更多的工作来正确地设计它。但值得一提。
4.  考虑给出一些指示列表项是交互式的。您可以为它们制作按钮或锚点（因此它们会像超链接一样显示）。或者尝试使用 css 规则让光标在用户通过链接时改变鼠标指针。

像这样：

```
.change-item {
    cursor: pointer;
} 
```

把它们放在一起，它可能看起来像这样：

**HTML：**

```
<div id="item-1" class="content-item">
    <img src="/item-1.png"/>
    <p>I am the content for item 1</p>
</div>

<div id="item-2" class="content-item" style="display:none;">
    <img src="/item-2.png"/>
    <p>I am the content for item 2</p>
</div>

<div id="item-3" class="content-item" style="display:none;">
    <img src="/item-3.png"/>
    <p>I am the content for item 3</p>
</div>

<ol>
    <li><a href="#" class="change-item" data-item="1">Item 1</a></li>
    <li><a href="#" class="change-item" data-item="2">Item 2</a></li>
    <li><a href="#" class="change-item" data-item="3">Item 3</a></li>
</ol> 
```

**Javascript：**

```
$('.change-item').click(function(){
    var this_item = $(this).attr("data-item");
    $('.content-item').hide();
    $('#item-' + this_item).fadeIn();
}); 
```

但正如您所知，您的代码功能齐全。您没有做任何严重错误的事情（干得好！），这些只是可能使您或您的用户更容易使用此页面的一些事情。

# objective-c - 重新加载子视图（UICollectionview）

> ID：13962600
> 
> 赞同：3
> 
> 时间：2012-12-19T22:51:56.083
> 
> 标签：objective-c, ios, uicollectionview

在我的 ViewController 中，我有四个子视图，即 UITableView、UICollectionView、带有 UILabels 的视图和显示该项目的预览图像的视图。

通过在 tableview 中选择一行，我可以更改预览图像和所有标签。但是我无法刷新 UICollectionView 数据。我尝试[了这个](https://stackoverflow.com/questions/8979585/reload-refresh-subviews-setneedsdisplay-doesnt-work)解决方案，但它只是删除并添加了视图，并且更改了布局和预览图像消失了。

我要做的就是刷新 UICollectionView 内容。有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T22:55:12.717

你试过`[self.collectionView reloadData];`吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:07:57.457

要仅刷新 UICollectionView 的一部分，您也可以这样调用：

```
[self.collectionView reloadItemsAtIndexPaths:@[indexPath]] 
```

其中 indexPath 是您要重新加载的单元格。您也可以在数组中包含多个索引路径。要重新加载整个第一部分，您可以这样称呼：

```
NSIndexSet *sections = [NSIndexSet indexSetWithIndex:0];
[self.collectionView reloadSections:sections]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T22:58:44.507

假设您已将 UICollectionView 正确连接到数据源 (UICollectionViewDataSource)，您可以调用`[myCollectionView reloadData]`以使您的集合视图调用数据源的方法（如下所示）以刷新自身：

```
– collectionView:numberOfItemsInSection:
– numberOfSectionsInCollectionView:
– collectionView:cellForItemAtIndexPath:
– collectionView:viewForSupplementaryElementOfKind:atIndexPath: 
```

# css - Ubuntu CLI (Vagrant) 中的红色文件名

> ID：13962601
> 
> 赞同：0
> 
> 时间：2012-12-19T22:52:09.077
> 
> 标签：css, ubuntu, vagrant, fuelphp, livereload

我正在构建一个在 Vagrant 支持的 Ubuntu VM 上运行的 FuelPHP 应用程序。

我试图在我所有页面的全局包装器中包含一个 CSS 文件，但 Firebug 告诉我它不存在。（我的 <_link rel...> 中的文件路径是正确的）。

![萤火虫](../Images/25e499b8593fc251152c4f2737b735d2.png)

CSS 文件实际上是使用名为 LiveReload for Mac 的应用程序从一堆 LESS 文件编译而来的。

我的虚拟机上的 Apache 服务器设置为从我的 Mac 上安装的文件夹中提供服务，任何使用过 Vagrant 的人都应该知道我的意思。

无论如何，LiveReload 将 CSS 文件转储到正确的位置，并在我的 Mac 上填充：

![苹果电脑](../Images/a050afe26554c2d17188ad6dd9511aa7.png)

然而，通过 SSH 连接到 VM 并检查 CSS 文件让我相信发生了一些奇怪的事情。首先，文件名是红色的（但它存在！）：

![红色文件名](../Images/4ccf58b524987ce49b5bfc54f7a4ab29.png)

其次，使用文本编辑器（在本例中为 nano）打开它会显示它是空白的，尽管它在 Mac 上已满：

![空白的](../Images/8faa7ec37da4633490501955089fca8f.png)

所以我的问题是......这里发生了什么？为什么它在虚拟机上显示为空？为什么是红色的？为什么 Apache 找不到并提供服务？

编辑，仍在为此苦苦挣扎。

我添加了自己的“test.css”文件，它加载得很好。只是不是 LiveReload 生成的 app.css。虚拟机有问题。任何人都可以帮忙吗？这是阻碍我发展的那些烦人的事情之一。

这是堆栈跟踪（尽管我确信它没有任何用处）：

![英石](../Images/d480bdec2bd49cbbfdfdc7a59a13d596.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:54:27.520

如果我猜对了，那么您有一个错误的 mod 重写规则，它将您的请求重定向到一个 php 脚本，该脚本试图包含一个不存在的文件。

所以检查你的 .htaccess 文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T16:17:15.780

啊，将文件重命名为 appcss.css 而不是 app.css 并且它可以工作。改回来了，不行 出于某种原因，系统一定不喜欢这个名字。讨厌我浪费的时间，但现在修复了！

# actionscript-3 - Flash Builder 4.6 Mobile Flex AS3：如何与嵌入式 SWF 通信

> ID：13962607
> 
> 赞同：0
> 
> 时间：2012-12-19T22:52:30.530
> 
> 标签：actionscript-3, flash-builder, flash, communication

我有一个 Flash 条形码扫描仪（相机），想在移动项目中使用它来扫描二维码。如果可以重新使用此 SWF 并将其嵌入到移动 Flex 应用程序中，那就太好了。SWF 是在 Flash CS5 中制作的。

到目前为止，嵌入（并将其添加到舞台并显示它）是成功的，但我如何与 SWF 通信？例如调用它的函数或使用事件。

这是一个代码片段：

```
[Embed(source="../cam/cam.swf")]
private var cam:Class;

....
....

public const EVT_SNAPSHOT : String = "onSnapShot";
public var camera : Object;

public function onInit(e:Event) : void
{
 this.camera = new cam();
 this.camera.addEventListener(Event.ADDED_TO_STAGE, this.cameraInit );
 this.stage.addChild( this.camera as DisplayObject );
}

private function cameraInit(e:Event):void
{
 trace( 'Added to stage' );
 this.stage.addEventListener( EVT_SNAPSHOT, this.cameraDoScan ); // does not bind?
 trace( this.camera.hasOwnProperty('getAppInfo') ); // shows 'false'
}

private function cameraDoScan(e:MouseEvent):void
{
 trace('MouseClick!');
} 
```

有谁知道与这个“东西”交流？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T14:07:27.557

使用外部 swf 模块最实用的方法是将其加载到当前的 ApplicationDomain 中，因此您将可以访问此加载的 swf 中包含的所有类：

```
package
{
import flash.display.DisplayObject;
import flash.display.Loader;
import flash.display.Sprite;
import flash.events.Event;
import flash.system.ApplicationDomain;
import flash.system.LoaderContext;
import flash.utils.ByteArray;
import flash.utils.getDefinitionByName;

public class astest extends Sprite
{

    [Embed(source="/../assets/art.swf", mimeType="application/octet-stream")]
    private static const art:Class;

    public function astest()
    {
        var artBytes:ByteArray = new art() as ByteArray;
        var loader:Loader = new Loader();
        loader.contentLoaderInfo.addEventListener(Event.COMPLETE, onArtLoaded);
        loader.loadBytes(artBytes, new LoaderContext(false, ApplicationDomain.currentDomain));
    }

    protected function onArtLoaded(e:Event):void
    {
        var domain:ApplicationDomain = ApplicationDomain.currentDomain;
        if(domain.hasDefinition("welcome_view"))
        {
            var moduleClass:Class = domain.getDefinition("welcome_view") as Class;
            var module:Object = new moduleClass();
            //module.moduleFunction();
            addChild(module as DisplayObject);
        }else
        {
            trace("loaded swf hasn't class 'welcome_view'");
        }
    }
}
} 
```

# go - 避免过多的转换

> ID：13962610
> 
> 赞同：9
> 
> 时间：2012-12-19T22:52:42.993
> 
> 标签：go

我当前的 Go 代码中有一些部分如下所示：

```
i := int(math.Floor(float64(len(l)/4))) 
```

由于某些函数类型签名，例如 in ，冗长似乎是必要的`math.Floor`，但是可以简化吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-19T23:15:20.060

一般来说，Go 的严格类型会导致一些冗长的表达式。冗长并不意味着口吃。类型转换做有用的事情，明确说明这些有用的事情是有价值的。

简化的技巧是不要编写不需要的类型转换，为此您需要参考诸如语言定义之类的文档。

在您的具体情况下，您需要知道 len() 返回 int，并且值 >= 0。您需要知道 4 是一个常量，将在此表达式中采用 int 类型，您需要知道该整数除法将返回整数商，在这种情况下它将是一个非负整数，实际上正是您想要的答案。

```
i := len(l)/4 
```

这个案子很简单。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T22:55:37.393

我不是 100% 确定 Go 如何处理整数除法和整数转换，但通常是通过截断。因此，假设 len(l) 是一个 int

```
i:=len(l)/4 
```

否则`i:= int(len(l))/4`或者`i:=int(len(l)/4)`应该工作，第一个理论上比第二个快一点。

# hibernate - Hibernate/HQL实现SQL WHERE...IN(SELECT...)查询

> ID：13962616
> 
> 赞同：0
> 
> 时间：2012-12-19T22:53:18.733
> 
> 标签：hibernate, subquery, hibernate-criteria, where-in

使用 Hibernate 实现以下涉及子查询的 SQL 查询的等效方法是什么：

```
SELECT cat.description, cat.code FROM
  THING_CATEGORY cat
WHERE cat.code IN (
  SELECT thing.CATEGORY_CODE FROM THING thing
  WHERE thing.COUNTRY_CODE IN ('AU', 'US', 'UK')
) 
```

最好的方法可能是将其直接传递给数据库，以我的数据库风格的 SQL (PL/SQL) 本地完成，但我实际上无法弄清楚它是如何在 Hibernate`Criterion`对象中完成的，所以我特别想知道。

请注意：该`THING`表绝对庞大并且有很多列，所以我不想`THING`从数据库中拉下所有实体来实现这个逻辑，因为它不会是高性能的。限制`THING_CATEGORY`结果的逻辑必须在可以优化的数据库内部完成。事实上，当我使用原始 PL/SQL 进行查询时，几乎需要一秒钟才能得到结果。

给出实体的概念（请注意，`THING_CATEGORY`没有对 的引用`THING`）：

```
@Entity @Table(name = "THING")
public class Thing
{
  private String categoryCode;
  @Column(name = "CATEGORY_CODE", nullable = false, length = 3)
  public String getCategoryCode() { return this.categoryCode; }

  private String countryCode;
  @Column(name = "COUNTRY_CODE", nullable = false, length = 2)
  public String getCountryCode() { return this.countryCode; }

  ...
}

@Entity @Table(name = "THING_CATEGORY")
public class ThingCategory
{
  private String code;
  @Id @Column(name = "CODE", unique = true, nullable = false, length = 3)
  public String getCode() { return this.code; }

  ...
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:53:18.733

当我即将发布问题时，我意识到答案是使用 Hibernate`DetachedCriteria`来包含`THING`限制子查询。然后将其添加到`THING_CATEGORY`主查询的条件中。

所以 Hibernate 代码如下所示：

```
public List<ThingCategory> getRestrictedByCountrySet(List<String> countryCodes)
{
  Criterion thingCriterion = Restrictions.in("countryCode", countryCodes);
  DetachedCriteria thingSubQuery = DetachedCriteria.forClass(Thing.class)
    .add(thingCriterion)
    .setProjection(Projections.property("categoryCode");

  Criteria thingCategoryCriteria = getHbSession().createCriteria(ThingCategory.class)
    .add(Property.forName("code").in(thingSubQuery));

  return thingCategoryCriteria.list();
} 
```

# .htaccess - .htaccess RewriteRule 不使用查询字符串作为目录

> ID：13962630
> 
> 赞同：0
> 
> 时间：2012-12-19T22:54:46.067
> 
> 标签：.htaccess, mod-rewrite

我有以下代码：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !(\.[a-zA-Z0-9]{1,5}|/|#(.*))$
RewriteRule ^(.*)$ $1/ [R=301,L]

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^([^\.]+)/$ $1.php
RewriteRule ^([^\.]+)/([^\.]+)/$ $1.php?id=$2 
```

我在使用绝对 URI 时遇到了问题，它解决了。现在我想将最后一行用于以下内容：

`domain.com/query/ping/2/`

到

`domain.com/query/ping.php?id=2`

我认为代码很好，但我仍然返回错误 404。我应该给出一些重写条件吗？我搜索了这段代码，但没有发现任何有用的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:06:08.110

根据您在上一个问题中放置 htaccess 文件的位置，您可能想要这样的内容：

```
RewriteCond %{REQUEST_URI} ^/query/([^/]+)/([^/]+)/?
RewriteCond %{DOCUMENT_ROOT}/query/%1.php -f
RewriteRule ^ /query/%1.php?id=%2 [L] 
```

重要的问题是您需要`/query`在 URI 的开头进行检查。您所拥有的`^([^\.]+)/([^\.]+)/$`不会与该`/query`部分及其后面的 2 个路径名匹配。您的正则表达式仅匹配 2 个路径名。

该行`RewriteCond %{DOCUMENT_ROOT}/query/%1.php -f`类似于您上面的条件，它检查请求的 PHP 文件是否实际存在，否则不会盲目重写。这种情况确保如果有人试图去：

`http://domain.com/query/blahblahblahblah/blah`

您的服务器不会返回 404 错误，说明`/query/blahblahblahblah.php`不存在。

# javascript - thead 和 tbody 之间的列不匹配

> ID：13962631
> 
> 赞同：2
> 
> 时间：2012-12-19T22:54:54.123
> 
> 标签：javascript, html, css

我在这里有一个应用程序：[应用程序](http://helios.hud.ac.uk/u0867587/Mobile_app/QandATable3.php)

在应用程序中，请执行以下操作：

1.  您将在左侧看到一个绿色的加号按钮，单击它，它将打开一个模式窗口。

2.  在模式窗口的搜索栏中输入短语`single`并提交搜索。下面将显示一个表格。

3.  通过单击“添加”按钮从表中添加一行，它将在顶部控件中添加信息。

4.  最后点击“添加问题”按钮，这将在下面添加一个表格行。

现在我遇到的问题是 中的列`<thead>`和 中的列`<tbody>`不匹配。我的问题是如何让这些列匹配？

下面的 HTML 代码显示了附加的行：

```
 var $tbody = $('#qandatbl > tbody'); 
    var $tr = $("<tr class='optionAndAnswer' align='center'>");
    var $td = $("<td class='extratd'>");
    var $plusrow = $("<td class='plusrow'></td>");
    var $qid = $("<td class='qid'></td>").text(qnum);
    var $question = $("<td class='question'></td>");
    var $noofanswers = $("<div class='noofanswers'>2\. Number of Answers:<br/></div>");
    var $options = $("<div class='option'>1\. Option Type:<br/></div>");
    var $answer = $("<div class='answer'>3\. Answer:<br/></div>");
    var $replies = $("<td class='noofreplies'><div class='wrapper'></div></td>");
    var $weight = $("<td class='weight'></td>");
    var $image = $("<td class='image'></td>"); 
    var $video = $("<td class='video'></td>");
    var $audio = $("<td class='audio'></td>");

...

    $tr.append($plusrow);
    $tr.append($qid);
    $tr.append($question);
    $tr.append($td);
    $td.append($options);
    $td.append($noofanswers);
    $td.append($answer);
    $tr.append($replies);
    $tr.append($weight);   
    $tr.append($image);  
    $tr.append($video);
    $tr.append($audio);
    $tbody.append($tr); 
```

下面是 html 表，其中包含表标题列以及表行附加到的位置：

```
<table id="qandatbl" align="center">
<thead class="tblhead">
<tr>
    <th></th>
    <th class="qid">Question No</th>
    <th class="question">Question</th>
    <th class="optandans">Option and Answer</th>
    <th class="noofreplies">Number of Replies</th>
    <th class="weight">Number of Marks</th>
    <th class="image">Image</th>
    <th class="video">Video</th>
    <th class="audio">Audio</th>
</tr>
</thead>
<tbody class="tblbody">
</tbody>
</table> 
```

最后是CSS代码：

```
body{
    font-size:85%;  
}           

#qandatbl{
    border:1px black solid;
    border-collapse:collapse;
}

#qandatbl td { 
    vertical-align: middle;
}

#qandatbl th{
    border:1px black solid;
    border-collapse:collapse;
    text-align:center;
}

.tblhead, .tblbody {
    display: block;
}

.tblbody{
    height: 500px;
    overflow: auto;
    width:100%; 
}

.extratd{
    border:1px black solid;
    border-collapse:collapse;
}

.qid { 
    min-width:3%;
    max-width:3%;
    font-weight:bold;
    border:1px black solid;
    border-collapse:collapse;
}

.question { 
    min-width:25%;
    max-width:25%;
    border:1px black solid;
    border-collapse:collapse;
}

.noofanswers{
    min-width:100%;
    max-width:100%;
    padding-top:5%;
    padding-bottom:5%;
}

.noofreplies{
    min-width:3%;
    max-width:3%;
    border:1px black solid;
    border-collapse:collapse;
}

.optandans{
    min-width:30%;
    max-width:30%;
    border:1px black solid;
    border-collapse:collapse;
}

.option{
    min-width:100%;
    max-width:100%;
    padding-top:5%;
    padding-bottom:5%;
}

.weight { 
    min-width:3%;
    max-width:3%;
    border:1px black solid;
    border-collapse:collapse;
    }

.answer { 
    min-width:100%;
    max-width:100%;
    padding-top:5%;
    padding-bottom:5%;
     }

.audio{
    min-width:11%;
    max-width:11%;
    border:1px black solid;
    border-collapse:collapse;
    }

.video{
    min-width:11%;
    max-width:11%;
    border:1px black solid;
    border-collapse:collapse;
    }

.image{
    min-width:11%;
    max-width:11%;
    border:1px black solid;
    border-collapse:collapse;
    position:relative;
    }

.plusrow{
    min-width:2%;
    max-width:2%;
    border:1px black solid;
    border-collapse:collapse;
    } 
```

我已经包含了一个 jsfiddle，因此您可以查看它的演示并测试您的任何想法：http: [//jsfiddle.net/heA2b/1/](http://jsfiddle.net/heA2b/1/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T23:26:30.870

第一个答案（user1721135）不正确，这是因为您已为 thead 和 tbody 分配了“块”的显示。删除它，您的问题就会消失。

他是对的，如果它们相同，您不必分配混合和最大宽度，但这不是导致您的问题的原因。

编辑以添加工作示例：[http ://codepen.io/joe/pen/gqzbf](http://codepen.io/joe/pen/gqzbf)

# size - 为什么可用尺寸不同

> ID：13962632
> 
> 赞同：1
> 
> 时间：2012-12-19T22:54:55.960
> 
> 标签：size, android-camera, android-mediarecorder

再说一次，真的不知道如何表达这个问题，所以我会解释一下。

我有一个录像机应用程序。我打开我的相机

```
cameraRecorder = Camera.open(1); //(this is the front facing camera) 
```

并获取相机参数和所有支持的预览尺寸

```
CameraParameters tmpParams = cameraRecorder.getParameters();

List<Camera.Size> tmpList = tmpParams.getSupportedPreviewSizes(); 
```

运行 ICS (4.0.4) 的 Galaxy Tab 10.1 上的预览尺寸之一是 800x600

但是当我尝试在媒体播放器中设置视频大小时

```
mediaRecorder.setVideoSize(800,600); 
```

我收到此错误：

```
12-19 17:27:55.035: E/CameraSource(110): Video dimension (800x600) is unsupported
12-19 17:27:55.035: E/StagefrightRecorder(110): cameraSource do not init
12-19 17:27:55.035: E/StagefrightRecorder(110): setupCameraSource failed. (-19)
12-19 17:27:55.035: E/StagefrightRecorder(110): setupMediaSource is failed. (-19)
12-19 17:27:55.035: E/StagefrightRecorder(110): setupMPEG4Recording is failed. (-19)
12-19 17:27:55.035: E/MediaRecorder(30119): start failed: -19 
```

有谁知道为什么会存在这种差异（我知道支持的记录大小之一是 1280x720，但这对我来说太大了）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:00:40.390

那是因为预览和录制是不同的。您应该使用[Camera.Parameters.getSupportedVideoSizes()](http://developer.android.com/reference/android/hardware/Camera.Parameters.html#getSupportedVideoSizes%28%29)中指定的尺寸。

```
public List<Camera.Size> getSupportedVideoSizes ()
Gets the supported video frame sizes that can be used by MediaRecorder. 
```

# javascript - 从外部 js 加载的固定页脚会“重叠”站点内容

> ID：13962633
> 
> 赞同：0
> 
> 时间：2012-12-19T22:54:57.047
> 
> 标签：javascript, jquery, html, css, jquery-mobile

我有一个`position:fixed; height:100px;width:100%; bottom:0;`从外部 .js 文件（`document.write("...");`）（外部服务器）加载的 div。

我面临的问题是`position:fixed`div 总是与实现外部 .js 的站点的剩余 100px 重叠。是否有任何 css/js 解决方法来解决该问题？所有修改都必须在该外部 .js 文件中完成，因为我无法访问站点本身的源代码，它们只是加载外部 javascript 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:33:37.107

调整身体的底部填充`100px`

```
$('body').css('padding-bottom', '100px') 
```

# c# - Automation in c# .Net

> ID：13962634
> 
> 赞同：2
> 
> 时间：2012-12-19T22:55:10.877
> 
> 标签：c#, .net

I need to write a program in .NET which runs every few hours and does some task. It does not require user interaction but it needs a configuration file like App.config where I can put that configuration information.

So should I write console program in C# ( like php or perl script) and schedule it in task manager ( like crontab) or write a Windows Service or something else?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T22:58:34.047

If you want scheduling capabilities and that schedule needs to be very configurable, a windows scheduled task does that pretty well. You would write that as a console app.

However, I would suggest a service for most things. Here is a great tutorial that talks about how to create windows services. Its much easier than you think.

[http://www.switchonthecode.com/tutorials/creating-a-simple-windows-service-in-csharp](http://www.switchonthecode.com/tutorials/creating-a-simple-windows-service-in-csharp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:59:07.433

My suggestion would be to go for the console app and use the task manager.

1.  It saves you from having to implement a custom timer
2.  It gives you elaborate control over timing
3.  It saves you from having to implement an UI
4.  It gives you automation options, like piping in- and output at the command line

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T23:01:39.477

Depending on the complexity of your task the best option would be to create an application which can be run via a task scheduler. If you need to run something every few hours a windows service would also work, but remember if you create a windows service then you will have to use a timer control within your application which might hang up without giving any clues. There are lots of examples for both the concepts and instead of using windows service you can use Window Communication Foundation (WCF).

# c - 移动机器人设置步数（Arduino）

> ID：13962636
> 
> 赞同：2
> 
> 时间：2012-12-19T22:55:26.363
> 
> 标签：c, arduino

我想将我的机器人移动一定数量的步数，然后让它停止。然而，循环似乎无限运行。我使用 void loop() 的方式或者我编写“for”循环的方式是否有错误？

```
 // walkerForward.pde - Two servo walker. Forward.
// (c) Kimmo Karvinen & Tero Karvinen http://BotBook.com
// updated - Joe Saavedra, 2010
#include <Servo.h> 

Servo frontServo;  
Servo rearServo;  
int centerPos = 90;
int frontRightUp = 75;
int frontLeftUp = 120;
int backRightForward = 45;
int backLeftForward = 135;

void moveForward(int steps)
{
  for (int x = steps; steps > 0; steps--) {
    frontServo.write(centerPos);
    rearServo.write(centerPos);
    delay(100);
    frontServo.write(frontRightUp);
    rearServo.write(backLeftForward);
    delay(100);
    frontServo.write(centerPos);
    rearServo.write(centerPos);
    delay(100);
    frontServo.write(frontLeftUp);
    rearServo.write(backRightForward);
    delay(100);
  }
}

void setup()
{
  frontServo.attach(2);
  rearServo.attach(3);
}

void loop()
{
    moveForward(5);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:59:59.530

该`loop()`函数在无限循环中执行（如果您检查 Arduino IDE 附带的主 cpp 文件，您会看到如下内容：

```
int main()
{
    setup();
    for (;;) {
        loop();
    }
    return 0;
} 
```

因此，要么调用你的`moveForward()`函数`setup()`并创建`loop()`一个空函数，要么`exit(0);`从`loop()`after内部调用`moveForward()`。第一种方法如下所示：

```
void setup()
{
    frontServo.attach(2);
    rearServo.attach(3);

    moveForward(5);
}

void loop()
{
} 
```

第二个看起来像这样：

```
void setup()
{
    frontServo.attach(2);
    rearServo.attach(3);
}

void loop()
{
    moveForward(5);
    exit(0);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T02:00:16.030

Since you probably will want to eventually do more than move the robot just 5 steps, I'd suggest using a variable flag to hold the robot state. It only executes the movement routine when the flag has been set to true.

If you are using serial, when a move command is received (and the number of steps, direction perhaps?) you set the flag to true and then issue the move command. If you are using sensors or buttons, the same logic applies.

You will need some logic to handle an incoming movement command while a movement is occurring (though with your tight movement loop you actually won't be able to respond to incoming commands unless you use interrupts - but you want to consider this sort of thing if you are planning to build out a full movement bit of firmware).

```
boolean shouldMove;

void setup()
{
 shouldMove = true;//set the flag
}

void loop()
{
  if (shouldMove){
    moveForward(5);
  }
}

void moveForward(int steps)
{
 shouldMove = false; //clear the flag
  for (int x = steps; steps > 0; steps--) {
   // tight loop controlling movement
  }
} 
```

}

# php - 使用字符串时 PHP 比较中断

> ID：13962639
> 
> 赞同：1
> 
> 时间：2012-12-19T22:55:39.867
> 
> 标签：php, variables, string-comparison

我对比较“错误”感到困惑。我编码这个比较的方式，我想确保如果用户输入**除**0 或 1（或没有值）以外的任何值，结果应该是 0：

```
session_start();
function test( $status = 0 ) {
        if( !isset($_SESSION['status']) ) { $_SESSION['status'] = 0; }
        else {
            switch( $status ) {
                case 0: $_SESSION['status'] = $status;
                break;

                case 1: $_SESSION['status'] = $status;
                break;

                default:
                $_SESSION['status'] = 0; 
                $status = 0;
            }
        }
        echo 'Variable value: ' . $status;
        echo ' | Session value: ' . $_SESSION['status'] . "<br/>";
}
test();
test(0);
test(1);
test(999);
test('ready'); 
```

但是，它会中断，`test('ready');`因为它输出`Variable value: ready | Session value: ready`RATHER THAN `Variable value: 0 | Session value: 0`。`case o:`即使它正在将数字与字符串进行比较，它也应该继续正常工作（并继续前进）。

顺便说一句：即使我替换`switch`为，结果也是一样的`if( $status ===`

**=== 编辑：2012 年 12 月 19 日 ===**
感谢[@bryan-b](https://stackoverflow.com/users/295949/bryan-b)和[@jatochnietdan](https://stackoverflow.com/users/1866328/jatochnietdan)的评论和回答：`-Because a string (when compaired with numbers [`if( 0 == 'string')`] ) is compared as 0`

这帮助我找出了问题并了解到，与其他语言不同，**它不会在比较中自动返回 false，因为它们具有不同的数据类型**；php 比较字符串变量，就好像它们的值与数字比较时为 0。**这是需要注意的。**

这是更正的（工作）代码：

```
session_start();
function test( $status = 0 ) {
        if( !isset($_SESSION['status']) ) { $_SESSION['status'] = 0; }
        else {
            switch( $status ) {
                case 1: $_SESSION['status'] = $status;
                break;

                default:
                $_SESSION['status'] = 0; 
                $status = 0;
            }
        }
        echo 'Variable value: ' . $status;
        echo ' | Session value: ' . $_SESSION['status'] . "<br/>";
}
test();
test(0);
test(1);
test(999);
test('ready'); 
```

谢谢[@bryan-b](https://stackoverflow.com/users/295949/bryan-b)和[@jatochnietdan](https://stackoverflow.com/users/1866328/jatochnietdan)！！！

PS。我希望我可以投票 2 个答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T23:07:38.003

如果您真正想要的只是 $_SESSION['status'] 的值在输入 1 以外的任何值时为 0，那么这就足够了：

```
function test( $status = 0 ) {
    $_SESSION['status'] = ($status == 1 ? 1 : 0);
} 
```

通过您的测试，这些值将如下所示：

```
Session value: 0
Session value: 0
Session value: 1
Session value: 0
Session value: 0 
```

编辑：修正了一个小错误，它默认为 1，但我相信你希望它默认为 0。

至于您的代码，它出现“就绪”的原因是因为您将 $_SESSION['status'] 设置为 $status 以防 0 并且 $status 在该实例中包含“就绪”。你可以通过简单地做 $_SESSION['status'] = 0 来解决这个问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T23:05:04.467

我认为这里的问题是 php 将字符串“ready”转换为整数，因此大小写比较有效。从 php 文档（[http://php.net/manual/en/function.intval.php](http://php.net/manual/en/function.intval.php)）：

> 字符串很可能返回 0，尽管这取决于字符串最左边的字符。整数转换的通用规则适用。

我在（工作）函数中添加了一个回显，显示当将字符串转换为 int 以进行开关比较时 php 正在做什么。您需要检查传入状态的确切值和类型。

```
function test($status = 0){
    if(!isset($_SESSION['status']) || $status !== 1){ 
        $_SESSION['status'] = 0; 
    }
    else {
        $_SESSION['status'] = 1;
    }

    echo 'Variable value: ' . $status;
    echo ' | Variable value (int): ' . (int)$status;
    echo ' | Session value: ' . $_SESSION['status'] . "<br/>";
}
test();
test(0);
test(1);
test(999);
test('ready'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T23:11:28.203

发生这种情况是因为 php 中的 switch 使用了一种叫做：[松散比较的东西。](http://php.net/manual/en/types.comparisons.php#types.comparisions-loose)

这意味着字符串的`"value"`计算结果为`0`，因此它永远不会像您想象的那样达到默认值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T00:05:41.740

PHP 是松散类型的，字符串输入可以作为整数进行评估以进行比较（事实上，我认为无论如何您的代码都依赖于此）。

包含非数字字符的字符串将评估为整数 0 - 因此您在 switch 语句中的案例将像 0 到 '0' 和 1 到 '1' 一样容易地匹配 0 到 'ready'。

所以 - 你可以这样做：

```
$_SESSION['status'] = 0;
if ($status == 1) {
  $_SESSION['status'] = 1;
} 
```

或者使用[ctype](http://php.net/manual/en/ref.ctype.php)函数来检测字符串中的数值。

# ab-testing - 多变量拆分测试框架

> ID：13962640
> 
> 赞同：0
> 
> 时间：2012-12-19T22:55:49.837
> 
> 标签：ab-testing

有谁知道任何设计用于在服务器端代码上运行拆分测试的开源软件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T18:43:14.383

我知道一些 FOSS 多变量测试工具。我不确定它们是否能满足您的需求。

*   [Genetify](https://github.com/gregdingle/genetify/wiki) - javaScript 工具。我已经使用了几次并且对此感到满意。
*   [Vanity](http://vanity.labnotes.org/) - Rails 工具
*   [A/Bingo](http://www.bingocardcreator.com/abingo) - Rails 工具
*   [七分钟绝对](https://github.com/paulmars/seven_minute_abs)- Rails 工具
*   [DIY](http://www.tonylegrone.com/the-tech/diy-ab-split-testing-using-php-and-mysql) - 展示如何使用 PHP 和 MySQL 构建自己的文章（包括代码）。

# java - Java SWT 按钮图像不刷新

> ID：13962641
> 
> 赞同：3
> 
> 时间：2012-12-19T22:55:51.523
> 
> 标签：java, image, button, swt

我在一个按钮中显示一个图像，当单击该按钮时，它会打开一个合成，允许我选择另一张图片用于该按钮。在保存操作时，下面的代码会调整图片大小并将其保存到目录中。然后它加载重新加载复合材料。当复合加载时，按钮会根据用户正在查看的记录的 ID 从默认位置拉取其图像。我遇到的问题是按钮上的图像保持不变，除非我关闭并重新加载应用程序。需要注意的一个有趣的事情是，当加载默认按钮图像（即没有为其 id 保存图片）时，按钮图像会按应有的方式更改，但只是第一次。希望我已经足够清楚地描述了我的问题，如果您需要我澄清，请发表评论。

--- 保存按钮代码 --

```
Button btnSave = new Button(this, SWT.NONE);
    btnSave.addSelectionListener(new SelectionAdapter() {
        @Override
        public void widgetSelected(SelectionEvent e) {
            String path = txtPhotoPath.getText();
            if (CC_Files.fileExists(path)) {
                ArrayList<String> picTypes = new ArrayList<String>();
                picTypes.add(".jpg");
                picTypes.add(".png");
                picTypes.add(".gif");
                int t = 0;

                for(int i = 0; i < picTypes.size(); i++){
                    String s = picTypes.get(i);
                    if(path.contains(s.toUpperCase())){
                        t++;
                    }
                    if(path.contains(s.toLowerCase())){
                        t++;
                    }
                }
                if (t > 0) {
                    Image image = (Image) SWTResourceManager.getImage(path);
                    ImageData imgData = image.getImageData();
                    int intH = image.getBounds().height;
                    int intW = image.getBounds().width;
                    int h = (150 * intH) / intW;
                    int w = 150;
                    if (h > 150){
                        h = 150;
                        w = (150 * intW) / intH;
                    }
                    imgData = imgData.scaledTo(w, h);
                    ImageLoader imageLoader = new ImageLoader();
                    imageLoader.data = new ImageData[] { imgData };
                    imageLoader.save(Variables.getStrResources()
                            + "Pics\\" + a.getHerd_id() + ".jpg",
                            SWT.IMAGE_JPEG);
                    try {
                        Frm_Animal.setAnimalEditSC(Frm_Animal
                                .createAnimalComp(a));
                    } catch (Exception e1) {
                        // TODO Auto-generated catch block
                        e1.printStackTrace();
                    }
                }
            }
        }
    });
    GridData gd_btnSave = new GridData(SWT.LEFT, SWT.CENTER, false, false,
            1, 1);
    gd_btnSave.widthHint = 60;
    btnSave.setLayoutData(gd_btnSave);
    btnSave.setText("Save"); 
```

---在复合中创建按钮的代码---

```
Button btnPic = new Button(composite, SWT.CENTER);

    btnPic.addSelectionListener(new SelectionAdapter() {
        @Override
        public void widgetSelected(SelectionEvent e) {
            try {
                Comp_Add_Photo photo = new Comp_Add_Photo(
                        scrolledComposite, SWT.FILL, a);
                setAnimalEditSC(photo);

            } catch (Exception e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }
        }
    });

    Image image = null;
    String strPic = Variables.getStrResources() + "Pics\\" + a.getHerd_id() +".jpg";
    if(CC_Files.fileExists(strPic)){
        image = (Image) SWTResourceManager
                .getImage(strPic);
    }else {
    image = (Image) SWTResourceManager
            .getImage(Variables.getStrResources() + "black_cow.png");
    }

    btnPic.setImage(image);

    btnPic.setToolTipText("Click Here To Add Photo");
    GridData gd_btnPic = new GridData(SWT.CENTER, SWT.CENTER, false, false,
            1, 7);
    gd_btnPic.heightHint = 160;
    gd_btnPic.widthHint = 160;
    btnPic.setLayoutData(gd_btnPic); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T11:28:30.740

我认为这可能是因为您正在使用`SWTResourceManager`它并且它必须具有某种缓存。由于图像的路径保持不变，因此它返回旧图像。`SWTResourceManager`属于哪个API ？它可以在重新加载新图像之前处理单个图像吗？也许调用类似`SWTResourceManager#dipose()`. 我希望有某种方法可以清除特定图像的缓存。

# php - 调用未定义的方法 Config::getConfig()

> ID：13962643
> 
> 赞同：1
> 
> 时间：2012-12-19T22:56:10.287
> 
> 标签：php, flexpaper

我正在使用 XAMP 运行的 Windows XP 上测试[Flexpaper](http://flexpaper.devaldi.com/)插件，问题是它不显示 pdf，检查它说的 php 错误日志：

> PHP 致命错误：在第 24 行调用 C:\xampp\htdocs\PDFViewer\php\services\view.php 中未定义的方法 Config::getConfig()

文件夹结构为：（省略不相关文件）

```
htdocs/
    |->PDFViewer/
        |->php/
            |->admin_files/
            |->config/
                |->config.ini.win.php
            |->lib/
                |->common.php
                |->pdf2json_php5.php
                |->pdf2swf_php5.php
                |->config.php
            |->services/
                |->view.php 
```

view.php 代码片段

```
require_once("../lib/common.php");
require_once("../lib/pdf2swf_php5.php");
require_once("../lib/swfrender_php5.php");
require_once("../lib/pdf2json_php5.php"); 
```

pdf2json_php5.php 的代码片段

```
require_once("config.php");
require_once("common.php"); 
```

pdf2swf_php5.php 的代码片段

```
require_once("config.php");
require_once("common.php"); 
```

swfrender_php5.php 的代码片段

```
require_once("config.php");
require_once("common.php"); 
```

在你问之前，是的，config.php 确实有 getConfig 方法

* * *

编辑：添加了 config.php

```
<?php date_default_timezone_set('America/New_York'); ?>
<?php
class Config{
  protected $config;

    public function __construct()
    {
        if (!defined('ROOT')) {
            define('ROOT', dirname(dirname(dirname(__FILE__))));
        }

        if (!defined('APP_DIR')) {
            define('APP_DIR', basename(dirname(dirname(__FILE__))));
        }   

        if( PHP_OS == "WIN32" || PHP_OS == "WINNT"  )
            $this->config = parse_ini_file($this->getConfigFilename());
        else
            $this->config = parse_ini_file($this->getConfigFilename());
    }

    public function getConfigDir(){
        if( PHP_OS == "WIN32" || PHP_OS == "WINNT"  )
            return dirname(__FILE__) . '\\..\\config';
        else
            return dirname(__FILE__) . '/../config'; 
    }

    public function getConfigs(){
        return $this->config;
    }

    public function getConfig($key = null)
    {
      if($key !== null)
      {
        if(isset($this->config[$key]))
        {
          return $this->config[$key];
        }
        else
        {
          return null;
        }
      }
      else
      {
        return $this->config;
      }
    }

    public function setConfig($config)
    {
      $this->config = $config;
    }

    public function getDocUrl(){
        return "<br/><br/>Click <a href='http://flexpaper.devaldi.com/docs_php.jsp'>here</a> for more information on configuring FlexPaper with PHP";
    }

    public function getConfigFilename(){
        if( PHP_OS == "WIN32" || PHP_OS == "WINNT"  )
            return ROOT . '\\' . APP_DIR . '\\config\\config.ini.win.php';
        else
            return ROOT . '/' . APP_DIR . '/config/config.ini.nix.php';
    }

    public function saveConfig($array){
        $this->write_php_ini($array,$this->getConfigFilename());
    }

    function write_php_ini($array, $file)
    {
        $res = array();
        foreach($array as $key => $val)
        {
            if(is_array($val))
            {
                $res[] = "[$key]";
                foreach($val as $skey => $sval) {
                    $sval = str_replace("\"","\\\"",$sval);
                    $res[] = "$skey = ".(is_numeric($sval) ? $sval : '"'.$sval.'"');
                }
            }
            else {
                $val = str_replace("\"","\\\"",$val);
                $res[] = "$key = ".(is_numeric($val) ? $val : '"'.$val.'"');
            }
        }
        $this->safefilerewrite($file, implode("\r\n", $res));
    }

    function safefilerewrite($fileName, $dataToSave)
    {   
        $dataToSave = "; <?php exit; ?> DO NOT REMOVE THIS LINE\r\n" . $dataToSave;

        if ($fp = fopen($fileName, 'w'))
        {
            $startTime = microtime();
            do
            {  
               $canWrite = flock($fp, LOCK_EX);

               // If lock not obtained sleep for 0 - 100 milliseconds, to avoid collision and CPU load
               if(!$canWrite) usleep(round(rand(0, 100)*1000));
            } while ((!$canWrite)and((microtime()-$startTime) < 1000));

            //file was locked so now we can store information
            if ($canWrite)
            {            fwrite($fp, $dataToSave);
                flock($fp, LOCK_UN);
            }
            fclose($fp);
        }else{
            throw new Exception('Cant write to config ' . $fileName);
        }

    }   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T21:58:03.517

看起来我在添加`C:/xampp/htdocs`到`include_path`php.ini 中的变量后让它工作了，然后只修改了 require_once 函数。

View.php 中的 require_once 部分如下所示：

```
require_once("PDFViewer/php/lib/common.php");
require_once("PDFViewer/php/lib/pdf2swf_php5.php");
require_once("PDFViewer/php/lib/swfrender_php5.php");
require_once("PDFViewer/php/lib/pdf2json_php5.php"); 
```

对于`pdf2swf_php5.php`,`swfrender_php5.php`和 也是如此`pdf2json_php5.php`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T04:50:52.430

修改view.php的代码片段为：

```
$ds = DIRECTORY_SEPARATOR;
require_once("..{$ds}lib{$ds}common.php");
require_once("..{$ds}lib{$ds}pdf2swf_php5.php");
require_once("..{$ds}lib{$ds}swfrender_php5.php");
require_once("..{$ds}lib{$ds}pdf2json_php5.php"); 
```

# php - 如何根据用户坐标和半径从表中检索数据

> ID：13962644
> 
> 赞同：3
> 
> 时间：2012-12-19T22:56:16.593
> 
> 标签：php, mysql, geolocation, latitude-longitude

`php`基本上，我向具有用户 lat 和 long 值（`$userLat, $userLong`分别） 的文件发送 GET 请求。
在我的数据库中，我有一个表“位置”，其中包含以下列：

*   地点名称
*   纬度
*   液化天然气
*   半径（米）

所以，我想进行一个查询，将用户的坐标与所有位置坐标进行比较，看看位置和用户之间的距离是否<=该位置的半径。如果是，则返回该位置的名称。

查询将是这样的（伪代码）：

> SELECT Location_Name FROM Locations WHERE distanceBetween(($userLat, $userLong) AND (Lat, Lng)) <= Radius

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T17:12:21.640

我使用与@socca1157 回答的查询相同的查询，但我认为我可以`3959`在查询开始时对常量提供一个微小的解释。

我的示例还获取了用户地址的 lat 和 lng

```
$address = urlencode($_GET['user-address']);

$earth_radius = 3959;
$search_radius = 100;

$ch = curl_init('https://maps.google.com/maps/api/geocode/json?address='.$address.'&sensor=false');

curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
$geocode = curl_exec($ch);
curl_close($ch);

$output = json_decode($geocode);

$lat = $output->results[0]->geometry->location->lat;
$lng = $output->results[0]->geometry->location->lng;

$sql = "SELECT *, ( $earth_radius * acos( cos( radians($lat) ) * cos( radians( latitude ) ) * cos( radians( longitude ) - radians($lng) ) + sin( radians($lat) ) * sin( radians( latitude ) ) ) ) AS distance FROM table WHERE isActive = 1 HAVING distance < $search_radius ORDER BY distance LIMIT 5";
$result = mysql_query($sql); 
```

因此，例如，如果您想以公里而不是英里进行搜索，您将使用以公里为单位的地球半径，即 6,371 公里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T17:07:03.410

您要查找的查询是：

`SELECT id, ( 3959 * acos( cos( radians(37) ) * cos( radians( lat ) ) * cos( radians( lng ) - radians(-122) ) + sin( radians(37) ) * sin( radians( lat ) ) ) ) AS distance FROM markers HAVING distance < 25 ORDER BY distance LIMIT 0 , 20;`

这取自[谷歌地图的文章](https://developers.google.com/maps/articles/phpsqlsearch_v3)。

# windows-8 - 无法从命令提示符执行 ISETool.exe (Windows 8)

> ID：13962649
> 
> 赞同：1
> 
> 时间：2012-12-19T22:56:35.250
> 
> 标签：windows-8, windows-phone

我正在尝试使用 Windows Phone SDK 中的独立存储资源管理器工具来检索存储在特定 Windows Phone 应用程序的独立存储中的数据并将其复制到驻留在我计算机中的文件夹中。

我的电脑运行 Windows 8 Pro，并且安装了 WP7 和 WP8 SDK。

问题是，当我运行命令提示符并插入命令行（如下面的）时，我收到一条错误消息：

“此应用程序无法在您的 PC 上运行”

我该如何解决这个问题？谢谢

例子：

> ISETool.exe ts xd f8ce6878-0aeb-497f-bcf4-65be961d4bba c:\data\myfiles

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T23:13:40.373

我建议您尝试使用[Windows Phone 电源工具](http://wptools.codeplex.com/)，而不是您正在做的事情。它会给你一个很好的用户界面，而不是试图让一个命令行工具工作。

如果您真的想使用该工具，请发布您从哪个目录运行它，否则很难说出它为什么不起作用。

# android - 如何避免将图片保存在图库中或在 Android 中自动删除？

> ID：13962652
> 
> 赞同：2
> 
> 时间：2012-12-19T22:56:47.550
> 
> 标签：android, android-camera, android-capture

该设备是三星 Galaxy III。我开发了一个应用程序来运行相机活动并捕获图像。分析图像后，我打印出一些文本信息。现在，每个捕获的图像都保存在画廊中。我不需要将图像保存在图库或 SD 卡中。我认为以下两种解决方案中的任何一种都适合我，但我不知道如何编程：

1.  避免将图片保存到图库。
2.  删除APP某处的图片。

任何意见表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:07:12.760

阅读[Android 相机教程](http://developer.android.com/guide/topics/media/camera.html)。

> > ...
> > 
> > **存储**- 您的应用程序生成的图像或视频是否打算仅对您的应用程序可见或共享，以便其他应用程序（例如图库或其他媒体和社交应用程序）可以使用它们？即使您的应用程序被卸载，您是否希望图片和视频可用？查看[保存媒体文件](http://developer.android.com/guide/topics/media/camera.html#saving-media)部分以了解如何实现这些选项。

或查看此：[如何将相机拍摄的图像保存在特定文件夹](https://stackoverflow.com/questions/8402378/how-to-save-image-captured-with-camera-in-specific-folder)中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-20T08:47:43.800

在启动时的相机意图中，添加以下内容：

`intent.putExtra(MediaStore.EXTRA_OUTPUT,Uri.fromFile(getTempFile(context)));`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T19:18:13.927

我通过以下两个步骤解决了我的问题：

1.  正如“@auselen”所指出的，将所有图像保存到特定文件夹。[如何将使用相机拍摄的图像保存在特定文件夹中。](https://stackoverflow.com/questions/8402378/how-to-save-image-captured-with-camera-in-specific-folder)

2.  删除应用程序某处该文件夹中的所有图像。[如何在 Android 中从 SDCard 中删除图像](https://stackoverflow.com/questions/4469744/how-to-delete-image-from-sdcard-in-android)

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2014-08-05T05:42:30.920

```
use this for delete a pic 
```

> `ImgPhoto1.setImageBitmap(null);`

# sql - 计算多个字段

> ID：13962653
> 
> 赞同：0
> 
> 时间：2012-12-19T22:56:51.760
> 
> 标签：sql, sql-server, sql-server-2008

如何从字段 A、B、C 的表中获取输出以显示

```
A | Count(A) 
```

其中行数 = A 的不同实例，count(A) 的值之和等于数据库中的总行数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:00:06.563

SELECT A, COUNT(1) FROM your_table_name GROUP BY A;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:06:06.427

您可以在 COUNT 中使用 DISTINCT 关键字

像这样：

```
COUNT(DISTINCT A) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T23:11:07.097

就像 AI 提到的数据集一样，最终结果会有所帮助。从你给出的小例子中，我认为这可能是你正在寻找的

SELECT Field_A, Count(*) FROM table_name GROUP BY Field_A UNION ALL SELECT Field_B, Count(*) FROM table_name GROUP BY Field_B UNION ALL SELECT Field_C, Count(*) FROM table_name GROUP BY Field_C

根据您在 Field_A、Field_B、Field_C 中拥有多少唯一值，其输出将类似于

Value_In_A1 - 10 Value_In_A2 - 11 Value_In_A3 - 15 Value_In_A4 - 8 Value_In_B1 - 9 Value_In_C1 - 25 Value_In_C2 - 2

# java - 如何创建一个八度工具箱？

> ID：13962655
> 
> 赞同：1
> 
> 时间：2012-12-19T22:57:03.533
> 
> 标签：java, octave

我已经创建了自己的 java 库，但现在我想创建自己的 octave 工具箱。我该如何开始。是否有关于如何在 octave 中创建工具箱的 hello world 教程？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T00:36:50.690

有两个关于它的主要文件。[官方手册](http://www.gnu.org/software/octave/doc/interpreter/Packages.html)和[Octave Forge](http://octave.sourceforge.net/developers.html)的手册（它们有点重叠）。在我看来，您的代码将依赖于 java 包。然而，这个包几周前被合并到 Octave 核心中，并且在那里经历了很多变化。您可能希望使用开发源测试您的包。

但是请注意，作为 java 库的简单包装器的 octave 包很可能会不受欢迎。

# android - 使用 Google Maps API v2 android 添加标记功能

> ID：13962656
> 
> 赞同：2
> 
> 时间：2012-12-19T22:57:08.160
> 
> 标签：android, google-maps-markers, android-maps

我正在使用新功能 addMarker googlemaps api for android。

```
map.addMarker(new MarkerOptions()
        .position(new LatLng(40.417325, 40.417325))
        .title("Hello!")); 
```

效果很好，但我的问题是，如何放置指示搜索字符串的标记而不是指示经度和纬度参数？

就像是：

"virgen de lujan 42, 塞维利亚, 西班牙"

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-05T15:10:58.750

在这里，我发布了 Google MapView 的所有代码。它适用于 Fragment 和 Activity。此代码是为 Api V2 编写的

```
public class GeneralGoogleMapviewFragment extends Fragment {

private GoogleMap mMap;
private static final LatLng SYDNEY = new LatLng(31.0162, 71.6926);
private static final LatLng MOUNTAIN_VIEW = new LatLng(32.9043, 110.4677);
protected static final String TAG = "GeneralGoogleMapview";
private List<MyDataHolder> list;
private JSONObject jsonObj;
Intent intent;

MapView m;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Bundle bundle = getArguments();
    String extra = bundle.getString("json");
    if (extra != null) {
        try {
            jsonObj = new JSONObject(extra);
            Logger.d(TAG, "Extra value is :" + extra.toString());
            list = Parser.parse(jsonObj);

        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
    try {
        MapsInitializer.initialize(this.getActivity());
    } catch (GooglePlayServicesNotAvailableException e) {
        e.printStackTrace();
    }
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    View v = inflater.inflate(R.layout.mapview, container, false);
    m = (MapView) v.findViewById(R.id.mapView);
    m.onCreate(savedInstanceState);
    loadMap(list);
    return v;

}

@Override
public void onResume() {
    super.onResume();
    m.onResume();
    // setupMap();

}

@Override
public void onPause() {

    super.onPause();

    m.onPause();

}

@Override
public void onDestroy() {

    super.onDestroy();

    m.onDestroy();

}

@Override
public void onLowMemory() {

    super.onLowMemory();

    m.onLowMemory();

}

public void loadMap(List<MyDataHolder> markerlist) {

    mMap = m.getMap();
    MyDataHolder todaymarker;
    if (markerlist != null) {
        Logger.d(TAG, " No of Markers" + markerlist.size());
        for (int i = 0; i < markerlist.size(); i++) {
            todaymarker = markerlist.get(i);
            // Logger.d(
            // TAG,
            // " Marker Detail : " + " Latitude "
            // + todaymarker.getLocation().getLatitude() + " Longitude"
            // + todaymarker.getLocation().getLongitude() + " title "
            // + todaymarker.getEvents().getTitle());
            mMap.addMarker(new MarkerOptions()
                    .position(
                            new LatLng(todaymarker.getLoc_latitude(),
                                    todaymarker.getLoc_longitude()))
                    .title(todaymarker.getName())
                    .icon(BitmapDescriptorFactory
                            .fromResource(R.drawable.marker_icon)));
        }
    }

    mMap.setOnMarkerClickListener(new OnMarkerClickListener() {

        @Override
        public boolean onMarkerClick(Marker marker) {
            MyDataHolder todaymarker, todaymarker2 = null;
            if (list != null) {
                Logger.d(TAG, " No of Markers" + list.size());
                for (int i = 0; i < list.size(); i++) {
                    todaymarker = list.get(i);
                    if (todaymarker.getName().equals(marker.getTitle()))
                        todaymarker2 = todaymarker;
                }
            }

            Intent intent = new Intent();
            intent.setClass(getActivity(), SpecificPOI_Activity.class);
            intent.putExtra("poi", todaymarker2);
            intent.putExtra("type", "sobre");
            startActivity(intent);
            return true;
        }
    });

    // mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(new
    // LatLng(31.50099,74.324741), 16.0f));
    /*
     * mMap.moveCamera(CameraUpdateFactory.newLatLngZoom( new
     * LatLng(Util.currentLocation.getLatitude(),
     * Util.currentLocation.getLongitude()), 16.0f));
     */
    mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(new LatLng(
            -16.677224, -49.267698), 16.0f));
    mMap.setMyLocationEnabled(true);

}

  } 
```

我也在发布 xml 文件 **mapview.xml**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T22:58:05.427

您必须使用地理编码找到与该“搜索字符串”相关的纬度和经度。Android 中有一个`Geocoder`类和各种其他的地理编码 Web 服务可供您使用。

# ios - 作为 iOS 开发人员，我可以通过 RCA 到 30 针连接器访问提供给设备的视频信号吗？

> ID：13962658
> 
> 赞同：1
> 
> 时间：2012-12-19T22:57:27.353
> 
> 标签：ios, video

我正在寻找使用外部源处理视频馈送，并想知道标准问题 RCA 到 30 针连接器电缆是否是正确的解决方案。

这是标准的 Apple 电缆：[http ://store.apple.com/us/product/MC748ZM/A/apple-composite-av-cable](http://store.apple.com/us/product/MC748ZM/A/apple-composite-av-cable)

我对 iOS 编程知之甚少，但我已经做了一些，但无法找到是否可以反向访问提要的答案（通常电缆用于流式传输视频，因此您可以将其连接到电视/你有什么）。

有人知道吗？谢谢，祝你圣诞快乐！

# joomla - 在 Dev 和 Prod 服务器之间同步 Joomla？

> ID：13962663
> 
> 赞同：2
> 
> 时间：2012-12-19T22:58:13.190
> 
> 标签：joomla, joomla2.5, sync, production

我很好奇其他人是如何处理这个问题的。我们的小组已获得使用 Joomla 实施内部网站的指示。我们为负责维护站点的人员设置了开发服务器和生产服务器。我们正在使用 IIS 和当前版本的 Joomla。

我可以将两者与 Akeeba Backup Core 和 Kickstart 同步，但这似乎是一个“全有或全无”的选择。它有效，但如果她正在处理例如网站的外观和感觉，但只是想同步内容，那似乎不可行。

我觉得肯定有人之前已经解决了这个目标，但是网络搜索似乎发现人们在同一台服务器上但在不同的子目录中运行 dev/prod，或者忽略问题的“全有或全无”问题，继续对于“一次全部做”的方法，这似乎不切实际。内容经常变化，但外观/感觉却并非如此。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-12T14:32:07.907

我们已经这样做了好几年了。我们使用开发服务器和产品服务器。当我们在 dev 上进行内容更改时，我们使用 phpMyAdmin 将内容表从 dev db 复制到 prod db。在某些方面，它仍然是一种全有或全无的方法，因为我们必须一次复制整个内容表。这意味着当您进行复制时，您不能让某些页面仍在开发中。在其他方面，它仍然是一种零碎的方法，因为我们可以复制单个表，例如模块、菜单等。但同样，它是一次所有模块、一次所有菜单等。phpMyAdmin 中有一种方法可以复制一个人从dev中的一个表中取出page或者item，放到prod中对应的表中，但是有点麻烦。不过，它有效。

至于设计元素（图像、css、模板更改等），我们做同样的事情，但复制是通过 ftp 手动完成的，从一台服务器到另一台服务器。显然，对于需要移动到 prod 的 dev 上的 pdf 文件之类的东西，这是相同的方法。

总而言之，这种方法在很长一段时间内对我们来说效果很好。但它的限制是你必须意识到你正在一次复制整个表。

所有这一切的积极之处在于，当我们有正在开发的页面时，我可以利用内容让人们快点完成他们的工作，因为一个未完成的页面可以支撑整个网站！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T01:09:31.597

这个工作流程困境对我来说已经出现了几次。

您提到外观和感觉的更改，如果只是模板更改，那真的更简单。拉下实时服务器的 Akeeba 备份，将其启动到本地服务器，处理模板文件，然后将更新的模板文件上传到实时服务器，这非常简单。

也就是说，如果它不仅仅是对现有文件的 CSS 和 HTML 调整，那么它可能是一个更复杂的过程。

就我个人而言，我还没有找到解决这类事情的灵丹妙药，但经过深思熟虑和计划，这还不算太糟糕。

# javascript - jQuery Fading Text 在 IE8 和

> ID：13962665
> 
> 赞同：5
> 
> 时间：2012-12-19T22:58:19.077
> 
> 标签：javascript, jquery, internet-explorer-8, fadeout

我在 IE8 中使用 jQuery 淡入和淡出文本时遇到问题。我正在使用 FlexSlider (WooThemes)。另外...如果可能的话，我还想停止背景图像上的淡入淡出（在幻灯片 1 之后）。

这是我的[测试站点](http://dev1.strongtie.com/genuine/template-index2.html)。

### jQuery 代码

```
jQuery(window).load(function(){
  jQuery('.flexslider').flexslider({
    animation: "fade",
    animationLoop: false,
    touch: true,
    slideshowSpeed: 10000,
    startAt: 0,
    pauseOnAction: true,            //Boolean: Pause the slideshow when interacting with control elements, highly recommended.
    pauseOnHover: true,            //Boolean: Pause the slideshow when hovering over slider, then resume when no longer hovering
    start: function(slider){
    jQuery('body').removeClass('loading');

  },

  after: function(slider) {
    jQuery('#backgman').stop("fade");
  },

  end: function(slider){
    // $('#result').load('form.html');
    // window.location = "template-form.html"
    //alert('Ready was performed.');
  }

  }); 

  jQuery('#slide-text').css({zIndex:7}).fadeOut(0);
  jQuery('#slide-text').css({zIndex:6}).fadeOut(0);

}); 
```

我有一个 IE8 css 文件并且使用过`opacity:inherit; filter:inherit;` 我认为我真的很接近得到它......有什么想法/建议吗？如果您需要任何其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T08:09:09.460

您必须删除您在`"UL"`标签中使用的 div 并`float:left`在您的`li`样式中设置。

应该是这样的

```
<ul>
  <li style="float:left;">...</li>
  <li style="float:left;">...</li>
</ul> 
```

例如，看看[这个链接](http://radiantq.com/)，它工作正常。

希望，这个对你有帮助！

# string - 使用 Groovy 将长哈希分成单独的行

> ID：13962672
> 
> 赞同：3
> 
> 时间：2012-12-19T22:58:49.903
> 
> 标签：string, hash, groovy

我有一个没有空格的长哈希（64 个以上字符），我需要在每行或每张表中显示其中的 2 个。为了使表格保持可观的宽度，我想将这些散列分成多行。

我正在寻找一些很酷的 Groovy 配方来执行此操作或某种可能会处理它的 HTML 样式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T23:01:09.723

要每行显示 8 个字符，您可以执行以下操作：

```
hash.toList().collate( 8 )*.join().join( '\n' ) 
```

# php - 多张照片上传到相册和故事墙

> ID：13962674
> 
> 赞同：2
> 
> 时间：2012-12-19T22:59:05.723
> 
> 标签：php, facebook, batch-file, photo, history

我有信心通过使用 PHP 的常见批处理请求将多张照片发布到粉丝页面相册，并且我还知道如何使用 che "no_story" 命令隐藏显示刚刚上传的每张图片的墙贴。我需要知道的是，是否可以在粉丝页面上显示一个独特的墙贴来显示整个上传，就像您使用网络界面上传更多图片时的标准 Facebook 行为，而不是每张照片一个帖子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T00:16:33.730

这是我得到的最接近的：

```
$attachment = array
(
'access_token'=>$fanPageAccessToken,
'object_id' => $AlbumId,
'message' => $AlbumDesc,
'link' =>$AlbumLink
);
$result = $facebook->api($fanPageId.'/links/','post',$attachment);
} 
```

我通过查询与粉丝页面关联的专辑来获取变量：

```
$fanPageAlbums = $facebook->api($fanPageId . '/albums/');
foreach ($this->fanPageAlbums['data'] as $fanPageAlbum) {

if ($albumId == $fanPageAlbum['id']) {
   $albumLink = $fanPageAlbum['link'];
   $albumDesc = $fanPageAlbum['description'];
   break;
  }
 } 
```

关键是您发布到图表的链接部分，而不是提要。

正如您所期望的那样，它会产生一张大图和下面的三个拇指。但是，它没有正确出现在朋友的提要上。

我多年来一直在为此苦苦挣扎，以上是我最接近模仿 facebook 行为的方法。如果您有任何进一步的信息，请告诉我！

# c# - Dictionary.Contains 在特定的起始索引处

> ID：13962677
> 
> 赞同：-1
> 
> 时间：2012-12-19T22:59:07.797
> 
> 标签：c#, dictionary, key, contains

如何检查字典是否包含从预定义键开始的值？例如，我只想**在**特定键之后搜索字典，而不是从第一个键开始搜索。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:19:13.790

也许您需要的是一个[`OrderedDictionary`](http://msdn.microsoft.com/en-us/library/system.collections.specialized.ordereddictionary.aspx)，它提供对插入顺序的控制。这是一个示例，还包含一些搜索速度统计信息。

```
using System;
using System.Collections;
using System.Collections.Specialized;
using System.Diagnostics;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {

            var startIndex = 1000000; // 00:00:00.0004876
            //var startIndex = 1;     // 00:00:00.0152319

            var searchedKey = "1";

            OrderedDictionary orderedDictionary = new OrderedDictionary();

            //populate
            for (int i = 2; i < 1000002; i++)
            {
                orderedDictionary.Add(i.ToString(), "X");
            }
            orderedDictionary.Add("1", "A");

            //copy the keys
            String[] keys = new String[1000006];
            orderedDictionary.Keys.CopyTo(keys, 0);

            //measure the time with a System.Diagnostics.StopWatch
            Stopwatch watch = new Stopwatch();
            watch.Start();

            for (int i = startIndex; i < orderedDictionary.Count; i++)
            {
                if (keys[i] == searchedKey)
                {
                    Console.WriteLine(orderedDictionary[i]);
                    break;
                }
            }
            watch.Stop();

            Console.WriteLine(watch.Elapsed);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:42:28.527

如果它是常规的`Dictionary<TKey, TValue>`，那么您不能，除非您先对其进行排序。

您可以做的是使用[`SortedList<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/ms132319.aspx)or [`SortedDictionary<TKey, TValue>`](http://msdn.microsoft.com/en-us/library/f7fta44c%28v=VS.100%29.aspx), 两者都按键排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T23:11:44.767

不确定在这种情况下字典是否最适合您使用，因为（如前所述）不能保证顺序。但是，如果您使用 a`List<>`您可以获得您正在寻找的行为。像这个例子：

```
 var items = new List<KeyValuePair<string, string>>();
        items.Add(new KeyValuePair<string, string>("A", "1"));
        items.Add(new KeyValuePair<string, string>("B", "2"));
        items.Add(new KeyValuePair<string, string>("C", "3"));
        var results = items.Skip(1).Take(1).ToList();

        MessageBox.Show(results[0].Key + " " + results[0].Value); 
```

`Skip`在此示例中，使用and`Take`方法显示的结果消息将是“B 2” 。它“跳过”第一个“1”并“获取”下一个“1”；

**编辑**（重构为使用 KeyValuePair 列表而不是字符串。）

# android - 来自应用程序的 Android 电话呼叫

> ID：13962680
> 
> 赞同：2
> 
> 时间：2012-12-19T22:59:23.783
> 
> 标签：android

在android编程中，是否可以在不显示“电话屏幕”的情况下在服务中拨打电话？任何示例都会非常有帮助。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T23:01:38.777

> 在android编程中，是否可以在不显示“电话屏幕”的情况下在服务中拨打电话？

这取决于您认为“电话屏幕”是什么。

如果您的意思是拨号程序，那么，是的，您可以使用 an`ACTION_CALL` `Intent`绕过它，假设您拥有`CALL_PHONE`权限。

如果您指的是通话中的屏幕，那么，不，AFAIK 无法避免该屏幕。该屏幕对用户来说相当重要。

# objective-c - NSPredicate 在具有 [NSDate 日期] 的自定义对象中按 NSDate 过滤

> ID：13962682
> 
> 赞同：2
> 
> 时间：2012-12-19T22:59:38.433
> 
> 标签：objective-c, nspredicate

我有一个`NSMutableArray`模型对象。

每个模型对象都有一个 startTime`NSDate`类型的属性

我想`NSPredicate`用来过滤`NSMutableArray`. 我想要一个包含比现在旧的项目的数组和一个包含比现在新的项目的数组。

这是我使用的代码，但过滤后的数组是空的。我确实确保主数组中有项目正在从中过滤。

```
 NSPredicate *pastPredicate = [NSPredicate predicateWithFormat:@"(startTime < %@)", [NSDate date]];
    NSPredicate *futurePredicate = [NSPredicate predicateWithFormat:@"(startTime >= %@)", [NSDate date]];

    self.pastReservations = [self.reservations filteredArrayUsingPredicate:pastPredicate];
    self.futureReservations = [self.reservations filteredArrayUsingPredicate:futurePredicate]; 
```

如果你们知道我做错了什么，你们能告诉我吗？我认为我不应该使用内置类型的谓词块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:11:35.240

为什么不这样：

```
NSDate* now = [NSDate date];

for(YourModelObject* obj in self.reservations) {

    NSDate* objectDate = obj.date; 

    //if negative, "now" is earlier, so >= 0 is past 
    if([now timeIntervalSinceDate:objectDate] >= 0) {
        [self.pastReservations addObject:obj];
    } else {
        [self.futureReservations addObject:obj];
    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T21:48:11.987

我的代码是正确的。之前的代码无法正常工作，并且 self.reservations 就像 Ramy Al Zuhouri 所说的那样是空的。

# c# - ADOX不能在VS2010中使用？

> ID：13962684
> 
> 赞同：1
> 
> 时间：2012-12-19T22:59:56.697
> 
> 标签：c#, visual-studio-2010, adox

我想使用 ADOX 在 VS2010 中创建数据库，但在使用“ADOX.catalogClass”时出现异常错误：无法嵌入互操作类型“ADOX.CatalogClass”。请改用适用的接口。实际上，被标记为错误的特定行是： `ADOX.CatalogClass cat = new ADOX.CatalogClass();`

ADOX 不适用于 VS2010 吗？我该如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T16:20:25.333

您在参考上将“嵌入互操作类型”选项设置为 True。非常好的特性，但它不支持直接使用 XxxClass 包装器。*不直观，但您可以使用new*运算符创建 COM 接口的实例。将您的代码更改为此以消除错误：

```
 ADOX.Catalog cat = new ADOX.Catalog(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:09:01.397

我在 VS2010 中使用 ADOX 和 ADOX.Catalog，而不是 CatalogClass。这是我使用它的示例：

```
private void CreateAndExportLegacyFile(string exportFilePath)
{
    var connectionString = "Provider=Microsoft.Jet.OLEDB.4.0;";
    connectionString += "Data Source=" + exportFilePath + ";Jet OLEDB:Engine Type=5";

    var catalog = new Catalog();
    catalog.Create(connectionString);

    var table = new Table { Name = "Main" };

    #region Column mapping
    table.Columns.Append("ID", DataTypeEnum.adVarWChar, 50);
    // Snipped rest of them
    #endregion

    foreach (Column column in table.Columns)
    {
        if (column.Name != "ID")
        {
            column.Attributes = ColumnAttributesEnum.adColNullable;
        }
    }

    catalog.Tables.Append(table);

    Marshal.FinalReleaseComObject(table);
    Marshal.FinalReleaseComObject(catalog.Tables);
    Marshal.FinalReleaseComObject(catalog.ActiveConnection);
    Marshal.FinalReleaseComObject(catalog);
} 
```

# android - 带广播接收器的方案

> ID：13962690
> 
> 赞同：0
> 
> 时间：2012-12-19T23:00:23.893
> 
> 标签：android, broadcastreceiver

广播接收器可以监听方案吗？活动示例。

```
<intent-filter >
   <data android:scheme="http"/>
   <action android:name="android.intent.action.VIEW" />
   <category android:name="android.intent.category.DEFAULT" />
   <category android:name="android.intent.category.BROWSABLE" />
</intent-filter> 
```

编辑：公司正在使用它自己的协议..所以它不是 http 方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:03:34.250

是的，您可以在您的（而不是）中使用相同`<intent-filter>`的元素。`<receiver>``<activity>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-11-15T18:21:14.203

为了将来参考，这里是一个简单的工作示例：

发送广播如下：

```
Intent intent = new Intent("my.custom.action");
intent.setData(Uri.parse("myapp://apphost/"));
context.sendBroadcast(intent); 
```

在您的清单中，使用以下意图过滤器注册广播接收器。

```
<intent-filter>
    <action android:name="my.custom.action"/>
    <data android:scheme="myapp" android:host="apphost"/>
</intent-filter> 
```

# javascript - Ajax 响应似乎迷路了

> ID：13962695
> 
> 赞同：0
> 
> 时间：2012-12-19T23:00:57.110
> 
> 标签：javascript, jquery, ajax, ruby-on-rails-3

我将 ddslick jquery 下拉插件与我的 Rails 应用程序结合使用。

在view1中，我有

```
$('#challenges_dropdown').ddslick({
  <snipped>
  onSelected: function (data) {
    $.ajax({
      url: "/load_data",
      type: "GET",
      data: {"id": data.selectedData.value}
    });
  }
}); 
```

即，我向我的控制器调用 load_data。控制器正确接收到这个，然后在最后，调用渲染一个单独的视图

```
render "data.js" 
```

这是一个 .js 视图，它执行一个脚本来更新我原始视图的一些元素。出于某种原因，这个脚本片段只是没有运行。

我很困惑。当我使用带有 data-remote="true" 的常规链接时，整个过程完美运行。但是，当我进行 AJAX 调用时，它会失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:16:51.040

基本上，我需要为 AJAX 调用指定一个数据类型，以便将来自 AJAX 调用的响应视为脚本并执行：

```
$('#challenges_dropdown').ddslick({
  <snipped>
  onSelected: function (data) {
    $.ajax({
      url: "/load_data",
      type: "GET",
      dataType: "script",
      data: {"id": data.selectedData.value}
    });
  }
}); 
```

# javascript - Ajax Post 请求返回 JSON 但延迟失败

> ID：13962702
> 
> 赞同：3
> 
> 时间：2012-12-19T23:01:44.243
> 
> 标签：javascript, json, backbone.js, jquery-deferred

我有一个跨域 POST 请求到[http://api.local/user/auth](http://api.local/user/auth) - 我的 API 端点。我允许在我的 api 中使用 CORS 进行跨域请求。如果这会有所作为，请使用 Chrome。

我得到一个带有 200 状态代码的有效服务器 JSON 响应，但我使用的是来自主干模型的延迟，如下所示：

```
@model.save()
  .fail(-> console.log 'sync fail')
  .success ->
    console.log 'sync OK' 
```

而且我一直得到“同步失败”而不是预期的“同步正常”

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:32:21.267

确保您期望的内容类型与您收到的内容相匹配。如果您从服务器返回 text/html 作为内容类型，则在请求中将`dataType`属性设置为`"html"`：

```
model.save({}, {dataType: "html"}).... 
```

（对不起，我没有使用很多 CoffeeScript，所以我不知道确切的语法。）

# powershell - 如何在 psake 中调用 exec 到具有可变路径的可执行文件？

> ID：13962703
> 
> 赞同：12
> 
> 时间：2012-12-19T23:01:47.250
> 
> 标签：powershell, psake

我似乎无法在我的 psake 部署脚本中正确调用此可执行文件。

如果我这样做：

```
exec { "$ArchiverOutputDir\NServiceBus.Host.exe /install" } 
```

它只是输出这个（并且显然没有调用可执行文件 - 只是输出该表达式的值）：

```
c:\ReloDotNet2_ServiceEndpoints\Archiver\NServiceBus.Host.exe /install 
```

但如果我这样做：

```
exec { c:\ReloDotNet2_ServiceEndpoints\Archiver\NServiceBus.Host.exe /install } 
```

我从可执行文件中得到了预期的输出。

如何正确调用 psake 中可执行文件路径中带有变量的可执行文件？如果这实际上是 PowerShell 问题，请随时更正问题以反映该见解。

一世

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-19T23:28:11.920

经典的 PowerShell 问题。试试这个：

```
exec { & "$ArchiverOutputDir\NServiceBus.Host.exe" /install } 
```

PowerShell 不仅执行命令，它还评估表达式，例如：

```
C:\PS> 2 + 2
4
C:\PS> "hello world"
hello world 
```

您在管道开始时给 PowerShell 的是一个字符串表达式，它会忠实地评估并打印到控制台。通过使用 call operator `&`，您告诉 PowerShell 以下内容是要执行的命令的名称（在字符串中）或要执行的脚本块。从技术上讲，您也可以使用`. "some-command-name-or-path"`. 唯一的区别是，对于 PowerShell 命令，`&`创建一个新的范围来执行命令而`.`不是。对于外部 exe，据我所知，您使用的是哪一个，但`&`通常使用它，这没有什么区别。

# c# - SqlDataAdapter 如何在内部工作？

> ID：13962704
> 
> 赞同：5
> 
> 时间：2012-12-19T23:02:05.373
> 
> 标签：c#, sql-server, database, internals, sqldataadapter

我想知道`SqlDataAdapter`内部是如何工作的，特别是在`UpdateCommand`用于更新一个巨大的`DataTable`（因为它通常比从循环中发送 sql 语句要快得多）。

这是我的一些想法：

*   它创建一个准备好的 sql 语句（使用`SqlCommand.Prepare()`），其中`CommandText`填充和 sql 参数使用正确的 sql 类型初始化。然后，它在需要更新的数据行上循环，并为每条记录更新参数值，并调用`SqlCommand.ExecuteNonQuery()`.
*   它创建了一堆`SqlCommand`对象，里面填满了所有东西（`CommandText`和 sql 参数）。然后一次将几个 SqlCommand 批处理到服务器（取决于`UpdateBatchSize`）。
*   它使用一些特殊的、低级的或未记录的 sql 驱动程序指令，这些指令允许以有效的方式对多行执行更新（需要使用特殊数据格式提供要更新的行，并且相同的 sql 查询（`UpdateCommand`此处）将是对每一行执行）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T23:05:30.083

它使用称为**命令集**的 SQL Server 客户端类的内部工具。您可以使用单个命令将多个批次发送到 SQL Server。这减少了每次调用的开销。你有更少的服务器往返等。

每个语句更新一行，每个批次发送一个语句，但每次往返发送多个批次。此列表中的最后一点是*魔术酱*。

不幸的是，这个设施**没有公开**。[Ayende 对此进行了破解，并为它构建了一个私有反射基础 API。](http://ayende.com/blog/1679/opening-up-query-batching)

如果您想了解更多信息，我鼓励您查看内部`SqlCommandSet`课程。

也就是说，**您自己可以比这更快**：使用 TVP 传输更新数据并发出一个`UPDATE`更新许多行的单一数据。这样，您就可以节省所有每批次、每往返和每条语句的开销。

这样的查询看起来像这样：

```
update T set T.x = @src.x from T join @src on T.ID = @src.ID 
```

# objective-c - 在 OS X 中实现视图之间滑动的最佳方法是什么？

> ID：13962712
> 
> 赞同：7
> 
> 时间：2012-12-19T23:03:29.570
> 
> 标签：objective-c, macos, cocoa

在 OS X 中实现视图之间滑动的最佳方法是什么？这些视图是从带有视图控制器的 nib 初始化的，它们是相同的类类型。为了提供一些背景信息，每个视图都显示当前日期的相关数据。

我想创建一个函数来加载下一个（或上一个）日期的数据。我可以简单地将数据加载到当前视图中，但是我可以使用类似于在 OS X 中的空间之间滑动的动画来做到这一点吗？我想我必须初始化一个新视图，在那里加载数据，然后启动到新视图的滑动转换。

我担心创建所有这些新视图的性能会很差。以下是我考虑过的一些选项来解决这个问题：

*   创建 NSDate 到 MYViewController 的字典。从此 hashmap 加载和存储每个视图，但这可能会占用大量内存。
*   创建 MYViewController 的双向链表并加载/存储按顺序标注日期的视图。这也可能会占用大量内存，如果用户跳转到某个日期，缓存将被删除。

有什么想法吗？如果有某种方法可以在当前视图中加载数据，我觉得那将是最好的选择。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:04:41.843

您是否考虑过只是简单地使用`UIScrollView`并拥有一个`UIViewController`来管理所有视图？这是 Ray Wenderlich 网站上的一个很好的教程`UIScrollView`：

[http://www.raywenderlich.com/10518/how-to-use-uiscrollview-to-scroll-and-zoom-content](http://www.raywenderlich.com/10518/how-to-use-uiscrollview-to-scroll-and-zoom-content)

或者，您是否考虑过可能使用水平表视图？这是第三方实现，我在其他 SO 帖子上看到过推荐：

[https://github.com/TheVole/Horizo​​ntalTable](https://github.com/TheVole/HorizontalTable)

**编辑**

抱歉，我很快就阅读了您的问题，并认为它是针对 iOS 的...

我认为您可能正在寻找类似的东西`NSCollectionView`（不确定这是否会以水平方式很好地支持屏幕外视图......？）

这是关于它的文档：

[https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSCollectionView_Class/Introduction/Introduction.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/NSCollectionView_Class/Introduction/Introduction.html)

这是一个关于它的教程：

[http://andrehoffmann.wordpress.com/2009/08/29/nscollectionview-tutorial-for-dummies-xcode-3-1-3/](http://andrehoffmann.wordpress.com/2009/08/29/nscollectionview-tutorial-for-dummies-xcode-3-1-3/)

（老实说，没有做过太多的 OSX 开发，所以有点超出我的专业领域......但我祝你好运！）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T05:38:16.150

Cocoa 视图过渡动画并不是一件容易的事情。这比视图控制器管理要复杂得多。

您需要决定如何达到预期的效果。查看此文档和其他参考资料：[Animation Programming Guide for Cocoa](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/AnimationGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40003592)

几个月前我做过类似的工作。我的最终解决方案是使用单视图并仅使用图形 API（图像绘制）显示动画效果，因为它比 Core Animation 更简单。

# makefile - 由 makefile 创建的头文件的 gmake 规则

> ID：13962715
> 
> 赞同：2
> 
> 时间：2012-12-19T23:03:39.123
> 
> 标签：makefile, gnu-make

如何为 make 本身生成的头文件正确编写 gmake 规则？

假设我可以通过 do`make BUILDTYPE=1`并且 buildtype.h 将被创建并填充

```
#define BUILDTYPE 1 
```

Makefile 将简单地执行以下操作：

```
buildtype.h:
    echo #define BUILDTYPE 1 > TMPFILE
    //pseudo code:
    if(TMPFILE != buildtype.h)
        cat TMPFILE > buildtype.h 
```

我需要确保这个过程不会对每个 cpp 文件重复 1000 次，并且我想确保这个过程至少会执行一次

我要确保的是该规则始终运行且仅运行一次。也就是说，即使 buidtype.h 存在，它仍然必须运行。我有自动依赖跟踪，它应该只在 make 运行时触发这个规则一次。

也就是说，如果我运行 make BUILDTYPE=2 并且无事可做，它仍然必须为 buildtype.h 运行该规则，并且如果 buildtype.h 将由该规则更新，它应该重新编译所有文件。

gmake可以做到这样的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T15:09:38.840

> 我需要确保这个过程不会对每个 cpp 文件重复 1000 次

您不需要做任何特别的事情来确保这一点。Make 将跟踪它已更新的目标。它不会因为多个其他目标依赖于它的输出而多次重新运行规则。

> 我想确保这个过程至少完成一次

这样做的规范方法是：

```
.PHONY: force
buildtype.h: force 
```

您没有要求它，而是一种简单的实现方式

> ```
> //pseudo code:
> if(TMPFILE != buildtype.h)
>     cat TMPFILE > buildtype.h 
> ```

是

```
cmp -s TMPFILE buildtype.h || cp TMPFILE buildtype.h 
```

**更新：**`buildtype.h`一个相关的“有趣的问题”是如何在任何编译尝试使用它之前确保它是最新的。自动依赖跟踪系统在“干净”构建时可能会失败，因为它们的输出仅基于它们在磁盘上可以看到的头文件；如果`buildtype.h`尚未创建，`makedepend`或者`gcc -M`无法知道它，则无法生成正确的依赖关系。

一种解决方案是仔细地将正确的依赖项手动编码到 makefile 中，例如

```
foo.o: buildtype.h # because foo.c includes buildtype.h 
```

一个更简单但更老套的选择是写

```
Makefile: buildtype.h 
```

这确保它会在它做*任何*`make`其他事情之前更新（参见[手册](https://www.gnu.org/software/make/manual/html_node/Remaking-Makefiles.html)）。所以现在永远不会丢失或过时。`buildtype.h`*`buildtype.h`*

 *该方法的一个缺点是即使键入类似的`make clean`内容也会导致`buildtype.h`更新，即使在这种情况下根本不需要它。对于特定情况，可以通过非常丑陋的黑客来缓解这种情况

```
ifneq (clean,$(MAKECMDGOALS))
Makefile: buildtype.h
endif 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T01:49:41.853

这是使用 sed 的一种方法：

```
deps = 
ifdef BUILDTYPE
old = $(shell sed -n 's/\#define *BUILDTYPE *\([0-9]*\)/\1/p' buildtype.h)
ifneq ($(BUILDTYPE),$(old))
deps := buildtype.h
endif
endif

all: $(deps)
  @echo $(deps) 
```*

# php - 如何在一个字符串中保存多个复选框

> ID：13962718
> 
> 赞同：1
> 
> 时间：2012-12-19T23:03:54.357
> 
> 标签：php, checkbox

我正在寻找一些帮助，将多个复选框中的值放在一个由“，”分隔的字符串中

这是我的代码：

```
if (isset($_POST['submitKon'])) {   
$checkBox = $_POST[$holdID[$i]];

<?php
    $i=1;
    $virksomhedsID = $_SESSION['virkID'];
    $sql = "SELECT * FROM  `hold` INNER JOIN  `virksomheder` ON hold.virkID = virksomheder.virkID
    WHERE hold.virkID = '$virksomhedsID' ORDER BY  `holdNavn` ASC";

    $result = mysql_query($sql);
    while($row = mysql_fetch_assoc($result))
    { 
    echo '<label for="check' . $row['holdNavn'] . '">' . $row['holdNavn'] . '</label>&nbsp;';
    echo '<input type="checkbox" checked="checked" id="' . $row['holdID'] . '" name="' . $row['holdID'] . '">&nbsp;&nbsp;';                         
    $i++;       
?> 
```

有人能帮忙吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:20:12.640

您的复选框名称应全部设置为，例如：

```
 <input type="checkbox" name="check[]" value="{$row['holdID']}" /> 
```

然后复选框的值应该在`$_POST['check']`所以我认为你应该尝试（在你收到你的页面上`$_POST`）

```
implode(',',$_POST['check']);
 //or something like
$checkstring="";
foreach($_POST['check'] as $checkboxes) {
  $checkstring.= $checkboxes .",";
}
echo rtrim($checkstring); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:20:20.803

夫妇的事情。您的`$i`变量从未被使用过，这是故意的吗？

此外，您还错过`}`了 while 语句末尾的结尾。

你在你的标签上写的`for=`是什么意思`id=`？

这应该遍历结果并为每个结果打印一个标签和一个复选框。我在最后两个之前添加了“，”`&nbsp;`

```
<!-- language: lang-php -->
while($row = mysql_fetch_assoc($result))
{ 
    echo "<label id='check".$row['holdNavn']."'>".$row['holdNavn']."</label>&nbsp;
          <input type='checkbox' checked='checked' id='".$row['holdID']."' name='".$row['holdID']."'>,&nbsp;&nbsp;";                                
} 
```

# python - 以编程方式将网页保存到静态 HTML 文件的最佳方法

> ID：13962719
> 
> 赞同：9
> 
> 时间：2012-12-19T23:04:05.060
> 
> 标签：python, html, css, html-parsing

我做的研究越多，前景就越严峻。

我正在尝试使用 Python 进行平面保存或静态保存网页。这意味着将所有样式合并为内联属性，并将所有链接更改为绝对 URL。

我已经尝试了几乎所有免费的转换网站、api，甚至 github 上的库。没有一个是那么令人印象深刻。我能找到的扁平化样式的最佳 python 实现是[https://github.com/davecranwell/inline-styler](https://github.com/davecranwell/inline-styler)。我为 Flask 稍作调整，但生成的文件不是那么好。这是它的外观：

![在此处输入图像描述](../Images/ce778018015e1c61defbbc29a4265f55.png)

显然，它应该看起来更好。它应该是这样的：

[https://dzwonsemrish7.cloudfront.net/items/3U302I3Y1H0J1h1Z0t1V/Screen%20Shot%202012-12-19%20at%205.51.44%20PM.png?v=2d0e3d26](https://dzwonsemrish7.cloudfront.net/items/3U302I3Y1H0J1h1Z0t1V/Screen%20Shot%202012-12-19%20at%205.51.44%20PM.png?v=2d0e3d26)

处理格式错误的 html、无法识别的 CSS 属性、Unicode 错误等似乎是一场永无止境的斗争。那么有没有人建议更好的方法来做到这一点？我知道我可以在本地浏览器中转到文件-> 保存，但是当我尝试批量执行此操作时，并提取一个不太可行的特定 xpath。

看起来 Evernote 的网络剪辑器使用 iFrame，但这似乎比我想象的要复杂。但至少剪报在 Evernote 上看起来不错。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T03:45:59.300

离开一段时间后，我设法安装了一个 ruby​​ 库，它比我用过的任何其他东西都更好地扁平化了 CSS。这是非常慢的网络界面背后的库[http://premailer.dialect.ca/](http://premailer.dialect.ca/)

谢天谢地，他们在 Github 上发布了源代码，这是最好的。 [https://github.com/alexdunae/premailer](https://github.com/alexdunae/premailer)

它扁平化样式，创建绝对 URL，使用 URL 或字符串，甚至可以创建纯文本电子邮件模板。这个图书馆给我留下了深刻的印象。

## 2013 年 11 月更新

我最终编写了自己的书签，它纯粹在客户端工作。它仅与 Webkit 和 FireFox 兼容。它遍历每个节点并添加内联样式，然后将扁平化的 HTML 发送到 clippy.in API 以保存到用户的仪表板。

[客户端书签](https://clippy.in/static/js/script.js)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T01:04:35.813

听起来内联样式可能会让您大吃一惊，但如果不是，我建议您再看看 Evernote Web Clipper。桌面应用程序具有 Web 剪辑的导出 HTML 功能。正如您对内联样式所期望的那样，输出有点混乱，但我发现标记是已保存页面的可靠表示。

关于内联与外部样式，对于像这样的事情，如果您正在从不同站点处理大量页面，其中类名会有冲突的样式规则，我看不到任何内联方式。

您提到 Web Clipper 使用 iFrame，但我没有发现 HTML 输出是这种情况。如果您要在另一个网站上重新发布（我认为是合法的），您可能必须将静态页面作为 iFrame 嵌入，否则这应该不是问题。

一些自动化肯定会有所帮助，因此您可以直接从浏览器转到 HTML 输出，也许还可以将保存的图像重新定位到单个 repo，并在 HTML 中更新 src 链接。如果您最终从事这样的工作，我将不胜感激自己尝试一下。

# vim - 如何在 Emacs 或 Vim 中分配字符串

> ID：13962720
> 
> 赞同：6
> 
> 时间：2012-12-19T23:04:05.590
> 
> 标签：vim, emacs

在 Emacs 或 Vim 中，什么是连接字符串的平滑方式，如下例所示：

```
变换自：
    （阿尔法，贝塔，伽马）等等（123、456、789）
到：
    （阿尔法=123，贝塔=456，伽马=789）

```

它需要扩展到：

*   其中许多行
*   括号中的许多元素

我最近发现自己经常需要这种转变。

我在 Emacs 中使用 Evil，这就是为什么 Vim 答案可能也会有所帮助的原因。

更新：

解决方案并不像我希望的那样普遍。例如，当我有一个字符串列表并希望将它们分发到一个大型 XML 文档中时，我希望该解决方案也能正常工作。例如：

```
<item foo="" bar="barval1"/>
<item foo="" bar="barval2"/>
<item foo="" bar="barval3"/>
<item foo="" bar="barval4"/>

fooval1
fooval2
fooval3
fooval4 
```

我制定了一个解决方案并将其添加为答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:55:57.533

```
%s/(\(\S\{-}\), \(\S\{-}\), \(\S\{-}\)).\{-}(\(\S\{-}\), \(\S\{-}\), \(\S\{-}\))/(\1=\4, \2=\5, \3=\6) 
```

`%s`: 全局搜索和替换

`\(\S{-}\),`：非贪婪搜索直到下一个逗号的非空白字符，用“（”括起来以进行反向引用

`\1=\4`: 打印出第一个匹配，一个“=”符号，然后是第四个匹配

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T01:31:07.593

对于这样的文本转换，我会选择 awk：

这个单线可能会有所帮助：

```
awk -F'\\(|\\)' '{split($2,t,",");split($4,v,",");printf "( "; for(x in t)s=s""sprintf("%s=%s, ", t[x],v[x]);sub(", $","",s);printf s")\n";s=""}' file 
```

小测试：

```
kent$  cat test
(alpha, beta, gamma) blah (123, 456, 789)
(a, b, c) foo (1, 2, 3)
(x, y, z, m, n) bar (100, 200, 300, 400, 500)

kent$  awk -F'\\(|\\)' '{split($2,t,",");split($4,v,",");printf "( "; for(x in t)s=s""sprintf("%s=%s, ", t[x],v[x]);sub(", $","",s);printf s")\n";s=""}' test

( alpha=123,  beta= 456,  gamma= 789)
( a=1,  b= 2,  c= 3)
(  m= 400,  n= 500, x=100,  y= 200,  z= 300) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T00:05:26.597

这是一个 Vimscript 解决方案。它远没有 ash 的答案那么优雅，但它适用于任何长度的列表。

```
function! ListMerge()
    " Get line, remove text between lists, split lists at parentheses:
    let curline = getline('.')
    let curline = substitute(curline,')\zs.*\ze(','','g')
    let curline = substitute(curline,'(','','g')
    let lists = map(split(curline,')'),'split(v:val,",")')
    " Return if we don't have two lists of equal length:
    if len(lists) != 2 || len(lists[0]) != len(lists[1])
        return
    endif
    " Loop over the lists, remove whitespace, build the replacement string:
    let i=0
    let string = '('
    while i<len(lists[0])
        let string .= substitute(lists[0][i],'^ *','','')
        let string .= '='
        let string .= substitute(lists[1][i],'^ *','','')
        let string .= ', '
        let i+=1
    endwhile
    " Add the concluding bracket:
    let string = substitute(string,', $',')','')
    " Replace the current line with the string:
    execute "normal! S" . string
endfunction 
```

然后，您可以在所有行上调用此函数，如下所示：

```
:%call ListMerge() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-20T01:50:34.430

Emacs Lisp 版本的炖牛肉王子答案

```
(require 'cl)

(defun split-and-trim (str separator)
  (let ((strs (split-string str separator)))
    (mapcar (lambda (s)
              (replace-regexp-in-string "^\\s-+" "" s))
            (mapcar (lambda (s)
                      (replace-regexp-in-string "\\s-$" "" s)) strs))))

(defun my/merge-list (beg end)
  (interactive "r")
  (goto-char beg)
  (let ((endmark (set-mark end))
        (regexp "(\\([^)]+\\))[^(]+(\\([^)]+\\))"))
    (while (re-search-forward regexp end t)
      (let ((replace-start (match-beginning 0))
            (replace-end   (match-end 0))
            (keys-str (match-string-no-properties 1))
            (values-str (match-string-no-properties 2)))
        (let* ((keys (split-and-trim keys-str ","))
               (values (split-and-trim values-str ",")))
          (while (> (length keys) (length values))
            (setq values (append values '(""))))
          (let* ((pairs (mapcar* (lambda (k v)
                                   (format "%s=%s" k v)) keys values))
                 (transformed (format "(%s)" (mapconcat #'identity pairs ", "))))
            (goto-char replace-start)
            (delete-region replace-start replace-end)
            (insert transformed)))))
    (goto-char (marker-position endmark)))) 
```

例如，您选择区域如下

```
(alpha, beta, gamma)  blah (123, 456, 789)
(alpha, beta, gamma, delta)  blah (123, 456, 789, aaa) 
```

在 Mx my/merge-list 之后

```
(alpha=123, beta=456, gamma=789)
(alpha=123, beta=456, gamma=789, delta=aaa) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-20T04:44:22.600

我要描述的这种方法有点古怪，但它涉及到我能管理的最少的 Elisp 代码。仅当要加入的列表在删除逗号后可以解释为 Lisp 列表时才适用。如您的示例所示，字母字符的数字和序列会很好。

首先，确保加载了 Common Lisp 库： `M-:``(require 'cl)``RET`.

现在，从第一个列表开头的光标开始：

`M-C-k` ; 杀死前向性

`C-e` ; 行尾移动

`M-C-b` ; 后向性

`M-C-k` ; 杀死前向性

`C-a` ; 行首移动

`C-k` ; 杀线

现在`blah`（或其他）是 kill ring 中的第一个条目，第二个列表是第二个条目，第一个列表是第三个条目。

输入`(`，然后输入`M-:`( `eval-expression`)，深呼吸，然后输入：

```
(loop with (a b) = (mapcar (lambda (x) (car (read-from-string (remove ?, x))))
                     (subseq kill-ring 1 3))
   for x in a for y in b do (insert (format "%s=%s, " y x))) 
```

（出于演示目的，我已将其拆分，但您可以将其全部输入一行。）

然后最后`DEL``DEL``)`，你就完成了！如果你愿意，你可以把它变成一个宏。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-26T21:26:43.570

我的方法是创建一个命令来设置匹配列表，然后使用 replace-regexp 作为第二个命令来分发匹配列表，利用 replace-regexp 现有的 \, 工具。

评估 Elisp，例如在 .emacs 文件中：

```
(defvar match-list nil
  "A list of matches, as set through the set-match-list and consumed by the cycle-match-list function. ")
(defvar match-list-iter nil
  "Iterator through the global match-list variable. ")
(defun reset-match-list-iter ()
  "Set match-list-iter to the beginning of match-list and return it. "
  (interactive)
  (setq match-list-iter match-list))
(defun make-match-list (match-regexp use-regexp beg end)
  "Set the match-list variable as described in the documentation for set-match-list. "
  ;; Starts at the beginning of region, searches forward and builds match-list.
  ;; For efficiency, matches are appended to the front of match-list and then reversed
  ;; at the end.
  ;;
  ;; Note that the behavior of re-search-backward is such that the same match-list
  ;; is not created by starting at the end of the region and searching backward.
  (let ((match-list nil))
    (save-excursion
      (goto-char beg)
      (while
          (let ((old-pos (point)) (new-pos (re-search-forward match-regexp end t)))
            (when (equal old-pos new-pos)
              (error "re-search-forward makes no progress.  old-pos=%s new-pos=%s end=%s match-regexp=%s"
                     old-pos new-pos end match-regexp))
            new-pos)
        (setq match-list
              (cons (replace-regexp-in-string match-regexp
                                              use-regexp
                                              (match-string 0)
                                              t)
                    match-list)))
      (setq match-list (nreverse match-list)))))
(defun set-match-list (match-regexp use-regexp beg end)
  "Set the match-list global variable to a list of regexp matches.  MATCH-REGEXP
is used to find matches in the region from BEG to END, and USE-REGEXP is the
regexp to place in the match-list variable.

For example, if the region contains the text: {alpha,beta,gamma}
and MATCH-REGEXP is: \\([a-z]+\\),
and USE-REGEXP is: \\1
then match-list will become the list of strings: (\"alpha\" \"beta\")"
  (interactive "sMatch regexp: \nsPlace in match-list: \nr")
  (setq match-list (make-match-list match-regexp use-regexp beg end))
  (reset-match-list-iter))
(defun cycle-match-list (&optional after-end-string)
  "Return the next element of match-list.

If AFTER-END-STRING is nil, cycle back to the beginning of match-list.
Else return AFTER-END-STRING once the end of match-list is reached."
  (let ((ret-elm (car match-list-iter)))
    (unless ret-elm
      (if after-end-string
          (setq ret-elm after-end-string)
        (reset-match-list-iter)
        (setq ret-elm (car match-list-iter))))
    (setq match-list-iter (cdr match-list-iter))
    ret-elm))
(defadvice replace-regexp (before my-advice-replace-regexp activate)
  "Advise replace-regexp to support match-list functionality. "
  (reset-match-list-iter)) 
```

然后解决原来的问题：

```
M-x set-match-list
Match regexp: \([0-9]+\)[,)]
Place in match-list: \1

M-x replace-regexp
Replace regexp: \([a-z]+\)\([,)]\)
Replace regexp with: \1=\,(cycle-match-list)\2 
```

并解决 XML 示例：

```
[Select fooval strings.]
M-x set-match-list
Match regexp: .+
Place in match-list: \&

[Select XML tags.]
M-x replace-regexp
Replace regexp: foo=""
Replace regexp with: foo="\,(cycle-match-list)" 
```

# python - 搜索/替换/删除 Jekyll YAML Front Matter 类别标签

> ID：13962723
> 
> 赞同：3
> 
> 时间：2012-12-19T23:04:21.473
> 
> 标签：python, ruby, yaml, jekyll

我继承了 Jekyll 网站，而且我来自 .NET 世界，所以这对我来说是一个学习曲线。

这个 Jekyll 网站需要很长时间才能构建，我认为这是因为实际上有成千上万的类别标签需要删除这些页面。我能够获取所有类别的列表并创建一个 CSV，我想循环并确定是否仍然需要类别标签。CSV的结构是：

```
old_tag,new_tag 
```

显然，我想根据这些更新标签（例如，将所有 C#、C-Sharp、C# 和 C Sharp 类别都设为 C-Sharp）。但是，我还想删除一些旧标签字段存在而新标签字段为空白的地方：

```
old_tag,new_tag
C#, C-Sharp
C Sharp, C-Sharp
Crazy, 
C #, C-Sharp 
```

使用 Ruby 或 Python，我想弄清楚如何遍历 4000 多个降价文件并使用 CSV 有条件地更新每个文件。我的数据库人员无法想象这将如何处理平面文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T00:05:52.823

我建议从哈希开始，像翻译表一样使用它。哈希查找非常快，并且可以很好地组织您的标签及其替换。

```
hash = {
  # old_tag => new_tag
  'C#'      => 'C-Sharp',
  'C Sharp' => 'C-Sharp',
  'Crazy'   => '',
  'C #'     => 'C-Sharp',
} 
```

您可以看到值中有很多冗余，可以通过反转哈希来修复，这可以很好地减少它：

```
hash = {
  # new_tag => old_tag
  'C-Sharp' => ['C#', 'C Sharp', 'C #'],
} 
```

`'Crazy'`是一个异常值，但我们会处理它。

Ruby`String.gsub`有一个很好但很少使用的特性，我们可以向它传递一个正则表达式和一个散列，它会将所有正则表达式匹配替换为散列中的等效值。我们可以轻松构建该正则表达式：

```
regex = /(?:#{ Regexp.union(hash.keys).source })/
=> /(?:C\-Sharp)/ 
```

现在，您可能会说，“但是等等，我还有很多标签要查找！”，并且由于哈希的构建方式，它们隐藏在值中。为了解决这个问题，我们将反转散列的键和值，将值数组分解为它们各自的元素：

```
reversed_hash = Hash[hash.flat_map{ |k,v| v.map{ |i| [i,k] } }]
=> {
         "C#" => "C-Sharp",
    "C Sharp" => "C-Sharp",
        "C #" => "C-Sharp",
} 
```

通过合并“特殊情况”的第二个散列，添加`'Crazy'`很容易：

```
special_cases = {
  'Crazy' => ''
}

reversed_hash = Hash[hash.flat_map{ |k,v| v.map{ |i| [i,k] } }].merge(special_cases)
=> {
         "C#" => "C-Sharp",
    "C Sharp" => "C-Sharp",
        "C #" => "C-Sharp",
      "Crazy" => ""
} 
```

将其与正则表达式构建代码一起使用：

```
regex = /(?:#{ Regexp.union(reversed_hash.keys).source })/
=> /(?:C\#|C\ Sharp|C\ \#|Crazy)/ 
```

这将使用自动生成的正则表达式找到标签。如果需要不区分大小写，请使用：

```
regex = /(?:#{ Regexp.union(reversed_hash.keys).source })/i 
```

创建一些文本进行测试：

```
text =<<EOT
This is "#C#"
This is "C Sharp"
This is "C #"
This is "Crazy"
EOT
=> "This is \"#C#\"\nThis is \"C Sharp\"\nThis is \"C #\"\nThis is \"Crazy\"\n" 
```

并测试`gsub`：

```
puts text.gsub(regex, reversed_hash) 
```

哪个输出：

```
This is "#C-Sharp"
This is "#C-Sharp"
This is "#C-Sharp"
This is "#" 
```

现在，我不喜欢将大文件放入内存中，因为这不能很好地扩展。今天的机器通常有许多 GB 的内存，但我看到文件仍然超过机器中的 RAM。因此，`File.read`我`gsub`建议使用`File.foreach`. 使用它会更改代码。

这是我的做法：

```
file_to_read = '/path/to/file/to/read'
File.open(file_to_read + '.new', 'w') do |fo|
  File.foreach(file_to_read) do |li|
    fo.puts li.gsub(regex, reversed_hash)
  end
end

File.rename(file_to_read, file_to_read + '.bak')
File.rename(file_to_read + '.new', file_to_read) 
```

这将为每个处理的文件创建一个 .bak 版本，因此如果出现问题，您有一个备用方案，这始终是一个好习惯。

* * *

编辑：我忘记了 CSV 文件：

您可以使用 CSV 模块使用 Ruby 轻松读取/创建一个，但是我会使用 YAML 文件，因为它允许您在易于手动编辑或从文件生成的文件中轻松创建哈希布局。

* * *

编辑：更多关于 CSV、YAML 和从另一个生成一个

以下是如何读取 CSV 并将其转换为推荐的哈希格式：

```
require 'csv'

text = <<EOT
C#, C-Sharp
C Sharp, C-Sharp
Crazy,
C #, C-Sharp
EOT

hash = Hash.new{ |h,k| h[k] = [] }
special_cases = []
CSV.parse(text) do |k,v|
  (
    (v.nil? || v.strip.empty?) ? special_cases : hash[v.strip]
  ) << k.strip
end 
```

从之前捡起：

```
reversed_hash = Hash[hash.flat_map{ |k,v| v.map{ |i| [i,k] } }].merge(Hash[special_cases.map { |k| [k, ''] }])
puts reversed_hash
# => {"C#"=>"C-Sharp", "C Sharp"=>"C-Sharp", "C #"=>"C-Sharp", "Crazy"=>""} 
```

要将 CSV 文件转换为更可编辑和更有用的文件，请使用上面的代码创建`hash`and `special_cases`，然后：

```
require 'yaml'

puts ({
  'hash' => hash,
 'special_cases' => special_cases
}).to_yaml 
```

看起来像：

```
---
hash:
  C-Sharp:
  - C#
  - C Sharp
  - ! 'C #'
special_cases:
- Crazy 
```

其余的你可以从 YAML 文档中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T03:59:04.957

这是一种可能的方法；不确定它对大量数据的效果如何：

```
require "stringio"
require "csv"

class MarkdownTidy
  def initialize(rules)
    @csv = CSV.new(rules.is_a?(IO) ? rules : StringIO.new(rules))
    @from_to = {}.tap do |hsh|
      @csv.each do |from, to|
        re = Regexp.new(Regexp.escape(from.strip))
        hsh[re] = to.strip
      end
    end
  end

  def tidy(str)
    cpy = str.dup
    @from_to.each do |re, canonical|
      cpy.gsub! re, canonical
    end
    cpy
  end
end

csv = <<-TEXT
C#, C-Sharp
C Sharp, C-Sharp
Crazy, 
C #, C-Sharp
TEXT

markdown = <<-TEXT
C# some text C # some text Crazy
C#, C Sharp
TEXT

mt = MarkdownTidy.new(csv)
[markdown].each do |str|
  puts mt.tidy(markdown)
end 
```

这个想法是，您将在最后用一个打开文件、读取它们然后将它们保存回磁盘的循环替换循环。

# ruby-on-rails - Rails 中的时间码 - 时间还是数值？

> ID：13962726
> 
> 赞同：3
> 
> 时间：2012-12-19T23:04:49.377
> 
> 标签：ruby-on-rails, datetime, timecodes

我正在开发一个项目，该项目将数据存储在音轨上，并且需要对音频轨道的起点和终点使用时间码。我还需要计算并显示曲目的持续时间。例如。曲目从 0:01:30 开始，到 0:04:12 结束。所以它的持续时间总共是 2 分 42 秒。

诀窍是所有内容都需要作为时间码显示和处理，因此在上面的示例中，持续时间需要显示为 0:02:42。

所以我的问题是你将如何存储这些值？最简单的选择是将开始和结束时间作为时间存储在数据库中。计算持续时间非常容易，您可以在表单中使用 Rails 时间助手。唯一痛苦的部分是将持续时间转换回显示的时间值（因为如果我只提供秒数，`strptime`它会继续使用当前时间来填写其他字段）

我考虑的另一个选项是将它们存储为数值（作为秒数）。但是我必须编写大量代码来将它们转换为某种类型的时间码格式，并且我不能使用 Rails 时间助手。

还有其他我没有考虑过的想法吗？有没有一种简单的方法可以计算持续时间并将其显示为时间码格式？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T23:09:19.890

我会将它们存储为秒或毫秒。我一直在用 Ruby 开发音乐库管理器/音频播放器，实际上我必须编写您需要的两种方法。代码不多：

```
 # Helper method to format a number of milliseconds as a string like
  # "1:03:56.555". The only option is :include_milliseconds, true by default. If
  # false, milliseconds won't be included in the formatted string.
  def format_time(milliseconds, options = {})
    ms = milliseconds % 1000
    seconds = (milliseconds / 1000) % 60
    minutes = (milliseconds / 60000) % 60
    hours = milliseconds / 3600000

    if ms.zero? || options[:include_milliseconds] == false
      ms_string = ""
    else
      ms_string = ".%03d" % [ms]
    end

    if hours > 0
      "%d:%02d:%02d%s" % [hours, minutes, seconds, ms_string]
    else
      "%d:%02d%s" % [minutes, seconds, ms_string]
    end
  end

  # Helper method to parse a string like "1:03:56.555" and return the number of
  # milliseconds that time length represents.
  def parse_time(string)
    parts = string.split(":").map(&:to_f)
    parts = [0] + parts if parts.length == 2
    hours, minutes, seconds = parts
    seconds = hours * 3600 + minutes * 60 + seconds
    milliseconds = seconds * 1000
    milliseconds.to_i
  end 
```

它以毫秒为单位编写，如果将其更改为以秒为单位，则会简单得多。

# asp.net - 在 asp.net 中引发事件

> ID：13962731
> 
> 赞同：0
> 
> 时间：2012-12-19T23:05:18.007
> 
> 标签：asp.net, timer

我正在尝试编写每隔几分钟保存一次数据的程序。不是在请求进来时。为此，我需要使用应用程序变量来捕获出现次数，并且每 5 分钟清除一次队列并将这些数字写入数据库。1\. 这是个好主意吗？2\. 它会影响性能吗？

我愿意接受建议。

# iphone - 以某种方式具有 UIImageOrientationRight 方向的旋转肖像 UIImage

> ID：13962734
> 
> 赞同：3
> 
> 时间：2012-12-19T23:05:31.460
> 
> 标签：iphone, objective-c, rotation, uiimage, uiimageorientation

大家好，

我在旋转以`UIImage`某种`WIDTH < HEIGHT`方式具有等于`UIImageOrientationRight`. 我不确定这是怎么回事，但它发生在我的库中用 iPhone 4 拍摄的一些图像上。

这是我的代码（**确实**有效，但前提是方向等于`UIImageOrientationUp`）：

```
UIGraphicsBeginImageContextWithOptions(rotatedScaledRect.size, NO, 0.0);
CGContextRef myContext = UIGraphicsGetCurrentContext();
CGContextSetInterpolationQuality(myContext, kCGInterpolationHigh);

CGContextTranslateCTM(myContext,
                      (rotatedScaledRect.size.width/2),
                      (rotatedScaledRect.size.height/2));
CGContextConcatCTM(myContext, transformation);

CGContextScaleCTM(myContext, 1.0, -1.0);

CGContextDrawImage(myContext, CGRectMake(-roundf(newImage.size.width / 2), -roundf(newImage.size.height / 2), newImage.size.width, newImage.size.height), [newImage CGImage]);

newImage = UIGraphicsGetImageFromCurrentImageContext();

UIGraphicsEndImageContext(); 
```

我需要申请`CGContextConcatCTM`，因为我对图像进行了几次级联转换。

我尝试了几种不同的方法都无济于事。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T13:21:24.987

首先，请原谅我的英语，因为它不是我的母语。我希望现在给出这个答案还为时不晚！

因此，我在从使用 iPhone 或 iPod 相机拍摄的库中加载照片时遇到了类似的问题。如果这是您的情况，您可以在此处找到一些信息：[https](https://discussions.apple.com/thread/2495567?start=30&tstart=0) ://discussions.apple.com/thread/2495567?start=30&tstart=0 ，特别是来自“Apple 选择在 EXIF 数据中使用方向标志”的答案通知显示图像的程序如何旋转它，以便正确显示图像。”

因此，要从使用 iPhone 相机拍摄的图库中加载照片，您必须执行以下操作：

```
ALAssetRepresentation *assetRep = [photo defaultRepresentation];
CGImageRef imageRef = [assetRep fullResolutionImage];
UIImage *image = [UIImage imageWithCGImage:imageRef scale:[assetRep scale] orientation:[assetRep orientation]]; 
```

其中 photo 是从库中获取的 ALAsset 对象。

好吧，我希望这会有所帮助！

# google-app-engine - 间歇性错误代码 400，连接到通道的客户端上的描述“”

> ID：13962739
> 
> 赞同：5
> 
> 时间：2012-12-19T23:06:04.137
> 
> 标签：google-app-engine, channel-api

我使用 Channel API 的 Google App Engine 应用程序在某些时候运行良好。但是，连接到通道的 js 代码会间歇性地产生错误。在 socket.onError 中，错误代码设置为 400，描述设置为空字符串。我已检查用于连接的令牌是否有效。我还尝试通过首先调用 socket.close() 在 socket.onError 中重新创建通道，但这似乎不起作用。通常在成功之前会有一系列的失败。客户端 js 在 iOS 上的 Safari 上运行。任何关于如何解决或解决问题的想法都将受到欢迎。现在，我最好的解决方法是继续尝试直到成功，增加每次失败尝试之间的间隔。服务器端存在 API 没有帮助，因为“已连接”钩子没有被可靠地调用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T00:00:46.087

已知问题[http://code.google.com/p/googleappengine/issues/detail?id=4940](http://code.google.com/p/googleappengine/issues/detail?id=4940)并被接受。如您所见，问题的状态未修复。随意给它加星标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T10:20:51.893

我知道重复发布是不好的（问题已加星标和评论已发布）......但我怀疑这个线程可能会比问题评论更受关注^^

就我们而言，这至少是一个文档问题：

[https://developers.google.com/appengine/docs/java/channel/javascript](https://developers.google.com/appengine/docs/java/channel/javascript)仍然声明“ onerror 调用后总是跟着 onclose 调用，并且必须在此事件之后重新创建通道对象”

据我们猜测，这仅适用于错误代码 400 和 401（它们是字符串，而不是数字，顺便说一句，因此请注意 js 代码中的 ===）。

其他错误代码是不正确的（我们至少记录了 -1 代码）。

应该有一个涵盖*所有*错误代码及其（预期）管理的文档。

Atm，我们有一个“通道管理器”，它在代码*不是*400 或 401 时重用相同的通道令牌，并确保每个 Socket 只调用一次 onclose。

在此之前，我们试图正确关闭，并使用闪亮的全新令牌重新打开（新的底层 Socket）：通常我们得到一个错误 400，然后是一个错误 -1。

FUI 我们最近在 iOS 上首次检测到了这种行为（回归 ftw？在那之前，iOS 是花花公子）。在代码 -1 之后重新打开套接字并不是灵丹妙药：有时它会成功（正确调用 onopen），然后静默失败（没有收到消息，没有调用 onerror）。

一般来说，我们还注意到桌面浏览器在所有用户代理和平台上的行为比移动浏览器更一致（更多信息：耶！其他问题传入！尤其是安卓......）

好的，毕竟这篇文章可能很有用。谢谢！

[编辑：更正了一个错误......我们不重用通道对象或套接字对象，只重用令牌]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-28T13:28:24.543

我就这个问题联系了 Google 支持。

当发生错误 400 时，这是因为发生了超时（似乎是一分钟）。此超时会产生断开连接（调用断开连接的 url，您应该删除数据库的客户端 ID）。然后，必须使用新的客户端 ID 创建一个新通道。

但这还不够。我们必须使用这个 jquery 命令行： $('#wcs-iframe').remove();
就在 js onerror 函数内部和之前尝试重新创建通道。

# java - 方法流控制

> ID：13962743
> 
> 赞同：1
> 
> 时间：2012-12-19T23:06:10.533
> 
> 标签：java

我有一个表格，它给出了一个`Fname`和一个将这些信息写入文件的方法。`Lname``Date`

如果`Fname`或`Lname`包含数字，则程序应显示错误消息并且不运行以下所有语句（例如写入文件并生成随机数和...），并且不退出。因为我不知道该怎么做，所以在我的代码中我写如果 Fname 或 Lname 有数字，退出！

```
private void jButton1ActionPerformed(java.awt.event.ActionEvent evt)   {                                         
    try{
        setFName(jTextField1.getText());
        if(havedigit(getFName())==true) { 
            System.exit(1);
        }
        setLName(jTextField2.getText());
        if(havedigit(lastName)==true) {
            System.exit(1);
        }
        WriteToFile(getFName());
        WriteToFile(getLName());
        setDate(Integer.parseInt(jTextField3.getText()));
        WriteToFile(String.valueOf(getDate()));
        Random rnd1=new Random();
        Registration_Number=rnd1.nextInt(100);
        setRegNum(Registration_Number);
        WriteToFile(String.valueOf(getRegNum()));
        jLabel6.setText(String.valueOf(getRegNum()));
    }
    catch(Exception e){
        jLabel6.setText("Error!");
    }
}                                        

public boolean havedigit(String in){
    for(int i=0;i<in.length();i++){
        if(Character.isDigit(in.charAt(i)))  return true;
    }
    return false;
} 
```

请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:17:09.623

这就是为什么你需要**检查异常**。只需抛出`SomeException`而不是`System.exit(1)`在块中正确处理它：

```
catch (SomeException e){
    jLabel6.setText("Error!");
} 
```

不要认为捕获所有异常是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:13:08.440

作为一般规则，尽量不要`System.exit()`在 GUI 驱动的应用程序中使用。它只会让整个程序退出，让用户想知道发生了什么。`System.exit()`通常更适合希望向 shell 提供退出代码的命令行应用程序，并且它与大多数操作系统中可用的[系统退出调用并行。](http://msdn.microsoft.com/en-us/library/ms194959%28v=vs.80%29.aspx)

试试这个：

```
private void jButton1ActionPerformed(java.awt.event.ActionEvent evt)   {                                         
    try{
        setFName(jTextField1.getText());
        if(havedigit(getFName())) { 
            jLabel6.setText("First name error!");
            return;
        }
        setLName(jTextField2.getText());
        if(havedigit(lastName)) {
            jLabel6.setText("Last name error!");
            return;
        }
        WriteToFile(getFName());
        WriteToFile(getLName());
        setDate(Integer.parseInt(jTextField3.getText()));
        WriteToFile(String.valueOf(getDate()));
        Random rnd1=new Random();
        Registration_Number=rnd1.nextInt(100);
        setRegNum(Registration_Number);
        WriteToFile(String.valueOf(getRegNum()));
        jLabel6.setText(String.valueOf(getRegNum()));
    }
    catch(Exception e){
        jLabel6.setText("Error!");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T23:13:24.520

这是您可以做到的一种方法：

```
private void jButton1ActionPerformed(java.awt.event.ActionEvent evt)   {                                         

    try{
        setFName(jTextField1.getText());
        setLName(jTextField2.getText());
        boolean firstNameHasDigit = havedigit(getFName());
        boolean lastNameHasDigit = havedigit(getLName());
        if (firstNameHasDigit || lastNameHasDigit) {
            jLabel6.setText("Names cannot contain digits");
        }
        else {
            WriteToFile(getFName());
            WriteToFile(getLName());
            setDate(Integer.parseInt(jTextField3.getText()));
            WriteToFile(String.valueOf(getDate()));
            Random rnd1=new Random();
            Registration_Number=rnd1.nextInt(100);
            setRegNum(Registration_Number);
            WriteToFile(String.valueOf(getRegNum()));
            jLabel6.setText(String.valueOf(getRegNum()));
        }
    }
    catch(Exception e){
        jLabel6.setText("Error!");
    }
}                                        

public boolean havedigit(String in){
    for(int i=0;i<in.length();i++){
        if(Character.isDigit(in.charAt(i)))  return true;
    }
    return false;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T23:28:02.593

```
 if(havedigit(getFName())==true) { 
        System.exit(1);
    }
    setLName(jTextField2.getText());
    if(havedigit(lastName)==true) {
        System.exit(1);
    } 
```

应该

```
 if(havedigit(getFName())) { 
        JOptionPane.showMessageDialog(.....);
        return; //get out of method, no need to continue
    }
    setLName(jTextField2.getText());
    if(havedigit(lastName)) {
        JOptionPane.showMessageDialog(.....);
        return; //get out of method, no need to continue
    } 
```

在 Google 上搜索如何使用 JOptionPane.showMessageDialog。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-19T23:17:24.787

在您的 if 语句中，而不是

```
System.exit(1); 
```

你应该有东西

```
throw new MyException("Error Text"); 
```

然后你的捕获应该是这样的：

```
catch(MyException e){
    jLabel6.setText(e.getMessage());
} 
```

其中 MyException 扩展了异常。

# prolog - 如何判断一个元素是否属于 Prolog 中的列表？

> ID：13962744
> 
> 赞同：2
> 
> 时间：2012-12-19T23:06:12.587
> 
> 标签：prolog

我有一个简单的程序来检查一个`X`元素是否属于一个列表：

```
member2(X, [X|_]).
member2(X,[_|T]):- member2(X,T). 
```

我正在尝试以扩展形式编写它（因为在以前的方式中行为不是那么清楚）。所以我用以下方式写了它：

```
member2(X, [X|_]).
member2(X,Y):- Y = [_|T],
               member2(X,T). 
```

所以意思就更清楚了：

我有一个代表基本情况的事实（如果`X`元素位于列表的头部，则该元素属于列表）。

规则说我必须证明两件事：

1) `Y = [_|T]`。这是真的，因为匿名变量`_`与任何东西都统一。

2）递归搜索`X`尾列表中的元素。

好的，我认为我的推理是正确的，但是该程序的第二个版本不起作用！我认为问题可能出在该`Y = [_|T]`部分

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T08:18:50.673

你的程序很好，两种形式。这是另一种（重新）编写它的方法

```
member2(X, [Y|Ys]) :-
    X = Y ; member2(X, Ys). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T07:27:16.937

我想**检查**成员的教科书示例是：

```
member_check(X, [X|Tail]). % or [X|_] to avoid the warning
member_check(X, [Y|Tail]) :- X \= Y, member_check(X, Tail). 
```

这可能比你的第二次尝试更清楚？

# javascript - 如何利用具有多个成功函数的通用 AJAX 调用

> ID：13962746
> 
> 赞同：5
> 
> 时间：2012-12-19T23:06:21.703
> 
> 标签：javascript, jquery

我正在进行一个返回 XML 的 ajax 调用。此 XML 需要根据用户所在站点中的页面部分进行不同的处理。因此，我想实现 1 个进行调用的 ajax 函数，并具有可变的成功函数......我确信它很简单，但我已经搜索了一段时间，但无法弄清楚......

```
function makeAjaxCall(variableSuccessFunction) {
    $.ajax.... (ajax stuff goes here)...
    success: variableSuccessFunction(xml)
}
function ViewOne(xml) {
    //take the XML and update the dom as appropriate
}
function ViewTwo(xml) {
    //take the XML and update the dom as appropriate
}

$(document).ready(function() {
    //be able to call either one of these functions
    makeAjaxCall(ViewOne);
    makeAjaxCall(ViewTwo);

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T23:20:03.380

你基本上已经掌握了！只需一个调整：

```
function makeAjaxCall(variableSuccessFunction) {
    $.ajax.... (ajax stuff goes here)...
    success: variableSuccessFunction // no (xml)
} 
```

您正在传递函数引用。`success`传递了对`variableSuccessFunction`（无论可能是什么）的引用，并且会像您向它提供匿名函数一样调用它。无需在`makeAjaxCall`.

# google-apps-script - 将 Google Apps 脚本发布为 Web 应用与将其发布为服务

> ID：13962747
> 
> 赞同：0
> 
> 时间：2012-12-19T23:06:28.033
> 
> 标签：google-apps-script

在[Google Apps 脚本参考](https://developers.google.com/apps-script/)中，我找到了类[Service](https://developers.google.com/apps-script/class_service)，它具有`enable()`“使脚本能够作为服务发布”的方法。我的问题是：将脚本发布为服务有什么好处，与将其发布为 Web 应用程序有何不同？从参考中不清楚。

我猜与 Web 应用程序相比，服务不应该有 UI，但是我可以创建一个没有 UI 的 Web 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T00:13:41.140

他们是一样的。旧的“发布为服务”术语已替换为“发布为 Web 应用程序”。在 Google Apps 脚本的上下文中，Web 应用程序与服务相同。Web 应用可以有 UI（UIApp 或 HTMLService），也可以只提供文本或 JSON（ContentService）。

请参阅 2012 年 6 月 18 日的[发行说明](https://developers.google.com/apps-script/release_notes?hl=en)，其中指出“发布 > 发布为服务现在是发布 > 部署为 Web 应用程序”。

Service 类允许您以编程方式执行发布操作，例如，可用于为您的用户提供良好的安装体验。这是带有示例代码的公告链接[http://googleappsdeveloper.blogspot.com.au/2012/04/introducing-script-service.html](http://googleappsdeveloper.blogspot.com.au/2012/04/introducing-script-service.html)

# c# - 将对象数组传递给 webapi

> ID：13962748
> 
> 赞同：9
> 
> 时间：2012-12-19T23:06:30.247
> 
> 标签：c#, asp.net-web-api, http-get

我有一个 .net mvc 4 webapi 项目，我试图将一个对象数组传递给我的控制器上的一个方法。

我在这里找到了一些关于需要设置对象属性的示例：param1=whatever¶m2=bling¶m3=blah。

但我不知道如何使用它传入一个集合。

这是我的方法签名。请注意，我已经用 [FromUri] 属性修饰了参数。

```
public List<PhoneResult> GetPhoneNumbersByNumbers([FromUri] PhoneRequest[] id)
{
    List<PhoneResult> prs = new List<PhoneResult>();
    foreach (PhoneRequest pr in id)
    {
        prs.Add(PhoneNumberBL.GetSinglePhoneResult(pr.PhoneNumber, pr.RfiDate, pr.FinDate, pr.State));
    }
    return prs;
} 
```

这是我的简单 PhoneRequest 对象：

```
public class PhoneRequest
{
    public string PhoneNumber { get; set; }
    public string RfiDate { get; set; }
    public string FinDate { get; set; }
    public string State { get; set; }
} 
```

这是我用来传递的示例：

```
http://localhost:3610/api/phonenumber/getphonenumbersbynumbers/
   [{"PhoneNumber":"8016667777","RfiDate":"","FinDate":"2012-02-11","State":"UT"},
    {"PhoneNumber":"8018889999","RfiDate":"2012-12-01","FinDate":"","State":"UT"}] 
```

使用它会返回“错误请求”

我也试过这个

```
http://localhost:3610/api/phonenumber/getphonenumbersbynumbers?
    id=[{"PhoneNumber":"8016667777","RfiDate":"","FinDate":"2012-02-11","State":"UT"},
        {"PhoneNumber":"8018889999","RfiDate":"2012-12-01","FinDate":"","State":"UT"}] 
```

确实到达了方法，但数组为空。

如何将我的 PhoneRequest 对象数组传递给我的 Web API 方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T23:50:53.780

尝试以这种格式从 uri 传递 PhoneRequest[]：

```
http://localhost:3610/api/phonenumber/getphonenumbersbynumbers?
    id[0][PhoneNumber]=8016667777&id[0][FinDate]=2012-02-11&id[0][State]=UT&
    id[1][PhoneNumber]=8018889999&id[1][RfiDate]=2012-12-01&id[1][State]=UT 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-20T05:13:04.900

我建议您为此使用 POST。

随着查询字符串的增长，您将遇到 URL 的最大长度问题，这取决于浏览器。

如果您有很多参数要传递，那么即使您实际上只是获取数据，POST 也是完全可以接受的。但是，您将失去的是用户使用查询字符串为特定页面添加书签的能力。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-26T21:17:29.373

我创建了一个自定义模型绑定器，即[FieldValueModelBinder](http://www.codeproject.com/Articles/701182/A-Custom-Model-Binder-for-Passing-Complex-Objects)类，它可以有效地传递包含嵌套数组或通用列表类型数据的任何对象，其中查询字符串具有字段名称对，而无需嵌入任何 JSON 和 XML 结构。模型绑定器可以解决上面讨论的所有问题。由于这个问题由问题 ID [19302078](https://stackoverflow.com/questions/19302078/passing-complex-type-containing-array-of-complex-types-to-web-api/20790283#20790283)扩展，您可以在该线程中查看我的答案的详细信息。

# jquery - 附加报价

> ID：13962750
> 
> 赞同：0
> 
> 时间：2012-12-19T23:06:30.907
> 
> 标签：jquery

我正在尝试一个具有调用 javascript 函数`append()`的属性的按钮：`onclick`

```
$('#button').append('<button onclick=setUrlLink(\''+pageN+'\')>Next</button>); 
```

检查源代码时，周围缺少引号`pageN`，我该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T23:09:28.243

为什么不使用**双引号**

```
$('#button').append('<button onclick=setUrlLink("'+pageN+'")>Next</button>');
                                            ----^         ^--- 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T23:08:54.977

为什么不直接使用 jQuery 来做到这一点？

```
$("#button").append($("<button>").on('click', function () { setUrlLink('pageN'); })
   .text('Next')); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T23:08:48.033

只需使用双引号而不是单引号来启动字符串。

```
$("#button").append("<button onclick=setUrlLink('" +pageN+ "')>Next</button>"); 
```

# javascript - 网址更改无闪烁

> ID：13962754
> 
> 赞同：1
> 
> 时间：2012-12-19T23:06:51.890
> 
> 标签：javascript, twitter, reload

怎样才能让页面重新加载一个新的 URL 和对应的内容顺利，让 header 不闪烁？例如，如果我在 Twitter 上单击菜单项 Home、Connect、Discover，标题保持显示，没有闪烁。我知道可以做到这一点的唯一方法是使用 Javascript，但 Javascript 不能更改 URL。Twitter网站背后的魔力是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:10:23.997

您可以使用[`history.pushState`](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)来操纵当前的 url。并使用 ajax 函数重新加载页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:15:29.413

他们只是使用ajax。

标头不会闪烁，因为它没有改变。ajax 调用请求数据，当它得到数据时，它会将其插入到正文中。

对于身体，

如果您不想在 ajaxed 时突然更改新内容，则可以使用效果函数淡入新内容。

如果您想在一次上传中加载静态数据，则可以使用 CSS 显示属性翻阅静态内容。

您可以看到浏览器没有加载新的 url，因为没有指示符。

此外，您可以看到 twitter 的 ajax 指示器正在运行。

要保留 ajax 调用的历史记录，请使用 info。从这篇文章：

[对于 ajax - 哈希与 HTML 5 历史 API？](https://stackoverflow.com/questions/6300335/for-ajax-hashes-vs-html-5-history-api)

对于推特：

他们使用 CSS 来翻页，因为 ajax 指示器和加载指示器在初始 ajax 调用后不亮。

您可以通过在控制台中执行 window.history.back() 来验证他们是否正在使用历史记录。

要动态更改 URL，请参见：

[更改浏览器中的 URL 而不使用 JavaScript 加载新页面](https://stackoverflow.com/questions/136458/change-the-url-in-the-browser-without-loading-the-new-page-using-javascript)

# c# - 使文本框与浏览器位置保持同步

> ID：13962763
> 
> 赞同：0
> 
> 时间：2012-12-19T23:07:30.843
> 
> 标签：c#, silverlight, windows-phone-7

我正在创建一个网络浏览器应用程序，并希望 textbox2（url 地址栏）与 webBrowser1（网页显示）同步，以便用户在页面上单击的任何内容都会出现在框中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:37:27.827

您可以绑定`textbox2.Text`到`webBrowser1.Source`，如下所示：

```
<TextBox x:Name="textbox2" Text="{Binding ElementName=webBrowser1, Path=Source}" />
<WebBrowser Height="160" Width="160" x:Name="webBrowser1"/> 
```

这样，当用户更改 中的文本时`textBox2`，Web 浏览器也会更新它指向的页面。

# perl - xslate/Catalyst::View::Xslate 包装器

> ID：13962769
> 
> 赞同：2
> 
> 时间：2012-12-19T23:08:00.170
> 
> 标签：perl, catalyst, template-toolkit

我有一个使用 TT 获取视图的 Catalyst 应用程序： [https ://metacpan.org/module/Catalyst::View::TT](https://metacpan.org/module/Catalyst::View::TT)

我想试试[https://metacpan.org/module/Catalyst::View::Xslate](https://metacpan.org/module/Catalyst::View::Xslate)

我们将 WRAPPER 指令与 Template Toolkit 一起使用，我很好奇是否可以通过 xslate 以某种方式重用包装器，或者我是否必须将它们分解为页眉和页脚？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T02:01:06.803

You can in theory, by using [TTerse syntax](https://metacpan.org/module/Text%3a%3aXslate%3a%3aSyntax%3a%3aTTerse). According to the manual, enabling this allows you to use a lot of TT compatible code, including a simple `WRAPPER` statement.

However, there are caveats, [as documented here](https://metacpan.org/module/Text%3a%3aXslate%3a%3aSyntax%3a%3aTTerse#Template-inclusion). Given the philosophical differences between Xslate and TT, you might find it easier to bite the bullet and just rewrite your wrapper as header and footer Xslate code.

Or hold off on Xslate until your next project. Like horses, Templating engines are difficult to change mid-stream. :-)

# php - Twitter 不保存唯一的推文 ID

> ID：13962771
> 
> 赞同：0
> 
> 时间：2012-12-19T23:08:04.883
> 
> 标签：php, twitter, pdo

我已经构建了一个 php 脚本来保存哈希标记搜索的结果，当我保存推文 ID 时，它只是尝试保存一个副本。我在表上设置了一个 UNIQUE 约束，它显然只保存了第一条推文，并抛出了下面的错误。这并不奇怪

```
ERROR: SQLSTATE[23000]: Integrity constraint violation: 1062 Duplicate entry '2147483647' for key 2 
```

如果我删除约束，它会正确保存所有推文，但推文 ID 是重复的

我尝试在输出中显示来自我用来放入表中的同一变量的推文，它都是唯一且正确的，因此变量是正确的。所以我只能假设一些奇怪的事情本身就在发生

```
foreach($results as $result) {
$tweet_ID = $result->id_str;
$userID = $result->from_user_id_str;
$tweetText = $result->text;
$tweet_time = strtotime($result->created_at);
$createdAt = date('Y-m-d H:i:s ',$tweet_time);

echo '<div>'. $tweet_ID . 
     '<div class="tweet" >' . displayTweet($result->text),"\r\n" .
        '<div class="user">'. '<strong>Posted </strong>' . date('j/n/y H:i:s ',$tweet_time). '<strong> By </strong>' . 
        '<a rel="nofollow" href="http://twitter.com/' . $result->from_user. '">' . $result->from_user .
        '</div>' .
     '</div>';  

// Execute query 
$stmt = $conn->prepare("INSERT INTO ".$hashtag."(tweetID, userID, tweetText, createdAt) VALUES(:tweetID, :userID, :tweetText, :createdAt)");
$stmt->execute(array(':tweetID' => $tweet_ID, ':userID' => $userID, ':tweetText' => $tweetText, ':createdAt' => $createdAt));
}
} catch(PDOException $e) {
    echo 'ERROR: ' . $e->getMessage();
} 
```

我无法弄清楚为什么它会保存一些随机数

它添加的数字是 2147483647。对我来说没有任何意义。任何有关正在发生的事情的帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:13:29.013

这个数字`2147483647` 清楚地表明您没有使用**64 位**整数来存储推文 ID。推文 ID 是**64 位**整数。您应该使用列`BIGINT`的数据类型`tweetID`。

```
`tweetID` BIGINT UNSIGNED 
```

您获得的特殊值是因为当**64 位**推文 id 转换为**32-bit**`2147483647`时，所有高位都被截断。如果你可以使用这个数字会更高。但不超过。推文ID远高于此。您必须使用 64 位 ****`signed int``unsigned int``2147483647*2``unsigned int`****

 ****我还看到您正在为插入查询使用动态表名。不要那样做！在遇到性能问题之前，一张表可以容纳很多行。****

# sql - 不是 GROUP BY 表达式错误

> ID：13962772
> 
> 赞同：5
> 
> 时间：2012-12-19T23:08:06.460
> 
> 标签：sql, oracle, group-by

我对数据库比较陌生。我正在使用 Oracle，并且正在尝试执行此查询以查找该成员参加过的个人培训课程的数量。

表格是；

**会员**

```
MEMBERS_ID(NUMBER),
MEMBERSHIP_TYPE_CODE(VARCHAR),
ADDRESS_ID(NUMBER), CLUB_ID(NUMBER) 
MEMBER_NAME(VARCHAR), 
MEMBER_PHONE(VARCHAR), 
MEMBER_EMAIL(VARCHAR) 
```

**PERSONAL_TRAINING_SESSIONS**

```
SESSION_ID(VARHCAR), 
MEMBER_ID (NUMBER), 
STAFF_ID(VARCHAR), 
SESSION_DATETIME(DATE) 
```

我的查询正在返回此错误：

> ORA-00979：不是 GROUP BY 表达式 00979。00000 -“不是 GROUP BY 表达式” *原因：
> *操作：行错误：1 列：8

```
SELECT MEMBERS.MEMBER_ID,MEMBERS.MEMBER_NAME, COUNT(personal_training_sessions.session_id)
FROM MEMBERS JOIN personal_training_sessions
ON personal_training_sessions.member_id=members.member_id
GROUP BY personal_training_sessions.session_id; 
```

谁能指出我正确的方向？我环顾四周是否需要分开计数查询？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T23:10:46.940

该错误说明了一切，您没有按`MEMBERS.MEMBER_ID`and分组`MEMBERS.MEMBER_NAME`。

```
SELECT MEMBERS.MEMBER_ID, MEMBERS.MEMBER_NAME
     , COUNT(personal_training_sessions.session_id)
  FROM MEMBERS 
  JOIN personal_training_sessions
    ON personal_training_sessions.member_id = members.member_id
 GROUP BY MEMBERS.MEMBER_ID, MEMBERS.MEMBER_NAME 
```

*您想要每个*成员的个人会话数，因此您需要按成员信息进行分组。

基本的（当然它可以变得更复杂）GROUP BY, SELECT 查询是：

```
SELECT <column 1>, <column n>
     , <aggregate function 1>, <aggregate function n>
  FROM <table_name>
 GROUP BY <column 1>, <column n> 
```

正如 Ken White 所说，聚合函数类似于`MIN()`,`MAX()`等`COUNT()`。您 GROUP BY*所有*未聚合的列。

`MEMBERS`如果您的表在 上是唯一的，这只会按预期工作`MEMBER_ID`，但根据您的查询，我怀疑它是。为了澄清我的意思，如果您的表不是唯一的，`MEMBER_ID`那么您不是在计算每个会话数，*而是*`MEMBER_ID`每个会话数。如果他们处于 1:1 的关系，那么它实际上是同一件事，但如果你可以有多个s，那么它不是。`MEMBER_ID` *`MEMBER_NAME``MEMBER_NAME``MEMBER_ID`*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T23:10:52.573

```
SELECT MEMBERS.MEMBER_ID,
       MEMBERS.MEMBER_NAME, 
       COUNT(personal_training_sessions.session_id)

FROM MEMBERS JOIN personal_training_sessions
ON personal_training_sessions.member_id=members.member_id

GROUP BY personal_training_sessions.session_id; 
```

您正在使用 COUNT 函数，因此其他列 MEMBER_ID 和 MEMBER_NAME 必须包含在 group by 子句中。*

# javascript - 如果Javascript中的性能很重要，我应该传递封装在对象中的函数参数还是一一传递？

> ID：13962776
> 
> 赞同：5
> 
> 时间：2012-12-19T23:08:52.993
> 
> 标签：javascript, performance, function, object, parameters

我经常发现自己在函数之间传递了很多参数。看起来像这样：

```
ajaxLiveUpdate : function (bindTo, func, interval, 
                      dyn, el, lib_template, locale, what) {
   // do sth
} 
```

虽然我可以看到将这些存储在一个对象中`specs`“视觉上”是有意义的，但我很好奇创建对象、分配所有键/值对和传递对象的性能影响。

**问题：**
如果每毫秒都很重要，那么对大量函数参数进行洗牌的最佳和最结构化的方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:31:57.897

我认为一个好的优化器会使这种微优化变得微不足道。随意使用更适合您的编码风格和代码阅读习惯的那个。如果您更喜欢对象，因为它更紧凑，请继续使用对象。如果您更愿意明确说明论点，那么就这样做。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-27T19:43:53.963

创建和传递对象而不仅仅是传递参数时可能会有一些性能开销，但我怀疑这将成为您的应用程序瓶颈。由于代码可读性，我会选择一个对象。

在 V8 (node.js v0.10.8) 中尝试过。

```
console.time(44);
var f = function(a,b,c,d,e) {
    return a+b+c+d+e;
};
var s = 0;
for(var i=0;i<100000000;++i) {
    s += f(i,i*2,i+1,i-1,i*3);
}
console.timeEnd(44);
console.log(s); 
```

**~1440 毫秒**

```
console.time(44);
var f = function(x) {
    return x.a+x.b+x.c+x.d+x.e;
};
var s = 0;
for(var i=0;i<100000000;++i) {
    s += f({a:i,b:i*2,c:i+1,d:i-1,e:i*3});
}
console.timeEnd(44);
console.log(s); 
```

**~2236 毫秒**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T23:37:32.717

如果您传递封装在对象中的参数，则会发生以下情况：

在 JavaScript 中，当您从对象中检索值时，与使用 for 子句解析数组相同。因为 JavaScript 中的对象与关联数组相同。因此，您将浪费计算时间来通过键搜索您的值。

仅当您有很多参数（5 个或更多）并且这是组织它们的好方法时才使用此选项，而且您将获得传递参数的能力，而与它们的正确位置无关。

# java - Jsoup.connect().get() 中的 OutOfMemoryError

> ID：13962778
> 
> 赞同：3
> 
> 时间：2012-12-19T23:09:17.940
> 
> 标签：java, android, jsoup

尝试在 Android 上使用 Jsoup 连接到某些站点，它会引发 java.lang.OutOfMemoryError 异常。例子：

```
Jsoup.connect("http://www.xbox360achievements.org/game/grand-theft-auto-iv/guide/").get(); 
```

可以做些什么来避免这个问题？

Jsoup 1.7.1

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:27:18.497

OutOfMemoryError 意味着您的应用程序使用的内存超出了它的可用内存。（呃！）

您的选择是：

*   增加允许应用程序使用的内存量。

*   减少应用程序使用的内存量。例如：

    *   在使用 jsoup 解析之前不要读取和缓冲整个文档。

    *   确保您没有在内存中保留太多正在抓取的页面的信息。要么将其写入文件系统，要么即时“减少”它。

    *   分析应用程序的内存使用情况，以查找泄漏和其他内存使用过多的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:23:20.733

似乎 get 方法将所有内容都存储在内存中，因此当您加载大型内容时，您会得到 OOME

从我可以看到你的选择是：

1.  加载一个较小的文档，您尝试加载的文档似乎很大。内存非常重要，尤其是在手持设备上
2.  以块的形式预处理文档并一次处理一个，这样您就不会使用太多的内存
3.  在内存更大的环境中运行程序
4.  弄清楚 Jsoup 是否可以做缓冲 IO，如果不能使用不同的库或编写自己的库。使用缓冲 IO，您一次只能读取和处理数据块，因此您不会使用太多内存空间

# python - 两个列表中的公共元素python

> ID：13962781
> 
> 赞同：0
> 
> 时间：2012-12-19T23:09:34.463
> 
> 标签：python, list

我有两个从两个不同的数据库表生成的 python 列表

```
list1= ["'HZ1398043','HZ1395693','HZ1395532','HZ1395240','HZ1395194','HZ1395113','HZ1395036','HZ1395236','HZ1396139','HZ1398028','HZ1395098','HZ1395998','HZ1395018','HZ1395829','HZ1398031','HZ1395708','HZ1398029','HZ1398030','HZ1398054''"]

list2= ['', '', '', '', '', 'HZ1395018', 'HZ1395036', 'HZ1395098', 'HZ1395113', 'HZ1395194', 'HZ1395236', 'HZ1395240', 'HZ1395532', 'HZ1395693', 'HZ1395708', 'HZ1395829', 'HZ1395998', 'HZ1396139', 'HZ1398028', 'HZ1398029', 'HZ1398031', 'HZ1398043', 'HZ1397932', 'HZ1397949', 'HZ1398004', 'HZ1398021', 'HZ1398030', 'HZ1397940', 'HZ1397941', 'HZ1398010',', '', ''] 
```

我需要找到两者之间的共同元素

```
set(list1) & set(list2) 
```

不显示任何东西

甚至`[i for i in list1 if i in list2]`不显示任何东西。我可以清楚地看到HZ1398043是常见的。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T23:11:09.593

仔细看，你的第一个列表实际上是一个包含一个项目的列表，一个大字符串。

```
>>> list1= ["'HZ1398043','HZ1395693','HZ1395532','HZ1395240','HZ1395194','HZ1395113','HZ1395036','HZ1395236','HZ1396139','HZ1398028','HZ1395098','HZ1395998','HZ1395018','HZ1395829','HZ1398031','HZ1395708','HZ1398029','HZ1398030','HZ1398054''"]
>>> len(list1)
1 
```

理想情况下，在您获取数据的任何地方进行修复，以便为您提供正确的东西，如果这不可能，那么您将需要解析数据。

您将想做一些事情，例如`list1 = [item.strip("'") for item in list1[0].split(",")]`获取实际列表（一个简单的[列表理解](http://www.youtube.com/watch?v=pShL9DCSIUw)），然后使用您的一种方法（set 方法是最有效的，尽管如果您希望保留重复项和顺序，您将需要执行第二种方法，尽管您可以通过`list2`预先制作一组来检查成员资格来改进它）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T13:33:44.937

```
def compare(list1,list2):
ln= []
for i in list1:
    if i  in list2:
       ln.append(i)
return ln 
```

打印（比较（list1，list2））

不优化但易于理解。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T23:11:53.463

首先，您需要从 list1 中创建一个适当的列表，这可以通过以下方式完成：

```
list1 = [item.strip("'") for item in list1[0].split(",")] 
```

那么你的代码应该可以正常工作。寻找共同元素的另一种（更紧凑但更慢）的方法是：

```
common = filter(lambda x:x in list1,list2) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T23:13:34.900

他们*应该*是这样的：

```
list1= ['HZ1398043','HZ1395693','HZ1395532','HZ1395240','HZ1395194','HZ1395113','HZ1395036','HZ1395236','HZ1396139','HZ1398028','HZ1395098','HZ1395998','HZ1395018','HZ1395829','HZ1398031','HZ1395708','HZ1398029','HZ1398030','HZ1398054']
list2= ['', '', '', '', '', 'HZ1395018', 'HZ1395036', 'HZ1395098', 'HZ1395113', 'HZ1395194', 'HZ1395236', 'HZ1395240', 'HZ1395532', 'HZ1395693', 'HZ1395708', 'HZ1395829', 'HZ1395998', 'HZ1396139', 'HZ1398028', 'HZ1398029', 'HZ1398031', 'HZ1398043', 'HZ1397932', 'HZ1397949', 'HZ1398004', 'HZ1398021', 'HZ1398030', 'HZ1397940', 'HZ1397941', 'HZ1398010','', '', ''] 
```

修复它们后，您的代码可以工作。

# hosting - 编码时虚拟主机的标准陷阱？

> ID：13962782
> 
> 赞同：0
> 
> 时间：2012-12-19T23:09:40.770
> 
> 标签：hosting, web-hosting, host

前几天朋友问了我一个问题，这让我开始思考。他问我“在开发 Web 服务器方面的新代码/软件时，您最大的困难是什么？”

起初我不知道如何回答，我已经编码 PHP / MySQL 和小 Perl 好几年了。以及为什么我在数据中心拥有自己的专用服务器，我在其上开发大部分软件，大部分时间脚本并没有最终存在于那里。

以下是我在开发时可以考虑的一些事情，只是想看看你们是否可以给我更多思考的东西，我可以在开始工作时从中获取并制作个人清单在新项目上。

1.  我需要完成哪些核心功能，我是否已经有解决方案来完成此任务？

2.  解决方案是编程语言标准核心的一部分，还是需要一个模块/插件才能达到预期的结果。

3.  大多数网络主机上是否安装了模块或插件标准？

4.  我是否立即知道客户所在的虚拟主机及其限制？

5.  如果我需要的模块或插件不是标准的，网络主机可以为我安装和保护吗？如果不是，我是否愿意安装和固定。

6.  谁将负责使模块/插件保持最新状态？

7.  这如何影响服务器上的全部负载？

8.  我是否需要重新考虑流程并查看其他解决方案/选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T04:05:06.740

在将 PHP 和 MySQL 移动到不同的服务器时，它们不会出现很多问题。与任何其他解释器语言一样，PHP 几乎可以在任何地方工作。这些问题主要出现在以下情况：

- 安装不同的 PHP 版本（并且您使用最新和最强大的功能）

- 安装不同的 MySQL 版本（同上）

- 不同的 PHP 配置或客户端无法更改它（例如：短标签）

- 如果您的 PHP 脚本在系统级别工作（exec()，可能是一些文件系统操作），不同的操作系统可能会导致问题

# freebase - 如何从 freebase 获得完整的描述

> ID：13962784
> 
> 赞同：0
> 
> 时间：2012-12-19T23:09:51.770
> 
> 标签：freebase

我经常得到像这样在句子中间结尾的人的描述：https: [//www.googleapis.com/freebase/v1/text/en/dr_luke](https://www.googleapis.com/freebase/v1/text/en/dr_luke)

为什么会发生以及如何获得完整的描述？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:45:42.767

如果文本来自 Wikipedia，则 Freebase 只有一个片段，您需要从 Wikipedia 获取其余部分（或任意数量）。

# php - 使用 PDO 从 MySQL 获取结果

> ID：13962789
> 
> 赞同：2
> 
> 时间：2012-12-19T23:10:10.537
> 
> 标签：php, mysql, pdo

我正在尝试使用 PDO 从我的表中检索数据，但我似乎无法向浏览器输出任何内容，我只是得到一个纯白页面。

```
try {
  // Connect and create the PDO object
  $conn = new PDO("mysql:host=$hostdb; dbname=$namedb", $userdb, $passdb);
  $conn->exec("SET CHARACTER SET utf8");      // Sets encoding UTF-8

        $lastIndex = 2;

        $sql = "SELECT * FROM directory WHERE id > :lastIndex AND user_active != '' LIMIT 20"
        $sth = $conn->prepare($sql);
        $sth->execute(array(':lastIndex' => $lastIndex));

        $c = 1;
        while ($row = $sth->fetch(PDO::FETCH_ASSOC)) {
            echo 'ALL STYLING ETC RESULTS HERE';
        $c++;
        }

  $conn = null;        // Disconnect
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T23:17:16.520

**例子。** 这是你的 dbc 类

```
<?php

class dbc {

    public $dbserver = 'server';
    public $dbusername = 'user';
    public $dbpassword = 'pass';
    public $dbname = 'db';

    function openDb() {    
        try {
            $db = new PDO('mysql:host=' . $this->dbserver . ';dbname=' . $this->dbname . ';charset=utf8', '' . $this->dbusername . '', '' . $this->dbpassword . '');
        } catch (PDOException $e) {
            die("error, please try again");
        }        
        return $db;
    }

    function getAllData($qty) {
        //prepared query to prevent SQL injections
        $query = "select * from TABLE where qty = ?";
        $stmt = $this->openDb()->prepare($query);
        $stmt->bindValue(1, $qty, PDO::PARAM_INT);
        $stmt->execute();
        $rows = $stmt->fetchAll(PDO::FETCH_ASSOC);
        return $rows;
    }    
?> 
```

您的 PHP 页面：

```
<?php 
require "dbc.php";

$getList = $db->getAllData(25);

foreach ($getList as $key=> $row) {
         echo $row['columnName'] .' key: '. $key;
    } 
```

# wordpress - 阅读更多标签删除 wordpress 中的内容

> ID：13962791
> 
> 赞同：0
> 
> 时间：2012-12-19T23:10:23.603
> 
> 标签：wordpress

每当我尝试将`<!--more-->`标签添加到我的帖子内容并进行更新时，它都会删除我的所有帖子，除了`<!--more-->`标签之前的内容。

为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T15:32:56.477

原来这与默认的 wordpress 编辑器有关。[我为wordpress](http://wordpress.org/extend/plugins/ckeditor-for-wordpress/)安装了ck编辑器插件

它工作得很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T14:12:56.710

我建议将`wp-admin`and文件夹替换为新文件夹，来自[此处](http://wordpress.org/download/)`wp-includes`找到的 zip

# mysql - MySQL AVG 和分组

> ID：13962799
> 
> 赞同：1
> 
> 时间：2012-12-19T23:11:14.687
> 
> 标签：mysql, group-by, average

我正在为 MySQL 语句而苦苦挣扎，并希望在我接近时得到一些指导，但并不完全在那里。我有一个数据库，其中包含一个物业地址表和物业出租清单。财产地址与一个或多个区域相关，该表与一个地区表相关，然后与一个郊区表相关。

我正在尝试创建一个结果，该结果为我提供每个郊区每月的平均租金和卧室数量。

例如：

```
District Suburb Month YEAR YMD Bedrooms DataAverage
尼尔森小溪 01 2012 2012-01-01 00:00 1 190
尼尔森小溪 01 2012 2012-01-01 00:00 2 274
尼尔森小溪 01 2012 2012-01-01 00:00 3 341

```

然后我可以将其转换为如下表格：

```
平均租金

郊区床位 Jan-12 Feb-12 Mar-12 Apr-12 May-12 Jun-12 Jul-12
小溪
    1 $150 $245 $160 $285 $135 $370 $350
    2 $330 $340 $380 $310 $335 $345 $355
    3 $350 $380 $310 $395 $380 $350 $350
内城
    1 $160 $245 $260 $285 $295 $300 $350
    2 $360 $440 $480 $410 $535 $545 $555
    3 $370 $480 $510 $595 $480 $450 $550

```

我当前的 SQL 查询是这样的：

```
SELECT d.name as District, s.name AS Suburb,
FROM_UNIXTIME(l.StartDate,'%m') AS Month,
FROM_UNIXTIME(l.StartDate,'%Y') AS YEAR,
FROM_UNIXTIME(l.StartDate, '%Y-%m-01 00:00') AS YMD,
p.Bedrooms,
REPLACE(FORMAT(AVG(l.RentPerWeek),0),',','') AS DataAverage
FROM properties p
LEFT JOIN listings l on l.property_id=p.id
LEFT JOIN regions r on p.region_id=r.id
LEFT JOIN districts d on d.region_id=r.id
LEFT JOIN suburbs s on s.district_id=d.id
WHERE FROM_UNIXTIME(l.StartDate) BETWEEN DATE(NOW()) - INTERVAL (DAY(NOW()) - 1) DAY - INTERVAL 11 MONTH AND NOW()
GROUP BY District, Suburb, Year, Month, Bedrooms 
ORDER BY District, Suburb ASC, YMD ASC, Bedrooms ASC 
```

不幸的是，我得到的是每个郊区的相同结果。我想我可能需要创建一个子查询 SQL 语句才能使其正常工作，但我并不完全确定。

所以我得到这样的东西：

```
District Suburb Month YEAR YMD Bedrooms DataAverage
尼尔森小溪 01 2012 2012-01-01 00:00 1 190
尼尔森小溪 01 2012 2012-01-01 00:00 2 330
尼尔森小溪 01 2012 2012-01-01 00:00 3 350
尼尔森小溪 02 2012 2012-02-01 00:00 1 245
尼尔森小溪 02 2012 2012-02-01 00:00 2 340
尼尔森小溪 02 2012 2012-02-01 00:00 3 380
...
尼尔森内城 01 2012 2012-01-01 00:00 1 190
尼尔森内城 01 2012 2012-01-01 00:00 2 330
尼尔森内城 01 2012 2012-01-01 00:00 3 350
尼尔森内城 02 2012 2012-02-01 00:00 1 245
尼尔森内城 02 2012 2012-02-01 00:00 2 340
尼尔森内城 02 2012 2012-02-01 00:00 3 380
。ETC。

```

```
平均租金

郊区床位 Jan-12 Feb-12 Mar-12 Apr-12 May-12 Jun-12 Jul-12
小溪
    1 $150 $245 $160 $285 $135 $370 $350
    2 $330 $340 $380 $310 $335 $345 $355
    3 $350 $380 $310 $395 $380 $350 $350
内城
    1 $150 $245 $160 $285 $135 $370 $350
    2 $330 $340 $380 $310 $335 $345 $355
    3 $350 $380 $310 $395 $380 $350 $350

```

任何指示或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:26:13.377

假设这`id`是每个表的主键，那么根据您的查询文本，一个*属性*与一个*region*相关联，凭借表`region_id`上的列`properties`：

```
 FROM properties p
      LEFT
      JOIN regions r 
        ON p.region_id=r.id 
```

一个*地区*与一个*地区*相关联（大概，一个地区是一个地区的细分。）

```
 LEFT
      JOIN districts d
        ON d.region_id=r.id 
```

并且*郊区*与*地区*相关联（据推测，郊区是地区的细分。）

```
 LEFT
      JOIN suburbs s
        ON s.district_id=d.id 
```

最终结果是，一个*区域*内的每个房产都与*该区*域内的每个*区域*相关联，并与每个*区域*内的每个*郊区*相关联。

 *因此，您将获得一个地区内所有房产的平均租金值。

要获得每个*郊区*的租金值，您确实需要*房产*与其*郊区*之间的关系。

您真正需要的是表`suburb_id`上的一列作为`properties`表的外键`suburbs`。

```
 LEFT
      JOIN suburbs s 
        ON s.district_id=d.id
       AND s.id = p.suburb_id 
```*

# css - 同一页面的不同悬停效果

> ID：13962803
> 
> 赞同：0
> 
> 时间：2012-12-19T23:11:37.153
> 
> 标签：css

我有点难以理解如何在同一页面中包含 2 个不同的悬停属性。我希望导航栏的悬停效果与网页中某些内容的悬停效果不同。

我当前的CSS如下：

```
a:hover {
    color: #CCC;
    background-color: #D8D8D8;
    cursor: default;
} 
```

假设我只想将背景颜色从一个链接更改为下一个链接，那么上述内容将如何变化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:15:30.557

您可以为链接使用不同的类：

```
<a class="typeA">foo</a>
<a class="typeB">bar</a>

a.typeA:hover {
    color: #CCC;
    background-color: #D8D8D8;
    cursor: default;
}

a.typeB:hover {
    color: #C0C;
    background-color: #fc0;
    cursor: default;
} 
```

# layout - UICollectionView 布局，单元格间隔很远

> ID：13962805
> 
> 赞同：2
> 
> 时间：2012-12-19T23:11:40.307
> 
> 标签：layout, uicollectionview

我有一个`UICollectionView`显示图像的。我的图像尺寸为 114x133，但由于某种原因实际尺寸大于此尺寸`UICollectionVewCell`（我可以看到这是因为我将单元格背景设置为红色）。因此，视图只能显示 2 个图像，并且两者之间存在巨大差距。我正在实施以下

```
- (CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath {
    UIImage* img = [UIImage imageNamed:@"thumbnail_frame.png"];

    return img.size;
}

- (UIEdgeInsets)collectionView:
(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout insetForSectionAtIndex:(NSInteger)section {
    return UIEdgeInsetsMake(1, 1, 1, 1);
} 
```

我正在以`contentview`编程方式创建单元格（即初始化`imageView`等）。

我在以编程方式创建整个视图的不同视图中面临同样的问题。我在那里：

```
 UICollectionViewFlowLayout *flowLayout = [[UICollectionViewFlowLayout alloc] init];
    flowLayout.minimumInteritemSpacing=10;
    flowLayout.minimumLineSpacing= 30;
    flowLayout.sectionInset = UIEdgeInsetsMake(5, 5, 5, 5);

    if(collectionView != nil) {
        [collectionView removeFromSuperview];
    }

    CGRect frm= CGRectMake(45, 80, 250, 230);

    collectionView = [[UICollectionView alloc] initWithFrame:frm collectionViewLayout:flowLayout];//(0, 0, self.view.frame.size.width, self.view.frame.size.height) collectionViewLayout:flowLayout];
    collectionView.backgroundColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:0.5];
    collectionView.clipsToBounds = YES;
    collectionView.layer.cornerRadius = 10.0;
    collectionView.dataSource = self;
    collectionView.delegate = self;
    [collectionView registerClass:[YourPicCollectionViewCell class] forCellWithReuseIdentifier:@"YourPicCell"]; 
```

同样，两个图像之间的差距很大，或者如果我缩小宽度，则有 3 个图像，但最右边的一个是半可见的。

我修改了间距，但它似乎不起作用。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-20T03:18:06.857

我认为不要调整单元格的大小..您应该尝试调整集合视图的大小。确保集合视图的宽度刚好可以连续容纳 2 个项目。这是因为如果集合视图的宽度大于单元格的宽度，那么它将粘在最右边和最左边。如果它太短，那么只有一个单元格将显示在中心（假设您试图保持 2 个单元格连续）。

您的一个单元格半可见的原因是集合视图的宽度大于其超级视图。

因此，执行以下操作将帮助您获得想要的东西..

1.  框住您的集合视图，使其小于其超级视图并且应等于 (numberOfCells X width) + ((numberOfCells-1) X cellGap)。
2.  如果它是自定义集合视图单元格，请尝试向 imageView 添加约束，以使图像贴在单元格边缘。

# wcf - WCF 和 AFNetworking 上传

> ID：13962806
> 
> 赞同：0
> 
> 时间：2012-12-19T23:11:40.903
> 
> 标签：wcf, afnetworking

很高兴地弄清楚了这一点，谷歌把我引向了不值得采取的方向。

我希望使用 AFNetworking 将多个文件流式传输到 WCF 服务，并使用查询字符串参数发送 id 等。

我会发布我拥有的代码，但目前它不值得。

我认为问题在于 WCF 的结束，因为我无法弄清楚如何正确连接它。

如果有人可以为此提供一些可靠的方向，我将不胜感激！

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-12T15:28:46.913

我刚刚处理了 AFNetworking/WCF 问题的 iOS 端，所以我只能从这个角度提供一些帮助。我们遇到问题的原因是因为 WCF 端的 65k 上传限制（[http://forums.asp.net/t/1715789.aspx/1?64kb+limit+on+upload+of+file](http://forums.asp.net/t/1715789.aspx/1?64kb+limit+on+upload+of+file)）。一旦我们的服务器人员提高了上传限制，我们的代码就会像魅力一样工作。

# functional-programming - 为什么 OCaml 不允许函数匹配？

> ID：13962811
> 
> 赞同：2
> 
> 时间：2012-12-19T23:11:57.013
> 
> 标签：functional-programming, ocaml

如果我做

```
match (fun i -> i + 1) with
   (fun i -> i + 1) -> true;; 
```

它被拒绝了。

**为什么 OCaml 不允许函数匹配？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-20T08:17:55.627

Ocaml（如 Haskell）基于 Lambda 演算。比较两个函数通常是不确定的：如果你可以比较两个函数，那么你可以说一个函数是否终止。但是，如果你的语言是图灵完备的，你就不能。

我们使用的所有通用语言都是图灵完备的：它们能够计算任何东西。

所以，也许在某些情况下是可能的，在一般语言中是不可能的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T23:37:37.817

有很多困难的问题。

*   函数应该匹配到什么程度？例如应该`fun x -> x + 1`与您的版本匹配？`fun i -> 1 + i`或者怎么样`fun i -> ((fun x -> i+1) 42)`？AFAIK 没有办法证明两个任意函数在行为上是等价的（在纯 lambda-calculus-like 函数的情况下可能存在）。

*   函数被编译并且它们的句法结构在运行时不再存在。不过，当然可以通过身份匹配功能。

*   模式匹配是关于解构值，但 OCaml 中没有符号来区分函数中使用的变量和模式一部分的变量。

在我的硕士期间，我们学习了 Lambda Prolog，它能够统一 lambda 表达式；这看起来很漂亮（虽然对我的记忆来说有点远）但是该语言是一种研究原型，甚至比普通 Prolog 更不受欢迎......我很高兴有关于它的消息 :)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T23:38:22.393

比较函数是否相等是困难的。如果您根据函数的文本表示定义相等，则`fun x -> x + 1`比较不同于`fun x -> 1 + x`. 这不是很有用。如果您根据函数的值定义相等，则结果是不可计算的。结果是没有合理的定义。

# c++ - 有时需要使用这个吗？

> ID：13962814
> 
> 赞同：6
> 
> 时间：2012-12-19T23:12:33.637
> 
> 标签：c++, templates

只是偶然发现了一些我无法解释的东西。以下代码无法编译

```
template<int a>
class sub{
protected:
    int _attr;
};

template<int b>
class super : public sub<b>{
public:
    void foo(){
        _attr = 3;
    }
};

int main(){
    super<4> obj;
    obj.foo();
} 
```

而当我更改为时`_attr = 3;`似乎`this->attr = 3;`没有问题。

这是为什么？有什么情况你必须使用它吗？

我曾经`g++ test.cpp -Wall -pedantic`编译，我得到以下错误

```
test.cpp: in member function 'void super<b>::foo()':
test.cpp:11:3: error: '_attr' was not declared in this scope 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T23:20:09.530

`Why is that? Are there any cases you must to use this?`

是的，在某些情况下您需要使用`this`. 在您的示例中，当编译器看到 时`_attr`，它会尝试`_attr`在类内部查找但找不到它。通过添加*延迟*查找直到实例化时间，这允许编译器`this->`在.*`sub`*

 *使用它的另一个非常常见的原因是解决歧义问题：

```
void foo (int i)
{
   this->i = i;
} 
```*

# python - 存在前缀时如何查找所有匹配项

> ID：13962816
> 
> 赞同：1
> 
> 时间：2012-12-19T23:12:56.267
> 
> 标签：python, regex, iterator

我正在寻找 HTML 页面中的重复模式。
我感兴趣的模式在前缀“<h2>Seasons</h2>”之后开始
。同样的模式也出现在前缀之前，我对那些不感兴趣。

我尝试（但失败了）以下 python 代码（为了使这个问题易于阅读，我将模式简化为 '<a href=.+?</a>'）：

```
matches = re.compile('<h2>Seasons</h2>.+?(<a href=.+?</a>)+',re.DOTALL).findall(page)  
for ref in matches  
   print ref 
```

给定页面：

```
blah blah html stuff 
<h2>Seasons</h2>  
blah blah  more html stuff
<a href=http://www.111.com>111</a><a href=http://www.222.com>222</a><a href=http://www.333.com>333</a> 
```

输出是

```
<a href=http://www.333.com>333</a> 
```

所以它只打印最后一个匹配，其他两个不进入 findall 列表。如何遍历组的所有匹配项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:19:12.307

问题是正则表达式只匹配一次。带括号的组匹配多次，但整个正则表达式只匹配一次。这意味着只返回一个匹配项，即最后一个匹配项。

要解决这个问题，您需要编写一个匹配多次的正则表达式。`<h2>`您可能会认为对元素使用后向断言，如下所示：

```
(?<=<h2>Seasons</h2>.+?)(<a href=.+?</a>)    # doesn't work 
```

这表示要查找`<a>`元素，但前提是它们前面有`<h2>Seasons</h2>`. 不幸的是，lookbehind 字符串必须是固定长度的。你不能把`.+?`一个lookbehind断言。所以这种方法已经过时了。

接下来是首先找到`<h2>`元素的位置，然后从那里开始执行正则表达式搜索。

```
>>> re.findall('<a href=.+?</a>', page[page.find('<h2>Seasons</h2>'):], re.DOTALL)
['<a href=http://www.111.com>111</a>', '<a href=http://www.222.com>222</a>', '<a href=http://www.333.com>333</a>'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:16:06.513

你应该使用像[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)这样的 html 解析器；会让你的生活轻松很多。

# ruby-on-rails - 是否可以判断环境是否已传递到 rake 任务块中？

> ID：13962818
> 
> 赞同：2
> 
> 时间：2012-12-19T23:13:03.757
> 
> 标签：ruby-on-rails

我有两个简单的 rake 任务——一个有效，一个抛出以下错误：

```
rake aborted!
undefined method `my_config_param' for #<Rails::Application::Configuration:0x007ffba6b2d320> 
```

以下是任务：

```
task :with_env => :environment do
  Rails.application.config.my_config_param #works
end

task :without_env do
  Rails.application.config.my_config_param #fails
end 
```

很清楚为什么`:without_env`会失败，我可以轻松地将我的调用包含`Rails.application.config`在 begin/rescue 语句中。但是我想知道是否有一种方法可以*先验地*判断环境是否丢失，以便我可以更优雅地解决这个问题。有没有这样的方法？我一直找不到一个......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T18:15:38.500

我的一位同事指出，`$rails_rake_task`如果加载了 rails env，则返回 true，否则返回 false。这成功了：

`Rails.application.config.my_config_param if $rails_rake_task`

# dynamic - 如何在adwords的clicktag上动态添加参数

> ID：13962821
> 
> 赞同：1
> 
> 时间：2012-12-19T23:13:23.467
> 
> 标签：dynamic, flash, google-ads-api

我试图在用户点击通过 AdWords 车辆的 Flash 横幅时添加一个动态跟踪参数。

我的创意有两个点击区域，我希望能够检测到哪一个被点击。

但据我所知，如果可能的话，谷歌并没有清楚地解释如何做到这一点。

# c# - 如何在同一视图中使用来自两个不同模型的两个 create ActionResult？

> ID：13962823
> 
> 赞同：3
> 
> 时间：2012-12-19T23:13:28.577
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我已经搜索了如何处理它，但到目前为止我一无所获。这是我的问题，我有一个帖子模型和一个评论模型。我的 CreateView 具有创建帖子的输入，并且它也显示在此创建视图中。让我们看看代码：

**EDIT2：在我的 PostController 中添加 CreateComment 操作结果；& 我的部分 ListPost 视图中的 ActionLink**

*现在我可以看到我添加评论的链接，它将我发送到我的 CreateComment 视图中，但是当我尝试将它保存在我的数据库中时，我遇到了这个错误：*

> INSERT 语句与 FOREIGN KEY 约束 \"FK_dbo.Comments_dbo.Posts_PostId\" 冲突。数据库 \Myproject"、表 \"dbo.Posts\"、列 'PostId' 中发生冲突。\r\n语句已终止。"

后控制器

```
 public ActionResult ListPost()
        {
            var post = db.Posts.ToList();
            return PartialView("ListPost", post);
        }

        public ActionResult Create()
        {
            return View(); 
        }

        [HttpPost]
        public ActionResult Create(FormCollection values)
        {
            var post = new Post();
            TryUpdateModel(post);

            if (ModelState.IsValid)
            {
                var context = new UsersContext();
                var username = User.Identity.Name;
                var user = context.UserProfiles.SingleOrDefault(u => u.UserName == username);
                var userid = user.UserId;                

                post.UserId = userid;
                post.Date = DateTime.Now;

                db.Posts.Add(post);
                db.SaveChanges();
                return RedirectToAction("Create", "Post"); 
            }
            return View(post);
        }

    public ActionResult CreateComment()
    {
        ViewBag.PostId = new SelectList(db.Posts, "PostId", "Content");
        return View("CreateComment");
    }

    [HttpPost]
    public ActionResult CreateComment(FormCollection values)
    {
        var comment = new Comment();
        TryUpdateModel(comment);

        if (ModelState.IsValid)
        {
            var context = new UsersContext();
            var username = User.Identity.Name;
            var user = context.UserProfiles.SingleOrDefault(u => u.UserName == username);
            var userid = user.UserId;

            comment.UserId = userid;
            comment.Date = DateTime.Now;

            db.Comments.Add(comment);
            db.SaveChanges();
            return RedirectToAction("Create", "Post");
        }
        ViewBag.PostId = new SelectList(db.Posts, "PostId", "Content", comment.PostId);
        return View(comment);
    } 
```

创建视图：

```
@model Myproject.Models.Post

@using (Html.BeginForm("Create", "Post", FormMethod.Post))
{  
        <legend>Add Post</legend>

        <div class="editor-field">
            @Html.EditorFor(model => model.Content)
            @Html.ValidationMessageFor(model => model.Content)
            <input type="file" name="Photo" id="Photo"/>
        </div>   

        <p>
            <input type="submit" value="Post" />
        </p> 
}

@{Html.RenderAction("ListPost", "Post");} 
```

列表帖子视图

```
 @model IEnumerable<MyProject.Models.Post>

    @foreach (var item in Model.OrderByDescending(x => x.Date))
    {
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Content)
            </td>
        </tr>
        <tr>
            <td>
                @Html.DisplayFor(modelItem => item.Date)
            <span>@Html.DisplayFor(modelItem => item.Users.UserName)</span>    
            </td>
        </tr>

    <tr>
       <td> @Html.ActionLink("Add Comment", "CreateComment", new {id=item.PostId})</td>      
    </tr>
 } 
```

现在，我想在帖子中添加评论。我的评论模型（和表）有一个 postId 属性。如何将我的 createCommentView 包含在我的 ListPost 视图中，我认为我必须将它包含在此视图中而不是我的 CreatePostView 中，但我也不确定。在这两种情况下，我都不知道该怎么做，因为我在同一个视图中使用了评论模型和帖子模型......

有什么想法，可以发给我的链接，还是什么？谢谢，对不起我的英语不好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T08:58:13.133

```
@Html.ActionLink("Add Comment", "CreateComments", new { id=item.PostId }) 
```

确保将 PostId 作为属性传递给您的模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T23:51:47.070

使用 Niraj 的 awnser 并添加下面指定的三行，它可以正常工作

```
 [HttpPost]
    public ActionResult CreateComment(FormCollection values, int id)
    {
        var comment = new Comment();
        TryUpdateModel(comment);

        /** ADD THIS LINE **/
        Post post = db.Posts.Find(id);

        if (ModelState.IsValid)
        {
            var context = new UsersContext();
            var username = User.Identity.Name;
            var user = context.UserProfiles.SingleOrDefault(u => u.UserName == username);
            var userid = user.UserId;

            comment.UserId = userid;
            comment.Date = DateTime.Now;

            /***  ADD THIS TWO LINES ***/
            comment.Post = post;
            comment.PostId = post.PostId;

            db.Comments.Add(comment);
            db.SaveChanges();
            return RedirectToAction("Create", "Post");
        }            
        ViewBag.PostId = new SelectList(db.Posts, "PostId", "Content", comment.PostId);
        return View(comment);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-01T18:34:06.330

createCommentView 应该是部分视图，它将在 ListPost 视图的 html 下方使用，向该部分视图传递帖子 ID。在部分视图中，在 Html.BeginForm("Comment", "CreateComment", FormMethod.Post) 和将评论传递给新操作 CreateComment

部分视图就像

```
@model Comment //comment class has post id and comment text

@using (Html.BeginForm("Comment", "CreateComment", FormMethod.Post))
{  
        <legend>Add Post</legend>

        <div class="editor-field">
            @Html.EditorFor(model => model.Comment)
            @Html.EditorFor(model => model.PostId)
        </div>   

        <p>
            <input type="submit" value="Post" />
        </p> 
} 
```

现在在您的列表帖子视图中使用这个

```
@Html.Partial("CommentView", new Comment(){PostId=item.PostId}) 
```

# javascript - 使用jQuery根据无序列表选择选择选项

> ID：13962824
> 
> 赞同：6
> 
> 时间：2012-12-19T23:13:30.833
> 
> 标签：javascript, jquery, html, html-lists, selection

我已将无序列表转换为选择选项列表，但是我不确定如何使“选择”属性添加与列表中相同超链接相关的选项。

加价

```
<div class="navigation">
    <ul>
         <li><a href="foo.html">Foo</a></li>
         <li><a href="bar.html" class="selected">Bar</a></li>
         <li><a href="boo.html">Boo</a></li>
    </ul>
</div> 
```

Javascript

```
$('<select />').appendTo('.navigation');

// Populate dropdown with menu items
$('.navigation ul a').each(function() {
 var el = $(this);
 $('<option />', {
    "value"   : el.attr('href'),
    "text"    : el.text()
 }).appendTo('.navigation select');
});
// Navigate to page on select option
$('.navigation select').change(function() {
  window.location = $(this).find('option:selected').val();
});
// Hide navigation list
$('.navigation ul').hide(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T23:17:41.540

您可以使用`hasClass`方法：

```
 $('<option />', {
    "value"      : el.attr('href'),
    "text"       : el.text(),
    "selected"   : el.hasClass('selected')
 }).appendTo('.navigation select'); 
```

[http://jsfiddle.net/5V5rY/](http://jsfiddle.net/5V5rY/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-19T23:15:26.820

您似乎动态地创建了 select 元素。

因此，您需要**将事件委托**给`closest static parent`容器以使其工作..

```
$('.navigation select').change(function() { 
```

应该是

```
$('.navigation').on('change', 'select',function() { 
```

还要选择你可以做的值`.val();`

```
window.location = $(this).val(); 
```

# java - 如何禁止 JPanel 在 Java 中执行任何操作

> ID：13962831
> 
> 赞同：1
> 
> 时间：2012-12-19T23:14:00.010
> 
> 标签：java, swing, jpanel, frame

我在禁用 JPanel 以使其内部调用任何方法时遇到问题。我设置了一个带有 2 个 JPanel 的框架来控制框架的图形。问题是，如果我在 Frame 中添加了一个新的 JPanel，并且我还删除了以前存在的旧 JPanel，那么旧 JPanel 中的绘制方法仍然会被调用。

这是我用来测试的代码：

开始类：

```
 import java.awt.Frame;
    import java.awt.event.KeyEvent;
    import java.awt.event.KeyListener;
    import java.awt.event.WindowEvent;
    import java.awt.event.WindowListener;

    public class Start implements WindowListener, KeyListener{
        public static void main(String[] args) {
            new Start();
        }

        Frame frame = new Frame("Frame");

        TestPanel P1 = new TestPanel();
        TestPanel P2 = new TestPanel();

        static boolean active = true;

        public Start() {
            frame.setSize(500,500);
            frame.setLocationRelativeTo(null);
            frame.addWindowListener(this);
            frame.addKeyListener(this);
            frame.setVisible(true);
            frame.add(P1);
            for (Object c : frame.getComponents()){
                System.out.println(c.toString());
            }
        }

        @Override
        public void keyPressed(KeyEvent e) {
            if (active){
                frame.remove(P1);
                    frame.add(P2);
            }else{
                frame.remove(P2);
                frame.add(P1);
            }
            active = !active;
            for (Object c : frame.getComponents()){
                System.out.println(c.toString());
            }
        }

        @Override
        public void windowClosing(WindowEvent e) {
            System.exit(0);
        }

        public void windowOpened(WindowEvent e) {}
        public void windowClosed(WindowEvent e) {}
        public void windowIconified(WindowEvent e) {}
        public void windowDeiconified(WindowEvent e) {}
        public void windowActivated(WindowEvent e) {}
        public void windowDeactivated(WindowEvent e) {}
        public void keyTyped(KeyEvent e) {}
        public void keyReleased(KeyEvent e) {}
    } 
```

测试面板类：

```
 import java.awt.Graphics;
    import javax.swing.JPanel;

    public class TestPanel extends JPanel{
        boolean active = Start.active;

        @Override
        public void paint(Graphics g) {
            System.out.println(active);
        }
    } 
```

这个程序总是打印“真”，告诉我只有对象 P1 处于活动状态，而 P2 什么也不做，即使它显示在屏幕上。

所以我要问的是如何让 P1 对象在它不在屏幕上时停止调用绘制方法，并让 P2 对象在显示时调用它的绘制方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:30:57.743

让我们从

```
TestPanel P1 = new TestPanel();
TestPanel P2 = new TestPanel(); 
```

`P1`并且`P2`是同一类的单独实例。

看着

```
static boolean active = true; 
```

和

```
// From TestPane
public void paint(Graphics g) {
    System.out.println(active);
} 
```

因此，无论屏幕上的哪个面板，它都会始终显示任何值`active`。

您没有提供任何方法来实际识别对象的不同实例，那么，您怎么知道`P1`实际开始调用？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:40:57.280

每个面板中的局部变量“活动”不是参考，而是原始变量。它的值设置为创建面板时在“开始”类中设置的任何静态值。对于两个 Panel 实例，您显示的代码中的哪个都是“真”。这解释了为什么您的代码总是打印“true”。

至于显示问题，请注意删除功能的 JavaDoc：

> 注意：如果组件已从已显示的容器中删除，则必须在该容器上调用 validate() 以反映更改。如果要删除多个组件，您可以通过在所有组件都已删除后仅调用一次 validate() 来提高效率。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T23:44:35.157

可能是因为 Frame 的 remove 方法是针对 MenuComponent 的。[http://docs.oracle.com/javase/6/docs/api/java/awt/Frame.html#remove%28java.awt.MenuComponent%29](http://docs.oracle.com/javase/6/docs/api/java/awt/Frame.html#remove%28java.awt.MenuComponent%29) ...正确的方法是使用 frame.getContentPane 添加组件().add(P1)。尝试使用 frame.getContentPane().remove(P1) 看看它是否有效。

# c++ - 指针或堆对象的二维数组

> ID：13962832
> 
> 赞同：2
> 
> 时间：2012-12-19T23:14:10.370
> 
> 标签：c++, arrays, memory-management

我有一个有网格的游戏，它是一个二维数组。这个数组填充了一个信息结构。

```
struct GridCell
{
    uint mCellID;
    Vector2 mPosition;
    uint mLevel;
    int mCellType;
};

class Grid
{
public:
    Grid();
    ~Grid()

protected:
    // Heap
    GridCell[][] mGridCells;

    // Dynamic
    GridCell*[][] mGridCells;
}; 
```

请记住，内存中可以同时存在许多网格，并且这些网格单元的范围可以从非常小到非常大：这更适合作为网格单元堆还是动态（指针）网格单元？

据我了解：堆单元将占用大量内存动态单元仍然会，但它将是指针，而不是整个结构。但是，这会导致内存碎片化吗？

我不确定哪一个最适合这种情况，而且我可能也不完全理解两者之间的区别。帮助？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:21:58.560

C++ 中的类型具有固定的大小。您`GridCell`的 s 范围从非常小到非常大是不正确的。他们将是其中之一。`sizeof(GridCell)`是固定的。它们可能每个都指向不同大小的对象，但这些对象不属于`GridCell`.

无论哪种方式，您提出的两种方法都将在内存中具有完全相同数量的`GridCell`s，因此使用指针不会保存任何内容。事实上，动态分配的方法将使用更多内存，因为您还存储了指向每个单元格的指针。指针方法可以提高内存效率的唯一方法是，如果您使用单个`GridCell`对象来表示`Grid`. 也就是说，一些指针将是相同的。

这真正归结为哪个更易于管理，答案始终是“没有指针的方法”。这意味着您的`Grid`对象将自动管理`GridCell`s 的构造和销毁，而无需您关心它，从而帮助您避免内存泄漏。如果使用指针方法，则必须在 的构造函数中循环遍历数组`Grid`，`new GridCell()`对每个元素执行此操作。您还需要在析构函数中执行相同的操作，在`delete`您动态分配的每个单元格上执行此操作。这是一种痛苦，尤其是在不必要的时候。

在需要指针的情况下*，*智能指针更可取。

此外，对于固定大小的数组，您甚至可能会更好`std::array<std::array<GridCell, N> M>`。它为您封装了数组，允许您像使用标准库中的任何其他 Container 一样使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T23:21:26.717

最好都不使用而使用 std::vector。将您的二维数组设为 1d 并将值直接存储到向量中。或者，如果你真的必须有二维，你可以创建一个向量向量。

# php - Drupal：无法搜索Feed模块导入的项目

> ID：13962833
> 
> 赞同：0
> 
> 时间：2012-12-19T23:14:22.930
> 
> 标签：php, drupal, import, content-management-system, drupal-feeds

我已经使用 Feeds 模块从从 csv 文件导入到我的 drupal 站点的数据创建了节点。
导入成功，我什至可以在视图和内容中看到。
但是，当我尝试使用默认的 drupal 搜索或视图的公开过滤器进行搜索时，只会返回一些导入的项目。
什么可以让我从 Feeds 模块导入的项目中返回我正在搜索的内容？
如果我的内容是日文，drupal 网站是英文，会不会影响搜索？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T00:26:34.673

我真的不能说语言是否是一个问题。带有过滤器的视图不会返回任何内容的原因主要是因为缺少数据或由于过滤器排除了节点。

对于搜索，您必须运行 cron 才能对数据进行索引。核心搜索只能找到索引数据。您可以从状态页面运行 cron，在搜索设置页面上您可以看到搜索索引的状态。当索引为 100% 时，应在搜索中找到所有节点。

Drupal 7：
[http ://www.example.com/admin/reports/status](http://www.example.com/admin/reports/status)
[http://www.example.com/admin/config/search/settings](http://www.example.com/admin/config/search/settings)

Drupal 6：
[http ://www.example.com/admin/reports/status](http://www.example.com/admin/reports/status)
[http://www.example.com/admin/settings/search](http://www.example.com/admin/settings/search)

# android - Android自定义布局重力

> ID：13962835
> 
> 赞同：4
> 
> 时间：2012-12-19T23:14:49.827
> 
> 标签：android, android-layout, gravity

我正在尝试编写自己的布局类，将它的子级放置在常规网格中。布局本身工作得很好，但我无法让这个布局内的按钮上的文本居中。当我在 LinearLayout 中放置相同的按钮时，按钮文本会根据需要居中，因此故障可能在我的布局中。但是我的布局如何影响文本在其子视图上的重力？我怀疑它与布局参数有关，但我还不知道它是如何工作的。

以下是一些可能与问题相关的代码片段：

我的布局类WeightedGridLayout：

```
public class WeightedGridLayout extends ViewGroup {

// ...

@Override
protected void onLayout(boolean changed, int left, int top, int right, int bottom) {
    for (int i = 0, N = getChildCount(); i < N; i++) {
        View c = getChildAt(i);     
        // ...
        // do some calculation
        //
        c.layout( childLeft, childTop, childRight, childBottom );
    }       
}

public static class LayoutParams extends ViewGroup.MarginLayoutParams  {
    public Position position = position( 0, 0 );
    public Span span = span( 1, 1 );
    // Position and Span are local classes which are irrelevant here

public LayoutParams( Position position, Span span ) {
    super(FILL_PARENT, FILL_PARENT);
    this.position = position;
    this.span = span;
}
public LayoutParams( Position position ) {
    this( position, span(1,1) );
}
public LayoutParams() {
    this( position(0,0), span(1,1) );
}
public LayoutParams(MarginLayoutParams params) {
    super(params);
}
public LayoutParams(LayoutParams that) {
    super(that);
    this.position = that.position;
    this.span = that.span;
}
public LayoutParams(Context context, AttributeSet attrs) {
    super(context, attrs);
}

} 
```

该类的使用方式如下：

```
 WeightedGridLayout grid = (WeightedGridLayout) findViewById(R.id.mainMenu);
  LayoutInflater inflater = getLayoutInflater();
  Button button = (Button)inflater.inflate(R.layout.buttonproperties, null);
  button.setText( "None" );
  WeightedGridLayout.Position pos = WeightedGridLayout.position(colIdx,rowIdx);
  WeightedGridLayout.LayoutParams lp = new WeightedGridLayout.LayoutParams(pos);
  lp.setMargins(5,20,5,20);         
  grid.addView(button, lp ); 
```

以下是按钮的属性：

```
<Button xmlns:android="http://schemas.android.com/apk/res/android"
    android:background="@drawable/default_button"
    android:gravity="center"
    android:textSize="@dimen/text"
    android:textColor="@color/text" >
</Button> 
```

按钮文本显示在按钮的顶部，而不是应有的中心。为了使文本居中，我必须做什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T22:01:44.150

好的，我发现了问题：我未能覆盖 onMeasure()。只有当 onMeasure() 在某个时候调用函数 measure() 时，子视图的布局才会起作用。这是一个很好的工作示例[http://www.arpitonline.com/blog/2012/07/01/creating-custom-layouts-for-android/](http://www.arpitonline.com/blog/2012/07/01/creating-custom-layouts-for-android/)。我只是希望自定义布局的官方文档能提到这一点。

# python - 使用python xlrd将日期读取为字符串而不是从excel中浮动

> ID：13962837
> 
> 赞同：24
> 
> 时间：2012-12-19T23:14:55.270
> 
> 标签：python, xlrd

> **可能重复：**
> [如何在 Python 中读取 Excel 格式的日期？](https://stackoverflow.com/questions/1108428/how-do-i-read-a-date-in-excel-format-in-python)

我的日期可以在 excel 文件中的任何字段中，但是当我使用 python xlrd 读取它时，它被读取为浮点数。有没有办法将所有 excel 单元格读取为字符串？

我想准备一个脚本来生成一个文件，该文件具有由管道分隔的 excel 文件中的所有值，但是这个日期的东西正在产生问题。

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2012-12-19T23:31:28.553

Excel 将日期存储为浮点数。如果你想转换它们，`xlrd`有一个函数可以帮助你：[xldate_as_tuple](http://www.lexicon.net/sjmachin/xlrd.html#xlrd.xldate_as_tuple-function)

一个例子：

```
import datetime, xlrd
book = xlrd.open_workbook("myfile.xls")
sh = book.sheet_by_index(0)
a1 = sh.cell_value(rowx=0, colx=0)
a1_as_datetime = datetime.datetime(*xlrd.xldate_as_tuple(a1, book.datemode))
print 'datetime: %s' % a1_as_datetime 
```

# javascript - 与 canvas.getImageData 泄漏？

> ID：13962849
> 
> 赞同：1
> 
> 时间：2012-12-19T23:15:43.337
> 
> 标签：javascript, html, canvas

已经有一个[类似](https://stackoverflow.com/questions/7638007/javascript-memory-leak-with-html5-getimagedata)的问题，但问题已解决，因为不是由于 getImageData 本身。这绝对是 getImageData 的问题，否则我严重误解了某些东西。

以下代码在 Chrome 23.0 (Linux) 中每秒消耗大约半兆内存，并且在 Firefox 上也会泄漏，尽管速度较慢。分配给局部或全局变量没有帮助。

我错过了什么吗？这是一个错误吗？

```
<html>
<head>
<script>
function tick() {
    document.getElementById("canvas1").getContext('2d').getImageData(0, 0, 300, 150);
}
setInterval(tick, 10);
</script>
</head>
<body>
<canvas id="canvas1" />
</body>
</html> 
```

# c# - IBindingList 数据的正确过滤语法是什么？

> ID：13962854
> 
> 赞同：-1
> 
> 时间：2012-12-19T23:16:46.483
> 
> 标签：c#, filter, datatable

我的应用程序中有一个表，我为它设计了一个过滤器。过滤器适用于数值数据，但不适用于文本数据。我的表中有一个文本列，其中包含州缩写（PA、LA、TX ...）。但是当我添加一个过滤器（参见下面的代码）时，我收到“无法解释令牌'！'”的错误。有任何想法吗？谢谢您的帮助

```
F="State != 'PA'";
IBindingListView D.filter=F; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:23:33.400

您可以在[此处](http://msdn.microsoft.com/en-us/library/system.data.datacolumn.expression.aspx)找到说明。`"State <> 'PA'"`并且`"NOT(State = 'PA')"`应该为您工作。

# php - 使用 PHP 将 MySQL 表导出为 CSV 的未定义错误

> ID：13962855
> 
> 赞同：0
> 
> 时间：2012-12-19T23:16:47.470
> 
> 标签：php, mysql, csv

我正在使用从旧帖子中找到的这个片段将 MySQL 表下载到 CSV。它可以很好地下载 CSV，但我总是收到“未定义”错误，而我的浏览器窗口中没有显示其他详细信息。CSV 文件不包含与文本混合的任何有关错误的数据。任何有关我的错误的帮助将不胜感激。

我试过测试我的 SQL 语句，效果很好。

```
$result = mysql_query("SELECT * FROM employees");
if (!$result) die('Couldn\'t fetch records');
$num_fields = mysql_num_fields($result);
$headers = array();
for ($i = 0; $i < $num_fields; $i++) {
    $headers[] = mysql_field_name($result , $i);
}
$fp = fopen('php://output', 'w');
if ($fp && $result) {
    header('Content-Type: text/csv');
    header('Content-Disposition: attachment; filename="employeelist.csv"');
    header('Pragma: no-cache');
    header('Expires: 0');
    fputcsv($fp, $headers);
    while ($row = mysql_fetch_assoc($result)) {
        fputcsv($fp, array_values($row));
    }
    die();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T00:01:45.160

很抱歉最初的问题，但我想这与我的代码无关。我想我发现了我的问题。

该页面是从 JQuery mobile 链接的，即使它是一个标准的 HTML 页面。由于 JQuery mobile 的页面转换，我认为这是导致消息的原因。很抱歉没有考虑到这一点。我不认为这是一个相关的细节。感谢您的所有建议。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-19T23:25:01.827

尝试将您的“死亡”条件更改为：

```
if (!$result) die( echo mysql_error() ); 
```

这至少会为您提供一些信息。在那之后你可能有更多的故障排除，但你必须从某个地方开始，这就是开始。

第 2 步故障排除：`print_r( $headers )`在第一个`for`循环之后立即使用

`while`故障排除的第 3 步：如果第一步都没有显示任何有用的信息，则开始在循环中打印调试输出。例如，`print_r( array_values( $row ) )`在该循环内部使用类似的东西。

我的原始帖子应该更清楚地说明这是故障排除的第一步，因为除了运行代码之外，您没有提供任何关于您在尝试排除故障时所做的任何信息。

# c++ - MinGW 4.7.2 的 Qt 应用程序分段错误

> ID：13962857
> 
> 赞同：4
> 
> 时间：2012-12-19T23:17:02.133
> 
> 标签：c++, qt, qt4, mingw

使用 MinGW 4.7.2 每个编译的 Qt 4 应用程序都会崩溃——甚至是之前运行的程序。

*   **明威：** 4.7.2
*   **QT：** 4.8.3
*   **使用的库：**
    *   QtCore4.dll
    *   QtCored4.dll
    *   QtGui4.dll *（用于 gui）*
    *   QtGuid4.dll *（用于 gui）*

以简单程序为例：

```
#include <QtGui/QApplication>

int main(int argc, char *argv[])
{
    QApplication app(argc, argv); /* Crash here */

    return app.exec();
} 
```

**崩溃：** *收到信号：SIGSEGV（分段错误）*

**调用堆栈：**

```
ZN23QCoreApplicationPrivate27processCommandLineArgumentsEv+68: mov    (%edx,%esi,1),%eax
ZN16QCoreApplication4initEv+88: lea    -0x8(%ebp),%esp
ZN16QCoreApplicationC2ER23QCoreApplicationPrivate+47: add    $0x24,%esp
ZN12QApplicationC1ERiPPci+75: movl   $0x67ef2768,(%ebx)
QApplication app(argc, argv);
[...] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T23:29:26.797

您将需要 MinGW 4.4。要使用 MinGW 4.7.2，您需要自己编译 Qt。崩溃是由于 MinGW 版本之间的 ABI 不兼容造成的。

请参阅如何构建 Qt：

[http://qt-project.org/wiki/Building_Qt_Desktop_for_Windows_with_MinGW](http://qt-project.org/wiki/Building_Qt_Desktop_for_Windows_with_MinGW)

一般来说，在下载 Qt 时，请注意它所构建的 MinGW 版本。如果您想使用自己的 MinGW 安装，它需要与构建 Qt 时使用的版本相同。

# java - 如何为文本文件单独写一行

> ID：13962861
> 
> 赞同：3
> 
> 时间：2012-12-19T23:17:10.153
> 
> 标签：java, android

所以当我使用我写入我的文本文件时，`FileOutputSstream`我同时使用了

```
fos.write(("0"+"\n").getBytes()); 
```

和

```
fos.write(System.getProperty("line.separator").getBytes()); 
```

而且它们都不起作用...它们仍然在同一行上打印...

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T03:52:44.483

好的，所以我想通了...由于某种原因，当我在这里尝试每个示例时，唯一有效的是 ps.print("one\r\n"); 这真的很奇怪，因为我知道它为什么起作用，但它确实......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:24:38.263

使用 PrintStream

System.out 例如是一个 PrintStream。

你说你有一个 FileOutputStream。然后，

```
FileOutputStream f = new FileOutputStream("test.txt");
PrintStream ps = new PrintStream(f);
ps.print("line1");
ps.println(); //this writes your new line
ps.print("line2");
ps.close(); 
```

你也可以使用；

```
BufferedWriter fos = new BufferedWriter(new OutputStreamWriter(new FileOutputStream(filename)));
      fos.write("<?xml version=\"1.0\" encoding=\"UTF-8\"?>");
      fos.newLine(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T23:43:54.977

每个平台的换行符都不同。对于 unix 系统（MacOS X、Linux、...和 ​​Android，因为它使用修改后的 linux 内核），行分隔符是`0x0A`; 对于 MS Windows，它有两个字节长`0x0D,0x0A`：对于老式 MacOS，它是`0x0D`.

这意味着由Android编写的Android换行符在被Notepad.exe等特别愚蠢的Windows程序打开时将不可见。更智能的程序（例如编程编辑器或 IDE）将毫无问题地显示它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-07T09:56:21.527

您可以使用 println 方法

```
PrintStream ps=new PrintStream(new FileOutputStream("outputPath"));
for(String line:lines)
    ps.println(line); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T23:33:15.903

用这个：

```
public  byte[] newLine() {
    byte[] temp = new byte[2];
    temp[0] = 13;
    temp[1] = 10;
    return temp;
} 
```

只需将其写入您的 FileOutputStream。像这样：

```
 FileOutputStream.write(newLine()); 
```

这将简单地写入字节：13 和 10。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-12-19T23:26:03.543

您必须像这样附加行分隔符/中断。

尝试

```
String separator = System.getProperty("line.separator");
    fos.append(seperator); 
```

# mysql - 如何计算最接近 100 的平均数？

> ID：13962862
> 
> 赞同：6
> 
> 时间：2012-12-19T23:17:10.887
> 
> 标签：mysql

我有一个 MySQL 表，其中有一个数字列表，这些数字来自一个游戏，用户必须单击一个按钮才能接近 100。

我以为我会使用`AVG()`，但这显然行不通，因为当您有 0 和 200 时，看起来好像您获得了完美的 100。

我需要的是每一轮（有 10 个）计算这个数字离 100 有多远，然后数一下。

```
Example:
User A: 98 + 102 + 102 = 6 (something) Loser!
User B: 95 + 100 + 100 = 5 (something) Winner! 
```

我有什么，但显然有缺陷：

```
SELECT user_id, AVG(score) AS Average, (100-AVG(score)) AS Difference, 
DATE(playtime) AS Playdate 
FROM playtable
GROUP BY user_id, DATE(playtime) 
ORDER BY Playdate DESC, user_id 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T23:21:36.750

这应该这样做

```
SELECT user_id, SUM( ABS(100-score) ) as cumulative_error,
  DATE(playtime) AS Playdate 
FROM playtable
GROUP BY user_id, DATE(playtime) 
ORDER BY Playdate DESC, user_id 
```

累积误差将包含累积的差值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:20:48.787

您可以修复您的查询以返回绝对值，以查看分数与给定值的距离（在您的情况下为 100）

```
SELECT user_id, AVG(score) AS Average, SUM(ABS(100 - score)) AS Difference, 
DATE(playtime) AS Playdate 
FROM playtable
GROUP BY user_id, DATE(playtime) 
ORDER BY Playdate DESC, user_id 
```

# asp.net - 在 asp.net 中使用没有回发的自定义验证器

> ID：13962864
> 
> 赞同：0
> 
> 时间：2012-12-19T23:17:23.350
> 
> 标签：asp.net, postback, custom-validators, server-side-validation

我在我的一个 Web 表单上使用自定义验证器，要求是检查数据库中的 bookcode，如果它存在，那么它应该显示消息，现在我正在使用自定义验证器，我想要的是，它如果自定义验证器返回 false，则不应回发，而是应该像普通验证器一样工作并显示消息，我正在为自定义验证器使用服务器端验证。我的代码在这里。

```
HTML Markup
<asp:TextBox ID="BookCode" runat="server" CssClass="textEntry"></asp:TextBox>

<asp:CustomValidator ID="BookCodeCustomValidator" runat="server" ControlToValidate="BookCode" CssClass="failureNotification fr"
                Display="Dynamic" ErrorMessage="Book already exists (Book Code should be unique)." OnServerValidate="ServerValidation"
                ToolTip="Book already exists (Book Code should be unique)." ValidationGroup="AddFacBookValidationGroup"></asp:CustomValidator> 
```

这是我背后的代码

```
 protected void ServerValidation(object sender, ServerValidateEventArgs e)
    {
        objAddBooks.LibraryInfo = Transactions.LibraryFields.Bookcode;
        objAddBooks.Criteria = BookCode.Text;
        e.IsValid = (objAddBooks.BookExists) ? false : true;
    } 
```

# java - 使用标准 java.sql.Connection 关闭 apache derby 连接

> ID：13962871
> 
> 赞同：3
> 
> 时间：2012-12-19T23:18:43.850
> 
> 标签：java, jdbc, derby

我目前正在开发一个可用于不同数据库的程序（目前我正在使用嵌入式 Derby 和 MySQL 进行测试）。

是否可以在不使用特定于 derby 的东西的情况下从我的应用程序中释放 Derby 数据库（让另一个进程使用它）？我知道这可以通过附加`shutdown=true`到 jdbc url 来完成，但这是我想避免的。我试过了，`connection.close()`但没有用。

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:42:50.960

如果您需要多个进程来访问您的 Derby 数据库，您应该停止使用嵌入式版本并转而使用[Derby Network Server](http://db.apache.org/derby/papers/DerbyTut/ns_intro.html)。这将启动 Derby，因此可以以熟悉的客户端/服务器方式访问它。在这种模式下，可以通过多个同时连接访问 Derby。这类似于你已经准备好用 MySQL 做的事情。

# apache - xampp 上带有烧瓶的脚本头 wsgi 过早结束

> ID：13962879
> 
> 赞同：1
> 
> 时间：2012-12-19T23:19:27.280
> 
> 标签：apache, xampp, flask, mod-wsgi, wsgi

我正在尝试在通过 xampp 运行的 apache 服务器上运行带有 mod_wsgi 的烧瓶应用程序。我已经尝试阅读所有已经提出的问题并浏览了 wsgi 的 wiki，但我似乎仍然无法找到我收到此错误的原因。我在使用 python 2.6.6 我的 httpd.conf 的 debian 6 上：

```
WSGIDaemonProcess debug_tool user=spyglass group=root threads=5
WSGIScriptAlias /debug_tool /opt/lampp/htdocs/spyglass_v2/debug_tool/debug_tool.wsgi
<Directory /opt/lampp/htdocs/spyglass_v2/debug_tool>
  WSGIProcessGroup debug_tool
  WSGIApplicationGroup %{GLOBAL}
  Order deny,allow
  Allow from all
</Directory> 
```

我的 debug_tool.wsgi：

```
import sys
sys.path.insert(0,"/opt/lampp/htdocs/spyglass_v2/debug_tool/")
from debug_tool import app as application 
```

我的 debug_tool 文件夹如下所示：

```
ls -rtl
total 32
drwxr-xr-x 2 root     root 4096 Dec 18 19:36 uploads
drwxr-xr-x 2 root     root 4096 Dec 18 19:36 Testing_Paramerters
drwxr-xr-x 2 root     root 4096 Dec 18 19:36 templates
-rw-r--r-- 1 root     root 4688 Dec 19 14:42 debug_tool.py
-rw-r--r-- 1 spyglass root 3859 Dec 19 14:43 debug_tool.pyc
-rw-r--r-- 1 spyglass root  118 Dec 19 15:17 debug_tool.wsgi 
```

我的 deubg_tool.py 看起来像这样：

```
import os
import re
from flask import Flask, request, redirect, url_for, render_template

app = Flask(__name__)
app.debug = True

@app.route('/',methods=['GET'])
def hello_world():

return 'hello world' 
```

你知道有什么问题吗？

**更新：**

当我尝试导入烧瓶时，我明白了。这意味着什么？

错误日志：

[Thu Dec 20 12:09:49 2012] [error] [client 172.20.31.135] 脚本头过早结束：debug_tool.wsgi [Thu Dec 20 12:09:49 2012] [notice] child pid 20206 exit signal Segmentation fault (11)

并且 python 脚本在实际文件中正确缩进。它可以很好地导入 re 和 os，但是一旦我尝试导入烧瓶，我就会收到该错误

我查看了我的 httpd.conf 文件，我正在加载 mod_php5。是否可以同时运行？我去了 [http://code.google.com/p/modwsgi/wiki/ConfigurationGuidelines#The_Apache_Alias_Directive](http://code.google.com/p/modwsgi/wiki/ConfigurationGuidelines#The_Apache_Alias_Directive) 但无法弄清楚如何运行这两个模块。

我的总体目标是使用 mod_wsgi 将此工具添加到运行 mod_php5 的现有服务器中。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-30T16:10:46.120

根据我的经验，由于异常，脚本头的过早结束几乎总是堆栈跟踪。

由于您还没有足够大的项目来进行日志记录，因此我建议您将所有内容简单地包装在一个 try-except 打印到 stderr

```
 try:
  YOUR SCRIPT CONTENTS HERE
except Exception, ex:        
  import sys

  from traceback import format_list, extract_tb

  (extype, value, trace) = sys.exc_info()

  print >> sys.stderr, "%s:%s\n%s" % (extype, value, ''.join(format_list(extract_tb(trace)))) 

```

然后检查 apache 日志中的输出，这些输出可能位于

`/var/log/httpd/error_log`

# mysql - 在嵌套的 mysql 查询中计数

> ID：13962880
> 
> 赞同：2
> 
> 时间：2012-12-19T23:19:30.930
> 
> 标签：mysql, select, count

我有一个准备好的 MySQL 查询，如下所示。假设 team1（第一桌）的成员玩特定的“游戏”（“游戏”是 team1 的条目）也可以是 team2（第二桌）的成员。我想获得不属于 team2 成员的 team1 玩“游戏”的成员数量。但我不知道我哪里出错了，因为查询失败：

```
SELECT game, member 
FROM team2 
WHERE game = :game and member 
NOT IN (SELECT member FROM team1 WHERE game = :game) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:33:51.937

对sql来说有点模糊

尝试这个

```
 SELECT t2.game, t2.member 
   FROM team2 t2
    WHERE t2.game = :game 
   and t2.member 
     NOT IN (SELECT t1.member FROM team1 t1  WHERE t1.game = t2.game)
    order by t2.game 
```

看[**DEMO SQLFIDDLE**](http://sqlfiddle.com/#!2/7c890/2)

编辑：

如果这没有解决您的问题，（因为您没有说发生了什么）。只需分享您的整个代码以查看问题出在哪里。

# python - 将 Scrapy 的输出格式化为 XML

> ID：13962881
> 
> 赞同：5
> 
> 时间：2012-12-19T23:19:36.207
> 
> 标签：python, xml, web-scraping, web-crawler, scrapy

因此，当我将其导出为 XML 时，我试图将使用 Scrapy 从网站上抓取的数据导出为特定格式。

这是我希望我的 XML 的样子：

```
<?xml version="1.0" encoding="UTF-8"?>
<data>
  <row>
    <field1><![CDATA[Data Here]]></field1>
    <field2><![CDATA[Data Here]]></field2>
  </row>
</data> 
```

我正在使用以下命令运行我的抓取：

```
$ scrapy crawl my_scrap -o items.xml -t xml 
```

我得到的当前输出大致如下：

```
<?xml version="1.0" encoding="utf-8"?>
<items><item><field1><value>Data Here</value></field1><field2><value>Data Here</value></field2></item> 
```

如您所见，它正在添加`<value>`字段，我无法重命名根节点或项目节点。我知道我需要使用[XmlItemExporter](http://doc.scrapy.org/en/0.16/topics/exporters.html#xmlitemexporter)，但我不确定如何在我的项目中实现它。

我已尝试将其添加到`pipelines.py`此处[，](http://doc.scrapy.org/en/0.16/topics/exporters.html#using-item-exporters)但我总是以错误告终：

`AttributeError: 'CrawlerProcess' object has no attribute 'signals'`

有没有人知道在使用 ? 将数据导出到 XML 时如何重新格式化数据的示例`XmlItemExporter`？

**编辑：**

在我的模块中显示我的 XmlItemExporter `piplines.py`：

```
from scrapy import signals
from scrapy.contrib.exporter import XmlItemExporter

class XmlExportPipeline(object):

    def __init__(self):
        self.files = {}

    @classmethod
    def from_crawler(cls, crawler):
        pipeline = cls()
        crawler.signals.connect(pipeline.spider_opened, signals.spider_opened)
        crawler.signals.connect(pipeline.spider_closed, signals.spider_closed)
        return pipeline

    def spider_opened(self, spider):
        file = open('%s_products.xml' % spider.name, 'w+b')
        self.files[spider] = file
        self.exporter = XmlItemExporter(file)
        self.exporter.start_exporting()

    def spider_closed(self, spider):
        self.exporter.finish_exporting()
        file = self.files.pop(spider)
        file.close()

    def process_item(self, item, spider):
        self.exporter.export_item(item)
        return item 
```

**编辑（显示修改和追溯）：**

我修改了`spider_opened`功能：

```
 def spider_opened(self, spider):
        file = open('%s_products.xml' % spider.name, 'w+b')
        self.files[spider] = file
        self.exporter = XmlItemExporter(file, 'data', 'row')
        self.exporter.start_exporting() 
```

我得到的追溯是：

```
Traceback (most recent call last):
          File "/root/self_opportunity/venv/lib/python2.6/site-packages/twisted/internet/defer.py", line 551, in _runCallbacks
            current.result = callback(current.result, *args, **kw)
          File "/root/self_opportunity/venv/lib/python2.6/site-packages/scrapy/core/engine.py", line 265, in <lambda>
            spider=spider, reason=reason, spider_stats=self.crawler.stats.get_stats()))
          File "/root/self_opportunity/venv/lib/python2.6/site-packages/scrapy/signalmanager.py", line 23, in send_catch_log_deferred
            return signal.send_catch_log_deferred(*a, **kw)
          File "/root/self_opportunity/venv/lib/python2.6/site-packages/scrapy/utils/signal.py", line 53, in send_catch_log_deferred
            *arguments, **named)
        --- <exception caught here> ---
          File "/root/self_opportunity/venv/lib/python2.6/site-packages/twisted/internet/defer.py", line 134, in maybeDeferred
            result = f(*args, **kw)
          File "/root/self_opportunity/venv/lib/python2.6/site-packages/scrapy/xlib/pydispatch/robustapply.py", line 47, in robustApply
            return receiver(*arguments, **named)
          File "/root/self_opportunity/self_opportunity/pipelines.py", line 28, in spider_closed
            self.exporter.finish_exporting()
        exceptions.AttributeError: 'XmlExportPipeline' object has no attribute 'exporter' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-20T22:42:01.180

您`XmlItemExporter`只需提供所需节点的名称即可完成大部分您想要的操作：

```
XmlItemExporter(file, 'data', 'row') 
```

[请参阅文档](http://doc.scrapy.org/en/0.16/topics/exporters.html#xmlitemexporter)。

字段中的元素存在的问题`value`是因为这些字段不是标量值。如果 XmlItemExporter 遇到标量值，它只会输出`<fieldname>data</fieldname>`，但如果遇到可迭代值，它将像这样序列化`<fieldname><value>data1</value><value>data2</value></fieldname>`：解决方案是停止为您的项目发出非标量字段值。

如果您不愿意这样做，请子类化`XmlItemExporter`并覆盖其`_export_xml_field`方法以在项目值可迭代时执行您想要的操作。[这是代码，`XmlItemExporter`](https://github.com/scrapy/scrapy/blob/0.16/scrapy/contrib/exporter/__init__.py#L135)因此您可以查看实现。

# php - 测试来自 array_search 的结果

> ID：13962882
> 
> 赞同：1
> 
> 时间：2012-12-19T23:19:59.650
> 
> 标签：php, arrays

我正在处理由远程系统创作的 CSV。我不想假设他们不会更改他们提供的字段或顺序，所以我正在解析字段 CSV 中索引的标题行，并将它们映射到我可以用于查找和更新的数组中。

事情是我这样做的方式测试索引为零的错误：

```
foreach ($field_map_array as $local_field => $silverpop_field) {
    if ($idx = array_search($silverpop_field, $fields)) {
        $local_to_sp[$local_table][$local_field] = $idx;
    } // index found
} 
```

有什么更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:23:02.947

[`array_search`](http://php.net/manual/en/function.array-search.php)如果找到针，则返回一个整数，否则，请使用[/ 不完全相同的运算符](http://au.php.net/manual/en/language.operators.comparison.php)`FALSE`显式测试它：[`!==`](http://au.php.net/manual/en/language.operators.comparison.php)

```
foreach ($field_map_array as $local_field => $silverpop_field) {
    if (($idx = array_search($silverpop_field, $fields)) !== FALSE) {
        $local_to_sp[$local_table][$local_field] = $idx;
    } // index found
} 
```

以下是[手册](http://au.php.net/manual/en/language.operators.comparison.php)`!=`如何描述（不相等）和`!==`（不完全相同）（强调添加）之间的区别：

> **$a != $b 不等于 TRUE 如果在类型杂耍之后**$a 不等于 $b 。
> 
>  **$a !== $b 不一样 如果 $a 不等于 $b，或者**它们不是同一类型，则为 TRUE。****

 **您的代码的问题是`if(0)`被解释为`if(0 != FALSE)`. 类型杂耍让它将 FALSE 转换为整数 0，`0 != 0`显然是错误的。`!==`类型杂耍不会发生，所以是真的（因为`0 !== FALSE`它们不是同一类型）。

我建议尽可能使用`===`and ，因为它们更可预测，并且可预测的代码往往错误更少且更易于使用。`!==`**

# objective-c - 为什么dispatch_sync在自定义并发队列死锁

> ID：13962885
> 
> 赞同：12
> 
> 时间：2012-12-19T23:20:08.933
> 
> 标签：objective-c, ios, grand-central-dispatch

在自定义并发 dispatch_queue 上使用 dispatch_sync 时，我的应用程序出现间歇性死锁。我正在使用类似于[Mike Ash 的博客](http://www.mikeash.com/pyblog/friday-qa-2011-10-14-whats-new-in-gcd.html "迈克·阿什的博客")中描述的方法来支持并发读取访问，但 NSMutableDictionary 上的线程安全突变充当当前活动网络 RPC 请求的缓存。我的项目使用 ARC。

我创建队列：

```
dispatch_queue_t activeRequestsQueue = dispatch_queue_create("my.queue.name",
                                                DISPATCH_QUEUE_CONCURRENT); 
```

和可变字典

```
NSMutableDictionary *activeRequests = [[NSMutable dictionary alloc] init]; 
```

我像这样从队列中读取元素：

```
- (id)activeRequestForRpc: (RpcRequest *)rpc
{
    assert(![NSThread isMainThread]);
    NSString * key = [rpc getKey];
    __block id obj = nil;
    dispatch_sync(activeRequestsQueue, ^{
        obj = [activeRequests objectForKey: key];
    });
    return obj;
} 
```

我从缓存中添加和删除 RPC

```
- (void)addActiveRequest: (RpcRequest *)rpc
{
    NSString * key = [rpc getKey];
    dispatch_barrier_async(activeRequestsQueue, ^{
        [activeRequests setObject: rpc forKey: key];
    });
}

- (void)removeActiveRequest: (RpcRequest *)rpc
{
    NSString * key = [rpc getKey];
    dispatch_barrier_async(activeRequestsQueue, ^{
        [activeRequests removeObjectForKey:key];
    });
} 
```

当我一次发出大量网络请求时，我看到对 activeRequestForRpc 的调用出现死锁，这使我相信障碍块之一（添加或删除）未完成执行。我总是从后台线程调用 activeRequestForRpc，并且应用程序 UI 不会冻结，所以我认为它不必阻塞主线程，但我添加了 assert 语句以防万一。关于这种僵局如何发生的任何想法？

**更新：添加调用这些方法的代码**

我正在使用 AFNetworking 发出网络请求，并且我有一个 NSOperationQueue，我正在调度“检查缓存并可能从网络中获取资源”逻辑。我将把它称为 CheckCacheAndFetchFromNetworkOp。在该操作中，我调用 AFHTTPClient 的自定义子类来发出 RPC 请求。

```
// this is called from inside an NSOperation executing on an NSOperationQueue.
- (void) enqueueOperation: (MY_AFHTTPRequestOperation *) op {
    NSError *error = nil;
    if ([self activeRequestForRpc:op.netRequest.rpcRequest]) {
        error = [NSError errorWithDomain:kHttpRpcErrorDomain code:HttpRpcErrorDuplicate userInfo:nil];
    }
    // set the error on the op and cancels it so dependent ops can continue.
    [op setHttpRpcError:error];

    // Maybe enqueue the op
    if (!error) {
        [self addActiveRequest:op.netRequest.rpcRequest];
        [self enqueueHTTPRequestOperation:op];
    }
} 
```

MY_AFHTTRequestOperation 由 AFHTTPClient 实例构建，在我称之为`[self removeActiveRequest:netRequest.rpcRequest];`第一个操作的成功和失败完成块中。这些块由 AFNetworking 作为默认行为在主线程上执行。

我已经看到死锁发生在最后一个必须持有队列锁的障碍块是添加块和删除块的地方。

当系统产生更多线程来支持我的 NSOperationQueue 中的 CheckCacheAndFetchFromNetworkOp Ops 时，是否有可能，activeRequestsQueue 的优先级太低而无法调度？如果所有线程都被 CheckCacheAndFetchFromNetworkOps 阻塞以尝试从 activeRequests 字典中读取，并且 activeRequestsQueue 阻塞在无法执行的添加/删除屏障块上，这可能会导致死锁。

**更新**

通过将 NSOperationQueue 设置为 maxConcurrentOperation 计数为 1（或除默认 NSOperationQueueDefaultMaxConcurrentOperationCount 之外的任何合理值）来修复此问题。

基本上，我学到的教训是，您不应该在任何其他 dispatch_queue_t 或 NSOperationQueue 上使用默认最大操作计数等待的 NSOperationQueue，因为它可能会占用其他队列中的所有线程。

这就是正在发生的事情。

**queue** - NSOperationQueue 设置为默认的 NSDefaultMaxOperationCount 让系统确定要运行多少并发操作。

**op** - 在 queue1 上运行，并在读取后在 AFNetworking 队列上安排网络请求，以确保 RPC 不在 activeRequest 集中。

这是流程：

系统确定它可以支持 10 个并发线程（实际上它更像是 80 个）。

一次安排 10 个操作。该系统允许 10 个操作在其 10 个线程上同时运行。所有 10 个操作都调用 hasActiveRequestForRPC，它在 activeRequestQueue 上调度一个同步块并阻塞 10 个线程。activeRequestQueue 想要运行它的读取块，但没有任何可用线程。此时我们已经陷入僵局。

更常见的是，我会看到类似 9 个操作 (1-9) 的安排，其中一个 op1 在第 10 个线程上快速运行 hasActiveRequestForRPC 并安排一个 addActiveRequest barrer 块。然后另一个 op 将被安排在第 10 个线程上，并且 op2-10 将安排并等待 hasActiveRequestForRPC。然后 op1 的调度 addRpc 块将不会运行，因为 op10 占用了最后一个可用线程，并且所有其他 hasActiveRequestForRpc 块将等待屏障块执行。当 op1 试图在另一个也无法访问任何线程的操作队列上安排缓存操作时，它最终会阻塞。

我假设阻塞 hasActiveRequestForRPC 正在等待一个 barrer 块执行，但关键是 activeRequestQueue 等待**任何**线程可用性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T00:46:07.963

编辑：原来问题是正在调用的 NSOperationQueue`enqueueOperation:`正在使用所有可用线程，所以因为它们都在等待（通过 dispatch_sync）在`activeRequestsQueue`. 减少这个队列上的 maxConcurrentOperations 解决了这个问题（见评论），虽然这并不是一个很好的解决方案，因为它对核心数量等进行了假设。更好的解决方案是使用`dispatch_async`而不是`dispatch_sync`，尽管这会使代码更复杂。

我之前的建议：

*   当您已经在 activeRequestsQueue 上时您正在调用`dispatch_sync(activeRequestsQueue, ...)`（并且您的断言由于某种原因没有触发，就像您在发布中运行一样。）

*   `[activeRequests removeObjectForKey:key];`导致请求被释放，而 dealloc 正在等待调用 的东西`activeRequestForRpc:`，这将导致死锁。

# android - Kivy：跨平台通知图标

> ID：13962888
> 
> 赞同：5
> 
> 时间：2012-12-19T23:20:22.740
> 
> 标签：android, python, linux, notifications, kivy

我想创建一个带有通知图标的跨平台应用程序（Ubuntu 和 Android）。是否有使用 Kivy 创建此类应用程序的标准方法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T18:39:37.653

简短的回答，不……如果您想定义这样的 API 并使用特定于平台的库（Ubuntu 上的 libnotify 和 Android 上的 pyjnius）实现它，那将是受欢迎的。其他人将帮助使其在其他平台上运行。

# javascript - Slickgrid 滚动直到最后一行位于 Dataview 的上部

> ID：13962890
> 
> 赞同：1
> 
> 时间：2012-12-19T23:20:56.653
> 
> 标签：javascript, slickgrid

有没有办法让 Slickgrid 即使在到达最后一行之后继续向下滚动，以便在数据视图的上部查看最后一行？

也许添加一个 css-margin 或不可见的行？

更新：

一个很好的比较是 MS Access 表或查询视图，其中最后一行（或添加行的行）可以一直缩放到视图的顶部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T00:17:21.067

将`leaveSpaceForNewRows`选项设置为`true`。

# javascript - 使用自调用函数与变量无关

> ID：13962893
> 
> 赞同：4
> 
> 时间：2012-12-19T23:21:28.327
> 
> 标签：javascript, self-invoking-function, self-executing-function

> **可能重复：**
> [循环内的 Javascript 闭包 - 简单的实际示例](https://stackoverflow.com/questions/750486/javascript-closure-inside-loops-simple-practical-example)

我正在尝试使用自调用函数，以便每个函数`objects`都返回不同的消息。

```
<script type="text/javascript">

    objects = {};

    for( var i = 0; i < 10; i++ ) {

        objects['function'+i] = function () {

            var text = ( function() { return "I am object " + i; } )();

            return text;

        };

    }

    for( var j = 0; j < 10; j++ ) {

        document.write( objects['function'+j]() + "<br>" );

    }

</script> 
```

到目前为止，上述结果：

> 我是对象 10
> 
> 我是对象 10
> 
> 我是对象 10
> 
> 我是对象 10
> 
> 我是对象 10
> 
> 我是对象 10
> 
> 我是对象 10
> 
> 我是对象 10
> 
> 我是对象 10
> 
> 我是对象 10

我怎样才能使用自我调用功能来立即设置消息，而不是与不稳定的联系在一起`i`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T23:24:26.217

您需要传入*迭代器变量*，以便您的*匿名函数*可以将其存储在它自己的*激活对象*/*词法环境记录*中（= 在它自己的上下文对象中）。

此外，您需要这个*匿名函数*来包装所有访问点：

```
objects[ 'function' + i ] = function( i ) {

    var text = function() { return "I am object " + i; };

    return text;

}( i ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T23:30:15.910

您需要构建一个[闭包](https://stackoverflow.com/q/111102/1048572)，*关闭*该特定`i`变量并返回未绑定的函数`i`：

```
for (var i = 0; i < 10; i++) {
    objects['function'+i] = ( function (num) {
        return function() {
            var text = "I am object " + num;
            return text;
        };
    } )( i ); // <== put the variable into the self-invoking function
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T23:30:41.470

你需要一个关闭.. 在这里查看 King Resig 的解释[http://ejohn.org/apps/learn/#59](http://ejohn.org/apps/learn/#59)以获得解释。但是要使此代码正常工作，您必须确保在调用函数时保持 i 的值......所以它就像

[http://jsbin.com/uveluw/1/edit](http://jsbin.com/uveluw/1/edit)

```
for( var i = 0; i < 10; i++ ) (function(i){

    objects['function'+i] = function () {
        var text = ( function() { return "I am object " + i; } )();
        return text;
    };

})(i) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T23:36:44.103

立即执行返回值，以便 i 关闭循环：

```
objects = {};
for( var i = 0; i < 10; i++ ) {
    objects['function'+i] = (function () {
        var text = ( function() { return "I am object " + i; } )();
        return text;
    })();
}

for( var j = 0; j < 10; j++ ) {
    console.log( objects['function'+j] );
} 
```

# php - MAMP localhost 包含和 cookie 设置功能

> ID：13962894
> 
> 赞同：2
> 
> 时间：2012-12-19T23:21:28.793
> 
> 标签：php, cookies, include, localhost, mamp

出于明显的原因，我试图将我的网站移至离线状态，但我无法让`localhost`PHP 函数正常工作。我的代码如下：

```
include "http://localhost:8888/mainbar.php?display=1"; 
```

如果我只有它的名称，我可以包含该文件，但我需要通过 url 传递值，所以这不是一个选项。我已经研究了让它工作的其他方法，但使用 MAMP 的全部意义在于能够离线工作，然后上传改进。

接下来，我无法设置 cookie。这是我拥有的以下 cookie 代码：

```
$expire=time() + (14 * 24 * 60 * 60);
setcookie("user", "Conan", $expire, '/'); 
```

我也尝试使用 Chrome 设置 cookie，但无法这样做。如果无法做到，我会感到惊讶。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T03:14:59.873

应该只给包含文件路径，而不是 URL。

正确的用法如下所示：包括“/path/to/file”

`include "/var/www/html/yourappfolder/mainbar.php";`

我看到您正在尝试将其传递给变量，`?display=1`. 解决方案不是弄清楚如何使用 URL 参数加载文件，您真的想重新设计如何获取与`display`变量对应的信息。

您想要做的是改进软件设计并在某处创建一个单独的功能，例如：`getMainBarData($display)`. 在您的 mainbar.php 文件中，您将调用此函数以获取当前的结果。在您使用包含的文件中，您可以包含包含新函数的文件`getMainBarData($display)`，并直接调用它：`getMainBarData(1)`.

所以基本上，你想创建一个函数，这个函数既可以被使用，也可以被`mainbar.php`包含在这个文件中。2页可以使用的1个功能是您的最佳解决方案。

至于cookie问题..尝试不使用路径“/”..所以：

`setcookie('user', 'Conan', $expire);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T15:02:58.180

对于问题的第一部分，您需要启用 url_file_include。这被认为是一个巨大的安全风险，通常永远不应该使用它，因为它是糟糕设计的标志。为了使这项工作你只需要添加一个

```
allow_url_include=1 
```

在你的 php.ini 中。对于问题的后半部分，您的代码在我的 MAMP 安装上运行良好，因此您必须确保您对 setcookie 的调用在浏览器的任何输出（任何回显）之前。此外，如果您要保存任何敏感信息，您应该考虑不使用 cookie。

# ruby-on-rails - acl9 的角色表的列中应该包含什么

> ID：13962896
> 
> 赞同：2
> 
> 时间：2012-12-19T23:21:43.450
> 
> 标签：ruby-on-rails, acl9

可能是一个愚蠢的问题，但我非常接近实现 acl9。只是有点不确定角色表中的数据应该是什么样子：

```
id | name  | authorizable_type | authorizable_id | created_at | updated_at 
---+-------+-------------------+-----------------+------------+------------ 
```

我假设名称将是“管理员”等。

我不确定`authorizable_type`和`authorizable_id`指的是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T03:10:28.383

`authorizable_type`和映射的主要目的是`authorizable_id``authorizable_object'。如果您在应用程序中创建角色表，希望这通常会有所帮助，您的迁移应该如下所示：

```
class CreateRoles < ActiveRecord::Migration
  def self.up
    create_table :roles, :force => true do |t|
      t.string   :name
      t.string   :authorizable_type
      t.integer  :authorizable_id
      t.timestamps
    end
    add_index :roles, :name
    add_index :roles, [:authorizable_id, authorizable_type]
    add_index :roles, [:name, :authorizable_id, :authorizable_type], :unique => true
  end

  def self.down
    remove_index :roles, [:name, :authorizable_id, :authorizable_type]
    remove_index :roles, [:authorizable_id, :authorizable_type]
    remove_index :roles, :name
    drop_table :roles
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-22T20:17:55.007

首先，[acl9](https://github.com/be9/acl9)的 1.2 版附带了一个生成器，用于角色表所需的迁移（以及其他一些好东西），`bin/rails g acl9:setup -h`有关更多详细信息，请参阅。

其次，为了解释这些字段，Rails 有一个称为多态关联的功能（[在此处阅读更多信息](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#module-ActiveRecord::Associations::ClassMethods-label-Polymorphic+Associations)），它允许您将一个模型与任何其他模型相关联。acl9 使用此功能使您能够在您希望的任何其他模型上应用角色，在 acl9 术语中，我们将这些其他模型称为*“对象”*（[在此处阅读更多信息](https://github.com/be9/acl9/wiki/Role-Subsystem#object-model)）。您需要做的就是`acts_as_authorization_object`在模型中包含调用，这样您就可以执行以下操作：

```
user.has_role! :admin, school 
```

并且该用户具有该`:admin`角色`school`（并且仅针对该特定学校）。根据多态关联功能，`authorizable_id`将包含数据库中该学校的主键，`authorizable_type`并将包含类名`"School"`。

# php - 更改发件人姓名 PHP 电子邮件？

> ID：13962898
> 
> 赞同：3
> 
> 时间：2012-12-19T23:21:55.237
> 
> 标签：php, html-email

好的，

因此，我向我的用户设置发送了电子邮件通知，但他们收到通知说它来自notifications@domain.com。相反，我希望它在收件箱中显示为“名称/标题”而不是电子邮件地址。

这是我到目前为止所得到的：

```
$settings['notification'] = 'Notifications <notifications@domain.com>';

function nemail($to,$subject,$tpl,$var=array())
{
global $settings;
extract($var, EXTR_OVERWRITE);
$headers = "MIME-Version: 1.0" . "\r\n";
$headers .= "Content-type:text/html;charset=utf-8" . "\r\n";
$headers .= 'From: '. trim($settings['notification']) . "\r\n" .
    'Reply-To: '. trim($settings['notification']) . "\r\n";
ob_start();
ob_implicit_flush(false);
require(realpath("themes/".$settings['theme']."/template/email_".$tpl.".php"));
$message = ob_get_clean();
@mail($to, $subject, $message, $headers);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T00:15:41.573

您可以这样尝试（来自[http://php.net/manual/en/function.mail.php](http://php.net/manual/en/function.mail.php) #Example 4）

```
$headers .= 'From: Blah Blah Blah <'.trim($settings['notification']) . ">' . "\r\n"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:59:17.307

正如 RTB 在他的评论中所说，您应该考虑使用 PHPMailer 发送电子邮件。

但是，我认为对您的问题的简单回答是设置 Sender 标头以及 From - 如果 From 标头包含一封电子邮件，RFC 说您“不应该”，但这不是禁止的。

[https://www.rfc-editor.org/rfc/rfc2822#section-3.6.2](https://www.rfc-editor.org/rfc/rfc2822#section-3.6.2)

# perfmon - 无法在 Win 2008 中将数据收集器模板导入 Perfmon，但在 Win 7 上工作

> ID：13962900
> 
> 赞同：3
> 
> 时间：2012-12-19T23:22:18.037
> 
> 标签：perfmon

我在 Win 7 上为 Perfmon 创建了 xml 模板。我能够导入它并运行它——一切都很好。现在，当我将此 xml 复制到 Win 2008 R2 机器并尝试将其导入 perfmon 时，我收到错误消息“指定的文件不包含有效的 XML”。XML 很好——我也在编辑器中检查了它。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-03-26T22:43:54.027

试试这个，打开模板文件并更改

```
<?xml version="1.0" encoding="UTF-16"?> 
```

至

```
<?xml version="1.0" encoding="UTF-8"?> 
```

然后再试一次。您可能还想删除安全元素以防万一。

# php - CodeIgniter 身份验证

> ID：13962902
> 
> 赞同：-2
> 
> 时间：2012-12-19T23:22:28.963
> 
> 标签：php, codeigniter, authentication

> **可能重复：**
> [我应该如何为 CodeIgniter 选择身份验证库？](https://stackoverflow.com/questions/346980/how-should-i-choose-an-authentication-library-for-codeigniter)

我想知道的一件有趣的事情 CodeIgniter 没有任何内置的身份验证系统。

谁能告诉我是否有任何现有的插件？如果有，对这些插件有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T23:26:32.027

有许多身份验证库。您也可以创建自己的。

在这里找到几个身份验证库：http: [//blog.pisyek.com/2011/11/5-best-authentication-libraries-for-codeigniter/](http://blog.pisyek.com/2011/11/5-best-authentication-libraries-for-codeigniter/)

Ion Auth 非常受欢迎。

# c# - WPF 堆栈面板显示隐藏子项

> ID：13962905
> 
> 赞同：2
> 
> 时间：2012-12-19T23:23:07.160
> 
> 标签：c#, .net, wpf, xaml

我有一个带有两个单选按钮的堆栈面板。一个是选项 A，另一个是选项 B。一次只能选择一个。当我选中选项 B 时，我想在选项 B 单选按钮下方和堆栈面板中显示几个文本框。当我再次选择选项 A 时，文本框应该不可见。我怎样才能通过使用 XAML 来完成这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T00:38:11.763

您可以绑定到`RadioButton` `IsChecked`属性并使用内置`BooleanToVisibilityConverter`

```
<Window x:Class="WpfApplication4.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfApplication4"
       Title="MainWindow" Height="300" Width="400" Name="UI" >
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter" />
    </Window.Resources>

    <Grid>
        <StackPanel Margin="0,0,0,202">
            <RadioButton x:Name="OptionA" Content="OptionA" />
            <RadioButton x:Name="OptionB" Content="OptionB" />
        </StackPanel>
        <TextBox Visibility="{Binding ElementName=OptionB, Path=IsChecked, Converter={StaticResource BoolToVisibilityConverter}}" Text="My Textbox"  Margin="0,65,165,167"/>
    </Grid>

</Window> 
```

这将`TextBox`仅在选中“OptionB”时显示。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T04:55:23.723

只有在没有转换器的 XAML 中。在您的资源中定义 ControlTemplate，例如

```
 <Window.Resources>
    <ControlTemplate x:Key="RadioButtonContent">
        <Grid>
            <StackPanel Margin="0,0,0,202">
                <RadioButton x:Name="OptionA" Content="OptionA" />
                <RadioButton x:Name="OptionB" Content="OptionB" />
            </StackPanel>
            <TextBox x:Name="MyTextBox" 
                     Visibility="Visible"
                     Text="My Textbox"  Margin="0,65,165,167"/>
        </Grid>
        <ControlTemplate.Triggers>
            <DataTrigger Binding="{Binding ElementName=OptionB, Path=IsChecked}" Value="False">
                <Setter TargetName="MyTextBox" Property="Visibility" Value="Hidden"/>
            </DataTrigger>
        </ControlTemplate.Triggers>
    </ControlTemplate>
</Window.Resources> 
```

并像使用它一样

```
<ContentControl Template="{StaticResource RadioButtonContent}"/> 
```

希望能帮助到你..

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-20T04:27:25.137

试试这个代码希望能解决你的问题。

将 TextBoxes 放在堆栈面板中，并将堆栈面板的 Visibility 属性设置为隐藏。并在 OptionButton 事件上编写代码来设置 stackPanel 的 Visibility 属性。

```
 <Grid.RowDefinitions>
        <RowDefinition Height="33*"></RowDefinition>
        <RowDefinition Height="33*"></RowDefinition>
        <RowDefinition Height="33*"></RowDefinition>
    </Grid.RowDefinitions>

    <StackPanel Margin="20" Orientation="Vertical" VerticalAlignment="Center" HorizontalAlignment="Left" Grid.Column="0" Grid.Row="0">
        <RadioButton Name="rdA" Content="Option A" GroupName="txtBoxGroup" Checked="rdA_Checked"></RadioButton>
        <RadioButton Name="rdB" Content="Option B" GroupName="txtBoxGroup" Checked="rdB_Checked"></RadioButton>
    </StackPanel>

    <StackPanel Margin="20" Name="TxtBxStackPanel" Height="auto"  Orientation="Vertical" Grid.Column="0" Grid.Row="1" Visibility="Hidden">
        <Label Content="My TextBox" VerticalAlignment="Center" HorizontalAlignment="Left"></Label>
        <TextBox Name="txtValue" Height="20" Width="200" HorizontalAlignment="Left"></TextBox>
    </StackPanel>

</Grid> 
```

在隐藏的代码中 -

```
private void rdB_Checked(object sender, RoutedEventArgs e)
{

    TxtBxStackPanel.Visibility = Visibility.Visible;
}
private void rdA_Checked(object sender, RoutedEventArgs e)
{
    TxtBxStackPanel.Visibility = Visibility.Hidden;
} 
```

享受 ！！！！！！

谢谢

CK 尼丁 (TinTin)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T00:08:54.227

只是有一个事件，当您选择选项 A 时，两者都`TextBoxes`设置为：

```
Textbox.Visibility = Collapsed or Hidden 
```

取决于您希望如何显示它们。

# django - 为什么我的 Django 应用程序无法访问我的 Postgres 服务器？

> ID：13962909
> 
> 赞同：1
> 
> 时间：2012-12-19T23:24:08.020
> 
> 标签：django, postgresql, ubuntu, database-connection

两台服务器都是我的主机上的 VirtualBox 服务器，我能够在它们之间建立网络（从一个到另一个的 ssh 等），除了这个问题（我对排除网络的了解不够作为潜在原因）。

与数据库服务器有关：

1.  我的 IP 表允许端口上的所有 TCP 访问`5432`
2.  我创建了一个 Postgres 数据库，可以使用`psql`shell 毫无问题地打开和查询，使用`foo1`用户
3.  我已经安装了psychpg2
4.  我的 Django 应用程序配置了默认数据库（实际上是唯一配置的数据库）以使用我的服务器的 IP 在 port `5432`，使用`foo1`用户，密码设置为`foo1`'s password
5.  我在 Ubuntu 12.04.1 上使用 Postgres 9.2 和最新的 Psychopg2 和 Django 1.5 beta

该错误来自psychopg2 的初始连接尝试并且没有错误消息（否则，我可能不必问这个）。很简单，`OperationalError`. 所以，我的问题，更具体地说，是：我在该列表中遗漏了哪些更明显的事情，这可能会导致这个问题。

Traceback - 来自 uWSGI 日志，所以没有上下文 :(

```
# ... 10 + frames above here ommitted, since the they amount to
# essentially MyModel.objects.get(pk=1)

File "/var/www/myapp/deps/current/venv/local/lib/python2.7/site-packages/django/db/backends/__init__.py", line 316, in cursor
    cursor = util.CursorWrapper(self._cursor(), self)

File "/var/www/myapp/deps/current/venv/local/lib/python2.7/site-packages/django/db/backends/postgresql_psycopg2/base.py", line 210, in _cursor
    self.connection = self.get_new_connection(conn_params)

File "/var/www/myapp/deps/current/venv/local/lib/python2.7/site-packages/django/db/backends/postgresql_psycopg2/base.py", line 183, in get_new_connection
    return Database.connect(**conn_params)

File "/var/www/myapp/deps/current/venv/local/lib/python2.7/site-packages/psycopg2/__init__.py", line 178, in connect
    return _connect(dsn, connection_factory=connection_factory, async=async)

OperationalError 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T20:42:19.383

您只能安装 PostgreSQL 客户端，这将为您提供 psql。

对于 Windows，安装 ODBC 驱动程序，您将获得 psql。在这里获取： [PostgreSQL ODBC 驱动程序](http://www.postgresql.org/ftp/odbc/versions/msi/)

在 Linux 上，你的包管理器应该有一个 postgresql-client-XXX 包。例如，在 Ubuntu 中，它被称为 postgresql-client-9.1。

# ios - 拍摄 UIWebView 的不可见部分的图像

> ID：13962912
> 
> 赞同：4
> 
> 时间：2012-12-19T23:24:37.327
> 
> 标签：ios, uiwebview, uiimage, core-graphics

我想从一些 uiwebview 内容的部分创建 uiimage 。

假设我的 webview 的大小为 (200,200)。它的内容视图中有 (800,200) 的内容，它是可滚动的，

我想截取以下矩形 CGRectMake(400,0,200,200) 的屏幕截图。

我试过这个：

```
CGRect rect = CGRectMake(pageIndex * webView.frame.size.width, 0, webView.frame.size.width, webView.frame.size.height);
UIGraphicsBeginImageContext([webView getScrollView].bounds.size);
CGContextRef c = UIGraphicsGetCurrentContext();
CGContextClipToRect(c, rect);
[webView.layer renderInContext:c];
UIGraphicsEndImageContext(); 
```

它适用于 webview 的第一页，但对于其他页面，它不获取图像，创建了一个白色图像。

可能是什么问题呢？如何创建滚动视图**当前不可见**部分的屏幕截图？

感谢帮助，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T12:07:16.430

[ScroolViewScrrenshotGitHub](https://github.com/st3fan/iphone-experiments/tree/master/Miscellaneous/ScrollViewScreenShot/)

此处[获取 UIScrollView 的屏幕截图，包括屏幕外部分](https://stackoverflow.com/questions/3539717/getting-a-screenshot-of-a-uiscrollview-including-offscreen-parts)

# android - 重置设备选择器以允许设备选择

> ID：13962915
> 
> 赞同：4
> 
> 时间：2012-12-19T23:24:59.430
> 
> 标签：android, eclipse, avd

您如何重置设备选择器以使其再次显示？

我的意思是我有一个 AVD 正在运行，并选择了**使用相同的设备进行未来的启动**，但是当我准备好/需要在真实设备上试用该应用程序时，我当然会失去该选项。

当前的解决方法是重新启动 Eclipse，但让 AVD 继续运行。

![在此处输入图像描述](../Images/571b4a3260df976591782a9e30faa44e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:28:54.330

右键单击项目-> 属性-> 运行/调试设置-> 删除那里的配置文件。您始终可以将配置文件编辑为“始终提示选择设备”（如果单击编辑，则为目标选项卡），但删除它更容易。

# php - 保留用户信息

> ID：13962917
> 
> 赞同：-3
> 
> 时间：2012-12-19T23:25:04.517
> 
> 标签：php, mysql

我可以让用户登录，但我如何将他们的信息转移到其他页面？我想`$thisUser`保留对所有信息的查询

```
$query = "SELECT * FROM users WHERE username = ? AND password = ? LIMIT 1"; 
```

下面是我的登录代码。

```
 <?php

require_once 'includes\constants.php';

class Mysql{
    private $conn;

    function __construct(){
        $this->conn = new mysqli(DB_SERVER,DB_USER,DB_PASSWORD,DB_NAME) or die('There was  a problem conecting to the database.');
    }

    function verify_username_and_pass($un, $pwd) {      
        $query = "SELECT * FROM users WHERE username = ? AND password = ? LIMIT 1";

        if($stmt = $this->conn->prepare($query)){
            $stmt->bind_param('ss',$un,$pwd);
            $stmt->execute();

            if($stmt->fetch()) {
                $stmt->close();
                return true;
        }
    }
    }

}

    <?php

require 'classes\mysql.php';

class Membership{

    function validate_user($un,$pwd) {
        $mysql = New Mysql();
        $ensure_credentials = $mysql->verify_username_and_pass($un,md5($pwd));

        if($ensure_credentials) {
            $_SESSION['status'] = 'authorized';
            header("location: index.php");
            } else return "Please enter a correct username and password";
    }

    function log_user_out() {
        if(isset($_SESSION['status'])) {
            unset($_SESSION['status']);

            if(isset($_COOKIE[session_name()])) 
                setcookie(session_name(),'',time() - 10000 );
                session_destroy();
        }
        }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T23:32:09.773

HTML 是无状态的，这意味着您无法在页面加载之间保存数据。但是，您可以在 PHP 中使用称为会话的东西，它使您能够在对服务器的调用（页面加载）之间存储数据。

`session_start()`只需调用，然后您就可以开始使用全局`$_SESSION`变量，这真的很容易。每个访问者的会话都是唯一的。

[会议手册](http://php.net/manual/en/book.session.php)

和一个[教程](http://www.tizag.com/phpT/phpsessions.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:33:50.393

我会将这些信息`$_SESSION`保存在整个站点中。当用户登录时，添加信息，在他们通过登录后，`$_SESSION`您需要保留。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-12-19T23:36:18.220

您可以创建的最简单的模型是...

在调用会话的任何脚本的顶部：

```
session_start(); 
```

然后在会话中创建名称/值对：

```
$_SESSION['blnLoggedIn'] = $blnLoggedIn; 
```

然后查询或测试存储的值：

```
echo $_SESSION['blnLoggedIn']; 
```

然后可以在任何“安全”页面的顶部查询此值，如果用户不再登录，他们可以被重定向到登录页面。

```
if (!$_SESSION['blnLoggedIn']) {
    header('Location: http://www.example.com/login');
}
    [...'secure' page content...]
} 
```

会话的问题在于它们只持续任意时间段（如果我记得的话，大约是 24 分钟）。通过更多工作，您可以创建一个使用`$_SESSION`、cookie 和数据库的登录模型，以确定在会话到期后它们是否仍应登录。有多种方法可以做到这一点，但最简单的是将用户名存储在 vanilla cookie 中。在会话到期时，当一个新页面被点击时，cookie 用于查询数据库并确定他们是否在某个时间范围内登录，比如一个小时。为此和其他目的，他们登录的时间记录在数据库中。

有关更多详细信息，请阅读有关[会话](http://php.net/manual/en/book.session.php)的 PHP 手册。密切关注用户提交的评论；他们是无价的。

# android - Android将相机图像保存在自定义文件夹中

> ID：13962922
> 
> 赞同：7
> 
> 时间：2012-12-19T23:25:35.817
> 
> 标签：android, camera, save, directory, image

我知道与此处的其他一些问题相比，这个问题似乎是重复的，[如何将相机拍摄的图像保存在特定文件夹中](https://stackoverflow.com/questions/8402378/how-to-save-image-captured-with-camera-in-specific-folder)[like this]，但我仍然遇到问题。我要做的是制作一个应用程序，在您用相机拍照后，图像将保存到一个新文件夹中（以应用程序名称命名）。我看到该文件夹​​已创建，但图像似乎没有插入其中。以下是我认为我搞砸的一些代码。任何帮助都会有很大的帮助。谢谢！

```
 camera.setOnClickListener(new View.OnClickListener() {                
            public void onClick(View v) {
                // TODO Auto-generated method stub
                i = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
                startActivityForResult(i, cameraData); 
            }
        });

    } 

    private void saveToFile(String message) throws Exception {
        String filePath = getFilesDir()+"";
        File file = new File(filePath + "/sdcard/DCIM/100MEDIA/Wardobe");
        FileOutputStream out = new FileOutputStream(file, true);
        out.write(message.getBytes());
        out.close();
        saveImage(filePath, "/sdcard/DCIM/100MEDIA/Wardobe/image.jpg", bmp);
        if(battleborn != null) {
            saveImage(filePath, "sdcard/DCIM/100MEDIA/Wardrobe/image.jpg", bmp);
        } 

    }
    public void saveImage(String path, String dir, Bitmap image) {
        try{
            FileOutputStream fos = new FileOutputStream(path + dir);
            BufferedOutputStream stream = new BufferedOutputStream(fos);
            bmp.compress(CompressFormat.JPEG, 50, stream);
            stream.flush();
            stream.close(); 
        }
        catch(FileNotFoundException e) { 
            e.printStackTrace();
        }
        catch(IOException e) {
            e.printStackTrace();
        }
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T23:45:00.557

尝试使用这个

```
File file = new File(Environment
    .getExternalStorageDirectory()
    + File.separator
    + "/your_folder_name/" + ".png");

FileOutputStream fos = null;
try {
  fos = new FileOutputStream(file);
  if (fos != null) {
    bitmap.compress(Bitmap.CompressFormat.PNG, 90, fos);
    fos.close();
  }
} 
```

不要忘记为您的 mainfest 文件添加权限。

```
 <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T00:04:30.150

在调用相机意图之前尝试放置这个

```
Uri uriSavedImage=Uri.fromFile(new File("/sdcard/flashCropped.png"));
camera.putExtra("output", uriSavedImage);
startActivityForResult(camera, 1); 
```

# python - PyOpenGL 用 VBO 绘制立方体

> ID：13962934
> 
> 赞同：0
> 
> 时间：2012-12-19T23:26:55.577
> 
> 标签：python, dynamic, vbo, pyopengl, cubes

我有一个问题（实际上有几个）
1）如何在 Python 中使用顶点缓冲区对象渲染立方体？
2) 我怎样才能多次重新定位那个立方体
3) 我怎么能不渲染某些面呢？（我有一个八叉树来存储位置，我不想渲染相互接触的脸）
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T08:03:44.690

1：我使用这个模块在 OpenGL 3+ 中渲染立方体

[使用 VBO 渲染立方体](https://github.com/adamlwgriffiths/PyGLy/blob/master/pygly/examples/renderable_cube.py)

如果您没有模型视图/投影矩阵，只需传入“numpy.identity(4)”，这将使顶点以原点为中心。这也意味着相机将出现在立方体内部，因此它可能不可见。

2：您不会“重新定位”对象，而是更改模型视图/投影矩阵并再次渲染 VBO。

立方体的顶点不知道其在 3D 空间中的位置，它们是相对于原点的。当你渲染它时，你应用一个矩阵（投影*模型视图）来移动立方体的顶点。

3：有很多方法可以做到这一点：

A. 为每个面创建一个 VAO / VBO，并且只渲染您想要的面。

B. 为与每个面对应的每个顶点分配一个顶点属性。然后，使用统一的值，为顶点/片段着色器传递足够的信息，以了解它们是否应该渲染。您可以使用单个整数轻松实现这一点，并使用单个位来表示每个面。

我会使用 B，因为您不会经常更改 VAO / VBO 状态，只需更改 6 个值（每张脸 1 个）。

# ruby-on-rails - 在没有本地存储的情况下，通过 Rails 将网站上的图像下载到 CouchDB 附件中？

> ID：13962935
> 
> 赞同：0
> 
> 时间：2012-12-19T23:27:00.047
> 
> 标签：ruby-on-rails, couchdb, mechanize, rest-client

我正在尝试抓取一些网站并将图像存储为 CouchDB 附件。为了加快这个过程，我根本不想在本地存储图像。

我已经在使用的相关 gem 是 Mechanize、CouchRest Model 和 rest-client。我也在使用 Ruby URI 模块。

我尝试将确切的文件 URL 输入 CouchRest 的 create_attachment 方法。但是，我相信它需要一个 Ruby 类 File 的文件。（它没有明确记录。）它会为路径抛出一个未定义的方法错误。（文件方法）

在下面的代码中，地址是页面的 URI 数组，@string_address 是相同的字符串版本。

```
def scrape_site
  agent = Mechanize.new
  page = agent.get @string_address
  page.images.each do |image|
    image_src = address
    image_src[5] = URI.split(image.src)[5]
    image_src = URI::HTTP.new(*image_src).to_s
    self.create_attachment file: image_src, name: image.text
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:35:05.167

好吧，如果它需要一个 File 对象，您只需要制作一个假装它是一个...尝试创建一个子类 StringIO 的类。构造成图片URL的二进制数据，加个路径就行了？返回一些（希望）满足 CouchRest 的方法。

# oauth - MVC4 外部登录切换账号

> ID：13962941
> 
> 赞同：1
> 
> 时间：2012-12-19T23:27:44.687
> 
> 标签：oauth, asp.net-mvc-4, security

使用 MVC4 Internet 模板项目复制我的问题的步骤：

1.  注册本地会员账号（账号A）
2.  登出
3.  注册一个openid账号（我用google）（账号B）
4.  登出
5.  重新登录帐户 A
6.  导航到帐户/管理
7.  在外部链接部分点击谷歌

发生的情况是帐户 A 已注销而帐户 B 已登录。我希望有一些魔术将帐户 A 链接到帐户 B，或者可能是一个例外。所以看起来我需要做那部分。到目前为止，这是我的代码。它取代了帐户控制器中的 ExternalLoginCallback。

```
 [AllowAnonymous]
    public ActionResult ExternalLoginCallback(string returnUrl)
    {
        AuthenticationResult result = OAuthWebSecurity.VerifyAuthentication(Url.Action("ExternalLoginCallback", new { ReturnUrl = returnUrl }));
        if (!result.IsSuccessful)
        {
            return RedirectToAction("ExternalLoginFailure");
        }

        // Need to do fancy logic in case of multiple accounts

        if (User.Identity.IsAuthenticated)
        {
            // check for second blocking account
            // NOTE : This is not a real method, need a real solution
            var second = OAuthWebSecurity.GetUserIdFromProviderUserId(result.ProviderUserId);

            if (second != WebSecurity.CurrentUserId)
            {
                // redirect to failure
                // "This Login is used by another account... "
            } 
```

如您所见，我坚持使用身份验证结果查找帐户。有没有办法使用提供者用户 ID 来查找帐户？任何帮助或见解都会很好。

* * *

**Hackish Fix** Ive 提出了一个快速而肮脏的修复方法。

```
 public ActionResult ExternalLoginCallback(string returnUrl)
    {
        AuthenticationResult result = OAuthWebSecurity.VerifyAuthentication(Url.Action("ExternalLoginCallback", new { ReturnUrl = returnUrl }));
        if (!result.IsSuccessful)
        {
            return RedirectToAction("ExternalLoginFailure");
        }

        // Need to do fancy logic in case of multiple accounts
        bool isBindingAction = User.Identity.IsAuthenticated;

        if (OAuthWebSecurity.Login(result.Provider, result.ProviderUserId, createPersistentCookie: false))
        {
            if (isBindingAction)
            {
                // tell the user that he has 2 accounts
                return RedirectToAction("ExternalLoginSwitch", new {provider = result.Provider});
            }
            return RedirectToLocal(returnUrl);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-09T17:02:45.187

我想如果您只是将 Login 呼叫替换为以下呼叫：

```
public static string GetUserName(string providerName, string providerUserId); 
```

并检查这个provider/providerUserId是否存在用户名，这样会更好。调用 Login 的唯一问题是我相信这仍然会将表单身份验证票设置为错误的用户。

# python - 如何检查值是否为十进制？

> ID：13962948
> 
> 赞同：0
> 
> 时间：2012-12-19T23:28:14.673
> 
> 标签：python, regex

我想检查值是否为小数。我需要手动执行此操作，最好使用 re

这是：

```
if re.match("^[0-9]*[,\.][0-9]*$", value) == None:
    print 'error!'
else:
    print "%.2f" % value 
```

是正确的？

例如，值可以是：

```
20
30.1
155,69 
```

怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T23:31:21.130

您希望在`+`此处使用量词而不是`*`第一个数字字符串，除非您想要诸如`.30`也用于`,.`可选使用`?`并且`.`不需要在字符类中转义的值：

```
re.match("^[0-9]+[,.]?[0-9]*$", value) 
```

# sql - SQL RANK() over PARTITION 在连接表上

> ID：13962950
> 
> 赞同：9
> 
> 时间：2012-12-19T23:28:48.153
> 
> 标签：sql, sql-server-2008, rank

我有两个表 RSLTS 和 CONTACTS：

**RSLTS**

```
 QRY_ID  |  RES_ID  |  SCORE
-----------------------------
   A     |    1     |    15
   A     |    2     |    32
   A     |    3     |    29
   C     |    7     |    61
   C     |    9     |    30 
```

**联系方式**

```
 C_ID  |  QRY_ID  |  RES_ID
----------------------------
  1    |    A     |    2
  2    |    A     |    1
  3    |    C     |    9 
```

我正在尝试创建一个报告，该报告将为每个**CONTACT**记录 ( `C_ID`)显示其组 () 内的**RSLTS**表中`RANK()`的`RES_ID`(by )。使用上面的数据，它看起来像这样：`SCORE`**`QRY_ID`**

 **```
 C_ID  |  QRY_ID  |  RES_ID  |  SCORE  |  Rank
-----------------------------------------------
  1    |    A     |    2     |    32   |   1
  2    |    A     |    1     |    15   |   3
  3    |    C     |    9     |    30   |   2 
```

到目前为止，我尝试了这个，但它返回最后一行的 Rank = 1 （并且第二行的 rank = 2 这也是错误的）

```
SELECT
    C.*
    ,R.SCORE
    ,RANK() OVER (PARTITION BY R.QRY_ID ORDER BY R.SCORE DESC)
FROM CONTACTS C LEFT JOIN RSLTS R
ON C.RES_ID = R.RES_ID
AND C.QRY_ID = R.QRY_ID 
```

更新：[SQLFiddle](http://sqlfiddle.com/#!3/6ef2f/1)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-20T00:21:48.083

因为排名完全不取决于联系人

**RANKED_RSLTS**

```
 QRY_ID  |  RES_ID  |  SCORE |  RANK
-------------------------------------
   A     |    1     |    15  |   3
   A     |    2     |    32  |   1
   A     |    3     |    29  |   2
   C     |    7     |    61  |   1
   C     |    9     |    30  |   2 
```

因此 ：

```
SELECT
    C.*
    ,R.SCORE
    ,MYRANK
FROM CONTACTS C LEFT JOIN
(SELECT  *,
 MYRANK = RANK() OVER (PARTITION BY QRY_ID ORDER BY SCORE DESC)
  FROM RSLTS)  R
ON C.RES_ID = R.RES_ID
AND C.QRY_ID = R.QRY_ID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-16T20:07:30.400

```
SELECT a.C_ID,a.QRY_ID,a.RES_ID,b.SCORE,ROW_NUMBER() OVER (ORDER BY SCORE DESC) AS [RANK]
FROM CONTACTS a JOIN RSLTS b ON a.QRY_ID=b.QRY_ID AND a.RES_ID=b.RES_ID
ORDER BY a.C_ID 
```**

# c# - 如何在页面组件中绑定 QueryStringParameter 而不使用 Code Behind

> ID：13962960
> 
> 赞同：0
> 
> 时间：2012-12-19T23:29:10.607
> 
> 标签：c#, asp.net, query-string

我想直接在我的页面中绑定一些查询字符串参数，而不是使用后面的代码。我知道我可以`Request.QueryString["param"].ToString();`在后面的C#代码中使用，但我想直接绑定它。

就像是：

```
<asp:HyperLink ID="Add" runat="server" NavigateUrl='<%#Eval(Request.QueryString["param"], "~/PartnerOffice.aspx?partnerId={0}") %>' Text="Add New Office" /> 
```

这可能吗？

谢谢，吉克拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:33:58.100

如果您只是导航到另一个页面，为什么要使用`asp:HyperLink`? 只需使用常规`<a>`标签并将您的`QueryString`参数添加到其中：

```
<a href="~/PartnerOffice.aspx?partnerId=<%= Request.QueryString["param"] %>">Add New Office</a> 
```

**编辑：**

您不能在服务器端控件中使用代码块。从[一个相关的问题](https://stackoverflow.com/questions/8725393/inline-page-code-for-sever-controls-never-works)：

> 您不能在服务器端控件中使用代码块 ( `<%%>`,`<%=%>`和)。`<%:%>`绑定表达式 ( `<%#%>`) 是另一回事。
> 
> 您需要了解[快捷服务器端代码块](https://stackoverflow.com/questions/8725393/inline-page-code-for-sever-controls-never-works)之间的差异，只是随机尝试不同的代码块，因为您似乎正在做的事情不会教给您任何东西。
> 
> 您可以在代码隐藏文件中分配值：
> 
> ```
> TextBox1.Text = DateTime.Now.Date.ToString("dd-MM-yyyy"); 
> ```

# c++ - filebuf::openprot 的用途是什么，它有替代品吗？

> ID：13962961
> 
> 赞同：7
> 
> 时间：2012-12-19T23:29:12.683
> 
> 标签：c++

我正在修复一些使用旧式 iostream 库的相当旧的 C++ 代码，并且遇到了以下非编译代码行：

```
::ofstream ofile;
ofile.open("filename", ios::trunc, filebuf::openprot); 
```

我收到此错误：

```
error C2039: 'openprot' : is not a member of 'std::basic_filebuf<_Elem,_Traits>' 
```

所以很明显，它已经不再存在了。问题是，我找不到关于`openprot`作为参数做了什么的任何信息，因此我无法用新的东西替换它，我害怕完全删除该参数。

任何具有 C++ 历史知识的人都知道这件事是做什么的吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T23:45:36.813

该参数指示/指示打开文件的保护模式。它出现在这个[IBM Legacy Class Library Reference](http://publib.boulder.ibm.com/infocenter/iadthelp/v8r0/index.jsp?topic=%2Fcom.ibm.xlcpp111.aix.doc%2Flegacy%2Fcbccl10032.html)中。

`filebuf::openprot`是/曾经是`fstream`类族构造函数和`open`函数参数的默认`prot`参数，它指示应该使用哪种保护模式打开/创建文件。

> 打开文件时使用的默认保护模式。

例如，在您的系统上可能是`0644`，这意味着*如果创建了文件*，则所有者将具有读/写权限，而其他所有人将具有只读权限。

在您的情况下，无论如何都传递了默认参数，我会说删除它是安全的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T23:31:42.123

根据[Visual Studio 6.0 文档](http://msdn.microsoft.com/en-us/library/aa243815%28v=VS.60%29.aspx)，`openprot`使用操作系统的默认值：

> 文件保护规范；默认为静态整数`filebuf::openprot`，相当于操作系统默认值（`filebuf::sh_compat`对于 MS-DOS）。

# html - iframe 应该与 plunkr 一起使用吗？

> ID：13962965
> 
> 赞同：0
> 
> 时间：2012-12-19T23:29:59.113
> 
> 标签：html, iframe, plunker

我正在尝试制作一个使用 iframe 嵌入内容的 plunkr。[这是我到目前为止所拥有的。](http://plnkr.co/edit/XTNENqjBxwciNn6qUso4)我做错了吗？它只显示一个空的 iframe。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T23:40:22.283

iFrames 在 plunker 中工作。这仅取决于来源。

例如尝试以下操作：

```
<iframe src="http://www.w3schools.com"></iframe> 
```

**[演示](http://plnkr.co/edit/CoO64eNigDnddXfjM6uv?p=preview)**

Google 会阻止浏览器在不在 Google 域网页上的 iFrame 中显示 Google 网站。

[如何在 iframe 中显示 google.com？](https://stackoverflow.com/questions/8700636/how-to-show-google-com-in-an-iframe)

# ruby-on-rails - 无法从 ajax 创建返回 id

> ID：13962975
> 
> 赞同：-1
> 
> 时间：2012-12-19T23:31:20.677
> 
> 标签：ruby-on-rails, ajax, activerecord

我正在学习如何将 ajax 与 rails 一起使用，除了一个持续存在的问题外，我没有遇到太多麻烦。我有一个用户过去使用过的地址的下拉列表。然后我有一个“使用新地址”按钮，它会显示一个模式地址表单。然后我想通过 ajax 提交该表单，然后将新地址添加到下拉列表中。

虽然我提交表单或创建地址没有问题，但由于某种原因，我无法在回调中访问创建访问的 ID。这是上下文的一些代码：

```
class AddressesController < ApplicationController
  respond_to :js

  def create
    @address = current_user.addresses.build(params[:address])
    @address.save
    respond_with(@address)
  end

end 
```

这应该将数据提供给 create.js.erb。在那个文件中，我访问@address.city 或@address.state 没有问题，但是一旦我尝试访问@address.id，我的ajax 调用就开始出现500 服务器错误。我认为这可能意味着我必须将 id 添加到 address.rb 中的 attr_accessible，但这似乎也没有帮助。有什么我想念的吗？任何帮助将不胜感激。

编辑：我是个白痴。我没有意识到 escape_javascript 不应该用于整数，所以我将 @address.id 包裹在其中，导致错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T01:33:17.550

哎呀。问题是我没有意识到 escape_javascript 不应该用于整数，所以我把 @address.id 包装在里面，导致错误。

# html - 如何使用正则表达式从 HTML 片段中获取所有 HTML 元素？

> ID：13962983
> 
> 赞同：0
> 
> 时间：2012-12-19T23:31:53.890
> 
> 标签：html, regex

使用正则表达式获取所有 HTML 元素是否有技巧？以这段 HTML 片段为例：

```
<div>
<p>test
<span>blub</span></p>
</div> 
```

以正确的顺序如：

```
array(
0=>'<div>
<p>test
<span>blub</span></p>
</div>',

1=>'<p>test
<span>blub</span></p>'

2=>'<span>blub</span>'
) 
```

我想到了一些东西

```
 (<([A-z]+)[^>]*>.*?</\2>) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:36:41.020

看看这个问题：[regex match html element with html children](https://stackoverflow.com/questions/12564990/regex-match-html-element-with-html-children)

您无法真正使用正则表达式解析 HTML。使用 PHP 或其他语言来解析您的 HTML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T23:39:20.213

又快又脏

```
<[^>]+> 
```

当您在其中包含带有 '>' 的字符串时，不要期望这会起作用。

# php - 数组循环和取消设置

> ID：13962986
> 
> 赞同：1
> 
> 时间：2012-12-19T23:31:55.910
> 
> 标签：php, arrays, loops, foreach, unset

我有以下 PHP 数组：

```
$data = Array 
(   
    [rules1.txt] => Array 
    ( 
        [rules] => Array 
        ( 
            [0] => throw rule blah
            [1] => punt rule blah
            [2] => #comment 
            [3] =>
            [4] => #punt rule that is commented out
        ) 
        [item] => rules1 
        [itemId] => 4 
        [new] => true 
    ) 

    [rules2.txt] => Array
    (
        ...
    )

    ...
) 
```

我关心的数组部分是 $data['rules'] 及其键和值。数组的这一部分有不同数量的键，当然，值也不同。

我要做的是“找到”以特定关键字开头的值，例如“throw”或“punt”……空行（例如 $data['rules'][3]）和注释值（如 $data['rules'][2] 和 ...[4]）需要删除。

因此，在我最终使用的任何循环中，我都需要以类似...的结构结束

```
$data = Array 
(   
    [rules1.txt] => Array 
    ( 
        [rules] => Array 
        ( 
            [0] => throw rule blah
            [1] => punt rule blah
        ) 
        [item] => rules1 
        [itemId] => 4 
        [new] => true 
    ) 

    [rules2.txt] => Array
    (
        ...
    )

    ...
) 
```

为了实现我的目标，我创建了一个简单的附加数组，其中包含关键字......

```
$actions = Array(
    'throw',
    'punt'
); 
```

...用于循环创建第三个数组，看起来像...

```
$removeThese = Array 
(   
    [rules1.txt] => Array 
    ( 
        [0] => 2
        [1] => 3
        [2] => 4
    ) 

    [rules2.txt] => Array
    (
        ...
    )

    ...
) 
```

上面的数组 $removeThese 只保存了每个文件（rules1.txt、rules2.txt 等）需要从 $data['rules'] 中删除的 $data['rules'] 索引。

由于我对 PHP 耳熟能详，因此我尝试过的每种方法都失败了。正确的数据不是 unset() 或者在创建 $removeThese 时我错误地覆盖了我的数组。

寻找从 A 点（包含要删除的项目的原始 $data）到 B 点（已删除项目的更新 $date）最好的建议。

非常感谢。

# 编辑

尝试了以下代码，该代码似乎很接近，但 $removeThese 正在被覆盖...最终只有 $data 中的最后一个文件和 $data['rules'] 的最后一个索引。

```
foreach ($data as $fileName => $fileData)
{
    foreach ($fileData as $fdKey => $fdValue)
    {
        if ($fdKey === 'rules')
        {
            foreach ($fdValue as $key => $value)
            {
                foreach ($actions as $action)
                {
                    if (strpos($value, $action) != 0)
                    {
                        if (!in_array($value, $removeThese[$fileName]))
                        {
                            $removeThese[$fileName][] = $key;
                        }
                    }
                }
            }
        }
    }
} 
```

所以我看到两个问题：

1）我哪里出错了导致 $removeThese 被覆盖？
2）写这个更好的方法是什么？

# 固定的

我一直在寻找的最终代码，我认为这并不算太糟糕——尽管我还有很多东西要学……

```
foreach ($data as $fileName => $fileData)
{
    foreach ($fileData as $fdKey => $fdValue)
    {
        if ($fdKey === 'rules')
        {
            foreach ($fdValue as $key => $value)
            {
                $value = rtrim($value, "\n");

                if (!in_array($value, $actions) === true)
                {
                    unset($data[$fileName][$fdKey][$key]);
                }
            }
        }
    }
} 
```

*大量*的试验和错误，但唉，它的工作原理！我敢肯定，你们中的许多人本可以做得更好、更快。希望我能跟上速度。

现在我如何对自己的工作进行投票并接受自己的解决方案？！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T23:37:44.900

我建议使用[array_filter()](http://php.net/array_filter)。首先制作识别要忽略的值的函数：

```
function shouldIgnore($value) {
  return !in_array($value, array('throw', 'punt'));
} 
```

然后像这样过滤：

```
$data["rules1.txt"]["rules"] = array_filter($data["rules1.txt"]["rules"], "shouldIgnore"); 
```

# android - ProgressDialog 或 ProgressBar 会降低运行 Android 4.1 的应用程序的速度

> ID：13962988
> 
> 赞同：6
> 
> 时间：2012-12-19T23:32:05.300
> 
> 标签：android, json, web-services, android-asynctask, progressdialog

我正在开发一个 android 应用程序，在其中我使用 AsyncTask 从使用 JSON 的 Web 服务获取信息，然后将其加载到 ListView 中。直到这里一切正常。

我使用了一个 ProgressDialog，它在 onPreExecute() 方法中启动并在 onPostExecute() 方法中关闭。在运行 2.3.3 android 版本的模拟器中，所有这些动作最多需要 7/8 秒。我已经使用运行 2.3.6 的真实设备进行了测试，并且该应用程序具有相同的行为。

但是，当我使用运行 4.1 android 版本的模拟器时，此操作需要 65 到 70 秒。当我删除 ProgressDialog 时，该操作在 android 2.3 和 4.1 版本中都需要 7/8 秒。我已经多次测试了所有这些场景。

为什么会这样？我没有任何具有 4.1 android 版本的真实设备来测试它，所以我想知道这是否是模拟器问题？我尝试使用普通的进度条圆圈，而不是 ProgressDialog，但同样的事情发生了，只是在 android 4.1 版本中花费的时间太长。

有什么想法可能是这种奇怪行为的原因吗？:S

谢谢你。

dmon 和 James McCracken 这里是我活动的代码，你能帮我吗？

```
public class MainActivity extends Activity {
private TextView tvTitleList;
private ListView lvDataSearch;
private ProgressDialog dialog;
private long timeStart;
private String[] dataSearch;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    tvTitleList = (TextView) findViewById(R.id.tvTitleList);
    lvDataSearch = (ListView) findViewById(R.id.lvDataSearch);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public class ProcessUpdateList extends AsyncTask<Integer, String, String[]> {
    @Override
    protected void onPreExecute() {
        timeStart = System.currentTimeMillis();
        System.out.println("pre execute");
        try {
            tvTitleList.setText("working....");
            dialog = ProgressDialog.show(MainActivity.this, "", "Loading. Please wait...", true);
        } catch (Exception e) {
            System.out.println("Error Async 1: " + e.getMessage());
        }
    }

    @Override
    protected String[] doInBackground(Integer... paramss) {
        try {
            System.out.println("Get Data");
            dataSearch = getDataSearch();
        } catch (Exception e) {
            System.out.println("Error Async 2: " + e.getMessage());
        }
        System.out.println("Return Data "
                + ((System.currentTimeMillis() - timeStart) / 1000));
        return dataSearch;
    }

    @Override
    protected void onPostExecute(String[] values) {
        try {
            System.out.println("Post Execute Data");
            tvTitleList.setText("done in " + ((System.currentTimeMillis() - timeStart) / 1000));
            updateViewList();
            dialog.dismiss();
        } catch (Exception e) {
            System.out.println("Error Async 3: " + e.getMessage());
        }
    }
}

public void eventUpdateList() {     
    ProcessUpdateList process = new ProcessUpdateList();
    try {
        process.execute();
    } catch (Exception e) {
        System.out.println("NEW ERROR 2: " + e.getMessage());
    }
}   

public String[] getDataSearch() {   
    try {
        String readTwitterFeed = readJSON2("http://search.twitter.com/search.json?q=hey");

        JSONObject jsonObject = new JSONObject(readTwitterFeed);
        JSONArray jsonArray = new JSONArray();

        jsonArray.put(jsonObject);
        Gson gson = new GsonBuilder().setPrettyPrinting().create();
        String json = gson.toJson(jsonObject);

        JSONObject jsonObject2 = new JSONObject(json);
        JSONObject level1 = jsonObject2.getJSONObject("nameValuePairs");
        JSONObject level2 = level1.getJSONObject("results");
        JSONArray level3 = level2.getJSONArray("values");

        dataSearch = new String[level3.length()];                   
        System.out.println(level3.length()+" resultados encontrados.");;

        for(int i=0; i<level3.length(); i++) {
            dataSearch[i] = level3.getJSONObject(i).getJSONObject("nameValuePairs").getString("text");
        }           
    }
    catch(JSONException e) {
        System.out.println(e.getMessage());
    }       
    return dataSearch;      
}

public String readJSON2(String command) {
    JSONObject jObj = null;
    StringBuilder builder = new StringBuilder();
    HttpClient client = new DefaultHttpClient();
    HttpGet httpGet = new HttpGet(command);
    try {
        HttpResponse response = client.execute(httpGet);
        StatusLine statusLine = response.getStatusLine();
        int statusCode = statusLine.getStatusCode();
        if (statusCode == 200) {
            HttpEntity entity = response.getEntity();
            InputStream content = entity.getContent();
            BufferedReader reader = new BufferedReader(
                    new InputStreamReader(content));
            String line;
            while ((line = reader.readLine()) != null) {
                builder.append(line);
            }
            reader.close();
            jObj = new JSONObject(builder.toString());
        } else {
            System.out.println(MainActivity.class.toString() + " Failed to download file");
        }
    } catch (Exception e) {
        return null;
    }
    return builder.toString();
}

public void updateViewList() {
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_list_item_1, android.R.id.text1, dataSearch);                 
    lvDataSearch.setAdapter(adapter);
}

public void clickBRefreshList(View v) {
    eventUpdateList();
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-15T19:54:51.867

我只能在模拟器中确认相同的行为，在 4.1 上进行测试。在我的实际设备（Galaxy S3 - 4.1）上，这不会发生。此外，它似乎只发生在不确定的进度条上。我不知道为什么会发生这种情况，但也许知道这种情况发生在其他人身上你会感觉更好。我正在执行与您几乎相同的操作，连接到 Web 服务，解析 xml 响应，然后显示解析的响应。仅供参考，我正在使用 a`ProgressBar`作为 a 的`android:empty`功能`ListView`。

编辑：进行一些测试

我测试了解析xml文件并`ProgressBar`在布局中得到了这个：

`Parse time: 94785 ms`

所以，我改变了这个

```
<ProgressBar
        android:id="@id/android:empty"
        style="@android:style/Widget.Holo.ProgressBar"
        android:layout_width="wrap_content"
        android:layout_height="0dip"
        android:layout_gravity="center_horizontal|center_vertical" 
        android:layout_weight="1"/> 
```

对此

```
 <TextView 
        android:id="@id/android:empty"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="Searching..."/> 
```

得到了这个`Parse time: 2642 ms`

注意：我的`ProgressBar`and `ListView`are 在 a 中`LinearLayout`，所有的解析都是在 a 中完成的`AsyncTask`。这一切都在模拟器上。真的很奇怪......我的猜测是**模拟器实际上并没有将线程与 UI 分开**，因此`AsyncTask`和`ProgressBar`spin 正在争夺 CPU 周期，而在实际的手机中它按预期运行，因为它没有被模拟。

编辑：所以，在我的 WinXP 上观看 TaskManager 之后，模拟器开始运行 7 个线程。我启动我的应用程序，运行多次`AsyncTask`使用`AsyncTask.THREAD_POOL_EXECUTOR`，并且在整个过程中线程数从未从 7 （在任务管理器中）改变。

# html - 为什么元素不继承子元素的大小

> ID：13962997
> 
> 赞同：3
> 
> 时间：2012-12-19T23:33:12.767
> 
> 标签：html, css

 我有非常非常简单的 html，通常 HTML 中的所有内容似乎都可以正常工作，但在这种情况下，它不会。我认为 a 标签的大小应该继承一个子图像标签。但是在下面的情况下，大小是不同的。

html:

```
<a href="."><img src="some image"></a>​ 
```

CSS：

```
a {
    border: 1px solid #000;
    width: auto;
    height: auto;
}

img {
    border: 1px solid #F00;
}
​ 
``` 

为什么不`<a>`继承图像的大小？（见：http: [//jsfiddle.net/49ykj/](http://jsfiddle.net/49ykj/)）

到目前为止，这发生在 Firefox 和 Chrome 中，所以我假设它发生在所有浏览器中。这是一个错误？为什么它不应该是一个错误？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T23:35:51.610

发生这种情况是因为`a`它是一个内联元素，而`img`它是一个内联块元素。将元素的 css`display`属性更改`a`为 inline-block ，您会注意到它们具有相同的大小。

这不是一个错误。它只是 css 的本质以及大多数浏览器以这种方式初始化两个元素 css 属性的事实。

# eclipse - 如何在 Android 中对 Google 地图进行 Junit 测试？

> ID：13962998
> 
> 赞同：2
> 
> 时间：2012-12-19T23:33:12.703
> 
> 标签：eclipse, unit-testing, google-maps, junit, android-4.0-ice-cream-sandwich

我在一个 Android 项目中使用 Google Maps API，现在我需要尽可能使用 JUnit 对其进行测试。（我对 JUnit 和谷歌地图都有些陌生。）我一直在网上搜索，但找不到任何东西。

地图视图有站点的点/图钉，当我点击一个时，我会弹出一个带有名称和其他信息的气球。然后，当我点击气球时，我会看到一个新视图，其中包含有关位置和要执行的操作（例如导航）的信息。

我想知道的是，是否可以编写一个 JUnit 测试用例来找到所有这些点/引脚，点击它们，并验证弹出的新视图上的信息？此外，我想更改/模拟 GPS 的位置，看看如果我尝试说导航海外或类似的东西会发生什么。我确实有一个相同位置的列表视图，我也将对其进行测试，但我想知道是否有办法测试地图视图。

我更喜欢 JUnit 提供的自动化测试脚本。如果 JUnit 无法做到这一点，那么最好的选择是什么？

我正在使用 Android 4.0 并使用 Eclipse。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T02:32:34.417

万一有人想知道经过大量搜索，我终于找到了可以测试谷歌地图的东西。诸如缩放级别之类的东西，我相信 Tap pin（方法称为 tapMapMarkerItem()）是受支持的。我还没有测试过pin tap。显然，很棒的 Robotium 本身并不支持地图测试。Nicholas Albion 很好地创建了一个扩展来为 Android 上的地图提供测试支持。非常感谢尼古拉斯！

* * *

所以这里是：
1\. 从 robotium.org 下载 Robotium jars（我发现这很有帮助 [http://www.vogella.com/articles/AndroidTesting/article.html](http://www.vogella.com/articles/AndroidTesting/article.html) - 由 Lars Vogel 提供） 2\. 从[https](https://github.com/nalbion/robotium-maps)
下载扩展： [//github.com/nalbion/robotium-maps](https://github.com/nalbion/robotium-maps)