# StackOverflow 问答 15823000-15823999

# nginx - 本地主机上的子域与 Nginx

> ID：15823003
> 
> 赞同：2
> 
> 时间：2013-04-04T22:43:43.047
> 
> 标签：nginx

我想捕获 project1.localhost，这是我尝试过的 conf，但它没有捕获任何东西。

```
server {
       listen 80;

       server_name project.localhost;

       location / {
                proxy_pass      http://127.0.0.1:3000/;
        }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T22:47:27.373

将第 127.0.0.1 行 project.localhost 添加到主机文件（*nix 中的 /etc/hosts）。

# java - 尝试连接到串行端口时使用 javax.swing.SwingWorker 时出现问题

> ID：15823004
> 
> 赞同：2
> 
> 时间：2013-04-04T22:43:43.827
> 
> 标签：java, swing, user-interface, serial-port, xbee

我正在用 Java 开发一个应用程序，它将从 Xbee 设备接收到的数据上传到在线数据库。功能在那里，一切正常，但是在开发 GUI（使用 WindowsPro Builder）时，一切都变糟了。问题是，应用程序需要能够检测到 Xbee 设备，如果未连接，请等待它连接 - 无限期（或直到关闭）。我已经有一种方法可以检测串口是否是 Xbee 设备；就像我说的，一切正常，除非我将它与 GUI 集成。

我遇到的问题是创建一个 GUI，它首先检测 Xbee 设备是否已连接，如果没有，则显示一条消息，通知用户连接设备以继续。同时（在显示消息时），我需要调用扫描串行端口的方法。我正在考虑线程，但我已经有一段时间没有使用它们了。请注意，该方法在应用程序启动时已经运行过一次，以便尝试连接。我没有要显示的代码，因为我所做的只是放置基本框架、按钮等（还没有事件）。我是 Java 的 GUI 编程新手，有什么建议吗？

**更新：**所以我有点尝试实现 MadProgrammer 的建议，我有点相信它在 SwingWorker 教程中有效，但没有任何反应。唯一运行的是设置 GUI。接下来是代码：

```
import java.util.ArrayList;
import java.util.List;
import java.util.concurrent.ExecutionException;

import javax.swing.SwingWorker;

public class ConnectionWorker extends SwingWorker<Boolean, String> {

private ConnectionListener callBack;
private Xbee xbee = new Xbee();
private QboComm comm;

public ConnectionWorker(ConnectionListener listener, QboComm comm) {
    this.callBack = listener;
    this.comm = comm;
}

protected void process(List<String> chunks) {
    String msg = chunks.get(chunks.size() - 1);
    if (msg.equals("WAITING")) {
        comm.publishError();
    }
}

protected Boolean doInBackground() throws Exception {
    boolean isConnected = false;
    this.xbee = QboComm.xbee;
    ArrayList<String> list = new ArrayList<String>();
    if(!isConnected){
        publish("WAITING");
        while(!isConnected){
            list = xbee.getSerialPorts();
            for(String s : list){
                isConnected = xbee.connect(s);
                if(isConnected){
                    publish("DONE");
                    break;
                }
            }
        }
    }
    return isConnected;
}

protected void done() {
    boolean check;
    try {
        check = get();
        if (check) {
            comm.removeError();
            callBack.connectionEstablished();
        } else {
            callBack.connectionFailed();
        }
    } catch (InterruptedException | ExecutionException e) {
        e.printStackTrace();
    }
}  
} 
```

* * *

```
import java.awt.EventQueue;

public class QboComm {

private JFrame frmQboCommunicator;
public static Xbee xbee = new Xbee();
private JInternalFrame internalFrame;
private JLabel lblConnected;

/**
 * Launch the application.
 */
public static void main(String[] args) {
    EventQueue.invokeLater(new Runnable() {
        public void run() {
            QboComm window = new QboComm();
            window.frmQboCommunicator.setVisible(true);
            ConnectionListener callback = new ConnectionListener() {
                public void connectionEstablished() {
                    try {
                        ArrayList<String> list = new ArrayList<String>();
                        list = xbee.fetch();
                        DBConnector db = DBConnector.getConnector();
                        if(db.connect()){
                            for(String s : list){
                                db.upload(s.substring(0, 5), s.substring(5));
                            }
                        }
                        db.disconnect();
                        xbee.printDBList();
                    } catch (Exception e) {
                        e.printStackTrace();
                    } 
                }
                public void connectionFailed() {
                    //IMPLEMENT
                }
            };
            new ConnectionWorker(callback, window).execute();
        }
    });
}

/**
 * Create the application.
 */
public QboComm() {
    initialize();
}

/**
 * Initialize the contents of the frame.
 */
private void initialize() {
    frmQboCommunicator = new JFrame();
    frmQboCommunicator.setTitle("Qbo Communicator");
    frmQboCommunicator.getContentPane().setBackground(new Color(165, 42, 42));
    frmQboCommunicator.getContentPane().setForeground(new Color(211, 211, 211));
    frmQboCommunicator.setBounds(100, 100, 450, 300);
    frmQboCommunicator.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frmQboCommunicator.getContentPane().setLayout(null);

    /**
     * Connection Error Pop-up
     */
    this.internalFrame = new JInternalFrame("Connection Error");
    internalFrame.setBorder(new LineBorder(new Color(153, 180, 209), 3));
    internalFrame.setBounds(103, 46, 227, 157);
    frmQboCommunicator.getContentPane().add(internalFrame);
    internalFrame.getContentPane().setLayout(null);
    JTextPane txtpnAQboCommunicator = new JTextPane();
    txtpnAQboCommunicator.setText("A Qbo Communicator is not connected. Please connect a Qbo Communicator to continue.");
    txtpnAQboCommunicator.setEditable(false);
    txtpnAQboCommunicator.setBounds(0, 0, 211, 128);
    internalFrame.getContentPane().add(txtpnAQboCommunicator);
    internalFrame.setVisible(false);

    /**
     * Application Name
     */
    JLabel lblQboCommunicator = DefaultComponentFactory.getInstance().createTitle("QBO COMMUNICATOR");
    lblQboCommunicator.setForeground(new Color(255, 255, 255));
    lblQboCommunicator.setBackground(new Color(255, 255, 240));
    lblQboCommunicator.setHorizontalAlignment(SwingConstants.CENTER);
    lblQboCommunicator.setBounds(144, 0, 146, 14);
    frmQboCommunicator.getContentPane().add(lblQboCommunicator);

    /**
     * Connected label, displayed when connected to Xbee device
     */
    this.lblConnected = DefaultComponentFactory.getInstance().createLabel("CONNECTED");
    lblConnected.setForeground(new Color(255, 255, 255));
    lblConnected.setFont(new Font("Tahoma", Font.BOLD, 14));
    lblConnected.setHorizontalAlignment(SwingConstants.CENTER);
    lblConnected.setBounds(144, 25, 146, 14);
    frmQboCommunicator.getContentPane().add(lblConnected);

    /**
     * Scroll Panel that displays uploaded data
     */

    JScrollPane scrollPane = new JScrollPane();
    scrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
    scrollPane.setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_NEVER);
    scrollPane.setBounds(53, 65, 344, 131);
    frmQboCommunicator.getContentPane().add(scrollPane);

    JPanel panel = new JPanel();
    panel.setBorder(new LineBorder(new Color(255, 255, 255)));
    panel.setBackground(new Color(165, 42, 42));
    scrollPane.setViewportView(panel);

    /**
     * Progress Bar
     */
    JProgressBar progressBar = new JProgressBar();
    progressBar.setStringPainted(true);
    progressBar.setFont(new Font("Tahoma", Font.BOLD, 12));
    progressBar.setBackground(new Color(255, 255, 255));
    progressBar.setForeground(new Color(255, 140, 0));
    progressBar.setBounds(53, 214, 344, 25);
    frmQboCommunicator.getContentPane().add(progressBar);
}

public void publishError(){
    this.internalFrame.setVisible(true);
    this.lblConnected.setText("DISCONNECTED");
}

public void removeError(){
    this.internalFrame.setVisible(false);
    this.lblConnected.setText("CONNECTED");
}
} 
```

第二个代码块是启动应用程序的主类。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T22:53:44.637

你在线程的轨道上。

您可能对Java 跟踪中的[并发教程感兴趣。](http://docs.oracle.com/javase/tutorial/essential/concurrency/)我会想一些类似于 and 的[`notify`东西`wait`](http://docs.oracle.com/javase/tutorial/essential/concurrency/guardmeth.html)。例如：

```
public synchronized guardedJoy() {
    // This guard only loops once for each special event, which may not
    // be the event we're waiting for.
    while(!joy) {
        try {
            wait();
        } catch (InterruptedException e) {}
    }
    System.out.println("Joy and efficiency have been achieved!");
} 
```

上面的代码会一直等到另一个线程从块或方法中调用`notify`对象上的方法；`synchronized`例如，通过调用此方法：

```
public synchronized notifyJoy() {
    joy = true;
    notifyAll();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T23:34:54.977

我强烈建议使用类似`SwingWorker`.

您不想做的是在 Event Dispatching Thread 上执行任何会阻塞 UI 的操作，这将阻止您更新 UI（包括显示消息）并且 UI 无法自行更新，使其看起来像是挂起的。

查看[Swing 中的并发以](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/)获取更多详细信息。

Swing 是一个事件驱动的环境（我敢肯定），基本上，您希望您的应用程序简单地运行直到建立连接，可能会显示某种消息窗口，表明它正在等待连接。

我将是一个相对简单的过程来设置一个`SwingWorker`可以为另一个类提供回调的过程。

```
import java.awt.EventQueue;
import java.util.List;
import javax.swing.SwingWorker;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

public class WaitForSwingWorker {

    public static void main(String[] args) {
        new WaitForSwingWorker();
    }

    public WaitForSwingWorker() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                ConnectionListener callback = new ConnectionListener() {

                    @Override
                    public void connectionEstablished() {
                        // Continue running the app
                    }

                    @Override
                    public void connectionFailed() {
                        // Show error message :(
                    }
                };

                new ConnectionWorker(callback).execute();

                // Execution will continue here...

            }
        });
    }

    public interface ConnectionListener {
        public void connectionEstablished();
        // If possible, you should provide a message as to why...
        public void connectionFailed();
    }

    public class ConnectionWorker extends SwingWorker<Void, String> {

        private ConnectionListener callBack;

        public ConnectionWorker(ConnectionListener listener) {
            callBack = listener;
        }

        @Override
        protected void process(List<String> chunks) {
            // Back in the EDT...
            String msg = chunks.get(chunks.size() - 1);
            if (msg.equals("WAITING")) {
                // Show waiting for connection message...
            }
        }

        @Override
        protected Void doInBackground() throws Exception {
            // Within our own thread
            // Establish connection...
            if (!isConnected) {
                publish("WAITING");
                // Wait for incoming connection, this can block...
            }
            return null;
        }

        @Override
        protected void done() {
            // Back in the EDT
            if (isConnected) {
                // Show failed to connect message?
                callBack.connectionEstablished();
            } else {
                callBack.connectionFailed();
            }
        }

    }

} 
```

*nb- 这是一个概念证明，您需要填写功能*

# python - Python - Pxssh - 尝试登录远程服务器时出现密码被拒绝错误

> ID：15823011
> 
> 赞同：2
> 
> 时间：2013-04-04T22:44:08.047
> 
> 标签：python, pexpect

我正在尝试使用 pexpect 模块 pxssh 登录到我的一台服务器。我得到密码被拒绝。我想我知道这是什么问题，但不知道如何解决它。问题是当我登录到服务器时有一个欢迎横幅（更改横幅不是一个选项）并且 pexpect 会感到困惑。这是我的代码：

```
import pxssh

ssh = pxssh.pxssh()
ssh.login('192.168.1.10', 'username', 'password') 
```

我期待一个“密码：”，但 pxssh 期待 original_prompt='[#$]' 并且这些是符号，并且在横幅中是几个“。”

任何帮助，我将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T10:17:52.277

这个错误来自 ssh is lock.so 打开终端并执行该命令

```
xxxx@toad:~$ rm .ssh/known_hosts 
```

删除 known_hosts

另一个选项是您在 Windows 中登录意味着检查命令提示符。如果您尝试登录 Windows 意味着使用 pexpect

```
child = pexpect.spawn('ssh tiger@172.16.0.190 -p 8888')
child.logfile = open("/tmp/mylog", "w")
print child.before
child.expect('.*Are you sure you want to continue connecting (yes/no)?')
child.sendline("yes")

child.expect(".*assword:")
child.sendline("tiger\r")
child.expect('Press any key to continue...')
child.send('\r')
child.expect('C:\Users\.*>')
child.sendline('dir')
child.prompt('C:\Users\.*>') 
```

pxssh 使用 shell 提示符来同步远程主机的输出。

为了使它更健壮，它将 shell 提示设置为比 $ 或 # 更独特的东西。这应该适用于大多数 Borne/Bash 或 Csh 样式的 shell。 **参考** [http://www.pythonforbeginners.com/code-snippets-source-code/ssh-connection-with-python/](http://www.pythonforbeginners.com/code-snippets-source-code/ssh-connection-with-python/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T07:23:09.943

我不知道您的诊断是否正确，我认为横幅不会导致这种情况，但错误的提示肯定可以做到。查看代码以确定。 [http://www.opensource.apple.com/source/lldb/lldb-69/test/pexpect-2.4/pxssh.py](http://www.opensource.apple.com/source/lldb/lldb-69/test/pexpect-2.4/pxssh.py)

特别是那部分：

```
 elif i==2: # password prompt again
            # For incorrect passwords, some ssh servers will
            # ask for the password again, others return 'denied' right away.
            # If we get the password prompt again then this means
            # we didn't get the password right the first time. 
            self.close()
            raise ExceptionPxssh ('password refused') 
```

免责声明：这不是我的代码，而是**Pxssh**代码。为什么不直接使用**paramiko** ( [http://www.lag.net/paramiko/](http://www.lag.net/paramiko/) ) 或**pexpect**？

# ios - iOS 设备闪烁

> ID：15823012
> 
> 赞同：0
> 
> 时间：2013-04-04T22:44:17.017
> 
> 标签：ios, ipad, flicker

运行几分钟后，我的应用程序开始在某些区域闪烁。问题出现在 iPhone 和 iPad 上，并在多个设备上确认。

问题视频： [http ://www.youtube.com/watch?v=HDE2EgWt9q8](http://www.youtube.com/watch?v=HDE2EgWt9q8)

我能做些什么来解决这个问题？

# c++ - 使用推力::transform 替换 for 循环

> ID：15823015
> 
> 赞同：1
> 
> 时间：2013-04-04T22:44:42.503
> 
> 标签：c++, for-loop, cuda, thrust, odeint

我正在尝试通过在 GPU 的线程上实现 for 循环来优化我的代码。我正在尝试使用推力::transform 消除两个 for 循环。C++ 中的代码如下所示：

```
 ka_index = 0;
    for (int i = 0; i < N_gene; i++)
    {
        for (int j = 0; j < n_ka_d[i]; j++ )
        {
            co0 = get_coeff0(ka_vec_d[ka_index]);
            act[i] += (co0*ka_val_d[ka_index]); 
            ka_index++;
        }
        act[i] = pow(act[i],n); 
    } 
```

我正在估计上述循环中常微分方程（ODE）的系数，并已使用推力将所有数据传输到设备上。考虑基因数量由 N_gene 表示的情况。第一个 for 循环必须运行 N_gene 次。第二个 for 循环受每个基因的激活因子（基因库中的其他友好基因）数量的限制。每个基因都有许多激活因子（友好的基因，其存在会增加基因 i 的浓度），由 n_ka 载体的元素表示。n_ka[i] 的值可以在 0 到 N_gene - 1 之间变化。ka_val 表示每个激活器 ka 的激活量度。ka_vec_d 具有激活基因 i 的基因索引。

我正在尝试使用迭代器来表示这些循环，但无法这样做。我熟悉将thrust::for_each(thrust::make_zip_iterator(thrust::make_tuple)) 用于单个for循环，但是很难想出一种使用counting_iterator或transform迭代器来实现两个for循环的方法。任何转换这两个 for 循环的指针或帮助将不胜感激。谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T11:38:01.567

这看起来像一个减少问题。我认为您可以使用`thrust::transform`zip 迭代器和`thrust::reduce_by_key`. 该解决方案的草图是：

```
// generate indices
std::vector< int > hindices;
for( size_t i=0 ; i<N_gene ; ++i )
    for( size_t j=0 ; j<n_ka_d[i] ; ++j )
     hindices.push_back( i );
thrust::device_vector< int > indices = hindices;

// generate tmp
// trafo1 implements get_coeff0( get< 0 >( t ) ) * get< 1 >( t);
thrust::device_vector< double > tmp( N );
thrust::transform(
    thrust::make_zip_iterator(
        thrust::make_tuple( ka_vec_d.begin() , ka_val_d.begin() ) ) ,
    thrust::make_zip_iterator(
        thrust::make_tuple( ka_vec_d.end() , ka_val_d.end() ) ) ,
    tmp.begin() , trafo1 );

// do the reduction for each ac[i]
thrust::device_vector< int > indices_out( N );
thrust::reduce_by_key( indices.begin() , indices.end() , tmp.begin() ,
    ac.begin() , indices_out.begin() );

// do the pow transformation
thrust::transform( ac.begin() , ac.end() , ac.begin() , pow_trafo ); 
```

我这也可以通过 transform_iterators 进行优化，以减少`thrust::transform`and的调用次数`thrust::recuce_by_key`。

# javascript - 何时在 JavaScript 中使用 Float32Array 而不是 Array

> ID：15823021
> 
> 赞同：61
> 
> 时间：2013-04-04T22:45:20.363
> 
> 标签：javascript, arrays

`Float32Array`什么时候对浏览器应用程序使用 a而不是标准 JavaScript有意义`Array`？

通常，此[性能测试](http://jsperf.com/float32array-slowness-test/2)显示`Float32Array`速度较慢-如果我理解正确，标准`Array`将数字存储为 64 位-因此在精度方面没有优势。

除了任何可能的性能损失之外，`Float32Array`还具有可读性的缺点 - 必须使用构造函数：

```
a = new Float32Array(2);
a[0] = 3.5;
a[1] = 4.5; 
```

而是一个数组文字

```
a = [3.5, 4.5]; 
```

我问这个是因为我正在使用默认为的库 glMatrix `Float32Array`- 并且想知道是否有任何理由我不应该强制使用它来`Array`代替它，这将允许我使用数组文字。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2013-04-10T20:35:25.367

我给开发者发了电子邮件`glMatrix`，我在下面的回答包括他的评论（第 2 点和第 3 点）：

1.  创建一个新对象通常`Array`比`Float32Array`. 对于小型阵列，增益很重要，但对于较大的阵列，增益较小（取决于环境）。

2.  *`TypedArray`从（例如）*访问*数据`Float32Array`通常比从普通数组更快，这意味着大多数数组操作（除了创建新对象）使用 TypedArrays 更快。*

**   正如@emidander 所述，`glMatrix`它主要是为 WebGL 开发的，它要求将向量和矩阵作为`Float32Array`. 因此，对于 WebGL 应用程序，从`Array`到的潜在成本高昂的转换`Float32Array`需要包含在任何性能测量中。* 

 *因此，毫不奇怪，最佳选择取决于应用程序：

*   如果数组通常很小，和/或对它们的操作数量很少，因此构造函数时间占数组生命周期的很大一部分，请使用`Array`.

*   如果代码可读性与性能一样重要，那么使用`Array`（即使用`[]`，而不是构造函数）。

*   如果数组非常大和/或用于许多操作，则使用 TypedArray。

*   对于 WebGL 应用程序（或其他需要类型转换的应用程序），请使用`Float32Array`(或 other `TypedArray`)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-09T20:28:56.700

我假设 glMatrix 库使用 Float32Array，因为它主要用于 WebGL 应用程序，其中矩阵表示为 Float32Arrays ( [http://www.khronos.org/registry/webgl/specs/1.0/#5.14.10](http://www.khronos.org/registry/webgl/specs/1.0/#5.14.10) )。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-23T20:01:40.677

在今天的浏览器实现中，如果与普通数组相比，使用 Float32Array 对可写性和性能都有影响。似乎甚至 gl-matrix 作者也同意需要重构该库以删除 Float32Array 依赖项：[https ://github.com/toji/gl-matrix/issues/359](https://github.com/toji/gl-matrix/issues/359)*

# c++ - 将派生对象存储在基本类型的向量中

> ID：15823025
> 
> 赞同：0
> 
> 时间：2013-04-04T22:45:43.277
> 
> 标签：c++, inheritance, polymorphism, derived

我有一个基类类型指针的 std::vector：

```
vector<Base*> baseList; 
```

我将派生类类型推送到向量上：

```
Derived* derivedObject = new Derived();
baseList.push_back(derivedObject); 
```

但是，当我迭代列表并调用派生类从基类覆盖的函数时，不会调用派生类中的代码。我是否以正确的方式使用向量？

我的基类在声明其函数之前使用了 virtual 关键字，派生类派生了基类：

```
class Derived : public Base 
```

知道我在这里做错了什么吗？

编辑：

调用我声明的函数：

```
typedef vector<App*>::iterator AppIterator;
AppIterator begin() { return l_Apps.begin(); }
AppIterator end()   { return l_Apps.end(); } 
```

我这样调用函数：

```
for (AppIterator it = begin(); it != end(); ++it)
{
    (*it)->Initialize();
} 
```

问题可能出在这里吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:17:45.010

我用迭代器尝试了这个东西......这段代码对我来说很好，所以如果你的问题仍然存在，请考虑不同的编译器=）

```
#include <iostream>
#include <vector>

class Base
{
public:
    virtual void f()
    {
        std::cout << "Base\n";
    }
};
class Derived: public Base
{
public:
    virtual void f()
    {
        std::cout << "Derived\n";
    }
};
int main()
{
    std::vector<Base*> s;
    s.push_back(new Base());
    s.push_back(new Derived());
    s.push_back(new Base());
    s.push_back(new Derived());
    s.push_back(new Base());
    s.push_back(new Derived());
    for (std::vector<Base*>::iterator it = s.begin(); it != s.end(); ++it)
    {
        (*it)->f();
    }
    return 0;
} 
```

我的输出：

```
Base
Derived
Base
Derived
Base
Derived 
```

* * *

您也可以尝试将指针转换为[`dynamic_cast<>`](http://publib.boulder.ibm.com/infocenter/lnxpcomp/v8v101/index.jsp?topic=/com.ibm.xlcpp8l.doc/language/ref/keyword_dynamic_cast.htm)，即使它破坏了使用虚拟方法的全部意义。祝你好运。

# python - Python Time 和 Date 对象使用 24 小时制，即使 PM 以时间格式声明

> ID：15823026
> 
> 赞同：-1
> 
> 时间：2013-04-04T22:45:51.967
> 
> 标签：python, django, django-models, django-views

time.strptime 和 datetime.strptime 都以 24 小时制给出结果，即使我在时间格式字符串中指定了 12 小时制。我使用了它，我注意到它不尊重我的 PM 符号（将 9PM 存储为 9AM），即使时间格式设置正确。

例子：

```
format = "%I:00PM"
mytime = "09:00PM"
x = time.strptime(mytime, format)
print x 
```

输出

> time.struct_time(tm_year=1900, tm_mon=1, tm_mday=1, tm_hour=9, tm_min=0, tm_sec=0, tm_wday=0, tm_yday=1, tm_isdst=-1)

这是错误的！在这种情况下，tm_hour 是 9，它应该是 21。

如果我尝试

```
y = datetime.strptime(mytime,format)
print y 
```

我明白了

> 1900-01-01 09:00:00

又是大错特错。

时间段应该是 21（晚上 9 点），而不是上午 9 点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T22:55:07.320

没有理由通过字符串进行转换，几乎可以肯定会导致问题。

让我们试试这个：

```
tm = time.struct_time(tm_year=2013, tm_mon=4, tm_mday=4, tm_hour=15, tm_min=52, tm_sec=25, tm_wday=3, tm_yday=94, tm_isdst=1)
dt = datetime.datetime(tm.tm_year, tm.tm_mon, tm.tm_mday, tm.tm_hour, tm.tm_min, tm.tm_sec) 
```

但是您可能会注意到，我们使用 的前 6 个成员的`struct_time`顺序与它们在该结构中出现的顺序相同。并且`struct_time`实际上是一个`namedtuple`或某物，其行为就像一个。所以真的，只是：

```
dt = datetime.datetime(*tm[:6]) 
```

如果你想要一个`time`object 而不是 a `datetime`，那很容易。这些中的任何一个：

```
t = datetime.time(tm.tm_hour, tm.tm_min, tm.tm_sec)
t = datetime.datetime(*tm[:6]).time() 
```

同时，如果您不知道天真日期和有意识日期之间的区别，请阅读[`datetime`](http://docs.python.org/2/library/datetime.html)文档介绍。A`struct_time`永远是幼稚的，而`datetime`你以这种方式构造的也会是幼稚的。您必须在外部跟踪它是本地时间、UTC 时间还是来自其他时区的本地时间。如果你把它混在一起，你会遇到一些问题，比如认为它是 1:00 而实际上是 10:00，反之亦然。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T22:52:44.797

我不知道这是否是做你想做的最好的方法，但你可以使用格式

```
import time
mytime = "09:00PM"
time.strptime(mytime, '%I:00%p')
time.struct_time(tm_year=1900, tm_mon=1, tm_mday=1, tm_hour=21, tm_min=0, tm_sec=0, tm_wday=0, tm_yday=1, tm_isdst=-1) 
```

`%p`格式化而不是`'PM'`字符串

# html - 验证错误：ul 不允许作为元素 span 的子级

> ID：15823032
> 
> 赞同：4
> 
> 时间：2013-04-04T22:46:17.633
> 
> 标签：html, html-validation

我不明白为什么 WC3 验证器将此 HTML 标记为无效，它报告的错误是......

''在此上下文中不允许元素 ul 作为元素 span 的子元素。（抑制来自该子树的更多错误。）''

我正在使用 HTML5，此代码用于面包屑。

```
<span class="bread">
    <ul>
        <li><a href="./index.php">HOME</a></li>
        <li>ABOUT</li>
    </ul>
</span> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T22:49:50.300

`<span>`根据定义，它是一个内联元素（例如，你可以在段落中使用它），而`<ul>`它是一个块元素（它是它自己的一小块空间，通常在它之前/之后有空格，不像`<span>`）。

其他人也有同样的问题，最终改用`<div>`标签。请参阅[是否可以将列表放在跨度标签内？](https://stackoverflow.com/questions/6727921/is-it-possible-to-put-a-list-inside-a-span-tag)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T22:53:39.730

根据 html5 建议，该[`<span>`](http://www.w3.org/TR/html5/text-level-semantics.html#the-span-element)元素只能包含[phrasing-content](http://www.w3.org/TR/html5/dom.html#phrasing-content-1)。该[`<ul>`](http://www.w3.org/html/wg/drafts/html/master/grouping-content.html#the-ul-element)元素不在短语内容标签列表中。html 验证引擎正在执行这些规则。

您可以使用 a[`<div>`](http://www.w3.org/html/wg/drafts/html/master/grouping-content.html#the-div-element)作为容器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-10T11:17:42.193

如果您将 div 样式设置为“display:inline”，它名义上应该符合规则，同时表现得完全像一个 span :)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-03-05T21:21:07.607

如果您将它用作面包屑，它是一个导航元素，因此`<nav>`作为`<ul>`. 否则，给 UL 一个“面包屑”类，`<ul class="breadcrumb">`并根据其类对其进行样式设置。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-12T10:47:06.663

采用`<div>`

```
<div class="bread">
    <ul>
        <li><a href="./index.php">HOME</a></li>
        <li>ABOUT</li>
    </ul>
</div> 
```

代替`<span>`

```
<span class="bread">
    <ul>
        <li><a href="./index.php">HOME</a></li>
        <li>ABOUT</li>
    </ul>
</span> 
```

# php - 在javascript变量中获取一个非常大的字符串

> ID：15823033
> 
> 赞同：-3
> 
> 时间：2013-04-04T22:46:19.057
> 
> 标签：php, javascript

我正在编写一个用于阅读通知/消息的网页，这需要我将通知作为数据库的输入。我正在使用 php 获取输入并使用 echo 将其传递给 javascript 函数。

现在的问题是，如果通知非常大（> 1000 个字符或其他内容），则该功能将停止工作。有没有办法在 javascript 变量中存储大字符串？

提前谢谢你。

javascript函数是这样的：

```
function display(subject, notice, from,to)
{
    alert(notice);
    document.getElementById('reader_default').innerHTML='';
    document.getElementById('subject').innerHTML="SUBJECT : "+subject;
    document.getElementById('from').innerHTML="From: "+from;
    document.getElementById('to').innerHTML="To: "+to;
    document.getElementById('noticedisp').innerHTML=""+notice;
} 
```

php 变量 pass 如下所示：

```
echo '<a href="javascript:void(0)" onclick="display(\''.ucfirst($subject).'\',\''.$notice.'\',\''.ucfirst($hostel).' Hostel'.'\',\''.$toid.'\')" style="padding:2%; text-decoration:none; color:#0033CC;">'.ucfirst($subject).'</a>'.'<br /><span style="padding:2%;"><i>From: </i>'.ucfirst($hostel).'Hostel</span><br/>'.'<br/><br/>'; 
```

首先，我提供了以下字符串：

> Lorem ipsum dolor sit amet, consectetur adipiscing elit。Ut molestie luctus lectus，nec volutpat ipsum porta sat amet。Phasellus ut egestas sapien。Curabitur mauris erat, eleifend quis adipiscing sollicitudin, posuere tempor ante。Lorem ipsum dolor sit amet, consectetur adipiscing elit。完全没有问题。Maecenas malesuada lacus pulvinar risus placerat convallis。在 elit aliquam mollis a eu nisi 中的 Cras vitae urna。Nulla id molestie ante。Aenean faucibus interdum nibh，在 tristique dui viverra eu。Nulla facilisi。placerat augue 处的整数。
> 
> Sed quis risus dolor，在 tristique est. Maecenas non tellus vel quam blandit elementum。Sed 前庭痛非 mi eleifend luctus。Proin interdum mollis congue。Fusce quis consequat augue。Integer dictum lectus a ligula egestas in volutpat odio tincidunt。Sed placerat dictum velit quis dapibus。
> 
> Cras non quam ut neque auctor hendrerit。Phasellus tincidunt dapibus metus, id rutrum purus fringilla vel。Pellentesque ac sapien elit。Maecenas nibh justo, lobortis id volutpat a, bibendum egestas enim。Vivamus 坐在 amet justo vel tortor ullamcorper molestie ac sed nibh。Donec adipiscing dui sed odio hendrerit quis aliquet turpis posuere。Donec pharetra mi ut odio luctus sodales。Donec elit nisi, cursus elementum cursus at, scelerisque quis ante。Nunc vel ipsum ut nibh dictum tempus ut ut tortor。Donec dignissim pharetra scelerisque。Curabitur pellentesque urna a velit ultricies 在 lacinia leo euismod。Nulla id dolor ut odio ultrices accumsan in id erat。Aliquam lorem turpis, tristique nec tincidunt id, lacinia sat amet ante。

当尝试一切后这不起作用时，我将字符串缩短为：

> Lorem ipsum dolor sit amet, consectetur adipiscing elit。Ut molestie luctus lectus，nec volutpat ipsum porta sat amet。Phasellus ut egestas sapien。Curabitur mauris erat, eleifend quis adipiscing sollicitudin, posuere tempor ante。Lorem ipsum dolor sit amet, consectetur adipiscing elit。完全没有问题。Maecenas malesuada lacus pulvinar risus placerat convallis。在 elit aliquam mollis a eu nisi 中的 Cras vitae urna。Nulla id molestie ante。Aenean faucibus interdum nibh，在 tristique dui viverra eu。Nulla facilisi。placerat augue 处的整数。

这有效！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:48:20.510

如果 javascript 像字符串一样解析它，它将在换行符处中断。而不是 [ENTER] 你应该尝试使用 \n\[ENTER]..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:58:17.050

您的数据中可能包含单引号或双引号。我会将您回显的内容包装起来`htmlspecialchars`，这样这些和任何其他有问题的 HTML 字符都不会破坏您的输出。

```
echo htmlspecialchars('<a href="javascript:void(0)" onclick="display(\''.ucfirst($subject).'\',\''.$notice.'\',\''.ucfirst($hostel).' Hostel'.'\',\''.$toid.'\')" style="padding:2%; text-decoration:none; color:#0033CC;">'.ucfirst($subject).'</a>'.'<br /><span style="padding:2%;"><i>From: </i>'.ucfirst($hostel).'Hostel</span><br/>'.'<br/><br/>'); 
```

[http://php.net/manual/en/function.htmlspecialchars.php](http://php.net/manual/en/function.htmlspecialchars.php)

# shell - 如何使用 shell 脚本读取用户定义的字典？

> ID：15823034
> 
> 赞同：0
> 
> 时间：2013-04-04T22:46:20.870
> 
> 标签：shell, grep

假设我有`BCFile`以下内容：

```
inlet
{
    type            fixedValue;
    value           uniform (5 0 0);
}
outlet
{
    type            inletOutlet;
    inletValue      $internalField;
    value           $internalField;
}
....
blahblahblah (other boundary condition with the same dictionary format as above) 
```

为了打印出`outlet`边界条件的类型，也就是`inletOutlet`我以为可以使用，

```
cat BCFile | grep "type" | awk '{printf $2}'  | tr -d ";" 
```

但是现在的问题是在使用`grep`中出现了这么多的`type`关键字。那么有没有办法先检测单词`outlet`，然后搜索和grep之间的内容`{}`？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:06:29.740

AWK 非常强大。例如，如果您将记录分隔符设置为`}`每个块成为它自己的记录。然后你只需打印匹配的记录：

```
$ awk -v RS='}' '/outlet/ { print $0 }' file
outlet
{
    type            inletOutlet;
    inletValue      $internalField;
    value           $internalField; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:54:25.693

怎么样 `grep -A 5 'outlet' BCFile | grep 'type' | awk '{printf $2}' | tr -d ";"`

# android - 如何将视图转换为位图并在 android 中保留相同大小的元素？

> ID：15823036
> 
> 赞同：0
> 
> 时间：2013-04-04T22:47:05.257
> 
> 标签：android, view, bitmap

我正在尝试将包含另一个膨胀视图的视图转换为位图，但是当执行代码并查看结果时，它与我想要的图像不同，它将元素包装在一起。我该怎么做才能保持在位图中查看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:15:49.347

你用什么方法？

你试过 View.getDrawingCache() 吗？

[https://developer.android.com/reference/android/view/View.html#getDrawingCache()](https://developer.android.com/reference/android/view/View.html#getDrawingCache())

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:49:44.620

如果它包装在一个容器中，那么您必须在父视图中找到该子视图，然后抓取该视图并将其转换为位图，而不是使用父视图。

# android - 允许 backstack 填充数十个重新实例化的活动？

> ID：15823044
> 
> 赞同：0
> 
> 时间：2013-04-04T22:48:01.213
> 
> 标签：android, android-activity, back, back-stack

这是一个直截了当的问题，但我找不到任何明确的信息来帮助我做出决定。

我有一个包含 2 个表格（2 个活动）的应用程序，这些表格为给定对象填写，清除，然后为下一个对象填写。在给定应用程序的运行期间，这可能会完成 100 次以上。因此，backstack 可以填充 100 多个活动。

所有这些数据都保存到一个 sqlite 数据库中，所以我应该允许 backstack 像那样填充吗？性能影响是什么 - 存储数百个表单实例肯定会开始产生影响。这些实例是否足够有效地存储以至于我不必担心这一点，或者后台堆栈是否有某种限制？有没有办法让 backstack 只存储输入的数据，或者保存的“实例”是否仅由输入的数据组成？查询一个 sqlite 数据库 onbackpressed 而不是比允许 backstack 加载以前的表单效率低得多？有没有办法重新加载现有实例 ala`FLAG_ACTIVITY_SINGLE_TOP`并清除现有输入的数据，但将其（数据）保存在后台堆栈中？

我一直在阅读/告诉我修改后退按钮的行为、backstack 和 android 的活动管理是一个坏主意，这让我作为一个 android 新手尝试这样做。

我认为这两种形式的数据的大小不会超过这个问题的第 2 段，仅供参考。

感谢您的帮助。

编辑以回应 JoxTraex：

`fill -> add -> fill -> add -> n -> commit`

那么可能是

`fill activity A and then instantiate and fill B -> transact to DB -> REinstantiate and fill A then REinstantiate and fill B -> transact to DB -> n -> commit`

我理解正确了吗？

如果是这样，重新加载而不是实例化 A 和 B 的新实例应该可以解决 backstack 问题，因为其中只会有 2 个活动。

这导致人们对`onbackpressed`将要做什么感到困惑——它会重新加载先前输入的数据还是工作不超过两次，因为后台堆栈中只有 2 个活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T22:55:05.853

您不应该**使用**堆栈来跟踪数据**，也不**应该有 100 个活动实例！

您应该根据需要从数据库动态加载数据。此外，如果您将该活动完成 100 次，那么您的设计已经存在问题，请使其更容易，以便用户不必执行此模式：

```
fill -> commit -> fill -> commit 
```

而是将其更改为：

```
fill -> add -> fill -> add -> N -> commit 
```

通过这种方式，您可以简化设计并更有效地使用表单。

`fill`在我的情况下，填充所有相应的数据（理想情况下在一个屏幕上）`add`意味着将该数据推送到事务中，并`commit`意味着完成事务并推送所有内容。`N`意味着重复`fill -> add`模式。完成交易后，返回新的相应数据的主菜单/视图。另外，我建议改为使用一个 ListView 填充所有条目，而不是使用活动堆栈。

# unit-testing - 在单页应用程序中使用 Disqus 的最佳方法是什么？

> ID：15823047
> 
> 赞同：13
> 
> 时间：2013-04-04T22:48:11.097
> 
> 标签：unit-testing, angularjs, disqus, angularjs-directive, single-page-application

在单页应用程序中使用 Disqus 的最佳方法是什么？我看到 angular js 文档已经成功实现了它。

目前，我们的方法在我们的 AngularJS 应用程序中看起来像这样，但它似乎不稳定，难以测试，并且加载了错误的线程 ID（几乎所有地方都加载了相同的线程）。

```
'use strict';

angular.module('studentportalenApp.components')
    .directive('disqusComponent',['$log', '$rootScope', function($log, $rootScope) {

    var _initDisqus = function _initDisqus(attrs)
    {
        if(window.DISQUS) {
            DISQUS.reset({
                reload: true,
                config: function () {
                    this.page.identifier = attrs.threadId;
                    this.disqus_container_id = 'disqus_thread';
                    this.page.url = attrs.permalinkUrl;
                }
            });
        }
        else
        {
            $log.error('window.DISQUS did not exist before directive was loaded.');
        }
    }

    //Destroy DISQUS bindings just before route change, to properly dispose of listeners and frame (postMessage nullpointer exception)
    $rootScope.$on('$routeChangeStart', function() {
            if(window.DISQUS) {
                DISQUS.reset();
            }           
    });

    var _linkFn = function link(scope, element, attrs) {
            _initDisqus(attrs);
        }

    return {
        replace: true,
        template: '<div id="disqus_thread"></div>',
        link: _linkFn
    };
}]); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-24T18:55:28.807

我还想在我的 AngularJS 驱动的博客中加入 Disqus。我发现现有的解决方案有点笨拙，所以我编写了自己的指令：

```
.directive('dirDisqus', function($window) {
    return {
        restrict: 'E',
        scope: {
            disqus_shortname: '@disqusShortname',
            disqus_identifier: '@disqusIdentifier',
            disqus_title: '@disqusTitle',
            disqus_url: '@disqusUrl',
            disqus_category_id: '@disqusCategoryId',
            disqus_disable_mobile: '@disqusDisableMobile',
            readyToBind: "@"
        },
        template: '<div id="disqus_thread"></div><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>',
        link: function(scope) {

            scope.$watch("readyToBind", function(isReady) {

                // If the directive has been called without the 'ready-to-bind' attribute, we
                // set the default to "true" so that Disqus will be loaded straight away.
                if ( !angular.isDefined( isReady ) ) {
                    isReady = "true";
                }
                if (scope.$eval(isReady)) {
                    // put the config variables into separate global vars so that the Disqus script can see them
                    $window.disqus_shortname = scope.disqus_shortname;
                    $window.disqus_identifier = scope.disqus_identifier;
                    $window.disqus_title = scope.disqus_title;
                    $window.disqus_url = scope.disqus_url;
                    $window.disqus_category_id = scope.disqus_category_id;
                    $window.disqus_disable_mobile = scope.disqus_disable_mobile;

                    // get the remote Disqus script and insert it into the DOM
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + scope.disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                }
            });
        }
    };
}); 
```

## 好处

我认为这种方法的主要优点是它使事情变得简单。将指令注册到应用程序后，您无需编写任何 JavaScript 或在 JavaScript 中设置任何配置值。所有配置都通过在指令标签中传递属性来处理，如下所示：

```
<dir-disqus disqus-shortname="YOUR_DISQUS_SHORTNAME"
    disqus-identifier="{{ article.id }}"
    disqus-title="{{ article.title }}"
    ...>
</dir-disqus> 
```

此外，您无需更改 index.html 文件以包含 Disqus .js 文件 - 该指令将在准备好时动态加载它。这意味着所有额外的 .js 只会加载到那些实际使用 Disqus 指令的页面上。

### [您可以在 GitHub 上](https://github.com/michaelbromley/angularUtils/tree/master/src/directives/disqus)查看完整的源代码和文档

# 警告

只有当您的网站处于 HTML5 模式时，上述内容才能正常工作，即在您的 URL 中不使用“#”。我正在更新 GitHub 上的代码，因此该指令在不使用 HTML5Mode 时将起作用，但请注意，您必须将 hashPrefix 设置为“！” 制作“hashbang”网址 - 例如`www.mysite.com/#!/page/123`. 这是 Disqus 施加的限制 - 请参阅[http://help.disqus.com/customer/portal/articles/472107-using-disqus-on-ajax-sites](http://help.disqus.com/customer/portal/articles/472107-using-disqus-on-ajax-sites)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-26T01:02:21.057

我对 Disqus 一无所知，但根据 AngularJS 文档[源代码](http://docs.angularjs.org/js/docs.js)：

他们将加载函数绑定到 afterPartialLoaded：

```
$scope.afterPartialLoaded = function() {
  var currentPageId = $location.path();
  $scope.partialTitle = $scope.currentPage.shortName;
  $window._gaq.push(['_trackPageview', currentPageId]);
  loadDisqus(currentPageId);
}; 
```

然后，他们只需将 html 添加到页面：

```
function loadDisqus(currentPageId) {
  // http://docs.disqus.com/help/2/
  window.disqus_shortname = 'angularjs-next';
  window.disqus_identifier = currentPageId;
  window.disqus_url = 'http://docs.angularjs.org' + currentPageId;

  // http://docs.disqus.com/developers/universal/
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://angularjs.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] ||
      document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();

  angular.element(document.getElementById('disqus_thread')).html('');
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-26T10:23:40.977

这就是我们解决它的方法。

我们在 index.html 的主体中加载 DISQUS，并在有使用它的指令时重置它。

指示：

```
'use strict';

angular.module('fooApp.directives')
    .directive('disqusComponent',['$window', '$log', function($window, $log) {

    var _initDisqus = function _initDisqus(scope)
    {
        if($window.DISQUS) {
                $window.DISQUS.reset({
                    reload: true,
                    config: function () {
                        this.page.identifier = scope.threadId;
                        this.disqus_container_id = 'disqus_thread';
                    }
                });
        }
        else
        {
            $log.error('window.DISQUS did not exist before directive was loaded.');
        }
    }

    var _linkFn = function link(scope, element, attrs) {
            element.html('<div id="disqus_thread"></div>');
            _initDisqus(scope);
        }

    return {
        replace: true,
        template: 'false',
        scope: {
            threadId: '@'
        },
        link: _linkFn
    };
}]); 
```

可以这样测试它：

```
'use strict';

describe('Directive: Disqus', function() {

  var element, $window, $rootScope, $compile;

  beforeEach(function() {
    module('fooApp.directives', function($provide) {
        $provide.decorator('$window', function($delegate) {

            $delegate.DISQUS = {
                reset: jasmine.createSpy()
            };

            return $delegate;
        });
    });

    inject(function(_$rootScope_, _$compile_, _$window_) {
        $window = _$window_;
        $rootScope = _$rootScope_;
        $compile = _$compile_;
    });     

  });

  it('should place a div with id disqus_thread in DOM', function() {
    element = angular.element('<disqus-component></disqus-component>');
    element = $compile(element)($rootScope);
    expect(element.html()).toBe('<div id="disqus_thread"></div>');
  });

  it('should do a call to DISQUS.reset on load', function() {
    element = angular.element('<disqus-component thread-id="TESTTHREAD"></disqus-component>');
    element = $compile(element)($rootScope);

    var resetFn = $window.DISQUS.reset;

    expect(resetFn).toHaveBeenCalled();
  });

}); 
```

# sql-server-2008 - SQL 游标返回许多表

> ID：15823054
> 
> 赞同：0
> 
> 时间：2013-04-04T22:48:33.913
> 
> 标签：sql-server-2008

我有一个 sql 存储过程，其中我使用一个游标，其中包含来自 select 语句的一组 id，我使用这些 id 使用游标将值逐个遍历以将值放入其他变量并使用这些变量进行 sql 连接。我的问题是当我执行此操作时，我返回了许多表，而我只需要返回一个表。

```
SET NOCOUNT ON

declare @BSVal as int
declare @GSVal as int

declare @mID as int
declare @qID as int

DECLARE M_Cursor cursor for

select 
ms.MID,ms.QID
from  vM As ms join QS as qs
ON ms.QSID=qs.QIDjoin 
Mar as mar on mar.MarID=qs.MarID
where (ms.Cid='Web')

open M_Cursor

FETCH NEXT FROM M_Cursor 
INTO @mID, @qID

--Get values
WHILE @@FETCH_STATUS = 0
BEGIN
set @BSVal= (select top 1 SCID from vSC where (EnID in 
(select EnID from En where EnName='BAIDU')
and QTID=1 and MID=@mIDand QSID=@qID)order by ITime desc); 
set @GSVal= (select top 1 SCID from vSC where ( EnID in 
(select EnID from En where EnName='GRAPHIC') and QTID=1 
and MID=@mIDand QSID=@QSID) order by ITime desc);

select  * from 

vM m 

join vw5TABLE BNDCG on (m.QSid=BNDCG.QID And BNDCG.Position=1) 
join vw5TABLE GNDCG on (m.QSid=GNDCG.QID And GNDCG.Position=1)

where

BNDCG.SCid=@BSVal
and GNDCG.SCid=@GSVal
and BNDCG.QSID=@ qID
and GNDCG.QSID=@ qID
and m.MID=@mID

FETCH NEXT FROM M_Cursor 
   INTO @MID, @QSID

END
CLOSE M_Cursor;
DEALLOCATE M_Cursor; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:51:29.663

该代码将为游标的每次迭代运行一个选择，这使它看起来像“许多表”。听起来您需要将该选择的结果插入游标内的临时表或表变量中，然后在游标完成后，从该临时表中选择一次。我没有详细查看您的代码，但我猜可能不需要光标。

这是使用表变量的粗略示例。

```
DECLARE @temptable  TABLE (col1 INT, Col2 VARCHAR(3), Col3 INT)

insert into @temptable (col1,col2,col3)
select  (col1,col2,col3) from 
vM m 
join vw5TABLE BNDCG on (m.QSid=BNDCG.QID And BNDCG.Position=1) 
join vw5TABLE GNDCG on (m.QSid=GNDCG.QID And GNDCG.Position=1)
where
BNDCG.SCid=@BSVal
and GNDCG.SCid=@GSVal
and BNDCG.QSID=@ qID
and GNDCG.QSID=@ qID
and m.MID=@mID

....
..

DEALLOCATE M_Cursor;

SELECT Col1,Col2,Col3 FROM @temptable 
```

# r - 在另一个向量的每个区间中，哪个元素具有函数的最大值

> ID：15823060
> 
> 赞同：1
> 
> 时间：2013-04-04T22:49:29.147
> 
> 标签：r

我是 R 的新用户。我有两个向量`a`和`b`. 我想找出在 vector 的每个区间中哪些元素`b`具有函数的全局最大值。例如`y = 2b``a`

```
 a = c(1, 3, 6, 7)
    b = c(1.1, 1.8, 2.3, 4.5, 6.8, 7.9, 3.3) 
```

表示`1.1, 1.8, 2.3`介于 之间`1 and 3`，但其中哪个函数的值最大`y`，以此类推...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:13:58.877

用`cut`找出如何`b`在 提供的断点处切割`a`，然后`split`列出一个列表，每个区间一个，最后`sapply`问每个区间的问题

```
> sapply(split(b, cut(b, a)), function(x) x[which.max(2*x)])
(1,3] (3,6] (6,7] 
  2.3   4.5   6.8 
```

如果间隔之一的值为零，这仍然有效

```
b <- c(1.1, 1.8, 6.8, 7.9)
res <- sapply(split(b, cut(b, a)), function(x) x[which.max(2 * x)]) 
```

现在返回的是一个列表，其中`numeric()`包含零值区间的条目。结果`res`可以简化为

```
> res[sapply(res, length) == 0] <- NA
> unlist(res)
(1,3] (3,6] (6,7] 
  1.8    NA   6.8 
```

或者，可以在搜索最大值之前删除区间`split(b, cut(b, a), drop=TRUE)`。

# ruby-on-rails-3 - 如何使用 CarrierWave 重新组织现有文件夹层次结构？

> ID：15823061
> 
> 赞同：11
> 
> 时间：2013-04-04T22:49:37.570
> 
> 标签：ruby-on-rails-3, carrierwave, reorganize

我正在尝试在我的 S3 存储桶中移动文件，`CarrierWave`以重新组织文件夹结构。

我来到一个现有的 Rails 应用程序，其中一个类的所有图像都被上传到一个名为`/uploads`. 这会导致问题，如果两个用户上传具有相同文件名的不同图像，第二个图像会覆盖第一个图像。为了解决这个问题，我想根据`ActiveRecord`对象实例重新组织文件夹以将每个图像放在自己的目录中。我们`CarrierWave`用于管理文件上传。

旧的上传程序代码具有以下方法：

```
def store_dir
  "uploads"
end 
```

我修改了方法以反映我的新文件存储方案：

```
def store_dir
  "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
end 
```

这对新图像非常有用，但会破坏旧图像的 url。当我更改模型时，现有图像会立即报告其 URL 位于新文件夹中，而图像文件仍存储在`/uploads`.

```
> object.logo.store_dir
=> "uploads/object/logo/133" 
```

这是不正确的。该对象应在 中报告其徽标`/uploads`。

我的解决方案是编写一个脚本来移动图像文件，但我没有在 CarrierWave 中找到正确的方法来移动文件。我的脚本看起来像这样：

```
MyClass.all.each |image|
  filename = file.name #This method exists in my uploader, returns the file name
  #Move the file from "/uploads" to "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
end 
```

我应该在我的脚本的第三行中做什么来将文件移动到新位置？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2014-01-02T09:01:41.347

警告：这是未经测试的，所以在测试之前请不要在生产中使用。

事情是这样的，一旦你改变了“store_dir”的内容，你所有的旧上传都会丢失。你已经知道了。直接与 S3 交互似乎是解决这个问题的最明显方法，因为carrierwave 没有移动功能。

可能有用的一件事是重新“存储”您的上传并更改“之前：存储”回调中的“存储目录”路径。

在您的上传器中：

```
#Use the old uploads directory so carriewave knows where the original upload is
def store_dir
  'uploads'
end

before :store, :swap_out_store_dir

def swap_out_store_dir
  self.class_eval do
    def store_dir
      "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id}"
    end
  end
end 
```

然后运行这样的脚本：

```
MyClass.all.each do |image|
  image.image.cache! #create a local cache so that store! has something to store
  image.image.store!
end 
```

在此之后，验证文件是否已复制到正确的位置。然后，您必须删除旧的上传文件。此外，删除上面的一次性使用上传器代码并将其替换为新的 store_dir 路径：

```
def store_dir
  "uploads/#{model.class.to_s.underscore}/#{mounted_as}/#{model.id} "
end 
```

我没有对此进行测试，所以我不能保证它会起作用。请先使用测试数据看看它是否有效，如果您成功了，请在此处发表评论。

# google-apps-script - Google Apps 脚本 - 电子表格运行脚本 onEdit？

> ID：15823062
> 
> 赞同：1
> 
> 时间：2013-04-04T22:49:38.443
> 
> 标签：google-apps-script, google-docs, google-drive-api

我有一个在电子表格中使用的脚本。它在单元格 B2 中，需要这样的参数`=myfunction(A2:A12)`。在内部，该函数从大量单元格中获取信息。

似乎没有任何效果。我尝试将其添加到
Scripts > Resources > Current Project Triggers > On edit
Scripts > Resources > Current Project Triggers > On open

如何让此功能在每次文档编辑时更新结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-14T16:05:12.883

我有一个类似的问题，对我来说，我想“观察”一个特定的单元格来触发我的功能。

我做了以下事情（假装 A1 是我正在观看的单元格）

```
IF(LEN(A1) < 1, " ", customFunction() ) 
```

如果我曾经编辑过该单元格，则会成功触发。然而：

> “自定义函数返回值，但不能在其所在单元格之外设置值。在大多数情况下，单元格 A1 中的自定义函数无法修改单元格 A5。但是，如果自定义函数返回双精度数组，则结果会溢出包含的单元格函数并填充包含自定义函数的单元格下方和右侧的单元格。您可以使用包含 return [[1,2],[3,4]]; 的自定义函数进行测试。来自：[https ://developers.google.com/apps-script/execution_custom_functions](https://developers.google.com/apps-script/execution_custom_functions)

这使它几乎没用，但它可能适用于您的情况？

如果将自定义功能分配给项目触发器，则它具有更大的功能，因此我个人最终将其添加到“脚本>资源>当前项目触发器>编辑时”

并且基本上是“观看一列”，所以它只有在当前单元格在“编辑范围”内时才会执行。这有点麻烦，需要一些隐藏的单元格，但它目前对我有用

```
 var rowIndex = thisspreadsheet.getActiveCell().getRowIndex();
  var colIndex = thisspreadsheet.getActiveCell().getColumn();
  //clamp to custom range
  if(rowIndex < 3 && colIndex != 5)
  {
      return 0; 
  }

  //check against copy
  var name = SpreadsheetApp.getActiveSheet().getRange(rowIndex, 5).getValue();
  var copy = SpreadsheetApp.getActiveSheet().getRange(rowIndex, 6).getValue();
  if(name != copy )
  {
     ///value has been changed, do stuff
     SpreadsheetApp.getActiveSheet().getRange(rowIndex, 6).setValue(name);
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T00:25:36.953

当您在自定义函数（如 getRange 和 getValues 等）中调用 Google Apps 服务时，不幸的是，除了传递您正在“观察”的*所有*单元格进行编辑之外，无法在每次编辑时更新此类自定义函数.

而且，也许更令人沮丧的是，传递的解决方法是使用公式引用所有“观察”单元格的单个单元格*不会*触发更新 - 似乎需要直接引用“观察”单元格。

您可以将 GoogleClock() 作为参数传递，它至少每分钟更新一次函数输出。

但是这个论坛上许多成员的建议（他们对这些东西的了解比我多得多）只是：“不要使用自定义函数”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-25T18:35:58.163

我不确定这个确切的代码是否有效，但你可以尝试这样的事情......

```
function onEdit(event){
  var activeSheet = event.source.getActiveSheet();
  if(activeSheet.getName() == "ActiveSheetName") {
    var targetSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("TargetSheetName");
    targetSheet.getRange(2,2).setValue("=myfunction(A2:A12)");
  }
} 
```

假设 B2 单元格在工作表“TargetSheetName”上并假设编辑的单元格在工作表“ActiveSheetName”上，当您编辑任何工作表中的任何单元格时，onEdit 函数将触发。由于有一个 if 语句来检查该编辑的单元格是否在工作表“ActiveSheetName”上，因此只有当编辑的单元格在该工作表上时才会触发，并且它将 B”单元格设置为值 =myfunction(A2:A12)，强迫它更新（我猜）。

希望我是正确的，我是有帮助的

# ruby - feedzirra 更新找不到更新

> ID：15823067
> 
> 赞同：1
> 
> 时间：2013-04-04T22:49:53.997
> 
> 标签：ruby, feedzirra

我正在尝试使用 feedzirra 来获取 rss/atom 提要，但 feedzirra 似乎没有找到更新。我首先获取新的提要并将返回的结构转储到文件中。

```
require 'rubygems'
require 'yaml'
require 'feedzirra'
feed = Feedzirra::Feed.fetch_and_parse("http://rss.slashdot.org/Slashdot/slashdot")
File.open('slashdot.yaml','w'){|f| f.puts feed.to_yaml} 
```

然后我等了一会儿，以便提要有更新，然后我尝试：

```
require 'rubygems'
require 'yaml'
require 'feedzirra'
feed = YAML.load_file('slashdot.yaml')
puts feed.entries.first.published
updated_feed = Feedzirra::Feed.update(feed)
puts updated_feed.new_entries.first.published
all_new = Feedzirra::Feed.fetch_and_parse("http://rss.slashdot.org/Slashdot/slashdot")
puts all_new.entries.first.published 
```

这导致：

```
2013 年 4 月 4 日星期四 15:28:00 UTC
2013 年 4 月 4 日星期四 15:28:00 UTC
2013 年 4 月 4 日星期四 21:50:00 UTC

```

第三行确认有更新的帖子可用，但 Feed.update 没有看到它们。

我究竟做错了什么？

# ios - UIView 过渡 - 翻转两个子视图

> ID：15823069
> 
> 赞同：2
> 
> 时间：2013-04-04T22:50:10.443
> 
> 标签：ios, uiview, uiviewanimation, uiviewanimationtransition

在 UIView 子类（mainView）中，我这样做：

```
[UIView transitionFromView:firstView
                        toView:secondView
                      duration:3
                       options:UIViewAnimationOptionTransitionFlipFromTop | UIViewAnimationCurveEaseIn | UIViewAnimationOptionShowHideTransitionViews
                    completion:^(BOOL finished)
     {

     }
     ]; 
```

但是，整个视图翻转。我只想翻转firstView和secondView，它们是mainView的子视图。我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T06:59:54.007

尝试这个

```
 options:UIViewAnimationOptionTransitionFlipFromTop
 completion:NULL 
```

# javascript - jqPlot BarRenderer 渲染线图而不是条形图

> ID：15823071
> 
> 赞同：0
> 
> 时间：2013-04-04T22:50:19.913
> 
> 标签：javascript, canvas, jqplot

我正在尝试用 100 个输入绘制 1 个系列的直方图。但是，当我指定它来呈现条形图时，jqPlot 会继续将我的数据呈现为折线图。我的代码是条形图示例的修改版本。

```
<script type="text/javascript" src="dist/jquery.min.js"></script>
<script type="text/javascript" src="dist/jquery.jqplot.js"></script>
<script type="text/javascript" src="dist/src/plugins/jqplot.barRenderer.min.js"></script>
<script type="text/javascript" src="dist/src/plugins/jqplot.categoryAxisRenderer.min.js"></script>
<script type="text/javascript" src="dist/src/plugins/jqplot.pointLabels.min.js"></script>

$(document).ready(function(){
            var hits = [123, 54, 897, ...]

            var plot1 = $.jqplot('chart1', [hits], {
                    seriesDefaults:{
                    renderer:$.jqplot.BarRenderer
                    },
                        series:[ {label:'Hits'} ],

            legend: {
                    show: true,
                            placement: 'outsideGrid'
                            },
                        axes: {
                              xaxis: {
                        autoscale: true,
                        renderer: $.jqplot.CategoryAxisRenderer,
                                numberTicks: 4,
                                tickInterval: 25
                                },
                            yaxis: {
                        autoscale: true
                        }
                    }
                });
                }); 
```

有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T08:38:38.710

将`seriesDefaults`选项添加到您的 jqplot 选项：

```
seriesDefaults: {
  renderer: $.jqplot.BarRenderer,
  rendererOptions: {fillToZero: true}
} 
```

# ruby-on-rails - 使用来自远程服务器的 bitbucket 禁用 Shell 访问

> ID：15823073
> 
> 赞同：1
> 
> 时间：2013-04-04T22:50:32.350
> 
> 标签：ruby-on-rails, git, ssh, bitbucket

我已将`cat ~/.ssh/id_rsa.pub`我的远程服务器添加到 bitbucket ssh 密钥。

但是，当我尝试使用 bitbucket 从远程服务器连接时，我得到：

```
PTY allocation request failed on channel 0
conq: logged in as hyperrjas.
You can use git or hg to connect to Bitbucket. Shell access is disabled. 
```

我已将默认 ssh 端口更改为`(22)`远程服务器中的其他端口。我不知道这是否是问题所在。

`ssh -v git@bitbucket.org`这是我从远程服务器进入时的调试。

```
OpenSSH_5.9p1 Debian-5ubuntu1, OpenSSL 1.0.1 14 Mar 2012
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: Applying options for *
debug1: Connecting to bitbucket.org [111.111.111.111] port 22.
debug1: Connection established.
debug1: identity file /home/hyperrjas/.ssh/id_rsa type 1
debug1: Checking blacklist file /usr/share/ssh/blacklist.RSA-2048
debug1: Checking blacklist file /etc/ssh/blacklist.RSA-2048
debug1: identity file /home/hyperrjas/.ssh/id_rsa-cert type -1
debug1: identity file /home/hyperrjas/.ssh/id_dsa type -1
debug1: identity file /home/hyperrjas/.ssh/id_dsa-cert type -1
debug1: identity file /home/hyperrjas/.ssh/id_ecdsa type -1
debug1: identity file /home/hyperrjas/.ssh/id_ecdsa-cert type -1
debug1: Remote protocol version 2.0, remote software version OpenSSH_5.3
debug1: match: OpenSSH_5.3 pat OpenSSH*
debug1: Enabling compatibility mode for protocol 2.0
debug1: Local version string SSH-2.0-OpenSSH_5.9p1 Debian-5ubuntu1
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: server->client aes128-ctr hmac-md5 none
debug1: kex: client->server aes128-ctr hmac-md5 none
debug1: SSH2_MSG_KEX_DH_GEX_REQUEST(1024<1024<8192) sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_GROUP
debug1: SSH2_MSG_KEX_DH_GEX_INIT sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_REPLY
debug1: Server host key: RSA 97:8c:1b:f2:6f:14:6b:5c:3b:ec:aa:46:46:74:7c:40
debug1: Host 'bitbucket.org' is known and matches the RSA host key.
debug1: Found key in /home/hyperrjas/.ssh/known_hosts:1
debug1: ssh_rsa_verify: signature correct
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: Roaming not allowed by server
debug1: SSH2_MSG_SERVICE_REQUEST sent
debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey
debug1: Next authentication method: publickey
debug1: Offering RSA public key: /home/hyperrjas/.ssh/id_rsa
debug1: Remote: Forced command: conq username:hyperrjas
debug1: Remote: Port forwarding disabled.
debug1: Remote: X11 forwarding disabled.
debug1: Remote: Agent forwarding disabled.
debug1: Remote: Pty allocation disabled.
debug1: Server accepts key: pkalg ssh-rsa blen 279
debug1: key_parse_private_pem: PEM_read_PrivateKey failed
debug1: read PEM private key done: type <unknown>
Enter passphrase for key '/home/hyperrjas/.ssh/id_rsa': 
debug1: read PEM private key done: type RSA
debug1: Remote: Forced command: conq username:hyperrjas
debug1: Remote: Port forwarding disabled.
debug1: Remote: X11 forwarding disabled.
debug1: Remote: Agent forwarding disabled.
debug1: Remote: Pty allocation disabled.
debug1: Authentication succeeded (publickey).
Authenticated to bitbucket.org ([111.111.111.111]:22).
debug1: channel 0: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
debug1: Sending environment.
debug1: Sending env LANG = en_US.UTF-8
PTY allocation request failed on channel 0
conq: logged in as hyperrjas.

You can use git or hg to connect to Bitbucket. Shell access is disabled.
debug1: client_input_channel_req: channel 0 rtype exit-status reply 0
debug1: client_input_channel_req: channel 0 rtype eow@openssh.com reply 0
debug1: channel 0: free: client-session, nchannels 1
Connection to bitbucket.org closed.
Transferred: sent 3072, received 2904 bytes, in 0.2 seconds
Bytes per second: sent 17083.9, received 16149.7
debug1: Exit status 0 
```

我正在尝试使用 capistrano 进行部署：

```
cap deploy:setup
  * 2013-04-05 00:10:19 executing `deploy:setup'
  * executing "mkdir -p /home/hyperrjas/apps/myapp /home/hyperrjas/apps/myapp/releases /home/hyperrjas/apps/myapp/shared /home/hyperrjas/apps/myapp/shared/system /home/hyperrjas/apps/myapp/shared/log /home/hyperrjas/apps/myapp/shared/pids"
    servers: ["REMOTESERVERIP"]
connection failed for: REMOTESERVERIP (Errno::ECONNREFUSED: Connection refused - connect(2)) 
```

我已将真实的 bitbucket ip 更改为`111.111.111.111`. `passphrase`出于安全原因，我还在远程服务器上添加了

**我的错误在哪里？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:09:41.967

如消息中所述，您没有通过 ssh 对 bitbucket 的 shell 访问权限。只允许使用 git 命令。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:48:01.413

问题出在港口。如果您更改远程服务器上的 ssh 端口。

你不应该忘记你必须在你的配方中指定 SSH 端口才能使用 capistrano 进行部署。请注意这一点，因为我已经疯了两个小时，显然一切都是正确的，这会让你失去很多时间。

您可以告诉 capistrano 远程服务器的 ssh 端口，将此命令添加到您的 deploy.rb 文件：

```
ssh_options[:port] = 11111 #replace your real ssh port instead 11111 
```

非常感谢你。

# if-statement - 批处理：if..then..else 嵌套让我生气

> ID：15823074
> 
> 赞同：0
> 
> 时间：2013-04-04T22:50:32.617
> 
> 标签：if-statement, batch-file, nested-if

我写了一个带有 if..else 嵌套的子程序不幸的是我不明白为什么我的代码在“ELSE”之前和之后执行（！！）我读了几个小时，但我没有发现任何错误。 。 你能帮助我吗？我复制了代码（有很多回声调试）和输出

这是我的小代码：

```
 setlocal
 set debug=echo 
 %debug%   # %~0: %*
 for /f "usebackq tokens=1-3 delims=;" %%a in ('"%*"') do (set dir=%%~a& set own=%%~b)
 %debug%   - dir="!dir!"
 %debug%   - own="!own!"
 %debug%   -+ analisi cartella: "!dir!"
 if exist "!dir!" (
    %debug%    x la cartella esiste già, passo oltre
    ) else (
    %debug%    - la cartella non esite quindi la creo
    mkdir "!dir!" || echo   [E] non sono riuscito a creare la cartella&& echo %err3_txt% [dir:!dir!] 1>&2 && exit %err3_id%
    )
 %debug%   -+ analisi proprietario: "!own!"
 for /f "usebackq tokens=1,2 delims=\" %%x in ('"!own!\\"') do (set own1=%%~x& set own2=%%~y)
 if [!own!] equ [!own:~0,1! ] (
    %debug%    x il proprietario non è stato specificato quindi non va cambiato, passo oltre
    ) else (
    %debug%    - own1: "!own1!" 
    %debug%    - own2: "!own2!"
    if [%own2%] equ [] (
   %debug%    - il proprietario ha un dominio implicito, lo calcolo
       set ownn=%own1%
       set ownd=%userdomain%
       ) else (
       %debug%    - il proprietario ha un dominio esplicitamente indicato
       set ownd="input non valido"
       if /i [!own1!] equ [L] set ownd=%computername%
       if /i [!own1!] equ [D] set ownd=%userdomain%
       if "%ownd%" equ "input non valido" (echo    [E] il dominio esplitamente indicato non è riconosciuto: !own1!& echo %err4_txt% [dir:!dir!][own:!own!] 1>&2 & exit %err4_id%)
       )
    %debug%    - la configurazione prevede l'impostazione del seguente proprietario: !ownd!\!ownn!
    )
 %debug%   x done. 
```

这是我的输出：

```
# :CSG_check_fs: C:; ;

 - dir="C:"

 - own=" "

 -+ analisi cartella: "C:"

  x la cartella esiste giÓ, passo oltre

 -+ analisi proprietario: " "

  x il proprietario non Þ stato specificato quindi non va cambiato, passo oltre

  - own1: " "

  - own2: ""

  - il proprietario ha un dominio implicito, lo calcolo

  - la configurazione prevede l'impostazione del seguente proprietario: CSG\    

x done. 
```

特别是，让我们在 else 子句之前和之后执行适当的命令！！！为什么？？？这东西太不可思议了！！还是我太累了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:37:38.953

Imo 这可能并不完美，但请记住，这里没有调试服务，我不是你的父亲，卢克。

```
@ echo off&setlocal

for /f "usebackq tokens=1-3 delims=;" %%a in ("%*") do (set dir=%%~a& set own=%%~b)
if not exist "%dir%" mkdir "%dir%" || echo   [E] non sono riuscito a creare la cartella&& echo %err3_txt% [dir:%dir%]&& exit %err3_id%
for /f "usebackq tokens=1,2 delims=\" %%x in ("%own%\\") do (set own1=%%~x& set own2=%%~y)

if not [%own%] equ [%own:~0,1%] (
   if [%own2%] equ [] (
      set ownn=%own1%
      set ownd=%userdomain%
    ) else (
      set "ownd=input non valido"
      if /i [%own1%] equ [L] set ownd=%computername%
      if /i [%own1%] equ [D] set ownd=%userdomain%
      if "%ownd%" equ "input non valido" (echo    [E] il dominio esplitamente indicato non è riconosciuto: %own1%& echo %err4_txt% [dir:%dir%][own:%own%]& exit %err4_id%)
    )
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T04:32:22.423

这当然很奇怪。CMD 似乎对这个非常复杂的语句有一个真正的问题（我也是如此......）：

```
 if [!own!] equ [!own:~0,1! ] (
    %debug%    x il proprietario non è stato specificato quindi non va cambiato, passo oltre
    ) else (
    %debug%    - own1: "!own1!" 
    %debug%    - own2: "!own2!"
    if [%own2%] equ [] (
   %debug%    - il proprietario ha un dominio implicito, lo calcolo
       set ownn=%own1%
       set ownd=%userdomain%
       ) else (
       %debug%    - il proprietario ha un dominio esplicitamente indicato
       set ownd="input non valido"
       if /i [!own1!] equ [L] set ownd=%computername%
       if /i [!own1!] equ [D] set ownd=%userdomain%
       if "%ownd%" equ "input non valido" (echo    [E] il dominio esplitamente indicato non è riconosciuto: !own1!& echo %err4_txt% [dir:!dir!][own:!own!] 1>&2 & exit %err4_id%)
       )
    %debug%    - la configurazione prevede l'impostazione del seguente proprietario: !ownd!\!ownn!
    ) 
```

看着

```
if [!own!] equ [!own:~0,1! ] ( 
```

您可能认为这应该被评估，`OWN`设置为单个空格，如

```
if [ ] equ [ ] ( 
```

这应该会产生语法错误，因为命令中的第三个标记是`]`并且它不是有效的比较运算符。混淆很重要，`!var!`因为直到执行时间才能评估它 - 到那时，解析器已经完成了它的工作。

正确的形式是

```
 if "%own%" equ "%own:~0,1% " ( 
```

因为解析器然后可以替换 CURRENT（即 PARSE-TIME）值，`own`并且语法是“引用字符串”运算符“另一个引用字符串”

我确信这种改变将解决问题的主要部分。

相似地，

```
 if [%own2%] equ [] ( 
```

应该

```
 if "%own2%" equ "" ( 
```

甚至（我的偏好）

```
 if not defined own2 
```

*   其他`IF [..] equ [...]`构造也是如此。

最后，在序列中

```
 set ownd="input non valido"
       if /i [!own1!] equ [L] set ownd=%computername%
       if /i [!own1!] equ [D] set ownd=%userdomain%
       if "%ownd%" equ "input non valido" (echo    [E] il dominio ... 
```

有一个小问题（除了`if..[...`

`ownd`可能在代码中设置，但`%ownd%`在这些行的最后一行将具有已`ownd`替换的 PARSE-TIME 值，因此它不太可能包含目标字符串。**这是**您需要的地方，**因为** `!var!`代码`var`正在更改 的值，并且您需要该`changed`值，而不是语句为`parsed`.

高温高压

# c# - 按钮返回对属性所做的更改？

> ID：15823076
> 
> 赞同：-1
> 
> 时间：2013-04-04T22:50:41.207
> 
> 标签：c#, winforms, button, methods, properties

我正在尝试在运行时评估属性的值。首先，我尝试使用一个人的 name 属性来完成此操作，但我不确定如何完成下面的 if 语句。我希望它重新打开我的 Form2，它将学生作为参数，它将显示他们的所有详细信息。任何帮助或建议将不胜感激。如果我做错了，请告诉我一些关于如何在运行时编辑属性数据的指导或建议。

```
public class Student :IPerson
{
    //Method that changes the original name
    public string ChangeName(string newForename)
    {
        _forename = newForename;
        return _forename;
    }
}

public partial class Edit_Details : Form
{      
    public Edit_Details(Student student)
    {
        InitializeComponent();
        nameLabel.Text = student.Forename;
        student.ChangeName(editNameTextBox.Text);
        //if(savebutton.Click) //how can I get this to replace the old name with the new one when the button is pressed??
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T22:56:56.297

在

```
 public Edit_Details(Student student)
    {
        InitializeComponent();
        nameLabel.Text = student.Forename;
        savebutton.Click+=(sender,e)=>
          {
             savebutton.Text=student.ChangeName(editNameTextBox.Text);
          };
    } 
```

# solr - Solr 4中按距离排序结果的理想方法？

> ID：15823077
> 
> 赞同：3
> 
> 时间：2013-04-04T22:50:42.697
> 
> 标签：solr, geolocation, solr4

我正在努力阅读和理解 Solr 4 中有关空间搜索的文档：

[http://wiki.apache.org/solr/SolrAdaptersForLuceneSpatial4](http://wiki.apache.org/solr/SolrAdaptersForLuceneSpatial4)

但是我很难找到一个简单的答案：在 Solr 4 中按距离对结果进行排序的理想方法是什么？

我的文档集中有两个可用的位置字段：

`geo`是一个`location_rpt`定义为的字段：

```
<fieldType name="location_rpt" class="solr.SpatialRecursivePrefixTreeFieldType"
    geo="true" distErrPct="0.025" maxDistErr="0.000009" units="degrees" /> 
```

并且`ll`是一个位置字段，定义为：

```
<fieldType name="location" class="solr.LatLonType" subFieldSuffix="_coordinate"/> 
```

我在上面引用的文档中看到的示例引用了相交的圆圈和各种似乎没有必要的事情，如果我感兴趣的只是在我的查询中提供一个起点（纬度/经度），并获得一个按距离排序的结果列表。

**更新：**接受的答案提供了一个很好的解决方案，适用于 Solr 3 和 4。David Smiley[对该答案的评论](https://stackoverflow.com/questions/15823077/ideal-way-of-sorting-results-by-distance-in-solr-4/15824987?noredirect=1#comment22530116_15824987)为感兴趣的人提供了严格的“Solr 4”排序方式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T02:37:58.453

根据**第 4 章 - Query Solr - Sorting Results by a distance from a point** in the *Apache Solr 4 Cookbook*为了根据 `ll`您在架构中定义的字段按距离排序，您将使用[geodist()](http://wiki.apache.org/solr/SpatialSearch#geodist_-_The_distance_function)函数，如下所示：

假设您站在北极 (0.0, 0.0)，并且您希望对公司进行排序，使离您最近的公司在结果列表中排在第一位。您的查询将如下所示：

```
 http://localhost:8983/solr/select?q=company&sort=geodist(ll,0.0,0.0)+asc 
```

# c++ - libev 每个 fd 超过一个观察者失败

> ID：15823083
> 
> 赞同：0
> 
> 时间：2013-04-04T22:51:16.673
> 
> 标签：c++, sockets, gcc, libev

我似乎无法让每个套接字工作 2 个观察者。下面的代码根本不起作用，但如果我混淆了这些调用（例如，为 1 个观察者调用 init/set/start，然后为其他调用），我只有 1 名观察者工作.. 有什么我在这里严重遗漏的东西......？我认为它与循环和设置没有任何关系......我有 1 个接受循环（默认循环）和 1 个用于接受连接的循环。我尝试了这两种方法，在接受循环上接受连接后直接在下面运行代码，然后通过 ev_async_send(...) 然后从其他 io 循环执行此代码。结果是一样的。在 1 个观察者上设置这两个事件也可以正常工作。

谢谢

```
ev_init (pSockWatcher->_wW, &CNetServer::send_cb);
ev_init (pSockWatcher->_wR, &CNetServer::recv_cb);

ev_io_set (pSockWatcher->_wW, pSockWatcher->_sd, EV_WRITE );
ev_io_set (pSockWatcher->_wR, pSockWatcher->_sd, EV_READ );

ev_io_start (loop, pSockWatcher->_wR);
ev_io_start (loop, pSockWatcher->_wW); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T19:20:36.430

好吧，这是一个示例，在一个套接字 fd 上有两个 I/O 观察程序，这对我来说似乎工作得很好。但是，我使用的是 ev_io_init() 函数，而不是 ev_init() 和 ev_set()。

```
#include <ev.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>
#include <sys/types.h>
#include <sys/socket.h>
#include <netinet/in.h>

static struct ev_loop *loop;
static ev_timer timeout_watcher;
static ev_io in_watcher, out_watcher;
static ev_idle idle_watcher;
static int sock_fd;

// socket input watcher
static void in_cb(EV_P_ ev_io *watcher, int revents) {
    int r, t;
    char buf[1024];
    for (t = 0; (r = read(sock_fd, buf, sizeof(buf))) > 0;) {
        t += r;
        write(STDOUT_FILENO, buf, r); // copy input to stdout
        if (buf[r-1] == '\n') break; // operate line-at-a-time
    }
    fprintf(stderr, "in: count = %d\n", t);
    if (r == 0) {
        fputs("in: connection closed\n", stderr);
        ev_io_stop(loop, &in_watcher); // stop the socket watcher
        ev_break(loop, EVBREAK_ALL); // exit the loop
    } else if (r < 0) {
        perror("read");
    }
}

// socket output watcher
static void out_cb(EV_P_ ev_io *watcher, int revents) {
    int r, t, lim;
    char buf[1024];
    ev_io_stop(loop, &out_watcher);
    for (t = 0; t < sizeof(buf); t++) {
        buf[t] = 'a' + (rand() % 26);
    }
    for (t = 0, lim = rand() % 10000 + 1000;
            (r = write(sock_fd, buf, (lim - t > sizeof(buf)) ? sizeof(buf) : lim - t)) > 0;) {
        t += r;
        if (t >= lim) break;
    }
    if (r < 0) {
        perror("write");
    }
    fprintf(stderr, "out: finished sending, count = %d\n", t);
}

static void timeout_cb(EV_P_ ev_timer *watcher, int revents) {
    fprintf(stderr, "timeout: now = %f\n", ev_now(loop));
    // send a bunch of stuff on the socket when able
    ev_io_start (loop, &out_watcher);
}

static void idle_cb(EV_P_ ev_idle *watcher, int revents) {
    static long idle_count = 0;
    fprintf(stderr, "idle: count = %ld\n", ++idle_count);
    sleep(1); // simulate doing stuff
}

int main() {

    extern int errno;

    int master_fd;
    int sock_opt = 1;
    int conn_port = 7000;
    struct sockaddr_in addr;
    socklen_t addrlen;

    // **** the following is needed to set up a socket to receive data ****
    master_fd = socket(AF_INET, SOCK_STREAM, 0);
    if (master_fd == -1) {
        perror("socket");
        return errno;
    }
    if (setsockopt(master_fd, SOL_SOCKET, SO_REUSEADDR, (char *) &sock_opt, sizeof(sock_opt)) == -1) {
        perror("setsockopt");
        return errno;
    }
    addr.sin_family = AF_INET;
    addr.sin_addr.s_addr = INADDR_ANY;
    addr.sin_port = htons(conn_port);
    addrlen = sizeof(addr);
    if (bind(master_fd, (struct sockaddr *) &addr, addrlen) != 0) {
        perror("bind");
        return errno;
    }
    if (listen(master_fd, 3) != 0) {
        perror("listen");
        return errno;
    }

    fprintf(stderr, "awaiting a connection on port %d\n", conn_port);
    sock_fd = accept(master_fd, (struct sockaddr *) &addr, &addrlen);
    if (sock_fd == -1) {
        perror("accept");
        return errno;
    }
    fputs("in: connection established\n", stderr);
    // **** end of socket setup code ****

    // define a loop
    loop = ev_default_loop(0);

    // define a repeating timer
    ev_timer_init (&timeout_watcher, timeout_cb, 5.0, 5.0);
    ev_timer_start (loop, &timeout_watcher);

    // define an idle process
    ev_idle_init(&idle_watcher, idle_cb);
    ev_idle_start (loop, &idle_watcher);

    // define the socket data receiver
    ev_io_init(&in_watcher, in_cb, sock_fd, EV_READ);
    ev_io_start (loop, &in_watcher);

    // define the socket data write complete watcher
    ev_io_init(&out_watcher, out_cb, sock_fd, EV_WRITE);

    // run the loop
    ev_run(loop, 0);

    // clean up
    close(sock_fd);
    close(master_fd);
    return 0;
} 
```

# ruby-on-rails - 在 Ruby 中拆分数组

> ID：15823088
> 
> 赞同：0
> 
> 时间：2013-04-04T22:51:28.120
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, mysql2

我在我的 ruby​​ 文件中从数据库中获取一些数据，如下所示：

```
@main1= $connection.execute("SELECT * FROM builds 
                WHERE   platform_type LIKE 'TOTAL';")

@main2= $connection.execute("SELECT * FROM builds 
                WHERE   platform_type NOT LIKE 'TOTAL';") 
```

在这样做之后，我正在对这些结果执行散列和一堆其他的东西。需要明确的是，这不会返回一个数组，而是返回一些 mysql2 类型的对象。所以我只是将它映射到 2 个数组以确保安全：

```
@arr1 = Array.new
@arr1 = @main1.map

@arr2 = Array.new
@arr2 = @main2.map 
```

有没有办法通过只执行一个查询来避免执行 2 个不同的查询并在 2 个不同的数组中获取所有结果。我基本上想将结果分成 2 个数组，第一个具有 platform_type = TOTAL 和其他所有内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T02:50:01.483

同样，在不了解您为什么要这样做的情况下，我会这样使用[Enumerable#partition](http://ruby-doc.org/core-2.0/Enumerable.html#method-i-partition)：

```
rows = $connection.execute('SELECT * FROM builds')
like_total, not_like_total = rows.partition { |row|
  row['platform_type'] =~ /TOTAL/
} 
```

请注意，IIRC，SQL`LIKE 'TOTAL'`与 Ruby 的不同`"string" =~ /TOTAL/`（这更像是SQL——`LIKE '%TOTAL%'`我不确定你需要什么）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T23:22:03.393

要回答您的问题而不深入了解您为什么这样做：

使用额外的条件在一个查询中将它们全部返回，然后您可以使用 group_by 对它们进行分组：

`all_results = $connection.execute("SELECT *, platform_type LIKE 'TOTAL' as is_like_total FROM builds").`

这将为您的每个结果提供一个“is_like_total”“列”，您可以对其进行分组。

[http://ruby-doc.org/core-2.0/Enumerable.html#method-i-group_by](http://ruby-doc.org/core-2.0/Enumerable.html#method-i-group_by)

# jsf-2 - 带有 PrimeFaces 3.5 的 JSF2.0 中 ManagedBean 的自定义范围

> ID：15823089
> 
> 赞同：0
> 
> 时间：2013-04-04T22:51:35.190
> 
> 标签：jsf-2, primefaces

以下是我的要求- ![在此处输入图像描述](https://i.stack.imgur.com/xI6DL.png)

在这里，我有一个`p:panelGrid`可以添加和删除表格行的。网格包含一些`p:inputText`和各种其他 PrimeFaces 组件以及`p:fileUpload`每行中的一个组件。组件`p:fileUpload`设置了`mode="advanced" auto="true"`属性，上传成功后自动上传文件并隐藏自身。

整体`p:panelGrid`在`@ViewScoped`，因此工作正常。我保留了`p:fileUpload`组件，`@RequestScoped`因为对于每个上传请求，它都必须上传文件，但是在添加新行之后，以前的状态不再保留。所以`p:fileUpload`在前面的行中也开始可见。那是我不想要的。我需要为它编写任何自定义范围吗？下面是视图-|

```
<h:form>
    <p:panel id="agentForm" header="#{msg.AGENTS_INFORMATION}"
        style="overflow:auto;  margin-bottom: 2px">
        <div align="center" style="margin-top: 20px; margin-bottom: 2px">
            <ui:repeat value="#{agent.scenarioList}" var="c">
                <p:panelGrid>
                    <p:row>
                        <p:column>
                            <p:inputText id="ipaddress" value="#{c.machineIpAddress}"
                                style="width:90%">
                                <p:watermark for="ipaddress" value="#{msg.MACHINE_IP_ADDRESS}" />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:inputText id="username" value="#{c.machineUsername}"
                                style="width:90%">
                                <p:watermark for="username" value="#{msg.MACHINE_USERNAME}" />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:password id="passwd" value="#{c.machinePassword}">
                                <p:watermark for="passwd" value="#{msg.MACHINE_PASSWORD}" />
                            </p:password>
                        </p:column>
                        <p:column id="fileUpload">
                            <p:fileUpload rendered="#{!fileUploadController.hidden}"
                                label="Upload Script" style="font-size: 100% !important;"
                                showButtons="false"
                                fileUploadListener="#{fileUploadController.upload}"
                                mode="advanced" auto="true" sizeLimit="100000"
                                allowTypes="/(\.|\/)(py|txt)$/"
                                update="fileUpload, outPanel, :message" />
                            <p:outputPanel id="outPanel">
                            <!-- Below outputLabel will be linked to uploaded file, so that User can see the file -->
                            <p:outputLabel style="cursor: pointer" value="View uploded Script"
                                    label="View Script" rendered="#{fileUploadController.hidden}" />
                            </p:outputPanel>
                        </p:column>
                        <p:column>
                            <p:inputText id="testname" value="#{c.testName}"
                                style="width:90%">
                                <p:watermark for="testname" value="#{msg.TEST_NAME}" />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:spinner id="threads" value="#{c.threads}" min="1" max="500"
                                size="8">
                                <p:tooltip for="threads" value="#{msg.TEST_NAME}"
                                    showEffect="slide" hideEffect="slide" />
                            </p:spinner>
                        </p:column>
                        <p:column>
                            <p:selectBooleanCheckbox id="chkSelected" value="#{c.selected}">
                                <p:tooltip for="chkSelected" value="#{msg.CHECKBOX}"
                                    showEffect="slide" hideEffect="slide" />
                            </p:selectBooleanCheckbox>
                        </p:column>
                    </p:row>
                </p:panelGrid>
            </ui:repeat>
            <p:toolbar style="margin-top: 10px;">
                <p:toolbarGroup align="right">
                    <p:commandButton value="#{msg.ADD_IT}"
                        update=":message, agentForm"
                        actionListener="#{agent.addComponent()}" />
                    <p:commandButton value="#{msg.DELETE_IT}"
                        update=":message, agentForm"
                        actionListener="#{agent.deleteComponent()}" />
                </p:toolbarGroup>
            </p:toolbar>
        </div>
    </p:panel>
</h:form> 
```

我的托管 bean`@ViewScoped`看起来像这样-

```
import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;
import javax.annotation.PostConstruct;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.ViewScoped;
import org.ravij.performance.model.Scenario;
@ManagedBean(name = "agent")
@ViewScoped
public class AgentInfo implements Serializable {
    private static final long serialVersionUID = 1L;
    List<Scenario> scenarioList;
    @PostConstruct
    public void initBean() {
        this.scenarioList = new ArrayList<Scenario>();
        this.scenarioList.add(new Scenario());
    }
    public void addComponent() {
        if (this.scenarioList != null) {
            this.scenarioList.add(new Scenario());
        } else {
            this.initBean();
        }
    }
    public void deleteComponent() {
        List<Scenario> itemsToDelete = new ArrayList<Scenario>();
        if (this.scenarioList != null) {
            for (Scenario b : this.scenarioList) {
                if (b.isSelected()) {
                    itemsToDelete.add(b);
                }
            }
            this.scenarioList.removeAll(itemsToDelete);
        }
    }
    public List<Scenario> getScenarioList() {
        return scenarioList;
    }
    public void setScenarioList(List<Scenario> scenarioList) {
        this.scenarioList = scenarioList;
    }
} 
```

Scenario 对象包含一行的所有信息。下面是代码-

```
package org.ravij.performance.model;
import java.io.Serializable;
public class Scenario implements Serializable {
    private String machineIpAddress;
    private String machineUsername;
    private String machinePassword;
    private String uploadedFilePath;
    private String testName;
    private int threads = 1;
    private boolean selected = false;

    //Below are the getters and setter w.r.t all the above variables
    //I am not putting it, to make the code short
} 
```

托管 bean`FileUploadController`位于`@RequestScoped`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:47:22.177

您应该简单地将`hidden`属性与`@ViewScoped`bean 中的其他值保持一致。`hidden`您当前的代码具有与您的所有组件共享的单个属性，`<p:fileUpload`这可能不是您想要的。

该行为看起来不错，因为您只更新当前的`fileUpload`，但根据您的代码，所有其他`<p:fileUpload`组件都应该被隐藏。

您还应该将您的内容`<h:form`放入您`<ui:repeat`的文件中，以便您可以通过将索引（您可以从`<ui:repeat`using`varStatus`属性中获取）或任何其他标识符以匹配当前行隐藏输入。

`#{fileUploadController.upload}`获取隐藏参数的最简单方法是从此处获取响应：`FacesContext`如何[从 <ui:repeat> 中的 jsf 页面获取参数到 BackingBean](https://stackoverflow.com/questions/15821929/how-to-get-parametrs-to-backingbean-from-jsf-page-in-uirepeat/15822733#15822733)

**更新**

这比预期的要难一些，问题是`<p:fileUpload`它将以封闭的形式发送所有内容（没有尝试使用`process`属性），因此很难知道文件上传涉及哪一行。

另外，我不知道您不能放入`<h:form`您的`<ui:repeat`但删除按钮的行为是阻塞的，因为它希望以一种形式获得所有内容。

我使用对话框制作了一个工作 POC，将文件上传放在外面，方法如下：

琐碎的 Scenario.java ：

```
public class Scenario implements Serializable {

    private String machineIpAddress;
    private String machineUsername;
    private String machinePassword;
    private String uploadedFilePath;
    private String testName;
    private int threads = 1;
    private boolean selected = false;
    private boolean hidden = false; // This is new

    // + Getters/Setters
} 
```

AgentInfo.java 中的一些更改：

```
@ManagedBean(name = "agent")
@ViewScoped
public class AgentInfo implements Serializable {

    private List<Scenario> scenarioList;

    private Scenario currentScenario; // This is new

    // I removed the @PostConstruct which I rarely use

    public void addComponent() {
        if (this.scenarioList != null) {
            this.scenarioList.add(new Scenario());
        }
    }

    public void deleteComponent() {
        if (this.scenarioList == null) {
            return;
        }

        List<Scenario> itemsToDelete = new ArrayList<Scenario>();

        for (Scenario scenario : this.scenarioList) {
            if (scenario.isSelected()) {
                itemsToDelete.add(scenario);
            }
        }

        this.scenarioList.removeAll(itemsToDelete);
    }

    // This is new, it must be called before opening the upload dialog
    // in order to keep a pointer on the current scenario you are working on
    public void prepareUpload(Scenario scenario) {
        this.currentScenario = scenario;
    }

    // I put the upload method here
    public void upload(FileUploadEvent event) {
        // Do what you need to do here
        this.currentScenario.setHidden(true);
        RequestContext.getCurrentInstance().execute("uploadDialogWidget.hide()");
    }

    public List<Scenario> getScenarioList() {
        if (this.scenarioList == null) {
            this.scenarioList = new ArrayList<Scenario>();
            this.scenarioList.add(new Scenario());
        }

        return scenarioList;
    }

    public void setScenarioList(List<Scenario> scenarioList) {
        this.scenarioList = scenarioList;
    }

    public Scenario getCurrentScenario() {
        return currentScenario;
    }

    public void setCurrentScenario(Scenario currentScenario) {
        this.currentScenario = currentScenario;
    }
} 
```

最大的变化是在视图中，我`<h:commandButton`在表单中放了一个打开对话框。我还添加了对话框，并`redisplay`为您的密码字段添加了属性（如果您想在提交表单后保留该值，这是必需的）。请注意，我删除了对`message`未提供 id 的组件的引用，不要忘记重新引入它。.xhtml ：

```
<h:form id="agentForm">
    <p:panel header="#{msg.AGENTS_INFORMATION}"
        style="overflow:auto;  margin-bottom: 2px">
        <div align="center" style="margin-top: 20px; margin-bottom: 2px">
            <ui:repeat value="#{agent.scenarioList}" var="c">
                <p:panelGrid>
                    <p:row>
                        <p:column>
                            <p:inputText id="ipaddress" value="#{c.machineIpAddress}"
                                style="width:90%">
                                <p:watermark for="ipaddress" value="#{msg.MACHINE_IP_ADDRESS}" />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:inputText id="username" value="#{c.machineUsername}"
                                style="width:90%">
                                <p:watermark for="username" value="#{msg.MACHINE_USERNAME}" />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:password id="passwd" value="#{c.machinePassword}" redisplay="true">
                                <p:watermark for="passwd" value="#{msg.MACHINE_PASSWORD}" />
                            </p:password>
                        </p:column>
                        <p:column id="fileUpload">
                            <p:commandButton icon="ui-icon-arrowthick-1-n" value="Upload"
                                             actionListener="#{agent.prepareUpload(c)}"
                                             update=":uploadDialog"
                                             oncomplete="uploadDialogWidget.show()"
                                             rendered="#{!c.hidden}" />
                            <p:outputPanel id="outPanel">
                            <!-- Below outputLabel will be linked to uploaded file, so that User can see the file -->
                            <p:outputLabel style="cursor: pointer" value="View uploded Script"
                                    rendered="#{c.hidden}" />
                            </p:outputPanel>
                        </p:column>
                        <p:column>
                            <p:inputText id="testname" value="#{c.testName}"
                                style="width:90%">
                                <p:watermark for="testname" value="#{msg.TEST_NAME}" />
                            </p:inputText>
                        </p:column>
                        <p:column>
                            <p:spinner id="threads" value="#{c.threads}" min="1" max="500"
                                size="8">
                                <p:tooltip for="threads" value="#{msg.TEST_NAME}"
                                    showEffect="slide" hideEffect="slide" />
                            </p:spinner>
                        </p:column>
                        <p:column>
                            <p:selectBooleanCheckbox id="chkSelected" value="#{c.selected}">
                                <p:tooltip for="chkSelected" value="#{msg.CHECKBOX}"
                                    showEffect="slide" hideEffect="slide" />
                            </p:selectBooleanCheckbox>
                        </p:column>
                    </p:row>
                </p:panelGrid>
            </ui:repeat>
            <p:toolbar style="margin-top: 10px;">
                <p:toolbarGroup align="right">
                    <p:commandButton value="#{msg.ADD_IT}" update="agentForm"
                                     actionListener="#{agent.addComponent()}" />
                    <p:commandButton value="#{msg.DELETE_IT}" update="agentForm"
                        actionListener="#{agent.deleteComponent()}" />
                </p:toolbarGroup>
            </p:toolbar>
        </div>
    </p:panel>
</h:form>
<p:dialog id="uploadDialog" widgetVar="uploadDialogWidget" header="File upload">
    <h:form rendered="#{!empty agent.currentScenario}">
        <p:fileUpload
            label="Upload Script" style="font-size: 100% !important;"
            showButtons="false"
            fileUploadListener="#{agent.upload}"
            mode="advanced" auto="true" sizeLimit="100000"
            allowTypes="/(\.|\/)(py|txt)$/"
            update=":agentForm">
        </p:fileUpload>
        <p:commandButton value="Cancel" onclick="uploadDialogWidget.hide();" onstart="return false;" />
    </h:form>
</p:dialog> 
```

您应该考虑从`<p:panelGrid`一个`<p:dataTable`具有内置机制来处理行选择的移动。

# c++ - 指针 & 将 char 数组转换为 int

> ID：15823093
> 
> 赞同：0
> 
> 时间：2013-04-04T22:51:43.043
> 
> 标签：c++, arrays, pointers, char, byte

我正在做一些练习来弄清楚如何在用指针更改数组中的值后访问它们。有人能指出为什么第一个输出没有显示所需的输出吗？我试图让两个 cout 都打印 1234，一个使用新指针，一个使用数组中的位置

```
int main()
{
    char myArray[50]={0};
    short* sizeOfAlloc=(short*)(myArray+5);  
         *sizeOfAlloc=1234;

    cout << (short*)(myArray+5) <<endl; 
    cout << *sizeOfAlloc <<endl;
    system("pause");

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T22:54:24.860

```
cout << (short*)(myArray+5) <<endl; 
```

打印指针。不是它所指向的值。

```
cout << *((short*)(myArray+5)) <<endl;
        ^^                   ^^ 
```

将打印指向的值`(short*)(myArray+5)`

# java - RSA - bouncycastle PEMReader 返回 PEMKeyPair 而不是 AsymmetricCipherKeyPair 以读取私钥

> ID：15823094
> 
> 赞同：7
> 
> 时间：2013-04-04T22:51:46.050
> 
> 标签：java, openssl, rsa, bouncycastle, private-key

我有一个函数可以成功读取 openssl 格式的私钥：

```
static AsymmetricKeyParameter readPrivateKey(string privateKeyFileName)
{
    AsymmetricCipherKeyPair keyPair;

    using (var reader = File.OpenText(privateKeyFileName))
        keyPair = (AsymmetricCipherKeyPair)new PemReader(reader).ReadObject();

    return keyPair.Private;
} 
```

并返回一个 AsymmetricKeyParameter，然后用它来解密一个加密的文本。

下面是解密代码：

```
public static byte[] Decrypt3(byte[] data, string pemFilename)
{
    string result = "";
    try {
        AsymmetricKeyParameter key = readPrivateKey(pemFilename);

        RsaEngine e = new RsaEngine();

        e.Init(false, key);
        //byte[] cipheredBytes = GetBytes(encryptedMsg);

        //Debug.Log (encryptedMsg);

        byte[] cipheredBytes = e.ProcessBlock(data, 0, data.Length);
        //result = Encoding.UTF8.GetString(cipheredBytes);
        //return result;
        return cipheredBytes;

    } catch (Exception e) {
        Debug.Log ("Exception in Decrypt3: " + e.Message);
        return GetBytes(e.Message);
    }
} 
```

这些使用充气城堡库在 C# 中工作，我得到了正确的解密文本。但是，当我将它添加到 Java 时，PEMParser.readObject() 返回一个 PEMKeyPair 类型的对象，而不是 AsymmetricCipherKeyPair，并且 java 抛出一个试图强制转换它的异常。我签入了 C#，它实际上返回了 AsymmetricCipherKeyPair。

我不知道为什么 Java 的行为不同，但我希望这里有人可以帮助如何转换这个对象或读取私钥文件并成功解密。我在 C# 和 Java 代码中使用了相同的公钥和私钥文件，所以我认为错误不是来自它们。

这里参考我如何读取私钥的Java版本：

```
public static String readPrivateKey3(String pemFilename) throws FileNotFoundException, IOException
{
    AsymmetricCipherKeyPair keyParam = null;
    AsymmetricKeyParameter keyPair = null;
    PEMKeyPair kp = null;
    //PrivateKeyInfo pi = null;

    try {
        //var fileStream = System.IO.File.OpenText(pemFilename);
        String absolutePath = "";
        absolutePath = Encryption.class.getProtectionDomain().getCodeSource().getLocation().getPath();
        absolutePath = absolutePath.substring(0, (absolutePath.lastIndexOf("/")+1));
        String filePath = "";
        filePath = absolutePath + pemFilename;

        File f = new File(filePath);
        //return filePath;

        FileReader fileReader  = new FileReader(f);
        PEMParser r = new PEMParser(fileReader);

        keyParam = (AsymmetricCipherKeyPair) r.readObject();

        return keyParam.toString();

    }
    catch (Exception e) {
        return "hello: " + e.getMessage() + e.getLocalizedMessage() + e.toString();
        //return e.toString();
        //return pi;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T09:19:21.373

Java 代码已更新为新的 API，尚未移植到 C#。您可以尝试等效的（但现在已弃用）Java PEMReader 类。不过，它将返回一个 JCE KeyPair（更改的部分原因是因为原始版本仅适用于 JCE 类型，而不适用于 BC 轻量级类）。

如果使用 PEMParser，并且您返回 PEMKeyPair，则可以使用 org.bouncycastle.openssl.jcajce.JcaPEMKeyConverter.getKeyPair 从中获取 JCE KeyPair。理想情况下会有一个 BCPEMKeyConverter，但它似乎还没有被编写。无论如何，制作 AsymmetricCipherKeyPair 应该很容易：

```
PEMKeyPair kp = ...;
AsymmetricKeyParameter privKey = PrivateKeyFactory.createKey(kp.getPrivateKeyInfo());
AsymmetricKeyParameter pubKey = PublicKeyFactory.createKey(kp.getPublicKeyInfo());
new AsymmetricCipherKeyPair(pubKey, privKey); 
```

这些工厂类位于 org.bouncycastle.crypto.util 包中。

# haskell - 匹配列表前两项的隐式模式

> ID：15823100
> 
> 赞同：0
> 
> 时间：2013-04-04T22:52:14.970
> 
> 标签：haskell

有没有办法以一种隐式的方式做到这一点：

`(originalPath:extractPath:ignoredArgs) <- getArgs`

考虑到我只需要前两个参数，并且无论如何都会忽略其他参数。

这只是一个好奇/探索/学习问题（刚从 Haskell 开始），`ignoredArgs`如果这样留下也无害。

我试过

`(originalPath:extractPath) <- getArgs`

但它失败了，因为`extractPath`将是`[String]`类型（而不是`String`）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T22:55:10.770

使用通配符，`_`

```
(originalPath:extractPath:_) <- getArgs 
```

忽略前两个参数之后的所有内容。

你需要有一些东西来让这两个名称绑定到`String`s，并且通配符模式（下划线）是告诉编译器和代码的人类读者你对进一步的参数不感兴趣的方式。

# php - javascript更改样式显示

> ID：15823102
> 
> 赞同：0
> 
> 时间：2013-04-04T22:52:18.583
> 
> 标签：php, javascript, html

我在 Google Chrome 中设置了一堆项目`<div id="first" class="source">` ，当页面加载时，当我单击 OnClick 按钮时它会隐藏这些项目，它会取消隐藏它们，但我无法再次单击它并使其隐藏。

HTML

```
<body onload="setup();">
<a  href="#first" onClick="shoh('first');" > 
```

JS：

```
function setup() {
  foo = document.getElementById('first');
  foo = document.getElementsByClassName('source');
  for (c=0; c<foo.length; c++) {
    foo[c].style.display='none'
  }
}

function shoh(id) {
  if (document.getElementById(id).style.display = 'none'){
    var divs = document.getElementById(id);
    for(var i=0; i<divs.length; i++) { 
      divs[i].style.display='block'
    }
  } else {
    cow = document.getElementById(id);
    for(a=0; a<cow.length; a++) { 
      cow[a].style.display='none'
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T22:55:46.663

您的条件没有进行比较。你需要改变

```
if (document.getElementById(id).style.display = 'none'){ 
```

到

```
if (document.getElementById(id).style.display == 'none'){ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T22:58:24.693

你有几个问题：

如果您比较需要使用的两个变量`==`，那么它应该是：

```
document.getElementById(id).style.display == 'none' 
```

此外，您正在使用`getElementById`，它返回单个节点，而不是数组。因此，您不应遍历返回的值：

```
var div = document.getElementById(id);
div.style.display='block'; 
```

所以最后，它应该是这样的：

```
function shoh(id) {
  if (document.getElementById(id).style.display == 'none'){
    var div = document.getElementById(id);
    div.style.display='block';
  } else {
    cow = document.getElementById(id);
    cow.style.display='none';
  }
} 
```

# php - 如何将 HTML 表单中的值添加到数据库中的值

> ID：15823105
> 
> 赞同：0
> 
> 时间：2013-04-04T22:52:46.313
> 
> 标签：php, mysql

我正在尝试创建一个表单以允许用户将表单中的数据更新为数据库中的现有数量。这是我迄今为止所拥有的，它的价值似乎翻了一番。我在想我需要从数据库中提取值，然后从表单中添加数据。

```
<?php 
$username = "username";
$password = "password";
$hostname = "localhost";

//connection to the database
$dbhandle = mysql_connect($hostname, $username, $password)
 or die("Unable to connect to MySQL");
echo "<font face=tahoma color=#ff000><b>Connected to MySQL</b></font><br><br>";

//select a database to work with
$selected = mysql_select_db("pdogclan_points",$dbhandle)
  or die("Did this change");

// Formulate Query
$_POST["filter"];
$memid = mysql_real_escape_string($_POST["Member_ID"]);
$query = sprintf("SELECT Member_ID, Bank, Reward_1, Reward_2, Reward_3 FROM Points_Rewards WHERE Member_ID = '$memid'") or die("Could Not Formulate the Query");

//execute the SQL query and return records
$result = mysql_query($query);

// Check result
// This shows the actual query sent to MySQL, and the error. Useful for debugging.
if (!$result) {
    $message  = 'Invalid query: ' . mysql_error() . "\n";
   $message .= 'Whole query: ' . $query;
    die($message);
}

//fetch tha data from the database
while ($row = mysql_fetch_array($result))   
echo "<table width=750 cellspacing=2 cellpadding=2 border=2>
        <tr>
            <td bgcolor=#000000 width=150><font face=tahoma color=white>ID: {$row['Member_ID']}</font></td>". 
            "<td width=150><font face=tahoma>Bank: {$row['Bank']}</td>". 
            "<td width=150><font face=tahoma>Reward 1: {$row['Reward_1']}</td>". 
            "<td width=150><font face=tahoma>Reward 2: {$row['Reward_2']}</td> ". 
            "<td width=150><font face=tahoma>Reward 3: {$row['Reward_3']}</td>
        </tr>
  </table><br></font>";//display the results
// Formulate Update Query
$_POST["submit"];
$memid = mysql_real_escape_string($_POST["Member_ID"]);
$query = sprintf("SELECT Member_ID, Bank, Reward_1, Reward_2, Reward_3 FROM Points_Rewards WHERE Member_ID = '$memid'") or die("Could Not Formulate the Query");

while ($row = mysql_fetch_array($result))
{
$bankdb = $row['Bank'];
$reward1db = $row['Reward_1'];
$reward2db = $row['Reward_2'];
$reward3db = $row['Reward_3'];
}
echo $bank;
echo $reward1;
echo $reward2;
echo $reward3;
$memid = mysql_real_escape_string($_POST["Member_ID"]);
$bank = $_POST['bank'];
$reward1 = $_POST['reward1'];
$reward2 = $_POST['reward2'];
$reward3 = $_POST['reward3'];

$query = "UPDATE Points_Rewards Set Bank = ('$bank' + '$bankdb'), Reward_1 =    ('$reward1' + '$reward1'), Reward_2 = ('$reward2' + '$reward2'), Reward_3 = ('$reward3' + '$reward3') WHERE Member_ID = '$memid'";
$result = mysql_query($query) or die(mysql_error());

if(mysql_query($query)){
echo "updated";}
else{
echo "fail";}

//close the connection
mysql_close($dbhandle);
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:12:34.950

只需使用基本 HTML 创建一个表单，将您从数据库中获取的数据存储在 PHP 变量中，然后使用 PHP 标签显示该数据，如下所示：

```
<form action="..." method="post" >
<?php
$memid = mysql_real_escape_string($_POST["Member_ID"]);
$query = sprintf("SELECT Member_ID, Bank, Reward_1, Reward_2, Reward_3 FROM Points_Rewards WHERE Member_ID = '$memid'") or die("Could Not Formulate the Query");

while ($row = mysql_fetch_array($result))
{
?>
<input type="text" name="r1" value="<?php echo $row['Reward_1']; ?>" /> ;
<input type="text" name="r2" value="<?php echo $row['Reward_2']; ?>" /> ;
<input type="text" name="r3" value="<?php echo $row['Reward_3']; ?>" /> ;
...    
<?php 
}
?>   

...
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:24:05.307

这是结构

```
 // if a form is submitted
 if(isset($_POST['submit'])) {
 $memid = $_POST["Member_ID"];

 //SELECT or INSERT or UPDATE your DATABASE. Yes use PDO and prepared statements.
$query = $dbh->prepare("SELECT Member_ID, Bank, Reward_1, Reward_2, Reward_3 FROM Points_Rewards WHERE Member_ID = '$memid'")

//don't forget to bind parameters
$sth->bindParam(':memid', $memid, PDO::PARAM_INT);
$sth->execute(...);

//the loop
while ($row = $sth->fetch(PDO::FETCH_ASSOC)) {
echo '';
}

//close the if statement
}

//write the form
<form method="post"/>
<input name="Member_ID" type="text" required/>
<input name="submit" type="submit" value="submit" />
</form> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T23:10:38.890

您可以在 SQL 中的表值上使用运算符 - 它看起来像这样：

```
$query = "UPDATE Points_Rewards Set Bank = (Bank + '$bankdb'), Reward_1 =    (Reward_1 + '$reward1'), Reward_2 = (Reward_2 + '$reward2'), Reward_3 = (Reward_3 + '$reward3') WHERE Member_ID = '$memid'"; 
```

# algorithm - 具有奇数参与者的每周小组分配算法

> ID：15823106
> 
> 赞同：1
> 
> 时间：2013-04-04T22:52:51.040
> 
> 标签：algorithm, combinatorics

[我之前提出](https://stackoverflow.com/questions/15273249/weekly-group-assignment-algorithm)的问题有一个循环解决方案。它适用于偶数人，但一旦您实施算法并尝试它们，这些建议似乎都不起作用。我尝试了很多变化并且（将最后一个与一大堆其他人分组，第二组最后一组，不同的组合，2和4到最后一行的最后一个，我认为这会给我最多最佳解决方案，但仍有许多重复项）。有人可以建议一种方法，或者证明如果没有 2 个人多次合作就不可能有解决方案，这样我就可以停止尝试让它发挥作用。如果您想要java中的算法，我可以发布它，以便您可以使用它。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T04:47:07.960

23 名学生 2 人一组，1 人 3 人一组，为期 14 周，这对本地搜索能够找到解决方案的要求并不高。

```
 18  1 11|  3  4|  5  7|  9  6|  0 17|  2 12| 10 19| 15 16| 21  8| 14 20| 13 22|
  6 13 18| 17  4|  5  0| 20  1| 12 11| 10  9|  2 14| 15  7|  3  8| 19 16| 21 22|
 21 17  7| 19 22|  3  1|  2  8|  0 10| 14 12| 13 11|  6 16|  5 15| 18 20|  9  4|
  8  1 13| 18  2|  6 11| 20  0| 12 10| 14 15|  5 17|  9 21|  4 19|  3 22| 16  7|
  0  4 16| 17 20| 21  3|  7 18| 13 19|  1  5|  9 11| 15  2| 14  8| 10  6| 12 22|
 12  1 17| 15  4|  8  6| 16 18|  9  0| 11 22|  5 14|  3  2|  7 13| 19 20| 21 10|
  4  1 22| 12  8| 15  6|  7  0|  9 17| 11  3| 13  2|  5 18| 10 14| 19 21| 20 16|
  0  1  6| 13 21| 15 12| 17  8| 20 10| 11  4|  3 14|  5 16|  7  2| 19  9| 18 22|
 13 16  3|  2  9| 11 20|  6 17| 22 10|  5 12|  0 14| 15  1|  8 18| 19  7| 21  4|
 14  1  7|  2  4|  5  9|  3  6|  8 10| 13 12| 21  0| 17 16| 22 20| 19 18| 11 15|
 14 18 21| 12  4|  5  6|  2 19|  8 20|  1  9| 13  0| 11 16| 17 15|  3 10|  7 22|
 21  6  2|  3 20|  5 13| 16  8| 18 17|  0 12| 22 14| 10  1|  9 15|  7  4| 11 19|
  0 11  2|  6  4| 16 14|  7  8| 17 10|  1 19| 13  9|  3 18| 21 12| 20  5| 15 22|
  1 16  2| 14 13|  3  7|  8  4| 11 10|  9 12|  0 18| 15 19| 17 22|  6 20| 21  5| 
```

这是制作它的Java代码。

```
public class Schedule {
  private final int weekCount;
  private final int groupCount;
  private final int personCount;
  private final int groupFirstSlot[];
  private final int weekSlotPerson[][];

  public Schedule(int weekCount, int groupCount, int personCount) {
    this.weekCount = weekCount;
    this.groupCount = groupCount;
    this.personCount = personCount;
    int remainingPersonCount = personCount;
    this.groupFirstSlot = new int[groupCount + 1];
    for (int remainingGroupCount = groupCount;
         remainingGroupCount > 0;
         remainingGroupCount--) {
      groupFirstSlot[remainingGroupCount] = remainingPersonCount;
      remainingPersonCount -= remainingPersonCount / remainingGroupCount;
    }
    this.weekSlotPerson = new int[weekCount][personCount];
    for (int week = 0; week < weekCount; week++) {
      for (int person = 0; person < personCount; person++) {
        weekSlotPerson[week][person] = person;
      }
    }
  }

  public int getWeekCount() {
    return weekCount;
  }

  public int getGroupCount() {
    return groupCount;
  }

  public int getPersonCount() {
    return personCount;
  }

  public int getGroupFirstSlot(int group) {
    return groupFirstSlot[group];
  }

  public int getWeekSlotPerson(int week, int slot) {
    return weekSlotPerson[week][slot];
  }

  public void swapWeekSlotPerson(int week, int slotOne, int slotTwo) {
    int temp = weekSlotPerson[week][slotOne];
    weekSlotPerson[week][slotOne] = weekSlotPerson[week][slotTwo];
    weekSlotPerson[week][slotTwo] = temp;
  }

  public int getConflictCount() {
    int pairCount[][] = new int[personCount][personCount];
    for (int week = 0; week < weekCount; week++) {
      for (int group = 0; group < groupCount; group++) {
        for (int slotOne = groupFirstSlot[group];
             slotOne < groupFirstSlot[group + 1];
             slotOne++) {
          int personOne = weekSlotPerson[week][slotOne];
          for (int slotTwo = groupFirstSlot[group];
               slotTwo < groupFirstSlot[group + 1];
               slotTwo++) {
            int personTwo = weekSlotPerson[week][slotTwo];
            pairCount[personOne][personTwo]++;
          }
        }
      }
    }
    int conflictCount = 0;
    for (int personOne = 0; personOne < personCount; personOne++) {
      for (int personTwo = personOne + 1;
           personTwo < personCount;
           personTwo++) {
        int pc = pairCount[personOne][personTwo];
        conflictCount += pc * (pc - 1) / 2;
      }
    }
    return conflictCount;
  }

  public static void main(String[] args) {
    Schedule sched = new Schedule(14, 11, 23);
    java.util.Random rand = new java.util.Random();
    int oldCc = sched.getConflictCount();
    while (oldCc > 0) {
      int week = rand.nextInt(sched.getWeekCount());
      int slotOne = rand.nextInt(sched.getPersonCount());
      int slotTwo = rand.nextInt(sched.getPersonCount());
      sched.swapWeekSlotPerson(week, slotOne, slotTwo);
      int newCc = sched.getConflictCount();
      if (newCc < oldCc) {
        oldCc = newCc;
      } else {
        sched.swapWeekSlotPerson(week, slotOne, slotTwo);
      }
    }
    for (int week = 0; week < sched.getWeekCount(); week++) {
      for (int group = 0; group < sched.getGroupCount(); group++) {
        for (int slot = sched.getGroupFirstSlot(group);
             slot < sched.getGroupFirstSlot(group + 1);
             slot++) {
          System.out.printf("%3d",
                            sched.getWeekSlotPerson(week, slot));
        }
        System.out.print('|');
      }
      System.out.println();
    }
  }
} 
```

# python - u 字符出现在 python 的正则表达式中

> ID：15823107
> 
> 赞同：-6
> 
> 时间：2013-04-04T22:52:55.853
> 
> 标签：python, regex

我有几行代码可以从 pdf 文件中提取电子邮件地址。

```
 for page in pdf.pages:
      pdf = page.extractText()
      # print elpdf
      r = re.compile(r'[\w\-][\w\-\.]+@[\w\-][\w\-\.]+[a-zA-Z]{1,4}')
      results = r.findall(pdf)
      Listemail.append(results)
      print(Listemail[0:])
 pdf.stream.close() 
```

不幸的是，在运行代码后，我注意到结果并不完全好，因为每次找到匹配项时它都会出现一个 'u' 字符：

```
[[u'testuser1@training.local']]
[[u'testuser2@training.local']] 
```

有人知道如何避免该角色出现吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:56:04.280

这不是问题。`u`前面的字符串只是表明它是一个 Python字符串`unicode`。[请参阅本文档。](http://docs.python.org/2/howto/unicode.html)除非您对他们做任何疯狂的事情，出于某种原因要求您的字符串不是 unicode，否则我不明白这可能是一个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:55:53.237

这些是[unicode 字符串](http://docs.python.org/2.7/tutorial/introduction.html#unicode-strings)，除非你有一些真正的问题，否则你不需要避免它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T00:07:02.840

正如其他人所指出的，这不是错误，而是一项功能。

如果您想要的是非 unicode 编码的字符串，您可以将文本从 unicode 转换为更可口的内容。这个 StackOverflow Q/A 涵盖了这个主题：

[将 Unicode 字符串转换为 Python 中的字符串（包含额外符号）](https://stackoverflow.com/questions/1207457/convert-unicode-to-string-in-python-containing-extra-symbols)

我之前遇到过这种情况，在某些用例中，它可能会出现问题，因为您随后会遇到方法需要非 unicode 字符串并中断的问题。:)

该链接的示例解决方案：

```
>>> a=u'aaa'
>>> a
u'aaa'
>>> a.encode('ascii','ignore')
'aaa'
>>> a.encode('utf8','ignore')
'aaa'
>>> str(a)
'aaa'
>>> 
```

# hibernate - EJB - 无法解析配置：hibernate.cfg.xml

> ID：15823114
> 
> 赞同：0
> 
> 时间：2013-04-04T22:53:29.677
> 
> 标签：hibernate, jboss, ejb

这是我在这里的第一个问题，我也是休眠的新手，所以如果我的问题不应该在这里发布，请原谅我。

我知道，论坛充满了我的问题，并且有不同的答案，但我无法解决问题。

我尝试部署一个包含 EJB 项目和 WEB 项目的 EAR。EJB 项目有一个尝试初始化休眠的 bean，但我总是遇到同样的错误。我使用 jboss 7.1.1。

如果我将所有与休眠和数据库相关的类移动到 WEB 项目，那么一切正常，我可以访问数据库。相同`hibernate.cfg.xml`，相同的 java 包和类。

请看一下我的 hibernate.cfg.xml 并请指教。提前致谢。

**休眠.cfg.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE hibernate-configuration PUBLIC
"-//Hibernate/Hibernate Configuration DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
    <session-factory>
        <property name="hibernate.bytecode.use_reflection_optimizer">false</property>
        <property name="hibernate.connection.driver_class">org.postgresql.Driver</property>
        <property name="hibernate.connection.password">jboss</property>
        <property name="hibernate.connection.url">jdbc:postgresql://serveraddress:5432/szokartya</property>
        <property name="hibernate.connection.username">jboss</property>
        <property name="hibernate.dialect">org.hibernate.dialect.PostgreSQLDialect</property>
        <property name="hibernate.search.autoregister_listeners">false</property>
        <property name="hibernate.current_session_context_class">thread</property>
        <property name="hibernate.c3p0.min_size">5</property>
        <property name="hibernate.c3p0.max_size">20</property>
        <property name="hibernate.c3p0.timeout">300</property>
        <property name="hibernate.c3p0.max_statements">50</property>
        <property name="hibernate.c3p0.idle_test_period">3000</property>
        <mapping class="hibernate.pojo.Users" />
    </session-factory>
</hibernate-configuration>` 
```

我的休眠工具：

```
public class HibernateUtil {

    private static final SessionFactory sessionFactory = buildSessionFactory();

    private static SessionFactory buildSessionFactory() {
        try {
            //Create the SessionFactory from hibernate.cfg.xml
            return new Configuration().configure().buildSessionFactory();

        } catch (Throwable ex) {
            // Make sure you log the exception, as it might be swallowed 
            System.err.println("Initial SessionFactory creation failed." + ex);
            throw new ExceptionInInitializerError(ex);
        }
    }

    public static SessionFactory getSessionFactory() {
        return sessionFactory;
    }   
} 
```

输出：

```
00:44:46,164 INFO  [org.hibernate.cfg.Configuration] (http-localhost-127.0.0.1-8080-3) HHH000043: Configuring from resource: /hibernate.cfg.xml
00:44:46,165 INFO  [org.hibernate.cfg.Configuration] (http-localhost-127.0.0.1-8080-3) HHH000040: Configuration resource: /hibernate.cfg.xml
00:44:46,168 ERROR [stderr] (http-localhost-127.0.0.1-8080-3) Initial SessionFactory creation failed.org.hibernate.HibernateException: Could not parse configuration: /hibernate.cfg.xml

00:44:46,169 ERROR [org.jboss.ejb3.invocation] (http-localhost-127.0.0.1-8080-3) JBAS014134: EJB Invocation failed on component PersistenceHandlerBean for method public abstract java.lang.String com.envinnotics.szokartya.ejb.beans.PersistenceHandler.sayHello(java.lang.String): javax.ejb.EJBException: Unexpected Error
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.handleExceptionInOurTx(CMTTxInterceptor.java:163) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.invokeInOurTx(CMTTxInterceptor.java:230) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.required(CMTTxInterceptor.java:304) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.processInvocation(CMTTxInterceptor.java:190) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.component.interceptors.CurrentInvocationContextInterceptor.processInvocation(CurrentInvocationContextInterceptor.java:41) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.component.interceptors.LoggingInterceptor.processInvocation(LoggingInterceptor.java:59) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.NamespaceContextInterceptor.processInvocation(NamespaceContextInterceptor.java:50) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.component.interceptors.AdditionalSetupInterceptor.processInvocation(AdditionalSetupInterceptor.java:32) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.TCCLInterceptor.processInvocation(TCCLInterceptor.java:45) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.ViewService$View.invoke(ViewService.java:165) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ee.component.ViewDescription$1.processInvocation(ViewDescription.java:173) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.ProxyInvocationHandler.invoke(ProxyInvocationHandler.java:72) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at com.envinnotics.szokartya.ejb.beans.PersistenceHandler$$$view35.sayHello(Unknown Source) [SzokartyaEJB.jar:]
    at servlets.Start.doGet(Start.java:47)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:734) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)
    at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671)
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930)
    at java.lang.Thread.run(Unknown Source) [rt.jar:1.7.0_17]
Caused by: java.lang.ExceptionInInitializerError
    at com.envinnotics.szokartya.ejb.hibernateutil.HibernateUtil.buildSessionFactory(HibernateUtil.java:22) [SzokartyaEJB.jar:]
    at com.envinnotics.szokartya.ejb.hibernateutil.HibernateUtil.<clinit>(HibernateUtil.java:9) [SzokartyaEJB.jar:]
    at com.envinnotics.szokartya.ejb.beans.PersistenceHandlerBean.createAndStoreEvent(PersistenceHandlerBean.java:51) [SzokartyaEJB.jar:]
    at com.envinnotics.szokartya.ejb.beans.PersistenceHandlerBean.sayHello(PersistenceHandlerBean.java:33) [SzokartyaEJB.jar:]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.7.0_17]
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) [rt.jar:1.7.0_17]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) [rt.jar:1.7.0_17]
    at java.lang.reflect.Method.invoke(Unknown Source) [rt.jar:1.7.0_17]
    at org.jboss.as.ee.component.ManagedReferenceMethodInterceptorFactory$ManagedReferenceMethodInterceptor.processInvocation(ManagedReferenceMethodInterceptorFactory.java:72) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.WeavedInterceptor.processInvocation(WeavedInterceptor.java:53) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.interceptors.UserInterceptorFactory$1.processInvocation(UserInterceptorFactory.java:36) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.jpa.interceptor.SBInvocationInterceptor.processInvocation(SBInvocationInterceptor.java:47)
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.InitialInterceptor.processInvocation(InitialInterceptor.java:21) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.interceptors.ComponentDispatcherInterceptor.processInvocation(ComponentDispatcherInterceptor.java:53) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.component.pool.PooledInstanceInterceptor.processInvocation(PooledInstanceInterceptor.java:51) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.invokeInOurTx(CMTTxInterceptor.java:228) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    ... 36 more
Caused by: org.hibernate.HibernateException: Could not parse configuration: /hibernate.cfg.xml
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2010) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1922) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1901) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at com.envinnotics.szokartya.ejb.hibernateutil.HibernateUtil.buildSessionFactory(HibernateUtil.java:16) [SzokartyaEJB.jar:]
    ... 58 more
Caused by: org.dom4j.DocumentException: org.dom4j.DocumentFactory cannot be cast to org.dom4j.DocumentFactory Nested exception: org.dom4j.DocumentFactory cannot be cast to org.dom4j.DocumentFactory
    at org.dom4j.io.SAXReader.read(SAXReader.java:484)
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2002) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    ... 61 more

00:44:46,211 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/Szokartya].[servlets.Start]] (http-localhost-127.0.0.1-8080-3) Servlet.service() for servlet servlets.Start threw exception: javax.ejb.EJBException: Unexpected Error
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.handleExceptionInOurTx(CMTTxInterceptor.java:163) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.invokeInOurTx(CMTTxInterceptor.java:230) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.required(CMTTxInterceptor.java:304) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.processInvocation(CMTTxInterceptor.java:190) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.component.interceptors.CurrentInvocationContextInterceptor.processInvocation(CurrentInvocationContextInterceptor.java:41) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.component.interceptors.LoggingInterceptor.processInvocation(LoggingInterceptor.java:59) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.NamespaceContextInterceptor.processInvocation(NamespaceContextInterceptor.java:50) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.component.interceptors.AdditionalSetupInterceptor.processInvocation(AdditionalSetupInterceptor.java:32) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.TCCLInterceptor.processInvocation(TCCLInterceptor.java:45) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.ViewService$View.invoke(ViewService.java:165) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.as.ee.component.ViewDescription$1.processInvocation(ViewDescription.java:173) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.ProxyInvocationHandler.invoke(ProxyInvocationHandler.java:72) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at com.envinnotics.szokartya.ejb.beans.PersistenceHandler$$$view35.sayHello(Unknown Source) [SzokartyaEJB.jar:]
    at servlets.Start.doGet(Start.java:47) [classes:]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:734) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.13.Final.jar:]
    at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.1.Final.jar:7.1.1.Final]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]
    at java.lang.Thread.run(Unknown Source) [rt.jar:1.7.0_17]
Caused by: java.lang.ExceptionInInitializerError
    at com.envinnotics.szokartya.ejb.hibernateutil.HibernateUtil.buildSessionFactory(HibernateUtil.java:22) [SzokartyaEJB.jar:]
    at com.envinnotics.szokartya.ejb.hibernateutil.HibernateUtil.<clinit>(HibernateUtil.java:9) [SzokartyaEJB.jar:]
    at com.envinnotics.szokartya.ejb.beans.PersistenceHandlerBean.createAndStoreEvent(PersistenceHandlerBean.java:51) [SzokartyaEJB.jar:]
    at com.envinnotics.szokartya.ejb.beans.PersistenceHandlerBean.sayHello(PersistenceHandlerBean.java:33) [SzokartyaEJB.jar:]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.7.0_17]
    at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source) [rt.jar:1.7.0_17]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source) [rt.jar:1.7.0_17]
    at java.lang.reflect.Method.invoke(Unknown Source) [rt.jar:1.7.0_17]
    at org.jboss.as.ee.component.ManagedReferenceMethodInterceptorFactory$ManagedReferenceMethodInterceptor.processInvocation(ManagedReferenceMethodInterceptorFactory.java:72) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.WeavedInterceptor.processInvocation(WeavedInterceptor.java:53) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.interceptors.UserInterceptorFactory$1.processInvocation(UserInterceptorFactory.java:36) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.jpa.interceptor.SBInvocationInterceptor.processInvocation(SBInvocationInterceptor.java:47)
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.InitialInterceptor.processInvocation(InitialInterceptor.java:21) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.invocation.ChainedInterceptor.processInvocation(ChainedInterceptor.java:61) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ee.component.interceptors.ComponentDispatcherInterceptor.processInvocation(ComponentDispatcherInterceptor.java:53) [jboss-as-ee-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.component.pool.PooledInstanceInterceptor.processInvocation(PooledInstanceInterceptor.java:51) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    at org.jboss.invocation.InterceptorContext.proceed(InterceptorContext.java:288) [jboss-invocation-1.1.1.Final.jar:1.1.1.Final]
    at org.jboss.as.ejb3.tx.CMTTxInterceptor.invokeInOurTx(CMTTxInterceptor.java:228) [jboss-as-ejb3-7.1.1.Final.jar:7.1.1.Final]
    ... 36 more
Caused by: org.hibernate.HibernateException: Could not parse configuration: /hibernate.cfg.xml
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2010) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1922) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at org.hibernate.cfg.Configuration.configure(Configuration.java:1901) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    at com.envinnotics.szokartya.ejb.hibernateutil.HibernateUtil.buildSessionFactory(HibernateUtil.java:16) [SzokartyaEJB.jar:]
    ... 58 more
Caused by: org.dom4j.DocumentException: org.dom4j.DocumentFactory cannot be cast to org.dom4j.DocumentFactory Nested exception: org.dom4j.DocumentFactory cannot be cast to org.dom4j.DocumentFactory
    at org.dom4j.io.SAXReader.read(SAXReader.java:484)
    at org.hibernate.cfg.Configuration.doConfigure(Configuration.java:2002) [hibernate-core-4.0.1.Final.jar:4.0.1.Final]
    ... 61 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T19:40:47.557

回答我的问题：问题是我在 hibernate.cfg.xml 中使用了 ansi 编码而不是 utf8。

# c# - 不使用大整数库的阶乘算法

> ID：15823115
> 
> 赞同：1
> 
> 时间：2013-04-04T22:53:33.903
> 
> 标签：c#, algorithm, biginteger, factorial

我正在学习计算机工程，我们有一项艰巨的任务。

我们必须开发一个 C# 应用程序，它可以在没有*BIGINT*的情况下计算非常大的数字的阶乘。我的意思是非常大的数字，比如*123564891...82598413！*. 而且我们不必使用自定义库（如*BIGINT*）的权限。

研究了一下，发现了一些这样的问题，但**这个问题与其他问题不同，因为**我们必须在*没有任何自定义库的情况下计算非常大的数字*。我找到[了PoorMans算法](http://www.luschny.de/math/factorial/csharp/FactorialPoorMans.cs.html)。但它的计算量高达 10000 。这对我们来说还不够。

和我的队友一起，我们找到了解决方案。假设我们将得到 123 的阶乘。我们将得到 123 作为 String 。然后，我们将求和 123 ， 122 次（等于 123 x 122）。然后将结果求和 121 次。它会一直这样直到达到 1。所以，我们将对两个字符串求和。

我们创建了一个对字符串求和的算法。我们将第一个数字（123 个中的 3 个）的最后一个字符作为整数（我们可以使用整数，但不能使用 bigint）。并将第二个数字的最后一个字符作为整数（122 中的 2）。将它们相加并找到结果编号的最后一个字符 (result = x...x5) 。我们将从最后一个字符到第一个字符进行操作。最后我们会得到*结果编号*。但是如你所知，我们应该使用 while() 或 for() 循环，而要使用这个循环，我们又需要 bigint。

```
String number = "9878945647978979798798797189"; //we will get factorial of this
for(int i = 0;i < number.Length; i++)
{
   // sum all chars one by one
} 
```

我们不能使用这样的循环，因为`i`变量将超出整数范围，我们会得到错误。所以我们必须在这里使用 bigint。我希望我解释了。

*现在我的问题*是，创建一个算法的演练，该算法可以在不使用 BIGINT 的情况下计算真正大数的阶乘。

这是程序员的问题，而不是 Math.stackexchange.com 的问题，因为我需要直接的编程答案和演练。如果我在数学网站上问这个问题，他们会给我这个列表：[http](http://www.luschny.de/math/factorial/FastFactorialFunctions.htm) ://www.luschny.de/math/factorial/FastFactorialFunctions.htm 。可能他们不会理解我的“ *BIGINT 问题*”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T01:32:15.620

您将不得不编写自己的大整数库。查看 Knuth 第 2 卷以开始使用。

你的期望看起来有点……过于热情。无论您做什么，都无法计算 9878945647978979798798797189 的阶乘*。*

# android - 从特殊号码接收来自我在 android 中的应用程序的短信

> ID：15823118
> 
> 赞同：0
> 
> 时间：2013-04-04T22:53:40.423
> 
> 标签：android, sms, broadcastreceiver, development-environment

我希望我的程序能够接收来自特殊号码（“+9856874236”）的短信。但是，如果 SMS 来自任何其他号码，它应该发送到手机的消息收件箱，而不是我的应用程序。

请帮帮我，亲爱的

```
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Bundle;
import android.telephony.SmsMessage;
import android.util.Log;

public class receiver extends BroadcastReceiver {
      public String str = "";

        @Override
        public void onReceive(Context context, Intent intent) {
            // ---get the SMS message passed in---

            Bundle bundle = intent.getExtras();
            SmsMessage[] msgs = null;

            if (bundle != null) {

                Object[] pdus = (Object[]) bundle.get("pdus");
                msgs = new SmsMessage[pdus.length];

                for (int i = 0; i < msgs.length; i++) 
                {
                    msgs[i] = SmsMessage.createFromPdu((byte[]) pdus[i]);

                    //for get sms from special number===============================
                    String msg_from = msgs[i].getOriginatingAddress();
                    Log.v("msg_from >>",msg_from);     
                    if(msg_from.equals("+9830007546"))
                    {
                        //===============================
                    str += "SMS from " + msgs[i].getOriginatingAddress();
                    str += " :";
                    str += msgs[i].getMessageBody().toString();
                    str += "\n";    
                    Intent act = new Intent(context, ReceiveSMS.class);
                    act.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                    act.putExtra("message", str);
                    context.startActivity(act);

                    this.abortBroadcast();
                    }

                }
                // ---display the new SMS message---
                // Toast.makeText(context, str, Toast.LENGTH_SHORT).show();
            }

            }
    } 
```

主要课程：

```
 private TextView showSms;
 private String   ReceivedSms;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    //this.setContentView(R.layout.receivesms);
     /*Removing system bar from screen*/
    this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.receivesms);
    Intent act = getIntent();       
    ReceivedSms = act.getStringExtra("message");
    showSms = (TextView) this.findViewById(R.id.textView2);
    showSms.setText(ReceivedSms); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:18:50.840

`BroadcastReceiver`在您的`AndroidManifest`. 这将使您的接收器首先排队处理广播。

```
<receiver 
    android:name=".SmsReceiver">                        
        <intent-filter
            android:priority="1000">
            <action android:name="android.provider.Telephony.SMS_RECEIVED" />
        </intent-filter>
</receiver> 
```

在您的内部`BroadcastReceiver`，检查传入短信的数量是否等于您给定的数量。如果为真，则使用 取消广播`abortBroadcast()`。

**编辑**

有几件事需要注意：

*   进行号码匹配时，请注意电话号码格式。如果传入的号码是`0123456789`并且您使用`String.equals('+XX0123456789')`，那么您的检查将失败，即使它在技术上是正确的。查看[PhoneNumberUtils](http://developer.android.com/reference/android/telephony/PhoneNumberUtils.html)以找到解决方案。
*   如果我没记错的话，一些设备制造商在处理 SMS 广播时已将默认 SMS 应用程序优先级设为 1。这会弄乱您的应用程序。一定要测试一下；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:08:03.663

假设您的意思是说您的特殊号码不应该出现在收件箱中......

您不能重新路由电话正在接收的消息。因此，您必须在收到该消息后在 MMS 数据库中查找并删除它，没有其他方法。

# java - 使用环回测试环境

> ID：15823124
> 
> 赞同：1
> 
> 时间：2013-04-04T22:54:05.780
> 
> 标签：java, tcp, ip, loopback

我想在同一台物理机上运行同一台服务器的两个实例。这两台服务器将监听相同的端口，比如 12345。我正在尝试在 127.0.0.1 上运行一台服务器，而在 127.0.0.2 上运行另一台服务器。这两个服务器基本上将使用相同的端口发送和接收消息，但在不同的环回地址上运行。我不知道我是否在正确的路径上设置这个测试环境？不知何故，我无法设置这个测试环境。我正在使用java开发服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:59:09.460

这正是我的[NanoHTTPD](http://elonen.iki.fi/code/nanohttpd/)分支的目的：

[https://github.com/gitgrimbo/nanohttpd/commit/9535d1b6b4c1bbc927d390327018882d84df959f](https://github.com/gitgrimbo/nanohttpd/commit/9535d1b6b4c1bbc927d390327018882d84df959f)

```
Added ability to specify hostname to bind to.

For example:

java NanoHTTPD -d wwwroot1 -h 127.0.0.1
java NanoHTTPD -d wwwroot2 -h 127.0.0.2
java NanoHTTPD -d wwwroot3 -h 127.0.0.3

And hosts file:

127.0.0.1   www1.example.com
127.0.0.2   www2.example.com
127.0.0.3   www3.example.com 
```

特别是第 225 行（在上面的提交链接中）：

```
myServerSocket.bind(new InetSocketAddress(hostname, port)); 
```

这段代码结合我上面的说明，展示了如何在多个环回地址上运行服务器，所有这些地址都使用相同的端口（默认为 80，但您可以选择任何一个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T01:08:20.343

如果指定两个不同的接口，则可以将两个服务器绑定到同一个端口：

```
ServerSocket s1 = new ServerSocket(port, 500, InetAddress.getByName("127.0.0.1"));
ServerSocket s2 = new ServerSocket(port, 500, InetAddress.getByName("127.0.0.2")); 
```

# java - 奇怪的 Java 运行时错误 - currency.data

> ID：15823126
> 
> 赞同：14
> 
> 时间：2013-04-04T22:54:14.500
> 
> 标签：java, runtime-error

我在运行时不断收到此错误，我不知道是什么原因造成的。它认为缺少文件？

`Caused by: java.io.FileNotFoundException: C:\Program Files\Java\jdk1.7.0_07\lib\currency.data`

什么是`currency.data`并且任何人都可以提出为什么会发生这种情况，我的 JDK 并没有那么旧，因为我们现在在 7u17 中。

```
Exception in thread "AWT-EventQueue-0" java.lang.InternalError
    at java.util.Currency$1.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.util.Currency.<clinit>(Unknown Source)
    at java.text.DecimalFormatSymbols.initialize(Unknown Source)
    at java.text.DecimalFormatSymbols.<init>(Unknown Source)
    at java.text.DecimalFormatSymbols.getInstance(Unknown Source)
    at java.text.NumberFormat.getInstance(Unknown Source)
    at java.text.NumberFormat.getNumberInstance(Unknown Source)
    at java.util.Scanner.useLocale(Unknown Source)
    at java.util.Scanner.<init>(Unknown Source)
    at java.util.Scanner.<init>(Unknown Source)
    at ciphor.CiCompile$7.actionPerformed(CiCompile.java:458)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$200(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Caused by: java.io.FileNotFoundException: C:\Program Files\Java\jdk1.7.0_07\lib\currency.data (The system cannot find the file specified)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(Unknown Source)
    at java.io.FileInputStream.<init>(Unknown Source)
    ... 48 more 
```

我正在使用 JDK 环境运行我的程序，我检查了我的 jre7 文件夹并且`currency.data`存在于那里！为什么它只存在于 jre 文件夹中？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2015-11-16T06:14:11.697

**我遇到了类似的错误，这只是为了帮助可能落入同一陷阱的其他人:)**

错误 ：

```
java.lang.InternalError: java.io.FileNotFoundException: null/lib/currency.data (No such file or directory) 
```

这是因为我设置了全局属性，结果证明这是一件非常不明智的事情。

```
System.setProperties(new Properties()); 
```

系统属性填充了非常重要的数据，包括：

*   路径分隔符
*   用户目录
*   文件编码
*   文件分隔符
*   java.io.tmpdir

所以基本上不要做上面的事情，除非你知道你在做什么。

如果您想要一个属性，请改为执行以下操作：

```
System.getProperties().put("SOME_KEY", "SOME_VALUE"); 
```

或者

```
Map myCustomMapOfProps = ...
System.getProperties().putAll(myCustomMapOfProps); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-10-21T08:57:32.553

这是我的解决方案。您可以在代码中添加它：

```
System.setProperty("java.home", "C:\\Program Files\\Java\\jdk1.8.0_60\\jre"); 
```

您必须替换您的 jdk 版本的路径。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-04T16:19:24.837

我有同样的问题。它是由 Java 版本冲突引起的（“JAVA_HOME”设置为 1.7，属性“-Djava.home”设置为 1.6）。

我正在使用 mvn 来构建项目，并且在环境变量 MAVEN_OPTS 中，选项“java-home”被设置为*WRONG*值：

```
MAVEN_OPTS = -Xmx512m -XX:MaxPermSize=256m "-Djava.home=C:\Program Files\Java\jdk1.6.0_35\jre" 
```

只需将其*更正*为：

```
MAVEN_OPTS = -Xmx512m -XX:MaxPermSize=256m 
```

还要检查您的其他环境变量：

```
MAVEN_OPTS
JAVA_HOME 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T23:11:49.353

我发现`currency.data`在以下任何一个中都可以找到：

`C:\Program Files\Java\jdk1.7.0_17\jre\lib`

或者

`C:\Program Files\Java\jdk1.7.0_07\lib`

出于某种原因，当我执行我的程序时，Java 不知道更深入地查看一个目录。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-11-20T23:41:31.457

在过去，Sun 规定如果安装了 JDK 而不是只安装了 JRE，则 JAVA_HOME 应该指向 JDK_HOME/jre。

由于“exalator”正在成为“escalator”的可接受发音，这种差异已经慢慢消失：无处不在。

无论如何，一些较旧的应用程序仍然认为 JAVA_HOME 是 JRE 的根

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-13T14:50:24.110

JDK 1.7.0_43 lib/下没有currency.data，只有jre/lib下。这迫使我更改构建脚本以使用 JDK 进行编译，然后使用 JRE 进行单元测试。除非有更好的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-20T09:47:26.070

在服务器运行时安装新的 jre 后，我在 Wildfly 10 中部署的 webapp 遇到了同样的问题。重新启动服务器解决了这个问题。

# android - Pushwoosh 和 Android Phonegap 应用程序无法通信

> ID：15823134
> 
> 赞同：3
> 
> 时间：2013-04-04T22:55:07.523
> 
> 标签：android, cordova, push-notification, google-cloud-messaging, pushwoosh

## 问题

好的，所以我有一个带有 Pushwoosh 的 Phonegap (2.3.0) android 应用程序来管理推送通知。我按照说明操作，得到了一个只有几个措辞错误的应用程序。该应用程序本身似乎运行得非常好，但是 Pushwoosh 似乎没有向 GCM（Google Cloud Messanger）推送任何内容，而 GCM（谷歌云信使）并没有向该应用程序推送任何内容。现在我认为这是错误的，但这是我第一次使用 GCM 和 Pushwoosh。

在 Pushwoosh 控制台页面上，它显示每个“推送”已完成且没有错误，但在我的 GCM 控制台上，它没有显示任何请求，也没有在我的手机上弹出任何通知。

我的 XML 中有 GCM API 密钥（服务器密钥），而我的 Pushwoosh 是正确的 XXXXX-XXXXX 密钥。这是我的代码，以更好地概述我的代码是如何设置的（也许有人可以看到我缺少的内容）。

* * *

## 编码

这是 AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?> 
```

```
<supports-screens
    android:largeScreens="true"
    android:normalScreens="true"
    android:smallScreens="true"
    android:resizeable="true"
    android:anyDensity="true"
    />

<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="17"/>

<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
<uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS" />
<uses-permission android:name="android.permission.RECEIVE_SMS" />
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.RECORD_VIDEO"/>
<uses-permission android:name="android.permission.MODIFY_AUDIO_SETTINGS" />
<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="android.permission.WRITE_CONTACTS" />   
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />   
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.BROADCAST_STICKY" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>

<!--library-->
<uses-permission android:name="android.permission.READ_PHONE_STATE"/>

<!-- GCM connects to Google Services. -->
<uses-permission android:name="android.permission.INTERNET"/>

<!-- GCM requires a Google account. -->
<uses-permission android:name="android.permission.GET_ACCOUNTS"/>

<!-- Keeps the processor from sleeping when a message is received. -->
<uses-permission android:name="android.permission.WAKE_LOCK"/>

 <!--
Creates a custom permission so only this app can receive its messages.

NOTE: the permission *must* be called PACKAGE.permission.C2D_MESSAGE,
    where PACKAGE is the application's package name.
-->
<permission
     android:name="com.springmobile.employee.permission.C2D_MESSAGE"
     android:protectionLevel="signature"/>
<uses-permission
     android:name="com.springmobile.employee.permission.C2D_MESSAGE"/>

<!-- This app has permission to register and receive data message. -->
<uses-permission
     android:name="com.google.android.c2dm.permission.RECEIVE"/>

<application android:icon="@drawable/ic_launcher" android:label="@string/app_name" android:allowBackup="true">

  <!--
Service for sending location updates
-->
<service android:name="com.arellomobile.android.push.GeoLocationService"/>
<intent-filter>
     <action android:name="com.springmobile.employee.MESSAGE"/>
     <category android:name="android.intent.category.DEFAULT"/>
 </intent-filter>
 <intent-filter>
     <action android:name="android.intent.action.MAIN"/>
     <category android:name="android.intent.category.LAUNCHER"/>
 </intent-filter>
    <activity android:name="com.arellomobile.android.push.PushWebview"/>

    <activity android:name="com.arellomobile.android.push.MessageActivity"/>

    <activity android:name="com.arellomobile.android.push.PushHandlerActivity"/>

    <!--
    BroadcastReceiver that will receive intents from GCM
    services and handle them to the custom IntentService.

    The com.google.android.c2dm.permission.SEND permission is necessary
    so only GCM services can send data messages for the app.
    -->
    <receiver
    android:name="com.google.android.gcm.GCMBroadcastReceiver"
    android:permission="com.google.android.c2dm.permission.SEND">
    <intent-filter>
    <!-- Receives the actual messages. -->
    <action android:name="com.google.android.c2dm.intent.RECEIVE"/>
    <!-- Receives the registration id. -->
    <action android:name="com.google.android.c2dm.intent.REGISTRATION"/>
    <category android:name="com.springmobile.employee"/>
    </intent-filter>
    </receiver>

    <!--
    Application-specific subclass of PushGCMIntentService that will
    handle received messages.
    -->
    <service android:name="com.arellomobile.android.push.PushGCMIntentService"/>
    <activity android:name="org.apache.cordova.example.cordovaExample" android:label="@string/app_name"
            android:theme="@android:style/Theme.Black.NoTitleBar"
            android:configChanges="orientation|keyboardHidden">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

* * *

这是我的 Phonegap 插件 config.XML

```
<plugins>
<plugin name="PushNotification" value="com.pushwoosh.plugin.pushnotifications.PushNotifications" onload="true"/>
</plugins> 
```

* * *

这是我的 Phonegap 页面的 JS，用于初始化和侦听 Pushwoosh 通知。

```
function initPushwoosh()
{
var pushNotification = window.plugins.pushNotification;
pushNotification.onDeviceReady();

pushNotification.registerDevice({ projectid: "I_HAVE_MY_PROJECT_ID_HERE", appid : "THIS_IS_MY_PUSHWOOSH_ID" },
    function(status) {
        var pushToken = status;
        console.warn('push token: ' + pushToken);
    },
    function(status) {
        console.warn(JSON.stringify(['failed to register ', status]));
    }
);

document.addEventListener('push-notification', function(event) {
    var title = event.notification.title;
        var userData = event.notification.userdata;

        if(typeof(userData) != "undefined") {
        console.warn('user data: ' + JSON.stringify(userData));
    }

    navigator.notification.alert(title);
});
}

function init() {
document.addEventListener("deviceready", initPushwoosh, true);

//rest of the code
document.addEventListener('push-notification', function(event) {
    var title = event.notification.title;
        var userData = event.notification.userdata;

    console.warn('user data: ' + JSON.stringify(userData));
    navigator.notification.alert(title);
});
}

function initPushwoosh()
{
var pushNotification = window.plugins.pushNotification;
pushNotification.onDeviceReady();

document.addEventListener('push-notification', function(event) {
                            var title = event.notification.title;
                            var userData = event.notification.userdata;

                            if(typeof(userData) != "undefined") {
                                console.warn('user data: ' + JSON.stringify(userData));
                            }

                            navigator.notification.alert(title);

                            pushNotification.stopGeoPushes();
                          });
}

function registerPushwoosh()
{
var pushNotification = window.plugins.pushNotification;
//projectid: "GOOGLE_PROJECT_ID", appid : "PUSHWOOSH_APP_ID"
pushNotification.registerDevice({ projectid: "1039894503284", appid : "EE861-B95A3" },
                                function(token) {
                                    alert(token);
                                    onPushwooshInitialized(token);
                                },
                                function(status) {
                                    alert("failed to register: " +  status);
                                    console.warn(JSON.stringify(['failed to register ', status]));
                                });
}

function unregisterPushwoosh()
{
var pushNotification = window.plugins.pushNotification;
pushNotification.unregisterDevice(function(token) {
                                    alert("unregistered, old token " + token);
                                },
                                function(status) {
                                    alert("failed to unregister: " +  status);
                                    console.warn(JSON.stringify(['failed to unregister ', status]));
                                });
}

//set the settings for Pushwoosh or set tags, this must be called only after successful registration
function onPushwooshInitialized(pushToken)
{
//output the token to the console
console.warn('push token: ' + pushToken);

var pushNotification = window.plugins.pushNotification;

//set multi notificaiton mode
//pushNotification.setMultiNotificationMode();

//set single notification mode
//pushNotification.setSingleNotificationMode();

//disable sound and vibration
//pushNotification.setSoundType(1);
//pushNotification.setVibrateType(1);

pushNotification.setLightScreenOnNotification(false);

//goal with count
//pushNotification.sendGoalAchieved({goal:'purchase', count:3});

//goal with no count
//pushNotification.sendGoalAchieved({goal:'registration'});

//setting list tags
//pushNotification.setTags({"MyTag":["hello", "world"]});

//settings tags
pushNotification.setTags({deviceName:"hello", deviceId:10},
                                function(status) {
                                    console.warn('setTags success');
                                },
                                function(status) {
                                    console.warn('setTags failed');
                                });

function geolocationSuccess(position) {
    pushNotification.sendLocation({lat:position.coords.latitude, lon:position.coords.longitude},
                             function(status) {
                                  console.warn('sendLocation success');
                             },
                             function(status) {
                                  console.warn('sendLocation failed');
                             });
};

// onError Callback receives a PositionError object
//
function geolocationError(error) {
    alert('code: '    + error.code    + '\n' +
          'message: ' + error.message + '\n');
}

function getCurrentPosition() {
    navigator.geolocation.getCurrentPosition(geolocationSuccess, geolocationError);
}

//greedy method to get user position every 3 second. works well for demo.
//  setInterval(getCurrentPosition, 3000);

//this method just gives the position once
//  navigator.geolocation.getCurrentPosition(geolocationSuccess, geolocationError);

//this method should track the user position as per Phonegap docs.
//  navigator.geolocation.watchPosition(geolocationSuccess, geolocationError, { maximumAge: 3000, enableHighAccuracy: true });

//Pushwoosh Android specific method that cares for the battery
pushNotification.startGeoPushes();
}

var app = {
// Application Constructor
initialize: function() {
    this.bindEvents();
},
// Bind Event Listeners
//
// Bind any events that are required on startup. Common events are:
// 'load', 'deviceready', 'offline', and 'online'.
bindEvents: function() {
    document.addEventListener('deviceready', this.onDeviceReady, false);
},
// deviceready Event Handler
//
// The scope of 'this' is the event. In order to call the 'receivedEvent'
// function, we must explicity call 'app.receivedEvent(...);'
onDeviceReady: function() {
    initPushwoosh();
    app.receivedEvent('deviceready');

    //optional: create local notification alert
    //var pushNotification = window.plugins.pushNotification;
//pushNotification.clearLocalNotification();
//pushNotification.createLocalNotification({"msg":"message", "seconds":30, "userData":"optional"});

},
// Update DOM on a Received Event
receivedEvent: function(id) {
    var parentElement = document.getElementById(id);
    var listeningElement = parentElement.querySelector('.listening');
    var receivedElement = parentElement.querySelector('.received');

    listeningElement.setAttribute('style', 'display:none;');
    receivedElement.setAttribute('style', 'display:block;');

    console.log('Received Event: ' + id);
}
}; 
```

* * *

这是 PushWoosh.js 代码

```
(function(cordova) {

function PushNotification() {}

// Call this to register for push notifications and retreive a deviceToken
PushNotification.prototype.registerDevice = function(config, success, fail) {
    cordova.exec(success, fail, "PushNotification", "registerDevice", config ? [config] : []);
};

// Call this to set tags for the device
PushNotification.prototype.setTags = function(config, success, fail) {
    cordova.exec(success, fail, "PushNotification", "setTags", config ? [config] : []);
};

// Call this to send geo location for the device
PushNotification.prototype.sendLocation = function(config, success, fail) {
    cordova.exec(success, fail, "PushNotification", "sendLocation", config ? [config] : []);
};

//Android Only----
PushNotification.prototype.unregisterDevice = function(success, fail) {
    cordova.exec(success, fail, "PushNotification", "unregisterDevice", []);
};

//config params: {msg:"message", seconds:30, userData:"optional"}
PushNotification.prototype.createLocalNotification = function(config, success, fail) {
    cordova.exec(success, fail, "PushNotification", "createLocalNotification", config ? [config] : []);
};

PushNotification.prototype.clearLocalNotification = function() {
    cordova.exec(null, null, "PushNotification", "clearLocalNotification", []);
};

//advanced background task to track device position and not drain the battery
PushNotification.prototype.startGeoPushes = function(success, fail) {
    cordova.exec(success, fail, "PushNotification", "startGeoPushes", []);
};

PushNotification.prototype.stopGeoPushes = function(success, fail) {
    cordova.exec(success, fail, "PushNotification", "stopGeoPushes", []);
};

//sets multi notification mode on
PushNotification.prototype.setMultiNotificationMode = function(success, fail) {
    cordova.exec(success, fail, "PushNotification", "setMultiNotificationMode", []);
};

//sets single notification mode
PushNotification.prototype.setSingleNotificationMode = function(success, fail) {
    cordova.exec(success, fail, "PushNotification", "setSingleNotificationMode", []);
};

//type: 0 default, 1 no sound, 2 always
PushNotification.prototype.setSoundType = function(type, success, fail) {
    cordova.exec(success, fail, "PushNotification", "setSoundType", [type]);
};  

//type: 0 default, 1 no vibration, 2 always
PushNotification.prototype.setVibrateType = function(type, success, fail) {
    cordova.exec(success, fail, "PushNotification", "setVibrateType", [type]);
};  

PushNotification.prototype.setLightScreenOnNotification = function(on, success, fail) {
    cordova.exec(success, fail, "PushNotification", "setLightScreenOnNotification", [on]);
};

//set to enable led blinking when notification arrives and display is off
PushNotification.prototype.setEnableLED = function(on, success, fail) {
    cordova.exec(success, fail, "PushNotification", "setEnableLED", [on]);
};

//{goal:'name', count:3} (count is optional)
PushNotification.prototype.sendGoalAchieved = function(config, success, fail) {
    cordova.exec(success, fail, "PushNotification", "sendGoalAchieved", config ? [config] : []);
};

//Android End----

//iOS only----
PushNotification.prototype.onDeviceReady = function() {
    cordova.exec(null, null, "PushNotification", "onDeviceReady", []);
};

// Call this to get a detailed status of remoteNotifications
PushNotification.prototype.getRemoteNotificationStatus = function(callback) {
    cordova.exec(callback, callback, "PushNotification", "getRemoteNotificationStatus", []);
};

// Call this to set the application icon badge
PushNotification.prototype.setApplicationIconBadgeNumber = function(badge, callback) {
    cordova.exec(callback, callback, "PushNotification", "setApplicationIconBadgeNumber", [{badge: badge}]);
};

// Call this to clear all notifications from the notification center
PushNotification.prototype.cancelAllLocalNotifications = function(callback) {
    cordova.exec(callback, callback, "PushNotification", "cancelAllLocalNotifications", []);
};
//iOS End----

// Event spawned when a notification is received while the application is active
PushNotification.prototype.notificationCallback = function(notification) {
    var ev = document.createEvent('HTMLEvents');
    ev.notification = notification;
    ev.initEvent('push-notification', true, true, arguments);
    document.dispatchEvent(ev);
};

cordova.addConstructor(function() {
    if(!window.plugins) window.plugins = {};
    window.plugins.pushNotification = new PushNotification();
});

})(window.cordova || window.Cordova || window.PhoneGap); 
```

* * *

## GCM、Pushwoosh 和 Eclipse 的屏幕截图

对不起，这很长，但我想确保我在这里拥有一切。也没有足够的代表来发布图片，所以下面的链接。

[GCM API 服务器密钥、Pushwoosh 控制面板和 Eclipse 设置](http://imgur.com/a/ZS4uR)

* * *

**谢谢！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-20T14:05:28.927

Pushwoosh 版本在使用 phonegap 应用程序配置时非常重要，因此您需要确保您的 Pushwoosh 脚本与 Phonegap 2.3.0 兼容。如果 Pushwoosh 脚本不正确，它将不适用于您的 Phonegap 版本，我认为它们仅支持目前可用的最新 Phonegap。

GCM API 密钥必须用于 Android 应用程序，而不是服务器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T04:38:03.770

让我们[检查](http://devgirl.org/2012/12/04/easy-phonegap-push-notifications-with-pushwoosh/)您的配置和设置是否适合推送 woosh 通知。[其他](http://urbanairship.com/resources/developer-resources)推送通知服务也可以在电话间隙中使用，您可以查看它。您可以找到电话间隙代码（zip）、配置和设置的适当文档以及如何使用 Java 脚本使用他们的 API

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-23T16:26:51.853

我遇到了这个问题，因为我的捆绑包 ID 不正确。确保您的应用名称和捆绑包 ID 在 xcode 和您的 iOS 应用标识符在[https://developer.apple.com/account/ios/identifiers](https://developer.apple.com/account/ios/identifiers)中相同。

# sql - Unix Solaris 上的 Teradata 客户端

> ID：15823136
> 
> 赞同：0
> 
> 时间：2013-04-04T22:55:14.480
> 
> 标签：sql, shell, command, teradata

我在 TERADATA 数据库上部署了一些 .bteq 和 .sql 脚本。为此，我在桌面上使用了一个名为 BTEQWin 版本 13.10.0.03 的客户端。

我从 pvcs/svn 等版本控制中获取 .bteq/.sql ，一旦文件位于我的工作区文件夹（来自版本控制工具）中，我所做的一切就是将文件从 Windows 浏览器拖放到 BTEQWin 客户端（我在拖放之前连接到数据库以运行这些脚本）。

现在，我必须在 UNIX 中自动化这整个过程。

我编写了一个 SHELL KSH/BASH 脚本，它从版本控制工具中的 TAG/LABEL 获取所有 .bteq/.sql 到给定的 UNIX 文件夹。现在，我需要做的就是将这些文件一个一个（我会处理订单）传递给 Teradata 客户端。

我的 ？- 我需要告诉 Unix 管理团队在 Unix 服务器上安装什么客户端 - 这样我就可以运行如下所示的内容：

someTeraDataCommand -u 用户名 -p 密码 -h 主机名 -d 数据库 -f 文件名执行 | tee output_filename.log

其中， someTeraDataCommand 是客户端/可执行文件 - 它可以让我运行 Teradata 脚本（就像我在桌面上使用 BTEQWin - GUI 会话一样）。其他参数可以是用户名、密码、在哪个服务器上连接哪个数据库以及要运行哪个文件，或者在命令行使用“<”运算符将该文件传递给命令。

任何想法？- 什么客户？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:49:32.717

假设在您的 UNIX 服务器上安装了完整的 Teradata 工具和实用程序包（它将具有与 Teradata 通信的连接工具），您应该可以`bteq`从命令行访问。像这样的东西：

```
bteq < script_file > output_file 
```

您的脚本文件应包含`.LOGON`建立连接的语句：

```
.LOGON yourTDPID/your_account,your_pw 
```

您可能还需要使用其他命令来设置默认数据库或非默认会话值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T14:10:22.450

另一种选择是在 Korn shell 脚本中组合 SQL 和对 BTEQ 的调用：

```
#!/usr/bin/ksh
##############
SHELL_NAME=`basename $0`
PRG_NAME=`basename $(SHELL_NAME} .ksh`
LOG_FILE=${PRG_NAME}.log
OUT_FILE=${PRG_NAME}.out
#
bteq <<EOBTQ > ${LOG_FILE} 2>$1

.LOGON {TDPID}/{USERID},{PWD};
--.RUN file=${LOGON}

/* Add your SQL/BTEQ commands here */

.QUIT 0;

EOBTQ 
```

**编辑**

双连字符表示单行注释。通常在 UNIX 脚本中，您不会将密码保留在 KSH 脚本的纯文本中。.RUN 命令将引用包含该`.LOGON {TPDID}/{USERID},{PWD};`命令的勉强安全位置中的文本文件。

BTEQ 中的 .RUN 命令允许您引用另一个文本文件，其中包含您要在当前 BTEQ 脚本中运行的一系列有效 BTEQ 命令。

# jquery - 根据“媒体屏幕”值调用外部 JS 文件

> ID：15823137
> 
> 赞同：9
> 
> 时间：2013-04-04T22:55:22.323
> 
> 标签：jquery, html, external, media-queries

我正在尝试这个，但它不起作用：

```
<html>
<head>
<script src="js/menu-collapser.js" type="text/javascript" media="media screen and (max-width: 599px)"></script>
</head>
...
</html> 
```

//菜单-collapser.js：

```
jQuery(document).ready(function($){
    $('.main-navigation li ul').hide();
    $('.main-navigation li').has('ul').click(function() {
        $(this).children().toggle();
    });
}); 
```

你知道如何以正确的方式做到这一点吗？如果直接在带有标签的标题中使用该脚本，则该脚本将起作用。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-04T23:10:53.100

您不能直接使用 Javascript`<script>`标记来执行此操作。媒体查询用于链接的 CSS 文件或内联 CSS 样式。一个基本的例子：

```
<link rel="stylesheet" media="screen and (min-width: 900px)" href="desktop.css"/>
<link rel="stylesheet" media="screen and (min-width: 571px)" href="tablet.css"/>
<link rel="stylesheet" media="screen and (max-width: 570px)" href="mobile.css"/> 
```

或直接在您的样式表中：

```
@media screen and (max-width: 599px) {
  #mobile {
     display: block;
  }
} 
```

但是，您可以使用外部资产加载器/媒体查询库来执行此操作（[require.js](http://requirejs.org/)、[modernizr.js](http://modernizr.com/)、[enquire.js](http://wicky.nillia.ms/enquire.js/)等），在这种情况下，我正在使用[enquire.js](http://wicky.nillia.ms/enquire.js/)设置示例，我认为它非常有效，默认情况下不需要 jQuery：

## 完整示例

**1) 包括 enquire.js（可[在此处](https://raw.github.com/WickyNilliams/enquire.js/master/dist/enquire.min.js)获得）：**

```
<script type="text/javascript" src="/js/enquire.js"></script> 
```

**2）创建加载函数——加载JS文件：**

```
<script type="text/javascript">

// This loads JS files in the head element
    function loadJS(url)
    {
        // adding the script tag to the head
       var head = document.getElementsByTagName('head')[0];
       var script = document.createElement('script');
       script.type = 'text/javascript';
       script.src = url;

       // fire the loading
       head.appendChild(script);
    }

</script> 
```

**3) 触发 enquire.js 并监听媒体查询更改（加载和调整大小）：**

```
<script type="text/javascript">

    enquire.register("screen and (max-width: 599px)", {
        match : function() {
            // Load a mobile JS file
            loadJS('mobile.js');
        }
    }).listen();

    enquire.register("screen and (min-width: 600px) and (max-width: 899px)", {
        match : function() {
            // Load a tablet JS file
            loadJS('tablet.js');
            //console.log('tablet loaded');
        }
    }).listen();

    enquire.register("screen and (min-width: 900px)", {
        match : function() {
            // Load a desktop JS file
            loadJS('desktop.js');
            //console.log('desktop loaded');
        }
    }).listen();
</script> 
```

## 把它们放在一起

使用带有从外部文件加载的 enquire.js 的简单 HTML 页面：

```
<html>
<head>

<script type="text/javascript" src="/enquire.js"></script>

<script type="text/javascript">

// This loads JS files in the head element
    function loadJS(url)
    {
        // adding the script tag to the head
       var head = document.getElementsByTagName('head')[0];
       var script = document.createElement('script');
       script.type = 'text/javascript';
       script.src = url;

       // fire the loading
       head.appendChild(script);
    }

</script>

<style>

    body {
      font-family: arial;
    }
    h1 {
      font-size: 50pt;
    }

    #mobile {
      display: none;
    }
    #tablet {
      display: none;
    }
    #desktop {
      display: none;
    }

    @media screen and (max-width: 599px) {
        #mobile {
            display: block;
        }
    }

    @media screen and (min-width: 600px) and (max-width: 899px) {
        #tablet {
            display: block;
        }
    }

    @media screen and (min-width: 900px) {
        #desktop {
            display: block;
        }
    }   

</style>

</head>
<body>

    <div id="desktop">
        <h1>Desktop</h1>
    </div>

    <div id="tablet">
        <h1>Tablet</h1>
    </div>

    <div id="mobile">
        <h1>Mobile</h1>
    </div>

    <script type="text/javascript">

        enquire.register("screen and (max-width: 599px)", {
            match : function() {
                // Load a JS file
                loadJS('mobile.js');
            }
        }).listen();

        enquire.register("screen and (min-width: 600px) and (max-width: 899px)", {
            match : function() {
                loadJS('tablet.js');
                //console.log('tablet loaded');
            }
        }).listen();

        enquire.register("screen and (min-width: 900px)", {
            match : function() {
                loadJS('desktop.js');
                //console.log('desktop loaded');
            }
        }).listen();

    </script>
</body>
</html> 
```

除了加载 JS 文件之外，您还可以创建一个 CSS 加载器，它会以相同的方式（有条件地）工作，但这违背了`@media`在 CSS 中使用的对象。值得阅读[enquire.js](http://wicky.nillia.ms/enquire.js/#basics)的用法说明，因为它可以做的比我在这里说明的要多得多。

**警告：**上面没有使用 jQuery，但您可以利用它提供的一些功能；例如加载脚本 - 或执行您需要的其他功能。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T23:09:17.470

为什么不只是有条件地加载脚本呢？

```
(function() {
    if( window.innerWidth > 600 ) {
        var theScript = document.createElement('script');
            theScript.type = 'text/javascript';
            theScript.src = 'js/menu-collapser.js';

        var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(theScript, s);
    }
})(); 
```

或者更好的是，仅在 window.innerWidth > 600 时才执行代码？无论如何，您可以使用很多解决方案。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T23:12:45.360

`media`不是 的有效属性，请在[此处](http://www.w3.org/TR/html5/scripting-1.html#the-script-element)`<script>`检查。

因此，您应该手动检测媒体类型，而不是动态加载脚本。

[javascript中有一个css媒体检测插件](http://cssmedia.pemor.pl/)，可以使用。

```
<script type="text/javascript" src="js/mediatypechecker.js"></script>

$(function() {
    if(IsMediaType('screen') > 0 && parseInt(screen.width) < 599) {
        $.getSscript("js/menu-collapser.js");
    }
}); 
```

# c# - 自动化 Windows 服务部署的最佳方式是什么？

> ID：15823138
> 
> 赞同：25
> 
> 时间：2013-04-04T22:55:23.697
> 
> 标签：c#, msbuild, windows-services, build-automation

我在 Visual Studio 2010 中使用 C# 创建了一个 Windows 服务。我对自动化安装过程进行了大量研究。得到了很多建议，但没有一个对我有用。我创建的 Windows 服务有很多依赖项，我希望客户端在安装过程中没有 UI 交互。我为此创建了一个安装项目，其中包括我在安装程序中的所有依赖项。

涉及过程：

*   为 Windows 服务创建构建
*   将设置文件 (.msi) 推送到远程位置
*   调用 .msi 并静默安装服务，无需用户交互。

到目前为止我做了什么：

*   创建了一个 powershell 脚本来将文件推送到远程位置
*   执行powershell脚本并安装服务

请记住 powershell 脚本

```
sc create "servicename" binpath="somepath" 
```

用于从项目目录安装服务，而不是用于安装使用 Setup Project 创建的 .msi 文件，这是两个截然不同的东西。如果您不明白这一点，请不要回答。

可能的解决方案：

*   使用 ( [http://www.msbuildextensionpack.com/help/4.0.5.0/html/258a18b7-2cf7-330b-e6fe-8bc45db381b9.htm](http://www.msbuildextensionpack.com/help/4.0.5.0/html/258a18b7-2cf7-330b-e6fe-8bc45db381b9.htm) ) msbuild 扩展包。
*   使用 buildarguments 调用 msbuild 扩展包来安装 windows 服务。
*   使用（[http://msdn.microsoft.com/en-us/library/x8zx72cd.aspx](http://msdn.microsoft.com/en-us/library/x8zx72cd.aspx)）执行任务
*   使用 WIX（Windows 安装程序 Xml）

现在我的问题是。如何将 Windows 服务安装程序推送到远程位置？以及如何创建自定义构建参数并使用 msbuild 扩展包或 Exec Task 并安装服务？

我知道对于尚未使用安装项目创建的 (.MSI) 安装服务的人来说，这听起来既愚蠢又令人恼火。但这是我在企业环境中数周以来一直在努力解决的要求。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-04T23:24:18.917

我会从 powershell 脚本中完成大部分工作。

1.  使用您提到的 msbuild Exec 任务将其添加到您的构建过程中。[这是一篇关于使用 exec 任务运行你的 powershell 脚本](http://www.asp.net/web-forms/tutorials/deployment/advanced-enterprise-web-deployment/running-windows-powershell-scripts-from-msbuild-project-files)的非常好的文章。

2.  由于您使用的是 VS 2010，因此[设置和部署项目](http://msdn.microsoft.com/en-us/library/vstudio/19x10e5c%28v=vs.100%29.aspx)非常简单。将一个添加到您的解决方案中，并将您的服务项目的输出添加到其中。这是一篇关于[为 Windows 服务添加安装项目](http://support.microsoft.com/kb/816169)的文章。

3.  使用您的 powershell 脚本将安装程序 .msi 复制到远程服务器。`copy-item [source] [destination]`如果您有权访问文件共享，则可以简单地使用。

4.  停止远程机器上的服务。您可以使用`(get-service -ComputerName [destination] -Name [service-name]).Stop()`（来自[这个问题](https://stackoverflow.com/questions/10342486/using-powershell-to-stop-a-service-remotely-without-wmi-or-remoting)）

5.  [使用psexec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx) 静默安装服务`psexec \\remotecomputer "[msi-destination-path]" /qn` [这是 .msi 的其余命令行选项。](http://msdn.microsoft.com/en-us/library/windows/desktop/aa367988%28v=vs.85%29.aspx)

6.  使用启动服务`(get-service -ComputerName [destination] -Name [service-name]).Start()`

我还将为目标服务器、服务名称等的 powershell 脚本添加一堆参数。这将使维护构建过程的这一部分变得更加容易。您的构建代理很可能也必须是目标计算机上的管理员。

最后，确保将您的 powershell 构建脚本放在源代码管理中！

**编辑（2014 年 6 月）**
[VS 2013 再次有安装程序项目！](http://visualstudiogallery.msdn.microsoft.com/9abe329c-9bba-44a1-be59-0fbf6151054d)（对不起，VS 2012）

此外，如果找到关于如何在不使用安装项目的情况下安装 Windows 服务的[精彩答案。](https://stackoverflow.com/a/1450051/8360)

# iphone - 如何从 AVCaptureOutput 人脸检测元数据对象获取视频帧

> ID：15823141
> 
> 赞同：1
> 
> 时间：2013-04-04T22:55:31.350
> 
> 标签：iphone, ios, ios6, avfoundation

我能够按照[WWDC 2012](https://developer.apple.com/devcenter/download.action?path=/wwdc_2012/wwdc_2012_sample_code/wwdc_2012_session_code.dmg)的 StacheCam 示例从工作的视频流中获取人脸检测。

但是，我无法获得相应的图像帧。我两个都有

```
captureOutput:didOutputSampleBuffer:fromConnection: 
```

和

```
captureOutput:didOutputMetadataObjects:fromConnection: 
```

触发并给我数据，但两者都是异步调用，我看不到一种方法可以准确地将面部框与帧同步。

# asp.net - 在 asp.net 中使用 StateServer 模式时的序列化问题

> ID：15823145
> 
> 赞同：0
> 
> 时间：2013-04-04T22:55:46.693
> 
> 标签：asp.net, .net, vb.net, serialization

如果我的会话模式设置为“StateServer”，则会出现序列化错误，因为我将控件列表存储在会话中，并将它们添加到 aspx 占位符控件中。这是我认为有问题的代码：

```
Protected Sub AddCtrl(ByVal ctrl As Control)
   Dim l As List(Of Control)
   If Session("Ctrls") Is Nothing Then
      l = New List(Of Control)
   Else
      l = DirectCast(Session("Ctrls", List(Of Control))
   End If
End Sub 
```

稍后在代码中，我遍历 Ctrls 会话对象，并将每个控件添加到 HTML 中的占位符。

我能做些什么来解决这个问题？我尝试创建一个从列表继承的自定义列表，并使其可序列化并改用自定义列表，但这并没有做到：

```
<Serializable()> _
Public Class MyList 
    Inherits List(Of Control) 
```

我尝试改用 ViewState，但也没有用。寻求建议...

谢谢！

# c - 具有多个进程的管道输出错误

> ID：15823150
> 
> 赞同：0
> 
> 时间：2013-04-04T22:55:58.637
> 
> 标签：c, pipe

在下面的代码中，我有两个管道，一个 fd[] 处理将范围变量传送到子进程。另一个管道 rw[] 负责打印方法的结果。fd 工作正常，但 rw 打印垃圾。range 和 narc_num 都很长，我已经成功地通过 rw 管道打印了一个字符串和一个字符。有任何想法吗？谢谢。

```
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <math.h>
#include <string.h>

/**
 * process propigating version of narcisstic base-10 number generator
**/

/**
 * A Narcissistic number is a number where all of its digits, when raised to the power n where n is the number of digits in its number, equla the number itseld.
 * examples:
 * 2^1 = 2
**/
 void isNarcissisticNumber(int rw[], long min, long max){
//    printf("min %ld max %ld\n", min, max);
    long n;
    for(n = min; n <= max; n++){
    long num = n;
        int digits = floor(log10(num)) + 1;
        int digit_arr[digits];
        long narc_num = 0;
        int index = 0;
        do{
            digit_arr[index++] = num%10;
            num /= 10;
        }while(num > 0);
        index = 0;
        for(index; index < digits; index++){
            narc_num += pow(digit_arr[index], digits);
        }
        if(narc_num == n){
        printf("%ld\n", n);
        // parent: writing only, so close read-descriptor.
        close(rw[0]);
        write(rw[1], &n, sizeof(long));
                // close the write descriptor
                close(rw[1]);
    }
    }
}

int main(int argc,           // Number of strings in array argv
          char *argv[]){      // Array of command-line argument strings)
    //check that there is only one passed in parameter in addition to the program name at argv[0]  
    if(argc != 2){
        printf("Args found: %d. 1 arg required\n", argc);
        return;
    }
    //check that argv passed in is an int
    if(!atoi(argv[1])){
        printf("argument shoud be the # of processes to proc.\n");
        return;
    }
    int num_processes = atoi(argv[1]);
    //counter for narcissistic numbers
    long offset = 10000;
    long range= -offset; 
    //file pipe
    int fd[2];
    //printing pipe
    int rw[2];
    int n = 0;
    long output;
    while(n < num_processes){ // -1 offset to line up array index with num_processes arg   
    pipe(rw);
    pipe(fd);
        pid_t process = fork();
    pid_t child_process;
        int status;
    if(process == 0){ //chid process --> execute program
        child_process = process;
                /* Duplicate the input side of pipe to stdin */
        // chid: reading only, so close the write-descriptor
            close(fd[1]);
        read(fd[0], &range, sizeof(range));
        close(fd[0]);
        isNarcissisticNumber(rw, range, range+offset-1);
    }else if(process != 0){
        // parent: writing only, so close read-descriptor.
            close(fd[0]);
        range += offset;
        write(fd[1], &range, sizeof(range));
        // close the write descriptor
            close(fd[1]);

        // for the current child process to complete its routine befire checking for output
        wait(&child_process);       
        //read from the printing pipe
        close(rw[1]);
        while(read(rw[0], &output, sizeof(long))){
            printf("printer %ld\n", output);
        }
        close(rw[0]);
    }else{ //failed to fork
            printf("process failed to fork!\n");
            return -1;
        }
    n++;
    }
} 
```

编辑＃1：虽然这使父级仅在子级完成后才进行检查，但它并不能修复管道的输出，即使 printf 显示其他内容，它现在也只是 0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:16:29.380

我不确定这会解决所有问题，但您肯定有逻辑问题。在您的计算例程中，您可以将零个或多个 long 写入输出。在您的打印（父）例程中，您期望只有一个值通过。因此，如果没有发送任何内容，您的读取将失败。如果发送了多个值，则只读取第一个值。第一个解决方法是检查读取的返回值并循环它。

另请注意 - 在您的子进程上等待（）可能也是一个好主意。

# php - 原始地址（电子邮件）可以绑定到 PHP / Swiftmailer 吗？

> ID：15823151
> 
> 赞同：0
> 
> 时间：2013-04-04T22:55:58.673
> 
> 标签：php, smtp, swiftmailer

我的错误：

`Uncaught exception 'Swift_BadResponseException' with message 'Expected response code(s) [250] but got response [550 Sender Rejected - MAIL FROM must be a valid domain.`

我可以将发件人有效域绑定到一个特定地址吗？

几个月来，我已经很好地配置了 swiftmailer 并执行了许多操作。老实说，我不知道会发生什么，但我的第一个预感是，自从我上次使用 swiftmail 并且它正常工作以来，我已经在服务器上安装了 bugzilla。

该服务器有许多虚拟服务器，因此我需要多个起始地址。

我记得在 buzilla 安装期间专门跳过了邮件配置，以为我会回到它。那是 2 月，从那时起，bugzilla 就被彻底使用了。在所有添加的错误中，只有一个添加导致发送电子邮件（如果您配置了邮件服务器，那么 bugzilla 应该这样做，但我没有，所以这对我来说是一个难题）。

那么我的 bugzilla 安装是否有某种方式将特定地址配置为服务器的发送地址，现在我想使用不同的域导致错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T20:03:35.013

修复程序在 mx 记录中...

# sql - SQL 选择记录

> ID：15823153
> 
> 赞同：-2
> 
> 时间：2013-04-04T22:56:03.197
> 
> 标签：sql

我在从我的表中选择汽车可用性时感到困惑，因为我想列出给定分支中的所有可用车辆我已经写了这个查询但是我的大脑坚持继续！？

```
SELECT MODEL, MAKE, START_DATE, TERMINATION_DATE

FROM VEHICLE_TYPE, VEHICLE, HIRE_AGREEMENT

WHERE VEHICLE_TYPE.VEHICLE_TYPE_ NUN = VEHICLE. VEHICLE_TYPE_NO

AND VEHICLE.VEHICLE_REG_NUM = HIRE_AGREEMENT.VEHICLE_REG_NO
AND ; 
```

我相信从 start_date 和 terminate_date 我可以得到汽车的可用性，但如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:01:57.643

如果我理解正确，这样的事情应该可以工作：

```
SELECT MODEL, MAKE, START_DATE, TERMINATION_DATE
FROM VEHICLE_TYPE, VEHICLE, HIRE_AGREEMENT
WHERE VEHICLE_TYPE.VEHICLE_TYPE_ NUN = VEHICLE. VEHICLE_TYPE_NO
AND VEHICLE.VEHICLE_REG_NUM = HIRE_AGREEMENT.VEHICLE_REG_NO
AND GETDATE() BETWEEN VEHICLE.START_DATE AND VEHICLE.TERMINATION_DATE 
```

这应该返回截至当前日期的所有可用车辆

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:03:09.867

首先，你应该加入而不是那些老派的东西。鉴于您提供的信息，这样的事情是我能建议的最好的。

```
 SELECT Vehicle.Model, Vehicle.Make, Hire_Agreement.Start_Date,  
  Hire_Agreement.termination_date  FROM Vehicle 
    NATURAL INNER JOIN Hire_Agreement 
     WHERE 
  Hire_agreement.terminationDate >= Date() AND Hire_agreement.start_date <= Date(); 
```

考虑到您没有向我们提供您的架构或 SQL 风格，这就是我所能做的。

# codeigniter - CodeIgniter Datamapper ORM：使用 get() 的关系出错

> ID：15823159
> 
> 赞同：1
> 
> 时间：2013-04-04T22:56:24.467
> 
> 标签：codeigniter, codeigniter-datamapper

我在codeigniter中遇到了datamapper orm的问题......：O

我的第一个模型：

```
class Mil_widget extends DataMapper {

    // Insert related models that Mil_widget can have more than one of.
    var $has_many = array(

        'mil_relationship' => array(
            'join_table' => 'mil_fields_mil_widgets'
        )
    );
} 
```

这是我的另一个模型：

```
class Mil_relationship extends DataMapper {

    // Insert related models that Mil_widget can have more than one of.
    var $has_many = array(

        'mil_widget' => array(
            'join_table' => 'mil_fields_mil_widgets'
        )
    );
} 
```

如果我这样做它可以工作并保存正确的数据库条目：

```
$w = new Mil_widget(1);
$r = new Mil_relationship(1);
$w->save($r); 
```

但如果我这样做，我会得到错误：

```
$w->mil_relationship->get(); 
```

这是错误：

> DataMapper 错误：“mil_widget”不是 Mil_relationship 的有效父关系。您的关系配置正确吗？

谢谢你！

# javascript - 简单的覆盖计算器不会在点击时触发，也不会出错。jQuery 和 straigt js

> ID：15823160
> 
> 赞同：0
> 
> 时间：2013-04-04T22:56:30.797
> 
> 标签：javascript, jquery, innerhtml

**我正在尝试将直接的 javacript 函数转换为使用 jQuery .click 触发**

我没有收到任何输出错误，但它不会在 jsfiddle 上执行计算。

```
var form = document.product_form_top;

function process(v) {
  var value = parseInt(document.getElementById('item_qty').value);
  value += v;
  document.getElementById('item_qty').value = value.toFixed(0);
}

    function calculate() {
      form.cubicYards.value = (form.length.value / 3) * (form.width.value / 3) * (form.depth.value / 35);

      document.getElementById('yards').innerHTML = finaloutput

      var number = parseFloat(form.item_qty.value);
      var finaloutput = number.toFixed(0);

      form.item_qty.value = form.cubicYards.value * 14.7; //calculate yards

      var number = parseFloat(form.cubicYards.value);
      var finaloutput = number.toFixed(0);

      document.getElementById('item_qty').innerHTML = finaloutput

      form.weightPounds.value = (form.length.value / 3) * (form.width.value / 3) * (form.depth.value * 21);
      form.weightPounds.value * 700;

      var number = parseFloat(form.weightPounds.value);
      var finaloutput = number.toFixed(0)

      document.getElementById('pounds').innerHTML = finaloutput
    } 
```

这是一个 jsfiddle [http://jsfiddle.net/4L4St/8/](http://jsfiddle.net/4L4St/8/)

这是一个使用 onclick="calculate(); 在按钮上运行函数的工作版本。我宁愿使用 jQuery 的 .click 函数来触发它。

[http://spartonenterprises.com/store/playground-mulch](http://spartonenterprises.com/store/playground-mulch)

此外，我正在使用 toFixed(0) 删除额外的小数点，并且在使用 firebug 检查时它似乎可以工作，但可见的 html 显示小数点。奇怪的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:35:18.410

我在这里编辑你的小提琴：http: [//jsfiddle.net/4L4St/5/](http://jsfiddle.net/4L4St/5/)，例如；你有基本的错误，但有了这个例子，你现在可以再试一次。

我以这种方式编辑您的html：

```
<div class="control-group clearfix">
<div class="rubber-nugget-calc">
    <label class="control-label" for="item_qty">
            <h2>Calculate Bags</h2>

    </label>
    <div class="clear"></div>Length:
    <input type="text" name="length" size="3" class="sidebarinput" />(feet) Width:
    <input type="text" name="width" size="3" class="sidebarinput" />(feet)
    <br/>Depth:
    <select class="depthselect" name="depth">
        <option value="">Please Select One</option>
        <option value="1">1 inch</option>
        <option value="2">2 inches</option>
        <option value="3">3 inches</option>
        <option value="4">4 inches</option>
        <option value="5">5 inches</option>
        <option value="6">6 inches</option>
        <option value="7">7 inches</option>
        <option value="8">8 inches</option>
        <option value="9">9 inches</option>
    </select>
    <!--Calculate Button -->
    <button class="calculate" type="button" style="float:right;" class="button">Calculate Bags Needed</button>
    <!--Results-->
    <p>You will need approximately:</p>
    <div class="calc-results">
        <div id="yards" style="display:none;">  <span> (results) </span>

        </div>  <span class="mulchspan" style="display:none;"> Total cubic yards of mulch </span>

        <input type="text" id = "cubicYards" name="cubicYards" size="2" class="sidebarresult" value="" />
        <div class="clear"></div>
        <div id="pounds" style="display:none;"> <span style=""> (results) </span>

        </div>  <span class="mulchspan" style="display:none;"> Pounds of mulch (*For bulk delivery) </span>

        <input type="text" name="weightPounds" size="6" class="sidebarresult" />
    </div>
    <label class="control-label" for="item_qty">Approximate Bags Needed</label>
    <br/>
    <br/>   <small>*Note - Round up by one bag to ensure coverage / You may use the calculator or manually enter the amount.</small>

    <div class="controls">
        <div class="button-div">
            <input type="text" id="item_qty" name="item_qty" class="input-mini" value="" />
        </div>
    </div>
</div>
</div> 
```

你的功能是这样的：

```
$(".calculate").click(function () {

alert('sdfasgg');    
document.getElementById('cubicYards').value = 12;
document.getElementById('yards').style.display="";
document.getElementById('yards').innerHTML = 25;
document.getElementById('item_qty').value = 26;
document.getElementById('pounds').style.display="";    
document.getElementById('pounds').innerHTML = 27;
}); 
```

- - - - - - - - - - - - - - - -更新 - - - - - - - - - ---------------------

这是最后的小提琴[http://jsfiddle.net/4L4St/13/](http://jsfiddle.net/4L4St/13/)

使用 fixex 小数

它不会计算，但现在您可以以最佳方式进行所有计算；以工作代码为例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:59:16.523

全部包起来......

```
$(document).ready(function() {
    //Code here

}); 
```

和

您只是在定义您的功能....您需要调用它，`calculate()`

和

你的表格在哪里？您的代码引用`product_form_top`，但我在您的 html 中没有看到类似的内容。

# php - 在 Laravel 中使用 auth 保护所有管理员/路由

> ID：15823161
> 
> 赞同：10
> 
> 时间：2013-04-04T22:56:33.530
> 
> 标签：php, authentication, laravel, laravel-3

我是 laravel 的新手，正在我的第一个应用程序上设置管理面板授权。我当前设置文件的方式是：

```
controllers/
    admin/
        dashboard.php
        settings.php
    non-admin-controller1.php
    non-admin-controller1.php
views/
    admin/
        dashboard.blade.php
        login.blade.php
        template.blade.php
    non-admin-view1.php
    non-admin-view1.php
    non-admin-view1.php 
```

...这些是我的路线

```
Route::get('admin/login', function()
{
    return View::make('admin.login');
});

Route::get('admin/logout', function()
{
    return Auth::logout();
    return Redirect::to('admin/login');
});

Route::post('admin/login', function()
{
    $userdata = array('username' => Input::get('username'),
                      'password' => Input::get('password'));

    if (Auth::attempt($userdata))
    {
        return Redirect::to('admin');
    }
    else
    {
        return Redirect::to('admin/login')->with('login_errors',true);
    }
});

Route::controller('admin.dashboard');

Route::get('admin', array('before' => 'auth', function() {
    return Redirect::to_action('admin@dashboard');
}));

Route::filter('auth', function()
{
    if (Auth::guest()) return Redirect::to('admin/login');
}); 
```

当我转到 /admin 时，我被重定向到 admin/login 并要求登录，这正是我需要它工作的方式。登录后，我被重定向到管理员/仪表板，那里看起来也很好。但是我有两个问题。

1.  当我进入管理员/注销时，我已注销，但出现了一个空白页面（它没有重定向到管理员/登录）

2.  注销时，如果我转到管理/仪表板，我会收到错误消息

> 错误呈现视图：[admin.dashboard]
> 
> 试图获取非对象的属性

我在这里做错了什么？我做对了什么？为管理员创建一个单独的捆绑包更有意义吗？谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-07T04:57:52.457

所以我能够以稍微不同的方式解决我的问题。我在控制器文件夹的根目录中创建了一个（基本）Admin_Controller，并在执行前调用了 auth 过滤器的构造函数：

```
class Admin_Controller extends Base_Controller {

    public function __construct()
    {
        $this->filter('before', 'auth');
    }

} 
```

然后让我在 /controllers/admin 中的所有与管理员相关的控制器扩展 Admin_Controller 并调用父构造函数：

```
class Admin_Dashboard_Controller extends Admin_Controller {

    public function __construct()
    {
        parent::__construct();
    }

    public function action_index()
    {
        return View::make('admin.dashboard');
    }

} 
```

这可能不是最有说服力的解决方案，但它确实有效！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-05T06:34:51.167

在您的`admin/login`路线中，您在通话前有不必要的回报`Auth::logout()`，核对它应该修复它。

这里的另一个问题是只有您的一个“管理员”路由被过滤。您可以使用 a 包装所有管理路由`Route::group()`并在过滤器之前应用“auth”，或者您也可以使用`Route::filter('pattern: admin/*', 'auth')`。

查看：

[http://laravel.com/docs/routing#filters](http://laravel.com/docs/routing#filters)

对于第二个问题，您的 Admin Dashboard 控制器类是否已命名`Admin_Dashboard_Controller`，如果是，您是否有 action_index() 或 get_index() 函数在其中返回视图？

查看：

[http://laravel.com/docs/controllers#nested-controllers](http://laravel.com/docs/controllers#nested-controllers)

（我假设你在这里使用 L3 顺便说一句。）

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-12-31T22:48:19.170

对于未来的读者，一个非常干净的方法是使用 Laravel 的[Route Groups](https://laravel.com/docs/5.2/routing#route-groups)：

> 路由组允许您跨大量路由共享路由属性，例如中间件或命名空间，而无需在每个单独的路由上定义这些属性。

```
Route::group(['middleware' => 'auth'], function () {
    Route::get('/', function ()    {
        // Uses Auth Middleware
    });

    Route::get('user/profile', function () {
        // Uses Auth Middleware
    });
}); 
```

它们不仅可以用于身份验证，还可以用于`Namespaces`、`Sub-Domains`等。

# python - Linecache 在我得到的行中添加额外的行

> ID：15823166
> 
> 赞同：0
> 
> 时间：2013-04-04T22:57:23.877
> 
> 标签：python, lines, getline, linecache

当我尝试在 python 中使用 linecache 获取一条线时。

```
loginpass = raw_input("> ")
if loginpass == linecache.getline('Password.txt', 1): 
```

它获得的行总是以额外的行返回。所以如果第一行是

```
"Test" 
```

它返回

```
"Test
" 
```

它在代码的早期工作，但之后的任何内容都会在其后添加该行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:05:54.627

这个是正常的; 从文件中读取行包括换行符。把它剥掉：

```
linecache.getline('Password.txt', 1).rstrip('\n') 
```

不过，我更担心您以纯文本形式存储密码....

# .net - 可以将同一驱动器上的文件操作批处理到同一线程的线程调度程序？

> ID：15823168
> 
> 赞同：2
> 
> 时间：2013-04-04T22:57:29.533
> 
> 标签：.net, parallel-processing, system.reactive

我想使用 Rx 扩展来处理长文件绑定操作的并行化。

工作流程大致如下：

*   在多个驱动器上搜索给定的文件模式（假设每个驱动器位于单独的物理设备上）
*   对于找到的每个匹配文件，将长文件操作排队*到与同一驱动器上的其他文件相同的线程*- 希望最大限度地减少随机搜索。
*   对不同驱动器上的文件的操作应排队到不同的线程以允许并行处理。

我的问题是：我应该使用什么 Rx 调度程序（或调度程序组合）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T00:51:07.530

为此，意识到每个 Rx observable 订阅都是连续工作的，这一点非常有用。也就是说，对于单个 observable 的单个订阅，您可以确保一个项目的`onNext`委托`onNext`在下一个项目开始之前完成。

默认情况下，`onNext`委托在当前线程（调用 的线程`OnNext()`）上执行，但您可以使用`ObserveOn()`.

这对您来说意味着您应该为每个物理驱动器创建一个单独的 observable，并在单独的线程上观察每个驱动器。如果您要执行一个可观察的操作，那么一种方法是使用`GroupBy()`.

使用哪个特定的调度程序？我认为这几乎没有关系。`ObserveOn()`似乎在`ScheduleLongRunning()`可用时使用，这对于最常见的调度程序意味着它将创建一个新线程进行观察。

将所有这些放在一起，您的代码可能类似于：

```
operations.GroupBy(op => op.Drive)
          .Select(o => o.ObserveOn(TaskPoolScheduler.Default))
          .Do(o => o.Subscribe(op => op.Execute()))
          .Subscribe(); 
```

（假设`operations`您的操作类型是可观察的，它具有`Drive`属性和`Execute()`方法。）

# javascript - Fancybox Youtube 问题

> ID：15823171
> 
> 赞同：-1
> 
> 时间：2013-04-04T22:58:15.163
> 
> 标签：javascript, html, css, fancybox, fancybox-2

使用 Fancy box 显示我的 YouTube 视频时遇到实际问题。我已按照以下说明进行操作：

[http://fancyapps.com/fancybox/](http://fancyapps.com/fancybox/)

与其按照应有的方式在我的网站上的弹出窗口中显示我的 youtube 视频，不如直接将我带到 YouTube。

任何人都可以帮忙吗？

JavaScript/Fancybox：

```
<script type="text/javascript" src="Fancybox/source/jquery.fancybox.pack.js"></script>
<script type="text/javascript" src="Fancybox/lib/jquery.mousewheel-3.0.6.pack.js</script>
<link rel="stylesheet" href="Fancybox/source/jquery.fancybox.css" type="text/css"media="screen" />

<script type="text/javascript">

 $(document).ready(function() {
    $(".info").fancybox({
    openEffect  : 'elastic',
    closeEffect : 'fade',
    helpers : {

        media : {}
    }
});
});

</script> 
```

HTML：

```
 <div class="view view-first">  

 <img src="http://www.intelligenthq.com/wp-content/uploads/2012/01/capital-markets1-360x194.jpg" />
 <div class="mask">  
 <h2>Title</h2>  
 <p>Your Text</p>  
 <a href="http://www.youtube.com/watch?v=92c3dX-AoXs" class="info">Play</a>  

    </div>

    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T01:53:03.900

查看示例，您可能必须通过包含媒体助手来选择加入该行为：

```
<!-- Optionally add helpers - button, thumbnail and/or media -->
<script type="text/javascript" src="/fancybox/source/helpers/jquery.fancybox-media.js?v=1.0.5"></script> 
```

默认情况下，Fancybox 不会对此类链接执行转换，即使明确启用它们（因为没有[`fancybox-media`](https://github.com/fancyapps/fancyBox/blob/master/source/helpers/jquery.fancybox-media.js)它不知道如何）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:29:42.417

这可能只是复制和粘贴失败或错字，但您的第二个`<script/>`标签格式不正确：

```
<script type="text/javascript" src="Fancybox/lib/jquery.mousewheel-3.0.6.pack.js</script> 
```

应该

```
<script type="text/javascript" src="Fancybox/lib/jquery.mousewheel-3.0.6.pack.js"></script> 
```

# ruby-on-rails - 持续集成 - 运行需要 xvfb 的并行测试套件

> ID：15823177
> 
> 赞同：0
> 
> 时间：2013-04-04T22:58:50.297
> 
> 标签：ruby-on-rails, ubuntu, continuous-integration, x11, xvfb

我在运行需要 xvfb 服务器的并行构建时遇到问题。我以前使用的是`headless`ruby​​ gem，但是当某些需要`capybara-webkit`和 xvfb 服务器的测试套件并行运行时，会出现零星的故障。

我的猜测是他们都试图使用相同的 DISPLAY，所以我尝试设置不同的 DISPLAY 值，然后并行运行它们，但仍然失败。

然后我尝试删除`headless`gem 并运行我的测试套件： `DISPLAY=localhost:$display_num.0 xvfb-run bundle exec rake`where `$display_num`is a previous set bash variable that is different between the two test suites.

然后我得到错误：`xvfb-run: error: Xvfb failed to start`当它们并行运行时。

任何关于破译这个的帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-21T00:16:40.533

[这是要点](https://gist.github.com/rosskevin/5937888)，但最终您需要为`headless`每个进程启动一个。

这可以通过`features/support/javascript.rb`gist 中引用的文件有效地完成，相关部分是：

```
# Unnecessary on mac
if (!OS.mac? && !$headless_started)

    require 'headless'
    # allow display autopick (by default)
    # allow each headless to destroy_at_exit (by default)
    # allow each process to have their own headless by setting reuse: false
    headless_server = Headless.new(:reuse => false)
    headless_server.start

    $headless_started = true
    puts "Process[#{Process.pid}] started headless server display: #{headless_server.display}"
end 
```

# rspec - rspec - 为什么“eql”匹配器将数据添加到集合中

> ID：15823179
> 
> 赞同：0
> 
> 时间：2013-04-04T22:59:08.273
> 
> 标签：rspec, ruby-datamapper

我有两个规格。它们都测试来自公共 before(:all) 块的数据。如果我同时运行，第二个失败。

放入一些日志语句，似乎第 1 周被添加到 @h_1 两次 - 但这是在哪里发生的？

它似乎在第一个 it 块中的某个地方。如果我注释掉第一个，第二个就会通过。我不明白的是，它在语法中的哪里说两个将@w_1 添加到@h_1 两次？

```
require 'data_mapper'

DataMapper::setup(:default, "sqlite3://#{Dir.pwd}../data/prod.db")

class Hobby

    include DataMapper::Resource

    property :id, String, :key => true

    has n, :weeks, :through => Resource

end

class Week

    include DataMapper::Resource

    property :id, Integer, :key => true

    has n, :hobbys, :through => Resource

end

DataMapper.finalize.auto_migrate!

describe "Hobby" do

    before(:all){

        @h_1 = Hobby.create(:id => "zombies")
        @w_1 = Week.create(:id => 1)
        @w_2 = Week.create(:id => 2)
        @h_1.weeks << @w_1
        @h_1.weeks << @w_2
        @h_1.save

    }

    context "when a week is added to hobby" do

        subject {   @h_1.weeks[0]   }

        it "should be stored in the 'weeks' property of the hobby" do

            should eql @w_1 #if I comment out this the spec below will pass

        end

    end

    context "when another week is added to hobby" do

        it "hobby should have two weeks" do

            @h_1.weeks.length.should eql 2
            @h_1.weeks.first(:id => 2).should_not eql nil

        end

    end

end 
```

# mysql - Mysql 两个查询合二为一（内连接？）

> ID：15823184
> 
> 赞同：1
> 
> 时间：2013-04-04T22:59:34.367
> 
> 标签：mysql

我需要在一个中返回两个查询的结果。我读过其他帖子，不确定这是否应该是内部连接。

我想要这两个查询：

```
MariaDB [servers]> select * from servers;
+----+------------+---------+------------+
| id | servername | ip      | returncode |
+----+------------+---------+------------+
|  1 | server1    | 0.0.0.0 | 0          |
|  2 | server2    | 0.0.0.0 | 1          |
|  3 | server2    | 0.0.0.0 | 0          |
|  4 | server3    | 0.0.0.0 | 0          |
|  5 | server3    | 0.0.0.0 | 4          |
|  6 | server3    | 0.0.0.0 | 4          |
|  7 | server3    | 0.0.0.0 | 4          |
+----+------------+---------+------------+

MariaDB [servers]> select servername,count(returncode) from servers where returncode<>0 group by servername;
+------------+-------------------+
| servername | count(returncode) |
+------------+-------------------+
| server2    |                 1 |
| server3    |                 3 |
+------------+-------------------+ 
```

变成这样：

```
MariaDB [servers]> select ?????????
+----+------------+---------+------------+-------------------+
| id | servername | ip      | returncode | count(returncode) |
+----+------------+---------+------------+-------------------+
|  1 | server1    | 0.0.0.0 | 0          | 0                 |
|  2 | server2    | 0.0.0.0 | 1          | 1                 |
|  3 | server2    | 0.0.0.0 | 0          | 1                 |
|  4 | server3    | 0.0.0.0 | 0          | 3                 |
|  5 | server3    | 0.0.0.0 | 4          | 3                 |
|  6 | server3    | 0.0.0.0 | 4          | 3                 |
|  7 | server3    | 0.0.0.0 | 4          | 3                 |
+----+------------+---------+------------+-------------------+ 
```

有人可以帮我理解如何做到这一点吗？我觉得这是一个内部连接，但是我不确定我是否完全理解这个概念..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:04:17.683

您可以使用子查询来获取`returncode`每个服务器的计数，然后使用表`LEFT JOIN`来`servers`获取结果：

```
select s.id, s.servername, s.ip, s.returncode, 
  coalesce(c.totalcount, 0) TotalCount
from servers s
left join
(
  select servername, count(returncode) TotalCount
  from servers
  where returncode<>0
  group by servername
) c
  on s.servername = c.servername; 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!2/36b0b/8)

我选择了一个，因此即使子查询中没有匹配的行，`LEFT JOIN`您也会从表中返回所有行。`servers`

# c++ - 如何将字符串转换为一系列整数？

> ID：15823185
> 
> 赞同：1
> 
> 时间：2013-04-04T22:59:35.053
> 
> 标签：c++, string, type-conversion

制作 RPG 并希望以铂金、金、银和铜为代表的货币。不幸的是，我的教授希望将货币存储为字符串（即字符串类，而不是 cStrings）。例如 -- 0.1.23.15 将是 0 铂、1 金、23 银和 15 铜。

我只想知道如何实现这一点的大想法。例如——我可以使用strtok（即我相信这只适用于cStrings）或其他一些C++函数来完成这个吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:25:11.757

这是一个解决方案：

```
#include <iostream>
#include <sstream>
#include <vector>

using namespace std;

int main()
{
    string str="0.1.23.15",temp;
    stringstream s(str);
    vector<int> v;

    while(getline(s,temp,'.'))
    {
        v.push_back(stoi(temp));
    }

    for(int i: v) cout << i << endl;//C++11 style
    //for(int i=0; i<v.size(); i++) cout << v[i] << endl; //Old school :D
    system("pause");
    return 0;
} 
```

# functional-programming - 如何通过给出一年中的两天来获得月份的 int 列表？

> ID：15823187
> 
> 赞同：-3
> 
> 时间：2013-04-04T22:59:53.167
> 
> 标签：functional-programming, sml, smlnj

编写一个名为month_range 的函数，它将一年中名为day_one 和day_two 的两天（例如65、128，假设一年有365 天）作为输入并返回其月份的int 列表。必须`day_two - day_one + 1;` 知道这个 int 列表的大小，如果 day_one>day_two，则列表大小 = 0

示例：`month_range(25,36) should return [1,1,1,1,1,1,1,2,2,2,2,2]`一月(25,26,27,..,31) 和二月(1,2,..,5)

我写了代码，但它不起作用：

```
 fun month_range (day1:int,day2:int) =
 let
   val month_days= [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
 fun what_month(day :int) =
   let  
   fun aux(sum :int,  numbers: int list) =
let
  val numbers_tail = tl numbers
in
  if sum <= (hd numbers)
  then 1
  else    
    1 + aux(sum, (hd numbers + hd numbers_tail)::(tl numbers_tail))
end
in
  aux(day, month_days)
end
in
  if (day1>day2)
  then []
  else what_month(day1) @ what_month(day2)
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:44:09.297

好吧，根据您[之前的问题](https://stackoverflow.com/q/15787541/577513)，您有一个函数`what_month`，它将返回一年中给定日期的月份数。

`day_one`您可以非常简单地从through迭代，每次都`day_two`调用您的函数。`what_month`

现在把它全部放在一个结果列表中，可以通过将结果`what_month`与对函数的递归调用连接起来，索引增加一，在索引到达时与空列表连接`day_two`。

# parsing - RIFF Wave 文件格式：FourCC 值和 HEX 转换

> ID：15823189
> 
> 赞同：1
> 
> 时间：2013-04-04T23:00:13.820
> 
> 标签：parsing, hex, wave, chunks, riff

**上下文：** 我正在解析 Riff/Wave 文件。有[文档](http://www.sonicspot.com/guide/wavefiles.html)标识 Riff 块中的 FourCC 值。以下是波形文件更重要的块。

**两个 .wav 特定块的 FourCC ID：**

```
 Chunk ID   "fmt " (0x666D7420)
 Chunk ID   "data" (0x64617461) 
```

因此，这些 fmt 值*应该*相等：

```
 string "fmt "
 Hex "666D7420"
 int "1718449184" 
```

并且，这些数据值*应该*相等：

```
 string "data"
 Hex "64617461"
 int "1684108385" 
```

现在，当我读入有效的 .wav 文件时，FourCC fmtChunkID fmt **int**总是：

```
 fmt int:
 int "544501094" 
```

并且数据**int**始终是：

```
 data int:
 int "1635017060" 
```

**问题：** 为什么记录的 Hex 值与我从流中返回的 int 不匹配？我猜我不了解十六进制到整数的转换。

**额外：** 我在网上找到了具有可疑 fmt 值“1718449184”的 .wav 解析器代码。但我发现更多 fmt 值“544501094”。最后，谷歌搜索“1718449184 AND 544501094”；没有。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:03:49.900

端。请参见十进制的 0x20746d66。（0x20746d66 是 0x666d7420 字节的反转。）

在文件格式中，每个字节都必须位于正确的位置。如果您随意将它们读入和读出内存，则取决于您的 CPU 与文件格式，您可以交换字节顺序。

阅读“Big Endian”和“Little Endian”。有些人会用很长的篇幅来讨论它，但实际上很容易理解，如果您曾经处理过文件格式、网络流量、与硬件的接口以及许多其他地方，那么了解它很重要。

# ios - CorePlot：xAxis NSDateFormatter 麻烦

> ID：15823192
> 
> 赞同：0
> 
> 时间：2013-04-04T23:00:39.340
> 
> 标签：ios, objective-c, xcode, core-plot

我正在使用 coreplot 制作一个应用程序，并试图让我的标签沿着 Xaxis 读取 12pm 、 1pm 、 2pm 等。我已经成功地将 NSDateFormatter 实现到 xAxis.label 格式化程序中。

问题是，间隔似乎以秒为单位（见下图）我需要它们以小时为单位。

![在此处输入图像描述](https://i.stack.imgur.com/qPruY.png)

我试图通过将 xAxis.majorIntervalLength 设置为 3600 来解决此问题，但这只会使图表看起来像这样：

![在此处输入图像描述](https://i.stack.imgur.com/kLgIy.png)

刻度仍然存在，但现在它们只是分开放置 3600，如果这有意义的话。这是我的代码：

```
CPTXYAxisSet *faxisSet = (CPTXYAxisSet *)self.graph.axisSet;

    faxisSet.xAxis.title = @"Time";
    faxisSet.xAxis.titleTextStyle = textStyle;
    faxisSet.xAxis.titleOffset = 30.0f;
    faxisSet.xAxis.axisLineStyle = axislineStyle;
    faxisSet.xAxis.majorTickLineStyle = axislineStyle;
    faxisSet.xAxis.minorTickLineStyle = axislineStyle;
    faxisSet.xAxis.labelTextStyle = textStyle;
    faxisSet.xAxis.labelOffset = 3.0f;
    faxisSet.xAxis.majorIntervalLength = CPTDecimalFromFloat(3600.0f);
    faxisSet.xAxis.minorTicksPerInterval = 1;
    faxisSet.xAxis.minorTickLength = 5.0f;
    faxisSet.xAxis.majorTickLength = 7.0f;
NSString *dats1 = @"16";
    NSDateFormatter *dateFormatter3 = [[[NSDateFormatter alloc] init] autorelease];
    [dateFormatter3 setDateStyle:NSDateFormatterMediumStyle];
    [dateFormatter3 setDateFormat:@"hh:mm:ss a"];
    CPTTimeFormatter *timeFormatter  =   [[CPTTimeFormatter alloc]initWithDateFormatter:dateFormatter3];
    timeFormatter.referenceDate =   [dateFormatter3 dateFromString:dats1];
    faxisSet.xAxis.labelFormatter    =   timeFormatter; 
```

基本上，我希望每隔一个刻度线读取几个小时，但我希望它们保持相同的距离。

我会很感激任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:36:44.687

查看[CPTCalendarFormatter](http://core-plot.googlecode.com/hg/documentation/html/iOS/interface_c_p_t_calendar_formatter.html)。它按单位间隔（例如，小时）而不是像`CPTTimeFormatter`.

# .net - ReaderWriterLockSlim（不是那么苗条）替换，递归，可升级读取？

> ID：15823193
> 
> 赞同：2
> 
> 时间：2013-04-04T23:00:51.780
> 
> 标签：.net, multithreading, readerwriterlockslim

不知何故`ReaderWriterLockSlim`，我们的代码中有很多。它们每个都占用6K内存，因此这已成为一个大问题。

作为一个快速修复，我正在寻找一个内存消耗较少的替代品。我正在尝试[Joe Duffy 的 RW-lock](http://www.bluebytesoftware.com/blog/2009/02/21/AMoreScalableReaderwriterLockAndABitLessHarshConsiderationOfTheIdea.aspx)，但它不可升级和写递归（而且很难做到）。

还有其他更多的记忆灯替代品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:08:47.997

好吧，一个明显的方法是使用[ReadWriterLock](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlock.aspx) (sans Slim)，我认为它占用的内存较少（但在某些情况下效率也较低）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-07T21:06:49.050

如果其他人需要与以下语义相同的内存更轻的 RW 锁`ReaderWriterLockSlim`：

*   可升级；
*   递归的；
*   lock 属于一个线程，因此，例如，递归 W-lock 可以，或者 W-lock 内部的 R-lock 可以；

[来自 Mono 源](https://github.com/mono/mono/blob/master/mcs/class/referencesource/System.Core/System/threading/ReaderWriterLockSlim/ReaderWriterLockSlim.cs)的那个应该没问题。

# r - 是否可以在 stargazer 表中报告 NA？

> ID：15823207
> 
> 赞同：2
> 
> 时间：2013-04-04T23:02:58.927
> 
> 标签：r, latex, stargazer

[Stargazer](http://cran.r-project.org/web/packages/stargazer/)包为我提供了非常好的描述表，可以包含在乳胶文档中。

```
library(stargazer)
stargazer(attitude) 
```

![在此处输入图像描述](https://i.stack.imgur.com/A1cCH.jpg)

是否可以为每个变量添加一列报告 NA 数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:49:24.517

此代码段将为您提供数据框中每行和每列的 NA 数

```
# make some data
count <- 10
data <- data.frame( a=runif(count), b=runif(count))

# add some NAs
data[data$a>0.5,]$a <- NA
data[data$b>0.5,]$b <- NA

# NAs per row
data$NACount <- apply(data, 1, function(x) {length(x[is.na(x)])})

# NAs per column
NACountsByColumn <- lapply(data, function(x) {length(x[is.na(x)])} ) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-09T16:00:59.347

stargazer 的“N”列不计算 NA。虽然没有直接的方法在输出表中输入 NA，但您可以简单地计算它

nrow(dataset) - “N”列中的数字

# bash - awk 系统调用

> ID：15823216
> 
> 赞同：17
> 
> 时间：2013-04-04T23:03:57.320
> 
> 标签：bash, awk

我想使用 awk 和`system()`函数来移动几个目录。

我有一个要处理的文件，其`awk`名称`file.cfg`按以下方式组织：

```
/path1 /path2 
/some_path /some_other_path 
and so on.. 
```

每个第一条路径与第二条路径由一个空格隔开所以这就是我的做法：

```
awk '{system(mv -R $1" "$2)}' file.cfg 
```

但它不起作用，我得到

```
sh: 0/home/my_user/path1: No such file or directory 
```

但`file.cfg`看起来像这样：

```
/home/my_user/path1 /home/my_user/path2 
```

而且之前没有0 `/home`。那么我在这里错过了什么？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-04-04T23:14:31.960

你必须引用你给的命令`system`：

```
awk '{system("mv -R " $1 " " $2)}' file.cfg 
```

当前`mv -R`被解释为变量 mv 的值减去 R 的值，`0`因为两者都没有定义。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-04T23:09:02.623

为什么不直接使用 xargs？

```
cat file.cfg | xargs -n 2 mv 
```

这会将标记（由空格分隔）从您的文件以两个一组传递到 mv 中。

# c++ - C++ 标准是否保证 std::uintmax_t 可以保存 std::size_t 的所有值？

> ID：15823217
> 
> 赞同：23
> 
> 时间：2013-04-04T23:04:01.430
> 
> 标签：c++, c++11

C++ 标准是否保证（通过明确说明或通过逻辑推论隐含）`std::uintmax_t`可以保存`std::size_t`?

或者是否有可能`std::numeric_limits<std::size_t>::max()`大于`std::numeric_limits<std::uintmax_t>::max()`？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-04T23:08:25.403

是的。

`size_t`被定义为一个无符号整数类型，其大小足以包含任何对象的大小。`uintmax_t`被定义为能够存储任何无符号整数类型的任何值。因此，如果`size_t`可以存储它，`uintmax_t`可以存储它。

`size_t`来自 C++11 §18.2的定义：

> size_t 类型是实现定义的无符号整数类型，它大到足以包含任何对象的字节大小。

来自 C99 §7.18.1.5的定义`uintmax_t`（通过规范性参考包含在 C++ 中）：

> 以下类型指定了一个无符号整数类型，能够表示任何无符号整数类型的任何值：
> 
> ```
> uintmax_t 
> ```

# cookies - 重新加载时记住活动类

> ID：15823218
> 
> 赞同：0
> 
> 时间：2013-04-04T23:04:12.963
> 
> 标签：cookies, reload

我正在创建一个单页网站 - 当用户位于页面的当前部分时，菜单项将类更改为“活动” - 这很好，但是浏览器“忘记”哪个菜单项是当前的重新加载。

有没有办法让浏览器在重新加载之前记住哪个元素是最后一个让类“活动”的元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:24:40.783

当用户位于页面的特定部分时 - 设置为 cookie：`section=idOfTheSection` 并添加加载时检查 cookie 并将正确的类设置为“活动”的 javascript 函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:12:52.310

使用[localStorage](http://diveintohtml5.info/storage.html)。

当您将项目标记为“活动”时，将其 ID 或编号保存在*localStorage*中。加载页面后，检索该信息并标记相应的项目。

# windows - 节点中的简单RequireJS

> ID：15823219
> 
> 赞同：3
> 
> 时间：2013-04-04T23:04:16.867
> 
> 标签：windows, node.js, requirejs

我想专门将 RequireJS 用于节点。

当我运行“node r.js file.js”时，我似乎无法让它在同一个文件中运行：

```
define('a', function () {
    console.log("loaded a");
    return {};
});

require(['a'], function(a){

}); 
```

有没有办法用requirejs的定义来覆盖define和require。

还有一种方法可以严格使用 r.js 而不是安装 requirejs npm。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T07:17:52.420

### 您可以在节点中使用 require.js！

require.js 文档[包括](http://requirejs.org/docs/node.html)关于使用 node.js 安装 require 的部分。

*   首先，你进入控制台（假设你有你应该拥有的 npm）并输入：

    `npm install requirejs`

*   在那之后，你们都准备好了。首先你需要 require （不是双关语），所以在你的主 js 文件的顶部，你需要类似：

    `var requirejs = require('requirejs');`

*   然后，您可以对其进行配置：

    `requirejs.config({/*your config with shims,etc goes here*/});`

而已！您现在可以使用它：

```
requirejs(["module1","module2"],function(mod1,mod2){
    //whatever here
}); 
```

[此页面](http://requirejs.org/docs/node.html)上有更详细的说明。

### 更大问题的更好解决方案：

您可以使用[browserify](https://github.com/substack/node-browserify)。

Browserify 允许您使用 node.js 样式`require()`语句在客户端和服务器之间共享代码。它为您的喜好填充常见的东西`process.nextTick`。它甚至可以填充模块`path`，`events`甚至`vm`.

我个人在几个生产项目中使用过它并且它有效。

# iphone - 带有图像和边框的 UIBarButtonItem

> ID：15823227
> 
> 赞同：0
> 
> 时间：2013-04-04T23:05:28.073
> 
> 标签：iphone, objective-c, uinavigationbar, uibarbuttonitem

怎么可能有类似[http://www.nutsaboutmac.com/wp-content/uploads/2012/11/ShareLinktoFacebook.png](http://www.nutsaboutmac.com/wp-content/uploads/2012/11/ShareLinktoFacebook.png)

到目前为止，我已经为我的 NavigationBar 和我的 BarButtonItem 放置了相同的背景图像。问题是按钮不再有边框，你不能再做 NavigationBar 和 Button 之间的区别了......

```
UIImage *image = [UIImage imageNamed:@"facebook_texture.png"];
[cancelButton setBackgroundImage:image forState:UIControlStateNormal style:UIBarButtonItemStyleBordered barMetrics:UIBarMetricsDefault];
[topBar setBackgroundImage:image forBarMetrics:UIBarMetricsDefault]; 
```

如何更改背景但保持边框样式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:28:52.793

您不能设置自定义背景图像。边框是背景图像，它可以是您自己的，也可以是系统的。

### => 没有办法，只能制作自己的图像

* * *

编辑：我认为你所描述的使用着色：`barButton.tintColor=color`并提供带有 alpha 或图案图像的颜色`colorwithPatternImage`

但是……用清晰的颜色或图案着色是行不通的。这是 sdk IMO 中的一个错误 => 没有办法，只能制作自己的图像

# lua - 魔兽世界 Lua - If 语句流程

> ID：15823228
> 
> 赞同：1
> 
> 时间：2013-04-04T23:05:30.370
> 
> 标签：lua, add-on, world-of-warcraft

我正在尝试为魔兽世界创建一个插件。我创建了一个函数来检查当前玩家是否添加了一个 buff。

```
Button:RegisterEvent("UNIT_AURA");
local function auraGained(self, event, ...)
    if (UnitAura("player", "Heating Up")) then
             if (heatingUpIsActive ~= 1) then
             heatingUpIsActive = heatingUpIsActive + 1
            print (heatingUpIsActive) 
            end 
    end
Button:SetScript("OnEvent", auraGained); 
```

这很好用，但我如何检查`UnitAura`是否*不是* `"Heating Up"`？

另外，我更喜欢 if`heatingUpIsActive`是 a `boolean`，但是当我这样做时似乎不喜欢。`boolean`在 Lua中创建的正确方法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:08:53.050

您的功能没有检查导致事件的光环。`UNIT_AURA`任何事件发生时，它都在寻找“加热” 。事实上，看起来`UNIT_AURA`事件实际上并没有告诉你是哪个光环触发了它。所以你不能“检查是否`UnitAura`不是*”* `"Heating Up"`，因为你根本不知道是什么光环导致了这个事件。说不定一下子就有好几个气场了。

但是，该事件确实会告诉您哪个单位获得了光环。这是第一个可变参数。`player`您可能应该在做某事之前检查以确保它

```
local unitid = ...
if unitid ~= "player" then return end 
```

另外，您没有解释布尔值有什么问题。你应该只能说类似

```
if not heatingUpIsActive then
    heatingUpIsActive = true
    -- do whatever you want
end 
```

尽管我从未在您的代码中看到任何变量声明。在这样的事情上使用全局变量是个坏主意，所以你应该声明

```
local heatingUpIsActive 
```

在函数声明之前，例如

```
local heatingUpIsActive
local function auraGained(self, event, ...)
    -- ... 
```

# java - 使用 BufferedReader-java 陷入 while 循环

> ID：15823232
> 
> 赞同：1
> 
> 时间：2013-04-04T23:05:58.627
> 
> 标签：java, while-loop, bufferedreader

我完全不知道为什么这不起作用。我以前有过类似的循环，它们运行良好。

```
try{
    text = new BufferedReader(new FileReader(fileName));

    while ((lineOfText = text.readLine()) != null){
                StringTokenizer tokens = new     StringTokenizer(lineOfText," , .;:\"&!?-_\n\t12345678910[]{}()@#$%^*/+-");
                while (tokens.hasMoreTokens()){
                    countTotalWordsInDocument++;
                    String word = tokens.nextToken();
                    countTotalCharactersInAllWords = countTotalCharactersInAllWords + word.length();
                }
            }
            text.close();
        } catch (IOException e) {
            System.out.println("file not found");
        } 
```

# jquery - 浮动图表工具提示错误 - 工具提示日期比 X 轴日期晚一天

> ID：15823233
> 
> 赞同：5
> 
> 时间：2013-04-04T23:06:04.800
> 
> 标签：jquery, flot

我一直无法理解为什么工具提示日期差了一天。我相信x轴是正确的，我一直在玩它，但这让我很生气。

我怎样才能解决这个问题？

我将来自 URL 端点的 JSON 传递到变量 jsonDataUrl。这是一个示例数据点：`[{date: "2013-01-01", value: 50}]`

而 cssSelector 只是占位符。

这是我的代码：

```
 $.getJSON(jsonDataUrl, function(res) {
   var data = [];
    $.each(res, function(i, entry){
      data.push( [new Date(entry["date"]), entry["value"]] );
    });

    var opts = { yaxis: { min: 0},
                 xaxis: { mode: "time", timeformat: "%m-%d"},

                 series: { lines: { show: true }, points: { show: true } },

                 grid: {hoverable: true, clickable: true}
    };

    $.plot($(cssSelector), [data], opts);

    $(cssSelector).bind("plotclick", function(event, pos, item) {
        if (item) {

            var x = parseInt(item.datapoint[0]),
                y = item.datapoint[1];
            var date = (new Date(x));
            var day = date.getDate();
            var month = date.getMonth() + 1;
            var formattedDate = month + "-" + day;

            $("#tooltip").remove();
            var label = "date: " + formattedDate + "<br/> count: " + y;
            showTooltip(item.pageX, item.pageY, label);
        }
    });
  }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T17:05:11.923

我希望这没问题，但我想回答我自己的问题。我很高兴我发现了这个愚蠢的错误！我正在使用 Ruby on Rails 收集数据并通过 JSON url 将其传递给 Flot Chart。由于服务器在 UTC 午夜记录数据，因此它在本地时区将数据传递到工具提示，使其完全不同步。

因此，我基本上将 date.getDate() 和 date.getMonth() 更改为 date.getUTCDate() 和 date.getUTCMonth()。

# regex - preg_match() 文本提取

> ID：15823237
> 
> 赞同：1
> 
> 时间：2013-04-04T23:06:19.293
> 
> 标签：regex, preg-match, text-extraction

我在一个段落中有这个字符串：

今天的名言是：'从昨天学习，为今天而活，为明天希望。重要的是不要停止提问。

我需要提取这句话“从昨天学习，为今天而活，为明天希望。重要的是不要停止提问。”

我不熟悉正则表达式，所以我想在这里得到一点帮助。我试过：

```
preg_match("Today's quote is: '[a-zA-Z0-9]'",$response, $matches); 
```

当然，正如我想象的那样它不起作用。任何帮助，将不胜感激。提前致谢。

编辑：我还需要在字母数字表达式中包含“_”和“-”。

例子：

`$string = "site : '6LcZwNcSAAAAAEcQkyCCSteouAQS9jO7wDrgzvbL', rtl : false, challenge : '03AHJ_Vuv_3y7kY-GQaCyzgrz9ZTv_cFQN_F0jEqOGNq0-3QANrsxJ18oPj4bbhRqPoISIZbqBBdeEXVfpnnVjlTsjoxQugI4j0zB1yRQU1m4wXzFGVRpuRyXJmnJU3d7Ix0nhyO_OBeFCR7v9gXtz_BNN04tSzXxVyvKCExO9I2vcqcIhWJQE8K8'";`

我需要匹配“挑战”一词之后的字符串。包含下划线和“-”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:21:26.157

这应该做的工作：

```
$string = "Today's quote is: 'Learn from yesterday, live for today, hope for tomorrow. The important thing is not to stop questioning.'";
preg_match('/.*?:.*?\'(.*?)\'/', $string, $m);
echo $m[1]; // Learn from yesterday, live for today, hope for tomorrow. The important thing is not to stop questioning. 
```

EDIT2：在OP展示了另一个例子之后。这是该编辑的解决方案：

```
$string = "site : '6LcZwNcSAAAAAEcQkyCCSteouAQS9jO7wDrgzvbL', rtl : false, challenge : '03AHJ_Vuv_3y7kY-GQaCyzgrz9ZTv_cFQN_F0jEqOGNq0-3QANrsxJ18oPj4bbhRqPoISIZbqBBdeEXVfpnnVjlTsjoxQugI4j0zB1yRQU1m4wXzFGVRpuRyXJmnJU3d7Ix0nhyO_OBeFCR7v9gXtz_BNN04tSzXxVyvKCExO9I2vcqcIhWJQE8K8'";
preg_match_all('/.*?:.*?\'(.*?)\'/', $string, $m);
var_dump($m); 
```

# php - PHP返回其他用户请求的输出

> ID：15823250
> 
> 赞同：0
> 
> 时间：2013-04-04T23:08:10.087
> 
> 标签：php, mysql, session, iis, fastcgi

我正面临 PHP 响应的问题。我使用延迟 3 秒的 Ajax 来检查用户的日志。当用户帐号与两个用户同时使用时，必须踢出其中一个。如果与会话相等，我曾经跟踪 db 中的日志 ID。问题是即使没有其他用户使用他/她的帐户，一些用户也会被踢。我尝试`print_r`查询语句，它返回不同的值。这可能是其他用户的响应。

我正在使用 IIS 服务器和 FastCGI 进行 PHP 响应。

有人能告诉我这怎么可能，并给我解决这个问题的想法吗？谢谢。

这是一些代码：

使用 Ajax 检查数据库中的日志：

```
public function CheckLogStatus( $name, $email, $sess_code ) { 

    $qry = "Select log from $this->tablename where name='$name' and email='$email'";
    //when I print this statement it returns different values of $name and $email

    $result = mysql_query( $qry ) or die(mysql_error()); 

    if( !$selResult = mysql_fetch_array($result) ) {
        return false;
    }

    if(!isset($_SESSION)) {
        session_start();
    }

    if( !isset( $selResult['log'] ) && $selResult['log'] != '' ) {
        if( $selResult['log'] != $sess_code ) {
            //$_SESSION['LOGS'] = 'USED';
            return false;
        }
    }

    return true;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:47:55.650

```
<?php
session_start();
$_SESSION['LOG'] = $log;
setcookie("Log",$log,time()*24*60*60); //expires after 24hrs
?> 
```

功能 CheckLogStatus 与您上面提到的相同，

```
<?php
public function CheckLogStatus( $name, $email, $sess_code ){
$qry = "Select log from $this->tablename where name='$name' and email='$email'";
$result = mysql_query( $qry ) or die(mysql_error());
if( !$selResult = mysql_fetch_array($result) ){
return false;
}
if(!isset($_SESSION)){ session_start(); }
if( !isset( $selResult['log'] ) && $selResult['log'] != '' ){ 

         if( $selResult['log'] != $sess_code ) {
    return false;
}
}

return true;
}
?> 
```

但路过的时候，

```
<?php
CheckLogStatus( "Myname", "contact@email.com", $_COOKIE['Log'] );
?> 
```

# css - 后台固定phonegap

> ID：15823254
> 
> 赞同：1
> 
> 时间：2013-04-04T23:08:35.747
> 
> 标签：css, cordova, background

我对 Phonegap 的背景有疑问

我也在使用 JQuery 移动

这是我的 CSS 代码女巫生成背景

```
html, body {
    top: 0px;
    left: 0px;
    height: 100%;
    width: 100%;
} 

.ui-page{
    top: 0px;
    left: 0px;
    background: url('../img/bg.jpg') 0 0 no-repeat fixed !important;
    background-size: auto 100%;
    height: 100%;
    width: 100%;
    font-family: MankSans;
    background-position:fixed;
    background-color:#102a3e;
} 
```

当我在页面中滚动时，我的背景停留在顶部，但我的背景未获取的部分保持白色，我不明白为什么

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:12:40.203

`!important`从你的风格中删除。这会覆盖您的`background-color`. 只需使用

```
.ui-page {
    background: #102a3e url('../img/bg.jpg') 0 0 no-repeat fixed;
} 
```

# c++ - c ++从文件开头读取到指定字节

> ID：15823255
> 
> 赞同：2
> 
> 时间：2013-04-04T23:08:40.597
> 
> 标签：c++, seekg

试图将一个文件从文件中的第一个字节读取到用户指定的字节。我需要逻辑上的帮助。例如，如果文件只有字母 a 到 z，我只想读取并显示前 10 个。这是我写的一段：

```
 char byte;
  inFile.seekg(0L,ios::beg);
  inFile.get(byte);
  cout << byte;

  for(int i = 0; i < num; i++);  //num is an int specified by the user.
  {
      inFile.seekg(1, ios::cur);
      inFile.get(byte);
      cout << byte;
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T08:09:23.180

第一个问题 - 行尾的分号`for()`：

```
 for(int i = 0; i < num; i++);
    {
        ...
    } 
```

编译器看到的实际上是这样的：

```
 for(int i = 0; i < num; i++) { /* do nothing num times */ }

    {
        // code that will only run once
    } 
```

所以，去掉分号。

接下来，如果您只是连续读取字节，则无需在每个字节之间进行查找。只需调用`get()`将获得序列中的下一个字节。所以删除`seekg()`电话。

最后一个问题 - 这个函数实际上`inFile.get()`总共调用了`num + 1`几次。第一次调用是在`for`循环之前。然后在`for`循环中，`get()`称为`num`次数（即 i = 0, 1, 2, 3 ... num-1）。您可以通过将`for`循环计数器更改为`(i = 1; i < num; i++)`或仅在循环之前删除`get()`调用来解决此问题`for`。在下面的代码中，我选择了第二种方式：

```
void run(int num, istream &inFile)
{
    char byte;

    for(int i = 0; i < num; i++)
    {
        inFile.get(byte);
        cout << byte;
    }
} 
```

# installation - 如何强制 Inno Setup 使“uninsneveruninstall”标志具有追溯性？

> ID：15823256
> 
> 赞同：1
> 
> 时间：2013-04-04T23:08:47.843
> 
> 标签：installation, inno-setup

Inno Setup`unins000.dat`在应用程序的安装目录中保留一个“卸载日志”文件。此文件包含删除应用程序时要卸载的所有文件的列表。当应用程序的新版本安装在旧版本之上时，Inno Setup 只会将任何新文件附加到“卸载日志”。

我的应用程序的早期版本在卸载时会删除一些用户修改的模板文件，因为我忘记包含`uninsneveruninstall`这些文件的标志。

在最新版本的软件中，`uninsneveruninstall`设置了标志，并且文件不会被删除.......除非在损坏的版本上安装了最新版本。然后，因为这些文件在卸载日志中没有该标志，所以它们会在卸载时被删除！

我不能要求我的用户在升级之前卸载旧软件，因为那样他们会丢失这些文件。

我可以强制 Inno Setup 从头开始​​重新生成卸载日志吗？或者至少删除/覆盖这些文件的条目？我希望该`uninsneveruninstall`标志具有追溯性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T09:24:38.437

您不能追溯更改该标志。一旦它被释放，那就是它。

但是，一个选项是，在安装过程中，检测已安装的较旧的损坏版本（如果不是按版本号，可能是注册表中的一个标志表明已应用修复）并备份有问题的文件夹，执行卸载（默默地）然后恢复文件夹。然后设置可以正常进行。

# sql - 如何获取 SQL Server 2008 查询中的行数

> ID：15823262
> 
> 赞同：0
> 
> 时间：2013-04-04T23:09:05.513
> 
> 标签：sql, sql-server, sql-server-2008

如何使用 SQL 查询获取行数？

我试过这个：

```
SET @Records = count(*) SELECT * FROM  [INVENTORY].[TBL_RECEIPTS] 
                WHERE Field_Tag = '1234' 
```

但它给出了 1\. 上面的代码有什么问题？

实际上没有行，它应该给输出 0

当我执行这个

```
SELECT * FROM  [INVENTORY].[TBL_RECEIPTS] 
WHERE Field_Tag = '1234' 
```

它给出了结果 0

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:09:47.410

采用

```
SET @Records = (SELECT count(*)
                  FROM [INVENTORY].[TBL_RECEIPTS]
                 WHERE Field_Tag = '1234') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T23:15:14.260

```
SELECT @Records = COUNT(*) FROM INVENTORY.TBL_RECEIPTS
   WHERE Field_Tag = '1234'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T23:16:20.203

做这些 - 任何一个都应该工作，但我更喜欢第二个代码

```
SET @Records = (SELECT Count(*) FROM  [INVENTORY].[TBL_RECEIPTS] 
                WHERE Field_Tag = '1234') 
```

或者

```
SELECT @Records = Count(*) FROM  [INVENTORY].[TBL_RECEIPTS] 
                WHERE Field_Tag = '1234' 
```

# ruby-on-rails - Ruby on Rails：部署到 Heroku 时，BlueCloth gem 无法在生产环境中工作

> ID：15823267
> 
> 赞同：0
> 
> 时间：2013-04-04T23:09:32.830
> 
> 标签：ruby-on-rails, ruby, heroku, markdown, bluecloth

我正在尝试使用`BlueCloth`gem 来解析我的 rails 应用程序的一些降价。我将它添加到我的 gem 文件中：

```
 gem 'BlueCloth' 
```

在我看来`.html.erb`，我使用代码

```
 <%=  BlueCloth.new(post.content).to_html.html_safe %> 
```

将降价呈现为 html。这在我的本地开发环境中完全可以正常工作，但是当我推送到 heroku 时，即使在运行`bundle install`并重新启动应用程序之后，访问应用程序也会产生内部服务器错误。

我在日志中收到以下错误：

```
 ActionView::Template::Error (uninitialized constant ActionView::CompiledTemplates::BlueCloth): 
```

我`BlueCloth`在 gem 文件中包含：

```
source 'https://rubygems.org'

gem 'rails', '3.2.8'

gem 'pg'

group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'uglifier', '>= 1.0.3'
end

gem 'jquery-rails'

gem 'devise'
gem 'BlueCloth' 
```

我还`bundle install`通过 heroku 命令行运行了该命令。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:36:10.687

看起来您手动需要文件。如果您使用一切为您服务，那么您可能会更容易`bundler`，`require`然后您不必添加`require`到任何其他`.rb`文件。这样做非常简单。根据您的 Rails 版本，这里有两个链接可以帮助您：

[导轨 2.3](http://gembundler.com/v1.3/rails23.html)

[导轨 3](http://gembundler.com/v1.3/rails3.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T23:57:03.313

问题是我使用的是旧版本的`BlueCloth`gem。

旧宝石称为`BlueCloth`新宝石`bluecloth`

更改我的 gem 文件中的行：

```
 gem 'BlueCloth' 
```

到：

```
 gem `bluecloth` 
```

修复。

谢谢。

# asp.net-mvc - ASP MVC3 ActionLink 不呈现变量

> ID：15823268
> 
> 赞同：1
> 
> 时间：2013-04-04T23:09:35.500
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, actionlink

我正在尝试使用 ASP MVC3 操作链接导航到另一个视图（相同的控制器）。该视图附加到使用复合键作为其主键的模型。下面是写在视图上的操作链接

```
@Html.ActionLink("Edit Agent", "AgentEdit", "BankListMasterController", 
                                                new { @agentId = int.Parse(item.AgentId), @id = item.ID}) 
```

但是，当它被呈现时，它呈现如下

```
http://localhost:2574/BankListMaster/AgentEdit?Length=24 
```

这显然会引发错误：

```
The parameters dictionary contains a null entry for parameter 'agentId' of non-nullable type 'System.Int32' for method 'System.Web.Mvc.ViewResult AgentEdit(Int32, Int32)' in 'Monet.Controllers.BankListMasterController'. An optional parameter must be a reference type, a nullable type, or be declared as an optional parameter.
Parameter name: parameters 
```

这是用于良好测量的控制器方法：

```
 public ViewResult AgentEdit(int agentId, int id)
    {
        string compare = agentId.ToString();

        BankListAgentId agent = (from c in db.BankListAgentId
                                 where c.ID == id &&
                                       c.AgentId.Equals(compare)
                                 select c).Single();

        return View("AgentEdit", agent);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:16:11.703

```
@Html.ActionLink("Edit Agent", "AgentEdit", "BankListMasterController", 
                                                new { agentId = int.Parse(item.AgentId), id = item.ID}, null) 
```

这应该够了吧

理由是：根据[http://msdn.microsoft.com/en-us/library/system.web.mvc.html.linkextensions.actionlink(v=vs.108).aspx](http://msdn.microsoft.com/en-us/library/system.web.mvc.html.linkextensions.actionlink(v=vs.108).aspx)

你不会找到使用 (HtmlHelper, string, string, string, object) 的方法，但是 (HtmlHelper, string, string, string, object, object) 倒数第二个对象是路由值，最后一个是 html 属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:20:58.273

根据您提供的参数，调用了错误的 ActionLink。

问题是它“试图序列化一个字符串对象”

这是对“链接中的'Length'参数”问题的规范答案： [Why does Html.ActionLink render "?Length=4"](https://stackoverflow.com/questions/824279/why-does-html-actionlink-render-length-4)

# uitableview - 在 Uitableview 单元格中一次又一次地加载异步图像

> ID：15823273
> 
> 赞同：0
> 
> 时间：2013-04-04T23:10:00.087
> 
> 标签：uitableview, uiimageview

异步图像遇到问题不知道为什么会出现这个奇怪的问题。我正在应用异步图像加载技术，但图像在滚动加载后不会冻结，它们会再次加载。

```
 - (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell=[self getCellContentView:CellIdentifier];
    }
    [cell setBackgroundColor:[UIColor redColor]];
    NSLog(@"%i",[discussionArray count]);
    NSDictionary *dict=[discussionArray objectAtIndex:indexPath.row];
    UILabel *textLabel1 = (UILabel *)[cell viewWithTag:1];
    UILabel *textLabel2 = (UILabel *)[cell viewWithTag:2];
    UILabel *textLabel3 = (UILabel *)[cell viewWithTag:3];
    UIImageView *avatarimage = (UIImageView *)[cell viewWithTag:4];
    UIImageView *new_oldimage = (UIImageView *)[cell viewWithTag:5];
    UIImageView *avatarimage_cover = (UIImageView *)[cell viewWithTag:6];

    textLabel1.text =[dict objectForKey:@"user"];
    textLabel2.text =[dict objectForKey:@"date"];
    textLabel3.text =[dict objectForKey:@"text"];

    NSString *photoStrn=[dict objectForKey:@"photo"];
    avatarimage.image = nil;
    dispatch_async(dispatch_get_global_queue(0,0), ^{
        NSString *u=[NSString stringWithFormat:@"http://%@",photoStrn];
        NSURL *imageURL=[NSURL URLWithString:u];
        NSData *imageData = [NSData dataWithContentsOfURL:imageURL];
        dispatch_sync(dispatch_get_main_queue(), ^{
            UIImage *dpImage = [UIImage imageWithData:imageData];
            if (dpImage==nil)
            {
                dpImage = [UIImage imageNamed:@"profileImage.png"];
            }

            [UIView animateWithDuration:5.0 animations:^{
                avatarimage.alpha = 1.0;
            }];
            avatarimage.image = dpImage;

        });

    });

    avatarimage_cover.image = [UIImage imageNamed:@"avtrcover.png"];

    NSString *new=[dict objectForKey:@"new"];
    if ([new isEqualToString:@"0"])
    {
        new_oldimage.image = [UIImage imageNamed:@"old_message.png"];
    }
    else
    {
        new_oldimage.image = [UIImage imageNamed:@"new_message.png"];
    }

    textLabel3.numberOfLines = 0;
    NSString *detailText = [[discussionArray objectAtIndex:indexPath.row] objectForKey:@"text"];
    CGSize textSize = [detailText sizeWithFont:[UIFont boldSystemFontOfSize:13] constrainedToSize:CGSizeMake(240, MAXFLOAT) lineBreakMode:UILineBreakModeWordWrap];
    textLabel3.frame = CGRectMake(70, 53, 240, textSize.height+detailTextoffset );
    return cell;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T09:36:32.210

这将彻底解决您的问题。点击以下链接：

[单元格顶部的图像](https://stackoverflow.com/questions/15267046/image-on-top-of-cell/15268636#15268636)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T07:07:08.277

`avatarimage.image`每次配置单元时，您都设置为 nil。无论如何，您都调用加载代码。因此，您不断重新加载图像也就不足为奇了。

相反，您应该维护一个可变的下载图像数组。这可能只是文档文件夹中某处图像的文件 URL。如果图像存在使用它，如果不下载它。

```
if (imageArray[indexPath.row]) {
  // use the image to populate the image view
}
else {
  // fetch async from server
} 
```

# c++ - 由外而内与由内而外的方法教学 OOP (C++)

> ID：15823276
> 
> 赞同：6
> 
> 时间：2013-04-04T23:10:21.173
> 
> 标签：c++, oop

我在一所高中经营一个编程俱乐部，我已经使用 C++ 中的简单课程向我的学生介绍了 OOP。我相信至少在理论上他们明白了。我希望能够为他们提供一个他们可以一起工作的特定项目。我的问题是采取哪种方法。当我在大学上编程课时，我看到了两种不同的方法，但在我看来它们都有严重的缺陷。我最终睡了大多数，并从书本和示例中自己学习了这些东西。既然我站在老师的立场上，我想就哪种方法更可取或是否有第三种选择征求您的意见。

使用的方法 1 是在板上（或在带有投影屏幕的计算机上）编写程序。类定义总是先写的。通常学生在这一点上看起来真的很困惑，因为变量和方法的目的对他们来说似乎完全模糊。他们了解每个变量和方法的用途以及它们如何交互的唯一时间是讲师最终编写实现的时候（我称之为由外向内的方法）

方法 2 是解释我们想要实现的目标，并根据需要创建类和成员。这有相反的问题。他将编写一个方法来使用这些稍后必须实现的虚构类。但学生们不知道这些其他课程将如何运作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T23:29:16.613

碰巧的是，我通过担任老师的工作完成了大学的学习。我现在是一名软件工程师。

根据我的经验，最重要的是让学生在编程项目中投入情感。我会在一分钟内回答你的问题，这是一个必要的序言。

为了做到这一点，我把节目的主题变成了他们真正感兴趣的东西，不管它看起来多么愚蠢，只要它是与他们的世界相关联的东西。

因此，可能是（取决于学生的年龄）按天赋水平对歌唱明星进行排名，包括贾斯汀比伯。你可以想象那场的喧嚣。

比如，加载他们的歌词并计算他们说“宝贝”这个词的次数。有创意的，有趣的。

这将使“枯燥”的问题变得生动起来。比如，“歌手”班应该是什么样子。为什么它应该具有诸如“八度范围”之类的属性将立即直观。

歌手类应该有一个名为“barfOnStage”的方法吗？（Biebs 不久前在舞台上大喊大叫）。当然，为什么不呢！？他们将很容易看出方法和属性之间的区别。

我的意思是，我只是在胡说八道，我相信您可以将自己的创造力和创造力应用到适合您孩子的任何事情上。

我很想听听你做了什么，以及孩子们的项目结果如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T07:02:14.577

If it's a beginner programming course I'd say the OOP aspect is of minor issue. Focus on expressions, statements and control flow.

If the focus is on OOP I'd say begin with the history of OOP and what OOP focus is. From that one can look at how one describe these concepts in different languages. (i.e. ADT, Simula etc [http://retis.sssup.it/~lipari/courses/oosd2010-1/02.oop.pdf](http://retis.sssup.it/~lipari/courses/oosd2010-1/02.oop.pdf) )

...and then experiment.

> *"If we look at the whole history, we see that the proto-OOP stuff started with ADT, ..."* -- Alan Kay ([http://userpage.fu-berlin.de/~ram/pub/pub_jf47ht81Ht/doc_kay_oop_en](http://userpage.fu-berlin.de/~ram/pub/pub_jf47ht81Ht/doc_kay_oop_en))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T06:26:18.537

对于初学者级别，我会采用修改后的 2 号方法，您从一个简单的问题开始，然后在此基础上进行构建。经验是最好的老师......就像我的高中老师让我们“迭代”通过二十个离散变量作为“列表”*然后*教我们数组......

你需要选择正确的问题。它需要是一个锻炼“面向对象肌肉”而不是“算法肌肉”的问题。它必须是您可以在其上构建要求以练习面向对象的东西。一个简单的 CRUD 程序就足够了。你只需要限制他们使用对象而不是数组，因为我认为他们会很舒服。我会把确切的规格留给你。

**首先**，让他们编写一个程序，让他们将记录添加到“数据库”。仅仅通过在他们的“数据库”中创建一个“行”，他们将被迫学习如何创建一个对象和实例化一个对象。

**接下来**，让他们修改他们的程序以显示他们的“数据库”的内容。当他们阅读他们的“数据库”时，他们将行使 .show 功能，或者您实现该功能。

**第三**，让他们制作，以便他们可以更改“记录”的内容。更新将强化如何告诉对象修改自身。

**最后**，他们应该修改程序以允许删除“记录”。这将加强适当的对象破坏。

把它提升到一个新的水平（因为这是 c++）你可以：

*   要求他们将“数据库”实现为链表

*   编写规范，以便您可以做一些需要将对象添加在一起的事情

*   添加到数据范围，以便通过模板或继承更好地促进程序结构（例如，同时具有汽车和摩托车的车辆“数据库”）

根据我的经验，做是最好的老师。有人向我展示如何做某事（或在板上以小组的形式进行）会缩短学习时间。与它搏斗并获得一些苏格拉底式的指导可以教会更深入的理解并产生更好的编程大脑。

如果他们还没有准备好执行“创建”功能，那么在白板上将其编码为一个组就可以了，但是一旦他们有了一个所有东西如何组合在一起的模板，他们就需要在计算机后面弄清楚。

# java - Java mysql，使用 PreparedStatement 进行简单更新有语法错误

> ID：15823278
> 
> 赞同：5
> 
> 时间：2013-04-04T23:10:37.803
> 
> 标签：java, mysql, sql-update, prepared-statement, syntax-error

此代码有某种简单的语法错误。我已经战斗了几个小时，我放弃了。你能发现吗？我敢打赌这很容易。谢谢！

当我只更新名字 John 时，没问题。当我尝试更新姓氏的注释行时，语法错误。

```
import java.sql.*;

public class UpdateTester {

   public static void main(String[] args) {

      try {

         Connect connect = new Connect();
         Connection connection = connect.getConnection();

         try {

            String sql        = "UPDATE student SET firstName = ? "
                     + " WHERE studentID = 456987";

            //String sql     = "UPDATE student SET firstName = ? "
            //       + " Set lastName = ?, "
            //       + " WHERE studentID = 456987";

            PreparedStatement pst = connection.prepareStatement(sql);
            pst.setString(1, "John");

            //pst.setString(2, "Johnson");

            pst.executeUpdate();
            System.out.println("Updated Successfully!");

            connection.close();

         } catch (SQLException e) {
            System.out.println("Exception 1!");
            e.printStackTrace();
         }
      } catch (Exception e) {
         System.out.println("Exception 2!");
         e.printStackTrace();
      }
   }
} 
```

列名是正确的。仅更新自己的姓氏也可以正常工作。尝试同时执行这两种操作时，更新失败并出现语法错误，如注释掉的行。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T23:15:18.857

3个问题：

*   SET 关键字只能在 UPDATE 语句中出现一次：
*   缺少第二个参数前的逗号
*   where 子句前不必要的逗号

更正后的语法：

```
String sql     = "UPDATE student SET firstName = ?, "
               + " lastName = ? "
               + " WHERE studentID = 456987"; 
```

[SQL 参考](http://www.w3schools.com/sql/sql_update.asp)

# database - 在排序数据上创建索引

> ID：15823285
> 
> 赞同：0
> 
> 时间：2013-04-04T23:11:12.660
> 
> 标签：database, algorithm, data-structures, nosql

我有一个带有一些排序数据的文本文件，用换行符分割。例如：

`...
abc123
abc124
abd123
abd124
abd125
...`

现在我想为数据集创建一个索引，它应该（至少）支持：

1.  **getStringByIndex(n)** : 返回排序列表的第 n 项；

2.  **getIndexByString(s)**：在所有项目中查找 s，返回其索引（如果未找到，则返回 -1）；

我已经阅读了一些索引算法，例如散列和 B 树。具有额外儿童大小字段的 B-Tree 应该可以做到这一点。但是由于对日期集进行了排序，我想知道是否有比通过将所有项目插入其中来构建 B 树更有效的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T04:03:02.590

由于数据已排序，因此您只需在内存中保留一小部分数据，就可以非常快速有效地定位内容。例如，假设我们决定将每个第 N 个元素存储在内存中。为了有效地初始化您的 API，您需要将此稀疏列表编译到磁盘上的单独文件中，这样您就不必流式传输 100GB 的数据来获取它。

对于这些术语中的每一个，您需要保存相对于文件头的磁盘偏移量，以用于术语开始的位置。然后，您所要做的就是将稀疏列表/偏移量对加载到内存中，您的两个请求的实现变得简单：

```
 getStringByIndex(n):
        Get floor(n/N)-th string/offset pair from list
        Seek offset position in index
        Read/Skip n mod N strings, then return the next one

    getIndexByString(s):
        Binary search over sparse list in memory
            Locate lower and upper bound string/offset pairs
        If a string/offset pair is in the i-th position in our sparse list,
            then the string itself is the (N x i)-th string in our index.
            We can use this information to compute the return value
        If the string we want isn't in memory:
            Seek lower-bound offset in index
            Read strings until we:
                a) Find a match
                b) Reach the high-bound offset
                c) Reach a string which is lexicographically greater than the one we are looking for
        Else
            Just return the index for the matching string in our sparse list 
```

如果索引中的字符串是固定宽度的，则可以进行更大的优化。

如果你实现它，你会想要小心你为这个算法选择的“N”。请记住，从磁盘上的某个位置读取 10 个字节的成本并不比从同一位置读取 10,000 个字节的成本低多少：这是磁盘寻道的开销，以及进出 I/O 调用的开销最痛。

# mysql - 每行设置一个mysql用户变量？

> ID：15823288
> 
> 赞同：0
> 
> 时间：2013-04-04T23:11:20.733
> 
> 标签：mysql

以下 SQL 语句设置了一个用户变量 @id，然后我将在尾随子查询中使用该变量。我的问题是 @id 变量只设置为结果集中的第一个 items.id - 而不是“每行” - 所以子查询的结果对于主选择中的每一行都是相同的。有谁知道是否有办法为每一行重置@id 变量？

```
 select
         items.id
        ,items.title
        ,@id := items.id
        ,(
            select
                group_concat(x.y)
            from
                (
                    select
                        group_concat(ledger.stockcode) as y
                    from
                        ledger
                    where
                        @id = ledger.itemid
                    group by
                         ledger.stockcode
                    having
                        sum(ledger.stockqty) > 0
                ) as x
            ) as extras
    from
        items
    where
        items.id = 196 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T05:27:32.017

试试这个查询

```
select
     a.id
    ,a.title
    ,b.y as extras
from
    items a
inner join
    (select
       group_concat(ledger.stockcode) as y
    from
       ledger
    where 
       ledger.itemid = 196
    group by
       ledger.stockcode
    having
       sum(ledger.stockqty) > 0) b
on
    a.id = 196 AND a.id = b.itemid 
```

# excel - excel命名范围从工作表复制到工作表

> ID：15823289
> 
> 赞同：6
> 
> 时间：2013-04-04T23:11:34.103
> 
> 标签：excel, named-ranges

我有一个 Excel 问题，我想知道是否有一种简单的方法可以将一个工作表中的命名范围的克隆或副本设置到同一工作簿中的另一个工作表。当数据通过第三方软件工具进入时，我需要自动完成此操作。我不是高级 excel 用户，希望有一种简单的方法可以在没有宏、vba 代码等的情况下做到这一点。有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T06:03:34.567

您可以将名为 range 的源的范围设置为仅工作表，然后复制工作表。命名范围也将被复制。

要更改范围，请使用功能区数据部分中的**名称管理器**`Ctrl`，或按+ `F3`。选择范围并单击编辑。

![在此处输入图像描述](https://i.stack.imgur.com/uencn.png)

要复制工作表，请右键单击工作表名称并选择“移动或复制”

![在此处输入图像描述](https://i.stack.imgur.com/Lt7H5.png)

# intellij-idea - Intellij Play 制作项目错误：未找到：对象键

> ID：15823291
> 
> 赞同：1
> 
> 时间：2013-04-04T23:11:41.223
> 
> 标签：intellij-idea, playframework-2.0, sbt

IntelliJ IDEA 12.1，播放 2.0.4

我在运行 Build...Make 项目时遇到此错误：

```
Scala: not found: object Keys
import Keys._ 
```

这是一个现有的 Play 2.0.4 项目，我通常使用“sbt ...”而不是“play ...”从 Eclipse 和命令行运行。我也使用 paul sbt-extras 脚本 [https://github.com/paulp/sbt-extras](https://github.com/paulp/sbt-extras)

plugins.sbt 有这一行

```
addSbtPlugin("play" % "sbt-plugin" % "2.0.4") 
```

错误出现在我的 Build.scala 文件中，该文件具有 Play 项目的典型前几行，例如

```
import sbt._
import Keys._
import PlayProject._ 
```

我想我需要指定 Play 配置主目录和工作目录，但不确定里面放了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T18:11:47.057

万一有人遇到同样的问题，我必须做一些事情。

注意：我正在使用`sbt version 0.11.3-2`

1)`plugins.sbt`变化

*   添加解析器：`"sbt-idea-repo" at "http://mpeltonen.github.com/maven/",`
*   添加`sbt-idea`插件： addSbtPlugin("com.github.mpeltonen" % "sbt-idea" % "1.1.0")
*   将 Play 插件降级为`2.0.1`： addSbtPlugin("play" % "sbt-plugin" % "2.0.1")

2)`sbt gen-idea`

3）如果您收到此错误

scala：输出路径 /Users/rngu/ij/admin-tools/project/target/scala_2.9.1 在以下之间共享：模块“admin-tools-build”生产，模块“admin-tools-build”测试当前外部 Scala 编译器禁止输出路径共享。禁用外部构建模式或配置单独的输出路径。提示：您可以使用 Project Artifacts 来组合已编译的类。

为了解决这个问题，IntelliJ…文件…项目结构…添加`/classes`到`Output path`,`/test-classes`到`Test output path`.

4）`Build...Make Project`现在应该可以工作了。

# php - 根据用户点击的内容用 php 生成页面

> ID：15823297
> 
> 赞同：1
> 
> 时间：2013-04-04T23:12:04.747
> 
> 标签：php

所以我制作了一个 MMO 公会数据库。人们可以去那里根据许多不同的选项过滤游戏公会，并将其全部显示在一个漂亮的表格中。例子：

```
Guild Name - Focus - Leaders
Guild 1    - PvP   - Bob
Guild 2    - PvE   - Fred 
```

现在我想做的是让公会名称成为一个链接，将用户带到该公会页面。但是该页面在该人单击链接之前不存在，我创建了一个名为 viewguild.php 的寺庙，如果该人单击“Guild 1”，它会将他们带到[http://somesite.com/viewguild.php?name=guild1](http://somesite.com/viewguild.php?name=guild1) . 我已经完成了！通过使用此代码：

```
echo '<tr><td><a href="viewguild.php?id='.$guild2.'">'.$guild2.'</a></td>'; 
```

它创建的链接就好了！但我的问题是，我似乎无法让我的 php 文件 viewguild.php 根据用户单击的公会名称生成信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:15:03.340

您可以使用`$_GET['id']`viewguild.php 中的变量来获取 URL 中的 Guild 名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:24:03.463

你可以`$_GET`这样使用：

```
$name = $_GET['name'];
echo "<a href='./viewguild.php?name=$name'>link</a>"; 
```

当你打电话给你的页面时`mypage.php?name=guild1`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T23:27:54.450

使用 $_REQUEST 或 $_GET 获取在 URL 中传递的 id 以显示您想要的任何内容。

例如，如果您的 id 为 1、2、3 或 4，并希望每个都显示不同的内容：

```
if($_REQUEST['id'] == 1) {
    //display the info for id 1
} else if($_REQUEST['id'] == 2) {
   //display info for id 2 
} 
```

等等你们可以使用 switch 语句。但基本上使用 $_REQUEST['id'] 会让你获得通过的 ID。

# objective-c - 属性 - 非公共弱 setter 似乎可以工作，但 getter 只返回与第一次调用相同的值

> ID：15823298
> 
> 赞同：0
> 
> 时间：2013-04-04T23:12:09.153
> 
> 标签：objective-c, memory-management, automatic-ref-counting

使用属性，我想要一个公开可见的 getter 和一个私有可见的 setter，用于具有弱引用的对象。我认为我有一些可以使用类扩展的东西。好吧，直到我在将对象设置为 nil 之前和之后都调用了 getter。如果我只在对象设置为 nil 之前或之后调用，getter 就会起作用。这是我所拥有的：

* * *

## 酒吧.h

```
#import <Foundation/Foundation.h>

@interface Bar : NSObject
@property (nonatomic, readonly, weak) NSObject *object;  // note only readonly
- (id) initWithObject:(NSObject *)object;
@end 
```

* * *

## 巴.m

```
#import "Bar.h"

@interface Bar ()  // class extension
@property (nonatomic, readwrite, weak) NSObject *object;  // note readwrite
@end

@implementation Bar

- (id) initWithObject:(NSObject *)object
{
    self = [super init];
    if (self)
    {
        self.object = object;
    }
    return self;
}

@end 
```

* * *

## 主程序

```
#import "Bar.h"

int main(int argc, char *argv[])
{
    @autoreleasepool {

        // Call getter once, before setting the object to nil.
        // This appears to work.
        NSObject *object1 = [[NSObject alloc] init];
        Bar *bar1 = [[Bar alloc] initWithObject:object1];
        NSLog(@"before      - bar1.object[%p] object1[%p]",bar1.object, object1);

        // Call getter once, after setting the object to nil.
        // This appears to work.
        NSObject *object2 = [[NSObject alloc] init];
        Bar *bar2 = [[Bar alloc] initWithObject:object2];
        object2 = nil;
        NSLog(@"after       - bar2.object[%p] object2[%p]",bar2.object, object2);

        // Call getter twice, before and after setting the object to nil.
        // This appears to work to work for the first call to the getter.
        NSObject *object3 = [[NSObject alloc] init];
        Bar *bar3 = [[Bar alloc] initWithObject:object3];
        NSLog(@"both before - bar3.object[%p] object3[%p]",bar3.object, object3);
        object3 = nil;
        NSLog(@"both after  - bar3.object[%p] object3[%p]",bar3.object, object3);

        return 0;
    }
} 
```

* * *

## 结果

```
before      - bar1.object[0x9623030] object1[0x9623030]
after       - bar2.object[0x0] object2[0x0]
both before - bar3.object[0x7523d90] object3[0x7523d90]
both after  - bar3.object[0x7523d90] object3[0x0] 
```

我预计那`both after`是：`both after - bar3.object[0x0] object3[0x0]`.

`nil`在将对象设置为之前调用 getter`nil`并在之后再次调用它时，似乎没有设置弱引用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:25:16.277

当您之前调用 getter 时，弱属性被加载并转换为强引用，然后被自动释放。当您再次调用它时，`object3`正如`nil`预期的那样，但它引用的原始对象仍然存在，位于自动释放池中。因此`bar3.object`仍有一个有效的对象返回给你。

请尝试以下操作：

```
NSObject *object3 = [[NSObject alloc] init];
Bar *bar3 = [[Bar alloc] initWithObject:object3];
@autoreleasepool {
    NSLog(@"both before - bar3.object[%p] object3[%p]",bar3.object, object3);
}
object3 = nil;
NSLog(@"both after  - bar3.object[%p] object3[%p]",bar3.object, object3); 
```

# java - Android：是否可以直接从 setOnClickListener() 调用方法？

> ID：15823299
> 
> 赞同：3
> 
> 时间：2013-04-04T23:12:12.427
> 
> 标签：java, android, methods, onclicklistener

我正在动态创建一些按钮，理想情况下希望能够在按下按钮时运行一个方法。

像下面这样的事情甚至可能吗？

```
private void someMethod(int ID){
 //on button pressed do something with the ID
}

private void otherMethod(){

  for( Program element : someList)
  {
    addButton.setOnClickListener(someMethod(element.getID));
  }
} 
```

显然，这只是一些代码的模拟来说明我的问题。我知道你可以实例化一个新类，所以看起来你应该能够调用一个方法，尽管到目前为止，我的尝试一直在出错。

我浏览了网络，但找不到任何答案，所以我想在这里问。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T23:22:11.950

`setOnClickListener`定义单击按钮时会发生什么。对同一个按钮设置多次是没有意义的；您设置的最后一个将是活动的。

**要在**侦听器中调用方法，请声明一个匿名类覆盖：

```
addButton.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
           someMethod(...);
        }
}); 
```

如果您尝试设置具有相似功能的多个按钮，则需要遍历*按钮*（例如在列表中），并设置每个按钮的`OnClickListener`s. 要为每个按钮实现不同的变量，您可以使用`View`'s [tag](http://developer.android.com/reference/android/view/View.html#getTag%28%29)：

```
for (Button b : buttons) {
    b.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
             someMethod(v.getTag());
        }
    });
} 
```

现在，您可以简单地将XML 中的`Button`'属性（或[手动](http://developer.android.com/reference/android/view/View.html#setTag%28java.lang.Object%29)）设置为您想要的任何内容，它将被传递到侦听器（以及方法）。`tag`

# jquery - 返回函数外的变量

> ID：15823306
> 
> 赞同：0
> 
> 时间：2013-04-04T23:12:57.467
> 
> 标签：jquery, return

我在通过 jQuery 函数返回变量时遇到问题。

```
$(document).ready(function () {
    var selected = "";

    $('.whitetheme').on('click', function () {
        $(this).effect("highlight", {}, 2000);
        selected = "whitetheme";
        return selected;

        $('.blacktheme').fadeOut(1500);
        $('.redtheme').fadeOut(1500);

    })

    console.log(selected);
}); 
```

我试图在单击后将 selected 的值更改为“whitetheme”。

现在，日志函数返回一个空字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:16:14.107

您正在绑定一个事件处理程序，该处理程序将（并且如果被调用）会更改变量值。但是，事件在执行之前不能发生`console.log`，因此您看不到更新的值。

此外，您的`blacktheme`和`redtheme`类不会淡出，因为该代码部分无法访问。

你到底想达到什么目的？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T23:19:28.060

尝试像这样稍微改变一下，这样你的 console.log 就会在你点击后打印出来。

```
$(document).ready(function () {
    var selected = "";

    $('.whitetheme').on('click', function () {
        $(this).effect("highlight", {}, 2000);
        selected = "whitetheme";
        // return selected; don't need this or the next 2 lines won't execute

        $('.blacktheme').fadeOut(1500);
        $('.redtheme').fadeOut(1500);

        console.log("selected: "+selected);
    });
    // console.log(selected); moved above
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T23:17:47.517

配合我上面的问题/评论：

```
$(document).ready(function() {

var selected = "";

$('.whitetheme').on('click', function(){
$(this).effect("highlight", {}, 2000);
selected = "whitetheme";

/*Moved this line*/
console.log(selected);

return selected;
$('.blacktheme').fadeOut(1500);
$('.redtheme').fadeOut(1500);

})
}); 
```

# sql-server - 从 while 循环值 SQL 创建变量名

> ID：15823308
> 
> 赞同：2
> 
> 时间：2013-04-04T23:13:09.937
> 
> 标签：sql-server

第一次在这个网站上发布海报，我需要一些建议：

是否可以基于 while 循环声明/创建新变量？

**语境：**

该公司的财务日历为财务年度内的每个日期分配一个期间（月）和一个周数。这些可以根据新财政年度的日期每年更改。

我想创建一个运行 while 循环的函数，以获取指定日期的周数和周期数。

我希望能够说一些类似的东西

```
while i > @EndDate
    if date is between such and such then week = @W(i)
end 
```

我不知道如何解释。

我目前的函数列出了所有周数和周期数，但它看起来很乱，可能效率不高。

任何人都可以建议吗？

谢谢

编辑：

道歉

我的代码在 SQL Server 中。

到目前为止，我的草稿很杂乱，但我先把它放在这里。

```
declare @StartDate datetime
,   @EndDate datetime
,   @ThisDate datetime
,   @P1 datetime
,   @P2 datetime
,   @P3 datetime
,   @P4 datetime
--and so forth until P12
, @W1   datetime
, @W2   datetime
, @W3   datetime
, @W4   datetime
, @W5   datetime
--and so forth until W52

set @StartDate = '2012-12-30'

set @P1 = @StartDate + 35
set @P2 = @P1 + 28
set @P3 = @P2 + 28
set @P4 = @P3 + 35
set @P5 = @P4 + 28
set @P6 = @P5 + 28
set @P7 = @P6 + 35
set @P8 = @P7 + 28
set @P9 = @P8 + 28
set @P10 = @P9 + 35
set @P11 = @P10 + 28
set @P12 = @P11 + 28

set @W1 = @StartDate
set @W2 = @W1 + 7
set @W3 = @W2 + 7
set @W4 = @W3 + 7
set @W5 = @W4 + 7
set @W6 = @W5 + 7

--while @ThisDate > @EndDate

set i = 1

--BEGIN

    if @ThisDate between @StartDate and (@W2 - 1) 
    then @ThisWeek = W1, @ThisPeriod = P1

--END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:54:58.193

这样做的一种方法是有一个列出周和相关期间的辅助表，然后在该表上加入包含要检查的日期的表。

前任：

```
SELECT 
    periods.week, tbl.rdate
FROM
    tbl, periods
WHERE 
    tbl.rdate BETWEEN periods.startdate AND periods.enddate 
```

将为您提供`periods.week`与 date 关联的周，其中包含列,的`tbl.rdate`表用于表示周数及其开始和结束日期。如果您的数据库必须保留多年的记录，您可以为该财政年度添加一个补充（索引）列，并在您的查询中添加对该列的约束以将扫描减少到单个财政年度。这样的一年平均有 52 行，保留 20 年的周期应该不会太成问题，甚至调整数据库以将表保留在内存中。`periods``week``startdate``enddate`

# php - 如何合并两个没有唯一键的关联数组的输出？

> ID：15823309
> 
> 赞同：3
> 
> 时间：2013-04-04T23:13:14.563
> 
> 标签：php, arrays, associative-array

我有一种感觉，我被一些看似微不足道的任务所困。请看一下 $data 数组。这是多级菜单的数据框架。**$data['name']**包含给定菜单点/按钮的名称和**$data['url']**相应的链接。数组维度**$data['name']**和**$data['url']**完全同步 - 具有完全相同的节点、相同的元素计数等等。

有了这个，我开始编写一个简单的输出函数——只有名字。我知道代码并不漂亮，但它可以工作。打败我，但提到递归时我的心痛；）尽管如此，我的原始方式导致正确的输出。在第二步中，我需要添加与名称/按钮相对应的 url 信息，但这是我失败并开始感到愚蠢的地方。

在遍历**$data['name']**时，我需要一个指向当前元素的指针，并使用它从**$data['url']**获取相应的 url但不 - 这是一个关联数组，所以这种方式会导致死亡结尾。顺便说一句，键不是唯一的……这很容易*叹息*这个数组只是原始数组的缩短版本，它是从一个仍在增长和变化的 150 页长的 word 文档生成的。

**任何想法如何输出按钮名称+相应的网址？**我将工作代码放在[codepad.org](http://codepad.org/cEA8ebQ8)上，以便摆弄。

我的数组：

```
<?PHP    

$data = array (    
  'name' =>     
  array (    
    'basics' =>     
    array (    
      0 => 'about',    
      1 => 'why_do_i_need_it',    
      2 => 'institutions',    
      3 => 'agencys',    
      4 => 'impact',    
      5 => 'failing_this_test',    
      6 => 'evaluation_criteria',    
      7 => 'evaluation_range',    
      8 => 'reissue_request',    
      9 => 'procedure',    
      'procedure' =>     
      array (    
        0 => 'psych',    
        'psych' =>     
        array (    
          0 => 'test_1',    
          1 => 'test_2',    
          2 => 'test_3',    
          3 => 'test_4',    
          4 => 'test_5',    
        ),    
        'med' =>     
        array (    
          0 => 'examination',    
          1 => 'exploration',    
          2 => 'observation',    
        ),    
      ),    
      10 => 'report',    
      11 => 'revision',    
      12 => 'evaluation',    
      13 => 'report_structure',    
      14 => 'charges',    
      15 => 'sample_test',    
    ),    
    'drugs' =>     
    array (    
      0 => 'introduction',    
      1 => 'requirements',    
      'requirements' =>     
      array (    
        0 => 'sincerity',    
        1 => 'excuses',    
        2 => 'insight',    
        3 => 'change',    
        4 => 'stability',    
      ),    
      2 => 'procedure',    
      3 => 'diagnostics',    
      'diagnostics' =>     
      array (    
        0 => 'addiction',    
        1 => 'advanced_level',    
        2 => 'dangers',    
        3 => 'sample_drugtest',    
      ),    
      4 => 'the_day_one',    
      5 => 'background',    
      6 => 'today',    
      7 => 'intake',    
      8 => 'screenings',    
      'screenings' =>     
      array (    
        0 => 'analysys',    
        1 => 'element',    
      ),    
    ),    

  'url' =>     
  array (    
    'basics' =>     
    array (    
      0 => 'basics.about',    
      1 => 'basics.why_do_i_need_it',    
      2 => 'basics.institutions',    
      3 => 'basics.agencys',    
      4 => 'basics.impact',    
      5 => 'basics.failing_this_test',    
      6 => 'basics.evaluation_criteria',    
      7 => 'basics.evaluation_range',    
      8 => 'basics.reissue_request',    
      9 => 'basics.procedure',    
      'procedure' =>     
      array (    
        0 => 'basics.procedure.psych',    
        'psych' =>     
        array (    
          0 => 'basics.procedure.psych.test_1',    
          1 => 'basics.procedure.psych.test_2',    
          2 => 'basics.procedure.psych.test_3',    
          3 => 'basics.procedure.psych.test_4',    
          4 => 'basics.procedure.psych.test_5',    
        ),    
        'med' =>     
        array (    
          0 => 'basics.procedure.med.examination',    
          1 => 'basics.procedure.med.exploration',    
          2 => 'basics.procedure.med.observation',    
        ),    
      ),    
      10 => 'basics.report',    
      11 => 'basics.revision',    
      12 => 'basics.evaluation',    
      13 => 'basics.report_structure',    
      14 => 'basics.charges',    
      15 => 'basics.sample_test',    
    ),    
    'drugs' =>     
    array (    
      0 => 'drugs.introduction',    
      1 => 'drugs.requirements',    
      'requirements' =>     
      array (    
        0 => 'drugs.requirements.sincerity',    
        1 => 'drugs.requirements.excuses',    
        2 => 'drugs.requirements.insight',    
        3 => 'drugs.requirements.change',    
        4 => 'drugs.requirements.stability',    
      ),    
      2 => 'drugs.procedure',    
      3 => 'drugs.diagnostics',    
      'diagnostics' =>     
      array (    
        0 => 'drugs.diagnostics.addiction',    
        1 => 'drugs.diagnostics.advanced_level',    
        2 => 'drugs.diagnostics.dangers',    
        3 => 'drugs.diagnostics.sample_drugtest',    
      ),    
      4 => 'drugs.the_day_one',    
      5 => 'drugs.background',    
      6 => 'drugs.today',    
      7 => 'drugs.intake',    
      8 => 'drugs.screenings',    
      'screenings' =>     
      array (    
        0 => 'drugs.screenings.analysys',    
        1 => 'drugs.screenings.element',    
      ),    
    ),    
  ),    
 )    
); 
```

我的代码：

```
//-----------------------------------------------------------    

    menueOutput($data);    

//-----------------------------------------------------------    

function menueOutput($str)    
{    
foreach($str AS $index =>$atom)    
{                                                          
    if(is_array($atom))    
    {    
        echo "\n\r>".$index;    

        foreach($atom AS $index2 => $atom2)    
        {    
            if(is_array($atom2))    
            {            
            echo "\n\r>>".$index2;    

                foreach($atom2 AS $index3 => $atom3)    
                {    
                    if(is_array($atom3))    
                    {        
                        echo "\n\r>>>".$index3;    

                        foreach($atom3 AS $index4 => $atom4)    
                        {    
                            if(is_array($atom4))    
                            {    
                                echo "\n\r>>>>".$index4;    

                                foreach($atom4 AS $index5 => $atom5)    
                                {    
                                    if(is_array($atom5))    
                                    {    
                                        echo "\n\r>>>>>".$index5;    
                                        foreach($atom5 AS $index6 => $atom6)    
                                        {    
                                            echo "\n\r------".$atom6;    
                                        }    
                                    }    
                                    else    
                                        echo "\n\r-----".$atom5;    
                                }        
                            }    
                            else    
                                echo "\n\r----".$atom4;    
                        }    
                    }    
                    else    
                    {    
                        echo "\n\r---".$atom3;    
                    }    
                }                
            }    
            else    
            {    
                echo "\n\r--".$atom2;    
            }    
        }    
    }    
    else    
    {    
        echo "\n\r".$atom;    
    }        
 }    
}    

//----------------------------------------------------------- 
```

## 更新：

我也在考虑通过并行循环合并部分数组。我发现这个**[MULTIPLEITERATOR 示例](http://php.net/manual/en/multipleiterator.construct.php#refsect1-multipleiterator.construct-examples)**可能是我需要的（如果我懒惰的话）。否则我将被迫重构我的数据，这可能会很痛苦。如果我这样做，Revent 答案将变得非常有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:19:42.610

我对菜单系统所做的是有一个多维数组，其中包含数组的一个元素中一个菜单项的所有信息。例如

```
$menu = array(
   'top_level' => array(
      0 => array('name'=>'Item 1','url' =>'Url 1', ...),
      1 => array('name'=>'Item 2','url' =>'Url 2', ...)
    ),
    'sub_level' => array(
      0 => array('name'=>'Item 1','url' =>'Url 1', ...),
      1 => array('name'=>'Item 2','url' =>'Url 2', ...)
    ),
    ...
); 
```

最初，我经历了获取数据并将其放入易于输出到屏幕的数组中的痛苦。

如果您的数组中没有唯一的 id，您只能按数组中的位置匹配它们，这可能可靠，也可能不可靠。如果您可以控制进入它们的数据，我强烈建议您将阵列重建成更有意义的东西。如果您有超过 150 个项目，那么您将需要尽可能高效地使用阵列设计。

**更新：** 这是我可能会如何构建数据：

```
<?php
$data = array (
  'basics' => array ('name'=>'basics', url=>'basics', 'children'=> 
      array (
         0 => array('name'=>'about', 'url'=>'basics.about'),
         1 => array('name'=>'why_do_i_need_it', 'url'=>'basics.why_do_i_need_it'),
         2 => array('name'=>'institutions', 'url'=>'basics.institutions'),
         3 => array('name'=>'agencys', 'url'=>'basics.agencys'),
         4 => array('name'=>'impact', 'url'=>'basics.impact'),
         5 => array('name'=>'failing_this_test', 'url'=>'basics.failing_this_test'),
         6 => array('name'=>'evaluation_criteria', 'url'=>'basics.evaluation_criteria'),
         7 => array('name'=>'evaluation_range', 'url'=>'basics.evaluation_range'),
         8 => array('name'=>'reissue_request', 'url'=>'basics.reissue_request'),
         9 => array('name'=>'procedure', 'url'=>'basics.procedure', 'children' =>
            array(
               0 => array('name'=>'psych', 'url'=>'psych', 'children'=>
                  array(
                     0 => array('name'=>'test_1', 'url'=>'test_1'),
                     1 => array('name'=>'test_2', 'url'=>'test_2'),
                     2 => array('name'=>'test_3', 'url'=>'test_3'),
                     3 => array('name'=>'test_4', 'url'=>'test_4'),
                     4 => array('name'=>'test_5', 'url'=>'test_5')
                  )
               ),
               1 => array('name'=>'med', 'url'=>'med', 'children'=>
                  array(
                     0 => array('name'=>'examination', 'url'=>'examination'),
                     1 => array('name'=>'exploration', 'url'=>'exploration'),
                     2 => array('name'=>'observation', 'url'=>'observation')
                  )
               )
            )
         ),
         ...
      )
    )
  );
?> 
```

如您所见，每个菜单项都存储名称和 url。如果有子元素，您只需将第三个元素添加到该数组中，子元素位于类似的数组中。您提取数据循环的 PHP 代码应大大简化，如下所示：

```
foreach ( $data as $top )
{
   echo '<br><a href="'.$top['url'].'">'.$top['name'].'</a>';   // print out the menu item

   if ( array_key_exists('children', $top) )
   {
      foreach ($top['children'] as $level2)
      {
         echo '<br>&nbsp;-&nbsp;<a href="'.$level2['url'].'">'.$level2['name'].'</a>';   // print out the children
         if ( array_key_exists('children', $level2) )
         {
            foreach ($level2['children'] as $level3)
            {
               echo '<br>&nbsp;&nbsp;&nbsp;-&nbsp;<a href="'.$level3['url'].'">'.$level3['name'].'</a>';   // print out the grandchildren
               if ( array_key_exists('children', $level3) )
               {
                  // process the greatgrandchildren, etc.
               }
            }
         }
      }
   }
} 
```

# arrays - 将 ARRAY 语句与迭代 DO 语句一起使用

> ID：15823311
> 
> 赞同：0
> 
> 时间：2013-04-04T23:13:18.720
> 
> 标签：arrays, sas, do-loops

我正在处理一个数据集 (DATA)，它有 3 个变量（Var1、Var2、Var3），格式我需要更改。这些变量采用特殊的日期格式（例如出于目的，比如 OLDFMT1），我需要使用 DATEPART 函数将它们更改为常规的 SAS 日期格式。

问题是我需要在单个数据步骤中使用 do 循环和调用 DATEPART 函数的数组来完成此操作。必须在数组中正确使用 DIM 函数，并且我必须在结束数据集之前删除索引变量 (i)。

然后，我必须申请 DATE9。对这些变化的变量起作用。

我对循环还很陌生，这让我非常头疼。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:30:38.787

通过说您要使用该`DATEPART`函数，您暗示您的三个现有变量当前存储为 SAS“日期时间”值。所以试试这个：

```
data have;
  var1 = datetime();
  var2 = datetime();
  var3 = datetime();
  format var1-var3 datetime19.;
run;

data want;
   set have;
   array allvars(*) var1-var3;
   do i=1 to dim(allvars);
      allvars(i) = datepart(allvars(i));
      end;
   format var1-var2 date9.;
   drop i;
run; 
```

请记住，SAS 只有两种数据类型（数字和字符）。日期、时间和日期时间仅在以适当的格式使用时才“已知”。在 SAS 中：

*   **日期**是自 1960 年 1 月 1 日以来的天数
*   **时间**是自午夜以来的秒数
*   **日期**时间是自 1960 年 1 月 1 日以来的秒数。

请注意，这`date9.`不是函数；它是一种格式。有许多不同的格式可用于“暴露”变量的基础值，但值本身不会改变。这是 SAS 编程真正有用的特性之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T07:46:24.557

如果您只想将数据格式化为 DATE9.，而不必存储为日期，则可以将前缀 DT 应用于任何日期格式并将其应用于日期时间值。所以DTDATE9。format 将以 date9 格式显示日期时间值。

# c# - wp7 - 流创建问题

> ID：15823317
> 
> 赞同：0
> 
> 时间：2013-04-04T23:13:53.330
> 
> 标签：c#, windows-phone-7, ssh, scp

我正在尝试让我的应用程序通过*SSH 和 SCP*从远程主机保存图片，我需要创建一个空的 Stream 变量以使用 ScpClient.Download(string filename, **Stream destination** ) 方法填充它，以便以后使用。有没有办法做到这一点？我试过：

```
 Stream downloadStream = new MemoryStream();

        scpClient.Connect();
        scpClient.Download("remoteFilename", downloadStream);

        MediaLibrary localLibrary = new MediaLibrary();
        localLibrary.SavePicture("localFilename", downloadStream);

        MessageBox.Show("Success!", "Result", MessageBoxButton.OK); 
```

我收到未知异常或应用程序刚刚退出。也许有一种方法可以将图像传递给**IsolatedStorage**？我正在使用**Renci.SshNet**库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T01:24:53.450

你应该把你的代码放在 try ... catch 块中

```
 try
        {
            // your stuff
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        } 
```

然后将您的异常详细信息添加到您的问题中，您会从这里的人那里获得更多帮助。

# database - 使用 Flyway 迁移存储过程

> ID：15823318
> 
> 赞同：12
> 
> 时间：2013-04-04T23:13:55.160
> 
> 标签：database, migration, flyway

如何使用 Flyway 等数据库迁移工具管理存储过程等过程数据库代码？

与 DDL 不同，我不想看到存储在多个数据库迁移文件中的存储过程的更改。如何在源代码控制下在单个文件中管理程序代码，同时利用 Flyway 之类的工具进行数据库迁移？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-05T13:18:10.627

框架中没有特殊的结构来处理这个问题。主要是因为我还没有找到让我满意的方法。

**更新：**从 Flyway 4.0 开始，现在完全支持可重复的脚本。见[https://flywaydb.org/documentation/migrations#repeatable-migrations](https://flywaydb.org/documentation/migrations#repeatable-migrations)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-21T18:30:56.113

我们所做的是：

1.  每当存储过程发生变化时，都有一个完整的 CREATE OR REPLACE Flyway 脚本。
2.  将每个存储过程存储在源代码管理的单独区域中，以便跟踪更改并计算差异。

这不是一个很好的解决方案，而且每次都很难记住，但它超越了该工具的一些限制。

# r - 高斯和伽马分布的混合

> ID：15823320
> 
> 赞同：5
> 
> 时间：2013-04-04T23:14:12.913
> 
> 标签：r, gaussian, gamma-distribution, mixture-model

我正在寻找 R 中的一些脚本/包（Python 也会这样做），以从高斯和伽马分布的混合中找出分量分布参数。到目前为止，我已经使用 R 包“mixtools”将数据建模为高斯混合，但我认为它可以更好地由 Gamma 加高斯建模。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T02:27:50.727

这是一种可能性：

定义效用函数：

```
rnormgammamix <- function(n,shape,rate,mean,sd,prob) {
    ifelse(runif(n)<prob,
           rgamma(n,shape,rate),
           rnorm(n,mean,sd))
} 
```

（这可以提高一点效率......）

```
dnormgammamix <- function(x,shape,rate,mean,sd,prob,log=FALSE) {
    r <- prob*dgamma(x,shape,rate)+(1-prob)*dnorm(x,mean,sd)
    if (log) log(r) else r
} 
```

生成假数据：

```
set.seed(101)
r <- rnormgammamix(1000,1.5,2,3,2,0.5)
d <- data.frame(r) 
```

方法一：`bbmle`打包。拟合形状、比率、对数刻度的标准差、对数刻度的概率。

```
library("bbmle")
m1 <- mle2(r~dnormgammamix(exp(logshape),exp(lograte),mean,exp(logsd),
                     plogis(logitprob)),
     data=d,
     start=list(logshape=0,lograte=0,mean=0,logsd=0,logitprob=0))
cc <- coef(m1)

png("normgam.png")
par(bty="l",las=1)
hist(r,breaks=100,col="gray",freq=FALSE)
rvec <- seq(-2,8,length=101)
pred <- with(as.list(cc),
             dnormgammamix(rvec,exp(logshape),exp(lograte),mean,
                           exp(logsd),plogis(logitprob)))
lines(rvec,pred,col=2,lwd=2)
true <- dnormgammamix(rvec,1.5,2,3,2,0.5)
lines(rvec,true,col=4,lwd=2)
dev.off() 
```

![在此处输入图像描述](https://i.stack.imgur.com/coHWT.png)

```
tcc <- with(as.list(cc),
            c(shape=exp(logshape),
              rate=exp(lograte),
              mean=mean,
              sd=exp(logsd),
              prob=plogis(logitprob)))
cbind(tcc,c(1.5,2,3,2,0.5)) 
```

拟合是合理的，但参数相差甚远——我认为这个模型在这个参数范围内不是很容易识别（即，可以交换 Gamma 和高斯分量）

```
library("MASS")
ff <- fitdistr(r,dnormgammamix,
     start=list(shape=1,rate=1,mean=0,sd=1,prob=0.5))

cbind(tcc,ff$estimate,c(1.5,2,3,2,0.5)) 
```

`fitdistr`得到与 相同的结果`mle2`，这表明我们处于局部最小值。如果我们从真实参数开始，我们会得到合理且接近真实参数的东西。

```
ff2 <- fitdistr(r,dnormgammamix,
     start=list(shape=1.5,rate=2,mean=3,sd=2,prob=0.5))
-logLik(ff2)  ## 1725.994
-logLik(ff)   ## 1755.458 
```

# mysql - 表的 MySQL 行号

> ID：15823323
> 
> 赞同：3
> 
> 时间：2013-04-04T23:14:15.263
> 
> 标签：mysql, sql

我正在尝试为我的表获取行号。到目前为止，这是我的 SQL 提示：

```
SELECT @i = @i + 1 AS Rank, x.Name, x.PartyName, x.ConstituencyName, x.Votes 
FROM (
    SELECT CONCAT(t1.Firstname, ' ', t1.Lastname) AS Name, t1.PartyName, t1.ConstituencyName, COALESCE(t2.Count, 0) AS Votes
        FROM (
            (SELECT db.user.PID, db.user.Firstname, db.user.Lastname, db.party.PartyName, db.constituency.ConstituencyName 
                FROM db.user
                LEFT JOIN db.party ON db.user.PartyId = db.party.PartyID 
                LEFT JOIN db.constituency ON db.user.CID = db.constituency.CID
                WHERE db.user.PartyId IS NOT NULL
                AND db.user.CID IS NOT NULL
            ) t1
            LEFT JOIN
            (SELECT db.user.Vote, COUNT(*) AS 'Count' 
                FROM db.user 
                GROUP BY db.user.Vote
            ) t2
        ON
            t1.PID = t2.Vote
        ORDER BY t2.Count DESC)
        ) x,
(SELECT @i:=1) r 
```

所以这基本上做的是，首先我创建一个表 t1（从 2 个不同的表中获取信息），然后将它与表 t2 连接起来，这样我就可以得到每个候选人的总票数。然后我将该表标记为“x”并将其与应该初始化行号的表“r”连接（使用行号的在线教程）。但是，当我运行此 SQL 提示时，我得到以下回报：

```
Rank    Name    PartyName   ConstituencyName    Votes
0       Name1   Party1      Constituency1       700
0       Name2   Party1      Constituency1       550 
```

任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:19:00.650

这是用户变量，您不应该`:=`使用`=`

```
SELECT @i := @i + 1 AS Rank,... 
```

# javascript - HTML5 在画布上编辑文本

> ID：15823328
> 
> 赞同：3
> 
> 时间：2013-04-04T23:14:49.213
> 
> 标签：javascript, html, canvas

我正在尝试创建类似于[http://www.listings.com](http://www.listhings.com)的内容，您可以在其中编辑画布中的文本。

我读过另一篇文章[HTML5 Canvas Text Edit](https://stackoverflow.com/questions/6814353/html5-canvas-text-edit)。但我不想在画布之外编辑文本。我想编辑画布中的文本。

如果有人能指出我正确的方向，我将不胜感激。
谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T01:29:10.963

首先，Mohsen 正确地指出，当您执行 context.fillText 时，您实际上是在画布上“绘制字母图片”。它不像文字处理器！

**您可以捕获窗口上的键事件，然后将击键写到画布上。**

这是代码和小提琴：http: [//jsfiddle.net/m1erickson/7tXd4/](http://jsfiddle.net/m1erickson/7tXd4/)

此示例仅键入小写 az（无大写、空格、退格等）

您可能希望进行更多增强，如下所示：

*   添加更多键（AZ、0-9 等）。
*   响应退格键等命令键以从 keyHistory 中删除字母。
*   放置一个光标，以便用户在输入时知道他们在哪一行（提示：[http](http://www.html5canvastutorials.com/tutorials/html5-canvas-text-metrics/) ://www.html5canvastutorials.com/tutorials/html5-canvas-text-metrics/ ）
*   如果您允许多行文本，请处理 [enterkey] 并移动到新行。
*   ETC

这里的代码**只是为了让你开始**：

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" media="all" href="css/reset.css" /> <!-- reset css -->
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

<style>
    body{ background-color: ivory; padding:20px; }
    canvas{border:1px solid red;}
</style>

<script>
$(function(){

    var canvas=document.getElementById("canvas");
    var ctx=canvas.getContext("2d");

    ctx.font="18px Arial";

    var keyHistory="";

    window.addEventListener("keyup", keyUpHandler, true);

    function addletter(letter){
        keyHistory+=letter;
        ctx.clearRect(0,0,300,300);
        ctx.fillText(keyHistory,20,20);
    }

    function keyUpHandler(event){
        var letters="abcdefghijklmnopqrstuvwxyz";
        var key=event.keyCode;
        if(key>64 && key<91){
            var letter=letters.substring(key-64,key-65);
            addletter(letter);
        }
    }

}); // end $(function(){});
</script>

</head>

<body>
    <p>First click in the red canvas below</p><br/>
    <p>Then type any lowercase letters from a-z</p><br/>
    <canvas id="canvas" width=300 height=100></canvas>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T23:25:23.957

`fillText()`不要创建以后可以编辑的对象或文本节点。它将在画布上**填充**文本，这意味着它将在画布上留下像素。

您可以使用诸如[http://kineticjs.com/](http://kineticjs.com/)之类的 Canvas 库为该文本创建一个图层，这样您就可以擦除该图层并在其中重新键入文本。Kinect 允许您将值绑定到图层，以便您可以保存您拥有的文本在层中绑定到层的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-10T05:04:40.507

试试这个解决方案[https://jsfiddle.net/tabvn/zjyoexf1/](https://jsfiddle.net/tabvn/zjyoexf1/)

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>Canvas Input Element</title>
</head>
<body>
    <canvas id="draw" width="500" height="500"></canvas>
<script type="text/javascript">
    var canvas = document.getElementById("draw");
    var ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    ctx.beginPath();

    function Input(text = "", options = {}){
        this.text = text;
        this.options = Object.assign({width: 250, height: 40, font: "17px Arial", borderWidth: 1, borderColor: "#ccc", padding: 5}, options);
        this.position = {x: 10, y: 10};
        this.isFocus = false;
        this.focusIndex = text.length;
        this.isCommandKey = false;
        this.selected = false;

        this.render = function(){
            ctx.clearRect(this.position.x, this.position.y, this.options.width, this.options.height);
            ctx.font = this.options.font;
            ctx.lineWidth = this.options.borderWidth;
            ctx.strokeStyle = this.options.borderColor;
            if(this.isFocus){
                ctx.strokeStyle = "#000";
            }
            ctx.rect(this.position.x, this.position.y, this.options.width, this.options.height);
            ctx.stroke();

            // write text
            var str = "";
            for(var i = 0; i < this.text.length; i++){
                if(!this.selected && this.isFocus && this.focusIndex === i){
                    str += "|";
                }
                str += this.text[i];
            }
            if(!this.selected && this.isFocus && this.focusIndex === this.text.length){
                str += "|";
            }

            if(this.selected){
                    var _width = ctx.measureText(this.text).width;
                    ctx.fillStyle = 'rgba(0,0,0,0.5)';
                    ctx.fillRect(this.position.x + this.options.padding, this.position.y + this.options.padding, _width, parseInt(this.options.font, 17));

            }

            ctx.fillStyle = "#000";
            ctx.fillText(str, this.position.x + this.options.padding,  this.position.y + (this.options.height / 2) + this.options.padding);

        }

        this.handleOnClick = function(e){
            let clientX = e.clientX;
            let clientY = e.clientY;
            if(clientX <= this.position.x + this.options.width && clientX >= this.position.x && clientY <= this.position.y + this.options.height && clientY >= this.position.y){
                if(!this.isFocus){
                    this.isFocus = true;
                    this.focusIndex = this.text.length;
                    this.render();
                }
            }else{
                if(this.isFocus){
                    this.selected = false;
                    this.isFocus = false;
                    this.render();
                }

            }
        }

        this.handleOnKeyUp = function(e){
            this.isCommandKey = false;
            this.render();
        }

        this.handleOnKeyDown = function(e){
            if(e.key === "Meta" || e.key === "Control"){
                this.isCommandKey = true;
            }
            if(this.isFocus){
                e.preventDefault();
            }
            if(this.isCommandKey && e.key === "a"){
                this.selected = true;
                this.render(); 
                return 
            }
            if(this.isFocus && e.key === "Backspace"){
                if(this.selected){
                    this.focusIndex = 0;
                    this.text = "";
                    this.selected = false;
                    this.render();
                }
                var str = "";
                for(var i =0; i < this.text.length; i++){
                    if(i !== this.focusIndex - 1){
                        str += this.text[i];
                    }
                }

                this.text = str;

                this.focusIndex --;
                if(this.focusIndex <0){
                    this.focusIndex = 0;
                }
                this.render();
            }
            if(this.isFocus && e.key === "ArrowLeft"){
                this.focusIndex --;
                if(this.focusIndex < 0){
                    this.focusIndex = 0;
                }
                this.render();
            }
            if(this.isFocus && e.key === "ArrowRight"){
                this.focusIndex ++;
                if(this.focusIndex > this.text.length){
                    this.focusIndex = this.text.length;
                }
                this.render();
            }
            if(!this.isCommandKey && this.isFocus && (e.keyCode == 32 || (e.keyCode >= 65))){
                this.text += e.key;
                this.focusIndex = this.text.length;
                this.render();
            }

        }
    }

    var input = new Input("I 'm an input");
    input.render();

    window.addEventListener("click", function(event){
            input.handleOnClick(event);
    });
    window.addEventListener("keydown", function(event){
            input.handleOnKeyDown(event);
    });
    window.addEventListener("keyup", function(event){
            input.handleOnKeyUp(event);
    });

</script>

</body>
</html> 
```

# mysql - VB.NET：使用 MySQL 查询填充 ComboBox

> ID：15823329
> 
> 赞同：0
> 
> 时间：2013-04-04T23:14:58.257
> 
> 标签：mysql, vb.net, combobox

我正在尝试从 MySQL 数据库中填充 Combobox；但我什么也没得到。下面是代码。

表：类

列：代码、状态

```
sqlstr = "SELECT * FROM Class WHERE State= Not Started"
DBCmd = New MySql.Data.MySqlClient.MySqlCommand(sqlstr, DBConn)
DBDR = DBCmd.ExecuteReader
While (DBDR.Read())
CB_Class.Items.Add(DBDR("Code"))
End While
DBCmd.Dispose()
DBDR.Close() 
```

我认为结果是错误的，因为至少有 2 条记录的状态值设置为“未开始”。怎么了？我写“State= Not Started”的方式有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:22:39.247

命令文本似乎不正确。它缺少要搜索的字符串周围的单引号

```
sqlstr = "SELECT * FROM Class WHERE State='Not Started'"
                                          ^           ^ 
```

如果`State`是一个字符串字段，那么对它的每次搜索都应该用单引号引起来。
当要搜索的字符串包含单引号时，请注意潜在的问题。

在这个简单的例子中，您可以直接使用字符串常量，但如果您使用用户输入呈现搜索动态，那么您应该使用参数化查询。

# ios - UILabel 与其他 UILabel 对齐

> ID：15823330
> 
> 赞同：1
> 
> 时间：2013-04-04T23:14:59.360
> 
> 标签：ios, uilabel

我有一个单元原型，我正在尝试添加两个标签。我有两个标签彼此相邻，但标签的大小是动态的，所以我希望第二个标签能够根据第一个标签的大小移动。

基本上，我希望两个标签之间有一个固定的差距，但两个标签的大小是动态的。

我怎么做？

编辑：

实际上我发现了如何通过 Storyboard 做到这一点。如果你选择了两个你想要固定间隔的标签，只需命令选择它们，然后转到情节提要的一角并单击 pin 菜单，这是附近按钮组中的那个小“H”形的东西放大/缩小故事板屏幕的右下角。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:32:32.617

Get the label size by this method:

```
- (CGSize)sizeWithFont:(UIFont *)font 
```

[https://developer.apple.com/library/ios/#documentation/UIKit/Reference/NSString_UIKit_Additions/Reference/Reference.html](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/NSString_UIKit_Additions/Reference/Reference.html).

Then set label's textAlignment to NSTextAlignmentLeft and NSTextAlignmentRight, and set frames by the string size and other offset.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:36:04.580

`UIView -sizeThatFits:`并`-sizeToFit`允许您手动计算第二个标签的位置。这比使用该方法稍微准确一些`NSString`，因为 a`UILabel`不仅仅是文本 - 这将尊重内容插入等。

# antlr4 - 如何使用 ANTLR4 构建 AST？

> ID：15823333
> 
> 赞同：8
> 
> 时间：2013-04-04T23:15:07.150
> 
> 标签：antlr4, abstract-syntax-tree

我有一个构建抽象语法树的 ANTLR3 语法。我正在考虑升级到 ANTLR4。然而，ANTLR4 似乎只构建解析树而不是抽象语法树。例如，该`output=AST`选项不再被识别。此外，*“AST”*和*“抽象语法”*都没有出现在*“The Definitive ANTLR4 reference”*的文本中。

我想知道我是否遗漏了什么。

我的应用程序目前知道如何爬过 ANTLR3 生成的 AST。将其更改为处理解析树并非不可能，但这需要一些工作。在我开始这条路之前，我想确定这是必要的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T23:48:52.073

ANTLR 4 基于语法而不是基于任意 AST 运算符和/或重写规则的 AST 生成解析树。这允许 ANTLR 4 自动生成可以使用语法在代码中实现的侦听器和访问者接口。

对于从版本 3 升级现有应用程序的用户来说，这种变化可能是巨大的，但作为一个整体，新系统更易于使用和（尤其是）维护。

# jquery - 完整日历未按正确顺序排列事件

> ID：15823334
> 
> 赞同：0
> 
> 时间：2013-04-04T23:15:11.533
> 
> 标签：jquery, fullcalendar

我正在使用[完整日历](http://arshaw.com/fullcalendar/)插件。我希望事件的顺序是根据开始日期/时间升序排列的。正如您在下面看到的`event # 2`，`event # 3`&`event # 4`的顺序正确，但顺序`event # 1`不正确。应该放在最后。

顺序错误：

```
[
    {"id":"1","title":"AAA","start":"2013-04-01 00:00:00","end":"2013-04-01 23:59:59", "allDay":false},
    {"id":"2","title":"BBB","start":"2013-04-01 07:30:00","end":"2013-04-01 09:30:00", "allDay":false},
    {"id":"3","title":"CCC","start":"2013-04-01 08:00:00","end":"2013-04-01 10:30:00", "allDay":false},
    {"id":"4","title":"DDD","start":"2013-04-01 13:00:00","end":"2013-04-01 10:30:00", "allDay":false},
] 
```

我希望它如何（按时间 ASC 排序）：

```
[
    {"id":"2","title":"BBB","start":"2013-04-01 07:30:00","end":"2013-04-01 09:30:00", "allDay":false},
    {"id":"3","title":"CCC","start":"2013-04-01 08:00:00","end":"2013-04-01 10:30:00", "allDay":false},
    {"id":"4","title":"DDD","start":"2013-04-01 13:00:00","end":"2013-04-01 10:30:00", "allDay":false},
    {"id":"1","title":"AAA","start":"2013-04-01 23:00:00","end":"2013-04-01 23:59:59", "allDay":false}
] 
```

`Week View`它在&中看起来很完美，`Day View`但在`Month View`. 所有事件都来自数据库，我将 JSON 提要传递给以`fullcalendar`呈现事件。在这方面的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T02:45:08.237

您可以使用 underscore.js 对对象数组进行排序。

```
var events = [
    {"id":"1","title":"AAA","start":"2013-04-01 23:00:00","end":"2013-04-01 23:59:59", "allDay":false},
    {"id":"2","title":"BBB","start":"2013-04-01 07:30:00","end":"2013-04-01 09:30:00", "allDay":false},
    {"id":"3","title":"CCC","start":"2013-04-01 08:00:00","end":"2013-04-01 10:30:00", "allDay":false},
    {"id":"4","title":"DDD","start":"2013-04-01 13:00:00","end":"2013-04-01 10:30:00", "allDay":false}
];

var sortedEvents = _.sortBy(events, function(data){ return data.start; }); 
```

**[演示](http://jsfiddle.net/maheshsapkal/cG3Sg/)**

# ios - 如何实现类似于 iBooks 中使用的导航栏？

> ID：15823337
> 
> 赞同：2
> 
> 时间：2013-04-04T23:15:17.837
> 
> 标签：ios, objective-c, uiviewcontroller, uinavigationcontroller, uinavigationbar

iBooks 中的导航栏正是我想要实现的。也就是说，一个透明的顶部栏，左上角有返回按钮，右上角有一些按钮来调用操作。

但是，我不确定如何实现这种效果。尤其是透明度。谁能指出我如何实现这一目标的正确方向？

![在此处输入图像描述](https://i.stack.imgur.com/EbFh0.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:26:04.447

使用自定义 UIView 子类。只需添加一些按钮并设置视图的 alpha。使用控制器的 UINavigationController 推送或弹出控制器。导航栏应隐藏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:32:57.767

I would not use a navigationControllerBar, I would use a simple UIToolbar to do this. Especially you can have only two button on the navigationControllerBar (left and right button) unlike on a UIToolbar.

The UIToolbar is absolutely customizable, you can set the opacity to 0% and the opaque to NO, after it can be transparent....

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T05:49:18.643

使用 UIView 或 UIToolbar alpha 是完全可定制的。您应该继承这两个（UIView 或 UIToolbar）之一，添加您的按钮，然后从那里开始。

# python - 在python中的掩码下显示数字

> ID：15823343
> 
> 赞同：0
> 
> 时间：2013-04-04T23:15:28.607
> 
> 标签：python, mask

## 背景

大家好，我正在尝试用python编写一个基本的字母游戏。在游戏中，计算机版主从可能的单词列表中挑选一个单词。每个玩家（计算机 AI 和人类）都会看到一系列空白，每个字母对应一个单词。然后每个玩家猜测一个字母和一个位置，并被告知以下内容之一：

1.  那封信属于那个位置（最好的结果）
2.  那个字母在单词中，但不在那个位置
3.  该字母不在任何剩余的空白处

当单词完全显示出来时，猜对最多字母的玩家将赢得一分。电脑版主又选了一个词，重新开始。第一个获得五分的玩家赢得比赛。在基本游戏中，两个玩家共享他们正在填写的同一组空白，因此玩家可以从彼此的工作中受益。

## 问题

我使用蒙版将秘密单词显示为一系列破折号，以便向玩家指示单词中的字母数量。

我想在每个破折号下方显示一个数值，以便玩家轻松选择他/她想猜测的单词中的哪个字符。

因此，对于 4 个字母的单词，掩码将显示如下内容：

```
- - - -
0 1 2 3 
```

到目前为止，我的面具是这样的——

```
import random

with open('wordlist.txt') as wordList:
secretWord = random.choice(wordList.readlines()).strip()

mask = ' '.join(('_' for i in range(len(secretWord)))) 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:27:23.327

为什么不做两个字符串？

```
mainMask = ' '.join(('_' for i in range(len(secretWord))))
numMask = ' '.join((str(i) for i in range(len(secretWord)))) 
```

或者，您可以将它们合二为一：

```
mask = ' '.join(('_' for i in range(len(secretWord)))) + '\n' + ' '.join((str(i) for i in range(len(secretWord)))) 
```

# php - 从 Laravel 4 中的模型急切加载

> ID：15823344
> 
> 赞同：9
> 
> 时间：2013-04-04T23:15:32.870
> 
> 标签：php, laravel, eager-loading, laravel-4, laravel-3

在 Laravel 3 中，可以在模型中执行以下操作（[http://laravel.com/docs/database/eloquent#eager](http://laravel.com/docs/database/eloquent#eager)）：

```
class Book extends Eloquent 
{
     public $includes = array('author');     // this line

     public function author()
     {
           return $this->belongs_to('Author');
     }
} 
```

如果经常加载相同的模型，这很有用。

在 Laravel 4 中，添加“这条线”似乎不会导致急切加载。文档中似乎也没有提到它（[http://four.laravel.com/docs/eloquent#eager-loading](http://four.laravel.com/docs/eloquent#eager-loading)）。

它是被其他东西取代还是这个功能完全消失了？

* * *

更新：

我已经查看了模型的来源（很高兴阅读）。下雪了：

```
/**
 * The relations to eager load on every query.
 *
 * @var array
 */
protected $with = array(); 
```

有什么方法可以建议将其添加（返回）到文档中（这似乎是那些很容易被忽视的小事之一）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T07:11:02.793

文档在 github ( [https://github.com/laravel/docs](https://github.com/laravel/docs) ) 上，所以你可以做一些请求......

# mysql - 在 MySQL 字段末尾大量插入数据

> ID：15823346
> 
> 赞同：0
> 
> 时间：2013-04-04T23:15:40.747
> 
> 标签：mysql, database, html

我将如何`</div>`在 MySQL 中将结束标记大量插入到定义的字段名称中？

多谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:21:03.943

考虑使用 CONCAT 命令：

```
UPDATE jos_content SET fulltext = CONCAT( fulltext, '</div>' ) WHERE id = 7; 
```

如果您想在单个查询中更新所有记录，只需删除上面的 WHERE 子句。

请注意，根据您使用的服务器端语言，您需要为此设置参数化查询，以防止 SQL 注入或其他黑客攻击。

# wpf - 自己的 CollectionView 用于分页、排序和过滤

> ID：15823349
> 
> 赞同：2
> 
> 时间：2013-04-04T23:16:04.340
> 
> 标签：wpf, sorting, pagination, filtering, collectionview

我已经实现了自己的 CollectionView 来将数据集合绑定到 WPF 中的 DataGrid。

主要目标是分页，它工作得很好。我编写了以下 C# 代码：

```
public class SchemesCollectionView : CollectionView
{
    private readonly IList<Scheme> innerList;
    private readonly int itemsPerPage;

    private int currentPage = 1;

    public SchemesCollectionView(IList<Scheme> source, int itemsPerPage)
        : base(source)
    {
        innerList = source;
        this.itemsPerPage = itemsPerPage;
    }

    public override int Count
    {
        get { return itemsPerPage; }
    }

    public int CurrentPage
    {
        get { return currentPage; }
        set
        {
            currentPage = value;
            OnPropertyChanged(new PropertyChangedEventArgs("CurrentPage"));
            OnPropertyChanged(new PropertyChangedEventArgs("FirstItemNumber"));
            OnPropertyChanged(new PropertyChangedEventArgs("LastItemNumber"));
        }
    }

    public int ItemsPerPage { get { return this.itemsPerPage; } }

    public int PageCount
    {
        get
        {
            return (this.innerList.Count() + this.itemsPerPage - 1)
                / this.itemsPerPage;
        }
    }

    public int LastItemNumber
    {
        get
        {
            var end = currentPage * itemsPerPage - 1;
            end = (end > innerList.Count()) ? innerList.Count() : end;

            return end + 1;
        }
    }

    public int StartIndex
    {
        get { return (currentPage - 1) * itemsPerPage; }
    }

    public int FirstItemNumber
    {
        get { return ((currentPage - 1) * itemsPerPage) + 1; }
    }

    public override object GetItemAt(int index)
    {
        var offset = index % (ItemsPerPage);

        var position = StartIndex + offset;

        if (position >= innerList.Count)
        {
            position = innerList.Count - 1;
        }

        return innerList[position];
    }

    public void MoveToNextPage()
    {
        if (CurrentPage < PageCount)
        {
            CurrentPage += 1;
        }
        Refresh();
    }

    public void MoveToPreviousPage()
    {
        if (CurrentPage > 1)
        {
            CurrentPage -= 1;
        }
        Refresh();
    }

    public void MoveToFirstPage()
    {
        CurrentPage = 1;
        Refresh();
    }

    public void MoveToLastPage()
    {
        CurrentPage = PageCount;
        Refresh();
    }
} 
```

如前所述，分页效果很好。但我无法进行过滤和排序工作。当我将自定义过滤器添加到 Filter 属性时，它会被完全忽略。排序也是一样。单击它们后，我可以在列标题上看到箭头，但不同的排序不会反映在 DataGrid 中。

我在这里缺少什么？希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T03:58:24.763

如本文所述，您可以从 Silverlight 获取代码并在 WPF 中使用它。

[WPF 中的分页集合视图](https://stackoverflow.com/questions/8003845/paged-collection-view-in-wpf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-21T18:10:20.877

这是仅使用 CollectionView 类进行过滤和分页的解决方案。

您只需要设置当前页面索引和每页最大项目数即可满足您的需求。

```
 // obtenir la CollectionView 
        ICollectionView cvCollectionView = CollectionViewSource.GetDefaultView(this.Suivis);
        if (cvCollectionView == null)
            return;

        // filtrer ... exemple pour tests DI-2015-05105-0
        cvCollectionView.Filter = p_oObject => { return true; /* use your own filter */ };

        // page configuration
        int iMaxItemPerPage = 2;
        int iCurrentPage = 0;
        int iStartIndex = iCurrentPage * iMaxItemPerPage;

        // déterminer les objects "de la page"
        int iCurrentIndex = 0;
        HashSet<object> hsObjectsInPage = new HashSet<object>();
        foreach (object oObject in cvCollectionView)
        {
            // break if MaxItemCount is reached
            if (hsObjectsInPage.Count > iMaxItemPerPage)
                break;

            // add if StartIndex is reached
            if (iCurrentIndex >= iStartIndex)
                hsObjectsInPage.Add(oObject);

            // increment
            iCurrentIndex++;
        }

        // refilter
        cvCollectionView.Filter = p_oObject =>
        {
            return cvCollectionView.Contains(p_oObject) && hsObjectsInPage.Contains(p_oObject);
        }; 
```

# arrays - 为什么我的字符串没有正确传递给这个线程调用的函数？

> ID：15823353
> 
> 赞同：0
> 
> 时间：2013-04-04T23:16:17.723
> 
> 标签：arrays, string, multithreading, pthreads, cstring

我正在开发一个多线程应用程序，其中客户端程序生成将字符串发送到数据服务器程序的请求线程，数据服务器程序通过发送回字符串来回答。不幸的是，我无法将数据从客户端的主函数传递到每个请求线程调用的函数。在 main 中，我得到了这样的请求线程（一些以前的变量声明未显示）：

```
for(int j = 0; j < persons.size(); j++){  //requests deal with imaginary people 
 thread_args* dat = new thread_args; 
 strcpy(dat->str, persons[j].c_str());

 cout << "***I COPIED " << dat->str << " INTO dat->str!!!"<<endl;  //prints as expected 

 pthread_create(&request_thread[j],NULL,&deposit_requests, &dat); 
} 
```

具体来说，我用来通过线程传递事物的结构如下所示：

```
typedef struct str_thdata{ 
   char str[100];
} thread_args; 
```

现在，在 main ("***I COPIED...") 中的 cout 中，一切都很好。确实复制了正确的值。但是，当我到达线程调用的实际函数时，字符串丢失了：

```
 void* deposit_requests(void* str_arg){

      for(int i = 0; i < req_per_person; i++){
         thread_args* data = (thread_args*)str_arg;
         cout << "data->str is " << data->str << endl;  //empty string!!!
         ...       
      } 
   } 
```

我唯一的想法是，也许有些事情超出了范围？除非我在这里失明，否则我看不到它会发生在哪里。或者也许我需要在某个地方进行额外的演员表？我在第二个 cout 中尝试了一些变体（例如，使用 ((thread_args*)data)->str) ），但这似乎不起作用。我的字符数组发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:44:02.100

您在 pthread_create 中传递的 &dat 是指向 thread_args 结构的指针的地址，而不是 thread_args 结构的地址。

将不带 & 的 dat 传递给 pthread_create，然后您的 deposit_requests 代码应该可以正常运行。

```
pthread_create(&request_thread[j],NULL,&deposit_requests, dat); 
```

# file - 从文件中读取几个字节并使用批处理写入文本文件

> ID：15823361
> 
> 赞同：2
> 
> 时间：2013-04-04T23:17:30.127
> 
> 标签：file, vbscript, batch-file, dos

是否可以制作从二进制文件中读取几个字节并将它们作为可读文本保存到另一个文件的批处理文件或 vbs？（例如阅读 4E 50 44 -> 保存 NPD）

示例文件箱

[文件开头] 8 字节的垃圾 24 字节我需要的（可读文本）文件的其余部分 [eof]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T13:05:37.030

you can try with Frank's hex editor: [https://groups.google.com/forum/?fromgroups=#!searchin/alt.msdos.batch.nt/hexeditor/alt.msdos.batch.nt/q84l84C2Q8Q/CjBkaDIKxfcJ](https://groups.google.com/forum/?fromgroups=#!searchin/alt.msdos.batch.nt/hexeditor/alt.msdos.batch.nt/q84l84C2Q8Q/CjBkaDIKxfcJ)

with this command `cerutil -decodehex myfile myfile.hex` you can see your file in hex , and then process it.With encodehex you can convert a hex data into text.

# unit-testing - 单元测试 grails 中的嵌套命令对象

> ID：15823362
> 
> 赞同：2
> 
> 时间：2013-04-04T23:17:34.970
> 
> 标签：unit-testing, grails, tdd

文档说我们可以通过模拟参数来测试带有命令对象的控制器 [http://grails.org/doc/latest/guide/testing.html#unitTestingControllers](http://grails.org/doc/latest/guide/testing.html#unitTestingControllers)

我想知道这是否适用于嵌套命令对象？有没有人让这个工作？

例子：

**控制器**

```
def create(FormCommand form){
  form.validate()
  ...
} 
```

**命令**

```
class FormCommand {
  InnerCommand cmd
}

class InnerCommand{
  String x
  static constraints ={
     x(nullable: false)
  }
} 
```

**测试**

```
void testCreate(){
  params["inner.x"]="any"
  controller.create()
  ...
} 
```

我的期望是命令对象被创建并且数据绑定工作，我也期望内部命令被验证。我期待太多了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T16:14:21.330

好的，这似乎是您想要的，但需要一些代码:-)

## 数据绑定

对于嵌套命令对象，Grails 数据绑定需要内部命令的非空实例。

为此，您可以创建一个自定义`org.codehaus.groovy.grails.web.binding.BindEventListener`：

```
class InnerCommandBindEventListener împlements BindEventListener {
  public void doBind(Object target, MutablePropertyValues source, TypeConverter typeConverter) {
    target.cmd = new InnerCommand()
  }
} 
```

**并在你的resources.groovy**中声明它

 **```
innerCommandBindEventListener(InnerCommandBindEventListener) 
```

## 嵌套验证

要解决验证问题，您需要为您的 cmd 自定义验证器：

```
class FormCommand {
  InnerCommand cmd
  static constraints = {
    cmd nullable: false, validator: { cmd, obj ->
      // manually trigger the inner command validation
      if(!cmd.validate()) {
        return 'invalid.innercommand.message' 
      }
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-20T11:01:55.480

不确定是否完全适用于手头的问题，但至少对于控制器操作测试中的数据绑定，这是有效的：

```
params.'player1.name' = "John" 
```

因为这给出了空指针异常：

```
params.player1.name = "John" 
```

当控制器正在执行时：

```
Game game = new Game(params) 
```

游戏有：

```
Player player1 
```**

# powershell - PowerShell XML 解析和导出

> ID：15823363
> 
> 赞同：0
> 
> 时间：2013-04-04T23:17:38.900
> 
> 标签：powershell, xml-parsing

我是使用 PowerShell 的新手，刚刚加入了 stackoverflow。我有一个项目正在尝试解析 XML 文件并将一些特定节点导出到 csv 文件。我需要`*<group>name"unique name"*`从文件中的多个条目导出的成员任务# 导出到.csv。

XML 文件类似于以下示例，其中包含*组名称和关联任务 # 的多个条目：*

```
<settings><tasks><groups>
<Group Name="some name">
<Notes>Some notes here</Notes>
<Member t="task">159711687</Member>
<Member t="task">584643293</Member>
<Member t="task">465828474</Member>
<Member t="task">262255905</Member>
<Member t="task">121466829</Member>
<Member t="task">257067112</Member>
</Group>

<Group Name="some name 2">
<Notes>Testing</Notes>
<Member t="task">865485927</Member>
<Member t="task">363897901</Member>
<Member t="task">848275733</Member>
<Member t="task">471573148</Member>
<Member t="task">312701058</Member>
<Member t="task">667795378</Member>
<Member>160178363</Member>
<Member>149985003</Member>
</Group> 
```

到目前为止，我已经得到

```
$xml = [xml] (gc "\\servername\path\to\file.xml")
$xml.settings.tasks.groups.group 
```

我也试过***| select member -expandproperty member***但它没有正确返回格式，显然也没有返回名称。

我也试过基本的***| 格式列表名称、成员*** 和格式表也几乎没有结果。

对于这个新手来说，任何指向正确方向的指针都会有所帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:39:34.047

你正朝着正确的方向前进。您只需要记住您的元素引用（代码中的第二行）实际上返回了一个元素数组。一旦你有了数组，你只需要像这样遍历它：

```
[xml]$xml = gc .\groups.xml
$groups = $xml.settings.tasks.groups.Group  # $groups is an array of Group elements
foreach($i in $groups) {
    write-output $i.Name         # get the Name attribute for each Group element
    foreach($j in $i.Member) {   # $i.Member is an array of Member for each Group element
        write-output $j."#text"  # get the text contained in each Member element
    }
} 
```

# algorithm - 对于任何算法，它的平均情况性能总是优于最坏情况性能，这是对还是错？

> ID：15823366
> 
> 赞同：0
> 
> 时间：2013-04-04T23:17:49.237
> 
> 标签：algorithm, sorting, asymptotic-complexity

我想这是真的，但我对这个答案不太自信。是否有一种算法在平均情况和最坏情况下具有相同的运行时间。我不确定答案是否正确。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T23:21:31.740

在最佳、平均和最坏情况下，计算 1+1=2 是 O(1)。

一个稍微不那么简单的例子：确定长度为 n 的链表的长度在所有情况下都需要 n 步，所以在所有情况下都是 O(n) 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T23:41:36.497

错误的。例如：BinarySearch、ShellSort、HeapSort 等。

# c++ - 使用 openGL GLM 和着色器的不正确旋转

> ID：15823367
> 
> 赞同：0
> 
> 时间：2013-04-04T23:17:53.487
> 
> 标签：c++, opengl, shader, opengl-3, glm-math

我的程序的目标是显示一个简单的在 Y 轴上旋转的彩色三角形，没有任何平移。我正在使用 GLM 库。问题是我的三角形的变换是不正确的：它有一个奇怪且不合逻辑的行为。这是我的 C++ 代码加上顶点着色器和片段着色器代码：

C++ 代码：

```
float angle = 0.0f;

struct Vertex
{
    float x, y, z;
};

static Vertex vertices[9] =
{
    -1.000000f, 0.000000f, 0.000000f,
    0.000000f, 1.000000f, 0.000000f,
    1.000000f, 0.000000f, 0.000000f
};

static Vertex colors[9] =
{
    1.000000f, 0.000000f, 0.000000f,
    0.000000f, 1.000000f, 0.000000f,
    0.000000f, 0.000000f, 1.000000f
};

[...]

int                 
main(int ac, char **av)
{
    bool            continuer = true;
    SDL_Event       event;
    GLuint          vboID[2];
    GLuint          programID = 0;

    //SDL window initialization

    SDL_Init(SDL_INIT_VIDEO);
    SDL_WM_SetCaption("VBO tests",NULL);
    SDL_SetVideoMode(WIDTH, HEIGHT, 32, SDL_OPENGL);

    //Viewport initialization

    glViewport(0, 0, WIDTH, HEIGHT);

    //Projection initialization

    glm::mat4 projection = glm::mat4(1.0f);
    projection = glm::perspective<GLfloat>(60.0f, (float)(WIDTH/HEIGHT), 1.0f, 1000.0f);

    //View initialization

    glm::mat4 view = glm::lookAt<GLfloat>(glm::vec3(0.0f, 0.0f, 8.0f), glm::vec3(0.0f, 0.0f, 0.0f), glm::vec3(0.0f, 1.0f, 0.0f));

    glewInit();

    //Shaders initialization

    programID = initShaders("triangle.vert", "triangle.frag");

    //Main loop

    while (continuer)
    {
        eventListener(&event, &continuer);

        glClearDepth(1.0f);
        glClearColor(0.13f, 0.12f, 0.13f, 1.0f);
        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

        glUseProgram(programID);

        //Model transformations

        glm::mat4 model = glm::mat4(1.0f);
        model *= glm::translate(model, glm::vec3(0.0f, 0.0f, 0.0f));
        model *= glm::rotate(model, angle, glm::vec3(0.0f, 1.0f, 0.0f));

        glm::mat4 ModelViewMatrix = model * view;
        glm::mat4 ModelViewProjectionMatrix = projection * ModelViewMatrix;

        glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 0, vertices);
        glVertexAttribPointer(1, 3, GL_FLOAT, GL_FALSE, 0, colors);

        glEnableVertexAttribArray(0);
        glEnableVertexAttribArray(1);

        glUniformMatrix4fv(glGetUniformLocation(programID, "ModelView"), 1, GL_TRUE, glm::value_ptr(ModelViewMatrix));
        glUniformMatrix4fv(glGetUniformLocation(programID, "MVP"), 1, GL_TRUE, glm::value_ptr(ModelViewProjectionMatrix));

        glDrawArrays(GL_TRIANGLES, 0, 3);

        glDisableVertexAttribArray(1);
        glDisableVertexAttribArray(0);

        glUseProgram(0);

        angle += 0.020f;

        glFlush();
        SDL_GL_SwapBuffers();
    }

    SDL_Quit();
    return (0);
} 
```

顶点着色器代码：

```
#version 330

in vec3 VertexPosition;
in vec3 VertexColor;

uniform mat4 ModelViewMatrix;
uniform mat4 MVP;

out vec3 Color;

void main()
{
    Color = VertexColor;

    gl_Position = MVP * vec4(VertexPosition, 1.0f);
} 
```

片段着色器代码：

```
#version 330

in vec3 Color;
out vec4 FragColor;

void main() {
    FragColor = vec4(Color, 1.0);
} 
```

当我为模型声明一个简单的矩阵旋转时，我将它发送到顶点着色器并将它用作 MVP 并且它可以工作。但是当我添加投影矩阵 + 视图矩阵时，它不能正常工作。这是一张图片：

![在此处输入图像描述](https://i.stack.imgur.com/LGpkc.png)

通常，三角形应位于屏幕的中心。

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T13:59:36.823

这一行：

```
glm::mat4 ModelViewMatrix = model * view; 
```

应该是：

```
glm::mat4 ModelViewMatrix = view * model; 
```

矩阵计算是反向进行的，您希望首先将顶点乘以模型矩阵，而不是视图。

你也可以看看[我的其他答案](https://stackoverflow.com/a/14283360/752976)，稍微解释一下这些概念。

# python-2.7 - 在不使用任何内置函数的情况下在字符串中查找子字符串

> ID：15823371
> 
> 赞同：-2
> 
> 时间：2013-04-04T23:18:09.930
> 
> 标签：python-2.7

我必须在字符串中找到特定的子字符串及其在字符串中的位置。这很容易，但我必须在不使用 python 中的任何内置函数或方法的情况下做到这一点。如果有人可以提供帮助，我将不胜感激。谢谢

```
string="ACAAGATGCCATTGTCCCCCGGCCTCCTGCTGCTGCTGCTCTCCGGGGCCACGGCCACCGCTGCCCTGCCCCTGGAGGGTGGCCCCACCGGCCGAGACAGCGAGCATATGCAGGAAGCGGCAGGAATAAGGAAAAGCAGCCTCCTGACTTTCCTCGCTTGGTGGTTTGAGTGGACCTCCCAGGCCAGTGCCGGGCCCCTCATAGGAGAGGAAGCTCGGGAGGTGGCCAGGCGGCAGGAAGGCGCACCCCCCCAGCAATCCGCGCGCCGGGACAGAATGCCCTGCAGGAACTTCTTCTGGAAGACCTTCTCCTCCTGCAAATAAAACCTCACCCATGAATGCTCACGCAAGTTTAATTACAGACCTGAA" 
```

子串='ttg'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:37:48.960

如果您不想使用任何内置函数，此代码将起作用。

```
man = "ACAAGATGCCATTGTCCCCCGGCCTCCTGCTGCTGCTGCTCTCCGGGGCCACGGCCACCGCTGCCCTGCCCC$
check = "TTG"

for i in range (0, len(man)):
    if man[i]==check[0]:
            sum =0
            for j in range(0, len(check)):
                    if man[i+j] != check[j]:
                            break
                            sum = 0
                    else:
                            sum = sum +1
                            if sum == len(check):
                                print i 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-09-04T22:59:33.417

如果没有任何内置函数，很难实现这一点，因为您需要`len`或`enumerate`使用当前索引的知识进行迭代。

虽然，这里只是一个实现`len`。

```
def find(s, sub):
    idx = 0
    while idx < len(s):
        if s[i:len(sub)] == sub:
            return idx
    return -1 
```

如果你真的不想要内置函数，这里有一个你可以使用的技巧。

```
def find(s, sub):
    sub_len = 0
    for _ in sub:
        sub_len += 1

    idx = 0
    while s[idx:idx+1]:
        if s[i:sub_len] == sub:
            return idx
    return -1 
```

当然，这有点作弊，因为迭代和切片比许多内置函数对您的作用更大。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-04T23:26:51.870

如果你只想要你的字符串中的子字符串，你可以使用这个：

```
str[12:15] 
```

另一个例子：

```
a = '1234567890'
then 
>>> a[-3:-1]
'89'
>>> a[-3:]
'890'
>>> a[-2]
'9'
>>> a[5]
'6' 
```

# android - Android下如何使用Akka项目

> ID：15823383
> 
> 赞同：2
> 
> 时间：2013-04-04T23:19:23.647
> 
> 标签：android, eclipse, scala, akka

我现在有点绝望。我正在尝试在 Android（在 Eclipse 中）下使用 Akka 项目（用 scala 编写），但无论我尝试什么，我都无法让它工作。
为简单起见，我创建了两个项目：一个 Akka 项目，使用 sbt eclipse 创建然后导入到 eclipse，以及一个使用项目创建向导的标准 android 项目。我可以从 android 代码中引用 Akka 代码，但在运行时我总是得到一个`NoClassDefFoundError`.
如果有人能指出我做错了什么或者我通常可以做什么来在我的 Android 应用程序中使用我的 Akka 项目，我将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-09T00:46:03.887

我感觉到你的痛苦。我花了*几个小时*试图让 sbt、proguard、scala、akka 工作，并建议你从这里查看 project/Build.scala：

[https://github.com/fehguy/swagger-for-the-home/tree/master/android](https://github.com/fehguy/swagger-for-the-home/tree/master/android)

具体`proguard`选项：

```
proguardOption in Android :=
  """
    |-dontwarn scala.**
    |-keepclassmembers class * {
    |    ** MODULE$;
    |}
    |-keep class scala.collection.SeqLike {
    |    public protected *;
    |}
    |-keep public class * extends android.app.Activity
    |-keep public class * extends android.app.Application
    |-keep public class * extends android.app.Service
    |-keep public class * extends android.content.BroadcastReceiver
    |-keep public class * extends android.content.ContentProvider
    |-keep public class * extends android.app.backup.BackupAgentHelper
    |-keep public class * extends android.preference.Preference
    |-keep public class com.android.vending.licensing.ILicensingService
    |-keep public class org.eatbacon.sfth.AnalogUpdateActivity
    |-keep public class org.eatbacon.sfth.UpdateDataTask
    |-keep public class org.eatbacon.sfth.ShowChartActivity
    |
    |-keepclasseswithmembernames class * {
    |    native <methods>;
    |}
    |
    |-keepclasseswithmembernames class * {
    |    public <init>(android.content.Context, android.util.AttributeSet);
    |}
    |
    |-keepclasseswithmembernames class * {
    |    public <init>(android.content.Context, android.util.AttributeSet, int);
    |}
    |
    |-keepclassmembers enum * {
    |    public static **[] values();
    |    public static ** valueOf(java.lang.String);
    |}
    |
    |-keep class * implements android.os.Parcelable {
    |  public static final android.os.Parcelable$Creator *;
    |}
  """.stripMargin 
```

)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T07:31:24.890

我在没有看到堆栈跟踪的情况下盲目射击，但听起来你没有从 Android 项目中导出 Akka 项目。

1.  在 Eclipse 中打开您的 Android 项目。
2.  在 Project Explorer 中右键单击您的 Android 项目。
3.  从菜单中选择构建路径 --> 配置构建路径。
4.  当对话框出现时，转到 Order and Export 选项卡，然后确保选中您的 Akka 项目。

# ruby-on-rails - Rails js动作在部分渲染后不会运行代码

> ID：15823386
> 
> 赞同：1
> 
> 时间：2013-04-04T23:19:34.143
> 
> 标签：ruby-on-rails, ajax, jquery-ui, renderpartial, jquery-effects

我正在尝试将新创建的部分添加到现有的部分列表中，该列表在我的`create.js.erb`控制器操作响应中呈现，滚动到该项目并通过突出显示它或其他内容来指示新添加会非常好。我已经掌握了客户端javascript中滚动部分的窍门，但是在部分渲染之后出现的所有效果`create.js.erb`都没有运行。有很多这种可能的例子，我只是不确定为什么我的不起作用。

## 第一次尝试：`create.js.erb`

```
$('#allTab').removeClass('active');
$('#activeTab').addClass('active');
$('#completeTab').removeClass('active');
// TODO: Make sure that li below gets an id="campaign_####" before this render happens.
$('#activeTabList').append("<li><%= escape_javascript(render partial: 'fundraisers/fundraiser', locals: {f: @fundraiser, g: @group}) %></li>")
var number_li = $('#activeTabList li').length;
var $newcampaigndiv = $('#activeTabList li').last().children("panel");
$('#number_of_campaigns').text('Campaigns (' + number_li + ')');
$("body").animate({
    scrollTop: $newcampaigndiv.offset().top
}, {
    duration: 600,
    queue: false
});
$('#activeTabList li').last().children("panel").effect('highlight'); 
```

## 第二次尝试：`create.js.erb`

```
$('#allTab').removeClass('active');
$('#activeTab').addClass('active');
$('#completeTab').removeClass('active');
// TODO: Make sure that li below gets an id="campaign_####" before this render happens.
$.when($('#activeTabList').append("<li><%= escape_javascript(render partial: 'fundraisers/fundraiser', locals: {f: @fundraiser, g: @group}) %></li>")).done(function () {
    var number_li = $('#activeTabList li').length;
    var $newcampaigndiv = $('#activeTabList li').last().children("panel");
    alert('gets here at least');
    $('#number_of_campaigns').text('Campaigns (' + number_li + ')');
    $("body").animate({
        scrollTop: $newcampaigndiv.offset().top + $newcampaigndiv.height() / 4 - $(window).height() / 2
    }, {
        duration: 600,
        queue: false
    });
    $('#activeTabList li').last().children("panel").effect('highlight');
}); 
```

我很犹豫要不要问这个问题，因为我不反对接受我只是没有正确遍历 dom 的事实，但我一直在尝试各种组合以使其正确。

## 还：

如果我尝试嵌入更多的 ruby​​ 来设置`<li>`周围部分的 id，它会破坏整个动作并且不会渲染部分。知道我在这里缺少什么吗？

# javascript - 如何使用 localStorage（Chrome 扩展程序）存储数组？

> ID：15823390
> 
> 赞同：0
> 
> 时间：2013-04-04T23:19:43.423
> 
> 标签：javascript, google-chrome-extension

我试图在 localStorage 中存储一个数组，但后来我读到这是不可能的。所以我尝试了：

```
 array = {};
    array.name =        $('[name="name"]').val();
    array.username =    $('[name="username"]').val();
    array.password =    $('[name="password"]').val();

    alert(localStorage['accounts']);
    local = JSON.parse(localStorage['accounts']);
    localu = local.push(array);
    alert(JSON.stringify(localu)); 
```

事实上，脚本在第一个返回“[]”的警报处停止（我之前输入了该值来检查结果）。

为什么我的脚本不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:40:36.790

JavaScript，`{}`是一个对象。`[]`是一个数组。

`var array = []`并`var array = new Array()`做同样的事情。

数组是一个有序的容器，每个值都有一个索引而不是一个键。

一个对象是一个命名的东西容器，每个“东西”都有一个键。

你`array`绝对是一个对象。

```
var data = {};
data.name =        $('[name="name"]').val();
data.username =    $('[name="username"]').val();
data.password =    $('[name="password"]').val();

alert(localStorage['accounts']);
// > undefined OR the value
local = JSON.parse(localStorage['accounts']);
// local contains a parsed version of localStorage['accounts']
localu = local.push(array);
// localu = 0 (push returns the length i think?)
alert(JSON.stringify(localu)); 
```

试试下面的。我没有测试过它，但可能会工作。

```
var data = {};
data.name =        $('[name="name"]').val();
data.username =    $('[name="username"]').val();
data.password =    $('[name="password"]').val();

if (localStorage['accounts'] == undefined) { // fixed
// does the key exist? No so create something to get us started
   localu = { accounts: [] };
} else {
// the key exists! lets parse it
   localu = JSON.parse(localStorage['accounts']);
}
// add the new "data" to the list
localu.accounts.push(data);
// save the results (we have to stringify it)
localStorage['accounts'] = JSON.stringify(localu); 
```

# c# - MongoDb 查询不会一直返回

> ID：15823392
> 
> 赞同：0
> 
> 时间：2013-04-04T23:20:01.003
> 
> 标签：c#, mongodb, mongodb-.net-driver

我有一个非常简单的查询，我使用官方 C# 驱动程序 1.8 对 Mongo 运行，该查询仅在大约 50% 的时间内从执行查询中返回。我有一个单元测试，如果我运行查询，它将在不到一秒的时间内返回大约 50% 的时间，而其他时间它永远不会完成。

下面是查询

```
var q = Database.GetCollection<Stuff>("Stuff").AsQueryable()
    .Where(x => x.Partition == partitionName && x.PersistantId != null && (
        (x.When.DateStart > startingFrom && x.When.DateEnd == null) ||
        (x.When.DateEnd > startingFrom)));
return q.ToList(); 
```

当我接受查询并使用下面的查询在 MongoVue 中运行它时，我可以在 1 秒内得到响应。

```
{ "Partition" : "PartitionID:53", "PersistantId" : { "$ne" : null }, "$or" : [{ "When.DateStart" : { "$gt" : ISODate("2012-04-01T06:00:00Z") }, "When.DateEnd" : null }, { "When.DateEnd" : { "$gt" : ISODate("2012-04-01T06:00:00Z") } }] } 
```

这似乎是 1.8 驱动程序或 MongoDB 2.4.1 中的错误。该集合只有大约 70,000 个项目，并且位于运行在 Windows 上的 mongo 服务器上，具有 4 gigs 内存和几个处理器。

是否有任何我可以查看的诊断日志，或者我的查询可能有错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T03:13:52.113

使用 mongoDB inbuild profiler ，我认为它会帮助你在某个时候查询真正出错的地方[http://docs.mongodb.org/manual/tutorial/manage-the-database-profiler/](http://docs.mongodb.org/manual/tutorial/manage-the-database-profiler/)

# asp.net - 我认为在模型中包含模型？

> ID：15823393
> 
> 赞同：2
> 
> 时间：2013-04-04T23:20:06.470
> 
> 标签：asp.net, asp.net-mvc, razor

我对 ASP/MVC3/C# 非常陌生，但目前正在进行一个项目，要求我将数据库中的所有用户列为下拉列表，理想情况下我想过滤它，以便它只显示某些角色的用户（即管理员、员工或学生）。

但是我的问题在于以下，我有一个控制器（Requests.cs），它具有执行以下操作的方法，并允许我转到`http://server/Requests/UserList`：

```
 public ActionResult UserList()
    {
        // Create our view model
        var users = Membership.GetAllUsers();
        var model = new StudentListViewModel
        {

            Users = users.OfType<MembershipUser>().Select(x => new SelectListItem
            {

                Value = x.ProviderUserKey.ToString(),
                Text = x.UserName
            })
        };

        return View(model);
    } 
```

一个看起来像这样的视图模型：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.ComponentModel.DataAnnotations;
using System.Web.Mvc;

namespace AcademicRegistry.ViewModels
{
    public class StudentListViewModel
    {
        [Display(Name = "select user")]
        public string SelectedUser { get; set; }
        public IEnumerable<SelectListItem> Users { get; set; }
    }
} 
```

以及相关观点：

```
@model AcademicRegistry.ViewModels.StudentListViewModel

@using (Html.BeginForm())
{
    @Html.LabelFor(x => x.SelectedUser)
    @Html.DropDownListFor(x => x.SelectedUser, Model.Users)
    <button type="submit">OK</button>
} 
```

所有这些工作都很好（实际上这是我从这里的另一篇文章中找到的所有代码），这个视图显示了我想要的，即一个下拉列表，其值设置为 userId，文本显示为用户名。

但是我希望它显示在不同的视图中，即 EditUser，但是它已经有一个与之关联的模型（@model AcademicRegistry.Models.Requests）：

```
@model AcademicRegistry.Models.Requests 

@{
    ViewBag.Title = "Edit";
}

<h2>Edit</h2>

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Requests</legend>

        @Html.HiddenFor(model => model.Id)

        <div class="editor-label">
            @Html.LabelFor(model => model.StudentId)
        </div>
        <div class="editor-field">
             *Wanting the dropdown list to show here*
        </div>

        <p>
            <input type="submit" value="Save" />
        </p>
    </fieldset>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div> 
```

我想知道是否有人知道我将如何在需要的地方进行下拉显示？此下拉列表将在很多页面上使用，因此理想情况下需要可重复使用，并且正如我提到的那样，过滤后仅显示属于我设置的 3 个角色的用户。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:33:04.047

您需要将当前获取用户列表并创建 SelectListItem 列表的代码放入其他控制器可以访问的单独方法中。

然后，您可以将 Users 属性添加到将显示此列表的 ViewModel：

```
public IEnumerable<SelectListItem> Users { get; set; } 
```

因此，此时，您拥有需要显示的列表。然后，您可以创建一个获取列表并呈现它的用户控件，或者只使用您当前拥有的内置 DropDownList：

```
@Html.DropDownListFor(x => x.SelectedUser, Model.Users) 
```

# java - 密码保护 .htaccess 就像在 Java Web 应用程序中一样

> ID：15823394
> 
> 赞同：2
> 
> 时间：2013-04-04T23:20:08.987
> 
> 标签：java, servlets, jboss, passwords, security

我有以下情况：

我正在开发在 Jboss 6.1.0 上运行的 Java EE Web 应用程序，我想将此应用程序发布到公共服务器上以供最终用户测试。

例如： http: [//mysite.com/testings/app1/](http://mysite.com/testings/app1/)

我的问题：以 .htaccess（Apache HTTP 服务器）方式保护该目录的适当方法是什么，因此，当我的客户端尝试访问[http://mysite.com/testings/app1/](http://mysite.com/testings/app1/)时，系统会询问用户/密码组合？。

我认为有两种选择：

1.  servlet 服务器上的配置？
2.  反向代理？

我只想澄清在这种情况下最佳实践是什么，因为对于 php 应用程序，.htaccess 功能符合我的需要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:45:33.793

你可以使用spring security，我在[How do I do HTTP basic auth using Struts 2/ Spring 3中写了一个例子？](https://stackoverflow.com/questions/8359258/how-do-i-do-http-basic-auth-using-struts-2-spring-3/15443982).

或者您可以使用“高于”jboss 的 apache httpd 服务器（使用重写和代理），以便用户通过 apache 访问您的站点，然后 apache 转发到 jboss（只会在 localhost 上侦听）。这是一个示例重写规则，用于将“www.mysite.com”转发到带有端口 8009 上的 AJP 连接器的 Web 应用程序“myapp”：

```
<VirtualHost www.mysite.com:80 >
    RewriteEngine on
    RewriteCond %{HTTP_HOST} www\.mysite\.com
    RewriteRule ^/(.*)$ ajp://localhost:8009/myapp/$1 [P,QSA,L]
</VirtualHost> 
```

然后您可以使用 apache auth 系统，例如保护所有 admin/* 页面：

```
<Proxy ajp://localhost:8009/myapp/admin/* >
    Order deny,allow
    Allow from all
    AllowOverride AuthConfig
    AuthType Basic
    AuthName "Admin"
    AuthUserFile /etc/apache2/passwd/admin.passwd
    Require valid-user
</Proxy> 
```

# python - Python - 如何读取一组图像并将其放入矩阵中？

> ID：15823398
> 
> 赞同：0
> 
> 时间：2013-04-04T23:20:45.647
> 
> 标签：python, image-processing, face-recognition, pca

我需要使用 python 读取一组图像并将其放入矩阵中，以便能够执行 PCA（原理成分分析）。所有图像都在一个文件夹中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:22:35.870

使用`numpy`和`PIL`：

```
import numpy as np
import Image

dirname = '...'
[np.asarray(Image.open(os.path.join(dirname, fn))) for fn in os.listdir(dirname)] 
```

# actionscript-3 - 尝试删除对象抛出错误 1009 无法访问空对象引用的属性或方法

> ID：15823402
> 
> 赞同：0
> 
> 时间：2013-04-04T23:21:09.203
> 
> 标签：actionscript-3, flash

开发一个 Flash 游戏，在之前的游戏中，我让敌人通过使用阵列进入，当他们被杀死或离开舞台时，我会将它们从阵列中移除。出于某种原因，当我在这个游戏中使用完全相同的代码时，当我尝试删除数组对象时会抛出 1009: 错误，基本上是说那里什么都没有。. . 这很奇怪。

这是代码：

```
public function addZombie()
{
    var zom:Zombie = new Zombie();
    zom.y = 20;
    zom.x = Math.floor(Math.random()*(1 + 500 - 30)) + 30;
    addChild(zom);
    zombies.push(zom);
    numZombies++;
} 
```

那就是添加它的函数，zombies 是数组，它在这个函数中被推入数组。这是我试图删除它的代码：

```
for (var i:int = 0; i < zombies.length; i++)
{
    if (zombies[i].y + zombies[i].height / 2 > 400) {
        removeChild(zombies[i]);
        zombies.splice(i,1);
        numZombies--;
        addZombie();
    }
} 
```

removeChild(僵尸[i]); <-- 这是尝试删除错误时引发错误的部分。它奇怪地删除了其中一些，但不是全部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:01:46.540

我不相信循环正在做你所期望的。当你以这种方式从数组中移除一个元素时，被移除元素之后的所有元素都会被向下移动。所以，如果你有这样的代码：

```
var testArr:Array = new Array();
testArr.push('First');
testArr.push('Second');
testArr.push('Third');
testArr.push('Fourth');

for (var i:int = 0; i < testArr.length; i++) {
    testArr.splice(i,1);
} 
```

循环的结果将是：

```
i=0, testArr = ['Second', 'Third', 'Fourth']
i=1, testArr = ['Second', 'Fourth']
i=2 END OF LOOP 
```

使用 while 循环可能会更好，仅在未删除元素时才增加索引（因为删除元素会将新元素移动到该索引位置）。

我不明白为什么你得到空对象引用，但这会导致其他问题（为什么有些被删除但不是全部）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T01:13:56.643

Bill Turner 的解释是正确的，但由于它似乎无法帮助您解决问题，您可能想试试这个：

```
var zombieCount:int = zombies.length;

for (var i:int = 0; i < zombies.length; i++)
{
    var zombie = zombies[i];
    if (zombie.y + (zombie.height / 2) > 400) {
        removeChild(zombie);
        zombies.splice(i,1);
        i--; // So that the loop will pass with the same value next time
        numZombies--;
    }
}

for (var j:int = zombies.length; j < zombieCount; j++)
{
    addZombie();
} 
```

# java - 应该是 DDD 中域的本地化部分

> ID：15823411
> 
> 赞同：3
> 
> 时间：2013-04-04T23:21:43.183
> 
> 标签：java, design-patterns, localization, domain-driven-design

在遵循 DDD 概念时，我正在努力决定是否应该让我的域本地化意识？我提供了两种解决方案来解决这个问题。两者都使域本地化在不同的地方有意识。我什至应该将本地化文本放置到域中吗？分享您对此问题的解决方案或我的两个示例的优缺点。谢谢。

> **示例 1**

```
class Persion {

  String name;

  // other fields ommited

  void rename(String newName) {
    String oldName = this.name;
    this.name = newName

    // publish event with old name and new name
  }

  String name() {
    return name;
  }
}

class PersionRepository {

  void store(Persion persion) {
    Locale loc = LocaleContextHolder.get().getLocale();

    // store object to DAO - create/update fields for context locale
  }

  // other methods ommited
} 
```

> **示例 2**

```
class Persion {

  Map<Locale, String> name;

  // other fields ommited

  void rename(String newName) {
    Locale locale = LocaleContextHolder.get().getLocale();
    String oldName = this.name.put(locale, newName);

    // publish event with old name and new name
  }

  String name() {
    Locale locale = LocaleContextHolder.get().getLocale();
    return this.name.get(locale);
  }
}

class PersionRepository {

  void store(Persion persion) {
    // store object to DAO - create/update fields for all locales
  }

  // other methods ommited
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T08:17:23.483

在大多数情况下，最好的选择是从域中删除本地化。

域类应该只包含与其不变量相关的数据，因为它们负责业务规则。要检索本地化描述，请使用投影 DTO 和应用服务。

你可以使用这样的东西：

```
public final class VatCode {
    private final String _code;
    public VatCode(String code)
    {
        // VAT code validation here...
        _code = code;
    }

    @Override
    public String toString() {
        return _code;
    }

    @Override
    public boolean equals(Object obj) {
        // ...
    }

    @Override
    public int hashCode() {
        // ...
    }
}

public class Person {
    private final VatCode _identifier;

    public Person(VatCode identifier)
    {
        _identifier = identifier;
    }

    // some command and some query here...
}

public class PersonDTO {
    private final String _vatCode;
    private final String _personalDescription;

    public PersonDTO(String _vatCode, String _personalDescription) {
        this._vatCode = _vatCode;
        this._personalDescription = _personalDescription;
    }
    // other fields here...

    public String getVatCode()
    {
        return _vatCode;
    }

    public String getPersonalDescription()
    {
        return _personalDescription;
    }

    // some more getter here
}

public interface LocalizedPersonalInformationService {
    PersonDTO getInformationOf(VatCode person, Locale localization) throws ProperExceptionList;
} 
```

那是：

*   类似于`VatCode`valueobject（覆盖 equals、hashCode 和 toString）来识别`Person`实体
*   一个实体，持有确保**业务不变性**`Person`所需的最少数据量并公开一组[命令和查询](http://epic.tesio.it/doc/manual/command_query_separation.html)
***   a`PersonDTO`带有有用的描述（有些人称之为[read-model](http://gorodinski.com/blog/2012/04/25/read-models-as-a-tactical-pattern-in-domain-driven-design-ddd/)）*   a`LocalizedPersonalInformationService`能够提供`PersonDTO`s。*   和（显然）所有[需要的](http://epic.tesio.it/2012/12/05/exceptions-are-the-norm.html) [例外](http://epic.tesio.it/2013/03/04/exceptions-are-terms-ot-the-ubiquitous-language.html)...... :-)**

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T01:49:29.897

如果可能的话，把你所有的本地化都放在 UI 层。有时人们发现这很难做到。例如，我在一个项目中工作，其中业务逻辑会引发异常，并且该异常会显示在 UI 中。要本地化异常，我们必须执行以下操作（为简洁起见省略了详细信息，我们还必须有 a`LocalizedRuntimeException`和 a `LocalizedException`）：

```
//====ArbitraryBusinessLogic.java====

if(badThing) {
  throw new SubclassOfLocalizedException(LocalizedStrings.ERROR_FOO,param1,param2);
}

//====LocalizedException.java====

public class LocalizedException extends Exception {

  private LocalizationKey localizationKey;
  Object [] params;

  public LocalizedException(LocalizationKey localizationKey, Object ... params) {
    super();
    localizationKey = localizationKey
    params = params;
  }

  public String getLocalizedMessage(Locale locale) {
    //message would be something like "The %s foo'd the %s"
    //or of course "le %s foo'd le %s" (FYI: I don't speak French)
    String message = getLocalizedMessageForKey(localizationKey);
    return String.format(locale,message,params);
  }

  public String getLocalizedMessage() {
    return getLocalizedMessage(getDefaultLocale());
  }

  public String getMessage() {
    return getLocalizedMessage();
  }

} 
```**

# windows - 为 Haxe CPP 设置 FlashDevelop 断点，允许“Step-Into”功能？

> ID：15823412
> 
> 赞同：0
> 
> 时间：2013-04-04T23:21:44.653
> 
> 标签：windows, breakpoints, haxe, step-into

当针对 Windows 的 Haxe/NME 程序时，有没有办法在 FlashDevelop 中设置断点？如果我无法进入代码，就很难遵循错误的逻辑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T03:28:36.880

在这篇[文章](http://haxeflixel.com/forum/help/using-visual-c-for-debugging-cpp-target-with-breakpoints)中，您可以找到一个示例 Visual Studio 项目，该项目允许您调试 cpp 目标。

# search - 如何在 Plone 中覆盖搜索结果排序顺序

> ID：15823413
> 
> 赞同：7
> 
> 时间：2013-04-04T23:21:58.117
> 
> 标签：search, overriding, plone

Plone 搜索功能在[plone.app.search](https://pypi.python.org/pypi/plone.app.search)包中实现；请求中包含的**sort_on**变量用于控制[搜索模板](https://github.com/plone/plone.app.search/blob/master/plone/app/search/search.pt)上结果的排序顺序。

默认情况下，当此变量没有值时，Plone 使用**相关性**作为排序顺序。

迄今为止最简单的方法是什么**（最新的）**？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T12:28:19.267

您需要自定义搜索视图以设置新的排序选项，并在未设置排序时更改默认排序。

如果您仍然需要能够按相关性排序，请使用一个非空值，然后在`filter_query`方法中更改该值：

```
from plone.app.search.browser import _, Search, SortOption

class MyCustomSearch(Search):
    def filter_query(self, query):
        query = super(MyCustomSearch, self).filter_query(query)

        if 'sort_on' not in query:
            # explicitly set a sort; if no `sort_on` is present, the catalog sorts by relevance
            query['sort_on'] = 'EffectiveDate'
            query['sort_order'] = 'reverse'
        elif query['sort_on'] == 'relevance':
            del query['sort_on']

        return query

    def sort_options(self):
        """ Sorting options for search results view. """
        return (
            SortOption(self.request, _(u'date (newest first'),
                'EffectiveDate', reverse=True
            ),
            SortOption(self.request, _(u'relevance'), 'relevance'),
            SortOption(self.request, _(u'alphabetically'), 'sortable_title'),
        ) 
```

然后将此视图注册到您的站点；如果您使用最简单的主题层：

```
<configure
    xmlns="http://namespaces.zope.org/zope"
    xmlns:browser="http://namespaces.zope.org/browser"
    i18n_domain="plone">

    <browser:page
        name="search"
        layer=".interfaces.IYourCustomThemeLayer"
        class=".yourmodule.MyCustomSearch"
        permission="zope2.View"
        for="*"
        template="search.pt"
        />

    <browser:page
        name="updated_search"
        layer=".interfaces.IYourCustomThemeLayer"
        class=".yourmodule.MyCustomSearch"
        permission="zope2.View"
        for="Products.CMFCore.interfaces.IFolderish"
        template="updated_search.pt"
    />

</configure> 
```

您需要从包中复制`search.pt`和`updated_search.pt`模板。`plone.app.search`

# bash - 在 bash 脚本中按哈希 sha1 搜索

> ID：15823414
> 
> 赞同：0
> 
> 时间：2013-04-04T23:21:58.933
> 
> 标签：bash, search, sha1

如何使用命令*find*在 bash 脚本中通过**哈希 sha1**搜索文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:26:39.823

虽然`find`没有选项来检查文件的 SHA1，但您可以`sha1sum`为它找到的每个文件执行 find ，然后使用它`grep`来选择您要查找的校验和。例如：

```
find . -type f -exec sha1sum '{}' ';' | grep 7ceeeeaba7d7e22301dfc5d6707f0c7f3eeb55a8 
```

# javascript - 如何将新的 Dijit 小部件添加到页面？

> ID：15823420
> 
> 赞同：2
> 
> 时间：2013-04-04T23:22:18.370
> 
> 标签：javascript, jquery, widget, dojo

我有一个输入数量可变的表格。我正在寻找的行为是有一个链接，用户可以单击该链接并将新输入添加到可以填写的表单中。像这样的东西

HTML：

```
<form id="myform">  
  <input data-dojo-type="dijit.form.Textarea"/>  
  <a href="#" onclick="add_new_input()"> add a new input</a>  
</form> 
```

JAVASCRIPT：

```
<script>  
  function add_new_input(){  
    var newInput = $("<input data-dojo-type='dijit.form.Textarea'/> ");  
    $('#myform').append(newInput);  
  }  
</script> 
```

这将向 HTML 添加常规文本输入，而不是 dijit 小部件！你有什么建议吗？

我还通过为输入文件定义一个类并将输入类型绑定在 ($document).ready() 上来做到这一点，但这也不起作用！:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T01:45:56.640

通过以编程方式创建 Textarea 小部件（如 @Paul Grime 所述）来解决这个问题非常简单。您可以[在此处查看我的示例，](http://jsfiddle.net/humLq/8/)其中链接创建的所有文本区域都是 Dijit 小部件。我没有在我的小提琴中使用 jQuery，但你需要做的就是将你的`add_new_input`函数更改为

```
function add_new_input (){
  var newInput = new Textarea({

    // Your custom properties here.

  });
  domConstruct.place(newInput.domNode, "myform");

  // Can alternatively place it as so if you don't want to use the
  // dojo/dom-construct module...
  // dojo.byId('myform').appendChild(newInput.domNode);   

  // Or with jQuery...
  // $("myform").append(newInput.domNode);
} 
```

# c# - 如何查看数据库图？

> ID：15823428
> 
> 赞同：0
> 
> 时间：2013-04-04T23:22:59.927
> 
> 标签：c#, asp.net-mvc-4, visual-studio-2012, ef-code-first, sql-server-2012

我正在做一个项目，该项目需要我`POCO classes`使用`Entity Framework Code First`. 有很多实体关系和继承正在进行，并且很难仅通过查看代码来跟踪所有内容。现在，正如我们所知，`Entity Framework Code First`生成一个`.mdf`文件作为您的数据库，我正在考虑进行验证，数据库图会更好地为我服务。

我可以在这种情况下查看我的数据库图吗？我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:32:13.647

You could always point it to a SQL Server Express database - by default an MVC 4 project uses LocalDB but if you're more comfortable in management studio you can always create your own database and change the connection string to that.

Also from memory I believe you can also attach an mdf file in management studio but may have trouble while the application is running. But I could be thinking of something else there.

# jquery - 点击后标签条不刷新

> ID：15823429
> 
> 赞同：0
> 
> 时间：2013-04-04T23:23:05.383
> 
> 标签：jquery

我有一个弹出窗口，它从标签条内容内的按钮打开，我希望我的标签条在窗口关闭后重新加载。但它不是从我的下面的脚本重新加载。为什么？？

```
<script type="text/javascript">
    $(document).ready(function () {
            $(".k-window-action.k-link").click(function () {

            var tabStrip = $("#abc").data("kendoTabStrip"); //finding tabstrip
            var tabContent = $("#abc").data("kendoTabStrip").contentHolder(1); //selecting particular tab
            tabStrip.reload(tabContent); //reloading the tab
            }); 
        });
    </script> 
```

# orchardcms - 果园如何使主页地址也可以通过索引访问

> ID：15823434
> 
> 赞同：0
> 
> 时间：2013-04-04T23:23:18.773
> 
> 标签：orchardcms, orchardcms-1.6

假设我现在的主页是：www.myorchard.com

当用户访问 www.myorchard.com/index 也进入主页时，我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T00:52:00.763

你不想要那个。对于良好的 SEO，资源应始终对应于一个 URL。您想要做的是永久地从一个重定向到另一个。您可以使用 IIS 的重写 URL 模块或通过此 Orchard 模块执行此操作：http: [//gallery.orchardproject.net/List/Modules/Orchard.Module.Contrib.RewriteRules](http://gallery.orchardproject.net/List/Modules/Orchard.Module.Contrib.RewriteRules)

前一种解决方案是首选，因为开销较小，但如果您认为您将不得不经常管理大量重写，则后者更方便。

# symfony - 带有 PHPPDF 的 Symfony 2.1

> ID：15823439
> 
> 赞同：0
> 
> 时间：2013-04-04T23:23:57.260
> 
> 标签：symfony, symfony-2.1

我正在尝试将图像（jpg 文件）包含到使用 Symfony 2.1.3 的 phppdf 包创建的 pdf 中。

我能够创建 pdf，但无法让它们包含图像。

我在树枝模板中使用：

```
img src="{{ pdf_image('gimage.jpg') }}" 
```

我尝试将 jpg 放在许多不同的地方，并尝试了许多不同的路径，例如`img src="{{ pdf_image('XX/XX/XX/gimage.jpg') }}"`但没有任何效果。我也尝试过没有`pdf_image`.

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T08:32:36.670

Are you using the [psliwa PdfBundle](https://github.com/psliwa/PdfBundle "psliwa PdfBundle")?

If so it says to use..

```
<img src="{{ pdf_image('SymfonyWebConfiguratorBundle:blue-arrow.png') }}" /> 
```

Which I think would be linking to..

```
path/to/SymfonyWebConfiguratorBundle/Resources/blue-arrow.png 
```

# jquery - 如何覆盖 jQuery 函数或阻止它执行

> ID：15823449
> 
> 赞同：0
> 
> 时间：2013-04-04T23:25:00.920
> 
> 标签：jquery, function, execution

我有一个 jQuery 函数，可以将 WordPress 菜单转换为浮动菜单，然后再返回。

我想在主题中创建一个演示面板，允许用户在静态和浮动菜单之间切换或切换。

工作站点可以在这里看到：http: [//morphius.wpinsite.com](http://morphius.wpinsite.com)

这是将菜单设置为浮动的 jQuery 代码。

```
function header_transform(){

        window_y = $(window).scrollTop();
        var wp_admin_height = "0px";
        if ($("#wpadminbar").length > 0){
            wp_admin_height = parseInt($("#wpadminbar").height()) + "px";
        }
        if (window_y > scroll_critical) {
            if (!($("#header-wrapper").hasClass("fixed"))){
                    $("#header-wrapper").hide();
                    $("#wrapper").css("margin-top", header_h + "px");
                    $("#header-wrapper").addClass("fixed").css("top", wp_admin_height);
                    $("#header-wrapper").fadeIn(500);
                    //$logo2_link.fadeIn().appendTo(".header");
                    $logo2_link.fadeIn().prependTo(".header");
                    fixedmenu = true;
            }

        } else {
            if (($("#header-wrapper").hasClass("fixed"))){
                $("#header-wrapper").fadeOut(500, function(){
                    $("#header-wrapper").removeClass("fixed");
                    $("#wrapper").css("margin-top", "");
                    $("#header-wrapper").fadeIn(300)
                });

                $logo2_link.fadeOut().remove();
                fixedmenu = false;
            }

        }
} 
```

我想要实现的是，如果用户单击演示选项面板并将菜单设置为“固定”，那么下面的 jQuery 代码将不会执行并转换菜单。

默认情况下，下面的 jQuery 代码将始终运行。如果有人单击“固定”菜单选项，我只需要一种方法来阻止它执行。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:28:48.330

在函数的开头添加这样的内容：

```
if($(".switcherFixed img").hasClass("selected")) {
    return;
} 
```

有帮助吗？

# mysql - 大于和小于 MySql 查询因小数字段而失败

> ID：15823450
> 
> 赞同：4
> 
> 时间：2013-04-04T23:25:09.393
> 
> 标签：mysql

我有一个包含 3 列的数据库：

```
user_id | lat      | lon
1       |-1.403976 | 53.428692
2       |-1.353276 | 55.224692
etc etc 
```

lat 和 lon 都设置为十进制字段。我正在运行与此类似的查询，但它不是基于大于和小于给定的纬度/经度数字进行过滤：

```
SELECT * FROM `table` WHERE `lat` < '-1.399999' AND 'lat' > '-1.300000' 
AND 'lon' < '55.555555' AND > '53.000000' 
```

这个查询只返回表中的每一行，我不知道为什么？这与设置为小数的字段有关吗？

我希望有人可以提供帮助-如果您知道，我知道这可能是一个简单的答案。

根据评论 - 这是创建表：

```
CREATE TABLE IF NOT EXISTS `members` (
`user_id` int(10) NOT NULL AUTO_INCREMENT,
`lat` decimal(8,6) NOT NULL,
`lon` decimal(8,6) NOT NULL,
UNIQUE KEY `user_id` (`user_id`),
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=136 ; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T23:27:35.667

问题是你用单引号包裹列名，强制十进制值与字符串文字进行比较。列名和表名是标识符而不是字符串文字，因此它们不应该用单引号引起来。

```
AND `lat` > '-1.300000' 
AND `lon` BETWEEN '55.555555' AND '53.000000' -- use between here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:40:37.277

正如@JW 建议的那样，您将反引号 ( ```) 和单引号 ( `'`) 混合在一起。在数据库表和列名周围使用反引号，但在数据值周围使用引号。

此外，查询的后半部分与前半部分不匹配。你有

```
`lat` < '-1.399999' AND 'lat' > '-1.300000'
'lon' < '55.555555' AND > '53.000000' 
```

但应该是

```
`lat` < '-1.399999' AND `lat` > '-1.300000'
`lon` < '55.555555' AND `lon` > '53.000000' 
```

因此，您在第四条语句中缺少列名。

或者，正如@JW 所说，使用`BETWEEN`它也更容易阅读！

```
SELECT * FROM `table` WHERE `lat` BETWEEN '-1.399999' AND '-1.300000' AND `lon` BETWEEN '55.555555' AND '53.000000'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-31T07:12:47.980

例子：

从 STATION 查询值大于 38.7880 且小于 137.2345 的北纬 (LAT_N) 总和。将您的答案截断到小数点后 4 位。

```
SELECT TRUNCATE(SUM(LAT_N),4)
FROM STATION
WHERE LAT_N > 38.7880 and LAT_N < 137.2345; 
```

# php - 使用 php 联系表发送电子邮件

> ID：15823457
> 
> 赞同：1
> 
> 时间：2013-04-04T23:25:59.857
> 
> 标签：php, forms, email

我正在尝试使用 php 创建联系表单。当我单击发送时，电子邮件似乎已发送，但收件人从未真正收到它。也许我需要设置一个 SMTP 服务器，但我不确定如何执行此操作。提前致谢

在 form.html 我有

```
<form action="mail.php" method="POST">
<p>Name</p> <input type="text" name="name">
<p>Email</p> <input type="text" name="email">
<p>Phone</p> <input type="text" name="phone">

<p>Request Phone Call:</p>
Yes:<input type="checkbox" value="Yes" name="call"><br />
No:<input type="checkbox" value="No" name="call"><br />

<p>Website</p> <input type="text" name="website">

<p>Priority</p>
<select name="priority" size="1">
<option value="Low">Low</option>
<option value="Normal">Normal</option>
<option value="High">High</option>
<option value="Emergency">Emergency</option>
</select>
<br />

<p>Type</p>
<select name="type" size="1">
<option value="update">Website Update</option>
<option value="change">Information Change</option>
<option value="addition">Information Addition</option>
<option value="new">New Products</option>
</select>
<br />

<p>Message</p><textarea name="message" rows="6" cols="25"></textarea><br />
<input type="submit" value="Send"><input type="reset" value="Clear">
</form> 
```

在我有的 mail.php 文件中

```
<?php
$name = $_POST['name'];
$email = $_POST['email'];
$phone = $_POST['phone'];
$call = $_POST['call'];
$website = $_POST['website'];
$priority = $_POST['priority'];
$type = $_POST['type'];
$message = $_POST['message'];
$formcontent=" From: $name \n Phone: $phone \n Call Back: $call \n Website: $website \n        Priority: $priority \n Type: $type \n Message: $message";
$recipient = "kerrip90@hotmail.co.uk";
$subject = "Contact Form";
$mailheader = "From: $email \r\n";
mail($recipient, $subject, $formcontent, $mailheader) or die("Error!");
echo "Thank You!" . " -" . "<a href='form.html' style='text-    decoration:none;color:#ff0099;'> Return Home</a>";
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:28:39.170

要使该`mail()`功能正常工作，您只需发出以下命令即可在服务器上安装 postfix：

```
sudo apt-get install postfix 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:00:05.597

你可以试试这个`pear`包。

```
sudo apt-get install pear
sudo pear install mail 
```

安装也会推荐一些其他的包。以相同的方式安装它们。发送邮件使用：

```
public function sendMail($to)
  {
     require_once('Mail.php');
     $this->_to=$to;
     $host = "ssl://smtp.gmail.com";
     $port = "465";
     $headers = array ('From' => $this->_from,
                   'To' => $this->_to,
                   'Subject' => $this->_subject);
     $smtp = Mail::factory('smtp',
                          array ('host' => $host,
                                 'port' => $port,
                                 'auth' => true,
                                 'username' => $this->_username,
                                 'password' => $this->_password));
    $mail = $smtp->send($this->_to, $headers, $this->_body);
 } 
```

# python - While循环下的Python列表

> ID：15823458
> 
> 赞同：0
> 
> 时间：2013-04-04T23:26:00.620
> 
> 标签：python, list, loops

我想做一个像这样的while循环

```
list=[]    
while x in range(r):
        list-x="something" 
```

每次循环开始时，它都会创建一个带有数字 (x) 的新列表。因此，如果它循环超过 5 次，就会有不同的列表：list(1) list(2) list(3) list(4)。'

这甚至可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T23:33:51.277

You are able to do this with the vars() function:

```
for i in range(5):
    list_name = ''.join(['list', str(i)])
    vars()[list_name] = [] 
```

You can then reference each list:

```
print(list1)
--> []
print(list2)
--> []

etc... 
```

You can also achieve this using the locals() or globals() functions as below:

```
for i in range(5):
    locals()['list{}'.format(i)] = [] 
```

Hope that helps!

# android - 在android中旋转动画

> ID：15823460
> 
> 赞同：0
> 
> 时间：2013-04-04T23:26:09.427
> 
> 标签：android, android-layout, android-widget, android-animation

我正在创建一个轮子旋转动画，它会在我运行应用程序时自动运行...我希望它旋转 90 度并暂停一段时间，然后再次旋转 90 度直到达到 360%...这是我的代码::

```
public void Start(){
    RotateAnimation counterSpinW = new RotateAnimation(0f, 90f, 50,50);
    counterSpinW.setRepeatMode(1);
    counterSpinW.getFillAfter();
    counterSpinW.setDuration(8000);

    counterSpinW.setInterpolator(new LinearInterpolator());
   bigLayout.startAnimation(counterSpinW);

   RotateAnimation counterSpinW2 = new RotateAnimation(0f, 90f, 50,50);
   counterSpinW2.setRepeatMode(1);
   counterSpinW2.getFillAfter();
   counterSpinW2.setDuration(8000);
   counterSpinW2.setInterpolator(new LinearInterpolator());
  bigLayout.startAnimation(counterSpinW2);

  RotateAnimation counterSpinW3 = new RotateAnimation(0f, 90f, 50,50);
  counterSpinW3.setRepeatMode(1);
  counterSpinW3.getFillAfter();
  counterSpinW3.setDuration(8000);
  counterSpinW3.setInterpolator(new LinearInterpolator());
 bigLayout.startAnimation(counterSpinW3);

 RotateAnimation counterSpinW4 = new RotateAnimation(0f, 90f, 50,50);
 counterSpinW4.setRepeatMode(-1);
 counterSpinW4.getFillAfter();
 counterSpinW4.setDuration(8000);
 counterSpinW4.setInterpolator(new LinearInterpolator());
bigLayout.startAnimation(counterSpinW4); 
```

我想也许这行不通..但我还没有测试过....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:30:50.833

you should use [setStartOffset()](http://developer.android.com/reference/android/view/animation/Animation.html#setStartOffset%28long%29)

```
firstRotateAnimation.setStartOffset(0);
pauseAnimation.setStartOffset(8000);
newRotateAnimation.setStartOffset(16000); 
```

# jquery - html5 / jQuery，每 100 毫秒执行毫秒动画的时钟， 或者 ?

> ID：15823468
> 
> 赞同：0
> 
> 时间：2013-04-04T23:26:57.917
> 
> 标签：jquery, html, canvas, performance-testing

我在 jQuery 中编写了一个小型秒表/时钟，它将使用 phonegap 构建在 android 和 iOS 上运行，秒表以“00:00:00.0”的格式显示秒表启动以来的时间，它包括毫秒为最后一个数字块，每 100 毫秒更新一次。我一直在谷歌上寻找 canvas 与 div 性能文章，但似乎没有提到它们如何以 100 毫秒的间隔执行更新文本。

我想知道是否最好更新在 a 中显示时间的文本`<div>`还是应该在 a 中`<canvas>`？目前我正在使用 div 并且时不时地会有一点延迟，看起来浏览器无法跟上，非常感谢任何关于这种情况的建议/洞察力，谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:54:35.467

我将在这里转录评论；

> 您应该知道画布会在每个循环中重新绘制，而 DOM 元素仅在请求时才移动/动画。即使我认为，使用如此简单的动画，两者都无关紧要，但 DOM 移动 () 会更快。
> 
> DOM 元素动画的缺点可能是视觉上的浏览器性能。有些浏览器倾向于以不同的方式旋转和转换 DOM 元素，也就是说；丑陋（锋利的边缘等）。
> 
> 计时器不会滞后，不用担心。如今，JavaScript 引擎的性能非常高。你不会在时间问题上遇到问题，它可能只是在不同的浏览器中使用 DOM 看起来不同。通过视觉表现，我的意思是，不是口吃:)
> 
> 此外，您想要实现的目标也很轻。两者都会起作用。我会去 DOM 寿，但这是个人的事情:)

# c++ - Boost::ASIO 无法从服务器写回客户端

> ID：15823470
> 
> 赞同：3
> 
> 时间：2013-04-04T23:27:09.133
> 
> 标签：c++, sockets, cross-platform, boost-asio, allegro5

我有几个关于 Boost ASIO 的问题。

我遇到了一个问题，我的客户端可以连接到服务器并异步发送数据，但无法收到任何回复。**async_write 回调得到错误：“提供的文件句柄无效”。**我觉得这很奇怪，有几个原因：

1.  当客户端最初连接时，我检查服务器上的 socket.isOpen()，它返回 true。
2.  客户端仍然可以发送数据的事实使我认为这是服务器端问题或防火墙问题（我觉得很奇怪，因为服务器和客户端都在同一台计算机上（我使用“localhost”连接现在）。

更多信息...

TCP 套接字。

我正在并排使用 Boost 和 Allegro，并且正在使用 Boost 和 Allegro 线程。我的 io_service 像这样（服务器和客户端）在 Boost 线程中运行：

```
boost::asio::io_service::work work( io_service );
boost::thread io_thread( boost::bind( &boost::asio::io_service::run, &io_service ) ); 
```

这在我创建套接字之前就被调用了。

Allegro 线程保存 Allegro 事件循环，没有什么特别之处。

我不想发布源代码，它非常庞大且复杂，我宁愿不尝试将其简化为基本案例。如果有必要，我可以。

我的套接字由一个类包装，在该类中创建和传递共享指针而不是常规指针（不确定这是否重要，我是 Boost 新手）。

感谢您在确定我无法回信给已连接的客户时提供的任何帮助。

尼尔

编辑：请求的代码段：

async_read/write（服务器）和回调函数：

```
void ServerConnection::async_read()
{
    if( this->m_socket.is_open() == false )
    {
        std::cerr << "socket closed... (read)\n";
    }

    boost::asio::async_read( this->m_socket,
                             boost::asio::buffer( &m_input, sizeof( m_input ) ),
                             boost::bind( &ServerConnection::read_callback,
                                          shared_from_this(),
                                      boost::asio::placeholders::error,
                                      boost::asio::placeholders::bytes_transferred ) );
}

void ServerConnection::async_write(const packet_list &packet, packet_id id, uint8_t rr)
{
    this->m_output.data = packet;
    this->m_output.head.opcode = id;
    this->m_output.head.sender_id = 0;
    this->m_output.head.response_required = rr;

    if( this->m_socket.is_open() )
    {
        std::cerr << "socket closed... (write)\n";
    }

    boost::asio::async_write( this->m_socket,
                              boost::asio::buffer( &m_output, sizeof( m_output ) ),
                              boost::bind( &ServerConnection::write_callback,
                                           shared_from_this(),
                                           boost::asio::placeholders::error,
                                           boost::asio::placeholders::bytes_transferred ) );
}

void ServerConnection::read_callback( const boost::system::error_code &error,
                                  size_t /*read_count*/ )
{
    if( error )
    {
        std::cerr << "Error reading: " << error.message() << std::endl;
        return;
    }

    std::cerr << "Server reading data...\n";

    if( this->m_event_dispatcher != nullptr )
    {
        ALLEGRO_EVENT event;

        if( m_input.head.opcode == C_ACCEPT )
        {
            event.type = 513;
        }
        else
        {
            event.type = 512;
            event.user.data1 = (intptr_t)&m_input;
        }

        al_emit_user_event( this->m_event_dispatcher, &event, nullptr );
    }
    else
    {
        std::cerr << "Why is this null....\n";
    }

    async_read();
}

void ServerConnection::write_callback(const boost::system::error_code &error,
                                  size_t /*write_count*/ )
{
    // After a write, we don't need to do anything except error checking.
    if( error.value() )
    {
        std::cerr << "Error writing to client. " << error.message() << std::endl;
    }
} 
```

# class - 使用堆栈变量建模 UML 类图

> ID：15823471
> 
> 赞同：0
> 
> 时间：2013-04-04T23:27:17.067
> 
> 标签：class, uml, diagram

假设我有 A 类，而在里面我有 B 类。

在A类里面，我还有一堆B类的。

我如何在 A 类的 UML 图中准确地写出符号，A 类和 B 类之间的关系是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:30:15.417

类 A 可能与类 B 共享组合关系，而 A 是一对多 B。通常在 UML 中通过用箭头连接两个类来表示这一点，在 A 的末尾有“1”，“0...*”在B端。

查看[http://en.wikipedia.org/wiki/Object_composition](http://en.wikipedia.org/wiki/Object_composition)了解更多详情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T17:26:51.667

如果我仔细阅读，同时有一个内部堆栈和一个内部单个元素。这不是问题，因为您可以在两个相同对象之间建立多个关系。

```
------------- ?           inner   ---------------
|           |-------------------> |             |
|           |                 1   |             |
| Class A   |                     |   Class B   |
|           | ?            stack  |             |
|           |-------------------> |             |
-------------                0..* --------------- 
```

我不知道在问号上放什么。一个 B 可以同时在多个 A 的堆栈中吗？多重性将取决于答案。

关于 Sebastiaõ 提到的物体组合，它在我的绘图中的箭头左侧添加了黑色菱形，但请注意，这意味着 1）你有义务在我的问号上加上 1，以及 2）如果你摧毁 A ，然后你销毁所有相关的 B。不确定你的情况。

最后一点，正如 Sebastiaõ 在他对他的回答的评论中所说，如果你放箭头，A 会看到 B，但 B 不会看到 A，而如果你放一条简单的线，你可以任意导航。

# php - Zend Framework 2 应用程序中依赖于环境的配置应该存储在哪里？

> ID：15823473
> 
> 赞同：1
> 
> 时间：2013-04-04T23:27:29.193
> 
> 标签：php, configuration, zend-framework2, config, configuration-files

ZF2 应用程序包含/包含许多不同的配置文件：`/config/application.config.php`、`/config/autoload/global.php`、`/config/autoload/local.php`、`/module/***/config/module.config.php`.

现在我已经编写了一个模块，它涵盖了应用程序的缓存功能，并且在我的本地/开发和实时环境中需要不同的项目的 livetime 值。我还希望能够根据环境切换缓存类型。

这样的东西应该在哪里痛？在`/config/autoload/global.php`和`/config/autoload/local.php`？如果是：它应该首先从`Module`类中的这些文件中检索（例如在`onBootstrap()`方法中）还是直接在需要的地方使用？

（如果有人可以展示一个保存和获取此类配置数据的原始示例，那也很棒。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:07:15.847

我目前使用的解决方案是：

`/config/autoload/global.php`和/或`/config/autoload/local.php`

```
return array(
    // DB credentials
    'db' => array(
        'username'  => ...,
        'password'  => ...,
        'dbname'    => ...,
        'host'      => ...,
    ),
    'cache_ttl' => 'global/local value for cache live time',
); 
```

缓存`Module`类

```
class Module {

    private $moduleConfig;

    public function onBootstrap(MvcEvent $mvcEvent) {
            $application = $mvcEvent->getParam('application');
            $this->moduleConfig = $application->getConfig();
    }

    ...

    public function getServiceConfig() {
        try {
            return array (
                'factories' => array(
                    ...
                    'Zend\Cache\Adapter\MemcachedOptions' => function ($serviceManager) {
                        return new MemcachedOptions(array(
                            'ttl'           => $this->moduleConfig['cache_ttl'],
                            ...
                        ));
                    },
                    ...
                )
            );
        }
        ...
    }
} 
```

它工作正常，但我很确定，这不是最佳实践/推荐的方式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T03:04:54.157

您的基本方法是正确的。

对于缓存配置内容，请将您的生产值保存在全局文件中。这应该存在于您的 VCS 中。（编辑：但是，您可能应该省略安全敏感配置，例如数据库密码。通过 local.php 将这些内容添加到生产环境中，以使其不受版本控制）。

在您的本地环境中，使用本地文件来覆盖任何需要被覆盖的东西。IIRC ZendSkeletonApplication 有一个 .gitignore 文件，它将忽略任何内置的本地配置——因此您的本地配置永远不会进入 git。

但是，您不需要像您一样在引导程序上加载配置。您可以从工厂方法中的 serviceManager 获取配置：

```
public function getServiceConfig() {
    try {
        return array (
            'factories' => array(
                ...
                'Zend\Cache\Adapter\MemcachedOptions' => function ($serviceManager) {
                    return new MemcachedOptions(array(
                        // you can just grab your config from the service-manager
                        'ttl'           => $serviceManager->get('Config')['cache_ttl'],
                        ...
                    ));
                },
                ...
            )
        );
    }
    ...
} 
```

另外-我不会将'cache_ttl'作为顶级配置键。相反，请尝试：

**全局.php**

```
return array(
    'cache' => array(
        'ttl' => ...,
        'servers' => ...,
        ...
    )
); 
```

这将您的工厂简化为：

```
'Zend\Cache\Adapter\MemcachedOptions' => function ($serviceManager) {
    return new MemcachedOptions( $serviceManager->get('cache') );
}, 
```

你可以在你的 local.php 配置中覆盖任何你想要的东西。如果您只想更改 ttl（保留所有其他全局配置）：

**本地.php**

```
return array(
    'cache' => array('ttl'=>...)
); 
```

# php - php 选中时表单复选框的总和值

> ID：15823475
> 
> 赞同：0
> 
> 时间：2013-04-04T23:27:40.997
> 
> 标签：php, forms, checkbox

我在 php 中有一个显示复选框的表单。这些复选框与从 mysql 填充的数值相关联。我要做的是添加每个复选框的值，但前提是选中该框。

我遇到的问题是无论我检查了哪些框，都会返回第一个复选框的值。例如，如果总共有 5 个复选框并且我选择了底部的 2 个，则返回的总和是顶部的 2 个框而不是底部的框。似乎我的 php 代码知道正在检查框，但不知道正在检查哪些框。

这是我的表单代码

```
echo "<input type=\"hidden\" name=\"ID[]\" value=\"".$row['ID']."\" />";
echo "<tr><td>&nbsp;<input type=\"checkbox\" name=\"checked[]\" value=\"Y\"></td>";
echo "<input type=\"hidden\" name=\"amount[]\" value=\"".$row['amount']."\" />"; 
```

这是我的帖子

```
if('POST' == $_SERVER['REQUEST_METHOD']) {
$amt = 0;
$totamt = 0;
foreach($_POST['ID'] as $i => $id)
{

$id = mysql_real_escape_string($id);
  $checked = mysql_real_escape_string($_POST['checked'][$i]);
  $amt = mysql_real_escape_string($_POST['amount'][$i]);

if ($checked == "Y") {
$totamt = $totamt + $amt;
$amt = 0;
}

}
echo $totamt;
} 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:52:31.793

从表单发送的唯一复选框是被选中的复选框，无论它们是哪个数组索引都将从 0 开始。所以复选框的索引和隐藏字段的索引之间没有对应关系。有几种方法可以解决这个问题。

一种方法是将显式索引放在复选框名称中：

```
echo "<tr><td>&nbsp;<input type=\"checkbox\" name=\"checked[".$row['ID']."]\" value=\"Y\"></td>";
echo "<input type=\"hidden\" name=\"amount[".$row['ID']."]\" value=\"".$row['amount']."\" />"; 
```

然后你可以加起来：

```
$totamt += $_POST['amount'][$_POST['checked'][$i]]; 
```

另一种方法是将金额直接放在复选框的值中，而不是无用的`Y`值：

```
echo "<tr><td>&nbsp;<input type=\"checkbox\" name=\"checked[]\" value=\"".$row['amount']."\" /></td>"; 
```

然后你做：

```
$totamt += $_POST['checked'][$i]; 
```

第三种方法是在所有字段的名称中放置显式索引，而不是在提交表单时让 PHP 分配它们：

```
echo "<input type=\"hidden\" name=\"ID[".$i."]\" value=\"".$row['ID']."\" />";
echo "<tr><td>&nbsp;<input type=\"checkbox\" name=\"checked[".$i."]\" value=\"Y\"></td>";
echo "<input type=\"hidden\" name=\"amount[".$i."]\" value=\"".$row['amount']."\" />"; 
```

where`$i`是您在生成表单时递增的变量。这将使索引按照您的表单代码所期望的方式工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:34:08.957

看起来您的隐藏字段和实际复选框具有不同的名称尝试将它们放在相同的名称

```
<input type='hidden" name='checkbox" value="no" />
<input type="checkbox" name="checkbox" value=$row['ID'] /> 
```

这样，当您检查 $_POST 的复选框名称时，它将显示 no 或 id，您可以确定检查的内容

基本上隐藏和复选框的名称应该相同

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T00:01:30.833

已经提到的另一种选择是使用 JavaScript 进行添加并将结果存储在隐藏的输入字段中。您甚至可以使用 onclick 来运行一个 JS 函数来添加值（并且您绝对应该将其设置在复选框的值中，而不是隐藏字段中）。然后将您的总数存储到隐藏的输入字段值中。这将与复选框一起在您的 POST 中传递。如果您想仔细检查金额，您可以总结复选框的值并与隐藏字段进行比较。

# java - 动画示例中的 Java Lang 空指针异常？

> ID：15823477
> 
> 赞同：0
> 
> 时间：2013-04-04T23:27:56.467
> 
> 标签：java, compiler-errors

```
import java.awt.*;
import javax.swing.ImageIcon;
import javax.swing.JFrame;
public class Images extends JFrame {
    public static void main(String[] args) {
    DisplayMode dm = new DisplayMode(800,600,32, DisplayMode.REFRESH_RATE_UNKNOWN);
    Images I = new Images();
    I.run(dm);
}

private Screen s;
private Image bg;
private Image pic;
private boolean nLoaded;
Animation a;

    public void run(DisplayMode dm)
    {

        nLoaded = false;
         s = new Screen();
        try{

                s.Setfullscreen(dm, this);
                LoadPics();
                MovieLoop();
                try{
                Thread.sleep(50000);    
                }catch(Exception ex){}
        }finally{
            s.restoreScreen();
        }

    }

    public void MovieLoop(){
        long startingtime = System.currentTimeMillis();
        long cumTime = startingtime;

        while(cumTime-startingtime < 5000)
        {
            long timepassed = System.currentTimeMillis() - cumTime;
            cumTime += timepassed;

            a.update(timepassed);

            Graphics g = s.getFullScreenWindow().getGraphics();
            draw(g);
            g.dispose();

            try{
            Thread.sleep(20);
            }catch(Exception ex){}

        }
    }

    public void draw(Graphics g)
    {
        g.drawImage(bg, 0,0, null);
        g.drawImage(a.getImage(),0,0,null); }

    //Create Load Pictures
    public void LoadPics()
    {
        bg = new ImageIcon("C:\\Gamepics\\BackgroundImage.jpg").getImage();
        pic = new ImageIcon("C:\\Gamepics\\SmileyIcon3.png").getImage();
        nLoaded = true;
        repaint();

    }

    public void paint(Graphics g){
        if(g instanceof Graphics2D){
            Graphics2D g2 = (Graphics2D)g;
            g2.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING, RenderingHints.VALUE_TEXT_ANTIALIAS_ON);
        }

        if(nLoaded)
        {
            g.drawImage(bg, 0, 0, null);
            g.drawImage(pic, 300,300, null);
        }
    }  
} 
```

我不明白我做错了什么，我尽我所能忽略了一切。我只是在练习一个简单的动画，并且不断收到 3 个空指针异常。我已经尽我所能进行了研究，显然 Java 中的 NullPointerExceptions 与尝试获取空数组的大小有关？编译器没有将我的任何列表标记为问题，所以我有点困惑。任何帮助将不胜感激。所有的错误都被注释掉了。其中有三个，它们在图像类中

错误：

```
Exception in thread "main" java.lang.NullPointerException
at Images.MovieLoop(Images.java:45)
at Images.run(Images.java:26)
at Images.main(Images.java:8) 
```

动画课

```
import java.awt.Image;
import java.util.*;
public class Animation {

private ArrayList scenes;
private int sceneindex;
private long movietime;
private long totaltime;
//CONSTRUCTOR
public Animation(){
    scenes = new ArrayList();
    totaltime =0;
    start();

}
//Add scene to array list and sets time for each scene
//For example. If you have 3 scenes you would add t to total time three times. So if you had 
//3 Scenes, one for 1s, one for 2s, one for 3s. Total time would be 6s. and you would call addscene 3 times
public synchronized void addScene(Image i, long t)
{ 
    totaltime+=t;
    scenes.add(new OneScene(i, totaltime));

}
//start animation from beggininign inignngingingnig 
public synchronized void start(){
movietime = 0;
sceneindex = 0;
}
//change scenes 

//movie time is the sum of all the time passed from last update
//If you have more than one scene. timepassed gets added to movietime.
//if movietime is greater than or equal to total time(ie. animation is complete) restart the animation
public synchronized void update(long timepassed)
{
    if(scenes.size() > 1){
        movietime += timepassed;
        if(movietime >= totaltime)
        {
            movietime = 0;
            sceneindex = 0;

        }
        while(movietime > getScene(sceneindex).endTime)
        {
            sceneindex++;
        }
    }
}

public synchronized Image getImage(){
    if(scenes.size() == 0){
        return null;}
    else{
        return getScene(sceneindex).pic;
    }
}
//Getscene
private OneScene getScene(int x){
    return (OneScene)scenes.get(x);
}
//Scenes are gonna be 
private class OneScene{
    Image pic;
    long endTime;

    public OneScene(Image pic, long endTime)
    {
        this.pic = pic;
                this.endTime = endTime;

    }
}
} 
```

我包含了动画类，因为编译器将这三个方法调用突出显示为问题的根源

```
 a.update(timepassed); 
    MovieLoop(); 
     I.run(dm); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:41:43.867

*请注意：这是一个很长的评论*

让我们从`Graphics g = s.getFullScreenWindow().getGraphics();`-`getGraphics`绝不是一个好主意，这可以返回`null`。

你不应该尝试从除 EDT 之外的任何线程更新任何 UI 组件，也不应该以这种方式直接绘制到它，相反，你应该使用`paintComponent`.

你不应该`dispose`在任何`Graphics`不是你自己创建的上下文中，这将阻止其他组件被绘制。

您应该避免覆盖`paint`，尤其是顶级容器，如果没有其他原因，它不是双缓冲（顶级容器），并且您还将在任何其他子组件上进行绘制。

查看[执行自定义绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)以获取更多详细信息。

您应该尝试使用`ImageIO`而不是`ImageIcon`. `ImageIO`如果它无法读取文件，则会抛出异常，因为它`ImageIcon`只是默默地失败，没有多大帮助。

# java - wait( ) 函数未正常运行

> ID：15823479
> 
> 赞同：0
> 
> 时间：2013-04-04T23:28:24.980
> 
> 标签：java, android, eclipse, wait

我不熟悉使用 wait(); 特征。我以为我做对了，但它不会运行。通过查看示例，我无法弄清楚我哪里出错了。任何人都可以帮助我吗？提前致谢！

```
public class MainActivity
    extends Activity
{
    private ImageView splash;

    @Override
    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.splash);
        initialize();
    }

    private void initialize()
    {
        splash.setVisibility(View.VISIBLE);
        try
        {
            wait(5000);
        }
        catch (InterruptedException e)
        {
            e.printStackTrace();
        }
        mainMenu();

    }

    private void mainMenu()
    {
        setContentView(R.layout.mainmenu);

    } 
```

日志猫：

```
04-04 23:08:40.075: E/Trace(2555): error opening trace file: No such file or directory (2)
04-04 23:08:48.345: E/AndroidRuntime(2555): FATAL EXCEPTION: main
04-04 23:08:48.345: E/AndroidRuntime(2555): java.lang.RuntimeException: Unable to start activity ComponentInfo{edu.virginia.hotncolduva/edu.virginia.hotncolduva.MainActivity}: java.lang.NullPointerException
04-04 23:08:48.345: E/AndroidRuntime(2555):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at android.os.Looper.loop(Looper.java:137)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at android.app.ActivityThread.main(ActivityThread.java:5041)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at java.lang.reflect.Method.invokeNative(Native Method)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at java.lang.reflect.Method.invoke(Method.java:511)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at dalvik.system.NativeStart.main(Native Method)
04-04 23:08:48.345: E/AndroidRuntime(2555): Caused by: java.lang.NullPointerException
04-04 23:08:48.345: E/AndroidRuntime(2555):     at edu.virginia.hotncolduva.MainActivity.initialize(MainActivity.java:24)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at edu.virginia.hotncolduva.MainActivity.onCreate(MainActivity.java:19)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at android.app.Activity.performCreate(Activity.java:5104)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
04-04 23:08:48.345: E/AndroidRuntime(2555):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
04-04 23:08:48.345: E/AndroidRuntime(2555):     ... 11 more
04-04 23:12:09.646: E/AndroidRuntime(2639): FATAL EXCEPTION: main
04-04 23:12:09.646: E/AndroidRuntime(2639): java.lang.RuntimeException: Unable to start activity ComponentInfo{edu.virginia.hotncolduva/edu.virginia.hotncolduva.MainActivity}: java.lang.NullPointerException
04-04 23:12:09.646: E/AndroidRuntime(2639):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at android.os.Looper.loop(Looper.java:137)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at android.app.ActivityThread.main(ActivityThread.java:5041)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at java.lang.reflect.Method.invokeNative(Native Method)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at java.lang.reflect.Method.invoke(Method.java:511)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at dalvik.system.NativeStart.main(Native Method)
04-04 23:12:09.646: E/AndroidRuntime(2639): Caused by: java.lang.NullPointerException
04-04 23:12:09.646: E/AndroidRuntime(2639):     at edu.virginia.hotncolduva.MainActivity.initialize(MainActivity.java:24)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at edu.virginia.hotncolduva.MainActivity.onCreate(MainActivity.java:19)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at android.app.Activity.performCreate(Activity.java:5104)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
04-04 23:12:09.646: E/AndroidRuntime(2639):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
04-04 23:12:09.646: E/AndroidRuntime(2639):     ... 11 more
04-04 23:16:21.095: E/AndroidRuntime(2737): FATAL EXCEPTION: main
04-04 23:16:21.095: E/AndroidRuntime(2737): java.lang.RuntimeException: Unable to start activity ComponentInfo{edu.virginia.hotncolduva/edu.virginia.hotncolduva.MainActivity}: java.lang.NullPointerException
04-04 23:16:21.095: E/AndroidRuntime(2737):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at android.os.Looper.loop(Looper.java:137)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at android.app.ActivityThread.main(ActivityThread.java:5041)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at java.lang.reflect.Method.invokeNative(Native Method)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at java.lang.reflect.Method.invoke(Method.java:511)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at dalvik.system.NativeStart.main(Native Method)
04-04 23:16:21.095: E/AndroidRuntime(2737): Caused by: java.lang.NullPointerException
04-04 23:16:21.095: E/AndroidRuntime(2737):     at edu.virginia.hotncolduva.MainActivity.initialize(MainActivity.java:27)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at edu.virginia.hotncolduva.MainActivity.onCreate(MainActivity.java:20)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at android.app.Activity.performCreate(Activity.java:5104)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
04-04 23:16:21.095: E/AndroidRuntime(2737):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
04-04 23:16:21.095: E/AndroidRuntime(2737):     ... 11 more
04-04 23:20:05.727: E/AndroidRuntime(2833): FATAL EXCEPTION: main
04-04 23:20:05.727: E/AndroidRuntime(2833): java.lang.RuntimeException: Unable to start activity ComponentInfo{edu.virginia.hotncolduva/edu.virginia.hotncolduva.MainActivity}: java.lang.NullPointerException
04-04 23:20:05.727: E/AndroidRuntime(2833):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at android.os.Looper.loop(Looper.java:137)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at android.app.ActivityThread.main(ActivityThread.java:5041)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at java.lang.reflect.Method.invokeNative(Native Method)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at java.lang.reflect.Method.invoke(Method.java:511)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at dalvik.system.NativeStart.main(Native Method)
04-04 23:20:05.727: E/AndroidRuntime(2833): Caused by: java.lang.NullPointerException
04-04 23:20:05.727: E/AndroidRuntime(2833):     at edu.virginia.hotncolduva.MainActivity.initialize(MainActivity.java:27)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at edu.virginia.hotncolduva.MainActivity.onCreate(MainActivity.java:20)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at android.app.Activity.performCreate(Activity.java:5104)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
04-04 23:20:05.727: E/AndroidRuntime(2833):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
04-04 23:20:05.727: E/AndroidRuntime(2833):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:32:49.843

您应该考虑一种不同的方法，而不是在主线程中休眠。为什么不只使用基于 1s 计时器的处理程序，然后向 UI 线程发送消息以更改您的启动屏幕（alpha 或其他内容），并且一旦时间过去，发送消息以使用加载下一个内容视图淡入动画。

至于您的 NPE，请确保您的视图实际上链接到您的布局文件中的某些内容`R.layout.splash`。

查看您的代码后，您没有将启动对象分配给布局中的实际视图。像这样分配：

```
splash = (ImageView)findViewById(R.id.youridhere); 
```

# ember.js - Ember 数据交易和重新提交表格

> ID：15823481
> 
> 赞同：11
> 
> 时间：2013-04-04T23:28:35.717
> 
> 标签：ember.js

我正在使用 ember(+data) 并构建了一个简单的注册表单，但是在服务器端验证错误后，我无法让表单（和 ember-data 事务）正常工作。

我正在关注[https://github.com/dgeb/ember_data_example](https://github.com/dgeb/ember_data_example)作为如何使用事务的指南，它主要适用于 Happy Path，但在服务器端验证错误之后，我无法获得 ember-data单击提交时重新提交 API 请求。

我做了一些挖掘，我想我错过了一些与模型失效后重置交易相关的步骤或类似的东西......

## Github 和应用程序

[您可以在http://emb.herokuapp.com/](http://emb.herokuapp.com/)上试用该应用程序并重现问题

您还可以在[https://github.com/justinfaulkner/ember-data-resubmit查看完整的源代码](https://github.com/justinfaulkner/ember-data-resubmit)

## 复制品

**您可以通过使用@example.com**的电子邮件地址在我的应用程序中填写表单来触发虚假的服务器端错误。Rails API 将响应 422 和一个键入用户名/电子邮件字段的错误对象。

该字段应以红色突出显示并显示错误 - 将电子邮件地址编辑为应有效的内容，然后再次单击提交。在 chrome 中打开开发人员工具后，我看不到 ember-data 通过点击发送 http 请求（但控制器中的 console.log 表明确实收到了点击）。

## 应该发生什么

在使用错误修改字段后， ember-data （我认为）将模型的 from 更改为`invalid`to`uncommitted`以便在下次`commit`调用时提交。当我单击提交时，ember-data 应该将 HTTP 请求发送到我的 api，并且 ember 应该转换为“恭喜！” 页。

**然而，表格只是坐在那里。没有http请求。没有过渡到“恭喜！”。**

这是我在更新输入后单击提交几 (18) 次后的屏幕截图：

![提交按钮点击收到，但没有http请求](https://i.stack.imgur.com/vrzRX.png)

## 片段

以下是我的 ember 应用程序的一些片段：

### 索引路由

我的路线，`startEditing`像 ember_data_example 一样使用：

```
App.IndexRoute = Ember.Route.extend({
  model: function() {
    return null;
  },
  setupController: function(controller) {
    controller.startEditing();
  },
  deactivate: function() {
    this.controllerFor('index').stopEditing();
  }
}); 
```

### 索引控制器

我`IndexController`是仿照 ember_data_example 的`ContactsNewController`

```
App.IndexController = Ember.ObjectController.extend({
  startEditing: function() {
    this.transaction = this.get('store').transaction();
    this.set('content', this.transaction.createRecord(App.User));
  },
  submit: function(user){
    console.log("submitting!");
    this.transaction.commit();
    this.transaction = null;
  },
  _transitionOnSuccess: function(stuff) {
    if (this.get('content.id') && this.get('content.id').length > 0) {
      console.log("_transitionOnSuccess");
      this.transitionToRoute('success');
    }
  }.observes('content.id'),
  stopEditing: function() {
    if (this.transaction) {
      this.transaction.rollback();
      this.transaction = null;
    }
  }
}); 
```

### 用户

这是我的模型。我正在使用[ember-validations](https://github.com/dockyard/ember-validations)。

```
App.User = DS.Model.extend(Ember.Validations.Mixin);
App.User.reopen({
  username: DS.attr('string'),
  password: DS.attr('string'),
  profile: DS.belongsTo('App.Profile'),

  validations: {
      username: {
          presence: true
      },
      password: {
          presence: true,
          length: { minimum: 6 }
      }
  }
}); 
```

### 索引.hbs

这是我的车把模板中的表格。我正在使用[ember-easyForm](https://github.com/dockyard/ember-easyForm)。

```
{{#formFor controller}}
    <div class="row">
        <div class="large-12 columns">
            {{input username placeholder="Email address"}}
        </div>

    </div>

    <div class="row">
        <div class="large-12 columns">
            {{input password placeholder="Password"}}
        </div>
    </div>

    {{submit "Sign Up" class="button"}}
{{/formFor}} 
```

如果图书馆作者看到这篇文章，我在这个提交中对应用程序的 ember-easyForm 和 ember-validations 副本进行了一些本地修改：[https](https://github.com/justinfaulkner/dockyard-example/commit/f618b0e4fb72314d56bb3a9d95e1325925ba6ad0) ://github.com/justinfaulkner/dockyard-example/commit/f618b0e4fb72314d56bb3a9d95e1325925ba6ad0 。不过，我认为我的更改不会导致我的问题。

## 变得无效并回滚？

我确实在这里遇到了一个类似的问题：[Ember Data and dirty records](https://stackoverflow.com/questions/14667571/ember-data-and-dirty-records#15636804)但是当我添加一个`User.becameInvalid`来回滚事务时，这导致表单在尝试重新提交时为空（并且仍然没有成功让 ember-data 重新提交 http要求）。

# 谢谢！

我确定我`ember_data_example`的操作很差（或未能将其扩展到我的用例）或在某处犯了一些简单的错误......

提前致谢。

## 编辑 4 月 5 日

到目前为止，我至少可以发现两个主要问题：

1.  `this.transaction = null;`我需要这个吗？我应该怎么做？
2.  我尝试删除`this.transaction = null;`并且 ember-data 现在尝试实际提交（但仍然不会提交 ajax 请求）。现在，当我输入无效字段时，我可以看到 ember-data 尝试将记录更新回`uncommitted`/ `created`...**但它是在不同的事务中执行的**。

我将一个分支推**`no-null`**送到 repo，该分支在 ember-data 中有一些`console.log`s 打印出事务 ID 是什么......这是我的控制台的快照：

![不同的交易](https://i.stack.imgur.com/iBKUd.png)

`recordBecameDirty`当我在字段中输入时调用。Ember-data 更新记录以准备再次提交。但是，它是在其他一些事务中进行的 (458)

但是我的提交按钮与原始事务（316）相关联，并且在该事务中没有准备好提交的记录......嗯......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T22:00:40.617

这是 ember 数据的一个已知问题。见：[https ://github.com/emberjs/data/pull/539](https://github.com/emberjs/data/pull/539)

该提交 [https://github.com/Cyril-sf/data/commit/fe9c63beb02e9f16051e59a9f7c0a918152a0231](https://github.com/Cyril-sf/data/commit/fe9c63beb02e9f16051e59a9f7c0a918152a0231)中的 Ember Data 的简单更改 应该可以解决您的问题。

# iphone - 列表样式未显示在 chrome iOS 上

> ID：15823483
> 
> 赞同：1
> 
> 时间：2013-04-04T23:28:42.840
> 
> 标签：iphone, css, google-chrome

我正在构建一个需要在移动设备上查看的网站。在 iphone 4s 上的 safari 中查看时，它看起来很棒。如果我在同一设备上查看它，则导航列表的样式都不会显示。它最终看起来像基本的 html 链接。有问题的链接是弗吉尼亚州领导、护理和麻醉学人员

Bellow 是一个链接到实时开发站点以及 CSS。

链接：http: [//xeroproject.com/sqwm/category/resources/](http://xeroproject.com/sqwm/category/resources/)

CSS：

```
#leftNav{
max-width:402px;
}

#leftNav ul li a {
list-style-type: none !important;
width:100%;
text-decoration:none;
font-weight:bold;
font-size:24px;
color:#FFF;
}
#leftNav ul a:hover {
color:#85b6ce;
}
#leftNav ul li:nth-child(odd){
padding:10px;
margin-bottom:5px;
background: #0b5a42 url('images/arrow_dark.jpg') no-repeat right;

}
#leftNav ul li:nth-child(even){
padding:10px;
margin-bottom:5px;
background: #688879 url('images/arrow_light.jpg') no-repeat right;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:39:07.397

在我的 iPhone 4s 上使用适用于 iOS 的 Google Chrome 浏览器，该网站对我来说很好（至少它看起来与在同一部手机上运行的 Safari 完全一样）。

尝试清除 Chrome 的缓存。

如果这没有帮助，请将您的 iphone 连接到 Fiddler2，并查看您的站点正在发出哪些请求，并查看样式表请求是否出错。

# ruby-on-rails - 如何使 Rails 应用程序根据是否选中复选框执行操作？（罗尔）

> ID：15823488
> 
> 赞同：0
> 
> 时间：2013-04-04T23:29:16.657
> 
> 标签：ruby-on-rails, ruby, model-view-controller

我在有人用来发布的名为 post_form.html.erb 的视图中有一个复选框。下面是它的完整代码：

```
<%= form_for @post, :html => {:multipart => true} do |f| %>
  <%= render 'shared/error_messages', object: @post %>
  <div class="field">
    <%= f.text_area :content, :cols => 5, :rows => 5 %>
  </div>
  <div class="ItemContainer">
    <div class="ItemInput">Add your photo:<br>
  <%= f.file_field :image %>
</div><div class="ItemCheckbox">
<label for="a">Run script?</label>
  <div class="ItemCheckboxAlign"><input type="checkbox" id="a"></div>
</div></div><br>
<%= f.submit "Post", class: "btn btn-large btn-primary" %>
<% end %> 
```

以上用于发布，我使用 show.html.erb 作为视图。正如您在上面的代码中看到的，在发布过程中有一个复选框。我想要它，以便如果选中该复选框，则在我的 show.html.erb 视图中会发生某些操作（在这种情况下运行脚本）。如果没有选中，那么我不想运行脚本。

存储有关复选框是否已在数据库中选中的布尔信息的最佳方法是什么？我的问题是，使复选框与表值相关联的 RoR 代码是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T08:54:40.337

利用

```
$('#check_box_id').is(":checked") 
```

检查复选框是否被选中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:35:44.137

您将要为此使用 jQuery：

```
$('#a').click(function() {
  $('#text').toggle();
}); 
```

# php - 具有不同 ID 的多个动态表单的 AJAX 查询

> ID：15823495
> 
> 赞同：1
> 
> 时间：2013-04-04T23:29:55.657
> 
> 标签：php, javascript, jquery, html, ajax

这是在我的标题中，jquery.min.js 已经包含：

```
<script type="text/javascript">
//<![CDATA[
$(function() {
    $("form.ajax").submit(function(e) {
        var $this = $(this);
        e.preventDefault();

        $.ajax({
            url: 'index.php',
            type: 'post',
            data: $this.serialize(),
            success: function() {
                //alert(response);
            }
        })

        return false;
    });
});
//]]>
</script> 
```

这是一个动态生成的示例表单：

```
<form id="dash_73" method="post" class="ajax"> 
<fieldset> 
<input type="hidden" name="action" value="ajax_purchase_ticket" /> 
<input type="hidden" name="lottery_id" value="73" /> 
<div class="left1"> 
<button type="submit" name="dash" form="dash_73" id="button_73-1" value="1" class="ticket taken" disabled="disabled">User 1</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-2" value="2" class="ticket taken" disabled="disabled">User 1</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-3" value="3" class="ticket taken" disabled="disabled">User 1</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-4" value="4" class="ticket taken" disabled="disabled">User 1</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-5" value="5" class="ticket free">5 Dash</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-6" value="6" class="ticket taken" disabled="disabled">User 2</button> 
<br /> 
</div> 
<div class="left2"> 
<button type="submit" name="dash" form="dash_73" id="button_73-7" value="7" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-8" value="8" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-9" value="9" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-10" value="10" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-11" value="11" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-12" value="12" class="ticket taken" disabled="disabled">User 2</button> 
<br /> 
</div> 
<div class="left3"> 
<button type="submit" name="dash" form="dash_73" id="button_73-13" value="13" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-14" value="14" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-15" value="15" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-16" value="16" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-17" value="17" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-18" value="18" class="ticket taken" disabled="disabled">User 2</button> 
<br /> 
</div> 
<div class="left4"> 
<button type="submit" name="dash" form="dash_73" id="button_73-19" value="19" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-20" value="20" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-21" value="21" class="ticket taken" disabled="disabled">User 1</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-22" value="22" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-23" value="23" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-24" value="24" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
</div> 
<div class="left5"> 
<button type="submit" name="dash" form="dash_73" id="button_73-25" value="25" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-26" value="26" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-27" value="27" class="ticket yours" disabled="disabled">User 3</button> 
<br /> 
<button type="submit" name="dash" form="dash_73" id="button_73-28" value="28" class="ticket yours" disabled="disabled">User 3</button> 
<br />
</div>
</fieldset>
</form> 
```

目前，当我单击按钮购买机票时，没有任何反应。我试图拥有它，所以当按下按钮时，它将运行代码。我仍在尝试制定有关如何检索成功或失败的响应方法。任何帮助表示赞赏。

**更新：**没有 Ajax，代码按要求运行。正如 Kevin 所指出的，我相信问题在于按钮值没有被提交，这就是为什么看起来什么都没有发生，因为按钮值是必需的。寻找如何包含按钮值。

**更新2：**这是对我有用的成功/失败消息的最终代码。

```
<script type="text/javascript">
//<![CDATA[
$(function() {
    $('button[name="dash"]').click(function (e) {
        e.preventDefault();
        var id = this.id;
        var $formElem = $(this).closest('form');
        var formData = $formElem.serializeArray();
        formData.push({
            name: this.name,
            value: this.value
        });
        // if you want to submit the 'form' attribute of the button as well ...
        formData.push({
            name: 'form',
            value: $(this).attr('form')
        });
        $.ajax({
            url: 'index.php',
            type: 'post',
            data: formData, 
            success: function (data) {
                if ( data.completed == 1 )
                {
                    data.message = data.message + '<br />' + data.completed_message;
                }

                $("#centerpoint").hide();
                $("#centerpoint").show();

                if ( data.result == 1 )
                {
                    $('#' + id).attr("disabled", "disabled");
                    $('#' + id).removeClass("free").addClass("yours");
                    $('#' + id).text(data.buyer);
                    $('#ajax_message').replaceWith('<div class="form_message success" id="ajax_message">' + data.message + '</div>');
                    $("#centerpoint").delay(5000).slideUp();
                }
                else if ( data.result == 2 )
                {
                    $('#' + id).attr("disabled", "disabled");
                    $('#' + id).removeClass("free").addClass("taken");
                    $('#' + id).text(data.buyer);
                    $('#ajax_message').replaceWith('<div class="form_message error" id="ajax_message">' + data.message + '</div>');
                    $("#centerpoint").delay(5000).slideUp();
                }
                else if ( data.result == 3 )
                {
                    $('#ajax_message').replaceWith('<div class="form_message error" id="ajax_message">' + data.message + '</div>');
                    $("#centerpoint").delay(5000).slideUp();
                }
                else
                {
                    $('#ajax_message').replaceWith('<div class="form_message error" id="ajax_message">Unknown Error!</div>');
                    $("#centerpoint").delay(5000).slideUp();
                }
            }
        })
        /* should pass this form data: 
           action=ajax_purchase_ticket&lottery_id=73&dash=5&form=dash_73
        */
        return false;
    });
});
//]]>
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:39:43.883

看起来您的表单正在发布“action=ajax_purchase_ticket&lottery_id=73”

您确定服务器端脚本仅使用这么多数据就可以正常运行吗？它可以期待按钮值之一吗？

从序列化文档（[http://api.jquery.com/serialize/](http://api.jquery.com/serialize/)）：

> 由于未使用按钮提交表单，因此没有序列化提交按钮值。

这是您可以尝试包含单击的按钮值的解决方案： [jQuery serializeArray 不包含单击的提交按钮](https://stackoverflow.com/questions/4007942/jquery-serializearray-doesnt-include-the-submit-button-that-was-clicked)

**更新**

看看这是否符合您的要求：http: [//jsfiddle.net/kevincollins/VLHCe/](http://jsfiddle.net/kevincollins/VLHCe/)

```
$('button[name="dash"]').click(function (e) {
    e.preventDefault();
    var $formElem = $(this).closest('form');
    var formData = $formElem.serializeArray();
    formData.push({
        name: this.name,
        value: this.value
    });
    // if you want to submit the 'form' attribute of the button as well ...
    formData.push({
        name: 'form',
        value: $(this).attr('form')
    });
    $.ajax({
        url: 'index.php',
        type: 'post',
        data: formData, 
        success: function () {
            //alert(response);
        }
    })
    /* should pass this form data: 
       action=ajax_purchase_ticket&lottery_id=73&dash=5&form=dash_73
    */
}); 
```

# android - 在异步任务期间从外部类发布进度？

> ID：15823496
> 
> 赞同：1
> 
> 时间：2013-04-04T23:29:58.423
> 
> 标签：android, android-asynctask

我有一个异步任务，`doInBackground()`方法如下：

```
 protected String doInBackground(String... params) {
          MyClass session = new MyClass("email", "password");
          return session.isAuthorized();
       } 
```

While `MyClass`，它在一个完全不同的包中，是这样的：

```
 private class MyClass {
                  // fields, constructors, etc
                  public Boolean isAuthorized() {
                             // some stuff
                             log("Action 1...");
                             // some stuff
                             log("Action 2...");
                             // some other stuff
                             return result;
                  }

                  public static void log(String str) {
                             // HERE I would like to publish progress in the Async Task
                             // but, until now, it's kinda like:
                             System.out.println(str);
                  }
       } 
```

问题是：如何将`log()`方法中保存的日志描述传递给`publishProgress()`方法？我已经阅读了这个帖子：[Difficulty in changed the message of progress dialog in async task](https://stackoverflow.com/questions/9063112/difficulty-in-changing-the-message-of-progress-dialog-in-async-task) - 但它不是有效的帮助来源，因为我的方法不包含在主类`public class MainActivity extends Activity {}`中。

编辑＃1 -

经过一番工作，我意识到唯一的方法是向外部类传递对“主”线程的引用，然后在那里实现一个特定的方法来发布进度。以这种方式：

```
 public void log(String str) {
                  if (mThreadReference==null) {
                             System.out.println(str);
                  } else {
                             mThreadReference.doProgress();
                  }
       } 
```

虽然`mThreadReference`指出这一点`AsyncTask`：

```
 private class MyClassTask extends AsyncTask<String,String,String>  {
        @Override
        protected String doInBackground(String... params) {
            // constructs MyClass instance with a reference and run main method
            (new MyClass("email", "password", this)).isAuthorized();
        }

        public void doProgress(String str) {
            publishProgress(str);
        }

        @Override
        protected void onProgressUpdate(String... values) {
            // some stuff
        }
        @Override
        protected void onPostExecute(String result) {
        }
    } 
```

但是，显然，Eclipse 是在警告我：`The method publishProgress() is undefined for the type Activity`. 如何在外部类中编写一个**通用**的**绝对**方法，我可以在多个特定的 AsyncThread 中使用它？

```
 --> LOGs IN THE LOGIN THREAD 1
                          /
           EXTERNAL CLASS ---> LOGs IN THE LOGIN THREAD 2
                          \
                           --> LOGs IN THE LOGIN THREAD 3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T14:22:01.257

我发现唯一的方法是在主要活动中导入 AsyncTask 的 istance，它必须是公共的（不是默认选项！）。有了这个技巧，即使它受到保护，我也可以调用 publishProgress 方法。

```
 // MyClass, in a different package

    import MainActivity.MyClassTask mThreadReference = null;

    // some stuff...

    public void log(String str) {
            if (mThreadReference==null) {
                    System.out.println(str);
            } else {
                    mThreadReference.doProgress("");
            }
    } 
```

虽然这是活动：

```
public class LoginLanding extends Activity {

    // stuff...

    public class MyClassTask extends AsyncTask<String,String,String>  {
            // bla bla bla, some stuff...

            public void doProgress(String str) {
                    // do something
            }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-24T04:39:27.897

今天我遇到了类似的问题。以前的答案帮助解决了 50% 的问题。这是空指针异常，因为 mThreadReference 为空。

现在您需要一个封闭类的实例来实例化内部类，即 AsyncTask 类。由于我在片段中定义了这样的类，所以我所做的如下：

```
 MyFragment fm = new MyFragment();
    MyFragment.AsyncTaskClassName aTCN = fm.new AsyncTaskClassName(); 
```

之后，您可以按照 Gianlunca 建议的方式调用 doProgress 方法。

我的 2 美分！！

# php - MySQL 删除多列

> ID：15823498
> 
> 赞同：49
> 
> 时间：2013-04-04T23:30:07.320
> 
> 标签：php, mysql

我正在尝试删除多个列，但遇到了一些麻烦。当我这样做`ALTER TABLE`并且`ADD`括号中有多个值时，下面的语法有效，`()`但它不适用于`DROP COLUMN`. 我使用了错误的语法吗？

```
 $table3 = "
        ALTER TABLE $table3_name
        DROP COLUMN (
            user_firstname,
            user_lastname,
            user_address,
            user_address2,
            user_city,
            user_state,
            user_zip,
            user_phone
        );
    "; 
```

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2013-04-04T23:33:25.617

```
ALTER TABLE `tablename`
DROP `column1`,
DROP `column2`,
DROP `column3`; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-11T18:25:14.850

删除多列的实际语法是

```
alter table tablename drop column col1, drop column col2 , drop column col3 .... 
```

因此，对于每一列，您需要在 Mysql 5.0.45 中指定“删除列”。这与上面的答案相同。这里只加一点。Alter table 不会释放磁盘上的实际空间。所以在运行优化表后运行优化表。

# c - scanf 不等待输入

> ID：15823502
> 
> 赞同：4
> 
> 时间：2013-04-04T23:30:24.050
> 
> 标签：c

我试图在这里找到错误，但仍然没有得到它。我一直在调试和搜索它并找到了一些接近的主题，但只有我不需要 ATM 的解决方案，我很好奇为什么这段代码不起作用：

```
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

#define BUFFER 256

int main()
{   
    int missionCode;
    char *desc = (char*)malloc(sizeof(char)*BUFFER);

    do {
        printf("Please enter the mission code (or -1 for exit): ");
        scanf("%d", &missionCode);
        fflush(NULL);
        if (missionCode==-1)
            return 1;
    } while (missionCode>10);

    do {
        printf("Please enter a string:\n");
        scanf("%[^\n]s", desc); //it doesn't stop here!
        fflush(NULL);
        if (!strcmp("exit",desc))
            return 1;
    } while (strlen(desc)<20);

    printf("your string:\n%s", desc);
    return 0;
} 
```

第二个循环中的 scanf\flushall 有问题，但我不知道是什么问题。顺便说一句，这当然是 C。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T23:35:46.890

```
scanf("%d", &missionCode); 
```

将换行符留在缓冲区中，所以

```
scanf("%[^\n]s", desc); 
```

立即找到一个并停止。你可以加个空格

```
scanf(" %[^\n]s", desc); 
```

以跳过初始空格的格式。

# javascript - Why doesn't linking Javascript files from header work but only at the end of the html works?

> ID：15823503
> 
> 赞同：3
> 
> 时间：2013-04-04T23:30:25.397
> 
> 标签：javascript, html

I'm playing around with Kinetic.js and I noticed that only linking my javascript at the end of the `body` would work. Normally wouldn't adding javascript in the `head` would work?

Here is my HTML

```
<!DOCTYPE html>
<html>
    <head>
        <title>Tictactoe</title>
        <META http-equiv="Content-Script-Type" content="type">
    </head>

    <body>
        <div id="container"></div>
        <script type="text/javascript" src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.4.0.min.js"></script>
        <script type="text/javascript" src="javascript.js"></script>
    </body>
</html> 
```

And here is my javascript file:

```
var stage = new Kinetic.Stage({
    container: 'container',
    width: 500,
    height: 500
});

var layer = new Kinetic.Layer();

var rect = new Kinetic.Rect({
    x: 239,
    y: 75,
    width: 150,
    height: 50,
    fill: 'green',
    stroke: 'black',
    strokeWidth: 4
});

// add the shape to the layer
layer.add(rect);

stage.add(layer); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:34:13.860

The DOM isn't ready when your code is run if you reference it in the head of the page. When Kinetic tries to access your container div it isn't available. If you check the console you'll probably see an error.

Including your script in the bottom of the page guarantees that the DOM is available when the code runs. See this [stackoverflow thread](https://stackoverflow.com/questions/1438883/jquery-why-use-document-ready-if-external-js-at-bottom-of-page) for a full explanation.

It's perfectly acceptable to use the approach you're using. See the [HTML5 Boilerplate](http://html5boilerplate.com/) which uses the same technique. Or if you're set on including your script in the head, you could use jQuery's [document ready event](http://api.jquery.com/ready/) which won't fire until the DOM is rendered.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T23:35:13.053

It is because it has to load the HTML Element before it runs. Try using the "onload()" function to fix this.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T23:35:17.393

在不了解这个`kinetic`库的情况下，我的猜测是它不会等待页面加载来采取任何行动。因此，如果您在页面顶部包含 JS 文件，那么您`container`还没有在 DOM 中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-04T23:35:22.133

可能脚本正在尝试使用 DOMELement。因此，如果您的脚本位于 HEAD 中，则尚未加载 BODY 标签。如果您将脚本放在 BODY 的末尾，则 BODY 内容已经加载..

因此，如果您真的想在 HEAD 上加载，您应该将脚本附加到 body.onloaded 事件上。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-04T23:38:38.393

尝试这个：

```
window.onload=function(){
var stage = new Kinetic.Stage({
container: 'container',
width: 500,
height: 500
});
var layer = new Kinetic.Layer();

var rect = new Kinetic.Rect({
x: 239,
y: 75,
width: 150,
height: 50,
fill: 'green',
stroke: 'black',
strokeWidth: 4  
});

// add the shape to the layer
layer.add(rect);

stage.add(layer);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-04T23:38:44.287

您很可能遇到了一个问题，即 DOM 尚未准备好，但您的脚本已经在尝试与元素交互。

这就是为什么当脚本被添加到 body 标记的底部时，它会在添加元素后加载它。

而不是将脚本标签添加到正文标签，您应该将代码包装在 的[**onload**](https://developer.mozilla.org/en-US/docs/DOM/window.onload)事件中，`window`以确保它仅在 DOM 准备好后执行。

与此类似：

```
window.onload = function(){
    // ... your code here
} 
```

上面将设置一个在窗口的加载事件触发时调用的函数。
如果您需要在不同的 JavaScript 文件中将多个函数添加到事件中，您也可以类似下面的方式编写它：

```
window.addEventListener('onload', function(){
    // ... your code here
}) 
```

> load 事件在文档加载过程结束时触发。至此，文档中的所有对象都在 DOM 中，所有图片和子帧都加载完毕。

# matlab - 从灰度图像中去除异常值

> ID：15823507
> 
> 赞同：5
> 
> 时间：2013-04-04T23:30:53.303
> 
> 标签：matlab, image-processing, kinect, grayscale

# 问题

我有一个图像序列，表示我想清理的深度信息。有一些异常值（强度低于 25 的值，在 0-255 范围内），我想用可接受的替代值填充它们（定位于该特定区域的平均值可能是一个很好的猜测）。

有人能看到一个简单的方法吗？我尝试使用中值过滤器（过滤器大小为 10）用 NaN 替换不想要的值，但它确实使情况恶化，而是通过用一般平均值替换它们来改善情况。

![基础试用](https://i.stack.imgur.com/xwJ6B.png)

PS有人已经建议我使用*快速小波重建*，但我真的不知道从哪里开始......

# 已实施的解决方案（到目前为止）

我实施的解决方案（在阅读[**tmpearce**](https://stackoverflow.com/users/1214731/tmpearce)`inpaint_nans`建议之前）是：[](https://stackoverflow.com/users/1214731/tmpearce)

 **1.  复制原始图像；
2.  用一般平均值填充无效像素；
3.  使用光线 10 的圆盘来模糊它；
4.  用我从第 3 点得到的值替换原始图像中的无效值。
5.  运行大小为 10 的中值滤波器。

```
img2 = img;                                       
img2(img < .005) = mean(img(:));                  
H = fspecial('disk',10);                          
img3 = imfilter(img2,H,'symmetric');              
img4 = img;                                       
img4(img < .3) = img3(img < .3);                  
filterSize = 10;                                  
padopt = {'zeros','indexed','symmetric'};         
IMG = medfilt2(img4, [1 1]*filterSize, padopt{p}); 
```

![二审](https://i.stack.imgur.com/Zb1tm.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T23:56:52.557

我推荐[inpaint_nans](http://www.mathworks.com/matlabcentral/fileexchange/4551)的贡献，`MATLAB File Exchange`就像你已经完成的那样，将异常值替换为`NaN`并使用链接从那里开始。

从函数的描述：

> 使用非 NaN 元素在二维数组中插入 NaN 元素。也可以推断，因为它不使用数据的三角剖分。Inpaint_nans 提供了几种不同的插值方法，在精度与速度和所需内存之间进行权衡。目前在 inpaint_nans 中发现的所有方法都基于稀疏线性代数和 PDE 离散化。本质上，求解 PDE 以与提供的信息一致。

可重用代码万岁！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-05T00:35:27.787

使用一个名为`roifill`. 你需要稍微弄乱它。我不得不使用`imdilate`，因为它从边界内插。

代码：

```
testimage = imread('BAPz5.png');
testimage = double(rgb2gray(testimage));
testimage_filt = roifill(testimage,imdilate(testimage<100,true(4)));
figure(1);
subplot(1,2,1);
imshow(testimage,[]);
subplot(1,2,2);
imshow(testimage_filt,[]); 
```

输出：

![在此处输入图像描述](https://i.stack.imgur.com/TEqLO.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-25T13:25:36.770

该帖子已回答但仅作记录，在[1]中，作者基于自然形状的基本原理，即对象遵循二阶平滑度，他提出了一种最小化曲率的in-painting方法-方感。他还提供[代码](http://www.cs.berkeley.edu/~barron/)。祝你好运。

[1] 类别级 3-D 对象数据库：使 kineckto 工作 (ICCV)

![在此处输入图像描述](https://i.stack.imgur.com/blLWs.png)**

# django - Django multi-lingual site : how to?

> ID：15823508
> 
> 赞同：3
> 
> 时间：2013-04-04T23:30:55.870
> 
> 标签：django, multilingual

I want to have my website in three languages and allow user to change preffered language somewhere in my template. My models will need translating. I found a few libraries perhaps I should use :

[https://code.google.com/p/django-multilingual/](https://code.google.com/p/django-multilingual/) for traslating my models

[https://pypi.python.org/pypi/django-localeurl/1.4](https://pypi.python.org/pypi/django-localeurl/1.4) for language prefix in URL's

[https://docs.djangoproject.com/en/dev/topics/i18n/](https://docs.djangoproject.com/en/dev/topics/i18n/) for translating static parts of my site

However I can't understand how these come together. Perhaps someone could give me a rundown of steps to translate my website.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-05T07:13:59.417

如果您使用 Django 1.4，则可以使用[i18n_patterns](https://docs.djangoproject.com/en/1.5/topics/i18n/translation/#django.conf.urls.i18n.i18n_patterns)而不是 django-localeurl。或更晚。

i18n_patterns 将根据 URL 前缀设置活动语言。

Django I18n 将在基于活动语言的 python 代码和模板中提供翻译的消息。（您必须创建和编译翻译）`makemessages`。`compilemessages`

对于模型中的翻译，有很多库，其中大多数使用主动语言来服务于现场翻译。我更喜欢[django-modeltranslation](https://github.com/deschler/django-modeltranslation)，它允许在不更改代码的情况下翻译 3rd 方应用程序模型。

希望这可以帮助！

# asp.net-mvc - Google OpenID 提供程序在 Azure 上始终失败

> ID：15823509
> 
> 赞同：7
> 
> 时间：2013-04-04T23:31:14.740
> 
> 标签：asp.net-mvc, azure, dotnetopenauth, google-openid

我正在尝试将 Google OpenID 与托管在 Azure 上的 MVC 4 应用程序一起使用，但它一直失败。不过不是马上。当我部署应用程序时，它一次又一次地完美运行。然后我将它放置一段时间，通常是一天，但可能是一个小时，然后再试一次，每次都失败。然后您刷新，返回主页，它会将您发送到登录页面并再次运行。

错误是：

```
[InvalidOperationException: Sequence contains no elements]
   System.Linq.Enumerable.First(IEnumerable`1 source) +498
   DotNetOpenAuth.OpenId.RelyingParty.OpenIdRelyingParty.CreateRequest(Identifier userSuppliedIdentifier, Realm realm, Uri returnToUrl) +106

[ProtocolException: No OpenID endpoint found.]
   DotNetOpenAuth.OpenId.RelyingParty.OpenIdRelyingParty.CreateRequest(Identifier userSuppliedIdentifier, Realm realm, Uri returnToUrl) +303
   Tools.Helpers.GoogleApps.Login(Uri returnUrl) in c:\Users\Simon\Documents\Visual Studio 2012\Projects\Internal Utils\Website\Helpers\GoogleApps.cs:33
   Tools.Helpers.ExternalLoginResult.ExecuteResult(ControllerContext context) in c:\Users\Simon\Documents\Visual Studio 2012\Projects\Internal Utils\Website\Helpers\ExternalLoginResult.cs:25
   System.Web.Mvc.<>c__DisplayClass1a.<InvokeActionResultWithFilters>b__17() +33
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultFilter(IResultFilter filter, ResultExecutingContext preContext, Func`1 continuation) +613
   System.Web.Mvc.ControllerActionInvoker.InvokeActionResultWithFilters(ControllerContext controllerContext, IList`1 filters, ActionResult actionResult) +263
   System.Web.Mvc.Async.<>c__DisplayClass25.<BeginInvokeAction>b__22(IAsyncResult asyncResult) +230
   System.Web.Mvc.<>c__DisplayClass1d.<BeginExecuteCore>b__18(IAsyncResult asyncResult) +28
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +20
   System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +53
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +20
   System.Web.Mvc.<>c__DisplayClass8.<BeginProcessRequest>b__3(IAsyncResult asyncResult) +42
   System.Web.Mvc.Async.<>c__DisplayClass4.<MakeVoidDelegate>b__3(IAsyncResult ar) +20
   System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +469
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +375 
```

我触发请求的代码是：

```
 //constructor
    static GoogleApps()
    {
        var googleAppDiscovery = new HostMetaDiscoveryService
        {
            UseGoogleHostedHostMeta = true,
        };

        RelyingParty = new OpenIdRelyingParty();
        RelyingParty.DiscoveryServices.Insert(0, googleAppDiscovery);
    }

    public void Login(Uri returnUrl)
    {
        var realm = new Realm(returnUrl.GetComponents(UriComponents.SchemeAndServer, UriFormat.Unescaped));

        var request = RelyingParty.CreateRequest("my.domain.name", realm, returnUrl);

        var fetch = new FetchRequest();
        fetch.Attributes.Add(new AttributeRequest(WellKnownAttributes.Contact.Email, true));
        fetch.Attributes.Add(new AttributeRequest(WellKnownAttributes.Name.First, true));
        fetch.Attributes.Add(new AttributeRequest(WellKnownAttributes.Name.Last, true));
        request.AddExtension(fetch);

        request.RedirectToProvider();
    } 
```

除了在其他地方推荐的代理配置设置之外，我没有在 web.config 中添加任何额外内容。似乎没有任何区别。

```
<defaultProxy enabled="true">
  <proxy autoDetect="True" usesystemdefault="True" />
</defaultProxy> 
```

我正在使用来自 nuget 的最新 4.2.2 包。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-17T15:54:22.730

所以看起来通过增加超时使其工作，如建议的[here](https://stackoverflow.com/questions/10062322/google-openid-no-openid-endpoint-found-intermittent?lq=1)。我按照建议将我的值设置得更高，但显然您可以测试最合适的值。

我也改变了我的代码。您会注意到上面的类包含回复方的静态变量。我将其更改为实例变量，因为我认为没有理由使用此模式。DotNetOpenAuth 的示例代码也不使用Replying Party 类的静态实例。

除非有人能提出为什么将它作为一个静态可能是一个好主意，否则我会保持原样。

# asp.net-mvc - Azure # many sites - one login ( Single Sign On )

> ID：15823511
> 
> 赞同：0
> 
> 时间：2013-04-04T23:31:27.750
> 
> 标签：asp.net-mvc, azure

Plan :

Many asp net 4.5 sites hosted on azure (will be mapped to different domains) -->

How to share login between the sites?

Option 1 :

Use 1 database for all sites - how each site login and which site is the "master site" which hold

the database?

Option 2 :

Use database for each site with extra 1 global database for users(+forums posts)

Option 3 : ( combine 1+2 ?! )

2 database , 1 for users users(+forums posts) + 1 for data

Either option , I don't know how to do it ...

I'm using [CodeFirst Membership Provider](http://codefirstmembership.codeplex.com/)

*   If I login to SiteA is like login for SiteB and etc ( you got the point )

*   Is it "same domain" if all sites sits on Azure?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T04:06:47.350

您需要使用[Azure 访问控制服务 (ACS)](http://msdn.microsoft.com/library/windowsazure/hh147631.aspx)，它是 Windows Azure Active Directory 的一部分。

创建一个 ACS 命名空间并通过门户将所有应用程序 url 作为依赖方添加到此命名空间中。之后，您需要通过提供 ACS 服务命名空间的 url，为您的每个应用程序添加来自 Visual Studio（安装 Windows Identity Foundation 时出现）的 STS 引用。

您必须添加您需要对其进行身份验证的自定义身份提供程序。例如，在您的场景中，您可以拥有一个数据库并创建一个使用表单身份验证进行身份验证的自定义 STS，并且您必须使用此服务的 url 作为 ACS 命名空间中的身份提供程序。如果需要，您还可以选择添加默认身份提供商，例如 Windows Live、Google、Yahoo 和 Facebook。

有关一些详细步骤，请参阅此[链接](http://www.windowsazure.com/en-us/develop/net/how-to-guides/access-control)

[MSDN 代码库](http://code.msdn.microsoft.com/windowsazure/Windows-Azure-AD-Access-0dcde385)中也提供了一些示例代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:17:42.990

> 为每个站点使用数据库，为用户额外提供 1 个全局数据库

这个选项对我来说听起来不错。

您可以使用 CAS（中央身份验证服务），这样您将拥有一个中心点来验证用户身份。CAS 将被配置为在全局数据库中进行身份验证。

**必须配置每个 ASP 应用程序以使用 CAS 进行身份验证。

基本的身份验证流程是：

1.  用户尝试访问特定的 ASP 站点。
2.  ASP 站点识别出用户未通过身份验证并将用户重定向到 CAS（在其他网站中运行）。
3.  用户键入您的登录名和密码。
4.  如果登录名和密码正确，CAS 会检查全局数据库。
5.  如果是，CAS 将用户重定向到特定的 ASP 站点（步骤 1）。

您需要安装 Java 和 Tomcat（或其他 Java 应用程序服务器）才能运行 CAS。因此，我不知道 CAS 是否适合您。

[http://www.jasig.org/cas](http://www.jasig.org/cas)

我正在对 Active Directory 实例使用 CAS 身份验证。

对不起我的英语。

# c# - 当首先使用带有数据注释的 MVC 代码时，如何在显示名称中包含 html 标记？

> ID：15823512
> 
> 赞同：2
> 
> 时间：2013-04-04T23:31:30.773
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, code-first, razor-2

我正在将纸质表单转换为 MVC 4 Web 表单。我的问题是一段包含链接到脚注的上标数字的文本。这就是我想要做的：

```
public class PaperFormModel
{
    [Display(Name = "Full paragraph of question text copied straight 
         off of the paper form<a href="#footnote1"><sup>footnote 1</sup></a> 
         and it needs to include the properly formatted superscript 
         and/or a link to the footnote text.")]
    public string Question1 { get; set; }

    // more properties go here ...
} 
```

创建模型后，我生成了控制器和相关视图。除了显示名称中的 html 标记转换为 html 编码文本（即 <sup>1</sup>）外，一切正常。view.cshtml 中用于显示属性的代码就是自动生成的代码：

```
<div class="editor-label">
    @Html.LabelFor(model => model.Question1)
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.Question1)
    @Html.ValidationMessageFor(model => model.Question1)
</div> 
```

我试图弄清楚如何让脚注的 html 标记正常工作，或者我的方法在某种程度上是错误的，我应该以不同的方式来做？这是我的第一个 MVC 项目，我来自 asp.net 背景。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:06:04.083

我认为您应该尝试将您的 HTML 文本移动到资源并为您的模型申请下一个代码：

```
public class PaperFormModel
{    
    [Display(ResourceType = typeof(PaperFormModelResources), Name = "Question1FieldName")]
    public string Question1 { get; set; }

    // more properties go here ...
} 
```

**创建资源文件：**
-`Resources`如果您的解决方案不存在，请在该文件夹中创建该文件夹。
-`Right click on this folder in solution explorer -> Add -> Resource file`或`... -> Add -> New item`并选择`resource file`
- 命名此文件-使用资源管理器添加具有名称和值`PaperFormModelResources`
的新条目。`Question1FieldName``Full paragraph of question text copied straight off of the paper form<a href="#footnote1"><sup>footnote 1</sup></a> and it needs to include the properly formatted superscript and/or a link to the footnote text.`

**编辑：** 如果结果是您的 html 标记未正确显示（它仅显示为纯文本），您可以使用以下[问题](https://stackoverflow.com/questions/14999130/how-can-i-render-html-in-validation-message-in-asp-net-mvc)的答案：

```
<div class="editor-label">
    @Html.Raw(HttpUtility.HtmlDecode(Html.LabelFor(model => model.Question1).ToHtmlString))
</div>
<div class="editor-field">
    @Html.EditorFor(model => model.Question1)
    @Html.ValidationMessageFor(model => model.Question1)
</div> 
```

希望它有所帮助。

# javascript - Stop page from scrolling when div is scrolled to the bottom

> ID：15823515
> 
> 赞同：0
> 
> 时间：2013-04-04T23:31:39.340
> 
> 标签：javascript, jquery, html, css, web

Basically, I have a scrolling div. I want the div to scroll obviously, but once scrolled all the way to the bottom, if the user continues to scroll, I don't want the page itself to scroll. Basically, when the mouse is in the div, I want the scrolling to be only within the div, and then when the mouse is outside of the div i want the page to scroll. Is there any way of doing this? I'm using jquery for other aspects of the site as well so I have that if it helps.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:37:48.857

好吧，我唯一能看到发生的事情是，当您移入 div 时，焦点未设置为 div，而当您移出时，焦点未设置。

示例 JavaScript：

```
<div onMouseOver="JavaScript:this.focus();" onMouseOut="JavaScript:this.blur();"> 
```

此外，请确保您的 Div 的 CSS 类具有以下特定顺序：

```
overflow: auto;
overflow-y: scroll; 
```

# autohotkey - Autohotkey: modify text file without ever opening

> ID：15823516
> 
> 赞同：0
> 
> 时间：2013-04-04T23:31:40.563
> 
> 标签：autohotkey

I'll start off by saying that I've sat around trying to figure out this for a good 8hrs and now I'm coming here to ask for help.

I want to be able to have a text file that starts at 0 and will increase by 1 every time I press the hotkey. I want this to happen without having the file open. This will be used as a counter.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T04:59:40.440

Ken 提出了关于知道初始值的观点。如果你想在底部添加一个数字，你可以使用：

```
fileappend, %Counter%`n, C:\Temp\Counter.txt 
```

或者，如果您只想拥有一个号码：

```
filedelete, C:\Temp\Counter.txt
fileappend, %Counter%, C:\Temp\Counter.txt 
```

如果要存储变量，可以使用 .ini 文件存储各种变量。

```
IniWrite, %TextCounter%, %A_ScriptDir%\Counter.ini, Counter, Nr
IniRead, TextCounter, %A_ScriptDir%\Counter.ini, Counter, Nr 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-18T19:02:28.897

我看到这是一个老问题，但从未得到正确回答。如果您想在文件中存储单个数字，然后使用热键增加该数字，这里是该过程的简化版本：

1.  FileRead 将文件中的当前数字存储到变量中
2.  FileDelete 删除旧文件（如果不是每次都删除文件，第 4 步会将文件变成数字列表。
3.  变量加 1。
4.  FileAppend 将更新的变量存储回文件中。

# algorithm - Sorting Geographical non-contiguous line segments along an implied curve

> ID：15823517
> 
> 赞同：3
> 
> 时间：2013-04-04T23:31:41.823
> 
> 标签：algorithm, language-agnostic, geometry, line, graph-theory

**Given:**

A Set (for the sake of discussion we will call it `S`), which is an ***unordered*** *collection of line segments*. Each line segment is defined as two Longitude-Latitude end-points. While all of the line segments follow an implied curve, there are "gaps" between each of the segments, of various sizes. We refer to this curve as *"implied"* because it is not explicitly defined anywhere. The only information that we have available are the line segments contained within `S`.

**Desired Result:**

A sequence (for the sake of discussion we will call it `R`), which is an ***ordered*** *collection of line segments*. Each line segment is defined just as before, following the same implied curve as before but are now **sorted by their position along the implied curve**.

**Context (i.e. "Why in the heck do I need this?"):**

Basically I have incomplete geographical data that needs to be *normalized* and "completed" by doing some very simple interpolation to form a complete curve with *no* gaps. You might ask "why not just fit a curve to all the line segment end-points and be done with it?" -- well, that's not quite what I am after. The line segments are precisely where they should be located, and there is no need for the final curve to be "smooth". In fact, I intend to connect each of the segments with a straight-line (the crudest form of interpolation imaginable). But, connecting the segments is easy; the hard part is sorting them.

**So In Summary: What would be a performant algorithm for going from `S` to `R`?**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T12:33:52.850

您可以使用[kd 树](http://en.wikipedia.org/wiki/K-d_tree)或[覆盖树](http://en.wikipedia.org/wiki/Cover_tree)快速找到附近的点。

如果您需要一条连续的曲线，我建议包含给定边缘的短[旅行推销员](http://en.wikipedia.org/wiki/Travelling_salesman_problem)路径将是合理的重建。您可以按照[Bentley 描述的方式将](http://joc.journal.informs.org/content/4/4/387.abstract)[2-opt](http://en.wikipedia.org/wiki/2-opt)与 kd 树一起使用（付费墙，抱歉；我认为[本章中还有 Johnson 和 McGeoch 对 TSP 本地搜索](http://www2.research.att.com/~dsj/papers/TSPchapter.pdf)的描述）。需要进行的一项修改是确保初始路径包括给定的边缘，并且 2-opt 移动不会删除这些边缘。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T12:35:39.273

我猜隐含曲线有两个属性。一是它是连续的，这意味着没有分段。其次，它的一阶导数是连续的，这意味着没有角。

从第二个性质我们可以说，如果两条线之间的夹角越接近，它们就越相关。但我想这还不够。您可以定义一个成本函数，它取决于线之间的角度和线的距离。

**C = A*angle + B*distance**（其中 A、B 应进行测试和调整）

通过此函数，您可以找到每条线与另一条线的相关程度。比你可以简单地连接具有最强关系的线。虽然我猜贪心算法并不意味着你总能得到最优解。

# uml - UML 中的纯虚方法是什么？

> ID：15823519
> 
> 赞同：1
> 
> 时间：2013-04-04T23:32:16.253
> 
> 标签：uml

我试图了解我应该如何在 UML 中使用接口的实现和抽象类的实现。我在[https://stackoverflow.com/a/13438187/700543](https://stackoverflow.com/a/13438187/700543)上看到了帖子，发帖者指出纯虚拟方法是接口，而部分纯虚拟方法是抽象类。有没有人能给我一个真实世界的场景，而不是一个基于代码的场景？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:47:06.053

接口只是库用户扩展的“类骨架”，正如您所说，方法无法实现。抽象类可以具有实现的方法。我会给你一个现实生活中的例子：

想象一下，我为人们提供了一个接口来实现排序功能，我还提供了一个用于基准排序功能的类。我的基准测试类只需要知道它需要调用接口的哪些方法来执行基准测试，它不知道它们是如何实现的。因此，在基准标记类中，您可能只会看到类似`sortInterfaceInstace.getNumberOfSwap()`, 而在编译时`sortInterfaceInstance`只知道是`sortInterface`类型，而不是任何特定的用户排序实现。

如果您需要实现的方法，请使用抽象而不是接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:26:43.250

接口只描述了如何使用某些东西，它不提供如何完成的底层实现，即只有纯虚函数的类。界面的英语类比可能是形容词。

接口的一个示例是 Movable 接口。这个接口可以提供一个纯虚函数 move，它告诉对象移动到给定的位置。但是，它如何移动到那里并没有实现。

另一方面，抽象类与接口的不同之处在于它提供了一些实现细节，但不是全部。从概念上讲，这些是可以以某些方式操作的高级项目，但是当您深入了解它时，高级项目本身并不真正存在或没有意义。

例如，假设我们有一个抽象的 Shape 类。形状可以有一个特定的来源，可以独立于它是什么形状进行跟踪。转换形状的函数可以在 Shape 类中声明和实现，省去了在每个子类中提供相同实现的麻烦。但是，当您尝试获取形状的面积或周长时，如果不了解更多关于形状的信息，就很难回答这个问题。

# protocol-buffers - Separating header and source files after compiling .proto with Protocol Buffers

> ID：15823521
> 
> 赞同：1
> 
> 时间：2013-04-04T23:32:26.840
> 
> 标签：protocol-buffers, precompiling

I'm working on the project with the a structure similar to the following:

```
root/inc/foo/bar/
root/src 
```

I've just started to use Google Protocol Buffers and when I compile the code I found that I need add foo/bar/file.h to the file.cc file in order for the code to find the header. I don't plan to commit the .h and .cc files to the repo since they get automatically generated. Is there a parameter I can give protoc to seperate the header/source files into different directories and add the correct path to the source file #includes?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-20T05:18:58.203

也许你可以在执行协议后附加一个脚本“mv foo.h foofolder/”

# ruby-on-rails - Why is Rails app sending two Ajax requests instead of one, only when using Firefox and on my local server?

> ID：15823523
> 
> 赞同：0
> 
> 时间：2013-04-04T23:32:36.800
> 
> 标签：ruby-on-rails, ajax, firefox

I'm learning Rails development and am building a reddit-like app with voting on comments and posts to help learn. I have Ajax-ified the voting, and now on my local machine when I vote a post/comment up or down it sends two requests and creates two votes on either object. These votes are viewable in my votes table.

This only occurs in Firefox (not Chrome or IE), and it only occurs on my local machine (it's fine in Heroku). I verified with Firebug that it is sending two requests, but I just can't figure out why. I don't believe my asset pipeline is causing the trouble because there just isn't much in there.

This only started once I modified my voting behavior from reloading the page on each vote to using Ajax to display the vote totals. Note that a user can vote as many times as he/she wants right now

My code is on github here: [https://github.com/hellomcfly/tl_postit2](https://github.com/hellomcfly/tl_postit2)

My app is on Heroku here: [http://fathomless-waters-1981.herokuapp.com](http://fathomless-waters-1981.herokuapp.com)

I don't know what code would help, but here is what is in my PostsController:

```
def vote
    @vote = Vote.create(voteable: @post, user: current_user, vote: params[:vote]) 

    respond_to do |format|
      format.html do
        if @vote.vote == false
          flash[:alert] = "Downvote tallied!"
          redirect_to :back
        else
          flash[:success] = "Upvote tallied!"
          redirect_to :back
        end
      end
      format.js
    end    

  end 
```

And here is the relevant code in my posts#index template:

```
Net votes: <span id="post_<%=post.id%>_votes"><%= post.net_votes %></span>
<ul>
    <li><%= link_to "Vote Up", vote_post_path(post, vote: true), method: 'post', remote: true %></li>
    <li><%= link_to "Vote Down", vote_post_path(post, vote: false), method: 'post', remote: true %></li>
</ul> 
```

And here is the vote.js.erb code:

```
$("#post_<%= @post.id %>_votes").html(<%= @post.net_votes %>); 
```

Thanks for the help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:15:29.187

我在类似的情况下遇到了这个问题，它与在`public/assets`. 这导致`application.js`加载两次。

# c# - MVC 模型类应该使用什么数据类型来支持/表示 Image 类型的数据库列？

> ID：15823527
> 
> 赞同：1
> 
> 时间：2013-04-04T23:33:02.317
> 
> 标签：c#, entity-framework, image-processing, asp.net-mvc-4, types

在玩“Programming Razor”时，我遇到了一个难题。如果我有一个包含这些列的表：

```
ID      int
Title   nvarchar
Body    nText
Photo   Image 
```

...应该如何声明相应的 MVC Model 类？我有：

```
public class BlogPost
{
    public long ID { get; set; }
    public string Title { get; set; }
    public string Body { get; set; }
    public Byte[] FauxToe { get; set; }
} 
```

...但是图像的字节数组（可能是 jpg 或 png）充其量只是一个猜测。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:46:39.783

这可能不是完美的答案，但我只是想提供帮助。根据 J.Lerman 的 Programming Entity Framework DbContect，这应该用于存储图像......

```
[Column(TypeName = "image")]
public byte[] Photo { get; set; } 
```

但是，由于它首先是代码，因此在生成 db 之后，列的类型是... varbinary(MAX)。

这是从这里开始的另一本书 Programing Entity Framework: Code first，创建模式的地方。

> 提供给 Column 注释的参数特定于您要映射到的数据库。我们希望将 Photo 存储在 SQL Server 图像字段中。只要可以将用于属性的类型强制转换为您指定的数据库数据类型（例如，将 byte[] 强制转换为图像），您就可以配置数据类型。

但正如我所说，它没有映射到图像类型，而是映射到 varbinary(MAX)

关于其他字段，您正在尝试使用 ID 将 int 映射到 long。确保您的表格被正确调用或您使用表格属性。

# python - Python 的 ROUND_HALF_EVEN 应该如何处理小于 1 的小数？

> ID：15823536
> 
> 赞同：1
> 
> 时间：2013-04-04T23:33:55.270
> 
> 标签：python, decimal, rounding, bankers-rounding

似乎在我能找到的每个定义中都`round half to even`包含`nearest even integer`（例如，Python 的[十进制文档](http://docs.python.org/2/library/decimal.html#decimal.Context)），好像只有整数被四舍五入。但是，如果我对小于 1 的小数进行四舍五入，它似乎遵循相同的原则，只是将角色分配给`integer`我要四舍五入的小数位。例子：

```
>>> THREE_PLACES = decimal.Decimal('0.000')
>>>
>>> decimal.Decimal('.0005').quantize(THREE_PLACES)
>>> Decimal('0.000')
>>>
>>> decimal.Decimal('.0015').quantize(THREE_PLACES)
>>> Decimal('0.002') 
```

在此示例中，小数点后第三位的值似乎扮演整数的角色（向下舍入`0`和向上舍入`2`）。这是处理小于零的数字**的**`ROUND_HALF_EVEN`指定方式（以及Python应该如何工作），如果是这样，我只是误解了这种情况下“整数”的含义吗？或者，还有更多的故事，也许这只是一个巧合？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:37:51.833

你的解释是正确的。文档不清楚，可能应该使用这个词`digit`而不是`integer`. ROUND_HALF_EVEN 意味着结果的最后一位数字将是偶数（当精确舍入 ....5000 时）。

# jquery - Firefox 将新 iframe src 视为来自 jquery .click() 触发器的弹出窗口

> ID：15823539
> 
> 赞同：1
> 
> 时间：2013-04-04T23:34:34.773
> 
> 标签：jquery, firefox, popup, click, submit

我有两个表格，我正在尝试同时提交它们。一个是发布到我们的 PHP 框架，另一个是发布到外部系统（prestashop 安装），这似乎要求用户通过表单的正常单击提交来“访问”页面以处理表单。

我的解决方案是，在发射另一种形式后发射一种形式

```
$(document).ready(function() {
    $('#loginForm2').hide(1);
    $("#loginButton").click(function() {
        $("#userEmail2").val($("#userEmail").val());
        $("#userPassword2").val($("#userPassword").val());
        $.post(
            $("#loginForm").attr("action"), $("#loginForm").serialize(), function(data) {
                // alert('posted to users/login successfully');
                $("#SubmitLogin").click();
            }
        );
        return false;
    });
    function refresh() {
        location.reload();
    }
}); 
```

#loginForm2 表单被发送到同一页面上的隐藏 iframe，并且 iframe 在加载页面（并登录用户）后刷新。

```
<iframe id="loginIframe" style="display:none;" onload="refresh();"></iframe> 
```

这在 Chrome 和 Safari 中效果很好，但在 Firefox 中，它将 iframe 视为弹出窗口并且不会这样做（除非用户说允许弹出窗口）。

有没有办法绕过 Firefox 认为这个 iframe 是一个弹出窗口？我明白它为什么这样做；这不是用户点击的真实事件，它是来自 jquery 的假鼠标点击。我已经查找了一些解决方案来尝试触发“真实”的鼠标点击，但没有发现任何似乎有效的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T18:38:13.087

这是解决方案：

使您单击外部系统（prestashop）表单的提交按钮而不是主系统的登录按钮（使用 CSS 隐藏主系统并显示外部系统）。然后这样做：

```
 $("#SubmitLogin").click(function() {
        var loaded = 0;
        $("#userEmail2").val($("#userEmail").val());
        $("#userPassword2").val($("#userPassword").val());
        $.post(
            $("#loginForm").attr("action"), $("#loginForm").serialize(), function(data) {
                loaded++;
                if (loaded > 1) {
                    location.reload();
                }
            }
        );
        $('#loginIframe').load(function() {
            loaded++;
            if (loaded > 1) {
                location.reload();
            }
        });
    }); 
```

加载的变量是为了确保如果prestashop窗口在主登录的序列化数据发送之前加载，它不会在没有完成主登录的情况下刷新。

显然，iframe 看起来像这样

```
<iframe id="loginIframe" name="loginIframe" style="display:none;"></iframe> 
```

在 Chrome Firefox 和 Safari 中测试。

# c# - How do I change panorama background image depending on theme color?

> ID：15823543
> 
> 赞同：1
> 
> 时间：2013-04-04T23:35:00.287
> 
> 标签：c#, background, themes, controls, panorama-control

I have a WP7 application that uses a dark image for the panorama's background. The issue is when the device is set to light theme i cant make it change with the lighter version of it.

```
private Color lightThemeBackground = Color.FromArgb(255, 255, 255, 255);
private Color darkThemeBackground = Color.FromArgb(255, 0, 0, 0); 

private void DisplayState()
{
    SolidColorBrush backgroundBrush =
         Application.Current.Resources["PhoneBackgroundBrush"] as SolidColorBrush;

    if (backgroundBrush.Color == lightThemeBackground)
    {
        PanoramaBackgroundImage = bg_light.png;
    }
    else
    {
        // you are in the dark theme
    }
} 
```

and in the .xaml file I can't add the image (it only lets me define the panorama background once!

```
<controls:Panorama Title="Museo">
   <controls:Panorama.Background>
   <ImageBrush x:Name="PanoramaBackgroundImage" Stretch="Fill"
                 ImageSource="/Museo;component/bg_dark.png" />
</controls:Panorama.Background> 
```

thanx

# jquery - 检查 Cookie，如果不存在则运行脚本

> ID：15823549
> 
> 赞同：1
> 
> 时间：2013-04-04T23:35:27.240
> 
> 标签：jquery, cookies, modal-dialog

我正在努力在 html 页面上使用 Cookie。我想要一个脚本检查用户是否有 cookie，如果没有则调用此脚本来打开模型窗口

```
<script type="text/javascript">
jQuery(document).ready(function() {
  jQuery("#myModal").reveal();
});
</script 
```

该窗口包含“是”和“否”按钮，如果您的用户选择“是”，它将保存一个 cookie，因此在以后访问该页面时模式不会打开，如果用户选择“否”，它将简单地引导它们到另一个页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:39:47.563

1) 使用 jQuery cookie 库以方便使用。[https://github.com/carhartl/jquery-cookie](https://github.com/carhartl/jquery-cookie)
2) 检查cookie是否存在并进行相应处理

```
if ($j.cookie("NameOfYourCookie") == null) {
//Do stuff if cookie doesn't exist like set a cookie with a value of 1
$j.cookie("NameOfYourCookie", 1, {expires: 10, path:'/'});
}

else {
//They have a cookie so do something
alert ('You have a cookie with name NameOfYourCookie');
} 
```

*** 编辑 ***

以为我可能会编辑我的答案以更适合您的问题。

```
 <button class="yes">YES</button>
        <button class="no">No</button>

     var $j = jQuery.noConflict();

$j(document).ready(function(){
//Show modal on page load           
$j("#myModal").show();  

$j('.yes').click(function(){
        $j("#myModal").hide();
        $j.cookie("YesButtonCookie", 1, {expires: 10, path:'/'});
        alert ('You have clicked yes, a cookie has been dropped');

  });

        if ($j.cookie("YesButtonCookie") == 1){
            // Don't show the div
            $j("#myModal").hide(); 
            alert ('Cookie found, you cant see myModal');
        }

        if ($j.cookie("YesButtonCookie") == null){
                    // Cookie Not Found
                    alert ('Cookie Not found, you can see myModal');
                    $j("#myModal").show();
        }

    $j('.clearcookie').click(function(){
        $j.cookie("YesButtonCookie", null);
        alert('Cookie Cleared');
    });

}); 
```

[JSFIDDLE 测试](http://jsfiddle.net/S8NTg/2/)

# python - 在 Python 中读取意大利语文本使用哪种编码？

> ID：15823551
> 
> 赞同：1
> 
> 时间：2013-04-04T23:35:38.037
> 
> 标签：python, visual-studio-2010, encoding

我正在使用 Visual Studio 的 Python 工具并阅读一些用意大利语编写的文件。试过 iso-8859-1、iso-8859-2、utf-8、utf-8-sig。Notepad++ 以不带 BOM 的 UTF-8 格式打开文件。

```
content = fp.read()
words = content.decode("utf-8-sig").lower().split()
for w in words:
    p=''
    cur.execute('SELECT word FROM  multiwordnet.italian_lemma l, multiwordnet.italian_synset s where l.id = s.id and l.lemma="%s"' % w) 
```

导致崩溃的字符串是`C'è`. （读作`"c\'\xe3\xa8"`）

使用 chardet 没有帮助

```
Traceback (most recent call last):
File "C:\Users\Tathagata\Documents\Visual Studio 2012\Projects\PythonApplicati
on4\PythonApplication4\PythonApplication4.py", line 344, in <module>
createSynsetDict()
File "C:\Users\Tathagata\Documents\Visual Studio 2012\Projects\PythonApplicati
on4\PythonApplication4\PythonApplication4.py", line 294, in createSynsetDict
cur.execute('SELECT word FROM  multiwordnet.italian_lemma l, multiwordnet.it
alian_synset s where l.id = s.id and l.lemma="%s"' % w)
File "C:\Python27\lib\site-packages\pymysql\cursors.py", line 117, in execute
self.errorhandler(self, exc, value)
File "C:\Python27\lib\site-packages\pymysql\connections.py", line 187, in defa
ulterrorhandler
raise Error(errorclass, errorvalue)
Error: (<type 'exceptions.UnicodeEncodeError'>, UnicodeEncodeError('ascii', u's\
x00\x00\x00\x03SELECT word FROM  multiwordnet.italian_lemma l, multiwordnet.ital 
ian_synset s where l.id = s.id and l.lemma="c\'\xe3\xa8"', 116, 118, 'ordinal no
t in range(128)')) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:02:09.713

假设您的数据库的绑定变量样式是`format`...

```
content = fp.read()
words = content.decode("utf-8-sig").lower().split()
for w in words:
    p=''
    cur.execute('SELECT word FROM ' +
                'multiwordnet.italian_lemma l, ' +
                'multiwordnet.italian_synset s ' +
                'where l.id = s.id and l.lemma=%s', w) 
```

请注意，我们没有`%`在 SQL 字符串和传入的变量之间使用运算符，也没有在 ; 周围加上内引号`%s`。相反，它`%s`是一个占位符，用于标识应该在 SQL 中的哪个位置替换单词，并且我们将要替换该占位符的值作为单独的参数传递。遵循这种做法不仅可以防止您需要处理编码问题（如果您的参数作为 Python Unicode 字符串传递，则数据库绑定负责从那里获取它），而且还可以防止[SQL 注入](http://en.wikipedia.org/wiki/SQL_injection)安全漏洞。

Python 的其他数据库库可能使用不同的占位符样式；阅读文档或检查您的模块级`paramstyle`常量。（对于`qmark`您的占位符应该是`?`; 因为`numeric`它应该是冒号前缀的数字（`:1`对于第一个参数，`:2`对于第二个等）

# java - 链表，未正确添加值

> ID：15823554
> 
> 赞同：0
> 
> 时间：2013-04-04T23:35:45.610
> 
> 标签：java

我目前正在执行我的任务，即实现 LinkedList 数据结构，我已经完成了所有代码，除了它不能正常工作，我正在测试它的输入代码是“1,2,3,4, 5”，但是仅输出“1”而不是所有值。

这是我的代码：

```
// Main Method Functions
private static LinkedList createLinkedList(int[] values) {
    LinkedList list;

    list = new LinkedList();
    for (int i = 0; i < values.length; i++) {
        list.add(values[i]);
    }
    return list;
}

private static void printList(LinkedList list) {
    Node currentNode = list.getHead();

    while(currentNode != null) {
        System.out.println(currentNode.getint());
        currentNode = currentNode.getNextNode();
    }
}

// LinkedList class functions
public void add(int value) {
    Node newNode = new Node(value);
    Node currentNode;

    if(head == null) {
        head = newNode;
    } else {
        currentNode = newNode;

        while(currentNode.getNextNode() != null) {
            currentNode = currentNode.getNextNode();
        }
        currentNode.setNextNode(newNode);
    }
    size++;
} 
```

谁能指出我做错了什么？如果您需要添加任何其他功能，请告诉我，谢谢。

编辑：显示正在添加的值的函数：

```
private static void processLinkedList() {
    int[] values = new int[] {1,2,3,4,5};
    LinkedList list = createLinkedList(values);
    printList(list);
    System.out.println(list);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:43:32.037

在你的`add()`方法中，

```
currentNode = newNode; 
```

应该可能更改为

```
currentNode = head; 
```

看看这是否会让你前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T23:45:08.003

你可能应该替换
else {
currentNode = newNode;
通过
else {
currentNode = head;

# ruby-on-rails - 删除 active_admin_editor gem 上的按钮

> ID：15823556
> 
> 赞同：3
> 
> 时间：2013-04-04T23:35:50.840
> 
> 标签：ruby-on-rails, ruby-on-rails-3, wysiwyg, activeadmin

我正在尝试自定义[active_admin_editor](https://github.com/ejholmes/active_admin_editor) gem 功能区上的按钮。根据文档，我设置了 initializers/active_admin_editor.rb 只是为了测试它：

```
ActiveAdmin::Editor.configure do |config|

  config.parser_rules['tags']['h1'] = {
    'remove' => 1
  }
  config.parser_rules['tags']['h2'] = {
    'remove' => 1
  }
  config.parser_rules['tags']['h3'] = {
    'remove' => 1
  }  
end 
```

但无济于事。我做了

```
rm -rf tmp/cache 
```

按照文档中的建议，我多次重新启动服务器，但更改仍然无效，并且 h1、h2、h3 按钮仍然显示。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-03T18:11:27.657

**你好！**

解析器是读取您的输入并定义是否已附加样式的位，例如您是否从另一个 html 页面复制并粘贴一些内容。如果该样式在块中适用或不适用，那么您是对的.

我的另一个想法是首先停用所有选择器，然后一个一个地重新激活它们。我认为这是一件好事，因为用户通常倾向于将格式化的文本复制到其中。这是我的解决方案：

```
ActiveAdmin::Editor.configure do |config|
  config.parser_rules['tags'] = {
    'remove' => 1
 }
  config.parser_rules['tags']['h3'] = {
    'remove' => 0
  }
  config.parser_rules['tags']['p'] = {
    'remove' => 0
  }
end 
```

但这不会影响您可能通过插入一点 css hack 来删除的按钮：

```
 .toolbar a[title="bold"]{
    display: none;
 } 
```

这两个资源可能会有所帮助：

```
https://github.com/xing/wysihtml5/blob/master/parser_rules/advanced.js 
```

和

```
https://github.com/ejholmes/active_admin_editor/blob/master/app/assets/javascripts/active_admin/editor/templates/toolbar.jst.ejs 
```

这是我在 Stackoverflow 上的第一个答案，所以我希望这是一个不错的答案。干杯!

# flash - 防止使用 Flash 内容进行移动检测

> ID：15823557
> 
> 赞同：1
> 
> 时间：2013-04-04T23:36:00.433
> 
> 标签：flash, actionscript, flash-builder

有些网站强制执行向桌面和移动用户显示不同内容的政策。除了使用适当的 UA 字符串外，网络上也有 .flv 文件！所以他们以某种方式检测到移动设备并且不显示桌面内容。

分析这种 flash 行为对于我们的一个移动应用项目很重要，因此出于安全原因，软件中必须有一个隐身模式，以保护移动用户在访问某些网站时不被识别为移动用户我们的合作伙伴公司。

**如何从客户端浏览器控制这种行为？**

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T20:10:38.243

大多数检查（除了 UA 字符串）都是使用 css 媒体查询或 javascript 完成的。除非您可以创建自定义浏览器，否则这些将很难控制（在 Android 上可能，在 iOS 上更难/不可能）。

最明显的检查是检查你是否在打电话：

*   用户代理字符串（如您自己所述）
*   屏幕大小（使用 javascript）
*   CSS 媒体查询

当然还有其他原因不向访问者显示 Flash，使用检测：

*   支持的媒体（视频标签）
*   使用 SWFObject 或类似的东西（基于 JavaScript）的特定闪存测试

如果您真的不希望人们知道您正在使用电话，请使用远程桌面连接到“真实”计算机并使用远程系统上的浏览器。RDP for windows，VNC for windows/osx/more，或者像 TeamViewer 这样的专用系统。大多数这些远程连接系统都有可用的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-08T08:26:53.370

如果您需要在 flash 中检查浏览器的版本，您可以使用[此](http://active.tutsplus.com/tutorials/actionscript/quick-tip-detect-the-browser-and-user-agent-with-as3/)提示。如果您希望您的移动浏览器被识别为桌面浏览器，您必须更改用户代理设置。这是一个如何在 Opera Mobile 中执行此操作的[示例。](http://www.1800pocketpc.com/change-user-agent-on-opera-mobile-95/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-14T15:41:08.660

这真的取决于他们在做什么。移动设备检测可以只是检查屏幕大小或用户代理的问题，但也可以是任何数量的其他事情。

要准确了解您需要做什么，请通过类似[swfscan](http://h30499.www3.hp.com/t5/Following-the-Wh1t3-Rabbit/SWFScan-FREE-Flash-decompiler/ba-p/5440167)或[ASDec](http://code.google.com/p/asdec/)的方式运行 swf 文件。

如果他们使用闪存，我想他们所做的不仅仅是一个基本的用户代理字符串。他们可能正在研究无法轻松调整的设备功能。

使用闪光灯进行检测很奇怪——因为它根本无法在 iPhone 上工作。

# c++ - 我正在尝试创建一个可以处理任何错误输入的健壮类。它工作正常，直到文件中的最后一个数字

> ID：15823560
> 
> 赞同：0
> 
> 时间：2013-04-04T23:36:03.963
> 
> 标签：c++, file-io

```
#ifndef RATIONALNUMBER_H
#define RATIONALNUMBER_H

#include<iostream>
using namespace std;

class RationalNumber
{
    friend ostream &operator<<(ostream &out,RationalNumber &r);
    friend istream &operator>>(istream &in,RationalNumber &r);

    private:
        int numerator;
        int denominator;
    public:
        RationalNumber(int n,int d);
        RationalNumber();
        operator void*(){return (numerator== 0 ? NULL :this);}

};
#endif

#include"RationalNumber.h"
#include<stdexcept>
#include<cmath>

RationalNumber::RationalNumber():numerator(1),denominator(1)
{
}
RationalNumber::RationalNumber(int n,int d):numerator(n),denominator(d)
{
    if(denominator==0)
        throw runtime_error("cant divide by zero");
}
ostream &operator<<(ostream &out,RationalNumber &r)
{
    if(r.denominator == 1 || r.denominator == -1 && r.numerator !=0)

    {
    if(r.denominator<0 && r. numerator <0)
            out<<abs(r.numerator);
        else if(r.denominator<0 || r.numerator<0)
            out<<"-"<<abs(r.numerator);
        else
            out<<r.numerator;
    }
    else if(abs(r.denominator) == abs(r.numerator))
    {
        if(r.denominator<0 && r. numerator <0)
            out<<"1";
        else if(r.denominator<0 || r.numerator<0)
            out<<"-"<<"1";
        else if(r.denominator == 0 && r.numerator ==0)
            out<<"Nothing";
        else 
            out<<"1 ";
    }
    else if(r.numerator<0 && r.denominator >0 ||r.numerator>0 && r.denominator<0)
        out<<"-"<<abs(r.numerator)<<"/"<<abs(r.denominator);
    else if(r.numerator<0 && r.denominator<0)
        out<<abs(r.numerator)<<"/"<<abs(r.denominator);
    else if(r.numerator ==0)
        out<<r.numerator;
    else if(r.numerator>0 && r.denominator>0)
        out<<r.numerator<<"/"<<r.denominator;
    else if(r.numerator ==NULL && r.denominator == NULL)
        out<<" Nothing "<<endl;

    return out;
}
istream &operator>>(istream &in,RationalNumber &r)
{
    int top;
    int bottom;
    char divide;

    r.numerator = 0;
    r.denominator = 0;

    in>>top;

    if(in)
    {
        r.denominator = 1;

        while (isspace(divide = in.peek())&& divide != '\n')
            in.get();

        if(divide !='\n')
        {
            if(divide =='/')
            {
                in>>divide;

                while (isspace(bottom = in.peek()))
                    in.get();

                in>>bottom;

                if(!in || bottom==0)
                {
                    r.numerator=top;
                    in.clear(ios::failbit);
                }
                else
                {
                    r.numerator=top;
                    r.denominator=bottom;
                }
            }
            else
            {
                r.numerator=top;
                in.clear(ios::failbit);
            }
        }
        else
        {
            r.numerator = top;
        }

    }
    else
        in.clear(ios::failbit);

    return in;
} 
```

///////////////////////////////////////// ///////////////////////////////////////// /

```
12/34       */this is the file im reading in from. the class is supposed to
12             be a rational number class but i would like for a 23 to 
23             read correctly without causing an error.It
34             is only giving me problems with the last number in the file. Im not sure
23             whats going on*/ 
```

///////////////////////////////////////// ///////////////////////////////////////// /

# sql - Oracle SQL 错误 ORA-00907：缺少右括号

> ID：15823563
> 
> 赞同：0
> 
> 时间：2013-04-04T23:36:18.003
> 
> 标签：sql, database, oracle

你们好吗？

基本上我已经编写了这段 SQL 代码来创建一个表，但是我不断收到标题中所述的错误，知道为什么吗？

这是代码：

```
 CREATE TABLE staff(
    staffID INT NOT NULL PRIMARY KEY,
    firstName VARCHAR2(20),
    lastName VARCHAR2(20),
    addressLine_1 VARCHAR2(30),
    city VARCHAR2(15),
    postcode VARCHAR2(7),
    telephone VARCHAR2(15),
    salary DECIMAL (19,4),
    branchID INT FOREIGN KEY REFERENCES branches(branchID)
    ); 
```

这也是我的“分支”表的代码

```
 CREATE TABLE branches
    (branchID int NOT NULL PRIMARY KEY,
    addressLine_1 VARCHAR2(30),
    city VARCHAR2(15),
    postcode VARCHAR2(7),
    telephone VARCHAR2(15),
    manager VARCHAR2(20)); 
```

任何帮助，将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:40:14.793

几点建议：

首先确保`branches`表已经创建。

其次，我会将创建表代码更改为以下内容：

```
CREATE TABLE staff(
    staffID INT NOT NULL PRIMARY KEY,
    firstName VARCHAR(20),
    lastName VARCHAR(20),
    addressLine_1 VARCHAR2(30),
    city VARCHAR2(15),
    postcode VARCHAR2(7),
    telephone VARCHAR2(15),
    salary DECIMAL (19,4),
    branchID INT,
    constraint fk_branchId FOREIGN KEY (branchID) REFERENCES branches(branchID)
    ); 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!4/fc945)。[在创建表期间创建FOREIGN KEY](http://www.techonthenet.com/oracle/foreign_keys/foreign_keys.php)的语法是：

```
CREATE TABLE table_name
(
  column1 datatype null/not null,
  column2 datatype null/not null,
  ...

  CONSTRAINT fk_column
    FOREIGN KEY (column1, column2, ... column_n)
    REFERENCES parent_table (column1, column2, ... column_n)
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-06T19:47:52.027

这是表staff1的创建

```
CREATE TABLE staff
(
staffID INT NOT NULL PRIMARY KEY,
firstName VARCHAR2(20),
lastName VARCHAR2(20),
addressLine_1 VARCHAR2(30),
city VARCHAR2(15),
postcode VARCHAR2(7),
telephone VARCHAR2(15),
branchID int,
salary DECIMAL (19,4),
CONSTRAINT BRANCH_fk FOREIGN KEY(branchID) REFERENCES branches(branchID)
)
SQL> /
Table created. 
```

请使用约束名称，以便发现错误变得容易。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-11T22:56:37.620

```
create table medication (
id int not null primary key, 
name varchar(20),
mudslig price number (10),
protect date not null default (getdate()),
finish date not null default (getdate()),
company proect varchre2 (20),
shelf id int,
chemistid int,
constraint shelf_fk foreign key (shelf id) refences shelf (shelf id),
constraint chemist_fk foreign key (chemistid) refences chemist (chemistid)
); 
```

请使用约束名称，以便发现错误变得容易。

# javascript - View 只能在 Angular 中第一次使用

> ID：15823565
> 
> 赞同：1
> 
> 时间：2013-04-04T23:36:44.480
> 
> 标签：javascript, angularjs

我有一个应用程序，我正在利用路线来加载两个不同的视图。

第一条路线`#/`是主列表视图。每次都这样。

我的第二条路线是`#/view/:id`在单击列表项时加载我的第二个视图。

视图是基于 id 的数据驱动的，所有这些都需要`$http`通过`service`我创建的一个请求。

是否有可能当我离开`#/view/:id`路线时，它会完全卸载该视图并在我回来时重新加载它？

**或者**

如何在服务中重置承诺，以便下次加载视图时，它将请求新数据？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:55:29.873

这些不是相互排斥的问题。路由`ngView`在每次加载时都会破坏视图、范围和控制器，因此控制器和范围历史*不会*在路由之间保留。否则，浏览器中的内存负载会很高；相反，我们可以使用服务来保存我们需要跨所有路由的状态。

`$http``cache`除非启用该选项，否则每次调用请求时都会刷新请求。按设计工作不需要任何工作：

```
.factory( 'dataService', function( $http ) {
  return function dataServiceFn ( id ) {
    return $http.get( '/myapi', { params: { id: id } } );
  };
}); 
```

当您的数据服务被调用时（例如`dataService( $routeParams.id );`），将返回一个新的承诺。

这只是一个非常简单的案例的示例服务结构，但只要`$http`在每次服务调用时调用都是新鲜的，你就会得到一个新的承诺，保证每次都是新鲜的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T23:54:53.180

当你离开另一个控制器时，Angular 会卸载控制器。如果需要在不同视图之间存储数据，则应将其存储在服务中（控制器更改时不会卸载）或准备每次加载视图时发出 $http 请求。

# sql-server - 即使从 Management Studio 也无法访问 SQL Server 引擎

> ID：15823568
> 
> 赞同：0
> 
> 时间：2013-04-04T23:37:07.027
> 
> 标签：sql-server, sql-server-2012-express

我刚刚在我的计算机（Windows 8）上安装了 SQL Server 2012 Express 版本。

当我尝试从 Management Studio 创建数据库时，出现以下错误：

> 为数据库“TestDB”创建失败。(Microsoft.SqlServer.Smo)
> 在数据库“主”中拒绝创建数据库权限。
> （Microsoft SQL Server，错误：262）

当我尝试从 Visual Studio 访问它时，我收到以下类似的错误消息：

> 数据库“master”中的 CREATE DATABASE 权限被拒绝。

有什么理由吗？我什至无法从管理工作室访问引擎。

编辑

这是我的连接字符串

```
<add name="DefaultConnection" 
     connectionString="Data Source=localhost\sqlexpress;Initial   
        Catalog=OptimumWeightDB;Integrated Security=True;
        Integrated Security=True;
        User Id=sa;Password=mypassword" " 
     providerName="System.Data.SqlClient" /> 
```

这是上下文类

```
public class OWDbContext : DbContext
{
    public OWDbContext()
        : base("DefaultConnection") { }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T01:14:37.767

首先。尝试使用 Windows 身份验证登录到 SQL Server 上的 SQL Management Studio。

`sa`如果您可以使用 Windows 帐户创建数据库/操作数据库，则登录帐户上的安全设置可能存在问题。

然后尝试重新创建/创建新的登录帐户并将其权限设置为 db admin。

其他事情确保在您的 SQL Server 上启用了 SQL Server 身份验证。

当您已经使用 Windows 身份验证连接到 SQL Server 时，右键单击您的`SQL Server > Properties > Security > SQL server and Windows Authentication mode.`

还将您的连接字符串更改为

```
Data Source=localhost\sqlexpress; Initial Catalog=OptimumWeightDB; user=yourloginname; password=yourpassword; 
```

最好的祝福

# jquery - 获取 jquery 灯箱以将图像从标签中拉出

> ID：15823569
> 
> 赞同：0
> 
> 时间：2013-04-04T23:37:14.247
> 
> 标签：jquery, html, css

在我的网站上，我目前正在使用一个 jquery 插件，它可以在页面上自动滚动图像，这一切都很好。

但是，如果您单击图像，它只会将您带到图像源，我想使用与它结合的灯箱功能。问题是我能找到的所有 jquery 灯箱代码都使用 href 标签来获取图像 url，但滚动条使用 img ；

img src="img/img1.jpg" longdesc="img/img1.jpg" width="400" alt="图片 1" /

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:59:12.130

您需要做的第一件事是禁用图像流的 onclick 行为：http: [//finnrudolph.de/ImageFlow/Documentation](http://finnrudolph.de/ImageFlow/Documentation)幸运的是，它在图像流选项中可用。

就像是`onClick : $.noop`

接下来，您需要对灯箱进行一些更改。Colorbox 使用该`href`属性来确定要显示的内容。它不是标准的，但您应该能够摆脱`href`图像元素上的属性。试一试。

```
<img src="img/img1.jpg" href="img/img1.jpg" width="400" alt="Image 1" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:41:26.827

您可以在 JavaScript 中使用 "document.getElementById("id").src" 或 "document.getElementByTagName("img").src" 选择 img 元素的属性，然后以相同的方式将其分配给另一个标签，只需将“id”更改为正确的 id，将“src”更改为任何属性。

# c - 在 C 中对文件进行排序

> ID：15823574
> 
> 赞同：0
> 
> 时间：2013-04-04T23:37:45.033
> 
> 标签：c, text-files, stdio

我正在尝试编写一个程序，它打开一个文本文件，从文件中读取，将大写更改为小写，然后计算该单词在文件中出现的次数并将结果打印到新的文本文件中。

到目前为止，我的代码如下：

```
#include <stdio.h>
#include <stdlib.h>
#include <conio.h>
#include <ctype.h>
#include <string.h>

int main()
{

    FILE *fileIN;
    FILE *fileOUT;
    char str[255];
    char c;
    int i = 0;

    fileIN = fopen ("input.txt", "r");
    fileOUT = fopen ("output.txt", "w");

    if (fileIN == NULL || fileOUT == NULL)
    {
        printf("Error opening files\n");
    }

    else
    {
        while(! feof(fileIN)) //reading and writing loop
        {
            fscanf(fileIN, "%s", str); //reading file

            i = 0;
            c = str[i];
            if (isupper(c)) //changing any upper case to lower case
            {
                c =(tolower(c));
                str[i] = putchar(c);
            }

            printf("%s ", str); //printing output

                            fprintf(fileOUT, "%s\n", str); //printing into file
        }

        fclose(fileIN);
        fclose(fileOUT);
    }
    getch();
} 
```

input.txt文件包含以下“西班牙的雨主要落在飞机上”不要问为什么。程序运行后的输出如下所示：西班牙的雨主要落在飞机上

我设法将大写单词小写。我现在无法理解如何计算每个单词的出现次数。例如，在输出中，我希望它说“the 2”，意思是 2 出现了，这也意味着我不想再将“the”存储在该文件中。

我在想 strcmp 和 strcpy 但不确定如何以我想要的方式使用它们。

帮助将不胜感激

（如果格式不好，请见谅）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:41:04.370

您可能想要创建一个哈希表，其中单词作为键，频率作为值。

素描思路：

*   识别单词，即由空格分隔的字母数字字符串，尝试使用 strtok()
*   对于每个单词
    *   在基于哈希表的字典中搜索单词
        *   如果找到：增加频率
        *   如果*未*找到：在字典中插入一个新条目为 (word, 1)

最后，打印字典的内容，即所有条目，`entry.word`以及`entry.frequency`

有关详细信息，请参见此问答：[Quick Way to Implement Dictionary in C](https://stackoverflow.com/questions/4384359/quick-way-to-implement-dictionary-in-c)它基于圣经“The C Programming Language”的第6.6节

更新基于OP的评论：

哈希表只是一个高效的表，如果你不想使用它，你仍然可以使用 vanilla 表。这里有一些想法。

```
typedef struct WordFreq {
    char  word[ N ];
    int   freq;
} WordFreq;

WordFreq wordFreqTable[ T ];

(N is the maximum length of a single word, T is the maximum number of unique words) 
```

对于搜索和插入，您可以在表格中进行线性搜索`for( int i = 0; i != T; ++i ) {`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T10:54:08.240

简单示例（需要错误捕获、释放内存、排序以供使用 qsort 等...）

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <ctype.h>

#define BUFFSIZE 1024

typedef struct _wc {
    char *word;
    int count;
} WordCounter;

WordCounter *WordCounters = NULL;
int WordCounters_size = 0;

void WordCount(char *word){
    static int size = 0;
    WordCounter *p=NULL;
    int i;

    if(NULL==WordCounters){
        size = 4;
        WordCounters = (WordCounter*)calloc(size, sizeof(WordCounter));
    }
    for(i=0;i<WordCounters_size;++i){
        if(0==strcmp(WordCounters[i].word, word)){
            p=WordCounters + i;
            break;
        }
    }
    if(p){
        p->count += 1;
    } else {
        if(WordCounters_size == size){
            size += 4;
            WordCounters = (WordCounter*)realloc(WordCounters, sizeof(WordCounter)*size);
        }
        if(WordCounters_size < size){
            p = WordCounters + WordCounters_size++;
            p->word = strdup(word);
            p->count = 1;
        }
    }
}

int main(void){
    char buff[BUFFSIZE];
    char *wordp;
    int i;

    while(fgets(buff, BUFFSIZE, stdin)){
        strlwr(buff);
        for(wordp=buff; NULL!=(wordp=strtok(wordp, ".,!?\"'#$%&()=@ \t\n\\;:[]/*-+<>"));wordp=NULL){
            if(!isdigit(*wordp) && isalpha(*wordp)){
                WordCount(wordp);
            }
        }
    }
    for(i=0;i<WordCounters_size;++i){
        printf("%s:%d\n", WordCounters[i].word, WordCounters[i].count);
    }

    return 0;
} 
```

演示

```
>WordCount.exe
The rain in Spain falls mainly in the plane
^Z
the:2
rain:1
in:2
spain:1
falls:1
mainly:1
plane:1 
```

# c# - 创建单独的管理员帐户

> ID：15823575
> 
> 赞同：0
> 
> 时间：2013-04-04T23:37:45.540
> 
> 标签：c#, login, passwords, admin, account

我正在使用 Microsoft Visual Web Developer 2010 Express (C#) 我正忙于为一个项目创建一个网站，其中涉及用户注册和登录到一个站点。我已经完成了那部分，但我不确定如何仅为 1 个管理员创建一个单独的帐户。

我创建了一个新的网络表单并添加了一个新的登录控件，但新的登录控件仅适用于注册用户，而不是管理员（这可能是由于会员等级）。如何为一个管理员创建一个单独的帐户？

# php - Mysql获取列名然后结果

> ID：15823580
> 
> 赞同：0
> 
> 时间：2013-04-04T23:37:52.830
> 
> 标签：php, mysql

假设我有一个查询来获取特定数据库中可能具有不同模式的所有信息。

例如，我可能有：
DB1 with [id] [blah] [shibby] &
DB2 with [id] [yadda] [etc] [andsoforth]

然后我运行一个需要返回的查询：
A）字段名称到表头
B）结果到表单元格

查询将通过 post 从表单生成，以便设置一些变量以确定从哪个数据库获取信息。

下面将为我提供列名，但我需要用实际结果填充其余部分。

```
echo "<table>";
echo "<tr>";
$qColumnNames = mysql_query("SHOW COLUMNS FROM ".$db) or die("mysql error"); 
$numColumns = mysql_num_rows($qColumnNames); 
$x = 0; 
while ($x < $numColumns) 
{ 
    $colname = mysql_fetch_row($qColumnNames); 
    $col[$colname[0]] = $colname[0]; 
    $x++; 
} 

foreach($col as $key){
    echo "<th>$key</th>";
}
echo "</tr>";
echo "</table>"; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:47:22.690

你说数据库，但你的意思是表中的字段？你有第一部分 -[获取列名](http://dev.mysql.com/doc/refman/5.0/en/show-columns.html)- 然后你可以将它们从你的数组中分解成一个字符串并在你的 SELECT 查询中使用它：

```
$query = "SELECT ".implode(",", $col)." FROM [tablename] ..."; 
```

# jquery - 单击某个链接时，如何让用户弹出到页面上的特定位置

> ID：15823583
> 
> 赞同：1
> 
> 时间：2013-04-04T23:38:20.463
> 
> 标签：jquery

嘿伙计们，我想弄清楚如何让用户重定向到另一个页面并基于点击的链接；让它把它们放在包含信息的页面的那个位置。

我打算在 JQuery 中对此进行编码。请告诉我 ：）

谢谢大家，我希望你们星期四过得愉快！！！

编辑：

```
<div class="online_training">
     <div class="training_image">
       <a href="../services.php">...</a>
     </div><!-- .training_image -->
     <div class="top-textArea">
       <h2><a href="../services.php"></a>....</h2>
       <p>
                       .....
       </p>
     </div><!-- .top-textArea -->
</div><!-- .online_training -->

    I have mutiple of these and so the part to notice where I want to have 
it redirect to and go to that part of the page is the where the .training_image <a> is and the <h2> one is. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T23:41:31.553

最简单的方法是只使用锚标签。

在初始页面上：

```
<a href="/otherpage#spot1">Go to spot1</a> 
```

在其他页面上：

```
<a href="#" name="spot1"></a> 
```

当加载其他页面时，它将滚动到名为 spot1 的锚点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T23:45:30.340

如果由于某种原因您不能使用原始链接 href 到达那里...，您可以使用 window.location 和命名锚点的组合。

```
$('a').click(function(evt){
  evt.preventDefault();

  switch ($(this).prop('data-destination')) {
    case 'api':
      window.location = 'other-page.html#api';
      break;
    case 'tutorial':
      window.location = 'other-page.html#tut';
      break;
    default:
      window.location = 'other-page.html#toc';
      break;
  }
}); 
```

在 other-page.html 你有那些命名的锚点，例如：

```
<a name="toc"></a>
<a name="api"></a>
<a name="tut"></a> 
```

理想的解决方案是以正确的方式构建链接并避免使用 javascript/jQuery。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T23:46:03.090

假设您`div`在页面顶部或某处有一个这样的：

```
<div name="top-div">
    <a href="javascript:void(0)" id="clickMe">Click to Scroll</a>
</div> 
```

然后在页面的下方，您可以在另一个页面中找到您想去的地方`div`：

```
<div id="scrollHere" name="scrollHere">
    Hi
</div> 
```

使用类似下面的 jQuery 来获得精美的滚动效果：

```
$("#clickMe").click(function(event) {
    event.preventDefault();
    var scrollTo = $("#scrollHere").css("top");
    var n = $(document).height();
    $('html, body').animate({ scrollTop: n }, scrollTo);
}); 
```

[jsFiddle](http://jsfiddle.net/azLZp/)

```
$("#clickMe").click(function(event) {
    event.preventDefault();
    $.fn.scrollToPos("#scrollHere");
});

$.fn.scrollToPos = function(position) {
    var scrollTo = $(position).css("top");
    var n = $(document).height();
    $('html, body').animate({ scrollTop: n }, scrollTo);
    return this;
}; 
```

[jsFiddle 2](http://jsfiddle.net/KdUmd/)

# java - 在 SQLite 数据库中保存 SSID 数据会导致强制关闭

> ID：15823584
> 
> 赞同：0
> 
> 时间：2013-04-04T23:38:32.187
> 
> 标签：java, android, sqlite, forceclose

我正在尝试使用其他数据（用户当前的 SSID）更新我的数据库，但是在尝试保存数据库时 - 整个应用程序强制关闭。

我知道保存数据时会导致 NullPointer 异常 - 但我不知道我做错了什么导致它。

日志猫：

```
04-04 21:24:08.351: E/AndroidRuntime(10745): FATAL EXCEPTION: AsyncTask #2
04-04 21:24:08.351: E/AndroidRuntime(10745): java.lang.RuntimeException: An error occured while executing doInBackground()
04-04 21:24:08.351: E/AndroidRuntime(10745):    at android.os.AsyncTask$3.done(AsyncTask.java:299)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:352)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at java.util.concurrent.FutureTask.setException(FutureTask.java:219)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at java.util.concurrent.FutureTask.run(FutureTask.java:239)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at java.lang.Thread.run(Thread.java:856)
04-04 21:24:08.351: E/AndroidRuntime(10745): Caused by: java.lang.NullPointerException
04-04 21:24:08.351: E/AndroidRuntime(10745):    at com.app.gamedemo.AddEditDevice.saveContact(AddEditDevice.java:117)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at com.app.gamedemo.AddEditDevice.access$1(AddEditDevice.java:111)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at com.app.gamedemo.AddEditDevice$1$1.doInBackground(AddEditDevice.java:83)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at android.os.AsyncTask$2.call(AsyncTask.java:287)
04-04 21:24:08.351: E/AndroidRuntime(10745):    at java.util.concurrent.FutureTask.run(FutureTask.java:234)
04-04 21:24:08.351: E/AndroidRuntime(10745):    ... 4 more 
```

来源：（更新了 SCF 的建议）

ADDEDITDEVICE.java

```
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.net.wifi.WifiInfo;
import android.net.wifi.WifiManager;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.ViewGroup;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.FrameLayout;
import android.widget.TextView;
import android.widget.TimePicker;
import java.text.DecimalFormat;

public class AddEditDevice extends Activity {

     private long rowID; 
     private EditText nameEt;
     private EditText capEt;
     private EditText codeEt;
     private TimePicker timeEt;
     private TextView ssidTextView;

      // @Override
       public void onCreate(Bundle savedInstanceState) 
       {
          super.onCreate(savedInstanceState); 
          setContentView(R.layout.add_country);
          WifiManager wifi = (WifiManager) getSystemService(Context.WIFI_SERVICE);
          WifiInfo info = wifi.getConnectionInfo();
          String ssidString = info.getSSID();

          //TextView ssidTextView = (TextView) findViewById(R.id.wifiSSID);
          ssidTextView = (TextView) findViewById(R.id.wifiSSID);
          ssidTextView.setText(ssidString); 

          nameEt = (EditText) findViewById(R.id.nameEdit);
          capEt = (EditText) findViewById(R.id.capEdit);
          codeEt = (EditText) findViewById(R.id.codeEdit);
          timeEt = (TimePicker) findViewById(R.id.timeEdit);

          Bundle extras = getIntent().getExtras(); 

          if (extras != null)
          {
             rowID = extras.getLong("row_id");
             nameEt.setText(extras.getString("name"));  
             capEt.setText(extras.getString("cap"));  
             codeEt.setText(extras.getString("code"));    
             String time = extras.getString("time");
             String[] parts = time.split(":");
             timeEt.setCurrentHour(Integer.valueOf(parts[0]));
             timeEt.setCurrentMinute(Integer.valueOf(parts[1]));
             timeEt.setIs24HourView(false);

          }

          Button saveButton =(Button) findViewById(R.id.saveBtn);
          saveButton.setOnClickListener(new OnClickListener() {

              public void onClick(View v) 
              {
                 if (capEt.getText().length() != 0)
                 {
                    AsyncTask<Object, Object, Object> saveContactTask = 
                       new AsyncTask<Object, Object, Object>() 
                       {
                          @Override
                          protected Object doInBackground(Object... params) 
                          {
                             saveContact();
                             return null;
                          }

                          @Override
                          protected void onPostExecute(Object result) 
                          {
                             finish();
                          }
                       }; 

                    saveContactTask.execute((Object[]) null); 
                 }

                 else
                 {
                    AlertDialog.Builder alert = new AlertDialog.Builder(AddEditDevice.this);
                    alert.setTitle(R.string.errorTitle); 
                    alert.setMessage(R.string.errorMessage);
                    alert.setPositiveButton(R.string.errorButton, null); 
                    alert.show();
                 }
              } 
         });}

           private void saveContact() 
           {
              DatabaseConnector dbConnector = new DatabaseConnector(this);

              if (getIntent().getExtras() == null)
              {
                  dbConnector.insertContact(nameEt.getText().toString(),
                          capEt.getText().toString(),
                          timeEt.getCurrentHour().toString() + ":"
                              + timeEt.getCurrentMinute().toString(),
                          codeEt.getText().toString(),
                       ssidTextView.getText().toString());

              }
              else
              {
                 dbConnector.updateContact(rowID,
                         nameEt.getText().toString(),
                            capEt.getText().toString(),
                              timeEt.getCurrentHour().toString() + ":"
                                  + timeEt.getCurrentMinute().toString(),
                              codeEt.getText().toString(),
                              ssidTextView.getText().toString());
              }
           }
} 
```

来源：

数据库连接器.java

```
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;

public class DatabaseConnector {

    private static final String DB_NAME = "WorldCountries";
    private SQLiteDatabase database;
    private DatabaseOpenHelper dbOpenHelper;

    public DatabaseConnector(Context context) {
        dbOpenHelper = new DatabaseOpenHelper(context, DB_NAME, null, 1);
    }

       public void open() throws SQLException 
       {
          //open database in reading/writing mode
          database = dbOpenHelper.getWritableDatabase();
       } 

       public void close() 
       {
          if (database != null)
             database.close();
       }       

       public void insertContact(String name, String cap, String code, String time, String ssid) 
               {
                  ContentValues newCon = new ContentValues();
                  newCon.put("name", name);
                  newCon.put("cap", cap);
                  newCon.put("time", time);
                  newCon.put("code", code);
                  newCon.put("ssid", ssid);

                  open();
                  database.insert("country", null, newCon);
                  close();
               }

               public void updateContact(long id, String name, String cap, String code, String time, String ssid) 
               {
                  ContentValues editCon = new ContentValues();
                  editCon.put("name", name);
                  editCon.put("cap", cap);
                  editCon.put("time", time);
                  editCon.put("code", code);
                  editCon.put("ssid", ssid);

                  open();
                  database.update("country", editCon, "_id=" + id, null);
                  close();
               }

               public Cursor getAllContacts() 
               {
                  return database.query("country", new String[] {"_id", "name"}, 
                     null, null, null, null, "name");
               }

               public Cursor getOneContact(long id) 
               {
                  return database.query("country", null, "_id=" + id, null, null, null, null);
               }

               public void deleteContact(long id) 
               {
                  open(); 
                  database.delete("country", "_id=" + id, null);
                  close();
               }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:12:28.557

我认为您的问题是您将 TextView 保存到局部变量“ssidTextView”中，而您应该将其保存到字段“ssid”中。只是改变

```
TextView ssidTextView = (TextView) findViewById(R.id.wifiSSID); 
```

进入

```
ssid = (TextView) findViewById(R.id.wifiSSID); 
```

当然，您还必须将“String ssid”重命名为其他名称，例如“ssidString”。

# wordpress - 子目录中的 Wordpress 站点，注销功能失败

> ID：15823589
> 
> 赞同：1
> 
> 时间：2013-04-04T23:39:01.687
> 
> 标签：wordpress, logout, directory-structure

我们在域的根目录中有 Wordpress 站点。我们使用的翻译插件将域附加到（在我们的捷克语中）/cs - 这意味着我们可以运行多个翻译，但使用与主要英语网站相同的数据库和 wp-content。

但是，添加的 /cs 会导致注销功能失败，因为它尝试使用当前目录作为从中提取实际站点内容的基础。

实际使用的代码是`<?php echo wp_logout_url( $redirect ); ?>`. 我们尝试了一个简单的 HTML href，但注销链接是动态的，需要一个唯一的 nonce 值来验证命令。

您对我们如何使用实际站点地址 (mywebsite.com) 而不是添加的“目录” (mywebsite.com/cs) 的注销按钮有任何想法。到目前为止，我一直无法编辑**wp_logout_url**在它之前添加 / 。有任何想法吗？

示例链接：正确： `http://www.mywebsite.com/backend?action=logout&redirect_to=index.php&_wpnonce=d8eaf8594a`

不正确，导致 404 错误： `http://www.mywebsite.com/cs/backend?action=logout&redirect_to=index.php&_wpnonce=d8eaf8594a`

正在使用的实际代码（相关的注销代码是#bawlogout# 部分）：

```
add_filter( 'wp_setup_nav_menu_item', 'bawllm_setup_nav_menu_item' );
function bawllm_setup_nav_menu_item( $item )
{
    global $pagenow;
    if( $pagenow!='nav-menus.php' && !defined('DOING_AJAX') && isset( $item->url ) && strstr( $item->url, '#baw' ) != '' ){
        $item_url = substr( $item->url, 0, strpos( $item->url, '#', 1 ) ) . '#';
        $item_redirect = str_replace( $item_url, '', $item->url );
        switch( $item_url ) {
            case '#bawloginout#' :  
                                    $item_redirect = explode( '|', $item_redirect );
                                    if( count( $item_redirect ) != 2 ) 
                                        $item_redirect[1] = $item_redirect[0];
                                    for( $i = 0; $i <= 1; $i++ ):
                                        if( $item_redirect[$i] == '%actualpage%')
                                            $item_redirect[$i] = $_SERVER['REQUEST_URI'];
                                    endfor;
                                    $item->url = is_user_logged_in() ? wp_logout_url( $item_redirect[1] ) : wp_login_url( $item_redirect[0] );
                                    $item->title = bawllm_loginout_title( $item->title ) ; break;
            case '#bawlogin#' :     $item->url = wp_login_url( $item_redirect ); break;
            case '#bawlogout#' :    $item->url = wp_logout_url( $item_redirect ); break;
            case '#bawregister#' :  if( is_user_logged_in() ) $item->title = '#bawregister#'; else $item->url = site_url( '/wp-login.php?action=register', 'login' ); break;
        }
        $item->url = esc_url( $item->url );
    }
    return $item;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:44:39.017

我会将 URL 放入一个变量中，以便您可以对其执行正则表达式，例如：

```
<?php

$url       = wp_logout_url( $redirect );
$fixed_url = preg_replace("/stuff_to_find/", "stuff_to_replace", $url);

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T16:17:13.747

最后，我采取了简单的方法并在 .htaccess 中使用 Redirect 301 将带有 /cs/ 的注销链接重定向到 /

# php - Android 和 PHP 连接到 MySQL 数据库

> ID：15823592
> 
> 赞同：1
> 
> 时间：2013-04-04T23:39:38.437
> 
> 标签：php, android, mysql, connection

我有以下代码，我正在努力让它工作。java文件中有2个错误，我找不到修复程序。

这是我的 MySQLData.java 文件

```
package com.example.qosmetre2;
import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.Activity;
import android.net.ParseException;
import android.os.Bundle;
import android.util.Log;
import android.widget.Toast;
import java.util.ArrayList; 
import java.util.HashMap; 
import java.util.List; 

import org.apache.http.NameValuePair; 
import org.json.JSONArray; 
import org.json.JSONException; 
import org.json.JSONObject; 

import android.app.ListActivity; 
import android.app.ProgressDialog; 
import android.content.Intent; 
import android.os.AsyncTask; 
import android.os.Bundle; 
import android.util.Log; 
import android.view.View; 
import android.widget.AdapterView; 
import android.widget.AdapterView.OnItemClickListener; 
import android.widget.ListAdapter; 
import android.widget.ListView; 
import android.widget.SimpleAdapter; 
import android.widget.TextView;

public class MySQLData extends ListActivity {
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    String result = null;
    InputStream is = null;
    StringBuilder sb=null;
    String result=null;
    //http post

    try{
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://localhost/android_test/fetch_data2.php");
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        HttpResponse response = httpclient.execute(httppost);
        HttpEntity entity = response.getEntity();
        is = entity.getContent();
    }catch(Exception e){
        Log.e("log_tag", "Error in http connection"+e.toString());
    }

    //convert response to string

    try{
        BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
        sb = new StringBuilder();
        sb.append(reader.readLine() + "\n");
        String line="0";
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }

        is.close();
        result=sb.toString();

    }catch(Exception e){

        Log.e("log_tag", "Error converting result "+e.toString());
    }
    //paring data

    String nam;
    int rec_pow;
    int tow;
    int stat;

    try{
    JSONArray jArray = new JSONArray(result);
    JSONObject json_data=null;

    for(int i=0;i<jArray.length();i++){
            json_data = jArray.getJSONObject(i);
            nam=json_data.getString("name");
            rec_pow=json_data.getInt("recieved_power");
            tow=json_data.getInt("tower");
            stat=json_data.getInt("status");

    }

    }catch(JSONException e1){
        Toast.makeText(getBaseContext(), "Could not Parse Data", Toast.LENGTH_LONG).show();
    }catch (ParseException e1){
        e1.printStackTrace();

    }

}

} 
```

以下 2 行有错误：

```
String result=null;
httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs)); 
```

第一个错误表示重复的局部变量结果，第二个错误表示 nameValuePairs 无法解析为变量。

我还有一个 php 文件，我把它放在我的 wamp 服务器中，我希望在我的本地服务器上显示的信息出现在应用程序中。我在某处读到我可能需要转发，以便我可以通过互联网从应用程序访问，但我不知道。在修复错误之前，该应用程序不会运行。

这是我的 PHP 文件 fetch_data2.php

```
 <?php
mysql_connect("888888","8888888","*******");
mysql_select_db("*******");
$q=mysql_query("SELECT * FROM users");

 while($row=mysql_fetch_assoc($q))
 $output[]=$row;

  print(json_encode($output));

  mysql_close();

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:49:09.903

在查看您的代码时，我确实看到变量 result 定义了两次，并且在任何地方都没有看到 nameValuePairs 定义。我认为编译器是正确的:})

# c - 使用 printf 以十六进制格式打印字符串，结果失真

> ID：15823597
> 
> 赞同：10
> 
> 时间：2013-04-04T23:40:12.070
> 
> 标签：c, printf

我想在机器 A 上打印一个十六进制格式的字符串。比如：

```
ori_mesg = gen_rdm_bytestream (1400, seed)
sendto(machine B, ori_mesg, len(mesg)) 
```

在机器 B 上

```
recvfrom(machine A, mesg)

mesg_check = gen_rdm_bytestream (1400, seed)

for(i=0;i<20;i++){
    printf("%02x ", *(mesg+i)& 0xFF);
}
printf("\n");
for(i=0; i<20; i++){
    printf("%02x ", *(mesg_check+i));
}
printf("\n"); 
```

`seed`在 1、2、3、... 之间变化

字节生成函数是：

```
u_char *gen_rdm_bytestream (size_t num_bytes, unsigned int seed)
{
    u_char *stream = malloc (num_bytes+4);
    size_t i;

    u_int16_t seq = seed;
    seq = htons(seq);
    u_int16_t tail = num_bytes;
    tail = htons(tail);
    memcpy(stream, &seq, sizeof(seq));
    srand(seed);
    for (i = 3; i < num_bytes+2; i++){
        stream[i] = rand ();
    }
    memcpy(stream+num_bytes+2, &tail, sizeof(tail));

    return stream;
} 
```

但是我从 printf 得到了结果，例如：

```
00 01 00 67 c6 69 73 51 ff 4a ec 29 cd ba ab f2 fb e3 46 7c
00 01 00 67 ffffffc6 69 73 51 ffffffff 4a ffffffec 29 ffffffcd ffffffba ffffffab fffffff2 fffffffb ffffffe3 46 7c 
```

或者

```
00 02 88 fa 7f 44 4f d5 d2 00 2d 29 4b 96 c3 4d c5 7d 29 7e
00 02 00 fffffffa 7f 44 4f ffffffd5 ffffffd2 00 2d 29 4b ffffff96 ffffffc3 4d ffffffc5 7d 29 7e 
```

为什么有这么多`fffff`用于`mesg_check`？

这种现象有什么潜在的原因吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-04T23:58:51.027

这是一个小程序，说明了我*认为*您可能遇到的问题：

```
#include <stdio.h>
int main(void) {
    char arr[] = { 0, 16, 127, 128, 255 };
    for (int i = 0; i < sizeof arr; i ++) {
        printf(" %2x", arr[i]);
    }
    putchar('\n');
    return 0;
} 
```

在我的系统上（在其`char`上签名），我得到这个输出：

```
 0 10 7f ffffff80 ffffffff 
```

值`255`，当存储在 (signed)`char`中时，存储为`-1`。在`printf`调用中，它被提升为 (signed) `int`- 但`"%2x"`格式告诉`printf`将其视为`unsigned int`，因此它显示`fffffffff`。

确保您的`mesg`和`mesg_check`数组被定义为数组`unsigned char`，而不是普通数组`char`。

**更新：**一年多后重读这个答案，我意识到它不太正确。这是一个可以在我的系统上正常运行的程序，并且几乎肯定可以在任何合理的系统上运行：

```
#include <stdio.h>
int main(void) {
    unsigned char arr[] = { 0, 16, 127, 128, 255 };
    for (int i = 0; i < sizeof arr; i ++) {
        printf(" %02x", arr[i]);
    }
    putchar('\n');
    return 0;
} 
```

输出是：

```
 00 10 7f 80 ff 
```

type 的参数`unsigned char`被提升为 (signed) `int`（假设它`int`可以保存所有类型的值`unsigned char`，即 ，`INT_MAX >= UCHAR_MAX`实际上在所有系统上都是这种情况）。所以参数`arr[i]`被提升为`int`，而`" %02x"`格式需要一个类型的参数`unsigned int`。

C 标准强烈暗示，但没有*完全*直接说明，相应的有符号和无符号类型的参数是可以互换的，只要它们在这两种类型的范围内——这里就是这种情况。

为了*完全*正确，您需要确保参数实际上是 type `unsigned int`：

```
printf("%02x", (unsigned)arr[i]); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-04-14T04:36:28.937

是的，始终以十六进制格式将字符串打印为：

```
for(i=0; till string length; i++)
    printf("%02X", (unsigned char)str[i]); 
```

当您尝试一次打印整个字符串时，如果字符串的格式不是*'unsigned char' ，则在使用**'unsigned char'*的字符一个字符地打印十六进制字符串时，会出现错误。

# javascript - 超过请求动画帧最大调用堆栈的绘图？

> ID：15823601
> 
> 赞同：2
> 
> 时间：2013-04-04T23:40:30.197
> 
> 标签：javascript, html, canvas

我正在制作自己的小画布库，因为我有时间消磨时间并尝试为画布对象设置动画，该方法目前看起来像这样；

```
proto.update = function () {

    for (var i = 0; i < this.objects.length; ++i) {

        this.objects[i].draw(this.context);
    }

    var self = this;

    requestAnimationFrame(self.update());
}; 
```

我以前没有使用`requestAnimationFrame`过，我收到一条错误消息，说**超出了最大调用堆栈**。

我遵循本教程[http://creativejs.com/resources/requestanimationframe/](http://creativejs.com/resources/requestanimationframe/)并且很确定我没有犯任何错误。

我做错什么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:06:14.530

传递给的回调参数`requestAnimationFrame`应该是对下一次重绘时要调用的函数的引用（请参阅[此处](https://developer.mozilla.org/en-US/docs/DOM/window.requestAnimationFrame)的文档）。您的错误是您在函数名称后包含了括号，这意味着它立即执行导致递归循环。

尝试按如下方式更新您的代码：

```
proto.update = function () {

    for (var i = 0; i < this.objects.length; ++i) {

        this.objects[i].draw(this.context);
    }

    var self = this;

    // Pass the function reference don't call it
    requestAnimationFrame(self.update);
}; 
```

# javascript - 无法使用选择器选择 Google 的自动完成建议元素？

> ID：15823614
> 
> 赞同：0
> 
> 时间：2013-04-04T23:41:55.953
> 
> 标签：javascript, autocomplete

我今天一直在和谷歌打架。我在 ID 为“locationsearch”的输入字段上有一个功能齐全的自动完成功能。

我想要的是能够从谷歌的自动完成中获取建议，但似乎我什至无法选择谷歌用来填充建议的“.pac-container”类。

我的代码是这样的：

```
<!DOCTYPE html>
<html>
<head>
   <meta charset="utf-8" />
   <script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?libraries=places&sensor=false&language=se"></script>
   <script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
   <script>

   function init() {

      // Make autocomplete
      var input = document.getElementById("locationsearch");
      var options = { componentRestrictions: {country: 'se'} };
      var autocomplete = new google.maps.places.Autocomplete(input, options);

      // Try to see if we can click on Google's suggestion list
      $(".pac-container").on("click", function(){
         alert("clicked on pac");
      });

   }
   google.maps.event.addDomListener(window, 'load', init);

   </script>
</head>
<body><input id="locationsearch" type="text" onchange=""></input></body>
</html> 
```

关于为什么这不起作用的任何想法？

# meteor - 服务器上未捕获的 TypeError 但在客户端上有效

> ID：15823616
> 
> 赞同：1
> 
> 时间：2013-04-04T23:41:58.047
> 
> 标签：meteor

当我运行这个：

```
 var vtop=Posts.findOne({},{sort: {created_at:-1},reactive:false}).created_at;
  console.log(vtop); 
```

它出现了一个错误：“Uncaught TypeError: Cannot read property 'created_at' of undefined”，但是当我`Posts.findOne({},{sort: {created_at:-1},reactive:false}).created_at;`在 Web 控制台上运行时，它会出现预期的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T02:24:20.800

我会在该行代码处设置一个断点，并在您的 JavaScript 引擎即将运行它时查看您的 Posts 集合中的内容。我的猜测是您的 Posts 集合在遇到该行代码*后*正在加载文档。当您使用 Web 控制台检查时它起作用的原因是因为此时文档已被加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T07:36:46.773

在调用数据之前，您需要确保您的订阅已完成。

流星数据是通过网络发送的，所以当你的 javascript/html 被发送时，浏览器还没有被告知从服务器下载数据。

有两种方法可以解决这个问题：

如果您尚未达到在应用中使用订阅的阶段，您可以使用 Deps.autorun

**使用部门**

```
Deps.autorun(function() {
    var subscribed = Session.equals("subscribed",true);
    if(!subscribed && Posts.find().count()) {
        Session.set("subscribed",true);

        var vtop = Posts.findOne({},{sort: {created_at:-1},reactive:false}).created_at;
        console.log(vtop)
    } 
```

**或等待订阅完成**

*服务器js*

```
Meteor.publish("posts", function() {
    return Posts.find();
} 
```

*客户端js*

```
Meteor.subscribe("posts",function() {
    var vtop = Posts.findOne({},{sort: {created_at:-1},reactive:false}).created_at;
    console.log(vtop)
}); 
```

如果使用发布/订阅，您需要删除`autopublish`包，但如果这样做，您还需要发布您的其他集合，否则浏览器将看不到它们。

有关如何使用发布的更多信息，请参阅文档：[http ://docs.meteor.com/#publishandsubscribe](http://docs.meteor.com/#publishandsubscribe)

各方示例也使用发布并有一个截屏：http: [//meteor.com/examples/parties](http://meteor.com/examples/parties)

# php - Magento：使用 Zend Barcode 和 Zend PDF 打印发票上的条形码

> ID：15823617
> 
> 赞同：1
> 
> 时间：2013-04-04T23:42:00.540
> 
> 标签：php, magento, zend-framework

我正在尝试在从 Zend PDF 生成的 Magento 发票上获取从 Zend Barcode 呈现的条形码

我的独立测试条形码脚本看起来像这样，并将生成一个带有条形码和文本“测试”的 PDF 文档。

```
$pdf = new Zend_Pdf();
$page = new Zend_Pdf_Page(Zend_Pdf_Page::SIZE_A4);
$page->setFont(Zend_Pdf_Font::fontWithName(Zend_Pdf_Font::FONT_HELVETICA), 20);

//$font = Zend_Pdf_Font::fontWithName(Zend_Pdf_Font::FONT_TIMES_ROMAN);
Zend_Barcode::setBarcodeFont('gothic.ttf');

$filename= 'barcode.pdf';

$barCodeNo = '99700161BST004008501022006714';

$barcodeOptions = array(
    'text' => $barCodeNo, 
    'barHeight'=> 74, 
    'factor'=>3.98,
    //'fontSize' =>20, 
    //'drawText'=> false
);

$rendererOptions = array();
$renderer = Zend_Barcode::factory(
    'code128', 'pdf', $barcodeOptions, $rendererOptions
)->setResource($pdf, $page)->draw();

$page->drawText('Test', 25, 720, 'UTF-8');

$pdf->pages[] = $page;
$pdf->save($filename); 
```

Magento 发票 PDF 是这样启动的。

```
 $pdf = new Zend_Pdf();
        $this->_setPdf($pdf);
        $style = new Zend_Pdf_Style();
        $this->_setFontBold($style, 10);

        foreach ($invoices as $invoice) {
            if ($invoice->getStoreId()) {
                Mage::app()->getLocale()->emulate($invoice->getStoreId());
                Mage::app()->setCurrentStore($invoice->getStoreId());
            }
            $page = $pdf->newPage(Zend_Pdf_Page::SIZE_A4);
            $pdf->pages[] = $page;

            $order = $invoice->getOrder();

            /* Add image */
            $this->insertLogo($page, $invoice->getStore()); 
```

.../* 继续建造发票 */...

修改后的条码脚本被插入到一些项目下方，如下所示。

```
 /* Start Barcode */
                $page->setFont(Zend_Pdf_Font::fontWithName(Zend_Pdf_Font::FONT_HELVETICA), 20);
                Zend_Barcode::setBarcodeFont('/srv/magento/media/fonts/gothic.ttf');

                $barcodeOptions = array(
                    'text' => $trackingNumber, 
                    'barHeight'=> 74, 
                    'factor'=>3.98
                );

                $rendererOptions = array('height'=> 800,'width'=> 800);
                $renderer = Zend_Barcode::factory(
                    'code128', 'pdf', $barcodeOptions, $rendererOptions
                )->setResource($pdf, $page)->draw();

    /* End Barcode */ 
```

但是，在 Magento 发票 PDF 文档中运行时，它会返回错误 Call to a member function getHeight() on a non-object in lib/Zend/Barcode/Renderer/Pdf.php 第 124 行。

第 124 行包含

```
protected function _initRenderer()
{
    if ($this->_resource === null) {
        $this->_resource = new Zend_Pdf();
        $this->_resource->pages[] = new Zend_Pdf_Page(
            Zend_Pdf_Page::SIZE_A4
        );
    }

    $pdfPage = $this->_resource->pages[$this->_page];
    $this->_adjustPosition($pdfPage->getHeight(), $pdfPage->getWidth());
} 
```

这似乎是在请求 pdfPage 高度，但我不明白为什么它只会在我放入我的条形码脚本时失败和/或为什么 pdfPage->getHeight 会在那里失败。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-06T11:46:49.683

我遇到了同样的问题。问题出在下面的代码中：

```
$renderer = Zend_Barcode::factory('code128', 'pdf', $barcodeOptions, 
                $rendererOptions)->setResource($pdf, $page)->draw(); 
```

您提供给 serResource 的 $page 变量是一个实际的 pdf 页面。它应该是页码。例如，下面的代码将在第一页绘制条形码。只需根据您的需要更改 $pageNo 即可。

```
/* Start Barcode */
            $page->setFont(Zend_Pdf_Font::fontWithName(Zend_Pdf_Font::FONT_HELVETICA), 20);
            Zend_Barcode::setBarcodeFont('/srv/magento/media/fonts/gothic.ttf');

            $barcodeOptions = array(
                'text' => $trackingNumber, 
                'barHeight'=> 74, 
                'factor'=>3.98
            );
            $pageNo = 0;
            $rendererOptions = array('height'=> 800,'width'=> 800);
            $renderer = Zend_Barcode::factory(
                'code128', 'pdf', $barcodeOptions, $rendererOptions
            )->setResource($pdf, $pageNo)->draw();

/* End Barcode */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-15T22:31:23.860

我的解决方案是分离流程，而不是在创建 pdf 期间自动创建条形码。在将条形码编号导入 Magento 时，我创建了条形码图像并保存到以条形码编号作为文件名的目录中。然后在 PDF 创建期间，我使用`$page->drawImage()`并通过名称/条形码从目录中调用图像。

# ruby-on-rails - 为什么我的 HAML 命名路由为空？

> ID：15823618
> 
> 赞同：0
> 
> 时间：2013-04-04T23:42:08.667
> 
> 标签：ruby-on-rails, ruby, haml, link-to

我正在尝试在 HAML 中创建一些页面，这些页面部分有效。除了一件事之外，它生成的 HTML 是正确的。我在哪里：

```
%ul#menu 
  %li 
    = link_to 'Home', root_url 
```

我期待回来：

```
<a href="/">Home</a> 
```

相反，它正在生产：

```
<a href>Home</a> 
```

进一步研究后，似乎我所有的命名路由都只是返回一个空白字符串，而不是它们打算的路由。这发生在所有人身上，而不仅仅是根。

如果我尝试将其更改为虚构的名称，例如“test_path”，那么正如我所料，我会收到一条错误消息，指出该方法不存在，所以这不是找不到它的情况，它只是不返回任何东西。

在 Rails 控制台中，我能够获得正确的路线，因此我知道它正在工作，并`rake routes`给了我：

```
about        /about(.:format)                   welcome#about
contact      /contact(.:format)                 welcome#contact
faq          /faq(.:format)                     welcome#faq
plans        /plans(.:format)                   welcome#plans
root         /                                  welcome#index 
```

任何人都可以提供帮助，因为这是一个非常重要的问题，如果我无法生成任何内容的链接，则很难继续开发

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:13:44.767

好的，我知道它是什么了。

我正在开发的应用程序为组织使用 BaseCamp 样式的子域。

在 Railscast [#221 Subdomains in Rails 3](http://railscasts.com/episodes/221-subdomains-in-rails-3)中实现子域之后，我创建了`url_for`如图所示的方法，但是只是错过了`super`关键字，因此它永远不会生成 URL。

# eclipse - 在颠覆性的 Eclipse 插件中，您如何只接受我的更改？

> ID：15823620
> 
> 赞同：0
> 
> 时间：2013-04-04T23:42:39.997
> 
> 标签：eclipse, svn, subversive

当我遇到冲突时，我可以做

*覆盖和更新，以获取传入的更改

如何让它接受我的更改并忽略传入的更改？

“覆盖并提交”实际上试图提交，我当时不想这样做。

使用 svn 命令行客户端，上面很简单

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T07:54:29.923

选择`Mark as merged`要在其中使用本地版本的文件。

# python - arcpy.CalculateField 上的“需要值”

> ID：15823621
> 
> 赞同：2
> 
> 时间：2013-04-04T23:42:41.940
> 
> 标签：python, arcpy

我对 Python 很陌生，正在尝试编写一个用于 ArcGIS 10.1 (arcpy) 的脚本；基本思想是添加一个新字段（francis），检查其他几个字段中的值，如果有的话为空（-99）然后输出 0 到 Francis，否则运行一个简单的计算。但是，我得到了这个错误和我无法超越它：

> 回溯（最近一次通话最后）：
> 
> 文件“C:\gislab2\Python\take_home\part1\prelim_if2.py”，第 28 行，在 arcpy.CalculateField_management(Output_Feature_Class, "Francis", "", "PYTHON_9.3", "")
> 
> 文件“C:\Program Files\ArcGIS\Desktop10.1\arcpy\arcpy\management.py”，第 3128 行，在 CalculateField raise e
> 
> ExecuteError：执行失败。参数无效。错误 000735：表达式：需要值 执行失败 (CalculateField)。

这是代码

```
# Import arcpy module
import arcpy

print "start your engines"
# Script arguments
Shapefile = "C:\\gislab2\\Python\\take_home\\USCancer2000.shp"

Field_Name = Francis

Output_Feature_Class = "C:\\gislab2\\Python\\take_home\\USCancer2000.shp"

# Local variables:
USCancer2000__2_ = Output_Feature_Class

# Process: Add Field
arcpy.AddField_management(Shapefile, "Francis", "LONG", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

# Process: Calculate Field
arcpy.CalculateField_management(Output_Feature_Class, "Francis", "", "PYTHON_9.3", "")
##
### Process: If-then check for missing values
##
if "Cnt1"==-99:
    Field_name=7
elif "Cnt2"==-99:
    Field_name=7
elif "Cnt3"==-99:
    Field_name=7
elif "Pop1"==-99:
    Field_name==7
elif "Pop2"==-99:
    Field_name=7
elif "Pop3"==-99:
    Field_name=7
else:
        Field_name=("Cnt1"+"Cnt2"+"Cnt3")/("Pop1"+"Pop2"+"Pop3")
print "done" 
```

提前谢谢了！大卫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T17:57:40.423

第三个参数`arcpy.CalculateField_management`告诉它要计算什么。你没有在那里传递任何东西。作为测试，将该行替换为 `arcpy.CalculateField_management(Output_Feature_Class, "Francis", 5, "PYTHON_9.3", "")`并查看它是否评估。

成功运行后，您应该考虑使用表达式和代码块来进行所需的计算。[请参阅此处](http://resources.arcgis.com/en/help/main/10.1/index.html#//00170000004m000000)的计算范围（第三个）示例。

**- 选择 -**

[您还可能会发现使用updateCursor](http://resources.arcgis.com/en/help/main/10.1/index.html#//018w00000014000000)更容易。这似乎比使用 calculateField 需要更多的工作，但它可以更快，并且省去了编写复杂代码块的麻烦。

```
# Import arcpy module
import arcpy

print "start your engines"
# Script arguments
Shapefile = "C:\\gislab2\\Python\\take_home\\USCancer2000.shp"

Field_Name = "Francis"

# Process: Add Field
arcpy.AddField_management(Shapefile, "Francis", "LONG", "", "", "", "", "NULLABLE", "NON_REQUIRED", "")

fields = ["Cnt1", "Cnt2", "Cnt3", "Pop1", "Pop2", "Pop3", "Francis"] # the fields you want available to you in the cursor

with arcpy.da.UpdateCursor(shapefile, fields) as cursor:
    for row in cursor: # step through each row
        if not -99 in row: # Check for nulls
            # none found, do the math
            row[6] = (row[0] + row[1] + row[2]) / (row[3] + row[4] + row[5])
        else:
            # nulls found, zero out the result
            row[6] = 0
        cursor.updateRow(row) # save it

print "done" 
```

# javascript - 使用 JavaScript 的动态下拉表单

> ID：15823623
> 
> 赞同：0
> 
> 时间：2013-04-04T23:42:51.457
> 
> 标签：javascript, html, css, forms, cascadingdropdown

我真的很想有一个使用 JavaScript 的下拉表单。我需要它来创建一个问题。工作原理：此人将在主页上单击“创建问题”，然后转到“创建问题”页面。在那个页面上，它问这个人的第一个问题是“你想问什么类型的问题？” 然后，通过几个单选按钮，他们可以选择他们想要的类型，“多项选择”、“选择最佳”或“简答”。从那时起，更多的表格出现了……换句话说，根据他们想问的问题类型，在向服务器提交他们想问的问题之前，要求他们填写一组不同的标准. 这有意义吗？到目前为止，这是我的表格：

```
 <!DOCTYPE html>
    <html>
        <head>
            <title>Quick Bump</title>
            <link href="styles.css" type="text/css" rel="stylesheet" />
        </head>

        <body>
            <div class="center">

            <h1 class="welcomeHeader">Create a Question:</h1>
            <form action="http://www.example.com/profile.php">

            <p class="pStyle">Please select what type of Question you'd like to ask:
                <br />
                <br />
                <input type="radio" name="genre" value="Multiple Choice" checked="checked" /> Multiple Choice
                <input type="radio" name="genre" value="Select the Best" /> Select the Best
                <input type="radio" name="genre" value="Short Answer" /> Short Answer
            </p>
            <br />

            <p class="pStyle">What is your Question?
                <br />
                <br />
                <label>Q:<input type="text" class="resizedTextBox" name="Question" /></label><br />
            </p>
            <br />

            <p class="pStyle">What are the answers available?
                <br />
                <br />
                <label>A:<input type="text" class="resizedTextBox" name="Answer 1" /></label><br />
                <label>B:<input type="text" class="resizedTextBox" name="Answer 2" /></label><br />
                <label>C:<input type="text" class="resizedTextBox" name="Answer 3" /></label><br />
                <label>D:<input type="text" class="resizedTextBox" name="Answer 4" /></label><br />
            </p>
            <br />

            <p class="pStyle">Would you like to submit this question now?</p>
            <input type="submit" class="submitLink" name="submit form" value="Submit" />
        </form>
    </div>
    <br />
    <div class="footer">
        <a href="firstWebPage.html" class="links">Home</a>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:01:24.807

您可以使用 jQuery 在前一个表单元素更改时逐步显示每个连续的段落。

这是一个希望让您入门的示例：http: [//jsfiddle.net/kevincollins/uarZb/](http://jsfiddle.net/kevincollins/uarZb/)

```
$(function () {
    $('.pStyle:first').show();
    $('input[name="genre"]').change(function(){
        $('.pStyle:eq(1)').show();
    });
    $('input[name="Question"]').change(function(){
         $('.pStyle:eq(2)').show();
    });
    $('input[name^="Answer"]').change(function(){
         $('.pStyle:eq(3)').show();
    });
}); 
```

# jquery - 使用 jQuery 在 DataTables 中进行复选框排序

> ID：15823626
> 
> 赞同：8
> 
> 时间：2013-04-04T23:43:36.687
> 
> 标签：jquery, sorting, checkbox, datatable

我一直在尝试对[DataTables](https://www.datatables.net/) jQuery 插件中的复选框字段进行排序以选中和取消选中。

我在表中创建输入（复选框），如下所示：

```
'<input type="checkbox" '+ check +' />' 
```

check 包含文本“checked”或“”。

到目前为止，我只尝试添加 DOM 复选框类型的排序，如下所示：

```
{ "sSortDataType": "dom-checkbox" } 
```

[当我使用插件API 文档](http://datatables.net/examples/plug-ins/dom_sort.html)中的整个代码时，我收到以下错误：

> 未捕获的类型错误：无法在我的控制台中读取未定义的属性“afnSortData”。

**问题**：按下列标题不会通过选中或未选中的复选框对列进行排序。

我想获得有关如何修复上述错误或仅使用 jQuery 和插件方法进行排序的其他方法的建议。

谢谢。

* * *

### 编辑

刚刚尝试使用固定代码 - 没有错误。但是排序搞砸了：它只是相互替换而不是排序。例如：如果我选中了 1 个复选框而没有选中 9 个，则选中的复选框将从第三位切换到第六位，然后再切换到第三位，依此类推。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-13T07:54:13.190

我所做的是在隐藏的 P 中创建一个 bool var，因此它将与复选框在同一个位置。然后我禁用了复选框中更改值的选项，并且排序现在正在工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-05-21T13:12:12.073

我不得不稍微调整提供的答案`Moby's Stunt Double`。无需额外的排序插件！只是一点点自定义编码。

感谢所有的想法，大家！出于某种原因，我不得不对我的桌子进行特殊处理，这不是一般的解决方案。这对我来说很好。

我的复选框被禁用并以编程方式检查，所以我无法调用`.checked`. 基于 iColumn 的调用也把事情搞砸了。可能是因为我有一个隐藏的第 0 列。

这对我有用：

```
$.fn.dataTableExt.afnSortData['dom-checkbox'] = function  ( oSettings, iColumn ) {
    var aData = [];
    $(oSettings.oApi._fnGetTrNodes(oSettings)).each( function () {
        var checker = $(this).find('.classOnSurroundingSpan input');
        aData.push( checker.prop("checked")==true ? "1" : "0" );
    } );
    return aData;
} 
```

我的标记看起来像这样（周围的跨度是启用跟踪[禁用复选框单击](https://stackoverflow.com/q/6781467/469643)的解决方案的一部分）：

```
<span class='classOnSurroundingSpan'><input type='checkbox' disabled='disabled'/></span> 
```

我的表定义是（部分）：

```
"aoColumnDefs": [
    {"sSortDataType": "dom-checkbox",
    "aTargets":[1],
    "asSorting": ["desc"]}
] 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T23:47:00.363

找到了这个例子：

```
$.fn.dataTableExt.afnSortData['dom-checkbox'] = function  ( oSettings, iColumn )
{
    var aData = [];
    $( 'td:eq('+iColumn+') input', oSettings.oApi._fnGetTrNodes(oSettings) ).each( function () {
        aData.push( this.checked==true ? "1" : "0" );
    } );
    return aData;
} 
```

像这样初始化：

```
$(document).ready(function() {
    $('#example').dataTable( {
        "aoColumns": [
            null,
            null,
            null,
            null,
            null,
            { "sSortDataType": "dom-checkbox" }
        ]
    } );
} ); 
```

这里：[http ://www.datatables.net/examples/plug-ins/dom_sort.html](http://www.datatables.net/examples/plug-ins/dom_sort.html)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-11-05T02:13:04.593

这个解决方案对我有用，所以我写了一篇关于它的博客文章。

[http://blog.josephmisiti.com/sorting-booleans-in-jquery-datatables](http://blog.josephmisiti.com/sorting-booleans-in-jquery-datatables)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-01T18:52:42.880

这对我有用：

```
$(document).ready(function() {
    $('#example').dataTable( {
        "aoColumns": [
            null,
            null,
            null,
            null,
            null,
            { "orderDataType": "dom-text", type: 'string' },
        ]
    } );
} ); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-01T05:27:19.303

找到了这个例子：

```
 $.fn.dataTable.ext.order['dom-checkbox'] = function (settings, col) {
    return this.api().column(col, { order: 'index' }).nodes().map(function (td, i) {
        return $('input', td)[1].checked ? '1' : '0';
    });
} 
```

像这样初始化：

```
$(document).ready(function() {
    $('#example').dataTable( {
        "columnDefs": [
                        {
            "targets": 10,
                            "orderDataType": "dom-checkbox"
                        });
} ); 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-01-12T20:33:15.320

这对我有用

```
$(document).ready(function () {
    $('#Table').DataTable({
        "language": datatableLanguaje,
        "aoColumnDefs": [ 
            { "aTargets": [8], "orderDataType": "dom-text", type:'string' },
        ]
    });
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-09-15T18:54:14.823

如果您在复选框元素上有某种唯一标识符，您可以像下面的示例一样做一些非常干净的事情（注意这是一个数据表[排序插件](https://datatables.net/plug-ins/sorting/)语法）

如果您的输入如下所示：

```
<input data-app-id="1" class="migrateCheck" type="checkbox"> 
```

该插件看起来像：

```
function checkboxCompare(a, b) {
    var aId = $(a).data('app-id'),
        bId = $(b).data('app-id'),
        aChecked = $('.migrateCheck[data-app-id=' + aId + ']:checked').length,
        bChecked = $('.migrateCheck[data-app-id=' + bId + ']:checked').length;

    if (aChecked && !bChecked) return -1;
    else if (!aChecked && bChecked) return 1;

    return 0;
}

jQuery.extend(jQuery.fn.dataTableExt.oSort, {
    "checkbox-pre": function (a) {
        return a;
    },

    "checkbox-asc": function (a, b) {
        return checkboxCompare(a, b);
    },

    "checkbox-desc": function (a, b) {
        return checkboxCompare(b, a);
    }
}); 
```

然后只需在包含复选框的 col`sType: "checkbox"`的 attr 上指定。`aoColumnDefs`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-09-27T14:58:37.037

任何东西都可以通过一些简单的 html 进行排序。

```
$('#table input[type=checkbox]').each(function () {
    var text = $(this).prop('checked');
    var ele = $('<span>' + text + '</span>').hide();
    $(this).after(ele);
}); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-03-18T02:10:05.060

这让我有点难过。

我使用了标准插件代码[https://datatables.net/plug-ins/sorting/custom-data-source/dom-checkbox](https://datatables.net/plug-ins/sorting/custom-data-source/dom-checkbox)：

```
$.fn.dataTable.ext.order['dom-checkbox'] = function  ( settings, col )
{
    return this.api().column( col, {order:'index'} ).nodes().map( function ( td, i ) {
        return $('input', td).prop('checked') ? '1' : '0';
    } );
}; 
```

您需要指定“dom-checkbox”列类型是可排序的：

```
$('#myTable').dataTable({
    "aoColumnDefs": [
        { "bSortable": false, "aTargets": [ "action" ] },
        { "sSortDataType": "dom-checkbox", "aTargets": [ "enabled" ] }
    ],
    "aaSorting": [
        [ 3, "desc" ]
    ]
}); 
```

在视图中，我启用 CheckBox 列以将复选框放入（不绑定到 col 编号）：

```
<th class="enabled">Enabled</th> 
```

# php - PHP Minecraft 投票者

> ID：15823627
> 
> 赞同：0
> 
> 时间：2013-04-04T23:44:00.597
> 
> 标签：php, minecraft, bukkit

我正在尽我最大的努力让这件事正常工作，但我不知道为什么我的世界服务器控制台给了我：05.04 01:40:29 [Server] INFO /212.1.212.1:58215 lost connection

我的代码php函数：

```
function Votifier($public_key, $server_ip, $server_port, $username)
{
//pharse the public key
$public_key2 = wordwrap($public_key, 65, "\n", true);
$public_key = <<<EOF
-----BEGIN PUBLIC KEY-----
$public_key2
-----END PUBLIC KEY-----
EOF;
//get user IP
$address = $_SERVER['REMOTE_ADDR'];
//set voting time
$timeStamp = time();

//create basic required string for Votifier
$string = "VOTE\nTest\n$username\n$address\n$timeStamp\n";

//fill blanks to make packet lenght 256
$leftover = (256 - strlen($string)) / 2;
while ($leftover > 0) {
$string.= "\x0";
$leftover--;
}

//encrypt string before send
openssl_public_encrypt($string,$crypted,$public_key);

//try to connect to server
$socket = fsockopen($server_ip, $server_port, $errno, $errstr, 3);
if ($socket)
{
var_dump(fwrite($socket, $crypted)); //on success send encrypted packet to server
}
else
return false; //on fail return false
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:53:16.400

尝试使用 phpseclib ( [http://phpseclib.sourceforge.net/](http://phpseclib.sourceforge.net/) )。这里有一个关于如何使用私钥/公钥的示例：http: [//phpseclib.sourceforge.net/ssh/examples.html#rsakey](http://phpseclib.sourceforge.net/ssh/examples.html#rsakey)。然后，您可以像这样使用交互式 shell：

```
<?php
include('Net/SSH2.php');
include('Crypt/RSA.php');

$ssh = new Net_SSH2('www.domain.tld');
$key = new Crypt_RSA();
$key->loadKey(file_get_contents('privatekey'));
if (!$ssh->login('username', $key)) {
    exit('Login Failed');
}

echo $ssh->read('username@username:~$');
$ssh->write("ls -la\n");
echo $ssh->read('username@username:~$');
?> 
```

# sql - SQL 学生数据库

> ID：15823640
> 
> 赞同：0
> 
> 时间：2013-04-04T23:45:18.090
> 
> 标签：sql, count

我很难在一个学生正在学习的列中显示班级数量。

我有以下查询，但我不确定 COUNT 到底是什么计数以及如何显示每个学生的计数：

```
CREATE VIEW Busy_Student AS
SELECT First_Name, Last_Name, Student.Student_ID
FROM Student 
INNER JOIN Enrollment ON Enrollment.Student_ID= Student.Student_ID
GROUP BY Student.Student_ID, Student.First_Name, Student.Last_Name 
HAVING COUNT(*) > 2 
```

创建一个视图调用 BUSY_STUDENT，它存储连接的名称（名字和姓氏）、学生 ID 和注册的班级数量，用于注册超过 2 个班级的所有学生。分别命名这些列，FULL_NAME、STUDENT_ID 和 ENROLL_NUM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:01:50.710

你的 SELECT 语句应该是这样的：

```
SELECT First_Name + ' ' + Last_Name AS [FULL_NAME],
Student.Student_ID, COUNT(*) AS [ENROL_NUM]
FROM Student 
INNER JOIN Enrollment ON Enrollment.Student_ID= Student.Student_ID
GROUP BY Student.Student_ID, Student.First_Name, Student.Last_Name 
HAVING COUNT(*) > 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:11:38.747

你非常接近它：

```
CREATE VIEW Busy_Student AS
SELECT
    CONCAT(First_Name, ' ', Last_Name) AS FULL_NAME,
    Student.Student_ID AS STUDENT_ID,
    COUNT(Enrollment.Enrollment_id) AS ENROLL_NUM
FROM Student 
INNER JOIN Enrollment USING(Student_ID)
GROUP BY Student.Student_ID
HAVING ENROLL_NUM > 2 
```

计数是根据`Enrollment`与学生 ID 匹配的行数进行的。由于您只给出了内部连接列，因此我假设每个注册都由该列唯一标识`Enrollment_id`。您应该根据您的架构调整该列名。

利用

```
First_Name + ' ' + Last_Name AS FULL_NAME 
```

对于 SQL 服务器。

# html - SVG 明显被剪裁，但我仍然看到滚动条 - 裁剪 SVG

> ID：15823650
> 
> 赞同：0
> 
> 时间：2013-04-04T23:46:52.423
> 
> 标签：html, browser, svg, rendering

如果我有一个超出 SVG 大小的 SVG 元素，我的浏览器中会出现滚动条。我想将 SVG 控件拉伸为可见区域的大小，并且我不希望部分可见的元素导致滚动条出现在页面上。

我把它提炼成一个简单的例子。这是我的 HTML 文档正文中的内容：

```
<svg width="200" height="200">
    <defs>
        <clipPath id="clippath">
            <rect x="0" y="0" width="200" height="200" />
        </clipPath>
    </defs>
    <g clip-path="url(#clippath)">
        <rect x="100" y="50" width="2000" height="50" style="stroke: red; stroke-width: 5; fill: lightblue" />
    </g>
</svg> 
```

如您所见，SVG 元素被定义为 200x200，并且明显裁剪为 200x200。但是，当您在浏览器中打开它时，您会看到一个滚动条，因为矩形超出了 SVG 元素的末端并离开了页面。

如何摆脱滚动条？本质上，我想将 SVG 裁剪到剪辑路径。

更新：这似乎只是 IE 中的一个问题。Firefox 和 Chrome 以我喜欢的方式呈现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T16:29:58.813

与 CSS 属性几乎相同，您应该可以使用 overflow:hidden;

正如您所注意到的，在这种情况下`<svg>`它将是内联的并显示为溢出=隐藏。

# css - CSS3 变换 - 旋转和字体消失

> ID：15823651
> 
> 赞同：1
> 
> 时间：2013-04-04T23:46:54.807
> 
> 标签：css, fonts, rotation, transform

我在 html 元素上使用了这个简单的 css3 转换规则（其中包含许多其他元素，如 h1、h2、inputs 和 img）：

```
 div{ 
  -moz-transform: scale(1) rotate(-3deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);
    -webkit-transform: scale(1) rotate(-3deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);
    -o-transform: scale(1) rotate(-3deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);
    -ms-transform: scale(1) rotate(-3deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);
    transform: scale(1) rotate(-3deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); 

 } 
```

问题是字体是skretched，你可以看到这怎么可能？

检查图像： ![在此处输入图像描述](https://i.stack.imgur.com/KL9AY.png)

在使用旋转 css3 时，有什么方法/技巧可以将字体修复为不 skrech 或变得如此糟糕？

**注意**：为了避免“它看起来不错”之类的评论：D 请仔细检查单词的字符是否垂直对齐，例如检查单词**Quale**的**l**和**e**字符

在 Chrome 中我没有问题，只有 Firefox 似乎在旋转字体时出现问题:(

> 正如我所看到的，只有当是大尺寸字体时字体才可以，我的意思是，字体大小：30px 及更多，如果我低于 30px，字体就不行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:00:55.013

两天前我读到，不同的 Chrome 浏览器可能会使用和不使用`-webkit-`.

**更新：**

我在 Chrome 中也有这个问题。渲染输出清晰且未对齐（如您的图片中所示）。所以我刚刚尝试应用（在 Chrome 中）`-webkit-filter: opacity(0.999);`，或者`-webkit-filter: blur(0px);`它的字体不是那么清晰，它的渲染和对齐都很好，但在这两种情况下都有点模糊。奇怪的。我认为这适用于任何过滤器。

在 Firefox 的情况下，`-moz-filter`它不起作用，所以我找到了这个解决方案，它给出了与`-webkit-filter`Chrome 相同的结果：

```
filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); 
```

中的数字`values`是矩阵

```
1 0 0 0 0 
0 1 0 0 0
0 0 1 0 0 
0 0 0 1 0 
```

这是旋转和使用过滤器后FF中的屏幕截图。

![在此处输入图像描述](https://i.stack.imgur.com/AuYnt.jpg)

全屏：http: [//i.imgur.com/tUAd1B2.jpg](https://i.imgur.com/tUAd1B2.jpg)

这是[现场示例](http://jsfiddle.net/NKgHW/)（适用于 Chrome 和 FF）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T23:52:10.180

它可以根据您的互联网浏览器而改变。以我的经验，Firefox 处理旋转最好。Chrome 会弄乱文本，IE 有很多错误。

您可以尝试使用 Javascript 进行旋转，但这比 CSS 转换要复杂一些。[https://code.google.com/p/jquery-rotate/](https://code.google.com/p/jquery-rotate/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T23:53:05.140

:-) 我明白了，你是对的。好吧，我想说，这只是一个渲染问题。我猜你从 3 个不同的浏览器中得到 4 个不同的输出（就像通常的转换一样）。;-)

有时可行的唯一解决方案是强制使用 3d 模式：

```
input{ transform:rotate(-3deg), translate3d(0, 0, 0); } 
```

但也许它在这里什么都不做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T00:00:45.257

您是否尝试过为输入创建父 div 并旋转它而不是旋转输入？

# asp.net-mvc - ASP MVC3 - ActionLink 未正确路由到控制器

> ID：15823653
> 
> 赞同：0
> 
> 时间：2013-04-04T23:47:01.800
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2

下面是我在 ASP MVC3 视图中使用的操作链接。我需要控制器中的一个方法并发送两个变量。这些变量用作控制器方法试图从中提取信息的 SQL 表上的复合键。

该链接似乎由 正确呈现`@Html.ActionLink`，但是我收到此错误：

`Description: HTTP 404\. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable. Please review the following URL and make sure that it is spelled correctly.`

`Requested URL: /BankListMasterController/AgentEdit/11`

这是动作链接

```
@Html.ActionLink("Edit Agent", "AgentEdit", "BankListMasterController",
                                            new { agentId = int.Parse(item.AgentId), id = item.ID }, null) 
```

这是控制器方法

```
 public ViewResult AgentEdit(int id, int agentId)
    {
        string compare = agentId.ToString();

        BankListAgentId agent = (from c in db.BankListAgentId
                                 where c.ID == id &&
                                       c.AgentId.Equals(compare)
                                 select c).Single();

        return View("AgentEdit", agent);
    } 
```

这是在原始视图中呈现的 URL

```
http://localhost:2574/BankListMasterController/AgentEdit/11?agentId=5309721 
```

我还在方法的第一行放置了一个断点，并且在调试时它永远不会被绊倒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:51:50.757

您不需要在第三个参数中包含“控制器”。

尝试：

```
@Html.ActionLink("Edit Agent", "AgentEdit", "BankListMaster", new { agentId = int.Parse(item.AgentId), id = item.ID }, null) 
```

# java - Java 中的 Mandelbrot 设置无法正确计算

> ID：15823654
> 
> 赞同：0
> 
> 时间：2013-04-04T23:47:05.470
> 
> 标签：java, awt, graphics2d, java-2d, mandelbrot

我对 Java 还是比较陌生。我一直在研究一个显示曼德布罗集的程序。我当前的代码生成了一个接近的图像，但不完全是 mandelbrot 集。这是我的生成代码：

```
private void generateMap () {
    // scale, ITERATIONS, map, and SIZE are class variables
    // cR and cI are the actual coordinates in the set being used
    double cR = -2*scale;
    double cI = -2*scale;
    // a and b step through the array used to store the drawing
    // and control when the loop exits
    for (int a = 0; a < SIZE.width; a++) 
    {
        for (int b = 0; b < SIZE.height; b++) 
        {
            double xR = 0;
            double xI = 0;
            int iter = 0;
            while (iter < ITERATIONS) 
            {
                xR = (xR*xR-xI*xI) + cR;
                xI = (2*xR*xI) + cI;
                if (xR*xR+xI*xI > 4) {
                    map[a][b] = iter;
                    iter = ITERATIONS;
                }
                iter++;
            }
            cI += INCREMENT*scale;
        }
        cI = -2*scale;
        cR += INCREMENT*scale;
    }
} 
```

我的 netbeans 项目可以从[这里](https://dl.dropbox.com/u/30169524/stackoverflow/Mandelbrot.zip)下载。

这是当前输出的屏幕截图： ![截屏](https://dl.dropbox.com/u/30169524/stackoverflow/Screen%20Shot%202013-04-04%20at%206.26.41%20PM.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T01:47:36.270

xR 和 xI 的新值的计算不一致。xR 是根据其先前的值计算的，而 xI 是根据 xR 的新值计算的。尝试以下类似的方法，或者使用复数类。

```
double r = xR;
double i = xI;
xR = (r*r-i*i) + cR;
xI = (2*r*i) + cI; 
```

# javascript - 如何交换表中的两组行

> ID：15823658
> 
> 赞同：1
> 
> 时间：2013-04-04T23:47:14.550
> 
> 标签：javascript, jquery, html-table

我在选择的表中有两组行：

```
var slice1 = $( table ).children( "tr" ).slice( i - rowsPerItem, i );
var slice2 = $( table ).children( "tr" ).slice( i, i + rowsPerItem ); 
```

我可以使用 css 突出显示并验证正确的行。现在我想将它们在父表中的位置作为一组交换。它们两个集合在表中总是一个接一个，并且包含相同的行数。

我尝试过的所有东西都只移动了一行：

```
$( slice1 ).after( slice2[slice2.length-1] ); 
```

如何以相同的顺序将集合或行保持在一起，但交换它们在表格中的位置？

这是我所看到的一个例子：http: [//jsfiddle.net/5vBfA/](http://jsfiddle.net/5vBfA/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:55:04.533

尝试使用`insertAfter`方法：

```
$("#SwapButton").click(function () {
    var i = 2;
    var rowsPerItem = 2;
    var $tr = $("#TheTable").find('tr');

    var $slice1 = $tr.slice(i - rowsPerItem, i);
    var $slice2 = $tr.slice(i, i + rowsPerItem);

    $slice1.insertAfter($slice2[$slice2.length - 1]);
}); 
```

[http://jsfiddle.net/P2vSK/1/](http://jsfiddle.net/P2vSK/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:52:21.103

你试过这个吗？

```
$(".anyOtherTableRow").after(slice1).after(slice2); 
```

# c# - 为什么本地复制的aspx/cs项目不起作用？

> ID：15823664
> 
> 赞同：-1
> 
> 时间：2013-04-04T23:47:32.523
> 
> 标签：c#, asp.net

为什么本地复制的aspx/cs项目不起作用？

我已经从服务器上复制了 aspx/cs 项目，并将所有代码直接放入我的本地主机区域。我在visual studio中打开了csproj文件，没有问题我运行它并且它没有崩溃。但它所做的就是这个。它说 Internet Explorer 无法显示该页面。有任何想法吗？

我已经进行了重建，但仍然失败。（好消息是没有编译错误）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:53:10.623

您需要 IIS 或 IIS Express 来运行这些页面。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-05T00:10:13.017

我想我得到了答案。

单步执行代码。

如果你走到这一步，源代码中有一些东西将 url 重新定义为 https 而不是 http，并且在调试/本地主机模式下会弄乱浏览器显示。

# c# - Solrnet 未找到 SolrField 属性

> ID：15823665
> 
> 赞同：2
> 
> 时间：2013-04-04T23:47:43.197
> 
> 标签：c#, solr, attributes, solrnet

我目前正在尝试将 Solrnet 与我正在从事的项目集成，我什至无法让 Solrnet 从填充的 POCO 生成文档。下面是我正在使用的 POCO 的示例

```
public class Person : ICustomInterface
{
    [SolrField("text")]
    public string ContactNumber { get; set; }

    [SolrField("text")]
    public string ContactFax { get; set; }

    [SolrField("text")]
    public string ContactEmail { get; set; }
    [SolrField("text")]
    public string FamilyName { get; set; }
    [SolrField("text")]
    public string GivenName { get; set; }
    [SolrField("text")]
    public string MiddleName { get; set; }
    [SolrField("text")]
    public string Title { get; set; }
    [SolrField("text")]
    public string Gender { get; set; }
    [SolrField("text")]
    public string PlaceOfBirth { get; set; }
    [SolrField("text")]
    public string CountryOfBirth { get; set; }

    [SolrUniqueKey("id")]
    public string Id { get; set; }
} 
```

在尝试使用以下代码对上述内容进行索引之前，我正在调用 init 函数。

```
Startup.Init<Person>("http://localhost:8080/solr-4.1.0"); 
```

然后我调用以下命令来尝试索引该对象。

```
var solr = ServiceLocator.Current.GetInstance<ISolrOperations<Person>>();
solr.Add(mypoco);
solr.Commit(); 
```

'solr.Add(person)' 上的错误是：“文档缺少必需的 uniqueKey 字段：id”。查看正在发送的 http 请求，这是有道理的，请求的主体是 : `<add><doc /></add>`。

似乎没有任何字段被选中。进一步研究，“AttributesMappingManager”返回 0 个结果。方法如下，并评论了我从“GetPropertiesWithAttribute”看到的结果。

```
var props = type.GetProperties(BindingFlags.Instance | BindingFlags.Public); //returns properties correctly
var kvAttrs = props.Select(prop => new KeyValuePair<PropertyInfo, T[]>(prop, type.GetCustomAttributes<T>())); // correct number of keys of properties with Solrnet attributes, but values are empty
var propsAttrs = kvAttrs.Where(kv => kv.Value.Length > 0); // 0 results
return propsAttrs; // 0 results 
```

我已经尝试将其分解为一个测试项目，但仍然遇到同样的问题。我已经尝试过使用和不使用界面，但仍然没有运气。我可能错过了一些*非常*简单的东西，但很想知道它是什么。

注意：我使用的是[github 存储库中最新版本的 Solrnet](https://github.com/mausch/SolrNet "github solrnet 存储库")

**更新** 测试了“SampleSolrApp”解决方案，修复了一些引用（在“HomeController.cs”中找不到 SolrNet.DSL，SolrNet.DSL 引用似乎丢失，从编译的 github repo 添加了引用），示例似乎正确初始化，通过`AddInitialDocuments()`Application_Start上的方法发布“exampledocs” 。但是，在我收到错误“字典中不存在给定的键”后不久，这很有效。在“HtmlHelperMapperExtensions.cs”中。“产品”对象*确实*具有正确的属性，以及映射器正在寻找的字段名称，但找不到任何字段（在这种情况下为“猫”）。这符合我遇到的问题，因为它没有为 solr 构建有效的 http 请求，因为它似乎找不到 SolrField 属性。

打算在另一台 PC 上测试样本，看看这个问题是否与我的开发环境有关。任何意见或建议将不胜感激。

**更新 2** 在另一个开发环境中测试，我得到了同样的错误。因此，*即使在示例*`GetCustomAttributes`中，扩展方法似乎也没有返回 pocos 上的属性。我在 VS 2012（.net 4.5，在示例项目中针对 3.5）上运行示例，在 Win7 机器上运行 IIS Express。希望有人能指出我正确的方向以进行进一步的调查。

 ** * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T02:14:25.433

首先，不确定为什么会收到“文档缺少必需的 uniqueKey 字段：id”错误，因为您似乎已经适当地修饰了您的 Id 属性。由于您没有展示如何创建`mypoco`对象，我会检查您是否正在设置 Id 属性（因为需要提供 Id（并且是唯一的），因为 Solr 不会自动分配）。另外，我注意到您正在将所有其他字段映射到`text`架构中的字段。这不是完成此行为的标准做法。您通常会将 POCO 上的每个属性映射到架构中的单独字段（有关示例，请参见 SolrNet 项目页面上的映射）并[使用](https://code.google.com/p/solrnet/wiki/Mapping)`copyField`架构中的指令将所有单个字段移动到公共文本字段中。这允许您在组合`text`字段或单个字段上进行搜索，以及启用选项，例如在单个字段上突出显示和分面。

有关设置您自己的自定义字段和使用 copyField 的更多详细信息，请查看[文档、字段和架构设计。](http://docs.lucidworks.com/display/solr/Documents,+Fields,+and+Schema+Design)此外，由于您拥有来自 GitHub 的 SolrNet 源代码，我建议您运行并检查 SampleSolrApp 目录中的代码，以便更好地了解 SolrNet。您可以通过源父目录中的 runsample.bat 启动示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T01:44:27.277

（用户）错误已得到解决，一个简单的错误会产生奇怪的后果。我仍然不确定问题的根本原因是什么，但是我用于示例应用程序和我自己的应用程序的本地编译的 dll 是从 VS 解决方案构建的，但不起作用。我在第一次下载 build.bat 文件时遇到了一些问题（一运行就崩溃了，本地机器的问题，而不是构建脚本的问题），因此我尝试直接从解决方案/项目构建它。

移动到另一台 PC，我从 build.bat 文件构建了所有库，示例应用程序现在可以工作，我的其他应用程序也是如此。

**TLDR**

从**Build.bat构建库***

# javascript - dojox.mobile.ListItem OnClick 不工作

> ID：15823667
> 
> 赞同：0
> 
> 时间：2013-04-04T23:47:51.363
> 
> 标签：javascript, mobile, dojo, dom-events, dojox.mobile

我试图`ListItem`在 dojo 移动应用程序中单击 a 时调用一个函数。

这是以编程方式创建的函数`ListItems`

```
showResults : function(results) {

    results.forEach(function(result) {

        var li = new dojox.mobile.ListItem({
            class : "linklist",
            href : "#",
            label : result.address,
            moveTo : "#",
            clickable : true,
            onClick : function() {
                console.log("click");
            }
        }, domConstruct.create("li", null, this.searchList));

        // dojo.connect(li, "click", lang.hitch(this, this.addResult, result))

    }, this);

} 
```

我尝试`onClick`在构造函数中为函数提供属性，以及`dojo.connect`在创建后使用。两种方法都行不通。我还尝试了 , 和 的不同`click`变`onClick`体`onclick`。

我看到的有关此问题的任何其他帖子都建议使用`dojo.connect`上面评论的方法，但这仍然对我不起作用。

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T11:29:21.523

这是因为您的小部件的 startup() 方法永远不会被调用。您必须显式调用 li.startup()，或者，您可以使用 this.searchList.addChild(li) 而不是创建引用节点并将其传递给 ListItem 构造函数（这也会导致 startup() 被正确调用） .

# javascript - Javascript Windows UI 自动化

> ID：15823671
> 
> 赞同：0
> 
> 时间：2013-04-04T23:48:10.570
> 
> 标签：javascript, vb.net, ui-automation

在 VB.NET 中，我可以使用 Windows UI 自动化自动安装应用程序。可以在javascript中做到这一点吗？vbscript 也可以接受，但最好使用 javascript。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-08-29T06:25:57.943

有一个用于自动化 Windows UI 应用程序的 JavaScript 工具 LeanRunner Lite 可以使用 Node.js 语言运行。它可以从[Windows 商店安装](https://www.microsoft.com/store/apps/9PDRR6ZL2PBQ)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-01-06T06:08:51.590

对于 Windows UI 自动化，请尝试[`windows-app`](https://www.npmjs.com/package/windows-app). 例如，要使用计算器，请执行以下操作：

```
const windowsApp = require("windows-app")

const {select, close} = await windowsApp("Microsoft.WindowsCalculator_8wekyb3d8bbwe!App") // Calculator app

await select.name_("One").click()
await select.name_("Plus").click()
await select.name_("Two").click()
await select.name_("Equals").click()
const result = Number((await select.accessibilityId("CalculatorResults").getText()).replace("Display is", ""))

console.log(`The result of 1 + 2 is ${result}`)
//=> "The result of 1 + 2 is 3"

await close() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-01T03:15:35.057

使用 Appium 是可能的。您可能已经知道如何在 Node.js/JavaScript 中使用 Appium。

使用 NPM 下载 Appium 包，具体描述如下：

[Appium NPM 包](https://www.npmjs.com/package/appium)

它已包含 Windows 应用程序驱动程序，如下所述：

[https://github.com/appium/appium/blob/HEAD/docs/en/drivers/windows.md](https://github.com/appium/appium/blob/HEAD/docs/en/drivers/windows.md)

另一种选择是直接使用 Win-App-Driver，如下所述： [https ://github.com/appium/appium-windows-driver](https://github.com/appium/appium-windows-driver)

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-04-04T23:52:34.287

JavaScript 仅限于与 DOM 和远程服务器的交互（同源策略加上服务器定义的例外），您不能像那样在客户端机器上安装软件。

# grails - Grails下如何防止异常导致事务回滚？

> ID：15823677
> 
> 赞同：16
> 
> 时间：2013-04-04T23:48:56.070
> 
> 标签：grails, transactions, grails-orm

我的 Grails 服务存在一个问题，即与事务无关的吞下异常导致事务回滚，即使它与域对象的持久性无关。

在我的服务中，我有一些类似的东西

```
updateSomething(domainObj) {
    def oldFilename = domainObj.filename
    def newFilename = getNewFilename()

    domainObj.filename = newFilename
    domainObj.save(flush: true)

    try {
        cleanUpOldFile(oldFilename)
    } catch (cleanupException) {
        // oh well, log and swallow
    }
} 
```

我看到的是，当我在清理旧文件时遇到异常时，我会记录并吞下它，但它仍然会导致事务回滚，即使我已经完成了域对象的更新。

如何在清理之前限制范围事务完成，或者是否有另一种方法可以让清理异常不导致回滚？

只是为了记录我正在使用 Grails 2.1.1

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-04-05T00:27:22.617

您可以使用注释来进行更细粒度的事务划分。默认情况下，服务是事务性的，所有公共方法都是事务性的。但是，如果您使用任何`@Transactional`注释，Grails 不会让所有事情都成为事务性的——您拥有完全的控制权。

运行时异常会自动触发回滚，但检查异常不会。尽管 Groovy 不要求您捕获已检查的异常，但该功能是 Spring 的东西，它不了解 Groovy 异常处理。

事务是通过将服务类实例包装在代理中来实现的。如果一个异常“逃脱”了代理，无论它是否被捕获，回滚都已经发生了。

所以你有几个选择。注释`updateSomething`为`@Transactional`但不注释`cleanUpOldFile`：

```
import org.springframework.transaction.annotation.Transactional

@Transactional
def updateSomething(domainObj) {
...
}

def cleanUpOldFile(...) {
   ...
} 
```

您还可以使用一个或多个不应回滚事务的未经检查的异常（或在其他用例中应检查的异常）来注释 cleanUpOldFile，例如

```
@Transactional(noRollbackFor=[FooException, BarException])
def cleanUpOldFile(...) {
   ...
} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-05T01:02:49.857

除了[@Burt Beckwith](https://stackoverflow.com/users/160313/burt-beckwith)的回答之外，如果您有一项服务，您只是不想要交易（在我的情况下我实际上是这样做的），您可以通过添加来关闭所有公共方法上的交易

```
static transactional = false 
```

到服务类。

# java - 当多个类同名时识别特定类

> ID：15823680
> 
> 赞同：0
> 
> 时间：2013-04-04T23:49:20.093
> 
> 标签：java, spring

我的项目中包含两个项目`genxml`，`framework1`并且`framework2`. `Framework2`是的更新版本，`framework1`他们都有类`AbstractScreenTest.class`。无论如何，在下面的代码中我可以指定我想与之交互的项目吗？

```
ClassPathScanningCandidateComponentProvider provider = new ClassPathScanningCandidateComponentProvider(true);
provider.addIncludeFilter(new AssignableTypeFilter(AbstractScreenTest.class));
Set<BeanDefinition> components = provider.findCandidateComponents(candiatePackage);

for (BeanDefinition component : components){
  cls = Class.forName(component.getBeanClassName());
  classList.add(cls.getName().toString());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:18:01.770

您可以将 @Deprecated 注释添加到旧的（过时的）类中，并验证组件不包含已弃用的注释。

```
for (BeanDefinition component : components){

   cls = Class.forName(component.getBeanClassName());

   if (!cls.isAnnotationPresent(Deprecated.class) {
      classList.add(cls.getName().toString());
   }
} 
```

当然，这假设没有任何其他不推荐使用的类要添加到类列表中。在这种情况下，您可以编写一个新注释来标记您的旧类，尽管摆脱对过时类的依赖确实是理想的。

# c# - 具有用户权限的 SQL Server CE 应用程序

> ID：15823682
> 
> 赞同：2
> 
> 时间：2013-04-04T23:49:29.173
> 
> 标签：c#, winforms, security, sql-server-ce

我正在尝试开发一个允许通过 WinForms 和 SQL Server CE 数据库管理用户的应用程序。我已经建立了一种用户通过登录设置在表数据库中的用户名和密码列的登录方式。

现在，我正在尝试找出限制对应用程序特定功能的访问的最佳方法。我的目标是将应用程序分类为模块（客户、员工、计费等），并授予用户对整个模块的读写权限。稍后我可能会尝试在每个表单的基础上实现安全性。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T01:40:56.163

首先，您需要在 SQL CE 上创建角色表。

因此，您的 UserTable 可能`RoleID FK`在每个用户中都添加了一个。

假设您有管理员和用户角色。

在您的每个表单中，添加安全处理程序方法/类来检查访问您的应用程序的用户的角色。

创建`public string Role;`并`puclic string UserName`在每个表单中，您可以将其值传递给表单的其余部分。

您可以添加的客户表单加载示例

```
if(Role=="Admin")
{
    //visible all controls stuff
}
else
{
    //User
    //set controls to read only stuff
} 
```

在您的登录表单上登录/确定单击事件

你可以做

```
//your stuff on getting the role of the user 
//validation stuff
string role =  // get user role;  
if (role!=null)
{
    //if you have MDI Parent
    var mdi = new MDIParent
    {
        UserName = txtUserName.Text,
        Role = role,
    };
    mdi.Show();    
    this.Hide();
}
else
{
    //Error user not valid!!
} 
```

此致

# javascript - Javascript提示取消按钮不是“取消”

> ID：15823683
> 
> 赞同：0
> 
> 时间：2013-04-04T23:49:35.360
> 
> 标签：javascript, html, prompt

我注意到，当您让用户通过`prompt`窗口输入文本时，提示将返回`null`并继续使用代码。我希望取消按钮执行它所说的操作并取消。我尝试了几种`if`说法，包括：

```
var x= prompt("Please enter a number for <X>: (<X> + <Y>)");
if (x === null) {
    return;
}
var y= prompt("Please enter a number for <Y>: (<X> + <Y>)");
if (x === null) {
        return;
}   
eval ("x=x; y=y; alert(+x + + y)");
}; 
```

以上并没有改变任何东西

```
var x= prompt("Please enter a number for <X>: (<X> + <Y>)");
    if (verifyInput(false)) {
        return;
    }
var y= prompt("Please enter a number for <Y>: (<X> + <Y>)");
    if (verifyInput(false)) {
        return;
    }
eval ("x=x; y=y; alert(+x + + y)");
}; 
```

这使得 OK 和 Cancel 按钮都返回 false，即使按下 OK，代码也不会继续。

他们的某些代码是否会影响“取消”按钮以阻止脚本继续？谢谢！

我对这个网站很陌生，所以如果我没有让自己非常清楚，请原谅我:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:54:31.537

这里的问题是您正在使用身份运算符（===）来检查 null... null 本身就是一个对象，而您的提示结果将是一个字符串...因此，它永远不会是真的。 .. 改用相等运算符 (==)。

您可能还想删除 eval 语句，而只是提醒结果：

警报("" + (x + y));

编辑：抱歉刚刚注意到你想在这里执行一个实际的数学过程......这是适用于我的代码......真正的基本 HTML 页面，但应该可以帮助你做你需要做的事情：

```
<html>
  <head>
    <title>test</title>
  </head>
  <body onload="Prompter();">
    <script type="text/javascript">
      function Prompter()
      {
      var x = prompt("Please enter a number for <X>: (<X> + <Y>)");
      var y = prompt("Please enter a number for <Y>: (<X> + <Y>)");
      if(x && y)
          alert("" + (parseInt(x) + parseInt(y)));
      }
    </script>
  </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T23:58:22.047

您正在检查`null`何时`prompt`返回字符串的相等性；这行不通。相反，这应该是您的条件：

```
if ( x === "" ) { / ... / } 
```

在这里，您正在检查一个空字符串。此外，该 eval 语句不执行任何操作，您可以在没有它的情况下执行相同的代码：

```
alert( +x + +y ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T00:00:07.107

用命令试试`break;`

# java - 从多列文本文件中提取一些值

> ID：15823684
> 
> 赞同：1
> 
> 时间：2013-04-04T23:49:55.857
> 
> 标签：java

假设我有一个这样的文本文件：

```
ALASKA             30-DEC-11                                                  
CD  STATION         ICAO  IATA  SYNOP   LAT     LONG   ELEV   M  N  V  U  A  C

AK ADAK NAS PADK  ADK   70454  51 53N  176 39W    4   X     T          7 US

AK AKHIOK           PAKH  AKK 
         56 56N  154 11W   14   X                8 US

AK AMBLER           PAFM  AFM          67 06N  157 51W   88   X                7 US

AK ANAKTUVUK PASS   PAKP  AKP          68 08N  151 44W  642   X                7 US 
```

我只对保存以 AK 开头的行感兴趣。此外，我需要将某些信息保存到数组中，例如我的 STATION 名称。

对于第一行，我想将“ADAK NAS”存储到一个 stationArray 中，将“51”存储到一个数组中，与“53”、“N”、“176”、“39”和“W”相同。我想对以 AK 开头的每一行都执行此操作。

我真的很困惑如何去做。我目前与此相关的代码如下：

```
//process text file
FileInputStream fstream = new FileInputStream("file.txt");
BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
String strLine;

//add lines that start with "AK" to arraylist
ArrayList list = new ArrayList();
while ((strLine = br.readLine()) != null && strLine.startsWith("AK")) {
    list.add(strLine);
}

Iterator itr;
for (itr=list.iterator(); itr.hasNext(); ) {
    String str = itr.next().toString();
    String [] splitSt =str.split("\\t");
    String junk1 = "\\t"; 
```

我从网上提取了迭代器部分，不知道如何在那里拆分它，或者如何将相应的值放入一个数组中。我很感激你能提供的任何帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:04:41.030

这就是你要找的吗？

```
List<String> list = new ArrayList<String>();
List<String[]> out = new ArrayList<String[]>();
while ((strLine = br.readLine()) != null && strLine.startsWith("AK"))
{
    list.add(strLine);
}
for(String line : list){
    String[] lineArr = str.split("\\t");

}
for (itr=list.iterator(); itr.hasNext(); )
{
    String delimiter = "\\t";
    String [] splitSt =str.split(delimiter);
    //we don't know how many we're going to find,
    //so we should accumulate the data in a List.
    out.add(splitSt);
}
String[] stationArray = out.toArray(new String[out.size()]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T15:18:26.173

1.  您确定不能直接从源中**获取此数据吗？**一个数据库可能吗？
2.  没有其他可用的格式？

否则，我应该说正则表达式应该可以为您省去解析这些行的很多麻烦。您可以轻松提取所需的字段，无需循环和条件处理。

然而，一位智者曾经说过，当有人试图使用正则表达式解决问题时，他现在有两个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T00:08:16.870

您的代码将退出 while 循环@第一行不以“AK”开头，
您应该替换
while ((strLine = br.readLine()) != null && strLine.startsWith("AK"))
{
list.添加（strLine）；
}
由

while ((strLine = br.readLine()) != null)
{
if(strLine.startsWith("AK"))
list.add(strLine);
}
由

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T00:40:04.823

这看起来更像是一个固定宽度的文件（特定位置的字段）或固定宽度文件的一些变化。在这种情况下，您可以使用 substr 函数来获取字段（注意您还应该测试字符串长度）：

```
while ((strLine = br.readLine()) != null) {
    if ( strLine.startsWith("AK") {
       field1 = strLine.substring(.., ..);
       field2 = strLine.substring(.., ..);
         ......
    }
} 
```

如果有很多字段，您可以查看支持固定宽度文件的**平面文件阅读器**包之一（即[JRecord](http://jrecord.sourceforge.net/)、[Flatworm](http://flatworm.sourceforge.net/) + 许多其他的）。在这种情况下，它们可能是矫枉过正

这是所提供文件的略微更改版本（如果原始列表准确，某些字段已嵌入 CR/New Line/Tab 字符。CR/New Line 字符会使阅读更加困难）。

```
ALASKA             30-DEC-11                                                  
CD  STATION         ICAO  IATA  SYNOP   LAT     LONG   ELEV   M  N  V  U  A  C

AK ADAK NAS         PADK  ADK   70454  51 53N  176 39W    4   X     T          7 US

AK AKHIOK           PAKH  AKK          56 56N  154 11W   14   X                8 US

AK AMBLER           PAFM  AFM          67 06N  157 51W   88   X                7 US

AK ANAKTUVUK PASS   PAKP  AKP          68 08N  151 44W  642   X                7 US 
```

# c# - 一个角度的速度

> ID：15823685
> 
> 赞同：2
> 
> 时间：2013-04-04T23:49:57.300
> 
> 标签：c#, linear-algebra

我试图找到一个角度的速度。

为此，我尝试使用三角形，但遇到了障碍。

这是移动对象的代码

```
Velocity = new Vector3((float)Math.Cos(MathC.AngleToPoint(EnemyObject.transform.position, PlayerPosition)),
              (float)Math.Sin(MathC.AngleToPoint(EnemyObject.transform.position, PlayerPosition)), 0); 
```

这是 AngleToPoint 方法

```
public static double AngleToPoint(Vector3 startingPoint, Vector3 endPoint)
{
    double hypotenuse = LineLength(startingPoint, endPoint);
    double adjacent = LineLength(startingPoint, new Vector3(endPoint.x, startingPoint.y, 0));
    double opposite = LineLength(endPoint,  new Vector3(endPoint.x, startingPoint.y, 0));

    double angle = adjacent / hypotenuse;

    return Math.Acos(DegreeToRadian(angle));

} 
```

这是 LineLength 方法

```
public static float LineLength(Vector2 point1, Vector2 point2)
{
    return Math.Abs((float)Math.Sqrt(Math.Pow((point2.x - point1.x), 2)+Math.Pow((point2.y - point1.y),2)));

} 
```

我收到了很多 NaN 错误，而且运动的行为不像我想要的那样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-07-20T03:04:11.453

以下解决方案最初由问题作者[D Yamamoto发布。](https://stackoverflow.com/users/2247126/d-yamamoto)

* * *

我已经解决了这个问题。我不确定我是否能很好地解释自己，所以请允许我再次尝试这样做。我不是物理学家，如果我弄错了其中一些术语，请原谅。

我的目标是让物体以恒定的速度移动，而不管方向如何。所以你可以假设你是一个人，拿着枪朝北 (0, 1) 方向旋转 45 度并开火。枪的速度是一些标量，例如每秒 50 个单位。我想知道一个向量的 X 和 Y 值我需要在任何方向上进行移动。所以 Velocity (0, 50) 向右旋转了 45 度。

我知道 Velocity.X = SpeedCos(Angle) 和 Velocity.Y = SpeedSin(Angle)，但我需要找到 Angle 的值。

为此，我的思路是根据起始位置和目的地制作一个直角三角形，然后使用三角函数找到角度。

```
public static double AngleToPoint(Vector3 startingPoint, Vector3 endPoint)
{
    double hypotenuse = LineLength(startingPoint, endPoint);
    double adjacent = LineLength(startingPoint, new Vector3(endPoint.x, startingPoint.y, 0));
    double opposite = LineLength(endPoint,  new Vector3(endPoint.x, startingPoint.y, 0));

    double angle = adjacent / hypotenuse;

    return Math.Acos(DegreeToRadian(angle));

} 
```

这段代码正在制作一个直角三角形。相反的原因是即使没有使用它也是因为我尝试了多种方法来尝试完成此操作，但一直遇到错误。在制作一个直角三角形后，它需要 adj 和 hypo 来获得 cos(adj/hypo)，然后我调用 Acos 给我以弧度为单位的角度。但是，这不起作用，它没有正确返回我的角度并产生了很多 NaN 错误。

搜索后，我找到了解释 atan2[的 gamedev.se Q&A](https://gamedev.stackexchange.com/questions/14602/what-are-atan-and-atan2-used-for-in-games)，其中包括这张图片：

> [![http://i.stack.imgur.com/xQiWG.png](https://i.stack.imgur.com/xQiWG.png)](https://i.stack.imgur.com/xQiWG.png)

这让我意识到，如果我只是将行 startPoint, endPoint 转换为 startingPoint = 0，我可以调用 atan2 并返回我想要的角度。这是实现这一点的代码。

```
public static double GetAngleToPoint(Vector3 startingPoint, Vector3 endPoint)
{
    endPoint -= startingPoint;
    return Math.Atan2(endPoint.y, endPoint.x);
}

Velocity = new Vector3(Speed * (float)Math.Cos(MathC.GetAngleToPoint(StartingPosition, PlayerPosition)),
              Speed * (float)Math.Sin(MathC.GetAngleToPoint(StartingPosition, PlayerPosition)), 0); 
```

# forms - .findfirst vba access2010未绑定表单运行时错误

> ID：15823687
> 
> 赞同：1
> 
> 时间：2013-04-04T23:50:00.707
> 
> 标签：forms, ms-access, vba, ms-access-2010

我有以下 VBA 代码在 Access 2010 中以未绑定的形式填充未绑定的字段：

```
Private Sub Combo0_AfterUpdate()

Dim D As Database
Dim rsExp As Recordset
Dim Criteria As String

Set D = CurrentDb
Set rsExp = D.OpenRecordset("ExpAsset", DB_OPEN_DYNASET)

Criteria = "[serial_number]=" & [Combo0]

rsExp.FindFirst Criteria

Me!Name = rsExp("User")
Me!Type = rsExp("Type")
Me!MODEL = rsExp("Model")
Me!Notes = rsExp("Notes")
Me!Department = rsExp("Department")
Me!Status = rsExp("Status")

rsExp.Close

End Sub 
```

我在此行 rsExp.FindFirst Criteria 运行时错误 3077 表达式中的语法错误（缺少运算符）出现错误。

我已将代码更改为 Criteria = "[serial_number]=" & Str([Combo0]) 但随后出现运行时错误 13 类型不匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:58:23.853

给自己一个机会来检查您要求`.FindFirst`使用的标准。这可能不是你所期望的。

```
Dim strCriteria As String
'strCriteria = "[serial_number]=" & Me.Combo0
' since serial_number is text, enclose the Combo0 value in quotes
' when you build strCriteria
strCriteria = "[serial_number]='" & Me.Combo0 & "'"
Debug.Print strCriteria
' or MsgBox strCriteria if you prefer 
```

`Debug.Print`您可以在“立即”窗口中看到输出。去那里`Ctrl`+`g`

如果`[serial_number]`是文本数据类型，并且`Debug.Print`为您提供了其中任何一种，那么您就有问题了。

```
[serial_number]=A0123
[serial_number]= 
```

如果这不能引导您找到解决方案，请告诉我们您遇到错误时的数据类型`[serial_number]`和值。`Me.Combo0`

# php - 将新的键值对添加到键具有随机 ID 的 JSON 对象

> ID：15823691
> 
> 赞同：0
> 
> 时间：2013-04-04T23:51:24.917
> 
> 标签：php, json, object

我基本上知道如何通过 PHP 向 JSON 添加新的键值对，例如：

```
$json->newObject = "value"; 
```

然而，我无法弄清楚的是如何给这对的密钥，一个随机 ID。

我试过类似的东西：

```
$id = rand(99, 9999);
$json["newObject" . $id] = "value"; 
```

出现以下错误：`Fatal error: Cannot use object of type stdClass as array in /home/methodjs/public_html/projects/chat/send.php on line 8`

和：

```
$id = rand(99, 9999);
$json->("newObject" . $id) = "value"; 
```

出现以下错误：`Parse error: syntax error, unexpected '(', expecting T_STRING or T_VARIABLE or '{' or '$' in /home/methodjs/public_html/projects/chat/send.php on line 8`

我希望有一些简单的方法可以做到这一点。谢谢你的帮助。

## ***抱歉重复***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:56:19.403

这就是你想要的：

```
$json->{"newObject".$id} = "value"; 
```

该功能称为[变量属性](http://es2.php.net/manual/en/language.variables.variable.php)。它允许您使用字符串和变量从 PHP 中的对象分配和获取属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T23:56:29.730

您可以使用

```
$json = "{}";
$json = json_decode($json);

$json->newObject = "value";

$id = rand(99, 9999);
$json->{"newObject" . $id} = "value";

$json->array = array(mt_rand(),mt_rand());

print_r($json); 
```

输出

```
stdClass Object
(
    [newObject] => value
    [newObject1764] => value
    [array] => Array
        (
            [0] => 1176886102
            [1] => 1306108513
        )

) 
```

# ruby-on-rails - 最佳实践 - 在 Ruby on Rails 视图中传递实例变量或使用参数？

> ID：15823695
> 
> 赞同：13
> 
> 时间：2013-04-04T23:51:48.493
> 
> 标签：ruby-on-rails, ruby

根据以下示例，最佳实践是什么？

# 情况1

*控制器.rb* ...

```
def index
  ...
  @group = params[:group]
  @team = params[:team]
  @org = params[:org]
  ...
end 
```

*index.html.haml*

```
= link_to @group, '#'
= link_to @team, '#'
= link_to @org, '#' 
```

# 案例2

*控制器.rb* ...

```
def index
  ...

  ...
end 
```

*index.html.haml*

```
= link_to params[:group], '#'
= link_to params[:team], '#'
= link_to params[:org], '#' 
```

或者也许还有另一种选择，比如只传递一个 Hash 类型的实例变量......

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T23:59:13.363

通常，将参数拆分为实例变量是一个更好的主意，尤其是当您需要对它们进行一些清理时。直接在视图内部使用`params`有点混乱，并且会不必要地将视图绑定到传入参数的结构。

在传入参数和视图本身之间进行中间处理是控制器的工作。它应该从一种格式转换为另一种格式，以便您可以在不影响视图的情况下更改参数，并在不更改参数要求的情况下更改视图。

在不对参数进行某种处理的情况下传递参数是不寻常的。大多数时候，传入参数用于从数据库中获取记录，或者以某种方式用于路由。

看到三个参数被传入然后在页面上按*字面意思*使用并不是一个常见的用例。你为什么要传递这些而不是传递对其中一个可用于确定其他事物的引用？

例如：

```
@team = Team.find_by_slug(params[:team_id])
@org = @team.org
@group = @team.group 
```

这就是大多数 Rails 应用程序的构建方式。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-08-29T05:36:42.493

如果您必须在这两个绝对＃1之间进行选择，则视图不应使用 params 哈希，因为它是一个混合问题。控制器的作用是处理参数哈希并为视图准备一切。

我认为更好的做法是根本不使用实例变量，而只是在控制器中使用辅助方法：

```
def group
    params[:group]
end
helper_method :group 
```

在视图中：

```
= link_to group, '#' 
```

这样，该方法是惰性的，仅在使用时才进行评估。

也看看

# android - 使用已在 android 上填写的发送地址创建电子邮件

> ID：15823705
> 
> 赞同：0
> 
> 时间：2013-04-04T23:52:28.387
> 
> 标签：android, email, button, android-intent

我正在android中制作一个应用程序，我正在尝试制作它，以便当您单击一个按钮时，它会打开您选择的电子邮件应用程序（我使用gmail）并自动撰写一封电子邮件，我该如何制作它以便发送地址已填写>

这是我的代码

```
public void send( View v ){
    Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
    emailIntent.setType("text/plain");
    startActivity(emailIntent);  
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:08:53.093

这就是你需要的。

```
emailIntent.putExtra(Intent.EXTRA_EMAIL, "your_email_address"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T13:00:39.373

@user2109242

我建议您使用以下代码，因为它会帮助您**选择以下来源之一**：*电子邮件、gmail 或 skype*以及**电子邮件的状态，**例如：已*发送或未发送*

```
public void sendFeedbackMessage(String subject, String message) {

        Intent i = new Intent(Intent.ACTION_SEND);
        i.putExtra(Intent.EXTRA_EMAIL  , new String[]{"your@gmail.com"});  
        i.putExtra(Intent.EXTRA_SUBJECT, subject);
        i.setType("message/rfc822");
        i.putExtra(Intent.EXTRA_TEXT, message);
        try {
            startActivity(Intent.createChooser(i, "Send email via :"));
            Toast.makeText(ReservationActivity.this, "Email Sent.", Toast.LENGTH_SHORT).show();
        } catch (android.content.ActivityNotFoundException ex) {
            Toast.makeText(ReservationActivity.this, "There are no email applications installed.", Toast.LENGTH_SHORT).show();
        }

        } 
```

# django-cms - Django-CMS 中的多个多语言菜单，项目根植于 /

> ID：15823714
> 
> 赞同：1
> 
> 时间：2013-04-04T23:53:24.547
> 
> 标签：django-cms

我在 Django 1.4.5 和 Python 2.7.2 上使用 Django-CMS 2.3.5。

我有大约 2 打页面需要在我的基本模板中的两个或更多菜单中呈现。

目前我正在使用主菜单和页脚菜单。对于主菜单，我简单地创建了一个带有 id 'home' 和一些孩子的“主页”页面，然后使用`{% show_menu_below_id "home" 0 100 100 100 %}`. 完美运行。

对于页脚菜单，我在页面树中创建了一个名为“页脚菜单”的假节点，其 id:footer-menu 与我的页脚菜单项作为子项。然后，我使用`{% show_menu_below_id "footer-menu" 0 100 100 100 %}。

菜单中的每个页面都被翻译成 6 种语言，当然包括它们的 slug。

问题在于页脚菜单中项目的 URL 类似于“/en/footer-menu/news/”。我需要把它简单地写成“/en/news/”。我尝试在页脚菜单上使用高级 > 覆盖 URL 到“/”，但不允许这样做。

因此，我在每个子页面上使用 Advanced > Overwrite URL 字段将 url 设置为“/news”。在用英语进行测试时，我确实得到了“/en/news/”的 URL，但是当我切换到另一种语言（例如，西班牙语）时，该 url 是“/es/footer-menu/noticia/​​”。

那么，我应该使用什么策略来允许：

1.  客户端可安排的菜单 - 客户端应该能够从菜单中创建/移动/删除页面
2.  多个菜单
3.  i18N 蛞蝓和
4.  根项目在“/<语言>/”？

当然，我不是第一个想要这样做的人，对吧？

欢迎所有想法。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-12T11:27:12.287

解决方案是升级到 2.4.x，其中覆盖 URL 现在对于每种语言都是不同的。

# backbone.js - 如何在主详细信息场景中仅加载集合字段的子集/具有惰性模型字段/惰性嵌套集合？

> ID：15823715
> 
> 赞同：4
> 
> 时间：2013-04-04T23:53:31.767
> 
> 标签：backbone.js

我对 Backbone 比较陌生，我已经搜索了一段时间，但没有找到满足我问题的答案（这个很接近，但不确定它是否完全适用[Backbone.js Master-Detail 场景](https://stackoverflow.com/questions/7308719/backbone-js-master-detail-scenario)）

* * *

**tl; dr：**如何表示集合的子集（仅在集合的某些模型字段中，而不是在分页/过滤中的子集）？（例如，仅显示名称和修改日期的列表视图，当详细信息不仅包括更多字段，还包括嵌套的子集合时）

* * *

现在到详细版本，这里是应用程序的结构：

**楷模**

*   `DocumentCollection`- 文档集合，应该只获取名称和最后修改日期
    *   `Document`- 当作为集合提取的一部分提取时，应该只提取名称和修改日期，当提取“独立”（例如在详细信息视图中）时，还应该提取描述和子文章
        *   `ArticleColletion`作为文档一部分的嵌套集合，仅应在获取详细信息视图中的文档时获取，但应该是“惰性的”并且在获取时不`DocumentCollection`获取
            *   `Article`

**意见**

*   `DocumentCollectionView`（仅显示文档名称和最后修改日期）
*   `DocumentView`（包括文件名称、描述和文章）
*   `ArticlesView`并`ArticleView`用于显示单个或一组文章

**目标**

我想让`DocumentCollection` `fetch`方法调用只带`Document`模型的一个子集（只有名称和修改时间），并且在`Document`直接获取时，还要获取描述字段和子文章

现实世界的模型有点复杂，有更多的字段，所以我需要减少网络上的一些流量，而不是在需要之前加载字段或子集合。

**可能的解决方案**

1.  覆盖 fetch 方法，并应用相关逻辑（例如，“完整”或“部分”加载的标志）

2.  忘记惰性字段，只有嵌套集合惰性，切割未使用的字段是过早的和不必要的优化，并且不是模型的责任来决定需要什么和不作为视图渲染的一部分，它应该带来一切

3.  “摘要”视图有不同的集合和模型，例如`DocumentSummaryCollection`并扩展 DocumentCollection `DocumentSummaryCollection`？

**问题**

以上（如果有的话）是“骨干”的方式吗？还有其他方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-05T02:02:10.017

这是我不确定是否有“骨干”方式来处理的常见场景之一。这是一种可能的解决方案...

当您获取文档集合 ( `/api/documents`) 时，您会返回一些像这样的 json：

```
[{id: 1, name: 'foo'}, {id: 2, name: 'bar'}] 
```

当你获取一个文档 ( `/api/documents/1`) 时，返回一些像这样的 json：

```
{
    id: 1, name: 'foo', description: 'some stuff about foo', 
    articles: [{id: 1, name: 'hello'}, {id: 2, name: 'hi again'}]
} 
```

当获取单个 DocumentModel 时，将有一个新属性`articles`。您侦听该`change:articles`事件，并且`set`该新 json`this.articles`是 ArticlesCollection。

现在......一些代码：

```
var Article = Backbone.Model.extend({});

var ArticleCollection = Backbone.Collection.extend({
    model: Article
});

var Document = Backbone.Model.extend({
    constructor: function() {
        // make sure articles collection is created.
        this.articles = new ArticleCollection();
        Backbone.Model.prototype.constructor.apply(this, arguments);
    },
    initialize: function(attributes, options) {
        this.articlesChanged();
        this.on('change:articles', this.articlesChanged, this);
    },

    // articles attribute changed.
    // set it into the Collection.
    // this way, existing models will be updated, new ones added.
    articlesChanged: function(){
        // if document was fetched and has articles json array,
        // set that json into this.articles collection.
        var articles = this.get('articles');
        if(articles){
            this.articles.set(articles);
            // remove 'articles' attribute now that it is set into the collection.
            this.unset('articles');
        }
    }
});

var DocumentCollection = Backbone.Collection.extend({
    model: Document
}); 
```

更多代码：

```
var docs = new DocumentCollection();
docs.fetch().done(function() {
    // docs now has documents with only name, date attributes, 
    // and empty articles collection.
    var doc = docs.at(0);
    var name = doc.get('name'); // foo
    var articleCount = doc.articles.length; // 0

    doc.fetch().done(function() {
        // first doc is now full, with articles, description, etc.
        doc.articles.each(function(article) { 
            console.log(article.get('name'));
        }, this);

        // re-fetch the collection later... to check if new documents exist.
        docs.fetch().done(function() {
            // new docs added, removed docs gone.
            // existing doc models updated.
        });
    });
}); 
```

我认为我喜欢这个的主要一点是，它保留了文档/文章集合实例，即使文档集合或单个文档稍后被重新获取。

因此，例如，如果您在详细信息视图中显示 DocumentModel 及其文章集合，并且重新获取整个 DocumentCollection，则显示的 DocumentModel 在获取之后仍将在集合中（除非它实际上已在服务器）。如果你有一些`change add remove`类型事件连接到这些实例，这很好。

随着 Backbone 1.0 转向“更新”获取（这很棒），我很好奇是否还有其他（或更好的）解决方案，因为这确实是一个非常普遍的问题......我真的没有经常使用这个确切的解决方案，我不确定它是否理想。我曾经使用`parse`更多来获取子 json 和子集合`reset`。但我认为我在更新 fetch 时遇到了一些问题，所以开始尝试这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:27:35.193

我将构建我的服务以仅返回您需要的字段并使用集合的 parse 方法，从骨干文档..

```
 parsecollection.parse(response, options) 
```

*每当服务器返回集合的模型时，Backbone 都会在 fetch 中调用 parse。该函数传递原始响应对象，并应返回要添加到集合中的模型属性数组。默认实现是无操作的，只是通过 JSON 响应。如果您需要使用预先存在的 API 或更好的响应命名空间，请覆盖此选项。*

在解析函数中，您可以迭代响应并使用返回的属性构建模型（id 必须在返回的属性中），然后可以在需要时使用完整模型获取这些模型。

# mysql - 从 mysql 客户端将参数传递给 mysql 脚本

> ID：15823716
> 
> 赞同：1
> 
> 时间：2013-04-04T23:53:38.833
> 
> 标签：mysql, command-line, arguments

有没有办法/解决方法/hack 将参数传递给 mysql 脚本？假设我有一个文件名 myqueries.sql，它看起来像这样

```
SELECT * FROM FooBar where id = <arg>; 
```

然后在mysql命令中，我知道我可以调用这个脚本

```
mysql>source myqueries.sql 
```

但是有没有办法在这里传递一个论点？像这样的东西：

```
mysql>source myqueries.sql 2 
```

然后我会得到 id = 2 的元组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-12-28T03:37:58.757

我的查询.sql

```
SELECT * FROM FooBar where id = @arg; 
```

在 mysql 上

```
set @arg=2;
source myqueries.sql 
```

# sql-server-2008 - 当 XPATH 不存在时，SSRS 返回具有一行的数据集

> ID：15823718
> 
> 赞同：1
> 
> 时间：2013-04-04T23:53:57.593
> 
> 标签：sql-server-2008, xpath, reporting-services

SSRS 2008 R2

这本质上是这个[问题](https://stackoverflow.com/questions/4646588/how-can-i-prevent-ssrs-query-of-xml-data-from-always-returning-an-empty-row)的副本。

...但是那里发布的解决方案对我不起作用。

重要的是要注意，如果有数据，那么一切对我来说都很好。

如果您使用无法在 XML 文档中解析的 XPATH 进行查询，为什么 SSRS 将返回包含一行的 DataSet？

例如，如果我有一个名为“地址”的数据集：

```
<Country>
</Country> 
```

我的任何 XPATH 是：

```
Country/City{Street} 
```

（例如）

我得到一个带有一行的数据集，该行中的每个字段似乎都是一个错误 - 因为我对其执行的任何操作都失败了。所以我什至不能在它上面放置一个隐藏的过滤器，因为我的隐藏表达式无法执行并且显示了该行 - 完全空白。

如果有 City 元素，那就没问题了。

在测试我是否尝试创建一个 TextBox 并对这一行中的字段进行任何操作时，它们都失败了，即使其中有字符串文字，整个 TextBox 也不会显示出来。

例如，如果我放置一个带有表达式的 TextBox：

```
="Rows: " & CountRows("Address") 
```

我得到结果：

```
1 
```

但是，如果我将同一个文本框（在表格单元格中）更改为：

```
="Rows: " & CountRows("Address") & " Hide:" & IIF(IsNothing(Fields!Street.Value), "yes", "no") 
```

文本框根本不显示，但表格行仍然被绘制并且是空白的。

我在很多地方都遇到过这种情况，并且总是设法在源 XML 中破解它，但在这种情况下这是不可能的。

DataSet 中的那一行是怎么回事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:02:09.473

向您的 XPath 查询添加一个过滤器以过滤掉空元素。

就像是：

```
Country/City{Street}[string-length(Street) &gt; 0] 
```

或者可能？

```
Country/City[string-length(Street) &gt; 0]{Street} 
```

（我的 XPath 有点生疏...]

# javascript - 如何在 HTML5 Canvas 中自动缩放像素位置？

> ID：15823720
> 
> 赞同：0
> 
> 时间：2013-04-04T23:54:05.397
> 
> 标签：javascript, html, canvas, drawing

我创建了一个使用 HTML5 Canvas 元素的基于 HTML5 的绘图应用程序。我已经编写了在 Canvas 上绘制草图的代码。

![在此处输入图像描述](https://i.stack.imgur.com/DaKc0.png)

画布的原始尺寸为 500 px x 500 px 。所有的图纸都是根据这个制作的。现在我的问题是我需要将 Canvas 大小更改为 1000 x 1000 并希望使图纸覆盖整个新画布。有什么简单的方法可以做到这一点，而不是直接修改像素位置？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T00:14:58.813

您可以使用 CSS 更改画布大小并保持画布元素的宽度和高度属性不变。这将创建您需要的拉伸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T20:08:55.230

我相信您想要做的是缩放并可能转换画布的位置。

这是一个工作示例：[http ://marketimpacts.com/storage/9781118385357%20ls0701%20Resizing%20and%20Scaling%20the%20Canvas.htm](http://marketimpacts.com/storage/9781118385357%20ls0701%20Resizing%20and%20Scaling%20the%20Canvas.htm)

如果这不是您需要的，其他 Canvas 示例在这里： [http ://donkcowan.com/html5-canvas-for-dummies/](http://donkcowan.com/html5-canvas-for-dummies/)

这是代码：

```
<!DOCTYPE HTML> <html> <head> <script> 

// SUMMARY: Draws random circles on a 
// resized and rescaled canvas.

// A. WINDOW LOAD function.                      
window.onload = function()
{ 
   // A1\. CANVAS definition standard variables.            
   canvas  = document.getElementById("canvasArea"); 
   context = canvas.getContext("2d");

   // A2\. PARAMETERS for circles.
   var numCircles = 300;
   var maxRadius  = 20;
   var minRadius  = 3;
   var colors     = ["aqua",  "black", "blue",  "fuchsia",
                     "green", "cyan",  "lime",  "maroon",
                     "navy",  "olive", "purple","red",
                     "silver","teal",  "yellow","azure",
                     "gold",  "bisque","pink",  "orange"];
   var numColors  =  colors.length;

   // A3\. RESIZE & RESCALE canvas.
   canvas.width  = 400;   canvas.height = 100;
   context.scale(.7, .3);

   // A4\. CREATE circles.
   for(var n=0; n<numCircles; n++)
   {
      // A5\. RANDOM values for circle characteristics.
      var xPos       =  Math.random()*canvas.width;
      var yPos       =  Math.random()*canvas.height;
      var radius     =  minRadius+(Math.random()*(maxRadius-minRadius));
      var colorIndex =  Math.random()*(numColors-1);
      colorIndex     =  Math.round(colorIndex);
      var color      =  colors[colorIndex];

      // A6\. DRAW circle.
      drawCircle(context, xPos, yPos, radius, color);
   }
};
// B. CIRCLE drawing function.
function drawCircle(context, xPos, yPos, radius, color)
{
   //B1\. PARAMETERS for shadow and angles.
   var startAngle        = (Math.PI/180)*0;
   var endAngle          = (Math.PI/180)*360;
   context.shadowColor   = "gray";
   context.shadowOffsetX = 1;
   context.shadowOffsetY = 1;
   context.shadowBlur    = 5;

   //B2\. DRAW CIRCLE
   context.beginPath();
   context.arc(xPos, yPos, radius, startAngle, endAngle, false);
   context.fillStyle = color;
   context.fill();              

}
</script> </head> <body> 
<!-- C. CANVAS definition -->
<div    style = "width:200px;   height:200px; 
                 margin:0 auto; padding:5px;">
<canvas id    = "canvasArea" 
        width = "200"  height = "200" 
        style = "border:2px solid black">
Your browser doesn't currently support HTML5 Canvas.
</canvas> </div> 
</body> </html> 
```

# ruby-on-rails - Rails many_to_many 表未更新

> ID：15823722
> 
> 赞同：0
> 
> 时间：2013-04-04T23:54:14.723
> 
> 标签：ruby-on-rails, activerecord, many-to-many

创建新站点记录时，我无法更新 many_to_many 表。站点表已更新，但未更新站点用户。我希望在创建站点时将 user_id 和 site_id 添加到 sites_users 表中。

我的迁移：

```
class CreateTableSiteUser < ActiveRecord::Migration
def up
  create_table :sites_users, :id => false do |t|
      t.integer :site_id
      t.integer :user_id
  end 
```

楷模：

用户.rb

```
class User < ActiveRecord::Base
attr_accessible  :name, :email, :password, :password_confirmation, :user_id
has_secure_password
has_and_belongs_to_many :sites 
```

网站.rb

```
class Site < ActiveRecord::Base
attr_accessible :name, :site_key, :organization_id, :user_id, :site_id
belongs_to :organization
has_and_belongs_to_many :users 
```

站点控制器.rb

```
def create
  @site = Site.new(params[:site])
    @site.organization_id = Organization.where(:user_id => current_user.id)
    @user_id = current_user.id
    if @site.save
        flash[:success] = "New Site Created!"
        redirect_to root_path
    else 
```

我还需要什么来获取 site_id 和 user_id 以保存到 sites_users 连接表？

我已经尽可能多地阅读了多对多的内容，并且发布了许多主题，观看了 railscast 视频，并尽可能多地进行了搜索。任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:10:31.710

如果您要在操作上创建新站点`create`，并希望将该站点分配给`current_user`，请尝试以下操作

```
if @site.save
  @site.users << current_user
  flash[:success] = "New Site Created!"
  redirect_to root_path
else
  ... 
```

这会添加`current_user`到用户列表中，`@site`但仅在`@site`通过验证并保存之后。

# git - 合并简单的上游更改时，Git Subtree Merging 报告冲突

> ID：15823730
> 
> 赞同：4
> 
> 时间：2013-04-04T23:54:58.030
> 
> 标签：git, git-merge, git-subtree

我开始学习 git 1.8.2 中的子树合并。我创建了一个简单的示例来测试对迁移到主项目的第三方 repo 的更改。

我正在关注[6.7 Git Tools - Subtree Merging](http://git-scm.com/book/en/Git-Tools-Subtree-Merging)示例。

“子”项目作为子目录包含在“主”项目中。

在我对“子”项目进行更改后，当我尝试将更改合并到“主”项目中时，git 会报告冲突。

**测试总结**

1.  为项目'main'和'sub'创建了repos（sub而不是rack）
2.  将名为 sub_remote 的远程添加到引用 sub 的 main
3.  使用 sub_branch 跟踪 sub_remote
4.  在“子”项目的文件中更改并提交一行
5.  将更改从 sub 拉到 main/sub_branch
6.  将 main/sub_branch 合并到 main/master。

合并因冲突而失败。Merge 对要保留哪个版本的更改行感到困惑。

```
<<<<<<< HEAD
main
=======
main upstream change
>>>>>>> sub_branch
main.git
sub
sub.git
tm 
```

**完整的测试脚本**

```
#!/bin/sh

# initialize empty repos
for i in main sub
do
  rm -rf $i{,.git}
  mkdir $i.git
  cd $i.git;
  git --bare init;
  cd ..;
  git clone $i.git
  cd $i
  echo $i > readme.md
  git add readme.md
  git commit -a -m "added readme.md"
  git push origin master
  cd ..
done

# add data to sub
ls > sub/data
cd sub
git add data
git commit -m "Added data"
git push origin master
cd ..

# add sub as a sub-tree in main
cd main
git remote add sub_remote ../sub.git
git fetch sub_remote
git checkout -b sub_branch sub_remote/master
git checkout master
git read-tree --prefix=sub/ -u sub_branch
git commit -m "Added sub"
git push origin master
cd ..

# make change to sub
cd sub
sed -i -e 's/main$/main upstream change/' data
git commit -a -m "upstream change made to data"
git push origin master
cd ..

# merge sub change to main
cd main
git checkout sub_branch
git pull

#merge sub_branch changes into master
git checkout master
git merge -s subtree sub_branch
cat sub/data 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T19:02:10.137

在`read-tree`这种情况下所做的只是将另一棵树的内容添加到当前树的目录中。添加这些内容就像创建和添加常规文件和目录一样，没有历史记录。所有这些文件都将被视为您创建它们。

当您尝试合并时，进程失败，因为它看到 sub_branch 历史创建了该`data`文件，并且目标目录还包含`data`您创建的不同文件。

您正在使用的页面缺少使子树正常工作的非常重要的步骤，因此您实际上可以对其进行更新。

在这两个页面中都可以看到正确的示例： [https://www.kernel.org/pub/software/scm/git/docs/howto/using-merge-subtree.html](https://www.kernel.org/pub/software/scm/git/docs/howto/using-merge-subtree.html) [https://help.github.com/文章/使用子树合并](https://help.github.com/articles/working-with-subtree-merge)

在您的情况下缺少的是在创建子树时正确链接历史记录：

```
# create the merge record but not change anything in your tree yet
git merge -s ours --no-commit sub_branch
# bring the changes and place them in the proper subdirectory
git read-tree --prefix=sub/ -u sub_branch 
```

在此之后，您的`main`存储库将包含存储库的历史记录`sub`。对失败的合并的调用现在应该可以正常工作了。调用`git log --graph`将让您看到不同的提交是如何被合并的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-19T14:06:58.233

问题是 Git 1.8.2.2（2013 年 3 月）只是引入了一个影响`git merge -s subtree`. [Tim Swast](https://stackoverflow.com/users/101923/tim-swast)提到
的子[树合并部分](https://git-scm.com/book/en/v2/Git-Tools-Advanced-Merging#_subtree_merge)仍然存在问题，应该可以更好地与 Git 2.19（2018 年第三季度）一起使用。

" " 中的自动树匹配在`git merge -s subtree`5 年前就被破坏了，从那时起就没有人注意到了，现在已经修复了。

请参阅[Jeff King ( ) 的](https://github.com/peff)[提交 2ec4150](https://github.com/git/git/commit/2ec4150713eabc725ba1c43fbe032adb43d5d4cf)（2018 年 8 月 2 日[）](https://github.com/peff)。 帮助者：[René Scharfe (](https://github.com/rscharfe) [)](https://github.com/rscharfe)。^(（由)^([Junio C Hamano 合并 --](https://github.com/gitster)) ^([--](https://github.com/gitster))^在^([提交 60858f3](https://github.com/git/git/commit/60858f343aa909305c28790c7684bf88905695a2))^(中，2018 年 8 月 17 日）)[`peff`](https://github.com/peff)
[`rscharfe`](https://github.com/rscharfe)
^([`gitster`](https://github.com/gitster))

> ## `score_trees()`：修复缺少条目的树的迭代
> 
> 在`score_trees()`中，我们遍历两棵已排序的树以查找缺少哪些条目或两者之间具有不同内容的条目。
> 因此，如果我们有两个包含这些条目的树：
> 
> ```
> one   two
> ---   ---
> a     a
> b     c
> c     d 
> ```
> 
> 我们希望循环：
> 
> *   将“a”与“a”进行比较
> *   将“b”与“c”进行比较；因为这些是排序列表，我们知道第二棵树没有“b”
> *   比较“c”和“c”
> *   将“d”与列表末尾进行比较；我们知道第一棵树没有“d”
> 
> 并且在[d8febde](https://github.com/git/git/commit/d8febde370aa464a5208cf094f306343e4ecb6dc) ( `match-trees`: simple `score_trees()`using `tree_entry()`, 2013-03-24, Git 1.8.2.2) 之前有效。
> **但是在那次提交之后，我们错误地为每次循环迭代增加了树指针，即使我们只处理了一侧的条目**。
> 结果，我们最终这样做：
> 
> *   将“a”与“a”进行比较
> *   将“b”与“c”进行比较；我们知道我们没有“b”，但我们仍然递增两个树指针；**在这一点上，我们不同步，所有进一步的比较都是错误的**
> *   将“c”与“d”进行比较，并错误地声称第二棵树没有“c”
> *   退出循环，错误地没有意识到第一棵树没有“d”
> 
> 因此，与[d8febde](https://github.com/git/git/commit/d8febde370aa464a5208cf094f306343e4ecb6dc)中的说法相反，我们确实需要手动使用`update_tree_entry()`，因为推进树指针取决于条目比较。
> 
> 这意味着我们必须停止使用`tree_entry()`来访问每个条目，因为它会自动推进指针。
> 反而：
> 
> *   我们将`tree_desc.size`直接使用来了解是否还有其他需要查看的内容（这就是幕后`tree_entry()`所做的）
> *   我们可以直接访问“ ”字段，而不是对“ `e1`”和“ ”进行额外的结构分配。`e2``entry``tree_desc`

# haskell - 为什么没有函数的 Show 实例？

> ID：15823732
> 
> 赞同：7
> 
> 时间：2013-04-04T23:55:15.540
> 
> 标签：haskell

只是一个快速的概念性问题，我目前正在尝试更好地学习和理解 Haskell。

我知道 Show 函数用于将值转换为字符串，但为什么不能将函数类型与 show 一起使用？

```
Prelude> (\x -> x*3)

<interactive>:7:1:
    No instance for (Show (a0 -> a0))
      arising from a use of `print'
    Possible fix: add an instance declaration for (Show (a0 -> a0))
    In a stmt of an interactive GHCi command: print it
Prelude> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-05T00:01:00.267

并不是他们不能，而是通常没有充分的理由这样做。

但是，如果您愿意，您绝对可以：

```
Prelude> :{
Prelude| instance Show (a -> b) where
Prelude|    show _ = "A function."
Prelude| :}
Prelude> print (\x -> x + 7)
A function.
Prelude> print (\a b c -> a + b + c)
A function. 
```

如果你想要`show`函数的文本表示，那么 - 你不能那样做。与 Ruby、JS 等元编程语言不同，Haskell 代码对自己的内部结构知之甚少。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-06T01:32:25.423

对于使用 Data.Typeable 的所有函数，有一个部分解决方案超出了固定字符串的范围。

```
{-# LANGUAGE ScopedTypeVariables #-}

import Data.Typeable

instance (Typeable a, Typeable b) => Show (a->b) where
  show _ = show $ typeOf (undefined :: a -> b) 
```

在 ghci

```
> let test :: Int->Int; test x = x + x
> test
Int -> Int 
```

不幸的是，如果没有类型签名，类型将默认使用。

```
> let test x = x + x
> test
Integer -> Integer 
```

该解决方案适用于多种功能，因为`a -> b -> c`它与`a -> (b -> c)`您可能编写的相同`a -> d`where `d = b -> c`。

```
> let m10 a b c d e f g h i j = a * b * c * d * e * f * g * h* i * j
> m10
Integer -> Integer -> Integer -> Integer -> Integer -> Integer -> Integer
        -> Integer -> Integer -> Integer -> Integer 
```

但是，当不知道函数的参数是否具有可类型类时，此方法不起作用，但是 while `map (+1)`will work`map`将不起作用。

```
> map (+1)
[Integer] -> [Integer]
> map

<interactive>:233:1:
... 
```

在浏览了`Data.Data`一个或两个实验的内部之后，似乎可以将其重构为更通用一点，涵盖更多功能。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T23:59:49.107

`show`是在作为类型类成员的函数上定义的函数`Show`（如果您不知道类型类是什么，它有点像 OOP 接口）。

默认情况下，函数不是类型类的成员，所以我们不能打印它们。

我们可以使它成为类型类的成员

```
instance Show (a -> b) where
   show f = "Unicorns!!" 
```

但是在这里我们意识到为什么默认情况下它没有实现。没有简单、明显的函数表示，haskell 不想猜测，因此没有实例。

唯一的“允许”实例是实际打印出函数的实例，但这需要实际的语言更改，即它将被硬连接到编译器中，这对于少数可能有用的情况是不值得的.

此外，它是一个重要的编译器更改，Haskell 已编译，这意味着类似`f = g`和

```
f =             g 
```

完全迷失在它上面。但是您肯定希望在您的函数表示中使用它。因此，您必须在整个程序中拖着这个字符串。这绝对不是你想要的二进制文件。

如果你真的想让它打印独角兽！！不过，请随意。

# php - 提交表单后PHP Session数据丢失但仅在生产环境中，测试环境有效

> ID：15823733
> 
> 赞同：0
> 
> 时间：2013-04-04T23:55:16.097
> 
> 标签：php, session, http-post, session-variables, captcha

所以我有一个正在开发的测试环境和一个最终将我的代码部署到的生产环境。我现在拥有的代码适用于我的测试环境，但不适用于我的生产环境。所以这似乎是一个环境问题，但如果是我不知道要更改哪个设置。

现在我正在尝试测试一个简单的联系页面，它有一个简短的表格和验证码图像。联系人页面设置了一个会话变量，其中包含验证码图像中显示的 security_code，以便在名为 contactSanitize 的下一页上，我可以从会话中读取该变量并验证用户输入了正确的代码。

同样，这在测试环境中运行良好。但是，在生产环境中，我可以填写表单并提交它，此时会话数据丢失并且contactSanitize 页面将我发送回联系人页面，因为它看不到我输入的代码。

我在这些页面中的任何地方都没有 session_destroy 调用，并且我不会不小心将 $_SESSION 变量设置为空数组或其他任何东西（我检查了两次和三次 - 它也适用于测试环境，所以它可以不要那样）

以下是我的日志中的片段——每一行都包含时间戳，如果有的话，除了我的评论之外，还包含会话 ID。您可以看到实际上contactSanitize 确实具有相同的会话ID，只是会话本身由于某种原因是空的。

**这是contact.php 页面：**

```
DEBUG  2013-04-04 18:23:07 (varsAndSecurityCheck.php:74) Page requires security, checking to see if authenticated user.
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:07 (varsAndSecurityCheck.php:82) authenticated = false
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:09 (contact.php:130) just before security image
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:09 (contact.php:134) invoking security image functions
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:09 (CaptchaSecurityImages.php:42) code: hwjdtvw7
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:09 (contact.php:137) after security image functions, SESSION: Array
(
    [security_code] => hwjdtvw7
)
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:09 (contact.php:152) Just after security image 
```

**我现在提交表单并转到 contactSanitize.php 以验证用户输入：**

```
DEBUG  2013-04-04 18:23:24 (varsAndSecurityCheck.php:74) Page requires security, checking to see if authenticated user.
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:24 (varsAndSecurityCheck.php:82) authenticated = false
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:26 (contactSanitize.php:8) SESSION: Array
(
) 
```

**正如您在上面看到的，会话是空的，因此验证失败：**

```
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:26 (contactSanitize.php:26) No security code and not authenticated, sending to contact page.
DEBUG  2013-04-04 18:23:26 (varsAndSecurityCheck.php:74) Page requires security, checking to see if authenticated user.
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:26 (varsAndSecurityCheck.php:82) authenticated = false 
```

**我被送回 contact.php 页面，在该页面生成了一个新的安全代码：**

```
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:29 (contact.php:130) just before security image
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:29 (contact.php:134) invoking security image functions
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:29 (CaptchaSecurityImages.php:42) code: xb66q6jy
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:29 (contact.php:137) after security image functions, SESSION: Array
(
    [security_code] => xb66q6jy
)
DEBUG c744b62f483d1eb02fafbbd11f9e9bdb 2013-04-04 18:23:29 (contact.php:152) Just after security image 
```

## ***编辑***

我添加了一些额外的日志来显示 session_start 调用发生在两个页面的开头。以下行现在出现在 contact 和 contactSanitize 页面的开头：

```
DEBUG  2013-04-04 19:26:15 (varsAndSecurityCheck.php:74) Page requires security, checking to see if authenticated user.
DEBUG  2013-04-04 19:26:15 (varsAndSecurityCheck.php:78) page is secure, starting session now. 
```

**这是 varsAndSecurityCheck.php 页面中的一个小片段，用于显示“开始会话”的日志来自何处：**

```
$log->debug("page is secure, starting session now.");
session_start(); 
```

**以下是我来自contact.php的代码的相关部分：**

```
<?php
    ...
    //session is started by this first include when secure connection is verified
    include_once "../includes/varsAndSecurityCheck.php";
    //this just connects to my database, no session manipulation here
    include_once "../includes/dbConnect.php";
    //this includes some functions for generating a captcha image
    include_once "../captcha/CaptchaSecurityImages.php";

    //this is just including some basic styling and navigation  
    include '../includes/header.php';
?>
...
    <form method="post" action="contactSanitize.php">
    ...
            $log->debug("just before security image");
        ?>
            <div class="centerText">
                <?php
                    $log->debug("invoking security image functions");
                    $_SESSION['security_code'] = generateCode(8);
                    $log->debug("after security image functions, SESSION: ".print_r($_SESSION,true));
                ?>  
                <?=captchaSecurityImages($_SESSION['security_code'],320,70)?>

            </div>
            ...
            <div class="centerText">
                <input id="security_code" name="security_code" type="text" maxlength="8" />
                <br><br>
                <input type="submit" name="submit" value="Send Message" class='generalFormButton' />
            </div>
        <?
            $log->debug("Just after security image");
        }

        ?> 
```

**这是我的 contactSanitize 页面的第一部分，您可以看到它在第一个条件下失败：**

```
<?php

//this starts the session when secure connection is made
include_once "../includes/varsAndSecurityCheck.php";
//This connects to database, no session manipulation here
include_once "../includes/dbConnect.php";
//This includes some e-mail functions, no session manipulation
include_once '../includes/mail.php';

$log->debug("SESSION: ".print_r($_SESSION,true));

$_SESSION['formData'] = array('visitor_name' => $_POST['visitor_name'],
                'visitor_email' => $_POST['visitor_email'],
                'ReasonForContacting' => $_POST['ReasonForContacting'],
                'message_body' => $_POST['message_body']
            );

if(!isset($_SESSION['security_code']) && !$authenticated)
{
    $log->debug("No security code and not authenticated, sending to contact page.");
    $_SESSION['contactError'] = "You must type the security code before sending a message.";
    header("Location: contact.php");
    exit();
}
... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-02T01:52:10.957

根据我的最后一条评论，“会话保存路径”设置不正确，现在已由我的托管服务提供商更正。

# c# - 如何确定我的移动 .net 应用程序在设备从睡眠模式唤醒后冻结的原因？

> ID：15823739
> 
> 赞同：1
> 
> 时间：2013-04-04T23:56:03.090
> 
> 标签：c#, .net, mobile, compact-framework

我有一个在摩托罗拉设备上运行的 .net 紧凑型移动应用程序（设备操作系统是使用 sdk 2.0 的 windows mobile 6.0）。

如果应用程序正在运行并且我将设备单独放置大约 20 分钟，它将处于睡眠模式。有时，在我通过点击电源按钮将其唤醒后，设备可以正常唤醒，但我的应用程序被冻结，无响应。我仍然可以看到上一个表单页面，但我无法对其进行任何操作。

不过，设备的其余部分是响应式的。即使尝试从任务管理器关闭应用程序也会失败。应用程序在冻结状态下保持“活动”。

有什么方法可以诊断这个吗？比如，有没有什么特殊的方法可以记录这个问题或通过设备找出发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T01:59:32.003

没有简单直接的方法，没有。设备退出挂起状态并从中断处恢复处理代码。如果您的应用程序冻结，可能是它正在等待某个已被挂起/恢复周期无效的句柄，但真正找到它的唯一方法是尝试双重方法：

1.  使用日志记录检测代码，因此当它冻结时，您可以缩小代码中发生的“位置”。
2.  同时，删除功能（服务、线程，无论您的代码库允许什么）以进一步减少测试的功能集。如果您删除了某个功能并且问题消失了，那么您就知道该去哪里找了。如果它没有消失，那么您已经从需要进一步检查中消除了整个代码分支。

# c# - 无法使用方法调用创建新线程

> ID：15823740
> 
> 赞同：0
> 
> 时间：2013-04-04T23:56:09.523
> 
> 标签：c#, multithreading

我有一个多线程问题。VS2010 不接受“sendCom(IP, com)”。错误：预期的方法名称

```
 private void sendCom(String com)
    {

        //send command 
        int i=0;
        String IP;
        foreach (var item in checkedListBox1.CheckedItems)
        {
            Console.WriteLine(item.ToString());
            IP = getIP(item);                
            theThreads[i] = new Thread(new ThreadStart( sendCom(IP, com) ));
            i++;
        }
    }

    private void sendCom(String IP, String com)
    {
        theSSHclass.RunSingleCom(IP, com);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:25:35.070

考虑表达式

```
new ThreadStart( sendCom(IP, com) ); 
```

它说调用`sendCom`并将结果传递给`ThreadStart`构造函数。这不是您想要的 - 您希望 ThreadStart 引用该`sendCom`函数，并让新线程传入`IP`and `com`。

执行此操作的典型方法就像 Hans Passant 所说：

```
var t = new Thread(new ThreadStart(() => sendCom(IP, com)));
t.Start(); 
```

在这里，您正在构建一个匿名函数，当被调用时，它将调用`sendCom`. 然后将其传递给新线程。新线程将调用它。

# json - 当我遇到 HTTPException 时，我的 JSON 响应应该包含什么？

> ID：15823745
> 
> 赞同：0
> 
> 时间：2013-04-04T23:56:54.563
> 
> 标签：json, rest, web-applications, asp.net-mvc-4, asp.net-web-api

我让用户在以下代码中注册我的应用程序：

```
 [System.Web.Http.HttpPost]
        [System.Web.Http.AllowAnonymous]
        //[ValidateAntiForgeryToken]
        //public HttpResponseMessage Register(RegisterModel model, string returnUrl)
        public UserProfileDto Register(RegisterModel model)
        {
            if (ModelState.IsValid)
            {
                if (WebSecurity.UserExists(model.UserName))
                {
                   throw new HttpResponseException(HttpStatusCode.Conflict);
                }
                else
                {
                    // Attempt to register the user
                    try
                    {
                        WebSecurity.CreateUserAndAccount(model.UserName, model.Password);
                        WebSecurity.Login(model.UserName, model.Password);

                        InitiateDatabaseForNewUser(model.UserName);

                        FormsAuthentication.SetAuthCookie(model.UserName, createPersistentCookie: false);

                        var responseMessage = new HttpResponseMessage(HttpStatusCode.Redirect);
                        responseMessage.Headers.Location = new Uri("http://www.google.com");

                        return _service.GetUserProfile(WebSecurity.CurrentUserId);
                    }
                    catch (MembershipCreateUserException e)
                    {
                        throw new HttpResponseException(HttpStatusCode.NotFound);
                    }
                }
            }

            // If we got this far, something failed
            throw new HttpResponseException(HttpStatusCode.NotFound);
        } 
```

我的问题：如果我遇到这些异常之一，我想告诉用户“嘿，该用户名已经存在！” 或“哎呀，发生了什么事。我们正在调查。” 等客户端，我应该如何处理这个？只需检查标题中的状态并相应地向视图发送一些内容？

这是否意味着每个可能的错误都应该使用不同的状态码？这似乎是错误的......这让我问 - 我应该将某种与状态相关的数据发送回客户端吗？如果是这样，我的返回类型（在本例中为 UserProfileDto）是否应该包含一个我可以填充但我认为适合我的控制器的“状态”字段？

抱歉，我在那里问了一堆......只是想弄清楚如何正确地做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T12:47:59.117

[ReasonPhrase](http://msdn.microsoft.com/en-us/library/system.net.http.httpresponsemessage.reasonphrase.aspx)的存在是为了提供一个关于错误发生原因的可读描述。如果简单的文本描述不足以将问题传达给最终用户，那么有一些新兴的标准方法可以向您的用户描述问题。

`application/api-problem+json` [https://datatracker.ietf.org/doc/html/draft-nottingham-http-problem-03](https://datatracker.ietf.org/doc/html/draft-nottingham-http-problem-03) `application/api-problem+xml`

`application/vnd.error+json` [https://github.com/blongden/vnd.error](https://github.com/blongden/vnd.error) `application/vnd.error+xml`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:05:49.493

我将使用允许您将注册信息或错误消息传递回客户端的模型。

模型可能看起来像：

```
public class RegistrationModel
{
    public UserProfileDto UserProfile { get; set; }
    public ErrorModel Error { get; set; }
}

public class ErrorModel 
{
    public string Message { get; set;}
} 
```

此外，您可能应该返回一个允许您指定模型的 HttpResponseMessage：

```
return Request.CreateResponse<RegistrationModel>(HttpStatusCode.Created, MyModel); 
```

# ruby - Time.now 与从 Time.parse 或 Time.at 生成的 Time 不匹配

> ID：15823749
> 
> 赞同：3
> 
> 时间：2013-04-04T23:57:18.627
> 
> 标签：ruby, time

在测试一些 Ruby 代码时，我遇到了一些奇怪的行为。有人可以解释为什么`Time.now`不匹配从其中创建`Time.at`或解析的同一时间`Time.parse`吗？

```
[1] pry(main)> require 'time'
=> true
[2] pry(main)> t = Time.now
=> 2013-04-04 19:46:49 -0400
[3] pry(main)> i = Time.at t.to_i
=> 2013-04-04 19:46:49 -0400
[4] pry(main)> t == i
=> false
[5] pry(main)> t.to_i == i.to_i
=> true
[6] pry(main)> p = Time.parse t.to_s
=> 2013-04-04 19:46:49 -0400
[7] pry(main)> t == p
=> false
[8] pry(main)> t.to_i == p.to_i
=> true
[8] pry(main)> t.class
=> Time
[9] pry(main)> i.class
=> Time
[10] pry(main)> p.class
=> Time
[11] pry(main)> t.inspect
=> "2013-04-04 19:46:49 -0400"
[12] pry(main)> i.inspect
=> "2013-04-04 19:46:49 -0400"
[13] pry(main)> p.inspect
=> "2013-04-04 19:46:49 -0400" 
```

## 更新 1

似乎甚至试图获得亚秒级精度也显示出相同的行为：

```
[1] pry(main)> t = Time.now
=> 2013-04-04 20:04:47 -0400
[2] pry(main)> f = Time.at t.to_f
=> 2013-04-04 20:04:47 -0400
[3] pry(main)> t == f
=> false
[4] pry(main)> t.to_f
=> 1365120287.902954
[5] pry(main)> f.to_f
=> 1365120287.902954 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T03:03:01.163

我会尝试“解释你所看到的”。以下是时间值的几个比较，以及在不同格式之间转换时会发生什么。我不打算进行任何相等性检查，因为您只需查看一个值就可以知道它是否应该匹配：

```
require 'time'                                         
t_now = Time.now # => 2013-04-04 20:10:17 -0700 
```

这就是`inspect`输出，它丢弃了大量的信息和精度。对于凡人来说已经足够好了。

```
t_now.to_f # => 1365131417.613106 
```

这是计算机通常看到的值，以微秒为单位。

```
t_now.to_i # => 1365131417 
```

那是同一时间，微秒都消失了。

```
Time.at(t_now)      # => 2013-04-04 20:10:17 -0700
Time.at(t_now.to_f) # => 2013-04-04 20:10:17 -0700
Time.at(t_now.to_i) # => 2013-04-04 20:10:17 -0700
t_now.to_s          # => "2013-04-04 20:10:17 -0700" 
```

只要值的整数部分完好无损，正常`inspect`和输出不会显示任何精度差异。`to_s`

```
Time.parse(t_now.to_s)      # => 2013-04-04 20:10:17 -0700
Time.parse(t_now.to_s).to_f # => 1365131417.0 
```

解析会丢失分辨率，除非您提供一个包含小数时间的值并定义解析格式以便`strptime`知道如何处理它。默认解析器格式是为通用设计的，而不是高精度的，所以我们必须使用`strftime`而不是允许`to_s`使用它的值，并`strptime`知道所有这些数字的含义：

```
T_FORMAT = '%Y/%m/%d-%H:%M:%S.%N' # => "%Y/%m/%d-%H:%M:%S.%N"
t_now.strftime(T_FORMAT)          # => "2013/04/04-20:10:17.613106000"
Time.strptime(t_now.strftime(T_FORMAT), T_FORMAT).to_f # => 1365131417.613106 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T00:27:50.507

小数秒不同：

```
>> t = Time.now
=> 2013-04-04 17:34:34 -0700
>> f = Time.at(t.to_f)
=> 2013-04-04 17:34:34 -0700
>> t.usec
=> 571153
>> f.usec
=> 571152
>> t.nsec
=> 571153000
>> f.nsec
=> 571152925 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T00:01:20.860

很可能这两个时间实际上是不同的，但是您没有看到与您选择的表示的差异。

尝试：

```
t.to_f == i.to_f 
```

我想你会看到它`t`比它更精确`i`。

内部`Time`表示为浮点值，精度为亚秒级。通常，您可以依赖它精确到百万分之一秒，有时甚至更多取决于您的操作系统。

# ruby-on-rails - 解释什么respond_to？: 应该在黄瓜里吗？

> ID：15823750
> 
> 赞同：1
> 
> 时间：2013-04-04T23:57:19.300
> 
> 标签：ruby-on-rails, cucumber

我第一次在铁轨和黄瓜上使用红宝石。我正在尝试定义步骤定义，并希望有人可以为我解释在步骤定义中找到的以下代码：

```
Then /^(?:|I )should see movies: "([^\"]*)"/ do |movie_list| #handles a text containing a text list of movies to check for
    if page.respond_to? :should
        page.should have_content(movie) #checks if movie appears on page
    else
    assert page.has_content?(text)
    end
end 
```

我的情况是：

```
Scenario: all ratings selected
Given I am on the RottenPotatoes home page
Then I should see all movies 
```

我正在尝试测试是否正在显示数据库中的所有项目。我应该在数据库的行上使用`.should`and 。`assert`我得到的提示是`assert`，`rows.should == value`但无法让它工作，因为我什至不明白！

所以在进一步了解后，我产生了以下方法来处理上述情况：

```
Then /^I should see all movies$/ do
  count = Movie.count
  assert rows.should == count unless !(rows.respond_to? :should)
end 
```

但是黄瓜仍然没有解决这种情况。建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T01:27:58.617

这是逐行解释：

```
Then /^(?:|I )should see movies: "([^\"]*)"/ do |movie_list| #handles a text containing a text list of movies to check for
  # Does page respond to the should method? If it does, RSpec is loaded, and
  # we can use the methods from it (especially the should method, but
  # sometimes others)
  if page.respond_to? :should
    # Does the page contain the string that the movie variable refers to?
    # I'm not sure where this variable is being defined - perhaps you mean
    # movie_list?
    page.should have_content(movie) #checks if movie appears on page
  else
    # RSpec is not installed, so let's use TestUnit syntax instead, checking
    # the same thing - but it's checking against the variable 'text' - movie_list
    # again? Or something else?
    assert page.has_content?(text)
  end
end 
```

考虑到所有这些 - 当您编写自己的步骤时，只需使用 RSpec 方法（如果您正在使用 RSpec）*或*TestUnit 方法。您不需要`if page.respond_to? :should`在步骤定义中的任何地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T01:30:05.893

好的，在您的步骤中，您的 Given 应该告诉 capybara 访问正确的页面

如

```
Given ....
  visit '/url for movies' 
```

这将访问 url 并将页面加载到 page 变量中

```
Then /^(?:|I )should see movies: "([^\"]*)"/ do |movie_list| #handles a text containing a text list of movies to check for
    page.should have_content 'something that you are looking for'
end 
```

如果您使用的是空白数据库，即其中没有电影，则需要在 Given 块中定义电影。

这里有一个很好的介绍[http://ruby.railstutorial.org/chapters/sign-in-sign-out#sec-cucumber](http://ruby.railstutorial.org/chapters/sign-in-sign-out#sec-cucumber)

# css - 添加不透明度以在滑块中溢出

> ID：15823753
> 
> 赞同：0
> 
> 时间：2013-04-04T23:57:31.573
> 
> 标签：css, drupal-7, slider, jquery-cycle

我的主页上有一个滑块。一切正常，但我正在尝试以 0.4 的不透明度进行溢出。我在 Drupal 7 中使用 jQuery 循环。这是我正在使用的代码。

```
 $('.view-slider-sports .view-content').cycle({
    fx:     'scrollLeft',
    speed:  'slow',
    timeout: 5000,
    next:   '.next2',
    prev:   '.prev2',
    delay: -1000,
  }); 
```

这个想法是让图像显示在“主要图像”的一侧。通常，我使用`overflow:hidden`.

如何显示所有图像，但仅将不透明度应用于滑块侧面的图像？

# api - 稳定的php api框架/CMF/CMS

> ID：15823754
> 
> 赞同：-1
> 
> 时间：2013-04-04T23:57:41.940
> 
> 标签：api, frameworks, content-management-system, stability

我正在寻找一个不会有太大变化并且会支持很*长时间*的 php API 。我将根据我未来工作的情况使用框架或 CMS，所以两者兼而有之。

这是我从研究中得到的：

框架：

*   Codeigniter 2 --> 稳定，但每个人都在质疑它的未来并且错过了模块化方法（很难找到最新的代码）。
*   Symfony 2 --> 有点慢，但总体上看起来不错。

CMF/CMS：

*   Wordpress --> 似乎是该类别中最稳定的 API 之一。

有没有我可以考虑的其他框架/CMS？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:12:11.683

Symfony 2 是 php 框架的最佳选择之一（我的观点和其他大佬的观点），但是当它从 symfony 1.4 出来时，它似乎是一个完全不同的框架，所以你可以用这个框架有一个很好的选择如果您仍在使用版本 2，但如果您想在未来升级可能会很困难，或者可能不会像从 1.4 到 2.0 那样发生很大变化，但这是一个机会。

Codeigniter 是稳定的，但我发现它只适用于小型项目，因为当您已经使用过 symfony 或其他框架时，您会发现 codeigniter 让您的文件结构混乱，特别是在同时工作的许多开发人员的情况下。Symfony 可帮助您更有条理。

Wordpress 在市场上确实是标准的，但是对于 bloggin，如果你需要集成，请注意，因为 wordpress 会在版本之间更改他们的 api，所以我会小心，如果我有集成，我更喜欢框架，因为 wordpress 更新很多年复一年，您可能需要不时更新您的代码。

我最后的推荐是**Symfony**，因为它是大块头，有很多文档，很多例子，每天都有更多的社区，让你的代码更有条理，这样你就不必寻找很多其他的了仅当您正在寻找具体的特征时，但我怀疑 symfony 无法做任何您想做的事情。

# ms-access - 值违反了验证规则

> ID：15823755
> 
> 赞同：0
> 
> 时间：2013-04-04T23:58:13.257
> 
> 标签：ms-access, validation, ms-access-2007

在我的表单上一切正常，当我在这个特定字段中输入不正确的数据时，我总是收到以下消息：

"*该值违反了字段或记录的验证规则"*

我不希望用户看到这条消息。不幸的是，这不是一条错误消息..我不知道为什么我会收到这个错误，因为我有我的验证规则并且文本工作正常

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T04:17:17.807

我需要为验证规则和验证文本制作所有组合框和文本框的问题..我只为一个文本框制作的问题就是为什么*值违反了字段的验证规则或记录*错误不断弹出

如果我完成了所有文本框和组合框验证文本消息框将只显示没有该错误..

# php - jQuery提交表单两次

> ID：15823756
> 
> 赞同：11
> 
> 时间：2013-04-04T23:58:13.727
> 
> 标签：php, jquery, forms, form-submit

我知道这个问题已经被回答了几百次，但我已经经历了很多潜在的解决方案，但它们似乎都不适用于我的实例。

以下是我的表单和提交表单的代码。它触发一个 PHP 脚本。现在我知道脚本本身不是提交的原因，因为我手动尝试了表单并且它只提交一次。

jQuery 代码的第一部分涉及打开一个灯箱并从下面的表格中提取值，我将其包括在内，以防万一它是一个潜在的问题。

jQuery代码：

```
$(document).ready(function(){
    $('.form_error').hide();
    $('a.launch-1').click(function() { 
        var launcher = $(this).attr('id'),
            launcher = launcher.split('_');
        launcher, launcher[1], $('td .'+launcher[1]);
        $('.'+launcher[1]).each(function(){
            var field = $(this).attr('data-name'),
                fieldValue = $(this).html();
            if(field === 'InvoiceID'){
                $("#previouspaymentsload").load("functions/invoicing_payments_received.php?invoice="+fieldValue, null, function() {
                    $("#previouspaymentsloader").hide();
                });
            } else if(field === 'InvoiceNumber'){
                $("#addinvoicenum").html(fieldValue);
            }
            $('#'+field).val(fieldValue);
        });
    });
    $("#addpayment_submit").click(function(event) {         
        $('.form_error').hide();  
        var amount = $("input#amount").val();  
        if (amount == "") {  
            $("#amount_error").show();  
            $("input#amount").focus();  
            return false;
        }
        date = $("input#date").val();  
        if (date == "") {  
            $("#date_error").show();  
            $("input#date").focus(); 
            return false;
        } 
        credit = $("input#credit").val(); 
        invoiceID = $("input#InvoiceID").val(); 
        by = $("input#by").val(); 
        dataString = 'amount='+ amount + '&date=' + date + '&credit=' + credit + '&InvoiceID=' + invoiceID + '&by=' + by;
        $.ajax({
            type: "POST",
            url: "functions/invoicing_payments_make.php",
            data: dataString,
            success: function(result) {
                if(result == 1){                    
                    $('#payment_window_message_success').fadeIn(300);
                    $('#payment_window_message_success').delay(5000).fadeOut(700);
                    return false;
                } else {
                    $('#payment_window_message_error_mes').html(result);
                    $('#payment_window_message_error').fadeIn(300);
                    $('#payment_window_message_error').delay(5000).fadeOut(700);
                    return false;
                }
            },
            error: function() {
                $('#payment_window_message_error_mes').html("An error occured, form was not submitted");
                $('#payment_window_message_error').fadeIn(300);
                $('#payment_window_message_error').delay(5000).fadeOut(700);
            }
        });
        return false;
    });
}); 
```

这是html表单：

```
<div id="makepayment_form">
  <form name="payment" id="payment" class="halfboxform">
    <input type="hidden" name="InvoiceID" id="InvoiceID" />
    <input type="hidden" name="by" id="by" value="<?php echo $userInfo_ID; ?>" />
    <fieldset>
      <label for="amount" class="label">Amount:</label>
      <input type="text" id="amount" name="amount" value="0.00" />
      <p class="form_error clearb red input" id="amount_error">This field is required.</p> 
      <label for="credit" class="label">Credit:</label>
      <input type="text" id="credit" name="credit" />
      <label for="amount" class="label">Date:</label>
      <input type="text" id="date" name="date" />
      <p class="form_error clearb red input" id="date_error">This field is required.</p>
    </fieldset>
    <input type="submit" class="submit" value="Add Payment" id="addpayment_submit">
  </form>
</div> 
```

希望有人能帮忙，因为它让我发疯。谢谢。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-09-08T07:42:28.527

有时，您不仅要阻止处理事件的默认行为，还要阻止执行任何下游事件处理程序链。这可以通过调用来[`event.stopImmediatePropagation()`](https://api.jquery.com/event.stopimmediatepropagation/)完成[`event.preventDefault()`](https://api.jquery.com/event.preventDefault/)。

示例代码：

```
$("#addpayment_submit").on('submit', function(event) {
  event.preventDefault();
  event.stopImmediatePropagation();
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-05T00:29:56.760

此外，您将操作绑定到提交按钮“单击”。但是，如果用户在输入文本字段时按下“输入”并触发默认表单操作怎么办？你的函数不会运行。

我会改变这个：

```
$("#addpayment_submit").click(function(event) {
    event.preventDefault();
    //code
} 
```

对此：

```
$("#payment").bind('submit', function(event) {
    event.preventDefault();
    //code
} 
```

**现在，用户如何**提交表单并不重要，因为无论如何您都会捕获它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-01-30T12:30:20.537

尝试添加以下行。

```
event.preventDefault(); 
event.stopImmediatePropagation(); 
```

这对我有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-15T10:33:27.940

虽然所有列出的解决方案都是有效的，但就我而言，导致我提交多个表单的原因是 ei 传递给了提交时调用的函数。

我有

```
$('form').bind('submit', function(e){
  e.preventDefault()
  return false
}) 
```

但我把它改成了

```
$('form').bind('submit', function(){
  event.preventDefault()
  return false;
}) 
```

这对我有用。不包括 return false 应该仍然不会阻止代码工作

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-05T00:07:49.337

在您的点击功能下方，将 a 添加`preventDefault()`到事件中。

```
$("#addpayment_submit").click(function(event) {
    event.preventDefault();
    // Code here
    return false;
}); 
```

这可能会解决您的问题。`preventDeafult()`停止触发默认事件。在这种情况下，您的表单在单击时触发，然后在您使用 ajax 函数发送时再次触发。

它还有助于`return false;`在点击功能的末尾添加（见上文）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-05T01:42:03.467

我最终根据@user2247104 的建议更改了脚本，不幸的是，表单仍然提交了两次。

然而@Cumbo，@Barmar 也在正确的轨道上，除了让它工作

`event.preventDefault();`

需要放在脚本底部：

```
});
event.preventDefault();
return false; 
```

感谢大家的帮助:)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-05T00:14:45.560

当您使用 AJAX 请求向服务器发送数据时，甚至没有理由使用`form`标签和`<input type="submit" .../>`（您可以使用简单的按钮）。我也认为 Cumbo 的回答应该有效。如果不行你也可以试试`event.stopPropagation()`。

# xcode - fscanf 读取的值不正确？-Xcode

> ID：15823757
> 
> 赞同：1
> 
> 时间：2013-04-04T23:58:20.680
> 
> 标签：xcode, fopen, output, scanf

我已将 File.rtf 放在目录中`library/Developer/Xcode/DerivedData/Test(projectname)/Build/Products/Debug`，代码似乎打开它，但打印出错误的输出。输出是`1606422622`文件中的任何整数值。

通过类似于我的问题的解决方案，答案是在正确的目录中获取输入文件。我想我已经做到了，但我无法获得正确的输出。

急需帮助。谢谢。

```
int main()
{
  int b;
  FILE *fp;
  fp=fopen("File.rtf","r");
  if (fp == NULL) {
    printf( "File doesn't exist!\n");
  }
  fscanf(fp,"%i",&b);
  printf("%i\n",b);

  fclose(fp);  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T01:08:44.640

看起来您正在尝试读取 RTF 格式的文件。尝试在 TextEdit 中将文件保存为“纯文本文件”。（带有扩展名 .txt）

![在此处输入图像描述](https://i.stack.imgur.com/e8BLR.png)

# css - 添加换行符 标签

> ID：15823761
> 
> 赞同：0
> 
> 时间：2013-04-04T23:58:44.027
> 
> 标签：css, pre

我正在将此 css 用于预标记。它不添加换行符并且代码是混合的。我想添加换行符，就像我们通过按回车在书写窗格中添加的一样。

```
pre {
        font-size:16px;
            overflow: auto;
        padding:10px;
        background-color: #f8f8f8;
        border: 1px solid #ddd;
            white-space: pre-wrap; /* css-3 */
            white-space: -moz-pre-wrap; /* Mozilla, since 1999 */
            white-space: -pre-wrap; /* Opera 4-6 */
            white-space: -o-pre-wrap; /* Opera 7 */
            word-wrap: break-word; /* Internet Explorer 5.5+ */ } 
```

# assembly - 在 mips 中打印消息

> ID：15823762
> 
> 赞同：2
> 
> 时间：2013-04-04T23:58:48.503
> 
> 标签：assembly, printf, mips

我的程序中有以下代码

```
li $v1, 4              #system call code for Print String
la $a0, LC             #load address of message into $a0
syscall                #print the string
li $v1, 1              #system call code for Print Integer
move $a0, $v0          #move value to be printed to $a0
syscall                #print result 
```

和

```
.rdata
LC: .asciiz "The factorial of 10 is : " 
```

但是当我尝试在 mips 中使用它时，它会说：

未知系统调用：3628800

其中 3628800 是我要打印的结果！

出了什么问题？我可以改用 jal printf 吗？我应该怎么写？提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T05:04:58.433

系统调用号进入`$v0`，不是`$v1`。

# php - 在 PHP 中访问对象内的数组值

> ID：15823763
> 
> 赞同：2
> 
> 时间：2013-04-04T23:58:50.700
> 
> 标签：php, arrays, object

我是 PHP 新手，正在尝试从以下访问“contactId”的值：

```
object(stdClass)#2 (4) { 
    ["contacts"]=> array(1) { 
        [0]=> object(stdClass)#3 (18) { 

            ["email"]=> string(24) "joewilliams@icontact.com" 
            ["firstName"]=> string(3) "Joe" 
            ["lastName"]=> string(8) "Williams" 
            ["prefix"]=> string(3) "Mr." 
            ["suffix"]=> string(3) "Jr." 
            ["fax"]=> string(0) "" 
            ["phone"]=> string(10) "8668039462" 
            ["street"]=> string(21) "2365 Meridian Parkway" 
            ["street2"]=> string(0) "" 
            ["city"]=> string(6) "Durham" 
            ["state"]=> string(2) "NC" 
            ["postalCode"]=> string(5) "27713" 
            ["createDate"]=> string(19) "2013-03-30 21:22:28" 
            ["status"]=> string(6) "normal" 
            ["bounceCount"]=> NULL 
            ["contactId"]=> string(8) "67295434" 
        } 
    } 
    ["limit"]=> int(20) 
    ["offset"]=> int(0) 
    ["total"]=> int(1) 
} 
```

如何检索contactId的值？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:59:56.000

这些不是数组，而是包含包含对象的数组的对象。PHP 对象访问语法是 with`->`

```
$variableName->contacts[0]->contactId 
```

# facebook - 如何从外部网站深度链接 Facebook

> ID：15823770
> 
> 赞同：1
> 
> 时间：2013-04-04T23:59:13.713
> 
> 标签：facebook, facebook-like, facebook-javascript-sdk, deep-linking

是否可以从 Facebook 外部创建链接来点赞 Facebook 内容（例如照片）？我尝试过将 Facebook URL 传递给标准的按钮工具，但它似乎不起作用。任何想法都非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T21:41:06.813

所以这是可能的。我通过设置 Facebook 应用程序并创建基本身份验证来完成这项工作。身份验证完成后，我使用 JS 从返回的 URL 中提取参数，并通过 POST 表单通过 graph.facebook.com传递照片和用户`access_token`来提交对所需照片的喜欢。看起来像这样。`FBID``access_token`

```
 <form>
       <a id="facebook-authentication" href="https://graph.facebook.com/oauth/authorize?type=user_agent&client_id=[YOUR_APP_ID_GOES_HERE]&redirect_uri=[YOUR_DESIRED_REDIRECT_PAGE_GOES_HERE]&scope=offline_access,publish_stream">
       <div id="facebook-authentication-button">
       START THE VOTE!
       </div>
       </a>
      </form> 
```

一些额外的 JS 用于在重定向时自动提交表单，但这不是设置提交类似 POST 请求所必需的。

# sql-server-2008 - 合并到和 scope_identity 问题

> ID：15823777
> 
> 赞同：3
> 
> 时间：2013-04-05T00:00:09.043
> 
> 标签：sql-server-2008, tsql, upsert

我正在使用 SQL Server 2008 并`merge into`从表值参数中获取我的数据。

```
 CREATE PROCEDURE [dbo].[SP1]
    (
    @p as TTVP readonly    
    )

AS
declare @ThisId int
Begin

     Merge into [dbo].[FIRSTTABLE] tp
     Using @p ps
     on tp.ID = ps.ID

     When Matched Then
     Update
     set tp.NAME = ps.NAME,
     tp.myDATE = Getdate()

     When Not Matched Then

     insert (NAME, myDATE)
     Values (ps.NAME, getDate());

     seclect @ThisId = identity_scope()

     insert into SECONDTABLE (ID,  myDATE) 
     select (@ThisId,  Getdate())

  END 
```

我想我从来没有从我的陈述中`scope_identity`得到身份证。`insert`

所以我的第一次更新和插入有效，但是如何获得第二次插入的插入 ID？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T01:25:21.680

这显示了如何从 MERGE 语句中记录 OUTPUT 数据。请注意，OUTPUT 子句跨越 MERGE 中的所有分支，包括 UPDATE 和 INSERT 部分。然后它使用inserted.id 和deleted.id 之间的不匹配来计算实际插入的内容。OUTPUT 子句显示了如何`name`从`inserted`虚拟表中继承列。

```
use tempdb;

-- create the test tables and table type
create table dbo.FirstTable (
    ID int identity primary key,
    NAME sysname,
    myDATE datetime);
GO
create table dbo.SecondTable (
    ID int primary key,
    myDATE datetime,
    NAME sysname);
GO
create type TTVP as TABLE(ID int, NAME sysname);
GO

-- create the procedure
CREATE PROCEDURE dbo.SP1
    @p as TTVP readonly
AS
SET NOCOUNT ON;

create table #cache (new_id int primary key, old_id int, name sysname);

merge into dbo.firsttable tp
using @p ps on tp.id = ps.id
when matched then
    update
       set tp.name = ps.name,
           tp.mydate = getdate()
when not matched then
    insert (name, mydate)
    values (ps.name, getdate())
output inserted.id, deleted.id, inserted.name into #cache;

insert into dbo.secondtable (id, mydate, name)
select new_id, getdate(), name
from #cache
where old_id is null;
GO

-- set up some test data (2 rows)
truncate table dbo.FirstTable;
insert dbo.FirstTable values ('abc', getdate());
insert dbo.FirstTable values ('ghi', getdate()-1);
GO

-- execute the procedure
declare @p TTVP;
insert @p values (1, 'abc'),(2, 'xyz'),(3, 'def');
exec dbo.SP1 @p;

-- check the results
select * from dbo.firsttable
select * from dbo.secondtable 
```

# c# - 是否可以有一个带有 & 符号的 REST url 参数？

> ID：15823778
> 
> 赞同：5
> 
> 时间：2013-04-05T00:00:09.347
> 
> 标签：c#, .net, rest

使用 System.ServiceModel 库进行路由，我有一个带有简单模板的 REST 服务，看起来像

> "{searchTerm}?opt={someSearchOpt}

所以调用看起来像：

> [http://myhost.contoso.com/searchapi/river%20expeditions](http://myhost.contoso.com/searchapi/river%20expeditions)

在没有选项的情况下搜索短语“river expeditions”。

这只是接受一个搜索短语并返回结果。它工作得很好。但是，如果搜索包含文字 & 符号的短语，例如“Lewis&Clark”，我尝试了明显的 url 编码 & 符号

> 刘易斯%26克拉克

但即便如此，请求甚至都不会被路由，但服务器会立即返回 400 Bad Request。很明显，它被解释为查询字符串分隔符，并使请求无效，因为此特定模板需要一个 url 参数并且没有前面的“？” 分隔符。

由于这些搜索词组可能有其他受限字符，因此它们应该是由客户端编码的 url，当它们被成功路由时，REST api 会在参数上调用 HttpUtility.UrlDecode。所以我的问题是，是否有某种技术可以将 url 编码的 & 符号正确路由为 rest url 参数，而不是作为查询字符串分隔符预先解释和拒绝？

更新：作为记录，如果搜索词预期为查询字符串参数（不是 url 参数），则发送*Lewis%26Clark*可以正常工作。例如

> [http://myhost.contoso.com/searchapi?searchTerm=lewis%26clark](http://myhost.contoso.com/searchapi?searchTerm=lewis%26clark)

因此，为了澄清，我希望在 REST 模板中使用 url 参数时获得相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-08T21:51:23.363

[这个](https://stackoverflow.com/questions/14359305/mvc-web-api-routing-fails-when-url-contains-encoded-ampersand)线程有一个类似的问题\解决方案。

正如上面链接的答案中提到的，我会避免在 uri 中对字符进行 url 编码，而是将它们放在查询字符串部分中。

# php - 将 JQuery 放入 PHP 文件

> ID：15823780
> 
> 赞同：1
> 
> 时间：2013-04-05T00:00:16.373
> 
> 标签：php, javascript, jquery

我正在尝试将 Jquery 放入 PHP 文件中。当我放入 HTML 文件时，我需要放入一个可以完美运行的 twitter 提要，但我无法让它在我的 homepage.php 文件中工作。

它来自[本教程](http://www.designchemical.com/blog/index.php/jquery/jquery-tutorial-create-a-jquery-twitter-feed-plugin/)。

我已经创建了单独的 javascript 文件并尝试回显脚本，但我没有运气。

这是php文件：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.twitter.feed.js"></script>

<script type="text/JavaScript">
    $(document).ready(function() {
        $('#twitter-feed').dcTwitterFeed({
            id: '#thepaulmac',
            tweetId: 'thepaulmac',
            retweets: false,
            replies: false,
            avatar: false,
            results: 20,
            images: 'small'
        });
    }); 

</script>

<?php get_header(); ?>
            <div id="twitter-feed"></div> 
```

有谁知道我必须做些什么才能让它工作？

我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:06:32.403

使用 php，您可以在之前的 HTML 链接之前添加 html

```
<?php 
```

或之后

```
?> 
```

它将被解释为普通的 HTML。只需使用

```
<script src="file goes here"> 
```

链接 jquery 脚本，并将代码放入：

```
<script></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:06:38.537

正如@nathan hayfield 所建议的那样，您可以将它放在 PHP 标记之外。如果你想在 PHP 标记中使用 echo 或 print，那么你可以这样做：

```
echo '<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js"></script>
      <script type="text/javascript" src="js/jquery.twitter.feed.js"></script>'; 
```

或者您可以使用这种语法，当我有一个带有引号和单引号的字符串时，我经常这样做：

```
$extra_js = <<<EXTRAJS
<script type="text/JavaScript">
$(document).ready(function() {  // using first example from the site you mentioned
    $('#twitter-feed').dcTwitterFeed({
        id: '#designchemical',
        tweetId: 'designchemical'
    });
});
</script>
EXTRAJS;

echo $extra_js;  // or pass it to a function or whatever 
```

# c# - 允许用户选择在服务器上保存文件的位置

> ID：15823781
> 
> 赞同：1
> 
> 时间：2013-04-05T00:00:30.643
> 
> 标签：c#, asp.net-mvc-3, fileserver

因此，当用户上传文件时，我需要允许他/她能够选择远程文件服务器上的位置。是否有任何文件选择器允许用户浏览文件服务器？如果它有所作为，这将通过一个 asp.net mvc-3 网站。（文件服务器只是一个远程硬盘）。

我需要一个正确方向的提示。我应该寻找/寻找什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:14:58.453

我认为您不会找到任何开箱即用的东西。基本上，您将需要创建一个 Treeview 文件浏览器菜单（对于 mvc 客户端 jquery 控件更可取，[jquery-file-tree](http://www.abeautifulsite.net/blog/2008/03/jquery-file-tree/)）功能，它代表用户可以保存的文件夹结构。然后，在选择正确的文件夹后，信息与上传的文件一起推送，mvc 控制器可以处理逻辑以保存在适当的文件夹中。
请注意，您需要应用程序池帐户在服务器上进行读/写访问才能保留文件。

# android - 策略游戏的战斗公式是什么？

> ID：15823786
> 
> 赞同：-3
> 
> 时间：2013-04-05T00:00:57.547
> 
> 标签：android, image, algorithm, shape, detect

我试图找到一种用于战略游戏战斗的算法，如 travian 或 ultima 之王或......但我编写的每个程序都有计算死士兵的错误，这个关键点的一些例子是：

1.  在现实世界中，当100名士兵攻击1名士兵时，通常100名士兵都活着，1名守军士兵都死了。
2.  寻找战斗的胜利者

数据示例是：

```
attacker:
Soldiers | defending-power | attacking-power | Soldier Count |
---------|-----------------|-----------------|---------------|
A        | 20              | 45              | 5
B        | 22              | 77              | 4
C        | 41              | 32              | 7
D        | 38              | 54              | 6
E        | 27              | 41              | 6

defender:
Soldiers | defending-power | attacking-power | Soldier Count |
---------|-----------------|-----------------|---------------|
A        | 44              | 12              | 6
B        | 59              | 18              | 6
C        | 73              | 40              | 7
D        | 26              | 61              | 2
E        | 7               | 24              | 4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:06:13.297

我建议两个玩家的士兵人数都遵循类似曲线的[指数衰减](http://en.wikipedia.org/wiki/Exponential_decay)，这取决于彼此的士兵人数。如在任何时间点，玩家 X 的士兵数量都会减少（Y 的士兵）*（Y 的攻击力）/（Y 的防御力），玩家 Y 的士兵数量也是如此。

如果两个玩家的实力相近，那么双方的兵力就会像曲线一样呈指数衰减下降，但是如果一个玩家的实力大大压倒对方，那么对方的兵力就会随着时间的推移而线性下降。（是的，在战斗结束之前将士兵计数视为浮点数。）

让算法与数据匹配将是一个确定你多久运行一次计算的过程（基本上，你将这个因素乘以多大），确定你是同时运行双方还是一方先减少另一方的士兵人数，是否你最后向上还是向下取整，以及攻击力/防御力部分是否真的像除以其他一样简单，或者你是否因为拥有优势而获得递减或失控的回报。

# java - 如何读取在其他 html 的其余部分之后加载的 html？

> ID：15823795
> 
> 赞同：0
> 
> 时间：2013-04-05T00:01:33.893
> 
> 标签：java, regex, bufferedreader

好的，对不起，这个问题是废话。很难提出问题：P

如果您将诸如 Thought 之类的词放入 dictionary.com 或任何不规则动词中，则发音 [thawt] 会在 html 的其余部分之后加载。

如果你检查我的代码，你会明白我的意思。而不是 [thawt] 它加载 [thingk]..

```
package OEpr;

import java.awt.EventQueue;
import java.awt.GridLayout;
import java.awt.Toolkit;

import javax.swing.JFrame;
import javax.swing.JButton;
import java.awt.GridBagLayout;
import java.awt.GridBagConstraints;
import java.awt.datatransfer.Clipboard;
import java.awt.datatransfer.ClipboardOwner;
import java.awt.datatransfer.StringSelection;
import java.awt.datatransfer.Transferable;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import java.net.URL;
import java.net.URLConnection;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import javax.swing.GroupLayout;
import javax.swing.GroupLayout.Alignment;
import javax.swing.LayoutStyle.ComponentPlacement;
import javax.swing.JTextField;

public class OEpr {

    private JFrame frame;
    private JTextField txtWord;
    private JTextField textpron;

    /**
     * Launch the application.
     */

    private static String wordurl;
    private static String line;
    private int linenum;
    private static int findingfirst = 0;
    private static String pron;
    StringSelection testcopy;

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                try {
                    OEpr window = new OEpr();
                    window.frame.setVisible(true);

                } catch (Exception e) {
                    e.printStackTrace();
                }
            }
        });

    }

    /**
     * Create the application.
     */
    public OEpr() {
        initialize();

        setvars();

    }

    public void setvars() {
        OEpr.wordurl = "http://dictionary.reference.com/browse/"
                + txtWord.getText();

    }

    public void geturl(String[] args) throws Exception {

        // Set URL

        URL url = new URL(wordurl);
        URLConnection spoof = url.openConnection();
        // Spoof the connection so we look like a web browser
        spoof.setRequestProperty("User-Agent",
                "Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0; H010818)");
        BufferedReader in = new BufferedReader(new InputStreamReader(
                spoof.getInputStream()));
        String uline = "";

        // Loop through every line in the source
        while ((uline = in.readLine()) != null) {

            System.out.println(uline);
            line = uline;

            linecheck();
        }
        // System.out.println(OEpr.line);
    }

    private void linecheck() {
        Pattern pattern = Pattern.compile("<!-- google_ad_section_start -->");
        Pattern pattern2 = Pattern.compile("\\[.*?]");
        Matcher matcher = pattern.matcher(OEpr.line);
        if (matcher.find()) {
            findingfirst++;
            // if(findingfirst==2){

            String noHTML = line.replaceAll("\\<.*?>", "");
            Matcher matcher2 = pattern2.matcher(noHTML);
            if (matcher2.find()) {
                pron = noHTML.replaceAll("(^.*(?=\\[))|((?<=\\]).*$)", "");
                // System.out.println(pron);
                textpron.setText(pron);
            }

            // }
            // System.out.println(matcher.group(0)); //prints /{item}/
        } else {
            // System.out.println("Match not found");
        }
    }

    public void setClipboardContents(String aString) {

        testcopy = new StringSelection(pron);

        Toolkit.getDefaultToolkit().getSystemClipboard()
                .setContents(testcopy, null);

    }

    /**
     * Initialize the contents of the frame.
     */
    private void initialize() {
        frame = new JFrame();
        frame.setAlwaysOnTop(true);
        frame.setResizable(false);
        frame.setSize(210, 100);
        JButton btnGo = new JButton("Go!");
        btnGo.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e) {

                // Execute when button is pressed
                try {
                    setvars();
                    OEpr.findingfirst = 0;
                    geturl(null);
                } catch (Exception e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }
            }
        });
        JButton btnCopy = new JButton("Copy!");
        btnCopy.addActionListener(new ActionListener() {

            public void actionPerformed(ActionEvent e) {

                // Execute when button is pressed
                try {
                    setClipboardContents(null);
                } catch (Exception e1) {
                    // TODO Auto-generated catch block
                    e1.printStackTrace();
                }
            }
        });

        txtWord = new JTextField();
        txtWord.setText("thought");
        txtWord.setColumns(10);

        textpron = new JTextField();
        textpron.setColumns(10);
        GroupLayout groupLayout = new GroupLayout(frame.getContentPane());
        groupLayout
                .setHorizontalGroup(groupLayout
                        .createParallelGroup(Alignment.LEADING)
                        .addGroup(
                                Alignment.TRAILING,
                                groupLayout
                                        .createSequentialGroup()
                                        .addGroup(
                                                groupLayout
                                                        .createParallelGroup(
                                                                Alignment.LEADING)
                                                        .addGroup(
                                                                groupLayout
                                                                        .createSequentialGroup()
                                                                        .addContainerGap(
                                                                                GroupLayout.DEFAULT_SIZE,
                                                                                Short.MAX_VALUE)
                                                                        .addComponent(
                                                                                txtWord,
                                                                                GroupLayout.PREFERRED_SIZE,
                                                                                GroupLayout.DEFAULT_SIZE,
                                                                                GroupLayout.PREFERRED_SIZE)
                                                                        .addPreferredGap(
                                                                                ComponentPlacement.RELATED))
                                                        .addGroup(
                                                                groupLayout
                                                                        .createSequentialGroup()
                                                                        .addContainerGap()
                                                                        .addComponent(
                                                                                textpron,
                                                                                GroupLayout.PREFERRED_SIZE,
                                                                                GroupLayout.DEFAULT_SIZE,
                                                                                GroupLayout.PREFERRED_SIZE)
                                                                        .addPreferredGap(
                                                                                ComponentPlacement.RELATED)))
                                        .addGroup(
                                                groupLayout
                                                        .createParallelGroup(
                                                                Alignment.LEADING)
                                                        .addComponent(btnGo)
                                                        .addComponent(btnCopy))
                                        .addContainerGap()));
        groupLayout
                .setVerticalGroup(groupLayout
                        .createParallelGroup(Alignment.LEADING)
                        .addGroup(
                                groupLayout
                                        .createSequentialGroup()
                                        .addContainerGap()
                                        .addGroup(
                                                groupLayout
                                                        .createParallelGroup(
                                                                Alignment.BASELINE)
                                                        .addComponent(btnGo)
                                                        .addComponent(
                                                                txtWord,
                                                                GroupLayout.PREFERRED_SIZE,
                                                                GroupLayout.DEFAULT_SIZE,
                                                                GroupLayout.PREFERRED_SIZE))
                                        .addPreferredGap(
                                                ComponentPlacement.RELATED)
                                        .addGroup(
                                                groupLayout
                                                        .createParallelGroup(
                                                                Alignment.BASELINE)
                                                        .addComponent(btnCopy)
                                                        .addComponent(
                                                                textpron,
                                                                GroupLayout.PREFERRED_SIZE,
                                                                GroupLayout.DEFAULT_SIZE,
                                                                GroupLayout.PREFERRED_SIZE))
                                        .addContainerGap(
                                                GroupLayout.DEFAULT_SIZE,
                                                Short.MAX_VALUE)));
        frame.getContentPane().setLayout(groupLayout);
    }
} 
```

# javascript - Jsoup DOM 应用 onload java 脚本？

> ID：15823797
> 
> 赞同：0
> 
> 时间：2013-04-05T00:01:46.927
> 
> 标签：javascript, jsoup, onload, onload-event

我想知道我从 Jsoup 得到的 DOM

`Document doc = Jsoup.connect(page.getPageUrl()).get();`

它是否与我从浏览器获得的 DOM 相同（加载后）？换句话说，如果在 onload() 方法期间 javascript 进行了任何 DOM 操作，是否会在 Jsoup 返回 dom 之前发生？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:05:11.477

它与 Http Response 的主体相同，不受 javascript 操作。

一个简单的事实：Jsoup 没有任何 javascript 引擎来执行脚本，所以它基本上**不能**这样做。

# android - Android 和 Eclipse - 具有项目依赖关系的 java.lang.NoClassDefFoundError

> ID：15823800
> 
> 赞同：3
> 
> 时间：2013-04-05T00:02:08.493
> 
> 标签：android, eclipse, noclassdeffounderror, buildpath

我正在尝试在一个项目中构建一个抽象类作为模板并在另一个项目中实现它们。但是，当尝试运行实现模板 Activity 的 Activity 时，会弹出 NoClassDefFoundError。我已将模板项目添加到另一个的 Java 构建路径中，在“订购和导出”中检查它，清理了项目，但没有任何帮助。我还尝试使用 1.6 编译器编译项目。所有结果都出现相同的错误。当尝试将模板项目添加为 JAR 时，Eclipse 说存在清单文件的副本，并且不允许这样做。

有谁知道我还能做些什么来解决这个问题？

这是我收到的错误日志：

```
04-05 00:29:09.941: E/AndroidRuntime(1348): FATAL EXCEPTION: main
04-05 00:29:09.941: E/AndroidRuntime(1348): java.lang.IllegalStateException: Could not execute method of the activity
04-05 00:29:09.941: E/AndroidRuntime(1348):     at android.view.View$1.onClick(View.java:2144)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at android.view.View.performClick(View.java:2485)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at android.view.View$PerformClick.run(View.java:9080)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at android.os.Handler.handleCallback(Handler.java:587)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at android.os.Handler.dispatchMessage(Handler.java:92)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at android.os.Looper.loop(Looper.java:123)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at android.app.ActivityThread.main(ActivityThread.java:3683)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at java.lang.reflect.Method.invokeNative(Native Method)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at java.lang.reflect.Method.invoke(Method.java:507)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at dalvik.system.NativeStart.main(Native Method)
04-05 00:29:09.941: E/AndroidRuntime(1348): Caused by: java.lang.reflect.InvocationTargetException
04-05 00:29:09.941: E/AndroidRuntime(1348):     at java.lang.reflect.Method.invokeNative(Native Method)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at java.lang.reflect.Method.invoke(Method.java:507)
04-05 00:29:09.941: E/AndroidRuntime(1348):     at android.view.View$1.onClick(View.java:2139)
04-05 00:29:09.941: E/AndroidRuntime(1348):     ... 11 more
04-05 00:29:09.941: E/AndroidRuntime(1348): Caused by: java.lang.NoClassDefFoundError:  scf1984.games.testQuest.TestQuestActivity
04-05 00:29:09.941: E/AndroidRuntime(1348):     at scf1984.games.testQuest.TestMainActivity.startTestQuest(TestMainActivity.java:18)
04-05 00:29:09.941: E/AndroidRuntime(1348):     ... 14 more 
```

和清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="scf1984.games.testQuest"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="scf1984.games.testQuest.TestMainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="scf1984.games.testQuest.TestQuestActivity"
        android:label="@string/app_name" >

    </activity>
</application>

</manifest> 
```

调用方法：

```
 public void startTestQuest(View v) {
    Intent i = new Intent(this,
            scf1984.games.testQuest.TestQuestActivity.class);
    startActivity(i);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T01:24:49.980

您需要将“模板项目”标记为 Android 库项目。转到 Project->Properties->Android 并检查“is library”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:05:13.090

您很可能缺少 Android 清单中的活动声明。您应该粘贴完整的错误和您的 AndroidManifest.xml

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T01:12:24.767

意图意图 = (Intent)new Intent();

intent.setClassName（包名，包名+类）；

开始活动（意图）；

试试这个

# haskell - 在扩展时将无符号整数解释为有符号

> ID：15823805
> 
> 赞同：4
> 
> 时间：2013-04-05T00:03:12.157
> 
> 标签：haskell, integer

假设我有很多 type `Word8`,`Word16`和的值`Word32`。我想扩大它们，将一些解释为已签名，一些解释为未签名，以便我可以将它们全部存储在`[Int64]`. 我知道我可以编写类似以下函数的内容，其中第一个参数指定我们是否要解释`Word8`为带符号的：

```
convert8 :: Bool -> Word8 -> Int64
convert8 False i = fromIntegral i
convert8 True  i = fromIntegral (fromIntegral i :: Int8) 
```

这给了我想要的结果：

```
*Main> convert8 False 128
128
*Main> convert8 True 128
-128 
```

不过，替身`fromIntegral`对我来说并不优雅。有没有更好的方式来表达“将其解释`Word`为有符号整数并将其粘贴在更大的位置`Int`”？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T07:49:58.527

据我回忆，GHC 将所有整数存储为一个机器字。（换句话说，32 位 GHC 将整数存储为 32 位。64 位 GHC 将它们存储为 64 位。）因此，如果您请求一个 8 位整数，它无论如何都将其存储为 32 位，但仅*使用*前 8 位。

正因为如此，我相当确定`fromIntegral`在运行时扩大或缩小使用实际上是无操作的；它所做的只是更改类型签名，没有运行时成本。（然而，从无符号转换为有符号可能会进行符号扩展。我不完全确定那部分是如何工作的。不过它可能仍然是一条机器指令。）

简而言之，我认为双重`fromIntegral`可能是做到这一点的最佳方式。您可以自己手动实现符号扩展，但执行此操作的内置机器指令可能会更快。

# jquery - jQuery在值和自动之间平滑切换css宽度

> ID：15823807
> 
> 赞同：0
> 
> 时间：2013-04-05T00:03:37.557
> 
> 标签：jquery, toggle

我希望在值和自动之间*平滑*切换 div 的 css 宽度。我目前有这个，因为这是我知道实现几乎我想要的第二好的选择。

**通过这样做，我希望创建一个与图像和名称一样宽的单击菜单。**

```
$('#LoginButton').click(function(){
    $(this).css('width', 'auto'),
    $("#profile").delay(100).toggle(300);
}); 
```

我发现的其他切换功能不适用于“auto”作为值，我觉得这很奇怪。

在切换选项旁边，我希望 div 及其内容“平滑”变宽，而不是在单击后弹出。

jsFiddle：http: [//jsfiddle.net/EverybdyLies/jaxpd/1/](http://jsfiddle.net/EverybdyLies/jaxpd/1/)

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:31:55.850

[更新小提琴](http://jsfiddle.net/jaxpd/3/)

它没有优化，但它足够清晰（我希望），所以你可以看到另一种顺利完成它的方法。

```
$('#parent').mouseenter(function(){
        $("#LoginButton").css('width', '500'),
        $("#profile").delay(100).toggle(300);
});
$('#parent').mouseleave(function(){
        $("#LoginButton").css('width', '20'),
        $("#profile").delay(100).toggle(300);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:46:43.090

您可以使用 animateAuto 插件[http://jsfiddle.net/basarat/jaxpd/7/](http://jsfiddle.net/basarat/jaxpd/7/)来做到这一点：

```
jQuery.fn.animateAuto = function(prop, speed, callback){
    var elem, height, width;
    return this.each(function(i, el){
        el = jQuery(el), elem = el.clone().css({"height":"auto","width":"auto"}).appendTo("body");
        height = elem.css("height"),
        width = elem.css("width"),
        elem.remove();

        if(prop === "height")
            el.animate({"height":height}, speed, callback);
        else if(prop === "width")
            el.animate({"width":width}, speed, callback);  
        else if(prop === "both")
            el.animate({"width":width,"height":height}, speed, callback);
    });  
}

$('#LoginButton').toggle(

function () {
    $(this).stop().animateAuto('width',600);
    $("#profile").delay(100).toggle(300);
},

function () {
    $(this).stop().animate({
        width: '20px'
    })
    $("#profile").delay(100).toggle(300);
}); 
```

**更新**要使用 jquery 1.9 及更高版本，切换功能的行为发生了一些变化：http: [//jquery.com/upgrade-guide/1.9/#toggle-function-function-removed](http://jquery.com/upgrade-guide/1.9/#toggle-function-function-removed)所以要与那些你需要迁移插件的人一起使用它。使用 jQuery 1.9 进行示例并迁移 1.1：http: [//jsfiddle.net/basarat/jaxpd/18/](http://jsfiddle.net/basarat/jaxpd/18/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T01:18:02.127

有点黑客，但尝试这样的事情。

```
$('#LoginButton').click(function()
{
    // Show the menu, but offscreen
    var profile = $('#profile')
        .css('position', 'absolute')
        .css('left', '-10000px')
        .css('top', '0')
        .show ();

    // Get the width of the menu
    var width = profile.width ();

    // Hide the menu and put it back into document flow
    profile
        .hide()
        .css('position', 'static')
        .delay(100)
        .toggle(300);

    // Resize the login button
$(this).animate({'width': width}, 500);
}); 
```

[在这里](http://jsfiddle.net/jaxpd/17/)更新小提琴

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T03:15:52.820

问题的症结在于没有人`$.stop(true,false).animate({width: 'toggle'});`再谈论（已弃用？）。

此外，`display:inline-block`当您不想占用所有可用空间但又不希望您的元素像`display:inline`.

我对其进行了一些更改以显示它是如何完成的，但是仍然需要做一些工作才能使文本正确显示。

[http://jsfiddle.net/CTms3/2/](http://jsfiddle.net/CTms3/2/)

jQuery（和任何其他动画的 js lib）仍然是优越的，因为 css3 转换（动画）仍然不考虑`auto`或折叠元素在收缩时使用的空间`transform: scale`（也许有一种方法，但我不知道它是什么）是）。

我还建议您使用上面的第一个代码直接操作大多数动画。如果您在小提琴中快速单击按钮，您会注意到`#username`每次单击都会改变方向，而`#profile`不会一直来回移动。那是因为`stop(true,false)`。当 css 实际设置为最终状态时，它会中断动画。很方便。

你在一个很棒的轨道上。如果您想为问题添加更多细节或想弄清楚如何`#username`正确显示文本，请提出新问题，因为这个问题很可能在其核心得到回答。

# python - Python - CSV 阅读器 - For 循环读取行，但未到达文件末尾

> ID：15823812
> 
> 赞同：-1
> 
> 时间：2013-04-05T00:04:16.550
> 
> 标签：python, csv, eof

我开发了一个函数来聚合每个给定队列的总人口，并在文件中给出。此功能目前被使用两次。一次获得总[实际]人口，一次获得“病例”总数。我遇到了一个问题，该函数没有读取到“案例”文件的末尾。我实现了一个行计数器，它打印迭代的行数。人口档案计数器输出为 933，案例档案计数器输出为 911，这意味着它没有读取底部的 22 个案例。有人知道为什么会这样吗？

这是我定义的函数：

```
def newPopCount(filename, fileheader):
    rowCount = 0  # Row counter
    import csv
    popholder = []
    cohorts = []
    print (len(fileheader))
    for i in range(3, len(fileheader)):
        cohorts.append(fileheader[i])
    for i in range(len(cohorts)):
        popholder.append(0)

    popcsv = open(filename, 'r', newline = '')
    popreader = csv.reader(popcsv, delimiter = ',')

    for row in popreader:
        rowCount += 1
        counter = 0
        if row[0] == fileheader[0]:
            continue
        else:
            for i in range(3, len(fileheader)):
                popholder[counter] += int(row[i])
                counter += 1

    popcsv.close()  

    print (rowCount)  # Print row counter
    return popholder 
```

顺便说一句：`fileheader`是从另一个函数中获得的，就像它听起来的那样——文件的标题。此外，索引开始于`3`因为文件中的第一个条目是邮政编码、x 坐标和 y 坐标。

如果有人有任何想法，请分享！

这是新的案例文件，其中的数据是用逗号正确分隔的。还有第二个文件，其中包含数据原始状态的示例。这些数据在主函数调用中聚合，生成我们实际讨论的文件：[案例](https://gist.github.com/FortyLashes/14760c14f653e1889e61)

我还决定包含用于获取标题的代码。我通常通过设置一个等于它的变量来调用它：`thisHeader = getHeader('Cases.csv')`然后调用另一个函数`caseRecord = newPopCount('Cases.csv', thisHeader)`

这是`getHeader`功能：

```
`def getHeader(file):
    import csv
    headername = None
    charList = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', '!', '@', '#', '$', '%', '^', '&', '*', '(', ')', '+', '+', "'", '"', '{', '}', '[', ']', '?', '.', ',', '<', '>', '/', '~', '`', '-', '_']
    headercsv = open(file, 'r', newline = '')
    headerreader = csv.reader(headercsv, delimiter = ',')
    for row in headerreader:
        if row[0][0] in charList and row[1][0] in charList:
            headername = row
    headercsv.close()
    return headername` 
```

再次感谢您的观看！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T01:01:39.357

我下载了你的要点并将其保存为`cases.tsv`.

然后我修改了你在ing 文件后`newPopCount`立即执行的操作，并将下一行更改为使用而不是.`popcsv.readline()``open``delimiter='\t'``delimiter=','`

然后我用这条线运行它：

```
h = newPopCount('cases.tsv', ['zcta', 'xcoord', 'ycoord', 'm5064', 'm6574', 'm75plus', 'f5064', 'f6574', 'f75plus']) 
```

它打印出 932。

由于有 933 行，其中之一是标题（不计算在内），这是正确的答案。

所以，我最好的猜测是你只是在错误的文件上运行它，这就是你得到错误答案的原因。

您的代码中存在错误并非*不可能*，并且您上传的不正确示例数据恰好正好抵消了该错误……但这似乎不太可能。如果您可以向我们提供实际文件、实际在该文件上运行的代码以及调用该`newPopCount`函数的代码，那么排除这种可能性应该是微不足道的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T15:14:36.490

这不是您问题的答案——所以我将它设为 CW——但您可能有兴趣查看[pandas](http://pandas.pydata.org/)库。它使处理表格数据比其他方式更有趣。

首先读入数据（我在`NewCaseFile`这里使用你的，这似乎是逗号分隔的，所以我称之为`ncf.csv`）：

```
>>> import pandas as pd
>>> df = pd.read_csv("ncf.csv")
>>> df
<class 'pandas.core.frame.DataFrame'>
Int64Index: 932 entries, 0 to 931
Data columns (total 9 columns):
zcta       932  non-null values
xcoord     932  non-null values
ycoord     932  non-null values
m5064      932  non-null values
m6574      932  non-null values
m75plus    932  non-null values
f5064      932  non-null values
f6574      932  non-null values
f75plus    932  non-null values
dtypes: float64(1), int64(8)
>>> df.head() # look at the start of the frame
    zcta    xcoord   ycoord  m5064  m6574  m75plus  f5064  f6574  f75plus
0  51062  211253.4  4733175      0      0        1      0      0        0
1  51011  212255.6  4757939      0      0        1      0      0        0
2  51109  215303.5  4721048      0      1        7      0      1        2
3  51001  215651.1  4746655      1      0        4      0      1        0
4  51103  216887.7  4713568      4      9       28      1      1        8 
```

使用 x,y,zip 列作为索引，并在总体列中求和：

```
>>> df = df.set_index(["zcta", "xcoord", "ycoord"])
>>> df["total"] = df.sum(axis=1)
>>> df.head()
                        m5064  m6574  m75plus  f5064  f6574  f75plus  total
zcta  xcoord   ycoord                                                      
51062 211253.4 4733175      0      0        1      0      0        0      1
51011 212255.6 4757939      0      0        1      0      0        0      1
51109 215303.5 4721048      0      1        7      0      1        2     11
51001 215651.1 4746655      1      0        4      0      1        0      6
51103 216887.7 4713568      4      9       28      1      1        8     51 
```

按列求和：

```
>>> df.sum()
m5064       981
m6574      1243
m75plus    2845
f5064      1355
f6574      1390
f75plus    1938
total      9752
dtype: int64 
```

等等。特别是，它可以更容易地进行许多其他直接解释但在实践中令人讨厌的转换。例如：

```
>>> df = pd.read_csv("ncf.csv")
>>> d2 = pd.melt(df, id_vars=list(df.columns[:3]))
>>> d2["sex"] = d2["variable"].str[:1]
>>> d2["age_lower"] = d2["variable"].str[1:3].astype(float)
>>> d2["age_upper"] = d2["variable"].str[3:].replace("plus", 100).astype(float)
>>> del d2["variable"]
>>> d2.rename(columns={"value": "count"}, inplace=True) 
```

给出：

```
>>> d2.head()
    zcta    xcoord   ycoord  count sex  age_lower  age_upper
0  51062  211253.4  4733175      0   m         50         64
1  51011  212255.6  4757939      0   m         50         64
2  51109  215303.5  4721048      0   m         50         64
3  51001  215651.1  4746655      1   m         50         64
4  51103  216887.7  4713568      4   m         50         64
>>> d2.groupby("sex")["count"].sum()
sex
f      4683
m      5069
Name: count, dtype: int64 
```

等等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T15:30:44.723

首先感谢大家考虑他的问题并试图帮助我。在回答 @abarnert 的问题时发现，我忘记`NewCaseFile.csv`在创建此聚合文件 ( ) 后关闭它。因此，添加`.close()`语句后，一切都开始正常工作。谢谢大家花时间看我的问题。

# c# - 多个标识列或自动递增的方法

> ID：15823814
> 
> 赞同：0
> 
> 时间：2013-04-05T00:04:38.033
> 
> 标签：c#, asp.net, sql, sql-server-2008

我`tOrder`在 SQL Server 2008 中有一个具有以下结构的表 ( )

```
orderID (int) - this is currently the primary key and the identity field.
name(varchar)
address(varchar)
groupID (int) - now this field i need to also auto increment, but at the same time i want to be able to insert values into. 
```

我的数据看起来像：

```
1 - john - address1 - 1
2 - mary - address2 - 1
3 - mary -address3 - 2
4 - jane - address4 - 3 
```

其中订单 ID 1 和 2 共享同一个 group ，而 3 和 4 属于他们自己的。

许多订单可以有相同`groupID`的，但是当我插入一个新组的订单时，我希望`groupID`自动填充下一个序列号，同时允许我在`groupID`需要时为不同的订单插入重复的订单。

希望这是有道理的。

我该怎么做呢？（我在后端使用 c#，如果这有什么不同的话）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:36:49.870

我将创建一个具有标识的新“组”表以确保唯一性，如下所示：

```
create table tOrders(
    orderID int PRIMARY KEY IDENTITY,
    name varchar(30),
    address varchar(60),
    fkGroup int
);
create table tGroups(
    groupID int PRIMARY KEY IDENTITY,
    description varchar(50)
);

ALTER TABLE tOrders 
ADD FOREIGN KEY (fkGroup) REFERENCES tGroups(groupID); 
```

当然，您必须为新插入的 tGroup (groupID) 值的 IDENTITY 提供 groupID。

此[SQL Fiddle 示例](http://sqlfiddle.com/#!3/4eb6e)演示了一种填充表的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:16:05.867

一种选择是在您的 torder 表上创建一个触发器（不是触发器的粉丝，但考虑到您的标准，想不出另一种选择）。

```
CREATE TRIGGER tOrder_trigger
   ON  tOrder
   AFTER INSERT
AS 
   UPDATE tOrder
   SET groupid = (SELECT COALESCE(MAX(groupid),0) + 1 FROM tOrder)
   FROM INSERTED AS I
   WHERE I.groupid IS NULL
   AND tOrder.orderid = I.orderid; 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!3/5d88a/1)

这将检查插入的记录是否具有`NULL`使用 的 groupid `INSERTED`，如果是，则将表更新为`MAX(groupid) + 1`，使用`COALESCE`来检查`NULL`。

# hittest - 我怎样才能让这个热门测试工作

> ID：15823817
> 
> 赞同：0
> 
> 时间：2013-04-05T00:04:55.237
> 
> 标签：hittest

我正在创建一个游戏，你作为玩家拿着棒球棒，当你点击按钮时，你挥动你的球棒。当你挥动你的球棒时，你击中了敌人，敌人会像高尔夫球一样朝你击中他们的相反方向飞去。我已经完成了移动和攻击功能的工作，但是我怎样才能注册命中测试，以便它在面对敌人时击中敌人并且敌人向后退。这是我到目前为止所做的：

```
package 
{
    import flash.display.MovieClip;
    import flash.events.Event;
    import flash.events.KeyboardEvent;
    import flash.events.MouseEvent;
    import flash.ui.Keyboard;

    public class Player extends MovieClip
    {
        var walkSpeed:Number = 4;
        var walkRight:Boolean = false;
        var walkLeft:Boolean = false;
        var walkUp:Boolean = false;
        var walkDown:Boolean = false;
        var attacking:Boolean = false;

        public function Player()
        {
            stage.addEventListener(KeyboardEvent.KEY_DOWN , walk);
            addEventListener(Event.ENTER_FRAME, Update);
            stage.addEventListener(KeyboardEvent.KEY_UP, stopWalk);
            stage.addEventListener(MouseEvent.CLICK, attack);
        }

        function walk(event:KeyboardEvent)
        {

            if (event.keyCode == 68)
            {
                walkRight = true;
            }
            if (event.keyCode == 87)
            {
                walkUp = true;
            }
            if (event.keyCode == 65)
            {
                walkLeft = true;
            }
            if (event.keyCode == 83)
            {
                walkDown = true;
            }
        }

        function Update(event:Event)
        {
            if (attacking == true)
            {
                walkRight = false;
                walkLeft = false;
                walkUp = false;
                walkDown = false;
            }
            else if (attacking == false)
            {
                var dx = parent.mouseX - x;
                var dy = parent.mouseY - y;
                var angle = Math.atan2(dy,dx) / Math.PI * 180;
                rotation = angle;

                if (walkRight == true)
                {
                    x +=  walkSpeed;
                    gotoAndStop('walk');
                }
                if (walkUp == true)
                {
                    y -=  walkSpeed;
                    gotoAndStop('walk');
                }
                if (walkLeft == true)
                {
                    x -=  walkSpeed;
                    gotoAndStop('walk');
                }
                if (walkDown == true)
                {
                    y +=  walkSpeed;
                    gotoAndStop('walk');
                }
            }

        }

        function stopWalk(event:KeyboardEvent)
        {
            if (attacking == false)
            {
                if (event.keyCode == 68)
                {
                    event.keyCode = 0;
                    walkRight = false;
                    gotoAndStop('stance');
                }
                if (event.keyCode == 87)
                {
                    event.keyCode = 0;
                    walkUp = false;
                    gotoAndStop('stance');
                }
                if (event.keyCode == 65)
                {
                    event.keyCode = 0;
                    walkLeft = false;
                    gotoAndStop('stance');
                }
                if (event.keyCode == 83)
                {
                    event.keyCode = 0;
                    walkDown = false;
                    gotoAndStop('stance');
                }
            }
        }

        function attack(event:MouseEvent)
        {
            if (attacking == false)
            {
                attacking = true;
                gotoAndStop('attack');
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:17:27.447

当角色的方向改变时，根据他们现在面对的方式改变一个变量，例如；direction = 0 当他们朝下时，1 当他们朝右时，等等。然后使用这个和敌人的位置来计算敌人是否被击中。为了让敌人飞回来，你会得到角色的方向来确定他们会飞回的方向。我会给出一些示例代码来帮助解释，但我在我的平板电脑上。

# mysql - 创建每日事件的问题

> ID：15823823
> 
> 赞同：0
> 
> 时间：2013-04-05T00:05:17.530
> 
> 标签：mysql

尝试在 mysql 中创建每日事件：

```
CREATE EVENT ResetStatus
    ON SCHEDULE
      EVERY 1 DAY
    DO

      BEGIN

            IF (DATE('2013-04-05') = CURDATE()) THEN
                UPDATE mytable
                SET resetstatus = 1
                WHERE id = (SELECT pid FROM usertable WHERE priority = 'A');

            END IF;

      END; 
```

得到一个错误：

```
Lookup Error - MySQL Database Error: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 12 
```

如果我将更新语句放入 TOAD 并运行，它运行时不会出现错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:07:52.707

如[定义存储程序](http://dev.mysql.com/doc/en/stored-programs-defining.html)中所述：

> 如果使用[**mysql**](http://dev.mysql.com/doc/en/mysql.html)客户端程序定义包含分号字符的存储程序，就会出现问题。默认情况下，[**mysql**](http://dev.mysql.com/doc/en/mysql.html)本身将分号识别为语句分隔符，因此必须临时重新定义分隔符，以使[**mysql**](http://dev.mysql.com/doc/en/mysql.html)将整个存储的程序定义传递给服务器。

您需要将您的客户端设置为使用除 之外的语句分隔符`;`，因为它当前认为它遇到的第一个分号（在`UPDATE`语句末尾）正在终止`CREATE EVENT`语句。

在 MySQL 命令行客户端中，可以使用以下`DELIMITER` [命令](http://dev.mysql.com/doc/en/mysql-commands.html)：

```
DELIMITER ;;  -- or anything else you like

CREATE EVENT ResetStatus
ON SCHEDULE
  EVERY 1 DAY
DO
  BEGIN

        IF (DATE('2013-04-05') = CURDATE()) THEN
            UPDATE mytable
            SET resetstatus = 1
            WHERE id = (SELECT pid FROM usertable WHERE priority = 'A');

        END IF;

  END
;;

DELIMITER ;  -- return to normal 
```

# python - Python - 捕获通过 SSH 执行的命令的退出状态

> ID：15823828
> 
> 赞同：1
> 
> 时间：2013-04-05T00:06:00.513
> 
> 标签：python, ssh, exit-code

我需要一种从通过 SSH 运行的命令中捕获退出状态的方法。希望退出状态以变量结束。我似乎无法让它工作。

命令会很简单，例如：

os.system("ssh -qt hostname 'sudo yum list updates --security > /tmp/yum_update_packagelist.txt';echo $?")

有人有想法吗？我尝试过的一切要么根本不起作用，要么最终给了我 ssh 命令的退出状态，而不是底层命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:13:39.423

您可能想要使用[Fabric](http://docs.fabfile.org/en/1.6/) api 而不是直接调用`ssh`可执行文件。

从那里，查看[在远程 shell 中使用 Fabric to run() 调用时可以捕获错误代码吗？](https://stackoverflow.com/q/4888568/90322)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:15:11.380

您可能想要使用 SSH 库，例如[`paramiko`](https://pypi.python.org/pypi/paramiko)（或[Fabric](https://pypi.python.org/pypi/Fabric)等……只需 google/PyPI/SO 搜索“Python SSH”即可查看所有选项并选择最符合您的用例的选项）。包含的演示正是您想要做的。[`spur`](https://pypi.python.org/pypi/spur)`paramiko`

如果您坚持编写命令行`ssh`工具的脚本，您 (a) 几乎肯定想要使用`subprocess`而不是`os.system`（正如`os.system`文档明确指出的那样），并且 (b) 将需要执行一些 bash 脚本（假设远程端正在运行 bash ) 将值传回给您（例如，将其包装在一个单行脚本中，该脚本在 上打印退出状态`stderr`）。

如果你只是想知道为什么你现有的代码不起作用，让我们来看看：

```
os.system("ssh -qt hostname 'sudo yum list updates --security > /tmp/yum_update_packagelist.txt';echo $?") 
```

首先，您正在运行一个`ssh`命令，然后是一个单独的`echo $?`命令，它将回显`ssh`. 如果要回显 的状态，则`sudo`需要将分号放入`ssh`命令中。（如果你想要`yum`, 里面的状态`sudo`。）

其次，[`os.system`](http://docs.python.org/2/library/os.html#os.system)不要看打印到什么`stdout`。正如文档清楚地说，“返回值是进程的退出状态”。因此，您将返回`echo`命令的退出状态，该状态几乎可以保证为 0。

因此，要完成这项工作，您需要将 echo 放到正确的位置，然后使用`subprocess.check_output`或类似的方法代替读取 stdout `os.system`，然后解析该输出以读取最后一行。如果你做了所有这些，它应该工作。但同样，你不应该这样做。只需使用`paramiko`或其他 SSH 库。

# python - 在 Python 中创建文件

> ID：15823831
> 
> 赞同：3
> 
> 时间：2013-04-05T00:06:11.283
> 
> 标签：python, python-3.x

我一直在查看[Python 3 中文件管理的教程，](http://docs.python.org/3/tutorial/inputoutput.html#reading-and-writing-files)但它没有提到如果文件不存在如何创建文件。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T00:07:49.197

只是模式`open`中的文件`w`，它将被创建。

如果您想尽可能打开现有文件，但要创建一个新文件（并且不想截断现有文件），请阅读链接中列出模式的段落。或者，有关完整的详细信息，请参阅[`open`](http://docs.python.org/3/library/functions.html#open)参考文档。例如，如果您想追加到末尾而不是从头开始覆盖，请使用`a`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T00:08:17.200

新文件仅在写入或追加模式下创建。

```
open('file', 'w') 
```

在外壳中：

```
$ ls
$ python -c 'open("file", "w")'
$ ls
file
$ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-05T00:08:22.650

当然。

```
 with open('newfile.txt', 'w') as f:
        f.write('Text in a new file!') 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-05T00:08:44.030

只需以写入模式打开文件：

```
f = open('fileToWrite.txt', 'w') 
```

请注意，这将破坏现有文件。最安全的方法是使用附加模式：

```
f = open('fileToWrite.txt', 'a') 
```

如[this answer](https://stackoverflow.com/a/15823854/129655)中所述，通常最好使用`with`语句来确保文件在完成后关闭。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-05T03:05:56.313

您可以制作两种类型的文件。一个文本和一个二进制文件。制作一个文本文件只需使用`file = open('(file name and location goes here).txt', 'w')`. 首先制作一个二进制文件`import pickle`，然后将数据（如列表数字等）放入其中，您需要使用'wb'并`pickle.dump(data, file_variable)`取出，您需要使用'rb'`pickle.load(file_variable)`并给它一个变量，因为是您引用数据的方式。这是一个例子：

```
import pickle #bring in pickle
shoplistfile = 'shoplist.data'
shoplist = ['apple', 'peach', 'carrot', 'spice'] #create data
f = open(shoplistfile, 'wb') # the 'wb'
pickle.dump(shoplist, f) #put data in
f.close
del shoplist #delete data
f = open(shoplistfile, 'rb') #open data remember 'rb'
storedlist = pickle.load(f)
print (storedlist) #output 
```

请注意，如果存在这样的文件，它将被覆盖。

# lua - 魔兽世界 Lua - 改变框架：SetAttribute()

> ID：15823838
> 
> 赞同：1
> 
> 时间：2013-04-05T00:07:02.803
> 
> 标签：lua, add-on, world-of-warcraft

我正在为魔兽世界开发一个插件，它会彻底改变界面以适应我的游戏风格。

在这个插件中，我想要一个大按钮，作为我的法师的“主要 dps 旋转”。我希望它根据任何给定时间的最佳咒语来改变它施放的咒语。它不会自动施法，它只是为用户提供下一个最佳选择。

到目前为止，这是我的代码：

```
print "Interface Overhaul : LOADED"
heatingUpIsActive = false
print(heatingUpIsActive)

local Button = CreateFrame("Button", "MyButton", UIParent,"SecureActionButtonTemplate")
Button:SetWidth(256)
Button:SetHeight(256)
Button:SetFrameStrata("HIGH")
Button:SetPoint("LEFT")
Button:SetText("Main Rotation")
Button:RegisterForClicks("AnyUp")
Button:SetAttribute("type", "spell")
Button:SetAttribute("spell", "Fireball")

Button:RegisterEvent("UNIT_AURA");
local function auraGained(self, event, ...)

    if (UnitAura("player", "Heating Up")) then
             if (heatingUpIsActive == false) then
             heatingUpIsActive = true
             print (heatingUpIsActive)
             print ("Heating Up is active!")
             Button:SetAttribute("spell", "Inferno Blast")
             end
            else
             heatingUpIsActive = false
             print("Heating Up is NOT active.")
             print(heatingUpIsActive)
    end
end
Button:SetScript("OnEvent", auraGained);

local tex = Button:CreateTexture("ARTWORK");
tex:SetPoint("LEFT")
tex:SetWidth(256)
tex:SetHeight(256)
tex:SetTexture("Interface\\AddOns\\InterfaceOverhaul\\Button2") 
```

如果`heatingUpIsActive == true`，我希望按钮转换`("spell", "Inferno Blast")`而不是，但如果我将其放入语句`("spell", "Fireball")`的正确部分，它就不起作用。`if`

有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T08:21:13.933

正如 Mud 所说，你不能再在战斗中重新绑定按钮了。暴雪做出这一改变是为了防止机器人能够自动战斗。值得注意的是，为了施展法术，您需要使用其中一个安全模板，而这些安全模板只允许修改控制它们在您不处于战斗中时的行为的属性。所以你不能在战斗中一键改变法术。同样，它们也会阻止您修改位置或可见性等属性，因此您也无法在鼠标下方移动按钮。

您可以做的最好的事情是显示应该施放什么法术的视觉指示器，但依赖于用户实际按下正确的按钮。

# grails - Grails 2.2.1 groupProperty 集成测试

> ID：15823840
> 
> 赞同：1
> 
> 时间：2013-04-05T00:07:13.460
> 
> 标签：grails, grails-orm

出于某种原因，groupProperty 不适用于我的集成测试。我收到以下异常：

> groovy.lang.MissingMethodException：没有方法签名：mypackage.CarIntTests.groupProperty() 适用于参数类型：(java.lang.String) 值：[car]

```
def names = ['Honda', 'Toyota', 'Nissan']
3.times {
    Garage.build(name: names[it])
}
def results = Garage.withCriteria {
    car {
        eq('brand', 'Honda')
    }
    projections {
        groupProperty('car')
    }
}
assert results == names[0..0] 
```

# .net - 将 DLL 嵌入到 .NET DLL / EXE 中时对内存和 CPU 的影响？

> ID：15823842
> 
> 赞同：3
> 
> 时间：2013-04-05T00:07:19.993
> 
> 标签：.net, performance, dll

我们有一个我们分发的 DLL，它对其他 DLL 具有外部依赖性。我们没有冒险丢失 DLL 或存在潜在的混合匹配情况，而是将 DLL 嵌入到我们自己的 DLL/EXE 中并在运行时加载它以满足运行时链接。

***问题：***

A) 之间

*   将 DLL 嵌入到我们的 .EXE/.DLL 中，然后在运行时将其加载到内存中，然后
*   将 DLL 作为一个单独的文件保存在文件系统上，然后让系统为我们加载它

哪种方法消耗更多内存，大约消耗多少？

B）有没有人有比上述更好的方法？*特别是对于下面详细信息*中的第 3 项。

* * *

*有兴趣的我们的流程的详细信息：*

1.  在我们知道在调用程序集中的代码之前运行的部分注册 AssemblyResolve 事件（例如：初始化时间）

    ```
    public void SomeInitCode()
    {
        ...
        AppDomain.CurrentDomain.AssemblyResolve += (sender, args) =>
        {
            string[] assemblyDetail = args.Name.Split(',');
            var assemblyName= assemblyDetail[0] + ".dll";

            var thisAssembly = Assembly.GetExecutingAssembly();
            var allResourceNames = thisAssembly.GetManifestResourceNames();

            string requiredResName = allResourceNames.SingleOrDefault(a => a.EndsWith(assemblyName));

            using (var input = thisAssembly.GetManifestResourceStream(requiredResName))
            {
                return input != null
                     ? Assembly.Load(StreamToBytes(input))
                     : null;
            }
        };
        ...
    }

    static byte[] StreamToBytes(Stream input)
    {
        var capacity = input.CanSeek ? (int)input.Length : 0;
        using (var output = new MemoryStream(capacity))
        {
            int readLength;
            var buffer = new byte[4096];

            do
            {
                readLength = input.Read(buffer, 0, buffer.Length);
                output.Write(buffer, 0, readLength);
            }
            while (readLength != 0);

            return output.ToArray();
        }
    } 
    ```

2.  嵌入程序集。这是通过“添加现有项目”到 .NET 项目 => 选择 .dll => 好的来完成的。返回并选择 .dll 并在属性中将“构建操作”更改为“嵌入式资源”。

3.  我们仍然需要添加相同的 .DLL 作为引用，并且仍然需要在`using ExternalNamespace;`使用它的类顶部的语句。如果没有，构建过程将失败，因为它在编译时看不到外部 DLL 代码。因此，作为构建后操作，我们必须从最终`bin`文件夹中删除 .DLL 文件（不是嵌入式克隆）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T11:13:54.827

正如马克所建议的那样。

我只会使用 ILMerge 将所有东西放在一起。

然而，这可能是不可能的，但应该适用于“纯”托管程序集（包括使用 的程序集`unsafe`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T11:04:35.890

答：只要内部组件本身没有太大的尺寸（例如，一些巨大的嵌入式资源），它应该可以*接受*- 这是一个有点扭曲的答案，但我没有比这更好的答案了“测量它”。我偶尔会做非常相似的事情（并且出于类似的原因）。

`f4`B：将参考属性 ( )上的“复制本地”设置为`False`。`using ExternalNamespace;`即使文件在同一个项目中，您也需要- 这只是让命名空间发挥作用。

# ruby - 创建一个红宝石宝石

> ID：15823843
> 
> 赞同：3
> 
> 时间：2013-04-05T00:07:20.893
> 
> 标签：ruby, rubygems

什么是学习如何创建红宝石的综合资源？

他们是付费解决方案，例如书籍吗？

我在互联网上和这里找不到太多，除了基本教程没有删减它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T00:13:40.093

权威指南是 RubyGem 自己的[Make Your Own Gem](http://guides.rubygems.org/make-your-own-gem/)（加上[其他指南](http://guides.rubygems.org/)）以及[Gem 规范参考](http://guides.rubygems.org/specification-reference/)。

Bundler 的[`bundle gem`命令](http://gembundler.com/v1.3/bundle_gem.html)对于创建一个好的骨架项目也很有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:30:45.183

您可以自己完成所有工作，也可以让另一个 gem 完成工作：

[逐步概述](http://www.slideshare.net/hagenburger/create-yourowngemwithgithubjewelerrubygems)使用[Jeweler](https://github.com/technicalpickles/jeweler) Gem 创建和发布宝石。更详细的说明[在这里](http://technicalpickles.com/posts/craft-the-perfect-gem-with-jeweler/)。

# iphone - 为什么我的图像不显示？

> ID：15823844
> 
> 赞同：0
> 
> 时间：2013-04-05T00:07:31.910
> 
> 标签：iphone, uiviewcontroller, xcode4, uiimage

我有一个继承自 UIViewController 的类，我们可以将其称为“控制器”，并带有 UICollectionView 的出口。从 UICollectionCell 继承的一个类叫它“A”，另一个从 UIImage 叫它“B”，A 有一个 B 的出口

我在“控制器”中编写了以下代码：

```
- (UICollectionViewCell *)collectionView:(UICollectionView *)p_collectionView    cellForItemAtIndexPath:(NSIndexPath *)p_indexPath
{
    UICollectionViewCell* cell = [self getUICollectionViewCellFromCollectionView:p_collectionView AtIndexPath:p_indexPath];
    if([cell isKindOfClass:[ImageCollectionViewCell class]] == YES)
    {
        //draw the image inside the view
        ImageCollectionViewCell* imageCell = (ImageCollectionViewCell*)cell;
        NSString* imageUrl = self.objectToShow.imagesURL[p_indexPath.item];
        UIImage* currentImage = [[UIImage alloc] initWithContentsOfFile:imageUrl];
        imageCell.imageView.image = currentImage;
    }

    return cell;
} 
```

一切都已正确初始化，但未显示图像，我不知道为什么会这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:45:50.230

`initWithContentsOfFile:`需要文件路径，而不是`URL`. 如果你使用 a `URL`，你应该使用`initWithContentsOfURL:`which 需要 a `NSURL`（不是 a `NSString`），所以你必须通过它`[NSURL URLWithString: imageUrl]`。

# python - 如何在 google appengine 上使用 python 实现分页？

> ID：15823845
> 
> 赞同：2
> 
> 时间：2013-04-05T00:07:35.070
> 
> 标签：python, google-app-engine, pagination

我正在建立一个像 reddit 这样的网站。对象按等级排序。我希望有人可以帮助我实现分页。我只想先加载前 20 个对象。然后单击“下一步”按钮，我希望根据第 20 个对象的评级加载接下来的 20 个对象。以下是谷歌文档：[https](https://developers.google.com/appengine/docs/python/datastore/queries?hl=en) ://developers.google.com/appengine/docs/python/datastore/queries?hl=en 。

有谁知道这样做的方法？或者那里有很好的教程？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T10:29:26.630

这是我用来检索我的模型实例和光标的通用函数。该函数接受参数，我从请求中读取它们。

```
def retrieve_dbs(query, order=None, limit=None, cursor=None, **filters):
  ''' Retrieves entities from datastore, by applying cursor pagination
  and equality filters. Returns dbs and more cursor value
  '''
  limit = limit or config.DEFAULT_DB_LIMIT
  cursor = Cursor.from_websafe_string(cursor) if cursor else None
  model_class = ndb.Model._kind_map[query.kind]
  if order:
    for o in order.split(','):
      if o.startswith('-'):
        query = query.order(-model_class._properties[o[1:]])
      else:
        query = query.order(model_class._properties[o])

  for prop in filters:
    if filters.get(prop, None) is None:
      continue
    if type(filters[prop]) == list:
      for value in filters[prop]:
        query = query.filter(model_class._properties[prop] == value)
    else:
      query = query.filter(model_class._properties[prop] == filters[prop])

  model_dbs, more_cursor, more = query.fetch_page(limit, start_cursor=cursor)
  more_cursor = more_cursor.to_websafe_string() if more else None
  return list(model_dbs), more_cursor 
```

你可以这样称呼它。我使用扩展 entity_db 和 entity_dbs 来表示我的变量引用实体对象，*_db 和 *_dbs 定义是否有一个或多个结果。

```
entity_dbs, entity_cursor = retrieve_dbs(
    model.Entity.query(),
    limit=limit,  # Your limit parameter
    cursor=cursor,  # The cursor if you want to grab a batch of next results
    order=order,
  ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T00:23:03.303

如果您在数据存储查询中使用 limit=20，这非常简单，然后获取一个游标以获取下一个 20。

# ruby-on-rails - Rails：引用错误类的命名空间类方法

> ID：15823848
> 
> 赞同：1
> 
> 时间：2013-04-05T00:07:51.550
> 
> 标签：ruby-on-rails, namespaces, class-method

我有两个模型，其中一个是命名空间的：

```
Group::Vote 
```

另一个不是：

```
Vote 
```

命名空间模型有一个类方法：

```
def self.get_user_value(voteable)
  Group::Vote.where(:user_id => User.current.id, :voteable_type => voteable.class.name, :voteable_id => voteable.id).first.value
end 
```

奇怪的是，当我这样调用该方法时：

```
Group::Vote.get_user_value(item) 
```

它被发送到`Vote`模型中类似命名的类方法。我是在做错什么，还是遇到了某种绝望的错误？

# php - “where 子句”中的未知列“Process_Status”

> ID：15823850
> 
> 赞同：2
> 
> 时间：2013-04-05T00:08:12.337
> 
> 标签：php, mysql

```
$result = mysql_query('SELECT * FROM ACCOUNTING WHERE  ACCTSTATUSTYPE = "Start" AND Process_Status IS NULL LIMIT 10');
if($result === FALSE) 
{
    die(mysql_error());
} 
```

以下代码吐回

> “where 子句”中的未知列“Process_Status”

但是，当我复制并粘贴此查询时

> SELECT * FROM ACCOUNTING WHERE ACCTSTATUSTYPE = "Start" AND Process_Status 为 NULL LIMIT 10

直接进入MySQL，就成功了。

我对 PHP/MySQL 有点陌生，所以在用 PHP 解析查询时，查询必须用不同的措辞吗？

谢谢，

马特

# c++ - C ++删除调用dylib（Xcode）中的重载运算符

> ID：15823855
> 
> 赞同：0
> 
> 时间：2013-04-05T00:08:27.030
> 
> 标签：c++, xcode, macos, oop, operator-overloading

我正在使用 Xcode 构建 C++ 代码，其中我正在调用 delete 来破坏内存，现在我加载了一个外部库，其中删除运算符重载，所以当我调用 delete 时，即使我在调用 lib 的删除运算符不打算这样做。

有人知道如何防止这种情况吗？

我从 lib 中找到了 operator delete 的修饰名称，但是我将如何告诉 Xcode 这些符号？如果我在我的项目中定义自己的操作符删除，我的代码由于重复符号错误而无法编译？

有人对此有任何线索吗？在此先感谢您的帮助。

# javascript - 类似 Gmail 的倒数计时器不起作用

> ID：15823856
> 
> 赞同：1
> 
> 时间：2013-04-05T00:08:34.733
> 
> 标签：javascript, jquery, timer, countdown

我一直在尝试重新创建一个倒数计时器，类似于 gmail 在您与互联网断开连接时使用的倒数计时器。ajax 请求失败，然后它开始一个短暂的倒计时，然后发出另一个 ajax 请求，如果再次失败，则开始一个更长的倒计时，依此类推。一旦达到确定的倒计时值（比如说 1 分钟），倒计时将保持在 1 分钟，直到互联网连接恢复或服务器恢复。

我不想使用插件，因为此代码将嵌入在空间有限的微控制器中，并且出于实际原因也不希望将其作为外部文件放置，即使 jQuery 库已经是外部的。

一切都应该触发`onload`，并自动继续（即不使用控制输入）。

到目前为止，如果 ajax 请求成功或立即失败，我已经开发了我想要的代码，但是如果 ajax 请求状态存在延迟（例如服务器关闭），浏览器将不会立即产生结果并且我的代码失败了。

我知道我上面所说的，因为我实际上关闭了服务器，并且得到了 Mozilla Firefox 上的萤火虫的帮助，看到没有立即触发 ajax 结果（成功或失败），而是等待几秒钟。

请帮忙！

**html代码：**

```
<div id='tempFail' ></div> 
```

**jQuery代码：**

```
$(document).ready(function()
{ 
    //do when DOM ready - http://api.jquery.com/ready/

    var timerSpeed = [1000, 5000, 10000, 20000, 30000, 60000];

    // current time in ms since 1/1/1970, plus the initial reload interval
    var end = (new Date).getTime() + timerSpeed[1];  
    var n=0;
    var m=0;

    setInterval(function() 
    {
        var now = (new Date).getTime();
        // Current time left to re-load in seconds, sometimes it goes to negative values, see below 

        var secLeft = Math.floor(( end - now ) / 1000);

        // if secLeft is negative multiply by zero...equal to secLeft=0, this will produce an error of one second approximately      
        var timeToload = (secLeft < 0) ? secLeft * 0 : secLeft;  

        if (n!=0) 
        { 
            //check for failed or delayed request\n\       

            $('#tempFail').html('Failed or delayed response. Will auto load in: '+timeToload+ ' seconds!'); 
        }

        if( (secLeft)<=0)// if reload time is reached do
        {                      

            if (m==0)//used to prevent multiple continue reloads when ajax request status is not yet defined
            {                            

                m=1;    

                $.getScript('script_vars.js').done(function (data) 
                {         
                    //if request succeeded
                    m=0;
                    n = 0;
                    end = (new Date).getTime() + timerSpeed[1];  
                    // Time to load after the initial interval set above
                    $('#tempFail').html(''); 

                //other code on success  here         
                })
                .fail(function() 
                {      
                    //if request failed
                    m=0;
                    n ++;
                    if(n==6) n=5;

                   switch(n){         //timer delay for failed request\n\

                     case 1:

                       end = (new Date).getTime() + timerSpeed[1];
                       break;

                     case 2:

                        end = (new Date).getTime() + timerSpeed[2];
                       break;

                     case 3:

                        end = (new Date).getTime() + timerSpeed[3];
                       break;

                     case 4:

                       end = (new Date).getTime() + timerSpeed[4];
                       break;

                     case 5:

                        end = (new Date).getTime() + timerSpeed[5];
                       break;  
                  } 

               });      

         }
        }                

        }, 1000);

     }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:44:16.110

您要求一个示例，所以我编写了以下内容，您可能希望将函数的内容包装在另一个函数中，以便您可以重复它/不必担心命名空间/等。没有测试所以不要指望没有错误！

使用`window.setTimeout`每个动作，将每个阶段分成自己的函数，以便更容易遵循代码路径。

```
$(document).ready(function () { // http://api.jquery.com/ready/
    var $tempFail = $('#tempFail'),
        delay = [1000, 5000, 10000, 20000, 30000, 60000],
        delay_index = 0,
        delay_ends = 0,
        inform_user_ref = null,
        inform_user = function inform_user() {
            var now = (new Date).getTime(),
                delta; // for difference, calculate later
            if (delay_ends > now) { // if we're waiting for a retry
                delta = Math.floor((delay_ends - now ) / 1000); // calculate time to wait
                $tempFail.html('Failed or delayed response. Will auto load in: '+delta+ ' seconds!'); // let people know
                window.setTimeout(inform_user, 200); // loop countdown timer
                // can fast refresh this as it's just a countdown
            }
        },
        get_success = function () {
            $tempFail.html('');
            // .. code on success
        },
        get_fail = function () {
            delay_index < 5 && ++delay_index; // increment delay_index
            get_initialise(); // retry
            window.clearTimeout(inform_user_ref); // remove any old countdown timer
            inform_user_ref = inform_user(); // and display new countdown
        },
        get_try = function () {
            $.getScript('script_vars.js')
                .done(get_success)
                .fail(get_fail);
        },
        get_initialise = function () {
            delay_ends = (new Date).getTime() + delay[delay_index];
            window.setTimeout(get_try, delay[delay_index]); // retry
        };
    get_initialise(); // initial
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:44:46.437

哇！Paul S. 先生，您的代码非常棒。我只是做了一些调整，让它在我需要的时候完美地工作。

1.  在 ajax 成功中添加了以下内容：

> delay_index = 0; //重置延迟索引
> 
> ```
> get_initialise(); // retry 
> ```

所以如果一切顺利，我会保持代码每 5 秒运行一次。

2.

添加了两个新变量：避免倒计时数字跳跃（让倒计时在开始下一个之前完成）`let_cntDwn_end`和`ajax_rqst_status`在ajax请求没有给出任何结果时显示一条消息。

**这是新代码：**

```
$(document).ready(function(){ //do when DOM ready - http://api.jquery.com/ready/

    var $tempFail = $('#tempFail'),
        delay = [5000, 5000, 10000, 20000, 30000, 60000],
        delay_index = 0,
        delay_ends = 0,
        inform_user_ref = null,
        let_cntDwn_end = 0,      
        ajax_rqst_status = 0,    //ajax success or failure triggered
        inform_user = function inform_user() {
            var now = (new Date).getTime(),
                delta; // for difference, calculated later
            if (delay_ends > now) { // if we're waiting for a retry
                let_cntDwn_end = 1;
                delta = Math.floor((delay_ends - now ) / 1000); // calculate time to wait
                if (ajax_rqst_status==0){
                  $tempFail.html('Failed response. Will auto load in: '+delta+ ' seconds!'); // let people know
                  window.setTimeout(inform_user, 900); // loop countdown timer
                  // can fast refresh this as it's just a countdown
                }
            }
            else {let_cntDwn_end = 0; get_try();}
        },
        get_success = function () {
               ajax_rqst_status =0;
               $tempFail.html('');
               // .. code on success           

               delay_index = 0; //reset delay_index
               get_initialise(); // retry           
        },
        get_fail = function () {                        
            ajax_rqst_status =0;
            delay_index < 5 && ++delay_index; // increment delay_index
            get_initialise(); // retry  
            window.clearTimeout(inform_user_ref); // remove any old countdown timer
            inform_user_ref = inform_user(); // and display new countdown

        },
        get_try = function () {
            if (let_cntDwn_end == 0){

                    ajax_rqst_status=1;
                   $tempFail.html('Waiting for Ajax request success or failure'); // let people know    

            $.getScript('script_vars.js')
                .done(get_success)
                .fail(get_fail);
                }
        },
        get_initialise = function () {
            delay_ends = (new Date).getTime() + delay[delay_index];
            window.setTimeout(get_try, delay[delay_index]); // retry
        };
    get_initialise(); // initial
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-11T10:22:03.587

还有 JS lib 可以通过监控 ajax 请求来为您处理这个问题。

[https://github.com/HubSpot/offline](https://github.com/HubSpot/offline)

# kendo-ui - 剑道网格更改指示器和取消不起作用

> ID：15823860
> 
> 赞同：1
> 
> 时间：2013-04-05T00:09:18.300
> 
> 标签：kendo-ui, kendo-grid

我是剑道和剑道网格的新手，但我正在尝试学习如何使用主细节剑道网格，其中细节网格应该支持批量编辑。数据在本地 JavaScript 对象中可用。

[这个 jsFiddle](http://jsfiddle.net/nmUX2/1/)演示了我看到的问题。

以下是网格的创建方式*- 请参阅 jsFiddle 以获取完整片段 -*

```
$("#grid").kendoGrid({
    dataSource: items,
    detailInit: createDetail,
    columns: [
        { field: "Item", width: "200px" },
    ]
});

function createDetail(e) {
    $("<div/>")
        .appendTo(e.detailCell)
        .kendoGrid({
            dataSource: {
                batch:true,
                transport: {
                    read: function (options) {
                        options.success(e.data.SubItems);
                    }
                }
            },
            editable:true,
            pageable:true,
            toolbar: ["save", "cancel"],
            columns: [
                { field: "SubItem", title: "Sub Item", width: 200 },
                { field: "Heading1", title: "Heading 1", width: 100 }
            ]
        });
} 
```

1.  当您编辑网格中的项目并单击下一个单元格时，无论我单击何处，即使在相邻单元格中，详细信息网格都会自动折叠。当我再次打开它时，我在单元格中看不到更改指示器（红色缺口），但新值在那里。如果我要将保存连接到 ajax 调用，Kendo 会发送已编辑的正确详细信息项。

2.  当我单击取消更改时没有任何反应。

如何让网格不折叠并查看更改指示器？

如何取消更改才能正常工作？

[更新] - 进一步调查显示，如果我使用较旧的 Kendo 版本 2011.3.1129 ，这将按预期工作。但如果我使用较新的 2012.3.1114，则不会。不知道这是错误还是行为变化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T17:10:51.113

经过一番努力，我发现原因似乎是主网格自动重新绑定导致我观察到的行为。我能够通过处理主网格中的 dataBinding 事件并在其中检查是否有任何详细数据源是脏的，如果是，则调用 preventDefault。

以下是相关的代码片段：

```
 dataBinding: function (e) {
               if (masterGrid.AreChangesPending()) {
                   e.preventDefault();
               } 
    }

    AreChangesPending : function () {
        var pendingChanges = false;
        // I gave each detail div an id so that I can get a "handle" to it 
        $('div[id^="detail_"]').each(function (index) {
            var dsrc = $(this).data("kendoGrid").dataSource;
            $.each(dsrc._data, function () {
                if (this.dirty == true || this.isNew()) {
                    pendingChanges = true;
                }
            });

            // For some reason, Kendo did not detect new rows in the isNew() 
            // call above, hence the check below
            if (dsrc._data.length != dsrc._total) {
                pendingChanges = true;
            }
        });

        return pendingChanges;
    } 
```

# php - 获取项目根目录

> ID：15823863
> 
> 赞同：0
> 
> 时间：2013-04-05T00:09:44.970
> 
> 标签：php, path

尝试包含在本地环境与生产环境中具有不同路径的文件时，我一直感到困惑。

例如，我的`usercontroller.php`文件中有这个：

```
require_once(__DIR__ . '/config.php'); 
```

在我的本地主机上，`usercontroller.php`位于`www/myproject/inc/`并且`config.php`位于`www/myproject/`（项目根目录）

这失败了。

我想要的只是一种定义项目根目录的方法。即在本地主机上它`www/projectname`在生产中`/`因为文件位于`projectname`我的本地主机上的目录中，所以它在我的生产服务器上引起问题。

简单定义基本路径并从中构建我的最佳方法是`require_once`什么？

IE`require_once($basePath . 'inc/filename.php'`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:15:16.397

大多数项目使用`config.inc.php`位于可以定义这些内容的公共位置的文件。

**配置文件**

```
define('ROOT_FOLDER', '/');
define('APPLICATION_LINK', 'http://www.example.com/mysite'); 
```

**脚本.php**

```
require ('../config.inc.php');
echo '<a href="' . APPLICATION_LINK . '">Go home</a>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:15:57.383

每个项目都应该包含一个包含此信息的 config.php 文件。

配置文件

```
define('ENVIRONMENT', 'PRODUCTION');
// define('ENVIRONMENT', 'TESTING');
// define('ENVIRONMENT', 'DEVELOPMENT');

switch (ENVIRONMENT) {
    case 'PRODUCTION':
        define('BASE_URL', 'http://www.mysite.com');
        define('BASE_PATH', '/');
        break;
    case 'TESTING':
        define('BASE_URL', 'http://test.mysite.com');
        define('BASE_PATH', '/test/');
        break;
    case 'DEVELOPMENT':
        define('BASE_URL', 'http://localhost/');
        define('BASE_PATH', '/www/myproject/');
        break;
} 
```

然后可能有一个 URL 帮助文件。

url_helper.php

```
function site_url($relative) {
    return BASE_URL . $relative;
}

function redirect($uri = '', $method = 'location', $http_response_code = 302) {
    if ( ! preg_match('#^https?://#i', $uri)) {
        $uri = site_url($uri);
    }

    switch($method) {
        case 'refresh' : header("Refresh:0;url=".$uri);
                break;
        default : header("Location: ".$uri, TRUE, $http_response_code);
                break;
    }
    exit;
} 
```

和一个负载助手。

load_helper.php

```
function load_file($uri) {
    require BASE_PATH . $uri;
}

function load_class($class) {
    if ( ! class_exists($class))
        load_file('class/' . $class);
} 
```

这些功能可以更强大，以满足您的需求。优点是您可以为生产/开发、各种服务器或仅针对特定环境进行不同的配置。如果您总是使用 site_url 函数在您的站点周围生成 URL，您可以通过在单个文件中进行一次更改来轻松更改 URL 的解释方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T00:18:25.097

也许这样的事情可以解决问题！

```
switch(dirname(__FILE__)) {
case '/www/myproject/inc/':
    //DEFINE SOMETHING
break;
case '/www/myproject/':
    //DEFINE SOMETHING
break;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T07:17:32.233

我知道这个答案已经晚了，但你还没有接受任何答案，所以我想我会把我在大多数应用程序中使用的东西扔进锅里。

首先，从您调用的文件`config.php`中，您将始终需要对其使用相对引用，即`require_once '../config.php';`来自您的示例。当然，您可以从 PHP 命令中“收集”配置文件的完整路径，但是当您知道它的一个目录时，*为什么*`define`要这样做，并且在其中，您可以然后是整个项目的基本路径。例如，在您的`www/myproject/inc/usercontroller.php`文件中，顶部看起来像：

```
<?php
require_once '../config.php'; 
```

然后，要自动获取项目的完整基本路径以用于其他包含等，在您的配置中，您将拥有如下内容：

```
<?php
$basepath = dirname(__FILE__);
define('BASEPATH', $basepath);
//Or all in one line:
define('BASEPATH', dirname(__FILE__)); 
```

从那里开始，只需`BASEPATH`在需要项目根目录的完整路径时使用。^^

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-05T00:30:43.927

如[文档](http://php.net/manual/en/language.constants.predefined.php) `__DIR__`中所述，返回使用它的文件的目录。

> **DIR** - 文件的目录。如果在包含中使用，则返回包含文件的目录。这相当于 dirname( **FILE** )。此目录名称没有尾部斜杠，除非它是根目录。（在 PHP 5.3.0 中添加。）

要在外部目录中包含文件，您必须使用`..`“退出”内部目录。

```
require_once(__DIR__ . '../config.php'); 
```

* * *

附带说明一下，如果您使用 PHP 的命名空间，我建议您查看[FIG 的自动加载标准。](https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-0.md)

# c# - 在 asp 项目中从 sqldatasource 显示数据列表中的数据时出错

> ID：15823864
> 
> 赞同：0
> 
> 时间：2013-04-05T00:10:07.020
> 
> 标签：c#, asp.net, sql, sqldatasource

我正在为一堂课建立一个网站，但遇到了一个我找不到解决方案的错误。我在页面上有一个下拉列表，显示客户名称并将所选值设置为从 sqldatasource 中选择的客户 ID（来自 access 数据库的数据表 - [**fig1**）](http://imgur.com/TB2vgDy)（这工作正常，因为我在添加第二个 sqldatasource 之前已经对其进行了测试） . 我向页面添加了一个 datalist 控件，并为要绑定的 datalist 添加了第二个 sqldatasource。我使用配置数据源向导配置了数据源，如图[**2 所示**。](http://imgur.com/6qJOUge,IPmqhp6,rgNjVcJ)然后我使用向导测试查询返回的数据并查看它是否有效，向导显示返回了我想要的数据。所以我将数据列表绑定到数据源，现在项目模板（在 html 源视图中）包含将显示值的数据绑定标签：

```
Products.Name:
<asp:Label ID="Products_NameLabel" runat="server" Text='<%# Eval("Products.Name") %>' />
<br />
Technicians.Name:
<asp:Label ID="Technicians_NameLabel" runat="server" Text='<%# Eval("Technicians.Name") %>' />
<br />
Incidents.DateOpened:
<asp:Label ID="Incidents_DateOpenedLabel" runat="server" Text='<%# Eval("Incidents.DateOpened") %>' />
<br />
Incidents.DateClosed:
<asp:Label ID="Incidents_DateClosedLabel" runat="server" Text='<%# Eval("Incidents.DateClosed") %>' />
<br />
Incidents.Description:
<asp:Label ID="Incidents_DescriptionLabel" runat="server" Text='<%# Eval("Incidents.Description") %>' /> 
```

标签现在绑定到从第二个来源返回的数据......或者看起来如此。当我运行它并选择一个应该返回在 sqldatasource select 语句中选择的数据的客户时，我的程序崩溃并给出这个错误：

> DataBinding：“System.Data.DataRowView”不包含名为“Products”的属性。

我不明白为什么当我在向导中测试它时 sqldatasource 清楚地返回它时，它说 datarowview 不包含具有该名称的列。有人可以帮忙吗？

PS 抱歉链接到 imgur ......显然你必须有更高的代表才能发布图片

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:36:23.057

我试过了，生成的 HTML 没有像您的代码中那样以表名作为前缀。

我手动添加了表名并重现了您的错误。

因此，如果您像您一样有重复的列名，则需要修改 SQL 语句以使用别名：

```
Products.Name as Products_Name 
```

# css - 如何制作方形按钮

> ID：15823871
> 
> 赞同：14
> 
> 时间：2013-04-05T00:11:36.113
> 
> 标签：css

我的网站上有一个按钮，我想让它变成方形：

如何制作一个方形按钮并让它仍然像一个按钮一样，所以当我滚动它时它会改变一点

这是我的例子：注意按钮不能被点击

[http://jsfiddle.net/HrUWm/](http://jsfiddle.net/HrUWm/)

（什么 css 将使这项工作？）这是我尝试过的：

```
<input class="butt" type="button" value="test"/>
.butt{ border: 1px outset blue;  background-color: lightBlue;} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-05T00:19:40.063

这将完成工作：

```
.butt {
   border: 1px outset blue;
   background-color: lightBlue;
   height:50px;
   width:50px;
   cursor:pointer;
}

.butt:hover {
   background-color: blue;
   color:white;
} 
```

[http://jsfiddle.net/J8zwC/](http://jsfiddle.net/J8zwC/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-05T00:16:50.273

示例：http: [//jsfiddle.net/HrUWm/7/](http://jsfiddle.net/HrUWm/7/)

```
.btn{
   border: 1px solid #ddd;
   background-color: #f0f0f0;
   padding: 4px 12px;

    -o-transition: background-color .2s ease-in; 
    -moz-transition: background-color .2s ease-in;
    -webkit-transition: background-color .2s ease-in; 
    transition: background-color .2s ease-in; 
}

.btn:hover {
    background-color: #e5e5e5;    
}

.btn:active {
    background-color: #ccc;
} 
```

关键部分是匹配按钮的`:active`和`:hover`状态的选择器，以允许应用不同的样式。

另请参阅：[用户操作伪类 :hover、:active 和 :focus](http://www.w3.org/TR/css3-selectors/#the-user-action-pseudo-classes-hover-act)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-05-25T08:15:39.600

尝试这样的事情

```
.square {
  background: #000;
  height: 200px;
  width: 380px;
  border-radius: 20px;
  color: #fff;
  text-align: center;
}
.button:hover {
  background-color: #000;
}
.sub-content {
  font-size: 25px;
/*   text-shadow: 0 0 10px white; */
/*   font-style: oblique; */
  font-family: 'Prosto One;
}

.main-content {
  margin-top: 30px;
  font-size: 45px;
  font-family: 'Prosto One';
/*   text-shadow: 0 0 20px white; */
}

.align-content {
  position: relative;
    top: 50%;
    -webkit-transform: translateY(-50%);
    -ms-transform: translateY(-50%);
    transform: translateY(-50%);
}
.button:active {
  background-color: #000;
  box-shadow: 0 5px #383838;
  transform: translateY(4px);
}
.button {
  box-shadow: 0 9px #383838;
  cursor: pointer;
}
```

```
<link href="https://fonts.googleapis.com/css?family=Comfortaa" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Prosto+One" rel="stylesheet">
<!-- <div class="triangle-with-shadow"></div> -->
<div class="square button">
  <div class="align-content">
    <span class="main-content">Create Repair</span><br> 
    <span class="sub-content">The Mobile Shop </span>
  </div>
</div>
```

[代码窗格.io](https://codepen.io/hardik-lino/pen/LmKzPb)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-04-03T03:04:54.180

我现在正在使用的一个选项（我正在使用 AngularJS 和 Bootstrap 脚本）

**HTML：**

```
<a href="#!login" class="btn">Log In</a> 
```

**CSS：**

```
padding: 40px 0px 40px 0px;
text-decoration: none;
width: 250px !important;
height: 250px !important; 
```

# css - 不透明度为 0.5 的 div 中的文本

> ID：15823873
> 
> 赞同：0
> 
> 时间：2013-04-05T00:11:47.713
> 
> 标签：css, html, opacity

我有一个 div 容器，里面有文本。

问题是我将容器的不透明度设置为 0.5，并且我希望文本的不透明度为 1，但由于 div，它不能超过 0.5。

我每个人都这样做了，所以“p”在样式表中设置为 1.0 的不透明度，但这仍然不起作用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:17:22.707

[`rgba()`](http://deepubalan.com/blog/2010/03/29/rgba-vs-opacity-the-difference-explained/)改为在容器 div 上使用来设置不透明度，因为该[`opacity`](http://www.w3.org/TR/css3-color/#transparency)属性由所有子元素（甚至文本节点）继承，这意味着任何类型的后代都不能具有比其父元素更高的不透明度

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T00:17:08.640

没有看到你的具体情况很难说，但一个元素只能和它的父元素一样不透明。

一种解决方案是让另一个 div 是 div 的子级，它的行为就像您现在拥有的那样。制作第二个div`position: relative`和透明的一个`position: absolute; width: 100%; height: 100%;`，它在背景中将是透明的。主 div 的其他孩子可以完全不透明。他们需要`position: relative`所以第一个 div 不覆盖他们。

[http://jsfiddle.net/ExplosionPIlls/ngW9m/1/](http://jsfiddle.net/ExplosionPIlls/ngW9m/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T00:16:11.753

这似乎适用于我拥有的所有浏览器：

[http://css-tricks.com/non-transparent-elements-inside-transparent-elements/](http://css-tricks.com/non-transparent-elements-inside-transparent-elements/)

# node.js - SetInterval 正在占用资源——替代 Node.js 的方式

> ID：15823874
> 
> 赞同：1
> 
> 时间：2013-04-05T00:11:56.493
> 
> 标签：node.js

下面是一个简单的函数，它每秒报告 100 次时间和系统资源：

```
var util = require('util');

function report(){
    console.log(new Date());
    console.log(util.inspect(process.memoryUsage()));
}

setInterval(report,10); 
```

*当然，这个例子并不是最实用的——为了说明目的更是如此*

它可以工作-但是内存分配不断**增加**。据我了解，这不是内存泄漏，而是 Javascript 的自然行为。这是由于函数，或者每次调用 setInterval 时都会将执行函数的记录添加到堆中。只要进程存在，它就会这样做。

**那么问题来了：**

有没有更好的方法来实现相同的输出，但效率更高？

# ruby-on-rails - ActiveRecord 布尔值在更新时重置为默认值

> ID：15823875
> 
> 赞同：0
> 
> 时间：2013-04-05T00:12:05.343
> 
> 标签：ruby-on-rails, activerecord

我有一个布尔字段，它的连接表中的默认值为 false 有很多直通关系：标签和标签列表。

```
add_column :taggings, :tag_visible, :boolean, :default => false 
```

理论是一个标签列表可以有很多标签（反之亦然），但标签的可见性可以关闭/打开每个标签列表。这也是嵌套资源的一部分：`Document has_one :tag_list`

在大多数情况下，这一切都有效。默认值是在创建时设置的，我正在使用 ajax 调用更新每个实例。

但是，当我更新包含 tag_list 作为令牌输入字段的文档时，它会将所有标记的可见性重置为 false，无论它以前是什么。

任何线索将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T03:30:28.523

事实证明，在我的 tag_list 模型中的 tags token_input setter 中，我删除并在标记模型中重新创建了一条新记录，而不是更新它。

旧代码：

```
self.taggings = Tag.ids_from_tokens(tokens, user_id).each_with_index.map {|t,i| Tagging.new(:tag_id => t, :tag_colour => tag_colours[i % tag_colours.size]) } 
```

使固定：

```
self.tag_ids = Tag.ids_from_tokens(tokens, user_id)
self.taggings.each_with_index {|t,i| t.update_attributes(:tag_colour => tag_colours[i % tag_colours.size]) } 
```

# php - 如何将 session_start() 与 ajax 一起使用？

> ID：15823876
> 
> 赞同：0
> 
> 时间：2013-04-05T00:12:08.323
> 
> 标签：php, ajax, session, load

基本上，我有一个使用 ajax 加载内容的动态 php 页面。它加载的内容应该从会话变量中获取内容，但它不能，因为我没有`session_start()`. `session_start()`我这样做了，只是在实际页面加载时它已经被处理，并且在内容加载时我无法添加另一个。还有其他方法吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:19:17.410

session_start() 只是恢复正在进行的现有会话，因此您可以在 AJAX 处理程序中调用它。

# c - 我在 C 中有一个分段错误

> ID：15823880
> 
> 赞同：0
> 
> 时间：2013-04-05T00:13:18.887
> 
> 标签：c, segmentation-fault

我有一个分段错误，在我运行它之后可能会更多，但我现在无法检查其他任何内容。

该程序应该像这样工作：

*   当用户输入5个数字时，他们应该按升序打印出来
*   如果用户输入的数字已经退出，则去掉原来的值
*   如果用户输入本机值，则打印 List Backwards

到目前为止，这是我的代码：

```
#include <stdio.h>
#include <stdlib.h>

struct element {
int i;
struct element *next;
};

void insert (struct element **head, struct element *new)
{

struct element *temp;
temp = *head;

while(temp->next != NULL)
{
    if((*head==NULL))
    {
    head = malloc(sizeof(struct element));
    //temp->i = i;
    temp->next = new;
    new = temp;
    }
    else if(temp->i == new->i)
    {
        new = malloc(sizeof(struct element));
        free(new);
        //purge(&head,&new);

    }
    else if(temp->i < new->i)
    {
        temp->i = new->i;
    }
    else if(temp->i > new->i)
    {
        new = new->next;
    }
}

}

void purge (struct element *current, struct element *predecessor)
{

predecessor->next = current -> next;
free(current);
}

void printList (struct element *head) 
{
while(head)
{
    printf("%d", head -> i);
    head = head->next;
}

}

void printListBackwards (struct element *ptr)
{
if(ptr == NULL)
{
    printf("list is empty \n");
    return;
}
if(ptr->next != NULL)
{
    printListBackwards(ptr->next);
}
printf("print %p %p %d\n", ptr, ptr->next, ptr->i);
}

int main()
{
int n = 0;
int count = 5;
printf("enter a Number: \n");
scanf("%d",&n);
struct element *new;
new = malloc(sizeof(struct element));
struct element *head = NULL;
new->i = n;
while(count!=0)
{
    insert(&head,new);
    printList(head);    
    count++;
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:21:13.883

在该`main()`函数中，您只需使用 ; 分配和创建一个元素`malloc()`。然后您尝试将其添加到您的列表中 5 次。这会引起混乱。您应该为添加到列表中的每个元素分配一次节点。

```
struct element *head = NULL;

while (count!=0)
{
    printf("enter a Number: \n");
    if (scanf("%d", &n) != 1)
        break;
    struct element *new = malloc(sizeof(struct element));
    if (new == 0)
        break;
    new->i = n;
    new->next = NULL;
    insert(&head, new);
    printList(head);    
    count--;
} 
```

请注意，修改后的代码会检查 和 的`scanf()`结果`malloc()`。它还将新元素的`next`指针设置为 NULL。它倒计时而不是倒计时；这可能会使用更少的内存。

我没有对此进行测试，因此可能存在（并且很可能存在）其他问题，但这可能会更好（解决一些问题，但不是所有问题）。

您确实需要学习如何使用调试器，至少足以获取堆栈跟踪，以便您知道哪一行代码导致了崩溃。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T00:25:00.540

你真的需要一个链表吗？似乎问题陈述说用户只能输入 5 个数字......如果是这样，为什么不只使用 5 个元素的数组？以下是一些想法。

```
enum { N = 5 };
typedef struct Element {
    int number;
    bool present;
} Element;

Element elements[ N ];

Init:
for( i = 0; i != N; ++i ) {
    elements[i].number = 0;
    elements[i].present = false;
}

Insert "inputNumber":
for( i = 0; i != N; ++i ) {
    if( elements[i].present == false ) {
        elements[i].number = inputNumber;
        elements[i].present = true;
    }
}

Remove "removeNumber":
for( i = 0; i != N; ++i ) {
    if( elements[i].number == removeNumber ) {
        elements[i].present = false;
    }
}

Print Backwards:
for( i = N; i != 0; --i ) {
    printf( "%d\n", elements[i].number );
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T00:33:34.310

在 main 中，您应该设置`new->next = NULL;`[或插入开头的某处]

这段代码只是搞砸了：

```
head = malloc(sizeof(struct element));
//temp->i = i;
temp->next = new;
new = temp; 
```

您可能应该设置

```
*head = new; 
```

但是你还需要设置`*head->next = NULL;`

这一点完全是胡说八道：

```
 new = malloc(sizeof(struct element));
    free(new);
    //purge(&head,&new); 
```

你会想要释放`new`.

```
else if(temp->i < new->i)
{
    temp->i = new->i;
}
else if(temp->i > new->i)
{
    new = new->next;
} 
```

这也是大错特错的。我认为最后一个应该做

```
 temp = temp->next; 
```

帮自己一个忙，在一张纸、盒子上画

```
 HEAD 
   !
   v
 +-----+
 ! i=3 !
 +-----+     +-----+
    !------->! i=4 !
             +-----+
                !-------->NULL 
```

然后遍历它，看看你的代码是如何插入、删除等的。

[我也可以建议您不要在代码中使用 C++ 保留字 -`new`是 C++ 保留字。这意味着您的代码肯定不会在 C++ 编译器中编译，这是一件不好的事情。当然，还有其他一些事情可能需要改变，但是像“不调用变量`new`”这样简单的事情不应该是它失败的事情之一]。

# c# - 如何在c#中将参数传递给异步任务

> ID：15823881
> 
> 赞同：1
> 
> 时间：2013-04-05T00:13:29.330
> 
> 标签：c#, asp.net, multithreading

在 ASP.NET Web 请求期间，我需要启动一个异步任务，然后将控制权返回给网页。有人可以告诉我调用以下方法的代码吗？为了清楚起见，我希望调用 async 的函数和 Web 请求在该函数仍在处理时完成将控制权返回给调用页面。

```
private void FunctionToCall(IInterface objectIWantToPassIn)
{
   // do stuff
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T01:05:02.100

您将希望通过创建一个

```
Task task = Task.Factory.StartNew(action, "arg"); 
```

那么你可能想做一些事情，当任务完成时：

```
task.ContinueWith(anotheraction); 
```

当然，在这种情况下，action 和 otheraction 将是无效的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T01:13:01.477

```
 private void FunctionToCall(object state)
 {
        IInterface objectIWantToPassIn= (IInterface ) state;
        // do stuff
 }

  System.Threading.ThreadPool.QueueUserWorkItem(FunctionToCall, 
                                                objectIWantToPassIn); 
```

# javascript - 保护纯粹的客户端主干应用程序

> ID：15823882
> 
> 赞同：3
> 
> 时间：2013-04-05T00:13:34.313
> 
> 标签：javascript, security, backbone.js, client-side

所以说我要实现一个拼字游戏，我希望它是 100% 的客户端，即主干处理所有游戏逻辑。是否有可能保护这样的解决方案，使用户无法欺骗游戏动作？

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T00:25:41.297

我认为有几件事必须留在服务器端，即使在（几乎）全客户端解决方案中

1.  **安全**性 - 您必须在客户端之外进行某种授权和身份验证
2.  **验证**- 您永远不能信任用户生成的内容，并且在主干同步期间发送到服务器的 JSON 模型在某种程度上是用户生成的内容（因为任何人都可以打开控制台并弄乱您的模型并保存）

我知道像[Firebase](https://www.firebase.com/)这样的解决方案可以很好地处理 #1，但我不确定它们是否能处理 #2

因此，在这种情况下，Sébastien 的回答是一个很好的解决方案，而不是服务器验证，您让对等方根据他们对游戏的表示来验证他们从其他对等方获得的内容是有效的移动。但是，你怎么知道谁是对的？多数人获胜？我看不出有一种方法可以避免出现某种服务器端状态，即“主”状态，并验证每次移动都是“有效”移动。

一种方法是让你的服务器端在 Node.js 上运行，这样你就可以避免在两个不同的地方重写你的验证逻辑。您不需要在服务器端运行整个逻辑，只需验证部分即可。

还有一些方法可以在服务器端运行整个 Backbone 应用程序（例如[这种方法](http://nerds.airbnb.com/weve-launched-our-first-nodejs-app-to-product)），但我不确定这里是否需要这样做。

您需要服务器端验证的其他几个原因：您如何知道用户正在保存什么？例如，如果您没有大小限制，是什么阻止他们将整个盗版电子书数据库存储在您的应用程序中，如果您在服务器端没有验证，那么理论上任何拥有控制台的人都可以推送任何内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T00:17:40.953

这是不可能的，除非您还为一个客户端构建了一种方式来告诉另一个客户端停止作弊，或者换句话说，在本地验证每一步。但是，这具有相反的问题，即允许作弊者阻止对手的一举一动。

您可以通过让第三个人与客户“间接观察”比赛来扩展这一点，并提供关于移动的第三个观点。如果三分之二的人认为此举合法，则通过。只有当你有大量的作弊者/人修改脚本时，这才会崩溃。

我认为这将是您唯一的解决方案之一，因为如果应用程序完全是客户端的，您就不能认为代码中的任何内容都是安全或牢不可破的。我认为，您需要更多地依赖对等验证，而不是在代码中构建检查。

# java - 递归驱动方法

> ID：15823888
> 
> 赞同：0
> 
> 时间：2013-04-05T00:14:10.410
> 
> 标签：java, recursion

```
public class FindSum
{
private static int sum(int n)
{
if (n==1)
return 1;
else
return n + sum (n-1);
}
public static int getSum(int n)
{
if (n>0)
return sum(n);
else
{
throw new IllegalArgumentException
("Error: n must be positive");
}
}
} 
```

根据我的书，这会在执行前测试 n>0。我不明白如果测试“if (n>0)”出现在算法之后，为什么会出现这种情况。为了完成这个测试，不应该翻转这两种方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:19:52.790

在 Java 中，方法在类中的顺序无关紧要。请注意 getSum() 正在调用 sum()。

那么考虑一下如果我们调用 getSum(0) 会发生什么？if 条件将失败并且什么都不会发生，我们将直接进入错误。如果我们调用 getSum(5) 会怎样？然后我们将返回 sum(5)。但是 sum(5) 是什么？现在我们发现自己处于 sum() 方法中，我们在其中执行递归操作，直到达到基本情况，最终将返回 1 + 14。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:16:00.383

它们的*写入*顺序无关紧要，但*执行*顺序至关重要。

由于如果检查成功则`getSum`显式调用，因此只要您调用.`sum``getSum`

# javascript - YouTube API 从标签播放随机视频

> ID：15823889
> 
> 赞同：0
> 
> 时间：2013-04-05T00:14:12.417
> 
> 标签：javascript, api, youtube

我有从这个链接获得的 YouTube API...

[https://developers.google.com/youtube/iframe_api_reference](https://developers.google.com/youtube/iframe_api_reference)

它工作正常，但我正在寻找一种方法来播放基于标签的随机视频......这可能吗？有关于它的教程吗？

这是我的代码

```
<!-- 1\. The <iframe> (and video player) will replace this <div> tag. -->
    <div id="player"></div>

    <script>
      // 2\. This code loads the IFrame Player API code asynchronously.
      var tag = document.createElement('script');

      tag.src = "https://www.youtube.com/iframe_api";
      var firstScriptTag = document.getElementsByTagName('script')[0];
      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

      // 3\. This function creates an <iframe> (and YouTube player)
      //    after the API code downloads.
      var player;
      function onYouTubeIframeAPIReady() {
        player = new YT.Player('player', {
          height: '390',
          width: '640',
          videoId: 'u1zgFlCw8Aw',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onPlayerStateChange
          }
        });
      }

      // 4\. The API will call this function when the video player is ready.
      function onPlayerReady(event) {
        event.target.playVideo();
      }

      // 5\. The API calls this function when the player's state changes.
      //    The function indicates that when playing a video (state=1),
      //    the player should play for six seconds and then stop.
      var done = false;
      function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.PLAYING && !done) {
          setTimeout(stopVideo, 6000);
          done = true;
        }
      }
      function stopVideo() {
        player.stopVideo();
      }
    </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-27T18:27:04.370

调用 Ajax 函数来处理请求

```
function request_yt_videoID(vid)
{
       // Some Code
       player.loadVideoById(vid);
} 
```

访问谷歌开发者网站：[https ://developers.google.com/youtube/iframe_api_reference#loadVideoById](https://developers.google.com/youtube/iframe_api_reference#loadVideoById)

# .net - 为什么我的 .NET MVC-4 解决方案中所做的更改未显示在浏览器预览中？

> ID：15823893
> 
> 赞同：1
> 
> 时间：2013-04-05T00:14:34.497
> 
> 标签：.net, asp.net-mvc, asp.net-mvc-4, visual-studio-2012, solution

所以我在 VMWare Fusion 上运行 Visual Studio 2012 (Win7)。大约 50% 的时间，对视图的更改不会在浏览器预览中呈现。这会让我发疯。我找到的解决方案是简单地终止 WebView.WebServer40 应用程序，该应用程序在您单击在浏览器中查看以进行 Web 构建时启动。在 Mac 虚拟机上工作似乎是一个问题，因为在 PC 上运行没有这个问题。如果其他人对此有更好的解决方案，那就太好了。这是一个烦人的工作流程，但至少我在大喊大叫。

--

# 更新

如果有人遇到此问题，请在此处找到解决方案：[在 asp.net 开发服务器中缓存](https://stackoverflow.com/questions/2072668/caching-in-asp-net-development-server)

另外： http: [//support.microsoft.com/kb/911272](http://support.microsoft.com/kb/911272)

编辑注册表项： HKLM\Software\Microsoft\ASP.NET\DefaultDocumentInstalled from 1 to 2

--

# 更新#2

所以这个修复只工作了片刻，可能只是一个怪癖。对我来说，通过 Microsoft Web Platform Installer 安装 IIS Express 很神奇。没有更多的问题。耶稣。

[http://www.microsoft.com/web/gallery/install.aspx?appid=WebMatrix](http://www.microsoft.com/web/gallery/install.aspx?appid=WebMatrix)

# javascript - 在 AngularJs 中迭代对象时，我们如何在 ng-repeat 中使用过滤器

> ID：15823894
> 
> 赞同：2
> 
> 时间：2013-04-05T00:14:38.113
> 
> 标签：javascript, angularjs

绑定到模型的搜索字段

```
<input type="text" ng-model="searchVoucher" /> 
```

在 ng-repeat 中迭代的对象

```
<li ng-repeat="(k,f) in {'r':4,'e':5,'t':6,'y':7,'c':8} | filter:searchVoucher">{{f}}</li> 
```

我如何根据对象的键或 val 或 val 进行过滤也可以是具有属性的对象。

请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T03:48:01.173

尝试

```
<li ng-repeat="(k,f) in {'r':4,'e':5,'t':6,'y':7,'c':8} | searchfilter:searchVoucher">{{f}}</li> 
```

筛选

```
app.filter('searchfilter', function() {
  return function(input, term) {
    var regex = new RegExp(term || '', 'i');
    var obj = {};
    angular.forEach(input, function(v, i){
      if(regex.test(v + '')){
        obj[i]=v;
      }
    });
    return obj;
  };
}); 
```

演示：[Plunker](http://plnkr.co/edit/lRkvtMyIuscsvIIZn8CA?p=preview)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T02:00:34.440

请看看这个[http://jsfiddle.net/fFLUH/](http://jsfiddle.net/fFLUH/)。在这里，相同的过滤器`searchVoucher`配置为基于键或值过滤输入，基于`filterParam`. `this`从传递的关键字`li`引用到控制器`tst`。该`tst`控制器具有文本框的模型。

在过滤器内部，我正在访问`filterParam`，并使用它来过滤输入 json。

# pass-by-reference - 通过引用、值和名称调用

> ID：15823903
> 
> 赞同：8
> 
> 时间：2013-04-05T00:15:24.897
> 
> 标签：pass-by-reference, pass-by-value, pass-by-name

我试图理解按引用、值和名称调用之间的概念差异。

所以我有以下伪代码：

```
foo(a, b, c)
{
   b =b++;
   a = a++;
   c = a + b*10
}

X=1;
Y=2;
Z=3;
foo(X, Y+2, Z); 
```

如果 a、b 和 c 都是通过引用调用，那么 foo 调用之后的 X、Y 和 Z 是什么？如果 a、b 和 c 是按值/结果调用？如果 a、b 和 c 是按名称调用的？

另一种情况：

```
X=1;
Y=2;
Z=3;
foo(X, Y+2, X); 
```

我正在努力为即将到来的期末考试抢占先机，这似乎是一个很好的复习问题。Pass-by-name 对我来说绝对是最陌生的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-05T00:25:41.323

当您按值传递参数时，它只是复制函数参数中的值，并且在函数中对该变量所做的任何事情都不会反映原始变量，例如

```
foo(a, b, c)
{
   b =b++;
   a = a++;
   c = a + b*10
}

X=1;
Y=2;
Z=3;
foo(X, Y+2, Z);
//printing will print the unchanged values because variables were sent by value so any //changes made to the variables in foo doesn't affect the original.
print X; //prints 1
print Y; //prints 2
print Z; //prints 3 
```

但是当我们通过引用发送参数时，它会复制变量的地址，这意味着我们对函数中的变量所做的任何事情，实际上都是在原始内存位置完成的，例如

```
foo(a, b, c)
{
   b =b++;
   a = a++;
   c = a + b*10
}

X=1;
Y=2;
Z=3;
foo(X, Y+2, Z);

print X; //prints 2
print Y; //prints 5
print Z; //prints 52 
```

姓名通行证； [传名](https://stackoverflow.com/questions/838079/what-is-pass-by-name-and-how-does-it-work-exactly)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-01T11:17:32.040

**按值调用**：正常方式...实际参数的值被复制到形式参数。

**通过引用调用**：而不是参数，它们的地址被传递，形式参数指向实际参数。

**按名称调用**：与宏一样，整个函数定义替换了函数调用，形参只是实际参数的另一个名称。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T00:27:34.610

按价值 - 功能没有变化。功能完成后，您的所有操作都会消失。

通过引用 - 你的行为确实改变了变量。按名字 - 我从来没有听说过......

传递 x+1 并没有改变，只是告诉函数 3 而不是 2 等等...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T00:23:48.643

如果是按值传递，这不会改变 X、Y 或 Z 的值。当您使用诸如“foo()”之类的函数时，它基本上将变量（x、y 和 z）复制到其他变量（a、b 和 c）中并对其执行某些操作，而不更改原始变量（x、 y 和 z)。要更改一个值，您必须返回一个值，如下所示：

```
foo(a, b, c)
{
a = a++;
b = b++;
c = a + b * 10;
return c;
}

x = 1;
y = 2;
z = 3;
z = foo(x, y+2) 
```

那么 x 和 y 将是相同的，但 z 将是 (x+1)+(y+1)*10，在这种情况下为 32。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-10-28T13:49:57.217

在 javascript 中：

1.  原始类型变量（如字符串、数字）始终作为按值传递。
2.  Array 和 Object 根据这些条件作为按引用传递或按值传递传递。

    *   如果您使用新对象或数组更改该对象或数组的值，那么它是按值传递的。

        `object1 = {item: "car"}; array1=[1,2,3];`

    在这里您正在分配新对象或数组。您没有更改旧对象的属性值。所以它是按值传递的。

    *   如果您要更改对象或数组的属性值，则它是通过引用传递的。

        `object1.item= "car"; array1[0]=9;`

    在这里，您正在更改旧对象的属性值。您没有将新对象或数组分配给旧对象。因此它是通过引用传递的。

**代码**

```
 function passVar(object1, object2, number1) {

        object1.key1= "laptop";
        object2 = {
            key2: "computer"
        };
        number1 = number1 + 1;
    }

    var object1 = {
        key1: "car"
    };
    var object2 = {
        key2: "bike"
    };
    var number1 = 10;

    passVar(object1, object2, number1);
    console.log(object1.key1);
    console.log(object2.key2);
    console.log(number1);

Output: -
    laptop
    bike
    10 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-07-28T08:46:55.927

在**按值调用**中，传递变量的副本，而在**按引用调用中**，传递变量本身。在**按值调用中**，实际参数和形式参数将在不同的内存位置创建，而在**按引用调用中**，实际参数和形式参数将在同一内存位置创建。

# twitter-bootstrap - BootStrap Mobile CSS 代码未注册

> ID：15823910
> 
> 赞同：0
> 
> 时间：2013-04-05T00:16:33.317
> 
> 标签：twitter-bootstrap

这可能是一个愚蠢的问题，但我有一个网站，我正在学习 BootStrap。我的浏览器上的样式可以正常工作（即使我将它们缩小到移动视图）。但是，如果我通过手机在移动网站上查看它，什么都没有注册……有什么想法吗？

[http://goo.gl/yfhNi](http://goo.gl/yfhNi) - 查看链接。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T01:15:43.417

一些细节有望帮助您更接近答案。

在头部，添加

```
<meta charset="UTF-8"> 
```

在第 24 行，关闭 H4 标签。

看看你做出这些更正后会发生什么。

祝你好运！

# android - Listview 不显示我的数据库中的文本

> ID：15823923
> 
> 赞同：1
> 
> 时间：2013-04-05T00:18:12.793
> 
> 标签：android, eclipse, listview, sqlite

我有我的 ListView 设置，但它只显示 3 行，编号为 1-3，并且没有显示我的数据库中的条目。我试图找到答案，但这个 ListView 主题非常模糊，我找不到关于如何显示我的数据库条目中的文本的明确答案。这是我的 xml 布局、ListView 类和数据库中的光标条目中的代码。

布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@drawable/nfbackground"
    android:orientation="vertical" >

    <ImageView
        android:id="@id/titlebar"
        android:layout_width="wrap_content"
        android:layout_height="66dp"
        android:src="@drawable/nftitlebar" />

        <ListView 
            android:id="@android:id/list"
         android:layout_width="match_parent"
         android:layout_height="wrap_content"
         android:background="@drawable/searchimageview"
         android:textColor="@color/black"
         android:textSize="25dp"
         android:textStyle="bold"
         android:text=""
         android:orientation="vertical" >
        </ListView>
</LinearLayout> 
```

代码：

```
 package com.fullfrontalgames.numberfighter;
    import com.fullfrontalgames.numberfighter.DBAdapter;
    import com.fullfrontalgames.numberfighter.R;
    import android.app.Activity;
    import android.database.Cursor;
    import android.os.Bundle;
    import android.support.v4.widget.SimpleCursorAdapter;
    import android.widget.ListAdapter;
    import android.widget.ListView;

    public class PlayAFriend extends Activity
    {        
        @Override
        protected void onCreate(Bundle savedInstanceState)
            {
            // TODO Auto-generated method stub
            super.onCreate(savedInstanceState);
            setContentView(R.layout.playafriend);

            ListView FriendLV = (ListView) findViewById(android.R.id.list);

            DBAdapter db = new DBAdapter(this);
            db = db.open();

            Cursor friendslist = db.GetAllFriends();

            String[] from = new String[] {"ID","USERNAME","FRIENDS"};   // your column/columns here
            int[] to = new int[] {android.R.id.text1};

            @SuppressWarnings("deprecation")
            ListAdapter cursorAdapter = new SimpleCursorAdapter(this, android.R.layout.simple_list_item_1, friendslist, from, to);
              FriendLV.setAdapter(cursorAdapter);
              db.close();
             }

         } 
```

代码：

```
public Cursor GetAllFriends()
    {
        Cursor cursor = db.rawQuery("select rowid _id,* from NFDB", null);
        int iRow = cursor.getColumnIndex("ID");
        int iName = cursor.getColumnIndex("USERNAME");
        int iFriends = cursor.getColumnIndex("FRIENDS");
        if (cursor.moveToFirst()) {
            do {
                TextView friendslist = new TextView(context);
                friendslist.setId(Integer.parseInt(cursor.getString(iRow)));
                friendslist.setText(cursor.getString(iName));
                friendslist.setText(cursor.getString(iFriends));
            }   while (cursor.moveToNext());
        }
        return cursor;  
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:51:27.997

您需要为您的列表视图列创建一个包含 2 个 TextView 的布局

list_items.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="wrap_content"
android:padding="5dp"
android:orientation="vertical" >

<TextView
    android:id="@+id/textview_name"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

<TextView 
    android:id="@+id/textview_friends"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" />

</LinearLayout> 
```

改变

```
String[] from = new String[] {"USERNAME","FRIENDS"};   // your column/columns here
 int[] to = new int[] {textview_name, textview_friends}; 
SimpleCursorAdapter cursorAdapter = new SimpleCursorAdapter(this, R.layout.list_items, friendslist, from, to, 0);
          FriendLV.setAdapter(cursorAdapter);
          //db.close();  Close the db in onDestroy 
```

改变

```
public Cursor GetAllFriends()
{

    return db.rawQuery("select * from NFDB", null);

    } 
```

# php - GOOGLE Maps API v3 和 MySQL 之间的动态关系

> ID：15823924
> 
> 赞同：1
> 
> 时间：2013-04-05T00:18:13.433
> 
> 标签：php, mysql, database, google-maps-api-3

我正在设计我自己的第一个网页。这是一个房地产页面，一些用户将添加开放房屋信息，而其他用户可以提取信息。数据库和网络的代码非常好（两个月后......）并且插入和获取数据很甜蜜......现在谷歌地图。我正在尝试拥有像 trulia 甚至是非常原始的[Housingmaps.com](http://www.housingmaps.com/)之类的东西（似乎他们开始了混搭，对吧？）。crimereports.com 也非常好。

目标：从数据库中提取地址，从地理编码中获取经纬度，将其插入表中，在谷歌地图中显示。另外：当人们平移地图时，新信息会弹出到地图中。

这是检索地址、地理代码以及将 lat 和 lng 添加回数据库的代码。

```
<?php
//require("phpsqlajax_dbinfo.php");

// Opens a connection to a MySQL server
$username = "abc"; //personal info changed to abc
$password = "abc";
$hostname = "abc"; 
$database = "abc";
$connection = mysqli_connect($hostname, $username, $password);
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

//if (!$connection) {
  //die("Not connected : " . mysql_error());
//}

define("MAPS_HOST", "maps.google.com");
define("KEY", "my .............key........code");

// Set the active MySQL database
$db_selected = mysqli_select_db($connection, $database);
if (!$db_selected) {
  die("Can\'t use db : " . mysql_error());
}

// Select all the rows in the markers table
$query = "SELECT * FROM brokerstour.property WHERE 1";
$result = mysqli_query($connection, $query);
if (!$result) {
  die("Invalid query: " . mysql_error());
}

// Initialize delay in geocode speed
$delay = 0;
$base_url = "http://maps.googleapis.com/maps/api/geocode/output?parameters";

// Iterate through the rows, geocoding each address
while ($row = @mysqli_fetch_assoc($result)) {
  $geocode_pending = true;

  while ($geocode_pending) {
    $address = $row["address"];
    $id = $row["id"];
    $request_url = $base_url . "&q=" . urlencode($address);
    $xml = simplexml_load_file($request_url) or die("url not loading");

    $status = $xml->Response->Status->code;
    if (strcmp($status, "200") == 0) {
      // Successful geocode
      $geocode_pending = false;
      $coordinates = $xml->Response->Placemark->Point->coordinates;
      $coordinatesSplit = split(",", $coordinates);
      // Format: Longitude, Latitude, Altitude
      $lat = $coordinatesSplit[1];
      $lng = $coordinatesSplit[0];

      $query = sprintf("UPDATE property " .
             " SET lat = '%s', lng = '%s' " .
             " WHERE id = '%s' LIMIT 1;",
             mysql_real_escape_string($lat),
             mysql_real_escape_string($lng),
             mysql_real_escape_string($id));
      $update_result = mysql_query($query);
      if (!$update_result) {
        die("Invalid query: " . mysql_error());
      }
    } else if (strcmp($status, "620") == 0) {
      // sent geocodes too fast
      $delay += 100000;
    } else {
      // failure to geocode
      $geocode_pending = false;
      echo "Address " . $address . " failed to geocoded. ";
      echo "Received status " . $status . "
\n";
    }
    usleep($delay);
  }
}
?> 
```

这是我对谷歌教程（原始代码）所做的更改： 1）更新了 php: mysqli 以避免错误。没有得到更多的php错误。2) 将 url 从 "http://" 更改。MAPS_HOST 。“/maps/geo?output=xml”。“&键=”。钥匙; TO“ [http://maps.googleapis.com/maps/api/geocode/output?parameters](http://maps.googleapis.com/maps/api/geocode/output?parameters) ”试图将代码更新到 API v3。

如果我使用旧网址，我会收到错误 610。使用新网址，我会得到：

* * *

（！）SCREAM：忽略（！）的错误抑制警告：simplexml_load_file（）：I / O警告：无法加载外部实体“maps.googleapis.com/maps/api/geocode/output?parameters&q=4200+Park+Blvd+ " 在 C:.... 第 57 行 .....

## 网址未加载

全面披露：我很新，也许上面的内容甚至没有意义。但是，我已经在这个问题上停留了一周。（顺便说一下，对于那些刚接触谷歌地图的人来说，《Beginning Google API 3》一书是必须的。虽然它不处理数据库，但很好地解释了谷歌地图 API）。

有人可以提供任何提示，书籍，教程吗？任何帮助都是很大的帮助。感谢您的时间。

第 57 行是 $xml = simplexml_load_file($request_url) 或 die("url not loading");

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T16:08:29.537

`$base_url = "http://maps.googleapis.com/maps/api/geocode/output?parameters";`您没有指定输出。它应该是 `xml`或`jason`。此外，您传递的参数是地址，`sensor = false`或者`sensor = true`

**编辑**

消除

```
$geocode_pending = true;
while ($geocode_pending) { 
```

**结束编辑**

```
$q = $row["address"];
$base_url = "http://maps.googleapis.com/maps/api/geocode/xml?address=";
$request_url = $base_url.urlencode($q)."&sensor=false";
$xml = simplexml_load_file($request_url) or die("url not loading");
if($xml->status=="OK"){
    // Successful geocode
    $lat = $xml->result->geometry->location->lat;
    $lng = $xml->result->geometry->location->lng; 
```

**编辑**

```
 echo $lat.","$lng."<br>";//
    } 
    } 
```

删除其余代码并确保它在逐步添加其余代码之前有效

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-10T17:05:37.057

这是部分成功。此代码完成： a) 从表中获取地址；b) 从谷歌获取 lat 和 lnt；c) 将数据插入表中。

我仍然需要处理延迟。此外，我是一个 3 个月大的程序员......为了完成上述工作，我花了两个星期的时间......我把延迟留在那里仅供参考（这是来自谷歌的教程，其中包含网络上其他人的更改。 )

我试图投票赞成 Strachan 先生的答案，但我在堆栈溢出中缺乏声誉......无法做到。该修复也有效。感谢您的时间。

```
<?php

$conn = mysql_connect('localhost', 'rxxt', 'xxxxxxx');
if(!$conn)
 {
   echo "Database Error.";
 }
 else
 {
   echo "Connected.";
   mysql_select_db('YOUR TABLE', $conn);
   $query = "SELECT * from YOUR TABLE";
   $result = mysql_query($query, $conn) or die($query.mysql_error());
    while($row = mysql_fetch_array($result))
    { 

      $address = $row['address'];
      $id = $row['id'];

      $loc_address = str_replace(" ", "+", $address); //to replace spaces by '+' signs
          $location = $loc_address;
      echo $location."<br>";
      $delay = 0;  // this delay is here just to avoid errors - 
          $url = "http://maps.google.com/maps/api/geocode/json?address=".$location."&sensor=false";
          echo $url;
            $output=file_get_contents($url);
            $out= json_decode($output);
            $lat = $out->results[0]->geometry->location->lat;
            $lng = $out->results[0]->geometry->location->lng;
            echo '<br>Lat is '. $lat;
            echo '<br>Long is '. $lng;

       $query = sprintf("UPDATE YOUR TABLE " .
             " SET lat = '%s', lng = '%s' " .
             " WHERE id = '%s' LIMIT 1;",
             mysql_real_escape_string($lat),
             mysql_real_escape_string($lng),
             mysql_real_escape_string($id));
           $update_result = mysql_query($query);

      echo "Successfully inserted.";
    // Below is just for reference - they say we need the delay. The may problem: does not get the status to compare to 200, 620, etc.   
    /*$status = $xml->Response->Status->code;  
    if (strcmp($status, "200") == 0) {
            // Successful geocode
            echo '<br />successfull geocode</strong><br />';
            $geocode_pending = false;
    }
    else if (strcmp($status, "620") == 0) {
         // sent geocodes too fast
         $delay += 100000;
            } else {
         // failure to geocode
         $geocode_pending = false;
         echo "Address " . $address . " failed to geocoded. ";
         echo "Received status " . $status . "
        \n";
          }*/
    usleep($delay); 
    }
 }
mysql_close($conn);
?> 
```

# c# - 自定义模型绑定器不触发

> ID：15823928
> 
> 赞同：15
> 
> 时间：2013-04-05T00:18:32.280
> 
> 标签：c#, asp.net-mvc-4, model-binding

我已经在 global.asax 中为 MyList 注册了一个自定义模型绑定器。然而，模型绑定器不会为嵌套属性触发，对于简单类型它可以正常工作。在下面的示例中，它会为 Index() 触发，但不会为 Index2() 触发

**全球.asax**

```
protected void Application_Start()
{
    AreaRegistration.RegisterAllAreas();

    ModelBinders.Binders.Add(typeof(MyList), new MyListBinder());

    WebApiConfig.Register(GlobalConfiguration.Configuration);
    FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
    RouteConfig.RegisterRoutes(RouteTable.Routes);
} 
```

**代码：**

```
public class MyListBinder : IModelBinder
{
    public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        return new MyList();
    }
}

public class MyList
{
    public List<int> items { get; set; }
}

public class MyListWrapper
{
    public MyList listItems { get; set; }
}

public class TestController : Controller
{
    public ActionResult Index(MyList list)  // ModelBinder fires :-)
    {            
        return View();
    }

    public ActionResult Index2(MyListWrapper wrapper) // ModelBinder does not fire! :-(
    {
        return View();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T07:40:09.960

模型绑定器用于允许操作接受复杂对象类型作为参数。这些复杂类型应该通过 POST 请求生成，例如，通过提交表单。如果您有一个无法被默认模型绑定器绑定的高度复杂的对象（或者它不会有效），您可以使用自定义模型绑定器。

**回答您的问题：** 如果您也没有为`MyListWrapper`该类添加自定义模型绑定器，则不会在 GET 请求中调用 BindModel( 的`MyListBinder)`，这就是 ASP.NET MVC 的工作方式。但是，如果您修改您的代码通过添加一个带有`MyListWrapper`参数的 POST 动作，可以看到 BindModel 方法被正确调用。

```
[HttpGet]
public ActionResult Index2()  // ModelBinder doesn't fire
{
    return View();
}

[HttpPost]
public ActionResult Index2(MyListWrapper wrapper) // ModelBinder fires
{
    return View();
} 
```

和 Index2 视图

```
@model fun.web.MyListWrapper

@using (Html.BeginForm())
{
    @Html.HiddenFor(m => m.listItems)
    <input type="submit" value="Submit" />
} 
```

如果您想“控制” GET 请求中的操作参数，您应该使用[操作过滤器](http://msdn.microsoft.com/en-us/library/dd410209%28v=vs.100%29.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T23:01:26.377

您定义了 binder for `MyList`，因此仅当 action 方法输入参数为 type 时才会触发`MyList`。

```
ModelBinders.Binders.Add(typeof(MyList), new MyListBinder()); 
```

如果您希望模型绑定器即使`MyList`嵌套到其他模型中也能触发，您必须这样做：

```
[ModelBinder(typeof(MyListBinder))] 
public class MyList
{
    public List<int> items { get; set; }
} 
```

然后，模型绑定器在遇到`MyList`类型时触发，即使它是嵌套的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-11T20:29:46.783

将此添加到您的全局：

```
ModelBinders.Binders.Add(typeof(MyListWrapper), new MyListWrapperBinder()); 
```

然后创建一个可以处理绑定的 MyListWrapperBinder。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-05T07:12:40.713

您的模型绑定器与您的 MyList 类匹配，而不是与 MyListWrapper。MyListBinder 仅与 MyList 类或从 MyClass 继承的类一起使用。

# c# - 带有单选按钮和 for 循环的 if-else 语句

> ID：15823930
> 
> 赞同：0
> 
> 时间：2013-04-05T00:18:40.493
> 
> 标签：c#, undeclared-identifier

我遇到了一个不断发生的问题，我不确定问题是什么。我需要在 Microsoft Visual Studio 中创建一个程序，其中 radioButton1 用于查找连续数字的总和，radioButton2 用于查找数字的阶乘。

将有三个按钮，一个用于 FOR 循环，一个用于 WHILE 循环，一个用于 DO-WHILE 循环。我正在研究 FOR 按钮。

我要做的是进行选择，然后按下其中一个按钮，它会使用在消息框中单击的循环找到答案。

这是我到目前为止所得到的：

```
private void button1_Click(object sender, System.EventArgs e)
{
  if ((radioButton1.Checked == true) && (radioButton2.Checked == false))
  {
    int sum = 0;
    int number = int.Parse(numericUpDown1.Value.ToString());
    for (int i = 1; i <= number; i++)
    {
      sum = sum + i;
      MessageBox.Show("The sum of the consecutive numbers leading up to " + number + " is " + sum + ".");
    }
    MessageBox.Show("The sum of the consecutive numbers leading up to " + number + " is " + sum + ".");
  }
  else if ((radioButton2.Checked == true) && (radioButton1.Checked == false))
  {
    int product = 1;
    int number = int.Parse(numericUpDown1.Value.ToString());
    for (int i = 1; i <= number; i++)
    {
      product *= i;
      MessageBox.Show("The factorial of the numbers leading up to " + number + " is " + product + ".");
    }
    MessageBox.Show("The factorial of the numbers leading up to " + number + " is " + product + ".");
  }
  else
  {
    MessageBox.Show("Invalid");
  }
} 
```

我不断收到这条消息：

“‘Lab5’不包含‘radioButton2.CheckedChanged’的定义，并且找不到接受‘Lab5’类型的第一个参数的扩展方法‘radioButton2.CheckChanged’（您是否缺少 using 指令或程序集引用？）。 "

老实说，我不知道这意味着什么。

任何帮助将不胜感激。

我想将它保留在 if-else 语句中，只是因为我不希望在选择 radioButton2 时弹出 radioButton1 的消息框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:35:11.460

您可能无意中向该单选按钮添加了一个处理程序（例如，通过在设计器中双击它），然后将其删除。当解决方案正在构建时，它正在寻找该功能但找不到它。

检查 Lab5.Designer.cs 中的 radioButton2 代码。它看起来像这样：

```
 this.radioButton1.AutoSize = true;
 this.radioButton1.Location = new System.Drawing.Point(102, 162);
 this.radioButton1.Name = "radioButton1";
 this.radioButton1.Size = new System.Drawing.Size(85, 17);
 this.radioButton1.TabIndex = 1;
 this.radioButton1.TabStop = true;
 this.radioButton1.Text = "radioButton1";
 this.radioButton1.UseVisualStyleBackColor = true;
 this.radioButton1.CheckedChanged += new System.EventHandler(this.radioButton1_CheckedChanged); /* THis is the offending line! */ 
```

最后一行试图添加一个引用不存在方法的事件处理程序。您可以在此处删除它。

此外，当程序构建时，您应该能够双击编译错误，IDE 将带您找到问题的根源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:37:56.857

看起来像家庭作业。无论哪种方式，您都需要为事件 CheckChanged 的​​单选按钮实现一个处理程序。此外，如果您将这些单选按钮放在一个组中，则可以检查任何一个，并且在 checkchanged 事件中您应该填充一些 functionMode 或其他内容。例如，当 RadioButton1 被选中时，您应该存储一个变量，该变量将包含要应用的公式，在另一个被选中的变量上，您应该更改它。在按钮提交事件中，使用该变量查看当前模式并应用该公式。

# sharepoint - SharePoint FormField 不显示 ControlMode="Display" 中的内容

> ID：15823932
> 
> 赞同：1
> 
> 时间：2013-04-05T00:19:06.050
> 
> 标签：sharepoint, formfield

我使用 SharePoint 2010 标准版。

我有用于创建/编辑项目的自定义表单，以及 ControlMode="Display" 的几个字段，例如：

```
<SharePoint:FieldLabel ID="CustomStatusLabel" runat="server" FieldName="CustomStatus" ControlMode="Display" />
<SharePoint:FormField ID="CustomStatusField" runat="server" FieldName="CustomStatus" ControlMode="Display" /> 
```

当我打开此表单时，ControlMode="Edit" 中的所有字段都正确显示，但 CustomStatus 字段显示完全一样：

**自定义状态 [“自定义状态”列值]**

奇怪的是，我看到这个自定义表单在不同的服务器上工作......

# c - 在 C 中连接字符串

> ID：15823933
> 
> 赞同：-2
> 
> 时间：2013-04-05T00:19:09.947
> 
> 标签：c, string

我有一个连接两个 c 字符串的方法。该方法返回一个新的。它工作正常。有没有办法让这个方法无效，只修改第一个？

编辑：我不能使用 strcopy 或 string.h 库中的任何其他函数。还假设由调用者来确保 s1 有足够的空间来容纳 s2。

```
char *str_glue(char *s1, char *s2) 
{
char *r; //return string
int len1, len2;
int i, j;

len1 = str_length(s1);
len2 = str_length(s2);

if ((r=(char*)malloc(len1 + len2 + 1))==NULL)
{
    return NULL;
}

for (i=0, j=0; i<len1; i++, j++) {
    r[j] = s1[i];
}
for (i=0; i<len2; i++, j++)
{
    r[j] = s2[i];
}

r[j] = '\0';

return r;

}

int main() {

char* x = "lightning";
char* y = "bug";
char *z = str_glue(x, y);
printf("%s\n", z);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:31:16.283

使用标准功能`strcat()`：

> **strcat()**和**strncat()函数将一个空终止字符串****s2**的副本附加到空终止字符串**s1**的末尾，然后添加一个终止 `\0'。字符串**s1**必须有足够的空间来保存结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:35:51.667

如果您在堆上分配相同的内容，`realloc`您可以考虑使用。`s1`通过像这样修改您的代码，我能够实现您所期望的相同功能。

```
void str_glue(char **s1, char *s2) 
{
    int len1, len2;
    int i;
    char *curstr = *s1;

    len1 = strlen(curstr);
    len2 = strlen(s2);

    curstr=(char*)realloc(curstr, (len1 + len2 + 1));

    for (i=0; i<len2; i++)
    {
        curstr[(len1+i)] = s2[i];
    }
    curstr[(len1+len2)] = '\0';
} 
```

并`main`作为

```
int main()
{
    char* x;
    char* y = "bug";
    x = (char *)malloc(32);
   strcpy(x, "lightning");

   str_glue(&x, y);
    printf("%s\n", x);
} 
```

您需要包含`stdlib.h`定义`realloc`。

**PS：**我假设您不打算使用标准`C`库函数`strcat`或其他函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T00:26:23.747

并不真地。`*s1`是一个已经有固定长度的 char[]。如果你写超过那个长度，你会踩到不在`*s1`. 你必须创建一个长度为`*s1`+的新文件，`*s2`以避免这个问题，就像你已经做过的那样。

**编辑：**我想你可以写一个函数来做你想做的事情，如果`*s1`它足够大来容纳自己并且`*s2`. 但除此之外，没有。

# java - 当我知道按钮编号时动态访问按钮

> ID：15823935
> 
> 赞同：0
> 
> 时间：2013-04-05T00:19:19.090
> 
> 标签：java, swing

九个`JButtons`被宣布为：

```
private javax.swing.JButton jButton1;
private javax.swing.JButton jButton2;
private javax.swing.JButton jButton3;
private javax.swing.JButton jButton4;
private javax.swing.JButton jButton5;
private javax.swing.JButton jButton6;
private javax.swing.JButton jButton7;
private javax.swing.JButton jButton8;
private javax.swing.JButton jButton9; 
```

我本可以有一个按钮数组，但它不适合应用程序。在程序运行期间，当我知道按钮编号时，我想动态访问一个按钮。就像在某些情况下我想要按钮编号`5`一样`setText("X")`。有什么办法可以做到吗？只需执行以下操作，`JButton`数组就可以很容易地解决问题：

```
buttonArray[5].setText("X") 
```

但正如我所说，它总体上不适合应用程序。

通过按钮的编号访问按钮是一回事。如果有任何其他方法可以做到这一点，请提及。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T01:13:57.277

创建一个函数并编写与 Jbutton 数量一样多的 Switch 语句。将数字传递给函数并返回相应的第 N 个 Jbutton 对象。这是在所有给定情况下唯一可能的方法。在java中没有其他方法。有一个名为 class.forname 的东西可以从 String 中创建类，但这会创建对你没有用的新类。

# isabelle - 我可以为一个定理定义多个名称吗？

> ID：15823938
> 
> 赞同：2
> 
> 时间：2013-04-05T00:19:51.757
> 
> 标签：isabelle

假设我有一个定理：

```
theorem non_ASCII_thm_name:
  "True"
  by simp 
```

我想用类似命令`non_ASCII_thm_name`的东西定义一个 ASCII 名称。`notation`例如，像这样：

```
notation non_ASCII_thm_name ("ASCII_thm_name") 
```

Isar 命令只能与常量一起使用`notation`。`abbreviation`是否有允许我这样做的 Isar 命令？

最好，我希望我的 Isar 命令提供的只是同义词。例如，如果我使用`sledgehammer`，最好只存在一个定理 ，`non_ASCII_thm_name`这样`sledgehammer`就不会使用额外的事实`ASCII_thm_name`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T01:04:34.777

部分解决方案是使用以下命令：

```
lemmas ASCII_thm_name = non_ASCII_thm_name 
```

这将定义一个名为的新定理`ASCII_thm_name`，与 相同`non_ASCII_thm_name`。

不幸的是，不能保证诸如此类的工具`find_theorems`会使用您的新名称，而是会使用它们自己的启发式方法来确定哪个是“最佳”名称以输出给用户。

`lemmas`is的另一个同义词`theorems`，尽管前者被认为是更标准的方法。

# c++ - 类对象或指向其对象的指针？类对象组合与实现

> ID：15823942
> 
> 赞同：1
> 
> 时间：2013-04-05T00:20:09.570
> 
> 标签：c++, class, object, pointers, inheritance

**问题的背景**

我正在开发一个基本的类似战舰的衍生游戏，我想随着时间的推移继续在 C++ 中添加功能（无图形）。目前我有一个 50 x 75 的游戏板，用char 类型的 2D 矢量（称为**GameBoard ）表示。**我创建了一个游戏板并用“。”设置每个位置。字符。当您猜测坐标时，之前猜测的位置标有“-”，命中标有“X”

* * *

**我的程序在哪里**

我决定修改游戏以启用更多功能。我并没有走得太远，但是用伪代码勾勒出一个设计开始让我更多地思考如何进行这次升级。

我创建了一个名为**Block** （板上的空白区域）的类，而不是**GameBoard**是字符，它现在将具有 ax 和 y 坐标变量，以及一个用于直观显示正确字符的 char 变量。**Block**具有保存对象“ **Feature** ”的能力，该对象分解为“feature”的派生类。您可以滚动到最底部以获取有关这些类的更多详细信息。

 ******这就是我的类层次结构树的方式：

```
 feature 
                    item               vehicle
               gold     nuke                 plane 
```

* * *

**我需要什么帮助**

我基本上有我想做的大纲/结构设置。现在我只需要一些帮助来启动它来连接一切。我在确定何时以及如何使用指针方面非常糟糕。

A.) 我应该更改**GameBoard**以保存**Block**类的指针吗？还是实际 **的 Block**对象？- **Block**会持有指向**Feature**或实际**Feature**对象的指针吗？

B.) 如何添加一个可以为空或给定值的**特征变量？**我只是将其设置为NULL吗？

C.) 我是否需要自定义复制构造函数来交换**Block的****Feature**值？

 **D.)如果玩家使用**Feature**对象，我该如何从**Block中移除？**

E.)单个**块**上偶尔会出现超过 1 个**功能吗？**

 **F.) 我如何声明**Block**和**Feature**类，以便**Block**可以容纳一个**Feature**并且**Feature**已经从另一个类派生（不包括在这篇文章中）。

* * *

**关于我的课程的额外详细信息**

所以 GameBoard 是将存储块的向量。块本质上是板上的各个空间。块包含其位置的坐标、表示它的字符以及持有**Feature**对象的可能性，但大多数时候**Block**不会持有特征。**Feature**源自 Block，在游戏中作为奖励奖励。因此，**Feature**分支为另外 2 个派生类，一个 Item Feature 或 Vehicle。等等。

当玩家选择坐标时，一个方法将转到 GameBoard 上/中的那个 Block，并首先检查 char 值是否表示之前未使用过的有效空间。然后它检查这个块的内容以获得特征。Feature 可能为空或包含派生的 Feature 对象。

好的，我的小说到此结束。抱歉写了这么多。我认为获得帮助的最佳方式是让帮助者知道发生了什么。请不要回应告诉我“直奔主题”。我知道我知道.. 如果我遗漏了细节，请告诉我。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T11:08:07.233

我假设你想保持你的班级结构。在您的抽象点上，我建议通过（C++ 11 或 Boost）使用共享和 uniqe 指针。如果您不擅长指针，请了解 uniqe 和共享指针的工作原理并尝试坚持使用它们。请记住使对象的生命周期尽可能短。

> A.) 我应该更改 GameBoard 以保存 Block 类的指针吗？还是实际的 Block 对象？Block 会持有指向 Feature 或实际 Feature 对象的指针吗？

我想将此 GameBoard 元素保留为不可变的 uniqe 指针或保留实际实例。

> B.) 如何添加一个可以为空或给定值的特征变量？我只是将其设置为NULL吗？

您已决定将 Feature 保留在 Block 内 - 好的。如果是这样，请将其保留为共享指针。如果没有特征共享指针将为空。

> C.) 我是否需要自定义复制构造函数来交换 Block 的 Feature 值？

仅当功能内部存在动态/不寻常的东西时。该功能将拥有什么？

> D.) 如果玩家使用 Feature 对象，我该如何从 Block 中移除？

如果你使用共享指针没有问题。即使在处理之前的 Feature 过程中 Feature 发生了变化，当 GameBoard 不再需要 Feature 时，Feature 也会被正确处理并销毁。

> E.) 单个块上偶尔会出现超过 1 个功能吗？

你必须问自己这个问题——你的游戏需要处理这种情况吗？如果是这样，只需保存指向特征的共享指针的向量/映射/集合/数组（取决于您的要求）。

> F.) 我如何声明 Block 和 Feature 类，以便 Block 可以容纳一个 Feature 并且 Feature 已经从另一个类派生（不包括在这篇文章中）。

我不确定我是否正确理解了这个问题：

```
class Feature : public GameElement {
   /* Feature implementation */
}

class Block {
    shared_ptr<Feature> mFeature;  
    /* Block implementation */  
}; 
```

它回答了你的问题吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T00:45:53.340

1.  我不确定`feature`从类派生类是否是个好主意`block`
2.  我宁愿`feature`在 的每个实例中使用一个指针`block`，这样`NULL`如果没有特性，指针就是指针。**在您的情况下，此指针将是指向基类的指针`feature`。我鼓励使用`virtual`方法来访问单个功能。**
3.  当 a`feature`用完时，删除它并将指向它的指针设置为 NULL。（块实例中的指针）
4.  `feature`如果您想一次拥有多个`block`，请考虑使用某种数组/指针堆栈。
5.  在我看来，`GameBoard`应该包含 s 的实际实例（而不是指针）`Block`。
6.  我不明白你的意思是：

> 我是否需要自定义复制构造函数来交换 Block 的 Feature 值？

我希望这会有所帮助=)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T01:58:37.197

我认为您的 GameBoard 是 GameObject 指针的容器是个好主意。您不需要创建一个全新的类并将其命名为 Block - 所有这些都是隐含的。也不需要跟踪块的坐标，因为它们是按顺序排列的。GameObject 将是游戏元素层次结构的基类 - 在您的情况下，这将是一个 Feature，我使用 GameObject 的原因是因为 Feature 描述性不是很好 - 这个术语太宽泛，范围很广。

当游戏开始时，您的 GameBoard 可以由空指针填充，这些空指针随后被创建并添加到棋盘的实际游戏元素替换。

如果您有动态分配的数据，您只需要实现复制构造函数和赋值运算符。如果没有，编译器将生成一个非常好的版本，可以进行原始对象复制。

话虽如此，您最好不要移动实际的对象实例，而使用建议的使用指针的方法，您只会移动指针，这更简单、更快。

如果要删除功能，只需删除实际对象并将其在板中的指针设置为空。

如果您实现父/子关系，您可以在每个块中拥有一棵游戏对象树，并且您可以递归地遍历该树并按照您的意愿对树元素进行操作。

一个设计良好的多态层次结构将允许您放置几乎任何东西，只要它是从您的基类派生的。**********

# json - 网站上的 Facebook 粉丝页面提要（受年龄保护）

> ID：15823945
> 
> 赞同：0
> 
> 时间：2013-04-05T00:20:30.760
> 
> 标签：json, facebook, facebook-graph-api, feed

在尝试从 facebook 上的年龄限制的粉丝页面获取帖子/墙贴以显示在我的网站上时需要帮助。

粉丝页面有年龄限制，只允许 17 岁及以上的人查看（当他们登录 Facebook 时）。但是，我的网站（本地）落后于年龄限制，所以我想在我的网站上显示来自该 facebook 页面的帖子。

我以前见过它，但我从来没有看过这个人的代码来了解他/她是如何做到的，而且我找不到任何尝试或成功完成它的人。

我在 facebook 上创建了一个应用程序，绑定到我的帐户，它能够看到 facebook 上的任何页面（无论它是否有年龄限制）：

这是我的代码

```
 <?php

function fetchUrl($url){

 $ch = curl_init();
 curl_setopt($ch, CURLOPT_URL, $url);
 curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
 curl_setopt($ch, CURLOPT_TIMEOUT, 20);

 $feedData = curl_exec($ch);
 curl_close($ch); 

 return $feedData;

}

$profile_id = "(Page id)";

//App Info, needed for Auth
$app_id = "123456789";
$app_secret = "123456789abcdefghij";

$authToken = fetchUrl("https://graph.facebook.com/oauth/access_token?type=client_cred&client_id={$app_id}&client_secret={$app_secret}");

$json_object = fetchUrl("https://graph.facebook.com/{$profile_id}/posts?{$authToken}");

$feedarray = json_decode($json_object);

echo $json_object;

foreach ( $feedarray->data as $feed_data )
{
    echo "<h2>{$feed_data->name}</h2><br />";
    echo "{$feed_data->message}<br /><br />";
}

  ?> 
```

该代码适用于没有年龄限制的页面，但那些有年龄限制的页面返回无效（JSON 无法处理任何内容，因为 $authToken 没有返回任何内容）。

有人想帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T18:20:37.700

**使用App Access 令牌**访问的大多数页面都仅限于从公共 Facebook 页面检索数据，任何人都可以在不登录的情况下打开该页面。但对于此处的特殊情况，您要提取的帖子来自**年龄限制**页。因此，Facebook 要求您登录（如果您尚未登录），以便它可以决定是否显示该页面。同样也[记录](https://developers.facebook.com/docs/reference/api/page/)为：

> 要阅读您需要的页面：
> 
> 1.  公共和非人口限制页面的应用程序或用户访问令牌
> 2.  当前用户能够查看的受限页面的用户 access_token（不需要特殊权限）

因此，您需要使用**用户访问令牌**来访问页面，以便 Facebook 可以允许您的应用程序访问页面的帖子。

# javascript - Javascript“this”范围

> ID：15823948
> 
> 赞同：4
> 
> 时间：2013-04-05T00:21:11.030
> 
> 标签：javascript

我正在编写一些 JavaScript 代码。我对这个关键字有点困惑。如何访问`dataReceivedHandler`函数中的记录器变量？

```
MyClass: {
    logger: null,
    init: function() {
        logger = LogFactory.getLogger();
    },
    loadData: function() {
        var dataReceivedHandler = function() {
            // how to access the logger variable here? 
        }

        // more stuff
    }
}; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-05T00:25:14.270

您可以在 loadData 函数中执行类似的操作来访问您的对象...

```
MyClass: {
    logger: null,
    init: function() {
        this.logger = LogFactory.getLogger();
    },
    loadData: function() {
        var self = this;
        var dataReceivedHandler = function() {
            // how to access the logger variable here? 
            self.logger.log('something');
        }

        // more stuff
    }
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-05T00:23:47.080

假设`loadData`这样调用：

```
MyClass.loadData(); 
```

然后：

```
loadData: function() {
    var self = this;
    var dataReceivedHandler = function() {
        self.logger ...
    }

    // more stuff
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-05T00:26:54.877

因为`dataReceivedHandler`是一个匿名函数`this`，会在全局范围内引用窗口对象。我想了两种方法可以绕过它。

a）在里面创建一个变量`loadData`来保存它的上下文，然后在里面使用它`dataReceivedHandler`：

```
loadData: function() {
    var self = this;
    var dataReceivedHandler = function() {
        console.log(self.logger);
    }

    // more stuff
} 
```

[b) 使用apply](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)或[call](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)更改匿名函数的上下文。

```
loadData: function() {
    var dataReceivedHandler = function() {
        console.log(this.logger);
    }
    // more stuff
    dataReceivedHandler.call(this); // by passing this as the first argument we make sure the context of the excuted function is our current scope's this
} 
```

由于性能和内存使用优化，我更喜欢选项 B，但两者都可以正常工作。

# python - Linux python从正在运行的python脚本读取输出

> ID：15823951
> 
> 赞同：0
> 
> 时间：2013-04-05T00:22:03.193
> 
> 标签：python, linux, logging, output, autorun

我有一个 python 脚本在 linux 中作为服务运行（也作为自动运行），它有很多输出！当程序已经运行时，如何读取此输出？

也许我可以将所有输出记录到一个文件中，但是当记录新输出时，我必须一直打开并刷新文件！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T00:25:55.427

好吧，当谈到问题的第二段时，您可以在 shell 中执行以下操作：

```
tail -f logfile.log 
```

它会在文件更新时自动刷新，因此在 Linux 下这是一个可行的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T00:29:33.087

也可以从python端实现tail，基本就是连续读取它。可以在这里找到使这项工作的代码片段：

[http://code.activestate.com/recipes/157035-tail-f-in-python/](http://code.activestate.com/recipes/157035-tail-f-in-python/)

另外，如果您使用文件写入的追加模式而不是写入方法，您可以连续输出。

Scrapy 还使用了管道的概念，它允许许多相同的功能。这是一些你可能用来做同样事情的scrapy代码的例子：

```
class JsonWriterPipeline(object):
    def __init__(self):
        self.file = (open(filepath, 'a'))
    def process_item(self, item, spider):
        self.file.write(json.dumps(dict(item)) + '\n')
        return item 
```

# android - 扩展 Android Parcelable 类

> ID：15823952
> 
> 赞同：2
> 
> 时间：2013-04-05T00:22:03.437
> 
> 标签：android, oop, interface, subclass, parcelable

我有一个`CustomAddress`类扩展了`android.location.Address`实现的类`Parcelable`。

我正在尝试使我的`CustomAddress`实现`Parcelable`，但在从包裹创建我的课程时被卡住了。从宗地创建时，我想要`CustomAddress`首先填写超类中的所有字段`Address`，然后填写我自己的字段。所以我已经实现了这个`CREATOR`领域：

```
public static final Parcelable.Creator<CustomAddress> CREATOR
= new Parcelable.Creator<CustomAddress>() {
    public CustomAddress createFromParcel(Parcel in) {
        return new CustomAddress(in);
    }

    public CustomAddress[] newArray(int size) {
        return new CustomAddress[size];
    }
}; 
```

但是在我的`CustomAddress(Parcel in)`创建者中，我不能调用`super(in)`，因为它不存在于`android.location.Address`. 我只能访问`android.location.Address.CREATOR`. 那么如何使用 填写我的字段`CREATOR`？

编辑：链接到 android`Address`类[https://developer.android.com/reference/android/location/Address.html](https://developer.android.com/reference/android/location/Address.html)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T01:38:42.877

这是一个类似的问题和马克墨菲的优秀答案：[https ://stackoverflow.com/a/10841502/1140682](https://stackoverflow.com/a/10841502/1140682)

因此，在您的情况下，您将进行`CustomAddress`扩展`Address`（就像您已经做的那样），在构造函数中调用该`super()`方法，然后从传递的`Parcel`. 在方法中也必须这样做（以相同的顺序）`writeToParcel()`，当然在这里将您的属性添加到包裹中。

# c++ - 从复杂函数返回变量以在另一个函数中使用

> ID：15823953
> 
> 赞同：0
> 
> 时间：2013-04-05T00:22:04.823
> 
> 标签：c++, function, visual-c++

我很困惑，如何使用`GetCursorPos`from`GetPoint()`在 ClickSimulationMove 中获取 POINT，然后`MouseReturn`在`ClickSimulationClick`. 可悲的是，我不能将这个 Click 和 Move 功能结合在一起。

编码：

```
FB::variant TestPluginAPI::ClickSimulationClick()
{
POINT pt = GetPoint();
ShowCursor(true);
MouseLeft();
MouseReturn(pt.x, pt.y);
ShowCursor(true);
return 0;
}

POINT TestPluginAPI::GetPoint()
{
POINT pt;
GetCursorPos(&pt);
return pt;
}

FB::variant TestPluginAPI::ClickSimulationMove()
{
MouseMove(-325, 605);
return 0;
} 
```

ClickSimulationMove() 先行，然后 ClickSimulationClick()，因此 GetPoint() 获取已移动鼠标的 POINT，但我需要尚未移动鼠标的 POINT 返回该位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T00:32:07.180

**在移动鼠标之前**，您需要记下鼠标的位置。所以在 MouseMove 之前调用 GetCursorPos。在传递给恢复光标位置的函数的变量中记住这个位置。

# meteor - 有什么方法可以禁用 var 作用域？

> ID：15823954
> 
> 赞同：2
> 
> 时间：2013-04-05T00:22:18.307
> 
> 标签：meteor

Meteor 0.6.0 中引入的文件级 JavaScript 变量作用域破坏了使用 TypeScript（以及 CoffeeScript 和可能的其他转译器）编写的项目和包。有没有办法禁用它？

例如，这个打字稿代码：

```
declare var Meteor: any;
module Model {
  export var Players = new Meteor.Collection('players');
} 
```

生成这个不再起作用的 JavaScript，因为 Model 不再被认为是全局的：

```
var Model;
(function (Model) {
    Model.Players = new Meteor.Collection('players');
})(Model || (Model = {})); 
```

前置`this.Model = null;`是一种解决方法，但它是多余的，您必须将其应用于与 Meteor 一起使用的所有代码（它至少损坏了我的一个 Meteorite 包）。

引入 Meteor 特定 JavaScript 语言语义的原因是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T06:32:32.290

他的方式有点好，因为在所有这些文件共享变量之前有点奇怪。Meteor 将每个 javascript 文件视为一个文件。拥有较大的项目（>20 个 js 文件）使得模块化应用程序变得非常困难

我对打字稿不太确定，但建议在在咖啡脚本中声明之前使用它来制作全局内容： [http](http://docs.meteor.com/#coffeescript)`@` ://docs.meteor.com/#coffeescript ，也许打字稿中有类似的东西？（来自coffeescript）`@`

```
@myFunction = -> 123 
```

# matlab - 如何使用 Matlab 查找并显示均方误差随品质因数变化的图形？

> ID：15823955
> 
> 赞同：-1
> 
> 时间：2013-04-05T00:22:19.133
> 
> 标签：matlab, image-processing

我们的老师希望我们在 Matlab 上打印一张图表，该图表在*x 轴上*绘制**质量因子**，在*y 轴上*绘制**均方误差**。该图像是已知的“lenna.jpg”。

我已经搜索并找到了如何找到 mse，但我没有找到任何可以帮助我找到质量因子的方法。

那么，你能用 Matlab 代码告诉我，如何找到这两个东西以及如何在图表中显示它们吗？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T02:31:29.570

我现在没有可用的 matlab，但我认为以下应该可以工作：

```
original=imread('lena.jpg');
mse=zeros(1,100);
for q = 1:100
    tempFile = sprintf('lena%03d.jpg', q);
    imwrite(original, tempfile, 'quality', q);
    thisOne = imread(tempfile);
    mse(q) = sum((original - thisOne).^2)/numel(thisOne);
end

figure
plot(1:100, mse)
xlabel 'quality factor'
ylabel 'MSE'
title 'Degradation of Lena.jpg with quality factor' 
```

# knockout.js - 带有 Foreach If 条件的 KO 模板导致 afterAdd 不触发

> ID：15823956
> 
> 赞同：0
> 
> 时间：2013-04-05T00:22:38.260
> 
> 标签：knockout.js, knockout-2.0

在下面的示例中，您将看到 doSomething 永远不会触发。如果您`if: Comments`从模板绑定中删除 doSomething ，则会按预期触发。有谁知道这是怎么回事？`data`使用模板绑定处理程序上的属性时也会发生这种情况。

我目前正在使用 Knockout 2.2.1。jsfiddle [http://jsfiddle.net/YADzx/2/](http://jsfiddle.net/YADzx/2/)

```
<div data-bind="template: { if: Comments, name: 'comments' }"></div>

<script type="tmpl" id="comments">
    <div data-bind="foreach: { data: Comments, afterAdd: $root.doSomething }">
        <div data-bind="text: name"></div>
    </div>
</script>
<script>
var vm = {
    Comments: ko.observableArray([{name:'hey'}]),
    doSomething: function (element, index, data) {
        $(element).addClass('wow');
    }
};

ko.applyBindings(vm);
vm.Comments.push({name:'foo'});
vm.Comments.push({name:'bar'});
</script> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-05T02:04:57.817

绑定的`if`条件`template`会导致它在更改时更新`Comments`。然后，Knockout 将重新渲染整个模板，并且之前的`foreach`绑定状态会丢失。

根据您想要或不想要的副作用，有几种方法可以解决此问题。

1.  删除该`if`选项。您的代码仍然可以工作，但您将在 HTML 中`<div>`使用`foreach`绑定。因此，如果它弄乱了您的布局，这不是一个好的选择。

2.  拆分`if`from`template`并使用`if`绑定的另一个元素（或注释语法）。只要您使用的是 2.2.0 或更高版本的 Knockout，这将起作用。

    ```
    <script type="tmpl" id="comments">
        <!--ko if: Comments-->
        <div data-bind="foreach: { data: Comments, afterAdd: $root.doSomething }">
            <div data-bind="text: name"></div>
        </div>
        <!--/ko-->
    </script> 
    ```

3.  不要使用`if`绑定，而是使用`visible`绑定，它会隐藏当前元素并且不会重新渲染。

    ```
    <script type="tmpl" id="comments">
        <div data-bind="visible: Comments, foreach: { data: Comments, afterAdd: $root.doSomething }">
            <div data-bind="text: name"></div>
        </div>
    </script> 
    ```

但是，要考虑的一件事是，`observableArray`通常不会包含虚假值。那是因为在 JavaScript 中，空数组仍然是真实的。如果要测试空数组，则需要从 更改`if: Comments`为`if: Comments().length`。

# yammer - 是否可以从 yammer 中查询出所有“赞美”消息？

> ID：15823957
> 
> 赞同：3
> 
> 时间：2013-04-05T00:23:00.907
> 
> 标签：yammer

Yammer 具有一项功能，可让您“赞美”某人。但是，查看从“赞美”消息返回的数据，似乎没有任何区别标志或属性将其标记为“赞美”消息。在邮件中，有一个带有“type=praise”的附件，然后是“praised-user-id”。

从 Yammer 中提取此信息的最佳方法是什么？

![Yammer 消息 JSON](https://i.stack.imgur.com/L5mBI.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T21:53:24.427

不幸的是，目前无法从 Yammer 中提取所有赞美消息。[加入Yammer 开发人员网络](https://developer.yammer.com/)并跟踪 API 更新是值得的，但这不是我期望在不久的将来看到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-30T14:23:05.370

稍微考虑一下，尝试使用“搜索”API 寻找“赞美”这个词，因为它总是在正文中。这应该只返回包含表扬的结果。

# git - 在 github 上 fork，那么我如何管理我的贡献？

> ID：15823962
> 
> 赞同：4
> 
> 时间：2013-04-05T00:23:28.083
> 
> 标签：git, github, git-branch

我对`fork`在 github 上遵循 a 的 forkflow 有点不清楚。

如果我在原始存储库中对中型项目（例如 OpenGrok）中的各种错误进行了几个小的独立修复，该怎么办？

*   我是否为每个相对较小的不相关错误修复创建单独的分支？

*   我是从创建每个分支`master`，还是从下一个分支一个不相关的分支？

*   我是否将修复提交到`master`?

我的意思是，随着时间的推移，我仍然想保留历史和所有内容，但我只是担心一段时间后，对于相对较小的错误修复而言，许多无意义的分支会变得一团糟。

我计划为给定项目贡献一些不相关的修复，并尝试对开发方法进行一些规划。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T00:49:14.397

在 github 上 fork 一个项目并且您计划向上游提交更改时，有几种可能的工作流程。这是我通常倾向于遵循的工作流程之一（我将调用我从中分叉的 repo 为 remote `source`，我的 repo 为`origin`）：

*   fork 使用的主分支`source`，比如说`master`into `origin/my-dev`。
*   `origin/mydev`是我所有变化和主要发展的地方。
*   我经常重新定位（这一步是多余的，但有时我很容易将所有东西都放在一个遥控器上）`remote/master`。`origin/master`
*   每当您想从上游获取更改时，合并其中一个`source/master`或重新设置`origin/master`为。`origin/my-dev`
*   如果我想在上游提交补丁或错误修复，我会启动一个新的功能分支，我可以将其用于拉取请求。我会打电话`origin/my-feature-1`的。`origin/master`我根据最新（或`source/master`）创建此分支
*   我挑选了我`origin/my-dev`在`origin/my-feature-1`. 在此步骤之后执行任何测试。
*   提交拉取请求`origin/my-feature-1`
*   如果您的拉取请求获得批准，则更改将被合并`source/master`（`origin/master`也）。
*   执行从 `origin/master`（或`source/master`）到的合并`origin/my-dev`。
*   就分支的生命周期而言，我通常倾向于在将其合并到上游之后摆​​脱短暂的主题或特性分支（分支只是 git 中引用某个提交的轻量级指针）。

一遍又一遍地重复这个工作流程。

关键思想是你的拉取请求不应该对上游维护者造成任何严重的冲突，否则他/她会盲目地拒绝贡献。

当您想从上游做出贡献时`D2`，我已经举例说明了一个示例。和是和的变基版本。提交是上游提交，是您的下游提交。带后缀的是合并。`D3``origin/my-dev``D2'``D3'``D2``D3``U``source``D``origin``M`

从视觉上看，这就是它的样子：

```
source/master             origin/my-dev
     U1
     U2   Initial-fork
     U3-----------\
     |             \
     |              \------------D1
     |                           D2
     U4 Sync up from upstream    |
     U5-----------\              D3
     |             \             |
     U6             \------------DM4                        origin/feature-1
     |                           |
     |                           |     Starting point of feature-1
     U7------------------------------------------------------------D2'  (Rebased version of D2)
     |                           |                                 D3'  (Rebased version of D3)
     |                           D5                                /
     U8                          D6      Pull-request             /
     |                           |       getting merged upstream /
     UM9--------------------------------------------------------/
     |                           |
     |              Resync       |
     |-------------\ my-dev      |
     U9             \            |
     U10             \-----------DM7
     |                           |
     |                           | 
```

# asp.net-mvc-3 - ViewData 页面中未设置 mvc3 cookie 值

> ID：15823965
> 
> 赞同：2
> 
> 时间：2013-04-05T00:23:45.547
> 
> 标签：asp.net-mvc-3, cookies, httpresponse

我有一个文本框和一个提交按钮，人们在其中输入一个 5 数字密码，然后将其保存在 cookie 中 4 个月，但它无法正常工作，我什么也没得到.. 可能有什么问题.. 这我是第一次尝试饼干吗

**阅读视图**

```
public ActionResult Index()
{
    //read cookie and send it to view model
    var mycookie = Request.Cookies["mypreference"];
    ViewData["prefvalue"] = mycookie.Value;
    return View();
} 
```

**HttpPost**

```
[HttpPost]
public ActionResult Index(FormCollection ss)
{
    // create cookie
    HttpCookie preference = new HttpCookie("mypreference");
    preference.Value = ss["preffer"];
    preference.Expires = DateTime.Now.AddDays(120d);
    Response.Cookies.Add(preference);
    return View();
} 
```

**风景**

```
@using (Html.BeginForm("seotips", "home", FormMethod.Post))
{
    @Html.TextBox("preffer") 
    <input type="submit" value="submit" />
}
@ViewData["prefvalue"] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T05:14:59.570

你必须试试这个

```
public ActionResult Index()
{
   HttpCookie coo = new HttpCookie("name");

    coo["Country"] = "INDIA";

    ViewData["prefvalue"] = coo["Country"];
    return View();
} 
```

# c# - VS2010中的CPU采样通过附加到进程？

> ID：15823969
> 
> 赞同：0
> 
> 时间：2013-04-05T00:24:04.173
> 
> 标签：c#, visual-studio-2010, .net-4.0, profiling

是否可以通过附加到进程选项在 VS2010 中执行 CPU 采样？当我使用该选项时，它似乎总是默认为内存分析。我无法使用向导启动 CPU 采样，因为我们工作 PC 上的荒谬安全软件不允许它使用的 DLL 注入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T03:22:23.757

如果您选择*Analyze\Profiler\New Performance Session*，Performance Explorer 将打开一个新的性能会话。在此项的属性中，您可以指定要使用的分析类型：

![性能会话属性](https://i.stack.imgur.com/SEJbb.png)

然后，您可以通过会话上下文菜单中的“附加/分离”将此会话附加到您的进程：

![将性能会话附加到流程](https://i.stack.imgur.com/tGd2B.png)

# c++ - 从动态数组设置位然后显示

> ID：15823971
> 
> 赞同：0
> 
> 时间：2013-04-05T00:24:47.490
> 
> 标签：c++, set, overloading, bit-manipulation, bit

我有一个构造函数，它创建一个 BitArray 对象，它询问用户他们想使用多少“位”。然后它使用无符号字符来存储保存多个所需的字节。然后我希望创建允许用户“设置”某个位的方法，并在最后显示完整的字节集。但是，我的 Set 方法似乎并没有改变位，或者我的 Print 函数（The Overload）似乎实际上并没有打印实际的位。有人可以指出问题吗？

构造函数

```
BitArray::BitArray(unsigned int n)
{

//Now let's find the minimum 'bits' needed

n++;
//If it does not "perfectly" fit
//------------------------------------ehhhh
if( (n % BYTE) != 0)
    arraySize =(n / BYTE);
else
    arraySize = (n / BYTE) + 1;

//Now dynamically create the array with full byte size
barray = new unsigned char[arraySize];

//Now intialize bytes to 0
for(int i = 0; i < arraySize; i++)
{
    barray[i] = (int) 0;
}

} 
```

设置方法：

```
 void BitArray::Set(unsigned int index)
{
        //Set the Indexed Bit to ON
        barray[index/BYTE] |= 0x01 << (index%BYTE);
} 
```

打印过载：

```
 ostream &operator<<(ostream& os, const BitArray& a)
{  
        for(int i = 0; i < (a.Length()*BYTE+1); i++)
        {
            int curNum = i/BYTE;
            char charToPrint = a.barray[curNum];
            os << (charToPrint & 0X01);
            charToPrint >>= 1;
        }
    return os;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T01:56:55.123

```
 for(int i = 0; i < (a.Length()*BYTE+1); i++)
    {
        int curNum = i/BYTE;
        char charToPrint = a.barray[curNum];
        os << (charToPrint & 0X01);
        charToPrint >>= 1;
    } 
```

每次运行循环时，都会为`charToPrint`. 这意味着该操作`charToPrint >>= 1;`是无用的，因为该修改不会在下一次循环运行时执行。`char`因此，您将始终只打印每个数组的第一位。

# ios - 如何使用按钮使我的图片在屏幕上自行重新定位

> ID：15823972
> 
> 赞同：2
> 
> 时间：2013-04-05T00:24:53.990
> 
> 标签：ios, objective-c, button, user-interface

我正在学习 Xcode，我想知道如何让按钮刷新我的代码或其他内容的一部分。我将图片放在屏幕上的随机位置，但我希望能够按下按钮将其重新定位到另一个随机位置，任何输入将不胜感激。谢谢。这是我的代码。视图控制器.m

```
- (void)viewDidLoad
{
int xValue = arc4random() % 320;
int yValue = arc4random() % 480;

UIImageView *imgView = [[UIImageView alloc] initWithFrame:CGRectMake(xValue, yValue, 70, 30)];
NSString *imgFilepath = [[NSBundle mainBundle] pathForResource:@"clubs-2-150" ofType:@"jpg"];
UIImage *img = [[UIImage alloc] initWithContentsOfFile:imgFilepath];
[imgView setImage:img];
[self.view addSubview:imgView];

[super viewDidLoad];   
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T01:05:02.583

就您的代码现在而言，变量不可能具有范围，这意味着它们仅存在于某些函数或类中。您的变量`imgView`仅存在于`viewDidLoad`. 为了能够在其他地方访问它，您需要将其声明为实例变量。

在你的 .h 文件中：

```
@interface yourClassName : UIViewController {
   UIImage *imageIWantToChange;
} 
```

这将允许您在所有 yourClassName 函数中访问 imageIWantToChange。

现在，在你的 .m

```
- (void)viewDidLoad
{

   [super viewDidLoad];   

   int xValue = arc4random() % 320;
   int yValue = arc4random() % 480;

   //Notice that we do not have UIImage before imageIWantToChange
   imageIWantToChange = [[UIImageView alloc] initWithFrame:CGRectMake(xValue, yValue, 70, 30)];
   UIImage *img = [UIImage imageNamed:@"clubs-2-150.jpg"];
   [imageIWantToChange setImage:img];
   [self.view addSubview:imgView];

} 
```

然后在您的 IBAction 或按钮选择器中：

```
-(IBAction) buttonWasPressed:(id) sender {
   CGRect frame = imageIWantToChange.frame;

   frame.origin.x = arc4random() % 320;
   frame.origin.y = arc4random() % 480;

   imageIWantToChange.frame = frame;
} 
```

# c++ - C++，在派生类上带有 istream 的构造函数

> ID：15823973
> 
> 赞同：0
> 
> 时间：2013-04-05T00:24:57.663
> 
> 标签：c++, constructor, stream

我对派生类有一个问题，该派生类的构造函数带有 istream 参数。

***参考*****.cpp_**

```
....
Reference::Reference(istream& p_is)
{...}
.... 
```

***Livre.h_*** **_**

```
class Livre : public Reference
    {

    private:
    void verifieInvariant() const;
    std::string m_editeur;
    std::string m_isbn;

    public:

    Livre(
        const std::string& p_cote,
        const std::string& p_theme,
        const std::string& p_titre,
        const std::string& p_auteurs,
        int p_anneeEdition,
        const util::Date& p_dateAcquisition,
        const std::string& p_editeur,
        const std::string& p_isbn);

    Livre(std::istream& p_is);
... 
```

***下载文件***

```
....
Livre::Livre(std::istream& p_is)
{

    Reference(std::istream& p_is);
    string editeur ="";

    string isbn = "";
    string buffer = "";
    getline(p_is, buffer);
    getline(p_is, editeur);
    getline(p_is, isbn);

    m_editeur = editeur;
    m_isbn = isbn;  
} 
```

好的，所以我的问题很简单。编译器不允许我`istream`为派生类 Livre 创建另一个构造函数。我的 Reference 类是一个抽象类，我需要在构造函数 Livre 中使用 Reference 的流调用构造函数来完成信息。我的另一个选择是写

```
Reference::Reference(std::istream& p_is)
{...} 
```

进入我的 Livre.cpp。因此，如果有人可以向我解释一个更好的方法，我将不胜感激。我知道我有很多代码，但要解释这个问题并不容易。多谢你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T00:29:18.277

我不确定是否是问题所在，但我相信正确的方法是重写

```
Livre::Livre(std::istream& p_is)
{
    Reference(std::istream& p_is);
    /* ... */
} 
```

作为

```
Livre::Livre(std::istream& p_is) : Reference(p_is);
{
    /* ... */
} 
```

# r - 合并数据框以消除缺失的观察结果

> ID：15823976
> 
> 赞同：6
> 
> 时间：2013-04-05T00:25:32.250
> 
> 标签：r, merge

我有两个数据框。一 ( `df1`) 包含所有感兴趣的列和行，但包括缺失的观察值。另一个 ( `df2`) 包括用于代替缺失观测值的值，并且仅包括在 中至少`NA`存在一个的列和行`df1`。我想以某种方式合并这两个数据集以获得`desired.result`.

这似乎是一个非常简单的问题要解决，但我正在画一个空白。我不能`merge`去上班。也许我可以写嵌套`for-loops`，但还没有这样做。我也试`aggregate`了几次。我有点害怕发布这个问题，担心我的`R`卡可能会被吊销。抱歉，如果这是重复的。我在这里和谷歌进行了相当深入的搜索。谢谢你的任何建议。`R`优选碱溶液。

```
df1 = read.table(text = "
  county year1 year2 year3
    aa     10    20   30
    bb      1    NA    3
    cc      5    10   NA
    dd    100    NA  200
", sep = "", header = TRUE)

df2 = read.table(text = "
  county year2 year3
    bb      2   NA
    cc     NA   15
    dd    150   NA
", sep = "", header = TRUE)

desired.result = read.table(text = "
  county year1 year2 year3
    aa     10    20   30
    bb      1     2    3
    cc      5    10   15
    dd    100   150  200
", sep = "", header = TRUE) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-05T01:16:57.290

`aggregate`可以这样做：

```
aggregate(. ~ county,
          data=merge(df1, df2, all=TRUE), # Merged data, including NAs
          na.action=na.pass,              # Aggregate rows with missing values...
          FUN=sum, na.rm=TRUE)            # ...but instruct "sum" to ignore them.
##   county year2 year3 year1
## 1     aa    20    30    10
## 2     bb     2     3     1
## 3     cc    10    15     5
## 4     dd   150   200   100 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T00:43:20.673

这将做：

```
m <- merge(df1, df2, by="county", all=TRUE)

dotx <- m[,grepl("\\.x",names(m))]

doty <- m[,grepl("\\.y",names(m))]

dotx[is.na(dotx)] <- doty[is.na(dotx)]

names(dotx) <- sapply(strsplit(names(dotx),"\\."), `[`, 1)

result <- cbind(m[,!grepl("\\.x",names(m)) & !grepl("\\.y",names(m))], dotx) 
```

检查：

```
> result
  county year1 year2 year3
1     aa    10    20    30
2     bb     1     2     3
3     cc     5    10    15
4     dd   100   150   200 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-05T01:18:11.517

另一种选择取消`reshape2`并以长格式工作：

```
library(reshape2)
## reshape to long format
df1.m <- melt(df1)
df2.m <- melt(df2)
## get common values
idx <- df1.m$county %in% df2.m$county & 
       df1.m$variable%in% df2.m$variable
## replace NA values 
df1.m[idx,]$value <- ifelse(is.na(df1.m[idx,]$value),
                            df2.m$value , 
                            df1.m[idx,]$value)
## get the wide format
dcast(data=df1.m,county~variable)

  county year1 year2 year3
1     aa    10    20    30
2     bb     1     2     3
3     cc     5    10    15
4     dd   100   150   200 
```

# asp.net - 如何在 asp:textbox 中添加提示

> ID：15823983
> 
> 赞同：118
> 
> 时间：2013-04-05T00:25:57.057
> 
> 标签：asp.net, css, html, placeholder, hint

如何在 asp:TextBox 中放置提示/占位符？当我说一个提示时，我的意思是一些文本在用户点击它时会消失。有没有办法使用 html / css 来实现相同的目标？

* * *

## 回答 #1

> 赞同：225
> 
> 时间：2013-04-05T00:32:36.527

# `placeholder`属性_

您正在寻找[`placeholder`](https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Forms_in_HTML#The_placeholder_attribute)属性。像使用 ASP.net 控件中的任何其他属性一样使用它：

```
<asp:textbox id="txtWithHint" placeholder="hint" runat="server"/> 
```

不要担心您的 IDE（即 Visual Studio）可能**不知道**该属性。未在 ASP.net 中注册的属性将按原样传递和呈现。所以上面的代码（基本上）呈现为：

```
<input type="text" placeholder="hint"/> 
```

# `placeholder`在资源中使用

将提示应用于控件的一种好方法是使用[资源](https://msdn.microsoft.com/library/fw69ke6f%28v=vs.100%29.aspx)。这样你可能会有本地化的提示。假设您有一个*index.aspx*文件，您的*App_LocalResources/index.aspx.resx*文件包含

```
<data name="WithHint.placeholder">
    <value>hint</value>
</data> 
```

你的控制看起来像

```
<asp:textbox id="txtWithHint" meta:resourcekey="WithHint" runat="server"/> 
```

呈现的结果将与上一章中的结果相同。

# 在后面的代码中添加属性

像任何其他属性一样，您可以将其添加`placeholder`到[`AttributeCollection`](https://msdn.microsoft.com/de-de/library/system.web.ui.attributecollection%28v=vs.110%29.aspx)：

```
txtWithHint.Attributes.Add("placeholder", "hint"); 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2013-04-05T00:34:28.767

就这样写：

```
<asp:TextBox ID="TextBox1" runat="server" placeholder="hi test"></asp:TextBox> 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2015-02-18T11:23:28.700

```
 <asp:TextBox runat="server" ID="txtPassword" placeholder="Password"> 
```

这将起作用，您可能有一段时间觉得它不起作用，因为 Intellisence 没有显示**占位符**

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2016-01-08T05:36:13.517

从代码隐藏添加占位符属性：

```
txtFilterTerm.Attributes.Add("placeholder", "Filter" + Filter.Name); 
```

或者

```
txtFilterTerm.Attributes["placeholder"] = "Filter" + Filter.Name; 
```

从 aspx 页面添加占位符属性

```
<asp:TextBox type="text" runat="server" id="txtFilterTerm" placeholder="Filter" /> 
```

或者

```
<input type="text" id="txtFilterTerm" placeholder="Filter"/> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-19T12:42:43.710

```
asp:TextBox ID="txtName" placeholder="any text here" 
```

# java - Netbeans JFrame 初始化；构建很好，但没有窗口

> ID：15823986
> 
> 赞同：7
> 
> 时间：2013-04-05T00:26:25.750
> 
> 标签：java, swing, netbeans, jframe

我正在使用 Java，并且正在尝试使用 NetBeans 创建 GUI。我以前做过，我很困惑，因为我的代码虽然 NetBeans 不会出错，但当我在 NetBeans 中运行它时不会生成新的 JFrame 窗口。但是，初始化 JFrame 的代码与我之前的 GUI 拥有程序（“程序一”）基本相同。当我尝试运行“程序一”时，它工作得很好。这是我的问题代码；

```
package aircannoncalculator;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class CalcGUI extends JFrame {

public CalcGUI(){
    setTitle("Air Cannon Modeler");
    setSize(400,400);
    setLocationRelativeTo(null);
    setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
}

public static void main(String[] args){

        CalcGUI gui = new CalcGUI();
        gui.setVisible(true);

}
} 
```

根据 NetBeans 的说法，构建总是很顺利，但正如我所说，没有生成实际的窗口。我究竟做错了什么？

边注; 忽略我的无偿进口清单。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-07-07T20:07:27.583

您必须将 JFrame 设置为项目的主类。右键单击项目名称（咖啡杯图标） -> 设置配置 -> 自定义 -> 在“运行”部分中单击“主类：”右侧的浏览按钮以选择默认主类（您想要的JFrame），完成！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-11T03:28:43.357

```
package aircannoncalculator;

import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JTextField;

public class CalcGUI extends JFrame {

    public CalcGUI(){
        setTitle("Air Cannon Modeler");
        setSize(400,400);
        setLocationRelativeTo(null);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }

    public static void main(String[] args){

        CalcGUI gui = new CalcGUI();

        //Try adding some JComponents
        this.pack();    //this tends to compact the JFrame container & displays it when you setVisible(true)

        gui.setVisible(true);

    }
} 
```

# android - Android - 为什么 setVisibility 不起作用？

> ID：15823987
> 
> 赞同：2
> 
> 时间：2013-04-05T00:26:37.237
> 
> 标签：android, visibility, android-imageview

我有一个 ToggleButton，当按下它时，它会隐藏/显示一个 ImageView：

```
public void onClick(View v) {
    View view = (View) v.getTag();

    ImageView messageStatusImageView = (ImageView) view.findViewById(R.id.messageStatusImageView);

    if (((CheckableLinearLayout)v).isChecked()) {
           messageStatusImageView.setVisibility(View.GONE);
    } else {
           messageStatusImageView.setVisibility(View.VISIBLE);
    }
} 
```

问题是 ImageView 没有`VISIBLE`再次变成。

有人知道为什么吗？

提前致谢。

# python - jinja：TemplateSyntaxError：预期的令牌“名称”，得到“字符串”

> ID：15823989
> 
> 赞同：9
> 
> 时间：2013-04-05T00:26:49.097
> 
> 标签：python, flask, jinja2

在 Flask 应用程序中有两个文件：

`base.html`

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link rel="stylesheet" href="../static/main.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.1.1/css/bootstrap.min.css">
    <title>Title</title>
</head>
<body>
<div id="content">
    {% marker "content" %}
</div>

</body>
</html> 
```

`upload.html`, 延伸`base.html`

```
{% extends "base.html" %}

{% block "content " %}
<title>Upload new File</title>
<h1>Upload new File</h1>
<form action="" method=post enctype=multipart/form-data>
    <p><input type=file name=file>
        <input type=submit value=Upload>
</form>
{% endblock %} 
```

我在 view: 中调用后者，`return render_template('upload.html' )`但出现错误：

```
jinja2.exceptions.TemplateSyntaxError
TemplateSyntaxError: expected token 'name', got 'string' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-05T01:07:00.127

问题是`{% block "content" %}`应该`{% block content %}`- 不应该引用块的名称。

此外`marker`，您的 layout.html 中的构造[不是有效的 Jinja2 标记](https://stackoverflow.com/questions/8685616/status-of-the-marker-keyword-in-jinja)- 它应该是`{% block content %}{% endblock %}`.

# c# - 仅使用 ObjectListView 根据 VirtualObjectListView 中可见的内容加载和卸载数据？

> ID：15823990
> 
> 赞同：0
> 
> 时间：2013-04-05T00:26:51.550
> 
> 标签：c#, winforms, caching, objectlistview

我正在使用[ObjectListView](http://objectlistview.sourceforge.net/cs/index.html)在 C# 中编写视频管理器，其中生成、保存预览图像，并将条目放入 sqlite db。从那里，我使用 VirtualObjectListView 组件在详细信息模式下显示条目（包括第一个图像作为预览）。

我遇到的问题是，有数百个条目，它开始吃掉内存，我看到**很多**文件*（也有很多重复）*在 Process Explorer 中打开/锁定。因此，我尝试实现一个缓存系统——一次只加载 30 张图像，在加载新图像时卸载不需要的图像。

它不起作用。它最终以某种方式加载每个文件的多个副本，只是感觉......哈克。在过去的几天里，我一直在寻找可以将方法绑定到的事件或其他东西，但我做不到，所以我不得不在**AbstractVirtualListDataSource中使用****GetNthObject**。

 **无论如何，这是我的代码：

```
public override object GetNthObject(int n) {
    VideoInfo p = (VideoInfo)this.Objects[n % this.Objects.Count];
    p.ID = n;

    int storeBufferHalf = 5;
    int storeFrom = (n - storeBufferHalf < 0) ? 0 : n - storeBufferHalf;
    int storeTo = (n + storeBufferHalf >= Objects.Count()) ? Objects.Count() - 1 : n + storeBufferHalf;

    foreach (int cacheItem in cacheList.ToList()) {
        if (cacheItem >= storeFrom && cacheItem <= storeTo)
            continue;

        VideoInfo unloadItem = (VideoInfo)this.Objects[cacheItem];
        //Debug.WriteLine(cacheItem + " Preparing to delete cache: " + unloadItem.Name);
        unloadItem.DestroyPreviewImage();
        cacheList.Remove(cacheItem);

    }

    //Load up items into cache.
    for (int i = storeFrom; i < storeTo; i++) {
        if (!cacheList.Contains(i)) {
            VideoInfo loadItem = (VideoInfo)this.Objects[i];
            if (loadItem.PreviewImage != null)
                continue;

            loadItem.SetPreviewImage();
            cacheList.Add(i);
        }
    }
    return p;
} 
```

更多信息：基本上，它*有点*工作......它**确实**加载了每个文件的多个副本，它最终确实加载了比你向下滚动一点后应该加载的更多图像（实际上是 60 个项目的整个测试数据库），但是向上和向下滚动列表几次可以卸载文件（至少根据 Process Explorer）。

在那之后，它开始再次加载它们，其中一些是多次......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T02:00:50.620

我认为您需要对输入源列表进行分组/拆分。

考虑使用[此答案](https://stackoverflow.com/a/438513/1043380)作为将 IEnumerable 拆分为 n 部分的方法。然后使用按钮获取下一个/最后一个部分，并将其设置为您的绑定源。**

# ios - IOS - 从 UITextView 中删除所有填充

> ID：15823991
> 
> 赞同：78
> 
> 时间：2013-04-05T00:26:54.080
> 
> 标签：ios, uitextview, padding

SO上有很多很好的例子来删除UITextView的左填充。

[如何在 UITextView 中丢失边距/填充？](https://stackoverflow.com/questions/746670/how-to-lose-margin-padding-in-uitextview)

但是，我也需要删除正确的填充。

我试过了...

```
[tv setContentInset: UIEdgeInsetsMake(-4,-8,-8,-X)];//where X is any integer 
```

并且几乎所有其他最后两个值的排列都删除了填充，似乎没有任何效果。也试过

```
[tv sizeToFit];
[tv setTextAlignment:[NSTextAlignmentRight]]; 
```

Textview 中的以下文本显示“00”

![在此处输入图像描述](https://i.stack.imgur.com/3kOp8.png)

* * *

## 回答 #1

> 赞同：227
> 
> 时间：2013-11-28T15:27:54.493

虽然它只是 iOS 7，一个非常干净的解决方案是将 textView 的 textContainerInsets 设置为：

```
[textView setTextContainerInset:UIEdgeInsetsZero];
textView.textContainer.lineFragmentPadding = 0; // to remove left padding 
```

这将有效地删除文本视图内文本周围的所有填充（插图）。如果您的部署目标是 iOS 7+，那么这是迄今为止最好的解决方案。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2016-10-06T04:44:18.280

要完全删除所有填充，`lineFragmentPadding`必须考虑到。

```
let padding = textView.textContainer.lineFragmentPadding
textView.textContainerInset =  UIEdgeInsets(top: 0, left: -padding, bottom: 0, right: -padding) 
```

[`lineFragmentPadding`](https://developer.apple.com/reference/uikit/nstextcontainer/1444527-linefragmentpadding)默认值为 5，位于片段矩形的开头和结尾。

一些答案建议设置`lineFragmentPadding`为 0。但是，根据文档中的讨论，它并非旨在表达文本边距。所以不要设置为0。

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2020-01-08T04:05:09.007

用于 OA 的 Swift 4 版本

```
self.tDescription.textContainerInset = UIEdgeInsets.zero
self.tDescription.textContainer.lineFragmentPadding = 0 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2021-02-22T12:28:57.023

***对于 iOS 11.7***

以下代码对我有用：

```
 textView.textContainer.lineFragmentPadding = CGFloat(0.0)
    textView.textContainerInset = UIEdgeInsets(top: 0, left: 0, bottom: 0, right: 0)
    textView.contentInset = UIEdgeInsets(top: 0,left: 0,bottom: 0,right: 0) 
```

来自官方[文档](https://developer.apple.com/documentation/appkit/nstextview/1449168-textcontainerinset)：

***`textContainerInset`*** ：可以设置文本容器和视图大小以及调整大小行为，以便`inset`无法准确维护，尽管文本系统会尽可能地维护`inset`。

在任何情况下，`textContainerOrigin`文本容器的大小对于文本容器在视图中的位置都是权威的。文本本身可以在文本容器内有一个额外的插图，`lineFragmentPadding`由`NSTextContainer`.

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-04-09T04:31:06.777

请尝试对 UITextView 进行子类化并覆盖以下方法：

```
 - (id)styleString
{
    return [[super styleString] stringByAppendingString:@"; line-height: 1.6em;margin-right: 30px; margin-left: 0px; margin-top: 0px;"];
} 
```

显然; 你可以调整margin-left、margin-top和任何你想要的；）

* * *

## 回答 #6

> 赞同：-4
> 
> 时间：2014-07-21T08:14:20.540

我的问题就这样解决了

```
if([Utils isiOS7orHigher]){
    commentView.textContainerInset = UIEdgeInsetsZero;
}else {
    commentView.contentInset = UIEdgeInsetsMake(-11,-8,0,0);
} 
```

有关更多信息，请参见[http://foobarpig.com/iphone/get-rid-of-uitextview-padding.html](http://foobarpig.com/iphone/get-rid-of-uitextview-padding.html)

# python - 采购申请模块的问题 - OpenErp

> ID：15823993
> 
> 赞同：0
> 
> 时间：2013-04-05T00:26:56.423
> 
> 标签：python, module, openerp

当我单击“采购申请”模块中的“确认申请”按钮时出现此错误

```
 File "C:\Program Files\OpenERP 7.0-20130321-002353\Server\server\openerp\addons\purchase_requisition\purchase_requisition.py", line 215, in wkf_confirm_order AttributeError: 'purchase.order' object has no attribute 'signal_purchase_cancel' 
```

'purchase_requisition.py' 中的错误代码如下：

```
class purchase_order(osv.osv):
_inherit = "purchase.order"
_columns = {
    'requisition_id' : fields.many2one('purchase.requisition','Purchase Requisition')
}

def wkf_confirm_order(self, cr, uid, ids, context=None ):
    res = super(purchase_order, self).wkf_confirm_order(cr, uid, ids, context=context)
    proc_obj = self.pool.get('procurement.order')
    for po in self.browse(cr, uid, ids, context=context):
        if po.requisition_id and (po.requisition_id.exclusive=='exclusive'):
            for order in po.requisition_id.purchase_ids:
                if order.id != po.id:
                    proc_ids = proc_obj.search(cr, uid, [('purchase_id', '=', order.id)])
                    if proc_ids and po.state=='confirmed':
                        proc_obj.write(cr, uid, proc_ids, {'purchase_id': po.id})
                    self.signal_purchase_cancel(cr, uid, [order.id])
                po.requisition_id.tender_done(context=context)
    return res 
purchase_order() 
```

我没有开发这个模块，那么这个错误的原因可能是什么？

任何帮助将不胜感激，在此先感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T05:32:21.960

我认为你没有最新的代码。

在我的本地代码是这样的：

```
class purchase_order(osv.osv):
    _inherit = "purchase.order"
    _columns = {
        'requisition_id' : fields.many2one('purchase.requisition','Purchase Requisition')
    }
    def wkf_confirm_order(self, cr, uid, ids, context=None):
        res = super(purchase_order, self).wkf_confirm_order(cr, uid, ids, context=context)
        proc_obj = self.pool.get('procurement.order')
        for po in self.browse(cr, uid, ids, context=context):
            if po.requisition_id and (po.requisition_id.exclusive=='exclusive'):
                for order in po.requisition_id.purchase_ids:
                    if order.id<>po.id:
                        proc_ids = proc_obj.search(cr, uid, [('purchase_id', '=', order.id)])
                        if proc_ids and po.state=='confirmed':
                            proc_obj.write(cr, uid, proc_ids, {'purchase_id': po.id})
                        wf_service = netsvc.LocalService("workflow")
                        wf_service.trg_validate(uid, 'purchase.order', order.id, 'purchase_cancel', cr)
                    po.requisition_id.tender_done(context=context)
        return res 
```

# c# - 在由 KNN 计算的图像中绘制匹配对以及 Features2DToolbox.DrawMatches 中的潜在错误

> ID：15823994
> 
> 赞同：7
> 
> 时间：2013-04-05T00:27:08.327
> 
> 标签：c#, opencv, emgucv

我写了一个代码，它通过 KNN 算法找到 K 个最接近的匹配项。获得 matMatch 和 matchIndices 后，我尝试在两个结果帧之间绘制匹配对。

我将**matMask**和**matchIndices**输入到函数**Features2DToolbox.DrawMatches**中：

```
Image<Bgr, byte> imResult = Features2DToolbox.DrawMatches(imModelCurr, imModel.keyPoints, imObserPrev,imObser.keyPoints, **matchIndices**, new Bgr(System.Drawing.Color.Yellow), new Bgr(System.Drawing.Color.Red), **matMask**, Features2DToolbox.KeypointDrawType.NOT_DRAW_SINGLE_POINTS); 
```

[http://www.emgu.com/wiki/files/2.4.0/document/html/e92d37e6-fe4a-ad09-9304-cd2d2533bfa8.htm](http://www.emgu.com/wiki/files/2.4.0/document/html/e92d37e6-fe4a-ad09-9304-cd2d2533bfa8.htm)但我注意到它给了我匹配对之间错误的绘图：

![在此处输入图像描述](https://i.stack.imgur.com/NvTN6.png)

然后我尝试自己实现这样的功能：

```
 for (int i = 0; i < matMask.Rows; ++i)
        {
            if (**matMask[i, 0]** > 0) 
            {
                int indForCurrFrm = **matchIndices[i, 0]**;
                int indForPrevFrm = i;

                //for frame i-1
                PointF fromFirstFrame = getImgObserved(keyPoints[indForPrevFrm]);

                //for frame i
                PointF NextCorrespondingMatchedFrame = getImModelXY(keyPoints[indForCurrFrm]);

                imColorPrv2.Draw(new CircleF(fromFirstFrame, 5), new Bgr(mtchColor), 3);// for frame i-1
                imColorShow.Draw(new CircleF(NextCorrespondingMatchedFrame, 5), new Bgr(mtchColor), 3); // for frame i

                 // draw line on my own matching
              imResult.Draw(new LineSegment2DF(fromFirstFrame,NextCorrespondingMatchedFrame),new Bgr(System.Drawing.Color.FloralWhite),1);

            }
        } 
```

并获取相应的对点坐标（X，Y）并自己绘制[查看快照中的结果]。

在左下角，您可以看到匹配项（以白线显示），每个对应的对都有一个相同颜色的圆圈[由我自己的函数]，而在另一侧的右下角，它是 Emgu 的 DrawMatches 函数绘制的结果.注意这两个函数使用相同的matMash和matchIndices。

所以我想知道 EMGU 的 DrawMatches 是否有错误或者我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T15:00:22.017

使用每个对应对的描述符之间的欧几里德距离从**matchIndices**过滤最佳匹配可能非常有用。有时，第一张图像中的一个关键点可以很好地匹配第二张图像中的许多关键点，这可能会混淆结果中的绘制线。

过滤可能是这样的：

```
vector< DMatch > filtered_matches;

 for( int i = 0; i < descriptors_of_model.rows; i++ )
    { 
      if( matchIndices[i].distance < SMALL_THRESHOLD )
          filtered_matches.push_back( matchIndices[i]); 

     } 
```

# jquery - 将多个参数传递给函数

> ID：15823997
> 
> 赞同：0
> 
> 时间：2013-04-05T00:27:26.577
> 
> 标签：jquery

如何在函数中传递两个参数？

我试过的：

```
function loadweek(loader,button){
  var button_2 = button + "_2";
  alert(button_2);
  alert(button);
  alert(loader);
}

$("#load_week").click(function () {
        loadweek("#load_weekme","#load_week");
}); 
```

`alert(loader);`正在工作，但按钮是“未定义”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:31:48.740

未定义，`button`因为您的文档中不存在带有`id`of的元素`load_week_2`。仔细检查您的代码。

您传递参数的方式实际上是正确的，从`loader`参数的成功可以看出。

**更新：**

工作小提琴：

[http://jsfiddle.net/SY5Jz/1/](http://jsfiddle.net/SY5Jz/1/)