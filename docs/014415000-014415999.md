# StackOverflow 问答 14415000-14415999

# javascript - 从javascript中的对象数组中提取两个数组的最快方法

> ID：14415000
> 
> 赞同：0
> 
> 时间：2013-01-19T13:48:03.440
> 
> 标签：javascript, mongodb, mongoose

可以说我有这样的架构：

```
users: {
   friends: [{name: String, id: String}]
} 
```

将此对象数组提取到两个单独的数组中的最快方法是什么：

```
var names = [String]
var ids = [String] 
```

有没有办法在没有 for 循环的情况下做到这一点？需要为一组用户完成此操作，并且我试图避免嵌套 for 循环。也许有更好的方法来存储朋友的姓名和 ID？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T13:51:28.847

使用`Array.map()`：

```
var names = users.friends.map(function(o) { return o.name; }),
    ids   = users.friends.map(function(o) { return o.id;   }); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T15:35:21.943

总有一个循环，某处（我不确定你所说的嵌套循环是什么意思？）。:)

如果您正在寻找最快（这就是您所说的），那么使用 a`map`或 a`forEach`通常不会导致更快的操作，因为每次迭代都调用一个函数，这会增加开销。

正如您将在此[jsPerf](http://jsperf.com/map-vs-not)中看到的，通常最好使用 for-loop 构造。首先，如果数组很长，您将受益于只遍历数组一次（而不是每个属性一次）。为了进一步优化，预先声明数组大小也可以提高性能。

```
var names = new Array(totalFriends),
    ids = new Array(totalFriends), friend;

for (var j = 0; j < totalFriends; j++) {
  friend = friends[j];
  names[j] = friend.name;
  ids[j] = friend.id;
} 
```

地图调用很方便，但可能不是最快的。

# php - 在 Windows Server 2008 x64 上安装 php memcache

> ID：14415002
> 
> 赞同：2
> 
> 时间：2013-01-19T13:48:24.157
> 
> 标签：php, windows, memcached, 64-bit, xampp

我在 Win Server 2008 R2 x64 上运行 XAMPP 1.8.1，我的 PHP 版本是 5.4.7。

我已经按照[这个](http://www.leonardaustin.com/technical/how-to-install-memcached-on-xampp-on-windows-7)安装，从这里下载了 php_memcache-3.0.7-5.4-ts-vc9-x86.zip 并从[这里](https://stackoverflow.com/questions/8896/memcached-on-windows-x64/9806441#9806441)[替换](http://windows.php.net/downloads/pecl/releases/memcache/3.0.7/)了 memcached 服务文件。

服务升级了，php.ini中的扩展也加了，但是phpinfo()中还是看不到mod启用了。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T12:31:11.897

首先检查 memchaced 服务是否正在运行

`telnet 127.0.0.1 11222`（如果没有，请安装 telnet 客户端）

如果失败，则意味着您的 memchaced 构建未运行。

* * *

[对于 windows 考虑使用 memchaced bucket](http://www.couchbase.com/docs/couchbase-manual-1.8/couchbase-architecture-buckets.html)移动到couchbase 。恕我直言，这是已知的最佳实现。

# ruby - ruby 中的快速字符串拆分和连接

> ID：14415003
> 
> 赞同：0
> 
> 时间：2013-01-19T13:48:31.687
> 
> 标签：ruby, string, optimization, split, concatenation

我有一个很长的字符串，其中包含 DNA 序列数据，通常大约 500k 到 5m 个字符长。我想从头开始剪切前 n 个字符并将它们添加到该字符串的末尾。

我需要运行该方法大约。2000 个 DNA 序列——这就是我担心速度的原因。我不想整周都在阻塞我的电脑。

在 ruby​​ 中最有效的方法是什么？

一个附带问题是内存效率。因为我只需要每个序列运行一次这个任务，这对我来说并不重要，但通常快速并不意味着更少的内存，对吧？我的电脑有 2 个可用的 RAM（希望它足够了）。

如果你有兴趣为什么我需要这样做：

我想这样做的原因是，我的源材料是针对 DNA 中的特定点进行分析的。这一点需要位于 DNA 中间的某个位置，以便在以后的分析中更加方便。如果该点接近结尾或开头，我需要拆分并连接 DNA 序列字符串。序列是圆形的，该点是细菌基因组中 dnaA 的顶部 BLAST 命中（来自 NCBI 数据库）。由于大多数注释倾向于使用 dnaA 基因的位置作为开始，如果您想使用该基因周围的区域，这将非常烦人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:05:00.817

听起来不错！

您可以运行[rubinius](http://rubini.us)基准测试，看看哪种方法最有效：[https ://github.com/rubinius/rubinius/tree/master/benchmark/core/string](https://github.com/rubinius/rubinius/tree/master/benchmark/core/string)

您不必为此安装 rubinius，但它会为您提供多线程 ruby​​，就像 jruby 一样，如果您的计算机上有多个内核，它可能会更快。

要了解如何运行基准测试，请在此处查看：[http ://rubini.us/doc/en/how-to/write-benchmarks/](http://rubini.us/doc/en/how-to/write-benchmarks/)

# python - Django - 在自定义模型函数中访问相关模型

> ID：14415004
> 
> 赞同：2
> 
> 时间：2013-01-19T13:48:32.677
> 
> 标签：python, django, django-models

我有两个模型：

```
class ModelA(models.Model):
    b = models.ManyToManyField(ModelB, related_name = 'abs')

class ModelB(models.Model):
    x = models.IntegerField()

    def foo(self):
        self.abs.all() ... 
```

我想在 ModelB 的 foo 方法中访问多对多关系中的所有 ModelA - 我已经使用上面的方法进行了尝试，但它说“abs”不是 ModelB 的字段。我怎样才能解决这个问题？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:26:16.670

您缺少方法中的`return`声明`foo`。请更改`self.abs.all()`为`return self.abs.all()`。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-19T17:03:43.250

您所需要的只是：

```
class ModelA(models.Model):
    class Meta:
       app_label = 'app'
    b = models.ManyToManyField(ModelB, related_name='abs')

class ModelB(models.Model):
    class Meta:
       app_label = 'app'
    x = models.IntegerField()

    def foo(self):
       return self.abs.all() 
```

我检查了这个及其工作。

# javascript - iPad 3 上的慢 .toggleSLide()

> ID：14415007
> 
> 赞同：2
> 
> 时间：2013-01-19T13:48:59.900
> 
> 标签：javascript, jquery, css, ipad, twitter-bootstrap

我使用[引导程序](http://twitter.github.com/bootstrap/)构建了一个站点，但后来我注意到当它在 ipad 上进入纵向模式（在我的情况下为 3）时，菜单滑动变得非常非常慢。如果您在ipad3（纵向模式，不确定其他 ipad）上[查看他们的网站，您会看到子菜单显示的速度和波动性。](http://twitter.github.com/bootstrap/)iphone上没问题（我有iphone 4s）

所以我想用一个非常简单的`.toggleSLide()`东西来构建我自己的东西。我什至想使用`.show()`，`.hide()`但即使在那种情况下，动作也很慢。

最终我使用了 css 动画，稍微解决了这个问题：

```
 $(".btn-navbar").click(function(){
            $(".nav-collapse .nav").toggleClass('show');
        }); 
```

和CSS

```
.nav {
   height: 0;
}

.show{
   -webkit-transition: height 0.2s linear; 
    height:300px; 
    overflow:hidden; 
   -webkit-transform: translateZ(0);
} 
```

但是在什么平板电脑/手机上支持 CSS 动画？

我认为这个问题与何时显示的`.children()`元素有关。`.nav`

基本上让我们获取[引导站点](http://twitter.github.com/bootstrap/)并在 ipad3 potrait 模式下查看它，我们如何才能在单击时获得平滑的子菜单显示/隐藏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-22T15:03:22.830

呸！我最终使用了这个插件：

[https://github.com/ftlabs/fastclick](https://github.com/ftlabs/fastclick)

但上述问题依然存在。

# jquery - 滑块 UI：从 20:00 开始到 07:00 结束？

> ID：14415008
> 
> 赞同：1
> 
> 时间：2013-01-19T13:49:02.233
> 
> 标签：jquery, jquery-ui

我正在尝试使用滑块选择场地关闭时间。从教程中，我已经能够[组合一个简单的滑块](http://jsfiddle.net/TRABs/2/)，但是我想做的是创建一个从 20:00 到 07:00 的范围，这意味着一旦它通过 23:59 标记，它就会回到 00： 00.

这就是我到目前为止所拥有的。

```
$( "#open-till" ).slider({
range: "min",
value: 1230,
min: 0,
max: 1439,
step: 30,
slide: slideTime
});

function slideTime(event, ui){
    var val0 = $("#open-till").slider( "value" ),
        minutes0 = parseInt(val0 % 60, 10),
        hours0 = parseInt(val0 / 60 % 24, 10),
    startTime = getTime(hours0, minutes0);
    $("#time").text(startTime);
}
function getTime(hours, minutes) {
    minutes = minutes + "";
    return hours + ":" + minutes;
}
slideTime(); 
```

[在这里看我的小提琴](http://jsfiddle.net/TRABs/2/)

感谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T13:54:55.537

用模数显示小时`%24`

同时更改滑块`min`的`max`值。要从滑块获取实际时间（如果您想将其发送到服务器）`value%1440`，我认为 7:00 以`1890`分钟为单位 (24 +7)

[http://jsfiddle.net/TRABs/8/](http://jsfiddle.net/TRABs/8/)

# events - JSF ajax 行为监听器

> ID：14415009
> 
> 赞同：1
> 
> 时间：2013-01-19T13:49:02.750
> 
> 标签：events, jsf-2

我在使用 selectOneRadio 和面板的渲染器时遇到了问题。

我的 cession.xhtml 包含这个

```
 <p:selectOneRadio id="options" value="#{editionBean.radioProprietaire}">
      <f:selectItem itemLabel="Particulier" itemValue="particulier" />
      <f:selectItem itemLabel="Societe" itemValue="societe" />
      <f:ajax listener="#{editionBean.listener}"/>
    </p:selectOneRadio>

    <h:panelGroup rendered="#{editionBean.renderSoc}">...</h:panelGroup>
    <h:panelGroup rendered="#{editionBean.renderPart}">...</h:panelGroup> 
```

我的 EditionBean.class

```
private boolean renderSoc;
private boolean renderPart;
private String radioProprietaire;

public void listener(AjaxBehaviorEvent event) {
  if(null != radioProprietaire && radioProprietaire.equals("particulier")){
           renderPart = true;
       renderSoc = false;
      }
  else if(null != radioProprietaire && radioProprietaire.equals("societe")){
    renderPart = false;
    renderSoc = true;
      }
  } 
```

我知道调用了方法侦听器，但是如果有人可以帮助我，这些面板不可见？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T14:40:52.100

有2个问题。

1.  您需要`<p:ajax>`而不是`<f:ajax>`PrimeFaces 组件。

2.  您需要在 ajax 更新中明确指定一个 JSF 组件，以便重新渲染它。使用当前的方法，您基本上不会更新任何内容。With `<f:ajax>`，需要更新的组件应该在attribute`render`和within属性中指定。`<p:ajax>``update`

此外，还有一些效率低下的情况。您根本不需要侦听器方法和那些大量的布尔属性。您可以直接在`rendered`属性中检查单选按钮的值。

所以，总而言之，这应该做：

```
<p:selectOneRadio id="options" value="#{editionBean.radioProprietaire}">
    <f:selectItem itemLabel="Particulier" itemValue="particulier" />
    <f:selectItem itemLabel="Societe" itemValue="societe" />
    <p:ajax update="groups" />
</p:selectOneRadio>

<h:panelGroup id="groups">
    <h:panelGroup rendered="#{editionBean.radioProprietaire == 'societe'}">
        ...
    </h:panelGroup>
    <h:panelGroup rendered="#{editionBean.radioProprietaire == 'particulier'}">
        ...
    </h:panelGroup>
</h:panelGroup> 
```

### 也可以看看：

*   [当我想对它进行 ajax 更新时，为什么需要在另一个组件中嵌套一个带有 render="#{some}" 的组件？](https://stackoverflow.com/questions/9010734/why-do-i-need-to-nest-a-component-with-rendered-some-in-another-component-w/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T13:58:41.860

正如[这个答案](https://stackoverflow.com/a/14415040/1065197)`<h:panelGroup>`中所解释的，您应该将组件包装在一个`UIContainer`更大的容器中并渲染那个更大的容器，以使面板*变得可见*：

```
<p:selectOneRadio id="options" value="#{editionBean.radioProprietaire}">
  <f:selectItem itemLabel="Particulier" itemValue="particulier" />
  <f:selectItem itemLabel="Societe" itemValue="societe" />
  <p:ajax listener="#{editionBean.listener}" render="pnlSoc pnlPart" />
</p:selectOneRadio>

<h:panelGrid id="pnlSoc">
    <h:panelGroup rendered="#{editionBean.renderSoc}">...</h:panelGroup>
</h:panelGrid>
<h:panelGrid id="pnlPart">
    <h:panelGroup rendered="#{editionBean.renderPart}">...</h:panelGroup>
</h:panelGrid> 
```

# asp.net - 网站的简单分析

> ID：14415010
> 
> 赞同：0
> 
> 时间：2013-01-19T13:49:11.413
> 
> 标签：asp.net, analytics

我有一个网站，其中包含几个用于申请某些产品的 Aspx 页面。访问者从 Selection.aspx 开始，访问与他选择的产品一样多的页面，然后以摘要页面结束。

我想知道有多少访问者访问了第一页，有多少访问者到达了最后一页，有多少访问者没有到达最后一页就离开了网站（以及他们离开了哪个页面）。

我正在考虑创建一个简单的数据库表来存储访问者的 IP 和他正在访问的页面。填充此表的方法将在每个 Aspx 页面的 Page_Load 处调用。还有比这更好的方法吗？

在我的研究过程中，我阅读了有关 Google Analytics 和其他分析工具的信息，例如[http://piwik.org/](http://piwik.org/)。这些分析引擎会帮助我满足我的要求，还是我应该使用本土方法？如果是，您推荐哪种分析工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:11:43.740

进一步 PassKit 的回答值得扩展转换渠道。这些转化渠道将使您能够查看渠道转化率并确定访问者在哪个阶段退出渠道。

一个示例漏斗可能如下所示：

1.  登陆页面
2.  产品页面
3.  注册页面
4.  支付页面
5.  转化页面

使用这个漏斗，我们可以看到有多少人到达了转化页面，还可以看到访问者在哪里退出了这个漏斗。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T14:04:50.567

作为这两种工具的用户，只需几分钟的设置，它们中的任何一种都可以满足您的需求。

Piwik 的优势在于您拥有数据，而且它是开源的。这意味着您可以根据需要对其进行自定义，从而使您能够获得有关您的站点活动的非常量身定制的报告。也就是说，Piwik 是 PHP，所以如果你有 ASP 背景，这可能不是一个优势。

Piwik 的缺点是您需要托管它并管理数据库（除非您使用像 Amazon RDS 这样的托管 mysql 解决方案）。您还需要一个 geoip 数据库，因为没有一个，Piwik 使用用户代理 Accept-Language 来推断位置。免费的 MaxMind 数据库还可以，但不如 Google 的准确或完整。

使用 Google，报告简单直观，实时分析可以让您深入了解您的网站在单个时间点的使用情况。

Google API 足以提取您的数据以在其他地方使用，它可以连接到其他 Google 服务，如网站管理员工具、网站优化器和 Google Adwords。缺点是 Google 拥有*并*使用您的分析数据。

Google Analytics 和 Piwik 都允许您设置目标，例如用户访问页面 A，然后访问页面 B 等。它们还具有以图形方式显示流量和下降的工具，这很可能满足您查看用户距离的要求进入你的过程。

除非您对自己的分析代码有二次使用，否则您最好选择其中任何一个并将时间和资源集中在项目的其余部分上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T14:11:08.447

Google Analytics（分析）是在您的网站上实施分析的最简单工具，并提供体面的报告等。您只需注册，将他们提供的代码片段放在您的页面中，几天后您就可以取回基本数据。根据您的需要，您可以创建一个“目标”来跟踪有多少访问者浏览了一系列页面等的百分比。设置起来相当容易。

但是，您最好调查您的托管服务提供商或查看您的网络服务器日志（如果您自己托管）。有许多工具可以分析这些日志，它们比 Google Analytics 提供的要详细得多。我使用的托管服务提供商提供 SmarterStats，它提供了非常易于阅读的报告和有关访问者的出色数据。每个访客的数据都非常详细。

祝你好运！

# android - 如何使用 Intent 在滑动视图中显示薮活动？

> ID：14415011
> 
> 赞同：1
> 
> 时间：2013-01-19T13:49:37.793
> 
> 标签：android, android-intent, android-activity, android-fragmentactivity, swipeview

我试图让薮猫活动进入一个滑动视图。

我试过这个教程：[在 Android 中使用 ViewPager 和 FragmentPagerAdapter 实现水平视图](http://wptrafficanalyzer.in/blog/implementing-horizontal-view-swiping-using-viewpager-and-fragmentpageradapter-in-android/) 滑动

如何使用 Intent 让活动显示在一个部分中，而不是显示该 textView（如教程中所示）？（或任何其他方式）。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:59:29.643

在第 8 步和第 9 步中，您需要做的是在 MyFragmentPagerAdapter 的 getItem() 方法中返回您不同的 MyFragment 1.2.3 等（从您的活动转换而来）：

```
/** This method will be invoked when a page is requested to create */
@Override
public Fragment getItem(int arg0) {

    //MyFragment myFragment = new MyFragment();
    //Bundle data = new Bundle();
    //data.putInt("current_page", arg0+1);
    //myFragment.setArguments(data);
    //return myFragment;

//a switch returning different types Fragments
switch(position) {
    case 0:
        //Previous Activity 1, "converted to a Fragment":)
        return (mMyFragment1 = new MyFragment1());
    case 1:
        //Previous Activity 2, "converted to a Fragment":)
        return (mMyFragment2 = new MyFragment2());
    }
} 
```

注意：有一种更快的方法来实现该教程中的代码：确保您从 Android SDK 管理器中安装了最新的 SDK 工具和平台工具。在您尝试的教程的第 4 步中，“输入 MainActivity 详细信息”选择导航类型：滑动视图 + 标题条，一切顺利。

带有注释的示例片段

```
public class MyFragment extends Fragment {
//Empty Constructor
public MyFragment () {
}   
//Return a new instance with FragmentArguments
public static MyFragment newInstance(Bundle args) {
MyFragment fragment = new MyFragment();
fragment.setArguments(args);
return fragment;
}

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
//Fragments Inflate the content view here, 
//Activities use: setContentView(R.layout.activity_main);
return inflater.inflate(R.layout.main_activity, container, false);
}

@Override
public void onViewCreated(View view, Bundle savedInstanceState) {
super.onViewCreated(view, savedInstanceState);

 //Fragments initialize views here (or you could do it in the onCreateView() method), 
 //Activities do it in the OnCreate() method
TextView textview = (TextView) view.findViewById(R.id.textView);
textview.setText(
         "Implement all your old Activity methods here, " +
         "but remember to use getActivity() instead of THIS. !!!" +
         "A Fragment is a child of the parent Activity" +
         "--One Activity to rule them all--"     
         );

////let the argument decide what you want to do. here it is the position in the FragmentPagerAdapter
//   final int position;
//   if (getArguments() != null) {
//          position = getArguments().getInt(MyConfig.ADAPTER_POSITION_KEY);
//   } 
    }//END onViewCreated()

//      //Let the Activity implement a callback interface to communicate back. 
//      public interface Callbacks {
//          public void onCallback(int adId);
//      }
//      private static Callbacks sDummyCallbacks = new Callbacks() {
//          @Override
//          public void onCallback(int adId) {
//          }
//      };
//      private Callbacks mCallbacks = sDummyCallbacks;
//      @Override
//      public void onAttach(Activity activity) {
//          super.onAttach(activity);
//          if (!(activity instanceof Callbacks)) {
//              throw new ClassCastException(
//                      "Activity must implement fragment's callbacks.");
//          }
//          mCallbacks = (Callbacks) activity;
//      }
    //
//      @Override
//      public void onDetach() {
//          super.onDetach();
//          mCallbacks = sDummyCallbacks;
//      }    

} 
```

# javascript - 如何从mac上网页中的链接启动应用程序

> ID：14415012
> 
> 赞同：6
> 
> 时间：2013-01-19T13:49:56.933
> 
> 标签：javascript, html, macos, webpage

我试图在网页中单击链接时打开应用程序。可以说，如果我单击显示 iTunes 的链接，它将打开 iTunes。我不确定这是否相似，但如果您转到在网络浏​​览器中打开的 iTunes 专辑链接，它将打开 iTunes 到该页面。请记住，这是针对 mac 的。此外，我尝试过的其他教程也不起作用。其他教程使用了 JavaScript，所以我猜我也需要使用它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:48:25.693

您**不仅**可以打开应用程序。例如，您可以告诉注册协议的应用程序执行操作。`itmss://`您可以告诉 iTunes 使用该协议打开专辑。Instant messenger 可能已经注册了 eg或类似的`aim://`，`skype://`以便您可以直接打开聊天窗口。您可以创建一个链接 `mailto:test@test.com`来告诉默认邮件应用程序使用此地址开始新邮件。但默认情况下不能直接启动应用程序。

如果您可以控制打开网页的系统，例如内部启动服务或类似的东西。您可以考虑为启动应用程序创建一个协议默认处理程序。

# php - Symfony 编辑会话对象

> ID：14415013
> 
> 赞同：1
> 
> 时间：2013-01-19T13:50:26.243
> 
> 标签：php, forms, session, post, symfony

使用 Symfony 2 我构建了一个页面，登录用户可以在其中更新详细信息。为此，在 profileAction 下的控制器中，我使用 dotorine 通过从会话中获取用户 ID 来获取用户。

```
 $user = $this->getUser();
 $entity = $em->getRepository('GibboCodeKeeperBundle:User')->find($user->getId()); 
```

然后我将 $entity 对象绑定到一个表单，但是当提交表单时，现在在绑定的 $entity 对象中更新的所有内容也会在会话中的 $user 对象中更改。反之亦然，如果我刷新 $user 对象，$entity 也会被刷新：S。

我想让 $entity 代表从表单内部返回的内容，并让 $user 代表在尝试持久化之前数据库中当前的内容，这样我就可以看到用户更新了什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:53:11.020

你可以试试这个：

```
$user = $this->getUser();
$entity = $em->getRepository('GibboCodeKeeperBundle:User')->find($user->getId());

$form = $this->createForm($formType, $entity);
$form->bind($request);

if ($form->isValid()) {
    // here is your updated user
    $entity = $form->getData();

    // this will not update uses session
    $em->refresh($user);
} 
```

或者你可以克隆实体

```
$oldEntity = clone $entity; 
```

# c++ - 提升日期不可变 - 那么如何在循环中使用它？

> ID：14415014
> 
> 赞同：1
> 
> 时间：2013-01-19T13:50:31.280
> 
> 标签：c++, datetime, boost

boost pdate 是不可变的，那么如何在循环中使用它呢？我需要与最后处理日期进行比较：

```
 date last(neg_infin);
    for (int i = 0; i < tasks.size(); i++) {
            if (tasks[i]->getTime().date() > last) {
                cout << ":::" << tasks[i]->getTime().date() << ":::" << endl;
            }
            cout << "[" << i << "]" << '\t';
            tasks[i]->print();
            // i need to change the last date here
            cout << endl;
        } 
```

IE。如果当前时间的日期部分晚于前一个，则打印日期，否则只打印时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:00:14.697

好吧，既然您已经在处理索引`tasks`，请改为存储“最后一个”索引，而不是日期。

```
int lastIndex = 0;
for (int i = 1; i < tasks.size(); i++) {
        if (tasks[i]->getTime().date() > tasks[lastIndex]->getTime.date()) {
            cout << ":::" << tasks[i]->getTime().date() << ":::" << endl;

        }
        cout << "[" << i << "]" << '\t';
        tasks[i]->print();

        lastIndex = i;

        cout << endl;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:02:21.547

为什么需要明确的最后一个元素？这也行吗？

```
if (i == 0 || tasks[i]->getTime().date() > tasks[i-1]->getTime.date()) { 
```

# ruby-on-rails - routes.rb 中的成员

> ID：14415016
> 
> 赞同：2
> 
> 时间：2013-01-19T13:51:05.513
> 
> 标签：ruby-on-rails, ruby-on-rails-3

给定代码（在 routes.rb 中）：

```
 resources :products do
    member do
      get :delete #this works
      delete delete: "products#destroy" #this doesn't work
      delete "delete" => "products#destroy" #but this works
    end
  end 
```

为什么线路`delete delete: "products#destroy"`不工作而线路`delete "delete" => "products#destroy"`工作？

Rails 版本 3.2.11

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:02:30.500

如果您想将删除操作映射到销毁，您应该使用`match`

```
match 'products/:id/delete', controller: :products, action: :destroy, via: :delete 
```

但我没有理由这样做。在我看来，您应该坚持使用 rails 默认的销毁操作。

而且它不起作用，因为在资源中您已经指定了控制器，并且它用于使用适当的 http 协议添加操作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T15:51:49.597

这不起作用以及如果您遵循错误回溯的原因是因为`mapper.rb`Rails 中的以下行。

```
def match(path, *rest)
  if rest.empty? && Hash === path
    options  = path
    path, to = options.find { |name, value| name.is_a?(String) }
    options[:to] = to
    options.delete(path)
    paths = [path]
  else
    options = rest.pop || {}
     paths = [path] + rest
  end

  options[:anchor] = true unless options.key?(:anchor)

  if options[:on] && !VALID_ON_OPTIONS.include?(options[:on])
    raise ArgumentError, "Unknown scope #{on.inspect} given to :on"
  end
  paths.each { |_path| decomposed_match(_path, options.dup) }
  self
end 
```

这由幕后的所有方法调用（例如`delete`, `post`, `get`, `put`）。我们特别寻找的那一行是这样的：

```
path, to = options.find { |name, value| name.is_a?(String) } 
```

不知道他们为什么要检查 String 但因为名称是符号而不是 a`String`而是 a `Symbol`。这几乎将该路径作为 nil 值发送，`decomposed_match`从而导致您无法在路线中使用符号的原因。

**笔记**

```
resources :products do
  member do
    get :delete #this works
    delete delete: "products#destroy" #this doesn't work
    delete "delete" => "products#destroy" #but this works
  end
end 
```

之所以起作用，是因为调用方法`get :delete`之前的那一行。`match`

具体下这个方法

```
def map_method(method, *args, &block)
  options = args.extract_options!
  options[:via] = method
  args.push(options)
  match(*args, &block)
  self
end 
```

该行`args.extract_options!`从数组中删除了一个散列。您可以在文件下找到它，`extract_options.rb`它是类的添加方法`Array`。

无论如何，因为`get :delete`不是散列而是单个参数，所以它被映射到这样的东西

```
Path: [delete]
Options [{via: "get"}] 
```

现在，其他的像这样被映射，例如`delete delete: "product#destroy"`

```
Path {:delete=>"collaborators#destroy", via: "delete"}
Options [] 
```

然后回到我最初关于为什么符号在路线中不起作用的陈述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T14:10:38.787

仅 Ruby 1.9 版支持新的哈希语法。您使用的是哪个版本的 Ruby？

# javascript - SVG - getElementsByClassName

> ID：14415024
> 
> 赞同：3
> 
> 时间：2013-01-19T13:51:43.013
> 
> 标签：javascript, class, function, svg, attributes

```
 <script type="text/ecmascript">
  <![CDATA[
  function setCoordinates(circle) {
  var centerX = Math.round(Math.random() * 1000);
  var centerY = Math.round(Math.random() * 1000);      
  circle.setAttribute("cx",centerX);
  circle.setAttribute("cy",centerY);
  }
  ]]>
  </script>

  <circle class="circles" cx="500" cy="500" r="25" fill="white" filter="url(#f1)" />
  <circle class="circles" cx="500" cy="500" r="25" fill="white" filter="url(#f1)" />
  <circle class="circles" cx="500" cy="500" r="25" fill="white" filter="url(#f1)" />
  <circle class="circles" cx="500" cy="500" r="25" fill="white" filter="url(#f1)" />
  <circle class="circles" cx="500" cy="500" r="25" fill="white" filter="url(#f1)" />

  <script type="text/ecmascript">
  <![CDATA[
  setCoordinates(document.getElementsByClassName("circles"));
  ]]>
  </script> 
```

这根本没有效果。但是，当我使用“getElementByID”并为圆圈分配一个 ID 时，它工作正常。（歌剧）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T13:53:25.707

`document.getElement**s**ByClassName`返回元素的集合，因此您需要遍历结果：

```
var elements = document.getElementsByClassName('circles');

for (var i = 0; i < elements.length; i++) {
    var element = elements[i];

    setCoordinates(element);
} 
```

如果您的代码不能正常工作，请检查您的 JS 控制台。您应该会看到类似`Object has no method 'setAttribute'`.

# php - WordPress 过滤器 - 在一篇文章中向多个画廊添加单独的 rel

> ID：14415025
> 
> 赞同：1
> 
> 时间：2013-01-19T13:51:43.997
> 
> 标签：php, regex, wordpress, fancybox, gallery

我有一个 WordPress 帖子/页面，我想在其中包含多个画廊。我正在使用[这个 WordPress 插件](http://konstruktors.com/projects/wordpress-plugins/multiple-galleries/)来管理多个画廊（它基本上包括每个画廊简码实例中选择的图像 ID）。这将为单独的画廊生成以下具有不同 ID 的 html：

```
<div id="gallery-1">
   <dl class="gallery-item">
    <dt class="gallery-icon">
     <a href="big-image.jpg"><img src="small-img.jpg" /></a>
    </dt>
   </dl>
   <dl> ...another image... </dl>
</div>
<div id="gallery-2">
   <dl class="gallery-item">
    <dt class="gallery-icon">
     <a href="big-image.jpg"><img src="small-img.jpg" /></a>
    </dt>
   </dl>
   <dl> ...another image... </dl>
</div>
...and so on 
```

此外，我有一个过滤器，它为`rel`链接到图像的每个锚点添加一个属性：

```
function slicetheme_attachment_filter($attachment_link)
{   
    global $post;
    $pattern = "/<a(.*?)href=('|\")([^>]*).(bmp|gif|jpeg|jpg|png)('|\")(.*?)>(.*?)<\/a>/i";
    $replacement = '<a$1rel="fancybox[%LIGHTID%]" href=$2$3.$4$5  $6>$7</a>';
    $attachment_link= preg_replace($pattern, $replacement, $attachment_link);
    $attachment_link = str_replace("%LIGHTID%", $post->ID, $attachment_link);
    return $attachment_link;
}
add_filter('wp_get_attachment_link', 'slicetheme_attachment_filter'); 
```

我对其进行了修改，以便通过添加`rel`带有帖子 ID 的每个帖子/页面来获取画廊。因此，对于我的帖子，`ID=553`我有：

```
<a rel="fancybox[553]" href="big-image.jpg"><img src="small-img.jpg" /></a> 
```

但这不是我想要的。我希望每个画廊对其锚点具有不同的 rel 属性。就像是：

```
<div id="gallery-1">
     <dl class="gallery-item">
      <dt class="gallery-icon">
       <a rel="fancybox-gallery-1" href="big-image.jpg"><img src="small-img.jpg" /></a>
      </dt>
     </dl>
     <dl> ...another image... </dl>
 </div>
 <div id="gallery-2">
     <dl class="gallery-item">
      <dt class="gallery-icon">
       <a rel="fancybox-gallery-2" href="big-image.jpg"><img src="small-img.jpg" /></a>
      </dt>
     </dl>
     <dl> ...another image... </dl>
 </div> 
```

我试图匹配整个事情，但我想我不擅长它......

```
$pattern = "/<div(.*?)id=('|\")gallery-(.*?)('|\")(.*?)<a(.*?)href=('|\")([^>]*).(bmp|gif|jpeg|jpg|png)('|\")(.*?)>(.*?)<\/a>/i";
$replacement = '<div$1id=$2gallery-$3$4$5<a$6rel="fancybox-gallery-$3" href=$7$8.$9$10  $11>$12</a>'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T19:02:22.407

您可以复制函数`gallery_shortcode()`，然后`apply_filter('gallery_shortcode', 'your_gallery_shortcode_copy')`在您的`your_gallery_shortcode_copy()`函数中添加并替换`wp_get_attachment_link()`为您自己的代码，其中画廊 id 是静态属性`$instance`。

# matrix - 稀疏矩阵抱怨负索引

> ID：14415026
> 
> 赞同：1
> 
> 时间：2013-01-19T13:51:49.600
> 
> 标签：matrix, runtime-error, sparse-matrix

我创建了一个压缩的稀疏矩阵，但是在访问正索引时它抱怨索引为负：

```
import scipy.sparse as sparse
B= sparse.csc_matrix((110111213141516, 25))
B[11011121314,1]=99 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:01:55.003

从我对 scipy 0.10.1 的有限实验来看，`csc_matrix`索引似乎必须适合 C `long`（在我的平台上是 32 位宽）。

如果该评估是正确的，使用 64 位的 Python 版本可能有助于解决这个问题。

# javascript - 在发送请求之前更改图像的 src

> ID：14415027
> 
> 赞同：5
> 
> 时间：2013-01-19T13:51:52.483
> 
> 标签：javascript, jquery, browser, request, onbeforeload

我对这个问题做了很多研究，但没有成功。基本上我想要做的是：
1）用占位符替换所有图像的 src- 属性，例如'blank.gif'
2）使用原始图像位置添加 HTML5 data-original 属性
3）[延迟加载](http://www.appelsiini.net/projects/lazyload)图像（它需要 data-original 属性才能正常工作）

我没有成功的尝试： 1）将此事件侦听 器与此功能
附加`document.addEventListener('beforeload', doBeforeLoad, true);`

```
function beforeload() {
        var blank = 'image/location/images/blank.gif';
        $('img').each(function() {
            var orig = $(this).attr('src');
            $(this).attr('data-original',orig);
            $(this).attr('src',blank);
            console.log("changing all data on images");
        });
    } 
```

2）在document.ready上确定它不会工作..

我不知道***这***是否可能，所以任何帮助| 建议 | 资源将不胜感激
PS：例如，我想让它[在这里](http://christian-fei.com/tutorials/the-zero-budget-website/)工作）（因为它是一篇图像繁重的文章）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T13:55:30.330

在您开始执行 JS 之前，浏览器将开始发出请求。我建议您将源 html 更改`data`为延迟加载图像所需的模式。这需要在浏览器接收到它之前发生。如果它是服务器生成的，这应该不会太麻烦。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T14:04:04.037

听起来您正在寻找相当于添加的事情`img`，但您正在通过修改图像的想法来接近它。如果您使用占位符`span`或类似的东西，那么您可以避免整个问题并且需要考虑的变量更少。使用数据集为您想要的信息创建一个跨度，并可选择`class`附加背景图像以指示图像尚未加载，然后在页面加载时找到适当`span`的 s 插入`img`元素（或替换`span`如果首选)，并进行任何其他清理，例如删除“加载”样式`class`。这可以允许以一种不太可能处于不一致状态的方式来构建您的页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T14:03:24.880

该技术曾在旧浏览器中使用过，但现在现代浏览器不再使用这种方法，所以你必须在服务器端做空白 src 和数据源属性，这里是流行的 jQuery 延迟加载插件主页，[http:// www.appelsiini.net/projects/lazyload](http://www.appelsiini.net/projects/lazyload)你敢打赌他们在写这篇文章之前做了很多研究

> 最新版本的延迟加载并不是您网页的替代品。即使您使用 JavaScript 删除 src 属性，新浏览器也会加载图像。现在你必须改变你的 html 代码。将占位符图像放入 img 标签的 src 属性中。真实图片 u​​rl 应该存储 data-original 属性。

UPD：稍微考虑一下，可能更好的数据属性方法是`noscirpt`对你想要加载的图像使用包装 lazlily 在这里大致说明想法[http://jsbin.com/uqomeb/2/edit](http://jsbin.com/uqomeb/2/edit)我可能会做简单的 jQuery插件稍后基于此

# android - Android - 列表视图 - 开始新活动

> ID：14415028
> 
> 赞同：0
> 
> 时间：2013-01-19T13:51:52.177
> 
> 标签：android, android-listview

我正在尝试构建一个活动，其中列表视图中的每个列表项都会打开一个新活动。但是每次我运行该应用程序时，它都会被迫关闭。请帮助guyzz。我为此努力了很长时间！这是布局文件：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<TextView 
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:text="C++ PROGRAMS" 
    android:textStyle="bold"
    android:textSize="25sp" />
<ListView
  android:id="@android:id/list"
  android:layout_width="match_parent"
  android:layout_height="wrap_content" > 
```

这是java类：

```
public class Second_listview extends ListActivity{
  static final String[] type = new String[]{

    "Array", "Strings" 

 };

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);

    setContentView(R.layout.second_listview);

    // setting up list view

    setListAdapter (new ArrayAdapter<String>(this, android.R.id.list, type));
    ListView list = getListView();
    list.setTextFilterEnabled(true);
    list.setOnItemClickListener(new OnItemClickListener(){

        @Override
        public void onItemClick(AdapterView<?> arg0, View view, int arg2,
                long arg3) {
            // TODO Auto-generated method stub

            //linking each list item to start a new activity

            switch(arg2)

            {
              case 1 : Intent myIntent1 = new Intent(view.getContext(), Array_list.class);
                       startActivityForResult(myIntent1, 0);
                       break;
              case 2 : Intent myIntent2 = new Intent(view.getContext(), String_list.class);
                       startActivityForResult(myIntent2, 0);
                       break;

            }

        }

    });
}

} 
```

这是日志猫：

```
01-19 13:26:03.123: E/AndroidRuntime(1323): FATAL EXCEPTION: Thread-132
01-19 13:26:03.123: E/AndroidRuntime(1323): android.content.ActivityNotFoundException: No Activity found to handle Intent { act=com.example.c_progams.CLEARSCREEN }
01-19 13:26:03.123: E/AndroidRuntime(1323):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1622)
01-19 13:26:03.123: E/AndroidRuntime(1323):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1417)
01-19 13:26:03.123: E/AndroidRuntime(1323):     at android.app.Activity.startActivityForResult(Activity.java:3370)
01-19 13:26:03.123: E/AndroidRuntime(1323):     at android.app.Activity.startActivityForResult(Activity.java:3331)
01-19 13:26:03.123: E/AndroidRuntime(1323):     at android.app.Activity.startActivity(Activity.java:3566)
01-19 13:26:03.123: E/AndroidRuntime(1323):     at android.app.Activity.startActivity(Activity.java:3534)
01-19 13:26:03.123: E/AndroidRuntime(1323):     at com.example.c_progams.First_screen$1.run(First_screen.java:27) 
```

这是清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.c_progams"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="16" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

    <activity
        android:name="com.example.c_progams.First_screen"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>

     <activity
        android:name="com.example.c_progams.Second_listview"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.SECOND_LISTVIEW" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>

 <activity
        android:name="com.example.c_progams.Array_list"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.ARRAY_LIST" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>

   <activity
        android:name="com.example.c_progams.String_list"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.STRING_LIST" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>

</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:15:19.660

包名称不遵循驼峰式大小写或下划线或连字符。

更改您的包裹名称，例如

```
package="com.example.cprogams" 
```

参考 ：

[命名约定](http://www.oracle.com/technetwork/java/codeconventions-135099.html)

[包名称验证](https://stackoverflow.com/a/3179221/556975)

谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:11:45.723

这是正确的代码...

**`Java Code :`**

```
public class Sample extends ListActivity {
static final String[] type = new String[] { "Array", "Strings" };

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    ListView list = getListView();
    setListAdapter(new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1, type));
    list.setTextFilterEnabled(true);
    list.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View view, int arg2, long arg3) {
            switch (arg2) {
            case 1:
                Intent myIntent1 = new Intent(view.getContext(), Array_list.class);
                startActivityForResult(myIntent1, 0);
                break;
            case 2:
                Intent myIntent2 = new Intent(view.getContext(), String_list.class);
                startActivityForResult(myIntent2, 0);
                break;

            }

        }

    });
}

} 
```

在你的 AndroidManifest.xml 中添加这两行`<Application> TAG`

```
<application android:theme="@style/AppTheme" android:label="@string/app_name" android:icon="@drawable/ic_launcher"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T14:12:58.293

编辑：忽略我，这是在您使用清单进行编辑之前完成的。

看起来您尚未在`AndroidManifest.xml`.

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="your.package.name">
    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name=".Activity1" android:label="@string/app_name"></activity>
        <activity android:name=".Activity2"></activity>
    </application>
    <uses-sdk android:minSdkVersion="4" />
</manifest> 
```

# php - PHP $_GLOBALS -> 取回值？

> ID：14415032
> 
> 赞同：0
> 
> 时间：2013-01-19T13:52:33.933
> 
> 标签：php, globals

假设我有一个在启动时执行类似操作的代码：

```
if (!isset($_GLOBALS['something'])){
    getAndWriteToGlobals($x, $y)
} 
```

这显然可以`getAndWriteToGlobals`正常工作，它只做很少的事情并将另一个数据放入`$_GLOBALS['something'][$ee] = $value ->`其中正常工作（我打印了整个`$_GLOBALS['something']`），`print_r`并且一切都在那里。

我遇到的问题是当程序从这个函数返回时，我尝试在另一个变量中获取数组，像这样

```
$var = $_GLOBALS['something']; 
```

在这种情况下， $var 在 printup 中不包含任何内容（甚至不包含 null），`count($var)`返回`0`. 我在这里想念什么？

谢谢！

编辑：

```
function getAndWriteToGlobals($hostname,$community,$oidIndex, $oidValue) {

$indexes = snmprealwalk($hostname, $community, $oidIndex);
$values = snmprealwalk($hostname, $community, $oidValue);    

if (empty($indexes)) {
    print "Empty indexes array!\n";
}
else{ 
    $c=0;
    $a = array();
    foreach($indexes as $key => $indxVal){
        if (strpos($indxVal,'word') !== false) {
            preg_match("/[0-9]+$/", $key, $matches);
            $ind = $matches[0];
            $a[$c] = $ind;
            $c++;
        }
    }

    $i=0;
    foreach($values as $key => $value){

        if (strpos($key, $a[$i]) !== false) {
            preg_match("/[\+\-0-9]+$/", $value, $matches);
            $value = $matches[0];
            $_GLOBALS['something'][$a[$i]] = $value; 
            $i++;

        }   
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:37:34.457

`$_GLOBALS`还是`$GLOBALS`？

顺便说一句，如果您尝试创建全局变量，请确保语法：

```
// in somewhere (i think very first of master include file)
global $_GLOBALS;
$_GLOBALS['foo'] = 123;
// more code...

// and in function(s)
function getAndWriteToGlobals(...
    global $_GLOBALS;
    // do stuff with $_GLOBALS 
```

PS：我不建议将变量命名为 PHP 结构风格。我更喜欢将这些变量命名为`$_globals`或`$globals`仅命名为 (`$GLOBALS['globals']`等`$GLOBALS['cfg']`)。

# android - setPivotX 在缩放视图上工作奇怪

> ID：14415035
> 
> 赞同：14
> 
> 时间：2013-01-19T13:53:13.890
> 
> 标签：android, view, pivot, scale

我发现`setPivotX`(also `setPivotY`) 在 Android 中很奇怪。如果在视图的比例设置为 1.00f 时设置枢轴，则不会发生任何事情（只是枢轴更改）。但是，如果比例不等于 1.0f（例如`setScaleX(0.9f)`）并且您设置了枢轴，则视图相对（？）移动到新的枢轴。是不是很奇怪？我知道水平和垂直位置（平移）与枢轴值无关，但为什么视图以 1.0f 以外的比例因子移动？

请检查是否有缩放部分。

```
public class ScaleView extends View {

private final ScaleGestureDetector mScaleGestureDetector;

public ScaleView(Context context, AttributeSet attrs) {
    super(context, attrs);

    //setScaleX(0.9f);
    //setScaleY(0.9f);

    mScaleGestureDetector = new ScaleGestureDetector(context, new ScaleGestureDetector.OnScaleGestureListener() {

        @Override
        public void onScaleEnd(ScaleGestureDetector detector) {
            // does nothing intentionally
        }

        @Override
        public boolean onScaleBegin(ScaleGestureDetector detector) {
            setPivotX(detector.getFocusX());
            setPivotY(detector.getFocusY());
            return true;
        }

        @Override
        public boolean onScale(ScaleGestureDetector detector) {
            return false;
        }
    });
}

@Override
public boolean onTouchEvent(MotionEvent event) {
    mScaleGestureDetector.onTouchEvent(event);
    return super.onTouchEvent(event);
}
} 
```

如何设置视图的相同位置，即在枢轴更改之前？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-25T13:39:09.510

我解决了这个问题。这是工作代码：

```
@Override
public boolean onScaleBegin(ScaleGestureDetector detector) {
    float newX = detector.getFocusX();
    float newY = detector.getFocusY();
    setTranslationX(getTranslationX() + (getPivotX() - newX) * (1 - getScaleX()));
    setTranslationY(getTranslationY() + (getPivotY() - newY) * (1 - getScaleY()));
    setPivotX(newX);
    setPivotY(newY);
    return true;
} 
```

主要问题是了解枢轴如何在缩放视图上工作，那么奇怪的枢轴行为应该没有任何问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-02-04T15:22:41.137

@aleien，我可以回答你的问题。设置新的枢轴时，将重新计算视图的属性。Android 使用新的枢轴重新缩放原始视图，但导致新缩放视图的相同缩放值在旧缩放视图之间存在偏移。偏移量就是`(getPivotX() - newX) * (1 - getScaleX())`，为了抵消这个偏移量，我们可以使用`setTranslationX()`. 希望我的回答能帮到你！

# google-chrome - Chrome cookie 创建时间：& 过期时间：2 小时前的时间

> ID：14415037
> 
> 赞同：3
> 
> 时间：2013-01-19T13:53:22.797
> 
> 标签：google-chrome, cookies, setcookie, httpcookie

替代问题： chrome 使用什么来设置时钟？

在开发和测试 30 分钟的 cookie 时，我发现 Chrome 声明 cookie 是提前 2 小时创建的，并且会比计算机时间提前 2 小时过期。

也许一张图片将有助于了解细节。这不仅仅与开发站点有关。例如，我在当地时间上午 8:22（美国/东部）和 macbook 的时钟访问了 SO。根据 Chrome 的说法，早上 6 点 22 分设置了两个 cookie。（当时我和笔记本电脑都还在睡觉。）

Gmail 时区设置为美国/东部。

如果这是有意的、不正确的设置或可能的错误，有什么想法吗？

![Chrome cookie 显示](../Images/d58fa0d708514c455c94b22a94179979.png)

# monitoring - 关于 IPMI 使用的许多硬件问题 - 新手

> ID：14415038
> 
> 赞同：1
> 
> 时间：2013-01-19T13:53:25.260
> 
> 标签：monitoring

我用 Supermicro 母卡 X8DTH-IF，1.0 版“继承”了两台服务器

请注意，ipmi 标签不再存在（？），我无法创建它:-(

我要安装附加卡吗？我想不会，因为存在专用的 IPMI 局域网。请确认。

我想从本地监视器 pc 使用 IPMI，第二步也从远程监视器 pc 使用：
- 我应该将所有专用 LAN 端口链接到交换机并在此交换机上连接我的本地监视器 pc 吗？

对于第二步，我看到了两个解决方案：
1）我是否应该将所有专用 LAN 端口连接到交换机 A，并将所有 LAN0 端口连接到另一个交换机 B，然后将交换机连接到路由器并使用连接到互联网某处的远程监控 pc ?

2) 最后，为了简化布线，我应该将所有 LAN1 端口连接到交换机，并将交换机连接到路由器。在这种情况下，我必须将 BIOS 设置为也将 LAN1 用于 IPMI。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:16:31.957

对于本地监控，您是正确的。

您可以将专用 IPMI 端口连接到 100Base-T 交换机，并在 BIOS 设置中将 IP 地址分配给专用端口。

让 IPMI 可用于远程监控的想法有其缺点。首先，IPMI 上的 Web 服务器和 SSH 服务器不是很安全。您将需要使用额外的防火墙来保护对 IPMI Web 服务器和 IMPI SSH 服务器的远程访问。

远程监控的另一个选择是通过 VPN 访问本地监控网络。

**注意：**您可以在 Supermicro 网站上的[Supermicro Embedded BMC/IPMI 用户指南](http://www.supermicro.com/manuals/other/Embedded_BMC_IPMI.pdf)中找到有关 SuperMicro IPMI 设置和功能的更多详细信息。

# 2d - 一个好的 C# 2D 游戏引擎？

> ID：14415045
> 
> 赞同：4
> 
> 时间：2013-01-19T13:54:17.970
> 
> 标签：2d, game-engine

我想知道你最喜欢的 C# 2D 游戏引擎是什么。

我已经尝试过 XNA，但显然我无法将它移植到 VS2012，而且据某些人说，它不会在 Near 功能中得到支持。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:26:00.497

正如人们所说，这是一个购物问题......但无论如何，你去...... SlimDX是你的情况......它是一个DIRECT X Wrapper，应该为你节省一些痛苦，它是开源和免费的. 看看[这里](http://slimdx.org/)

# java - Java 7 更新 11 使用 Apache Tomcat 6.0.36 破坏了 IE8 上的 webb 应用程序

> ID：14415049
> 
> 赞同：-4
> 
> 时间：2013-01-19T13:54:32.683
> 
> 标签：java, apache, tomcat, internet-explorer-8

我在 Apache Tomcat 6.0.36 上运行 Web 应用程序，并将 IE8 用于带有 Windows 7 的 Web 浏览器。我最近应用了 Java 零日补丁（Java 7 Update 11）。

现在我的所有 Web 应用程序都会出现白屏，并显示“Internet Explorer 无法显示网页”消息这是我从 catalina 日志文件中获得的错误消息。

```
Jan 18, 2013 3:44:55 PM org.apache.catalina.startup.Catalina start
INFO: Server startup in 38198 ms
Jan 18, 2013 3:51:17 PM org.apache.tomcat.util.net.NioEndpoint setSocketOptions
SEVERE:
java.net.SocketException: Invalid argument: no further information
at sun.nio.ch.Net.setIntOption0(Native Method)
at sun.nio.ch.Net.setSocketOption(Unknown Source)
at sun.nio.ch.SocketChannelImpl.setOption(Unknown Source)
at sun.nio.ch.SocketAdaptor.setIntOption(Unknown Source)
at sun.nio.ch.SocketAdaptor.setTrafficClass(Unknown Source)
at org.apache.tomcat.util.net.SocketProperties.setProperties(SocketProperties.java:184)
at org.apache.tomcat.util.net.NioEndpoint.setSocketOptions(NioEndpoint.java:1089)
at org.apache.tomcat.util.net.NioEndpoint$Acceptor.run(NioEndpoint.java:1314)
at java.lang.Thread.run(Unknown Source) 
```

非常感谢有关如何解决此问题的任何想法。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:02:07.627

原因是 setTrafficClass 调用并且有一次相同的子弹。如果您使用 Java6 运行 Tomcat 进程，它应该可以工作。与 Windows 网络堆栈功能有关。一些应用程序提供属性“skipTrafficClass_call=true”，但这是应用程序行为的一部分。这是一个非常古老的问题，但 Java7 做了一个小而重要的改变。

引自网络：

> “我已经找到了第一个问题。在调用 socketChannel.connect() 之后调用 java.nio.channels.SocketChannel.socket().setTrafficClass() 会触发 SocketException。将 setTrafficClass() 调用移到连接之前() 解决了这个问题。” “对 Java 6 的测试表明，如果在 connect() 之后调用 setTrafficClass()，它没有任何效果。看起来当 setter 无效时，Java 7 已经开始抛出异常。”
> 
> JDC 上的一些开发人员发表了评论，指出在 Windows 2000 和 XP 上没有设置 ToS 位。这不是 setTrafficClass 实现中的错误，而是必须通过创建注册表设置来启用 IP_TOS 选项。注册表设置是：-
> 
> HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Tcpip\Parameters\DisableUserTOSSetting

[http://docs.oracle.com/javase/6/docs/api/java/net/Socket.html#setTrafficClass%28int%29](http://docs.oracle.com/javase/6/docs/api/java/net/Socket.html#setTrafficClass%28int%29)

[http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4696356](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4696356)

[http://tomcat.10.n6.nabble.com/Tomcat-7-Cluster-Issue-td4562937.html](http://tomcat.10.n6.nabble.com/Tomcat-7-Cluster-Issue-td4562937.html)

您可以尝试旧的 Http11Protocol 连接器处理程序，这在 tomcat/conf/server.xml 文件中给出。更改 http(8080) 和 https(8443) 连接器。

```
<!-- protocol: org.apache.coyote.http11.Http11Protocol, same as HTTP/1.1
           org.apache.coyote.http11.Http11NioProtocol
           org.apache.coyote.http11.Http11AprProtocol
-->
<Connector port="8080" protocol="org.apache.coyote.http11.Http11Protocol"
       connectionTimeout="20000" redirectPort="8443" 
       disableUploadTimeout="true" useBodyEncodingForURI="true" /> 
```

**编辑**似乎 Tomcat 7.0.30+ 解决了这个问题，您可以使用 Windows+Java7+Tomcat7+NIO 连接器。从现在开始，所有 Java 网络应用程序都应该在打开连接之前设置可选的套接字选项，Java6 提供了免费通行证，但 Java7 抛出了异常。 [http://svn.apache.org/viewvc?view=revision&revision=1358591](http://svn.apache.org/viewvc?view=revision&revision=1358591)

# operating-system - 在虚拟机中如何处理系统调用？

> ID：14415050
> 
> 赞同：4
> 
> 时间：2013-01-19T13:54:39.410
> 
> 标签：operating-system, virtual-machine, system-calls

我想知道在虚拟机中使用系统调用时如何处理。它是否通过虚拟化内核发送某种信号，然后发送到（物理机的）“真实”内核？

我用谷歌搜索了这个主题，但我似乎找不到任何东西。先感谢您。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-08-25T11:44:07.427

有 3 种常见的策略来处理这个问题：
**1\. 管理程序捕获来自客户**的系统调用：管理程序检查特权指令（实际上是系统调用）是来自客户操作系统本身，还是来自客户操作系统中的用户空间程序。如果是前一种情况，那么管理程序实际上会将调用转发给硬件，尽管是通过虚拟化指令。如果是后者，管理程序会将调用重定向到客户操作系统，然后继续。
**2\. 二进制翻译**：在这里，管理程序检查来自客户操作系统的代码，称为“基本块”，扫描特权指令。无论在哪里找到它们，它都会用调用它自己的系统调用过程来替换它们。然后它继续缓存这些块并最终构建一整套这样的块。
**3\. 半虚拟化**：在这里，guest OS 本身被修改，因此它不是调用硬件，而是有 API 来调用管理程序来完成其硬件 I/O。

资料来源：[Andrew Tanenbaum 的现代操作系统](http://stst.elia.pub.ro/news/SO/Modern%20Operating%20System%20-%20Tanenbaum.pdf)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:53:02.990

在所有硬件都被虚拟化的虚拟机中，它就像在真实硬件上一样工作。它通过体系结构具有的任何系统调用指令，这些指令由管理程序读取，管理程序在其虚拟处理器上执行指令。

然而，在像 Wine 这样的仿真层中，PE 可执行文件中的系统调用被映射到 Linux 内核 API 上的系统调用。

# objective-c - 使用 if 函数不工作的简单计算

> ID：14415053
> 
> 赞同：1
> 
> 时间：2013-01-19T13:54:55.060
> 
> 标签：objective-c

好的，伙计们，我有一个不起作用的简单计算。

我将给出一个非常基本的问题示例。

我有一个公斤按钮和一个磅按钮。如果选择 KG 按钮，浮动重量是我的体重文本框中的值。如果选择了磅按钮，我将重量文本框中的数字除以 2.2 并使其浮动重量。

我为此编写了一个 if 函数，最后，我想将体重和年龄相乘。年龄就是年龄文本框中的任何数字。

```
-(IBAction)calculate;
{
    //put age value into a float
    float age = ([valAge.text floatValue]);

    //Put weight value into a float
    if (btnKG.selected = YES)
    {
        float weight = ([valWeight.text floatValue]);
    }
    else
    {
        float weight = ([valWeight.text floatValue]/2.20462);
    }

    //calculate
    float bmr = weight * age;

} 
```

我在计算阶段收到一个错误，即重量是一个未声明的标识符。不过年龄没有问题。

我猜是 if 函数导致了这个问题。我确定这是我忽略的非常愚蠢的事情。

有人可以帮忙吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T13:56:14.137

`(btnKG.selected = YES)`使用不当`(btnKG.selected == YES)`

`=`用于评估。

`==`是为了比较。

在您的代码中，您错误地将值 YES 分配给 btnKG.Selected，这就是您没有得到预期结果的原因。

还，

`float weight` 是块 { 和 } 的本地。您正在尝试稍后在计算中使用它。在方法内部声明 { & } 的变量权重，以便您可以在当前方法中使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T13:58:28.630

当您声明一个局部变量（如`float weight = ...`）时，它仅在最里面的花括号括起来的块中可见。所以，

```
if (...)
{
    float weight = ...;
    // weight is visible here
}

// weight is not visible here 
```

你应该移到`float weight;`if 之前；像这样的东西：

```
//Put weight value into a float
float weight;

if (btnKG.selected)
{
    weight = ([valWeight.text floatValue]);
}
else
{
    weight = ([valWeight.text floatValue]/2.20462);
}

//calculate
float bmr = weight * age; 
```

（编辑：并合并了来自 Anoop 的其他修复）

# mysql - 自动递增作为 SQL 中的计数器

> ID：14415057
> 
> 赞同：0
> 
> 时间：2013-01-19T13:55:18.220
> 
> 标签：mysql, sql, auto-increment

我有一个包含 3 列（imageId、reportId、counter）的表，表的主键是列（imageId、reportId）现在我希望计数器列是我尝试插入该对的次数的计数器（图像 ID，报告 ID）。

例如，如果我有图像“x.png”并且有 100 人报告该图像包含色情内容，我希望表中具有值 (“x.png”、“色情”) 的行在计数器中有 100柱子。当下一个人将此图像报告为色情内容时，我希望计数器为 101，依此类推。

我怎么能做这样的事情？

谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T13:59:54.840

利用[`INSERT ... ON DUPLICATE KEY UPDATE`](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

```
INSERT IGNORE INTO table (imageId, reportId, counter) VALUES (1, 1, 0) ON DUPLICATE KEY UPDATE SET counter=counter+1 
```

您还可以将 counter 列的默认值设置为 0 并使用：

```
INSERT IGNORE INTO table (imageId, reportId) VALUES (1, 1) ON DUPLICATE KEY UPDATE SET counter=counter+1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T13:58:40.143

在这种情况下，最好向表中添加新行。这意味着您可以在其顶部提供一个视图，该视图可以根据需要选择计数。

每个报告新行的好处是还允许用户添加自定义消息等。

- 更新

这里有一些关于视图的细节[http://dev.mysql.com/doc/refman/5.0/en/view-syntax.html](http://dev.mysql.com/doc/refman/5.0/en/view-syntax.html)

在它的核心，您的查询将只是一个基本查询，例如

```
SELECT imageId, reportId, count(reportId) as count FROM training.reporttable group by imageId, reportId 
```

这是一个基本示例：

![选择字段计数](../Images/b1838726a8c512fad4afb12c5041fd85.png)

请注意，我坚持使用您的示例数据，但应该对 reportId 和 imageId 进行规范化

# android - GPS 只给我一个位置，这永远不会改变 Android

> ID：14415062
> 
> 赞同：3
> 
> 时间：2013-01-19T13:55:43.230
> 
> 标签：android, gps

在我的应用程序中，我可以使用 GPS，但问题是它总是让我获得相同的位置。每次我从中检索位置时，它都会给我相同的价值。第一次取到它，我是无线上网的。然后我只带着 GPS 出去了，即使我在一英里外的位置也是一样的。我启用了3g，还是一样。

我将我的应用程序发送给我的一个朋友，他第一次获得了不同的位置，然后无论他走到哪里，他都会看到相同的位置。

这是我的代码：

```
public Location getLocation() {
        try {
            locationManager = (LocationManager) mContext
                    .getSystemService(LOCATION_SERVICE);

            // getting GPS status
            isGPSEnabled = locationManager
                    .isProviderEnabled(LocationManager.GPS_PROVIDER);

            // getting network status
            isNetworkEnabled = locationManager
                    .isProviderEnabled(LocationManager.NETWORK_PROVIDER);

            if (!isGPSEnabled && !isNetworkEnabled) {
                // no network provider is enabled
            } else {
                this.canGetLocation = true;
                // First get location from Network Provider
                if (isNetworkEnabled) {
//                  System.out.println("Network enabled");
                    locationManager.requestLocationUpdates(
                            LocationManager.NETWORK_PROVIDER,
                            MIN_TIME_BW_UPDATES,
                            MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                    if (locationManager != null) {
                        location = locationManager
                                .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
                        if (location != null) {
                            latitude = location.getLatitude();
                            longitude = location.getLongitude();
                        }
                    }
                }
                // if GPS Enabled get lat/long using GPS Services
                if (isGPSEnabled) {
//                  System.out.println("GPS enabled");
                    if (location == null) {
                        locationManager.requestLocationUpdates(
                                LocationManager.GPS_PROVIDER,
                                MIN_TIME_BW_UPDATES,
                                MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                        Log.d("GPS Enabled", "GPS Enabled");
                        if (locationManager != null) {
                            location = locationManager
                                    .getLastKnownLocation(LocationManager.GPS_PROVIDER);
                            if (location != null) {
                                latitude = location.getLatitude();
                                longitude = location.getLongitude();
                            }
                        }
                    }
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        }

        return location;
    }

 @Override
    public void onLocationChanged(Location location) {
//      mAct.playToastMessage("Location Changed");
        getLocation();
//      mAct.setGPSText(location.getLatitude(),location.getLongitude());
    }

    @Override
    public void onProviderDisabled(String provider) {
    }

    @Override
    public void onProviderEnabled(String provider) {
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
    }

    @Override
    public IBinder onBind(Intent arg0) {
        return null;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:22:46.650

```
 locationManager.requestLocationUpdates(
                          LocationManager.NETWORK_PROVIDER,
                       MIN_TIME_BW_UPDATES,
                        MIN_DISTANCE_CHANGE_FOR_UPDATES, this); 
```

在此对于 MIN_TIME_BW_UPDATES 和 MIN_DISTANCE_CHANGE_FOR_UPDATES 的参数，您必须设置 0 和 0。如果设置为 0,0。它会尽快为您提供位置更新。如果您为 设置较大的值，则在满足您的条件之前永远不会获得更新的值。我希望这可以解决您的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T14:07:53.380

```
@Override

public void onLocationChanged(Location loc)

{

loc.getLatitude();

loc.getLongitude();

String Text = “My current location is: “ +

“Latitude = “ + loc.getLatitude() +

“Longitude = “ + loc.getLongitude();

Toast.makeText( getApplicationContext(),Text,Toast.LENGTH_SHORT).show();

} 
```

来源：[获取当前位置的 GPS 教程。](http://www.firstdroid.com/2010/04/29/android-development-using-gps-to-get-current-location-2/)

# php - MySQL 表存在于服务器上但无法从 PHP 访问它

> ID：14415065
> 
> 赞同：4
> 
> 时间：2013-01-19T13:56:18.163
> 
> 标签：php, mysql

我使用 PHPMyAdmin 向数据库添加了一个新表；当试图从 PHP 页面访问它时，我得到了可怕的 MySQL 错误“表不存在”。
数据库连接数据没问题，上面几行在同一个页面上用来访问同一个数据库中的另一个表。如果我`SHOW TABLES`在 PHPMyAdmin 中这样做，则会列出新表；如果我从 PHP 页面执行此操作，则新表不会出现在列表中。与数据库中的所有其他表一样，新表的引擎是 MyISAM。我只能通过 PHPMyAdmin 访问数据库服务器。

对不起，我忘记了代码，这里是：

```
$db = mysql_connect ($db_host, $db_user, $db_password) or 
die("Error message here");
$db_select = mysql_select_db($db_name, $db)or die("Error message here");

$query = ("SELECT * FROM `old_table`");
$result = mysql_query($query);
while ($row = mysql_fetch_array($result)) 
{
// do stuff - here it works
}

$query = ("SELECT * FROM  `new_table`");
$result = mysql_query($query);
while ($row = mysql_fetch_array($result)) 
{
// do stuff - here it does not work
echo mysql_error();
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T13:59:27.210

在 Unix 上，表名区分大小写。在 Windows 上，它们不是。有趣，不是吗？有点像他们各自的文件系统。你认为这是巧合吗？

这可能取决于表类型；MyISAM 在你的情况下。

无论如何，字段名称都不区分大小写。

对于数据库和表名，它取决于底层操作系统。[标识符大小写敏感性](http://dev.mysql.com/doc/refman/4.1/en/identifier-case-sensitivity.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T14:00:06.103

答案很简单：像这样的一些错字或另一个愚蠢的错误：您连接错误的服务器，编辑错误的文件或类似的东西。仔细检查一切。
没有特别的错误导致这个

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-05-06T15:30:24.070

答案是：表名或至少一个字段名是保留字。

为了解决这个问题，您可以用重音符 (`) 将字段和表名括起来，例如：

```
SELECT `value` FROM `pivot`; 
```

# javascript - 是否可以将外部 JS 脚本加载到 blob 中？

> ID：14415068
> 
> 赞同：1
> 
> 时间：2013-01-19T13:56:59.847
> 
> 标签：javascript, jquery, blob

我目前正在玩弄 Workers，它们非常整洁，但肯定缺少一件事：向 Worker 传递匿名函数的可能性。因为我手头有一些空闲时间，所以我想看看我是否能找到解决这个问题的办法。我认为实现这一目标的最明显方法是使用[Blob](https://developer.mozilla.org/en-US/docs/DOM/Blob)，因此我设置了这个小脚本：

```
var blob = new Blob(['var getLastSeen = function(player) { \
                    $.getJSON("fetch.php?player=" + player, function(data){ \
                        if(data.online) \
                            postMessage("online"); \
                        else if(data.online == false) \
                            postMessage(data.lastSeen); \
                    }); \
                    };\
                    getLastSeen("AI@speedersclan.org");'],{ "type" : "text\/javascript" });

var worker = new Worker(window.URL.createObjectURL(blob));

worker.onmessage = function (Event) {
    document.getElementById("logDisplay").innerText = Event.data;
}; 
```

（getLastSeen 进行数据库查找以查看玩家上次登录的时间）

正如您可能注意到的那样，我需要 jQuery 来运行这个脚本，因此我想我只需在 Blob 的开头添加一小段代码：

```
var head= document.getElementsByTagName("head")[0]; \ 
var script = document.createElement("script"); \
script.type= "text/javascript"; \
script.src= "//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"; \
head.appendChild(script); \ 
```

我没有注意到，尽管在查看 Blob 的类型之后我应该立即注意到，没有办法与 DOM 交互，这意味着加载外部脚本显然是不可能的（至少使用我的方法我正在使用）。

(tl;dr) 所以我的问题是，“我如何将外部脚本加载到 blob 中，尽管我无法与 DOM 交互”？

**编辑：**我很清楚我不需要 jQuery 来处理一个简单的 Ajax 请求，我只是想知道它是否通常是可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:35:34.617

`importScripts`能解决你的问题吗？[https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers#Importing_scripts_and_libraries](https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers#Importing_scripts_and_libraries)

这就是您通常在 Worker 中导入库的方式。但是，在这种情况下，我认为您仍然无法导入 jquery，因为 jquery 需要访问 DOM。请参阅[HTML Web Worker 和 Jquery Ajax 调用](https://stackoverflow.com/questions/4838883/html-web-worker-and-jquery-ajax-call)。

# r - ggplot2 0.9.3 中美学的继承和 annotation_custom 的行为

> ID：14415073
> 
> 赞同：6
> 
> 时间：2013-01-19T13:57:26.140
> 
> 标签：r, ggplot2

跟进[我](https://stackoverflow.com/questions/14391183/ggplot2-annotation-custom-gives-an-empty-layer)最近的一个问题，这个问题有点不同，并使用更简单的示例更充分地说明了问题。下面是两个数据集和三个函数。第一个按预期画了一些点和一个圆圈：

```
library("ggplot2")
library("grid")

td1 <- data.frame(x = rnorm(10), y = rnorm(10))

tf1 <- function(df) { # works as expected
    p <- ggplot(aes(x = x, y = y), data = df)
    p <- p + geom_point(color = "red")
    p <- p + annotation_custom(circleGrob())
    print(p)
}

tf1(td1) 
```

下一个似乎要求提供确切的示例图，但代码略有不同。它不会给出错误但不会画圆：

```
tf2 <- function(df) { # circle isn't draw, but no error either
    p <- ggplot()
    p <- p + geom_point(data = df, aes(x = x, y = y), color = "red")        
    p <- p + annotation_custom(circleGrob())
    print(p)
    }

tf2(td1) 
```

最后，这个涉及更复杂的美学，并在您尝试创建圆圈时提供一个空层：

```
td3 <- data.frame(r = c(rnorm(5, 5, 1.5), rnorm(5, 8, 2)),
    f1 = c(rep("L", 5), rep("H", 5)), f2 = rep(c("A", "B"), 5))

tf3 <- function(df) {
    p <- ggplot()
    p <- p + geom_point(data = df, 
        aes(x = f1, y = r, color = f2, group = f2))     
#   p <- p + annotation_custom(circleGrob()) # comment out and it works
    print(p)
    }

tf3(td3) 
```

现在，我怀疑这里的*问题*不是代码，而是我未能掌握 ggplot2 的内部工作原理。 **我可以肯定地解释为什么在第二种情况下没有绘制圆圈以及为什么在第三种情况下图层是空的。** 我查看了代码`annotation_custom`，它有一个硬连线`inherit.aes = TRUE`，我认为这是问题所在。我不明白为什么这个功能需要任何美学（参见上面的文档）。我确实尝试了几种方法来覆盖它并设置`inherit.aes = FALSE`，但我无法完全穿透命名空间并使其粘住。我试图以 ggplot2 创建的对象为例，但这些`proto`对象嵌套非常深且难以破译。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:09:31.547

要回答这个问题：

> “我不明白为什么这个功能需要任何美学”。

实际上`annotation_custom` 需要 x 和 y aes 来缩放它的 grob，并在`native`单位之后使用。基本上它是这样做的：

```
 x_rng <- range(df$x, na.rm = TRUE)                            ## ranges of x :aes x
  y_rng <- range(df$y, na.rm = TRUE)                            ## ranges of y :aes y
  vp <- viewport(x = mean(x_rng), y = mean(y_rng),              ##  create a viewport
                 width = diff(x_rng), height = diff(y_rng),
                 just = c("center","center"))
  dd <- editGrob(grod =circleGrob(), vp = vp)                  ##plot the grob in this vp 
```

为了说明这一点，我在一个虚拟绘图中添加了一个 grob，用作我的 grob 的比例。一是规模大，二是规模小。

```
base.big   <- ggplot(aes(x = x1, y = y1), data = data.frame(x1=1:100,y1=1:100))
base.small <- ggplot(aes(x = x1, y = y1), data = data.frame(x1=1:20,y1=1:1)) 
```

我定义了我的 grob，请参阅我使用 xmin、xmax、ymin、ymax 的原生比例

```
annot <- annotation_custom(grob = circleGrob(),  xmin = 0, 
                                                 xmax = 20, 
                                                 ymin = 0, 
                                                 ymax = 1) 
```

现在查看 ( ) 和 ( )之间的尺度差异（**小点**/**大圆圈**）。`base.big +annot``base.small + annot`

```
library(gridExtra)
grid.arrange(base.big+annot,
             base.small+annot) 
```

![在此处输入图像描述](../Images/63117b47201b101e2bf9a538588e31ff.png)

# ruby-on-rails - Rails 中的 Gemfile 依赖项

> ID：14415074
> 
> 赞同：3
> 
> 时间：2013-01-19T13:57:52.233
> 
> 标签：ruby-on-rails, ruby, bundler, gemfile

在 Rails 应用程序中，如果 Gemfile 中包含的其中一个 gem 依赖于我要使用的另一个 gem，我是否需要在 Gemfile 中包含第二个？

说，我用`cucumber-rails`宝石。通过运行`bundle dependency cucumber-rails`，我可以看到它依赖于 'database_cleaner' 和`factory_girl`. 我是否需要将前两者包含到 Gemfile 中？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:03:59.663

不，您不需要在 Gemfile 中明确要求它们。Bundler 将检测依赖项，将它们包含在您的 Gemfile.lock 中并安装它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T14:02:52.497

如果您使用[捆绑器](http://gembundler.com/)，那么它会在您安装 gem 时安装任何依赖项

你可以看到依赖关系`gemfile.lock`

但请注意，安装依赖项并不总是假设安装的依赖项是您想要的 gem 版本。安装的依赖项是 gem 工作所需的版本。如果您需要最新版本（或任何其他版本）的 factory-girl，那么最好将其包含在`gemfile`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T14:06:42.240

我环顾四周，显然你不应该使用捆绑依赖 cucumber-rails install 功能：

[https://makandracards.com/makandra/12741-don-t-update-gems-with-bundle-update-unless-you-re-feeling-lucky](https://makandracards.com/makandra/12741-don-t-update-gems-with-bundle-update-unless-you-re-feeling-lucky)

# c# - 用于安排单元测试的序列化对象图

> ID：14415077
> 
> 赞同：4
> 
> 时间：2013-01-19T13:58:15.667
> 
> 标签：c#, unit-testing, testing, serialization, tdd

我有一个应用程序，其中问题域由高度相关的域对象表示。我已经将域拆分为几个聚合根对象，这有助于对模型施加顺序，但是为单元测试安排先决条件是艰巨的，因为创建这些聚合根的实例需要创建大量引用的支持对象。

我想编写可重复的、独立的单元测试来运行应用程序而不需要外部依赖项（理想情况下不需要编写大量代码）。

我认为这些是我的选择。有任何偏好或其他建议吗？

1.  编写构建脚本来设置项目数据库并将已知数据插入其中，然后执行单元测试。这是我最不喜欢的选项，因为它引入了外部依赖项（因此不是真正的单元测试）以及更多潜在的失败。它也不会隔离正在测试的业务功能，因为故障可能位于数据访问代码中。

2.  创建可重用的工厂，这些工厂创建具有已知状态的域对象，针对其运行单元测试。这会很好用，但意味着要编写大量样板代码，因此当/如果模型发生更改时需要进行大量更改。

3.  （当前方法）将我的聚合根对象的二进制序列化创建到与测试项目一起签入的文件中。单元测试将它们反序列化以进行测试。这样做的缺点是，如果底层类型发生变化，反序列化将失败，并且必须重新创建所有序列化文件。

4.  接受它并编写一个自定义序列化程序，将图形序列化为 XML 文件，这些文件可以签入解决方案并在测试时反序列化。与 2 一样，这意味着要编写大量的前期样板代码，但维护更容易，因为如果模型发生更改，可以使用文本编辑器轻松编辑序列化状态。

5.  UR DOIN IT RONG。您的域对象具有如此高度的引用性这一事实是主要问题。简化它。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:19:08.273

> 编写构建脚本来设置项目数据库并将已知数据插入其中，然后执行单元测试。这是我最不喜欢的选项，因为它引入了外部依赖项（因此不是真正的单元测试）以及更多潜在的失败。它也不会隔离正在测试的业务功能，因为故障可能位于数据访问代码中。

“*集成不是单元”*是小问题（特别是与*“测试或不测试”*相比），我不会担心。这种方法还有其他更严重的问题：

*   编写脚本。您很可能最终会手工编写 SQL 代码，这需要大量的纪律，尤其是在模型复杂的情况下。错别字很痛苦，很难调试/检测问题，您也需要考虑 IDE/工具。
*   当您的模型更改时，您将修复那些引发相同问题的 SQL 脚本 - 拼写错误、难以发现的错误等等，缺乏 IDE 支持。

总的来说，这种方法**在可维护性方面是昂贵的**。

> 创建可重用的工厂，这些工厂创建具有已知状态的域对象，针对其运行单元测试。这会很好用，但意味着要编写大量样板代码，因此当/如果模型发生更改时需要进行大量更改。

体面的方法，您应该研究使此过程更容易的库（提示：[**AutoFixture**](https://github.com/AutoFixture)，[**NBuilder**](http://code.google.com/p/nbuilder/)）。

> （当前方法）将我的聚合根对象的二进制序列化创建到与测试项目一起签入的文件中。单元测试将它们反序列化以进行测试。这样做的缺点是，如果底层类型发生变化，反序列化将失败，并且必须重新创建所有序列化文件。

与构建脚本一相同的问题 - 更改将是昂贵的。

> 接受它并编写一个自定义序列化程序，将图形序列化为 XML 文件，这些文件可以签入解决方案并在测试时反序列化。与 2 一样，这意味着要编写大量的前期样板代码，但维护更容易，因为如果模型发生更改，可以使用文本编辑器轻松编辑序列化状态。

这与您的第二个解决方案基本相同，但中间是 XML。为什么要添加额外的层？

> UR DOIN IT RONG。您的域对象具有如此高度的引用性这一事实是主要问题。简化它。

不太可能。就其性质而言，域对象往往很复杂。

## 结论

There are no quick-and-dirty workarounds to such problem. Complex domain means there has to be some extra work done at some point. *Serialization-based* solutions (1, 3, 4), even though some may seem easy now, will only postpone said extra work to the moment when changes are introduced. In almost every case, I'd go with better **flexibility** and **readiness for changes** (which only second solution offers - if done properly).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:14:03.683

The problem you are talking about is that data is scattered around in the domain-object-graph:

if you want to calculate the price for an invoice you need article-prices, tax-information, customer-specific dicounts, deliveriy specific shipping-consts, ... .

One strategy to handle this complexity is by seperating the logic to get these detail-values from the actual calculation.

The calculation is a internal method with many parameters and minimal dependency to other domainobjects. This can be easily tested because it does not depend on the object graph any more.

An other strategy is to move the complex calculation from the domain into a seperate servicelayer that depend on other service-interfaces. For testing these service-interfaces can be replaced by mocks.

# java - BufferedReader：确定读取行的字节偏移量

> ID：14415084
> 
> 赞同：5
> 
> 时间：2013-01-19T13:58:58.583
> 
> 标签：java, utf-8, bufferedreader

我正在使用 BufferedReader 逐行读取字节流（UTF-8 文本）。出于特定原因，我需要知道该行在字节流中的确切位置开始。

问题：我不能使用我插入到 BufferedReader 的 InputStream 的位置——以及——阅读器一次缓冲并读取超过一行。

我的问题：**如何确定每行读取的精确字节偏移量？**

一种明显（但不正确）的解决方案是使用 (line + "\n").getBytes("UTF-8").length。这种方法有两个问题：1）只是为了计算字节数，将字符串转换回字节是相当大的开销；2）换行符并不总是用“\n”标记——它也可能是“\ r\n”等。

**有没有其他解决方案？**

编辑：到目前为止，我看到的每一个类似于 LineReader 的类似乎都被缓冲了。有谁知道类似 LineReader 的无缓冲类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:22:53.547

只需将文件作为原始字节读取，UTF-8 中的换行符将始终为`13`and`10`或... 但如果文件将具有不同的 EOL 约定，则将文件作为字符串读取时会遇到完全相同的问题`13`。`10`

的原始字节等价物`BufferedReader`是[`BufferedInputStream`](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedInputStream.html)

您还可以在不编码的情况下计算字符串的 UTF-8 字节数：

```
public static int byteCountUTF8(String input) {
    int ret = 0;
    for (int i = 0; i < input.length(); ++i) {
        int cc = Character.codePointAt(input, i);
        if (cc <= 0x7F) {
            ret++;
        } else if (cc <= 0x7FF) {
            ret += 2;
        } else if (cc <= 0xFFFF) {
            ret += 3;
        } else if (cc <= 0x10FFFF) {
            ret += 4;
            i++;
        }
    }
    return ret;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:22:27.900

尝试设置缓冲区大小：

```
BufferedReader (Reader in, int sz) 
```

> 参数：
> 
> **在**- 一个读者
> 
> **sz** - 输入缓冲区大小

将缓冲大小设置为 1。

# ios - initWithStyle:(UITableViewCellStyle) 未调用

> ID：14415085
> 
> 赞同：3
> 
> 时间：2013-01-19T13:59:08.210
> 
> 标签：ios, objective-c

刚刚发生了一件奇怪的事情，我试图构建我的自定义表格单元，但我的 initWithStyle 没有被调用。

```
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier 
```

**我的 Tablecell 看起来很正常：**

```
- (id)initWithStyle:(UITableViewCellStyle)style reuseIdentifier:(NSString *)reuseIdentifier
{
    self = [super initWithStyle:style reuseIdentifier:reuseIdentifier];
    if (self) {
        // Initialization code
        NSLog(@"xx1111");
    }
    return self;
}

- (void)setSelected:(BOOL)selected animated:(BOOL)animated
{
    [super setSelected:selected animated:animated];

    // Configure the view for the selected state
} 
```

**我如何尝试加载 Customcell 笔尖：**

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    static NSString *TFDCustomCell = @"TFDCell";
    TFDCell *cell = (TFDCell *)[tableView dequeueReusableCellWithIdentifier:TFDCustomCell];

    if (cell == nil) {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"TFDCell"
                                                     owner:self options:nil];
        for (id oneObject in nib) if ([oneObject isKindOfClass:[TFDCell class]])
            cell = (TFDCell *)oneObject;
    }

return cell;

} 
```

但是`NSLog(@"xx1111");`没有出现在我的日志中。当我将 NSLog 放在“setSelected”中时，它“正常”工作

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-19T19:06:38.590

解决方案很简单

```
-(id)initWithCoder:(NSCoder *)aDecoder
{
    NSLog(@"initWithCoder");

    self = [super initWithCoder: aDecoder];
    if (self)
    {

    }
    return self;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-19T14:06:22.653

据我所知，如果您从 nib`initWithStyle:`方法加载视图（在当前情况下为单元格）将不会被调用。重载`awakeFromNib:`方法而不是进行自定义初始化。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-23T02:58:03.320

您没有使用**initWithStyle**初始化表格的单元格，因此您的自定义单元格的**initWithStyle**不会被触发。但是将调用 **awakeFromNib来进行****dequeueReusableCellWithIdentifier**的初始化调用。

# ruby-on-rails - Ruby on Rails 第一个应用程序不工作

> ID：14415086
> 
> 赞同：0
> 
> 时间：2013-01-19T13:59:13.570
> 
> 标签：ruby-on-rails, ruby

我正在阅读本教程：[http](http://edgeguides.rubyonrails.org/getting_started.html) ://edgeguides.rubyonrails.org/getting_started.html 我要提到的一件事是，我认为我使用的 Rails 版本与本教程不同。我正在使用版本 2.3.14 我正在使用 Linux 系统。我因此建立了一个rails项目：

```
rails myproject 
```

正如教程所说，它设置了许多目录和文件（尽管教程使用的命令略有不同）

接下来，我通过创建一个 COntroller 和 View 来设置我的第一个应用程序，如下所示：

```
ruby script/generate controller welcome index 
```

这在我的项目的 app 目录中，在控制器和视图子目录中创建了文件。也就是说，我知道在视图目录中有文件 index.html.erb。

接下来我只想测试服务器：

```
ruby script/server 
```

然后在我的浏览器中转到 localhost:3000，这将我带到公共目录中的 index.html 文件。

这就是事情出错的地方。我想被定向到视图子目录中的 index.html.erb 文件。所以，我去配置并打开 routes.rb 文件进行编辑。以下是我编辑的文件：

```
ActionController::Routing::Routes.draw do |map|
  # The priority is based upon order of creation: first created -> highest priority.

  # Sample of regular route:
  #   map.connect 'products/:id', :controller => 'catalog', :action => 'view'
  # Keep in mind you can assign values other than :controller and :action

  # Sample of named route:
  #   map.purchase 'products/:id/purchase', :controller => 'catalog', :action => 'purchase'
  # This route can be invoked with purchase_url(:id => product.id)

  # Sample resource route (maps HTTP verbs to controller actions automatically):
  #   map.resources :products

  # Sample resource route with options:
  #   map.resources :products, :member => { :short => :get, :toggle => :post }, :collection => { :sold => :get }

  # Sample resource route with sub-resources:
  #   map.resources :products, :has_many => [ :comments, :sales ], :has_one => :seller

  # Sample resource route with more complex sub-resources
  #   map.resources :products do |products|
  #     products.resources :comments
  #     products.resources :sales, :collection => { :recent => :get }
  #   end

  # Sample resource route within a namespace:
  #   map.namespace :admin do |admin|
  #     # Directs /admin/products/* to Admin::ProductsController (app/controllers/admin/products_controller.rb)
  #     admin.resources :products
  #   end

  # You can have the root of your site routed with map.root -- just remember to delete public/index.html.
   map.root :controller => "welcome#index"#I CHANGED THIS LINE

  # See how all your routes lay out with "rake routes"

  # Install the default routes as the lowest priority.
  # Note: These default routes make all actions in every controller accessible via GET requests. You should
  # consider removing or commenting them out if you're using named routes and resources.
  map.connect ':controller/:action/:id'
  map.connect ':controller/:action/:id.:format'
end 
```

我只对文件进行了一次更改。我所做的只是取消注释该行

```
map.root :controller => "welcome#index" 
```

并将它指向我的 index.html.erb 文件（至少我认为我正在这样做）。重新启动服务器仍然会将我发送到 index.html（在公共目录中）。所以我删除了文件。杀死服务器，重新启动。现在我收到一条错误消息。我无法读取我的 index.html.erb 文件。我需要任何帮助来解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:08:41.747

试试这个版本的 Rails 指南： http: [//guides.rubyonrails.org/v2.3.11/](http://guides.rubyonrails.org/v2.3.11/)

但是，我强烈建议使用更新版本的 Rails（当前为 ~3.2）来开始学习。这可能会为您节省一些时间和精力。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T14:04:32.617

rails 2.x 和 rails 3.x 有一些主要区别。如果您遵循 edgerails 教程，那就是 3.x。 [安装新版本的 rails](http://rubyonrails.org/download)。然后，您应该可以轻松地按照本教程中的示例进行操作。

编辑：事实上，安装说明在教程本身。如果您在安装 ruby​​ 1.9 时遇到问题，我更喜欢[rbenv](https://github.com/sstephenson/rbenv)来管理 ruby​​ 版本。 [RVM](https://rvm.io/)可能是更受欢迎的工具。

# javascript - 为什么当父对象设置为null时引用的对象仍然可用

> ID：14415089
> 
> 赞同：0
> 
> 时间：2013-01-19T13:59:24.183
> 
> 标签：javascript

为什么在 JavaScript 中将父对象设置为 null 时，引用的对象不设置为 null？

```
var objA = { 1 : "hello" };
var objB = objA;
objA = null;

console.log(objB);  // { 1 : "hello" } 
```

为什么`objB`不设置为`null`？对象引用在这里如何工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:03:06.047

变量从不“包含”对象，它们只是包含对对象的*引用*。

`var objB = objA;`只需复制存储在 中的*引用*`objA`，使它们指向同一个对象。当`objA`设置为`null`时，意味着它不再指向任何东西。但是，`objB`仍然包含对该对象的引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T14:02:36.507

在您的示例中，`objB` **不**引用`objA`. `objA`它引用当前正在引用的事物。因此，修改`objA`对 没有影响`objB`。

这样想：

```
var a = "test"; //a -> "test"
var b = a;      //a -> "test" <- b
a = null; //a -> null, "test" <- b 
```

考虑下图：

![图片](../Images/d63b8df993f95d5ba3e688d7a8118b38.png)

这就是你的前两行所做的：设置`a`和`b`指向同一个对象。现在，当您更改`b`为 null 时：

![图片](../Images/c4ce7893f51a94afa8809a647362b72f.png)

`a`不变。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T14:03:32.850

它的工作原理就像它适用于任何其他值一样。尝试使用数字或字符串而不是对象：

```
var objA = 5
var objB = objA
objA = null; 
```

关于对象（与数字等相反）的唯一特别之处是对象是可变的，因此如果您设置对象的属性，那么引用该对象的所有变量都会看到变化。

也许引用这个词让您感到困惑，认为它与 C++ 中的含义相同。事实上，在 Javascipt 中发生的事情是变量的行为更像指针（但没有指针算术，并且取消引用是隐式的）。因此，如果您有两个变量指向同一个对象，那么如果您通过 oe 指针更改属性，它也将通过另一个指针可见。另一方面，如果您通过将指针的值分配给其他指针来更改指针的值，那么曾经指向该位置的其他指针不会被更改。

因此，将您的示例翻译成 C 它可能看起来像

```
Obj *a = malloc_new_obj()
Obj *b = a;

//Both pointers point to the same object
a->some_property = 10
printf("%d\n", b->some_property); //should get 10 too

//but assigning the pointer itself doesn't change the otehr pointers
a = NULL;
printf("%d\n", b->some_property); //should still work 
```

变量 objB = objA; objA = null;

# dns - 创建像co.cc这样的域名

> ID：14415091
> 
> 赞同：-1
> 
> 时间：2013-01-19T13:59:26.847
> 
> 标签：dns

三个月前，我在 co.cc 注册了网站。我想知道他们如何创建像“.cc”而不是“.com”这样的域名。我从未见过这样的网站，而且 .cc 不是标准域。所以我的问题是他们如何创建自己的域名？我可以创建自己的域，例如 www.abc.com 的 www.abc.jagdish insteda 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:01:19.713

> 我想知道他们如何创建像“.cc”这样的域名

这是一个（完全标准的）[国家代码顶级域名](http://en.wikipedia.org/wiki/Country_code_top-level_domain)，特别是[科科斯（基林）群岛](http://en.wikipedia.org/wiki/.cc)的域名。他们通过成为该国家/地区的官方注册商或从他们那里购买来获得该域名。

要创建自己的 CCTLD，您首先必须创建一个国家/地区。就拥有自定义 TLD 而言，这似乎是一笔过高的开支。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T14:02:58.687

您不能创建自己的域。等待可以注册您自己的扩展程序，但费用约为 30 万美元

> 大多数顶级域的管理由互联网名称与数字地址分配机构 (ICANN) 委托给负责的组织，该机构运营互联网数字分配机构 (IANA) 并负责维护 DNS 根区。

[http://www.icann.org/](http://www.icann.org/)

[http://www.iana.org/domains/root/db/](http://www.iana.org/domains/root/db/)

[http://data.iana.org/TLD/tlds-alpha-by-domain.txt](http://data.iana.org/TLD/tlds-alpha-by-domain.txt)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T14:05:25.097

您可以申请自己的 gTLD，但这会花费您。至少几十万美元。

阅读更多：http: [//newgtlds.icann.org/en/](http://newgtlds.icann.org/en/)

# iphone - 使用 AFJSONRequestOperation 和 filedata 的 AFNetworking 永远不会完成

> ID：14415093
> 
> 赞同：3
> 
> 时间：2013-01-19T13:59:55.293
> 
> 标签：iphone, ios, afnetworking

我正在使用 AFNetworking 将 json 数据发布到我的网络服务并获得 json 响应。但是现在我还想将多部分表单数据添加到这些 POST 中。如果我这样做（即使没有我首先添加的参数），完成块也永远不会触发。进度块确实触发了，我可以看到文件正确上传。

有人有使用 AFNetworking 发布此类图片的经验吗？我正在使用最新的 AFNetworking 源/版本。

这是我发布包含 json 的字典的初始代码。这工作正常。

```
NSMutableDictionary *postdata = [[NSMutableDictionary alloc] init];
[postdata setObject:[postdictionary JSONString] forKey:@"request"];

NSMutableURLRequest *jsonRequest = [httpClient requestWithMethod:@"POST"
                                           path:path
                                     parameters:postdata];

AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:jsonRequest success:^(NSURLRequest *request,     NSHTTPURLResponse *response, id JSON) {// Success} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {// Failure }];

[operation start]; 
```

这是提交图像的代码版本（不起作用）

```
NSMutableURLRequest *jsonRequest jsonRequest = [httpClient   multipartFormRequestWithMethod:@"POST" path:path parameters:postdata constructingBodyWithBlock: ^(id <AFMultipartFormData> formData) {
    [formData appendPartWithFileData:imageData name:@"photo" fileName:@"photo.jpg" mimeType:@"image/jpeg"];
    [formData throttleBandwidthWithPacketSize:5000 delay:0.1];
}];

AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:jsonRequest];
[operation setUploadProgressBlock:^(NSUInteger bytesWritten, long long  totalBytesWritten, long long totalBytesExpectedToWrite) {
    NSLog(@"Sent %lld of %lld bytes", totalBytesWritten, totalBytesExpectedToWrite);
}];

[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
    NSLog(@"Upload succes");
} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    NSLog(@"Upload failed");
}];

[operation start]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T14:24:36.803

我在许多应用程序上使用此代码并且没有遇到任何问题（注意我使用的是 AFJSONRequestOperation 和 AFRestClient）

设置请求

```
// I have a shared singleton in a separate file APIClient.h 
AFRESTClient *httpClient = [APIClient sharedClient];

NSURLRequest *request = [httpClient multipartFormRequestWithMethod:@"POST" path:method parameters:params constructingBodyWithBlock: ^(id <AFMultipartFormData> formData) 
    {[formData appendPartWithFileData:imageData
               name:@"image"
               fileName:@"image.png"
               mimeType:@"image/png"];
    }]; 
```

然后操作，

```
AFJSONRequestOperation *operation = [[AFJSONRequestOperation alloc] initWithRequest:request]; 
```

我的进度块

```
[operation setUploadProgressBlock:^(NSUInteger bytesWritten, long long totalBytesWritten, long long totalBytesExpectedToWrite) {

    NSLog(@"Sent %lld of %lld bytes", totalBytesWritten, totalBytesExpectedToWrite);
    CGFloat progress = ((CGFloat)totalBytesWritten) / totalBytesExpectedToWrite * 100;
    [SVProgressHUD showProgress:50 status:[NSString stringWithFormat:@"%0.1f %%", progress]];

}]; 
```

成功块（我的 API 返回一个 stat -ok 或失败，然后是数据（与 flickr API 相同）

```
[operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id response) {
    NSLog(@"response string: %@", operation.responseString);
    NSString *resultStat = [response objectForKey:@"stat"];

   if ([resultStat isEqualToString:@"ok"]) {
        //success
        // do something with your data that is returned from the API 
   } else {
        //error 
        NSLog(@"Data Error: %@", response);
   }   

} failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    NSLog(@"Error: %@", [error localizedDescription]); 
}];

[httpClient enqueueHTTPRequestOperation:operation]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:04:09.143

看不到您的代码有任何问题，可能性很小：

尝试设置较短的超时间隔并检查请求是否完成 [request setTimeoutInterval:5]；

也尝试注释掉节流线，看看它是否改变了什么

# ruby - 与 %r/..../option.to_s 的输出混淆

> ID：14415095
> 
> 赞同：1
> 
> 时间：2013-01-19T14:00:06.473
> 
> 标签：ruby

我正在玩，看看如何`Regex#to_s`禁用该模式的选项`%r/../`。但是对这样的输出感到困惑`Regex#to_s`：

```
irb(main):005:0> %r/ab+c/x.to_s
=> "(?x-mi:ab+c)"   #why here -m option has been disabled?

irb(main):006:0> %r/ab+c/i.to_s
=> "(?i-mx:ab+c)"   #why here -m option has been disabled?

irb(main):007:0> %r/ab+c/m.to_s
=> "(?m-ix:ab+c)"   #why here -i option has been disabled?

irb(main):008:0> %r/ab+c/o.to_s
=> "(?-mix:ab+c)"   #why here o option not get into the (...) as the above?

irb(main):009:0> %r/ab+c/.to_s
=> "(?-mix:ab+c)"   #why always m,i,x option get into the (...) as the above? 
```

任何人都可以在这里帮助我了解选项开启/关闭的逻辑吗？

`Regex#hash`和`Regex#quote`方法在 Ruby 1.9.3 中如何工作（任何小代码都可以理解）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:13:00.090

我认为你的理解是颠倒的；破折号左侧的选项打开，而破折号右侧的选项关闭。

```
/ab+c/x => "x-mi"
/ab+c/i => "i-mx"
/ab+c/m => "m-ix" 
```

这三个选项中的每一个都出现在每个正则表达式字符串中，但它们出现在破折号的左侧或右侧表明该选项是打开还是关闭。

关于您的第二个问题，`Regexp#hash`只是一种为给定正则表达式生成相同 Fixnum 的方法。这允许您比较两个不同的正则表达式选项以获得有效的相等性。有关详细信息，请参阅[Object#hash 。](http://ruby-doc.org/core-1.9.3/Object.html#method-i-hash)

# wpf - 如何将集合绑定到wpf中的自定义控件

> ID：14415097
> 
> 赞同：1
> 
> 时间：2013-01-19T14:00:14.277
> 
> 标签：wpf, custom-controls, dependency-properties

我正在构建一个自定义控件，我想将一个集合传递给它，以便控件显示该集合，我的代码如下：

```
<gm:Calendar SubscriptionSource="{Binding Subscriptions}"></gm:Calendar> 
```

并在自定义控件“日历”中

```
public static readonly DependencyProperty SubscriptionSourceProperty =
    DependencyProperty.Register(
        "SubscriptionSource",
        typeof(ObservableCollection<Subscription>),
        typeof(Calendar),
        new FrameworkPropertyMetadata(new ObservableCollection<Subscription>()));

public ObservableCollection<Subscription> SubscriptionSource
{
    get
    {
        return (ObservableCollection<Subscription>)GetValue(SubscriptionSourceProperty);
    }
    set
    {
        SetValue(SubscriptionSourceProperty, value);
    }
} 
```

我在 generic.xaml 中使用

```
<ItemsControl ItemsSource="{Binding SubscriptionSource}">
    <ItemsControl.ItemTemplate>
        <DataTemplate>
            <!--Box-->
            <Border BorderBrush="Black" BorderThickness="1" Padding="0">
                <Border Name="InnerBorder" BorderBrush="{Binding Path=Day, Converter={StaticResource DayBorderColorConverter}}" BorderThickness="2">
                    <Border.Style>
                        <Style TargetType="{x:Type Border}">
                            <Style.Triggers>
                                <!--Current Day-->
                                <DataTrigger Binding="{Binding IsToday}" Value="true">
                                    <Setter Property="Border.Background">
                                        <Setter.Value>
                                            <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                                                <GradientStop Color="#FF1EA6C8" Offset="0"/>
                                                <GradientStop Color="#FF0691B3" Offset="1"/>
                                            </LinearGradientBrush>
                                        </Setter.Value>
                                    </Setter>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Border.Style>
                    <DockPanel>
                        <!--Day Number-->
                        <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" FlowDirection="RightToLeft">
                            <TextBlock TextAlignment="Right" Text="{Binding Day.Date, Converter={StaticResource DateConverter}, ConverterParameter=DAY}" FontSize="12" Margin="5,5,5,5" >
                                <TextBlock.Style>
                                    <Style TargetType="{x:Type TextBlock}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsTargetMonth}" Value="false">
                                                <Setter Property="TextBlock.Foreground" Value="Gray"></Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>
                        <CheckBox IsEnabled="{Binding IsEnabled}" Style="{StaticResource DiscreteCheckBoxStyle}" />
                    </DockPanel>
                </Border>
            </Border>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <UniformGrid Rows="6" Columns="7" />
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
</ItemsControl> 
```

我想将 Subscriptions 可观察集合绑定到日历自定义控件，以便可以在自定义控件中使用该集合，是否可以这样做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:03:32.683

如果在`ItemsControl`里面`ControlTemplate`，那么改变`{Binding SubscriptionSource}`for`{TemplateBinding SubscriptionSource}`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-27T11:44:32.290

感谢@Luke Woodward，我的问题现在得到了解决，我刚刚遇到了另一个问题，我在 usercontrol 中使用了自定义控件，而 usercontrol 是 ListItem 中的一个项目，我修改了绑定表达式

```
<gm:Calendar SubscriptionSource="{Binding Path=Subscriptions,Mode=TwoWay}" > 
```

并且自定义控件是

```
static Calendar()
    {
        DefaultStyleKeyProperty.OverrideMetadata(typeof(Calendar), new FrameworkPropertyMetadata(typeof(Calendar)));
    }

    public ObservableCollection<SubscriptionDay> SubscriptionSource
    {
        get { return (ObservableCollection<SubscriptionDay>)GetValue(SubscriptionSourceProperty); }
        set { SetValue(SubscriptionSourceProperty, value); }
    }

    public static readonly DependencyProperty SubscriptionSourceProperty =
        DependencyProperty.Register("SubscriptionSource", typeof(ObservableCollection<SubscriptionDay>), typeof(Calendar), new FrameworkPropertyMetadata(new ObservableCollection<SubscriptionDay>())); 
```

并在修改为@HighCore 的 Generic.xaml 中发布

```
<ItemsControl ItemsSource="{TemplateBinding SubscriptionSource}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>...... 
```

终于奏效了。感谢@Luke Woodward 和@HighCore

# c# - 用正则表达式解析代码

> ID：14415100
> 
> 赞同：1
> 
> 时间：2013-01-19T14:00:26.627
> 
> 标签：c#, regex, text-parsing

我有这样的文本/代码：

```
fsa sda ${kpp dsa } } sadf ${44} sda } fd sda  sd fdas ${ads} 
```

我想构建一个正则表达式来查找所有出现的 ${soemthing}。从上面的代码中，匹配项将是：

```
${kpp dsa } }, ${44} sda }, ${ads} 
```

我设法想出的是这个正则表达式“\$\s*{.*?}+”，但不幸的是，那个没有做把戏，我想不出有什么办法。请你帮助我好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:01:56.783

您正在描述一种非常规语言，但您正在尝试使用正则表达式。最好为此创建一个解析器！

另外，要回答您的主要问题：`{`and`}`字符在正则表达式中具有不同的含义，您应该使用反斜杠对其进行转义

# javascript - $(document).on 用于自定义事件

> ID：14415102
> 
> 赞同：0
> 
> 时间：2013-01-19T14:00:47.487
> 
> 标签：javascript, jquery, ajax

我正在使用ajax。因此，要在 ajax 请求后保持表单元素正常工作，它必须使用以下代码

```
$(document).ready(function() {    
  $(document).on("change", "#my-chk", function(){
          $("#my_id input[type=checkbox]").prop('checked', this.checked);
        });

    $(document).on("click", "#add-account", function(){
           $.get('/my_url', function(data){ 
             alert(data);
          });
        });
}); 
```

但是，我应该怎么做才能使以下事件处理程序在 ajax 请求后以与上面相同的方式工作？

```
$("#my-date-range-picker").daterangepicker(
      {
          ranges: { //.... }
      },
      function(start, end) { //.... }
    ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:23:22.407

请注意，您必须放置一个自定义事件（在本例中为`pick-range`）来触发您的`daterangepicker`. 但这就是事件委托的美妙之处，无论绑定如何，它始终可用

```
$(document).on('pick-range', '#my-date-range-picker', function(e){
   $(e.currentTarget).daterangepicker(
     {
      ranges: { //.... }
     },
     function(start, end) { //.... }
   );
});

// trigger it
$('#my-date-range-picker').trigger('pick-range'); 
```

[http://jsfiddle.net/DZz8R/](http://jsfiddle.net/DZz8R/)

# java - Java 线程池 - 线程正在更新吗？

> ID：14415104
> 
> 赞同：8
> 
> 时间：2013-01-19T14:00:54.927
> 
> 标签：java, multithreading

我的 Java.NIO 套接字服务器中有一个线程池。我有时会收到运行时错误，例如`Connection reset by peer`or`Broken Pipe`等​​。

我的问题是：抛出异常时线程是否被杀死？如果是 - 是否在线程池中创建了一个新线程来代替被杀死的线程？

这是我的线程管理器：

```
import java.nio.channels.SocketChannel;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class ThreadsManager {

    private ExecutorService threadPool = null;
    private LiveConnectionsManager liveConnectionsManager;
    private int threadPoolSize = 35; //number of tasks thread

    public ThreadsManager(LiveConnectionsManager liveConnectionsManager) {
        this.liveConnectionsManager = liveConnectionsManager;
        threadPool = Executors.newFixedThreadPool(threadPoolSize);
        ServerActions.threadPool = threadPool;
    }

    public void processNewMessage(SocketChannel socketChannel, Client client)
    {
        threadPool.execute(new MessagesProcessor(socketChannel, client, liveConnectionsManager));
    }

    public void closeConnection(SocketChannel socketChannel, Client client) {
        threadPool.execute(new LogoutClient(socketChannel, client, null));
    }   
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-19T14:05:17.670

当您使用**ExecutorService**创建线程池时。

所以**是**的，**ExecutorService.newFixedThreadPool(..)**确保如果线程被任何异常/错误杀死并且有足够的任务等待线程，线程数是恒定的。以下来自 java doc 的文本清楚地说明了这一点：

**直接来自 java 文档：newFixedThreadPool**

*创建一个线程池，该线程池重用在共享无界队列上运行的固定数量的线程。**在任何时候，最多 nThreads 个线程将是活动的**处理任务。如果在所有线程都处于活动状态时提交了其他任务，它们将在队列中等待，直到有线程可用。如果任何线程在关闭之前的执行过程中由于失败而终止，如果需要执行后续任务，新的线程将取代它。池中的线程将一直存在，直到显式关闭。*

[http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Executors.html#newFixedThreadPool(int](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Executors.html#newFixedThreadPool(int) )

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-19T14:13:06.747

`ThreadPoolExecutor`确实根据您选择的设置（在构造函数中传递或通过您使用的辅助方法传递）管理线程数。它的工作原理与 ThreadPoolExecutor javadoc 中描述的一样。

在构造函数（如下所列）中，最有趣的参数是`corePoolSize`和`maximumPoolSize`。`corePoolSize`是保持活动状态的最低线程数。如果一个线程被杀死并且由于这个线程数下降到这个数字以下，新线程将被启动[1]（在某个时候）。

`maximumPoolSize`是池中线程的最大数量。如果这高于`corePoolSize`，那么您的池可能最终会拥有比您在`corePoolSize`参数中指定的更多的线程。如果此时其中一个线程死亡并且活动线程的数量不会低于`corePoolSize`数字，则不会创建新线程。

您通过**Executors**帮助程序类创建的固定线程池具有 corePoolSize == maximumPoolSize，因此该服务确实会确保始终可用相同数量的线程[1]（在需要时）。

[1]**一个重要的通知**是线程的创建是“按需”发生的——也就是说，如果一个线程死亡并且队列中没有任务，那么在不需要线程之前不会创建线程（通过上面的入队已经可用的线程）。

```
/**
 * Creates a new <tt>ThreadPoolExecutor</tt>( ... cut irelevant part ... )
 *
 * @param corePoolSize the number of threads to keep in the
 * pool, even if they are idle.
 * @param maximumPoolSize the maximum number of threads to allow in the
 * pool.
 * ( ... cut irelevant part ... )
 */
public ThreadPoolExecutor(int corePoolSize,
                          int maximumPoolSize,
                          long keepAliveTime,
                          TimeUnit unit,
                          BlockingQueue<Runnable> workQueue) {
    this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,
         Executors.defaultThreadFactory(), defaultHandler);
} 
```

[编辑] - 忘记了另一个问题。事实上，异常确实会杀死 Worker 线程——您需要在内部处理错误。有关详细信息，请查看 java.util.concurrent.ThreadPoolExecutor.Worker 类。它的 runTask 方法值得一试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T14:10:18.610

> 我的问题是：当捕获到错误时线程会被杀死吗？
> 
> 如果是这样 - 线程池用新线程填充它在池中的位置？

如果池中的一个线程死亡，则创建的执行`Executors.newFixedThreadPool`程序将创建一个新线程，因此您问题第二部分的答案是肯定的。至于第一部分，不看 and 的代码是不可能的`MessagesProcessor`，`LogoutClient`但是考虑到任何死线程都会被替换，这并不重要。如果`MessagesProcessor`并`LogoutClient`在内部捕获并记录异常

```
public void run() {
  try {
    // do stuff
  } catch(Exception e) {
    e.printStackTrace();
  }
} 
```

然后异常不会传播到`run`方法之外，因此不会杀死正在运行任务的线程，因此它将能够返回到池中。但是如果他们没有捕捉到异常，并且他们允许将 a从方法`RuntimeException`中抛出，`run`那么线程将会死掉（并被一个新的替换）。

# php - 防止浏览器错误再次转到上一页

> ID：14415105
> 
> 赞同：1
> 
> 时间：2013-01-19T14:00:56.863
> 
> 标签：php, mysql, post-redirect-get

希望有人能帮我解决这个问题。我有一个表格可以为用户选择所需的类别。我使用此表单的复选框让他们选择类别。在他们选择类别时，我将所选类别保存在 SESSION 上，然后该类别页面重定向到下一页。

这个过程是这样的……

```
if ( $totalCategory >= 1 && $totalCategory <= 10 ) {

    $_SESSION['category'] = $_POST['category']; 

    $url = BASE_URI . 'select_subject.php'; // Define the URL:      
            header("Location: $url");
            exit(); // Quit the script. 
} 
```

我的问题是当页面重定向到下一页（select_subject.php）时，有时用户可能需要使用浏览器上的后退按钮再次返回到类别页面来更改他们选择的类别。但是当它发生时，它不会再次进入类别页面，浏览器会显示类似这样的错误......

> 文档已过期，此文档不再可用。

注意：但是当我单击页面重新加载按钮时页面显示正常。

在这种情况下，我需要有人帮助避免这种情况，我需要再次显示类别页面，并正确显示先前选择的类别。

**更新代码：**

```
<?php

if ( isset($_GET['submitted_category'])) {

    if ( isset ( $_GET['category']) && is_array( $_GET['category'])) {

        $_SESSION['selectedcatcount'] = count( $_GET['category']);
        $totalCategory = count( $_GET['category']);

        if ( $totalCategory >= 1 && $totalCategory <= 10 ) {

            $_SESSION['category'] = $_GET['category'];              
            $url = BASE_URI . 'select_subject.php'; // Define the URL:      
                    header("Location: $url");
                    exit(); // Quit the script.         
        } else {        
            echo '<div class="error">
                    <img src="images/error.png" />
                    <p style="margin:2px 0 0;">Please select atleast 1, not more than 10 categories.</p>
                  </div>';          }           
    } else {                
        echo '<div class="error">
                <img src="images/error.png" />
                <p style="margin:2px 0 0;">This can not be empty. Please select atleast one category.</p>
              </div>';  
    }
}   

$q = 'SELECT * FROM category ORDER BY category_id';
$r = mysqli_query( $dbc, $q);

$c = 0;
$i = 0;

echo '<form action="" method="get" accept-charset="utf-8">';
echo '<table><tr>'; 

    while($row = mysqli_fetch_array( $r, MYSQLI_ASSOC  )){

        // if remainder is zero after 2 iterations (for 2 columns) and when $c > 0, end row and start a new row:  
        if( ($c % 2) == 0 && $c != 0){
            echo "</tr><tr>";
        }
        echo '<td width="50%">
                <input type="checkbox" name="category[]"  value="' . $row['category_id'] . '" />' . $row['category_name'] . 
             '</td>';
    $c++; 

    } // while..
        // in case you need to fill a last empty cell:
        if ( ( $i % 2 ) != 0 ){
        // str_repeat() will be handy when you want more than 2 columns
          echo str_repeat( "<td>&nbsp;</td>", ( 2 - ( $i % 2 ) ) );
        }
    echo "</tr></table>";
?>
                        </div>                  
                        <div class="continue">
                            <p>Please click 'Continue' button to proceed to next step</p>
                            <input type="submit" value="Continue" class="continue-btn" />
                            <input type="hidden"   name="submitted_category"   value="TRUE" />
                        </div>
                        </form> 
```

希望有人帮助我..谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:36:33.403

如果您使用 $_GET 方法，您将不会遇到此问题，请更改您的表单方法以获取并尝试它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T18:27:24.130

使用此代码....

```
if ( $totalCategory >= 1 && $totalCategory <= 10 ) {

    //Replace the following line 
    $_SESSION['category'] = $_POST['category']; 

    //with the line below
    $_SESSION['category'] = $_GET['category'];

    $url = BASE_URI . 'select_subject.php'; // Define the URL:   e fio

        header("Location: $url");
        exit(); // Quit the script. 
} 
```

感谢您分享您的代码，但您忘记告诉我触发了哪个错误。让我们仔细看看。您是否正确声明了输入意味着

```
 <input type="checkbox" name="category[]" value="....">
 <input type="checkbox" name="category[]" value="....">
 <input type="checkbox" name="category[]" value="...."> 
```

当然提交

```
 <input type="submit" name="submitted_category" value="Submit Categories"> 
```

按下提交按钮后，在重定向之前，您的 url 应该如下所示。

```
 select-category.php?category[]=2&category[]=3&category[]=7.......... 
```

仍然很大程度上取决于您遇到的错误。

# windows - 文件夹在 VS2012 中不可见，但在资源管理器、Powershell 和 Open.. 记事本中的对话框中可见

> ID：14415106
> 
> 赞同：0
> 
> 时间：2013-01-19T14:00:59.390
> 
> 标签：windows, visual-studio-2012, filesystems, windows-server-2012

我在 Windows Server 2012 上安装了 VS2012。我还在同一台机器上安装了 Microsoft 证书服务，目的是在那里自定义经典 ASP 页面。

当我使用“打开网站”对话框时，我看不到该文件夹​​。无论我是否被提升，结果都是一样的。

![在此处输入图像描述](../Images/18ad035899476c46d1a9b5e11233bee4.png)

但是我可以在powershell中查看文件夹

![在此处输入图像描述](../Images/3e788989257d67aee2ea588ec8a6bf9c.png)

为什么VS2012看不到文件夹？

我还创建了一个名为 certsrv-powershell 的文件夹，它也没有出现

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T18:04:46.963

因为 VS 2012 是一个 32 位的 exe，它使用的 c:\windows\system32 文件夹实际上位于 c:\windows\syswow64。如果您启动 x86 PowerShell 提示符并在 system32 下创建目录，VS 会看到它们。

# iphone - 基于字符串搜索访问 NSMutableArray，然后将一些对象写入 NSLog

> ID：14415109
> 
> 赞同：-3
> 
> 时间：2013-01-19T14:01:19.190
> 
> 标签：iphone, ios, objective-c, ipad

我正在尝试搜索一个 NSMutableArray，它已使用事件存储中的日历事件进行了初始化。我特别想在数组中搜索字符串“office”，该字符串将输入到“location”属性的某些日历条目中。然后我需要将每个返回事件的以下特定值写入 NSLog：

活动名称 活动开始时间 活动结束时间 活动地点

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:15:09.443

您可以使用 NSPredicate，它既简单又快速

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"publisher == %@", @"Apress" ];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"publisher containts[cd] %@", @"Apress" ];
NSArray *filtered  = [bookshelf filteredArrayUsingPredicate:predicate]; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-19T14:06:39.440

您将使用 for 循环或更好的快速枚举来遍历数组，以捕获数组中包含的每个字符串并检查它是否出现子字符串 @"office"。

看看 fast enumeration：`for (id object in myMutableArray)` 和 NSString's methods for finds substrings like`-rangeOfString:`

您将使用 google、apple 的文档和 StackOverflow 轻松找到问题的答案，并且对编程语言有基本的了解......

# php - 从 Instagram 获取图像，始终为空

> ID：14415110
> 
> 赞同：0
> 
> 时间：2013-01-19T14:01:23.043
> 
> 标签：php, image, instagram

我在 localhost（WAMP 服务器，启用 CURL）上开发了一个小脚本来从 Instagram 检索图像。基于此脚本：[请参阅教程](http://www.blueprintinteractive.com/blog/how-instagram-api-fancybox-simplified)我还在 Instagram 上设置了变量。我不确定更具体的问题是什么或如何解决它（可能通过身份验证）。

*   用户身份
*   客户编号
*   客户机密
*   网址
*   重定向 URI

这是我的用户 [http://instagram.com/krondorl](http://instagram.com/krondorl)

```
function fetchData($url){
  $ch = curl_init();
  curl_setopt($ch, CURLOPT_URL, $url);
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  curl_setopt($ch, CURLOPT_TIMEOUT, 20);
  $result = curl_exec($ch);
  curl_close($ch);
  return $result;
}

$result = fetchData("https://api.instagram.com/v1/users/280766222/media/recent/?access_token=df04c6989eaf4490bdac1f82554182bb");
$result = json_decode($result);

var_dump($result); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:07:02.667

试试下面对我有用的代码。确保您的网址正确。

```
$json_url  ='https://api.instagram.com/v1/users/280766222/media/recent/?access_token=df04c6989eaf4490bdac1f82554182bb';

// Initializing curl
$ch = curl_init( $json_url );

// Configuring curl options
$options = array(
CURLOPT_RETURNTRANSFER => true,
CURLOPT_HTTPHEADER => array('Content-type: application/json') 
);

// Setting curl options
curl_setopt_array( $ch, $options );

// Getting results
$results =  curl_exec($ch); // Getting jSON result string

$json_decoded = json_decode($results); 
```

顺便说一句，我检查了您的 URL 恰好不正确，并给了我以下错误。

```
{"meta":{"error_type":"OAuthAccessTokenException","code":400,"error_message":"The \"access_token\" provided is invalid."}} 
```

在尝试代码之前，请先在浏览器上尝试 URL，并查看 URL 是否正确。

# jquery - 重新加载 html 以显示信息

> ID：14415112
> 
> 赞同：0
> 
> 时间：2013-01-19T14:01:36.720
> 
> 标签：jquery, html, xml, ajax

我有一个 html5 网页，可以读取 xml 并在其中显示信息。该页面是用jquery编写的。

这是我的 xml：[xml](http://dl.dropbox.com/u/12291198/base_es.xml)

这是我的 html5：[html](http://dl.dropbox.com/u/12291198/hor2.html)

我可以完美地阅读 html5（这对我来说很难），但是当我想显示它时，我必须重新加载页面才能看到信息，因为起初我什么也看不到！:(

有人能帮助我吗？非常感谢！

ps 我通常在 Firefox 上打开它，因为 safari 和 chrome 不打开它。（我认为是因为我的配置）

```
var xml;
$(document).ready(function(){
    $.ajax({
        type: "GET",
        url: "base_es.xml",
        dataType: "xml",
        success: xmlParser
    });
});
//loading XML file and parsing to .main div.
function xmlParser(data) {
    xml = data;
    $('#load').fadeOut();
    $(xml).find("fac").each(function () {
    name = $(this).attr("id");
    name2 = $(this).find("esc").text();
    var curso = $(this).find("curso").text();
    $("#list").append("<li><a href='hor3.html?id=" + name + "'data-transition='slide'><h3  id='name'>" + name + "</h3></a></li>");
    }); $('#list').listview('refresh');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T22:02:26.903

好的，我已经看到我可以使用`location.reload();` 或重新加载页面`top.location.href='hor2.html';`

# ios - xcode 4.5 忽略了一些行

> ID：14415124
> 
> 赞同：0
> 
> 时间：2013-01-19T14:02:48.113
> 
> 标签：ios, xcode

我有时对 XCODE 4.5 有奇怪的问题。xcode 忽略了我的一些行或我添加到项目中的任何更改。例如，我想更改整数的数量，但 Xcode 使用以前的数量（令人惊讶的是，该数量已被新数量替换），或者我想要 NSLog 一些字符串，它只是跳过它们而不将它们打印在大纲中。我重新启动了我的 MAC，但没有任何改变！

![在此处输入图像描述](../Images/70ba2152e0a92ef3722411dc11e0ff2f.png)

# iphone - canMoveRowAtIndexPath 不会被调用 - 但 canEditRowAtIndexPath 会

> ID：14415128
> 
> 赞同：4
> 
> 时间：2013-01-19T14:03:08.530
> 
> 标签：iphone, ios, uitableview

非常非常基础。我不明白。当表格加载和 Edit 被切换时`canEdit`被调用，但不是`canMove`. 我究竟做错了什么？

```
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
  NSLog(@"canEdit=%d", indexPath.row);  
  // output is as expected, "canEdit" for each row
  return (indexPath.section == 1) ? YES : NO;
}

- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
  NSLog(@"canMove=%d", indexPath.row);
  // nothing. No output
  return (indexPath.section == 1) ? YES : NO;
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-19T14:13:50.443

抱歉，问题在这里得到解答：

[重新排序控件未显示在表格视图上](https://stackoverflow.com/questions/4769418/reorder-control-isnt-displayed-on-table-view)

您还必须实施

```
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)sourceIndexPath toIndexPath:(NSIndexPath *)destinationIndexPath 
```

**斯威夫特**：

```
func tableView(_ tableView: UITableView, canMoveRowAt indexPath: IndexPath) -> Bool {
    return true
}

func tableView(_ tableView: UITableView, moveRowAt sourceIndexPath: IndexPath, to destinationIndexPath: IndexPath) {
    //code
} 
```

# xml - 每次迭代的 XSL

> ID：14415133
> 
> 赞同：0
> 
> 时间：2013-01-19T14:03:51.820
> 
> 标签：xml, xslt, foreach

我有两个 for-each 语句迭代，我希望输出在表中是垂直格式而不是水平格式。

目前它输出：

```
a b c
1 2 3 
```

我希望它输出：

```
a 1
b 2
c 3 
```

有人可以帮忙吗？这是 XSL：

```
 <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="html" indent="no"/>
    <xsl:key name="names" match="Niche" use="."/>
    <xsl:key name="niche" match="row" use="Niche"/>

        <xsl:template match="/">
            <table border="1">

                <xsl:for-each select="//Niche[generate-id() = generate-id(key('names',.)[1])]">
                <xsl:sort select="."/>

                    <td>
                    <xsl:value-of select="."/>
                    </td>
                </xsl:for-each>

                <td><tr></tr></td>

                <xsl:for-each select="//row[generate-id(.)=generate-id(key('niche', Niche)[1])]">
                <xsl:sort select="Niche"/>

                    <td>
                    <xsl:value-of select="count(key('niche', Niche))"/>
                    </td>
                </xsl:for-each>

            </table>

    </xsl:template>
</xsl:stylesheet> 
```

示例 XML：

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<?xml-stylesheet type="text/xsl" href="sample.xsl" ?>
<root>
    <row>
        <Niche>a</Niche>
    </row>
    <row>
        <Niche>b</Niche>
    </row>
    <row>
        <Niche>b</Niche>
    </row>
    <row>
        <Niche>c</Niche>
    </row>
    <row>
        <Niche>c</Niche>
    </row>
    <row>
        <Niche>c</Niche>
    </row>
</root> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:27:47.293

我很确定您需要做的就是：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="html" indent="no"/>
  <xsl:key name="niche" match="Niche" use="."/>

  <xsl:template match="/">
    <table border="1">

      <xsl:for-each select="//Niche[generate-id(.)=generate-id(key('niche', .)[1])]">
        <xsl:sort select="."/>
        <tr>
          <td>
            <xsl:value-of select="."/>
          </td>
          <td>
            <xsl:value-of select="count(key('niche', .))"/>
          </td>
        </tr>
      </xsl:for-each>

    </table>

  </xsl:template>
</xsl:stylesheet> 
```

但请提供一个示例输入 XML，以便我们进行验证。

在示例输入中，这会产生：

```
<table border="1">
  <tr>
    <td>a</td>
    <td>1</td>
  </tr>
  <tr>
    <td>b</td>
    <td>2</td>
  </tr>
  <tr>
    <td>c</td>
    <td>3</td>
  </tr>
</table> 
```

要改为从最高到最低的出现次数排序，您可以替换此行：

```
<xsl:sort select="."/> 
```

有了这个：

```
<xsl:sort select="count(key('niche', .))" order="descending" data-type="number"/> 
```

# c++ - 从大数倒计时

> ID：14415137
> 
> 赞同：1
> 
> 时间：2013-01-19T14:04:19.917
> 
> 标签：c++, precision

我正在研究 Euler 项目第三个练习的解决方案，我需要遍历下面的奇数`sqrt(600851475143.0)`。但是每次循环迭代时我都不能从数字中减去 2，它每次都保持不变。根据[这个答案](https://stackoverflow.com/a/8581551/1087848)，这是由于数字的存储方式以及小数点以上和小数点以下的所有内容都丢失了。我该如何解决这个问题？我需要十进制数字，所以我不能使用 int （无论如何它都不够大）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:06:41.813

由于您正在寻找奇数，而奇数根据定义是整数，因此只需使用适当的整数类型而不是浮点数学。

# java - JLine 仅适用于 IDEA

> ID：14415151
> 
> 赞同：6
> 
> 时间：2013-01-19T14:05:25.710
> 
> 标签：java, jline

当代码在想法中运行时，我使用 jline 没有问题。使用 bat 文件运行，编辑字符不会发送到终端。

```
java -classpath ..\JActor\target\classes;..\JID\target\classes;target\classes;..\slf4j-api-1.7.2.jar;..\slf4j-simple-1.7.2.jar;..\apache-sshd-0.8.0\lib\sshd-core-0.8.0.jar;..\apache-sshd-0.8.0\lib\mina-core-2.0.5.jar;..\apache-sshd-0.8.0\lib\bcprov-jdk15-140.jar;..\jline-2.9.jar;..\joda-time-2.1.jar org.agilewiki.jasocket.sshd.SSHServer %1% 
```

我检查了 jline jar 文件，它包含 jansi 和 hawtjni 的 fusesource 代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T03:34:53.993

事实证明，IDEA 下使用的终端和 dos 框是不同的。在所有情况下都强制使用 IDEA 终端不起作用，但这样做：

```
 consoleReader = new ConsoleReader(in, out, new TerminalSupport(true) {}); 
```

# ios - 如果一个 NSManagedObjectContext 实例同时保存在两个线程中怎么办？

> ID：14415152
> 
> 赞同：0
> 
> 时间：2013-01-19T14:05:34.330
> 
> 标签：ios, core-data

在我的应用程序中，我创建了一个 NSManagedObjectContext 实例，两个线程可以访问这个实例，它们都需要提交更改。如果在两个线程中同时调用 save 方法会怎样？上下文中所有 NSManagedObject 实例的属性会发生什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:10:22.353

你不应该那样做。为每个线程创建两个单独的 NSManagedObjectContext。CoreData 不是线程安全的。在使用 CoreData 进行多线程之前阅读此文档

[与核心数据的并发性](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/coredata/Articles/cdConcurrency.html#//apple_ref/doc/uid/TP40003385-SW1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T18:45:13.387

NSPersistentStoreCoordinator 将在多个线程或队列上为 NSManagedObjectContexts 处理适当的锁定，但 NSManagedObjectContext 本身应该只在一个线程上使用，即它创建的线程（常见错误是在主线程上创建一个 MOC，然后将其传递给另一个线程 -不要这样做）。

正如 Tony 指出的那样，您希望为每个线程拥有一个 MOC，共享一个持久存储协调器，或者使用 iOS 5 中引入的 Core Data 的新并发模式，允许您创建子上下文和/或使用新的 performBlock 和 performBlockAndWait保证上下文在正确线程上执行的方法。

您的问题的直接答案是“谁知道”。该行为将是未定义的，您几乎肯定会遇到随机崩溃和/或死锁。

# javascript - 推迟 jQuery.each 结果

> ID：14415154
> 
> 赞同：4
> 
> 时间：2013-01-19T14:05:55.110
> 
> 标签：javascript, jquery, jquery-deferred

我正在学习延期，但无法弄清楚这是如何/为什么起作用的：

```
<html>
<head>
</head>
<body>
    <div>
        1</div>
    <div>
        2</div>
    <div>
        3</div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script>
        $("div").each(function (i) {
            $(this).delay(1000 * i).fadeOut();
        }).promise().done(function () { console.log("it's done"); });
</script>
</body>
</html> 
```

特别是：**为什么我可以在每个之后调用 promise？为什么技术上可行？**我已经控制台记录：

```
console.log($("div").each(function (i) {})); 
```

我确实在原型中看到**了 promise方法。**但是，我的每个函数都没有返回任何值，只有一个：

```
$(this).delay(1000 * i).fadeOut(); 
```

**那么 promise 如何与动画结果相关联呢？（基本上每次迭代的结果）**

**编辑1：为了清楚起见，也许我应该这样写我的问题：**

**在所有动画完成后调用done**方法是如何完成的 == promise 如何与在每个回调函数内部执行的动画互连。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T14:48:38.657

我从未见过`each`与承诺一起使用，但只有动画

```
$('div') 
.animate({opacity: 0}, 1500) // animate all divs at once
.promise()
.done(function(){ 
   console.log('all done');
}); 
```

这将立即为所有 div 设置动画，然后在所有 div 完成动画时执行回调。循环内动画的问题在于它无法协调，如果你不使用承诺，你将无法控制它们何时完成。如果你真的想使用`each`，你必须制作一个数组`promises`，然后使用`then`

```
 var promises = [];
 $('div').each(function(){
    var $this = $(this);
    promises.push($this.fadeOut('slow').promise());
 });

 $.when.apply($, promises).then(function(){
   console.log('all done');
 }); 
```

这与做的不同，`$('div').fadeOut('slow', function(){ alert('done'); });`因为回调将发生在每个动画元素上，而 Promise 就像是一个包含许多子任务的“任务”

[http://jsfiddle.net/LbHrQ/3/](http://jsfiddle.net/LbHrQ/3/)

Promise 的最佳用途是当你想同步一些本质上的异步操作时，比如动画、ajax、使用超时的东西（在这种情况下，你需要`resolve()`手动延迟）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T14:11:01.230

您是否尝试在块*内*`promise()`添加方法？目前，您仅在所有迭代完成后才执行它。

 *```
$("div").each(function (i) {
   $(this).delay(1000 * i).fadeOut().promise().done(function () { console.log("This individual animation is done."); });
}).promise().done(function () { console.log("Everything is done."); }); 
```

* * *

您的选择器`div`实际上引用了页面上的很多元素。当它遍历所有这些时，它对该元素执行特定的操作。

然后，您要做的是要求 jQuery 在与这些元素相关的所有先前操作都完成后执行另一个操作。根据他们的文档，它返回一个对象：

> 当绑定到集合的某种类型的所有操作（无论是否排队）都已完成时。

因此，在**每个** `fadeOut()`集合中执行完之后，`console.log()`就会激活 。*

# java - java性能前沿：for循环中的参考

> ID：14415162
> 
> 赞同：0
> 
> 时间：2013-01-19T14:06:34.337
> 
> 标签：java, performance, jakarta-ee

哪个代码更适合您的性能点？我认为第二个代码是因为在 for 循环中创建 ref 并不好。

我可以知道你的意见吗？

```
// First Code
for (int i = 0; i < array.size(); i++) {
    SipSession abc = (SipSession) array1.get(i);
}

// Second Code
SipSession abc = null;
for (int i = 0; i < array.size(); i++) {
    abc = (SipSession) array1.get(i);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:12:25.793

在分析代码并确定这是瓶颈之后，您应该只根据性能进行选择。

在您完成此操作之前，请选择您认为更清晰、更易于维护的版本。

我总是选择第一个版本，除非我需要最后一个`SipSession`引用来超过循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T14:12:20.730

最终它不会有任何区别。JIT 会将代码优化为完全相同的东西。

当然，唯一的区别是范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T14:14:35.040

这将是**微优化**，最好对代码进行其他类型的优化，而不是在没有证明它是瓶颈的情况下进行优化。这不是这里的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T14:17:09.447

永远不要在没有分析的情况下尝试优化。JIT 编译器完成了繁重的*工作，因此您不必*.

除此之外，您`array`似乎是 raw`List`而不是 generic `List<SipSession>`。泛型不一定会优化您的代码，但它可以更容易理解和维护。您的简单循环可以重写为：

```
List<SipSession> array;
for(SipSession abc : array){
    // Stuff    
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T14:08:43.903

我认为两者之间没有太大的性能差异。唯一的主要区别是`SipSession`参考的范围。但是，如果您非常在意*，*则应该尝试进行分析。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-19T14:12:16.620

在您的第一个代码中，VM 甚至编译器将简单地删除引用变量，因为它从未在其范围内使用。

它将被优化为

```
for(int i=0;i<array.size();i++){
    array1.get(i);    
} 
```

根据在方法中所做的事情，`get`可以在优化时移除空洞循环。

如果访问元素的顺序不重要，您还可以：

```
for (int i = array.size()-1; 0 <= i ;) {
    SipSession abc = (SipSession) array1.get(i--);
} 
```

这只会调用`array.size()`一次，而不是在每个循环迭代中调用。

# xcode - 当目标是 4.3 时，我可以分发使用 StoryBoard 构建的测试应用程序吗？

> ID：14415172
> 
> 赞同：0
> 
> 时间：2013-01-19T14:07:12.747
> 
> 标签：xcode, storyboard, distribution, adhoc

我使用 Storyboard 构建了一个带有 xcode 4.5.2 的应用程序。最后，我能够为 4.3 的部署进行构建，但是当我按照有关如何分发应用程序进行 beta 测试的说明进行操作时，我需要为 iOS 设备存档应用程序。当我这样做时，我收到一个错误，即 Stortyboards 不适用于 4.3 版及更早版本。有没有办法绕过它，或者我应该在没有情节提要的情况下构建应用程序？

谢谢，西蒙

# visual-studio-2010 - 找不到包管理器控制台

> ID：14415177
> 
> 赞同：21
> 
> 时间：2013-01-19T14:07:46.657
> 
> 标签：visual-studio-2010, package-managers

`Package Manager Console``Tools`在菜单中找不到？？我正在使用`Visual Studio 2010`. 我需要在其中运行一个命令`Install-Package Facebook`才能在 C#.NET 中使用 Facebook SDK。帮助！

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-04-15T21:22:34.667

1.  从扩展管理器下载：NuGet 包管理器
2.  从 Visual Studio 2010 转到`Tools`–> `Library Package Manager`–>`Package manager console`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-02-25T20:39:31.280

你需要安装[NuGet 包管理器](https://visualstudiogallery.msdn.microsoft.com/27077b70-9dad-4c64-adcf-c7cf6bc9970c)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-04T19:15:14.957

从VS2013

`Tools`–> `NuGet Package Manager` –>`Package manager console`

# c++ - 为匿名身份验证配置猫鼬

> ID：14415178
> 
> 赞同：0
> 
> 时间：2013-01-19T14:07:47.890
> 
> 标签：c++, authentication, mongoose-web-server

我在用于开发和测试 Web 系统的 C++ 应用程序中嵌入了 mongoose。当这些 Web 系统在本地运行时，不需要安全性。它应该像匿名身份验证系统一样运行。我没有找到任何方法在猫鼬中做到这一点，所以我重写了“授权”方法

```
static int authorize(struct mg_connection *, struct file *) {
   return 1;
} 
```

通常授权方法验证用户。有没有另一种方法来配置猫鼬像匿名一样运行？并且像这样重写授权方法是否有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T10:41:57.700

您提到的授权功能在相应目录中查找 .htpasswd 文件。如果 .htpasswd 文件不存在，则授权成功。所以你根本不需要做任何改变，只是不要创建 .htpasswd 文件。

# sql-server - 如何将 4GB 的 .sql 文件溢出到更小的文件中

> ID：14415179
> 
> 赞同：1
> 
> 时间：2013-01-19T14:07:51.057
> 
> 标签：sql-server, sql-server-2008

我的数据库有一个 4GB 的 sql 数据脚本。我想执行它，但 SQL Server Management Studio 确实允许我执行它，因为它是一个非常大的文件。

所以我想把这个文件拆分成更小的文件，以便我可以执行它。我用谷歌搜索了它，但没有得到任何好的解决方案。我也使用 HJSplit 来拆分文件，但只有第一个拆分文件格式正确，而其他文件格式不正确，因此无法在 SQL 查询接口中执行。

请帮帮我，我如何在`.sql`有或没有分割的情况下使用数据执行这个文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:28:53.483

使用[sqlcmd](http://msdn.microsoft.com/en-us/library/ms170572.aspx)工具执行文件..

```
sqlcmd -S myServer\instanceName -i C:\myScript.sql 
```

或者

```
sqlcmd -S <server> -i C:\<your file here>.sql -o 
```

只需替换为 SQL 框的位置和脚本的名称。如果您使用的是 SQL 实例，请不要忘记语法是：sqlcmd -S \instance。

以下是您可以传递 sqlcmd 的所有参数的列表：

```
Sqlcmd            [-U login id]          [-P password]
  [-S server]            [-H hostname]          [-E trusted connection]
  [-d use database name] [-l login timeout]     [-t query timeout] 
  [-h headers]           [-s colseparator]      [-w screen width]
  [-a packetsize]        [-e echo input]        [-I Enable Quoted Identifiers]
  [-c cmdend]            [-L[c] list servers[clean output]]
  [-q "cmdline query"]   [-Q "cmdline query" and exit] 
  [-m errorlevel]        [-V severitylevel]     [-W remove trailing spaces]
  [-u unicode output]    [-r[0|1] msgs to stderr]
  [-i inputfile]         [-o outputfile]        [-z new password]
  [-f  | i:[,o:]] [-Z new password and exit] 
  [-k[1|2] remove[replace] control characters]
  [-y variable length type display width]
  [-Y fixed length type display width]
  [-p[1] print statistics[colon format]]
  [-R use client regional setting]
  [-b On error batch abort]
  [-v var = "value"...]  [-A dedicated admin connection]
  [-X[1] disable commands, startup script, enviroment variables [and exit]]
  [-x disable variable substitution]
  [-? show syntax summary] 
```

# javascript - 客户端宽度为零

> ID：14415184
> 
> 赞同：0
> 
> 时间：2013-01-19T14:08:59.013
> 
> 标签：javascript, jquery

我正在使用 jQuery 对表中的列进行隐藏/显示。有时我将 clientWidth 值设为 0（那时表的父元素，即 div 宽度与该表相比减小了，因此表的某些部分未显示），有时值。虽然 clientWidth 为 0 为我创造了问题。为什么clientWidth是0..页面完全加载后

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:19:39.637

如果您的脚本在`document.ready`function 而不是 in 中运行`document.load`，您可以查看类似的问题：[clientWidth 和 clientHeight 返回 0](https://stackoverflow.com/questions/11133069/clientwidth-and-clientheight-returns-0)

在 document.ready 中，您的元素已准备好在 DOM 中进行操作，但它们还不能显示在页面上。从这里开始，您可以尝试在`document.load`函数中执行脚本；在此函数中，元素的 clientWidth 必须是一个值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T13:00:39.263

在调试 js..我们没有得到准确的客户端宽度，因为它附加了 css 类。即使是空的 css 类或未定义的 css 类也会影响元素的宽度和高度。我们改为线型来解决问题。

# c# - 获取 ListView 中下拉列表上 selectedIndexChanged 上的 ListView 项的值

> ID：14415189
> 
> 赞同：3
> 
> 时间：2013-01-19T14:09:53.597
> 
> 标签：c#, asp.net, listview, drop-down-menu

我在该 ListView 的每一行中都有一个 ListView 和 DropDownList。您可以在该 DropDownlist 中更改指定人员（DropDownList 显示来自 MySql 数据库的数据）。

换人时，我需要做一些数据库操作。为此，我需要知道该人在哪个 ListView Row 上发生了更改，并且我需要知道该条目的值。

这是我的 aspx 文件：

```
<asp:ListView ID="manageAssigneesListView" runat="server" DataKeyNames="" OnItemDataBound="OnDataBound">            
                <ItemTemplate>
                    <div class="summaryRow">
                        <asp:Label ID="customerId" runat="server"><%# Eval("customerId") %>&nbsp;</asp:Label>    
                        <div style="width:200px; margin: 0px 5px; float: left;"><%# Eval("lastName") %>, <%# Eval("firstName") %></div>
                        <div style="width:120px; margin: 0px 2px; float: left;">Nr.</div>
                        <div style="width:200px; margin-left: 50px; float: right;">
                            <asp:DropDownList runat="server" ID="selectAssignee" Width="196" AppendDataBoundItems="true" OnSelectedIndexChanged="selectAssignee_OnSelectedIndexChanged" AutoPostBack="true">
                            </asp:DropDownList>
                        </div>
                        <div class="clear"></div>
                    </div>
                </ItemTemplate>
            </asp:ListView> 
```

这是我的代码隐藏：

```
protected void Page_Load(object sender, EventArgs e)
    {
        Helper.doAuth(Session, Response);

        if (!IsPostBack)
        {
            // load all customers without assignee
            MySqlCommand cmd = new MySqlCommand();
            MySqlConnection con = new MySqlConnection();
            con.ConnectionString = Helper.CONNECTION_STRING;
            cmd.CommandText = "SELECT customerId, lastName, firstName, assignee FROM customer WHERE assignee IS NULL ORDER BY customerId DESC";
            cmd.Connection = con;
            con.Open();
            MySqlDataAdapter sda = new MySqlDataAdapter(cmd);
            DataSet ds = new DataSet();
            sda.Fill(ds);
            manageAssigneesListView.DataSource = ds;
            manageAssigneesListView.DataBind();
            con.Close();

        }
    }

    protected void OnDataBound(object sender, ListViewItemEventArgs e)
    {
        DropDownList selectAssignee = (e.Item.FindControl("selectAssignee") as DropDownList);

        MySqlCommand cmd = new MySqlCommand();
        MySqlConnection con = new MySqlConnection();
        con.ConnectionString = Helper.CONNECTION_STRING;
        cmd.CommandText = "SELECT * FROM user where role = " + Helper.ROLE_SALESPERSON;
        cmd.Connection = con;
        con.Open();
        MySqlDataAdapter sda = new MySqlDataAdapter(cmd);
        DataSet ds = new DataSet();
        sda.Fill(ds);
        selectAssignee.DataSource = ds;
        selectAssignee.DataTextField = "emailAdress";
        selectAssignee.DataBind();
        con.Close();    
    }

    protected void selectAssignee_OnSelectedIndexChanged(object sender, EventArgs e)
    {
        DropDownList dropDownList = (DropDownList)sender;
        ListViewItem listView = (ListViewItem)dropDownList.NamingContainer;

        var test = listView.DataItem;
        string test2 = listView.FindControl("customerId").ToString();

        int rowIndex = (int)listView.DataItemIndex;
        Label lblMessage = (Label)listView.FindControl("customerId");
    } 
```

我成功获得了行的 DataItemIndex 我更改了 DropDownList 的值，DropDownlist 也在正确触发 onSelectedIndexChanged，但我需要的是标签“customerId”的值，我不知道如何获取这个值。

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T14:13:47.717

您需要使用`FindControl`来获取对 的引用`Label`，然后使用它的 Text 属性：

```
ListViewItem item = (ListViewItem)dropDownList.NamingContainer;
Label lbltCustomerID = (Label) item.FindControl("customerId");
string customerID = lblCustomerID.Text; 
```

顺便说一句，`ListViewItem.DataItem`总是`null`在回发。

**编辑**：

你应该设置`Text`标签的，所以而不是

```
<asp:Label ID="customerId" runat="server">
    <%# Eval("customerId") %>&nbsp;
</asp:Label> 
```

这

```
<asp:Label ID="customerId" runat="server"
   Text='<%# Eval("customerId") %>' >
</asp:Label> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:16:47.790

尝试直接从 ListView 中获取标签的值，例如

```
 DropDownList dropDownList = (DropDownList)sender;
        ListViewItem listView = (ListViewItem)dropDownList.NamingContainer;

        var test = listView.DataItem;
        string test2 = listView.FindControl("customerId").ToString();

        int rowIndex = (int)listView.DataItemIndex;
        Label label = (Label)manageAssigneesListView.Items[rowIndex ].Controls[0]; 
```

或者

```
 Label label = (Label)manageAssigneesListView.Items[rowIndex].FindControl("customerId"); 
```

并确保 ListView 不会每次都在回发时绑定

就像在 PageLoad 上加载的 ListView 不要忘记将其添加到：

```
if (!IsPostBack)
    {
      //Load ListView
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-30T09:50:58.437

即使它得到了回答，我的解决方案对我来说也很有效：

```
protected void myDdl_SelectedIndexChanged(object sender, EventArgs e)
    {
        DropDownList dropDownList = (DropDownList)sender;
        ListViewDataItem listView = (ListViewDataItem)dropDownList.NamingContainer;
        int rowIndex = listView.DataItemIndex;
        //Some logic
    } 
```

并不是说我使用豌豆制造者解决方案的 ListViewDataItem

# excel - 1\. 创建一个宏，从表 2 中查找表 1 中的值

> ID：14415190
> 
> 赞同：0
> 
> 时间：2013-01-19T14:10:04.180
> 
> 标签：excel, vba

问：创建一个宏，从表 2 中查找表 1 中的值

1.  要在工作表 1 中查找第 11 行到第 1000000 行的“F”列中的值。
    *   在“C”列中查找值表 1，第 11 到 1000000 行条件“仅具有内部颜色索引 RED 的单元格”
    *   Sheet 2 列“C & D”中的表格数组，第 4 行到第 1000000 行。
2.  在工作表 1 中创建一个按钮并将此宏分配给该按钮。

VBA 代码

```
Sub VA01()
    ' CREATING SALES ORDER
    Worksheets("sheet1").Range("C11:C1000000").Select
    finalrow = Cells(Rows.Count, 3).End(xlUp).Row
    For x = 11 To finalrow
        If Cells(x, 3).Interior.ColorIndex = 3 Then
            Cells(x, 6).Select
            ActiveCell.FormulaR1C1 = "=VLOOKUP(R11C3:R1000000C3,Sheet2!R4C3:R1000000C4,2,0)"
        End If 
    Next x
End Sub 
```

运行此宏会挂起 Excel 并需要更多时间来执行，它无法创建按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:39:19.393

首先，我会失去需要大量时间和资源的“选择”方法。另外，当后面的代码不使用此选择时，为什么要选择 ("C11:C1000000") 范围？那么我可能会保留 vlookup 部分，但只会保留不需要更新的值。那将是这样的：

```
Sub VA01()
' CREATING SALES ORDER
'Worksheets("sheet1").Range("C11:C1000000").Select
finalrow = Cells(Rows.Count, 3).End(xlUp).Row
For x = 11 To finalrow
    If Cells(x, 3).Interior.ColorIndex = 3 Then
        Cells(x, 6).FormulaR1C1 = "=VLOOKUP(R11C3:R1000000C3,Sheet2!R4C3:R1000000C4,2,0)"
        Cells(x, 6)=Cells(x, 6).Value
    End If 
Next x
End Sub 
```

# jquery - 如果第一个或最后一个孩子，JQuery 会阻止删除类？

> ID：14415193
> 
> 赞同：3
> 
> 时间：2013-01-19T14:10:19.217
> 
> 标签：jquery

我有一个“活动”类，它不断被删除并添加到其他 div 中。但如果它应用于第一个或最后一个孩子，我不希望它被删除......

JSFiddle：http: [//jsfiddle.net/YuDDK/1/](http://jsfiddle.net/YuDDK/1/)

HTML：

```
<div id="container">
<div class="item active"></div>
<div class="item"></div>
<div class="item"></div>
<div class="item"></div>
</div> 
```

JS：

```
$('#container').mousewheel(function(event, delta) {
    var active = $('.active');

    if (delta > 0) {
        if (active.not(":first-child")) {
            active.removeClass('active').prev().addClass('active');
        }

    } else {
        if (active.not(":last-child")) {
            active.removeClass('active').next().addClass('active');
        }
    }

    $(this).scrollTo( $('.active'),100);
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T14:18:42.880

`active.not(":first-child")`返回一个始终为的 jQuery 对象`true`，您可以使用`is`返回布尔值的方法来代替。

```
if ( !active.is(":first-child") ) 
```

# java - 单击按钮外部区域时激活按钮（Java/Blackberry App）

> ID：14415195
> 
> 赞同：2
> 
> 时间：2013-01-19T14:10:23.680
> 
> 标签：java, eclipse, blackberry, blackberry-simulator, blackberry-eclipse-plugin

我一直在为黑莓开发一个应用程序，它最初在屏幕上有两个按钮（`btn1`和）。`btn2`现在我添加了第三个，但我遇到了一些困难（`btn3`）。

最初是并排的，在按钮外部单击，但在其下方会激活按钮……这是一个设计缺陷，但可能会被忽略`btn1`。`btn2`

但是，我需要在下面添加一个按钮`btn1`，当我这样做时，发生了两件奇怪的事情：首先，即使我点击`btn3`了 BELOW `btn1`，焦点也会转移到`btn1`并被`btn1`调用。单击`btn2`将焦点转移到`btn3`并激活它。

我不完全确定为什么会这样，但我正在玩弄下面粘贴的代码。任何一点帮助表示赞赏。

```
 btn1 = new CustomButtonField("", Bitmap.getBitmapResource("button-disabled_1a.png"), Bitmap.getBitmapResource("button-normal_2.png"));      
    btn2 = new CustomButtonField("", Bitmap.getBitmapResource("button-disabled_3.png"), Bitmap.getBitmapResource("button-normal_4.png"));
    btn3 = new CustomButtonField("", Bitmap.getBitmapResource("button-disabled5.png"), Bitmap.getBitmapResource("button-normal_6.png"));

    Background bg = BackgroundFactory.createBitmapBackground(Bitmap.getBitmapResource("background.png"));

    HorizontalFieldManager vfm = new HorizontalFieldManager(){
        public int getPreferredHeight() {
            // TODO Auto-generated method stub
            return Display.getHeight();
        }

        public int getPreferredWidth() {
            // TODO Auto-generated method stub
            return Display.getWidth();
        }

        protected void sublayout(int maxWidth, int maxHeight) {
            // TODO Auto-generated method stub
            int count = getFieldCount();
            for(int i = 0 ; i < count ; i++ ){
                Field f = getField(i);

             if(f == btn1 ){
                 setPositionChild(f, (getPreferredWidth() >> 1) - f.getPreferredWidth(), getPreferredHeight()>>1);
                    layoutChild(f, getPreferredWidth(), getPreferredHeight());
                }else if (f == btn2 ){
                    setPositionChild(f, (getPreferredWidth() >> 1) +30, getPreferredHeight()>>1);
                    layoutChild(f, getPreferredWidth(), getPreferredHeight());
                }else if (f == lblName ){
                    setPositionChild(f, 30, getPreferredHeight()>>1 - btnLicense.getPreferredHeight());
                    layoutChild(f, ( getPreferredWidth() * 3 ) >> 2, getPreferredHeight());
                }else if (f == btn3 ){

                    setPositionChild(f, (getPreferredWidth() >> 1) - f.getPreferredWidth() -0 ,  getPreferredHeight()- getPreferredHeight()+280);
                    layoutChild(f, getPreferredWidth(), getPreferredHeight());
                }

            }
            setExtent(getPreferredWidth(),getPreferredHeight());
        }

        public void subpaint(Graphics graphics){
            int count = getFieldCount();
            for(int i = 0 ; i < count ; i++ ){
                net.rim.device.api.ui.Field f = getField(i);
                paintChild(graphics,f);
            }
        }

    }; 
```

自定义按钮字段

```
package com.app.ui.component;

import net.rim.device.api.system.Bitmap;
import net.rim.device.api.ui.Color;
import net.rim.device.api.ui.Field;
import net.rim.device.api.ui.Font;
import net.rim.device.api.ui.Graphics;

public class CustomButtonField extends Field {

    /** To set background image for button field */
    private Bitmap bkImage;

    /** To set Focus image for button field */
    private Bitmap bkFocusImage;

    /** int value for Field Width */
    private int fieldWidth;

    /** int value for Field Height */
    private int fieldHeight;

    /** Text to write on Button */
    private String text;

    /** Text Color on Button */
    private int textColor = Color.WHITE;

    /** Default Font for Button */
    private Font defaultFont = Font.getDefault();

    /**
     * Constructor with
     * @param text
     * @param image
     * @param focusImage
     */
    public CustomButtonField (String text, Bitmap image, Bitmap focusImage) {   
        this(text, image, focusImage, 0);
    }

    /**
     * Constructor with
     * @param text
     * @param image
     * @param focusImage
     * @param style
     */
    public CustomButtonField(String text, Bitmap image, Bitmap focusImage, long style) {
        super(Field.FOCUSABLE | style);
        this.text = text;
        bkImage = image;
        this.bkFocusImage = focusImage;
        fieldHeight = bkImage.getHeight();
        fieldWidth = bkImage.getWidth();
    }

    /**
     * To get the exact width needed by the field borderWidth - used to show the
     * width of focused rectangle around the button
     */
    public int getPreferredWidth() {
        return fieldWidth;
    }

    /**
     * To get the exact width needed by the field borderHeight - used to show
     * the height of focused rectangle around the button
     */
    public int getPreferredHeight() {
        return fieldHeight;
    }

    protected void layout(int width, int height) {
        setExtent(getPreferredWidth(), getPreferredHeight());
    }

    /**
     * To set the background according to focused state of the field
     */
    protected void drawFocus(Graphics graphics, boolean flag) {
        graphics.setFont(defaultFont);
        if (bkFocusImage != null) {
            graphics.drawBitmap((getPreferredWidth() - bkFocusImage.getWidth()) / 2,(getPreferredHeight() - bkFocusImage.getHeight()) / 2,
                    bkFocusImage.getWidth(), bkFocusImage.getHeight(),bkFocusImage, 0, 0);
        }
        graphics.setColor(Color.WHITE);
        int textWidth = defaultFont.getAdvance(text);
        graphics.drawText(text, (fieldWidth - textWidth) / 2,(fieldHeight - defaultFont.getHeight()) / 2);
    }

    protected void paint(Graphics graphics) {
        graphics.setFont(defaultFont);
        if (bkImage != null) {
            graphics.drawBitmap((getPreferredWidth() - bkImage.getWidth()) / 2,(getPreferredHeight() - bkImage.getHeight()) / 2,
                    bkImage.getWidth(), bkImage.getHeight(), bkImage, 0, 0);
        } 
        graphics.setColor(textColor);
        int color = (isEnabled())?Color.BLACK:Color.DARKGRAY;
        graphics.setColor(color);

        int textWidth = defaultFont.getAdvance(text);
        graphics.drawText(text, (fieldWidth - textWidth) / 2,(fieldHeight - defaultFont.getHeight()) / 2);
    }

    protected boolean navigationClick(int status, int time) {
        fieldChangeNotify(0);
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T10:05:57.427

当您第一次实现自定义 BlackBerry 按钮和字段时，这是一个很容易遇到的问题。首先，这里的问题是您的`CustomButtonField`类（从头开始编写的按钮字段）没有正确确定哪些触摸事件（或导航事件）*在其范围内*（在字段区域内）。

解决此问题的一种方法是修改您的`navigationClick()`方法，并实现该`touchEvent()`方法：

```
 protected boolean touchEvent( TouchEvent message )    {
      int x = message.getX( 1 );        
      int y = message.getY( 1 );        
      if( x < 0 || y < 0 || x > getExtent().width || y > getExtent().height ) {
         // Outside the field            
         return false;       
      }        

      switch( message.getEvent() ) {                  
      case TouchEvent.UNCLICK:                
         fieldChangeNotify(0);               
         return true;        
      }        
      return super.touchEvent( message );    
   }

   protected boolean navigationClick(int status, int time) {
      if (status != 0) {        // you did not have this check
         fieldChangeNotify(0);
      }
      return true;
   } 
```

我实际上推荐的另一种选择是将整个`CustomButtonField`课程替换为 BlackBerry[高级 UI 库中的一个示例](https://github.com/blackberry/Samples-for-Java)

您可以使用[BitmapButtonField](https://github.com/blackberry/Samples-for-Java/blob/master/Advanced%20UI/src/com/samples/toolkit/ui/component/BitmapButtonField.java)及其扩展的[BaseButtonField](https://github.com/blackberry/Samples-for-Java/blob/master/Advanced%20UI/src/com/samples/toolkit/ui/component/BaseButtonField.java)来实现相同的功能，并进行适当的触摸/单击处理。

当您在那里时，请查看该库中的其他一些 UI 类，因为您可能会发现它们非常有用。

# mocha.js - 反转摩卡的差异颜色输出？

> ID：14415199
> 
> 赞同：4
> 
> 时间：2013-01-19T14:10:36.300
> 
> 标签：mocha.js

例如，默认情况下，背景颜色为绿色或红色。我想让绿色/红色作为前景，背景作为我的默认颜色（白色）。

因为在浅色终端配色方案上真的很难看到任何东西，因为前景是黑色的，而背景会变成红色或绿色。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-01-02T15:33:21.640

在 mocha 源代码中，reporters 目录下有一个名为 base.js 的文件。在那里，您可以根据 bash 颜色指南更改颜色。[http://misc.flogisoft.com/bash/tip_colors_and_formatting](http://misc.flogisoft.com/bash/tip_colors_and_formatting)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-20T15:43:34.423

您可以将`project.json`test 条目更改`mocha -C`为禁用终端输出中的所有着色，以获得更好的可读性。

# c - Erlang NIF 来自单个进程在内存中存储结构

> ID：14415200
> 
> 赞同：2
> 
> 时间：2013-01-19T14:10:46.530
> 
> 标签：c, memory, erlang, erlang-nif

我正在编写一个 Erlang C NIF，它只会被一个 Erlang 进程使用。我想创建一个包含指针数组的结构。我需要它存在于进程对 NIF 的调用之间。

我需要了解的是从 Erlang NIF 方面执行此方法的正确方法。我正在考虑在所有函数之外编写一个结构，以便所有人都可以访问它。当我在对 NIF 的一次调用中创建它，然后返回并在对 NIF 的另一次调用中使用它时，它似乎工作得很好。

我担心这可能是因为进程停留在调度线程的本地，因此不必在内存中移动结构和底层数组。

我应该在函数中使用 erlang:memalloc 并避免一起使用全局变量，还是保持原样使用全局结构？

可能返回一个指向包含我所有数据的单个数组的指针？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-22T21:07:31.190

您当然可以返回一个指向包含您的数据的单个数组的指针；为此，请查看[ErlNifResourceType](http://www.erlang.org/doc/man/erl_nif.html#enif_open_resource_type)。您将把它传回给调用erlang进程，然后它会在随后的NIF调用中将它传回给您。这将确保一次只有一个线程在您的数据上运行（假设只有一个进程拥有资源的副本；这不是您想要共享的东西，尤其是在它包含指针的情况下）。

您也可以将其编码为 erlang 列表，但这可能效率非常低。

话虽如此，您***可以***使用 NIF 中的共享内存。例如，这是一个使用共享数据实现为 NIF[的类似 ets 的数据库。](http://www.github.com/fauxsoup/neural)

您只需要记住您正在访问共享资源。NIF API 提供[线程创建](http://www.erlang.org/doc/man/erl_nif.html#enif_thread_create)、[线程特定数据](http://www.erlang.org/doc/man/erl_driver.html#erl_drv_tsd_key_create)、[互斥体](http://www.erlang.org/doc/man/erl_nif.html#enif_mutex_create)、[条件](http://www.erlang.org/doc/man/erl_nif.html#enif_cond_create)和[读/写锁](http://www.erlang.org/doc/man/erl_nif.html#enif_rwlock_create)。您甚至可以从 NIF 创建的线程向 erlang 进程发送消息（在长时间运行的 NIF 调用的情况下，这实际上是您希望实现它以防止调度问题的方式）。

鉴于您的要求，您最好使用 ErlNifResource 类型，而不是使用多线程和共享资源控制。从技术上讲，如果您只使用一个 erlang 进程，则可以将其保留为全局变量（阅读：共享资源），而不会产生任何有害的副作用。话虽如此，事情会发生变化，当某人尝试从多个进程中使用您的代码时，您不希望成为他们头疼的原因。无论您最终使用哪种方法，请确保它是线程安全的。

# c# - 视频播放器播放视频

> ID：14415202
> 
> 赞同：0
> 
> 时间：2013-01-19T14:10:51.863
> 
> 标签：c#, xaml, windows-8, youtube

我想用`XAML`和 c# 在 Windows 8 应用程序中播放 youtube 视频。

我不想从 Windows 8 的 WebView 控件播放 youtube 视频我想从我自己的控件播放视频这可能吗？有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T00:05:03.860

在 CodePlex 上试用[MyToolkit](http://mytoolkit.codeplex.com/wikipage?title=YouTube&referringTitle=Documentation)。您可以使用 GetVideoUriAsync 获取 URI 以提供给 MediaElement。

```
var url = await YouTube.GetVideoUriAsync(youTubeId, YouTubeQuality.Quality1080P);
var player = new MediaElement();
player.Source = url.Uri; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:14:48.623

是的，您可以查看以下三个链接：

[YouTube API](https://developers.google.com/youtube/)

[通过代码管理 YouTube](http://www.codeproject.com/Articles/143669/Manage-YouTube-using-C-and-Youtube-API-1-6)

[示例如何使用 YouTube API 播放视频](https://developers.google.com/youtube/2.0/developers_guide_dotnet)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T14:18:22.100

首先是违反 YouTube TOS。

但是，如果您真的想这样做，首先您需要在发出请求时从 YouTube 的响应中提取流 URL。检查此代码并将其移植到 c#

[youtube-dl](http://rg3.github.com/youtube-dl/)

# c++ - 无法基于 STL 迭代器编写我自己的迭代器

> ID：14415203
> 
> 赞同：1
> 
> 时间：2013-01-19T14:10:54.687
> 
> 标签：c++, templates, stl, iterator

在尝试基于链表实现容器 Set 时，我遇到了一个小问题。是的，我知道有一个集合的 STL 实现，但这是家庭作业。:)

所以，这就是我到目前为止所做的：

我的 Set.h 文件如下所示：

```
template <class T>
class Set {
private:
    typedef std::list<T> base_container;
    base_container items;
public:
    class myIterator {
    public:
        typename base_container::iterator base_iterator;
        myIterator() { }
    };
    void addItem(const T item) {
        items.push_back(item);
    }
    typedef typename Set<T>::myIterator setIterator;
    setIterator begin() { return items.begin(); }
    setIterator end() { return items.end(); }
    Set<T>(void) { }
    ~Set<T>(void) { }
}; 
```

现在，main.cpp：

```
#include "Set.h"

int main(void) {
    Set<int> mySet;

    mySet.addItem(1);
    mySet.addItem(2);
    mySet.addItem(3);
    mySet.addItem(4);

    Set<int>::myIterator x;
    x = mySet.begin();       // produces an error about non-convertible types.

    return EXIT_SUCCESS;
} 
```

错误如下：

```
error C2664: 'Set<T>::myIterator::myIterator(const Set<T>::myIterator &)' : cannot convert parameter 1 from 'std::_List_iterator<_Mylist>' to 'const Set<T>::myIterator &' 
```

显然我把事情搞砸了，但我不确定代码的哪一部分实际上是问题所在。有关如何解决此问题的任何建议？任何有用的信息将不胜感激。

谢谢。:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:41:41.277

你的方法有很多问题。

正如其他人所说，您不能从基础类型创建迭代器类型：

```
setIterator begin() { return items.begin(); }
setIterator end() { return items.end(); } 
```

这可以通过向您的类型添加构造函数来解决：

```
class myIterator {
    typedef typename base_container::iterator base_iterator_type;
public:
    explicit myIterator(base_iterator_type i) : base_iterator(i) { }
    base_iterator_type base_iterator;
    myIterator() { }
}; 
```

此构造函数应该是显式的，这意味着您需要更改创建它的方式：

```
setIterator begin() { return setIterator(items.begin()); } 
```

下一个问题是你的类型没有实现迭代器接口，它没有提供`operator++`或`operator*`等等，它没有定义嵌套类型，例如，`value_type`它`iteratory_category`不是一个迭代器（只是给它一个带有“迭代器”的名称它不会使它成为真的！）

一旦你解决了这个问题并且你的类型是一个有效的迭代器，你会发现你的容器不能与 STL 风格的算法一起使用，因为它没有实现容器的要求。除其他外，它应该提供一个名为`iterator`not的嵌套类型`setIterator`，以便其他模板代码可以`S::iterator`在不关心`S`is a`std::set<T>`或 a 的情况下使用`Set<T>`。不叫`Set<T>::setIterator`，就叫吧`Set<T>::iterator`。同样在这种情况下，没有必要定义`myIterator`（没人关心它是你的！:-) 然后有一个 typedef 来调用它`setIterator`，只需首先用正确的名称命名类型，你就不需要 typedef。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T14:15:08.783

您可以派生`std::iterator<T>`并提供适当的迭代器类别标签。这将自动为您的迭代器提供所需的嵌套类型，例如`value_type`. `T`您仍然需要编写函数成员，例如`operator++`and `operator*`（取决于您的迭代器类别，例如，您还需要`operator[]`随机访问迭代器）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T14:16:08.890

问题在这里：

```
setIterator begin() { return items.begin(); }
setIterator end() { return items.end(); } 
```

您尝试返回的值类型错误。它们是 type`base_iterator`而不是`setIterator`，并且没有办法从前者隐式转换为后者。

# image-processing - 使用 OpenGL 进行 2D 到 3D 人脸重建

> ID：14415207
> 
> 赞同：-3
> 
> 时间：2013-01-19T14:11:08.390
> 
> 标签：image-processing, opengl-es, 3d, opengl-es-2.0, face-recognition

谁能告诉我如何在 OpenGL 中实现 2D 到 3D 人脸重建

我是 3D 图形和渲染的新手。谁能告诉我如何从 2D 图像进行 2D 到 3D 人脸重建。使用了哪些算法以及如何使用 OpenGL 来完成？相关功能。

输入：2D 正面人脸图像

输出：输入的 3D 重建

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T19:10:11.233

> 谁能告诉我如何在 OpenGL 中实现 2D 到 3D 人脸重建

你不能。OpenGL 是一个 3D 光栅化绘图 API。它用于将 3D 几何图形转换为 2D 图片，即与您想做的相反的方向。

> 输入：2D 正面人脸图像
> 
> 输出：输入的 3D 重建

*这是现实世界，不是CSI！*

您至少需要一些额外的输入才能将其转换为 3D 数据。图像的每个像素都是 2D 空间中的一个点，即在方程中提供 2 个变量。你想把它变成 3 个变量。或者换句话说，这是一个欠定方程组。

额外的输入可能是：

*   时间：如果你有一部电影，那么可以通过可见物体随时间的运动来推断它们在空间中的位置。
*   多角度的图像
*   使用特殊照明拍摄照片，以便像素的颜色提供有关深度的附加信息。

[华盛顿大学已经对此进行了研究](http://grail.cs.washington.edu/projects/)。我建议查看他们所有的论文！

训练有素的观察者模型，即我们的大脑在 2D 图片中推断物体深度的方法是非常不可靠的。只需查看任意[透视错觉](http://images.google.com/search?num=10&q=perspective%20illusion&oq=perspective%20illusion)即可了解原因。我们的大脑在解释图像方面比任何计算机程序都要好得多，但仍然可以被愚弄。

# php - MySQL：从 A 列获取对应于 B 列 MIN 的值

> ID：14415210
> 
> 赞同：1
> 
> 时间：2013-01-19T14:11:22.213
> 
> 标签：php, mysql, sql, select

我有下表：

```
 step_id    hospital_id     step_number     step_name
    17                  8            4          First Step
    18                  8            1          Second Step
    19                  8            2          Third Step
    20                  8            3          Finance Approval 
```

我想要做的是获取与最小步数相对应的 step_id。所以在上面的例子中，我正在寻找 step_id 18。

在查看了许多帖子后，我一直在尝试以下变体但无济于事：

```
SELECT `step_id`
    FROM `progress_steps`
    WHERE `hospital_id` = 8
    GROUP BY `step_id`
    HAVING MIN(`step_number`) 
```

它似乎对其他人有用，但上面返回了示例中的所有行以及我尝试过的其他变体只给我 step_id 17。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T14:12:49.323

您可以通过使用`ORDER BY`和`LIMIT`

```
SELECT  *
FROM    tableName
WHERE   hospital_id = 8
ORDER   BY  step_number ASC
LIMIT   1 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/fdd7b/1)

或者，如果您想获得具有相同最低的多行`step_number`，请使用子查询：

```
SELECT  *
FROM    tableName
WHERE   step_Number =
    (
        SELECT  step_Number
        FROM    tableName
        WHERE   hospital_id = 8
        ORDER   BY  step_number ASC
        LIMIT 1
    ) 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/fdd7b/2)
*   [SQLFiddle Demo（*有重复记录*）](http://www.sqlfiddle.com/#!2/9a82b/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T14:13:57.777

试试这个

```
SELECT `step_id`
FROM `progress_steps`
WHERE `hospital_id` = 8
Order BY `step_id` 
LIMIT 1 
```

# interface - 'UIWebView' 没有可见的@interface 声明选择器'initWithNibName:bundle:'

> ID：14415214
> 
> 赞同：1
> 
> 时间：2013-01-19T14:12:13.723
> 
> 标签：interface

首先我想说我是 Xcode 的新手，所以我是新手。然后我也想说你说我英语说得不太好……我正在学习它。

所以，我的问题是我收到以下错误：

> 'UIWebView' 没有可见的@interface 声明选择器'initWithNibName:bundle:'

我不知道为什么，我已经在许多其他论坛（以及这个）中搜索过这个，但是那里的解决方案对我没有帮助。如果我推一行，我想创建一个加载 UIWebView 的表视图。

那是我的代码：

```
 #pragma mark - Table view delegate
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (self.mehrWebView == nil)
    {
        UIWebView *temp = [[UIWebView alloc] initWithNibName:@"MyWebView" bundle:[NSBundle mainBundle]];
        self.mehrWebView = temp;
    }

    [self.navigationController pushViewController:mehrWebView animated:YES];
} 
```

我很沮丧，我不知道如何继续。我希望你能帮助我解决我的问题。

谢谢和最好的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:19:54.583

该`initWithNibName:bundle:`方法是`UIViewController`类的初始化器，而不是`UIView`类。另一方面，`UIWebView`是一个`UIView`类，所以 Xcode 正确地告诉你`UIWebView`缺少`initWithNibName:bundle:`方法。

此外，您不能将*视图*推送到导航控制器的堆栈上。您需要替换为笔尖`UIWebView`控制器的类型`@"MyWebView"`才能使其工作。

# java - LWJGL 上下滚动

> ID：14415218
> 
> 赞同：0
> 
> 时间：2013-01-19T14:12:36.963
> 
> 标签：java, opengl, lwjgl, slick2d

所以我试图在 LWJGL 和 Slick2D 中创建一个滚动系统，按顺序上下滚动项目：

```
import java.util.ArrayList;

import org.newdawn.slick.AngelCodeFont;
import org.newdawn.slick.Color;
import org.newdawn.slick.Graphics;
import org.newdawn.slick.Image;
import org.newdawn.slick.SlickException;
import org.newdawn.slick.UnicodeFont;

/**
* @author michael_daley
*
* Class which allows any number of high score entries to be loaded with an avatar.
* This list is then scrolled up the screen
*/
public class HighScores {

   private int x;
   private int y;
   private float scrollSpeed;
   private UnicodeFont font;
   private ArrayList<HighScore> highScores;

   /**
    * Constructor
    * 
    * @param x
    * @param y
    * @param scrollSpeed Speed at which to scroll the high scores
    * @throws SlickException
    */
   public HighScores(int x, int y, float scrollSpeed) throws SlickException{
      this.x = x;
      this.y = y;
      this.scrollSpeed = scrollSpeed;

      /* Set up the font we are using */
       font = ScreenDashboardHome.font;

       highScores = new ArrayList<HighScore>();
   }

   /**
    * Add a high score entry to the HighScore object
    * 
    * @param score Text to be printed in the high score table
    * @param avatar Image to be displayed in the high score table
    * @param spacing Spacing to be applied between each high score entry
    */
   public void addScore(String score, Image avatar, int spacing) {
      HighScore hs = new HighScore(x, y+ (highScores.size() * spacing), scrollSpeed, font, score, avatar);
      highScores.add(hs);
   }

   /**
    * Update the individual high scores which will update their location
    * 
    * @param delta milliseconds since last update passed from the main Update method
    */
   public void update(int delta, boolean direction) {
      for (int i=0; i < highScores.size();i++) {
         HighScore hs = highScores.get(i);
         hs.Update(delta, direction);
      }
   }

   /**
    * Render the high scores to the graphics context
    * 
    * @param g Graphics context to which items should be rendered
    */
   public void render(Graphics g) {
      for (int i=0; i < highScores.size();i++) {
         HighScore hs = highScores.get(i);
         hs.Render(g);
      }      
   }

   /**
    * @author michael_daley
    * 
    * Inner Class which is used to store information on each high score and perform an
    * update on that high score which will change its location on the screen
    */
   public class HighScore {

      private String score;
      private Image avatar;
      private float x;
      private float y;
      private float speed;
      private UnicodeFont font;
      private Color c;
      private Color c2;

      public HighScore(float x, float y, float speed, UnicodeFont font2, String score, Image avatar) {
         this.font = font2;
         this.x = x;
         this.y = y;
         this.speed = speed;
         this.avatar = avatar;
         this.score = score;
         this.c = new Color(255, 255, 255, 1.0f);
      }

      /**
       * Update this highscore which will change its location and alpha
       * 
       * @param delta milliseconds since last update
       */
      public void Update(int delta, boolean direction) {
        if(direction == true){
          y -= speed;
          }else if(direction == false){
              y += speed;
          }
         if (y <= 300) {
            y = 1100;
         }
         if (y >= 1200) {            
          y = 299;           
          }
         System.out.println(y);
         /* Adjust the alpha of scores entering the screen */
         /* TODO: Come up with a better way to fade scores onto and off the screen */
         if (y > 800) {
            c = new Color (255, 255, 255, (600 - y) / 200);
         } else {
            c = new Color(255, 255, 255, 1.0f);
         }
         if (y > 800) {
             c2 = new Color(256,256,256,(600 - y) / 200).multiply(new Color(0,160,209));
          } else {
             c2 = new Color(0,160,209);
          }
      }

      /**
       * Render the highscore to the graphics context
       * 
       * @param g Graphics context to render too
       */
      public void Render(Graphics g) {
         g.setColor(c);
         g.drawRect(x, y, 500, 170); // tweet 1
         g.setColor(c2);
         g.fillRect(x + 1, y + 1, 499, 169);
         g.setColor(c);  
         g.drawRect(x + 1, y + 1, 82, 82); // tweet 1
         avatar.getScaledCopy(80, 80).draw(x + 2, y + 2, c);
         font.drawString((x + avatar.getWidth()) + 15, y, score, c);
         g.setColor(Color.white);
      }   
   }
} 
```

但是它像这样堆叠它们：![图片](../Images/0a7582becbe6a9c570caa5646c5e3a61.png) 任何人都可以解释我做错了什么，并为我提供一些更好的代码吗？

# ruby - 带双引号的正则表达式

> ID：14415224
> 
> 赞同：3
> 
> 时间：2013-01-19T14:13:09.443
> 
> 标签：ruby, regex

给定引号之间的字符串，例如“Hello”

以下正则表达式将打印出不带双引号的字符串匹配：

```
/"([^"]+)"/ 
```

我不明白它是如何捕捉角色的。我相信这应该捕获的只是最初的双引号。这个正则表达式的意思是找到一个以双引号开头和结尾的表达式，并且在开头有一个或多个双引号。它会在开头捕获一个或多个双引号。它如何最终将此处的字符串与 匹配`[^"]+`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T14:16:21.983

该表达式的`[^"]+`字面意思是匹配所有不是双引号的字符`"`。因此，当放置在 内部时，将捕获第一个和下一个`()`之后的所有字符。这是因为字符类的内部意味着*否定*，而不是字符串的开头，因为它意味着. 所以字面意思是*除了 a 之外的任何东西*。`"``"``^``[]`*`[]``[^"]`*`"`**

 *本身就是捕获组，`()`正则表达式只会捕获存在于内部的表达式`()`。根据您使用的编程语言，它也可能将`"Hello"`整个表达式匹配的整个字符串记录`/"([^"]+)"/`在一个单独的变量中，但目的`()`是捕获其内容。

表达式的完整分解：

*   `"` - 第一个字面引用
*   `(` - 开始捕获
*   `[^"]+`所有后续字符，但不包括`"`
*   `)`- 结束捕获组
*   `"`- 最后的结束引号文字*

# javascript - 向下滚动时如何让“背景图像”的一部分仍然可见

> ID：14415225
> 
> 赞同：1
> 
> 时间：2013-01-19T14:13:27.307
> 
> 标签：javascript, html, css

我最近在使用新的 Wordpress 网站时遇到了两难境地。我想知道当我在页面中向下滚动时如何保持部分标题图像可见。现在，我的标题图像是页面高度的 75%，但是当我向下滚动时，图像会按原样消失。但我想要的是，它的某个部分，比如说 20%，在“固定”位置保持在顶部可见。

所以，要恢复图片：

我没有滚动的东西：

[http://i.stack.imgur.com/2NxcQ.jpg](http://i.stack.imgur.com/2NxcQ.jpg)

向下滚动时我想要什么：

[http://i.stack.imgur.com/nwoQw.png](http://i.stack.imgur.com/nwoQw.png)

不过，我不知道我是否足够清楚，感谢所有愿意帮助我的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:45:21.240

您可以使用 jquery 插件，例如[sticky](https://github.com/garand/sticky)：

```
<div class="top">Content</div>
<div class="header"></div>
<div class="content">
   ....
</div> 
```

然后对于 CSS，您应用您的图像：

```
.header
{
    background-image: url('http://placekitten.com/200/300');
    height:300px;
    width: 100%;
} 
```

然后在你的js中，你可以使用sticky插件：

```
$(".header").sticky({topSpacing:-250}); 
```

请注意间距偏移上的负数，它允许滚动大部分图像。

小提琴示例：http: [//jsfiddle.net/CZYav/2/](http://jsfiddle.net/CZYav/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:13:26.593

我在这里有一个演示：http: [//jsbin.com/ubolos/1/edit](http://jsbin.com/ubolos/1/edit)

当您发现用户向下滚动太远时，只需继续跟踪您的滚动距离并修改 的`background`属性。`div`不需要 jQuery 的其他插件。

# android - 安卓手写识别

> ID：14415226
> 
> 赞同：5
> 
> 时间：2013-01-19T14:13:32.970
> 
> 标签：android, gesture-recognition, handwriting-recognition

我需要分析android手写识别SDK。谁能告诉我市场上有哪些 SDK。我从 VisionObjects 找到了[MyScript](http://www.visionobjects.com/en/myscript/about-myscript/)，但我无法从 SDK 中找到任何下载链接，因为我需要测试才能看到准确性。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-28T14:44:15.750

我正在为 MyScript 工作，您可以在此处尝试使用 Web 服务进行在线识别：[https](https://dev.myscript.com/developer-program/register/) : //dev.myscript.com/developer-program/register/ 如果您只想尝试 MyScript 的准确性，您可以尝试我们的网络演示[http://webdemo.myscript.com/](http://webdemo.myscript.com/)

编辑：Vision Objects 公司更名为 MyScript，所以我编辑了链接

# c - 递归查找数组的最大元素

> ID：14415230
> 
> 赞同：3
> 
> 时间：2013-01-19T14:13:56.170
> 
> 标签：c, recursion

我有这个功能：

```
int max(int arr[], int size)
{
    size--;
    if(size > 0)
    {
        int max = max(arr, size);
        if(arr[max] > arr[size]) return max;
    }
    return size;
} 
```

当然它有效。我的问题是 - 这是如何工作的？有人可以一步一步地解释我吗？现在是星期六，所以也许有人有一点时间：DI 特别是指 if 块中的这两行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:24:07.163

让我们以这个数组为例：

```
int arr[] = { 42, 54, 23 };
max(arr, 3); 
```

此函数通过检查当前元素的最大值与所有先前元素的最大值来工作。这是堆栈调用的表示：

```
max(arr, 3)
    max(arr, 2)
        max(arr, 1)
            return 0
        arr[0] (arr[max] = 42) <= arr[0] (arr[size] = 42) => return size (0)
    arr[0] (arr[max] = 42) <= arr[1] (arr[size] = 54) => return size (1)
arr[1] (arr[max] = 54) > arr[2] (arr[size] = 23) => return max (1) 
```

*注意：*用相同的标识符命名变量和函数是个坏主意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T14:28:18.227

你的代码如下：

```
1 int max(int arr[], int size){
2     size--;
3     if(size > 0){
4         int max = max(arr, size);
5         if(arr[max] > arr[size]) return max;
6     }
7     return size;
8 } 
```

您可以通过传递数组和该数组的大小（或长度）来调用它。

代码命中的第一个重要点是在第 4 行，它递归地调用自身。但请注意，在第 2 行，大小减少了 1。因此，您可以将 size 视为一个索引，该索引引用当前对函数的调用所考虑的数组元素。

这意味着最终，数组的大小将降至零，我们将查看数组的第一个元素。此时跳过第 3 行到第 6 行，返回 0。

当其中一个递归调用返回时，我们将回到第 4 行。

对于第一次返回，这意味着`int max = 0;`.

现在我们将第零个元素与第一个元素进行比较。我们返回较大的索引。下一个比较将在第二个元素和前两个元素中较大的一个之间进行。

这一直持续到所有递归调用都返回，此时最大元素的索引返回给调用函数。

请注意，`return size;`应将其替换为`return 0`以增加清晰度。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T14:29:32.603

让我们逐步解决`arr[] = [1,2]`这意味着调用的问题`max(arr[], 2)`

```
size--; // 2-1 = 1
if(size > 0) //True
    {
        int max = max(arr, size); //Going into the recursive call 
```

这是递归运行：

```
 size--; // Now 1-1 = 0
    if(size > 0) //False
    return size; //0 returned 
```

现在回到调用函数：

```
 int max = 0 //From return
        if(arr[max] > arr[size]) //arr[0]>arr[1] which is false 
    }
    return size; //Now, control reaches here and 1 is passed back to the calling scope
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-19T14:45:04.130

![在此处输入图像描述](../Images/92977b48068a02ce048287148f3fb5df.png)

抱歉，图表格式不佳

# algorithm - 为什么插入排序的最佳情况是 O(n) 而不是 O(n^2)？

> ID：14415233
> 
> 赞同：9
> 
> 时间：2013-01-19T14:14:02.567
> 
> 标签：algorithm, sorting

我很难理解为什么在 o(n) 中插入排序的最佳情况？

```
 for (int i = 0; i < size; i++) {

                for (int j = i; j > 0; j--) {
                    int k = j-1;
                        if( a[j] < a[k]){
                            int temp = a[j];
                            a[j] = a[k];
                            a[k] = temp;
                        }

                }
     } 
```

让我们考虑一个示例初始数组 [1,2,3,4,5] size = 5 第一个循环将从 i = 0 变为 size - 1，第二个循环将从 i 变为 1 但假设，内部 for 循环也可以从 0 到 size - 1 换句话说，内部 for 循环也执行 (n-1) 次，类似于外部 for 循环我同意不会有交换，但会有比较，并且它将与未排序的数组完全相等？然后 n-1 (外循环) * n - 1(内循环) = n^2 - n + 1 = O(n^2)
谁能解释我哪里错了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-06-11T06:46:40.893

起初，这似乎不是插入排序的正确代码。您似乎正在以相反的方式使用冒泡排序代码。
在插入排序代码中，您不会用落在它之前的每个大元素替换一个小元素，而是我们略过落在它之前的所有大元素，并且只有当我们处于没有任何元素的地方或那里时不再是大元素，然后我们将小元素放在那个地方并移动/移动所有其他后续元素。

作为 O(n) 时间的一部分：
让我们考虑一个包含五个已排序元素的数组 - arr[11,13,15,17,19]。我们从第一个位置元素移动到最后一个位置。
**第 1 步：**取元素 11，因为它是第一个元素，我们保持原样。
**Step 2:**取元素 13, 寻找在它之前的元素(即元素 11), 因为 13>11, 因此不需要再寻找落在 11 之前的元素。
**Step 3:**取元素 15, 寻找元素落在它之前（即元素 13），因为 15>13，因此不再需要查看落在 13 之前的元素。
**步骤 4：**取元素 17，寻找落在它之前的元素（即元素 15），如17>15，因此不再需要查看 15 之前的元素。
**步骤5：**取元素19，寻找落在它之前的元素（即元素17），因为19>17，因此不再需要寻找落在17之前的元素。

正如我们看到的，对于五个已经排序的元素，我们只需要 5 次比较，因此对于“n”个排序的元素，我们只需要 O(n) 次比较。

我希望上面的例子能澄清你的疑问。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-19T14:19:15.190

您的代码始终在 O(n^2) 中运行。当你找到元素应该在的位置时，你必须打破内部 for 循环。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-08-31T00:16:18.973

考虑以下插入排序的实现：

```
 for (i=1; i<n; i++) {
        j=i;
        while ((j>0) && (s[j] < s[j-1])) {
            swap(&s[j],&s[j-1]);
            j = j-1;
        }
    } 
```

任何排序算法的最佳情况是输入已经排序。在这种情况下，while 循环的条件总是返回 false，因此它只迭代外部 for 循环，以 O(n) 时间复杂度在线性时间内完成这项工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-19T14:17:35.860

这是实现插入排序的一种方法。

获取一个输入列表和一个最初为空的输出列表。

遍历输入列表并将每个项目放置在输出列表上的适当位置。从第一个元素开始遍历输出列表，找到合适的位置。

现在，如果您的输入已经排序，那么插入点将始终位于输出列表的开头或结尾。第一种可能性对应于最好的情况；第二个对应于最坏的情况。

例如，我的输入数据是：4 3 2 1。

然后输出列表构建为：

```
4
3 4
2 3 4
1 2 3 4 
```

由于查看第一个元素只需要 O(1)，因此时间复杂度在于输入的大小或 O(N)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T14:28:32.917

当数组已经排序时，插入排序的最佳情况是**O(n) 。**

但是您的算法仍将 O(n^2) 用于排序情况。因此，仅当条件失败时，您才应该进入第二个循环。这样，在排序列表的情况下，您将永远不会进入内部循环。

检查以下链接：[http ://www.personal.kent.edu/~rmuhamma/Algorithms/MyAlgorithms/Sorting/insertionSort.htm](http://www.personal.kent.edu/~rmuhamma/Algorithms/MyAlgorithms/Sorting/insertionSort.htm)

[http://en.wikipedia.org/wiki/Insertion_sort](http://en.wikipedia.org/wiki/Insertion_sort)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-27T06:41:28.303

更改您的方法以具有此中断条件，您将获得最佳案例复杂度为 O(n)。

```
 void insertionSort0(List<Integer> list)
{
    int loop=0;
    for(int i=1;i<list.size();i++)
    {
        int target=(Integer)list.get(i);
        int pos=0;

        for(int j=i-1;j>=0;j--)
        {
            loop++;
            if((Integer)list.get(j)>target)
            {
                list.set(j+1, (Integer)list.get(j));
                pos=j;
            }
            else
            {
                break;
            }

        }

            list.set(pos, target);

    }
    System.out.println("loop in for insertion sort" +loop);
} 
```

# html - twitter bootstrap 2列固定布局损坏

> ID：14415236
> 
> 赞同：0
> 
> 时间：2013-01-19T14:14:17.683
> 
> 标签：html, css, layout, twitter-bootstrap

我的网站 [http://whoisdomains.co.uk/](http://whoisdomains.co.uk/)

正在使用 twitter 引导 [http://twitter.github.com/bootstrap/index.html](http://twitter.github.com/bootstrap/index.html)

我正在尝试使用两列布局 [http://twitter.github.com/bootstrap/scaffolding.html#gridSystem](http://twitter.github.com/bootstrap/scaffolding.html#gridSystem)

他们给出的代码是

```
<div class="row">
  <div class="span4">...</div>
  <div class="span8">...</div>
</div> 
```

然而，我将 8 和 4 左右交换，但不明白为什么这会有所作为。正如您从我的网站上看到的那样，我在其中放入了一些虚拟文本，但其损坏和重叠

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T14:21:20.837

您的跨度中有 2 个非常长的单词，因此它们不能被包装。将一些空格字符放入单词中，它将对齐，如下所示：

```
<div class="span8">dskjdskjdskjlsdjlsdj ldjslkd sjkldsjklsdjlsdkjskldj ldksjldskjklsdjl dkjdlsjsdkjkladmdklmc kldmslkcmdlasmkmlkdjslkaj dlkjdsakjsdljlk sjljds</div>
<div class="span4">dkjsasdjsdhakhfl kjhdlkah fklhskldfha skjdhfk hsdklhfkjsdh ajklhfjklshadl kfhsjkadhfkjlh dsfjlhjaksdhfjk hjhdsajlkhdfljhasd ljhflkdhlkfhlkhdskfd</div> 
```

如果您使用诸如萤火虫之类的控制台检查页面，您会看到跨度 div 的宽度是正确的。

# scope - angularjs 嵌入范围访问

> ID：14415241
> 
> 赞同：7
> 
> 时间：2013-01-19T14:14:58.437
> 
> 标签：scope, angularjs, transclusion

我已经设置了一个带有标题和应用/取消按钮的通用对话框指令。该对话框有一个孤立的范围。

对话指令的内容是嵌入的，因此它的范围是对话范围的兄弟：

来自 Angular js 文档：

> 然而，隔离作用域产生了一个新问题：如果一个嵌入的 DOM 是小部件隔离作用域的子对象，那么它将无法绑定到任何东西。由于这个原因，在小部件为其局部变量创建隔离范围之前，被嵌入的范围是原始范围的子级。这使得 transcluded 和 widget 隔离范围兄弟姐妹。

不过，这对我来说是一个新问题。被嵌入的 DOM 应该能够在应用时响应对话框。因此，我想在对话框上设置一个“应用”属性并让嵌入的 DOM 观看它。这是不可能的，因为他们是兄弟姐妹！

我哪里错了？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-21T02:08:53.537

我遇到了类似的事情，有两种方法（我知道）可以直接访问嵌入的范围。

第一种是在编译函数中自己创建作用域，然后将其与克隆链接函数一起传递给 transclude 链接函数：

```
function compileFn(tElement, tAttrs, transclude) {
    return linkFn;
    function linkFn(scope, element, attrs) {
        scope = scope.$new();
        scope.name = attrs.works1;
        transclude(scope, function(clone) {
            element.find('div').append(clone);
        });
    };
} 
```

第二个是创建一个控制器并注入预先绑定到新范围的 $transclude 服务。您的克隆链接函数将接收新范围作为其第二个参数：

```
function Controller($element, $attrs, $transclude) {
    $transclude(function(clone, scope) {
        scope.name = $attrs.works2;
        $element.find('div').append(clone);
    });
} 
```

在这两种情况下，您都必须提供一个克隆链接函数来自己进行嵌入，而不是使用 ngTransclude。

有关两者的示例，请参见[http://jsfiddle.net/dbinit/wQC7G/6/](http://jsfiddle.net/dbinit/wQC7G/6/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T17:49:03.793

好的，我想我找到了解决方案。我已经将实际对话框包装在一个定义对话框范围的指令中。对话框的内容仍然被嵌入在对话框中，但由于它将从`parent of the dialog`(!!) 中获取它的父范围，而不是对话框本身（嵌入以这种方式工作），这将很好地工作。

此外，我可以让 sg-import 指令在应用对话框时通过在对话框上使用 a 来响应`&property`。当对话框被应用时，我让它`sg-apply`在父范围的上下文中评估函数（范围是自动完成的，我只需要从控制器的 apply() 函数中调用该方法）。

```
<div sg-import>
    <div 
        sg-dialog title="Import Photographs" 
        visible="show_import_dialog" 
        sg-apply="upload()"
    >
        <div class="drop-zone">
            <div sg-photo title="{{ file.name }}">
            </div>
            <input type="file" multiple />
        </div>
    </div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-29T13:54:30.247

如果您愿意在共同祖先中创建一个模型来充当具有 $watch 目标的交换机，您可以使用预先存在的工具来使每个指令发生变异和/或监视该交换机模型。组件的访问模式和内容内容的控制器对每个范围都有两个 fery idfferent 调用签名，并且对于嵌入的情况有一个轻微的“陷阱”。

## 具有双向绑定的隔离范围

当注册指令的隔离作用域时，=attrName" 将导致检查名为 "attrName" 的 domainName 属性。Angular 将设置双向绑定，以便对任一作用域模型中的值的更改也会影响同级作用域中的模型.

# 例子

在控制器-parent.js 中：

```
module.controller( 'ParentController', function() {
    $scope.switchboard = { };
} 
```

在指令-sg-dialogue.js

```
return {
    scope: {
  isolatedPeer: "=dialogModel"
}; 
```

...在指令元数据中...

```
<div ng-controller="ParentController">
    <sg-dialog dialog-model="switchboard">
        <div ng-controller="ChildController"></div>
    </sg-dialog>
</div> 
```

...在某些应用程序视图模板中，并且...

```
$scope.switchboard = { isApplied: false } 
```

...在绑定到应用程序视图模板的控制器中...

那么你们都准备好了...

```
$scope.$watch( 'switchboard.isApplied', function(newValue, oldValue) { }) 
```

...在共同祖先中，并在...之后获得回调

```
isolatedPeer.isApplied = true; 
```

...在孤立的范围内。

## 原型继承

只要您没有在嵌入子项中显式设置 $scope.swtichboard，您就可以从被嵌入子项中的角度表达式访问“switchboard.isApplied”，并让插值引擎“找到”由父控制器在其自己的范围内。

例如，当配对对话框关闭时，将调用以下回调：

```
$scope.$watch( 'switchboard.isApplied', function(newValue, oldValue) { } ); 
```

这是可行的，因为被嵌入的孩子总是被赋予一个基本的范围，而不是一个孤立的范围。

希望这有帮助！

# nginx - nginx重写规则缺少斜杠

> ID：14415246
> 
> 赞同：1
> 
> 时间：2013-01-19T14:15:23.297
> 
> 标签：nginx, rewrite

我有一个缩略图类，它也接受外部主机。它现在像这样工作：

```
http://mysite.com/resize/src=http://google.com/logo.png&w=50&h=50 
```

我想用我的“resize.mysite.com”子域使它成为干净的 url，如下所示：

```
http://resize.mysite.com/400x200/http://google.com/logo.png 
```

我几乎用这个重写规则完成了它：

```
rewrite ^/([^x]*)x([^/]*)/(.*)$ /resize.php?w=$1&h=$2&src=$3 last; 
```

但它在“http:”之后发送没有第二个斜杠的“src”，它会导致调整类错误，如下所示：

```
http:/google.com/logo.png
http://google.com/logo.png (what I expect) 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:28:27.553

首先想到的是您在`nginx`配置文件中的某处使用了特殊指令`merge_slashes`，这是真的吗？如果是并且您正在使用，`merge_slashes on`那么您所有带有双倍或三倍等斜线的请求都将作为一个斜线出现。

设置指令可以解决您的问题`merge_slashes off`吗？

# jquery - 无法使用 jQuery 表单插件发布数据

> ID：14415249
> 
> 赞同：3
> 
> 时间：2013-01-19T14:15:43.430
> 
> 标签：jquery, jquery-plugins

我有以下代码（工作正常），我想将其更改为 jQuery Form Plugin ajaxForm() ：

```
$("#replysubmit").click(function() {
    var msg = $("#message").val();
    var attach = $("#attach").val();
    var id = $("input[name=hidden-ticketID]").val();
    if(msg == "") {
            alert("not null");
            $("#message").focus();
            return false;
        }
    $.ajax({
        type: 'POST',
        dataType: 'json',
        url: '/TicketSystem/support/view',
        async: false,
        data: {id: id, msg: msg, attach: attach},
        success: function(json) {
            $.post('/TicketSystem/support/ajaxmsg', { date: json.date, msg: json.msg }, 
            function(data){
                var newData = $('<div>').addClass('msgBlock').html(data).hide();
                newData.appendTo($('.msgWrapper')).slideDown('normal');
                goToByScroll('reply-form');
            });
            $("#message").val('');
            $("#attach").val('');
        }
    });
    return false;}); 
```

这是我写的 ajaxForm() ：

```
$(document).ready(function() { 
var msg = $("#message").val();
var attach = $("#attach").val();
var id = $("input[name=hidden-ticketID]").val();
var options = { 
    //target:        '#output1',   // target element(s) to be updated with server response 
    beforeSubmit:  showRequest,  // pre-submit callback 
    success:       showResponse,  // post-submit callback 

    // other available options: 
    url: '/TicketSystem/support/view',
    type: 'POST',
    dataType: 'json',
    data: {id: id, msg: msg, attach: attach},
    //clearForm: true        // clear all form fields after successful submit 
    //resetForm: true        // reset the form after successful submit 

    // $.ajax options can be used here too, for example: 
    //timeout:   3000 
}; 

// bind form using 'ajaxForm' 
$('#user-reply-form').ajaxForm(options); }); 
```

来自 ajaxForm 的发布数据很奇怪......而且我的 php 代码无法从它接收任何东西，除了文件上传现在可以工作。

# node.js - 蒙古语或 mongo-native 不支持组功能？

> ID：14415262
> 
> 赞同：1
> 
> 时间：2013-01-19T14:17:24.440
> 
> 标签：node.js, mongodb

伙计们

在 node.js 中，不支持 mongolian 或 mongo-native 的 group 功能？

mongo本机代码，

```
var mongodb = require('mongodb');
var Db      = mongodb.Db;
var Server  = mongodb.Server;
var db  = new Db( "test", new Server( "localhost", 27017 ), { w:0 } );

db.collection( "user" ).group( {
    key: { },
    reduce: function ( curr, result ) { },
    initial: { }
} ); 
```

结果，

```
/node/ex1/node_modules/mongodb/lib/mongodb/collection.js:1400
      if(err != null) return callback(err);
                             ^
TypeError: undefined is not a function
    at Collection.group.scope (/node/ex1/node_modules/mongodb/lib/mongodb/collection.js:1400:30)
    at Db._executeQueryCommand (/node/ex1/node_modules/mongodb/lib/mongodb/db.js:1812:12)
    at Collection.group (/node/ex1/node_modules/mongodb/lib/mongodb/collection.js:1399:13)
    at Object.<anonymous> (/node/ex1/repository.js:34:25) 
```

* * *

和蒙古语代码，

```
var Mongolian   = require( "mongolian" );
var server  = new Mongolian;
var db      = server.db( "test" );

db.collection( "user" ).group( {
    key: { },
    reduce: function ( curr, result ) { },
    initial: { }
} ); 
```

结果，

```
db.collection( "user" ).group( {
                        ^
TypeError: Object Mongolian[mongo://localhost:27017]/assistor.user has no method 'group'
    at Object.<anonymous> (/node/ex1/repository.js:77:25) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:57:43.927

[如文档](http://mongodb.github.com/node-mongodb-native/api-generated/collection.html#group)中所见，本机驱动程序支持它，但该`group`方法将`key`,`reduce`等作为单独的参数，而不是像 shell 那样的对象中的字段：

```
db.collection("user").group(
    {},
    {},
    { sum: 0 },
    function (curr, result) { },
    function (err, result) {
        // Process the result
    }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T03:06:27.163

npm 的 mongolian 包没有更新，您必须克隆 git 存储库，然后将其与 npm 链接。

然后文档不完整，你必须做这样的事情，我花了一段时间才让它工作。

```
var Mongolian   = require( "mongolian" );
var server  = new Mongolian;
var db      = server.db( "test" );

db.collection( "user" ).group( {
    ns: "user",
    key: { },
    reduce: function ( curr, result ) { },
    initial: { }
   },function(error,post){
      if(error) console.log(error);
      //do something with post.retval
   }
); 
```

# php - 如何使 php 脚本仅接受来自某个应用程序的数据

> ID：14415265
> 
> 赞同：0
> 
> 时间：2013-01-19T14:18:07.970
> 
> 标签：php, controls

我正在制作一个与我服务器上的 php 页面通信的应用程序。

使用该页面，我可以将分数设置到数据库中。

我使用 post 变量将分数存储在 db 中，一切正常，但如果我使用 Wireshark 分析我的游戏发送到页面的内容并使用不同的数据重新执行 POST 请求，则页面将该数据存储在 db 中.

我怎样才能接受仅从我的游戏中存储的数据？

游戏是一个Java小程序，服务器是用PHP写的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:29:03.047

您需要一种方法让 php 脚本知道收到的数据是真实的。

**客户端**

将所有要发送的数据连接成一个字符串。将当前日期和时间（客户端）也放入字符串中。您也需要发送该信息。

然后用更多数据“加盐”字符串，例如静态字符串“ *xyw#q''wz* ”或更好的从发送的数据中派生的东西。

让我们称该字符串为**检查字符串**

最后计算**校验字符串**的 MD5 哈希值并将其与您的数据以及当前日期和时间一起发送。

**服务器端**

php 脚本接收所有数据和 MD5 哈希。

对收到的数据执行相同的操作（连接、加盐等）以重新构建**check-string**，与您在客户端执行的方式完全相同。

计算其 MD5 并比较两个哈希值：接收到的哈希值和刚刚计算的哈希值。

如果它们匹配，则数据是真实的并且可以添加到数据库中。否则不是或已重新发布。

-

**概括**

客户端：数据 -> 构建字符串 -> 从字符串生成 MD5 -> 发送数据和 MD5

服务器：数据（已接收）-> 构建字符串-> 从字符串生成 MD5

（客户端 MD5 == 服务器端 MD5）？是的数据真实：没有伪造或转发

-

**这个怎么运作**

对于任何一组数据，只有一个有效的 MD5 散列。如果有人想发布虚假数据，他也需要通过有效的 MD5。但是他不知道MD5是怎么建立起来的。

为了让黑客更难，我告诉你用一些随机数据“加盐”字符串。

这只是实现您想要的一种方式（我认为更容易）。

请注意，如果客户端应用程序是用 JavaScript（而不是 Java）编写的，那么这种方法将非常容易受到攻击，因为 JS 代码会暴露构建**检查字符串**的过程。

**最后一点：**这不是防弹的。聪明的黑客仍然可以*猜出*您是如何构建**检查字符串**或反编译 Java 的，并且（通过一些努力）找到**检查字符串**是如何构建的，以便为他的假数据生成 MD5。

# javascript - 如何将对象参数传递给 JavaScript 中的函数

> ID：14415267
> 
> 赞同：-1
> 
> 时间：2013-01-19T14:18:28.840
> 
> 标签：javascript, node.js

我的 server.js 是

```
// server.js - the outer server loop
var http = require('http')
 ,  php = require("./phpServer");

function start() {
    function onRequest(request, response) {
        php.phpServer('D:/websites/coachmaster.co.uk/htdocs',request, response);
        response.write('Ending');
        response.end();
    }
    http.createServer(onRequest).listen(80);
    console.log("Server started.");
}

exports.start = start; 
```

这将调用 php.phpServer 每个请求，并将响应作为第三个参数。

phpServer 包含。

```
//
//  phpServer.js - a generic server to serve static files and
//
var fs = require('fs')
 ,  pathfuncs = require('path')
 ,  url = require('url')
 ,  mimetypes = require('./mimetypes')

function phpServer(root, request, response) {
    // serve static or pass to php. 
    var data = url.parse(request.url);
    var ext = pathfuncs.extname(data.pathname);
    fs.stat(root+request.url, function(err, stat) {
        if (err || !stat.isFile()) { // error or not file.
            console.log('404');
            response.writeHead(404);
            response.write('Not Found');
            return;
        }
        // exists - serve.
        console.log("serve("+root+request.url+", mimetypes.mimetype("+ext+"))");
        response.writeHead(200, {'Content-Type': mimetypes.mimetype(ext)});
        response.write('Somethign to serve');
        // fs.createReadStream(root+request.url).pipe(response);
    });
}

exports.phpServer = phpServer 
```

正如我所看到的，响应是一个对象并且通过引用传递，因此这里的 response.write() 应该写入响应。

它没有。此处的响应与 onRequest 中的响应不同，因此 phpServer 中的任何内容都不会发送到浏览器 - 不是代码或内容。

console.logs 出来并显示了我的期望。

如何获得传递的对象响应以便我可以调用 write ？

------------- 稍后添加 -------------------

我已经尝试应用给定的答案和 server.is 现在的代码

```
// server.js - the outer server loop
var http = require('http')
 ,  fs = require('fs')
 ,  pathfuncs = require('path')
 ,  url = require('url')
 ,  mimetypes = require('./mimetypes')

function phpServer(root, request, res) {
    // code adapted from page 118 of Smashing Node.js by Guillermo Rauch
    // res is response provided to onRequest. 
    var data = url.parse(request.url);
    var ext = pathfuncs.extname(data.pathname);
    res.write('Start reply');
    fs.stat(root+request.url, function(err,stat) {
        // define delayed callback - reponse in scope
        if (err || !stat.isFile()) { // error or not file.
            console.log('404');
            res.writeHead(404);
            res.write('Not Found');
            res.end
            return;
        };
        // exists so serve.
        console.log("serve("+root+request.url+", mimetypes.mimetype("+ext+"))");
        res.writeHead(200, {'Content-Type': mimetypes.mimetype(ext)});
        res.write('The file contents');
        res.end;
    }   // end callback,
    );  // end fs.stat call. 
} // end phpServer

function start() {
    function onRequest(request, response) {
        phpServer('D:/websites/coachmaster.co.uk/htdocs',request, response);
    }
    http.createServer(onRequest).listen(80);
    console.log("Server started.");
}

exports.start = start; 
```

这根本不回复 - 它超时。但是，如果 res 超出范围/不存在/未定义，则对 res.writeHead 的调用将失败，或者如果 re 是传入的参数，则调用成功。

它成功了，然后是 write 和 end，所以请 - 我做错了什么。

如果文件不存在，我会收到一个开始回复，然后是超时。

在 res.write('开始回复'); res 是响应参数，但它不在 fs.stat 回调的后面。

为什么不？该死的——这令人沮丧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:24:17.253

调用`response.end`应该从`onRequest`函数移到`phpServer`. 就目前而言，由于流已关闭，phpServer 无法写入任何其他内容。

```
function onRequest(request, response) {
    php.phpServer('D:/websites/coachmaster.co.uk/htdocs',request, response);

    // response.end(); // move this to phpServer 
} 
```

如[文档](http://nodejs.org/api/http.html#http_response_end_data_encoding)中所述`response.end`

> 该方法向服务器发出所有响应标头和正文已发送的信号；该服务器应认为此消息已完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:25:52.667

您的问题不在于参数传递，而在于基本的异步控制流。该`stat()`功能不会立即完成其工作。它的回调参数在完成时被调用。您基本上无法按照您的方式构建代码。相反，您的“phpServer”代码将需要自己的回调参数，并在它完成工作后调用它。

# iphone - 无法在 ipad 或 iPhone 上播放视频？

> ID：14415269
> 
> 赞同：1
> 
> 时间：2013-01-19T14:18:35.567
> 
> 标签：iphone, html, ipad, video, fancybox

我到处寻找答案，这一切都非常令人困惑。

我无法让我的视频在 ipad 或 iphone 上播放。

他们在包括机器人/台式机在内的其他设备上播放。我已经使用 Miro 视频转换器和手刹对它们进行了多次转换，我尝试过减小文件大小。我试过删除海报标签。我得出结论，我的 html 一定有问题，如下所示：

```
<div id="blackbox_2" style="display: none">
<video title="BlackBox Sessions Part 2"  class="video" preload="auto" controls>
<source src="videos/BlackBoxPt.2 copy.mp4"  type='video/mp4; codecs="avc1.42E01E, mp4a.40.2"'>
<source src="videos/BlackBoxPt.2.webm" type='video/webm; codecs="vp8, vorbis"'>
<source src="videos/BlackBoxPt.2.ogv"  type='video/ogg; codecs="theora, vorbis"'>
<object width="640" height="360" type="application/x-shockwave-flash"
data="flowplayer-5"> 
<param name="movie" value="flowplayer-5" /> 
<param name="allowfullscreen" value="true" /> 
<param name="flashvars" value='config={"clip": {"url": "http://kimcolemanprojects.com/videos/BlackBoxPt.2.appleuniversal.mp4", "autoPlay":false, "autoBuffering":true}}' /> 
</object>
</video>  </div> 
```

我从潜入 html 中得到的这个 html。在 iPad/iphone 上，您可以在中间看到视频播放按钮，但是当您单击它时，没有任何反应。

包含视频的页面在这里[http://kimcolemanprojects.com/video-lighting.html](http://kimcolemanprojects.com/video-lighting.html)

我在这个页面上有几个视频显示在一个花哨的盒子里。

如果有人可以帮助指导我朝着正确的方向前进，我将不胜感激，我发现这个问题非常烦人。

谢谢安吉拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-27T12:20:03.753

我决定解决这个问题最简单的选择是通过 youtube 和 vimeo 流式传输我的所有视频。这样他们就可以处理所有事情。

# jquery - 如何更改刚刚使用 jquery 加载的 .html 文件的属性

> ID：14415271
> 
> 赞同：3
> 
> 时间：2013-01-19T14:18:43.253
> 
> 标签：jquery

```
<html >
<head>
<title>main files</title>
<script src="http://code.jquery.com/jquery-latest.js"></script>
</head>
<div id="kk">
</div>
<script>
    $("#kk").load("template.html");
    var new_id="234";
    $(#tkk).attr({
                   id : this.id + '_' + new_id,
                   name: this.name + '_' + new_id

                 });            

</script>
</body>
</html> 
```

<---------------------------------------------------- ----------------->

模板.html

```
<h2>Greetings</h2>
<div id="tkk" class="container">
  <div class="inner">Hello</div>
  <div class="inner">Goodbye</div>
</div> 
```

在这里，我想在加载到 main.html 文件后更改 tkk 的 id，但它不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:20:29.400

在`load`函数内部，这样您所需的更改将在成功加载 AJAX 后执行，而不是同时执行。

```
$("#kk").load("template.html", function(){
    var new_id="234";
    $("#tkk").attr({
           id : this.id + '_' + new_id,
           name: this.name + '_' + new_id   
    });  
}); 
```

# ocaml - Ocaml错误lwt

> ID：14415278
> 
> 赞同：1
> 
> 时间：2013-01-19T14:19:19.957
> 
> 标签：ocaml

以下

```
let new_socket () = Lwt_unix.socket Unix.PF_INET Unix.SOCK_STREAM 0 in  
let socket_address = Network.make_address "127.0.0.1" 7777 in  
let listening_socket = new_socket () in  
Lwt_unix.setsockopt listening_socket Unix.SO_REUSEADDR true;  
Lwt_unix.bind listening_socket socket_address; 
```

导致此错误：

错误：正确性：2：remote_client：0：set

```
Unix.Unix_error(Unix.EADDRINUSE, "bind", "")
Raised at file "src/core/lwt.ml", line 782, characters 22-23
Called from file "src/unix/lwt_main.ml", line 34, characters 8-18
Called from file "src/oUnit.ml", line 597, characters 6-10` 
```

最后一行未能授予绑定，想法为什么，如何通过这个？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T15:28:16.353

错误已明确说明：您尝试绑定的地址已在使用中，套接字已绑定在端口 7777 上。

要了解`Unix_error`函数引发的代码，请查看相应 C unix 函数的手册，在这种情况下为[bind(2)](http://www.kernel.org/doc/man-pages/online/pages/man2/bind.2.html)。

# variables - 在 gnuplot 中使用多个变量进行绘图

> ID：14415279
> 
> 赞同：3
> 
> 时间：2013-01-19T14:19:22.890
> 
> 标签：variables, plot, gnuplot

我有一个包含多列的数据文件，前两列表示位置，其他列表示其他属性（例如从该点发送的项目数）。例如：

```
1  1  1  57.11
2  1  2  62.40
3  4  1  31.92 
```

我想要做的是绘制位置上的点，但使用其他列中的值来改变点的类型和大小（例如）。但是我似乎无法找到一种方法来引用图中的列。我知道“变量”的使用，但我找不到使用多个变量的方法。

我想要的是如下内容：

```
plot "mydata" using 1:2 notitle with points pt ($3) ps ($4/10) 
```

以便 pt 和 ps 使用分别取自第三和第四列的每个点的值。

这在gnuplot中甚至可能吗？有某种解决方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T14:39:28.583

您应该能够使用关键字`variable`来执行以下操作：

```
plot 'datafile' using 1:2:3:4 w points ps variable lc variable 
```

或者可能将值映射到调色板：

```
plot 'datafile' using 1:2:3:4 w points ps variable lc palette 
```

关键字变量和/或调色板导致 gnuplot 从文件中读取属性，并且它们都需要通过`using`. 当然，所有使用 using 的常用内容都适用——您可以将转换应用于数据等：

```
plot 'datafile' using 1:2:3:($4+32.) w points ps variable lc palette 
```

* * *

我不记得第三列是这里的点大小还是颜色，我现在没有时间玩弄它来弄清楚。您可以进行实验并发表评论，或者我会在有时间时再回来添加更新。

* * *

其他一些属性（例如`pointtype`）不能很容易地更改为使用`variable`. 最简单的方法是使用带有 gnuplot 三元运算符的过滤器。

首先，编写一个函数，该函数根据数据文件的 1 列中的数据返回一个点类型：

```
my_point_type(x) = x 
```

这里我使用了一个简单的标识函数，但它可以是任何东西。现在，您可以遍历您想要的点类型（此处为 1-10），为每个点类型绘制一个图：

```
plot [for PT=1:10] 'datafile' u 1:((my_point_type($3) == PT) ? $2:NaN) with points pt PT 
```

这假设具有点类型信息的列是第 3 列，而第 2 列包含位置信息。这也可以与我上面演示的内容结合使用。

# events - 骨干 collection.create 不触发“添加”事件

> ID：14415285
> 
> 赞同：0
> 
> 时间：2013-01-19T14:20:24.487
> 
> 标签：events, backbone.js, coffeescript

我正在为一个简单的主干/咖啡脚本示例而苦苦挣扎。我正在尝试向 QuestionList 添加一个问题，并让它在集合上触发一个“添加”事件，以便我可以呈现它。我正在使用 create 方法，因为我试图让它连接到我的服务器，这里由控制台建模。

在此示例中，控制台打印“create: {"question":"Question","answer":"Answer"}" 但未按预期打印“事件发生”。我在这里做错了什么？

```
jQuery ->
    class Question extends Backbone.Model
        defaults:
            question: 'Question'
            answer: 'Answer'

    class QuestionList extends Backbone.Collection
        model: Question

        initialize: ->
            @bind 'all', -> console.log "Event occurred"

    Backbone.sync = (method, model) ->
        console.log method + ": " + JSON.stringify(model)

    question_list = new QuestionList

    question_list.fetch()

    question_list.create 
                    question: $('#question').val()
                    answer: $('#answer').val() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T13:07:10.040

使用的 Backbone 版本很旧，因为我下载了教程并从那里继续工作。升级到 Backbone 0.9.9 解决了这个问题。（感谢芬克利夫！）

# algorithm - 在有障碍物的连续大地图上查找路径

> ID：14415289
> 
> 赞同：2
> 
> 时间：2013-01-19T14:20:59.043
> 
> 标签：algorithm, graph, game-engine

我正在尝试在带有一些障碍物的连续棋盘（没有网格单元）上创建游戏（例如随机点的盒子和毁坏的墙壁，地图很大）。我可以使用什么算法来解决这个问题（网格板中有类似的 A*）？我做了一些研究，我可以使用 Voronoi 图吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T19:12:24.303

在 Skiena 的*算法设计手册*中是计算几何下的一个条目，称为“运动规划”。它为此列出了一些实现，即*Motion Planning Toolkit*、*SWIFT++*和*CGAL*。如果可以的话，看看那本书，我发现它读起来非常实用，虽然它并没有真正提供很多解决方案，但它总是有一些指向哪里可以找到它们。基本上，一种方法是从地图中生成合适的图形，然后使用 Dijkstra 算法（或者可能是 A*？）来找到最短路径。生成图表需要分析您可以在哪些点之间移动而不会越过障碍。

# sql - 查询以在单个表上乘以某些行集

> ID：14415293
> 
> 赞同：1
> 
> 时间：2013-01-19T14:21:13.390
> 
> 标签：sql, oracle, oracle11g

我有一些复杂的查询，我正在努力解决。您会注意到模式并不是最容易使用的东西，但它是我得到的，没有时间重新设计（常见的故事！）。

我有像下面这样的行。注意：3位`value`数字只是我编的随机数。

```
id     field_id     value
1      5            999 
1      6            888
1      7            777
1      8            foo <--- foo so we want the 3 values above
1      9            don't care

2      5            123 
2      6            456
2      7            789
2      8            bar <--- bar so we DON'T want the 3 values above
2      9            don't care

3      5            623 
3      6            971
3      7            481
3      8            foo <--- foo so we want the 3 values above
3      9            don't care

...
...

n      5            987 
n      6            654
n      7            321
n      8            foo <--- foo so we want the 3 values above
n      9            don't care 
```

我想要这个结果：

```
id     result
1      999*888*777
3      623*971*481
...
n      987*654*321 
```

这清楚吗？所以我们有一个有`n*5`行的表。对于每组`5`行：`3`其中的值我们可能想要相乘，`1`其中的值告诉我们*是否*要相乘，以及`1`我们不关心的行，因此我们不希望查询结果中的行。

我们可以在 Oracle 中做到这一点吗？最好是一个查询。我猜你需要使用乘法运算符（不知何故）和分组。

任何帮助都会很棒。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:57:45.990

像这样的东西：

```
select m.id, exp(sum(ln(m.value)))
  from mytab m
 where m.field_id in (5, 6, 7)
   and m.id in (select m2.id
                  from mytab m2
                 where m2.field_id = 8
                   and m2.value = 'foo')
 group by m.id; 
```

例如：

```
SQL> select * from mytab;

        ID   FIELD_ID VAL
---------- ---------- ---
         1          5 999
         1          6 888
         1          7 777
         1          8 foo
         1          9 x
         2          5 123
         2          6 456
         2          7 789
         2          8 bar
         2          9 x
         3          5 623
         3          6 971
         3          7 481
         3          8 foo
         3          9 x

15 rows selected.

SQL> select m.id, exp(sum(ln(m.value))) result
  2    from mytab m
  3   where m.field_id in (5, 6, 7)
  4     and m.id in (select m2.id
  5                    from mytab m2
  6                   where m2.field_id = 8
  7                     and m2.value = 'foo')
  8   group by m.id;

        ID     RESULT
---------- ----------
         1  689286024
         3  290972773 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T13:44:38.257

相同的逻辑；刚刚删除了硬编码的值。发布此答案的想法可能对其他人有所帮助。

```
 SELECT a.id,
           exp(sum(ln(a.val)))
    FROM mytab a,
      (SELECT DISTINCT id,
                       field_id
       FROM mytab
       WHERE val = 'foo') b
    WHERE a.id = b.id
      AND a.field_id < b.field_id
    GROUP BY a.id; 
```

# performance - 重复循环中 if 语句的速度会影响整体性能吗？

> ID：14415294
> 
> 赞同：1
> 
> 时间：2013-01-19T14:21:14.060
> 
> 标签：performance, dynamic, if-statement

如果我的代码需要一段时间才能执行，那么每次迭代都打印出结果会大大减慢程序的速度。为了仍然偶尔收到输出来检查代码的进度，我可能有：

```
if (i % 10000 == 0) {
    # print progress here
} 
```

if 语句每次检查都会减慢它的速度吗？我是否应该不输出并等待，这会使其明显更快吗？

另外，这样做更快：`(i % 10000 == 0)`还是`(i == 10000)`？
检查相等或模数更快吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:32:30.797

在一般情况下，它根本不重要。

稍长一点的答案：除非循环运行数百万次并且其中的另一个语句实际上比`if`语句要求低（例如，简单的乘法等），否则这无关紧要。在这种情况下，您可能会看到性能略有下降。

关于`(i % 10000 == 0)`vs. `(i == 10000)`，后者显然更快，因为它只进行比较，而前一种可能性进行（相当昂贵的）模数和比较。

也就是说，如果您的循环不占用程序运行时间的 90%，那么`if`语句和模数计数都不会有*任何区别。*通常只有在学校才会这样:)。问这个问题所花费的时间可能比不打印任何内容所节省的时间要多得多。对于开发和调试，这不是一个坏方法。

这种决策的黄金法则：

> 编写你能想象到的最易读和最明确的代码来做你想做的事情。如果您遇到性能问题，请先查看错误的数据结构和算法选择。如果您已经完成了所有这些并且*需要*一个*非常*快速的程序，请分析它以查看哪个部分花费的时间最多。毕竟，你可以做这种低级的猜测。

# multitasking - 协同多任务系统

> ID：14415303
> 
> 赞同：7
> 
> 时间：2013-01-19T14:21:55.857
> 
> 标签：multitasking

我试图绕过协作多任务系统的概念以及它在单线程应用程序中的工作原理。

我的理解是，这是一种“多任务处理的形式，其中多个任务通过在每个任务中的程序员定义的点处自愿将控制权让给其他任务来执行”。

因此，如果您有一个任务列表并且一个任务正在执行，您如何确定将执行传递给另一个任务？当您将执行返回给先前的任务时，如何从先前的位置恢复？

我觉得这有点令人困惑，因为我不明白如果没有多线程应用程序如何实现这一点。

任何建议都会非常有帮助:)

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-12-31T18:44:40.310

在单个进程（或执行线程）使用协作多任务处理的特定场景中，您可以使用诸如 Windows 的纤程或 POSIX setcontext 系列函数之类的东西。我将在这里使用术语纤维。

基本上，当一个纤程完成执行一大块工作并希望自愿允许其他纤程运行（因此称为“合作”术语）时，它要么手动切换到另一个纤程的上下文，要么更典型地执行某种 yield() 或scheduler() 调用跳转到调度程序的上下文，然后调度程序找到要运行的新纤程并切换到该纤程的上下文。

这里的上下文是什么意思？基本上是堆栈和寄存器。堆栈没有什么神奇之处，它只是堆栈指针恰好指向的一块内存。程序计数器也没有什么神奇之处，它只是指向下一条要执行的指令。切换上下文只是将当前寄存器保存在某处，将堆栈指针更改为不同的内存块，将程序计数器更新为不同的指令流，将该上下文保存的寄存器复制到 CPU 中，然后进行跳转。Bam，您现在正在使用不同的堆栈执行不同的指令。通常上下文切换代码是用汇编语言编写的，该汇编代码的调用方式不会修改当前堆栈或取消更改，无论哪种情况，它都不会在堆栈或寄存器中留下任何痕迹，因此当代码恢复执行时，它不知道发生了什么。（再次，主题：我们假设方法调用摆弄寄存器，将参数推送到堆栈，移动堆栈指针等，但这只是 C 调用约定。没有什么需要你维护一个堆栈或有任何特定的方法调用在堆栈上留下任何自己的痕迹）。

由于每个堆栈都是独立的，因此您不会有一些看似随机的方法调用的连续链最终溢出堆栈（如果您天真地尝试使用连续调用彼此的标准 C 方法来实现此方案，这可能是结果）。您可以使用状态机手动实现这一点，其中每个纤程都保留其工作位置的状态机，定期返回调用调度程序的方法，但是当实际的纤程/协程支持广泛可用时，为什么还要麻烦呢？

还要记住，协作多任务处理与进程、受保护的内存、地址空间等是正交的。见证 Mac OS 9 或 Windows 3.x。他们支持分离流程的想法。但是当您让步时，上下文更改为操作系统上下文，允许操作系统调度程序运行，然后可能选择另一个进程切换到。从理论上讲，您可以拥有一个仍然使用协作多任务处理的完全受保护的虚拟内存操作系统。在那些系统中，如果一个错误的进程永远不会让步，那么操作系统调度程序就永远不会运行，因此系统中的所有其他进程都会被冻结。**

下一个自然的问题是什么使某些东西先发制人......答案是操作系统与 CPU 调度一个中断计时器来停止当前正在执行的任务并切换回操作系统调度程序的上下文，而不管当前任务是否愿意释放CPU 与否，因此“抢占”它。如果操作系统使用 CPU 特权级别，则（内核配置的）定时器不能被较低级别（用户模式）代码取消，但理论上如果操作系统不使用此类保护，错误的任务可以屏蔽或取消中断定时器和劫持CPU。还有一些其他场景，例如 IO 调用，其中可以在计时器之外调用调度程序，并且调度程序可能会决定没有其他进程具有更高的优先级并将控制权返回给同一进程而无需切换......实际上大多数操作系统都没有

** 你可能会问，如果在某个时间段内没有调用 yield，为什么不直接触发一个计时器。答案在于多线程同步。在合作系统中，您不必费心去锁、担心重新进入等，因为您只有在事情处于已知良好状态时才会让步。如果这个神秘的计时器触发了，那么您现在可能已经破坏了被中断程序的状态。如果必须编写程序来处理这个问题，恭喜……你现在拥有了一个半途而废的先发制人的多任务系统。还不如做对了！而且，如果您无论如何都在进行更改，不妨添加线程、受保护的内存等。这几乎就是主要操作系统的历史。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-30T15:17:56.210

协作多任务处理背后的基本思想是信任——每个子任务将自行及时放弃控制，以避免占用其他任务的处理器时间。这就是为什么协作式多任务系统中的任务需要非常彻底的测试，并且在某些情况下需要经过认证才能使用。

我并不声称自己是专家，但我认为协作任务可以作为状态机来实现，将控制权传递给任务会导致它运行所需的绝对**最短**时间以取得任何进展。例如，文件读取器可能会读取文件的下几个字节，解析器可能会解析文档的下一行，或者传感器控制器可能会读取一次，然后将控制权返回给协作调度程序，该调度程序将检查任务完成。

每个任务都必须将其内部状态保留在堆上（在对象级别），而不是像传统的阻塞函数或线程那样在堆栈帧（在函数级别）上。

与依赖硬件计时器来触发上下文切换的传统多任务处理不同，协作式多任务处理依赖于以这样一种方式编写的代码，即每个长时间运行的任务的每一步都保证在可接受的少量时间内完成.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-11T05:02:01.447

任务将执行显式*等待*或*暂停*或*让步*操作，从而调用调度程序。可能有不同的操作来等待 IO 完成或在繁重的计算中显式*让步。*在应用程序任务的主循环中，它可以有一个 *wait_for_event* 调用而不是忙轮询。这将暂停任务，直到它有输入要处理。

捕获失控任务可能还有超时机制，但它不是切换的主要手段（否则它不会*合作*）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-11-15T20:28:42.463

考虑协作多任务的一种方法是将任务拆分为步骤（或状态）。每个任务都会跟踪它需要执行的下一步。轮到任务时，它只执行那一步并返回。这样，在程序的主循环中，您只需按顺序调用每个任务，并且因为每个任务只占用少量时间来完成一个步骤，我们最终得到一个允许所有任务执行的系统共享 cpu 时间（即合作）。

# php - 更改目录中的图像名称并显示更改的文件名

> ID：14415305
> 
> 赞同：0
> 
> 时间：2013-01-19T14:22:05.977
> 
> 标签：php, arrays, opendir

该脚本的目的是更改电子商务网站目录中图像列表的名称。因此，特别是当脚本是 rand 时，用户将输入一个单词或短语，他们希望以一组或一组文件作为前缀。该脚本将遍历每个文件，更改前缀并附加从零开始的下一个可用数字。

我想在页面上向用户显示/呈现哪些文件已更改。现在，当脚本运行时，它会显示目录中的当前文件，然后列出目录中更改的文件及其名称。

我怎样才能让文件列表仅在脚本完成处理新名称时显示？

为什么脚本没有将正确的递增数字附加到文件名？它按以下顺序重命名文件： abc0.jpg abc1.jpg abc10.jpg abc11.jpg abc12.jpg abc13.jpg

```
<?php 
  $display_file_list;

    //Allow user to put choose name
  if (isset($_POST['file_prefix'])){

    $the_user_prefix = $_POST['file_prefix'];

   //open the current directory change this to modify where you are looking
   $dir = opendir('.');

   $i=0;

   //Loop though all the files in the directory 
   while(false !==($file = readdir($dir)))
   {

    //This is the way we would like the page to function 

    //if the extention is .jpg
    if(strtolower(pathinfo($file, PATHINFO_EXTENSION)) =='jpg')
    {
      //Put the JPG files in an array to display to the user
      $display_file_list[]= $file;

      //Do the rename based on the current iteration
      $newName = $the_user_prefix.$i . '.jpg';
      rename($file, $newName);
      //increase for the next loop
      $i++;
    }

       }

     //close the directory handle
     closedir($dir);

      }else{

    echo "No file prefix provided";
  }

?>

    <html>
    <body>
     <form action="<?=$_SERVER['PHP_SELF']?>" method="POST">
    <input type="text" name="file_prefix"><br>
    <input type="submit" value="submit" name="submitMe">
    </form>
    </body>

</html>

<?php
  foreach ($display_file_list as $key => $value) {
           echo  $value. "<br>";
         } 

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:14:39.590

“我怎样才能让文件列表仅在脚本完成处理新名称时显示？”

我认为这对你有用；

```
$path  = "path/to/files";
$files = glob("{$path}/*.jpg");
$files_renamed = array();
foreach ($files as $i => $file) {
    $name = "{$path}/{$prefix}{$i}.jpg";
    if (true === rename($file)) {
        $files_renamed[] = $name;
    }
}
print_r($files_renamed); 
```

# linux - 如何在不在屏幕上书写的情况下捕获键盘输入

> ID：14415306
> 
> 赞同：4
> 
> 时间：2013-01-19T14:22:07.617
> 
> 标签：linux, keyboard, debian, capture

我正在为 Debian Linux 编写一个 ANSI C 应用程序，它从 USB 键盘捕获数据并通过 RS232 端口和 LAN（它是某种工业机器）发送一些数据。没有屏幕连接到 PC。我正在使用从“/dev/input/event1”捕获并且一切正常，但是在启动计算机后显示系统登录/通过提示并且键盘被我​​的应用程序以及系统登录捕获。我的问题是如何禁用系统捕获键盘以进行登录，但让它与我的应用程序一起运行？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T16:17:16.863

您面临的问题是，默认情况下，设备的所有输入事件处理程序都会接收所有事件。您的情况至少有两个处理程序：控制台的键盘驱动程序和`evdev`应用程序的用户空间界面。

为避免这种情况，您的应用程序应指示`evdev`模块*获取*输入设备，以供其与`EVIOCGRAB` [`ioctl`](http://linux.die.net/man/2/ioctl). 这将阻止任何其他处理程序，包括其他用户空间应用程序，从该设备接收任何事件。

要抓取设备：

```
int ret = ioctl(fd, EVIOCGRAB, (void *)1); 
```

要释放抓取的设备：

```
int ret = ioctl(fd, EVIOCGRAB, (void *)0); 
```

# php - php中的数组排序

> ID：14415309
> 
> 赞同：0
> 
> 时间：2013-01-19T14:22:28.380
> 
> 标签：php, multidimensional-array, sorting

我有一个数组，说
下面的 xyz 是 var_dump($xyz); 的输出

```
array
    7399 => 
        array
            'count' => int 103
            'name' => string '2&ordm; SEMESTRE - 2012' (length=23)
    7398 => 
        array
            'count' => int 50
            'name' => string '1&ordm; SEMESTRE - 2012' (length=23)
    7397 => 
        array
            'count' => int 43
            'name' => string '2&ordm; SEMESTRE - 2011' (length=23)
    7396 => 
        array
            'count' => int 20
            'name' => string '1&ordm; SEMESTRE - 2011' (length=23)
    7395 => 
        array
            'count' => int 53
            'name' => string '2&ordm; SEMESTRE - 2010' (length=23)
    'others' => 
        array
            'name' => string 'Others' (length=6)
            'count' => int 65 
```

我想按计数 desc 对这个数组进行排序，名称 asc 将“其他”元素留在底部。我使用了如下的array_multisort

```
// Obtain a list of columns
foreach ($xyz as $key => $row) {
    $count[$key]  = $row['volume'];
    $name[$key] = $row['edition'];
}

// Sort the data with volume descending, edition ascending
// Add $data as the last parameter, to sort by the common key
array_multisort($count, SORT_DESC, $name, SORT_ASC, $xyz); 
```

但失败了。它显示以下警告：

```
Warning: array_multisort() [function.array-multisort]: Array sizes are inconsistent 
```

我想要的是这样的

```
array
    7399 => 
        array
            'count' => int 103
            'name' => string '2&ordm; SEMESTRE - 2012' (length=23)
    7395 => 
        array
            'count' => int 53
            'name' => string '2&ordm; SEMESTRE - 2010' (length=23)
    7398 => 
        array
            'count' => int 50
            'name' => string '1&ordm; SEMESTRE - 2012' (length=23)
    7397 => 
        array
            'count' => int 43
            'name' => string '2&ordm; SEMESTRE - 2011' (length=23)
    7396 => 
        array
            'count' => int 20
            'name' => string '1&ordm; SEMESTRE - 2011' (length=23)
    'others' => 
        array
            'name' => string 'Others' (length=6)
            'count' => int 65 
```

请帮忙。谢谢大家的期待！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:25:39.817

这个问题已经有一个[写得很好的答案](https://stackoverflow.com/a/2699110/427992)：

```
function aasort (&$array, $key) {
    $sorter=array();
    $ret=array();
    reset($array);
    foreach ($array as $ii => $va) {
        $sorter[$ii]=$va[$key];
    }
    asort($sorter);
    foreach ($sorter as $ii => $va) {
        $ret[$ii]=$array[$ii];
    }
    $array=$ret;
} 
```

因此，要按计数排序，您可以：

```
aasort($your_array,"count"); 
```

# mysql - 使用 AM 或 PM 显示的时间戳

> ID：14415322
> 
> 赞同：0
> 
> 时间：2013-01-19T14:23:27.703
> 
> 标签：mysql, database, time

我将文章及其相应的时间戳存储在 mysql 数据库中。

我想使用 date() 格式化时间戳，并在从数据库中检索文章时显示是上午还是下午。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T14:26:12.913

假设您使用的是 MySQL，则需要使用 date_format()：

```
SELECT DATE_FORMAT(hour_column, '%r'); 
```

这为您提供了 12 小时的格式化时间（hh:mm:ss 后跟 AM 或 PM），无论如何也请查看[MySQL 文档的相关位](http://dev.mysql.com/doc/refman/5.6/en/date-and-time-functions.html#function_date-format)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T14:43:19.900

*根据您的其他一些问题，您使用 PHP。*

如[PHP Date page](http://dk.php.net/manual/en/function.date.php)所述，您可以使用`a`(am/pm) 或`A`(AM/PM) 来获取您想要的内容：

```
$showDate = date("Y-m-d h:iA", strtotime("2013-01-19 15:42:00"));
//string(18) "2013-01-19 03:42PM" 
```

# php - 将返回多个单维数组的函数更改为返回一个单维数组的函数

> ID：14415325
> 
> 赞同：0
> 
> 时间：2013-01-19T14:24:03.127
> 
> 标签：php, arrays

我正在构建一个函数，我想从 db 中检索键/值对，它就像`$result=array($key=>$value);`当我使用 this 时`$result`，在一个需要在其参数中包含一个数组的对象中

```
function Foo($result) { array ('superkey'=>$result); } 
```

这认为 $result 包含多个这样的数组：

```
Array
(
    [key1] => value1
)
Array
(
    [key3] => value2
)
Array
(
    [key3] => value3
)
Array
(
    [key4] => value4
) 
```

但我希望将其视为一个数组：

```
Array
(
    [key1] => value1

    [key3] => value2

    [key3] => value3

    [key4] => value4
) 
```

谁能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:26:56.993

如何使用[`array_merge`](http://php.net/manual/en/function.array-merge.php)：

```
array_merge($array1, $array2, $array3, ...); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:43:07.673

当您从数据库中检索值时，它通常会发送一个多维数组，例如：

```
array(3) {
  [0]=> array(1) { ["samekey"]=> value1 }
  [1]=> array(1) { ["samekey"]=> value2 }
  [2]=> array(1) { ["samekey"]=> value3 }
} 
```

这些数组的键总是相同的，因为它们代表数据库中的列名。在我看来，您正在寻找一种将所有这些值编译到单个数组中的方法。为此，您需要忘记密钥，并使用以下内容：

```
foreach($result as $entry) $fixedresult[] = $entry['samekey']; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:41:57.190

好吧，如果您想`array_merge`在多个数组上使用，但您还不知道它将是多少，您可以执行以下操作：

```
call_user_func_array('array_merge', $result); 
```

`$result`尽管正如其他人所指出的那样，一旦其中包含的数组具有相同的密钥，这就会中断。

# ios - UITableViewCell 中的 UIButton 为 nil

> ID：14415334
> 
> 赞同：1
> 
> 时间：2013-01-19T14:25:43.600
> 
> 标签：ios, uitableview, uibutton, xcode-storyboard

我在 UITableViewCell 中的 UIButton 有一些问题。我使用原型单元在情节提要中创建了一个自定义 tableviewcell。有两个按钮，我为它们设置了一个标签。第一次绘制表格视图时，所有内容都显示正确，但如果我滚动或更新数据并在表格视图上调用 reloadData，则更新不正确。

代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Moment Cell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];        
}

NSLog(@"Cell: %@", cell);

[cell setSelectionStyle:UITableViewCellSelectionStyleNone];
NSArray *row = [mMoment objectAtIndex:indexPath.row];

UILabel *label;

label = (UILabel *)[cell viewWithTag:101];
label.text = [row objectAtIndex:0];

label = (UILabel *)[cell viewWithTag:102];
label.text = [NSString stringWithFormat:@"Koeff: %@",[row objectAtIndex:2]];

UIButton *button;
NSString *btn_title;

button = (UIButton *)[cell viewWithTag:104];

NSLog(@"Button: %@", button);

[button setTag:1];
btn_title = [NSString stringWithFormat:@"%@", [row objectAtIndex:4]];
[button setTitle:btn_title forState:(UIControlState)UIControlStateNormal];
[button addTarget:self action:@selector(poangButtonClick:event:) forControlEvents:UIControlEventTouchUpInside];

NSLog(@"Row: %d, Poäng: %@", indexPath.row, btn_title);

label = (UILabel *)[cell viewWithTag:103];
label.text = btn_title;

button = (UIButton *)[cell viewWithTag:105];
[button setTag:2];
btn_title = [NSString stringWithFormat:@"%@", [row objectAtIndex:5]];
[button setTitle:btn_title forState:(UIControlState)UIControlStateNormal];
[button addTarget:self action:@selector(poangButtonClick:event:) forControlEvents:UIControlEventTouchUpInside];

return cell; 
```

}

第一次`button = (UIButton *)[cell viewWithTag:104];`在每个可见行上调用，一切都是正确的，但是如果我滚动或重新加载视图，按钮为零？为什么？以同样的方式检索标签，并且可以正确显示。如何更改单元格中按钮的标签？

问候

/弗雷德里克

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T14:34:36.173

快速猜测：我看到您正在重置用于引用它的按钮“标签”值。所以你不能再用值 104 检索它（在改变它之后）（在第一次创建之后它现在是 1 和 2）

```
[button setTag:1]; 
```

所以，你下次不会通过

```
button = (UIButton *)[cell viewWithTag:105]; 
```

我的假设是单元格没有被释放，因此这个标签值保持不变。也许这会解决它。

# linq - LINQ 连接问题，返回所有空值

> ID：14415339
> 
> 赞同：0
> 
> 时间：2013-01-19T14:26:13.227
> 
> 标签：linq, entity-framework, c#-4.0

我是新手，`EF`我`LINQ`面临一个奇怪的问题。当我在我的`select new`块中检查空值时，子表中的所有值都为空。下面是`LINQ`查询。

**我的 Linq 代码**

```
var linqResult = from pd in entities.tblpackagedetails
         join ps in entities.tblpackageselecteds
         on pd.PackageDetailsID equals ps.PackageDetailsID 
         into tabJoin
         from tj in tabJoin.Where(ps => ps.UserID == userID 
         && ps.IsActive == true).DefaultIfEmpty()
         select new
         {
             IsComplete = (tj == null) ? false : tj.IsComplete,
             IsActive = (tj == null) ? false : tj.IsActive,
             UserID = (tj == null) ? 0 : tj.UserID,
             IsMandatory = pd.IsMandatory,
             PackageSelectedID = (tj == null) ? 0 : tj.PackageSelectedID,
             IsSelected = (tj == null ? false : tj.IsSelected),
             pd.Amount,
             pd.Code,
             pd.Description,
             pd.Points,
             pd.PackageDetailsID
         };

        foreach (var result in linqResult)
        {
            packagesSelected.Add(new PackageDetailDataModel()
            {
                Amount = result.Amount,
                Code = result.Code,
                Description = result.Description,
                IsComplete = result.IsComplete,
                IsMandatory = result.IsMandatory,
                PackageDetailsID = result.PackageDetailsID,
                PackageSelectedID = result.PackageSelectedID,
                Points = result.Points,
                IsActive = result.IsActive,
                UserID = result.UserID,
                IsSelected = result.IsSelected
            });
        } 
```

**Visualizer 生成的 SQL**

```
 SELECT
    `Extent1`.`PackageDetailsID`, 
    `Extent2`.`IsComplete`, 
    `Extent2`.`IsActive`, 
    `Extent2`.`UserID`, 
    `Extent1`.`IsMandatory`, 
    `Extent2`.`PackageSelectedID`, 
    `Extent2`.`IsSelected`, 
    `Extent1`.`Amount`, 
    `Extent1`.`Code`, 
    `Extent1`.`Description`, 
    `Extent1`.`Points`
    FROM `tblpackagedetails` AS `Extent1` 
    LEFT OUTER JOIN `tblpackageselected` AS `Extent2` 
    ON (`Extent1`.`PackageDetailsID` = `Extent2`.`PackageDetailsID`) 
    AND ((`Extent2`.`UserID` = @linq_0) AND (1 = `Extent2`.`IsActive`)) 
```

当我在 MySQL 工作台上运行 sql 时，我得到了以下输出（`@linq_0`用 userID 替换）。

![工作台输出](../Images/d2c5b6f1b117d8f8e193c28a68e9e0a9.png)

**我的父表结构** ![tbl包裹详情](../Images/6b7069c8262cddbf77cf773cb57757a5.png)

**子表结构** ![tblPackageSelected](../Images/075cc8ec468159ba200cb5c1cfbc1473.png)

**我想要的输出** ![想要的输出](../Images/a66cb82d60848f26783641892918fad6.png)

但是，作为结果条件检查块中的 、 、 和 null`IsComplete`的`IsActive`值分配为 false 或 0。`UserID``PackageSelectedID``IsSelected``select new`

如果我删除空检查，我会得到前 3 行的值，并且在第四次迭代中我得到低于异常。 `The cast to value type 'Boolean' failed because the materialized value is null. Either the result type's generic parameter or the query must use a nullable type`

请帮忙... ：（

**工作代码块**

```
 packagesSelected = new List<PackageDetailDataModel>();
    var linqResult = from pd in entities.tblpackagedetails
                     join ps in entities.tblpackageselecteds
                     on pd.PackageDetailsID equals ps.PackageDetailsID
                     into tabJoin
                     from tj in tabJoin.Where(ps => ps.UserID == userID
                     && ps.IsActive == true).DefaultIfEmpty()
                     select new
                     {
                         IsComplete = (bool?)tj.IsComplete,
                         IsActive = (bool?)tj.IsActive,
                         UserID = (int?)tj.UserID,
                         IsMandatory = pd.IsMandatory,
                         PackageSelectedID = (int?)tj.PackageSelectedID,
                         IsSelected = (bool?)tj.IsSelected,
                         pd.Amount,
                         pd.Code,
                         pd.Description,
                         pd.Points,
                         pd.PackageDetailsID
                     };

    foreach (var result in linqResult)
    {
        packagesSelected.Add(new PackageDetailDataModel()
        {
            Amount = result.Amount,
            Code = result.Code,
            Description = result.Description,
            IsComplete = (result.IsComplete ?? false),
            IsMandatory = result.IsMandatory,
            PackageDetailsID = result.PackageDetailsID,
            PackageSelectedID = (result.PackageSelectedID ?? 0),
            Points = result.Points,
            IsActive = (result.IsActive ?? false),
            UserID = (result.UserID ?? 0),
            IsSelected = (result.IsSelected ?? false)
        });
    } 
```

感谢[2Kay](https://stackoverflow.com/users/1009661/2kay) :)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:30:40.077

当`tj`是时`null`，EF 将 tj 的所有属性视为`null`。没关系，但是当 EF 试图将它们具体化为值类型时，它会失败。所以解决方案是使用可空类型..

试试这个查询：

```
var linqResult = from pd in entities.tblpackagedetails
     join ps in entities.tblpackageselecteds
     on pd.PackageDetailsID equals ps.PackageDetailsID 
     into tabJoin
     from tj in tabJoin.Where(ps => ps.UserID == userID 
     && ps.IsActive == true).DefaultIfEmpty()
     select new
     {
         IsComplete = (bool?) tj.IsComplete,
         IsActive = (bool?) tj.IsActive,
         UserID = (int?) tj.UserID,
         IsMandatory = pd.IsMandatory,
         PackageSelectedID = (int?) tj.PackageSelectedID,
         IsSelected = (bool?) tj.IsSelected,
         pd.Amount,
         pd.Code,
         pd.Description,
         pd.Points,
         pd.PackageDetailsID
     }; 
```

# php - PHP错误：未定义的索引：提交

> ID：14415341
> 
> 赞同：0
> 
> 时间：2013-01-19T14:26:22.620
> 
> 标签：php

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T14:29:00.707

您需要将 PHP 更改为：

```
if (isset($_GET['submit']))
{
    // Form has been submitted
}
else
{
    // Form has not been submitted
} 
```

目前，您正在分配一个可能不存在的值，`$submitcheck`然后检查它是否已设置。您需要以相反的方式执行此操作：`$_GET['submit']`设置检查，然后将其分配给变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T14:30:09.830

这是因为您的代码是从上到下执行的，并且在您使用的顶部执行`$_GET['submit']`，然后这个键不存在。你可以这样做：

```
if(array_key_exists('submit', $_GET)){
   echo $_GET['submit'];
} 
```

甚至

```
if (!isset($_GET['submit']))
{
    echo 'Pls select and submit';
}
else
{
 ....
} 
```

# java - java中负载均衡线程池的一种

> ID：14415343
> 
> 赞同：8
> 
> 时间：2013-01-19T14:26:39.560
> 
> 标签：java, multithreading, threadpool, pool

我正在寻找一个负载平衡的线程池，到目前为止没有成功。（不确定负载平衡是否是正确的措辞）。让我解释一下我试图实现的目标。

第 1 部分：我有工作，有 8 到 10 个单项任务。在 6 核 CPU 上，我让 8 个线程并行处理这些任务，这似乎可以提供最佳性能。当一项任务准备就绪时，另一项任务就可以开始了。一旦完成所有十项任务，就完成了完整的工作。通常一项工作在 30 到 60 秒内完成。

第二部分：不幸的是，有时这项工作需要两个多小时。由于必须计算的数据量，这是正确的。坏事是，在 job1 运行时没有其他作业可以启动（假设所有线程具有相同的持续时间），因为它正在使用所有线程。

我的第一个想法：拥有 12 个线程，最多允许三个并行作业。但是：这意味着，当只有 1 个工作时，cou 并没有完全实现。

我正在寻找一种解决方案，以便在没有其他工作时为第一个工作提供完整的 CPU 能力。但是，当另一个作业需要在另一个作业运行时启动时，我希望将 CPU 功率分配给这两个作业。当出现第三个或第四个工作时，我希望将 CPU 功率公平地分配给所有四个工作。

我很欣赏你的回答...

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T15:06:02.647

一种可能是使用`ThreadPoolExecutor`具有不同类型任务队列的标准

```
public class TaskRunner {
  private static class PriorityRunnable implements Runnable,
            Comparable<PriorityRunnable> {
    private Runnable theRunnable;
    private int priority = 0;
    public PriorityRunnable(Runnable r, int priority) {
      this.theRunnable = r;
      this.priority = priority;
    }

    public int getPriority() {
      return priority;
    }

    public void run() {
      theRunnable.run();
    }

    public int compareTo(PriorityRunnable that) {
      return this.priority - that.priority;
    }
  }

  private BlockingQueue<Runnable> taskQueue = new PriorityBlockingQueue<Runnable>();

  private ThreadPoolExecutor exec = new ThreadPoolExecutor(8, 8, 0L,
            TimeUnit.MILLISECONDS, taskQueue);

  public void runTasks(Runnable... tasks) {
    int priority = 0;
    Runnable nextTask = taskQueue.peek();
    if(nextTask instanceof PriorityRunnable) {
      priority = ((PriorityRunnable)nextTask).getPriority() + 1;
    }
    for(Runnable t : tasks) {
      exec.execute(new PriorityRunnable(t, priority));
      priority += 100;
    }
  }
} 
```

这里的想法是，当你有一份新工作时，你打电话给

```
taskRunner.runTasks(jobTask1, jobTask2, jobTask3); 
```

并且它将以这样一种方式将任务排队，使它们与队列中的任何现有任务（如果有的话）很好地交错。假设您有一个作业排队，其任务的优先级编号为 j [1] t [1] =3、j [1] t [2] =103 和 j [1] t [3] =203。在没有其他作业的情况下，这些任务会以最快的速度一个接一个地执行。但是，如果您提交另一个包含三个任务的作业，这些任务将被分配优先级编号 j [2] t [1] =4、j [2] t [2] =104 和 j [2] t [3] =204，这意味着队列现在看起来像

j [1] t [1] , j [2] t [1] , j [1] t [2] , j [2] t [2]等。

然而，这并不完美，因为如果所有线程当前都在工作（来自工作 1 的任务），那么工作 2 的第一个任务在其中一个工作 1 任务完成之前无法启动（除非有一些外部方法可供您检测这并中断并重新排队作业 1 的一些任务）。使事情更公平的最简单方法是将运行时间较长的任务分解为更小的部分并将它们作为单独的任务排队 - 您需要达到一个点，即每个单独的作业涉及的任务多于池中的线程数，这样某些任务将始终在队列中开始，而不是直接分配给线程（如果有空闲线程，则将`exec.execute()`任务直接传递给线程，而根本不经过队列）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:20:05.033

正如 Kanaga 建议的那样，最简单的做法是超额订阅 CPU，但每个线程启动 8 个线程。竞争可能会产生一些开销，但如果你得到一个单一的工作情况，它将充分利用 CPU。操作系统将处理为每个线程分配时间。

您的“第一个想法”也可以。如果空闲线程实际上并未执行任务，则它们不会从 8 个工作线程中获取资源。但是，当有多个作业正在运行时，这不会均匀地分配 cpu 资源。

您是否有一个设置可以测试这些不同的管道以查看它们对您的执行情况？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T14:43:48.700

我想因为你的机器是6核CPU。每个工作线程最好有 6 个工作线程。因此，当一个线程获得新工作时，它会启动多达六个并行工作人员来处理单个工作。这将确保在一次只有一项作业时消耗全部 cpu 功率。

另请查看 Java 7 中的 Fork 和 Join 概念。
[References_1](http://www.javacodegeeks.com/2011/02/java-forkjoin-parallel-programming.html)
[References_2](http://www.oracle.com/technetwork/articles/java/fork-join-422606.html)
[References_3](https://stackoverflow.com/questions/9509850/dual-core-cpu-utilization-w-single-java-thread-running)
[References_4](https://stackoverflow.com/questions/3330430/does-java-have-support-for-multicore-processors-parallel-processing)

还可以了解 newcachedthreadpool()

[Java newCachedThreadPool() 与 newFixedThreadPool](https://stackoverflow.com/questions/949355/newcachedthreadpool-v-s-newfixedthreadpool)

# python - 是否可以在 Windows 上为 PYTHONPATH 使用多个路径？

> ID：14415353
> 
> 赞同：2
> 
> 时间：2013-01-19T14:27:43.657
> 
> 标签：python, pythonpath

我有一个干净的虚拟机，带有 XP SP3 32 位和 ActivePython 2.7.2 32 位社区版，当前目录是“C:\test”。我已经放置`sitecustomize.py`了“print('dir1')”代码独立“C:\test\dir1”和`sitecustomize.py`“print('dir2')”代码独立“C:\test\dir2”。

如果我设置`PYTHONPATH`为`dir1`or `dir2`，`sitecustomize.py`则执行相应的：

```
C:\test> set PYTHONPATH=C:\test\dir1\
C:\text> python
dir1
>>>exit()
C:\test> set PYTHONPATH=C:\test\dir2\
C:\text> python
dir2 
```

但是，如果我将两个目录都添加到 pythonpath，则只`sitecustomize.py`执行**第一个**目录：

```
C:\test> set PYTHONPATH=C:\test\dir1\;C:\test\dir2\
C:\text> python
dir1
>>>exit()
C:\test> set PYTHONPATH=C:\test\dir2\;C:\test\dir1\
C:\text> python
dir2 
```

那么是否可以有多个目录`PYTHONPATH`和多个目录，`sitecustomize.py`或者我仅限于一个？文档指出我可以有很多目录`PYTHONPATH`，但它没有说任何关于`sitecustomize.py`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:31:34.990

是的，您可以在`PYTHONPATH`.

`sitecustomize`是一个在解释器启动时自动导入的模块。`sitecustomize.py`因此，如果您的 上有多个`PYTHONPATH`，则只会加载第一个。

该过程在[文档](http://docs.python.org/2/library/site.html)中进行了描述：

> 在这些路径操作之后，尝试导入一个名为 的模块`sitecustomize`，该模块可以执行任意特定于站点的自定义。它通常由系统管理员在 site-packages 目录中创建。如果此导入因`ImportError`异常而失败，则会被静默忽略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:03:51.607

我有时会做 sys.path.append() 来添加路径

# ruby-on-rails - Ruby/Rails 使用 || 确定值，使用空字符串而不是 nil 值

> ID：14415357
> 
> 赞同：26
> 
> 时间：2013-01-19T14:27:58.090
> 
> 标签：ruby-on-rails, ruby

我通常会

```
 value = input || "default" 
```

所以如果输入 = nil

```
 value = "default" 
```

但是我怎么能这样做而不是`nil`它也将一个空字符串计`''`为`nil`

我想要这样，如果我这样做

```
input = ''
value = input || "default"
=> "default" 
```

有没有一种简单优雅的方法来做到这一点`if`？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-01-19T14:36:56.250

Rails向所有执行您想要的操作的对象添加了[存在方法](http://api.rubyonrails.org/classes/Object.html#method-i-presence)

```
input = ''
value = input.presence || "default"
=> "default"

input = 'value'
value = input.presence || "default"
=> "value"

input = nil
value = input.presence || "default"
=> "default" 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-19T14:30:55.367

我通常这样做：

```
value = input.blank? ? "default" : input 
```

针对输入可能未定义的情况，您可以通过以下方式保护它：

```
value = input || (input.blank? ? "default" : input)
# I just tried that the parentheses are required, or else its return is incorrect 
```

对于纯红宝石（不依赖于 Rails），您可以`empty?`这样使用：

```
value = input || (input.empty? ? "default" : input) 
```

或者像这样*（感谢@substantial 提供这个）*：

```
value = (input ||= "").empty? ? "default" : input 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-18T09:14:52.523

也许无关紧要，但我会像这样使用高线：

```
require "highline/import"

input = ask('Input: ') { |q| q.default = "default" } 
```

它可以在没有 Rails 的情况下工作。真正巧妙的解决方案。

# css - 使用 CSS 覆盖字体颜色

> ID：14415358
> 
> 赞同：1
> 
> 时间：2013-01-19T14:27:58.357
> 
> 标签：css

我有一张桌子，里面有一些元素。这些元素之一的颜色与容器中设置的颜色不同。

当我悬停容器时，我需要具有不同颜色的元素更改为新的悬停：颜色（白色）。我试过使用`!important`，但我不能让它工作。

我正在谈论的元素是包含文本的元素`2 hours ago`

这是当前代码：

[http://jsfiddle.net/SKP6v/](http://jsfiddle.net/SKP6v/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:30:39.173

用这个：

```
.mail_item:hover .mail_item_table_time {
    color: white;
} 
```

演示：http: [//jsfiddle.net/SKP6v/1/](http://jsfiddle.net/SKP6v/1/)

# c# - WebClientExtensions - 下载数据任务

> ID：14415359
> 
> 赞同：0
> 
> 时间：2013-01-19T14:28:02.283
> 
> 标签：c#, .net, parallel-processing, extension-methods, task-parallel-library

我可能缺少一些基本的东西，但是这种方法是怎么来的：

```
namespace System.Net
{
    public static class WebClientExtensions
    {        
        public static Task<byte[]> DownloadDataTask(this WebClient webClient, string address)
        {
            return DownloadDataTask(webClient, new Uri(address));
        }
    }
} 
```

是这样调用的：

```
return new WebClient().DownloadDataTask(url) 
```

这取自 ParallelExtensionsExtras Tour - #16 - Async Tasks for WebClient。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:03:51.567

这种方法称为[扩展方法](http://msdn.microsoft.com/en-us/library/vstudio/bb383977.aspx)。它的区别在于`this`第一个参数前面有，您可以将其称为该参数的实例方法。

所以，你写的代码：

```
new WebClient().DownloadDataTask(url) 
```

实际上与以下内容完全相同：

```
WebClientExtensions.DownloadDataTask(new WebClient(), url) 
```

优点是它的语法更好。例如，几乎所有的 LINQ 也都基于扩展方法。

# php - 从 PHP 文件中获取“ActivityID”并将其放入 JS 脚本中。

> ID：14415360
> 
> 赞同：0
> 
> 时间：2013-01-19T14:28:09.390
> 
> 标签：php, javascript

我正在制作旅行指南。我正在显示来自数据库（mysql）的数据（活动）。每个活动都有自己的按钮。当您按下此按钮时，您会将特定活动添加到您的旅行指南中。这一切都有效，但我必须刷新页面以显示添加到指南中的活动。现在我制作了一个有效的 javascript 脚本，但它不是动态的。

```
function MakeRequest()
{
    var test = 1;
    var xmlHttp = getXMLHttp();

    xmlHttp.onreadystatechange = function()
    {
        if(xmlHttp.readyState == 4)
        {
            HandleResponse(xmlHttp.responseText);
        }
    }
    xmlHttp.open("GET", "get_test.php?q="+test, true); 

    xmlHttp.send(null);
} 
```

您会看到 de 变量：“var test = 1;” 数字 1 代表 ActivityID 1。所以现在，如果您按下按钮，它将显示 ActivityID = 1 的活动。如果我将数字更改为 2，则显示 ActivityID = 2 的活动。

我想更改变量：“var test = 1;” 该数字必须自动插入，它必须与按下按钮的活动的 ActivityID 相同。

```
<?php
$sql = "SELECT * FROM activity";
$stm = $db->prepare($sql);
$result = $stm->execute(array());

while($row = $stm->fetch(PDO::FETCH_ASSOC))
{
    echo '<div id="activity'.$row['ActivityID'].'">';
    echo '<img src="data:image/jpeg;base64,' . base64_encode( $row['ActivityIMG'] ) . '" >', '<br>';
    //echo $row['Activityname'], '<br>';
    //echo $row['Activitydescription'];
    echo '<input type="button" class="addActivity" onclick="MakeRequest();" value="Activiteit toevoegen" data-activity="' . $row['ActivityID'] . '">';
    echo '</div>';
}
?> 
```

这是 php 文件：“get_activity”。这是显示数据并显示按钮的代码。此按钮会自动从特定活动中获取 ActivityID。这样，我只需要一个脚本即可完成所有活动。我想对 javascript 做同样的事情，但我不知道怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:41:54.850

如果我了解您想根据您按下的按钮为 var test 提供正确的 ID。为什么不直接将参数传递给 js 函数？

```
 function MakeRequest(test){
       ...............
 }

   $test = $row['id'];//your id field 
   <input type="button" class="addActivity" onclick="MakeRequest(<?=$test?>);" value="Activiteit toevoegen" data-activity="' . $row['ActivityID'] . '"> 
```

# php - 使用 FPDF 将网页导出为 PDF

> ID：14415370
> 
> 赞同：2
> 
> 时间：2013-01-19T14:29:10.163
> 
> 标签：php, pdf-generation, fpdf, html-to-pdf

一个（希望）简单答案的复杂问题。

我正在研究 FPDF 以将网页导出为 PDF。该网页已针对打印媒体进行了格式化，但由于打印媒体可能与 CSS/HTML 渲染对象有点不确定，我希望导出为 PDF 然后打印会减少设计上的麻烦。

我浏览了 FPDF 网站，但没有看到我希望看到的功能。某种`include()`功能。我看到一堆关于格式化内容的行，我希望这意味着

我是不是想太多了？我可以简单地`include()`在 FPDF 构造函数之后使用，然后将其中的任何内容与页面一起打印吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T14:42:57.450

FPDF 库并不意味着直接将 HTML 标记呈现为 PDF。

如果这就是您想要做的，您可以尝试专门为此目的设计的解决方案之一。例如，[html2pdf 库](http://html2pdf.fr/en/default)，除其他外，它基于 FPDF 库。[您还可以考虑使用像DocRaptor](http://docraptor.com/)这样的外部 API ，这是一种基于非常昂贵的[Prince XML](http://www.princexml.com/)程序的经济高效的解决方案。

# android - 每个列表视图项目示例的个人偏好

> ID：14415371
> 
> 赞同：0
> 
> 时间：2013-01-19T14:29:18.227
> 
> 标签：android, listview, preference

为 Android 列表视图中的每个项目创建单独首选项的最简单方法是什么？我发现了这个[问题](https://stackoverflow.com/questions/3217720/individual-preferences-for-each-item-in-a-listview)，但它有点笼统。谁能更具体，可能举一个简单的例子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:35:21.990

如果你想这样做，你应该在你的适配器 getView 方法中写一些代码。

您可以在方法中检查位置（使用 if 子句）并根据位置添加自定义设计/布局。
如果您在 ListView 项目 XML 中使用 LinearLayout 或 RelativeLayout，您可以在 getView 方法中以编程方式填充您需要的所有小部件（edittext、复选框等）。

# canvas - 当 alpha < 1 时，如何创建一个具有填充和描边且描边不重叠的路径的矩形？

> ID：14415373
> 
> 赞同：0
> 
> 时间：2013-01-19T14:29:41.527
> 
> 标签：canvas, rectangles

我需要用不重叠的路径制作一个矩形（因为我希望一些边缘是另一种颜色，例如或另一种带点线的线型等等）（所以当我将 alpha 设置为 0.5 时，一些边缘不会更暗由于重叠）与画布2d。

我试过用 lineCap 来做，但它在 alpha 中重叠......

检查我做了什么，但不是很好。[http://jsfiddle.net/kLZfc/6/](http://jsfiddle.net/kLZfc/6/)

只有 3px 有效，1px 不...

```
var ctx = document.querySelector('canvas').getContext('2d');
var offset;

offset = 10.5;
ctx.lineWidth = 3;
ctx.globalAlpha = 0.5
ctx.beginPath();
ctx.strokeStyle = 'red';
ctx.lineTo(offset, offset);
ctx.lineTo(offset + 10, offset);
ctx.lineTo(offset + 10, offset + 10);
ctx.lineTo(offset, offset + 10);
ctx.lineTo(offset, offset);
ctx.stroke();

offset = 25.5;
ctx.lineWidth = 3;
ctx.globalAlpha = 0.5
ctx.beginPath();
ctx.strokeStyle = 'red';
ctx.lineTo(offset, offset);
ctx.lineTo(offset + 10, offset);
ctx.lineTo(offset + 10, offset + 10);
ctx.lineTo(offset, offset + 10);
ctx.lineTo(offset, offset);
ctx.closePath();
ctx.stroke();

offset = 40.5;
ctx.lineWidth = 1;
ctx.globalAlpha = 0.5
ctx.beginPath();
ctx.strokeStyle = 'red';
ctx.lineTo(offset, offset);
ctx.lineTo(offset + 10, offset);
ctx.lineTo(offset + 10, offset + 10);
ctx.lineTo(offset, offset + 10);
ctx.lineTo(offset, offset);
ctx.closePath();
ctx.stroke();

offset = 55.5;
ctx.lineWidth = 1;
ctx.globalAlpha = 0.5
ctx.beginPath();
ctx.strokeStyle = 'red';
ctx.lineTo(offset, offset);
ctx.lineTo(offset + 10, offset);
ctx.lineTo(offset + 10, offset + 10);
ctx.lineTo(offset, offset + 10);
ctx.lineTo(offset, offset);
ctx.stroke();

offset = 70.5;
ctx.lineWidth = 1;
ctx.lineCap = "square";
ctx.globalAlpha = 0.5
ctx.beginPath();
ctx.strokeStyle = 'red';
ctx.lineTo(offset, offset);
ctx.lineTo(offset + 10, offset);
ctx.lineTo(offset + 10, offset + 10);
ctx.lineTo(offset, offset + 10);
ctx.lineTo(offset, offset);
ctx.stroke(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:54:54.647

好的，这是带有内部笔划的**像素完美**矩形：http: [//jsfiddle.net/kLZfc/9/](http://jsfiddle.net/kLZfc/9/)

```
var ctx = document.querySelector('canvas').getContext('2d');
var offset;
ctx.strokeStyle = "black"
ctx.lineJoin = "miter";

var cSq = function(x, y, width, height, stroke){
    x = x + stroke / 2;
    y = y + stroke / 2;
    ctx.lineWidth = stroke;
    ctx.lineCap = "square";
    ctx.beginPath();
    ctx.strokeStyle = 'red';
    ctx.lineTo(x, y);
    if(stroke === 1){
        ctx.lineTo(x + width, y);
    }else{
        ctx.lineTo(x + width - stroke, y);
    }
    ctx.moveTo(x + width - stroke, y);
    ctx.lineTo(x + width - stroke, y + height - stroke);
    ctx.lineTo(x, y + height - stroke);
    ctx.moveTo(x, y + height - stroke * 2);
    ctx.lineTo(x, y);
    ctx.globalAlpha = 0.5
    ctx.stroke()
    ctx.globalAlpha = 0.7
    ctx.fillRect(x + stroke / 2, y + stroke / 2, width - stroke*2, height - stroke*2)
}
cSq(10, 11, 10, 15, 1); cSq(15, 22, 25, 44, 5); 
```

# caching - 相干冲洗延迟设置

> ID：14415375
> 
> 赞同：1
> 
> 时间：2013-01-19T14:30:02.730
> 
> 标签：caching, distributed-caching, oracle-coherence

我想要一个缓存来检查自己的项目是否过期。我的缓存配置如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<cache-config>
    <caching-scheme-mapping>
        <cache-mapping>
            <cache-name>subscriberinfo</cache-name>
            <scheme-name>distributed-scheme</scheme-name>
        </cache-mapping>
    </caching-scheme-mapping>

    <caching-schemes>

        <distributed-scheme>
            <scheme-name>distributed-scheme</scheme-name>
            <lease-granularity>member</lease-granularity>
            <service-name>DistributedCache</service-name>
            <serializer>
                <instance>
                    <class-name>com.tangosol.io.pof.ConfigurablePofContext</class-name>
                    <init-params>
                        <init-param>
                            <param-type>String</param-type>
                            <param-value>rbm-shovel-pof-config.xml</param-value>
                        </init-param>
                    </init-params>                
                </instance>    
            </serializer>  
            <backing-map-scheme>
                <local-scheme>
                    <unit-calculator>BINARY</unit-calculator>
                    <expiry-delay>24h</expiry-delay>
                    <flush-delay>180</flush-delay>
                </local-scheme>
            </backing-map-scheme>
            <autostart>true</autostart>
        </distributed-scheme>
    </caching-schemes>
</cache-config> 
```

但问题是，无法设置刷新延迟。有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T18:16:02.280

您使用哪个版本的 Coherence？

在 Coherence 3.7 中，[flush-delay 已从](http://docs.oracle.com/cd/E18686_01/coh.37/e21505/technotes.htm)dtd 中删除，自 3.5 版以来已弃用。刷新只是在插入新对象（查看[eviction-policy](http://docs.oracle.com/cd/E24290_01/coh.371/e22837/appendix_cacheconfig.htm#r7c1-t43)）或访问过期对象（查看[expiry-delay](http://docs.oracle.com/cd/E24290_01/coh.371/e22837/appendix_cacheconfig.htm#r12c1-t43)）时激活。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-14T17:05:58.620

Coherence 在 3.5 中弃用了 FlushDelay 和相关设置。现在所有这些工作都是自动完成的：

*   过期的物品会被自动移除，并相应地引发驱逐/过期事件

*   您永远不会在缓存中看到过期数据；即使您尝试在它到期时访问它，到期也会在数据访问发生之前作为事件发生

*   驱逐（用于内存限制）现在是异步完成的，因此驱逐副作用（例如事件风暴）的“锋利边缘”分布在自然周期中（周期长度根据估计的驱逐率计算） )

我希望这会有所帮助。

*为了全面披露，我在 Oracle 工作。这篇文章中表达的观点和观点是我自己的，并不一定反映我雇主的观点或观点。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-25T16:24:12.307

> > 但问题是，无法设置刷新延迟。有任何想法吗？

你这是什么意思？系统是否抛出错误或过期项目未从缓存中删除。根据您的配置，该条目应在自上次更新条目后 24 小时 180 秒后从缓存中删除。

# apache - 使用根域的子域的查询字符串重写规则

> ID：14415377
> 
> 赞同：-1
> 
> 时间：2013-01-19T14:30:20.330
> 
> 标签：apache, .htaccess

我不是 .htaccess 方面的专家。我想将我的新闻和博客网址（带或不带 www）重写为：

bdnews24.com/reporter.php?u=名称到-> bdnews24.com/Name

m.bdnews24.com/reporter.php?u=名称到-> m.bdnews24.com/Name

img.bdnews24.com/image.php?id=791011.jpg to-> img.bdnews24.com/791011.jpg

bdnews24.com/details.php?id=100200300 to-> bdnews24.com/100200300

我当前的 .htaccess 文件在下面，它没有按我的意愿工作。这会捕获所有请求 URI，如果不存在，它将转到 index.php?u=ANYTHING

```
Options +FollowSymlinks
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
# AlegroCart REWRITES START
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*) index.php/$1 [L,QSA] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T17:23:40.680

根据您提供的信息，这组规则应该可以满足您的需求：

```
RewriteCond {%QUERY_STRING} ^u=(.*)
RewriteCond %{HTTP_HOST} ^(m.|www.)?bdnews.com$
RewriteRule ^reporter.php /%1?

RewriteCond {%QUERY_STRING} ^id=(.*)
RewriteCond %{HTTP_HOST} ^img.bdnews.com$
RewriteRule ^image.php /%1?

RewriteCond {%QUERY_STRING} ^id=(.*)
RewriteCond %{HTTP_HOST} ^(m.|www.)?bdnews.com$
RewriteRule ^details.php /%1? 
```

首先它匹配查询字符串，然后是主机名，然后将原始查询字符串 (%1) 重写为新 URL。

# opengl - 在 GLSL 中应用自定义投影矩阵（到纹理坐标）

> ID：14415381
> 
> 赞同：0
> 
> 时间：2013-01-19T14:30:46.443
> 
> 标签：opengl, glsl

我想通过在后期处理着色器中转换它来查看平面全屏纹理，因为它是球形的。

我想我必须将投影矩阵应用于着色器中的纹理坐标。

我找到了这个网站：[http](http://www.songho.ca/opengl/gl_projectionmatrix.html) ://www.songho.ca/opengl/gl_projectionmatrix.html ，它让我学到了很多关于投影矩阵的内部知识。

但是我该如何应用呢？我想我必须将投影矩阵的第三行乘以纹理坐标，并加上计算得到的 z 值以使其成为球形。我的努力没有显示任何结果。

编辑：我在这里看到同样的问题：http: [//lists.openscenegraph.org/pipermail/osg-users-openscenegraph.org/2008-April/009765.html](http://lists.openscenegraph.org/pipermail/osg-users-openscenegraph.org/2008-April/009765.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:45:37.643

我认为在将文本坐标乘以投影矩阵之后，您必须进行透视划分并从 3D 移动到 2D（因为纹理是 2D）。这与阴影贴图相同。

```
// in fragment shader:
vec4 proj = uniformModelViewProjMatrix * tex_coords;
proj.xyz /= proj.w;
proj.xyz += vec3(1.0);
proj.xyz *= 0.5;
vec4 col = texture2D(sampler, proj.xy); 
```

或查看[http://www.ozone3d.net/tutorials/glsl_texturing_p08.php](http://www.ozone3d.net/tutorials/glsl_texturing_p08.php) (for `texture2DProj`)

# algorithm - 散列中可能的冲突

> ID：14415382
> 
> 赞同：-3
> 
> 时间：2013-01-19T14:30:48.537
> 
> 标签：algorithm

If`h`是任何散列函数，用于将`n`键散列到大小为 的表中`m`，其中`n<=m`，涉及特定键的预期冲突数`x`为：

```
(A) Less than 1
(B) Less than n
(C) Less than m
(D) Less than n/2 
```

我想出的是，它应该小于`n`但我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:35:14.783

你最好阅读生日悖论。

以下是一些链接：

[生日问题](http://en.wikipedia.org/wiki/Birthday_problem)

[理解生日悖论](http://betterexplained.com/articles/understanding-the-birthday-paradox/)

并引用第二个链接：

> 以下是生日悖论的一些教训：
> 
> *   sqrt(n) 大致是您需要有 50% 的机会与 n 个项目匹配的数字。sqrt(365) 大约是 20。这在密码学中用于生日攻击。
> *   即使有 2^128 (1e38) 个 GUID，我们也只有 2^64 (1e19) 个可以在 50% 的碰撞几率之前用完。50% 真的非常高。
> *   你只需要 13 个人选择字母表就有 95% 的匹配机会。在上面试试（人 = 13，项目 = 26）。
> *   指数增长迅速降低了挑选独特物品的机会（也就是增加了比赛的机会）。请记住：指数是非直觉的，人类是自私的！

# opengl - OpenGL 3.2：通过透明纹理投射右阴影

> ID：14415387
> 
> 赞同：0
> 
> 时间：2013-01-19T14:31:03.217
> 
> 标签：opengl, glsl

我似乎在网上找不到任何关于修复对象阴影投射的信息，这些纹理具有 alpha != 1。

有没有办法实现“每片段深度测试”之类的东西，而不是“每顶点”，所以如果彩色纹素具有透明度，我可以丢弃片段在阴影贴图上的出现？此外，理论上，它可以使阴影映射更准确。

**编辑**

好吧，也许这是我上面给出的一个糟糕的想法，但我只想告诉着色器，如果纹素的 alpha<1，则不需要在纹素后面隐藏东西。我猜深度纹理只需要顶点信息，这就是为什么每个关于阴影贴图的教程都最小化了顶点和空片段着色器，并且在尝试使用片段着色器做某事时没有任何反应。

无论如何，通过部分透明的对象修复阴影投射的主要思想是什么？

**编辑2**

我已经修改了我的着色器，现在它会丢弃每个片段，如果至少有一个片段具有透明度 o_O。所以这些对象现在不投射任何阴影（但不透明）......请看一下着色器：

```
// Vertex Shader
uniform mat4 orthoView;

in vec4 in_Position;
in vec2 in_TextureCoord;
out vec2 TC;

void main(void) {
TC = in_TextureCoord;
        gl_Position = orthoView * in_Position; 
} 
```

.

```
//Fragment Shader
uniform sampler2D texture;

in vec2 TC;

void main(void) {
vec4 texel = texture2D(texture, TC);
if (texel.a < 0.4)
    discard;
} 
```

这很奇怪，因为我在我的其他着色器中使用相同的技巧和相同的纹理，它可以工作......有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:18:56.880

如果在片段着色器中使用丢弃，则不会为该片段记录深度信息。因此，在您的片段着色器中，只需添加一个测试以查看纹理是否透明，如果是则丢弃该片段。

# ruby-on-rails - Rails 未跟踪的文件到 Heroku 服务器

> ID：14415389
> 
> 赞同：3
> 
> 时间：2013-01-19T14:31:17.227
> 
> 标签：ruby-on-rails, heroku

我正在尝试将 rails 应用程序部署到 heroku，并且我知道他们的文件系统是只读的，并且只包含最新的代码。我通过[本指南](https://devcenter.heroku.com/articles/git)使用 git 存储库。我有一个配置文件，包含密码和其他我不想在 git 上跟踪的东西，但我必须将它们上传到 heroku。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T15:41:47.127

与其将机密信息存储在应用程序文件中，不如使用[config vars在 heroku 上将它们设置为环境变量](https://devcenter.heroku.com/articles/config-vars)

参考：[https ://stackoverflow.com/a/7832040/429758](https://stackoverflow.com/a/7832040/429758)

# php - 计算目录的子目录大小 (PHP)

> ID：14415390
> 
> 赞同：0
> 
> 时间：2013-01-19T14:31:24.867
> 
> 标签：php

我有一个文件夹，其中包含年份的子文件夹（例如 2011、2012 等）。每年的文件夹包含月份文件夹（例如 02、09 等）。

如何计算月份文件夹的总大小并将它们与年份和月份文件夹名称一起列出？

**例子：**

**目录名称 - 大小**

06/2008 - 52KB

10/2010 - 151MB

27/2012 - 852MB

2013 年 12 月 1 日 - 5GB

干杯。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T17:43:54.233

**你可以试试**

```
echo "<pre>";
$depth = 1;

$ritit = new RecursiveIteratorIterator(new RecursiveDirectoryIterator(__DIR__, RecursiveDirectoryIterator::SKIP_DOTS), RecursiveIteratorIterator::CHILD_FIRST);
$r = array();
foreach ( $ritit as $splFileInfo ) {
    if ($ritit->getDepth() === $depth && $splFileInfo->isDir()) {
        printf("%s - %s \n", $splFileInfo, getSize($splFileInfo));
    }
}

function getSize($dir, $precision = 2) {
    $ritit = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($dir, RecursiveDirectoryIterator::SKIP_DOTS));
    $bytes = 0;
    foreach ( $ritit as $v ) {
        $bytes += $v->getSize();
    }
    $units = array('B','KB','MB','GB','TB');
    $bytes = max($bytes, 0);
    $pow = floor(($bytes ? log($bytes) : 0) / log(1024));
    $pow = min($pow, count($units) - 1);
    $bytes /= pow(1024, $pow);
    return round($bytes, $precision) . ' ' . $units[$pow];
} 
```

**您也可以尝试使用这种方法`FilterIterator`**

```
$depth = 1;
$it = new RecursiveDirectoryIterator("./", RecursiveDirectoryIterator::SKIP_DOTS);
$it = new RecursiveIteratorIterator($it, RecursiveIteratorIterator::SELF_FIRST);
$it = new FileDepthFilterIterator($it, $depth, FileDepthFilterIterator::ONLY_DIR);

foreach ( $it as $splFileInfo ) {
    printf("%s\n", new RecusiveSizeInfo($splFileInfo));
} 
```

使用的类

```
class FileDepthFilterIterator extends FilterIterator {
    private $it;
    private $depth;
    private $type;
    const ONLY_DIR = 1;
    const ONLY_FILE = 2;
    const BOTH_DIR_FILE = 3;

    function __construct(RecursiveIteratorIterator &$iterator, $depth, $type) {
        $this->it = &$iterator;
        $this->depth = $depth;
        $this->type = $type;
        parent::__construct($this->it);
    }

    function accept() {
        if ($this->getDepth() != $this->depth) {
            return false;
        }
        if ($this->type == self::ONLY_DIR && ! $this->getInnerIterator()->current()->isDir()) {
            return false;
        }
        if ($this->type == self::ONLY_FILE && ! $this->getInnerIterator()->current()->isFile()) {
            return false;
        }

        return true;
    }
}

class RecusiveSizeInfo {
    /**
     *
     * @var SplFileInfo
     */
    private $info;
    private $numFiles = 0;
    private $numFolder = 0;
    private $bytes = 0;

    function __construct(SplFileInfo $info) {
        $this->info = $info;
        $this->parse();
    }

    public function getNumFiles() {
        return $this->numFiles;
    }

    public function getNumFolder() {
        return $this->numFolder;
    }

    public function getBytes() {
        return $this->bytes;
    }

    public function __toString() {
        return sprintf("%s\t%s\t%s", $this->info, $this->formatSize($this->getBytes()), json_encode(array("file" => $this->numFiles,"dir" => $this->numFolder)));
    }

    private function parse() {
        $ritit = new RecursiveIteratorIterator(new RecursiveDirectoryIterator($this->info , RecursiveDirectoryIterator::SKIP_DOTS),RecursiveIteratorIterator::SELF_FIRST);
        foreach ( $ritit as $v ) {
            $v->isFile() and $this->numFiles ++;
            $v->isDir() and $this->numFolder ++;
            $this->bytes += $v->getSize();
        }
    }

    private function formatSize($bytes) {
        $units = array('B','KB','MB','GB','TB');
        $bytes = max($bytes, 0);
        $pow = floor(($bytes ? log($bytes) : 0) / log(1024));
        $pow = min($pow, count($units) - 1);
        $bytes /= pow(1024, $pow);
        return round($bytes, 2) . ' ' . $units[$pow];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:36:57.130

查看[此答案](https://stackoverflow.com/a/8348396/427992)以计算目录的大小。要实现，您将需要[递归遍历目录结构](http://php.net/manual/en/class.recursivedirectoryiterator.php)，或手动指定所需的目录：

```
<li>2012/01 <?php echo foldersize('/2012/01'); ?></li>
<li>2012/02 <?php echo foldersize('/2012/01'); ?></li> 
```

# html - mathml - 长等式一侧的换行符

> ID：14415394
> 
> 赞同：0
> 
> 时间：2013-01-19T14:32:57.350
> 
> 标签：html, webkit, line-breaks, mathml

为了说明我的问题，我有以下 mathML。

```
 <math>
        <msup>
            <mrow>
                <mo>(</mo>
                <msup>
                    <mn>2</mn>
                    <mn>3</mn>
                </msup>
                <mo>)</mo>
            </mrow>
            <msup>
                <mn></mn>
                <mn>4</mn>
            </msup>
        </msup>
        <mn>=</mn>
        <mn>(2*2*2)*(2*2*2)*(2*2*2)*(2*2*2)</mn>
    </math> 
```

它在下面的屏幕截图底部呈现文本。我想要发生的是，如果最后一个 (2*2*2) 不适合一行，它会直接出现在第一个下方。但是，如果屏幕足够宽，可以将所有内容放在一条线上，我希望它能够做到这一点。 ![在此处输入图像描述](../Images/da0120d55c5db266de56c6a1ac66ba6d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T21:17:16.827

那场决赛

```
<mn>(2*2*2)*(2*2*2)*(2*2*2)*(2*2*2)</mn> 
```

已经放弃了标记并将其全部放在一个数字中，这并没有真正给 MathML 渲染器一个机会。最好是

```
<mrow>    
 <mrow><mo>(</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>)</mo></mrow>
 <mo>*</mo>
 <mrow><mo>(</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>)</mo></mrow>
 <mo>*</mo>
 <mrow><mo>(</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>)</mo></mrow>
 <mo>*</mo>
 <mrow><mo>(</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>*</mo> <mn>2</mn><mo>)</mo></mrow>
</mrow> 
```

MathML3 具有特定的换行和对齐属性，理论上可以让您显式设置对齐点，`=`但是您的图片看起来像移动设备，我认为还没有 MathML3 实现。可能像上面那样标记 rhs 就足够了，但如果不是 MathML2 指定对齐的方法将是使用单行表。就像是：

```
<math><mtable><mtr><mtd>
     <mrow>
        <msup>
            <mrow>
                <mo>(</mo>
                <msup>
                    <mn>2</mn>
                    <mn>3</mn>
                </msup>
                <mo>)</mo>
            </mrow>
            <msup>
                <mn></mn>
                <mn>4</mn>
            </msup>
        </msup>
        <mn>=</mn>
     </mrow>
</mtd><mtd columnalign="left">
<mrow>    
 <mrow><mo>(</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>)</mo></mrow>
 <mo>*</mo>
 <mrow><mo>(</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>)</mo></mrow>
 <mo>*</mo>
 <mrow><mo>(</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>)</mo></mrow>
 <mo>*</mo>
 <mrow><mo>(</mo><mn>2</mn><mo>*</mo><mn>2</mn><mo>*</mo> <mn>2</mn><mo>)</mo></mrow>
</mrow>

        </mtd></mtr></mtable>
    </math> 
```

# hbase - 从 HBase shell 获取具有复合行键的表

> ID：14415397
> 
> 赞同：0
> 
> 时间：2013-01-19T14:33:29.577
> 
> 标签：hbase

对于具有两个整数的复合行键的表，从 hbase shell 获取行的命令应该是什么。

我创建了这个示例 ruby​​ 脚本

```
include Java
import org.apache.hadoop.hbase.util.Bytes

id   = ARGV[0]
sid  = ARGV[1]

byte [] rowkey = Bytes.add(Bytes.toBytes(id.to_i),Bytes.toBytes(sid.to_i))
puts Bytes.toStringBinary (rowkey) 
....
....
.... 
```

当我调用 hbase org.jruby.Main script.rb 10 20 \x00\x00\x00\x00\x00\x00\x00\x0A\x00\x00\x00\x00\x00\x00\x00\x14 时看到的输出这清楚地显示了 16 个字节长。如何确保它是 8 个字节长（4 个用于 id，4 个用于 sid）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T20:14:43.587

这是因为`toBytes`被重载以同时接受`long`和`int`参数，并且 JRuby 总是转换`Fixnum`为`long`. 无法使用`int`参数选择重载。

相反，您必须使用另一种方法来创建数组。首先初始化一个空数组，然后添加每个ID：

```
rowkey = Java::byte[8].new
Bytes.putInt(rowkey, 0, id.to_i)
Bytes.putInt(rowkey, 4, sid.to_i) 
```

# rest - 设计带有从浏览器使用的二进制数据的 REST Web 服务的最佳方法

> ID：14415398
> 
> 赞同：33
> 
> 时间：2013-01-19T14:33:35.630
> 
> 标签：rest, backbone.js, binary-data, restful-architecture

我正在开发一个 json REST Web 服务，该服务将从使用主干网构建的单个网页应用程序中使用。

此 API 将允许消费者上传与某些实体相关的文件，例如与项目相关的 pdf 报告

谷歌搜索并在堆栈溢出方面进行了一些研究，我提出了这些可能的方法：

**第一种方法：** **base64 编码数据字段**

```
POST: /api/projects/234/reports
{
  author: 'xxxx',
  abstract: 'xxxx',
  filename: 'xxxx',
  filesize: 222,
  content: '<base64 encoded binary data>'
} 
```

**第二种方法：多部分表单发布：**

```
POST: /api/projects/234/reports
{
  author: 'xxxx',
  abstract: 'xxxx',
} 
```

作为回应，我将获得一个报告 ID，然后我将发布另一个帖子

```
POST: /api/projects/234/reports/1/content
enctype=multipart/form-data 
```

然后只发送二进制数据

（看看这个：[https](https://stackoverflow.com/a/3938816/47633) ://stackoverflow.com/a/3938816/47633 ）

**第三种方法：将二进制数据发布到单独的资源并保存 href**

首先我在客户端生成一个随机密钥并在那里发布二进制内容

```
POST: /api/files/E4304205-29B7-48EE-A359-74250E19EFC4
enctype=multipart/form-data 
```

接着

```
POST: /api/projects/234/reports
{
  author: 'xxxx',
  abstract: 'xxxx',
  filename: 'xxxx',
  filesize: 222,
  href: '/api/files/E4304205-29B7-48EE-A359-74250E19EFC4'
} 
```

（见：[https](https://stackoverflow.com/a/4032079/47633) ://stackoverflow.com/a/4032079/47633 ）

我只是想知道是否有任何其他方法可以使用，每种方法的优缺点，以及是否有任何既定的方法来处理这种要求

我看到第一种方法的最大缺点是我必须在客户端上完全加载和 base64 编码文件

**一些有用的资源：**

*   [将二进制数据发布到 RESTful 应用程序](https://stackoverflow.com/questions/4032032/post-binary-data-to-a-restful-application)
*   [将二进制数据传输到 HTTP REST API 服务的好方法是什么？](https://stackoverflow.com/questions/1509743/what-is-a-good-way-to-transfer-binary-data-to-a-http-rest-api-service)
*   [如何使用 REST Web 服务上传包含元数据的文件？](https://stackoverflow.com/questions/3938569/how-do-i-upload-a-file-with-metadata-using-a-rest-web-service?rq=1)
*   [使用 Web 服务传输大型有效负载的坏主意？](https://stackoverflow.com/questions/1500744/bad-idea-to-transfer-large-payload-using-web-services)
*   [https://stackoverflow.com/a/5528267/47633](https://stackoverflow.com/a/5528267/47633)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2016-06-02T11:23:38.460

我的研究结果：

1.  **单个请求（包括数据）**

    该请求包含元数据。数据是元数据的属性并经过编码（例如：Base64）。

    优点：

    *   事务性的
    *   每次都有效（不丢失元数据或数据）

    缺点：

    *   编码使请求非常大

    例子：

    *   [推特](https://dev.twitter.com/rest/reference/post/account/update_profile_image)
    *   [GitHub](https://developer.github.com/v3/git/blobs/#create-a-blob)
    *   [伊姆古尔](https://api.imgur.com/endpoints/image)
2.  **单个请求（多部分）**

    该请求包含一个或多个带有元数据和数据的部分。

    内容类型：

    *   [多部分/表单数据](https://www.rfc-editor.org/rfc/rfc7578)
    *   [多部分/混合](https://www.rfc-editor.org/rfc/rfc2046#section-5.1.3)
    *   [多部分/相关](https://www.rfc-editor.org/rfc/rfc2387)

    优点：

    *   事务性的
    *   每次都有效（不丢失元数据或数据）

    缺点：

    *   内容类型协商很复杂
    *   数据的内容类型在[WADL中不可见](https://www.w3.org/Submission/wadl/)

    例子：

    *   [Confluence](https://docs.atlassian.com/confluence/REST/5.9.11/#d3e314)（包含数据和元数据部分）
    *   [Jira](https://docs.atlassian.com/jira/REST/7.1.7/#api/2/issue/%7BissueIdOrKey%7D/attachments-addAttachment)（一部分用于数据，仅元数据部分用于文件名和 MIME 类型的标题）
    *   [Bitbucket](https://developer.atlassian.com/static/rest/bitbucket-server/4.6.2/bitbucket-rest.html#idp2587840)（一部分用于数据，没有元数据）
    *   [Google Drive](https://developers.google.com/drive/v2/web/manage-uploads#multipart)（一部分用于元数据，一部分用于数据）
3.  **单个请求（HTTP 标头和 URL 中的元数据）**

    请求正文包含数据和 HTTP 标头，URL 包含元数据。

    优点：

    *   事务性的
    *   每次都有效（不丢失元数据或数据）

    缺点：

    *   没有嵌套的元数据

    例子：

    *   S3 [GetObject](https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetObject.html)和[PutObject](https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutObject.html)
4.  **两个请求**

    一个元数据请求和一个或多个数据请求。

    优点：

    *   可扩展性（例如：数据请求可以到存储库服务器）
    *   可恢复（参见例如[Google Drive](https://developers.google.com/drive/v2/web/manage-uploads#resumable)）

    缺点：

    *   不是事务性的
    *   并非每次都有效（在第二次请求之前，缺少一部分）

    例子：

    *   [谷歌云端硬盘](https://developers.google.com/drive/v2/web/manage-uploads#simple)
    *   [YouTube](https://developers.google.com/youtube/v3/docs/videos/insert)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-23T05:12:43.397

我想不出任何其他方法。

在您的 3 种方法中，我最常使用方法 3。我看到的最大区别是第一种方法和其他两种方法：将元数据和内容分成 2 个资源

*   优点：可扩展性
    *   虽然您的解决方案涉及发布到同一服务器，但可以轻松更改为将内容上传指向单独的服务器（即 Amazon S3）
    *   在第一种方法中，为用户提供元数据的同一台服务器将有一个进程被大型上传阻塞。
*   缺点：孤立数据/增加复杂性
    *   失败的上传（元数据或内容）将在服务器数据库中留下孤立的数据
    *   可以使用计划作业清理孤立数据，但这会增加代码复杂性
    *   方法 II 减少了孤立的可能性，代价是更长的客户端等待时间，因为您阻塞了第一个 POST 的响应

第一种方法似乎是最直接的编码方法。但是，如果预计不经常使用此服务，我只会使用第一种方法，并且您可以对用户文件上传设置合理的限制。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-09-05T09:50:45.717

我相信最终的方法是 3 号（单独的资源），因为它允许最大化我从 HTTP 标准中获得的价值，这与我对 REST API 的看法相符。例如，假设正在使用一个基础良好的 HTTP 客户端，您将获得以下好处：

*   **内容压缩**：如果客户端表示支持，您的 API 不变，现有客户端继续工作，未来的客户端可以使用它，您可以通过允许服务器以压缩结果响应来进行优化
*   **缓存**：If-Modified-Since、ETag 等。客户端可以避免完全重新获取二进制数据
*   **内容类型**抽象：例如，您需要上传的图像，它可以是类型`image/jpeg`或`image/png`. HTTP 标头**Accept**和**Content-type**为我们提供了一些优雅的语义，用于在客户端和服务器之间进行协商，而无需将其全部硬编码为我们的架构和/或 API 的一部分

另一方面，如果所讨论的二进制数据不是可选的，我相信可以得出这样的结论：这种方法不是最简单的。[在这种情况下， Eric Hu 的答案](https://stackoverflow.com/a/15037309/43597)中列出的缺点将发挥作用。

# php - 这是在我的网站上创建新页面的一个糟糕的长期策略吗？

> ID：14415399
> 
> 赞同：-3
> 
> 时间：2013-01-19T14:34:02.420
> 
> 标签：php, mysql

我创建了一个类似于 IMDB.com 的自定义 CMS

目前，我在自定义后端 CMS 中填写电影信息，单击“添加”后，它会在服务器上为每部电影创建一个文件夹和文件。

IE：它将创建 /movie-name/quotes/

最终这将等同于数百个文件/文件夹。以这种方式短期/长期这样做有什么缺点吗？

我知道有些脚本会动态填充布局，而不是按照我提到的方式进行。

我是走错了路还是没关系？

网站结构基于PHP/Mysql

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:57:43.717

就像我在评论中所说的那样，这确实是一个坏主意，并且完全没有必要使用数据库。至于为什么这很糟糕，我只给你一个简单的例子......

假设您有一个电影报价数据库。过了一会儿，您决定在每条引语上都加上演员的名字，作为指向该演员页面的锚链接。除了手动编辑Web 系统中的**每个文件之外，您还有其他方法吗？**想想看。

这是最简单的场景之一。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T15:22:16.453

拥有一个后端 CMS，然后用它创建前端 HTML 页面是完全可以的。

使此页面创建自动化且可复制，以便您可以在布局更改时轻松地重新生成整个站点。

注意 URI 不会改变，因为[*酷 URI 不会改变*](http://www.w3.org/Provider/Style/URI.html)。

顺便说一句，许多好的工作网站都是这样制作的。静态网站非常有效。

其中一些网站做出了妥协，它们不仅生成 HTML，还生成少量 PHP 代码以满足某些需求，例如与用户交互或检索远程数据（自然也以缓存方式）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T14:39:40.513

您应该关心的是，您创建 URL 的策略是否能长期有效。显然，只要您没有得到任何重复的电影名称，它就可以。

除此之外，您必须回答如何获取任何 URL 背后的资源，这不一定与从 URL 到文件系统的 1:1 映射有关。它可能作为启动器以这种方式工作，但以后可以在不更改 URL 系统的情况下进行更改。

# crm - Microsoft Dynamics 2011 - 自动化报价流程（生成报价，一次性附加到电子邮件）

> ID：14415402
> 
> 赞同：1
> 
> 时间：2013-01-19T14:34:29.447
> 
> 标签：crm, microsoft-dynamics

我正在开发 Microsoft Dynamics CRM 2011。我已经掌握了大部分基础知识，但是可以通过一些反馈/建议来处理报价方面的事情。

我制作了一份自定义报价报告，以确保我们的组织品牌和产品详细信息格式正确，但目前通过电子邮件发送报价的流程是；

1.  创造机会并将产品转化为报价。
2.  运行报价报告（PDF 格式）。
3.  将 PDF 附加到电子邮件中。
4.  在电子邮件中输入客户的电子邮件地址并将其设置为机会。

理想情况下，我希望在生成报价时可以将其附加到带有客户电子邮件地址的电子邮件中，并将其视为机会。

关于我将如何做到这一点的任何建议，或者至少是其中的一部分？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-29T21:42:49.857

The long and short of it is unfortunately not all of this is possible without some coding to help it along. The problem you're going to hit is the automatic report generation. What you're looking at here is a workflow with some custom workflow activity (c# code) to help it along. I haven't ever needed to do this, but this is an idea of what you need to do:

1.  Create a new Workflow Process based on a Quote
2.  Set it as an on demand process
3.  The Workflow will create a new email based on the quote details
4.  Launch and attach the report to the email and send it

Point 4 needs to execute as a custom workflow activity (some C# code) that knows what report to run (or is told what report to run) and how to attach it to the email. And it then can send the email for you.

Now, that's all fine if you're working with CRM on-premise, but I have as of yet to see if custom workflow activities are support in CrmOnline. If not you'll need to use a custom entity and some plugins to work around this instead.

So, it's possible, but not without some development to help it along. You need to take a look at workflows to see how much they can help you though.

# java - 使用二进制搜索的多个键的最后索引？

> ID：14415408
> 
> 赞同：2
> 
> 时间：2013-01-19T14:35:25.493
> 
> 标签：java, c++, algorithm, search, binary

我在排序数组中有多次出现的键，并且我想对它们执行二进制搜索，正常的二进制搜索会为多次出现的键返回一些随机索引，其中我想要该键最后一次出现的索引.

```
int data[] = [1,2,3,4,4,4,4,5,5,6,6];
int key = 4;
int index = upperBoundBinarySearch(data, 0, data.length-1, key);

Index Returned = 6 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-19T14:58:44.707

[此答案](https://stackoverflow.com/a/6676588/1321716)中的 Java 实现会找到第*一次*出现的键。有一条[关于](https://stackoverflow.com/questions/6676360/first-occurrence-in-a-binary-search/6676588#comment7915352_6676588)如何更改它以找到*最后一次*出现的评论，但建议会导致无限循环。不过，这个想法似乎很合理。

**编辑：**经过一番研究，我[在 The Algo Blog 上找到了一个简洁的解决方案](http://the-algo-blog.blogspot.be/2011/06/binary-search-to-find-last-and-first.html)。由于第一个找到的匹配不一定是需要的，因此您需要跟踪迄今为止的“最佳”匹配。当你得到一个匹配时，你存储它并继续在匹配的右边进行二分搜索（`low = mid + 1`）。

```
public static int binarySearch(int[] a, int key) {
    return binarySearch(a, 0, a.length, key);
}

private static int binarySearch(int[] a, int fromIndex, int toIndex,
        int key) {
    int low = fromIndex;
    int high = toIndex - 1;
    int found = -1;

    while (low <= high) {
        int mid = (low + high) >>> 1;
        int midVal = a[mid];

        if (midVal < key) {
            low = mid + 1;
        } else if (midVal > key) {
            high = mid - 1;
        } else {
            found = mid;
            // For last occurrence:
            low = mid + 1;
            // For first occurrence:
            // high = mid - 1;
        }
    }
    return found;
} 
```

这种变化保持了`O(log n)`复杂性。不过，实际性能取决于应用程序。当数组的长度远大于所寻找的键的重复数量时，对最后一次出现的线性搜索可能会更快。但是，当有很多重复项时，这种修改后的二进制搜索可能更可取。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T14:42:47.513

大概你想要一个*O(log N)*解决方案？（否则你可以做一个线性搜索。）

在 C++ 中，一种可能性（在几种可能性中）是使用[std::upper_bound](http://en.cppreference.com/w/cpp/algorithm/upper_bound)。这将为您提供一个大于您要求的第一个元素的迭代器，因此您需要检查前一个元素。这确实是*O(log N)*。

我不知道 Java 是否提供了这个标准库方法。但是，上面的链接中给出了伪代码`upper_bound`，并且应该很容易重新实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T20:04:26.713

好吧，感谢所有人，尤其是@Mattias，该算法听起来不错。无论如何，我已经完成了自己的工作，这似乎我给出了更好的结果，但是如果有人可以帮助我衡量我的算法和@Mattias 的复杂性，或者任何人有更好的解决方案，欢迎...... .无论如何，这是我为这个问题找到的解决方案，

```
int upperBound(int[] array,int lo, int hi, int key)
{
    int low = lo-1, high = hi;
    while (low+1 != high)
    {
        int mid = (low+high)>>>1;
        if (array[mid]> key) high=mid;
        else low=mid;
    }
    int p = low;
    if ( p >= hi || array[p] != key )
        p=-1;//no key found
    return p;
} 
```

这是第一次出现，我也用另一个类似的帖子更新相同[的二分搜索中的第一次出现](https://stackoverflow.com/questions/6676360/first-occurrence-in-a-binary-search?lq=1)

```
int lowerBound(int[] array,int lo, int hi, int key)
{
    int low = lo-1, high = hi;
    while (low+1 != high)
    {
        int mid = (low+high)>>>1;
        if (array[mid]< key) low=mid;
        else high=mid;
    }
    int p = high;
    if ( p >= hi || array[p] != key )
        p=-1;//no key found
    return p;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T15:02:14.260

当你找到钥匙时。而不是返回它对数组进行顺序搜索以获取最后一个。这将是 O(N) 解决方案。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-15T09:46:47.263

这是二进制搜索的**递归**版本。稍微调整一下这个版本会给你最后一个索引或第一个索引，零努力和相同的复杂度 O(log-n)。

原始的二分查找递归版本如下所示：

```
public static int binarySearch(List<Integer> a, int startIndex, int endIndex, int key) {
    int midIndex = (endIndex - startIndex)/2 + startIndex;
    if (a.get(midIndex) == key) // found!
        return midIndex;
    if (startIndex == endIndex || startIndex == endIndex - 1)
        return -1;
    else if (a.get(midIndex) > key) // Search in the left
        return binarySearch(a, 0, midIndex, key); 
    else if (a.get(midIndex) < key) // Search in the right
        return binarySearch(a, midIndex, endIndex, key);
    else
        return -1; // not found 
} 
```

对第一个 if 语句稍作改动，就可以得到第一个索引：

```
public static int binarySearchLowIndex(List<Integer> a, int startIndex, int endIndex, int key) {
    int midIndex = (endIndex - startIndex)/2 + startIndex;
    if (a.get(midIndex) == key && a.get(midIndex - 1) != key) // found!
        return midIndex;
    if (startIndex == endIndex || startIndex == endIndex - 1)
        return -1;
    else if (a.get(midIndex) >= key) // Search in the left
        return binarySearchLowIndex(a, 0, midIndex, key); 
    else if (a.get(midIndex) < key) // Search in the right
        return binarySearchLowIndex(a, midIndex, endIndex, key);
    else
        return -1; // not found 
} 
```

最后一个索引也是如此：

```
public static int binarySearchHighIndex(List<Integer> a, int startIndex, int endIndex, int key) {
    int midIndex = (endIndex - startIndex)/2 + startIndex;
    if (a.get(midIndex) == key **&& a.get(midIndex + 1) != key**) // found!
        return midIndex;
    if (startIndex == endIndex || startIndex == endIndex - 1)
        return -1;
    else if (a.get(midIndex) > key) // Search in the left
        return binarySearchHighIndex(a, 0, midIndex, key); 
    else if (a.get(midIndex) <= key) // Search in the right
        return binarySearchHighIndex(a, midIndex, endIndex, key);
    else
        return -1; // not found 
} 
```

以下是一些测试示例（基于 Junit）：

```
@Test
public void binarySearchTest() {
    assert(BinarySearch.binarySearch(Arrays.asList(5, 7, 7, 8, 8, 10), 0, 5, 5) == 0);
}

@Test
public void binarySearchLowIndexTest() {
    assert(BinarySearch.binarySearchLowIndex(Arrays.asList(5, 8, 8, 8, 8, 10), 0, 5, 8) == 1);
}

@Test
public void binarySearchHighIndexTest() {
    assert(BinarySearch.binarySearchHighIndex(Arrays.asList(5, 8, 8, 8, 8, 10), 0, 5, 8) == 4);
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-01-19T14:52:00.587

在二进制搜索中，您将您的键与数组 data[i] 的元素进行比较。要获得最后一个匹配的索引，您应该更改比较函数，以便即使 key 等于 data[i] 也等于 data[i+1]，它也会给出不等式。

```
int upperBoundBinarySearch(int data[],int start, int end, int key) {
  while(start < end) {
    int middle = start + (end-start)/2;
    if (data[middle] == key && (middle == end || data[middle+1] != key))
      return middle;
    if (data[middle] > key)
      end = middle;
    else {
      if (start == middle)
        return start;
      start = middle;
    }
  }
  return start;
} 
```

# javascript - 动态填充多个 JQuery 进度条

> ID：14415412
> 
> 赞同：1
> 
> 时间：2013-01-19T14:35:46.950
> 
> 标签：javascript, jquery, html, jsp

我有几个 Jquery 进度条，我需要动态填充它们，每个都有不同的值。

HTML 代码附在下面：

```
<div id="Wrapper">
<form method="POST" action="ClearPoll">
    <div id="mydiv" class="Gadget">
        <input class="PercentageHid" type="hidden" value="36" name="Percentage">
            <object class="GadgetActualImage" type="image/jpeg" data="http://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg"> </object>

        <div class="Information">
            <input class="PollViewName" type="text" value="Potatoe Masher" placeholder="Please Enter the Gadget Name" name="Name" readonly="">
            <textarea id="" class="GadgetDescription" name="Comment" cols="10" rows="4" readonly="">You'll Never Stop Mashing ! </textarea>
        </div>
            <div id="Potatoe Masher" class="ProgressBar ui-progressbar ui-widget ui-widget-content ui-corner-all" title="Gadget Reputation: 36.0 % " data-options="80" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="36">
            <div class="ui-progressbar-value ui-widget-header ui-corner-left" style="width: 36%;"></div>
        </div>
    </div>
</form>

<form method="POST" action="ClearPoll">
    <div id="mydiv" class="Gadget">
        <input class="PercentageHid" type="hidden" value="52" name="Percentage">
        <object class="GadgetActualImage" type="image/jpeg" data="http://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg"> </object>
    <div class="Information">
        <input class="PollViewName" type="text" value="Butter Slicer" placeholder="Please Enter the Gadget Name" name="Name" readonly="">
        <textarea id="" class="GadgetDescription" name="Comment" cols="10" rows="4" readonly="">No More Work </textarea>
    </div>
    <div id="Butter Slicer" class="ProgressBar ui-progressbar ui-widget ui-widget-content ui-corner-all" title="Gadget Reputation: 52.0 % " data-options="80" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="36">

    <div class="ui-progressbar-value ui-widget-header ui-corner-left" style="width: 36%;"></div>
    </div>
    </div> 
```

每个进度条应采用隐藏输入字段“百分比”中的值

我当前的 Javascript 文件如下所示：

```
$(document).ready(function () {
   var text = $(this).find('[name="Percentage"]').val();   
   $(function() {
      alert(text);
      $('.ProgressBar').progressbar({
         value: parseInt(text)
      });
   });
}); 
```

JavaScript 代码有效，但它将百分比值设置为所有进度条，而不是相应的。

本质上，我需要的是获取隐藏字段中的值并将该值以相同的形式应用于进度条。

谢谢你..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:45:58.567

通常，当您需要初始化需要多个实例的实例特定数据的插件时，您需要遍历元素并单独初始化，而不是一次初始化整个元素集合：

在这种情况下，您可以遍历每个表单：

```
$(document).ready(function () {

    $('form').each(function () {
        var text = $(this).find('[name="Percentage"]').val();
        /* iniitialize the progress bar within this form*/
        $(this).find('.ProgressBar').progressbar({
            value: parseInt(text)
        });
    });
}); 
```

# android - Android-如何等待 AlertDialog 检查？

> ID：14415414
> 
> 赞同：0
> 
> 时间：2013-01-19T14:36:28.480
> 
> 标签：android, error-handling, dialog, android-alertdialog

我正在创建一个`AlertDialog`并`AlertDialog.Builder`显示它。显示后，我需要暂停应用程序，直到用户确认对话框。

我确实需要在显示 Dialog 线程的方法中暂停，因为它的调用方法在返回后会引发致命错误。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-11T18:21:25.523

另一种处理方法是使用线程。在非 UI 线程中`AlertDialog`，`show()`使用`runOnUiThread()`. `Activity`调用`Object.wait()`您的非 UI 线程，并调用`Object.notifyAll()`您`AlertDialog`的`OnClickListener`. 然后，非 UI 线程将等到用户单击您的`AlertDialog`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:56:10.720

在 Android 中，您不能暂停 UI 线程，因为它会导致操作系统`Application is not responding`在暂停大约 5 秒后显示对话框。

此外，正如 CommonsWare 在评论中提到的，对话框不在单独的线程中运行。

如果没有看到您的代码，这有点难以回答，但我现在可以建议的是将您需要“暂停”的所有代码放在`AsyncTask`.

您可以将所有代码放在方法中的暂停之前`onPreExecute()`，而不是显示您的对话框，并在`doInBackground()`方法中，可能在一个while循环或带有易失变量或其他东西的东西中（此代码在后台线程上运行，因此它不会卡住UI-Thread)，然后是`onPostExecute()`方法中暂停后的代码。两者都`onPreExecute()`在`onPostExecute()`UI 线程上运行。完成后`onPost`调用`doInBackground`。

但是同样，如果您要显示一些暂停代码，它会更容易帮助您。

进一步阅读：[异步任务](http://developer.android.com/reference/android/os/AsyncTask.html)

# jsf - Primefaces 验证后无法在表单中输入任何内容？

> ID：14415415
> 
> 赞同：2
> 
> 时间：2013-01-19T14:36:30.780
> 
> 标签：jsf, primefaces

这是我的表格..

```
<p:panel id="panel" header="Portfolio Transaction">
            <p:messages id="msgs" />

            <p:panelGrid columns="7" id="transactionPanel" style="display: inline-block;">
                <f:facet name="header"> 
                    Register New Trade
                </f:facet>

                <h:outputLabel for="tipsSuggestionBoxId" value="Company Name:*"></h:outputLabel>

                <h:outputText value="Date:*" />

                <h:outputText value="Type:*" />

                <h:outputText value="Quantity:*" />

                <h:outputText value="Price:*" />

                <h:outputText value="Brokerage:" />

                <h:outputText value="Notes:" />

                <p:autoComplete id="tipsSuggestionBoxId"
                    completeMethod="#{portfolioTransactionBean.autoSelectCompany}"
                    value="#{portfolioTransactionBean.txnCurrentRecord.companyName}"
                    minChars="3" nothingLabel="No similar company found"
                    requestDelay="1" minQueryLength="3" required="true"
                    requiredMessage="Company Name Cannot be empty">
                </p:autoComplete>

                <p:calendar id="from_date" size="10" required="true"
                    requiredMessage="Date Cannot be empty"
                    value="#{portfolioTransactionBean.txnCurrentRecord.umptTransDate}"
                    mode="popup" showOn="both" pattern="dd/MM/yyyy"
                    popupIconOnly="true" readonly="#{facesContext.renderResponse}">
                </p:calendar>

                <p:selectOneMenu id="tranType"
                    value="#{portfolioTransactionBean.txnCurrentRecord.umptTransType}">
                    <f:selectItem itemLabel="Transaction Type" itemValue="" />
                    <f:selectItem itemLabel="Buy" itemValue="Buy" />
                    <f:selectItem itemLabel="Sell" itemValue="Sell" />
                </p:selectOneMenu>

                <p:spinner id="transQuntity" required="true"
                    value="#{portfolioTransactionBean.txnCurrentRecord.umptQty}" min="1"    label="Quanity" size="5"
                    validatorMessage="Field Is mandatory" />

                <p:spinner id="transPrice" required="true" size="5"
                    value="#{portfolioTransactionBean.txnCurrentRecord.umptPrice}"
                    label="Price"
                    validatorMessage="Field Is mandatory" />

                <p:spinner id="brokerage" size="5"
                    value="#{portfolioTransactionBean.txnCurrentRecord.umptBrokerage}"  />

                <h:inputText
                    value="#{portfolioTransactionBean.txnCurrentRecord.umptNotes}" />

                <f:facet name="footer">
                    <p:commandButton value="Save Transaction " icon="ui-icon-check"
                        action="#{portfolioTransactionBean.savePortfolioTransaction}"
                        update="panel" style="float:right;right:20%;">
                        <p:resetInput target="transactionPanel" />
                    </p:commandButton>
                    <p:spacer width="100" height="10" />
                    <p:commandButton value="Clear" update="transactionPanel"
                        process="@this">
                        <p:resetInput target="transactionPanel" />
                    </p:commandButton>
                </f:facet>

            </p:panelGrid> 
```

在表单验证失败后，如用户未输入日期或公司名称，我能够看到正确的消息，但之后我无法从键盘输入任何值。任何人都知道代码有什么问题。

仅当验证失败时才会出现此问题，即使我单击了清除按钮，我也遇到了同样的问题。有人得到这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T09:35:40.017

是的，primefaces 中的某些组件确实如此。唯一的解决方案是尝试使用一些其他组件来替换问题组件。或者如果出现错误，则显示错误，如果用户收到错误消息，则编写一个刷新整个屏幕的代码。当然，用户需要再次输入所有详细信息。

# objective-c - 检查 SLServiceTypeFacebook 和 twitter 时出错

> ID：14415416
> 
> 赞同：0
> 
> 时间：2013-01-19T14:36:48.367
> 
> 标签：objective-c, facebook, ios5, twitter, social-framework

我的应用支持 iOS 5+。现在我想添加 facebook 和 twitter。我添加了 social.framework 作为可选，并在 facebook btn 我检查

```
if([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]) {
        NSLog(@"Facebook iOS 6 avaliable");
}
else
{
 NSLog(@"Feature not supported"); // for iOS 5 users
} 
```

推特也一样。但 iOS 6 模拟器工作正常，但 iOS 5 模拟器给出错误。在 iOS 5 和 iOS 6 上添加 facebook 和 twitter 共享的任何帮助或教程。

```
EXC_BAD_ACCESS (code=2, address=0x0) isAvailableForServiceType:SLServiceTypeFacebook
isAvailableForServiceType:SLServiceTypeTwitter 
```

为答案 1 更新项目后，出现此错误。

![在此处输入图像描述](../Images/52735ca5369f93ae3a178a7d5f98f40e.png) 这是前缀文件 ![在此处输入图像描述](../Images/07f27f163852c2f8d0fc524db64fbfdc.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T14:52:23.660

`Social`框架 ( ) 仅在 iOS 6 中引入。`SLComposeViewController`在 iOS 5 中，与任何社交网络的唯一本地连接是 Twitter 和`TWTweetComposeViewController`类。iOS 6 引入了`Social`具有预先存在的 Twitter 支持和新的 Facebook 和新浪微博集成的框架。

因此，在 iOS 5 上，您实际上无法对 进行任何引用或调用`SLComposeViewController`，您需要使用条件来查看用户设备正在运行哪个版本（iOS 5 或 6），然后进行任何操作/条件。

该代码`if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook])`用于查看用户是否在设置应用程序中设置了 Facebook 帐户。

是的，所以你添加了`Twitter`iOS 5 兼容性的框架，顺便确保`Social`框架设置为可选。

要检查设备正在运行的版本，请将其添加到您的`MyApp-Prefix.pch`文件中：

```
#define SYSTEM_VERSION_EQUAL_TO(v)         ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedSame)
#define SYSTEM_VERSION_GREATER_THAN(v)       ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedDescending)
#define SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(v) ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] != NSOrderedAscending)
#define SYSTEM_VERSION_LESS_THAN(v)         ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] == NSOrderedAscending)
#define SYSTEM_VERSION_LESS_THAN_OR_EQUAL_TO(v)   ([[[UIDevice currentDevice] systemVersion] compare:v options:NSNumericSearch] != NSOrderedDescending) 
```

然后你可以在任何类中使用它，因为前缀文件会自动导入所有类：

```
if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(@"5.0") && SYSTEM_VERSION_LESS_THAN(@"6.0")) {

       NSLog(@"This is called when device is running iOS 5, 5.0.1, 5.1 etc.");
}
else if (SYSTEM_VERSION_GREATER_THAN_OR_EQUAL_TO(@"6.0")) {

       NSLog(@"iOS 6.0, 6.0.1, 6.0.2, 6.1 etc.");
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-19T15:05:01.853

```
EXC_BAD_ACCESS (code=2, address=0x0) 
```

所以这个错误是一个“分段错误”，因为 Social 框架是一个 iOS6-only 框架。由于您使用了弱链接（这就是将框架添加为“可选”的意思），`SLComposeViewController`该类是`Nil`（即它实际上指向无效的内存地址`0x0`），因此您尝试调用它的任何函数很可能会导致分段错误（因为无法取消引用此地址）。

你需要做的是检查这个类是一个有效的指针：

```
if (NSClassFromString(@"SLComposeViewController") != Nil) {
    // iOS 6
} else {
    // iOS 5, Social.framework unavailable, use Twitter.framework instead
} 
```

# graphviz - GraphViz 自定义后退箭头

> ID：14415419
> 
> 赞同：2
> 
> 时间：2013-01-19T14:36:57.793
> 
> 标签：graphviz

我有以下代码：

```
digraph "Classes utilisées par Git"
{
    subgraph mother
    {
        O [shape=record, label = "{GitObject| ref (sha1)}"];
    }
    subgraph herited
    {
        rankdir=LR;
        rank="same";
        "Tree" [shape=box];
        "Tag" [shape=box];
        "Blob" [shape=box];
        "Commit" [shape=box];
    }
    O -> "Tree" [arrowhead="onormal", dir=back];
    O -> "Blob" [arrowhead="onormal", dir=back];
    O -> "Commit" [arrowhead="onormal", dir=back];
    O -> "Tag" [arrowhead="onormal", dir=back];
    "Tree" -> "Tree" [arrowhead="vee", label=" 0..*\n0..*1"];
    "Tree" -> "Blob" [arrowhead="vee", label=" 0..*\n1"];
    "Commit" -> "Tree" [arrowhead="vee", label=" 1..*\n1"];
    "Tag" -> "Commit" [arrowhead="vee", label=" 0..*\n1"];
} 
```

这给了我：

![在此处输入图像描述](../Images/0218a287f45eeeff924fbfab66c39999.png)

我工作得很好，但 GitOject 方向的箭头并不异常，他们是一种方法吗？

为了您的帮助，在此先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T01:51:08.747

只需使用`arrowtail="onormal"`而不是`arrowhead="onormal"`边缘显示不正确。

`arrowtail`总是指定义的边缘的尾部，并且不考虑`dir=back`.

# ruby-on-rails - redirect_to 内部视图 - RAILS - DEVISE 重定向到 user_session_path

> ID：14415425
> 
> 赞同：1
> 
> 时间：2013-01-19T14:37:54.277
> 
> 标签：ruby-on-rails, redirect, path, devise

如何重定向到视图内的某个路径或页面。我读过redirect_to 是一个ActionController 的东西，不能在视图中使用。如何仅使用 Rails 在视图中执行此操作，除此之外，我如何在控制器或模型或助手中编写重定向，然后仅在视图中写入实例变量。我正在使用设计。我不想使用 Javascript 或 JQuery。只是导轨！

我试过这个：

```
class Post < ActiveRecord::Base
  attr_accessible :content, :title
  @Uchecker = user_signed_in?
  redirect_to user_session-path
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:05:45.733

当您从控制器使用 *redirect_to* 时，它不是渲染视图，而是渲染 http 重定向

现在，如果您想从视图中进行重定向，您仍然可以使用 javascript

```
<script type="text/javascript">
  window.location = "<%= user_session_path %>";
</script> 
```

不是最佳做法，但它有效，并且它是中间页面的常见做法（即，当您搜索旅行时，旅行搜索可能需要 60 秒，因此您呈现一个视图，您可以在其中向用户显示您正在搜索的内容为了最好的旅行，你做一个 javascript 重定向，一旦结果准备好，页面就会被加载）。

# windows - 无法在 windows cmd 中为变量设置值

> ID：14415426
> 
> 赞同：1
> 
> 时间：2013-01-19T14:37:59.547
> 
> 标签：windows, batch-file, cmd

我无法设置变量的值`foo`。脚本如下：

```
@echo off
set foo = %1
echo %foo% 
```

我将其作为输出：

```
ECHO is off 
```

谁能告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T14:41:45.173

删除等号周围的空格：

```
@echo off
set foo=%1
echo %foo% 
```

**编辑（详细说明）：**

你得到`ECHO is off`是因为`%foo%`没有设置任何东西，所以命令提示符只会看到`ECHO`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T14:41:51.757

删除`set`命令中的多余空格：

```
set foo=%1 
```

# algorithm - 如何从电子商务网站创建产品列表？

> ID：14415427
> 
> 赞同：-4
> 
> 时间：2013-01-19T14:37:59.733
> 
> 标签：algorithm, text

我不确定这是否是要问的正确网站，但我走了。

我想从电子商务网站创建一个通用产品列表。例如，如果我有这个：

```
Acer Aspire X 4GB RAM ---- $400
Acer Aspire X 4GB RAM ---- $410
Acer Aspire X 4GB RAM ---- $420
Acer Aspire X 2GB RAM ---- $350
Apple macbook X 8GB RAM ---- $1400
Apple macbook X 6GB RAM ---- $1200
Apple macbook X 6GB RAM ---- $1220            (notice that some products can be repeated here) 
```

我需要通过分类信息来得到这个：

```
1- Acer Aspire X 4GB
2- Acer Aspire X 2GB 
3- Acer macbook 8GB 
4- Acer macbook 6GB 
```

那么，我应该使用什么样的技术？

先感谢您！！

现在我正在使用 php，但我认为它可以用任何语言编写。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-21T06:53:06.150

好吧，如果您使用的是 PHP，您可以尝试使用和增强我使用过的功能。它不是很先进，也会有更好的方法。例如，此功能逐字比较，但您也可以逐字比较。如果您有大量产品，那么您可能会遇到问题，因为您需要将所有产品相互比较。然而，最好和最快的方法可能是使用 SQL 和全文搜索。

PHP代码：

```
function getSimilarStart($s1, $s2) {
    $split1 = explode(' ', $s1);
    $split2 = explode(' ', $s2);

    $starta = array();
    $start = '';
    foreach ($split1 as $k => $v) {
        if (isset($split2[$k]) && $v == $split2[$k] && $start == substr($s2, 0, strlen($start))) {
            $starta[] = $v;
            $start = join (' ', $starta);
        } else {
            return $start;
        }
    }

    return $start;   
} 
```

# java - IntelliJ 未创建未知用法的方法

> ID：14415428
> 
> 赞同：0
> 
> 时间：2013-01-19T14:38:05.327
> 
> 标签：java, intellij-idea

在 IntelliJ 12 上，与 [1] 中所说的相反，在编写尚未在其使用位置定义的方法名称时，不会带来任何弹出窗口。

例如，在下面的示例中，给定一个已经存在的类 SomeClass，我希望 IntelliJ 在编写“notYetDefinedMethod”之后让我在 SomeClass 上创建一个静态 void 方法，但这不会发生。

```
    无效富（）{
        SomeClass.notYetDefinedMethod();
    }

```

这与用户 lichengwu（来自 CrazyCoder 的回答）在问题 [2] 中观察到的行为相同，但似乎仍然没有答案。

如何实现[1]中提到的行为？

[1] [http://www.jetbrains.com/idea/features/code_generation.html#link11](http://www.jetbrains.com/idea/features/code_generation.html#link11)

[2] [IntelliJ IDEA中如何生成void方法？](https://stackoverflow.com/questions/12543977/how-to-generate-a-void-method-in-intellij-idea)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:59:04.427

经过进一步研究，我发现 Coffeescript 插件的一个问题 [1] 可能会导致意图不显示。总而言之，我禁用了 Coffeescript 插件，现在我又有了意图和这样的完成。

[1] [http://youtrack.jetbrains.com/issue/IDEA-97685](http://youtrack.jetbrains.com/issue/IDEA-97685)

# c# - 如何禁用事件？

> ID：14415429
> 
> 赞同：2
> 
> 时间：2013-01-19T14:38:05.987
> 
> 标签：c#

我创建`btn1_MouseDown`事件。

 `````
 private void btn1_MouseDown(object sender, MouseEventArgs e)
    {
        btn1.BackgroundImage = Properties.Resources.click;
    } 
```

I want to disable that `btn1_MouseDownt` Event behind this `RadioButton` when it checked. I mean to say when `Radiobutton` checked then this `btn1_MouseDown` event should not work.` 

```
 private void r1_CheckedChanged(object sender, EventArgs e)
    {

        if (r1.Checked == true)
            clock = 5;

        radioButton2.Enabled = false;
        radioButton3.Enabled = false;
        radioButton4.Enabled = false;     
    } 
```

那可能吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:41:39.623

里面`r1_checkeChanged`添加：

```
btn1.MouseDown -=btn1_MouseDown; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:43:21.723

您可以删除事件：

```
btn1.MouseDown -= btn1_MouseDown 
```

当然不要忘记在需要时再次添加它。

* * *

但是，我不会这样做，而是更改您的事件处理程序的代码以检查单选按钮的状态：

```
private void btn1_MouseDown(object sender, MouseEventArgs e)
{
    if (!r1.Checked)
        btn1.BackgroundImage = Properties.Resources.click;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T14:45:34.690

`1st option`可以在单选按钮 check_change 事件中删除事件，如下所示：

> btn1.MouseDown -=btn1_MouseDow;

但我不喜欢这种方式。
`Second`就是在这个事件开始时添加一个标志并检查是否执行该事件，如下所示：

```
bool flag;

private void btn1_MouseDown(object sender, MouseEventArgs e)
{
    if (flag) return;
    btn1.BackgroundImage = Properties.Resources.click;
} 
````

# android - 如何使用有按钮的弹出菜单？

> ID：14415431
> 
> 赞同：0
> 
> 时间：2013-01-19T14:38:23.483
> 
> 标签：android, eclipse, popup

我正在为android编写一个程序，我想使用一个弹出菜单，它有两个按钮，当我点击每个按钮时，它们会打开另一个活动。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T14:44:44.683

视图如下所示：

```
View view = getLayoutInflater().inflate(R.layout.SOME_LAYOUT, false);
Button button1 = (Button) view.findViewById(R.id.BUTTON1_ID);
button1.setOnClickListener(...start new Activity); 
Button button2 = (Button) view.findViewById(R.id.BUTTON2_ID);
button2.setOnClickListener(...start new Activity); 
```

将此视图设置为内容：

```
PopupWindow popup = new PopupWindow(getContext());
popup.setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_NOTHING);
popup.setContentView(view);
popup.setWidth(view.getWidth());
popup.setHeight(view.getHeight());
popup.setFocusable(true);
popup.showAsDropDown(PARENT_VIEW); 
```

视图是膨胀的布局，它有两个带有设置点击侦听器的按钮。父视图将在单击时显示此弹出窗口。

祝你好运！

# linq-to-xml - 仅选择 Distinct() 元素

> ID：14415432
> 
> 赞同：0
> 
> 时间：2013-01-19T14:39:14.540
> 
> 标签：linq-to-xml

我只想区分查询中的唯一元素。我有：

```
public string GetOutline(int indentLevel, XElement element)
{
    StringBuilder result = new StringBuilder();

    result = result.AppendLine(new string('-', indentLevel * 2) + element.Name);

    foreach (var childElement in element.Elements().OfType<XElement>().Select(x => x.Element).Distinct()) 
    {
        result.Append(GetOutline(indentLevel + 3, childElement));
    }

    return result.ToString();
} 
```

不幸的是，我收到这样的错误：

> 错误 2 无法从用法中推断方法“System.Linq.Enumerable.Select(System.Collections.Generic.IEnumerable, System.Func)”的类型参数。尝试明确指定类型参数。C:\Users\Piotrek\Desktop\INZYNIERIA_OPROGRAMOWANIA\TK\LABORKI_I\XMLe\XMLe\Form1.cs 27 42 XMLe

# vb.net - 如何将输入形式从选中的列表框转换为索引并让该索引跨两种形式工作？

> ID：14415433
> 
> 赞同：0
> 
> 时间：2013-01-19T14:39:19.500
> 
> 标签：vb.net, indexing, checkedlistbox, case-statement

我的选中列表框有 200 个需要转换为索引的东西。该索引必须适用于两种形式。因此，在模块化中处理变量将是一个合乎逻辑的操作。但是，在模块化中，选中的列表框不存在，因此出现错误。我试图实现的是在选定的文本框上改变颜色并流动

```
Select Case Row
                Case 0
                    TxtA1.BackColor = Color.Red
                Case 1
                    TxtA2.BackColor = Color.Red
                Case 2
                    TxtA3.BackColor = Color.Red
                Case 3
                    TxtA4.BackColor = Color.Red
                Case 4
                    TxtA5.BackColor = Color.Red
               ...
               case 200
                    TxtB67.BackColor = Color.Red
                  end select 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:39:17.973

1.) 在*模块*中，您可以访问所有表单及其公共成员，例如使用`Form1.CheckedListBox1`。或者`Form1.Controls("CheckedListBox1")`
2.) 当程序员做超过 201 个案例的单调、重复性工作时，就会出现问题。您应该考虑另一种方法来将检查的索引与这些标签映射。您可以使用名称本身或`Tag`属性对其进行迭代（例如`Form1.Controls("txtColored_" & i.ToString)`在循环中）（尽管仍有更好的解决方案，具体取决于您的设计细节）。*3.) 如果未*
选择 标签，您可能希望重置标签的颜色，在这种情况下，您必须为 201 个案例中的每个标签设置颜色。

# html - Chrome 1px 行错误

> ID：14415434
> 
> 赞同：1
> 
> 时间：2013-01-19T14:39:22.513
> 
> 标签：html, css, google-chrome

我正在制作一个粉丝网站，并且在新闻栏上有非常愚蠢的错误。当我缩放页面时，会出现 1px 线。

![示例图片](../Images/048ed0421c069002ecccc7dae93b2959.png)

这是代码：

```
<div class="velikibar">
<div id="velikibar_h">
    <div id="naslovbar"><?=$naslov?></div>
</div>
<div id="velikibar_b">
    <div class="paddingvelikibar">
    <?=$sadrzaj?>
    </div>
</div>
<div id="velikibar_f">
    <div id="fblikedugme"><?=$vreme?><br /><div class="fb-like" data-href="http://********.**/article.php?id=<?=$id?>" data-send="false" data-layout="button_count" data-width="100" data-show-faces="false"></div></div>
    <div id="komentarbarbox"><a href="article.php?id=<?=$id?>" target="_self">Komentari (<?=$brkomentara?>)</a></div>
</div> 
```

这是 CSS ( [http://tny.cz/d9fb11db](http://tny.cz/d9fb11db) )：

```
.velikibar
{
    background-color:transparent;
    width: 652px;
}

#velikibar_h
{
    background-image:url('slike/velikibar_h.png');
    background-repeat: no-repeat;
    width: 652px;
    height: 109px;
    padding: 0;
    margin: 0;
}

#velikibar_b
{
    background-image:url('slike/velikibar_b.png');
    background-repeat: repeat-y;
    width: 652px;
    min-height: 30px;
    padding: 0;
    margin: 0;
}

#velikibar_f
{
    background-image:url('slike/velikibar_f.png');
    background-repeat: no-repeat;
    width: 652px;
    height: 112px;
    padding: 0;
    margin: 0;
}

#velikibar_f2
{
    background-image:url('slike/velikibar_f2.png');
    background-repeat: no-repeat;
    width: 652px;
    height: 112px;
    padding: 0;
    margin: 0;
}

.paddingvelikibar
{
    padding: 5px 35px 5px 30px;
    text-align:justify;
    color: #fff5f9;
}

#fblikedugme
{
    position: absolute;
    margin-left: 35px;
    margin-top: 40px;
    color:#fff5f9;
    line-height: 20px;
}

#komentarbarbox
{
    position: absolute;
    margin-left: 425px;
    margin-top: 65px;
}

#komentarbarbox a, #komentarbarbox a:link, #komentarbarbox a:visited
{
    font-size: 14px;
    font-weight: bold;
    text-shadow: 0 1px 0 #6f1c3f;
    color: #fdd2e4; 
    text-decoration:none;
}

#komentarbarbox a:hover, #komentarbarbox a:focus
{
    color: #d61566;
    text-decoration:none;
}

#naslovbar
{
font: 23px/1.4em arial, helvetica;
color: #e1aec4;
padding-top: 50px;
padding-left: 35px;
text-shadow: #FCFCFC 0px 1px 0px;
}

.paddingvelikibar img
{
    background-color: #fff2f7;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius: 4px;
    behavior: url("skripte/ie-css3.htc");
    padding: 4px;
} 
```

请帮我解决这个问题。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:05:57.030

这似乎是一个浏览器错误。

例如，一个 5px 宽的元素，以 1.5 倍缩放查看，其宽度为 7.5px，但浏览器必须将其四舍五入为完整的 pxls，因此可能会发生这种情况。

为确保不会发生这种情况，您可以使元素重叠，或者在您的情况下，最好不要将粉红色背景图像分成 2 个元素，而是让一个元素承载整个图像。

Chrome 不使用字体调整大小作为缩放选项，因此这不太可能是由特定的 css 行引起的。

# android - Android：找不到 startActivityForResult request_code

> ID：14415439
> 
> 赞同：2
> 
> 时间：2013-01-19T14:39:43.280
> 
> 标签：android

我想设置一个`imageview`并让用户设置他自己的图像，我发现如何在另一个问题上做到这一点，但所有答案都包含类似或或的`startActivityForResult`函数属性，但我的日食说那些没有定义，为什么？`PICK_IMAGE``SELECT_IMAGE``ACTIVITY_IMAGE_SELECTOR`

# 编辑

```
Intent intent = new Intent();
            intent.setType("image/*");
            intent.setAction(Intent.ACTION_GET_CONTENT);
            startActivityForResult(
                    Intent.createChooser(intent, "Select Picture"), PICK_IMAGE); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:46:05.463

在顶部声明这个变量：

```
int PICK_IMAGE = 101; 
```

这只是一个与您的活动结果匹配的请求代码。

**参考 ：**

[选择图像意图](https://stackoverflow.com/a/5086706/556975)

[如何在 Android 应用程序中从图库中选择图像](http://viralpatel.net/blogs/pick-image-from-galary-android-app/)

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T14:47:46.767

在您的 MainActvity.java 中：

```
public class MainActivity extends Activity
{
   static MainActivity instance= null;
   protected void onCreate(Bundle savedInstanceState) 
   {
       super.onCreate(savedInstanceState);
       instance = this; 
    }
} 
```

在你的课堂上做：

```
MainActivity.instance.startActivityForResult(intent,request_code); 
```

# android - 如何使用装载机 用我自己的适配器？

> ID：14415440
> 
> 赞同：0
> 
> 时间：2013-01-19T14:39:53.567
> 
> 标签：android, android-contentprovider, android-loadermanager

尝试实现加载程序管理器以与我的内容提供程序和数据库一起使用时出现一些错误。

**我将从 logcat 输出开始：**

```
1-19 16:37:33.628: I/(20193): Loaded EGL implementation /system/lib//egl/libEGL_tegra_impl
01-19 16:37:33.648: I/(20193): Loading GLESv2 implementation /system/lib//egl/libGLESv2_tegra_impl
01-19 16:37:33.883: E/CursorWindow(20193): Failed to read row 0, column -1 from a CursorWindow which has 11 rows, 1 columns.
01-19 16:37:33.883: W/dalvikvm(20193): threadid=1: thread exiting with uncaught exception (group=0x40cfc2d0)
01-19 16:37:33.893: E/AndroidRuntime(20193): FATAL EXCEPTION: main
01-19 16:37:33.893: E/AndroidRuntime(20193): java.lang.IllegalStateException: Couldn't read row 0, col -1 from CursorWindow.  Make sure the Cursor is initialized correctly before accessing data from it.
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.database.CursorWindow.nativeGetString(Native Method)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.database.CursorWindow.getString(CursorWindow.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at adapters.FastScrollAdapter.getView(FastScrollAdapter.java:99)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.AbsListView.obtainView(AbsListView.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.ListView.makeAndAddView(ListView.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.ListView.fillDown(ListView.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.ListView.fillFromTop(ListView.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.ListView.layoutChildren(ListView.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.AbsListView.onLayout(AbsListView.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.View.layout(View.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewGroup.layout(ViewGroup.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.onLayout(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.View.layout(View.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewGroup.layout(ViewGroup.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.onLayout(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.View.layout(View.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewGroup.layout(ViewGroup.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.FrameLayout.onLayout(FrameLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.View.layout(View.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewGroup.layout(ViewGroup.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.support.v4.view.ViewPager.onLayout(ViewPager.java:1520)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.View.layout(View.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewGroup.layout(ViewGroup.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.onLayout(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.View.layout(View.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewGroup.layout(ViewGroup.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.FrameLayout.onLayout(FrameLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.View.layout(View.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewGroup.layout(ViewGroup.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.LinearLayout.onLayout(LinearLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.View.layout(View.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewGroup.layout(ViewGroup.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.widget.FrameLayout.onLayout(FrameLayout.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.View.layout(View.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewGroup.layout(ViewGroup.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewRootImpl.performLayout(ViewRootImpl.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.Choreographer$CallbackRecord.run(Choreographer.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.Choreographer.doCallbacks(Choreographer.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.Choreographer.doFrame(Choreographer.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.os.Handler.handleCallback(Handler.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.os.Handler.dispatchMessage(Handler.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.os.Looper.loop(Looper.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at android.app.ActivityThread.main(ActivityThread.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at java.lang.reflect.Method.invokeNative(Native Method)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at java.lang.reflect.Method.invoke(Method.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java)
01-19 16:37:33.893: E/AndroidRuntime(20193):    at dalvik.system.NativeStart.main(Native Method) 
```

这是应该显示列表的片段：

```
public class ShiftsFragment extends Fragment implements
            LoaderManager.LoaderCallbacks<Cursor> {

        public static Typeface tf, tf2, roboto;
        private FastScrollAdapter adapter;
        ListView ls;

        public static ShiftsFragment newInstance(String title) {

            ShiftsFragment pageFragment = new ShiftsFragment();
            return pageFragment;
        }

        @SuppressLint("NewApi")
        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,
                Bundle savedInstanceState) {
            View view = inflater.inflate(R.layout.shifts, container, false);

            /*
             * StrictMode.setThreadPolicy(new StrictMode.ThreadPolicy.Builder()
             * .detectAll().penaltyLog().build()); StrictMode.setVmPolicy(new
             * StrictMode.VmPolicy.Builder()
             * .detectLeakedSqlLiteObjects().detectLeakedClosableObjects()
             * .penaltyLog().penaltyDeath().build());
             */

            roboto = Typeface.createFromAsset(getActivity().getAssets(),
                    "fonts/JuraLight.ttf");
            tf = Typeface.createFromAsset(getActivity().getAssets(),
                    "fonts/Advert.ttf");
            tf2 = Typeface.createFromAsset(getActivity().getAssets(),
                    "fonts/passion.ttf");

            TextView SF = (TextView) view.findViewById(R.id.total);
            SF.setTypeface(tf);

            ls = (ListView)view.findViewById(android.R.id.list);

            getLoaderManager().initLoader(0, null, this);

            return view;

        }

        public Loader<Cursor> onCreateLoader(int loaderId, Bundle args) {
            // Query the db asyncronously

            String[] projection = { DBAdapter.KEY_ROWID,
                    DBAdapter.KEY_TIMESTAMP_IN, DBAdapter.KEY_TIMESTAMP_OUT };
            String where = null;
            String[] whereArgs = null;
            String sortOrder = null;

            CursorLoader cursorLoader = new CursorLoader(getActivity(),
                    provider.CONTENT_URI, projection, null, null, null);

            return cursorLoader;
        }

        @SuppressLint("NewApi")
        @Override
        public void onLoadFinished(Loader<Cursor> arg0, Cursor arg1) {

            // Update adapter and views // must use a handler to sync UI thread
            // stuff
            adapter = new FastScrollAdapter(getActivity(), arg1);
            ls.setAdapter(adapter);
        }

        @Override
        public void onLoaderReset(Loader<Cursor> arg0) {
            // release references

        }

    } 
```

**这是我的内容提供者类：**

```
public class provider extends ContentProvider {

    private DBAdapter dbAdapter;
    private static final String AUTHORITY = "provider";

    private static final String BASE_PATH = "todos";
    public static final Uri CONTENT_URI = Uri.parse("content://" + AUTHORITY
            + "/" + BASE_PATH);

    @Override
    public int delete(Uri uri, String selection, String[] selectionArgs) {
        // TODO Auto-generated method stub
        return 0;
    }

    @Override
    public String getType(Uri uri) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public Uri insert(Uri uri, ContentValues values) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public boolean onCreate() {
        dbAdapter = new DBAdapter(getContext());
        return false;
    }

    @Override
    public Cursor query(Uri uri, String[] projection, String selection,
            String[] selectionArgs, String sortOrder) {
        SQLiteQueryBuilder queryBuilder = new SQLiteQueryBuilder();
        DBAdapter dba = new DBAdapter(getContext());
        dba.open();
        SQLiteDatabase db = DBAdapter.db;
        queryBuilder.setTables(DBAdapter.DATABASE_TABLE);

        Cursor cursor = queryBuilder.query(db, projection, selection,
                selectionArgs, null, null, sortOrder);
        cursor.setNotificationUri(getContext().getContentResolver(), uri);

        // TODO Auto-generated method stub
        return cursor;
    }

    @Override
    public int update(Uri uri, ContentValues values, String selection,
            String[] selectionArgs) {
        // TODO Auto-generated method stub
        return 0;
    }

} 
```

**这是我自己的自定义适配器：**

```
// This is a custom adapter that will use cursor to get data from SQLite DB as the source.

public class FastScrollAdapter extends CursorAdapter {

    private LayoutInflater mInflater;
    public static Cursor cursor;
    public static int c = 0;
    public static ViewHolder holder;
    public DBAdapter dba;
    Context context;

    public FastScrollAdapter(Context context, Cursor c) {
        super(context, c);
        this.mInflater = LayoutInflater.from(context);
        this.cursor = c;
        this.context = context;

    }

    public FastScrollAdapter(Context context, Cursor c, boolean autoRequery) {
        super(context, c, autoRequery);
        this.mInflater = LayoutInflater.from(context);
        this.cursor = c;
    }

    // Here we shall look to see if the View already exists and create a new one
    // if not.

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {

        dba = new DBAdapter(context);
        this.cursor = dba.getAllShifts();

        int listLength = cursor.getCount();
        // If view doesn't exists = create a new one and also store it (all of
        // the views) in our ViewHolder class called "holder"
        if (convertView == null) {

            convertView = this.mInflater.inflate(R.layout.list_entry2, null);
            holder = new ViewHolder();
            holder.TL = (TableLayout) convertView.findViewById(R.id.TableBG);
            holder.info = (TextView) convertView.findViewById(R.id.Info);
            holder.info.setTypeface(SettingsFragment.roboto);
            holder.info.setText("Info");
            holder.dateDisp = (TextView) convertView
                    .findViewById(R.id.dateDisp);
            holder.timeInShift = (TextView) convertView
                    .findViewById(R.id.timeInShift);
            holder.day = (TextView) convertView.findViewById(R.id.day);
            holder.Money = (TextView) convertView.findViewById(R.id.Money);
            holder.shiftDisp = (TextView) convertView
                    .findViewById(R.id.shiftDisp);
            holder.start_finish = (TextView) convertView
                    .findViewById(R.id.start_finish);
            holder.Duration = (TextView) convertView
                    .findViewById(R.id.Duration);

            holder.insert = (TextView) convertView.findViewById(R.id.insert);
            holder.insert.setTypeface(ShiftsFragment.roboto);

            convertView.setTag(holder);

            // If exists, just fetch this view and display it.
        } else {
            holder = (ViewHolder) convertView.getTag();

        }
        this.cursor.moveToPosition(position);

        // Set some values...
        /*************** Taken From DB ******************/
        holder.start_finish.setText(this.cursor.getString(this.cursor
                .getColumnIndex(DBAdapter.KEY_START_TEXT_VIEW))
                + this.cursor.getString(this.cursor
                        .getColumnIndex(DBAdapter.KEY_END_TEXT_VIEW)));
        holder.start_finish.setTypeface(ShiftsFragment.roboto);

        holder.shiftDisp.setText(this.cursor.getString(this.cursor
                .getColumnIndex(DBAdapter.KEY_MONEY)));
        holder.shiftDisp.setTypeface(ShiftsFragment.roboto);
        //

        holder.dateDisp.setText(this.cursor.getString(this.cursor
                .getColumnIndex(DBAdapter.KEY_DATE)));
        holder.dateDisp.setTypeface(ShiftsFragment.roboto);

        holder.day.setText(this.cursor.getString(this.cursor
                .getColumnIndex(DBAdapter.KEY_DAY)));
        holder.day.setTypeface(ShiftsFragment.roboto);

        holder.timeInShift.setText(this.cursor.getString(this.cursor
                .getColumnIndex(DBAdapter.KEY_TOTAL_TIME_OF_SHIFT_STRING)));
        holder.timeInShift.setTypeface(ShiftsFragment.roboto);

        holder.insert.setText(this.cursor.getString(this.cursor
                .getColumnIndex(DBAdapter.KEY_INSERT_MODE)));

        //

        /*************** Regular ones ******************/

        holder.info.setTypeface(ShiftsFragment.roboto);
        holder.info.setText("Date:");

        holder.Money.setTypeface(ShiftsFragment.roboto);
        holder.Money.setText("Money Made:");

        holder.Duration.setTypeface(ShiftsFragment.roboto);
        holder.Duration.setText("Duration:");

        return convertView;
    }

    @Override
    public void bindView(View view, Context context, Cursor cursor) {
    }

    @Override
    public View newView(Context context, Cursor cursor, ViewGroup parent) {

        return null;
    }

    static class ViewHolder {
        TextView info;
        TextView dateDisp;
        TextView day;
        TextView Duration;
        TextView start_finish;
        TextView Money;
        TextView shiftDisp;
        TextView timeInShift;
        TextView insert;
        TableLayout TL;

    }

    public static void animate(final View v) {

        final Animation out = new AlphaAnimation(1, 0);
        out.setInterpolator(new DecelerateInterpolator());
        out.setDuration(350);
        v.setAnimation(out);
        out.start();
        out.setAnimationListener(new AnimationListener() {

            @Override
            public void onAnimationStart(Animation animation) {
                Log.i("Animation", "Started");

            }

            @Override
            public void onAnimationRepeat(Animation animation) {

                // Shifts.setSummaryCursor.requery();

            }

            @Override
            public void onAnimationEnd(Animation animation) {

                // Shifts.setSummaryCursor.requery();

            }
        });

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:00:39.383

> 大家好，我在尝试实现加载器管理器以与我的内容提供程序和数据库一起使用时遇到一些错误

您正在尝试从该游标中`getView`不存在的方法中的游标访问列。我无法为您提供其他帮助，因为我不知道您是如何进行查询的（因此请检查您用来获取字符串的列，以使其出现在您对数据库进行的查询中）。

另外，我建议您遵循一些有关适配器的教程，您目前在`getView`方法中所做的（查询数据库）绝对是可怕的。而且您可能无论如何都不需要该查询，因为您应该使用加载器返回的游标（您还设置了适配器）

# java - Java 服务器面临 - 未调用设置器

> ID：14415441
> 
> 赞同：2
> 
> 时间：2013-01-19T14:39:57.013
> 
> 标签：java, jsf, setter

我目前正在学习 JSF，并且遇到了一些不调用 setter 的问题。我正在编写一个非常简单的程序，它由一个 .XHTML 文件和一个 .java 类组成。该程序的重​​点是选择日、月和年，然后显示您的选择。据我了解JSF，以下应调用底层设置器并将适当的值保存在适当的字段中：

```
<h:selectOneMenu value ="#{bean.selectedDay}" onchange = "submit()"> 
    <f:selectItems value ="#{bean.days}"/>
</h:selectOneMenu> 
```

在此示例中，从未为字段“selectedDay”分配任何值。我真的很想了解为什么会这样。我目前正在运行 Windows 8 并使用带有 Glassfish 的 Eclipse。完整的代码可以在下面看到。感谢您的时间。

```
<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core">

<h:head>
<title>kalenderting</title>
</h:head>

<h:body>
<h:form>
<h:selectOneMenu value ="#{bean.selectedDay}" onchange = "submit()"> 
    <f:selectItems value ="#{opg2.days}"/>
</h:selectOneMenu> 

<h:selectOneMenu value ="#{bean.selectedMonth}" onchange = "submit()" >
    <f:selectItems value ="#{bean.months}"/>
</h:selectOneMenu>

<br/>
#{bean.date}
</h:form>
</h:body> 
```

豆子：

```
@Named
@SessionScoped 
public class Bean implements Serializable {

private List<Integer> days;
private List<String> months;
private List<Integer> years;
private int selectedDay ;
private String selectedMonth;

public Bean()
{   
    months = new ArrayList<String>();
    years = new ArrayList<Integer>();
    days = new ArrayList<Integer>();
    days.add(1);
    days.add(2);

    months.add("januar");
    months.add("februar");

    for( int i = 1990; i<=2020; i++)
    {
        years.add(i);
    }       
}

public List<Integer> getDays() {

    return days;
}

public void setDays(List<Integer> days) {
    this.days = days;
}

public List<String> getMonths() {
    return months;
}

public void setMonths(List<String> months) {
    this.months = months;
}

public List<Integer> getYears() {
    return years;
}

public void setYears(List<Integer> years) {
    this.years = years;
}

public int getSelectedDay() {
    return selectedDay;
}

public void setSelectedDay(int selectedDay) {
    this.selectedDay = selectedDay;
}

public String getSelectedMonth() {
    return selectedMonth;
}

public void setSelectedMonth(String selectedMonth) {
    this.selectedMonth = selectedMonth;
}

public String getDate()
{
    return selectedDay + ". " + selectedMonth;
} 
```

# ant - 在 Windows 上为 Ant 设置 Java 路径

> ID：14415442
> 
> 赞同：10
> 
> 时间：2013-01-19T14:39:58.983
> 
> 标签：ant

刚刚下载了最新版本的 Ant 并安装在：

```
C:\apache-ant-1.8.4 
```

我将以下内容添加到 Env Path 变量中：

```
...;C:\apache-ant-1.8.4\bin 
```

当我打开终端窗口并输入：

```
ant -version 
```

我得到：

```
Files\Java\jdk1.7.0_07"" was unexpected at this time. 
```

在系统变量中，我将变量 JAVA_HOME 设置为：

```
"C:\Program Files\Java\jdk1.7.0_07" 
```

所以看起来“ant -version”正在努力读取 JAVA_HOME 中的空间，即使它在引号中。

我看到有关此主题的替代帖子：

[蚂蚁和日食](https://stackoverflow.com/questions/7697044/ant-and-eclipse)

但它没有解决这个具体问题。

有没有其他人遇到过这个问题并知道答案？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-21T04:55:22.533

我的猜测是 JAVA_HOME 的当前定义有不需要的双引号。显示`set JAVA_HOME`命令窗口的输出。它不应该有任何双引号。

请启动命令提示符。再次设置 JAVA_HOME

```
set JAVA_HOME=C:\Program Files\Java\jdk1.7.0_07 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:27:00.057

嗯，引号应该没问题。可能是你路上的其他东西。如果一切都失败了，您可以恢复到 dos 8.3 表示法。

```
dir /x 
```

这使

```
13/01/2013  03:57 PM    <DIR>          PROGRA~1     Program Files
13/01/2013  03:57 PM    <DIR>          PROGRA~2     Program Files (x86) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-06T15:49:17.100

万一其他人仍然遇到这个问题，我在 Windows 7 上并且遇到了同样的问题。我正在使用通过右键单击“计算机”图标提供的 GUI 来尝试将 JAVA_HOME 路径设置为相关程序文件文件夹（C:\Program Files (x86)\Java\jdk1.7.0_45）。这行不通！GUI 不接受路径中的空格。但是，命令行可以。使用 set JAVA_HOME= C:\Program Files... 让它工作，用你的 jdk 安装位置填写路径的其余部分。

# delphi - 取消 ADO 连接的连接尝试？

> ID：14415443
> 
> 赞同：3
> 
> 时间：2013-01-19T14:40:01.290
> 
> 标签：delphi, timeout, delphi-xe2, ado, abort

我有一个`TADOConnection`内部线程。如果它无法连接到数据库（超时），则在关闭应用程序时，线程会被暂停，并且在尝试完成之前我的应用程序能够关闭需要一些时间。我不想减少连接的连接超时，这不是问题。有什么方法可以强制中止连接尝试？

在`TADOConnection`线程执行开始时连接并自动重复重新连接直到成功。然后，在关闭应用程序时，如果数据库连接失败，线程将挂起，直到连接尝试完成（超时）。

**编辑**

这是线程如何工作的示例：

```
procedure TMyThread.Init;
begin
  CoInitialize(nil);
  FDB:= TADOConnection.Create(nil);
  FDB.LoginPrompt:= False;
  FDB.ConnectionTimeout:= 5;
  FDB.ConnectOptions:= coAsyncConnect;
end;

procedure TMyThread.Uninit;
begin
  if FDB.Connected then
    FDB.Connected:= False;
  FDB.Free;
  CoUninitialize;
end;

function TMyThread.Reconnect: Boolean;
begin
  Result:= False;
  if FDB.Connected then
    FDB.Connected:= False;
  FDB.ConnectionString:= FConnectionString;
  try
    FDB.Connected:= True; //How to abort?
    Result:= True;
  except
    on e: exception do begin
      //MessageDlg(e.Message, mtError, [mbOK], 0);
      FDB.Connected:= False;
      Result:= False;
    end;
  end;
end;

procedure TMyThread.Process;
begin
  if Reconnect then begin //Once connected, keep alive in loop
    while FActive do begin
      if Terminated then Break;
      if not Connected then Break;

      //Do Some Database Work

    end;
  end else begin
    //Log connection failure
  end;
end;

procedure TMyThread.Execute;
begin
  while not Terminated do begin
    if FActive then begin
      Init; //CoInitialize, create DB, etc.
      try
        while (FActive) and (not Terminated) do begin
          try
            Process; //Actual processing procedure
          except
            on e: exception do begin
              //Record error to log
            end;
          end;
        end;
      finally
        Uninit; //CoUninitialize, destroy DB, etc.
      end;
    end;
  end;
end; 
```

（试图只包括与问题相关的内容）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T17:21:08.850

首先想到的是减少连接的超时。你为什么不想要那个？以及为什么要在关闭应用程序时建立连接？尤其是当您希望在花费比预期更多的时间时中止它时，为什么还要连接呢？听起来我们可以知道更多的背景信息。

在特殊情况下你确实需要它，条件是连接快，并且这个问题*只*适用于应用程序的销毁，那么我建议不要等待线程完成。只是不要释放它，终止应用程序，然后让 Windows 终止该进程，包括它的所有线程。

如果连接*确实*成功，那么这种方法可能会适得其反，因此当线程连接时向主线程发出信号，并通过等待线程来推迟其终止。您可能需要再次超时。

### 编辑：

我想`OnWillConnect`每次尝试连接时都会发生该事件。尝试`EventStatus := esCancel`在其处理程序中返回。

# javascript - Javascript 中未捕获输入条目

> ID：14415446
> 
> 赞同：0
> 
> 时间：2013-01-19T14:40:16.150
> 
> 标签：javascript, html

我试图构建一个应用程序，其中有一个 HTML 页面，我通过使用从中获取单个输入条目`Submit button`，并存储在容器（数据结构）中，`dynamically show that list`即字符串列表，在同一页面上

> 意味着每当我单击提交按钮时，该条目将自动附加到同一页面上的现有列表中。

但在这个任务中，首先我尝试在 javascript 文件中捕获该输入，但我同样失败了。你能告诉我，我将使用哪个命令？

到目前为止，我的工作是：-

**HTML 文件：-**

```
<html>
    <head>
        <script type = "text/javascript" src = "operation_q_2.js"></script>
    </head>
    <body>
        Enter String : <input type= "text" name = "name" id = "name_id"/>
        <button type="button"   onClick = "addString(this.input)">Submit</button>
    </body>
</html> 
```

**JAVASCRIPT 文件：-**

```
function addString(x) {
    var val = x.name.value;
    //var s = document.getElementById("name_id").getElementValue;//x.name.value;
    alert(val);
} 
```

**已编辑**

**我的新 JAVASCRIPT 文件是：-**

```
var input = [];

function addString(x) {
    var s = document.getElementById("name_id").value;//x.name.value;
    input.push(input);
    var size = input.length;
    //alert(size);
    printArray(size);
}

function printArray(size){
    var div = document.createElement('div');
    for (var i = 0 ; i < size; ++i) {
        div.innerHTML += input[i] + "<br />";
    }
    document.body.appendChild(div);
    //alert(size);
} 
```

这里将字符串存储在字符串中，但无法在网页上显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:44:05.567

看到这个小提琴：http: [//jsfiddle.net/MjyRt/](http://jsfiddle.net/MjyRt/)

Javascript 几乎是正确的

```
function addString(x) {
    var s = document.getElementById("name_id").value;//x.name.value;
    alert(s);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:51:42.180

尝试使用 jQuery（更简单）

```
 function addString() {

   var s = $('#name_id').val();//value of input;

    $('#list').append(s+"<br/>");//list with entries  
}

<div id='list'>

</div> 
```

# pug - 玉：if 语句和嵌套

> ID：14415448
> 
> 赞同：17
> 
> 时间：2013-01-19T14:40:25.557
> 
> 标签：pug

考虑这个伪服务器端代码

```
if(isFixed) {
  <div class="fixed">
} else {
  <div>
}
    <p>Inner element</p>
  </div> 
```

我试着用玉做这个，但是......

```
 - if(mode === 'fixed') {
   div#tabbar
 - }
     p ...I cannot get this to be an inner element :( 
```

它总是像这样呈现，`</div>`关闭：

```
<div id="tabbar"></div><p>I want this inside of the div</p> 
```

我弄乱了缩进吗？谢谢！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-19T14:56:15.697

您需要将控制流与模板分开。尝试这个：

```
divClass = null

if isFixed
   divClass = "fixed"

div(class=divClass)
   p inner element 
```

这反过来可能建议将“isFixed”参数分解到要传递的实际 divClass 参数中。但这当然取决于您剩余的代码/模板。

* * *

作为替代方案，请尝试使用 mixin：

```
mixin content
  p inner element

if (isFixed)
  div(class="test")
    mixin content
else
  div(class="other")
    mixin content 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-07-16T05:26:46.913

我会用三元（或完全写出的条件或方法）来确定类属性。这允许您将 div 保持在一行并保持缩进，就像对任何其他元素一样：

```
div(class="#{ isFixed ? 'fixed' : '' }")
    p Inner Element 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-03-27T23:33:14.803

Jade 似乎没有内置的解决方案来开始和结束标签，而不是使用“管道”字符来呈现纯文本。

```
- if(mode === 'fixed') {
| <div id="tabbar">
- }
| <p>I cannot get this to be an inner element :(</p>
- if(mode === 'fixed') {
| </div>
- } 
```

不那么混乱的解决方案 -

```
div(class=(isFixed) ? 'fixed' : '')
  p inner element 
```

# gcc - 为 MIPS-I 版本 1 设置交叉编译器

> ID：14415449
> 
> 赞同：2
> 
> 时间：2013-01-19T14:40:33.620
> 
> 标签：gcc, cross-compiling, uclibc

我正在寻找为 MIPS-I 版本 1 目标编译的交叉编译器，我发现了这个：

[ftp://ftp.dd-wrt.com/others/sourcecode/toolchains/current-toolchains.tar.bz2](ftp://ftp.dd-wrt.com/others/sourcecode/toolchains/current-toolchains.tar.bz2)

存档提取后，我将“toolchain-mips_gcc-4.3.3+cs_uClibc-0.9.30.1”文件夹复制到 /opt/ 并将 PATH 添加到 /root/.profile 文件，如下所示：

PATH="/opt/toolchain-mips_gcc-4.3.3+cs_uClibc-0.9.30.1/usr/bin:${PATH}" 导出路径

然后我会注销并登录并认为一切都很好，但事实并非如此。

我什至不能编译简单的应用程序。以下是 dhcp-3.x 编译尝试产生的示例输出：

[http://pastebin.com/MPMwirhg](http://pastebin.com/MPMwirhg)

怎么了 ？我还需要设置什么吗？如何纠正问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T19:57:01.587

库中有硬编码的路径，所以这就是它不起作用的原因。将“toolchain-mips_gcc-4.3.3+cs_uClibc-0.9.30.1”文件夹放在 /home/xfs/openwrt/trunk2/trunk/staging_dir/ 使其正常工作

# android - 在移动设备上工作，但在模拟器上例外

> ID：14415450
> 
> 赞同：1
> 
> 时间：2013-01-19T14:40:35.813
> 
> 标签：android

我创建了一个在移动设备上运行良好的代码，但它强制在模拟器上停止。该代码用于处理向上、向下滑动。这是我的代码：

```
horiz.setOnTouchListener(new OnSwipeTouchListener() 
        {
            public void onSwipeTop() 
            {
                Toast.makeText(ArtLauncher.this, "top", Toast.LENGTH_SHORT).show();
            }
            public void onSwipeBottom() 
            {
                Object sbservice = getSystemService( "statusbar" );
                Class<?> statusbarManager;
                try 
                {
                    statusbarManager = Class.forName( "android.app.StatusBarManager" );
                    Method showsb = statusbarManager.getMethod("expand" );
                    showsb.invoke( sbservice );
                } 
                catch (Exception e) 
                {
                    e.printStackTrace();
                }
            }
        }); 
```

OnSwipeTouchListener 类是：

```
class OnSwipeTouchListener implements OnTouchListener 
{
    @SuppressWarnings("deprecation")
    private final GestureDetector gestureDetector = new GestureDetector(new GestureListener());

    public boolean onTouch(final View v, final MotionEvent event) 
    {
        return gestureDetector.onTouchEvent(event);
    }

    private final class GestureListener extends SimpleOnGestureListener implements OnGestureListener 
    {
        private static final int SWIPE_THRESHOLD = 50;
        private static final int SWIPE_VELOCITY_THRESHOLD = 50;
        @Override
        public boolean onDown(MotionEvent e)
        {
            return true;
        }
        @Override
        public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) 
        {
            boolean result = false;
            try
            {
                float diffY = e2.getY() - e1.getY();
                    if (Math.abs(diffY) > SWIPE_THRESHOLD && Math.abs(velocityY) > SWIPE_VELOCITY_THRESHOLD) {
                        if (diffY > 0) 
                        {
                            onSwipeBottom();
                        } else 
                        {
                            onSwipeTop();
                        }
                    }

            } catch (Exception exception) 
            {
                exception.printStackTrace();
            }
            return result;
        }
        @Override
        public void onLongPress(MotionEvent arg0) 
        {   
            Toast.makeText(ArtLauncher.instance, "HELLO WORLD", Toast.LENGTH_LONG).show();
        }
        @Override
        public boolean onScroll(MotionEvent arg0, MotionEvent arg1, float arg2,
                float arg3) 
        {
            return false;
        }
        @Override
        public void onShowPress(MotionEvent arg0) 
        {
            //Toast.makeText(ArtLauncher.instance, "hhhhhhhhhhhhhh", Toast.LENGTH_LONG).show();
        }
        @Override
        public boolean onSingleTapUp(MotionEvent arg0) 
        {
            return false;
        }
    }
    public void onSwipeTop() 
    {
    }

    public void onSwipeBottom() 
    {
    }
} 
```

任何人都知道为什么我的应用程序停止并给出 IllegalArgumentsException？

# jquery - 在代码点火器中使用 jquery serialize() 提交表单

> ID：14415457
> 
> 赞同：0
> 
> 时间：2013-01-19T14:41:42.023
> 
> 标签：jquery, ajax, forms

我在我的项目中使用 CI，目前我有一个问题。我正在通过 jquery serialize 发送一个值，但代码不起作用......

这是代码..在我看来，我的表单ID是“表单”，按钮类型是提交，ID是“btn”。

```
 <script>

   $('#btn').click(function() {
       form = $("#form").serialize();

     $.ajax({
       type: "POST",
       url: "<?php  echo site_url('categoryController/addCategory'); ?>",
       data: form,

       success: function(data){
           alert('Successful!);
       }

     });

     return false;  //stop the actual form post !important!

  }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T14:44:40.727

使用该`event.preventDefault()`方法阻止表单提交。同样重要的是要注意脚本中**有一个未终止的字符串文字**。

```
 $('#btn').click(function(event) {
       form = $("#form").serialize();

     $.ajax({
       type: "POST",
       url: "<?php  echo site_url('categoryController/addCategory'); ?>",
       data: form,

       success: function(data){
           alert('Successful!'); //Unterminated String literal fixed
       }

     });
     event.preventDefault();
     return false;  //stop the actual form post !important!

  }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T14:52:19.270

您需要在表单提交上有事件。

```
$('#form').submit(function() {
 form = $("#form").serialize();
 $.ajax({
   type: "POST",
   url: "<?php  echo site_url('categoryController/addCategory'); ?>",
   data: form,
   success: function(data){
       alert('Successful!);
  }
 });
 return false; 
```

});

# pdf - 从 PDF 中删除所有矢量路径

> ID：14415458
> 
> 赞同：3
> 
> 时间：2013-01-19T14:41:42.167
> 
> 标签：pdf, ghostscript, mupdf

我正在寻找一种`path`从 PDF 文件中删除所有对象的方法。

我怀疑这可能可以使用 Adob​​e Acrobat 中的 javascript 来完成，但非常感谢使用 ghostscript 或 mupdf 工具来完成它的提示。

无论如何，任何可行的解决方案都可以作为正确答案

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T15:16:33.310

要使用 Ghostscript 执行此操作，您必须修改 pdfwrite 设备。事实上，您可能必须为任何 PDF 解释器做类似的事情。

你认为什么是“路径”对象？例如一个shfill？文字呢？使用类型 3 字体（构造路径）的文本怎么样？

剪辑路径呢？

如果您真的想这样做，我可以告诉您在哪里修改 pdfwrite，前提是您不介意重新编译 Ghostscript。

这可能是一个愚蠢的问题，但你为什么要这样做？您的问题是否可能有另一种解决方案？如果您想要做的只是删除填充路径（或者实际上是描边路径。一种解决方案是通过 ps2write 运行文件以获取 PostScript，预先添加代码以将“填充”和“描边”重新定义为无操作，然后运行通过 pdfwrite 文件返回以获取 PDF。

[阅读评论后添加]

PDF 没有“路径”对象，不像 XObject 是一种对象。路径由一系列操作创建，例如“newpath”、“moveto”、“curveto”和“lineto”。建立路径后，您可以使用“填充”或“描边”对其进行操作。请注意，PDF 也没有“文本”对象类型。

这就是为什么您的方法不起作用的原因，您无法删除“路径对象”，因为没有任何路径，路径是在内容流中创建的。您可以使用 Form XObject 来做类似的事情，但是路径构造在 Form 内容流中，它仍然不是一个单独的对象。

PostScript 也是如此，它们*不是*任何一种面向对象的语言。您无法在任何一种语言中“检测路径类型的矢量对象”，因为没有对象。在实践中，任何不是图像的东西都是矢量对象，并且是从路径构造的（并且通过剪辑，甚至某些图像也可能被视为路径）

您突出显示的 PostScript 将一个矩形添加到路径（路径在 PDF 或 PostScript 中不必是连续的）然后填充它。请注意，与 PostScript 中的通常做法一样，这些不是直接使用 PostScript 运算符，而是执行使用这些运算符的过程。程序在程序序言中定义。

顺便说一句，看起来您在这里使用了 pswrite 设备（无法确定这么小的样本）。如果是这种情况，您真的想从 ps2write 开始。否则你最终会得到很多东西退化成微小的填充矩形（pswrite 对许多图像类型进行此操作）

我没有建议您尝试“解密” ps2write 输出（它没有加密，它是压缩的）。

我的建议是创建一个 PostScript 文件，重新定义“显示”和/或“填充”运算符，使它们什么都不做，然后使用 pdfwrite 设备通过 Ghostscript 运行生成的 PostScript 程序。这将生成一个 PDF 文件，其中忽略所有描边和/或填充的对象。

[最后补充]

我拿起你的样本文件并检查了它。

我认为您看到的错误是 PDF 文件使用 /Separation 颜色（当然它不能无法填充矩形）和 ICCBased 替代并且没有设备空间色调转换。在这种情况下，当前版本的 ps2write 可能会解决您的问题。它（目前，这是由于更改）不保留 /Separation 颜色，而是将它们作为设备颜色发出，默认情况下为 RGB。因此，只需将文件转换为 PostScript 并返回 PDF 即可完全解决您的问题。

如果您知道问题出在哪里，如果您告诉我们会更快，我本可以首先为您提供这些信息和解决方法。

然后我使用 ps2write 创建了文件的 PostScript 版本（请注意，Separation 颜色现在是 RGB）并在 PostScript 程序前面加上两行：

```
/fill {newpath} bind def
/stroke {newpath} bind def 
```

请注意，您必须使用保留二进制文件的编辑器。然后使用 pdfwrite 设备通过 Ghostscript 运行该 PostScript 程序，我获得了一个 PDF 文件，其中我认为您遇到问题的绿色“装饰”已经消失。

因此，您的问题有一个解决方案，并且可能还有一种更好的方法来解决您的问题。

# jquery - 如何使用 knockout.js 将数据绑定到 html 控件 asp.net mvc razor 中？

> ID：14415461
> 
> 赞同：0
> 
> 时间：2013-01-19T14:41:52.120
> 
> 标签：jquery, asp.net-mvc, razor, knockout.js

你好; 我尝试使用 asp.net mvc razor 学习 knockout.js。我在下面写了一些代码，但 http://localhost:56238/Contact/SendMessage 是空的。我只看到 html 控件。如何使用 knockout.js 将 ViewModel 绑定到 UI

```
 @{
    ViewBag.Title = "SendMessage";
}

<h2>SendMessage</h2>

<script src="/Scripts/knockout-2.1.0.js" type="text/javascript"></script>
<script type="text/javascript">

    $(document).ready(function () {

        function AppViewModel() {
            this.firstName = ko.observable("Bert");
            this.lastName = ko.observable("Bertington");

            this.fullName = ko.computed(function () {
                return this.firstName() + " " + this.lastName();
            }, this);

            this.capitalizeLastName = function () {
                var currentVal = this.lastName();        // Read the current value
                this.lastName(currentVal.toUpperCase()); // Write back a modified value
            };

            $(document).ready(function () { ko.applyBindings(new AppViewModel()); })
        }

    });
</script>

<p>First name: <strong data-bind="text: firstName"></strong></p>
<p>Last name: <strong data-bind="text: lastName"></strong></p>

<p>First name: <input data-bind="value: firstName" /></p>
<p>Last name: <input data-bind="value: lastName" /></p>

<p>Full name: <strong data-bind="text: fullName"></strong></p>

<button data-bind="click: capitalizeLastName">Go caps</button> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:52:10.727

ko.applyBindings 从未在您的代码中执行，您必须将它放在 ViewModel 之外的某个位置。计算中的“this”不起作用，因为它不指向视图模型。

它应该是这样的：

```
<script type="text/javascript">
    function AppViewModel() {
            var self = this;

            this.firstName = ko.observable("Bert");
            this.lastName = ko.observable("Bertington");

            this.fullName = ko.computed(function () {
                return self.firstName() + " " + self.lastName();
            }, this);

            this.capitalizeLastName = function () {
                var currentVal = this.lastName();        // Read the current value
                this.lastName(currentVal.toUpperCase()); // Write back a modified value
            };
        }

    $(document).ready(function () {
        ko.applyBindings(new AppViewModel()); 
    });
</script> 
```

还有一件事，我看到您正在使用 jquery 而不包括 jquery lib。

# sql-server - 使用 TFS 和 SSIS 进行发布管理

> ID：14415463
> 
> 赞同：0
> 
> 时间：2013-01-19T14:42:08.313
> 
> 标签：sql-server, ssis, business-intelligence, release-management

我们目前使用`SSIS`Packages 2012 和`TFS`.

我们目前面临的最大挑战是设置一个可行的部署过程，因为在合并包（xml、编译代码等）时缺乏能力。

任何使用此类工具的人都可以向我指出我们可以使用的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T20:18:17.260

发布管理很重要，并且每天都在变得越来越重要。过去，我通过结合业务实践和软件开发实践来找到解决方案。我发现开发小型的工作单元 SSIS 包很有帮助——尤其是在团队负责开发数据集成解决方案的企业中。这具有简化故障排除和维护的优点，同时促进代码重用（提高质量并减少开发时间）。

开发较小的 SSIS 包的缺点是找到执行它们的好方法。在 SSIS 2012 中，您可以使用 SSIS 目录，这是一个非常酷的 SSIS 框架。市场上有其他可用的框架，您也可以构建自己的。目前，我构建了 SSIS 2012 框架，在适当的地方利用 SSIS 目录功能并在需要的地方扩展目录。

希望这会有所帮助，安迪

# c - 为什么我的 timespec-array 中出现错误“数组类型的元素类型不完整”？

> ID：14415465
> 
> 赞同：3
> 
> 时间：2013-01-19T14:42:15.970
> 
> 标签：c

我在 Eclipse 中的 C 代码有问题。具体来说，我的睡眠方法确实会在说明 timespec 的行中产生错误。你们能告诉我我做错了什么吗？这是代码：

```
void sleep(double time) {
    nanosleep(
        (struct timespec[]) { {time,((time -((time_t)time)) * 1000000000)}},
        NULL);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T14:44:52.587

您需要包含定义*类型* `timespec`的头文件。任何一个：

*   您忘记包含头文件或
*   您只需转发声明的类型。

第二个似乎是最可能导致错误的原因。由于您正在创建一个数组，因此编译器需要知道 的定义，`timespec`因为它需要为数组分配那么多内存。

* * *

问题是C 标准`struct timespec`中`nanosleep()`没有定义。它们由 POSIX 标准提供。似乎您正在编译，`-std=c99`这使您的编译器严格遵守 C99 标准并因此报告错误。为了能够编译这些 POSIX 结构，您必须显式启用它们。

**[编译`std=c99`](http://ideone.com/rdYnGh)**

**[启用 POSIX 定义后的编译](http://ideone.com/w9XGQ5)**：

```
#if __STDC_VERSION__ >= 199901L
# define _XOPEN_SOURCE 600
#else
# define _XOPEN_SOURCE 500
#endif /* __STDC_VERSION__ */

#include <time.h>

int main()
{
    double time = 0.1;

    nanosleep((struct timespec[]) { {time, ((time - ((time_t)time)) *
               1000000000)}}, NULL);

    return 0;
} 
```

`__STDC_VERSION__`检查您使用的编译器是否为 c99 并根据编译器启用 POSIX 定义。
`_XOPEN_SOURCE`定义要引用的 POSIX 版本。根据您使用的 POSIX 版本选择定义。`600`指`POSIX 2004`while`500`指`POSIX 1995`.

# mysql - 为什么引用不起作用

> ID：14415471
> 
> 赞同：0
> 
> 时间：2013-01-19T14:43:17.297
> 
> 标签：mysql, sql, foreign-keys

试图用 MySQL 示例向其他人解释 REFERENCES CONSTRAINT，但我无法让这个讨厌的示例工作！如果我将它定义为 FOREIGN KEY 似乎可行，但我的教科书说我不必这样做（使其成为列级引用约束而不是表级约束）。

问题是，对dept表中的dname进行UPDATE后，为什么emp表中的dname没有变化？

```
-- SQL CODE BEGINS
DROP TABLE IF EXISTS dept;
DROP TABLE IF EXISTS emp;

CREATE TABLE dept (
    dname CHAR(10),
    dnum  numeric(3,0)
) ENGINE=InnoDB;

CREATE TABLE emp (
  dname CHAR(10) REFERENCES dept(dname) ON UPDATE CASCADE,
  ename CHAR(10)
) ENGINE=InnoDB;

INSERT INTO dept VALUES ("AAA", 111);
INSERT INTO dept VALUES ("BBB", 222);

INSERT INTO emp VALUES ("CCC", "Carol"); 
INSERT INTO emp VALUES ("AAA", "Alice");

SELECT * from dept;
SELECT * from emp;
UPDATE dept SET dname="XYZ" WHERE dnum=111;
SELECT * from dept;
SELECT * from emp;

-- SQL CODE ENDS 
```

啊！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:46:02.983

*   声明`dept.dname`为`PRIMARY KEY`
*   创建一个 FOREIGN KEY 约束`emp.dname`

完整的 DDL：

```
CREATE TABLE dept
(
    dname CHAR(10) PRIMARY KEY,
    dnum  numeric(3,0)
) ENGINE=InnoDB;

CREATE TABLE emp 
(
  dname CHAR(10) ,
  ename CHAR(10),
  CONSTRAINT em_FR FOREIGN KEY (dname)
      REFERENCES dept(dname) ON UPDATE CASCADE
) ENGINE=InnoDB; 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/ad859)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T14:55:17.590

摘自 MySQL 5.5 参考手册

<剪辑>

InnoDB 不识别或不支持“内联引用规范”（如 SQL 标准中所定义），其中引用被定义为列规范的一部分。InnoDB 仅在指定为单独的 FOREIGN KEY 规范的一部分时才接受 REFERENCES 子句。对于其他存储引擎，MySQL Server 解析并忽略外键规范。

</snip>

[http://dev.mysql.com/doc/refman/5.5/en/create-table.html](http://dev.mysql.com/doc/refman/5.5/en/create-table.html)

我认为您的两本教科书的作者应该注意到他们推荐的方法，在列定义上添加“REFERENCES”子句，不会创建或强制执行外键约束。

* * *

为了创建外键约束，您需要目标列上的唯一索引。在您的情况下，您需要一个关于`dept(dname)`.

```
ALTER TABLE dept ADD CONSTRAINT dept_UX 
  UNIQUE KEY (dname) ; 
```

有了它，您就可以创建一个外键约束：

```
ALTER TABLE emp ADD CONSTRAINT FK_emp_dept 
  FOREIGN KEY (dname) REFERENCES dept(dname) ON UPDATE CASCADE ; 
```

（通常，外键引用表的 PRIMARY KEY。但是 UNIQUE KEY 就足够了。实际上，对于 InnoDB，只需要一个索引，它不必是唯一的，但我们不想去那里。）

将 dname 声明为 PRIMARY KEY 而不是 UNIQUE KEY：

```
ALTER TABLE dept ADD PRIMARY KEY (dname) ; 
```

* * *

当`REFERENCES`子句添加到列定义时，我相信 MySQL 会忽略它。（语法被接受，但它不会被记录在数据字典中。如果您使用的是 MyISAM，那没关系，因为 MyISAM 不强制执行外键约束。）

为了创建外键约束作为表定义的一部分，我把它放在单独的一行：

```
 CREATE TABLE emp (
 dname CHAR(10), 
 ename CHAR(10),
 CONSTRAINT FK_emp_dept FOREIGN KEY (dname) REFERENCES dept(dname)
 ) ENGINE=InnoDB ; 
```

# java - 隐藏 JButton 的 setText 值

> ID：14415473
> 
> 赞同：2
> 
> 时间：2013-01-19T14:43:19.453
> 
> 标签：java, swing, hide, jbutton

我正在编写一个图像益智游戏，其中一部分代码是将用户选择的部分与正确图像的部分进行比较。

每个图像片段都已作为 ImageIcon 添加到 JButton。

需要一个标识符来区分每个图像片段并进行比较。

我正在为作为标识符创建的每个 JButton 设置一个 setText()。

但是这样做会导致 ImageIcon 和 setText 都显示在 JButton 上。

有没有办法隐藏 setText 值并只显示 ImageIcon ？

```
 private String id;
        private int cc;
        private JButton[] button = new JButton[9];

        cc += 1;
        id += ""+cc;

        for(int a=0; a<9; a++){
            // dd refers to the variable for the image pieces for each JButton
        button[a].setIcon(new ImageIcon( dd ));
        button[a].setText(id);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:46:56.390

我建议制作另一个 s 数组`String`：

```
String[] ids = new String[button.length]; 
```

然后`button[a]`是ID `ids[a]`。

这是您的更改代码：

```
 private String id;
    private int cc;
    private JButton[] button = new JButton[9];
    private String[] ids = new String[button.length];

    //cc += 1;
    //id += ""+cc;
    id += Integer.toString(++cc); //easier way

    for(int a=0; a<9; a++){
        // dd refers to the variable for the image pieces for each JButton
        button[a].setIcon(new ImageIcon( dd ));
        ids[a] = id;
    } 
```

# spring-mvc - SpringMVC 自定义表单标签

> ID：14415484
> 
> 赞同：0
> 
> 时间：2013-01-19T14:44:40.803
> 
> 标签：spring-mvc, tags, jsp-tags

是否可以使用 HTML 5 标签并创建一个 `<form:canvas path="" id="" title=""/>`像`<form:input path="" id="" title=""/>`. 如何实现这一点，我是否需要添加到我的 spring-form.tld 副本中？

我对如何创建它感到困惑，有人可以解释一下。我想这样做，这样我就可以从弹簧绑定到表单元素中受益。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T11:45:14.457

对于 spring 自定义标签，请参阅 [创建扩展 Spring 标签库的自定义标签库](https://stackoverflow.com/questions/13097778/create-custom-tag-library-which-extends-spring-tag-library) 根据您的问题，以下是 spring FormTag 工作的顺序

**1**首先调用RequestContextAwareTag类的.doStartTag()方法。

**2** AbstractFormTag 类的 .doStartTagInternal() 方法在第二个被调用。

**3** FormTag的.writeTagContent(TagWriter tagwriter)方法在第三个被调用。

现在让我们按照这个调用顺序扩展 FormTag 类。1 和 2 的调用顺序相同。但是在 3 中，当 CustomFormTag 扩展 FormTag 时，这次将调用 CustomFormTag 的 writeTagContent。

所以我们的代码将是

```
public class CustomFormTag extends FormTag
{

    public CustomFormTag ()
    {
    }

    protected int writeTagContent(TagWriter tagWriter)
        throws JspException
    {
        int result = super.writeTagContent(tagWriter);  

        writeOptionalAttribute(tagWriter, "testattribute", getTestAttribute());

        return result;
    }
//getter and setter for testattribute. 
```

调用代码 super.writeTagContent(tagWriter);
它调用 FormTag 类的 writeTagContent 方法。

```
protected int writeTagContent(TagWriter tagWriter)
        throws JspException
    {
        this.tagWriter = tagWriter;
        tagWriter.startTag("form");  // form tag is here so we can not change it with canvas
        writeDefaultAttributes(tagWriter);
        tagWriter.writeAttribute("action", resolveAction());
        writeOptionalAttribute(tagWriter, "method", getMethod());
        writeOptionalAttribute(tagWriter, "target", getTarget());
        writeOptionalAttribute(tagWriter, "enctype", getEnctype());
        writeOptionalAttribute(tagWriter, "accept-charset", getAcceptCharset());
        writeOptionalAttribute(tagWriter, "onsubmit", getOnsubmit());
        writeOptionalAttribute(tagWriter, "onreset", getOnreset());
        writeOptionalAttribute(tagWriter, "autocomplete", getAutocomplete());
        tagWriter.forceBlock();
        String modelAttribute = resolveModelAttribute();
        pageContext.setAttribute(MODEL_ATTRIBUTE_VARIABLE_NAME, modelAttribute, 2);
        pageContext.setAttribute(COMMAND_NAME_VARIABLE_NAME, modelAttribute, 2);
        previousNestedPath = (String)pageContext.getAttribute("nestedPath", 2);
        pageContext.setAttribute("nestedPath", modelAttribute + ".", 2);
        return 1;
    } 
```

因此，您不能在扩展 spring 标签库的 spring mvc 中将表单更改为画布。.您可以编写不扩展spring标签库的自定义标签

# sql - 获得甲骨文的最低记录

> ID：14415486
> 
> 赞同：2
> 
> 时间：2013-01-19T14:44:43.057
> 
> 标签：sql, oracle, select

我在从我的表中选择数据时遇到问题，在我试图选择一组具有重复值的字段的记录时，我想选择具有最低值的记录，但是因为我相当SQL 新手，我现在处于死胡同，不知道应该使用什么语法来仅获取最低值。

```
Example

SEQ_NO     ID_NO     
01          1990
02          1990
03          1991
05          1890
08          1890
01          1992 
```

我只想选择所有低SEQ_NO的记录，所以我应该得到1990年到1992年的所有记录，但只有每个ID_NO只有最低的SEQ_NO。

我应该使用什么语法来删除不必要的记录（例如，删除 1990 的 SEQ_NO）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:55:03.700

use `MIN`，它是一个*AGGREGATE FUNCTION*和一个`GROUP BY`子句。

```
SELECT  ID_NO, MIN(SEQ_NO) LowestVALUE
FROM    Table1
WHERE   ID_NO BETWEEN 1990 AND 1992
GROUP   BY ID_NO 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!4/1bd93/10)

# c++ - 为什么字符串文字只能在某些情况下隐式转换为 char*？

> ID：14415488
> 
> 赞同：12
> 
> 时间：2013-01-19T14:44:46.103
> 
> 标签：c++, c, type-conversion, implicit-conversion, string-literals

```
void f(char* p)
{}

int main()
{
    f("Hello"); // OK

    auto p = "Hello";

    f(p); // error C2664: 'void f(char *)' : cannot convert parameter 1 
          // from 'const char *' to 'char *'
} 
```

代码使用 VC++ Nov 2012 CTP 编译。

> §2.14.15 字符串文字，第 7 节
> 
> 窄字符串文字的类型为“n const char 数组”，其中 n 是字符串的大小，定义如下，并且具有静态存储持续时间。

为什么`f("Hello")`可以？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-19T14:45:51.503

这种行为在 C 和 C++ 之间是不同的，至少在理论上是这样。

**在 C 中：**字符串文字衰减为非常量指针。但是，这并不是一个好主意。试图通过该指针修改字符串会导致未定义的行为。

**在 C++ 中：**永远不行（AFAIK）。^* 然而，一些编译器可能仍然会让你侥幸逃脱。例如，GCC 具有[`-Wwrite-strings`](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html#Warning-Options)默认启用的标志（至少在 4.5.1 及更高版本中）。

* * *

[* 至少在 C++11 中。（我手头没有旧规格。）]

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-19T14:56:05.383

和...之间的不同

```
f("Hello"); 
```

和

```
f(p); 
```

是前者涉及文字。在 C++03 中，支持从字符串文字到`char*`（注意：not `const`）的转换。在 C++11 中不再支持它，但如果有编译器的话，很少有编译器能跟上该规则的变化。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-19T14:46:43.617

```
f("Hello"); 
```

即使这在 C++ 中也不行。编译器应该给出诊断，否则需要更新。

在 C++ 中，`"Hello"`可以转换为`const char*`，而不是`char*`.

`"Hello"`从to的转换`char*`在 C++03 中是允许的，尽管它已被**弃用**。而在 C++11 中，转换无效，代码格式不正确。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-19T14:47:52.257

我认为是因为 auto 关键字。它是类型推导，因此编译器不再知道如何转换为 char*。

# javascript - 粘贴事件未按预期工作

> ID：14415493
> 
> 赞同：1
> 
> 时间：2013-01-19T14:45:29.947
> 
> 标签：javascript, jquery, html

我正在尝试这个简单的代码。我想要的是，当`paste`在第二个输入文本框上触发事件时，应该在复制其内容、删除`readonly`前一个文本框的属性并将其粘贴到那里之后将其清除。但是，什么都没有发生。

该`paste`事件被触发了，因为如果我用一个简单的替换计时器中的代码`alert`，它就可以工作。谁能告诉我这里有什么问题？

```
<!DOCTYPE html>
<html>
  <head>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js">
    </script>
    <script>
       $(document).ready(function(){
         $(".boo").bind("input paste",function() { 
         elem = this;
         setTimeout(function() { 
             $(".foo").removeAttr("readonly");
             $(".foo").text($(elem).text());
             $(elem).text("");  
         },100);
        });
      });
  </script>
</head>
 <body>
   <input class = 'foo' type = 'text' /><input class = 'boo' type = 'text' />
 </body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T14:55:54.057

首先，您应该使用`.val()`而不是`.text()`使用输入控件。

```
$(document).ready(function () {

    $("input.boo").bind("paste", function () { //also changed the binding too
        var elem = $(this);
        setTimeout(function () {
            $(".foo").val(elem.val());
            elem.val("");
        }, 100);
    });

}); 
```

此外，将文本粘贴到控件中时，您的绑定事件会被触发两次。那是因为，您已经将`input`和`paste`事件绑定到具有“boo”类的元素。

所以在这里，而不是：

```
$(".boo").bind("input paste", function() {}); 
```

用这个：

```
$("input.boo").bind("paste", function() {}); 
```

这只会将`paste`事件绑定到具有“boo”类的输入元素。

请参阅**更新** [**的 jsFiddle 示例**](http://jsfiddle.net/onury/JRTU6/)。

# python - Flask 应用程序中的常用文件夹/文件结构

> ID：14415500
> 
> 赞同：82
> 
> 时间：2013-01-19T14:46:27.743
> 
> 标签：python, flask

我刚刚创建了一个烧瓶应用程序，到目前为止，我有一个用于“Hello world！”的路由器。模板。

我想添加一点（很多）更多功能，但我想知道我应该如何构建应用程序目录。

构建 Flask 应用程序的最常见方式是什么？例如，我应该为我的`routes.py`所有路线创建一个吗？SQLAlchemy 的东西去哪儿了？模型应该在`models.py`吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-20T03:16:42.810

您应该查看 Flask 文档的 Patterns 部分中的 Larger Applications 页面：http: [//flask.pocoo.org/docs/patterns/packages/](http://flask.pocoo.org/docs/patterns/packages/)。当他们的应用程序调用包而不是模块时，这似乎是大多数人遵循的模型。

我相信`views.py`这就是你所说的`routes.py`。之后，模型将进入`models.py`，表格将进入`forms.py`，等等。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2016-06-12T20:21:10.683

FlaskApp 目录的示例：

```
 /yourapp  
        /run.py  
        /config.py  
        /app  
            /__init__.py
            /views.py  
            /models.py  
            /static/  
                /main.css
            /templates/  
                /base.html  
        /requirements.txt  
        /yourappenv 
```

`run.py`- 包含将导入应用程序并启动开发服务器的实际 python 代码。
`config.py`- 为您的应用存储配置。
`__init__.py`- 初始化您的应用程序，创建一个 Flask 应用程序实例。
`views.py`- 这是`routes`定义的地方。
`models.py`- 这是您为应用程序定义模型的地方。
`static`- 包含静态文件，即 CSS、Javascript、图像
`templates`- 这是您存储`html`模板的位置，即`index.html`-`layout.html`
`requirements.txt`这是您存储包依赖项的位置，您可以使用`pip`
`yourappenv`- 您的虚拟开发环境

* * *

## 回答 #3

> 赞同：23
> 
> 时间：2016-11-11T17:50:04.837

我会说，如果您拆分应用程序使用分区而不是功能结构。我提倡这一点，因为您更有可能在任何时候处理这​​些部门组件中的一个。

这种类型的结构非常适合不同用户组使用不同类型视图的市场或 SaaS 应用程序。仅 API 烧瓶应用程序我可能会使用功能拆分。

以下是来自 Flask Blueprints 的示例。蓝图本质上是记录了如何拆分 Flask 应用程序以获得更易于管理的部分的建议。更多信息请访问：[http ://exploreflask.com/en/latest/blueprints.html](http://exploreflask.com/en/latest/blueprints.html)

这是一个分区拆分的示例。查看每个功能如何组合在一起。

```
yourapp/
    __init__.py
    admin/
        __init__.py
        views.py
        static/
        templates/
    home/
        __init__.py
        views.py
        static/
        templates/
    control_panel/
        __init__.py
        views.py
        static/
        templates/
    models.py 
```

这是功能示例>

```
yourapp/
    __init__.py
    static/
    templates/
        home/
        control_panel/
        admin/
    views/
        __init__.py
        home.py
        control_panel.py
        admin.py
    models.py 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-01-20T11:02:19.090

我认为烧瓶是微型框架，现在您必须决定如何创建文件和文件夹。

我用这种方式：

*   烧瓶文件夹和文件结构-> [https://gist.github.com/4545740](https://gist.github.com/4545740)

这在 Django 结构附近

我建议你看一些项目来给你你想要的

*   danjac / newsmeme — Bitbucket -> [https://bitbucket.org/danjac/newsmeme/overview](https://bitbucket.org/danjac/newsmeme/overview)
*   sean-/flask-skeleton · GitHub -> [https://github.com/sean-/flask-skeleton](https://github.com/sean-/flask-skeleton)

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-04-13T11:17:54.410

任何为烧瓶项目寻找简单的初学者友好结构的人都可能会发现这很有帮助：

```
 |__movies 
     |__run.py 
     |__app     
        ├── templates
        │   └── index.html
        │   └── signup.html
        └── __init__.py
        └── routes.py 
```

这里的“*电影*”是主应用程序的名称。它包含“ *run.py* ”和一个名为“ *app* ”的文件夹。“ *app* ”文件夹包含所有必要的烧瓶文件，例如“ *templates* ”文件夹、“ *__init __.py* ”和“ *routes.py* ”。

内容：

**运行.py**：

```
from app import app 
```

**__init.py__**：

```
from flask import Flask

app = Flask(__name__)

from app import routes

app.run(debug=True) 
```

**路线.py**：

```
from app import app

@app.route('/')
@app.route('/index')
def index():
    return "Hello, World!" 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2019-04-26T06:50:46.130

烧瓶的美在于它的灵活性。您可以轻松构建 django 之类的项目结构。Django 普及了应用程序中的功能抽象并使它们可重用，但对于许多项目来说这可能是一种过度杀伤力。

但是用烧瓶你可以去任何一种方式。编写可重用的应用程序或编写简单的应用程序。检查这些千篇一律的骷髅 -

1.  [最小骨架](https://github.com/rohitchormale/cookiecutter-flask-minimal)

```
 myproject
    ├── config.py
    ├── instance
    │   └── config.py
    ├── myproject
    │   ├── commands.py
    │   ├── controllers.py
    │   ├── extensions.py
    │   ├── forms.py
    │   ├── __init__.py
    │   ├── models.py
    │   ├── routes.py
    │   └── ui
    │       ├── static
    │       │   ├── css
    │       │   │   └── styles.css
    │       │   └── js
    │       │       └── custom.js
    │       └── templates
    │           └── index.html
    ├── README.md
    ├── requirements.txt
    └── wsgi.py 
```

2.  [django 像骨架](https://github.com/rohitchormale/cookiecutter-flask)

```
 myproject
    ├── config.py
    ├── development.py
    ├── instance
    │   └── config.py
    ├── myproject
    │   ├── auth
    │   │   ├── controllers.py
    │   │   ├── forms.py
    │   │   ├── __init__.py
    │   │   ├── models.py
    │   │   └── routes.py
    │   ├── helpers
    │   │   ├── controllers.py
    │   │   ├── __init__.py
    │   │   └── models.py
    │   ├── __init__.py
    │   └── ui
    │       └── templates
    │           ├── 404.html
    │           ├── 500.html
    │           └── base.html
    ├── README.md
    ├── requirements.txt
    ├── tests
    │   ├── auth
    │   │   ├── __init__.py
    │   │   └── test_controllers.py
    │   └── __init__.py
    └── wsgi.py 
```

这是一篇很好的[文章](https://laymanclass.com/how-to-structure-flask-application-for-larger-projects/)。

* * *

## 回答 #7

> 赞同：5
> 
> 时间：2014-11-22T13:31:21.343

您可以从此处的 cookiecutter 模板中获得灵感，快速开始您的应用开发

*   [https://github.com/imwilsonxu/fbone](https://github.com/imwilsonxu/fbone)
*   [https://github.com/cookiecutter-flask/cookiecutter-flask](https://github.com/cookiecutter-flask/cookiecutter-flask)

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-04-24T20:53:17.337

这是我经常使用的烧瓶的基本文件结构。

```
yourapp/
static/
    js
    css
    img

templates/
    home.html
    index.html

app.py 
```

static 文件夹包含网站的所有静态文件。模板文件夹包含所有 HTML 页面。app.py 包含你的 python 视图。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-03-03T22:53:36.390

好主意是在 github 上搜索 sceletons/template 项目

例如你可以看看这个

*   [https://github.com/xen/flask-project-template](https://github.com/xen/flask-project-template)
*   [https://github.com/upperlinecode/flaskproject](https://github.com/upperlinecode/flaskproject)
*   [https://github.com/alisezer/flask-template](https://github.com/alisezer/flask-template)

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-12-06T16:57:45.187

在烧瓶中，我们可以将 mvc 结构保持为独立的所有人都认为例如 1 Templets 文件夹包含所有 html 文件 2 静态文件夹包含所有 css 和 boostrap 相关文件 3 用于数据库连接和 crud 操作的用户定义的 db 文件夹 4 用于访问的用户定义的模型文件夹/ 将来自 Templets/front-end 的数据绑定到 db/back-end 连接，并在主要活动文件之后
用于参考烧瓶文件结构链接如下 [https://flask.palletsprojects.com/en/1.1.x/tutorial/layout /](https://flask.palletsprojects.com/en/1.1.x/tutorial/layout/)

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-11-07T04:24:22.733

我决定将源代码文件夹嵌套在`src/`.

```
my_flask_app (project folder)
├── app.py
├── setup.py
├── src/
│   ├── my_flask_app/ (source code folder)
│   │   ├── config.py
│   │   ├── errors.py
│   │   ├── forms.py
│   │   ├── __init__.py
│   │   ├── models.py
│   │   ├── routes.py
│   │   ├── static/
│   │   └── templates/
│   └── my_flask_app.egg-info/
|
└── tests/ (test folder) 
```

正因为如此，我添加`package_dir={'': 'src'}`了`setup.py`.

# android-emulator - 适用于三星 Galaxy Tab 2 的 Android 模拟器

> ID：14415504
> 
> 赞同：0
> 
> 时间：2013-01-19T14:47:08.747
> 
> 标签：android-emulator, xamarin.android, avd

我正在使用 MonoDevelop 创建一个应用程序，我正在寻找三星 Galaxy Tab 2 平板电脑的模拟器。我找到了这个链接：

[三星网站](http://developer.samsung.com/android/tools-sdks/Samsung-GALAXY-Tab-Emulator)

但我不明白如何将它安装到 Mono 环境中。我将文件夹复制到我的mac上的avd文件夹，但它没有显示出来。我想我缺少一个 .ini 文件，但我不确定。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T07:11:47.380

首先，我认为这是 Tab1 的模拟器，而不是 Tab2。

对于 Tab2 仿真，我通常只是设置了一个具有大致适当设置的 ICS 仿真器 - 例如 WXGA800，“抽象 LCD 密度”240。

* * *

请注意，Tab1 和 Tab2 之间存在一些非常显着的差异 - 例如 Tab1 向操作系统错误地报告其屏幕密度 - 因此 UI 显得更大 - 请参阅[Samsung Galaxy Tab 7inch - 布局问题](https://stackoverflow.com/questions/11563811/samsung-galaxy-tab-7inch-layout-issues)

* * *

无论如何，如果您想安装 Tab1 模拟器，请不要在自己周围复制文件 - 而是尝试按照该站点上的说明进行操作 -**除了**在 eclipse 中使用 SDK 和 AVD 管理器之外，您可以在其中运行它们VS 或 MonoDevelop - 或者您可以从 Android SDK 文件夹中运行它们。

# url-rewriting - 如何使用 nginx 重写转义问号？

> ID：14415505
> 
> 赞同：0
> 
> 时间：2013-01-19T14:47:13.177
> 
> 标签：url-rewriting, nginx, migration, rewrite

我忙着将我的网站迁移到 nginx，我有很多需要转换的重写规则，我遇到的唯一问题是当我尝试做这样的事情时：

```
rewrite ^/media?(.*)$                   /in.php?id=$1                   last; 
```

这会导致 php 读取 $1 广告 $_GET 的键而不是它的值。有什么方法可以改变这种行为，而无需采用基于位置的困难方法？我问的原因是因为我有多个基于查询字符串的重写需要解决。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T16:24:55.117

nginx 中的所有内容都`?`称为 variable `$query_string`，因此如果您想从 location rule 翻译整个查询字符串`^/media?(.*)$`，因为它看起来就是您想要的，请尝试使用它：

```
rewrite ^/media?(.*)$   /in.php?id=$query_string   last; 
```

是你在找什么吗？

# c - realloc 下一个大小无效

> ID：14415507
> 
> 赞同：-1
> 
> 时间：2013-01-19T14:47:24.280
> 
> 标签：c, pointers, realloc

*或者，[Facing an error — glibc detected free invalid next size (fast) 的](https://stackoverflow.com/questions/2317021/facing-an-error-glibc-detected-free-invalid-next-size-fast)副本。*

我一直在为此苦苦挣扎，我尝试使用 valgrind 来追踪它，但似乎无法确定错误的确切来源。我可以调用该函数 4 次，但之后它会抛出 realloc invalid next size 错误。

确切的错误：*** 检测到 glibc *** ./matrix: realloc(): invalid next size: 0x0000000001a46010 ***

这是代码：

```
char line[101];
int nMatrix = -1;
Dims *dimensions;
List *vals = NULL;
int **values;
int **columns;
int **rowPointer;
int *lineCount;
int *highestRow;

void newMatrix()
{
    nMatrix++;
    values = realloc(values, sizeof(int*));
    columns = realloc(columns, sizeof(int*));
    rowPointer = realloc(rowPointer, sizeof(int*));
    dimensions = realloc(dimensions, sizeof(Dims));
    lineCount = realloc(lineCount, sizeof(int));
    highestRow = realloc(highestRow, sizeof(int));
}

void readIn(char* inputFile, int transpose)
{
    FILE *fr;
    int a = 0;
    int b = 0;
    int c = 0;
    newMatrix();
    if((fr = fopen(inputFile, "r")) != NULL)
    {
        while(fgets(line, 100, fr) != NULL)
        {
            if(lineCount[nMatrix] == 0)
            {
                if(transpose)
                    sscanf(line, "%d,%d", &dimensions[nMatrix].n, &dimensions[nMatrix].m);
                else
                    sscanf(line, "%d,%d", &dimensions[nMatrix].m, &dimensions[nMatrix].n);
                printf("nMatrix = %d, n%d,m%d\n", nMatrix, dimensions[nMatrix].n, dimensions[nMatrix].m);
            }
            else
            {
                sscanf(line, "%d,%d,%d", &a,&b,&c);
                //printf("a = %d, b = %d, c = %d\n", a,b,c);
                //rows[a] = insertList(c,b,rows[a]);c
                if(transpose)
                    vals = insertList(c, a, b, dimensions[nMatrix].m, dimensions[nMatrix].n, vals);
                else
                    vals = insertList(c, b, a, dimensions[nMatrix].m, dimensions[nMatrix].n, vals);
            }
            lineCount[nMatrix]++;
        }
        values[nMatrix] = calloc(lineCount[nMatrix], sizeof(int));
        columns[nMatrix] = calloc(lineCount[nMatrix], sizeof(int));
        rowPointer[nMatrix] = calloc(((dimensions[nMatrix].m)+1), sizeof(int));
        values[nMatrix][lineCount[nMatrix]] = 0;
        columns[nMatrix][lineCount[nMatrix]] = 0;
        int i = 0;
        int lastRow = -1;
        while(i < dimensions[nMatrix].m)
        {
            rowPointer[nMatrix][i] = -1;
            i++;
        }
        i = 0;
        List *temp = NULL;
        while(vals != NULL)
        {
            temp = vals;
            //printf("pos = %d, row = %d, col = %d, val = %d, i=%d", temp->position, temp->row, temp->column, temp->value, i);
            if(lastRow != temp->row)
            {
                rowPointer[nMatrix][temp->row] = i;
                lastRow = temp->row;
                highestRow[nMatrix] = i;
            }
            values[nMatrix][i] = temp->value;
            columns[nMatrix][i] = temp->column;
            i++;
            vals = temp->next;
            free(temp);

        }
        rowPointer[nMatrix][dimensions[nMatrix].m] = lineCount[nMatrix]-1;
        fclose(fr);
        return;
    }
    fclose(fr);
    printf("File not found\n");
    return;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:12:52.777

对于您“分配”的每个新矩阵，您应该*扩展*全局指针列表。你没有。您只需将它们重新分配到与以前相同的大小：

这个：

```
void newMatrix()
{
    nMatrix++;
    values = realloc(values, sizeof(int*));
    columns = realloc(columns, sizeof(int*));
    rowPointer = realloc(rowPointer, sizeof(int*));
    dimensions = realloc(dimensions, sizeof(Dims));
    lineCount = realloc(lineCount, sizeof(int));
    highestRow = realloc(highestRow, sizeof(int));
} 
```

应该是这样的：

```
void newMatrix()
{
    nMatrix++;
    values = realloc(values, (nMatrix+1)*sizeof(int*));
    columns = realloc(columns, (nMatrix+1)*sizeof(int*));
    rowPointer = realloc(rowPointer, (nMatrix+1)*sizeof(int*));
    dimensions = realloc(dimensions, (nMatrix+1)*sizeof(Dims));
    lineCount = realloc(lineCount, (nMatrix+1)*sizeof(int));
    highestRow = realloc(highestRow, (nMatrix+1)*sizeof(int));
} 
```

注意：`(nMatrix+1)`使用该值是因为您从`nMatrix`as开始`(-1)`，并且在第一次递增时它是`(0)`，下一个是`(1)`等等...即它总是索引插入的最后一行，但是您的向量幅度需要为 +1 以希望显而易见原因。

我强烈建议您考虑`realloc()`失败时会发生什么，因为它将返回 NULL 并且在进程中泄漏您传入的指针指向的任何*内存*。

可能还有其他问题，但那是我第一个跳出来的问题。

# javascript - 在正文区域内点击触发事件

> ID：14415519
> 
> 赞同：0
> 
> 时间：2013-01-19T14:49:13.910
> 
> 标签：javascript, jquery

我需要触发点击，点击我的网页。我尝试了以下方法，它触发了点击加载而不是点击。

```
$(function() { 
            $("body").click(function(e) {

                    alert("code");

            })
            $('#container').trigger('click');
        }); 
```

基本上我需要在键盘上点击 P 关键字时显示一个弹出窗口。当我开始时，我在初始阶段被卡住了。不知道如何实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T14:52:01.160

我猜你需要一个key 传递 ASCII 码的[`keydown`](http://api.jquery.com/keydown/)事件：`P``80`

```
$("body").on("keydown", function(e) {
    if (e.which === 80) {
        alert("'p' was pressed");
    }
}); 
```

# php - PayPal 在 SetExpressCheckout 上返回 ACK 失败

> ID：14415520
> 
> 赞同：1
> 
> 时间：2013-01-19T14:49:17.997
> 
> 标签：php, paypal, paypal-sandbox

我尝试通过在 PayPal 中提供以下数据来获取 PayPal 的令牌：

```
Array
(
    [PAYMENTREQUEST_0_CURRENCYCODE] => EUR
    [PAYMENTREQUEST_0_INVNUM] => TLT-GR-1
    [RETURNURL] => http://www.mysite.ext/my_app/payment-completed/
    [CANCELURL] => http://www.mysite.ext/my_app/payment-canceled/
    [PAYMENTREQUEST_0_PAYMENTACTION] => Sale
    [SOLUTIONTYPE] => Sole
    [L_PAYMENTREQUEST_0_NAME0] => Product Description
    [L_PAYMENTREQUEST_0_AMT0] => 0.38
    [L_PAYMENTREQUEST_0_QTY0] => 19.27
    [PAYMENTREQUEST_0_AMT] => 7.32
    [PAYMENTREQUEST_0_ITEMAMT] => 1
) 
```

这是生成上述数组值的代码：

```
$data           =   array();

$data['PAYMENTREQUEST_0_CURRENCYCODE']  =   $currencyCode;
$data['PAYMENTREQUEST_0_INVNUM']        =   $order->ID;
$data['RETURNURL']                      =   $returnUrl;
$data['CANCELURL']                      =   $cancelUrl;
$data['PAYMENTREQUEST_0_PAYMENTACTION'] =   'Sale';
$data['SOLUTIONTYPE']                   =   'Sole';

$subtotal   =   0;
$tax        =   0;
$counter    =   0;

foreach($products as $product)
{
    if($product->Type == 0)     //  Production is diretion
    {
        if($product->NightDuration == 0)
        {
            $price  =   round($product->Price   ,   2);
            $qty    =   round($product->Qty     ,   2);

            $data['L_PAYMENTREQUEST_0_NAME'         .   $counter]   =   $product->Title;
            $data['L_PAYMENTREQUEST_0_AMT'          .   $counter]   =   $price;
            $data['L_PAYMENTREQUEST_0_NUMBER'       .   $counter]   =   ($counter + 1);
            $data['L_PAYMENTREQUEST_0_QTY'          .   $counter]   =   $qty;
            $data['L_PAYMENTREQUEST_0_TAXAMT'       .   $counter]   =   round(($qty * $price) * ($taxPercentage / 100), 2);
            $data['L_PAYMENTREQUEST_0_ITEMCATEGORY' .   $counter]   =   'Digital';
            $subtotal                                               +=  $qty * $price;
            $tax                                                    +=  ($qty * $price) * ($taxPercentage / 100);
        }
        else
        {

        }
    }
    else
    {

    }

    $counter++;
}

$data['PAYMENTREQUEST_0_AMT']           =   round($subtotal + $tax, 2);
$data['PAYMENTREQUEST_0_ITEMAMT']       =   1;
$data['PAYMENTREQUEST_0_TAXAMT']        =   round($tax, 2);
echo "<pre>";
print_r($data);
echo "</pre>";
$data                                   =   http_build_query($data, '', '&');

$pp =   new TaxiBookingPayPal();
$rt =   $pp->PPHttpPost('SetExpressCheckout', $data);

echo "<pre>";
print_r($rt);
echo "</pre>"; 
```

我从 PayPal 得到以下结果：

```
Array
(
    [TIMESTAMP] => 2013%2d01%2d19T14%3a44%3a25Z
    [CORRELATIONID] => bdfce7f34a1db
    [ACK] => Failure
    [VERSION] => 94
    [BUILD] => 4181146
    [L_ERRORCODE0] => 10413
    [L_SHORTMESSAGE0] => Transaction%20refused%20because%20of%20an%20invalid%20argument%2e%20See%20additional%20error%20messages%20for%20details%2e
    [L_LONGMESSAGE0] => The%20totals%20of%20the%20cart%20item%20amounts%20do%20not%20match%20order%20amounts%2e
    [L_SEVERITYCODE0] => Error
) 
```

你能看出那段代码有什么问题吗？有没有人可以帮助我？

在对我的代码进行长时间的研究之后，我发现问题出在我的数字中的十进制数字上。问题是我不知道小数到底有什么问题:(

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T19:38:49.187

ITEMAMT + TAXAMT + SHIPPINGAMT + HANDLINGAMT 必须等于 AMT。

ITEMAMT 应该只是项目的小计，但你只传递了 1 那里。

此外，您的数量为 19.27。我从来没有专门测试过他们是否会接受这样的 QTY 值，但即使他们接受了，你的 ITEMAMT 应该是 7.32。

在这种情况下，您没有传递其他值，因此您的 ITEMAMT 和 AMT 将是相同的。您在此处传递的 1 会导致您遇到错误，因为它不会加到您的 AMT 中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:46:12.787

查看错误消息：购物车项目金额的总和与订单金额不匹配。

您发送给 PayPal 的号码不正确。（你确定你的计算是正确的吗？）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-21T05:11:51.723

检查任何金额值是否不超过两位小数，例如“12.123”不是有效金额，而“12.12”是有效金额。

在准备购物车时，购物车的总金额+额外费用（税金+运费）必须等于总金额

# c++ - 提升asio多线程

> ID：14415524
> 
> 赞同：1
> 
> 时间：2013-01-19T14:50:16.530
> 
> 标签：c++, sockets, boost, tcp, boost-asio

> **可能重复：**
> [Boost.Asio 线程安全](https://stackoverflow.com/questions/7639349/boost-asio-thread-safety)

是

```
boost::asio::ip::tcp::socket 
```

线程安全吗？

我的意思是，我可以从不同的线程调用共享 tcp::socket (socket.connect(), read_some(), close()) 的方法而不用担心竞争条件问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:53:12.860

从 Boost 1.52 开始，它不是线程安全的。

这记录在文档的“线程安全”部分[中](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/reference/ip__tcp/socket.html)：

*线程安全*

**不同的物体：**安全。

**共享对象：**不安全。

# c# - 如何将搅拌机中的所有动作（动画）导出到文件。FBX？

> ID：14415525
> 
> 赞同：4
> 
> 时间：2013-01-19T14:50:18.647
> 
> 标签：c#, xna, unity3d, blender, fbx

我在从 Blender 导出带有动画的模型时遇到问题。导出时，我的 XNA 项目模型仅包含第一个动画，即使我在设置中选择了“所有动画”。

有人可以帮我理解为什么我的所有动画都没有被导出/导入吗？

这是我的配置：

![搅拌机配置](../Images/80ed4ceeb89f90aa501e86bf681aa762.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:16:49.433

我发现问题了！！！我必须下载并安装 XNA 4.0 Refresh 并且一切正常！！ [http://xboxforums.create.msdn.com/forums/t/106701.aspx](http://xboxforums.create.msdn.com/forums/t/106701.aspx)

# javascript - 在函数之间传递参数

> ID：14415527
> 
> 赞同：-3
> 
> 时间：2013-01-19T14:51:10.447
> 
> 标签：javascript

我有一个主要功能。

```
function google(arg){
       alert(arg);
}

function yahoo(){
     this function requires my arg object passed above.
} 
```

我将我的对象传递给`google`另一个页面中的函数，但我无法`yahoo`显式调用方法。是否有任何模式或方式可以在两个函数之间传递对象。

我听说过`apply and call`方法，但不确定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T14:53:32.153

这行得通吗？

```
var theArg;
function google(arg) {
    theArg = arg;
}

function yahoo() {
   // use theArg;
} 
```

# postgresql - PostgreSQL 查询有效，但不适用于 php

> ID：14415529
> 
> 赞同：1
> 
> 时间：2013-01-19T14:51:23.860
> 
> 标签：postgresql, php

我想对 PostgreSQL 数据库进行 php 查询。我在服务器中测试了查询并返回，但是当我在 php 中尝试时：

```
<?php

//Check the input
if (!isset($_POST['variable']))
echo "Address not selected";

$input = $_POST['variable'];
//$input = ucfirst(trim($_POST['variable']));
//echo $input;

$conn = pg_connect("host=localhost port=5432 dbname=geocoder user=postgres");
if (!$conn)
echo "Could not connect to server..";

$sql = "SELECT (addy).stateabbrev FROM geocode($input);";
$result = pg_query($conn, $sql);

if  (!$result)
    echo "Query did not executed..";

?> 
```

我得到“查询没有执行..”；

QUERY 的字符串取自使用 javascript 的 html 页面。

在 Apache2 的 error.log 中，我得到：

> PHP 警告：pg_query()：查询失败：错误：“Penn”或附近的语法错误\nLINE 1：SELECT (addy).stateabbrev FROM geocode(O

这里有什么意义？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:10:36.477

清理用户提供的数据：

```
$input = pg_escape_literal($conn, $input);
$sql = "SELECT (addy).stateabbrev FROM geocode($input);"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T11:34:02.177

我设法找到了问题，那就是 geocode() 函数中的 $input 变量必须用单引号括起来：

```
geocode('$input') 
```

:)

# mysql-python - 在python中安装MySQLdb

> ID：14415542
> 
> 赞同：6
> 
> 时间：2013-01-19T14:53:18.380
> 
> 标签：mysql-python

我已经在 Windows 中安装了 3.3.0 python 安装程序。然后我想安装 MySQLdb。我在安装文件中搜索 python 3.3.0，我得到了“MySQL-python-1.2.4b4.win32-py2.7”并安装了它。但它显示“需要python 2.7 版，在您的注册表中找不到”。我也在stackoverflow中得到了关于这个问题的解决方案，但我的问题没有解决。我尝试过的解释如下：

```
1\. First I have exported python from registry HKEY_LOCAL_MACHINE-> Software.
2\. I have saved the file in desktop.
3\. I open it with notepad++.
4\. Then I replaced all the LOCAL_MACHINE with CURRENT_USER and save it.
5\. Finally  I executed the saved file in desktop. 
```

但是什么也没发生，我的问题没有解决，就像以前一样。有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:03:02.853

使用已编译 C 扩展的 Python 库必须针对 Python 的确切版本进行编译。您下载的 MySQLdb 包适用于 python 2.7，不适用于 python 3.3。

据我所知，MySQLdb 还不支持 Python 3，也没有计划将其移植到 Python 3

然而，所有的希望都不会落空。还有其他 MySQL 包装器，请参阅[MySQL-db lib for Python 3.x?](https://stackoverflow.com/questions/384471/mysql-db-lib-for-python-3-0)

# java - JSF 页面中未使用的 Bean

> ID：14415545
> 
> 赞同：1
> 
> 时间：2013-01-19T14:53:42.747
> 
> 标签：java, jsf, javabeans, facelets

我有一个名为 的页面`index.xhtml`，在其中我使用 bean 类中的变量来填充页面的信息。但是当我启动文件时，它看起来好像没有使用 bean。

我的`index.xhtml`：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core">

    <h:head>
        <script language="JavaScript" type="text/javascript" src="resources/tab-panel.js"></script>
        <link rel="stylesheet" href="resources/style.css" type="text/css" />
        <title>Tweetpage of #{userBean.name}</title>
    </h:head>

    <f:metadata>
        <f:viewParam name="user" value="#{userBean.name}" />
        <f:event type="preRenderView" listener="#{userBean.init()}" />
    </f:metadata>

    <h:body onload="bodyOnLoad()" onResize="raisePanel(currentMenuIndex)">
        <div class="loginbox">
            <h:link value="Login" outcome="user.xhtml" />
        </div>
        <div class="namebox">
            <h:outputLabel>User: #{userBean.name} </h:outputLabel>
        </div>
        <div class="detailsbox"> 
            <h:outputText>Name: #{userBean.getName()} </h:outputText>
            <h:outputText>Web: #{userBean.getWeb()} </h:outputText>
            <h:outputText>Bio: #{userBean.getBio()} </h:outputText>
        </div> 
```

我的`UserBean.java`：

```
@ManagedBean
@SessionScoped
public class UserBean implements Serializable {

    @Inject @Named(value = "userService")
    private UserService service;

    private String name;

    private User user;

    public UserBean() {

    } 
```

我的网页如下所示：

```
User: #{userBean.name} 
Name: #{userBean.getName()} 
```

如您所见，它没有说`null`or `Dude`，而是我在页面中获取代码。我使用此 URL 导航到该站点：`http://localhost:8080/Kwetter/index.xhtml?user=Dude`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T14:59:45.300

当`FacesServlet`不调用时会发生这种情况。它负责执行所有 JSF 和 EL 工作。您需要确保您在浏览器地址栏中看到的请求 URL 与 中定义的 URL 模式`FacesServlet`匹配`web.xml`。如果您努力通过右键单击查看 HTML 源代码，在浏览器中*查看*源代码，那么您应该注意到所有 JSF 标记仍然未解析，而不是生成了它们的 HTML 表示。

因此，如果您已将其映射到`*.jsf`，那么您应该`http://localhost:8080/Kwetter/index.jsf?user=Dude`改为打开它。

另一种方法是重新`FacesServlet`映射`*.xhtml`.
这样您就无需担心虚拟 URL。

### 也可以看看：

*   [JSF Facelets：有时我看到 URL 是 .jsf，有时是 .xhtml。为什么？](https://stackoverflow.com/questions/3008395/jsf-facelets-sometimes-i-see-the-url-is-jsf-and-sometimes-xhtml-why)

* * *

**与具体问题无关**，您使用的`<h:outputText>`方式不正确。只是摆脱他们。最好不要使用方法表达式语法，而只使用值表达式语法。

```
<div class="namebox">
    <h:outputLabel value="User: #{userBean.name}" />
</div>
<div class="detailsbox"> 
    Name: #{userBean.name}
    Web: #{userBean.web}
    Bio: #{userBean.bio}
</div> 
```

### 也可以看看：

*   [是否建议对所有内容都使用 h:outputText ？](https://stackoverflow.com/questions/5539894/is-it-suggested-to-use-houtputtext-for-everything/5540859#5540859)

# java - 在按钮按下时获取地图中心坐标，崩溃

> ID：14415547
> 
> 赞同：0
> 
> 时间：2013-01-19T14:53:50.367
> 
> 标签：java, android, google-maps, google-maps-api-2

我正在尝试获取地图中心（谷歌地图 api v2）的纬度和经度，以便在按下按钮时显示在文本视图中。但它一直在崩溃。我已经尝试了几件事，这对我来说是最好的，但是一旦你按下按钮就会崩溃：

我认为它在这条线上崩溃： MapView mapView = (MapView)findViewById(R.id.map); （因为我尝试删除 onClick 中的所有其他内容，但它仍然崩溃）

**爪哇：**

```
public class Main extends FragmentActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        GooglePlayServicesUtil.isGooglePlayServicesAvailable(getApplicationContext());
        final GoogleMap map = ((SupportMapFragment)  getSupportFragmentManager().findFragmentById(R.id.map))
                   .getMap();

        map.setMyLocationEnabled(true);

        final TextView latitudeTV = (TextView) findViewById(R.id.latitude);
        final TextView longitudeTV = (TextView) findViewById(R.id.longitude);

        Button buttonCoor = (Button) findViewById(R.id.getCoor);    
        buttonCoor.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {

                MapView mapView = (MapView)findViewById(R.id.map);
                GeoPoint mapCenter = mapView.getMapCenter();
                int latInt = mapCenter.getLatitudeE6();
                int lonInt = mapCenter.getLongitudeE6();
                latitudeTV.setText(latInt);
                longitudeTV.setText(lonInt);

            }
        });

    } 
```

我的代码有什么问题？

由于 api 密钥，我无法在模拟器上运行它，因此无法获取任何 logcat 信息。

谢谢

更新：

我也试过这个，但结果相同（按下按钮时崩溃）

```
 MapView mapView = (MapView)findViewById(R.id.map);
    GeoPoint mapCenter = mapView.getProjection().fromPixels(
        mapView.getWidth()/2,
        mapView.getHeight()/2);

final int lat = mapCenter.getLatitudeE6();
final int lon = mapCenter.getLongitudeE6(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:57:01.527

我终于解决了花了将近4个小时，哈哈！这就是我最终得到的：

```
final GoogleMap map = ((SupportMapFragment)  getSupportFragmentManager().findFragmentById(R.id.map)).getMap();  
...
Display display = getWindowManager().getDefaultDisplay();
int width = display.getWidth();
int height = display.getHeight();
Point point = new Point(width / 2, height / 2);
LatLng latLng = map.getProjection().fromScreenLocation(point);

latitudeTV.setText(String.valueOf(latLng)); 
```

**感谢这个人的教程：**

[http://patesush.blogspot.dk/2012/12/how-to-create-app-for-google-map-v2-in.html](http://patesush.blogspot.dk/2012/12/how-to-create-app-for-google-map-v2-in.html)

# android - 第二次点击/单击标记不会调用 OnMarkerClickListener

> ID：14415548
> 
> 赞同：3
> 
> 时间：2013-01-19T14:54:04.703
> 
> 标签：android, google-maps, google-maps-android-api-2

我在我的地图中添加了一个 OnMarkerClickListener。当我点击一个标记时， OnMarkerClickListener 被调用并显示一个 AlertDialog。但是，如果我取消 AlertDialog 并再次点击同一个标记，则不会调用 OnMarkerClickListener。这是我的 OnMarkerClickListener：

```
googleMap.setOnMarkerClickListener(new OnMarkerClickListener() {

  @Override
  public boolean onMarkerClick(final Marker marker) {

    AlertDialog.Builder builder = new AlertDialog.Builder(
        DirectionsActivity.this);
    builder.setMessage(marker.getSnippet());
    builder.setTitle(marker.getTitle());
    builder.setPositiveButton("Open in Google Maps",
        new OnClickListener() {

          // ...
          }
        });

    builder.setNegativeButton("Cancel", null);

    AlertDialog dialog = builder.create();
    dialog.show();

    return false;
  }
}); 
```

只需移动或缩放地图，我就可以在同一个标​​记上再次单击。因此，如果我的 OnMarkerClickListener.onMarkerClick 返回，`true`则执行默认处理，包括将地图居中于单击的标记上，我可以在同一个标​​记上进行第二次单击，但第三次和后续单击不会执行任何操作. 所以问题似乎是在地图缩放或中心发生变化之前，无法识别对同一标记的点击。

除了我确实有从位图派生的自定义图标之外，我没有对我的标记做任何特别的事情。

还有其他人有这个问题吗？有什么我应该检查我可能做错了吗？或者这是一个已知问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T13:14:33.223

只是在这里关闭循环，结果证明这是一个错误。bbalazs 在这里创建了一个错误报告：[http](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4829) ://code.google.com/p/gmaps-api-issues/issues/detail?id=4829但被合并为该错误报告的副本：[http://code。 google.com/p/gmaps-api-issues/issues/detail?id=4760](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4760)

[您可以点击http://code.google.com/p/gmaps-api-issues/issues/detail?id=4760](http://code.google.com/p/gmaps-api-issues/issues/detail?id=4760)的星形图标对其进行投票。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-11T10:27:57.053

在“onMarkerClick”方法中，将返回值设置为“true”。

# jquery - 调用 setcell 方法并在 jqGrid 单元格中设置值后，如何在 jqGrid 中设置可编辑的单元格？

> ID：14415550
> 
> 赞同：1
> 
> 时间：2013-01-19T14:54:07.277
> 
> 标签：jquery, jqgrid

我在 jqGrid 中有一个独特的要求。我正在使用带有来自后端 SQL Server 的数据的 jqGrid。一切正常。我的问题是我正在使用`setCell`JQGrid 中的方法在单元格中设置一些值。

`grid.jqGrid('setCell', rowId, finalJsonColumnName, value);`

它正在工作并正确设置值。我的问题是在 jqGrid 中设置值后，特定单元格变得不可编辑。

我不需要单元格在`setCell`. 我希望它们保持可编辑状态。我试图调用另一种方法来使单元格可编辑：

`grid.jqGrid('setCell', rowId, 'precPsProg', '', 'editable-cell');`

但它不起作用。请问有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-05-31T23:35:25.673

`setCell`尽管这是一个旧线程，但在使用中的方法设置单元格的值时我遇到了同样的问题`JQGrid`（单元格变得不可编辑）。经过几个小时的搜索，我找到了一个解决方案，使用这个：

```
document.getElementById(rowId + "_Column_Name").value = some_value; 
```

这将设置特定 ( `row`, `column`) 单元格的值，并且它保持可编辑状态（在保存行时提交给服务器）。

# directx - Direct3D 11不光栅化任何顶点

> ID：14415552
> 
> 赞同：1
> 
> 时间：2013-01-19T14:54:19.177
> 
> 标签：directx, direct3d, directx-11, direct3d11

我正在尝试使用 Direct3D 11 在屏幕上渲染一个简单的三角形，但没有任何显示。这是我的顶点：

```
SimpleVertex vertices[ 3 ] =
{
    { XMFLOAT3( -1.0f, -1.0f, 0.0f ) },
    { XMFLOAT3(  1.0f, -1.0f, 0.0f ) },
    { XMFLOAT3( -1.0f,  1.0f, 0.0f ) },
}; 
```

预期的输出是一个三角形，一个点在屏幕的左上角，一个点在屏幕的右上角，一个点在屏幕的左下角。但是，任何地方都没有渲染任何内容。

我没有执行任何矩阵转换，顶点着色器只是将输入直接传递给输出。一切似乎都设置正确，当我在 Visual Studio 2012 中使用图形调试器时，正确的顶点位置被传递给顶点着色器。但是，它直接从顶点着色器阶段跳到管道中的输出合并阶段。我假设这意味着没有任何东西被发送到像素着色器，这再次意味着向量在光栅化阶段被丢弃。为什么会这样？

这是我的光栅化状态：

```
D3D11_RASTERIZER_DESC rasterizerDesc;
rasterizerDesc.AntialiasedLineEnable = false;
rasterizerDesc.CullMode = D3D11_CULL_NONE;
rasterizerDesc.DepthBias = 0;
rasterizerDesc.DepthBiasClamp = 0.0f;
rasterizerDesc.DepthClipEnable = true;
rasterizerDesc.FillMode = D3D11_FILL_SOLID;
rasterizerDesc.FrontCounterClockwise = false;
rasterizerDesc.MultisampleEnable = false;
rasterizerDesc.ScissorEnable = false;
rasterizerDesc.SlopeScaledDepthBias = 0.0f; 
```

我的视口（宽度/高度是与我的后台缓冲区匹配的窗口客户区，在我的测试设置中设置为 1024x576）：

```
D3D11_VIEWPORT viewport;
viewport.Height = static_cast< float >( height );
viewport.MaxDepth = 1.0f;
viewport.MinDepth = 0.0f;
viewport.TopLeftX = 0.0f;
viewport.TopLeftY = 0.0f;
viewport.Width = static_cast< float >( width ); 
```

谁能看到是什么让光栅化阶段放弃了我的顶点？还是我的 D3D 设置的任何其他部分可能导致此问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:52:24.773

我在互联网上找到了这个..加载需要很长时间，所以我复制并粘贴了我用粗体突出显示的一个有趣点。

第 11 行中定义的 D3D_OVERLOADS 构造函数为 C++ 程序员提供了一种使用 D3DTLVERTEX 创建变换和光照顶点的便捷方式。

```
_D3DTLVERTEX(const D3DVECTOR& v, float _rhw, D3DCOLOR _color,
         D3DCOLOR _specular, float _tu, float _tv)
{
sx = v.x;
sy = v.y;
sz = v.z;
rhw = _rhw;
color = _color;
specular = _specular;
tu = _tu;
tv = _tv; 
```

}

系统需要一个已经转换的顶点位置。所以 x 和 y 值必须在屏幕坐标中，z 必须是像素的深度值，可以在 z-buffer 中使用（我们这里不会使用 z-buffer）。Z 值的范围可以从 0.0 到 1.0，其中 0.0 是距离观察者最近的可能位置，而 1.0 是在观察区域内仍然可见的最远位置。紧跟该位置，变换和光照顶点必须包含一个 RHW（齐次 W 的倒数）值。

**在对顶点进行光栅化之前，必须将它们从同质顶点转换为非同质顶点，因为光栅化器期望它们以这种方式进行。Direct3D 通过将 x、y 和 z 坐标除以 w 坐标将齐次顶点转换为非齐次顶点，并通过反转 w 坐标生成 RHW 值。这仅适用于由 Direct3D 转换和照亮的顶点。RHW 值以多种方式使用：用于计算雾，用于执行透视正确的纹理映射，以及用于 w 缓冲（深度缓冲的另一种形式）。**

定义 D3D_OVERLOADS 后，D3DVECTOR 被声明为

```
_D3DVECTOR(D3DVALUE _x, D3DVALUE _y, D3DVALUE _z); 
```

D3DVALUE 是基本的 Direct3D 分数数据类型。它在 d3dtypes.h 中声明为

```
 typedef float D3DVALUE, *LPD3DVALUE; 
```

源代码显示 D3DVECTOR 的 x 和 y 值始终为 0.0f（这将在 InitDeviceObjects() 中更改）。rhw 始终为 0.5f，颜色为 0xfffffff，镜面反射设置为 0。只有 tu1 和 tv1 值在四个顶点之间不同。这些是背景纹理的坐标。

为了将纹素映射到图元上，Direct3D 要求所有纹理中的所有纹素都有一个统一的地址范围。因此，它使用了一个通用的寻址方案，其中所有的纹素地址都在 0.0 到 1.0 的范围内。相反，如果您决定分配纹理坐标以使 Direct3D 使用纹理的下半部分，则您的应用程序将分配给本例中图元顶点的纹理坐标为 (0.0,0.0)、(1.0,0.0)、 (1.0,0.5) 和 (0.0,0.5)。Direct3D 将应用纹理的下半部分作为背景。

注意：通过在该范围之外分配纹理坐标，您可以创建某些特殊的纹理效果。

您将在 d3dtextr.cpp 的框架源代码中找到 D3DTextr_CreateTextureFromFile() 的声明。它从传递的文件创建本地位图。可以从 *.bmp 和 *.tga 文件创建纹理。纹理在框架中以链表的形式进行管理，链表保存每个纹理的信息，称为纹理容器。

```
 struct TextureContainer
{
TextureContainer* m_pNext; // Linked list ptr

TCHAR   m_strName[80];  // Name of texture (doubles as image filename)
DWORD   m_dwWidth;
DWORD   m_dwHeight;
DWORD   m_dwStage;      // Texture stage (for multitexture devices)
DWORD   m_dwBPP;
DWORD   m_dwFlags;
BOOL    m_bHasAlpha;

LPDIRECTDRAWSURFACE7 m_pddsSurface;  // Surface of the texture
HBITMAP m_hbmBitmap;                 // Bitmap containing texture image
DWORD*  m_pRGBAData;

public:
HRESULT LoadImageData();
HRESULT LoadBitmapFile( TCHAR* strPathname );
HRESULT LoadTargaFile( TCHAR* strPathname );
HRESULT Restore( LPDIRECT3DDEVICE7 pd3dDevice );
HRESULT CopyBitmapToSurface();
HRESULT CopyRGBADataToSurface();

TextureContainer( TCHAR* strName, DWORD dwStage, DWORD dwFlags );
~TextureContainer();
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T10:32:42.610

问题实际上出在我的渲染逻辑中。我将顶点缓冲区的步幅设置为 0，而不是我的顶点结构的大小。改变了它，它渲染得很好！

# c# - 模拟器和 Windows Phone 设备 c# 上的不同结果

> ID：14415553
> 
> 赞同：1
> 
> 时间：2013-01-19T14:54:42.863
> 
> 标签：c#, windows-phone-7, windows-phone-7.1, windows-phone-8, windows-phone

所以我正在开发一个进行一些计算的应用程序。它从 txt 中读取一些数字，将它们转换为 double，然后将它们相乘后给出结果。

假设 txt 有数字 10.5 和 2

```
string string1 = "10.5", string2 = "2";
double double1 = Convert.ToDouble(string1), double2=Convert.ToDouble(string2);
double double3=double1*double2;
textbox.text= double3.ToString(); 
```

我总是在模拟器上得到的结果是 21，而在我的设备上得到 210。我尝试从手机重新安装应用程序，重新启动手机和电脑，我尝试了 10 多次。我仍然在手机上得到不同的结果。我应该怎么办？

PS：我试过 double.parse 但还是一样

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:04:12.730

基于电话和模拟器在不同的语言环境下工作，那么这个 SO 问题回答了真正被问到的问题[how-to-convert-string-to-double-with-proper-cultureinfo](https://stackoverflow.com/questions/2583362/how-to-convert-string-to-double-with-proper-cultureinfo)

当然，您现在必须将您的文本文件与正确的语言环境相匹配。

另请参阅[什么是cultureinfo-invariantculture-mean](https://stackoverflow.com/questions/9760237/what-does-cultureinfo-invariantculture-mean)

# c# - 为什么 DateTime 基于 Ticks 而不是毫秒？

> ID：14415555
> 
> 赞同：21
> 
> 时间：2013-01-19T14:54:51.303
> 
> 标签：c#, .net, vb.net, datetime

为什么 a 的最小分辨率`DateTime`基于 Ticks（100 纳秒单位）而不是毫秒？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-19T15:04:25.633

*   `TimeSpan`并`DateTime`使用相同的`Ticks`制作操作，例如将 a 添加`TimeSpan`到`DateTime`琐碎中。
*   精度越高越好。主要用于`TimeSpan`，但以上原因将其转为`DateTime`。

    例如，`StopWatch`测量短时间间隔通常短于一毫秒。它可以返回一个`TimeSpan`.
    在我的一个项目中，我曾经`TimeSpan`处理音频样本。100ns 已经足够短了，毫秒不会。

*   即使使用毫秒刻度，您也需要一个 Int64 来表示`DateTime`. 但是你浪费了大部分范围，因为 0 到 9999 之外的年份并没有真正有用。所以他们选择了尽可能小的刻度，同时允许`DateTime`代表 9999 年。

    大约有 2 个^(61.5)滴答，时间为 100ns。由于`DateTime`时区相关标记需要两个位，因此 100ns 滴答是适合 Int64 的最小十次方间隔。

因此，使用较长的刻度会降低精度，而不会获得任何收益。使用较短的刻度不适合 64 位。=> 100ns 是给定约束的最佳值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-19T15:00:06.290

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T14:56:28.923

以获得更高的时间分辨率，即使您大部分时间都不需要它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-07-09T22:12:30.890

仅供参考：

1 毫秒 = 10 000 个滴答声

1 秒 = 10 000 000 个滴答声

使用两个刻度的差异（增量），您可以获得更精细的精度（稍后将它们转换为毫秒或秒）

在 C# DateTime 上下文中，刻度从`0`(DateTime.MinValue.Ticks) 开始直到`DateTime.MaxValue.Ticks`

```
new DateTime(0)                          //numbers between 0 and (864*10^9-1) produces same date 01/01/0001        
new DateTime(DateTime.MaxValue.Ticks)    //MaxValue tick generates 12/31/9999 
```

系统时间滴答每天增加 8640 亿滴答。

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2013-01-19T14:56:48.547

滴答声是系统时钟的工作方式。

# c - 拦截系统调用

> ID：14415561
> 
> 赞同：10
> 
> 时间：2013-01-19T14:55:57.063
> 
> 标签：c, linux, linux-kernel, kernel-module, kernel

我一直试图在内核级别拦截系统调用。我从这个[问题](https://stackoverflow.com/questions/2103315/linux-kernel-system-call-hooking-example)中得到了基本的想法。我试图拦截的系统调用是**fork()**。所以我从 System.map 中找到了**sys_fork()**的地址，结果是 0xc1010e0c。现在我编写了如下模块。

```
#include<linux/kernel.h>
#include<linux/module.h>
#include<linux/unistd.h>
#include<linux/semaphore.h>
#include<asm/cacheflush.h>
MODULE_LICENSE("GPL");
void **sys_call_table;
asmlinkage int (*original_call)(struct pt_regs);
asmlinkage int our_call(struct pt_regs regs)
{
    printk("Intercepted sys_fork");
    return original_call(regs);
} 
static int __init p_entry(void)
{
    printk(KERN_ALERT "Module Intercept inserted");
    sys_call_table=(void *)0xc1010e0c;
    original_call=sys_call_table[__NR_open];
    set_memory_rw((long unsigned int)sys_call_table,1);
    sys_call_table[__NR_open]=our_call;
    return 0;
}
static void __exit p_exit(void)
{
    sys_call_table[__NR_open]=original_call;
    set_memory_ro((long unsigned int)sys_call_table,1);
    printk(KERN_ALERT "Module Intercept removed");
}
module_init(p_entry);
module_exit(p_exit); 
```

但是，在编译模块之后，当我尝试将其插入内核时，我从 dmesg 输出中得到了以下信息。 ![在此处输入图像描述](../Images/6d802ab0ad5e2df2a3c2c5ffdb52a691.png) ![在此处输入图像描述](../Images/3f8debc9d3f44953d1702645f20140c8.png)

当然它没有拦截系统调用。你能帮我找出问题吗？我使用的是**3.2.0-4-686**版本的 Linux 内核。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T15:06:28.037

[`http://lxr.linux.no/linux+*/arch/x86/mm/pageattr.c#L874`](http://lxr.linux.no/linux+*/arch/x86/mm/pageattr.c#L872)说

```
 if (*addr & ~PAGE_MASK) {
                    *addr &= PAGE_MASK;
                    /*
                     * People should not be passing in unaligned addresses:
                     */
                    WARN_ON_ONCE(1);
            } 
```

所以警告是因为你的`sys_call_table`变量不是页面对齐的。

应该说，内核维护人员正式不鼓励修补系统调用表，而且他们故意为您设置了一些障碍——您可能已经注意到您无法访问真正的`sys_call_table`符号，并且写入保护也是刻意的。如果您可能找到另一种方法来做您想做的事，那么您应该这样做。根据您更大的目标，您可能可以完全使用[`ptrace`](http://linux.die.net/man/2/ptrace)内核模块来完成它。`trace_sched_process_fork`钩子也可能有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T15:01:53.277

```
original_call=sys_call_table[__NR_open];
....
sys_call_table[__NR_open]=our_call; 
```

如果您正在拦截`fork`，则条目`open`不是您想要更改的。而不是 System.map 中 sys_fork() 的地址，您应该使用`sys_call_table`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-23T16:37:56.727

目前尚不清楚您是否解决了问题，但取决于您如何测试模块 glib 不再使用 sys_fork ，而是使用 sys_clone 。

# php - jQuery mobile：对话框页面包含不需要的字符（？> 或？>）

> ID：14415564
> 
> 赞同：-1
> 
> 时间：2013-01-19T14:56:00.927
> 
> 标签：php, html, jquery-mobile, jquery-ui-dialog

首先，让我向您展示一些代码：

索引.php

```
<a href="new-directory-dialog.php" data-role="button" data-rel="dialog" data-transition="slidedown"><?php echo localize('New directory'); ?></a> 
```

因此，如您所见，我使用*new-directory-dialog.php*作为对话窗口。在本地机器上一切正常，在 Win 7 x64 上使用 Wamp 服务器。但是在我的 Web 主机服务器上，每个对话框页面都显示有 ?> （或 ?>）字符。Firebug 中的 HTML 选项卡显示以下输出：

```
<html class="ui-mobile">
<head>
<base href="http://pantljika-online.info/link/new-directory-dialog.php">
</head>
<body class="ui-mobile-viewport ui-overlay-a">
?>
<title>Novi direktorij</title>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport"> 
```

我不知道为什么会这样。这是对话框页面的完整代码：

```
<?php
include('localize.php');
?>
<!DOCTYPE html>
<html>
    <head>
        <title><?php echo localize('New directory'); ?></title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
    </head>
    <body>
        <div data-role="page" data-theme="<?php echo $_SESSION['data-theme']; ?>" >
            <form action="index.php" method="post">
                <fieldset>
                    <div data-role="header">
                        <h1><?php echo localize('New directory'); ?></h1>
                    </div>

                    <div data-role="content">
                        <label for="new-directory-name">
                            <?php echo localize('Name'); ?>:
                        </label>
                        <input type="text" id="new-directory-name" name="new-directory-name" />
                    </div>

                    <div data-role="footer">
                        <h4>
                            <button type="submit" name="submit" value="submit-value"><?php echo localize('Create'); ?></button>
                        </h4>
                    </div>
                </fieldset>
            </form>
        </div>
    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T22:59:17.143

好的，问题解决了。我在其中一个包含的 php 文件中删除了 PHP 结束标记 (?>)，它停止显示在对话框中。此外，我必须在没有 BOM 的情况下将所有 php 文件从 UTF8 编码为 UTF8。否则 jQuery 会将 head 元标记和标题标记放在 body 元素中......

# nsis - 如何在我的安装程序中更改欢迎页面图像？

> ID：14415573
> 
> 赞同：8
> 
> 时间：2013-01-19T14:57:23.460
> 
> 标签：nsis

我想在欢迎屏幕中更改 nsis 欢迎页面默认图像，所以我尝试使用以下代码。但这些显示为空白。

代码：

```
!define MUI_HEADERIMAGE_BITMAP "${NSISDIR}\Contrib\Graphics\Header\NXP.bmp"
!define MUI_WELCOMEFINISHPAGE_BITMAP "${NSISDIR}\Contrib\Graphics\Wizard\NXP.bmp" 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T15:41:43.367

您是如何创建 NXP.bmp 的？

NSIS 不接受所有 BMP 变体。我有时需要用 Paint 打开和保存 bmp 文件，以确保它是一个有效的 BMP 文件。

# java - 在无限 gb 网络主机中部署 REST Web 服务

> ID：14415576
> 
> 赞同：2
> 
> 时间：2013-01-19T14:57:37.503
> 
> 标签：java, web-services, jersey

我们正在尝试在unlimitedgb.com webhost 中部署我们使用jersey 实现的java restful webservies。其中提供java7和tomcat7。

当我们与unlimitedgb 的技术支持团队聊天时，他们回复说“对不起，我们不为Java private JVM 中的JERSEY 提供支持”。

在我们由 java7 和 tomcat7 组成的本地系统中，它工作正常。

据我所知，jersey 为 restful webservice 开发提供了 api，所以不能依赖于服务器或服务器的架构，或者可能是其他一些内部结构。所以 jersey 必须使用 java 1.6 及以上版本。

但是当我得到技术支持团队的回复说他们不支持球衣时，我真的很困惑，并开始思考球衣是否真的依赖于服务器或服务器架构。

我觉得支持团队没有任何关于球衣的技术细节。

我还没有购买虚拟主机。

请帮助我了解技术细节，以便我可以继续购买虚拟主机。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T05:13:47.300

我不确定这有多大帮助，但我使用[了 Jelastic](http://jelastic.com/)并且能够在没有任何支持的情况下部署战争并托管 Jersey API。
所以，我对你自己的私人 VPS 主机很有信心，你应该能够让它工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T15:21:37.320

当支持人员说“我们不支持”时，他们的意思是，我们不会回答您关于该主题的问题。

Jersey 在那种环境下应该完全没问题，但是，您应该编写一套测试，这样当您更改 JVM 时，您会收到由于 JVM 不同而导致的奇怪故障的通知。 [测试球衣](http://jersey.java.net/nonav/documentation/latest/test-framework.html)

如果您想要一个完全没有 Java EE 容器的休息环境，请查看[RestExpress](https://github.com/RestExpress/RestExpress)

# c# - 将服务传递给基类上的通用方法时，不会调用 Moq 的服务方法

> ID：14415581
> 
> 赞同：1
> 
> 时间：2013-01-19T14:57:49.317
> 
> 标签：c#, unit-testing, generics, moq

我在基类上有一个用于管理列表项的通用方法：

```
public abstract class BaseViewModelHandler<T> : BaseLogger, IViewModelHandler<T>
    where T : IViewModel
{
    public abstract void Handle(T viewModel);

    protected ISet<TE> ManageListItems<TE>(int[] selectedItemIds, ISet<TE> list, IService<TE> service)
        where TE : IEntity
    {
        try
        {

... param checking and code to remove unwanted items not included for brevity

            if (selectedItemIds.Any())
            {
                var itemIdsToAdd = selectedItemIds.Where(id => list.All(x => x.Id != id)).ToList();
                if (itemIdsToAdd.Any())
                {
                    foreach (var id in itemIdsToAdd)
                    {
                        var item = service.GetById(id);
                        list.Add(item);
                    }
                }
            }

            return list;
        }

...catch block removed for brevity

    }
} 
```

我有一个继承这个基类的类。

```
public class ConcreteViewModelHandler : BaseViewModelHandler<ConcreteViewModel>
{
    private readonly IMyService _myService;
    private readonly IMyListItemsService _myListItemsService

    public ConcreteViewModelHandler (IMyService myService, IMyListItemsService myListItemsService)
    {
        _myService = myService;
        _myListItemsService = myListItemsService
    }

    public override void Handle(ConcreteViewModel viewModel)
    {
        try
        {
            var myEntity = viewModel.Id.HasValue
                               ? _myService.GetById(viewModel.Id.Value)
                               : new MyEntity();

            myEntity.ListToManage = ManageListItems(viewModel.SelectedItemIds, myEntity.ListToManage, _myListItemsService);

...create/update removed for brevity

        }

...catch block removed for brevity

    }
} 
```

我正在尝试测试 Handle 方法。在我的测试中，我模拟了服务，并设置了“GetById”方法以返回我的类的新实例

```
_myListItemsServiceMock = new Mock<IMyListItemsService>();
_myListItemsServiceMock
      .Setup(s => s.GetById(It.IsAny<int>()))
      .Returns(new MyListItem{ Id : 1}); 
```

我的测试没有通过，当我单步执行代码时，`service.GetById(id);` 基类中的调用返回 null。这是我正确使用 Moq 的第一个项目，所以我担心我对框架的缺乏经验会让我遗漏一些东西。

任何帮助将不胜感激。

根据要求添加TestFixture ...

```
[TestFixture]
public class ConcreteViewModelHandlerTestFixture
{
    private Mock<IMyService> _myServiceMock;
    private Mock<IMyListItemsService> _myListItemsServiceMock;

    #region Test Data

    private readonly ConcreteViewModel _viewModel = new ConcreteViewModel
    {
        Id = 1,
    };

    #endregion

    [SetUp]
    public void SetUp()
    {
        _myServiceMock = new Mock<IMyService>();
        _myServiceMock
            .Setup(s => s.GetById(It.IsAny<int>()))
            .Returns(new MyEntity { Id: 1});

        _myListItemsServiceMock = new Mock<IMyListItemsService>();
        _myListItemsServiceMock
            .Setup(s => s.GetById(It.IsAny<int>()))
            .Returns(new MyListItem{ Id : 1});
    }

    [Test]
    public void _the_handle_method_works()
    {
        //arrange
        var handler = new ConcreteViewModelHandler(_myServiceMock.Object, _myListItemsServiceMock.Object);

        // act
        handler.Handle(_viewModel);

        // assert
        // no assertions yet as the code falls over
    }
} 
```

根据@Quinton Bernhardt 的要求添加更多细节

界面：

```
public interface IEntity
{
    int Id { get; }
    //Guid Guid { get; }
    int UpdateId { get; set; }
} 
```

基类：

```
public abstract class BaseEntity : IEntity
{
    protected BaseEntity()
    {
    }

    protected BaseEntity(int id)
    {
        Id = id;
    }

    public virtual int Id { get; protected internal set; }
    public virtual int UpdateId { get; set; }
} 
```

和 MyListItem 类

```
public class MyLIstitem : BaseEntity
{
    public MyLIstitem ()
    {
    }

    public MyLIstitem (int id)
        : base(id)
    {
    }

    public virtual string Name { get; set; }
    public virtual string Value { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T08:59:23.583

您的问题描述说：

> 我的测试没有通过，当我单步执行对 service.GetById(id); 的调用时 在我的基类中返回 null。

所以肯定是调用`ManageListItems<TE>()`失败就行了：

```
var item = service.GetById(id); 
```

希望我是正确的，因为这是一个假设[使用提供的信息]。

是否`IMyListItemService`实施`IService<IEntity>`？'因为你的代码暗示了它。

我能看到的唯一奇怪之处是 的最后一个参数`ManageListItems<TE>()`需要一个`IService<TE> where TE is IEntity`用于调用`service.GetById(id)`.

```
protected ISet<TE> ManageListItems<TE>(int[] selectedItemIds, ISet<TE> list, IService<TE> service) 
```

*留在我身边……，以后有道理……*

但是您从具体类中提供给该方法的对象是类型`IMyListItemsService`，从方法中的以下内容可以看出`Handle`：

```
myEntity.ListToManage = ManageListItems(viewModel.SelectedItemIds, myEntity.ListToManage, _myListItemsService); 
```

*我认为正在发生的事情...*您的设置`GetById`应该在`IService`而不是`IMyListItemsService`

在列表服务上设置 GetById 时，而不是这样：

```
 _myListItemsServiceMock
        .Setup(s => s.GetById(It.IsAny<int>()))
        .Returns(new IMyListItem{ Id : 1}); 
```

尝试

```
 _myListItemsServiceMock.As<IService>()
        .Setup(s => s.GetById(It.IsAny<int>()))
        .Returns(new IMyListItem{ Id : 1}); 
```

或者

```
 _myListItemsServiceMock.As<IService<IEntity>>()
        .Setup(s => s.GetById(It.IsAny<int>()))
        .Returns(new IMyListItem{ Id : 1}); 
```

# c# - 从大字符串中删除数字时的性能问题

> ID：14415583
> 
> 赞同：1
> 
> 时间：2013-01-19T14:57:58.150
> 
> 标签：c#, string

我有一个包含以下代码的函数：

```
Text = Text.Where(c => !Char.IsDigit(c)).Aggregate<char, string>(null, (current, c) => current + c); 
```

但它相当慢。无论如何我可以加快速度吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T15:00:36.927

试试这个正则表达式：

```
Text = Regex.Replace(Text, @"\d+", ""); 
```

`\d+`比`\d`一次删除多个连续数字更有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-19T15:00:38.690

是的，您可以使用`Regex.Replace`：

```
Text = Regex.Replace(Text, "\\d", ""); 
```

正则表达式匹配单个数字。用空字符串`Regex.Replace`替换字符串中出现的每个它。`Text``""`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-19T15:02:18.580

所有这些串联可能会杀死你。最简单/最好的可能是正则表达式：

```
Text = Regex.Replace(Text, "\\d", ""); 
```

* * *

或者您可以尝试只创建一个新的字符串实例：

```
Text = new string(Text.Where(c => !Char.IsDigit(c)).ToArray()) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-19T15:01:25.683

尝试使用[`Regex.Replace`](http://msdn.microsoft.com/en-us/library/system.text.regularexpressions.regex.replace.aspx);

> 在指定的输入字符串中，将匹配正则表达式模式的字符串替换为指定的替换字符串。

```
Regex.Replace(Text, "\\d+", ""); 
```

这是一个[`DEMO`](http://ideone.com/6XCaJU).

# css - 按需导入 LESS 文件

> ID：14415586
> 
> 赞同：1
> 
> 时间：2013-01-19T14:58:19.730
> 
> 标签：css, less

**SHORT：** 是否有可能“按需”导入更少的文件，仅当尚未定义函数/变量时？

**LONG：** 假设我有 LESS 文件，其中包含我的页面样式。让我们称之为`styles.less`。此外，我还有 5 个 LESS 文件。那里的每个人都包含通用设计原语，例如我在许多项目中使用的信息框的设计 - 这就是它没有被合并到`styles.less`. 假设它被称为`.infobox {}`.
那么，是否有可能“尝试”在`.infobox`未找到时导入这 5 个文件`styles.less`？我对通过lessc（节点模块）编译和Web浏览器中的“on-the-fly”编译感兴趣。

我希望我的示例足以说明情况 - 如果没有，请随时发表评论，我将编辑问题以提供更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:59:18.640

我还没有找到一种方法来使它完全自动化。我也不知道您是否需要此功能以减少`@import`请求或简单地减少最终 CSS 以不加载它不需要的项目。

如果您不需要它完全自动化，并且您只是想减少生成的 CSS，并且您没有太多想要执行此操作的类，那么您可以在`styles.less`文件中执行以下操作。

```
//have at the top of the file some variables set to 0 or 1 if the class
//is present or absent in that file
@usesClass-infobox: 0;

//set up a mixin to load it if NOT in the file
.setClass-infobox(@set) when (@set = 0) {
  @import 'infobox.less'; 
}

//a default mixin to do nothing otherwise
.setClass-infobox(@set) {}

//call the mixin
.setClass-infobox(@usesClass-infobox); 
```

当然，这并不能真正帮助自动化流程。毕竟，如果您知道文件`.infobox`中没有`styles.less`，那么您只需添加`@import`无论如何，无需任何额外的 mixin 来检查。这给出的唯一真正价值是它设置了一个变量部分，基本上通知编码器“嘿，如果你不在这里包含它，可以为这个功能加载一些模块；所以告诉我，你是否包含它？”

同样，我不确定这是否完全解决了您的目标。我提供它是因为它在某些情况下可能对某些人有用。

# ios - 使用 LIVE555 在 iOS 上播放 RTSP 流

> ID：14415589
> 
> 赞同：1
> 
> 时间：2013-01-19T14:58:52.320
> 
> 标签：ios, rtsp, live555

如何修改 Live555 的示例“openRTSP”[以](http://www.live555.com/liveMedia/)在 iOS App 中显示 RTSP 流？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T15:32:04.613

您可以查看 dropcam [https://github.com](https://github.com) 个人我发现它比其他一些框架（包括我们使用的框架）更难使用，但是 dropcam 示例应该可以满足您的需求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-19T13:03:18.903

您可以`MobileVLCKit`在内部使用 which use live555。

您可以在此处找到更多信息：[https ://stackoverflow.com/a/48340854/2003734](https://stackoverflow.com/a/48340854/2003734)

# windows - EasyPHP Windows7 错误的 PATH 变量

> ID：14415591
> 
> 赞同：3
> 
> 时间：2013-01-19T14:59:11.740
> 
> 标签：windows, path, php

我在 Windows 7 中遇到了环境变量 PATH 的问题。不幸的是 PHP-CLI 看到 PATH 变量不正确。如何解决我的问题？

服务器信息 Apache/2.4.2 (Win32) PHP/5.4.6 PHP 版本 5.4.6

包：EASYPHP e.devserver 12.1 和 PHP 5.4.6（最高 5.4.11 / 5.5.0 alpha 3）

问候， 马特乌斯

```
$ php
Failed loading c:\bin;.;C:\Program Files (x86)\Git\local\bin;C:\Program Files (x
86)\Git\mingw\bin;C:\Program Files (x86)\Git\bin;c:\Windows\system32;c:\Windows;
c:\Windows\System32\Wbem;c:\Windows\System32\WindowsPowerShell\v1.0\;c:\Program
Files\Dell\DW WLAN Card;c:\Program Files (x86)\Java\jdk1.6.0_30\bin;c:\ant\bin;c
:\EasyPHP\php\php546x130118150312\php\php546x130118150312\php_xdebug-2.2.1-5.4-v
c9.dll
PHP Warning:  PHP Startup: Unable to load dynamic library 'c:\bin;.;C:\Program F
iles (x86)\Git\local\bin;C:\Program Files (x86)\Git\mingw\bin;C:\Program Files (
x86)\Git\bin;c:\Windows\system32;c:\Windows;c:\Windows\System32\Wbem;c:\Windows\
System32\WindowsPowerShell\v1.0\;c:\Program Files\Dell\DW WLAN Card;c:\Program F
iles (x86)\Java\jdk1.6.0_30\bin;c:\ant\bin;c:\EasyPHP\php\php546x130118150312\ph
p\php546x130118150312\ext\php_bz2.dll' - Nie mo┐na odnalečŠ okreťlonego modu│u.
 in Unknown on line 0 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T15:02:54.647

我有同样的问题。我已`$PATH`使用完整路径（在 php.ini 中）更改了 并删除了`yaz`扩展名。然后它开始工作了。

# python - 如何从 Python 中查看 Tumblr 帖子的所有注释？

> ID：14415592
> 
> 赞同：9
> 
> 时间：2013-01-19T14:59:17.780
> 
> 标签：python, beautifulsoup, urllib2, tumblr

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T17:22:40.143

不幸的是，Tumblr API 似乎有一些限制（缺少关于 Reblogs 的元信息，注释限制为 50），所以你无法获取所有注释。

[根据服务条款](http://www.tumblr.com/policy/en/terms_of_service)也禁止进行页面抓取。

> “在访问或使用服务时，您不得进行以下任何操作：(...) 未经 Tumblr 事先明确书面同意，从服务中抓取服务，尤其是从服务中抓取内容（定义如下）；”

资源：

[https://groups.google.com/forum/?fromgroups=#!topic/tumblr-api/ktfMIdJCOmc](https://groups.google.com/forum/?fromgroups=#!topic/tumblr-api/ktfMIdJCOmc)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-20T18:54:30.217

如果没有 JS，您将获得仅包含注释的单独页面。对于提到的博客文章，第一页将是：

> [http://ronbarak.tumblr.com/notes/40692813320/4Y70Zzacy](http://ronbarak.tumblr.com/notes/40692813320/4Y70Zzacy)

以下页面链接在底部，例如：

*   [http://ronbarak.tumblr.com/notes/40692813320/4Y70Zzacy?from_c=1358403506](http://ronbarak.tumblr.com/notes/40692813320/4Y70Zzacy?from_c=1358403506)
*   [http://ronbarak.tumblr.com/notes/40692813320/4Y70Zzacy?from_c=1358383221](http://ronbarak.tumblr.com/notes/40692813320/4Y70Zzacy?from_c=1358383221)
*   [http://ronbarak.tumblr.com/notes/40692813320/4Y70Zzacy?from_c=1358377013](http://ronbarak.tumblr.com/notes/40692813320/4Y70Zzacy?from_c=1358377013)
*   …</li>

（请参阅[我关于如何](https://stackoverflow.com/a/20048088/1591669)在`a`'s`onclick`属性中找到下一个 URL 的答案。）

现在您可以使用各种工具来下载/解析数据。

以下 wget 命令应下载该帖子的所有注释页面：

```
wget --recursive --domains=ronbarak.tumblr.com --include-directories=notes http://ronbarak.tumblr.com/notes/40692813320/4Y70Zzacy 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-19T18:36:05.360

就像 Fabio 暗示的那样，最好使用 API。

如果由于任何原因您不能，那么您将使用的工具将取决于您想对帖子中的数据做什么。

*   对于数据转储： urllib 将返回您想要的页面的字符串
*   在 html 中寻找特定部分：lxml 相当不错
*   在不守规矩的 html 中寻找东西：绝对是 beautifulsoup
*   在一个部分中寻找一个特定的项目：beautifulsoup、lxml、文本解析是你所需要的。
*   需要将数据放在数据库/文件中：使用scrapy

Tumblr url 方案很简单：url/scheme/1、url/scheme/2、url/scheme/3 等等……直到你到达帖子的结尾，服务器不再返回任何数据。

因此，如果您打算以暴力方式进行抓取，您可以轻松地告诉脚本转储硬盘驱动器上的所有数据，直到内容标签为空为止。

最后一句忠告，请记住在你的脚本中放一个小的 sleep(1000)，因为你可能会给 Tumblr 服务器带来一些压力。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-09-16T18:59:59.307

**[如何在 tumblr 上加载所有笔记？](https://stackoverflow.com/questions/20035018/how-to-load-all-notes-on-tumblr)**也涵盖了这个话题，但 unor 的回应（上图）做得很好。

# opencl - 使用 OpenCL for CPU Device 时调用外部函数

> ID：14415600
> 
> 赞同：1
> 
> 时间：2013-01-19T15:00:15.887
> 
> 标签：opencl, llvm

我正在评估使用 OpenCL 即时编译 CPU 设备的性能关键数学表达式的可能性。我目前正在直接使用 LLVM（或者更确切地说，我有一个有效的概念证明），但会发现 OpenCL 提供的抽象在未来非常有用。

我现在试图弄清楚*在将 OpenCL 用于 CPU 设备时是否有某种方法可以通过外部链接调用函数*，相当于 LLVM 中的以下内容：

```
... = llvm::Function::Create(..., llvm::Function::ExternalLinkage, "...", ...); 
```

因为我的 OpenCL 实现至少是建立在 LLVM 之上的，所以我希望这能以某种方式实现。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:59:02.887

这个功能[http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/clEnqueueNativeKernel.html](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/clEnqueueNativeKernel.html)是否 完成了你所追求的？

编辑：信用到期的信用：[https ://stackoverflow.com/a/10807728/717881](https://stackoverflow.com/a/10807728/717881)

# javascript - 为什么是“点击”表单提交？

> ID：14415601
> 
> 赞同：2
> 
> 时间：2013-01-19T15:00:25.403
> 
> 标签：javascript, html, forms, preventdefault

`return`在下面的代码中按下`<input>`表单的 似乎会触发两个事件：

*   `submit`事件，
*   `click``<button>`表单中的第一个事件。

`preventDefault`似乎取消了`submit`事件，但`click`事件并没有停止，因为它是在事件*之前*触发的`submit`。我可以用 替换`<button>`，`<input type="button">`但为什么会被`<button>`点击？我该如何预防？

这是[http://jsfiddle.net/MNXUS/](http://jsfiddle.net/MNXUS/)的形式：

```
<form>
  <button></button>
  <input>
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:02:51.927

这正是浏览器所做的。如果您不希望按钮提交表单，可以将其设为“按钮”按钮而不是“提交”按钮：

```
<button type=button>Click Me</button> 
```

# c++ - 在 C++ 中打开一个 zip 文件并将文件移动到另一个 zip 中？

> ID：14415602
> 
> 赞同：0
> 
> 时间：2013-01-19T15:00:27.387
> 
> 标签：c++, zip, libraries, minecraft

我想打开一个 zip 文件 (mod.zip) 并将文件移动到另一个 zip 文件 (minecraft.zip) 并用相同的名称重写文件。我希望你能理解，因为我不是英语。我不知道我是否可以打开 zip 文件或者我需要库

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:03:48.657

我会推荐[7zip SDK](http://www.7-zip.org/sdk.html)`.7z` ，它可以让你以和`.zip`许多其他格式压缩和解压缩东西

# python - 合并列表列表

> ID：14415606
> 
> 赞同：0
> 
> 时间：2013-01-19T15:00:50.940
> 
> 标签：python, list, loops

> **可能重复：**
> [我想根据相似的属性对元组进行分组](https://stackoverflow.com/questions/13808774/i-want-to-group-tuples-based-on-similar-attributes)

我对 Python 和一般编码非常陌生，有一个像这样的集群对列表

```
[[1,2],[3,4],[2,3],[4,5]......], 
```

我已经编写了这段代码来将集群对加入更大的集群列表中。

```
for i in range (len(Clist)):
    for j in range(i+1,len(Clist)):
        for disk in Clist[i]:
            if disk in Clist[j]:
                joined=joincluster(Clist[i], Clist[j])
                Clist[i]=list(set(joined))
                Clist[j]=[]
                break 
```

我继续把空的拿出来。但是，当我有超过 30 个左右的集群对时，它并没有加入所有对，一些应该加入的集群还没有加入。我看不出哪里出错了？任何人都可以找出问题所在吗？

```
[[0, 2], [0, 9], [1, 10], [2, 0], [2, 9], [3, 6], [3, 10], [3, 11], [4, 5], [4, 7], [4, 12], [4, 14], [5, 4], [5, 8], [5, 12], [5, 14], [6, 3], [6, 10], [6, 11], [7, 4], [7, 12], [8, 5], [8, 14], [9, 0], [9, 2], [9, 13], [10, 1], [10, 3], [10, 6], [10, 11], [11, 3], [11, 6], [11, 10], [12, 4], [12, 5], [12, 7], [13, 9], [14, 4], [14, 5], [14, 8]] 
```

抱歉，只有当我有相当多的配对时才会出现问题。这就是我得到的

```
[[0, 9, 2, 13], [11, 1, 10, 3, 6], [3, 6], [4, 5, 7, 8, 12, 14]] 
```

所以那里的 3,6 应该已经合并但它没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:02:23.090

让我们举一个更简单的例子，只有 4 个这样的集群：

```
clusters = [ [1, 10], [1, 20], [3, 6], [3, 10] ] 
```

这 4 个足以说明为什么`[3, 6]`会与所有其他集群分开。您从第一个到最后一个循环遍历这些集群。这是发生的事情：

1.  是否已经有一个集群拥有`1`或`10`在其中？- 不，创建一个新的，包括两者。我们现在有以下内容：`[[1, 10]]`.
2.  是否已经有一个集群拥有`1`或`20`在其中？- 是的，追加到比赛中。我们现在有以下内容：`[[1, 10, 20]]`.
3.  是否已经有一个集群拥有`3`或`6`在其中？- 不，创建一个新的，包括两者。我们现在有以下内容：`[[1, 10, 20], [3, 6]]`.
4.  是否已经有一个集群拥有`3`或`10`在其中？- 是的，追加到比赛中。我们现在有以下内容：`[[1, 3, 10, 20], [3, 6]]`.

问题是：在附加`[3, 10]`到之后`[1, 10]`，它不会检查是否已经存在现有的集群`3`，而没有`10`. 您需要将其添加到您的代码中，它会正常工作。

# java - requestLocationUpdates 按错误时间生成位置

> ID：14415607
> 
> 赞同：1
> 
> 时间：2013-01-19T15:00:55.030
> 
> 标签：java, android, geolocation

我正在尝试从 2 个不同的提供商处获取位置：网络和 GPS。

我正在使用 minTime 1 分钟和 minDistance 300 米`requestLocationUpdates`。使用这些参数，我不希望每分钟（每个提供商）获得超过一个更新。问题是，我获得更新的频率比这更高（每分钟超过 1 次）。为什么？

下面是一些代码来演示：

```
 mLocationManager.removeUpdates(listener);
    if (mLocationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)) 
        mLocationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, TEN_SECONDS*6, TEN_METERS*30, listener);

    if (mLocationManager.isProviderEnabled(LocationManager.NETWORK_PROVIDER)) 
        mLocationManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, TEN_SECONDS*6, TEN_METERS*30, listener); 
```

这是听众：

```
private final LocationListener listener = new LocationListener() 
{

    @Override
    public void onLocationChanged(Location location) 
    {
        if(location.getProvider().equals(LocationManager.NETWORK_PROVIDER))
            updateUILocation(location,LocationService.this.gpsLocation);
        else
            updateUILocation(LocationService.this.networkLocation, location);   
    }

    @Override
    public void onProviderDisabled(String provider) {
    }

    @Override
    public void onProviderEnabled(String provider) {
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
    }
}; 
```

更新UI位置：

```
private void updateUILocation(Location networkLocation,Location gpsLocation) 
{
    Location location = null;
    if(gpsLocation == null || gpsLocation.getAccuracy() > 800)
    {
        if(!(networkLocation == null || networkLocation.getAccuracy() > 800))
            location = networkLocation;
    }
    else
        if(networkLocation == null)
        {
            if(gpsLocation.getAccuracy() < 800)
                location = gpsLocation;
        }
        else
            if(gpsLocation.getAccuracy() < networkLocation.getAccuracy() && gpsLocation.getAccuracy() < 500)
                location = gpsLocation;
            else
                if(networkLocation.getAccuracy() < 800)
                    location = networkLocation;
    if(location!=null)
    {
         if (mGeocoderAvailable) 
            doReverseGeocoding(location);
    }

    // Bypass reverse-geocoding only if the Geocoder service is available on the device.

} 
```

doReverseGeocoding 将位置转换为文本并调用处理程序：

```
 mHandler = new Handler() 
    {
        public void handleMessage(Message msg) 
        {
            if(msg.what == UPDATE_ADDRESS) // msg.what == 1
            {
                LocationService.this.address = (String) msg.obj;
                new SendLocation(LocationService.this.id,(String)msg.obj); //send the location to the db
                LocationService.this.gpsLocation = null; //reset gps value
                LocationService.this.networkLocation = null; //reset network value
            }
        }
    }; 
```

我在开车时测试了这个应用程序（这意味着 minDistance 参数不是一个因素），我每分钟收到超过 1 个位置更新。

以下是我在测试时收到的位置（请忽略这些位置，因为它是希伯来语，只需寻找时间）：http: [//imrip.interhost.co.il/](http://imrip.interhost.co.il/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T19:01:19.770

> “minTime 是 1 分钟，minDistance 是 300 米。有了这些参数，我永远不会在不到 1 分钟的时间内获得 2 个位置......”

这根本不是真的，无论如何都不是 JellyBean 之前的。

[http://developer.android.com/reference/android/location/LocationManager.html](http://developer.android.com/reference/android/location/LocationManager.html)

> 在 Jellybean 之前，minTime 参数只是一个提示，一些位置提供程序实现忽略了它。从 Jellybean 及以后，Android 兼容设备必须遵守 minTime 和 minDistance 参数。

在 JB 之前，您可以获得比您指定的最短时间更频繁的更新，尤其是在 GPS 接收不准确的情况下。有关更多详细信息，请参阅此答案：

[Android中的requestLocationUpdates间隔](https://stackoverflow.com/questions/3993658/requestlocationupdates-interval-in-android)

# xml - CakePHP：通过 REST Web 服务编辑资源

> ID：14415611
> 
> 赞同：0
> 
> 时间：2013-01-19T15:01:40.363
> 
> 标签：xml, rest, binding, cakephp-2.0

我有一个名为的数据库表`seasons`：

```
CREATE TABLE IF NOT EXISTS `seasons` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `title` varchar(250) NOT NULL COMMENT 
  `year` year(4) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `title` (`title`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=latin1 AUTO_INCREMENT=2 ; 
```

该表绑定到`Season`模型和`SeasonsController`。现在我想实现一个 REST web 服务，遵循[这里](http://book.cakephp.org/1.3/en/The-Manual/Common-Tasks-With-CakePHP/REST.html)解释的规则。我正面临着一个季节（`view($id)`方法）的检索，所有季节（`index()`方法）的检索和现有季节（方法）的删除`delete($id)`。

当我想创建新季节或编辑现有季节时，就会出现问题。我认为问题是因为我弄错了发送 XML 请求的方式。有人知道我该如何处理吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T07:38:12.673

首先，这将有助于显示您的控制器操作。我怀疑问题可能是您发送到 save 方法的内容。在保存之前尝试输出 $this->data 并查看结构。确保它看起来像这样[http://book.cakephp.org/2.0/en/models/saving-your-data.html#saving-your-data](http://book.cakephp.org/2.0/en/models/saving-your-data.html#saving-your-data)

如果这没有帮助，请在您的问题中发布 debug($this->data) 和您的控制器的内容

# asp.net - Web.config 构建与发布转换不起作用

> ID：14415614
> 
> 赞同：29
> 
> 时间：2013-01-19T15:02:13.963
> 
> 标签：asp.net, build, web-config, release, web-config-transform

我有一个 ASP.NET Web 应用程序项目，它通过实体框架连接到远程数据库。在调试期间（例如在我的本地计算机上运行项目），数据库的 IP 地址与发布期间不同（例如在将项目上传到我的网络服务器并从浏览器运行之后）。到目前为止，我一直手动更改 Web.config 文件中的数据库连接字符串以在两者之间切换（基本上我必须连接字符串，一个名为“Debug”，一个名为“Release”，我只是在部署时交换名称）。

现在我刚刚注意到应该可以通过[Web.config 转换语法](http://msdn.microsoft.com/en-us/library/dd465326(VS.100).aspx)让这种情况自动发生，您将修改后的连接字符串放在 Web.Release.config 版本中，然后当 DLL 在 Release 配置下构建时它应该使用它.

然而它似乎对我不起作用......

这是我的常规 Web.config 文件的相关部分（其中包含本地使用的 Debug 连接字符串）：

```
<?xml version="1.0"?>
<configuration>

  <connectionStrings>
    <!-- Debug connection string. Release connection string is in Web.Release.config file -->
    <add name="DatabaseEntities" connectionString="A" providerName="System.Data.EntityClient" />
  </connectionStrings>

</configuration> 
```

这是 Web.Release.config 文件，根据示例，如果 DLL 处于发布模式，则应将“DatabaseEntities”连接字符串“A”替换为“B”：

```
<?xml version="1.0"?>
<configuration xmlns:xdt="http://schemas.microsoft.com/XML-Document-Transform">

  <!-- Replace the DatabaseEntities connection string with the Release version (local IP address) -->
  <connectionStrings>
    <add name="DatabaseEntities"
      connectionString="B"
      xdt:Transform="Replace" xdt:Locator="Match(name)"/>
  </connectionStrings>

</configuration> 
```

（显然“A”和“B”只是我真实连接字符串的占位符）

当我调试应用程序（例如，只需按 F5）时，使用默认的 Web.config，我可以访问数据库。然后我通过配置管理器将构建配置更改为发布。解决方案中的所有项目都设置为发布配置。然后我构建解决方案（仅通过构建，甚至通过完整的重建（例如清理、重建））。我将新建的 DLL 以及 Web.config 和 Web.Release.config 文件上传到网络服务器，当我尝试访问我无法访问的数据库时，它仍在尝试通过调试 IP 地址访问数据库因此找不到它...

似乎 Web.Release.config 文件被完全忽略了，或者至少连接字符串没有被替换。

我究竟做错了什么？转换语法是否错误？我没有在发布模式下正确构建应用程序吗？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-01-19T16:03:32.937

> 然后我构建解决方案（仅通过构建，甚至通过完整的重建（例如清理、重建））。我将新建的 DLL 以及 Web.config 和 Web.Release.config 文件上传到网络服务器

您的错误是：如果您只是构建，Web 配置转换将不适用于您的本地环境。你需要发布。

您的部署过程看起来很奇怪：您只是在复制 DLL、Web.config 和 web.Release.config。在我看来，您复制的是源代码而不是已编译的应用程序。已发布的 WebApplication 不包含 web.release.config。

您应该将您的项目（右键单击您的 WebApplication -> Publish）发布到本地文件系统并从那里复制文件，或者使用您选择的其他部署方法。

2 年前，我写了一篇关于 web.config 转换的文章。它为您提供了 VS 2010 的分步教程（VS 2012 中更改了发布对话框）：[http ://www.tomot.de/en-us/article/5/asp.net/how-to-use -web.config-transforms-to-replace-appsettings-and-connectionstrings](http://www.tomot.de/en-us/article/5/asp.net/how-to-use-web.config-transforms-to-replace-appsettings-and-connectionstrings)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-14T06:47:57.177

我认为只有在您发布网站/应用程序时才能完成转换。构建应用程序时未完成。后者会在源代码控制下不断更改 web.config（这将是一个真正的麻烦）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-06-12T08:27:14.003

你可以试试 Slow Cheetah 插件：

[http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5](http://visualstudiogallery.msdn.microsoft.com/69023d00-a4f9-4a34-a6cd-7e854ba318b5)

这将通过为您提供额外的上下文菜单选项，让您看到“实时”转换。右键单击并选择 Preview Transform 以查看转换，而无需进行构建。它对于实现 app.config 转换也非常方便

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-04T19:20:06.873

如果只有在 web.config 转换期间未覆盖的连接字符串，那么这就是我所做的：我清除了“发布 Web”向导的“设置”部分中的“在运行时使用此连接字符串”复选框。此设置正在覆盖连接字符串的 web.config 转换。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-09-21T09:01:09.720

Inside your csproj file, you can add an action to execute before every build and perform the web.config transformations:

```
<Target Name="BeforeBuild">
    <TransformXml Source="web.config" Transform="web.$(Configuration).config" Destination="web.config" />
</Target> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-10-24T17:53:38.720

它非常灵活，您应该能够进行一些调整以在构建上应用自定义转换（并且无需发布）

我们在我们的（Windows 服务）项目中实现了这一点，在构建上应用了转换

您将需要修改您的项目文件并添加类似于下面的内容

在这里，我们告诉 msbuild 在完成编译后应用转换，但前提是条件为真（请参阅[https://docs.microsoft.com/en-us/visualstudio/msbuild/msbuild-conditions?view=vs-2017](https://docs.microsoft.com/en-us/visualstudio/msbuild/msbuild-conditions?view=vs-2017)）

请注意，我们正在使用构建道具（自定义 msbuild 道具）“Env”，例如`msbuild ... /p:Env=Prod`会导致*App.Prod.config*

```
<UsingTask TaskName="TransformXml" AssemblyFile="C:\Some\Path\Microsoft.Web.Publishing.Tasks.dll" />
<Target Name="AfterCompile" Condition="Exists('some condition')">
  <!--Generate transformed app config in the intermediate directory-->
  <TransformXml Source="App.config" Destination="$(IntermediateOutputPath)$(TargetFileName).config" Transform="App.$(Env).config" />
  <!--Force build process to use the transformed configuration file from now on.-->
  <ItemGroup>
    <AppConfigWithTargetPath Remove="App.config" />
    <AppConfigWithTargetPath Include="$(IntermediateOutputPath)$(TargetFileName).config">
      <TargetPath>$(TargetFileName).config</TargetPath>
    </AppConfigWithTargetPath>
  </ItemGroup>
</Target> 
```

# python - Python：将参数从 argparse 传递给导入的脚本

> ID：14415616
> 
> 赞同：1
> 
> 时间：2013-01-19T15:02:16.740
> 
> 标签：python, argparse

我正在构建一个命令行工具，它在一个主 *.py 文件（我们称之为“main_file.py”）中执行一些 python 脚本（k2_fig1 - k2_fig3）。在这个“main_file.py”中，用户必须为数据库连接填写一些参数（用户名、dbname 等）。
现在我不知道如何将这些参数传递给我正在导入的每个 python 脚本。我必须为这些导入的文件编写什么代码？
这是我的“main_file.py”代码：

```
import argparse
def main():
  parser = argparse.ArgumentParser()

  parser.add_argument('-D', '--database', action="store", type=str, dest="my_dbname",  required=True, help="DB name")

  parser.add_argument('-U', '--username', action="store", type=str, dest="my_username", required=True, help="DB username")

  args = parser.parse_args()

  # Import different scripts
  import k2_fig1
  import k2_fig2
  import k2_fig3

if __name__ == '__main__':
  main() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:25:28.673

在不了解 k2fig_1 等其他任何信息的情况下，您需要使用`subprocess`而不是导入它们来调用它们。

```
import argparse
import subprocess

def main():
  parser = argparse.ArgumentParser()
  parser.add_argument('-D', '--database', action="store", type=str, dest="my_dbname",  required=True, help="DB name")
  parser.add_argument('-U', '--username', action="store", type=str, dest="my_username", required=True, help="DB username")

  args = parser.parse_args()
  for script in ['k2_fig1', 'k2_fig2', 'k2_fig3']:
      subprocess.call([script, '-U', args.my_username, '-D', args.my_dbname])

if __name__ == '__main__':
  main() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:38:39.767

我认为最好的方法是将命名空间属性复制到“配置”模块::

```
import argparse

from . import config
from . import other

def update_obj(dst, src):
    for key, value in src.items():
        setattr(dst, key, value)

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument('-D', '--database')
    parser.add_argument('-U', '--username')

    args = parser.parse_args('-D foo'.split())

    update_obj(config, args) 
```

和“其他模块”::

```
from . import config

def some_func():
    assert config.database == 'foo' 
```

# javascript - 用 Javascript 将军用时间替换为正常时间

> ID：14415618
> 
> 赞同：4
> 
> 时间：2013-01-19T15:02:19.750
> 
> 标签：javascript

有了这个脚本

```
getFormattedTime = function (fourDigitTime){
var hours24 = parseInt(fourDigitTime.substring(0,2));
var hours = ((hours24 + 11) % 12) + 1;
var amPm = hours24 > 11 ? 'pm' : 'am';
var minutes = fourDigitTime.substring(2);

return hours + ':' + minutes + amPm;
}; 
```

我可以将 4 位时间更改为正常时钟时间（虽然 0930 有问题..）

有了这个

```
$("body").html($("body").html().replace(/1135/g,'11:35am')); 
```

替换我页面中任何 1135 的出现。

但是，在我的页面中，我有一个表格中的时间列表。我需要转换它们，例如

```
Class starts at 1700, please be there by 1630 and sign in by 1645. 
```

它应该翻译成

```
Class starts at 05:00pm, please be there by 04:30pm and sign in by 04:45pm. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T15:21:26.247

假设文本中显示的唯一数字是您可以使用的时间：

```
var txt = 'Class starts at 0845, please be there by 1630 and sign in by 1645.'

getFormattedTime = function (fourDigitTime) {
    var hours24 = parseInt(fourDigitTime.substring(0, 2),10);
    var hours = ((hours24 + 11) % 12) + 1;
    var amPm = hours24 > 11 ? 'pm' : 'am';
    var minutes = fourDigitTime.substring(2);

    return hours + ':' + minutes + amPm;
};
/* replace numeric entities*/
var newTxt = txt.replace(/(\d+)/g, function (match) {
    return getFormattedTime(match)
})
$('body').html(newTxt); 
```

演示：http: [//jsfiddle.net/q6HC9/1](http://jsfiddle.net/q6HC9/1)

编辑：在标签中包装时间将大大简化情况。用一个公共类将所有军事时间包装在一个跨度中，然后使用该`html()`方法

```
<span class="mil_time">0845</span> 
```

```
getFormattedTime = function (fourDigitTime) {
    /* make sure add radix*/
    var hours24 = parseInt(fourDigitTime.substring(0, 2),10);
    var hours = ((hours24 + 11) % 12) + 1;
    var amPm = hours24 > 11 ? 'pm' : 'am';
    var minutes = fourDigitTime.substring(2);

    return hours + ':' + minutes + amPm;
};
/* find all spans and replace their content*/
$('span.mil_time').html(function( i, oldHtml){
   return getFormattedTime(oldHtml);
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T15:26:45.940

用这个：

```
var getFormattedTime = function (fourDigitTime){
    var hours24 = parseInt(fourDigitTime.substring(0,2), 10);
    var hours = ((hours24 + 11) % 12) + 1;
    var amPm = hours24 > 11 ? 'pm' : 'am';
    var minutes = fourDigitTime.substring(2);

    return hours + ':' + minutes + amPm;
};

s = "Class starts at 1700, please be there by 1630 and sign in by 1645.";

c = s.replace(/([^\d]*)([0-9]{4})([^\d]*)/g, function(match, p1, p2, p3) {
    return p1 + getFormattedTime(p2) + p3
});

console.log(c); 
```

输出：

```
Class starts at 5:00pm, please be there by 4:30pm and sign in by 4:45pm. 
```

**更新**

在你的情况下：

```
s = $("body").html();

c = s.replace(/([^\d]*)([0-9]{4})([^\d]*)/g, function(match, p1, p2, p3) {
    return p1 + getFormattedTime(p2) + p3
});

$("body").html(c); 
```

**更新 2**

如果你有时间在里面`<td class="fourDigitTime">1500</td>`，那就用这个：

```
$(".fourDigitTime").each(function() {
    $(this).text(getFormattedTime($(this).text());
}); 
```

[现场演示](http://jsfiddle.net/q6HC9/44/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T15:25:16.510

您可以在正则表达式中使用[单词边界](http://www.regular-expressions.info/wordboundaries.html)来匹配 4 位数字，然后将您的`getFormattedTime`函数用作替换函数[`.replace`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/replace)：

```
$('body').html(function(_, old) {
    return old.replace(/\b\d{4}\b/g, getFormattedTime);
}); 
```

请注意@Doorknob 和@Pointy 的评论。要仅替换时间“数字”，您需要对它们进行语义标记，例如使用 html5[`<time>`标签](http://www.w3.org/TR/html5/text-level-semantics.html#the-time-element)：

```
Class starts at <time>1700</time>, please be there by <time>1630</time> and sign in by <time>1645</time>. 
```

```
$('time').text(function(_, old) {
    return getFormattedTime(old);
}); 
```

# c++ - 不知道为什么代码被计算两次

> ID：14415619
> 
> 赞同：-2
> 
> 时间：2013-01-19T15:02:25.630
> 
> 标签：c++, counter

我不确定为什么变量的代码是已知的。它总是加倍 2 倍。该代码假设显示处理有效卡无效卡和未知卡的时间。已知的卡是美国运通发现签证和大师的卡。我试图计算它们的数量，但似乎由于某种原因它们总是加倍

```
#include <iostream>
#include <string>
#include <fstream>
using namespace std;

void validateCC(string);
string checkCC(string, int, bool&);
bool validateCCNum(string);
string setCCType(string);
int proc = 0, valid = 0 , invalid = 0 , unknown = 0 , known = 0; 

void main() {
    string cardnum[300];
    int ccLen; 
    ifstream openfile("Sample Credit Card numbers.txt");
    if (openfile.is_open())
    { 
        while(!openfile.eof())
        {
            for (int count = 0;  !openfile.eof(); count++)
            {
                getline(openfile,cardnum[count]);
                ccLen = cardnum[count].length();
                cout<<"sdfsd";
                proc++;
                if (ccLen !=0)
                {
                validateCC(cardnum[count]);
                }
            }

         }

        cout<<valid<<" valid\n";
        cout<<invalid<<" invalid\n";
        cout<<unknown<< " unknwon\n";
        cout<<proc<<" processed\n";
        system("Pause");
    }
}

void validateCC(string ccn) {
    string msg;
    bool OK;
    int ccLen;
    ccLen = ccn.length();
    msg = checkCC(ccn, ccLen, OK);
    if(!OK)
    {
        cout <<ccn<< msg << "\n";
        invalid++;
    }
    else 
    {
        if(validateCCNum(ccn))
        {
            msg =  setCCType(ccn);
            setCCType(ccn);
            valid++;
            cout<<ccn<<msg << "Card Type\n"; 
        }
        else
        {

        cout << (ccn)<<" Invalid"<< " credit card number\n";
        invalid++;
        }
    }
}

string checkCC(string c, int cLen, bool& ccOK) {
    string s = "";
    ccOK = true;
    for(int i=0;i<cLen && ccOK;++i)
        ccOK = isdigit(c[i]);
    if(ccOK == false) {
        s = " Invalid credit card number digits";
    } else if(cLen == 15) {
        if(c.substr(0, 2) != "34" && c.substr(0, 2) != "37") {
            ccOK = false;
            s = " Invalid American Express credit card number";
        }
    } else if(cLen != 16) {
        ccOK = false;
        s = " Invalid credit card number length";
    }
    return s;
}

bool validateCCNum(string cc) {
    bool flip = true;
    int tmp, num = 0, ccLen = cc.length()-1;
    for(int ndx=ccLen;ndx>=0;ndx--) {
            if (flip)
                num += cc[ndx] - '0';
            else {
                tmp = (cc[ndx] - '0') * 2;
                if(tmp <= 9)
                    num += tmp;
                else
                    num += (1 + (tmp - 10)); // max of 18
            }
            flip = !flip;
    }
    return num % 10 == 0;
}

string setCCType(string cc) {
    int num = cc[0]-'0';
    int num1 =cc[1]-'0';
    int num2 = cc[2]-'0';
    int num3 = cc[3]-'0'; 
    string cct = " Unknown";
    if(cc.length()==15 &&num ==3 &&num1 ==4|| cc.length()==15 &&num ==3 &&num1 ==7)
    {
        cct = " American Express";
        known++;
    }
    else if(num == '4')
    {
        cct = " Visa";
        known++;
    }
    else if(num ==5 && num1 ==1 ||num ==5 && num1 ==2|| num ==5 && num1 ==3||num ==5 && num1 ==4|| num ==5 && num1 ==5)
    {
        cct = " MasterCard";
        known++;
    }
    else if (num == 6 && num1 ==0 && num2 == 1 && num3==1 || num ==6 && num==5)
    {
        cct = " Discover"; //ignoring other prefixes
        known++;
    }
    else
    {
        unknown++;
    }
    return cct;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:06:11.917

```
 msg =  setCCType(ccn);
        setCCType(ccn); 
```

您正在调用该函数两次。这计算`known`/`unknown`两次。

# mysql - MySQL 结果集

> ID：14415620
> 
> 赞同：-1
> 
> 时间：2013-01-19T15:02:32.920
> 
> 标签：mysql, performance, resultset, overhead

我对来自服务器的结果集有疑问。有没有什么办法可以不接收非常大的字段名称和元数据，即使我做了一个 prep.statement 和绑定等。返回非常大，我的实际数据为 15% 其余的我的 col 名称等。

当我进行绑定时，我不明白接收结果集的 columnname 的事实。最聪明的方法当然应该是结果集是 stmhandle + 日期偏移量的形式，因为客户端现在已经如何绑定了。

这很奇怪，还是我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:17:39.217

结果集元数据始终与结果集一起返回。不，没有办法关闭它。

元数据只是与 SQL 查询相关的“开销”的一部分。

这种开销是运行单个查询以获取所需数据集而不是执行多个语句“更有效”的重要原因。

# app-inventor - Appinventor 应用行为

> ID：14415621
> 
> 赞同：0
> 
> 时间：2013-01-19T15:02:38.877
> 
> 标签：app-inventor

我制作了一个调用我的移动网站的应用程序。移动网站有一个点击通话按钮，在我的应用程序中触摸此按钮时，我收到一条错误消息，提示“网页不可用”。如果我通过浏览器访问我的网站，这不是问题。有人知道该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T19:10:02.480

你在使用 webviewer 组件吗？webviewer 不是完整的浏览器...
您可以在 App Inventor 中添加一个按钮，并交替使用[电话组件。](http://appinventor.mit.edu/explore/content/social.html#PhoneCall)

或者您可以使用活动启动器启动完整的浏览器来显示您的页面，更多信息请参见[此处](http://appinventor.mit.edu/explore/content/using-activity-starter.html)

> **打开浏览器到网页**
> 
> 使用这些活动启动器属性打开特定网页：
> 
> 行动：android.intent.action.VIEW
> DataUri：[http ://news.google.com](http://news.google.com)

# c# - 当前 Web 请求执行期间发生未处理的异常

> ID：14415626
> 
> 赞同：1
> 
> 时间：2013-01-19T15:02:59.690
> 
> 标签：c#, asp.net, exception-handling, hresult

突然，当我运行我的 Web 应用程序时，我收到了这个错误：

> 无法加载文件或程序集 'file:///C:\Users\rafael\AppData\Local\Temp\Temporary ASP.NET Files\root\284bddf3\431c8965\App_Web_homepage.aspx.cdcab7d2.vmizb1js.dll' 或其中之一它的依赖关系。句柄无效。（来自 HRESULT 的异常：0x80070006 (E_HANDLE)）

这是堆栈跟踪：

```
FileLoadException: Could not load file or assembly 'file:///C:\Users\rafael\AppData\Local\Temp\Temporary ASP.NET Files\root\284bddf3\431c8965\App_Web_homepage.aspx.cdcab7d2.vmizb1js.dll' or one of its dependencies. The handle is invalid. (Exception from HRESULT: 0x80070006 (E_HANDLE))]
   System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +0
   System.Reflection.RuntimeAssembly.nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks) +39
   System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, StackCrawlMark& stackMark, Boolean forIntrospection, Boolean suppressSecurityChecks) +132
   System.Reflection.Assembly.Load(AssemblyName assemblyRef, Evidence assemblySecurity) +28
   System.CodeDom.Compiler.CompilerResults.get_CompiledAssembly() +93
   System.Web.Compilation.BuildProvider.CreateBuildResult(CompilerResults results) +60
   System.Web.Compilation.TemplateControlBuildProvider.CreateBuildResult(CompilerResults results) +36
   System.Web.Compilation.BuildProvider.GetBuildResult(CompilerResults results) +16
   System.Web.Compilation.BuildManager.CompileWebFile(VirtualPath virtualPath) +9086138
   System.Web.Compilation.BuildManager.GetVPathBuildResultInternal(VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) +320
   System.Web.Compilation.BuildManager.GetVPathBuildResultWithNoAssert(HttpContext context, VirtualPath virtualPath, Boolean noBuild, Boolean allowCrossApp, Boolean allowBuildInPrecompile, Boolean throwIfNotFound, Boolean ensureIsUpToDate) +111
   System.Web.Compilation.BuildManager.GetVirtualPathObjectFactory(VirtualPath virtualPath, HttpContext context, Boolean allowCrossApp, Boolean throwIfNotFound) +125
   System.Web.Compilation.BuildManager.CreateInstanceFromVirtualPath(VirtualPath virtualPath, Type requiredBaseType, HttpContext context, Boolean allowCrossApp) +52
   System.Web.UI.PageHandlerFactory.GetHandlerHelper(HttpContext context, String requestType, VirtualPath virtualPath, String physicalPath) +31
   System.Web.UI.PageHandlerFactory.System.Web.IHttpHandlerFactory2.GetHandler(HttpContext context, String requestType, VirtualPath virtualPath, String physicalPath) +40
   System.Web.HttpApplication.MapHttpHandler(HttpContext context, String requestType, VirtualPath path, String pathTranslated, Boolean useAppConfig) +167
   System.Web.HttpServerUtility.Execute(String path, TextWriter writer, Boolean preserveForm) +517

[HttpException (0x80004005): Error executing child request for /homepage.aspx.]
   System.Web.HttpServerUtility.Execute(String path, TextWriter writer, Boolean preserveForm) +816
   System.Web.HttpServerUtility.Transfer(String path, Boolean preserveForm) +57
   System.Web.HttpServerUtility.Transfer(String path) +32
   photography.Global.Application_BeginRequest(Object sender, EventArgs e) in F:\Web Prog\my work\mcpd\gallery\photography\photography\Global.asax.cs:27
   System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +148
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +75 
```

我不知道这是怎么回事。因此，如果我得到任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:26:36.527

你有选择`stop and restart the website`吗？

从理论上讲，`recycle the application pool for your site`这应该足以纠正问题。

我希望这对你有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T14:05:24.437

在您的服务器上执行以下操作：

1.  打开命令提示符并运行以下命令：
2.  C:\WINDOWS\Microsoft.NET.NET Framework\Framework 版本\aspnet_regiis.exe -i

其中 .NET 框架版本可以替换为您的应用程序项目的 .NET 框架。v2.0.50727 或 4.0 等

尝试再次运行该应用程序，你会没事的。

# java - 警报管理器不会触发

> ID：14415632
> 
> 赞同：0
> 
> 时间：2013-01-19T15:04:04.000
> 
> 标签：java, android

我昨天问了一个与此类似的问题，但我对代码进行了一些更改，现在又遇到了不同的问题。

我有一个切换按钮，可以设置一个带有待处理意图的警报管理器，该意图应在 5 秒后触发。我将其设置为一次性设置，因此我希望消息出现一次（稍后我将针对日期值实施此操作）。

这段代码没有错误，但我似乎无法触发我的意图，然后显示我的 toast 消息。

以下是我在 xml 中定义“DateAlarm”类活动的方式：

```
 <activity
        android:name=".DateAlarm"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.example.flybase2.DateAlarm" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity> 
```

这是我的切换按钮 onClick 方法，用于带有警报管理器的切换按钮：

```
case (R.id.toggleButton1):

    Integer dobMonth = setDate.getMonth();
    Integer dobYear = setDate.getYear();
    Integer dobDate = setDate.getDayOfMonth();

    Date set;
    set = new Date(dobYear - 1900, dobMonth, dobDate);

    AlarmManager am = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
    Intent intent = new Intent(this, DateAlarm.class);
    PendingIntent pendingIntent = PendingIntent.getService(this, 0, intent, PendingIntent.FLAG_ONE_SHOT);
    am.set(AlarmManager.RTC_WAKEUP,System.currentTimeMillis() + (5 * 1000), pendingIntent); 

    break; 
```

还有我的最后一个'DateAlarm'类，它包含了意图的动作。

```
package com.example.flybase2;

import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.widget.Toast;

public class DateAlarm extends Activity {

Context context;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

     Toast.makeText(context, "Appointment is today", Toast.LENGTH_LONG).show();
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:11:52.950

你有两个问题：

1.  你正在使用`PendingIntent.getService()`而不是`PendingIntent.getActivity()`因为`DateAlarm`扩展`Activity`，你想要`PendingIntent.getActivity()`。

2.  在`DateAlarm`您的上下文变量中为空。在 onCreate() 你应该初始化它。另请注意，由于`Activity`extends `Context`，不需要此变量。但是，如果您确实想使用该变量，请执行以下操作：

```
super.onCreate(savedInstanceState);
context = this; 
```

或者

```
Context context = this; //right from the global declaration 
```

# java - Android 保存详细信息屏幕

> ID：14415638
> 
> 赞同：0
> 
> 时间：2013-01-19T15:04:51.750
> 
> 标签：java, android, android-layout

我正在做一个小项目，该项目需要一个详细信息屏幕，用户可以在其中输入他的详细信息并将其永久存储。如果需要，用户还必须可以选择更改详细信息。我查看了保存的首选项库，但它似乎没有提供这样的功能。

为了直观地了解需要什么，类似这个屏幕的东西应该没问题：

[http://www.google.com.mt/imgres?start=97&num=10&hl=en&tbo=d&biw=1366&bih=643&tbm=isch&tbnid=aQSZz782gIfOeM:&imgrefurl=http://andrejusb.blogspot.com/2011/10/iphone- web-application-development-with.html&docid=YpPF3-T8zLGOAM&imgurl=http://2.bp.blogspot.com/-YRISJXXajD0/Tq2KTpcqWiI/AAAAAAAFiE/-aJen8IuVRM/s1600/7.png&w=365&h=712&ei=rbX6ULTDCOfV4gTroIDoCg&zoom=1&iact= hc&vpx=834&vpy=218&dur=2075&hovh=314&hovw=161&tx=80&ty=216&sig=108811856681773622351&page=4&tbnh=155&tbnw=79&ndsp=35&ved=1t:429,r:4,s:100,i:16](http://www.google.com.mt/imgres?start=97&num=10&hl=en&tbo=d&biw=1366&bih=643&tbm=isch&tbnid=aQSZz782gIfOeM:&imgrefurl=http://andrejusb.blogspot.com/2011/10/iphone-web-application-development-with.html&docid=YpPF3-T8zLGOAM&imgurl=http://2.bp.blogspot.com/-YRISJXXajD0/Tq2KTpcqWiI/AAAAAAAAFiE/-aJen8IuVRM/s1600/7.png&w=365&h=712&ei=rbX6ULTDCOfV4gTroIDoCg&zoom=1&iact=hc&vpx=834&vpy=218&dur=2075&hovh=314&hovw=161&tx=80&ty=216&sig=108811856681773622351&page=4&tbnh=155&tbnw=79&ndsp=35&ved=1t:429,r:4,s:100,i:16)

任何帮助深表感谢。提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:10:24.633

您可以轻松地使用[共享首选项](http://developer.android.com/reference/android/content/SharedPreferences.html)来存储用户的详细信息。每次打开首选项屏幕时，都可以从共享首选项中提取存储的数据并呈现给用户进行编辑。一旦编辑完成，新数据可以在共享首选项中更新。

另请查看[此](https://stackoverflow.com/questions/3624280/how-to-use-sharedpreferences-in-android-to-store-fetch-and-edit-values)线程以了解如何完成此操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:10:54.597

`SharedPreferences`对于您想要持久存储的这种少量数据，使用将是完美的。

```
// 'this' is simply your Application Context, so you can access this nearly anywhere
SharedPreferences prefs = this.getSharedPreferences(
  "com.example.app", Context.MODE_PRIVATE); 
```

从首选项中获取：

```
// You can equally use KEY_LAST_NAME to get the last name, etc. They are just key/value pairs
// Note that the 2nd arg is simply the default value if there is no key/value mapping
String firstName = prefs.getString(KEY_FIRST_NAME_CONSTANT, ""); 
```

或保存：

```
Editor editor = prefs.edit();
// firstName being the text they entered in the EditText
editor.putString(KEY_FIRST_NAME_CONSTANT, firstName);
editor.commit(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T15:15:41.023

您可以使用android中的[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)类来实现此类功能。

```
public void onCreate(Bundle object){
             super.onCreate(object);
             // Initialize UI and link xml data to java view objects
              ......
              SharedPreferences myPref = getPreferences(MODE_PRIVATE);
              nameView.setText(myPref.getString("USER_NAME", null));
              passView.setText(myPref.getString("PASSWORD", null));

      }
public void onStop(){
             super.onStop();
             if (isFinishing()) {

             getPreferences(MODE_PRIVATE).edit()
             .putString("USER_NAME", nameView.getText().toString())
             .putString("PASSWORD",  passView.getText().toString())
             .commit()

             }
 } 
```

# java - StatelessSession 比 Session 快吗？

> ID：14415642
> 
> 赞同：0
> 
> 时间：2013-01-19T15:05:16.110
> 
> 标签：java, hibernate

正如我们所知`StatelessSession`，与 Session 不同，它直接处理数据库行。
我的问题是，我们可以使用`StatelessSession`少量插入、更新来提高性能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T15:09:37.287

这在很大程度上取决于您如何使用它。缓存通常是为了提高性能而发明的，但是“正常”休眠会话的问题在于它没有让您选择关闭缓存。我已经多次使用 Spring JDBC 编写数据库访问以防止会话开销，并且性能大大提高。

因此，好的书面应用程序应该使用 StatelessSession 大大提高性能。糟糕的编写应用程序可能会变慢，因为 Hibernate 中的强制缓存被认为是对用户无法控制他们的代码何时以及多少次从 DB 中读取内容的补救措施......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T15:39:46.617

`StatelessSession`不仅仅是关闭缓存的会话；这是一种完全不同的会话，甚至不支持许多操作。因此，如果您有一段代码不会破坏其约束，那么使用无状态会话不会有任何坏处，并且可能有助于使其更快。

我经常使用无状态会话，因为我避免使用 Hibernate 进行持久状态管理，而是使用简单直接的 HQL 查询。然而，当保存新记录时，常规会话是不可避免的：Hibernate 不支持`insert`带有文字数据的语句。

# c++ - 从文件中读取数据

> ID：14415644
> 
> 赞同：0
> 
> 时间：2013-01-19T15:05:28.483
> 
> 标签：c++, visual-c++, mfc

我正在开发一个需要将数据存储在文件中的 MFC 应用程序

我有这样的课

```
class Client
{
public:
    Client(CString Name , CString LastName , CString Id );
    int create();
    int update(Client & myClient);

    CString name;
    CString lastName;
    CString id;
};

Client::Client(CString Name , CString LastName , CString Id )
{
    name = Name;
    lastName=LastName;
    id=Id;
}

void displayMessage(CString message , CString title=L"Meesage")
{
    MessageBox(NULL,message,title,MB_OK | MB_ICONERROR);
}

    int Client::create(Client myClient)
    {
        ofstream output;
        output.open("test.dat" , ios::binary );
        if( output.fail() )
        {
            CString mess;
            mess = strerror( errno );
            displayMessage(mess);
            return 1 ;//anything but 0
        }

        output.write( (char *) &myClient , sizeof(Client));
        output.close();

        return 0;
    }

    int Client::update(Client & myClient)
    //also tried passing by value : int update(Client myClient)
    {
        ifstream input;
        input.open("test.dat" , ios::binary );
        if( input.fail() )
        {
            CString mess;
            mess = strerror( errno );
            displayMessage(mess);
            return 1 ;//anything but 0
        }

        input.read( (char *) &myClient , sizeof(Client));
        input.close();

        return 0;
    } 
```

创建功能效果很好，

但是，关于更新功能我有一些问题

我使用这样的功能：

```
Client myClient();
myClient.update(myClient); 
```

但是当我运行这个函数时我得到了这个错误

```
 Unhandled exception at 0x5adfab2a (mfc100ud.dll) in MyProject.exe: 0xC0000005: Access violation writing location 0x039708fc. 
```

我能做些什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:54:07.587

小心。`Client myClient();` [声明一个](https://stackoverflow.com/questions/1424510/most-vexing-parse-why-doesnt-a-a-work)名为`myClient`. 写入函数的地址会导致一些问题，比如崩溃。只需将其更改为`Client myClient;`（这样您就可以创建一个实际的`Client`对象，然后实际写入一个对象）。当然，我希望写入这样的`Client`对象是安全的（例如，参见 Joachim Pileborg 关于指针的评论）。

例如，看下面的代码：

```
#include <typeinfo>
#include <iostream>

struct S {};

int main()
{
    S s1();
    S s2;
    std::cout << typeid(s1).name() << std::endl;
    std::cout << typeid(s2).name() << std::endl;
} 
```

[结果](http://ideone.com/AbB0XE)（使用 g++）打印出来：

> `F1SvE`
> `1S`

重要的一点是它们不一样！`s1`是一个名为的函数的声明`s1`，它不带参数并返回一个`S`. `s2`是一个实际的`S`对象。这被称为 C++ 的“最令人烦恼的解析”（因为它会导致很多挫败感）。

**编辑：**哦，男孩，您不断用更多（实际）代码更新您的问题，并且不断改变事情。为了将来参考，只需从完整的实际代码开始，这样人们就不必不断改变事情:)

你不能`CString`像那样安全地写 s 。它们在内部存储指针，就像 Joachim Pileborg 提到的那样，在尝试读取它们时会造成严重破坏。

此外，`Client`不再有默认构造函数（因为您已经提供了自己的构造函数）。所以你也不能再说`Client myClient;`了。您必须使用正确的构造函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T04:41:54.537

您不能将 CString 内容存储为二进制数据。您必须使用`fprintf`,`CStdioFile::WriteString`或类似的东西来写入数据。CString 没有固定大小的缓冲区，因此地址是无效的。

我的建议是将学习问题分解为几个部分——实践`CString`、文件 io、类设计和 UI 作为不同的方面。除非您对其他方面感到满意，否则不要将它们全部混合。你不会知道问题出在哪里。

此外，您发布的代码明显错误：`create`方法在类中没有任何参数，但在实现时您有一个参数！

# php - 检索 Facebook 访问令牌不适用于 curl 或 file_get_contents

> ID：14415646
> 
> 赞同：0
> 
> 时间：2013-01-19T15:05:53.973
> 
> 标签：php, facebook, api, curl, file-get-contents

这个问题真的很令人沮丧，因为我可以看到导致它的原因但找不到解决方案。

尝试获取 facebook 访问令牌时，首先获取我的 url：

```
$token_url = "https://graph.facebook.com/oauth/access_token?client_id=".$app_id."&redirect_uri=".urlencode($my_url)."&client_secret=".$app_secret."&code=".$code; 
```

接下来我尝试`url_decode`像这样使用和卷曲：

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_AUTOREFERER, TRUE);
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_URL, $token_url);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, TRUE);       
$response = curl_exec($ch);
curl_close($ch); 
```

使用 curl，响应为空（即使 returntransfer 设置为 true）。

所以接下来我尝试使用 file_get_contents，如下所示：

```
$response = file_get_contents($token_url);
echo $response; 
```

然后这会产生一个错误，表明它没有正确解析 url。

> **Warning** : file_get_contents(https://graph.facebook.com/oauth/access_token?client_id=XXXXXXXX&redirect_uri=http%3A%2F%2Flocalhost%3A8000%2F&client_secret=XXXXXXXXXXXXXXXXXX&code=AQAw8Y3fehv2IWxhmQs9M28IsP4hAzwL5pnvSJkb2v_9H61Gpt659IgMHLgvgRH46tXl8BAL0SRyilKqVay4b4Su68nzT2OmbVK88eNHdGQqIaR_N7X8noIkQTeq_HuEImLlxQwbFcg_PJ5EGh9l392KL2OFqi8qplgOE5m21qlKOvVvUE3cZrcfk_mmr9FUm5eQXIvEp8sUYHxHAXvvyNmV [function.file-get-contents]: failed to open流：HTTP 请求失败！第**65**行**C:\Users\Mark\workspace\Never\aqueous-sands-5942\index.php中的 HTTP/1.0 400 Bad Request**

 **通过删除`"amp;"`网址，您可以通过直接在浏览器中打开网址来查看正确的响应。

如何防止`"amp;"`成为网址的一部分？我在任何地方都看不到任何多余的空格，并且我已经对我的网址进行了编码（http://localhost:8000/）

我究竟做错了什么？

更新：

更大的代码示例：

```
require 'sdk/src/facebook.php';

   $app_id = "123456778";
   $app_secret = "XXXXXXXXXXXXX";
   $my_url = "http://localhost:8000/";

  session_start();

    @$code = $_REQUEST["code"];

    if (!isset($_REQUEST["code"])) {

     $_SESSION['state'] = md5(uniqid(rand(), TRUE)); // CSRF protection
     $dialog_url = "https://www.facebook.com/dialog/oauth?client_id=". $app_id . "&redirect_uri=" . $my_url . "&state=" . $_SESSION['state'] . "&scope=email";

     echo("<script>top.location.href='" . $dialog_url . "'</script>");
    }

 if( $_SESSION['state'] && ( $_SESSION['state'] === $_REQUEST['state'] ) ) {

    $token_url = "https://graph.facebook.com/oauth/access_token?client_id=".$app_id."&redirect_uri=".urlencode($my_url)."&client_secret=".$app_secret."&code=".$code;
    echo "value of token:";
    echo $token_url;

  /* curl section (commenting out) */ /*
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_AUTOREFERER, TRUE);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_URL, $token_url);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, TRUE);       
    $response = curl_exec($ch);
    curl_close($ch); */

    echo "command:"; 
    echo $token_url;
    echo "value:";
    $response = file_get_contents($token_url);
    echo $response;
    $params = null;
    parse_str($response, $params); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-10T20:18:55.900

我有同样的问题和设置

```
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); 
```

工作。

从 cURL 7.10 开始，默认设置为 TRUE。**

# sql - 如何计算使用 SQL 在 stackexchange 上发表评论所需的平均时间？

> ID：14415647
> 
> 赞同：3
> 
> 时间：2013-01-19T15:05:56.520
> 
> 标签：sql, sql-server, tsql

我正在寻找一个计算平均评论时间（每个月测量）的 SQL 查询。

我能够编写一个查询来测量原始帖子日期时间和评论日期时间之间的平均时间，但这仍然不正确，因为应该在当前评论和前一个评论之间测量时间，因为它们大部分时间都是相关的.

```
 select 
  dateadd(month, datediff(month, 0, Comments.creationdate),0) [Date],
  AVG(CAST(DATEDIFF(hour, Posts.CreationDate, Comments.creationdate ) AS BigInt)) [DelayHours]
  from comments
    INNER JOIN posts ON Comments.PostId = Posts.Id
  GROUP BY
    dateadd(month, datediff(month, 0, Comments.creationdate),0)
  ORDER BY Date 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:33:15.053

我认为这样的事情应该有效。抱歉，我目前无法测试；如果我印刷有误，我深表歉意。

```
WITH cte1 AS
(
SELECT c.PostId, c.creationdate, 
ROW_NUMBER() OVER (PARTITION BY c.PostId ORDER BY c.creationdate) AS rn
FROM comments c
)
SELECT dateadd(month, datediff(month, 0, a.creationdate),0) [Date],
AVG(diff_hr) AS avg_diff
FROM 
(
  SELECT a1.PostId, a1.creationdate,
  CASE
   WHEN a1.rn = 1 THEN 
    CAST(DATEDIFF(hour,p.creationdate,a1.creationdate) AS BIGINT) 
   ELSE
    CAST(DATEDIFF(hour,a2.creationdate,a1.creationdate) AS BIGINT) 
  END AS diff_hr
  FROM cte1 a1
  INNER JOIN posts p ON (p.Id = a1.PostId)
  LEFT JOIN cte1 a2 ON (a2.PostId = a1.PostId AND a2.rn = a1.rn-1)
)a
GROUP BY dateadd(month, datediff(month, 0, a.creationdate),0) 
```

**SQLServer 2012的**更新**`LAG`将简化解决方案......我注意到关于版本的评论太晚了。**

 ****更新 2**错误打印已修复（遗漏`FROM`子句并`p.PostId`更改`p.Id`为匹配表定义）**

# javascript - 使用 watch.js 取消监视对象的问题

> ID：14415654
> 
> 赞同：0
> 
> 时间：2013-01-19T15:06:40.507
> 
> 标签：javascript, jquery

我正在尝试在下面的代码中使用[watch.js](https://github.com/melanke/Watch.JS)。这个想法太单次运行 watch.js，所以它检测到布尔变化（vars.in_animation），然后取消观察并退出。但是，发生的情况是代码陷入无限循环，并且每次 vars.in_animation 更改时都会触发 watch 回调，并且 unwatch 代码永远不会运行。

我不知道问题是我使用 watch.js 的方式，还是代码结构中存在其他问题。有任何想法吗？

```
base.goTo = function(targetSlide){
    if (vars.in_animation || !api.options.slideshow) 
    {            
    //arrange for a callback once in_animation is false again
    //only need to detect first change from true to false, and then unwatch
    watch(vars, "in_animation", function() 
        {
        console.log('called back, value of in_animation ' + vars.in_animation);
        unwatch(vars,"in_animation",vars.alert); //never called
        base.goTo2(vars.saved_slide);
        });  

        vars.saved_slide = targetSlide; 
        return false;
     }    
     else { base.goTo2(targetSlide); }               
     } 
```

编辑，只是解决了问题> [http://jsfiddle.net/SZ2Ut/3/](http://jsfiddle.net/SZ2Ut/3/)

```
var obj = {
name: "buddy",
alert: function(){
    alert(obj.phrase + " " + obj.name);
}

}

watch(obj, "name", function(){
alert('name has changed to: ' + obj.name);
});

//should only fire once for this one
obj.name = "johnny";
unwatch(obj, "name", obj.alert);
obj.name = "phil"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:56:52.353

`unwatch`似乎期望应该将其作为第三个参数删除的观察者回调。尝试

```
watch(vars, "in_animation", function callback() {
    console.log('called back, value of in_animation ' + vars.in_animation);
    unwatch(vars,"in_animation", callback);
    base.goTo2(vars.saved_slide);
}); 
```

# c++ - 请提供一点 C++ 帮助（重复输出）

> ID：14415660
> 
> 赞同：2
> 
> 时间：2013-01-19T15:07:32.180
> 
> 标签：c++

所以我有这个代码：

```
#include <iostream>
#include <cstdlib>
using namespace std;

int main()
{

    int x;
    x=rand();
    int guess;
    do{
        cout<<"Enter your guess:";
        cin>>guess;
        if(guess==x)cout<<"You got it ! ;)\n";
        else {
            cout<<"Wrong(";
            if (guess<x) cout<<"too small)\n";
            else cout<<"too big)\n";
        }

    } while (guess != x);

    return 0;
} 
```

问题：编译并运行这个程序后，我输入“999999999999”，它一直重复“太大”。为什么会这样？

附加信息：当我将 x 的值设置为常数 10 并输入 11 时，我注意到它只重复“太大”一次。有什么我不知道的吗？还是代码有缺陷？

非常感谢 ：）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T15:11:17.233

如果查看[数据类型](http://en.cppreference.com/w/cpp/language/types)，您会发现 an`int`最多只能容纳 2,147,483,647 ¹。当您尝试输入的数字大于您的数据类型可以容纳的数字时`std::cout`，它会在下一个循环中再次尝试并处理它，这也会失败，它会将您发送到无限循环中。

您可以通过使用更大的数据类型来解决您的问题。

* * *

¹ - int 的大小取决于您的机器，请查看[http://en.cppreference.com/w/cpp/language/types](http://en.cppreference.com/w/cpp/language/types)以获取 int 可以容纳的范围列表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:22:46.120

您期望此代码始终成功：

```
cin>>guess; 
```

`std::ios_base`从like派生的类型`std::cin`可能会进入错误状态。

`bool`您可以通过在上下文中使用流来开始完全处理这个问题。

```
}while (cin && guess != x); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T15:43:56.723

如果您对到底发生了什么感到好奇，请查看[这个 cplusplus.com 线程](http://www.cplusplus.com/forum/beginner/2957/)，其中有人在从`std::cin`. 第二张海报“int main”很好地总结了它（为 SO 重新格式化了一下）：

> `cin.fail()`检测输入的值是否符合变量中定义的值。但如果`cin.fail()`为真，则意味着：
> 
> *   输入的值不适合变量
> *   变量不会受到影响
> *   内流仍然损坏
> *   输入的值仍在缓冲区中，将用于下`cin >> variable`一条语句。
> 
> 因此，您必须执行以下操作：
> 
> *   通过修复内流`cin.clear()`
> *   清除缓冲区`cin.ignore(std::numeric_limits<int>::max(), '\n')`

我仍然觉得这种行为很奇怪和违反直觉，但至少我们知道现在发生了什么。

**注意：** “变量不会受到影响”的说法是不正确的，至少对于我的系统（g++ 4.6）。该变量实际上设置为最大可能值。这使得将输入的值留在流中更加难以解释......

# java - 如何同时为多个按钮设置动画？

> ID：14415661
> 
> 赞同：1
> 
> 时间：2013-01-19T15:07:45.510
> 
> 标签：java, android, translate-animation

我正在尝试同时在多个 ImageViews(Buttons) 上进行翻译动画。然而，每个 ImageView 的 TranslateAnimations 会有所不同，因此我将它们放在 AnimationSet 中。问题是，不知何故，动画甚至从未运行过……我不知道为什么。这是我的代码：

```
ArrayList<TranslateAnimation> animlist = new ArrayList<TranslateAnimation>();
AnimationSet set = new AnimationSet(true);

//The following for-loop is actually running inside two other for loops... I'm        skimming it down a little for you guys
for(int i = ROWS-1; i > row;i--){
    if(!usedFields[column][i]){
        ImageView iv = (ImageView)GameLayout.findViewWithTag(""+row+","+column);
        TranslateAnimation transanim = new TranslateAnimation(0,0,-(i-row)*letterHeight,0);
        transanim.setDuration(1000);
        iv.setAnimation(transanim);
        animlist.add(transanim);
        break;
    }
}

for (TranslateAnimation anim : animlist){
    set.addAnimation(anim);         
}

set.startNow(); 
```

谢谢你，我很感激！

# jquery - 当我单击每个按钮时，它会向我显示第一个按钮的相同内容

> ID：14415662
> 
> 赞同：0
> 
> 时间：2013-01-19T15:07:49.247
> 
> 标签：jquery, html, css, button, fancybox

我正在使用一个花哨的盒子来显示一些内容。我设法在我的页面上放置了更多按钮。但它不起作用。例如，当我单击按钮 2 和 3 时，我得到的内容与按钮 1 中的内容相同。如何解决这个问题，以便当我单击按钮 2 和 3 时，我得到正确的内容。

[内容框](http://postimage.org/image/vzdg13sgd/)

[按钮链接](http://postimage.org/image/3w7gjgoxv/)

HTML 代码：

```
 <body>
        <!-- button -->
        <div class="button">
            <p><a href="#bubble" id="pop">CONTENT1</a></p>
        </div>

        <!-- popup -->
        <a href="#x" class="overlay" id="bubble"></a>
        <div class="popup">
            <h2>CONTENT1</h2>
                <p>CONTENT.</p>
                <!-- close -->
                <a class="close" href="#close"></a>
        </div> 
```

CSS：代码

```
header p {padding-top:50px;text-align:center;}
.button a#pop {
    text-align:center;
    position:absolute;
    top:30%;
    left:45%;

    background-color:#444;
    border :0px solid #ddd;
    color: #fff;
    display: block;
    float: right;
    margin-right: 10px;
    padding: 1px 5px;
    font-size:12px;
    text-decoration: none;
    text-shadow: 1px 1px #000;

    -webkit-border-radius: 10px;
    -moz-border-radius: 10px;
    -ms-border-radius: 10px;
    -o-border-radius: 10px;
    border-radius: 10px;
}
a#pop:hover {
    border-color: #eee;
}
.overlay {
    background-color: rgba(0, 0, 0, 0.6);
    bottom: 0;
    cursor: default;
    left: 0;
    opacity: 0;
    position: fixed;
    right: 0;
    top: 0;
    visibility: hidden;
    z-index: 1;

    -webkit-transition: opacity .5s;
    -moz-transition: opacity .5s;
    -ms-transition: opacity .5s;
    -o-transition: opacity .5s;
    transition: opacity .5s;
}
.overlay:target {
    visibility: visible;
    opacity: 1;
}
.popup {
    background-color: #fff;
    border: 3px solid #fff;
    display: inline-block;
    left: 50%;
    opacity: 0;
    padding: 15px;
    position: fixed;
    text-align: justify;
    top: 40%;
    visibility: hidden;
    z-index: 10;

    -webkit-transform: translate(-50%, -50%);
    -moz-transform: translate(-50%, -50%);
    -ms-transform: translate(-50%, -50%);
    -o-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);

    -webkit-border-radius: 15px;
    -moz-border-radius: 15px;
    -ms-border-radius: 15px;
    -o-border-radius: 15px;
    border-radius: 15px;

    -webkit-transition: opacity .5s, top .5s;
    -moz-transition: opacity .5s, top .5s;
    -ms-transition: opacity .5s, top .5s;
    -o-transition: opacity .5s, top .5s;
    transition: opacity .5s, top .5s;
}
.overlay:target+.popup1 {
    top: 50%;
    opacity: 1;
    visibility: visible;
}
.close {
    background-color: #fff;
    height: 30px;
    line-height: 30px;
    position: absolute;
    right: 0;
    text-align: center;
    text-decoration: none;
    top: -15px;
    right:-10px;
    width: 30px;

    -webkit-border-radius: 15px;
    -moz-border-radius: 15px;
    -ms-border-radius: 15px;
    -o-border-radius: 15px;
    border-radius: 15px;
}
.close:before {
    color: rgba(0, 0, 0, 0.8);
    content: "X";
    font-size: 24px;
    text-shadow: 0 -1px rgba(0, 0, 0, 0.9);
}
.close:hover {
    background-color: #ddd;
}
.popup1 p {
    margin-bottom: 10px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T19:27:23.827

我对您的代码进行了以下更改并设法解决了您的问题。

这就是我所做的；从**.button a#pop**
中 删除`top:30%; left:45%;`

 **然后将位置从绝对更改为相对`position:relative;`

并添加另一个按钮。

```
<div class="button" >
        <p><a href="#bubble2" id="pop">Content2</a></p>
    </div>

    <!-- popup -->
    <a href="#x" class="overlay" id="bubble2"></a>
    <div class="popup">
        <h2>Content2</h2>
            <p>Content</p>
            <!-- close -->
            <a class="close" href="#close"></a>
    </div> 
```

注意：**href="#bubble2"**和**id="bubble2"**已更改。

这工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T15:44:10.600

我认为您的第一个按钮**link1 的** `<a>`标签区域与其他按钮重叠。这就是为什么您在单击按钮 2 和 3 时获得相同内容的原因。向 `.button a#pop`css 添加与按钮高度相似的固定高度，以便`<a>` 仅覆盖第一个按钮。**

# java - 用于捕获流关闭的 Aspectj 切入点（尝试测量通过套接字发送/接收的字节）

> ID：14415664
> 
> 赞同：0
> 
> 时间：2013-01-19T15:07:54.183
> 
> 标签：java, sockets, aspectj

我正在尝试制作一个基本方面（主要是作为概念验证），我可以使用它来跟踪通过套接字完成的 IO。

以下代码使用基于 Commons-IO 的 CountingInputStream 包装从套接字获取输入流的任何调用。那部分有效。

什么不起作用（我怀疑这是因为我对切入点定义进行了修改）是从 CountingInputStream 中获取字节数。

关闭/重置建议永远不会被击中。（在将其切换到 @Around 之前，我将其作为 @Before 建议 - 但这也不起作用......）

（一旦我得到了基本的东西，我确实计划清理它一点）

```
package com.foo.io;

import com.yammer.metrics.Metrics;
import com.yammer.metrics.core.Counter;
import com.yammer.metrics.core.Histogram;
import com.yammer.metrics.core.MetricName;
import com.yammer.metrics.core.MetricsRegistry;
import org.apache.commons.io.input.CountingInputStream;
import org.apache.commons.io.output.CountingOutputStream;
import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.*;

import java.io.*;
import java.net.Socket;

@Aspect
public class SocketStreamWrapper {
    // can trivially create a map keeping track of bytes sent to / from a given address if this is desired
    final Counter inboundByteCounter;
    final Histogram inboundByteHistogram;
    final Counter outboundByteCounter;
    final Histogram outboundByteHistogram;

    public SocketStreamWrapper() {
        inboundByteCounter = Metrics.defaultRegistry().newCounter(new MetricName("inbound", "bytes", "counted"));
        inboundByteHistogram = Metrics.defaultRegistry().newHistogram(new MetricName("inbound", "bytes", "histogram"), true);
        outboundByteCounter = Metrics.defaultRegistry().newCounter(new MetricName("outbound", "bytes", "counted"));
        outboundByteHistogram = Metrics.defaultRegistry().newHistogram(new MetricName("outbound", "bytes", "histogram"), true);
    }

    @Pointcut("call(* java.net.Socket.getInputStream()) && target(s)")
    void input(Socket s) {
    }

    @Pointcut("call(* CountingInputStream.close()) && this(cis)")
    void close(CountingInputStream cis) {
    }

    @Pointcut("call(* CountingInputStream.reset()) && this(cis)")
    void reset(CountingInputStream cis) {
    }

    @Pointcut("call(* CountingInputStream+.read*()) && this(cis)")
    void read(CountingInputStream cis) {

    }

    @Around("close(cis)")
    public void closeCountingStream(ProceedingJoinPoint jp, CountingInputStream cis) throws Throwable {
        inboundByteCounter.inc(cis.getByteCount());
        inboundByteHistogram.update(cis.getByteCount());
        cis.resetByteCount();
        jp.proceed();
    }

    @Around("input(s)")
    public Object wrapInputStream(ProceedingJoinPoint joinPoint,
                                  Socket s)
            throws Throwable {
        InputStream in = (InputStream) joinPoint.proceed();
        return new CountingInputStream(in);
    }

    @Pointcut("call(* java.net.Socket.getOutputStream()) && target(s)")
    void output(Socket s) {
    }

    @Around("output(s)")
    public Object wrapOutputStream(ProceedingJoinPoint joinPoint,
                                   Socket s)
            throws Throwable {
        OutputStream out = (OutputStream) joinPoint.proceed();
        return new CountingOutputStream(out);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-28T17:25:49.230

您需要使用*target*而不是*this*的原因是*target*条件表明切入点适用于调用方法的对象，而不是方法的调用者。在这种情况下，您的*close*、*reset*和*read*切入点所针对的对象是 CountingInputStream。

两者之间的区别在：http: [//www.eclipse.org/aspectj/doc/next/progguide/semantics-pointcuts.html](http://www.eclipse.org/aspectj/doc/next/progguide/semantics-pointcuts.html)

另外一点，您可能希望拥有一个具有私有或受保护范围的 CountingInputStream 子类，以便您可以直接定位它并避免使用 CountingInputStreams 意外地与其他人交互。您的*closeCountingStream*实现调用*了 resetByteCount()*，这会导致其他用例的混乱和延迟。

# c# - 如何在不重复项目名称的情况下呈现具有多个部件的项目视图？

> ID：14415668
> 
> 赞同：0
> 
> 时间：2013-01-19T15:08:55.047
> 
> 标签：c#, wpf, linq

这是我现在的数据集：

```
List <Orders> myOrders;

itemName    itemQuantity    partName    unitQuantity    totalQuantity
A           2               X           0.5             1
A           2               Y           2               4
A           2               Z           7               14 
```

总结一下：

*   有一个名为 A (itemName) 的项目的订单为 2 (itemQuantity)

*   这个项目有 3 个部分：X、Y、Z（partNames）和他们自己的数量（这就是为什么每个项目 A 会有 3 行，一个用于该项目的每个部分）

*   totalQuantity 是 unitQuantity*itemQuantity（例如，对于 2 个项目 A，我们需要多少 X 类型的部分）

所有数据都在那里，但这让客户感到困惑，因为他们看到 3 行“项目 A”，相反我需要向客户展示（使用 WPF 在屏幕上可视化）以下内容：

```
itemName    itemQuantity    partName    unitQuantity    totalQuantity
A           2               X           0.5             1
                            Y           2               4
                            Z           7               14 
```

请注意，数据没有更改，但现在我们不会为每个零件重复 itemName 或 itemQuantity，看起来零件列表属于那个 itemName (A)。从本质上讲，它在视觉上更清晰，因此阅读它的人不会感到困惑（因为它似乎都是组合在一起的）。

相同的数据，不同的格式，我不知道如何“转换”我的数据或在我的 XAML (WPF) 中做一些魔术，以使其在屏幕上以这种方式呈现给客户。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:35:51.877

您打算绑定哪种类型的目标控件？您无需尝试 XAML，而是简化编写自定义类来实现对其进行排序。简单地说，在自定义类中传递您的 IList 并将重复值消除为空值并绑定到目标控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-26T17:16:34.457

我看到你已经得到了[关于使用 TreeView](https://stackoverflow.com/a/14423802/200449)和[其他变体的各种答案](https://stackoverflow.com/questions/14429302/datagrid-within-a-datagrid-having-one-of-the-columns-of-a-datagrid-as-a-datagri)

我相信您可能有兴趣考虑 Master-Detail DataBinding：

*   [24.129.21.主从绑定](http://www.java2s.com/Tutorial/CSharp/0470__Windows-Presentation-Foundation/MasterDetailBinding.htm)
*   [24.130.1\. 使用主从模式绑定到集合](http://www.java2s.com/Tutorial/CSharp/0470__Windows-Presentation-Foundation/BindtoaCollectionwiththeMasterDetailPattern.htm)

以下是第一个参考的屏幕截图：

![选择亚当斯公司](../Images/98c4bdcd0fb5d76babd93125d4233084.png)

图。1。选择的亚当斯公司

![选择走狗公司](../Images/69fa31c3cc2ecb64f69c71f5c25152d7.png)

图 2。选择的斯托格公司

或者，如果要删除其中一家公司：

![在此处输入图像描述](../Images/d7e0d9f5d4e1fff9ef29c75ff39fa4f7.png)

# java - 更改 LinkedHashMapValues

> ID：14415669
> 
> 赞同：2
> 
> 时间：2013-01-19T15:09:29.933
> 
> 标签：java, linkedhashmap, setvalue

以下是来自 2 个linkedHashMaps 的数据：

```
valueMap:   { y=9.0, c=2.0, m=3.0, x=2.0}
formulaMap: { y=null, ==null, m=null, *=null, x=null, +=null, c=null, -=null, (=null, )=null, /=null} 
```

我想要做的是将第一张地图中的值输入到第二张地图中的相应位置。两个映射都以**String,Double**作为参数。

到目前为止，这是我的尝试：

```
for(Map.Entry<String,Double> entryNumber: valueMap.entrySet()){
   double doubleOfValueMap = entryNumber.getValue();
   for(String StringFromValueMap: strArray){
      for(Map.Entry<String,Double> entryFormula: formulaMap.entrySet()){          
         String StringFromFormulaMap = entryFormula.toString();
         if(StringFromFormulaMap.contains(StringFromValueMap)){
           entryFormula.setValue(doubleOfValueMap);
         }
      }
   }
} 
```

这样做的问题是它会将所有值（即 y、m、x、c）设置为最后一个 double 的值。遍历这些值也不起作用，因为这些值的顺序通常与公式映射中的顺序不同。理想情况下我需要说的是**如果formulaMap中的字符串与valueMap中的字符串相同，请将formulaMap中的值设置为与valueMap中相同的值。**

如果您对我能做什么有任何想法，请告诉我？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T15:13:07.330

这很简单：

```
formulaMap.putAll(valueMap); 
```

如果您的值映射包含未包含在中的键`formulaMap`，并且您不想更改原始值，请执行以下操作：

```
final Map<String, Double> map = new LinkedHashMap<String, Double>(valueMap);
map.keySet().retainAll(formulaMap.keySet());
formulaMap.putAll(map); 
```

**由于评论而编辑**看来问题根本不是我想的那样，所以这里是：

```
// The result map
for (final String key: formulaMap.keySet()) {
    map.put(formulaMap.get(key), valueMap.get(key));

// Either return the new map, or do:
valueMap.clear();
valueMap.putAll(map); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:13:14.377

```
for(Map.Entry<String,Double> valueFormula: valueMap.entrySet()){          
  formulaMap.put(valueFormula.getKey(), valueFormula.value());
} 
```

# r - 使用 R 对李克特图中的组重新排序

> ID：14415674
> 
> 赞同：6
> 
> 时间：2013-01-19T15:10:28.127
> 
> 标签：r, ggplot2

我正在使用[该`jbryer/likert`包](https://github.com/jbryer/likert)来绘制李克特数据。

考虑响应表，称为`items`— 此处，`A`、`B`等是列名，而不是数据的一部分：

```
A B C D
5 4 5 4
3 3 3 4
2 2 2 2
2 2 2 3
5 3 6 7
3 3 5 4 
```

以及以下代码：

```
choices  = c("Very low", "Low", "Rather low", "Neither low nor high", "Rather high", "High", "Very high")
for(i in 1:ncol(items)) {
  items[,i] = factor(items[,i], levels=1:7, labels=choices, ordered=TRUE)
} 
```

现在，我们将其转换为`likert`数据并绘制它，它使用以下函数覆盖内置的绘图函数`ggplot`：

```
plot(likert(items), ordered=FALSE) 
```

这给了我：

![](../Images/763c0ec8e306e54fd0cbf37f025e3207.png)

凉爽的。都订好了。但是`A`,`B`等作为条件的描述符没有意义，我想覆盖它们：

```
names(items) = c("LT", "ST", "SemTag", "SemTagContext") 
```

这给了我错误的顺序：

![](../Images/77a48bcebc41482d6b81ca55d7a052c0.png)

看看怎么`ST`来的，虽然它的名字是`B`? 我的订单更改为`B`, `D`, `C`, `A`。

我怎样才能使它保留顺序并返回 , , , 中的条形`D`，`C`或者`B`使用`A`我的新组名：`SemTagContext`, `SemTag`, `ST`, `LT`？

[注：以上数据表有所删减。图中的条形宽度不反映这个简短的数据示例，而是我拥有的完整数据集。问题是一样的。]

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T15:50:32.897

正如乔恩建议的那样，我决定自己重新实现这一点：

```
# additional requirements
library(ggplot2)
library(reshape2)
library(RColorBrewer)

# create summary table
table_summary = likert(items)

# reshape results
results = melt(table_summary$results, id.vars='Item')

# reorder results
results$Item = factor(results$Item, levels=c("LT", "ST", "SemTag", "SemTagContext"))

# some defaults
ymin = 0
text.size = 3

ggplot(results, aes(y=value, x=Item, group=Item)) + 
  geom_bar(stat='identity', aes(fill=variable)) + 
  ylim(c(-5,105)) + 
  coord_flip() +
  scale_fill_manual('Response', values=brewer.pal(7, "RdYlGn"), 
              breaks=levels(results$variable), 
              labels=levels(results$variable)) +
  geom_text(data=table_summary$summary, y=ymin, aes(x=Item, 
              label=paste(round(low), '%', sep='')), 
              size=text.size, hjust=1) +
  geom_text(data=table_summary$summary, y=100, aes(x=Item,
              label=paste(round(high), '%', sep='')), 
              size=text.size, hjust=-.2) +
  ylab('Percentage') + xlab('') 
```

这会产生正确的顺序：

![](../Images/fb75887ff98bc425182153a4f7dccdf0.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-08-17T15:19:13.680

您可以使用 group.order 参数来指定顺序。使用 names() 函数获取列的名称。

```
plot(likert_var, group.order=names(results)) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-02T22:01:20.170

我向 Jason Bryer 的包添加了一个拉取请求，该请求将全名属性添加到列中，然后在您绘图时使用这些属性。详细的文章在这里[http://reganmian.net/blog/2013/10/02/likert-graphs-in-r-embedding-metadata-for-easier-plotting/](http://reganmian.net/blog/2013/10/02/likert-graphs-in-r-embedding-metadata-for-easier-plotting/)

鉴于这一点，你可以做

```
db <- likert_add_fullnames(db, c(
  "X7"="Do you use sites like Facebook, Twitter, or GPlus?",
  "X8"="Do you participate in online communities organised around your interests? 
    (could be juggling, cooking, sports or academics, for example)?",
  "X10"="Do you know of online communities relevant to your discipline or the 
    courses you are taking now?"))
... 
```

然后这些名称将在您绘制时反映出来。

# java - 通过 JNI（Android NDK）将对象（DisplayMetrics）从 C 传递到 Java

> ID：14415684
> 
> 赞同：0
> 
> 时间：2013-01-19T15:11:44.677
> 
> 标签：java, android, c, android-ndk, java-native-interface

我正在尝试使用 NDK 在 NativeActivity 应用程序中获取[Android DisplayMetrics类。](https://developer.android.com/reference/android/util/DisplayMetrics.html)我试图调用的函数是这些行中的函数：

```
DisplayMetrics metrics = new DisplayMetrics();
WindowManager wm = this.getWindowManager();
Display display = wm.getDefaultDisplay();
display.getMetrics(metrics); 
```

到目前为止，我已经完成了对象设置和方法调用，如下所示

```
JNIEnv *jni; 
state->activity->vm->AttachCurrentThread(&jni, NULL);
jclass activityClass = jni->FindClass("android/app/NativeActivity");
jclass windowManagerClass = jni->FindClass("android/view/WindowManager");
jclass displayClass = jni->FindClass("android/view/Display");
jclass displayMetricsClass = jni->FindClass("android/util/DisplayMetrics");

jmethodID getWindowManager = jni->GetMethodID(activityClass, "getWindowManager", "()Landroid/view/WindowManager;");
jmethodID getDefaultDisplay = jni->GetMethodID(windowManagerClass, "getDefaultDisplay", "()Landroid/view/Display;");
jmethodID getMetrics = jni->GetMethodID(displayClass, "getMetrics", "(android/util/DisplayMetrics)L;");
jmethodID newDisplayMetrics = jni->GetMethodID(displayMetricsClass, "DisplayMetrics", "()Landroid/util/DisplayMetrics;");

jobject metrics = jni->CallObjectMethod(displayMetricsClass, newDisplayMetrics);
jobject windowManager = jni->CallObjectMethod(state->activity->clazz, getWindowManager);
jobject display = jni->CallObjectMethod(windowManager, getDefaultDisplay); 
```

但是，现在我不知道如何通过引用将指标 jobject 传递给 display.getmetrics() 函数，以便让操作系统对其进行调整并正确填写，以便我可以读取其中的字段

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T21:40:36.753

```
jmethodID getMetrics = jni->GetMethodID(displayClass, "getMetrics", "(Landroid/util/DisplayMetrics;)V");
jni->CallVoidMethod(display, getMetrics, metrics); 
```

# php - .htaccess - 隐藏 php 获取变量

> ID：14415685
> 
> 赞同：-3
> 
> 时间：2013-01-19T15:11:47.283
> 
> 标签：php, .htaccess, url-rewriting, get

我有一个网页，我想重写 URL。然而，在谷歌和这里搜索了大约 1 小时后，我找不到任何对我来说制作的东西，因此，它不起作用。

当前网站：www.example.com/page1/page2?var=1

我希望将其更改为 www.example.com/page1/page2/1

任何帮助将不胜感激！

谢谢，

ZG

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:15:16.110

URI 中是否总是有两个组件？如果是这样，请创建一个`.htaccess`像这样的文件：

```
RewriteModule On
RewriteRule ^(.*)/(.*)/(.*)$ /$1/$2?var=$3 
```

# sql - 对键在列表中的行的读取提交（读取是原子的吗？）

> ID：14415686
> 
> 赞同：0
> 
> 时间：2013-01-19T15:12:08.107
> 
> 标签：sql, transaction-isolation

我碰巧正在使用innodb，已提交读。

我的简单问题是与交易相关的：

我有一个表（TreeNodeId），其中包含一组 4 个不同的节点键，它们代表我系统中与网页的可用路径相关的所有现存节点。每个键代表数据库中的一个项目，表中的每一行代表使用项目的各种组合。

在事务开始时，根据正在更改的项目，我对 TreeNodeId 中反映我的一个或两个项目的一些现存组合的所有行进行单个查询。

即使获取 10,000 行，这个单一查询是否会在内部保持一致？db 查询集是否有可能获取前 100 行，然后其他一些同时事务提交新的或删除的行，这会导致剩余结果不一致？

安迪

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T16:15:20.463

如果您将隔离级别读取为“已提交”，它将仅返回事务日志已“提交”的结果。因此，如果您在该时间点启动处于“已提交”隔离级别的查询，则 sql 事务日志只会为您提供已发布到其日志的已提交事务。如果在选择过程中有人发布记录，他们将在那个时间点被视为“未提交”，直到他们结束操作并被“提交”。但是，即使您将级别更改为“未提交”，您也不应该获得处于中间流中的数据，您应该根据事务日志在开始操作时获得引擎可用的内容。

已提交与未提交将在选择时根据您的选择在系统中获取记录。因此，如果我说 3,000,000 条记录和 200,000 条记录插入，但他们一次提交一个，只有 100,000 条已提交，100,000 条知道日志中的操作但尚未提交。

已提交将给我 3,100,000，而未提交将给我 3,200,000。但是有一些思想流派，我昨天刚刚与某人讨论过这个......未提交会给您未提交的结果，并且被称为“脏读”，因为您正在阅读尚未设置的日志（您反叛）。您是在说“嘿，数据库，我不在乎您收到的已最终确定的内容，我现在就想要。” 当您说已提交时，您是在说：“数据库我只想要合格的数据，如果某些事情没有最终确定，我不想要它。”

各有优势：

1.  未提交的你不会锁定任何东西。你基本上是在对系统说：“不要锁定任何东西，让我通过系统自由地获取那里的东西，我不在乎你是否改变了一些东西。我想要它在操作的那一刻。” 如果在您执行此操作时尝试插入或更新某些内容，它将不会锁定它。

2.  已提交不会锁定任何内容，除非您的操作完成之前正在提交的内容。您可以安全地知道返回的数据已完成，但您会冒着阻止尝试插入或发布事务的风险。您实际上是在告诉数据库：“等待我完成，然后再继续对我正在访问的表进行提交。我需要准确的数据，所以在我完成之前放手”。这可能会在对您从中收集的表执行读取时锁定数据。这并不常见，因为大多数选择几乎是即时的，但在基于每秒发布数千条记录的事务性大型系统上，这是一个大问题。

老实说，在我的讨论中，我赞成不承诺，而另一个人赞成承诺。我认为获取脏数据比停止生产插入更容易接受。他们认为幻读和其他情况更糟。这是一种观点，SQL 系统是围绕插入和选择设计的，但很少有你能在不影响另一个的情况下非常快地完成这两个操作。如果您想要准确的报告，我的回答是进行夜间备份、SSIS 包、二进制集合或类似隔离级别的东西，例如快照或提交，并将该数据放在某处。让该数据以我们知道它已完成并已锁定的方式设置，因此以后可能不会更改并报告它。不要报告生产数据的热点，并强调告诉每个人都这样做。

如果您是一家只有 5 或 10 人使用数据库的小型夫妻店，会不会很痛苦，可能不会。如果您稍微大一点并且有 50 个人访问同一个数据库，但它是大约 100 个演出和半事务性的，因为您在白天会获得涓涓细流的数据，这会不会很痛苦。仍然可能没有。如果你有 200 个人、多个服务器和数据库以及一个存储所有数据组合的主要事务数据库大脑，会不会很痛苦。绝对，如果主要目的是获取要存储的数据，请不要从操作密集的主生产数据库中读取。

编辑从现实世界的例子进一步指出：

这就是为什么通常在我不使用表变量的大多数操作的顶部（声明@Table table）我设置这个：“设置事务隔离级别读取未提交”。每次查询时我都会强烈使用它吗？大声笑，我希望不会。事实上，从这一点开始，完全披露它可能永远不会帮助我，因为我使用临时表将我的数据隔离了很多，以进行大量事务报告。但是我不会被其他人大喊大叫，因为我有一个长期运行的事务阻止他们的插入。您还会看到很多人这样做：“select * from table (nolock)” 我通常将这样的代码提供给较小的查询设计人员，因为它在查询中嵌入了 nolock 提示。如果我告诉每个人都这样做，他们就会制定政策。

您不必这样做，事实上有些人可能会关注我并声称这是错误的并发布他们的立场。我这样做主要是为了生产保护，如果有人告诉我这是错误的，我想听听他们为什么喜欢在生产中锁定表并报告它们，而不是首先实时获取或更新他们的数据。我很难去找经理说：“你知道那个巨大的帐户，你正在等待发布 200 万条记录，并且知道它完成的实例。嗯，大厅里的约翰真的很想运行这个需要运行一个小时，因为它的设计草率。他选择使用已提交，并且正在访问一些执行插入操作的表，因此我们偶尔会遇到锁定问题。嗯，我认为他得到他的报告比我们得到业务更重要。

# java - 当我将安卓驱动器连接到 PC 时识别它

> ID：14415688
> 
> 赞同：2
> 
> 时间：2013-01-19T15:12:13.210
> 
> 标签：java, android, mtp

我想将 xml 文件复制粘贴到我的 android sdcard 中的目录中（稍后将由 android 应用程序导入）。

我想知道是否有更简单的解决方案可以识别像 C:D: 这样的 android 驱动器。

当我连接我的 android 设备时，它被识别为“Nexus 7”，在里面我们找到了“Mémoire de stockage interne”，我们可以在其中找到 sdcard 文件夹。

我想问是否有识别android MTP模式并仅返回android驱动器的API或解决方案。

谢谢

# c# - 如何安装第三方应用程序

> ID：14415697
> 
> 赞同：0
> 
> 时间：2013-01-19T15:13:04.870
> 
> 标签：c#

我想知道是否有办法处理 c# 以安装第三方应用程序（在这种情况下为 mysql server 5.0）。我不是在谈论 Visual Studio 安装程序项目，而是一个可用于以编程方式处理第三方安装程序的 winForm 应用程序。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:18:23.413

我已经习惯**[`System.Diagnostics.Process`](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start%28v=vs.100%29.aspx)**了。它可以执行给定路径上的文件，例如 MySQL 服务器安装程序。但是，您需要提供可执行文件。

# r - RStudio *检查包依赖关系...错误

> ID：14415700
> 
> 赞同：0
> 
> 时间：2013-01-19T15:13:11.727
> 
> 标签：r, dependencies, package, rstudio

这已经困扰我一段时间了，我无法提出其他相关的建议来解决我的问题。是的，我已经仔细阅读了网络寻求帮助。

问题陈述：我已经编写了一个包含第一次构建的所有基本要求的包。但是，我有两个似乎无法加载的依赖项（来自其他包的函数）。

```
==> Rcmd.exe build mypackage 
```

[...]

```
* using log directory 'mydirectory/mypackage.Rcheck'
* using R version 2.15.2 (2012-10-26)
* using platform: x86_64-w64-mingw32 (64-bit)
* using session charset: ISO8859-1
* checking for file 'mypackagel/DESCRIPTION' ... OK
* checking extension type ... Package
* this is package 'mypackage' version '0.01'
* checking package namespace information ... OK
* checking package dependencies ... ERROR
 Package required but not available: 'otherpackage'

Exited with status 1. 
```

现在我正在使用 RStudio 进行包构建。但是，似乎我无法让它找到“其他包裹”。在 Windows/RStudio 下哪里设置？

任何人都可以快速提示，好吗？

# android - setWidth() 按钮 Android

> ID：14415705
> 
> 赞同：3
> 
> 时间：2013-01-19T15:13:48.077
> 
> 标签：android, button, view, size, width

我创建了一个放置在 RelativeLayout 中的 Button，我想设置它的大小。但我只能设置比原来更大的尺寸，例如我可以将其调整为 200dp 但不能调整为 20dp。

有解决办法吗？

这是我的代码

```
Button b = new Button(getApplicationContext());
myLayout.addView(b);
b.setWidth(200); // Work
b.setWidth(20); // Don't work 
```

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T15:28:31.047

这是因为默认情况下`Button`最小宽度为`64dip`。`0`在设置宽度之前将其设置为。

```
b.setMinimumWidth(0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-08T09:12:03.190

您可以通过在 UI 设计右侧的 xml. 设计面板的属性窗口中给定值来设置按钮的宽度。您可以使用小按钮而不是按钮使其成为 20dpi。

# javascript - 简单的 Ember 控制器没有输出

> ID：14415706
> 
> 赞同：0
> 
> 时间：2013-01-19T15:14:01.493
> 
> 标签：javascript, ember.js

我开始使用 Ember，虽然我对函数式编程、JS 和 Ember 也很陌生。我遵循了一些教程，并决定尝试在视图中显示控制器中的一个变量。如果我理解错误，请纠正我，但视图作为控制器的上下文，并在车把模板语言中呈现。上面的代码运行没有任何问题，只是没有显示名称，只是来自 loginState 模板的纯文本。

```
//app.js
App = Ember.Application.create();

App.ApplicationView = Ember.View.extend({
  templateName: 'application'
});

App.ApplicationController = Ember.Controller.extend();

App.LoginStateView = Ember.View.extend({
  templateName: 'loginState'
});

App.LoginStateController = Ember.Controller.extend({
   name: 'Juriy'
});

App.Router = Ember.Router.extend({
   root: Ember.Route.extend({
   index: Ember.Route.extend({
     route: '/',
     connectOutlets: function(router){
     router.get('applicationController').connectOutlet('loginState');
     }
   })
 })
}); 
```

和

```
//index.html
<body>

<script type="text/x-handlebars" data-templamte-name="application">
          My login page.
          {{outlet}}
    </script>

    <script type="text/x-handlebars" data-templamte-name="loginState">
          The name in the login state is {{name}}
    </script>

</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:17:51.177

TLDR：这是因为一个错字。替换`data-templamte-name`为`data-template-name`您的两个模板，事情应该可以工作。

* * *

为了调试这个问题，我在每个模板的顶部附近添加了以下内容：

```
 <pre>The context for application is: {{this}}</pre>  
  <pre>The context for loginState is: {{this}}</pre> 
```

通过此添加，我得到以下输出：

```
The context for loginState is: <App.ApplicationController:ember194>
The name in the login state is 
```

所以应用程序模板正在渲染，loginState 正在应用程序控制器的上下文中渲染。就好像模板没有正确命名一样......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:19:05.537

看起来您的模板定义中有一些拼写错误：

数据模板名称 => 数据模板名称

# java - 片段中的 CirclePageIndicator

> ID：14415712
> 
> 赞同：0
> 
> 时间：2013-01-19T15:14:48.247
> 
> 标签：java, android, eclipse

我目前正在开发一个 android 应用程序。当我初始化一个 UI 元素并在 Fragment 中的 OnPageScrolled 内设置 UI 元素的内容时，它不仅在 Fragment 中起作用，而且在活动类中起作用。这是代码：

```
circleIndicator.setOnPageChangeListener(new OnPageChangeListener(){

                @Override
                public void onPageScrollStateChanged(int arg0) {
                    // TODO Auto-generated method stub

                }

                @Override
                public void onPageScrolled(int arg0, float arg1, int arg2) {
                    // TODO Auto-generated method stub
                    switch(arg0){
                    case 0:{

                        WorkoutDetailsFragment.this.txtNote = (EditText) getSherlockActivity().findViewById(R.id.editTextNote);
                        WorkoutDetailsFragment.this.txtNote.setText("hello");
                        WorkoutDetailsFragment.this.lstViewList1 = (ListView) getSherlockActivity().findViewById(R.id.lstViewlist1);
                        WorkoutDetailsFragment.this.lstViewList2 = (ListView) getSherlockActivity().findViewById(R.id.lstViewlist2);
                        p2 = new ArrayList<ArrayList<String>>();
                        arrayList2 = new ArrayList<String>();
                        arrayList2.add(getString(R.string.Recovery_rate));
                        arrayList2.add("");
                        p2.add(arrayList2);

                        adapter1 = new ListViewAdapterwithoutArrowHorizontal(getSherlockActivity(),
                                android.R.layout.simple_list_item_1, p2);

                        p2 = new ArrayList<ArrayList<String>>();
                        arrayList2 = new ArrayList<String>();
                        arrayList2.add(getString(R.string.Diet_Points));
                        arrayList2.add("");
                        p2.add(arrayList2);

                        adapter2 = new ListViewAdapterwithoutArrowHorizontal(getSherlockActivity(),
                                android.R.layout.simple_list_item_1, p2);
                        WorkoutDetailsFragment.this.lstViewList1.setAdapter(adapter1);

                        WorkoutDetailsFragment.this.lstViewList2.setAdapter(adapter2);
                        //LoadWorkoutResult();
                        //LoadWorkoutDetails();
                        if (adapter2.getItem(1).get(0).equals(getString(R.string.Diet_Points))
                                && extras != null) {
                            adapter2.getItem(1).remove(1);
                            adapter2.getItem(1).add(
                                    extras.getInt(getString(R.string.dietpoints)) + "");
                        }
                        Toast.makeText(getActivity(), "testing..........", Toast.LENGTH_LONG).show();
                        break;
                    }
                    case 1:{
                        //mapview = (MapView) findViewById(R.id.mapview);
                        //  break;
                    }
                    case 2:{

                        //multitouchplot = (MultitouchPlot) findViewById(R.id.multitouchPlot);
                        //series = new SimpleXYSeries();
                        //splitchart = new SplitChart(series, multitouchplot, isMile);
                        //LoadSplitChart();
                        //break;
                    }

                    }
                }

                @Override
                public void onPageSelected(int arg0) {
                    // TODO Auto-generated method stub

                }

            }); 
```

谁能知道问题出在哪里？我是否需要使用扩展 FragmentPageAdapter 的 circleppageindicator 适配器？

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T16:03:25.750

您可以根据需要自定义圆形指示器，这取决于您的需要，您想要的方式

[**这是我的实现**](https://stackoverflow.com/questions/14433281/android-fragment-pager-and-custom-page-indicator-viewpagerindicator-created-by)

它非常适合我

**注意**：您还可以找到我用来创建[**页面指示器的库**](http://viewpagerindicator.com/)

# javascript - ajax httprequest 时间/没有多个请求

> ID：14415713
> 
> 赞同：0
> 
> 时间：2013-01-19T15:15:04.723
> 
> 标签：javascript, ajax, xmlhttprequest, readystate

我正在处理的是聊天，所以我希望每 1 秒读取/显示一次数据库，并提交一条新消息。我认为我的 httprequest 不起作用（没有超过 readystate 1），因为我在旧请求未完成时触发了新请求。Firebug 说每个请求需要超过 1 秒：

> GET h**p://localhost/php2/projekt/open_blog/load.php 200 OK 1.03s

如果我将请求函数的间隔设置为高于应答所需的 1 秒，则它可以工作，但这不可能。在另一台机器上，这会立即发生。无论如何，我在 xampp 上运行它。这是我缺少的一些 php.ini 设置吗？这将如何在实际的在线服务器上运行？

为什么不能同时发生多个请求呢？对象在一个函数内部，所以每一个都是一个新的唯一的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T20:27:26.070

在第一个请求完成之前不要提出新请求。请求完全有可能需要一秒钟或 5 秒钟。

您可能还会查看使用 Websocket 或在需要时模拟它们的 Socket.IO 之类的东西。

# android - Spinner 不能在 Android 的条件语句中使用

> ID：14415716
> 
> 赞同：0
> 
> 时间：2013-01-19T15:15:24.077
> 
> 标签：android, spinner, android-arrayadapter

似乎是什么问题...我的程序无法输入 switch 语句。我将位置分配给了 unita，当我在 switch 语句中使用它时，它没有响应。但是当我尝试将代码放在 switch 语句之外时，程序会正常响应。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

   ArrayAdapter<String> adapter = new ArrayAdapter<String>(MainActivity.this, android.R.layout.simple_spinner_item, list);
   category = (Spinner) findViewById(R.id.categoryList);
   category.setAdapter(adapter);
   category.setOnItemSelectedListener(this);

}

@Override
public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2,
        long arg3) 
{
    // TODO Auto-generated method stub
    int position = category.getSelectedItemPosition();

    switch(position)
    {
        case 0:
        {
            //Length                                
            Length();
        }   
            break;
        case 1:
        {
            //Weight
            Weight();
        }   
            break;
        case 2:
            //Time
            Time();
            break;
        case 3:
            //IT
            IT();
            break;
        case 4:
            //Area
            Area();
            break;
        case 5:
            //Volume
            Volume();
            break;
        case 6:
            //Perimeter
            Perimeter();
            break;
    }               

}
public void Length()
{
    ArrayAdapter<String> lengthadapt = new ArrayAdapter<String>(MainActivity.this, android.R.layout.simple_spinner_item, length);
    ArrayAdapter<String> lengthadapt2 = new ArrayAdapter<String>(MainActivity.this, android.R.layout.simple_spinner_item, length);

    unit1 = (Spinner) findViewById(R.id.unit1);
    int unita = unit1.getSelectedItemPosition();   
    unit1.setAdapter(lengthadapt);
    unit1.setSelection(unita);
    unit2 = (Spinner) findViewById(R.id.unit2);
    int unitb = unit2.getSelectedItemPosition();
    unit2.setAdapter(lengthadapt2);
    unit2.setSelection(unitb); 
    b1=(ImageButton) findViewById(R.id.convert1);       

    int con=unita;

switch(con)
{
case 0:         
{   b1=(ImageButton) findViewById(R.id.convert1);   
    b1.setOnClickListener(new OnClickListener() {  
      public void onClick(View v) {           
          t1=(EditText) findViewById(R.id.input1);
          t2=(EditText) findViewById(R.id.input2);  
          Double res;
            String txt;
            int num1=Integer.parseInt(t1.getText().toString());
            res=(double)num1*1000;
            System.out.println(res);
            t2.setText(res.toString());
      }});  
    break;
}
case 1:
    {b1=(ImageButton) findViewById(R.id.convert1);  
        b1.setOnClickListener(new OnClickListener() {  
              public void onClick(View v) {           
                  t1=(EditText) findViewById(R.id.input1);
                  t2=(EditText) findViewById(R.id.input2);  
                  Double res;
                    String txt;
                    int num1=Integer.parseInt(t1.getText().toString());
                    res=(double)num1*1000;
                    System.out.println(res);
                    txt=res.toString();
                    t2.setText(txt);

                  }});  
        break;
    }
case 2:{
    b1=(ImageButton) findViewById(R.id.convert1);   
    b1.setOnClickListener(new OnClickListener() {  
          public void onClick(View v) {           
              t1=(EditText) findViewById(R.id.input1);
              t2=(EditText) findViewById(R.id.input2);  
              Double res;
                String txt;
                int num1=Integer.parseInt(t1.getText().toString());
                res=(double)num1*.01;
                System.out.println(res);
                txt=res.toString();
                t2.setText(txt);

              }});  
    break;
}
case 3:
{
    b1=(ImageButton) findViewById(R.id.convert1);   
    b1.setOnClickListener(new OnClickListener() {  
          public void onClick(View v) {           
              t1=(EditText) findViewById(R.id.input1);
              t2=(EditText) findViewById(R.id.input2);  
              Double res;
                String txt;
                int num1=Integer.parseInt(t1.getText().toString());
                res=(double)num1*.001;
                System.out.println(res);
                txt=res.toString();
                t2.setText(txt);

              }});  
    break;
}
case 4:{
    b1=(ImageButton) findViewById(R.id.convert1);   
    b1.setOnClickListener(new OnClickListener() {  
          public void onClick(View v) {           
              t1=(EditText) findViewById(R.id.input1);
              t2=(EditText) findViewById(R.id.input2);  
              Double res;
                String txt;
                int num1=Integer.parseInt(t1.getText().toString());
                res=(double)num1*.4;
                System.out.println(res);
                txt=res.toString();
                t2.setText(txt);

              }});  
    break;
}
case 5:
{
    b1=(ImageButton) findViewById(R.id.convert1);   
    b1.setOnClickListener(new OnClickListener() {  
          public void onClick(View v) {           
              t1=(EditText) findViewById(R.id.input1);
              t2=(EditText) findViewById(R.id.input2);  
              Double res;
                String txt;
                int num1=Integer.parseInt(t1.getText().toString());
                res=(double)num1*12;
                System.out.println(res);
                txt=res.toString();
                t2.setText(txt);

              }});  
    break;
}
}

switch(unitb)
        {
        case 0:

            break;
        case 1:

            break;
        case 2:

            break;
        case 3:

            break;
        case 4:

            break;
        case 5:

            break;

        }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:36:59.060

全局声明您的 unita 值以在其他方法中使用它。

```
int unita;

unit1.setOnItemSelectedListener(new OnItemSelectedListener()
{
@Override
public void onItemSelected(AdapterView<?> arg0, View arg1,
int arg2, long arg3)
{
unita = arg0.getSelectedItemPosition();
Toast.makeText(getBaseContext(),
"You have selected item position : " + unita,
Toast.LENGTH_SHORT).show();
}
@Override
public void onNothingSelected(AdapterView<?> arg0) {}
}); 
```

# python - 在不知道python中的单词的情况下计算数组数组中单词的出现次数

> ID：14415717
> 
> 赞同：0
> 
> 时间：2013-01-19T15:15:24.407
> 
> 标签：python, arrays, count, nltk

我是python编程的新手，希望你们中的某个人能帮助我。

我必须以这种形式打印语料库的前十个二元组：

```
((token),(POS_tag),(token),(POS_tag)) 
```

其中每个token的出现次数必须大于2。

所以我已经完成了一个带有 post 标记的令牌列表，并将它们与`bigrams()`.

我如何检查每个单词的出现次数（对应于每对的标记）是否> 2？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T00:10:28.227

我假设你的意思是前十个二元组，我排除了其中一个标记是标点符号的二元组。

```
import nltk, collections, string
import nltk.book

def bigrams_by_word_freq(tokens, min_freq=3):
    def unique(seq): # http://www.peterbe.com/plog/uniqifiers-benchmark
        seen = set()
        seen_add = seen.add
        return [x for x in seq if x not in seen and not seen_add(x)]

    punct = set(string.punctuation)
    bigrams = unique(nltk.bigrams(tokens))
    pos = dict(nltk.pos_tag(tokens))
    count = collections.Counter(tokens)

    bigrams = filter(lambda (a,b): not punct.intersection({a,b}) and count[a] >= min_freq and count[b] >= min_freq, bigrams)

    return tuple((a,pos[a],b,pos[b]) for a,b in bigrams)

text = """Humpty Dumpty sat on a wall,
Humpty Dumpty had a great fall.
All the king's horses and all the king's men
Couldn't put Humpty together again."""

print bigrams_by_word_freq(nltk.wordpunct_tokenize(text), min_freq=2)

print bigrams_by_word_freq(nltk.book.text6)[:10] 
```

输出：

```
(('Humpty', 'NNP', 'Dumpty', 'NNP'), ('the', 'DT', 'king', 'NN'))
(('SCENE', 'NNP', '1', 'CD'), ('clop', 'NN', 'clop', 'NN'), ('It', 'PRP', 'is', 'VBZ'), ('is', 'VBZ', 'I', 'PRP'), ('son', 'NN', 'of', 'IN'), ('from', 'IN', 'the', 'DT'), ('the', 'DT', 'castle', 'NN'), ('castle', 'NN', 'of', 'IN'), ('of', 'IN', 'Camelot', 'NNP'), ('King', 'NNP', 'of', 'IN')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T23:32:25.067

由于各种原因，您的问题含糊不清。一方面，标题真的可以用更好的措辞。你没有很好地解释你想要做什么。对于“前十个二元组”，您的字面意思是文本中的前十个二元组，还是最常见的十个？我以为是后者，但如果不是，只需删除排序并将您的文本限制为前十一个单词。

```
from nltk.util import bigrams
from nltk import tokenize, pos_tag
from collections import defaultdict

counts = defaultdict(int)
counts_pos = defaultdict(int)

with open('twocities.txt') as f:
    txt = f.read().lower()
    txt = tokenize.word_tokenize(txt)

    # Generate the lexical bigrams
    bg = bigrams(txt)

    # Do part-of-speech tagging and generate 
    # lexical+pos bigrams
    pos = pos_tag(txt)
    bg_pos = bigrams(pos)

    # Count the number of occurences of each unique bigram
    for bigram in bg:
        counts[bigram] += 1

    for bigram in bg_pos:
        counts_pos[bigram] += 1

# Make a list of bigrams sorted on number of occurrences
sortedbigrams = sorted(counts, key = lambda x: counts[x], reverse=True)
sortedbigrams_pos = sorted(counts_pos, key = lambda x: counts_pos[x],
                           reverse=True)

# Remove bigrams that occur less than the given threshold
print 'Number of bigrams before thresholding: %i, %i' % \
       (len(sortedbigrams), len(sortedbigrams_pos))

min_occurence = 2

sortedbigrams = [x for x in sortedbigrams if counts[x] > min_occurence]
sortedbigrams_pos = [x for x in sortedbigrams_pos if
            counts_pos[x] > min_occurence]
print 'Number of bigrams after thresholding: %i, %i\n' % \
       (len(sortedbigrams), len(sortedbigrams_pos))

# print results
print 'Top 10 lexical bigrams:'
for i in range(10):
    print sortedbigrams[i], counts[sortedbigrams[i]]

print '\nTop 10 lexical+pos bigrams:'
for i in range(10):
    print sortedbigrams_pos[i], counts_pos[sortedbigrams_pos[i]] 
```

我的 nltk 安装仅适用于 Python 2.6，如果我在 2.7 上安装它，我会使用[Counter](http://docs.python.org/2/library/collections.html#collections.Counter)而不是[defaultdict](http://docs.python.org/2/library/collections.html#collections.defaultdict)。

[在A Tale Of Two Cities](http://www.gutenberg.org/files/98/98-h/98-h.htm#link2H_4_0001)的第一页上使用此脚本，我得到以下输出：

```
Top 10 lexical bigrams:
(',', 'and') 17
('it', 'was') 12
('of', 'the') 11
('in', 'the') 11
('was', 'the') 11
(',', 'it') 9
('and', 'the') 6
('with', 'a') 6
('on', 'the') 5
(',', 'we') 4

Top 10 lexical+pos bigrams:
((',', ','), ('and', 'CC')) 17
(('it', 'PRP'), ('was', 'VBD')) 12
(('in', 'IN'), ('the', 'DT')) 11
(('was', 'VBD'), ('the', 'DT')) 11
(('of', 'IN'), ('the', 'DT')) 11
((',', ','), ('it', 'PRP')) 9
(('and', 'CC'), ('the', 'DT')) 6
(('with', 'IN'), ('a', 'DT')) 6
(('on', 'IN'), ('the', 'DT')) 5
(('and', 'CC'), ('a', 'DT')) 4 
```

# python - 单元测试失败，只是从 Python 2.6.5 更改为 Python 2.7.3；小数相关

> ID：14415720
> 
> 赞同：0
> 
> 时间：2013-01-19T15:15:44.323
> 
> 标签：python, python-2.7

我所有的单元测试都在 Python 2.6.5 中成功运行；当我运行 Python 2.7.3 时，一个失败了。被测试的代码很复杂，涉及大量的浮点数工作，并在此过程中转换为十进制，如 Python 2.6 中需要的那样首先转换为 str。

在我开始挖掘之前，我想知道我是否可以有点懒惰，看看是否有人以前看过这个并且有关于搜索什么的建议。这是测试运行的结果：

```
======================================================================
FAIL: test_hor_tpost_winsize_inside_mm (__main__.Test_ShutterCalculator)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "test_ShutterCalculator.py", line 506, in test_hor_tpost_winsize_inside_mm
    self.assertEqual(o.net_width_closing_tolerance, Decimal("6.4"))
AssertionError: Decimal('6.3') != Decimal('6.4')

---------------------------------------------------------------------- 
```

这是单元测试代码`test_hor_tpost_winsize_inside_mm()`：

```
490     def test_hor_tpost_winsize_inside_mm(self):
491         """
492         Same as above but test mm
493         """
494         o = self.opening
495         o.unit_of_measure = "millimeters"
496         o.formula_mode = "winsize"
497         o.mount = "inside"
498         o.given_width = Decimal("1117.6")
499         o.given_height = Decimal("2365.4")
500         o.louver_spacing = Decimal("101.6")
501         self.make4SidedFrame("9613", '9613: 2-1/2" Face Deco Z', Decimal("63.5"), Decimal("19.1"))
502         so1 = o.subopenings[(0,0)]
503         so1.fold_left = 1
504         so1.fold_right = 1
505         self.calc()
506         self.assertEqual(o.net_width_closing_tolerance, Decimal("6.4"))
507         self.assertEqual(o.net_height_closing_tolerance, Decimal("6.4"))
508         self.assertEqual(o.horizontal_shim, Decimal(".125"))  # in inches
509         self.assertEqual(o.vertical_shim, Decimal(".125"))  # in inches
510         self.assertEqual(o.width, Decimal("1069.8"))  ## 1070 converted directly from inches
511         self.assertEqual(o.height, Decimal("2317.6")) ## 2317.8 converted directy from inches
512         tpost = o.add_hor_tpost()
513         so2 = o.subopenings[(0,1)]
514         so2.fold_left = 1
515         so2.fold_right = 1
516         self.calc()
517         #self.cs()
518         self.assertEqual(o.net_width_closing_tolerance, Decimal("6.4"))
519         self.assertEqual(o.net_height_closing_tolerance, Decimal("12.7"))
520         self.assertEqual(o.horizontal_shim, Decimal(".125"))  # in inches
521         self.assertEqual(o.vertical_shim, Decimal(".125"))  # in inches
522         self.assertEqual(o.width, Decimal("1069.8"))  ## Rick had 42 but agreed that mine is right
523         self.assertEqual(o.height, Decimal("2311.3"))
524         self.assertEqual(so1.width, Decimal("1069.8"))
525         self.assertEqual(so2.width, Decimal("1069.8"))
526         self.assertEqual(so1.height, Decimal("1139.7"))  ## Rick had 44.8125 but agreed mine is right
527         self.assertEqual(so2.height, Decimal("1139.7"))
528         self.assertEqual(tpost.center_pos, Decimal("1182.7"))
529         top_panel_section = so1.panels[0].sections[(0,0)]
530         bottom_panel_section = so2.panels[0].sections[(0,0)]
531         self.assertEqual(top_panel_section.louver_count, 9)
532         self.assertEqual(bottom_panel_section.louver_count, 9)
533         self.assertEqual(top_panel_section.top_rail.width, Decimal("112.6"))  ## Rick had 4.40625, but given the changes to net
534         self.assertEqual(bottom_panel_section.bottom_rail.width, Decimal("112.7"))
535         self.assertEqual(top_panel_section.bottom_rail.width, Decimal("112.7"))
536         self.assertEqual(bottom_panel_section.top_rail.width, Decimal("112.6")) 
```

关于在我的代码中搜索什么以找到差异来源的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:23:31.423

Python 2.7 引入了对`Decimal`类和`float`类型的更改，以帮助提高从字符串转换时的准确性。这可能是变化的根源。

> 浮点数和字符串之间的转换现在在大多数平台上都可以正确舍入。这些转换发生在许多不同的地方：浮点数和复数上的 str()；float 和 complex 构造函数；数字格式；使用 marshal、pickle 和 json 模块序列化和反序列化浮点数和复数；解析 Python 代码中的浮点数和虚数文字；和小数到浮点数的转换。

[您可以在此处](http://docs.python.org/release/2.7/whatsnew/2.7.html)查看更改详情，在“其他语言更改”下

# android - 如何设置子视图的宽度以相互划分？

> ID：14415724
> 
> 赞同：0
> 
> 时间：2013-01-19T15:16:43.793
> 
> 标签：android

我正在尝试创建一个 LinearLayout，其左视图宽度为其父宽度的 80%，第二个视图占用剩余空间。我该如何做到这一点？

![在此处输入图像描述](../Images/7fa70e3185109f37ecce5c17ca031404.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:19:29.150

在定义子视图时尝试使用 android:layout_weight。

视图 1 使用 0.8 的布局权重，视图 2 使用 0.2 的布局权重

示例 xml 将是：

```
android:layout_weight=".8" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T15:53:18.557

像这样：

不要忘记将宽度设置为 0。

```
<TextView
    android:layout_width="0dp"
    android:layout_height="match_parent"
    android:layout_weight=".8"
    android:background="@color/blue" />

<TextView
    android:layout_width="0dp"
    android:layout_height="match_parent"
    android:layout_weight=".2"
    android:background="@color/red" /> 
```

# android - 从 OnSensorChanged() 方法返回值

> ID：14415727
> 
> 赞同：0
> 
> 时间：2013-01-19T15:16:54.897
> 
> 标签：android, return, proximity

我想要实现的是在 method 中返回正确的结果集`isClose`。问题是该`isClose`方法没有等待`onSensorChanged`被触发并返回字段的默认“0”值`isClose`。

我这样称呼我的职位类：
`Position mPosition = new Position();`

`boolean result = mPosition.isInPocket(this);`

职位类别：

```
public class Position implements SensorEventListener {

  private SensorManager mSensorManager;
  private Sensor mProximity;
  private boolean isClose;

public void onAccuracyChanged(Sensor sensor, int accuracy) {
}

public void onSensorChanged(SensorEvent event) {
    float[] value = event.values;

    if(value[0] > 0)    {
        isClose = false;
    }   else
                {
          isClose = true;
    }   
}

public boolean isClose(Context context) {

    mSensorManager = (SensorManager) context.getSystemService(Context.SENSOR_SERVICE);

    mProximity = mSensorManager.getDefaultSensor(Sensor.TYPE_PROXIMITY);
    mSensorManager.registerListener(this, mProximity, 0);

    return isClose; // I'd like to return this with value set in onSensorChanged. 
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:32:51.903

您需要`wait`在`isClose`第一个`onSensorChanged`事件中加入主线程，您可以通过多种方式实现这一点，但使用[`Condition`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/locks/Condition.html)变量可能是最简单的。

```
public class Position implements SensorEventListener {
    private SensorManager mSensorManager;
    private Sensor mProximity;
    private boolean isClose;
    private final Lock lock = new ReentrantLock();
    private final Condition eventReceived = lock.newCondition();
    private boolean firstEventOccurred = false;

    public void onAccuracyChanged(Sensor sensor, int accuracy) {
    }

    public void onSensorChanged(SensorEvent event) {
        float[] value = event.values;

        if (value[0] > 0)    {
            isClose = false;
        }   else {
            isClose = true;
        }
        if (!firstEventOccurred) {
            lock.lock();
            try {
                firstEventOccurred = true;
                eventReceived.signal();
            } finally {
                lock.unlock();
            }
        }
    }

    public boolean isClose(Context context) {

        mSensorManager = (SensorManager) context.getSystemService(Context.SENSOR_SERVICE);

        mProximity = mSensorManager.getDefaultSensor(Sensor.TYPE_PROXIMITY);
        mSensorManager.registerListener(this, mProximity, 0);

        lock.lock();
        try {
            while (!firstEventOccurred) {
                eventReceived.await();
            }
        } finally {
            lock.unlock();
        }
        return isClose; // I'd like to return this with value set in onSensorChanged. 
    } 
```

我已经`InterrupedException`从上面的代码中省略了检查，但它应该给你一个想法。

# c++ - 具有 Qt 信号/槽的生产者/消费者

> ID：14415730
> 
> 赞同：3
> 
> 时间：2013-01-19T15:17:29.593
> 
> 标签：c++, multithreading, qt, signals-slots, producer-consumer

我正在编写一个程序，其中几个生产者生成一些应该由多个消费者处理的数据。由于每条数据的消耗大约需要 100 毫秒，并且目标平台有很多处理器，所以对我来说，每个生产者和每个消费者都有自己的线程似乎很自然。我的问题是：Qt 信号/槽是将数据块从生产者传递给消费者的好方法吗？或者您是否提出了更好的解决方案（强烈推荐 Qt）。

以防万一，生产者每小时左右会产生数十万个突发数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:23:21.477

我认为信号/插槽机制在这里不合适，因为每个信号都分配到*所有*连接的插槽。这意味着如果你使用信号/槽机制作为你的“工作队列”，你不会在消费者身上得到任何负载分配，而是所有消费者都可以做同样的（重复的）工作。

更好的机制是使用容器作为工作队列（生产者将项目添加到容器中，消费者删除它们），使用一个`QMutex`来避免并发问题和一个（或两个，如果你想施加最大大小）`QWaitCondition`来阻止消费者当他们没有工作时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:09:51.877

我建议您避免使用信号和插槽，因为它们充当事件，因此一旦发出信号，您就无法控制执行。因此，我建议您使用锁或互斥锁（例如 QMutex）进行互斥。只需使用 QMutex 类中的锁定和解锁方法来保护您的队列。我认为它会比使用信号和槽更快，因为如果您传递对象，它将传递对象的副本，并且在传递指针的情况下，您将不会保护对象。

干杯，

# mysql - 将所有数据从 MySQL 数据库导出到电子表格

> ID：14415732
> 
> 赞同：0
> 
> 时间：2013-01-19T15:17:44.417
> 
> 标签：mysql, excel, csv, spreadsheet, dump

所以，我有一个 MySQL 数据库，其中包含我想送给我叔叔的一堆表。

问题是，他对计算机知之甚少，所以我不能把他和数据库联系起来。

相反，我想将数据库中的所有数据提取为更易读的格式，例如 Excel 电子表格。

我试过 mysqldump，但这只是给了我一个 *.sql 文件，它没有多大帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:19:17.173

如果您只有命令行，[则此答案](https://stackoverflow.com/a/467465/679449)说明如何转储到制表符分隔，以及[此答案](https://stackoverflow.com/a/467528/679449)如何转储到逗号分隔文件中。然后，您可以将制表符分隔文件导入 Excel。

或者，如果您有 PHP ，您可以使用[phpMyAdmin](http://www.phpmyadmin.net/home_page/index.php)导出到。`*.csv`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T15:19:33.670

PHPmyadmin 允许您导出到许多不同的格式 - 为什么不通过它访问您的数据库？

# bash - 如何编写一个完整的 awk 脚本

> ID：14415735
> 
> 赞同：1
> 
> 时间：2013-01-19T15:17:56.117
> 
> 标签：bash, awk

我有以下情况：

我有一个仅包含数字的 1 列数据文件。让我们称之为`file.dat`。

然后我必须洗牌这个文件，为此我在终端中编写以下代码`shufl file1.dat > shuffle.dat`。然后我想计算两个连续数字的顺序`file1.dat`在`shuffle.dat`. 我使用了代码

```
awk -F, 'FNR==NR{o[NR]=$0;next;}{v[$0]=FNR;n=FNR}
    END{ for(i=1;i<=n-1;i++) t+=v[o[i]]>v[o[i+1]]?1:0;
            print t;
    }' file.dat shuffle.dat 
```

我必须重复此操作 10,000 次并将结果收集到文件中`result.dat`。显然，由于时间原因，通过终端进行操作是不可想象的。是否可以编写一个 awk 脚本使其重复 10,000 次操作并将结果写入输出文件`result.dat`？如果是的话，我如何以及如何通过终端运行脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:34:42.853

一个简单的 bash 脚本将实现这一点：

```
echo 'FNR==NR{o[NR]=$0;next;}{v[$0]=FNR;n=FNR}
     END{for(i=1;i<=n-1;i++) t+=v[o[i]]>v[o[i+1]]?1:0;
     print t;
     }' > script.awk

touch result.dat

for i in {1..10000}; do
    echo 'shuffling file...'
    shuf file.dat > shuf.dat
    echo 'counting inversions...'
    awk -F, -f script.awk file.dat shuf.dat >> result.dat
done 
```

# facebook - 如何让 facebook 应用程序同时在 example.com 和 www.example.com 上工作？

> ID：14415737
> 
> 赞同：0
> 
> 时间：2013-01-19T15:18:09.210
> 
> 标签：facebook

现在，如果我将我的 facebook 应用程序 url 设置为：[http://www.example.com ，那么来自](http://www.example.com)[http://example.com](http://example.com)的所有请求都不起作用。如果我在 facebook 中将 url 设置为[http://example.com](http://example.com)，那么来自[http://www.example.com](http://www.example.com)的所有请求都不起作用。

我该如何解决这个问题，以便它可以在两个地方工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T22:38:57.343

在 facebook 应用程序设置中设置应用程序域解决了此问题。

# android - 当我的列表项非常不同时，ExpandableListView 是否合适？

> ID：14415740
> 
> 赞同：1
> 
> 时间：2013-01-19T15:18:37.267
> 
> 标签：android

我在使用 ExpandableListView 时遇到问题，因为每个组中的 childItems 的类型差异很大。在一个部分有来自电话框的联系人，另一个有一个带有progressBar的视图，最后一个有一个TextView。

我曾考虑使用 3 个独立的 ExpandableListViews，每个都有自己的适配器和处理程序，但这似乎也有点疯狂，特别是当某些“列表”只有一个项目并且它永远不会改变时。本质上，我使用 ExpandableListViews 在我的 UI 中创建可扩展部分，但感觉不太对劲。

有没有更好的 UI 元素可以使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:22:48.147

如果它们完全不同，就像听起来一样，您可能需要考虑使用`Fragments`. 如果您不熟悉它们，您会学到很多新东西，但是您可以使用`Animations`加上隐藏`Fragments`. 这也将 3 个 UI 元素（联系人、进度条、文本视图）彼此分离，因此您几乎可以在任何您想要的地方重用 Fragments。

# python - Numpy 的 array() 和 asarray() 函数有什么区别？

> ID：14415741
> 
> 赞同：390
> 
> 时间：2013-01-19T15:18:46.797
> 
> 标签：python, arrays, numpy

[`array()`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array)Numpy和[`asarray()`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.asarray.html#numpy.asarray)函数有什么区别？什么时候应该使用一种而不是另一种？它们似乎为我能想到的所有输入生成相同的输出。

* * *

## 回答 #1

> 赞同：281
> 
> 时间：2013-01-19T15:25:04.887

的[定义`asarray`](https://github.com/numpy/numpy/blob/bcbed877f42ed6e9b01b2125134db4b6395f1d9d/numpy/core/numeric.py#L413-481)是：

```
def asarray(a, dtype=None, order=None):
    return array(a, dtype, copy=False, order=order) 
```

所以它就像`array`，除了它有更少的选项，并且`copy=False`。`array`默认有`copy=True`。

主要区别在于`array`（默认情况下）将制作对象的副本，而`asarray`除非必要，否则不会。

* * *

## 回答 #2

> 赞同：190
> 
> 时间：2018-08-30T19:06:29.393

由于其他问题被重定向到这个询问`asanyarray`或[其他数组创建例程](https://docs.scipy.org/doc/numpy/reference/routines.array-creation.html)的问题，因此可能值得简要总结一下它们的作用。

不同之处主要在于何时将输入原样返回，而不是创建一个新数组作为副本。

[`array`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html)提供了多种选项（大多数其他功能都是围绕它的薄包装），包括确定何时复制的标志。完整的解释将与文档一样长（请参阅[Array Creation](https://docs.scipy.org/doc/numpy/user/basics.creation.html#arrays-creation)，但简而言之，这里有一些示例：

假设`a`是`ndarray`, 并且`m`是`matrix`, 并且他们都有`dtype`一个`float32`:

*   `np.array(a)`并将`np.array(m)`复制两者，因为这是默认行为。
*   `np.array(a, copy=False)`并且`np.array(m, copy=False)`会复制`m`但不会`a`，因为`m`不是`ndarray`.
*   `np.array(a, copy=False, subok=True)`并且`np.array(m, copy=False, subok=True)`不会复制，因为`m`是 a `matrix`，它是 的子类`ndarray`。
*   `np.array(a, dtype=int, copy=False, subok=True)`将复制两者，因为`dtype`不兼容。

`array`复制发生时，大多数其他功能都是围绕该控件的薄包装器：

*   [`asarray`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.asarray.html)`ndarray`: 如果输入是兼容的( `copy=False`) ，则输入将返回未复制的内容。
*   [`asanyarray`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.asanyarray.html): 如果输入是兼容的`ndarray`或子类，如`matrix`( `copy=False`, `subok=True`)，则输入将未复制返回。
*   [`ascontiguousarray`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.ascontiguousarray.html): 如果输入`ndarray`在连续 C 顺序 ( `copy=False`, `order='C')`.
*   [`asfortranarray`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.asfortranarray.html)`ndarray`: 如果输入在连续的 Fortran 顺序 ( `copy=False`, `order='F'`)中兼容，则输入将未复制返回。
*   [`require`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.require.html)：如果输入与指定的要求字符串兼容，则输入将未复制返回。
*   [`copy`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.copy.html): 输入总是被复制。
*   [`fromiter`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.fromiter.html)：输入被视为可迭代的（例如，您可以从迭代器的元素构造一个数组，而不是使用`object`迭代器的数组）；总是被复制。

还有一些便利函数，比如[`asarray_chkfinite`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.asarray_chkfinite.html)（与超出缓冲区）。`asarray``ValueError``nan``inf``matrix`[`ndarray`](https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html)

* * *

## 回答 #3

> 赞同：139
> 
> 时间：2016-12-08T01:23:42.600

这个例子可以证明差异：

1.  生成矩阵

    ```
    >>> A = numpy.matrix(numpy.ones((3,3)))
    >>> A
    matrix([[ 1.,  1.,  1.],
            [ 1.,  1.,  1.],
            [ 1.,  1.,  1.]]) 
    ```

2.  用于`numpy.array`修改`A`. 不起作用，因为您正在修改副本

    ```
    >>> numpy.array(A)[2]=2
    >>> A
    matrix([[ 1.,  1.,  1.],
            [ 1.,  1.,  1.],
            [ 1.,  1.,  1.]]) 
    ```

3.  用于`numpy.asarray`修改`A`. 它起作用了，因为您正在修改`A`自己

    ```
    >>> numpy.asarray(A)[2]=2
    >>> A
    matrix([[ 1.,  1.,  1.],
            [ 1.,  1.,  1.],
            [ 2.,  2.,  2.]]) 
    ```

希望这可以帮助！

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-01-19T15:25:33.107

[`array`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.array.html#numpy.array)和的文档中非常清楚地提到了这些差异[`asarray`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.asarray.html#numpy.asarray)。区别在于参数列表，因此函数的操作取决于这些参数。

函数定义为：

```
numpy.array(object, dtype=None, copy=True, order=None, subok=False, ndmin=0) 
```

和

```
numpy.asarray(a, dtype=None, order=None) 
```

以下参数是那些可以传递给文档**但未**`array`在文档中提及的参数： **`asarray`**

 **> copy : bool, optional**如果为真（默认），则对象被复制**。否则，只有在`__array__`返回副本、obj 是嵌套序列或需要副本来满足任何其他要求（dtype、顺序等）时才会生成副本。
> 
> subok : bool, optional**如果为True，则子类将被传递**，否则返回的数组将被强制为基类数组（默认）。
> 
> ndmin : int, optional 指定结果数组应具有的**最小维数。**将根据需要预先添加到形状以满足此要求。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-05-30T12:27:48.410

`asarray(x)`就好像`array(x, copy=False)`

当您希望在完成任何其他操作之前`asarray(x)`确保它是一个数组时使用。`x`如果`x`已经是一个数组，则不会进行任何复制。它不会导致多余的性能损失。

这是一个确保`x`首先转换为数组的函数示例。

```
def mysum(x):
    return np.asarray(x).sum() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-11T21:01:34.497

这是一个可以证明差异的简单示例。

主要区别在于数组将复制原始数据并使用不同的对象我们可以修改原始数组中的数据。

```
import numpy as np
a = np.arange(0.0, 10.2, 0.12)
int_cvr = np.asarray(a, dtype = np.int64) 
```

数组 (a) 中的内容保持不变，我们仍然可以使用另一个对象对数据执行任何操作，而无需修改原始数组中的内容。**

# linux - 防止监视器在linux上进入待机状态

> ID：14415742
> 
> 赞同：1
> 
> 时间：2013-01-19T15:18:49.980
> 
> 标签：linux, qt, screensaver

Windows 具有[SetThreadExecutionState](http://msdn.microsoft.com/en-us/library/windows/desktop/aa373208%28v=vs.85%29.aspx)方法，使您能够在程序执行期间防止监视器待机。

我正在寻找 Linux 等价物，但找不到任何有用的东西。

我不想通过调用命令来禁用屏幕保护程序，因为如果程序在此之后崩溃，屏幕保护程序将保持禁用状态，直到用户重新启用它。

该程序是用 Qt 编写的，因此 Qt 友好的解决方案会很棒。

任何人的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:54:43.823

我一直在寻找这个并且找不到解决方案，而是找到了一种解决方法。与应用程序（视频播放器）同时启动一个小脚本，以定期检查应用程序进程是否处于活动状态，如果不是，则重新启用屏幕保护程序。在我的情况下，使用`xset s on`and `xset s off`，然后结束*检查器*进程本身。您可能可以将一个进程分叉到后台，以便它保持活动状态并可靠地重新启用它的工作。

# csv - D3js Treemap 重定向不起作用

> ID：14415743
> 
> 赞同：1
> 
> 时间：2013-01-19T15:19:09.913
> 
> 标签：csv, d3.js

我对编码完全陌生，我试图在单击节点时将重定向添加到 url，经过几天的搜索，这就是我所做的

```
 var svg = d3.select("body")
   .style("width", w + "px")
.style("height", h + "px")
 .append("svg:svg")
//.attr("width", w)
//.attr("height", h)
.append("svg:g")
.attr("transform", "translate(.5,.5)")
.on("click",function(){ window.open("new.html");}); 
```

我正在研究[https://gist.github.com/1446865](https://gist.github.com/1446865) 但它不起作用你能帮忙吗？一个小的修改我已经在 SVG 变量上添加了 .on("click" 现在它正在工作，现在我需要 URL 作为 d.key 但不能让它工作！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T14:48:09.273

`a`您可以使用锚标记包装链接元素，如[本例所示](http://www.w3.org/TR/SVG/images/linking/link01.svg)。此示例的关键元素是以下构造：

```
<svg>
  <a xlink:href="http://www.w3.org">
    <ellipse cx="2.5" cy="1.5" rx="2" ry="1" fill="red" />
  </a>
</svg> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-21T21:45:41.590

终于让它工作了，当我不得不将它添加到 .cell("rect") 时，我正在添加 .on 点击​​ SVG 元素

这是代码 [https://gist.github.com/4589729](https://gist.github.com/4589729)

# forms - 我的联系表格有什么问题？

> ID：14415744
> 
> 赞同：1
> 
> 时间：2013-01-19T15:19:11.880
> 
> 标签：forms, contact

有人可以看看我网站的代码并告诉我为什么我的联系表格不起作用吗？

以下是代码的相关部分：

从contact.html 文件：

```
<h3 class="indent-bot2">Contact Form</h3>
    <form action="#" id="contact-form">
        <div class="success"> Contact form submitted!<br>
            <strong>We will be in touch soon.</strong> </div>
            <fieldset>
                <label class="name">
                <input type="text" value="Enter Your Name:">
                <span class="error">*This is not a valid name.</span> 
                <span class="empty">*This field is required.</span> </label>

                <label class="email">
                <input type="text" value="Enter Your E-mail:">
                <span class="error">*This is not a valid email address.</span> 
                <span class="empty">*This field is required.</span> </label>

                <label class="phone">
                <input type="tel" value="Enter Your Phone:">
                <span class="error">*This is not a valid phone number.</span> 
                <span class="empty">*This field is required.</span> </label>

                <label class="message">
                <textarea>Enter Your Message:</textarea>
                <span class="error">*The message is too short.</span> 
                <span class="empty">*This field is required.</span> </label>
                <div class="buttons-wrapper">
                    <a class="button" data-type="reset">Clear</a>
                    <a class="button" data-type="submit">Send</a>                          
                </div>                                          
            </fieldset>
    </form> 
```

也来自contact.html文件：

```
<script type="text/javascript">
    $(window).load(function(){
        $('.slider')._TMS({
            duration:800,
            easing:'easeInCirc',
            preset:'zabor',
            pagination:false,
            slideshow:7000,
            banners:'fromTop',
            nextBu:'.next',
            prevBu:'.prev',
            waitBannerAnimation:false,
            pauseOnHover:true,
            beforeAnimation:function(){
                $('.slider .prev')
                .stop()
                .animate({top:'425px'},300,'easeOutCirc')
                $('.slider .next')
                .stop()
                .animate({top:'425px'},300,'easeOutCirc')
            },
            afterAnimation:function(){
                $('.slider .prev')
                .css({top:'425px'})
                .stop()
                .animate({top:'327px'},300,'easeOutCirc')

                $('.slider .next')
                .css({top:'425px'})
                .stop()
                .animate({top:'327px'},300,'easeOutCirc')
            }
        })

        $('#contact-form').forms({
            ownerEmail:'info@dohatutor.com'
        })

    });
    </script> 
```

我认为这是链接到 javascript 文件的一段代码，该文件又调用“mailhandler.php”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-03T19:13:11.170

```
<form action="some script"  METHOD="POST"   ENCTYPE="multipart/form-data"></form> 
```

action="处理表单的php或asp或pl脚本"

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T15:22:34.620

您没有指定表单应该发布到的位置 - 您想要将此表单发布到的脚本的名称是什么？

现在它说：

```
form action="#" 
```

它应该这样说：

```
form action="contact.php" 
```

# c - 如何在 C 中处理一个数组中的不同数据类型

> ID：14415747
> 
> 赞同：2
> 
> 时间：2013-01-19T15:19:22.760
> 
> 标签：c, memory-management

我想模拟面向对象的编程，所以在 C++ 中，让我们考虑以下 C 代码：

```
typedef struct tAnimal{
   char * name;
   int age;
}tAnimal;

typedef struct tAnimal2{
   char * name;
   int age;
   float size;
}tAnimal2; 
```

在 C++ 中，您可以创建从同一类继承的不同对象的表。我想在 C 中做同样的事情，让我们考虑以下代码：

```
tAnimal ** tab;
tab = malloc(sizeof(tAnimal*)*2);
tab[0] = malloc(sizeof(tAnimal));
tab[1] = malloc(sizeof(tAnimal2)); 
```

请注意，分配是有效的，因为 malloc 返回一个 void 指针，而 C 不需要强制转换。但是我仍然无法访问 size 字段，因为选项卡元素的类型毕竟是 tAnimal 。

有没有办法解决这个问题？，我想远离 void ** 指针。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T15:22:52.287

在 C 中，通常使用带有类型标志和`union`数据的结构：

```
typedef enum
{
    Animal1,
    Animal2
} AnimalType;

struct Animal
{
    AnimalType type;

    union
    {
        tAnimal  animal;
        tAnimal2 animal2;
    };
}; 
```

现在您可以创建一个结构数组`Animal`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T15:22:43.470

如果你想访问 size 字段，你必须将指针转换为 tAnimal2。请注意，对于 C++ 也是如此。

您可以通过在第二个结构的开头嵌入第一个结构来模拟继承：

```
struct tAnimal{
   char * name;
   int age;
};

struct tAnimal2{
  struct tAnimal parent;

  float size;
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T15:32:58.067

为了访问该`size`字段，`tab[1]`您可以将指针转换为 tAnimal2 指针。

```
 tAnimal2* panimal2 = (tAnimal2*) tab[1];
 panimal2->size = 1.0; 
```

然而，这种做法很容易导致数据损坏，因为您需要一种方法来确保您转换为 tAnimal2 的表元素确实是 tAnimal2 的一个实例。您可以使用 Joachim Pileborg 建议的附加类型字段来检查对象的类型。

# google-apps-script - 谷歌日历应用脚本定期将数据拉入电子表格

> ID：14415752
> 
> 赞同：3
> 
> 时间：2013-01-19T15:19:38.907
> 
> 标签：google-apps-script, google-calendar-api, google-spreadsheet-api

我一直在使用此脚本将 Google 日历中的数据提取到电子表格中。我有几个问题需要改进：

1.  是否可以将多个日历中的数据拉到同一个电子表格中，而不会相互覆盖？
2.  是否可以让它在电子表格中添加一个新的数据列来标记每行来自哪个日历？
3.  另外，您将如何将其设置为每 24 小时自动运行一次？

谢谢！

```
function caltest3(){
  var ss = SpreadsheetApp.openById("SPREADSHEET ID");
  SpreadsheetApp.setActiveSpreadsheet(ss);
  var cal=CalendarApp.getCalendarById("CALENDAR ID");
  var sheet = SpreadsheetApp.getActiveSheet();

  var events = cal.getEvents(new Date("January 1, 2013"), new Date("January 13, 2013"));
for (var i=0;i<events.length;i++) {
  //http://www.google.com/google-d-s/scripts/class_calendarevent.html
      var details=[[events[i].getTitle(), events[i].getStartTime(),            
                    events[i].getEndTime(), events[i].getDescription(),
                    events[i].getLocation()]];
  var row=i+1;
  var range=sheet.getRange(row+1,1,1,5);
  range.setValues(details);
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-20T00:09:40.137

简短的答案，然后是一个例子：

1.  您不能通过单次调用来执行此操作`CalendarApp`，但如果您遍历 calendarIds 列表并将该日历的结果事件添加到数组中，则可以对该数组进行排序并将其放入电子表格
2.  只需将日历名称（或 ID）添加为`details`数组中的另一个项目，只需记住将范围列数增加`1`
3.  将脚本触发器添加到您想要的任何时间段，[文档](https://developers.google.com/apps-script/execution_time_triggers)对此进行了最好的描述。

`getRange()`无论您是从多个日历还是仅一个日历构建一组日历事件，都将它们循环添加到数组中，然后将它们写入任何循环之外的电子表格，这比每次调用&`setValues`方法时逐行写入更好的做法它们是单独的 API 调用，这些调用对于 Apps 脚本来说是最昂贵的时间。每个只调用一次，其范围适合您的数据，您的脚本运行速度将提高一个数量级。

下面的脚本说明了答案 1 和 2。如果您为此设置计时器，您的需求可能会有所不同，因为您可能希望影响查询的时间段？

```
function caltest3(){

  var ss = SpreadsheetApp.openById( 'spreadsheetId' ),
      sheet = ss.getSheetByName( 'sheetName' ),
      cals = ['id1', 'id2', 'id3'], c, cal, calName,
      start = new Date( 'whenever' ), end = new Date( 'whenever' ),
      events, i, details,
      eventslog = [], e,
      rows = [], range;

  for (c = 0; c < cals.length; c += 1) {

    cal = CalendarApp.getCalendarById(cals[c]);
    calName = cal.getTitle();
    events = cal.getEvents(start, end);

    // add the events of the current calendar to the array of all events
    eventslog = eventslog.concat(
      events.map(function(event) {
        return {
          time: new Date(event.getStartTime()).getTime(), // sort by this
          details: [
            event.getTitle(),
            event.getStartTime(),
            event.getEndTime(),
            event.getDescription(),
            event.getLocation(),
            calName // change calendar info position in array to suit
          ]
        };
      })
    );
  }

  // sort array of event so date order can be either way by reversing a & b
  eventslog.sort(function(a, b) { return a.time - b.time; });

  rows = eventslog.map(function(entry) { return entry.details; });

  range = sheet.getRange(2, 1, rows.length, 6);
  range.setValues(rows);
} 
```

> 为了清楚起见，代码间隔开

# c# - 将值包装到范围 [min,max] 中而不进行除法

> ID：14415753
> 
> 赞同：13
> 
> 时间：2013-01-19T15:19:41.690
> 
> 标签：c#, c#-4.0

在 C# 中有什么方法可以在 x_min 和 x_max 之间包装给定值 x。该值不应像 in 那样被钳制，`Math.Min/Max`而是像`float`模数一样被包裹。

实现这一点的一种方法是：

```
x = x - (x_max - x_min) * floor( x / (x_max - x_min)); 
```

但是，我想知道是否有一种算法或 C# 方法可以在没有除法的情况下实现相同的功能，并且没有当值远离所需范围时可能出现的浮点限制精度问题。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-19T16:04:44.217

您可以使用两个模运算来包装它，**这仍然等效于除法**。我认为没有更有效的方法可以做到这一点而不假设`x`.

```
x = (((x - x_min) % (x_max - x_min)) + (x_max - x_min)) % (x_max - x_min) + x_min; 
```

公式中的附加总和和模数用于处理`x`实际小于`x_min`且模数可能为负的情况。或者你可以用一个`if`, 和一个单一的模块化划分来做到这一点：

```
if (x < x_min)
    x = x_max - (x_min - x) % (x_max - x_min);
else
    x = x_min + (x - x_min) % (x_max - x_min); 
```

除非离and`x`不远，并且可以通过很少的加法或减法（也可以考虑*错误传播*），我认为模数是您唯一可用的方法。`x_min``x_max`

 *# 没有分裂

请记住，错误传播可能会变得相关，我们可以用一个循环来做到这一点：

```
d = x_max - x_min;
if (abs(d) < MINIMUM_PRECISION) {
    return x_min; // Actually a divide by zero error :-)
}
while (x < x_min) {
    x += d;
}
while (x > x_max) {
    x -= d;
} 
```

# 关于概率的说明

模运算的使用具有一些统计含义（浮点运算也有不同的含义）。

例如，假设我们将包含的 0 到 5 之间的随机值（例如六面骰子结果）包装到 [0,1] 范围内（即掷硬币）。然后

```
0 -> 0      1 -> 1
2 -> 0      3 -> 1
4 -> 0      5 -> 1 
```

如果输入的谱是平坦的，即每个数字（0-5）都有1/6的概率，那么输出也将是平坦的，每个项目都有3/6 = 50%的概率。

但是，如果我们有一个五面骰子 (0-4)，或者如果我们有一个介于 0 和 32767 之间的随机数并希望将其减少到 (0, 99) 范围内以获得百分比，则输出不会是平坦的，并且某些数字会比其他数字稍微（或不那么轻微）更有可能。在五面骰子掷硬币的情况下，正面与反面的比例为 60%-40%。在 32767 到百分比的情况下，低于 67 的百分比将是 CEIL(32767/100)/FLOOR(32767/100) = 出现的可能性比其他百分比高 0.3%。

（为了更清楚地看到这一点，考虑数字从“00000”到“32767”：每328次抛出一次，数字的前三位将是“327”。发生这种情况时，后两位只能去从“00”到“67”，它们不可能是“68”到“99”，因为32768超出了范围。所以，从00到67的数字稍微更有可能。

因此，如果想要一个平坦的输出，则必须确保 (max-min) 是输入范围的除数。在 32767 和 100 的情况下，必须将输入范围截断为最接近的一百（减一）32699，以便 (0-32699) 包含 32700 个结果。每当输入 >= 32700 时，都必须再次调用输入函数以获得新值：

```
function reduced() {
#ifdef RECURSIVE
    int x = get_random();
    if (x > MAX_ALLOWED) {
        return reduced(); // Retry
    }
#else
    for (;;) {
        int x = get_random();
        int d = x_max - x_min;
        if (x > MAX_ALLOWED) {
            continue; // Retry
        }
    }
#endif
    return x_min + (
             (
               (x - x_min) % d
             ) + d
           ) % d; 
```

当 (INPUTRANGE%OUTPUTRANGE)/(INPUTRANGE) 很重要时，开销可能相当大（例如，将 0-197 减少到 0-99 需要进行大约两倍的调用）。

如果输入范围小于输出范围（例如，我们有一个抛硬币机，我们想掷骰子），使用霍纳算法乘（不加）所需的次数，以获得更大的输入范围。抛硬币的范围是 2，CEIL(LN(OUTPUTRANGE)/LN(INPUTRANGE)) 是 3，所以我们需要三个乘法：

```
for (;;) {
    x = ( flip() * 2 + flip() ) * 2 + flip();
    if (x < 6) {
        break;
    }
} 
```

或从掷骰子中得到一个介于 122 和 221（范围=100）之间的数字：

```
for (;;) {
    // ROUNDS = 1 + FLOOR(LN(OUTPUTRANGE)/LN(INPUTRANGE)) and can be hardwired
    // INPUTRANGE is 6
    // x = 0; for (i = 0; i < ROUNDS; i++) { x = 6*x + dice();  }
    x = dice() + 6 * ( 
            dice() + 6 * ( 
                dice() /* + 6*... */
            )
        );
    if (x < 200) {
        break;
    }
}
// x is now 0..199, x/2 is 0..99
y = 122 + x/2; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-19T15:27:34.177

模数在浮点上工作得很好，那么如何：

```
x = ((x-x_min) % (x_max - x_min) ) + x_min; 
```

尽管如此，它仍然是一个有效的分界线，你需要调整它的值小于 < min ...

当数字远离范围时，您会担心准确性。然而，这与模运算无关，但是它是执行的，但它是浮点的属性。如果你取一个 0 到 1 之间的数字，然后给它加上一个大常数，比如把它带入 100 到 101 的范围内，它会失去一些精度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T16:08:44.937

最小值和最大值是固定值吗？如果是这样，您可以提前计算出它们的范围和其倒数：

```
const decimal x_min = 5.6m;
const decimal x_max = 8.9m;
const decimal x_range = x_max - x_min;
const decimal x_range_inv = 1 / x_range;

public static decimal WrapValue(decimal x)
{
    return x - x_range * floor(x * x_range_inv);
} 
```

乘法的性能应该比除法好一些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T15:22:49.553

```
x = x<x_min?  x_min:
    x>x_max?  x_max:x; 
```

它有点令人费解，您绝对可以将其分解为一对 if 语句。但我认为没有必要从一开始就进行除法。

编辑：

我好像误会了，le

```
x = x<x_min?  x_max - (x_min - x):
    x>x_max?  x_min + (x - x_max):x; 
```

如果您的 x 值变化不大，这将起作用。这可能取决于用例。否则，对于更强大的版本，我希望您至少需要除法或重复（递归？）减法。

这应该是一个更健壮的版本，它会继续执行上述计算，直到 x 稳定。

```
int x = ?, oldx = x+1; // random init value.

while(x != oldx){
    oldx = x;
    x = x<x_min?  x_max - (x_min - x):
        x>x_max?  x_min + (x - x_max):x;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T15:28:35.773

如何在`IComparable`.

```
public static class LimitExtension
{
    public static T Limit<T>(this T value, T min, T max)
         where T : IComparable
    {
        if (value.CompareTo(min) < 0) return min;
        if (value.CompareTo(max) > 0) return max;

        return value;
    }
} 
```

还有一个单元测试：

```
public class LimitTest
{
    [Fact]
    public void Test()
    {
        int number = 3;

        Assert.Equal(3, number.Limit(0, 4));
        Assert.Equal(4, number.Limit(4, 6));
        Assert.Equal(1, number.Limit(0, 1));

    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-01T09:44:35.987

LinqPad 示例代码（限制为 3 位小数）

```
void Main()
{ 
    Test(int.MinValue, 0, 1,0.1f, "value = int.MinValue");
    Test(int.MinValue, -2,- 1,0.1f, "value = int.MinValue");
    Test(int.MaxValue, 0, 1,0.1f, "value = int.MaxValue");
    Test(int.MaxValue, -2,- 1,0.1f, "value = int.MaxValue");
    Test(-2,-2,-1,0.1f, string.Empty);
    Test(0,0,1,0.1f, string.Empty);
    Test(1,1,2,0.1f, string.Empty);

    Test(int.MinValue, 0, 1, -0.1f, "value = int.MinValue");
    Test(int.MinValue, -2,- 1, -0.1f, "value = int.MinValue");
    Test(int.MaxValue, 0, 1, -0.1f, "value = int.MaxValue");
    Test(int.MaxValue, -2,- 1, -0.1f, "value = int.MaxValue");
    Test(-2,-2,-1, -0.1f, string.Empty);
    Test(0,0,1, -0.1f, string.Empty);
    Test(1,1,2, -0.1f, string.Empty);
}

private void Test(float value, float min ,float max, float direction, string comment)
{
    "".Dump("    " + min + " to " + max + " direction = " + direction + "   " + comment);
    for (int i = 0; i < 11; i++)
    {
        value = (float)Math.Round(min + ((value - min) % (max - min)), 3); 
        string.Format("    {1} -> value: {0}", value,  i).Dump(); 
        value = value + direction < min && direction < 0 ? max + direction : value + direction;
    }
} 
```

结果

```
0 to 1 direction = 0.1   value = int.MinValue

0 -> value: 0
1 -> value: 0.1
2 -> value: 0.2
3 -> value: 0.3
4 -> value: 0.4
5 -> value: 0.5
6 -> value: 0.6
7 -> value: 0.7
8 -> value: 0.8
9 -> value: 0.9
10 -> value: 0

-2 to -1 direction = 0.1   value = int.MinValue

0 -> value: -2
1 -> value: -1.9
2 -> value: -1.8
3 -> value: -1.7
4 -> value: -1.6
5 -> value: -1.5
6 -> value: -1.4
7 -> value: -1.3
8 -> value: -1.2
9 -> value: -1.1
10 -> value: -2

0 to 1 direction = 0.1   value = int.MaxValue

0 -> value: 0
1 -> value: 0.1
2 -> value: 0.2
3 -> value: 0.3
4 -> value: 0.4
5 -> value: 0.5
6 -> value: 0.6
7 -> value: 0.7
8 -> value: 0.8
9 -> value: 0.9
10 -> value: 0

-2 to -1 direction = 0.1   value = int.MaxValue

0 -> value: -2
1 -> value: -1.9
2 -> value: -1.8
3 -> value: -1.7
4 -> value: -1.6
5 -> value: -1.5
6 -> value: -1.4
7 -> value: -1.3
8 -> value: -1.2
9 -> value: -1.1
10 -> value: -2

-2 to -1 direction = 0.1   

0 -> value: -2
1 -> value: -1.9
2 -> value: -1.8
3 -> value: -1.7
4 -> value: -1.6
5 -> value: -1.5
6 -> value: -1.4
7 -> value: -1.3
8 -> value: -1.2
9 -> value: -1.1
10 -> value: -2

0 to 1 direction = 0.1   

0 -> value: 0
1 -> value: 0.1
2 -> value: 0.2
3 -> value: 0.3
4 -> value: 0.4
5 -> value: 0.5
6 -> value: 0.6
7 -> value: 0.7
8 -> value: 0.8
9 -> value: 0.9
10 -> value: 0

1 to 2 direction = 0.1   

0 -> value: 1
1 -> value: 1.1
2 -> value: 1.2
3 -> value: 1.3
4 -> value: 1.4
5 -> value: 1.5
6 -> value: 1.6
7 -> value: 1.7
8 -> value: 1.8
9 -> value: 1.9
10 -> value: 1

0 to 1 direction = -0.1   value = int.MinValue

0 -> value: 0
1 -> value: 0.9
2 -> value: 0.8
3 -> value: 0.7
4 -> value: 0.6
5 -> value: 0.5
6 -> value: 0.4
7 -> value: 0.3
8 -> value: 0.2
9 -> value: 0.1
10 -> value: 0

-2 to -1 direction = -0.1   value = int.MinValue

0 -> value: -2
1 -> value: -1.1
2 -> value: -1.2
3 -> value: -1.3
4 -> value: -1.4
5 -> value: -1.5
6 -> value: -1.6
7 -> value: -1.7
8 -> value: -1.8
9 -> value: -1.9
10 -> value: -2

0 to 1 direction = -0.1   value = int.MaxValue

0 -> value: 0
1 -> value: 0.9
2 -> value: 0.8
3 -> value: 0.7
4 -> value: 0.6
5 -> value: 0.5
6 -> value: 0.4
7 -> value: 0.3
8 -> value: 0.2
9 -> value: 0.1
10 -> value: 0

-2 to -1 direction = -0.1   value = int.MaxValue

0 -> value: -2
1 -> value: -1.1
2 -> value: -1.2
3 -> value: -1.3
4 -> value: -1.4
5 -> value: -1.5
6 -> value: -1.6
7 -> value: -1.7
8 -> value: -1.8
9 -> value: -1.9
10 -> value: -2

-2 to -1 direction = -0.1   

0 -> value: -2
1 -> value: -1.1
2 -> value: -1.2
3 -> value: -1.3
4 -> value: -1.4
5 -> value: -1.5
6 -> value: -1.6
7 -> value: -1.7
8 -> value: -1.8
9 -> value: -1.9
10 -> value: -2

0 to 1 direction = -0.1   

0 -> value: 0
1 -> value: 0.9
2 -> value: 0.8
3 -> value: 0.7
4 -> value: 0.6
5 -> value: 0.5
6 -> value: 0.4
7 -> value: 0.3
8 -> value: 0.2
9 -> value: 0.1
10 -> value: 0

1 to 2 direction = -0.1   

0 -> value: 1
1 -> value: 1.9
2 -> value: 1.8
3 -> value: 1.7
4 -> value: 1.6
5 -> value: 1.5
6 -> value: 1.4
7 -> value: 1.3
8 -> value: 1.2
9 -> value: 1.1
10 -> value: 1 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-25T04:28:58.070

如果您能够添加最小值为 0 的约束，则简化上面 LSerni 的答案是：`x = ((x % x_max) + x_max) % x_max`

当小于 0 最小值时，第一个`x % x_max`操作将始终为负。`x`这允许将该简化的第二个模运算替换为小于 0 的比较。

```
float wrap0MinValue(float x, float x_max)
{
    int result = toWrap % maxValue;
    if (result < 0) // set negative result back into positive range
        result = maxValue + result;
    return result;
} 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2019-07-25T13:33:35.603

对于范围 0..1 的非常具体的情况，这似乎有效：

```
float wrap(float n) {
    if (n > 1.0) {
        return n - floor(n);
    }
    if (n < 0.0) {
        return n + ceil(abs(n));
    }
    return n;
} 
```

* * *

## 回答 #9

> 赞同：-3
> 
> 时间：2013-01-19T16:02:09.490

使用[Wouter de Kort](https://stackoverflow.com/a/14415832/1991068)的答案，但要改变

```
if (value.CompareTo(max) > 0) return max; 
```

至

```
if (value.CompareTo(max) > 0) return min; 
```*

# image - 由于 timthumb 调整大小，图像出现损坏

> ID：14415754
> 
> 赞同：0
> 
> 时间：2013-01-19T15:19:42.393
> 
> 标签：image, wordpress, image-resizing, timthumb

我经历了已经发布的问题`timthumb`，但我找不到任何东西。如果我错过了，请指出给我。

我正在使用 WordPress，我当前的主题`timthumb`用于调整图像大小。我将所有媒体文件都存储在我的主域中`i.e. domain.com`，然后在子域上为我的客户创建新网站`i.e. city1.domain.com`。

问题是我所有的图像都被破坏了。据我了解，它看起来也获取了本地 URL，并以假 URL 结束。

这是我已经尝试过的：

1.  将cache和thumb.php的权限设置为777。
2.  联系了我的托管公司并确保它被列入白名单并且不会产生错误。
3.  为定义设置“真”（“ALLOW_EXTERNAL”）
4.  在允许的站点中添加了主域。
5.  在主题设计者创建的配置文件中为定义（'ALLOW_EXTERNAL'）设置'TRUE'。
6.  我尝试了这个解决方案[http://code.google.com/p/timthumb/issues/attachmentText?id=342&aid=3420002000&name=timthumb-local-urls.patch&token=vsqVJPMS-dRI1y2C2uXU-Z1heVI%3A1358605496228](http://code.google.com/p/timthumb/issues/attachmentText?id=342&aid=3420002000&name=timthumb-local-urls.patch&token=vsqVJPMS-dRI1y2C2uXU-Z1heVI%3A1358605496228)但我收到一条错误信息＃35。

# android - 包含 ArrayList 语法异常的 Gson 对象

> ID：14415755
> 
> 赞同：1
> 
> 时间：2013-01-19T15:19:42.033
> 
> 标签：android, json, gson

我有一个名为 Route 的对象，它存储 RouteStep 对象的 ArrayList。

一个 RouteStep 对象存储和 ArrayList 的`int[]`.

这是一个类的示例。它们包含其他字段，但我在这里省略了它们：

```
public class Route {

    @Expose private long routeId;
    @Expose private List<RouteStep> routeSteps;

    public Route() {}

    public long getRouteId() {
        return routeId;
    }

    public void setRouteId(long routeId) {
        this.routeId = routeId;
    }

    public List<RouteStep> getRouteSteps() {
        return routeSteps;
    }

    public void setRouteSteps(List<RouteStep> routeSteps) {
        this.routeSteps = routeSteps;
    }
}

public class RouteStep {

    @Expose private ArrayList<int[]> coordinates = new ArrayList<int[]>();

    public RouteStep() {}

    public ArrayList<int[]> getCoordinates() {
        return coordinates;
    }

    public void setCoordinates(ArrayList<int[]> coordinates) {
        this.coordinates = coordinates;
    }       
} 
```

下面是一个需要解析的Json示例：

```
[
    {
        "routeId": -1,
        "user": "aa",
        "date": "08/01/2013 18:20:49",
        "routeName": "route 1",
        "distance": 536.4938,
        "routeSteps": [
            {
                "type": "LineString",
                "coordinates": [
                    [
                        55.940847,
                        -3.182992000000008
                    ],
                    [
                        55.941983999999984,
                        -3.186577000000001
                    ],
                    [
                        55.94265899999998,
                        -3.19088
                    ]
                ]
            }
        ]
    },
    {
        "routeId": -2,
        "user": "aa",
        "date": "08/01/2013 18:21:39",
        "routeName": "route 2",
        "distance": 455.127,
        "routeSteps": [
            {
                "type": "LineString",
                "coordinates": [
                    [
                        55.94265899999998,
                        -3.19088
                    ],
                    [
                        55.942732999999976,
                        -3.191536000000003
                    ],
                    [
                        55.94519300000003,
                        -3.19124800000001
                    ],
                    [
                        55.946433,
                        -3.191014999999997
                    ]
                ]
            }
        ]
    }
] 
```

我的课堂上有这个，用于解析 Json：

```
Gson gson = new Gson();

        try {
            routes = gson.fromJson(json, Route[].class);                
        } catch(JsonSyntaxException e1) {
            Log.e(TAG, "Syntax exception in retrieved JSON");
        } catch(JsonParseException e2) {
            Log.e(TAG, "Exception occured parsing retrieved JSON");
        } 
```

`JsonSyntaxExceptions`当它运行时，我不断得到。我已经使用相同的代码来解析包含原始类型的 ArrayLists 的对象数组，`int[]`但是当 ArrayList 包含我自己类型的对象时，我不知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T15:40:40.573

发布您的实际堆栈跟踪会有所帮助，但是......您有：

```
private ArrayList<int[]> coordinates = new ArrayList<int[]>(); 
```

并试图解析：

```
[
    55.940847,
    -3.182992000000008
], 
```

那些不是`int`s。修复它，它应该可以正常工作。

# ios - iOS 上的 Adob e AIR Mobile - 处理文本非常慢

> ID：14415758
> 
> 赞同：0
> 
> 时间：2013-01-19T15:20:14.163
> 
> 标签：ios, flash, actionscript, air, text-processing

我正在 Flash Builder 4.6 中编写一个需要处理大文本文件的 iOS 应用程序。到目前为止，我只是想从文件中获取版本信息，这是一个在模拟器中运行得非常快但在我的 iPad 2 上需要很长时间（大约 10 秒）的简单任务。

由于文件很大（大约 11MB），我试图只读取足够远的文件来获取版本数据。文件流是否有可能将整个文件加载到内存中？如果是这样，我该如何避免这种情况？

请注意，代码可以正常工作，并显示正确的版本信息。

任何有关如何加快速度的建议将不胜感激。

正在处理的文件可以在这里找到： http://oanda.sca.org:80/ [oanda.db](http://oanda.sca.org:80/oanda.db)

代码如下：

调用代码：

```
protected function view1_viewActivateHandler(event:ViewNavigatorEvent):void
{
    var DT:DatabaseTools = new DatabaseTools();
    var version:String;
    //Get version information from local file:
    version = DT.GetLocalVer("oanda.db");               
    lblLclVer.text=version;
} 
```

实际功能：

```
public function GetLocalVer(fileName:String):String
{
    var out:ByteArray = new ByteArray();
    var line_Out:String;
    var char:int;
    var line:ByteArray = new ByteArray();
    var stream:FileStream = new FileStream();
    var file:File = File.documentsDirectory.resolvePath(fileName);
    var lineString:String;
    var result:String = "Error";

    stream.open(file,FileMode.READ);

    var found:Boolean=false;

    while((stream.bytesAvailable > 0) && !found)
    {
        char=stream.readByte();
        if(String.fromCharCode(char) == "\n")
        {
            //reset the line
            out=line;
            line = new ByteArray();

            //process the line to see if its the version info.
            lineString=out.toString();  //since the version line never has UTF characters, convert it to a regular string
            if(lineString.length > 25)  //Any line shorter than this can't be the version line
            {
                var startOfLine:String = lineString.substr(0,17);
                if(startOfLine == " ||C|Last update:")
                {
                    result = lineString.substr(19,6);
                    found = true;
                }
            }
        }
        else
        {
            line.writeByte(char);
        }
    }
    stream.close();
    return result;
} 
```

谢谢。

# django - 使用 ModelForm 时在 Django 表单中设置字段

> ID：14415760
> 
> 赞同：1
> 
> 时间：2013-01-19T15:20:19.340
> 
> 标签：django, django-models, django-forms, django-templates

我的模型是我有一个工作列表，每个工作只能由一部分用户（ManyToManyField）完成。然后人们可以提交工作请求，并将工作分配给可以完成工作的人中的某个人：

```
class Job(models.Model):
    ...
    users = models.ManyToManyField(User)

class Job_Request(models.Model):
    ...
    job = models.ForeignKey(Job)
    assigned_to = models.ForeignKey(User) 
```

然后我使用 ModelForm 创建了一个表单，允许人们编辑工作请求，将工作重新分配给其他人。我的问题是，ModelForm 为表单中的“assigned_to”字段创建了一个菜单，其中列出了我们所有的用户。我只希望它显示可以完成这项工作的用户子集。我怎样才能做到这一点？

下面是我的 forms.py，我尝试将 assignment_to 字段设置为可以完成这项工作的用户子集，但我不知道正确的语法。以下绝对是错误的，因为它创建了一个空菜单。我怎样才能做到这一点，无论是在表单中，还是在模板中？谢谢。

```
class EditJobRequestForm(ModelForm):
    def __init__(self,  *args, **kwargs):
        super(EditJobRequestForm, self).__init__(*args, **kwargs)
        self.fields['assigned_to'].queryset =
            User.objects.filter(username__in=self.instance.job.users.all()] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T11:01:00.763

```
self.fields['assigned_to'].queryset = self.instance.job.users.all() 
```

请记住，在将模型发送到表单之前，必须在实例中设置作业

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T17:12:45.383

```
 User.objects.filter(username__in=self.instance.job.users.all()] 
```

您正在查询用户名与 PK。当然没有匹配。

```
 User.objects.filter(pk__in=self.instance.job.users.all()] 
```

# python - python subprocess("cmd") 生成另一个交互式 shell

> ID：14415762
> 
> 赞同：0
> 
> 时间：2013-01-19T15:20:28.067
> 
> 标签：python, windows, subprocess

```
import os, subprocess
p = subprocess.Popen("cmd.exe", stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE)
print>>p.stdin, "echo hi"
p.stdout.readline()
p.stdout.readline()
p.stdout.readline()
p.stdout.readline()
p.stdout.readline()
p.stdout.readline()
print>>p.stdin, "python"
p.stdout.readline() 
```

现在，如果我这样做`p.stdout.readline()`了，为什么我看不到 python shell？

另一方面，如果不是`python`，我从子进程启动了另一个`cmd`，我可以看到一个新的`cmd`shell 产生。

```
import os, subprocess
p = subprocess.Popen("cmd.exe", stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE)
print>>p.stdin, "echo hi"
p.stdout.readline()
p.stdout.readline()
p.stdout.readline()
p.stdout.readline()
p.stdout.readline()
p.stdout.readline()
print>>p.stdin, "cmd"
p.stdout.readline()
p.stdout.readline()
p.stdout.readline() 
```

有什么不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:25:07.430

当 Python 的标准输出不是终端设备时，它的行为会有所不同：没有提示，没有横幅，它只是读取一个完整的脚本并执行它。

我不确切知道它是如何移植到 Windows 的，但“控制台句柄”是他们拥有的“终端设备”的关闭对象。

# javascript - Javascript - 现在将日期/时间与 yyyy/mm/dd hh:mm:ss 进行比较

> ID：14415764
> 
> 赞同：0
> 
> 时间：2013-01-19T15:20:35.497
> 
> 标签：javascript, date, datetime

我在输入（#myinput）中有一个日期/时间，使用以下格式：

**年年/月/日 hh:mm:ss**

我需要将此与今天的日期进行比较，所以像这样......

```
var currentdate = new Date(); 
if(currentdate < $("#myinput").val()) {
    alert("HELLO WORLD");
    return false;
} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:33:08.113

我正在使用 moment.js (http://momentjs.com/) 来完成这种工作。

看起来像这样：

```
var input = moment($("#myinput").val(), "YYYY/MM/DD HH:mm:ss");
if(input.diff(moment())>0){
... 
```

如果我只能使用 javascript，我会使用正则表达式来解析日期：

```
var dateString = "2012/12/05 12:00:01";

var regexp = /([0-9]{4})\/([0-9]{2})\/([0-9]{2}) ([0-9]{2}):([0-9]{2}):([0-9]{2})/;
var result = regexp.exec(dateString);

var date = new Date();
date.setYear(result[1]);
date.setMonth(result[2]-1);
date.setDate(result[3]);
date.setHours(result[4]);
date.setMinutes(result[5]);
date.setSeconds(result[6]);

if(new Date()<date){
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T15:41:33.850

您可以使用 Date.Parse 方法（[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/parse](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date/parse)）将输入中的日期与当前日期或其他日期进行比较任何一种正确的日期格式。

前任：

```
 var testDate = $('#myinput').val();

    var d = new Date;

    if (Date.parse(d)<Date.parse(testDate)) {
        }
    else{
        } 
```

这是一个小提琴：http: [//jsfiddle.net/uLybp/3/](http://jsfiddle.net/uLybp/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-11T22:39:50.660

使用这个功能

```
//get full data now
function dateNow(){
    var now = new Date(Date.now());
    var dd=now.getDay() + "-" + (now.getMonth()+1) + "-" + now.getFullYear()+"  ";
    dd += now.getHours() + ":" + now.getMinutes() + ":" + now.getSeconds();
    return dd;
} 
```

例子

```
var d=dateNow();
console.log(d);  // 5-2-2021 1:35:24 
```

# css - 带有 CSS 的六边形图案

> ID：14415773
> 
> 赞同：3
> 
> 时间：2013-01-19T15:21:50.177
> 
> 标签：css

我找到了关于如何使用 CSS 创建六边形图案的一个很好的 stackoverflow 答案。

[使用 CSS3 生成重复的六边形图案](https://stackoverflow.com/questions/10062887/generate-repeating-hexagonal-pattern-with-css3/10068351#10068351)

这几乎是完美的，除了我想以另一种方式翻转六边形（即，点在顶部）。我通过交换主要的十六进制 div 宽度/高度来相当容易地做到这一点：(hexrow > div)... 但是我真的很难在其他支持的 div 上重新对齐背景图像。我一直在试图弄清楚一段时间，但没有取得多大成功。

任何人都可以发布一个 jsFiddle 来展示它是如何完成的吗？

这就是我目前所处的位置：[我尝试过的](http://jsfiddle.net/mqyCb/216/)

..我相信这是我需要修改的：

```
.hexrow > div > div:first-of-type:before {
    content: '';
    position: absolute;
    width: 200px; /* width of main + margin sizing */
    height: 100%;
    background-image: inherit;
    background-position: 0 0;
    background-repeat: no-repeat;
    background-size: 120% auto;
    bottom: 0;
    left: 0;
    z-index: 1;

    -ms-transform:rotate(-60deg) translate(-150px, 0); /* IE 9 */
    -moz-transform:rotate(-60deg) translate(-150px, 0); /* Firefox */
    -webkit-transform:rotate(-60deg) translate(-150px, 0); /* Safari and Chrome */
    -o-transform:rotate(-60deg) translate(-150px, 0); /* Opera */
    transform:rotate(-60deg) translate(-150px, 0);

    -ms-transform-origin: 0 0; /* IE 9 */
    -webkit-transform-origin: 0 0; /* Safari and Chrome */
    -moz-transform-origin: 0 0; /* Firefox */
    -o-transform-origin: 0 0; /* Opera */
    transform-origin: 0 0;
} 
```

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:36:24.883

对同一行的奇数/偶数六边形使用`:nth-of-type(odd)`和`:nth-of-type(even)`设置不同的边距。

* * *

或者你可以用更简单的方式来做，用更少的标记——检查[我在那个问题上的回答](https://stackoverflow.com/a/13069271/1397351)和我刚刚做的[这个演示。](http://codepen.io/thebabydino/full/hxEwA)这个想法是，您对元素（具有 ）应用一系列变换`overflow: hidden`以获得锐角为 的菱形，`60 degrees`然后如果您愿意，您可以以相反的顺序为伪元素或子元素撤消所有这些变换（与`height`元素本身相同，但只有`.866`它的`width`，因为 .866 是六边形的两个平行边与其大对角线之间的距离之比），您实际在其上应用`background-image`. 所以没有错位的可能性，因为背景图像只应用于一个元素。

基本**HTML**结构：

```
<div class='row'>
    <div class='hexagon'></div>
</div>
<div class='row'>
    <div class='hexagon content ribbon' data-content='This is a test!!! 
    9/10'></div><!--
    --><div class='hexagon content longtext' data-content='Some longer text here.
       Bla bla bla bla bla bla bla bla bla bla blaaaah...'></div>
</div> 
```

相关**CSS**：

```
.row { margin: -8% 0%; text-align: center; }
.row:first-child { margin-top: 2.25%; }
.hexagon {
    position: relative;
    display: inline-block;
    overflow: hidden;
    margin: 0 -1.5%;
    padding: 16%;
    transform: rotate(-30deg) skewX(30deg) scaleY(.866); /* .866 = sqrt(3)/2 */
}
.hexagon:before {
    display: block;
    position: absolute; /* 86.6% = (sqrt(3)/2)*100% = .866*100% */
    right: 6.7%; bottom: 0; left: 6.7%; top: 0; /* 6.7% = (100% -86.6%)/2 */
    transform: scaleY(1.155) skewX(-30deg) rotate(30deg); /* 1.155 = 2/sqrt(3) */
    background-color: rgba(30,144,255,.56);
    background-size: cover;
    content: '';
}
.row:first-child .hexagon:first-child:before {
    background-image: url(img.jpg); 
} 
/* and so on, add background images for all hexagons */ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T09:08:29.863

我使用了边框。

[Codepen.io](http://codepen.io/Eric/pen/ulazI)

```
<div id="hex"></div> 
```

和

```
#hex {
  display: inline-block;
  position: relative;
  width: 190px;
  height: 220px;
  background: no-repeat url("http://placekitten.com/200/300") 50% 50%;
}

div:before {

  content: " "; 
  display: block; 
  border-top: 0px solid transparent;
  border-bottom: 55px solid transparent;
  order-left: 95px solid white;
  border-right: 95px solid white;
}

div:after {

  content: " "; 
  display: block; 
  border-left: 95px solid white;
  border-top: 55px solid transparent;
  border-right: 95px solid white;
  margin-top:110px
} 
```

# ruby-on-rails-3 - Rails 3.2 序列化和反序列化邮件

> ID：14415776
> 
> 赞同：1
> 
> 时间：2013-01-19T15:22:22.530
> 
> 标签：ruby-on-rails-3

我正在尝试将电子邮件保存到数据库中，以便稍后通过 rake 任务发送。在 rails 2.3.8 (TMail) 中这很容易，但我在使用 rails 3.2 时遇到了麻烦。

获得 Mail 对象（邮件）后，我调用 mail.encoded 来序列化电子邮件。我将其保存到数据库中。

我的 rake 任务加载了编码的消息，但我找不到重新创建邮件对象并调用传递（反序列化）的方法。

Mail.new(mail.encoded) 似乎应该可以工作，但是由于 Mail.new 没有获得默认的 ActionMailer SMTP 设置，因此传递失败。

还有其他人在做这样的事情吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T23:55:08.917

好的，得到这个工作。

要序列化电子邮件，我执行以下操作。

```
email = mail(:to => 'to@me.com',  ....)
string = mail.encoded

# later one

mail.new(email.string)
Mail.deliver(mail) 
```

这似乎跳过了任何 HTML 验证。

我无法设置邮件发送设置（SMTP 等），但我认为它默认为 :sendmail，并且可以在 Web 服务器上运行。

# java - 如何编写junit进行评估 春季webflow 2中的标签？

> ID：14415781
> 
> 赞同：1
> 
> 时间：2013-01-19T15:22:45.747
> 
> 标签：java, spring, unit-testing, spring-webflow, spring-webflow-2

如何为以下 webflow 编写 junit：

```
<view-state id="Mydetails" view="checkdetails" model="customerBean">
    <on-entry>
        <set name="flowScope.site" value="Service.getServiceAddress()" />
    </on-entry>
    <on-render>
        <evaluate expression="customer.getdetails(custId)"
            result="flowScope.Details" />
    </on-render>
</view-state> 
```

对于标签中的评估表达式，是否可以对其进行单元测试？

# javascript - 从多维数组中删除重复的元素对

> ID：14415787
> 
> 赞同：5
> 
> 时间：2013-01-19T15:23:10.050
> 
> 标签：javascript, arrays, multidimensional-array, duplicates, coordinates

我有一个看起来像这样的数组：

```
1\.  coordinates = [ [16.343345, 35.123523],
2\.                  [14.325423, 34.632723],
3\.                  [15.231512, 35.426914],
4\.                  [16.343345, 35.123523],
5\.                  [15.231512, 32.426914] ] 
```

第 5 行的纬度与第 3 行的纬度相同，但它们的经度不同，因此不重复。

第 3 行和第 6 行的纬度和经度都相同，因此是重复的，应该删除一个。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-19T16:35:25.090

这个问题的困难在于，即使它们包含相同的值，不同的数组也永远不会相等。因此，直接比较方法，比如`indexOf`不会起作用。

以下模式可能有助于解决此问题。编写一个函数（或使用内置函数），将数组转换为标量值并检查这些值在集合中是否唯一。

```
uniq = function(items, key) {
    var set = {};
    return items.filter(function(item) {
        var k = key ? key.apply(item) : item;
        return k in set ? false : set[k] = true;
    })
} 
```

where`key`是一个“散列”函数，可将`items`（无论它们是什么）转换为可比较的标量值。`Array.join`在您的特定示例中，仅适用于数组似乎就足够了：

```
uniqueCoords = uniq(coordinates, [].join) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-19T16:55:59.520

您可以为此使用标准的 javascript 函数[splice](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/splice)。

```
for(var i = 0; i < coordinates.length; i++) {
    for(var j = i + 1; j < coordinates.length; ) {
        if(coordinates[i][0] == coordinates[j][0] && coordinates[i][1] == coordinates[j][1])
            // Found the same. Remove it.
            coordinates.splice(j, 1);
        else
            // No match. Go ahead.
            j++;
    }    
} 
```

但是，如果您有数千个点，它将运行缓慢，而不是您首先需要考虑对值进行排序，然后在一个循环中删除重复项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-09T16:15:45.777

我重写了[thg435](https://stackoverflow.com/users/989121/thg435)的答案（它不允许我发表评论）并使用 jQuery 对其进行原型制作，所以这将适用于所有使用它的浏览器（甚至 IE7）

```
Array.prototype.uniq = function (key) {
    var set = {};
    return $.grep(this, function (item) {
        var k = key
            ? key.apply(item)
            : item;
        return k in set
            ? false
            : set[k] = true;
    });
} 
```

你可以像这样使用它：

```
arr = arr.uniq([].join); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-24T23:40:18.117

如果您不在 Safari 上，这个单班轮可以完成这项工作

```
var arr = [[16.343345, 35.123523],
           [14.325423, 34.632723],
           [15.231512, 35.426914],
           [16.343345, 35.123523],
           [15.231512, 32.426914]],
    lut = {},
    red = arr.filter(a => lut[a] ? false : lut[a] = true);

document.write("<pre>" + JSON.stringify(red,null,2) + "</pre>");
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-19T16:24:32.440

创建另一个仅保留唯一坐标对的数组可能更简单

```
var uniqueCoors = [];
var doneCoors = [];
for(var x = 0; x < coordinates.length; x++) {
    var coorStr = coordinates[x].toString();

    if(doneCoors.indexOf(coorStr) != -1) {
        // coordinate already exist, ignore
        continue;
    }

    doneCoors.push(coorStr);
    uniqueCoors.push(coordinates[x]);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-04T13:16:39.727

```
function sortCoordinates(arr){
    var obj = {};
    for(var i = 0, l = arr.length; i < l; i++){
        var el = arr[i];
        var lat = el[0];
        var lng = el[1];

        if(!obj[lat + lng]){
            obj[lat + lng] = [lat, lng];
        } 
    }

    var out = [];
    for(p in obj){
        out.push([obj[p][0], obj[p][1]]);
    }
    return out;
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-01-19T16:10:33.977

我不确定坐标 [] [] 数据类型。相应地进行比较。

```
 var dubJRows= new Array();
  for(int i = 0; i <  coordinates.length -2; i++){
    for(int j = i+1; j <  coordinates.length -1; j++){
        if (i != j && chk_dubJRows_not_contains(j)) {
           innerArray1 [1][1] = coordinates[i];
           innerArray2 [1][1] = coordinates[j];
           if ( innerArray1 [1][0] == innerArray2[1][0] 
                   && innerArray1[1][1] == innerArray2[1][1]) {
               dubJRows.push(j);
            }
         }
       }
    }
    //REMOVE ALL dubJRows from coordinates. 
```

# android - 即使在我通过“导出签名的应用程序包...”部署 APK 后仍保留日志记录效果

> ID：14415788
> 
> 赞同：1
> 
> 时间：2013-01-19T15:23:16.013
> 
> 标签：android, proguard

`Log.i`当我使用 APK 通过 APK 部署我的应用程序时，我意识到我的所有日​​志记录效果（`Android Tools -> Export Signed Application Package...`

即使在我的 ProGuard 注释掉了与日志记录相关的配置之后

```
#-assumenosideeffects class android.util.Log {
#    public static *** d(...);
#    public static *** v(...);
#    public static *** i(...);
#} 
```

有没有我错过的设置？我希望日志记录效果仍然存在，即使我将处理后的 ProGuard 导出为 APK 文件。

这是因为我想调试一些[由 ProGuard 引起的崩溃问题](https://stackoverflow.com/questions/14410520/google-drive-api-doesnt-play-well-with-proguard-npe)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T23:57:31.053

ProGuard 不会自发删除任何日志记录代码。正如您今天的其他问题之一的症状（“[在 proguard 中保持类和保持界面无法按预期工作](https://stackoverflow.com/questions/14410645/keep-class-and-keep-interface-in-proguard-doesnt-work-as-expected)”）表明，您应该仔细检查您是否正在编辑正确的配置文件（proguard-project.txt，从 Android SDK r20 开始）并且您正在查看成功构建的输出。

# android - Logcat 错误 - 模拟器上的应用程序崩溃

> ID：14415790
> 
> 赞同：0
> 
> 时间：2013-01-19T15:23:23.830
> 
> 标签：android, sdk, intellij-idea, android-logcat

前段时间还可以，但后来发生了错误。我只在 Android 清单中添加了 minSDK 和 TargetSDK。

这是日志猫：

```
01-19 23:01:17.054: ERROR/System(51): Failure starting core service
        java.lang.SecurityException
        at android.os.BinderProxy.transact(Native Method)
        at android.os.ServiceManagerProxy.addService(ServiceManagerNative.java:146)
        at android.os.ServiceManager.addService(ServiceManager.java:72)
        at com.android.server.ServerThread.run(SystemServer.java:162)
01-19 23:01:17.094: ERROR/AndroidRuntime(51): Crash logging skipped, no checkin service
01-19 23:01:19.553: ERROR/LockPatternKeyguardView(51): Failed to bind to GLS while checking for account
01-19 23:01:24.994: ERROR/ActivityThread(107): Failed to find provider info for com.google.settings
01-19 23:01:25.034: ERROR/ActivityThread(107): Failed to find provider info for com.google.settings
01-19 23:01:30.764: ERROR/ApplicationContext(51): Couldn't create directory for SharedPreferences file shared_prefs/wallpaper-hints.xml
01-19 23:01:32.614: ERROR/vold(26): Cannot start volume '/sdcard' (volume is not bound)
01-19 23:01:37.034: ERROR/MediaPlayerService(30): Couldn't open fd for content://settings/system/notification_sound
01-19 23:01:37.054: ERROR/MediaPlayer(51): Unable to to create media player
01-19 23:01:28.556: ERROR/ActivityThread(104): Failed to find provider info for android.server.checkin
01-19 23:01:30.506: ERROR/ActivityThread(104): Failed to find provider info for android.server.checkin
01-19 23:01:30.627: ERROR/ActivityThread(104): Failed to find provider info for android.server.checkin 
```

# javascript - Fullcalendar - 撤消动作

> ID：14415793
> 
> 赞同：1
> 
> 时间：2013-01-19T15:23:38.977
> 
> 标签：javascript, jquery, fullcalendar

我正在使用 fullCalendar 来安排事件，并且我正在寻找一个新功能，用户可以在其中撤消在日历中完成的移动。

你们知道这样做的聪明方法吗？

我想到的第一件事是将以前的状态保存在一个新表中，当用户想要撤消移动系统时，只需将事件表中的值重置为“先前状态”表中的值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T15:11:23.127

我已经为此实施了一个解决方案。它可能不是最优雅的，但它对我有用。我在事件表中有一个名为 e_history 的列；它的内容是包含 {date:"1/12/2012",startTime:"8:00",duration:4} 的 JSON.stringified 数据数组。在我的系统中，持续时间值对应于基于 30 分钟时间增量映射出来的值。在我的事件弹出窗口（$.dialog）中，我有一个按钮，用户可以单击以查看旧的日程安排日期 - 如果他们想将事件设置回旧日期，则可以单击该按钮。这仅适用于监视单个事件。如果您想记住日历的整个状态，您可以只保存事件对象的字符串副本。这将允许灵活地根据需要解析它并监视与您的数据库的差异。

# php - 如何将 php 值返回到 jQuery 帖子

> ID：14415795
> 
> 赞同：-1
> 
> 时间：2013-01-19T15:24:00.180
> 
> 标签：php, jquery

我只是无法理解它。我需要在我的 php 文件中写什么才能将某些内容返回给`$.post`函数？

```
<script type="text/javascript">
    function SubmitToDatabase(uName, uComment)
    {
        $.post("write_something_to_mysql_b.php", {name: uName, comment: uComment});
        return false;
    }
</script> 
```

这有效，但 PHP 文件没有返回值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:37:22.250

首先，确保 jQuery 正在访问您的 PHP 文件。使用 Chrome 中的开发人员工具或[下载 Firebug](https://addons.mozilla.org/en-US/firefox/addon/firebug/) for Firefix，转到“网络”选项卡，当您的 JavaScript 函数`SubmitToDatabase()`执行时，检查以查看任何网络活动。如果它访问错误的 PHP 页面，它将显示 404。

如果它正在访问*正确*的PHP 页面，请检查 Firebug 以查看返回的值。要在 PHP 中为 JavaScript 调用返回一个值，您需要确保使用`echo`而不是`return`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:38:22.297

```
// php:
$output['result']    = 'hello!!!';
echo json_encode($output); // json encode here
exit;

// jquery:
$.post(
"write_something_to_mysql_b.php",
{
    name : uName,
    comment : uComment
},
function(output) { // callback function to catch your php output
    // console.debug(output['result']);
    alert(output['result']);
    // output hello!!!
},
'json'); // json requirement here 
```

`json`只是需要后端数据的可能性之一。其他有：xml、json、script、text、html。对于这些格式中的每一种，您必须以合适的方式从后端返回数据。例如`text`只是`echo 'hello!!!; exit;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T15:38:41.860

见[`jQuery.post()`](http://api.jquery.com/jQuery.post/)。如果你想对 PHP 结果做点什么，你必须添加一个成功函数

```
function SubmitToDatabase(uName, uComment)
{
    $.post("write_something_to_mysql_b.php", {name: uName, comment: uComment},
        function(data) { alert(data); });
    return false;
} 
```

# performance - 并行下载的理想主机名数量

> ID：14415796
> 
> 赞同：0
> 
> 时间：2013-01-19T15:24:07.820
> 
> 标签：performance, browser, hosting, loading, cdn

我们正在建立一个 CDN 来提供 CSS、JS 和图像。我们想知道分配资源的理想主机名数量是多少。许多网站使用这种技术来增加并行下载和页面加载。但是，DNS 查找会减慢页面加载速度，因此规则并不是您拥有的主机名越多，您获得的性能就越好。

我在某处读到理想的数字在 2 到 4 之间。我想知道是否有适用于所有网页的经验法则，或者是否有根据提供的资源数量和大小的经验法则.

具体案例：我们的网站由两种页面组成。一种提供缩略图列表（15 到 20 张左右的图像，不同），另一种提供具有较少图像的 Flash 或冲击波应用程序（主要是游戏）。显然，我们在所有页面上都有常规的 JS、图像和 CSS。当我的意思是常规时，正确优化的元素、1 个 CSS、一些 UI 图像、2/3 JS...

我很乐意为我们的具体案例提供答案，但我也很想得到一般性的答案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T03:57:10.417

我们（雅虎！）早在 2007 年就进行了[一项研究](http://yuiblog.com/blog/2007/04/11/performance-research-part-4/)，结果表明 2 是一个很好的数字，除此之外的任何东西都不会提高页面性能，在某些情况下，超过 2 个域会降低性能。

我的建议是 - 如果您有 A/B 测试基础设施，请继续在您的网站上试用，使用不同数量的域并测量最终用户的页面加载时间。如果您没有 A/B 测试框架，那么只需尝试不同的值几天，测量它，尝试一个新的，测量它......这样做直到你发现性能开始下降的那个点。

此建议没有灵丹妙药。这在很大程度上取决于每个页面上有多少资产以及最终用户使用的浏览器（并行下载的数量）。希望有帮助。

# c++ - 使用带有 C++ 的文本文件

> ID：14415808
> 
> 赞同：-2
> 
> 时间：2013-01-19T15:25:40.533
> 
> 标签：c++

我有一个包含 200 个数字的文本文件。我想计算这些数字的平均值（因为手工计算需要很长时间）。我不知道如何做到这一点，因为我从来没有做过这样的事情。提前致谢。

编辑：我尝试搜索谷歌，但找不到有用的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:32:54.857

一个简单的 C++ 程序将实现以下步骤：

1.  将文件作为文本文件打开（最好使用命令行参数作为文件名，不要硬编码）
    *   使用流而不是普通的旧 C 文件句柄；读取文件有很多不同的可能性
2.  逐行读取并将该行解析为`double`值
3.  在读取所有数字后存储值并计算平均值，或者在读取时即时计算平均值
    *   存储值应该发生在动态数据结构中，例如`std::vector`，阅读它
    *   即时计算意味着对所有值求和并增加一个计数器；将总和除以最后的计数器
    *   将其作为实现这两种可能性的练习；计算 a 的平均值`std::vector`又有很多可能性；尝试找到 3 种不同的解决方案来学习良好的 C++ 风格。（谷歌搜索*STL 算法*）
4.  然后将结果打印到标准输出`cout`

查看这些步骤并在遇到问题时提出具体问题。

* * *

但是，您不需要 C++ 程序来执行此操作。电子表格程序是完成此任务的完美工具。

如果您不喜欢此类任务的 GUI 程序，SQLite 也是一个完美的工具。打开 SQLite shell 并输入（假设`data.txt`您的文件每行都有一个十进制数字）：

```
create table tmp (value double);
.import data.txt tmp
select avg(value) from tmp; 
```

# python - 找到在opencv（python）中设置的白色像素的边界框

> ID：14415811
> 
> 赞同：1
> 
> 时间：2013-01-19T15:26:06.817
> 
> 标签：python, opencv

我需要找到一团白色像素的最小区域矩形（ cv2.minAreaRect() ）。

我的图像中有多个白色物体，我想在它们周围画一个矩形。

我在 C++ 中找到了解决方案：

```
cv::cvtColor(img, gray, CV_BGR2GRAY);
std::vector<cv::Point> points;
cv::Mat_<uchar>::iterator it = gray.begin<uchar>();
cv::Mat_<uchar>::iterator end = gray.end<uchar>();
for (; it != end; ++it)
{
    if (*it) points.push_back(it.pos());
}
cv::RotatedRect box = cv::minAreaRect(cv::Mat(points)); 
```

这是我在 python 中的尝试：

```
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
gray = cv2.GaussianBlur(gray, (5 ,5), 0)
retval, thresh = cv2.threshold(gray, 210, 255, cv2.THRESH_BINARY)
whitep = []
for y, row in enumerate(thresh):
    for x, px in enumerate(row):
        if px == 255:
            whitep.append((y, x))
box = cv2.minAreaRect(whitep) 
```

但它不起作用：

```
box = cv2.minAreaRect(whitep)
TypeError: <unknown> is not a numpy array 
```

我能怎么做？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T16:31:15.780

python 文档`minAreaRect`具有误导性。

采用：

```
box = cv2.minAreaRect(numpy.array([whitep], dtype=numpy.int32)) 
```

这会将形状 (1,N,2) 的数组传递给 minAreaRect。

如果您使用默认整数类型为 numpy.int64 的系统，则需要指定 dtype。明确表达是最安全的。

另见：[使用python检查opencv中的轮廓区域](https://stackoverflow.com/questions/8369547/checking-contour-area-in-opencv-using-python)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-25T03:37:34.877

你也可以试试这个。minAreaRect 在某些情况下确实失败了，但下面所述的方法总是有效。虽然使用 PIL。

```
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
gray = cv2.GaussianBlur(gray, (5 ,5), 0)
retval,thresh = cv2.threshold(gray, 210, 255, cv2.THRESH_BINARY)
mask=Image.fromarray(thresh)
box = mask.getbbox() 
```

# ndepend - 查询以检测 ISP 违规

> ID：14415818
> 
> 赞同：1
> 
> 时间：2013-01-19T15:27:01.487
> 
> 标签：ndepend

我正在尝试使用 NDepend 创建一个特殊查询，但无法弄清楚。

这是我想用更程序化的伪代码查询的内容：

```
var list
foreach type t
    foreach i = t.attribute that is an interface
        var nm = i.numberOfMethods
        var mu = numberOfMethods that t actually uses
        if mu / nm < 1
        list.Add(t)
    end foreach
end foreach
return list 
```

它应该列出不符合接口隔离原则的类型。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-21T00:51:17.437

所以你问的查询可以这样写：

```
from t in JustMyCode.Types where !t.IsAbstract

from i in t.TypesUsed where i.IsInterface

// Here collect methods of i that are not used
let methodsOfInterfaceUnused = i.Methods.Where(m => !m.IsUsedBy(t))
where methodsOfInterfaceUnused.Count() > 0
select new { t, methodsOfInterfaceUnused } 
```

该查询的特点是多次匹配同一个类型，每次匹配一个`methodsOfInterfaceUnused`不为空。结果很好地呈现并且易于理解：

![NDepend 的隔离原理](../Images/ff8061b5002f05d3af4ddb0f665ef0a5.png)

# sql - transact-sql newbie-error-尝试将多个文件中的数据批量插入 sql server 数据库

> ID：14415820
> 
> 赞同：1
> 
> 时间：2013-01-19T15:27:22.597
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2008-r2

我正在尝试将来自多个文件的数据插入 SQL Server。这是我正在使用的代码——

```
DECLARE @MyCounter int;
DECLARE @Fileprefix nvarchar, @Filesuffix nvarchar, @fullname nvarchar, @Counter_string nvarchar;

SET @MyCounter = 1;
SET @Fileprefix= 'C:\Arvind_gpd\patents\';
SET @Filesuffix='data_corrected.csv';

WHILE (@MyCounter < 10)

BEGIN;
Set @Counter_string= Cast(@MyCounter AS varchar(1) );
Set @fullname = (@Fileprefix+ @Counter_string + @Filesuffix );
BULK INSERT GooglePatentsIndividualDec2012.dbo.patent
FROM  @fullname WITH  ( DATAFILETYPE = 'char', FIELDTERMINATOR = '^', ROWTERMINATOR =     '\n' );
SET @MyCounter = @MyCounter + 1;
END;  
GO 
```

但是我收到这些错误消息-

```
 Incorrect syntax near @fullname. Expecting Integer, String, TEXT_LEX.....
  Incorrect syntax near DATAFILETYPE. Expecting SELECT or '(' 
```

我在上面的查询中做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T15:43:56.517

您不能将变量用作文件名。根据[MSDN](http://msdn.microsoft.com/de-de/library/ms188365.aspx)中描述的语法，它必须是一个常量。

您可以创建命令并使用 EXEC 执行它。

```
set @Command = 'BULK INSERT GooglePatentsIndividualDec2012.dbo.patent '
set @Command = @Command + 'FROM  '''+@fullname+''' WITH  ( '
set @Command = @Command + 'DATAFILETYPE = ''char'', '
set @Command = @Command ü 'FIELDTERMINATOR = ''^'', ROWTERMINATOR =     ''\n'' )'

EXEC (@Command) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:40:48.693

您不能将变量用作表名。如果要使用变量，则必须创建一个字符串并使用如下`EXEC`函数：

```
DECLARE @fullname nvarchar, @sql nvarchar
SET @sql = 'SELECT * FROM ' + @fullname+ ' WHERE id = 1'
EXEC(@sql) 
```

# ios - resizableImageWithCapInsets 图像总是未对齐？

> ID：14415821
> 
> 赞同：0
> 
> 时间：2013-01-19T15:27:24.723
> 
> 标签：ios, uikit, core-graphics

是否可以创建具有可调整大小图像的*正确对齐的 UIImageView？*

我尝试了所有方法（例如图像的两个幂等），但无法使其正常工作。

UIImageView 的坐标为：

```
po _Background

(UIImageView *) $1 = 0x14c42bd0 
<UIImageView: 0x14c42bd0;
frame = (16 38; 992 672);
opaque = NO;
autoresize = LM+RM+TM+BM;
userInteractionEnabled = NO;
layer = <CALayer: 0x14c42ba0>> - (null) 
```

UIImage 本身为 96x96（视网膜，即 png 为 192x192，比例为 2）。可调整大小的 UIImage 是使用以下方法创建的：

```
UIEdgeInsets edgeInsets = UIEdgeInsetsMake(32, 32, 32, 32);
UIImage* resizableImage = [originalImage resizableImageWithCapInsets:edgeInsets];
[_Background setImage:resizableImage]; 
```

在模拟器中打开“颜色未对齐的图像”时，UIImageView _Background 以黄色突出显示。在调试器中删除它的 UIImage：

```
[_Background setImage:nil]; 
```

去除黄色高光，即没有图像 -> 没有错位。

任何人都知道发生了什么以及我如何确保它对齐？

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T15:33:51.673

根据这个答案：[在 iPhone/iOS 上使用“颜色未对齐](https://stackoverflow.com/questions/6283480/what-does-yellow-tinting-represent-when-using-color-misaligned-images-on-iphon)的图像”时黄色表示什么，黄色突出显示图像被*拉伸*。由于这就是您对可调整大小图像的要求，因此总是如此是有道理的。

# javascript - 不要覆盖 但添加到

> ID：14415824
> 
> 赞同：0
> 
> 时间：2013-01-19T15:27:54.870
> 
> 标签：javascript

我制作了一个脚本，当您按下按钮时会在 < div > 中显示内容，但是当我按下另一个按钮时（虽然 < div > 中已经有内容），它会覆盖内容。所以只有新内容显示，旧内容消失。

```
function HandleResponse(response)
{
   document.getElementById('test123').innerHTML = response;
} 
```

所以问题是：我怎样才能将内容添加到 <div> 而不是覆盖 <div> 中的内容？这样我可以在一个 <div> 中显示多个内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:29:43.780

那只是一个小变化:-)

```
function HandleResponse(response)
{
   document.getElementById('test123').innerHTML += response;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T15:29:36.087

您可以`+=`在 DIV 的 innerHTML 中添加内容，这意味着您可以将内容添加到 HTML。

```
document.getElementById('test123').innerHTML += response; 
```

# r - 使用 ggplot2 的箱线图

> ID：14415825
> 
> 赞同：1
> 
> 时间：2013-01-19T15:28:03.127
> 
> 标签：r, boxplot, ggplot2

我对使用 ggplot2 完全陌生，但听说它具有出色的绘图功能。我有一个包含不同样本的列表，并根据三种仪器对每个样本进行观察。我想把它变成一个带有箱线图的数字。我不能包含图形，但下面包含了制作示例图形的代码。我们的想法是为每种仪器提供一个带有每个样本的箱线图的图形。

此外，在图旁边，我想制作一种图例，为每个样本编号命名。我不知道如何使用 ggplot2 开始执行此操作。

任何帮助将不胜感激

生成示例图像的 R 代码是：

```
#Make data example
Data<-list();
Data$Sample1<-matrix(rnorm(30),10,3);
    Data$Sample2<-matrix(rnorm(30),10,3);
Data$Sample3<-matrix(rnorm(30),10,3);
    Data$Sample4<-matrix(rnorm(30),10,3);

#Make the plots
par(mfrow=c(3,1)) ;
boxplot(data.frame(Data)[seq(1,12,by=3)],names=c(1:4),xlab="Sample number",ylab="Instrument 1");
boxplot(data.frame(Data)[seq(2,12,by=3)],names=c(1:4),xlab="Sample number",ylab="Instrument 2");
boxplot(data.frame(Data)[seq(3,12,by=3)],names=c(1:4),xlab="Sample number",ylab="Instrument 3"); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-19T15:29:11.180

首先，您需要以不同的方式设置数据：作为`data.frame`矩阵列表而不是矩阵列表。您需要一列用于`sample`，一列用于`instrument`，一列用于观察`value`。这是一个假数据集：

```
df <- data.frame(sample = rep(c("One","Two","Three","Four"),each=30), 
                 instrument = rep(rep(c("My Instrument","Your Instrument","Joe's Instrument"),each=10),4),
                 value = rnorm(120))

> head(df)
  sample    instrument       value
1    One My Instrument  0.08192981
2    One My Instrument -1.11667766
3    One My Instrument  0.34117450
4    One My Instrument -0.42321236
5    One My Instrument  0.56033804
6    One My Instrument  0.32326817 
```

要获得三个图，我们将使用*faceting*。要获得箱线图，我们使用`geom_boxplot`. 代码如下所示：

```
ggplot(df, aes(x=sample,y=value)) + 
  geom_boxplot() + 
  facet_wrap(~ instrument, ncol=1) 
```

![在此处输入图像描述](../Images/69b79f1f58a68c5f0ed03127cecd3f4e.png)

如果您将名称直接放在样本变量中，它将不包含样本编号的图例，而是将它们打印在图下方。这样，人们就不必在名称中引用数字：立即清楚每个图的样本是什么。请注意，ggplot 默认情况下按字母顺序排列因子；如果您想要不同的顺序，您必须手动更改它。

# javascript - 使用 jQuery 更改 div 标签中的特定标签

> ID：14415826
> 
> 赞同：0
> 
> 时间：2013-01-19T15:28:09.050
> 
> 标签：javascript, jquery, html

我有一个 div 标签：

```
<div id="content"><p></p><a href="#"></a></div> 
```

我想将动态不同的内容插入`<p>`标签以及标签的**href**属性中`<a>`。

我正在使用 jQuery。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T15:29:25.790

一样容易：

```
$("#content > p").html("Some content");
$("#content > a").prop("href", "/new/link.html"); 
```

或链式：

```
$("#content")
  .find("p").html("Some content")
    .end()
      .find("a").prop("href", "/new/link.html"); 
```

# ruby-on-rails - 将 redmine 推送到子域的根目录

> ID：14415828
> 
> 赞同：2
> 
> 时间：2013-01-19T15:28:22.303
> 
> 标签：ruby-on-rails, apache, redmine, passenger

我刚刚安装了 redmine，我想从 redmine.domain.com 而不是 domain.com/redmine 访问它。

我首先尝试用我很少的 Apache 知识自己做这件事，但我得到了以下错误： ![无法启动 Ruby On Rails 应用程序](../Images/427541256d6979c8fa65e34bb7e6095d.png)

所以我在互联网上寻找支持并找到[了这个页面](http://www.modrails.com/documentation/Users%20guide%20Apache.html#_deploying_to_a_virtual_host_8217_s_root_2)。因此，我调整了我的 Apache 配置文件：

```
<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName  redmine.mydomain.com
    ServerAdmin admin@mydomain.com
    DocumentRoot /var/www/redmine

    <Directory /var/www/redmine>
        Allow from all
        Options -MultiViews
    </Directory>

    ErrorLog ${APACHE_LOG_DIR}/error.log
    LogLevel warn
    CustomLog ${APACHE_LOG_DIR}/ssl_access.log combined

    SSLEngine on
    SSLCertificateFile    /etc/ssl/private/redmine.mydomain.com.crt
    SSLCertificateKeyFile /etc/ssl/private/redmine.mydomain.com.key
</VirtualHost>
</IfModule> 
```

并做了一些检查，一切似乎都很好。但是，当我访问 redmine.mydomain.com 时，我看到了 /usr/share/redmine/public 的层次结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T20:59:16.977

要从您链接到的页面中引用：

> 虚拟主机的文档根目录必须指向 Rack 应用程序的公用文件夹。

因此，您必须将 Apache 配置`DocumentRoot`为指向`/var/www/redmine/public`.

# .net - F# 编译器和运行时版本号混淆

> ID：14415831
> 
> 赞同：7
> 
> 时间：2013-01-19T15:28:34.830
> 
> 标签：.net, f#, mono, nuget

我无法确定哪个版本的 F# Core 运行时库应该与 Mono 平台 (.NET 3.5) 结合使用。

*   与 Microsoft .Net 4.5 一起安装的 FSharp Core 运行时有两个版本，2.3.0.0 和 4.3.0.0。我的猜测是第一个用于 .NET framework 2.0 及更高版本，而第二个只能用于 .NET 4.0 或更高版本。这个假设正确吗？
*   由于 FSharp 现在是开源的并且在 Github 上可用，我可以查看最近的标签，构建它并使用它在我的项目中生成的 FSharp.Core dll。我不知道开源 FSharp 上的版本号与 .NET 包中包含的闭源版本有什么关系？
*   开源编译器版本现在是3.0.25，闭源编译器好像是4.0，我一头雾水：
    *   开源项目中的 FSharp.Core Runtime 版本（也是 3.0.25）与闭源 2.3.0.0 版本有何关系？由于数字 3.0.25 远高于 2.3.0.0 我假设开源版本要新得多，但我不太确定，因为我不知道是否可以比较版本号。
    *   另一方面，NuGet 提供 FSharp.Core 2.0 和 4.0，这似乎已经很老了。为什么新版本还没有上传到 NuGet？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-19T21:44:49.833

您将两种不同的版本号混为一谈；不过，这并不是我责怪你——我理解如果你是 F# 和/或 .NET 的新手，这可能会让你感到困惑。

*   正确的。FSharp.Core`2.3.0.0`版本用于 .NET 2.0（以及 3.0 和 3.5，它们（基本上）是 .NET 2.0 的扩展版本）；该`4.3.0.0`版本适用于 .NET 4.0 和 4.5。
*   F# 的最新版本是 F# 3.0。这是 Visual Studio 2012 附带的版本。**注意：**这里，3.0 是*语言*版本，与您要运行的 .NET Framework 版本无关。GitHub 上的 F# 存储库使用修订标签（即 3.0.25 的**.25**部分），因此更容易判断您是否需要更新到较新的版本；更改通常只是构建脚本、安装程序等——但很少更改 F# 编译器和/或库。
*   如果您从 F# GitHub 存储库构建代码并且编译后的 FSharp.Core 程序集版本为 3.0.25，请在 Github 上打开一个关于此问题的新问题——它应该与 Microsoft 的“真正”F# 库具有相同的版本号. 唯一的区别应该是签署程序集的公钥。
*   我不知道为什么新版本不在 NuGet 上——它可能只是被遗忘了。我现在将打开一个关于此的问题，以确保尽快添加它们。

# java - 十六进制字符串到 int 的转换无法正常工作

> ID：14415834
> 
> 赞同：2
> 
> 时间：2013-01-19T15:28:44.677
> 
> 标签：java, android, hex

我有一个十六进制数字（一种颜色）存储在一个字符串中，如下所示：“ff62e6b8”。我需要将其转换回整数，以便再次将其用作颜色值。我尝试了以下方法：

```
Int i = Integer.parseInt("ff62e6b8", 16);
Int i = Integer.valueOf("ff62e6b8", 16);
Int i = Integer.decode("ff62e6b8"); 
```

但是所有这些方法都会引发异常。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T15:31:04.607

FF62E6B8 是十进制的 4284671672。把它放进去简直太大了`int`。您可以在`int`其中存储与范围匹配的值`<-2^31 - 1 ; 2^31 - 1>`。尝试`long`改用：

```
Long i = Long.parseInt("ff62e6b8", 16);
Long i = Long.valueOf("ff62e6b8", 16);
Long i = Long.decode("ff62e6b8"); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-19T15:33:41.857

试试这个：

```
int colorVal = Color.parseColor("#ff62e6b8"); 
```

**例子 ：**

```
myLayout.setBackgroundColor(Color.parseColor("#ff62e6b8")); 
```

通过这个你会得到`colorVal = -10295624`。

如果您想**从 colorVal 生成 hexColor 代码，请**使用：

```
String hexColor = String.format("#%06X", (0xFFFFFF & colorVal)); 
```

通过这个你会得到`hexColor = #62E6B8`。

谢谢。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-19T15:36:32.417

第一个会是好的

但 ff62e6b8 超过了 int 的大小（32 位 - 有符号），这就是引发异常的原因。

```
Long l = Long.parseLong("ff62e6b8", 16); 
```

应该做的工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-19T15:32:09.843

```
String hex = "1B";
int val = Integer.parseInt(hex, 16); 
```

那是正确的转换。

# python - 是否有生成配置文件和验证脚本的框架

> ID：14415838
> 
> 赞同：0
> 
> 时间：2013-01-19T15:29:25.260
> 
> 标签：python, configuration, installation

我需要为客户部署一个复杂的系统。有许多配置文件包含大约两百个客户应该修改的参数。手动修改配置文件很棘手，很容易出错。所以我想提供一种用户友好的方式。

*   我准备了所有包含占位符的配置文件，例如配置文件模板；
*   所有占位符的key放在一个文件中，用户在其中填写所需信息，我将其命名为信息文件；稍后，我可能会提供一个 HTML 和 js 来生成信息文件，这样客户只需在 HTML 表单中填写信息。

    无论是信息文件还是 HTML 都需要注释来告诉客户他们应该填写什么；

    从客户那里得到的信息文件应该是经过验证的，至少是语法验证；

*   最后，我可以使用上述两个输入生成目标配置文件；

我需要准备的是配置文件模板、信息文件和验证脚本。这项工作有点无聊。我想使用元数据来生成信息文件和验证脚本。

是否有任何框架可以做这样的工作或更明智的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T17:34:19.023

您可能想查看[ConfigObj](http://pypi.python.org/pypi/configobj/)包（[主页](http://www.voidspace.org.uk/python/articles/configobj.shtml)）。这至少有一些你正在寻找的东西，一种设置默认值和验证值的简单方法。简单验证看起来很容易设置，如果您需要更复杂的东西，您可以编写自定义验证方法。

编写一个创建配置文件的HTML前端应该比较容易，然后可以将生成的配置文件通过ConfigObj传递。

# javascript - AngularJS 动态注入作用域或控制器

> ID：14415845
> 
> 赞同：15
> 
> 时间：2013-01-19T15:30:00.720
> 
> 标签：javascript, angularjs

是否可以在运行期间注入作用域或控制器？或任何其他将服务动态注入控制器的建议？

```
Application.controller('IndexController', function($scope){

    // some actions

    if(someconditions) {
            $scope.$inject = [someServiceName];
            // and here i want to use service methods 
    }

}); 
```

提前致谢

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-01-19T20:11:32.037

可以使用[$injector](http://docs.angularjs.org/api/AUTO.%24injector)将服务动态注入（按名称）到控制器中。能够通过控制器参数注入服务只是 Angular 提供的一种便利。在底层，Angular 使用 $injector 来检索对象实例。但是我们也可以自己使用 $injector。

```
function MyCtrl($scope, $injector) {
  $scope.doSomething = function(someService) {
    var service = $injector.get(someService)  // someService contains the name of a service
    service.value += 10
} 
```

[小提琴](http://jsfiddle.net/mrajcok/vaANv/)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-04-23T09:56:03.283

以下是我最近遇到的一个用例，我试图在 Factoy 中注入服务“myService”并得到以下错误。

```
**Uncaught Error:** *[$injector:cdep] Circular dependency found: $http <- $modal <- myService <- interceptorFactory <- $http <- $templateRequest <- $compile*

[http://errors.angularjs.org/1.3.0/$injector/cdep?p0=%24http%20%3C-%20%24mod%E2%80%A6orFactory%20%3C-%20%24http%20%3C-%20%24templateRequest%20%3C-%20%24compile][1] 
```

为了解决这个问题，$injector 成为了救命稻草

```
var service = $injector.get('myService') //this will create a dynamic service instance 
```

现在您可以像在应用程序中使用其他服务一样使用该服务。

# c# - 从子窗体填充到另一个子窗体

> ID：14415851
> 
> 赞同：0
> 
> 时间：2013-01-19T15:31:01.927
> 
> 标签：c#, mdi

在我的项目中，我有一个带有`mdiMother`两个`childform` *(mdiChild1 和 mdiChild2)*的 mdi 容器。有`mdiChild1`一个`listview` *（模式查看详细信息）*。有`mdiChild2`一个按钮来填充`listview`in `mdiChild1`。

我做了一些和平的代码。我将此代码复制到 中`mdiChild1`，创建一个按钮，尝试它并且它有效*（意思是：我看到了`listview`填充）*。

**我的问题：**
当我按下按钮时`mdiChild2`，我`listview`没有在代码中填充相同`mdiChild1`的代码来完成这项工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:53:29.043

您必须从 控制孩子的控件`mdiMother`。

从每个创建`static`实例`mdiChild`，之后当您想从每个实例调用方法时，您必须从这些`static`实例中使用。

像这样：

```
public class mdiMother{
    public static mdiChild1 ch1;
    public static mdiChild2 ch2;

    public mdiMother(){
       ch1 = new mdiChild1();
       ch2 = new mdiChild2();
    }
}

public class mdiChild1{
    public void Do(){
       // fill list
    }
}

public class mdiChild2{
    public void CallMdiChild1(){
       mdiMother.ch1.Do();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T12:27:51.743

谢谢大家。我解决了我的问题，我发现它太愚蠢了。那样它没有填充：不要参考良好的形式。为了完成这项工作，我对活跃的 mdi 孩子做了一个参考......它的工作:)

感谢大家的帮助......感谢艾哈迈德，他为我提供了找到解决方案的好方法：p

# c - C中的双向链表

> ID：14415852
> 
> 赞同：-1
> 
> 时间：2013-01-19T15:31:02.967
> 
> 标签：c, list

```
#include<stdio.h>

typedef struct Node
{
        int data;
        struct Node *next;
        struct Node *prev;
} node;

void insert(node *pointer, int data)
{
        while(pointer->next!=NULL)
        {
                pointer = pointer -> next;
        }
        pointer->next = (node *)malloc(sizeof(node));
        (pointer->next)->prev = pointer;
        pointer = pointer->next;
        pointer->data = data;
        pointer->next = NULL;
}

int main()
{
        node *start;
        start = (node *)malloc(sizeof(node));
        int data;
        scanf("%d",&data);
        insert(start,data);
} 
```

好吧，我正在尝试了解 C 中列表的基础知识。我在这里有一个问题 - insert() 底部的第 3 行 - 这是为了什么？似乎第一个列表的元素保持为空并且数据正在保存到第二个列表中。但只有这个有效。

在 main() 中创建了第一个空元素，对吗？

while() 不执行，因为元素为空。

然后正在创建第二个元素。（指针->空）

指向第一个元素的指针设置为指向第二个元素（从底部算起的第 3 行）

数据被保存到第二个元素。

我在哪里犯错？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:58:15.813

```
pointer = pointer->next; 
```

这一行将我们关注的当前节点从原始列表的最后一个节点更改为新分配的新列表的最后一个节点（即原始列表最后一个节点之后的节点）。然后我们直接在接下来的两行中设置该节点的值。

您可以摆脱这一行并将其下方的两行更改为阅读

```
pointer->next->data = data;
pointer->next->next = NULL; 
```

你会得到同样的结果。

编辑：进一步研究，我看到了更多问题：

1）您需要`#include <stdlib.h>`使用`malloc()`.
2）您需要`start->next = NULL;`在调用之前明确设置`insert()`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T15:36:35.800

~~在你的`insert`函数中，你有这个任务：~~

 ~~```
pointer = pointer->next; 
```~~ 

这不起作用，因为指针`pointer`是按值传递的。这意味着当函数返回时，对值的所有更改都将丢失。

您可以通过引用传递指针：

```
void insert(node **pointer, int data)
{
    /* ... */
    *pointer = (*pointer)->next;
    /* ... */
} 
```

或者从函数返回指针：

```
node *insert(node *pointer, int data)
{
    /* ... */
    return pointer;
} 
```

 ~~* * *

还有一个问题是您没有初始化`node`结构中的指针。这意味着当您分配`node`结构时，其中的字段将指向看似随机的位置。

这可以通过在分配后直接设置`next`and`prev`指针来解决：`NULL`

```
start = malloc(sizeof(node));
start->next = NULL;
start->prev = NULL; 
```~~

# wpf - WPF 中不存在另一个名称的问题

> ID：14415854
> 
> 赞同：4
> 
> 时间：2013-01-19T15:31:09.710
> 
> 标签：wpf, c#-4.0, mvvm, visual-studio-2012

在本项目中，代码**编译执行正常**；但是，我需要帮助解决两个问题：

1.  VS2012 WPF 设计器不适用于此 XAML 文件。它显示消息*设计视图对于 x64 和 ARM 目标平台不可用*。

2.  我收到以下消息*The name "EnumConverter" doesn't exist in the namespace "clr-namespace:VideoDatabase.Enums"*。同样，这不会干扰编译或执行项目。

这是 XAML：

```
<Window x:Class="VideoDatabase.Views.SortingView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:VideoDatabase.Enums"
        Title="Sort and Filter" SizeToContent="WidthAndHeight" ResizeMode="NoResize"
        Background="LightGray">
    <Window.InputBindings>
        <KeyBinding Gesture="Escape" Command="{Binding CloseWindowCommand}"/>
    </Window.InputBindings>
    <Window.Resources>
        <!-- Next line generates Intellisene error; however, the code compiles and executes -->
        <local:EnumConverter x:Key="enumConverter"/>
    </Window.Resources> 
```

这`EnumConverter`是 VideoDatabase.Enums 命名空间中的公共类，位于当前程序集中。这是该类的代码片段：

```
namespace VideoDatabase.Enums
{
    public class EnumConverter : IValueConverter
    {
        public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            string parameterString = parameter as string;
            if (parameterString == null)
                 return DependencyProperty.UnsetValue;

            if (Enum.IsDefined(value.GetType(), value) == false)
                return DependencyProperty.UnsetValue;

            object parameterValue = Enum.Parse(value.GetType(), parameterString);

            return parameterValue.Equals(value);
        }

        public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
        {
            string parameterString = parameter as string;
            if (parameterString == null)
                return DependencyProperty.UnsetValue;

            return Enum.Parse(targetType, parameterString);
        }
    }
} 
```

到目前为止，我已经检查了以下内容：

*   确认目标框架是 .NET Framework 4.5
*   确认`EnumConverter`课程在主程序集中
*   如果我注释掉`<local:EnumConverter x:Key="enumConverter"/>`设计师的作品。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T17:07:04.927

您很可能已将构建目标平台设置为仅 x64 位。

然后发生的事情是您的输出程序集仅为 64 位，基于 x86 的 WPF 设计器无法加载。

转到项目属性->`Build->Target Platform`并将其设置为`Any`.

编辑：如果您有需要从 32 位 WPF 设计器访问的程序集/代码（在本例中为值转换器），那么您必须将它们与其他 64 位程序集分开。我很难找到为什么值转换器需要位于 64 位 DLL 中的任何原因，而不是像您的情况那样的硬依赖。

如果这对你来说是不可能的，我认为你将不得不忍受你不能在你的场景中使用设计器的事实。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-04-29T20:38:49.863

我相信您的问题是，由于某种原因，WPF 程序集在构建时不喜欢查看其他程序集。它默认认为您引用的任何命名空间都在调用程序集中，因此您所说的行

```
xmlns:local="clr-namespace:VideoDatabase.Enums" 
```

被 WPF 引擎解释为

```
xmlns:local="clr-namespace:VideoDatabase.Enums;assembly=thisAssembly" 
```

您有时可以通过将程序集的构建配置更改为不同的体系结构和东西来获得更进一步，但通常当您尝试加载包含尝试读取枚举的组件的页面时，它仍然会崩溃。您需要做的是指定您的枚举所在的程序集，如：

```
xmlns:local="clr-namespace:VideoDatabase.Enums;assembly=enumAssembly" 
```

你应该准备好了吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:25:39.647

是不是因为你缺少转换器的预编译器......就像......

```
[ValueConversion(typeof(changing from type), typeof( changing TO type))]
public class BoolToVisibility : IValueConverter
{
   public object Convert(object value, Type targetType, object parameter, CultureInfo culture)

} 
```

# ruby-on-rails-3 - Rails：update_column 有效，但 update_attributes 无效

> ID：14415857
> 
> 赞同：25
> 
> 时间：2013-01-19T15:31:34.640
> 
> 标签：ruby-on-rails-3, updates

我有一个简单的模型：

```
class Reply < ActiveRecord::Base
  attr_accessible :body
  belongs_to :post
end 
```

在我的控制器中，我有一个简单的更新方法：

```
def update
  @reply = Reply.find(params[:id])
  if @reply.update_attributes!(params[:reply])
    render :js => "alert('I am trying to update!')"
  else
    render :js => "alert('<%= @reply.errors %>')"
  end
end 
```

这不会引发错误，但实际上也不会更新回复。相反，我得到“我正在尝试更新！” 消息，就像一切正常。但是当我重新加载页面并查看回复时，它具有相同的文本。它实际上并没有更新。如果我将 update_attributes 替换为：

```
@reply.update_column(:body, params[:reply][:body]) 
```

它工作正常。如果我使用：

```
@reply.update_attribute(:body, params[:reply][:body]) 
```

它再次不起作用。知道发生了什么吗？

在我的日志中，我有这个：

```
Started PUT "/posts/2/replies/20" for 127.0.0.1 at 2013-01-19 10:39:57 -0600
Processing by RepliesController#update as JS
Parameters: {"utf8"=>"✓", "authenticity_token"=>"Xot7E+ldXiBm0hVvw5XUP/U5guJU2g8e4QaLbDVGzDE=", "reply"=>{"body"=>"Updated text."}, "commit"=>"Submit Revision", "post_id"=>"2", "id"=>"20"
[1m[35mUser Load (1.0ms)[0m  SELECT `users`.* FROM `users` WHERE `users`.`id` = 1 LIMIT 1
[1m[36mReply Load (0.0ms)[0m  [1mSELECT `replies`.* FROM `replies` WHERE `replies`.`id` = 20 LIMIT 1[0m
[1m[35m (1.0ms)[0m  BEGIN
[1m[36mPost Load (0.0ms)[0m  [1mSELECT `posts`.* FROM `posts` WHERE `posts`.`id` = 2 LIMIT 1[0m
[1m[35m (0.0ms)[0m  COMMIT
Rendered replies/_reply_content.html.erb (502.0ms)
Rendered replies/update.js.erb (505.0ms)
Completed 200 OK in 849ms (Views: 484.0ms | ActiveRecord: 94.0ms) 
```

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2013-01-19T16:42:06.943

您使用的三种方法做不同的事情：

*   `update_attributes`尝试**验证**记录，调用**回调**并**保存**；
*   `update_attribute`不验证记录，调用**回调**并**保存**；
*   `update_column`不验证记录，不调用回调，**不调用保存**方法，尽管它**确实更新**了数据库中的记录。

如果我猜唯一“有效”的方法`update_column`是你在某个地方有一个抛出错误的回调。尝试检查您的`log/development.log`文件以了解发生了什么。

您也可以使用`update_attributes!`. 此变体将引发错误，因此它可能会为您提供有关模型未保存的原因的信息。

`update_attributes`除非您确切知道自己在做什么，否则您应该使用并避免使用其他两种方法。如果您稍后在模型中添加验证和回调，使用`update_attribute`and`update_column`可能会导致非常难以调试的令人讨厌的行为。

您可以查看[此链接](http://maxivak.com/update_attribute-and-update_attributes-ruby-on-rails/)以获取更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T15:50:47.850

一个直觉的猜测是说你有一个质量分配问题，应该像这样在你的模型中添加你的属性

```
attr_accessible: :your_attribute, :your_attribute2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-30T03:34:08.423

我遇到了同样的问题，但是使用 Rails 4。当您在 update_attribute 中有 params[] 时，就会出现问题。在具有强参数的 Rails 4 中

```
@reply.update_attributes(params[reply_params]) 
```

应该

```
@reply.update_attributes(reply_params) 
```

我不熟悉 Rails 3，但这应该是问题所在：

```
@reply.update_attributes(params[:reply]) 
```

应该

```
@reply.update_attributes(:reply) 
```

# android - 处理来自多个意图服务的 http 调用是好方法吗？

> ID：14415858
> 
> 赞同：4
> 
> 时间：2013-01-19T15:31:55.477
> 
> 标签：android, rest, design-patterns, structure, intentservice

我正在开发restful android应用程序，但我还是android新手，我想避免初学者床结构设计，这会给我带来麻烦。

我已经阅读了很多关于 android 服务和 restful 应用程序的讨论，其中许多是相互矛盾的，所以我想知道我是否选择了一个好的方法。

受此演示文稿[http://www.youtube.com/watch?v=xHXn3Kg2IQE](http://www.youtube.com/watch?v=xHXn3Kg2IQE)的启发，我将 http 请求放入 IntentServices，而不是异步任务。

我选择 Intent Service 是因为：

*   作为一项服务，它们对诸如活动之类的前台/后台切换不敏感（不会被杀死）。
*   Intent 服务在单独的线程中提供工作，因此用户界面保持响应。

由于 Intent Service 不能同时运行多个请求，因此我将我的域“拆分”为几个组，并为每个组编写了我的 Intent Service。（结束于：一个 CRUD 集 -> 一个意图服务）这样我得到一个组内部一次只能运行一个请求（这对我有好处，因为这种方式永远无法执行例如在同一单元更新和删除）。而且，另一方面，如果它们来自其他组，我可以同时运行多个请求，并且不会相互影响。

所以基本上，我有这个：

*   一个通用的 HTTPRequest 类，它从名称值对构建请求

*   UserIntentService - 创建用户相关请求并使用 HTTPRequest cass 执行它，并使用 UserProcessor 处理请求。通过数据意图通知调用者。

*   CallIntentService - 创建调用相关请求并使用 HTTPRequest cass 执行它，并使用 CallProcessor 处理请求。通过数据意图通知调用者。

*   UserProcessor - 解析响应

*   CallProcessor - 解析响应

*   ServiceHelper - 找到并启动正确的意图服务

从活动中使用时，我使用类似这样的东西：SeviceHelper.StartService（动作，数据），我得到活动内部本地广播接收器的响应。我在 OnStart() 上注册接收器，并在活动的 onStop() 方法上取消注册它。

这是一个好方法吗？

我应该只为所有呼叫提供一个 IntentService 吗？拥有一个始终在后台运行的服务，而不是使用必须为每个请求启动的 Intent 服务会更好吗？

我缺少的这种方法是否还有其他可能变得糟糕的事情？

# ruby-on-rails - heroku rails - 所有命令都给出“未指定帐户”

> ID：14415859
> 
> 赞同：1
> 
> 时间：2013-01-19T15:31:59.393
> 
> 标签：ruby-on-rails, ruby, heroku, ssh, key-generator

**[注意：这不是关于使用--app appName，这是一个不同的问题]**

由于同时进行工作和个人 github 项目，我的机器混淆了它的 git/heroku 设置。我正在尝试恢复默认值，但找不到所有“工件”。

尝试执行命令，例如

```
heroku keys
heroku keys:add
heroku keys:clear 
```

甚至试图再次添加我的密钥！

```
heroku keys:add --app blazing-planet-3592 
```

都在给我

```
durrantm.../linker$ heroku keys:clear
Removing all SSH keys... failed
 !    No account specified.
 !    
 !    Run this command with --account <account name>
 !    
 !    You can also add it as a git config attribute with:
 !      git config heroku.account work 
```

我最近安装了 heroku 帐户来管理多个帐户。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-19T15:50:08.607

我的问题的关键是我需要添加`--account personal`到我使用的每个命令中以引用文件`~/.heroku/account/personal`（我在开始使用 heroku 'accounts' 功能时创建的），其中包含我的信息：

```
$ cat ~/.ssh/accounts/personal
:username: m2@snap2web.com
:password: b1951...868b6 
```

所以我的命令只需要：

```
$ heroku keys --account personal
$ heroku keys:add --account personal
$ heroku keys:clear --account personal
$ heroku keys:add --app blazing-planet-3592 --account personal 
```

我随后还运行了 heroku account:add work，然后为我用于工作的（不同的）帐户输入了我的 WORK 凭据（出现提示时的电子邮件和密码）。

它告诉我在我的 .ssh/config 文件中添加一些东西——

将以下内容添加到您的 ~/.ssh/config

```
Host heroku.work
  HostName heroku.com
  IdentityFile /PATH/TO/PRIVATE/KEY
  IdentitiesOnly yes 
```

但我暂时不做这件事（欢迎提出有关选项的建议，何时需要等）。

# javascript - 使用 1x1 标签设置第三方 cookie - Javascript 不会丢弃 cookie

> ID：14415860
> 
> 赞同：4
> 
> 时间：2013-01-19T15:32:02.060
> 
> 标签：javascript, cookies, image, party

我一直在尝试使用以下方法设置第三方 cookie：

站点A

```
<img src="http://www.siteB.co.uk/cookie.php" /> 
```

站点B

```
<script>

    document.cookie = "name=thirdpartytest; expires=07/07/2013; path=/;domain=SiteB.co.uk";

</script> 
```

当我直接访问 SiteB/cookie.php 时，cookie 会按预期下降。但访问 SiteA 不会丢弃任何 cookie。

当我使用相同的方法但使用 PHP 删除 cookie 时，效果很好。Javascript 在这种情况下不会删除 cookie 有什么原因吗？我认为这可能是因为没有发送 HTTP 内容类型标头来说明 .php 页面是图像。但我似乎并不需要 PHP 版本的代码才能工作。

任何想法如何使用 JS 使其工作？甚至可能吗？例如，Doubleclick 如何使这项工作发挥作用？

供参考：这是成功删除 cookie 的 PHP 代码

```
<?php 
$CookieName = "my3Pcookie";    // Cookie's name
$CookieValue = "hello, there"; // Cookie's value
$CookieDirectory = "/";        // Cookie directory ("/" for all directories)
$DaysCookieShallLast = 31;     // Days before expiration (decimal number okay.)

$lasting = ($DaysCookieShallLast<=0) ? "" : time()+($DaysCookieShallLast*24*60*60);
setcookie($CookieName,$CookieValue,$lasting,$CookieDirectory);

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T19:23:50.237

您的问题绝对基于`<img>`您正在使用的 -tag 。不会在图像中执行任何 JavaScript 代码。

如果您通过 PHP 执行此操作，它之所以有效，是因为服务器在请求文件时正在预处理您的代码。尽管这可能不会向您显示任何内容，因为您没有提供任何有效的图像标题。

如果您使用`<iframe>`-tag 一切都会正常工作，因为客户端可以读取和执行您的 JS 代码：

```
<iframe src='http://www.siteB.co.uk/cookie.php'></iframe> 
```

但是，如果您尝试通过`<img>`-tag 设置 cookie，则需要`server-side`在此示例中使用 PHP 之类的语言进行设置。

Doubleclick 等机构使用 iframe、您可以插入页面的 javascript 片段或|和服务器端解决方案。

希望这可以帮助。

# php - 从数据库下载

> ID：14415864
> 
> 赞同：0
> 
> 时间：2013-01-19T14:12:07.140
> 
> 标签：php, download, database

我对 php 内容配置有一个小问题，我有点理解问题出在哪里，但我不知道如何解决它（使用数据库的新手）。调用这个 php 页面将导致不显示任何回声，只显示下载框，我只打算用于“cv”（不确定它是否以这种方式工作，因为我收到的可下载文件无法打开）

删除该`header(content...`行将导致显示回声，但我将无法下载指定的文件。我希望它显示为单击时会下载其内容的链接。

```
$newEmployeeName = $_POST['name'];
$newEmployeeArea = $_POST['area'];
$newEmployeeCV   = $_POST['cv'];

include('databaseConnection.php');

$result = mysql_query("SELECT * FROM participants");

while($row = mysql_fetch_array($result))
{
  $download_me = $row['cv'];
   header("Content-Disposition: attachment; filename=$download_me");

  echo $row['name'] . " " . $row['area_of_exp'] . " " . $download_me;
  echo "<br />";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T15:39:01.937

标`Content-Disposition`头将强制脚本将其后回显的任何内容作为下载呈现。您通常会在从文件系统读取文件时使用它，因此您可以将其作为下载提供。在您的情况下，如果您将 CV 存储在您的服务器上，那么您可以将它们作为下载提供，如下所示：

```
<?php

$sql = "SELECT * FROM table WHERE id = :id LIMIT 1";
$stmt = $db->prepare($sql);
$stmt->bindParam(':id', $id, PDO::PARAM_INT);
$stmt->execute();

$row = $stmt->fetchObject();

if ($row) {
    header('Content-Disposition: attachment; filename=' . $row['filename']);
    readfile($uploads_dir . $row['filename']);
    exit;
}
else {
    die('Invalid CV requested.');
} 
```

显然，以上是该过程的简化版本，您需要对其进行调整以适合您的应用程序，但这就是它的要点。

另外，不要使用这些`mysql_`功能。它们已被弃用（根据[此页面](http://php.net/manual/en/function.mysql-query.php)上的警告）。使用[PDO](http://php.net/manual/en/book.pdo.php)或新的[MySQLi](http://php.net/manual/en/book.mysqli.php)（MySQL 改进）扩展。

# c - 如何将 libnet 与 cmake（和 kdevelop）一起使用？

> ID：14415875
> 
> 赞同：1
> 
> 时间：2013-01-19T15:33:42.687
> 
> 标签：c, cmake, kdevelop, libnet

恐怕我的问题可能很愚蠢，但由于我是 kdevelop 和 cmake 的新手，所以我很难理解它们是如何工作的。我尝试设置的项目使用 libnet 1.1 库。我的问题是如何让 cmake 编译和链接这个库，以便我可以正确使用它？

这是我已经尝试过的：

```
PROJECT(test)

include_directories("${PROJECT_SOURCE_DIR}/libnet")
add_subdirectory(libnet)

ADD_EXECUTABLE(test main.c)
target_link_libraries(test libnet) 
```

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T18:10:26.000

看起来 libnet 本身不使用 CMake，因此您将不得不单独构建它或使其成为您自己项目的一部分。

要单独构建它，您有几个选择。您可以构建它（如果需要，也可以安装它），然后使用它[`find_library`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3afind_library)来定位实际的 libnet.a / libnet.lib 文件。

```
find_library(libnet NAMES net libnet PATHS <wherever you built it to>)
include_directories(<wherever you built it to>/include)
target_link_libraries(test libnet) 
```

CMake 提供了一种通过使用[`ExternalProject_Add`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#module%3aExternalProject). 这使用起来有点棘手，但您可以在一个命令中下载、提取、构建和安装 libnet。看起来 libnet 有几种不同的构建方式，具体取决于平台，所以这可能不太简单。

另一种选择是将 libnet 源包含在您自己的项目中，并通过[`add_library`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3aadd_library). 您需要创建一个 libnet 源列表，并检查 libnet makefile 以检查需要在您自己的 CMakeLists.txt 中进行特殊处理的任何编译器标志/怪事

这可能是最好的选择，因为它使您可以访问 IDE 中的完整 libnet 源代码树，允许您微调 libnet 构建，并且如果 libnet 构建发生更改会导致您自己的项目过时（需要重新构建） .

```
set(LibnetSources <list all sources and headers>)
add_library(libnet ${LibnetSources})
include_directories(${PROJECT_SOURCE_DIR}/libnet/include)
target_link_libraries(test libnet) 
```

您*可以*使用[`file(GLOB...)`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command%3afile)来帮助生成 libnet 源列表，但不建议这样做，因为 CMake 不会自动检测到文件的添加或删除。你需要确保如果你这样做，在尝试重新编译之前手动重新运行 cmake。如果您不打算添加/删除任何 libnet 文件，这不是问题。

* * *

### 编辑：使用 ExternalProject 模块

好的，第三个选项可能是最好的，但设置起来可能有点复杂；使用 CMake 的[`ExternalProject`模块](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#module%3aExternalProject)。这旨在允许构建外部依赖项——即使是不使用 CMake 的依赖项。这是一篇关于使用它的[不错的文章。](http://www.kitware.com/media/html/BuildingExternalProjectsWithCMake2.8.html)

尝试用这个替换你的 CMakeLists.txt（只在 Ubuntu 上用 gcc 测试过）。简而言之，它会下载 libnet，对其进行配置、构建并将其安装到您的构建树（而不是 /usr/local）。然后，您的可执行文件可以包含并链接到它。

```
# Minimum version 2.8.5 since we need ExternalProject module
cmake_minimum_required(VERSION 2.8.5 FATAL_ERROR)
project(test)

# Enable ExternalProject CMake module
include(ExternalProject)

# Set default ExternalProject root directory
set_directory_properties(PROPERTIES EP_PREFIX ${CMAKE_BINARY_DIR}/ThirdParty)

# Add libnet
ExternalProject_Add(
    libnet
    URL http://packetfactory.openwall.net/libnet/dist/libnet.tar.gz
    TIMEOUT 30
    CONFIGURE_COMMAND <SOURCE_DIR>/configure --prefix=<INSTALL_DIR>
    BUILD_IN_SOURCE ON
    # Wrap download, configure, build and install steps in a script to log output
    LOG_DOWNLOAD ON
    LOG_CONFIGURE ON
    LOG_BUILD ON
    LOG_INSTALL ON)

# Specify include dir
ExternalProject_Get_Property(libnet install_dir)
include_directories(${install_dir}/include)

# Add test executable target
add_executable(test main.c)

# Create dependency of test on libnet
add_dependencies(test libnet)

# Specify test's link libraries
target_link_libraries(test ${install_dir}/lib/libnet.a) 
```

# android - 我试图在我的 pc Eclipse 上使用我的 HTC 相机，但我得到了错误：

> ID：14415876
> 
> 赞同：0
> 
> 时间：2013-01-19T15:33:48.613
> 
> 标签：android

这是文件的内容：MainActivity.xml

```
package com.example.camera_test;

import android.os.Bundle;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Intent;
import android.hardware.Camera;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;

public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button button = (Button) findViewById(R.id.button1);

        button.setOnClickListener(new OnClickListener()
        {
        @SuppressLint("NewApi") @Override
        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            Intent intent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE );
            int i = Camera.getNumberOfCameras();
            TextView age = (TextView) findViewById(R.id.textView1);
            age.setText(i);
            startActivityForResult( intent, 0 );
        }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

效果很好，我点击了按钮，它在我的设备上打开了相机应用程序！但是一旦我添加了这些行：

```
int i = Camera.getNumberOfCameras();
            TextView age = (TextView) findViewById(R.id.textView1);
            age.setText(i); 
```

我在我的设备上收到错误说 nned 强制关闭。

我也尝试过 age.setText(I); 这个：

```
age.setText(Integer.toString(i)); 
```

我试过而不是 id.textView1 也 id.button1 但没有工作。

这是 activity_main.xml 文件的内容：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:layout_marginRight="45dp"
        android:layout_marginTop="62dp"
        android:text="Activate The Camera" />

</RelativeLayout> 
```

这是我唯一更改的两个文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T23:48:01.693

Solution. Now when I click the button I see the camera then take a photo click on Done then I see the image I took on a small window in my device !

This is the MainActivity.Java fileL:

```
package com.example.camera_test;

import android.os.Build;
import android.os.Bundle;
import android.annotation.SuppressLint;
import android.app.Activity;
import android.content.Intent;
import android.graphics.Bitmap;
import android.hardware.Camera;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;

public class MainActivity extends Activity {

    private static final int CAMERA_PIC_REQUEST = 1337; 
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        Button button = (Button) findViewById(R.id.button1);

        button.setOnClickListener(new OnClickListener()
        {
        @SuppressLint("NewApi") @Override
        public void onClick(View arg0) {
            // TODO Auto-generated method stub
            Intent intent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE );

            startActivityForResult( intent, CAMERA_PIC_REQUEST );
        }
        });

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {  
        if (requestCode == CAMERA_PIC_REQUEST) {  
        // do something
            Bitmap thumbnail = (Bitmap) data.getExtras().get("data");
            ImageView image = (ImageView) findViewById(R.id.imageView1);
            image.setImageBitmap(thumbnail);
        }  
       }  
} 
```

And added to the activity_main.xml file imageView1 in the bottom:

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world" />

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:layout_marginRight="45dp"
        android:layout_marginTop="62dp"
        android:text="Activate The Camera" />
    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:src="@drawable/ic_launcher" />
</RelativeLayout> 
```

Now it's all working ! Thanks.

# java - 如何减少 Google App Engine 数据存储延迟？

> ID：14415878
> 
> 赞同：13
> 
> 时间：2013-01-19T15:33:55.133
> 
> 标签：java, google-app-engine, jdo, latency

通过 appstats，我可以看到我的数据存储查询大约需要 125 毫秒（api 和 cpu 结合），但在执行查询之前通常有很长的延迟（例如，高达 12000 毫秒）。

我可以看到我的数据存储延迟与我的查询无关（例如，相同的查询/数据有很大不同的延迟），所以我假设这是应用引擎的调度问题。

其他人是否看到同样的问题？

有没有办法减少延迟（例如管理控制台设置）？

这是来自 appstats 的屏幕截图。这个 servlet 几乎没有 cpu 处理。它执行 getObjectByID，然后执行数据存储查询。该查询有一个 OR 运算符，因此它被应用引擎转换为 3 个查询。

![应用统计截图](../Images/679b7929534c8a1ce0bdef3c49bd23f9.png) . 如您所见，在第一个 getObjectByID 执行之前需要 6000 毫秒。get操作前没有任何处理（除了获取pm）。我认为这 6000 毫秒的延迟可能是由于实例预热，所以我将空闲实例增加到 2 以防止任何预热。

然后在 getObjectByID 和查询之间有大约 1000 毫秒的第二次延迟。获取和查询之间有零行代码。该代码仅获取 getObjectByID 的结果并将数据用作查询的一部分。

总计为 8097 毫秒，但我的数据存储操作（以及 99.99% 的 servlet）只有 514 毫秒（45 毫秒 api），尽管每次运行 servlet 时数字都会发生变化。这是另一个针对相同数据在同一 servlet 上运行的 appstats 屏幕截图。 ![在此处输入图像描述](../Images/1b6525c0f01439393223482bcf78db3f.png)

这是我的java代码的基础知识。为了安全起见，我不得不删除一些细节。

```
user = pm.getObjectById(User.class, userKey);           
//build queryBuilder.append(...
final Query query = pm.newQuery(UserAccount.class,queryBuilder.toString());
query.setOrdering("rating descending");
query.executeWithArray(args); 
```

编辑：使用 Pingdom，我可以看到 GAE 延迟从 450 毫秒到 7,399 毫秒不等，或相差 1,644%！这是有两个空闲实例且站点上没有用户。 ![在此处输入图像描述](../Images/29cc9abe5fa87994ae67aa495a40bda7.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-21T04:06:04.147

我在一些应用程序中观察到**非常相似**的延迟（在 7000-10000 毫秒范围内）。我认为问题的大部分（那 6000 毫秒）不在于您的代码。

在我的观察中，这个问题与 AppEngine 启动一个新实例有关。设置最小空闲实例可能有助于缓解，但它**不会解决它**（我尝试了最多 2 个空闲实例），因为基本上即使你有 N 个空闲实例，应用引擎也会更喜欢启动动态实例，即使只有一个请求进来，并且会在出现疯狂的流量高峰时“保存”空闲的。这是非常违反直觉的，因为您希望它使用已经存在的实例并为将来的请求启动动态实例。

无论如何，根据我的经验，这个问题（10000ms 延迟）很少发生在任何非零负载量下，而且许多人不得不每隔几分钟恢复到某种 ping 之王（可能是 cron 作业）（以前工作 5 分钟）但最近实例死得更快，所以它更像是每 2 分钟一次 ping）以保持动态实例为在没有其他人打开时访问该站点的用户提供服务。这种 ping 并不理想，因为它会吃掉您的免费配额（每 5 分钟 ping 一次会吃掉一半以上），但到目前为止我真的还没有找到更好的选择。

回顾一下，总的来说，我发现应用程序引擎在负载下非常棒，但当您在网站上只有很少 (1-3) 个用户时，它并不出色。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T17:39:20.587

Appstats 仅在您进行 GAE API/RPC 调用时帮助诊断性能问题。

对于您的图表，“空白”时间用于在您的实例上运行您的代码。这不会是安排时间。

您猜测初始延迟可能是因为实例预热很可能。它可能是正在执行的框架代码。我无法猜测 Get 和 Query 之间的延迟。可能是有 0 行代码，但是您在 Query 中调用了一些需要时间来处理的函数。

如果不了解语言、框架或实际代码，没有人可以帮助您。

您需要自行添加某种性能跟踪来诊断此问题。最简单（但不是非常准确）的方法是在代码执行时添加计时器并记录计时器值。

# php - 致命错误：调用 wamp 中未定义的函数 ldap_connect()

> ID：14415879
> 
> 赞同：6
> 
> 时间：2013-01-19T15:34:15.523
> 
> 标签：php, wamp

希望有人能找出我哪里出错了，因为我四处走动却无处可去！我有一个 WAMP5 安装，它在 Win XP 机器上集成了 PHP 版本 5.2.4、Apache/2.2.4 (Win32) 和 MYSQL。一切正常，但我无法获得 LDAP 支持。

我检查了 php.ini 中的 extension_dir = "c:/wamp/php/ext/" 和 extension=php_ldap.dll 并检查了 dll 实际上在那个文件夹中。我已将 libeay32.dll 和 ssleay32.dll 复制到 c:windows\system32 文件夹

使用此代码：

```
 $host = "192.168.56.25";
if (!$ldapconn = ldap_connect($host, 80)) {
   echo "Error! Could not connect to LDAP host $host\n";
} 
```

我收到此错误：致命错误：调用未定义的函数 ldap_connect()... 我不知道从哪里开始检查，因为我想我的 WAMP 的所有条件都已达到，以考虑 Ldap。请帮忙！谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-19T15:37:07.433

您需要在 php.ini 文件中启用 LDAP。取消注释这一行：

```
extension=php_ldap.dll 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-01-19T15:37:00.757

确保您的服务器上安装了 LDAP 扩展。应该有一个你需要安装的包。我相信它：

`sudo apt-get install php5-ldap`

您可能还需要查看[安装](http://php.net/manual/en/ldap.installation.php)指南。您可能需要添加另外两个 DLL `libeay32.dll and ssleay32.dll`。

# algorithm - 如何有效地从一堆袜子中配对？

> ID：14415881
> 
> 赞同：4071
> 
> 时间：2013-01-19T15:34:35.667
> 
> 标签：algorithm, sorting, language-agnostic, matching

昨天我从干净的洗衣店里把袜子配对，发现我这样做的方式不是很有效。我在做一个天真的搜索——挑选一只袜子并“迭代”这堆袜子以找到它的那双。这需要平均迭代 n/2 * n/4 = n ² /8 个袜子。

作为一名计算机科学家，我在想我能做什么？排序（根据大小/颜色/...）当然会想到实现 O(NlogN) 解决方案。

散列或其他非就地解决方案不是一种选择，因为我无法复制我的袜子（尽管如果可以的话可能会很好）。

**所以，问题基本上是：**

给定一堆`n`包含`2n`元素的袜子（假设每只袜子正好有一对匹配的对），用最多对数额外空间有效配对它们的最佳方法是什么？（如果需要，我相信我可以记住大量信息。）

我将感谢一个解决以下方面的答案：

*   大量袜子的一般*理论解决方案。*
*   袜子的实际数量并不多，我不相信我的配偶和我有30多双。（而且我的袜子和她的袜子很容易区分；这也可以用吗？）
*   它是否等同于[元素区别问题](http://en.wikipedia.org/wiki/Element_distinctness_problem)？

* * *

## 回答 #1

> 赞同：2530
> 
> 时间：2013-01-19T22:27:57.507

排序解决方案已经提出，但是**排序有点过分**：我们不需要排序；**我们只需要平等团体**。

所以**散列**就足够了（而且更快）。

1.  对于每种颜色的袜子，**形成一堆**。遍历输入篮中的所有袜子**并将它们分配到颜色堆上**。
2.  遍历每一堆，并**通过一些其他度量**（例如模式）将其分配到第二组堆中
3.  **递归地应用此方案**，直到您将所有袜子分配到**非常小的堆上，您可以立即进行可视化处理**

当 SQL Server 需要对庞大的数据集进行散列连接或散列聚合时，这种递归散列分区实际上是由[SQL Server完成的。](http://en.wikipedia.org/wiki/Microsoft_SQL_Server)它将其构建输入流分配到许多独立的分区中。该方案可线性扩展到任意数量的数据和多个 CPU。

**如果您可以找到提供足够存储桶**的分布键（散列键），并且每个存储桶足够小，可以非常快速地处理，则您不需要递归分区。不幸的是，我不认为袜子有这样的属性。

如果每只袜子都有一个名为“PairID”的整数，则可以根据`PairID % 10`（最后一位）轻松地将它们分配到 10 个桶中。

我能想到的最好的现实世界分区是创建一个**矩形的桩**：一个维度是颜色，另一个是图案。为什么是长方形？因为我们需要 O(1) 随机访问堆。（3D[长方体](http://en.wikipedia.org/wiki/Cuboid)也可以，但这不是很实用。）

* * *

更新：

**并行性**怎么样？多个人可以更快地匹配袜子吗？

1.  最简单的并行化策略是让多个工作人员从输入篮中取出袜子并将袜子放在一堆堆上。这只扩大了这么多 - 想象一下 100 个人打了 10 堆。**同步成本**（表现为手部碰撞和人类交流）**破坏了效率和加速**（参见[通用可扩展性法则](http://www.perfdynamics.com/Manifesto/USLscalability.html)！）。这容易出现**死锁**吗？不，因为每个工人一次只需要访问一堆。只有一个“锁”就不会出现死锁。取决于人类如何协调对桩的访问，**活锁可能是可能的。**他们可能只是使用[随机退避](http://en.wikipedia.org/wiki/Exponential_backoff)像网卡一样，在物理级别上执行此操作以确定哪些卡可以独占访问网络线。如果它适用于[NIC](http://en.wikipedia.org/wiki/Network_interface_controller)，它也应该适用于人类。
2.  如果**每个工人都有自己的一堆堆**，它几乎可以无限扩展。然后工人可以从输入篮子中取出大块的袜子（很少有竞争，因为他们很少这样做）并且他们在分发袜子时根本不需要同步（因为他们有线程局部堆）。最后，所有工人都需要联合他们的桩组。**如果工人形成聚合树**，我相信这可以在 O(log (工人计数 * 每个工人的桩数)) 中完成。

[元素区别问题](http://en.wikipedia.org/wiki/Element_distinctness_problem)呢？正如文章所述，元素区别问题可以在 中解决`O(N)`。袜子问题也是如此（另外`O(N)`，如果你只需要一个分布步骤（我提出多个步骤只是因为人类不擅长计算 - 如果你分布在 上，一步就足够了`md5(color, length, pattern, ...)`，即所有属性的**完美散列**））。

显然，不能比 快`O(N)`，所以我们已经达到了**最优下限**。

尽管输出不完全相同（在一种情况下，只是一个布尔值。在另一种情况下，袜子对），渐近复杂度是相同的。

* * *

## 回答 #2

> 赞同：609
> 
> 时间：2013-01-20T11:21:00.397

由于人脑的结构与现代 CPU 完全不同，所以这个问题没有实际意义。

人类可以利用“找到匹配对”这一事实来战胜 CPU 算法，这对于一个不太大的集合来说是一个操作。

我的算法：

```
spread_all_socks_on_flat_surface();
while (socks_left_on_a_surface()) {
     // Thanks to human visual SIMD, this is one, quick operation.
     pair = notice_any_matching_pair();
     remove_socks_pair_from_surface(pair);
} 
```

至少这是我在现实生活中使用的，我发现它非常有效。缺点是它需要一个平坦的表面，但它通常很丰富。

* * *

## 回答 #3

> 赞同：272
> 
> 时间：2013-01-19T21:48:43.310

**案例1**：所有袜子都是一样的（顺便说一句，这是我在现实生活中所做的）。

选择其中任意两个组成一对。恒定的时间。

**案例 2**：有恒定数量的组合（所有权、颜色、大小、纹理等）。

使用[基数排序](http://en.wikipedia.org/wiki/Radix_sort)。这只是线性时间，因为不需要比较。

**情况3**：事先不知道组合的数量（一般情况）。

我们必须进行比较以检查两只袜子是否成对出现。选择一种`O(n log n)`基于比较的排序算法。

然而在现实生活中，当袜子的数量相对较少（恒定）时，这些理论上最优的算法就不能很好地工作。它可能需要比顺序搜索更多的时间，顺序搜索理论上需要二次时间。

* * *

## 回答 #4

> 赞同：159
> 
> 时间：2013-01-20T03:34:12.003

**非算法答案，但当我这样做时“高效”：**

*   第 1 步）丢弃所有现有的袜子

*   第 2 步）去[沃尔玛](http://en.wikipedia.org/wiki/Walmart)买 10-n 包白色和 m 包黑色。日常生活中不需要其他颜色。

然而有时，我不得不再次这样做（丢失的袜子，损坏的袜子等），而且我讨厌经常丢弃非常好的袜子（我希望他们继续销售相同的袜子参考！），所以我最近采取了一种不同的方法。

**算法答案：**

考虑一下，如果你只为第二叠袜子画一只袜子，就像你正在做的那样，在天真的搜索中找到匹配袜子的几率非常低。

*   所以随机挑选其中的五个，并记住它们的形状或长度。

为什么是五个？通常人类会记住工作记忆中五到七个不同的元素——有点像人类相当于[RPN](http://en.wikipedia.org/wiki/Reverse_Polish_notation)堆栈——五个是安全的默认值。

*   从 2n-5 的堆栈中取出一个。

*   现在在你画的五个里面寻找一个匹配（视觉模式匹配——人类擅长用小筹码），如果你没有找到一个，那么把它添加到你的五个中。

*   继续从堆叠中随机挑选袜子，并与您的 5+1 袜子进行比较。随着筹码量的增长，它会降低你的表现，但会提高你的胜算。快多了。

随意写下公式来计算您必须抽取多少个样本才能获得 50% 的匹配几率。IIRC 这是一个超几何定律。

我每天早上都这样做，而且很少需要超过 3 次抽奖 - 但我有`n`类似的（大约 10 对，给予或接受丢失的）`m`形状的白色袜子。现在你可以估计我的股票的大小了:-)

**顺便说一句**，我发现每次需要一双袜子时整理所有袜子的交易成本总和远低于一次绑定袜子的交易成本。准时制效果更好，因为这样您就不必绑定袜子，而且边际回报也在递减（也就是说，您一直在寻找在洗衣店某处时需要的两三只袜子完成匹配你的袜子，你会浪费时间）。

* * *

## 回答 #5

> 赞同：108
> 
> 时间：2013-01-19T15:49:31.150

我所做的是拿起第一只袜子并放下（比如，放在洗衣盆的边缘）。然后我拿起另一只袜子，看看它是否和第一只袜子一样。如果是，我将它们都删除。如果不是，我把它放在第一只袜子旁边。然后我拿起第三只袜子并将其与前两只进行比较（如果它们还在那里）。等等。

~~假设“移除”袜子是一种选择，这种方法可以很容易地在数组中实现。~~实际上，您甚至不需要“脱掉”袜子。如果您不需要对袜子进行排序（见下文），那么您可以移动它们并最终得到一个数组，其中所有袜子成对排列在数组中。

假设袜子的唯一操作是比较相等，这个算法基本上仍然是一个 n ²算法，虽然我不知道平均情况（从来没有学过计算）。

排序当然可以提高效率，尤其是在现实生活中，您可以轻松地将一只袜子“插入”到另外两只袜子之间。在计算中，同样可以通过一棵树来实现，但这是额外的空间。当然，我们又回到了 NlogN（或者更多，如果有几只袜子按照排序标准是相同的，但不是来自同一对）。

除此之外，我想不出任何东西，但这种方法在现实生活中似乎确实非常有效。:)

* * *

## 回答 #6

> 赞同：61
> 
> 时间：2013-02-08T07:42:49.887

这是在问错误的问题。正确的问题是，我为什么要花时间整理袜子？当您重视您选择的 X 个货币单位的空闲时间时，每年的费用是多少？

通常，这不仅仅是*任何*空闲时间，它是*早上*的空闲时间，你可以在床上度过，或者喝咖啡，或者早点离开而不被交通堵塞。

退后一步，想办法解决问题通常是件好事。

而且有办法！

找到你喜欢的袜子。考虑所有相关特征：不同照明条件下的颜色、整体质量和耐用性、不同气候条件下的舒适度以及异味吸收。同样重要的是，它们在储存时不应该失去弹性，所以天然织物是好的，它们应该用塑料包装。

如果左右脚袜没有区别就更好了，但这并不重要。如果袜子是左右对称的，找到一对是O(1)操作，排序袜子是近似O(M)操作，其中M是你房子里乱扔袜子的地方的数量，理想情况下是一些小的常数。

如果你选择了一双左右袜子不同的花哨，对左右脚桶进行全桶排序需要 O(N+M)，其中 N 是袜子的数量，M 同上。其他人可以给出找到第一对的平均迭代的公式，但是通过盲搜索找到一对的最坏情况是 N/2+1，对于合理的 N，这在天文上不太可能出现。这可以通过使用高级图像来加速识别算法和启发式，当用[Mk1 Eyeball](http://www.urbandictionary.com/define.php?term=Mk1%20eyeball)扫描一堆未分类的袜子时。

因此，实现 O(1) 袜子配对效率（假设对称袜子）的算法是：

1.  你需要估计你的余生需要多少双袜子，或者可能直到你退休并搬到温暖的气候下，再也不需要穿袜子了。如果您还年轻，您还可以估计需要多长时间才能在我们家中拥有袜子分拣机器人，整个问题变得无关紧要。

2.  您需要了解如何批量订购您选择的袜子，成本是多少，以及它们是否送货。

3.  订购袜子！

4.  摆脱你的旧袜子。

另一个步骤 3 将涉及比较多年来一次购买几双相同数量的可能更便宜的袜子的成本，并增加分类袜子的成本，但相信我的话：批量购买更便宜！此外，存储中的袜子以股票价格上涨的速度增加价值，这比您在许多投资中获得的要多。再说一次，还有存储成本，但袜子在壁橱的顶部架子上确实不会占用太多空间。

问题解决了。所以，只要买新袜子，扔掉/捐出旧袜子，在知道你每天都在为你的余生节省金钱和时间之后，过上幸福的生活吧。

* * *

## 回答 #7

> 赞同：53
> 
> 时间：2013-01-19T20:40:46.857

理论上的限制是 O(n)，因为您需要触摸每只袜子（除非有些已经以某种方式配对）。

[您可以使用radix sort](http://en.wikipedia.org/wiki/Radix_sort)实现 O(n) 。您只需要为存储桶选择一些属性。

1.  首先，您可以选择（她的，我的）- 将它们分成 2 堆，
2.  然后使用颜色（可以有任何颜色顺序，例如按颜色名称的字母顺序） - 按颜色将它们分成几堆（记住为同一堆中的所有袜子保留第 1 步的初始顺序），
3.  然后是袜子的长度，
4.  然后纹理，....

如果您可以选择有限数量的属性，但有足够多的属性可以唯一地识别每一对，那么您应该在 O(k * n) 中完成，如果我们认为 k 是有限的，则为 O(n)。

* * *

## 回答 #8

> 赞同：34
> 
> 时间：2013-01-20T15:18:10.293

作为一个实用的解决方案：

1.  快速制作成堆易于区分的袜子。（按颜色说）
2.  快速排序每一堆，并使用袜子的长度进行比较。作为人类，您可以相当快速地决定使用哪种袜子进行分区，以避免最坏的情况。（你可以同时看到多只袜子，利用它来发挥你的优势！）
3.  当它们达到一个阈值时停止分类，您可以立即轻松找到现货对和无法配对的袜子

如果你有 1000 只袜子，有 8 种颜色，平均分布，你可以在 c*n 时间内制作 4 堆每 125 只袜子。使用 5 只袜子的阈值，您可以在 6 次运行中对每一堆进行分类。（数 2 秒，将袜子扔到正确的桩上，您将花费不到 4 小时。）

如果您只有 60 只袜子、3 种颜色和 2 种袜子（您的/您妻子的），您可以在 1 次运行中对每堆 10 只袜子进行分类（再次阈值 = 5）。（计数 2 秒将花费您 2 分钟）。

最初的桶排序将加快您的流程，因为它会及时将您的 n 个袜子分成 k 个桶，`c*n`因此您只需要做`c*n*log(k)`工作。（不考虑阈值）。所以总而言之，你所做的一切都是为了`n*c*(1 + log(k))`工作，其中 c 是把袜子扔到一堆上的时间。

与任何方法相比，这种方法将是有利的`c*x*n + O(1)`，只要`log(k) < x - 1`.

* * *

在计算机科学中，这可能会有所帮助：我们有 n 个*事物*的集合，它们的顺序（长度）以及等价关系（额外信息，例如袜子的颜色）。等价关系允许我们对原始集合进行分区，并且在每个等价类中我们的顺序仍然保持不变。*一个事物*到它的等价类的映射可以在 O(1) 中完成，因此只需 O(n) 就可以将每个项目分配给一个类。现在我们已经使用了我们的额外信息，并且可以以任何方式对每个类进行排序。优点是数据集已经明显更小了。

该方法也可以嵌套，如果我们有多个等价关系 -> 制作颜色堆，而不是在纹理上的每个堆分区内，而不是按长度排序。任何创建具有超过 2 个大小相等的元素的分区的等价关系都将比排序带来速度提升（假设我们可以直接将袜子分配给它的堆），并且排序可以在较小的数据集上非常快速地发生。

* * *

## 回答 #9

> 赞同：32
> 
> 时间：2015-10-19T20:47:35.780

**您正在尝试解决错误的问题。**

**解决方案1：**每次将脏袜子放入洗衣篮时，将它们打成一个小结。这样您就不必在洗涤后进行任何分类。把它想象成在 Mongo 数据库中注册一个索引。为将来节省一些 CPU 做一些工作。

**解决方案2：**如果是冬天，你不必穿配套的袜子。我们是程序员。没有人需要知道，只要它有效。

**解决方案 3：**传播工作。您希望异步执行如此复杂的 CPU 进程，而不阻塞 UI。拿起那堆袜子，把它们塞进袋子里。仅在需要时才寻找一对。这样，它所花费的工作量就不会那么明显了。

希望这可以帮助！

* * *

## 回答 #10

> 赞同：27
> 
> 时间：2013-01-23T04:12:29.263

这个问题其实是很哲学的。从本质上讲，它是关于人们解决问题的能力（我们大脑的“湿件”）是否等同于算法可以完成的事情。

袜子排序的一个明显算法是：

```
Let N be the set of socks that are still unpaired, initially empty
for each sock s taken from the dryer
  if s matches a sock t in N
    remove t from N, bundle s and t together, and throw them in the basket
  else
    add s to N 
```

现在这个问题的计算机科学就是关于步骤的

1.  “如果 s 与 N 中的袜子 t 配对”。我们能以多快的速度“记住”我们迄今为止所看到的？
2.  “从 N 中删除 t”和“将 s 添加到 N”。跟踪我们迄今为止所见的成本有多高？

人类将使用各种策略来实现这些。[人类记忆*是*关联](http://garfield.library.upenn.edu/classics1979/A1979HX09600001.pdf)的，就像一个哈希表，其中存储值的特征集与相应的值本身配对。例如，“红色汽车”的概念映射到一个人能够记住的所有红色汽车。具有完美记忆的人具有完美的映射。大多数人在这方面（以及大多数其他人）都是不​​完美的。关联映射的容量有限。映射可能会*发出哔哔声*在各种情况下不存在（一瓶啤酒太多），被错误记录（“我虽然她的名字是贝蒂，而不是内蒂”），或者即使我们观察到事实已经改变，也永远不会被覆盖（“爸爸的车”唤起“橙色火鸟”，而我们实际上知道他已经用它换了红色卡马罗）。

就袜子而言，完美回忆意味着看着一只袜子`s`总是会产生对其兄弟姐妹的记忆`t`，包括足够的信息（它在熨衣板上的位置）以`t`在恒定时间内定位。一个有过目不忘的人在一定时间内完成 1 和 2 都不会失败。

记忆力不够完美的人可能会根据他能够跟踪的特征使用一些常识等价类：大小（爸爸、妈妈、婴儿）、颜色（绿色、红色等）、图案（菱形、纯色等） , 风格（footie、膝盖高等）。因此，熨衣板将被划分为类别的部分。这通常允许通过内存在恒定时间内定位类别，但随后需要通过类别“桶”进行线性搜索。

完全没有记忆或想象力的人（对不起）只会把袜子放在一堆，然后对整堆进行线性搜索。

正如有人建议的那样，一个整洁的怪胎可能会使用数字标签来配对。这为全排序打开了大门，它允许人类使用与 CPU 完全相同的算法：二分查找、树、散列等。

因此，“最佳”算法取决于运行它的湿件/硬件/软件的质量，以及我们通过对成对施加总顺序来“作弊”的意愿。当然，“最好的”*元*算法是聘请世界上最好的袜子分类器：一个人或机器可以获取并快速存储大量 N 套袜子属性集在一个 1-1 关联内存中，具有恒定的时间查找、插入、并删除。像这样的人和机器都可以采购。如果你有一只，你可以在 O(N) 时间内将所有袜子配对 N 对，这是最优的。总订单标签允许您使用标准散列来获得与人类或硬件计算机相同的结果。

* * *

## 回答 #11

> 赞同：23
> 
> 时间：2013-01-20T20:18:42.480

这是基于比较的模型中的 Omega(n log n) 下限。（唯一有效的操作是比较两只袜子。）

假设你*知道*你的 2n 只袜子是这样排列的：

p [1] p [2] p [3] ... p [n] p [f(1)] p [f(2)] ... p [f(n)]

其中 f 是集合 {1,2,...,n} 的未知排列。知道这一点不会使问题变得更难。有n！可能的输出（上半场和下半场之间的匹配），这意味着您需要 log(n!) = Omega(n log n) 比较。这可以通过排序获得。

由于您对与元素区别问题的联系感兴趣：证明元素区别的 Omega(n log n) 界限更难，因为输出是二进制是/否。在这里，输出必须是匹配的，并且可能的输出数量足以获得一个不错的界限。但是，有一个与元素区别相关的变体。假设你有 2n 只袜子，想知道它们是否可以唯一配对。[您可以通过将 (a 1] , a [2] , ..., a [n] ) 发送到 (a [1] , a [1] , a [2] , a [2] , ..., a [n] , a [n] )从 ED 中获得减免。（顺便说一句，ED的硬度证明非常有趣，[通过拓扑](http://www.cs.dartmouth.edu/~ac/Teach/CS85-Spring08/lecnotes.pdf).)

我认为如果你只允许相等测试，应该有一个 Omega(n ² ) 绑定到原始问题。我的直觉是：考虑一个在测试后添加边的图形，并认为如果图形不密集，则输出不是唯一确定的。

* * *

## 回答 #12

> 赞同：23
> 
> 时间：2013-01-19T22:19:31.930

成本：移动袜子 -> 高，查找/搜索排队的袜子 -> 小

我们要做的是减少移动次数，并用搜索次数进行补偿。此外，我们可以利用智人的多线程环境在决策缓存中保存更多的东西。

X = 你的，Y = 你的配偶

从所有袜子的 A 堆开始：

选择两只袜子，将对应的 X 袜子放在 X 线，Y 袜子放在 Y 线的下一个可用位置。

做直到 A 为空。

对于每行 X 和 Y

1.  选择第一个袜子，沿着线搜索，直到找到对应的袜子。

2.  放入对应的成品袜线。

3.  **可选**当您搜索该系列并且您正在查看的当前袜子与上一个相同时，请对这些袜子执行第 2 步。

作为第一步，您可以选择从该行拿起两只袜子而不是两只，因为缓存足够大，我们可以快速识别其中一只袜子是否与您正在观察的线上的当前一只袜子匹配。如果你有幸拥有三只手臂，考虑到主题的内存足够大，你可能会同时解析三只袜子。

直到 X 和 Y 都为空。

完毕

但是，由于这与选择排序具有相似的复杂性，因此由于 I/O（移动袜子）和搜索（搜索线以寻找袜子）的速度，所花费的时间要少得多。

* * *

## 回答 #13

> 赞同：22
> 
> 时间：2013-04-01T19:37:41.457

现实世界的方法：

尽可能快地从未分类的一堆袜子中取出一只，然后将它们堆放在您面前。堆垛的布置应节省空间，所有袜子都指向同一方向；桩的数量受到您可以轻松到达的距离的限制。选择放袜子的堆垛应该——尽可能快地——把袜子放在一堆看起来很像的袜子上；可以容忍偶尔出现的 I 型（将袜子放在不属于它的一堆）或 II 型（当有一堆类似的袜子时，将袜子放在自己的一堆）错误——最重要的考虑因素是*速度*.

一旦所有的袜子都成堆，快速穿过多袜子堆，形成一双并取出它们（这些袜子正走向抽屉）。如果堆中有不匹配的袜子，请将它们重新堆成最好的（在尽可能快的约束内）堆。处理完所有多袜子堆后，匹配由于 II 类错误而未配对的剩余可配对袜子。嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗖嗬嗬 另一个实用说明：我将一双袜子的顶部向下翻转到另一只袜子上，利用它们的弹性特性，因此它们在被运送到抽屉时和在抽屉中时保持在一起。

* * *

## 回答 #14

> 赞同：21
> 
> 时间：2013-01-21T23:12:33.253

*对于p*对袜子（*n = 2p*个单独的袜子），我实际上是这样做的：

*   从那堆袜子中随机取出一只袜子。
*   对于第一只袜子，或者如果所有先前选择的袜子都已配对，只需将袜子放入您面前的未配对袜子“阵列”的第一个“插槽”中。
*   如果您有一只或多只选定的未配对袜子，请检查您当前的袜子与阵列中所有未配对的袜子。
    *   在构建您的阵列时，可以将袜子分为一般类别或类型（白色/黑色、脚踝/船员、运动/连衣裙），并“向下钻取”以仅比较同类。
    *   如果您找到可接受的匹配项，请将两只袜子放在一起并将它们从阵列中取出。
    *   如果不这样做，请将当前袜子放入阵列中的第一个开放插槽中。
*   对每只袜子重复一次。

该方案的最坏情况是，每双袜子都不同，必须完全匹配，而且你挑选的前*n/2*只袜子都是不同的。这是您的*O* (n ² ) 场景，而且*极*不可能。*如果袜子t*的唯一类型的数量小于配对的数量*p = n/2*，并且每种类型的袜子都足够相似（通常在与磨损相关的术语中），那么该类型的任何袜子都可以与任何其他，然后正如我在上面推断的那样，您必须比较的最大袜子数量是*t*，之后您拉下的袜子*将*匹配其中一只未配对的袜子。这种情况在普通袜子抽屉中比最坏情况更有可能发生，并将最坏情况的复杂性降低到*O* (n*t) ，其中通常*t << n*。

* * *

## 回答 #15

> 赞同：16
> 
> 时间：2013-01-22T22:05:11.623

从您的问题来看，很明显您对洗衣没有太多实际经验:)。您需要一种算法，该算法适用于少量不可配对的袜子。

到目前为止的答案并没有很好地利用我们的人类模式识别能力。Set 游戏提供了如何做好这一点的线索：将所有袜子放在一个二维空间中，这样您既可以很好地识别它们，又可以用手轻松地拿到它们。这将您限制在大约 120 * 80 厘米左右的区域内。从那里选择您认识的对并删除它们。将额外的袜子放在空闲空间并重复。如果您为穿着易于识别的袜子的人（想到小孩子）洗衣服，您可以先选择那些袜子来进行基数排序。该算法仅在单只袜子数量较少时有效

* * *

## 回答 #16

> 赞同：16
> 
> 时间：2013-11-28T10:19:52.610

拿起第一只袜子，放在桌子上。现在选择另一只袜子；如果它与第一个选择的匹配，则将其放在第一个之上。如果没有，请将其放在距离第一个不远的桌子上。选择第三只袜子；如果它与前两个中的任何一个匹配，请将其放在它们的顶部，或者将其放置在距第三个一小段距离的地方。重复，直到你拿起所有的袜子。

* * *

## 回答 #17

> 赞同：13
> 
> 时间：2013-01-23T12:24:18.177

我提出了另一种解决方案，它不会承诺更少的操作，也不会减少时间消耗，但应该尝试看看它是否可以成为一个足够好的启发式方法，以在大量的袜子配对中提供更少的时间消耗。

**前提条件：** 不保证有相同的袜子。如果它们具有相同的颜色，并不意味着它们具有相同的尺寸或图案。袜子随机洗牌。袜子的数量可能是奇数（有些丢失，我们不知道有多少）。准备记住一个变量“索引”并将其设置为 0。

**结果**会有一两堆：1.“匹配”和2.“缺失”

***启发式：***

1.  寻找最有特色的袜子。
2.  找到它的匹配项。
3.  如果没有匹配，则将其放在“缺失”堆上。
4.  从 1\. 重复，直到没有更多最有特色的袜子。
5.  如果袜子少于 6 只，请转到 11。
6.  盲目地将所有袜子与邻居配对（不要打包）
7.  找到所有匹配的对，打包并将打包的对移动到“匹配”堆；如果没有新匹配 - 将“索引”增加 1
8.  如果“指数”大于 2（这可能是取决于袜子数量的值，因为袜子数量越多，盲目配对的机会就越小）转到 11
9.  洗牌其余的
10.  转到 1
11.  忘记“索引”
12.  挑选袜子
13.  找到它的对
14.  如果袜子没有一双，把它移到“缺失”的那堆
15.  如果匹配找到配对，打包配对并将其移动到“匹配”堆
16.  如果还有更多，那么一只袜子去 12
17.  如果只剩下一个，请转到 14
18.  满意的微笑:)

此外，还可以检查损坏的袜子，就像将它们移除一样。它可以插入在 2 和 3 之间，以及 13 和 14 之间。

我期待听到任何经验或更正。

* * *

## 回答 #18

> 赞同：13
> 
> 时间：2013-01-22T16:32:11.177

```
List<Sock> UnSearchedSocks = getAllSocks();
List<Sock> UnMatchedSocks = new list<Sock>();
List<PairOfSocks> PairedSocks = new list<PairOfSocks>();

foreach (Sock newSock in UnsearchedSocks)
{
  Sock MatchedSock = null;
  foreach(Sock UnmatchedSock in UnmatchedSocks)
  {
    if (UnmatchedSock.isPairOf(newSock))
    {
      MatchedSock = UnmatchedSock;
      break;
    }
  }
  if (MatchedSock != null)
  {
    UnmatchedSocks.remove(MatchedSock);
    PairedSocks.Add(new PairOfSocks(MatchedSock, NewSock));
  }
  else
  {
    UnmatchedSocks.Add(NewSock);
  }
} 
```

* * *

## 回答 #19

> 赞同：13
> 
> 时间：2013-01-29T07:07:24.103

为了说明从一堆中配对袜子的效率有多高，我们必须首先定义机器，因为无论是通过图灵机还是随机存取机都不会完成配对，这通常用作算法分析。

# 机器

机器是现实世界元素的抽象，称为人类。它能够通过一双眼睛从环境中读取信息。我们的机器模型能够通过使用 2 个手臂来操纵环境。逻辑和算术运算是使用我们的大脑计算的（希望 ;-)）。

我们还必须考虑可以使用这些工具执行的原子操作的内在运行时间。由于物理限制，由手臂或眼睛执行的操作具有非恒定的时间复杂度。这是因为我们不能用胳膊移动一大堆袜子，也不能用眼睛看到一大堆袜子上最上面的袜子。

然而，机械物理学也给了我们一些好处。我们不限于用一只手臂移动最多一只袜子。我们可以同时移动其中的两个。

因此，根据前面的分析，应按降序使用以下操作：

*   逻辑和算术运算
*   环境读数
*   环境改造

我们还可以利用人们只有非常有限数量的袜子这一事实。因此，环境改造可能涉及堆中的所有袜子。

# 算法

所以这是我的建议：

1.  将堆中的所有袜子铺在地板上。
2.  通过查看地板上的袜子找到一双。
3.  从 2 开始重复，直到无法配对为止。
4.  从 1 开始重复，直到地板上没有袜子。

操作 4 是必要的，因为当将袜子铺在地板上时，一些袜子可能会隐藏其他袜子。下面是算法分析：

# 分析

该算法以高概率终止。这是因为在第 2 步中找不到一双袜子。

对于以下配对`n`袜子的运行时分析，我们假设`2n`在第 1 步之后至少有一半的袜子没有被隐藏。所以在平均情况下，我们可以找到`n/2`配对。这意味着循环是第 4 步执行的`O(log n)`次数。第 2 步是执行`O(n^2)`次数。所以我们可以得出结论：

*   该算法涉及`O(ln n + n)`环境修改（步骤 1`O(ln n)`加上从地板上挑选每双袜子）
*   该算法涉及`O(n^2)`来自步骤 2 的环境读取
*   该算法涉及`O(n^2)`逻辑和算术运算，用于在步骤 2 中将一只袜子与另一只袜子进行比较

因此，对于合理数量的袜子，我们有一个总体运行时复杂性，**`O(r*n^2 + w*(ln n + n))`**分别是环境读取`r`和`w`环境写入操作的因素。省略了逻辑和算术运算的成本，因为我们假设需要恒定数量的逻辑和算术运算来确定 2 只袜子是否属于同一对。这可能并非在所有情况下都可行。

* * *

## 回答 #20

> 赞同：12
> 
> 时间：2013-09-07T16:06:26.727

我已经采取了简单的步骤来减少我在花费 O(1) 时间的过程中的工作量。

通过将我的输入减少到两种袜子中的一种（休闲用白色袜子，工作用黑色袜子），我只需要确定我手头有两种袜子中的哪一种。（从技术上讲，由于它们从不一起清洗，因此我将过程减少到 O(0) 时间。）

需要一些前期工作才能找到理想的袜子，并购买足够数量的袜子以消除对现有袜子的需求。正如我在需要黑色袜子之前所做的那样，我的努力很小，但里程可能会有所不同。

在非常流行和有效的代码中已经多次看到这种前期工作。示例包括#DEFINE'ing pi 到几位小数（存在其他示例，但这是现在想到的示例）。

* * *

## 回答 #21

> 赞同：12
> 
> 时间：2013-10-23T07:56:12.623

当我对袜子进行排序时，我会进行近似[基数排序](https://en.wikipedia.org/wiki/Radix_sort)，将袜子放在相同颜色/图案类型的其他袜子附近。除非我可以在我即将放下袜子的位置/附近看到完全匹配的情况，否则我会在该位置取出这对袜子。

几乎所有其他算法（包括[usr 得分最高的答案](https://stackoverflow.com/a/14419556/1042311)）排序，然后删除对。我发现，作为一个人，最好尽量减少一次考虑的袜子数量。

我这样做：

1.  挑选一只与众不同的袜子（无论是什么东西首先引起我的注意）。
2.  通过基于与该袜子的相似性从堆中拉出袜子，从该概念位置开始基数排序。
3.  将新袜子放在当前桩附近，距离取决于它的不同程度。如果您发现自己将袜子放在另一个袜子上，因为它是相同的，请在那里形成一对，然后将它们取下。这意味着未来的比较将花费更少的精力来找到正确的位置。

这利用了人类在 O(1) 时间内进行模糊匹配的能力，这在某种程度上相当于在计算设备上建立哈希图。

通过首先拉出独特的袜子，您可以留出空间来“放大”不那么独特的特征。

在去掉荧光色、条纹袜和三双长袜后，你可能会得到大部分是白色的袜子，大致按照它们的磨损程度来分类。

在某些时候，袜子之间的差异很小，以至于其他人不会注意到差异，并且不需要任何进一步的匹配工作。

* * *

## 回答 #22

> 赞同：11
> 
> 时间：2013-01-22T13:33:58.693

考虑一个大小为“N”的哈希表。

如果我们假设正态分布，那么将至少一个 sock 映射到一个存储桶的估计“插入”数为 NlogN（即，所有存储桶都已满）

我将其作为另一个谜题的一部分推导出来，但我很高兴被证明是错误的。 [这是我的博客文章](https://appolo85.wordpress.com/2012/07/25/some-fun-with-hash-table-performance-analysis/)

让“N”对应于您拥有的袜子独特颜色/图案数量的近似上限。

一旦发生碰撞（又名：匹配），只需取下那双袜子。对下一批 NlogN 袜子重复相同的实验。它的美妙之处在于，由于人类思维的工作方式，您可以进行 NlogN 并行比较（冲突解决）。:-)

* * *

## 回答 #23

> 赞同：11
> 
> 时间：2013-01-23T01:25:41.393

袜子，无论是真实的还是一些类似的数据结构，都将成对提供。

最简单的答案是在允许分离对之前，应该已经初始化了该对的单个数据结构，其中包含指向左右袜子的指针，从而使袜子可以直接或通过它们的对被引用。袜子也可以扩展为包含指向其伙伴的指针。

这通过使用抽象层移除它来解决任何计算配对问题。

将相同的想法应用于配对袜子的实际问题，显而易见的答案是：永远不要让您的袜子不配对。袜子成对提供，成对放入抽屉（也许通过将它们捆绑在一起），成对穿着。但是，可以取消配对的地方是在洗衣机中，因此所需要的只是一种物理机制，可以让袜子保持在一起并有效地清洗。

有两种物理可能性：

对于保存指向每只袜子的指针的“pair”对象，我们可以使用一个布袋来将袜子放在一起。这似乎是巨大的开销。

但是对于每只袜子都保持对另一只袜子的引用，有一个巧妙的解决方案：popper（如果你是美国人，则为“按扣”），例如：

[http://www.aliexpress.com/compare/compare-invisible-snap-buttons.html](http://www.aliexpress.com/compare/compare-invisible-snap-buttons.html)

然后，您所做的就是在您脱下袜子并将它们放入洗衣篮后立即将它们合在一起，您再次消除了需要将袜子与“配对”概念的物理抽象配对的问题。

* * *

## 回答 #24

> 赞同：11
> 
> 时间：2013-01-19T22:25:47.333

每当你拿起一只袜子时，把它放在一个地方。然后你拿起下一只袜子，如果它与第一只袜子不匹配，把它放在第一只袜子旁边。如果是的话，有一对。这样一来，有多少组合并不重要，而且你拿起的每只袜子只有两种可能性——要么它有一个已经在你的袜子阵列中的匹配，要么没有，这意味着你将其添加到数组中的某个位置。

这也意味着您几乎可以肯定永远不会将所有袜子放在阵列中，因为袜子会在匹配时被移除。

* * *

## 回答 #25

> 赞同：10
> 
> 时间：2014-04-30T09:18:15.820

我希望我可以为这个问题贡献一些新的东西。我注意到所有答案都忽略了这样一个事实，即您可以在两点上执行**预处理**，而不会降低整体洗衣性能。

此外，我们不需要假设大量的袜子，即使对于大家庭也是如此。袜子从抽屉里拿出来穿上，然后扔到一个地方（可能是一个垃圾箱），然后再洗。虽然我不会将所说的 bin 称为 LIFO-Stack，但我会说可以安全地假设

1.  人们将两只袜子大致扔在垃圾箱的同一区域，
2.  bin 在任何时候都不是随机的，因此
3.  从这个箱子顶部取出的任何子集通常都包含一对袜子。

由于我所知道的所有洗衣机的尺寸都是有限的（不管你要洗多少只袜子），而实际的随机化发生在洗衣机中，无论​​我们有多少袜子，我们总是有小的子集，其中几乎没有单身人士。

我们的两个预处理阶段是“把袜子放在晾衣绳上”和“从晾衣绳上拿袜子”，为了得到不仅干净而且干燥的袜子，我们必须这样做。与洗衣机一样，晾衣绳是有限的，我假设我们将袜子放在视线范围内的整个部分。

这是 put_socks_on_line() 的算法：

```
while (socks left in basket) {
 take_sock();
 if (cluster of similar socks is present) { 
   Add sock to cluster (if possible, next to the matching pair)
 } else {
  Hang it somewhere on the line, this is now a new cluster of similar-looking socks.      
  Leave enough space around this sock to add other socks later on 
 }
} 
```

不要浪费时间移动袜子或寻找最佳匹配，这一切都应该在 O(n) 中完成，我们也需要将它们放在未排序的线上。袜子还没有配对，我们只有几个相似的集群。在这里我们有一组有限的袜子很有帮助，因为这有助于我们创建“好”的集群（例如，如果袜子组中只有黑色袜子，那么按颜色进行聚类就不是可行的方法）

这是 take_socks_from_line() 的算法：

```
while(socks left on line) {
 take_next_sock();
 if (matching pair visible on line or in basket) {
   Take it as well, pair 'em and put 'em away
 } else {
   put the sock in the basket
 } 
```

我应该指出，为了提高剩余步骤的速度，明智的做法是不要随机挑选下一个袜子，而是从每个集群中依次取出一个接一个的袜子。这两个预处理步骤都不会比将袜子放在生产线或篮子里花费更多的时间，无论如何我们都必须这样做，因此这应该会大大提高洗衣性能。

在此之后，很容易进行哈希分区算法。通常，大约 75% 的袜子已经配对，只剩下一小部分袜子，而且这个子集已经（有点）聚集（在预处理步骤之后我没有在我的篮子中引入太多熵）。另一件事是剩余的集群往往足够小，可以立即处理，因此可以从篮子中取出整个集群。

这是 sort_remaining_clusters() 的算法：

```
while(clusters present in basket) {
  Take out the cluster and spread it
  Process it immediately
  Leave remaining socks where they are
} 
```

在那之后，只剩下几只袜子了。这是我将之前未配对的袜子引入系统并在没有任何特殊算法的情况下处理剩余的袜子的地方 - 剩余的袜子非常少，并且可以非常快速地在视觉上处理。

对于所有剩余的袜子，我假设它们的对应物仍未洗涤并将它们放在下一次迭代中。如果您发现未配对的袜子随着时间的推移而增加（“袜子泄漏”），您应该检查您的垃圾箱 - 它可能会随机出现（您是否有猫在里面睡觉？）

我知道这些算法需要很多假设：一个充当某种 LIFO 堆栈的垃圾箱、一个有限的普通洗衣机和一个有限的普通晾衣绳——但这仍然适用于大量袜子。

关于并行性：只要你把两只袜子都扔进同一个箱子里，你就可以轻松地并行化所有这些步骤。

* * *

## 回答 #26

> 赞同：9
> 
> 时间：2013-10-08T22:47:51.180

排序**你的 n 双袜子的问题是 O(n)**。在你把它们扔进洗衣**篮**之前，你先把左边的一个穿到右边的。取出它们时，您剪断线并将每一对放入您的抽屉 - 对 n 对进行 2 次操作，所以 O(n)。

现在下一个问题只是你是否自己洗衣服而你的妻子洗她的衣服。这可能是一个**完全不同领域的问题**。:)

* * *

## 回答 #27

> 赞同：9
> 
> 时间：2014-09-21T08:49:55.453

如果“移动”操作相当昂贵，而“比较”操作很便宜，并且无论如何您都需要将整个集合移动到搜索比原始存储快得多的缓冲区中......只需将排序集成到强制性移动。

我发现将分类过程整合到悬挂晾干中变得轻而易举。无论如何，我都需要拿起每只袜子，然后把它挂起来（移动），把它挂在绳子上的特定位置几乎没有任何成本。现在只是不强制搜索整个缓冲区（字符串），我选择按颜色/阴影放置袜子。左边更黑，右边更亮，前面更彩色等等。现在在我挂每只袜子之前，如果已经有匹配的袜子，我会查看它的“右侧附近”——这将“扫描”限制为 2-3 只其他袜子——如果是，我把另一个挂在它旁边。然后我把它们卷成对，同时从琴弦上取下，干燥时。

现在，这似乎与最佳答案所建议的“按颜色形成堆”并没有什么不同，但首先，通过不选择离散的堆而是范围，我可以毫无问题地将“紫色”归为“红色”或“蓝色”堆；它只是介于两者之间。然后通过集成两个操作（挂起干燥和排序），挂起时排序的开销大约是单独排序的 10%。

* * *

## 回答 #28

> 赞同：9
> 
> 时间：2013-09-08T20:07:14.640

创建一个哈希表，用于不匹配的袜子，使用模式作为哈希。一件一件地遍历袜子。如果袜子在哈希表中有模式匹配，则将袜子从表中取出并配对。如果袜子没有火柴，就把它放到桌子上。

* * *

## 回答 #29

> 赞同：9
> 
> 时间：2013-10-27T18:45:12.003

我刚刚完成了我的袜子配对，我发现最好的方法是：

*   选择其中一只袜子并将其收起来（为那双创建一个“桶”）
*   如果下一个是前一个的对，则将其放入现有存储桶中，否则创建一个新存储桶。

在最坏的情况下，这意味着您将有 n/2 个不同的桶，并且您将有 n-2 个关于哪个桶包含当前袜子的决定。显然，如果你只有几对，这个算法效果很好；我用 12 双做的。

它不是那么科学，但效果很好:)

* * *

## 回答 #30

> 赞同：9
> 
> 时间：2015-05-27T19:13:52.293

我的解决方案并不完全符合您的要求，因为它正式需要`O(n)`“额外”空间。但是，考虑到我的情况，它在我的实际应用中非常有效。因此，我认为这应该很有趣。

## 与其他任务结合

在我的情况下，特殊情况是我不使用烘干机，只是将我的衣服挂在普通的干衣机上。挂布需要`O(n)`操作（顺便说一下，我在这里总是考虑[装箱](http://en.wikipedia.org/wiki/Bin_packing_problem])问题），问题本质上需要线性“额外”空间。当我从桶里拿出一只新袜子时，如果那双已经挂了，我会试着把它挂在它旁边。如果它是一双新袜子，我会在旁边留一些空间。

## 甲骨文机器更好;-)

显然需要一些额外的工作来检查是否有匹配的袜子已经挂在某个地方，它会为计算机`O(n^2)`提供系数约为的解决方案。`1/2`但在这种情况下，“人为因素”实际上是一个优势——`O(1)`如果它已经挂起，我通常可以非常快速（几乎）识别匹配的袜子（可能涉及一些难以察觉的脑内缓存）——认为它是一种有限的“oracle”，如[Oracle Machine](http://en.wikipedia.org/wiki/Oracle_machine) ;-) 在某些情况下，我们人类比数字机器具有这些优势 ;-)

## 差不多了`O(n)`！

因此，将袜子配对问题与挂布问题联系起来，我`O(n)`免费获得“额外空间”，并且有一个`O(n)`及时的解决方案，只需要比简单的挂布多一点工作，并允许立即访问整双即使在一个非常糟糕的星期一早上也穿袜子...... ;-)

* * *

## 回答 #31

> 赞同：8
> 
> 时间：2013-01-24T19:53:38.770

做一些预处理怎么样？我会在每只袜子上缝上一个标记或 ID 号，使每对都具有相同的标记/ID 号。每次您购买新袜子时，都可能会执行此过程。然后，您可以进行[基数排序](https://en.wikipedia.org/wiki/Radix_sort)以获得 O(n) 总成本。为每个标记/ID 编号找到一个位置，然后将所有袜子一件一件地挑选出来，然后将它们放入正确的位置。

* * *

## 回答 #32

> 赞同：7
> 
> 时间：2013-09-09T14:43:19.627

在我攻读博士学位（计算机科学）期间，我经常想到这一点。我想出了多种解决方案，这取决于区分袜子的能力，从而尽快找到正确的袜子对。

假设查看袜子并**记住其独特图案的成本可以忽略不计**（ε）。那么最好的解决办法就是把所有袜子都扔在桌子上。这涉及以下步骤：

1.  将所有袜子扔在一张桌子上 (1) 并创建一个 hashmap {pattern: position} (ε)
2.  虽然还有剩余的袜子（n/2）：
    1.  随机挑选一只袜子 (1)
    2.  找到对应袜子的位置 (ε)
    3.  检索袜子 (1) 并存储对

这确实是最快的可能性，并且以 n + 1 = O(n) 复杂度执行。但它假设你完全记得所有模式......实际上，情况并非如此，我个人的经验是，你有时在第一次尝试时找不到匹配的对：

1.  把所有袜子都扔在桌子上 (1)
2.  虽然还有剩余的袜子（n/2）：
    1.  随机挑选一只袜子 (1)
    2.  未配对时（1/P）：
        1.  找到类似图案的袜子
        2.  拿袜子比较两者（1）
        3.  如果没问题，存储对

这现在取决于我们找到匹配对的能力。如果您有通常具有非常相似图案的深色/灰色双或白色运动袜，则尤其如此！让我们承认你有 P 的概率找到相应的袜子。在找到相应的袜子以形成一双之前，您平均需要 1/P 尝试。总体复杂度为 1 + (n/2) * (1 + 1/P) = O(n)。

两者在袜子数量上都是线性的，并且是非常相似的解决方案。让我们稍微修改一下这个问题，承认你在套装中**有多双相似的袜子**，并且很**容易一次存储多双袜子**(1+ε)。对于 K 个不同的模式，您可以实现：

1.  对于每只袜子 (n)：
    1.  随机挑选一只袜子 (1)
    2.  把它放在它的图案的簇上
2.  对于每个集群 (K)：
    1.  取集群并存储成对的袜子 (1+ε)

整体复杂度变为 n+K = O(n)。它仍然是线性的，但选择正确的算法现在可能很大程度上取决于 P 和 K 的值！但是有人可能会再次反对，您可能很难为每只袜子找到（或创建）集群。

此外，您还可以通过在网站上查看最佳算法并提出自己的解决方案来节省时间:)

* * *

## 回答 #33

> 赞同：5
> 
> 时间：2017-02-16T02:53:05.900

# 一种从一堆中配对袜子的有效算法

**前提条件**

1.  袜子堆中必须至少有一只袜子
2.  桌子必须足够大以容纳 N/2 只袜子（最坏情况），其中 N 是袜子的总数。

**算法**

尝试：

1.  挑选第一只袜子
2.  把它放在桌子上
3.  挑选下一只袜子，然后查看（可能会抛出“没有更多袜子”异常）
4.  现在扫描桌子上的袜子（如果桌子上没有袜子，则抛出异常）
5.  有比赛吗？a) 是 => 从桌子上移除匹配的袜子 b) 否 => 将袜子放在桌子上（可能会抛出“桌子不够大”异常）

除了：

*   桌子不够大：
       小心地将所有未配对的袜子混合在一起，然后恢复操作
       //此操作将导致新堆和空桌子

*   桌子上没有袜子了：
       扔（最后一只无法配对的袜子）

*   没有袜子留在堆里：
       退出洗衣房

最后：

*   如果堆里还有袜子：
       goto 3

**已知的问题**

如果周围没有桌子或桌子上没有足够的空间容纳至少一只袜子，该算法将进入无限循环。

**可能的改进**

根据要分类的袜子数量，如果有足够的空间，可以通过对桌子上的袜子进行分类*来增加吞吐量。*

为了使它起作用，需要一个属性，该属性对每双袜子都有一个唯一的值。这样的属性可以很容易地从袜子的视觉属性中合成。

按所述属性对桌子上的袜子进行排序。我们称该属性为“颜色”。将袜子排成一排，将深色袜子放在右侧（即 .push_back()），将浅色袜子放在左侧（即 .push_front()）

对于大堆，尤其是以前看不见的袜子，属性合成可能需要大量时间，因此吞吐量会明显下降。但是，这些属性可以保存在内存中并重复使用。

需要进行一些研究来评估这种可能的改进的效率。出现以下问题：

*   使用上述改进来配对的最佳袜子数量是多少？
*   对于给定数量的袜子，在吞吐量增加之前需要多少次迭代？
    a) 最后一次迭代
    b) 总体上所有迭代

PoC 符合[MCVE](https://stackoverflow.com/help/mcve)指南：

```
#include <iostream>
#include <vector>
#include <string>
#include <time.h>

using namespace std;

struct pileOfsocks {
    pileOfsocks(int pairCount = 42) :
        elemCount(pairCount<<1) {
        srand(time(NULL));
        socks.resize(elemCount);

        vector<int> used_colors;
        vector<int> used_indices;

        auto getOne = [](vector<int>& v, int c) {
            int r;
            do {
                r = rand() % c;
            } while (find(v.begin(), v.end(), r) != v.end());
            v.push_back(r);
            return r;
        };

        for (auto i = 0; i < pairCount; i++) {
            auto sock_color = getOne(used_colors, INT_MAX);
            socks[getOne(used_indices, elemCount)] = sock_color;
            socks[getOne(used_indices, elemCount)] = sock_color;
        }
    }

    void show(const string& prompt) {
        cout << prompt << ":" << endl;
        for (auto i = 0; i < socks.size(); i++){
            cout << socks[i] << " ";
        }
        cout << endl;
    }

    void pair() {
        for (auto i = 0; i < socks.size(); i++) {
            std::vector<int>::iterator it = find(unpaired_socks.begin(), unpaired_socks.end(), socks[i]);
            if (it != unpaired_socks.end()) {
                unpaired_socks.erase(it);
                paired_socks.push_back(socks[i]);
                paired_socks.push_back(socks[i]);
            }
            else
                unpaired_socks.push_back(socks[i]);
        }

        socks = paired_socks;
        paired_socks.clear();
    }

private:
    int elemCount;
    vector<int> socks;
    vector<int> unpaired_socks;
    vector<int> paired_socks;
};

int main() {
    pileOfsocks socks;

    socks.show("unpaired socks");
    socks.pair();
    socks.show("paired socks");

    system("pause");
    return 0;
} 
```

* * *

## 回答 #34

> 赞同：5
> 
> 时间：2021-04-13T06:35:53.443

正如许多作者所指出的，基数排序是一种对袜子进行排序的有效方法。尚未提出的是一种完美的散列方法。使用购买每双袜子的时间就是这样一个哈希值。只需在购买袜子时按顺序对袜子进行编号，您就可以将它们放在自己编号的抽屉中。

最多 24 双袜子的示例。请注意，较大的袜子隔间消除了将袜子卷在一起的需要，即所谓的速度/存储折衷。

[![最多 24 双袜子的示例。 请注意，较大的袜子隔间消除了将袜子卷在一起的需要，即所谓的速度/存储折衷。](../Images/4cd63f11933ea90b224d65da3ff8c924.png)](https://i.stack.imgur.com/m6VAn.jpg)

* * *

## 回答 #35

> 赞同：3
> 
> 时间：2014-05-25T09:46:20.497

我提出的解决方案假设所有袜子在细节上都是相同的，除了*颜色*。如果袜子之间有更多细节需要延迟，这些细节可用于定义不同类型的袜子，而不是我的示例中的颜色。

假设我们有一堆袜子，一只袜子可以有三种颜色：蓝色、红色或绿色。

然后我们可以为每种颜色创建一个*并行*工作者；它有自己的列表来填充相应的颜色。

```
At time i:

Blue  read  Pile[i]    : If Blue  then Blue.Count++  ; B=TRUE  ; sync

Red   read  Pile[i+1]  : If Red   then Red.Count++   ; R=TRUE  ; sync

Green read  Pile [i+2] : If Green then Green.Count++ ; G=TRUE  ; sync 
```

带同步过程：

```
Sync i:

i++

If R is TRUE:
    i++
    If G is TRUE:
        i++ 
```

这需要初始化：

```
Init:

If Pile[0] != Blue:
    If      Pile[0] = Red   : Red.Count++
    Else if Pile[0] = Green : Green.Count++

If Pile[1] != Red:
    If Pile[0] = Green : Green.Count++ 
```

在哪里

```
Best Case: B, R, G, B, R, G, .., B, R, G

Worst Case: B, B, B, .., B

Time(Worst-Case) = C * n ~ O(n)

Time(Best-Case) = C * (n/k) ~ O(n/k)

n: number of sock pairs
k: number of colors
C: sync overhead 
```

* * *

## 回答 #36

> 赞同：3
> 
> 时间：2017-08-17T18:18:17.970

两条思路，查找任何匹配项所需的速度，与查找所有匹配项所需的速度与存储相比。

对于第二种情况，我想指出一个 GPU 并行版本，它会查询袜子的所有匹配项。

如果您有多个要匹配的属性，您可以使用分组元组和更高级的 zip 迭代器以及推力的变换函数，虽然这里是一个简单的基于 GPU 的查询：

```
//test.cu
#include <thrust/device_vector.h>
#include <thrust/sequence.h>
#include <thrust/copy.h>
#include <thrust/count.h>
#include <thrust/remove.h>
#include <thrust/random.h>
#include <iostream>
#include <iterator>
#include <string>

// Define some types for pseudo code readability
typedef thrust::device_vector<int> GpuList;
typedef GpuList::iterator          GpuListIterator;

template <typename T>
struct ColoredSockQuery : public thrust::unary_function<T,bool>
{
    ColoredSockQuery( int colorToSearch )
    { SockColor = colorToSearch; }

    int SockColor;

    __host__ __device__
    bool operator()(T x)
    {
        return x == SockColor;
    }
};

struct GenerateRandomSockColor
{
    float lowBounds, highBounds;

    __host__ __device__
    GenerateRandomSockColor(int _a= 0, int _b= 1) : lowBounds(_a), highBounds(_b) {};

    __host__ __device__
    int operator()(const unsigned int n) const
    {
        thrust::default_random_engine rng;
        thrust::uniform_real_distribution<float> dist(lowBounds, highBounds);
        rng.discard(n);
        return dist(rng);
    }
};

template <typename GpuListIterator>
void PrintSocks(const std::string& name, GpuListIterator first, GpuListIterator last)
{
    typedef typename std::iterator_traits<GpuListIterator>::value_type T;

    std::cout << name << ": ";
    thrust::copy(first, last, std::ostream_iterator<T>(std::cout, " "));
    std::cout << "\n";
}

int main()
{
    int numberOfSocks = 10000000;
    GpuList socks(numberOfSocks);
    thrust::transform(thrust::make_counting_iterator(0),
                      thrust::make_counting_iterator(numberOfSocks),
                      socks.begin(),
                      GenerateRandomSockColor(0, 200));

    clock_t start = clock();

    GpuList sortedSocks(socks.size());
    GpuListIterator lastSortedSock = thrust::copy_if(socks.begin(),
                                                     socks.end(),
                                                     sortedSocks.begin(),
                                                     ColoredSockQuery<int>(2));
    clock_t stop = clock();

    PrintSocks("Sorted Socks: ", sortedSocks.begin(), lastSortedSock);

    double elapsed = (double)(stop - start) * 1000.0 / CLOCKS_PER_SEC;
    std::cout << "Time elapsed in ms: " << elapsed << "\n";

    return 0;
}

    //nvcc -std=c++11 -o test test.cu 
```

1000 万只袜子的运行时间：9 毫秒

* * *

## 回答 #37

> 赞同：-3
> 
> 时间：2013-01-21T14:47:36.177

如果您可以将一对袜子抽象为键本身并将另一对袜子抽象为值，我们就可以使用散列来发挥我们的杠杆作用。

1.  在地板上画出你身后的两个假想部分，一个给你，另一个给你的配偶。

2.  从一堆袜子中取出一只。

3.  现在按照以下规则将袜子一只一只地放在地板上。

    *   确定袜子是你的还是她的，然后查看地板上的相关部分。

    *   如果你能在地板上看到这对，就把它捡起来打结或夹起来，或者在你找到一对后做任何你想做的事情，然后把它放在一个篮子里（把它从地板上取下来）。

    *   将其放在相关部分。

4.  重复 3 直到所有袜子都从堆中取出。

* * *

解释：

**散列和抽象**

抽象是一个非常强大的概念，已被用于改善用户体验 (UX)。在现实生活中与计算机交互的抽象示例包括：

*   文件夹图标用于在 GUI（图形用户界面）中导航以访问地址，而不是键入实际地址以导航到某个位置。
*   用于控制各种级别的音量、文档滚动位置等的 GUI 滑块。

> 散列或其他非就地解决方案不是一种选择，因为我无法复制我的袜子（尽管如果可以的话可能会很好）。

我相信提问者正在考虑应用散列，以便在放置它们之前应该知道任何一对袜子所在的插槽。

*这就是为什么我建议将放在地板上的单个袜子抽象为哈希键本身*（因此不需要复制袜子）。

如何定义我们的哈希键？

*如果有不止一对类似的袜子，我们的密钥的以下定义也将起作用。也就是说，假设有两双黑人男袜 PairA 和 PairB，每双袜子分别命名为 PairA-L、PairA-R、PairB-L、PairB-R。所以PairA-L可以和PairB-R配对，但是PairA-L和PairB-L不能配对。*

假设任何袜子都可以通过以下方式唯一识别，

`Attribute[Gender] + Attribute[Colour] + Attribute[Material] + Attribute[Type1] + Attribute[Type2] + Attribute[Left_or_Right]`

这是我们的第一个哈希函数。让我们为此使用一个简短的符号`h1(G_C_M_T1_T2_LR)`。**h1(x)**不是我们的位置键。

另一个消除 Left_or_Right 属性的散列函数是`h2(G_C_M_T1_T2)`. 第二个函数**h2(x)**是我们的位置键！（对于您身后地板上的空间）。

*   要定位插槽，请使用 h2(G_C_M_T1_T2)。
*   一旦找到插槽，然后使用 h1(x) 检查它们的哈希值。如果他们不匹配，你有一对。否则将袜子扔到同一个插槽中。

注意：由于我们在找到一对时删除了一对，因此可以安全地假设最多只有一个具有唯一 h2(x) 或 h1(x) 值的插槽。

*如果我们每只袜子都只有一对匹配，则使用 h2(x) 查找位置，如果没有配对，则需要检查，因为可以安全地假设它们是一对。*

**为什么把袜子放在地板上很重要**

让我们考虑这样一种情况，即袜子彼此堆叠成一堆（最坏的情况）。这意味着我们别无选择，只能进行线性搜索以找到一对。

将它们散布在地板上可以提高可见度，从而提高发现匹配袜子的机会（匹配哈希键）。在第 3 步中，当一只袜子放在地板上时，我们的大脑已经下意识地记录了这个位置。- 所以如果这个位置在我们的记忆中可用，我们可以直接找到匹配的对。- 如果位置不记得了，别担心，我们可以随时恢复线性搜索。

**为什么从地板上取下这对很重要？**

*   当要记住的项目较少时，人类的短期记忆效果最好。从而增加了我们诉诸散列来发现该对的可能性。
*   当使用该对的线性搜索时，它还将减少要搜索的项目数。

**分析**

1.  案例 1：最坏的情况是 Derpina 无法直接使用散列技术记住或发现地板上的袜子。Derp 对地板上的物品进行线性搜索。这并不比遍历堆以找到该对更糟糕。
    *   比较上限：O(n^2)。
    *   比较的下限：(n/2)。（当 Derpina 拿起的每只袜子都是前一双）。
2.  案例 2：Derp 记住他放在地板上的每只袜子的位置，并且每只袜子正好有一对。
    *   比较上限：O(n/2)。
    *   比较的下限：O(n/2)。

我说的是比较操作，从一堆中挑选袜子必然是 n 次操作。因此，实际的下限将是 n 次迭代和 n/2 次比较。

**加快速度**

为了获得一个完美的分数，以便 Derp 获得 O(n/2) 比较，我会推荐 Derpina，

*   花更多时间在袜子上熟悉它。是的，这也意味着花更多时间在 Derp 的袜子上。
*   玩记忆游戏，比如找出网格中的配对可以提高短期记忆表现，这可能是非常有益的。

**这是否等同于元素区别问题？**

我建议的方法是用于解决元素区别问题的方法之一，您将它们放在哈希表中并进行比较。

鉴于您只存在一对精确对的特殊情况，它已变得非常等同于元素不同问题。因为我们甚至可以对袜子进行分类并检查相邻的袜子是否成对（EDP 的另一种解决方案）。

但是，如果给定的袜子可能存在不止一对，则它会偏离 EDP。

# javascript - 是否有任何理由为什么 onreadystatechange 不会为 safari 中的 css 标头链接做任何事情？

> ID：14415888
> 
> 赞同：0
> 
> 时间：2013-01-19T15:35:32.063
> 
> 标签：javascript, jquery, header, onreadystatechange

我制作了一个加载多个标题的书签。一些 JS 一些 CSS。创建标题元素后，我会`onreadystatechange`检查包含的标题何时加载。

但是由于某种原因，此检查不适用于 css 标头的 safari。

这是它的代码：

```
var CssScript = document.createElement("link");
CssScript.href = "http://domain.com/css/bookmarklet.css";
CssScript.setAttribute('type', 'text/css');
CssScript.setAttribute('rel', 'stylesheet');
CssScript.setAttribute('media', 'all');
CssScript.setAttribute('id', 'yk_bookmarklet_css');
CssScript.onload = CssScript.onreadystatechange = function(){
    console.log("asdfasdfasdfasdf");
    if (!done && (!this.readyState || this.readyState == "loaded" || this.readyState == "complete")) {
        loaded_headers++;
        console.log('Next2');
        if(loaded_headers >= total_headers){
            done = true;
            $.getJSON("http://www.shopsavr.com/bookmarklet_getjson_functions.php?jsoncallback=?", {'url' : encodeURIComponent(document.URL)},
                function(data){
                    collections = data.collecitons;
                    product_found = data.product;
                    uID = data.uID;
                    url = data.url;
                    window.mbm = false;
                    initMyBookmarklet();
                });
        }
    }
}; 
```

这在 IE、FF、chrome、Opera 中完美运行 - 它只在 safari 上失败。

# php - ajax 上的 Google 图表仅在第一次工作

> ID：14415889
> 
> 赞同：0
> 
> 时间：2013-01-19T15:35:35.407
> 
> 标签：php, javascript, jquery, google-visualization

这是一个两个问题，我的代码的实际状态是这样的：

```
<script type="text/javascript">
init_ui();
function init_ui() {

        $("[rel='tooltip']").tooltip();

        $(".ajax_link").live("click",function(){
            id = $(this).attr("id");
            jQuery("#ajax_div").html('<img src="../../../../bundles/donepunctis/img/loading.gif" alt="loading...">');
            jQuery.ajax({
                url: '<?= $view['router'] -> generate('done_punctis_ajax_detail_data_url'); ?>' + '?id=' + id,
                success:function(result){
                    jQuery("#ajax_div").html('');
                    //alert(data);
                    chart.draw(data, options);
                }
     });
        })
}

var data;
var options;
var chart;

      // Load the Visualization API and the piechart package.
      google.load('visualization', '1.0', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.setOnLoadCallback(drawChart);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {

        // Create the data table.
        data = new google.visualization.DataTable();
        data.addColumn('string', 'Topping');
        data.addColumn('number', 'Slices');
        data.addRows([
          ['Mushrooms', 3],
          ['Onions', 1],
          ['Olives', 1],
          ['Zucchini', 1],
          ['Pepperoni', 2]
        ]);

        // Set chart options
        options = {'title':'How Much Pizza I Ate Last Night',
                       'width':400,
                       'height':300};

        // Instantiate and draw our chart, passing in some options.
        chart = new google.visualization.PieChart(document.getElementById('ajax_div'));

      }
</script> 
```

目前，我只是忽略了 ajax 调用的返回，将数据用于图表 somministrated 硬编码在 var 数据上。

1.  如何在 php 端查看我的 echo 以返回我现在使用的相同值，但从 ajax 返回传递？

2.  此代码第一次运行良好，但如果尝试再次单击 ajax_link 会触发 ajax 调用，但 google 图表代码不执行任何操作。这是为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:43:31.360

# 此代码第一次运行良好，但如果尝试再次单击 ajax_link 会触发 ajax 调用，但 google 图表代码不执行任何操作。这是为什么？

查看`$.ajax`通话中的成功回调：

```
jQuery.ajax({
  url: '<?= $view['router'] -> generate('done_punctis_ajax_detail_data_url'); ?>' + '?id=' + id,
  success:function(result){
  jQuery("#ajax_div").html('');
    chart.draw(data, options);
  }
}); 
```

您正在调用`chart.draw(data, options);`，它只是使用您上次填充的数据重新绘制图表。

您可能想调用`drawChart`并传入新数据：

```
jQuery.ajax({
  url: '<?= $view['router'] -> generate('done_punctis_ajax_detail_data_url'); ?>' + '?id=' + id,
  success:function(result){
  jQuery("#ajax_div").html('');
    drawChart(data);
  }
}); 
```

然后`drawChart`你可以用你的新数据填充图表：

```
function drawChart(myData) {
  // Create the data table.
  data = new google.visualization.DataTable();
  data.addColumn('string', 'Topping');
  data.addColumn('number', 'Slices');
  if(myData) {
    // TODO: add rows based on myData
  } else {
    data.addRows([
      ['Mushrooms', 3],
      ['Onions', 1],
      ['Olives', 1],
      ['Zucchini', 1],
      ['Pepperoni', 2]
    ]);
  }
  ... 
```

# c# - LongListMultiSelector 阻止所选项目的手势事件

> ID：14415893
> 
> 赞同：3
> 
> 时间：2013-01-19T15:35:48.203
> 
> 标签：c#, xaml, events, windows-phone-8

在以下 XAML 中，当在`TextBlock`中选择any 时`LongListMultiSelector`，它会`TextBlock`停止接收`Tap`事件（和任何其他手势事件），但当我再次点击它时会变为未选中状态。我怎样才能改变这种行为，无论它的选择状态如何，它`TextBlock`都会始终响应？`Tap`

```
<toolkit:LongListMultiSelector ItemsSource="{Binding Items}">
    <toolkit:LongListMultiSelector.ItemTemplate>
        <DataTemplate>
            <!-- When TextBlock is selected, Debug_WriteLine_Tapped does not get called -->
            <TextBlock Text="{Binding name}" Tap="Debug_WriteLine_Tapped" />
        </DataTemplate>
    </toolkit:LongListMultiSelector.ItemTemplate>
</toolkit:LongListMultiSelector> 
```

基本上我正在寻找的是一种类似于标准邮件应用程序的行为，在选择一堆字母后，他们仍然会收到`Tap`事件，因为我仍然可以展开/折叠其中任何一个（除了在我的情况下它是一个简单`TextBlock`的 s 而不是`ExpanderView`s)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T04:26:55.330

该工具包使用此信号来响应点击。

```
private void OnItemContentTap(object sender, System.Windows.Input.GestureEventArgs e) 
```

该示例定义了与 LongListMultiSelector 构造分开的数据模板

```
<phone:PhoneApplicationPage.Resources> 
```

部分并将其引用为

```
ItemTemplate="{StaticResource EmailItemTemplate}. 
```

有关示例，请参阅工具包中的 LongListMultiSelectorSample.xaml。该样本实际上是不完整的，起初可能会令人困惑。只需忽略 BuddiesPivotItem 和 GridModeItem，除非您想完成它并使整个工作正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T02:51:01.250

在我的机器上工作正常。当我点击这 3 个项目时，我会在调试日志中收到预期的消息。

```
<phone:LongListSelector ItemsSource="{Binding}">
    <phone:LongListSelector.ItemTemplate>
        <DataTemplate>
            <Grid >
                <TextBlock Text="{Binding}" Tap="TextBlock_Tap_1" />
            </Grid>
        </DataTemplate>
    </phone:LongListSelector.ItemTemplate>
</phone:LongListSelector> 
```

```
private void MainPage_Loaded(object sender, RoutedEventArgs e)
{
    this.DataContext = "Foo Bar Baz".Split(' ');
}

private void TextBlock_Tap_1(object sender, GestureEventArgs e)
{
    Debug.WriteLine("TextBlock_Tap_1");
} 
```

根据您的场景，WP8 公开了可能有用的[UseOptimizedManipulationRouting属性。](http://msdn.microsoft.com/en-US/library/windowsphone/develop/system.windows.frameworkelement.useoptimizedmanipulationrouting%28v=vs.105%29.aspx)设置 UseOptimizedManipulationRouting=false 会导致 LongListSelector、Pivo​​t 和其他控件不会吞下嵌套控件的事件。设置它的好地方是 LongListSelector.ItemTemplate 的根控件。

# ruby-on-rails - Rails 片段缓存和时间戳显示

> ID：14415897
> 
> 赞同：1
> 
> 时间：2013-01-19T15:36:10.227
> 
> 标签：ruby-on-rails, caching, fragment-caching

我正在开发一个社交网络，比如基于体育的 Twitter 和 Facebook 的混合体。我有一个名为 Post（id、user_id、receiver_id、message、created_at）的模型，我想缓存 Post 视图。

### 应用程序/视图/帖子/_post.haml

```
- cache post do
  %div
    .author= link_to post.user.full_name, post.user
    .message= post.message
    .timestamp= timestamp_for_post(post.created_at) 
```

昨天一切正常，但是当我访问我的“主页”时，我意识到时间戳已被缓存。让我给你看一个例子：

```
伯纳·卡斯特罗
测试
不到一分钟前 - 评论道具删除

```

问题是它不应该显示“不到一分钟前”，而应该显示“昨天”。有没有办法不缓存时间戳？你有什么建议来解决这个问题？

我想通过 AJAX 调用来获取时间戳，但这很奇怪而且不好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:58:32.770

不要渲染相对时间戳，而是在模板中渲染实际的非相对时间戳，然后使用[Moment.js](http://momentjs.com/)之类的东西将其转换为相对时间戳客户端。

这还有一个优点，如果用户打开页面足够长的时间，相对时间戳会改变，时间戳会自行更新。

您还应该考虑不缓存任何内容，直到您真正了解您网站上的内容很慢。缓存有很多这样的陷阱，过早的优化并不总是值得的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T22:48:11.087

您可以将时间戳移出缓存块

```
 %div
   - cache post do
      .author= link_to post.user.full_name, post.user
      .message= post.message
   .timestamp= timestamp_for_post(post.created_at) 
```

# html - 无论如何，HTML 表格都不适合整个屏幕

> ID：14415905
> 
> 赞同：0
> 
> 时间：2013-01-19T15:36:59.853
> 
> 标签：html

基本上，我的网站上有一张不适合浏览器屏幕 100% 宽度的表格。即使我将宽度更改为 110%，它也只是与右侧重叠，但左侧仍有一个边距空间（表格的外部空间）。我希望表格从左到右完全压在浏览器屏幕上，完全没有空格或边框。我该怎么做呢？我已经尝试了一切，但仍然无法正常工作。我什至尝试了负边距和填充

请帮助我失去理智。这是我的代码：

```
<table bgcolor="#DBD9D9" rules="none" border="0" width="110%"cellspacing="0" cellpadding="0">
  <tr>
    <td>TEXT HERE</td>
  </tr>
</table> 
```

更新：我像 colin 建议的那样将 css 代码添加到标题中，但它仍然不起作用。正文 {margin:10px;} 表 {margin:0 -10px;}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:40:09.810

不要忘记`margin: 0;`在`<body>`标签中添加一个！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T15:40:21.887

正文中有一个默认边距需要删除。

将以下css添加到`<head>`

```
<style type="text/css">
    body {margin:0;} 
</style> 
```

或者

```
<style type="text/css">
    body {margin:10px;}
    table {margin:0 -10px;}
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T15:40:52.637

我也有过这种情况：解决方案是将主体的边距和填充设置为 0。（也许宽度为 100% 也有帮助。）

# android - Android EditText 奇怪的高度问题

> ID：14415908
> 
> 赞同：1
> 
> 时间：2013-01-19T15:37:16.200
> 
> 标签：android, android-layout, android-edittext

我无法真正解释这一点，所以我将使用一张图片：

![身高问题](../Images/3e1b60b7917398bcecf720a11cf431e8.png)

好的，如您所见，实际的`EditText`View 比实际的白色（可编辑区域）略高。这怎么样？我已经删除了 View 的所有填充和边距，但它看起来仍然很糟糕。

`EditText`在设备上部署此视图时，我还有另外 2 个问题：

1.  它会自动捕获焦点（如何禁用此功能？）
2.  对焦时，有一个橙色边框，但实际可编辑区域比橙色边框宽（见截图2）：

![在此处输入图像描述](../Images/b4eb126976313d7c0783839da04a8b18.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:52:51.677

这是 pre Holo EditText 的背景：

![在此处输入图像描述](../Images/0f4aca8d35054658b193a40fd8f1e6de.png)

这是选中前 Holo EditText 时的背景：

![在此处输入图像描述](../Images/ea3a62b3be40b3d92227b5c55af7af3c.png)

如您所见，那些 9Patches 中已经有填充。所以你 EditText 的高度不会与实际可编辑区域的高度相同。我建议您将高度设置为`wrap_content`.

# c# - 将 IEnumerable 数据从 LINQ 作为参数传递给方法

> ID：14415909
> 
> 赞同：8
> 
> 时间：2013-01-19T15:37:16.293
> 
> 标签：c#, linq

> **可能重复：**
> [如何将匿名类型传递给方法？](https://stackoverflow.com/questions/55101/how-can-i-pass-an-anonymous-type-to-a-method)

我有以下`LINQ`语句，其输出必须以另一种方法处理：

```
var data = from lines in File.ReadAllLines(TrainingDataFile)
                             .Skip(ContainsHeader ? 1 : 0)
           let f = lines.Split(new[] { FieldSeparator }).ToList<String>()
           let target = f[TargetVariablePositionZeroBased]
           select new { F=f, T=target }; 
```

将获取此数据的方法中参数的数据类型应该是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T15:38:49.633

您不能从方法返回匿名数据类型。您可以定义一个类并从查询中返回该类的对象并将其传递给目标方法。

```
public class SomeClass
{
    public string F {get; set;}
    public string T {get; set;}
}

var data = from lines in File.ReadAllLines(TrainingDataFile)
                                .Skip(ContainsHeader ? 1 : 0)
               let f = lines.Split(new[] { FieldSeparator }).ToList<String>()
               let target = f[TargetVariablePositionZeroBased]
               select new SomeClass { F=f, T=target }; 
```

您可以将查询结果`IEnumerable<SomeClass>`作为参数传递给方法。

```
public void MethodToCall(IEnumerable<SomeClass> someClass)
{

} 
```

通过传递此示例代码`IEnumerable<SomeClass>`中存储的查询结果 ( )来调用方法`data`

```
MethodToCall(data); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-19T15:40:05.550

你不能很容易地传递匿名类型。您可以创建一个类，或者由于您的数据只有两个属性，请使用`Tuple`：

```
select new Tuple<List<string>, string> (f, target); 
```

如果我的数据类型正确，那么参数的数据类型将是：

```
IEnumerable<Tuple<List<string>, string>> 
```

并且您将引用`F`和`T`使用`Tuple`属性`Item1`和`Item2`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-19T15:46:26.623

1）只是为了传递查询的结果，使你的函数通用，这样就可以了：

```
var data = from lines in File.ReadAllLines(TrainingDataFile)
                         .Skip(ContainsHeader ? 1 : 0)
       let f = lines.Split(new[] { FieldSeparator }).ToList<String>()
       let target = f[TargetVariablePositionZeroBased]
       select new { F=f, T=target };

SomeMethod(data);

public void SomeMethod<T>(IEnumerable<T> enumerable)
{
    // ^^choose the return type..
} 
```

简单的。如果方法内部的处理非常简单，那么就可以了。但是您将无法访问属性`F`和`T`方法内部。

为此：

2) 您可以使用Eric[此处](https://stackoverflow.com/a/6469199/661933)显示的“示例转换”技巧。引用他的话：

> 我们使用方法类型推断和局部变量类型推断来告诉编译器“这两个东西是同一类型”。这使您可以将匿名类型导出为对象并将其转换回匿名类型。
> 
> ...该技巧仅在示例和源对象是在同一程序集中的代码中创建时才有效；两个不同程序集中的两个“相同”匿名类型不会统一为同一类型。

```
SomeMethod(data);

public void SomeMethod(IEnumerable<object> enumerable)
{
    var template = new { F = new List<string>(), T = string.Empty };
    foreach (var item in enumerable)
    {
        var anonymousType = item.CastToTypeOf(template);
        //print string.Join(", ", anonymousType.F) + " - " + anonymousType.T //compiles
        //or whatever
    }
}

//a more generic name perhaps is 'CastToTypeOf' as an extension method
public static T CastToTypeOf<T>(this object source, T example) where T : class
{
    return (T)source;
} 
```

这里的问题是`SomeMethod`现在是为您的匿名类型量身定制的，因为您在方法中指定了特定类型，所以最好不要使函数泛型（尽管您可以这样做）并为函数提供合适的名称.

3）如果函数现在只适用于您的独特类型，我最好将它们全部包装在一个方法中并且根本不通过 - 没有麻烦！:)

4）或者您可以委托对您的匿名类型执行的操作。所以方法签名就像：

```
SomeMethod(data, d => print string.Join(", ", d.F) + " - " + d.T);

public void SomeMethod<T>(IEnumerable<T> enumerable, Action<T> actor)
{
    foreach (var item in enumerable)
        actor(item);
} 
```

如果重要的话，您也可以`Func`通过多一个类型参数来委托。

5）否则，请依靠精巧的反射从您的匿名类型中获取属性。

6）`dynamic`在方法参数上使用关键字，现在你有了动态类型。以上都没有给你静态类型的好处。

7) 你最好有一个单独的类来保存`F`和`T`。这是最好的。**但是问问你自己，它们是否一起代表了一个实体**？

8）如果没有，只需通过`IEnumerable<Tuple>`或`IDictionary`取决于重要的事情。

* * *

这完全取决于您希望使用该方法实现什么/如何实现。就个人而言，我会在一个爱好项目中选择方法 2（为了获得乐趣），但在生产代码 3、4、7、8 中取决于上下文。

# php - 查找一周（或月、季度或年）的第一天和最后一天

> ID：14415914
> 
> 赞同：4
> 
> 时间：2013-01-19T15:38:02.577
> 
> 标签：php, mysql

> **可能重复：**
> [在php中获取当前第一天和最后一天](https://stackoverflow.com/questions/10634739/grab-current-first-and-last-day-in-week-in-php)

我正在尝试获取给定日期的一周、一个月、季度和一年的第一天和最后一天。

例如，对于 2013 年 1 月 16 日，第一天和最后一天是：

*   周 - 应该是 2013-01-13 和 2013-01-19（假设周日到周六）
*   月份 - 应该是 2013-01-01 和 2013-01-31
*   季度 - 将是 2013-01-01 和 2013-03-31
*   年份 - 应该是 2013-01-01 和 2013-12-31

我的目的是将它们包含在`WHERE myDate BETWEEN 2013-01-13 AND 2013-01-19`.

标准的 MYSQL 函数解决方案（但不是存储过程等）或 PHP 解决方案都是可以接受的。谢谢

* * *

给定季度的第一天和最后一天的解决方案。

```
$q=ceil($date->format("n")/3);
$months_start=array('January','April','July','October');
$months_end=array('March','June','September','December');
$m_start=$months_start[$q-1];
$m_end=$months_end[$q-1];
$modifier='first day of '.$m_start.' '.$date->format('Y');
$date->modify($modifier);
echo $modifier.': '.$date->format('Y-m-d').'<br>';
$modifier='last day of '.$m_end.' '.$date->format('Y');
$date->modify($modifier);
echo $modifier.': '.$date->format('Y-m-d').'<br>'; 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-19T15:43:48.907

您可以使用[`strtotime`](http://php.net/manual/en/function.strtotime.php)：

```
$date = strtotime('2013-01-16');

// First/last day of week 
$first = strtotime('last Sunday');
$last = strtotime('next Saturday'); 
```

或者 PHP 的原生[`DateTime`](http://php.net/manual/en/book.datetime.php)功能：

```
$date = new DateTime('2013-01-16');

// First/last day of month
$first = $date->modify('first day of this month');
$last = $date->modify('last day of this month'); 
```

* * *

获取一年的第一天/最后一天可能有点棘手：

```
// Get date
$date = new DateTime('2013-01-16');

// Format to get date
$year = $date->format('Y');

// Get first day of Jan and last day of Dec
$first = $date->modify("first day of January $year");
$last = $date->modify("last day of December $year"); 
```

# jquery - DOM jQuery 查找当前元素的下一个和上一个元素

> ID：14415915
> 
> 赞同：2
> 
> 时间：2013-01-19T15:38:05.390
> 
> 标签：jquery, dom

如何使用 jQuery 从“#current”中查找下一个和上一个“A”元素。HTML：

```
<ul>
    <li>
        <a></a>
        <a></a>
        <a></a>
    </li>
    <li>
        <a></a>
        <a></a>
        <a id='current'></a>
    </li>
    <li>
        <a></a>
        <a></a>
        <a></a>
    </li>
</ul> 
```

我试图用这样的东西创建一个代码：

```
var curr = $('#current');
var prev = curr.parent().prev('a');
var next = curr.parent().next('a'); 
```

但它没有用。我认为这是一个非常简单的问题，但我现在被卡住了。有任何想法吗？

**UPD：**如果它是当前“LI”中的最后一个“A”元素，它应该移动到下一个“LI”元素以找到“A”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-19T15:40:02.593

您不需要使用 parent 来获取 prev 和 next

**[现场演示](http://jsfiddle.net/rajaadil/Skg46/1/)**

```
var curr = $('#current');
var prev = curr.prev('a');
var next = curr.next('a'); 
```

要制作此交叉行，您需要检查当前元素是否位于行的第一个或最后一个。如果当前元素是第一个元素，那么最后一个元素将是前一行的最后一个元素，类似地，如果当前元素是行的最后一个元素，那么下一个元素将是下一行的第一个元素。

**[现场演示](http://jsfiddle.net/rajaadil/Skg46/5/)**

```
$('a').click(function () {
    $('ul > li > a').css('background-color', 'white');
    var curr = $(this);
    curr.css('background-color', 'green');;
    var prev = curr.prev('a')
    if(prev.length == 0 )
    {
        lastaOfPrevLi = curr.parent().prev();
        if( lastaOfPrevLi.length != 0)
            lastaOfPrevLi.find('a:last').css('background-color', 'red');
    }
    else
        prev.css('background-color', 'red');
    var next = curr.next('a');
    if(next.length == 0 )
    {
        lastaOfNextLi = curr.parent().next();
        if( lastaOfNextLi.length != 0)
            lastaOfNextLi.find('a:first').css('background-color', 'orange');
    }
    else
            next.css('background-color', 'orange');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:00:27.277

如果您想超越`LI`of`#current`将需要一种不同的方法，因为`nex()`并且`prev()`只寻找直系兄弟姐妹

```
var curr = $('#current');
/* check if there is previous sibling, otherwise get last "a" in previous "LI"*/
var prev = curr.prev().length ? curr.prev() : curr.parent().prev().find('a:last');
var next = curr.next().length ? curr.next() : curr.parent().prev().find('a:first'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-19T16:06:18.263

从 jQuery 文档和我自己的快速实验来看，它看起来不像 `next`或`previous`将获取父级之外的元素。除非使用选择器，否则这些方法应该获取当前元素的直接兄弟元素，而不考虑类型。不同父级下的元素不会被视为兄弟姐妹，它们更像是堂兄弟。

你可以做些什么来实现你的目标看起来更像是下面的

```
var current = $("#current");
var prev = current.prev();
var next = current.next().length > 0 ? current.next() : current.parent().next().first() 
```

您可以`prev`使用 using`prev().last()`而不是`next().first()`应该`current`是其父元素的第一个子元素来做同样的事情。

你可以在这个[jsfiddle](http://jsfiddle.net/arosen/ucR2f/)中尝试一下。

# php - 何时使用映射表

> ID：14415919
> 
> 赞同：1
> 
> 时间：2013-01-19T15:38:48.437
> 
> 标签：php, mysql

在 MySQL 中，如果我有一个永远不会改变的有限数量，`categories`我应该将它们创建为它们分类的表中的布尔字段，还是应该使用映射表？如果是这样，为什么？

* * *

**案例一：**

t_stuff

```
id (int) 
name (string) 
category_a (bool) 
category_b (bool) 
category_c (bool) 
category_d (bool) 
category_e (bool) 
category_f (bool) 
```

* * *

**案例B：**

t_stuff

```
id (int)
name (string) 
```

t_categories

```
id (int)
name (string) 
```

t_stuff_category

```
id (int)
stuff_id (int)
category_id (int) 
```

* * *

虽然 A 看起来不像 B 那样“好”，但就所需的查询而言，它似乎要简单得多？

编辑：我觉得我应该补充一点，我需要做的就是：

*   获取所有东西行
*   获取具有一个特定类别的所有东西行
*   获取一个具有特定 id 的东西行

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T15:42:06.737

从不使用 case `A`。它违反了关系数据库的原则。了解[规范化](http://en.wikipedia.org/wiki/Database_normalization)。

假设您要查找`id`for `category = 1`，则需要检查每一列以防万一`A`：

```
SELECT id 
FROM   t_stuff
WHERE  category_a = 1 
        OR category_b = 1 
        OR category_c = 1 
        OR category_d = 1 
        OR category_e = 1 
        OR category_f = 1 
```

这种设计不仅使查询变得困难，而且也是聚合的噩梦。如果您想获取`COUNT(*)`特定类别的类别`id`怎么办？

万一`B`，您只需查询一个属性：

```
SELECT stuff_id 
FROM   stuffCategory
WHERE  category_id = 1 
```

要获得`COUNT(*)`，您只需更换`id`.

此外，您不需要`id`在`t_stuff_category`. ( ) 的复合主键`stuff_id, category_id`就足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:17:22.857

这里最重要的是“永不言败”——在问题和评论中，您自信地说：

*   类别的数量（以及隐含的含义）**永远不会**改变
*   您**永远**不需要查询诸如“项目 X 有多少类别”之类的问题

**需求会随着时间而变化，并且基于对某事永远不会**发生的预测来设计系统可能会在以后导致挫败感，因为您必须解决设计中的限制。

当然，非规范化版本有一些优点（只有布尔列），但实际上只有当你有非常少的“类别”（我会说 <=3）时，你才能将它们视为“属性”而不是“类别”：

1.  搜索 A 类或 B 类中的所有产品稍微容易一些，因为如果产品同时在这两种情况下，您不必担心`JOIN`子句的影响。
2.  有些查询编写起来更简单一些，因为您不需要担心`JOIN`子句。

您可以使用规范化设计而不是一组布尔列来执行以下操作：

1.  只需使用 SQL 计算产品的类别数`COUNT()`。
2.  将有关类别本身的信息存储在数据库中，而不必将其隐藏在应用程序代码中的某个位置。除了选项 B 架构中建议的名称列外，您可能还需要更长的描述，或何时显示该类别的标志等
3.  添加、删除或重命名类别，而无需触及应用程序代码的任何一行。

**同样，您现在**可能不想做任何这些事情，但除非您计划在一周内丢弃该应用程序，否则您**无法预测未来的需求**。软件设计的很大一部分是关于使代码可维护并在简单性和灵活性之间进行合理折衷。

# css - 外部 CSS 未应用于 div

> ID：14415921
> 
> 赞同：0
> 
> 时间：2013-01-19T15:38:51.153
> 
> 标签：css

当我将它作为内联样式应用时它正在工作。

```
<div id="footer">@Copyright 2012</div>

 #footer
 {
    background-color:Black;
    color:Silver;
    width:100%;
    text-align:center;
    position:absolute;
    bottom:0;
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:42:24.630

看看`Firebug`哪种风格*赢得*了你的青睐。

请注意，您在页面**中的声明顺序**`CSS`很重要，最后获胜。

所以你可能`#footer`在你之后加载的另一个样式表中有另一个规则。

# android - 我在调用 mDisplay.getOrientation 时收到 ORIENTATION_UNDEFINED

> ID：14415944
> 
> 赞同：0
> 
> 时间：2013-01-19T15:41:09.640
> 
> 标签：android, configuration

我想检索我的设备方向，当我调用 mDisplay.getOrientation 我收到 ORIENTATION 时，在这种情况下如何获取方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:49:30.460

根据下面的文档，方法 getOrientation 已被弃用。

[http://developer.android.com/reference/android/view/Display.html#getOrientation](http://developer.android.com/reference/android/view/Display.html#getOrientation) ()

尝试使用[http://developer.android.com/reference/android/view/Display.html#getRotation](http://developer.android.com/reference/android/view/Display.html#getRotation) ()，这应该返回设备旋转的角度。

# wcf - 单个服务中的多个接口问题

> ID：14415946
> 
> 赞同：0
> 
> 时间：2013-01-19T15:41:14.257
> 
> 标签：wcf, service, wcf-client, nettcpbinding, wcf-endpoint

我在客户端和服务器都是 Windows 窗体的解决方案上使用 WCF 和 NetTcpBinding。该服务由其中之一托管。我正在使用 VS.2012。

在服务器端，我有几个服务合同（相关），所有这些都在一个服务类中实现。像这样：

```
public class MyService : IServiceA, IServiceB
{
} 
```

并且它们应该可以通过 net.tcp://localhost:4545/control/ 访问，这将导致以下服务地址：

```
 IServiceA (endpoint alphaEP) : net.tcp://localhost:4545/control/ASvc/
 IServiceB (endpoint betaEP)  : net.tcp://localhost:4545/control/BSvc/ 
```

当我使用 svcutil.exe 生成客户端内容时，我看到它生成了两个服务客户端类，每个接口一个，所以当我使用 ServiceBClient 时，它会生成一个异常，表明它找不到带有合同“IServiceB”的“betaEP” ' 即使 app.config 具有相同的绑定配置并且定义了两个端点

```
 <bindings>
    <netTcpBinding>
      <binding name="alphaEP">
        <reliableSession enabled="true" />
        <security mode="None" />
      </binding>
      <binding name="betaEP">
        <reliableSession enabled="true" />
        <security mode="None" />
      </binding>
    </netTcpBinding>
  </bindings> 
```

和这个

```
 <client>
    <endpoint address="net.tcp://localhost:4545/control/ASvc"
        binding="netTcpBinding" bindingConfiguration="alphaEP"
        contract="CodeDom.IServiceA" name="alphaEP">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
    <endpoint address="net.tcp://localhost:4545/control/BSvc"
            binding="netTcpBinding" bindingConfiguration="betaEP" contract="CodeDom.IServiceB"
            name="betaEP">
      <identity>
        <dns value="localhost" />
      </identity>
    </endpoint>
  </client> 
```

如果这个客户端app.config是svcutil.exe根据服务器配置生成的，为什么找不到端点？

为什么它会生成两个客户端类而不是一个？那会是问题的根源吗？我有多个相关服务要公开，我不想占用一个以上的端口。请注意，这是网络 TCP 绑定。

# information-retrieval - Lucene - 获取文档频率 - termsEnum.docFreq() 总是返回 1

> ID：14415957
> 
> 赞同：1
> 
> 时间：2013-01-19T15:42:37.330
> 
> 标签：information-retrieval, lucene, tf-idf

我目前正在尝试为 lucene 索引中的术语计算 tf-idf 矩阵。我尝试使用以下功能来做到这一点：

```
public Table<Integer, BytesRef, Double> tfidf(String field) throws IOException, ParseException{
    //variables in complete context
    int totalNoOfDocs = reader.numDocs();                                   //total no of docs
    HashBasedTable<Integer, BytesRef, Double> tfidfPerDocAndTerm = HashBasedTable.create(); //tfidf value for each document(integer) and term(Byteref) pair.

    //variables in loop context
    BytesRef    term;                                                       //term as BytesRef
    int         noOfDocs;                                                   //number of documents (a term occours in)
    int         tf;                                                         //term frequency (of a term in a doc)
    double      idf;                                                        //inverse document frequency (of a term in a doc)
    double      tfidf;                                                      //term frequency - inverse document frequency value (of a term in a doc)
    Terms       termVector;                                                 //all terms of current doc in current field
    TermsEnum   termsEnum;                                                  //iterator for terms
    DocsEnum    docsEnum;                                                   //iterator for documents (of current term)

    List<Integer> docIds = getDocIds(totalNoOfDocs);                        //get internal documentIds of documents

    try {
        for(int doc : docIds){
            termVector  = reader.getTermVector(doc, field);                 //get termvector for document
            termsEnum   = termVector.iterator(null);                        //get iterator of termvector to iterate over terms

            while((term = termsEnum.next()) != null){                       //iterate of terms

                    noOfDocs = termsEnum.docFreq();                         //add no of docs the term occurs in to list

                    docsEnum = termsEnum.docs(null, null);                  //get document iterator for this term (all documents the term occours in)
                    while((doc = docsEnum.nextDoc()) != DocIdSetIterator.NO_MORE_DOCS){ //iterate over documents - computation of all tf-idf values for this term
                        tf      = docsEnum.freq();                          //get termfrequency of current term in current doc
                        idf     = Math.log((double)totalNoOfDocs / (double)noOfDocs); //calculate idf
                        tfidf   = (double) tf * idf;                        //caculate tfidf
                        tfidfPerDocAndTerm.put(doc, term, tfidf);           //add tf-idf value to matrix

                    }
            }
        }

    } catch (IOException ex) {
        Logger.getLogger(Index.class.getName()).log(Level.SEVERE, null, ex);
    }   
    return tfidfPerDocAndTerm;
} 
```

**问题是： noOfDocs = termsEnum.docFreq(); 总是返回 1。即使显然存在多个文档中**的术语（通过打印“术语”手动检查）。

我还发现，我检索的 docsEnum 是： docsEnum = termsEnum.docs(null, null); 总是只包含 1 个文档（doc 0）。

在创建索引时，我使用了带有停用词列表的标准分析器，因此所有术语都是小写的。

那我的问题是什么？：/

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-30T06:19:57.067

实际上，您的术语（属于 BytesRef 类型）是循环的，而不是您的术语集，但不幸的是，BytesRef 不支持称为 freq() 或 docfreq() 的方法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-14T16:57:20.133

实际上，枚举器总是返回 1。但是您可以使用以下方法获得正确的值`CollectionStatistics`：

```
DefaultSimilarity similarity = new DefaultSimilarity();

IndexReader reader = searcher.getIndexReader();
IndexReaderContext context = searcher.getTopReaderContext();
CollectionStatistics collectionStats = searcher.collectionStatistics(FIELD);
long totalDocCount = collectionStats.docCount();

Terms termVector = reader.getTermVector(docId, FIELD);
TermsEnum iterator = termVector.iterator(null);

while (true) {
    BytesRef ref = iterator.next();
    if (ref == null) {
        break;
    }

    long termFreq = iterator.totalTermFreq();
    float tf = similarity.tf(termFreq);

    Term term = new Term(FIELD, ref);
    TermContext termContext = TermContext.build(context, term);

    TermStatistics termStats = searcher.termStatistics(term, termContext);
    long docFreq = termStats.docFreq();
    float idf = similarity.idf(docFreq, totalDocCount);

    // do something with tf and idf
} 
```

请注意，要使其正常工作，您需要将术语向量存储在索引中。

# java - java.lang.UnsupportedOperationException: 'posix:permissions' 不支持作为 Windows 上的初始属性

> ID：14415960
> 
> 赞同：18
> 
> 时间：2013-01-19T15:42:46.223
> 
> 标签：java, java-7, nio, java-io, unsupportedoperation

我正在使用 Java 7 文件 API。我写了一个在 Ubuntu 上完美创建目录的类，但是当我在 Windows 上运行相同的代码时，它会抛出错误：

```
Exception in thread "main" java.lang.UnsupportedOperationException: 'posix:permissions' not supported as initial attribute
    at sun.nio.fs.WindowsSecurityDescriptor.fromAttribute(Unknown Source)
    at sun.nio.fs.WindowsFileSystemProvider.createDirectory(Unknown Source)
    at java.nio.file.Files.createDirectory(Unknown Source)
    at java.nio.file.Files.createAndCheckIsDirectory(Unknown Source)
    at java.nio.file.Files.createDirectories(Unknown Source)
    at com.cloudspoke.folder_permission.Folder.createFolder(Folder.java:27)
    at com.cloudspoke.folder_permission.Main.main(Main.java:139) 
```

我的文件夹类代码是

```
package com.cloudspoke.folder_permission;

import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Path;
import java.nio.file.attribute.FileAttribute;
import java.nio.file.attribute.PosixFilePermission;
import java.nio.file.attribute.UserPrincipal;
import java.util.Set;

public class Folder{
    // attributes required for creating a Folder
    private UserPrincipal owner;
    private Path folder_name;
    private FileAttribute<Set<PosixFilePermission>> attr;

    public Folder(UserPrincipal owner,Path folder_name,FileAttribute<Set<PosixFilePermission>> attr){
        this.owner=owner;
        this.folder_name=folder_name;
        this.attr=attr;
    }
    //invoking this method will create folders
    public  void createFolder(){
        try {
            //createDirectories function is used for overwriting existing folder instead of createDirectory() method
            Files.createDirectories(folder_name, attr);
            Files.setOwner(folder_name, owner);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        System.out.println("created Folder "+this.folder_name);

    }
} 
```

错误来自`createFolder`.`Folder`

如何解决此错误？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-19T15:47:57.490

您使用`PosixFilePermission`的只能用于与 POSIX 兼容的操作系统：

> 一种文件属性视图，提供通常与文件系统上的文件相关联的文件属性视图，这些文件系统由实现可移植操作系统接口 (POSIX) 系列标准的操作系统使用。
> 
> 实现 POSIX 系列标准的操作系统通常使用具有文件所有者、组所有者和相关访问权限的文件系统。此文件属性视图提供对这些属性的读写访问权限

不幸的是，Windows 不支持 POSIX 文件系统，所以这就是您的代码不起作用的原因。为了在 Windows 中创建目录，您应该使用：

`new File("/path/to/folder").mkdir();`

在Windows`/`中将自动更改为`\`。如果你想一次创建整个路径，你必须使用`mkdirs()`方法。更多信息：[http ://docs.oracle.com/javase/6/docs/api/java/io/File.html](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)

为了在 Windows 中设置文件权限，您必须使用`setReadable()`,`setWritable()`和`setExecutable()`. 那是`File`类方法，仅设置文件所有者的权限。请注意，上述方法是在 Java 1.6 中添加的。在旧版本中，您必须使用（Windows 版本）：

`Runtime.getRuntime().exec("attrib -r myFile");`

# jquery - 带有select2 gem的rails v3忽略client_side_validation错误消息

> ID：14415972
> 
> 赞同：2
> 
> 时间：2013-01-19T15:44:28.247
> 
> 标签：jquery, ruby-on-rails-3, client-side-validation, jquery-select2

我正在使用 rails 3.0.9，client_side_validation gem，只是尝试通过手动使用他们的 js 和 css 文件来使用 select2 gem

[从https://github.com/ivaynberg/select2/tags](https://github.com/ivaynberg/select2/tags)下载文件

具有存在验证的简单表单

```
 <%= javascript "validations/rails.live.validations", "select2.min"%>
    <%= stylesheet "select2"%>
    <script type="text/javascript" charset="UTF-8">
        $(document).ready(function() {
            $("#user_tag_ids").select2();
             });
    </script>
    <%= form_for @user, :validate => true do |f| %>
        <%= f.label :tag_ids %><%= mark_required(@user, :tag_ids) %>
        <%= f.collection_select(:tag_ids, @hobbies, :id, :display_name, {:prompt => "please select"}, :multiple => true) %>
        <%= f.submit %>
    <% end %> 
```

现在选择框*UI*改变了，

但是当光标在没有选择任何值的情况下聚焦时，client_side_validation gem 应该显示错误消息但不显示任何消息（甚至没有将 error_field 类设置为该字段）。

select2 gem 是否忽略/跳过以呈现错误消息？

如果我单击提交按钮，那么只有我收到 (client_side_validation gem) 错误消息。

有什么办法解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T14:31:09.670

我有同样的问题。我尝试了在评论中发送给您的解决方案，但结果证明我必须这样做：

在 rails.validations.js 文件中，而不是

```
 form.find(':input:enabled:visible[data-validate]').each(function() { 
```

尝试：

```
 form.find(':input[data-validate]').each(function() { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-27T08:31:18.683

将验证添加到 javascript 中的当前设置对象。例子

```
var validators = window[$('#place_order_form').attr('id')].validators

var input_name = $("#user_tag_ids").attr('name');
validators[input_name] = {"presence":{"message":"Must be filled"}} 
```

参考：[https ://github.com/bcardarella/client_side_validations/issues/149](https://github.com/bcardarella/client_side_validations/issues/149)

# c# - 与 TransformToAncestor 的相对位置

> ID：14415976
> 
> 赞同：0
> 
> 时间：2013-01-19T15:45:10.900
> 
> 标签：c#, wpf

我有一个画布（ZoomableCanvas），它实现了缩放并有子项。我试图在放大时获取子项的相对位置，以便在其上显示扩展信息。

```
<Canvas x:Name="CanvasContainer" Width="1500" Height="780">
    <ZoomableCanvas ApplyTransform="false" Loaded="ZoomableCanvas_Loaded" x:Name="ShareCanvas" Width="1500" Height="780" MinWidth="1500" MinHeight="780" Grid.Row="0" Grid.Column="0" />
</Canvas> 
```

后面的代码：

```
Canvas main = touched.FindVisualParent<Canvas>(); //Finds "CanvasContainer"
Point relativePoint = touched.TransformToAncestor(main).Transform(new Point(0, 0));
double canvasTop = Canvas.GetTop(touched); 
```

但是在这里 canvasTop != relativePoint.Y 在缩放之前？

我是不是用错了。它不是映射到父视觉并给出一个相对点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T16:18:39.090

您要比较的值只有在以下情况下才会相等

*   上没有设置转换（RenderTranform 或 LayoutTransform） `touched`，因为在 or 属性中考虑了这些，`TransformToAncestor`但不在`Canvas.Left`or`Canvas.Top`属性中。

*   ZoomableCanvas 相对于外部画布没有偏移。这是因为`Canvas.GetTop(touched)`返回相对于 ZoomableCanvas 的顶部偏移量（假设它`touched`是 ZoomableCanvas 的子级），而`relativePoint`相对于外部 Canvas。

* * *

为了说明第一个问题，只需将带有 RenderTransform 的元素放入 Canvas 中：

```
<Canvas x:Name="canvas">
    <Label x:Name="child" Content="Hello" Canvas.Left="50" Canvas.Top="100">
        <Label.RenderTransform>
            <TranslateTransform X="50" Y="100"/>
        </Label.RenderTransform>
    </Label>
</Canvas> 
```

如果你打电话

```
var point = child.TransformToAncestor(canvas).Transform(new Point());
var left = Canvas.GetLeft(child);
var top = Canvas.GetTop(child); 
```

它将返回`point`为 (100, 200)，而`left`为 50 和`top`100。

# javascript - 如何将现有的 dom 元素绑定到主干集合视图

> ID：14415979
> 
> 赞同：1
> 
> 时间：2013-01-19T15:45:29.730
> 
> 标签：javascript, backbone.js

我在一个页面上有一系列评论，可以对其进行编辑。我的想法是通过 Rails 呈现评论并在 Backbone 集合中预加载包含所有这些评论的 json。

然后我会每隔 x 秒轮询一次，看看是否有变化。通常我通过遍历所有模型来呈现集合，并为每个项目创建一个视图。当模型更新时，视图也会更新（在这种情况下评论）。

但我的问题是，当视图已经在 DOM 中时，如何将视图绑定到模型。特别是因为视图具有动态 ID。渲染视图没有意义，因为它已经存在。当你渲染一个视图时，主干通过某种 cid 绑定它。

我能想到的唯一解决方案是在页面加载时在 dom 对象中设置一个 id。低

```
<div id="comment-<%= content.id %>"></div> 
```

. 然后在视图的初始化中，重置id

```
class Comment extends Backbone.View
    initialize: ->
       @id = "comment-" + @model.get('id') 
```

但我不确定这是否是要走的路。事件还会被绑定吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-19T16:33:28.760

为您特别准备 ：）

```
var CommentsView = Backbone.View.extend({
  tagName : 'ul',
  comments : {},
  initialize : function () {
    this.listenTo(this.collection, 'add', this.addComment);
    this.listenTo(this.collection, 'remove', this.removeComment);
    this.listenTo(this.collection, 'change', this.updateComment);
  },
  addComment : function (model) {
    this.comments[model.id] = new CommentView({model:model});
    this.$el.append(this.comments[model.id].render().$el);
  },
  removeComment : function (model) {
    this.comments[model.id].remove();
    this.comments[model.id] = null;
  },
  updateComment : function (model) {
    this.comments[model.id] = new CommentView({model:model});
    this.$('[data-id="' + model.id + '"]').before(this.comments[model.id].render().$el).remove();
  }
});

var CommentView = Backbone.View.extend({
  tagName : 'li',
  template : _.template('<div data-id="<%= id %>"><%= name %>: <%- message %></div>'),
  render : function () {
    this.$el.html(this.template(this.model.toJSON()));
    return this;
  }
});

// comments
var initialComments = [{id:1, name:'user1', message:'great!'}, {id:2, name:'user2', message:':)'}];
var actualComments = [{id:1, name:'user1', message:'great! [edited]'}];

var comments = new Backbone.Collection();
var commentsView = new CommentsView({collection:comments});

// show comments
commentsView.render().$el.appendTo('body');

// simulate fetch
comments.add(initialComments);

// simulate update
_.delay(function() {
  comments.update(actualComments);
},
2000); 
```

[jsfiddle](http://jsfiddle.net/vpetrychuk/V2D96/)

# java - 是否可以一次更新 JTable 整行

> ID：14415981
> 
> 赞同：2
> 
> 时间：2013-01-19T15:45:48.600
> 
> 标签：java, swing

是否可以一次更新 JTable 整行，而不是逐列？这是我下面的程序目前我只能使用

```
model.setValueAt("1111", 0, 0) 
```

我可以用吗

```
model.setValueAt(new Object[]{"1111","Pavan","Developer"}, 0, 0);

import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.Random;
import java.util.Vector;

import javax.swing.JFrame;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.SwingUtilities;
import javax.swing.Timer;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;
import javax.swing.table.DefaultTableModel;
public class Preethi {
    protected void initUI() {
        final DefaultTableModel model = new DefaultTableModel(new String[] {
                "Id", "Name", "Desg" }, 0);
        final JTable table = new JTable(model);
        // table.setFillsViewportHeight(true);
        JFrame frame = new JFrame(Preethi.class.getSimpleName());
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JScrollPane scrollpane = new JScrollPane(table);
        frame.add(scrollpane, BorderLayout.CENTER);
        frame.pack();
        frame.setVisible(true);
        Vector vec = new Vector();
        vec.add("1122");
        vec.add("Iraneee");
        vec.add("Dev");
        model.insertRow(0, vec);
        model.setValueAt("1111", 0, 0);
        //model.setValueAt(new Object[]{"1111","Pavan","Developer"}, 0, 0);

    }

    public static void main(String[] args) throws ClassNotFoundException,
            InstantiationException, IllegalAccessException,
            UnsupportedLookAndFeelException {
        UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new Preethi().initUI();
            }
        });
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-19T16:43:05.477

正如[文档](http://docs.oracle.com/javase/7/docs/api/javax/swing/table/DefaultTableModel.html#setValueAt%28java.lang.Object,%20int,%20int%29)所示，`setValueAt`设置单个单元格值。

> 设置列和行单元格的对象值。aValue 是新值。

但是，您可以*重载*该方法来处理`Object`数组：

```
class MyTableModel extends DefaultTableModel {

   public MyTableModel(Object[] columnNames, int rowCount) {
      super(columnNames, rowCount);
   }

   public void setValueAt(Object[] valueArray, int row) {
      int column = 0;
      for (Object cellValue: valueArray) {
         setValueAt(cellValue, row, column);
         column++;
      }
   }
} 
```

使用此模型，您将能够设置给定行的值：

```
model.setValueAt(new Object[] { "1111", "Pavan", "Developer" }, 0); 
```

* * *

**略短的版本：**

```
class MyTableModel extends DefaultTableModel {

   public MyTableModel(Object[] columnNames, int rowCount) {
      super(columnNames, rowCount);
   }

   public void setValueAt(Object[] valueArray, int row) {

      getDataVector().setElementAt(new Vector(Arrays.asList(valueArray)), row);     
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:42:46.367

> 是否可以一次更新 JTable 整行，而不是逐列？

因为您不想遍历整行。我建议您删除该特定行，然后使用方法添加具有更新值的新行`addRow`。

或者

如果表中的每一行都是一个，`Object`那么您可以获取该表正在使用的列表，然后从列表中删除该列表并将您的新对象添加到列表中。

# iphone - 为 iPhone 项目创建属性

> ID：14415990
> 
> 赞同：0
> 
> 时间：2013-01-19T15:47:00.377
> 
> 标签：iphone, properties, uiviewcontroller, ios6, storyboard

我正在尝试为 iPhone 编写简单的应用程序。我的故事板填充了组件，例如文本字段。现在在 ViewController.h 中，我想通过从情节提要中拖放组件来创建属性。一旦你这样做了，就会出现一个箭头形式的指针。但就我而言，我拖动项目本身。那么，缺少什么？据我所知，我需要以与组件相同的方式将文件拖动到某处。此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-19T15:55:05.913

尝试在拖动时按下控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-19T16:39:18.793

按住`Ctrl`+`Shift`时拖动的**不是**界面生成器主窗口中直观显示的项目，而是左侧边栏中的项目名称。

您需要同时查看`.h`文件（假设您希望将属性“拖入”代码中），您可以使用++`Cmd`或通过选择 View > Assistant Editor > Show Assistant Editor来打开它.`option``Enter`

显示后，您可以将属性从您`.xib`的`.h`.

# javascript - javascript - 如何动态嵌入阻塞脚本？

> ID：14415994
> 
> 赞同：1
> 
> 时间：2013-01-19T15:47:07.550
> 
> 标签：javascript

我在`<head>`网页中嵌入了一个 javascript 标签。在此脚本（通过 Amazon Cloudfront 提供服务）中，它会进行一些处理，然后如果设置了某些检查，则将另一个脚本附加到文档头部。这是该嵌入的示例：

```
 var js = document.createElement('script');
    js.src = 'http://cdn.mysite.com/script.js?cache_bust='+Math.random();
    document.getElementsByTagName('head')[0].appendChild(js); 
```

这可以正常工作，但是它是非阻塞的，这意味着网页在将该脚本附加到头部时继续加载。

有没有办法以阻塞方式嵌入脚本，以便在设置新脚本时网页“挂起”？

我正在考虑可能将第一个脚本移动到标签下方`<body>`，然后使用 document.write() 第二个脚本，但我更愿意将其保留在`<head>`.

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T15:59:08.777

你是对的，`document.write`应该工作。正如Dr.Molle 在评论中提到的那样，您也可以在内部使用`<head>`（这`<head>`也是文档的一部分！）。

所以：

```
<head>
    <script>
    var src = 'http://cdn.mysite.com/script.js?cache_bust='+Math.random();
    document.write '<script src="">'+ src + '</scr' + 'ipt>';
    </script>
</head> 
```

该`'</scr' + 'ipt>'`部分是一种预防措施，浏览器通常认为外部脚本块在找到时正在关闭`</script>`，即使在字符串中也是如此。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-19T16:03:09.987

使用我制作的这个**[脚本加载器](http://jsfiddle.net/bBGZs/)**：

```
 var scriptLoader = [];

    /*
    * loads a script and defers a callback for when the script finishes loading.
    * you can also just stack callbacks on the script load by invoking this method repeatedly.
    *
    * opts format:  {
    *       url: the url of the target script resource,
    *       timeout: a timeout in milliseconds after which any callbacks on the script will be dropped, and the script element removed.
    *       callbacks: an optional array of callbacks to execute after the script completes loading.
    *       callback: an optional callback to execute after the script completes loading.
    *       before: an optional callback to execute before the script is loaded, only intended to be ran prior to requesting the script, not multiple times.
    *       success: an optional callback to execute when the script successfully loads, always remember to call script.complete at the end.
    *       error: an optional callback to execute when and if the script request fails.
    *   }
    */
    function loadScript(opts) {
        if (typeof opts === "string") {
            opts = {
                url: opts
            };
        }
        var script = scriptLoader[opts.url];
        if (script === void 0) {
            var complete = function (s) {
                s.status = "loaded";
                s.executeCallbacks();
            };

            script = scriptLoader[opts.url] = {
                url: opts.url,
                status: "loading",
                requested: new Date(),
                timeout: opts.timeout || 10000,
                callbacks: opts.callbacks || [opts.callback || $.noop],
                addCallback: function (callback) {
                    if (!!callback) {
                        if (script.status !== "loaded") {
                            script.callbacks.push(callback);
                        } else {
                            callback();
                        }
                    }
                },
                executeCallbacks: function () {
                    $.each(script.callbacks, function () {
                        this();
                    });
                    script.callbacks = [];
                },
                before: opts.before || $.noop,
                success: opts.success || complete,
                complete: complete,
                error: opts.error || $.noop
            };

            script.before();

            $.ajax(script.url, {
                timeout: script.timeout,
                success: function () {
                    script.success(script);
                },
                error: function () {
                    script.error(); // .error should remove anything added by .before
                    scriptLoader[script.url] = void 0; // dereference, no callbacks were executed, no harm is done.
                }
            });
        } else {
            script.addCallback(opts.callback);
        }
    }

    loadScript({
        url: 'http://fiddle.jshell.net/js/lib/mootools-core-1.4.5-nocompat.js',
        callback: function(){
            alert('foo');
        }
    }); 
```

一般来说，您应该推迟执行，而不是阻止，从而提高用户感知的页面加载速度。

# javascript - 在 javascript/html5 中查看新文件的本地目录

> ID：14415998
> 
> 赞同：5
> 
> 时间：2013-01-19T15:48:00.140
> 
> 标签：javascript, html

正如标题所说，是否可以在真实文件系统（不是 html5 沙箱）中监视本地目录？我想写一个自动照片上传器来寻找新照片并上传它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T18:55:25.927

Potential repeat of [Local file access with Javascript](https://stackoverflow.com/questions/371875/local-file-access-with-javascript).

My understanding is that you can't access the local filesystem directly through a web browser, you have to use an intermediary like the form input tag or drag and drop.

You may be able to get away with accessing the filesystem if you were to use the operating system's javascript interpreter or something like [V8](http://code.google.com/p/v8/). There may also be experimental javascript api's in Chrome that you could look for on the Chrome flags page if thats your browser of choice. That all depends on whether or not you were doing a personal project or something for the web.

Otherwise another scripting language such as PHP, Ruby, or Python would better suit your needs.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-19T17:43:57.867

您可以设置 Javascript Timing 事件。即：使用**`setInterval()`**方法。

另一方面，您可以制作一个按钮来触发**`onClick event`**或任何其他事件，以执行以下代码。

**笔记：**

如果您设置了一个间隔，请确保在再次发送之前收到请求。

为此，您需要检查 XML HTTP 请求的readyState 是否**等于****4**，如下所示：

 **```
xmlhttp.readyState == 4 
```

**笔记：**

这是用于发送请求、解析响应并将其放入 Javascript 数组中：

```
xmlhttp = new XMLHttpRequest();
xmlhttp.open("POST", "check_dirs.php", true);
xmlhttp.send();

fileArray = new Array();

xmlhttp.onreadystatechange = function()
{
    if (xmlhttp.readyState == 4 && xmlhttp.status == 200)
    {
        xmlDoc = xmlhttp.responseXML;

        fileList = xmlDoc.getElementsByTagName("filesChanged");

        while (fileArray.length > 0)

        // clean the whole array.
        // we want to store the newly generated file list
        {
                    fileArray.pop();
        }

        for (i = 0; i < fileList.length; i++)
        {
            fileArray[fileArray.length] = fileList[i].childNodes[0].nodeValue;
        }
    }
} 
```

此外，您需要编写一些代码**`PHP script`**来检查您的自定义目录中是否有比给定日期更新的文件，这些文件可以顺便在请求中发送，然后发送回**XML 响应**，如下所示：

```
<?php

(...) // check dir. output $files contain the xml nodes for the files to send

      // mockup below

  // Get our XML. You can declare it here or even load a file.
  $xml_builder = '<?xml version="1.0" encoding="utf-8"?>';

  $xml_builder .= $files;

  // We send XML via CURL using POST with a http header of text/xml.
  $ch = curl_init('http://' . $_SERVER['SERVER_NAME'] . $_SERVER['REQUEST_URI']);
  curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: text/xml'));
  curl_setopt($ch, CURLOPT_HEADER, 0);
  curl_setopt($ch, CURLOPT_POST, 1);
  curl_setopt($ch, CURLOPT_POSTFIELDS, $xml_builder);
  curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 0);
  curl_setopt($ch, CURLOPT_REFERER, 'http://www.hello..co.uk');
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  $ch_result = curl_exec($ch);
  curl_close($ch);

  /*
  echo $ch_result;
  */
?> 
```

以下是一些用于检查目录和构建 XML 响应的模型函数：

```
<?php

function analizeDir($dir)
{
    if (is_dir($dir))
    {
        $dir_resource = opendir($dir);
        while (false !== ($res = readdir($dir_resource)))
        {
            if ($res != "." && $res != ".." && $res != "old")
            {
                if (is_dir($dir . "\\" . $res)) // this is a subforder
                {
                    analizeDir($dir . "\\" . $res);

                } else { // this is a file

                    checkFile($dir . "\\" . $res);
                }
            }
        }
    }
}

function checkFile($file)
{
    $today = date("Y-m-d H:i:s");

    // if the difference in days between today
    // and the date of the file is more than 10 days,
    // print it in the response

    if (date_diff(datemtime($file), $today) > 10)
    {
         $files .= "<filesChanged>" . $file . "</filesChanged>";
    }
}

?> 
```**