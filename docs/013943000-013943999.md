# StackOverflow 问答 13943000-13943999

# php - 创建像谷歌日历这样的服务。什么数据库？

> ID：13943000
> 
> 赞同：0
> 
> 时间：2012-12-18T23:08:16.387
> 
> 标签：php, mysql, database, icalendar

我需要创建一个类似于谷歌日历的服务（仅限基本功能），以使用 iCalendar 格式查看和编辑/删除约会。在开始之前我想问你，哪种数据库最适合存储这种信息。它必须是一个可扩展的解决方案。

如果你能帮助我，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:10:58.150

您可以安全地使用 mysql，也许与 PDO 一起使用。这样，如果需要，您将来可以随时移动到另一个数据库。但是，对于这样的任务，mySQL 应该足够了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:26:38.357

鉴于您的问题范围广泛，您可以使用任何关系数据库，例如：

1.  MySQL
2.  格力邮政
3.  SQL 服务器
4.  甲骨文

或 NoSQL 数据库，例如：

1.  MongoDB
2.  乌鸦数据库

您的选择取决于对这些数据库的知识和经验。

就个人而言，我会选择 MySQL，因为它稳定、开源，有很多关于它的资源（包括优化技巧），而且它是“免费的”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T23:18:27.707

如果你想要一个可扩展的数据库，你可以使用 NoSQL 数据库（例如 MongoDB、CouchDB）。这种数据库是可扩展的。

但是对于像“基本功能”这样的“谷歌日历”，经典的 SQL 数据库（例如 MySQL）也足够大。即使你有很多用户。

所以 NoSQL 或 SQL 数据库很容易使用。所以使用你最喜欢的数据库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T23:38:35.187

询问可扩展性是错误的方法。如果您的服务增长，您根本无法知道会遇到哪种可扩展性问题。

您可以扩展几乎所有数据库解决方案，而无需进行任何更改。但最终您将不得不对问题采取完全不同的方法，因为原始解决方案无法进一步扩展。

例如，高性能环境中的 MySQL 用于安装了足够 RAM 的服务器上，以至于整个数据集在某个时间点都保存在 RAM 中，而硬盘只写入整个时间以实现持久性。顺便说一句，硬盘是一个非常快的 SSD 阵列。

但即使是这些巨无霸服务器也可能变得太小，并且必须应用“分片”和“分区”等策略将数据集拆分到多个数据库服务器上。如果读写相互进入，主从复制可能会有用。

如果您刚开始，您的基本问题应该是：我想使用什么数据结构来向至少一个用户提供服务？任何数据库都可以支持这一点，但有些可能更容易使用，这取决于数据结构和您对它们的了解。

如果没有服务，就没有用户，扩展的需求就会减少。

# c++ - 指向 N 个数组的静态指针，还是指向 N 个静态数组的指针？

> ID：13943003
> 
> 赞同：0
> 
> 时间：2012-12-18T23:08:25.270
> 
> 标签：c++, c

我有以下代码：

```
const int N=3;
static double * p[N]; 
```

p 代表指向 N 维双精度数组的静态指针，还是每个元素代表一个静态指针的 N​​ 维数组？

我还发现以下更改编译失败，不知道为什么......

```
int N=3;
static double * p[N]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:10:09.390

> p 代表指向 N 维双精度数组的静态指针，还是每个元素代表一个静态指针的 N​​ 维数组？

几乎第二个选择*是一个 N 大小的数组，每个元素代表一个静态指针*。注意从“N 维”到“N 大小”的变化。谢谢@大卫。

> 我还发现以下更改编译失败，不知道为什么......

数组的大小需要常量整数。删除“常量”后`N`的大小`p`在编译时是不确定的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:10:08.630

`p`是一个由 3 个指向`double`s 的指针组成的静态数组。

编译器要求在编译时知道数组的大小，这就是为什么您只能使用 a`const int`而不是 a`int`来声明数组大小的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T12:59:52.520

```
cdecl> explain static double *p[10];
declare p as static array 10 of pointer to double 
```

还有 cdecl.org 可以在线获得这种帮助。

# git - 如何使用 Git 管理我在多个站点上使用的自定义 Drupal 模块代码？

> ID：13943005
> 
> 赞同：1
> 
> 时间：2012-12-18T23:08:32.500
> 
> 标签：git, drupal, drupal-7

我不确定这是否正确属于这里或 Drupal StackExchange 站点。

我在一家小公司担任独家开发人员。我们有几个 Drupal 7 站点。我已经构建了几个在大多数网站上使用的自定义模块。我是 git 的相对新手。

这些网站在 git 中。每个站点的根是它自己的存储库。除了 /sites/default/files 之外，几乎所有站点都在 git 中。我使用 drush 更新 contrib 模块和核心，然后提交该站点的所有更改。

这似乎是一个简单的问题，但我正在努力寻找（可能是显而易见的）答案。

我如何构建事物，以便我将自己的自定义模块与他们自己的存储库一起维护在一个地方？现在我只是在每个站点上有多个自定义模块的副本。他们与网站的其他部分一起承诺，但当然这不是这样做的方式。模块代码在站点之间不同步等。我显然需要在一个地方处理模块并将更新拉入各个站点。

我应该创建一个仅用于我的自定义模块开发的站点并为我的每个模块创建存储库吗？我的意思是上面的目录中的“git init directory_name”，我的模块将这些现有模块转换为存储库。然后添加、提交等并推送到我的远程仓库。

我对网站本身需要什么才能获取更新感到困惑。我需要网站上的 Git 子模块吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:27:58.627

您可能应该为您的模块设置一个主 git 存储库，将其保存在某个远程服务器上（git hub、BitBucket 等......）。然后工作流程将如下所示：

1.  在任何网站上进行更改。
2.  提交更改。
3.  将更改推送到主存储库。
4.  从需要这些更改的其他站点中提取更改。

# php - Wordpress - 将自定义字段的数值添加在一起

> ID：13943009
> 
> 赞同：0
> 
> 时间：2012-12-18T23:08:46.340
> 
> 标签：php, wordpress, aggregate, custom-post-type

我在我的 WordPress 博客中创建了一个名为“评论”的自定义帖子类型。在这里面，我有一个自定义字段，数字为 5。

我正在尝试将所有这些数字相加，然后除以帖子数量以获得总分。

我正在尝试使用此代码...

```
<?php
$total_score=0;
$meta_key = 'target';//set this to your custom field meta key
$allscores=$wpdb->get_col($wpdb->prepare("SELECT meta_value FROM $wpdb->postmeta WHERE     meta_key = %s", $meta_key));
foreach ($allscores as $score) {
$total_score = $total_score + $score;
}
echo 'Total score is '.$total_score;
?> 
```

但是我得到的结果是 0，谁能看到我哪里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:38:17.697

原来一直是我，在数据库中输入的数字是按字母顺序而不是数字拼写的，所以我收到的 0 结果在技术上是正确的:)

# ruby-on-rails - ruby on rails bootstrap pull-right

> ID：13943012
> 
> 赞同：-1
> 
> 时间：2012-12-18T23:09:12.703
> 
> 标签：ruby-on-rails, twitter-bootstrap

为什么 ul class="nav pull-right" 行不起作用？我认为这取决于 if 和 else 但我不知道......有人可以帮助我吗？

```
<div class="navbar navbar-fluid-top">
  <div class="navbar-inner">
    <div class="container-fluid">
      <a class="btn btn-navbar" data-target=".nav-collapse" data-toggle="collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </a>
      <a class="brand" href="/">Test1</a>
      <div class="container-fluid nav-collapse">
        <ul class="nav">
          <% if user_signed_in? %>
          <li><%= link_to "Link1", "/path1"  %></li>
          <li><%= link_to "Link2", "/path2"  %></li>
          <li><%= link_to "Link3", "/path3"  %></li>
          <li>Welcome, <%= current_user.email %>!</li>
          </ul>
          <ul class="nav pull-right">
          <li><%= link_to "Log out", destroy_user_session_path, method: :delete %></li>
        <% else %>
          <li><%= link_to "Sign in", new_user_session_path %></li>
          <li><%= link_to "Sign up", new_user_registration_path %></li>
        </ul>
          <% end %>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-18T09:32:50.423

试试这个：

```
<div class="container-fluid nav-collapse">
        <% if user_signed_in? %>
        <ul class="nav">
          <li><%= link_to "Link1", "/path1"  %></li>
          <li><%= link_to "Link2", "/path2"  %></li>
          <li><%= link_to "Link3", "/path3"  %></li>
          <li>Welcome, <%= current_user.email %>!</li>
          </ul>
          <ul class="nav pull-right">
          <li><%= link_to "Log out", destroy_user_session_path, method: :delete %></li>
        <% else %>
          <ul class="nav pull-right">
          <li><%= link_to "Sign in", new_user_session_path %></li>
          <li><%= link_to "Sign up", new_user_registration_path %></li>
          <% end %>
         </ul>
      </div><!--/.nav-collapse --> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T13:23:31.527

Pull-right 只是添加“float:right”。尝试将“pull-left”添加到以前的导航。

# shibboleth - Shibboleth 身份提供程序启动异常

> ID：13943013
> 
> 赞同：1
> 
> 时间：2012-12-18T23:09:16.820
> 
> 标签：shibboleth

我正在尝试让 Shibboleth 的身份提供程序在 Windows 2008R2 上运行。我已经安装了 Jetty 7 并且已经能够到达 Jetty Site aka `http://localhost:8080`。按照[https://wiki.shibboleth.net/confluence/display/SHIB2/IdPJetty7Prepare](https://wiki.shibboleth.net/confluence/display/SHIB2/IdPJetty7Prepare)上的说明，然后尝试启动 Jetty，我得到了 IllegalArgumentException。

shell的输出如下。（很多，由于 StackOverflow 的字符限制，我不得不切断一些堆栈跟踪）

我不是 java/jetty/shibboleth 大师，所以有人可以告诉我这里发生了什么吗？

谢谢

```
PS C:\Jetty> java -jar start.jar
WARNING: System properties and/or JVM args set.  Consider using --dry-run or --exec
2012-12-18 14:48:16.714:INFO:oejs.Server:jetty-7.6.8.v20121106
2012-12-18 14:48:16.730:INFO:oejdp.ScanningAppProvider:Deployment monitor C:\Jetty\webapps at interval 1
2012-12-18 14:48:16.730:INFO:oejdp.ScanningAppProvider:Deployment monitor C:\Jetty\contexts at interval 1
2012-12-18 14:48:16.730:INFO:oejd.DeploymentManager:Deployable added: C:\Jetty\contexts\test.xml
2012-12-18 14:48:16.808:INFO:oejw.WebInfConfiguration:Extract jar:file:/C:/Jetty/webapps/test.war!/ to C:\Users\Administ
rator\AppData\Local\Temp\jetty-0.0.0.0-8080-test.war-_-any-\webapp
2012-12-18 14:48:17.214:INFO:oejsh.ContextHandler:started o.e.j.w.WebAppContext{/,file:/C:/Users/Administrator/AppData/L
ocal/Temp/jetty-0.0.0.0-8080-test.war-_-any-/webapp/},C:\Jetty/webapps/test.war
2012-12-18 14:48:17.339:INFO:oejs.TransparentProxy:TransparentProxy @ /javadoc-proxy to http://download.eclipse.org/jett
y/stable-7/apidocs
2012-12-18 14:48:17.339:INFO:oejd.DeploymentManager:Deployable added: C:\Jetty\contexts\idp.xml
2012-12-18 14:48:18.246:WARN:oejw.WebAppClassLoader:EXCEPTION
java.lang.IllegalArgumentException: !file: jar:file:/C:/Shibboleth/2.3.8/war/idp.war!/WEB-INF/lib/activation-1.1.jar
        at org.eclipse.jetty.webapp.WebAppClassLoader.addClassPath(WebAppClassLoader.java:245)
        at org.eclipse.jetty.webapp.WebAppClassLoader.addJars(WebAppClassLoader.java:282)
        at org.eclipse.jetty.webapp.WebInfConfiguration.configure(WebInfConfiguration.java:165)
        at org.eclipse.jetty.webapp.WebAppContext.configure(WebAppContext.java:454)
        at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1233)
        at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:683)
        at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:480)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:64)
        at org.eclipse.jetty.deploy.bindings.StandardStarter.processBinding(StandardStarter.java:39)
        at org.eclipse.jetty.deploy.AppLifeCycle.runBindings(AppLifeCycle.java:186)
        at org.eclipse.jetty.deploy.DeploymentManager.requestAppGoal(DeploymentManager.java:494)
        at org.eclipse.jetty.deploy.DeploymentManager.addApp(DeploymentManager.java:141)
        at org.eclipse.jetty.deploy.providers.ScanningAppProvider.fileAdded(ScanningAppProvider.java:145)
        at org.eclipse.jetty.deploy.providers.ScanningAppProvider$1.fileAdded(ScanningAppProvider.java:56)
        at org.eclipse.jetty.util.Scanner.reportAddition(Scanner.java:609)
        at org.eclipse.jetty.util.Scanner.reportDifferences(Scanner.java:540)
        at org.eclipse.jetty.util.Scanner.scan(Scanner.java:403)
        at org.eclipse.jetty.util.Scanner.doStart(Scanner.java:337)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:64)
        at org.eclipse.jetty.deploy.providers.ScanningAppProvider.doStart(ScanningAppProvider.java:121)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:64)
        at org.eclipse.jetty.deploy.DeploymentManager.startAppProvider(DeploymentManager.java:555)
        at org.eclipse.jetty.deploy.DeploymentManager.doStart(DeploymentManager.java:230)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:64)
        at org.eclipse.jetty.util.component.AggregateLifeCycle.doStart(AggregateLifeCycle.java:81)
        at org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:58)
        at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:96)
        at org.eclipse.jetty.server.Server.doStart(Server.java:275)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:64)
        at org.eclipse.jetty.xml.XmlConfiguration$1.run(XmlConfiguration.java:1266)
        at java.security.AccessController.doPrivileged(Native Method)
        at org.eclipse.jetty.xml.XmlConfiguration.main(XmlConfiguration.java:1189)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.eclipse.jetty.start.Main.invokeMain(Main.java:472)
        at org.eclipse.jetty.start.Main.start(Main.java:620)
        at org.eclipse.jetty.start.Main.main(Main.java:95)
2012-12-18 14:48:18.246:WARN:oejw.WebAppClassLoader:EXCEPTION
java.lang.IllegalArgumentException: !file: jar:file:/C:/Shibboleth/2.3.8/war/idp.war!/WEB-INF/lib/antlr-2.7.7.jar
        at org.eclipse.jetty.webapp.WebAppClassLoader.addClassPath(WebAppClassLoader.java:245)
        at org.eclipse.jetty.webapp.WebAppClassLoader.addJars(WebAppClassLoader.java:282)
        at org.eclipse.jetty.webapp.WebInfConfiguration.configure(WebInfConfiguration.java:165)
        at org.eclipse.jetty.webapp.WebAppContext.configure(WebAppContext.java:454)
        at org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1233)
        at org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:683)
        at org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:480)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:64)
        at org.eclipse.jetty.deploy.bindings.StandardStarter.processBinding(StandardStarter.java:39)
        at org.eclipse.jetty.deploy.AppLifeCycle.runBindings(AppLifeCycle.java:186)
        at org.eclipse.jetty.deploy.DeploymentManager.requestAppGoal(DeploymentManager.java:494)
        at org.eclipse.jetty.deploy.DeploymentManager.addApp(DeploymentManager.java:141)
        at org.eclipse.jetty.deploy.providers.ScanningAppProvider.fileAdded(ScanningAppProvider.java:145)
        at org.eclipse.jetty.deploy.providers.ScanningAppProvider$1.fileAdded(ScanningAppProvider.java:56)
        at org.eclipse.jetty.util.Scanner.reportAddition(Scanner.java:609)
        at org.eclipse.jetty.util.Scanner.reportDifferences(Scanner.java:540)
        at org.eclipse.jetty.util.Scanner.scan(Scanner.java:403)
        at org.eclipse.jetty.util.Scanner.doStart(Scanner.java:337)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:64)
        at org.eclipse.jetty.deploy.providers.ScanningAppProvider.doStart(ScanningAppProvider.java:121)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:64)
        at org.eclipse.jetty.deploy.DeploymentManager.startAppProvider(DeploymentManager.java:555)
        at org.eclipse.jetty.deploy.DeploymentManager.doStart(DeploymentManager.java:230)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:64)
        at org.eclipse.jetty.util.component.AggregateLifeCycle.doStart(AggregateLifeCycle.java:81)
        at org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:58)
        at org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:96)
        at org.eclipse.jetty.server.Server.doStart(Server.java:275)
        at org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:64)
        at org.eclipse.jetty.xml.XmlConfiguration$1.run(XmlConfiguration.java:1266)
        at java.security.AccessController.doPrivileged(Native Method)
        at org.eclipse.jetty.xml.XmlConfiguration.main(XmlConfiguration.java:1189)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
        at java.lang.reflect.Method.invoke(Unknown Source)
        at org.eclipse.jetty.start.Main.invokeMain(Main.java:472)
        at org.eclipse.jetty.start.Main.start(Main.java:620)
        at org.eclipse.jetty.start.Main.main(Main.java:95)
2012-12-18 14:48:18.261:WARN:oejw.WebAppClassLoader:EXCEPTION
java.lang.IllegalArgumentException: !file: jar:file:/C:/Shibboleth/2.3.8/war/idp.war!/WEB-INF/lib/antlr-runtime-3.1.3.ja
r
[******** Cut Off to get under StackOverFlow's Character Limit **************************] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-21T15:18:23.610

我使用 Maven 使用 Jetty 启动了 Shibboleth IDP。为了您的参考，我在这里为您提供了 POM 的代码和安装说明。对我来说工作得很好：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>org.apache</groupId>
<artifactId>shibboleth-idp</artifactId>
<packaging>pom</packaging>
<version>1.0-SNAPSHOT</version>
<name>Shibboleth IDP</name>

<build>
    <finalName>idp</finalName>
    <plugins>
        <plugin>
            <groupId>org.mortbay.jetty</groupId>
            <artifactId>maven-jetty-plugin</artifactId>
            <version>6.1.26</version>
            <configuration>
                <webApp>${basedir}/war/idp.war</webApp>
                <contextPath>/idp</contextPath>
                <connectors>
                    <connector implementation="org.mortbay.jetty.nio.SelectChannelConnector">
                        <port>7777</port>
                        <maxIdleTime>60000</maxIdleTime>
                    </connector>
        <connector implementation="org.mortbay.jetty.security.SslSocketConnector">
            <port>7443</port>
            <maxIdleTime>60000</maxIdleTime>
            <keystore>${basedir}/credentials/idp.jks</keystore>
            <password>KEYSTORE_PASSWORD_HERE</password>
            <keyPassword>PRIVATE_KEY_PASSWORD_HERE</keyPassword>
        </connector>
                </connectors>
            </configuration>
    <dependencies>
    <dependency>
        <groupId>xerces</groupId>
        <artifactId>xercesImpl</artifactId>
        <version>2.11.0</version>
    </dependency>
    </dependencies>
        </plugin>
    </plugins>

</build>
</project> 
```

安装说明

1.  下载最新版本的 IDP 从

    [http://shibboleth.net/downloads/identity-provider/latest/](http://shibboleth.net/downloads/identity-provider/latest/)

2.  解压压缩文件

3.  cd 进入目录并运行 install.sh 或 install.bat 命令。该脚本将创建一个 Shibboleth IDP 主目录。
4.  在 Shibboleth IDP 主目录中将 POM 文件另存为 pom.xml。
5.  确保在 POM 文件中调整 SSL 的参数，以便它们与您的系统设置和
6.  通过输入以下命令从 Shibboleth IDP 主目录启动 Shibboleth IDP：

    mvn jetty:run-war

现在您可以开始配置了。可以在[Shibboleth wiki](https://wiki.shibboleth.net/confluence/display/SHIB2/IdPInstall)上找到更多配置说明。

# mysql - 使用 PDO 的未定义变量

> ID：13943015
> 
> 赞同：0
> 
> 时间：2012-12-18T23:09:19.960
> 
> 标签：mysql, pdo, php

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T23:15:06.163

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:15:29.100

一个快速的解决方法是将你传递给`$db`，`function register`这样它就可以在这个函数范围内使用。确保首先从变量中删除`global`关键字`$db`，并且您需要使用`function register()`$db 变量来更新任何其他脚本并传递：

```
function register($username, $password, $email, $db){
//now you will have $db available inside this scope 
```

希望这会有所帮助，但是作为旁注，这相当笨拙，您可能应该专注于设置您的应用程序以使用类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T23:11:12.030

你似乎在宣布`$db`它`global`之前已经宣布了。

# php - 我的下拉列表中的每一行都由 3 个变量组成，我如何引用并将它们传递给表单 2？

> ID：13943026
> 
> 赞同：0
> 
> 时间：2012-12-18T23:10:11.280
> 
> 标签：php, html, arrays

在我的下拉列表中，每一行都有来自 db 的 3 个字段。我需要以某种方式将这些传递给另一个表单，我将在另一个 SQL 语句中引用它们。

我不确定如何通过它们。任何帮助将非常感激。

```
<form action='obtainaprice.php' method='POST'>
<?php

echo "<select name='makes' id='searchtext'>\n";

    $query1 = "SELECT DISTINCT make, type, model FROM device ORDER BY make, type, model";

    $result1 = mysql_query($query1)
       or die ("Couldn't execute query.");

    while ($row1 = mysql_fetch_array($result1))
    {
         $i=0;
             echo "<option value= \"" . $i . "\">" . $row1['make'] . " " . $row1['type'] . " " . $row1['model'] . "</option>";

             $i++;
    }

    echo "</select>\n";
?>
<input type="image" id="buttons" alt="Search" img src="images/button.png">
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:21:22.890

您的 option 元素只能传回 1 个东西（一个字符串），因此在运行下一个 SQL 语句之前，您必须先对其进行解析以获取品牌、类型和模型。

为什么没有 3 个选择元素？1 为每个品牌、类型、型号。

您要在其中使用这些值的下一条 SQL 语句是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:21:39.467

在这种情况下，您可以将选项的值设为行的 id，您需要选择：

```
"SELECT DISTINCT id, make, type, model FROM device ORDER BY make, type, model" 
```

假设您的主索引称为 id ...

```
<option value="<?php echo $row['id']; ?>"> 
```

然后在您的下一页上，您将根据 make 的 post 值运行下一个查询...

```
 "SELECT id, make, type, model FROM device WHERE id = ".$_POST['makes'] 
```

当然，您需要对此进行消毒。您应该切换到 mysqli 或 PDO。

旁注 - 你应该打破 php 来编写 html。它只是更清洁。首先运行您的查询，这样您就不会死在选择框的中间。我不容忍使用 mysql_ 函数，但为了举例，这就是我的意思......

```
<?php
    $query1 = "SELECT DISTINCT id, make, type, model FROM device ORDER BY make, type, model";
    $result1 = mysql_query($query1)
       or die ("Couldn't execute query.");
?>
<form action='obtainaprice.php' method='POST'>
    <select name='makes' id='searchtext'>
    <?php while ($row1 = mysql_fetch_array($result1)): ?>
        <option value="<?php echo $row['id']; ?>"><?php echo $row1['make']; ?> <?php echo $row1['type']; ?> <?php echo $row1['model']; ?></option>
    <?php endwhile; ?>
    </select>
    <input type="image" id="buttons" alt="Search" img src="images/button.png">
</form> 
```

# ios - 国际键盘使设备上的应用程序崩溃

> ID：13943032
> 
> 赞同：8
> 
> 时间：2012-12-18T23:10:24.790
> 
> 标签：ios, xcode4.5

测试我在设置了国际键盘的 iPhone 上编写的应用程序时遇到问题。

iPhone会记住我上次使用的输入布局（即当我在消息中并且我使用希伯来语键盘时，下次我将在另一个应用程序中使用键盘时，希伯来语布局将首先出现）所以当我运行时设备上的应用程序并尝试在文本字段中输入文本，光标出现但键盘没有，并且任何尝试触摸应用程序中的任何位置都会导致“线程 1：EXC_BAD_ACCESS（代码=1，地址=0x14）。

此外，当我使用的最后一个布局是英语布局时，即使我切换到希伯来语布局，应用程序也能完美运行。

我只是注意到它只发生在“Name Phone Pad”键盘上，有没有办法将此键盘与国际键盘一起使用？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T03:57:31.887

我最好的猜测是你有一个拦截击键的代表。我建议您指定每个文本字段的第一响应者并查看它是否有效，或者仅将文件本地化为英语（或任何语言）。

# plsql - 创建正确的程序

> ID：13943034
> 
> 赞同：0
> 
> 时间：2012-12-18T23:10:36.570
> 
> 标签：plsql

我正在尝试编写一个简单的 PL/SQL 过程，但我不断收到我不理解的错误。有一些语法错误，如果有人可以帮助我，我将不胜感激。我需要创建一个程序，允许我在表中插入具有两个日期（DATE）的特定人员（varchar2），即他的合同期限。但是他的合同不能在现有日期之间，因此不能重叠，同一个人可以有多次联系，但只能在完全不同的时期之间。我知道我需要使用 INTERSECT，只是我很困惑如何在这里使用它，因为我只有一张桌子。我以前与两张表相交，我如何在这里相交？我也不确定我是否可以有 2 个 if 语句 谢谢！

```
CREATE OR REPLACE PROCEDURE test1
(name             VARCHAR2,
 startDate        DATE,
 endDate          DATE) 
AS
overlap       NUMBER := 0;
CURSOR cursor IS 
SELECT date_from, date_to FROM contractTable;
BEGIN
   FOR row IN cursor LOOP
   /*check if there is an overlap between dates*/
     IF (startDate, endDate) INTERESECT (SELECT date_from, date_to FROM ContractTable) THEN
  overlap := overlap + 1;       
  END IF;
  /*if there isn't, then insert new contact for this person*/
  IF overlap <= 0 THEN
    INSERT INTO ContractTable VALUES(name, startDate, endDate);
  END IF;
  END test1; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T11:31:35.793

```
CREATE PROCEDURE test1 (l_name IN VARCHAR2, l_start_date IN DATE, l_end_date IN DATE) 
IS 

    l_overlap_check NUMBER;

BEGIN

    SELECT count(*) INTO l_overlap_check
      FROM contract 
     WHERE (l_start_date between start_date and end_date 
           OR
            l_end_date between start_date and end_date)
      AND l_name = name;

    IF l_overlap_check = 0 THEN
        INSERT INTO contract (name, start_date, end_date)
                      VALUES (l_name, l_start, l_end);
   END IF;

END; 
```

我没有方便的 Oracle 环境，但这应该是您需要的。

# php - 从根目录中的 Wordpress 子文件夹中的 Codeigniter URL 中删除 index.php

> ID：13943040
> 
> 赞同：4
> 
> 时间：2012-12-18T23:10:50.440
> 
> 标签：php, wordpress, .htaccess, codeigniter

我的服务器上的子文件夹中的 Codeigniter 应用程序以及文档根目录中的 Wordpress 安装存在一些问题。如果我隐藏`index.php`Codeigniter URL 的`.htaccess`

**/codeigniter/.htaccess**

```
DirectoryIndex index.php

<IfModule mod_rewrite.c>

  RewriteEngine on
  RewriteBase /
  RewriteCond $1 !^(index\.php|user_guide|robots\.txt)
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d 
  RewriteRule ^(.*)$ index.php/$1 [L,QSA]

</IfModule>

<IfModule !mod_rewrite.c>
  ErrorDocument 404 index.php
</IfModule> 
```

`/codeigniter`并让 Wordpress 忽略`RewriteCond %{REQUEST_URI} !^/(codeigniter).*$`

**/.htaccess**

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_URI} !^/(codeigniter).*$
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

然后导航到`www.mysite.com/codeigniter/my_controller/my_function`，我得到一个 404 错误，`No input file specified.` 我在[这里](https://stackoverflow.com/questions/10361742/codeigniter-no-input-file-specified-error)找到，添加一个`?`after`RewriteRule ^(.*)$ index.php`解决了 Codeiginiter 404 错误。

**/codeigniter/.htaccess**

```
RewriteRule ^(.*)$ index.php?/$1 [L,QSA] 
```

但是，我现在遇到了 Wordpress 404 错误，所以如果我`index.php`用`index.php?`in替换`/codeigniter/.htaccess`，Wordpress 重写规则 in似乎`/.htaccess`会`RewriteCond %{REQUEST_URI} !^/(codeigniter).*$`被忽略。有没有更好的方法来处理这个？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T23:48:51.523

在`RewriteBase`codeigniter 目录中应该说`/codeigniter/`

```
RewriteBase /codeigniter 
```

否则，重写`index.php`最终会转到 wordpress 的路由器。

# php - SQL查询哪里不同

> ID：13943042
> 
> 赞同：0
> 
> 时间：2012-12-18T23:10:57.507
> 
> 标签：php, mysql, sql

我正在尝试运行查询来选择客户受众，但它应该选择以前没有收到电子邮件的客户。电子邮件跟踪来自另一个表。这是原始查询：

```
SELECT 
  c.customers_firstname, 
  c.customers_lastname, 
  o.orders_id, 
  o.customers_id, 
  c.customers_email_address
FROM 
  orders o, 
  customers c,  
  order_status s
WHERE 
  o.customers_id = c.customers_id
  AND o.orders_id = s.orders_id
  AND o.orders_status = s.orders_status_id 
ORDER BY 
  o.orders_id ASC 
```

现在，我需要检查另一个名为 tracking 的表，看看该表中是否已经存在客户，如果存在，则跳过它。

这是我尝试过的，但它似乎不起作用：

```
SELECT 
   c.customers_firstname, 
   c.customers_lastname, 
   o.orders_id, 
   o.customers_id, 
   c.customers_email_address
FROM 
   orders o, 
   customers c 
INNER JOIN 
   tracking t 
ON 
   c.customers_id = t.customers_id,  
   order_status s
WHERE 
   o.customers_id = c.customers_id
   AND o.orders_id = s.orders_id
   AND o.orders_status = s.orders_status_id
   AND c.customers_id NOT LIKE t.customers_id
ORDER BY 
   o.orders_id ASC 
```

我究竟做错了什么？或者有什么办法可以更好地做到这一点？

补充：我完全忘记了一个更重要的因素 - 跟踪表有“模块”列，我只需要“联系”模块的结果。因此，换句话说，我需要过滤掉跟踪表中已经存在的客户，但前提是与联系人模块相关联，而不是与任何其他模块相关联。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:22:26.893

这等效于您的原始查询：

```
SELECT c.customers_firstname
     , c.customers_lastname
     , o.orders_id
     , o.customers_id
     , c.customers_email_address
  FROM orders o
  JOIN customers c 
    ON c.customers_id = o.customers_id
  JOIN order_status s 
    ON s.orders_id = o.orders_id
   AND s.orders_status_id = o.orders_status
 ORDER
    BY o.orders_id ASC 
```

# 添加反连接

为了满足您的规范，您可以使用“反连接”模式。我们可以将其添加到查询中，在 ORDER BY 子句之前：

```
 LEFT
  JOIN tracking t
    ON t.customers_id = o.customers_id
 WHERE t.customers_id IS NULL 
```

这将要做的是从`tracking`表中找到所有匹配的行，基于`customers_id`. 对于查询在 中找不到匹配行的任何行，`tracking table`它将生成一个虚拟行，`tracking`其中包含所有 NULL 值。（这是描述 OUTER JOIN 功能的一种方式。）

现在的“技巧”是丢弃所有匹配的行。我们通过从跟踪表（在 WHERE 子句中）检查客户 ID 的 NULL 值来做到这一点。对于匹配，该列不会为 NULL。（连接谓词中的等号比较向我们保证了这一点。）所以我们知道，如果我们得到 NULL 值`t.customers_id`，则不存在匹配项。

因此，此查询返回指定的结果集：

```
SELECT c.customers_firstname
     , c.customers_lastname
     , o.orders_id
     , o.customers_id
     , c.customers_email_address
  FROM orders o
  JOIN customers c 
    ON c.customers_id = o.customers_id
  JOIN order_status s 
    ON s.orders_id = o.orders_id
   AND s.orders_status_id = o.orders_status
  LEFT
  JOIN tracking t
    ON t.customers_id = o.customers_id
 WHERE t.customers_id IS NULL   
 ORDER
    BY o.orders_id ASC 
```

* * *

# 其他方法

还有其他方法，但反连接通常是表现最好的。

其他一些选项是`NOT EXISTS`谓词和`NOT IN`谓词。我可以添加这些，但我希望这些解决方案会在我解决之前在其他答案中提供。

* * *

从第一个查询开始（相当于您问题中的查询），我们还可以使用`NOT EXISTS`谓词。我们将在 ORDER BY 子句之前添加：

```
 WHERE NOT EXISTS 
       ( SELECT 1
           FROM tracking t
          WHERE t.customers_id = o.customers_id
       ) 
```

要使用`NOT IN`谓词，再次在 ORDER BY 子句之前添加：

```
 WHERE o.customers_id NOT IN
       ( SELECT t.customers_id
           FROM tracking t
          WHERE t.customers_id IS NOT NULL
       ) 
```

（您可能有一些保证 tracking.customers_id 不为空，但在更一般的情况下，子查询不返回 NULL 值很重要，因此我们包含一个 WHERE 子句，以便我们保证这一点。）

使用适当的索引，反连接模式通常比 the`NOT EXISTS`或 the表现更好`NOT IN`，但并非总是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:39:54.370

就像 spencer7593 建议的那样，您可以进行反加入，但不是

```
LEFT JOIN tracking t ON t.customers_id = o.customers_id
WHERE t.customers_id IS NULL 
```

你可以写得更轻松

```
JOIN tracking t ON t.customers_id = o.customers_id 
```

# c++ - std::string 中的非法指令

> ID：13943045
> 
> 赞同：0
> 
> 时间：2012-12-18T23:11:03.637
> 
> 标签：c++, templates

我有这个代码：

```
class USerializer {
public:
    template<typename T>
    static std::string serialize(std::list<T*> listOfObjectToSerialize)
    {
        // stringstream containing serialized Objects
        std::stringstream serializedObjectList;

        typename std::list<T*>::iterator iter;

        // serialize Objects
        for (iter = listOfObjectToSerialize.begin(); iter != listOfObjectToSerialize.end(); ++iter)
        {
            // Class delimiter
            serializedObjectList << '+'<< endl;

            // Need to serialise the class itself, and not the pointer to it!
            serializedObjectList << **iter;
        }

        return serializedObjectList.str();
    }
} 
```

然后我使用这样的方法：

```
std::string serializedAlarmInfo = USerializer::serialize<CcAlarm::AlarmInfo>(getActiveAlarms()); 
```

我收到一个 SIGILL 错误：

```
Program received signal SIGILL, Illegal instruction. 
```

使用 gdb 我跟踪了执行情况，在我退出序列化函数之前一切似乎都很好。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:24:33.760

尝试：

```
if ((*iter) == NULL)
{    throw std::runtime_error("Was not expecting that");
}
// Or use some other technique to compensate for a NULL pointer.
serializedObjectList << **iter; 
```

# php - php循环针对mysql中的id

> ID：13943053
> 
> 赞同：0
> 
> 时间：2012-12-18T23:11:48.293
> 
> 标签：php, mysql, loops, foreach

我的页面的某些部分应仅针对符合此条件的 ID 显示：

```
<?php
    $admins = mysql_query("SELECT id FROM users WHERE is_admin='y'");
?> 
```

所以它可以像 1,4 或 1,4,7,3,10,[...] 等等，所以这些人（ID）可以看到专门的东西，现在......

以前，我有类似的东西：

```
<?php
    if ($_SESSION['id'] == $customer['id']) 
    { 
        echo "<br />";
                [...] Dedicated content [...]
        }
?> 
```

直到今天一直有效。现在我需要为更多的人制作它，与数据库相关，如果`($_SESSION['id'] == result`. `SELECT`我怎样才能做到这一点？

谢谢指教！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:16:06.913

您可以将会话 ID 放入查询中并使用 mysql_num_rows() 检查您是否选择了任何行：

```
<?php
$admins = mysql_query("SELECT id FROM users WHERE id=".(int)$_SESSION['id']." AND is_admin='y'");
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:16:14.930

只需将所有这些人放入数据库并像这样检查：

```
<?php
    $admins = mysql_query("SELECT * FROM users WHERE id='". mysql_real_escape_string($_SESSION['id']) ."' and  is_admin='y'");

?> 
```

此时，如果至少返回一行（是的，它应该只返回一行），您可以继续处理专用内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T23:17:07.567

如果会话 id 与数据库中的用户 id 相同，您可以检查会话 id 是数据库中管理员的位置。这将简化您的需求

# css - 是否可以在 Chrome 开发者工具中将单位从 px 更改为 em

> ID：13943055
> 
> 赞同：4
> 
> 时间：2012-12-18T23:11:57.470
> 
> 标签：css, google-chrome, browser, google-chrome-devtools, em

我一直在做所有`em`基于编码的工作，所以当我检查我的元素并获得一个宽度时`px`，这只是做数学的一个额外步骤。是否可以在 Chrome 开发人员工具中将单位从更改为`px`？`em`

**编辑：上传的图片**

![在此处输入图像描述](../Images/b1ee6e54042e94fa9ea1691fb0b66e33.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T06:40:23.190

并不真地。为方便起见，框尺寸只是此处显示的焦点元素的`offsetWidth`和`offsetHeight`。

# python - 从字符串日期中提取一年中的某一天和儒略日

> ID：13943062
> 
> 赞同：29
> 
> 时间：2012-12-18T23:12:36.843
> 
> 标签：python, date, datetime, julian-date

我`"2012.11.07"`在python中有一个字符串。我需要将其转换为 date 对象，然后获取*day of year*和*Julian day*的整数值。是否可以？

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2012-12-18T23:17:12.373

首先，您可以将其转换为[`datetime.datetime`](http://docs.python.org/library/datetime.html#datetime-objects)如下对象：

```
>>> import datetime
>>> fmt = '%Y.%m.%d'
>>> s = '2012.11.07'
>>> dt = datetime.datetime.strptime(s, fmt)
>>> dt
datetime.datetime(2012, 11, 7, 0, 0) 
```

然后你可以使用方法`datetime`来得到你想要的......只是`datetime`没有你想要的功能，所以你需要转换为[时间元组](http://docs.python.org/2/library/time.html#time.struct_time)

```
>>> tt = dt.timetuple()
>>> tt.tm_yday
312 
```

“儒略日”一词有几个不同的含义。如果您正在寻找`2012312`，则必须间接执行此操作，例如，以下操作之一。

```
>>> int('%d%03d' % (tt.tm_year, tt.tm_yday))
2012312
>>> tt.tm_year * 1000 + tt.tm_yday
2012312 
```

如果您正在寻找不同的含义，您应该能够从这里弄清楚。例如，如果您想要“自公元前 4713 年 1 月 1 日以来的天数”的含义，并且您有一个需要公历年份和年份的公式，则可以插入上面的这两个值。（如果您有一个公式需要公历年、月和日，您甚至不需要该`timetuple`步骤。）如果您无法确定从那里去哪里，请询问更多详细信息。

如果你没有公式——也许即使你已经有了——最好的办法可能是查看 PyPI 和 ActiveState 以查找预先存在的模块。例如，快速搜索会找到一个名为[`jdcal`](http://pypi.python.org/pypi/jdcal/1.0). 我以前从未见过它，但快速`pip install jdcal`而简短地浏览了自述文件，我能够做到这一点：

```
>>> sum(jdcal.gcal2jd(dt.year, dt.month, dt.day))
2456238.5 
```

这与 USN [Julian 日期转换器](http://aa.usno.navy.mil/data/docs/JulianDate.php)给我的结果相同。

如果你想要整数儒略日，而不是分数儒略日，你必须决定你想要向哪个方向舍入——向 0、向负无穷、将中午舍入到第二天、将中午舍入到偶数天等。（请注意，儒略日期定义为从 4713 年 1 月 1 日中午开始，因此 2012 年 11 月 7 日的一半是 2456238，另一半是 2456239，只有你知道你想要哪一个……）例如，向 0 舍入：

```
>>> int(sum(jdcal.gcal2jd(dt.year, dt.month, dt.day)))
2456238 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-08-18T13:08:31.973

要获得儒略日，请使用该`datetime.date.toordinal`方法并添加固定偏移量。

儒略日是自 BC 4713 年 1 月 1 日 12:00 在预产儒略历或 4714 年 11 月 24 日在 12:00 在[预产公历](https://en.wikipedia.org/wiki/Proleptic_Gregorian_calendar)中的天数。请注意，每个儒略日从中午开始，而不是午夜。

该`toordinal`函数返回自公元前 1 年 12 月 31 日 00:00 前的公历以来的天数（换句话说，公元 1 月 1 日 00:00 是第 1 天的开始，而不是第 0 天）。请注意，公元前 1 年直接在公元 1 年之前，没有 0 年，因为直到许多世纪后才发明数字零。

```
import datetime

datetime.date(1,1,1).toordinal()
# 1 
```

只需将 1721424.5 添加到结果中`toordinal`即可获得儒略日。

另一个答案已经解释了如何解析您开始使用的字符串并将其转换为`datetime.date`对象。所以你可以找到儒略日如下：

```
import datetime

my_date = datetime.date(2012,11,7)   # time = 00:00:00
my_date.toordinal() + 1721424.5
# 2456238.5 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-01-04T01:21:09.090

为了简化 abarnert 回答的初始步骤：

```
from dateutil import parser
s = '2012.11.07'
dt = parser.parse(s) 
```

然后应用 abanert 的其余答案。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-14T08:24:27.453

为了快速计算，您可以仅使用 stdlib模块找到一年中的某一*天和儒略日数：*`datetime`

```
#!/usr/bin/env python3
from datetime import datetime, timedelta

DAY = timedelta(1)
JULIAN_EPOCH = datetime(2000, 1, 1, 12) # noon (the epoch name is unrelated)
J2000_JD = timedelta(2451545) # julian epoch in julian dates

dt = datetime.strptime("2012.11.07", "%Y.%m.%d") # get datetime object
day_of_year = (dt - datetime(dt.year, 1, 1)) // DAY + 1 # Jan the 1st is day 1
julian_day = (dt.replace(hour=12) - JULIAN_EPOCH + J2000_JD) // DAY
print(day_of_year, julian_day)
# 312 2456239 
```

另一种获取方式`day_of_year`：

```
import time

day_of_year = time.strptime("2012.11.07", "%Y.%m.%d").tm_yday 
```

`julian_day`在上面的代码中是[“与太阳日相关的儒略日编号 - 分配给从儒略日编号 0 开始的连续天数中的一天的编号，分配给从格林威治开始的日子意味着 4713 年 1 月 1 日中午，儒略历-4712"](http://www.iers.org/nn_10910/IERS/EN/Science/Recommendations/resolutionB1.html)。

[`time`模块文档](https://docs.python.org/3/library/time.html)以不同的方式使用术语*“朱利安日”*：

> `Jn`儒略日 n (1 <= n <= 365)。闰日不计算在内，因此在所有年份中，2 月 28 日是第 59 天，3 月 1 日是第 60 天
> `n`。从零开始的儒略日 (0 <= n <= 365)。闰日计算，可参考2月29日。

即，从零开始的儒略日就`day_of_year - 1`在这里。第一个 ( `Jn`) 是`day_of_year - (calendar.isleap(dt.year) and day_of_year > 60)`- 从 3 月 1 日开始的日期被转移以排除闰日。

还有一个相关的术语：*朱利安日期*。 *儒略日数*是一个整数。*儒略日期*本质上是分数：[“任何时刻的*儒略日期 (JD)是前一个中午的**儒略日数*加上自该时刻以来的一天的分数。”](http://www.iers.org/nn_10910/IERS/EN/Science/Recommendations/resolutionB1.html)

通常，为了避免自己处理极端情况，请使用库来计算[@abarnert 建议的](https://stackoverflow.com/a/13943108/4279)儒略日。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-02-18T21:37:50.797

此功能（将日期字符串转换为儒略日期/时间）也存在于[astropy](http://www.astropy.org/)模块中。有关完整的详细信息，请参阅[他们的文档](http://astropy.readthedocs.org/en/latest/time/)。astropy 实现对于轻松转换为儒略*时间*特别方便，而不仅仅是儒略*日期*。

原始问题的示例解决方案：

```
>>> import astropy.time
>>> import dateutil.parser

>>> dt = dateutil.parser.parse('2012.11.07')
>>> time = astropy.time.Time(dt)
>>> time.jd
2456238.5
>>> int(time.jd)
2456238 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-07-13T06:04:52.853

根据[这篇文章](http://adsabs.harvard.edu/abs/1979ApJS...41..391V)，Fliegel 和 Van Flandern 创建了一个未发表的单行公式，用于计算公历日期到儒略日期：

```
JD = 367 * year - 7 * (year + (month + 9)/12)/4 - 3 * ((year + (month - 9)/7)/100 + 1)/4 + 275 * month/9 + day + 1721029 
```

这是由加利福尼亚州帕萨迪纳市喷气推进实验室的 PM Muller 和 RN Wimberly 于 1900 年 3 月之后的日期压缩的：

```
JD = 367 * year - 7 * (year + (month + 9)/12)/4 + 275 * month/9 + day + 1721014 
```

这些公式相差 0.5，因此只需从公式中减去 0.5。

使用一些字符串操作来实际提取数据，你会很好

```
>>> year, month, day = map(int,"2018.11.02".split("."))
>>> 367 * year - 7 * (year + (month + 9)/12)/4 + 275 * month/9 + day + 1721014 - 0.5
2458424.5 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-03-10T14:21:20.530

我导入 datetime 库，并使用 strftime 提取“朱利安日”、年、月、日...

```
import datetime as dt
my_date = dt.datetime.strptime('2012.11.07', '%Y.%m.%d')
jld_str = my_date.strftime('%j') # '312'
jld_int = int(jld_str)           #  312 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-03-05T01:28:15.923

从上面的例子中，这里是一个班轮（非朱利安）：

```
import datetime

doy = datetime.datetime.strptime('2014-01-01', '%Y-%m-%d').timetuple().tm_yday 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-01-12T14:08:00.737

```
def JulianDate_to_date(y, jd):
    month = 1
    while jd - calendar.monthrange(y,month)[1] > 0 and month <= 12:
        jd = jd - calendar.monthrange(y,month)[1]
        month += 1
    date = datetime.date(y,month,jd).strftime("%m/%d/%Y")
    return date 
```

# javascript - Canvas rotation inverse X

> ID：13943065
> 
> 赞同：1
> 
> 时间：2012-12-18T23:13:06.850
> 
> 标签：javascript, html, canvas

I cannot make [this ray](http://jsfiddle.net/8dfvM/) to follow my mouse cursor.

It's always inverse on X axis.

I think that the problem is with my atan function, but since my trigonometry is fairly low, I have no idea how to fix this one.

This is how I calculate radians:

```
 var dx = target.x - center.x;
 var dy = target.y - center.y;

 var rad = Math.atan2(dx, dy); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:17:26.633

```
var dx = center.x - target.x; 
```

[**Fiddle**](http://jsfiddle.net/8dfvM/4/)

* * *

The fiddle above doesn't work in Firefox as FF doesn't natively support `event.offsetX`/`Y` for mouse events, I assume your normalization code was cut off when making the minimalistic example but I'll leave my normalization code here for future reference:

```
function normOffset(event) {
    if (typeof event.offsetX === 'undefined' || typeof event.offsetY === 'undefined') {
        var targetOffset = $(event.target).offset();
        event.offsetX = event.pageX - targetOffset.left;
        event.offsetY = event.pageY - targetOffset.top;
     }
} 
```

Then just pass the jQuery event object to it.

[**Fiddle**](http://jsfiddle.net/8dfvM/5/)

# java - Java新手：如何在不建立引用的情况下将对象的当前状态分配给另一个？

> ID：13943067
> 
> 赞同：0
> 
> 时间：2012-12-18T23:13:13.853
> 
> 标签：java, arrays, reference, clone

再一次，我正在寻找绕过这个数组问题的方法，如何？除此以外还有什么办法`clone()`吗？我问是因为与克隆（），保护和实施的东西对我不起作用......

```
//assuming you have proper class and constructor (point(int x, int y))    
/*
   point 7POINTSARRAY[]=new point[7];
   for(int i=0;i<7;i++)
   {
   7POINTSARRAY[i].x=i;
   7POINTSARRAY[i].y=i;
   }
//This won't work, so...
 */

point B = new point(0,0); // You need this.
for(int i=0;i<7;i++){
    7POINTSARRAY[i]=B;     // And this. 
    //But I want to read and assign value only,
    //  not establish a reference, so it can work How?
    7POINTSARRAY[i].x=i;
    7POINTSARRAY[i].y=i;
    System.out.println(7POINTSARRAY[i].x);
}
System.out.println(7POINTSARRAY[1].x); 
```

虽然期望的输出是 A[1].x=1，但它已经被改写了好几次，现在 A[1].x = 7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:22:39.043

`point`如果您希望它们都引用不同的对象，则需要为数组的每个元素创建一个新元素：

```
 for(int i=0;i<7;i++)
    {
        point B = new point(0,0); // Put this *inside* the loop
        7POINTSARRAY[i]=B;        // Now B is a new instance of point
        7POINTSARRAY[i].x=i;
        7POINTSARRAY[i].y=i;
        System.out.println(7POINTSARRAY[i].x);
    }
    System.out.println(7POINTSARRAY[1].x); // should now print 1 
```

我没有更改您的代码格式，但改进这将使上述内容更加清晰易懂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:38:32.810

抱歉，Java 仅适用于复杂对象的引用。您应该`clone()`正确使用和实施，这不是问题。`clone()`是定义明确的方法。

一级类的典型克隆如下所示

```
 @Override
    public Object clone() {
        try {
            A ans = (A) super.clone();

            // do complex stuff

            return ans;

        } catch (CloneNotSupportedException e) {
            throw new AssertionError();
        }

    } 
```

线

```
A ans = (A) super.clone(); 
```

执行默认克隆，其中包括克隆对象但不包括其成员。您应该为成员级联克隆。由于`clone()`是成员，它可以访问父级的受保护成员。

如果你的父母是`Cloneable`你应该写

```
 @Override
    public Object clone() {
        A ans = (A) super.clone();

        // do complex stuff

        return ans;
    } 
```

因为父母不能抛出异常。

例如，如果您的点类如下所示

```
class point {
   public point(double x, double y) { this.x = x; this.y = y; }
   public double x;
   public double y;
} 
```

那么你应该通过以下方式修复它

```
class point implements Cloneable {
   public point(double x, double y) { this.x = x; this.y = y; }
   public double x;
   public double y;
} 
```

使其可克隆。

然后你就可以写了

```
point a = new point(1,2);
point b = (point) a.clone(); 
```

您将获得 2 个单独的副本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T23:25:11.430

问题出在线路上

```
7POINTSARRAY[i]=B 
```

这意味着 7POINTSARRAY 中的每个对象都引用（或指向）同一个对象 B。

所以当你在循环内做

```
7POINTSARRAY[i].x=i;
            7POINTSARRAY[i].y=i; 
```

你实际上总是在改变 B。

你应该这样做：

```
for(int i=0;i<7;i++){
    7POINTSARRAY[i] = new point(i,i);
} 
```

# computational-geometry - 从 Qhull 输出中获取 3D Voronoi 细胞

> ID：13943068
> 
> 赞同：1
> 
> 时间：2012-12-18T23:13:18.393
> 
> 标签：computational-geometry, voronoi, qhull

我的目标是从 Qhull 的 qvoronoi 子例程的输出中获取单个 3D Voronoi 单元（顶点和边）。但是，我无法理解 voronoi 脊（输出“Fv”）。输出中的示例行是：

```
7 0 1 1 0 4 5 3 
```

第一个数字是行中的顶点数，接下来的两个是被脊分隔的顶点的索引，其余的数字是脊上的顶点索引。我天真地尝试连接相邻的顶点（即`4->5`, `5->3`, `3->1`等），它似乎有效，但我不确定这是否正确。这些点如何相互连接？

此外，从 qvoronoi 输出（选项“FN”）中，我可以获得每个区域的顶点，但没有关于顶点之间连接性的信息。我想知道这些信息在哪里。它是在 ridges 输出中，还是在不同的 qvoronoi 输出选项中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T06:29:27.907

山脊的指数似乎不是循环顺序的。因此，重建多边形面可能是不可能的。

另一种方法是将`gvoronoi`每个单元的输出传递`qconvex`给构造凸包。这不能很好地扩展，但如果您想要可视化或分析的单元格很少，则可能没问题。

例如，要获取 30 个输入站点中输入站点 5 的 Voronoi 单元：

```
$ rbox 30 D3 | qvoronoi QV5 p | qconvex G 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-31T18:23:04.727

### 试试凸包

因为 Voronoi 只保证凸多面体，所以有一种通过找到凸包（在我的情况下为`scipy.spatial.ConvexHull()`）来找到它的 hacky 方法。您的 Voronoi 区域周围的最小凸包将等同于您想要的，`scipy.spatial`甚至免费为您提供更多东西

```
hull=scipy.spatial.ConvexHull(vertices)
volume=hull.volume
triangle_mesh_hull=vertices[hull.simplices] # shape is (n,3,3) 
```

归功于[Jaime](https://stackoverflow.com/questions/26434726/return-surface-triangle-of-3d-scipy-spatial-delaunay/26516915)上面非常简短、优雅的线条。如果你想在此之后对网格的每个三角形部分做一些事情，你可以像这样访问它：

```
for triangle in triangle_mesh_hull:
  do_stuff_to(triangle)
  ...
  ...
  ...
  do_more_stuff_with(triangle)
  ...
  ...
  ... 
```

# javascript - 用 Flot 绘制一段数据

> ID：13943069
> 
> 赞同：0
> 
> 时间：2012-12-18T23:13:19.903
> 
> 标签：javascript, jquery, flot

我正在绘制简单的条形图[Flot](https://github.com/flot/flot)绘制简单的带状图。我如何实现滚动窗口？

[jsFiddle](http://jsfiddle.net/cnpb3/2/)

所以说在十分钟内，我有大约 1000 个数据点，但我只想显示最近的 100 个。我该怎么做呢？它必须是非破坏性的，因为我想实现一个滚动条，这样我就可以滚动数据，同时一次只能看到 100 个数据点。

我尝试调整 xaxis... 不好。

```
// Why doesn't this work?
var options = plot.getOptions();
options.xaxis.min = data[i].length - 100;
options.xaxis.max = data[i].length; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T18:24:21.330

很酷的情节。

您正在寻找：

```
 var options = plot.getOptions();
    options.xaxes[0].min = data[i].length - 100;
    options.xaxes[0].max = data[i].length; 
```

[在这里](http://jsfiddle.net/cnpb3/4/)更新了小提琴。

# android - Android 应用程序内存使用分析工具

> ID：13943070
> 
> 赞同：0
> 
> 时间：2012-12-18T23:13:22.993
> 
> 标签：android, memory-management, memory-leaks

我正在开发一个运行时当前使用大约 32mb RAM 的 Android 应用程序。我想降低这种用法。是否有任何可用的工具可以让我查看我的应用程序的哪些部分（活动、服务等）正在消耗内存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:19:34.747

是的，一个简单的谷歌搜索Android内存分析会出现很多相关信息。对我来说，第一项是这篇[Android 开发者博客文章](http://android-developers.blogspot.com/2011/03/memory-analysis-for-android.html)，其中包含很多有用的东西，包括有关 HPROF 工具的信息。

# c# - c#单元测试，重复公共代码

> ID：13943078
> 
> 赞同：2
> 
> 时间：2012-12-18T23:14:13.367
> 
> 标签：c#, unit-testing, mstest

> **可能重复：**
> [MSTest 中 [SetUp] 和 [TearDown] 的替代方法是什么？](https://stackoverflow.com/questions/6193744/what-would-be-an-alternate-to-setup-and-teardown-in-mstest)

我正在学习如何总体上使用单元测试和自动化测试，并且有一些我无法弄清楚/找不到答案的问题

我目前通过多个调用各种方法并在其中包含断言的 [TestMethod] 进行测试。现在，TestMethod 都有重复的代码来访问数据库并为其余的测试设置自己。一个例子是：

```
public void TestDBReturnsFooInFormatXyz() {
    var foo = HitDBAndReturnStuff();
    Assert.IsTrue( // foo format is xyz );
}

public void TestDBFooContainsAbc() {
    var foo = HitDBAndReturnStuff();
    Assert.IsTrue( // foo contains abc );
} 
```

所以有些问题：在测试类中创建私有字段并让构造函数设置它们是最佳实践吗？

我应该在每个 TestMethod 中都这样做，因为测试速度并不重要吗？

我应该在构造函数顶部放置什么 [Test???] 以确保在运行测试时调用它？

我查看了 MSDN 和“Programming Microsoft Visual C# 2008: The Language”一书，但找不到任何关于单元测试的好信息。如果有我应该阅读的资源可以回答这些问题，请告诉我。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:29:07.967

重复代码总是一种不好的做法，因此您应该重构代码以初始化[TestInitialize 方法中的](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.testtools.unittesting.testinitializeattribute%28v=vs.80%29.aspx)**foo**对象，该方法在每次测试运行之前执行一次，然后在每个测试用例中执行特定操作：

```
private FooType foo;

[TestInitialize()]
public void TestInitialize()
{
    foo = CreateFooObject();
}

[TestMethod()]
public void TestToAssertThatAbcStuffGetsDone()
{
    foo.DoAbcStuff();
    Assert.IsTrue(foo.DidAbc());
}

[TestMethod()]
public void TestToAssertThatXyzStuffGetsDone()
{
    foo.DoXyzStuff();
    Assert.IsTrue(foo.DidXyz());
} 
```

如果您的**foo**对象需要在每个测试方法运行后被释放，您还应该实现一个[TestCleanup Method](http://msdn.microsoft.com/en-US/library/microsoft.visualstudio.testtools.unittesting.testcleanupattribute%28v=vs.100%29.aspx)。

但是，[在单元测试中使用数据库并不是最佳实践](https://stackoverflow.com/questions/607620/is-it-bad-practice-to-run-tests-on-a-db-instead-of-on-fake-repositories)，因为您不希望外部依赖影响测试结果。相反，您应该使用类似于数据库的数据库模拟，但将单元测试与真实的数据库依赖项隔离开来。

一些与数据库相关的问题可能会破坏您的测试，例如连接失败、超时、数据更改和偶尔的数据库升级。[这个 SO question](https://stackoverflow.com/questions/145131/whats-the-best-strategy-for-unit-testing-database-driven-applications)讨论了处理数据库依赖问题的策略。

# entity-framework - EF5 我可以附加一个从未从 Db 查询过的实体吗？

> ID：13943079
> 
> 赞同：0
> 
> 时间：2012-12-18T23:14:16.730
> 
> 标签：entity-framework, entity-framework-5

我正在尝试附加一个从未从数据库中“拉出”的实体并让它更新现有行。例如，我在 MVC（已修改）中传递了一个完整的模型，我只是想在没有往返的情况下保存它以首先获取实体，然后进行编辑，因为我已经有了上一次调用的信息。

我所拥有的是：

```
public static int ModifyExistingEntity<T>(this DbContext db, T updated) where T : class
{
    DbSet<T> set = db.Set<T>();
    set.Attach(updated);
    db.Entry(updated).State = EntityState.Modified;
    return db.SaveChanges();
} 
```

但是当我运行它时，我得到了这个：

> System.Data.Entity.Infrastructure.DbUpdateConcurrencyException：存储更新、插入或删除语句影响了意外的行数 (0)。自加载实体后，实体可能已被修改或删除。刷新 ObjectStateManager 条目。---> System.Data.OptimisticConcurrencyException：存储更新、插入或删除语句影响了意外的行数 (0)。自加载实体后，实体可能已被修改或删除。刷新 ObjectStateManager 条目。

这意味着没有任何更新。我在这里想念什么？主键设置正确，但请记住，实体不是从数据库中提取的，它是根据先前查询的信息 + 更新构建的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T07:47:13.970

```
set.Attach(updated); 
```

您不需要上述行，因为它将实体以未更改的状态附加到上下文。您可能会遇到乐观并发异常，因为在这样附加时，上下文跟踪的原始值（db 值）被设置为更新值的值。看看是否只使用下面的行，因为它既将实体附加到上下文并设置状态。

```
db.Entry(updated).State = EntityState.Modified; 
```

[http://msdn.microsoft.com/en-us/data/jj592676.aspx](http://msdn.microsoft.com/en-us/data/jj592676.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T03:16:35.247

您可以尝试继承的静态扩展可能存在一些问题，

```
public class MyContext:DbContext {

  public int ModifyExistingEntity<T>(this DbContext db, T updated) where T : class
  {
    DbSet<T> set = Set<T>();
    set.Attach(updated);
    this.Entry(updated).State = EntityState.Modified;
    return SaveChanges();
  }

} 
```

# javascript - 将 JSON 数据分成 2 组

> ID：13943081
> 
> 赞同：0
> 
> 时间：2012-12-18T23:14:36.343
> 
> 标签：javascript, json

我有一个 json 数据，我想分成 2 组数据数组一个 json 数据将保存“构造”数据值下的所有值，第二个 json 数据将保存其余的 araay 以及产品和系统的值。

如何将 JSON 分成两部分？

```
{
    "html": [{
        "type": "fieldset",
        "caption": "Construct",
        "html": [{
            "title": "tooltip data for rk",
            "name": "rk_",
            "value": "24",
            "caption": "DNS Servers (a list of IP addresses separated by comas)",
            "type": "textarea"
        }, {
            "title": "tooltip data for rk_ntpservers",
            "name": "rk_ntpservers",
            "value": "111.11.11.11",
            "caption": " separated by comas",
            "type": "textarea"
        }, {
            "title": "tooltip data for ff_eth0_ff",
            "name": "ff_eth0_ff",
            "value": "18",
            "caption": "Public  Address (0.0.0.0 to disable)",
            "type": "text"
        }, {
            "title": "tooltip data for ff_eth0_netmask",
            "name": "ff_eth0_netmask",
            "value": "2.2.2.0",
            "caption": "Public rk Netmask",
            "type": "text"
        }, {
            "title": "tooltip data for ff_eth1_ff",
            "name": "ff_eth1_ff",
            "value": "0.0.0.0",
            "caption": "MG Device rk (0.0.0.0 to disable)",
            "type": "text"
        }, {
            "title": "tooltip data for ff_eth1_netmask",
            "name": "ff_eth1_netmask",
            "value": "2.2.2.0",
            "caption": "MG Device rk Netmask",
            "type": "text"
        }, {
            "title": "tooltip data for ff",
            "name": "ff_gateway",
            "value": "1",
            "caption": "Gateway",
            "type": "text"
        }]
    }, {
        "type": "fieldset",
        "caption": "Product",
        "html": [{
            "title": "tooltip data for product_ident",
            "name": "product_ident",
            "value": "78",
            "caption": "Product Name",
            "type": "text",
            "disabled": "disabled"
        }, {
            "title": "tooltip data for product_svnversion",
            "name": "product_svnversion",
            "value": "7916",
            "caption": "Revision",
            "type": "text",
            "disabled": "disabled"
        }]
    }, {
        "type": "fieldset",
        "caption": "System ",
        "html": [{
            "title": "tooltip data for system_license",
            "name": "system_license",
            "value": "HH",
            "caption": "License",
            "type": "text"
        }, {
            "title": "tooltip data for system_variant",
            "name": "system_variant",
            "value": "normal",
            "caption": "Variant",
            "type": "text"
        }]
    }, {
        "type": "fieldset",
        "class": "btn-fieldset",
        "caption": "",
        "html": [{
            "type": "submit",
            "id": "submitbtn",
            "class": "btn btn-primary",
            "value": "Save"
        }]
    }]
} 
```

我的更新代码现在可以工作了

我似乎无法输出构造组数据:(。但我可以很好地输出 resofJSONdata，

```
$(document).ready(function () // don't do anything until the document is loaded.
{

    var baseUrl = "configuration.json";

    $.getJSON(baseUrl, function (data) // call getJSON providing the complete url with search term and a JSONP callback
    {
        // console.log(data.html.splice(2,3));
        // console.log("data " +data);

        console.log(data.html.splice(3, 0)); // remove and log the empty fieldset
        var constructgrp = data.html.shift(); // remove the first item (caption: "Construct")

        var restofJSONdata = data.html;
        alert(constructgrp);

        $("#demo-3-form").empty(); // clear out any previous results.
        if (data.html.length < 1) $('#demo-3-forms').html("No results. Nada. Nuttin. Zippo.");

        //$("#demo-3-form").empty(); // clear out any previous results.
        // if (data.html.length < 1) $('#demo-3-forms').html("No results. Nada. Nuttin. Zippo.");
        //   $.each(this.constructgrp, function () // iterate over the results, constructing the HTML for the display.
        // {

        var html = constructgrp.type + ' :';
        html += '<b>' + constructgrp.caption + '</b><br>';

        html += ' <br>';
        $.each(constructgrp.html, function () {
            //  alert(this.name);
            html += 'Title :' + this.title + '<br>';
            html += 'Name :' + this.name + '<br>';
            html += 'Value :' + this.value + '<br> ';
            html += 'Caption :' + this.caption + '<br><br> ';
            // html += this.type +'<br><br> ';
        });
        $('#demo-3-form').hide().append(html).fadeIn(800); // fade in the results over 2 seconds.
        // });

        $.each(restofJSONdata, function () // iterate over the results, constructing the HTML for the display.
        {

            var html = this.type + ' :';
            html += '<b>' + this.caption + '</b><br>';

            html += ' <br>';
            $.each(this.html, function () {
                //  alert(this.name);
                html += 'Title :' + this.title + '<br>';
                html += 'Name :' + this.name + '<br>';
                html += 'Value :' + this.value + '<br> ';
                html += 'Caption :' + this.caption + '<br><br> ';
                // html += this.type +'<br><br> ';
            });
            $('#demo-3-form').hide().append(html).fadeIn(800); // fade in the results over 2 seconds.
        });

    });
    //});
}); 
```

html

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:20:51.117

您似乎[`.slice()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/slice)与[`.splice()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/splice). 第一个提取数组项，第二个删除它们。也许这就是你想要的：

```
console.log(data.html.splice(3)); // remove and log the 4th item and everything after 
var constructgrp = data.html.shift(); // remove the first item (caption: "Construct")
var restofJSONdata = data.html; // take what is left over 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:42:13.203

尝试使用 JavaScript 的[`Array.reduce(...)`方法](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/Reduce)：

```
var splitData = data.html.reduce(function(memo, x) {
  // Pick the array of "Construct" or "Other" data.
  var arr = memo[(x.caption==='Construct' ? 'Construct' : 'Other')];
  [].push.apply(arr, x.html); // Push to it all of the items in the "html" array.
  return memo;
}, {Construct:[],Other:[]});

splitData.Construct; // => [{value:24,...}, ...]
splitData.Other;     // => [{value:78,...}, ...] 
```

请注意，如果您*只*想要“产品”和“系统”下的项目（而不是另一个，空的），那么在选择要推送数据的目标数组时，您需要添加额外的检查。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T23:47:08.083

As you only have 3 elements, this seems pretty straightforward:

```
data.html[0] is your Construct
data.html[1] is your Product
data.html[2] is your System 
```

So for example an array with Product and System would simply be:

```
[data.html[1],data.html[2]] 
```

[Update] If you have more than 3 elements and just need to isolate the first one:

```
var firstElement=data.html.shift(); 
```

shift() will both remove the first element from the array and return it.

# python - 如何使用 Beautiful soup 在标签中搜索特定的“class=id”类型属性？

> ID：13943087
> 
> 赞同：1
> 
> 时间：2012-12-18T23:15:20.723
> 
> 标签：python, parsing, beautifulsoup

我正在尝试使用 BeautifulSoup 抓取具有以下一般格式的页面：

```
<span class="ID1"> TEXT </span>
<span class="ID2"> TEXT2 </span> 
```

这些都存储在 a 中`<div>`，所以我的通用代码模板如下所示：

```
for tag in soup.find_all('div'):
    print tag.find('span') 
```

这会拉出 中的所有`<span>`标签`div`，但我不知道如何在`<span>s`. `tag.find('class')`我已经尝试过, 和之类的东西`.find('ID')`，但没有运气。

我可以通过获取对象的这个字符串表示然后测试它是否具有我正在寻找的 ID 来手动找到我正在寻找的东西，但这似乎是一种创可贴的方法。我确定有些东西我只是没有看到。

注意：我还尝试将 ID 的正则表达式传递给`find`函数 ala：

```
for tag in soup.find_all('div'):
    print tag.find(re.compile('id2')) 
```

不幸的是，仍然没有运气。

那么，如何搜索特定的类值？

# *编辑[已解决]

* * *

我想出了如何通过 BeautifulSoup 的内置`find`函数来做到这一点，而无需手动检查其字典结构。

要使用该`find`函数在 html 标签中挑选特定`class=value`的标签，请将您要查找的通用标签名称作为第一个参数传入（在我的情况下，它是 '' 标签的一部分）。`'class' : 'value'`作为第二个参数，传入包含您要查找的特定内容的字典。

例如，如果我要抓取的 HTML 如下所示：

```
<div>
    <span class="ID1"> TEXT </span>
    <other HTML junk> 
    <span class="ID2"> TEXT2 </span>
</div> 
```

我可以使用如下声明。

```
for tag_elm in soup.find_all('div'):
    print tag_elm.find('span', {'class' : 'ID2'}) 
```

多田！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T23:17:54.403

这应该有效：

```
for tag in soup.findAll('span'):
    if tag.has_key('class'):
        if tag['class'] == 'ID2':
            # do stuff 
```

测试了这段代码：

```
from BeautifulSoup import BeautifulSoup

text = '''
<span class="ID1"> TEXT </span>
<span class="ID2"> TEXT2 </span>
'''

soup = BeautifulSoup(text)

for tag in soup.findAll('span'):
    if tag.has_key('class'):
        if tag['class'] == 'ID2':
            print tag.string
            break 
```

给出以下输出：

```
文本2
```

# .net - 强烈命名第 3 方程序集 - 无法加载文件或程序集

> ID：13943091
> 
> 赞同：13
> 
> 时间：2012-12-18T23:15:34.043
> 
> 标签：.net, visual-studio-2012, strongname, vsix

我正在编写一个供内部使用的 Visual Studio 2012 扩展，它要求所有程序集都有一个强名称。我依赖于 RestSharp（和其他一些 dll），并且由于它没有强命名，因此我通过遵循[this](http://ryanfarley.com/blog/archive/2010/04/23/sign-a-.net-assembly-with-a-strong-name-without-recompiling.aspx)为其添加了一个强名称。一切都根据过程的输出进行，甚至 Visual Studio 声称如果我查看项目引用中 RestSharp.dll 的属性，它是强命名的。但是，当我使用我的扩展程序时，我得到一个 FileLoadException 声明：

```
无法加载文件或程序集“RestSharp，Version=104.1.0.0，Culture=neutral，PublicKeyToken=null”或其依赖项之一。需要强命名程序集。（来自 HRESULT 的异常：0x80131044）

```

有关如何解决此问题或解决此问题的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-12T21:56:03.313

我编写了一个 NuGet 解决方案级别包，以帮助使用您自己的密钥对第 3 方程序集进行强命名。

> 这旨在对使用未签名程序集的 NuGet 包的内容进行签名，以便能够链接到使用项目被强命名的这些包。不需要访问原始源代码，您可以使用自己的强命名密钥对任何程序集进行签名。如果需要，您也可以延迟签名。
> 
> [https://nuget.org/packages/Nivot.StrongNaming](https://nuget.org/packages/Nivot.StrongNaming)

你可以在我的博客上阅读更多关于它的信息：

[http://www.nivot.org/blog/post/2013/04/30/Signing-unsigned-assemblies-in-NuGet-packages](http://www.nivot.org/blog/post/2013/04/30/Signing-unsigned-assemblies-in-NuGet-packages)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-24T17:58:46.290

I tried to use RestSharp from VSPackage and it works. My steps to add RestSharp:

1.  Add RestSharp by NuGet in a project where I will use it. To do this, right-click on the project in Solution Explorer and selecting the “Manage NuGet Packages…”, find RestSharp and press Install button.

2.  Write test code in this project:

    ```
     var test = new RestSharp.RestClient("http://test.com");
    Logger.Log(Category.Info, "Test {0}", test.BaseUrl); 
    ```

3.  Add RestSharp by NuGet in the installer project. Similarly paragraph 1\. I use the [VSIX Deployment Package](http://msdn.microsoft.com/en-us/library/ff363239.aspx). To set the necessary assembly just need to add a reference to assembly in the VSIX Deployment Package. This makes the “Manage NuGet Packages…” command. When you create a VSPackage by VS Wizard, the main project of VSPackage is VSIX Deployment Package.

    If you use another method of installation your VS extension (for example, MSI installer), you need to explicitly add RestSharp.dll to our installation package.

As a result, I got line *"Test [http://test.com](http://test.com)"* in the log.

Most likely in your case, that RestSharp.dll been not installed and therefore VS is not finding RestSharp.dll when loading your module. Or the fully qualified name of installed RestSharp assembly is different from the fully qualified name assembly in References of project. To see this check out whether RestSharp.dll file in folder of your extension (for VSPackage by default patch is *"%LOCALAPPDATA%\MICROSOFT\VISUALSTUDIO\11.0EXP\EXTENSIONS\{YourCompanyName}\{YourProductName}\{YourProductVersion}\"*). You can see the absolute path to your extension in the *Modules window* if run the extension under the debugger.

**Edit:** I just now noticed that the RestSharp assembly from NuGet has not a strong name. So the directory of installed extension and References of projects should contain the exact same assembly with a strong name, and everything will work fine.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T15:04:56.023

您可以检查几件事：

看来您的项目引用仍然是未签名的 dll .\RestSharp.dll。您应该针对已签名的 .\Signed\RestSharp.dll dll 编译您的项目。删除当前引用并再次添加。

还要检查项目 bin 目录中的 dll。旧的 RestSharp.dll 可能仍然存在。删除它并检查所有构建目录。

您还可以检查restsharp.dll 是否在您的GAC 中。如果是这样，请从您的 gac 中删除 dll。

# php - 在 JQuery 中停止动画延迟

> ID：13943093
> 
> 赞同：3
> 
> 时间：2012-12-18T23:15:57.537
> 
> 标签：php, jquery, jquery-color

我正在使用 PHP 和 JQuery 处理这个 CPU 监视器 - [http://nereus.rikkuness.net/admin/cpu2.php](http://nereus.rikkuness.net/admin/cpu2.php)

它的工作方式完全符合我的意图，可以解决一个小问题。由于使用了轮询当前 CPU 使用率的命令，JQuery 调用值更新和更新实际到达 1 秒有延迟。这样做的连锁反应是，当条形图动画时，它总是落后一秒，因为它第一次尝试调整大小时仍然没有收到新值，因此根据它收到的最后一个值调整自己的大小。

任何人都可以想到任何方式，无论何时实际收到值，只要值更新，我就可以让它动画？

谢谢各位，你们是最棒的！:)

如果不想在直播页面查看源码，代码如下：

```
var auto_refresh = setInterval(
    function(){
        height = 100;
        $("#val1").load("cpu.php");
        cpuUsage = $("#val1").html();
        height = cpuUsage * 10;
        barColor = "";

        if(parseInt(height) < 500){
            barColor = "green";
        }else if(parseInt(height) > 800){
            barColor = "red";
        }else{
            barColor = "#febf01";
        }

        $("#val2").animate({
            width: parseInt(height),
            backgroundColor: barColor
        })
}, 1000); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T23:18:28.830

使用完成功能，[`.load()`](http://api.jquery.com/load/)其中将准确告诉您何时`$("#val1").load("cpu.php");`完成，如下所示：

```
var auto_refresh = setInterval(
    function(){
        $("#val1").load("cpu.php", function() {
            var cpuUsage = $("#val1").html();
            var height = parseInt(cpuUsage * 10, 10);
            var barColor = "";

            if(height < 500){
                barColor = "green";
            }else if(height > 800){
                barColor = "red";
            }else{
                barColor = "#febf01";
            }

            $("#val2").animate({
                width: height,
                backgroundColor: barColor
            })
        });
}, 1000); 
```

仅供参考，我还进行了这些额外的更改：

1.  添加`var`以使您的变量成为局部变量，而不是隐式全局变量。
2.  我考虑了`parseInt()`高度，所以它只在一个地方而不是 4 个地方被调用。
3.  `parseInt()`我添加了应该始终使用的 radix 参数。
4.  删除不需要的高度变量的额外初始化。

* * *

我实际上会建议一个不同的实现，它不会为下一次迭代启动计时器，直到最后一次迭代完成。正如你现在所拥有的，如果你的 cpu.php 调用需要超过 1 秒的时间来响应，你将一次堆积多个调用。相反，您可以在前一个迭代完成时启动下一个迭代的计时器。

```
var usageTimer;
var usageContinue = false;

function stopUsage() {
    clearTimeout(usageTimer);
    usageContinue = false;
}

// getUsage runs continuously until stopUsage is called
function getUsage() {
    var start = new Date().getTime();
    $("#val1").load("cpu.php", function() {
        if (usageContinue) {
            var cpuUsage = $("#val1").html();
            var height = parseInt(cpuUsage * 10, 10);
            var barColor = "";

            if(height < 500){
                barColor = "green";
            }else if(height > 800){
                barColor = "red";
            }else{
                barColor = "#febf01";
            }

            $("#val2").animate({
                width: height,
                backgroundColor: barColor
            })
            // start the next no sooner than 1 second from when the last one was started
            var end = new Date().getTime();
            // if the .load() call already took more than a second, then just start the next one now
            if (end - start > 1000) {
                getUsage();
            } else {
                // otherwise, start the next one 1 second after the previous one was started (to try to get one every second)
                usageTimer = setTimeout(getUsage, end - start);
            }
        }
    });
}
getUsage(); 
```

# yii - 如何在不实例化模型的情况下使用 CActiveRecord 方法将 db 字段更新为自身的函数？

> ID：13943099
> 
> 赞同：2
> 
> 时间：2012-12-18T23:16:18.223
> 
> 标签：yii, query-builder

假设我有一个带有和字段`Product`的表中的模型。我只需要将值更新为. 有没有办法在不创建模型实例的情况下使用 Yii 函数更新它？我试过`id``in_stock``in_stock``(in_stock + added_stock)`

```
Product::model()->updateByPk($id,array('in_stock'=>'in_stock+'.$added_stock)); 
```

但它没有用。欢迎任何解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T10:24:32.790

正如其他人所提到的，我不确定为什么你不能在这里创建一个模型实例并这样做，但是当你问这个问题时，我猜你有一个理由！

在这种情况下，如果您不能创建模型并且想要静态地执行它，您可以使用[CDbExpression](http://www.yiiframework.com/doc/api/1.1/CDbExpression)创建表达式，这样整个表达式就不会被查询构建器转义（这就是会发生的情况在你的例子中）。

像这样的东西会起作用；

```
$added_stock = 1;
$newStock = new CDbExpression('(`in_stock`+:addedStock)',array(
    ':addedStock' => $added_stock)
);
Product::model()->updateByPk($id,array(
    'in_stock' => $newStock
)); 
```

上面的代码将增加`in_stock`任何值`$added_stock`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T01:02:14.487

我猜你打算这`$added_stock`是一个本地 PHP 变量？如果是这样，这可能是最好的方法：

```
Product::model()->updateCounters(
    array('in_stock' => $added_stock), 
    array('condition'=>'id = :id'),
    array(':id' => $id)

); 
```

这应该可以在不查询记录的情况下向字段添加任意数量。它还会事先将`$added_stock`变量转换为整数，因此无需担心 SQL 注入或需要将其放入参数中。

PS 也适用于小数。尽管我不认为我想知道为什么您必须处理小部分库存？:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T05:43:31.003

虽然我不太确定您为什么要避免创建模型实例，但您可以这样做：

```
$sql = "SELECT in_stock FROM Product t WHERE id=:id";
$params = array(':id'=>$id);
$in_stock = Yii::app()->db->createCommand($sql)->queryScalar($params);

Product::model()->updateByPk($id, array(
  'is_stock'=>$added_stock+$in_stock,
); 
```

当然，那样做的工作似乎要多得多。您始终可以将其包装在 Product 模型中您自己的静态方法中并以这种方式调用它。

```
public static function addStock($id,$added_stock){
  (place code from above here)
} 
```

你能详细说明为什么你不想创建模型的实例吗？

# css - @font-face 不能在第一代 iPod Touch 上运行吗？

> ID：13943100
> 
> 赞同：1
> 
> 时间：2012-12-18T23:16:23.120
> 
> 标签：css, mobile, font-face, ipod-touch

我正在尝试让字体系列“Lucia Calligraphy”在第一代 iPod Touch 上工作，但到目前为止还没有工作。而且由于我没有任何其他移动设备，我不能 100% 确定它只是这个设备还是所有不支持它的移动设备。

```
 @font-face { font-family: 'Lucida Calligraphy';
              src: url('Lucida Calligraphy.eot?') format('eot'),
              url('Lucida Calligraphy.woff') format('woff'),
              url('Lucida Calligraphy.ttf') format('truetype');
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:06:27.780

我很确定在 iOS 4.1 之前它只支持`.svg`字体。

[http://caniuse.com/#search=font-face](http://caniuse.com/#search=font-face)

# python - 用户创建模块的 Py2app ImportError

> ID：13943102
> 
> 赞同：1
> 
> 时间：2012-12-18T23:16:35.650
> 
> 标签：python, macos, py2app, setup.py

所以我有一个这样的目录树：

```
/
  setup.py
  src/
    ui.py
    load.py
    search.py
    parser.py
    img.py
    obj.py
    #..etc
  res/
    img.py 
```

Setup.py 看起来像这样：

```
#!/usr/bin/env python

import os
import shutil
import sys
import subprocess
import copy

from distutils.core import setup

if "py2app" in sys.argv:
    ## Move the setup script to the src/ folder, then re-run it
    shutil.copy("setup.py", "src")
    newArgv = copy.copy(sys.argv)
    newArgv[newArgv.index("py2app")] = "rerun"
    os.chdir("src")
    subprocess.call(["python"] + newArgv)
elif "rerun" in sys.argv:
    import py2app
    sys.argv[sys.argv.index("rerun")] = "py2app"

    setup(
        options={
            "py2app": {
                "packages": "wx",
                "site_packages": True
            },
        },
        app=["ui.py"],
        package_dir={"": "."})

    ## Go back up a directory level and copy the build and dist folders up as well
    os.chdir('..')
    for fldr in ["build", "dist"]:
        if os.path.exists(fldr):
            shutil.rmtree(fldr)
        shutil.move(os.path.join("src", fldr), ".")

    ## Copy the necessary data directories to their relevant locations in the app file
    for fldr in ["xml", "templates", "data"]:
        print "Copying %s..." % fldr
        shutil.copytree(fldr, os.path.join("dist/ui.app/Contents/", fldr))
    os.remove(os.path.join("src", sys.argv[0])) 
```

（我做奇怪的 subprocess.call forky 事情的原因是因为需要在树的根目录中有 setup.py，但所有源代码都在 src/ 中）

当我运行时`python setup.py py2app`，它完全完成，但是当我打开 ui.app 时，它给出了以下错误：

```
Traceback (most recent call last):
  File "/Users/smith/Code/digital-directory/dist/ui.app/Contents/Resources/__boot__.py", line 127, in <module>
    _run()
  File "/Users/smith/Code/digital-directory/dist/ui.app/Contents/Resources/__boot__.py", line 122, in _run
    exec(compile(source, path, 'exec'), globals(), globals())
  File "/Users/smith/Code/digital-directory/dist/ui.app/Contents/Resources/ui.py", line 14, in <module>
    import load
ImportError: No module named load 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:19:55.713

不要把你的 src 放在`src`. 使用更标准的 Python 项目布局，不要玩弄“subprocess.call forky 东西”。

例如，遵循[http://kennethreitz.com/repository-structure-and-python.html](http://kennethreitz.com/repository-structure-and-python.html)上的指南。

# delphi - 如何在一个任务组中使用超过 60 个任务？

> ID：13943104
> 
> 赞同：3
> 
> 时间：2012-12-18T23:16:50.877
> 
> 标签：delphi, delphi-xe2, omnithreadlibrary

如何在一个任务组中使用超过 60 个**任务**？我可以从 0 循环到 N 并创建任务，但这不会给我任何消息处理。我使用 OTL EventMontior 从任务发送消息..

我问的原因是因为使用 Indy 我被限制为 60 个请求。但是，如果我使用普通的 TThread，我不会遇到这些问题，但会遇到其他问题等。

> **.NET 线程池最大值：**
> 
> *   Framework 4.0（32 位环境）中的 1023
> *   Framework 4.0（64 位环境）中的 32768

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-24T19:42:11.683

根据`OtlTaskControl.pas`（基于v3.02源），你不能超过64。（不知道你的60是从哪里来的，但我承认没有试图超过它。）

`TOmniTaskGroup.WaitForAll`（大约 #3300 行）使用 WinAPI 函数[`WaitForMultipleObjects`](http://msdn.microsoft.com/en-us/library/ms687025%28v=vs.85%29.aspx)，并根据 MSDN 文档：

> 对象句柄的最大数量是 MAXIMUM_WAIT_OBJECTS。

`MAXIMUM_WAIT_OBJECTS`定义在`Windows.pas`（对于 XE3，大约在第 1017 行：

```
MAXIMUM_WAIT_OBJECTS = 64;
{$EXTERNALSYM MAXIMUM_WAIT_OBJECTS} 
```

声明本身来自`WinNT.h`SDK，其中包含：

```
#define MAXIMUM_WAIT_OBJECTS 64     // Maximum number of wait objects 
```

`WaitForMultipleObjects`如果您将一个高于参数的值传递给它，则返回一个错误`MAXIMUM_WAIT_OBJECTS`代码`nCount`。（如果将任何高于此`64`的值作为参数发送，则会返回错误代码`nCount`，这意味着该值已内置到函数本身的实现中。）

[对其他 API多对象等待函数](http://msdn.microsoft.com/en-us/library/ms687069%28v=vs.85%29.aspx#multiple-objectwaitfunctions)的快速回顾也没有发现任何其他可以接受超过`MAXIMUM_WAIT_OBJECTS`项目的东西。

因此，您的问题的具体答案是：唯一可以做到的方法是编写您自己的 WinAPI 替代品`WaitForMultipleObjects`，然后将`WaitForMultipleObjects`调用替换为`TOmniTaskGroup.WaitForAll`对您的函数的调用。（这是一项非常艰巨的任务，这可能就是为什么它没有在 OTL 中完成的原因，并且期望有人在这里回答是非常不现实的。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T05:11:31.880

根据对[相关问题](https://stackoverflow.com/q/13458029/33732)的回答（关于限制的基本原理），您可以通过更改*Winsock.pas*和*OtlThreadPool.pas*`FD_SETSIZE`中的定义来绕过限制。将它们设置为您喜欢的任何限制。不过，我不能亲自担保这些建议。*`CMaxConcurrentWorkers`*

 **请注意，通过修改*Winsock.pas*，您删除了在应用程序中使用 Delphi 提供的运行时包的能力。（您仍然可以使用自己编译的包；它们只是不能与内置包同名。）**

# php - 为什么我的画廊图片在上传时没有显示在我的页面上？

> ID：13943106
> 
> 赞同：1
> 
> 时间：2012-12-18T23:16:53.747
> 
> 标签：php, codeigniter, gallery, thumbnails

我目前正在尝试将图像上传到页面并将它们保存在 2 个文件夹中。应该发生的是我上传了一张图片，它保存在我的画廊和拇指文件夹中。

然后保存在拇指文件夹中的图像将显示在屏幕上，当单击图像时，它将以适当的大小显示，就像它保存在画廊文件夹中一样。目前，图像已保存到图库数据库和我的图库文件夹，但拇指图像未显示在屏幕上。

我认为是因为它没有保存到拇指文件夹中。为什么没有保存到文件夹中？

控制器：

```
class Gallery extends CI_Controller {

   function __construct() {

      // Call the parent construct
      parent::__construct();
      $this->load->model("profiles");
      $this->load->model("gal_model");
      $this->load->helper(array('form', 'url'));
      $this->gallery_path = 'web-project-jb/assets/gallery/';
      $this->gallery_path_url = base_url().'web-project-jb/assets/gallery/';
   }

   function upload() {
      $config = array(
         'allowed_types' =>'gif|jpg|jpeg|png',
         'upload_path' => $this->gallery_path,
         'max_size' => 10000,
         'max_width' => 1024,
         'max_height' => 768);

      $this->load->library('upload', $config);

      $image_data = $this->upload->data();

      $config = array(
         'source_image' => $image_data["full_path"],
         'new_image' => $this->gallery_path. '/thumbs',
         'maintain_ration' => true,
         'width' => 150,
         'height' => 100
      );

      $this->load->library("image_lib", $config);

      $this->image_lib->resize();

      $username = $this->session->userdata('username');

      if ( ! $this->upload->do_upload()) {

         $error = array('error' => $this->upload->display_errors());
         $username = $this->session->userdata('username');
         $viewData['username'] = $username;

         $this->load->view('shared/header');
         $this->load->view('gallery/galtitle', $viewData);
         $this->load->view('shared/nav');
         $this->load->view('gallery/galview', $error, $viewData, array('error' => ' '));
         $this->load->view('shared/footer');

      } else {

         $file_data  = $this->upload->data();
         $image = $this->gallery_path.$file_data['file_name'];
         $data['image'] = $this->gallery_path.$file_data['file_name'];
         $this->username = $this->session->userdata('username');
         $images = $this->session->userdata('images');
         $data['images'] = $images;
         $this->gal_model->putGalleryImage($username, $image);
         $this->session->set_userdata($image);
         $viewData['username'] = $username;
         $data['gal_model'] = $this->gal_model->get_images($username);
         var_dump($image);

         $username = $this->session->userdata('username');

         $this->load->view('shared/header');
         $this->load->view('gallery/galtitle', $viewData);
         $this->load->view('shared/nav');
         $this->load->view('gallery/galview', $data, $viewData);
         $this->load->view('shared/footer');
      }
   }

   function index() {
      $username = $this->session->userdata('username');
      $images = $this->session->userdata('images');
      $this->load->library('upload');
      $data['gal_model'] = $this->gal_model->get_images($username);
      $file_data = $this->upload->data();
      $file_data['file_name'] = $this->gal_model->get_images($username);
      $image = $this->gallery_path.$file_data['file_name'];
      $data['image'] = $file_data['file_name'];
      $data['images'] = $images;
      $viewData['username'] = $username;

      $this->load->view('shared/header');
      $this->load->view('gallery/galtitle', $viewData);
      $this->load->view('shared/nav');
      $this->load->view('gallery/galview', $viewData, $data, array('error' => ' '));
      $this->load->view('shared/footer');
   }
} 
```

加尔型号：

```
class Gal_model extends CI_Model {
  var $gallery_path;
  var $gallery_path_url;
  function Gal_model() {
    parent::__construct();
    $this->gallery_path = 'web-project-jb/assets/gallery/';
    $this->gallery_path_url = base_url().'web-project-jb/assets/gallery/';
  }
  function exists($username) {
    $this->db->select('*')->from("gallery")->where('user', $username);
    $query = $this->db->get();
    if ($query->num_rows() > 0) {
      return true;
    } else {
      return false;
    }
  }
  function putGalleryImage($username, $image) {
    $record = array('user' => $username, 'galleryimage' => $image);
    $this->session->set_userdata($image);
    if ($this->exists($username)) {
      $this->db->where('user', $username)->insert('gallery', $record);
    }
  }
  function get_images($username) {
    $this->db->select('*')->from('gal_model')->where('user', $username);
    $files = scandir($this->gallery_path);
    $files = array_diff($files, array('.', '..', 'thumbs'));
    $images = array();
    foreach ($files as $file) {
      $images[] = array(
        'url' => $this->gallery_path_url.$file,
        'thumb_url' => $this->gallery_path_url.'thumbs/'.$file
      );
    }
    return $images;
  }
} 
```

画廊视图：

```
<? if (isset($images) && is_array($images)): foreach($images as $image):?>
<a href="<?php echo $image['url']; ?>">
<img src ="<?php echo $image['thumb_url']; ?>"width='150' height='150'/>
<?= endforeach; else:  ?>
<div id = "blank_gallery">Please upload an Image</div>
<? endif; ?> 
```

# jboss7.x - JBoss AS 7 下的 AspectJ Aspect 抛出 Xlint:invalidAbsoluteTypeName

> ID：13943110
> 
> 赞同：5
> 
> 时间：2012-12-18T23:17:29.347
> 
> 标签：jboss7.x, aspectj, spring-aop

我有一组使用 Maven 构建的 AspectJ 1.6.12 和 Spring 3.1.2.RELEASE 在 JBoss 6.1.0.Final 上运行没有问题的 WAR。我们想在不久的将来迁移到 JBoss AS 7，所以我从源代码编译了 JBoss 7.1.3.Final。

在遇到单个 WAR 文件问题后，我决定将应用程序重新打包为 EAR 文件，这样我们的所有代码都将放在一个可再分发、可部署的单元中。

我无法让我们的分析方面正常工作。这是一个非常简单的方面，包含在我们的 EAR/lib 目录中的 JAR 中，它对使用 @Timed 注释注释的任何方法进行计时：

```
package com.mycompany.toplayer.perf;

import org.aspectj.lang.ProceedingJoinPoint;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.annotation.Aspect;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Component;

@Component
@Aspect
public class MethodTimerAdvice {
    private Logger log = LoggerFactory.getLogger(getClass());

    @SuppressWarnings("unchecked")
    @Around(value="execution(@com.mycompany.toplayer.perf.Timed * *(..))")
    public Object timeMethod(ProceedingJoinPoint pjp) throws Throwable
    {
        String methodName = pjp.getSignature().toShortString();
        long start = System.currentTimeMillis();

        Object ret = pjp.proceed();

        long end = System.currentTimeMillis();

        long total = end - start;

        long used_mem = Runtime.getRuntime().totalMemory()
                - Runtime.getRuntime().freeMemory();
        long mem_gb = used_mem / (1024 * 1024);     

        log.trace("{} | {} | {}M | {} | {} | {}", 
                new Object[] {start, total, 
                        mem_gb, 
                        Thread.currentThread().getId(), 
                        Thread.currentThread().getName(),   
                        methodName}
        );

        return ret;
    }
} 
```

请注意，注释在同一个包中。
这是方面的相关 Spring 配置文件，同样非常简单：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xsi:schemaLocation="http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">

    <context:component-scan base-package="com.mycompany" />
    <aop:aspectj-autoproxy></aop:aspectj-autoproxy>

</beans> 
```

EAR 中包含三个 WAR 文件，但现在只有一个使用这个方面，即 gdm-updater.WAR。当我尝试启动服务器时，出现如下错误：

```
Caused by: java.lang.IllegalArgumentException: warning no match for this type name: Timed [Xlint:invalidAbsoluteTypeName]
    at org.aspectj.weaver.tools.PointcutParser.parsePointcutExpression(PointcutParser.java:301) [aspectjtools.jar:]
    at org.springframework.aop.aspectj.AspectJExpressionPointcut.buildPointcutExpression(AspectJExpressionPointcut.java:207) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.aspectj.AspectJExpressionPointcut.getFallbackPointcutExpression(AspectJExpressionPointcut.java:358) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.aspectj.AspectJExpressionPointcut.getShadowMatch(AspectJExpressionPointcut.java:409) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.aspectj.AspectJExpressionPointcut.matches(AspectJExpressionPointcut.java:272) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.support.AopUtils.canApply(AopUtils.java:226) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.support.AopUtils.canApply(AopUtils.java:264) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.support.AopUtils.findAdvisorsThatCanApply(AopUtils.java:296) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findAdvisorsThatCanApply(AbstractAdvisorAutoProxyCreator.java:117) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.findEligibleAdvisors(AbstractAdvisorAutoProxyCreator.java:87) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.framework.autoproxy.AbstractAdvisorAutoProxyCreator.getAdvicesAndAdvisorsForBean(AbstractAdvisorAutoProxyCreator.java:68) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.wrapIfNecessary(AbstractAutoProxyCreator.java:359) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.aop.framework.autoproxy.AbstractAutoProxyCreator.postProcessAfterInitialization(AbstractAutoProxyCreator.java:322) [spring-aop-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsAfterInitialization(AbstractAutowireCapableBeanFactory.java:407) [spring-beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.postProcessObjectFromFactoryBean(AbstractAutowireCapableBeanFactory.java:1598) [spring-beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    at org.springframework.beans.factory.support.FactoryBeanRegistrySupport.doGetObjectFromFactoryBean(FactoryBeanRegistrySupport.java:162) [spring-beans-3.1.2.RELEASE.jar:3.1.2.RELEASE]
    ... 28 more 
```

我还尝试将 AspectJ 作为一个模块包含在内，这里是 EAR 中包含的 jboss-deployment-structure.xml 文件。

```
<jboss-deployment-structure xmlns="urn:jboss:deployment-structure:1.0">
  <deployment>
    <exclusions>
      <module name="org.hibernate" slot="main"/>
    </exclusions>
  </deployment>
  <sub-deployment name="gdm-updater-1.2.0-SNAPSHOT.war"> 
      <exclusions>
          <module name="org.hibernate" slot="main"/>
        </exclusions>
        <dependencies>
          <module name="org.aspectj.tools" slot="main" />
          <module name="org.aspectj.weaver" slot="main" />
        </dependencies>
  </sub-deployment>   
</jboss-deployment-structure> 
```

我什至尝试在 gdm-updater.war 中使用 Maven AspectJ 编译器插件在 gdm-updater.war 的 pom.xml 中进行编译时编织：

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>aspectj-maven-plugin</artifactId>
    <version>1.4</version>
    <configuration>
        <showWeaveInfo>true</showWeaveInfo>
        <source>${compiler.version}</source>
        <target>${compiler.version}</target>
        <Xlint>ignore</Xlint>
        <complianceLevel>${compiler.version}</complianceLevel>
        <encoding>UTF-8</encoding>
        <verbose>false</verbose>
        <aspectLibraries>
            <aspectLibrary>
                <groupId>org.springframework</groupId>
                <artifactId>spring-aspects</artifactId>
            </aspectLibrary>
        </aspectLibraries>
    </configuration>
    <executions>
        <execution>
            <goals>
                <goal>compile</goal>
                <goal>test-compile</goal>
            </goals>
        </execution>
    </executions>
    <dependencies>
        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjrt</artifactId>
            <version>${aspectj.version}</version>
        </dependency>
        <dependency>
            <groupId>org.aspectj</groupId>
            <artifactId>aspectjtools</artifactId>
            <version>${aspectj.version}</version>
        </dependency>
    </dependencies>
</plugin> 
```

我什么都做不了。我在网上搜索了答案并找到了几个链接，但似乎没有一个是相关的：

[有人用 JBoss AS 7.1.1 final 运行 AspectJ 吗？](https://stackoverflow.com/questions/10698631/has-anyone-run-aspectj-with-jboss-as-7-1-1-final)- 不相关，因为我没有使用加载时编织

[https://issues.jboss.org/browse/AS7-3681](https://issues.jboss.org/browse/AS7-3681) - 不相关，因为我没有使用加载时编织或 AspectJ 作为 Java 代理

我考虑过加载时编织，但相关方面将很快扩展到包含“通用”jar 文件的其余部分中存在的一些功能，我无法将其分解为引导类路径。这意味着每次我们有一个新的方面，我们都必须重新配置服务器。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T08:49:04.260

对我来说，在大多数情况下，这“有效”。我有一个[示例](https://github.com/eis/jboss-7.2-osgi-blueprint-gemini-poc/tree/master/spring-mvc-aop-datasource) [项目](https://github.com/eis/jboss-7.2-osgi-blueprint-gemini-poc/tree/master/spring-mvc-aop)，我一直在测试简单的方面，而没有使用 JBoss AS7 进行加载时间编织。

对我不起作用的部分是，如果我指定了这样的对象：

```
<jee:jndi-lookup id="dataSource" jndi-name="jboss/datasources/ExampleDS"/> 
```

这是有问题的，因为 JBoss 内部模块是用 ModuleClassLoader 加载的，它只对该特定模块可见。然而，Aspect-J 试图检查我的方面并失败了，因为那个特定的类加载器没有加载我的方面类。[这和这里解释](http://forum.springsource.org/archive/index.php/t-113581.html)的一样。

解决方法是依赖于 module.xml / jboss-deployment-structure.xml 中的 jdbc 内部：

```
<jboss-deployment-structure xmlns="urn:jboss:deployment-structure:1.0">
<deployment>
  <dependencies>
    <module name="org.jboss.ironjacamar.jdbcadapters"/>
  </dependencies>
</deployment>
</jboss-deployment-structure> 
```

如果您使用调试器，您可以连接异常 java.lang.IllegalArgumentException 并检查它正在使用哪个类加载器以及它试图从调用堆栈加载哪个类。这就是我所做的。

我发现的另一个解决方法是直接在代码中而不是在 Spring 上下文中进行 JNDI 查找。这也有效。

我还在这个问题上打开[了 AS7-6305 / WFLY-826 。](https://issues.jboss.org/browse/WFLY-826)

更新：问题已在 JBoss 方面被拒绝。他们声称这是 AspectJ 的一个问题。我还在[那里打开了一个错误](https://bugs.eclipse.org/bugs/show_bug.cgi?id=397829)，对此没有任何评论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-24T04:08:24.997

我们最近在从 JBoss EAP 6.4.8 升级到 6.4.9 时遇到了类似的问题。

看起来我们的 JNDI DataSources 的 DataSource 实现已从 更改`org.jboss.jca.adapters.jdbc.WrapperDataSource`为`org.jboss.as.connector.subsystems.datasources.WildFlyDataSource`.

我们将以下部署依赖项添加到我们的应用程序`jboss-deployment-structure.xml`文件中，这为我们解决了问题。

```
<module name="org.jboss.as.connector" slot="main"/> 
```

该模块包含`WildFlyDataSource`实现。像这个线程中的其他人一样，我们之前已经有了`org.jboss.ironjacamar.jdbcadapters`依赖。看起来`org.jboss.as.connector`模块可以替换它。

正如[@eis 的回答](https://stackoverflow.com/a/14253890/304617)中所讨论的，该问题与 JNDI 数据源、AspectJ、Spring 和类加载有关。我能够捕捉到这一点的唯一方法是在本地运行 JBoss 并在 IllegalArgumentException 上放置一个断点。

另一种解决方法是`proxy-interface`在您的 Spring 配置中使用代理您的数据源 - 例如

```
<jee:jndi-lookup id="dataSource" jndi-name="some_jndi_name" proxy-interface="javax.sql.DataSource" /> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-31T23:17:53.313

我在这里找到了至少部分解决方案......

[http://pushpendrasinghbaghel.blogspot.com/2013/01/spring-aop-and-jbossas-7.html](http://pushpendrasinghbaghel.blogspot.com/2013/01/spring-aop-and-jbossas-7.html)

问题似乎随时发生，需要由加载核心 JBoss 模块的类加载器加载某些内容......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T15:10:37.110

我有同样的问题。我已经通过将 spring-aop 库的版本降级到 3.0.7.RELEASE 来解决它。当然这只是临时解决方案，我正在等待这个问题的真正原因。

# c++ - 在 std::map 中插入元素时，仅在释放模式下访问冲突读取位置“地址”

> ID：13943111
> 
> 赞同：0
> 
> 时间：2012-12-18T23:17:29.397
> 
> 标签：c++, access-violation

我有一个奇怪的访问位置错误，只有当我在 IDE 之外运行程序时才会发生（我使用 Code::Block 和 GNU GCC 编译器和 GBD 作为调试器）。

```
Unhandled exception at 0x77cd82ea in SFinGe.exe: 0xC0000005: Access violation reading location 0x69687065. 
```

当我尝试将元素添加到 std::map 时会发生这种情况。我知道当你有一个统一的变量时，这通常会发生，但我一直在仔细检查我的代码，我找不到问题并且它让我发疯。

这是类定义：

```
//==============================================================================
// CDirectionalMapGenerator prototypes.
//==============================================================================

#ifndef CDIRECTIONALMAPGENERATOR_H
#define CDIRECTIONALMAPGENERATOR_H

//==============================================================================

#include <complex.h>
#include <math.h>
#include <map>
#include <vector>
#include <CRandom.h>
#include <SFingerprintPattern.h>
#include <ESingularityType.h>

//==============================================================================

#define PI 3.14159265359

//==============================================================================

/** \brief
  * Generates a directional map using the orientation model proposed by Sherlock and Monro, this allows a consistent orientation image to be computed from
  * the knowledge of the position of the fingerprint singularities (core and deltas) alone. The image is located in the complex plane and the local ridge
  * orientation is the phase of the square root of a complex rational function whose singularities (poles and zeros) are located at the same place
  * as the fingerprint singularities.
 */
class CDirectionalMapGenerator
{
  public:

    /** \brief
     * Initializes a new instance of the CDirectionalMapGenerator class.
     *
     */
    CDirectionalMapGenerator();

    /** \brief
     * Destroy the CDirectionalMapGenerator object and all its reference safely.
     */
    virtual ~CDirectionalMapGenerator();

    /** \brief
     * Generates a directional map.
     * \param pattern CFingerprintPattern The fingerprint class and singularity types information.
     * \param witdh int The witdh of the map.
     * \param height int The height of the map.
     * \return std::vector<std::vector<double>> The directional map.
     */
    std::vector<std::vector<double> > generate(SFingerprintPattern& pattern, int width, int height);

  private:

    /** \brief
     * Gets the segment orientation.
     * \param z complex The complex number representing a point in the directional map.
     * \return double The segment orientation in radians.
     */
    double getSegmentOrientation(std::complex<double> z);

    /** \brief
     * Vizcaya and Gerhardt correction.
     * \param alpha double The angle to be corrected.
     * \param singularityType ESingularityType The singularity type.
     * \return double The angle corrected.
     */
    double correctOrientation(double alpha, ESingularityType singularityType);

    /** \brief
     * Gets the amount of angle correction for the given point. The directional map is uniformly divided between -PI and PI
     * in eight segments (45 degrees each segment), points in each region must be adjusted using a different piecewise linear function.
     * The variables 'v' and 'u' are angles defined at the beginning of the generation process, this angles are chosen depending on the
     * singularity type and fingerprint class.
     * \param q int Region of the point.
     * \param singularityType ESingularityType The singularity type.
     * \return double The amount of correction.
     */
    double getAmountOfCorrection(int q, ESingularityType singularityType);

    /** \brief
     *  Modification angles must be defined on the basis of position and number of singularities.
     * \return void
     *
     */
    void generateWeigths();

  private:
      static CRandom*                    m_sRandom;

      std::map<ESingularityType, double> m_v;
      std::map<ESingularityType, double> m_u;
      EFingerprintClass                  m_currentFingerprintClass;
      SFingerprintPattern                m_currentPattern;
      double                             m_nArchTypeFactors[3];
      int                                m_nCurrentWidth;
      int                                m_nCurrentHeight;
};

#endif // CDIRECTIONALMAPGENERATOR_H 
```

和实施：

```
#include "CDirectionalMapGenerator.h"
//==============================================================================

// Static variable initialization.
CRandom* CDirectionalMapGenerator::m_sRandom = new CRandom(time(0));

//==============================================================================
CDirectionalMapGenerator::CDirectionalMapGenerator()
{
    m_currentFingerprintClass = ARCH;
    m_nCurrentWidth           = 0;
    m_nCurrentHeight          = 0;
    m_v                       = std::map<ESingularityType, double>();
    m_u                       = std::map<ESingularityType, double>();
}

//==============================================================================
CDirectionalMapGenerator::~CDirectionalMapGenerator()
{
    delete m_sRandom;

    m_u.clear();
    m_v.clear();
}

//==============================================================================
std::vector<std::vector<double> > CDirectionalMapGenerator::generate(SFingerprintPattern& pattern, int width, int height)
{
    std::vector<std::vector<double> > directionalMap;

    m_currentFingerprintClass = pattern.FingerprintClass;
    m_currentPattern          = pattern;
    m_nCurrentWidth           = width;
    m_nCurrentHeight          = height;

    // Clear weights from last generation.
    m_u.clear();
    m_v.clear();

    this->generateWeigths();

    for (int i = 0; i < m_nCurrentWidth; ++i)
    {
      std::vector<double> vLine;
      for (int j = 0; j < m_nCurrentHeight; ++j)
      {
        std::complex<double> z(i, j);

        vLine.push_back(this->getSegmentOrientation(z));
      }

      directionalMap.push_back(vLine);
    }

    return directionalMap;
}

//==============================================================================
double CDirectionalMapGenerator::getSegmentOrientation(std::complex<double> z)
{
      double segmentOrientation = 0;
      int    degrees            = 0;

      if (m_currentFingerprintClass == ARCH)
      {
        // Arch patterns that do not contain any singularity are not supported by the model, a sinusoidal function
        // must be use instead (The frequency and amplitude are tuned to control the arch curvature and aspect).
        segmentOrientation = atan(std::max(0.0, (m_nArchTypeFactors[2] - m_nArchTypeFactors[2] * z.imag() / (m_nCurrentHeight * m_nArchTypeFactors[1]))) * cos(z.real() * PI / (m_nCurrentWidth * m_nArchTypeFactors[0])));
      }
      else if (m_currentFingerprintClass == WHORL)
      {
        // Whorl have two cores and two deltas.

        // 1/2(g(arg(z - d1)) - g(arg(z - l1))) + 1/2(g(arg(z - d2)) - g(arg (z - l2)))
        segmentOrientation = (0.5 * (this->correctOrientation(arg((z - m_currentPattern.DeltaOne)), DELTA) - this->correctOrientation(arg((z - m_currentPattern.LoopOne)), CORE))) +
                             (0.5 * (this->correctOrientation(arg((z - m_currentPattern.DeltaTwo)), SECONDARY_DELTA) - this->correctOrientation(arg((z - m_currentPattern.LoopTwo)), SECONDARY_CORE)));
      }
      else
      {
        // 1/2(g(arg(z - d)) - g(arg (z - l)))
        segmentOrientation = 0.5 * (this->correctOrientation(arg((z - m_currentPattern.DeltaOne)), DELTA) - this->correctOrientation(arg((z - m_currentPattern.LoopOne)), CORE));
      }

      degrees = static_cast<int>(segmentOrientation * (180 / PI)); // From radiants to degrees.

      if(degrees < 0)
        degrees = -(((-1) * degrees) % (180)) + 180;

      segmentOrientation = degrees * (PI / 180); // From degrees to radiants.

      return segmentOrientation;
}

//==============================================================================
double CDirectionalMapGenerator::correctOrientation(double alpha, ESingularityType singularityType)
{
      int    q             = static_cast<int>(floor(4 * (PI + alpha) / PI));
      double alphaI        = -PI + (PI * q) / 4;
      double correctionOne = this->getAmountOfCorrection(q + 1, singularityType); //gk(alpha i)
      double correctionTwo = this->getAmountOfCorrection(q + 2, singularityType); //gk(alpha i + 1)

      return (correctionOne + ((4 * (alpha - alphaI)) / PI) * (correctionTwo - correctionOne));
}

//==============================================================================
double CDirectionalMapGenerator::getAmountOfCorrection(int q, ESingularityType singularityType)
{
      double amountOfCorrection = 0;
      switch (q)
      {
        case 1:
          amountOfCorrection = -PI + m_u[singularityType];
          break;
        case 2:
          amountOfCorrection = -3 * PI / 4 + m_u[singularityType];
          break;
        case 3:
          amountOfCorrection = -PI / 2;
          break;
        case 4:
          amountOfCorrection = -PI / 4 + m_v[singularityType];
          break;
        case 5:
          amountOfCorrection = m_v[singularityType];
          break;
        case 6:
          amountOfCorrection = PI / 4 + m_v[singularityType];
          break;
        case 7:
          amountOfCorrection = PI / 2;
          break;
        case 8:
          amountOfCorrection = 3 * PI / 4 + m_u[singularityType];
          break;
        default:
          amountOfCorrection = PI + m_u[singularityType];
          break;
      }

      return amountOfCorrection;
}

//==============================================================================
void CDirectionalMapGenerator::generateWeigths()
{
      switch (m_currentFingerprintClass)
      {
        case(ARCH):

          m_nArchTypeFactors[0] = (0.8 + 0.4 * m_sRandom->nextDouble());
          m_nArchTypeFactors[1] = (0.6 + 0.8 * m_sRandom->nextDouble());
          m_nArchTypeFactors[2] = (1.2 + m_sRandom->nextDouble() * 1.5);

        break;
      case (LEFT_LOOP):

          m_u[CORE] = -120 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);
          m_v[CORE] = 50 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);

        break;
      case (RIGHT_LOOP):

          m_u[CORE] = -90 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);
          m_v[CORE] = 60 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);

        break;
      case (TENTED_ARCH):

          m_u[CORE] = -90 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);
          m_v[CORE] = 45 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);

        break;
      case (WHORL):

          // Whorl have two cores and two deltas.
          m_u[CORE] = -60 * PI / 180.0 + m_sRandom->nextDouble() * (15 * PI / 180.0);
          m_v[CORE] = 40 * PI / 180.0 + m_sRandom->nextDouble() * (15 * PI / 180.0);
          m_u[SECONDARY_CORE] = 10 * PI / 180.0 + m_sRandom->nextDouble() * (15 * PI / 180.0);
          m_v[SECONDARY_CORE] = 20 * PI / 180.0 + m_sRandom->nextDouble() * (15 * PI / 180.0);

        break;
      }
          m_u[DELTA] = 0;
          m_v[DELTA] = 0;
          m_u[SECONDARY_DELTA] = 0;
          m_v[SECONDARY_DELTA] = 0;
} 
```

这是破坏的方法：

```
void CDirectionalMapGenerator::generateWeigths()
{
      switch (m_currentFingerprintClass)
      {
        case(ARCH):

          m_nArchTypeFactors[0] = (0.8 + 0.4 * m_sRandom->nextDouble());
          m_nArchTypeFactors[1] = (0.6 + 0.8 * m_sRandom->nextDouble());
          m_nArchTypeFactors[2] = (1.2 + m_sRandom->nextDouble() * 1.5);

        break;
      case (LEFT_LOOP):

          m_u[CORE] = -120 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);
          m_v[CORE] = 50 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);

        break;
      case (RIGHT_LOOP):

          m_u[CORE] = -90 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);
          m_v[CORE] = 60 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);

        break;
      case (TENTED_ARCH):

          m_u[CORE] = -90 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);
          m_v[CORE] = 45 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0);

        break;
      case (WHORL):

          // Whorl have two cores and two deltas.
          m_u[CORE] = -60 * PI / 180.0 + m_sRandom->nextDouble() * (15 * PI / 180.0);
          m_v[CORE] = 40 * PI / 180.0 + m_sRandom->nextDouble() * (15 * PI / 180.0);
          m_u[SECONDARY_CORE] = 10 * PI / 180.0 + m_sRandom->nextDouble() * (15 * PI / 180.0);
          m_v[SECONDARY_CORE] = 20 * PI / 180.0 + m_sRandom->nextDouble() * (15 * PI / 180.0);

        break;
      }
          m_u[DELTA] = 0;
          m_v[DELTA] = 0;
          m_u[SECONDARY_DELTA] = 0;
          m_v[SECONDARY_DELTA] = 0;
} 
```

每当我尝试为地图分配一个值时，它都会爆炸：

```
m_u[CORE] = -90 * PI / 180.0 + m_sRandom->nextDouble() * (45 * PI / 180.0); 
```

我不确定什么是磨损，我在构造函数中初始化了所有需要它的成员，所有其他成员都作为参数传递给“生成”方法。

我能错过什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T23:20:44.817

您`CDirectionalMapGenerator`在程序中使用两个 s 吗？您的静态变量`m_sRandom`仅`new`在程序开始时被 ed 一次，但在 a被销毁`delete`时是 d 。`CDirectionalMapGenerator`如果您在第一个被销毁后创建第二个`CDirectionalMapGenerator`，则每当它访问时，`m_sRandom`您将取消引用无效指针。

要么确保在程序结束之前不要`delete`使用`m_sRandom`指针，要么使其成为非静态的，以便每个实例`CDirectionalMapGenerator`都有自己的副本。

# attr - attr() 不适用于移动 Safari

> ID：13943112
> 
> 赞同：0
> 
> 时间：2012-12-18T23:17:38.987
> 
> 标签：attr

对 jquery 来说非常新……我试图弄清楚为什么在移动 safari 上我的 attr() 不起作用：

```
$(document).ready(function(e) {

var i= 0;
var winHeight= $(window).resize().height();

var iDivs= ['bgImage5','bgImage4','bgImage3','bgImage2','bgImage1'];
var currentPhoto= iDivs[i];

    $('div.bgImage').attr({id:currentPhoto})
    $('#bioBody').hide();
    $('#bio').click(function(){
    $('#bioBody').slideToggle('slow')
    });
<div id="imgContainer">
    <div></div>
    <div class="bgImage"></div>
    <div></div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:29:50.680

我相信应该是`$('.bgImage').attr('id', 'currentPhoto');`

# javascript - 当我更改 css 剪辑时图像消失：rect 属性

> ID：13943115
> 
> 赞同：0
> 
> 时间：2012-12-18T23:18:07.100
> 
> 标签：javascript, jquery, css

我正在使用 clip:rect 将图像剪辑成缩略图，并且我想随机放置剪辑矩形在翻转时的位置。我的代码：

```
 $('.itembox').mouseover(function() {
    var img = $(this).find('img');
    var width = img[0].width;
    var height = img[0].height;
    var clipwidth = Math.floor( $(this).width() );
    var clipheight = Math.floor( $(this).height() );

    var widthrange = width - clipwidth;
    var heightrange = height - clipheight;

    var x = Math.floor(Math.random() * widthrange);
    var y = Math.floor(Math.random() * heightrange);
    var x2 = x + clipwidth;
    var y2 = y + clipheight;

    img.css('clip', 'rect('+x+'px '+x2+'px '+y+'px '+y2+'px)');
    $(this).children('.itemboxbg').show();
    $(this).css({'color' : 'white'});

}); 
```

它适用于预设的 css：

```
.itemboxbg {
    border: none;
    position:absolute;
    width:193px;
    height:273px;
    z-index:0;
}
.itemboxbg img {
    border: none; 
    position: absolute; 
    clip: rect(0px 193px 273px 0px); 
} 
```

但是当翻转事件触发并更改 css 时，图像就会消失。CSS很好，例如：

```
<img src="./img/exampleimage.png" style="clip: rect(304px 498px 72px 344px);"> 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T02:00:21.643

愚蠢的，它应该是：

```
img.css('clip', 'rect('+y+'px '+x2+'px '+y2+'px '+x+'px)'); 
```

由于 clip: rect 已定义

```
rect(<top> <right> <bottom> <left>); 
```

其中`<top>`和`<bottom>`指定从框的上边框边缘的偏移量，以及`<right>`和`<left>`指定从框的左边框边缘的偏移量。

虽然还不是解决方案，因为图像没有出现在框中，也许我应该使用背景位置

编辑：确定更改绝对左侧和顶部位置将图像移回框中：

```
img.css('left', -x+'px');
img.css('top', -y+'px'); 
```

# c# - 随机更改按钮名称

> ID：13943118
> 
> 赞同：1
> 
> 时间：2012-12-18T23:18:35.617
> 
> 标签：c#, button

我有 4 个按钮`btn1` `btn2` `btn3` `btn4`

```
q1 = from tAns in db.Questions where tAns.idQuestion == x select tAns;
q2 = from fAns1 in db.Questions where fAns1.idQuestion == x select fAns1;
q3 = from fAns2 in db.Questions where fAns2.idQuestion == x select fAns2;
q4 = from fAns3 in db.Questions where fAns3.idQuestion == x select fAns3; 
```

我需要一种随机更改按钮文本的方法...可能的输出：

第一次

```
btn1.Text = q2.ToString();
btn2.Text = q4.ToString();
btn3.Text = q3.ToString();
btn4.Text = q1.ToString(); 
```

第二次

```
btn1.Text = q1.ToString();
btn2.Text = q3.ToString();
btn3.Text = q2.ToString();
btn4.Text = q4.ToString(); 
```

ETC...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:29:42.587

我猜您正在创建某种测验应用程序，因此您只需要能够选择一次随机答案。无需从数组中选择字符串，只需将所有字符串放入数组中并打乱数组即可。一种快速而简单的洗牌阵列的方法是使用[Fisher-Yates Shuffle](http://www.dotnetperls.com/fisher-yates-shuffle)。

然后循环遍历按钮`for`并将值分配给您的按钮。（您需要添加错误检查）。

```
for(int i = 0; i < myShuffledArray.Count(); i++)
     myButtonsCollection[i].Text = myShuffledArray[i]; 
```

# java - 如何避免在地图中转换包装对象？

> ID：13943120
> 
> 赞同：0
> 
> 时间：2012-12-18T23:18:38.723
> 
> 标签：java, interface, casting

我有一个接口 FeatureValue，它实现了一个叫做漂亮打印的函数。

我现在有两个实现该接口的类：FeatureString 和 FeatureList（FeatureList 中的列表包含字符串）。这些类只是包装器，分别存储一个字符串和一个列表，并为其包装的值实现漂亮的打印功能。

我有 EnumMap ，它将一些 Feature 类型的枚举作为键（一些对应于字符串，一些对应于列表）。

我最初制作了这个界面，以便我可以迭代枚举并漂亮地打印它们。但现在我也希望能够从包装器 FeatureValue 中获取值。

由于我将枚举映射存储为`<Feature, FeatureValue>`，因此它不知道包装的值是什么类型，所以我必须在得到它时进行转换。

有没有办法重构我的代码，这样我就不需要强制转换，但仍然保留在不知道类型的情况下迭代枚举并打印它们的能力？

枚举

```
public enum Features
{
KIND("kind"),
RULE("rule"),
PROBLEM("problem"),

private String name;

Features(String name)
{
    this.name = name;
}

public String getName()
{
    return name;
}
} 
```

界面

```
public interface FeatureValue
{
    public String prettyPrint();
} 
```

列表实现（FeatureString 有一个类似的实现，我将省略）

```
public class FeatureList implements FeatureValue
{
private final List<String> list;

public FeatureList(List<String> list)
{
    this.list = list;
}

@Override
public String prettyPrint()
{
    return Arrays.toString(list.toArray());
}

public List<String> getList()
{
    return list;
}
} 
```

铸造代码

```
for(String token: ((FeatureList) enumMap.get(Feature.particularFeatureThatCorrespondsToLists)).getValue())
    doSomething(token); 
```

由于地图是针对 Feature 的值而不是 FeatureList 参数化的，因此需要进行强制转换

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:05:06.263

做你的

```
public interface FeatureValue
{
    public String prettyPrint();
} 
```

可迭代的，像这样

```
public interface FeatureValue extends Iterable<String>
{
    public String prettyPrint();
} 
```

这将使`FeatureValue`foreach 循环可以迭代任何内容。

对于实际上不需要迭代的类，要么抛出异常

```
public class Stubbed1 extends FeatureValue {
    public Iterator<String> getIterator() {
        throw new UnsupportedOperationException();
    }
} 
```

或返回一个空的迭代器

```
public class Stubbed2 extends FeatureValue {
    public Iterator<String> getIterator() {
        return Collections.<String>emptyList().iterator();
    }
} 
```

对于需要迭代的类，请执行以下操作

```
public class DocumentFeatureList implements FeatureValue
{
   private final List<String> list;

   ...

   public Iterator<String> getIterator() {
       return list.iterator();
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:57:09.457

将方法添加`getValue()`到您的界面`FeatureValue`并使界面参数化。

*特征值.java*

```
public interface FeatureValue<E> {

    String prettyPrint();    

    E getValue();

} 
```

*FeatureList.java*

```
public class FeatureList implements FeatureValue<List<String>> {    

    private final List<String> list = new ArrayList<String>();

    public String prettyPrint() {
        return list.toString();
    }

    public List<String> getValue() {
        return list;
    }

} 
```

*主.java*

```
public static void main( String[] args ) {
    for (String each: getAsList(enumMap, Features.KIND)) {
        // do stuff
    }
}

private static List<String> getAsList(
        EnumMap<Features, FeatureValue> enumMap, Features key) {
    FeatureValue value = enumMap.get(key);
    return value != null ? 
       ((FeatureList) value.getValue()).getValue() : Collections.EMPTY_LIST;
} 
```

# jquery - 从不同元素读取值

> ID：13943121
> 
> 赞同：0
> 
> 时间：2012-12-18T23:19:05.227
> 
> 标签：jquery

我需要想出一种方法来检查带有隐藏元素的特定值，如果找到，则显示特定消息。我认为它可以用 jQuery 来完成，但我正在努力寻找一种方法来做到这一点......

这是我的代码的简化版本。我需要在带有类的 TD 中添加一条消息 `outputHere`

该消息是有条件的，基于我是否会找到`sku`具有跨度的类，它在嵌套表中，在`TR`隐藏的...

如果找到 SKU 值，则输出它，如果没有，则查找 ITEMID，如果均未找到，则输入默认消息...

```
<table>
<tr>
  <td>
   <div class="outputHere">val</div>
  </td>
</tr>
<tr>
  <td>
    <div>
    <table class="nested">
    <tr>
       <td>
        <span class="sku">SKU number</span>
       </td>
    </tr>
    </table> 
<tr>
  <td>
    </div>

  </td>
</tr>
</table> 
```

有点不知所措......认为它应该是这样的：

```
$('.outputHere').each(function() {
 var $message =
 $(this).parents('table').closest('tr').find('span.sku');

if ($message) {
   $(this).text($message); } else {
    $(this).text('Default message'); 
}    
}); 
```

* * *

更新

如果我的 SKU 单元格没有 class="sku" 而是 SKU 编号，我将如何找到 SKU 值？

```
<table>
<tr>
  <td>
   <div class="outputHere">val</div>
  </td>
</tr>
<tr>
  <td>
    <div>
    <table class="nested">
    <tr>
       <td>
        <span class="label">SKU:</span>
       </td>
       <td>sku_value</td>
    </tr>
    </table> 
<tr>
  <td>
    </div>

  </td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:27:21.007

```
$('.outputHere').each(function() {
   var $this = $(this);
   var $span = $this.closest('tr').next('tr').find('span.sku');

   if($span.html().length) {
      $this.text($span.html()); 
   } else {
      $this.text('Span Not found !!'); 
   }    
}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/GyLjf/)**

**更新的小提琴**

如果是这种情况，我会使用 :contains 选择器

```
$('.outputHere').each(function() {
   var $this = $(this);
    var $span = $this.closest('tr').next('tr').find('.label:contains(SKU)');

   if($span.html().length) {
       var num = $span.html().split(':')[1];
      $this.addClass('changed').text(num); 
   } else {
      $this.text('SKU Not found !!'); 
   }    
});​ 
```

**[更新的小提琴](http://jsfiddle.net/sushanth009/GyLjf/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:24:05.040

如果 html 结构（*虽然看起来有点过分*）就像问题然后使用

```
$('.outputHere').each(function() {
   var $message = $(this).closest('table').find('span.sku');

   if ($message.length) {
      $(this).text($message.text()); 
   } else {
      $(this).text('Default message'); 
   }    
}); 
```

演示在[http://jsfiddle.net/gaby/kjcXH/](http://jsfiddle.net/gaby/kjcXH/)

# k-means - 对具有固定和连续分量的稀疏向量进行聚类

> ID：13943133
> 
> 赞同：0
> 
> 时间：2012-12-18T23:20:34.973
> 
> 标签：k-means, sparse-matrix

请就以下聚类问题的编码数据提出建议。我有一个包含汽车使用信息的数据集。数据集有以下字段： 1\. 车型（Toyoya Celica、BMW、Nissan X-Trail、Mazda Cosmo 等） 2\. 建造年份 3\. 汽车行驶的国家 4\. 大修前的汽车行驶距离

重要提示：上述数据集是稀疏的。在大多数情况下，并非所有国家/地区都知道给定汽车的“距离”。

问题：对于给定的汽车，预测它在“距离”未知的国家进行大修之前将运行的“距离”。

我的方法：我想将数据集中的每条记录表示为具有以下组件的稀疏向量： 1\. 二进制 (1/0) 汽车模型组件。这些组件的数量等于数据集中所有可能模型的数量。2.汽车运行的二进制（1/0）国家。这些组件的数量等于数据集中所有可能国家的数量。3\. 距离。单个整数分量，等于汽车行驶的距离。

接下来我想对这些向量进行聚类（k-means）并分析结果组。

问题： 1）在我的向量中，我混合了不同性质的组件 - 二进制（模型，国家）和连续（距离）。如何计算向量之间的组件距离？余弦相似度？2）用有限的值集（模型，国家）对组件进行编码以与连续组件（例如距离）一起工作的其他方法？

谢谢！安东

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T09:31:16.990

1）根据我的经验，规范只是对（整个数据集的）特征进行加权，使其范围相似。我不认为余弦相似性也能很好地工作 - 考虑两辆车的距离分别为 1 公里和 2 公里/英里。它们的距离和它们之间的距离差异可以忽略不计，但对于余弦相似度（如果我理解正确的话）来说意义重大。

2）由于一辆车只能有 1 个型号和 1 个国家（我假设），每个只能用一个整数表示（0 = Toyota Celica，1 = BMW，2 = Nissan X-Trail，3 = Mazda Cosmo 等。 ）。

我假设您对不同模型或国家之间的关系一无所知，因此仅将距离定义为相等（如果相等，则为 0，如果不相等，则为 0，适当加权）将是您能做的最好的事情。如果一辆车可以有多个型号或国家，我建议汉明距离。

我希望你在描述你的方法时不小心跳过了建造年份，这是重要的数字数据。

话虽如此，除非您添加一些额外的功能（包含一些连续（数字）数据），例如品牌（丰田、日产、马自达等）、重量、国家平均温度，否则我认为聚类不会很好地工作，国家平均雨量或雪量，路况的数字表示等）如果可能的话。据我所知，聚类不适用于非数字数据（例如品牌/型号），但是，如果加权正确（或者如果您可以定义不同品牌/型号之间的数学关系），我想它能行得通。

只是一个想法，但是用经度和纬度来定义国家怎么样？然后你可以计算国家之间的距离。否则，如果可能，我可能会建议将其替换为有关该国家/地区的数字特征。

旁注 - 在聚类中使用二进制字段的问题（至于品牌/型号的相等性）是您必须自己选择权重。这意味着您将领导集群，这可能会搞砸，或者充其量，使其符合您对数据的先入为主的概念。这就是数字数据更好的原因。

# android - Android adjustResize - 如何禁用淡入淡出效果

> ID：13943137
> 
> 赞同：6
> 
> 时间：2012-12-18T23:20:52.467
> 
> 标签：android, cordova, webview, android-webview

在 WebView 活动上使用**android:windowSoftInputMode="adjustResize"**时，其内容将自行调整大小以在用户选择文本输入时启用滚动。

但是，每次调整内容大小时，都会出现淡入效果。

如何禁用该效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-11T16:10:29.740

```
android:windowSoftInputMode="adjustPan" 
```

也许它对你有帮助。

# jquery - Breeze 不扩展导航属性

> ID：13943138
> 
> 赞同：1
> 
> 时间：2012-12-18T23:20:55.753
> 
> 标签：jquery, knockout.js, asp.net-web-api, entity-framework-5, breeze

我的单页应用程序中有一个 Breeze 数据服务（又名 datacontext）。我想从 WebAPI 控制器获取运行列表以及每次运行的 OutlineItems 列表。

控制器使用 BreezeController 上的此方法返回带有子 OutlineItems 的打开运行列表。

```
[AcceptVerbs("GET")]
public IQueryable<Run> Runs()
{
return _contextProvider.Context.Runs
    .Include("RunOutlineItems")
    .AsQueryable()
    .Where(r => r.RunStatusId < 4);    // 4 is the cutoff for open items             

} 
```

这是数据模型。

```
namespace PilotPlantBreeze
{
    public class Run
    {
        public int Id { get; set; }
        public string Name { get; set; }
        public string Rundate { get; set; }
        public DateTime? RunStart { get; set; }
        public int MachineId { get; set; }
        public int ProductId { get; set; }
        public int RunStatusId { get; set; }
        public string Comments { get; set; }

        // Nav props
        public IList<OutlineItem> RunOutlineItems { get; set; }
    }
} 
```

当我查看来自 WebAPI 请求的响应数据时，RunOutlineItems 列表位于 JSON 中。这里以一项为例：

```
{
    "$id":"27",
    "$type":"PilotPlantBreeze.OutlineItem,PilotPlantBreeze.Model",
    "Id":22,
    "RunId":5,
    "TankId":4,
    "OutlineTopicId":1,
    "OutlineDescriptionId":9,
    "PersonId":1,
    "Value":"23"
} 
```

这是我从 WebAPI 获取数据的客户端 JavaScript 代码。为清楚起见，省略了错误检查和本地缓存检查。

```
var getRuns = function () {
    // The EntityQuery is defined at the beginning of the dataservice
    //  Here I am asking for a query on the server.  Note the .expand 
    //  which is supposed to avoid lazy loading.  Lazy loading is turned off 
    //  on the WebAPI already.
    var query = EntityQuery
    .from("Runs")
    .expand("RunOutlineItems")
    .orderBy("rundate");

    // The manager is defined at the beginning of the dataservice
    //  Here I am asking the manager to execute the query with a promise
    return manager.executeQuery(query)
    .then(runsQuerySucceeded)
    .fail(runsQueryFailed);

    // The promise does not fail, but I would put an error in here if it ever does
    function runsQueryFailed(data) {
    }
    // When the promise succeeds, the data parameter is the JSON from the WebAPI
    function runsQuerySucceeded(data) {
        //
        // When I stop the debugger here data.results holds the entities, but
        //  the child entities for the RunOutlineItems is an observableArray with 
        //  nothing in it.
        //
        app.vm.runs.runs(data.results);
    }
}; 
```

所以我的问题是如何将子项放入我的视图模型中。我有一个解决方法，它在服务器上对 WebAPI 的单独调用中获取子项，并使用自定义 ko.bindHandler 处理它们，但是让导航技术工作会很方便。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:12:08.590

您不应该同时需要“包含”（服务器端）和扩展（客户端）；任何一个都应该做到这一点。

因此，我将不理会您的客户端查询，并将服务器端查询修改为：

```
[AcceptVerbs("GET")]
public IQueryable<Run> Runs() {
    return _contextProvider.Context.Runs
      .Where(r => r.RunStatusId < 4);    // 4 is the cutoff for open items             

} 
```

请注意， AsQueryable() 也消失了。

如果这不起作用，请回帖。

# sql-server - 如何在不使用批量插入的情况下从 csv/txt 插入表？

> ID：13943141
> 
> 赞同：0
> 
> 时间：2012-12-18T23:21:12.200
> 
> 标签：sql-server, excel, sql-server-2012

除了批量插入之外，还有其他方法可以从 csv/文本文件中插入表格吗？通过使用查询而不是通过向导导入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T11:45:15.243

我在将 CSV 数据导入 SQL 数据库时使用的另一种方法是通过链接服务器，如果您将 Microsoft Access Database Engine 2010 Redistributable 安装到 SQL 服务器上（确保为您的服务器使用正确的 x86/x64 版本）建筑学）：

[Microsoft Access 2010 数据库引擎可再发行组件](http://www.microsoft.com/en-us/download/details.aspx?id=13255)

然后你可以像这样定义一个链接服务器：

```
EXEC master.dbo.sp_addlinkedserver @server = N'CSVLinkedServer', @srvproduct=N'OLEDB Provider for ACE', @provider=N'Microsoft.ACE.OLEDB.12.0', @datasrc=N'S:\csv_location\', @provstr=N'Text', @catalog=N'*.csv'

EXEC master.dbo.sp_addlinkedsrvlogin @rmtsrvname=N'CSVLinkedServer',@useself=N'True',@locallogin=NULL,@rmtuser=NULL,@rmtpassword=NULL 
```

一旦你有了它，你放入文件夹 S:\csv_location\ 的任何 CSV 文件最终都会在链接服务器的默认目录中作为一个名为 filename#csv 的表。

我有一种感觉，微软不支持为此目的使用这个特定的提供程序，但我们发现它可以很好地用于数据导入，而无需求助于 SSIS 等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:25:15.780

您还可以使用 BCP.EXE，它是一种简洁的，虽然是命令行密集型的数据导入方式。

您也可以使用 OPENQUERY 从 T-SQL 打开文件并插入，但这可能不可靠。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T19:53:34.400

您还可以使用 SQL Server 导入/导出向导[在此处输入链接描述](http://msdn.microsoft.com/en-us/library/ms141209.aspx)

# c# - 检查是否存在具有特定属性的记录。

> ID：13943142
> 
> 赞同：0
> 
> 时间：2012-12-18T23:21:14.330
> 
> 标签：c#, asp.net, linq, entity-framework

我有一个表单来检查它是否在允许插入之前已经存在记录。我遇到的问题是我的删除不会删除它们只是隐藏。所以知道当我替换一个已删除的项目时，它会看到它已经存在。如何更改我的代码以将 Deleted Bool 合并到查询中以查看记录是否已存在。

我的记录有一个已删除的属性，它是一个布尔值。如果布尔为真（记录被删除），我希望它插入。否则返回-1。

```
 // Get Db context
            ItemContext _db = new ItemContext();

            bool ItemExists = _db.Item.Any(i => i.ItemName.Equals(ItemName));

            if(ItemExists)
            {
                return -1;
             }
            else{

            // Add product to DB.
            _db.Item.Add(myItem);
            _db.SaveChanges();
            return myItem.ItemID;
            }
            //Success 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T23:22:52.230

更改您的定义`ItemExists`以包括已删除的概念：

```
bool ItemExists = _db.Item.Any(i => i.ItemName.Equals(ItemName) && !i.Deleted); 
```

# html - 如何使标签不继承宽度

> ID：13943146
> 
> 赞同：1
> 
> 时间：2012-12-18T23:21:48.457
> 
> 标签：html, css

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T23:41:43.680

`a`元素没有继承宽度；相反，您正在对其进行设置`display: block`，使其宽度成为整个可用宽度。您需要将设置分开，以便`span`对齐其中的文本行并且`a`元素是`inline-block`（或默认为`inline`，但您会遇到行高问题）。像这样：

```
span.aviso { 
    display: block;
    width: 960px; 
    text-align: center;
}
span.aviso a {
    padding: 20px 35px;
    background: rgb(255, 174, 174);
    background: rgba(255, 174, 174, 0.3);
    border:1px solid #FF1C1C;                 
    border-radius:10px;
    color:#FF0000; 
    opacity:1;
    display: inline-block;
    font-size: 14px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:23:32.663

# python - 基于状态与传递参数

> ID：13943154
> 
> 赞同：1
> 
> 时间：2012-12-18T23:22:41.140
> 
> 标签：python, function, arguments, state

我以 Python 为例。

```
class ThingArguments:
    def render(self, text, color):
        return magiclibrary.generateText(text, color)

class ThingStates:
    def __init__(self):
        self.color = (0, 0, 0)

    def render(self, text):
        return magiclibrary.generateText(text, self.color)

    def setColor(self, color):
        self.color = color 
```

哪个更适合 Python？对于任何语言，哪一种更可取？各有什么优势..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:11:11.767

首先，[正如 Sven Marnach 提到](https://stackoverflow.com/questions/13943154/state-based-vs-passing-arguments#comment19226857_13943154)的，第一个示例应该是一个普通函数：

```
def render(self, text, color):
    return magiclibrary.generateText(text, color) 
```

那么这个普通函数和类解决方案有什么区别呢？

## 普通函数

*   易于记录和理解
*   测试很简单（只需连续进行多次调用并将输出与预期进行比较）
*   更简单的心智模型，减少意外和错误
*   将文本和颜色保持在同一位置，因此您始终知道将使用哪种颜色

## 班级

*   可以扩展，透明地导致其他行为
*   可以作为参数传递，其他地方可以`render`在不指定颜色的情况下调用（如果这是最常见的行为，这很重要）

在 Python 中，通常首选第一种方法。一个简单的函数意味着更少的状态需要担心，这对于更大或更复杂的程序来说可能是一件大事。此外，[显式优于隐式](http://www.python.org/dev/peps/pep-0020/)。

我总是更喜欢第一种方法，即使不完全可用。想到 Java，函数必须始终包含在类中，因此我最终在抽象类中使用了许多静态函数。

我认为这更多的是上下文问题而不是语言问题。例如，如果该类用于渲染日志，则该类将更可取，调用它的函数不太关心颜色。另一方面，如果大多数调用者都知道颜色并想选择它，那么该类将是一个禁忌。

和往常一样，当有疑问时，采取更简单的方法。使代码复杂化比简化更容易。

# php - DirectoryIndex .htaccess 指令被 RewriteRules 覆盖

> ID：13943161
> 
> 赞同：0
> 
> 时间：2012-12-18T23:23:10.100
> 
> 标签：php, apache, .htaccess, mod-rewrite, oxwall

我有以下 .htaccess 文件：

```
DirectoryIndex index.html

Options +FollowSymLinks
RewriteEngine On

AddEncoding gzip .gz
AddEncoding gzip .gzip
<FilesMatch "\.(js.gz|js.gzip)$">
  ForceType text/javascript
</FilesMatch>
<FilesMatch "\.(css.gz|css.gzip)$">
  ForceType text/css
</FilesMatch>

#RewriteCond %{REQUEST_URI} .*/http-bind
#RewriteRule (.*) /http-bind [L]

RewriteCond %{REQUEST_URI} !^/index\.php
RewriteCond %{REQUEST_URI} !/ow_updates/index\.php
RewriteCond %{REQUEST_URI} !/ow_updates/
RewriteCond %{REQUEST_URI} !/ow_cron/run\.php
RewriteCond %{REQUEST_URI} !/index\.html
RewriteCond %{REQUEST_URI} (/|\.php|\.html|\.htm|\.xml|\.feed|robots\.txt|\.raw|/[^.]*)$  [NC]
RewriteRule (.*) index.php 
```

我希望 .htaccess 中的所有其他内容都像以前一样工作：重定向所有请求，除了那些用`!`to指定的请求`index.php`。但是，我需要`index.html`在第一次加载网站时加载，然后它们会继续加载`index.php`。

所以我`DirectoryIndex index.html`在开头加了一行，然后又加了一行`RewriteCond %{REQUEST_URI} !/index\.html`，希望用户在输入的时候`http://url.com`，会被带到index.html文件中，从里面进入到内页，`http://url.com/homepage`里面的页面都是由`index.php`.

但是，这不起作用。我使用的软件是[Oxwall](http://www.oxwall.org/)。该站点只是忽略了第一行并继续加载 index.php 无论如何。我能做些什么来解决这个问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:26:44.397

您可以通过会话或 cookie 使用 PHP 轻松处理此问题。您可以让它始终将某人重定向到 index.php，并且在 index.php 中您可以包含 index.html 文件以显示他们是否是第一次访问。如果您将它们重定向到 html 文件，它将不起作用（.htaccess 会妨碍您），但如果您包含该文件，那么它应该可以正常工作。

# php - 如何在 PHP 变量中存储图像属性

> ID：13943165
> 
> 赞同：-1
> 
> 时间：2012-12-18T23:23:24.903
> 
> 标签：php

我有以下 HTML ...

```
<img id="image1" src="URL" alt="image1" name="image1" width="137" height="119" border="0" style="position: relative; left: -355px; top: 62px;" > 
```

我将如何将以下信息存储到变量中......来自样式属性。

```
 $variable1 = -355;
 $variable2 = 62; 
```

先感谢您！

更新：

抱歉没有解释清楚，感谢您的帮助。

现在的目标是，在页面上提交表单后，查找所有 img 标签并将 img 标签内的每个属性存储到 PHP 变量中。

然后，我希望将这些值存储到 MySQL 数据库中并在不同的页面上检索它们。

我希望这能解决问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:46:07.880

如果您创建页面，那么您应该能够提前知道这些值，因为您可以先分配变量然后在这些标签中打印它们，或者它们已经预设在模板中的某处，您只需阅读这些价值观。

否则，如果该内容以另一种方式生成，而不是由您的系统生成，那么您将需要一些 JavaScript 代码来“读取”这些属性并在用户提交表单时将其“放在一边”发送给您。通常这是通过添加一些隐藏字段来完成的，其中包含“document.image1.src”之类的内容作为要发送的值。

我不可能在这里给你一段代码，因为我们不知道你的应用程序的结构是什么样的。但是，这应该让您了解它是如何工作的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:10:57.710

你可以这样做：

When your jQuery plugin sets image attributes you could also add hidden input fields to the form with those attributes values. This is possible if the plugin api has events available. Otherwise you would need to extend it by your own. After subbmiting form, server would receive hidden input fields values along with other. So in PHP this would be accesible from the `$_GET` or `$_POST` global array (depending on form method).

Another way:

You could also capture the moment when user clicks submit button on the form. Then - stop default behavior. Next send an Ajax call to the server, passing current image attributes values. Server can store those values in the database, or do whatever you want and return a response. After response you can trigger the form submission programmatically.

# php - 如何传递从 HTML 表单中选择的值？

> ID：13943167
> 
> 赞同：0
> 
> 时间：2012-12-18T23:23:34.060
> 
> 标签：php, javascript, jquery, forms, http-post

我有一个包含两种形式的 PHP 文件。具有一个文本框和三个下拉列表作为过滤器的 Form1（中级）。一旦我点击 Form1 中的提交按钮，这些值就会被 POST 到另一个 PHP 文件进行计算，并显示 Form2(ProductionForm)（到目前为止它是隐藏的）。

我已经用 jQuery 完成了这个，这里是代码片段：

```
 <script type="text/javascript">
$(document).ready(function(){
    $("#intermediate").submit(function() {
    /* AJAX calls and insertion into #productionForm */

        $.post("../c/ProductionSummaryFormCalculation.php", {
        Date: $('#datepicker').val(),
        ShiftId: $('#selectShift :selected').val(),
        Machine: $('#selectMachine :selected').val(),
        User: $('#selectUser :selected').val(),
    });

        $("#datepicker").prop("disabled", true);
        $("#selectShift").prop("disabled", true);
        $("#selectMachine").prop("disabled", true);
        $("#selectUser").prop("disabled", true);
    $("#productionForm").show();
        return false;
    });
}); 
```

我想要从 ProductionSummaryFormCalculation.php 文件计算的值并加载到 Form2 中的文本框中。

当我在以下代码中使用它时，它不起作用：

```
 <input id="start_time_text" class="start_time_text" type="text" name="start_time_text" value="<?php echo $start_time; ?>"> 
```

另外，当我点击 Form2 中的提交按钮时，我想通过 POST 方法将从 Form1 和 Form2 中选择的值发送到另一个 PHP 文件。

```
 $("#productionForm").submit(function() {
    /* AJAX calls and insertion into #productionForm */
        $.post("../c/ProductionSummaryForm2.php", {
        start_time: $('#start_time_text').val(),
        end_time: $('#end_time_text').val(),
        remarks: $('#Remarks').val()
    });
}); 
```

我怎样才能做到这一点；有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:34:57.677

当您执行 $.post 时，您还可以放置一个在提交成功时执行的函数。 [http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)
提交第一个表单后，获取 php 文件以返回给您任何您想要的内容并将其添加到所需的文本区域。

如果这是一个简单的两步表单，您不必将第一个表单发送到文件并返回结果。只需创建一个包含两个 div 的表单，在第一次提交时隐藏 1 个 div 显示另一个 div 并将它们一起提交。

# java - 杰克逊 - 在 JsonSerializer 中使用 JsonView？

> ID：13943174
> 
> 赞同：3
> 
> 时间：2012-12-18T23:24:15.227
> 
> 标签：java, jackson

是否可以告诉`JsonGenerator`使用特定的 JsonView 序列化对象？

例如：

```
@Data
class Author {
    @JsonSerialize(using=CustomSerializer.class)
    List<Book> bestFiveBooksOfAllTime;
};
@Data
class Book extends BaseEntity
{
    @JsonView(SummaryView.class)
    private String title;
    @JsonView(SummaryView.class)
    private String author;
    private String review;
} 
```

在我的`CustomSerializer`中，我希望能够按照以下方式做一些事情：

```
public class CustomSerializer extends JsonSerializer<Author> {

    @Override
    public void serialize(Author value, JsonGenerator jgen,
            SerializerProvider provider) throws IOException,
            JsonProcessingException {
        jgen.writeStartObject();
        for (Book book : value.getBestFiveBooksOfAllTime()) {
                    // Something like the following...
            jgen.writeObjectFieldUsingView(book.getId().toString(), book, SummaryView.class);
        }
        jgen.writeEndObject();
    }
} 
```

即，在上述场景中，我希望结果包含 的地图`bestFiveBooksOfAllTime`，其中的值就是`SummaryView`书的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:53:04.727

这是我最终使用的解决方案 - 请告知是否有更好的方法

```
@Override
public void serialize(Author value, JsonGenerator jgen,
        SerializerProvider provider) throws IOException,
        JsonProcessingException {

    ObjectMapper mapper = new ObjectMapper();
    mapper.configure(SerializationConfig.Feature.DEFAULT_VIEW_INCLUSION, false);
    mapper.setSerializationConfig(mapper.getSerializationConfig().withView(SummaryView.class));

    jgen.writeStartObject();
    for (Book book : value.getBestFiveBooksOfAllTime()) {
        jgen.writeFieldName(book.getId().toString());
        mapper.writeValue(jgen, book);
    }
    jgen.writeEndObject();
} 
```

# linq-to-sql - Linq DataContext 和隔离级别

> ID：13943180
> 
> 赞同：0
> 
> 时间：2012-12-18T23:25:01.593
> 
> 标签：linq-to-sql

在没有添加特殊设置的情况下，在最后单个 submitchanges() 的情况下 linq to sql datacontext 的行为如何？我的数据库在 mssql 服务器上

我对交易的确切开始时间感到困惑。考虑以下伪 EXAGGERATED 代码：

```
DataContext dc= new DataContext();
Thread.Sleep(10 min);
var rs = from a in dc.myTable Where.. select r;
.............
.............
.............
use rs //but do nothing to edit myTable.May be loop over it(?) to force execution
.............
.............
Thread.Sleep(10 min);
//read again, same criteria as before
rs = from a in dc.myTable Where.. select r;
.............
.............

dc.SubmitChanges() 
```

1.  如果我没有在任何地方明确更改任何设置，无论是代码还是 db. 即使其他人在表中插入（并提交）符合我的选择标准的新行，我的 rs 第二次会返回相同的结果吗？
2.  linq 的隐式事务何时/何时开始？就在实例化 DataContext 的时候？或者取决于我们对 DataContext 做什么（或不做什么），当 dc.SubmitChanges() 被调用时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T10:41:12.967

1.  当您没有在特定隔离级别显式启动事务时，您的读取发生在事务之外并以默认隔离级别运行，我认为这是已提交读。如果在执行两个查询之间，其他用户插入了与您的条件匹配的其他记录，它们将显示在第二个查询的结果中。
2.  隐式事务在实际数据提交到数据库之前启动并在之后立即提交。如果您`SubmitChanges`多次调用，每次调用都会有一个事务。

关于第一个问题：如果您*确实*在事务中运行查询，请注意您使用的隔离级别，以及如何设置表的锁定升级策略。默认情况下，如果您使用`using (var scope = new TransactionScope())`，您的第一个查询将导致表被锁定。其他希望插入记录的用户最终会等待一段时间，并且由于超时而拒绝他们的操作。[在此处](http://msdn.microsoft.com/en-us/library/system.transactions.isolationlevel.aspx)阅读有关隔离级别的更多信息。

# python - 为什么 cURL 返回“其他东西不好”？

> ID：13943181
> 
> 赞同：23
> 
> 时间：2012-12-18T23:25:09.450
> 
> 标签：python, curl

我正在编写一个通过 cURL 查询社交媒体 API 的 Python 应用程序。我查询的大多数不同服务器（Google+、Reddit、Twitter、Facebook 等）都有 cURL 抱怨：

> 附加的东西不好 transfer.c:1037: 0 0

不寻常的是，当应用程序第一次启动时，每个服务的响应都会抛出一次或两次这一行。几分钟后，这条线会出现几次。显然 cURL 正在识别它不喜欢的东西。大约半小时后，服务器开始超时，这条线重复了几十次，所以它显示出一个真正的问题。

我该如何诊断？我尝试使用 Wireshark 捕获请求和响应标头以搜索可能导致 cURL 抱怨的异常，但是对于所有 Wireshark 的复杂性，似乎没有一种方法可以仅隔离和显示标头。

这是代码的相关部分：

```
output = cStringIO.StringIO()
c = pycurl.Curl()
c.setopt(c.URL, url)
c.setopt(c.USERAGENT, 'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:17.0) Gecko/20100101 Firefox/17.0')
c.setopt(c.WRITEFUNCTION, output.write)
c.setopt(c.CONNECTTIMEOUT, 10) 
c.setopt(c.TIMEOUT, 15) 
c.setopt(c.FAILONERROR, True)
c.setopt(c.NOSIGNAL, 1)

try:
    c.perform()
    toReturn = output.getvalue()
    output.close()
    return toReturn

except pycurl.error, error:
    errno, errstr = error
    print 'The following cURL error occurred: ', errstr 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-18T23:52:50.133

我 99.99% 确定这实际上不在任何 HTTP 标头中，而是`stderr`由`libcurl`. 这可能发生在您记录标题的过程中，这就是您感到困惑的原因。

无论如何，快速搜索`"additional stuff not fine" curl transfer.c`发现描述是[源的最近更改：](https://github.com/bagder/curl/commit/7840c4c70cd2a7395bcb5b840f91d9e1ac707948)

> **curl_readwrite：删除调试输出**
> 
> 前段时间为了调试目的添加了文本“其他东西不好”文本，但它并没有真正帮助任何人，并且出于某种原因，一些 Linux 发行版提供了仍然存在调试信息的 libcurl，因此（太多）用户阅读此信息。

所以，这基本上是无害的，你看到它的唯一原因是你得到了一个`libcurl`启用了完整调试日志的构建（可能来自你的 linux 发行版）（尽管`curl`作者认为这是一个坏主意）。所以你有三个选择：

1.  忽略它。
2.  升级到更高版本的`libcurl`.
3.  `libcurl`在没有调试信息的情况下重建。

您可以查看`libcurl`来源`transfer.c`（如上链接）以尝试了解`curl`抱怨的内容，并可能在大约同一时间在邮件列表中查找主题 - 或者只是通过电子邮件发送列表并询问。

但是，我怀疑这实际上可能与真正的问题根本无关，因为您甚至从一开始就看到了这一点。

这里有三件明显的事情可能会出错：

1.  curl 中的错误，或者您使用它的方式。
2.  您的网络设置有问题（例如，您的 ISP 会因为您在 30 分钟内建立过多的传出连接或使用过多的字节而将您中断）。
3.  您正在做的事情是让服务器认为您是垃圾邮件发送者/DoS 攻击者/无论他们正在阻止您。

第一个实际上似乎最不可能。如果你想排除它，只需捕获你发出的所有请求，然后编写一个简单的脚本，使用其他库来重放完全相同的请求，看看你是否得到相同的行为。如果是这样，问题显然不在于您如何提出请求。

您可能能够根据时间区分情况 2 和 3。如果所有服务同时超时——尤其是当您在不同时间开始点击它们时它们都超时（例如，您在 Facebook 后 15 分钟开始点击 Google+，但它们都在您点击 Facebook 后 30 分钟超时） ，肯定是情况2。如果不是，可能是情况3。

如果你排除了所有这三个，那么你可以开始寻找其他可能出错的事情，但我会从这里开始。

或者，如果您告诉我们更多关于您的应用程序的确切功能（例如，您是否尝试以尽可能快的速度一遍又一遍地访问服务器？您是否尝试代表大量不同的用户进行连接？您使用的是dev 密钥或最终用户应用程序密钥？等），其他对这些服务有更多经验的人可能会猜测。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-21T09:40:24.253

我不同意这一点 - 尝试通过 BIGIP LTM 外部 VIP 地址呼叫网站时，我收到相同的消息。

例如：

我将网站称为[http://11five.10.10.10/index.html](http://11five.10.10.10/index.html)（在这种情况下 IP 地址是随机的）。BIG F5 应该通过与虚拟服务器关联的池对两个内部 Web 服务器（17two.20.0.10 和 17two.20.0.11）的流量进行负载平衡。

在这种情况下，从外部源（内部客户端）到 TCP 80 上的 VIP 地址的请求应该在两个 Web 服务器之间循环。我发现所有服务器都收到了一个初始的 SYN 数据包，而从来没有收到 SYN-ACK。

如果我坐在真实服务器所在的本地子网内的终端上，我可以“wget”index.html 网页——从 17two.20.0.11 到[http://17two.20.0.10](http://17two.20.0.10) }/index.html。

来自外部，我收到 *additional stuff not fine transfer.c:1037 0 0 消息。

你说得对，它是 libcurl 库的旧版本中 CURL 的内置调试机制，但我不同意下面的说法；

```
A bug in curl, or the way you're using it.
Something wrong with your network setup (e.g., your ISP cuts you off for making too many outgoing connections or using too many bytes in 30 minutes).
Something you're doing is making the servers think you're a spammer/DoS attacker/whatever and they're blocking you. 
```

造成这种情况的原因是环境中的网络问题，IE .. Web 服务器无法将流量返回到原始源，因此显示一两个错误，请求标头和响应有问题从网络服务器。

在这种情况下，我会选择说原始问题更有可能是因为当我对来自本地子网中的测试主机的原始请求使用不同的 URI 执行 curl 时，我可以很好地检索 index.html 网页。这意味着服务器正在侦听和接受使用 FQDN 和服务器短名称的连接。

我相信这个错误表明 curl 收到了一个不确定的响应，因此会产生上述错误。如果没有开发 curl 或阅读源代码，我无法进一步评论。

任何质疑这种逻辑的额外回应都将受到欢迎——所有这些都是为了学习新事物。

安迪

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-26T10:52:01.100

确认

> curl 中的错误，或者您使用它的方式。

系统信息：Linux alt 3.2.0-4-amd64 #1 SMP Debian 3.2.63-2+deb7u1 x86_64 GNU/Linux

我更新了 curl 库和连续消息（在 twitter rest api 测试中被捕获）

> *   附加的东西不好 transfer.c:1037: 0 0

消失了

我新更新的 curl --version 数据

> $卷曲-V
> 
> curl 7.38.0 (x86_64-pc-linux-gnu) libcurl/7.38.0 OpenSSL/1.0.1e zlib/1.2.7 libidn/1.25 libssh2/1.4.3 librtmp/2.3 协议：dict 文件 ftp ftps gopher http https imap imaps ldap ldaps pop3 pop3s rtmp rtsp scp sftp smtp smtps telnet tftp 功能：AsynchDNS IDN IPv6 Largefile GSS-API SPNEGO NTLM NTLM_WB SSL libz TLS-SRP

# .htaccess - 我使用 .htaccess 重定向的方式存在缺陷

> ID：13943184
> 
> 赞同：1
> 
> 时间：2012-12-18T23:25:20.610
> 
> 标签：.htaccess

我试图用我的 .htaccess 文件做一些不同的事情，但由于它对我来说还是有点新，所以我在让一切都按照我想要的方式做一些事情时遇到了一些麻烦。这就是我遇到的麻烦...

1) 我想针对移动设备重定向到我的移动站点，除非移动设备运行的是 Opera Mini。我试图解决这个问题，但它仍在重定向 Opera Mini。这是我必须重定向的内容（基于我从该站点获得的代码。此代码有效）

```
# Detect if the user is on a mobile device
RewriteCond %{HTTP_USER_AGENT} android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge\ |maemo|midp|mmp|opera\ mobi|palm(\ os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows\ (ce|phone)|xda|xiino [NC,OR]
# If user is mobile, redirect to mobile site, preserving the remainder of the URL
# For example, http://www.triadbarspecials.com/barname redirects to http://m.triadbarspecials.com/barname
RewriteRule ^(.*)$ http://m.triadbarspecials.com/$1 [L,R=302,nc] 
```

因此，我想确保 Opera Mini 始终定向到我的完整网站，因此我添加了以下代码：

```
# Detect if we're in Opera Mobile
RewriteCond %{HTTP_USER_AGENT} opera\ mini
# If so, make sure user is on the main site
RewriteRule ^(.*)$ http://www.triadbarspecials.com/$1 [L,R=302,nc] 
```

任何人都可以看到那里发生了什么导致它无法直接到主站点吗？

2) 我设置了我的站点，以便用户可以在 URL 的 .com/ 部分之后键入一个栏的名称，如果该栏存在于我的站点上，.htaccess 会将用户路由到正确的页面。例如，`triadbarspecials.com/justinsbar is the same as triadbarspecials.com/bars.php?barname=justinsbar`

我的错误文档无法正常工作时遇到问题。如果用户键入我的站点上不存在的栏的名称，则 URL 仍会指向该页面，但不会显示动态内容，因为没有该名称的栏。`triadbarspecials.com/`只要用户键入的 URL 不存在，用户也会被定向到该页面以查找在其后键入的任何内容。这是我的代码...

```
# The following allows for URL's to be typed as just the bar's name
# for example, http://www.triadbarspecials.com/bars.php?barname=barname is changed to     http://www.triadbarspecials.com/barname
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ bars.php?barname=$1 [L] 
```

我可以看到这段代码看起来很笼统，所以希望有人可以帮助支持这一点并使事情正确重定向。这是我的错误文档

```
ErrorDocument 400 /error.php?error=400
ErrorDocument 401 /error.php?error=401
ErrorDocument 403 /error.php?error=403
ErrorDocument 404 /error.php?error=404
ErrorDocument 500 /error.php?error=500 
```

3) 我的 .htaccess 文件中有这段代码，但我完全忘记了它的作用。我不想只是删除它，所以希望有人能解释它的作用......

```
RewriteCond %{HTTP_HOST} ^triadbarspecials.com[nc]
RewriteRule ^(.*)$ http:#www.triadbarspecials.com/$1 [r=301,nc] 
```

提前感谢任何可以提供帮助的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:38:28.393

1.  根据[此链接，](http://www.useragentstring.com/pages/Opera%20Mini/) **Opera Mini**的用户代理同时包含字符串“ *opera mini* ”和*“opera mobi”*，并且您在第一次重定向中与第二个匹配。这意味着您的“Opera mini”设备会被重定向到移动网站，而第二条规则将永远不会被应用。您应该摆脱第二个重定向并结合两个条件：

    ```
    # Detect if the user is on a mobile device
    RewriteCond %{HTTP_USER_AGENT} android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge\ |maemo|midp|mmp|opera\ mobi|palm(\ os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows\ (ce|phone)|xda|xiino [NC]
    # As long as it's NOT opera mini
    RewriteCond %{HTTP_USER_AGENT} !opera\ mini [NC]
    # If user is mobile, redirect to mobile site, preserving the remainder of the URL
    # For example, http://www.triadbarspecials.com/barname redirects to http://m.triadbarspecials.com/barname
    RewriteRule ^(.*)$ http://m.triadbarspecials.com/$1 [L,R=302,nc] 
    ```

2.  您必须检查该栏是否存在于您的`bars.php`脚本中。在该脚本中，如果**barname**参数请求的栏不存在，则将浏览器重定向到`/error.php?error=404`. 您不能在 mod_rewrite 中严格执行此操作，因为该规则不知道 barname 是否存在于您的数据库中。Mod_rewrite 没有对您的数据库的固有访问权限。

3.  它将请求重定向到您的站点，其中`www`缺少从主机名到*带有*`www`. 因此，如果有人输入：

    ```
    http://triadbarspecials.com/somebar 
    ```

    他们被重定向到：

    ```
    http://www.triadbarspecials.com/somebar 
    ```

# css - 错开 CSS3 动画时间

> ID：13943191
> 
> 赞同：8
> 
> 时间：2012-12-18T23:26:22.900
> 
> 标签：css, animation

我有很多`.line`s，我正在对它们应用淡入淡出的动画。我想知道是否有一种简单的方法可以以某种方式错开动画时间，以便每个都一个接一个地触发（与一次相反）。换句话说，我想创建一个效果，其中第一个`.line`开始褪色，然后第二个开始褪色，然后`.line`第三个开始`.line`褪色。这只需要在 Chrome 中工作。

```
div.line { width: 300px; height:5px; background:red;
           -webkit-animation: fade 20s infinite;
           -webkit-animation-timing-function: linear;
}

@-webkit-keyframes fade {
    0%   { opacity:1.0; }
    50%  { opacity:0.0; }
    100% { opacity:1.0; }
}

<div class="line"></div>
<div class="line"></div>
...
<div class="line"></div> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-18T23:33:44.243

使用 nth-child 选择每一行，然后应用动画延迟，如下所示：

```
.line:nth-child(1) {
    -webkit-animation-delay: 1s;
}
.line:nth-child(2) {
    -webkit-animation-delay: 2s;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-01-08T12:33:25.443

SASS 解决方案可能如下所示：

[这是 CodePen](http://codepen.io/anon/pen/tngHy)

样式.css

```
@import "compass/css3";

.my-element {
    @include transition(opacity 0.3s);
    @include opacity(0);
    @include inline-block;
    margin: 5px;
    width: 100px;
    height: 100px;
    background: tomato;

    // Loop through the items and add some delay.
    @for $i from 1 through 3 {
            &:nth-child(#{$i}) { 
             @include transition-delay(0.1s * $i); 
            }
        }

    .my-container:hover & {
        @include opacity(1);
    }
} 
```

[http://codepen.io/anon/pen/tngHy](http://codepen.io/anon/pen/tngHy)

# date - 根据天数计算日期

> ID：13943193
> 
> 赞同：0
> 
> 时间：2012-12-18T23:26:25.613
> 
> 标签：date, batch-file, cmd

我确信这一定是可能的，但我不知道从哪里开始。

我需要能够根据数字计算出日期。这个数字是连续的，并且每天都会增加一个。所以我可以尽可能多地让数字与一年中的日期相关（即 1 月 1 日将是第 1 天等）但我需要能够用任何 ddmmyyyy 格式计算出日期给定的数字。

我发现了与 C++ 和 Java Script 相关的类似问题......

这可以在 CMD 中完成吗？

*编辑*

我刚刚意识到日期会根据年份而变化（即闰年）

对于我的脚本，年份将始终是 2012 年，因此我需要能够根据序数日（我认为这是描述它的正确方式）来计算日期，仅适用于 2012 年。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:04:02.370

下面的代码从当前日期获取日期。当然，很容易将其更改为固定年份。

我想说这都是我自己写的，但它是基于[Rob van der Woude 的代码](http://www.robvanderwoude.com/datetimentmath.php)。看看网站。它有很多日期计算功能，所有这些功能都隔离在单独的脚本中，而不是我用它制作的固定用途的混乱。;)

```
@echo off
:: Input: The number of days to add. You can make this a parameter 
:: too, if you want.
SET /A Days   = 20
echo %DATE:~-4%

:: Get 1 january of the current year
SET /A Year1  = %DATE:~-4% + 4800
SET MM=1
SET DD=1

:: Calculate the Julian date of that date.
SET /A Month1 = ( %MM% - 14 ) / 12
SET /A JDate  = 1461 * ( %Year1% + %Month1% ) / 4 + 367 * ( %MM% - 2 -12 * %Month1% ) / 12 - ( 3 * ( ( %Year1% + %Month1% + 100 ) / 100 ) ) / 4 + %DD% - 32075

:: Add the number of days
SET /A JDate  = %JDate% + %Days%

:: Calculate it back to year, month and day.
SET /A P      = %JDate% + 68569
SET /A Q      = 4 * %P% / 146097
SET /A R      = %P% - ( 146097 * %Q% +3 ) / 4
SET /A S      = 4000 * ( %R% + 1 ) / 1461001
SET /A T      = %R% - 1461 * %S% / 4 + 31
SET /A U      = 80 * %T% / 2447
SET /A V      = %U% / 11

:: SET /A GYear  = 100 * ( %Q% - 49 ) + %S% + %V%
SET /A GMonth = %U% + 2 - 12 * %V%
SET /A GDay   = %T% - 2447 * %U% / 80

:: Echo only month and day
echo %GMonth% %GDay%

:: Clean-up
FOR %%A IN (P Q R S T U V MM  DD JDate Year1 GDay GMonth GYear) DO SET %%A= 
```

# objective-c - iOS 在启用 ARC 的设备上崩溃

> ID：13943194
> 
> 赞同：7
> 
> 时间：2012-12-18T23:26:29.657
> 
> 标签：objective-c, ios, memory-management, automatic-ref-counting

我遇到了一个让我完全难过的问题。我将用一个代码示例进行说明：

```
@interface Crasher ()
@property (nonatomic, strong) NSArray *array;
@end

@implementation Crasher

- (void)crash;
{
  NSMutableArray *mutable = [NSMutableArray array];
  NSArray *items = @[@0, @1, @2, @3];

  if ([@YES boolValue])
  {
    [items enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
      [mutable addObject:obj];
    }];
  }
  else
  {
    [items enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
      [mutable addObject:obj];
    }];
  }

  [self setArray:mutable];
}

@end 
```

`[self setArray:mutable]`启用 ARC 并在设备上运行时，上述代码在线崩溃。该代码永远不会在模拟器上崩溃，也不会在禁用 ARC 的设备上崩溃。Using`NSZombieEnabled`表示 setter 试图保留一个已经释放的数组。

`[mutable addObject:obj]`如果第二次调用被注释掉，它不会崩溃（但这段代码从不首先执行）。

我已将演示此崩溃的项目上传到 Github 到[`aidansteele/arc-crash`](https://github.com/aidansteele/arc-crash). 我正在使用 Xcode 4.5.2。它似乎不会出现在 Xcode 4.6 上，但仍处于开发者预览版中。我究竟做错了什么？

* * *

解决[这个](https://stackoverflow.com/a/13943891/216724)答案（在问题中以便我有更多空间），我不认为问题出在问题之内`-[NSArray enumerateObjectsUsingBlock:]`，因为如果我更改该方法调用以使用以下`-[NSArray(Functional) each:]`调用，问题仍然存在。

```
@interface NSArray (Functional)
- (void)each:(void (^)(id obj))action;
@end

@implementation NSArray (Functional)

- (void)each:(void (^)(id))action;
{
  for (NSUInteger idx = 0; idx < [self count]; idx++)
  {
    action([self objectAtIndex:idx]);
  }
}

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T06:58:13.103

因为这个问题只发生在设备上（ARM 代码），并且在发布版本（优化代码）中，我非常怀疑你在 Clang 编译器的优化器中发现了关于 ARC 和块和自动释放的错误。使用您的示例项目作为附件在 Radar 中提出错误。

如果将 enumerateObjectsUsingBlock 替换为

```
for (id n in items)
{
   [mutable addObject:n];
} 
```

你的崩溃会消失。

解决问题的代码的其他更改：

代替：

```
[NSMutableArray array]; 
```

和

```
[NSMutableArray new]; 
```

或者

```
[[NSMutableArray alloc] init]; 
```

另外，顺便说一句，您不应该将 NSMutableArray 存储在 NSArray 属性中。在将 NSMutableArray 分配给属性之前，您应该将其转换为 NSArray。例如：

```
self.array = [NSArray arrayWithArray:mutable]; 
```

请注意，这不会修复崩溃。这只是更好的代码。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T07:10:09.517

我认为答案可能在于自动释放的变量，以及使用这个自动释放变量的块。

[来自关于__autoreleasing 对象](http://clang.llvm.org/docs/AutomaticReferenceCounting.html#storage-duration-of-autoreleasing-objects)的存储持续时间的 Clang 文档：

> 如果程序声明了一个非自动存储持续时间的 __autoreleasing 对象，则该程序是格式错误的。如果程序在块中捕获 __autoreleasing 对象，或者除非通过引用，否则在 C++11 lambda 中捕获程序是非良构的。

那么如何测试这是否是问题呢？

首先我们看看捕获可变数组的块是否真的是问题的根源。在第一个块（唯一调用的块）中注释掉可变数组的使用，并在枚举找到的值上使用 NSLog 代替：

```
[items enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        //[mutable addObject:obj];
        NSLog(@"item is %@",obj);
    }]; 
```

这修复了崩溃。如果我们简单地以不会导致突变的方式引用可变数组（以确保突变不是问题）怎么办？

```
[items enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        //[mutable addObject:obj];
        NSLog(@"Mutable array is %@",mutable);
    }]; 
```

这仍然会崩溃，因此我们可以判断只是在块中引用自动释放的可变数组会导致问题。附带说明一下，使用正确调整大小以保存所有值的 arrayWithCapacity 也会导致崩溃。

那么，如果问题是捕获自动释放对象的块，我们该如何解决这个问题呢？

我们可以将变量设为 strong ，这样 ARC 就必须释放它：

```
 NSMutableArray *mutable = [NSMutableArray array]; 
```

这修复了崩溃，并且 ARC 在离开方法时正确释放变量。

但是我不完全确定这是完整的故事 - 只是在该方法的任何地方引入这个简单的块也可以修复崩溃：

```
 void (^useMute)();

    useMute = ^() {
        NSLog(@"Mutable is %@", mutable);
    }; 
```

即使它从未使用过，它也会导致可变数组被保留并阻止提前发布。因此，真正的错误似乎在于 enumerateUsingBlock 和自动释放池的交互。

在更多的方面，解决这个问题的方法是使用普通枚举而不是块枚举：

```
 for (id obj in items )
      {
          [mutable addObject:obj];
      } 
```

有时最好使用更简单的机制来做事，除非你有充分的理由使用更高级的方法。对于旨在直接同步代码执行的数组元素循环，如果您不需要访问块传递给您的其他参数，为什么要使用块？您甚至可以使用 C 构造 continue 和 stop 进行比块循环更多的控制，后者只允许完全停止枚举。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T00:46:43.957

我认为 `enumerateObjectsUsingBlock`您的 SDK 版本的方法存在问题。也许您应该阅读新 SDK 的发行说明或旧 SDK 的已知问题以了解更多信息。因此，发生的情况是，您的保留计数在您调用`enumerateObjectsUsingBlock`. 该方法退出后，您的指针指向一些垃圾。

`enumerateObjectsUsingBlock`解决它的一种方法是对您的收藏负责，并保证您在退出之前不会将其丢弃。虽然是一个修复，但它并没有解决核心问题，正如我上面所说，我认为它存在于`enumerateObjectsUsingBlock`. 这是一个有效的代码（周围）。

```
#import "Crasher.h"

@interface Crasher ()
@property (nonatomic, strong) NSArray *array;
@end

@implementation Crasher

- (void)crash;
{
  __block NSMutableArray *mutable = [NSMutableArray array];
  NSArray *items = @[@0, @1, @2, @3];

  if ([@YES boolValue])
  {
    [items enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
      [mutable addObject:obj];
    }];
  }
  else
  {
    [items enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
      [mutable addObject:obj];
    }];
  }

    NSLog(@"%@", mutable);

  [self setArray:mutable];
}

@end 
```

# ajax - 如何在 .ajax() 的 beforeSend() 等自动调用函数上正确利用 jQuery Deferred/promise？

> ID：13943196
> 
> 赞同：0
> 
> 时间：2012-12-18T23:26:39.330
> 
> 标签：ajax, jquery, jquery-deferred

我正在扩展 jQuery 的`ajaxPrefilter`界面以向 AJAX 调用添加额外的功能；`setRequestHeader()`即在方法中使用将标头数据附加到 XHR 请求上`beforeSend()`。问题是，the`ajaxPrefilter`和 ajax 调用本身都可以包含`beforeSend`选项，其中一个或两个都可以包含异步功能。

假设我的`ajaxPrefilter`样子是这样的：

```
(function($) {
    $.ajaxPrefilter(function(options, originalOptions, jqXHR) {
        var auth = $.cookie("fake_site"),
            normalizedRequest = $.Deferred();

        if (originalOptions.authorizeUser) {
            options.beforeSend = function() {
                jqXHR.setRequestHeader("Authorization", "Session " + auth);
            }

            // resolving the jqXHR Deferred, statusCode handling, etc.
        }

    });
})(jQuery);​ 
```

现在，**options**和**originalOptions**都可以包含`beforeSend()`方法，我希望**options.beforeSend**始终首先执行。这似乎是延迟/承诺使用的主要候选者，但由于`beforeSend`自动调用的事实，我不能这样做：

```
options.beforeSend = function(jqXHR) {
    // setting the request header; creating, resolving, and returning the Deferred
}

$.when(options.beforeSend(jqXHR)).then(function() {
    originalOptions.beforeSend();
}); 
```

正如预期的那样，这会导致`options.beforeSend`两次触发；由于它的定义语句和`$.when`调用。

Deferreds/promises 如何用于管理自动调用的方法，例如`beforeSend`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T04:14:56.290

关于控制`beforeSend`回调后发生的事情，只有两种选择：

*   返回 false 以外的任何内容以允许请求继续进行，或者
*   返回`false`以取消请求。

您确实可以在回调中发出 ajax 请求，但无论返回什么都会导致原始（外部）ajax 请求立即发出或取消。由于回调将无条件完成并返回，因此不可能通过延迟或其他方式使外部 ajax 依赖于内部。

对于您想要的效果，您可以在回调中，级联发出两个 ajax 请求（第二个依赖于第一个）并返回`false`以取消原始请求。

有一天，您可能想采用这种模式可能有一些模糊的原因，但是，如果原始请求被无条件地丢弃（通过返回 false），那只不过是实现两个 ajax 请求级联的复杂方式，而不是涉及`beforeSend`，即：

```
$.ajax({
    //options
}).done(function() {
    $.ajax({
        //options
    }).done(function(){
        //do stuff here
    });
}); 
```

或`.pipe()`等价物。

总之，让 jQuery ajax 请求依赖于在其回调中编码的另一个异步操作似乎是不可能的`beforeSend`，但是可以通过不涉及`beforeSend`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-27T18:04:11.757

以下有点难看，但可以全局处理重新启动原始请求，而不是嵌套每个请求。例如，如果您需要令牌并且令牌已过期，则此示例依赖于由全局 api.getToken() 函数返回的承诺。

```
$.ajaxSetup({
  beforeSend: function(xhr,settings) {
    var newTokenNeeded = false;
    var originalSettings=settings;

        var promise = api.getToken().then(function(data){

            if(newTokenNeeded && typeof originalSettings.nested ==='undefined'){
                originalSettings.nested=true;//this flag is used to prevent infinite loops
                $.ajax(originalSettings);//here we re request the original, that we cancelled previously
            }else{
                xhr.setRequestHeader('Authorization', 'Bearer ' +data.t );
            }
        });
        if(promise.state()==='pending'){
            newTokenNeeded=true;
            return false; //returning false cancels the original request
        }
  }

}); 
```

# ios - CGFloat 是如何构成有效数字的？

> ID：13943200
> 
> 赞同：3
> 
> 时间：2012-12-18T23:27:02.620
> 
> 标签：ios, math, cgpoint, digit, cgfloat

> **可能重复：**
> [CGFloat 添加错误？](https://stackoverflow.com/questions/7302384/cgfloat-addition-bug)

我有一个 CGPoint（它只是一个围绕两个 CGFloats 的结构）。有人可以向我解释这两行代码如何：

```
player.position = CGPointMake(player.position.x + 12.8f, player.position.y + 12.8f);
NSLog(@"%f,%f", player.position.x, player.position.y); 
```

正在生成此输出：

```
828.799988,236.800003
841.599976,249.600006
854.399963,262.399994
867.199951,275.199982
879.999939,287.999969
892.799927,300.799957
905.599915,313.599945 
```

该点的起始值为 (816, 224)；

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T23:32:08.297

您在这里处理浮点值。这意味着该边际将存在误差。如果要四舍五入到一定的小数位数，请使用以下代码：

```
NSString *value = [NSString stringWithFormat:@"%.1f", theFloat]; 
```

上面的代码四舍五入到小数点后 1 位，这是您需要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T23:32:07.557

`CGFloat`是 IEEE 754 单精度或双精度浮点数，[存在众所周知的精度问题](http://en.wikipedia.org/wiki/Floating_point#Accuracy_problems)。你所看到的就是这样的效果。

# java - Eclipse - 导出可运行的 JAR 文件（弹出警报）

> ID：13943202
> 
> 赞同：0
> 
> 时间：2012-12-18T23:27:35.083
> 
> 标签：java, eclipse, export, executable-jar

我完全误解了将项目导出到 JAR 的一些事情。

有 2 件事正在发生。

首先，我在导出 Runnable JAR 文件时收到警告：

**导出时带有编译警告：prj.Resources/classes/Person.java**

我的项目名为**prj.HelloWorld**。主要功能在这里。它还引用了另一个项目资源，恰好是**prj.Resources**。**（我将该项目添加到prj.HelloWorld**的 Java 构建路径中）

因此，Person.java 类执行得很好，但我仍然收到编译警告。这个警告是什么意思？

其次，当我双击保存到桌面的 helloworld.jar 文件时，在 MenuBar Items 中看不到任何图像。我从两个项目中调用图标。当我从 Eclipse 内部运行编译器时，一切正常。

- 当我导出 Runnable JAR 文件时，我在库处理选项下选择“将**所需的库提取到生成的 JAR中”。**

我在做什么错，图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:30:55.973

```
Window -> Show View -> Problems 
```

这将打开一个视图，显示程序中的任何问题。警告并不重要，但可能会通知可能已弃用的功能和其他应更改的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:40:37.933

图像位于错误的位置/文件夹中，因此 Eclipse 在构建过程中会忽略它们。如果您没有此文件夹（`src/resources`），请尝试创建它并将您的图像放入其中

# c# - 在装饰器模式中对集合成员进行操作可以吗？

> ID：13943205
> 
> 赞同：2
> 
> 时间：2012-12-18T23:27:41.793
> 
> 标签：c#, oop, design-patterns, decorator, builder

前几天我正在实现一个装饰器，那天晚上晚些时候，我开始怀疑像下面的例子这样的东西是否是装饰器模式的有效表示。

```
public abstract class Foo
{
    public List<string> Names { get; set; }

    public abstract string GetNames();
}

public abstract class BarDecorator : Foo
{
    public abstract String GetNames();
}

public class JustAnOldBar : Foo
{
    public JustAnOldBar() {
        this.Names.Add("An Old Bar");
    }

    public override string GetNames()
    {
        return string.Join(",", this.Names.ToArray());
    }
}

public class SomeDecorator : BarDecorator {
    private Foo foo;

    public SomeDecorator(Foo someFoo) {
        this.foo = someFoo;
    }

    public override string GetNames()
    {
        return string.Join(",", this.Names) + "," + string.Join(",", this.foo.Names);
    }
} 
```

通常，当我实现此模式时，我会查看我正在处理的单个成员，例如成本或描述，但我想知道使用装饰器对集合进行操作是否合适，或者您是否应该开始查看构建器说到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:10:57.183

在装饰器模式中，装饰不依赖于装饰中涉及的字段（如果有的话）。它是关于*修改装饰类的**行为***。如[wiki 定义](http://en.wikipedia.org/wiki/Decorator_pattern#First_Example_.28window.2Fscrolling_scenario.29)中的示例，它可能只是装饰窗口的绘制行为，而不是操作字段或方法的返回值。

简而言之——正如 Wiktor Zychla 评论的那样——这没有问题。

# asp.net-mvc-3 - MVC3 - @readonly="readonly" 在 IE8 下的 textareafor 中无法通过。在其他浏览器中运行良好

> ID：13943210
> 
> 赞同：2
> 
> 时间：2012-12-18T23:28:20.120
> 
> 标签：asp.net-mvc-3, html, internet-explorer-8, readonly

所以我正在使用 MVC3 生成一个 textarea 元素。我使用以下标记生成我的元素：

```
<%=Html.TextAreaFor(model=> model.Description, new { value=Model.Description, @class="readonlyDescription", placeholder = "No " + Model.DescriptionLabel.ToLower() + " provided", @readonly = "readonly", rows = 1, cols = 30}) %> 
```

在 Google Chrome 下生成时，我看到：

```
<textarea class="readonlyDescription" cols="30" id="Description" name="Description" placeholder="No description provided" readonly="readonly" rows="1" value=""></textarea> 
```

在 IE9 下生成时，我看到：

```
<textarea name="Description" class="readonlyDescription" id="Description" rows="1" cols="30" readOnly="readonly" value="" placeholder="No description provided"> 
```

在 IE8 下生成时，我看到：

```
<textarea name="Description" class="readonlyDescription placeholder" id="Description" rows="1" cols="30" readOnly="" value="" placeholder="No description provided" jQuery172027049094255782585="250"> 
```

请注意，我的 readonly 属性已丢失。它去哪儿了？

我也尝试过使用 @readonly = "true" 但没有看到任何不同的效果。

编辑：我怀疑它正在发生，但 IE8 只是将“只读”的存在视为足以启用它。然后，它处理只读的方式与 IE9 不同。因此，我使用 disabled 而不是 readonly 以及使背景透明的附加 CSS（看起来是 readonly 而不是 disabled）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T13:13:14.577

readonly 只有一个值，即 readonly，因此 readonly 属性的存在足以将其呈现为只读是有效的。

禁用相同，只需属性的存在就足够了

在 JS 中，要启用或使控件可编辑，您需要删除这些属性，而不是将它们设置为 true 或 false。

[W3Schools 对此有话要说](http://www.w3schools.com/tags/att_input_readonly.asp)

# ruby - Watir - file_field.exists？即使页面上有上传表单，也会出现错误

> ID：13943212
> 
> 赞同：1
> 
> 时间：2012-12-18T23:28:30.063
> 
> 标签：ruby, watir

我正在查看一个带有覆盖的网页，其中包含选择文件/浏览等按钮 下面是该页面的一个片段

```
<form name = "form1" method = "post" action = "UploadPhoto.aspx?PhotoUploaderFor=1" id = "form1" enctype = "multipart/form-data">
<div>...</div>
<div class = "popup-form photoUploader">
 <div class = "group data-row">
  <label>...</label>
  <input type ="file" name = "FileUpload1" id = "FileUpload1" class = "browse_file"> 
```

Watir 有 file_fields 可以处理我在测试站点 (www.tinypic.com) 上尝试过的文件上传，并且控件在那里工作正常

```
b.file_fields.exists? 
```

将返回真

但是，在我使用上面的片段查看的页面上，

```
 b.file_fields.exists? 
```

返回假

我以为可能是形式的原因，所以我也尝试了

```
b.form(:name => "form1").file_fields.exists? 
```

这也返回 false 如果我尝试直接访问按钮本身，这也返回 false

```
b.element(:xpath => "//input [@name = 'FileUpload1']").exists? 
```

有人有想法么？

编辑

表单位于 iframe 内

```
<iframe id="Step1_Banner1_Popup_Photo_Photo_Iframe_PhotoUploader" class="photoUploaderFrame" scrolling="no" src="../MSReport3/UserControls/UploadPhoto.aspx?PhotoUploaderFor=1">
#document
 <!DOCTYPE html PUBLIC "-//W3C//DTD CHTML 1.0 .....">
  <html xmlns = "http://www.w3.org/1999/xhtml">
   <head>...</head>
   <body>
   <code from above goes here> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T18:23:14.893

注意：我从评论中发布解决方案，以便（希望）可以将这个问题标记为已回答。

覆盖在一个框架内，需要通过方法链指定框架。例如：

```
b.frame(:id => "Step1_Banner_Popup_Photo_Photo_Iframe_PhotoUploader").file_field.exists? 
```

# sql-server - sql查询帮助

> ID：13943215
> 
> 赞同：0
> 
> 时间：2012-12-18T23:28:48.527
> 
> 标签：sql-server, sql-server-2008-r2

我有一个如下的sql：

```
SELECT ib.branch_no,
       ib.on_hand,
       p.weightedav,
       p.item_code,
FROM physical p
INNER JOIN 
       item_branch as ib on p.item_code = ib.item_code
WHERE ib.on_hand <> 0 
```

此 SQL 仅返回那些具有 on_hand <> 0 的 branch_no。

我正在尝试获取所有的 branch_nos，而不考虑 on_hand 字段，但仍然使用 where on_hand 子句。

去掉 on_hand 子句解决了我的问题，但给了我大量不需要的 0 行。

我正在使用 SQL SERVER 2008 R2。

提前感谢您的任何指导。如果我遗漏任何信息，请道歉。

------------------------------整个 SQL 查询（更新）-- ------------------------------------------

```
select  
     ib.branch_no, 
    p.weighted_av,
    p.item_code, 
    p.x_value, 
    p.y_value, 
    ib.on_hand,
    p.on_hand as PhysicalOH,
    ip.price,
    i.item_code as StyleCode, 
    i.description, 
    i.cat1, 
    i.cat2, 
    i.cat3, 
    i.cat4, 
    np.is_style_yn, 
    si.supplier_code ,
            ysv.sort as YSort
from physical  as p
    left outer JOIN 
    item_branch as ib on p.item_code = ib.item_code -- and ib.on_hand <> 0
    INNER JOIN 
    item_price as ip on p.item_code = ip.item_code  and ip.price_type = 'P1'
    INNER JOIN 
    style_values as sv on p.style_code = sv.style_code and p.x_value = sv.value  
    INNER JOIN 
    style_values as ysv on p.style_code = ysv.style_code and p.y_value = ysv.value and ysv.axis = 'Y'  
    INNER JOIN 
    ITEM as i on p.style_code = i.item_code 
    INNER JOIN 
    NON_PHYSICAL as np ON i.item_code = np.item_code and np.is_style_yn = 1
    INNER JOIN 
    supplier_item as si ON i.item_code = si.item_code and si.pref_supp_no = 1
where --ib.on_hand <> 0 and  
sv.axis = 'X' and
i.item_code in 
    (SELECT ITEM.item_code
     FROM ITEM 
            INNER JOIN 
            NON_PHYSICAL ON ITEM.item_code = NON_PHYSICAL.item_code 
            LEFT JOIN
            supplier_item ON Item.item_code = supplier_item.item_code  and  pref_supp_no = 1                        
    WHERE NON_PHYSICAL.is_style_yn = 1 and  ITEM.cat1 = 'Verge Sportswear Ltd' )
order by 
        si.supplier_code, 
        i.cat4, 
        i.cat3, 
        i.cat2, 
        i.cat1,
        sv.sort 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T15:41:46.047

尝试这个：

```
SELECT ib.branch_no,
       ib.on_hand,
       p.weightedav,
       p.item_code,
FROM physical p
INNER JOIN 
       item_branch as ib on (p.item_code = ib.item_code AND ib.on_hand <> 0) 
```

# python - 如何将颜色条添加到这样创建的散点图中？

> ID：13943217
> 
> 赞同：9
> 
> 时间：2012-12-18T23:29:08.967
> 
> 标签：python, matplotlib

我用代码创建散点图，本质上是这样的

```
cmap = (matplotlib.color.LinearSegmentedColormap.
        from_list('blueWhiteRed', ['blue', 'white', 'red']))

fig = matplotlib.figure.Figure(figsize=(4, 4), dpi=72)
ax = fig.gca()

for record in data:
    level = record.level # a float in [0.0, 1.0]
    marker = record.marker # one of 'o', 's', '^', '*', etc.
    ax.scatter(record.x, record.y, marker=marker,
               c=level, vmin=0, vmax=1, cmap=cmap, **otherkwargs)

# various settings of ticks, labels, etc. omitted

canvas = matplotlib.backends.backend_agg.FigureCanvasAgg(fig)
fig.set_canvas(canvas)
canvas.print_png('/path/to/output/fig.png') 
```

我的问题是这样的：

> 我需要在上面的代码中添加什么来获得`cmap`沿绘图右边缘的垂直颜色条（代表 中的颜色图）？

**注意**：我发现 Matplotlib***完全难以理解***，这既适用于它的设计，也适用于它的文档。（不是因为缺乏尝试：我投入了大量的时间、精力，甚至是一些钱。）所以我会很感激完整的、有效的代码（即使它只是一个玩具示例），因为我很可能会赢无法填写省略的细节或修复代码中的错误。

* * *

编辑：我修复了上面“代码草图”中的一个重要遗漏，即每次调用`ax.scatter`. 这就是使用多次调用来创建散点图的原因`ax.scatter`，尽管不可否认，至少可以将调用 scatter 的次数减少到每个使用的 maker 形状一个；例如

```
for marker in set(record.marker for record in data):
    X, Y, COLOR = zip(*((record.x, record.y, record.level)
                        for record in data if record.marker == marker))
    ax.scatter(X, Y, marker=marker,
               c=COLOR, vmin=0, vmax=1, cmap=cmap,
               **otherkwargs) 
```

我尝试扩展相同的技巧以将所有调用`ax.scatter`合并为一个（通过传递一系列标记作为`marker`参数），如下所示：

```
X, Y, COLOR, MARKER = zip(*((record.x, record.y, record.level, record.marker)
                            for record in data))

ax.scatter(X, Y, marker=MARKER,
           c=COLOR, vmin=0, vmax=1, cmap=cmap,
           **otherkwargs) 
```

...但这失败了。错误是这样的（修剪一些长路径之后）：

```
Traceback (most recent call last):
  File "src/demo.py", line 222, in <module>
    main()
  File "src/demo.py", line 91, in main
    **otherkwargs)
  File "<abbreviated-path>/matplotlib/axes.py", line 6100, in scatter
    marker_obj = mmarkers.MarkerStyle(marker)
  File "<abbreviated-path>/matplotlib/markers.py", line 113, in __init__
    self.set_marker(marker)
  File "<abbreviated-path>/matplotlib/markers.py", line 179, in set_marker
    raise ValueError('Unrecognized marker style {}'.format(marker))
ValueError: Unrecognized marker style ('^', 'o', '^', '*', 'o', 's', 'o', 'o', '^', 's', 'o', 'o', '^', '^', '*', 'o', '*', '*', 's', 's', 'o', 's', 'o', '^', 'o', 'o', '*', '^', 's', '^', '^', 's', '*') 
```

AFAICT，tcaswell 的配方*需要*将调用减少`ax.scatter`到一个，但这个要求似乎与我对同一散点图中多个标记形状的绝对要求相冲突。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-19T05:21:57.727

如果您必须为每组使用不同的标记，则必须做一些额外的工作并强制所有标记`clims`相同（否则它们默认从`c`每个散点图的数据的最小值/最大值缩放）。

```
from pylab import *
import matplotlib.lines as mlines
import itertools
fig = gcf()
ax = fig.gca()

# make some temorary arrays
X = []
Y = []
C = []
cb = None
# generate fake data
markers = ['','o','*','^','v']
cmin = 0
cmax = 1
for record,marker in itertools.izip(range(5),itertools.cycle(mlines.Line2D.filled_markers)):
    x = rand(50)
    y = rand(50)
    c = rand(1)[0] * np.ones(x.shape)
    if cb is None:
        s = ax.scatter(x,y,c=c,marker=markers[record],linewidths=0)
        s.set_clim([cmin,cmax])
        cb = fig.colorbar(s)
    else:
        s = ax.scatter(x,y,c=c,marker=markers[record],linewidths=0)
        s.set_clim([cmin,cmax])

cb.set_label('Cbar Label Here') 
```

设置形状边框的`linewidths=0`宽度，我发现对于小形状，黑色边框会压倒填充的颜色。

![彩色散点图](../Images/efaf541250f4fc83c23b98aca8542786.png)

如果你只需要一个形状，你可以用一个散点图来完成这一切，没有必要为每次通过你的循环制作一个单独的形状。

```
from pylab import *
fig = gcf()
ax = fig.gca()

# make some temorary arrays
X = []
Y = []
C = []
# generate fake data
for record in range(5):
    x = rand(50)
    y = rand(50)
    c = rand(1)[0] * np.ones(x.shape)
    print c
    X.append(x)
    Y.append(y)
    C.append(c)

X = np.hstack(X)
Y = np.hstack(Y)
C = np.hstack(C) 
```

一旦将数据全部打入一维数组，制作散点图并保留返回值：

```
s = ax.scatter(X,Y,c=C) 
```

然后，您制作颜色条并将返回的对象`scatter`作为第一个参数传递。

```
cb = plt.colorbar(s)
cb.set_label('Cbar Label Here') 
```

您需要这样做，以便颜色条知道要使用哪个颜色图（地图和范围）。

![在此处输入图像描述](../Images/00ba6231aabd0a89146b12e5adfc1e63.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-21T01:59:50.330

我认为您最好的选择是将您的数据填充到熊猫数据框中，并像这样循环遍历所有标记：

```
import numpy as np    
import pandas as pd
import matplotlib.pyplot as plt

markers = ['s', 'o', '^']
records = []
for n in range(37):
    records.append([np.random.normal(), np.random.normal(), np.random.normal(), 
                    markers[np.random.randint(0, high=3)]])

records = pd.DataFrame(records, columns=['x', 'y', 'z', 'marker'])

fig, ax = plt.subplots()
for m in np.unique(records.marker):
    selector = records.marker == m
    s = ax.scatter(records[selector].x, records[selector].y, c=records[selector].z,
                   marker=m, cmap=plt.cm.coolwarm, 
                   vmin=records.z.min(), vmax=records.z.max())

cbar = plt.colorbar(mappable=s, ax=ax)
cbar.set_label('My Label') 
```

![结果图](../Images/ec47927f1949d49a5e15dd961f5bd0f9.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T02:44:04.620

我认为这应该可以解决问题。我很确定我不久前从一个 matplotlib 食谱示例中抓住了这个，但我现在似乎找不到它......

```
from mpl_toolkits.axes_grid1 import make_axes_locatable

cmap = (matplotlib.color.LinearSegmentedColormap.
        from_list('blueWhiteRed', ['blue', 'white', 'red']))

fig = matplotlib.figure.Figure(figsize=(4, 4), dpi=72)
ax = fig.gca()

for record in data:
    level = record.level # a float in [0.0, 1.0]
    ax.scatter(record.x, record.y,
               c=level, vmin=0, vmax=1, cmap=cmap, **otherkwargs)

# various settings of ticks, labels, etc. omitted

divider= make_axes_locatable(ax)
cax = divider.append_axes("right", size="1%", pad=0.05)
cb = plt.colorbar(cax=cax)
cb.set_label('Cbar Label Here')

canvas = matplotlib.backends.backend_agg.FigureCanvasAgg(fig)
fig.set_canvas(canvas)
canvas.print_png('/path/to/output/fig.png') 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-11-09T14:57:01.390

The answer to this *can* be to only plot a single scatter, which would then directly allow for a colobar to be created. This involves putting the markers into the `PathCollection` created by the scatter a posteriori, but it can be easily placed in a function. This function comes from [my answer](https://stackoverflow.com/a/52303895/4124317) on another question, but is directly applicable here.

Taking the data from @PaulH's [post](https://stackoverflow.com/a/13983289/4124317) this would look like

```
import numpy as np    
import pandas as pd
import matplotlib.pyplot as plt

def mscatter(x,y,ax=None, m=None, **kw):
    import matplotlib.markers as mmarkers
    ax = ax or plt.gca()
    sc = ax.scatter(x,y,**kw)
    if (m is not None) and (len(m)==len(x)):
        paths = []
        for marker in m:
            if isinstance(marker, mmarkers.MarkerStyle):
                marker_obj = marker
            else:
                marker_obj = mmarkers.MarkerStyle(marker)
            path = marker_obj.get_path().transformed(
                        marker_obj.get_transform())
            paths.append(path)
        sc.set_paths(paths)
    return sc

markers = ['s', 'o', '^']
records = []
for n in range(37):
    records.append([np.random.normal(), np.random.normal(), np.random.normal(), 
                    markers[np.random.randint(0, high=3)]])

records = pd.DataFrame(records, columns=['x', 'y', 'z', 'marker'])

fig, ax = plt.subplots()
sc = mscatter(records.x, records.y, c=records.z, m=records.marker, ax=ax)
fig.colorbar(sc, ax=ax)

plt.show() 
```

[![enter image description here](../Images/a8636242c93e865f54a87e08a89edc0c.png)](https://i.stack.imgur.com/b9d2W.png)

# sql - T-sql 中的星期日期范围

> ID：13943218
> 
> 赞同：-1
> 
> 时间：2012-12-18T23:29:10.997
> 
> 标签：sql, sql-server, tsql

```
declare @startdate datetime='11/30/2012',@enddate datetime='12/6/2012'
Select 
Convert(varchar, DateAdd(dd, -(DatePart(dw, @startdate) - 1), @startdate), 101) As WeekStart,
Convert(varchar, DateAdd(dd, (7 - DatePart(dw, @enddate)), @enddate), 101) As WeekEnd 
```

上面是代码，代码的输出是：

```
11/25 2012  12/08/2012 
```

但我想在 2 周内分别显示结果。请问如何以这种格式显示数据？

```
11/25/2012  12/01/2012 ( 1 week)
12/02/2012  12/08/2012 ( 2 week) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:35:45.340

选中[此项](http://msdn.microsoft.com/de-de/library/ms181598.aspx)以设置一周的开始！下面的代码给出了预期的结果。SQL-Fiddle-Link 在底部。

```
declare @startdate  date = '2012-11-30';
declare @enddate    date = '2012-12-06';

with "nums"
as
(
  select 1 as "value"
  union all select "value" + 1 as "value"
  from "nums"
  where "value" <= 52
)
, "intervals"
as
(
  select
  "id" = "value"
  , "startDate" = cast( dateadd( week, "value" - 1, dateadd(year, datediff(year, 0, getdate()), 0)) as date )
  , "endDate" = cast( dateadd( week, "value", dateadd( year, datediff( year, 0, getdate()), 0 )) as date )

from
  "nums"
)
select
    "startDate", "endDate", row_number() over ( order by rand() ) as "number"
from
    "intervals"
where
    "startDate" <= @startdate and "endDate" > @startdate
    or
    "startDate" <= @enddate and "endDate" > @enddate 
```

[见 SQLFiddle](http://sqlfiddle.com/#!3/d41d8/7285/0)

# mysql - 使用 mySQL 从其他行中选择具有多个值的行

> ID：13943223
> 
> 赞同：1
> 
> 时间：2012-12-18T23:29:47.593
> 
> 标签：mysql, sql, database

假设我有下表，名为`data`：

```
ID   foo1     foo2    foo3
1    11       22      33
2    22       17      92
3    31       33      53
4    53       22      11
5    43       23      9 
```

我想选择第一行中任何一个`foo1`或`foo2`匹配`foo3`这些列中的任何一个的所有行。也就是说，我想要至少一个`foo`s 也出现在第一行的所有行。在上面的示例中，我想选择第 1、2、3 和 4 行。我认为我可以使用类似

```
SELECT * FROM data WHERE foo1 IN (SELECT foo1,foo2,foo3 FROM data WHERE ID=1)
                      OR foo2 IN (SELECT foo1,foo2,foo3 FROM data WHERE ID=1)
                      OR foo3 IN (SELECT foo1,foo2,foo3 FROM data WHERE ID=1) 
```

但这似乎不起作用。我当然可以使用

```
WHERE foo1=(SELECT foo1 FROM data WHERE ID=1) 
   OR foo1=(SELECT foo2 FROM data WHERE ID=1) 
   OR ... 
```

但这会涉及很多行，而在我的真实数据集中实际上有 16 列，所以下背部真的很痛苦。有没有更复杂的方法来做到这一点？

另外，如果我还想计算命中数（在上面的示例中，第 1 行获得 4，第 4 行获得 2，第 2,3 行获得 1），我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T23:34:59.503

```
SELECT data.*,
      (data.foo1 IN (t.foo1, t.foo2, t.foo3))
    + (data.foo2 IN (t.foo1, t.foo2, t.foo3))
    + (data.foo3 IN (t.foo1, t.foo2, t.foo3)) AS number_of_hits
FROM   data JOIN data t ON t.id = 1
WHERE  data.foo1 IN (t.foo1, t.foo2, t.foo3)
    OR data.foo2 IN (t.foo1, t.foo2, t.foo3)
    OR data.foo3 IN (t.foo1, t.foo2, t.foo3) 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/ad0ef/2/0)上查看。

实际上，经过反思，您可能会考虑规范化您的数据：

```
CREATE TABLE data_new (
  ID         BIGINT  UNSIGNED NOT NULL,
  foo_number TINYINT UNSIGNED NOT NULL,
  val        INT,
  PRIMARY KEY (ID, foo_number),
  INDEX (val)
);

INSERT INTO data_new
  (ID, foo_number, val)
          SELECT ID, 1, foo1 FROM data
UNION ALL SELECT ID, 2, foo2 FROM data
UNION ALL SELECT ID, 3, foo3 FROM data;

DROP TABLE data; 
```

然后你可以这样做：

```
SELECT   ID,
         MAX(IF(foo_number=1,val,NULL)) AS foo1,
         MAX(IF(foo_number=2,val,NULL)) AS foo2,
         MAX(IF(foo_number=3,val,NULL)) AS foo3,
         number_of_hits
FROM     data_new JOIN (
  SELECT   d1.ID, COUNT(*) AS number_of_hits
  FROM     data_new d1 JOIN data_new d2 USING (val)
  WHERE    d2.ID = 1
  GROUP BY d1.ID
) t USING (ID)
GROUP BY ID 
```

在[sqlfiddle](http://sqlfiddle.com/#!2/e4e90/4/0)上查看。

从执行计划中可以看出，这对于大型数据集将大大提高效率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:42:55.050

有几种方法可以获取结果集。

这是一种方法，（如果您不关心哪个 fooN 与 fooN 匹配，并且还想返回那个“第一”行）。

```
SELECT DISTINCT d.* 
  JOIN ( SELECT foo1 AS foo FROM data WHERE id = 1
          UNION ALL
         SELECT foo2 FROM data WHERE id = 1
          UNION ALL
         SELECT foo3 FROM data WHERE id = 1
       ) f
  JOIN data d
    ON  f.foo IN (d.foo1, d.foo2, d.foo3) 
```

ON 子句也可以这样写：

```
 ON d.foo1 = f.foo
    OR d.foo2 = f.foo
    OR d.foo2 = f.foo 
```

* * *

要获得点击次数的“计数”...

 ~~~~```
SELECT d.id
     , d.foo1
     , d.foo2
     , d.foo3
     , SUM( IFNULL(d.foo1=f.foo,0)
           +IFNULL(d.foo2=f.foo,0)
           +IFNULL(d.foo3=f.foo,0)
       ) AS count_of_hits
  JOIN ( SELECT foo1 AS foo FROM data WHERE id = 1
          UNION ALL
         SELECT foo2 FROM data WHERE id = 1
          UNION ALL
         SELECT foo3 FROM data WHERE id = 1
       ) f
  JOIN data d
    ON  f.foo IN (d.foo1, d.foo2, d.foo3)
 GROUP
    BY d.id
     , d.foo1
     , d.foo2
     , d.foo3 
```~~  ~~* * *

像往常一样，eggyal 是对的。获取命中数实际上要简单得多：我们可以只使用 SUM(1) 或 COUNT(1) 聚合，无需运行所有这些比较，我们已经完成了所有必要的比较。

```
SELECT d.id
     , d.foo1
     , d.foo2
     , d.foo3
     , COUNT(1) AS count_of_hits
  JOIN ( SELECT foo1 AS foo FROM data WHERE id = 1
          UNION ALL
         SELECT foo2 FROM data WHERE id = 1
          UNION ALL
         SELECT foo3 FROM data WHERE id = 1
       ) f
  JOIN data d
    ON  f.foo IN (d.foo1, d.foo2, d.foo3)
 GROUP
    BY d.id
     , d.foo1
     , d.foo2
     , d.foo3 
```~~~~

# iphone - 如何在 iOS 5 上以横向模式显示视频？

> ID：13943225
> 
> 赞同：2
> 
> 时间：2012-12-18T23:29:50.103
> 
> 标签：iphone, objective-c, ipad, ios5

我有一个非常奇怪的问题。我希望视频以横向模式出现，但我似乎无法让它工作。即使我不能让它总是显示风景，至少我希望它显示好，我也做不到！这是我的代码：

```
#import "SplashViewController.h"
#import "MainViewController.h"
#import "MediaPlayer/MediaPlayer.h"

@interface SplashViewController ()
@property (nonatomic, retain) NSTimer *timer;
@end

@implementation SplashViewController
@synthesize timer = _timer;

-(BOOL)shouldAutorotateToInterfaceOrientation:UIInterfaceOrientation)toInterfaceOrientation
{
    return YES;
}

- (id)init
{
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        self = [self initWithNibName:@"SplashViewController_iPhone" bundle:nil];
    } else {
        self = [self initWithNibName:@"SplashViewController_iPad" bundle:nil];
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    [self.navigationController setNavigationBarHidden:YES];
}

- (void)viewDidAppear:(BOOL)animated
{
    [super viewWillAppear:animated];

    NSString *url = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"intro.mp4"];

    playerViewController = [[MPMoviePlayerViewController alloc] initWithContentURL:[NSURL fileURLWithPath:url]];
    [[NSNotificationCenter defaultCenter]
    addObserver:self
    selector:@selector(movieFinishedCallback:)
    name:MPMoviePlayerPlaybackDidFinishNotification
    object:[playerViewController moviePlayer]];

    [playerViewController shouldAutorotateToInterfaceOrientation: UIInterfaceOrientationLandscapeRight];

    [self.view addSubview:playerViewController.view];

    //play movie
    MPMoviePlayerController *player = [playerViewController moviePlayer];
    player.scalingMode = MPMovieScalingModeAspectFill;
    [player play];
}

- (void) movieFinishedCallback:(NSNotification*) aNotification {
    MPMoviePlayerController *player = [aNotification object];
    [[NSNotificationCenter defaultCenter]
    removeObserver:self
    name:MPMoviePlayerPlaybackDidFinishNotification
    object:player];
    [player stop];

    [player.view removeFromSuperview];

    [self loadMainView];
}

- (void)loadMainView 
{
    MainViewController *mainVC = [[MainViewController alloc] init];
    [self.navigationController pushViewController:mainVC animated:YES];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
}

@end 
```

奇怪的事情来了……

如果我在 iPad 上以横向模式启动应用程序，视频会显示如下（请注意，顶部的栏不要比宽度短！：O）

![http://i.stack.imgur.com/kdPUP.png](../Images/dd1ee2cb643c657b398107c0a6ce73e6.png)

如果我然后将 iPad 旋转到肖像，它看起来像这样：

![http://i.stack.imgur.com/iWK68.png](../Images/01257ace41a1fa52acb26568c7ba0bb7.png)

但是，如果我在 iPad 上以纵向模式启动应用程序，视频会显示如下：

![http://i.stack.imgur.com/9NXRY.png](../Images/96a54f6d7a3b9c9e20a8beadd462d17f.png)

如果我然后将 iPad 旋转到横向，它看起来像这样：

![http://i.stack.imgur.com/pW6OK.png](../Images/3aef261202f14412a443f2c0ede71938.png)

太棒了！这个最终图像是我希望视频始终看起来的样子。有什么想法我可能做错了吗？？？

谢谢！

**编辑 1**

好的，通过@Tark 的回答，我能够解决播放器显示问题。现在无论我如何启动应用程序，它都显示良好。感谢那！！现在缺少的是始终横向模式。

我尝试了以下方法：

```
-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation{
    return (toInterfaceOrientation == UIInterfaceOrientationLandscapeLeft || toInterfaceOrientation == UIInterfaceOrientationLandscapeRight);
}

-(BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation{
    return UIInterfaceOrientationIsLandscape(toInterfaceOrientation);
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    if (interfaceOrientation==UIInterfaceOrientationLandscapeRight)
        return YES;
    return NO;
} 
```

我还尝试在 Info.plist 中插入行 Initial interface orientation = Landscape (right home button)

我得到的是，如果我在横向模式下启动应用程序，如果我将 iPad 旋转到纵向，它会保持横向。伟大的！但如果我以纵向模式启动应用程序，视频将以纵向模式显示。一旦我将它旋转到横向，我就无法将它旋转回纵向，这很好，但我不希望它从纵向开始！

**编辑 2**

好吧，现在这更奇怪了。如果我在**iPhone**上试用，效果很好。无论我以横向还是纵向启动应用程序，视频始终以横向显示。

但是，如果我在**iPad**上尝试，则会出现 EDIT 1 中的问题......：S

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T17:11:32.150

当您将其添加为子视图时，您是否尝试过设置`MPMoviePlayerViewController`s 视图的框架？

```
...
playerViewController.view.frame = self.view.bounds;
[self.view addSubview:playerViewController.view];
... 
```

要使应用程序仅在横向模式下运行，您应确保仅在应用程序 plist 中选择了所需的方向。在 Xcode 4 中，目标设置中有一个方便的 Supported Interface Orientations 部分，请确保您只在此处选择横向。如果您仍然有问题，您必须确保在视图堆栈中的所有可见控制器上禁用自动旋转。

![在此处输入图像描述](../Images/67c54b06dbd7df7b0d698c7213bc328b.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T20:20:40.120

[shouldAutorotateToInterfaceOrientation](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instm/UIViewController/shouldAutorotateToInterfaceOrientation%3a)自 iOS 6 起已弃用，您是否尝试过使用[supportedInterfaceOrientations](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/supportedInterfaceOrientations)？

如果您尝试支持 iOS 5 和 6，那么我相信您需要同时使用两者：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
{
    return UIInterfaceOrientationIsLandscape(toInterfaceOrientation);
}

- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscape;
} 
```

我没有测试过这个，所以把它当作它的价值。

# c# - 未安装 SQL 的自定义简单成员资格提供程序 .Net 4.5

> ID：13943227
> 
> 赞同：2
> 
> 时间：2012-12-18T23:30:11.943
> 
> 标签：c#, asp.net-mvc-3

我正在使用 Rest Service 对我的用户进行身份验证，并且不想使用任何类型的本地/远程数据库作为会员提供者。

我在初始化简单会员提供程序时收到此错误。无法初始化 ASP.NET 简单成员资格数据库。

这是我的配置，我将连接字符串部分留空。我需要安装 sql express 才能使其工作吗？

```
<membership defaultProvider="MyMembershipProvider">
  <providers>
    <clear/>
    <add name="MyMembershipProvider"  type="_1822Style.Models.CustomMembershipProvider"/>
  </providers>
</membership> 
```

# android - 设计 Android APK 签名服务器

> ID：13943228
> 
> 赞同：-1
> 
> 时间：2012-12-18T23:30:33.913
> 
> 标签：android, ruby-on-rails-3, apk, signing

我最近接到了一项任务来设计/实现/维护一个 Android APK 签名服务器。我过去从未这样做过，并且可能会在 Rails 中这样做（我的组织是 Rails 商店）。

此签名服务器基本上采用构建提供的 APK，并使用受保护且安全的证书对其进行签名。并且此签名服务器不应允许任何外部访问，除非仅限于特定 IP 地址。

我没有任何编写签名服务器的经验。做过这件事的人会分享他们的经验和一些关于如何设计它的设计模式，所以它是安全的和受保护的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T06:41:46.930

仅通过 IP 进行限制肯定是不够的，至少使用某种形式的用户名/密码身份验证并保留审核日志，这样您就知道谁签署了什么以及何时签署。如果您在 vanilla Ruby 中执行此操作，则将 APK 保存到文件并`jarsigner`作为 shell 命令调用可能是最简单的方法。如果您使用的是 JRuby，则可以使用 Java API 进行实际签名。

你还需要确保至少*只有你的 webapp 可以读取签名密钥。*如果您有很多键，您需要让用户选择使用哪个键或根据组等给他们一个键（一个用于游戏部门，一个用于音乐应用程序部门，等等）。您可能还需要考虑将密钥存储在 HSM 或智能卡中，以确保无法从服务器中提取它们。尽管如此，如果有人破解它，他们将能够签署应用程序，但不能窃取实际密钥（无法撤销）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T00:39:06.107

签署 APK 的过程并不复杂。然而; 服务器的安全性将是 yoru 任务中最困难的部分。简而言之，您应该在您的服务器或某处拥有凭据，以便您可以签署 apk（理想情况下这是安全的）。

学习这个过程的好地方是：http: [//developer.android.com/tools/building/index.html](http://developer.android.com/tools/building/index.html)

# android - 在 Android 浏览器上使用 Sencha Touch Web 应用程序时出现 Ajax 错误

> ID：13943233
> 
> 赞同：0
> 
> 时间：2012-12-18T23:30:56.283
> 
> 标签：android, ajax, extjs, sencha-touch, android-browser

我的 Sencha Touch 2.1 网络应用程序在 iOS 浏览器、谷歌 Chrome 和桌面浏览器上运行良好。但是，在本机 android 浏览器上，我无法进行任何 Ajax 调用。它只是给我一个错误：

未捕获的类型错误：无法读取未定义的属性“连接”。

Web 应用程序在 Android 上使用 Google chrome 时运行良好，但在本机 android 浏览器上却不行。手机的安卓版本是4.0.3。

以前有人经历过吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T06:45:24.637

要在 Android 4 中处理 Ajax 调用，您需要设置以下内容：

```
Ext.Ajax.setDisableCaching(false); 
```

还要在 Ext.Loader 中设置，例如：

```
Ext.Loader.setConfig({
    enabled: true,
    disableCaching: false
}); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-04T14:14:13.593

要使 sencha touch ajax 工作，请检查以下内容：

*   Ajax 使用具有相同域和协议（http 或 https）的 URL。
*   服务器响应内容类型必须是 text/html。

祝你好运。

# vim - vim中的紫色线条

> ID：13943235
> 
> 赞同：4
> 
> 时间：2012-12-18T23:31:15.653
> 
> 标签：vim

我以前在 vim 中从未见过这个（尽管直到现在我还没有真正使用它），并且在谷歌搜索“紫线 vim”中找不到任何东西。

那么此屏幕截图中显示的紫色线条是什么意思？

![vim中的紫色线条](../Images/30e1cff85642f9e45608ee6ec7b4cfe9.png)

我刚刚查看了该项目中的其他一些文件，其中包含类似的 PHP 代码，但在任何地方都找不到紫色线...

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T23:32:49.907

这些行在这里是因为它是一个 HTML 链接。您的文本位于标签之间。

# image - 自适应图像/GD转换的透明PNG具有黑色边框

> ID：13943241
> 
> 赞同：0
> 
> 时间：2012-12-18T23:32:14.037
> 
> 标签：image, image-processing, png, gd, responsive-design

我最近刚刚尝试了[自适应图像](http://adaptive-images.com/)。

它似乎工作正常，除非在转换透明 PNG 时。我有一个图像，它只是透明背景上的一个弯曲的白色形状。当图像被自适应图像转换（我相信它使用 GD 库进行转换）时，白色形状的边缘会出现黑色边框。

下面是带有黑色边框的弯曲边缘的屏幕截图，因此您可以了解我的意思。

原始尺寸 1920x63：http: [//i.imgur.com/Cc0hJ.png](https://i.imgur.com/Cc0hJ.png)

![在此处输入图像描述](../Images/7c47340c8d805aae3e8e8449acefa212.png)

我不太了解 GD 库或它如何转换图像，但我确实做了一些搜索，看看它是否是我的目标。我不认为它是。

我还发现了关于同一问题的[类似帖子。](https://stackoverflow.com/questions/11620462/why-does-this-transparent-png-cause-borders-when-combined-using-gd)但是，我尝试编辑 Adaptive Images PHP 以使用@WouterH 建议的答案，但它没有用。他建议创建一种透明颜色，并在复制之前用该颜色填充 $image。代码如下：

```
$transparent = imagecolorallocatealpha($image, 0, 0, 0, 127);
imagefill($image, 0, 0, $transparent);
imagealphablending($image, true); 
```

在adaptive-images.php 文件中，我找到了以下代码行：

```
imagealphablending($dst, false);
imagesavealpha($dst,true);
$transparent = imagecolorallocatealpha($dst, 255, 255, 255, 127);
imagefilledrectangle($dst, 0, 0, $new_width, $new_height, $transparent); 
```

这是我进行更改的地方。我尝试了很多变化，因为我不确定正确的顺序是什么，但在大多数情况下，我尝试将其调整为以下内容：

```
imagesavealpha($dst,true);
$transparent = imagecolorallocatealpha($dst, 0, 0, 0, 127);
imagefill($image, 0, 0, $transparent);
imagealphablending($dst, true); 
imagefilledrectangle($dst, 0, 0, $new_width, $new_height, $transparent); 
```

这似乎没有任何区别。根据我尝试的不同方法，我要么为以前透明的任何地方填充黑色，要么仍然存在相同的问题（黑色轮廓）。

希望有人可以帮助我解决这个问题...在此先感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T11:32:11.740

恕我直言，这与此处描述的问题相同：“您拥有的不是具有 alpha 通道的真彩色 PNG，而是具有透明颜色的索引颜色 PNG。” [PHP GD调整透明图像大小给黑色边框](https://stackoverflow.com/questions/8141131/php-gd-resizing-transparent-image-giving-black-border)

# pivot - 为什么以及如何选择不好的枢轴选择使快速排序 O(n^2)？

> ID：13943251
> 
> 赞同：0
> 
> 时间：2012-12-18T23:33:22.770
> 
> 标签：pivot, quicksort

例如，当枢轴是数组中的最高值或最低值时。

对于使用 2 个指针的快速排序，1 个从左端到右，另一个从右端到左，当指针发现一个元素相对于枢轴不合适时，指针停止，当两者都停止时，它们交换元素并继续从那个位置开始。但是，为什么一个糟糕的枢轴选择会导致快速排序 O(n^2)？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T00:02:39.623

> 一个糟糕的枢轴选择如何使快速排序 O(n^2)？

假设您总是选择最小的元素作为您的支点。快速排序的顶级迭代将需要`n-1`比较，并将数组拆分为两个子数组：一个是 size `1`，一个是 size `n-1`。第一个已经排序，您可以递归地将快速排序应用于第二个。拆分第二个将需要`n-2`比较。等等。

总的来说，你有`(n-1) + (n-2) + ... + 1 = n * (n-1) / 2 = O(n^2)`比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:52:58.963

尝试一个具有 n 倍相同数字的列表。
选择任何方式来找到一个privot。
看看发生了什么。

（编辑：做一些提示：
枢轴不依赖于找到枢轴的方式，因为它总是相同的。
因此，在每次迭代中，对于具有 n 个元素的当前列表，您将需要 n 比较，并且您将拆分在两个具有 1 个和 n-1 个元素的子列表中包含 n 个当前元素的列表。
您可以快速计算总体操作数。您需要`n, n-1, n-2, ..., 2, 1`操作。
形式上，它是`sum from i=1 to n over i`，您应该知道一个公式才能看到它`O(n*n)`）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T23:45:10.403

If your chosen pivot happened to be the maximal value in your subset on every recursion, the algorithm would simply move every record read into the subset below the pivot, and continue on with only one non-empty partition. This new subset's size would be only one less.

In that case, the quicksorts operation would be similar to a selection sort. I would find a maximal value, put it where it goes, and move on to the rest of the data in the next iteration. The difference being that the selection sort searches for the maximal (or minimal) data point, where the worst-case quicksort would happen to select the maximal value and then discover that it is, indeed, the maximum.

This is a quite rare case, to my knowledge.

# c++ - 重载 I/O 运算符时的 C++ unicode 框字符绘制

> ID：13943255
> 
> 赞同：0
> 
> 时间：2012-12-18T23:33:52.747
> 
> 标签：c++, unicode, c++11, console, iostream

我刚刚阅读了[Joel 在 unicode 上的博客文章，并](http://www.joelonsoftware.com/articles/Unicode.html)[在 unicode 网站的这个 pdf 中](http://www.unicode.org/charts/PDF/U2500.pdf)找到了我想用来在控制台中绘制框的字符。

直接使用 显示这些字符很简单`cout`，即下面的内容是它应该做的..

```
 cout << u8"\u256C"; 
```

但是，我正在做一些重载，如下面的片段所示，我无法弄清楚如何让框字符正确显示。

我像这样渲染我的数据......

```
// This is the main rendering code
ostream& operator<<(ostream& os, const DataGrid& dg)
{
    for(auto row : dg.data)
    {
        string tmp; //Make empty string
        for(auto col : row)
            tmp.append(   1, dg.gfxString[col]  );
        os << tmp << endl;
    }

    return os;
} 
```

与我的数据模型成为朋友...

```
class DataGrid
{
public:
    friend ostream& operator<<(ostream& os, const DataGrid& dg);

    //EDIT: rest of class added on request
    DataGrid(Rectangle _rect = Rectangle(Point(0,0), Point(5,5))) :
    rect(_rect),
    data ( vector<vector<p_t>> (_rect.getHeight(), vector<p_t>(_rect.getWidth(), p_t::EMPTY))  ){}

    void addPoint(Point p, p_t type)
    { 
        data[p.getY()][p.getX()] = type;
    }

    void addBorder()
    {
        //Top and bottom
        fill_n(data[0].begin()+1, rect.getWidth()-2, p_t::BORDER_T);
        fill_n(data[rect.getBtm()].begin()+1, rect.getWidth()-2, p_t::BORDER_B);

        //Left and right hand border edges
        for (int nn=1; nn<rect.getHeight()-1; ++nn){
            addPoint(Point(rect.getLeft(), nn), p_t::BORDER_L);
            addPoint(Point(rect.getRight(), nn), p_t::BORDER_R);
        }

        //Corners
        addPoint(rect.getTL(), p_t::BORDER_TL);
        addPoint(rect.getTR(), p_t::BORDER_TR);
        addPoint(rect.getBL(), p_t::BORDER_BL);
        addPoint(rect.getBR(), p_t::BORDER_BR);
    }

private:
    Rectangle rect;
     vector<vector<p_t>> data; //p_t is an enum

    //string gfxString = " abcdefghijklmnop"; //This works fine
    string gfxString = u8"\u256C\u256C\u256C\u256C\u256C\u256C\u256C\u256C"; //Nope     
}; 
```

然后尝试使用以下内容渲染它，但会胡言乱语......

```
DataGrid p = DataGrid(Rectangle(Point(0,0), 40, 10));
p.addBorder();
cout << p; 
```

如果有人能找到解决办法，那就太好了。谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:29:47.180

我会将 gfxString 更改为 std::strings 的向量（甚至是 std::array）：

```
// Probably in the final code, these are not all the same value
std::array<std::string, 8> gfxString = {
   { u8"\u256C"
   , u8"\u256C"
   , u8"\u256C"
   , u8"\u256C"
   , u8"\u256C"
   , u8"\u256C"
   , u8"\u256C"
   , u8"\u256C"
   }}; 
```

甚至只是一个数组`const char*`。

# javascript - 在 onclick 属性中使用 javascript

> ID：13943260
> 
> 赞同：1
> 
> 时间：2012-12-18T23:34:38.070
> 
> 标签：javascript, html, forms, onclick

我早些时候发布了一个问题并得到了答案，感谢这里的好人，但幸运的是，它从来没有那么容易。我有一个代码可以在图片 onclick 之间来回切换，但是，第一次单击时，图片不会切换，但选中了复选框。至少推理会很棒:)

```
<script type="text/javascript">
function func()
{
    var img1= document.getElementById("img1");

    if(img1.name == "on")
    {
        img1.src = "images/" + "img1a.jpg";
        img1.name = "off";
    }
    else
    {
        img1.src = "images/" + "img1.jpg";
        img1.name = "on";
    }
}
</script>

</head>

<body>
<form>
<p align="center">
<input type="checkbox" name="interest1" id="interest1" value="x">
<input type="checkbox" name="interest2" id="interest2" value="x">
<input type="checkbox" name="interest3" id="interest3" value="x"></p>   
<p align="center">
<label for="interest1" id="label-interest1"><img src="images/img1.jpg" width="781" height="800" onclick="func()" id="img1" /></label>
<label for="interest2" id="label-interest2"><img src="/images/img2.jpg" width="781" height="800" /></label>
<label for="interest3" id="label-interest3"><img src="/images/img3.jpg" width="781" height="800" /></label></P><!-- code making checkbox be an image-->
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:38:00.117

您缺少“开”的第一个状态。尝试将此添加到您的标记中

```
 <img src="images/img1.jpg" width="781" height="800" onclick="func()" name="on" id="img1" /> 
```

相反，您可以在 javascript 中的条件语句中处理此问题，如下所示：

```
if(img1.name === undefined || img1.name == "on") 
```

这将处理不存在名称属性的第一个状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:46:08.620

由于您的`img`元素没有`name`属性，因此第一次单击它时它与“on”条件不匹配。您可以添加一个名称属性（这会起作用，但会使 html 无效），但更好的解决方案可能是从与之关联的复选框中获取值。像这样的东西：

```
var checkboxid = img1.parentNode.getAttribute("for");
document.getElementById(checkboxid).checked 
```

这样，您可以*确保*它与复选框保持同步。

# lucene.net - 在字段中返回具有最高 DateTime 值的文档的最有效方法

> ID：13943262
> 
> 赞同：1
> 
> 时间：2012-12-18T23:34:46.210
> 
> 标签：lucene.net

我有一个带有文档的 lucene 索引——它们都包含存储 DateTime 值的字段。什么是推荐/最有效的方法来提取具有最高价值的文档。整数值的外观如何？当然，我假设使用`DateTools.DateToString`或类似方法将值转换为字符串。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T01:30:25.783

详细说明 Jf Beaulac 的答案，此类代码的示例可能如下所示。请注意，“CreatedAt”字段用于存储 DateTime 值。

```
//providing query that will not filter any documents
var query = new TermRangeQuery("CreatedAt", DateTools.DateToString(DateTime.MinValue, DateTools.Resolution.MINUTE), DateTools.DateToString(DateTime.MaxValue, DateTools.Resolution.MINUTE), false, false);

//providing sorting on 'CreatedAt' and returning just one result
var createdAtSerchResults = searcher.Search(query, null, 1, new Sort(new SortField("CreatedAt", SortField.LONG, true)));

//extracting CreatedAt value from returned document
var documentWithMaxCreatedAt = searcher.Doc(createdAtSerchResults.ScoreDocs.First().Doc);

var result = DateTools.StringToDate(documentWithMaxCreatedAt.Get("CreatedAt")); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T03:30:24.893

只需在包含日期的字段上发出降序号`Query`。`Sort`

使用带有`Sort`in 参数的 Search 方法，如下所示：

[IndexSearcher.Search（查询、过滤器、整数、排序）](http://lucene.apache.org/core/old_versioned_docs/versions/3_0_3/api/core/org/apache/lucene/search/Searcher.html#search%28org.apache.lucene.search.Query,%20org.apache.lucene.search.Filter,%20int,%20org.apache.lucene.search.Sort%29 "IndexSearcher.Search（查询、过滤器、整数、排序）")

# api - 我可以使用什么 Twitter API 调用来返回具有一定范围的追随者（例如<10k）的用户？

> ID：13943266
> 
> 赞同：0
> 
> 时间：2012-12-18T23:35:01.457
> 
> 标签：api, web-applications, twitter

我想返回一个用户列表，这些用户在请求中指定了 Twitter 关注者的范围。例如，我想返回关注者超过 5000 人但少于 20000 人的用户。如果有的话，我怎么可能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T03:17:00.660

没有 Twitter API 调用可以做到这一点。您可以通过 id 或屏幕名称请求用户，但不能通过他们拥有的关注者数量。

# objective-c - 没有在带有 ARC 的 Objective-C++ 中发布的对象

> ID：13943267
> 
> 赞同：1
> 
> 时间：2012-12-18T23:35:52.253
> 
> 标签：objective-c, automatic-ref-counting, objective-c++

在 Objective-C++ 类中创建对象时，我发现行为有所不同。

如果我使用 dictionaryWith 和 numberWith 创建一个`NSDictionary`包含`NSNumber`对象，那么这些对象永远不会被释放。如果我使用`alloc`and创建它们`initWith`，那么它们就会被清理得很好。

我没有在同一个项目的 Objective-C 类中看到这一点。该项目已启用 ARC。我正在使用 Xcode 4.5.2 中的分配分析工具，查看`CFNumber`和 __的“# Living”值`NSDictionaryl`。

```
// These objects will NOT be released.
NSDictionary* dict1 = [NSDictionary dictionaryWithObjectsAndKeys:
  [NSNumber numberWithUnsignedInt:val1], @"val1",
  [NSNumber numberWithUnsignedInt:val2], @"val2",
  [NSNumber numberWithUnsignedInt:val3], @"val3",
  nil];    
dispatch_async(dispatch_get_main_queue(), ^{
  [[NSNotificationCenter defaultCenter]
  postNotificationName:KEY_NET_STATS_VIEW_UDATE object:nil userInfo:dict1];
});

// These objects *will* be released.
NSDictionary* dict2 = [[NSDictionary alloc] initWithObjectsAndKeys:
  [[NSNumber alloc] initWithUnsignedInt:val1], @"val1",
  [[NSNumber alloc] initWithUnsignedInt:val2], @"val2",
  [[NSNumber alloc] initWithUnsignedInt:val3], @"val3",
  nil];    
dispatch_async(dispatch_get_main_queue(), ^{
  [[NSNotificationCenter defaultCenter]
  postNotificationName:KEY_NET_STATS_VIEW_UDATE object:nil userInfo:dict2];
}); 
```

使用 alloc/initWith 编写代码对我来说没有问题，但我想了解为什么会有差异。我读过的所有内容都表明它们在 ARC 下应该是等效的。

调用此代码时的堆栈跟踪。以下所有内容都是C ++，顺便说一句。

```
#0  0x001fbbe4 in ItRtpSessionManageriOS::OnItRtpOutgoingStatsUpdate(ItRtpSession&, ItRtpSessionManager::ItRtpStats const&)  
#1  0x0007018a in CSceApp::OnItRtpOutgoingStatsUpdate(ItRtpSession&, ItRtpSessionManager::ItRtpStats const&)  
#2  0x0006b808 in ItRtpSession::CallStatsUpdateCallback(ItRtpSessionManager::ItRtpStats const&)  
#3  0x0006ab1e in ItRtpSessionSharedCommXYZ::UpdateOutgoingStats(unsigned long, unsigned long)  
#4  0x0006a958 in ItRtpSessionSharedCommXYZ::Update(unsigned int, unsigned int)  
#5  0x000764ca in CSceApp::EvTimerServiceMgrAwaken(bool, unsigned int, void*)  
#6  0x00076908 in non-virtual thunk to CSceApp::EvTimerServiceMgrAwaken(bool, unsigned int, void*)  
#7  0x002a0134 in xyz::CServicingThread::Activate(unsigned long long, bool*)   
#8  0x0029fb98 in xyz::CServicingThread::Behavior()  
#9  0x0029fc34 in non-virtual thunk to xyz::CServicingThread::Behavior()  
#10 0x002578de in xyz::CAliveObj::StartMechanism(void*)  
#11 0x00259f9e in xyz::CThread::ThreadEntry(void*)  
#12 0x348b5310 in _pthread_start ()  
#13 0x348b51d8 in thread_start () 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:27:29.470

在 ARC 下，有两种利用自动释放池的机制 - 作为运行循环的一部分，并使用 @autoreleasepool 绑定到范围。在第一种情况下，池仅在 runloop 结束时耗尽，或者当自动释放池超出范围时，在第二种情况下。

所以，如果你不让 runloop 运行，你放在那里的任何东西都不会被耗尽。同样，如果您在某处使用 @autoreleasepool 但没有退出该范围 - 也许您正坐在某个地方的紧密循环中，或者在范围内阻塞 - 那么您将看不到池耗尽。

鉴于此，您应该查看您的代码，看看是否发生了这种情况。不幸的是，除非您发布更多代码，否则我们将无法帮助您查明问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:48:43.473

`init...`当您在 ARC 中使用方法时，`release`将在编译时对该对象的最后一次引用之后插入一个调用。如果您在初始化后没有`dict2`在该块中引用，它将像下面的 pre-ARC 代码一样编译：

```
NSNumber *n1 = [[NSNumber alloc] initWithUnsignedInt:val1];
NSNumber *n2 = [[NSNumber alloc] initWithUnsignedInt:val2];
NSNumber *n3 = [[NSNumber alloc] initWithUnsignedInt:val3];
NSDictionary* dict2 = [[NSDictionary alloc] initWithObjectsAndKeys:
  n1, @"val1",
  n2, @"val2",
  n3, @"val3",
  nil];
[n1 release];
[n2 release];
[n3 release];
[dict2 release]; 
```

（如果你想保留它，你需要对它进行强引用）

相比之下，当您使用类似的类方法时`dictionaryWithObjectsAndKeys:`，您（通常）会得到一个自动释放的对象。它将在运行循环结束时释放。如果您在创建自动发布的字典后立即记录它，它仍然存在并且有效。

# git - 在github的评论中自动将修订号添加到git

> ID：13943269
> 
> 赞同：0
> 
> 时间：2012-12-18T23:36:18.523
> 
> 标签：git, github, autocommenting

> **可能重复：**
> [是否可以使用 git / github 添加版本号](https://stackoverflow.com/questions/6920548/is-it-possible-to-add-a-version-number-using-git-github)

我在 github 上托管了一个 git 存储库。

是否可以在我的脚本开始时将修订添加到评论中，所以每次我提交一个新版本时，这个数字都会被计算在内？

如果最后一次提交的日期显示在评论中，它也会很棒。

# android - android中的媒体播放器可以播放项目文件中的音乐文件吗？

> ID：13943270
> 
> 赞同：0
> 
> 时间：2012-12-18T23:36:20.530
> 
> 标签：android

如果可能的话，我需要知道媒体播放器是否可以访问存储在其中的 mp3 文件，`getFilesDir()` 请告诉我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:40:34.653

您正在寻找`getFilesDir()`，因为它允许编辑您的文件并且它是您的应用程序的本地文件。但是，在卸载应用程序时，该目录将被删除。

如果您不需要修改文件，该`res/raw`文件夹可以很好地工作。

# opengl - 用于 3D 数学的 GPGPU

> ID：13943272
> 
> 赞同：0
> 
> 时间：2012-12-18T23:36:29.610
> 
> 标签：opengl, opencl, gpgpu, gpu

我正在阅读很多关于 gpgpu 的内容，并且我目前正在学习 OpenGL。现在我必须自己编写所有数学（或使用现有的第 3 方库），我有了使用 gpu 而不是 cpu 来创建自己的数学库的想法。（矩阵向量等）

但我没有找到任何使用 gpu 的 3d 数学库。

有具体原因吗？

也许 CPU 更擅长这些任务？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T01:13:26.973

这取决于您一次要处理多少个向量或矩阵，以及您是否要绘制结果。

GLSL（OpenGL Shading Language）已经内置了一个数学库。它具有矩阵数学、转置、逆运算的函数和运算符；矢量点和叉积；将向量乘以矩阵等。

当您使用 OpenGL 绘制几何图形或其他内容时，您可以在 GPU 上的着色器中使用这些内置函数。在 3d 数学库中复制已经存在的东西是没有意义的。

如果您想在不绘制任何东西的情况下进行小规模矢量/矩阵数学运算，例如射线 - 平面相交测试，那么 CPU 会更好。将值复制到 GPU 并将结果复制回来将比仅在 CPU 上进行数学运算花费更长的时间。（即使 GPU 实际上更快 - 今天的典型速度是 CPU 2Ghz+，GPU < 1Ghz。）这就是数学库只使用 CPU 的原因。

如果您想在不绘图的情况下进行“工业规模”矩阵/矢量数学运算，那么值得考虑 GPU。（这就是 CUDA 和 OpenCL 存在的原因。）使用支持变换反馈和纹理缓冲区对象（通常是 V3+）的现代 OpenGL 版本，您可以在 GPU 上对数百到数千个矩阵/向量进行数学运算，而 OpenGL 4.3 甚至可以做到这一点使用计算着色器更容易。它不如 CUDA/OpenCL 方便或高效，但如果您已经了解 OpenGL，它会容易得多。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:41:06.817

寻找 CUDA 推力作为起点。我认为 GPU 将非常适合这项任务。CPU 上的 SIMD 也可以进行研究，但不会提供您希望的那么多并行性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T04:19:53.270

你可以试试[arrayfire](http://www.accelereyes.com/arrayfire/c/)。最多支持4个维度，对常用功能有很多支持。目前仅支持 cuda，但不久将使用相同的界面添加对 opencl 的支持（我在 Accelereyes 工作，所以我知道这一点）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-21T07:43:56.293

你想做什么样的操作？您可以将 OpenCL 内置 float4 及其默认运算符（+、-、*、/、点、sqrt）用于 Vector3 或 Vector4。您可以使用四元数和矩阵轻松扩展它，这就是我们所做的。

见[http://github.com/erwincoumans/experiments](http://github.com/erwincoumans/experiments)

该代码可以帮助您学习 OpenCL 以及 OpenGL 和 OpenCL-OpenGL 互操作。

我的 github 存储库包含简单的四元数 3d 数学函数、3d 矢量和 3x3 矩阵，用于我们的 3D Bullet 游戏物理库的 OpenCL 版本。它还具有快速基数排序、前缀扫描、碰撞检测算法和刚体动力学，100% 在 GPU 上运行。它可以在 NVIDIA、AMD、Intel Windows 和 Mac OSX 上运行。 [https://github.com/erwincoumans/experiments/blob/master/opencl/primitives/AdlPrimitives/Math/MathCL.h](https://github.com/erwincoumans/experiments/blob/master/opencl/primitives/AdlPrimitives/Math/MathCL.h)

# c++ - 删除指针数组的正确方法

> ID：13943275
> 
> 赞同：3
> 
> 时间：2012-12-18T23:36:55.423
> 
> 标签：c++, free

我有一个指针数组（我通过调用创建`new ptr*[size]`）。所有这些指针都指向一个也放在堆上的对象。

删除数组和所有新 ptr 的正确方法是什么？

这就是我现在所做的：

```
for (int i = 0; i < size; i++) delete array[i];
delete[] array; // Not sure since this double deletes array[0] 
```

这会做我认为应该做的吗？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-18T23:42:37.317

每个分配的指针`new`都有一个对应的`delete`. 每个分配的指针`new []`都有一个对应的`delete []`. 这就是你需要知道的一切。当然，当您有一个包含动态分配指针的动态分配数组时，释放必须以相反的顺序发生。

因此，正确的成语应该是......

```
int main()
{
    int **container = new int*[n];
    for(int i = 0; i < n; ++i)
        container[i] = new int[size];

    // ... and to deallocate...
    for(int i = 0; i < n; ++i)
        delete [] container[i];

    delete [] container;
} 
```

然后我当然会说“停止这样做”并建议您使用`std::array`or `std::vector`（模板类型为`unique_ptr<int>`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T23:38:34.207

是的，这是你认为应该做的。既然你`new`对每个元素都做了，你就必须对`delete`每个元素。而且由于您`new[]`对整个数组进行了操作，因此您需要对`delete[]`整个数组进行操作。

正如@djechlin 在评论中正确所说的那样，没有足够的信息继续下去，但我假设您之前的代码是这样的：

```
int** array = new int*[5];
for (int i = 0; i < 5; i++) {
  array[i] = new int;
} 
```

请注意，数组实际上不是数组类型。它是一个“指向 int 指针的指针”，它指向的指针数组是用`new[]`. 这就是为什么你需要`delete[]`它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T23:44:34.960

是的。首先你必须释放数组中每个指针指向的对象，然后你必须释放数组本身。以该顺序。如果您颠倒顺序，您将没有对对象的引用，并且会泄漏大量内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T23:42:15.417

是的，首先删除数组元素指向的每个对象，然后删除指针数组本身。如果要检查内存管理，可以使用[valgrind](http://valgrind.org/ "瓦尔格林")之类的工具，它们将能够发现大多数错误。

# html - HTML：将跨度文本水平对齐到图像

> ID：13943276
> 
> 赞同：0
> 
> 时间：2012-12-18T23:36:59.820
> 
> 标签：html, css

我正在尝试将跨度文本与图像水平对齐：

```
<div >
      <img src="c:\work\img\logo3.jpg" width="80" height="80" />
      <span><ul>YAD<li>HIM</li></ul></span>
    </div> 
```

插入文字的原因`<ul>`是实现换行。

更多参考：http: [//jsfiddle.net/himanshuy/4LKhX/](http://jsfiddle.net/himanshuy/4LKhX/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:39:40.433

要使它们居中对齐，请添加`text-align: center;`和`div.box`删除`margin-left`from `span`。也添加`display: block;`到`span`，然后你可以摆脱`<ul>YAD<li>HIM</li></ul>`混乱。

小提琴：http: [//jsfiddle.net/W6ATN/](http://jsfiddle.net/W6ATN/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:52:15.740

试试这个：http: [//jsfiddle.net/W6ATN/8/](http://jsfiddle.net/W6ATN/8/)

```
div.box {
  background-color: #000000;
  color: #FFFFFF;
  width: 300px;
  height: 400px;
  text-align: center;
}
span {
  //margin-left: 10%;
  font-size: 30px;
  color: red;
  clear:both;
  display: block;
}
#mymessage{
       padding-top: 50%;
} 
```

# perl - Shell 脚本或 Perl 来抓取日志文件以进行数据处理？

> ID：13943277
> 
> 赞同：0
> 
> 时间：2012-12-18T23:36:59.360
> 
> 标签：perl, bash

我正在尝试决定使用哪种语言来编写一个脚本，该脚本将从服务器应用程序中“抓取”日志文件。脚本的一般算法将类似于（当然仍然会散列所有小细节）：

```
1\. Search for any line that contains (ACK_STRING, PARTIAL_FILL_STRING, or COMPLETE_FILL_STRING) and not AUTO_HEDGER_STRING
2\. For each result
{
    Extract time, order ID, symbol, status, theo, price from line

    Get intermediate edge value
        If buy, edge = (theo - price)
        Else, edge = (price - theo)

    If order ID not found in order ID -> orderquoteinfo structure
    {
        Add (edge * qty of order) to total edge
    }

    Add edge to total edge received
        Add (edge * qty filled) to total edge received

    Store info in order ID -> orderquoteinfo structure
}

3.
For each order ID -> orderquoteinfo structure
{
    Print results in CSV format

    Time, Order ID, Symbol, Status, B/S, Qty, Price, Theo, Edge
}

4\. Print total edge missed
    Print total edge - total edge received

5\. Print total edge received 
```

因此，本质上，我想使用类似于 C++ 中的映射或 Perl 中的关联数组的数据结构来保存从日志文件的每一行中抓取的信息。我对 shell 脚本不太熟悉，但我想看看什么语言在这里有意义。我从中提取日志的服务器应用程序驻留在 Linux 服务器上（而且它很快就会被移植到另一个平台的可能性很小）。所以 Perl 的可移植性因素并没有在我的脑海中发挥作用。

对我来说，我只是更熟悉编写 Perl 脚本而不是 shell 脚本。但是，如果在这里这样做更有意义，我想编写一个 shell 脚本。该脚本将作为计划任务每​​天运行一次（给予或接受）。基本上，该脚本只是作为一种轻松从日志文件中获取指标数据的方式。我使用术语“抓取”是因为我将在日志文件中搜索最不可能更改但仍然存在风险的特定字符串。

那么，我应该编写一个 shell 脚本还是使用 Perl？什么更有意义？这里重要吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T23:43:21.253

### Perl

* * *

Actually, I was tempted to say: "*Shell or Perl?* Easy, use Ruby", which is why subjective questions like this tend to get closed.

But a hopeless cause is somehow intriguing so I will attempt a serious answer: you can certainly write complicated things as shell code, but, compared to a real language like Perl, the effort is greater and the results are inferior.

Use Perl.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T23:41:37.300

Perl 确实是您所需要的。毕竟 PERL 的意思是“实用提取和报告语言”。

来自维基百科：“Perl 最初是由 Larry Wall 在 1987 年开发的，作为一种通用的 Unix 脚本语言，以**使报告处理更容易**”。所以处理这种数据是 Perl 的第一个目标。它做得很完美。

使用 shell 脚本处理日志会比 Perl 和正则表达式更痛苦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T04:05:29.127

这是我用来实时监控我的网络服务器日志的脚本的一部分，我相信它可以很容易地重写来做你需要的事情。应该注意的是，`File::Tail`如果您只监视脚本中的一个日志文件，这可能是一个更好的选择。

此代码将读取包装在两个 while 循环中，其中内部 while 循环检查每个文件的新行，而外部 while 循环检查新文件。您可能想要使用其他东西，而不是`while (1) { }`让它实际移动。

```
#!/usr/bin/perl
use warnings;
use strict;
use File::Tail::Multi;

while (1)
{
        my $reloadtime = time();

        my $file=File::Tail::Multi->new(
                Function        =>      \&parseline,
                LastRun_File    =>      '/var/autoblock.runtrack',
                Files           =>      ["/var/log/www/*/access.log"],
                RemoveDuplicate =>      0,
                NumLines        =>      0,
        );

        while (1)
        {
                $file->read;
                sleep 2;
        }
        sleep 2;
}

sub parseline()
{
        my $ref = shift;
        foreach ( @{$ref})
        {
         # Do stuff with each line here. The line is stored in $_
        }
} 
```

# c++ - C++模板运算符编译错误

> ID：13943280
> 
> 赞同：4
> 
> 时间：2012-12-18T23:37:19.497
> 
> 标签：c++, visual-studio-2010, templates, operators

我正在尝试制作一个类似于 的 C++ 类 `std::ostream`，它将接受其输入并写入`std::ostream`构造函数中给定的两个 s。这是与适当的`operator<<`模板一起：

```
struct SplitStream
{
    SplitStream(std::ostream & a_, std::ostream & b_) : a(a_), b(b_) {}
    std::ostream & a, & b;
};

template<class T>
const SplitStream & operator << (const SplitStream & sp, const T & x)
{
    sp.a << x;
    sp.b << x;
    return sp;
} 
```

该代码下面的几行，我尝试使用这个类：

```
void foo(SplitStream & out)
{
    double some_double = 1.23;
    out << "bar" << some_double << std::endl;
} 
```

我得到了这个相当神秘的错误：

```
... error C2678: binary '<<' : no operator found which takes a left-hand operand of type 'const SplitStream' (or there is no acceptable conversion) ... 
```

我究竟做错了什么？我试图在`operator<<`没有 const 的情况下进行定义，但它也没有编译。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T23:44:16.920

直接的问题是它`std::endl`不是一个对象，而是一个函数模板，声明如下：

```
template <typename cT, typename Traits>
std::basic_ostream<cT, Traits>& endl(std::basic_ostream<cT, Traits>&); 
```

要使用这样的函数指针，需要推导模板参数。为此，该类`std::basic_ostream<cT, Traits>`声明了合适的重载`operator<<()`：

```
template <typename cT, typename Traits>
std::basic_ostream<cT, Traits>& std::baisic_ostream<cT, Traits>::operator<< (
    std::basic_ostream<cT, Traits>& (*manip)(std::basic_ostream<cT, Traits>&)); 
```

这样，编译器可以在`std::endl`引用函数时推断出正确的实例化。

然而，所有这一切都是完全无关的，因为你想要做的最好完全不同！您应该创建一个合适的流缓冲区并使用一个合理构造`std::ostream`的自定义流缓冲区。下面是一个如何正确执行的完整示例（我之前发布过但只发布了几十次......）：

```
#include <streambuf>

struct teebuf
    : std::streambuf
{
    std::streambuf* sb1_;
    std::streambuf* sb2_;

    teebuf(std::streambuf* sb1, std::streambuf* sb2)
        : sb1_(sb1), sb2_(sb2) {
    }
    int overflow(int c) {
        typedef std::streambuf::traits_type traits;
        bool rc(true);
        if (!traits::eq_int_type(traits::eof(), c)) {
            traits::eq_int_type(this->sb1_->sputc(c), traits::eof())
                && (rc = false);
            traits::eq_int_type(this->sb2_->sputc(c), traits::eof())
                && (rc = false);
        }
        return rc? traits::not_eof(c): traits::eof();
    }
    int sync() {
        bool rc(true);
        this->sb1_->pubsync() != -1 || (rc = false);
        this->sb2_->pubsync() != -1 || (rc = false);
        return rc? 0: -1;
    }
};

#include <fstream>
#include <iostream>

int main()
{
    std::ofstream fout("tee.txt");
    teebuf        sbuf(fout.rdbuf(), std::cout.rdbuf());
    std::ostream  out(&sbuf);
    out << "hello, world!\n";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:04:21.130

另一个答案更好，但为了完整性：

operator<< 中的 SplitStream 引用不应为 const，因为它们正在修改结构包含的流。

```
template<class T>
SplitStream & operator << (SplitStream & sp, const T & x)
{
    sp.a << x;
    sp.b << x;
    return sp;
} 
```

# ruby-on-rails - Rails Bootstrap 弹出框不会切换

> ID：13943283
> 
> 赞同：0
> 
> 时间：2012-12-18T23:37:56.223
> 
> 标签：ruby-on-rails, twitter-bootstrap, twitter-bootstrap-rails

我正在尝试让 Bootstrap 弹出窗口切换。

JS代码：

```
$('#post_description').popover('toggle') 
```

表格代码：

```
 <%= f.input :description, :label => 'Description', :input_html => {:rows => '10', :class => "span8", "data-content" =>'Hey', "data-title" => 'TEXTILE'} %> 
```

当我将鼠标悬停在字段上时弹出框会出现，但当我将光标移出字段时会消失。当我单击并在第二次单击时关闭它时，不应该切换显示弹出框吗？

谢谢！

# objective-c - iOS UITableView：使用来自 JSON 对象的信息的自定义部分，而不仅仅是计算它

> ID：13943285
> 
> 赞同：2
> 
> 时间：2012-12-18T23:38:02.573
> 
> 标签：objective-c, ios, json, uitableview, sections

假设我有这个 JSON：

```
[
    {"x":"01", "ID":"1"},
    {"x":"02", "ID":"2"},
    {"x":"02", "ID":"3"},
    {"x":"03", "ID":"4"},
    {"x":"03", "ID":"5"},
    {"x":"03", "ID":"6"},
    {"x":"03", "ID":"7"}
] 
```

我想像这样创建一个 UITableView：

```
------------
Section 01
------------
ID: 1
------------
Section 02
------------
ID: 2
ID: 3
------------
Section 03
------------
ID: 4
ID: 5
ID: 6
ID: 7 
```

如何找出我需要多少个部分以及如何在每个部分中输出正确的数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:12:10.590

首先要做的是将该 JSON 转换为 Objective-C 数据结构。我推荐一个数组数组，其中“X”是每个“ID”值数组的索引。

就像是：

```
NSMutableArray *tableSections;
NSMutableArray *sectionData;

CustomDataObject *yourCustomDataObject;

int sectionIndex;

//Pseudo-code to create data structure
for(data in json) {

    sectionIndex = data.X;

    yourCustomDataObject = [[CustomDataObject alloc] initWithId:data.ID];

    //Do index check first to insure no out of bounds
    if(sectionIndex != OutOfBounds)
        sectionData = [tableSections objectAtIndex:sectionIndex];

    //Create the new section array if there isn't one for the current section
    if(!sectionData) {
        sectionData = [NSMutableArray new];
        [tableSections insertObject: sectionData atIndex: sectionIndex];
        [sectionData release];
    }

    [sectionData addObject: yourCustomDataObject];
    [yourCustomDataObject release];
} 
```

上面的代码只是帮助您入门的伪代码。创建这个数组数组可能是您以前已经做过的事情。

重要的部分是通过实现 UITableViewDataSource 协议来访问这些数据。我建议继承 UITableView 并在您的自定义子类中实现 UITableViewDataSource 协议。

您将需要这些方法：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return [tableSections count];
} 

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return [[tableSections objectAtIndex: section] count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

    //Implement as you normally would using the data structure you created

    NSMutableArray *sectionData = [tableSections objectAtIndex: indexPath.section];
    CustomDataObject *dataObject = [sectionData objectAtIndex: indexPath.row];

    NSLog(@"\n**** Debug Me *****indexPath: section: %i row: %i \ndataObject%@", indexPath.section, indexPath.row, dataObject);
} 
```

这应该足以让你开始。弄清楚其余的细节应该是一个好习惯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:40:35.253

假设“x”的值将从 1 增加到`n`不跳过任何值，那么您需要的部分数将只是“x”的最后一个值（即`n`）。

如果没有，您确实必须遍历“x”的值以查看有多少唯一值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T19:53:54.370

结束了这个解决方案：

```
 NSMutableDictionary *result = [NSMutableDictionary dictionary];
    for(NSDictionary* dict in data) {
        NSNumber *x = [dict objectForKey:@"x"];
        NSMutableArray *resultsForX = [result objectForKey:x];

        if(!resultsForX) {
            resultsForX = [NSMutableArray array];
            [result setObject:resultsForX forKey:x];
        }

        [resultsForX addObject:dict];
    }

    NSMutableArray *newArr = [result allValues]; 
```

# python - 如何使用 numpy/scipy 在方程中用已知函数求解 x？

> ID：13943286
> 
> 赞同：2
> 
> 时间：2012-12-18T23:38:05.190
> 
> 标签：python, numpy, statistics, scipy

我有一个来自 scipy 的 lognorm 分布，它的参数是已知的。

```
import scipy

log_norm_obj = scipy.stats.lognorm([log_mu], shape=sigma) 
```

我需要求解满足以下等式的 ax：

```
x = (1 - log_norm_obj.cdf(x)) / log_norm_obj.pdf(x) 
```

我怎么能用 numpy/scipy 做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T05:03:51.877

您使用[scipy.optimize](http://docs.scipy.org/doc/scipy/reference/optimize.html)。从 scipy 0.11 及更高版本开始，您可以使用新功能[`minimize`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html#scipy.optimize.minimize)或[`minimize_scalar`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize_scalar.html#scipy.optimize.minimize_scalar). 假设你的 x 是一个标量，这里有一些关于如何做到这一点的示例代码：

```
from scipy.optimize import minimize_scalar

def f(x):
    return (1 - log_norm_obj.cdf(x)) / log_norm_obj.pdf(x) - x

result = minimize_scalar(f)        
print result.x 
# this would print your result 
```

上面使用[的是 Brent 的方法](http://en.wikipedia.org/wiki/Brent%27s_method)，默认的。您也可以使用[Golden 方法](http://en.wikipedia.org/wiki/Golden_section_search)，或 Brent 方法的有界版本。如果您的函数仅在给定域中定义，或者您希望在特定时间间隔内获得解决方案，则后者可能很有用。一个例子：

```
result = minimize_scalar(f, bounds=(0, 10.), method='bounded') 
```

如果您的函数采用向量而不是标量，则可以使用类似的方法`minimize`。如果您的 scipy 版本早于 0.11，只需使用[`fmin`](http://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin.html#scipy.optimize.fmin).

# networking - 在分布式数据库中，数据以什么方式复制？

> ID：13943288
> 
> 赞同：-1
> 
> 时间：2012-12-18T23:38:22.777
> 
> 标签：networking, replication, cluster-computing

我对复制在分布式数据库中的工作方式感到困惑。例如，复制是否使得站点 A（在位置 A）中存在站点 B 中数据的精确副本？或者它是否在站点 A 具有与站点 B 不同的数据但站点 A 和 B 具有可以在站点 A 和 B 之间集群和复制的数据中“复制”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T21:08:32.580

这取决于您的数据库的分布方式、您正在寻找的冗余级别以及您使用的技术。使用 dbShards，您可以将数据库分布在许多服务器（例如服务器 1、2 和 3）上以提高性能和可扩展性（都在位置 A）。然后您可以在本地复制以覆盖服务器故障（创建 1、2、3 的备份）。但您也可以在位置 A 设置具有完整集群副本的第二个位置，以实现完全灾难恢复。您可以在这里了解更多信息：[http ://www.dbshards.com/dbshards/replication-failover/](http://www.dbshards.com/dbshards/replication-failover/)

# php - 在 htaccess 中的重写规则后如何访问其他 url 参数？

> ID：13943290
> 
> 赞同：0
> 
> 时间：2012-12-18T23:38:30.357
> 
> 标签：php, .htaccess

我目前在 htaccess 中有一个重写规则，如下所示：

```
RewriteRule ^/?p/(.+)/(.+)/(.+)/(.+)/(.+)/ /dir/page.html?&type=$1&state=$2&kw=$3&source=$4&lid=$5 [L] 
```

这使得当这样的页面加载时：

www.site.com/pap/type/state/kw/source/lid/

我可以通过get in php访问每个参数

```
$_GET["type"]
$_GET["state"]
$_GET["kw"]
$_GET["source"]
$_GET["lid"] 
```

问题是，如果加载这样的页面：

www.site.com/pap/type/state/kw/source/lid/?id=blah **_**

我无法使用 GET 访问“id”参数。换句话说，这不会回显任何内容：

```
echo $_GET["id"]; 
```

在这种情况下，我将如何访问参数“id”？

在此先感谢您的帮助...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:40:39.957

使用标志 QSA

```
RewriteRule ^/?p/(.+)/(.+)/(.+)/(.+)/(.+)/ /dir/page.html?type=$1&state=$2&kw=$3&source=$4&lid=$5 [QSA,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:40:26.640

添加`[L,QSA]`到规则中。“查询字符串追加”。

# jquery - 获取放置在多个 DIV 中的元素 ID

> ID：13943294
> 
> 赞同：0
> 
> 时间：2012-12-18T23:38:36.623
> 
> 标签：jquery, html

在悬停顶部 DIV 后，我在获取放置在多个 DIV 中的最低元素（图像）的 ID 时遇到问题。这是我的结构：

```
<div id="dig-xx">
<div>
    <div>Content</div>
    <div><img src="some_picture.jpg" id="aig-xx" alt="" /></div>
</div> 
```

使用 id="dig-xx" 悬停整个 DIV 后如何获取 <img> ID？谢谢您的答复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:45:30.103

试试这个

```
$('#dig-xx').on('hover', function(){

    var imgId = $(this).find('img').attr('id');
}); 
```

* * *

如果您有多个实例，则使用`Attribute Starts with Selector`

```
$('[id^="dig"]').on('hover', function(){

    var imgId = $(this).find('img').attr('id');
}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/deCum/)**

# java - 降低双精度

> ID：13943298
> 
> 赞同：1
> 
> 时间：2012-12-18T23:38:57.943
> 
> 标签：java, android

我在谷歌上搜索的所有内容都表明以下任何一项都会将双精度舍入到小数点后两位。

```
double roundToFourDecimals(double d)
{
    DecimalFormat twoDForm = new DecimalFormat("#.##");
    double myD = Double.valueOf(twoDForm.format(d));
    return myD;
}

double nextLon = (double)Math.round(bnextLon * 100.0) / 100.0; 
```

但两者都不适合我。double 的值是`3.3743984E7`和结果是一样的。怎么了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T23:44:34.377

Nothing's wrong. `3.3743984E7` is scientific notation. That is:

```
3.3743984E7 = 3.3743984 * 10^7 = 33743984 
```

33,743,984.0 rounded to two decimal places is 33,743,984.0\. ~~If, perhaps you specified `33743984.05918`, it would be rounded to `33743984.06`, but both outputs would still say `3.3743984E7`.~~ (The preceding comment has been deleted due to invalidity found by [@Sam](https://stackoverflow.com/users/1267661/sam).)

I [can verify that your rounding code works](http://ideone.com/Hckfod):

```
public class Main {
    public static void main(String[] args) {
        double bnextLon = 275914.18410;
        double nextLon = (double) Math.round(bnextLon * 100.0) / 100.0;
        System.out.println(bnextLon + " became " + nextLon);
    }
} 
```

> `275914.1841 became 275914.18`

I believe you simply need to determine what value you want in, and what value you want out. The code is giving you exactly what you're specifying.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T23:45:54.990

`3.3743984E7` means `33743984`, so multiplying by `100` gives `3374398400`, then rounding change nothing, then division goes back.

You should divide by `1E5` then round, than back.

# offline - 在离线网络上使用 firebase

> ID：13943299
> 
> 赞同：1
> 
> 时间：2012-12-18T23:38:59.850
> 
> 标签：offline, firebase

我有一个由 50 台计算机组成的 Intranet 网络，但没有 Internet 连接；是否可以使用 firebase 在这些计算机之间共享数据 - 例如，聊天程序？我在该领域的有限知识表明，如果将 firebase api 下载到本地网络并使用本地表达式而不是 Web 链接进行引用，这应该是可能的——这可能吗？谢谢格雷格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T21:28:02.273

Firebase 是一种云服务，所有数据都从云端加载并同步回云端。目前没有可以在本地运行的 Firebase 服务器，因此如果没有互联网连接，它将无法工作。

Firebase 在通过代理/防火墙方面做得很好，所以如果你担心公司的网络连接可能会阻止它，我建议至少先尝试一下——它可能会起作用，除非你真的没有互联网连接。

# mediaelement.js - 如何在控制栏中隐藏持续时间？

> ID：13943302
> 
> 赞同：-1
> 
> 时间：2012-12-18T23:39:14.030
> 
> 标签：mediaelement.js

我只想隐藏视频中的持续时间。这是我在 wordpress 页面上的代码：

```
<video width="720" height="405" poster="/wp-content/uploads/videos/HomeVideo.png" controls="controls" preload="true">
<!-- MP4 for Safari, IE9, iPhone, iPad, Android, and Windows Phone 7 -->
<source type="video/mp4" src="/wp-content/uploads/videos/HomeVideo.mp4" />
<!-- WebM/VP8 for Firefox4, Opera, and Chrome -->
<source type="video/webm" src="/wp-content/uploads/videos/HomeVideo.webm" />
<!-- Ogg/Vorbis for older Firefox and Opera versions -->
<source type="video/ogg" src="/wp-content/uploads/videos/HomeVideo.ogv" />
<!-- Flash fallback for non-HTML5 browsers without JavaScript -->
<object width="720" height="405" type="application/x-shockwave-flash" data="flashmediaelement.swf">
    <param name="movie" value="flashmediaelement.swf" />
    <param name="flashvars" value="controls=true&file=HomeVideo.mp4" />
    <!-- Image as a last resort -->
    <img src="/wp-content/uploads/videos/noplay.png" width="720" height="405" />
</object> 
```

我删除了 php 功能中的“持续时间”，但这没有任何影响。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T22:28:50.827

好的，我自己找到了解决方案。只需将代码更改为：

[视频 mp4="/wp-content/uploads/videos/HomeVideo.mp4" ogg="/wp-content/uploads/videos/HomeVideo.ogg" webm="/wp-content/uploads/videos/HomeVideo.webm" poster="/wp-content/uploads/videos/HomeVideo.png" preload="true" current="false" width="720" height="405"]

并添加到 CSS

.mejs-controls .mejs-time {可见性：隐藏！重要；显示：无！重要；}

# objective-c - NSService 以编程方式定义热键

> ID：13943304
> 
> 赞同：1
> 
> 时间：2012-12-18T23:39:36.207
> 
> 标签：objective-c, macos, cocoa

我的应用程序声明了一项服务，我希望允许用户从我的应用程序的首选项中设置该服务的热键（这样我就不必将用户定向到系统首选项）。

有没有办法以编程方式（或只是热键）声明服务，或者 Info.plist 是唯一的方法？

# c# - AppResources 中的 C#/Windows Phone 转义字符

> ID：13943307
> 
> 赞同：1
> 
> 时间：2012-12-18T23:39:45.720
> 
> 标签：c#, windows-phone-7, localization, windows-phone-8

如果我`AppResources.myText`在我的代码中使用设置文本块的文本，所有转义字符都会被转换并且我的本地化文本变得无用。例如`Hello\nWorld!`变成`Hello\\nWorld!`

结果，文本块显示了这一点：

```
Hello\\nWorld! 
```

代替：

```
Hello
World! 
```

我应该在我的 AppResources 中为本地化字符串使用哪些转义字符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:14:44.640

应该与[在其他资源文件中执行此操作](https://stackoverflow.com/questions/931114/carriage-return-line-feed-in-net-resource-file-app-globalresources)相同。

> 假设您想输入 hello world
> 
> 键入 hello，然后按 shift+enter 和 world。

# matlab - 如何使用 MATLAB 绘制巴特沃斯滤波器的频率响应

> ID：13943310
> 
> 赞同：0
> 
> 时间：2012-12-18T23:40:12.353
> 
> 标签：matlab, filter, frequency

我构建了一个代码来使用 Butterworth IIR 设计 4 个滤波器。低、高、带通和带阻。Input Diolog 窗口打开以接受用户输入，我将默认值设置为：

```
def = {'5','200','40','50','3','30'}; for Low and High pass
AND
def = {'5','500','60', '200','50','250','3','30'}; for bandpass and bandstop
Order of Filter
Fsampling (Hz)
Fpass (Fpass 1 and 2) (Hz)
Fstop (Fstop 1 and 2) (Hz)
Ripple factors (dB)
Stop attenuation (dB) 
```

暂时。并使用for循环（1-> 4）计算B和A分量

```
 [n Fn] = buttord(Fpass,Fstop,Rp,Rs);
   [B,A] = butter(N,Fn,str);
   B_Comp{i} = B;
   A_Comp{i} = A; 
```

现在..我需要为每个滤波器绘制它们的频率响应，所以使用

```
for i=1:4
   freqz(B_Comp(i),A_Comp(i));
   figure;
end 
```

但是出现了这个错误：

```
 ??? Function 'fft' is not defined for values of class 'cell'.
Error in ==> fft at 36
   [varargout{1:nargout}] = builtin('fft', varargin{:});

Error in ==> freqz at 94
    h = dividenowarn(fft(b,s.*nfft),fft(a,s.*nfft)).';

Error in ==> dsp1 at 62
    freqz(B_Comp(i),A_Comp(i)); 
```

我该如何解决这个问题..任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:13:57.923

想用的时候不要用cell `fft`，用之前先试试`cell2mat`。例如：

```
 freqz(cell2mat(B_Comp(i)),cell2mat(A_Comp(i))); 
```

# php - Blueimp jQuery 文件上传插件 - “空文件上传”结果 PHP

> ID：13943314
> 
> 赞同：9
> 
> 时间：2012-12-18T23:40:29.973
> 
> 标签：php, jquery, jquery-plugins, blueimp

这是插件：[https ://github.com/blueimp/jQuery-File-Upload](https://github.com/blueimp/jQuery-File-Upload)

上传文件后，我无法从插件中获得我想要的响应。

在带有插件的页面上，我有以下内容

```
$('#fileupload').fileupload(
    'option',
    {
        'maxNumberOfFiles' :1,
        'url' : '/admin/upload_handler.php'
    }
); 
```

在`upload_handler.php`我成功地从 $_FILES 中检索上传的文件并执行操作，然后以 JSON 格式发回响应。我已经使用 Firebug 确认响应格式正确：

```
[ 
    {                
        "url" : "image_url",
        "thumbnail_url" : "image_th_url",
         "delete_url" : "test",
         "delete_type" : "DELETE",
         "name" : "foobar.jpg",
         "size" : 7419
     }
] 
```

但是回调找不到文件数组，我得到错误：'空文件上传结果'。我觉得我在这里遗漏了一些重要的东西——我在文档、论坛或 Stack Overflow 中找不到任何东西。我很感激任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-26T22:48:14.413

自插件版本 5 起，json 响应发生了变化：[https ://github.com/blueimp/jQuery-File-Upload/wiki/JSON-Response](https://github.com/blueimp/jQuery-File-Upload/wiki/JSON-Response)

所以你只需调整你的上传类：

```
$filejson = new stdClass();
$filejson->files[] = $fileArray;
return json_encode($filejson); 
```

你完成了

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-20T03:48:39.030

您的回报需要包含在文件数组中，如下所示：

```
 {"files": [
      {
        "name": "picture1.jpg",
        "size": 902604,
        "url": "http:\/\/example.org\/files\/picture1.jpg",
        "thumbnailUrl": "http:\/\/example.org\/files\/thumbnail\/picture1.jpg",
        "deleteUrl": "http:\/\/example.org\/files\/picture1.jpg",
        "deleteType": "DELETE"
      },
      {
        "name": "picture2.jpg",
        "size": 841946,
        "url": "http:\/\/example.org\/files\/picture2.jpg",
        "thumbnailUrl": "http:\/\/example.org\/files\/thumbnail\/picture2.jpg",
        "deleteUrl": "http:\/\/example.org\/files\/picture2.jpg",
        "deleteType": "DELETE"
      }
    ]} 
```

具体而言，要求是：`Note that the response should always be a JSON object containing a files array even if only one file is uploaded.`

通过 :: [https://github.com/blueimp/jQuery-File-Upload/wiki/Setup#using-jquery-file-upload-ui-version-with-a-custom-server-side-upload-handler](https://github.com/blueimp/jQuery-File-Upload/wiki/Setup#using-jquery-file-upload-ui-version-with-a-custom-server-side-upload-handler)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-21T12:08:32.193

“空文件上传结果”将在向 <tr class="template-upload fade"> HTML 标签之外的模板添加 HTML（和编程结果 DOM）对象时发生，例如：假设您添加另一个 < tr> 到模板

这将导致文件被正确上传，并且对于每个上传的文件，您将获得一次“空文件上传结果”。

似乎必须对 JS 模板引擎做点什么。

这可以在 jquery.fileupload-ui,js 中修复，就在第 128 行之后

原始代码：

```
 // Callback for successful uploads:
done: function (e, data) {
    var that = $(this).data('blueimp-fileupload') ||
            $(this).data('fileupload'),
        files = that._getFilesFromResponse(data),
        template,
        deferred;
    if (data.context) {
        data.context.each(function (index) { // LINE 128
            var file = files[index] ||
                    {error: 'Empty file upload result'},
                deferred = that._addFinishedDeferreds(); 
```

在第 128 行之后添加以下代码：

```
if (!$(data.context[index]).hasClass(that.options.uploadTemplateId)) { return true; } 
```

结果代码：

```
 // Callback for successful uploads:
done: function (e, data) {
    var that = $(this).data('blueimp-fileupload') ||
            $(this).data('fileupload'),
        files = that._getFilesFromResponse(data),
        template,
        deferred;
    if (data.context) {
        data.context.each(function (index) { //LINE 128
            if (!$(data.context[index]).hasClass(that.options.uploadTemplateId)) { return true; } // YOUR ADDED LINE
            var file = files[index] ||
                    {error: 'Empty file upload result'},
                deferred = that._addFinishedDeferreds(); 
```

希望这对其他人有帮助:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T08:53:11.283

好的，这似乎不是 jQuery 问题，而是服务器端问题。就我而言，它是一个 PHP 脚本，需要进行如下调整。

见函数 post()，编辑这一行

```
$json = json_encode($info); 
```

至

```
$json = json_encode(array($this->options['param_name'] =>$info)); 
```

而且我还必须在函数的最后一行编辑回声；代替

```
echo $json; 
```

现在有

```
echo str_replace('\/','/',$json); 
```

返回正确的 json 数组似乎可以正常工作。希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-07-17T16:51:47.183

就我而言，我修改了 jquery.fileupload-ui.js 文件以直接查找 JSON 结果。

更改此代码段

```
 if (data.context) {
                    data.context.each(function (index) {
                        var file = files[index] ||
                                {error: 'Empty file upload result'};//CHANGE
                        deferred = that._addFinishedDeferreds();
                        that._transition($(this)).done(
                            function () {
```

至此

```
 if (data.context) {
                    data.context.each(function (index) {
                        var file = data._response.result[index] ||
                                {error: 'Empty file upload result'};//TO THIS
                        deferred = that._addFinishedDeferreds();
                        that._transition($(this)).done(
                            function () {
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-09-06T15:25:58.720

对我来说，这是上传文件的大小。我调整了那些 php.ini 参数：

*   内存限制
*   post_max_size
*   上传最大文件大小
*   max_file_uploads

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-02-28T17:19:24.653

如前所述，发生这种情况是因为服务器响应不是插件所期望的（这是一个文件数组[，如此处所示](https://i.stack.imgur.com/AU92P.png)）。如果您不想（或不能）更改后端，解决方案是将响应中的结果对象替换为插件期望的结果对象（然后包含文件数组）。

这可以在**fileuploaddone**事件中完成。

假设这是上传完成后从服务器返回的 JSON 响应： [![在此处输入图像描述](../Images/4c7e9d11759a04b2fd44166b676286b0.png)](https://i.stack.imgur.com/AU92P.png)

**data.result**保存服务器响应：

```
.bind('fileuploaddone', function(e, data) {
    //this will now contains the server response 
    //as per the attached image: an array of elements
    data.result;
}); 
```

我们想用一个可以被 blueimp 插件解析的新对象替换**结果**对象，让我们定义它（注意：这是一个包含文件数组的对象，根据插件文档）。

```
//tempFolder is optional
var filesUploaded = { "files": [], "tempFolder": null }; 
```

替换结果对象：

```
.bind('fileuploaddone', function(e, data) {
    //creating a file object in the format the jquery plugin is expecting
    var file = {
        deleteType: "DELETE",
        deleteUrl:"#",
        type: data.result[0].MimeType,
        thumbnailUrl : "#",
        url: "#",
        name: data.result[0].Name,
        size: data.result[0].Size
    }

    //adding it to the file list
    filesUploaded.files.push(file);
    data.result = null;
    //replacing the server response with the 'custom' one we just created
    data.result = filesUploaded;
}); 
```

该插件现在应该可以正常渲染，因为它将解析预期的 JSON 模式，并且您不会再收到“空文件上传结果”消息。

# python - 使用 Python apiclient 对 Google Calendar API v3 进行空闲忙碌调用时出现 TypeError

> ID：13943321
> 
> 赞同：2
> 
> 时间：2012-12-18T23:41:07.910
> 
> 标签：python, google-app-engine, oauth-2.0, google-calendar-api

我想在两个给定日期之间获取我的谷歌日历的所有空闲事件。我正在关注[freebusy object 的文档](https://google-api-client-libraries.appspot.com/documentation/calendar/v3/python/latest/calendar_v3.freebusy.html)。

基本上，我有一个带有允许选择两个日期的表单的 index.html。我将这些日期发送到我的应用程序（Python Google AppEngine 支持）。

这是简化的代码，以使其更具可读性：

```
CLIENT_SECRETS = os.path.join(os.path.dirname(__file__), 'client_secrets.json')

decorator = oauth2decorator_from_clientsecrets(
    CLIENT_SECRETS,
    scope='https://www.googleapis.com/auth/calendar',
    message=MISSING_CLIENT_SECRETS_MESSAGE)

service = build('calendar', 'v3')

class MainPage(webapp2.RequestHandler):
  @decorator.oauth_required
  def get(self):
    # index.html contains a form that calls my_form
    template = jinja_enviroment.get_template("index.html")
    self.response.out.write(template.render())

class MyRequestHandler(webapp2.RequestHandler):
  @decorator.oauth_aware
  def post(self):
    if decorator.has_credentials():

      # time_min and time_max are fetched from form, and processed to make them
      # rfc3339 compliant
      time_min = some_process(self.request.get(time_min))
      time_max = some_process(self.request.get(time_max))

      # Construct freebusy query request's body
      freebusy_query = {
        "timeMin" : time_min,
        "timeMax" : time_max,
        "items" :[
          {
            "id" : my_calendar_id
          }
        ]
      }

      http = decorator.http()
      request = service.freebusy().query(freebusy_query)
      result = request.execute(http=http)
    else:
      # raise error: no user credentials

app = webapp2.WSGIApplication([
    ('/', MainPage),     
    ('/my_form', MyRequestHandler),
    (decorator.callback_path, decorator.callback_handler())
], debug=True) 
```

但是我在 freebusy 调用中得到了这个错误（堆栈跟踪的有趣部分）：

```
File "/Users/jorge/myapp/oauth2client/appengine.py", line 526, in setup_oauth
    return method(request_handler, *args, **kwargs)
  File "/Users/jorge/myapp/myapp.py", line 204, in post
    request = service.freebusy().query(freebusy_query)
  TypeError: method() takes exactly 1 argument (2 given) 
```

我已经做了一些研究，但我没有找到任何在 Python 上使用日历 v3 和 freebusy 调用的运行示例。[我在API explorer](https://developers.google.com/apis-explorer/#p/calendar/v3/calendar.freebusy.query)中成功执行了调用。

如果我理解错误，似乎 oauth_aware 装饰*器*以任何方式过滤了其控制下的代码的所有调用。一个可调用对象被传递给`OAuthDecorator.oauth_aware`oauth2client 的方法。而这个可调用对象是 webapp2.RequestHandler 的一个实例。喜欢`MyRequestHandler`。

如果用户已正确登录，则 oauth_aware 方法通过调用`method(request_handler, *args, **kwargs)`. 错误来了。A `TypeError`, 因为`method`正在接受比允许更多的参数。

这是我的解释，但我不知道我是否正确。我应该`freebusy().query()`用其他方式打电话吗？我的任何分析真的有意义吗？我迷失了这个...

提前谢谢了

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-27T17:46:18.907

正如[bossylobster](https://stackoverflow.com/users/1068170/bossylobster)建议的那样，解决方案非常简单。只需替换此调用

```
service.freebusy().query(freebusy_query) 
```

有了这个

```
service.freebusy().query(body=freebusy_query) 
```

谢谢！

# c# - 如何使用自定义 RowStyle 编辑 WPF DataGrid 中的行

> ID：13943325
> 
> 赞同：0
> 
> 时间：2012-12-18T23:41:29.963
> 
> 标签：c#, wpf, xaml, mvvm, datagrid

我需要将一些数据放入 a 中`DataGrid`，对每一行使用自定义`UserControl`。显示数据工作得很好，但是当我编辑 custom 中的字段时`UserControl`，绑定的数据记录不会改变。

如果我使用 a`ListBox`来显示数据，则一切都按预期工作。但我宁愿使用 DataGrid，它允许排序和（希望）添加新记录。

为了说明，这是一个我需要显示（和编辑）的简单数据类 - 人和他们的配偶：

```
public class PersonViewModel : INotifyPropertyChanged
{
    public PersonViewModel(string name)
    {
        _name = name;
    }

    private string _name = null;
    public string Name
    {
        get { return _name; }
        set
        {
            _name = value;
            this.PropertyChanged(this, new PropertyChangedEventArgs("Name"));
        }
    }

    private PersonViewModel _spouse = null;
    public PersonViewModel Spouse
    {
        get { return _spouse; }
        set
        {
            _spouse = value;
            this.PropertyChanged(this, new PropertyChangedEventArgs("Spouse"));
        }
    }

    public event PropertyChangedEventHandler PropertyChanged = (s, e) => { };
} 
```

..这是自定义用户控件（PersonView）：

```
<UserControl x:Class="TestDataGrid.PersonView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" >
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <!--Editing in DataGrid works only if these bindings use UpdateSourceTrigger=PropertyChanged-->
        <TextBox Text="{Binding Path=Name}" Width="70" />
        <TextBlock Text="is married to" Margin="6,0" Grid.Column="1" />
        <TextBox Text="{Binding Path=Spouse.Name}" Width="70" Grid.Column="2" />
    </Grid>
</UserControl> 
```

最后，将主窗口（带有代码隐藏）放在一起：

```
<Window x:Class="TestDataGrid.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:TestDataGrid"
        Title="MainWindow" Height="350" Width="500">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>

        <!--Changes made here correctly update the persons' names,
            and the changes are reflected in the DataGrid below-->
        <ListBox x:Name="_listbox" >
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <local:PersonView />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

        <!--Changes made here never reach the PersonViewModels..-->
        <DataGrid x:Name="_datagrid" Grid.Column="1" 
                  AutoGenerateColumns="False" CanUserAddRows="True" IsReadOnly="False" >
            <DataGrid.Columns>
                <DataGridTextColumn Binding="{Binding Path=Name}" Header="Name" />
                <DataGridTextColumn Binding="{Binding Path=Spouse.Name}" Header="Spouse" />
            </DataGrid.Columns>
            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow" >
                    <Setter Property="Template" >
                        <Setter.Value>
                            <ControlTemplate>
                                <local:PersonView />
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </DataGrid.RowStyle>
        </DataGrid>
    </Grid>
</Window> 
```

...

```
/// <summary>
/// Interaction logic for MainWindow.xaml
/// </summary>
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();

        var personA = new PersonViewModel("Alice");
        var personB = new PersonViewModel("Barry");
        var personC = new PersonViewModel("Carl");
        var personD = new PersonViewModel("Doris");

        personA.Spouse = personB;
        personC.Spouse = personD;
        var persons = new List<PersonViewModel>() { personA, personC };

        _listbox.ItemsSource = persons;
        _datagrid.ItemsSource = persons;
    }

} 
```

我可以做些什么来在 DataGrid 中进行编辑，就像在 ListBox 中一样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T01:49:26.043

我对你的代码做了一些调整，我想我让它工作了。

首先，您在 PersonView 上有一条注释，上面写着“只有在这些绑定使用 UpdateSourceTrigger=PropertyChanged 时，在 DataGrid 中编辑才有效”。我发现有必要设置 UpdateSourceTrigger，但我使用 LostFocus 来尝试保持与 ListBox 中相同的行为。

```
<!--Editing in DataGrid works only if these bindings use UpdateSourceTrigger-->
    <TextBox Text="{Binding Path=Name, UpdateSourceTrigger=LostFocus}" Width="70" />
    <TextBlock Text="is married to" Margin="6,0" Grid.Column="1" />
    <TextBox Text="{Binding Path=Spouse.Name, UpdateSourceTrigger=LostFocus}" Width="70" Grid.Column="2" /> 
```

其次，我没有使用 2 个 DataGridTextColumns 和 DataGrid.RowStyle，而是使用了一个 DataGridTemplateColumn。我希望这是可以接受的——它看起来像你以前的样子，模板并没有真正尊重列，但现在确实如此。

```
 <DataGrid x:Name="_datagrid" Grid.Column="1" AutoGenerateColumns="False" CanUserAddRows="True" IsReadOnly="False" >
        <DataGrid.Columns>
            <DataGridTemplateColumn Header="People">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <local:PersonView />
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
        </DataGrid.Columns>
    </DataGrid> 
```

进行这些更改后，我看到它在双方都更新了。

我希望这对你有帮助。

# c++ - 程序在 Visual Studio 之外运行时表现不同

> ID：13943326
> 
> 赞同：2
> 
> 时间：2012-12-18T23:41:30.917
> 
> 标签：c++, visual-studio-2010, opencv

我有一个绘制 Mandelbrot 和 Julia 集的程序，用 OpenCV（在单独的窗口中）显示它们，它在 Visual Studio 中正确运行，但是当我在 Visual Studio 之外运行 .exe 时，其中一个窗口不能正确缩放。

显示 Mandelbrot 集的窗口正确绘制和缩放，另一个窗口使用完全相同的缩放方法（在 Visual Studio 中运行时有效）不起作用

```
case CV_EVENT_LBUTTONDOWN:
    zx_point += x*zinc;
    zy_point -= y*zinc;
    zinc *= zoom_safe;
    zx_point -= x*zinc;
    zy_point += y*zinc;
    Draw(ptr_kernel, ptr_queue, ptr_image, ptr_context);
break; 
```

似乎“ `zx_point`”和“ `zy_point`”没有被写入，因为无论我点击哪里，窗口都会放大到左上角。

简而言之，Visual Studio 内部的调试/发布工作在外部具有相同的奇怪行为。dll 与 .exe 位于同一文件夹中，输出窗口显示在 VS2010 中加载的相同 dll

什么可能导致这种奇怪的行为？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T19:34:29.887

在 Visual Studio 内和在 Visual Studio 外运行程序的区别在于：

1.  传递给程序的参数。

2.  应用程序的工作目录。

3.  如果您在启动 Visual Studio 后更改了环境变量（或者如果您使用此类启动器，则在启动启动器之后：例如：Explorer++）

# ruby - 在 Ruby Mongoid 上使用 MapReduce 的困难

> ID：13943327
> 
> 赞同：1
> 
> 时间：2012-12-18T23:41:33.217
> 
> 标签：ruby, mongodb, mapreduce, ruby-on-rails-3.2, mongoid

我很难在 Ruby 中使用 MongoDB 和 mongoid 创建 MapReduce 函数。我正在使用[Ruby and MongoDB Web Development Guide](http://www.packtpub.com/ruby-and-mongodb-web-development-beginners-guide/book)，并且内容似乎不是为 Mongoid 编写的（即使它是在 Rails 3.2 之后编写的）。

这是一个示例 JSON 文档：

```
> db.books.find()
{ "_id" : ObjectId("50ceb8551d41c8ade7000041"), 
"author_id" : ObjectId("50ceb72c1d41c8ade700003d"), 
"category_ids" : [ ], "name" : "Great Expectations", 
"votes" : [     
  {     "username" : "Gautam",  "rating" : 9 },     
  {     "username" : "Tom",     "rating" : 3 },     
  {     "username" : "Dick",    "rating" : 7 } 
] 
} 
```

无论如何，我在使用 mongoid MapReduce 时遇到了麻烦。我可以在 MongoDB 中很好地运行它：

```
> var reduce = function(key, values) {
  var result = {rating: 0};
  values.forEach(function(value) {
    result.rating += value.rating;
  });
  return result;
  };
> var map = function() {
  this.votes.forEach(function(x) {
    emit(x.username, {rating: x.rating});
  });
  };
> var results = db.books.mapReduce(map, reduce, {out: "mr_results"});
> results
{
    "result" : "mr_results",
    "timeMillis" : 28,
    "counts" : {
        "input" : 2,
        "emit" : 6,
        "reduce" : 3,
        "output" : 3
    },
    "ok" : 1,
}
> results.find()
{ "_id" : "Dick", "value" : { "rating" : 10 } }
{ "_id" : "Gautam", "value" : { "rating" : 15 } }
{ "_id" : "Tom", "value" : { "rating" : 10 } } 
```

但是当我在 Rails 控制台中运行以下命令时，我得到了这个：

```
1.9.3-p327 :292 > map = "function() {
1.9.3-p327 :293"> this.votes.forEach(function(x) {
1.9.3-p327 :294"> emit(x.username, {x.rating});
1.9.3-p327 :295"> });
1.9.3-p327 :296"> }
1.9.3-p327 :297"> "
 => "function() {\nthis.votes.forEach(function(x) {\nemit(x.username, {x.rating});\n});\n}\n" 
1.9.3-p327 :298 > reduce = "function(key, values) {
1.9.3-p327 :299"> var result = {rating: 0};
1.9.3-p327 :300"> values.forEach(function(value) {
1.9.3-p327 :301"> result.rating += value.rating;
1.9.3-p327 :302"> });
1.9.3-p327 :303"> return result;
1.9.3-p327 :304"> }
1.9.3-p327 :305"> "
 => "function(key, values) {\nvar result = {rating: 0};\nvalues.forEach(function(value) {\nresult.rating += value.rating;\n});\nreturn result;\n}\n" 
1.9.3-p327 :306 > results = Book.where(votes: 1).map_reduce(map,reduce).out(inline: 1)
 => #<Mongoid::Contextual::MapReduce
  selector: {"votes"=>1}
  class:    Book
  map:      function() {
this.votes.forEach(function(x) {
emit(x.username, {x.rating});
});
}

  reduce:   function(key, values) {
var result = {rating: 0};
values.forEach(function(value) {
result.rating += value.rating;
});
return result;
}

  finalize: 
  out:      {:inline=>1}>

1.9.3-p327 :307 > results.find()
 => #<Enumerator: #<Mongoid::Contextual::MapReduce
  selector: {"votes"=>1}
  class:    Book
  map:      function() {
this.votes.forEach(function(x) {
emit(x.username, {x.rating});
});
}

  reduce:   function(key, values) {
var result = {rating: 0};
values.forEach(function(value) {
result.rating += value.rating;
});
return result;
}

  finalize: 
  out:      {:inline=>1}>
:find> 
```

或者，如果我将输出结果更改为“mr_results”，则会发生以下情况：

```
1.9.3-p327 :383 > results = Book.map_reduce(map,reduce).out("mr_results")
NoMethodError: undefined method `update_values' for "mr_results":String
        from /home/BSP/.rvm/gems/ruby-1.9.3-p327/gems/mongoid-3.0.14/lib/mongoid/contextual/map_reduce.rb:134:in `out'
        from (irb):383
        from /home/BSP/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands/console.rb:47:in `start'
        from /home/BSP/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands/console.rb:8:in `start'
        from /home/BSP/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands.rb:41:in `<top (required)>'
        from script/rails:6:in `require'
        from script/rails:6:in `<main>' 
```

如何使此输出成为书籍投票的预期结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T20:27:25.703

该`out`函数需要一个哈希，而不是一个字符串：

```
results = Book.map_reduce(map,reduce).out(:replace => "mr_results") 
```

# php - 将数字字符串转换为 int8 或 uint8

> ID：13943335
> 
> 赞同：1
> 
> 时间：2012-12-18T23:42:22.053
> 
> 标签：php, string, hex

我需要使用 PHP 将数字（字符串）转换为 int8 或 uint8 的帮助。

示例：数字`10`应该是`0A`

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:48:10.837

您想要做的似乎与有符号或无符号整数无关，您只是将整数转换为其十六进制表示。在 PHP 中，可以使用`dechex`.

`dechex(10)`将返回 0xA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:44:18.440

You can use the following line to convert a number to its hexdecimal string representation

```
echo dechex(intval("10")); 
```

There is also a [Hexdump](http://www.metashock.de/pirum/) function available for php. This may help too.

You'll find more info [here](http://www.metashock.de/?p=412)

# google-apps-script - 使用 UrlFetchApp.fetch 获取错误 503

> ID：13943336
> 
> 赞同：0
> 
> 时间：2012-12-18T23:42:32.677
> 
> 标签：google-apps-script

我需要一些帮助来解决/调试我们现在遇到的一个错误，该脚本在 2012 年 12 月 7 日之前运行良好。

我们有一个附加到电子表格的 Google App 脚本（由多个函数组成），使我们能够对我们的 Google 群组设置特定权限。直到最近，这个脚本才能正常工作。没有对脚本进行任何代码更改。我们现在在发生提取时收到错误 503 [ `resp = UrlFetchApp.fetch(url, options);`]

出于将其发布到此论坛的目的，我更改了发生错误的函数并对其进行了更改，以便它可以独立运行并生成错误。我已经替换了 ConsumerKey、ConsumerSecret 和其他识别信息。我们相当有信心硬编码的值（例如 ConsumerKey）仍然有效。

我们得到的错误是：

> 请求返回代码 503 失败。服务器响应：{“错误”：{“错误”：[{“域”：“全局”，“原因”：“后端错误”，“消息”：“后端错误”}]，“代码”：503，“消息”：“后端错误”}}（第 85 行）

这是功能：

```
function updateGroup(){
  groupSettingsUrl = "https://www.googleapis.com/groups/v1/groups/";
  scope = "https://www.googleapis.com/auth/apps.groups.settings";

  oAuthConfig = UrlFetchApp.addOAuthService("Groups");
  oAuthConfig.setAccessTokenUrl("https://www.google.com/accounts/OAuthGetAccessToken");
  oAuthConfig.setRequestTokenUrl("https://www.google.com/accounts/OAuthGetRequestToken?scope="+scope);
  oAuthConfig.setAuthorizationUrl("https://www.google.com/accounts/OAuthAuthorizeToken");
  oAuthConfig.setConsumerKey("?.apps.googleusercontent.com");
  oAuthConfig.setConsumerSecret("?");

  var options =
    {
      method : "put",
      oAuthServiceName : "Groups",
      oAuthUseToken : "always",
      payload : '{"defaultMessageDenyNotificationText":"","whoCanJoin":"INVITED_CAN_JOIN","kind":"groupsSettings#groups","id":"testadmins@TST.com","customReplyTo":"   ","allowWebPosting":"true","description":"Test Admins. Systems List","name":"Test Admins","membersCanPostAsTheGroup":"false","whoCanPostMessage":"ANYONE_CAN_POST","includeInGlobalAddressList":"true","whoCanViewMembership":"ALL_IN_DOMAIN_CAN_VIEW","allowExternalMembers":true,"allowGoogleCommunication":"false","isArchived":false,"showInGroupDirectory":true,"replyTo":"REPLY_TO_IGNORE","archiveOnly":"false","email":"testadmins@TST.com","whoCanInvite":"ALL_MANAGERS_CAN_INVITE","sendMessageDenyNotification":"false","spamModerationLevel":"MODERATE","whoCanViewGroup":"ALL_MEMBERS_CAN_VIEW","messageDisplayFont":"DEFAULT_FONT","maxMessageBytes":5242880,"messageModerationLevel":"MODERATE_NONE"}',
      contentType: 'application/json'
    };

  url = groupSettingsUrl+"testadmins@TST.com"; 

  var resp;
  resp = UrlFetchApp.fetch(url, options);

  return "Response " + resp.getResponseCode() + "\n body - " + resp.getContentText();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T20:18:13.813

抱歉，我花了这么长时间才回复 Arun。我们能够通过 GET 方法成功使用 UrlFetchApp.fetch。

# java - Wso2 ESB - 生成的 Java 客户端错误

> ID：13943347
> 
> 赞同：0
> 
> 时间：2012-12-18T23:43:22.807
> 
> 标签：java, axis2, wso2esb, ws-client

当我通过 wso2esb 的网页为已部署的服务“Hello”生成 Java 客户端时。除了*HelloServiceCallBackHandler.java*和*HelloServiceStub.java*我还创建了名为*HelloClient.java*的类：

```
package org.wso2.cs.helloservices;
import java.rmi.RemoteException;
import org.wso2.cs.helloservices.HelloServiceStub.SayHello;
import org.wso2.cs.helloservices.HelloServiceStub.SayHelloResponse;

public class HelloClient {

public static void main(String[] args) {
    try {
        String name= new String("Test");
        HelloServiceStub stub= new HelloServiceStub();
        SayHello sh= new SayHello();
        sh.setName(name);           
        SayHelloResponse resp=stub.sayHello(sh);
        System.out.println("Response : "+resp);

    }catch (RemoteException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
   }
 } 
```

我有以下错误：

```
<font color="red"> Exception in thread "main" java.lang.NoClassDefFoundError: javax/wsdl/extensions/soap/SOAPAddress
at org.wso2.cs.helloservices.HelloServiceStub.populateAxisService(HelloServiceStub.java:41)
at org.wso2.cs.helloservices.HelloServiceStub.<init>(HelloServiceStub.java:88)
at org.wso2.cs.helloservices.HelloServiceStub.<init>(HelloServiceStub.java:77)
at org.wso2.cs.helloservices.HelloServiceStub.<init>(HelloServiceStub.java:126)
at org.wso2.cs.helloservices.HelloServiceStub.<init>(HelloServiceStub.java:118)
at org.wso2.cs.helloservices.HelloClient.main(HelloClient.java:13)
Caused by: java.lang.ClassNotFoundException: javax.wsdl.extensions.soap.SOAPAddress
at java.net.URLClassLoader$1.run(Unknown Source)
at java.net.URLClassLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at java.net.URLClassLoader.findClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at sun.misc.Launcher$AppClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
... 6 more</font> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T02:18:25.980

这似乎是找不到所需的罐子（这抱怨 wsld4j）。请将`AXIS2_HOME/lib`文件夹添加到程序的类路径中。

# jquery - 如何在 jQuery 中访问 DOM 对象数组中的特定对象？

> ID：13943348
> 
> 赞同：2
> 
> 时间：2012-12-18T23:43:37.857
> 
> 标签：jquery

好的，所以我想问一个关于对象数组的简单 jQuery 问题。

如果我从一个 html 页面获取所有元素（例如所有段落）并将它们存储在一个数组中，我如何访问其中一个来处理它？

例如，假设我有这个 html：

```
<!DOCTYPE html>
<html>
    <head>
        <title></title> 
    </head>
    <body> 
    <p>Paragraph 1</p>
    <p>Paragraph 2</p>
    <p>Paragraph 3</p>
    <button id="myButton">Click here</button>

    <script src="jquery-1.6.2.min.js"></script>
    <script src="script.js"></script>
    </body>
</html> 
```

这是我的 script.js：

```
$(document).ready(function(){
    $("#myButton").click(function(){

        var $paragraphs = $("p"); 
        $paragraphs.detach();  //Works fine, removes all elements
        //$paragraphs[0].detach();  //Doesn't work!

    }); 
}); 
```

我试图在数组的第一个元素上调用 detach，这样我就可以删除第一段，但它似乎不起作用......

有没有办法在不使用 id 属性的情况下访问第一段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T23:50:24.270

您可以使用[`:eq`选择器](http://api.jquery.com/eq-selector/)选择第一个元素：

```
$("p:eq(0)").detach(); 
```

这将只分离第一个元素。

您可以改用[`.eq()`function](http://api.jquery.com/eq/)，它可能会提供更好的性能：

```
$("p").eq(0).detach(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:48:17.033

`$paragraphs[0]`将 jquery 对象解包到 html 元素中，这就是您无法访问的原因`detach`（jquery 函数）。

您应该遍历段落，或重新包装对象。这应该工作

```
var detachParagraph = $paragraphs[0];
$(detachParagraph).detach(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T23:49:18.993

试试这个

```
$($paragraphs[0]).detach(); 
```

当您将索引传递给 jQuery Object List`$paragraphs[0]`时，该对象将成为 **DOM 对象**

```
var $paragraphs = $("p"); 

var domObj = $paragraphs[0];

var jqueryObj = $(domObj); 
```

因此，您需要将其再次包装为 jQuery Object ..

相反，您可以使用`:eq()`选择器

```
var $paragraph = $("p:eq(0)");  // Selects only the first para
                                 // which is a jQuery Object
$paragraph.detach();   // This works too 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-19T00:04:56.440

您可以使用过滤函数： $("p").filter(function(index){ if(index==0){ $(this).detach(); } )};

# python - Fabric Sudo No Password Solution

> ID：13943349
> 
> 赞同：7
> 
> 时间：2012-12-18T23:43:40.903
> 
> 标签：python, deployment, sudo, fabric

This question is about best practices. I'm running a deployment script with Fabric. My deployment user 'deploy' needs sudo to restart services. So I am using the sudo function from fabric to run these commands in my script. This works fine but prompts for password during script execution. I DON'T want to type a password during deployments. What's the best practice here. The only solution I can think of is changing the sudo permissions to not require password for the commands my deployment user runs. This doesn't seem right to me.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-08-25T22:54:33.833

理想的解决方案是在您的服务器上创建一个仅用于部署的用户（例如，`deploy`）。然后，`env.user=deploy`在您的 fabfile 中设置。然后在您的服务器上，您可以在 sudoers 文件中逐个命令地授予用户必要的权限：

***重要提示****：始终用于`sudo visudo`修改 sudoers 文件*

```
Cmnd_Alias RELOAD_SITE = /bin/bash -l -c supervisorctl*, /usr/bin/supervisorctl*
deploy ALL = NOPASSWD: RELOAD_SITE 
```

您可以`Cmnd_Alias`根据部署用户的需要添加任意数量的指令，然后授予`NOPASSWD`每个命令的访问权限。有关`man sudoers`更多详细信息，请参阅。

我喜欢保留我的特定于部署的 sudoers 配置，并通过在最后添加：来`/etc/sudoers.d/deploy`包含该文件。`/etc/sudoers``includedir /etc/suoders.d`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-13T11:41:56.557

您可以使用：

```
fabric.api import env
# [...]
env.password = 'yourpassword' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-23T14:41:00.773

最好的方法是使用子任务。您可以*在 fabfile*中提示输入密码，并且永远不要公开任何密码，也不要对远程系统上的 sudo 进行鲁莽的配置更改。

```
import getpass

from fabric.api import env, parallel, run, task
from fabric.decorators import roles
from fabric.tasks import execute

env.roledefs = {'my_role': ['host1', 'host2']}

@task
# @parallel -- uncomment if you need parallel execution, it'll work!
@roles('my_role')
def deploy(*args, **kwargs):
    print 'deploy args:', args, kwargs
    print 'password:', env.password
    run('echo hello')

@task
def prompt(task_name, *args, **kwargs):
    env.password = getpass.getpass('sudo password: ')
    execute(task_name, *args, role='my_role', **kwargs) 
```

请注意，您甚至可以将其与并行执行结合起来，并且该`prompt`任务仍然只运行一次，而该`deploy`任务为角色中的每个主机并行运行。

最后，一个如何调用它的示例：

```
$ fab prompt:deploy,some_arg,another_arg,key=value 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T01:57:31.457

似乎`sudo`毕竟可能不是那么糟糕的选择。您可以指定用户可以运行哪些命令**以及**该命令可能采用的参数 ( `man sudoers`)。如果问题只是必须输入密码，一个选项将涉及使用`pexpect`模块自动登录，也许使用可以加密存储的密码：

```
import pexpect, sys

pwd = getEncryptedPassword()
cmd = "yourcommand" 

sCmd = pexpect.spawn('sudo {0}'.format(cmd))
sCmd.logfile_read = sys.stdout
sCmd.expect('Password:')
sCmd.sendline(pwd)
sCmd.expect(pexpect.EOF) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-28T21:55:56.440

使用[密钥](https://pypi.org/project/keyring/)环模块安全地存储和访问密码。

这是我使用 Fabric 2 的方法：

```
from fabric import task
import keyring

@task
def restart_apache(connection):
    # set the password with keyring.set_password('some-host', 'some-user', 'passwd')
    connection.config.sudo.password = keyring.get_password(connection.host, 'some-user')
    connection.sudo('service apache2 restart') 
```

您还可以使用 GPG 或任何其他命令行密码工具。例如：

```
connection.config.sudo.password = connection.local('gpg --quiet -d /path/to/secret.gpg', hide=True).strip() 
```

该`secret.gpg`文件可以用`echo "mypassword" | gpg -e > secret.gpg`. 该`hide`参数避免将密码回显到控制台。

要保留对 的支持`--prompt-for-sudo-password`，请添加条件：

```
if not connection.config.sudo.password:
    connection.config.sudo.password = keyring.get_password(connection.host, 'some-user') 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-09-28T12:37:14.723

您还可以为多台机器使用密码：

```
from fabric import env
env.hosts = ['user1@host1:port1', 'user2@host2.port2']
env.passwords = {'user1@host1:port1': 'password1', 'user2@host2.port2': 'password2'} 
```

看到这个答案：[https ://stackoverflow.com/a/5568219/552671](https://stackoverflow.com/a/5568219/552671)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2012-12-19T13:30:09.690

正如 Bartek 还建议的那样，在 sudoers 文件中为部署“用户”启用无密码 sudo。

就像是：

```
run('echo "{0} ALL=(ALL) ALL" >> /etc/sudoers'.format(env.user)) 
```

# mysql - MySQL - 两次加入同一张表

> ID：13943350
> 
> 赞同：0
> 
> 时间：2012-12-18T23:43:53.493
> 
> 标签：mysql, sql, join

我有一张叫“预订”的桌子

```
> id     status 
  1      P 
  2      P 
```

另一个叫做“呼叫”

```
id    calldate    type   booking
1     01/01/2012  DEL    1
2     01/02/2012  COL    1
3     01/03/2012  DEL    2
4     31/12/2019  COL    999 
```

我想在 'bookings' ONCE 中列出每条记录，将来自 'call' 的相关记录显示为另一列，如下所示：

```
bookingId    deliverydate  collectiondate
1            01/01/2012    01/02/2012
2            01/03/2012    null 
```

我试过了：

```
select `b`.`bookingid` AS `bookingid`,
       `del`.`calldate` AS `Delivery`,
       `col`.`calldate` AS `Collection`
from `booking` `b`
left join `call` `del` on `b`.`bookingid` = `del`.`booking`
left join `call` `col` on `b`.`bookingid` = `col`.`booking`
where ((`del`.`type` = 'DEL') OR (`col`.`type` = 'COL') and (`b`.`status` = 'P')); 
```

但我将 bookingid 1 列出 3 次。有人可以修复我的加入吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T23:50:03.403

我认为您想将类型移动到连接条件中：

```
select `b`.`bookingid` AS `bookingid`,
   `del`.`calldate` AS `Delivery`,
   `col`.`calldate` AS `Collection`
from `booking` `b`
left join `call` `del` on `b`.`bookingid` = `del`.`booking` AND `del`.`type` = 'DEL'
left join `call` `col` on `b`.`bookingid` = `col`.`booking` AND `col`.`type` = 'COL'
where `b`.`status` = 'P'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:50:28.077

你不需要加入同一张桌子两次，你可以使用这个：

```
SELECT
  `call`.booking,
  max(case when type='DEL' then calldate end) as deliverydate,
  max(case when type='COL' then calldate end) as collectiondate
FROM
  booking inner join `call`
  on booking.id=`call`.booking
WHERE
  booking.status='P'
GROUP BY `call`.booking 
```

# java - How to specify the ciphersuite to be used in SSL session

> ID：13943351
> 
> 赞同：12
> 
> 时间：2012-12-18T23:43:55.430
> 
> 标签：java, sockets, networking, ssl, network-programming

I have created a socket on port 443 as in the following line:

```
socket = (SSLSocket) factory.createSocket(hostName, port); 
```

Then, I wanted to see the enabled ciphersuites in this socket, I used:

```
String[] enCiphersuite=socket.getEnabledCipherSuites();
System.out.println("Enabled ciphersuites are: "+Arrays.toString(enCiphersuite)); 
```

Then, I want to pick only one ciphersuite that I want my application to use when creating handshake with the remote server. I did the following:

```
String pickedCipher[] ={"TLS_RSA_WITH_AES_128_CBC_SHA"}; 
socket.setEnabledCipherSuites(pickedCipher);
System.out.println("ciphersuite set to: "+Arrays.toString(pickedCipher)); 
```

Then I made the handshake, and checked the session ciphersuite:

```
socket.startHandshake();
System.out.println("Session ciphersuite is"+socket.getSession().getCipherSuite() ); 
```

But I found that the name of the cipher printed in the previous printout statement after the handshake (as I understand, this is the actually used cipher in the session) is not what I set earlier using `setEnabledCipherSuites()`

Why am I still not see my chosen ciphersuite is the used one ? and also, I also tried to `getEnabledCipherSuites()` and print it out after I `setEnabledCipherSuites` and found the list has not changed to what I have set. I am not sure when I print the enabled ciphersuite, is this list of ciphersuites depends on Java and always the same list, or depends on the client or on the server? Can any body explain ?

**EDIT:** Before the handshake I only have the following lines:

```
SSLSocketFactory factory = HttpsURLConnection.getDefaultSSLSocketFactory(); 
SSLSocket socket=null;
try {
socket = (SSLSocket) factory.createSocket(hostName, port);
socket.setSoTimeout(15000); 
socket.startHandshake(); //handshake
.
. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-22T23:29:12.593

> 我发现我在 setEnableCipherSuite() 之前添加了 socket.getsession() 以便在设置之前打印出启用的密码。当我删除它时，密码已设置。这是为什么 ？

如[`SSLSocket`JavaDoc](http://docs.oracle.com/javase/7/docs/api/javax/net/ssl/SSLSocket.html)中所述：

> 可以通过以下三种方式之一启动此连接的初始握手：
> 
> *   调用显式开始握手的 startHandshake，或
> *   任何在此套接字上读取或写入应用程序数据的尝试都会导致隐式握手，或者
> *   **如果当前没有有效会话，则调用 getSession 会尝试建立会话，并且完成了隐式握手**。

如果您在调用`getSession()`之前先调用`setEnabledCipherSuite()`，则当您尝试设置启用的密码套件时，握手已经完成，因此该会话的密码套件已经被选中。

# php - PHP正则表达式和URL解析

> ID：13943357
> 
> 赞同：0
> 
> 时间：2012-12-18T23:44:27.530
> 
> 标签：php, parsing

如何 `preg_replace`在 PHP 中使用来解析 url。

说我有网址

[http://google.com?id=123](http://google.com?id=123)

我想访问网址的每一部分，这样

```
echo $protocol; 
```

会打印

```
http 
```

或者

```
echo $domain; 
```

会打印

```
google 
```

和

```
echo $upperDomain; 
```

印刷

```
com 
```

最后，

```
echo $rest; 
```

会打印

```
?id=123 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T23:47:55.567

有一个功能：[parse_url()](http://php.net/manual/en/function.parse-url.php)

```
$url = 'http://google.com?id=123';    
print_r(parse_url($url)); 
```

印刷：

```
Array
(
    [scheme] => http
    [host] => google.com
    [query] => id=123
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:47:32.983

[parse_url()](http://php.net/manual/en/function.parse-url.php) 来自文档...

```
 mixed parse_url ( string $url [, int $component = -1 ] )

This function parses a URL and returns an associative array containing any of the   
various components of the URL that are present.

This function is not meant to validate the given URL, it only breaks it up into the 
above listed parts. Partial URLs are also accepted, parse_url() tries its best to   
parse them correctly. 
```

# android - Supported devices is extremely low

> ID：13943361
> 
> 赞同：7
> 
> 时间：2012-12-18T23:45:01.560
> 
> 标签：android, xml

I have an app that should be supported on a huge number of devices, and yet when I upload it to Google Play, it says only 3 (out of 2263) are supported.

My manifest looks like this (minus Activities):

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="MYPACKAGE"
android:versionCode="101"
android:versionName="@string/app_version" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="15" />

<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
<uses-permission android:name="android.permission.VIBRATE" />
<uses-permission android:name="android.permission.READ_CONTACTS" />
<uses-permission android:name="com.android.vending.BILLING" />
<uses-permission android:name="android.permission.CAMERA" />

<uses-feature android:name="android.hardware.camera.any" />

<supports-screens
    android:anyDensity="true"
    android:largeScreens="false"
    android:normalScreens="true"
    android:smallScreens="true"
    android:xlargeScreens="false" />

<application
    android:name=".MYApplication"
    android:hardwareAccelerated="true"
    android:icon="@drawable/app_icon"
    android:label="@string/app_name"
    android:theme="@style/RPTheme" >

    ACTIVITY DECLARATIONS ARE HERE

    <service android:name="com.parse.PushService" />

    <receiver android:name="com.parse.ParseBroadcastReceiver" >
        <intent-filter>
            <action android:name="android.intent.action.BOOT_COMPLETED" />
            <action android:name="android.intent.action.USER_PRESENT" />
        </intent-filter>
    </receiver>
    <receiver android:name="MYPACKAGE.PushReceiver" >
        <intent-filter>
            <action android:name="1" />
        </intent-filter>
    </receiver>

</application> 
```

Also, I've replaced my package name with MYPACKAGE.

Now that I'm looking at it again, perhaps this has to do with android:hardwareAccelerated="true" ? But my understanding is that XML declarations are ignored by API levels that don't support them.

Anyone have any ideas about what is going on here? Is there anywhere else the Play store looks for what devices are supported?

Thanks for your help!

EDIT:

Looks like it was indeed the android.hardware.camera.any, as noted below. I've replace that with:

```
<uses-feature
    android:name="android.hardware.camera"
    android:required="false" />
<uses-feature
    android:name="android.hardware.camera.front"
    android:required="false" /> 
```

And my app now has 2k+ supported devices.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-18T23:51:40.020

尝试注释掉或更改：

```
<uses-feature android:name="android.hardware.camera.any" /> 
```

`PackageManager` [在 Android 4.2 中添加了](http://developer.android.com/reference/android/content/pm/PackageManager.html#FEATURE_CAMERA_ANY)等效值。[这个问题](http://code.google.com/p/android/issues/detail?id=35166)说：

> 但是，Play Store 需要新的逻辑来为具有较旧操作系统版本的设备提供向后兼容性，该版本尚未准备好。
> 
> 因此，在该支持到位之前，请勿使用“android.hardware.camera.any”，因为任何需要它的应用程序都无法安装在运行 4.2 之前版本的设备上。

那是一个月前写的，你的经验表明情况仍然如此。

# javascript - carousal jquery not working in single file

> ID：13943364
> 
> 赞同：-1
> 
> 时间：2012-12-18T23:45:13.260
> 
> 标签：javascript, jquery-ui, jquery, jquery-plugins

my carousal works properly in the js fiddle but when i put all my js, html and css code in a single file it does not work properly

working code

[http://jsfiddle.net/9Dr7T/61/embedded/result/](http://jsfiddle.net/9Dr7T/61/embedded/result/)

[http://jsfiddle.net/9Dr7T/61/](http://jsfiddle.net/9Dr7T/61/)

single code does not work which i am providing below... but when i do in js fiddle its working [http://jsfiddle.net/ApeDd/](http://jsfiddle.net/ApeDd/) the problem is if i save it in my machine and open it in chrome its not working

```
<!DOCTYPE html>
<html lang="en" xmlns:fb="http://www.facebook.com/2008/fbml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <!-- End MS Site Pinning-->
        <link href="css/carousel-smMags.css" rel="stylesheet" type="text/css" />
        <!-- <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script> -->
        <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <style>

          div { color:red; }

a, img{border: 1px solid red;}

.carousel-hdr  {
    width:806px;
    margin:46px auto 0;
}
.carousel-hdr .bold {
    text-transform: uppercase;
    font-size: 15px;
    color: #3f4444;
    font-weight:400;
}
.carousel-hdr .rightlink {
    font-weight:300;
    font-size: 14px;
}

.carousel-hdr .dark-double {
    margin-top:10px;
}
.magHeroCarousel {
    color: #999999;
    z-index: 0;
    position: relative;
    height: 260px; /* note - change to 280 when sprites/reading list is functioning */
    overflow: hidden;
    margin: 25px 0 0 0;
    }

.magHeroCarousel .opaque.caroSmallLeft, 
.magHeroCarousel .opaque.caroSmallRight {
    box-shadow: none;
    height: 300px;
    position: absolute;
    top: 0;
    width: 43px;
    z-index: 101;
    cursor:pointer;
    background-attachment: scroll;
    background-color: transparent;
    /*background-image: url(http://imgs.zinio.com/www/images/ui/grid-carousel-nav.png);*/
    background-repeat: no-repeat;
    background-position: 0 0;
    }
.magHeroCarousel .opaque.caroSmallLeft:hover, 
.magHeroCarousel .opaque.caroSmallRight:hover {
    /*background-image: url(http://imgs.zinio.com/www/images/ui/grid-carousel-nav-hover.png); */
    }

.magHeroCarousel .opaque.caroSmallLeft {
    background-position: 0px 96px;
    background-color: green;
    left: 0px;
    border: 1px solid black;

    }

.magHeroCarousel .opaque.caroSmallRight {
    background-position: -43px 96px;
    right: 0px;
    background-color:red;
    height:300px;
        border: 1px solid black;

    }

.magHeroCarousel .caroContainer {
    position: absolute;
    top: 0px;
    left: 62px;
    height: 100%;
    z-index: 3;
    }

.magHeroCarousel .caroContainer img {
    width:185px;
   /* height:auto;*/
    }

.magHeroCarousel .caroContainer .grouping {
    height: 300px;
    }
.magHeroCarousel .caroContainer .active {
    margin-left: 31px;  
    }

.magHeroCarousel .caroContainer .grouping div a {
    margin-right: 26px;
    display:block;
    }

.magHeroCarousel .caroContainer .grouping a {
    margin-right: 26px;
    }

.magHeroCarousel .caroContainer .grouping :last-child a {
    margin-right: 52px;
    }

.magHeroCarousel .caroContainer div {
    float: left;
    }

.magHeroCarousel .caroContainer div p {
    margin: 8px 0 0 0;
    display: none;
    }

.magHeroCarousel .caroContainer div.active p {
    display: block;
    }

.magHeroCarousel .caroContainer div p span {
    background: url(http://imgs.zinio.com/www/images/sprites/carouselSprite.png) no-repeat;
    padding-left: 50px;
    color:#888888;
    font-size:10px;
    }

.magHeroCarousel .caroContainer div p :first-child {
    background-position: 0 -71px;
    }

.magHeroCarousel .caroContainer div p :last-child {
    background-position: 0 -47px;
    }

.magHeroCarousel .caroContainer p :first-child {
    margin: 0 7px 0 0;
    }
.sprites {
    display: block;
    margin-top: 5px;
}    
.fave span {
    margin-right: 0px;
    bottom: 0px;
}
.read span {
    margin-right: 0px;
    bottom: 0px;
}

​

        </style>

        <script>

/************************************* 
 *   z-carousel.jquery.js
 */

(function($) {
    'use strict';

    $.fn.zCarousel = function() {

        return this.each(function() {
            var $this = $(this),
                $kids = $this.children("div"),
                prevBtn = document.createElement("div"),
                nextBtn = document.createElement("div"),
                pagerWidth, childLength, childWidth, leftMagTitle, rightMagTitle, forPrependingOne, forAppendingOne, $prevArticleBlock, $nextArticleBlock, link;

            $kids.addClass("caroContainer");
            prevBtn.setAttribute("class", "caroSmallLeft");
            nextBtn.setAttribute("class", "caroSmallRight");

            function lazyLoad() {
                var $active = $this.find(".active"),
                    $currentImg = $active.find('img');

                $currentImg.each(function(i) {
                    $($currentImg[i]).attr('src', $($currentImg[i]).data('lazyload'))
                })
            }

            if ($this.attr("data-carouselType") === "magazineHero") {
                $(prevBtn).addClass("opaque");
                $(nextBtn).addClass("opaque");
                this.appendChild(prevBtn);
                this.appendChild(nextBtn);
                pagerWidth = $(prevBtn).width();
                childLength = $kids.children().length;
                $kids.css("left", pagerWidth + "px").children("div").addClass("grouping");
                childWidth = $kids.children("div").width();
                leftMagTitle = document.createElement("div");
                rightMagTitle = document.createElement("div");
                prevBtn.appendChild(leftMagTitle);
                nextBtn.appendChild(rightMagTitle);
                $kids.width(childLength * childWidth);
                $kids.children(":first-child").addClass("active");
                $kids.css("left", (pagerWidth - $this.find(".caroContainer").children("div").width()) + "px");

                forPrependingOne = $kids.children(":eq(" + (childLength - 1) + ")").clone();
                $kids.children(":eq(" + (childLength - 1) + ")").remove();
                $kids.prepend(forPrependingOne);

                $kids.click(function(e) {
                    link = $(e.target).parents(this).children("a").attr("href");
                    if ($(e.target).parents(this) && e.target.tagName !== "IMG" && e.target.tagName !== "INPUT" && e.target.tagName !== "A" && link !== undefined) {
                        e.preventDefault();
                        document.location = link;
                    }
                });

                lazyLoad();

                $(prevBtn).click(function() {
                    forPrependingOne = $kids.children(":eq(" + (childLength - 1) + ")").clone();
                    $kids.children(":eq(" + (childLength - 1) + ")").remove();
                    $kids.prepend(forPrependingOne);
                    $kids.animate({
                        left: '-=' + childWidth
                    }, 0).animate({
                        left: '+=' + childWidth
                    }, 250);
                    $kids.children(".active").removeClass("active").prev().addClass("active");
                    $(leftMagTitle).empty().append($kids.find(".grouping.active").prev("div").children(".articleInfo").children("h3").clone()).append($kids.find(".grouping.active").prev("div").children(".articleInfo").children(":first-child").clone());
                    $(rightMagTitle).empty().append($kids.find(".grouping.active").next("div").children(".articleInfo").children("h3").clone()).append($kids.find(".grouping.active").next("div").children(".articleInfo").children(":first-child").clone());
                    lazyLoad();
                });

                $(nextBtn).click(function() {
                    forAppendingOne = $kids.children(":eq(0)").clone();
                    $kids.children(":eq(0)").remove();
                    $kids.append(forAppendingOne);
                    $kids.animate({
                        left: '+=' + childWidth
                    }, 0).animate({
                        left: '-=' + childWidth
                    }, 250);
                    $kids.children(".active").removeClass("active").next().addClass("active");
                    lazyLoad();
                });
            }
        });
    };
}(jQuery));

/************************************* 
 *   zin-carousel2.js 
 */

;
(function($, window, document, undefined) {
    'use strict';

    /************************************* 
     *   Jquery Plugin Setup 
     */
    $.fn.zinCarousel = function(settings) {
        var settings = $.extend({}, $.fn.zinCarousel.defaultSettings, settings || {});
        return this.each(function() {
            var o = $.extend(true, {}, settings),
                $elem = $(this),
                caro = new Carousel(o, $elem);
            caro.init();
        });
    };

    /************************************* 
     *   Default Settings 
     */
    $.fn.zinCarousel.defaultSettings = { /* settings */
        keyboadNav: true,
        handleSubData: false,
        autoPlay: false,
        autoPlayDuration: 4000,
        animationSpeed: 250,
        easing: 'easeInOutExpo',
        /* elements */
        body: 'body',
        viewPort: '#view-port',
        parent: '.carousel_ul',
        kids: '.carousel_ul li',
        firstKid: '.carousel_ul li:first',
        lastKid: '.carousel_ul li:last-of-type',
        prevBtn: '.caroLeft',
        nextBtn: '.caroRight',
        active: '.active',
        startPosition: ':nth-child(4)',
        leftMagTitle: '#leftMagTitle',
        rightMagTitle: '#rightMagTitle'
    };

    /************************************* 
     *   Main Carousel Object {}
     */

    function Carousel(settings, elem) { /* Settings */
        this.settings = settings;
        this.animationSpeed = this.settings.animationSpeed;
        this.startPosition = this.settings.startPosition;
        this.handleSubData = this.settings.handleSubData;
        this.autoplay = this.settings.autoPlay;
        this.autoplayDuration = this.settings.autoPlayDuration; /* Elements */
        // this.$elem = $(elem);
        this.$body = $(this.settings.body);
        this.$viewPort = $(this.settings.viewPort);
        this.$parent = $(this.settings.parent);
        this.$$kids = $(this.settings.kids);
        this.$prevBtn = $(this.settings.prevBtn);
        this.$nextBtn = $(this.settings.nextBtn);
        this.$leftMagTitle = $(this.settings.leftMagTitle);
        this.$rightMagTitle = $(this.settings.rightMagTitle); /* strings */
        this.parentString = this.settings.parent;
        this.firstKidString = this.settings.firstKid;
        this.lastKidString = this.settings.lastKid;
        this.active = this.settings.active;
        this.activeString = this.active.replace(/^\.+/, ''); /* local settings */
        this.itemWidth = this.$$kids.outerWidth(true);
        this.leftIndent = parseInt(this.$parent.css('left'), 10);
        this.easingStyle = this.settings.easing;
        this.leftOffset = this.$parent.css('left');
        this.isAutoPlaying = false;
        return this;
    }

    /************************************* 
     *   Methods
     */
    Carousel.prototype = {

        init: function(elem) {
            // set the active element
            this.$parent.children(this.startPosition).addClass(this.activeString);
            this.lazyLoad();
            this.setEvents(this);
            if (this.handleSubData) {
                this.setMagTitle();
            }
            if (this.autoplay) {
                this.autoPlay();
                this.isAutoPlaying = true;
            }
        },

        setEvents: function(_this) {
            // Previous Button Event
            this.$prevBtn.on('click', function(e) {
                _this.prevAction();
            });

            // Next Button Event
            this.$nextBtn.on('click', function(e) {
                _this.nextAction();
            });

            // Capture click on viewport above image
            this.$viewPort.on('click', function(e) {
                _this.mainMediaClick(e);
            });

            this.$viewPort.on('mouseover', function(e) {
                if (_this.isAutoPlaying) {
                    _this.stopAutoPlay();
                }
            });

            this.$viewPort.on('mouseout', function(e) {
                if (_this.autoplay) {
                    _this.autoPlay();
                }
            });

            // Keyboard Navigation Event
            if (this.settings.keyboadNav) {
                _this.$body.on('keydown', function(e) {
                    _this.keyboardNav(e);
                });
            }

        },

        prevAction: function() {
            this.animate('prev');
        },

        nextAction: function() {
            this.animate('next');
        },

        keyboardNav: function(e) {
            switch (e.keyCode) {
                // left arrow
            case 37:
                this.prevAction();
                break;
                // right arrow
            case 39:
                this.nextAction();
                break;
            }
        },

        autoPlay: function() {
            var _this = this;
            if (this.autoplay) {
                this.run = window.setInterval(function() {
                    _this.nextAction();
                }, this.autoplayDuration);
                this.isAutoPlaying = true;
            }
        },

        stopAutoPlay: function() {
            this.isAutoPlaying = false;
            window.clearInterval(this.run);
        },

        clearAutoPlay: function() {
            clearInterval(this.run);
            this.autoPlay();
        },

        mainMediaClick: function(e) {
            var link = this.findActive().find('a').attr('href');
            e.preventDefault();
            window.location = link;
        },

        findActive: function() {
            return this.$parent.find(this.active);
        },

        lazyLoad: function() {
            var $active = this.findActive(),
                $currentImg = $active.find('img'),
                $nextImg = $active.next('li').find('img'),
                $nextImgP = $active.next('li').next('li').find('img'),
                $previousImg = $active.prev('li').find('img'),
                $previousImgP = $active.prev('li').prev('li').find('img');

            $nextImg.attr('src', $nextImg.data('lazyload'));
            $nextImgP.attr('src', $nextImgP.data('lazyload'));
            $previousImg.attr('src', $previousImg.data('lazyload'));
            $previousImgP.attr('src', $previousImgP.data('lazyload'));
            $currentImg.attr('src', $currentImg.data('lazyload'));
        },

        setMagTitle: function() {
            var articleInfoPrev = this.findActive().prev('li').children('.articleInfo').children().clone(),
                articleInfoNext = this.findActive().next('li').children('.articleInfo').children().clone();
            this.$leftMagTitle.find('div').empty().append(articleInfoPrev);
            this.$rightMagTitle.find('div').empty().append(articleInfoNext);
        },

        swapKids: function(direction) {
            var _this = this,
                firstKid = $(this.firstKidString),
                lastKid = $(this.lastKidString);
            if (direction === 'prev') {
                _this.$parent.css({
                    'left': _this.leftOffset
                });
                firstKid.before(lastKid);
            } else if (direction === 'next') {
                _this.$parent.css({
                    'left': _this.leftOffset
                });
                lastKid.after(firstKid);
            }
        },

        animate: function(direction) {
            var _this = this,
                current = this.findActive(),
                left_indent, currentDirection, articleInfo = current.children('.articleInfo'),
                animateParent = $(this.parentString + ':not(:animated)');

            if (direction === 'prev') {
                left_indent = (this.leftIndent + this.itemWidth) + 'px';
                currentDirection = current.prev();
            } else if (direction === 'next') {
                left_indent = (this.leftIndent - this.itemWidth) + 'px';
                currentDirection = current.next();
            }

            articleInfo.css({
                'display': 'none'
            });

            animateParent.animate({
                'left': left_indent
            }, this.animationSpeed, this.easingStyle, function() {
                _this.swapKids(direction);
                currentDirection.children('.articleInfo').end().addClass(_this.activeString);
                current.removeClass(_this.activeString);
                _this.lazyLoad();
                // articleInfo.css({
                //     'display': 'block'
                // });
                if (_this.handleSubData) {
                    _this.setMagTitle();
                }
                if (_this.autoplay) {
                    _this.clearAutoPlay();
                }
            });
        }
    };

    $.extend($.easing, {
        def: 'easeOutQuad',
        swing: function(x, t, b, c, d) {
            //alert($.easing.default);
            return $.easing[$.easing.def](x, t, b, c, d);
        },
        easeInQuad: function(x, t, b, c, d) {
            return c * (t /= d) * t + b;
        },
        easeOutQuad: function(x, t, b, c, d) {
            return -c * (t /= d) * (t - 2) + b;
        },
        easeInOutQuad: function(x, t, b, c, d) {
            if ((t /= d / 2) < 1) return c / 2 * t * t + b;
            return -c / 2 * ((--t) * (t - 2) - 1) + b;
        },
        easeInCubic: function(x, t, b, c, d) {
            return c * (t /= d) * t * t + b;
        },
        easeOutCubic: function(x, t, b, c, d) {
            return c * ((t = t / d - 1) * t * t + 1) + b;
        },
        easeInOutCubic: function(x, t, b, c, d) {
            if ((t /= d / 2) < 1) return c / 2 * t * t * t + b;
            return c / 2 * ((t -= 2) * t * t + 2) + b;
        },
        easeInQuart: function(x, t, b, c, d) {
            return c * (t /= d) * t * t * t + b;
        },
        easeOutQuart: function(x, t, b, c, d) {
            return -c * ((t = t / d - 1) * t * t * t - 1) + b;
        },
        easeInOutQuart: function(x, t, b, c, d) {
            if ((t /= d / 2) < 1) return c / 2 * t * t * t * t + b;
            return -c / 2 * ((t -= 2) * t * t * t - 2) + b;
        },
        easeInQuint: function(x, t, b, c, d) {
            return c * (t /= d) * t * t * t * t + b;
        },
        easeOutQuint: function(x, t, b, c, d) {
            return c * ((t = t / d - 1) * t * t * t * t + 1) + b;
        },
        easeInOutQuint: function(x, t, b, c, d) {
            if ((t /= d / 2) < 1) return c / 2 * t * t * t * t * t + b;
            return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;
        },
        easeInSine: function(x, t, b, c, d) {
            return -c * Math.cos(t / d * (Math.PI / 2)) + c + b;
        },
        easeOutSine: function(x, t, b, c, d) {
            return c * Math.sin(t / d * (Math.PI / 2)) + b;
        },
        easeInOutSine: function(x, t, b, c, d) {
            return -c / 2 * (Math.cos(Math.PI * t / d) - 1) + b;
        },
        easeInExpo: function(x, t, b, c, d) {
            return (t == 0) ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;
        },
        easeOutExpo: function(x, t, b, c, d) {
            return (t == d) ? b + c : c * (-Math.pow(2, -10 * t / d) + 1) + b;
        },
        easeInOutExpo: function(x, t, b, c, d) {
            if (t == 0) return b;
            if (t == d) return b + c;
            if ((t /= d / 2) < 1) return c / 2 * Math.pow(2, 10 * (t - 1)) + b;
            return c / 2 * (-Math.pow(2, -10 * --t) + 2) + b;
        },
        easeInCirc: function(x, t, b, c, d) {
            return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;
        },
        easeOutCirc: function(x, t, b, c, d) {
            return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;
        },
        easeInOutCirc: function(x, t, b, c, d) {
            if ((t /= d / 2) < 1) return -c / 2 * (Math.sqrt(1 - t * t) - 1) + b;
            return c / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;
        },
        easeInElastic: function(x, t, b, c, d) {
            var s = 1.70158;
            var p = 0;
            var a = c;
            if (t == 0) return b;
            if ((t /= d) == 1) return b + c;
            if (!p) p = d * .3;
            if (a < Math.abs(c)) {
                a = c;
                var s = p / 4;
            }
            else var s = p / (2 * Math.PI) * Math.asin(c / a);
            return -(a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;
        },
        easeOutElastic: function(x, t, b, c, d) {
            var s = 1.70158;
            var p = 0;
            var a = c;
            if (t == 0) return b;
            if ((t /= d) == 1) return b + c;
            if (!p) p = d * .3;
            if (a < Math.abs(c)) {
                a = c;
                var s = p / 4;
            }
            else var s = p / (2 * Math.PI) * Math.asin(c / a);
            return a * Math.pow(2, -10 * t) * Math.sin((t * d - s) * (2 * Math.PI) / p) + c + b;
        },
        easeInOutElastic: function(x, t, b, c, d) {
            var s = 1.70158;
            var p = 0;
            var a = c;
            if (t == 0) return b;
            if ((t /= d / 2) == 2) return b + c;
            if (!p) p = d * (.3 * 1.5);
            if (a < Math.abs(c)) {
                a = c;
                var s = p / 4;
            }
            else var s = p / (2 * Math.PI) * Math.asin(c / a);
            if (t < 1) return -.5 * (a * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p)) + b;
            return a * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * d - s) * (2 * Math.PI) / p) * .5 + c + b;
        },
        easeInBack: function(x, t, b, c, d, s) {
            if (s == undefined) s = 1.70158;
            return c * (t /= d) * t * ((s + 1) * t - s) + b;
        },
        easeOutBack: function(x, t, b, c, d, s) {
            if (s == undefined) s = 1.70158;
            return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;
        },
        easeInOutBack: function(x, t, b, c, d, s) {
            if (s == undefined) s = 1.70158;
            if ((t /= d / 2) < 1) return c / 2 * (t * t * (((s *= (1.525)) + 1) * t - s)) + b;
            return c / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2) + b;
        },
        easeInBounce: function(x, t, b, c, d) {
            return c - $.easing.easeOutBounce(x, d - t, 0, c, d) + b;
        },
        easeOutBounce: function(x, t, b, c, d) {
            if ((t /= d) < (1 / 2.75)) {
                return c * (7.5625 * t * t) + b;
            } else if (t < (2 / 2.75)) {
                return c * (7.5625 * (t -= (1.5 / 2.75)) * t + .75) + b;
            } else if (t < (2.5 / 2.75)) {
                return c * (7.5625 * (t -= (2.25 / 2.75)) * t + .9375) + b;
            } else {
                return c * (7.5625 * (t -= (2.625 / 2.75)) * t + .984375) + b;
            }
        },
        easeInOutBounce: function(x, t, b, c, d) {
            if (t < d / 2) return $.easing.easeInBounce(x, t * 2, 0, c, d) * .5 + b;
            return $.easing.easeOutBounce(x, t * 2 - d, 0, c, d) * .5 + c * .5 + b;
        }
    });
}(jQuery, window, document));

/************************************* 
 home.js
 */

$(document).ready(function() { /* small magazine carousel */
    $(".magHeroCarousel").zCarousel();

    /* large article hero  carousel */
    $(".carousel_container").zinCarousel({ /* settings */
        keyboadNav: true,
        autoPlay: false,
        autoPlayDuration: 1000,
        animationSpeed: 400,
        handleSubData: true,
        easing: "swing" /***** CORRECTION: comma deleted *****/
        //easeInOutExpo, swing, easeInOutBack, easeInOutElastic(1500),
    });

});​

        </script>

    </head>
    <body>
        <div class="wrapper" style="width: 330px;">

        <!-- top sellers carousel -->
                <div class="magHeroCarousel" data-carouselType="magazineHero">
                    <div>
                        <div>
                            <div class="specialHover">      
                                    <img src="img/grey.gif" data-lazyload="" width="200" height="187" alt="1" title="AppleMagazine" class="cover lazy" style="background-color: black;" />
                            </div>  
                        </div>
                        <div>
                            <div class="specialHover">
                                    <img src="" data-lazyload="" width="200" height="187" alt="2" title="iPhone Life" class="cover lazy" style="background-color: yellow;" />
                            </div>
                        </div>
                        <div>
                            <div class="specialHover">
                                <img src="" data-lazyload="" width="200" height="187" alt="3" title="Popular Science" class="cover lazy" style="background-color: pink;" />
                            </div>
                        </div>

                    </div>
                </div>

        <!-- deals carousel -->

        <!-- end magHeroCarousel -->

        </div><!--end wrapper -->

    </body>
</html> 
```

​</p>

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T01:08:15.717

默认情况下，Chrome 会阻止使用该`file://`协议加载的 Javascript。（这包括以这种方式加载的文件中的任何 Javascript `.htm/.html`，或此类文件使用相对链接加载的脚本文件）

这是一个很好的安全措施，我不建议绕过。特别是如果您想在本地机器上开发网站，我建议您安装一个网络服务器（[WAMPServer](http://www.wampserver.com)是一个非常用户友好的软件包，可以帮助您入门）。设置 WAMPServer 时，系统会提示您为服务器的根目录设置一个文件夹。此文件夹将是您放置网站中使用的任何文件的位置（WAMP 默认为`C:\WAMP\www`）。然后可以通过打开浏览器并导航到该文件夹​​中的任何文件来访问，`http://localhost/filename.extension`并且其行为就像是从外部服务器加载一样（有一些例外，但这些不在此答案的范围内，因为您不太可能遇到它们）。

如果您仍然反对安装网络服务器，那么您可以通过创建 Chrome 的新快捷方式将 Chrome 切换到允许本地 Javascript 的模式。右键单击该快捷方式，选择属性，然后在目标字段中，将以下内容添加到末尾（引号后）：

```
 --allow-file-access --allow-file-access-from-files 
```

但仅在查看这些本地文件时在特定情况下使用该新快捷方式。
每当您浏览互联网时，都会正常启动 Chrome。

# java - How to use CallBackScript properly in Wicket 6.x

> ID：13943367
> 
> 赞同：2
> 
> 时间：2012-12-18T23:45:28.890
> 
> 标签：java, ajax, wicket-1.6, wicket-6

in Wicket 1.x I used an AjaxEventBehavior to place a CallBackScript that delivers me the mouse coordinates. This is what I did: (getEventX() and getEventY() are JavaScript Functions)

```
 myObject.add(new AjaxEventBehavior("onClick") {
        private static final long serialVersionUID = 1L;

        @Override
        protected CharSequence getCallbackScript() {
            return generateCallbackScript("wicketAjaxGet('" + getCallbackUrl()
                    + "&x=' + getEventX(this, event) + '&y=' + getEventY(this, event)");
        }

        @Override
        protected void onEvent(AjaxRequestTarget target) {
            final Request request = MyPage.this.getRequest();
            final IRequestParameters parameters = request.getRequestParameters();
            final int x = Integer.parseInt(parameters.getParameterValue("x").toString("0"));
            final int y = Integer.parseInt(parameters.getParameterValue("y").toString("0")); 
```

That worked quite well. But I don't get how to do this with Wicket 6.x

I do understand, that the way the Ajax link is working was changed. So I tried to use getCallBackUrl in the same way than before. But that did not work.

```
 public CharSequence getCallbackUrl() {
            final CharSequence callBackUrl = super.getCallbackUrl();

            return callBackUrl + "&x=' + getEventX(this, event) + '&y=' + getEventY(this, event)";
        } 
```

When I take a look at the generated HTML I can see the ajax link looks like this:

```
Wicket.Ajax.ajax({"u":"../page?5-2.IBehaviorListener.2-cityMap&x=' + getEventX(this, event) + '&y=' + getEventY(this, event)","e":"click","c":"cityMap","i":"id29--ajax-indicator"});; 
```

Looks good, but it does not work.

I am pretty sure, I am doing something wrong since wicket 6 but I dont know how to do it the right way.

Any suggestions are greatly appreciated.

cheers Reinhard

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-09T01:41:31.023

我认为这是一种优雅而直接的方式

[https://stackoverflow.com/a/23555297/463918](https://stackoverflow.com/a/23555297/463918)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-13T14:09:28.907

我最近在我的博客中发布了关于 Wicket 6 AJAX-Behaviors 的操作指南，其中还包括将参数从 javascript 传递到服务器：

[http://tom.hombergs.de/2013/01/rolling-your-own-ajax-behavior-with.html](http://tom.hombergs.de/2013/01/rolling-your-own-ajax-behavior-with.html)

另一个描述 Wicket 6 的新 AJAX 功能的有用资源是：[https](https://cwiki.apache.org/WICKET/wicket-ajax.html) ://cwiki.apache.org/WICKET/wicket-ajax.html 。

希望有帮助。如果不是，请描述单击链接时遇到的错误类型（javascript 错误？）。

问候，汤姆

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-05-21T13:41:16.273

尝试这个

```
public class MyAjaxButton extends AjaxButton {

  @Override
  protected void onEvent(final AjaxRequestTarget target) {
    HttpServletRequest request = (HttpServletRequest) MyAjaxButton.this.getForm().getRequest().getContainerRequest();
    System.out.println("onEvent: " + request.getMethod());
  }

  @Override
  public void renderHead(final Component component, final IHeaderResponse response) {
    super.renderHead(component, response);
    response.render(OnDomReadyHeaderItem.forScript(this.createAjaxCallbackScript()));
  }

  /**
   * Creates a javascript to perform a post callback
   * @return A script to use in renderHead as ajax callback
   */
   private String createAjaxCallbackScript() {
     final String formId = MyAjaxButton.this.getForm().getMarkupId();
     String call = "Wicket.Ajax.ajax({'m':'post', 'f':'" + formId + "', 'u':'" + this.getCallbackUrl() + "', 'e':'click', 'c':'" + MyAjaxButton.this.getMarkupId() + "'})";
    // You need to have "; return false;" to prevent the normal operation of a submit button (by browser)
    return call + "; return false;";
  }

  @Override
  public CharSequence getPreconditionScript() {
    // Note: You need this "return false;" in addition to prevent the additional (GET) ajax request done (by wicket)
    return "return false;";
  }
} 
```

要编辑回调脚本，请参阅： [http ://wicket.apache.org/guide/guide/ajax.html#ajax_5](http://wicket.apache.org/guide/guide/ajax.html#ajax_5)

注意：如果您没有脚本的“return false”语句，您将收到额外的无意义请求

# sql - 没有系统管理员权限的 OpenRowSet 和 OpenDataSet

> ID：13943370
> 
> 赞同：3
> 
> 时间：2012-12-18T23:45:57.483
> 
> 标签：sql, sql-server, sql-server-2008

有什么方法可以在 SQL Server 2008 R2 中使用 OpenRowSet 和 OpenDataSet 命令而无需拥有 SysAdmin 权限？

我正在尝试从 Excel 文件加载数据，而我们将执行实际加载的服务帐户没有系统管理员权限。

它目前不是链接的“服务器”，文件名可以逐月更改。

这是我的查询：

```
SELECT  
  Center,
  Amount 
FROM OPENROWSET(
  'Microsoft.ACE.OLEDB.12.0'
  ,'Excel 8.0;HDR=NO;Database=C:\exceldata.xls'
  ,'SELECT 
      F1 as Center,
      F2 as Amount
   FROM [Sheet1$]')
WHERE Amount > 0 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-13T13:47:11.757

我有同样的问题并使用此说明解决它[http://www.johnsoer.com/blog/?p=538](http://www.johnsoer.com/blog/?p=538)

很快：将双字注册键 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Microsoft SQL Server\YOUR_MSSQL_VERSION.YOR_INSTANCE_NAME\Providers\Microsoft.ACE.OLEDB.12.0\DisallowAdhocAccess 添加到 0

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:52:40.830

您不一定需要系统管理员权限，只需要`ADMINISTER BULK OPERATIONS`权限（这是服务器级别的权限，但不完全是系统管理员）。

如果这不是一个选项，您可以尝试设置链接服务器连接并按照本文中的方法进行[操作](https://stackoverflow.com/questions/4777906/sql-server-2008-openrowset-permission-issue)。

# dialog - JuiceUI Dialog Post Back Script Error: Circular reference in value argument not supported

> ID：13943375
> 
> 赞同：0
> 
> 时间：2012-12-18T23:46:16.657
> 
> 标签：dialog, postback, circular-reference, juice-ui

I am getting a strange script error on post back if I have a JuiceUI Dialog control on the page, regardless if it is used or not. I can't find anything out there on this, so I am sure that I am doing something wrong. Can any one provide any help? Below is my .aspx page, there is no code behind.

```
<script src="Scripts/jquery-1.8.3.min.js" type="text/javascript"></script>
<script src="Scripts/jquery-ui-1.9.2.min.js" type="text/javascript"></script>

<form id="form1" runat="server">
<asp:Button ID="Button2" runat="server" Text="Button" OnClick="Button2_Click" />
<asp:ScriptManager ID="ScriptManager1" runat="server">
</asp:ScriptManager>
<div id="_DefaultDiv" class="basic-dialog" title="Basic dialog" runat="server">
    <p>
        This is the default dialog which is useful for displaying information. The dialog
        window can be moved, resized and closed with the 'x' icon.</p>
</div>
<juice:Dialog ID="Dialog1" TargetControlID="_DefaultDiv" AutoOpen="false" runat="server" />
<p>
    <input id="Button1" type="button" value="button" onclick="OpenDialog();" />
</p>
<script type="text/javascript">

    function OpenDialog() {
        $(".basic-dialog").dialog("open")
    }

</script>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-29T09:10:00.763

这可能是因为尝试使用无效值调用 JSON.stringify。value 参数，一个数组或对象，包含一个循环引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T04:39:44.953

我建议检查一个名为[Brew](http://shellscape.org/#brew)的新分支，它可以解决很多这样的问题。如果仍有问题，我很乐意与您一起解决问题。

# c# - 组合字段值（名称）

> ID：13943380
> 
> 赞同：1
> 
> 时间：2012-12-18T23:46:34.387
> 
> 标签：c#, linq, entity-framework, asp.net-mvc-4

下面将选择对某个项目投赞成票的用户的姓名，然后将其放在逗号分隔的字符串中。

```
 var string = string.Join(", ", comment.CommentVote.Where(v=> v.Vote == true).Select(v => v.User.FirstName).ToArray()); 
```

我希望能够获取名字和姓氏，将它们放在一起，然后在逗号分隔的列表中列出它们。

背景：我正在尝试创建类似于 Facebook 的东西：

```
 John Doe and 25 others like this 
```

其中“25 others”提供悬停时的用户列表。我可以遍历投票的用户并获取名字和姓氏，将它们连接起来，然后添加一个逗号，看起来应该有一些更简单的东西可以让我避免 foreach 循环。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T23:52:58.953

只需将它们连接起来：

```
var str = string.Join(", ", 
                      comment.CommentVote
                             .Where(v=> v.Vote)
                             .Select(v => v.User.LastName + " " + v.User.FirstName)); 
```

此外，您不需要`ToArray()`显式调用，就像`string.Join`重载接受一样`IEnumerable<T>`。而且你不能有一个名为 name 的变量`string`，因为它是 type 的别名`System.String`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T00:02:15.267

您可以在 select 语句中加入您想要的 to 值。

```
var results = string.Join(", ", comment.CommentVote.Where(v=> v.Vote)
              .Select(v => string.Format("{0} {1}", v.User.FirstName, v.User.LastName))); 
```

**编辑：对不起，康斯坦丁·瓦西尔科夫已经回答了**

# perl - Perl URL 控制和验证

> ID：13943383
> 
> 赞同：-1
> 
> 时间：2012-12-18T23:47:09.437
> 
> 标签：perl, validation, url, cgi, query-string

如何在 perl 中验证 URL。我的意思是，查询字符串具有特定的顺序，并且所有参数都有特定的值（int 或字符串或运算符（％2B（+）等..））。

示例：www.mypage/question?name=john&age=21&operation=%2B

我可以控制顺序（名称->年龄->操作）和它们的具体值吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:58:00.683

是和不是。

不，您无法控制参数提交给您的顺序。浏览器可能会以不同的顺序提交它们，或者用户可能没有使用浏览器向您提交查询。

是的，您可以控制您提交的参数的顺序。但是，不要依赖这个。

您可以使用[Data::Validate::URI](http://search.cpan.org/~sonnen/Data-Validate-URI/lib/Data/Validate/URI.pm)来验证 URL。

您不应该使用复杂的 RegEx 来控制参数值。参数匹配或不匹配。参数值要么是预期的选项之一，要么不是。如果匹配，做点什么。如果它不匹配任何东西，不要做任何事情。（或者做一个 404，但这可能对你不利。）使用比“这个参数值应该是所有数字”更复杂的东西是在自找麻烦。

# c# - How to draw a line on panel? It is not showing up

> ID：13943387
> 
> 赞同：8
> 
> 时间：2012-12-18T23:47:43.747
> 
> 标签：c#, winforms, graphics, line, panel

I have a `Panel` called `panel1` and I am trying to draw a line on my `panel1` using this code:

```
var g = panel1.CreateGraphics();
var p = new Pen(Color.Black, 3);

var point1 = new Point(234,118);
var point2 = new Point(293,228);

g.DrawLine(p, point1, point2); 
```

But nothing is showing up. Any ideas? This is in a windows form.

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-18T23:56:31.727

处理 Panel 的[Paint 事件](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.paint.aspx)并将其放入其中。发生的事情是它在构造函数中被绘制一次，但`Paint`每次被调用时都会在事件中被绘制。

```
private void panel1_Paint(object sender, PaintEventArgs e)
{
    base.OnPaint(e);
    using(Graphics g = e.Graphics)
    {
       var p = new Pen(Color.Black, 3);
       var point1 = new Point(234,118);
       var point2 = new Point(293,228);
       g.DrawLine(p, point1, point2);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T23:53:47.047

在表单创建并显示在屏幕上之后，将它放在某个事件中，它应该可以正常工作。

正如keyboardP所说，最好将它放在Paint事件中，但如果在屏幕上显示表单之前调用它，它将不会显示。

要对此进行测试，您可以添加一个按钮并将代码添加到单击事件中：

```
private void button1_Click(object sender, EventArgs e)
{
    using (Graphics g = panel1.CreateGraphics())
    {
        g.DrawLine(new Pen(Color.Back, 3), new Point(234,118), new Point(293,228));
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-24T08:17:20.060

要查看您的绘图 - 您可以简单地制作一个带有 Click Event 的按钮并在单击该按钮时进行绘制。例如：

```
private void btnDraw_Click(object sender, EventArgs e)
{
    Graphics dc = drawingArea.CreateGraphics();
    Pen BlackPen = new Pen(Color.Black, 2);
    dc.DrawLine(BlackPen, 0, 0, 200, 200);

    BlackPen.Dispose();
    dc.Dispose();
} 
```

哦，顺便说一句，“drawingArea”是您添加到表单（在其中绘制）的 PictureBox 或 Panel 的（名称）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-03T18:06:00.343

如果您遵循其他答案并且仍然没有显示您的绘图，请尝试从正在绘制的控件中删除所有控件。其他控件可能会覆盖您尝试绘制的任何内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-10-27T11:54:25.967

```
private void button2_Click(object sender, EventArgs e)
    {
        panel1.Paint += new PaintEventHandler(
            (object sender1, PaintEventArgs e1) => {
                var p = new Pen(Color.Black, 3);
                var point1 = new Point(234, 118);
                var point2 = new Point(293, 228);
                e1.Graphics.DrawLine(p, point1, point2);
            }
        );

        panel1.Invalidate();

    } 
```

# java - GWT + ArrayList + Server Side

> ID：13943388
> 
> 赞同：0
> 
> 时间：2012-12-18T23:47:50.933
> 
> 标签：java, gwt

I am developing an application in GWT. In server side had a method that returns an arraylist. In client side, when i invoke the method, gets onFailure.

> ```
> public void onFailure(Throwable caught){
> label.setText("ERROR");
> }
> public void onSuccess(ArrayList<partner> result){
> // do something
> } 
> ```

The label gets "ERROR"!

Anyone knows why?

Cumps!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T17:25:18.343

ArrayList 不是可[传输](https://developers.google.com/web-toolkit/doc/latest/DevGuideRequestFactory#transportable)的类型。您必须改用 List。

# c# - 异步读取文件

> ID：13943391
> 
> 赞同：3
> 
> 时间：2012-12-18T23:48:05.690
> 
> 标签：c#, asynchronous, c#-5.0

我在这里有这个代码来读取文件：

```
private void ReadFile()
{
    using (StreamReader reader = File.OpenText("data.txt"))
        {
            while ((currentline = reader.ReadLine()) != null)
            {
                currentline = currentline.ToLower();
                currentline = RemoveChars(currentline);
                currentline = RemoveShortWord(currentline);
                AddWords(currentline);
            }
        }
    } 
```

我想为大文件异步读取文件，但不知道如何在这里执行。你能指出正确的方向吗？

这就是我试图使其异步的原因：

```
 private async void ReadFile()
    {

        using (StreamReader reader = File.OpenText("dickens.txt"))
        {
            while ((currentline =  await reader.ReadLineAsync()) != null)
            {
                currentline = currentline.ToLower();
                currentline = RemoveChars(currentline);
                currentline = RemoveShortWord(currentline);
                AddWords(currentline);
            }
        }
    } 
```

看来我的`AddWords`方法不起作用（使用异步时）。此方法将单词添加到字典中：

```
 private void AddWords(string line)
    {
        string[] word = line.Split(' ');

        foreach (string str in word)
        {
            if (str.Length >= 3)
            {
                if (dictionary.ContainsKey(str))
                {
                    dictionary[str]++;
                }
                else
                {
                    dictionary[str] = 1;
                }

            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T01:42:06.423

避免`async void`。返回方法的`async`等价物`void`是`async Task`，不是`async void`。

在使用字典之前更改`private async void ReadFile()`为`private async Task ReadFileAsync()`和结果。`await`

# python - 全局名称未定义 Python 3

> ID：13943399
> 
> 赞同：2
> 
> 时间：2012-12-18T23:49:04.513
> 
> 标签：python, python-3.x

出于某种原因，当我点击 c 时，它给我的“课程”没有定义。

请输入菜单选项... [c]ourses、[i]nstructors、[t]times：c Traceback（最近一次通话最后一次）：

第 15 行，在主打印中（create_info(courses)) NameError: global name 'courses' is not defined

```
def main():
    courseInfo = create_info()

    print('Please enter a menu choice...')
    choice = input('[c]ourses, [i]nstructors, [t]imes: ').upper()

    if choice == 'C':
        print(create_info(courses))

def create_info():
    courses = {'CS101':'3004', 'CS102':'4501', 'CS103':'6755', 'NT110':'1244',
               'CM241':'1411'}
    instructors = {'CS101':'Haynes', 'CS102':'Alvarado', 'CS103':'Rich',
                   'NT110':'Burke', 'CM241':'Lee'}
    times = {'CS101':'8:00 a.m.', 'CS102':'9:00 a.m.', 'CS103':'10:00 a.m.',
             'NT110':'11:00 a.m.', 'CM241':'1:00 p.m.'}

    return courses, instructors, times

main() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T23:51:14.083

`courses`是一个*局部*变量，`create_info`因此从`main`.Performance 中看不到它。也许您打算在`courseInfo`那里使用它。

此外，您正在尝试将参数传递给 create_info，当它被定义为不带参数时

你可以让 create_info 返回一个像这样的字典

```
def main():
    courseInfo = create_info()

    print('Please enter a menu choice...')
    choice = input('[c]ourses, [i]nstructors, [t]imes: ').upper()

    if choice == 'C':
        print(courseInfo["courses"])

def create_info():
    courses = {'CS101':'3004', 'CS102':'4501', 'CS103':'6755', 'NT110':'1244',
               'CM241':'1411'}
    instructors = {'CS101':'Haynes', 'CS102':'Alvarado', 'CS103':'Rich',
                   'NT110':'Burke', 'CM241':'Lee'}
    times = {'CS101':'8:00 a.m.', 'CS102':'9:00 a.m.', 'CS103':'10:00 a.m.',
             'NT110':'11:00 a.m.', 'CM241':'1:00 p.m.'}

    return dict(courses=courses, instructors=instructors, times=times)

main() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T23:51:16.057

`main()`像这样改变：

```
def main():
    courses, instructors, times = create_info()    # <<<

    print('Please enter a menu choice...')
    choice = input('[c]ourses, [i]nstructors, [t]imes: ').upper()

    if choice == 'C':
        print(courses)                             # <<< 
```

我已经更改了标有 的两行`# <<<`。

# c++ - 尝试制作对象时出错

> ID：13943402
> 
> 赞同：1
> 
> 时间：2012-12-18T23:49:23.970
> 
> 标签：c++, stl, multimap

我正在尝试制作一个`Question`对象。`Question`作为班级，但我收到一个错误，即：

> 错误 1 ​​错误 C2440：“正在初始化”：无法从转换`Questions *`为`Questions`

我正在尝试制作一个对象，以便我可以将它放入一个`multimap`类型`<int, Questions>`

这是我的代码：

```
#include <iostream>
#include "Questions.h"
using namespace std;

Questions::Questions() {}
Questions::Questions(string question,string correctAnswer, string wrongAnswer1,string wrongAnswer2,string wrongAnswer3) {}

void Questions::questionStore() {
    Questions q1 = new Questions("Whats the oldest known city in the world?", "Sparta", "Tripoli", "Rome", "Demascus");
    string q2 = ("What sport in the olympics are beards dissallowed?", "Judo", "Table Tennis", "Volleyball", "Boxing");
    string q3 = ("What does an entomologist study?", "People", "Rocks", "Plants", "Insects");
    string q4 = ("Where would a cowboy wear his chaps?", "Hat", "Feet", "Arms", "Legs");
    string q5 = ("which of these zodiac signs is represented as an animal that does not grow horns?", "Aries", "Tauris", "Capricorn", "Aquarius");
    string q6 = ("Former Prime Minister Tony Blair was born in which country?", "Northern Ireland", "Wales", "England", "Scotland");
    string q7 = ("Duffle coats are named after a town in which country?", "Austria", "Holland", "Germany", "Belgium");
    string q8 = ("The young of which creature is known as a squab?", "Horse", "Squid", "Octopus", "Pigeon");
    string q9 = ("The main character in the 2000 movie ""Gladiator"" fights what animal in the arena?", "Panther", "Leopard", "Lion", "Tiger");

    map.insert(pair <int, Questions>(1, q1));
    map.insert(pair <int, string>(2, q2));
    // map.insert(pair<int,string>(3, q3));
    for (multimap <int, string, std::less <int> >::const_iterator iter = map.begin(); iter != map.end(); ++iter)
        cout << iter->first << '\t' << iter->second << '\n';
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:51:06.670

该`new`表达式为您提供了一个指向您已动态分配的对象的指针。你需要做`Questions* q1 = new Questions(...);`。但是，如果您不需要动态分配（最终将对象复制到地图中），请不要打扰。做吧`Questions q1(...);`。

据推测，您将更改以下行（`q2`、`q3`等）以匹配，但它们并没有按照您的预期进行。将`(..., ..., ...)`评估为此逗号分隔列表中最右边的项目。所以你的`q2`线相当于`string q2 = "Boxing";`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:52:02.183

`Questions q1 = new Questions`是不正确的语法。

从 `map.insert(pair <int, Questions>(1, q1));`我可以看到你的`map`值类型是 Questions 对象而不是 Questions 指针，所以它应该是

```
Questions q1 = Questions ("Whats the oldest known city in the world?", "Sparta" , "Tripoli" , "Rome", "Demascus"); 
```

此外，您的变量映射与作为 STL 容器的 std::map 同名，建议您使用其他名称，例如`question_map`：

**编辑**

为了让`<< iter->second`您需要重载`operator<<`问题类型。

```
std::ostream& operator<<(const std::ostream& out, const Questions& q)
{
    out << q.question;  // I made up this member as I can't see your Questions code
    return out;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T23:51:50.233

您的方法的第一行`questionScore`是问题：

```
Questions q1 = new Questions ... 
```

`new x`返回指向`x`对象的指针，因此`q1`应定义为指针。

```
Questions * q1 = new Questions ... 
```

# clojure - Python3 到 Clojure IPC

> ID：13943408
> 
> 赞同：4
> 
> 时间：2012-12-18T23:50:02.747
> 
> 标签：clojure, python-3.x, ipc, rpc

我有一个奇怪的要求。我们需要在我们的 python3.3 worker 和数据库之间运行基于 clojure 的服务。出于这个原因，我正在研究在 python 和 clojure 之间进行接口的不同方法。我查看了 Thrift，但不幸的是它还没有 python3 支持。0mq 看起来也很有趣，但我担心 req/req 模式会阻塞 python3 线程（多个进程上会有多个线程需要使用此代理服务）。

是否有任何其他现有的图书馆可以帮助我在这里？归根结底，我可以使用 aleph 和原始套接字从头开始编写我自己的服务，但我觉得那样会过多地重新发明轮子。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T01:03:50.340

Clojure 表示 JVM。在 JVM 上运行的大多数语言都允许“调用 Java”并被“由 Java 调用”，这基本上意味着 JVM 上的任何其他内容。我从来没有这样做过，但您可能可以从 Jython 调用 Clojure。现在 Jython 不支持 Python 3 语言，但它确实支持 Pyro。

这有点牵强，但您可以尝试：

```
 JVM
     Python-VM             Jython           Clojure
( Your app -> Pyro ) --> ( Pyro -> Proxy -> Your app ) 
```

RMI 的参数可能必须转换为 Java 原语和 Java 字符串。它可能还需要一些 ClassLoader-Voodoo。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T03:15:11.327

到目前为止，我很高兴在 Python 中使用 ZeroMQ。还有 Clojure 支持，我还没有真正使用过——它需要本地库，这可能有点不方便。即使它不是完整的 RPC 机制，我也会使用您的 ZeroMQ 参考，因为通常 RPC 问题可以相当简单地分解为对一个或多个消息队列的操作。

同时，还有[clojure-py](https://github.com/halgari/clojure-py)，它可以让你拥有你的 Python 并吃掉你的 Clojure。它仍然很年轻，并非没有粗糙的边缘，但大多数核心功能已经到位。

最后，[Clojure](https://github.com/brehaut/necessary-evil)和[Python](http://docs.python.org/2/library/xmlrpclib.html)都有 XML-RPC 的库，如果你只是想要一些简单的东西将你的 Python 和 Clojure 粘合在一起。

# ruby-on-rails-3 - 渲染 Jquery 对话框

> ID：13943414
> 
> 赞同：0
> 
> 时间：2012-12-18T23:50:39.423
> 
> 标签：ruby-on-rails-3, jquery-ui, jquery-ui-dialog

我有以下内容：

**应用程序.js**

```
 //= require jquery
    //= require jquery_ujs
    //= require_tree .
    //
    //= require jquery-ui
    //= require jquery-ui-1.8.14.custom.min
    //= require datatable
    //= require highcharts
    //= require exporting
    //= require turbolinks

$('table').on('click', 'td', function(e) {

    $('.create_booking').dialog('open');
}); 
```

我想要做的是让我的`<td>`元素打开 Jquery-ui 对话框并渲染`booking_dialog`它没有这样做的部分，原因我似乎不明白。以上应该工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:06:44.140

您需要先创建对话框：

```
$('.create_booking').dialog({
    autoOpen: false
}); 
```

之后，您可以使用`$('.create_booking').dialog('open')`它来显示它。还可以考虑为您的对话框元素使用 ID 而不是类。反正你只有一个，不是吗？

演示： http: [//jsfiddle.net/ThiefMaster/uJUuW/](http://jsfiddle.net/ThiefMaster/uJUuW/)（尝试先点击“打开”）

# asp.net - GridView 很少随机丢失其PageIndex，是什么原因？

> ID：13943415
> 
> 赞同：1
> 
> 时间：2012-12-18T23:50:53.053
> 
> 标签：asp.net, gridview

我在系统页面的更新面板中有一个自定义寻呼机控件和一个 GridView。它通常可以正常工作，但每周有几次日志中会出现错误，其中 GridView 的 PageIndex 重置为 0。

分页是这样工作的。

```
private void PageBackward(Object sender, EventArgs e)
{
    boundGridView.PageIndex = boundGridView.PageIndex - 1;
    boundGridView.DataBind();
}

private void PageForward(Object sender, EventArgs e)
{
    boundGridView.PageIndex = boundGridView.PageIndex + 1;
    boundGridView.DataBind();
} 
```

简单吧？

发生此错误时，用户只是正常使用系统。
我们处于集群环境中，但所有 GridView 数据都应存储在 ViewState 中。
我正在考虑将 PageIndex 放在 Session 中，但实际上我不应该这样做。

这是什么原因造成的？

# java - Web服务中Spring托管bean的竞争条件

> ID：13943423
> 
> 赞同：1
> 
> 时间：2012-12-18T23:51:35.690
> 
> 标签：java, web-services, spring

考虑一个弹簧管理的 Web 服务，它定义了一个操作 opA（类 opA）。将为该操作的每个请求创建一个单独的 opA 对象实例。

```
Class opA{

@Autowired
B objB;

}

Class B{

C objC;
.
.
}

Class C{
.
.
.
}

<bean id="objB" class="blah.blah.B">
 <property name="objC">
   <bean class="blah.blah.C"/>
  </property>
</bean> 
```

注意：opA 也由 spring 管理

这里的对象 objB 是带有内部 bean objC 的 Spring 单例范围。现在，如果两个 opA 请求同时到达，它们都将具有相同的 objB 实例，对吗？对 objB 中的 objC 的状态造成可能的竞争条件。我对么？如果不是，你能解释一下为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:28:01.023

您有一个在您的应用程序中使用的状态的单个实例，所以我会说您可能有竞争条件，但这取决于您的`state`（objB 是服务，objC 是存储库吗？）以及您的实现。

# .net - 使用 blockid > 1 char 上传 blob 块错误

> ID：13943429
> 
> 赞同：0
> 
> 时间：2012-12-18T23:51:54.553
> 
> 标签：.net, vb.net, azure

我正在使用 VB.NET 和 Azure .NET 程序集将文件上传到 Azure blob。由于文件很大，我将它分成块，并使用`CloudBlockBlob.PutBlock`. 我遇到的问题是，如果我提供的 a`BlockID`长度超过一个字符，我会收到“指定的 blob 或块内容无效”。来自 的错误`PutBLock`。如果 blockID 只有一个字符，则可以正常上传。

```
Dim iBlockSize As Integer = 1024  ' KB
Dim alBlockIDs As New ArrayList
Dim iBlockID As Integer = 10

' Create the blob client.
Dim blobClient As CloudBlobClient = storageAccount.CreateCloudBlobClient()
' Retrieve reference to a previously created container.
Dim container As CloudBlobContainer = blobClient.GetContainerReference("mycontainer")
' Retrieve reference to a blob named "myblob".
Dim blockBlob As CloudBlockBlob = container.GetBlockBlobReference("myblob")

Dim buffer(iBufferSize) As Byte
fs.Read(buffer, 0, buffer.Length)
Using ms As New MemoryStream(buffer)
    ' convert block id to Base64 Encoded string 
    Dim b64BlockID As String = Convert.ToBase64String(System.Text.Encoding.UTF8.GetBytes(iBlockID.ToString(Globalization.CultureInfo.InvariantCulture)))
    ' write the blob block
    blockBlob.PutBlock(b64BlockID, ms, Nothing)

    alBlockIDs.Add(b64BlockID)
    iBlockID += 1
End Using 
```

如果`iBlockID = 1`，该`PutBlock`方法可以正常工作（我仍然需要解决每个块的blockID 长度相同，我稍后会担心）。有什么想法吗？我目前正在使用本地 Azure 存储模拟器进行测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T10:37:48.890

无法确认，但您的代码中可能有机会在创建这些缓冲区时重叠一些内存。请参考以下工作代码以块中上传 Blob。以下代码使用**10240 (10KB)**的块大小，但可以轻松更改

```
Dim fileName As String = "D:\Untitled.png"
Dim fileSize As Long = New FileInfo(fileName).Length
Dim blockNumber As UInteger = 0
Dim blocksize As UInteger = 10240 '10KB
Dim blockIdList As List(Of String) = New List(Of String)

Using fs As New FileStream(fileName, FileMode.Open, FileAccess.Read)

    Do While (fileSize > 0)
        Dim bufferSize As UInteger

        'Last block of file can be less than 10240 bytes
        If (fileSize > blocksize) Then
            bufferSize = blocksize
        Else
            bufferSize = fileSize
        End If

        Dim buffer(bufferSize) As Byte
        Dim br As New BinaryReader(fs)

        'move the file system reader to the proper position
        fs.Seek(blocksize * blockNumber, SeekOrigin.Begin)
        br.Read(buffer, 0, bufferSize)

        Using ms As New MemoryStream(buffer, 0, bufferSize)
            'convert block id to Base64 Encoded string 
            Dim b64BlockID As String = Convert.ToBase64String(Encoding.ASCII.GetBytes(String.Format("BlockId{0}", blockNumber.ToString("0000000"))))
            blockBlob.PutBlock(b64BlockID, ms, Nothing)

            blockIdList.Add(b64BlockID)
        End Using

        blockNumber += 1
        fileSize -= blocksize
    Loop

    blockBlob.PutBlockList(blockIdList)

End Using 
```

# c# - 找不到存储过程“dbo.aspnet_UsersInRoles_GetRolesForUser”

> ID：13943430
> 
> 赞同：3
> 
> 时间：2012-12-18T23:52:01.143
> 
> 标签：c#, asp.net, asp.net-mvc

将 SQL Server 数据库备份到另一台服务器后，发生了奇怪的错误。该应用程序也已迁移。它是一个 ASP.NET MVC4 应用程序。

我收到以下错误：

```
Could not find stored procedure 'dbo.aspnet_UsersInRoles_GetRolesForUser'. 

Line 1:  @{
Line 2:      bool visible = false;
Line 3:      if (User.IsInRole("Administrador"))
Line 4:      {
Line 5:          visible = true; 
```

存储过程在那里，数据库相同，服务器名称相同，所以我认为不应更改连接字符串。

如何跟踪错误以查找发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T03:34:31.840

检查 ASP.NET Membership 使用的连接字符串。这是成员资格提供程序部分中的 connectionStringName 属性。然后参考 connectionStrings 部分以根据该名称查看实际的连接字符串。

例如。

```
<membership defaultProvider="AspNetSqlMembershipProvider">
  <providers>
  <clear/>
  <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider,       System.Web, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"
connectionStringName="THE_CONNECTION_STRING_NAME"  applicationName="/"/>
</providers>
</membership> 
```

# php - CodeIgniter 重定向不起作用？

> ID：13943433
> 
> 赞同：-2
> 
> 时间：2012-12-18T23:52:21.810
> 
> 标签：php, codeigniter

好的，我有一个名为 Login 的控制器，并且有一个 index() 函数来显示视图用户/登录名。我使用用户/登录名构建网址，但使用重定向，我正在这样做：

`redirect('/user/login/');`

但我也试过`redirect('/login/');` 我的登录怎么无法加载？它一直给我一个404错误...

我也试过`('/login/index')`了`('/login')`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:24:29.497

听起来您只有一个控制器 ,里面`Login`只有一页 ,`index`那么为什么需要重定向呢？你只是想让你的索引页面显示你的登录视图吗？如果是这样，你可以这样做：

```
$this->load->view('path/to/view'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:54:26.563

你可以试试`redirect(site_url("login"));`，如果你没有在你的 CI 安装中更改相关路由，它会带你到`login`控制器（默认情况下是 index() 方法）

编辑：我误读了这个问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T00:44:55.063

啊..对不起，我的错。我有一个 if 语句，它甚至没有让它进入重定向部分......对不起！

# json - IE中Json响应下载(7~10)

> ID：13943439
> 
> 赞同：32
> 
> 时间：2012-12-18T23:52:48.893
> 
> 标签：json, internet-explorer, c#-4.0, asp.net-mvc-4, http-headers

我正在尝试上传文件并返回有关文件属性（名称、大小等）的 json 响应。它适用于除 IE 之外的所有浏览器。

IE 尝试将 JSON 作为文件下载！

我有 IE10 并通过从调试器更改浏览器模式和文档模式在 IE7 到 10 上对其进行测试。

我正在使用 asp.net mvc4，文件上传操作具有 HttpPost 属性，并且我使用**return Json(myObject); 返回 json 响应；**

这是我的 http 标头

**要求**

```
Key Value
Request POST /File/UploadFile/ HTTP/1.1
Accept  text/html, application/xhtml+xml, */*
Referer http://localhost:63903/
Accept-Language en-NZ
User-Agent  Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)
Content-Type    multipart/form-data; boundary=---------------------------7dc1e71330526
Accept-Encoding gzip, deflate
Host    localhost:63903
Content-Length  1377002
DNT 1
Connection  Keep-Alive
Cache-Control   no-cache 
```

**回复**

```
Key Value
Response    HTTP/1.1 200 OK
Server  ASP.NET Development Server/11.0.0.0
Date    Tue, 18 Dec 2012 23:44:19 GMT
X-AspNet-Version    4.0.30319
X-AspNetMvc-Version 4.0
Cache-Control   private
Content-Type    application/json; charset=utf-8
Content-Length  154
Connection  Close 
```

我尝试了一些建议，但到目前为止还是回到了第一条！

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-12-19T01:20:56.980

您将需要返回 json，`text/html`因为 IE 不知道如何处理`application/json`内容..

```
return Json(myObject, "text/html"); 
```

* * *

不确定，但它可能有效（*如果有效，它会更正确*）使用`text/x-json`

```
return Json(myObject, "text/x-json"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-30T19:48:31.490

尽管这个问题已经存在几个月了，但我想我会再添加一个建议，以防万一其他人正在使用`ASP.NET MVC 3 or 4`并遇到这个问题。

根据我的经验，当 IE 尝试将 Json 响应下载为文件时，您要纠正问题所需要做的就是添加对`jquery.unobtrusive`视图的引用。

例如：

```
@Scripts.Render("~/Scripts/jquery.unobtrusive-ajax.min.js") 
```

一旦这到位，IE 将不再尝试从 JsonResult 控制器操作下载 json 响应。无需更改响应类型等。

# ios - 如何检测“由于未捕获的异常而终止应用程序”错误的原因？

> ID：13943448
> 
> 赞同：0
> 
> 时间：2012-12-18T23:53:15.273
> 
> 标签：ios, xcode

我正在开发纸牌游戏（回合制），但我遇到了一个问题。当我在游戏中时，我点击主页按钮退出游戏，然后我再次进入游戏，我得到这个错误：Terminating app due to uncaught exception...

如何检测此错误的原因和位置？xcode中是否有任何方法或设置？

我的 Xcode 版本：4.5.2

我在我的 iPhone（4S 和 5）上收到此错误，但在我尝试 iPhone 模拟器时却没有。

PS 使用 PHP 的错误很简单，因为例如你得到了 thid: there is an error on line: 45

**更新**。错误是：

> [ViewController 中断：]：无法识别的选择器发送到实例 0x1c54d260

# .net - .NET 中“*”（通配符）版本号的公式是什么？

> ID：13943456
> 
> 赞同：15
> 
> 时间：2012-12-18T23:53:58.063
> 
> 标签：.net, versioning, assemblyversionattribute

假设我有一个编译为 1.5.4735.28467 的版本号 1.5.*。

得到 4735 和 28467 的公式是什么？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-19T01:22:04.687

**请注意：**有*替代工具/规则/方案/宏/插件/等*以不同的方式控制版本控制；如果使用它们显然会消除以下内容。

但是，这是在*vanilla* Visual Studio / .NET 构建过程`"*"`中计算版本的方式：`.build.revision`

 *> 指定版本时，您至少必须指定主要版本。如果您指定主要和次要，您*可以为 build 指定一个星号 (*)*。这将导致***构建*等于自当地时间 2000 年 1 月 1 日以来的天数**，而***修订*等于自当地时间午夜以来的秒数除以 2。**

请参阅[Coding Horror: Determining Build Date the hard way](http://www.codinghorror.com/blog/2005/04/determining-build-date-the-hard-way.html)和[MSDN: AssemblyVersionAttribute](http://msdn.microsoft.com/en-us/library/system.reflection.assemblyversionattribute.assemblyversionattribute.aspx)。此默认扩展行为记录在 AssemblyVersionAttribute 类（BCL！）~~而不是特殊的 VS 编译器行为~~（请参阅 Daniel 的评论），而不仅仅是编译器行为。

* * *

这是公式的一种实现（摘自丹尼尔的评论）：

```
int Build = DateTime.Today.Subtract(new DateTime(2000, 1, 1)).Days;
int Revision = (int)DateTime.Now.Subtract(DateTime.Today).TotalSeconds / 2; 
```*

# android - 如何通过应用唤醒 Android 设备的 Wifi 或 3G？

> ID：13943457
> 
> 赞同：1
> 
> 时间：2012-12-18T23:54:11.310
> 
> 标签：android, wifi, state

我正在为 Android 开发一个基于服务器 websocket 的应用程序，但通常不能正常工作。当它失败并且我尝试从我的 PC ping 设备时，我无法访问它。我必须重置设备或打开飞行模式并再次将其关闭。然后，我可以使用 ping 命令访问设备，并且我的服务器运行良好。

有什么建议吗？谢谢。

编辑：我在这里找到了解决方案： [http ://www.framentos.com/en/android-tutorial/2012/02/27/how-to-prevent-wi-fi-sleep-on-android/](http://www.framentos.com/en/android-tutorial/2012/02/27/how-to-prevent-wi-fi-sleep-on-android/)

```
import android.net.wifi.WifiManager;
import android.net.wifi.WifiManager.WifiLock;

WifiManager wifiManager = (WifiManager) getSystemService(Context.WIFI_SERVICE);
WifiLock lock = wifiManager.createWifiLock(WifiManager.WIFI_MODE_FULL_HIGH_PERF, "LockTag");
lock.acquire(); 
```

再次编辑...

不，我认为它会起作用，但它没有......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:23:56.393

您可能希望应用程序确保在设备上启用了 Wifi。您无法以编程方式启用它，但您可以打开无线设置菜单，以便用户启用它。要检测是否有网络连接，您可以使用以下代码：

```
ConnectivityManager connectivityManager  
                = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE); 

NetworkInfo activeNetworkInfo = connectivityManager.getActiveNetworkInfo(); 

if(activeNetworkInfo != null && activeNetworkInfo.isConnected()) {
    // There is a connection
    ...
}
else {
    // No connection; open the wireless settings menu
    startActivity(new Intent(android.provider.Settings.ACTION_WIRELESS_SETTINGS));
    ...
} 
```

您还需要清单中的以下权限：

```
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
<uses-permission android:name="android.permission.INTERNET" /> 
```

# java - 在 oracle db 和目标 c 之间传输 blob 数据

> ID：13943459
> 
> 赞同：2
> 
> 时间：2012-12-18T23:54:43.540
> 
> 标签：java, objective-c, web-services, ms-word, blob

我正在尝试通过 web 服务将 blob 数据从 oracle db 发送到目标 c。blob 数据是存储在 oracle db 中的 word 文档。

以下是我到目前为止所做的：

1.  通过java jdbc获取blob对象
2.  将blob对象转换为java字节数组
3.  将此字节数组设置为普通 java 对象（序列化）并将其发送到 Web 服务
4.  Webservice 将普通 java 对象发送到 Objective-c，Media-type 为 application/json
5.  在objective-c中检索json对象并将字节数组分配给NSData
6.  然后将 NSData 写入文件并打开文件

问题：我无法通过objective-c打开文件，当我在mac中物理打开文件时，它包含一些垃圾字符。任何人都可以让我知道是否无论如何可以将表示 word 文档的 java 字节数组转换为objective-c 识别的数据类型，并最终在objective-c 应用程序中打开word 文档。

以下是您在 Objective-C 端阅读的代码：

注意：代码中的“sourceDoc”是字节数组的键。

```
NSArray *jsonArray = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];

if ([data length] >0  && error == nil){

    NSArray *jsonArray = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:&error];
    NSData *returnData = nil;

    for(NSDictionary *billDict in jsonArray){
        returnData = [NSData dataWithBytes:(__bridge const void *)([billDict objectForKey:@"sourceDoc"]) length:[[billDict objectForKey:@"sourceDoc"] length]];
        break;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:24:04.360

问题是它`-[NSData dataWithBytes:length:]`需要一个指向实际数据的指针，但您正在向它传递一个字典中的对象。您应该检查使用返回的内容，`NSLog(@"%@", [billDict objectForKey:@"sourceDoc"]);`但我希望它将是一个 base64 字符串。如果它是 base64 字符串，您可以使用以下问题中的 base64 解码选项之一：[How do I do base64 encoding on iphone-sdk?](https://stackoverflow.com/questions/392464/any-base64-library-on-iphone-sdk) . 如果您使用 Alex Reynolds 对该问题的回答，那么您将`returnData`在上面的代码中包含您创建并设置的 base64 解码文件头，如下所示：

```
returnData = [NSData base64DataFromString:[billDict objectForKey:@"sourceDoc"]]; 
```

# java - 用 Java 组织 GUI 和 ActionListener 的代码

> ID：13943460
> 
> 赞同：4
> 
> 时间：2012-12-18T23:54:54.677
> 
> 标签：java, swing, user-interface, actionlistener

我是 Java 新手，想知道如何`ActionListener`在我的项目中实现代码。我知道内部类和`ActionListener`接口的实现，但是走这条路会使代码看起来比它应该的更混乱。

我会写另一个`ActionCode`实现`ActionListener`和扩展 GUI 的类，或者你会建议什么道路，为什么？

您对此有什么最佳实践建议，我在哪里可以找到这些指南？（JavaDoc 似乎解释了`ActionListener`s 的基本实现，但似乎没有任何模型如何组织大/中型项目）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:21:58.343

在我看来，没有“最好”的方法。甚至 sun/oracle 教程中的代码示例也使用不同的方式来实现侦听器。

根据我的经验，一个好的方法是：

*   使用匿名实现：人们知道这种模式并且会很快认出它。如果有通用的做事方式，它可以帮助读者理解代码
*   有一个特殊的方法，它只处理监听器（例如`private void addListeners()`）：同样，这有助于每个人识别它并知道在哪里搜索所有逻辑
*   让听众保持简单。这意味着少于 5-10 行代码。如果您需要更复杂的逻辑，请调用方法。
*   保持听众人数较少。如果您需要 > 50 个侦听器，您可能应该重构您的视图。如果你需要超过 10 个，你可以考虑重构。

除了这些一般要点之外，总会有例外。就像你有很多具有相同行为的组件一样，你可以编写一个带有 switch/case 的通用侦听器。（典型示例：计算器按钮或菜单按钮）。
或者，如果您对多个组件有相同的逻辑，则可以使用特定的类。
等等。

顺便提一下，因为 sun/oracle 教程中有一些示例： 尽量避免使用视图类本身实现侦听器接口。如果您只有一个侦听器，这可能没问题，但大多数情况下，对于来自具有不同行为的多个源的多个事件来说，这很糟糕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T00:15:51.420

代码风格可能是个人品味的问题，但现代文献表明它不止于此。让[清洁代码](https://rads.stackoverflow.com/amzn/click/com/0132350882)中的类一章向您展示方法。

> 班级应该很小！
> 
> 类的第一条规则是它们应该很小。类的第二个规则是它们应该小于这个值。不，我们不会重复函数章节中完全相同的文本。但与函数一样，在设计类时，更小是主要规则。与函数一样，我们的直接问题始终是“有多小？” 对于函数，我们通过计算物理线来测量大小。对于类，我们使用不同的度量。我们计算责任...
> 
> **单一职责原则 (SRP) 指出一个类或模块应该有一个并且只有一个改变的理由。**这个原则给了我们责任的定义和班级规模的指导。类应该有一个责任——一个改变的理由……
> 
> 问题是我们中的太多人认为一旦程序运行我们就完成了。我们未能转向组织和清洁的另一个关注点。我们继续下一个问题，而不是返回并将过度填充的类分解为具有单一职责的解耦单元。同时，*许多开发人员担心大量的小型、单一用途的类会使理解大局变得更加困难。他们担心他们必须从一个班级导航到另一个班级，以便弄清楚如何完成更大的工作。然而，一个有很多小类的系统不会比一个有几个大类的系统有更多的活动部件。*在这个系统中，有几个大班要学的东西也一样多。所以问题是：您是否希望将您的工具组织成带有许多小抽屉的工具箱，每个小抽屉都包含明确定义和标记良好的组件？或者你想要几个抽屉，你可以把所有东西都扔进去？
> 
> **每个相当大的系统都将包含大量的逻辑和复杂性。管理这种复杂性的主要目标是组织它，以便开发人员知道在哪里可以找到东西，并且只需要了解在任何给定时间直接影响的复杂性。**相比之下，具有更大、多用途课程的系统总是会通过坚持让我们涉足许多我们现在不需要知道的事情来阻碍我们。重申前面的重点：我们希望我们的系统由许多小类组成，而不是由几个大类组成。每个小类都封装了一个职责，有一个改变的理由，并与其他几个类协作以实现所需的系统行为。

因此，基于这些启发式方法，嵌套类打破了 SRP。它们几乎不应该发生。相反，让您的 GUI 类包含它们注册的 ActionListener 的实例成员。将侦听器保存在单独的 *.listener 包中。在认为有效的地方使用接口使它们可替换（策略模式）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T02:05:23.307

Java 和 Swing 鼓励使用很多小对象，例如 Listeners 和 Actions。这是很多样板，但Java就是这样。对抗它没有什么好处。

内联创建匿名侦听器相当轻松：

```
JButton okButton = new JButton("OK");
okButton.addActionListener(new ActionListener() {
    public void actionPerformed(ActionEvent e) {
        ok();
    }
}); 
```

但是，您经常需要重用操作，例如将相同的操作分配给菜单和按钮。您可以将它们作为内部类放在主应用程序窗口中：

```
import java.awt.Dimension;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;
import javax.swing.*;

public class MainWindow extends JFrame {

    ZapAction zapAction;

    public MainWindow() {

        setSize(new Dimension(200,200));

        zapAction = new ZapAction();

        JMenuBar menuBar = new JMenuBar();
        JMenu menu = new JMenu("Foo");
        menu.add(new JMenuItem(zapAction));
        menuBar.add(menu);
        setJMenuBar(menuBar);

        JButton zapButton = new JButton(zapAction);

        add(zapButton);
    }

    public void zap() {
        // do some zapping
        System.out.println("Zap!");
        // maybe we're all done zapping?
        zapAction.setEnabled(isZappingPossible());
    }

    public boolean isZappingPossible() {
        // determine if there's zapping to be done
        return Math.random() < 0.9;
    }

    class ZapAction extends AbstractAction {
        public ZapAction() {
            super("Zap");
            putValue(AbstractAction.SHORT_DESCRIPTION, "Zap something");
            putValue(AbstractAction.ACCELERATOR_KEY, KeyStroke.getKeyStroke(
                KeyEvent.VK_Z, Toolkit.getDefaultToolkit().getMenuShortcutKeyMask()));
            putValue(AbstractAction.SMALL_ICON, 
                new ImageIcon(MainWindow.class.getResource("/icons/zap.png")));
            setEnabled(true);
        }
        public void actionPerformed(ActionEvent e) {
            zap();
        }
    }
}

public class Zap {
    public static void main(String[] args) {
        MainWindow mainWindow = new MainWindow();
        mainWindow.setVisible(true);
    }
} 
```

这里`ZapAction`是包私有可见性。我把所有的 UI 代码放在它自己的包中（比如说`org.myorg.myproject.ui`）。因此，所有 UI 对象都可以访问这些操作。

在一个复杂的 Swing 应用程序中，我甚至创建了一个 UI 外观层，它为操作和将它们连接到各种控件的所有代码提供了一个很好的位置。它还为外部代码与 UI 交互提供了一个方便的地方，使 UI 代码与核心应用程序代码隔离。

# java - 用于测试所有 JUnit 测试是给定测试类的子类的元测试

> ID：13943461
> 
> 赞同：2
> 
> 时间：2012-12-18T23:54:56.510
> 
> 标签：java, parsing, testing

我们有一个策略，所有测试类都扩展给定的测试类。基类设置要使用的 JUnit 运行器以及检查有关测试类的其他内容，因此不从它子类化意味着不会检查您做错的其他事情。（其中最严重的是当有一个类别表明测试运行起来很昂贵，但由于没有使用运行器，即使对于 run-fast-tests 构建目标，测试也会运行。）

我认为这将涉及解析 Java 代码，但我似乎只能找到类文件的解析器。那里有一个很好的解析器来解析 Java 源代码吗？

（这可能与我要问的另一个关于强制使用某些 Javadoc 标记的问题相关联，因为这样的解析器肯定也会解析 Javadoc。）

或者，是否有一种 DRY 方法来设置 JUnit 跑步者而无需子类化？整个子类化业务*真的非常不方便。*

# rspec - 为什么我使用 Capybara-webkit 得到空白页面，而不是使用标准（非 JS）驱动程序

> ID：13943462
> 
> 赞同：6
> 
> 时间：2012-12-18T23:54:59.923
> 
> 标签：rspec, capybara, capybara-webkit

在我开始尝试使用 Capybara-Webkit 与依赖于 Javascript 的界面元素进行交互之前，我的 Rspec + Capybara 集成测试运行良好。

当我尝试使用 Capybara-Webkit 时，我在`save_and_open_line`下面得到空白页。为什么？

**/spec/features/area_spec.rb**：

```
require 'spec_helper'
describe "Area" do
  ...
  describe "Admin" do
    ...  
    before(:each) do
      Capybara.current_driver = :webkit
      @virginia = User.create(
        :username => "Virginia", 
        :password => "password", 
        :password_confirmation => "password", 
        :email => "example@example.com")
      @admin = Role.create(:name => "admin")    
      @assignment = Assignment.create(user_id: @virginia.id, role_id: @admin.id)
      visit login_path
      fill_in 'user_session_username', :with => @virginia.username
      fill_in 'user_session_password', :with => @virginia.password
      click_on 'submit_user_session'
      visit report_path(@report)
      save_and_open_page
      page.find('#nav_reports').trigger(:mouseover)
      ...
    end
    ...
  end
  ...
end 
```

**/spec/spec_helper.rb**：

```
require 'rubygems'
require 'spork'
require 'database_cleaner'
Spork.prefork do
end
Spork.each_run do
end
ENV["RAILS_ENV"] ||= 'test'
require File.expand_path("../../config/environment", __FILE__)
require 'rspec/rails'
require 'capybara/rspec'
require 'capybara/rails' 
require 'capybara/dsl' 
Dir[Rails.root.join("spec/support/**/*.rb")].each {|f| require f}
RSpec.configure do |config|
  config.mock_with :rspec
  config.fail_fast = true
  config.fixture_path = "#{::Rails.root}/spec/fixtures"
  config.before(:each) { ActionMailer::Base.deliveries.clear }
  config.use_instantiated_fixtures = false 
  config.include(Capybara, :type => :integration)
  Capybara.javascript_driver = :webkit
  config.use_transactional_fixtures = false
  config.before(:suite) do
    DatabaseCleaner.clean_with :truncation
  end
  config.before(:each) do
    if example.metadata[:js]
      DatabaseCleaner.strategy = :truncation
    else
      DatabaseCleaner.strategy = :transaction
    end
    DatabaseCleaner.start
  end
  config.after(:each) do
    DatabaseCleaner.clean
  end
end 
```

当我从中删除`Capybara.current_driver = :webkit`（`area_spec.rb`但将 Webkit 相关代码保留在 中`spec_helper.rb`）时，生成的页面`save_and_open_page`不为空，但在 Rspec 命令行中出现以下错误：

```
Failure/Error: page.find('#nav_reports').trigger(:mouseover)
     Capybara::NotSupportedByDriverError:
       Capybara::NotSupportedByDriverError 
```

最初我尝试添加`:js => :true`到 before `block ... do`，但 Rspec 一直拒绝我的语法。当我添加`:js => true`到`it ... do block`要被`before ... do`块覆盖的第一个时，我仍然在 处得到一个空白页`save_and_open_page`，但是 Rspec 命令行中的错误更改为：

```
Failure/Error: page.find('#nav_reports').trigger(:mouseover)
     Capybara::Webkit::NodeNotAttachedError:
       Capybara::Webkit::NodeNotAttachedError 
```

当我在文件`Capybara.javascript_driver = :webkit`中向上移动一个级别时，我得到了同样的错误。`spec_helper.rb``Rspec.configure do`

当我从`before ... do`块中剪切每一行并将其粘贴到`it ... do block`要覆盖的第一行时，我得到了同样的错误。

当我设置`config.use_transactional_fixtures = true`和删除所有与 Webkit 相关的代码时，规范工作，当然 for 除外`page.find('#nav_reports').trigger(:mouseover)`，它需要一个 Javascript 驱动程序。

**更新**：我`page.current_path.should == report_path(@report)`在之前插入`save_and_open_page`并发现有关 Capybara-Webkit 的某些东西正在阻止我`visit report_path(@report)`的工作。（当我不尝试使用 Capybara-Webkit 测试依赖于 Javascript 的界面元素时，它工作正常。）错误代码是：

```
 Failure/Error: page.current_path.should == report_path(@report)
       expected: "/reports/3"
            got: nil (using ==) 
```

**进一步更新**：我发现当我使用 Capybara-Webkit 时，Rspec 很难找到`@report`对象，即使我将我的`@report = Report.create(...)`语句直接移动到访问之前的行`report_path(@report)`。完整的测试日志如下：

```
 Marker - 19/12/2012 11:55:45 AM
Connecting to database specified by database.yml
  [1m[36m (2.1ms)[0m  [1mALTER TABLE "references" DISABLE TRIGGER ALL;ALTER TABLE "values" DISABLE TRIGGER ALL;ALTER TABLE "variants" DISABLE TRIGGER ALL;ALTER TABLE "veracities" DISABLE TRIGGER ALL;ALTER TABLE "goods" DISABLE TRIGGER ALL;ALTER TABLE "orders" DISABLE TRIGGER ALL;ALTER TABLE "reports" DISABLE TRIGGER ALL;ALTER TABLE "roles" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "areas" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "ijoins" DISABLE TRIGGER ALL;ALTER TABLE "fields" DISABLE TRIGGER ALL;ALTER TABLE "footnotes" DISABLE TRIGGER ALL;ALTER TABLE "gjoins" DISABLE TRIGGER ALL;ALTER TABLE "heuristics" DISABLE TRIGGER ALL;ALTER TABLE "assignments" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "industries" DISABLE TRIGGER ALL;ALTER TABLE "markets" DISABLE TRIGGER ALL;ALTER TABLE "mjoins" DISABLE TRIGGER ALL[0m
  [1m[35m (2.0ms)[0m  select table_name from information_schema.views where table_schema = 'db/testivate_test'
  [1m[36m (82.3ms)[0m  [1mTRUNCATE TABLE "references", "values", "variants", "veracities", "goods", "orders", "reports", "roles", "users", "areas", "ijoins", "fields", "footnotes", "gjoins", "heuristics", "assignments", "categories", "industries", "markets", "mjoins" RESTART IDENTITY CASCADE;[0m
  [1m[35m (1.7ms)[0m  ALTER TABLE "references" ENABLE TRIGGER ALL;ALTER TABLE "variants" ENABLE TRIGGER ALL;ALTER TABLE "veracities" ENABLE TRIGGER ALL;ALTER TABLE "goods" ENABLE TRIGGER ALL;ALTER TABLE "values" ENABLE TRIGGER ALL;ALTER TABLE "orders" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "reports" ENABLE TRIGGER ALL;ALTER TABLE "roles" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "areas" ENABLE TRIGGER ALL;ALTER TABLE "ijoins" ENABLE TRIGGER ALL;ALTER TABLE "fields" ENABLE TRIGGER ALL;ALTER TABLE "footnotes" ENABLE TRIGGER ALL;ALTER TABLE "gjoins" ENABLE TRIGGER ALL;ALTER TABLE "heuristics" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "industries" ENABLE TRIGGER ALL;ALTER TABLE "markets" ENABLE TRIGGER ALL;ALTER TABLE "mjoins" ENABLE TRIGGER ALL;ALTER TABLE "assignments" ENABLE TRIGGER ALL
  [1m[36m (0.2ms)[0m  [1mBEGIN[0m
  [1m[35mUser Exists (0.7ms)[0m  SELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER('example@example.com') LIMIT 1
  [1m[36mUser Exists (0.3ms)[0m  [1mSELECT 1 AS one FROM "users" WHERE LOWER("users"."username") = LOWER('Virginia') LIMIT 1[0m
  [1m[35mUser Exists (0.3ms)[0m  SELECT 1 AS one FROM "users" WHERE "users"."persistence_token" = 'f0a9f99733b2d60d466811c27c5b0375019959e894845e6baced63af874c93cada0b6f8dd1e94e3cb99447c8bfddbbc22ed991ac6b7924f80a84649689fb25c7' LIMIT 1
  [1m[36mSQL (47.5ms)[0m  [1mINSERT INTO "users" ("created_at", "crypted_password", "email", "password_salt", "persistence_token", "updated_at", "username") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["created_at", Wed, 19 Dec 2012 00:56:22 UTC +00:00], ["crypted_password", "28f6bd928c62aab1dac4eb58c3ab3d8c09bb0ff762218bedfbf4457b234a0140cc4c7e01594fe6d9c0c5fc6acb283befc1eae12c21930187ba09547a413205fb"], ["email", "example@example.com"], ["password_salt", "BWr1wBmASo58D6d2j0aD"], ["persistence_token", "f0a9f99733b2d60d466811c27c5b0375019959e894845e6baced63af874c93cada0b6f8dd1e94e3cb99447c8bfddbbc22ed991ac6b7924f80a84649689fb25c7"], ["updated_at", Wed, 19 Dec 2012 00:56:22 UTC +00:00], ["username", "Virginia"]]
  [1m[35m (0.5ms)[0m  COMMIT
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
  [1m[35mSQL (1.3ms)[0m  INSERT INTO "roles" ("created_at", "name", "updated_at") VALUES ($1, $2, $3) RETURNING "id"  [["created_at", Wed, 19 Dec 2012 00:56:23 UTC +00:00], ["name", "admin"], ["updated_at", Wed, 19 Dec 2012 00:56:23 UTC +00:00]]
  [1m[36m (0.5ms)[0m  [1mCOMMIT[0m
  [1m[35m (0.1ms)[0m  BEGIN
  [1m[36mSQL (1.3ms)[0m  [1mINSERT INTO "assignments" ("created_at", "role_id", "updated_at", "user_id") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["created_at", Wed, 19 Dec 2012 00:56:23 UTC +00:00], ["role_id", 1], ["updated_at", Wed, 19 Dec 2012 00:56:23 UTC +00:00], ["user_id", 1]]
  [1m[35m (0.5ms)[0m  COMMIT
Started GET "/login" for 127.0.0.1 at 2012-12-19 11:56:29 +1100
Processing by UserSessionsController#new as HTML
  Rendered user_sessions/new.html.haml within layouts/application (30.1ms)
  Rendered shared/_subscribe.html.haml (15.6ms)
  Rendered shared/_share.html.haml (6.1ms)
  Rendered shared/_contact.html.haml (10.2ms)
Completed 200 OK in 420ms (Views: 319.1ms | ActiveRecord: 0.0ms)
Started GET "/assets/application.css" for 127.0.0.1 at 2012-12-19 11:56:30 +1100
Served asset /application.css - 200 OK (269ms)
Started GET "/assets/application.js" for 127.0.0.1 at 2012-12-19 11:56:31 +1100
Served asset /application.js - 200 OK (1611ms)
Started GET "/assets/subtle_dots3.png" for 127.0.0.1 at 2012-12-19 11:56:33 +1100
Served asset /subtle_dots3.png - 200 OK (75ms)
Started GET "/assets/background.png" for 127.0.0.1 at 2012-12-19 11:56:33 +1100
Served asset /background.png - 200 OK (56ms)
Started GET "/assets/logo3.png" for 127.0.0.1 at 2012-12-19 11:56:33 +1100
Served asset /logo3.png - 200 OK (24ms)
  [1m[36m (0.1ms)[0m  [1mBEGIN[0m
Started POST "/user_sessions" for 127.0.0.1 at 2012-12-19 11:56:35 +1100
Processing by UserSessionsController#create as HTML
  Parameters: {"utf8"=>"✓", "user_session"=>{"username"=>"Virginia", "password"=>"[FILTERED]", "remember_me"=>"0"}, "commit"=>"Login"}
  [1m[35mSQL (118.9ms)[0m  INSERT INTO "reports" ("created_at", "name", "short_name", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"  [["created_at", Wed, 19 Dec 2012 00:56:35 UTC +00:00], ["name", "The Testivate Retail Site Search Benchmark"], ["short_name", "Search"], ["updated_at", Wed, 19 Dec 2012 00:56:35 UTC +00:00]]
  [1m[36m (32.8ms)[0m  [1mCOMMIT[0m
  [1m[35mUser Load (1.3ms)[0m  SELECT "users".* FROM "users" WHERE (LOWER("users".username) = 'virginia') LIMIT 1
Redirected to http://127.0.0.1:61073/
Completed 302 Found in 348ms (ActiveRecord: 7.3ms)
Started GET "/" for 127.0.0.1 at 2012-12-19 11:56:36 +1100
Processing by HighVoltage::PagesController#show as HTML
  Parameters: {"id"=>"home"}
  [1m[36mUser Load (0.6ms)[0m  [1mSELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1[0m
  Rendered pages/home.html.haml within layouts/application (152.8ms)
  Rendered shared/_subscribe.html.haml (0.2ms)
  Rendered shared/_share.html.haml (0.2ms)
  Rendered shared/_contact.html.haml (0.3ms)
Completed 200 OK in 256ms (Views: 213.1ms | ActiveRecord: 0.6ms)
Started GET "/assets/steven_portrait.jpg" for 127.0.0.1 at 2012-12-19 11:56:36 +1100
Served asset /steven_portrait.jpg - 200 OK (18ms)
Started GET "/assets/stack-of-papers3.png" for 127.0.0.1 at 2012-12-19 11:56:36 +1100
Served asset /stack-of-papers3.png - 200 OK (10ms)
Started GET "/assets/guarantee.png" for 127.0.0.1 at 2012-12-19 11:56:36 +1100
Served asset /guarantee.png - 200 OK (3ms)
Started GET "/assets/sample-chart.png" for 127.0.0.1 at 2012-12-19 11:56:36 +1100
Served asset /sample-chart.png - 200 OK (3ms)
Started GET "/reports/1" for 127.0.0.1 at 2012-12-19 11:56:39 +1100
Processing by ReportsController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[35mUser Load (0.5ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36mReport Load (0.9ms)[0m  [1mSELECT "reports".* FROM "reports" WHERE "reports"."id" = $1 LIMIT 1[0m  [["id", "1"]]
  [1m[35mRole Load (0.7ms)[0m  SELECT "roles".* FROM "roles" INNER JOIN "assignments" ON "roles"."id" = "assignments"."role_id" WHERE "assignments"."user_id" = 1
  [1m[36mCACHE (0.0ms)[0m  [1mSELECT "reports".* FROM "reports" WHERE "reports"."id" = $1 LIMIT 1[0m  [["id", "1"]]
  [1m[35mArea Load (0.3ms)[0m  SELECT "areas".* FROM "areas" 
  [1m[36mCategory Load (0.4ms)[0m  [1mSELECT "categories".* FROM "categories" [0m
  [1m[35mHeuristic Load (0.4ms)[0m  SELECT "heuristics".* FROM "heuristics" WHERE "heuristics"."report_id" = 1
  Rendered reports/show.html.haml within layouts/wide (34.9ms)
Completed 200 OK in 499ms (Views: 161.8ms | ActiveRecord: 16.1ms)
Started GET "/images/shadow.png" for 127.0.0.1 at 2012-12-19 11:56:39 +1100
Started GET "/reports/1" for 127.0.0.1 at 2012-12-19 11:56:39 +1100
Processing by ReportsController#show as HTML
  Parameters: {"id"=>"1"}
  [1m[36m (2.7ms)[0m  [1mALTER TABLE "references" DISABLE TRIGGER ALL;ALTER TABLE "variants" DISABLE TRIGGER ALL;ALTER TABLE "veracities" DISABLE TRIGGER ALL;ALTER TABLE "goods" DISABLE TRIGGER ALL;ALTER TABLE "values" DISABLE TRIGGER ALL;ALTER TABLE "orders" DISABLE TRIGGER ALL;ALTER TABLE "schema_migrations" DISABLE TRIGGER ALL;ALTER TABLE "reports" DISABLE TRIGGER ALL;ALTER TABLE "roles" DISABLE TRIGGER ALL;ALTER TABLE "users" DISABLE TRIGGER ALL;ALTER TABLE "areas" DISABLE TRIGGER ALL;ALTER TABLE "ijoins" DISABLE TRIGGER ALL;ALTER TABLE "fields" DISABLE TRIGGER ALL;ALTER TABLE "footnotes" DISABLE TRIGGER ALL;ALTER TABLE "gjoins" DISABLE TRIGGER ALL;ALTER TABLE "heuristics" DISABLE TRIGGER ALL;ALTER TABLE "categories" DISABLE TRIGGER ALL;ALTER TABLE "industries" DISABLE TRIGGER ALL;ALTER TABLE "markets" DISABLE TRIGGER ALL;ALTER TABLE "mjoins" DISABLE TRIGGER ALL;ALTER TABLE "assignments" DISABLE TRIGGER ALL[0m
  [1m[35mUser Load (0.8ms)[0m  SELECT "users".* FROM "users" WHERE "users"."id" = 1 LIMIT 1
  [1m[36m (39.7ms)[0m  [1mTRUNCATE TABLE "references", "values", "variants", "veracities", "goods", "orders", "reports", "roles", "users", "areas", "ijoins", "fields", "footnotes", "gjoins", "heuristics", "assignments", "categories", "industries", "markets", "mjoins" RESTART IDENTITY CASCADE;[0m
  [1m[35mReport Load (37.2ms)[0m  SELECT "reports".* FROM "reports" WHERE "reports"."id" = $1 LIMIT 1  [["id", "1"]]
Completed 404 Not Found in 46ms

ActiveRecord::RecordNotFound - Couldn't find Report with id=1:
  (gem) activerecord-3.2.9/lib/active_record/relation/finder_methods.rb:341:in `find_one'
  (gem) activerecord-3.2.9/lib/active_record/relation/finder_methods.rb:312:in `find_with_ids'
  (gem) activerecord-3.2.9/lib/active_record/relation/finder_methods.rb:107:in `find'
  (gem) activerecord-3.2.9/lib/active_record/querying.rb:5:in `find'
  (gem) declarative_authorization-0.5.6/lib/declarative_authorization/in_controller.rb:143:in `load_controller_object'
  (gem) declarative_authorization-0.5.6/lib/declarative_authorization/in_controller.rb:527:in `block in filter_resource_access'
  (gem) activesupport-3.2.9/lib/active_support/callbacks.rb:440:in `_run__1180530030885761146__process_action__691010259609085274__callbacks'
  (gem) activesupport-3.2.9/lib/active_support/callbacks.rb:405:in `__run_callback'
  (gem) activesupport-3.2.9/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
  (gem) activesupport-3.2.9/lib/active_support/callbacks.rb:81:in `run_callbacks'
  (gem) actionpack-3.2.9/lib/abstract_controller/callbacks.rb:17:in `process_action'
  (gem) actionpack-3.2.9/lib/action_controller/metal/rescue.rb:29:in `process_action'
  (gem) actionpack-3.2.9/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
  (gem) activesupport-3.2.9/lib/active_support/notifications.rb:123:in `block in instrument'
  (gem) activesupport-3.2.9/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
  (gem) activesupport-3.2.9/lib/active_support/notifications.rb:123:in `instrument'
  (gem) actionpack-3.2.9/lib/action_controller/metal/instrumentation.rb:29:in `process_action'
  (gem) actionpack-3.2.9/lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
  (gem) activerecord-3.2.9/lib/active_record/railties/controller_runtime.rb:18:in `process_action'
  (gem) actionpack-3.2.9/lib/abstract_controller/base.rb:121:in `process'
  (gem) actionpack-3.2.9/lib/abstract_controller/rendering.rb:45:in `process'
  (gem) actionpack-3.2.9/lib/action_controller/metal.rb:203:in `dispatch'
  (gem) actionpack-3.2.9/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
  (gem) actionpack-3.2.9/lib/action_controller/metal.rb:246:in `block in action'
  (gem) actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:73:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
  (gem) actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:36:in `call'
  (gem) journey-1.0.4/lib/journey/router.rb:68:in `block in call'
  (gem) journey-1.0.4/lib/journey/router.rb:56:in `each'
  (gem) journey-1.0.4/lib/journey/router.rb:56:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/routing/route_set.rb:601:in `call'
  (gem) better_errors-0.2.0/lib/better_errors/middleware.rb:23:in `app_call'
  (gem) better_errors-0.2.0/lib/better_errors/middleware.rb:17:in `call'
  (gem) sass-3.2.3/lib/sass/plugin/rack.rb:54:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
  (gem) rack-1.4.1/lib/rack/etag.rb:23:in `call'
  (gem) rack-1.4.1/lib/rack/conditionalget.rb:25:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/head.rb:14:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/params_parser.rb:21:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/flash.rb:242:in `call'
  (gem) rack-1.4.1/lib/rack/session/abstract/id.rb:205:in `context'
  (gem) rack-1.4.1/lib/rack/session/abstract/id.rb:200:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/cookies.rb:341:in `call'
  (gem) activerecord-3.2.9/lib/active_record/query_cache.rb:64:in `call'
  (gem) activerecord-3.2.9/lib/active_record/connection_adapters/abstract/connection_pool.rb:479:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
  (gem) activesupport-3.2.9/lib/active_support/callbacks.rb:405:in `_run__3970772839722169598__call__3997376486539605674__callbacks'
  (gem) activesupport-3.2.9/lib/active_support/callbacks.rb:405:in `__run_callback'
  (gem) activesupport-3.2.9/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
  (gem) activesupport-3.2.9/lib/active_support/callbacks.rb:81:in `run_callbacks'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
  (gem) railties-3.2.9/lib/rails/rack/logger.rb:32:in `call_app'
  (gem) railties-3.2.9/lib/rails/rack/logger.rb:16:in `block in call'
  (gem) activesupport-3.2.9/lib/active_support/tagged_logging.rb:22:in `tagged'
  (gem) railties-3.2.9/lib/rails/rack/logger.rb:16:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/request_id.rb:22:in `call'
  (gem) rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
  (gem) rack-1.4.1/lib/rack/runtime.rb:17:in `call'
  (gem) activesupport-3.2.9/lib/active_support/cache/strategy/local_cache.rb:72:in `call'
  (gem) rack-1.4.1/lib/rack/lock.rb:15:in `call'
  (gem) actionpack-3.2.9/lib/action_dispatch/middleware/static.rb:62:in `call'
  (gem) railties-3.2.9/lib/rails/engine.rb:479:in `call'
  (gem) railties-3.2.9/lib/rails/application.rb:223:in `call'
  (gem) rack-1.4.1/lib/rack/builder.rb:134:in `call'
  (gem) rack-1.4.1/lib/rack/urlmap.rb:64:in `block in call'
  (gem) rack-1.4.1/lib/rack/urlmap.rb:49:in `each'
  (gem) rack-1.4.1/lib/rack/urlmap.rb:49:in `call'
  (gem) capybara-2.0.1/lib/capybara/server.rb:19:in `call'
  (gem) rack-1.4.1/lib/rack/handler/webrick.rb:59:in `service'
  /Users/steven/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
  /Users/steven/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
  /Users/steven/.rvm/rubies/ruby-1.9.3-p286/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread'

  [1m[36m (1.7ms)[0m  [1mALTER TABLE "references" ENABLE TRIGGER ALL;ALTER TABLE "variants" ENABLE TRIGGER ALL;ALTER TABLE "veracities" ENABLE TRIGGER ALL;ALTER TABLE "goods" ENABLE TRIGGER ALL;ALTER TABLE "values" ENABLE TRIGGER ALL;ALTER TABLE "orders" ENABLE TRIGGER ALL;ALTER TABLE "reports" ENABLE TRIGGER ALL;ALTER TABLE "roles" ENABLE TRIGGER ALL;ALTER TABLE "users" ENABLE TRIGGER ALL;ALTER TABLE "areas" ENABLE TRIGGER ALL;ALTER TABLE "schema_migrations" ENABLE TRIGGER ALL;ALTER TABLE "ijoins" ENABLE TRIGGER ALL;ALTER TABLE "fields" ENABLE TRIGGER ALL;ALTER TABLE "footnotes" ENABLE TRIGGER ALL;ALTER TABLE "gjoins" ENABLE TRIGGER ALL;ALTER TABLE "heuristics" ENABLE TRIGGER ALL;ALTER TABLE "assignments" ENABLE TRIGGER ALL;ALTER TABLE "categories" ENABLE TRIGGER ALL;ALTER TABLE "industries" ENABLE TRIGGER ALL;ALTER TABLE "markets" ENABLE TRIGGER ALL;ALTER TABLE "mjoins" ENABLE TRIGGER ALL[0m 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-04-08T14:20:32.823

可能不是正确的答案，但以防万一其他人像我一样用谷歌搜索这个答案，寻找想法：

我忘记了`visit`网址前面的正斜杠。出于某种原因，默认机架驱动程序对此很好，但我的 JS 驱动程序不是（capybara-webkit 和 poltergeist）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-29T13:28:07.653

我有一个类似的问题，仍然试图找出确切的问题，但使用`page.visit`而不是只是`visit`似乎有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-18T19:05:56.127

升级到`capybara-webkit`1.5.1 为我解决了这个问题。参见[thoughtbot/capybara-webkit#724](https://github.com/thoughtbot/capybara-webkit/issues/724)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-15T17:45:16.080

我们正在使用 capybara-webkit 1.3.1，capybara 2.1.0

由于返回了 304 状态代码，我看到了这一点。我认为 Capybara Webkit 出于某种原因没有呈现页面（可能是由于非 2xx 代码）并且会返回一个空白页面。

一旦我将标头设置为不可缓存，那么这个问题在我们的情况下就消失了。

# java - 不知道为什么这个图形屏幕没有更新

> ID：13943463
> 
> 赞同：4
> 
> 时间：2012-12-18T23:55:09.057
> 
> 标签：java, swing, graphics, awt

这是我试图重绘但未正确重绘的屏幕。

```
 public class arenaScreenBuild extends JPanel{
     int pX=200, pY=150;
     public void updateScreen(){
         repaint();
     }
     public void paintComponent(Graphics g) {
         g.drawString("x:"+pX, 535, 525);
         g.drawString("y:"+pY, 535, 545);       
     }
     public void refreshXY(int x, int y){
         pX=x;
         pY=y;
         System.out.println("Refreshed X&Y");
         updateScreen();
     }
 } 
```

这是显示图形的屏幕。运行时，每次我移动（按右箭头键）时，它都会显示“Refreshed X&Y”，但即使它调用 updateScreen() 方法，显示的项目也不会重绘。该代码，如果它已经工作，应该在“刷新的 X&Y”之后显示 x:XVALUE, y:YVALUE。

```
 public class ArenaKeys extends KeyAdapter {
     arenaScreenBuild arenaBG = new arenaScreenBuild();
     int xPos = 0, playerFace = 4,xPPos = 200, yPPos = 150;

     public void keyPressed(KeyEvent e) {
         int keyCode = e.getKeyCode();
         if (keyCode == e.VK_RIGHT) {
             if (xPos <= 3250) 
               if (((xPos + xPPos) >= 825) && ((xPos + xPPos) <= 910)
                       && (yPPos >= 170) && (yPPos <= 255)) {
               } else if (((xPos + xPPos) >= 1325) && ((xPos + xPPos)<= 1410)
                       && (yPPos >= 170) && (yPPos <= 255)) {
               } else
                   xPos += 5;
           }
           arenaBG.refreshXY(xPPos+xPos,yPPos);
       }
    } 
```

**编辑：** **结果它确实有效，但我正在做的是在另一个绘图面板的顶部添加一个绘图面板，这个代码是针对下面的，所以它不会让底部代码更新，我通过将两者合并在一起解决了这个问题两个拉板的代码。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:03:14.503

在 keyPressed call`EventQueue.invokeLater(new Runnable())`中，由于在事件处理线程上调用了 keyPressed，因此必须推迟重绘。

* * *

有一个 AWT 事件队列，其中事件在一个线程中处理。当一个事件被处理时，比如`keyPressed`GUI 被冻结；其他事件不并行处理。

所以这样的事件不应该做一些花费很长时间的事情，或者改变显示。

解决方案是推迟想要执行的代码。

这可以通过以下方式完成：

```
EventQueue.invokeLater(new Runnable() {
    @Override
    public void run() {
        ... the code ...
    }
 }); 
```

* * *

在 Java 中，有一个线程（进程）在无限循环中处理 GUI 事件，例如`keyPressed`，按钮单击或（间接）`paintComponent`。为此存在一个事件等待队列，称为`java.awt.EventQueue`.

所以这些事情不是并行完成的。这种限制使编码更简单，并且可以更好地映射到操作系统上，比如旧的 MacOS。

因此，当`keyPressed`（在事件线程上）被调用时，对 repaint 的调用将不起作用，因为它必须稍后在同一线程上的 repaintComponent 上处理。

解决方案是调用`invokeLater`which 将带有 Runnable 的事件放在事件队列中以供以后使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T09:51:55.630

xPos=0 最初和

```
 if (xPos <= 3250) { }
         else
            xPos += 5; 
```

这意味着 xPos 永远不会增加

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T22:39:52.270

这似乎对我有用（它是根据您的代码创建的 SSCCE）。由于它可以工作并且几乎没有对您的代码进行任何修改，因此问题可能不在于您发布的代码，而在于其他一些代码。此外，通常您希望使用[Key Bindings](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)而不是 KeyListener 来处理这类事情。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class Temp extends JPanel{
     int pX=200, pY=150;
     Dimension preferredSize = new Dimension(500,300);
    public Temp(){
        addKeyListener(new KeyAdapter() {
         int xPos = 0, playerFace = 4,xPPos = 200, yPPos = 150;

         public void keyPressed(KeyEvent e) {
             int keyCode = e.getKeyCode();
             if (keyCode == e.VK_RIGHT) {
                 if (xPos <= 3250) 
                   if (((xPos + xPPos) >= 825) && ((xPos + xPPos) <= 910)
                           && (yPPos >= 170) && (yPPos <= 255)) {
                   } else if (((xPos + xPPos) >= 1325) && ((xPos + xPPos)<= 1410)
                           && (yPPos >= 170) && (yPPos <= 255)) {
                   } else
                       xPos += 5;
               }
               refreshXY(xPPos+xPos,yPPos);
           }
        });

        setFocusable(true);
        requestFocus();
    }

    public Dimension getPreferredSize(){
        return preferredSize;
    }

     public void updateScreen(){
         repaint();
     }
     public void paintComponent(Graphics g) {
         super.paintComponent(g);
         g.drawString("x:"+pX, 0, 20);
         g.drawString("y:"+pY, 0, 40);       
     }
     public void refreshXY(int x, int y){
         pX=x;
         pY=y;
         System.out.println("Refreshed X&Y");
         updateScreen();
     }

    public static void main(String[] args) {
        JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setContentPane(new Temp());
        frame.pack();
        frame.setVisible(true);
    }
 } 
```

# android - 在 Android NDK - C/embed 中映射有关传感器的信号量内存值

> ID：13943466
> 
> 赞同：0
> 
> 时间：2012-12-18T23:55:42.440
> 
> 标签：android, c++, c, android-ndk, embedded

Android NDK 是否将传感器生成的值暴露在内存的预定义部分中，以便我可以做这样的事情

```
T* ptr = 0x124 
```

?

这是可能的，这是由 Android 团队标准化的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T18:59:09.530

不，他们会这样做是非常不可思议的。

与典型的 C-on-unix 环境相比，NDK 使您与硬件更加隔离，这既是由于安全模型所必需的，也是由于这些细节在众多 Android 版本和供应商之间的主要可变性而可取的。

# opengl - OpenGL - 立方体上的白边

> ID：13943468
> 
> 赞同：1
> 
> 时间：2012-12-18T23:55:59.627
> 
> 标签：opengl, rendering, lwjgl

在我正在制作的类似我的世界的游戏中，我的立方体上有白边：

![](../Images/3adc5edf517fdeb1539b23c60b1268e6.png)

它在较暗的纹理中更加明显。纹理是这样设置的：

```
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE); 
```

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:50:10.357

如果您使用最近邻过滤 ( `glTexParameter(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST`)，这就是结果。由于顶点的变换方式，有时这会导致在您想要的图块之外的一个像素处进行纹理查找。

解决方案相当简单，只需将所有纹理坐标移动到图块中，大小为半个像素，即`(1.0f / width) * 0.5f`. 这保证了纹理上像素的最近邻居永远不会超出您想要的图块。

# c - C 管道中的 Unix Shell 问题

> ID：13943470
> 
> 赞同：-3
> 
> 时间：2012-12-18T23:56:17.850
> 
> 标签：c, shell, unix, fork, pipe

我目前正在研究 unix shell c。我的问题是管道，我去过很多论坛，但我无法解决。我浏览了一个临时文件。

先感谢您。

代码在这里： http: [//pastebin.com/cuGbJ6XD](http://pastebin.com/cuGbJ6XD)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:10:28.323

您想查看“man 2 pipe”、“man 2 dup2”和“man 3 popen”。前两个是您需要的，最后一个是您正在尝试构建但应该提供想法的子集。

基本步骤
- 分叉
- 创建管道
- 再次分叉
* 在分叉的一侧，关闭 stdout (1) 和 dup2 管道输出到 1
* 在分叉的另一侧，关闭 stdin (0) 和 dup2 管道输入到0
* 在两侧，关闭原始管道描述符
- 在 fork 的每一侧，执行正确的程序。

有一段时间了，但那是我记得的。

# javascript - ng-include 的正确语法是什么？

> ID：13943471
> 
> 赞同：404
> 
> 时间：2012-12-18T23:56:27.943
> 
> 标签：javascript, html, angularjs, syntax, include

我试图在 中包含一个 HTML 片段`ng-repeat`，但我无法让包含工作。似乎当前的语法与`ng-include`以前不同：我看到许多示例使用

```
<div ng-include src="path/file.html"></div> 
```

但是在[官方文档](https://code.angularjs.org/1.1.0/docs/api/ng.directive:ngInclude#Usage)中，它说要使用

```
<div ng-include="path/file.html"></div> 
```

但随后[在页面下方](https://code.angularjs.org/1.1.0/docs/api/ng.directive:ngInclude#Example)显示为

```
<div ng-include src="path/file.html"></div> 
```

不管怎样，我试过了

```
<div ng-include="views/sidepanel.html"></div> 
```

```
<div ng-include src="views/sidepanel.html"></div> 
```

```
<ng-include src="views/sidepanel.html"></ng-include> 
```

```
<ng-include="views/sidepanel.html"></ng-include> 
```

```
<ng:include src="views/sidepanel.html"></ng:include> 
```

我的代码片段不是很多代码，但它有很多事情要做；[我在Dynamically load template inside`ng-repeat`](https://stackoverflow.com/questions/12361680/)中读到了可能会导致问题的内容，所以我`sidepanel.html`只用 word替换了 的内容`foo`，但仍然没有。

我还尝试直接在页面中声明模板，如下所示：

```
<script type="text/ng-template" id="tmpl">
    foo
</script> 
```

并运行`ng-include`引用脚本的所有变体`id`，但仍然没有。

我的页面中有更多内容，但现在我将其简化为：

```
<!-- index.html -->
<html>
<head>
<!-- angular includes -->
</head>
<body ng-view="views/main.html"> <!-- view is actually set in the router -->
    <!-- views/main.html -->
    <header>
        <h2>Blah</h2>
    </header>
    <article id="sidepanel">
        <section class="panel"> <!-- will have ng-repeat="panel in panels" -->
            <div ng-include src="views/sidepanel.html"></div>
        </section>
    </article>
<!-- index.html -->
</body>
</html> 
```

标题呈现，但我的模板没有。我在控制台或 Node 中没有收到任何错误，如果我单击`src="views/sidepanel.html"`开发工具中的链接，它会将我带到我的模板（并显示`foo`）。

* * *

## 回答 #1

> 赞同：780
> 
> 时间：2012-12-19T00:11:08.883

您必须`src`在双引号内单引号您的字符串：

```
<div ng-include src="'views/sidepanel.html'"></div> 
```

[来源](https://groups.google.com/d/msg/angular/PNK5_uvm1v8/3nXLipPzWvMJ)

* * *

## 回答 #2

> 赞同：135
> 
> 时间：2014-06-23T13:59:47.540

```
 <ng-include src="'views/sidepanel.html'"></ng-include> 
```

或者

```
 <div ng-include="'views/sidepanel.html'"></div> 
```

或者

```
 <div ng-include src="'views/sidepanel.html'"></div> 
```

要记住的要点：

--> src 中没有空格

--> src 记得在双引号中使用单引号

* * *

## 回答 #3

> 赞同：50
> 
> 时间：2013-11-16T19:39:29.313

对于那些故障排除，重要的是要知道 ng-include 要求 url 路径来自应用程序根目录，而不是来自 partial.html 所在的同一目录。（而 partial.html 是可以找到内联 ng-include 标记的视图文件）。

例如：

> 正确：div ng-include src="'/views/partials/tabSlides/add-more.html'">
> 
> 不正确：div ng-include src="'add-more.html'">

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2014-05-29T06:55:08.450

对于那些正在从部分中寻找最短的“项目渲染器”解决方案的人，因此**ng-repeat 和 ng-include 的组合**：

`<div ng-repeat="item in items" ng-include src="'views/partials/item.html'" />`

实际上，如果您像这样将它用于一个中继器，它会起作用，但不会用于其中的 2 个！如果您一个接一个地拥有其中的 2 个，Angular (v1.2.16) 会因某种原因吓坏了，因此以 pre-xhtml 方式关闭 div 会更安全：

`<div ng-repeat="item in items" ng-include src="'views/partials/item.html'"></div>`

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2014-09-09T21:43:33.200

也许这对初学者有帮助

```
<!doctype html>
<html lang="en" ng-app>
  <head>
    <meta charset="utf-8">
    <title></title>
    <link rel="icon" href="favicon.ico">
    <link rel="stylesheet" href="custom.css">
  </head>
  <body>
    <div ng-include src="'view/01.html'"></div>
    <div ng-include src="'view/02.html'"></div>
    <script src="angular.min.js"></script>
  </body>
</html> 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-09-12T21:12:28.383

这对我有用：

```
ng-include src="'views/templates/drivingskills.html'" 
```

完整的div：

```
<div id="drivivgskills" ng-controller="DrivingSkillsCtrl" ng-view ng-include src="'views/templates/drivingskills.html'" ></div> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-15T11:20:15.093

试试这个

```
<div ng-app="myApp" ng-controller="customersCtrl"> 
  <div ng-include="'myTable.htm'"></div>
</div>

<script>
var app = angular.module('myApp', []);
app.controller('customersCtrl', function($scope, $http) {
    $http.get("customers.php").then(function (response) {
        $scope.names = response.data.records;
    });
});
</script> 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2019-01-25T04:38:01.620

在 ng-build 上，出现找不到文件 (404) 错误。所以我们可以使用下面的代码

```
<ng-include src="'views/transaction/test.html'"></ng-include> 
```

**安装，**

```
<div ng-include="'views/transaction/test.html'"></div> 
```

# php - 为什么这个 ajax 查询不返回成功结果？

> ID：13943473
> 
> 赞同：0
> 
> 时间：2012-12-18T23:56:41.480
> 
> 标签：php, jquery

我无法理解为什么这个 ajax 查询失败，尽管它看起来很简单。我只是传递了一个新名称，并要求创建一个新记录，然后刷新一个包含新记录的选择列表。

这是将函数附加到新建、编辑、保存和取消按钮的 jQuery 代码：

```
var is_new = 0;

  $(document).ready(function()
  {
    // Attach event handlers to buttons
    $('#editbtn').on('click',pop_studyname);
    $('#newbtn').on('click',new_studyname);
    $('#savebtn').on('click',save_studyname);
    // disable the Save button until we have something to save
    $('#savebtn').attr('disabled',true);
    // disable the Cancel button until we have something to cancel
    $('#cancelbtn').attr('disabled',true);

  });

  function pop_studyname()
  {
    // pop the selected studyname into edit box.
    $('#edit_field').val($('#studylist :selected').text());
    // disable the New Study button
    $('#newbtn').attr('disabled',true);
    // enable the Cancel button
    $('#cancelbtn').attr('disabled',false);
    // and bind it to a function
    $('#cancelbtn').on('click',cancel_studyname);    
    // enable the Save button
    $('#savebtn').attr('disabled',false);
    // and bind it to a function
    $('#savebtn').on('click',save_studyname);
  }

  function new_studyname()
  {
    // clear edit box.
    $('#edit_field').val('');
    /**************************/
    /* set flag for New Study */
    is_new = 1;
    /**************************/

    // Enable the Cancel button
    $('#cancelbtn').attr('disabled',false);
    // and bind it to a function.
    $('#cancelbtn').on('click',cancel_studyname);
    // Disable the Edit button.
    $('#editbtn').attr('disabled',true);
    // Enable the Save button
    $('#savebtn').attr('disabled',false);
    // and bind it to a function.
    $('#savebtn').on('click',save_studyname);
    // put the cursor in the edit box
    $('#edit_field').focus();
  }

  function cancel_studyname()
  {
    // clear edit box.
    $('#edit_field').val('');
    // disable cancel button.
    $('#cancelbtn').attr('disabled',true);
    // disable Save button.
    $('#savebtn').attr('disabled',true);
    // Enable the Edit button.
    $('#editbtn').attr('disabled',false);
    // And the New Study button.
    $('#newbtn').attr('disabled',false);
    // Reset new study trigger variable. 
    is_new = 0;
  }

  function save_studyname()
  {
    // Are we saving a new or existing Study?
    if (is_new == 1) {
        $.ajax({
            type: 'POST',
            URL: "saveStudyName.php",
            data: {'type': 'new', 'studyname': $('#edit_field').val()},
        dataType: "json",
            success: function(resultmsg) {
              alert(resultmsg);
            },
            error: function() {
          console.log(resultmsg);
              alert('Huston, we have a problem...');
            }
        });
    // reset the trigger flag
    is_new = 0;

    }
    else {
      // Update an existing Study.
        // Get the record index and edited study name.
        var styndx = $('#studylist option:selected').val();
        var studyname = $('#edit_field').val();

    // Use ajax post call to update database.
        $.post("saveStudyName.php", {'type': 'update', 'studyname':studyname, 'styndx':styndx}, 
      function(resultmsg) {
      // refresh the picklist
      refresh_studynames();
      // clear the edit field
      $('#edit_field').val('');
      });      

    }
    // disable the Save button
    $('#savebtn').attr('disabled',true);
    // Enable the Edit button.
    $('#editbtn').attr('disabled',false);
    // Enable the New Study button.
    $('#newbtn').attr('disabled',false);
    // Finally, refresh the studyname picklist.
    refresh_studynames();
  } 
```

这是被调用的 PHP 脚本：

```
 $type = $_POST['type'];
    $studyname = $_POST['studyname'];
    $styndx = $_POST['styndx'];

    //$a = json_decode($_POST[],true);
    $debug=0;
    if ($debug) { 
         echo "studyname = ".$studyname."<br>";
         echo "styndx = ".$styndx."<br>";
         echo "type = ".$type."<br>";
    }

    // query the database.
    $dbconnect = pg_pconnect("host=".$hostname." user=".$dbuser." dbname=".$dbname);    
    if (!$dbconnect)    {
        showerror(0,"Failed to connect to database",'saveStudyName',30,"username=".$dbuser.", dbname=".$dbname);
        exit;
    }

    if ($type == 'new') {
        $sql = "INSERT INTO ibg_studies (ibg_studyabrv) VALUES ('".$studyname."')";
    } else {
        $sql = "UPDATE ibg_studies SET studyabrv='".$studyname."' WHERE ibg_studies_index=".$styndx;        
    }

    $debug=0;
    if ($debug) { 
        echo "SQL = ".$sql;
    }

    $fetchresult = pg_exec($dbconnect, $sql);
    if ($fetchresult) {
        $msg = "Success!";
    } else {
        $msg = "Failure! SQL="+$sql;
    }

    echo json_encode($msg); 
```

当我使用 Chrome 调试器单步执行 javascript 时，ajax 的成功或错误子句都不会触发，尽管我可以看到 jQuery 被调用......所以这对我来说是个谜！

# php - php 脚本有 facebook 数据，但不会将其插入 mysql 数据库

> ID：13943474
> 
> 赞同：1
> 
> 时间：2012-12-18T23:56:48.530
> 
> 标签：php, mysql, facebook, insert

我已经为此工作了大约 2 天，在检查了我的代码和错误日志几个小时后找不到解决方案。所以，我希望一些新鲜的眼睛会有所帮助。

我正在收集 facebook 数据并将其插入到我的数据库中。当我在 $sql INSERT 命令上运行 var_dump 时，我看到字符串中的所有 facebook 数据。我还在每个变量上运行了 var_dumps 以确保数据存在。它是并且每个都显示为字符串类型。这符合数据库的预期——VARCHAR 有足够的空间。

我在这个数据库中有一些其他表，它们仍在接受数据，所以这似乎不是数据库问题（这是一个共享服务器，我无权访问它）。此外，我在 INSERT 语句中尝试了几乎所有语法变体、不同引号等，但无济于事......

最后，由于 mysql_error() 我得到的错误是“您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以获取正确的语法，以便在附近使用'我只是一个冷酷的家伙正在寻找一些有趣......'，'AAAIAZB21He9sBAOLpbm3XTwabMVX0s' 在第 1 行"。您在单引号 (') 中看到的是 INSERT 语句中 $fbabout 和 $at VALUES 的当前数据。

有了它，这里是 php 文件的代码。提前感谢您抽出宝贵时间查看此内容！

```
<?php 
require_once("facebook.php");

$app_id = "";
$app_secret = "";
$my_url = "";

$code = $_POST["code"];

if(empty($code)) {
        $dialog_url = "https://www.facebook.com/dialog/oauth?client_id=" 
        . $app_id . "&redirect_uri=" . urlencode($my_url) . "&state="
        . $_SESSION['state']."&scope=email,user_birthday,user_interests,friends_interests,publish_stream,user_about_me,user_checkins";

        echo("<script> top.location.href='" . $dialog_url . "'</script>");

} else {
    $host=""; // Host name 
    $username=""; // Mysql username 
    $password=""; // Mysql password 
    $db_name=""; // Database name 
    $tbl_name=""; // Table name  

    // Connect to server and select database.
    mysql_connect("$host", "$username", "$password")or die("cannot connect");
    mysql_select_db("$db_name")or die("cannot select DB");  

        $token_url = "https://graph.facebook.com/oauth/access_token?"
        . "client_id=" . $app_id . "&redirect_uri=" . urlencode($my_url)
        . "&client_secret=" . $app_secret . "&code=" . $code;

        $response = file_get_contents($token_url);
        $params = null;
        parse_str($response, $params);

        $_SESSION['access_token'] = $params['access_token'];

        $graph_url = "https://graph.facebook.com/me?access_token=". $params['access_token'];
    $interests = "https://graph.facebook.com/me/interests?access_token=". $params['access_token'];

    $user = json_decode(file_get_contents($graph_url));
    $user_interests = json_decode(file_get_contents($interests));

    $id = $user->id;        
    $fname = $user->first_name;
    $lname = $user->last_name;
    $link = $user->link;
    $gender = $user->gender;
    $locale = $user->location->name;
    $email = $user->email;
    $bday = $user->birthday;

    $uidata = array();
    $number = count($user_interests->data);
            for ($i = 0;$i<=$number-1;$i++){
           array_push($uidata,($user_interests->data[$i]->name));
    }
    $ui = implode(",", $uidata);

    $fbabout = $user->bio;
    $at = $params['access_token'];

    // Insert data into mysql 
    $sql="INSERT INTO $tbl_name(fbid,fname,lname,link,gender,locale,email,birthday,interests,fbabout,fbtoken)VALUES('".$id."','".$fname."','".$lname."','".$link."','".$gender."','".$locale."','".$email."','".$bday."','".$ui."','".$fbabout."','".$at."')";
    $result=mysql_query($sql);

    if($result) {
        header( 'Location: https://crushonit.com/join/fbRegister.html' );
    } else {
        echo mysql_error();
    }

} 
?>

<?php 
// close connection 
mysql_close();
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T01:00:25.793

正如其他人所评论的那样，您应该始终在将任何数据插入数据库之前对其进行清理，至少使用 mysql_real_escape_string()。在你的情况下，“我”正在给你带来问题。

不过，我还有另一个问题；您正在使用 PHP SDK，包括 facebook.php，但您也使用 file_get_contents 手动查询图形。这让我觉得很奇怪，因为如果您使用的是 SDK，则不需要这样做。SDK 将创建一个对象并由您查询。

[https://developers.facebook.com/docs/reference/php/](https://developers.facebook.com/docs/reference/php/)

上面的链接可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T19:28:51.517

$table_name 浏览器将此读取为变量 从 table_name 中删除此 $

# c# - OrderBy Linq 与美国日期

> ID：13943479
> 
> 赞同：4
> 
> 时间：2012-12-18T23:57:21.607
> 
> 标签：c#, linq

我想显示带有日期的项目的降序列表，但我似乎无法让 orderby 子句进行双重排序。对于一个普通的美国人，你想先按年排序，然后按月排序，然后按天排序。请参阅下面的代码。

> 2012 年 10 月 21 日 = 2012 年 10 月 21 日
> 
> 2012 年 12 月 3 日 = 12/03/2012
> 
> 2013 年 1 月 15 日 = 01/15/2013

无论我如何排序，我总是得到我在下面看到的内容，我尝试更改字符串格式化程序，但这似乎不起作用。我在子句中添加了一些转换/解析方法，但这没有帮助。我正在寻找一个高性能的解决方案，因为这是一个处理很长列表的移动应用程序。最快的方法是什么？创建自定义比较器？有没有办法做第二个 orderby 子句？

我总是最终看到的，为什么 2012 年之后不是 2013 年？

> 2013 年 1 月 15 日
> 
> 2013 年 10 月 21 日
> 
> 2012 年 12 月 3 日

```
IEnumerable<Group<FeedItem>> sortedItems = 
    from feedItem in _localLists.CustomList
    group feedItem by feedItem.EventDate
    into c
    orderby 
        (DateTime.ParseExact(c.Key, "MM-dd-yyyy", 
            CultureInfo.InvariantCulture)) ascending
    select new Group<FeedItem>(c.Key, c); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T04:32:22.837

我回去将字符串更改为 DateTime，这显然是一个加号。问题只是显示。我正在使用 Telerik 控件对列表进行分组、过滤和排序，但 linq 并没有驱动我所看到的内容。解决方案是 UI 上的设置不正确。

# language-agnostic - 如何将十六进制字符串拆分为字节？

> ID：13943481
> 
> 赞同：1
> 
> 时间：2012-12-18T23:57:48.487
> 
> 标签：language-agnostic, numbers, hex, byte, bit-manipulation

因为十六进制通常用于表示 RGBA 颜色模型数据之类的东西，所以我试图找出如何获取像 0x11AA22BB 这样的大*十六进制字符串*并将其拆分为单独的字节。（所以，本质上是 0x11、0xAA、0x22 和 0xBB 块……）。我知道每个十六进制数字可以直接用四位表示。但是，将一连串的比特分解成更小的组也不是我知道该怎么做的事情。

所以，我相信这可能有一个简单的答案。我确定它可能与将其转换为单字节数组或使用按位运算符或其他东西有关，但我无法弄清楚。我知道还有一个字节顺序问题以及字节的组织方式（RGBA、ARBG、ABGR 等），但现在我只是想了解如何进行拆分，以便对这个怎么运作。我正在使用 C++，但我认为这可能不一定特定于该语言。

所以，重申一下；*如何将像 0x11AA22BB 这样的大十六进制字符串拆分为 0x11、0xAA、0x22、0xBB？*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T00:01:53.163

这两种方式分别是 mod/div 和 shift/mask，但实际上都是相同的方式。

模组/分区：

```
num = 0x11aa22bb
while num > 0:
  byte = num % 0x100
  print hex(byte)
  num //= 0x100 
```

班次/掩码：

```
num = 0x11aa22bb
while num > 0:
  byte = num & 0xff
  print hex(byte)
  num >>=8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T12:01:55.263

如果您不介意离开 C++ 并且您拥有一台 Linux 机器，您可以使用以下命令对它进行 sed：

> sed 's/0x/ /g' 文件.hex | sed 's/[a-fA-F0-9]{2}/0x& /g' | tr -s''

第一个命令删除 0x 前缀并用空格替换它们，第二个命令将序列拆分为字节并将前缀添加到每个部分。最后一个命令挤压空格。

请注意，您可以通过删除文件名 (file.hex) 在标准输入上使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-23T17:43:52.757

```
void splitByte(unsigned char * split, unsigned int a,int quantBytes)
{
  unsigned char aux;
  int i;
  for(i=0;i<quantBytes;i++)
  {
      split[i]=a&0x00FF; 
      a=(a>>8);
  }
  for(i=0;i<quantBytes-1;i++)
  {
      aux = split[i];
      split[i] = split[quantBytes-i-1];
      split[quantBytes-i-1] = aux;

  }
} 
```

主要是： unsigned char split[4]; splitByte（拆分，0xffffffff，4）；**强文本**

# sql - 基于变量的动态where子句

> ID：13943483
> 
> 赞同：2
> 
> 时间：2012-12-18T23:57:52.760
> 
> 标签：sql, tsql

我正在处理 SQL 中的 select 语句，并且在尝试创建包含 case 语句或 if else 语句的 where 子句时遇到问题。我想根据变量的值选择记录。如果变量为“True”，则仅从 select 语句中返回列为空的记录。如果变量不是“真”，则返回所有记录，无论该列是否为空。

关于如何做到这一点的任何提示？

下面是我正在尝试做的一个简单示例：

```
declare @option1 as varchar(5)

--This can be True or False so to test i just put the Set option below
set @option1 = 'True'

Select a,b,c,d...
from ...
where d = case when @option1 = 'True' then NULL End 
```

这是我不知道该怎么做的部分。如果变量为“真”，我只需要过滤掉记录，所以不确定在案例的 else 部分中放置什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T00:01:02.877

您不能`d = NULL`像您的 CASE 语句那样进行测试，因为这将始终返回 false，因为[NULL 不等于 NULL](https://stackoverflow.com/questions/9004570/why-does-comparing-a-sql-date-variable-to-null-behave-in-this-way/9004627#9004627)（除非您将 ANSI_NULLS 设置为“off”）。

最简单的做法是将 WHERE 子句更改为：

```
WHERE @option1 = 'False' OR d IS NULL 
```

如果出于某种原因你更喜欢使用 CASE 语句，你可以这样写：

```
WHERE 1 = CASE WHEN @option1 = 'False' THEN 1 
               WHEN @option1 = 'True' AND d IS NULL THEN 1 
               ELSE 0 
          END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T02:01:45.650

这：

更新：PinnyM 让我明白了这一点。为了大众的教育，我把我令人尴尬的逻辑错误的论点留在这里。我在下面“试试这个”之后提出的解决方案当然仍然有效，但 PinnyM 的解决方案要优雅得多，应该使用。

> WHERE @option1 = 'False' OR d 为 NULL

将始终返回给定当前选择语句的所有结果（假设 @Option1 只是传入的标志参数）。

试试这个：

```
SELECT a, b, c, d
WHERE 
    -- Returns only rows where d is null (if @Option1 is True)
    (@Option1 = 'True' AND d IS NULL) 
    OR
     -- returns all the rows (if @Option1 is False)
    (@Option1 = 'False') 
```

# php - ubercart 3 限制结账所需的购物车总数量（例如不超过 8 个散装袋）

> ID：13943484
> 
> 赞同：2
> 
> 时间：2012-12-18T23:57:58.413
> 
> 标签：php, drupal-7, ubercart

我正在尝试使用 Ubercart 3 在 Drupal 7 中完成一项任务。任务是限制结帐所需的购物车总数量（例如，不超过 8 个散装袋）。这仅适用于少数项目，如果项目 1 为 8，则不允许添加更多项目（最大也有 8 个散装袋），但允许添加其他项目。项目 1 的最大数量为 8，项目 2 也是如此。在购物车中，如果 item1 有 5 个，则允许将 3 个项目添加到 item2 或 item3。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-06T09:41:19.283

使用自定义模块，我在其中限制了添加到购物车和更新购物车。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:05:03.040

Ubercart 产品最小值和最大值可能适合您的需求。在添加到购物车和结帐时启用每个产品的最小值和最大值：

[http://drupal.org/project/uc_product_minmax](http://drupal.org/project/uc_product_minmax)

# objective-c - 客观 c UTF8String 不适用于日语

> ID：13943487
> 
> 赞同：1
> 
> 时间：2012-12-18T23:58:07.153
> 
> 标签：objective-c, utf-8, nsstring

我想在我的 UILabel 上显示下面的 NSString：

```
NSString *strValue=@"你好"; 
```

但我不能在我的 UILabel 上显示它我得到奇怪的字符！

我使用此代码显示文本：

```
[NSString stringWithCString:[strValue UTF8String] encoding:NSUTF8StringEncoding]; 
```

我试过`[NSString stringWithCString:[strValue cStringUsingEncoding:NSISOLatin1StringEncoding] encoding:NSUTF8StringEncoding]`了，它奏效了

但我无法显示**表情符号**，`cStringUsingEncoding:NSISOLatin1StringEncoding`所以我必须使用`UTF8String`。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:14:48.130

您的源文件是 UTF-8 格式，但您使用的编译器认为它是 ISO-Latin 1。您认为 string`@"你好"`实际上是 string `@"ä½ å¥½"`。但是，当您要求`NSString*`将其返回为 ISO-Latin 1 并将其视为 UTF-8 时，您已经反转了编译器所采用的过程，最终得到了原始字符串。

您可以在此处使用的一种解决方案是告诉您的编译器您的源文件的编码是什么。有一个编译器标志（对于 GCC，它是`-finput-charset=UTF-8`，不确定 clang）将告诉编译器使用什么编码。奇怪的是，UTF-8 应该已经是默认设置了，但也许您正在使用语言环境覆盖它。

更便携的解决方案是在源文件中仅使用 ASCII。`\u1234`您可以通过使用或使用字符串转义替换非 ASCII 字符来完成此操作`\U12345678`。在你的情况下，你会使用

```
NSString *strValue=@"\u4F60\u597D"; 
```

当然，一旦你的字符串常量是正确的，你可以放弃整个编码的东西，直接使用`strValue`。

# java - 杰克逊地图序列化，不调用键的自定义序列化程序

> ID：13943488
> 
> 赞同：3
> 
> 时间：2012-12-18T23:58:10.147
> 
> 标签：java, json, serialization, jackson

我需要具有允许我序列化的功能`Map<CustomType1, CustomType2>`。我创建了从 JsonSerializer 继承的自定义序列化器。我还创建了简单的模块并将其注册到我的映射器中；

```
SimpleModule myModule = new SimpleModule("myModule");
myModule.addKeySerializer(CustomType1.class, new CustomType1Serializer());
myModule.addSerializer(CustomType1.class, new CustomType1Serializer());
mapperInstance.registerModule(myModule); 
```

当我只是序列化 CustomType1 的一个实例时，它工作得很好，但是当我创建地图并尝试对其进行序列化时，杰克逊会跳过我的序列化程序并使用`StdKeySerializer`. **怎么解决？？？**

感谢您的关注。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T01:33:51.540

这个问题似乎与杰克逊对通用对象的处理有关。解决此问题的一种方法是使用超类型标记来严格定义映射类型。插图：

```
final ObjectMapper mapper = new ObjectMapper();

final SimpleModule module = new SimpleModule("myModule",
        Version.unknownVersion());
module.addKeySerializer(CustomType1.class, new CustomType1Serializer());
mapper.registerModule(module);

final MapType type = mapper.getTypeFactory().constructMapType(
        Map.class, CustomType1.class, CustomType2.class);
final Map<CustomType1, CustomType2> map = new HashMap<CustomType1, CustomType2>(4);
final ObjectWriter writer = mapper.writerWithType(type);
final String json = writer.writeValueAsString(map); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-06-24T22:23:25.083

addSerializer 和 addKeySerializer 只是两种类型的可用序列化器，它们只处理简单的非 POJO 类型。要对更复杂的类型（例如地图和集合）进行自定义序列化，您需要在模块上使用 .setSerializerModifier，并使用 BeanSerializerModifier 覆盖 modifyMapSerializer 方法并返回您的自定义序列化器

# objective-c - 动画后UITextView不响应触摸事件

> ID：13943493
> 
> 赞同：4
> 
> 时间：2012-12-18T23:59:05.360
> 
> 标签：objective-c, ios, xcode, animation, uitextview

如果我展开视图，我正在执行动画以正确地将 保持`UITextView`在屏幕底部。出于某种原因，如果我执行动画，`UITextView`停止响应触摸事件，所以没有键盘会出现。

我正在做的就是：

```
CGRect newSendTextView = self.commTextView.frame;
newSendTextView.origin.y = (newSendTextView.origin.y + (height - self.defaultSize.size.height));

[UIView beginAnimations:nil context:NULL];
[UIView setAnimationDuration:.5];
self.commTextView.frame = newSendTextView;
[UIView commitAnimations]; 
```

我知道`UITextView`在我进行转换后它仍然在屏幕上，因为我将`UITextView`背景着色为亮蓝色，但它不想响应任何触摸事件。

如果我注释掉`self.commTextView.frame = newSendTextView;`它不会移动，触摸事件就会注册。

我不知道为什么会这样，我试过了

```
[self.commTextView becomeFirstRespond]; 
```

我已经检查了是否设置为`isEditable`并且是。`isUserInteractionEnabled``1`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T08:44:35.307

我想，新的位置`TextView`可能会被其他视图覆盖。检查任何其他是否在您的新位置`View`上具有相同的框架。`TextView`使用`clipsToBounds`属性找到它。

# c++ - Cocos2d-x 子类化问题 CCMenuItemImage

> ID：13943498
> 
> 赞同：0
> 
> 时间：2012-12-18T23:59:53.537
> 
> 标签：c++, subclass, cocos2d-x, ccmenuitem

我正在尝试创建一个从基类 CCMenuItemImage 派生的按钮。我希望这个按钮能够在第一次触摸而不是在触摸结束后调用它的功能。但是，尝试子类化时，我收到一条错误消息，说这是无效的转换。

按钮.ccp：

```
#include "button.h"

void Button::selected(){
CCLOG("SELECTED");
}

void Button::unselected(){
CCLOG("UNSELECTED");
}

Button* Button::create(const char *normalImage, const char *selectedImage, const char     *disabledImage, CCObject* target, SEL_MenuHandler selector) {
Button *button = new Button();
    if (button && button->initWithNormalImage(normalImage, selectedImage,     disabledImage, NULL, NULL))
    {
        button->autorelease();
        return button;
    }
    CC_SAFE_DELETE(button);
    return NULL;

} 
```

按钮.h：

```
#ifndef BUTTON_H
#define BUTTON_H
#include "cocos2d.h"

class Button : public cocos2d::CCMenuItemImage{
public:
virtual void selected();

virtual void unselected();

};

#endif 
```

SinglePlayer.ccp 片段：

```
Button *left1 = Button::create("turncircle.png","turncircle.png", this, menu_selector(SinglePlayer::turning)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:58:05.787

MenuItem select() 默认在触摸完成时触发。

您需要使用向调度程序注册的 Touch 子类化 CCSprite 并覆盖 ccTouchBegan

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T11:25:13.857

我能理解的是，您正在尝试通过您的 CCMenuItemImage 进行手动控制。实际上所有的触摸都是在 CCMenu 中处理的，而不是在 MenuItem 中，所以你必须继承 CCMenu 而不是 CCMenuItemImage 来覆盖触摸。

在我的游戏中，我遇到了 CCTableView 和 CCMenuItem 的问题，其中 MenuItem 在采取手势时是优先考虑的。所以我通过继承 CCMenu 对其进行了调整。

它还包含一些额外的代码，但为了使所有内容都完好无损，我正在粘贴所有内容。

> **ScrollMenu.h 类**

```
class ScrollMenu:public CCMenu
{
public:
ScrollMenu();
virtual ~ScrollMenu(){};

bool isMovedGesture_;
bool istabBar_;
CCMenuItem * previousSelectedItem_;
static ScrollMenu* create(CCMenuItem* item,...);
virtual void registerWithTouchDispatcher();

virtual bool ccTouchBegan(CCTouch* touch, CCEvent* event);
virtual void ccTouchMoved(CCTouch* touch, CCEvent* event);
virtual void ccTouchEnded(CCTouch *touch, CCEvent* event);
CREATE_FUNC(ScrollMenu);
};

class ScrollMenuLoader : public cocos2d::extension::CCNodeLoader
{
public:
    CCB_STATIC_NEW_AUTORELEASE_OBJECT_METHOD(ScrollMenuLoader, loader);

protected:
    CCB_VIRTUAL_NEW_AUTORELEASE_CREATECCNODE_METHOD(ScrollMenu);
}; 
```

> **ScrollMenu.cpp 类**

```
#include "ScrollMenu.h"

ScrollMenu* ScrollMenu::create(CCMenuItem* item, ...)
{
    va_list args;
    va_start(args, item);
    ScrollMenu *pRet = new ScrollMenu();
    if (pRet && pRet->initWithItems(item,args))
    {
        pRet->autorelease();
        va_end(args);
        return pRet;
    }
    va_end(args);
    CC_SAFE_DELETE(pRet);
    return NULL;
}
ScrollMenu::ScrollMenu()
{
    isMovedGesture_ = false;
}

void ScrollMenu::registerWithTouchDispatcher()
{
    CCDirector* pDirector = CCDirector::sharedDirector();
    pDirector->getTouchDispatcher()->addTargetedDelegate(this, 0, false);
}

bool ScrollMenu::ccTouchBegan(CCTouch* touch, CCEvent* event)
{
    return CCMenu::ccTouchBegan(touch, event);
}

void ScrollMenu::ccTouchMoved(CCTouch* touch, CCEvent* event)
{
    CC_UNUSED_PARAM(event);
    CCAssert(m_eState == kCCMenuStateTrackingTouch, "[Menu ccTouchMoved] -- invalid state");
    isMovedGesture_ = true;
}

void ScrollMenu::ccTouchEnded(CCTouch *touch, CCEvent* event)
{
    CC_UNUSED_PARAM(touch);
    CC_UNUSED_PARAM(event);
    CCAssert(m_eState == kCCMenuStateTrackingTouch, "[Menu ccTouchEnded] -- invalid state");

    CCMenuItem * currentItem = this->itemForTouch(touch);
    if(!currentItem && isMovedGesture_ && m_pSelectedItem)
    {

        if(!istabBar_ || (previousSelectedItem_ && previousSelectedItem_ != m_pSelectedItem))
        {
            m_pSelectedItem->unselected();
        }
    }
    else if(currentItem)
    {
        if(currentItem == m_pSelectedItem)
        {
            if(!isMovedGesture_)
            {
                m_pSelectedItem->activate();
                previousSelectedItem_ = m_pSelectedItem;
            }
            else{
                if(previousSelectedItem_ != m_pSelectedItem)
                {
                    m_pSelectedItem->unselected();
                }
            }

        }
        else
        {
            if(isMovedGesture_)
            {
                m_pSelectedItem->unselected();
                m_pSelectedItem = currentItem;
                m_pSelectedItem->activate();
                previousSelectedItem_ = m_pSelectedItem;
            }

        }
        if (!istabBar_) {
            currentItem->unselected();
        }
    }

    m_eState = kCCMenuStateWaiting;
    isMovedGesture_ = false;

} 
```

# c++ - 读取 Wav 标头 - 未设置数据大小

> ID：13943499
> 
> 赞同：0
> 
> 时间：2012-12-18T23:59:59.920
> 
> 标签：c++, audio, wav

我正在尝试读取 .wav 文件的标头信息。

如果我有一个低采样率（22050）的 .wav 文件，它将完美地读取所有信息，但是，如果我有更高的采样率（8000），则它无法读取一些信息：

“dataSize”在使用 22050 .wav 文件时设置，但是，当使用 8000 .wav 文件时，它不会被设置，只是显示一些随机数。例如，当实际大小约为 4k-4.5k 时，“1672494080”。

对我哪里出错有什么建议吗？

编辑：

```
#include <iostream>
#include <fstream>
#include <vector>
#include <inttypes.h>
#include <stdint.h>
#include <math.h>

using namespace std;
struct riff_hdr
{
   char id[4];
   uint32_t size;
   char type[4];
};

struct chunk_hdr
{
   char id[4];
   uint32_t size;
};

struct wavefmt
{
   uint16_t format_tag;
   uint16_t channels;
   uint32_t sample_rate;
   uint32_t avg_bytes_sec;
   uint16_t block_align;
   uint16_t bits_per_sample;
   uint16_t extra_size;
};

riff_hdr riff;
chunk_hdr chunk;
wavefmt fmt = {0};
uint32_t padded_size;
vector<uint8_t> chunk_data;

bool readHeader(ifstream &file) {

file.read(reinterpret_cast<char*>(&riff), sizeof(riff));
if (memcmp(riff.id, "RIFF", 4) == 0)
{
    cout << "size=" << riff.size << endl;
    cout << "id=" << string(riff.type, 4) << endl;

    if (memcmp(riff.type, "WAVE", 4) == 0)
    {
        // chunks can be in any order!
        // there is no guarantee that "fmt" is the first chunk.
        // there is no guarantee that "fmt" is immediately followed by "data".
        // There can be other chunks present!

        do {

            file.read(reinterpret_cast<char*>(&chunk), sizeof(chunk));
            padded_size = ((chunk.size + 2 - 1) & ~1);

             cout << "id=" << string(chunk.id, 4) << endl;
             cout << "size=" << chunk.size << endl;
             cout << "padded size=" << padded_size << endl;

             if (memcmp(chunk.id, "fmt\0", 4) == 0) 
             {
                 if (chunk.size < sizeof(wavefmt))
                 {
                     // error!
                     file.ignore(padded_size);
                 }else{

                    // THIS block doesn't seem to be executing
                    chunk_data.resize(padded_size);
                    file.read(reinterpret_cast<char*>(&chunk_data[0]), padded_size);

                    fmt = *(reinterpret_cast<wavefmt*>(&chunk_data[0]));

                    cout << "format_tag=" << fmt.format_tag << endl;
                    cout << "channels=" << fmt.channels << endl;
                    cout << "sample_rate=" << fmt.sample_rate << endl;
                    cout << "avg_bytes_sec=" << fmt.avg_bytes_sec << endl;
                    cout << "block_align=" << fmt.block_align << endl;
                    cout << "bits_per_sample=" << fmt.bits_per_sample << endl;
                    cout << "extra_size=" << fmt.extra_size << endl;
                }

                if(fmt.format_tag != 1)
                {
                    uint8_t *extra_data = &chunk_data[sizeof(wavefmt)];
                }
             }else if(memcmp(chunk.id, "data", 4) == 0) {
                file.ignore(padded_size);
            }else{
                file.ignore(padded_size);
            }
        }while ((!file) && (!file.eof()));
    }
}

    return true;
}

int main()
{
ifstream file("example2.wav");

readHeader(file);
return 0;
} 
```

输出：

大小=41398

id=WAVE

id=fmt

尺寸=18

填充尺寸=18

块数据大小=0

我哪里错了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:19:42.370

您的代码有两个问题：

1.  `bitsPerSample`在您未读取的值之后有一个 2 字节整数。它指定该块中任何额外数据的大小。如果 的值`format2`仅表示 PCM 格式，您可以忽略整数的值（无论如何它通常为 0，但也可能是垃圾），但您仍然需要考虑它的存在。对于非 PCM 格式，整数不能忽略，您必须读取该值，然后读取它表示的字节数。您需要确保在进入`while`循环之前读取整个块，否则您将无法在文件中的正确起始位置读取更多块。

2.  您没有考虑到块被填充到最近的 WORD 边界，但块大小不包括任何填充。调用`seekg()`时，需要将值向上舍入到下一个 WORD 边界。

**更新**：根据您发布的新代码，它应该看起来更像这样：

```
#include <iostream>
#include <fstream>
#include <vector>
#include <inttypes.h>
#include <stdint.h>
#include <math.h>

using namespace std;

// if your compiler does not have pshpack1.h and poppack.h, then
// use #pragma pack instead. It is important that these structures
// be byte-alignd!

#include <pshpack1.h>

struct s_riff_hdr
{
   char id[4];
   uint32_t size;
   char type[4];
};

struct s_chunk_hdr
{
   char id[4];
   uint32_t size;
};

struct s_wavefmt
{
   uint16_t format_tag;
   uint16_t channels;
   uint32_t sample_rate;
   uint32_t avg_bytes_sec;
   uint16_t block_align;
};

struct s_wavefmtex
{
   s_wavefmt fmt;
   uint16_t bits_per_sample;
   uint16_t extra_size;
};

struct s_pcmwavefmt
{
   s_wavefmt fmt;
   uint16_t bits_per_sample;
};

#include <poppack.h>

bool readWave(ifstream &file)
{
    s_riff_hdr riff_hdr;
    s_chunk_hdr chunk_hdr;
    uint32_t padded_size;
    vector<uint8_t> fmt_data;
    s_wavefmt *fmt = NULL;

    file.read(reinterpret_cast<char*>(&riff_hdr), sizeof(riff_hdr));
    if (!file) return false;

    if (memcmp(riff_hdr.id, "RIFF", 4) != 0) return false;

    cout << "size=" << riff_hdr.size << endl;
    cout << "type=" << string(riff_hdr.type, 4) << endl;

    if (memcmp(riff_hdr.type, "WAVE", 4) != 0) return false;

    // chunks can be in any order!
    // there is no guarantee that "fmt" is the first chunk.
    // there is no guarantee that "fmt" is immediately followed by "data".
    // There can be other chunks present!

    do
    {
        file.read(reinterpret_cast<char*>(&chunk_hdr), sizeof(chunk_hdr));
        if (!file) return false;

        padded_size = ((chunk_hdr.size + 1) & ~1);

        cout << "id=" << string(chunk_hdr.id, 4) << endl;
        cout << "size=" << chunk_hdr.size << endl;
        cout << "padded size=" << padded_size << endl;

        if (memcmp(chunk_hdr.id, "fmt ", 4) == 0) 
        {
            if (chunk_hdr.size < sizeof(s_wavefmt)) return false;

            fmt_data.resize(padded_size);

            file.read(reinterpret_cast<char*>(&fmt_data[0]), padded_size);
            if (!file) return false;

            fmt = reinterpret_cast<s_wavefmt*>(&fmt_data[0]);

            cout << "format_tag=" << fmt->format_tag << endl;
            cout << "channels=" << fmt->channels << endl;
            cout << "sample_rate=" << fmt->sample_rate << endl;
            cout << "avg_bytes_sec=" << fmt->avg_bytes_sec << endl;
            cout << "block_align=" << fmt->block_align << endl;

            if (fmt->format_tag == 1) // PCM
            {
                if (chunk_hdr.size < sizeof(s_pcmwavefmt)) return false;

                s_pcmwavefmt *pcm_fmt = reinterpret_cast<s_pcmwavefmt*>(fmt);

                cout << "bits_per_sample=" << pcm_fmt->bits_per_sample << endl;
            }
            else
            {
                if (chunk_hdr.size < sizeof(s_wavefmtex)) return false;

                s_wavefmtex *fmt_ex = reinterpret_cast<s_wavefmtex*>(fmt);

                cout << "bits_per_sample=" << fmt_ex->bits_per_sample << endl;
                cout << "extra_size=" << fmt_ex->extra_size << endl;

                if (fmt_ex->extra_size != 0)
                {
                    if (chunk_hdr.size < (sizeof(s_wavefmtex) + fmt_ex->extra_size)) return false;

                    uint8_t *extra_data = reinterpret_cast<uint8_t*>(fmt_ex + 1);
                    // use extra_data, up to extra_size bytes, as needed...
                }
            }
        }
        else if (memcmp(chunk_hdr.id, "data", 4) == 0)
        {
            // process chunk data, according to fmt, as needed...

            file.ignore(padded_size);
            if (!file) return false;
        }
        else
        {
            // process other chunks as needed...

            file.ignore(padded_size);
            if (!file) return false;
        }
    }
    while (!file.eof());

    return true;
}

int main()
{
    ifstream file("example2.wav");
    readWave(file);
    return 0;
} 
```

# vba - 根据单元格值复制和粘贴循环

> ID：13943501
> 
> 赞同：0
> 
> 时间：2012-12-19T00:00:01.850
> 
> 标签：vba, loops, excel

感谢另一个有效的帮助，在下面创建了一个宏。

基本上，它采用 A 列中单元格的值，如果不存在具有该单元格名称的工作表，则创建它。然后它将具有相应单元格值的所有数据行粘贴到该工作表。IE。如果一个单元格包含以下内容：

```
column a  column b
dc00025   data value 
```

如果 dc00025 不存在，它将生成工作表。并将所有带有 dc00025 的行粘贴到 A 中。

这完美地工作。但是，我注意到，当您在创建工作表后运行此宏时，由于某种原因，它添加了数千列，大大降低了 excel 的速度。

要解决此问题，是否可以修改脚本以仅复制列 b:o 而不是整行？从 A3 开始粘贴它们会更好，但我不知道如何解决这个问题。

提前致谢。

```
 Sub CopyCodes()

    Application.ScreenUpdating = False
    Dim rCell As Range
    Dim lastrow As Long
    lastrow = Sheets("Data").UsedRange.Rows.Count
    For Each rCell In Worksheets("Data").Range("A2:A" & lastrow).SpecialCells(xlCellTypeConstants)
        If Not SheetExists(rCell.Value) Then
            With Worksheets.Add(, Worksheets(Worksheets.Count))
            .Name = rCell.Value
            End With
        End If

        Worksheets("Data").Rows(1).EntireRow.Copy Worksheets(rCell.Value).Rows(1)
        Worksheets(rCell.Value).Range("A" & Rows.Count).End(xlUp)(2).EntireRow.Value = _
        rCell.EntireRow.Value

    Next rCell
    Application.ScreenUpdating = True

End Sub
Function SheetExists(wsName As String)
    On Error Resume Next
    SheetExists = Worksheets(wsName).Name = wsName
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T01:04:12.453

建议修复：

```
Sub CopyCodes()

    Application.ScreenUpdating = False
    Dim rCell As Range
    Dim lastrow As Long
    Dim shtData as worksheet, shtDest as worksheet
    Dim sheetName as string

    set shtData=worksheets("Data")

    lastrow = shtData.cells(rows.count,1).end(xlup).row        
    For Each rCell In shtData.Range("A2:A" & lastrow).SpecialCells(xlCellTypeConstants)

        sheetName = rCell.Value
        If Not SheetExists(sheetName) Then
            set shtDest = Worksheets.Add(, Worksheets(Worksheets.Count))
            shtDest.Name = sheetName
            shtData.Rows(1).EntireRow.Copy shtDest.Rows(1)
        Else
            set shtDest = Worksheets(sheetName)              
        End If

        shtDest.Range("A" & Rows.Count).End(xlUp).offset(1,0).EntireRow.Value = _
                                                            rCell.EntireRow.Value

    Next rCell
    Application.ScreenUpdating = True

End Sub 
```

# r - sqldf 从其他表中选择值

> ID：13943502
> 
> 赞同：1
> 
> 时间：2012-12-19T00:00:11.663
> 
> 标签：r, sqldf

亲爱的stackoverflow专家，

我有两张桌子

```
table1<-read.table("table1.txt",header=TRUE)
table2<-read.table("table2.txt",header=TRUE) 
```

我想从表 1 中选择与表 2 第一列的值匹配的所有值。我尝试了 sqldf，但我不确定语法，

```
selection<-sqldf("SELECT *, column1 from table1 WHERE column1 like column2 from table2") 
```

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:37:56.217

左连接是您所追求的。

```
 selection <- sqldf('select * from table1 LEFT JOIN table2 ON table1.column1 = table2.column1') 
```

或者你可以使用`merge`

```
merged <- merge(table1, table2, by = 'column1') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T00:35:58.037

*这是从没有*sqldf`table1`的第一列的匹配值中选择所有值的解决方案：`table2`

 *```
table1[table1 %in% table2[,1]] 
```

我不确定这是否是您的意思，但这就是您的问题对我的暗示。如果要从中选择与 的*相应行*的`table1`值匹配的值，请使用*`table2`*

 *```
table1[table1 == table2[,1]] 
```

如果您只想考虑来自 的单列`table1`，请使用类似

```
table1[table1[,1] %in% table2[,1], 1] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T00:21:16.247

您可以尝试以下方法：

```
 table1[sapply(table1, function(x) x %in% table2[, 1, drop=FALSE])] 
```

* * *

这里发生的是该`sapply`语句返回一个逻辑列表，指示 的哪些元素`table1`在`table2`的第一列中。然后我们使用该逻辑向量来索引`table1`

```
 # to see this more clearly, try the following line, 
  # which is what is being used to index table1
  sapply(table1, function(x) x %in% table2[, 1, drop=FALSE]) 
```**

# ruby - 在原生 Ruby 类中使 用 Iron Ruby 类

> ID：13943506
> 
> 赞同：1
> 
> 时间：2012-12-19T00:00:47.267
> 
> 标签：ruby, interop, ironruby

我想知道 Iron Ruby 类/对象是否可以在本机 ruby​​ 解释器（irb）驱动的类中使用（使用 gem 之类的东西）？主要问题是我有一个 ruby​​ 类正在使用一些与 Iron Ruby 不兼容的 gem（例如：nokogiri），而 Iron Ruby 类正在使用 .Net 库。所以简而言之，我想知道是否有任何方法可以与原生 ruby​​ 中的铁 ruby​​ 类进行通信。如果有任何替代方案可以解决此问题，请务必提及。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:46:12.670

除了为每个运行某种通信的 ruby​​ 解释器设置两个不同的进程之外，别无他法。您可以为此使用[分布式红宝石](http://segment7.net/projects/ruby/drb/introduction.html)。无论如何，最好的办法是不要使用 .Net 库，而是用 ruby​​ 世界中的其他东西替换它们。

# axapta - 安全性：如何确定通过 Active Directory 组创建的用户的角色

> ID：13943507
> 
> 赞同：1
> 
> 时间：2012-12-19T00:00:58.267
> 
> 标签：axapta, dynamics-ax-2012

我目前正在使用**AD 组**来管理角色和对 Dynamics AX 2012 的访问。例如，我有一个名为**GG_AX_SalesRepresentative**的 AD 组，它用于允许组中的每个人登录到 Dynamics AX 并在 Ax 中接收相应的角色.

所以这是有效的，登录到 Dynamics Ax 并且是该组成员的用户将在 Dynamics AX 中自动创建，并收到类似于 userId 的 $CA2D。他们没有角色分配，因为 AX 知道他们来自 AD 组，并且角色是在组本身上定义的。因此，通过组管理用户是可以正常工作的。

但现在我需要向第三方提供自定义服务，该服务返回所有为给定用户分配角色的法人实体。Fe：我想将 UserId 传递给服务，它必须检查该用户是否是服务台用户，如果是 zo，请检查哪些法律实体......

**用户数据**可以在**UserInfo 表**中找到。 **用户角色分配**可以在**SecurityUserRole 表**中找到。

看来我会有我需要的数据，除了用户角色分配是在组上完成的！如何在 Dynamics 中找到此用户链接到哪些组？？？

所以我想知道：我有用户 $CA2D，他是帮助台角色的成员，因为他是该组的成员，因此他的角色与该 AD 组相关联。

欢迎任何想法:-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-21T00:12:12.353

我们已经解决了这个问题，并编写了一些逻辑来查询 AD 以查看用户是否在 AD 上的组中，然后我们在 AX 中查找具有相同网络别名的组。这样我们就可以获取附加到该角色的角色。

# linux - 使用 Buildroot 编译 alsa-lib：C 预处理器未通过完整性检查

> ID：13943509
> 
> 赞同：2
> 
> 时间：2012-12-19T00:01:24.163
> 
> 标签：linux, buildroot

尝试使用 Buildroot 为 LPC3250 ARM 编译 Linux 映像。库存设置，它编译得很好。当我尝试添加 alsa-lib 和 alsa-utils 时出现此错误：

```
configure: error: in `/home/user/projects/buildroot/output/build/alsa-lib-1.0.26                                                                ':
configure: error: C preprocessor "/home/user/projects/buildroot/output/host/usr/                                                                bin/arm-buildroot-linux-uclibcgnueabi-cpp" fails sanity check
See `config.log' for more details 
```

alsa-lib 的 config.log 的摘录。这有点糟糕，因为一半的错误消息由于某种原因被切断了：

```
 /home/user/projects/buildroot/output/host/usr/arm-buildroot-linux-uclibcgnueabi/sysroot/usr/include/features.h:219:5: error: #error It appears you have defined _FILE_OF$
In file included from /home/user/projects/buildroot/output/host/usr/arm-buildroot-linux-uclibcgnueabi/sysroot/usr/include/stdio.h:72,
                 from conftest.c:12:
/home/user/projects/buildroot/output/host/usr/arm-buildroot-linux-uclibcgnueabi/sysroot/usr/include/bits/uClibc_stdio.h:61:2: error: #error Sorry... uClibc was built wi$
In file included from conftest.c:12:
/home/user/projects/buildroot/output/host/usr/arm-buildroot-linux-uclibcgnueabi/sysroot/usr/include/stdio.h:83: error: expected '=', ',', ';', 'asm' or '__attribute__' $
In file included from conftest.c:12:
/home/user/projects/buildroot/output/host/usr/arm-buildroot-linux-uclibcgnueabi/sysroot/usr/include/stdio.h:721: error: expected declaration specifiers or '...' before $
/home/user/projects/buildroot/output/host/usr/arm-buildroot-linux-uclibcgnueabi/sysroot/usr/include/stdio.h:723: error: expected ';', ',' or ')' before '*' token 
```

类似的问题[在这里](https://stackoverflow.com/questions/8478462/ios-compiling-armv7-i386-of-several-libs-configure-script-c-preprocessor-fa)说明了一些关于“取消设置”CPP 和 CPPFlags 的信息。不确定我会在哪里执行此操作或在 Buildroot 环境中检查它。我不确定这是否是同一个问题。我猜它不相关，因为在另一个问题中它正在谈论编译 GCC，而我没有这样做。

我现在的 #1 预感是我必须编辑 lib-alsa 的配置文件。我只是不确定要进行哪些编辑。

编辑：做了一些积极的谷歌搜索，并想出了我*认为*是我的一个错误的完整版本：`...features.h:329:2: #error It appears you have defined _FILE_OFFSET_BITS=64\. Unfortunately, uClibc was built without large file support enabled.` 检查了我的 uClibc 配置文件并且`UCLIBC_HAS_LFS=y`存在。？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-09T08:08:10.163

嗯，`output/toolchain/uClibc-0.9.33.2/.config`是从`toolchain/uClibc/uClibc-0.9.33.config`Buildroot 配置和构建 uClibc 时生成的。`output/toolchain/uClibc-0.9.33.2/.config`因此，用作 uClibc 配置没有任何意义。您应该保留默认值`toolchain/uClibc/uClibc-0.9.33.config`。

关于大文件支持，通常所有的包都对它有适当的依赖。因此，如果一个包需要大文件支持，则必须在 Buildroot 中启用大文件支持后才能选择该包。如果不是这种情况，那么这是一个错误，Buildroot 社区会对此有兴趣的错误报告（其中详细说明了 Buildroot 版本、正在使用的 Buildroot 配置文件以及您得到的构建错误） .

现在，如果确实需要大文件支持，您应该在 Buildroot 级别而不是在 uClibc 级别启用它。如果您仅在 uClibc 级别启用它，那么 Buildroot 现在不会涉及此问题，并且不会向您显示所有依赖于大文件支持的包。

因此，您应该做的是`BR2_TOOLCHAIN_BUILDROOT_LARGEFILE`在 Buildroot 中启用配置选项，然后进行完整的重建：`make clean all`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T06:07:25.573

这里问题的根源是 Buildroot 使用位于以下位置的 uClibc 配置文件：`output/toolchain/uClibc-0.9.33.2/.config`

而不是`toolchain/uClibc/uClibc-0.9.33.config`Buildroot 配置菜单中指定的。

我跑了`make uclibc-menuconfig`（默认将配置保存在 .config 中）并选择`General Library Settings->Large File Support`，一切都编译得很好。

# jquery - 从 jquery easyui 组合框中删除数据

> ID：13943511
> 
> 赞同：4
> 
> 时间：2012-12-19T00:01:48.900
> 
> 标签：jquery, jquery-easyui

我正在使用[jQuery EasyUI 组合框](http://www.jeasyui.com/documentation/combobox.php)来呈现数据列表。有什么方法可以使用 jQuery EasyUI 函数或其他东西从我的 jQuery EasyUI 组合框列表中删除特定行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:27:23.560

您好，我在 EasyUI Combobox 中没有找到特殊功能，但您可以使用[JQuery 选择器](http://api.jquery.com/category/selectors/)

这是删除所选项目的方法：

```
$('.combobox-item-selected').remove(); // Remove selected item
$('.combo-text').val(''); // clear a textfield 
```

这是使用选择器按唯一值删除任何项目的方法：

```
$('div[value="ND"]').remove(); // Where ND is unique value 
```

我在EasyUI Combobox的[这个](http://www.jeasyui.com/demo/main/index.php?plugin=ComboBox&theme=bootstrap&dir=ltr&pitem=Basic)演示中尝试了这段代码

问候

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-22T04:57:02.677

我没有找到特殊功能，但可以使用'getData'和'loadData'来做到这一点。

```
var items = $("#id").combobox('getData');
var newItems = [];
//push the select option if value is not equals '1'
$.each(items, function (index, item) {
    if (item.value != '1') {
        newItems.push(item);
    }
});
$("#id").combobox('loadData', newItems); 
```

通常，您可以更改所选选项。我使用下面的代码选择第一个。

```
var opts = $("#id").combobox('options');
$("#id").combobox('setValue', newItems[0][opts.valueField]); 
```

# sql - 将表从外部数据库复制到内部

> ID：13943513
> 
> 赞同：2
> 
> 时间：2012-12-19T00:01:54.253
> 
> 标签：sql, oracle

出于性能原因，我需要将表从外部数据库复制到内部数据库。几个应用程序将使用这个本地数据库来进行连接和比较数据。我只需要每小时左右复制一次，但如果有性能解决方案，我宁愿每 5 到 10 分钟复制一次。

最好的复制方式是什么？首先想到的是 DROP 然后 CREATE：

```
DROP TABLE clonedTable;
CREATE TABLE clonedTable AS SELECT * from foo.extern@data.sourceTable; 
```

应该有更好的方法吧？希望有一个原子解决方案来避免表不存在但有人可能会尝试查询它的那几分之一秒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:14:51.000

最简单的可能解决方案是设置为每小时刷新一次的物化视图。

```
CREATE MATERIALIZED VIEW mv_cloned_table
  REFRESH COMPLETE 
  START WITH sysdate + interval '1' minute
  NEXT sysdate + interval '1' hour
AS
SELECT *
  FROM foo.external_table@database_link; 
```

这将删除当前中的`mv_cloned_table`所有数据，将表中的所有数据插入外部数据库中，然后安排自己在完成后一小时再次运行（因此实际上将是 1 小时 + 无论两次刷新之间需要多长时间）。

有很多方法可以优化这一点。

*   如果拥有源数据库的人愿意接受它，您可以要求他们在源表上创建物化视图日志。这将允许您的物化视图仅复制应该更有效的更改，并允许您更频繁地安排刷新。
*   如果您与拥有源数据库的人合作，您还可以使用 Streams 而不是物化视图，这可以让您近乎实时地复制更改（通常会延迟几秒钟）。这在源系统上也往往比维护物化视图日志更有效。但是要让一切正常工作往往需要更多的管理时间——物化视图的灵活性和效率要低得多，但配置起来很容易。
*   如果您不介意在刷新期间表为空（它会存在，只是没有数据），您可以对物化视图进行非原子刷新，这将执行`TRUNCATE`直接路径`INSERT`而不是a`DELETE`和常规路径`INSERT`。前者效率更高，但意味着当您在本地服务器上进行连接和数据比较时，表会显示为空，这在这种情况下似乎不太合适。

如果您想沿着源端创建物化视图日志的路径进行下去，以便您可以在源端进行增量刷新，假设源表具有主键，您会要求他们

```
CREATE MATERIALIZED VIEW LOG ON foo.external_table
  WITH PRIMARY KEY
  INCLUDING NEW VALUES; 
```

您将创建的物化视图将是

```
CREATE MATERIALIZED VIEW mv_cloned_table
  REFRESH FAST
  START WITH sysdate + interval '1' minute
  NEXT sysdate + interval '1' hour
  WITH PRIMARY KEY
AS
SELECT *
  FROM foo.external_table@database_link; 
```

# underscore.js - gruntfiles 中这两种模板语法有什么区别？

> ID：13943515
> 
> 赞同：1
> 
> 时间：2012-12-19T00:02:25.567
> 
> 标签：underscore.js, gruntjs

```
<config:path.src> 
```

相对

```
<%= path.src %> 
```

在我见过的一些示例中，第一个示例用于在目标中定义 src/dest 的“长”方式，而第二个示例用于“短”方式。但这并不一致，因此它们似乎在 gruntfiles 中可以互换使用。有什么启示吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T01:37:39.100

第一种形式在 0.4 之前的 Grunt`<config:path.src>`中称为**指令**。他们允许根据相关的指令（`config:`, `json:`, `file_temaplte:`）执行不同的任务。

在 Grunt 0.4 中，这些已被删除以供更标准的格式使用：

*   `<config:prop.subprop>`→`<%= prop.subprop %>`
*   `<json:file.json>`→`grunt.file.readJSON('file.json')`
*   `<file_template:file.js>`→`grunt.template.process(grunt.file.read('file.js'))`

如您所见，在`config:`指令的情况下，这实际上等同于`<%= %>`下划线模板标签。

但是指令 where 也允许其他动作。

更多关于这里（在*配置*部分）：[https ://github.com/gruntjs/grunt/wiki/Upgrading-from-0.3-to-0.4](https://github.com/gruntjs/grunt/wiki/Upgrading-from-0.3-to-0.4)

# vbscript - 从 vbscript yes-no 框中删除倒计时

> ID：13943519
> 
> 赞同：2
> 
> 时间：2012-12-19T00:02:48.977
> 
> 标签：vbscript, msgbox

我有这个脚本，它将显示一个带有 30 秒倒计时的是-否框，如果用户在时间结束后没有选择选项，那么 VBScript 会自动选择选项**“是”**并返回到批处理脚本。

如何从脚本中删除倒计时部分，使其不会默认为**"Yes"**，而是等到输入给出。

非常感谢

```
Option Explicit
Dim oShell, retCode
Set oShell = WScript.CreateObject("WScript.Shell")

retCode = oShell.Popup("Place your question here?", 30, "Title", 4 + 32)

Select Case retCode
case 6, -1
    WScript.quit(0) 'Yes or time-out was chosen
case 7
    WScript.quit(1) 'No was chosen
End Select 
```

vbscript 取自[http://www.msfn.org/board/topic/138818-vbscript-msgbox-with-auto-select-countdown-and-batch-script-input/](http://www.msfn.org/board/topic/138818-vbscript-msgbox-with-auto-select-countdown-and-batch-script-input/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:08:15.753

这应该是答案，更多参考： [WScript.Shell.Popup](http://www.devguru.com/technologies/wsh/quickref/wshshell_popup.html)

```
Dim oShell, retCode
Set oShell = WScript.CreateObject("WScript.Shell")

retCode = oShell.Popup("Place your question here?", 0, "Title", 4 + 32)

Select Case retCode
case 6, -1
WScript.quit(0) 'Yes or time-out was chosen
case 7
WScript.quit(1) 'No was chosen
End Select` 
```

# twitter-bootstrap - Twitter Bootstrap Collapse (Accordion) 与 Knockout JSON 映射

> ID：13943521
> 
> 赞同：4
> 
> 时间：2012-12-19T00:03:09.547
> 
> 标签：twitter-bootstrap, knockout.js, knockout-mapping-plugin

我想使用 Knockout JSON Mapping 和 Twitter bootstrap 创建一个动态 Accordion 控件。

```
var ProductViewmodel;

function bindProductModel(Products) {
    var self = this;
    self.items = ko.mapping.fromJS([]);
    ProductViewmodel = ko.mapping.fromJS(Products.d, self.items);
    ko.applyBindings(ProductViewmodel);
}

var Data = {
    "d": [
        {
        "__type": "Warehouse.Tracntrace.Members_Only.DLL.StockMovement.AvailibleStock",
        "WarehouseID": 1,
        "ProductSKUID": 2,
        "ProductSKUName": "Decoder 1131",
        "WarehouseName": "SoftwareDevelopmentTest",
        "Status": "Staging",
        "QtyUnassigned": 5},
    {
        "__type": "Warehouse.Tracntrace.Members_Only.DLL.StockMovement.AvailibleStock",
        "WarehouseID": 1,
        "ProductSKUID": 3,
        "ProductSKUName": "Decoder 1132",
        "WarehouseName": "SoftwareDevelopmentTest",
        "Status": "Staging",
        "QtyUnassigned": 15}
    ]
};

    function BuildLinkFromJSON() {
        bindProductModel(Data);
        var link;
        link = '<a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" data-bind="text: d.ProductSKUName" href="#collapse"></a>';
        return link;
    }

function BuildAccordian(Pane) {
        var link = BuildLinkFromJSON();
        var eventsContainer = document.getElementById('accordion');
        var events = eventsContainer.innerHTML;
        events = events + '<div class="accordion-group"><div class="accordion-heading">'+link+'</div><div id="collapseOne" class="accordion-body collapse in"><div class="accordion-inner">My Content Here</div></div>';
        eventsContainer.innerHTML = events;
    }

    $(document).ready(function () {
        BuildAccordian();
    }); 
```

HTML：

```
<div class="accordion" id="accordion">
</div> 
```

我基本上需要我的 JSON 数据中的每个产品，如果可能的话，标题应该在标题中显示 ProductSKUName 和 QtyUnnasigned。我用发布的 JSON 数据和名为 Build Accordion 的手风琴 HTML 函数创建了这个[Fiddle 。](http://jsfiddle.net/Fumunchu/4eb2E/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T00:23:08.247

这个怎么样？[http://jsfiddle.net/billaraw/xZHbh/4/](http://jsfiddle.net/billaraw/xZHbh/4/)

我基本上添加了循环，因此它可以获取每个项目：

```
<div class="accordion" id="accordion2">

<!-- ko foreach: $data -->
<h3>
    <span data-bind="text: ProductSKUName"></span> :
    <span data-bind="text: QtyUnassigned"></span>                
</h3 >
<div>
    MyContent
</div>
<!-- /ko -->

</div >​ 
```

# android - 可选择在 Android 上使用新 API

> ID：13943524
> 
> 赞同：4
> 
> 时间：2012-12-19T00:03:42.007
> 
> 标签：android, compatibility

我很确定以前有人问过这个问题，但是我在任何地方都找不到，所以请不要咬。

我正在编写一个 android 应用程序，它需要与附近的设备通信，如果有两个设备碰巧在附近，我想使用 WifiDirect API。

但如果不是这种情况，应用程序仍然可以工作，它将使用其他不太有效的方式在参与设备之间进行通信（如 Wifi 接入点共享）。

我还希望这个应用程序能够在像 a​​ndroid 2.2 这样根本没有 WifiDirect API 的旧设备上运行（我认为 >=4.0）。

那么有没有办法让我的应用程序有选择地使用新的 API，但不一定适用于旧手机？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T00:17:14.917

> 所以请不要咬人

我们至少可以啃一点吗？只是一点点？

:-)

> 那么有没有办法让我的应用程序有选择地使用新的 API，但不一定适用于旧手机？

您可以在 Java 版本保护块中包装对新类/方法的引用：

```
if (Build.VERSION.SDK_INT>=Build.VERSION_CODES.ICE_CREAM_SANDWICH) {
  // do stuff with WifiP2pManager
}
// optional else block for workaround for older devices 
```

WiFiDirect 可能还有其他细节，我还没有使用过，但这是基本步骤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:19:45.837

您可以使用 来检查当前的 API 级别`Build.VERSION.SDK_INT`。在 if/case 语句中使用为不同的 API 选择不同的代码。此外，如果您的 minSdk 设置较少，您可能会收到有关专门为以后的 API 编写的代码的错误或警告。您可以通过注释这些后来的 API 类来解决这些问题`@TargetApi(APILEVEL)`

# javascript - 将内联样式存储到 jquery 变量中

> ID：13943526
> 
> 赞同：1
> 
> 时间：2012-12-19T00:03:57.573
> 
> 标签：javascript, jquery

我有以下 img 标签，

```
 <img id="image1" src="URL" alt="image1" name="image1" width="137" height="119" border="0" style="position: relative; left: -355px; top: 62px;" > 
```

我想以某种方式，点击，将以下项目存储到单独的变量中..

```
 style="position: relative; left: -355px; top: 62px;"

  var left = -355px
  var top = 62px 
```

那可能吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:07:58.240

```
var imageInfo = {style:null, left:null, top:null};

$('#image1').on('click', function() {
  var $this = $(this);
  imageInfo.style = $this.attr('style');
  imageInfo.left = $this.css('left');
  imageInfo.top = $this.css('top');
  console.log('Image Clicked: ', imageInfo);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:16:21.627

当然这是可能的，你有没有尝试过这样的事情：

```
$('#image1').on('click', function () {
    var style = 'style="' + $(this).attr('style') + '"';
    var left = $(this).css('left');
    var top = $(this).css('top');

    alert(style);
    alert(left);
    alert(top);
}); 
```

示例：http: [//jsfiddle.net/9ZXHX/](http://jsfiddle.net/9ZXHX/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T00:16:31.330

您可以使用 jquery 获取图像，然后从那里访问其属性。

```
var img = $("#image1");
var imgStyle = img[0].getAttribute("style");
var imgLeft = img.css("left");
var imgRight = img.css("right"); 
```

链接到 jquery 的 css api： http: [//api.jquery.com/css/](http://api.jquery.com/css/)

在一个函数中：

```
function getDetails(imgId)
{
 var imgDetails = {};
 var img = $("#"+imgId);
 imgDetails.imgStyle = img[0].getAttribute("style");
 imgDetails.imgLeft = img.css("left");
 imgDetails.imgRight = img.css("right");
 return imgDetails;
} 
```

这是一个显示此工作示例的小提琴，以及问题中请求的输出：http: [//jsfiddle.net/j7eYf/1/](http://jsfiddle.net/j7eYf/1/)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-19T00:13:48.053

我建议您使用 jquery，它会使工作变得容易得多。试试这个例子，

```
$("#your trigger").live('click',function ()
{
$("#image1").css({
position: "absolute",
top: 62 + "px",
left: -355 + "px"
});
}); 
```

# sql - 通过 SQL 中的两列将一个表链接到另一个表

> ID：13943532
> 
> 赞同：3
> 
> 时间：2012-12-19T00:04:35.997
> 
> 标签：sql, join

所以我有两张桌子。首先是名称及其资格：

用户：

```
Name    Qualification
---------------------
User1   QualA  
User1   QualB  
User1   QualC  
User2   QualA  
User2   QualD 
```

然后是第二个表，它将两个资格从第一个链接到另一个属性：

属性：

```
Attribute   Qual1  Qual2
------------------------
Attr1       QualA  QualC    
Attr2       QualB  QualC    
Attr3       QualA  QualD    
Attr4       QualB  QualD 
```

现在我想查询数据，所以我得到这样的回报：

```
User     Attribute
------------------
User1    Attr1   
User1    Attr2  
User2    Attr3 
```

因此，如果 Name 具有 Attribute 所需的两个资格，则可以将它们关联在一起。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T00:18:07.147

我会用这个：

```
select
  name, attribute
from
  users inner join attributes
  on users.qualification in (attributes.qual1, attributes.qual2)
group by attribute, name
having count(*)=2 
```

我正在尝试根据属性所需的任何资格，将每个用户的每个资格与属性表连接起来。然后我按属性和名称分组并计算行数。

如果用户名和属性的组合有 2 行，则表示用户对该属性有两个资格，我们必须显示它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T15:02:24.243

我必须生成一个非常相似的查询，但是在我的场景中，个人或用户可能会多次获得相同的资格。因此，我不得不提出一些比[fthiella 的](https://stackoverflow.com/users/833073/fthiella)解决方案更复杂的东西。

我提出的查询如下：

```
SELECT 
    j2.name,
    Qualification1,
    Qualification2,
    t3.Attribute
FROM
    (SELECT 
        t1.name,
        t1.qualification AS Qualification1,
        J1.qualification AS Qualification2,
        Rank() over (Partition BY t1.name, t1.qualification ORDER BY t1.qualification, J1.qualification) AS rank1,
        Rank() over (Partition BY t1.name, J1.qualification ORDER BY J1.qualification, t1.qualification) AS rank2
    FROM 
        Users t1
    LEFT JOIN
        (SELECT 
            t2.name,
            t2.qualification
        FROM 
            Users t2) J1
    ON 
        t1.name = J1.name) J2
LEFT JOIN 
    Attributes t3
ON 
    t3.Qual1 = Qualification1 
    AND t3.Qual2 = Qualification2
WHERE 
    rank2 <= rank1 
    AND t3.Attribute IS NOT NULL 
```

基本上我自己加入表格`Users`，列出每个用户的所有资格组合，没有重复。然后，这允许我们对`Attributes`表进行简单的连接。

当然，如果您不使用 Sql server 2005 或更高版本，您将无法使用[Rank功能。](http://msdn.microsoft.com/en-us/library/ms176102.aspx)

# c# - 使用基于服务的数据库更新本地数据库

> ID：13943538
> 
> 赞同：0
> 
> 时间：2012-12-19T00:05:08.213
> 
> 标签：c#, database, windows-phone-7, windows-phone-7.1

我用它制作了类似的代码[，](http://blogs.msdn.com/b/wriju/archive/2011/08/01/windows-phone-7-using-local-database-for-application.aspx)但我在一个网站上也有数据库，我希望每次用户上网时，它都会以某种方式将我的基于服务的数据库的新数据传输到本地数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T06:20:14.427

使用[Windows Phone 的 BackgroundWorker](http://msdn.microsoft.com/en-us/library/windowsphone/develop/cc221403%28v=vs.105%29.aspx)从您的 Web 服务中获取数据并更新本地数据库。

您可以在 App Launched 事件中启动后台 Worker，异步调用它，这样应用启动就不会延迟。

# shell - 自记录：将标准输出记录到文件的 Busybox shell 脚本

> ID：13943541
> 
> 赞同：0
> 
> 时间：2012-12-19T00:05:22.690
> 
> 标签：shell, logging, fifo, busybox, buildroot

我的问题与 jbarlow 对以下问题的回答有关： [redirect COPY of stdout to log file from inside bash script itself](https://stackoverflow.com/questions/3173131/redirect-copy-of-stdout-to-log-file-from-within-bash-script-itself)

我使用了下面列出的建议脚本。我必须使用它，因为我无法访问完整的 bash（正如 jbarlow 指出的那样），因为我使用的是 buildroot 版本的busybox。

```
#!/bin/sh

if [ "$SELF_LOGGING" != "1" ]
then
    PIPE=tmp.fifo
    mkfifo $PIPE

    # Keep PID of this process
    SELF_LOGGING=1 sh $0 $* >$PIPE &
    PID=$!

    tee logfile <$PIPE &

    # Safe to rm pipe because the child processes have references to it
    rm $PIPE    
    wait $PID

    # Return same error code as original process
    exit $?
fi 
```

我发现的问题是，该脚本似乎会冻结某些内容。例如，使用上述代码的冻结脚本的 strace 如下所示：

```
Process 29750 attached - interrupt to quit
open("/tmp/tmp.fifo", O_RDONLY|O_LARGEFILE) = -1 ENOENT (No such file or directory)
write(2, "/usr/bin/runStuff", 24) = 24
write(2, ": ", 2)                       = 2
write(2, "line ", 5)                    = 5
write(2, "45", 2)                       = 2
write(2, ": ", 2)                       = 2
write(2, "can't open ", 11)             = 11
write(2, "/tmp/tmp.fifo", 21)   = 21
write(2, ": ", 2)                       = 2
write(2, "no such file", 12)            = 12
write(2, "\n", 1)                       = 1
stat64("/sbin/tee", 0xbff7c20c)         = -1 ENOENT (No such file or directory)
stat64("/usr/sbin/tee", 0xbff7c20c)     = -1 ENOENT (No such file or directory)
stat64("/bin/tee", 0xbff7c20c)          = -1 ENOENT (No such file or directory)
stat64("/usr/bin/tee", {st_mode=S_IFREG|0755, st_size=18956, ...}) = 0
_exit(1)                                = ?
Process 29750 detached 
```

看起来（对我来说，这方面的知识有限）是 tee 正在结束并且父脚本没有死。那是对的吗？如果是这样，不应该缺少可读文件导致脚本结束吗？tee 是背景的，因此显然无法控制父级。

作为背景，如果它死了，还有另一个进程会重复调用它。因此，使用相同的文件可能会导致锁定情况。或者 rm 可能在创建 fifo*之前发生？*

我已经考虑过使用带有超时的“读取”，但在某些情况下，一次几个小时都没有记录任何内容。

是否可以修改脚本以使其不会锁定并且如果/当fifo 的一端死亡时脚本将死亡*？*

# mule - 如何让 mule 使用带有 Groovy 的 Choice 转换器来评估数值表达式？

> ID：13943547
> 
> 赞同：0
> 
> 时间：2012-12-19T00:06:17.167
> 
> 标签：mule

我有一个 SQL 脚本从 IS_ZERO_VALUE 字段中提取数据。该值是数字，可以是“1”或“0”。我无法让 Mule 评估价值：

```
<when expression="payload.IS_ZERO_VALUE==0" evaluator="groovy"> 
```

无论值是 1 还是 0，Mule 似乎都将其评估为“false”。如果我将 SQL 脚本更改为输出“NO”（如果 0）和“YES”（如果 1 Mule 使用没有问题）...

```
<when expression="payload.IS_ZERO_VALUE=='NO'" evaluator="groovy"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T04:19:28.643

你确定这个值是数字吗？

如果是，那么不确定为什么会发生这种情况......但是在 3.3.0 中，您不需要 Groovy 来处理这种表达式，MEL 是您想要使用的。

尝试：

```
<when expression="#[message.payload.IS_ZERO_VALUE==0]" /> 
```

# ruby-on-rails - Rails & Backbone.js：传递自定义方法，获取“UnknownAttributeError”

> ID：13943549
> 
> 赞同：0
> 
> 时间：2012-12-19T00:06:34.000
> 
> 标签：ruby-on-rails, activerecord, backbone.js

我的任务模型中定义了一些自定义方法。我将它们发送到我的主干应用程序中，如下所示：

```
Planner.initialize({ tasks: #{raw @tasks.to_json(:methods => [:timeframe, :timeframe_title, :timeframe_months]) } }); 
```

但是，在我添加之后，ActiveRecord 认为它是数据库中的一个字段，我在控制台中收到以下错误：

```
Completed 500 Internal Server Error in 4ms

ActiveRecord::UnknownAttributeError (unknown attribute: timeframe):
  app/controllers/tasks_controller.rb:118:in `block in update'
  app/controllers/tasks_controller.rb:117:in `update' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T19:30:13.890

感谢 ThoughtBot 的 Chad Pytel，我发现我必须从我的 rails 模型中的 attr_accessible 行中删除这三种方法。

强烈推荐[Thoughtbot 的《Backbone.js on Rails》](https://learn.thoughtbot.com/products/1-backbone-js-on-rails)一书，它提供了对此类问题的聊天支持。

# java - 如何从 String 转换为原始类型或标准 java Wrapper 类型

> ID：13943550
> 
> 赞同：23
> 
> 时间：2012-12-19T00:06:37.253
> 
> 标签：java, string, object, reflection, type-conversion

我有一个`java.lang.reflect.InvocationHandler`并且我需要实现方法 invoke()

我`java.lang.String`从我的阐述中得到了一个类型值，我需要将此值转换为方法期望的适当 returnType（它可以是像 int、boolean、double 或像 Boolean、Integer、Double、Float 等的包装类这样的原始类型） .

例子：

```
public Object invoke(Object proxy, Method method, Object[] args) 
        throws Throwable {
    String computedValue = compute(...);
    return convert(method.getReturnType(), computedValue);
}

private Object convert(Class<?> returnType, String stringValue) {
    return ...; // what's the simplest way?
} 
```

我不希望简单地实现复杂对象之间的自动转换，但我希望有一种简单的方法可以将 String 转换为标准的 java 类型。

我已经（太）见过很多次这样的东西，但它似乎不适合我：

```
public static Object toObject( Class clazz, String value ) {
    if( Boolean.class.isAssignableFrom( clazz ) ) return Boolean.parseBoolean( value );
    if( Byte.class.isAssignableFrom( clazz ) ) return Byte.parseByte( value );
    if( Short.class.isAssignableFrom( clazz ) ) return Short.parseShort( value );
    if( Integer.class.isAssignableFrom( clazz ) ) return Integer.parseInteger( value );
    if( Long.class.isAssignableFrom( clazz ) ) return Long.parseLong( value );
    if( Float.class.isAssignableFrom( clazz ) ) return Float.parseFloat( value );
    if( Double.class.isAssignableFrom( clazz ) ) return Double.parseDouble( value );
    return value;
} 
```

到目前为止，以上还不是我看到的最糟糕的：)

有人在这里有什么秘密吗？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-12-19T00:15:34.677

据我所知，您提供的版本没有真正的替代品。您可以稍微简化一下（因为包装器类型都是 all `final`），但您基本上需要使用`if`or`switch`或散列来打开类。

我的建议是像上面那样编码。*丑陋的代码本身*只是一个问题，如果您必须查看它。所以把它放在一个实用方法中，不要再看它了。

* * *

FWIW - 这就是我简化方法的方式：

```
public static Object toObject( Class clazz, String value ) {
    if( Boolean.class == clazz ) return Boolean.parseBoolean( value );
    if( Byte.class == clazz ) return Byte.parseByte( value );
    if( Short.class == clazz ) return Short.parseShort( value );
    if( Integer.class == clazz ) return Integer.parseInt( value );
    if( Long.class == clazz ) return Long.parseLong( value );
    if( Float.class == clazz ) return Float.parseFloat( value );
    if( Double.class == clazz ) return Double.parseDouble( value );
    return value;
} 
```

这更简单，更有效。它与原始版本等效，因为类是全部`final`，并且因为规范声明对象的相等性`Class`是对象身份。

可以说，我们应该使用`<wrapper>.valueOf(String)`直接返回包装对象的方法。

我没有声称这不那么难看……但是“美”并不是衡量代码质量的有用指标，因为它是主观的，而且它并不能告诉您代码是否易于理解和/或维护。

**更新**

为了也支持原始类型，将相应的类添加到`if`条件中；例如

```
 if (Boolean.class == clazz || Boolean.TYPE == clazz) {
        return Boolean.parseBoolean(value);
    } 
```

现在可能已经到了在类型名称上进行 String 切换更有效的地步，尽管需要考虑一些稍微棘手的类型标识问题。（理论上，您可以拥有由不同类加载器加载的具有相同全名的多个类型。我认为您需要在类加载器中“快速而松散地”使用原始包装类来做到这一点......但是我认为这仍然是可能的。）

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-12-19T09:33:25.940

我想我找到了些东西

```
import java.beans.PropertyEditor;
import java.beans.PropertyEditorManager;

@Override
public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
    String returnValue = ...
    return convert(method.getReturnType(), returnValue); 
}

private Object convert(Class<?> targetType, String text) {
    PropertyEditor editor = PropertyEditorManager.findEditor(targetType);
    editor.setAsText(text);
    return editor.getValue();
} 
```

我认为这 3 行代码比多个 if 更好，并且我避免添加外部库依赖项，因为`java.beans`包位于 Java 标准库 (javadocs: [`PropertyEditorManager`](http://docs.oracle.com/javase/6/docs/api/java/beans/PropertyEditorManager.html)) 中。

我觉得这是可以接受的；我唯一的困惑是它`PropertyEditor`包含在`java.beans`包中，我更喜欢包中可用的东西`java.util`，`java.lang.reflect`因为这个代码实际上与它无关`java.beans`。

上面的代码还有一个优点是您可以注册额外的`PropertyEditor`实例来翻译复杂的对象，顺便说一句。不过，这并不是一件坏事。

我认为它比如果列表更好，在美丽方面，而且在质量方面。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-06-01T15:44:06.710

可能[org.apache.commons.beanutils.ConvertUtils](http://commons.apache.org/proper/commons-beanutils/javadocs/v1.9.3/apidocs/index.html)可以提供帮助？

```
import org.apache.commons.beanutils.ConvertUtils;
// ...
final Object v = ConvertUtils.convert("42", Integer.class); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-05-04T12:31:43.440

有一个轻量级库可以将字符串解析为你想要的 java 类型。[它被称为类型解析器，你](https://github.com/drapostolos/type-parser/wiki/User-Guide)可以在 github 上找到它。

您上面的代码可能看起来像这样：

```
public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
    TypeParser parser = TypeParser.newBuilder().build();
    String computedValue = compute(...);
    return parser.parseType(computedValue,  method.getGenericReturnType());
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-12-19T00:19:41.257

我提出这个：

```
List<Class<?>> clsList = new ArrayList<Class<?>>();
clsList.add(Boolean.class);
clsList.add(Integer.class);
//etc.

for (Class<?> cls : clsList) {
    if (cls.isAssignableFrom(clazz)) {
        return cls.getMethod("valueOf", new Class[] { String.class }).invoke(null, new Object[] { value });
        //Missing in this example: Handle a few exceptions
    }
} 
```

这看起来更干净还是更丑陋，我会留给你。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-06-14T02:26:09.077

在 jdk8 中，您现在可以在没有 if 语句的情况下执行类似 O(1) 的查找时间...

现在可以正确处理空值的更好版本在这里

[https://github.com/deanhiller/webpieces/blob/master/webserver/http-router/src/main/java/org/webpieces/router/impl/params/ObjectTranslator.java](https://github.com/deanhiller/webpieces/blob/master/webserver/http-router/src/main/java/org/webpieces/router/impl/params/ObjectTranslator.java)

```
private Map<Class<?>, Function<String, Object>> classToUnmarshaller = new HashMap<>();
private Map<Class<?>, Function<Object, String>> classToMarshaller = new HashMap<>();

public ObjectTranslator() {
    classToUnmarshaller.put(Boolean.class, s -> s == null ? null : Boolean.parseBoolean(s));
    classToUnmarshaller.put(Boolean.TYPE, s -> Boolean.parseBoolean(s));
    classToUnmarshaller.put(Byte.class, s -> s == null ? null : Byte.parseByte(s));
    classToUnmarshaller.put(Byte.TYPE, s -> Byte.parseByte(s));
    classToUnmarshaller.put(Short.class, s -> s == null ? null : Short.parseShort(s));
    classToUnmarshaller.put(Short.TYPE, s -> Short.parseShort(s));
    classToUnmarshaller.put(Integer.class, s -> s == null ? null : Integer.parseInt(s));
    classToUnmarshaller.put(Integer.TYPE, s -> Integer.parseInt(s));
    classToUnmarshaller.put(Long.class, s -> s == null ? null : Long.parseLong(s));
    classToUnmarshaller.put(Long.TYPE, s -> Long.parseLong(s));
    classToUnmarshaller.put(Float.class, s -> s == null ? null : Float.parseFloat(s));
    classToUnmarshaller.put(Float.TYPE, s -> Float.parseFloat(s));
    classToUnmarshaller.put(Double.class, s -> s == null ? null : Double.parseDouble(s));
    classToUnmarshaller.put(Double.TYPE, s -> Double.parseDouble(s));
    classToUnmarshaller.put(String.class, s -> s);

    classToMarshaller.put(Boolean.class, s -> s == null ? null : s.toString());
    classToMarshaller.put(Boolean.TYPE, s -> s.toString());
    classToMarshaller.put(Byte.class, s -> s == null ? null : s.toString());
    classToMarshaller.put(Byte.TYPE, s -> s.toString());
    classToMarshaller.put(Short.class, s -> s == null ? null : s.toString());
    classToMarshaller.put(Short.TYPE, s -> s.toString());
    classToMarshaller.put(Integer.class, s -> s == null ? null : s.toString());
    classToMarshaller.put(Integer.TYPE, s -> s.toString());
    classToMarshaller.put(Long.class, s -> s == null ? null : s.toString());
    classToMarshaller.put(Long.TYPE, s -> s.toString());
    classToMarshaller.put(Float.class, s -> s == null ? null : s.toString());
    classToMarshaller.put(Float.TYPE, s -> s.toString());
    classToMarshaller.put(Double.class, s -> s == null ? null : s.toString());
    classToMarshaller.put(Double.TYPE, s -> s.toString());
    classToMarshaller.put(String.class, s -> s == null ? null : s.toString());
}

public Function<String, Object> getUnmarshaller(Class<?> paramTypeToCreate) {
    return classToUnmarshaller.get(paramTypeToCreate);
}

public Function<Object, String> getMarshaller(Class<?> type) {
    return classToMarshaller.get(type);
} 
```

这样你就可以打电话

```
primitiveTranslator.getConverter(Integer.TYPE).apply(stringToConvert); 
```

# windows-8 - Windows 8 应用清单：图像资产错误

> ID：13943552
> 
> 赞同：5
> 
> 时间：2012-12-19T00:06:45.617
> 
> 标签：windows-8, microsoft-metro

这些图像默认 VS 图像。但它不起作用。

```
Error   4   Payload file 
'C:\Users\Mert\documents\visual studio 2012\Projects\Y\P\Assets\StoreLogo.scale-100.png' does not exist.    
Error   3   Payload file 
'C:\Users\Mert\documents\visual studio 2012\Projects\Y\P\Assets\SplashScreen.scale-100.png' does not exist. 
Error   2   Payload file 
'C:\Users\Mert\documents\visual studio 2012\Projects\Y\P\Assets\SmallLogo.targetsize-32.png' does not exist.    
Error   1   Payload file 
'C:\Users\Mert\documents\visual studio 2012\Projects\Y\P\Assets\SmallLogo.scale-100.png' does not exist. 
```

![](../Images/868a60166f7fbc2adfc65817f3e22e36.png)

![](../Images/34f4b822d90adddc2956a9fd9efdf999.png)

我知道问题难以理解，但我没有找到不同的解释方式。

清单文件：

```
<?xml version="1.0" encoding="utf-8"?>
<Package xmlns="http://schemas.microsoft.com/appx/2010/manifest">
  <Identity Name="" Publisher="CN=Mert" Version="1.0.0.0" />
  <Properties>
    <DisplayName>Y</DisplayName>
    <PublisherDisplayName>Mert</PublisherDisplayName>
    <Logo>Assets\StoreLogo.png</Logo>
  </Properties>
  <Prerequisites>
    <OSMinVersion>6.2.1</OSMinVersion>
    <OSMaxVersionTested>6.2.1</OSMaxVersionTested>
  </Prerequisites>
  <Resources>
    <Resource Language="x-generate" />
  </Resources>
  <Applications>
    <Application Id="App" Executable="$targetnametoken$.exe" EntryPoint="Y.App">
      <VisualElements DisplayName="Y" Logo="Assets\Logo.png" SmallLogo="Assets\SmallLogo.png" Description="Y" ForegroundText="light" BackgroundColor="#464646">
        <DefaultTile ShowName="allLogos" />
        <SplashScreen Image="Assets\SplashScreen.png" />
      </VisualElements>
    </Application>
  </Applications>
  <Capabilities>
    <Capability Name="internetClient" />
  </Capabilities>
</Package> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-05T07:59:46.183

我昨天也遇到了这个问题。我注意到，当我从断言中删除图像时，它不会从**Visual Studio的****解决方案资源**管理器中删除它的出现。从解决方案资源管理器中删除这些文件修复了该问题。 干杯...！

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T07:13:16.340

我自己也遇到过这个。

似乎 Visual Studio 无法处理徽标的试错法。

我通过手动编辑 .csproj 文件并从那里删除丢失的资产来摆脱它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-25T11:11:31.443

将 Generate App Bundle 设置为 Never 可以解决此问题。**

# java - 直接从 Java 中的 URL 读取

> ID：13943557
> 
> 赞同：0
> 
> 时间：2012-12-19T00:07:20.333
> 
> 标签：java, html, url, web

当我打印[http://www.amazon.com/s/ref=sr_pg_3?rh=n%3A172282&page=1](http://www.amazon.com/s/ref=sr_pg_3?rh=n%3A172282&page=1)的内容时，我看到的 HTML 与使用浏览器中的“查看源代码”功能（Chrome ，就我而言，尽管我认为确切的浏览器并不重要）。例如，来自上述 URL 的 id 为“result_10”的 div 在浏览器中显示如下：

```
<div id="result_10" class="rsltGrid prod" name="B007I5JT4S"> 
```

但是当使用 Java 的实用程序打印相同的网页内容时`java.net.URL`，相同的 div 显示如下：

```
<div class="result product" id="result_10" name="B007I5JT4S"> 
```

这只是以编程方式读取此页面和使用浏览器生成的 HTML 之间在标识符和页面结构方面的众多差异之一。我不确定这是否源于某种 URL 解析问题或完全不同的东西。

如何从 Java 应用程序获取我在浏览器中看到的相同页面内容？

这是我一直用来读取 URL 的函数，其中“http://www.amazon.com/s/ref=sr_pg_3?rh=n%3A172282&page=1”是有问题的参数。

```
public static void printWebPageContents(String url) throws IOException {
    URL specifiedUrl = new URL(url);
    BufferedReader in = new BufferedReader(new InputStreamReader(specifiedUrl.openStream()));

    String inputLine;
    while ((inputLine = in.readLine()) != null)
        System.out.println(inputLine);

    in.close();
} 
```

如果需要任何澄清，请随时告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:11:48.230

[如果它与您的用户代理](http://en.wikipedia.org/wiki/User_agent_string#User_agent_identification)有关，我不会感到惊讶。我不知道默认值是什么`URL.openStream`，但我怀疑它与 Chrome 相同。

# python - PyQt4中QWebView的多线程

> ID：13943558
> 
> 赞同：1
> 
> 时间：2012-12-19T00:07:23.587
> 
> 标签：python, multithreading, qt, pyqt, threadpool

情况如下：我有一个加载特定 url 的类，还有一个参数列表，我需要发送到这个 url。我想使用线程“同时”加载这个 url，换句话说，不是加载一个 QWebView ，而是完成它而不是加载另一个我想一次打开 5 个窗口的窗口。

好的，所以现在的问题是，每个窗口都会有不同的速度，所以我需要跟踪正在使用的参数。

例如：

```
params = [1,2,3,4,5,6,7]
a = MyClass(1)
b = MyClass(2)
c = MyClass(3) 
```

现在，如果假设 b 类在其他 2 个类之前完成，它将获得值 4，并将重新开始。

这是示例代码：

```
#! /usr/bin/env python2.7

from PyQt4.QtCore import *
from PyQt4.QtGui import *
from PyQt4.QtWebKit import *
import sys, signal

class Grabber(QWebView):
    def __init__(self, param=None):
        QWebView.__init__(self)
        self.loadFinished.connect(self._loadComplete)
        url = QUrl('http://some website.com/search?param=%s'%param)
        self.load(url)
        self.show()

    def _loadComplete(self):
        print "Done"

if __name__ == "__main__":
    app = QApplication(sys.argv)
    # Dont know what to do with the next 2 lines
    thread_pool = QThreadPool()
    thread_pool.setMaxThreadCount(10)

    param = [1,2,3,4,5,6,7,8,9,10,11,12] # and so on

    # Whant to achive something similar:
    for i in param:
        a = Grabber(i)
        b = Grabber(i)
        c = Grabber(i)
        d = Grabber(i)
        e = Grabber(i)

    if signal.signal(signal.SIGINT, signal.SIG_DFL):
        sys.exit(app.exec_())
    app.exec_() 
```

我很确定我需要使用线程、ether python native 线程或 PyQt4 QThread。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T12:50:58.470

看看这样的事情是否有效。该类`bookie`所做的是将调用的次数存储`loadFinished`到变量`count`中，并返回列表中的相应项`params`。创建`grabber`对象时，它通过 将其映射到一个数字`QSignalMapper`，因此您可以通过调用来检索信号的发送者`mapper.mapping(id-of-grabber-object)`。您可以继续尝试此代码，看看它是否适合您，然后再修改您的代码：

```
#!/usr/bin/env python
from PyQt4.QtCore import pyqtSlot, QObject, QSignalMapper, QTimer
from PyQt4.QtGui import QApplication
from PyQt4.QtWebKit import QWebView

class bookie(QObject):
    def __init__(self, parent=None):
        super(bookie, self).__init__(parent)

        self.count  = 0
        self.url    = 'http://some website.com/search?param={0}'
        self.params = range(100) # instead of [1,2,3,4,5,6,7,8,9,10,11,12] and so on...

        Grabber = QWebView # This would be your Grabber class

        self.mapper = QSignalMapper(self)
        self.mapper.mapped.connect(self.on_mapper_mapped)

        for grabberNumber in range(10): # Create 10 Grabber instances
            grabber = Grabber()
            grabber.loadFinished.connect(self.mapper.map)

            self.mapper.setMapping(grabber, grabberNumber)

            grabber.loadFinished.emit(True) # Initialize the grabber by emitting loadFinished

    def on_mapper_mapped(self, gNumber):
        self.count += 1
        if self.count < len(self.params):
            gParam  = self.params[self.count]   
            grabber = self.mapper.mapping(gNumber)
            #grabber.load(QUrl(self.url.format(gParam)))

            # Next 2 lines for testing purposes, remove & uncomment the previous line

            print "GRABBER:", gNumber, "PARAMETER:", gParam
            QTimer.singleShot(1, lambda:grabber.loadFinished.emit(True)) 

if __name__ == "__main__":
    import  sys

    app = QApplication(sys.argv)
    main = bookie() 
```

# php - PHP：仅将帖子的更改部分保存到数据库

> ID：13943560
> 
> 赞同：0
> 
> 时间：2012-12-19T00:07:24.150
> 
> 标签：php, optimization, diff

我有一个网站，用户可以在其中提交一些文本。用户可以编辑他们的帖子，然后保存。然后，用户可以查看他/她对帖子所做的所有更改。

**问题：**
每当他们编辑帖子时，我想保留旧帖子和编辑后的帖子，但我不想多次保存帖子的同一部分。

**我的方法**
起初我想保存原始帖子，然后只保存附加的文本，但我遇到的问题是，帖子的编辑部分并不总是在最后。

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:12:53.437

您可以使用专门用于此类任务的算法来解决这个问题，例如*diff 和 patch*。您要么自己实现它，重用现有实现，要么使用已经完成的软件，允许将数据存储在修订版中。

# android - Android NDK Eclipse 构建错误：无法重命名文件。原因：文件存在

> ID：13943563
> 
> 赞同：2
> 
> 时间：2012-12-19T00:07:54.653
> 
> 标签：android, eclipse, android-ndk

我正在使用 Eclipse 和本机代码构建一个 Android 项目。95% 的时间它都可以正常工作，但它时不时地决定给我以下错误：

制作：[libs/armeabi/libnative.so] 错误 1

make: 删除文件 `libs/armeabi/libnative.so'

Libnative 是我正在创建的本地库。有时再次运行构建工作正常，有时它只是一次又一次地失败。其他时候它可以工作几天。

这是什么，我该如何阻止它发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-14T08:13:56.443

可以通过以下步骤解决此问题：

*   eclipse中的清理项目
*   跑`ndk-build clean`
*   跑`ndk-build`
*   如果不行，尝试删除 libs 文件夹中的 *.so 并删除 obj 文件夹，然后运行上述步骤。

希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-27T09:43:55.847

如果有人遇到同样的问题，请尝试从您的存储库中删除 .so 文件并提交该更改。我不知道为什么，但它对我有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-03T11:55:04.513

如果这仅在生成 APK 时发生，请尝试在导出时禁用“自动构建”。[在这里](https://stackoverflow.com/q/20350339/249239.)查看我的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-15T22:19:19.110

计算机重新启动为我解决了这个问题

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-04-16T15:17:49.543

要解决此问题，只需更改Eclipse Android 项目`cdt.managedbuild.tool.gnu.assembler.base` `tool id`的文件中的内容。`.cproject`此 ID 似乎与您刚刚构建的其他项目的 ID 相同。您可能已经复制了要升级的项目，并且出现了相同的 id。我将 1798454924 更改为 1798454925 并且错误消失了。

```
tool id="cdt.managedbuild.tool.gnu.assembler.base.1798454924" name="GCC Assembler" superClass="cdt.managedbuild.tool.gnu.assembler.base" 
```

# python - 操作字符串数据

> ID：13943570
> 
> 赞同：0
> 
> 时间：2012-12-19T00:08:51.720
> 
> 标签：python, python-2.7

我是 python 新手，并试图创建一个脚本来修改 JS 文件的输出以匹配将数据发送到 API 所需的内容。JS 文件正在通过 urllib2 读取。

```
def getPage():
    url = "http://url:port/min_day.js"
    req = urllib2.Request(url)
    response = urllib2.urlopen(req)
    return response.read()

# JS Data
# m[mi++]="19.12.12 09:30:00|1964;2121;3440;293;60"
# m[mi++]="19.12.12 09:25:00|1911;2060;3277;293;59"

# Required format for API
# addbatchstatus.jsp?data=20121219,09:25,3277.0,1911,-1,-1,59.0,293.0;20121219,09:30,3440.0,1964,-1,-1,60.0,293.0 
```

作为细分（必填值以粗体显示）

m[mi++]=" **19.12.12** **09:30:00** | **1964** ;2121; **3440** ; **293** ; **60** "

并且需要将 -1,-1 的值添加到字符串中

我已经设法将日期转换为正确的格式并替换字符和换行符以使输出看起来像这样，但我有一种感觉，如果我需要能够重新排序这个字符串值，我就会走错路. 虽然看起来顺序在时间方面也是相反的。

```
20121219,09:30:00,1964,2121,3440,293,60;20121219,09:25:00,1911,2060,3277,293,59 
```

任何帮助将不胜感激！我在想正则表达式可能是我需要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:50:02.053

这是一个正则表达式模式，用于去除您不想要的位

> `m\[mi\+\+\]="(?P<day>\d{2})\.(?P<month>\d{2})\.(?P<year>\d{2}) (?P<time>[\d:]{8})\|(?P<v1>\d+);(?P<v2>\d+);(?P<v3>\d+);(?P<v4>\d+);(?P<v5>\d+).+`

并替换为

> `20\P<year>\P<month>\P<day>,\P<time>,\P<v3>,\P<v1>,-1,-1,\P<v5>,\P<v4>`

此模式假定日期之前的字符是不变的。如果您想要更一般地处理该位，您可以替换`m\[mi\+\+\]="`为。`[^\d]+`

因此，要将其付诸实践，在 python 中：

```
import re

def getPage():
    url = "http://url:port/min_day.js"
    req = urllib2.Request(url)
    response = urllib2.urlopen(req)
    return response.read()    

def repl(match):
    return '20%s%s%s,%s,%s,%s,-1,-1,%s,%s'%(match.group('year'),
                                            match.group('month'),
                                            match.group('day'),
                                            match.group('time'),
                                            match.group('v3'),
                                            match.group('v1'),
                                            match.group('v5'),
                                            match.group('v4'))

pattern = re.compile(r'm\[mi\+\+\]="(?P<day>\d{2})\.(?P<month>\d{2})\.(?P<year>\d{2}) (?P<time>[\d:]{8})\|(?P<v1>\d+);(?P<v2>\d+);(?P<v3>\d+);(?P<v4>\d+);(?P<v5>\d+).+')

data = [re.sub(pattern, repl, line).split(',') for line in getPage().split('\n')]

# If you want to sort your data
data = sorted(data, key=lambda x:x[0], reverse=True)

# If you want to write your data back to a formatted string
new_string = ';'.join(','.join(x) for x in data)

# If you want to write it back to file
with open('new/file.txt', 'w') as f:
    f.write(new_string) 
```

希望有帮助！

# python - 试图从字典中获取 3 种信息，不会通过（不是全局的）

> ID：13943572
> 
> 赞同：0
> 
> 时间：2012-12-19T00:09:09.537
> 
> 标签：python, python-3.x

我正在尝试编写从课程编号（CS101）的输入中检索课程、讲师和时间的代码

在您输入正确的课程编号后，它应该会告诉您房间号、讲师和上课时间。

这就是我到目前为止所拥有的。

```
def main():
    courses, instructors, times = create_info()

    print('Please enter a course number...')
    choice = input(': ').upper()

    if choice == 'CS101':
        courses.get(CS101)
        instructors.get(CS101)
        times.get(CS101)
    elif choice == 'CS102':
        print()
    elif choice == 'CS103':
        print()
    elif choice == 'NT110':
        print()
    elif choice == 'CM241':
        print()
    else:
        print('Sorry, invalid course number')
        print()
        main()

    print()
    main()

def create_info():
    courses = {'CS101':'3004', 'CS102':'4501', 'CS103':'6755', 'NT110':'1244',
               'CM241':'1411'}
    instructors = {'CS101':'Haynes', 'CS102':'Alvarado', 'CS103':'Rich',
                   'NT110':'Burke', 'CM241':'Lee'}
    times = {'CS101':'8:00 a.m.', 'CS102':'9:00 a.m.', 'CS103':'10:00 a.m.',
             'NT110':'11:00 a.m.', 'CM241':'1:00 p.m.'}

    return courses, instructors, times

main() 
```

它给出了以下内容：

NameError：未定义全局名称“CS101”

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:13:28.127

问题在于这些行：

```
 courses.get(CS101)
    instructors.get(CS101)
    times.get(CS101) 
```

`CS101`假定为变量，而不是字符串或字典键。

它应该是这样的：

```
print(courses.get('CS101')) 
```

或者

```
print(courses['CS101']) 
```

键需要用单引号或双引号括起来，以表明它是字符串，而不是变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:35:17.087

使用字典的一个好处是您可以使用`in`运算符快速检查其中是否有键。所以你可以用以下内容替换你的大`if`//块`elif`：`else`

```
if choice in courses:
    # do the output with choice as a key to the dictionaries
    print("Course Number:", courses[choice])
    print("Instructor:", instructors[choice])
    print("Times:", times[choice])
else: 
    # choice is not a valid key to the dictionaries
    print("Sorry, invalid course number") 
```

这种编码风格在 Python 世界中被称为“跳前检查”（LBYL），因为您在执行操作之前检查您将要执行的操作（在字典中查找所选类）是否有效。另一种风格（更高级）被称为“比许可更容易请求宽恕”（EAFP），您可以在其中使用`try`和`except`子句来处理在某些异常情况下生成的异常。以下是您如何以 EAFP 样式执行上述代码：

```
try:
    # try do the output unconditionally
    print("Course Number:", courses[choice])
    print("Instructor:", instructors[choice])
    print("Times:", times[choice])
except KeyError:
    # a KeyError is raised if choice isn't in the dictionaries
    print("Sorry, invalid course number") 
```

在这种情况下，这两种方法没有太大区别，但在某些情况下（如果检查情况是否有效需要很多时间），EAFP 可能会更快，因为可能失败的操作已经在检查无效情况（所以它可以引发适当的异常）。

# ruby-on-rails - Rails 应用程序和定位堆栈跟踪

> ID：13943574
> 
> 赞同：2
> 
> 时间：2012-12-19T00:09:22.163
> 
> 标签：ruby-on-rails, ruby, debugging, stack

我正在调查我的 Ruby on Rails 应用程序中的一些性能问题。NewRelic 向我展示了许多其 updated_at 属性已多次更新的特定对象。我不完全确定这发生在哪里。我决定尝试定位这种表现形式的一种方法是为我的模型创建一个观察者，并在该属性被修改时获取堆栈跟踪。所以我有类似的东西：

```
class FooObserver < ActiveRecord::Observer
  def before_save(foo)

    if foo.updated_at_changed?
      Rails.logger.info("Foo changed - print stack trace??")
    end
  end

end 
```

此时获取此堆栈跟踪的最佳方法是什么？还是来电者？

任何建议都会很棒。我需要停止一次又一次地进行此更新，这会损害性能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:16:10.843

使用[来电者](http://ruby-doc.org/docs/ProgrammingRuby/html/ref_m_kernel.html#Kernel.caller)

```
Rails.logger.info caller 
```

# c# - 通用 c# 循环（分区/排序）队列

> ID：13943581
> 
> 赞同：7
> 
> 时间：2012-12-19T00:10:43.967
> 
> 标签：c#, linq, queue, round-robin

我经常需要处理一个项目队列，其中没有一个用户应该能够阻止队列，并且队列中的项目应该按某种顺序处理。我经常写一个类来做到这一点，但我认为应该有一些通用版本，但我找不到。

所以我正在寻找一个队列类，我可以在其中指定一个类型、一个分区选择器和一个排序选择器，这样我就可以将对象添加到队列中，然后当我取出对象时，我从我的订单说明符订购的下一个分区。

例如，我会这样调用，指定如何分区以及如何对队列进行排序：

```
 var queue = new RoundRobinQueue<Message>(
            _ => _.UserID,
            _ => _.SendDate
            ); 
```

在我添加了很多消息之后，我可以`Parallel.ForEach`将队列中的项目按照最早的顺序处理它们以`SendDate`供下一个`User`。这样，如果一个用户很慢，他的项目不会阻塞队列，因为他只得到一个线程，但如果只有一个用户，他是唯一的分区，所以他得到所有线程。

我看了一遍，但在 C# 中找不到一个很好的**通用**实现。有任何想法吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-19T00:35:40.300

查看 中定义的类`System.Collections.Concurrent`。有一个通用的 ConcurrentQueue 以及用于生产者-消费者模式的更基本的构建块。

[MSDN](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.aspx)上总结了可用的类和接口。

# javascript - 为什么 Twitter Bootstrap 弹出框不适用于 SVG 元素？

> ID：13943582
> 
> 赞同：19
> 
> 时间：2012-12-19T00:10:46.837
> 
> 标签：javascript, jquery, twitter-bootstrap, svg

我更像是一个 C++ 人，但我目前正在研究一些 Web UI 的东西。我似乎无法让 Bootstrap 弹出框出现在 SVG 元素上。

有任何想法吗？弹出框适用于普通 div。

jsFiddle 在这里：http: [//jsfiddle.net/JjAht/](http://jsfiddle.net/JjAht/)

```
<!DOCTYPE html>
<html>
<head>
<link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap.min.css" rel="stylesheet">
<link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/css/bootstrap-responsive.min.css" rel="stylesheet">

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.2.2/bootstrap.min.js"></script>
</head>
<body>
<div>
    <svg width="100" height="100">
        <circle r="45" cx="50" cy="50" style="fill: red"/>
    </svg>
</div>

<div class="well">
    <p>
    Hover here for a popover.
    </p>
</div>

<script type="text/javascript">

    $(document).ready(function() {
        var numCircles = $("circle").length;
        console.log("numCircles = " + numCircles);

        $("circle").popover({trigger:'hover', placement:'bottom', title:'Title!', content:'Content'});

        $("circle").css({"stroke":"blue"});

        $(".well").popover({trigger:'hover', placement:'bottom', title:'Title!', content:'Content'});
    } );
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-09T17:20:36.727

从该示例看来，您需要修改 Bootstrap 才能使其正常工作。

在 bootstrap-tooltip.js 下替换：

```
$tip
    .detach()
    .css({ top: 0, left: 0, display: 'block' })
    .insertAfter(this.$element)

pos = this.getPosition(inside) 
```

和

```
if($('#'+this.$element[0].id,$('svg')).length > 0){
        $tip
          .remove()
          .css({ top: 0, left: 0, display: 'block' })
          .prependTo(document.body)

        pos = $.extend({}, this.$element.offset(), {
          width: this.$element[0].getBoundingClientRect().width
          , height: this.$element[0].getBoundingClientRect().height
        })
   } else {
         $tip
             .detach()
             .css({ top: 0, left: 0, display: 'block' })
             .insertAfter(this.$element)

         pos = this.getPosition(inside)
    } 
```

基本上有两个问题 1）引导程序将工具提示/弹出框的 div 插入到浏览器忽略它的 SVG 中，2）需要从 SVG 计算位置信息

[我已经在 Github https://github.com/twitter/bootstrap/pull/6521](https://github.com/twitter/bootstrap/pull/6521)上将此作为拉取请求提交

**更新：**看来 bootstrap 2.3.0+ 将通过`container`工具提示/弹出框的新属性支持这一点。使用 SVG 时，将其设置`container`为`body`. 在这里查看评论[https://github.com/twitter/bootstrap/pull/6521](https://github.com/twitter/bootstrap/pull/6521)

一个例子：

```
svg.selectAll(".node").each(
    function(d,i){
        $(this).popover({title:"title", content:"content", container:"body"});
        // and/or $(this).tooltip({title:"tooltip - title", container:"body"});
    }); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-05-30T17:33:18.797

使用最新版本的 Bootstrap，`container`在里面添加一个带有 HTML 元素的选项似乎就足以让它工作了！

```
$("circle").each(function () {
    $(this).popover({
        title: "Hi!",
        content: "popover",
        container: $("#container")
    });
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-24T18:06:40.567

您尚未选择 svg 来打开弹出框，这就是它无法打开的原因。看这里[http://jsfiddle.net/JjAht/1/](http://jsfiddle.net/JjAht/1/)

```
 $("svg").popover({trigger:'hover', placement:'bottom', title:'Title!', content:'Content'}); 
```

# php - 实例化一个 \Zend\Stdlib\RequestInterface

> ID：13943584
> 
> 赞同：0
> 
> 时间：2012-12-19T00:10:52.093
> 
> 标签：php, zend-framework2

我想使用的方法`match(\Zend\Stdlib\RequestInterface)`。 `Zend\Mvc\Router\Http\TreeRouteStack`

但我找不到任何方法来获取我正在搜索的请求。

[本文](http://www.mixedwaves.com/2010/02/zend-framework-accessing-request-object-from-anywhere/)介绍了如何在控制器之外获取请求对象。我正在寻找 ZF2 的等价物

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T11:04:02.827

最后我通过浏览zf2的单元测试找到了解决方法

[https://github.com/zendframework/zf2/blob/master/tests/ZendTest/Mvc/Router/Http/TreeRouteStackTest.php](https://github.com/zendframework/zf2/blob/master/tests/ZendTest/Mvc/Router/Http/TreeRouteStackTest.php)

`Zend\Http\PhpEnvironment\Request;` 将为匹配方法提供有效的请求

```
 use Zend\Http\PhpEnvironment\Request as PhpRequest;
 /*TreeRouteStack*/
 $request = new PhpRequest();
 $stack->match($request); 
```

# ruby-on-rails - 通过密码确认更改用户密码

> ID：13943588
> 
> 赞同：1
> 
> 时间：2012-12-19T00:11:40.307
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, authlogic

我正在尝试使用 password_confirmation 更新用户密码以确认它。

但是，我找不到正确更新密码的方法，我设置了密码，`password=`但是`password_confirmation=`当我查看`changed?`结果时，它总是返回 false。

关于如何解决这个问题的任何建议？这是我的代码（在控制器中调用了change_password，正确传递了参数我已经看到它们与打印）：

```
class User < ActiveRecord::Base
  acts_as_authentic

  belongs_to :organization

  # Setup accessible (or protected) attributes for your model
  attr_accessible :email, :password, :organization_id, :note, :role

  validates :email, :uniqueness => true
  validates :role,  :inclusion => { :in => Rails.configuration.available_roles }

  def change_password!(pswd)
    password = pswd
    password_confirmation = pswd
    return changed? && save
  end

  def change_password(old_pswd, pswd, confirm_pswd)
    return false, 'Old password is incorrect' if !valid_password?(old_pswd, true)
    password = pswd
    password_confirmation = confirm_pswd
    # update_attributes([user: [password: pswd, password_confirmation: confirm_pswd]])
    print "--------- #{old_pswd} #{pswd} #{confirm_pswd} #{changed?.to_s} ------------"
    return changed? && save, 'New and confirm password are not correcty'
  end
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T00:30:41.660

您需要`self.`在设置属性时使用（实际上是“设置器”辅助方法） - 否则 ruby​​ 认为您正在创建新的局部变量：

```
self.password = pswd
self.password_confirmation = pswd 
```

# javascript - 开放、真正响应、适合移动设备的灯箱

> ID：13943589
> 
> 赞同：3
> 
> 时间：2012-12-19T00:11:40.533
> 
> 标签：javascript, responsive-design, lightbox

我正在寻找[响应](http://en.wikipedia.org/wiki/Responsive_web_design)和移动友好的[灯箱](http://en.wikipedia.org/wiki/Lightbox_%28JavaScript%29)插件的建议。

## 更新

以下内容非常适合`dialogs`但`pop-up windows`没有用于旋转图像或视频列表的内置`Next`/导航：`Previous`

*   [Foundation 3](http://foundation.zurb.com/)有[Reveal](http://foundation.zurb.com/docs/reveal.php)。
*   [JQuery Mobile 1.2.0](http://jquerymobile.com/)有[Popup](http://jquerymobile.com/branches/popup-widget/docs/pages/popup/index.html)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:00:06.080

以前的答案是专门寻找一个灯箱插件。

如果您想在移动设备上为画廊提供灯箱效果，请考虑以下内容：[http ://www.photoswipe.com/latest/examples/04-jquery-mobile.html](http://www.photoswipe.com/latest/examples/04-jquery-mobile.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T00:45:47.943

jQuery mobile 有各种弹出事件 [http://jquerymobile.com/branches/popup-widget/docs/pages/popup/index.html](http://jquerymobile.com/branches/popup-widget/docs/pages/popup/index.html)

# ios - 在 IB 中创建的 UIView 在 vi ewDidLoad 和 awakeFromNib 中没有框架

> ID：13943590
> 
> 赞同：5
> 
> 时间：2012-12-19T00:11:41.633
> 
> 标签：ios, uiview

如果我在这里遗漏了一些东西，我很抱歉，但我认为在 IB 中创建的 UIView 对象应该在 viewDidLoad 中创建它们的框架，因此您可以在 viewDidLoad 或 awakeFromNib 或 viewWillAppear 中基于此视图进行初始设置。我在每种方法中记录了输出：

```
NSLog(@"%@ %s", NSStringFromCGRect(self.zoomView.frame), __FUNCTION__); 
```

总而言之，我得到 {0, 0, 0, 0}。

这是我的 UIStoryboard 中的第一个 nib，我正在使用 Autolayout 和 iOS 6。我可以在以前的应用程序上发誓，我已经使用在 IB 中创建的其他 UIView 对象的框架来进行设置。有什么改变了吗？还是我记错了？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-24T23:54:02.207

我有完全相同的问题。是的，你没记错——它在 iOS 5 中曾经有所不同。我总是在其中设置视图，`viewDidLoad:`并且框架已经是视图实际在屏幕上时的样子。

[现在在 iOS 6 中，如果启用了自动布局](https://developer.apple.com/library/content/documentation/UserExperience/Conceptual/AutolayoutPG/)，您需要将代码放入`viewDidAppear:`其中以使用有效的框架。显然，布局是在这两个调用之间完成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T00:06:47.477

我认为这与您正在使用的设备以及可能的其他事情有关，但框架和边界“可以”有时在调用 viewDidLoad 时设置，有时不设置（取决于....）另一方面，框架并保证在调用“ViewDidAppear”时已经设置了边界。并且您希望将与框架和边界相关的代码放在有保证的地方！

# iphone - 如何使用 Flex 从 iOS（对于 iPhone）的路径中检索图像

> ID：13943594
> 
> 赞同：0
> 
> 时间：2012-12-19T00:12:05.780
> 
> 标签：iphone, ios, flex-mobile

如何使用 Flex mobile 在 iPhone 中检索存储在我的相册中的图像的路径？与使用 iPhone 上的相机拍摄的图像相同。

对于Android，我使用此功能并且可以使用，但是对于iPhone，它没有任何想法吗？

```
 protected function onMediaSelect(event:MediaEvent):void
            {
                var mp:MediaPromise = event.data;
                image.source = mp.file.url;
            } 
```

当我在他现场拍照时，我会用这个

```
protected function onComplete(evt:MediaEvent):void
            {
                img.source = evt.data.file.url;
            } 
```

如果您能向我展示正确的方向，我将不胜感激。谢谢！

～喵喵

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T07:02:46.003

我广告使用[cameraroll类](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/media/CameraRoll.html)

```
//if we get the image
trace( "Asynchronous media promise." );
                    var eventSource:IEventDispatcher = dataSource as IEventDispatcher;            
                    eventSource.addEventListener( Event.COMPLETE, onMediaLoaded ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-30T05:57:53.633

```
this one it will work only under windows...

   image.source = File.desktopDirectory.resolvePath(file_name).nativePath; 
```

传递以 / 开头的文件名的 Image 的源属性（/ 是基于 unix 的操作系统、android、linux、ios 等的根），将采用相对路径而不是完整路径...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T05:52:23.730

image.source = File.desktopDirectory.resolvePath(file_name).url;

# asp.net - 如何在 IE 10 中删除 TextBox 中的十字符号 ..？

> ID：13943600
> 
> 赞同：-2
> 
> 时间：2012-12-19T00:12:45.003
> 
> 标签：asp.net, html, css

我正在使用 win8 和 IE 10，在此浏览器中我想删除十字符号，如我网页中的图像（自动清除符号）所示。任何人都可以帮助...？？？？

![在此处输入图像描述][1]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:16:00.760

拥有这个。

```
 ::-ms-clear {
    display: none;
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T00:16:01.437

从[这个问题](https://stackoverflow.com/questions/13481577/how-can-i-disable-the-clear-button-that-ie10-inserts-into-textboxes)：

```
input[type=text]::-ms-clear {
    display: none;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T03:47:17.840

### 您可以通过设置 CSS

```
::-ms-clear {
    display: none;
} 
```

# c# - 使用提供 PDF 文件结果的 ASP.NET MVC 操作填充 Chrome 中对象标记的数据属性

> ID：13943607
> 
> 赞同：5
> 
> 时间：2012-12-19T00:13:45.620
> 
> 标签：c#, asp.net, .net, asp.net-mvc, google-chrome

我有一个返回 PDF 的 FileResult 操作。我想将此 PDF 嵌入到对象标签中。当我将操作插入到对象标记的数据属性中时，如下所示，Chrome 中不会检索或显示任何 PDF。（PDF 显示在带有 Adob​​e 插件的 Firefox 中 - 我不关心 IE。）

```
<object data="@Url.Action("GetPDF", "PDFCreation", new {id= Model.DocumentId})" type="application/pdf"></object> 
```

否则一切正常 - 对象标签与文件系统上的 PDF 的直接链接一起使用（例如，data="~/Content/test.pdf"），以及上面的操作，如果硬粘贴到位置栏中，下载 PDF。

有什么想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T09:59:15.230

我设法让 IE 显示使用 FileContentResult 和以下对象标记返回的 Pdf

```
<object>
    <embed src="@Url.Action("GetPDF", "PDFCreation", new {id= Model.DocumentId})" type="application/pdf"></embed>
</object> 
```

也许值得尝试一下

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T12:09:36.503

通过这个答案修复它：[Returning a file to View/Download in ASP.NET MVC](https://stackoverflow.com/questions/5826649/returning-a-file-to-view-download-in-mvc)

必须附加内容处置标头，并将内容处置的“内联”值设置为 true。

```
var doc = ...
var contentDisposition = new ContentDisposition
{
    FileName = doc.FileName,
    Inline = true
};

Response.AppendHeader("Content-Disposition", contentDisposition.ToString());

return File(doc.Path, MediaTypeNames.Application.Pdf); 
```

# ssh - 当我在 ssh 上收到“Broken Pipe”错误时，EC2 实例中的进程会发生什么情况？

> ID：13943613
> 
> 赞同：3
> 
> 时间：2012-12-19T00:14:31.683
> 
> 标签：ssh, amazon-ec2, broken-pipe

我正在使用一些 EC2 实例来运行一些我无法在本地运行的大型作业。我看到的问题是，过了一段时间（进程开始后的 X 小时）我在 shell 上的连接给了我一个损坏的管道错误

```
ubuntu@ip-10-122-xxx-xxx:~/stratto/ode$ Write failed: Broken pipe 
```

该实例仍然存在，因为我可以毫无问题地重新连接，但是我如何重新连接并重新查看进程的日志，就像在“Broken Pipe”之前一样

非常感谢任何提示，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:29:20.123

将您的输出重定向到一个文件，然后运行程序“nohup ...”以确保断开连接不会杀死它。使用“tail -f”监视重定向的文件。

注意：最初说要使用“tee”，但这不起作用。我认为直接重定向，然后对文件进行尾部处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-05-15T13:45:13.000

即使您没有连接到服务器，您也可以使用[screen在云中运行进程。](https://linuxize.com/post/how-to-use-linux-screen/)

```
sudo apt install screen 
```

为了具体解决原始帖子中描述的问题（例如连接到 AWS EC2 实例），我提供了一个[基本示例](https://gist.github.com/samsammurphy/b145be267214c361c7775c1fc44ffa9c)和一个使用屏幕的更[高级示例](https://gist.github.com/samsammurphy/4810b4117ebdafabd2cfd11421e97a79)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-01T17:56:05.513

您可以使用`"screen"`. 从中分离并 ping 到 google.com。因此，在整个安装过程中，ssh 会话将处于活动状态。

# wpf - WPF使用不同的viewmodel实例绑定到ListView

> ID：13943614
> 
> 赞同：2
> 
> 时间：2012-12-19T00:14:39.547
> 
> 标签：wpf

我在将可观察的视图模型集合绑定到 ListView 时遇到问题。但是有一些有趣的东西可以让我成功绑定，这表明代码是正确的（据我所知）

场景：我有 1 个使用“MainViewModel”的主屏幕这个主视图模型有一个 ListView，它绑定到一个“OpenSaleViewModel”，后者又具有一个可观察的“OpenSaleItemViewModel”对象集合。

我在 XAML 中的代码工作正常： DisplayMemberBinding 工作正常

```
<Grid x:Name="SalesScreenHolder" Background="AliceBlue" VerticalAlignment="Stretch" >
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="70" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Grid x:Name="grdSalesWindow" Margin="0,0,0,0" Grid.Row="0" Width="300" Height="350" MaxHeight="1000" DataContext="{Binding Main, Source={StaticResource MainVM}}">
                        <ScrollViewer x:Name="salesScrollViewer" PanningMode="VerticalOnly" VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Hidden" >
                            <ListView x:Name="lstviewSales" ItemContainerStyle="{StaticResource alternatingListViewItemStyle}" AlternationCount="2" HorizontalAlignment="Left" HorizontalContentAlignment="Left" ItemsSource="{Binding OpenSale.OpenSalesItems, UpdateSourceTrigger=PropertyChanged}">
                                <!--<ListView.ItemContainerStyle>
                                    <Style TargetType="ListViewItem">
                                        <Setter Property="Height" Value="30" />  
                                    </Style>
                                </ListView.ItemContainerStyle>-->
                                <ListView.View>
                                    <GridView x:Name="listViewGrid">
                                        <GridViewColumn Width="150" Header="Item"
                                            DisplayMemberBinding="{Binding SaleItemName}" />
                                        <GridViewColumn Width="50" Header="Qty"  
                                            DisplayMemberBinding="{Binding Quantity}" />
                                        <GridViewColumn Width="90" Header="TotalPrice" 
                                            DisplayMemberBinding="{Binding TotalAmtString}" />
                                    </GridView>
                                </ListView.View>

                            </ListView>
                        </ScrollViewer> 
```

现在说我有 4 个 OpenSaleViewModel 对象，每个销售 1 个，每个都有自己的 SalesItems 集合

我尝试将集合绑定到我在应用程序其他位置打开的对话框窗口，它只显示名称空间和视图模型的名称：见截图

![在此处输入图像描述](../Images/bbab49d546abc774b84ae7a33aed4e09.png)

我尝试使用 path=PROPERTYNAME 和 Data.PROPERTYNAME

正如您在网格上方的 3 个标签中看到的那样，在我访问父视图模型中的属性并成功绑定时设置了数据上下文。我已经调试过，可以看到每次销售都提取了正确数量的物品，但数据没有被识别。

问题是如果我将 'ItemsSource="{Binding OpenSale.OpenSalesItems' 设置为 'ItemsSource="{Binding OpenSale' 只是为了测试主屏幕中发生的情况，这意味着没有要绑定的数据，所以看起来当主屏幕中的可观察集合为空时，我的对话框窗口确实显示数据正常 - 所以我无法理解为什么具有不同集合的 2 个不同视图模型（尽管使用相同的类作为集合的基础）似乎是冲突的？似乎我只能在只有 1 个窗口使用相同类型视图模型的集合时才能绑定（在本例中为销售视图模型中的“SaleItems”）

这是我的对话窗口的代码

```
 <Grid x:Name="grdTableSalesItemsxxc" Margin="2,0,2,0" Grid.Row="0" Width="610" Height="200" MaxHeight="1000" >
            <ScrollViewer x:Name="tableSalesScrollViewer" PanningMode="VerticalOnly" VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Hidden" >
                <ListView x:Name="lstviewTableSalexxc" ItemContainerStyle="{StaticResource alternatingListViewItemStyle}" AlternationCount="2" 
                                            HorizontalAlignment="Stretch" HorizontalContentAlignment="Left" ItemsSource="{Binding Sale.OpenSalesItems, BindsDirectlyToSource=True, UpdateSourceTrigger=PropertyChanged}" >
                    <!--<ListView.ItemContainerStyle>
                        <Style TargetType="ListViewItem">
                            <Setter Property="Height" Value="30" />
                        </Style>
                    </ListView.ItemContainerStyle>-->
                    <ListView.View>
                        <GridView x:Name="grdTableSaleGridxxc">
                            <GridViewColumn Width="295" Header="Item Name"
                                            DisplayMemberBinding="{Binding SaleItemName}" />
                            <!--<GridViewColumn Width="100" Header="Quantity"  
                                            DisplayMemberBinding="{Binding SaleItemName}" />
                            <GridViewColumn Width="105" Header="Total Price" 
                                            DisplayMemberBinding="{Binding SaleItemName}" />-->    
                        </GridView>
                    </ListView.View>
                </ListView>
            </ScrollViewer> 
```

这是第一次在主屏幕中绑定的父视图模型“OpenSaleViewModel”的集合

```
 public ObservableCollection<OpenSaleItemViewModel> OpenSalesItems
        {

        get
        {
            if (_salesItems == null)
            {
                _salesItems = new ObservableCollection<OpenSaleItemViewModel>();

                foreach (OpenSaleItem itm in _openSale.OpenSaleItems)
                {
                    // Check if we need to grab the stockPLU or RecipeProduct PLU
                    if (itm.StockPLU != null)
                    {
                        _osi = new OpenSaleItemViewModel(itm.StockPLU);
                    }
                    else
                    {
                        _osi = new OpenSaleItemViewModel(itm.RecipeProductID);
                    }

                    // Populate remaining properties
                    _osi.Quantity = itm.Quantity;
                    _osi.TotalAmount = itm.TotalAmount;
                    _osi.SalesUnitCostPrice = itm.SalesUnitCostPrice;

                    if (itm.OpenSale != null)
                        _osi.OpenSaleID = itm.OpenSale.ID;

                    _salesItems.Add(_osi);
                }
            }

            return _salesItems;
        }
        set
        {
            _salesItems = value;
            RaisePropertyChanged("OpenSalesItems");
            RaisePropertyChanged("TotalVAT");
            RaisePropertyChanged("TotalAmtIncVAT");
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T00:46:56.907

我觉得你的 ItemsSource 应该设置在你的 GridView 上而不是你的 ListView 上。那对你不起作用吗？

# java - 我应该把只用于开发的类放在哪里？

> ID：13943615
> 
> 赞同：2
> 
> 时间：2012-12-19T00:14:40.830
> 
> 标签：java, android, maven, inversion-of-control, roboguice

我开始使用 roboguice 的依赖注入，并创建了一个类似 DataProvider 的接口。我有一个实现，它从位于 WebServerDataProvider 类中的某个 WebServer 中检索数据。为了消除对网络服务器的等待，我添加了一个 DummyDataProvider。

我会把这样的课放在哪里？我不喜欢它在 /src/main/java/my/package/providers/ 因为它不是应用程序的真实部分，但我仍然需要它进行开发。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T05:15:12.880

通常，您会在单元测试中使用这样的类。Roboguice 与 Robolectric 配合得很好，它允许你模拟 http 访问之类的东西。如果你这样做，你会把你的代码放在 src/test/java/...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T10:11:44.407

如果你想用它来摆弄应用程序而不每次都打扰服务器，你可以把它放到主项目中，并用一些常量来停用它以进行部署，例如

```
if (DEBUG) {
    setDataProvider(new MockDataProvider());
} 
```

如果你记得重置你的变量，Proguard 应该足够聪明，可以删除这个未使用的类（你可能不得不摆弄那里的设置）。

# ipad - 带有固定顶部菜单栏和正文的平板电脑或智能设备缩放网页 - 看起来很糟糕

> ID：13943622
> 
> 赞同：-1
> 
> 时间：2012-12-19T00:15:21.217
> 
> 标签：ipad, zooming, tablet, smartphone, css-position

真的坚持这个：

我有一个静态页面，顶部有一个固定菜单栏，z-index 较高。页面主体是菜单栏下方较低的 z-index。

当我在智能手机或平板电脑上查看此页面时，我用手指分别缩放顶部菜单栏和正文缩放，这对客户来说非常烦人。当有人在智能平板电脑或设备上用手指缩放时，我可以将页面一起缩放（顶部菜单栏和正文）吗？这是页面：

[www.givemehop​​e.com/test.htm](http://www.givemehope.com/test.htm)

主体在顶部菜单栏下方正确流动，但我需要让两个元素在智能手机或 ipad 上一起缩放？

谢谢您的帮助。

埃里克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T19:04:46.043

我一直在努力解决这个基本上固定菜单在放大时不起作用。我认为可以在缩放时更改菜单的类，以便当用户放大菜单时变为静态或绝对100% 变得固定。幸运的是，有人能够帮助我查看下面的小提琴。希望这可以帮助。

[在页面缩放上添加类。100% 时删除](https://stackoverflow.com/questions/14459331/add-class-on-page-zoom-remove-when-100/14459628#14459628)

您可以使用此插件来检测缩放[https://github.com/yonran/detect-zoom](https://github.com/yonran/detect-zoom)然后将其添加到您的页面。

```
var zoomLevel = document.getElementById('zoom-level');
window.onresize = function onresize() {

zoom = DetectZoom.zoom();

$('.navbar').text(zoom);

$(".navbar").removeClass("zoomed");

if(zoom > 1)
 $(".navbar").addClass("zoomed in");

if(zoom < 1)
$(".navbar").addClass("zoomed out");    

}
onresize(); 
```

[http://jsfiddle.net/JsEPq/](http://jsfiddle.net/JsEPq/)

# url - 使用 web.confg 重写 URL

> ID：13943642
> 
> 赞同：0
> 
> 时间：2012-12-19T00:17:22.497
> 
> 标签：url, url-rewriting, web-config

这就是我试图使用 web.config 来实现的（我当前的 web.config 用于强制非 www 仍然需要）

该站点最初托管在一个子文件夹下，我们现在将其移至根目录。这就是我现在想要实现的目标：

旧网址示例： mysite.com/subfolder/prodView.asp?idproduct=1312&idCategory=44 应该被重定向到 mysite.com/prodView.asp?idproduct=1312&idCategory=44 （我们需要摆脱旧的子文件夹）

这将是必要的，因为许多客户已经在他们的浏览器中保存了产品链接，而且我们在 twitter 和 facebook 上发布了 1000 个链接，这些链接都包含其中的子文件夹。

任何帮助将不胜感激。

```
Current web.config
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
<system.webServer>
<rewrite>
<rules>
<rule name="Remove WWW prefix" stopProcessing="false">
<match url="(.*)" ignoreCase="true" />
<conditions>
<add input="{HTTP_HOST}" pattern="^www\.mysite\.com$" />
</conditions>
<action type="Redirect" url="http://mysite.com/{R:1}" redirectType="Permanent" />
</rule>
</rules>
</rewrite>
</system.webServer>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T11:51:57.510

将以下规则添加到现有规则中：

```
<rule name="Redirect old subfolder links" stopProcessing="false">
  <match url="^subfolder/(.+)" ignoreCase="true" />
  <action type="Redirect" url="/{R:1}" appendQueryString="true" redirectType="Permanent" />
</rule> 
```

# c++ - 当我在 C++ 中获得向量的索引时，它总是返回最后一个被推送的值

> ID：13943643
> 
> 赞同：1
> 
> 时间：2012-12-19T00:17:22.707
> 
> 标签：c++, random, vector, indexing, push-back

我创建了一个全局向量。之后，我使用 push_back 函数添加值。但是，当我想获取向量的任意索引时，它总是返回被推送的最后一个值。代码如下：

```
struct Choromosome{
    float fitness;
    float selectionProb;
    bool isSelected;
    int conflictNum;
    int* geneCode;
};
int SIZE = 6;
int START_SIZE = 50;
vector<Choromosome> population;

void initialize(){
  for(int k = 0; k < START_SIZE; k++){
     Choromosome c;
     int* code = new int[SIZE];
     srand(time(NULL));
     for(int i = 0; i < SIZE; i++){
        code[i] = rand() % SIZE;
     }
     c.geneCode = code;
     population.push_back(c);
  }
  int rand1 = rand() % START_SIZE;
  int rand2 = rand() % START_SIZE;     
  std::ostream_iterator< int > output( cout, " " );
  std::copy( population[rand1].geneCode, population[rand1].geneCode+ SIZE, output );
  std::copy( population[rand2].geneCode, population[rand2].geneCode+ SIZE, output );
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T00:27:57.677

问题是您`srand(time(NULL));`每次迭代都在播种。

如果您检查生成的数字，您会发现它们对于每个`Chromosome`.

您要么必须取消它`for`，`srand()`要么给它一个当前时间参数。

# c++ - CORBA 文件在 Visual C++ 6.0 中未解析的引用

> ID：13943644
> 
> 赞同：0
> 
> 时间：2012-12-19T00:17:31.653
> 
> 标签：c++, linker, corba

如果我有一个`server.idl`生成`server.hh`和`server.cc`. 我将它们都添加到 Visual C++ 6.0 项目中。对于在 中声明和定义`unresolved external symbol`的函数，我收到链接错误。我从未使用过 Visual C++ 6.0，所以我的问题是除了将文件包含在文件夹中之外，我还需要为链接器获取文件做些什么吗？也许沿着将文件所在的文件夹包含到项目的某个地方？`server.hh``server.cc``server.cc``Included Source Files`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:29:35.957

您必须`server.cc`像在任何较新版本中一样添加到您的项目中，或者使用`#include`将其拉入另一个已编译的文件中（可能是不好的做法）。除此之外，如果没有看到实际来源，很难猜测。您仍然为此使用 Visual C++ 6.0 有什么具体原因吗？

# c# - MonoTouch 6.0.8 发行说明中的 “运行时蹦床”是什么意思？

> ID：13943645
> 
> 赞同：7
> 
> 时间：2012-12-19T00:17:35.460
> 
> 标签：c#, xamarin.ios, xamarin, trampolines

[MonoTouch 6.0.8 发行说明](http://docs.xamarin.com/ios/releases/MonoTouch_6/MonoTouch_6.0#MonoTouch_6.0.8)说：

> **运行时蹦床：**不再需要在 Mono 运行时手动管理蹦床，蹦床现在是动态处理的。

这是什么意思？无论如何，您如何手动管理蹦床？
当你知道你可能会用完蹦床时，你还需要添加编译器标志吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T00:39:46.163

这意味着正如发行说明所说，Monotouch 现在计算出要分配多少蹦床。

要添加更多蹦床，请添加编译器标志，例如：

```
-aot "nrgctx-trampolines=4096" -aot "nimt-trampolines=4096" -aot "ntrampolines=4096" 
```

通常，当您用完蹦床时，意味着您使用了很多泛型和接口，很难计算需要提前分配多少内存 (aot)。所以 Xamarin 一定找到了一种神奇的方法来进行这种计算并相应地分配蹦床。我找不到有关此的更多信息。

在这个线程中有更多关于蹦床的一般信息：[http](http://forums.xamarin.com/discussion/503/trampolines-cost) ://forums.xamarin.com/discussion/503/trampolines-cost和这个线程之前的另一个线程：http: [//lists.ximian.com /pipermail/monotouch/2012-March/008800.html](http://lists.ximian.com/pipermail/monotouch/2012-March/008800.html)

# c# - 将 DropDownListFor 与原始类型列表一起使用的正确方法？

> ID：13943649
> 
> 赞同：10
> 
> 时间：2012-12-19T00:17:56.650
> 
> 标签：c#, asp.net-mvc-3, razor

这是相关的代码。请注意，我是在 Notepad++ 中完成的，而不是在工作中为我的项目复制代码。如果我在其中拼错了一个类名，假设它在我的代码中没有拼错。没有编译错误。

模型：

```
public class MyViewModel
{
    public int SelectedSomething { get; set; }

    public IList<int> Somethings { get; set; }
} 
```

控制器：

```
public class MyController
{
    public ActionResult Index()
    {
        var viewModel = new MyViewModel();
        viewModel.Somethings = Enumerable.Range(1, 12).ToList();
        return View(viewModel);
    }
} 
```

查看（剃刀）：

```
@Html.DropDownListFor(x => x.SelectedSomething, new SelectList(Model.Somethings, Model.SelectedSomething), "Select an Option") 
```

这将“起作用”，但不会在以下任何渲染`option`元素上设置值`select`：

```
<select>
    <option value="">Select an Option</option>
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
    <option>6</option>
    <option>7</option>
    <option>8</option>
    <option>9</option>
    <option>10</option>
    <option>11</option>
    <option>12</option>
</select> 
```

*我*知道[`SelectList`构造函数](http://msdn.microsoft.com/en-us/library/dd505286%28v=vs.100%29.aspx)接受用于在元素中呈现`value`and的属性名称，但是当使用原始类型的集合（如.`text``option`*`int`*

 *问题：

我知道我可以将我的视图模型更改`IList<int>`为`IList<SelectListItem>`，并创建`SelectListItem`对象来表示每个`int`，但这似乎有点荒谬（因为我认为构造函数不应该将值留空，并且应该默认使用文本）。我是否在这里遗漏了一些明显的东西，或者我将不得不在这里放弃使用原始类型？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:30:56.877

我使用扩展方法解决了这个问题，允许您在视图中编写：

```
@Html.DropDownListFor(x => x.SelectedSomething, 
                      Model.Somethings.ToSelectList(n => n, v => v), 
                      "Select an Option") 
```

对于 int 集合，您可能需要将其`n => n.ToString()`用作名称选择器。

这种方法的美妙之处在于您可以将它用于任何类型的可枚举。在您的示例中（带有整数列表），我们只需指定返回元素本身的 lambda，这将导致文本和值在呈现的选项列表中设置为相同的值。

如果您想避免在 Web.config 中导入扩展类的命名空间，请在返回 SelectList 的 ViewModel 上声明一个只读属性，然后从您的视图中访问它。

Web.config 部分看起来像这样（请注意，您需要为程序集和命名空间创建一行）。另请注意，您的 Views 文件夹包含一个单独的 Web.config，它可能会覆盖或扩展您的根 Web.config 中的定义。

```
<system.web>
    <compilation debug="true" targetFramework="4.0" batch="true">
        <assemblies>
            <add assembly="My.Web.Stuff" />
        </assemblies>
    </compilation>
    <pages>
        <namespaces>
            <add namespace="My.Web.Stuff.Extensions" />
        </namespaces>
    </pages>
</system.web> 
```

这是扩展方法的实现：

```
/// <summary>
///   Extension methods on IEnumerable.
/// </summary>
public static class SelectListExtensions
{
    /// <summary>
    ///   Converts the source sequence into an IEnumerable of SelectListItem
    /// </summary>
    /// <param name = "items">Source sequence</param>
    /// <param name = "nameSelector">Lambda that specifies the name for the SelectList items</param>
    /// <param name = "valueSelector">Lambda that specifies the value for the SelectList items</param>
    /// <returns>IEnumerable of SelectListItem</returns>
    public static IEnumerable<SelectListItem> ToSelectList<TItem, TValue>( this IEnumerable<TItem> items, Func<TItem, TValue> valueSelector, Func<TItem, string> nameSelector )
    {
        return items.ToSelectList( valueSelector, nameSelector, x => false );
    }

    /// <summary>
    ///   Converts the source sequence into an IEnumerable of SelectListItem
    /// </summary>
    /// <param name = "items">Source sequence</param>
    /// <param name = "nameSelector">Lambda that specifies the name for the SelectList items</param>
    /// <param name = "valueSelector">Lambda that specifies the value for the SelectList items</param>
    /// <param name = "selectedItems">Those items that should be selected</param>
    /// <returns>IEnumerable of SelectListItem</returns>
    public static IEnumerable<SelectListItem> ToSelectList<TItem, TValue>( this IEnumerable<TItem> items, Func<TItem, TValue> valueSelector, Func<TItem, string> nameSelector, IEnumerable<TValue> selectedItems )
    {
        return items.ToSelectList( valueSelector, nameSelector, x => selectedItems != null && selectedItems.Contains( valueSelector( x ) ) );
    }

    /// <summary>
    ///   Converts the source sequence into an IEnumerable of SelectListItem
    /// </summary>
    /// <param name = "items">Source sequence</param>
    /// <param name = "nameSelector">Lambda that specifies the name for the SelectList items</param>
    /// <param name = "valueSelector">Lambda that specifies the value for the SelectList items</param>
    /// <param name = "selectedValueSelector">Lambda that specifies whether the item should be selected</param>
    /// <returns>IEnumerable of SelectListItem</returns>
    public static IEnumerable<SelectListItem> ToSelectList<TItem, TValue>( this IEnumerable<TItem> items, Func<TItem, TValue> valueSelector, Func<TItem, string> nameSelector, Func<TItem, bool> selectedValueSelector )
    {
        return from item in items
               let value = valueSelector( item )
               select new SelectListItem
                      {
                        Text = nameSelector( item ),
                        Value = value.ToString(),
                        Selected = selectedValueSelector( item )
                      };
    }
} 
```*

# objective-c - 分配数组的长度

> ID：13943652
> 
> 赞同：2
> 
> 时间：2012-12-19T00:18:33.897
> 
> 标签：objective-c

我有这个objective-c 代码，但我找不到分配数组的大小。

```
NSArray *myArray = [[NSArray alloc] initWithObjects:@"Apple", @"Orange", @"Banana",      @"Plum", nil];
[myArray objectAtIndex: 0];
[myArray length]; 
```

XCode 给我这个错误：

““NSArray”没有可见的@interface 声明选择器长度”

这会是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:23:08.877

什么是长度？如果要查找数组中的对象数，请使用：

```
[myArray count]; 
```

如果您想查找尺寸，请查看此链接：

[Objective C中数组的长度](https://stackoverflow.com/questions/1530050/length-of-an-array-in-objective-c)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:37:30.233

@Sedate Alien 是对的。`[myArray count]`或者`myArray.count`是获得长度的方法。

看起来您可能缺少一些简单的东西，例如包含`NSArray`...`#import <Foundation/Foundation.h>`

大致： ( `Project->Build Phases->Link Binary With Libraries... -> "+" button->Foundation`)

# node.js - 如何在节点中通过 HTTP 读取二进制文件？

> ID：13943653
> 
> 赞同：5
> 
> 时间：2012-12-19T00:18:48.793
> 
> 标签：node.js, http

我在网络服务器 (http://example.com/img.jpg) 上有一张图片。我在浏览器中打开该图像并将其保存到磁盘。

`fs`如果我通过“ ”模块（ ）在节点中打开文件`fs.readFileSync`，我会得到一个以 0xff 开头的缓冲区，这是我所期望的。

我希望能够直接从 HTTP 请求中获得相同的结果。我正在使用“请求”模块发出请求。

```
request('http://example.com/img.jpg',function(error, response, body){
  //code here
}); 
```

我不知道如何将响应或正文转换为从文件系统获得的等效缓冲区。我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T00:46:51.350

您可以`Buffer`通过将 to 设置[`encoding`](https://github.com/mikeal/request#requestoptions-callback)为`null`：

```
request('http://example.com/img.jpg', { encoding: null }, function(error, response, body){
  console.log(Buffer.isBuffer(body)); // true
}); 
```

`request`将任何其他值[视为 的参数](https://github.com/mikeal/request/blob/d734337ad821894428fa0eabf65d0e88697dd4a2/main.js#L650-L654)，[`buffer.toString()`](http://nodejs.org/api/buffer.html#buffer_buf_tostring_encoding_start_end)默认`undefined`为`"utf8"`.

# java - 如何在 JavaFX 中创建单例 MainClass？

> ID：13943654
> 
> 赞同：1
> 
> 时间：2012-12-19T00:18:48.857
> 
> 标签：java, singleton, javafx-2

我想在[JavaFX中创建一个](http://docs.oracle.com/javafx/index.html)[Singleton](http://en.wikipedia.org/wiki/Singleton_pattern)主类，但我遇到了困难，因为主类必须扩展[Application](http://docs.oracle.com/javafx/2/api/javafx/application/Application.html)，所以构造函数不能是私有的。

我希望主类是单例，因为我想从任何类访问几个实例方法。

在我当前的代码中，我将主类用作假单例，因为我不保证不会在代码的某些部分再次实例化该类。

我想知道当您不能使用私有构造函数时是否有一种体面的方法来创建单例。

这是我的主要课程的代码：

```
public final class MainClass extends Application {
    private static MainClass instance;
    private Stage primaryStage, optionsStage;

    @Override
    public void start(final Stage primaryStage) {
        instance = this;
        try {

            // Main scene.
            {
                Parent page = (Parent) FXMLLoader.load(
                        MainWindowController.class.getResource("main.fxml"));
                Scene mainScene = new Scene(page);
                primaryStage.setScene(mainScene);
                primaryStage.show();
            }

            // Options scene.
            {
                optionsStage = new Stage();
                optionsStage.setTitle("Options");
                optionsStage.setResizable(false);
                optionsStage.initModality(Modality.APPLICATION_MODAL);
                optionsStage.initOwner(primaryStage);

                Parent page = (Parent) FXMLLoader.load(
                        OptionsWindowController.class.getResource("options.fxml"));
                Scene scene = new Scene(page);
                optionsStage.setScene(scene);
            }

        } catch (Exception ex) {
            Constants.LOGGER.log(Level.SEVERE, ex.toString());
        }
    }

    /**
     * Returns the instance of this class.
     * @return
     */
    public static MainClass getInstance() {
        return instance;
    }

    public Stage getPrimaryStage() {
        return primaryStage;
    }

    /**
     * Returns the options stage.
     * @return
     */
    public Stage getOptionsStage() {
        return optionsStage;
    }

    /**
     * The main() method is ignored in correctly deployed JavaFX
     * application. main() serves only as fallback in case the
     * application can not be launched through deployment artifacts,
     * e.g., in IDEs with limited FX support. NetBeans ignores main().
     * @param args the command line arguments
     */
    public static void main(String[] args) {
        launch(args);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T00:47:17.980

我认为添加如下所示的公共构造函数并删除方法中的`instance = this;`赋值`start`就可以了，尽管我并不精通 JavaFX。我*认为*它不会多次尝试实例化你的主类，但如果 API 没有做出这样的保证，你可能会在以后遇到麻烦。

无论如何...如果您执行以下操作，您会很快发现：

```
public MainClass(){
    super();
    synchronized(MainClass.class){
        if(instance != null) throw new UnsupportedOperationException(
                getClass()+" is singleton but constructor called more than once");
        instance = this;
    }
} 
```

NetBeans 的编译器（如果您正在使用它）会抱怨“泄漏`this`”，但这将保证您不会多次运行构造函数来完成。

# php - 为什么 echo 在 do while 循环中甚至在 ignore_user_abort(1) 中都不起作用？

> ID：13943658
> 
> 赞同：4
> 
> 时间：2012-12-19T00:19:17.230
> 
> 标签：php, loops, while-loop, do-while, abort

我使用日志打印机来测试 ignore_user_abort 是否有效，它确实有效。然而，回声不想工作。回声是否仅在循环完成时才起作用？

```
<?php
ignore_user_abort(1); // run script in background 
set_time_limit(0); // run script forever 
$interval=2; // do every 2 sec... 
$i=0;
 $lastRunLog = 'lastrun.log';
do{ 
   // add the script that has to be ran every 2 sec here 
   // ... 
   echo 'Test: '.$i;

   file_put_contents($lastRunLog, time());

   sleep($interval); // wait 2 sec 
   $i=$i+1;
}while(true); 
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:28:05.890

是的，没有。

您需要担心三个输出缓冲区：

1.  PHP 可以缓冲输出。您可以使用[ob_ 函数](http://php.net/manual/en/ref.outcontrol.php)来控制该缓冲区并强制输出到 apache/iis（Web 服务器）
2.  Apache/IIS 有自己的缓冲区，只有当他们认为有足够的信息可以发送时才会发送信息。这也与 mod_gzip 或其他压缩相结合。你不能通过 PHP 来控制它。
3.  您的浏览器和服务器之间还可能存在其他缓存/代理。这些可能会保持输出，直到它收到完整的响应。

因此，echo 立即放入 PHP 缓冲区。您可以将缓冲区发送到网络服务器，但之后它就无法控制了。

# java - 生产者 - 消费者队列，能够将项目移动到前面

> ID：13943662
> 
> 赞同：1
> 
> 时间：2012-12-19T00:19:45.523
> 
> 标签：java, android, concurrency

我使用 Java 的 LinkedBlockingDeque 实现了生产者-消费者模式，但是我遇到了一个问题，我有时想将一个项目（已经在队列中的某个位置）移动到队列的前面，所以它被更快地处理。我永远不知道哪些已经排队的项目适合移到前面。因此，我希望将 LinkedBlockingDeque 替换为可以重新排序项目的东西。我有一个生产者和 2-4 个消费者（自定义线程实现），我在 Android 平台上。我怎样才能做到这一点？一些阻塞的双连接链表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T10:48:18.987

从我的评论：

您可以使用`remove(Object o)`检索对象并将其从队列中删除，然后使用`addFirst(Object o)`将其添加到队列的前面。这将具有优先考虑该对象的效果。

您使用迭代器来检查 Deque 中的对象。但是要非常小心，`ConcurrentModificationException`因为如果您在一个线程中访问集合并在另一个线程中对其进行修改，则可能会引发它们，但是如果您使用的是阻塞队列，这应该不是问题。

来自[BlockingQueue](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/BlockingQueue.html) Javadoc：

> BlockingQueue 实现是线程安全的。所有排队方法都使用内部锁或其他形式的并发控制以原子方式实现其效果。然而，批量收集操作 addAll、containAll、retainAll 和 removeAll 不一定以原子方式执行，除非在实现中另外指定。因此，例如，addAll(c) 在仅添加 c 中的一些元素后可能会失败（抛出异常）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-19T00:28:03.527

看看[PriorityBlockingQueue](http://developer.android.com/reference/java/util/concurrent/PriorityBlockingQueue.html)。它可能会满足您的需求。您可以插入具有名义优先级的项目，然后当您想要调整某些元素的优先级时，将其从队列中删除并重新添加新的优先级。

# jquery - 通过控制器/动作路由请求或从 jquery 直接路由到 WebAPI

> ID：13943663
> 
> 赞同：2
> 
> 时间：2012-12-19T00:20:10.677
> 
> 标签：jquery, asp.net-mvc, asp.net-web-api

我们有一个 Api，它在每个请求上都需要一个“Api-Key”，在所有经过身份验证的请求上都需要一个用户“AccessToken”。目前，当用户进行登录时，他们会返回一个“AccessToken”，该“AccessToken”将从那里随每个请求一起发送出去。

我的问题涉及我们当前使用此 API 的网站的工作流程。注意 - 网站和 Api 位于不同的解决方案/应用程序域中，目前它们在同一个盒子上，但后来我怀疑它们会是。

目前，该网站将通过其 MVC 控制器/操作方法向 Api 发出所有请求。起初，我认为这是启动并运行它的最简单方法，而无需编写大量 jquery 来完成客户端的所有请求。此外，服务器知道它的 Api-Key 并使用存储了 AccessToken 的表单身份验证。

我想我们都知道，如果我跳过网络服务器，直接从 Jquery 转到 WebApi，它会更快，但是，在我对这个过程的初步审查中，我遇到了一个关于身份验证的障碍。

最后是问题:)

> 我知道我可以在 ajax 中使用 before send 并修改标头，但是，1 如何将 accesstoken 和网站 API-Key 安全地发送到客户端以将其发送到网络上？
> 
> 如果我错了，请告诉我，但如果我使用 Razor 并使用 ViewData / ViewBag 并将其转换为视图中的 javascript，那么 AccessToken 和 Api-Key 肯定会坐在那里让全世界看到它们何时执行视图源？

**当前的**

```
Jquery -->  MVC Action -->  WebApi 
```

**快点**

```
Jquery -->  WebApi 
```

我注意到大多数 Api Wrapper 都是在 MVC 控制器/动作中使用的，因此我实际上认为我这样做的方式可能是正确的方式？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T04:37:39.110

如果您需要对您的 API 密钥保密，那么您应该**将其远离客户端**。

我认为您应该保持原样代理事物。如果您需要保护从客户端到服务器的通信，请这样做，但不要将您的 API 密钥直接暴露给客户端。

如果访问令牌仅持续一小段时间，并且您的 API 提供的方法不需要高度安全性，那么您可以简单地使用访问令牌公开它们，并在服务器上隐藏您的 API 密钥。

无论哪种方式，我认为您都是在代理。只是一个问题，您希望保护从客户端到服务器的通信的安全程度。然后可以按原样或您认为合适的其他方式实现从服务器到 API。

除此之外，我建议让你的控制器尽可能地笨拙。让他们首当其冲地把跑腿的工作交给进行 API 调用的服务层。

# javascript - javascript 中的 bg 颜色、悬停、!important 和 .css

> ID：13943664
> 
> 赞同：5
> 
> 时间：2012-12-19T00:20:14.223
> 
> 标签：javascript, jquery, css

我遇到了一个问题。我创建了一些“标签”功能，如演示中所示：http: [//jsfiddle.net/4FLCe/](http://jsfiddle.net/4FLCe/)

计划是，当您将鼠标悬停在选项卡上时，其颜色变为颜色 A，当您单击选项卡时，其颜色变为颜色 B。

从演示中可以看出，单击后背景颜色在悬停时停止变化。我想添加`!important`悬停的背景颜色，结果可以看到：http: [//jsfiddle.net/4FLCe/1/](http://jsfiddle.net/4FLCe/1/)

但这并没有按照我的意愿执行，现在将鼠标悬停在从 javascript 设置的背景颜色上。然后我添加`!important`到javascript中的颜色集。这导致了一些可怕的事情。唯一能理解我想要实现的浏览器是 Opera。

其他浏览器刚刚停止从 js 应用一个。演示：http: [//jsfiddle.net/4FLCe/2/](http://jsfiddle.net/4FLCe/2/)

**所以问题是**：如何实现下一个工作悬停，所选选项卡的背景具有比悬停更高的“优先级”，因此它不会更改为悬停时悬停的背景，并且在 ie、safari、opera、chrome、ff 中的结果相同?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T00:28:59.670

您应该使用 a`class`而不是通过`.css()`方法设置它..

所以创建

```
.selected-tab{
    background-color:#d6d6d6!important;
} 
```

并将您的代码更改为

```
$(function() {  
    $('.pagecontent').eq(0).show();
    $('.tab').click(function() {  
        $('.pagecontent').hide();
        $('.selected-tab').removeClass('selected-tab');
        $(this).addClass('selected-tab');
        $('.pagecontent').eq($(this).index()).show();
    });  
}); 
```

演示在[http://jsfiddle.net/gaby/4FLCe/3/](http://jsfiddle.net/gaby/4FLCe/3/)

# c++ - 如何禁用 Windows 上的调试断言对话框？

> ID：13943665
> 
> 赞同：20
> 
> 时间：2012-12-19T00:20:19.107
> 
> 标签：c++, visual-studio, winapi

我有一堆以批处理模式运行的单元测试。有时，会因 Visual C++ 库中触发的调试断言而崩溃。这会导致弹出一个对话框，并且单元测试停止运行，直到我单击“确定”关闭对话框。

如何让 C++ 程序在遇到断言时崩溃（就像在 Linux 上一样），而不是弹出烦人的对话框？

注意：我不想禁用断言；只是对话框。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-19T00:29:44.740

查看 _CrtSetReportHook()：

[http://msdn.microsoft.com/en-us/library/0yysf5e6.aspx](http://msdn.microsoft.com/en-us/library/0yysf5e6.aspx)

MSDN 将其宣传为应用程序处理 CRT 运行时故障（如断言）的一种稳健方式。大概您可以定义一个转储您的进程的报告挂钩：

[崩溃时如何为我的进程创建小型转储？](https://stackoverflow.com/questions/1547211/how-to-create-minidump-for-my-process-when-it-crashes)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-07-24T12:58:40.480

此代码将禁用对话框的显示。相反，它将在输出窗口和 stderr 中打印错误。

```
int main( int argc, char **argv )
{
     if( !IsDebuggerPresent() )
     {
          _CrtSetReportMode( _CRT_ASSERT, _CRTDBG_MODE_FILE | _CRTDBG_MODE_DEBUG );
          _CrtSetReportFile( _CRT_ASSERT, _CRTDBG_FILE_STDERR );
     }

     ...
} 
```

`_CRT_ERROR`如果您`Q_ASSERT`从`Qt`库中使用，则必须申请相同的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-16T14:10:22.953

我将合适的钩子的代码（您可以使用 _CrtSetReportHook() 安装）放在：[https ://stackoverflow.com/a/28852798/2345997](https://stackoverflow.com/a/28852798/2345997)

# java - 自定义 JPanel 导致异常 GridBagConstraint 布局行为

> ID：13943667
> 
> 赞同：3
> 
> 时间：2012-12-19T00:20:25.367
> 
> 标签：java, swing, jpanel, layout-manager, gridbaglayout

我正在开发一个简单的图像编辑程序来调整亮度/对比度。我的自定义 JPanel 仅用于显示加载的图像，但它导致下一列上的滑块和标签显示不正确。

```
import java.awt.*;
import javax.swing.*;

public class IMView extends JFrame  implements Observer {

JButton selectIMGFolder = new JButton("Select Folder");
ImagePanel originalImage;
//Labels and sliders to control image
JLabel brightnessLabel = new JLabel("Brightness");
JSlider brightness = new JSlider(-255,255,0);
JLabel contrastLabel = new JLabel("Contrast");
JSlider contrastSlider = new JSlider(-255,255,0);

JLabel random = new JLabel("Random Test Label");

public IMView (){
    super("Image manipulation");

    JPanel mainJPanel = new JPanel();
    mainJPanel.setLayout(new GridBagLayout());

    GridBagConstraints gc = new GridBagConstraints();

    originalImage = new ImagePanel();
    //first column

    gc.anchor = GridBagConstraints.LINE_START;
    gc.weightx = 0.5;
    gc.weighty = 0.5;

    gc.gridx = 0;
    gc.gridy = 0;
    mainJPanel.add(selectIMGFolder, gc);

    gc.gridx = 0;
    gc.gridy = 1;

    mainJPanel.add(originalImage, gc);

    gc.gridx = 0;
    gc.gridy = 2;
    mainJPanel.add(random, gc);

    //second column
    //brightness

    gc.gridx = 1;
    gc.gridy = 0;

    mainJPanel.add(brightnessLabel, gc);

    gc.gridx = 1;
    gc.gridy = 1;
    mainJPanel.add(brightness, gc);

    gc.gridx = 1;
    gc.gridy = 2;
    mainJPanel.add(contrastLabel, gc);

    gc.weighty = 10;
    gc.anchor = GridBagConstraints.FIRST_LINE_START;
    gc.gridx = 1;
    gc.gridy = 3;       
    mainJPanel.add(contrastSlider, gc);

    this.add(mainJPanel);
    this.setVisible(true);
    this.setPreferredSize(new Dimension(800, 600));
    this.pack();
    this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
}

//other code
} 
```

这是我的简单自定义面板：

```
public class ImagePanel extends JPanel {

Image image;

public ImagePanel(){
    this.setPreferredSize(new Dimension(400,300));

}   

//set image file some where

@Override
public void paintComponent(Graphics g){
    super.paintComponents(g);
    g.setColor(Color.red);
    g.fillRect(0, 0, 400,300);
    if(image != null){
         g.drawImage(image, 0,0, this);
    }

}

} 
```

下面是代码的结果（其中红色方块代表图像），我基本上希望将右侧的滑块和标签打包在一起。如果我不向其中添加自定义面板，`mainJPanel`它似乎看起来像我想要的那样。

![在此处输入图像描述](../Images/a643a9ec8cc74c5efb4c20bae70f0381.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:05:00.057

`GridBagLayout`足够复杂，无需在单个容器中布置所有内容。将您的表单分解为责任区域并使用单独的容器。

![在此处输入图像描述](../Images/adce7ceb47aac13423f514a804d1e830.png)

```
public class BadLayout08 {

    public static void main(String[] args) {
        new BadLayout08();
    }

    public BadLayout08() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new IMView();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class IMView extends JFrame {

        JButton selectIMGFolder = new JButton("Select Folder");
        JPanel originalImage;
//Labels and sliders to control image
        JLabel brightnessLabel = new JLabel("Brightness");
        JSlider brightness = new JSlider(-255, 255, 0);
        JLabel contrastLabel = new JLabel("Contrast");
        JSlider contrastSlider = new JSlider(-255, 255, 0);
        JLabel random = new JLabel("Random Test Label");

        public IMView() {
            super("Image manipulation");

            JPanel mainJPanel = new JPanel();
            mainJPanel.setLayout(new GridBagLayout());

            GridBagConstraints gc = new GridBagConstraints();

            originalImage = new JPanel();
            originalImage.setPreferredSize(new Dimension(400, 300));
            originalImage.setBackground(Color.RED);
            //first column

            gc.anchor = GridBagConstraints.LINE_START;

            gc.gridx = 0;
            gc.gridy = 0;
            mainJPanel.add(selectIMGFolder, gc);

            gc = new GridBagConstraints();
            gc.anchor = GridBagConstraints.LINE_START;
            gc.gridx = 0;
            gc.gridy = 1;
            mainJPanel.add(originalImage, gc);

            gc = new GridBagConstraints();
            gc.gridx = 0;
            gc.gridy = 2;
            mainJPanel.add(random, gc);

            //second column
            //brightness

            JPanel sidePane = new JPanel(new GridBagLayout());
            gc = new GridBagConstraints();

            gc.gridx = 1;
            gc.gridy = 0;

            sidePane.add(brightnessLabel, gc);

            gc.gridx = 1;
            gc.gridy = 1;
            sidePane.add(brightness, gc);

            gc.gridx = 1;
            gc.gridy = 2;
            sidePane.add(contrastLabel, gc);

            gc.weighty = 10;
            gc.anchor = GridBagConstraints.FIRST_LINE_START;
            gc.gridx = 1;
            gc.gridy = 3;
            sidePane.add(contrastSlider, gc);

            gc = new GridBagConstraints();
            gc.gridx = 1;
            gc.gridy = 1;
            gc.gridheight = GridBagConstraints.REMAINDER;
            gc.anchor = GridBagConstraints.NORTH;
            mainJPanel.add(sidePane, gc);

            this.add(mainJPanel);
            this.setVisible(true);
            this.setPreferredSize(new Dimension(800, 600));
            this.pack();
            this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        }
//other code
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T10:35:11.613

在这种情况下，您可以使用 BorderLayout。红色面板需要最大水平和垂直拉伸。所有其他组件都可以在红色面板上推到它们的最小尺寸。

如果您需要使用 GridBagLayout，请参阅： [http ://blue-walrus.com/?p=582](http://blue-walrus.com/?p=582)

# c++ - 从二进制文件中读取文本时避免 \r\n

> ID：13943669
> 
> 赞同：0
> 
> 时间：2012-12-19T00:20:29.127
> 
> 标签：c++

我有一个打包大量文件的二进制文件（类似于 .tar），我可以在其中找到二进制文件和文本文件。

在内存字符串中处理时，回车行通常是**'\n'**，但如果我从这个打包文件中读取文本部分，我会得到**"\r\n"**。因此，处理此文本会给我带来错误。

下面是从二进制文件中读取文本的代码：

```
FILE* _fileDescriptor;                        // it's always open to improve performance
fopen_s(&_fileDescriptor, _filePath.string().c_str(), "rb"); 

char* data = new char[size + 1];              // size is a known and correct value
fseek(_fileDescriptor, begin, SEEK_SET);      // begin is another known value, where the file starts inside the packed one
fread(data, sizeof(char), size, _fileDescriptor);
data[it->second.size] = '\0'; 
```

这给了我正确的文本到**data**，但是下面的代码在读取空行时给了我错误：

```
istringstream ss(data);      // create a stringstream to process it in another function
delete[] data;               // free the data buffer

// start processing the file
string line;
getline(infile, line);       // read an empty line

if(line.size() > 0) {
    /*
     enters here, because the "empty" line was "\r\n", and now the value of line is '\r', therefore line.size() == 1
    */
    ... 
```

那么，有什么建议可以避免使用“\r”吗？

我在记事本++上编辑了它。将其配置更改为使用 '\n' 而不是 '\r\n' 作为换行符，但我不想依赖这个，因为其他人可能会错过它，如果那个会发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:23:56.013

可能最容易从字符串中修剪 '\r' 字符，然后丢弃空行。有关修剪 std::string 的方法，请参阅此答案（我假设这就是“行”）：

[修剪 std::string 的最佳方法是什么？](https://stackoverflow.com/questions/216823/whats-the-best-way-to-trim-stdstring)

# php - 在mysql语句中使用方括号构建数组

> ID：13943675
> 
> 赞同：3
> 
> 时间：2012-12-19T00:21:17.463
> 
> 标签：php, mysql, arrays

我正在尝试让 mysql 返回将由 php 解析为数组的列名。考虑一下：

```
$sql = "SELECT user.id AS `user[id]`, user.name AS `user[name]`,
            user_info.address AS `user[info][address]`
            user_info.zip AS `user[info][zip]`
        FROM user JOIN user_info ON user.id = user_info.id";
$stmt = $conn->query($sql);
$results = $stmt->fetchAll(); 
```

我想`$results`看起来像这样：

```
array(
    [0] => array(
        [id] => 2,
        [name] => 'john',
        [info] => array(
            [address] => '1234 Main st',
            [zip] => 12345
        )
    )
    [1] => array(
        [id] => 3,
        [name] => 'tom',
        [info] => array(
            [address] => '2811 Second Ave.',
            [zip] => 98765
        )
    )
) 
```

有没有办法在**不手动循环结果的情况下**做到这一点。我想要类似于 php 在表单提交中处理方括号的功能（例如`index.php?user[id]=2&user[name]=tom`）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:27:40.593

不，SQL 不能以这种方式工作，MySQL 库和它的 PHP 绑定都不支持这种方式。如果您想拥有与此类似的东西，那么您将需要一个真正的面向对象的数据库及其 PHP 绑定。

# java - 如何写入文本文件并将其保存以供多次使用

> ID：13943676
> 
> 赞同：3
> 
> 时间：2012-12-19T00:21:43.993
> 
> 标签：java, android, save

到目前为止，我已经在我的资产文件夹中创建了一个文本文件，我可以很好地阅读它并完成它应该做的事情。当我使用以下内容写信时：

```
 FileOutputStream fos = openFileOutput(FILENAME, Context.MODE_PRIVATE); 
 fos.write(("0").getBytes());
 fos.close() 
```

有用。但是，当我关闭我的应用程序并稍后重新打开它时，它不记得我将其更改为的任何内容。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:27:02.860

assets 或 raw 中的文件旨在为只读文件，因此将其复制到新位置（如 in `Environment.getDataDirectory()`），然后您应该能够对其进行写入。

* * *

我认为这会引发某种类型的异常你有一个空的 catch 块吗？至少你应该使用，`e.printStackTrack()`否则你的应用程序将默默地失败......

```
try {
    FileOutputStream fos = openFileOutput(FILENAME, Context.MODE_PRIVATE); 
    fos.write(("0").getBytes());
    fos.close();
} catch (Exception e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:42:37.420

我想你只是忘记在写完之后调用flush

```
FileOutputStream fos = openFileOutput(FILENAME, Context.MODE_PRIVATE); 
 fos.write(("0").getBytes());
 fos.flush();
 fos.close(); 
```

# ios - iOS AVFoundation 视频覆盖视频问题

> ID：13943678
> 
> 赞同：1
> 
> 时间：2012-12-19T00:21:52.290
> 
> 标签：ios, ios5, video, avfoundation, alpha

几天来，我一直在研究 avfoundation 框架。我可以成功地覆盖和定位 CALayers 和 mash，使用导出器会话导出最终视频。

我需要一个具有 alpha 透明度的视频在视频资产的持续时间内覆盖另一个视频。我根本无法让它工作。任何帮助都会摇滚！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:31:14.983

试试这个教程： [http ://www.sdkboy.com/?p=66](http://www.sdkboy.com/?p=66)

看起来您需要对 AVFoundation 播放器进行一些自定义，但可以做到。

# php - 将图像从 iPhone 发送到 Mysql 数据库

> ID：13943680
> 
> 赞同：0
> 
> 时间：2012-12-19T00:21:57.147
> 
> 标签：php, mysql, objective-c, xcode

我可以将字符串从我的应用程序发送到我的远程数据库！我能够将图像从数据库下载到我的应用程序并正确显示它们！但是，如果我想将图像从应用程序发送到我的数据库？我认为mysql期望一个blob格式......我正在尝试，但我认为这不是正确的方法

```
NSData* data = UIImagePNGRepresentation(theDataObject.immagineGestione);
[Base64 initialize];
NSString *strEncoded = [Base64 encode:data];

NSString *strURL = [NSString stringWithFormat:@"http://www.xxxxxx-xo.nxx/Scrxxts/Evxxto/WIGixxxnto.php?image=%@",strEncoded];

NSData* dataUrl = [NSData dataWithContentsOfURL:[NSURL URLWithString:strURL]]; 
```

我的 php 文件没有启动！

```
 $image = mysql_real_escape_string($_GET['image'], $database);

 $sql = "INSERT INTO annotazioni (immagine) values (file_get_contents($image))"

 mysql_query($sql); 
```

# php - 使用签名的 REST API 安全性，在哪里/如何存储密钥？

> ID：13943686
> 
> 赞同：3
> 
> 时间：2012-12-19T00:22:39.640
> 
> 标签：php, web-services, rest, security

我创建了一个 REST API 并实现了一个签名系统作为安全层，基本上它的工作原理是我有 API 用户使用只有用户和 API 知道的密钥（比如说密码）连接到 API，然后在会话打开后，API 返回一个 API 密钥，用于所有后续调用。

所有后续调用都将提供 API 密钥和不同请求参数的 sha256 哈希，哈希使用密钥创建。

到目前为止一切顺利，但是我面临一个问题，我有一个完整的 AJAX 客户端调用 API，但我不希望我的用户每次想要打开会话并获得一个新的 API 密钥（如果他们以前连接到 API）。

暂时，我使用 javascript 将密钥以纯文本形式存储在 cookie 中，但对我来说似乎是错误的。

你们也有建议或链接指向我吗？有什么我不明白的吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:28:56.937

在 API 上给他们一个散列租约。租约授予他们在一定时间内访问 API 的权限，该时间在令牌中指定。例如，接下来的 7 天可能会很好。您可以通过简单地将结束日期添加到您的令牌并对其进行签名来做到这一点。

当应用程序返回尝试并开始一个新会话时，它可以要求服务器给它一个新的租约，假设它们已经过身份验证，再过 7 天。

如果他们在 7 天后尝试访问服务器，则需要重新进行身份验证。

# wordpress - WordPress主题的致命错误

> ID：13943687
> 
> 赞同：0
> 
> 时间：2012-12-19T00:22:44.443
> 
> 标签：wordpress, themes, php

我刚刚重新安装了 WP 3.5，尝试使用 Padd Solutions 的 Uraniumoid 主题，然后繁荣，得到了致命错误

```
Call to undefined method Padd_Twitter::SimplePie() in on line in /home/fxmypics/public_html/wp-includes/class-simplepie.php on line 3042 
```

我调查并看到在文件夹中调用了“Padd_Twitter” ，但`class-twitter.php`我不知道如何修复它，有帮助吗？`defaults.php``functions.php``Uraniumoid\includes`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T20:15:17.550

对于那些找不到解决方案的人，这对我有用：

在文件 class-twitter.php 中：

*   将第 56 行的“ **$this->SimplePie();** ”替换为：“ **parent::__construct();** ”
*   大约在第 59 行，替换： **$this->set_feed_url('http://twitter.com/statuses/user_timeline/' . $username . '.rss');** 与：**$this->set_feed_url('http://api.twitter.com/1/statuses/user_timeline.rss?screen_name=' . $username . '');**

它对我有用

# asp.net-mvc-4 - SecurityQuestion DropDownList - 预定义项目

> ID：13943692
> 
> 赞同：0
> 
> 时间：2012-12-19T00:23:09.620
> 
> 标签：asp.net-mvc-4, html-select

我试图在“安全问题”的用户注册期间溺水。

`SecurityQuestion`我的 ViewModel 上的属性应该是一个字符串（只保存选定的问题）还是`IEnumerable<string>`保存整个问题列表？在后一种情况下，POSTed 的模型如何知道选择了哪个？

取决于哪个是更好的方法，显示 html 下拉列表并预先选择最顶部的项目的代码是什么（这是必填字段，因此不应选择“空白”）？

另外，我将使用 ajax 提交此表单。在前一种情况下，我可以使用`option:selected`选择器将所选问题附加到`string`模型上的 SecurityQuestion 属性中。但我不明白在后一种情况下它是如何工作的（`IEnumerable<string>`在模型上使用 an 作为属性）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:42:49.793

好的，想通了。我使用字符串类型来保存选定的安全问题和答案：

```
public class RegisterFormViewModel
{
    ...

    [Required]
    [Display(Name = "Security Question")]
    public string SecurityQuestion { get; set; }

    [Required]
    [Display(Name = "Security Answer")]
    public string SecurityAnswer { get; set; }

    ...  
} 
```

然后像这样填充列表：

```
 @Html.DropDownListFor(m => m.SecurityQuestion, QuestionHelper.GetSecurityQuestions()) 
```

使用这个助手：

```
 public static IEnumerable<SelectListItem> GetSecurityQuestions()
    {
        return new[]
            {
                new SelectListItem { Value = "What was your childhood nickname?", Text = "What was your childhood nickname?"},
                new SelectListItem { Value = "What is the name of your favorite childhood friend?", Text = "What is the name of your favorite childhood friend?"},
                new SelectListItem { Value = "What school did you attend for sixth grade?", Text = "What school did you attend for sixth grade?"},
                new SelectListItem { Value = "In what city or town did your mother and father meet?", Text = "In what city or town did your mother and father meet?"},
                new SelectListItem { Value = "What is the first name of the boy or girl that you first kissed?", Text = "What is the first name of the boy or girl that you first kissed?"},
                new SelectListItem { Value = "What is the name of a college you applied to but didn't attend?", Text = "What is the name of a college you applied to but didn't attend?"},
                new SelectListItem { Value = "Where were you when you first heard about 9/11?", Text = "Where were you when you first heard about 9/11?"},
                new SelectListItem { Value = "What is your grandmother's first name?", Text = "What is your grandmother's first name?"},
                new SelectListItem { Value = "What was the make and model of your first car?", Text = "What was the make and model of your first car?"},
                new SelectListItem { Value = "In what city and country do you want to retire?", Text = "In what city and country do you want to retire?"}
            };
    } 
```

然后做了一个这样的ajax帖子：

```
$.post('/Account/Register', $('#registerForm').serialize(), function(){ //success }); 
```

jQuery 序列化方法为安全问题发送所选项目的“值”。我想要实际的问题，这就是为什么我将 Value 和 Text 设置为相同的东西，否则你可以设置它，以便在选择项目时你想要获得的任何值。

# sql-server - Mac 上的 SQL 数据库

> ID：13943694
> 
> 赞同：1
> 
> 时间：2012-12-19T00:23:47.130
> 
> 标签：sql-server, macos

我有一个从 Windows 计算机从 2008 MS SQL 服务器导出的 .sql 文件，有没有办法在 mac/osx 平台上导入 sql 文件并重新创建数据库？如果这个问题已经得到解答，我深表歉意，我找不到适合我的问题的答案。

无论如何谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:32:14.423

如果 .sql 文件是实际的 SQL 语句；创建表，插入等，然后您应该能够在另一个 RDBMS 中执行它。您可能必须编辑 SQL，因为它可能具有 SQL Server 特定的语法，但一般形式应该相同。

在 Mac 上的目标 RDBMS 中创建一个数据库，然后执行 .sql 文件。

# c++ - 将比较函数传递给类

> ID：13943695
> 
> 赞同：-3
> 
> 时间：2012-12-19T00:23:47.117
> 
> 标签：c++

我希望能够使用类创建比较函数，例如：

```
bool someClassLess(const someClass &a1, const someClass &a2) {
    return (a1.variable1 < a2.variable1 && a1.variable2 < a2.variable2);
} 
```

然后声明**someClass**的优先级队列并传递我的比较函数以在推送元素时使用，例如：

```
PriorityQueue<someClass> arr(someClassLess()); 
```

如果在声明优先级队列时没有传递比较函数，则推送时应该自动使用**函数库中的****less**函数。

 ****如何将比较函数传递给类？**

您可以在下面找到我自己编写的 PriorityQueue 的代码。该代码包括尝试传递比较函数失败。

```
#ifndef PRIORITY_QUEUE_H
#define PRIORITY_QUEUE_H

#include <iostream>
#include <functional>

using std::cout;
using std::endl;
using std::less;

template<typename T>
class PriorityQueue {
public:

    template<typename PRED>
    PriorityQueue(PRED compare);
    ~PriorityQueue();

    T pop();
    void push(const T &e);
    size_t getSize() const;
    bool isEmpty() const;
    void print() const;

private:

    T *end;
    T *queue;
    PRED compare;

};

template<typename T>
PriorityQueue<T>::PriorityQueue(PRED compare = less<T>()) : queue(0), end(0), compare(compare) {
}

template<typename T>
PriorityQueue<T>::~PriorityQueue() {
    delete [] queue;
}

template<typename T>
T PriorityQueue<T>::pop() {
    if(isEmpty()) {
        throw "Queue is empty";
    } else if(getSize() == 1) {
        T removed = *queue;
        delete [] queue;
        queue = end = 0;
        return removed;
    }

    T *newQueue = new T[getSize() - 1];
    // Iteratorer
    T *it = queue, *itNew = newQueue;

    T removed = *(it++);
    for( ; it != end; it++, itNew++) {
        *itNew = *it;
    }

    int oldSize = getSize();

    T *tmp = queue;
    queue = newQueue;
    delete [] tmp;

    end = queue + oldSize - 1;

    return removed;
}

template<typename T>
void PriorityQueue<T>::push(const T &e) {
    if (isEmpty()) {
        queue = new T[1];
        *queue = e;
        end = queue + 1;
        return;
    }

    T *newQueue = new T[getSize() + 1];
    // Iterators
    T *it = queue, *itNew = newQueue;

    // Find where element e should be inserted, whilst inserting elements
    // compare(*it, e) used to look like *it < e when I was initially creating the class
    for( ; compare(*it, e) && it != end; it++, itNew++) {
        *itNew = *it; 
    }

    // Insert e
    *(itNew++) = e;

    // Insert the remaining elements
    for ( ; it != end; it++, itNew++) {
        *itNew = *it;
    }

    int oldSize = getSize();

    T *tmp = queue;
    queue = newQueue;
    delete [] tmp;

    end = queue + oldSize + 1;
}

template<typename T>
size_t PriorityQueue<T>::getSize() const {
    return (end - queue);
}

template<typename T>
bool PriorityQueue<T>::isEmpty() const {
    return (getSize() <= 0);
}

template<typename T>
void PriorityQueue<T>::print() const {
    for(int *i = queue; i != end; i++) {
        cout << *i << endl;
    }
}

#endif 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:42:23.080

为什么不只是无耻地复制[`std::priority_queue`](http://www.cplusplus.com/reference/queue/priority_queue/). 只需使用这个：

```
template <typename T, typename Compare = std::less< T > >
class PriorityQueue {
  public:
    PriorityQueue(Compare comp = Compare()) : end(0), queue(0), compare(comp) { };

    // ...

  private:

    T *end;
    T *queue;
    Compare compare;

}; 
```**

# ios - 您如何获得 AudioFileID 的采样率？

> ID：13943698
> 
> 赞同：4
> 
> 时间：2012-12-19T00:23:55.723
> 
> 标签：ios, wav, sampling, rate

在 iOS 中很容易获取加载的 .wav 文件中的字节数：

```
UInt64 dataSize = 0;  // dataSize
UInt32 ps = sizeof(UInt64); // property size
if( AudioFileGetProperty(fileId, kAudioFilePropertyAudioDataByteCount, &ps, &dataSize) )
  puts( "error retriving data chunk size" );
return dataSize ; 
```

但[在文档中，](https://developer.apple.com/library/mac/#documentation/MusicAudio/Reference/AudioFileConvertRef/Reference/reference.html)我似乎找不到任何关于如何确定 PCM 波形文件的采样率的信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T01:18:46.977

[我使用AudioStreamBasicDescription](https://stackoverflow.com/questions/5101150/how-to-use-audio-file-services-to-get-the-raw-data-of-an-audio-file)找到了答案。你所要做的就是：

```
UInt32 getAudioDataSamplingRate( AudioFileID fileId )
{
  AudioStreamBasicDescription bsd;
  UInt32 ps = sizeof(AudioStreamBasicDescription) ;
  if( AudioFileGetProperty(fileId, 
      kAudioFilePropertyDataFormat, &ps, &bsd) )
    puts( "error retriving af basic description" );
  return bsd.mSampleRate ;
} 
```

# java - 我应该注入执行算法所需的对象吗？我应该注入所有东西吗？

> ID：13943704
> 
> 赞同：5
> 
> 时间：2012-12-19T00:24:40.973
> 
> 标签：java, dependency-injection, guice

也许我在文档中错过了它，但我想知道我应该如何处理“帮助对象”？

代码示例：

```
public Path dijkstra(Node startNode, Node endNode) {
    Set<Node> nodesToInspect = new HashSet<Node>();  // should this Object be injected?
    Path path = new Path();  // and this one?

    while (!nodesToInspect.isEmpty()) {
        // some logic like:
        path.add(currentNode);

    }

    return path;
} 
```

我应该注入所有东西还是应该在某个时候说算法“最清楚”它需要什么？我应该尝试消除每一个“新”吗？或者一些对象创建是否正常，例如 HashSet、ArrayList 等 API 类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T02:19:03.410

在用依赖注入替换简单之前`new`，您需要问自己“我*为什么*要这样做？” ...“它有什么*真正的*好处？”。如果答案是“我不知道”或“什么都没有”，那么您不应该这样做。

在这种情况下，我看不出在您的示例代码的第一种情况下使用 DI 没有真正的好处。该方法之外的任何东西都不需要知道内部集合是如何表示的……甚至不需要知道它的存在。

您应该问的另一个问题是是否有更简单、更明显的方法来实现目标。例如，对`path`变量使用 DI 的（最可能的）目的是允许应用程序使用不同的`Path`类。但简单`Path`的方法是将实例`dijkstra`作为显式参数传递给方法。您甚至可以使用重载来使这更可口；例如

```
public Path dijkstra(Node startNode, Node endNode) {
    return dijkstra(startNode, endNode, new Path());
}

public Path dijkstra(Node startNode, Node endNode, Path path) {
    ...
} 
```

`new`最后要考虑的是 DI（在 Java 中）在某种程度上涉及反射，并且不可避免地比使用或工厂对象/方法的经典方法更昂贵。如果您不需要 DI 的额外灵活性，则不应该为此付费。

* * *

我刚刚注意到您所指的两个变量是局部变量。我不知道任何允许您注入局部变量的 DI 框架......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T06:33:01.057

Remember the design principle: "Encapsulate what changes often" or "encapsulate what varies". As the engineer, you know best what is likely to change. You wouldn't want to hard-code the year 2012 into code that will live until next decade, but you also wouldn't want to make "Math.PI" a configuration setting either--that'd be extra overhead and configuration that you'd never need to touch.

That principle doesn't change with dependency injection.

Are you writing one algorithm and you know which implementation of Set you need, like in your Dijkstra example? *Create your object yourself.* But what if your co-worker is soon to deliver a fantastic new implementation of Set optimized for your use-case, or what if you are experimenting with different collection implementations for benchmarking? *Maybe you'll want to inject a Provider until the dust settles.* That's less likely for collections, but maybe it's more likely for similar disposable objects you might think of as "helper objects".

Suppose you're choosing between different types of CreditCardAuthService that may vary at runtime. *Great case for injection.* But what if you've signed a five-year contract and you know your code is going to be replaced long before then? *Maybe hard-coding to one service makes more sense.* But then you have to write some unit tests or integration tests and you really don't want to use a real credit card backend. *Back to dependency injection.*

Remember: code is malleable. Someday you may decide that you need to rip out your hard-coded HashSet and replace it with something else, which is fine. Or maybe you'll discover that you need your service to vary often enough that it should be Guice-controlled, and then you add a constructor parameter and a binding and call it a day. Don't worry about it too much. Just keep in mind that just because you have a hammer, not every problem is a `Provider<WoodFasteningService>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T15:12:21.210

在使用 DI 时，我更愿意尽可能避免使用“新”。您在容器外部创建的每个实例（例如 guice 注入器）都不能重构为使用注入（如果您的“路径”实例应该获得一个通过配置注入的字符串“根”......并且您也不能在这些对象上使用拦截器。因此，除非它是纯 Entity-Pojo，否则我一直使用 Provides/Inject。它也是控制反转（好莱坞）模式和可测试性的一部分……如果您需要在 Junit 中模拟 Path 或 Set 怎么办？让它们注入（在这种情况下是提供者），之后您可以轻松地切换具体实现。

# apache-flex - 使用 CSS 设置 Flex 容器布局填充

> ID：13943705
> 
> 赞同：2
> 
> 时间：2012-12-19T00:24:44.387
> 
> 标签：apache-flex, mxml

有什么方法可以使用 Flex CSS 在此 BorderContainer 上设置填充？

```
<s:BorderContainer width="100%" height="100%">
   <s:layout>
      <s:VerticalLayout />
   </s:layout>

   <s:Label text="asdfasdf" />
</s:BorderContainer> 
```

我试图避免添加额外的不必要的 VGroup。使用 CSS 设置填充无效。（我猜是因为 paddingLeft 不是 BorderContainer 上定义的样式。）

```
s|BorderContainer {
   paddingLeft: 10;
} 
```

有没有办法用 CSS 修改布局的属性？我不想在很多地方硬编码填充。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T21:49:32.593

您可以将自定义样式添加到 BorderContainer 的外观。像这样的东西：

```
override protected function updateDisplayList(unscaledWidth:Number,
                                              unscaledHeight:Number):void {
    super.updateDisplayList(unscaledWidth, unscaledHeight);

    var paddingLeft:* = getStyle('paddingLeft');

    elementToPad.left = paddingLeft;
    //or
    layoutToPad.paddingLeft = paddingLeft;
    //or
    elementToPad.setStyle('paddingLeft', paddingLeft);
    //depending on what kind of element you wish to pad
} 
```

这样，您可以使用单个 Skin 类通过 CSS 应用不同的填充，并且可以避免代码重复。
唯一的缺点是：您不会获得 IDE 支持，因为主机组件不会知道您添加的样式；如果您尝试在 MXML 中设置样式，编译器会抛出错误，但这是您首先要避免的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T07:47:32.660

定义一个自定义样式，其中指定填充。

```
 .myCustomStyle { paddingLeft: 10;} 
```

在代码中，使用[styleManager](http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7f7c.html)获取该样式值并将其设置为垂直布局

```
 <s:layout>
         <s:VerticalLayout paddingLeft= "value got from the style manager"/>
   </s:layout> 
```

# jquery - 如何在单独的文本输入中显示名字和姓氏？

> ID：13943708
> 
> 赞同：7
> 
> 时间：2012-12-19T00:25:11.000
> 
> 标签：jquery

在下拉菜单中，我将每个选项显示如下：

`scomp23 - Jack Turner`

现在使用下面的代码：

```
var text = $(this).find('option:selected').text();
var split = text.split(' - ');
$('#currentAdminAlias').val( split[0] );     
$('#currentAdminForename').val( split[1] );   
$('#currentAdminSurname').val( split[2] ); 
```

我要做的是`scomp23`在`#currentAdminAlias`文本输入中显示（这很好），`Jack`在`#currentAdminForename`文本输入中显示并`Turner`在`#currentAdminSurname`文本输入中显示。

我遇到的问题是它`#currentAdminForename`仅在文本输入中显示名字和姓氏。

现在我知道为什么会发生这种情况，但我的问题是如何在单独的文本输入中显示名字和姓氏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:28:05.950

```
 var split = text.split(' ');
        $('#currentAdminAlias').val( split[0] );     
        $('#currentAdminForename').val( split[2] );   
        $('#currentAdminSurname').val( split[3] ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T00:35:23.473

```
 var text = $(this).find('option:selected').text();
        var split = text.split(' - ');
        var names = split[1].split(' ');
        $('#currentAdminAlias').val( split[0] );     
        $('#currentAdminForename').val( names[0] );   
        $('#currentAdminSurname').val( names[1] ); 
```

或者考虑将您想要的每个值作为 HTML 5 数据属性附加到选项元素。哪个会给你

```
 var element = $(this).find('option:selected');
        $('#currentAdminAlias').val(element.data('alias'));
        $('#currentAdminForename').val(element.data('forename'));
        $('#currentAdminSurname').val(element.data('surname')); 
```

示例选项元素看起来像

```
 <option data-alias="scomp23" data-forename="Jack" data-surname="Turner">
          scomp23 - Jack Turner
        </option> 
```

# forms - Wordpress 复选框过滤自定义类别 PHP

> ID：13943710
> 
> 赞同：1
> 
> 时间：2012-12-19T00:25:46.237
> 
> 标签：forms, wordpress, checkbox, filter

我目前正在做一个网站..

我需要以下功能：

我有几个与这些类别相关的颜色和照片类别

类别示例：

红色 绿色 蓝色 橙色 紫色 黄色

我正在尝试在我的 wordpress 主页上制作一个表格，该表格允许我检查一个类别，然后按该类别过滤我当前显示的帖子。在此过程中，我想留在主页上

我还想弄清楚如何消除“提交”按钮并在每次选中或取消选中一个框时提交表单。

我正在使用最新版本的 wordpress 和二十二主题

到目前为止，此功能将按类别过滤帖子：

```
function filter_color( $query ) {
$query->set( 'cat', '2' ); 
}
add_action( 'pre_get_posts', 'filter_color' ); 
```

我只是不确定如何创建将触发过滤器的复选框。我不知道我的表单应该“提交”到哪里（index.php？），我不确定如何让提交的数据显示出来。此外，我希望默认选中所有框，并将数据保存为颜色选项的表单未选中或重新选中。

拜托，任何指向良好参考材料的链接以及对此的任何帮助将不胜感激，因为我目前被难住了。

提前致谢！

# eclipse - 缺少 JavaHL 库

> ID：13943711
> 
> 赞同：0
> 
> 时间：2012-12-19T00:25:52.063
> 
> 标签：eclipse, svn, subclipse, javahl

我在 OS X (10.6.8) 上运行 Eclipse，主要使用 SVN 1.6。我也安装了 subclipse。

在eclipse中保存文件时出现以下错误：

```
Failed to load JavaHL Library.
These are the errors that were encountered:
no libsvnjavahl-1 in java.library.path
no svnjavahl-1 in java.library.path
no svnjavahl in java.library.path
java.library.path = .:/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java 
```

所以我做了一些研究，发现这是因为我需要安装 JavaHL 库，我尝试根据此页面上的信息进行安装：http: [//subclipse.tigris.org/wiki/JavaHL](http://subclipse.tigris.org/wiki/JavaHL)

我根据上一个链接中的信息遵循的方法是安装 MacPorts（这是成功的）并运行以下命令来安装 JavaHL 库：

```
sudo port install subversion-javahlbindings +no_bdb +universal 
```

但是，我不知道的是，这个命令安装了版本号为 1.7.7_0 的 JavaHL 库，但由于我需要 1.6.x 版本，所以我卸载了这个版本的 JavaHL 库。我似乎找不到如何使用 macports 在我的计算机上安装 JavaHL 1.6 版。我访问了 MacPorts 网站，但他们目前没有 1.6 版的端口。

非常感谢您对此问题的任何帮助。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:34:48.047

为什么不直接使用需要 SVN 1.7 的 Subclipse 1.8.x？您服务器上的 SVN 版本无关紧要。您应该只在客户端上使用 SVN 1.7，因为它更快、更可靠。现在您已经安装了 MacPorts，您还可以使用 SVN 1.7.7 命令行客户端。客户端版本重要的唯一领域是当您尝试在同一个工作副本上使用多个客户端时。在这种情况下，客户端的 major.minor 版本应该匹配。

# bash - Bash — 定位文件，awk 副本无法正常工作

> ID：13943713
> 
> 赞同：1
> 
> 时间：2012-12-19T00:26:03.157
> 
> 标签：bash, awk, cp

我正在尝试使用以下内容查找文件，然后将第一个结果复制到 $dir 设置的目录中。当我不设置变量并使用绝对路径时它工作正常，但这不是我需要的。

**这不起作用：**

```
dir="/path/to/destination/";
mkdir "$dir";
locate -l 1 target_file.txt | awk '{print "cp " $1 $dir " "}' | sh 
```

错误信息是：

```
awk: illegal field $(), name "dir"
 input record number 1, file 
 source line number 1
cp: fts_open: No such file or directory 
```

**这有效：**

```
locate -l 1 target_file.txt | awk '{print "cp " $1 " /path/to/destination/"}' | sh 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:37:25.103

在`awk`脚本中，您不使用`$`前缀变量；您可以使用它来引用输入行中的字段。

```
dir="/path/to/destination/";
mkdir "$dir";
locate -l 1 target_file.txt | awk -v dir="$dir" '{print "cp",  $1, dir}' | sh 
```

只要您的姓名中没有空格，这将正常工作。

```
dir="/path/to/destination/";
mkdir "$dir";
locate -l 1 target_file.txt | awk -v dir="$dir" '{printf "cp \"%s\" \"%s\"\n", $1, dir}' | sh 
```

除非我搞砸了反斜杠，否则它应该与文件名中的空格等一起使用。如果有人不友好地将换行符放入文件名中，整个管道将被搞砸。

# windows-8 - 如何让后退按钮显示在我的 Windows 应用商店应用程序中？

> ID：13943715
> 
> 赞同：1
> 
> 时间：2012-12-19T00:26:10.847
> 
> 标签：windows-8, windows-runtime

我有自己的堆栈/导航模型，但我希望标准的后退按钮出现在我的页面标题旁边。

我需要什么代码才能让它出现？

这些例子只是做这样的事情：

```
 void Header_Click(object sender, RoutedEventArgs e)
    {
        // Determine what group the Button instance represents
        var group = (sender as FrameworkElement).DataContext;

        // Navigate to the appropriate destination page, configuring the new page
        // by passing required information as a navigation parameter
        this.Frame.Navigate(typeof(GroupDetailPage), 
            ((SampleDataGroup)group).UniqueId);
    } 
```

它会自动出现。

我浏览了各种 msdn 页面，但他们大多谈论设计模式。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T22:36:40.210

在 Visual Studio 项目模板（除了空白应用程序）中，您将在页面中看到以下 XAML

```
<Button x:Name="backButton" Click="GoBack" IsEnabled="{Binding Frame.CanGoBack, ElementName=pageRoot}" Style="{StaticResource BackButtonStyle}"/> 
```

所以按钮的可见性取决于应用程序是否有后台堆栈，`pageRoot`这里是`x:Name`与给定页面关联的。

请注意，GoBack 方法是您为除空白模板之外的所有模板获取的 LayoutAwarePage 的一部分。听起来您有自己的“LayoutAwarePage”版本，在这种情况下，您必须连接任何有意义的代码才能在导航模型的后退按钮上执行。

请记住，LayoutAwarePage 将是许多 Windows 应用商店应用程序的基础，因此如果您与*事实上的*默认导航方案偏离太多，您可能会混淆习惯于在其他应用程序中使用的用户。也许从 LayoutAwarePage 扩展是否有意义，在这种情况下，您将获得默认行为（包括“后退”按钮），然后您可以在顶部添加自己的特殊酱汁？

# c++ - 散列文件中的每个单词

> ID：13943716
> 
> 赞同：-1
> 
> 时间：2012-12-19T00:26:11.123
> 
> 标签：c++, hash

有一小段代码我遇到了麻烦。到目前为止，我已经设置了一个程序，它可以读取 words.txt，然后计算每个单词。当我计算它时，我需要一个哈希函数，它只会通过二次碰撞方案对每个单词进行一次哈希处理，并允许我将它存储在一个表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:13:31.860

`std::hash`使用的标准散列函数`std::unordered_map`非常好。如果你发现你需要一些不同的东西，你当然可以通过编写一个并将它作为第三个模板参数提供给`std::unordered_map`声明来提供你自己的东西。

无论如何，以下内容让您了解使用 unordered_map 和标准库提供的其他工具时这是多么简单：

```
#include <iostream>
#include <fstream>
#include <string>
#include <unordered_map>
using namespace std;

int main(int argc, char *argv[])
{
    // load map with our words and their counts
    unordered_map<string, unsigned int> strs;
    ifstream ifs("words.txt");
    string str;
    while (ifs >> str)
        ++strs[str];
    ifs.close();

    // output results (use a lambda if you're using C++11, which
    //  you likely are since we have unordered_map. I've provided
    //  this just to show how it is done prior to lambdas.
    struct print_entry
    {
        ostream& os;
        print_entry(ostream& os) : os(os) {};

        // called by for_each for each map value.
        typedef typename unordered_map<string, unsigned int>::value_type value_type;
        void operator ()(const value_type& val) const
        {
            os << val.first << " : " << val.second << endl;
        }
    };

    // walk map with for_each, printing each entry to cout
    for_each(strs.begin(), strs.end(), print_entry(cout));

    return EXIT_SUCCESS;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T00:37:28.563

使用 std::unordered_map 提供的标准散列函数

然后您需要做的就是读取单词将它们添加到地图并增加计数（地图的值部分（而单词是地图的关键部分））。

# iphone - MapKit折线自定义缩放？

> ID：13943718
> 
> 赞同：5
> 
> 时间：2012-12-19T00:26:42.147
> 
> 标签：iphone, ios, ipad, mapkit, polyline

我正在尝试学习如何在 ios6 中使用折线连接地图上的两个点。首先，我已经阅读了关于这个主题的每一个教程，一个简单的谷歌搜索出现了，并且由于一个原因不能让折线工作。我看到的每个教程总是将折线添加到地图并调整地图的缩放以适应整条线。如果我希望地图以恒定距离保持放大并且仅在大于当前视图时才显示多段线的末端，我将如何在 ios6 中制作和添加多段线到地图中？例如，假设我有一条一英里长的折线，并希望地图保持放大的恒定距离，相当于：

```
MKCoordinateRegion userRegion = MKCoordinateRegionMakeWithDistance(self.currentLocation.coordinate, 1000, 1000);
    [self.mainMap setRegion:[self.mainMap regionThatFits:userRegion] animated:YES]; 
```

我该怎么做呢？请提供完整的代码示例或我可以下载的示例项目！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T12:24:06.207

MKMapPoint * malloc / 分配：

```
MKMapPoint *newPoints = malloc((sizeof (MKMapPoint) * nbPoints));
newPoints[index] = varMKMapPoint;
free(newPoints); 
```

MKPolyline 必须在您需要的地方初始化：

```
MKPolyline *polyline  = [MKPolyline polylineWithPoints:newPoints count:nbPoints];
[self.mapView addOverlay:polyline]; 
```

要显示您的 MKPolyline，您必须使用 viewForOverlay ：

```
- (MKOverlayView *)mapView:(MKMapView *)mapView viewForOverlay:(id <MKOverlay>)overlay
{
    MKOverlayView* overlayView = [[MKOverlayView alloc] initWithOverlay:overlay];        
    if([overlay isKindOfClass:[MKPolyline class]]) {
        MKPolylineView *backgroundView = [[MKPolylineView alloc] initWithPolyline:overlay];
        backgroundView.fillColor = [UIColor blackColor];
        backgroundView.strokeColor = backgroundView.fillColor;
        backgroundView.lineWidth = 10;
        backgroundView.lineCap = kCGLineCapSquare;
        overlayView = backgroundView;
    }
    return overlayView;
} 
```

要使用此方法，您必须将您的点转换为 CLLocation，它将返回一个您将设置为 mapView 的 MKCoordinateRegion：

```
- (MKCoordinateRegion)getCenterRegionFromPoints:(NSArray *)points
{
    CLLocationCoordinate2D topLeftCoordinate;
    topLeftCoordinate.latitude = -90;
    topLeftCoordinate.longitude = 180;
    CLLocationCoordinate2D bottomRightCoordinate;
    bottomRightCoordinate.latitude = 90;
    bottomRightCoordinate.longitude = -180;
    for (CLLocation *location in points) {
        topLeftCoordinate.longitude = fmin(topLeftCoordinate.longitude, location.coordinate.longitude);
        topLeftCoordinate.latitude = fmax(topLeftCoordinate.latitude, location.coordinate.latitude);
        bottomRightCoordinate.longitude = fmax(bottomRightCoordinate.longitude, location.coordinate.longitude);
        bottomRightCoordinate.latitude = fmin(bottomRightCoordinate.latitude, location.coordinate.latitude);
    }
    MKCoordinateRegion region;
    region.center.latitude = topLeftCoordinate.latitude - (topLeftCoordinate.latitude - bottomRightCoordinate.latitude) * 0.5;
    region.center.longitude = topLeftCoordinate.longitude + (bottomRightCoordinate.longitude - topLeftCoordinate.longitude) * 0.5;
    region.span.latitudeDelta = fabs(topLeftCoordinate.latitude - bottomRightCoordinate.latitude) * 1.2; //2
    region.span.longitudeDelta = fabs(bottomRightCoordinate.longitude - topLeftCoordinate.longitude) * 1.2; //2
//    NSLog(@"zoom lvl : %f, %f", region.span.latitudeDelta, region.span.latitudeDelta);
    return region;
} 
```

希望这可以帮助。

# shell - 如何将变量传递给awk

> ID：13943721
> 
> 赞同：1
> 
> 时间：2012-12-19T00:26:56.763
> 
> 标签：shell, awk

> **可能重复：**
> [将 awk 与变量一起使用](https://stackoverflow.com/questions/6373379/using-awk-with-variables)

下面的命令是错误的，重点是我想`$curLineNumber`在awk中使用，怎么办？有什么解决办法吗？

```
curLineNumber = 3
curTime=`ls -l | awk 'NR==$curLineNumber {print $NF}'` 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:30:43.800

```
curTime=$(ls -l | awk -v line=$curLineNumber 'NR == line { print $NF }' 
```

该`-v`选项用于指定在命令行上初始化的变量。我选择了`line`变量`awk`的名称。

# javascript - DOM 在我想要的地方添加表格行

> ID：13943722
> 
> 赞同：3
> 
> 时间：2012-12-19T00:27:00.423
> 
> 标签：javascript, html, dom

> **可能重复：**
> [如何在不使用库的情况下在 JavaScript 中插入 After()？](https://stackoverflow.com/questions/4793604/how-to-do-insert-after-in-javascript-without-using-a-library)

目前，此脚本在表格底部添加一行。我如何告诉它在特定行之后添加它？在桌子的顶部？

```
<script>
var i = 1;

function changeIt() {
var tr = document.createElement('tr');
var td = tr.appendChild(document.createElement('td'));
td.style.valign = 'middle';

var span = td.appendChild(document.createElement('span'));
span.style.fontWeight = 'bold';
span.appendChild(document.createTextNode('URL ' + i));

td = tr.appendChild(document.createElement('td'));
var input = td.appendChild(document.createElement('input'));
input.name = 'url' + ++i;
input.type = 'text';
input.size = '40'

document.getElementById('myTable').tBodies[0].appendChild(tr);

}
</script> 
```

我一直在搜索 Google 来学习，但我不断遇到 jQuery、innerhtml 和 insertrow 答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:31:56.457

您正在寻找`node.insertBefore()` [https://developer.mozilla.org/en-US/docs/DOM/Node.insertBefore](https://developer.mozilla.org/en-US/docs/DOM/Node.insertBefore)

```
var i = 1;

function changeIt() {
    var tr = document.createElement('tr');
    var td = tr.appendChild(document.createElement('td'));
    td.style.valign = 'middle';

    var span = td.appendChild(document.createElement('span'));
    span.style.fontWeight = 'bold';
    span.appendChild(document.createTextNode('URL ' + i));

    td = tr.appendChild(document.createElement('td'));
    var input = td.appendChild(document.createElement('input'));
    input.name = 'url' + ++i;
    input.type = 'text';
    input.size = '40'
    var node = document.getElementById('myTable').tBodies[0];
    node.insertBefore(tr, node.firstChild);

} 
```

要添加到特定位置，您需要知道`.children`. 否则，一些关键标识符（类名、属性或 ID），您可以传递给 getBy 或 QSA。

# android - 如何设置意图过滤器只接受jpg？

> ID：13943724
> 
> 赞同：5
> 
> 时间：2012-12-19T00:27:02.317
> 
> 标签：android, mime-types, android-gallery, intentfilter

我希望我的 Activity 可以接受 Gallery 的 jpg。所以我设置

```
Intent picker = new Intent (Intent.ACTION_PICK);
picker.setType ("image/jpeg"); 
```

但画廊仍然显示所有格式的图像。我怎样才能让画廊只展示我需要的东西？我是否需要自定义图库？

# excel - SQL Server Express 比 SQL Server 快得多？

> ID：13943726
> 
> 赞同：0
> 
> 时间：2012-12-19T00:27:10.630
> 
> 标签：excel, sql-server-2008, sql-server-2008-express, vba

有谁知道为什么 SQL Server Express 可以比 VBA 代码中的完整 SQL Server 快得多？差异很大，所以我想知道它是否可能在驱动程序中？谢谢你的想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:29:23.930

这取决于很多事情。它在本地运行吗？Express 的要求不高，可能会比在桌面上安装完整的 SQL Server 运行得更好。

# c# - 处理不正确的 HTTP 标头正文大小值？

> ID：13943733
> 
> 赞同：5
> 
> 时间：2012-12-19T00:27:47.720
> 
> 标签：c#, web-services, magento, http-headers

使用 C# ASP.NET MVC，在 Magento 站点上调用 web 服务时：

有时 Magento 站点会发送错误的 HTTP 标头，特别是 body-size 标头表示正文比实际大。例如它可能会说 body-size=1000，但 body 只包含 999 个字节。尽管标题不正确，但正文是正确的，所以我仍然希望能够处理它。

现在，当我尝试在 C# 中读取该响应时

```
var invoiceInfo = _magentoService.salesOrderInvoiceInfo(sessionId, invoiceId); 
```

它抛出一个异常：

```
Connection closed by remote host 
```

这是有道理的，因为它试图读取第 1000 个字节但它不存在。更糟糕的是，读取正文的代码深埋在 .NET 框架中，所以我无法更改它：

```
[System.Web.Services.Protocols.SoapRpcMethodAttribute("urn:Mage_Api_Model_Server_V2_HandlerAction", RequestNamespace="urn:Magento", ResponseNamespace="urn:Magento")]
[return: System.Xml.Serialization.SoapElementAttribute("result")]
public salesOrderInvoiceEntity salesOrderInvoiceInfo(string sessionId, string invoiceIncrementId) {
    object[] results = this.Invoke("salesOrderInvoiceInfo", new object[] {
                sessionId,
                invoiceIncrementId}); // exception thrown here
    return ((salesOrderInvoiceEntity)(results[0]));
} 
```

我无法更改 Magento 站点，或修复导致此问题的任何问题（它是第 3 方网络服务器）。

我能做些什么来改变我自己的 C# 代码的行为吗？我希望能够以某种方式强制它在到达身体末端时停止，如果出现这种情况，请忽略此异常

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T20:33:21.997

我不知道这会起作用，但是您是否尝试过将代码放在`try`/`catch`块中并忽略异常？有吗`results == null`？

像这样：

```
[System.Web.Services.Protocols.SoapRpcMethodAttribute("urn:Mage_Api_Model_Server_V2_HandlerAction", RequestNamespace="urn:Magento", ResponseNamespace="urn:Magento")]
[return: System.Xml.Serialization.SoapElementAttribute("result")]
public salesOrderInvoiceEntity salesOrderInvoiceInfo(string sessionId, string invoiceIncrementId) {
    try
    {
        object[] results = this.Invoke("salesOrderInvoiceInfo", new object[] {
                    sessionId,
                    invoiceIncrementId}); // exception thrown here
    }
    catch(Exception) {}

    if(results != null && results.Count() > 0) return ((salesOrderInvoiceEntity)(results[0]));

    throw new Exception("results is null");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-24T13:19:20.037

从这里尝试解决方案（将 API 端点更改为 api.php）：[stackoverflow.com/a/36200828/1936722](https://stackoverflow.com/a/36200828/1936722)

基本上将 API url 更改为：
`domain.com/index.php/api/v2_soap/index/wsdl/1`

至：

`domain.com/api/v2_soap/?wsdl=1`

# javascript - 为动态创建的 XUL 元素清理事件监听器？

> ID：13943739
> 
> 赞同：0
> 
> 时间：2012-12-19T00:28:12.293
> 
> 标签：javascript, firefox, firefox-addon, xul

大约一个月前，我问了一个关于[如何为动态 XUL 元素正确设置事件](https://stackoverflow.com/questions/13371105/how-to-properly-set-events-for-dynamic-xul-elements)的问题。现在我知道如何设置它们，我想知道在拆除它们时需要做什么。当动态创建的元素（在我的例子中是工具栏按钮和菜单项）被删除时，我应该使用[element.removeEventListener()吗？](https://developer.mozilla.org/en-US/docs/DOM/element.removeEventListener)假设事件监听器的创建如下所示，我该如何获取对监听器的引用以便清理它？

```
tempMenuItem.addEventListener("command", function(event)
{
  myObject.someFunction();
}, false); 
```

在这个过程中我应该注意其他任何问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:12:39.407

通常，事件侦听器会自动清理，您无需担心手动删除它们。如果您碰巧想要删除事件侦听器，那么正确的做法是：

```
var theListener = function (event) { ... };
item.addEventListener("command", theListener, false);
item.removeEventListener("command", theListener, false); 
```

不要忘记确保两个调用中的第三个参数匹配:)

# php - 如何通过服务器websocket将twilio sms传递到客户端

> ID：13943746
> 
> 赞同：2
> 
> 时间：2012-12-19T00:29:16.377
> 
> 标签：php, websocket, twilio, phpwebsocket

我正在尝试设置我的服务器，以便有人可以通过我们网站上的聊天框与我联系。由于我不会一直在那里监视聊天，因此我正在尝试设置一个系统，其中聊天通过 websocket 路由到我的服务器（使用[PHP-Websockets](https://github.com/ghedipunk/PHP-Websockets)），然后通过短信发送到我的手机。这一切正常。我很难弄清楚我的响应如何回到客户端。当我回复文本时，Twilio 将访问我使用 sms 消息作为 post 变量指定的任何页面。如何将此发布消息传递给我的 websocket（它已经在运行），然后它可以将消息发送回客户端？谢谢你们的帮助

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T08:12:00.123

Twilio 在收到您的 SMS 时通过 WebHook 调用（HTTP 请求）与您的应用程序通信。

由于 PHP-WebSockets 作为独立进程运行，而不是作为现有 Web 堆栈（例如 Apache）的一部分，因此您需要在设置中包含一些组件：

1.  PHP-WebSocket
2.  Web 服务器 - 为您的 HTML、CSS 等提供服务，并通过 Twilio WebHook 与之交互
3.  1\. 和 2\. 交互的一种方式。这通常是通过某种消息队列来实现的

这是一个序列图，详细说明了设置中各​​个组件之间的通信，如我所见：

![](../Images/73bf2e1a691bfbe08d6948f87801c9e2.png)

希望这可以阐明来自 Twilio、您的 Web 服务器、您的 WebSocket 服务器和您的客户端的通信。

如果这看起来过于复杂，那么您可以通过使用我工作的[Pusher](http://pusher.com)等托管服务来消除拥有 WebSocket 服务器和消息队列的要求。如果是这种情况，那么这个[使用 Pusher 和 Twilio](http://www.twilio.com/blog/2012/07/pusher-and-twilio-making-realtime-fuctionality-easy.html)的教程应该很有用。这里的主要好处之一是您可以继续考虑请求和响应，而不必考虑通过消息队列进行跨组件通信。

# php - 使用PHP，提交后将图像HTML存储到变量中

> ID：13943747
> 
> 赞同：1
> 
> 时间：2012-12-19T00:29:18.157
> 
> 标签：php, variables

如果这看起来不正确或没有意义，请道歉，但可以通过任何方式执行以下操作......

```
 <form id="form1" name="form1" method="post" action="index.php">
  <img id="image1" src="URL" name="image1" width="138" height="79" border="0" />
  <input name="save" type="hidden" id="save" value="true" />
  <input type="submit" name="button" id="button" value="Update" /> 
  </form> 
```

每当有人提交表单时，以下内容都会存储到变量中......

```
 <img id="image1" src="URL" name="image1" width="138" height="79" border="0" /> 
```

就像是...

```
 $image1 = <img id="image1" src="URL" name="image1" width="138" height="79" border="0" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:19:25.973

您可以通过将 HTML 添加为隐藏的表单元素来做到这一点：

```
<form id="form1" name="form1" method="post" action="?">
  <img id="image1" src="URL" name="image1" width="138" height="79" border="0" />

  <input type="hidden" name="image1" value='<img id="image1" src="URL" name="image1" width="138" height="79" border="0" />' />

  <input name="save" type="hidden" id="save" value="true" />
  <input type="submit" name="button" id="button" value="Update" /> 
</form> 
```

然后它将作为`$_POST['image1']`

# mysql - 将 dbFailOnError 添加到 CurrentDb.Execute 无法更新表

> ID：13943753
> 
> 赞同：2
> 
> 时间：2012-12-19T00:29:45.537
> 
> 标签：mysql, ms-access, vba, odbc

长期潜伏者，第一次海报。

我有一个通过 5.1 ODBC 驱动程序连接到 Access 2010 的 mySQL 表。我正在尝试更新 mySQL 表并奇怪地在 CurrentDb.Execute strSQL 的末尾添加 dbFailOnError 可防止表更新但不会引发任何错误。我的 VBA 编辑器设置为中断所有错误。例程中的所有错误处理都已注释以供测试。

如果我使用**CurrentDb.Execute strSQL**或**DoCmd.RunSQL strSQL**，表会更新。此外，mySQL 表有一个索引。

SQL 字符串：

```
strSQL = "UPDATE clients
SET [DateLastAccessed] = " & lngDateAccessed & ",
[CountAccess] = " & intCountAccessed & "
WHERE [SerialHDD] = '" & strGetHDD & "' ;" 
```

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:56:30.257

“*在末尾**添加可防止表更新但不会引发任何错误`dbFailOnError``CurrentDb.Execute strSQL`*”

`SetWarnings`如果已关闭，则可能无法在没有明显错误的情况下更新。`SetWarnings`检查在执行更新语句之前立即打开时是否得到不同的结果。

```
DoCmd.SetWarnings True
CurrentDb.Execute strSQL, dbFailOnError 
```

# javascript - 抓取所选单词出现的句子

> ID：13943754
> 
> 赞同：2
> 
> 时间：2012-12-19T00:30:09.663
> 
> 标签：javascript, regex

使用 Javascript，我需要允许用户双击页面上的单词并检索它出现的句子。不仅仅是任何句子，而是*那个特定*的句子。我玩弄了检索该单词出现的所有句子并以某种方式选择正确的句子，所以也许这是一个选择。

我已经在网上搜索了这个野兽，我已经考虑了很多。有些人建议使用[Rangy](http://code.google.com/p/rangy/)，但我找不到我正在寻找的功能，甚至找不到可以帮助我到达我需要的地方的功能。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:50:44.923

您可以将您的页面变成一个或多个只读文本区域，使用巧妙的 CSS 样式对其进行屏蔽，然后使用此处所述的 onselect 事件：[Detect selected text in a text area with javascript](https://stackoverflow.com/questions/5359451/detect-selected-text-in-a-text-area-with-javascript)

当然，这取决于您的页面的外观和使用位置。

# android - Android 3.0 之前的带有操作栏的应用程序

> ID：13943755
> 
> 赞同：0
> 
> 时间：2012-12-19T00:30:16.030
> 
> 标签：android, android-actionbar, actionbarsherlock

我在仅针对 Android 3.0+ 的应用程序中使用它。我想吸引更多人，但 ActionBar 不向后兼容。我不想使用像 ActionBarSherlock 这样的第三方库。我沿着那条路走下去，这比它更值得。

我有这样的代码：

```
final ActionBar actionBar = getActionBar();
actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
actionBar.setDisplayHomeAsUpEnabled(true); 
```

可以用`if`- `else`SDK 检查来包装它吗？在操作栏之外，99% 的其他代码与 3.0 之前的版本兼容（好吧，我使用的是片段，但使用的是支持库。）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T00:33:00.210

是的，像这样：

```
 @TargetApi(Build.VERSION_CODES.HONEYCOMB)
        private void setupActionBar() {
              if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
                 actionBar = getActionBar();
                 actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
                 actionBar.setDisplayHomeAsUpEnabled(true); 
                }           
        } 
```

确保你的 actionBar 变量是**全局的**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T00:34:37.653

你可以这样做：

```
 if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
        final ActionBar actionBar = getActionBar();
        actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
        actionBar.setDisplayHomeAsUpEnabled(true);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T00:40:08.330

是的。我非常广泛地使用它们。但是，请务必从 Google I/O 2012 观看[此](https://developers.google.com/events/io/sessions/gooio2012/106/)内容，因为它可以很好地洞察更好的实践。

您可以使用 Build.VERSION.SDK_INT 以 int 形式获取版本。设置它很容易：

```
final int version = Build.VERSION.SDK_INT;
ActionBar actionBar;

@TargetApi(Build.VERSION_CODES.HONEYCOMB)
    private void ABsetup() {
        if (version >= Build.VERSION_CODES.HONEYCOMB) {
            actionBar = getActionBar();
actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
actionBar.setDisplayHomeAsUpEnabled(true);          }
    } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-19T00:35:05.650

另一种选择是使用 ActionBarSherlock，它使操作栏重新兼容 android 2.1 (SDK 7)。

链接在这里：[http ://actionbarsherlock.com/](http://actionbarsherlock.com/)

# javascript - 如何防止逐渐显示页面？

> ID：13943757
> 
> 赞同：6
> 
> 时间：2012-12-18T21:10:02.130
> 
> 标签：javascript, jquery, html, load

我的网站加载图像非常缓慢。出现一些文本，然后是一些表格，然后是一些图像……然后是 - 正文背景图像。
如何强制在整个页面准备好之前不显示任何内容？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T00:34:38.243

`body`您可以在其中添加一个类，`display:none`并在页面加载后将其删除..

```
<body class="loading">
...
</body> 
```

和

```
<script>
    window.onload = function(){document.body.className = '';};
</script> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T23:12:47.233

可能最简单/最好的方法是使用 Javascript 来做到这一点。我看到这个实现的主要方式是文档就绪处理程序揭示了所有隐藏的东西。

```
$(document).ready(function() { $('*').show(); });  // Or something similar. 
```

当然，人们喜欢看到某种关于“进度”的反馈，这样您的网站就不会显得编码不佳或服务器是垃圾。所以一个加载器栏或其他什么。

正如我上面提到的，这类问题的最佳位置是[Stack Overflow](https://stackoverflow.com/)，也许这将由更高级别的个人移到那里。同时，这是关于 Stack Overflow的一个非常[相似的问题。](https://stackoverflow.com/questions/1435015/how-can-i-make-the-browser-wait-to-display-the-page-until-its-fully-loaded)

# sql-server - 为什么我的 ODBC 连接在 Visual Studio 中运行 SSIS 加载时失败，但在使用执行包实用程序运行相同的包时没有

> ID：13943765
> 
> 赞同：22
> 
> 时间：2012-12-19T00:31:35.920
> 
> 标签：sql-server, ssis, etl

我正在处理 SSIS 2012 中的数据集市加载包。尝试在 Visual Studio 中执行包时出现此错误：

> “对连接管理器 Data Warehouse.ssusr 的 AcquireConnection 方法调用失败，错误代码为 0xC0014009”。

当我测试 Connection Manager Data Warehouse.ssusr 的连接性时，我看到它通过了。

当我使用执行包实用程序在 Visual Studio 之外执行包时，包会运行。

我不明白发生了什么事。

该程序包还拒绝使用 SQL Server 作业计划运行，如果这与任何事情有关。

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-12-19T19:50:32.917

在这里做一些假设，但我会假设这是一个 32 位与 64 位的问题。要进行验证，请在命令提示符下尝试这两个命令（Windows 键、R、cmd.exe 或开始、运行、cmd.exe）

```
"C:\Program Files (x86)\Microsoft SQL Server\110\DTS\Binn\dtexec.exe" /file C:\myPackage.dtsx
"C:\Program Files\Microsoft SQL Server\110\DTS\Binn\dtexec.exe" /file C:\myPackage.dtsx 
```

第一个将在 32 位模式下运行您的包，而第二个将在 64 位模式下运行它。这很重要，因为您的驱动程序和您创建的任何 DSN 将仅在 32/64 位世界中可见。

## 修复 SSDT

一旦您确定了您需要的版本，可能是 32 位版本，您需要确保您的项目正在使用适当的运行时。右键单击您的项目并选择属性，然后导航到配置属性下的调试选项卡。

![调试选项卡，Run64BitRuntime](../Images/4e0a17d307e6e093d8d74e8a9ca48bc4.png)

在反转 Run64BitRuntime 值后，我假设您的包将在 SSDT 内工作。

## 修复 SQL 代理

您将需要编辑现有的 SQL 代理作业以更改作业步骤的 bittedness。这将位于“配置”选项卡下，然后位于“高级”选项卡下。选中/取消选中 32 位运行时。

![代理 32 位选项卡](../Images/8008f6442ccdee421c8f69b4d2b410f5.png)

## 谎言和欺骗

细心的人可能会看到[dtexec](http://msdn.microsoft.com/en-us/library/ms162810%28v=sql.105%29.aspx)提供了一个`/X86`选项。不要相信。获得正确位数的唯一方法是显式调用正确的 dtexec.exe 文档甚至说了这么多，但没有人阅读文档。

> 此选项仅由 SQL Server 代理使用。如果在命令提示符处运行 dtexec 实用程序，则忽略此选项。

# ubuntu - 使用 Qt 在 Pandaboard 上创建和运行应用程序

> ID：13943766
> 
> 赞同：1
> 
> 时间：2012-12-19T00:31:41.877
> 
> 标签：ubuntu, arm, cross-compiling, yocto, pandaboard

我希望在 x86 Ubuntu Dist 上使用 Qt 创建应用程序，并且我想为 ARM7 Pandaboard 创建应用程序。我一直在联系 Qt 的技术人员，他们对在 Linux x86 计算机上初始安装和设置 Qt 有很大帮助。

我目前可以`exe`使用 Yacto 工具链通过 QtCreator 创建一个。

Qt Tech 解释`exe`说它是使用 GCC 4.6 创建的，应该可以在运行基于 Yocto 的图像的 Pandaboard 上工作。

如果我将该文件直接移动到运行 Ubuntu 12.4 的 pandaboard 并尝试运行它，我会收到错误消息：`No Command Found`

我现在很确定我需要在熊猫板上安装 Yacto。
我尝试按照列出的说明进行操作：

“http://www.yoctoproject.org/docs/1.3/poky-ref-manual/poky-ref-manual.html#ref-images”和“http://maniacbug.wordpress.com/2012/08/03 /pandayocto/"

此处发生故障：`time bitbake -c fetchall core-image-sato` 或 `bitbake care-image-sato`

通常的错误包括：

> 无法确定架构“armv7l”的字节顺序请将您的架构添加到 siteinfo.bbclass 和其他一些

我的根本问题

1.  我是否走上了在熊猫板上运行 Qt 应用程序的正确道路？
2.  我需要哪个版本的 yocto？
    *   我下载并尝试了以下内容：
        *   [链接 1](http://downloads.yoctoproject.org/releases/yocto/yocto-1.3/poky-danny-8.0.tar.bz2)
        *   [链接 2](http://downloads.yoctoproject.org/releases/yocto/yocto-1.2/poky-denzil-7.0.tar.bz2)
3.  是否有一套工作说明来完成此安装？（我是 Linux 新手）
4.  有谁知道如何将应用程序从 x86 Linux 机器分发和运行到连接的熊猫板上，如 Qt 开发人员这样做的视频所示？ [优酷链接](http://youtu.be/lp7zRsw9_2s)

任何人可以提供的帮助将不胜感激。我知道这是可能的，但似乎有一些问题需要首先解决。

# python - 如何判断项目是否在python列表中按顺序出现

> ID：13943767
> 
> 赞同：2
> 
> 时间：2012-12-19T00:31:50.397
> 
> 标签：python, list

我试图弄清楚如何更清楚地确定特定项目是否按顺序出现在我的列表中

例如假设我有一个列表：

```
my_list=[1,2,2,2,4,5,1,0] 
```

在上面的示例中，1 的重复实例不会在列表中按顺序出现，但 2 的所有实例都会出现。我似乎可以弄清楚如何做到这一点的唯一方法是非常笨拙

```
def check_sequencing(some_list,item_to_check):
    prev_instance = 0
    difference_list = []
    for counter, item in enumerate(some_list):
        if item_to_check == item:
        difference_list.append(counter - prev_instance)
        prev_instance = counter
    if set(difference_list[1:]) == set([1]):
        return 'True'
    else:
        return 'False' 
```

我试图避免导入另一个库（numpy）我只是确定当我开始走这条路时他们会是一个班轮但我找不到它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:35:09.197

```
>>> collections.Counter(x[0] for x in itertools.groupby(my_list)).get(1, 0) > 1
True
>>> collections.Counter(x[0] for x in itertools.groupby(my_list)).get(2, 0) > 1
False 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T00:52:32.967

好的，这一次我有一个真正的单线工作：

```
all(x==i for x in L[L.index(i):len(L)-[k for k in reversed(L)].index(i)]) 
```

如果它是真的，那么它会发生不止一次。替换`L`为您的列表和`i`您要搜索的术语。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T00:35:52.657

您可以使用它`itertools.groupby`来执行此操作：

```
>>> import itertools
>>> any(len(list(n[1])) >= 2 for n in itertools.groupby(l))
True 
```

如果你想避免使用`len(list(gen))`，你可以使用这样的东西：

```
>>> import itertools
>>> any(sum(1 for i in n[1]) >= 2 for n in itertools.groupby(l))
True 
```

# jquery - Firefox 上的 jQuery setInterval

> ID：13943773
> 
> 赞同：1
> 
> 时间：2012-12-19T00:32:18.683
> 
> 标签：jquery, firefox

我主要不是 jquery 或 javascript 程序员，可能有更有效的方法来实现这一点，但最终我在 Firefox 中调试脚本失败 8 秒后。

在命令提示符附近悬停会触发 jquery 脚本 .hover 事件，该事件会启动 jquery 动画精灵。

在除 FireFox 之外的所有浏览器中都能正常工作。在开始失败之前，它将集体播放 8 秒。这是 4 个区域/脚本中的每一个的累积值。

有没有办法修改这个脚本来调试它？

（下面的脚本是四个象限之一的摘录。所有使用的脚本暂时都内联在索引中，为了方便调试，只需访问 url 即可查看整个 she-bang）

```
 <script type='text/javascript'>

        /* timer functions */
        var intvalBR="";
        function setIntBR(){if(intvalBR===""){
                  intvalBR=window.setInterval("BR()",100);
              }else{
                  stop_IntBR();
              }
            }   

        /* timer reset functions */
        function stop_IntBR(){
                if(intvalBR!==""){
                  window.clearInterval(intvalBR);
                  intvalBR="";

              }
            }

        /* background reset functions */
        function resetBotRight(){
            $("#bottom-right").css({'background-position': '0px 0px'});
        }

        // first frame of animation
        var frame = 1;
        function BR()
        {
                var left = 400 * frame;
                // top stays 0 since all the images are have Y positioned at  0
                var top = 0;

                $('#bottom-right').css('backgroundPosition','-'+left+'px -'+top+'px');

                frame++;
        }

            $("#bottom-right-inside").hover(function(){
                $("#bottom-right-inside").addClass("bottom-right-inside");      
                setIntBR();         
            },
            function(){
                $("#bottom-right-inside").removeClass("bottom-right-inside");
                stop_IntBR();
                resetBotRight();

            });     

        });
            </script> 
```

# facebook - 如果我重新提交已批准的 Open Graph 操作，是否会删除其当前权限？

> ID：13943775
> 
> 赞同：3
> 
> 时间：2012-12-19T00:32:23.067
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

我想重新提交现有操作，以便它获得新的新闻提要预览（更大、更突出的对象链接，最近提交的操作正在生成）。如果我重新提交操作，在重新批准之前是否会公开发布？

更新：

对于每个人的参考（和保证），这是重新提交的实时动作在开发者仪表板中的样子：

![在此处输入图像描述](../Images/05ae14b725d11ec2962ce33bd95e836b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T05:22:42.880

如果您重新提交该操作，它不会影响您已经在线提交的状态。:)

您可以在这里查看：[重新提交操作](https://developers.facebook.com/docs/submission-process/opengraph/overview/#resubmit)

# prolog - 在prolog中不使用成员函数查找两个集合的交集

> ID：13943778
> 
> 赞同：3
> 
> 时间：2012-12-19T00:33:17.167
> 
> 标签：prolog

我正在研究一个接受两组并返回它们交集的函数。但是，我不想在我的代码中使用成员函数。这是成员函数：

```
member( X, [ X | T ] ).
member( X, [ _ | T ] ) :- member( X, T ). 
```

这是我到目前为止所拥有的：

```
 set_int(_,[],_).   
     set_int([H|T],[H|T1],[H|T2]) :-
           set_int(T,T1,T2).
     set_int(T,[X|T1],T2) :-
           set_int(T,T1,T2). 
```

请帮助我的逻辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:02:43.067

如果你写`set_int`来处理第一个术语的 3 种情况（一个空列表、一个元素列表和比这更长的列表），你可以有效地`set_int( [A], B, [A] )`使用`member( A, B )`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T07:01:45.290

*我认为只有在**订购*了您的套装时，您才能处置成员（或同等人员）。有了这样的假设，我们可以只比较正面：

```
set_int([X|Xs], [Y|Ys], Is) :-
    X @< Y,
    !, set_int(Xs, [Y|Ys], Is).
set_int([X|Xs], [Y|Ys], Is) :-
    X @> Y,
    !, set_int([X|Xs], Ys, Is).
set_int([Z|Xs], [Z|Ys], [Z|Is]) :-
    !, set_int(Xs, Ys, Is).
set_int(_, _, []). 
```

# bash - 如何在 bash 中处理文件内容

> ID：13943779
> 
> 赞同：0
> 
> 时间：2012-12-19T00:33:23.247
> 
> 标签：bash, sed, file-processing

我想处理内容上的 PHP 文件，但我只对**< ?php ... ?>**之间的部分感兴趣。其余部分应删除并保存到新文件中。下面我已经根据此页面[多行 sed search](http://austinmatzko.com/2008/04/26/sed-multi-line-search-and-replace/)的代码编写了部分代码。但它只给出了第一部分。

```
start="<?php"
end="?>"
temp=$(sed -n '1h;1!H;${;g;s/.*'"$start"'//pI;d;}' <<< echo $filename)
output=$(sed -n '1h;1!H;${;g;s/'"$end"'.*//p;d;}' <<< "$temp") 
```

有人有解决方案吗？awk、grep 也可以。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:03:16.090

这个单线可能适合您：

```
 awk '/<?php/{f=1} /?>/&&f{print;f=0} f'  file 
```

如果您不希望`<?php`and`?>`在输出中：

```
 awk '/<?php/{f=1;next;} /?>/&&f{f=0} f' file 
```

测试：（我希望输出是您要查找的内容。要保存到新文件，您可以将输出重定向到新文件）

```
kent$  cat test.txt 
<?php
all
text

here
should
be
saved

even if 

empty

lines

?>

foo

bar

should be removed

kent$  awk '/<?php/{f=1} /?>/&&f{print;f=0} f' test.txt                                                                                                                     
<?php
all
text

here
should
be
saved

even if 

empty

lines

?> 
```

# cakephp - 是不是可以嵌入任何类似于 CakePHP 的 PHP 框架

> ID：13943780
> 
> 赞同：0
> 
> 时间：2012-12-19T00:33:25.030
> 
> 标签：cakephp, frameworks, tidesdk

CakePHP 非常适合使用 Controller 和 shell 开发面向 Web 和后端服务器应用程序，但我有一个案例，我只需要将库嵌入到应用程序中。我正在使用 TideSDK，我需要向它公开一些 PHP 功能，我想以类似于 cakePHP 模型的行为方式来构建它，但我不需要 cake 提供的所有其他绒毛，如外壳、控制器、助手等等。只是代码 ORM / 模型 / ActiveRecord 的东西，使处理数据变得如此容易。

有没有办法使用 cakePHP 缩小并通过 PHP 类调用（没有 Web 服务器、shell 等）

或者是否有类似 CakePHP 的框架适用于这个特定领域？

我问是因为我自己开始做，但我一直在重新发明 CakePHP 核心的部分，这显然不是理想的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:25:00.113

由于 2.x 所有代码都是延迟加载的，所以如果你不使用`$this->SomeHelper->method()`它就不会被加载。`App::uses()`在自动加载器中注册类。

整个方法。

```
/**
 * Declares a package for a class. This package location will be used
 * by the automatic class loader if the class is tried to be used
 *
 * ....
 *
 * @param string $className the name of the class to configure package for
 * @param string $location the package name
 * @return void
 * @link http://book.cakephp.org/2.0/en/core-utility-libraries/app.html#App::uses
 */
    public static function uses($className, $location) {
        self::$_classMap[$className] = $location;
    } 
```

如果您不想使用某些东西，请不要调用它。

您可以查看 index.php 以了解 cake 的初始化方式。`Dispatcher`是线索，让事情顺利进行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T11:26:51.000

如果您只是想要模型功能，那么听起来您正在寻找的是 ORM（对象关系映射器）。

一些常见的有：

*   [教义](http://www.doctrine-project.org/)
*   [推进](http://www.doctrine-project.org/)

我认为也可以单独使用 FuelPHP 的 ORM 包，但我可能错了。

# mysql - 在三表连接中计算两个独立的 group by 子句

> ID：13943782
> 
> 赞同：0
> 
> 时间：2012-12-19T00:33:43.297
> 
> 标签：mysql, sql

跨三个表连接独立计算关系。

连接两个表时，我知道如何使用 count 和 group by 子句来计算一个表的 id 作为关系出现在另一个表中的次数，但无法弄清楚如何独立计算两个表的第二个此类关系。

考虑具有以下示例数据的三个表 A、B 和 C

```
Table A         Table B          Table C

|id|           |id|A_id|         |id|A_id|
 --             -- ----           -- ----
|1 |           |1 |1   |         |1 |1   |
|2 |           |2 |1   |         |2 |3   |
|3 |           |3 |3   |         |3 |2   |
|4 |           |3 |4   |         |4 |3   | 
```

在表 B 和 C 中，列 A_id 不能为 NULL，但在表 C 中，列 B_id 可以为 NULL。

我想要一个查询，这样对于表 AI 中的每个条目，将获得表 B 中相关条目的数量以及表 C 中相关条目的数量。对于上述数据，我想要一个返回以下内容的查询：

```
A_id|Count(B)|Count(C)
---- -------- --------
|1  |2       |1
|2  |0       |1
|3  |1       |2
|4  |1       |0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:36:42.210

您需要`COUNT`在子查询中使用它们。

```
SELECT  a.ID, 
        IFNULL(b.`COUNT(B)`, 0) `COUNT(B)`,
        IFNULL(c.`COUNT(C)`, 0) `COUNT(C)`
FROM    tableA a
        LEFT JOIN 
        (
          SELECT bb.A_ID, COUNT(*) `COUNT(B)`
          FROM   tableB bb
          GROUP BY A_ID
        ) b ON a.id = b.A_ID
        LEFT JOIN 
        (
          SELECT cc.A_ID, COUNT(*) `COUNT(C)`
          FROM   tableC cc
          GROUP BY A_ID
        )c ON a.ID = c.A_ID 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/e05a8/15)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:52:34.740

如果 (B.id, A_id) 和 (C.id, A_id) 的组合是唯一的，则可以使用：

```
select
  A.ID, count(distinct B.id), count(distinct C.id)
from
  A left join B on a.ID = B.A_ID
  left join C on a.ID=C.A_ID
group by A.id 
```

但如果不是，则必须使用子查询进行计数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T00:44:32.473

这比最初听起来要简单一些，尽管它需要使用子选择：

```
SELECT a.id, COALESCE(b.count, 0), COALESCE(c.count, 0)
FROM a
LEFT JOIN (SELECT a_id, COUNT(*) as count
           FROM b
           GROUP BY a_id) b
on b.a_id = a.id
LEFT JOIN (SELECT a_id, COUNT(*) as count
           FROM c
           GROUP BY a_id) c
on c.a_id = a.id 
```

在加入*之前*需要进行分组`a`，因为您最终会在某些子表中出现重复项，这可能会影响您的结果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T14:26:32.940

昨晚我在床上时想到了使用子查询的想法，所以我很高兴这是其他人的建议。我认为我的查询比上面建议的其他查询更简单，并且似乎运行得非常快，但我希望能提供关于我的查询实际上是否比已经给出的更好/更差的输入。

```
SELECT 
    TableA.id, 
    (SELECT COUNT(*) FROM TableB where TableB.A_id = TableA.id) countB,
    (SELECT COUNT(*) FROM TableC where TableC.A_id = TableA.id) countC
FROM TableA; 
```

# regex - mod_rewrite：在正则表达式中抓取第二个 URL 字符串

> ID：13943783
> 
> 赞同：2
> 
> 时间：2012-12-19T00:33:45.407
> 
> 标签：regex, apache, url, mod-rewrite

我正在处理的网站使用如下规则更改 URL：

```
RewriteRule ^(.*)/(.*)/$ string.php?id=$1&slug=$2 [L,NC] 
```

从而产生 id/slug。我想删除 ID 部分，但不知道如何只选择 slug。正在做：

```
(.*)/$ string.php?id=$1&slug=$2 [L,NC] 
```

从 ID 而不是 slug 创建一个 URL...

这可能是一个简单的答案，但我找不到它......谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:51:30.160

要仅匹配 slug，您希望将 slug 捕获到`$1`. 您的尝试捕获 a `$1`，但将其传递给`id=`.

```
# [^/]+ matches everything up to but not including /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([^/]+)$ string.php?slug=$1 [L,NC] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T03:03:26.073

我认为您的问题是您使用的是 slug=$2，但您更新的 RewriteRule 没有第二个捕获组。

```
RewriteRule ^(.*)/$ string.php?slug=$1 [L,NC] 
```

如果您的 URL 是[http://www.example.com/slug](http://www.example.com/slug)这将产生[http://www.example.com/string.php?slug=slug](http://www.example.com/string.php?slug=slug)

# php - Kohana 3.3：带有关系的 WHERE 语句

> ID：13943784
> 
> 赞同：0
> 
> 时间：2012-12-19T00:34:23.857
> 
> 标签：php, kohana

我已经设置了 Kohana 模型与关系定义（1：* 和*：*使用`through`），但想知道在`WHERE`语句中使用它们的最佳方式。

示例：我有一个`User`模型和一个`Post`模型。`Post`有一个外键 ( `userID`)`User`

我已经用别名`$_has_many`在模型上建立了关系`User``user_created`

我知道我可以使用实际的字段`userID`，但我希望能够做这样的事情

```
$user->where('user_created', 'IS', NULL); 
```

这对于检查是否有类似这样的多对多也很方便

```
'm2m_relation_count', '>', 0 
```

这可能吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T10:39:05.800

您可以通过以下方式在 Kohana 中使用 ORM 执行此操作。

```
$user->user_created->find_all(); 
```

这将导致用户创建的所有帖子。

如果您想检查用户是否创建了帖子，您只需使用相同的函数并对`count()`结果执行 a 并检查它是否大于 0。

我认为您不能在`where`子句本身中使用别名。您必须从 ORM 对象中调用它。

多对多关系的工作方式相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T19:08:50.993

1）没有快速的方法可以让所有用户都没有帖子。我更喜欢添加特殊列`post_count`并在发布后增加它。

2）您可以检查用户与`has()`/`has_any()`方法的 m:m 关系：

```
if ($user->has('roles')) { 
    // user has at least one role
}

if ($user->has('roles', $roleId) {
    // user has role with id=$roleId
}

if ($user->has('roles', array($roleId1, $roleId2))) {
    // user has both $roleId and $roleId2 roles
}

if ($user->has_any('roles', array($roleId1, $roleId2))) {
    // user has on of the $roleId1 or $roleId2
} 
```

# macos - 如何在 C++ 中模拟按键和鼠标点击

> ID：13943787
> 
> 赞同：2
> 
> 时间：2012-12-19T00:34:59.067
> 
> 标签：macos, cocoa

如何在 C++ 中模拟鼠标单击/按键？当我运行程序时，我希望它单击鼠标左键并按“A”。谢谢！（我正在为 MacOSX 制作这个程序）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:55:21.307

我没有为 OSX 做任何编程，但我认为这就是你要找的：

[https://developer.apple.com/library/mac/#documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html](https://developer.apple.com/library/mac/#documentation/Carbon/Reference/QuartzEventServicesRef/Reference/reference.html)

特别是 CGEventPost

# z3 - 如何使用 C-API 为 z3_solver 设置超时？

> ID：13943794
> 
> 赞同：1
> 
> 时间：2012-12-19T00:35:23.757
> 
> 标签：z3

我正在使用 Z3_solver 进行非线性实数算术。我还想为求解器设置超时。我正在使用以下代码，但看起来超时不起作用，因为求解器永远运行。谁能帮我找出问题所在？

```
 Z3_solver solver;
  cfg = Z3_mk_config();
  ctx = Z3_mk_context(cfg);

  Z3_symbol logic_symbol = Z3_mk_string_symbol(ctx, "QF_UFNRA");
  solver = Z3_mk_solver_for_logic((Z3_context)ctx, logic_symbol);
  Z3_solver_inc_ref(ctx, solver);

  Z3_params params = Z3_mk_params(ctx);  
  Z3_params_inc_ref(ctx, params);
  Z3_symbol r = Z3_mk_string_symbol(ctx, ":timeout");    
  Z3_params_set_uint(ctx, params, r, 10);
  Z3_solver_set_params(ctx, solver, params);  
  Z3_params_dec_ref(ctx, params);

  Z3_del_config(cfg);

  ....
  Z3_solver_assert(ctx,solver,pred);
  Z3_lbool b = Z3_solver_check(ctx, solver); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:25:53.460

您在 Linux 或 FreeBSD 上使用 Z3 吗？我最近修复了一个影响这两个系统的计时器设置问题（提交：http: [//z3.codeplex.com/SourceControl/changeset/9674f511b3c1](http://z3.codeplex.com/SourceControl/changeset/9674f511b3c1)）

该修复程序已在“进行中的工作”分支中可用。您可以使用检索它

```
git clone https://git01.codeplex.com/z3 -b unstable 
```

我使用以下 python 脚本对其进行了测试。顺便说一句，如果您发现“不稳定”分支存在问题，请报告。

```
from z3 import *
a1, a2, t1, t2 = Reals('a1 a2 t1 t2'); 
s = SolverFor("QF_NRA")
s.add( a1 + a2 == 2,
       a1*t1 + a2*t2 == Q(2,3),
       a1*t1*t1 + a2*t2*t2 == Q(2,5),
       a1*t1*t1*t1 + a2*t2*t2*t2 == Q(2,7) )
# On my machine, I get unknown when I set the timeout to 1ms.
s.set(timeout=1) 
print s.check() 
```

**编辑：** 以下是关于如何构建 Z3`unstable`分支（又名“工作中”分支）的说明：

假设：我们将 Z3 源代码放在目录`~/code`中，并且我们不会执行系统范围的安装。

```
cd ~
mkdir -p code
cd code
git clone https://git01.codeplex.com/z3 -b unstable
cd z3 
python scripts/mk_make.py 
cd build 
make 
```

顺便说一句，如果你有一台多核机器，你可以通过使用加快编译步骤

```
make -j N 
```

代替

```
make 
```

`N`您的机器中的内核数在哪里。

# java - 如何在 ActionBarSherlock 4.2.0 中启用强制溢出模式？

> ID：13943795
> 
> 赞同：1
> 
> 时间：2012-12-19T00:35:24.700
> 
> 标签：java, android, xml

好的，所以是的，我知道该功能在 4.2.0 中已删除，并且“一开始就不应该添加”，但有些人仍在使用它，我将它与 HoloEverywhere 一起使用，所以我该如何启用它？我要去哪？它是在 ABS 的配置文件还是 java 文件中？拜托，我知道人们对这个功能的感受，我知道人们对它的感受，所以请不要回答“看看某某的评论：”或“这在 4.2.0 中被删除了ETC”。我想再次为所有主题启用强制溢出模式（absForceOverflow）：浅色、深色、混合还是自定义？请帮助所有答案都有帮助，除了我已经看过的那些。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T03:01:18.913

由于该功能已从 4.2 代码中删除，因此无法快速启用它。你有几个选择——

1) 继续使用版本 4.1 而不是 4.2 2) 分叉代码并将 4.2 更新与包含强制溢出的 4.1 代码库合并。其他人可能已经这样做或正在研究，因为这个功能似乎有一个重要的用户群，但我没有通过快速谷歌搜索找到它 3）看看[这个模拟溢出按钮的答案](https://stackoverflow.com/questions/12875081/actionbarsherlock-forceoverflow-resource-not-found)，它似乎有与 ABS 不同，它适用于 4.0+ 设备的优势。

# perl - 需要关于 perl 中的内存使用的建议

> ID：13943796
> 
> 赞同：4
> 
> 时间：2012-12-19T00:35:31.860
> 
> 标签：perl, memory-management

我对 perl 并不陌生，但我无法解决这个用例。

这是我的问题陈述：

我正在使用 Activestate perl 5.12 32 位。我想一次在内存中保存一些 32 x 8MB 的 double 数组。不幸的是，在这种情况下，我遇到了“内存不足”错误。例如，下面的代码会导致内存不足。

```
my $aref1 = [(.25) x (8*1024*1024)];
my $aref2 = [(.25) x (8*1024*1024)];
my $aref3 = [(.25) x (8*1024*1024)];
my $aref4 = [(.25) x (8*1024*1024)];
my $aref5 = [(.25) x (8*1024*1024)];
my $aref6 = [(.25) x (8*1024*1024)];
my $aref7 = [(.25) x (8*1024*1024)];
my $aref8 = [(.25) x (8*1024*1024)];
my $aref9 = [(.25) x (8*1024*1024)];
my $aref10 = [(.25) x (8*1024*1024)]; 
```

有什么方法可以有效处理吗？

**注意：**无论如何，在执行的任何时候都需要尽可能快地访问数组（因为用户不能等待太久）

我尝试过的选项：

1.  DBM::Deep - 需要更多时间
2.  PDL - 给出 32 x 8MB 双精度数组的“内存不足”错误

期待您的宝贵建议！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-19T00:55:26.900

32 个数组 * 8 个 Mi-doubles/数组 * 8 个字节/double = 2 GiB。

Windows 上的 32 位进程只有 2GiB 的可用地址空间。您的原始数据将占用所有可用的地址空间，而不会为数据结构的开销`perl`、您的程序和其他变量留下任何东西。它适合内存的唯一方法是切换到 64 位 Perl。否则，您将不得不面对一个必然较慢的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T00:42:27.147

这将为每个元素创建一个 perl 值，这将非常繁重。您可能想查看将值存储为双精度值的东西，例如[Tie::CArray](https://metacpan.org/module/Tie%3a%3aCArray)或[Tie::Array::PackedC](https://metacpan.org/module/Tie%3a%3aArray%3a%3aPackedC)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T15:48:55.477

Here is what I get on my Windows XP SP3 system using ActiveState Perl 5.14.2\. Task manager was showing `Commit charge: 778M/3958M` when I ran the following script:

```
#!/usr/bin/env perl

use strict;
use warnings;

use Devel::Size qw(total_size);

my $unit = 1024 * 1024;
my $topj = (8 * $unit) - 1;
my @data;

for my $i (0 .. 31) {
    print "$i: ";
    my @row;
    $#row = $topj;
    for my $j (0 .. $topj) {
        $row[$j] = 0.25;
    }
    push @data, \@row;
    printf "%.0f\n", total_size(\@data)/$unit;
} 
```

Output:

```
C:\temp> yy
0: 224
1: 448
2: 672
3: 896
4: 1120
5: 1344
6: 1568
7: 1792
Out of memory!
8:
```

On the other hand, the following C program does better:

```
#include <stdlib.h>
#include <stdio.h>

#define ROWSIZE 8*1024*1024

int main(void) {
    int n = 1;
    while (calloc(ROWSIZE, sizeof(double))) {
        printf("%d: success!\n", n);
        n += 1;
    }
    return 0;
} 
```

Output:

```
1: success!
2: success!
3: success!
…
26: success!
27: success!
```

for the same 1.7GB footprint.

# c++ - 由于迭代器而无法打印多图

> ID：13943800
> 
> 赞同：0
> 
> 时间：2012-12-19T00:35:45.993
> 
> 标签：c++, multimap

嘿，我试图打印出我的多图值，但我得到了一个错误

```
for ( multimap< int, Questions, less< int > >::iterator iterator = question_map.begin();
      iterator != question_map.end(); ++iterator )
      cout << iterator->first << '\t' << iterator->second << '\n'; 
```

错误指出：

```
Error   1   error C2679: binary '<<' : no operator found which takes a right-hand operand of type 'Questions' (or there is no acceptable conversion)    c:\users\conor\documents\college\dkit - year 2 - repeat\dkit - year 2 - semester 1 - repeat\games programming\millionaire\millionaire\questions.cpp 31  1   Millionaire 
```

这是我的其余代码：

```
Questions.h
#ifndef QUESTIONS_H
#define QUESTIONS_H
#include <string>
#include <algorithm>
#include <map>
#include <iostream>
using namespace std;

class Questions
{
public:
    Questions();
    Questions(string question,string correctAnswer, string wrongAnswer1,string wrongAnswer2,string wrongAnswer3);
    //void shuffle(string *array, int n);
    //string getQuestion();
    //string getCorrectAnswer();
    //string getAnswers();
    //bool checkAnswer(string answer);
    void questionStore();
    //void addQuestion(int level, Questions question);
    //Questions printQuestion(int level);
    //ostream& operator<<(const ostream& out, const Questions& q);

private:
    string question;
    string correctAnswer;
    string wrongAnswer1;
    string wrongAnswer2;
    string wrongAnswer3;
    multimap<int,Questions> question_map;
};

#endif 
```

问题.cpp

```
#include <iostream>
#include "Questions.h"
using namespace std;
Questions :: Questions()
{

}
Questions :: Questions(string question,string correctAnswer, string wrongAnswer1,string wrongAnswer2,string wrongAnswer3)
{
}

void Questions :: questionStore()
{
Questions q1 = Questions("Whats the oldest known city in the world?", "Sparta" , "Tripoli" , "Rome", "Demascus");
Questions q2 = Questions("What sport in the olympics are beards dissallowed?", "Judo", "Table Tennis" , "Volleyball", "Boxing");
Questions q3 = Questions("What does an entomologist study?", "People" , "Rocks" , "Plants", "Insects");
//string q4 = ("Where would a cowboy wear his chaps?", "Hat" , "Feet" , "Arms", "Legs");
//tring q5 = ("which of these zodiac signs is represented as an animal that does not grow horns?", "Aries" , "Tauris" , "Capricorn", "Aquarius");
//string q6 = ("Former Prime Minister Tony Blair was born in which country?", "Northern Ireland" , "Wales" , "England", "Scotland");
//string q7 = ("Duffle coats are named after a town in which country?", "Austria" , "Holland" , "Germany", "Belgium");
//string q8 = ("The young of which creature is known as a squab?", "Horse" , "Squid" , "Octopus", "Pigeon");
//string q9 = ("The main character in the 2000 movie ""Gladiator"" fights what animal in the arena?", "Panther" , "Leopard" , "Lion", "Tiger");

question_map.insert(pair<int,Questions>(1,q1));
question_map.insert(pair<int,Questions>(1,q2));
question_map.insert(pair<int,Questions>(1,q3));

for ( multimap< int, Questions, less< int > >::iterator iterator = question_map.begin();
      iterator != question_map.end(); ++iterator )
      cout << iterator->first << '\t' << iterator->second << '\n';
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:47:27.280

将 operator<< 添加为 Qeustions 的朋友，以便它可以访问 Question 类的私有成员。

在 Questions.h 中，将 operator<< 声明为非成员函数

```
class Questions
{
public:
    Questions();
    Questions(string question,string correctAnswer, string wrongAnswer1,string wrongAnswer2,string wrongAnswer3);
    void questionStore();
private:
    string question;
    string correctAnswer;
    string wrongAnswer1;
    string wrongAnswer2;
    string wrongAnswer3;
    multimap<int,Questions> question_map;

    friend std::ostream& operator<<(std::ostream& stream, Questions const& q);
};

std::ostream& operator<<(std::ostream& stream, Questions const& q); 
```

在 Questions.cpp 中，定义 operator<< 函数

```
std::ostream& operator<<(std::ostream& stream, Questions const& q)
{
    stream << q.question << " " << q.correctAnswer;  
    return stream;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:40:22.250

您尚未定义用于流式传输类型对象的函数`Question`。

您需要定义函数：

```
std::ostream& operator<<(std::ostream& stream, Question const& question); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T00:41:05.677

看起来您必须为您的 Questions 类重载 << 运算符：

宣言：

```
friend ostream &operator<<(ostream &out, const Question& q); 
```

定义：

```
ostream &operator<<(ostream &out, const Question& q)
{
    out << q.question;
    return out;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T00:41:39.750

错误消息非常直接地告诉您问题：您正在尝试将类型的对象插入`Questions`流中，但是您的：

```
//ostream& operator<<(const ostream& out, const Questions& q); 
```

仅作为评论出现。你需要写一些代码。此外，它不能是 Questions 类的成员。通常它是一个全局重载，是类的朋友，所以在类定义中你可以把它改成这样：

```
friend ostream &operator<<(ostream &out, const questions &q) { 
    return out << d.question; // probably other fields here
} 
```

# python - 从一行中的 2 个列表打印

> ID：13943801
> 
> 赞同：2
> 
> 时间：2012-12-19T00:35:46.973
> 
> 标签：python

到目前为止我所拥有的：

```
def balance_equation(species,coeff):
  data=zip(coeff,species)
  positive=[]
  negative=[]
  for (mul,el) in data:
    if int(mul)<0:
      negative.append((el,mul))
    if int(mul)>0:
      positive.append((el,mul)) 
```

我知道这不会打印任何东西。我拥有的是一个包含两个列表`species=['H2O','O2','CO2']`和`coeff=['1','3','-4']`. 我需要它像这样打印： `1H20+3O2=4CO2`

我首先将负系数和物种放在一个列表中，将正值放在另一个列表中。我似乎能够让这两个打印正确。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T00:44:55.160

尝试这个：

```
species = ["H2O", "CO2", "O2"]
coeff = ['1', '-4', '3']

pos = [c + s for c, s in zip(coeff, species) if int(c) > 0]
neg = [c[1:] + s for c, s in zip(coeff, species) if int(c) < 0]
print ("+".join(pos))+"="+("+".join(neg)) 
```

**编辑**：我拿出了空格。 **第二次编辑**：`coeff`是字符串列表。

您还应该测试是否`pos`为空，以便在适当的时候`neg`用 s 替换它们。`0`看起来系数是整数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T00:54:55.637

把事情分解成几个步骤是解决问题的好方法（你以后总是可以重新组合这些步骤），而且你已经完成了 80% 的工作。

您已经拥有`positive`和`negative`列表。因此，您需要将每个转换为字符串，然后只需：

```
print poshalf, "=", neghalf 
```

那么，如何转换`positive`成`poshalf`? 嗯，它是每个成员的表示，用 分隔`'+'`，所以如果你有一个`stringify`可以将每个成员转换为它的表示的函数，它只是：

```
poshalf = '+'.join(stringify(el, mul) for (el, mul) in pos)
neghalf = '+'.join(stringify(el, mul)[1:] for (el, mul) in neg) 
```

那里是`[1:]`拿出`-`标志。如果`mul`实际上是整数而不是字符串，则在将值传递给之前将其取反可能是有意义的`stringify`：

```
neghalf = '+'.join(stringify(el, -mul) for (el, mul) in neg) 
```

现在，那个“stringify”函数是什么样的？好吧，每个成员都是一`(el, mul)`对。如果它们都是字符串，您可以添加它们。根据您之前的问题，`mul`此时可能最终会成为某种数字，但这几乎同样简单：

```
def stringify(el, mul):
    return str(mul) + el 
```

把它们放在一起，你就完成了。

使这一切变得更简单的一种方法：如果您从不将其`(el, mul)`用于任何其他目的，除了调用`stringify`它，只需`stringify`首先调用并存储结果：

```
def balance_equation(species,coeff):
  data=zip(coeff,species)
  positive=[]
  negative=[]
  for (mul,el) in data:
    if int(mul)<0:
      negative.append(str(mul)[1:] + el)
    if int(mul)>0:
      positive.append(str(mul) + el)
  return positive, negative 
```

请记住最后一行，您已经忽略了上一个问题和这个问题的两个版本！如果您从不返回这些值，那么找出它们的所有努力都将被浪费，而调用者只会得到`None`答案。

显然 the`str`或 the`int`是不必要的，但为了安全起见，我把它们都留在了；您应该查看周围的代码并删除不必要的代码。（如果你把它`mul`当作一个 int，你可能想要`str(-mul)`代替`str(mul)[1:]`，如前所述。）

一旦你掌握了这个，如果你理解列表推导，你可能会意识到这是一个熟悉的模式：从 开始`[]`，循环遍历其他集合，`append`每个值都满足一些测试。换句话说：

```
def balance_equation(species,coeff):
  data=zip(coeff,species)
  positive = [str(mul) + el for (mul, el) in data if int(mul) > 0]
  negative = [str(mul) + el for (mul, el) in data if int(mul) < 0]
  return positive, negative 
```

您可能会注意到您可以进一步简化这一点——您使用列表的唯一目的是构建字符串，因此您可能只需要一个返回字符串方程的函数（在这种情况下，您可以使用生成器表达式而不是列表理解——如果你还不知道它们，忽略那部分）。

```
def balance_equation(species,coeff):
  data=zip(coeff,species)
  positive = '+'.join(str(mul) + el for (mul, el) in data if int(mul) > 0)
  negative = '-'.join(str(mul) + el for (mul, el) in data if int(mul) < 0)
  return positive + '=' + negative 
```

当然，现在您返回的是一个字符串而不是一对列表，因此您必须将调用代码更改为 just`print balance_equation(species, coeff)`而不是组合列表。

最后一件事：您似乎在每次调用时都颠倒了系数/乘数和物种/元素的顺序。例如：

```
def balance_equation(species,coeff):
  data=zip(coeff,species) 
```

除非有充分的理由不这样做，否则最好选择一个订单并始终保持一致，否则你总是会遇到一个让它们倒退的错误。

# php - Javascript和php交互要经过一个数组

> ID：13943805
> 
> 赞同：1
> 
> 时间：2012-12-19T00:36:06.010
> 
> 标签：php, javascript

> **可能重复：**
> [参考：为什么我的 Javascript 中的 PHP 代码不起作用？](https://stackoverflow.com/questions/13840429/reference-why-does-the-php-code-in-my-javascript-not-work)

这是我尝试浏览一系列图片的尝试。

$rows2 是一个图片数组。我可以手动

```
 echo '<img src="' . $rows2[0] . '"/>'; 
```

或者

```
 echo '<img src="' . $rows2[1] . '"/>'; 
```

或者

```
 echo '<img src="' . $rows2[2] . '"/>'; 
```

这很好用。因此，我添加了一个 javascript 按钮和一个警报按钮进行测试。

我可以看到 var 从 0 变为 1 到 2 但是，任何时候都没有出现图片。

```
<div class="half" id="right">
<?
     echo '<img src="' . $rows2["<script>document.write(counter)</script>"] . '"/>';

?>
<button onclick="counter++">Increment</button>
<button onclick="counter--">Decrement</button>
<button onclick="alert(counter)">alert</button>

</div> 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:44:08.560

我认为您对 Javascript 和 PHP 的交互方式存在误解。您的 PHP 将运行并发送到客户端。客户端浏览器将收到以下信息：

```
<div class="half" id="right">
<img src=""/>
<button onclick="counter++">Increment</button>
<button onclick="counter--">Decrement</button>
<button onclick="alert(counter)">alert</button>
</div> 
```

请注意， src 是空的，因为（大概）`$rows2`没有带键的值`<script>document.write(counter)</script>`

您必须重新编写代码，以便 Javascript 已经拥有它需要的所有信息（即通过将图像数组写入 javascript）。

# javascript - 遍历具有所有唯一 ID 的多维数组

> ID：13943806
> 
> 赞同：3
> 
> 时间：2012-12-19T00:36:08.233
> 
> 标签：javascript, multidimensional-array

我有一个多维数组，但 ID 在父母和孩子之间是唯一的，所以我在使用 for 循环进行循环时遇到问题。问题是我似乎无法获取孩子们的身份证。你觉得我应该怎么处理？

```
 var Options = [
            {
                id: 0,
                children: []
            },
            {
                id: 2,
                children: []
            },
            {
                id: 3,
                children: [
                    {
                        id: 4,
                        children: []
                    },
                    {
                        id: 5,
                        children: []
                    },
                    {
                        id: 6,
                        children: []
                    }
                ]
            },
            {
                id: 7,
                children: [
                    {
                        id: 8,
                        children: []
                    },
                    {
                        id: 9,
                        children: []
                    }
                    ]
            }
        ]; 
```

为了简洁起见，我保持代码简洁。我想要做的是遍历数组来比较 ID。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T00:46:13.323

这看起来不像“多维数组”，而更像一棵树。循环一层可以用一个简单的for循环来完成：

```
for (var i=0; i<Options.length; i++) // do something 
```

要按顺序循环树，您将需要一个递归函数：

```
function loop (children, callback) {
    for (var i=0; i<children.length; i++) {
        callback(children[i]);
        loop(children[i].children, callback);
    }
}
loop(Options, console.log); 
```

要通过他们的 id 获取所有子项，以便您可以遍历 ids（无论树结构如何），请使用查找表：

```
var nodesById = {};
loop(Options, function(node) {
    nodesById[node.id] = node;
});
// access:
nodesById[4]; 
```

...并按 id 排序循环它们，你现在可以做

```
Object.keys(nodesById).sort(function(a,b){return a-b;}).forEach(function(id) {
    var node = nodesById[id];
    // do something
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T00:44:16.377

递归呢？

```
var findById = function (arr, id) {
    var i, l, c;
    for (i = 0, l = arr.length; i < l; i++) {
        if (arr[i].id === id) {
            return arr[i];
        }
        else {
            c = findById(arr[i].children, id);
            if (c !== null) {
                return c;
            }
        }
    }
    return null;
}

findById(Options, 8); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-19T00:44:29.837

啊，使用递归：D

```
var Options = "defined above";//[]
var OptionArray = []; //just as an example (not sure what you want to do after looping)
(function looper(start){
 for( var i = 0, len = start.length; i < len; i++ ){
  var currentOption = start[i];
  if( currentOption.id > 3 ){//could be more complex
   OptionArray.push(currentOption);
  }
  if( currentOption.children.length > 0 ){
   looper(currentOption.children);
  }
 }
})(Options); 
```

# iphone - 从 TabBar 调用 ActionSheet

> ID：13943809
> 
> 赞同：4
> 
> 时间：2012-12-19T00:36:45.447
> 
> 标签：iphone, objective-c, ios, uitabbar, uiactionsheet

我有一个带有 4 个按钮（主页、访问、分享、更多）的标签栏。我希望标签栏中的“共享”按钮调用一个操作表，该操作表具有适当的按钮来选择我希望用户能够分发到应用程序的链接（Facebook、Twitter、电子邮件等）的特定渠道。

我可以使用 Storyboard 来做到这一点，但我必须创建一个独特的（空白）视图控制器，该控制器链接到选项卡栏中的“共享”按钮。我将以下代码放在 viewDidAppear 方法中，以在选择“共享”按钮时显示操作表：

```
int selectedTab = self.tabBarController.selectedIndex;

if (selectedTab == 2)
{
    UIActionSheet *actionSheet = [[UIActionSheet alloc] initWithTitle:@"Share Your Visit with Friends!" delegate:self cancelButtonTitle:@"Cancel" destructiveButtonTitle:nil otherButtonTitles:@"Facebook", @"Twitter", @"Email eduLaunchpad", nil];

    [actionSheet showFromTabBar:self.tabBarController.tabBar];
} 
```

当我关闭操作表时，我会默认返回主视图：

```
[self.tabBarController setSelectedIndex:0]; 
```

虽然这可行，但从用户的角度来看并不是最佳的。我希望操作表出现在选择“共享”按钮时显示的特定视图上。例如，如果用户在“访问”视图上并从选项卡栏中选择了“共享”，我希望操作表显示在访问视图的顶部，并且该视图在操作表后面可见。

我可以使用 Storyboard 实现这一目标吗？或者我需要一个自定义标签栏来实现这个功能吗？如果需要自定义选项卡栏，我将不胜感激有关如何实现包括自定义选项卡栏以及选项卡栏的操作表的指导/见解。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T03:31:01.447

我也需要这个，搜索了一下，最终在 UITabBarController 上构建了以下类别。

让操作表出现在当前选项卡上的技巧是您永远不想实际访问该操作表呈现选项卡。使用启动操作表的 UIButton 覆盖该位置的选项卡栏。

像往常一样在情节提要中绘制标签栏，在发生特殊行为的位置留下一个空栏项目。然后添加这个类别...

```
//  UITabBarController+Button.h

@interface UITabBarController (Button) <UIActionSheetDelegate>
- (void)replaceItemAtIndex:(NSUInteger)index withButtonImage:(UIImage*)buttonImage;
@end

//  UITabBarController+Button.m

#import "UITabBarController+Button.h"

#define kBUTTON_TAG   4096

@implementation UITabBarController (Button)

- (void)replaceItemAtIndex:(NSUInteger)index withButtonImage:(UIImage*)buttonImage {

    UIButton *button = (UIButton *)[self.view viewWithTag:kBUTTON_TAG];

    if (!button) {
        button = [UIButton buttonWithType:UIButtonTypeCustom];
        button.tag = kBUTTON_TAG;
        [button setBackgroundImage:buttonImage forState:UIControlStateNormal];
        [button addTarget:self action:@selector(buttonTapped:) forControlEvents:UIControlEventTouchUpInside];

        UITabBar *bar = self.tabBar;
        CGFloat width = bar.frame.size.width / bar.items.count;
        button.frame = CGRectMake(index*width, bar.frame.origin.y, width, bar.frame.size.height);

        [self.view addSubview:button];
    }
}

#pragma mark - Handle button tap

- (void)buttonTapped:(id)sender {

    UIActionSheet *sheet = [[UIActionSheet alloc] initWithTitle:@"Action Sheet:"
                                        delegate:self
                               cancelButtonTitle:@"Cancel"
                          destructiveButtonTitle:nil
                               otherButtonTitles:@"Action A", @"Action B", @"Action C", nil];

    [sheet showFromTabBar:self.tabBar];
} 
```

使用 index < tabBar.items.count 和按钮的图像调用它。如果是你应用的根vc，你可以这样调用它：

```
#import "the category i suggest above"

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // whatever else you do in here, then
    NSLog(@"%@", self.window.rootViewController);  // make sure this is a UITabBarController
    // if it is, then ...
    UITabBarController *tbc = (UITabBarController *)self.window.rootViewController;
    [tbc replaceItemAtIndex:2 withButtonImage:[UIImage imageNamed:@"some image name"]];

    return YES;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T12:10:33.243

而不是从标签栏打开操作表

```
[actionSheet showFromTabBar:self.tabBarController.tabBar]; 
```

使用此代码。

```
[actionSheet showInView:[UIApplication sharedApplication].keyWindow]; 
```

# java - 其他面板的背景图片问题

> ID：13943810
> 
> 赞同：2
> 
> 时间：2012-12-19T00:36:53.777
> 
> 标签：java, image, swing, background-image, jlabel

所以我为纸牌游戏 War 创建了一个程序。一切都完成了，除了我想添加一个背景。问题是我不知道如何添加背景图片，以便其他 JLabels 和 JButtons 仍然出现在图片的顶部。是否可以为我设置背景图片，以便其他面板也显示在顶部？到目前为止，我的程序是这样的：

```
public War()
{
    JFrame frame = new JFrame();

    frame.setSize(500, 500);
    frame.setTitle("WAR");
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setLayout(new BorderLayout());

    //Set up for background image
    Background = new JPanel();
    Background.add(new Background("Background.png"));
    frame.add(Background);
    Background.setLayout(new OverlayLayout(Background));

    cardPanel = new JPanel (new GridLayout(2,1));
    ///create labels and init with card back
    String strCard1 = "cardback.png";
    String strCard2 = "cardback.png";
    lblPlayer1Card = new JLabel(new ImageIcon(strCard1));
    lblPlayer2Card = new JLabel(new ImageIcon(strCard2));
    cardPanel.add(lblPlayer1Card);
    cardPanel.add(lblPlayer2Card);

    //Create panels for when war is played
    warPanel = new JPanel (new GridLayout(2, 3));
    String emptycards = "blankcard.png";
    player1war1 = new JLabel(new ImageIcon(emptycards));
    player1war2 = new JLabel(new ImageIcon(emptycards));
    player1war3 = new JLabel(new ImageIcon(emptycards));
    player2war1 = new JLabel(new ImageIcon(emptycards));
    player2war2 = new JLabel(new ImageIcon(emptycards));
    player2war3 = new JLabel(new ImageIcon(emptycards));
    warPanel.add(player1war1);
    warPanel.add(player1war2);
    warPanel.add(player1war3);
    warPanel.add(player2war1);
    warPanel.add(player2war2);
    warPanel.add(player2war3);

    // Create a panel
    btnPanel = new JPanel(new GridLayout(2,2));
    //set up next card button
    JButton btnNext = new JButton("Next Card");
    NextListener listener1 = new NextListener();
    btnNext.addActionListener(listener1);
    //set up new game button
    JButton btnNewGame = new JButton("New Game");
    NewGameListener listener2 = new NewGameListener();
    btnNewGame.addActionListener(listener2);

    //Sets up new panel showing size of main pile and discard pile of both players
    statusPanel = new JPanel(new GridLayout(4,2));

    //status labels that show the size of piles
    status1 = new JLabel("");// Size of player 1's main pile
    status2 = new JLabel("");//Size of player 1's discard pile
    status3 = new JLabel("");//Size of player 2's main pile
    status4 = new JLabel("");//Size of player 2's discard pile
    statusWar = new JLabel("");//Status label that shows the winner of War
    statusEmpty1 = new JLabel(""); // Creates empty status to put space between War status and size statuses
    statusEmpty2 = new JLabel(""); // Creates empty status to put space between War status and size statuses

    statusBar = new JLabel("");

    //Adds the labels to the panels
    btnPanel.add(btnNext);
    btnPanel.add(btnNewGame);
    btnPanel.add(statusBar);
    statusPanel.add(status1);
    statusPanel.add(status2);
    statusPanel.add(status3);
    statusPanel.add(status4);
    statusPanel.add(statusEmpty1);
    statusPanel.add(statusEmpty2);
    statusPanel.add(statusWar);

    cardPanel.setOpaque(false);
    btnPanel.setOpaque(false);
    statusPanel.setOpaque(false);
    warPanel.setOpaque(false);

    //The layout of the frame
    Background.add(cardPanel, BorderLayout.WEST);
    Background.add(btnPanel, BorderLayout.SOUTH);
    Background.add(statusPanel, BorderLayout.NORTH);
    Background.add(warPanel, BorderLayout.EAST);

    frame.setVisible(true);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T03:47:00.083

创造你的自我`JLabel`。加载图像并将其应用于标签 ( `JLabel#setIcon`)。

将标签布局管理器设置为您需要的。像往常一样将其他组件添加到标签中。

将标签添加到框架中。

看一眼

*   [将 JLabel 放在 JLabel 的顶部，其中包含图像](https://stackoverflow.com/questions/12253979/place-jlabel-on-top-of-jlabel-with-image-in/12254063#12254063)
*   [一个框架中有多个 JPanel / 有一个背景图像和另一个在顶部带有组件的层](https://stackoverflow.com/questions/13886476/more-than-one-jpanel-in-a-frame-having-a-brackground-image-and-another-layer-w/13886648#13886648)

举些例子

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T01:02:50.107

使“框架”成为匿名内部类。覆盖“绘画”方法。通过作为“paint”中的参数发送的 Graphics 对象绘制背景图像。然后，调用超类的“paint”，绘制所有的GUI元素。例子：

```
final Image backgroundImage = ...(load image);
JFrame frame = new JFrame() {
    @Override
    public void paint(java.awt.Graphics g) {
        g.drawImage(backgroundImage); // draw the background image
        super.paint(); // call the superclass method so all the 
                                // GUI elements are still drawn.
    }
}; 
```

当然，如果您对他们有一些私人恩怨，您不必将其设为匿名内部类。你总是可以这样做：

```
public class GameFrame extends JFrame {
    private Image backgroundImage;
    public GameFrame() {
        super(); // call the super constructor 
        backgroundImage = ...(load image);
    }
    @Override
    public void paint(java.awt.Graphics g) {
        g.drawImage(backgroundImage); // draw the background image
        super.paint(); // call the superclass method so all the 
                                // GUI elements are still drawn.
    }
} 
```

编辑：我正在看这个，你可能必须用 JPanel“背景”而不是 JFrame“框架”来做我在这里展示的事情，因为它看起来像 JPanel 完全覆盖了“框架”。如果用继承 JFrame 的类做我在这里展示的事情不起作用，我会认为这是因为 JPanel 覆盖了在 JFrame 上绘制的任何东西，所以除了“背景”之外，只需做同样的事情。

# sql-server - 如何使用联接或内部联接构造查询

> ID：13943815
> 
> 赞同：0
> 
> 时间：2012-12-18T22:22:43.603
> 
> 标签：sql-server, sql, join, subquery

我有一个包含三个表的数据库

```
table1         table2       table3
Id             Id           Id
name           price        servicename
serviceTypeId  Type
               serviceId
               nameId 
```

如何构造一个查询以向我显示只有 table1 的名称、table2 的类型和 table3 的服务名的唯一行？serviceTypeId 是表 2 的外键，serviceId 是表 3 的外键，nameId 是表 1 的外键。我正在为连接内连接概念而苦苦挣扎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T22:28:41.863

形成您的定义 1 参考似乎已经结束，如果您正在寻找，我不确定

```
Select DISTINCT Table1.name,Table2.[Type],Table3.Servicename
From Table1
Join Table2 on Table1.serviceTypeId=Table2.ID
Join Table3 on Table3.ID=Table2.serviceId 
```

或者

```
Select DISTINCT Table1.name,Table2.[Type],Table3.Servicename
From Table2
Join Table1 on Table1.Id=Table2.nameID
Join Table3 on Table3.ID=Table2.serviceId 
```

# c# - .net 中“组件”的“站点”是什么？

> ID：13943819
> 
> 赞同：6
> 
> 时间：2012-12-19T00:37:52.270
> 
> 标签：c#, .net

我是一名新测试人员，在阅读遗留代码时，我有以下两个类：

```
public class TestCommon : Component
{
    public void Initialize()
    {
        var serviceContainer = (IServiceContainer)this.GetService(typeof(TestFramework));
        serviceContainer.AddService(typeof(TestCommon), this);
    }
}

public class TestFramework : ISite, IServiceContainer
{
    readonly Hashtable services = new Hashtable();
    public TestFramework()
    {
        this.AddService(this);

        var bedrockModuleInstance = (TestCommon)Activator.CreateInstance(typeof(TestCommon));
        ((TestCommon)bedrockModuleInstance).Site = this;
        ((TestCommon)bedrockModuleInstance).Initialize();
    }
} 
```

我不明白为什么在TestCommon 类的Initialize 方法中，可以调用GetService 并以某种方式返回调用TestFramework 的GetService？我试图通过阅读有关容器、组件和站点的 MSDN 来理解它，但无法理解站点的概念。

**更新：** 阅读 GetService 的实现，发现组件的 GetService 实际返回其站点的 GetService，回答了我的问题。

```
 protected virtual object GetService(Type service) { 
        ISite s = site;
        return((s== null) ? null : s.GetService(service)); 
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T01:59:16.827

找到了答案。阅读 GetService 的实现，发现组件的 GetService 实际返回其站点的 GetService，回答了我的问题。

```
protected virtual object GetService(Type service) { 
    ISite s = site;
    return((s== null) ? null : s.GetService(service)); 
} 
```

# c++ - 访问冲突。使用 GLEW 和 GLFW 时

> ID：13943825
> 
> 赞同：5
> 
> 时间：2012-12-19T00:38:20.587
> 
> 标签：c++, opengl, glew, glfw

我确信一切都是正确链接的。我最初使用的是来自非官方 GLSDK 的 glload 和 glfw，但后来我决定取消 glload，这意味着我必须使用 glew 才能获得现代标头。

```
#include <GL/glew.h>
#include <GL/glfw.h> 
```

根据说明，我在 glfw 之前包含了 glew 。

在运行期间，OpenGL 窗口打开

```
//(relevant code)
if(!glewInit()) {return -1; }
if(!glfwInit()) {return -1; }
glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3);
glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 2);
glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);
// also tried glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_COMPAT_PROFILE);

if(!glfwOpenWindow(1024, 768, 8, 8, 8, 8, 24, 8, GLFW_WINDOW)){
    glfwTerminate();
    return -1;
}

glfwSetWindowTitle("OpenGL 3.2");

//init method
glGenVertexArrays(1, &vao);  //<<  Access violation here. 
```

有什么想法我的问题在这里吗？

我看过了。“使用带有 glew 的 VBO 的访问冲突”但这没有帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T01:32:41.663

`glewInit`将*在*创建 OpenGL 上下文并绑定到当前线程之后调用，即`glfwOpenWindow`在您的情况之后。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-01T05:30:14.297

有点晚了，但我想我还是会管的。

正如 datenwolf 所述，在您发布的相关代码中，`glewInit()`由于其定位，应该返回错误。

您可能遇到的其他潜在问题在**GLEW**部分 下的[http://www.opengl.org/wiki/OpenGL_Loading_Library中进行了描述。](http://www.opengl.org/wiki/OpenGL_Loading_Library)

 **从上面复制粘贴：

> GLEW 在核心上下文方面存在问题。它会调用`glGetString(GL_EXTENSIONS)`​，这会导致`GL_INVALID_ENUM`​ GL 3.2+ 核心上下文一`glewInit()`被调用。

GLEW 的解决方案（也由上述链接提供）是启用“实验”支持。前任：

```
glewExperimental = GL_TRUE;
GLenum err = glewInit();
if( err != GLEW_OK )
{
    printf("GlewInit error");
    exit(1);
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-05T00:57:15.700

也迟到了，但对于仍在寻找的人

```
glewExperimental = GL_TRUE; 
```

在初始化上下文之前摆脱了访问冲突错误，而是使程序退出并出现 GL_INVALID_ENUM 错误。使用 GLFW，我不得不另外注释掉窗口提示：

```
//glfwOpenWindowHint(GLFW_OPENGL_VERSION_MAJOR, 3);
//glfwOpenWindowHint(GLFW_OPENGL_VERSION_MINOR, 2);
//glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE);
//glfwOpenWindowHint(GLFW_OPENGL_PROFILE, GLFW_OPENGL_COMPAT_PROFILE); 
```

然后程序开始编译！**

# html - 当它们具有最大宽度时将 div 内容居中

> ID：13943828
> 
> 赞同：3
> 
> 时间：2012-12-19T00:39:04.770
> 
> 标签：html, css, alignment, margin

我有这个容器，里面有 2 个元素：http: [//jsfiddle.net/scQa2/1/](http://jsfiddle.net/scQa2/1/)（JSFiddle 似乎没有正确居中，所以最好复制并粘贴代码）

测试.html

```
<div id="main">
    <img src="http://images.fanpop.com/images/image_uploads/Flower-Wallpaper-flowers-249402_1024_768.jpg" id="image"/>
    <div id="text">
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    </div>
</div>​ 
```

测试.css

```
#main {
    width: 410px;
    margin: auto;
}

#image {
    max-width: 200px;
    width: 100%;
    float: left;
    border: 1px solid blue;
}

#text {
    max-width: 200px;
    width: 100%;
    float: left;
    border: 1px solid red;
}​ 
```

我要做的是让内容在容器的中心对齐，而不是让容器居中，因为这两个元素都使用最大宽度。

如果我将容器的边距设置为自动并将其设置为特定宽度（比如 410 像素，刚好够 2 个 200 像素的最大宽度），我会得到：

[![使容器居中](../Images/dff3512dc432014e88fea2ea5d344eac.png)](https://i.stack.imgur.com/ULjd5.png)

但是如果子元素缩小到最大宽度以下，它们不会对齐，因为容器没有改变宽度：

![缩小的图像](../Images/8a81a489a8b12e7fb240c48da9e9d50f.png)

有没有一种方法可以确保两个子元素始终水平居中，最好不使用 JavaScript 并且只使用纯 CSS/HTML？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T00:55:45.217

试试这个，希望它是你所追求的......

```
#main {
                border: 1px solid red;
                display: block;
                width: 90%;
                margin: 0 auto;
                text-align: center;
            }
            .image{
                vertical-align: top;

                border: 1px solid blue;
                display: inline-block;
            }
            .image img {
                max-width: 200px;
            }

            #text {
                vertical-align: top;
                max-width: 200px;
                border: 1px solid red;
                display: inline-block;
            } 
```

html

```
<div id="main">
            <p class="image">
                <img src="http://images.fanpop.com/images/image_uploads/Flower-Wallpaper-flowers-249402_1024_768.jpg"/>
            </p>

    <p id="text">
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
    </p>
</div> 
```

# sql - 如何避免跨三个连接表的 sql 查询重复

> ID：13943832
> 
> 赞同：13
> 
> 时间：2012-12-19T00:39:24.600
> 
> 标签：sql

当我在下面的示例中执行两个 LEFT JOIN 以到达“event_name”时，我得到了重复。以这种方式设置，我得到了 112 个案例。但是，如果我去掉 2 LEFT JOIN 行并运行查询，我会得到正确的 100 条没有重复的记录。我用下面的代码尝试了 DISTINCT，但我仍然得到 112 重复。

```
SELECT "cases"."id", "cases"."date", "cases"."name", "event"."event_name" 
FROM "cases"
LEFT JOIN "middle_table" ON "cases"."serial" = "middle_table"."m_serial"
LEFT JOIN "event" ON "middle_table"."e_serial" = "event"."ev_serial"
WHERE "cases"."date" BETWEEN '2012-12-11' AND '2012-12-13' 
```

如何指定我只想要“案例”中的确切 100 个案例，并且我不希望连接中的表中的任何内容生成更多行？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-19T00:46:09.230

您需要扩展您的 ON 子句以包含一个条件，以便对于其中的每个条目，`cases`只有一个`middle_table`与条件匹配的条目，并且对于其中的每个条目，在`middle_table`中只有一个条目`event`：

```
LEFT JOIN middle_table ON cases.serial = middle_table.m_serial AND some_condition 
```

您当然可以使用 DISTINCT。如果这不起作用，则意味着您的结果在字段`cases.id`、`cases.date`和`cases.name`中都不同`event.event_name`。检查结果并决定要丢弃哪些条目并将该条件包含在您的 ON 子句中。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-19T00:51:34.837

问题是您要加入的表中有多个匹配项。实际上，您的代码说：

```
select *
from parent
left outer join child on parent.id = child.parentId 
```

如果父母有两个孩子，你会得到两个；所以父母出现了两次。

如果您只想在需要妥协时得到父母；你不能同时拥有两个孩子。对子表中的列执行聚合函数并对父表中的列执行分组，或者`rownumber() over partition by (list,of,parent,columns order by list,of,child,columns) r`在内部语句和`where r=1`外部语句中使用，如下所示：

```
select p.id, p.name, max(c.id), max(c.name) --nb: child id and name may come from different records
from parent p
left outer join child c on parent.id = child.parentId
group by p.id, p.name 
```

或者

```
select *
from 
(
    select p.id, p.name, c.id, c.name
    , rownumber() over (partition by p.id order by c.id desc) r
    from parent p
    left outer join child c on parent.id = child.parentId
) x
where x.r = 1 
```

**更新**

如评论中所述，如果子数据完全相同，您可以这样做：

```
select p.id, p.name, c.name
from parent p
left outer join 
(
    select distinct c.parentId, c.name
    from child
) c on parent.id = child.parentId 
```

或（如果有几个字段不同但您不在乎得到哪个字段）

```
select p.id, p.name, c.id, c.name
from parent p
left outer join 
(
    select max(c.id) id, c.parentId, c.name
    from child
    group by c.parentId, c.name
) c on parent.id = child.parentId 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T01:56:55.137

重复项是“middle_table”具有多个字段，“case”具有多个字段的结果。您可以使用“GROUP BY”关键字（通常用于整理函数，例如 COUNT 和 SUM）将选择限制为唯一的值，如下所示：

```
SELECT "cases"."id", "cases"."date", "cases"."name", "event"."event_name" 
FROM "cases"
LEFT JOIN "middle_table" ON "cases"."serial" = "middle_table"."m_serial"
LEFT JOIN "event" ON "middle_table"."e_serial" = "event"."ev_serial"
GROUP BY  "cases"."id", "cases"."date", "cases"."name", "event"."event_name" 
WHERE "cases"."date" BETWEEN '2012-12-11' AND '2012-12-13' 
```

# ruby - 获取渲染参数错误：正确的语法或用法是什么？

> ID：13943833
> 
> 赞同：1
> 
> 时间：2012-12-19T00:39:25.593
> 
> 标签：ruby, sinatra, pusher

我是 Ruby、Sinatra 和 Pusher 的新手，所以这是一个基本问题。我正在尝试对 Pusher 客户端进行身份验证（使用 iOS 演示代码[https://github.com/lukeredpath/libPusher](https://github.com/lukeredpath/libPusher)）。当 iOS 客户端尝试加入在线状态频道时，下面的服务器代码失败并出现错误：

```
ArgumentError - wrong number of arguments (1 for 2):
    /Users/waveocean/.rvm/gems/ruby-1.9.3-p327/gems/sinatra-1.3.3/lib/sinatra/base.rb:665:in `render'
    web.rb:13:in `auth'
    web.rb:26:in `block in <main>'
    /Users/waveocean/.rvm/gems/ruby-1.9.3-p327/gems/sinatra-1.3.3/lib/sinatra/base.rb:1265:in `call'

... snipped for brevity ... 
```

这是代码：

```
require 'sinatra'
require 'pusher'
require 'thin'
Thin::HTTP_STATUS_CODES[403] = "FORBIDDEN"

Pusher.app_id = 'MY-APP-ID'
Pusher.key = 'MY-KEY'
Pusher.secret = 'MY-SECRET'

def auth
  response = Pusher[params[:channel_name]].authenticate(params[:socket_id], {:user_id => 101})
  render :json => response
end

 use Rack::Auth::Basic, "Protected Area" do |username, password|
   username == 'foo' && password == 'bar'
 end

 post '/presence/auth' do
   if params[:channel_name] == 'presence-demo'
      auth
   else
   #   render :text => "Forbidden", :status => '403'
   response.status = 403
   end
 end 
```

有人可以提供建议或正确使用渲染吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T17:37:11.157

这是我发现的。`render`与 Rails 相关联，而不是严格意义上的 Ruby。要响应 Sinatra 路由，请在 auth 方法中使用以下内容：

```
def auth
  response = Pusher[params[:channel_name]].authenticate(params[:socket_id], {:user_id => 101})
  [200, {"Content-Type" => "application/json"}, response.to_json]
end 
```

事实证明，Pusher iOS 项目演示提供了一个带有所需实现的 Scripts/auth_server.rb 文件。它与此处的安装说明一起记录：[https](https://github.com/lukeredpath/libPusher/wiki/Adding-libPusher-to-your-project) ://github.com/lukeredpath/libPusher/wiki/Adding-libPusher-to-your-project 。

# php - 在 PHP 中使用两个分隔符的 preg_split

> ID：13943837
> 
> 赞同：5
> 
> 时间：2012-12-19T00:40:02.293
> 
> 标签：php, arrays, split, preg-split

如何合并两个分隔符`preg_split`？例如：

```
$str = "this is a test , and more";
$array = preg_split('/( |,)/', $str, -1, PREG_SPLIT_DELIM_CAPTURE);
print_r($array); 
```

将产生一个数组

```
Array
(
    [0] => this
    [1] =>  
    [2] => is
    [3] =>  
    [4] => a
    [5] =>  
    [6] => test
    [7] =>  
    [8] => 
    [9] => ,
    [10] => 
    [11] =>  
    [12] => and
    [13] =>  
    [14] => more
) 
```

但我想得到

```
Array
(
    [0] => this
    [1] =>  
    [2] => is
    [3] =>  
    [4] => a
    [5] =>  
    [6] => test
    [7] => ,
    [8] => and
    [9] =>  
    [10] => more
) 
```

实际上，我想在两个分隔符是邻居时合并数组元素。换句话说，如果下一部分是第二个分隔符，则忽略第一个分隔符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:45:46.467

尝试使用字符类：`/[ ,]+/`

`+`是一个量词，意思是“1或更多”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T00:53:52.673

如何确保首先不会发生这种情况：

```
<?php
    $str = "this is a test , and more";
    $str=preg_replace('/ *, */',',',$str);
    $array = preg_split('/( |,)/', $str, -1, PREG_SPLIT_DELIM_CAPTURE);
    print_r($array);
?>

Array
(
    [0] => this
    [1] =>  
    [2] => is
    [3] =>  
    [4] => a
    [5] =>  
    [6] => test
    [7] => ,
    [8] => and
    [9] =>  
    [10] => more
) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T00:56:57.857

使用`/([, ]+)/`它有效。见**[键盘](http://codepad.org/awjlapHN)**

# google-app-engine - GAE：从多个处理程序访问数据存储

> ID：13943840
> 
> 赞同：0
> 
> 时间：2012-12-19T00:40:22.913
> 
> 标签：google-app-engine

我有 2 个处理程序。一个称为 MainHandler，它呈现一个小表单来注册用户（创建帐户）。提交电子邮件和密码后，MainHandler 会检查帐户不存在，验证字段，然后创建一个新的用户实体。然后重定向到 HomeHandler (/home) 并将用户电子邮件作为 URL 查询参数发送，即“http://localhost:8000/home?email=jack@smith.com”

我的问题是，这是最好的方法吗？在 HomeHandler 有另一种形式，允许用户输入一个地址，该地址将是用户的孩子。使用电子邮件，我运行查询以查找用户。如果我不通过用户电子邮件发送 HomeHandler 如何知道哪个用户正在输入地址？如果我有其他处理程序将接收要存储并与用户关联的其他数据，我是否必须每次都继续发送用户电子邮件？似乎应该有更好的方法来做到这一点，但我无法弄清楚。

```
class User(db.Model):
    email = db.EmailProperty()
    password = db.StringProperty()

class Address(db.Model):
    line1 = db.StringProperty()
    line2 = db.StringProperty()

class MainHandler(webapp2.RequestHandler):
    def get(self):
        renders a template with a form requesting email and pwd
    def post(self):
        Validates form and checks account doesn't already exist
        if (user doesn't already exist and both email and pwd valid):
            newuser = User(email=email, password=password);
            newuser.put();
            self.redirect("/home?email=%s"%email)

class HomeHandler(webapp2.RequestHandler):
    def get(self):
        Renders another form requesting a physical address (2 lines)
    def post(self):
        email=self.request.get("email")
            addressLine1 = self.request.get("address1")
            addressLine2 = self.request.get("address2")
            q = db.Query(User).filter('email =', email)#Construct query
            userMatchResults = q.fetch(limit=1)#Run query
            homeAddress = Address(parent=userMatchResults[0])
            homeAddress.line1 = addressLine1
            homeAddress.line2 = addressLine2
            homeAddress.put()

app = webapp2.WSGIApplication([('/', MainHandler), ('/home', HomeHandler)], debug=True) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:17:34.387

您不必重定向。您可以在 Mainhandler 的帖子中发送第二个表单。并且你可以将这两个处理程序结合起来，如果主处理程序的 post 可以检测到 post 请求来源是第一种形式还是第二种形式。一个简单的方法是在两个表单中添加一个隐藏的输入字段，并带有表单的名称。该字段将成为发布数据的一部分。

但是还有许多其他方法可以保留请求之间的状态。

# android - Android AsyncTask 在屏幕旋转后返回关闭 ProgressDialog

> ID：13943842
> 
> 赞同：1
> 
> 时间：2012-12-19T00:40:58.813
> 
> 标签：android, android-asynctask

这是场景：

*   账户登录页面
*   单击“登录”会触发登录 AsyncTask
*   要在网络访问期间阻止 UI，会弹出 ProgressDialog
*   返回时，ProgressDialog 被关闭，用户转发

此流程运行良好。

这是问题所在：

*   用户可以在 AsyncTask 登录时旋转屏幕

目前，ProgressDialog 由类字段引用，并使用该指针和调用 .dismiss() 将其关闭。

但是，如果屏幕旋转，一切都会崩溃。

可能是因为重新创建了 Activity？我怀疑该字段引用周围的闭包指向一个无法访问的对象。你怎么看？

我怎样才能可靠而优雅地解决它？只需添加`if (... != null)`支票？

**更一般地说，我必须承认我不明白在这样的情况下应用的“最佳实践”：**

*   活动 A 触发 AsyncTask
*   用户离开活动 A（后退按钮？旋转屏幕？onClick 启动 Intent？）
*   当 Activity A 不再是最顶层但其 onPostExecute() 具有 UI 效果时，AsyncTask 返回，注意：原始委托观察者不再可用。

*   困惑*（注意：我是初学者，所以彻底的解释会对我有很大帮助）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:55:34.067

是的，在改变方向时，活动被破坏然后再次重新创建。
当运行时发生配置更改时，默认情况下会关闭并重新启动 Activity，但使用此属性声明配置会阻止 Activity 重新启动。相反，活动保持运行并调用其 onConfigurationChanged() 方法。
将此行添加`android:configChanges="orientation|keyboardHidden"` 到您的清单文件

```
<activity
    android:name=""
    android:label="" 
    android:configChanges="orientation|keyboardHidden" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T01:24:39.383

我建议查看[处理运行时更改](http://developer.android.com/guide/topics/resources/runtime-changes.html)。有关您可用的方法的详细信息的详细说明。

```
android:configChanges="orientation..." tells android your application will take care of resizing the current view hierarchy.  As such, when you specify that in your manifest, your activity will not be destroyed and recreated, instead the system will just call your activity's `onConfigurationChanged()` method.  As it so happens, most of the stock widgets will resize themselves when their container changes, so if you are using basic layouts, this usually "just works" by redrawing the view hierarchy in the new format.  For custom widgets, this trick may not work. 
```

批准的方法是在方法中保存你被销毁时的一些配置实例信息`onSaveInstanceState()`，然后在方法中重新创建你的状态`onCreate()`

在您的情况下，当屏幕更改方向时对话框将被关闭，因此您可以保持这种状态，也可以在`onCreate()`.

# c - 从指针读取内存

> ID：13943843
> 
> 赞同：1
> 
> 时间：2012-12-19T00:40:59.873
> 
> 标签：c, visual-c++

我有这样的功能：

```
int __stdcall sub_57BBD0(int a1, int a2, int a3, char a4)
{
  *(_BYTE *)a3 = *(_BYTE *)a1;
}

*(BYTE*)(a1 + 0) is a pointer to a BYTE* 
```

从 的指针`a1`，我怎样才能得到`BYTES`这个指针指向的数据？还是不可能？，因为`a1`指向`BYTE*`内存中的a，我可以`ReadProcessMemory`获取数据，但是我可以用另一种方式吗？

我试过做：

```
BYTE *data = *(BYTE*)&a1; 
```

但它不工作，

我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:49:31.253

嗯，这段代码看起来很脏。是拆机还是什么？

无论如何，该值`a1`似乎是一个用作`int`. 你有这个：

```
*(_BYTE *)a3 = *(_BYTE *)a1; 
```

那就是从指向的内存位置获取第一个`_BYTE`值`a1`并将其存储在指向的内存位置中`a3`。

如果您想获取指针本身，请不要取消引用它：

```
BYTE *data = (BYTE*)a1; 
```

您在这里所做的只是将整数类型转换为 a `BYTE*`（我假设它与 相同`_BYTE`）。

现在您可以像引用数组一样引用`BYTE`值`data`（假设内存实际分配给您的进程）：

```
BYTE secondVal = data[1]; 
```

等等...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:44:59.323

```
BYTE * data = *(BYTE*)&a1; 
```

这一行说，获取整数 a1 的地址，将其转换为 BYTE 指针，取消引用并获取它的值，然后将其分配给名为 data 的 BYTE 指针。

所以你会想要这样做：

```
BYTE data = *((BYTE *)&a1); 
```

# java - 如何将值连接到 Spring 中的字段？

> ID：13943845
> 
> 赞同：5
> 
> 时间：2012-12-19T00:41:22.270
> 
> 标签：java, spring

我在 Spring 配置文件中定义了一个 bean，

```
 <bean id="accountConfigFile" class="java.lang.String">
    <constructor-arg index="0" type="java.lang.String" value="/account.properties"/>
</bean> 
```

然后我将此 bean 连接到 AccountHelper 类中的一个字段：

```
@Autowired
@Qualifier("accountConfigFile")
private static String configFilename; 
```

但是，当我尝试在构造函数中访问它时，我得到了 NullPointerException，因为它为 null：

```
public Class AccountHelper {

    private Properties properties;

    @Autowired
    @Qualifier("accountConfigFile")
    private static String configFilename;

    public AccountHelper() {
        properties = new Properties();
        InputStream is = null;

        try
        {
            is = getClass().getResourceAsStream(configFilename);
            properties.load(is);
            is.close();

        } catch (Exception e)
        {
                    ......
        }
    }
    ......

} 
```

谁能帮我弄清楚为什么会这样？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T02:12:03.590

似乎您正在将值注入到 Spring 不支持的静态字段中。如果你真的想这样做，你可以按照[Spring: How to injection a value to static field 中的步骤进行操作？](https://stackoverflow.com/questions/7253694/spring-how-to-inject-a-value-to-static-field). 但我认为在 AccountHelper 类中自动装配配置文件名不是一个好主意。最好将属性对象注入 AccountHelper 类，因为属性可以在同一个 Spring 配置文件中构造。但是，如果您的 AccountHelp 类只使用属性文件中的属性节点，您可以使用 setter 将从属性文件中读取的值注入到类中。Spring 配置文件就像

```
<bean id="propertyConfigurer"  
      class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">  
    <property name="location" value="/account.properties"/>  
</bean>
<bean class="your.package.AccountHelper">
    <property name="foobar" value="node.name.in.the.properties"/>
</bean> 
```

AccountHelper 类就像

```
public AccountHelper {
    private String foobar;
    public void setFoobar(String foobar) {
        this.foobar = foobar;
    }
    ...other methods
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T02:33:55.690

首先，正如@rAy 所说，不要注入静态字段。老实说，这很没有意义。

回到您的问题（假设您将字段更改为非静态）。整个问题（尚未）与自动布线有关。正如相当多的答案已经指出的那样，在 Spring 中，将首先创建一个 bean 实例，然后进行字段/setter 注入。因此，您的构造函数在您注入它使用的字段之前运行。

有很多方法可以解决这个问题。我列出了一些最常见的选项（我敢打赌还有更多方法），尝试理解它们并选择一个适合您的设计。

## 构造函数注入

您可以选择通过构造函数注入，而不是注入到字段。让您的 AccountHelper 看起来像：

```
public Class AccountHelper {

    private String configFilename;

    public AccountHelper(String configFilename) {
        this.configFilename = configFilename;
        // do something base on configFilename
    }
} 
```

您可以对构造函数参数使用自动装配，或者在 XML 中显式声明（从您的问题来看，在我看来您知道该怎么做）

## 初始化方法

在 Spring 中，有很多方法可以在设置所有属性后使用初始化方法。因此，您可以执行以下操作：

```
public Class AccountHelper implements InitializingBean{

    private String configFilename;
    // corresponding setters etc

    public AccountHelper() {
        // don't do initialization in ctor
    }

    @Override
    public void afterPropertiesSet() {
        // called after property injections finished
        // do something base on configFilename
    }
} 
```

或者你甚至可以有一个你喜欢的名字的方法，并告诉Spring你想用它作为初始化方法，通过注释`@PostConstruct`，或者`init-method`在XML中，或者通过`initMethodName`in`@Bean`等。

## 工厂豆

如果您对 AccountHelper 的创建方式没有太多控制，并且创建过程可能难以通过普通 Spring config 执行，您始终可以编写一个工厂 Bean 来创建 bean，并在其中手工制作构造逻辑工厂豆。

* * *

在没有自动布线的情况下使事情正常工作后，添加自动布线只是小菜一碟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T03:41:49.237

您不能`@Autowired`在 Spring 管理的组件的 Constructor 中引用属性，因为在构造 Object 之前，Spring 无法执行自动装配。

根据定义，在构造函数完成执行之前，对象还没有被构造。

一旦构造函数完成执行，Spring 将`@Autowire`属性。如果您想在该属性可用后立即执行某些操作，则可以使用`@PostConstruct`注释配置 Init 方法。

[更多信息`@PostConstruct`](http://static.springsource.org/spring/docs/3.0.0.M3/reference/html/ch04s11.html#beans-postconstruct-and-predestroy-annotations)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T00:53:25.590

我不是 Spring ¹的专家，但我想 Spring 首先实例化您的 AccountHelper，然后（之后）它会推送依赖项。所以在你的构造函数中，依赖项还没有准备好。

我建议您将逻辑从构造函数移动到业务方法（这似乎更合适），然后在第一次需要时延迟加载属性。构造函数应该只构造对象，加载属性对我来说更像是一种业务方法。

¹春天不适合我；我相信有一天人们会像 EJB 一样看待 Spring，他们会说“为什么我们更愿意编写 xml 而不是 java 来组装我们的对象？”

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-19T00:56:26.480

我认为您不需要在这里自动连接字符串。如果您想将一个值传递给 configFilename，您可以通过属性执行此操作。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-19T00:48:59.513

字段自动装配发生在构造对象之后，因此您无法从构造函数内部访问它。

如果需要修改构造函数上的 bean，可以使用构造函数而不是字段依赖注入自动装配。但是我相信构造函数依赖注入的局限性在于它只能按类型查找。由于您的 bean 类型是 java.lang.String，我认为这是不可能的。

如果 Spring 不提供构造函数自动装配限定符，一个不太优雅的解决方案是创建 String 的子类，以便您可以按类型使用构造函数注入。

或者其他方式是您可以创建一个唯一的类，并将您的字符串属性作为此类的一个字段。然后你可以按类型自动装配这个类

spring 手册的第 4 章提供了很好的信息，我建议你阅读一下：[http ://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/html/beans.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-19T01:16:55.993

我建议制作`AccountHelper`一个 bean 并切换到构造函数注入。

**账户助手**

```
package com.cloudfoundry.tothought;

@Component(value="AccountHelper")
public class AccountHelper {

    private Properties properties;

    private String configFilename;

    @Autowired
    public AccountHelper(@Qualifier("accountConfigFile") String configFileName) {
        this.configFilename = configFileName;
                //Other logic...
    }

    public String getConfigFilename() {
        return configFilename;
    }

    public void setConfigFilename(String configFilename) {
        this.configFilename = configFilename;
    }
} 
```

**应用**

```
public class App {

    public static void main(String[] args) {
        ApplicationContext context = new ClassPathXmlApplicationContext("classpath:/META-INF/application-context.xml");
        AccountHelper helper = (AccountHelper) context.getBean("AccountHelper");
        System.out.println(helper.getConfigFilename());
    }
} 
```

**应用程序上下文.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.2.xsd">

    <bean id="accountConfigFile" class="java.lang.String">
        <constructor-arg index="0" type="java.lang.String"
            value="/account.properties" />
    </bean>

    <context:component-scan base-package="com.cloudfoundry.tothought"/>
</beans> 
```

# javascript - MVC 和 Javascript/JQuery 验证库

> ID：13943847
> 
> 赞同：1
> 
> 时间：2012-12-19T00:41:58.323
> 
> 标签：javascript, jquery, asp.net-mvc-2, kendo-ui

我正在开发一个使用 MVC 2.0 和 Kendo UI 的项目。我们决定使用 AJAX 验证而不是 MVC 模型级别验证；这意味着验证发生在 HTML 控件上的大多数“onchange”事件期间。当发生错误时，我们在 HTML 控件上编写了红色的 CSS“突出显示”，并在没有错误时删除了突出显示。如果有多个控件（例如复选框），我们将在发生错误时突出显示所有控件......当然，与多个字段验证相关的错误消息......

我们得到了它的工作，但我们必须在每个 web 表单页面上实现大量的 javascript/jQuery 编码（包括验证消息上的控件 id/名称匹配），并且似乎无法将其作为一个常见的例程来实现所有网络表格。我们还想知道是否已经有某种验证库可以或多或少地实现相同的目标......

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:47:12.447

你应该试试[jQuery 验证](http://docs.jquery.com/Plugins/Validation)

它非常易于使用，但您仍然需要将每个输入链接到所需的验证类型

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T09:34:10.867

如果你标记你的问题，`kendo-ui`你可能正在使用它，所以它可能值得一看[`kendo.ui.Validator`](http://docs.kendoui.com/api/framework/validator)

# twig - 如何将自定义字符串添加到 symfony2 路径？

> ID：13943848
> 
> 赞同：0
> 
> 时间：2012-12-19T00:42:00.283
> 
> 标签：twig, symfony-2.1

我在 /web/blog 中有一个自定义页面，我想创建一个链接来转发它。我怎样才能做到这一点 ？我尝试了很多东西，但没有一个有效，比如

```
<a href="{{ path('homepage') | '/blog' }}" title="" >{{ 'menu.blog'|trans }}</a> 
```

或者

```
<a href="{{ path('homepage') }}/blog" title="" >{{ 'menu.blog'|trans }}</a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T17:52:40.980

我不知道为什么，但正确的答案是：

```
<a href="{{ path('homepage') }}{{ 'blog' }}"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T05:58:36.330

我用

```
<a href="{{ path('homepage')}}/{{blog}} title=""> 
```

@Adam 解决方案是正确的

# android - Android 4.0.3 上的 Phonegap 2.2.0 中没有输入类型 =“文本”的预测文本

> ID：13943852
> 
> 赞同：6
> 
> 时间：2012-12-19T00:42:27.743
> 
> 标签：android, cordova, input, textarea, prediction

我有一个 PhoneGap 应用程序，其中包含多个`input type="text"`. 除此之外，它还有一些 HTML 文本区域。

在 Android 上运行应用程序并在 HTML`textarea`元素中输入文本时，Android 预测文本工作正常。但是，当我将文本输入到没有显示预测的`input`元素中时。`type="text"`

我在运行 Android 4.0.3 的 HTC Sensation 和三星 Galaxy II 平板电脑上都进行了测试，但预测文本均未在两台设备上显示。

`input`通过向PhoneGap 提供的示例应用程序添加一个元素，可以轻松地重现此问题。我尝试删除所有 css 以查看是否导致我的问题，但问题仍然存在。

有谁知道解决这个问题的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-16T15:41:27.237

我刚刚发现这适用于iOS：

`<input type="text" autocorrect="off" />`

也许它也可以在 Android 上运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T14:27:43.110

我认为文本预测取决于您使用的键盘而不是输入类型。检查手机设置中的文本建议。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-25T09:19:39.573

当前版本的 PhoneGap/Cordova 中不再存在该问题。

# css - 用 CSS 设计制作星级评分系统？

> ID：13943854
> 
> 赞同：2
> 
> 时间：2012-12-19T00:42:37.967
> 
> 标签：css, rating

我正在尝试创建一个星级评分系统，用户可以将鼠标悬停在星星上以对其他用户进行评分。

我现在只想专注于 CSS 设计方面的事情。我知道当用户将鼠标悬停在每个图像的 css 中使用不透明度时，如何实现星星淡入，但是我该如何做到这一点，以便如果用户将鼠标悬停在第二颗或第三颗星上，之前的星星也是淡入淡出？

任何提示或建议将不胜感激。下面是我目前所拥有的，它只是设置了每个单独图像的不透明度，但想知道如何让它如前所述工作，以便如果用户将鼠标悬停在星 3 上，星 1、2 和 3 会淡入。

```
.star {
    position: absolute;
    width: 200px;
    text-align: right;
    margin-top: 0px;
    margin-left: 189px;
    cursor: pointer;
    opacity:0.2;

    }

.star:hover {
    position: absolute;
    width: 200px;
    text-align: right;
    margin-top: 0px;
    margin-left: 189px;
    cursor: pointer;
    opacity:1.0;

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T01:05:24.597

我会这样做（*使用[通用兄弟组合`~`](http://www.w3.org/TR/selectors/#general-sibling-combinators)*器）

```
<ul class="stars">
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
</ul> 
```

和

```
.stars li{
    float:left;
    width:20px;
    height:20px;
}
.stars:hover li{
   background-color:red; // or set a background image of SELECTED star
}
.stars li,
.stars li:hover ~ li{
    background-color:#ccc;// or set a background image of unselected star
} 
```

演示在[http://jsfiddle.net/gaby/PJWZY/1/](http://jsfiddle.net/gaby/PJWZY/1/)

* * *

我玩过`background-color`. 这同样适用于不透明度..

[http://jsfiddle.net/gaby/PJWZY/2/](http://jsfiddle.net/gaby/PJWZY/2/)上的不透明度演示

# objective-c - 使用来自静态库的数据模型的问题

> ID：13943855
> 
> 赞同：0
> 
> 时间：2012-12-19T00:42:43.563
> 
> 标签：objective-c, ios, xcode, core-data, static-libraries

我正在开发一个使用我也创建的静态库的 iOS 应用程序。

我想在 iOS 应用程序中使用的库中有一个数据模型。

正常的 Apple 提供的 NSManagedObjectModel getter 如下所示：

```
- (NSManagedObjectModel *)managedObjectModel
{
    if (_managedObjectModel != nil)
{
    return _managedObjectModel;
}
    NSURL *modelURL = [[NSBundle mainBundle] URLForResource:@"Honeycomb" withExtension:@"momd"];
    _managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];
    return _managedObjectModel;
} 
```

我已经修改了 getter 以查看我的静态库资源包以获取数据模型：

```
- (NSManagedObjectModel *)managedObjectModel
{
    if (_managedObjectModel != nil)
    {
        return _managedObjectModel;
    }

    NSURL *honeycombBundleURL = [[NSBundle mainBundle] URLForResource:@"HoneycombResources" withExtension:@"bundle"];
    NSURL *modelURL = [[NSBundle bundleWithURL:honeycombBundleURL] URLForResource:@"Honeycomb" withExtension:@"momd"];
    _managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];
    return _managedObjectModel;
} 
```

我得到了正确返回的模型的 URL，但是当我查看 URL 指向的位置时，唯一的文件是“Versioninfo.plist”——没有实际的 .mom 文件！

我已经按照本文[http://www.galloway.me.uk/tutorials/ios-library-with-resources/中的说明为静态库设置了资源包](http://www.galloway.me.uk/tutorials/ios-library-with-resources/)

当我在文件系统中浏览到它时，所有其他资源（.nib 和 .png）都正确显示在包中，我只是缺少 .mom 文件。有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T01:04:46.360

解决了：

出于某种原因，Xcode “导入”了 .xcdatamodel 文件，但源文件实际上并不在项目目录中。我将文件复制到 Xcode 认为的位置，并且一切正常。

# azure - 在 Azure 上通过 WatiN 运行 IE 浏览器实例

> ID：13943856
> 
> 赞同：2
> 
> 时间：2012-12-19T00:42:45.363
> 
> 标签：azure, watin, unauthorized

我正在尝试在 Azure WebRole 中运行一些浏览器自动化任务，但在尝试实例化 IE 浏览器实例时遇到以下错误：

> System.UnauthorizedAccessException：由于以下错误，检索具有 CLSID {0002DF01-0000-0000-C000-000000000046} 的组件的 COM 类工厂失败：80070005 访问被拒绝。（来自 HRESULT 的异常：0x80070005 (E_ACCESSDENIED)）。

代码在 Azure 模拟器中运行良好。

我做了一些阅读并得出结论，我可能需要使用 DCOMCNFG 实用程序来修改权限以允许 IIS 用户启动 IE 实例，但是上面的 CLSID 引用的 AppID 未在 DCOMCNFG 中列出任何地方的实用程序，所以我无法更改这些权限。

有人有什么想法吗？我快束手无策了。

谢谢！
克里斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T09:02:21.523

尝试通过在每个元素 ( / )`.csdef`中添加以下内容来修改文件来运行提升的代码：`*Role``WebRole``WorkerRole`

```
<Runtime executionContext="elevated" /> 
```

这会将您的代码作为本地系统帐户运行。

# file-upload - 使用 attachFile 并提交

> ID：13943858
> 
> 赞同：1
> 
> 时间：2012-12-19T00:42:56.217
> 
> 标签：file-upload, submit

我有以下 HTML：

```
 <form action="upload" method="post" enctype="multipart/form-data" >
        Select a file to upload: 
        <input type="file" name="file"/>
        <input type="hidden" name="USER_NAME" id="USER_NAME" value="user_name"/>
        <input type="submit" value="Submit"/>
      </form> 
```

我有几个问题。

首先，在输入字段（名为“文件”）中，我想设置要上传的文件的名称。我可以只使用 WebElement.type() 来做到这一点，但我收到有关使用 attachFile 的警告。我很高兴使用它，但是当我这样做时，我得到了错误：

com.thoughtworks.selenium.SeleniumException：元素必须是用户可编辑的才能清除它。

我的第二个问题是，如果我通过 type() 设置输入字段的内容，提交按钮不起作用。我可以通过 css 获取 WebElement，但 click() 或 submit() 都不起作用。当我这样做时，什么也没有发生。

在此先感谢您的帮助，并为愚蠢道歉。

# oop - 您如何控制类型安全的范围？

> ID：13943859
> 
> 赞同：0
> 
> 时间：2012-12-19T00:43:03.920
> 
> 标签：oop, types, range, type-safety

想象一下，您有一个将整数转换为罗马字符串的函数：

```
public String roman(int) 
```

只有 1 到 3999（含）之间的数字可以转换。

那么如果有人在任何 OO 语言中通过 4000，你会怎么做？

1.  引发异常
2.  返回“”或其他一些特殊字符串
3.  写一个断言
4.  …</li>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:28:54.457

第 1 点：引发异常。这就是`ArgumentOutOfRangeException`（至少在.NET中）的目的：

```
if (intToConvert >= 4000)
{
    throw new ArgumentOutOfRangeException("intToConvert ", "Only numbers 1-3000 are valid for conversion.");
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T12:40:52.673

总的来说，我发现验证主题非常有趣。在我看来，选项 2（返回一个特殊值）不是一个好选项，因为您强制客户端执行 if/case 来检查返回的值，并且必须在任何地方重复该代码。此外，与通过调用堆栈传播的异常不同，在这种情况下，调用者几乎总是必须处理该特殊值的那个。

在 OOP 引发异常或有断言的情况下，IMO 是一种更优雅的处理方式。但是我发现由于某些原因，每种方法中的内联验证码都不能很好地扩展：

*   很多时候，您的验证逻辑最终会比方法逻辑本身更大，因此您最终会将与代码不完全相关的东西弄得一团糟。
*   没有适当的验证代码重用（例如范围验证、电子邮件验证等）。
*   这取决于您的口味，但您将进行[防御性编程](http://en.wikipedia.org/wiki/Defensive_programming)。

几年前，我参加了一个关于验证器的演讲（类似的演讲幻灯片在[这里](http://csl.ensm-douai.fr/Esug2007Media/uploads/1/Extreme.pdf)。解释它的文档曾经在[http://www.caesarsystems.com/resources/caesarsystems/files/Extreme_Validation.pdf](http://www.caesarsystems.com/resources/caesarsystems/files/Extreme_Validation.pdf)但现在它是 404 :() 并且完全喜欢这个概念。恕我直言，拥有一个采用 OO 哲学的验证框架是可行的方法。如果您想阅读它，我已经在[这里](http://research.quanbit.com/2012/10/09/about-oop-validation/)和[这里](http://research.quanbit.com/2012/11/05/discussing-validators-and-related-concepts/)写了几篇关于它的帖子（免责声明：帖子是我工作的公司博客的一部分）。

高温高压

# ruby - 用zlib压缩Ruby中的完整目录？

> ID：13943860
> 
> 赞同：1
> 
> 时间：2012-12-19T00:43:26.143
> 
> 标签：ruby, directory, compression, zlib

这是我正在尝试的代码。

```
require 'zlib'
Dir.glob('*.*').each do |file|
  Zlib::GzipWriter.open('output.gz') do |gz|
    gz.mtime = File.mtime(file)
    gz.orig_name = File.basename(file)
    gz.write IO.binread(file)
  end
end 
```

我已经尝试过不同的变体。似乎没有在线“多个文件”的操作指南。我一直以 ouput.gz 中的第一个文件名结尾，我认为它可能包含目录中最后一个文件的内容（不确定）。但这不是重点。我只想将每个文件作为单独的实体放在压缩文件中。越跨平台兼容越好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-23T20:57:21.660

这个答案取自[http://old.thoughtsincomputation.com/posts/tar-and-a-few-feathers-in-ruby](http://old.thoughtsincomputation.com/posts/tar-and-a-few-feathers-in-ruby)，它是从**RubyGems**库中获取的。

```
require 'rubygems'
require 'rubygems/package'
require 'zlib'
require 'fileutils'

module Util
  module Tar
    # Creates a tar file in memory recursively
    # from the given path.
    #
    # Returns a StringIO whose underlying String
    # is the contents of the tar file.
    def tar(path)
      tarfile = StringIO.new("")
      Gem::Package::TarWriter.new(tarfile) do |tar|
        Dir[File.join(path, "**/*")].each do |file|
          mode = File.stat(file).mode
          relative_file = file.sub /^#{Regexp::escape path}\/?/, ''

          if File.directory?(file)
            tar.mkdir relative_file, mode
          else
            tar.add_file relative_file, mode do |tf|
              File.open(file, "rb") { |f| tf.write f.read }
            end
          end
        end
      end

      tarfile.rewind
      tarfile
    end

    # gzips the underlying string in the given StringIO,
    # returning a new StringIO representing the 
    # compressed file.
    def gzip(tarfile)
      gz = StringIO.new("")
      z = Zlib::GzipWriter.new(gz)
      z.write tarfile.string
      z.close # this is necessary!

      # z was closed to write the gzip footer, so
      # now we need a new StringIO
      StringIO.new gz.string
    end

    # un-gzips the given IO, returning the
    # decompressed version as a StringIO
    def ungzip(tarfile)
      z = Zlib::GzipReader.new(tarfile)
      unzipped = StringIO.new(z.read)
      z.close
      unzipped
    end

    # untars the given IO into the specified
    # directory
    def untar(io, destination)
      Gem::Package::TarReader.new io do |tar|
        tar.each do |tarfile|
          destination_file = File.join destination, tarfile.full_name

          if tarfile.directory?
            FileUtils.mkdir_p destination_file
          else
            destination_directory = File.dirname(destination_file)
            FileUtils.mkdir_p destination_directory unless File.directory?(destination_directory)
            File.open destination_file, "wb" do |f|
              f.print tarfile.read
            end
          end
        end
      end
    end
  end
end

### Usage Example: ###
#
# include Util::Tar
# 
# io = tar("./Desktop")   # io is a TAR of files
# gz = gzip(io)           # gz is a TGZ
# 
# io = ungzip(gz)         # io is a TAR
# untar(io, "./untarred") # files are untarred
# 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T04:14:29.123

首先，这将继续覆盖`output.gz`，使其仅包含最后一个压缩文件。

其次，gzip 格式不包含多个文件。它只有一个。您需要使用`.tar.gz`or`.zip`格式。 `.zip`更“跨平台兼容”。看看[ruby​​zip](http://rubyzip.sourceforge.net/)。

# c# - 从列表中返回特定类型

> ID：13943861
> 
> 赞同：2
> 
> 时间：2012-12-19T00:43:51.923
> 
> 标签：c#, .net

我正在为游戏编写组件实体系统，但遇到了一些障碍。我有一个`List<Component>`派生类调用 ComponentList，其中包含一个实体的所有组件。我还有一个方法可以返回一个名为 GetComponent 的组件。它通过字符串名称执行此操作。

```
 public Component GetComponent(string name)
    {
        foreach (var c in this)
        {
            if (c.Name == name)
                return c;
        }
        throw new Exception("Component " + name + " does not exist.");
    } 
```

但是，当从 Component 派生一个类，将其粘贴到 ComponentList 中，然后将其拉出时，我必须强制转换为该类型，这有点不方便。

```
TestComponent t1 = (TestComponent)Entity.ComponentList.GetComponent("Test1"); 
```

我知道有一些特殊的、神奇的方法可以使用 < T > 来获取类型，但我不确定如何使用它，或者它是否适用于这种情况。有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:48:20.623

代码：

```
public T GetComponent<T>(string name) where T : Component
{
    var result = this.FirstOrDefault(c => c.Name == name);
    if( result == null )
        throw new Exception("Component " + name + " does not exist.");
    return (T) result;
} 
```

用法：

```
var testComponent = componentFactory.GetComponent<TestComponent>("Test1"); 
```

调用了启用此功能的语言功能`generics`，您可以在[MSDN](http://msdn.microsoft.com/en-us/library/512aeb7t%28v=vs.80%29.aspx)上阅读更多相关信息（以及许多其他地方；只需 google 搜索“generics C#”）

# java - 如何在将 NSInputStream 写入 iOS 中的 NSOutputStream 时读取它？

> ID：13943862
> 
> 赞同：0
> 
> 时间：2012-12-19T00:44:05.310
> 
> 标签：java, objective-c, ios, io, nsinputstream

我正在将一个 Android 应用程序移植到 iPhone（更像是基于 Android 版本改进 iPhone 应用程序），我需要拆分和组合大型未压缩音频文件。

目前，我将所有文件加载到内存中并将它们拆分并组合成单独的函数。它会因 100MB 以上的文件而崩溃。

这是执行此操作所需的新过程：

我有两个录音（file1 和 file2）和一个拆分位置，我希望将 file2 插入到 file1 中。

- 为 file1 和 file2 创建输入流，为 outputfile 创建输出流。

-重写新的 CAF 标头

- 从 inputStream1 读取数据，直到它到达分割点，然后我将所有数据写入输出文件。并将其写入输出流。

- 从 inputStream2 读取所有数据并将其写入输出文件。

- 从 inputStream1 读取剩余数据并将其写入输出文件。

这是我的Android代码：

```
 File file1File = new File(file1);
    File file2File = new File(file2);

    long file1Length = file1File.length();
    long file2Length = file2File.length();

    FileInputStream file1ByteStream = new FileInputStream(file1);
    FileInputStream file2ByteStream = new FileInputStream(file2);
    FileOutputStream outputFileByteStream = new FileOutputStream(outputFile);

    // time = fileLength / (Sample Rate * Channels * Bits per sample / 8)
    // convert position to number of bytes for this function
    long sampleRate = eRecorder.RECORDER_SAMPLERATE;
    int channels = 1;
    long bitsPerSample = eRecorder.RECORDER_BPP;
    long bytePositionLength = (position * (sampleRate * channels * bitsPerSample / 8)) / 1000;

    //calculate total data size
            int dataSize = 0;
            dataSize = (int)(file1Length + file2Length);

            WriteWaveFileHeaderForMerge(outputFileByteStream, dataSize,
                    dataSize + 36,
                    eRecorder.RECORDER_SAMPLERATE, 1,
                    2 * eRecorder.RECORDER_SAMPLERATE);

    long bytesWritten = 0;

    int length = 0;

    //set limit for bytes read, and write file1 bytes to outputfile until split position reached
    int limit = (int)bytePositionLength;

    //read bytes to limit
    writeBytesToLimit(file1ByteStream, outputFileByteStream, limit);    
    file1ByteStream.close();

    file2ByteStream.skip(44);//skip wav file header
    writeBytesToLimit(file2ByteStream, outputFileByteStream, (int)file2Length);
    file2ByteStream.close();

    //calculate length of remaining file1 bytes to be written
    long file1offset = bytePositionLength;

    //reinitialize file1 input stream
    file1ByteStream = new FileInputStream(file1);

    file1ByteStream.skip(file1offset);
    writeBytesToLimit(file1ByteStream, outputFileByteStream, (int)file1Length);

    file1ByteStream.close();
    outputFileByteStream.close(); 
```

这是我的 writeBytesToLimit 函数：

```
private void writeBytesToLimit(FileInputStream inputStream, FileOutputStream outputStream, int byteLimit) throws IOException
{
    int bytesRead = 0;
    int chunkSize = 65536;
    int length = 0;
    byte[] buffer = new byte[chunkSize];
    while((length = inputStream.read(buffer)) != -1)
    {
        bytesRead += length;
        if(bytesRead >= byteLimit)
        {
            int leftoverBytes = byteLimit % chunkSize;              
            byte[] smallBuffer = new byte[leftoverBytes];
            System.arraycopy(buffer, 0, smallBuffer, 0, leftoverBytes);
            outputStream.write(smallBuffer);
            break;
        }

        if(length == chunkSize)
            outputStream.write(buffer);
        else
        {
            byte[] smallBuffer = new byte[length];
            System.arraycopy(buffer, 0, smallBuffer, 0, length);
            outputStream.write(smallBuffer);
        }

    }

} 
```

我如何在 iOS 中做到这一点？对两个 NSInputStreams 和一个 NSOutputStream 使用相同的委托看起来会变得非常混乱。有没有人看过一个如何做到这一点的例子（并且做得干净）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T22:34:20.197

我最终使用了 NSFileHandle。例如，这是我正在做的第一部分。

```
NSData *readData = [[NSData alloc] init];
NSFileHandle *reader1 = [NSFileHandle fileHandleForReadingAtPath:file1Path];
NSFileHandle *writer = [NSFileHandle fileHandleForWritingAtPath:outputFilePath];

//start reading data from file1 to split point and writing it to file
long bytesRead = 0;
while(bytesRead < splitPointInBytes)
{

    //read a chunk of data
    readData = [reader1 readDataOfLength:chunkSize];
    if(readData.length == 0)break;
    //trim data if too much was read
    if(bytesRead + readData.length > splitPointInBytes)
    {
        //get difference of read bytes and byte limit
        long difference = bytesRead + readData.length - splitPointInBytes;

        //trim data
        NSMutableData *readDataMutable = [NSMutableData dataWithData:readData];
        [readDataMutable setLength:readDataMutable.length - difference];
        readData = [NSData dataWithData:readDataMutable];

        NSLog(@"Too much data read, trimming");
    }

    //write data to output file
    [writer writeData:readData];

    //update byte counter
    bytesRead += readData.length;
}
long file1BytesWritten = bytesRead; 
```

# html - CSS - 使用大图像作为背景（性能）

> ID：13943865
> 
> 赞同：0
> 
> 时间：2012-12-19T00:44:09.317
> 
> 标签：html, css

我对网站性能有疑问。我有 4 个大图像（1920*500px）需要在主页上以某种滑块显示 - 用户需要单击以显示下一个图像，它不是幻灯片放映。加载主页时，只看到第一张图片，其余的只有在用户请求时才需要看到。我的问题是下一个。创建一个大图像（精灵）并将其用作**背景**是否明智（这些图像集中在中心，具有支持此分辨率的显示器的用户可以看到孔图像，没有那种显示器的用户会尽可能多地查看）或使用标准**img**标签，或者有​​更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:57:41.937

使用 sprite 的优点是您可以保存 HTTP 请求并预加载图像（例如，这对于响应式图像翻转至关重要）。

在您的情况下，我认为精灵没有任何意义。首先，您只保存了三个 http 请求（第一个图像可能在您加载页面时可见），并且您强制每个访问者下载这些大图像，即使他们不会看到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:52:21.983

我不确定我是否理解您的要求，但如果您总是渲染其中一张图像，那么像这样创建全屏背景图像可能是明智之举。必要时也可以用js更改背景图片

```
<style>
html
{ 
  background: url("your image") no-repeat center center fixed; 
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover;
  opacity:1;
}
</style> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T01:29:12.567

使用 jQuery 更改类。

```
.bg-1 { background: url("your image") no-repeat center center fixed; }
.bg-2 { background: url("your image 2") no-repeat center center fixed; }
.bg-3 { background: url("your image 3") no-repeat center center fixed; } 
```

# android - 哪一种是在Android按钮上实现动作的最佳方法

> ID：13943874
> 
> 赞同：1
> 
> 时间：2012-12-19T00:45:08.447
> 
> 标签：android, button, listener

我想知道Android如何提供几种方法来实现其按钮单击方法。至少我找到了两种方法，第一种是在 Java 代码上使用命令侦听器，第二种是`android:onClick ="method"`在 xml 和`public void method(View v)`java 中使用。所以我的问题是，在编程的简单性和有效性的情况下，哪一个是最好的。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T00:48:05.863

我听说经常在 xml 中定义 onClick 会导致 proguard 出现问题。就我个人而言，我觉得最简单的方法是在 onclicklistener 中使用 switch 和 case，但如果方法更长，那么最好给它自己的方法，以便“隐藏”它。但是，如果您需要在按下任何按钮（例如 UI 刷新）后运行通用代码，则最好将其留给 switch 和 case 或 if/else

// 只是为那些想在 xml 和 proguard 中使用 OnClick 的人添加

添加这个：

```
 -keepclassmembers class * extends android.app.Activity { 
   public void *(android.view.View); 
 } 
```

然而，在我的拙见中，越混淆越开心：P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T10:55:55.643

Java 通常更容易，因为如果您以一个 Activity 的许多 XML 布局（不同的方向、分辨率、语言等）结束，那么每次您想要添加、更改或删除事件时都必须修改它们（a例如长按）。您必须修改的文件数量越少越好。此外，通过将各种事件的命名保留在 XML 文件之外，您可以将它们保持在最小大小，仅包含表达每个布局真正不同之处所需的信息，而不是在它们上重复一些信息。

使用 Java，您在创建代码方面也有更多的可能性。例如，您可以创建一个匿名类并使用它来捕获某些当前状态以供您的侦听器使用。

最后，如果您想动态创建一些按钮/字段；您可以保持管理事件的过程相同，而不是在不同的文件中使用两种不同的方法。

# c# - ContextMenu 导致所有其他 UI 元素不可点击

> ID：13943879
> 
> 赞同：2
> 
> 时间：2012-12-19T00:45:34.993
> 
> 标签：c#, wpf, vb.net, user-interface, contextmenu

我有几个具有以下样式的 ContextMenus：

```
 <Style TargetType="{x:Type ContextMenu}" x:Key="ListBoxContextMenu">
        <Setter Property="BorderBrush" Value="White"/>
        <Setter Property="BorderThickness" Value="0"/>
        <Setter Property="Background" Value="White"/>
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ContextMenu}">
                    <Border Margin="14" Background="White">
                        <Border.Effect>
                            <DropShadowEffect Opacity="0.999" BlurRadius="8" ShadowDepth="0"/>
                        </Border.Effect>
                        <StackPanel IsItemsHost="True" KeyboardNavigation.DirectionalNavigation="Cycle"/>
                    </Border>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

我有一个用于 ListBox 的 ContextMenu，另一个用于按钮（Think Chrome 类型设置菜单）。如果我通过再次单击按钮或单击表单上的任何其他位置关闭按钮的上下文菜单，则关闭列表框，它会很好地关闭，我可以继续正常使用该程序。但是，如果我通过单击 ListBox 关闭 ContextMenu，则只能使用 ListBox，直到单击“n”拖动其中一个 ListBoxItem，之后我可以使用关闭、最小化、搜索等按钮。

窗口图片供参考：

![请忽略实际文字：D](../Images/37dee6dec955f43c591fda27955fba75.png)

ListBoxItem 单击/拖动的代码

```
Private Sub ReferenceListItemMouseDown(sender As Object, e As MouseButtonEventArgs)
    Dim PW As MainWindow = Window.GetWindow(MainPage)
    StartPoint = e.GetPosition(Nothing)
    PW.Resizing = False
End Sub

Private Sub ReferenceListItemMouseMove(sender As Object, e As MouseEventArgs)
    Dim PW As MainWindow = Window.GetWindow(MainPage)
    If PW.Resizing = False Then
        Dim MousePosition As Point = e.GetPosition(Nothing)
        Dim Difference As Vector = StartPoint - MousePosition
        Dim StopDrop As Boolean
        If e.LeftButton = MouseButtonState.Pressed AndAlso (Math.Abs(Difference.X) > SystemParameters.MinimumHorizontalDragDistance Or Math.Abs(Difference.Y) > SystemParameters.MinimumVerticalDragDistance) Then
            Dim LB As ListBox = ReferenceList
            Dim UIE As UIElement = LB.InputHitTest(MousePosition)
            If UIE IsNot Nothing Then
                Dim Data As Object = DependencyProperty.UnsetValue
                While Data Is DependencyProperty.UnsetValue And UIE IsNot Nothing
                    Data = LB.ItemContainerGenerator.ItemFromContainer(UIE)
                    If Data Is DependencyProperty.UnsetValue Then
                        UIE = VisualTreeHelper.GetParent(UIE)
                    End If
                    If UIE Is LB Then
                        StopDrop = True
                    End If
                End While
                If Data IsNot DependencyProperty.UnsetValue Then
                    StopDrop = False
                End If
            Else
                StopDrop = True
            End If
            PW.TempItem = LB.SelectedItem
            Dim FN As String = PW.TempItem.PropLastName & ", " & PW.TempItem.PropFirstName.Substring(0, 1)
            Dim TT As String = PW.TempItem.PropTitle
            Dim YR As String = PW.TempItem.PropYear.ToString
            Dim ReferenceText As String = FN & " " & YR & ", " & TT
            Dim DragData As DataObject = New DataObject(DataFormats.StringFormat, ReferenceText)
            If DragData IsNot Nothing And StopDrop = False Then
                DragDrop.DoDragDrop(sender, DragData, DragDropEffects.Copy)
            End If
        End If
    End If

End Sub 
```

我有一种预感，它是导致此问题的 MouseDown 和 MouseMove 事件。如果有人能发现问题或需要更多信息，请告诉我。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:52:31.770

没关系。我解决了这个问题。我所做的是摆脱 UIElement while 语句和相关代码。然后我用一个简单的 TryCast(sender, ListBoxItem) 替换了它。如果您需要更详细的解释，请告诉我，我会尽快回复您。

# jquery - Jquery 切换复选框

> ID：13943890
> 
> 赞同：5
> 
> 时间：2012-12-19T00:46:31.357
> 
> 标签：jquery

所以我有一个问题。我正在尝试切换复选框以便向父级添加一些 CSS`<tr>`

这是我到目前为止所拥有的

```
 $('input[type=checkbox]').toggle(function(){

    $(this).parents('tr').addClass('selectCheckBox', 970);
},
function(){

    $(this).parents('tr').removeClass('selectCheckBox', 970);
}); 
```

但是，这样做的结果是`<tr>`确实收到了`selectCheckBox`但复选框没有被选中。所以我尝试了以下方法：

```
 $('input[type=checkbox]').toggle(function(){
    $(this).attr('checked',true);
    $(this).parents('tr').addClass('selectCheckBox', 970);
},
function(){
    $(this).attr('checked',false);
    $(this).parents('tr').removeClass('selectCheckBox', 970);
}); 
```

再一次，没有运气。

我相信这与复选框 id 的外观有关。

```
<input type="checkbox" name="select[]" id="select[]"> 
```

`[]`然后我尝试通过使用`\\[\\]`过去使用的方式来逃避，但没有运气。

有没有办法进行`checkbox`检查？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:54:05.607

试穿`change`活动。另外，我认为`toggle`event 已被弃用并且`addClass`不采用第二个参数（除非您使用的是 jQuery UI）。

```
$('input[type=checkbox]').change(function() {
  $(this).parents('tr').toggleClass('selectCheckBox', $(this).is(':checked'));
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T00:56:14.553

可能有一种方法可以进一步优化：

```
$('input[type=checkbox]').on('click', function() {
    var $this = $(this);
    if ($this.is(':checked')) {
        $this.closest('tr').addClass('selectCheckbox');
    } else {
        $this.closest('tr').removeClass('selectCheckbox');
    }
}); 
```

[​JsFiddle](http://jsfiddle.net/4VcEm/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T01:34:31.927

我想到了。我需要使用 toggleClass 以及其他 jQuery UI 参数来获得所需的效果。

```
$('input[type=checkbox]').click(function(){
    $(this).parents('tr').toggleClass('selectCheckBox',  1000, "easeOutSine" );
});

// Here are the parameteres below
    .toggleClass( className [, switch ] [, duration ] [, easing ] [, complete ] ) 
```

# c# - 黑盒测试聊天应用程序c#

> ID：13943894
> 
> 赞同：0
> 
> 时间：2012-12-19T00:46:59.997
> 
> 标签：c#, black-box-testing

我有用 C# 编写的服务器聊天应用程序，它只接收来自发件人的消息。我需要做黑盒测试。我在网上查了一下，发现黑盒测试只是对输入输出的测试，但是并没有真实的例子如何在应用程序中进行。有人可以建议我如何在我的聊天应用程序上进行黑盒测试吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T02:29:06.503

黑盒测试就像你说的，测试输入和输出。可以把它想象成商用飞机上的黑匣子录音机。它允许的输入是音频，输出除了可能是一个允许用户看到它正在工作的指示器之外什么都不是。

对于应用程序，它是同样的事情。问问自己，有没有可以按下的按钮，可以调整窗口大小；总体而言，应用程序中有哪些组件。

我的教授总是做的事情就是砸键盘，看看应用程序是否受到影响。那是键盘输入，看看是否发生了任何不寻常的事情——比如系统出现故障。如果应用程序只是接收消息，您需要想出一种方法来向它发送消息以对其进行测试。您需要考虑发送空字符串的情况，发送不同编码的不同消息，您必须发送非常大的消息。当您执行这些操作时，您会记录它们的输出以及应用程序是通过还是失败。从那时起，您就知道系统的需求是什么，并且可以从那里进行更改。

简而言之，想想任何会影响应用程序的输入（鼠标点击、键盘敲击、发送消息），然后记录输出是什么。使用输出来确定测试是通过还是失败。在您的情况下，您将要编写另一个可以连接到服务器并向其发送有效/无效数据的小型应用程序，以查看您的服务器如何响应它。

# matlab - Matlab R2012a 在 Ubuntu 12.10 上尝试 3D 图形时崩溃

> ID：13943896
> 
> 赞同：4
> 
> 时间：2012-12-19T00:47:08.513
> 
> 标签：matlab, ubuntu

我在 Ubuntu 12.10 上进行 3D 绘图时遇到问题。在我尝试以 3D 绘制数据后，崩溃立即发生。我在这里有崩溃转储和其他错误报告：

```
libGL: OpenDriver: trying /usr/lib/x86_64-linux-gnu/dri/tls/nouveau_dri.so
libGL: OpenDriver: trying /usr/lib/x86_64-linux-gnu/dri/nouveau_dri.so
libGL error: dlopen /usr/lib/x86_64-linux-gnu/dri/nouveau_dri.so failed (/home/jonne/MATLAB/R2012a/bin/glnxa64/libstdc++.so.6: version `GLIBCXX_3.4.15' not found (required by /usr/lib/x86_64-linux-gnu/dri/nouveau_dri.so))
libGL: OpenDriver: trying ${ORIGIN}/dri/tls/nouveau_dri.so
libGL: OpenDriver: trying ${ORIGIN}/dri/nouveau_dri.so
libGL error: dlopen ${ORIGIN}/dri/nouveau_dri.so failed (${ORIGIN}/dri/nouveau_dri.so: cannot open shared object file: No such file or directory)
libGL: OpenDriver: trying /usr/lib/dri/tls/nouveau_dri.so
libGL: OpenDriver: trying /usr/lib/dri/nouveau_dri.so
libGL error: dlopen /usr/lib/dri/nouveau_dri.so failed (/usr/lib/dri/nouveau_dri.so: cannot open shared object file: No such file or directory)
libGL error: unable to load driver: nouveau_dri.so
libGL error: driver pointer missing
libGL error: failed to load driver: nouveau
libGL: OpenDriver: trying /usr/lib/x86_64-linux-gnu/dri/tls/swrast_dri.so
libGL: OpenDriver: trying /usr/lib/x86_64-linux-gnu/dri/swrast_dri.so
libGL error: dlopen /usr/lib/x86_64-linux-gnu/dri/swrast_dri.so failed (/home/jonne/MATLAB/R2012a/bin/glnxa64/libstdc++.so.6: version `GLIBCXX_3.4.15' not found (required by /usr/lib/x86_64-linux-gnu/libLLVM-3.1.so.1))
libGL: OpenDriver: trying ${ORIGIN}/dri/tls/swrast_dri.so
libGL: OpenDriver: trying ${ORIGIN}/dri/swrast_dri.so
libGL error: dlopen ${ORIGIN}/dri/swrast_dri.so failed (${ORIGIN}/dri/swrast_dri.so: cannot open shared object file: No such file or directory)
libGL: OpenDriver: trying /usr/lib/dri/tls/swrast_dri.so
libGL: OpenDriver: trying /usr/lib/dri/swrast_dri.so
libGL error: dlopen /usr/lib/dri/swrast_dri.so failed (/usr/lib/dri/swrast_dri.so: cannot open shared object file: No such file or directory)
libGL error: unable to load driver: swrast_dri.so
libGL error: failed to load driver: swrast 
```

崩溃转储：

```
------------------------------------------------------------------------
       Segmentation violation detected at Wed Dec 19 02:17:00 2012
------------------------------------------------------------------------

Configuration:
  Crash Decoding  : Disabled
  Current Visual  : 0x21 (class 4, depth 24)
  Default Encoding: UTF-8
  GNU C Library   : 2.15 stable
  MATLAB Root     : /home/jonne/MATLAB/R2012a
  MATLAB Version  : 7.14.0.739 (R2012a)
  Operating System: Linux 3.5.0-19-generic #30-Ubuntu SMP Tue Nov 13 17:48:01 UTC 2012 x86_64
  Processor ID    : x86 Family 31 Model 6 Stepping 2, AuthenticAMD
  Virtual Machine : Java 1.6.0_17-b04 with Sun Microsystems Inc. Java HotSpot(TM) 64-Bit Server VM mixed mode
  Window System   : The X.Org Foundation (11300000), display :0.0

Fault Count: 1

Abnormal termination:
Segmentation violation

Register State (from fault):
  RAX = 0000000000000000  RBX = 0000000000000000
  RCX = 0000000000000000  RDX = 00007fb9ac068658
  RSP = 00007fb9bb8e38e8  RBP = 00000000009a0005
  RSI = 0000000000000000  RDI = 0000000000000000

   R8 = 00007fb9ac068680   R9 = 0000000000000000
  R10 = 0000000000000000  R11 = 0000000000000000
  R12 = 0000000000001f02  R13 = 0000000000000000
  R14 = 00007fb9c6b797d0  R15 = 0000000000000000

  RIP = 00007fb973df6d00  EFL = 0000000000010206

   CS = 0033   FS = 0000   GS = 0000

Stack Trace (from fault):
[  0] 0x00007fb9d09f592e   /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwfl.so+00370990 _ZN2fl4diag15stacktrace_base7captureERKNS0_14thread_contextEm+000158
[  1] 0x00007fb9d09f87d0   /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwfl.so+00382928
[  2] 0x00007fb9d09f8b3b   /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwfl.so+00383803 _ZN2fl4diag13terminate_logEPKcRKNS0_14thread_contextE+000171
[  3] 0x00007fb9cf8dc203  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01253891 _ZN2fl4diag13terminate_logEPKcPK8ucontext+000067
[  4] 0x00007fb9cf8d90fd  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01241341
[  5] 0x00007fb9cf8da79d  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01247133
[  6] 0x00007fb9cf8da925  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01247525
[  7] 0x00007fb9cf8daf01  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01249025
[  8] 0x00007fb9cf8db3f5  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01250293
[  9] 0x00007fb9cdfa2cb0              /lib/x86_64-linux-gnu/libpthread.so.0+00064688
[ 10] 0x00007fb973df6d00          /usr/lib/x86_64-linux-gnu/libxcb-glx.so.0+00056576 xcb_glx_get_string_string_length+000000
[ 11] 0x00007fb97c98a6b4          /usr/lib/x86_64-linux-gnu/mesa/libGL.so.1+00272052 __glXGetString+000068
[ 12] 0x00007fb97c98812e          /usr/lib/x86_64-linux-gnu/mesa/libGL.so.1+00262446
[ 13] 0x00007fb97cbbf379     /home/jonne/MATLAB/R2012a/bin/glnxa64/glren.so+00078713
[ 14] 0x00007fb97cbb6b40     /home/jonne/MATLAB/R2012a/bin/glnxa64/glren.so+00043840
[ 15] 0x00007fb97cbb6cc6     /home/jonne/MATLAB/R2012a/bin/glnxa64/glren.so+00044230
[ 16] 0x00007fb9c68d30a8   /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwhg.so+09408680 _Z22OpenGLSetupEnumstrOnceb+000296
[ 17] 0x00007fb9c6827ac7   /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwhg.so+08706759 gf_DetermineBestRenderMode+000183
[ 18] 0x00007fb9c6827c0b   /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwhg.so+08707083 _Z22gf_DetermineRenderModeP11GObject_tagi+000107
[ 19] 0x00007fb9c6827d0a   /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwhg.so+08707338 InitializeFigureRenderEngine+000074
[ 20] 0x00007fb9c6828114   /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwhg.so+08708372
[ 21] 0x00007fb9c689418c   /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwhg.so+09150860
[ 22] 0x00007fb9c684a89b   /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwhg.so+08849563 _Z24commitHG1DatabaseUpdatesb+000235
[ 23] 0x00007fb9d0157e16 /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwservices.so+01359382 _Z26svWS_CommitDatabaseUpdates28svCommitDatabaseUpdatesType_+000390
[ 24] 0x00007fb9c5030387  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwuix.so+00525191
[ 25] 0x00007fb9c5030691  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwuix.so+00525969
[ 26] 0x00007fb9cfb476eb /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwbridge.so+00124651
[ 27] 0x00007fb9cfb47cde /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwbridge.so+00126174 _Z10ioReadLinebP8_IO_FILEPcS1_iPbRKN5boost8optionalIKP15inWorkSpace_tagEEb+000990
[ 28] 0x00007fb9cfb48165 /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwbridge.so+00127333
[ 29] 0x00007fb9cfb4cd0a /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwbridge.so+00146698
[ 30] 0x00007fb9cfb4d165 /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwbridge.so+00147813
[ 31] 0x00007fb9cfb4d9ce /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwbridge.so+00149966 mnParser+000702
[ 32] 0x00007fb9cf8c0de2  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01142242 _ZN11mcrInstance30mnParser_on_interpreter_threadEv+000034
[ 33] 0x00007fb9cf8a351a  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01021210
[ 34] 0x00007fb9cf8a3598  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01021336
[ 35] 0x00007fb9c5021376  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwuix.so+00463734
[ 36] 0x00007fb9c502b862  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwuix.so+00505954
[ 37] 0x00007fb9d01599a1 /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwservices.so+01366433 _ZSt8for_eachIN9__gnu_cxx17__normal_iteratorIPN5boost8weak_ptrIN4sysq10ws_ppeHookEEESt6vectorIS6_SaIS6_EEEENS4_8during_FIS6_NS2_10shared_ptrIS5_EEEEET0_T_SH_SG_+000081
[ 38] 0x00007fb9d015aaab /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwservices.so+01370795
[ 39] 0x00007fb9d01585f9 /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwservices.so+01361401 _Z25svWS_ProcessPendingEventsiib+000665
[ 40] 0x00007fb9cf8a276f  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01017711
[ 41] 0x00007fb9cf8a2c3b  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01018939
[ 42] 0x00007fb9cf8a2d97  /home/jonne/MATLAB/R2012a/bin/glnxa64/libmwmcr.so+01019287
[ 43] 0x00007fb9cdf9ae9a              /lib/x86_64-linux-gnu/libpthread.so.0+00032410
[ 44] 0x00007fb9cdcc7cbd                    /lib/x86_64-linux-gnu/libc.so.6+00998589 clone+000109 
```

有谁知道我应该怎么做才能完成这项工作？2D 绘图工作，但 3D 不...

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T01:26:21.763

你用的是什么渲染器？你能发布你的脚本的代码片段吗？

首先尝试创建图形，指定渲染器。例如，

```
figure('renderer','zbuffer') 
```

我对`zbuffer`渲染器的运气比例如`opengl`或更多`painters`。事实上，在我的启动脚本中，我确保我打开的每个图形窗口都使用 zbuffer - 我发现它的渲染速度更快，并且随机崩溃的问题更少。

见： http: [//www.mathworks.com.au/help/matlab/ref/figure_props.html](http://www.mathworks.com.au/help/matlab/ref/figure_props.html)

> 渲染器画家 | 缓冲区 | OpenGL
> 
> 用于丝网和印刷的渲染方法。选择用于渲染 MATLAB 图形的方法。选择是：
> 
> 画家 - 当图窗仅包含简单或小型图形对象时，MATLAB 使用的原始渲染方法更快。
> 
> zbuffer — MATLAB 更快、更准确地绘制图形对象，因为它基于每个像素为对象着色，并且 MATLAB 仅渲染场景中可见的那些像素（从而消除了从前到后的排序错误）。请注意，如果 MATLAB 显示复杂场景，此方法会消耗大量系统内存。
> 
> OpenGL — OpenGL 是一种可在许多计算机系统上使用的渲染器。此渲染器通常比 Painters 或 zbuffer 更快，并且在某些情况下使 MATLAB 能够访问某些系统上可用的图形硬件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T21:35:28.817

这对我有帮助： [https](https://bbs.archlinux.org/viewtopic.php?id=154775) ://bbs.archlinux.org/viewtopic.php?id=154775 （...从[如何告诉 mex 链接到 /usr/lib 中的 libstdc++.so.6 而不是MATLAB 目录中的一个？](https://stackoverflow.com/questions/9959306/how-to-tell-mex-to-link-with-the-libstdc-so-6-in-usr-lib-instead-of-the-one-i)）

基本上我只是这样做了：

```
sudo mv /usr/local/MATLAB/R2012a/sys/os/glnx86/libstdc++.so.6 /usr/local/MATLAB/R2012a/sys/os/glnx86/libstdc++.so.6__bck 
```

和

```
sudo ln -s /usr/lib/i386-linux-gnu/libstdc++.so.6.0.17 /usr/local/MATLAB/R2012a/sys/os/glnx86/libstdc++.so.6 
```

# algorithm - 是否有一个完善的增量算法来维护在特定时间范围内累积的价值历史？

> ID：13943898
> 
> 赞同：0
> 
> 时间：2012-12-19T00:47:12.320
> 
> 标签：algorithm, statistics, bandwidth, jagged-arrays, netflow

我实际上已经完成了一个，但想将我的与一个经过充分研究的可能的学术算法进行比较。可能有一个统计对象库，可以直接或组合解决我的特殊需求。

我的系统（我打算开源）有一个 NetFlow 数据流。与其存储在数据库中并使用 SQL 函数，我更喜欢拥有一个无数据库系统并维护一组统计信息，为每个新流更新，并每秒滚动（或更高）。

我的解决方案涉及单个 uint 数组，以有效地创建大小为 [60、59、23、6、...] 的锯齿状数组，代表秒、分钟、小时、天、周等。

每个插槽包含该时间的总字节数。因此**，在 60 秒后，将创建一个单分钟统计信息作为 Avg(seconds)**。当然，这在时间尺度上会持续相对较长。

不是简单地有数千秒的增量，而是由于：

1.  内存限制和拥有更多统计节点的潜力；和
2.  向用户理想的展示

...我卷起时间尺度。

鉴于一个流可能应用于统计层次结构中的多个节点（WAN 链接、IP 地址、目标地址、SourcePort-DestinationPort），我计算了一次增量（GenerateDelta），然后简单地应用于每个既活跃又活跃的节点与流元数据匹配。

在以下潜在情况下，将“滚动”给定节点上的统计信息：

1.  被读取/显示时（通过 HTTP\JSON AJAX 请求）
2.  应用增量时（由于相关流程）
3.  只需每 n 秒（n 通常为 1）

总体而言**，可能有一个完善的算法来保持随时间推移的运行总数（以秒、分钟......）**。但如果做不到这一点，也可能有合适的算法来比较我的代码的较小子部分：

*   GenerateDelta - 不太可能，因为这专门用于分解和平均统计数组中插槽上的持续时间的流。
*   滚动 - 如果只有几秒钟，那么这当然很简单，但是我的解决方案要求每 60 秒将 60 秒组合成一个新的分钟总数，依此类推。

**我不希望响应者提出任何他们自己的算法**，我已经（几乎）完成了我自己的所有算法，没有任何问题并且考虑了许多性能。当我完成并作为开源发布后，其他人可能会看到我的算法。

**我希望看到的是任何“完善”的比较算法。也许我的会更好，也许我的会更糟。谷歌不擅长这类问题，我需要你的帮助。**

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T14:15:16.840

感谢@rici 的评论，我发现“流统计”域是必需的。有用于处理流统计的数据流管理系统 (DSMS)。SQL RDBMS 系统可以存储数据和 SQL 查询生成的统计信息，而数据流管理系统可以在给定一个或多个查询的情况下处理连续的数据流。

[本文](http://www.vldb.org/conf/2002/S10P04.pdf)将 DSMS 描述为：

1.  能够为了定性使用而牺牲质量
2.  单程，因为数据量很大
3.  让查询将数据视为序列而不是集合等等...

[这个](http://eolo.cps.unizar.es/Docencia/doctorado/Articulos/DataStreams/Issues%20in%20Data%20Stream%20Management.pdf)，描述了这样一个 DSMS 的图表，引用了网络流量分析问题域，

[本文](http://ilpubs.stanford.edu:8090/535/1/2002-19.pdf)描述了 StreamSQL，一种类似 SQL 的语法，用于定义连续查询。

即使无法访问专有解决方案。当然有完善的算法。因此，我可以针对通用流查询工具测试我的专业系统的性能。

DSMS 的几个产品/原型可以在[这个 wiki 页面](http://en.wikipedia.org/wiki/Data-stream_management_system)中找到，特别是[Odysseus](http://odysseus.informatik.uni-oldenburg.de:8090/display/ODYSSEUS/Odysseus+Home)很有趣，它是基于 Java 和开源的。

# java - 为什么 jar 文件在有控制台和没有控制台的情况下工作方式不同？

> ID：13943904
> 
> 赞同：1
> 
> 时间：2012-12-19T00:47:32.293
> 
> 标签：java, eclipse, jar, console, cmd

当我通过以下方式运行同一程序时，我使用相同的程序获得了不同的结果：
1)..\Desktop\app.jar
2)..\Desktop\java -jar app.jar
第二种情况给出了我在 eclipse 中看到的相同结果，但它使用控制台。
问题是：如何通过直接执行 app.jar（没有控制台）来强制我的程序正常工作（给出与 eclipse 中相同的结果）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T01:33:32.847

在命令行中使用`javaw`而不是：`java`

```
..\Desktop\javaw -jar app.jar 
```

更多信息：[http ://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/java.html](http://docs.oracle.com/javase/1.4.2/docs/tooldocs/windows/java.html)

# graphics - 使用 SVG 进行加色混合（additive blending）

> ID：13943905
> 
> 赞同：10
> 
> 时间：2012-12-19T00:47:34.177
> 
> 标签：graphics, colors, svg, transparency, svg-filters

来自平面设计背景，我知道如何作弊以创建[加色](http://en.wikipedia.org/wiki/Additive_color)效果。[在这里的另一篇文章](https://stackoverflow.com/questions/13669491/are-there-ways-to-use-additive-color-mixing-in-web-development)中提出了相同的基本解决方案。

上面的帖子是指透明`.png`文件，但概念是相同的。我想要创建的基本效果就像[这里所描绘](http://www.d.umn.edu/~mharvey/colorwheel.jpg)的那样。

我很想在 SVG 中做它，以便它可以缩放，这样当我谈论给定主题时（假设主题是“绿色”）我可以放大图形的那部分并且重叠区域仍然会正确显示。

这些帖子似乎非常接近：

*   [RGB 值的加色混合算法](https://stackoverflow.com/questions/726549/algorithm-for-additive-color-mixing-for-rgb-values)
*   [关于“添加剂混合”和“色相替换”的问题](https://stackoverflow.com/questions/4750290/question-about-additive-blending-and-hue-replacement)

但以上都没有涉及 SVG，所以让我试一试。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-19T10:21:12.807

现在您可以使用[SVG 过滤器](http://www.w3.org/TR/SVG11/filters.html)来做到这一点。由于您的兴趣在于混合颜色，您可能有兴趣研究以下过滤器原语：[feBlend](http://www.w3.org/TR/SVG11/filters.html#feBlendElement)、[feComposite](http://www.w3.org/TR/SVG11/filters.html#feCompositeElement)、[feColorMatrix](http://www.w3.org/TR/SVG11/filters.html#feColorMatrixElement)和[feComponentTransfer](http://www.w3.org/TR/SVG11/filters.html#feComponentTransferElement)。

如果您想学习简单的方法 (Inkscape)，请参阅[此博文](http://fedev.blogspot.se/2008/04/filter-effects-blend.html)。我还可以推荐阅读[Inkscape 书](http://tavmjong.free.fr/INKSCAPE/MANUAL/html/index.html)，尤其是如何进行[自定义过滤器](http://tavmjong.free.fr/INKSCAPE/MANUAL/html/Filters.html)。[这是](http://tavmjong.free.fr/INKSCAPE/MANUAL/html/Filters-Compositing.html)显示 feBlend 的一页，其结果与您的基本效果示例类似。

**更新：** [这是来自 inkscape 书中的相关 svg 文件](http://tavmjong.free.fr/INKSCAPE/MANUAL/images/FILTERS/Filters_Blend.svg)，它在支持 svg 过滤器的浏览器中应该如下图所示（以及`BackgroundImage`过滤器输入，请注意 Gecko 不支持`BackgroundImage`and `enable-background`）。![feBlend 变体](../Images/d447f6120cfcf679c5d096cd7b2c13e7.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T18:53:23.220

此版本取代了并非真正跨浏览器的早期版本。我意识到我不需要为各种圆圈设置单独的形状，我可以在滤镜中克隆、重新定位和重新着色原始形状。

```
<svg x="0px" y="0px" width="600px" height="600px" viewbox="0 0 600 600">

    <defs>
    <filter id="B4" x="-150%" width="400%" y="-150%" height="400%">
      <feOffset in="SourceGraphic" result="pre-red" dx="-70" dy="-120"/>
      <feColorMatrix in="pre-red" type="matrix" result="red" values="0 0 0 0 1
                                                       0 0 0 0 0 
                                                       0 0 0 0 0 
                                                       0 0 0 1 0"/>

      <feOffset in="SourceGraphic" result="pre-blue" dx="70" dy="-120"/>
      <feColorMatrix in="pre-blue" type="matrix" result="blue" values="0 0 0 0 0
                                                       0 0 0 0 0 
                                                       0 0 0 0 1 
                                                       0 0 0 1 0"/> 
      <feBlend mode="screen" in="red" in2="blue" result="main"/>
      <feBlend mode="screen" in="main" in2="SourceGraphic"/>
    </filter>
    </defs>

       <circle filter="url(#B4)" cx="200" cy="250" r="100"  fill="#00FF00"  />

    </svg>
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-10-02T14:29:22.513

来自[https://drafts.fxtf.org/compositing-1/#mix-blend-mode](https://drafts.fxtf.org/compositing-1/#mix-blend-mode)，示例 2：

```
circle { mix-blend-mode: screen; }

<svg>
    <circle cx="40" cy="40" r="40" fill="red"/>
    <circle cx="80" cy="40" r="40" fill="lime"/>
    <circle cx="60" cy="80" r="40" fill="blue"/>
</svg> 
```

# php - JavaScript 发布 PHP 动作

> ID：13943906
> 
> 赞同：1
> 
> 时间：2012-12-19T00:47:34.927
> 
> 标签：php, javascript, forms

我的以下代码在选中或未选中复选框时都会发布。当它没有被检查时，我会得到警报然后发布。但是当自动检查它的发布时。

单击提交按钮时，我需要 JavaScript 来发布表单，并且应保持选中复选框。否则它应该只是给我一个警报。但不幸的是，即使未选中复选框并使用提交按钮，页面也会重新加载。

我的代码是

```
<script type="text/javascript">
function check()
  {
  if(document.getElementById("privacy").checked == true)
      {
        document.print.submit();
      }
    else{
        alert('Please read and accept our privacy statments to proceed.');
    };
  }
</script>
</head>

<body>
<form id="print" action="printfile.php">
<div id="express">
<table width="800">
          <tr>
            <td colspan="2"><span style="color:#FF0000; font-size:26px;">Express Application</span></td>
          </tr>
          <tr>
            <td width="300">&nbsp;</td>
            <td width="500">&nbsp;</td>
          </tr>
          <tr>
            <td>First Name (Required) </td>
            <td><input name="firstname" type="text" size="30"/></td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td>Last Name </td>
            <td><input name="lastname" type="text" size="30"/></td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td>Email (Required) </td>
            <td><input name="email" type="text" id="email" size="30"/></td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td>Purpose of finance (Required) </td>
            <td><select name="purpose" id="purpose">
              <option selected="selected">Home Loan</option>
              <option>Refinance</option>
              <option>Investment Loan</option>
              <option>Debit Consolidation</option>
              <option>Others</option>
            </select></td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td>Your deposit amount </td>
            <td><input name="depositamount" type="text" size="30"/></td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td>Amount you need to borrow? </td>
            <td><input name="borrowamount" type="text" size="30"/></td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td>Brief description of purpose of <br />
            finance (Required) <br />
            <br />
            <br />
            <br />
            <br />
            <br /></td>
            <td><textarea name="purposedesc" cols="60" rows="10" id="purposedesc"></textarea></td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td>Application Type<br />
            <br /></td>
            <td><label>
              <input type="radio" name="apptype" value="Single" onclick="document.getElementById('singleapp').style.visibility = 'visible'; document.getElementById('jointapp').style.visibility = 'hidden';" />
Single Application</label>
            <br />
              <label>
              <input type="radio" name="apptype" value="Joint" onclick="document.getElementById('singleapp').style.visibility = 'visible'; document.getElementById('jointapp').style.visibility = 'visible';" />
Joint Application</label></td>
          </tr>
          <tr>
            <td>&nbsp;</td>
            <td>&nbsp;</td>
          </tr>
          <tr>
            <td colspan="2"><input name="privacy" type="checkbox" id="privacy" value="checkbox" />
Privacy Act (Required) <br />
<br />
I have read the Privacy Act 1988 (as Amended) and understand that by selecting the submit button I/we authorise Best Aussie Broker to act on my/our behalf and manage personal information in relation to this application. </td>
          </tr>
  </table>
  <br />
  Last step then we will get all listed Australian vendors to fight it out for your best deal.<br /> 
  <br />
<table width="800" border="0" style="">
      <tr>
        <td width="400">
            <div id="singleapp">
              <table width="400" border="0">
                <tr>
                  <td colspan="2" bgcolor="#333300"><span class="style1">Your application </span></td>
                </tr>
                <tr>
                  <td width="150">&nbsp;</td>
                  <td width="240">&nbsp;</td>
                </tr>
                <tr>
                  <td>Date of Birth</td>
                  <td><select name="day1" id="day1">
                    <option selected="selected">1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                    <option>8</option>
                    <option>9</option>
                    <option>10</option>
                    <option>11</option>
                    <option>12</option>
                    <option>13</option>
                    <option>14</option>
                    <option>15</option>
                    <option>16</option>
                    <option>17</option>
                    <option>18</option>
                    <option>19</option>
                    <option>20</option>
                    <option>21</option>
                    <option>22</option>
                    <option>23</option>
                    <option>24</option>
                    <option>25</option>
                    <option>26</option>
                    <option>27</option>
                    <option>28</option>
                    <option>29</option>
                    <option>30</option>
                    <option>31</option>
                                                      </select>
                    <select name="month1" id="month1">
                      <option selected="selected">Jan</option>
                      <option>Feb</option>
                      <option>Mar</option>
                      <option>Apl</option>
                      <option>May</option>
                      <option>Jun</option>
                      <option>Jul</option>
                      <option>Aug</option>
                      <option>Sep</option>
                      <option>Oct</option>
                      <option>Nov</option>
                      <option>Dec</option>
               </select>
               <input name="year1" type="text" id="year1" style="padding:1.2px;" size="8" maxlength="4" />             </td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>Address</td>
                  <td><input name="address1" type="text" id="address1" size="20"/></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>Suburb</td>
                  <td><input name="suburb1" type="text" id="suburb1" size="20"/></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>PostCode</td>
                  <td><input name="postcode1" type="text" id="postcode1" size="20"/></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>State</td>
                  <td><select name="state1" id="state1">
                    <option value="Victoria" selected="selected">VIC</option>
                    <option value="New South Wales">NSW</option>
                    <option value="QueensLand">QLD</option>
                    <option value="South Australia">SA</option>
                    <option value="Western Australia">WA</option>
                    <option value="Tasmania">TAS</option>
                    <option value="New Zeland">NZ</option>
                    <option value="Other">Other</option>
                                                                        </select></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>Best contact </td>
                  <td><select name="phone1" id="phone1">
                    <option>Phone</option>
                    <option>Email</option>
                                    </select></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>Phone number </td>
                  <td><input name="number1" type="text" id="number1" size="20"/></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>Marital status </td>
                  <td><select name="maried1" id="maried1">
                    <option>Single</option>
                    <option>Married</option>
                    <option>Other</option>
                                    </select></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>Residential status </td>
                  <td><select name="rstatus1" id="rstatus1">
                    <option selected="selected">Renting</option>
                    <option>Home Owner</option>
                    <option>Home Mortgaged</option>
                    <option>Board</option>
                    <option>Other</option>
                                                                        </select></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>Children/dependents</td>
                  <td><select name="childs1" id="childs1">
                    <option value="0" selected="selected">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6 or more">6 or more</option>
                                                      </select></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>Net income </td>
                  <td><input name="netincome1" type="text" id="netincome1" size="10"/> 
                    per 
                      <select name="months1" id="months1">
                        <option>Month</option>
                        <option>Year</option>
                    </select></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>Current employer </td>
                  <td><input name="cemployer1" type="text" id="cemployer1" size="20"/></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>Time at this<br /> 
                  employer </td>
                  <td> Years 
                    <select name="years1" id="years1">
                      <option value="1" selected="selected">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                      <option value="10">10</option>
                      <option value="More">More</option>
                    </select> 
                    Months 
                    <select name="emonth1" id="emonth1">
                      <option value="0" selected="selected">0</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                      <option value="10">10</option>
                      <option value="11">11</option>
                      <option value="12">12</option>
                    </select></td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
                </tr>
                <tr>
                  <td>&nbsp;</td>
                  <td><input name="submit" type="submit" value="Submit my Application" onclick="check();" /></td>
                </tr>
              </table>
            </div>
        </td>
        <td width="400">
          <div id="jointapp">
            <table width="400" border="0">
              <tr>
                <td colspan="2" bgcolor="#333300"><span class="style1">Your partner's application </span></td>
              </tr>
              <tr>
                <td width="150">&nbsp;</td>
                <td width="240">&nbsp;</td>
              </tr>
              <tr>
                <td>Date of Birth</td>
                <td><select name="day11" id="day11">
                    <option selected="selected">1</option>
                    <option>2</option>
                    <option>3</option>
                    <option>4</option>
                    <option>5</option>
                    <option>6</option>
                    <option>7</option>
                    <option>8</option>
                    <option>9</option>
                    <option>10</option>
                    <option>11</option>
                    <option>12</option>
                    <option>13</option>
                    <option>14</option>
                    <option>15</option>
                    <option>16</option>
                    <option>17</option>
                    <option>18</option>
                    <option>19</option>
                    <option>20</option>
                    <option>21</option>
                    <option>22</option>
                    <option>23</option>
                    <option>24</option>
                    <option>25</option>
                    <option>26</option>
                    <option>27</option>
                    <option>28</option>
                    <option>29</option>
                    <option>30</option>
                    <option>31</option>
                  </select>
                    <select name="month11" id="month11">
                      <option selected="selected">Jan</option>
                      <option>Feb</option>
                      <option>Mar</option>
                      <option>Apl</option>
                      <option>May</option>
                      <option>Jun</option>
                      <option>Jul</option>
                      <option>Aug</option>
                      <option>Sep</option>
                      <option>Oct</option>
                      <option>Nov</option>
                      <option>Dec</option>
                  </select>
                    <input name="year2" type="text" size="8" maxlength="4" style="padding:1.2px;" />                </td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Address</td>
                <td><input name="address12" type="text" id="address12" size="20"/></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Suburb</td>
                <td><input name="suburb12" type="text" id="suburb12" size="20"/></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>PostCode</td>
                <td><input name="postcode12" type="text" id="postcode12" size="20"/></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>State</td>
                <td><select name="state12" id="state12">
                  <option value="Victoria" selected="selected">VIC</option>
                  <option value="New South Wales">NSW</option>
                  <option value="QueensLand">QLD</option>
                  <option value="South Australia">SA</option>
                  <option value="Western Australia">WA</option>
                  <option value="Tasmania">TAS</option>
                  <option value="New Zeland">NZ</option>
                  <option value="Other">Other</option>
                </select></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Best contact </td>
                <td><select name="phone11" id="phone11">
                    <option>Phone</option>
                    <option>Email</option>
                </select></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Phone number </td>
                <td><input name="number11" type="text" id="number11" size="20"/></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Marital status </td>
                <td><select name="married12" id="married12">
                    <option>Single</option>
                    <option>Married</option>
                    <option>Other</option>
                </select></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Residential status </td>
                <td><select name="rstatus12" id="rstatus12">
                    <option selected="selected">Renting</option>
                    <option>Home Owner</option>
                    <option>Home Mortgaged</option>
                    <option>Board</option>
                    <option>Other</option>
                </select></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Children/dependents</td>
                <td><select name="childs12" id="childs12">
                    <option value="0" selected="selected">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6 or more">6 or more</option>
                </select></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Net income </td>
                <td><input name="netincome12" type="text" id="netincome12" size="10"/>
                  per
                  <select name="months12" id="months12">
          <option>Month</option>
          <option>Year</option>
      </select></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Current employer </td>
                <td><input name="cemployer12" type="text" id="cemployer12" size="20"/></td>
              </tr>
              <tr>
                <td>&nbsp;</td>
                <td>&nbsp;</td>
              </tr>
              <tr>
                <td>Time at this<br />
                employer </td>
                <td> Years
                  <select name="years12" id="years12">
                      <option value="1" selected="selected">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                      <option value="4">4</option>
                      <option value="5">5</option>
                      <option value="6">6</option>
                      <option value="7">7</option>
                      <option value="8">8</option>
                      <option value="9">9</option>
                      <option value="10">10</option>
                      <option value="More">More</option>
                  </select>
                  Months
                  <select name="emonths12" id="emonths12">
                    <option value="0" selected="selected">0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                  </select></td>
              </tr>
            </table>
            <br />
            <br />
            <br />
            <br />
            <br />
          </div>
        </td>
      </tr>
    </table>
<p><br />
    <br />
    <center>
    </center>
    <br />
</p>
</div>
</form> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T00:51:48.987

使用您正在使用的内联事件处理程序语法，它最容易返回`false`，因此不会执行默认操作（提交）：

```
<input name="submit"
       type="submit"
       value="Submit my Application"
       onclick="check(); return false;" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-19T00:50:19.300

您需要使提交返回 false，否则它只会执行表单在单击提交时执行的常规操作。

```
if(document.getElementById("privacy").checked == true)
{
    document.print.submit();
}
else
{
    alert('Please read and accept our privacy statments to proceed.');
    return false;
} 
```

从技术上讲，无论如何它都会提交。你可以让它检查，只有在没有检查时才拦截。

```
if(document.getElementById("privacy").checked == false)
{
    alert('Please read and accept our privacy statments to proceed.');
    return false;
} 
```

还添加返回提交`onclick`（链接@AndreKR 说）

```
<input name="submit" type="submit" value="Submit my Application" onclick="return check();" /> 
```

# javascript - 我的对象没有在 Three.js 中反射光线

> ID：13943907
> 
> 赞同：3
> 
> 时间：2012-12-19T00:47:35.347
> 
> 标签：javascript, three.js

我在 three.js 场景中有一些基于 CubeGeometry 的网格，它们都反映了我在全球范围内使用的 PointLight。但是其中一个是由“手工”制作的，只有 THREE.Geometry（通过代码添加顶点和面）没有反映出来。即使它没有颜色，我也只能为此设置颜色，如果我在 MeshPhongMaterial 上将 THREE.Color 设置为“发射”键。

由 JS 函数动态生成的几何图形。我正在使用这个灯：

```
 pointLight = new THREE.PointLight(0xFFFEF0, 1, 100000)
    pointLight.position = camera.position;
    scene.add(
        pointLight
    ); 
```

我正在使用以下代码创建提到的网格：

```
 var floor = new THREE.Mesh(
            ShelfArchitect.Utils.getFloorGeometry(walls), 
            new THREE.MeshPhongMaterial(materialParams)
        ); 
```

我应该在materialParams上添加一些东西吗？或者是什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T22:05:49.623

听起来“手”制作的几何图形丢失了，或者顶点法线不正确。

你可以这样做：

```
geometry.computeFaceNormals();
geometry.computeVertexNormals(); 
```

# nhibernate - nhibernate，无法解析属性 QueryOver 只有一个表

> ID：13943908
> 
> 赞同：5
> 
> 时间：2012-12-19T00:47:44.800
> 
> 标签：nhibernate, domain-driven-design, ddd-repositories

我发现了十几个与我类似的问题，但没有一个能解决我的问题。

先感谢您

行，

我有这门课

```
public class User : IEntity
    {
        private int id;
        public virtual int Id { get { return id; } }

        private string email;

        public virtual string Email
        {
            get { return email; }
            //private set { email = value; }
        }

        private string password;

        public virtual string Password
        {
            get { return password; }
            //private set { password = value; }
        }

        private bool isActive;

        public virtual bool IsActive
        {
            get { return isActive; }
            //private set { isActive = value; }
        }

        private bool isRegistered;

        public virtual bool IsRegistered
        {
            get { return isRegistered; }
            //private set { isRegistered = value; }
        }

        private bool hasRequestedApplication;

        public virtual bool HasRequestedApplication
        {
            get { return hasRequestedApplication; }
            //private set { hasRequestedApplication = value; }
        }

        private ContactInfo contactInformation;

        public virtual ContactInfo ContactInformation
        {
            get { return contactInformation; }
            //private set { contactInformation = value; }
        }

        public User(string email)
        {
            this.email = email;
        }

        public User(string email, string password):this(email)
        {
            this.password = password;
        }

        public User()
        { }
} 
```

这是映射....

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2" assembly="Domain"
                 namespace="Domain.User" default-access="field">

  <class name="User" table="[User]">

    <id name="id" column="UserID">
      <generator class="identity" />
    </id>
    <property name="email" column="Email" not-null="true"></property>
    <property name="password" column="HashedPassword" not-null="false"></property>
    <property name="isRegistered" column="IsRegistered" not-null="true"></property>
    <property name="isActive" column="IsActive" not-null="true"></property>
    <property name="hasRequestedApplication" column="HasRequestedApplication" not-null="true"></property>

    <one-to-one name="contactInformation" class="Domain.User.ContactInfo"/>
  </class>
</hibernate-mapping> 
```

这就是我所说的

```
 public class UserRepository: IUserRepository
    {
        Func<ISession> session;

        public UserRepository(Func<ISession> _session)
        {
            session = _session;
        }

        [Transaction]
        public User FindByEmail(string emailAddress)
        {
            using (var tx = session())
            {
                return tx.QueryOver<User>().Where(u => u.Email == emailAddress).SingleOrDefault();
            }
        }
} 
```

错误... {“无法解析属性：电子邮件地址：Domain.User.User”}

堆栈跟踪...

NHibernate.Persister.Entity.AbstractPropertyMapping.ToType(String propertyName) 在 NHibernate.Persister NHibernate.Persister.Entity.BasicEntityPropertyMapping.ToColumns(String alias, String propertyName) NHibernate.Loader.Criteria.CriteriaQueryTranslator.GetColumnsUsingProjection (ICriteria subcriteria, String propertyName) at NHibernate.Loader.Criteria.CriteriaQueryTranslator.GetColumns(ICriteria subcriteria, String propertyName) at NHibernate.Criterion NHibernate.Criterion 的 .CriterionUtil.GetColumnNamesUsingPropertyName(ICriteriaQuery criteriaQuery, ICriteria criteria, String propertyName, Object value, ICriterion critertion)。SimpleExpression.ToSqlString（ICriteria 条件，ICriteriaQuery 条件查询，IDictionary`2 enabledFilters) at NHibernate.Loader.Criteria.CriteriaQueryTranslator.GetWhereCondition(IDictionary`2 enabledFilters) 在 NHibernate.Loader.Criteria.CriteriaJoinWalker..ctor(IOuterJoinLoadable 持久化器，CriteriaQueryTranslator 转换器，ISessionFactoryImplementor 工厂，ICriteria 标准，字符串 rootEntityName，IDictionary `2 enabledFilters) at NHibernate.Loader.Criteria.CriteriaLoader..ctor(IOuterJoinLoadable persister, ISessionFactoryImplementor factory, CriteriaImpl rootCriteria, String rootEntityName, IDictionary`2 enabledFilters) 在 NHibernate.Impl.SessionImpl.List(CriteriaImpl 标准，IList 结果) 在NHibernate.Impl.CriteriaImpl.UniqueResultT 在 NHibernate.Impl.CriteriaImpl.List(IList 结果) 在 NHibernate.Criterion.QueryOver`1.SingleOrDefault() at NHibernate.Criterion.QueryOver`1.NHibernate.IQueryOver.SingleOrDefault() at DataObjects.NHibernate.UserRepository.FindByEmail(String emailAddress) 在 E:\Projects\DataObjects.NHibernate\UserRepository.cs:第 26 行 Castle.Proxies.Invocations.IUserRepository_FindByEmail.InvokeMethodOnTarget() 在Castle.DynamicProxy.AbstractInvocation.Proceed() at Castle.Facilities.AutoTx.TransactionInterceptor.SynchronizedCase(IInvocation invocation, ITransaction transaction) in d:\BuildAgent-03\work\9844bdf039249947\src\Castle.Facilities.AutoTx\TransactionInterceptor.cs：第 137 行

编辑：

好的。一定程度上解决了。我在映射中将所有属性和组件名称更改为大写。代替...

```
<property name="email" column="emailaddress" /> 
```

将其设置为...

```
<property name="Email" column="emailaddress" /> 
```

它有效。现在，这是 NHibernate 通过字段填充/读取我的属性的保证吗？但愿如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T07:04:04.940

这应该会有所帮助：将设置更改为不同的*get*和*set*

```
<hibernate-mapping ... default-access="field.camelcase"> 
```

并映射属性：

```
<property name="Email" column="emailaddress" /> 
```

NHibernate 将使用字段进行设置，使用属性进行获取。这个查询结束：

```
return tx.QueryOver<User>()    
  .Where(u => u.Email == emailAddress)  
  .SingleOrDefault(); 
```

...现在可以工作了

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T00:53:03.843

我相信映射中属性的“名称”应该与类中公共虚拟属性的大小写相匹配。尝试更改`<property name="email"...`为`<property name="Email"...`等等。

# asp.net - 为每个请求获取用户安全和信息 -> 否则数据会过时

> ID：13943909
> 
> 赞同：2
> 
> 时间：2012-12-19T00:47:57.907
> 
> 标签：asp.net, asp.net-mvc, asp.net-mvc-3, asp.net-web-api

我们目前实施的效果很好，但我只是担心可能有更好的方法，或者我们做错了。

登录到我们的网站后，***在每个请求***中，它都会向 API 发出请求以获取用户详细信息。

例如用户名、ImageUrl、角色/权限、电子邮件地址等

然后它将这些数据存储在 BaseController 中，以供视图页面或其他任何人在该请求期间查看。

**好处：**
这样做是因为您知道用户权限/角色及其详细信息都是最新的每个请求！

**缺点：**
您最有可能在每次请求时获得完全相同的数据，直到有一天他们更改了详细信息。因此，您可能会打不必要的电话？

然而，我们尝试所有这些的第一种方法是当用户登录时，他们的所有数据都存储在 cookie 中，问题是我们的用户几乎从不注销，因此存储在 cookie 中的所有数据经常变得陈旧。-> 陈旧的角色/权限是一个烦人的问题！！！

每个人如何从登录中绕过过时的数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T09:11:30.530

我会回到您最初将声明存储在 cookie 中的方法。

如果您确实有很长的登录时间，那么我会通过定期刷新 cookie 来防止停滞不前的声明。

如果您使用表单身份验证，那么您可以拦截`FormsAuthentication_OnAuthenticate`Global.asax 中的事件，解密和管理 cookie（[此处](https://stackoverflow.com/questions/3402909/change-the-user-data-in-formsauthenticationticket-programatically)），首先验证用户和 cookie，然后针对 userdata 属性中的自定义字段（称为 refreshedDate）运行快速条件检查。

如果最后刷新日期或创建日期大于某个可配置窗口，则调用数据库并从数据库刷新索赔数据。最后更新 refreshDate 并声明数据并更新 cookie。

**更新**

从您的评论开始...

只是说每个请求都访问数据库并不少见，也就是说我知道它发生在许多生产系统中。许多人可能正在使用 MS-SQL 数据库的[ASP.NET 会话状态。](http://msdn.microsoft.com/en-us/library/ms178581%28v=vs.100%29.aspx)通常，当确实需要使某人的会话无效，拒绝访问并立即将其注销时，我会看到它。

如果您的数据库位于 Web 服务器本地的网络上和/或延迟很低，那么它可能是一个完美可行的解决方案。只需确保您的数据库查询最小化并且性能调整到完美，考虑将任何 ORM（如果适用）并使用原始 SQL 连接来使事情尽可能快。

如果数据库延迟很高，则另一个中间解决方案是缓存，使用[Redis](http://redis.io/)或[Memcached](http://memcached.org/)来存放查询结果并在更改权限时使缓存失效等……但显然为缓存解决方案添加所需的基础架构和操作支持是一个认真的考虑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T13:27:49.903

除了其他建议之外，另一种选择可能是在用户数据更改时使用来自底层角色/权限存储的通知机制。然后，此通知可用于使 Web 服务器上的缓存数据无效。这将确保在大多数情况下返回缓存的数据，但只有在数据发生更改时才会访问存储。

如果底层数据存储是 SQL Serevr，那么考虑类似[`SqlDependency`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqldependency.aspx "SqlDependency").

这显然是一个更复杂的架构，但它会满足您的要求，只有您才能说它是否值得付出努力/复杂性/权衡！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T03:01:20.693

您可以对 cookie 应用过期时间；这样它就会死掉并要求他们登录。或者，将他们的用户 ID 保留在 cookie 中，但将他们的个人资料信息存储在会话中。当会话终止时，下次检查配置文件是否为空时，再次查询 API。这样，它会更频繁地更新。

# ssis - 在 SQL Server 代理作业中运行时，有没有办法找出当前在 SSIS 中运行的任务？

> ID：13943910
> 
> 赞同：3
> 
> 时间：2012-12-19T00:48:01.210
> 
> 标签：ssis

当我必须告诉我的老板需要多长时间才能完成当前的 SSIS 包时，我可以估算出该作业何时在 Visual Studio 环境中运行，但当它使用 SQL Server 代理运行时我完全失明了。

有什么方法可以找出某个时刻 SSIS 包在哪里，或者某个时刻当前正在运行哪个任务？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T09:39:06.467

如果您使用的是 SQL 2008 R2（或更早版本），则创建自己的日志表来记录您感兴趣的步骤非常有效。

SQL 2012 为您创建了一个日志框架，它将告诉您包括已完成的控制流步骤在内的大量信息。在 SSMS 中，在集成服务目录下查找并找到您的包。右键单击并在“报告”选项卡下查看以获取过去和当前 SSIS 执行的详细分类

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-12-22T06:26:41.017

SQL 2014 显示服务目录中正在运行的作业。

[![示例图片](../Images/845833a4652e1fe47de47b01095b6feb.png)](https://i.stack.imgur.com/yU23w.png)

# java - 加载图标资源错误

> ID：13943913
> 
> 赞同：2
> 
> 时间：2012-12-19T00:48:19.887
> 
> 标签：java, image, swing, embedded-resource, imageicon

在 Eclipse 中，当我运行代码时，这是有效的：

```
import javax.swing.ImageIcon;
import javax.swing.JFrame;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;

   public class Main {

    public static void main(String[] args) {

        JFrame frame = new JFrame("test viewing images");

        frame.setSize(600,300);     
        frame.setLocationRelativeTo(null); // centered on monitor   
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        /**
         * Menu Bar stuff
         */

        JMenuBar menuBar;
        JMenu menu;
        JMenuItem menuItem;

        // MENU BAR 
        menuBar = new JMenuBar();
        frame.setJMenuBar(menuBar);
        menuBar.setVisible(true);

        // MENU 1
        menu = new JMenu("File");
        menuBar.add(menu);

            // MENU 1 ITEM
            ImageIcon icon = new ImageIcon("src/Action-exit-icon.png");     
            menuItem = new JMenuItem("Exit Program", icon);
            menu.add(menuItem);

        frame.setVisible(true);

    }

   } 
```

这是我的包资源管理器中的文件结构：

```
ShowImage (project)
 > src / Main.java
 > src / Action-exit-icon.png 
```

此外，此工作区位于 Z:\eclipse_projects

我可以看到**ImageIcon icon = new ImageIcon("src/Action-exit-icon.png");** 运行良好，menuBar 可以正常工作。

现在让我们导出这个项目，我会将 JAR 通过电子邮件发送给我的朋友。

1.  右键单击项目 > 选择导出
2.  选择 Java > 可运行的 JAR 文件
3.  我在启动配置中选择主文件
4.  导出目的地：我的桌面
5.  库处理：将所需库提取到生成的 JAR 中
6.  转到我的桌面，双击 ShowImage.jar

JFrame 出现了，但**Action-exit-icon.png**根本没有出现。

当我打开 ShowImage.jar 来查看它的内容时，我看到了 Main.class、Action-exit-icon.png、META-INF。

好的，我现在对如何引用图像或任何资源感到非常困惑。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-19T00:50:38.573

```
new ImageIcon("src/Action-exit-icon.png"); 
```

an的`String`构造函数`ImageIcon`假定字符串表示`File`路径。

这个图像显然是一个应用程序资源，并且在部署时（在一个 Jar 中）将成为一个嵌入式资源。因此，必须`URL`从应用程序的运行时类路径访问它，如下所示：

```
new ImageIcon(getClass().getResource("/src/Action-exit-icon.png")); 
```

* * *

大修代码，我得到了这个：

```
import java.awt.Color;
import javax.swing.*;

public class JavaGui148 {

    public JComponent getGUI() {
        JPanel p = new JPanel();

        p.setBackground(Color.GREEN);

        return p;
    }

    public JMenuBar getMenuBar() {
        /**
         * Menu Bar stuff
         */
        JMenuBar menuBar;
        JMenu menu;
        JMenuItem menuItem;

        // MENU BAR 
        menuBar = new JMenuBar();
        menuBar.setVisible(true);

        // MENU 1
        menu = new JMenu("File");
        menuBar.add(menu);

        // MENU 1 ITEM
        ImageIcon icon = new ImageIcon(getClass().getResource(
                "/src/Action-exit-icon.png"));
        menuItem = new JMenuItem("Exit Program", icon);
        menu.add(menuItem);

        return menuBar;
    }

    public static void main(String[] args) {
        Runnable r = new Runnable() {

            @Override
            public void run() {
                JavaGui148 gui = new JavaGui148();

                JFrame f = new JFrame("Demo");
                f.setJMenuBar(gui.getMenuBar());
                f.add(gui.getGUI());
                // Ensures JVM closes after frame(s) closed and
                // all non-daemon threads are finished
                f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                // See http://stackoverflow.com/a/7143398/418556 for demo.
                f.setLocationByPlatform(true);

                // ensures the frame is the minimum size it needs to be
                // in order display the components within it
                f.pack();
                // should be done last, to avoid flickering, moving,
                // resizing artifacts.
                f.setVisible(true);
            }
        };
        // Swing GUIs should be created and updated on the EDT
        // http://docs.oracle.com/javase/tutorial/uiswing/concurrency/initial.html
        SwingUtilities.invokeLater(r);
    }
} 
```

# python - “列表对象不可调用”Python 错误

> ID：13943916
> 
> 赞同：3
> 
> 时间：2012-12-19T00:48:21.837
> 
> 标签：python, list, call

我正在开发一个 Python 图像库项目以获取乐趣。但是，我无法弄清楚为什么我不断收到此代码的“列表不可调用”错误：

```
def __computeTopColors(self):
    temp1, temp2, temp3, temp4 = [], [], [], []

    max = (0,0,0)
    for v in self.PixelVals: 
        if (v[0] > max[0]) and (v[1] > max[1]) and (v[2] > max[2]):
            max = v

    min = (1000,1000,1000)
    for v in self.PixelVals:
        if (v[0] < min[0]) and (v[1] < min[1]) and (v[2] < min[2]):
            min = v

    for pval in self.PixelVals:
        if (min[0] <= pval[0] <= int(((max[0])/2))) and (min[1] <= pval[1] <= int(((max[1])/2))):
            temp1.append(pval) 

    return temp1

def temp(self): 
    print self.temp 
```

注意：这实际上是一个课程的摘录，但我认为这不是特别相关。`self.PixelVals`是 (R,G,B) 形式的列表元组。self.temp 是我用来测试该方法的临时`__computeTopColors`方法；我设置 self.temp 等于`self.__computeTopColors`in `__init__`。

回溯：

```
Traceback (most recent call last):
  File "fiveColors.py", line 39, in <module>
    a.temp() 
```

第 39 行是我的代码块中的最后一行。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T00:50:19.743

你已经在`int`某个地方留下了一份清单。别那样做。并停止阴影`min()`，`max()`当你在它的时候。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T01:09:04.023

我将该代码粘贴到一个文件中，并添加以下内容：

```
>>> class Foo(object):
...    pass
>>> a = Foo()
>>> a.PixelVals = [(1,2,3),(4,5,6)]
>>> __computeTopColors(a)
[(1, 2, 3)] 
```

所以这段代码没有任何问题。

从头开始 - 存在*风格*问题，只是没有一个会破坏代码。例如：

*   你永远不应该给你的变量命名，就像`min`和`max`内置函数的名字一样。
*   不要放入大量额外的括号，除了使事情更难阅读之外没有任何功能 - <code>int(((max[1])/2)) 显然完全等同于`int(b[1]/2)`，但它需要几秒钟并且想一想看看你在做什么，甚至更长的时间来验证你做的是否正确（这总是一个问题，但尤其是当你要求其他人查看你的代码并猜测可能会发生什么时错了）。
*   您应该`PixelVals`使用小写而不是 CamelCase 等命名变量。

很明显，无论您的代码的其他部分有什么问题，您都没有向我们展示。

您添加了回溯的最后一行，并说它来自“我的代码块中的最后一行”。最后一行是这样的：

```
print self.temp 
```

该错误抱怨这一点：

```
a.temp() 
```

显然，您向我们展示的代码不是您正在运行的代码。但我可以从这个问题上猜测：

这`a`可能是一个类变量或全局变量，其中包含一个`list`. 您试图将其称为函数。因此，Python 非常明智地告诉您列表对象是不可调用的。

或者，这是另一个猜测：

> 我设置 self.temp 等于 self.__computeTopColors

好吧，这将`temp`用不同的变量替换方法。正如所写的那样，它实际上会`temp`用绑定的方法替换方法`__computeTopColors`，这不能解决您所看到的问题（尽管这是一件非常奇怪和糟糕的事情）。但也许这实际上不是真的，您实际上设置`self.temp`了 equal to `self.__computeTopColors()`—*调用*该绑定方法的结果。这可能是一个列表。因此，现在，您尚未向我们展示的其他一些代码尝试`temp`通过做来调用该方法`a.temp()`，并且因为您已将该`temp`方法替换为 a`list`而不是可调用的东西，所以会引发相同的错误。

实际上，即使您没有替换该`temp`方法，它也并不像定义的那样完全有用：

```
def temp(self): 
    print self.temp 
```

除了您的实现对绑定方法的表示`temp`（例如，`<bound method Foo.temp of <__main__.Foo object at 0x106d0f2d0>>`）之外，这无法打印任何内容，这对您没有任何用处。

无论是第一个问题、第二个问题，还是完全不同的问题，这都指向同一个更大的问题：不要给变量指定任意、无意义的名称——如果这样做，要非常小心，不要重复使用相同的名称在不同的地方有不同的意思。如果你很幸运，你会混淆 Python 并得到一个错误。如果你不走运，你只会让你自己和你的代码的其他读者感到困惑。

# sql - oracle函数动态列

> ID：13943917
> 
> 赞同：1
> 
> 时间：2012-12-19T00:48:36.797
> 
> 标签：sql, oracle, plsql

我有一个函数，我想在运行时确定列的名称。为此，我将一个变量作为参数传递，例如`column_name`.

下面是该函数的代码：

```
l_column_name as varchar2(100)

Begin 

If(column_name='emp_name')
  Then 
  l_column_name:=EMPLOYEE.EMP_NAME
End If;

   begin
 select l_column_name from employee
end; 
```

在上面的代码中，`l_column_name:=EMPLOYEE.EMP_NAME`给出了错误

> 在这种情况下不允许。

非常感谢任何帮助。

问候，柴图

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T04:08:47.357

正如错误所说，你不能这样做。

您需要考虑使用 PL/SQL 立即执行： http: [//docs.oracle.com/cd/B14117_01/appdev.101/b10807/13_elems017.htm](http://docs.oracle.com/cd/B14117_01/appdev.101/b10807/13_elems017.htm)

```
declare
  l_column_name as varchar2(100);
  l_column_results as VARCHAR2(100);
begin
  if (column_name = 'emp_name') then
     l_column_name := 'EMPLOYEE.EMP_NAME';
  end if;
  query := 'SELECT ' || l_column_name || ' from employeee';
  EXECUTE IMMEDIATE query INTO l_column_results;
end; 
```

# php - PHP POST 内容长度

> ID：13943918
> 
> 赞同：2
> 
> 时间：2012-12-19T00:48:40.013
> 
> 标签：php, file-upload

当我通过简单的形式上传文件时，我得到了

```
Warning: POST Content-Length of 372220927 bytes exceeds the limit of 33554432 bytes in Unknown on line 0 
Notice: Undefined index: file in C:\xampp\htdocs\php_upload\upload_file.php on line 3 
```

我将 php_ini 更改为 20M，我的问题是我想回显关于文件太大的好消息错误，没有这样的警告。我可以尝试/捕获的错误/执行。在打电话之前我可以在哪里找到有关“警告”的信息：

> $_FILES["文件"]["错误"]>0

```
<form action="upload_file.php" method="post"
<form action="upload_file.php" method="post"
enctype="multipart/form-data">
<label for="file">Filename:</label></br>
<input type="file" name="file" id="file"></br>
<input type="text" name="desc" id="desc"></br>
<input type="submit" name="submit" value="Submit">
</form> 
```

//

```
if ($_FILES["file"]["error"]>0)
  {
  echo "Error: " . $_FILES["file"]["error"] . "<br>";
  }
else
  {
  echo "Upload: " . $_FILES["file"]["name"] . "<br>";
  echo "Type: " . $_FILES["file"]["type"] . "<br>";
  echo "Size: " . ($_FILES["file"]["size"] / 1024) . " kB<br>";
  echo "Stored in: " . $_FILES["file"]["tmp_name"];
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:55:59.980

> 33554432 字节 = ~32MB
> 
> 372220927 字节 = ~355MB

您需要将[post_max_size](http://php.net/manual/en/ini.core.php#ini.post-max-size)和[upload_max_filesize](http://php.net/manual/en/ini.core.php#ini.upload-max-filesize)设置为至少 355MB 绝对最小值才能允许文件上传。

请按照此[示例](http://php.net/manual/en/features.file-upload.post-method.php#example-353)了解如何设置 PHP 文件上传表单，在其中设置 MAX_FILE_SIZE 以便在超出该限制时向用户返回错误。检查`$_FILES['userfile']['error']`它是否等于`UPLOAD_ERR_FORM_SIZE`指示文件大于允许的常量。**请注意示例中有关放置输入字段的顺序的警告**

# c# - xml c# 读写助手

> ID：13943919
> 
> 赞同：0
> 
> 时间：2012-12-19T00:48:48.043
> 
> 标签：c#, xml

我有以下示例，c# 只是我的草稿。你能告诉我如何调用 xml 文件并在那里读取，这样我就可以获得值

```
public static ArrayList GetLocationLiabilityAmount()
{
    ArrayList al = new ArrayList();
    string selectedValue = Library.MovieClass.generalLibailityLocationLiability;
    if (!String.IsNullOrEmpty(selectedValue))
    {
        if (option from xml ==  selectedValue)
        {
            al.Add(minvalue);
            al.Add(maxvalue);
        }
        return al;
    }
    else
    {
        return null;
    }
} 
```

XML:

```
<?xml version="1.0" encoding="utf-8" ?>
<AccidentMedicalCoverage>
  <coverage option="1" value="10000" showvalue="$10,000 per person"></coverage>
  <coverage option="2" value="25000" showvalue="$25,000 per person"></coverage>
  <coverage option="3" value="50000" showvalue="$50,000 per person"></coverage>
</AccidentMedicalCoverage> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-17T16:11:58.100

I prefer linq to Xml. There are two ways given to get the data into an XDocument shown below and then a basic query into the data

```
//var xml = File.ReadAllText(@"C:\data.xml");
    var xml = GetFile();

    //var xDoc = XDocument.Load(@"C:\data.xml"); Alternate
    var xDoc = XDocument.Parse(xml);

    var coverages = xDoc.Descendants("coverage");

    coverages.Select (cv => cv.Attribute("showvalue").Value)
             .ToList()
             .ForEach(showValue => Console.WriteLine (showValue));

/* Output
$10,000 per person
$25,000 per person
$50,000 per person
*/

...

public string GetFile()
{
return @"<?xml version=""1.0"" encoding=""utf-8"" ?>
<AccidentMedicalCoverage>
  <coverage option=""1"" value=""10000"" showvalue=""$10,000 per person""></coverage>
  <coverage option=""2"" value=""25000"" showvalue=""$25,000 per person""></coverage>
  <coverage option=""3"" value=""50000"" showvalue=""$50,000 per person""></coverage>
</AccidentMedicalCoverage>";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-17T16:00:59.297

这个问题不太清楚，但这是我假设你想要的：

如果`option`您想`value`从 XML 中获取，这是您可以做到的一种方法：

```
XmlDocument xDoc = new XmlDocument();
xDoc.Load("c:\\xmlfile\\coverage.xml");

// Select the node with option=1
XmlNode node = xDoc.SelectSingleNode("/AccidentMedicalCoverage/coverage[@option='1']");
// Read the value of the Attribute 'value'
var value = node.Attributes["value"].Value; 
```

# concatenation - writeln 中的连接？

> ID：13943927
> 
> 赞同：2
> 
> 时间：2012-12-19T00:49:48.860
> 
> 标签：concatenation, d

我是 D 的新手，我只是在尝试。我正在使用的一本书给了我一个通用二进制搜索方法的例子。然后我想制作自己的主要方法来打印结果只是为了好玩。我来自 Java，其中字符串连接只需使用 + 运算符完成。

但是当我在 D 中尝试时，它说这两种类型（在这种情况下为 String 和 bool）是不兼容的。正如我在 C++ 中看到的那样，我尝试使用 << 操作，但后来它告诉我它不是一个整体。那我该如何连接呢？

```
import std.stdio, std.array;

void main() {
    bool b = binarySearch([1, 3, 6, 7, 9, 15], 6);
    writeln("6 is in array: " + b);
    b = binarySearch([1, 3, 6, 7, 9, 15], 5);
    writeln("5 i sin the array: "  + b);

}

bool binarySearch(T)(T[] input, T value) {
    while(!input.empty) {
        auto i = input.length / 2;
        auto mid = input[i];
        if(mid > value) input = input[0 .. i];
        else if (mid < value) input = input[i + 1 .. $];
        else return true;
    }
    return false;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T00:54:20.537

writeln 最简单的方法是用逗号分隔它。

```
writeln("6 is in array: ", b); 
```

每个参数都会自动转换为字符串并输出。writeln 可以接受任意数量的参数。

不过，一般来说，D 中的字符串 concat 是使用`~`运算符完成的：`string a = b ~ c`; b 和 c 都必须是字符串类型。

要转换为字符串，您可以执行以下操作：

```
import std.conv;
int a = 10;
string s = to!string(a); // s == "10"
bool c = false;
string s2 = to!string(c); // s2 == "false" 
```

std.conv.to 也可以转换为其他类型，例如 to!int("12") == 12。

因此，`string s = to!string(a) ~ " cool " ~ to!string(c);`将在那里工作。

# javascript - '=' 运算符在这种情况下做了什么？sqrtf(1 - (t = t / d - 1) * t);

> ID：13943930
> 
> 赞同：0
> 
> 时间：2012-12-19T00:50:10.090
> 
> 标签：javascript, objective-c, actionscript, syntax

以下代码是缓动方程的一部分。我只是对语法感兴趣。

`sqrtf(1 - (t = t / d - 1) * t);`

我以前从未见过像这样使用'=' 运算符。在这种情况下它做了什么？

编辑：代码来自著名的 Robert Penner 缓动函数，用 ActionScript 编写：

```
static function easeOut (t:Number, b:Number, c:Number, d:Number):Number {
    return c * Math.sqrt(1 - (t=t/d-1)*t) + b;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T00:57:28.393

这里的`=`操作员做它一直做的事情。在这种情况下，它会修改`t`（将其设置为`t / d - 1`）。从等式的该部分返回的值将是 的新值`t`。

这变得令人困惑，因为`t`稍后会在等式中使用，而且我不确定每个编译器都会以相同的方式对待它。*即*第三个`t`将使用旧值还是新值？

我会避免以这种方式编写方程式。它很懒惰，我看不出有什么好的理由这样做。

# windows-phone-8 - WP8 主屏幕上的站点图标

> ID：13943931
> 
> 赞同：5
> 
> 时间：2012-12-19T00:50:11.790
> 
> 标签：windows-phone-8

iOS、Android 甚至黑莓都允许您指定一个图标，当您将页面添加到设备的主屏幕时显示该图标。现在 Windows 8 允许您指定当页面固定到开始屏幕时出现的图标，如下所示：

```
<meta name="msapplication-TileImage" content="logo144.png"/> 
```

但是，这似乎不适用于 Windows **Phone** 8。对吗？WP8 中是否有其他方法可以指定我的 Google 忍者技能未能发现的要使用的图标（而不是屏幕截图）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-01-21T11:26:55.447

对于 Windows Phone 8.1，您可以使用元标记指定图像、标题、磁贴颜色，甚至推送通知。对于名称使用

```
<meta name="application-name" content="NAME HERE" /> 
```

对于瓷砖颜色

```
<meta name="msapplication-TileColor" content=" #009900" /> 
```

所有四种瓷砖尺寸的徽标

```
<meta name="msapplication-square70x70logo" content="smalltile.png" />
<meta name="msapplication-square150x150logo" content="mediumtile.png" />
<meta name="msapplication-wide310x150logo" content="widetile.png" />
<meta name="msapplication-square310x310logo" content="largetile.png" /> 
```

轮询比较复杂，所以所有细节都[在这里](http://blogs.msdn.com/b/ie/archive/2014/05/21/support-a-live-tile-for-your-website-on-windows-and-windows-phone-8-1.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-11T22:24:12.373

不幸的是，当您单击“固定开始”时，Windows Phone 只会固定当前浏览器窗口的屏幕截图。有很多方法可以解决这个问题，我有一个示例，其中包含显示自定义图像并要求用户在显示图像时固定的**代码。**对于所有变通方法，这都有问题，因为用户必须触发图像*然后*使用浏览器的固定功能。但它运作良好。

链接到示例代码 [http://cdpn.io/jlEur](http://cdpn.io/jlEur)

如果我是你，在让这段代码生效之前，我至少会使用一个 cookie 来查看你是否已经用“pin”提示用户。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-26T18:01:40.430

根据网站[Webmonkey](http://www.webmonkey.com/2012/11/internet-explorer-10-for-mobile-html5/)：

“虽然适用于 Windows Phone 8 的 IE 10 与桌面/平板电脑版本的功能非常接近，但 Web 开发人员需要注意一些事项。这是微软 IE 10 可以在桌面上执行但***不能***在桌面上执行的完整列表电话：

Windows 8 集成功能：链接预览、**固定站点图标**和通知以及支持将站点连接到应用程序”

# html - iPhone 网络表单上一个/下一个跳过单选按钮 - 如何修复？

> ID：13943941
> 
> 赞同：2
> 
> 时间：2012-12-19T00:51:13.507
> 
> 标签：html, ios, tabindex

我有一个带有 html 表单（PHP 服务器端）的网站。当我使用 iPhone 上的上一个/下一个按钮浏览字段时，会跳过“广播组”。但是，文本字段、列表和按钮会被选中。是否可以使用上一个/下一个按钮启用一个单选组？

或者我应该将它从“广播组”更改为列表菜单之类的东西吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:12:46.287

您不能使用上一个和下一个按钮选择单选按钮。相反，您应该检测 iOS 用户代理并将单选按钮替换为自定义选择控件。（或者完全摆脱单选按钮。）

更多信息和代码示例可以在这里找到：http: [//developer.apple.com/library/safari/#documentation/appleapplications/reference/safariwebcontent/DesigningForms/DesigningForms.html#//apple_ref/doc/uid/TP40006512-SW1](http://developer.apple.com/library/safari/#documentation/appleapplications/reference/safariwebcontent/DesigningForms/DesigningForms.html#//apple_ref/doc/uid/TP40006512-SW1)

# c# - 将 BigInteger 变量写入 BitArray，反之亦然

> ID：13943942
> 
> 赞同：3
> 
> 时间：2012-12-19T00:51:19.407
> 
> 标签：c#, vb.net, biginteger, bitarray

我正在使用`BigInteger`来自`System.Numerics`.

例如：

```
Dim Mult17 As BigInteger = BigInteger.Parse("1453453452342347") 
```

问题：

1.  给定 a `BigInteger`，如何将其转换为 a `BitArray`？（显然，我希望`BitArray`保存二进制 10101... 表示存储在`BigInteger`变量中的数字，并且我希望可以选择以一种方式或相反的方式存储它。）

2.  我还需要从 a`BitArray`回到 a `BigInteger`。

请注意，没有符号问题：我只处理正整数。VB.NET 或 C# 示例会很好。谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T02:30:31.597

好吧，看起来您可以使用[.ToByteArray()](http://msdn.microsoft.com/en-us/library/system.numerics.biginteger.tobytearray.aspx)将 BigInteger 转换为 byte[] 。

幸运的是，BitArray 将 byte[] 作为[构造函数参数](http://msdn.microsoft.com/en-us/library/x1xda43a.aspx)。

要倒退，BitArray 到 byte[]，使用这个[扩展](http://geekswithblogs.net/dbrown/archive/2009/04/05/convert-a-bitarray-to-byte-in-c.aspx)，然后在构造函数中传入 BigInteger

看起来它应该工作。完全披露，我懒得测试这个。

# jquery - IE 中的 Youtube z-index 问题

> ID：13943943
> 
> 赞同：2
> 
> 时间：2012-12-19T00:51:24.207
> 
> 标签：jquery, css, iframe, youtube-api, z-index

我正在玩 youtube api，并在[http://jsfiddle.net/aaronk85/wapFR/中有以下代码](http://jsfiddle.net/aaronk85/wapFR/)

```
<div id="video-wrap2"></div>
<div id="video-wrap">
    <div id="play-video"></div>
</div>
<style>
#video-wrap2 {
    background-color: red;
    width: 666px;
    height: 666px;
    z-index: 1000;
    position: absolute;
}

#play-video {
    display: inline;
    float: left;
    height: 400px;
    width: 100%;
}

#video-wrap {
    float: left;
    display: inline;
    width: 610px;
    overflow: hidden;
    position: absolute;    
    z-index: 1;
}
</style>
<script>
$(document).ready(function() {
    $("#embed").replaceWith("<div id ='play-video'></div>");
    $.getJSON("https://gdata.youtube.com/feeds/api/playlists/UUJUAqHnkDX15IvFoXIGTm2A?alt=json-in-script&callback=?&max-results=1", function(data) {
        $.each(data.feed.entry, function(i, item) {
            var dataContainer = $("#play-video");
            var video = item.media$group.media$content[0].url;
            video = video.replace('https://www.youtube.com/v/','https://www.youtube.com/embed/');
            video = video.replace('version=3&f=playlists&app=youtube_gdata','wmode=opaque');
          $('#play-video').append("<iframe wmode='opaque' style='z-index:0;position:absolute;' width='610' height='400' src="+video+"' frameborder='0' name='vid-frame' id='vid-fade' allowfullscreen></iframe>");    
        });
    });
});
</script> 
```

我希望 video-wrap 2 出现在视频的顶部（我选择的随机播放列表）。在除 IE 之外的所有浏览器中，这似乎都有效。我在 IE 中缺少什么？我已经尝试过不透明/透明的组合，但我无法让它工作。我也发现了几个类似的问题，但是在尝试了这些问题之后我仍然遇到问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T03:21:03.043

[**jsFiddle 演示**](http://jsfiddle.net/wapFR/6/)

在 IE Web 浏览器中，`z-index`属性的堆栈顺序会为子元素重置，具体取决于网页布局。

但是，在您的 jsFiddle 中，您还使用`position:absolute`了除子元素以外的所有元素。

要修复，请添加`position: absolute;`到您的`#play-video`CSS 样式。

* * *

这个备用[**jsFiddle**](http://jsfiddle.net/wapFR/7/)不使用任何`z-index`属性，只使用`position:absolute`子元素的设置`#play-video`。

# jsf-2 - 嵌套在 ui:repeat 中的操作重新创建 viewscoped bean 而不是导航

> ID：13943945
> 
> 赞同：0
> 
> 时间：2012-12-19T00:51:31.037
> 
> 标签：jsf-2

我有 ah:form 和两个 p:commandButtons。一个按钮嵌套在组件内的 ui:repeat 内。ui:include 外部的按钮似乎可以正确导航到 action 方法返回的目标。然而，嵌套在 ui:include 和 ui:repeat 中的相同按钮似乎重新初始化了视图范围的 bean，而不是导航到操作目标。有没有人有解释和解决方案或解决方法？

代码大致是这样的。mybean 是视图范围的。

```
<h:form id="myform">
<p:commandButton value="DoIt" action="#{mybean.doit()}" ajax="true"/> <!-- this works! -->
<ui:include src="/sections/util/mycomp.xhtml">
 <ui:param name="backingbean" value="#{mybean}"/>
</ui:include>
</h:form> 
```

这是组件。

```
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                ...
                xmlns:p="http://primefaces.org/ui">
  <ui:repeat value="#{backingbean.mylit}" var="item" varStatus="status">
    <p:commandButton value="DoIt" action="#{backinbean.doit()}" ajax="true"/> <!-- this doesn't -->
  </ui:repeat>
</ui:composition> 
```

奇怪的是，如果我将嵌套的 p:commandButton 重新定位在 ui:component 内但在 ui:repeat 之外，那么它可以工作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T08:08:43.970

嗨，我复制了您的代码并试图重现该问题，但似乎我的工作正常。顺便说一句，如果您想使用该按钮进行导航，您可能应该将 ajax 设置为 false。以下是我的代码：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui">

    <h:head></h:head>
    <h:body>
        <h:form id="myform">
            <p:commandButton value="DoIt" action="#{backingBean.goToAnotherPage()}" ajax="true"/> <!-- this works! -->
            <ui:include src="firstpage.xhtml">
                <ui:param name="bb" value="#{backingBean}"/>
            </ui:include>
        </h:form>
    </h:body>
</html> 
```

这里是第二页 firstpage.xhtml：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui">

            <ui:repeat value="#{bb.myList}" var="item" varStatus="status">
                <p:commandButton value="DoItInRepeat" action="#{bb.goToAnotherPage()}" ajax="true"/> <!-- this doesn't -->
            </ui:repeat>
            <ui:debug hotkey="x" />

</ui:composition> 
```

最后是backing bean：

```
@ManagedBean
@ViewScoped
public class BackingBean {

    private List<String> myList = new ArrayList<String>();

    @PostConstruct
    public void init(){
        myList.add("1");
        myList.add("2");
        myList.add("3");
    }

    public String goToAnotherPage(){
        return "destpage.xhtml";
    }
    //Getters and Setters     
} 
```

# java - 使用 get 方法时获取 NaN

> ID：13943948
> 
> 赞同：-3
> 
> 时间：2012-12-19T00:51:35.007
> 
> 标签：java, methods, get, nan

我正在为我正在为课程作业制作的饮食编程制作 BMI 计算器。最初我将几个变量设为*public static*以从另一个类中获取变量。我的 BMI 计算器以这种方式运行良好。

然后我发现我可以使用*get 方法*（获得更多分数）。所以我把前面的变量改成了*私有*的，使用了*get方法*。但是当我运行这个程序时，当程序打印出保存 BMI 的变量时，我得到 NaN，这以前从未发生过！

任何人都可以帮忙吗？

```
import java.util.Scanner;

public class Weight {
private Scanner input;
private String readInput;
private String userWeightIsPounds;
private String userWeightIsStones;

private Scanner input2;
public static double userWeight;

public Weight(){
    userWeightIsPounds = ("Pounds");
    userWeightIsStones = ("Stones");        
}

public void findOutUserWeightMessage(){
    System.out.println("Firstly Do you weigh yourself in pounds or stones?");
}

public void findOutUserWeight(){
    input = new Scanner (System.in);
    readInput = input.nextLine();
    if(readInput.equals(userWeightIsPounds)){
        System.out.println("Ok then, enter your weight in pounds please.");
    }
    if(readInput.equals(userWeightIsStones)){
        System.out.println("Ok enter your weight in stones please.");
    }   

    input2 = new Scanner (System.in);
    userWeight = input2.nextFloat();
    if (userWeight > 20){
        System.out.println("You've enetered your weight as " + userWeight + " lbs. I'll save that information for later.");
    }else{
        userWeight = userWeight * 14;
        System.out.println("I've converted your weight into pounds for you. You weigh " + userWeight + " lbs. I'll save that information for later.");  
    }
}

public double static getUserWeight(){
    return userWeight;
}

} 
```

并且有代码来进行计算的类。忽略一些我试图找出我的变量发生了什么的println。

```
public class BMI {

private double userHeightSqaured;
private double bmiMutiplier;
private double weightDivideHeight;
private double userBmi;
private double userWeightBmi;
private double userHeightBmi;

BMI(){
    bmiMutiplier = 703;
    userWeightBmi = Weight.getUserWeight();
    userHeightBmi = Height.getUserHeight();
}

public void startUpBmiMessage(){
    System.out.print("Lets start with your BMI then shall we? ");
}

public void calculateUserBmi(){
    System.out.println("userWeightBmi is " + userWeightBmi);
    System.out.println("userWeightBmi is " + userHeightSqaured);

    userHeightSqaured = userHeightBmi * userHeightBmi;
    System.out.println("userHeightSqaured is " + userHeightSqaured);
    weightDivideHeight = userWeightBmi/userHeightSqaured;
    System.out.println("weightDivideHeight is " + weightDivideHeight);

    userBmi = weightDivideHeight * bmiMutiplier;
    System.out.println("weightDivideHeight is " + weightDivideHeight);
    System.out.println("bmiMutiplier is " + bmiMutiplier);

}   

public void calculateUserBmiMessage(){

    System.out.println("Your bmi is " + userBmi);

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T01:06:34.953

听起来您正在尝试编写一个执行某些计算的Java程序，而您的计算结果是`NaN`-您可以参考问题[在Java中，NaN是什么意思？](https://stackoverflow.com/questions/2618059/in-java-what-does-nan-mean)有关`NaN`.

至于在没有看到任何代码的情况下解决您的问题，并假设您的计算之前使用相同的输入运行良好，听起来您从`public static`变量切换到使用 getter 的私有变量可能会使您的一些变量未初始化，因此它们的值默认为 0 -除以 0 是 的常见原因`NaN`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T01:51:38.390

NaN 的原因是这个声明：

```
 weightDivideHeight = userWeightBmi/userHeightSqaured; 
```

零除以零。换句话说`userWeightBmi`，`userHeightSqaured`那时两者都为零。

根本问题似乎是您没有理解`static`实例变量和实例变量之间的区别。以及何时应该/不应该使用这两种变量。

# jquery - jQueryUi 选项卡，但使用不同的 URL

> ID：13943949
> 
> 赞同：0
> 
> 时间：2012-12-19T00:51:38.010
> 
> 标签：jquery, jquery-ui, tabs

我目前在我的价格比较/免费列表网站上使用 jQueryUI 选项卡，因为我真的很喜欢它们的外观，但是在诸如此类的类别页面上

[http://www.shopseekers.co.uk/category/546/1/womens-jewellery](http://www.shopseekers.co.uk/category/546/1/womens-jewellery)

我已经使用标签将常规零售价格比较列表与用户免费列表分开，但是我不想从两个标签加载所有内容，而是将内容分成 2 个 URL，这是因为将有第 1-40 页常规列表，然后第 1-40 页用于私人列表。

与其将私人列表的第 1 页与常规列表的每一页一起加载（这看起来像 Google 的重复内容），将 2 分开会容易得多。有谁知道如何在保持 SEO 友好的同时做到这一点（理想情况下不使用 JavaScript），我尝试将其更改`href="#tabs-2"`为所需的 URL，但它似乎只是将该 URL 加载到选项卡内的框架中。

对不起，如果我没有解释得太清楚，但希望你能明白我的意思。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T01:46:51.383

首先...您可能根本不应该使用标签。对于您想要完成的事情，使用您设计的链接看起来与您所拥有的相同会简单得多。你说你想要改变的一切本质上就是标签所做的一切。

话虽如此，一个可能的解决方案是设置一个单击函数，该函数将使用 history.PushState() 来更改 url，但应该注意的是，目前浏览器对它的支持有限。IE9-不支持它。根据您实现它的方式，如果正在使用的浏览器不支持此功能，它可能会相当优雅地失败。

有关使用 history.PushState() 的参考，请参阅：[https ://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history](https://developer.mozilla.org/en-US/docs/DOM/Manipulating_the_browser_history)

# android - 应用内计费不起作用：“未设置 IAB 助手”

> ID：13943950
> 
> 赞同：26
> 
> 时间：2012-12-19T00:51:40.833
> 
> 标签：android, in-app-purchase, google-play, in-app-billing

我尝试在我的应用程序中包含应用程序内计费，并且出于测试目的，基于应用程序内计费版本 3 的“TrivialDrive”示例的整个过程（并实施 IAB 文件的未修改版本，如在"util" 演示的子目录），但它对我不起作用 - 在 LogCat 上，就在应用程序因错误终止之前，它给出消息“应用内计费错误：*操作的非法状态（launchPurchaseFlow）：IAB未设置助手。* ”（在 startRegistered() 函数被触发并给我 LOG 消息“单击注册按钮；启动升级购买流程之后。”）...

知道这里出了什么问题吗？

以下是我的代码的相关部分：

```
package com.mytest;

(..)
import com.mytest.iab.IabHelper; // the originals from the demo example, unmodified
import com.mytest.iab.IabResult;
import com.mytest.iab.Inventory;
import com.mytest.iab.Purchase;

public class Result3 extends Activity implements OnClickListener {

private static final String TAG = "BillingService";

private Context mContext;

boolean mIsRegistered = false;

    // this has already been set up for my app at the publisher's console
static final String IS_REGISTERED = "myregistered";

static final int RC_REQUEST = 10001;

// The helper object
IabHelper mHelper; 

/** Call when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.result3);
    mContext = this;

    String base64EncodedPublicKey = "[my public key]"; // (from publisher's console for my app)

    // Create the helper, passing it our context and the public key to verify signatures with
    Log.d(TAG, "Creating IAB helper.");
    mHelper = new IabHelper(this, base64EncodedPublicKey);

    // enable debug logging (for a production application, you should set this to false).
    mHelper.enableDebugLogging(true);

    // Start setup. This is asynchronous and the specified listener
    // will be called once setup completes.
    Log.d(TAG, "Starting setup.");
    mHelper.startSetup(new IabHelper.OnIabSetupFinishedListener() {
        public void onIabSetupFinished(IabResult result) {
            Log.d(TAG, "Setup finished.");

            if (!result.isSuccess()) {
                complain("Problem setting up in-app billing: " + result);
                return;
            }

            // Hooray, IAB is fully set up. Now, let's get an inventory of stuff we own.
            Log.d(TAG, "Setup successful. Querying inventory.");
            mHelper.queryInventoryAsync(mGotInventoryListener);
        }
    });

   // Set the onClick listeners
   findViewById(R.id.btnPurchase).setOnClickListener(this);
}

// Listener that's called when we finish querying the items we own
IabHelper.QueryInventoryFinishedListener mGotInventoryListener = new IabHelper.QueryInventoryFinishedListener() {
    public void onQueryInventoryFinished(IabResult result, Inventory inventory) {
        Log.d(TAG, "Query inventory finished.");
        if (result.isFailure()) {
            complain("Failed to query inventory: " + result);
            return;
        }

        Log.d(TAG, "Query inventory was successful.");

        // Do we have the premium upgrade?
        mIsRegistered = inventory.hasPurchase(IS_REGISTERED);
        Log.d(TAG, "User is " + (mIsRegistered ? "REGISTERED" : "NOT REGISTERED"));

        setWaitScreen(false);
        Log.d(TAG, "Initial inventory query finished; enabling main UI.");
    }
};      

// User clicked the "Register" button.
private void startRegistered() {
    Log.d(TAG, "Register button clicked; launching purchase flow for upgrade.");
    setWaitScreen(true);
    mHelper.launchPurchaseFlow(this, IS_REGISTERED, RC_REQUEST, mPurchaseFinishedListener);
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    Log.d(TAG, "onActivityResult(" + requestCode + "," + resultCode + "," + data);

    // Pass on the activity result to the helper for handling
    if (!mHelper.handleActivityResult(requestCode, resultCode, data)) {
        // not handled, so handle it ourselves (here's where you'd
        // perform any handling of activity results not related to in-app billing..
        super.onActivityResult(requestCode, resultCode, data);
    }
    else {
        Log.d(TAG, "onActivityResult handled by IABUtil.");
    }
}

// Callback for when a purchase is finished
IabHelper.OnIabPurchaseFinishedListener mPurchaseFinishedListener = new IabHelper.OnIabPurchaseFinishedListener() {
    public void onIabPurchaseFinished(IabResult result, Purchase purchase) {
        Log.d(TAG, "Purchase finished: " + result + ", purchase: " + purchase);
        if (result.isFailure()) {
            // Oh noes!
            complain("Error purchasing: " + result);
            setWaitScreen(false);
            return;
        }

        Log.d(TAG, "Purchase successful.");

        if (purchase.getSku().equals(IS_REGISTERED)) {
            Log.d(TAG, "User has registered..");
            alert("Thank you.");
            mIsRegistered = true;
            setWaitScreen(false);
        }
    }
};

// We're being destroyed. It's important to dispose of the helper here!
@Override
public void onDestroy() {
    // very important:
    Log.d(TAG, "Destroying helper.");
    if (mHelper != null) mHelper.dispose();
    mHelper = null;
}

void complain(String message) {
    Log.e(TAG, "**** Register Error: " + message);
    alert("Error: " + message);
}

void setWaitScreen(boolean set) {
    // just a dummy for now
}

void alert(String message) {
    AlertDialog.Builder bld = new AlertDialog.Builder(this);
    bld.setMessage(message);
    bld.setNeutralButton("OK", null);
    Log.d(TAG, "Showing alert dialog: " + message);
    bld.create().show();
}

@Override
public void onClick(View v) {
    switch (v.getId()) {
    case R.id.btnPurchase:
        startRegistered();
        break;
    default:
        break;
    }
} 
```

}

这里有更多来自 Logcat 的行：

```
12-20 01:06:36.701: D/dalvikvm(299): GC_FOR_MALLOC freed 4262 objects / 308592 bytes in 84ms
12-20 01:06:36.701: D/webviewglue(299): nativeDestroy view: 0x2ea718
12-20 01:06:36.771: W/webcore(299): Can't get the viewWidth after the first layout
12-20 01:07:07.111: W/webcore(299): Can't get the viewWidth after the first layout
12-20 01:07:18.510: D/webviewglue(299): nativeDestroy view: 0x2dd458
12-20 01:07:18.510: D/dalvikvm(299): GC_FOR_MALLOC freed 6042 objects / 544504 bytes in 50ms
12-20 01:07:18.530: D/webviewglue(299): nativeDestroy view: 0x2ea8d0
12-20 01:07:18.660: D/BillingService(299): Creating IAB helper.
12-20 01:07:18.660: D/BillingService(299): Starting setup.
12-20 01:07:18.660: D/IabHelper(299): Starting in-app billing setup.
12-20 01:07:19.621: W/webcore(299): Can't get the viewWidth after the first layout
12-20 01:07:20.160: W/webcore(299): Can't get the viewWidth after the first layout
12-20 01:07:32.481: D/webviewglue(299): nativeDestroy view: 0x3f88e8
12-20 01:07:32.491: D/dalvikvm(299): GC_FOR_MALLOC freed 5798 objects / 513640 bytes in 50ms
12-20 01:07:32.511: D/BillingService(299): Register button clicked; launching purchase flow for upgrade.    
12-20 01:07:32.511: E/IabHelper(299): In-app billing error: Illegal state for operation (launchPurchaseFlow): IAB helper is not set up.
12-20 01:07:32.521: D/AndroidRuntime(299): Shutting down VM
12-20 01:07:32.521: W/dalvikvm(299): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
12-20 01:07:32.541: E/AndroidRuntime(299): FATAL EXCEPTION: main
12-20 01:07:32.541: E/AndroidRuntime(299): java.lang.IllegalStateException: IAB helper is not set up. Can't perform operation: launchPurchaseFlow
12-20 01:07:32.541: E/AndroidRuntime(299):  at com.test_ed.iab.IabHelper.checkSetupDone(IabHelper.java:673)
12-20 01:07:32.541: E/AndroidRuntime(299):  at com.test_ed.iab.IabHelper.launchPurchaseFlow(IabHelper.java:315)
12-20 01:07:32.541: E/AndroidRuntime(299):  at com.test_ed.iab.IabHelper.launchPurchaseFlow(IabHelper.java:294)
12-20 01:07:32.541: E/AndroidRuntime(299):  at com.test_ed.Result3.startRegistered(Result3.java:157)
12-20 01:07:32.541: E/AndroidRuntime(299):  at com.test_ed.Result3.onClick(Result3.java:248)
12-20 01:07:32.541: E/AndroidRuntime(299):  at android.view.View.performClick(View.java:2408)
12-20 01:07:32.541: E/AndroidRuntime(299):  at android.view.View$PerformClick.run(View.java:8816)
12-20 01:07:32.541: E/AndroidRuntime(299):  at android.os.Handler.handleCallback(Handler.java:587)
12-20 01:07:32.541: E/AndroidRuntime(299):  at android.os.Handler.dispatchMessage(Handler.java:92)
12-20 01:07:32.541: E/AndroidRuntime(299):  at android.os.Looper.loop(Looper.java:123)
12-20 01:07:32.541: E/AndroidRuntime(299):  at android.app.ActivityThread.main(ActivityThread.java:4627)
12-20 01:07:32.541: E/AndroidRuntime(299):  at java.lang.reflect.Method.invokeNative(Native Method)
12-20 01:07:32.541: E/AndroidRuntime(299):  at java.lang.reflect.Method.invoke(Method.java:521)
12-20 01:07:32.541: E/AndroidRuntime(299):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-20 01:07:32.541: E/AndroidRuntime(299):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-20 01:07:32.541: E/AndroidRuntime(299):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-04-01T21:40:48.057

*根本*问题是 startRegistered() 是在直接响应 UI 用户点击时被调用的，而 IabHelper 对象的设置是异步触发的，因此在通过 onIabSetupFinished() 接收到异步响应之前无法知道它已经完成。

您的 startRegistered() 方法由用户点击触发，并调用 launchPurchaseFlow()，这反过来要求 IabHelper 对象已经完成设置，但如果用户在收到确认之前点击触发购买（因为设置失败或因为用户在抽奖时异常快速），那么设置将不会完成，并且 launchPurchaseFlow() 将报告您看到的错误。对于您的 logcat，延迟为 14 秒，这通常是足够的时间，但是......在这种情况下可能不是。或者，也许出了点问题，无论您等待多长时间，您都永远无法连接。

在您的 logcat 中，没有指示“计费服务已连接”的消息，如果要完成设置，这是必须发生的第一件事。由于这不会发生，您也不会看到来自 onIabSetupFinished() 的任何消息（成功或失败）。

由于需要异步响应，这很棘手。一种方法是禁用用于触发购买的按钮，直到您的 onIabSetupFinished() 成功返回。这将阻止触发购买，直到 IabHelper 对象已成功设置。当然，如果设置失败，您将拥有一个不起作用的按钮，但至少您可以告诉用户发生了什么事（通过发出一条消息表明您正在等待设置完成 - 例如，作为按钮文本）。

即使这样，一旦您的购买开始并且付款对话框出现在用户面前，您的应用程序可能会经历一个 onStop() 循环，在用户考虑购买时从内存中刷新您的应用程序（因为购买对话框是其中的一部分） Google Play 的一部分，而不是您的应用程序的一部分，并且操作系统可能需要内存来运行它，并且可以通过停止您的应用程序来获得该内存）。这将破坏您的 IabHelper() 对象，然后必须*再次*创建并异步设置该对象。再一次，由于在您的 onCreate() 方法中异步触发，onActivityResult() 可能会被 Google Play 服务调用以在 IabHelper 对象的设置完成*之前*报告用户的购买操作，并且由于在 onActivityResult() 中您将需要到*使用*您的 IabHelper 实例，这可能会导致错误。看来你必须为任何事情做好准备。

这应该给你你正在处理的东西的味道。由于这些原因，IAB 很困难 - 异步内容的多个线程（例如，设置与购买与 Android 操作系统操作阻止您的应用程序获取内存以供您的应用程序使用的 Google Play 应用程序购买操作使用）正在等待获取购买结果）。很多实现的东西（包括通过 TrivialDrive 示例）都是不稳定的，因为它隐含地依赖于你的应用程序留在内存中，而实际上它可能会被回收，或者因为它依赖于竞争条件的一个分支（例如设置）在之前完成另一条腿（例如，购买启动）确实如此，依此类推。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2012-12-20T22:19:44.350

执行 purchaseFlow 功能时遇到同样的问题。看一下 Google 示例中的 Activity 类，特别是方法`protected void onActivityResult(int requestCode, int resultCode, Intent data)`。你可能忘了实现这个。此功能对于整个机制正常工作至关重要。

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    Log.i(TAG, "onActivityResult(" + requestCode + "," + resultCode + "," + data);

    // Pass on the activity result to the helper for handling
    if (!inappBillingHelper.handleActivityResult(requestCode, resultCode, data)) {
        super.onActivityResult(requestCode, resultCode, data);
    }
    else {
        Log.i(TAG, "onActivityResult handled by IABUtil.");
    }
} 
```

编辑：此外，当您在手机上与您的 gmail 帐户关联的密码错误时也存在问题（今天发生在我身上）。当然，所有的 Inapp 计费功能都应该在手机上进行测试，但我认为这是显而易见的。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-12T11:22:45.650

我刚刚解决了完全相同的问题。IabHelper-Setup 启动，但在那之后，什么也没有发生。单击应用内购买会返回与您遇到的完全相同的错误。

这就是我的发现：我只使用了 eclipse 中的模拟器。当我读到需要某个 Google Play 版本时，我注意到我的测试仿真驱动器上完全没有 Google Play。

然后，当我使用真正的手机时，它可以完美运行！因此，如果您碰巧仍然遇到该问题，请尝试使用真实设备（如果您有可用的设备）。这应该够了吧。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-02-12T22:32:34.923

我遇到的另一件事；虽然您的设备上可能有支持最新版本的应用内计费的最新版本的 google play，但其他用户可能没有。虽然理论上由此引起的崩溃应该出现在开发人员控制台中，但在我实施 firebase 之前我看不到这些崩溃......然后我看到了很多。我最终做的是使用 try catch 并将没有最新版本的 google play 或在 google play 商店遇到问题的用户链接到此页面[https://support.google.com/googleplay/answer /1050566?hl=zh-CN](https://support.google.com/googleplay/answer/1050566?hl=en)

```
try {
        mHelper.launchPurchaseFlow(this, SKU_PRO_LT, RC_REQUEST,
                mPurchaseFinishedListener, payload);
    } catch (Exception e) { //with IabHelper.IabAsyncInProgressException the code still fatally crashes for some reason
        //complain("Error launching purchase flow. Another async operation in progress.");
        alert2("[error msg]");
        setWaitScreen(false);
    } 
```

alert2 只是一个对话框，其中包含指向上述网页的链接。

但首先我建议在一些朋友的手机上进行应用购买测试，以确保这是游戏商店更新问题而不是代码问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-02-24T23:54:52.913

如果您安装了幸运的补丁程序并且修改了 playstore，您将收到消息“iab helper is not setup”。解决方案：在您的 PC 或幸运补丁程序上安装 android 模拟器，修改后的 playstore 将不会安装。您将不再收到错误消息，并且可以付款，它对我来说非常完美 :)

# javascript-events - 避免在主干事件处理程序中使用 event.preventDefault() 样板

> ID：13943952
> 
> 赞同：10
> 
> 时间：2012-12-19T00:52:17.227
> 
> 标签：javascript-events, backbone.js

我有很多以链接开头的 Backbone.js 操作，例如

```
<a href="#makeCookies">Make Cookies</a> 
```

和 Backbone.View 事件哈希，如

```
'click [href=#makeCookies]': 'makeCookies' 
```

和一个事件处理函数，比如

```
makeCookies: function (event) {
    event.preventDefault();
    //code to make cookies
    //I have no intention of ever using #makeCookies in the URL,
    //it's just there so I can wire up the event handler properly
} 
```

有没有一种干净的方法可以避免该样板`event.preventDefault()`。我想过只使用`<button>`标签而不是`<a>`标签，但这似乎不合适。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T20:06:15.930

如果您打算丢弃它，为什么还需要具有 href 属性？只使用类名怎么样？

HTML 代码：

```
<a class="makeCookies">Make Cookies</a> 
```

查看代码：

```
'click .makeCookies': 'makeCookies'
...
makeCookies: function (event) {
    // No need for event.preventDefault() anymore!
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-19T02:16:04.393

您可以将 prevent-default 处理程序添加到文档元素。像这样：

```
$(document).click(function (e) {
    if (e.target.tagName === "A") {
        e.preventDefault();
    }  
}) 
```

这当然会禁用所有由 a-tags 启动的导航，但如果您的应用程序为此提供了自定义处理，那么它应该不是问题。

如果您想让一些 a-tags '通过'，那么您可以在 prevent-default 处理程序中添加更多条件，例如检查 href 属性的值是否以 '#' 开头。

# java - Java 快速数组错误

> ID：13943956
> 
> 赞同：0
> 
> 时间：2012-12-19T00:52:23.977
> 
> 标签：java

我在使用简单的代码时遇到了一些麻烦。它应该是一个程序，人们可以在其中添加存储在数组中的笔记。我知道这段代码很长，但希望有人能帮助我。

```
public class NoteOrganizer {

    int action = 0;
    public static Note[] myArray;

    public static void addNotes(int num)
    {
        String note;
        String date;

        for(int z = 0; z <= num; z++)
        {
            Scanner getLi = new Scanner(System.in);
            System.out.println("Please enter a note (max 140 characters): \n");
            note = getLi.nextLine();

            System.out.println("Please enter a date:\n");
            date = getLi.nextLine();

            Note test = new Note();
            test.id = z;
            test.myNote = note;
            test.date = date;
            myArray[z] = test;  // THE ERROR IS IN THIS LINE, NOT THE LINE MENTIONED BEFORE

        }
    }

    public static void main(String[] args)
        {
        int action = 0;

        int y = 0;

        Scanner getLi = new Scanner(System.in);
        System.out.println("Please press 1 to add notes, 2 to delete notes or 3 to view "
                + "all notes:\n");
        action = getLi.nextInt();

        if(action == 1)
        {

            System.out.println("How many notes would you like to add: \n");
            int d = getLi.nextInt();
            //myArray = new Note[d];
            addNotes(d);
            //System.out.println(myArray[0].print());

        }
        else if(action == 3)
        {
            System.out.println(Arrays.toString(myArray));
        }

    }
} 
```

我得到的错误是

```
Exception in thread "main" java.lang.NullPointerException
    at note.organizer.NoteOrganizer.addNotes(NoteOrganizer.java:46)
    at note.organizer.NoteOrganizer.main(NoteOrganizer.java:95)
Java Result: 1 
```

我评论了错误在哪一行。

任何帮助是极大的赞赏。

谢谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T00:54:55.793

你还没有初始化你的 Note 数组。您似乎出于某种原因注释掉了该行：

```
//myArray = new Note[d]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T00:54:33.207

```
 public static Note[] myArray;

 myArray[z] = test; 
```

您没有初始化数组，所以它仍然为空。

一旦你知道你需要的长度（似乎是`num`），你可以做

```
myArray = new Note[num]; 
```

在使用数组之前。

（看起来你已经有了这样的代码，但由于某种原因它被注释掉了）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T00:55:05.447

你从来没有设置`myArray`任何东西，所以你不能写进去。

您正在尝试通过写入来自动扩展数组，但这在 Java 中不起作用。但是， an[`ArrayList`](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html)确实支持最后写入（但不支持进一步写入），并根据需要重新分配其内部数组：

```
ArrayList<Note> myList = new ArrayList<Note>(); 
```

然后，而不是

```
myArray[z] = test; 
```

利用

```
myList.add(test); 
```

（无论它在哪里，它都会自动附加到 的末尾`List`）

然后从列表中读取为

```
myList.get(index) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T01:05:15.410

你需要初始化你的数组，我建议使用类 ArrayList，就像一个动态数组。

```
myArray = new Note[length]; 
```

# iphone - 外接设备报告无协议

> ID：13943960
> 
> 赞同：2
> 
> 时间：2012-12-19T00:52:39.147
> 
> 标签：iphone, external-accessory

我有一个我一直在开发的应用程序，现在我想通过扩展坞连接器集成一些与外部设备的交互。我使用的设备（iDive 300）符合 Made For iPod 程序。我已经基于 EADemo 代码编写了一个单独的简单应用程序来收集有关设备的信息。然而，当我运行这个应用程序时，iDive 没有报告名称、序列号、固件等，并且还说没有找到任何协议。我知道这个简单的应用程序工作正常，因为我已连接到其他几个外部设备，并且为每个设备填充了名称、序列号等。

另一件奇怪的事情是，当 iDive 插入我的 iPhone 4 时，它似乎可以正常工作（即，它会增加音量并通过设备上的按钮播放在我的 iPhone 上找到的歌曲和视频）。这不应该意味着这个设备与 iPhone 通信有一些协议吗？如果我不知道协议，我是否可以从此设备读取数据（例如，在按下“播放”、“菜单”或其他按钮时捕获）？

我对外部附件框架完全陌生，感谢您提供任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-04T18:22:12.610

无法保证配件实际使用 EA。它可以使用 Apple 定义的协议进行通信。

仅当您想使用自己的专有协议进行通信时才需要 EA。

检查来自 Apple 的 EADemo 示例...如果它没有出现在演示应用程序中，则它不是 EA。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-27T13:02:57.950

您应该对与 iDive 关联的应用程序进行尸检。在其 info.plist 中，应该有一个键：

```
UISupportedExternalAccessoryProtocols 
```

它的值是一个数组（[见这里的正式定义](http://developer.apple.com/library/ios/documentation/general/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW4)），其中包含一个字符串，其值看起来像一个反转的域名，作为设备协议。

你应该编辑你的 Info.plist，`'Supported external accessory protocols'`为一个数组添加键（用简单的英语），把协议作为它的项目。

# spring - 使用 Spring 工具套件创建新的 maven 项目时出错（无法解析原型）

> ID：13943963
> 
> 赞同：2
> 
> 时间：2012-12-19T00:53:10.427
> 
> 标签：spring, maven

我正在尝试使用spring工具套件版本（3.1.0）创建一个新的maven项目，但是每次我尝试选择任何原型并在向导中填写组ID和工件ID后，它开始下载几分钟然后我得到以下错误：

错误详细信息“**无法从任何配置的存储库中解析原型 org.appfuse.archetypes:appfuse-modular-spring:RELEASE。无法解析工件 org.appfuse.archetypes:appfuse-modular-spring:jar:RELEASE 缺少 org.appfuse .archetypes:appfuse-modular-spring:jar:RELEASE** "

注意：当我尝试使用前一天安装​​的 Eclipse Juno 以及 maven2eclipse 插件创建一个新的 maven 项目时，我也发生了同样的错误。看起来我的 maven 存储库或配置有问题！

我机器上安装的软件是：

*   64 位弹簧工具套件 (v 3.1.0)
*   64 位操作系统（Windows 7）
*   64 位 JDK 7
*   Maven 存储库位置：C:\Users\Ahmed Mamdouh.m2\repository

任何帮助将不胜感激。

提前致谢。

# matlab - MATLAB - 创建滞后时间步长向量的矩阵（类似于填充？）

> ID：13943964
> 
> 赞同：4
> 
> 时间：2012-12-19T00:53:16.317
> 
> 标签：matlab, padding, forecasting

我有一个代表水文时间序列的 429x1 向量。我希望将时间序列“滞后”一个时间步，并将其转换为矩阵，以便输入到 nftool 进行一些 ANN 分析。矩阵的宽度由输入层中输入神经元的数量控制，这是我从电子表格中读取的值。这就是我想用更短的时间序列来说明这个例子：

```
 inp_neur = 5; % amount of input neurons (read in from excel)
A = [9;6;8;3;2]; % hypothetical hydrological time series

% do pad zero process 
```

结果：

> 新A =

```
 9     0     0     0     0
 6     9     0     0     0
 8     6     9     0     0
 3     8     6     9     0
 2     3     8     6     9 
```

我敢肯定这不是最难做的事情，但它可以在一个班轮中完成吗？

任何帮助将不胜感激。

干杯，

江青

```
Another example with inp_neur = 7;

A = [11;35;63;21;45;26;29;84;51] 
```

新A =

```
11  0   0   0   0   0   0
35  11  0   0   0   0   0
63  35  11  0   0   0   0
21  63  35  11  0   0   0
45  21  63  35  11  0   0
26  45  21  63  35  11  0
29  26  45  21  63  35  11
84  29  26  45  21  63  35
51  84  29  26  45  21  63 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-19T04:35:20.640

我知道这个问题已经被标记为已接受，但是，我认为值得指出的是，如果（时间序列中的观察数）远大于（滞后数，则当前接受的答案将**非常**低效，即在OP的符号中）。这是因为它创建了一个by矩阵，然后将其截断为by 。`T``K``inp_neur``T``T``T``K`

我会提出两种可能的替代方案。第一个使用计量经济学工具箱中的一个功能，旨在完全满足 OP 的需求：`lagmatrix`. 第二个是基于循环的解决方案。

该`lagmatrix`解决方案返回`NaN`OP 想要的位置`0`，因此需要额外的一行来转换它们。完整的解决方案是：

```
newA2 = lagmatrix(A, 0:K-1);
newA2(isnan(newA2)) = 0; 
```

基于循环的解决方案是：

```
newA3 = zeros(T, K);
for k = 1:K
    newA3(k:end, k) = A(1:end-k+1);
end 
```

基于循环的解决方案的明显优势是它不需要计量经济学工具箱。但这是唯一的优势吗？让我们尝试一些定时运行。设置`T = K = 10`。然后：

```
Elapsed time is 0.045809 seconds. %# 3lectrologos solution
Elapsed time is 0.049845 seconds. %# lagmatrix solution
Elapsed time is 0.017340 seconds. %# loop solution 
```

3lectrologos解决方案与`lagmatrix`解决方案基本相同。基于循环的解决方案快 3 倍！现在，为了强调 3lectrologos 解决方案的问题，设置`T = 1000`和`K = 10`。然后：

```
Elapsed time is 10.615298 seconds.
Elapsed time is 0.149164 seconds.
Elapsed time is 0.056074 seconds. 
```

现在 3lectrologos 解决方案比`lagmatrix`解决方案慢两个数量级。但当天真正的赢家是基于循环的解决方案，它仍然设法比`lagmatrix`解决方案快 3 倍。

**结论：**不要再忽略 Matlab 中的单循环了。他们变得非常快！

对于那些感兴趣的人，定时运行的代码如下：

```
M = 1000; %# Number of iterations for timed test
T = 1000; %# Length of your vector of inputs
K = 10; %# Equivalent to your inp_neur
A = randi(20, T, 1); %# Generate random data

%# 3lectrologos solution (inefficient if T is large relative to K)
tic
for m = 1:M
    tmp = tril(toeplitz(A));
    newA1 = tmp(:, 1:K);
end
toc

%# lagmatrix solution
tic
for m = 1:M
    newA2 = lagmatrix(A, 0:K-1);
    newA2(isnan(newA2)) = 0;
end
toc

%# Loop based solution
tic
for m = 1:M
    newA3 = zeros(T, K);
    for k = 1:K
        newA3(k:end, k) = A(1:end-k+1);
    end
end
toc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-19T01:00:07.887

这是两个班轮：

```
tmp = tril(toeplitz(A));
newA = tmp(:, 1:inp_neur); 
```

# php - PHP file_exists() 函数在 /usr/bin/mysql 上返回 false

> ID：13943967
> 
> 赞同：10
> 
> 时间：2012-12-19T00:53:26.090
> 
> 标签：php, permissions

我已经阅读了很多关于这个问题的帖子，但没有一个完全符合我的问题。我在 GoDaddy 虚拟主机上有一个 WordPress 网站（目前是 3.5）。11 月，我选择将 O/S 从 CentOS 5 升级到 CentOS 6.3，这涉及到完整的 O/S 重新安装，对此我无法控制，也没有任何信息。在重新安装 O/S 之后，我从开始前的备份中重建了站点。

重建后，我们使用多年的 WordPress 插件 WP-DBManager 突然停止备份我们的 mysql 数据库。备份失败，因为备份面板声称“MYSQL 路径不存在”。烦人的是，当您进入 DB Options 页面并告诉它自动检测 mysql 路径时，选项页面会生成 /usr/bin/mysql，这是正确的。我可以使用 SSH 登录该站点，它就在那里。权限是：

```
-rwxr-xr-x 1 root root 338184 Jun 22 05:58 /usr/bin/mysql 
```

这应该有效。我的网站权限中的某些内容随着这次重建而改变，我不知道是什么；到目前为止，我只记录了 WordPress 配置。我所做的研究表明这可能与 PHP 安全模式有关。我们运行 PHP 5.3.3，并且 phpinfo() 的配置列表不显示

```
--enable-safe-mode 
```

这意味着安全模式应该关闭。启动时 php.ini 中的安全模式设置为：

```
safe_mode_allowed_env_vars = PHP_
safe_mode_protected_env_vars = LD_LIBRARY_PATH
safe_mode_exec_dir = 
safe_mode_include_dir = 
safe_mode = off
safe_mode_gid = off 
```

此后，我将 safe_mode_gid 更改为 ON，但没有任何效果。我有一个从生产站点构建的测试站点，其中 safe_mode_include_dir = ~ 所以我尝试了，但没有效果。测试站点运行 PHP 5.3.14，除了 safe_mode_include_dir 之外，上面的安全模式设置相同。我检查了 ENV 变量，并且 /usr/bin 包含在 PATH 中：

PATH=/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/home/lrservice/bin

我不知道这是否是环境变量问题，这里是安全模式条目：

```
safe_mode_allowed_env_vars = PHP_
safe_mode_protected_env_vars = LD_LIBRARY_PATH 
```

这些设置在工作测试站点上并不完全相同，其中之一是：

```
safe_mode_allowed_env_vars = PHP_ LANG LANG_ 
```

由于该站点除此之外功能齐全，因此我知道mysql的权限通常是正确的。这会为任何人敲响警钟吗？如果安全模式被正式关闭，为什么我会得到这一切？我有一种感觉，我错过了一些明显而愚蠢的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:49:15.027

您可以从目录中的会话访问`mysql`二进制文件，但无法在同一位置找到它。我假设您的系统正在使用*apache2*网络服务器。`ssh``/usr/bin``php`

 *该`ChrootDir`指令是否存在于 apache 配置文件中（通常位于`/etc/httpd/conf/httpd.conf`）？

如果是这种情况，您可以检查该指令指向的目录是否有指向 mysql 二进制文件的链接。如果没有，只需在 ssh 会话中执行以下命令（假设您有这样做的权限）来添加它：

```
$ ln /usr/bin/mysql /chroot/path/usr/bin/mysql 
```

替换`/chroot/path`为`ChrootDir`指令路径。

* * *

其中一条评论提到了`open_basedir` [PHP 设置](http://php.net/manual/en/ini.core.php#ini.open-basedir)，可以在*php.ini*、*httpd.conf*或*.htaccess*文件中进行配置。

此设置限制对 PHP 可用的文件系统的某些目录的访问。如果该设置不受保护，则可能的解决方法是删除您正在使用的插件执行的脚本的此限制：

*   在您的 wordpress 目录中找到插件安装的脚本，
*   使用以下命令在包含脚本的目录中创建一个 .htaccess 文件以解除限制：

    $ echo 'php_value open_basedir none' >> .htaccess

以上将在 .htaccess 文件末尾的简单引号之间添加文本，如有必要，请创建它。此解决方案可能是最安全的，因为它降低了仅对这些脚本的安全性。您应该小心，您将让这些脚本可能访问比它们真正需要操作的更多的东西。

如果上述方法不起作用，则表示该设置受到保护，必须在*httpd.conf*或*php.ini*中进行更改，这两个文件都应位于该`/etc`目录中。有关详细信息，请参阅此[SO 问题](https://stackoverflow.com/questions/223800/how-can-i-relax-phps-open-basedir-restriction)。*

# regex - 匹配行中任意位置的第二组字符？

> ID：13943968
> 
> 赞同：1
> 
> 时间：2012-12-19T00:53:27.663
> 
> 标签：regex, string

嗨，我想匹配字符串的第二次出现，但只是为了匹配它，而不是其他任何东西，所以在我的示例中，方括号中的 word1 意味着应该是匹配的。

```
word1 tex text [word1] text
word1 [word1] word1
word1 [word1]
word1 text [word1] 
```

请你能帮助我，我正在学习正则表达式，我在互联网和书中都找不到答案。我正在使用一个接受.net regex 兼容或 perl 的记事本编辑器。

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:57:33.430

要仅匹配出现在其他内容后面的内容，您需要使用[lookbehind](http://www.regular-expressions.info/lookaround.html)。要匹配出现两次的内容，您可以使用[匹配组和反向引用](http://www.regular-expressions.info/brackets.html)：

```
/(?<=\b\1\b.*?)\b(\w+)\b/ 
```

但是，在大多数语言中，lookbehind 的复杂性是有限的，所以我不确定这是否有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T01:09:37.920

这取决于你想对比赛做什么。

如果你只是想得到一个关于你是否有匹配的布尔值，那么简单地看看你是否有两次这个词是很简单的：

```
word1.*word1 
```

匹配任意数量的`.*`任意字符，因此它只查找单词两次，介于两者之间。

如果您想更换它，请保持简单。只需替换所有内容：

```
word1(.*?)word1 
```

对于替换，您需要添加`?`. `?`防止了贪婪，所以当`*`有三个时它不会吃掉 word1 的第二次出现。

将匹配替换为

```
word1\1newword 
```

代表括号内的`\1`所有内容（即，由 拾取的所有内容`.*?`）。`\`可能会因您使用的正则表达式引擎而异。例如，Powershell（我认为是 .NET）使用`$`而不是`\`.

基本上，想想你想对结果做什么。问问自己是否有更大的字符串可以匹配，而**不仅仅是**第二次出现。

# php - 是否可以在 PHP 中合并这些数组？

> ID：13943970
> 
> 赞同：5
> 
> 时间：2012-12-19T00:53:53.907
> 
> 标签：php, arrays

> **可能重复：**
> [PHP：合并 2 个多维数组](https://stackoverflow.com/questions/1558291/php-merge-2-multidimensional-arrays)

我有这些数组，我想将它们合并到一个数组中。

```
$arrayAAA[0]['name'] = "stackoverflow";
$arrayBBB[0]['color'] = "white";
$arrayCCC[0]['media'] = "web"; 
```

我想像这样合并这些。

```
$newArray[0]['name'] //"stackoverflow"
$newArray[0]['color'] //"white"
$newArray[0]['media'] //"web" 
```

如果有人知道如何做到这一点，请给我帮助。我以为我可以使用 合并它们`array_merge()`，但是这个功能在我的情况下不起作用。

提前非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T01:19:02.663

我不知道您在寻找解决方案上浪费了多少时间，而您本可以编写一份手册。

```
foreach(array($arrayAAA, $arrayBBB, $arrayCCC) as $v){
    foreach($v as $iv){
        $result[key($iv)] = $iv[key($iv)];
    }
} 
```

**[键盘](http://codepad.org/BdSRebMZ)**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T00:56:30.280

我想你想用`array_merge()`，不是`merge_array()`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T01:15:32.137

那么，这也不行吗？

```
$x = array();
$x[0] = array_merge($arrayA[0], $arrayB[0], ...); 
```

还有[array_merge_recursive](http://php.net/manual/en/function.array-merge-recursive.php)函数。但我很确定它只会附加每个子数组。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-19T01:23:29.960

对于更复杂的数组，这应该可以工作，但似乎应该有更简单的方法。

```
$arrayAAA[0]['name'] = "stackoverflow";
$arrayBBB[0]['color'] = "white";
$arrayCCC[0]['media'] = "web";

function merge_arrays(){
    $aArgs = func_get_args();

    $aReturn = array();
    if($aArgs != array()){
        foreach($aArgs as $aArr){
            foreach($aArr as $mKey => $aSub){
                if(!isset($aReturn[$mKey])){
                    $aReturn[$mKey] = array();
                }

                foreach($aSub as $mSubKey => $mVal){
                    $aReturn[$mKey][$mSubKey] = $mVal;
                }
            }
        }   
    }

    return $aReturn;
}

$newArray = merge_arrays($arrayAAA, $arrayBBB, $arrayCCC); 
```

# c# - 面板在滚动时重绘

> ID：13943971
> 
> 赞同：0
> 
> 时间：2012-12-19T00:53:58.897
> 
> 标签：c#, panel

我有一个面板，其中添加了一堆链接标签。当我滚动面板时，它正在调用绘制事件。有什么办法可以禁止它在滚动时调用绘制事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T15:30:03.480

原来需要在调用draw事件之前清除控件

# javascript - jQuery扩展菜单缓动没有css过渡

> ID：13943975
> 
> 赞同：0
> 
> 时间：2012-12-19T00:54:18.383
> 
> 标签：javascript, css

因此，我正在尝试根据您悬停的项目设置展开和折叠菜单。我正在使用 css 过渡来使展开和折叠平滑，并使用一些 jQuery 来更改宽度 css 属性。但是，IE 不支持过渡 css，所以我试图找到一种方法来使用 jQuery 做到这一点，但还没有找到解决方案。当谈到 jQuery 时，我的知识并不是最丰富的。任何帮助都会很棒。

```
<html>
<head>
<style>
.a{
width:100px;
height:100px;
background:#852369;
position:relative;
float:left;
-webkit-transition: width 1s ease; 
-moz-transition: width 1s ease; 
-o-transition: width 1s ease;   
-ms-transition: width 1s ease;   
transition: width 1s ease;

}
.b{
width:100px;
height:100px;
background:#542365;
position:relative;
float:left;
    -webkit-transition: width 1s ease; 
-moz-transition: width 1s ease; 
-o-transition: width 1s ease;   
-ms-transition: width 1s ease;   
transition: width 1s ease;
}
.c{
width:100px;
height:100px;
background:#523641;
position:relative;
float:left;
    -webkit-transition: width 1s ease; 
-moz-transition: width 1s ease; 
-o-transition: width 1s ease;   
-ms-transition: width 1s ease;   
transition: width 1s ease;
}
</style>
</head>
<body>    
<div class="a">This is div a</div>
<div class="b">This is div b</div>
<div class="c">This is div c</div>​
<script>
$(function() {
$('.a').hover(function() {
    $('.b,.c').css('width', '50');
    $('.a').css('width', '200');
}, function() {
    $('.a,.b,.c').css('width', '');
}

);
$('.b').hover(function() {
    $('.a,.c').css('width', '50');
    $('.b').css('width', '200');
}, function() {
    $('.a,.b,.c').css('width', '');
}

);
$('.c').hover(function() {
    $('.a,.b').css('width', '50');
    $('.c').css('width', '200');
}, function() {
    $('.a,.b,.c').css('width', '');
}

);
});​
</script
</body>
</html> 
```

这是我目前拥有的一个简单的jsfiddle。

[http://jsfiddle.net/kevin11189/kRZHL/1/](http://jsfiddle.net/kevin11189/kRZHL/1/)

谢谢，

凯文

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:12:01.500

您可以使用[animate](http://api.jquery.com/animate/)和[stop](http://api.jquery.com/stop/)方法来完成此操作：

[http://jsfiddle.net/brianpeiris/CgY2b/2/](http://jsfiddle.net/brianpeiris/CgY2b/2/)

```
$(function() {
    var menus = $('.menu');
    menus.hover(function() {        
        menus.stop();
        $(this).animate({'width': '200'});
        menus.not(this).animate({'width': '50'});
    }, function () {
        menus.stop().animate({'width': '100'});
    });
}); 
```

* * *

```
<div class="menu a">This is div a</div>
<div class="menu b">This is div b</div>
<div class="menu c">This is div c</div> 
```

* * *

```
.menu{
    width:100px;
    height:100px;
    position:relative;
    float:left;
}
.a{ background:#852369; }
.b{ background:#542365; }
.c{ background:#523641; } 
```

# api - google doc api中的异常错误

> ID：13943977
> 
> 赞同：0
> 
> 时间：2012-12-19T00:54:30.933
> 
> 标签：api, servlets, glassfish

我是谷歌 API 的新手。我正在尝试创建一个简单的 Web 应用程序（Java EE）来从 google doc 读取 DocumentListFeed。我在 servlet 中的代码是：

protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

```
 try 
    {   
        DocsService service = new DocsService("Document List Demo");
        service.setUserCredentials(NAME, PASSWORD);

        response.getWriter().println("helloooooo");

        //URL documentListFeedUrl = new URL("http://docs.google.com/feeds/documents/private/full");     
        URL documentListFeedUrl = new URL("https://docs.google.com/feeds/default/private/full?v=3");        
        DocumentListFeed feed = service.getFeed(documentListFeedUrl, DocumentListFeed.class);

        for(DocumentListEntry entry : feed.getEntries())
        {
            response.getWriter().println(entry.getTitle().getPlainText());
        }

    }   

    catch (Exception e)
    {

        response.getWriter().println(e);
    }
} 
```

但它向我显示了错误：java.lang.NoClassDefFoundError: com/google/gdata/client/docs/DocsService

我正在使用 Glassfish 服务器和 Ecllipse。并添加了外部jar文件：activation.jar, guava-r07.jar, mail.jar, servlet.jar, gdata-client-1.0.jar, gdata-client-meta-1.0.jar, gdata-core-1.0.jar, gdata-media-1.0.jar、gdata-docs-3.0.jar、gdata-docs-meta-3.0.jar。

我已将相同的代码复制到 java 标准版，它工作正常。请告诉我为什么这个东西在 Java EE 中不起作用？GlassFish 服务器有问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T14:35:35.893

这只是意味着您的 Glassfish 服务器类路径中不存在这些 jar。将您列出的所有 jar 添加到您的 glassfish 服务器类路径。由于我不是 Glassfish 专家，我无法帮助您将罐子添加到您的服务器。如果是weblogic，你只需要打包你项目APP-INF目录下的所有jar。

希望能帮助到你。

# django - 获取外键查询集的有效方法

> ID：13943990
> 
> 赞同：0
> 
> 时间：2012-12-19T00:55:54.863
> 
> 标签：django, django-models

如果有一个简单的 django 模型，其中包含 User 的外键，如下所示：

```
Class Office(models.Model):
    name = charfield
    user = foreignkeyfield(User) 
```

获取名称为“foo”的办公室的用户查询集的最佳方法是什么。通过反复试验，我发现这是可行的，但我还没有看到它记录在案：

```
User.objects.filter(office__name="foo") 
```

# css - 用于将均匀宽度应用于动态表列数的 CSS

> ID：13943999
> 
> 赞同：0
> 
> 时间：2012-12-19T00:56:38.817
> 
> 标签：css

我有一张桌子，最初是有两列的，两列的大小都是表格的 50% 宽度。

这是通过以下方式完成的：

```
.catPagesTbl td {width: 50%;} 
```

我对表格的需求已经改变，表格可以有 2 到多列。

我仍然需要均匀地间隔它们，不管有多少，我不想在任何标签本身中包含样式标签或 css 类。

有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:09:34.193

这里有一些想法：[HTML table: keep the same width for columns](https://stackoverflow.com/questions/570154/html-table-keep-the-same-width-for-columns)。

或者，如果“many”相对较小，您可以为每个列布局定义样式：

```
table.twoCol td {
  width: 50%;
}
table.threeCol td {
  width: 33%;
}
table.fourCol td {
  width: 25%;
}
... 
```

然后只需在桌子上包括适当的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T01:19:23.303

您还可以查看使用 datatables jQuery 库 -http://datatables.net/ 它提供了多种方式来设置结果表的样式，例如每列的样式。Levi Stanley 的方法也是一个好主意。