# StackOverflow 问答 15263000-15263999

# java - EclipseLink ValidationException - 非实体 [class long] 作为关系属性 [field providerId] 中的目标实体

> ID：15263002
> 
> 赞同：1
> 
> 时间：2013-03-07T04:19:11.797
> 
> 标签：java, jpa, glassfish, eclipselink

尝试将应用程序部署到 Glassfish 时收到以下错误。显然我的人际关系有问题。

尝试部署时来自 Glassfish 服务器的错误：

```
 ValidationException Exception Description: [class edu...clinic.Treatment] 
uses a non-entity [class long] as target entity in the relationship attribute 
[field providerId] 
```

我的“治疗”类文件中的多对一关系：

```
@Entiity
... 
@ManyToOne
    @JoinColumn(name = "provider_fk", referencedColumnName = "npi")
    private long providerId; 
```

我的“提供者”类文件中的一对多关系：

```
 @Entity
    ...
@Id
    @Column(name = "NPI")
    private long npi;
...
    @OneToMany(mappedBy = "providerId", targetEntity=Treatment.class)
        @OrderBy
        private List<Treatment> treatments; 
```

我相信我的注释是正确的，但有些不对劲。我将不胜感激有关如何纠正此问题的任何建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:36:23.490

在处理实体更改中尝试以下操作

```
private long providerId; 
```

到

```
private Provider provider; 
```

在 Provider 实体变更中

```
@OneToMany(mappedBy = "providerId", targetEntity=Treatment.class) 
```

到

```
@OneToMany(mappedBy = "provider", targetEntity=Treatment.class) 
```

# php - 如何强制 Intellij IDEA 将 HTML 文件解析为 PHP 文件

> ID：15263016
> 
> 赞同：4
> 
> 时间：2013-03-07T04:20:26.797
> 
> 标签：php, html, intellij-idea

我有 PHP 项目，所以到目前为止，我一直在将 Intellij IDEA 用于 Java 和 PHP，没有任何问题。但是现在，我有一个旧的 PHP 项目，该项目使用 HTML 文件作为 PHP 文件。我的意思是带有 HTML 扩展名的文件包含 PHP 代码。

但是 IDEA 不会将它们识别为 PHP 文件，但是当我将扩展名更改为 PHP 时，它显示一切都很好。

那么如何强制 IDEA 接受 HTML 文件作为 PHP 文件呢？

有什么解决方法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-07T04:47:08.583

转到文件 > 设置 > 文件类型（在 下`IDE Settings`）。

在 下`Recognized File Types`，找到`PHP files (PHP)`（假设您像我一样使用 PHPStorm 插件，如果没有找到您的`*.php`文件扩展名的注册位置）。如果您单击它，然后查看`Registered Patterns`，您将看到所有将被识别为 PHP 文件的文件模式。您可以单击`+`模式窗格右侧的绿色，它会要求将文件名模式识别为 PHP 文件。输入`*.html`（如果您的 HTML 文件都遵循类似的命名模式，则输入更具体的内容）。当你点击 OK 时，它可能会说`*.html`已经注册了 HTML 文件。继续并重新分配它，然后在“设置”窗口中点击“确定”。您的`*.html`文件现在将被识别为 PHP 文件，而不仅仅是 HTML 文件。

我刚刚在 12.0.4 中对此进行了测试，它的工作原理如上所述。

但是请注意，这似乎是一个 IDE 范围的设置，而不是特定于项目的。`*.html`不幸的是，这意味着在打开具有正确文件扩展名的其他较新项目时，您必须重新注册HTML 文件。这就是为什么我建议一个更具体的模式，而不是`*.html`您的文件允许它，或者如果您可以更改文件名以允许它。

在 IntelliJ 中执行此操作的最新方法可以在[此处](https://www.jetbrains.com/idea/help/creating-and-registering-file-types.html)找到。

# c++ - 对 Segfault 感到困惑：看起来我的比较器正在尝试比较超出范围的节点

> ID：15263017
> 
> 赞同：0
> 
> 时间：2013-03-07T04:20:30.847
> 
> 标签：c++, scope, segmentation-fault, priority-queue

我遇到了分段错误。我相信这与我如何进行比较有关。我很困惑，对 C++ 很陌生。

最后一行`pq.pop()`是进入堆栈跟踪并导致失败的调用。执行 ./a.out 时不打印任何内容

```
class Node {
    public:

    Node() {}

    Node(int b) {
        bound = b;
    }

    Node(int b, Node * p) {
        bound = b;
        parent = p;
    }

    void addChild(Node& n) {
        n.parent = this;    
    }

    Node * parent;

    int bound;
};

class CompareNode {

public:
    bool operator()(Node *n, Node *o)
    {
        cout << "Comparing " << n->bound;
        cout << " to " << o-> bound <<endl;
        return n->bound > o->bound; 
    }
}; 
```

* * *

在主要

* * *

```
std::priority_queue<Node*, vector<Node*>, CompareNode> pq;
Node* root = new Node();
Node* node;
for(int i = 0; i < n; i++) {
  node = new Node(matrix[0][i], root);
  pq.push(node);
}

pq.pop(); 
```

* * *

**广发银行**

* * *

```
(gdb) run
Program received signal SIGSEGV, Segmentation fault.
0x00000000004027e7 in void std::__pop_heap<__gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, CompareNode>(__gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, __gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, __gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, CompareNode) ()
(gdb) backtrace
#0  0x00000000004027e7 in void std::__pop_heap<__gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, CompareNode>(__gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, __gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, __gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, CompareNode) ()
#1  0x0000000000401e13 in void std::pop_heap<__gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, CompareNode>(__gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, __gnu_cxx::__normal_iterator<Node**, std::vector<Node*, std::allocator<Node*> > >, CompareNode)
    ()
#2  0x0000000000401a11 in std::priority_queue<Node*, std::vector<Node*, std::allocator<Node*> >, CompareNode>::pop() ()
#3  0x00000000004015dc in main () 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:44:35.420

C++ 通常不会为您检查必要的先决条件。如果你调用`pop`一个空结构，结果很可能是崩溃。所以这是我要看的第一个地方。

您可能会在 GCC 中使用`-D_GLIBCXX_DEBUG`. 它添加了边界检查、迭代器验证等，无论如何它都是一套很好的训练轮。

# c++ - 将文本文件读入包含空格的数组

> ID：15263021
> 
> 赞同：2
> 
> 时间：2013-03-07T04:20:37.873
> 
> 标签：c++, arrays, file-io

我必须阅读这个已经存在的文本文件。这段代码可以编译并且可以工作，但它每行只读取一个单词。

例如：我的 txt 文件如下所示：

*   单词1 单词2 单词3 单词4
*   字 5 字 6 字 7
*   字 8 字 9

但它在屏幕上输出：

*   单词1
*   字2
*   word3..等

如何让它将 txt 文件读入包含空格的数组？

```
#include <iostream>
#include <fstream>
#include <string>

using namespace std; 

int main()
{
    string friendConnections[9];
    string line;
    int loop = 0;

    ifstream networkFile("network.txt");

    if (networkFile.is_open())
    {
        while (!networkFile.eof())
        {
            istream& getline (networkFile >> line);
            friendConnections[loop] = line;
            cout << friendConnections[loop] << endl;
            loop++;
        }
        networkFile.close();
    }
    else cout << "Can't open file" << endl;

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:24:27.340

使用`while(std::getline(networkFile,line))`代替`while(networkFile.eof())`和`istream& getline (networkFile >> line);`

`istream operator>>`一直到不是你想要的空白。

# java - 在这种情况下，对象持有默认锁（监控锁）

> ID：15263028
> 
> 赞同：-4
> 
> 时间：2013-03-07T04:21:17.063
> 
> 标签：java

在这种情况下，对象持有默认锁（监视器锁）？我有点困惑，如果java同步中有任何默认锁的概念。因此，如果有人帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:50:12.057

1）它是一个可以持有锁的线程，而不是一个对象。请参阅 java.lang.Thread.holdsLock API*该方法旨在允许程序断言当前线程已经持有指定的锁*

2）Java中有隐式锁的概念，没有默认锁

# javascript - $.getJSON 请求未运行，但下一行代码运行

> ID：15263029
> 
> 赞同：0
> 
> 时间：2013-03-07T04:21:27.120
> 
> 标签：javascript, jquery

我有一个 $.getJSON 请求，它没有运行，但是在请求之后的代码行。如果我在 $.getJSON 请求之后删除所有代码，请求将运行。如何获取运行迭代返回的数据的请求，然后在请求之后运行代码。

```
var eventList = new Array();
$.getJSON('../index.php?/home/events', function(eventItems){    
    $.each(eventItems, function() {
        var event = this;
        var eventItem = new Array();
        // format the date and append to span
        eventItem[0] = formatMDYDate(formatTimeStamp(this.loc_datetime, false), 0);
        // add shortdescription to div
        eventItem[1] = this.shortdescription; 

        // check if longdescription exist
        if (this.longdescription) {
            // create new anchor element for "More Info" link on events
            var link = $('<a></a>');
            link.attr('href', '../index.php?/home/event_info');
            link.addClass('popup');
            link.html('More Info');
            //link.bind('click', eventPopUp());
            link.bind('click', function() {
                var addressValue = event.id;
                dialog = $('<div></div>').appendTo('body');
                dialog.load('../index.php?/home/event_info', 
                    {id: addressValue});
                dialog.modal({
                    opacity: 80
                });
                return false;
            });
            eventItem[2] = link;
        }
        eventList.push(eventItem);
    });  
});
// removing the following lines of code will let the .getJSON request run
if (eventList.length > 0) {
    write_Events(eventList);
} 
```

我不知道是什么导致了这个问题，请帮忙！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T04:29:01.433

异步意味着当你调用它时，JS 运行时不会等待它完成，然后再执行下一行代码。通常，您需要在这种情况下使用回调。

它是这样的：

```
var a="start";
setTimeout(function(){
 a="done";
 dosomethingWithA(a);
},1000);
if(a=="done"){}//doesn't matter, a is not "done"
function dosomethingWithA(a){
 // a is "done" here
} 
```

在您的情况下，代码应类似于：

```
var eventList = new Array();
$.getJSON('../index.php?/home/events', function(eventItems){    
    $.each(eventItems, function() {
        var event = this;
        var eventItem = new Array();
        // format the date and append to span
        eventItem[0] = formatMDYDate(formatTimeStamp(this.loc_datetime, false), 0);
        // add shortdescription to div
        eventItem[1] = this.shortdescription; 
        // check if longdescription exist
        if (this.longdescription) {
            // create new anchor element for "More Info" link on events
            var link = $('<a></a>');
            link.attr('href', '../index.php?/home/event_info');
            link.addClass('popup');
            link.html('More Info');
            //link.bind('click', eventPopUp());
            link.bind('click', function() {
                var addressValue = event.id;
                dialog = $('<div></div>').appendTo('body');
                dialog.load('../index.php?/home/event_info', 
                    {id: addressValue});
                dialog.modal({
                    opacity: 80
                });
                return false;
            });
            eventItem[2] = link;
        }
        eventList.push(eventItem);
    });
    processEventList();  
});
function processEventList(){
  // removing the following lines of code will let the .getJSON request run
  if (eventList.length > 0) {
    write_Events(eventList);
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T04:25:53.920

尝试

```
var eventList = new Array();
    $.getJSON('../index.php?/home/events', function (eventItems) {
        $.each(eventItems, function () {
            //....
            eventList.push(eventItem);               
        });
        // removing the following lines of code will let the .getJSON request run
        if (eventList.length > 0) {
            write_Events(eventList);
        }
    }); 
```

或者，您可以使用带有 jquery 技术的 PubSub

```
 var eventList = new Array();
    $.getJSON('../index.php?/home/events', function (eventItems) {
        $.each(eventItems, function () {
           //....
            eventList.push(eventItem);               
        });            
        //publisher
        $(document).trigger('testEvent', eventList);
    });

    //subscriber
    $(document).bind("testEvent", function (e, eventList) {
        if (eventList.length > 0) {
            write_Events(eventList);
        }
    }); 
```

有关更多详细信息[http://www.codeproject.com/Articles/292151/PubSub-with-JQuery-Events](http://www.codeproject.com/Articles/292151/PubSub-with-JQuery-Events)

快乐编码.. :)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T04:22:41.850

`$.getJSON`是一个异步调用。直到当前函数完全执行后，回调才会执行。调用后的代码将始终在`getJSON`回调运行之前运行。

该`write_Events`函数可能会引发错误并停止执行，这就是回调永远不会运行的原因。或者它实际上正在运行，但由于额外代码调用的任何原因，您都没有看到它的证据。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T04:45:52.830

javascript 代码从不等待服务器的响应，我们需要停止处理 javascript，直到我们得到服务器的响应。

我们可以通过使用[jquery.Deferred来做到这一点](http://api.jquery.com/jQuery.Deferred/)

您也可以访问[本](http://www.erichynds.com/jquery/using-deferreds-in-jquery/)教程。

# authentication - 在 Firebase 中实现自定义身份验证的好方法是什么？

> ID：15263033
> 
> 赞同：0
> 
> 时间：2013-03-07T04:21:49.887
> 
> 标签：authentication, customization, firebase

我已经使用 firebase 做了一些事情（太酷了）。

我正在做自定义登录，我已经生成了一个 AUTH_TOKEN（使用 nodejs）。

我的问题是我是否需要传递我想要保护下面代码的所有页面？

和平，

图利奥克鲁兹

`var dataRef = new Firebase("[https://example.firebaseio.com](https://example.firebaseio.com)");`

 ````
 // Log me in.
    dataRef.auth(AUTH_TOKEN, function(error, result) {
      if(error) {
        console.log("Login Failed!", error);
      } else {
        console.log('Authenticated successfully with payload:', result.auth);
        console.log('Auth expires at:', new Date(result.expires * 1000));
      }
    }); 
````  `* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T07:27:14.147

我不确定我是否完全理解你的问题。如果您想知道每次加载页面时是否需要调用 auth - 是的。当通过低级 auth() api 调用使用自定义登录时，我们不会为您做任何会话管理。

不过，您只需在每次页面加载时调用 auth() 一次——而不是为每个 Firebase 引用调用一次。`

# c++ - “src/common.hpp:52:32: 致命错误: boost/shared_ptr.hpp: 没有这样的文件或目录”在构建 websocket++ 时

> ID：15263039
> 
> 赞同：3
> 
> 时间：2013-03-07T04:22:13.870
> 
> 标签：c++, build, makefile, ubuntu-12.10, websocket++

我对 linux 或 c++ 几乎一无所知。

我通常按​​照这些说明在 ubuntu 12.10 [http://piyushparkash.blogspot.com/2012/10/installing-boost-150-in-ubuntu-1210.html](http://piyushparkash.blogspot.com/2012/10/installing-boost-150-in-ubuntu-1210.html)上构建提升。我下载了 1.53.0。

我遵循了 1.2.2 末尾的建议，`./bootstrap.sh --exec-prefix=/usr/local`因为我想要所有库。

`src/common.hpp:52:32: fatal error: boost/shared_ptr.hpp: No such file or directory`当我`make`在这里概述时出现此错误[https://github.com/zaphoyd/websocketpp/wiki/Build-Library](https://github.com/zaphoyd/websocketpp/wiki/Build-Library)。

当 I 时`find / -name 'shared_ptr.hpp'`，它列出

> /root/boost_1_53_0/boost/asio/detail/shared_ptr.hpp /root/boost_1_53_0/boost/interprocess/smart_ptr/shared_ptr.hpp /root/boost_1_53_0/boost/smart_ptr/shared_ptr.hpp /root/boost_1_53_0/boost/序列化/shared_ptr .hpp /root/boost_1_53_0/boost/shared_ptr.hpp

它们不应该按照第一个链接中的说明安装到默认目录和指定目录吗？

如何解决此错误？

（我这样做是为了获得“所有”库[https://askubuntu.com/questions/259590/libapache2-mod-fastcgi-not-available](https://askubuntu.com/questions/259590/libapache2-mod-fastcgi-not-available)）

**`apt-cache libboost-all-dev`**

1.49

**`apt-cache search boost | grep dev`**

```
libboost-date-time-dev - set of date-time libraries based on generic programming concepts (default version)
libboost-date-time1.49-dev - set of date-time libraries based on generic programming concepts
libboost-dev - Boost C++ Libraries development files (default version)
libboost-iostreams-dev - Boost.Iostreams Library development files (default version)
libboost-iostreams1.49-dev - Boost.Iostreams Library development files
libboost-program-options-dev - program options library for C++ (default version)
libboost-program-options1.49-dev - program options library for C++
libboost-python-dev - Boost.Python Library development files (default version)
libboost-python1.49-dev - Boost.Python Library development files
libboost-regex-dev - regular expression library for C++ (default version)
libboost-regex1.49-dev - regular expression library for C++
libboost-serialization-dev - serialization library for C++ (default version)
libboost-serialization1.49-dev - serialization library for C++
libboost-test-dev - components for writing and executing test suites (default version)
libboost-test1.49-dev - components for writing and executing test suites
libboost1.49-dev - Boost C++ Libraries development files
libasio-dev - cross-platform C++ library for network programming
libboost-all-dev - Boost C++ Libraries development files (ALL) (default version)
libboost-chrono-dev - C++ representation of time duration, time point, and clocks (default version)
libboost-chrono1.49-dev - C++ representation of time duration, time point, and clocks
libboost-chrono1.50-dev - C++ representation of time duration, time point, and clocks
libboost-date-time1.50-dev - set of date-time libraries based on generic programming concepts
libboost-exception1.50-dev - set of date-time libraries based on generic programming concepts
libboost-filesystem-dev - filesystem operations (portable paths, iteration over directories, etc) in C++ (default version)
libboost-filesystem1.49-dev - filesystem operations (portable paths, iteration over directories, etc) in C++
libboost-filesystem1.50-dev - filesystem operations (portable paths, iteration over directories, etc) in C++
libboost-graph-dev - generic graph components and algorithms in C++ (default version)
libboost-graph-parallel-dev - generic graph components and algorithms in C++ (default version)
libboost-graph-parallel1.49-dev - generic graph components and algorithms in C++
libboost-graph-parallel1.50-dev - generic graph components and algorithms in C++
libboost-graph1.49-dev - generic graph components and algorithms in C++
libboost-graph1.50-dev - generic graph components and algorithms in C++
libboost-iostreams1.50-dev - Boost.Iostreams Library development files
libboost-locale-dev - C++ facilities for localization (default version)
libboost-locale1.49-dev - C++ facilities for localization
libboost-locale1.50-dev - C++ facilities for localization
libboost-math-dev - Boost.Math Library development files (default version)
libboost-math1.49-dev - Boost.Math Library development files
libboost-math1.50-dev - Boost.Math Library development files
libboost-mpi-dev - C++ interface to the Message Passing Interface (MPI) (default version)
libboost-mpi-python-dev - C++ interface to the Message Passing Interface (MPI), Python Bindings (default version)
libboost-mpi-python1.49-dev - C++ interface to the Message Passing Interface (MPI), Python Bindings
libboost-mpi-python1.50-dev - C++ interface to the Message Passing Interface (MPI), Python Bindings
libboost-mpi1.49-dev - C++ interface to the Message Passing Interface (MPI)
libboost-mpi1.50-dev - C++ interface to the Message Passing Interface (MPI)
libboost-program-options1.50-dev - program options library for C++
libboost-python1.50-dev - Boost.Python Library development files
libboost-random-dev - Boost Random Number Library (default version)
libboost-random1.49-dev - Boost Random Number Library
libboost-random1.50-dev - Boost Random Number Library
libboost-regex1.50-dev - regular expression library for C++
libboost-serialization1.50-dev - serialization library for C++
libboost-signals-dev - managed signals and slots library for C++ (default version)
libboost-signals1.49-dev - managed signals and slots library for C++
libboost-signals1.50-dev - managed signals and slots library for C++
libboost-system-dev - Operating system (e.g. diagnostics support) library (default version)
libboost-system1.49-dev - Operating system (e.g. diagnostics support) library
libboost-system1.50-dev - Operating system (e.g. diagnostics support) library
libboost-test1.50-dev - components for writing and executing test suites
libboost-thread-dev - portable C++ multi-threading (default version)
libboost-thread1.49-dev - portable C++ multi-threading
libboost-thread1.50-dev - portable C++ multi-threading
libboost-timer-dev - C++ wall clock and CPU process timers (default version)
libboost-timer1.49-dev - C++ wall clock and CPU process timers
libboost-timer1.50-dev - C++ wall clock and CPU process timers
libboost-wave-dev - C99/C++ preprocessor library (default version)
libboost-wave1.49-dev - C99/C++ preprocessor library
libboost-wave1.50-dev - C99/C++ preprocessor library
libboost1.49-all-dev - Boost C++ Libraries development files (ALL)
libboost1.50-all-dev - Boost C++ Libraries development files (ALL)
libboost1.50-dev - Boost C++ Libraries development files
libjson-spirit-dev - C++ JSON Parser/Generator implemented with Boost Spirit
libmapnik-dev - C++/Python toolkit for developing GIS applications (dummy)
libmapnik2-2.0 - C++/Python toolkit for developing GIS applications (libraries)
libmapnik2-dev - C++/Python toolkit for developing GIS applications (devel)
libpion-common-dev - lightweight HTTP interface library - common development files
libpion-net-dev - lightweight HTTP interface library - development files
libroot-tmva-dev - Toolkit for multivariate data analysis - development files
libtorch3-dev - State of the art machine learning library - development files
mapnik-doc - C++/Python toolkit for developing GIS applications (doc)
mapnik-utils - C++/Python toolkit for developing GIS applications (utilities)
python-mapnik2 - C++/Python toolkit for developing GIS applications (Python) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T04:30:16.313

为什么要自己构建 Boost？只要做`sudo apt-get install boost-devel`，你就完成了。它会将标题放入其中，`/usr/include/boost`因此一切都会“正常工作”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-07T12:17:42.967

我建议确保您安装 boost 的自定义位置位于构建系统的包含路径中。

对于 WebSocket++ 0.2.x 构建系统，如果您尚未安装系统范围的 BOOST_LIB_PATH / BOOST_INCLUDE_PATH 环境变量来指定自定义路径，则可以设置包含和 lib 目录的 BOOST_PREFIX（即 /usr/local/）或确切路径。对于 0.3.x，没有要构建的库，只需确保使用 -I/path/to/your/boost 和 -L/path/to/your/boost/lib/dir 或将这些路径添加到全局路径。如果您使用 IDE，他们通常可以添加自定义包含/库路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-07T03:08:15.473

我在 CentOS 上做了同样的事情：

```
yum install boost-devel 
```

# algorithm - 在逻辑时间安排作业（不受夏令时影响）

> ID：15263041
> 
> 赞同：4
> 
> 时间：2013-03-07T04:22:22.050
> 
> 标签：algorithm, timezone

这不是一篇关于技术本身的文章，而是一篇关于适当算法的文章。我希望我的用户能够将我的应用程序上的事件安排在每周的特定时间发生（他们将在我的网站上看到显示在他们的时区中）。

假设纽约的一位用户将事件安排在美国东部标准时间晚上 8 点发生。无论夏令时如何，我都希望该用户全年在美国东部标准时间每周 8 点发生该事件。

目前，我将时间值以 UTC 格式存储在我的数据库中，但 UTC 不会根据一年中的时间而改变。似乎某些时区确实有夏令时的概念，而有些则没有，这意味着如果我要即时进行任何时区转换处理（在任何查询日期以安排事件或显示之前）网站上的预定时间）我必须查看用户的时区是否支持夏令时以及目标时间戳是否在夏令时期间。

人们通常如何解决这类问题？换句话说，对于所有用户时区，我应该如何以最简单的方式在我的数据库中存储逻辑时间，正确显示它，使用它来正确调度任务，而不考虑夏令时？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T14:46:33.843

我会做一个假设，你的意思是“......在*东部时间*全年每周”。当您说 EST 时，您具体指的是东部*标准*时间。当 DST 适用时，它被称为东部*夏令*时间 (EDT)。

此外，缩写不是识别时区的好方法。我怎么知道您指的是美国的 EST (UTC-5) 而不是澳大利亚的 EST (UTC+10)？缩写是模棱两可的。[你可以在这里](http://www.timeanddate.com/library/abbreviations/timezones/)看到一个相当全面的列表。

首先要做的是决定如何识别用户的时区。常用的数据库有两种：

**[Microsoft 时区数据库](http://support.microsoft.com/gp/cp_dst)**

**专业人士**

*   内置于 Windows 操作系统。
*   通过 Windows 更新自动部署的更新。
*   易于从 Win32 或 .Net Framework 使用。

**缺点**

*   由 Microsoft 而非标准机构或社区维护。
*   区域往往非常广泛而不是精细。
*   不适合历史时区变化。
*   与非 Microsoft 服务器的互操作性可能很痛苦。
*   更新频率较低。

**[IANA/奥尔森时区数据库](http://www.iana.org/time-zones)**

**专业人士**

*   在 Linux、Mac、Java、PHP 和许多其他平台上广泛实现。
*   库可用于[JavaScript](https://stackoverflow.com/a/15171030/634824)和[Windows/.Net](https://code.google.com/p/noda-time/)。
*   以典型城市命名的精致、独特的时区。
*   包含时区更改的历史数据。
*   在许多 RFC 和其他标准中引用。
*   社区维护，最近由 IANA 支持。
*   经常更新，一年几次。

**缺点**

*   通常不会自动维护，尽管某些实现可能会这样做。
*   有这么多区域，很难向您的用户呈现一个简单的下拉列表。良好的用户体验需要基于地图的时区选择器，例如[这个。](https://github.com/dosx/timezone-picker)

现在您已经确定了您的用户所在的时区 - 让我们进入您最初问题的核心。在不考虑 DST 更改的情况下，您应该如何处理在同一本地时间的重复事件？

你实际上有两个不同的关注点，持久性和执行。

对于持久性（以及传输、显示等），您需要存储组合的本地时间和时区。例如，`America/New_York`IANA 区域中的晚上 8:00。如果可能，请在您的框架中存储此时间而不使用日期组件。不要将其转换为 UTC 或尝试针对 DST 进行调整。您只是以用户向您表达的方式捕获用户意图。

为了执行，您需要在特定的预定时间触发您的重复作业。您的作业正在运行的服务器可能完全位于不同的时区。您需要的是一系列 UTC DateTime 值，因此您可以将任务调度程序设置为在瞬间的特定时刻触发。您也可以为此使用本地时间加 utc 偏移量，例如`DateTimeOffset`在 .Net 中。这将具有在每个值上看到 8:00PM 的优势，即使偏移量在 -4 和 -5 之间切换。请参阅[DateTime 与 DateTimeOffset](https://stackoverflow.com/a/14268167/634824)。

为了协调这两个概念，您需要一些代码来评估本地时间并计算执行时间戳。您可以在每个作业运行时设置下一个计划作业，或者您可以定期执行此操作并为未来的 X 个事件预测事件时间。这取决于你。如果您需要将未来的事件日期放在日历上 - 那么您当然需要后一种方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:22:25.817

我会尽快转换为 UTC 并尽可能晚地退出 UTC，因为当国家在夏季结束时退出 DST 时，他们会将时钟调回去，并且一天中有两个小时的时间相同 -所以 DST 时间不能唯一地描述所有时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T04:32:08.730

也许您可以使用任何公开可用的时区 API。例如。[https://developers.google.com/maps/documentation/timezone/](https://developers.google.com/maps/documentation/timezone/)。

# html - carousal jquery 在 Firefox 和 Opera 中不起作用

> ID：15263042
> 
> 赞同：0
> 
> 时间：2013-03-07T04:22:22.987
> 
> 标签：html, css, google-chrome, firefox, opera

我在我的页面 www.woody.my 的底部使用水平轮播，使用 chrome explorer 可以正常工作，而使用 firefox、opera、IE 则不可见。

下面是它在 chrome 中的外观：

![在此处输入图像描述](../Images/90465215f41dada62a2f60ff2b6273f1.png)

虽然这是它在 Firefox 中的外观： ![在此处输入图像描述](../Images/3f441bf46df81d57a980e2a63722bb45.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T08:51:41.703

这在 HTML

```
<ul style="width: 1000px;"> 
```

而这个在 CSS 行：526

```
.infiniteCarousel ul li {
    background: url("../images/footer_img_box.png") no-repeat scroll 0 0 transparent;
    display: block;
    float: left;
    height: 220px;
    padding: 10px;
    position: relative;
    width: 198px;
}
.infiniteCarousel .wrapper ul {
width: 900px;
list-style-image: none;
list-style-position: outside;
list-style-type: none;
padding: 0;
top: 0;
} 
```

虽然它们的位置`<li>`是绝对的，但它们会堆叠在一起。需要将位置更改为相对位置，主容器的尺寸也非常大，为 9999 像素，将其更改为视口，当元素彼此向左浮动时，您可以看到它们

也删除`.infiniteCarousel .wrapper ul`类的位置

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:37:20.510

试试这个

```
.infiniteCarousel ul li {
    background: url("../images/footer_img_box.png") no-repeat scroll 0 0 transparent;
    display: block;
    float: left;
    height: 220px;
    padding: 10px;
    position: absolute;
    width: 198px;
} 
```

ps 我也在马来西亚 :)

# c++ - 如何回溯指针？

> ID：15263055
> 
> 赞同：3
> 
> 时间：2013-03-07T04:23:36.030
> 
> 标签：c++, c, pointers, memory, backtracking

假设我有 2 个指针指向同一个内存位置。如果我知道它的地址是什么，我怎样才能找出指向该位置的指针？

```
int x=5;
int* p1=&x;
int* p2=&x; 
```

如何获取 p1 和 p2 的地址？甚至可以在 C/C++ 中做到这一点吗？如果不是，那么是否可以搜索所有指针并查看哪些指针具有 &x 的值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T04:35:25.643

不，不可能在 C 或 C++ 中“回溯”一个指针（一个好的经验法则是，如果一个特性有很大的隐藏性能成本，那么它在 C 或 C++ 中不存在）

至于第二种方法（通过内存寻找指针），这正是像[Boehm 垃圾收集器](https://en.wikipedia.org/wiki/Boehm_garbage_collector)这样的一些工具所做的。但是，此过程不仅效率低下且不可移植，而且还可能导致“误报”，因为您无法判断内存中的字节模式是真实指针还是其他诸如常规整数或字符串的一部分。

* * *

无论如何，您应该问自己真正需要解决的问题是什么，而不是尝试自己破解垃圾收集器。根据您想要做的事情，有很多方法可以在 C++ 中处理它（RAII、智能指针等）

# php - 使用php脚本将mySQL切换到本地服务器访问被拒绝

> ID：15263057
> 
> 赞同：0
> 
> 时间：2013-03-07T04:23:58.737
> 
> 标签：php, mysql, xampp, localhost, access-denied

我一直在使用 php 脚本与远程服务器上的 mySQL 数据库连接，我正在尝试切换到使用本地服务器。当我尝试使用以下脚本进行连接时：

```
<?php
mysql_connect("localhost", "vinylpsy_singles", "password") or die(mysql_error());
mysql_select_db("vinylpsy_singles") or die(mysql_error());

$resultNew = mysql_query("SELECT * FROM `table`"); 

?> 
```

我收到以下错误

```
Warning: mysql_connect() [function.mysql-connect]: Access denied for user 'vinylpsy_singles'@'localhost' (using password: YES) in /Applications/XAMPP/xamppfiles/htdocs/chromeSave/thepopz/php/getSingles_11.php on line 2
Access denied for user 'vinylpsy_singles'@'localhost' (using password: YES) 
```

有人可以建议我需要做哪些调整吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:33:27.630

在 SQL 服务器上以管理员身份登录并运行以下命令：

```
select * from `mysql`.`user` where `user` = 'vinylpsy_singles' 
```

确保在 Hosts 列或通配符 % 中有一行包含“localhost”。如果这些都不正确，那么您必须使用 GRANT 命令添加对特定用户的访问权限。MySQL 中的用户被“锁定”到特定主机（或通配符）。

对于完整的 GRANT，请使用以下内容：

```
GRANT ALL PRIVILEGES ON *.* TO 'vinylpsy_singles'@'localhost' 
```

但是，此特权当然应该与您以前为旧主机所拥有的特权相同。

# iphone - 使用 UIViewAnimation 调用时 NSTimer 冻结

> ID：15263060
> 
> 赞同：3
> 
> 时间：2013-03-07T04:24:50.867
> 
> 标签：iphone, ios6, nstimer, uiviewanimation

在我的项目中，我每秒调用`NSTimer`1000 次。有了它，我`UIImage`在某些图像视图中每次点击分配 5 个对象，同时使用`UIViewanimation`. 当我做这项工作时，`NSTimer`冻结几秒钟或延迟。我知道为什么会发生这种情况，因为我`UIImageView`在一秒钟内制作了超过 100-120 个对象。当我不调用 UIAnimation 时，计时器很好。我曾经在后台`[performSelectorInBackground:withObject:]` 执行`UIViewAnimation`。但在其中 UIAnimation 不起作用。

两者都`NSTimer`在`UIViewAnimation`UI 上工作。所以他们在主线程上工作。我不能为他们制作不同的线程。我能做些什么来停止冻结`NSTimer`和同时调用`UIViewAnimation`。这是因为计算量很大。而且我不能为此制作单独的线程，我该怎么做。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:22:51.203

这可能是因为您在 UIImageView 中用于动画的 PNG 图像。

为什么不尝试使用 JPEG 表示

```
UIImage *newImage=[UIImage imageWithData:UIImageJPEGRepresentation(myImage, 0.5)]; 
```

然后使用 newImage ，因为它的大小比 png 小。

# c# - 我如何允许用户只属于角色访问文件夹中的文件？

> ID：15263062
> 
> 赞同：-1
> 
> 时间：2013-03-07T04:25:02.177
> 
> 标签：c#, asp.net, razor, webmatrix

我有一个网站，其中包含存储在服务器文件夹中的 pdf 文件，我只需要为登录并属于我选择的角色的用户设置对文件夹中此文件的访问权限！感谢您的帮助:) :)

解释情况：文件夹名称是“文件”文件夹中文件的名称是“f.pdf”当我输入这个网址“www.website.com/files/f.pdf”它是打开的pdf文件，假设只打开认证用户？？我怎么解决这个问题 ？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T07:43:13.050

将文件夹移到根目录之外，或将其放置为受保护的文件夹，例如 App_Data 以防止直接浏览。然后创建一个可以验证用户并提供文件的“处理程序”页面。处理程序中的代码如下所示：

```
@{
    WebSecurity.RequireAuthenticatedUser();
    var file = Request["file"];
    if(Path.GetFileExtension(file).Equals(".pdf")){
        Response.ContentType = "application/pdf";
        Response.AddHeader("content-disposition", "attachment; filename=" + file);
        Response.WriteFile(Server.MapPath("~/App_Data/PDF/" + file);
    }
} 
```

在您的页面中，您只需要提供一个标准链接，但`href`应该指向处理程序并将文件名添加到查询字符串中：

```
<a href="~/handler.cshtml?file=myPdf.pdf">Click to download</a> 
```

# events - 为什么 PyQt 中的 keyPress 事件对 Enter 键不起作用？

> ID：15263063
> 
> 赞同：6
> 
> 时间：2013-03-07T04:25:14.180
> 
> 标签：events, python-3.x, pyqt4, keypress

为什么，当我按 时`Enter`，该`keyPressEvent`方法不能满足我的需要？它只是将光标移动到新行。

```
class TextArea(QTextEdit):
    def __init__(self, parent):
        super().__init__(parent=parent)
        self.setSizePolicy(QSizePolicy.Expanding, QSizePolicy.Expanding)
        self.show()

    def SLOT_SendMsg(self):
        return lambda: self.get_and_send()

    def get_and_send(self):
        text = self.toPlainText()
        self.clear()
        get_connect(text)

    def keyPressEvent(self, event):
        if event.key() == QtCore.Qt.Key_Enter: 
            self.get_and_send()
        else:
            super().keyPressEvent(event) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-10T05:49:59.017

[`Qt.Key_Enter`](http://qt-project.org/doc/qt-4.8/qt.html#Key-enum)是位于键盘上的 Enter：

```
Qt::Key_Return  0x01000004   
Qt::Key_Enter   0x01000005  Typically located on the keypad. 
```

采用：

```
def keyPressEvent(self, qKeyEvent):
    print(qKeyEvent.key())
    if qKeyEvent.key() == QtCore.Qt.Key_Return: 
        print('Enter pressed')
    else:
        super().keyPressEvent(qKeyEvent) 
```

# html - HTML5 标签在 TRidion 2011 的 RTF 字段中不起作用

> ID：15263064
> 
> 赞同：5
> 
> 时间：2013-03-07T04:25:17.537
> 
> 标签：html, tridion, tridion-2011

我遇到了 TRidion 2011 中的 RTF 字段在保存组件时删除 HTML5 标记的问题。

问题： **源代码段**

```
<div>
     <a class="arrow button" data-role="button" data-inline="true" href="www.google.com">Information</a>
</div> 
```

**Tridion 保存在片段上方**

```
<div>
     <a class="arrow button" href="www.google.com">Information</a>
</div> 
```

简而言之，Tridion 在保存组件的同时删除了 HTML5 属性。

请给出一些提示来解决上述问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-07T06:33:23.630

为此，您可以扩展 RTF 字段以允许 HTML5 标签为此您必须在文件 TcmXhtml.Config 的路径中指定这些标签

[Tridion]\web\WebUI\Core\Controls\FormatArea\TcmXhtml 。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-07T08:42:46.070

Tridion 使用 XHTML 存储富文本字段。由于您指定的属性不是有效的 XHTML，Tridion 删除了它们。

您可以修改富文本区域中允许的属性和元素列表（请参阅 Ram 的答案），但请记住，您现在允许在所有富文本字段中使用这些属性，并且您必须考虑此更改的影响到你的整个环境。如果您这样做是为了快速解决设计限制（听起来就是这样），请记住 EDITORS 也必须这样做。结构数据不一定在 RTF 中，输出的某些元素可能应该由模板处理，而不是由编辑器处理。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-01T04:50:05.527

在 \Tridion\web\WebUI\Core\Controls\FormatArea\TcmXhtml\TcmXHTML.config 文件中，将标签“drop-proprietary-attributes”更新为“false”：

发件人：drop-proprietary-attributes：true 到：drop-proprietary-attributes：false

重新启动 COM+ 并清除浏览器缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-17T13:18:05.160

要回答我的问题，请查看我们知识库中的以下条目： [http://tridion.kb.sdl.com/kb/?ArticleId=4065&source=Article&c=12&cid=19#tab:homeTab:crumb:7：艺术编号：4504](http://tridion.kb.sdl.com/kb/?ArticleId=4065&source=Article&c=12&cid=19#tab%3ahomeTab%3acrumb:7%3aartId:4504)

此外，您可以在上面文章中提到的配置文件中添加其他 HTML 5 标记。例如，如果您想阻止删除以下标签，请添加：

**new-blocklevel-tags:**文章放在画布细节 figcaption 图形页脚 header hgroup nav 输出进度部分视频 **new-inline-tags:**音频数据列表标记计摘要时间 **new-empty-tags:**命令源轨道

# unix - 使用 find 排除目录及其子目录

> ID：15263067
> 
> 赞同：0
> 
> 时间：2013-03-07T04:25:34.753
> 
> 标签：unix

我有像这样的目录结构

应用逻辑/电子邮件/FXMM

在此我有目录，需要排除资金及其子目录。当我使用此命令时，它仅排除资金而不是子直接

**找到 applicationlogic/email/FXMM -type d (!-namefunding)**

# 目录

common/common/scripts/money/implementation/money/scripts/softmoney/implementation/softmoney/application/funding/limits/funding/pilot/funding/migration/

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:36:30.260

```
find applicationlogic/email/FXMM -name "*funding*" -prune -o -type d -print 
```

基本上，`-prune`( `-name "*funding*"`) 之前的部分是对您要修剪的内容的测试；-o ( `-type d`) 之后的部分是 find 的正常测试。并且`-print`是动作。

# ruby-on-rails - find_by_sql 中的文本替换技术

> ID：15263079
> 
> 赞同：0
> 
> 时间：2013-03-07T04:26:39.680
> 
> 标签：ruby-on-rails, activerecord

Rails 有一种很好的技术，可以用`?`一个或多个对象替换 SQL 语句，例如：

`User.find_by_sql("select * from users where uid in (?)", [1,2,3])`

如何将这种技术应用于我自己的自定义查询？我检查了这个和类似方法的源代码，但找不到它。

在我的情况下，我有来自 Koala gem 的 fql_query，它不支持将对象传递给 sql 查询。我想扩展这个方法，以便它允许插入动态参数来查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:52:29.813

您可以使用`sanitize_sql_for_conditions`from [ActiveRecord::Sanitization](http://api.rubyonrails.org/classes/ActiveRecord/Sanitization/ClassMethods.html)对条件子句进行 SQL 转义。

如果您需要更一般的清理，您可以使用`quote`ActiveRecord [::ConnectionAdapters::Quoting](http://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters/Quoting.html)。

# php - php迭代ul分割

> ID：15263080
> 
> 赞同：2
> 
> 时间：2013-03-07T04:26:43.020
> 
> 标签：php, jquery, html, css, html-lists

目前，我从 MySQL 获取数据如下：

```
$catmapper = new Application_Model_Mapper_BusinessCategoryMapper();
$result = $catmapper->getBusinessCategory(); 
```

我使用`for`循环将上面的结果迭代到`<li>`标记中，如下所示：

```
$mcat = "<ul>";
for($i=0; $i<count($result); $i++){
    $mcat = $mcat . "<li class='refinecategory'><a id='refine_category_0_0' class='browse-category' href='/business/searchreviews?mct=active' rel='active'>".$result[$i]['cat_name']."</a></li>";
}
$mcat = $mcat . "</ul>"; 
```

但这会在`ul`标签内生成一个巨大的列表。如何将上述语句分成多个`ul`标签？在每个标签中，`ul`我只需要 5 个`li`标签，如果超过这个标签，另一个`ul`会生成并添加下一个标签`li`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T04:32:31.400

我会“听”什么时候`$i`可以被 5 整除，如下所示：

```
$mcat = "<ul>";
for($i=0; $i<count($result); $i++){
    if ($i % 5 == 0 && $i > 0) {
        $mcat .= "</ul><ul>";
    }
    $mcat .= "<li class='refinecategory'><a id='refine_category_0_0' class='browse-category' href='/business/searchreviews?mct=active' rel='active'>".$result[$i]['cat_name']."</a></li>";
}
if ($i % 5 != 0) {
    $mcat .= "</ul>";
} 
```

这应该会导致您的列表每 5 个项目拆分一次。我还没有测试过，所以如果你碰巧在你有一个完全可被 5 个项目整除的情况下创建了一个额外的列表，你应该`if (($i-1) % 5 != 0) {`为最后一个`if`语句做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T04:33:19.793

尝试在循环的每 5 次迭代中使用 MOD 运算符来做一些特别的事情。

```
$mcat = "<ul>";
for($i=0; $i<count($result); $i++){
$mcat = $mcat . "<li class='refinecategory'><a id='refine_category_0_0' class='browse-category' href='/business/searchreviews?mct=active' rel='active'>".$result[$i]['cat_name']."</a></li>";
if($i % 5){
$mcat = $mcat . "</ul><ul>";
}
}
$mcat = $mcat . "</ul>"; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-07T04:31:39.277

将以下代码与 mod 一起使用

```
$mcat = "<ul>";
for($i=0; $i<count($result); $i++){
    if($i%5 == 0  && $i > 0) {
        $mcat .= "</ul><ul>";
    } else {
        $mcat = $mcat . "<li class='refinecategory'><a id='refine_category_0_0' class='browse-category' href='/business/searchreviews?mct=active' rel='active'>".$result[$i]['cat_name']."</a></li>";
    }
}
$mcat = $mcat . "</ul>"; 
```

# visual-studio - VS 2012 和 windows 2008 服务器企业版

> ID：15263082
> 
> 赞同：1
> 
> 时间：2013-03-07T04:26:58.167
> 
> 标签：visual-studio, windows-server-2008

当我尝试在 Windows Server 2008 Enterprise 上安装 Visual Studio 2012 时，我收到来自安装程序的错误消息。

```
 You must upgrade or update Operating Systems to the latest Service Pack using Window Update to meet the requirement before installing this products.
  For Windows 8, this product is not compatible with pre-released versions of Windows 8\. Please upgrade to latest release version of Windows 8.
  This computer does not meet the setup requirements. For more information, see the readme.
  http://go.microsoft.com/fwlink/?LinkId=255962 
```

我已经在操作系统上安装了每个更新。我该怎么做才能安装 VS2012 Ultimate ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T09:29:37.217

微软明确表示Visual Studio 2012仅支持4个Windows版本，Windows Server 2008（非R2）不合格，

> *   Windows 7 SP1（x86 和 x64）
> *   Windows 8（x86 和 x64）
> *   Windows Server 2008 R2 SP1 (x64)
> *   Windows 服务器 2012 (x64)

[http://www.microsoft.com/visualstudio/eng/products/visual-studio-ultimate-2012#product-edition-ultimate-requirements](http://www.microsoft.com/visualstudio/eng/products/visual-studio-ultimate-2012#product-edition-ultimate-requirements)

我相信错误消息中包含的链接也可以引导您访问此信息。

因此，停止徒劳的战斗并尝试制造合格的机器。

# r - 在 R 中输出 FALSE 而不是错误

> ID：15263094
> 
> 赞同：0
> 
> 时间：2013-03-07T04:28:31.423
> 
> 标签：r, error-handling, matrix

我想做的是使用 R 中的命令 chol() 测试矩阵是否为正定矩阵。但是，如果 chol() 命令产生错误，我希望它输出 false 而不是产生错误并停止代码从运行。是否有捷径可寻？我一直在搞乱命令 try() 但它仍然给我一个错误。例如，如果我有矩阵：

```
mat=matrix(c(1,2,3,1,2,3,5,5,5),nrow=3,ncol=3,byrow=F)
try(chol(mat)) 
```

这仍然会产生错误“chol.default(mat) 中的错误：3 阶的前导次要不是正定的。”

我怎样才能让它产生 FALSE 而不是这个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T04:30:41.713

使用`tryCatch`, 并定义一个处理程序以在发生错误时使用：

```
tryCatch(chol(mat), error=function(e) FALSE) 
```

# java - 以编程方式控制 Skype 或 Google+ 客户端发起视频通话

> ID：15263095
> 
> 赞同：1
> 
> 时间：2013-03-07T04:28:37.377
> 
> 标签：java, python, skype, skype4py, skype4java

有没有办法用 Python、C/C++ 或 Java 编写程序，甚至是 Web 编程来向联系人列表中的某个人发起 Skype/Google+ 环聊视频通话？（即我想以编程方式启动 Skype 视频通话）

有没有人这样做过或知道任何我可以开始的例子？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T04:35:08.700

请参考[URI 方案](http://en.wikipedia.org/wiki/URI_scheme)

您可以使用`callto:`或`skype:`启动 Skype 并拨打特定号码。享受 ：-）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T07:53:55.610

来自[Skype API 参考](http://dev.skype.com/skype-uri/reference#uriCallVideoExplicit)：

```
skype:participant1[;participant2;...participant9]?call&video=true 
```

# java - 发送实时流数据时套接字连接丢失

> ID：15263100
> 
> 赞同：0
> 
> 时间：2013-03-07T04:28:55.517
> 
> 标签：java, android, sockets, voip, serversocket

我在这里挣扎...

我正在尝试确定数据是否已使用该`OutputStream`对象通过 TCP 套接字成功发送到服务器。用于测试模拟器套接字通信在 30 秒后丢失。对于写入数据`OutputStream.write();`，它不会抛出异常，并且本地服务器连续运行它不会崩溃，一段时间后只有 tcp 套接字连接丢失。套接字类中的所有方法都返回，就好像套接字处于活动状态并且正在工作一样。我在这里做错了什么吗？当流/套接字实际上没有在缓冲区中发送数据时，是否有任何套接字实现或流实现可以用来获取异常或错误？在套接字上设置`setSoTimeout()`似乎也没有做任何事情。

请指导我...

这是我的代码：

```
private void sendRec() {
    int lstream;
    int port = 1012;
    byte[] byterecv = new byte[1040];

    while (true) {
        System.out.println("POOL-2");
        synchronized (recSendThread) {
            try {
                recSendThread.wait(20);
            } catch (InterruptedException e) {
            }
        }

        if (stopcall == true) {
            // break;
        }

        try {
            // Provides a client-side TCP socket
            Socket clientRec = new Socket();

            // serverSocket = new ServerSocket(port);
            // serverSocket.setSoTimeout(5000);

            // Connects this socket to the given remote host address and
            // port
            clientRec.connect(new InetSocketAddress("192.168.1.36", port));

            System.out.println("Just connected to "
                    + clientRec.getRemoteSocketAddress());
            System.out.println("SENTS Rec BEFORE");

            // output streams that write data to the network
            OutputStream outToServerRec = clientRec.getOutputStream();
            DataOutputStream outStreamRec = new DataOutputStream(
                    outToServerRec);

            outStreamRec.write(bData);
            System.out.println("SENTS Rec AFTER");

            // input streams that read data from network
            InputStream inFromServerRec = clientRec.getInputStream();
            // clientRec.setSoTimeout(5000);
            DataInputStream inStreamRec = new DataInputStream(
                    inFromServerRec);
            while ((lstream = inStreamRec.read(byterecv)) != -1) {
                System.out.println("startrec bytearray -- "
                        + byterecv.length);
                bos1.write(byterecv, 0, lstream);
            }

            inStreamRec.close();// for closing dataouputstream
            clientRec.close();// for closing socket connection
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

Here is my receiver and player code..

  /**
   * start receiving the voice data from server
   * */
       protected void startplay() {
    System.arraycopy(frndid, 0, playByteData, 0, 4);
    System.arraycopy(userid, 0, playByteData, 4, 4);

        ByteBuffer.wrap(sessionid).order(ByteOrder.LITTLE_ENDIAN).asIntBuffer().
            put(call_sessionid);
    System.arraycopy(sessionid, 0, playByteData, 8, 4);
    int lstream;
    int port = 1014;
    while (true) {
        System.out.println("POOL-3");
        try {
            if (stopcall == true) {
                System.out.println("BREAKEDDDD1111");
                //break;
            }
            // Host name
            // port++;
            InetAddress addressPlay = InetAddress.getByName("192.168.1.36");
            // Creates a new streaming socket connected to the target host
            Socket clientPlay = new Socket(addressPlay, port);
            System.out.println("Just connected to play : " + 
                                                clientPlay.getRemoteSocketAddress());
            System.out.println("SENTS Play BEFORE");

            // output streams that write data

            OutputStream outToServer = clientPlay.getOutputStream();
            DataOutputStream outStreamPlay = new DataOutputStream(outToServer);
            outStreamPlay.write(playByteData);

            System.out.println("SENTS Play after");

            // input streams that read data
            InputStream inFromServerPlay = clientPlay.getInputStream();
            DataInputStream inStreamPlay = new DataInputStream(inFromServerPlay);
            //clientPlay.setSoTimeout(5000);
            while ((lstream = inStreamPlay.read(byteArray)) != -1) {
                System.out.println("startplay() bytearray -- " + 
                                                          byteArray.length);
                bos.write(byteArray, 0, lstream);
            }

            inStreamPlay.close();
            clientPlay.close();// for closing play socket connection

            responseBuffer = bos.toByteArray();
            System.out.println("BAOSSIZE " + bos.size());
            bos.reset();
            bos.flush();
            bos.close();
            playing = true;
            System.out.println("res length -- " + responseBuffer.length);
            rcvbb=ByteBuffer.wrap(responseBuffer).order(ByteOrder.LITTLE_ENDIAN).
                                                    asShortBuffer().get(playShortData);

              playVoiceReceived();// plays received data

            } catch (ParseException e) {
            e.printStackTrace();
            } catch (IOException e) {
            e.printStackTrace();
        }
    }
    }

  /**
   * start playing received the voice data from server
    * */
     public void playVoiceReceived() {

    System.out.println("POOL-4");
      try {
        if (at != null) {
            if (at.getPlayState() != AudioTrack.PLAYSTATE_PLAYING) {
                at.play();// starts playing
            } else {
                System.out.println("Play BEFORE WRITE");
                // Writes the audio data to the audio hardware for playback.
                at.write(playShortData, 0, BufferElements2Play);
                System.out.println("Play AFTER WRITE");
                at.flush();
            }
        }
          } catch (Exception e) {
        e.printStackTrace();
      }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:55:30.640

套接字*已将*数据发送到本地套接字发送缓冲区。之后发生的事情取决于本地 TCP 堆栈、网络、远程 TCP 堆栈和远程应用程序。如果您想知道远程应用程序是否获得了数据，它必须向您发送回复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T04:55:49.360

运营商`write`不检查数据是否已交付，否则将不得不等待太长时间。如果网络连接确实断开了，操作系统的 TCP 层无论如何都会尝试发送数据，但会在稍晚（即 1 分钟后）检测到问题，因为它不会收到对方的确认消息。然后它将尝试多次重新发送数据，看到问题仍然存在，然后才会报告套接字上的异常情况。要知道套接字处于异常状态，您需要对套接字执行一些操作，即再次尝试写入。尝试在这样的循环中写入：

while (true) { outStreamRec.write (data); Thread.sleep (1000L); }

它应该在网络关闭后大约 2 分钟抛出错误。

注意，与`write`操作相反，操作`connect`是同步的，所以它实际上是在等待对面的响应，如果没有响应，就会抛出异常。

# python - Django-Registration：如何防止登录用户注册？

> ID：15263102
> 
> 赞同：0
> 
> 时间：2013-03-07T04:29:01.417
> 
> 标签：python, django, django-registration

我刚刚开始使用 django-registration。我有两个问题：

1.  如何防止登录用户进入注册页面？

2.  激活后如何自动登录用户？

我不喜欢更改应用程序本身的任何代码。

对于问题 2，我已经阅读了文档，其中说要编写“一个侦听适当信号的函数；您的函数应将用户的后端属性设置为正确的身份验证后端，然后调用 django.contrib.auth .login() 让用户登录。” 我不太了解 django，无法理解这意味着什么或如何实现它。你们能帮我/指出正确的方向吗？

编辑：

尝试做一些信号，还不行，不知道出了什么问题：

```
def loginActivationCallback(sender, user, request, **kwargs):
    print user
    print "registered"

user_registered.connect(loginActivationCallback) 
```

另外因为我使用的是 Django 1.5，所以我没有做 pip install django-registration（不完全支持 1.5），而是将注册文件夹复制到我的项目中。不确定这是否会影响信号。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:01:48.893

您可以做的就是检查您的注册视图

```
 if request.user.is_authenticated:
     #redirect user to the profile page 
     return HttpResponseRedirect('/profile/') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:02:11.030

```
from registration.signals import user_activated

def login_user(sender, user, request, **kwargs):
    user.backend='django.contrib.auth.backends.ModelBackend' 
    login(request,user)
user_activated.connect(login_user) 
```

# .htaccess - .htaccess 重写规则 - 自定义结构

> ID：15263106
> 
> 赞同：2
> 
> 时间：2013-03-07T04:29:29.933
> 
> 标签：.htaccess, mod-rewrite, rewrite

是否可以创建一个 .htaccess 规则，它将占据 URL 结构的中间，但恢复正常的 REQUEST_URL （对不起，我的糟糕解释）

以这个 URL 为例 /boats/283/manage/water

现在假设我根据 URL 结构保持层次结构标准化，减去 ID（本例中的 ID 为 287） - 所以实际的脚本位置是 /boats/manage/water(.php)

但显然我不必为每一页都设置手动规则，因为那样会变得乏味。

例如（我想避免每页）。

```
RewriteRule ^boats/(\d+)/manage/water$ ./boats/manage/water.php?id=$1  
RewriteRule ^boats/(\d+)/manage/bacon$ ./boats/manage/bacon.php?id=$1 
```

毫无疑问，我可以在 Google 中找到相关的内容，但我就是想不出合适的关键字。

任何帮助/推动正确的方向都非常感谢:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:50:26.880

你可以试试：

```
# group out the first path, the ID, then the rest
RewriteCond %{REQUEST_URI} ^/([^/]+)/(\d+)/(.*)$
# pre-check that the destination php file actually exists
RewriteCond %{DOCUMENT_ROOT}/%1/%3.php -f
# rewrite
RewriteRule ^ /%1/%3.php?id=%2 [L] 
```

# android - 如何渲染 ArrayList 从 onPreExecute() 中的 AsyncTask 获得？

> ID：15263108
> 
> 赞同：1
> 
> 时间：2013-03-07T04:30:00.910
> 
> 标签：android, json, arraylist, android-asynctask, android-imageview

我是新来的，从事 Android 开发。

我正在尝试使用`ViewPager`.

这是我的主要活动：

```
public class HomeActivity extends AbstractActivity {

    ArrayList<ImageView> imagens = new ArrayList<ImageView>();
    ViewPager slideshow;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_home);

        slideshow = (ViewPager) findViewById(R.id.slideshow);

        // inicia a task json
        new aTask(this).execute();
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_home, menu);
        return true;
    }

    public void getResult(String result) {
        Gson gson = new Gson();
        Home home = gson.fromJson(result, Home.class);

        imagens = new ArrayList<ImageView>();

        for (Webdoor webdoor : home.webdoors) {
            try {
                ImageView img = new ImageView(getApplicationContext());
                Bitmap bitmap = BitmapFactory
                        .decodeStream((InputStream) new URL(webdoor.imagem)
                                .getContent());
                img.setImageBitmap(bitmap);

                imagens.add(img);
            } catch (MalformedURLException e) {
                e.printStackTrace();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    private class aTask extends AsyncTask<Void, Void, ArrayList<ImageView>> {

        private HomeActivity homeActivityRef;

        public aTask(HomeActivity homeActivity) {
            this.homeActivityRef = homeActivity;
        }

        // inicio da task
        @Override
        protected void onPreExecute() {
        }

        // execução da tarefa em background
        @Override
        protected ArrayList<ImageView> doInBackground(Void... params) {
            RestTemplate restTemplate = new RestTemplate();
            restTemplate.getMessageConverters().add(
                    new StringHttpMessageConverter());
            String result = restTemplate.getForObject(
                    "http://api.modahub.com.br/home", String.class,
                    "SpringSource");

            Gson gson = new Gson();
            Home home = gson.fromJson(result, Home.class);

            ArrayList<ImageView> imagens = new ArrayList<ImageView>();

            for (Webdoor webdoor : home.webdoors) {
                try {
                    ImageView img = new ImageView(getApplicationContext());
                    Bitmap bitmap = BitmapFactory
                            .decodeStream((InputStream) new URL(webdoor.imagem)
                                    .getContent());
                    img.setImageBitmap(bitmap);

                    imagens.add(img);
                } catch (MalformedURLException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }
            }

            publishProgress(); // invoca o onProgressUpdate()
            return imagens;
        }

        // callback invocado pelo publishProgress()
        @Override
        protected void onProgressUpdate(Void... values) {
        }

        // callback executado no final da task
        @Override
        protected void onPostExecute(ArrayList<ImageView> aImagens) {
            // This variable aImagens is full of images!
            // How I put this on the screen =(
        }
    }
} 
```

如何使`ImageView`s in列表`onPostExecute()`在屏幕上呈现？我需要 a`Fragment`还是 a `Loader`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:43:41.250

如果您想在 ViewPager.than 中将 ImageGallery 制作成 ImageView 中的所有图像绑定在一个适配器中，您可以在 View pager 中绑定适配器，请参阅[链接](https://stackoverflow.com/questions/13618447/how-to-do-pinching-zoom-and-swipe-on-multiple-imageview-in-android/13643000#13643000)

# apache - 如何将 apache2 配置到端口 80 以外的端口？

> ID：15263109
> 
> 赞同：-1
> 
> 时间：2013-03-07T04:30:12.380
> 
> 标签：apache, ubuntu, port

我已经在 ubunto 上安装了apache2，**并且****弄乱**了 localhost 页面上的文本。现在我被要求显示它在**端口 80**以外的端口上运行。我怎么做？

 ***** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:34:37.447

`Listen x`您应该更改端口号`httpd.conf`所在的行。`x`之后，您需要重新启动 apache 服务器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:04:03.820

在文件中：`/etc/apache2/httpd.conf`

更改以下行：

```
Listen 80 
```

至：

```
Listen <NEWPORT> 
```

之后，您需要重新启动 apache 服务器：

```
sudo service apache2 start 
```

**更新：**看起来像 Ubuntu，默认`/etc/apache2/httpd.conf`为空，推荐的方法是在下面创建一个新`.conf`文件，`/etc/apache2/conf.d`这样即使有软件更新，用户更改也是持久的。

所以只需创建一个新文件说`/etc/apache2/conf.d/mycustomizations.conf`

```
Listen <NEWPORT> 
```****

# javascript - 带有 AngularJS 回调的 Google OAuth2 登录

> ID：15263114
> 
> 赞同：11
> 
> 时间：2013-03-07T04:30:47.767
> 
> 标签：javascript, angularjs, google-api, oauth-2.0, google-oauth

作为参考，这是我正在使用的 Google+ 流程：

[https://developers.google.com/+/web/signin/server-side-flow](https://developers.google.com/+/web/signin/server-side-flow)

> 1.  用户单击登录按钮。授权请求被发送到 Google 的 OAuth 服务器
> 2.  为用户触发 OAuth 对话框
> 3.  access_token、id_token 和一次性代码被返回
> 4.  客户端向服务器发送 id_token 和代码
> 5.  服务器为 access_token 交换一次性代码
> 6.  谷歌返回 access_token
> 7.  服务器应向客户端确认“完全登录”

我已经大部分时间都在工作，但我希望 AngularJS 在步骤 7 中知道客户端何时“完全登录”。

理想情况下，我希望第 3 步由 AngularJS 控制器处理，但我不确定这是否可能。

登录按钮在这里：

[https://developers.google.com/+/web/signin/server-side-flow#step_4_add_the_sign-in_button_to_your_page](https://developers.google.com/+/web/signin/server-side-flow#step_4_add_the_sign-in_button_to_your_page)

```
<!-- Add where you want your sign-in button to render -->
<div id="signinButton">
  <span class="g-signin"
    data-scope="https://www.googleapis.com/auth/plus.login"
    data-clientid="YOUR_CLIENT_ID"
    data-redirecturi="postmessage"
    data-accesstype="offline"
    data-cookiepolicy="single_host_origin"
    data-callback="signInCallback">
  </span>
</div>
<div id="result"></div> 
```

data-callback 参数允许我指定一个函数，但我只能让它在全局函数上工作。

我能想到的唯一解决方法是 AngularJS 不断地轮询服务器以防万一用户登录，但我想知道是否有办法在事件结构中使这项工作成为即时的。

无论这是否可能，我都会非常感谢任何关于我应该如何去做的建议。请让我知道，如果你有任何问题。谢谢你！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-07T20:36:13.390

经过一堆搜索，我终于在这里找到了我需要的东西：

[https://developers.google.com/+/web/signin/#javascript_api](https://developers.google.com/+/web/signin/#javascript_api)

我无法使用数据属性来完成我需要的事情。我需要使用 javascript API 手动呈现按钮。

# jenkins - pexpect 是子流程的正确工具吗？

> ID：15263117
> 
> 赞同：0
> 
> 时间：2013-03-07T04:31:10.303
> 
> 标签：jenkins, hudson, pexpect, installanywhere

我们有一个 app.exe，它使用另一个 3rd 方安装向导应用 InstallAnywhere 来安装我们的应用程序。它是一个基于文本的向导 - 意味着当父 shell 中的 app.exe -i console 执行时，会产生一个新的 shell（并且子进程正在执行一些 java.exe 以使其向导步骤工作）。

在这种情况下 pexpect 可以用作一种问答互动吗？我们用 Hudson 进行了尝试，但似乎 Hudson 只能监视父进程而不能监视其子进程。当 Hudson 作业启动 python 脚本时，它会启动，但无法在向导的第 1 步开始 - 它挂起。

我们怎样才能克服这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T02:47:12.427

如果我没看错，您想在 Hudson 作业期间与正在执行的安装程序（在本例中使用 pexpect）进行交互，可能是为了进行自动化测试。

我在想，如果你从一个 shell 脚本（或批处理文件）调用 expect，expect*可能*会让你到达你想去的地方，而这个 shell 脚本又是从 Hudson 运行的。该脚本将使用您最喜欢的期望风格执行测试，在此期间它要么成功退出，要么失败。Hudson 会检测到故障，然后您可以做出相应的反应。您的脚本和任何预期消息将写入标准输出，Hudson 会将其收集到您的构建日志中。

但是，[Flexera](http://www.flexerasoftware.com/)有一个测试框架，允许您通过 JUnit 测试安装程序。看看[这个页面的底部](http://helpnet.flexerasoftware.com/installanywhere2012/Content/helplibrary/ia_ref_custom_code_apis.htm)。或者查看[JavaDocs](http://helpnet.flexerasoftware.com/InstallAnywhereAPI/IA2012/gui-test-auto/javadocs/index.html)。

这可能比预期的黑客更精确。您甚至可以编写一个 Hudson 插件并完全使用 expect 和 shell 脚本。

更新：查看 Javadocs 后，我发现主类[GUIAutomationFixture](http://helpnet.flexerasoftware.com/InstallAnywhereAPI/IA2012/gui-test-auto/javadocs/index.html)使用 Java 的[Robot](http://docs.oracle.com/javase/6/docs/api/java/awt/Robot.html)类。这意味着您可能无法在无头服务器上运行此类。您可能需要 Windows 或带有工作 X 系统的 Linux/Unix 机器。

# jquery - 简单的 jQuery ajax 调用不适用于 rails

> ID：15263118
> 
> 赞同：0
> 
> 时间：2013-03-07T04:31:15.637
> 
> 标签：jquery, ruby-on-rails-3.2

我是 Rails 的新手，我试图纠正 application.js 中非常简单的 ajax 调用。

这是代码：

```
function login(loginUrl) {
    alert(loginUrl);

    $.ajax('http://www.w3schools.com/jquery/demo_test.txt', {success: function (result) {
        alert(result);
    }});
} 
```

调用该函数时，第一个警报运行良好。但是，似乎以下 ajax 调用永远不会通过，并且第二个警报永远不会执行。我在 w3school.com 上尝试了代码，它运行良好。我真的很困惑为什么这个简单的代码不适用于 Rails。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:36:57.810

这是因为名为[Same Origin Policy](http://en.wikipedia.org/wiki/Same_origin_policy)的浏览器限制。它可以防止 javascript 将 ajax 请求发送到与其加载位置不同的域。

在您的情况下，您正在尝试访问托管在但发送请求的页面不是来自同一个域的资源（ [http://www.w3schools.com/jquery/demo_test.txt](http://www.w3schools.com/jquery/demo_test.txt)`http://www.w3schools.com` ） ，这就是ajax请求不起作用的原因.

如果您查看浏览器的控制台，您可能会看到同样的错误。

同源策略的一个解决方案是使用[jsonp](http://en.wikipedia.org/wiki/JSONP)（[JSONP 到底是什么？](https://stackoverflow.com/questions/2067472/what-is-jsonp-all-about)），但约束是服务器应该支持 jsonp。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T06:37:52.820

用你的替换' [http://www.w3schools.com/jquery/demo_test.txt](http://www.w3schools.com/jquery/demo_test.txt) '`loginUrl`

# ruby-on-rails - eventSource 如何与 Rails 一起使用？

> ID：15263119
> 
> 赞同：2
> 
> 时间：2013-03-07T04:31:22.743
> 
> 标签：ruby-on-rails, html, websocket

我在[这里](http://www.w3schools.com/html/html5_serversentevents.asp)阅读 HTML5 中的新内容之一。

有 PHP 和 ASP 的示例，这如何与 Rails 一起工作，实际上，这到底是如何工作的？

在哪里指定接收数据的客户端？

这是 WebSockets 的替代品吗？

# c++ - 通过 sigsetjmp 和 longsetjmp 恢复环境

> ID：15263128
> 
> 赞同：2
> 
> 时间：2013-03-07T04:32:35.690
> 
> 标签：c++, context-switch

我使用 sigsetjmp 和 singlongjmp 和 SIGALARM 来中断系统调用，如下代码所示

```
//data of Alarm_interrupter
void (TClass::*fpt)(const char*);   // pointer to member function
TClass* pt2Object;                  // pointer to object
===================================================
//for timeout processing
static sigjmp_buf jmpbuf;
static void recvfrom_alarm(int) {
    siglongjmp(jmpbuf, 1);
}
======================================================
void Alarm_interrupter::start_timeout() {
    signal(SIGALRM, recvfrom_alarm);
    alarm(timeout);
    (*pt2Object.*fpt)("timeouted before sigsetjmp"); //this call works OK
    if (sigsetjmp(jmpbuf,1) != 0) {
        //at this point, pt2Object is still OK,
        //but fpt seems to point to nothign.
        (*pt2Object.*fpt)("timeouted after sigsetjmp");
    }
    return;
}
============================================================== 
```

在 sigsetjmp 返回 1 之前，使用对象和方法指针的调用：*pt2Object.*fpt("timeouted before sigsetjmp") 是可以的，但是在 sigsetjmp 返回 1 之后，此调用失败。检查变量的状态后，我注意到对象指针“pt2Object”仍然可以，但方法指针“fpt”似乎有所不同。

我认为造成这种情况的一个可能原因是 sigsetjmp 无法恢复整个早期环境，其中包括方法指针“fpt”。

你们能帮我解决这个问题吗？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:37:08.573

正如 Potatoswatter 指出的那样，使用警报来延迟`longjmp`它太聪明了，不能依赖。您必须先调用“sigsetjmp”。在您尝试返回那里*之前*，它必须发生。

唯一可行的方法`sigsetjmp`是`setjmp`遵循这个伪代码。

```
if (sigsetjmp(...) != 0) {
    //  Error handling code
}
// code that might call siglongjmp to bail out to Error handling code 
```

你看，它必须执行一次才能执行上下文的保存。这将初始化`jmpbuf`. 如果您在执行之前`longjmp`没有调用就调用`setjmp`，则无法预测行为。

此外，`longjmp`它往往会消除您可能尝试使用的任何局部变量。

```
int var = 3;
var = 2;
if (sigsetjmp(...) != 0) {
    //  Error handling code
    printf("%d", var); // could print 2, 3 or even "potato". Local vars get trashed.
}
// code that might call siglongjmp to bail out to Error handling code 
```

所以你真的想做*之后*的所有有趣的事情`*setjmp`。

```
int var = 3;
if (sigsetjmp(...) != 0) {
    //  Error handling code
    var = 2;
    printf("%d", var); // now you know it's 2
}
// code that might call siglongjmp to bail out to Error handling code 
```

对于它在整个世界中生存的任何希望`*longjmp`，它都需要被标记`volatile`。

```
volatile int var = 3;
var = 2;
if (sigsetjmp(...) != 0) {
    //  Error handling code
    printf("%d", var); // probably 2
}
// code that might call siglongjmp to bail out to Error handling code 
```

甚至这可能还不够。它可能需要称为 sigatomic_t 或类似的东西。但尽量不要需要这样疯狂的东西。

```
int var = 3;
memcpy(var, (int *){2}); //memcpy is pretty reliable (C99ism: immediate pointer))
if (sigsetjmp(...) != 0) {
    //  Error handling code
    printf("%d", var); // probably 2
}
// code that might call siglongjmp to bail out to Error handling code 
```

# windows-phone-8-emulator - 如何在 wp8 模拟器中使用静态 ip 工作互联网？

> ID：15263129
> 
> 赞同：4
> 
> 时间：2013-03-07T04:32:41.797
> 
> 标签：windows-phone-8-emulator

我的 WP8 模拟器无法访问互联网。我无法在 WP8 模拟器中的 Internet Explorer 中打开任何网站。我的问题与下面的链接完全相同：[https](https://superuser.com/questions/504189/no-internet-access-on-wp8-emulator-despite-working-connection-in-win8.I) : //superuser.com/questions/504189/no-internet-access-on-wp8-emulator-despite-working-connection-in-win8。我在我的窗口中使用静态 IP 8系统

# iphone - 更改子 UIView 背景颜色

> ID：15263140
> 
> 赞同：0
> 
> 时间：2013-03-07T04:33:57.493
> 
> 标签：iphone, ios6, xcode4.5, background-color

我正在尝试`ViewController`使用此方法在我的中添加子视图

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    addCourse = [[UIView alloc]init];
    addCourse.backgroundColor = [UIColor redColor];
    [addCourse.layer setCornerRadius:50.0f];
    [addCourse.layer setMasksToBounds:YES];
} 
```

`addCourse`我的在哪里，`subview`但背景颜色仍然是白色。我正在使用`storyboard`并添加`subview`它并将视图链接到`viewcontroller`我确实编写了 IBOutlet 和属性并合成但我仍然找不到更改背景颜色的方法。

我怎样才能改变它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:38:46.920

`addCourse`如我所见，您尚未添加到视图控制器中。将您的`viewDidLoad`方法替换为：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    addCourse = [[UIView alloc]init];
    addCourse.backgroundColor = [UIColor redColor];
    [addCourse.layer setCornerRadius:50.0f];
    [addCourse.layer setMasksToBounds:YES];
    //ADDED THIS LINE
    self.view = addCourse;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:07:21.527

```
addCourse = [[UIView alloc]initWithFrame:CGRectMake(x, y, w, h)];
addCourse.backgroundColor = [UIColor redColor];
[addCourse.layer setCornerRadius:50.0f];
[addCourse.layer setMasksToBounds:YES];

[self.view addSubview:addCourse]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:30:49.363

如果您已经与 ViewController 链接，那么您只需从代码中删除以下行

```
addCourse = [[UIView alloc]init]; 
```

因为，它创建了您的 subView 的新实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T05:39:31.753

看到我已经更新了你的代码（只是你需要设置视图的框架），我得到了结果

请！以这种方式更新您的代码

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    //custom view
    UIView *addCourse = [[UIView alloc]init];
    CGRect myViewframe = CGRectMake(10.0f, 90.0f, 100.0f, 100.0f);
    addCourse.frame=myViewframe;
    addCourse.backgroundColor = [UIColor redColor];
    [addCourse.layer setCornerRadius:50.0f];
    [addCourse.layer setMasksToBounds:YES];

    [self.view addSubview:addCourse];
} 
```

这是结果屏幕

![在此处输入图像描述](../Images/bff3ed3958ddc8bf6ae8623607544671.png)

# jquery - 带有 jQ BootStrapValidator 的 Grails formRemote

> ID：15263142
> 
> 赞同：1
> 
> 时间：2013-03-07T04:34:11.163
> 
> 标签：jquery, ajax, forms, grails

我正在使用通过 Grails < formRemote > 标签提交的简单表单。这工作正常且符合预期。最近我将**jqbootstrapvalidaton** .js 添加到我的项目中，以便在我的简单表单上添加一些验证。执行此操作并在我的表单上按提交时，表单现在将为已**定义的每个单个元素**发布（例如，如果我有 5 个表单元素，当我在使用 Grails 的 formRemote 和 jqBootstrapvalidation 时按提交时，我将收到 5 个 POST 提交）。

例如，请考虑以下形式：

```
<g:formRemote  name="sampleForm" url="[controller: 'test', action: 'demo']" >

<input type="text" name="myy" id="myy" value=""  required />
<input type="text" name="myo" id="myo" value="" required />

<input type="submit" name="submit" value="Submit" />

</g:formRemote> 
```

如您所见，表单有 2 个输入变量和 1 个提交按钮。通常（当不使用**jqbootstrapvalidaton**时），我可以提交此表单，它会向我的控制器发布一次**。**

但是，自从将**jqbootstrapvalidaton**引入这个简单的表单后，当我单击提交时，我收到了 3 个 POST 提交。

我页面上唯一的其他代码是：

```
$(function () {
  $("input,select,textarea").not("[type=submit]").jqBootstrapValidation();
} 
```

我用它来设置验证。

有没有人经历过类似的事情？关于如何让这个表单只发布一次，而不是为每个表单元素发布的任何建议**都会**很棒！

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T07:52:36.760

您必须使用 jqBootstrapValidation 本身通过 ajax 提交表单。如果没有任何错误，它有一个提交表单的方法。示例代码如下：

```
$(function () { $("input,select,textarea").not("[type=submit]").jqBootstrapValidation({

    preventSubmit: false,
     submitSuccess: function (form, event) {
         event.preventDefault();
         dosubmit(form);///your javascript function to submit
     },
     submitError: function (form, event, errors) {
         event.preventDefault();
         }
    }); } ); 
```

# r - 恢复列表结构

> ID：15263146
> 
> 赞同：23
> 
> 时间：2013-03-07T04:34:41.773
> 
> 标签：r, list

# 目标

**给定一个列表列表，我的目标是反转它的结构**（R 语言）。

所以，我想把嵌套列表的元素变成第一层列表的元素。

可能一个例子更好地说明了我的目的。鉴于：

```
z <- list(z1 = list(a = 1, b = 2, c = 3), z2 = list(b = 4, a = 1, c = 0)) 
```

我想要一个等效于后续 R 对象的输出：

```
o <- list(a = list(z1 = 1, z2 = 1), b = list(z1 = 2, z2 = 4), c = list(z1 = 3, z2 = 0)) 
```

# 解决方案

## 我的解决方案

我创建了自己的解决方案，我附在下面，但如果有更好的，请告诉我。

```
revert_list_str_1 <- function(ls) {
  res <- lapply(names(ls[[1]]), function(n, env) {
    name <- paste(n, 'elements', sep = '_')
    assign(name, vector('list', 0))
    inner <- sapply(ls, function(x) {
      assign(name, c(get(name), x[which(names(x) == n)]))
    })
    names(inner) <- names(ls)

    inner
  })
  names(res) <- names(ls[[1]])

  res
} 
```

执行`str(revert_list_str_1(z))`我得到后续的输出，对应我想要的。

```
List of 3
 $ a:List of 2
  ..$ z1: num 1
  ..$ z2: num 1
 $ b:List of 2
  ..$ z1: num 2
  ..$ z2: num 4
 $ c:List of 2
  ..$ z1: num 3
  ..$ z2: num 0 
```

但正如我所说**，我想调查（并了解）一个更优雅和动态的解决方案的存在**。

事实上**，我的解决方案只有在所有嵌套列表都具有相同名称**（也以不同顺序）的情况下才能完全工作。这是因为`names(ls[[1]])`. 我还要指出，它只对 2 个级别的列表起作用，就像报告的那样。

那么，您知道其他更具动态性的解决方案吗？`rapply`和/或`Filter`函数对这项任务有用吗？

*结束编辑1。*

## 建议解决方案的分析

我已经对建议的解决方案进行了一些分析，*谢谢大家！*. 分析包括验证所有功能的以下几点：

1.  接受的类（嵌套列表元素）
    1.  如果存在具有不同类型的元素（如果它们是原子的），则类型也会保留
    2.  保留的元素中包含的对象（例如矩阵）
2.  考虑的列（对于列，我指的是嵌套列表的名称）
    1.  不常见的列被忽略（**在这种情况下，分类“不”被积极理解**）
    2.  保留不常见的列
    3.  当列不匹配时它也有效（仅基于第一个嵌套列表的名称）

在所有这些情况下**，除了第 2.1 点之外，“是”的分类都被积极理解**。

这是我考虑过的所有**功能（****评论与上面提到的分析项目有关**）：

```
# yes 1.1
# yes 1.2
# yes 2.1, not 2.2, not 2.3
revert_list_str_1 <- function(ls) { # @leodido
    # see above
}

# not 1.1
# not 1.2
# not 2.1, not 2.2, not 2.3
revert_list_str_2 <- function(ls) { # @mnel
  # convert each component of list to a data.frame
  # so rbind.data.frame so named elements are matched
  x <- data.frame((do.call(rbind, lapply(ls, data.frame))))
  # convert each column into an appropriately named list
  o <- lapply(as.list(x), function(i, nam) as.list(`names<-`(i, nam)), nam = rownames(x))

  o
}

# yes 1.1
# yes 1.2
# yes 2.1, not 2.2, yes 2.3
revert_list_str_3 <- function(ls) { # @mnel
  # unique names
  nn <- Reduce(unique, lapply(ls, names))
  # convert from matrix to list `[` used to ensure correct ordering
  as.list(data.frame(do.call(rbind,lapply(ls, `[`, nn))))
}

# yes 1.1
# yes 1.2
# yes 2.1, not 2.2, yes 2.3
revert_list_str_4 <- function(ls) { # @Josh O'Brien
  # get sub-elements in same order
  x <- lapply(ls, `[`, names(ls[[1]]))
  # stack and reslice
  apply(do.call(rbind, x), 2, as.list) 
}

# not 1.1
# not 1.2
# not 2.1, not 2.2, not 2.3
revert_list_str_5 <- function(ls) { # @mnel
  apply(data.frame((do.call(rbind, lapply(ls, data.frame)))), 2, as.list)
}

# not 1.1
# not 1.2
# not 2.1, yes 2.2, yes 2.3
revert_list_str_6 <- function(ls) { # @baptiste + @Josh O'Brien
  b <- recast(z, L2 ~ L1)
  apply(b, 1, as.list)
}

# yes 1.1
# yes 1.2
# not 2.1, yes 2.2, yes 2.3
revert_list_str_7 <-  function(ll) { # @Josh O'Brien
  nms <- unique(unlist(lapply(ll, function(X) names(X))))
  ll <- lapply(ll, function(X) setNames(X[nms], nms))
  ll <- apply(do.call(rbind, ll), 2, as.list)
  lapply(ll, function(X) X[!sapply(X, is.null)])
} 
```

### 注意事项

由此分析得出：

*   函数`revert_list_str_7`并且在嵌套列表的名称方面`revert_list_str_6`是**最灵活的**
*   函数`revert_list_str_4`，`revert_list_str_3`后面是我自己的函数是否足够完整，取舍不错。
*   绝对函数中最**完整**`revert_list_str_7`的是.

### 基准

为了完成这项工作，我`microbenchmark`在这 4 个函数上做了一些小基准测试（使用 R 包）（每个基准测试的*时间 = 1000 ）。*

**基准 1**

输入：

`list(z1 = list(a = 1, b = 2, c = 3), z2 = list(a = 0, b = 3, d = 22, f = 9))`.

结果：

```
Unit: microseconds
    expr       min         lq     median         uq       max
1 func_1   250.069   467.5645   503.6420   527.5615  2028.780
2 func_3   204.386   393.7340   414.5485   429.6010  3517.438
3 func_4    89.922   173.7030   189.0545   194.8590  1669.178
4 func_6 11295.463 20985.7525 21433.8680 21934.5105 72476.316
5 func_7   348.585   387.0265   656.7270   691.2060  2393.988 
```

获胜者：`revert_list_str_4`。

**基准 2**

输入：

`list(z1 = list(a = 1, b = 2, c = 'ciao'), z2 = list(a = 0, b = 3, c = 5))`.

`revert_list_str_6`排除，因为它不支持不同类型的嵌套子元素。

结果：

```
Unit: microseconds
    expr     min       lq   median       uq      max
1 func_1 249.558 483.2120 502.0915 550.7215 2096.978
2 func_3 210.899 387.6835 400.7055 447.3785 1980.912
3 func_4  92.420 170.9970 182.0335 192.8645 1857.582
4 func_7 257.772 469.9280 477.8795 487.3705 2035.101 
```

获胜者：`revert_list_str_4`。

**基准 3**

输入：

`list(z1 = list(a = 1, b = m, c = 'ciao'), z2 = list(a = 0, b = 3, c = m))`.

`m`是一个 3x3 整数矩阵，并`revert_list_str_6`再次被排除在外。

结果：

```
Unit: microseconds
expr     min       lq   median       uq      max
1 func_1 261.173 484.6345 503.4085 551.6600 2300.750
2 func_3 209.322 393.7235 406.6895 449.7870 2118.252
3 func_4  91.556 174.2685 184.5595 196.2155 1602.983
4 func_7 252.883 474.1735 482.0985 491.9485 2058.306 
```

获胜者：`revert_list_str_4`。再次！

*结束编辑2。*

## 结论

首先：感谢所有人，出色的解决方案。

在我看来，如果您事先知道您的列表将具有相同名称的嵌套列表，则`reverse_str_4`作为性能和对不同类型支持的最佳折衷方案是赢家。

最完整的解决方案是，`revert_list_str_7`尽管完全的灵活性导致性能平均下降约 2.5 倍`reverse_str_4`（如果您的嵌套列表具有不同的名称，则很有用）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-07T05:25:22.887

**编辑：**

这是一个更灵活的版本，适用于元素不一定包含相同子元素集的列表。

```
fun <-  function(ll) {
    nms <- unique(unlist(lapply(ll, function(X) names(X))))
    ll <- lapply(ll, function(X) setNames(X[nms], nms))
    ll <- apply(do.call(rbind, ll), 2, as.list)
    lapply(ll, function(X) X[!sapply(X, is.null)])
}

## An example of an 'unbalanced' list
z <- list(z1 = list(a = 1, b = 2), 
          z2 = list(b = 4, a = 1, c = 0))
## Try it out
fun(z) 
```

* * *

**原始答案**

```
z <- list(z1 = list(a = 1, b = 2, c = 3), z2 = list(b = 4, a = 1, c = 0))

zz <- lapply(z, `[`, names(z[[1]]))   ## Get sub-elements in same order
apply(do.call(rbind, zz), 2, as.list) ## Stack and reslice 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-07T04:53:44.113

* * *

## 编辑——根据@Josh O'Briens 的建议和我自己的改进工作

问题是 do.call rbind 没有调用`rbind.data.frame`它来匹配名称。`rbind.data.frame`应该可以，因为 data.frames 是列表，每个子列表都是一个列表，所以我们可以直接调用它。

```
apply(do.call(rbind.data.frame, z), 1, as.list) 
```

然而，虽然这可能很简洁，但它很慢，因为`do.call(rbind.data.frame, ...)`它本质上很慢。

* * *

类似的东西（分两步）

```
 # convert each component of z to a data.frame
 # so rbind.data.frame so named elements are matched
 x <- data.frame((do.call(rbind, lapply(z, data.frame))))
 # convert each column into an appropriately named list
 o <- lapply(as.list(x), function(i,nam) as.list(`names<-`(i, nam)), nam = rownames(x))
 o
$a
$a$z1
[1] 1

$a$z2
[1] 1

$b
$b$z1
[1] 2

$b$z2
[1] 4

$c
$c$z1
[1] 3

$c$z2
[1] 0 
```

还有一个替代方案

```
# unique names
nn <- Reduce(unique,lapply(z, names))
# convert from matrix to list `[` used to ensure correct ordering
as.list(data.frame(do.call(rbind,lapply(z, `[`, nn)))) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-07T06:01:33.547

重塑可以让你靠近，

```
library(reshape)
b = recast(z, L2~L1)
split(b[,-1], b$L2) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-05-13T12:48:51.427

这个简单的解决方案怎么样，它是完全通用的，并且几乎与 Josh O'Brien 假设通用内部名称（#4）的原始答案一样快。

```
zv <- unlist(unname(z), recursive=FALSE)
ans <- split(setNames(zv, rep(names(z), lengths(z))), names(zv)) 
```

这是一个通用的版本，它对没有名字是健壮的：

```
invertList <- function(z) {
    zv <- unlist(unname(z), recursive=FALSE)
    zind <- if (is.null(names(zv))) sequence(lengths(z)) else names(zv)
    if (!is.null(names(z)))
        zv <- setNames(zv, rep(names(z), lengths(z)))
    ans <- split(zv, zind)
    if (is.null(names(zv))) 
        ans <- unname(ans)
    ans
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-06-21T23:44:00.527

最近发布`purrr`的包含一个函数 ，`transpose`其目的是“还原”一个列表结构。该功能有一个主要警告`transpose`，它匹配位置而不是名称，[https://cran.r-project.org/web/packages/purrr/purrr.pdf](https://cran.r-project.org/web/packages/purrr/purrr.pdf)。这意味着它不是上述基准 1 的正确工具。因此，我只考虑下面的基准 2 和 3。

## 基准 2

```
B2 <- list(z1 = list(a = 1, b = 2, c = 'ciao'), z2 = list(a = 0, b = 3, c = 5))

revert_list_str_8 <-  function(ll) { # @z109620
  transpose(ll)
}

microbenchmark(revert_list_str_1(B2), revert_list_str_3(B2), revert_list_str_4(B2), revert_list_str_7(B2), revert_list_str_8(B2), times = 1e3)
Unit: microseconds
                  expr     min       lq       mean   median       uq      max neval
 revert_list_str_1(B2) 228.752 254.1695 297.066646 268.8325 293.5165 4501.231  1000
 revert_list_str_3(B2) 211.645 232.9070 277.149579 250.9925 278.6090 2512.361  1000
 revert_list_str_4(B2)  79.673  92.3810 112.889130 100.2020 111.4430 2522.625  1000
 revert_list_str_7(B2) 237.062 252.7030 293.978956 264.9230 289.1175 4838.982  1000
 revert_list_str_8(B2)   2.445   6.8440   9.503552   9.2880  12.2200  148.591  1000 
```

显然功能`transpose`是赢家！它还使用更少的代码。

## 基准 3

```
B3 <- list(z1 = list(a = 1, b = m, c = 'ciao'), z2 = list(a = 0, b = 3, c = m))

microbenchmark(revert_list_str_1(B3), revert_list_str_3(B3), revert_list_str_4(B3), revert_list_str_7(B3), revert_list_str_8(B3), times = 1e3)

 Unit: microseconds
                  expr     min       lq       mean  median      uq      max neval
 revert_list_str_1(B3) 229.242 253.4360 280.081313 266.877 281.052 2818.341  1000
 revert_list_str_3(B3) 213.600 232.9070 271.793957 248.304 272.743 2739.646  1000
 revert_list_str_4(B3)  80.161  91.8925 109.713969  98.980 108.022 2403.362  1000
 revert_list_str_7(B3) 236.084 254.6580 287.274293 264.922 280.319 2718.628  1000
 revert_list_str_8(B3)   2.933   7.3320   9.140367   9.287  11.243   55.233  1000 
```

再次，`transpose`优于所有其他人。

上述这些基准测试的问题在于它们专注于非常小的列表。因此，嵌套在函数 1-7 中的大量循环不会造成太大问题。随着列表的大小以及迭代的增加，速度增益`transpose`可能会增加。

包`purrr`太棒了！它的作用远不止还原列表。与`dplyr`包结合使用，`purrr`包使您可以使用强大而美观的函数式编程范例来完成大部分编码工作。感谢主赐予哈德利！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-05-15T11:23:45.613

我想为这个有价值的收藏添加进一步的解决方案（我已经多次转向）：

```
revert_list_str_9 <- function(x) do.call(Map, c(c, x)) 
```

如果这是代码高尔夫，我们将有一个明显的赢家！当然，这要求各个列表条目的顺序相同。这可以使用上面的各种想法进行扩展，例如

```
revert_list_str_10 <- function(x) {
  nme <- names(x[[1]]) # from revert_list_str_4
  do.call(Map, c(c, lapply(x, `[`, nme)))
}

revert_list_str_11 <- function(x) {
  nme <- Reduce(unique, lapply(x, names)) # from revert_list_str_3
  do.call(Map, c(c, lapply(x, `[`, nme)))
} 
```

性能方面，它也不是太破旧。如果东西被正确排序，我们就有了一个新的基础 R 解决方案。如果没有，时间仍然非常有竞争力。

```
z <- list(z1 = list(a = 1, b = 2, c = 3), z2 = list(b = 4, a = 1, c = 0))

microbenchmark::microbenchmark(
  revert_list_str_1(z), revert_list_str_2(z),  revert_list_str_3(z),
  revert_list_str_4(z), revert_list_str_5(z),  revert_list_str_7(z),
  revert_list_str_9(z), revert_list_str_10(z), revert_list_str_11(z),
  times = 1e3
)

#> Unit: microseconds
#>                   expr     min       lq      mean   median       uq       max
#>   revert_list_str_1(z)  51.946  60.9845  67.72623  67.2540  69.8215  1293.660
#>   revert_list_str_2(z) 461.287 482.8720 513.21260 490.5495 498.8110  1961.542
#>   revert_list_str_3(z)  80.180  89.4905  99.37570  92.5800  95.3185  1424.012
#>   revert_list_str_4(z)  19.383  24.2765  29.50865  26.9845  29.5385  1262.080
#>   revert_list_str_5(z) 499.433 525.8305 583.67299 533.1135 543.4220 25025.568
#>   revert_list_str_7(z)  56.647  66.1485  74.53956  70.8535  74.2445  1309.346
#>   revert_list_str_9(z)   6.128   7.9100  11.50801  10.2960  11.5240  1591.422
#>  revert_list_str_10(z)   8.455  10.9500  16.06621  13.2945  14.8430  1745.134
#>  revert_list_str_11(z)  14.953  19.8655  26.79825  22.1805  24.2885  2084.615 
```

不幸的是，这不是创造出来的，而是由[@thelatemail](https://stackoverflow.com/a/24988497/3855417)提供的。

# scala - 在 Scala 中基于运行时类型信息进行区分

> ID：15263148
> 
> 赞同：2
> 
> 时间：2013-03-07T04:34:55.733
> 
> 标签：scala

我想实现一个包含类型参数的子类，并编写根据参数是否符合参数而表现不同的函数的实现。

考虑：

```
import scala.reflect.runtime.universe;

trait Lover {
    def love( amour : Any ) : String
}

class TypedLover[MY_TYPE]( implicit val myTypeTag : universe.TypeTag[MY_TYPE] ) extends Lover {
    def love( amour : Any ) : String =
        if ( ??? ) "You are totally my type." else "Nope, sorry, not my type."
} 
```

我将在这里使用什么条件？[**更新：**如果函数参数*amour*符合 MY_TYPE，则条件应返回 true，否则返回 false。]

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T06:02:57.327

```
class TypedLover[A](implicit tt: TypeTag[A]) extends Lover {
  def love(amour: Any) =
    if (tt.tpe =:= typeOf[String]) "You are totally my type."
    else "Nope, sorry, not my type."
}

scala> new TypedLover[String].love(null)
res2: String = You are totally my type.

scala> new TypedLover[Int].love(null)
res3: String = Nope, sorry, not my type. 
```

For a detailed introduction in how a `TypeTag` works, see this question: [Scala: What is a TypeTag and how do I use it?](https://stackoverflow.com/questions/12218641/scala-2-10-what-is-a-typetag-and-how-do-i-use-it)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T10:13:28.133

我想你想要这样的东西：

```
trait Lover {
  def love( amour : Any ) : String
}

class TypedLover[A : ClassTag] extends Lover {
    def love(amour : Any) = {
        if (implicitly[ClassTag[A]].runtimeClass == amour.getClass) {
                "Totally my type."
            } else {
                "Sorry, you are not my type."
            }
    }
}

val tl = new TypedLover[String]
tl.love(1) // res0: String = Sorry, you are not my type.
tl.love("Hello") //res1: String = Totally my type. 
```

请注意，如果要捕获子类型，您可以使用诸如`isAssignableFrom`代替的方法。`==`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T04:56:13.017

Scala 有一种使用`Manifest`类来解决类型擦除的方法。我的要点的链接说明了用法 - [https://gist.github.com/anoopelias/4462155](https://gist.github.com/anoopelias/4462155)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-26T03:04:03.297

这是我能做到的最好的。它不会捕获真正的运行时类型信息，这正是我想要的，但它至少在编译时捕获了使用点已知的类型信息：

```
import scala.reflect.runtime.universe._

trait Lover {
  def love[ T : TypeTag ]( amour : T ) : String;
}

class TypedLover[MY_TYPE : TypeTag] {
  def love[ T : TypeTag ]( amour : T ) : String =
    if ( implicitly[TypeTag[T]].tpe <:< implicitly[TypeTag[MY_TYPE]].tpe )
      "You are totally my type."
    else
      "Nope, sorry, not my type."
} 
```

以下是它的工作原理：

```
scala> val intLover = new TypedLover[Int]
intLover: TypedLover[Int] = TypedLover@2d4cadc4

scala> intLover.love(7)
res2: String = You are totally my type.

scala> intLover.love("Hello")
res3: String = Nope, sorry, not my type.

scala> val stringLover = new TypedLover[String]
stringLover: TypedLover[String] = TypedLover@1f7c9157

scala> stringLover.love(7)
res4: String = Nope, sorry, not my type.

scala> stringLover.love("Hello")
res5: String = You are totally my type. 
```

但它仍然无法捕获实际的运行时类型信息：

```
scala> val stringInAnyRef : Any = "Hello"
stringInAnyRef: Any = Hello

scala> stringLover.love( stringInAnyRef )
res7: String = Nope, sorry, not my type. 
```

它并不完美，但它是迄今为止我所拥有的最好的。

# javascript - 使用 JSON 对象填充 KendoGrid

> ID：15263157
> 
> 赞同：1
> 
> 时间：2013-03-07T04:35:45.377
> 
> 标签：javascript, json, knockout.js, kendo-ui

作为 Kendo UI 和 Knockout 的新手（3 天！），我正在尝试将旧版 Java 小程序转换为 Javascript。到目前为止，创建和绑定 kendoGrid 相对容易：

函数 JobViewModel() { var self = this;

```
self.jobData = new ko.observableArray([]);

self.grdJobs = {
    scrollable: true,
    sortable: true,
    filterable: false,
    columnMenu: true,
    resizable: true,
    columns: [
        { title: "Job ID", field: "jobID" },
        { title: "Owner", field: "owner" },
        { title: "Description", field: "description" },
        { title: "State", field: "runState" },
        { title: "Start Time", field: "timeStart" },
        { title: "End Time", field: "timeEnd" },
        { title: "Elapsed Time", field: "timeElapsed" },
        { title: "Progress", field: "progress" },
        { title: "Agent", field: "agent" },
        { title: "Last Action", field: "lastAction" }
    ],
    selectable: "single"
}; 
```

};

从服务器返回的数据是一组 JSON 对象（任意长度），如下所示（为简洁起见）：

[{0: 1, 2: 3, 4: 5, ...}, {0: 1, 2: 21, 4: 5, ...}, {0: 1, 2: 23, 4: 5, ...}]

这个作为数字键/值对的对象数组被映射到一个字典对象，其中数字键与字符串值配对，例如：

{ 0：“状态” 1：“已完成” 2：“作业 ID” 3：“54759” 4：“所有者” 5：“约翰” ... 21：“54758” ... 23：“54757” ... .}

我需要得到的是字典中的映射字符串，因为它们与 JSON 对象数组相关。我尝试的方法是 JSON.stringify(obj[i]) 但后来我不确定我能用它做什么（也许在可以分配给 kendoGrid 的 ko.observable 中使用它？）无论如何，我根据上面显示的示例数据，我是一个带有列标题“JOB ID”、“Owner”和“State”的网格和 3 行作业（54757、54758、54759），所有这些都归 John 和 State完成的。

我希望这一切都有意义。我想我真正需要的是如何获取 JSON 并将其转换为可以填充到 Kendo Grid 中的可用内容。感谢您帮助 JS/JSON/Kendo/Knockout 新手！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T07:47:01.430

您可以尝试将您拥有的这两个数组映射到另一个包含您可以使用的元素的数组。

我做了一个简单的 jsFiddle 来演示这一点：[jsFiddle](http://jsfiddle.net/heBym/)

代码非常简单：

```
var data = [{ 0: 1, 2: 3 }, { 0: 4, 2: 3 }];
var mapping = { 0: 'State', 1: 'Finished', 2: 'Owner', 3: 'John', 4: 'Pending' };

var realData = [];
$.each(data, function(index, obj) {
    var arrayElem = {};
    $.each(obj, function(key, value) {
        arrayElem[mapping[key]] = mapping[value];
    });
    realData.push(arrayElem);
}); 
```

# python - 如何在python中重新排列文本文件不同行的数字？

> ID：15263158
> 
> 赞同：0
> 
> 时间：2013-03-07T04:35:45.947
> 
> 标签：python, text, numbers, swap

所以我有一个由一列组成的文本文件，每列包含两个数字

```
190..255
337..2799
2801..3733
3734..5020
5234..5530
5683..6459
8238..9191
9306..9893 
```

我想丢弃第一个和最后一个数字，在这种情况下是 190 和 9893。基本上将其余数字向前移动一位。像这样

我想要的输出

```
255..337
2799..2801
3733..3734
5020..5234
5530..5683
6459..8238
9191..9306 
```

我希望这是有道理的我不知道如何处理这个

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T04:51:30.953

```
lines = """190..255
337..2799
2801..3733"""

values = [int(v) for line in lines.split() for v in line.split('..')]
# values = [190, 255, 337, 2799, 2801, 3733]

pairs = zip(values[1:-1:2], values[2:-1:2])
# pairs = [(255, 337), (2799, 2801)]

out = '\n'.join('%d..%d' % pair for pair in pairs)
# out = "255..337\n2799..2801" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T05:18:57.527

```
temp = []
with open('temp.txt') as ofile:
    for x in ofile:
        temp.append(x.rstrip("\n"))
for x in range(0, len(temp) - 1):
    print temp[x].split("..")[1] +".."+ temp[x+1].split("..")[0]
    x += 1 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-07T04:52:47.120

尝试这个：

```
with open(filename, 'r') as f:
    lines = f.readlines()

numbers = []
for row in lines:
    numbers.extend(row.split('..'))

numbers = numbers[1:len(numbers)-1]
newLines = ['..'.join(numbers[idx:idx+2]) for idx in xrange(0, len(numbers), 2]

with open(filename, 'w') as f:
    for line in newLines:
        f.write(line)
        f.write('\n') 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-07T04:42:10.283

尝试这个：

*   将它们全部读入一个列表，将每一行分成两个数字，这样你就有了一个包含所有数字的列表。
*   从列表中删除第一项和最后一项
*   写出你的清单，一次两个项目，在它们之间加上点。

这是一个例子：

```
a = """190..255
       337..2799
       2801..3733
       3734..5020
       5234..5530
       5683..6459
       8238..9191
       9306..9893"""
a_list = a.replace('..','\n').split()
b_list = a_list[1:-1]
b = ''
for i in range(len(a_list)/2):
    b += '..'.join(b_list[2*i:2*i+2]) + '\n' 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-07T04:56:16.147

也许这会有所帮助：

```
def makeColumns(listOfNumbers):
    n = int()
    while n < len(listOfNumbers):
        print(listOfNumbers[n], '..', listOfNumbers[(n+1)])
        n += 2

def trim(listOfNumbers):
    listOfNumbers.pop(0)
    listOfNumbers.pop((len(listOfNumbers) - 1))

listOfNumbers = [190, 255, 337, 2799, 2801, 3733, 3734, 5020, 5234, 5530, 5683, 6459, 8238, 9191, 9306, 9893]

makeColumns(listOfNumbers)
print()

trim(listOfNumbers)
makeColumns(listOfNumbers) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-03-21T00:05:37.830

我认为这也可能有用。我正在从文件名列表中读取数据。

```
data = open("list","r")
temp = []
value = []
print data
for line in data:
    temp = line.split("..")
    value.append(temp[0])
    value.append(temp[1])

for i in range(1,(len(value)-1),2):
    print value[i].strip()+".."+value[i+1]

print value 
```

读取数据后，我拆分并将其存储在临时列表中。之后，我将数据复制到包含所有数据的主列表值。然后我从第二个元素迭代到倒数第二个元素以获得感兴趣的输出。strip 函数用于从值中删除 '\n' 字符。

您可以稍后将这些值写入文件而不是打印出来。

# php - 更改具有类似 id 的元素的 css 属性

> ID：15263160
> 
> 赞同：0
> 
> 时间：2013-03-07T04:35:53.287
> 
> 标签：php, javascript

如果 id 使用 javascript，我在更改具有类似类型的元素的 css 属性时遇到问题。

我正在通过一系列隐藏元素运行 php 循环。所以我有这样的id `imgstat_1`，`imgstat_2`等等。

我正在使用的代码是

```
foreach($img as $img1){?>
    <li>
       <a href="#" onclick="changeimgstat('<?php echo $counter;?>')">
         <img src="<?php echo $img1->vchEventImg?>" width="75" height="75" alt="" id="abc_<?php echo $img1->vchImgStatus?>" />
       </a>
    </li>
    <input type = "hidden" value="<?php echo $img1->vchImgStatus?>" id="imgstat_<?php echo $counter;?>">
    <?php $counter++;
}?>
<input type="hidden" value="" name="newimg" id="newimg"> 
```

和像这样的javascript

```
function changeimgstat(obj)
{
     var xyz = document.getElementById('newimg').value;
     alert(document.getElementById('abc_'+xyz));
     document.getElementById('abc_'+obj).style.border="3px solid red";
     var status = document.getElementById('imgstat_'+obj).value;
     document.getElementById('newimg').value = status;
} 
```

所以有人可以建议我做错了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:44:53.993

最好的解决方案是为元素添加一个 css 类属性。并为班级编写样式。

在 onclick 函数中，您可以将类添加到元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T04:46:37.623

正如我发现您的代码中没有错误，但您之前定义`$counter`过`foreach loop`. 你`img id`应该是`abc_<?php echo $counter?>`而不是`abc_<?php echo $img1->vchImgStatus?>`你正在使用的`javascript`.

尝试：

**CSS**

```
.img3{border:3px solid red;}
.img{border:none;} 
```

**HTML 和 PHP**

```
<?php
$counter=1;
foreach($img as $img1){?>
    <li>
       <a href="#" onclick="changeimgstat('<?php echo $counter;?>')">
         <img class="img" src="<?php echo $img1->vchEventImg?>" width="75" height="75" alt=""  id="abc_<?php echo $counter?>" />
       </a>
    </li>
    <input type="hidden" value="<?php echo $img1->vchImgStatus?>" id="imgstat_<?php echo $counter;?>">
    <?php $counter++;
}?>
<input type="hidden" value="" name="newimg" id="newimg"> 
```

**脚本**

```
<script>
function removeAllClass()
{
    var allimg=document.getElementsByClassName("img");
    for(var index=0;index<allimg.length;index++)
    {
        allimg[index].className = "img";
    }
}   

function changeimgstat(obj)
{
     removeAllClass();
     document.getElementById('abc_'+obj).className="img img3";
     var status = document.getElementById('imgstat_'+obj).value;
     document.getElementById('newimg').value = status;
}
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T04:47:15.933

看来你有：

```
<img ... id="abc_<?php echo $img1->vchImgStatus?>"> 
```

和

```
<input ... value="<?php echo $img1->vchImgStatus?>" id="imgstat_<?php echo $counter;?>"> 
```

你确定这两个元素会有你期望的 id 吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T04:47:46.690

尝试以下操作：

```
foreach($img as $img1){?>
    <li>
       <a href="#" onclick="changeimgstat('<?php echo $counter;?>')">
         <img src="<?php echo $img1->vchEventImg?>" width="75" height="75" alt="" id="abc_<?php echo $counter;?>" />
       </a>
    </li>
    <input type = "hidden" value="<?php echo $img1->vchImgStatus?>" id="imgstat_<?php echo $counter;?>">
    <?php $counter++;
}?>
<input type="hidden" value="" name="newimg" id="newimg"> 
```

Javascript：

```
function changeimgstat(obj)
{
     var xyz = document.getElementById('newimg').value;
     alert(document.getElementById('abc_'+xyz));
     document.getElementById('abc_'+obj).style.border="3px solid red";
     var status = document.getElementById('imgstat_'+obj).value;
     document.getElementById('newimg').value = status;
} 
```

我更改了 id="abc_" 因为在 javascript 函数中，您传递的参数是计数器，所以应该是 id 值。

# python - Python 风格：形成多个冗长的类声明

> ID：15263163
> 
> 赞同：1
> 
> 时间：2013-03-07T04:36:08.717
> 
> 标签：python

我有一个类（content.MyClass），它存储了很多关于细菌的事实。我多次调用它，以定义多种类型的细菌。它不是很优雅，但它相当快速、可读且模块化（易于添加更多细菌）。

问题：有没有更好的方法我应该这样做？

```
import content
def myMethod():
    bacteria = {} #A dictionary I fill with 'Bacteria Name':object

    bacteria['Staph Aureus'] = content.MyClass(
        bug_type = ['gram+'],
        virulence = ['Protein A', 'TSST-1', 'exfoiative toxin', 'enterotoxin'],
        labs = ['catalase+', 'coagulase+']
    )
    bacteria['Staph Epidermidis'] = content.MyClass(
        bug_type = ['gram+'],
        sx = ['infects prosthetic devices']
    )
    #Etc. about 25 more times.
    return bacteria 
```

（脚注：我知道 PEP 8 说我应该缩进所有内容以与“MyClass（”）对齐，但这在这里行不通，因为有些列表很长。此外，每个类中有更多变量；我为此处的示例修剪它们。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T04:38:40.727

> 问题：有没有更好的方法我应该这样做？

你正在考虑[解决错误的问题。](https://meta.stackexchange.com/q/66377/133242)

使您的课程[数据驱动：](https://stackoverflow.com/q/1065584/139010)将代码与数据分开。从数据源加载定义；像 JSON 或 YAML 文件这样简单的东西就可以了。

> 在进行*数据驱动编程时，*人们清楚地区分代码和它所作用的数据结构，并设计两者，以便可以通过编辑而不是代码而是数据结构来更改程序的逻辑。

[http://www.faqs.org/docs/artu/ch09s01.html](http://www.faqs.org/docs/artu/ch09s01.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T04:40:23.423

我会这样做：

```
def myMethod():
  from content import MyClass
  return {
    'Staph Aureus': MyClass(
      bug_type = ['gram+'],
      virulence = ['Protein A', 'TSST-1', 'exfoiative toxin', 'enterotoxin'],
      labs = ['catalase+', 'coagulase+']
    ),
    'Staph Epidermidis': MyClass(
      bug_type = ['gram+'],
      sx = ['infects prosthetic devices']
    ),
    #Etc. about 25 more times.
  } 
```

# css - css 布局问题：用包含 ul 的 css 安排布局

> ID：15263165
> 
> 赞同：1
> 
> 时间：2013-03-07T04:36:21.990
> 
> 标签：css, layout

我正在尝试在内联中安排一个容器，但似乎在我的 css 中丢失了一些东西。似乎 class="second" 在使用 float:right 后不起作用。我的容器看起来像

```
<nav id="main">
  <a>First</a>
  <ul></ul>
  <a>Second</a>
</nav> 
```

好像我在我的 CSS 中遗漏了一些东西

我的 jsfiddle 链接：http: [//jsfiddle.net/pttVq/1/](http://jsfiddle.net/pttVq/1/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T04:41:52.690

好吧，UL 也需要内联……因为默认情况下它是一个块元素。

```
ul {display: inline;} 
```

但是，这可能不会让您获得您正在寻找的效果。尝试将 ul 也向左浮动。

```
ul {float: left;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T04:41:54.760

你为什么不这样做

```
<nav id="main">

    <ul>
        <li> <a href="#" class="first">First</a></li>
        <li>1</li>
        <li>2</li>
        <li>3</li>
        <li>4</li>
        <li>5</li>
        <li>6</li>
        <li>7</li>
        <li>8</li>
        <li>1</li>
        <li>2</li>
        <li>3</li>
        <li>4</li>
        <li>5</li>
        <li>6</li>
        <li>7</li>
        <li><a href="#" class="second">Second</a></li>        
    </ul>

</nav> 
```

[在小提琴](http://jsfiddle.net/pttVq/4/)中看到它

并删除边框

```
li:nth-of-type(1), li:nth-last-of-type(1){
 border:none;
} 
```

更新[的小提琴](http://jsfiddle.net/pttVq/7/)

# magento - 优化mysql和php的查询

> ID：15263169
> 
> 赞同：0
> 
> 时间：2013-03-07T04:36:30.023
> 
> 标签：magento, magento-1.7

我有一个表，其中包含 id、name 等字段和 (1,"sony,nokia,htc"),(2,"sony")(3,"Samsung") 等值。我获取记录但我的逻辑比我的逻辑要长期望。如果名称包含“，”，我想爆炸并获取唯一记录。我的结果看起来像

```
Name array will be { 0 =>"sony",1=>"HTC",2=>"Nokia"}.My dummy logic is here (This is incomplete not working properly.)
<?php 
$row = array("sony,htc,nokia","htc","sony");
    foreach ($row as $key => $valuek) {
                 if(strpos($valuek['value'], ",") !== false)
                 {
                  $str[] = explode(",",$valuek['value'] )
                    ?>
                    <option value="<?php echo $valuek['value']?>"><?php echo $valuek['value']?></option>
                   <?php 
                 }

            ?>
       <option value="<?php echo $valuek['value']?>"><?php echo $valuek['value']?></option>
       <?php  } $i++;}?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:42:42.087

你不需要做爆炸

在您获取所有数据并存储在数组中的开始时，您可以使用`array_unique()`

```
$row = array("sony,htc,nokia","htc","sony"); // all fetch data from db.

 $row = implode(',',$row); // first convert the array -> strings
 $row = explode(',',$row); // then return back to array and you can now use array_unique
 $row = array_unique($row);  // this will filter all data with uniqueness and drop some data that have same value 
```

然后你可以用它来循环数据。

```
 for($i=0;$i<count($row)){
     echo '<option value="'.$row[$i].'">'.$row[$i].'</option>';
 } 
```

这将使您的代码更短且易于管理..

# php - 如何获取 RSS 提要以使用 PHP 进行处理？

> ID：15263177
> 
> 赞同：0
> 
> 时间：2013-03-07T04:37:43.847
> 
> 标签：php, rss, feed

我所发现的只是到目前为止如何解析内容。解析内容对我来说不是问题，我只是不清楚如何获取内容！如果我有一堆 XML 文件放在一个文件夹中，我可以轻松地筛选并处理它们，我只是不知道如何将它们放在文件夹中。

我也可以爬到文件的位置并以这种方式抓取它们，但我发现的所有提要似乎只是新闻报道的链接等等，而且它们都不是 XML。

我不想使用任何第三方 CMS，例如 Drupal 或 Wordpress。对不起，如果这是一个愚蠢的问题。提前感谢您的帮助！

编辑：我昨晚进行了搜索，现在我再次搜索并在五秒钟内在我正在寻找的新闻网站上找到了一个纯 XML RSS 提要，而我昨晚找不到。而不是提供可下载的文件，这就是 RSS 提要通常提供的全部内容吗？可浏览的文件/页面？

EDIT2：是的，看起来就是这样。对不起大家！好吧，希望有类似问题的人能得到帮助。

EDIT3：好吧，既然我现在创建了线程，任何人都可以告诉我 SimpleXML 或解析（比如 Magpie）是否会更快，处理方式？我的假设是 SimpleXML 是要走的路。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:48:44.733

有很多可供阅读的选项，但我喜欢使用 ttp://magpierss.sourceforge.net/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T04:49:33.537

我不确定这是你想要的，但是，这对你有用吗？

```
wget -q -O-  "http://www.tuxradar.com/rss" 
```

我在 PC 上的 Cygwin 中做到了这一点，但是，它可以在 Linux 或 Mac 终端上运行。如果需要，您还可以将输出重定向到文件：

```
wget -q -O-  "http://www.tuxradar.com/rss" > tux.xml 
```

# tcp - 客户端通道不处于可写状态（NIO）Netty

> ID：15263180
> 
> 赞同：3
> 
> 时间：2013-03-07T04:38:16.240
> 
> 标签：tcp, client, netty, nio, channel

客户端通道在 netty 中不处于可写状态。哪位高手可以指导我找出原因

为什么通道总是不处于可写状态？

因为它不是可写状态，所以我们的线程处于睡眠模式。我们使用线程转储分析线程的状态，在下面的循环中添加了一个计数器，它等待一分钟然后退出循环。但我真的很想弄清楚不可写状态的原因。

频道关闭后频道是否仍保留在 ctx 中（如果 EOF 不是由客户端发送的）？

如果这会发生（意味着永远不会处于可写状态）？

```
while (!ctx.getChannel().isWritable()) {
    Thread.sleep(100);
    } 
```

请帮忙。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:50:13.423

从表面上看，这是因为 ChannelBuffer 已满，即不再有可写字节。

这可能是由于写入速度过快，或者通道无法发送任何字节造成的。如果您没有写得太快，可能是因为通道从未成功发送写入的字节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T04:48:46.307

你应该使用选择器，或者 Netty 给你的任何东西，告诉你什么时候通道是可写的。你当然不应该通过循环睡觉来浪费时间。执行此操作时，通道状态无法更改。它只是由`select().`

# c# - 迭代和修改字典

> ID：15263181
> 
> 赞同：2
> 
> 时间：2013-03-07T04:38:25.483
> 
> 标签：c#, asp.net, dictionary, hashtable, ienumerator

我正在尝试为[http://users.metropolia.fi/~dangm/blog/?p=67](http://users.metropolia.fi/~dangm/blog/?p=67)上解释的问题实施解决方案。我是 C# 语言的新手。我想使用枚举器和特定条件遍历字典。所以有两个变量 current 和 previous.current 指向字典的第一个元素。previous 指向字典中的前一个元素。而迭代我正在迭代的字典

```
previous=current;
current.MoveNext(); 
```

问题是，当我们第一次遍历整个字典时，前一个点指向字典中的最后一个元素，当前点指向随机键值对 RawVariable(0,0)。但是现在，当我们第二次遍历字典时，我希望当前指向第一个元素在 dictionary.how 我如何使当前点指向具有特定键或值的某些元素

这是我的代码片段

```
 public void falling_disks(int[] A, int[] B)
    {
        Dictionary<int, int> filledDictionary = filldictionary(d1, A);
        //previous stores the previous element in dictionary
        var previous = filledDictionary .GetEnumerator();
        //current stores next element of previous
        var current = filledDictionary .GetEnumerator();
        current.MoveNext();

        //for each incoming element in array B
        foreach (int ele in B)
        {

            //check if the current key is filled in hashtable h1 that is check if it
            //is already added
            if (!checkifthatvalueisfilled(current.Current.Key))
            {
                //if not check if current value is less than or equal to element
                while ((current.Current.Value >= ele))
                {
                    //assign previous to current
                    previous = current;
                    //move current to next position
                    current.MoveNext();
                }
                listofitemstoremove.Add(previous.Current.Key);

            }
            else
            {
                listofitemstoremove.Add(current.Current.Key);
            }

            foreach (int item in listofitemstoremove)
            {
                if (!(h1.ContainsKey(item)))
                    h1.Add(item, true);
            }

        }
        Console.WriteLine(listofitemstoremove.Capacity);
    }

    public bool checkifthatvalueisfilled(int key)
    {
        if (h1.ContainsValue(h1.ContainsKey(key)) == true)
            return true;
        else return false;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:44:52.640

你的问题很难理解。也许这就是您在循环开始时想要做的事情？

```
current = h1.GetEnumerator();
current.MoveNext(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T07:40:34.257

如果我正确理解了您的问题，您将无法做到。枚举器使您可以连续访问集合，这就是重点。您不能突然将其移动到特定元素，而不从一开始就迭代到该元素。

此外，我没有看到使用枚举器的一个很好的理由。如果您需要对算法的先前和当前元素的引用 - 您应该存储它们的键，而不是枚举数。我也很确定这些线

```
 while ((current.Current.Value >= ele))
            {
                //assign previous to current
                previous = current;
                //move current to next position
                current.MoveNext();
            } 
```

a) 将引发异常，当您到达集合的末尾时 b) 由于您正在分配引用类型，因此无法按预期工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T08:16:55.037

我不确定我是否理解你的问题，但也许你想改变这个：

```
 previous = current; 
```

对此：

```
 previous.MoveNext(); 
```

这样，“以前的”将永远落后于“当前”的一步。如果按照原始代码中的方式分配变量，则只有两个对“当前”对象的引用，然后递增。

# wordpress - wp如何从自定义查询中排除过滤器

> ID：15263183
> 
> 赞同：0
> 
> 时间：2013-03-07T04:38:32.503
> 
> 标签：wordpress, filter, slug

我正在尝试从循环中排除过滤器（slug）。我研究了排除并在代码中的各个地方尝试过。通常我会打破页面。这是代码，我正在尝试更改以排除 slug 20。它是一个名为“american”的过滤器。我试图在数组的开头排除，没有用；然后，我尝试了 foreach($catz as $cat) 部分。我试过这个 'exclude=20&title_li=' 。我尝试了 cat=-20 和其他各种组合。任何帮助将不胜感激。

```
// The Custom Query
 $args = array(
'post_type'         => 'portfolio',
'posts_per_page'    => $counter_folio,
'paged'             => $paged,
'order'             => 'DESC'

 );
 query_posts( $args );
 while( have_posts() ) : the_post();
 $color = substr(get_option('dcb_dynamic_color'), 1);
 // Get the original thumbnail of the post
$src = wp_get_attachment_image_src( get_post_thumbnail_id($post->ID), false, '' );
$excerpt = get_the_excerpt();
// Get the custom fields
$vimeo = get_post_meta($post->ID, "vimeo", true);
$youtube = get_post_meta($post->ID, "youtube", true);
// Get the filter > Category of item
$catz = wp_get_object_terms($post->ID,'filters');
foreach($catz as $cat){ 
    $currcat = $cat->slug;
    $catname = $cat->name;
    break;
}
$counter++;
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T12:55:19.780

如果您想过滤 id 为 20 的帖子，只需使用以下代码将其排除

```
 // The Custom Query
     $args = array(
    'post_type'         => 'portfolio',
    'posts_per_page'    => $counter_folio,
    'paged'             => $paged,
    'order'             => 'DESC'

     );
     query_posts( $args );
     while( have_posts() ) : the_post();
     $color = substr(get_option('dcb_dynamic_color'), 1);
    // Get the original thumbnail of the post
   $src = wp_get_attachment_image_src( get_post_thumbnail_id($post->ID), false, '' );
   $excerpt = get_the_excerpt();
   // Get the custom fields
   $vimeo = get_post_meta($post->ID, "vimeo", true);
   $youtube = get_post_meta($post->ID, "youtube", true);
   // Get the filter > Category of item
   $catz = wp_get_object_terms($post->ID,'filters');
   foreach($catz as $cat){ 
    if($cat->slug != 'american')
    {
      $currcat = $cat->slug;
      $catname = $cat->name;
      break;
     }
    }
    $counter++; 
```

# objective-c - 动态生成的 ui bar 按钮需要使用 segue 推送到 popover

> ID：15263187
> 
> 赞同：1
> 
> 时间：2013-03-07T04:38:43.033
> 
> 标签：objective-c, uipopovercontroller, uibarbuttonitem, uistoryboardsegue, uipopover

z这是基于我在这里提出的一个问题，我已经取得了很好的进展：

[自定义 uitableviewcell 不会显示标签文本](https://stackoverflow.com/questions/15175472/custom-uitableviewcell-will-not-display-label-texts)

我基本上遵循了为我提供的教程。

[http://brianflove.com/2012/12/10/how-to-create-an-ipad-popover-view/](http://brianflove.com/2012/12/10/how-to-create-an-ipad-popover-view/)

**问题**

现在我的问题是，我必须动态生成我的 ui 栏按钮，就好像我只是将它拖放到情节提要上一样，我被限制为左侧一个，右侧一个。这是我生成按钮的代码

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.

    UIBarButtonItem *btn = [[UIBarButtonItem alloc] initWithTitle:@"Button" style:UIBarButtonItemStyleBordered target:self action:@selector(getMenu:)];
    self.navigationItem.leftBarButtonItems = [[NSArray alloc] initWithObjects:btn, nil];
} 
```

基于该教程，我需要使用 segue 来弹出`uitableview`我需要的内容。但这需要我有一个像这样的**锚点**

![在此处输入图像描述](../Images/a289fbf9e23f51be0ff7b63adfcfd698.png)

所以我的问题是，我该如何添加一个锚点`UIBarButtonItem`呢？我一直在搜索，并且一直在寻找有关创建自定义弹出框类的信息？这是准确的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T13:36:52.560

我通过在导航栏本身上创建一个不可见的 UIView 解决了这个问题，然后将其用作 segue 的锚点。问题是当显示 uiviewcontroller 时弹出框的“箭头”放置得很尴尬。仍在试图弄清楚这一点。

这是我得到答案的地方

[https://stackoverflow.com/a/14514837/639713](https://stackoverflow.com/a/14514837/639713)

# jquery - 不在视图源中显示隐藏字段

> ID：15263189
> 
> 赞同：1
> 
> 时间：2013-03-07T04:39:02.953
> 
> 标签：jquery, asp.net-mvc-3, security

当用户单击查看源时，如何防止用户在页面上显示隐藏字段。因为我想让我的应用程序更安全。我希望查看源页面不显示我在 POST 方法中传递的隐藏字段。另外，我想隐藏页面上的 javascipt/jquery 和 css 代码。

简而言之，我不希望用户看到任何不相关的数据（对于用户）。有什么建议么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:09:43.050

第一件事：不能隐藏 html 代码或 css 代码。如果您将打开 fir bug 或其他一些东西，它可以很容易地看到。

查看源代码显示了实际编写在html页面中的代码（即：未动态添加的元素。）

因此，如果您只是不想在视图源上显示它，您可以使用 JavaScript 动态添加该隐藏字段。但事件虽然它是由萤火虫可见的。

如果该信息太安全，请不要将其添加到隐藏字段中。

更好的方法：将其保存在全局 javascript 对象上，例如：

```
var hiddenValue={
'hidden1':"some value",
'hidden2':"some value2"
} 
```

//存储在全局变量中使您可以灵活地在以后更改它，就像在隐藏字段中一样。

如果您想以表格形式发布此值。使用 javascript 执行此操作。喜欢

```
//a jquery example

    function submitForm(){
    var formObj=$('#form');
    formObj.append('<input type="hidden" name="hidden1" value="'+hiddenValue.hidden1+'" /><input type="hidden" name="hidden2" value="'+hiddenValue.hidden2+'" />').submit();
    } 
```

但请记住，总有一种方法可以查看前端代码。只有你能做的就是让它变得复杂阅读。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T06:13:44.140

海事组织你应该

> 将值放入 cookie
> 
> 加密cookie并将其发送给客户端

在收到请求时

> 解密 cookie 并读取值

或者如果数据是敏感的使用会话

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T04:44:08.913

除了禁用右键单击之外，您可以做的不多。但他们仍然可以使用萤火虫和其他检查员进行检查

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T04:46:04.413

您不能真正做到这一点，因为总有一种方法可以查看源代码。

您可以做的是将您想要传递的所有信息保存在加密的 cookie 或会话变量中。

至于安全性，如果您在 HTML/Javascript 中显示的内容应该受到保护，我强烈建议您重新考虑您的方法。

请记住，HTML 是浏览器将输出的渲染代码，因此不可能隐藏部分代码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T04:49:21.407

我更喜欢你为 java 脚本使用[Node.js](http://nodejs.org/)服务器端脚本。
而不是使用隐藏字段尝试使用 java 脚本缓存。
当 JavaScript 受到保护时，您的 java 脚本也将是安全的，而不是隐藏字段

# c# - 如何在 MVC 3 Razor 视图引擎中使用 C# 显示和隐藏 Div？

> ID：15263192
> 
> 赞同：10
> 
> 时间：2013-03-07T04:39:18.357
> 
> 标签：c#, asp.net-mvc, razor

我必须编写 C# 代码来显示和隐藏 MVC3 中的 div，用于基于 C# 中的 switch case 的各种控件。如何在不使用 JQuery Show 或 hide 的情况下完成..但在完全服务器端..？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-07T04:42:15.430

将您的 switch 语句直接添加到您的 .cshtml 文件中。到那时，这一切都将是服务器端的。

控制器：

```
public ActionResult Page()
{
    string data = "value1";
    return View(data);
} 
```

CSHTML：

```
@model string; // this should be the Type your controller passes

<div>some html content</div>
@switch(Model) // Model is how you access your passed data
{
    case "value1":
        <div>...</div>
    break;
    case "value2":
        <div>...</div>
    break;
}
<div>more html content</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T04:52:00.227

W3c 有一篇关于[逻辑条件的文章](http://www.w3schools.com/aspnet/razor_cs_logic.asp)

使用此示例

```
@switch(value)
{
    case "YourFistCase":
        <div>Login</div>;
    break;
    case "YourSecondeCase":
        <div>Logout</div>;
    break;
} 
```

或查看[示例](https://stackoverflow.com/questions/7347989/implementing-a-switch-statement-in-a-cshtml-page)

```
// Use the @{ } block and put all of your code in it
@{
    switch(id)
    {
        case "test":
            // Use the text block below to separate html elements from code
            <text>
                <h1>Test Site</h1>
            </text>
            break;  // Always break each case
        case "prod":
            <text>
                <h1>Prod Site</h1>
            </text>
            break;
        default:
            <text>
                <h1>WTF Site</h1>
            </text>
            break;                   
    }
} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-07T04:59:27.843

为什么你使用switch语句？

你喜欢if条件？？？

为了

```
<% if(CheckYourCondition){ %>

   <div class="TestClass">
   Test
   </div>

<% } %> 
```

# c - 在单链表方面需要帮助

> ID：15263195
> 
> 赞同：1
> 
> 时间：2013-03-07T04:39:37.580
> 
> 标签：c

我需要一些有关单链表的帮助。我正在尝试为从我的文本文件中读取的每个单词插入一个新节点，并将其与字典文件中的单词进行比较。从那里，新节点被插入到哈希表中。我觉得我很接近（也许是渴望的想法)，但每次运行程序时都会出现分段错误。从我的代码的外观来看，有没有人知道可能出了什么问题？

```
typedef struct Node {    

 char word[LENGTH+1];  

 struct Node *Next;    
 } Node;

hash_table_t  *create_hash_table(int size)
hashtable = malloc(sizeof(hash_table_t));

if (hashtable == NULL) 
{

return NULL;

}

 hashtable->table= malloc(size* sizeof(struct Node *) )  ;

if (hashtable->table== NULL)
{
  return NULL;
}
for(int i=0; i<size; i++) 
{ 
  hashtable->table[i]=NULL;
  hashtable->size =size;

}
 return hashtable;

typedef struct hash_table_t{
    int size;       /* the size of the table */
  struct  Node **table; /* the table elements */
} hash_table_t;

File *inptr;    

Node* TempNode=NULL;    
Node* new_node=NULL;
Node* Head=NULL;

char buffer[46];

unsigned int hashval;

int j=0;
int count=0;    
int update_counter=0;

inptr= fopen(dictionary, "r"); 

if (inptr == NULL)
{
    printf("Could not open dictionary file");
    printf("\n");
    return 0;
} 

int ch = fgetc(inptr);   
for ( ;; )     
{        
    if ( ch == EOF )    //determines how many words are in the file        
    {           
        break;                
    }        
    if (isalpha(ch) || isdigit(ch) || ispunct(ch))        
    {           
        update_counter = 1;          
    }         
    if (isspace(ch) && update_counter )      
    {           
        count++;           
        update_counter = 0;       
    }     
}
if (update_counter) 
{
    count++;
} 

sizeOfDictionary=count;
rewind(inptr);

hashtable=create_hash_table(sizeOfDictionary);

while(fread(buffer,sizeof(buffer),1,inptr)!=0)
{        
    if(Head==NULL)
    {
        hashval = hash(buffer);
        Head = malloc(sizeof(Node));
        strcpy(&Head->word[j],buffer); 
        Head->Next = hashtable->table[hashval];

        hashtable->table[hashval]=Head;
        Head=Head->Next;

        TempNode =  Head; 
    }
    else if(Head!=NULL)
    {
        new_node = malloc(sizeof(Node));
        hashval = hash(buffer);
        strcpy(&new_node->word[j],buffer);
        new_node->Next = hashtable->table[hashval];
        hashtable->table[hashval]=new_node;
        TempNode=new_node->Next;        
    } 
}
return true; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T06:17:08.407

让我试着解释一下步骤中发生的事情：

*   `Head = malloc(sizeof(Node));`

    `strcpy(&Head->word[j],buffer);`

* * *

```
 Head
 ----------
|          |
|  buffer  |
|          |
 ---------- 
```

* * *

*   `Head->Next = hashtable->table[hashval];`

    `Head=Head->Next;`

    `TempNode = Head;`

* * *

```
 TempNode
                           Head
 ----------          -----------------
|          |  Next  |                 |
|  buffer  | -----> |  table[hashval] |
|          |        |                 |
 ----------          -----------------
     ^
 This is now
 lost forever 
```

* * *

*   `new_node = malloc(sizeof(Node));`

    `strcpy(&new_node->word[j],buffer);`

    `new_node->Next = hashtable->table[hashval];`

    `TempNode=new_node->Next;`

* * *

```
 Head                   new_node               TempNode
 ----------          -----------------           ----------          ----------------- 
|          |  Next  |                 |         |          |  Next  |                 | 
|  buffer  | -----> |  table[hashval] | No link |  buffer  | -----> |  table[hashval] |
|          |        |                 |  here!  |          |        |                 |
 ----------          -----------------           ----------          -----------------
     ^
 This is now
 lost forever 
```

* * *

等等。

我怀疑“这里没有链接！” 上图中的部分导致您的段错误。我也不知道你打算如何使用你的`table[hashval]`，但不管怎样。该解决方案只是弥补了您的链表中的空白。

**解决方案：**

用这个替换你的`while`循环：

```
TempNode = Head = NULL;

while(fread(buffer,sizeof(buffer),1,inptr)!=0)
{        
    if(Head==NULL)
    {
        hashval = hash(buffer);
        Head = malloc(sizeof(Node));
        strcpy(&Head->word[j],buffer); 
        Head->Next = hashtable->table[hashval];
        Head->Next->Next = NULL;

        TempNode = hashtable->table[hashval] = Head;
    }
    else
    {
        new_node = malloc(sizeof(Node));
        hashval = hash(buffer);
        strcpy(&new_node->word[j],buffer);
        new_node->Next = hashtable->table[hashval];
        hashtable->table[hashval]=new_node;
        new_node->Next->Next = NULL;
        TempNode->Next = new_node;        
        TempNode = new_node;
    } 
    TempNode = TempNode->Next;
} 
```

视觉上的区别是：

*   `Head = malloc(sizeof(Node));`

    `strcpy(&Head->word[j],buffer);`

    `Head->Next = hashtable->table[hashval];`

    `Head->Next->Next = NULL;`

    `TempNode = hashtable->table[hashval] = Head;`

* * *

```
 TempNode
    Head                  
 ----------          -----------------
|          |  Next  |                 |  Next
|  buffer  | -----> |  table[hashval] | -----> NULL
|          |        |                 |
 ----------          ----------------- 
```

* * *

*   `TempNode = TempNode->Next`

* * *

```
 Head                 TempNode                  
 ----------          -----------------
|          |  Next  |                 |  Next
|  buffer  | -----> |  table[hashval] | -----> NULL
|          |        |                 |
 ----------          ----------------- 
```

* * *

*   `new_node = malloc(sizeof(Node));`

    `strcpy(&new_node->word[j],buffer);`

    `new_node->Next = hashtable->table[hashval];`

    `new_node->Next->Next = NULL;`

* * *

```
 Head                 TempNode                 new_node               
 ----------          -----------------           ----------          ----------------- 
|          |  Next  |                 |         |          |  Next  |                 | 
|  buffer  | -----> |  table[hashval] | No link |  buffer  | -----> |  table[hashval] | ----> NULL
|          |        |                 |  here!  |          |        |                 |
 ----------          -----------------           ----------          ----------------- 
```

* * *

*   `TempNode->Next = new_node;`

* * *

```
 Head                 TempNode                new_node               
 ----------          -----------------          ----------          ----------------- 
|          |  Next  |                 |  Next  |          |  Next  |                 | 
|  buffer  | -----> |  table[hashval] | -----> |  buffer  | -----> |  table[hashval] | ----> NULL
|          |        |                 |        |          |        |                 |
 ----------          -----------------          ----------          ----------------- 
```

* * *

*   `TempNode = new_node;`

* * *

```
 TempNode
    Head                                         new_node               
 ----------          -----------------          ----------          ----------------- 
|          |  Next  |                 |  Next  |          |  Next  |                 | 
|  buffer  | -----> |  table[hashval] | -----> |  buffer  | -----> |  table[hashval] | ----> NULL
|          |        |                 |        |          |        |                 |
 ----------          -----------------          ----------          ----------------- 
```

* * *

等等。

**尖端：**

*   释放你`malloc`最后编辑的任何内存。
*   不要移动`Head`指针（除非您需要删除第一个元素或出于其他原因）。

# python - 如何在水壶中调用python脚本

> ID：15263196
> 
> 赞同：3
> 
> 时间：2013-03-07T04:39:44.887
> 
> 标签：python, kettle

我在`kettle`连接时遇到问题`python`。在`kettle`，我只找到`js`脚本模块。

水壶直接支持python吗？我的意思是，我可以在`kettle`不使用`js`或其他人的情况下调用 python 脚本吗？

顺便说一句，我想定期移动`Oracle`数据`Mongo`。我选择使用`python`来实现转换。那么在没有外部文件的情况下，是否有一些简单的方法来保持关系 db 和 no-rdb 之间的同步？

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T15:17:16.490

从我所见，它不直接支持它。

但是有一个 mongodb 输入步骤。最近已经做了很多工作（并且仍在进行中。

因此，鉴于有一个 mongodb 输入步骤，如果您已经在使用 ETL 工具，那么为什么要让它执行 python 脚本来完成这项工作？

# java - LinearLayout 上的 setMinimumHeight() 不起作用（在子类中）

> ID：15263197
> 
> 赞同：3
> 
> 时间：2013-03-07T04:40:03.803
> 
> 标签：java, android

我有一个衬垫布局的子类（从 XML 自定义类型引用） 我尝试设置的最小高度不起作用，也没有设置布局。我需要以编程方式执行此操作...

为什么 setMinimumHeight() 不起作用？

注意：代码的复杂度可以忽略，设置的值为70

```
public class SummaryDynamicSpacer extends LinearLayout {

    private static final String TAG = "mymeter-DynamicSpacer";
    int dpWidth = 0;
    int dpHeight = 0;

    public SummaryDynamicSpacer(Context context) {
        super(context);
        init(context);
    }

    public SummaryDynamicSpacer(Context context, AttributeSet attrs) {
        super(context, attrs);
        init(context);
    }

    private void init(Context context) {
        DisplayMetrics metrics = new DisplayMetrics();
        ((Activity)context).getWindowManager().getDefaultDisplay().getMetrics(metrics);

        //Set dpWidth, this is the key metric we use for scaling.
        float density  = getResources().getDisplayMetrics().density;
        float dpWidth  = metrics.widthPixels / density;
        float dpHeight  = metrics.heightPixels / density;
        this.dpWidth = (int)dpWidth;
        this.dpHeight = (int)dpHeight;

        Log.d(TAG, "zyxHeightDP: "+metrics.heightPixels / density);

        int id = this.getId();
        int increment = 10;
        int adjustment = getValueForLargeDevice(increment);

        if(id == R.id.betweenAddressAndTopBox) {
            doBetweenAddressAndTopBox(context, adjustment);
        } else if(id == R.id.betweenTopAndAddress) {
            doBetweenTopAndAddress(context, adjustment);
        }

        Log.d(TAG, "SettingHeight: "+adjustment);
        this.setBackgroundColor(Color.BLUE);
    }

    private void doBetweenAddressAndTopBox(Context context, int adjustment) {
        this.setMinimumHeight(adjustment);
    }

    private void doBetweenTopAndAddress(Context context, int adjustment) {
        this.setMinimumHeight(adjustment);
    }

    private int getValueForLargeDevice(double increment) {
        int largeDeviceAdjustment = 0;
        if(dpHeight > 750) {
            int difference = (int)dpHeight - 750;
            int interval = 25;
            int iterations =  (difference / interval) > 12 ? 12 : (difference / interval);
            int increasePerInterval = 0;
            for(int i=0; i < iterations; i++) {
                largeDeviceAdjustment += increment;
            }
            return largeDeviceAdjustment;
        } else {
            return 1;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T20:20:09.883

我认为你的代码很好。您的布局可能有问题。您是否按如下方式设置布局？

```
 <com.example.dynamicspacerlayout.SummaryDynamicSpacer
      android:id="@+id/betweenAddressAndTopBox"
      android:layout_width="match_parent"
      android:layout_height="wrap_content" > 
```

**看到这[minHeight 也有什么作用吗？](https://stackoverflow.com/questions/7408151/does-minheight-do-anything)**

运行您的代码的 GalaxyNexus 屏幕截图

![在此处输入图像描述](../Images/b83525ea0bf46b64d95bd6cd9088f294.png)

Nexus7 屏幕截图

![在此处输入图像描述](../Images/2c63dbcc541477e0388d9ea42232bd34.png)

activity_main.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:ems="10" 
        android:hint="Top Text">

        <requestFocus />
    </EditText>

<com.example.dynamicspacerlayout.SummaryDynamicSpacer
    android:id="@+id/betweenAddressAndTopBox"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="TextView"
        android:textColor="@android:color/white"
         />
</com.example.dynamicspacerlayout.SummaryDynamicSpacer>

<EditText
    android:id="@+id/editText2"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:ems="10" 
    android:hint="Bottom Text"
    />

</LinearLayout> 
```

MainActivity.java

```
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    new Handler().postDelayed(new Runnable() {

        @Override
        public void run() {
            int minimumHeight = findViewById(R.id.betweenAddressAndTopBox).getHeight();
            TextView text = (TextView) findViewById(R.id.textView1);
            text.setText("Height: " + minimumHeight);
//              text.setVisibility(minimumHeight > 1 ? View.VISIBLE : View.GONE);
        }
    }, 1000);

}
} 
```

希望有帮助！

# c# - 在什么情况下你会得到`System.UnauthorizedAccessException`？

> ID：15263198
> 
> 赞同：0
> 
> 时间：2013-03-07T04:40:10.660
> 
> 标签：c#, windows-phone-8

我正在制作一个应用程序，以在特定时间间隔后通过网络异步发送我的 Windows 8 Phone 的电池电量。我正在使用`DispatcherTimer`for call 在某个特定时间间隔后发送电池电量。

```
DispatcherTimer timer = new DispatcherTimer();      //Create the timer instance
        timer.Interval = TimeSpan.FromSeconds(15);          //Set the timer interval
        timer.Tick += SendAsyncRequest;                     //Call this procedure after the time ends

        timer.Start(); 
```

我想使用 POST 请求发送我的电池电量。

```
void SendAsyncRequest(object sender, object e)
    {
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://192.168.2.17/android_connect/add_device.php");            
        request.Method = "POST";
        request.BeginGetRequestStream(new AsyncCallback(SendBatteryLevel), request);

    } 
```

现在，我发送实际请求 ( ) 的代码的核心`SendBatteryLevel`如下：

```
void SendBatteryLevel(IAsyncResult asynchronousResult)
    {
        HttpWebRequest request = (HttpWebRequest)asynchronousResult.AsyncState;
        using (Stream postStream = request.EndGetRequestStream(asynchronousResult))
        {
            string username = "CoolSops";
            string deviceId = "WindowsPhone";
            string batteryLevel = Windows.Phone.Devices.Power.Battery.GetDefault().RemainingChargePercent.ToString();
            string post_param = "username=" + username + "&device_id=" + deviceId + "&battery_level=" + batteryLevel;
            try
            {
                byte[] requestBody = System.Text.Encoding.UTF8.GetBytes(post_param);
                postStream.Write(requestBody, 0, requestBody.Length);
                SendingStatus.Text = "Battery data sent";
                postStream.Close();
            }
            catch (Exception e)
            {
                Deployment.Current.Dispatcher.BeginInvoke(() =>
                {
                    ErrorStatus.Text = e.ToString();
                });                   
                Console.WriteLine(e.Message + "\n\n" + e.Source + "\n\n" + e.StackTrace);
            }
        }           
    } 
```

在哪里`SendingStatus`和`ErrorStatus`是`TextBlock`s。当我执行此代码时，我得到一个`System.UnauthorizedAccessException`. 异常详情如下：

```
A first chance exception of type 'System.UnauthorizedAccessException' occurred in System.Windows.ni.dll
An exception of type 'System.UnauthorizedAccessException' occurred in System.Windows.ni.dll and wasn't handled before a managed/native boundary 
```

我不明白我试图以未经授权的方式访问什么。谁能说出为什么会这样？

注意：我在调试程序时注意到了一件有趣的事情。当从方法`SendBatteryLevel`调用方法`SendAsyncRequest`时，从控件执行几行后`SendBatteryLevel`返回`SendAsyncRequest`。我试图找出控制返回的确切行数，`SendAsyncRequest`但每次都不同。因此，在方法`SendBatteryLevel`完全执行之前，该方法会以这种方式被调用两次或有时三次。可能这就是导致异常发生的原因。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T16:42:58.337

可以以更简单的方式使用字节数组。在获取响应流之前
还需要设置。`ContentLength`

尝试这个：

```
HttpWebRequest request = (HttpWebRequest)WebRequest.Create("http://192.168.2.17/android_connect/add_device.php");
request.Method = "POST";

string username = "CoolSops";
string deviceId = "WindowsPhone";
string batteryLevel = Windows.Phone.Devices.Power.Battery.GetDefault().RemainingChargePercent.ToString();
string post_param = "username=" + username + "&device_id=" + deviceId + "&battery_level=" + batteryLevel;

byte[] requestBody = System.Text.Encoding.UTF8.GetBytes(post_param);

request.ContentLength = requestBody.Length;

request.BeginGetRequestStream(
    result =>
    {
        using (var postStream = request.EndGetRequestStream(result))
        {
            postStream.Write(requestBody, 0, requestBody.Length);
            postStream.Close();
        }

        request.BeginGetResponse(
            (response) =>
            {
                // Handle response here....
            },
            null);
    },
request); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T12:59:53.013

您是否在 WMAppManifest.xml 中设置了所有必要的功能？

在我看来，您忘记启用 ID_CAP_IDENTITY_DEVICE、ID_CAP_IDENTITY_USER 或 ID_CAP_NETWORKING。

你从哪里得到异常？你能得到电池状态吗？

# jquery - jQuery - 当我将鼠标悬停在元素 A 上时，如何隐藏元素 B？

> ID：15263199
> 
> 赞同：1
> 
> 时间：2013-03-07T04:40:21.943
> 
> 标签：jquery, hover, hide

我有两个元素，我需要在元素 A 的鼠标悬停时隐藏元素 B。我将如何使用 jQuery 来做到这一点？我目前的代码是这样的：

```
$(".rule").hover(function() {
            $(".jobDesc").hide();
        }
    ); 
```

我正在使用 jQuery 1.7.1.min，顺便说一句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T04:45:13.880

您必须在 DOM 就绪时调用它，然后它才能为您工作

```
$(function (){
 $(".rule").hover(function() {
        $(".jobDesc").hide();
    }); 
}) 
```

这是[演示](http://jsfiddle.net/Pervez/Kvg8M/4/)

# augmented-reality - 有没有办法在没有模式识别的情况下显示？

> ID：15263205
> 
> 赞同：-1
> 
> 时间：2013-03-07T04:40:54.657
> 
> 标签：augmented-reality

有了增强现实，有没有什么方法可以显示 3d 模型或任何东西而无需模式识别？有一项服务允许您使用增强现实试戴戒指，但它需要模式识别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:11:22.363

这取决于你到底要增强什么。例如，如果您有一部带有加速度计等的手机，并且您想在夜总会的门上方显示一品脱苹果酒的最便宜价格，则不需要模式识别。但是，如果您想处理相机看到的内容（例如您的戒指示例）并对其做出响应，那么您确实需要模式识别。如果你对音频有反应——或者类似的事情——你也需要模式识别，而不是我想不出你要如何或为什么要这样做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T00:25:28.607

从技术上讲，有一种模式，但它是一种无形的模式......

当您进行 3D 跟踪或 SLAM 时，您跟踪的不是打印的图案，而是由对象或环境构成的地图。然而，手是硬的。它更适用于建筑物等静态对象。

以下是有关它的更多信息：

[http://dev.metaio.com/toolbox/](http://dev.metaio.com/toolbox/)

# java - Java 中的 Groovy 语法检查

> ID：15263206
> 
> 赞同：2
> 
> 时间：2013-03-07T04:40:55.797
> 
> 标签：java, groovy

我正在实现一个基于 Web 的 Groovy 代码编辑器，并且需要检查代码中的语法错误。下面的 Java 实现工作正常，但生成的消息包含一些不需要的元素（粗体）。我正在寻找一种单独列出警告和错误的方法。我正在使用这个 Maven 依赖项：[groovy-all 2.1.1](http://mvnrepository.com/artifact/org.codehaus.groovy/groovy-all/2.1.1)

```
try {
    new GroovyShell().parse(groovyCode);            
} catch(CompilationFailedException cfe) {
    System.out.println(cfe.getMessage());
} 
```

输出：

```
startup failed:

Script1.groovy: 1: unexpected token: n @ line 1, column 19.

def factorial(n)  n == 1 ? 1 : n * factorial(n - 1) }
                         ^

1 error 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T10:12:06.393

解析错误消息没有多大意义。试着调查

```
CompilationFailedException.getUnit()
ProcessingUnit.getErrorCollector()
ErrorCollector.getWarnings() & getErrors() 
```

**编辑**

好的，看起来`unit`在`CompilationFailedException`. 尝试捕捉`MultipleCompilationErrorsException`：

```
try {
    new GroovyShell().parse(groovyCode);
} catch(MultipleCompilationErrorsException cfe) {
    ErrorCollector errorCollector = cfe.getErrorCollector();
    System.out.println("Errors: "+errorCollector.getErrorCount());
} 
```

顺便说一句，看看`ErrorCollector`源代码，您可能会发现`write`输出有关编译错误信息的方法很有用。

# git - Git：通过从以前的提交中签出旧版本来丢失对文件的非暂存更改？

> ID：15263208
> 
> 赞同：0
> 
> 时间：2013-03-07T04:41:10.767
> 
> 标签：git

编辑：我可以通过查看 Eclipse 的 Team > Local History 部分来取回文件。尽管如此，这似乎是 git 的奇怪行为。默认情况下，破坏性行为似乎应该有警告。

看来我已经让 git 让我陷入一种虚假的安全感并失去了一些工作。但希望我误解了一些东西。

情况：

我对文件“page_classes.py”做了很多更改。我意识到我做了一个糟糕的改变，想看看旧版本的样子，所以我按照（[如何在 git 中将文件恢复到以前的状态？](https://stackoverflow.com/questions/35284/how-do-i-restore-files-to-previous-states-in-git)）的指示做了

> git checkout c154ac3a6b1b723226c5b49ed6acaae614bed030 search_engine/page_classes.py

我看到了我想要的，然后想回到我正在做的事情，所以我做了：

> git checkout lastfm search_engine/page_classes.py

（lastfm 是我正在研究的分支。）

令人沮丧的是，page_classes.py 仅恢复到我上次提交时的状态，那是大约一个小时前（即在我进行大量更改之前）。

我既没有提交也没有进行更改（因为我已经开始假设 git 不会在没有警告的情况下破坏工作），但现在看来我无法恢复我的工作。这个答案暗示了很多：（[Git is it possible to revert unstaged files after a checkout](https://stackoverflow.com/questions/14138193/git-is-it-possible-to-revert-unstaged-files-after-a-checkout)）

我错了，工作没了？如果是这样，我对 git 会在没有警告的情况下覆盖并丢弃我的文件的新版本感到惊讶吗？

# javascript - 如果未选择，则删除强制选项

> ID：15263210
> 
> 赞同：0
> 
> 时间：2013-03-07T04:41:13.687
> 
> 标签：javascript, jquery, html, css, forms

我有一个包含 3 种不同付款方式的表格：

1 - 直接存款
2 - 信用卡
3 - 办公室现金

如果未选择信用卡，我想要做的是从信用卡的表单字段中删除强制状态（验证），以便表单可以在不请求此信息的情况下进行处理。

有任何想法吗？我目前有一个 JSfiddle：http: [//jsfiddle.net/barmar/Kvg8M/2/](http://jsfiddle.net/barmar/Kvg8M/2/)

JS代码：

```
 $(document).ready(function () {
        $(".paymentmethod").click(function () {
        $(".paymentinfo").hide();
        switch ($(this).val()) {
        case "Direct Deposit":
            $("#pay0").show("slow");
            break;
        case "Credit Card Authorisation":
            $("#pay1").show("slow");
            break;
        case "Cash at FAA Office (In Person)":
            $("#pay2").show("slow");
            break;
            }
        });
    }); 
```

我也在使用 Adob​​e Business Catalyst，如果这有帮助还是有阻碍？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:42:56.320

尝试这个

```
$(document).ready(function () {
        $(".paymentmethod").click(function () {
        $(".paymentinfo").hide();
        switch ($(this).val()) {
        case "Direct Deposit":
            $("#pay0").show("slow");
         $("#filedID").rules('remove', 'required');
            break;
        case "Credit Card Authorisation":
            $("#pay1").show("slow");
            break;
        case "Cash at FAA Office (In Person)":
            $("#pay2").show("slow");
            break;
            }
        });
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:08:37.103

**点**：`req`是对归档值要求的受影响类别。如果`req`类适用于任何元素，则必须填写为您的代码。

**提示：**因此，如果您从 element.xml 中删除此类，请简单考虑。它不是必须填充元素。如果你再次添加这个类，它将是必须填充元素。

**如果使用 jQuery，**如何从元素中添加或删除类：****

 **```
$('#CardName').addClass('req');
$('#CardName').removeClass('req'); 
```

如果你不使用 JQuery 看这里。

[使用 JavaScript 从元素中删除 CSS 类（无 jQuery）](https://stackoverflow.com/questions/2155737/remove-css-class-from-element-with-javascript-no-jquery)

* * *

```
$(document).ready(function () {

function setMend() {
   alert("seting mend");
  $('#CardName').addClass('req');
  $('#CardNumber').addClass('req');
  $('#CardExpiryMonth').addClass('req');
}

function unsetMen(){
    alert("unseting mend");
    $('#CardName').removeClass('req');
    $('#CardNumber').removeClass('req');
    $('#CardExpiryMonth').removeClass('req');
 }

    $(".paymentmethod").click(function () {
        $(".paymentinfo").hide();
        switch ($(this).val()) {
            case "Direct Deposit":
                $("#pay0").show("slow"); 
                unsetMen();                
                break;
            case "Credit Card Authorisation":
                $("#pay1").show("slow");
                setMend();
                break;
            case "Cash at FAA Office (In Person)":
                $("#pay2").show("slow"); 
                unsetMen();
                break;
        }
    });
}); 
```

* * ***

# javascript - 在asp.net中将行从一个gridview复制到另一个gridview

> ID：15263213
> 
> 赞同：3
> 
> 时间：2013-03-07T04:41:33.223
> 
> 标签：javascript, asp.net, gridview

我有一个包含列的gridview：

名字 | 姓氏 | 添加

```
<asp:GridView ID="gv1" runat="server" AllowPaging="True" AllowSorting="True" AutoGenerateColumns="False"
            DataKeyNames="AuthorID" DataSourceID="SqlDataSource1" OnRowCommand="gv1_RowCommand">
            <Columns>
                <asp:BoundField DataField="FirstName" HeaderText="FirstName" SortExpression="FirstName" />
                <asp:BoundField DataField="LastName" HeaderText="LastName" SortExpression="LastName" />
                <asp:ButtonField ButtonType="Button" Text="Add" />
            </Columns>
        </asp:GridView> 
```

单击添加按钮时，将此行复制到第二个网格视图并从原始网格视图中隐藏/删除该行。这该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:49:38.317

[http://forums.asp.net/p/1297473/2522734.aspx](http://forums.asp.net/p/1297473/2522734.aspx)

[http://aspdotnetcodebook.blogspot.com/2009/04/how-to-move-selected-record-from-one.html](http://aspdotnetcodebook.blogspot.com/2009/04/how-to-move-selected-record-from-one.html)

看看这些链接。这会帮助你

# foursquare - 监控 FourSquare 实时 API 的系统方法？

> ID：15263218
> 
> 赞同：0
> 
> 时间：2013-03-07T04:41:59.713
> 
> 标签：foursquare

是否有系统/程序化的方式来监控实时推送通知失败？我发现实时 API 通知可能会间歇性地失败，我希望在发生这种情况时得到通知。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T16:39:00.333

通常由于应用程序端的错误而推送“失败”，基本上是每当您的推送 URL 不返回 200 时。尽管如此，您仍会收到来自 Foursquare 的推送，因此对您的应用程序的所有推送进行认真监控/记录应该有助于您识别当他们失败时。

如果您在收到我们的推送后进行大量处理，那么您返回 200 的速度可能太慢了。Foursquare 将假定请求超时并将其报告为推送失败。为了缓解这种情况，您应该始终立即返回 200，然后进行任何处理。

这种情况很少发生，但有时错误可能来自 Foursquare 端。有关平台上的最新状态，您应该在 Twitter 上关注[@foursquareAPI ，我们会在其中传达停机时间和其他更新。](https://twitter.com/foursquareapi)

# android - Android应用程序中的云端点身份验证失败

> ID：15263228
> 
> 赞同：4
> 
> 时间：2013-03-07T04:42:53.657
> 
> 标签：android, google-cloud-endpoints

我第一次尝试在 Google Cloud Endpoints android 应用程序的调试模式下使用身份验证时遇到问题。我设置了这样的凭据：

```
credential = GoogleAccountCredential.usingAudience(this,
           "server:client_id:long-string-i-got-from-api-console");
credential.setSelectedAccountName(accountName); 
```

然后尝试像这样使用它：

```
final String LOCAL_APP_ENGINE_SERVER_URL = "http://xxx.xxx.x.xxx:8888"; 
Testdbendpoint.Builder endpointBuilder = new Testdbendpoint.Builder(
            AndroidHttp.newCompatibleTransport(),
            new GsonFactory(),
            credential);
endpointBuilder.setRootUrl(LOCAL_APP_ENGINE_SERVER_URL + "/_ah/api/");
Testdbendpoint endpoint = endpointBuilder.build();
try {
    TestDB testDB = new TestDB().setId(10101L);                      
    TestDB result = endpoint.insertTestDB(testDB).execute();  //-- fails here!!!!
} catch ... 
```

但是尝试失败了，我在 logCat 中收到了这些消息：

> 03-06 23:33:20.418: W/System.err(11861): 由: com.google.android.gms.auth.GoogleAuthException: 未知 03-06 23:33:20.418: W/System.err(11861 ): 在 com.google.android.gms.auth.GoogleAuthUtil.getToken(Unknown Source) 03-06 23:33:20.423: W/System.err(11861): 在 com.google.android.gms.auth.GoogleAuthUtil .getToken(Unknown Source) 03-06 23:33:20.428: W/System.err(11861): at com.google.api.client.googleapis.extensions.android.gms.auth.GoogleAccountCredential.getToken(GoogleAccountCredential.java :192)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-11T01:00:02.077

也许您的 Android 客户端 ID 的证书指纹 (SHA1) 错误？仅当您手动签署 .apk 时，使用生产密钥指纹的身份验证才有效。

[在API Console](https://code.google.com/apis/console/)中使用 debug.keystore 指纹为已安装的应用程序 (Android) 注册 Client-Id 。要获取指纹，请使用：

```
C:\>keytool -list -alias androiddebugkey -keystore C:\.android\debug.keystore -storepass android -keypass android 
```

您还需要一个 Web-Client-Id 并在您的 Android 应用程序中将其设置为 Audience：

```
credential = GoogleAccountCredential.usingAudience(this,"server:client_id:" + WEB_CLIENT_ID); 
```

AppEngine Endpoint 配置应如下所示：

```
@Api(
    name = "testEndpoint",
    version = "v1",
    clientIds = {ClientIds.WEB_ID, ClientIds.ANDROID_PRODUCTION_ID, ClientIds.ANDROID_DEBUG_ID},
    audiences = {ClientIds.WEB_ID} 
```

)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:19:03.963

只是确定一下，但您是否在 Google API 控制台中注册了客户端 ID 以及 App Engine 应用 ID？那个谷歌帐户是否已添加到设备中？

此博客上的说明可能有用：
[http ://devthots.blogspot.com/](http://devthots.blogspot.com/)

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-13T11:56:35.203

我希望这可以帮助你。

```
import android.accounts.Account;
import android.app.Activity;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;
import android.support.annotation.NonNull;
import android.support.annotation.Nullable;
import android.support.v4.app.FragmentActivity;

import com.google.android.gms.auth.GoogleAuthException;
import com.google.android.gms.auth.GoogleAuthUtil;
import com.google.android.gms.auth.api.Auth;
import com.google.android.gms.auth.api.signin.GoogleSignInOptions;
import com.google.android.gms.auth.api.signin.GoogleSignInResult;
import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.api.GoogleApiClient;
import com.urbanft.utils.AppToast;

import java.io.IOException;

/**
 * Created by kiwitech on 13/10/16.
 */

public class GoogleLogin extends FragmentActivity implements GoogleApiClient.OnConnectionFailedListener {

    private GoogleSignInOptions gso;
    protected GoogleApiClient mGoogleApiClient;
    private int RC_SIGN_IN = 100;
    public static String GOOGLE_ACCESS_TOKEN = "google_access_token";
    public static String GOOGLE_USER_ID = "google_user_id";
    private String mGooglesUserId;

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        initialize();
    }

    private void initialize(){
        gso = new GoogleSignInOptions.Builder(GoogleSignInOptions.DEFAULT_SIGN_IN)
                .requestEmail()
                .build();

        mGoogleApiClient = new GoogleApiClient.Builder(this)
                .enableAutoManage(this , this)
                .addApi(Auth.GOOGLE_SIGN_IN_API, gso)
                .build();
    }

    protected void goForGoogleSignIn(){
        Intent signInIntent = Auth.GoogleSignInApi.getSignInIntent(mGoogleApiClient);
        startActivityForResult(signInIntent, RC_SIGN_IN);
    }

    public void onActivityResult(int requestCode, int resultCode, Intent data) {
        super.onActivityResult(requestCode, resultCode, data);
        if (requestCode == RC_SIGN_IN) {
            GoogleSignInResult result = Auth.GoogleSignInApi.getSignInResultFromIntent(data);
            if(result.isSuccess()){
                AppToast.showToast(this,"Google sign-in success");
                mGooglesUserId = result.getSignInAccount().getId();
                new LocalAsyncTask(result.getSignInAccount().getEmail()).execute();
            }else{
                AppToast.showToast(this,"Google sign-in failure");
                onBackPressed();
                finish();
            }
        }
    }

    class LocalAsyncTask extends AsyncTask<String,String,String> {

        private String email;

        LocalAsyncTask(String email) {
            this.email = email;
        }

        @Override
        protected String doInBackground(String... params) {
            String token = null;
            try {
                String SCOPE = "oauth2:https://www.googleapis.com/auth/userinfo.profile";
                Account account = new Account(email, "com.google");
                token = GoogleAuthUtil.getToken(GoogleLogin.this, account, SCOPE);
            } catch (IOException e) {
                e.printStackTrace();
            } catch (GoogleAuthException e) {
                e.printStackTrace();
            }
            return token;
        }

        @Override
        protected void onPostExecute(String s){
            Intent intent =new Intent();
            intent.putExtra(GOOGLE_ACCESS_TOKEN,s);
            intent.putExtra(GOOGLE_USER_ID,mGooglesUserId);
            setResult(Activity.RESULT_OK, intent);
            onBackPressed();
            finish();
        }
    }

    @Override
    public void onConnectionFailed(@NonNull ConnectionResult connectionResult) {
    }
} 
```

# ios - 在后台执行网络和其他耗时的任务

> ID：15263231
> 
> 赞同：3
> 
> 时间：2013-03-07T04:43:00.603
> 
> 标签：ios, multithreading, networking, nsurlconnection, grand-central-dispatch

我正在开发一个基于网络的 iOS 应用程序，它从服务器下载 json 数据并对其进行处理。下载任务和处理任务都需要很长时间才能完成，所以我不想在主线程上执行。

我认为有两种方法可以做到这一点：

1.  `NSURLConnection`使用和在`didFinishLoading`方法中使用**GCD**执行异步加载（比如）在后台进行处理。

2.  使用**GCD** `dispatch_async`（比如说）在后台开始工作并使用`NSURLConnection's` `sendSynchronousRequest:returningResponse:error`同步下载数据，对数据进行处理，并`UI`在主线程上调用更新。

我认为第二种方法更容易编写并且会产生更清晰的代码，特别是如果一个“下载/处理数据”任务涉及多个用于数据下载的顺序服务调用。因此，与其执行如下：

**主（开始）->后台（下载）->主（`NSURLConnectionDelegate`方法）->后台（数据处理）->主（`UI`更新**）

我们会有：

**main（开始）-> background（下载）-> background（数据处理）-> main（UI更新）对我来说似乎更干净。**

我发现了 2 个类似的问题：[Grand Central Dispatch 的 Internet 请求的良好模式？](https://stackoverflow.com/questions/6591416/good-pattern-for-internet-requests-with-grand-central-dispatch) 和
[NSURLConnection 和盛大的中央调度](https://stackoverflow.com/questions/5037545/nsurlconnection-and-grand-central-dispatch)

两者的答案似乎都建议使用在概念上类似于方法 1 的东西。

是否没有适当的方法来实现方法 2 中描述的内容？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-29T01:18:22.893

我不会倾向于追求选项#2。尽管它具有一定的简单性，`sendSynchronousRequest`但在下载过程中不提供进度更新、取消请求的能力（以及其他更复杂的场景）。一种`NSURLConnectionDataDelegate`方法使您可以更好地控制网络请求。

这个问题假定基于 GCD 的模式，但我认为操作队列模式值得考虑。您可以将`NSURLConnectionDataDelegate`方法提供的控制与封装网络请求的可取消操作结合起来。当您开始变得更复杂时，您可以开始使用并发请求，但也限制并发程度（例如不超过五个并发请求）。

我建议看看[AFNetworking](https://github.com/AFNetworking/AFNetworking)。也许你不想使用那个框架，但我还是会看看它采用的基于操作队列的模式。我个人会在上述任一 GCD 方法中使用该模式。

# iphone - iphone在没有登录的情况下发布到谷歌融合表

> ID：15263232
> 
> 赞同：4
> 
> 时间：2013-03-07T04:43:05.997
> 
> 标签：iphone, oauth, google-fusion-tables

我需要我的 iphone 应用程序来允许用户在不输入用户名和密码的情况下发布到谷歌融合表。目前我使用谷歌客户端登录，并将密码硬编码到应用程序中。显然这是一个糟糕的解决方案，但我找不到如何用 oauth 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-13T00:26:09.117

您希望用户将数据提交到他们自己的单个融合表，还是所有用户都修改您拥有的单个表？

对于第一种情况，您希望用户授权（通过 oauth）访问他们的帐户（Google 没有特定于 iOS 的客户端库，但这里有很多关于如何执行此操作的答案）

如果您希望每个人都将数据输入到同一个表中，最佳做法可能不是将密码和/或令牌硬编码到您的应用程序中，而是使用代理（例如通过在 AppEngine 上运行的服务帐户）。请注意，此代理仍应对您的 iphone 用户进行某种身份验证，因此随机人员无法在不运行您的应用程序的情况下轻松发布他们想要的任何内容。

# html - 带类的 div 将无法识别 CSS 样式

> ID：15263234
> 
> 赞同：1
> 
> 时间：2013-03-07T04:43:19.890
> 
> 标签：html, css

我创建了一个新的 div 并在里面放了一些东西。然后我转到样式表并创建了相应的样式。当我去刷新页面并检查元素时，div 没有从样式表中提取样式。帮助，因为它真的很令人沮丧。

这是html

```
<div class="2columnlayout">
        <div id="managecontent1">
            <img src="img/wordpress-logo.png" />
            <p>Wordpress</p>
        </div>
        <div id="managecontent2">
            <img src="img/filezillaicon.png" />
            <p>F.T.P.</p>
        </div>
    </div> 
```

这是它无法识别的相应css

```
.2columnlayout{
text-align: center;
font-size: 24px;
font-weight: 300;
margin-top: 90px; 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T04:44:11.593

像这样写：

```
.columnlayout2 
```

代替

```
.2columnlayout 
```

因为**CSS**无法识别以数字开头的`Class`& 。`ID`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T04:45:10.153

课程不能以数字开头。将其重命名为类似的`twocolumnlayout`名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T04:51:26.197

试试这个。

```
<div class="columnlayout">
        <div id="managecontent1">
            <img src="img/wordpress-logo.png" />
            <p>Wordpress</p>
        </div>
        <div id="managecontent2">
            <img src="img/filezillaicon.png" />
            <p>F.T.P.</p>
        </div>
    </div> 
```

样式表是：

```
.columnlayout div p{
text-align: center;
font-size: 24px;
font-weight: 300;
margin-top: 90px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T05:04:58.297

CSS的[语法规则](http://www.w3.org/TR/CSS21/syndata.html#tokenization)不允许以数字开头的标识符，例如`2columnlayout`，因此规则中的选择器无效，因此整个规则被忽略。

正如其他答案中所建议的，您可以通过使用以字母开头的类名来避免此问题。这在适用时通常是最好的。

但是，类名可以以数字开头（限制是 CSS 语法，而不是 HTML 语法），如果您*不能*更改类名，您可以使用[转义符号表示](http://www.w3.org/TR/CSS21/syndata.html#characters)数字。在这里，您可以将数字替换为`2`（`\32 `反斜杠、数字三、数字二、空格），这是一种基于数字的 Unicode 代码编号（十六进制 32）的转义符号：

```
.\32 columnlayout {
  /* declarations here */
} 
```

# php - 如何为php项目创建.exe可执行文件

> ID：15263236
> 
> 赞同：0
> 
> 时间：2013-03-07T04:43:27.467
> 
> 标签：php, yii, exe

我使用 YII 框架开发了一个项目。现在我想要单个可执行文件中的项目。

是否可以使用 yii 或 php 库创建。

如何为 yii 项目创建 .exe 可执行文件。

如果我安装它，是否可以将项目文件转换为某种格式

他们无法阅读的地方可能是某种加密格式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T04:53:29.703

简短的回答：不可能。

长答案：这取决于。

您可以在他的机器上安装 Web 和数据库服务器（或创建一个安装程序）并在他的机器上本地运行应用程序。

或者

您将应用程序保存在服务器上，只需提供一个启动器即可打开其浏览器并将其指向应用程序的 URL。

切换到 SQLite 而不是 MySQL 可能是个好主意，但根据您的应用程序的编写方式，它可能需要大量代码和 SQL 查询更改。

[PHP 桌面](http://code.google.com/p/phpdesktop/)允许您以与使用 php/html/js 构建网站相同的方式创建桌面应用程序。

方便的解决方案是不要将网站转换为 .exe。我认为如果您有便携式[服务器/php/mysql](http://portableapps.com/apps/development/xampp)并通过带有自动运行的 USB 或 CD 使网站工作会更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T04:51:13.973

有很多不错的选择，您可以在[PHP Compilers找到它们](http://www.bing.com/search?q=PHP%20Compiler)

我也用过[PHPLanger](http://www.php-compiler.net/doku.php)

# c# - 在更新面板中调用 Javascript ConfirmBox 时未显示

> ID：15263237
> 
> 赞同：0
> 
> 时间：2013-03-07T04:43:34.347
> 
> 标签：c#, javascript, asp.net

每当单击中继器中的链接按钮并通过某些条件时，我都会尝试显示 javascript 确认框。

我的中继器位于 Ajax Accordion 内容模板内的更新面板中。

```
<Accordion><UpdatePanel><Repeater>this is where the link button is</Repeater></UpdatePanel></Accordion> 
```

这是我的代码，我把它放在 Repeater_ItemCommand 方法中：

```
 Page.ClientScript.RegisterStartupScript(this.GetType(), "ConfirmDelete", "return confirm('Are You Sure Want To Delete?');"); 
```

我已经研究了几个代码解决方案，但仍然无法正常工作。我做错什么了？

更新：

如果我从 html 调用 javascript。它工作得很好。代码：

```
<asp:LinkButton ID="lbDelete" runat="server" OnClientClick="return confirm('Are you sure want to delete?');">Delete</asp:LinkButton> 
```

但我仍然不能从后面的代码中调用它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:44:51.247

试试这个（第四个参数设置为`true`）：

```
Page.ClientScript.RegisterStartupScript(this.GetType(), "ConfirmDelete", "return confirm('Are You Sure Want To Delete?');", true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T04:52:47.937

试试这个：

```
page.RegisterStartupScript(this, this.GetType(), "confirmDelete", "return confirm('confirm?\.');", true); 
```

也检查一下：[http ://forums.asp.net/t/1363887.aspx](http://forums.asp.net/t/1363887.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T05:02:13.320

试试这个

```
ScriptManager.RegisterStartupScript(this, typeof(string), "ConfirmDelete", 
    "return confirm('Are You Sure Want To Delete?');", true); 
```

**编辑**：

**客户端示例添加此**

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script type="text/javascript">
        function ShowConfirmation() {
            if (confirm("Are You Sure Want To Delete?") == true) {
                //Calling the server side code after confirmation from the user
                alert("Deleted");
            }
        }
    </script> 
```

**服务器端c#代码**

```
Page.ClientScript.RegisterStartupScript(this.GetType(), "showAl", "ShowConfirmation();", true); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-07T05:02:39.867

使用[此](http://social.msdn.microsoft.com/Forums/uk-UA/sharepointdevelopmentlegacy/thread/d94e1c53-9e6f-4b2b-8ab8-0538aeedba31)示例

```
 string sJs = "function ConfirmDelete() { return confirm("Are you sure?"); }
      Page.ClientScript.RegisterClientScriptBlock(GetType(), "jscode", sJs, true); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-07T05:17:18.937

您应该以这种方式将 js 放在中继器上。

```
<asp:Repeater runat="server" ID="rep">
    <ItemTemplate>
        <asp:Button runat="server" ID="btnDelete" CommandName="ConfirmDelete" OnClientClick="return confirm('Are You Sure Want To Delete?');" />
    </ItemTemplate>
</asp:Repeater> 
```

此外，在数据绑定期间，您需要将 设置`ID`为按钮的`CommandArgument`属性，以便在中继器的 item 命令中，您可以知道要删除哪个。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-07T05:46:25.117

您可以使用 Repeater_ItemDataBound 事件来实现它。当控件被绑定时，您只需使用按钮/链接按钮注册 javascript。下面的代码块会给你一个粗略的想法

```
 protected void rpt_ItemDataBound(object source, RepeaterCommandEventArgs e)
    {
      if (e.Item.ItemType == ListItemType.Item || e.Item.ItemType==  ListItemType.AlternatingItem)
       {
          LinkButton btn = (LinkButton)e.Item.FindControl("btnDelete");
          btn.Attributes.Add("onclick", "if ( ! confirm( 'Delete this record?' )) return false; ");

       } 
    } 
```

即使您的控件位于 ajax 手风琴面板中，这也将起作用。

这样，脚本将绑定到项目模板中的每个链接按钮项目。此代码查找 Item 或 AlternatingItem 行，使用 FindControl 方法查找 btnDelete 控件，然后将 onclick 属性添加到 Attributes 集合中。结果是当用户单击删除链接按钮时，会弹出一个确定/取消对话框以确认删除。

您可以使用以下参考链接找到更多信息

[参考](http://www.developer.com/net/asp/article.php/3609851/ASPNET-Tip-Use-the-ItemDataBound-Event-of-a-Repeater.htm)

# c++ - Qt QTcpSocket在读取数据时不发出信号

> ID：15263240
> 
> 赞同：1
> 
> 时间：2013-03-07T04:43:54.837
> 
> 标签：c++, qt, sockets, signals, slot

我需要在收到消息时更新聊天窗口的内容。这是我使用的两个功能：

```
void LinPop::_createChat(Client *socket)
{
    ChatDialog *chat = new ChatDialog();

    chat->setAttribute(Qt::WA_DeleteOnClose);
    qDebug() << "Connecting chat : ";
    qDebug() << connect(chat, SIGNAL(toSend(QString&)), socket, SLOT(send(QString&)));
    qDebug() << connect(socket, SIGNAL(gotTexted(QString)), chat, SLOT(updateChat(QString)));
    chat->exec();
} 
```

这是当套接字有要读取的内容时调用的插槽。它工作正常，除了没有发出信号或没有调用连接的插槽。

```
void Client::readyRead()
{
    if (this->_socket->bytesAvailable() > 0)
    {
        QByteArray data = this->_socket->readAll();
        QString text(data);

        emit gotTexted(text);
        qDebug() << "ReadyRead [" << text << "] [" << this->_socket->bytesAvailable() << "]";
    }
} 
```

控制台输出：

```
Connecting chat :  
true 
true 
Sent [ "Test" ] 
ReadyRead [ "Test" ] [ 0 ] 
```

现在，如果我这样做，它会进入一个无限循环，但突然信号/插槽工作正常，我的文本被发送到聊天窗口并显示：

```
void Client::readyRead()
{
    if (this->_socket->bytesAvailable() > 0)
    {
        QByteArray data = this->_socket->readAll();
        QString text(data);
        this->_socket->write(data); // Added this

        emit gotTexted(text);
        qDebug() << "ReadyRead [" << text << "] [" << this->_socket->bytesAvailable() << "]";
    }
} 
```

控制台输出：

```
Connecting chat :  
true 
true 
Sent [ "Test" ] 
ReadyRead [ "Test" ] [ 0 ] 
Update Chat [ "Test" ] 
ReadyRead [ "Test" ] [ 0 ]
// Infinite Loop 
```

我不明白为什么它首先不起作用，或者为什么当我把它变成无限循环时，它突然开始工作......

PS：这是 updateChat 插槽：

```
void ChatDialog::updateChat(QString text)
{
    this->ui->tbConv->insertPlainText(text);
    qDebug() << "Update Chat [" << text << "]";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T23:48:52.330

你如何执行套接字连接？我无法获得负责监听连接的代码。如果您没有任何其他 tcp 客户端，请尝试使用 telnet

# git - 如何在不同的项目中以不同的方式设置我的 Git user.name？

> ID：15263245
> 
> 赞同：0
> 
> 时间：2013-03-07T04:44:02.297
> 
> 标签：git, github

我正在做两个项目。我已经设置了 Git 配置

```
git config --global user.name "xxx" 
```

当我切换项目时，我想更改项目的名称，再次设置相同的配置。

如何在 Git 中为不同的项目设置不同的名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T04:50:42.187

只需省略`--global`单独配置每个 repo 的选项。并查看[http://blogs.msdn.com/b/oldnewthing/archive/2013/02/27/10397393.aspx](http://blogs.msdn.com/b/oldnewthing/archive/2013/02/27/10397393.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T05:07:09.353

在每个 git 项目中，在你`git init`做之后

```
git config user.name "xxx" 
```

# ios - 使用 AFnetworking 上传图像没有任何响应

> ID：15263250
> 
> 赞同：0
> 
> 时间：2013-03-07T04:44:30.630
> 
> 标签：ios, uiimagepickercontroller, afnetworking, image-uploading

这是问题所在：

1.  我想在完成从 imagepicker 中选择图像后立即上传图像。

2.  所以，我把我的代码放在 imagepicker 委托方法中使用 afnetworking 上传图像。

3.  但它没有任何反应。

    ```
    //set the imageview to current image after choosing
    profilePic.image = image;

    //dismiss the imagepicker
    [picker dismissModalViewControllerAnimated:YES];

    //start upload image code
    NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:
                            @"steventi1901", @"username",
                            UIImagePNGRepresentation(profilePic.image), @"profile_pic",
                            nil];

     AFHTTPClient *client = [[AFHTTPClient alloc] initWithBaseURL:updateProfile];
    NSData *imageToUpload = UIImagePNGRepresentation(profilePic.image);

    NSMutableURLRequest *request = [client multipartFormRequestWithMethod:@"PUT" path:@"" parameters:params
                                                constructingBodyWithBlock: ^(id <AFMultipartFormData>formData) {
        [formData appendPartWithFileData: imageToUpload name:@"file" fileName:@"temp.png" mimeType:@"image/png"];
        //NSLog(@"dalem");
    }];

    AFHTTPRequestOperation *operation = [[AFHTTPRequestOperation alloc] initWithRequest:request];

    [operation setCompletionBlockWithSuccess:^(AFHTTPRequestOperation *operation, id responseObject) {
        NSString *response = [operation responseString];
        NSLog(@"response: [%@]",response);

    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {

        if([operation.response statusCode] == 403){
            NSLog(@"Upload Failed");
            return;
        }
        NSLog(@"error: %@", [operation error]);

    }];

    [operation start];
    //end upload image code 
    ```

它真的没有任何反应，所以我不知道这个过程是失败还是成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-03-12T09:31:33.183

使用 Afnetworking 上传图像的最佳和简单方法。

请使用下面的 AFNetworking。

**pod 'AFNetworking', '~> 2.5.4'**

```
//Create manager

    AFHTTPRequestOperationManager *manager = [AFHTTPRequestOperationManager manager];

    //parameters if any
    NSMutableDictionary *AddPost = [[NSMutableDictionary alloc]init];

    [AddPost setValue:@"Addparma" forKey:@"param"];

    NSString * url = [NSString stringWithFormat:@"www.addyourmainurl.com"];;    

    NSLog(@"AddPost %@",AddPost);

    [manager POST:url parameters:[AddPost copy] constructingBodyWithBlock:^(id<AFMultipartFormData> formData) {

        //add image data one by one

        for(int i=0; i<[Array count];i++)
        {
            UIImage *eachImage  = [Array objectAtIndex:i];

            NSData *imageData = UIImageJPEGRepresentation(eachImage,0.5);

            [formData appendPartWithFileData:imageData name:[NSString stringWithFormat:@"image%d",i] fileName:[NSString stringWithFormat:@"image%d.jpg",i ] mimeType:@"image/jpeg"];

        }  

    } success:^(AFHTTPRequestOperation *operation, id responseObject) {

        NSLog(@"Success: %@", responseObject);

    } failure:^(AFHTTPRequestOperation *operation, NSError *error) {

        NSLog(@"Error: %@", error);

    }]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T13:29:49.707

你设置了选择器的代表吗？

```
[yourPicker setDelegate:self] 
```

# ruby - Why does `send` fail with Ruby 2.0 refinement?

> ID：15263261
> 
> 赞同：9
> 
> 时间：2013-03-07T04:45:36.227
> 
> 标签：ruby, ruby-2.0

Why does this not work?

```
module StringRefinement
  refine String do
    def bar
      length
    end
  end
end

using StringRefinement
"abcdefghijklmnopqrstuvwxyz".send(:bar)
#NoMethodError: undefined method 'bar' for "abcdefghijklmnopqrstuvwxyz":String 
```

Can someone explain why `send` doesn't work here? And is there a way to dynamically call methods defined in a refinement? I can't seem to find a good, full explanation of how refinements work in Ruby 2.0.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-07T12:50:43.787

Because [the specification](http://Bugs.Ruby-Lang.Org/projects/ruby-trunk/wiki/RefinementsSpec) says so:

> # Indirect method accesses
> 
> Any indirect method access such as `Kernel#send`, `Kernel#method`, and `Kernel#respond_to?` shall not honor refinements in the caller context during method lookup.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T11:17:02.990

I am tempted to say "This is by design". But again *[it's quite possible this design is not entirely stable](http://www.hark.com/clips/smdzwjmydj-sir-its-quite-possible-this-asteroid-is-not-entirely-stable)*. For example, the `module` and `class` scoping feature has been [removed](https://github.com/ruby/ruby/commit/537297d1cbcd2ed97488774e67c4fc001282a658) just a few months ago.

At the moment even on Ruby HEAD the only way is to use the root of all evil:

```
eval "puts 'abcdefghijklmnopqrstuvwxyz'.bar" # => 26 
```

But really, this is just for the lab, right ? Do not unchain such code, kitten would die.

# java - 创建银行程序

> ID：15263268
> 
> 赞同：1
> 
> 时间：2013-03-07T04:46:10.637
> 
> 标签：java

我几乎完成了一项任务。我正在创建一个银行程序，我几乎已经完成了所有工作。我坚持的部分是交易部分。我必须创建一个函数`public String getTransactionInfo(int n)`来返回银行账户的最后 n 笔交易。我似乎无法弄清楚这部分。我有一个变量`private int numOfTransactions`，我尝试将其合并到函数中，但它没有用。这就是我尝试过的。

```
public String gettransactionInfo(int n)
{
    numOfTransactions = n;
    return n;
} 
```

那没有用。无法弄清楚如何返回这是一个字符串。有任何想法吗？

```
import java.util.Scanner;
public class BankApp {
public static void main(String[] args) {
    Scanner s = new Scanner(System.in);
    Bank myBank = new Bank();

    int user_choice = 2;

    do {
        //display menu to user
        //ask user for his choice and validate it (make sure it is between 1 and 6)
        System.out.println();
        System.out.println("1) Open a new bank account");
        System.out.println("2) Deposit to a bank account");
        System.out.println("3) Withdraw to bank account");
        System.out.println("4) Print short account information");
        System.out.println("5) Print the detailed account information including last transactions");
        System.out.println("6) Quit");
        System.out.println();
        System.out.print("Enter choice [1-6]: ");
        user_choice = s.nextInt();
        switch (user_choice) {
            case 1: System.out.println("Enter a customer name");
                    String cn = s.next();
                    System.out.println("Enter a opening balance");
                    double d = s.nextDouble();
                    System.out.println("Account was created and it has the following number: " + myBank.openNewAccount(cn, d));
                    break;
            case 2: System.out.println("Enter a account number");
                    int an = s.nextInt();
                    System.out.println("Enter a deposit amount");
                    double da = s.nextDouble();
                    myBank.depositTo(an, da);
                    break;
            case 3: System.out.println("Enter a account number");
                    int acn = s.nextInt();
                    System.out.println("Enter a withdraw amount");
                    double wa = s.nextDouble();
                    myBank.withdrawFrom(acn, wa);
                    break;
            case 4: System.out.println("Enter a account number");
                    int anum = s.nextInt();
                    myBank.printAccountInfo(anum);
                    break;
            //case 5: ... break;
        }
}
while (user_choice != '6');
}

static class Bank {
private BankAccount[] accounts;     // all the bank accounts at this bank
private int numOfAccounts;      // the number of bank accounts at this bank

// Constructor: A new Bank object initially doesn’t contain any accounts.
public Bank() {
    accounts = new BankAccount[100];
    numOfAccounts = 0;
    }

// Creates a new bank account using the customer name and the opening balance given as parameters
// and returns the account number of this new account. It also adds this account into the account list
// of the Bank calling object.
public int openNewAccount(String customerName, double openingBalance) {

    BankAccount b = new BankAccount(customerName, openingBalance);
    accounts[numOfAccounts] = b;
    numOfAccounts++;
    return b.getAccountNum();
}

// Withdraws the given amount from the account whose account number is given. If the account is
// not available at the bank, it should print a message.
public void withdrawFrom(int accountNum, double amount) {
    for (int i =0; i<numOfAccounts; i++) {
        if (accountNum == accounts[i].getAccountNum()  ) {
            accounts[i].withdraw(amount);
            System.out.println("Amount withdrawn successfully");
            return;
        }
    }
    System.out.println("Account number not found.");
    }

// Deposits the given amount to the account whose account number is given. If the account is not
// available at the bank, it should print a message.
public void depositTo(int accountNum, double amount) {
    for (int i =0; i<numOfAccounts; i++) {
        if (accountNum == accounts[i].getAccountNum()  ) {
            accounts[i].deposit(amount);
            System.out.println("Amount deposited successfully");
            return;
        }
    }
    System.out.println("Account number not found.");
}

// Prints the account number, the customer name and the balance of the bank account whose
// account number is given. If the account is not available at the bank, it should print a message.
public void printAccountInfo(int accountNum) {
    for (int i =0; i<numOfAccounts; i++) {
                if (accountNum == accounts[i].getAccountNum()  ) {
                    System.out.println(accounts[i].getAccountInfo());
                    return;
                }
            }
    System.out.println("Account number not found.");
}

// Prints the account number, the customer number and the balance of the bank account whose
// account number is given, together with last n transactions on that account. If the account is not
// available at the bank, it should print a message.
public void printAccountInfo(int accountNum, int n) {
    for (int i =0; i<numOfAccounts; i++) {
                        if (accountNum == accounts[i].getAccountNum()  ) {
                            System.out.println(accounts[i].getAccountInfo());
                            System.out.println(accounts[i].getTransactionInfo(n));
                            return;
                        }
                    }
    System.out.println("Account number not found.");
    }

}

  static class BankAccount{

       private int accountNum;
       private String customerName;
       private double balance;
       private double[] transactions;
       private int numOfTransactions;
       private  static int noOfAccounts=0;

       public String getAccountInfo(){
           return "Account number: " + accountNum + "\nCustomer Name: " + customerName + "\nBalance:" + balance +"\n";
       }

       public String getTransactionInfo(int n)
       {
            numOfTransactions = n;
            return n;

        }

       public BankAccount(String abc, double xyz){
         customerName = abc;
         balance = xyz;
         noOfAccounts ++;
         accountNum = noOfAccounts;
         transactions = new double[100];
         transactions[0] = balance;
         numOfTransactions = 1;
       }

    public int getAccountNum(){
        return accountNum;
    }
    public void deposit(double amount){

        if (amount<=0) {
            System.out.println("Amount to be deposited should be positive");
        } else {
            balance = balance + amount;
            transactions[numOfTransactions] = amount;
            numOfTransactions++;
        }
    }
    public void withdraw(double amount)
    {
        if (amount<=0){
             System.out.println("Amount to be withdrawn should be positive");
         }
        else
        {
            if (balance < amount) {
                System.out.println("Insufficient balance");
            } else {
                balance = balance - amount;
                transactions[numOfTransactions] = amount;
                numOfTransactions++;
            }
        }
    }

}//end of class
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T05:04:50.037

我认为您的问题的正确解决方案是这样的：

```
 public String gettransactionInfo(int n)
{
  //Traverse the "transactions" array in *reverse* order
  //In For loop start with transactions.length, and decrement by 1 "n" times
  // Append the transaction amount to a String
 // Return the string.
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T05:02:33.627

```
public String gettransactionInfo(int n)
{
    numOfTransactions = n;
    return n;
} 
```

呵呵！你到底想在这里做什么？:) ...您搞砸了右值和左值，但这与答案无关。

关键是在类中有一个字符串数组。每次发生事务时，将事务详细信息附加到数组......然后 gettransactionInfo 应该打印字符串中的最后 n 个详细信息......

例如

```
transInfo[0] = "A deposited 30K"
transInfo[1] = "B withdrew 20K"
transInfo[2] = "C deposited 5k" 
```

Last 1 transaction 显示字符串“C deposit 5k”中的最后一个条目

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T04:57:39.040

如果要将事务数作为字符串返回，而不是整数（将其存储为整数），那么您希望将整数转换为字符串。

在 Java 中，您可以通过以下方式执行此操作：

```
Integer.toString(numOfTransactions) 
```

旁注：出于好奇，在您的程序中，您为什么要这样做？

```
public String gettransactionInfo(int n)
{
    numOfTransactions = n;
    return n;
} 
```

这是低效且错误的，因为您将 numberOfTransactions 设置为 n 值。按照惯例，该功能放在 setter 方法中，而不是 getter 方法 - 这是您的实现应该做的。

理想情况下，它应该是：

```
public String gettransactionInfo()
{
    return Integer.toString(numOfTransactions);
} 
```

编辑：

根据评论，正确的做法是从事务数组中返回一个索引，对应于索引 n。

在这种情况下，事务数组应该是一个字符串数组。

编辑2：

如果您使用单独的字符串数组，您将更新它（取决于事务），如下所示：

```
import java.util.Scanner;
public class BankApp {
public static void main(String[] args) {
    Scanner s = new Scanner(System.in);
    Bank myBank = new Bank();

    int user_choice = 2;

    do {
        //display menu to user
        //ask user for his choice and validate it (make sure it is between 1 and 6)
        System.out.println();
        System.out.println("1) Open a new bank account");
        System.out.println("2) Deposit to a bank account");
        System.out.println("3) Withdraw to bank account");
        System.out.println("4) Print short account information");
        System.out.println("5) Print the detailed account information including last transactions");
        System.out.println("6) Quit");
        System.out.println();
        System.out.print("Enter choice [1-6]: ");
        user_choice = s.nextInt();
        switch (user_choice) {
            case 1: System.out.println("Enter a customer name");
                    String cn = s.next();
                    System.out.println("Enter a opening balance");
                    double d = s.nextDouble();
                    System.out.println("Account was created and it has the following number: " + myBank.openNewAccount(cn, d));
                    break;
            case 2: System.out.println("Enter a account number");
                    int an = s.nextInt();
                    System.out.println("Enter a deposit amount");
                    double da = s.nextDouble();
                    myBank.depositTo(an, da);
                    break;
            case 3: System.out.println("Enter a account number");
                    int acn = s.nextInt();
                    System.out.println("Enter a withdraw amount");
                    double wa = s.nextDouble();
                    myBank.withdrawFrom(acn, wa);
                    break;
            case 4: System.out.println("Enter a account number");
                    int anum = s.nextInt();
                    myBank.printAccountInfo(anum);
                    break;
           case 5:  System.out.println("Enter a account number");
                    anum = s.nextInt();
                    myBank.printTransactionInfo(anum);
                    break;
          default: System.out.println("Invalid option. Please try again.");

        }
}
while (user_choice != '6');
}

static class Bank {
private BankAccount[] accounts;     // all the bank accounts at this bank
private int numOfAccounts;      // the number of bank accounts at this bank

    //Constructor: A new Bank object initially doesnâ€™t contain any accounts.
public Bank() {
    accounts = new BankAccount[100];
    numOfAccounts = 0;
    }

// Creates a new bank account using the customer name and the opening balance given as parameters
// and returns the account number of this new account. It also adds this account into the account list
// of the Bank calling object.
public int openNewAccount(String customerName, double openingBalance) {

    BankAccount b = new BankAccount(customerName, openingBalance);
    accounts[numOfAccounts] = b;
    numOfAccounts++;
    return b.getAccountNum();
}

// Withdraws the given amount from the account whose account number is given. If the account is
// not available at the bank, it should print a message.
public void withdrawFrom(int accountNum, double amount) {
    for (int i =0; i<numOfAccounts; i++) {
        if (accountNum == accounts[i].getAccountNum()  ) {
            accounts[i].withdraw(amount);
            System.out.println("Amount withdrawn successfully");
            return;
        }
    }
    System.out.println("Account number not found.");
    }

// Deposits the given amount to the account whose account number is given. If the account is not
// available at the bank, it should print a message.
public void depositTo(int accountNum, double amount) {
    for (int i =0; i<numOfAccounts; i++) {
        if (accountNum == accounts[i].getAccountNum()  ) {
            accounts[i].deposit(amount);
            System.out.println("Amount deposited successfully");
            return;
        }
    }
    System.out.println("Account number not found.");
}

// Prints the account number, the customer name and the balance of the bank account whose
// account number is given. If the account is not available at the bank, it should print a message.
public void printAccountInfo(int accountNum) {
    for (int i =0; i<numOfAccounts; i++) {
                if (accountNum == accounts[i].getAccountNum()  ) {
                    System.out.println(accounts[i].getAccountInfo());
                    return;
                }
            }
    System.out.println("Account number not found.");
}

public void printTransactionInfo(int accountNum) {
    for (int i =0; i<numOfAccounts; i++) {
                if (accountNum == accounts[i].getAccountNum()  ) {
                    System.out.println(accounts[i].getAccountInfo());
                    System.out.println("Last transaction: " + accounts[i].getTransactionInfo(accounts[i].getNumberOfTransactions()-1));
                    return;
                }
            }
    System.out.println("Account number not found.");
}

// Prints the account number, the customer number and the balance of the bank account whose
// account number is given, together with last n transactions on that account. If the account is not
// available at the bank, it should print a message.
public void printAccountInfo(int accountNum, int n) {
    for (int i =0; i<numOfAccounts; i++) {
                        if (accountNum == accounts[i].getAccountNum()  ) {
                            System.out.println(accounts[i].getAccountInfo());
                            System.out.println(accounts[i].getTransactionInfo(n));
                            return;
                        }
                    }
    System.out.println("Account number not found.");
    }

}
    static class BankAccount{

       private int accountNum;
       private String customerName;
       private double balance;
       private double[] transactions;
       private String[] transactionsSummary;
       private int numOfTransactions;
       private  static int noOfAccounts=0;

       public String getAccountInfo(){
           return "Account number: " + accountNum + "\nCustomer Name: " + customerName + "\nBalance:" + balance +"\n";
       }

       public String getTransactionInfo(int n)
       {
            String transaction = transactionsSummary[n];
            if (transaction == null) {
                return "No transaction exists with that number.";
            }
            else {
                return transaction;
            }
        }

       public BankAccount(String abc, double xyz){
         customerName = abc;
         balance = xyz;
         noOfAccounts ++;
         accountNum = noOfAccounts;
         transactions = new double[100];
         transactionsSummary = new String[100];
         transactions[0] = balance;
         transactionsSummary[0] = "A balance of : $" + Double.toString(balance) + " was deposited.";
         numOfTransactions = 1;
       }

    public int getAccountNum(){
        return accountNum;
    }

    public int getNumberOfTransactions() {
        return numOfTransactions;
    }

    public void deposit(double amount){

        if (amount<=0) {
            System.out.println("Amount to be deposited should be positive");
        } else {
            balance = balance + amount;
            transactions[numOfTransactions] = amount;
            transactionsSummary[numOfTransactions] = "$" + Double.toString(amount) + " was deposited.";
            numOfTransactions++;
        }
    }
    public void withdraw(double amount)
    {
        if (amount<=0){
             System.out.println("Amount to be withdrawn should be positive");
         }
        else
        {
            if (balance < amount) {
                System.out.println("Insufficient balance");
            } else {
                balance = balance - amount;
                transactions[numOfTransactions] = amount;
                transactionsSummary[numOfTransactions] = "$" + Double.toString(amount) + " was withdrawn.";
                numOfTransactions++;
            }
        }
    }

    }//end of class
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T04:54:32.463

要将整数转换为字符串：

```
String out = Integer.toString(n); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T05:00:46.307

您对案例 5 的描述是

> 打印详细的账户信息，包括最近的交易

仅将事务数作为字符串返回是无法实现的。

您需要将发生的每笔交易存储在 BankAccount 类的 transactions 数组中，然后在`gettransactionInfo()`函数中获取该数组中的最后 n 个值。

**编辑：**

顺便说一句，您忘记调用该`openNewAccount()`函数

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-07T05:10:06.643

将原始 int 转换为其包装类并调用其`toString()`方法

`public String gettransactionInfo(int n) { return new Integer(n).toString(); }`

# javascript - 在此函数中使用数组显示选中的复选框的值

> ID：15263270
> 
> 赞同：0
> 
> 时间：2013-03-07T04:46:20.707
> 
> 标签：javascript, jquery, arrays, checkbox, checked

此函数复制了 Select/MultiSelect 下拉元素的用户体验 - 显示容器中选中的复选框的值*（在选中/取消选中时添加/删除它们）*，如果选中了 3 个以上的项目，则显示 #选择而不是选择的值。

It's a combination of 2 functions and they're not playing well together when items are unchecked *(ie it's removing the values but not the commas, doesn't work correctly when more than 3 items have been selected, etc.)*

我认为如果我使用数组来存储值，在选中/取消选中项目时从数组中添加/删除值会更好，并且我知道如何在 PHP 中而不是在 Javascript 中。这段代码应该创建数组，但我不知道如何将它集成到我的代码中。

```
$('input:checkbox[name="color[]"]:checked').each(function () {
     selectedColors.push($(this).val());
}); 
```

**现有代码：**

*JS*

```
$(".dropdown_container ul li").click(function () {
    var text = $(this.children[0]).find("input").val();
    var text_edited = text.replace(/_/g, " ");
    var currentHtml = $(".dropdown_box span").html();
    var positionLocation = currentHtml.indexOf(text_edited);
    var numberChecked = $('input[name="color[]"]:checked').length;

    if (positionLocation < 1) {
        if (numberChecked <= 3) {
            $(".dropdown_box span").html(currentHtml.replace('Colors', ''));
            $(".dropdown_box span").append(', ' + text_edited);                                
            } else {
                $(".dropdown_box span").html(currentHtml.replace(currentHtml, numberChecked + " Selected"));
            }                                                            
    } else {
        (currentHtmlRevised = currentHtml.replace(text_edited, ""));
        $(".dropdown_box span").html(currentHtmlRevised.replace(currentHtml)); 
    }                
}); 
```

*HTML*

```
<div class="dropdown_box"><span>Colors</span></div>
<div class="dropdown_container">
    <ul id="select_colors">
        <li>
            <label><a href="#"><div style="background-color: #ff8c00" class="color" onclick="toggle_colorbox_alt(this);"><div class=CheckMark>&#10003;</div>
            <input type="checkbox" name="color[]" value="Black" class="cbx"/>
            </div>Black</a></label>
        </li>
        <!-- More List Items --!>
    </ul>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:11:04.750

最简单的是每次都替换整个内容。也使用`change`事件而不是`click`事件。

```
$(".dropdown_container input").change(function () {
    var checked = $(".dropdown_container input:checked");
    var span = $(".dropdown_box span");
    if (checked.length > 3) {
       span.html("" + checked.length + " selected");
    }
    else {
        span.html(checked.map(function () { return $(this).val().replace("_"," "); }).get().join(", "));
    }
}); 
```

示例：http: [//jsfiddle.net/bman654/FCVjj/](http://jsfiddle.net/bman654/FCVjj/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T06:31:21.610

试试这个：

```
 $('.cbx').change(function(){
      var cbx = $('.cbx:checked');
      var str = '';

      if (cbx.length<=3 && cbx.length!=0){
        for (var i=0;i<cbx.length;i++){
          if (i>0) str += ', ';
          str += cbx[i].value;
        }
     } else if (cbx.length==0){
       str = 'Colors';
     } else {
       str = cbx.length;
     }
     $('.dropdown_box span').html(str);
   }); 
```

# ruby-on-rails - 带有关联的 Simple_form 复选框

> ID：15263271
> 
> 赞同：0
> 
> 时间：2013-03-07T04:46:28.107
> 
> 标签：ruby-on-rails

我正在使用 simple_forms，我的目标是根据选择创建一个复选框。我应该将它保存在关联表中。

我写的模型像

```
class Purchase < ActiveRecord::Base

  attr_accessible :UserName, :cardno, :ctype
  has_many :items
end

class CreateItems < ActiveRecord::Migration
  def change
    create_table :items do |t|
      t.timestamps
    end
  end
end

class AddField < ActiveRecord::Migration
  def up
    add_column :purchases, :ctype, :string
    add_column :items, :item_name, :string
     add_column :items, :purchase_id, :integer
  end

  def down

    remove_column :purchases, :ctype
    remove_column :items, :item_name
     remove_column :items, :purchase_id
  end
end 
```

我写了 View like

```
<%= simple_form_for @purchase, :url => { :controller => 'payments', :action => 'show' } do |f| %>

<%= f.input :UserName, :label => "UserName:", :wrapper_html => { :class => 'uname_div'} %>
<%= f.input :cardno, :label => "Number On the Card:", :wrapper_html => { :class => 'uname_div'} %>
 <%= f.collection_radio_buttons :ctype, [[true, 'DebitCard'], [false, 'CreditCard']], :first, :last %>
<%= f.association :items, :label =>" Items Purchased:", :collection => ["Ac","Mobile","fridge"], :as => :check_boxes %>
<%= f.button :submit, :value => "Submit", :class => "sub_div" %>
<% end %> 
```

当我提交数据时，它会给出一个错误，例如

> ActiveModel::MassAssignmentSecurity::PaymentsController#show 中的错误
> 
> 无法批量分配受保护的属性：item_ids

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:08:52.883

您必须添加`item_ids`到模型中的列表中，如下所示：

```
attr_accessible :UserName, :cardno, :ctype, :item_ids 
```

这会将给定属性*列入白名单*并允许进行批量分配。

# android - 在 onTouch ACTION_MOVE 中更改视图高度

> ID：15263274
> 
> 赞同：4
> 
> 时间：2013-03-07T04:46:32.963
> 
> 标签：android, touch, touch-event, layoutparams

当用户在屏幕上向下移动手指时，我想更改视图高度。

```
 new OnTouchListener() {
        float lastY = Float.MIN_VALUE;

        @Override
        public boolean onTouch(View v, MotionEvent event) {
            if ((event.getAction() & MotionEvent.ACTION_MASK) == MotionEvent.ACTION_MOVE) {
                if (lastY != Float.MIN_VALUE) {
                    final float dist = event.getRawY() - lastY;

                    myView.post(new Runnable() {
                        @Override
                        public void run() {
                            ViewGroup.LayoutParams lp = myView.getLayoutParams();
                            lp.height += dist;
                            myView.setLayoutParams(lp);
                        }
                    });

                    view.invalidate();
                }
                lastY = event.getRawY();
            }

            if ((event.getAction() & MotionEvent.ACTION_MASK) == MotionEvent.ACTION_UP) {
                lastY = Float.MIN_VALUE;
            }

            return true;
        }
    } 
```

但是只有当用户停止移动手指时视图高度才会改变！

发生 ACTION_MOVE 时如何立即更改视图高度？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T07:25:51.427

*首先*，您不需要调用`invalidate()`，或者`requestLayout()`因为`setLayoutParams()` [已经这样做了，](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android/2.2_r1.1/android/view/View.java#View.setLayoutParams%28android.view.ViewGroup.LayoutParams%29)所以再次手动调用它只会导致不必要的开销。

*其次*，丢失`mView.post()`调用：`onTouch()`无论如何都在主（又名 UI）线程上执行。只需在正文中执行 layoutparams 的内容`onTouch()`以及其他所有内容。

*第三*，您的`mView.post()`调用可能是造成所有麻烦的原因，因为`View.post()`有效地将作业发布到 UI 线程`Handler`，该线程将作业排队，直到 UI 线程可以一一自由地执行它们。在您的情况下，它太忙`onTouch()`于在每个事件上运行您的方法，因此当您停止提供触摸事件时，您发布的所有内容都会被执行 - 即停止拖动。

*最后*，这是我在实现可调整大小视图时使用的主题的一个很好的参考，它也很可能涵盖了您尝试手动实现的所有功能： GitHub 上[的 k9mail 自己的`SplitView`类](https://github.com/k9mail/splitview/blob/master/lib/src/com/fsck/splitview/SplitView.java)。请注意他们如何将坐标保存在`ACTION_DOWN`块中，然后从那里测量高度，而不是`getHeight()`使用最后一个坐标增量调用和递增它。这允许减少一次操作 + 处理`ACTION_DOWN`，并且拥有 mDragging 布尔标志将允许您删除晦涩`lastY = Float.MIN_VALUE;`的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:32:30.933

而不是`view.invalidate()`你可以使用`view.requestLayout()`.

不过这不会很快，因为它会导致很多布局事件。如果不查看您的布局并且不知道您的目标是哪种效果，很难提供更多建议。

# api - 如何设计具有多个输入参数的 RESTful URL

> ID：15263278
> 
> 赞同：2
> 
> 时间：2013-03-07T04:46:58.393
> 
> 标签：api, rest, spring-mvc, restful-url, restful-architecture

我正在努力创建一个使用 Spring MVC 的基于 Java 的 RESTful API。

现在对于一些 API 端点——需要多个不同的参数......我不是在谈论值列表——更像是 parameter1、parameter2、parameter3、parameter4 等等——其中所有 4 个（或更多）参数也具有不同的数据类型。

如何为上述场景设计 API 端点 URL，例如 4 个单独的输入参数？有没有推荐的方法/最佳实践来做到这一点？还是我只是将这 4 个值连接起来，每对值都用“/”之类的分隔符分隔？

从用户评论编辑：

示例：我必须根据 4 个输入参数——（整数）用户 ID、（整数）文件 ID、（字符串）类型和（字符串）用户类型来检索自定义对象（“文件”）。我应该简单地创建一个像“getfile/{userid}/{fileid}/{type}/{usertype}”这样的 REST 端点——还是有更好的（或推荐的方法）来构建这样的 REST 端点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T12:55:28.737

在 REST 中，首先考虑资源并提出不可变的永久链接（不会更改）来识别该资源。

因此，在您的示例中（在评论中），您说要检索用户和类型的文件资源（文件类型或用户类型？）

因此，从足够的信息开始识别资源。如果 id 是唯一的，那么无论拥有该文件的用户如何，这都足以识别资源：

```
/files/{fileId} 
```

如果文件可以更改所有者，这对于 url 也很重要 - 请记住，我们只想使用所需的组件来识别资源，以便它可以成为永久链接。

您还可以列出特定用户的文件：

```
/users/{userId}/files/ 
```

响应将包含文件列表，列表中的每个项目都将包含指向文件的链接 (/files/{fileId})

如果由于某种原因文件 id 不是唯一的，但仅在用户的上下文中是唯一的（文件不会更改所有者和用户内的 id 增量 - 奇怪），那么您将需要这些组件来识别资源：

```
/users/{userId}/files/{fileId} 
```

另请注意基于描述的顺序。在那种奇怪的情况下，我们说文件在逻辑上由用户包含和标识，这也是 url 结构中的包含。

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:21:35.337

一个听起来不错的`GET`请求`file/{usertype}/{user}/{type}/{fileid}`

# mysql - 关于连接的 SQL 查询

> ID：15263282
> 
> 赞同：1
> 
> 时间：2013-03-07T04:47:10.763
> 
> 标签：mysql, sql-server

我正在做一个 SQL 数据库项目，我应该找到写过 3 本书或更多书的作者的名字。我的代码如下。该错误表示 A 缺少 FROM 并且我尝试了不同的 COUNT 选项。我尝试了许多不同的变体，但我仍然无法让它产生输出。

```
SELECT A.alastname FROM Author 
WHERE (SELECT COUNT(*) FROM Book B WHERE B.btitle = A.btitle AND B.title > 2); 
```

Author 包含名称，Book 包含标题、页面等。还有 Author_Book 包含帮助和出价。我需要使用联接吗？我仍然不明白如何在不使用运算符的情况下指定 3 本书以上。我不是在要求答案，如果可能的话只是一些指示:)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T04:48:54.170

缺少别名。

```
SELECT A.alastname FROM Author A 
WHERE (SELECT COUNT(*) FROM Book B WHERE B.btitle = A.btitle AND B.title > 2); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T04:58:05.900

您的原始查询不是有效的 SQL。

你可能是这个意思：

```
SELECT A.alastname
FROM Author A
WHERE (SELECT count(*) FROM Book B WHERE B.btitle = A.btitle) > 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T06:44:07.273

正如你所说，你有一个 Author<->Book 的关系表，所以你应该使用它：

```
SELECT A.alastname
FROM Author A
JOIN
(
 SELECT aid FROM Author_Book GROUP BY aid HAVING count(bid)>=3
) T
on (A.id=T.aid) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T04:49:56.700

看起来您缺少 Author 表的别名并试图将其引用为 A

```
SELECT A.alastname FROM Author as A 
WHERE (SELECT COUNT(*) FROM Book B WHERE B.btitle = A.btitle AND B.title > 2); 
```

# iframe - 从另一个 iFrame 控制一个 iFrame

> ID：15263283
> 
> 赞同：1
> 
> 时间：2013-03-07T04:47:15.787
> 
> 标签：iframe, target

这行得通……</p>

```
<a href="page.html" target="frameName">Link text</a> 
```

但这不是……</p>

```
<script type="text/javascript">
    window.onload = function() {
      var a = document.getElementById("mylink");
      a.onclick = function() {
        parent.document.getElementById('frameName').src = 'page.html';
      }
    }
</script>

<a id="mylink" href="page.html">LINK</a> 
```

知道为什么我不能通过 id 从一个 iFrame 到另一个 iFrame 获取元素吗？我也知道很少的代码，所以如果很明显，我提前道歉。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:16:04.800

首先，我会确保 IFrame 中网站的安全性允许您执行此类操作。查看此链接： [克服“X-Frame-Options 禁止显示”](https://stackoverflow.com/questions/6666423/overcoming-display-forbidden-by-x-frame-options)

接下来，我会担心你的锚标签的目标。指定它将默认为self。在您的第二段代码中，目标将是 _self。因此，当您单击链接时，您的 javascript 将要更改 IFrame 的源，而链接将要更改整个页面。我会选择链接的 JS 或 HTML 实现，而不是两者。这是我放在一起展示的一种在没有实际锚标记的情况下更改 iFrame 的方法。

```
<html>
<body>

<iframe id="frameName" src="page.html"></iframe>
<button onclick="changeFrame()">LINK</button>
<script>
    function changeFrame() {
          document.getElementById('frameName').src ='page2.html';
      }
</script>

</body>
</html> 
```

# php - 从 SQLite 数据库获取图像路径

> ID：15263287
> 
> 赞同：0
> 
> 时间：2013-03-07T04:47:22.510
> 
> 标签：php, html, sqlite

我有一个图像的路径存储在条目“路径”中的一个名为“图像”的表中。我正在尝试采用该路径并将其用作 HTML img 的 src。到目前为止，它不起作用。我的问题是，如何将查询的返回转换为 src 可以用作图像路径的字符串？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:50:37.587

您可以将图像数据转换为 base64 并将其粘贴在标签中。目前，您正在尝试在图像数据之外写入文本，而 Internet 浏览器认为您的文本是图像的一部分，因此会引发错误。

尝试这样的事情：

```
echo '<img src="data:image/jpeg;base64,' . base64_encode( $row['imageContent'] ) . '" />';
echo 'Hello world.'; 
```

# asp.net - EntityContext 在使用状态服务器的 UnitOfWork 模式中抛出“未标记为可序列化”

> ID：15263288
> 
> 赞同：1
> 
> 时间：2013-03-07T04:47:23.937
> 
> 标签：asp.net, entity-framework, webforms, repository-pattern, unit-of-work

背景是使用具有 Repository 和 UnitOfWork 模式的实体框架的 ASP.NET WebForms 应用程序。请注意，该应用程序还配置为使用进程外 StateServer 进行会话管理，我理解这意味着我存储在会话中的任何内容都必须是可序列化的。

我还有一个 HttpModule 配置为在每个 HttpRequest 上创建一个 UnitOfWork 对象（其中包含我的实体上下文对象），将其存储在 HttpContext.Current.Items 中，当然还可以在每个请求结束时处理它。

我的 UnitOfWork 类本身包含我的每个存储库的属性以及实体上下文本身。

为了在未来进行更灵活的测试，我创建了一个 IObjectContext 接口，其中包含实体上下文中的方法和属性的签名，并为我的实体上下文创建了一个分部类并从它继承。

```
public class UnitOfWork : IUnitOfWork
{
    private IObjectContext context;
}
public UnitOfWork(IObjectContext context)
{
    this.context = context;
}

public partial class MyEntities : IObjectContext
{
}

private static void ApplicationBeginRequest(Object source, EventArgs e)
{
    if (!HttpContext.Current.Items.Contains("UnitOfWork"))
    {
        IUnitOfWork unitOfWork = new UnitOfWork();
        HttpContext.Current.Items.Add("UnitOfWork", unitOfWork);
    }
}

private void ApplicationEndRequest(object sender, EventArgs e)
{
    if (HttpContext.Current.Items["UnitOfWork"] != null)
        ((IUnitOfWork)HttpContext.Current.Items["UnitOfWork"]).Dispose();
} 
```

这里的目标最终是允许我伪造我的实体上下文对象以创建例如用于测试目的的内存上下文。

一切都很好，直到我开始在我的实体上下文对象上收到“未标记为可序列化”异常。显然，我的第一个想法是将 [Serializable] 添加到我的部分实体上下文类中，但随后它开始抱怨 Assembly System.Data.Entity 中的 System.Data.Objects.ObjectContext 未标记为可序列化（我显然没有有任何控制权）。

我在这里想念什么？似乎我无法将我的实体上下文对象存储在 HttpContext.Current.Items 中，我必须为我的工作单元模式实现执行此操作。

这是因为我使用的是 ASP.NET 状态服务器而不是进程内会话管理吗？如果您使用状态服务器，那么肯定有一种方法可以在 HTTP 请求的整个生命周期内存储上下文吗？

只是觉得我在这里遗漏了一些明显的东西。我已将 [Serializable] 添加到从 UnitOfWork 到 MyEntities 上下文到每个存储库类的所有内容中。仍然无法超越实体上下文本身。

有任何想法吗？

更新（添加堆栈跟踪）：

```
[SerializationException: Type 'myDAL.Model.myEntities' in Assembly 'myDAL, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' is not marked as serializable.]
 System.Runtime.Serialization.FormatterServices.InternalGetSerializableMembers(RuntimeType type) +14324629
System.Runtime.Serialization.FormatterServices.GetSerializableMembers(Type type, StreamingContext context) +408
System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitMemberInfo() +420
System.Runtime.Serialization.Formatters.Binary.WriteObjectInfo.InitSerialize(Object obj, ISurrogateSelector surrogateSelector, StreamingContext context, SerObjectInfoInit serObjectInfoInit, IFormatterConverter converter, ObjectWriter objectWriter, SerializationBinder binder) +532
System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Write(WriteObjectInfo objectInfo, NameInfo memberNameInfo, NameInfo typeNameInfo) +969
System.Runtime.Serialization.Formatters.Binary.ObjectWriter.Serialize(Object graph, Header[] inHeaders, __BinaryWriter serWriter, Boolean fCheck) +633
System.Runtime.Serialization.Formatters.Binary.BinaryFormatter.Serialize(Stream serializationStream, Object graph, Header[] headers, Boolean fCheck) +322
System.Web.Util.AltSerialization.WriteValueToStream(Object value, BinaryWriter writer) +1487

[HttpException (0x80004005): Unable to serialize the session state. In 'StateServer' and 'SQLServer' mode, ASP.NET will serialize the session state objects, and as a result non-serializable objects or MarshalByRef objects are not permitted. The same restriction applies if similar serialization is done by the custom session state store in 'Custom' mode.]
System.Web.Util.AltSerialization.WriteValueToStream(Object value, BinaryWriter writer) +2485899
System.Web.SessionState.SessionStateItemCollection.WriteValueToStreamWithAssert(Object value, BinaryWriter writer) +49
System.Web.SessionState.SessionStateItemCollection.Serialize(BinaryWriter writer) +746
System.Web.SessionState.SessionStateUtility.Serialize(SessionStateStoreData item, Stream stream) +336
System.Web.SessionState.SessionStateUtility.SerializeStoreData(SessionStateStoreData item, Int32 initialStreamSize, Byte[]& buf, Int32& length, Boolean compressionEnabled) +99
 System.Web.SessionState.OutOfProcSessionStateStore.SetAndReleaseItemExclusive(HttpContext context, String id, SessionStateStoreData item, Object lockId, Boolean newItem) +3828904
System.Web.SessionState.SessionStateModule.OnReleaseState(Object source, EventArgs eventArgs) +1021
System.Web.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +80
System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +165 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T11:32:22.733

堆栈跟踪表明*session*中有一个不可序列化的对象，而不是上下文中。仔细检查您是否没有错误地将数据对象放入会话中。

将其放入上下文请求中不应给出此错误。

# virtual-machine - 在openstack上关闭实例的过程是什么？

> ID：15263292
> 
> 赞同：1
> 
> 时间：2013-03-07T04:47:57.313
> 
> 标签：virtual-machine, kvm, openstack, openstack-nova

在openstack cloud plantform上，如果我想关闭一个计算节点上的实例，openstack是做什么的？能告诉我过程吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T18:09:20.310

我认为您的意思是“终止”。

终止实例时，实例 ID 为 X 的正在运行的虚拟机将关闭并从它所在的物理主机中移除。

对此的 nova 客户端查询将是：

nova delete <instance-id> 或类似的东西。

当您进行该查询时，python-novaclient 正在与它自己的内部 API 交互以访问 nova-api RESTful API。它使用其查询的 http 标头中的身份验证令牌对自己进行身份验证。然后 nova-api 解释实例终止请求。它将验证它需要针对 keystone 的任何 ACL。然后它将执行必要的方法来关闭和删除实例，从而为将来的实例释放资源。然后它将返回一个结果。

更深入地讲，调度程序将根据 nova-api 查询通过消息系统发送请求。这些消息将被目标物理主机接收。nova-compute 将解释删除实例的请求，并执行自己的本地必要任务。通常这涉及与 libvirt 交互以关闭和释放实例资源。完成或失败后，它将响应消息总线的状态。API 最终会取回该消息并将其发送给最初请求该操作的用户。

# php - Zend 框架 1 提交表单 url/action

> ID：15263295
> 
> 赞同：0
> 
> 时间：2013-03-07T04:48:18.780
> 
> 标签：php, zend-framework

我正在制作一个 AJAX 注册表单，该表单将提交给 Zend 框架。现在，表单的操作似乎没有执行。响应文本是当前 HTML 文档的副本。有人可以告诉我我做错了什么，正确的 URL 应该是什么？我已经使用模块设置了项目。例如，下面示例中的正确 url 应该是：'/account/register/auth'

```
#application.ini
resources.router.routes.register.route = /register
resources.router.routes.register.defaults.module = account
resources.router.routes.register.defaults.controller = register
resources.router.routes.register.defaults.action = index

#application/modules/accout/controllers/RegisterController.php
<?php
    class Account_RegisterController extends Zend_Controller_Action{
        public function init(){
            $this->view->register = new Account_Form_Register();
        }

        public function indexAction(){

        }

        public function authAction(){
            $request = $this->getRequest();
            $form = new Account_Form_Register();

            if($request->isPost()){
                print('submit');
            }else{
                print('nothing yet');
            }
        }
    }
?>

#application/modules/account/views/scripts/register/index.phtml
<div class="register">
        <form id="registerForm">
            <h2 class="formHeader">Register</h2>

            <div class="floatLeft">
                <?php echo $this->register->fName; ?>
            </div>
            <div class="remaining">
                <?php echo $this->register->lName; ?>
            </div>

            <div class="floatLeft">
                <?php echo $this->register->uEmail; ?>
            </div>
            <div class="remaining">
                <?php echo $this->register->aEmail; ?>
            </div>

            <div class="">
                <?php echo $this->register->phone; ?>
            </div>

            <div class="floatLeft">
                <?php echo $this->register->oPassword; ?>
            </div>
            <div class="remaining">
                <?php echo $this->register->cPassword; ?>
            </div>

            <div id="formButton">
                <?php echo $this->register->submit; ?>
            </div>
        </form>
</div> 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-07T05:01:00.430

正如我所说，也许您应该在执行 AJAX 操作时禁用视图处理，以便返回 a`json_encode($some_data)`而不是 HTML 内容。

尝试

```
$this->_helper->viewRenderer->setNoRender(true); 
```

看看[这篇文章](http://www.luscarpa.com/snippets/zend-framework/disable-layout-and-view-render/)

# iphone - zBar 相机中的闪光灯

> ID：15263296
> 
> 赞同：1
> 
> 时间：2013-03-07T04:48:40.460
> 
> 标签：iphone, ios, flash, zbar

我正在使用 ZBAR 进行二维码扫描。我已经正确实现了 ZBar。现在我想在 Zbar 中打开或关闭闪光灯。

在 ZBar 网站上，我只获得有关 Torch 的信息，但没有有关闪光灯的信息。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T04:50:51.857

“闪光”是指灯“闪烁”一瞬间。“火炬”是指灯亮的时候。您确实想要“手电筒”，而不是“闪光灯”。如果灯只闪烁一秒钟，就很难扫描条形码。

我已经完成了你正在寻找的。我`UIBarButtonItem`在导航栏中添加了一个。我使用自定义图像创建了按钮。按钮处理程序如下：

```
- (void)torchToggle:(UIBarButtonItem *)button {
    if (button.style == UIBarButtonItemStyleBordered) {
        self.readerView.torchMode = AVCaptureTorchModeOff;
        if (self.readerView.torchMode == AVCaptureTorchModeOff) {
            button.style = UIBarButtonItemStyleDone;
        }
    } else {
        self.readerView.torchMode = AVCaptureTorchModeOn;
        if (self.readerView.torchMode != AVCaptureTorchModeOff) {
            button.style = UIBarButtonItemStyleBordered;
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-10T15:02:45.727

您可以使用以下代码打开或关闭闪光灯

```
ZBarReader?.cameraFlashMode = .off 
```

# c++ - 从 C++ 中的后台进程读取输出

> ID：15263301
> 
> 赞同：0
> 
> 时间：2013-03-07T04:49:03.120
> 
> 标签：c++, background-process, output

我有一个在程序开始时启动的后台进程，它每 20 毫秒生成一次输出数据。在我的程序中，我想读取这些数据，但想避免不断地写入/读取文件，因为这可能非常慢。

每次迭代的输出都是一个字符串（最大长度约 100 个字符），我只需要任何给定时间的最新数据。

理想情况下，我可以使用某种内存缓冲区来获取这些数据，但我不确定如何执行此操作。我已经研究过使用 popen （另请参见：[c++: subprocess output to stdin](https://stackoverflow.com/questions/8438277/c-subprocess-output-to-stdin)），但是，这似乎用于执行命令，并等待单个输出。我的输出或多或少会不断变化。我在[Raspbian](http://www.raspbian.org/)上运行这个程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:53:52.947

我认为您想将标准输出重定向到字符串流。它在[这里](https://stackoverflow.com/questions/4810516/c-redirecting-stdout)描述。

结合[这一项](https://stackoverflow.com/questions/955962/how-to-buffer-stdout-in-memory-and-write-it-from-a-dedicated-thread)。

现在您已经重定向了标准输出，并且能够将其发送到另一个进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T15:48:25.780

使用共享内存：为要共享的数据分配内存，并为互斥变量分配第二个段以处理锁定。

共享 float[9] 的示例代码：

服务器

```
int shmid, shmid_mutex;
key_t key = 1337, key_mutex = 1338;
float *shm;
pthread_mutex_t *shm_mutex;
int SHMSZ = sizeof(float[9]), SHMSZ_mutex = sizeof(pthread_mutex_t);

//Mutex shared memory
shmid_mutex = shmget(key_mutex, SHMSZ_mutex, IPC_CREAT | 0660); //Create the segment
shm_mutex = (pthread_mutex_t *)shmat(shmid_mutex, NULL, 0); //Attach the segment to data space
shmctl(shmid_mutex, SHM_LOCK, (struct shmid_ds *) NULL); //Lock this segment from being swapped

//Setup mutex attributes
pthread_mutexattr_t psharedm;
pthread_mutexattr_init(&psharedm);
pthread_mutexattr_setpshared(&psharedm, PTHREAD_PROCESS_SHARED);
//Initialize mutex
pthread_mutex_init(shm_mutex, &psharedm);

//Float array shared memory
shmid = shmget(key, SHMSZ, IPC_CREAT | 0660); //Create the segment
shm = (float *)shmat(shmid, NULL, 0); //Attach the segment to data space
shmctl(shmid, SHM_LOCK, (struct shmid_ds *) NULL); //Lock this segment from being swapped

float x = 0.1;
while(true)
{
    pthread_mutex_lock(shm_mutex); //start critical section
    //Write to shared memory
    for (int i = 0; i < 9; i++)
        shm[i] = x * i;
    x += 0.1;
    printf("W ");
    for (int i = 0; i < 9; i++)
        printf("%f ", shm[i]);
    printf("\n");
    usleep(100000); //slow down output to make it readable
    pthread_mutex_unlock(shm_mutex);  //end critical section
    usleep(10000); //wait for 10ms to simulate other calculations
} 
```

客户

```
int shmid, shmid_mutex;
key_t key = 1337, key_mutex = 1338;
float *shm;
pthread_mutex_t *shm_mutex;
int SHMSZ = sizeof(float[9]), SHMSZ_mutex = sizeof(pthread_mutex_t);

//Mutex shared memory
shmid_mutex = shmget(key_mutex, SHMSZ_mutex, IPC_CREAT | 0660); //Create the segment
shm_mutex = (pthread_mutex_t *)shmat(shmid_mutex, NULL, 0); //Attach the segment to data space
shmctl(shmid_mutex, SHM_LOCK, (struct shmid_ds *) NULL); //Lock this segment from being swapped

//Float array shared memory
shmid = shmget(key, SHMSZ, 0660); //Locate the segment
shm = (float *)shmat(shmid, NULL, 0); //Attach the segment to data space
shmctl(shmid, SHM_LOCK, (struct shmid_ds *) NULL); //Lock this segment from being swapped

while(true)
{
    pthread_mutex_lock(shm_mutex); //start critical section
    //Read from shared memory
    printf("R ");
    for (int i = 0; i < 9; i++)
        printf("%f ", shm[i]);
    printf("\n");
    usleep(100000); //slow down output to make it readable
    pthread_mutex_unlock(shm_mutex); //end critical section
    usleep(10000); //wait for 10ms to simulate other calculations
} 
```

# c - 用于 WinCE 应用程序的 Hello World（C 和 C++） - Visual Studio 2008

> ID：15263308
> 
> 赞同：0
> 
> 时间：2013-03-07T04:49:50.927
> 
> 标签：c, visual-c++, visual-studio-2008, precompiled-headers

我是 Visual Studio 2008（32 位）的初学者。我使用的 WinCE 版本是 7.0 评估版。我创建了一个新项目，

`New Project -> Platform Builder-> OS Design`

选择 BSP 作为，

`BSP: Generic CEPC:x86`

当设计模板突出显示`Consumer Media Device`时，我只是单击`Finish`。

以上选择对我来说是必须的。除此之外，我创建了一个子项目`a simple hello world application`并添加了一行`cout<<"Hello World";`（因为它们是默认的 cpp 文件）。我也包括在内`iostream`。

我遇到了错误，例如，

`fatal error C1083: Cannot open include file: 'iostream': No such file or directory`

[正如此链接](http://social.msdn.microsoft.com/Forums/en/vcgeneral/thread/e7aadd0a-cef7-4c20-a00f-35b43c2ca0c1)中所述，我检查了`libcmtd.lib`它，它位于`$(VCInstallDir)lib`. 它也包含在`Tools | Options | Projects and Solutions | VC++ Directories | Show Directories For -> Library files`.

基于[此链接](https://stackoverflow.com/questions/12614753/visual-studio-2012-c-hello-world)，我检查了预编译的标头设置。我在那里发现了以下内容：

```
Precompiled Files : Yes
Precompiled Header File Name : StdAfx.pch
Precompiled Header Object File Name : StdAfx.obj
Precompiled Header Options : (blank)
Precompiled Header Source File Name : StdAfx.h 
```

如何禁用此功能？如果我禁用它，我不会为项目的其他部分遇到任何其他问题吗？

**更新：**

对于 C 程序，

```
#include<stdio.h>

int main()
{
    printf("\nHello World\n");
    return 0;
} 
```

我收到以下错误，

```
error LNK2019: unresolved external symbol _WinMain referenced in function _WinMainCRTStartupHelper 

fatal error LNK1120: 1 unresolved externals 

fatal error U1077: 'D:\WINCE700\sdk\bin\i386\x86\link.EXE' : return code '0x460' 
```

这里的链接问题也可能是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T06:46:45.527

您编写的 C 代码在 WinCE 应用程序中不起作用。WinCE 应用程序的入口点是[WinMain](http://msdn.microsoft.com/en-us/library/windows/desktop/ms633559%28v=vs.85%29.aspx)，而不是常规的 main。

所有 iostream 的东西都来自 STL。根据我自己的经验，在 WinCE 和 Windows 桌面上实际实现 STL 的方式存在一些差异。这将是现在和将来问题的根源。这是[一篇讨论这些问题的 SO 文章](https://stackoverflow.com/questions/1373540/differences-in-microsofts-c-stl-for-windows-ce)。

以下是您在 WinCE 中的操作方法（代码未经实际测试）

```
#include "stdafx.h"

using namespace std;
#include <iostream>

int WINAPI WinMain (
      _In_  HINSTANCE hInstance,
      _In_  HINSTANCE hPrevInstance,
      _In_  LPSTR lpCmdLine,
      _In_  int nCmdShow)
{
    cout << "hello world" << endl;
    return 0;
} 
```

Windows 应用程序和 WinCE 应用程序遵循不同的规则，并且需要与控制台 (CRT) 应用程序不同的库。在 Visual Studio 中，创建默认 Win32 项目并创建默认控制台应用。然后在文本比较工具中比较所有三个项目文件。你会看到很多不同。这些差异至少包括以下内容：

*   不同的入口点——WinMain、_WinMain、_tWinMain 等
*   它们允许使用 windows.h 文件和所有相关设备
*   您必须链接到的一组不同的默认 .lib 文件

尽管如此，当您进入 GUI 内容时，WinCE 应用程序会变得很有趣。如果我是你，我会摆脱这些 C++ 的东西并进入[C# Compact Framework。](http://msdn.microsoft.com/en-us/library/f44bbwa1%28v=vs.80%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T07:26:11.280

当您要编写`main(argc, argv)`样式程序时，您必须在项目向导中选择**控制台应用程序。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T06:32:05.373

如前所述，在这类 WinCE 应用程序中不能使用`cout`or语句。`printf``010110110101`

相反，为了显示文本，我们将使用`DEBUGMSG`或`RETAILMSG`基于构建模式。

```
DEBUGMSG(TRUE,(TEXT("Hello World")));

RETAILMSG(TRUE,(TEXT("Hello World"))); 
```

例如，DEBUGMSG 不会在`Release`模式下工作。这些消息的语法在[此链接](http://msdn.microsoft.com/en-in/library/aa451065.aspx)中。

# ruby-on-rails-3 - Rails 应用程序在多台服务器上运行时的文件复制

> ID：15263312
> 
> 赞同：2
> 
> 时间：2013-03-07T04:50:09.020
> 
> 标签：ruby-on-rails-3, cloud, high-availability, rackspace

我的 Rails3 应用程序在 Rackspace 上的多个 VPS 服务器上运行。我们允许用户在我们的应用程序上上传图像并将这些文件放在 /public 目录中。

在服务器之间同步它的最佳方法是什么。

设置：Ubuntu 12.x 操作系统/Nginx/Phusion

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T18:00:16.543

与其复制数据，不如将其侧载到所有 VPS 都可以访问的标准位置？

通过仅拥有一份数据副本，这应该会降低整体带宽和存储成本。

# c# - C#读取一个excel，该excel是通过在Excel中转 换Gridview创建的

> ID：15263321
> 
> 赞同：-1
> 
> 时间：2013-03-07T04:50:36.973
> 
> 标签：c#, asp.net, excel

1）阅读此 excel 时。我收到“外部表不是预期格式”之类的错误。

2）当尝试通过双击打开一个excel文件时，我会变成这样

“您要打开的文件 ”just.xls' 的格式与文件扩展名指定的格式不同。在打开文件之前，请确认文件没有损坏并且来自受信任的来源。是否要打开现在的文件？"

请给出任何解决方案。这其中出了什么问题？请帮忙..！时间：2019-04-01 标签：c#asp.netexcel

**我正在使用以下代码在 Excel 中转换 Gridview：-**

```
string myfilename ="Attendenceformat" ;
    string attachment = "attachment; filename=" + myfilename + ".xls";
    Response.Cache.SetCacheability(HttpCacheability.NoCache);
    Response.AddHeader("content-disposition", attachment);
    Response.ContentType = "application/ms-excel";
    StringWriter swriter = new StringWriter();
    HtmlTextWriter htmlwriter = new HtmlTextWriter(swriter);

    // Create a form to contain the gridview(MyGridView)
    HtmlForm mynewform = new HtmlForm();
    GridView1.Parent.Controls.Add(mynewform);
    mynewform.Attributes["runat"] = "server";
    mynewform.Controls.Add(GridView1);
    mynewform.RenderControl(htmlwriter);
    Response.Write(swriter.ToString());
    Response.End(); 
```

**上传生成的 Excel 的代码如下**

```
 if ((txtFilePath.HasFile))
            {

                OleDbConnection conn = new OleDbConnection();
                OleDbCommand cmd = new OleDbCommand();
                OleDbDataAdapter da = new OleDbDataAdapter();
                DataSet ds = new DataSet();
                DataTable dt = new DataTable();
                string query = null;
                string connString = "";
                string strFileName = txtFilePath.FileName;
                //string strFileName = DateTime.Now.ToString("ddMMyyyy_HHmmss");
                string strFileType = System.IO.Path.GetExtension(txtFilePath.FileName).ToString().ToLower();

                //Check file type
                if (strFileType == ".xls" || strFileType == ".xlsx")
                {
                    //print progressbar
                    txtFilePath.SaveAs(Server.MapPath("~/UploadedExcel/" + strFileName + strFileType));

                }
                else
                {
                    lblMessage.Text = "Only Excel files(.xls or .xlsx) allowed";
                    lblMessage.ForeColor = System.Drawing.Color.Red;
                    lblMessage.Visible = true;
                    return;
                }

                string strNewPath = Server.MapPath("~/UploadedExcel/" + strFileName + strFileType);

                //Connection String to Excel Workbook
                if (strFileType.Trim() == ".xls")
                {
                    connString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" + strNewPath + ";Extended Properties=\"Excel 8.0;HDR=Yes;IMEX=2\"";
                }
                else if (strFileType.Trim() == ".xlsx")
                {
                    connString = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + strNewPath + ";Extended Properties=\"Excel 12.0;HDR=Yes;IMEX=2\"";
                }

                conn = new OleDbConnection(connString);
                cmd.Connection = conn;

                conn.Open();
                dt = conn.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);
                if (dt == null)
                {
                    lblMessage.Text = "Upload Excel files";
                    lblMessage.ForeColor = System.Drawing.Color.Red;
                    lblMessage.Visible = true;

                }

                string SheetName = dt.Rows[0]["TABLE_NAME"].ToString();

                query = "SELECT [Id],[RollNo],[Name],[Branch],[Sem],[Year],[Batch],[Subject],[Sessional],[Attendence],[OutOff] FROM  [Attendenceformat(1)$]";

                //Create the connection object
                  //Open connection
                if (conn.State == ConnectionState.Closed) conn.Open();
                //Create the command object
                cmd = new OleDbCommand(query, conn);
                //     cmd.Parameters.Add("stid",null);
                da = new OleDbDataAdapter(cmd);
                ds = new DataSet();
                da.Fill(ds);
                grvExcelData.DataSource = ds.Tables[0];
                grvExcelData.DataBind();

                lblMessage.Text = "Data retrieved successfully! Total Recodes:" + ds.Tables[0].Rows.Count;
                lblMessage.ForeColor = System.Drawing.Color.Green;
                lblMessage.Visible = true;

                da.Dispose();
                conn.Close();
                conn.Dispose();

            }
            else
            {
                lblMessage.Text = "Please select an excel file first";
                lblMessage.ForeColor = System.Drawing.Color.Red;
                lblMessage.Visible = true;
            }
        }
        catch (Exception em)
        {
            lblMessage.Text = em.Message;
            lblMessage.Visible = true;

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T04:58:03.627

看看这个链接：

[在 ASP.NET 中从 Excel 文件 (.xls) 读取数据](http://www.dotnetcurry.com/ShowArticle.aspx?ID=138)

[如何从 ASP.NET 应用程序将数据导出到 Excel](http://blogs.msdn.com/b/erikaehrli/archive/2009/01/30/how-to-export-data-to-excel-from-an-asp-net-application-avoid-the-file-format-differ-prompt.aspx)

希望这有帮助

# visual-studio - 防止签入项目文件

> ID：15263324
> 
> 赞同：1
> 
> 时间：2013-03-07T04:50:45.093
> 
> 标签：visual-studio, t4, ankhsvn

我试图阻止 ankhsvn 在我的项目中签入 app.config 文件。一点背景。

我喜欢生成我的 app.config，而不是将它们签入源代码管理，因为根据我的经验，每个开发人员都喜欢保留它的不同版本（这样对于多层系统，他们可以指向自己的开发系统）。

但是我仍然希望在我的项目中使用该文件，而不是在源代码管理中。然而，Ankh 似乎明白了这一点，这意味着我必须要签入它。是否有某种方式可以在全局范围内（仅限于该文件，但跨越所有用户和所有分支）阻止 Ankh 签入这个文件？

# sql - 如何获取子集的顶级记录？

> ID：15263329
> 
> 赞同：1
> 
> 时间：2013-03-07T04:51:24.840
> 
> 标签：sql, sql-server-2008, tsql, group-by

说我有一张桌子

```
StoreID   TotalSales   Month  Year
  --      ----------   -----  ----
  1         10           1    2012
  2         2            1    2012
  3         15           1    2012
  1         4            2    2012
  2         5            2    2012 
```

我需要：对于每个唯一的“月/年”，获取销售额最高的前两个 StoreID。

我不知道如何做到这一点。我试过了，`cross apply`但这似乎不起作用。这完全超出了我的想象，所以希望有人可以在正确的方向上给我一个轻推。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T04:59:58.850

此查询使用`Common Table Expression`and`Window Function`来获取行中的所有列。它适用于`SQL Server 2005 and up`

```
WITH records
AS
(
    SELECT  StoreID, TotalSales , Month, Year,
            DENSE_RANK() OVER (PARTITION BY Month, Year
                                ORDER BY TotalSales DESC) rn
    FROM    tableName
)
SELECT  StoreID, TotalSales , Month, Year
FROM    records
WHERE   rn <= 2 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!3/c1254/3)

# sms - at 命令通过短信发送图像/音频剪辑

> ID：15263335
> 
> 赞同：0
> 
> 时间：2013-03-07T04:51:51.513
> 
> 标签：sms, at-command

我以前使用 AT 命令通过 gsm 调制解调器将简单的文本消息从 PC 发送到移动设备。这是我提到的[链接。](http://www.developershome.com/sms/)但是，我想知道是否可以使用 AT 命令发送图像或短音频剪辑。我搜索了很多，但找不到任何来源。任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:02:41.643

我认为GSM调制解调器不可能。您可能需要一个 GPRS 调制解调器。但是我想知道是否有发送彩信的标准，尽管很明显有些制造商有自己的AT命令集。在我的 putal 调制解调器上，命令是`AT^UPLOADFILE`,`AT^MMSSEND`和`AT+EMMSEXE`. 您可以参考您自己的调制解调器的开发手册。

# ubuntu - Ubuntu 10.04 Puppet 和 Apache，apache 服务无法启动

> ID：15263337
> 
> 赞同：0
> 
> 时间：2013-03-07T04:52:00.570
> 
> 标签：ubuntu, apache2, puppet

目前正在运行一个关于使用 puppet 配置 vm 以自动创建服务器环境的基本教程

目前我正在跑步

```
puppet    3.1.0
apache2   2.2.14-5ubuntu Apache HTTP Server metapackage 
```

我有一个非常基本的初始化文件来加载 apache2 并确保它正在运行。

```
package {
  "apache2":
  ensure => present
}
service {"apache2":
  ensure => true,
  enable => true,
} 
```

当我尝试在此文件上运行 sudo puppet apply 时，出现以下错误

```
Error: Could not start Service[apache2]: Execution of '/etc/init.d/apache2 start' returned 1: 
Error: /Stage[main]//Service[apache2]/ensure: change from stopped to running failed: Could not start Service[apache2]: Execution of '/etc/init.d/apache2 start' returned 
```

我可以做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T23:01:23.227

需要安装该软件包才能启动该服务。所以让它成为一个要求：

```
package { 'apache2':
  ensure => present,
}

service { 'apache2':
  ensure  => running,
  enable  => true,
  require => Package['apache2'],
} 
```

如果仍然出现错误，请查看服务器日志。

# conditional-statements - 如果登录，则加载不同的 Business Catalyst 样式表

> ID：15263339
> 
> 赞同：0
> 
> 时间：2013-03-07T04:52:13.017
> 
> 标签：conditional-statements, business-catalyst

在 Business Catalyst 中，是否有条件语句允许根据用户是否登录来加载不同的样式表？使用 GetElementById 更改样式不起作用，因为需要重新设置多个系统生成的元素。我试过 GetElementByClassName，但这不起作用。我想也许通过基于登录状态加载一个完全独立的样式表可能会起作用。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T02:54:55.787

您应该能够插入此标签：

```
 {module_isloggedin} 
```

您想要的任何地方......例如在您的 ID/类语法中：

```
 id="menu_{module_isloggedin}"  or class="menu_{module_isloggedin}" 
```

或者您甚至应该能够执行以下操作：

```
 <link rel="stylesheet" type="text/css" href="/login-{module_isloggedin}.css"> 
```

这将解决：

```
 <link rel="stylesheet" type="text/css" href="/login-1.css"> 
```

如果用户已登录并且

```
 <link rel="stylesheet" type="text/css" href="/login-0.css"> 
```

如果用户没有登录...

试试看... :)

# java - 剑道网格防止列变小

> ID：15263348
> 
> 赞同：1
> 
> 时间：2013-03-07T04:52:54.510
> 
> 标签：java, jsp, kendo-ui, kendo-grid

网格大约有 25 列，Kendo 网格尝试将所有列水平放置在一页中，使列名显示为“...”。

我想默认显示所有列名并启用水平滚动条。

如何使用 JSP 包装器实现这一点？

```
<kendo:grid name="SRCHGT" resizable="true" sortable="true" height="500">
    <kendo:grid-scrollable virtual="true"/>
    <kendo:dataSource>
        <kendo:dataSource-transport>
            <kendo:dataSource-transport-read url="api/products"
                contentType="application/json" type="GET"></kendo:dataSource-transport-read>
        </kendo:dataSource-transport>
        <kendo:dataSource-schema data="Data" total="Total" groups="data">

        </kendo:dataSource-schema>
    </kendo:dataSource>

</kendo:grid> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T06:37:33.627

您需要指定列的宽度设置才能做到这一点。这是一个显示水平滚动的演示：[http ://demos.kendoui.c​​om/beta/web/grid/virtualization-remote-data.html](http://demos.kendoui.com/beta/web/grid/virtualization-remote-data.html)

如果您希望所有列具有相同的宽度，您也可以使用 CSS：

```
#SRCHGT col {
    width: 100px;
} 
```

这是一个现场演示：http: [//jsbin.com/edinix/1/edit](http://jsbin.com/edinix/1/edit)

# spring - 无法打开 Spring 源工具套件

> ID：15263361
> 
> 赞同：0
> 
> 时间：2013-03-07T04:54:07.593
> 
> 标签：spring, spring-mvc, sts-springsourcetoolsuite, springsource

我安装了`SpringSource Tool Suite`，之后我被提醒我没有设置`JAVA_HOME`. 这时安装成功了，于是我关闭了套件并设置了java_home。

但是现在我找不到任何打开套件的方法。桌面或开始菜单中没有快捷方式。

如何打开它？
还是我应该重新安装它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:18:03.123

在 Windows 7 中转到`Start > search program and files`并键入`spring`然后在结果中您会发现`Spring Tool Suit`.

否则，如果您记得安装路径，您可以在那里找到`STS.exe`文件

# google-app-engine - GOOGLE APP ENGINE DATASTORE / PYTHON 中的日期比较

> ID：15263362
> 
> 赞同：0
> 
> 时间：2013-03-07T04:54:11.680
> 
> 标签：google-app-engine, python-2.7, google-cloud-datastore, gql

我正在尝试在某个日期之后获取记录。

我在代码中使用了以下内容：

```
qstr = "SELECT * FROM Comment where date > '"+str(max_date)+"' order by date desc limit 10"
comments = db.GqlQuery(qstr) 
```

我有控制台日志我有 qStr 如下：

```
SELECT * FROM Comment where date > '2013-03-07 04:33:31' order by date desc limit 10" 
```

但这不会产生任何记录（数据库中有记录）。

我也尝试过作为日期时间传递：

```
comments = db.GqlQuery("SELECT * FROM Comment where date > :1 order by date desc limit 10",
                                miscUtils._datetime_from_str(max_date)) 
```

这也不会产生任何结果。你能告诉我我做错了什么吗？（我使用以下代码将日期字符串转换为日期[http://code.activestate.com/recipes/577135-parse-a-datetime-string-to-a-datetime-instance/](http://code.activestate.com/recipes/577135-parse-a-datetime-string-to-a-datetime-instance/)）

另外，我尝试在 App Engine 控制台中调试该语句，但我无法这样做。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T17:27:58.003

我让它按如下方式工作：`comments = db.GqlQuery("select * from Comment where date > :1 order by date desc limit "+MAX_COMMENTS_PER_FETCH_STR, datetime.datetime.strptime(max_date, "%Y-%m-%d %H:%M:%S").date())`

谢谢大家的帮助

# qt - 首次发射信号后自动断开

> ID：15263364
> 
> 赞同：4
> 
> 时间：2013-03-07T04:54:22.413
> 
> 标签：qt, qt4, pyqt, pyqt4

我正在从文件加载网页，然后替换其中的一些 html：

```
 self.template_web_page = QtWebKit.QWebPage()
    self.template_web_page.mainFrame().load(QtCore.QUrl('template.html'))
    def load(ok):
        main_window.web_view.loadFinished.disconnect(load)
        self.table_element = self.template_web_page.mainFrame().findFirstElement("#table")
        self.table_element.setInnerXml(table_html)
    main_window.web_view.loadFinished.connect(load) 
```

有没有办法只为一次拍摄连接到信号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-10T13:11:07.710

如前所述，似乎没有比这更好（更简洁）的方法了。

[http://comments.gmane.org/gmane.comp.lib.qt.general/6883](http://comments.gmane.org/gmane.comp.lib.qt.general/6883)建议这样的解决方案很好，尽管我自己对这样的解决方案有疑问。我发现如果我在插槽开头断开插槽（如问题中的代码中所做的那样）然后尝试执行一些 GUI 交互（设置状态栏文本是一个问题，但没有突出显示列表视图中的一行)，由于 NULL 指针取消引用，我得到了一个异常。这是用于 Windows 的 Python 2.6 的 PyQt 4.6.2。当我将 disconnect() 调用移到插槽的末尾时，问题就消失了。

如果这无关紧要，请提前道歉，这只是我犯的一个愚蠢的错误。

# python - 使用条件初始化队列

> ID：15263365
> 
> 赞同：0
> 
> 时间：2013-03-07T04:54:24.027
> 
> 标签：python, initialization, queue

您必须实现类 m_sorted_list 的方法，该类在初始化时采用一个参数 sorted，该参数为真或假。当参数为 true 时，列表按升序排序。当参数为 false 时，它​​充当普通的无界队列

这就是我被赋予的代码

到目前为止，我已经完成了

```
def __init__(self, m_sorted):
    self.__items=[]
    self.__size=0 
```

初始化其实想要

– 使用参数为真或假的类初始化

说真的，我是 Python 的新手，我真的不明白这个问题到底想让我做什么。

谁能帮我做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:53:52.367

抱歉，如果我理解错误，但以下内容可能会有所帮助。

```
class N:
    def __init__(self):
        self.s = []
    def add(self,u):
        self.s.append(u)
    def check(self):
        if sorted(self.s) == True:
            print "List is sorted"
        else:
            print "Not sorted but it will sort now"
            return sorted(self.s) 
```

# javascript - Jquery Cycle 和 Pixastic 快速模糊

> ID：15263369
> 
> 赞同：0
> 
> 时间：2013-03-07T04:54:49.127
> 
> 标签：javascript, jquery, dom, jquery-cycle, pixastic

我正在尝试循环我的图像并模糊背景图像，但问题是它只模糊了第一张图像而不是下一张图像。

```
<div id="banner_images">        
    <div id="banner_cycle_wrapper">
        <div id="banner_bg_cycle">
            <img src="source.png" class="blur">
        </div>
        <div id="banner_cycle_container">
            <img src="source.png">
        </div>
    </div>
    <div id="banner_cycle_wrapper" >
        <div id="banner_bg_cycle">
            <img alt="" src="source.png" class="blur">
        </div>
        <div id="banner_cycle_container">
            <img src="source.png">
        </div>
    </div>
</div> 
```

```
$('#banner_images').cycle({
    fx: 'fade',
    timeout: 2000
});

$(".blur").pixastic("blurfast", {amount:0.5}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:16:18.537

我认为您缺少要添加的类

```
 class="blur" 
```

这应该添加到您想要具有相同效果的每个图像中。

更新代码：

```
<div id="banner_images"> 
   <div id="banner_cycle_wrapper"> 
      <div id="banner_bg_cycle"> 
         <img alt="" src="source.png"/> 
      </div> 
      <div id="banner_cycle_container"> 
         <img alt="" src="img1.png" class="blur" /> 
         <img alt="" src="img2.png" class="blur" /> 
      </div> 
   </div> 
 </div> 
```

我希望这个能帮上忙 ：）

# mongodb - MongoDB 和 MapReduce 以及异常缓慢的性能

> ID：15263372
> 
> 赞同：0
> 
> 时间：2013-03-07T04:55:21.160
> 
> 标签：mongodb, mongoose

我在 Mongo 实例中存储了大约 700000 个文档。它在 2GB VPS 上运行，因此无法预期最终速度。我使用 NodeJS 和 Mongoose 来完成这项工作。

文档格式如下：

*   一级钥匙
*   一级钥匙
    *   2级钥匙A
        *   3级钥匙A
    *   2级键B
        *   3级钥匙1
            *   4级钥匙A
            *   4级钥匙B
            *   4级键C
            *   ...
        *   3级钥匙2
        *   3级键3
        *   ...

avgObjSize 是 3191，所以它们不是最大的也不是最小的.. 基本上是短文本列表。

所以我需要做的是将某些值与所有 3 级键中的 4 级键 C 中找到的所有值进行匹配。棘手的部分是只有在第 4 级键 Cs 中找到 XX% 的匹配值时才会返回文档。

我尝试过 MapReduce，以便所有事情都发生在 map 函数中，它只发出预处理的对象，我尝试返回所有文档和后处理，我尝试使用 map 函数仅输出 4 级键 Cs，我已经尝试使用 Mongo 自己的函数，如 $all 等。

问题是一切都非常缓慢。我的意思是每秒不到 500 个文档。该集合只会增长，所以我的问题是我只是错过了如何正确使用 Mongo 的东西，还是像这样的任务这么慢？我阅读了以前的问题，Mongo 中的 MR 存在一些问题，速度很慢，但这并不慢，这是在爬行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T06:42:20.757

查看您的结构，我建议您将文档重组为更有效的格式。使用第 4 级键进行匹配预计会很慢。要么向上移动它们，要么让它们成为自己的文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T11:54:12.637

> avgObjSize 为 3191

所以 3.1MB * 700,000 大约是 2.1GB。这意味着您的工作集可能会超出您最可能知道的当前 RAM 数量，从您的问题的内容来看。

这里要考虑的另一点是，您将 3.1MB 加载到 RAM 中，这对于每个文档来说是相当大的数量。

您还应该考虑到由于 JS 引擎是 JS 而不是 MongoDB 的本机 C++ 编码，并且当然是单线程，因此速度已经有所降低。

> 问题是一切都非常缓慢。我的意思是每秒不到 500 个文档。

实际上，您还在寻找每个 3 级密钥的第 4 级密钥可能存在于每个自身密钥中的位置。这是相当多的循环和躲避才能得到你的结果。

您很可能遇到递归问题。

> Riak 我们来了

我怀疑这会有所帮助，无论你走到哪里，这个查询都会很慢。相反，您应该研究如何根据您的加入模式设计模式，就像在设计可扩展技术时一样。

# perl - Perl：特殊数组@_ 不是真正的别名？

> ID：15263375
> 
> 赞同：12
> 
> 时间：2013-03-07T04:55:37.513
> 
> 标签：perl

特殊数组 ，`@_`其中存在传递给函数的所有参数，实际上是传递参数的别名。因此，我们直接对这个特殊数组所做的任何更改也`@_`将反映在 main 中。这很清楚。

```
#!/usr/bin/perl

use warnings;
use strict;

$\="\n";

sub func {
        print \@_;
        $_++ for(@_);
}

my @arr=(2..4);
print \@arr;
func(@arr);
print "@arr"; 
```

对于上面的程序，我希望 和 的引用`@arr`指向`@_`同一个位置，因为它是一个别名。但事实并非如此。

在运行上述：

```
ARRAY(0x1b644d0)
ARRAY(0x1b644e0)
3 4 5 
```

如果他们指向 2 个不同的位置，所做的更改如何`@_`反映在`@arr`？

我看错了吗？请指教。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-07T05:00:54.613

这可能会回答你的问题：

```
use warnings;
use strict;

$\="\n";

sub func {
        print \@_;
        $_++ for(@_);
        print \$_ for @_; 
}

my @arr=(2..4);
print \@arr;
func(@arr);
print "@arr";
print \$_ for @arr; 
```

**输出**

```
ARRAY(0x17fcba0)
ARRAY(0x1824288)
SCALAR(0x17fcc48)
SCALAR(0x18196f8)
SCALAR(0x1819710)
3 4 5
SCALAR(0x17fcc48)
SCALAR(0x18196f8)
SCALAR(0x1819710) 
```

如您所见，各个参数具有相同的地址，但容器不同。如果你将一个项目推到`@_`in`func`将`@arr`不会改变（所以你可以`shift`在 中做`funct`）。因此，每个参数都是一个别名，数组元素作为单独的项目传递。`@_`包含传递给子例程的所有项目。如果要修改数组参数，则需要通过引用传递它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-07T05:37:56.743

`@_`没有别名；它的元素是。

请记住

```
func(@arr); 
```

是相同的

```
func($arr[0], $arr[1], ...); 
```

因为唯一可以传递给 sub 的是标量列表，而数组在列表上下文中计算为其元素的列表。

所以这意味着

```
func(@arr); 
```

基本上是一样的

```
local @_;
alias $_[0] = $arr[0];
alias $_[1] = $arr[1];
...
&func; 
```

更改 的元素`@_`会更改 的元素`@arr`，但添加和删除 的元素`@_`不会改变`@arr`，因为它们是不同的数组。

```
>perl -E"@a=(4..6); sub { $_[0] = '!';        say @_; }->(@a); say @a;"
!56
!56

>perl -E"@a=(4..6); sub { splice(@_,0,1,'!'); say @_; }->(@a); say @a;"
!56
456 
```

# google-api - 使用 google-api-dotnet-client 的 Google+ 插入时刻

> ID：15263378
> 
> 赞同：1
> 
> 时间：2013-03-07T04:55:54.990
> 
> 标签：google-api, google-plus, google-api-dotnet-client

我正在尝试使用 dotnet-client 在 Google+ 中编写活动。问题是我似乎无法正确配置我的客户端应用程序。根据[Google+ 登录配置](https://developers.google.com/+/web/signin/)和[这个 SO 问题](https://stackoverflow.com/questions/15164949/google-unable-to-insert-moment#comment21361856_15167103)，我们需要添加 requestvisibleactions 参数。我这样做了，但没有用。我正在使用范围`https://www.googleapis.com/auth/plus.login`，我什至添加了范围`https://www.googleapis.com/auth/plus.moments.write`，但插入仍然不起作用。

这是我的请求网址的样子：

`https://accounts.google.com/ServiceLogin?service=lso&passive=1209600&continue=https://accounts.google.com/o/oauth2/auth?scope%3Dhttps://www.googleapis.com/auth/plus.login%2Bhttps://www.googleapis.com/auth/plus.moments.write%26response_type%3Dcode%26redirect_uri%3Dhttp://localhost/%26state%3D%26requestvisibleactions%3Dhttp://schemas.google.com/AddActivity%26client_id%3D000.apps.googleusercontent.com%26request_visible_actions%3Dhttp://schemas.google.com/AddActivity%26hl%3Den%26from_login%3D1%26as%3D-1fbe06f1c6120f4d&ltmpl=popup&shdf=Cm4LEhF0aGlyZFBhcnR5TG9nb1VybBoADAsSFXRoaXJkUGFydHlEaXNwbGF5TmFtZRoHQ2hpa3V0bwwLEgZkb21haW4aB0NoaWt1dG8MCxIVdGhpcmRQYXJ0eURpc3BsYXlUeXBlGgdERUZBVUxUDBIDbHNvIhTeWybcoJ9pXSeN2t-k8A4SUbfhsygBMhQivAmfNSs_LkjXXZ7bPxilXgjMsQ&scc=1`

正如您从那里看到的那样，有一个`request_visible_actions`，我什至添加了一个没有下划线的，以防我弄错了参数（`requestvisibleactions`）。

让我说我的应用程序正在通过 API 成功验证。经过身份验证后，我可以获取用户的个人资料，并且在“插入时刻”部分，我的应用程序失败了。我的插入代码：

```
 var body = new Moment();
        var target = new ItemScope();
        target.Id = referenceId;
        target.Image = image;
        target.Type = "http://schemas.google.com/AddActivity";
        target.Description = description;
        target.Name = caption;

        body.Target = target;
        body.Type = "http://schemas.google.com/AddActivity";

        var insert =
            new MomentsResource.InsertRequest(
                // this is a valid service instance as I am using this to query the user's profile
                _plusService,
                body,
                id,
                MomentsResource.Collection.Vault);

        Moment result = null;
        try
        {
            result = insert.Fetch();
        }
        catch (ThreadAbortException)
        {
            // User was not yet authenticated and is being forwarded to the authorization page.
            throw;
        }
        catch (Google.GoogleApiRequestException requestEx)
        {                
            // here I get a 401 Unauthorized error

        }
        catch (Exception ex)
        {

        }            ` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T02:30:17.517

对于 OAuth 流程，您的请求存在两个问题：

*   request_visible_actions 是传递给 OAuth v2 服务器的内容（不要传递 requestvisibleactions）
*   plus.moments.write 是一个弃用的范围，你只需要传入 plus.login

确保您的项目从此处引用最新版本的 Google+ .NET 客户端库：

[https://developers.google.com/resources/api-libraries/download/stable/plus/v1/csharp](https://developers.google.com/resources/api-libraries/download/stable/plus/v1/csharp)

我在 GitHub 上创建了一个项目，在此处显示了完整的服务器端流程：

[https://github.com/gguuss/gplus_csharp_ssflow](https://github.com/gguuss/gplus_csharp_ssflow)

正如 Brettj 所说，您应该使用 Google+ 登录按钮，如此处最新的 Google+ 示例所示：

[https://github.com/googleplus/gplus-quickstart-csharp](https://github.com/googleplus/gplus-quickstart-csharp)

首先，*确保*您正在请求您正在编写的所有活动类型。您会知道这是有效的，因为授权对话框将在以“此应用程序想要”开头的文本下方显示“通过 Google 提供您的应用程序活动，对您可见并且：[...]”。我知道你检查过这个，但我 90% 确定这就是你收到 401 错误代码的原因。以下标记显示了如何呈现请求访问添加活动的 Google+ 登录按钮。

```
<div id="gConnect">
<button class="g-signin"
    data-scope="https://www.googleapis.com/auth/plus.login"
    data-requestvisibleactions="http://schemas.google.com/AddActivity"
    data-clientId="YOUR_CLIENT_ID"
    data-accesstype="offline"
    data-callback="onSignInCallback"
    data-theme="dark"
    data-cookiepolicy="single_host_origin">
</button> 
```

假设您有一个在 data-requestvisibleactions 中设置了正确活动类型的 PlusService 对象，以下代码（您应该能够复制/粘贴以查看它的工作）简明地演示了使用 .NET 客户端编写的时刻，并且已经过测试工作：

```
Moment body = new Moment();
ItemScope target = new ItemScope();

target.Id = "replacewithuniqueforaddtarget";
target.Image = "http://www.google.com/s2/static/images/GoogleyEyes.png";
target.Type = "";
target.Description = "The description for the activity";
target.Name = "An example of add activity";

body.Target = target;
body.Type = "http://schemas.google.com/AddActivity";

MomentsResource.InsertRequest insert =
    new MomentsResource.InsertRequest(
        _plusService,
        body,
        "me",
        MomentsResource.Collection.Vault);
Moment wrote = insert.Fetch(); 
```

请注意，为方便起见，我将 Google.Apis.Plus.v1.Data 包括在内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T07:48:45.917

啊就是这么简单！也许不吧？我正在回答我自己的问题，因此接受它作为答案（当然是几天后），因此可以指导其他有相同问题的人。但我肯定会投票赞成 Gus 的回答，因为它引导我修复了我的代码。

因此，根据上面写的@class 答案以及[他的博客中的解释](http://gusclass.com/blog/2013/02/27/common-issues-for-the-new-google-platform-release/)，成功创建时刻的关键是添加`request_visible_actions`参数。我这样做了，但我的请求仍然失败，这是因为我错过了一件重要的事情。您需要再添加一个参数，那就是**`access_type`**并且它应该设置为**`offline`**。OAuth 请求至少应如下所示：*[https://accounts.google.com/o/oauth2/auth?scope=https://www.googleapis.com/auth/plus.login&response_type=code&redirect_uri=http： //localhost/](https://accounts.google.com/o/oauth2/auth?scope=https://www.googleapis.com/auth/plus.login&response_type=code&redirect_uri=http://localhost/) **&request_visible_actions= [http://schemas.google.com/AddActivity&access_type=offline](http://schemas.google.com/AddActivity&access_type=offline)***。

对于完整且正确的客户端代码，您可以[在此处获取 Gus 的示例](https://github.com/gguuss/gplus_csharp_ssflow)或[下载整个 dotnet 客户端库，包括源代码和示例](https://code.google.com/p/google-api-dotnet-client/wiki/Downloads)，并添加我在下面添加的内容。您应该记住的最重要的事情是修改您`AuthorizationServerDescription`的 Google API。这是我的身份验证器版本：

```
public static OAuth2Authenticator<WebServerClient> CreateAuthenticator(
        string clientId, string clientSecret)
{
    if (string.IsNullOrWhiteSpace(clientId))
        throw new ArgumentException("clientId cannot be empty");

    if (string.IsNullOrWhiteSpace(clientSecret))
        throw new ArgumentException("clientSecret cannot be empty");

    var description = GoogleAuthenticationServer.Description;

    var uri = description.AuthorizationEndpoint.AbsoluteUri;
    // This is the one that has been documented on Gus' blog site 
    // and over at Google's (https://developers.google.com/+/web/signin/)
    // This is not in the dotnetclient sample by the way 
    // and you need to understand how OAuth and DNOA works.
    // I had this already, see my original post, 
    // I thought it will make my day.
    if (uri.IndexOf("request_visible_actions") < 1)
    {
        var param = (uri.IndexOf('?') > 0) ? "&" : "?";
        description.AuthorizationEndpoint = new Uri(
            uri + param +
            "request_visible_actions=http://schemas.google.com/AddActivity");
    }

    // This is what I have been missing! 
    // They forgot to tell us about this or did I just miss this somewhere?
    uri = description.AuthorizationEndpoint.AbsoluteUri;
    if (uri.IndexOf("offline") < 1)
    {
        var param = (uri.IndexOf('?') > 0) ? "&" : "?";
        description.AuthorizationEndpoint = 
                new Uri(uri + param + "access_type=offline");
    }

    // Register the authenticator.
    var provider = new WebServerClient(description)
    {
        ClientIdentifier = clientId,
        ClientSecret = clientSecret,                  
    };            
    var authenticator =
        new OAuth2Authenticator<WebServerClient>(provider, GetAuthorization)
                 { NoCaching = true };
    return authenticator;
} 
```

没有**`access_type=offline`**我的代码永远不会工作，它永远不会工作。现在我想知道为什么？最好有一些解释。

# php - 如何在 PHP 中使 Windows 共享可浏览？

> ID：15263379
> 
> 赞同：0
> 
> 时间：2013-03-07T04:56:12.543
> 
> 标签：php, windows

我需要将 Windows 共享（\\something\other）显示为 php 中的可浏览目录。我怎样才能做到这一点？如果我将链接指向 Windows 共享，我会在链接中得到类似 file://something/other 的内容，我只能在 IE 中打开它。使它适用于所有浏览器的解决方案是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:03:20.190

首先将文件夹共享给公众，至少具有读取权限（或您想要授予的任何权限）

这将使用您的 Web 服务器完成（例如 Apache、Samba 等）

通过添加虚拟路径在服务器中配置相同的共享目录，然后

允许目录浏览相同的“虚拟目录”。

然后使用浏览器尝试虚拟目录，

我希望这能帮到您 ：）

# algorithm - 为什么桶排序在输入排序后运行得更快？

> ID：15263386
> 
> 赞同：2
> 
> 时间：2013-03-07T04:57:01.720
> 
> 标签：algorithm, sorting, bucket, bucket-sort

我在 Java 中实现桶排序，我发现当输入数组被排序（升序或降序）而不是随机时，它的排序（升序）更快。为什么是这样？据我了解，它只是遍历数组并在每个元素的索引处递增“计数”数组。我不明白为什么使用排序输入它会运行得更快，但它似乎快了两倍。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T04:59:07.850

原因很可能是由于空间局部性和排序输入集的更高缓存命中率。

如果您对输入进行了排序，则同一邻域中的桶相对会获得一堆命中，并且随着您的排序输入移动到更高的范围，下一个桶的邻域将开始获得命中。

考虑一个简化的例子来说明这一点：

假设您有 10 个范围大小为 1,000 的桶：

```
[0-999], [1000-1999], ..., [9000-9999] 
```

并假设您一次只能缓存对一个存储桶的引用（这是人为的部分，但实践中的想法是相同的：

现在假设您的输入集是之间的随机数`[0 - 9999]`

*   如果输入被排序，每个桶将恰好得到一个初始缓存未命中，然后是多次缓存命中，直到输入中的序列移动到下一个桶的范围内。
*   如果您有未排序的输入，并且在最坏的情况下，缓存将始终丢失，并将另一个存储桶加载到缓存中，并且只会再次丢失，因为未排序序列中的下一个数字将寻找另一个存储桶。

# jsf - JSF 2.0 CDI - 请求 bean 中的注入会话 bean 包含空属性

> ID：15263390
> 
> 赞同：0
> 
> 时间：2013-03-07T04:57:42.813
> 
> 标签：jsf, jsf-2, cdi, websphere-8

我在 WebSphere App Server v8.0.0.5 中使用 JSF 2.0、CDI 1.0。

我有一个奇怪的情况......成功登录后，会创建一个 CDI 会话范围的 bean，并将用户重定向到欢迎页面。会话范围的 bean 被注入到欢迎页面上引用的请求范围的 bean 中。问题是会话范围的 bean 仅在每个浏览器首次成功登录时保留其字段值。我已经尝试过使用 Chrome、Firefox 甚至 IE 的同一用户。如果我注销或重新启动 WAS 并尝试再次登录，则会话范围 bean 的值在注入请求范围 bean 时都设置为 null。

我对所有范围都使用 javax.enterprise.context。

拜托，我需要紧急帮助。由于这个问题，很多事情都处于危险之中。

登录表单的 Auth bean 的相关片段（我在重定向后省略了一些代码）：

```
import com.ibm.websphere.security.WSSecurityException;
import com.ibm.websphere.security.auth.WSSubject;
import com.ibm.websphere.security.cred.WSCredential;
import com.ibm.websphere.wim.exception.WIMException;
import com.ibm.websphere.wim.util.SDOHelper;

import java.io.IOException;
import java.io.Serializable;
import java.rmi.RemoteException;
import java.security.Principal;

import javax.annotation.PostConstruct;
import javax.enterprise.context.ConversationScoped;
import javax.faces.application.FacesMessage;
import javax.faces.context.ExternalContext;
import javax.faces.context.FacesContext;
import javax.inject.Inject;
import javax.inject.Named;
import javax.security.auth.Subject;
import javax.security.auth.login.CredentialExpiredException;
import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;

import com.ibm.websphere.wim.SchemaConstants;
import com.ibm.websphere.wim.Service;
import com.ibm.websphere.wim.client.LocalServiceProvider;
import java.security.PrivilegedActionException;
import java.security.PrivilegedExceptionAction;
import com.ibm.ws.security.core.ContextManagerFactory;

import commonj.sdo.DataObject;

@Named
@ConversationScoped
public class Auth implements Serializable {
/**
 * 
 */
private static final long serialVersionUID = -6106803531512607236L;
private String userId;
private String password;
private String originalURL;

@Inject
UserService userService;
private Service service;
private String uniqueSecurityName;
private String l;

@PostConstruct
    public void init() {
    ExternalContext externalContext = FacesContext.getCurrentInstance().getExternalContext();
    originalURL = (String) externalContext.getRequestMap().get(RequestDispatcher.FORWARD_REQUEST_URI);

    System.out.println("The PostContstruct has been called.");

    if (originalURL == null) {
        originalURL = externalContext.getRequestContextPath() + "/index.xhtml";
    } else {
        String originalQuery = (String) externalContext.getRequestMap().get(RequestDispatcher.FORWARD_QUERY_STRING);

        if (originalQuery != null) {
            originalURL += "?" + originalQuery;
        }
    }
}

public void login() throws IOException, WIMException, PrivilegedActionException {
    FacesContext context = FacesContext.getCurrentInstance();
    ExternalContext externalContext = context.getExternalContext();
    HttpServletRequest request = (HttpServletRequest) externalContext.getRequest();
    System.out.println("The login method has been called.");

    try {
        Principal userPrincipal = request.getUserPrincipal();
        request.getUserPrincipal();
        if (userPrincipal != null) {
            request.logout();
        }
        request.login(userId, password);

        User user = new User();

        if (request.isUserInRole("STAFF")) {
            Staff staff = userService.getStaff(userId);
            user.setLocation(staff.getCenter().getCity());
            user.setRole("STAFF");
            user.setUserId(userId);
            externalContext.getSessionMap().put("user", user);
            externalContext.redirect("staff/staff-home?faces-redirect=true");
        }
}

public String logout() {
    FacesContext.getCurrentInstance().getExternalContext().invalidateSession();
    return "/index?faces-redirect=true";
} 
```

用户 bean：

```
import java.io.Serializable;

import javax.enterprise.context.SessionScoped;
import javax.inject.Named;

@Named
@SessionScoped
public class User implements Serializable {
/**
 * 
 */
private static final long serialVersionUID = 7198980241243868166L;
private String role;
private String location;
private String userId;
private Role sessionRole;

public User() { }

/**
 * @return the role
 */
public String getRole() {
    return role;
}

/**
 * @param role the role to set
 */
public void setRole(String role) {
    this.role = role;
}

/**
 * @return the location
 */
public String getLocation() {
    return location;
}

/**
 * @param location the location to set
 */
public void setLocation(String location) {
    this.location = location;
}

/**
 * @return the userId
 */
public String getUserId() {
    return userId;
}

/**
 * @param userId the userId to set
 */
public void setUserId(String userId) {
    this.userId = userId;
}   
} 
```

欢迎页面 bean 的相关部分：

```
import java.text.DateFormatSymbols;
import java.util.List;

import javax.annotation.PostConstruct;
import javax.enterprise.context.RequestScoped;
import javax.inject.Inject;
import javax.inject.Named;

@Named
@RequestScoped
public class CenterInfoBean {    
@Inject
CenterInfo centerInfo;

@Inject
User user;

private State state;
private Center center;

@PostConstruct
public void init() {
    center = centerInfo.getCenterByCityName(user.getLocation());
} 
```

为什么 auth 仅在使用唯一浏览器初始登录时填充值，而在后续登录时从未填充值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T06:40:25.287

将容器管理的 bean 代码与类似的东西混合不是一个好主意，

```
User user = new User(); 
```

在 sessionMap 中添加它应该可以工作，但是如果容器已经在您的请求 bean 中解决了会话 bean 的注入，因为您已经在会话中。

尝试避免像`User user = new User();`用户受容器管理时那样的代码。

在您的情况下，我建议检查用户是否已经在会话中。

```
User user = (User)externalContext.getSessionMap().get("user"); 
```

如果是，则更新此参考，如果不可用，则继续

```
User user = new User(); 
```

# python - Flask 用户管理：如何使用更好的身份验证方式制作无状态服务器？

> ID：15263396
> 
> 赞同：12
> 
> 时间：2013-03-07T04:58:08.587
> 
> 标签：python, django, rest, flask, scalability

*   我一直在多个地方阅读，建议 Web 服务器应该是**Stateles**并且**不共享架构**。这有助于他们更好地扩展。

*   这意味着每个请求都包含处理请求所需的所有信息。

*   当您拥有需要身份验证的**REST**端点时，这会变得很棘手。

*   我一直在研究 Flask 扩展执行此操作的方式，并将[Flask Login](http://pythonhosted.org/Flask-Login/)扩展定义为

> Flask-Login 为 Flask 提供用户会话管理。它处理登录、注销和长时间**记住用户会话的常见任务。**

*   这似乎违背了构建**无状态**服务器的理念，不是吗？
*   有什么更好的方法来构建**无状态**服务器，并通过 Python 或相关 Python 库通过 HTTP 标头提供身份验证？

PS：很抱歉没有在这里发布编程问题，这是一个设计问题，我不知道如何解决它，所以似乎有合适的人来回答这些问题。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T10:22:46.190

Flask-Login 使用flask 的[内置会话管理](http://flask.pocoo.org/docs/quickstart/#sessions)，默认情况下使用安全/签名的cookie，因此纯粹是客户端。

当然，如果需要，它可以支持服务器端会话，[这是](http://flask.pocoo.org/snippets/75/)一个 redis 支持的会话存储示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-08-02T06:29:29.893

我遇到了和你说的一样的问题。虽然我为此构建了一个简单的解决方案，但正在寻找一个更好的解决方案。我目前所做的是要求调用者（谁发送 http 请求）在 http 标头中提供一个“X-User-Info”，该值是一个令牌。当我收到请求时，我使用此令牌来获取用户身份（例如从 redis），并且以下所有授权和权限控制都基于此身份。身份验证只生成一个随机令牌，将其与用户信息一起保存到 redis 并将令牌本身返回给调用者。

# c - 如何将位于一个文件夹中的所有xml文件传递给libxml进行解析

> ID：15263397
> 
> 赞同：0
> 
> 时间：2013-03-07T04:58:39.773
> 
> 标签：c, visual-studio-2010, libxml2

我已经编写了 C 代码并使用 libxml 通过提供其绝对文件来解析 xml 文件，现在我的要求是仅传递文件夹名称并一一选择所有 xm 文件并完全解析它们。libxml 是否有任何特定方法可以从文件夹中获取所有文件，或者我们是否可以在配置文件中提及由逗号或任何其他分隔符分隔的文件，libxml 通过该方法选择要解析的文件的路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:06:07.937

您应该查看 FindFirstFile 和 FindNextFile，因为您使用的是 Windows。

# ada - Ada 数字文字和下划线

> ID：15263400
> 
> 赞同：5
> 
> 时间：2013-03-07T04:58:49.537
> 
> 标签：ada, literals

这来自在线 Ada 参考手册： http: [//www.adaic.org/resources/add_content/standards/05rm/RM.pdf](http://www.adaic.org/resources/add_content/standards/05rm/RM.pdf) （第 2.3 节）

```
A decimal_literal is a numeric_literal in the conventional decimal notation (that is, the base is ten). 
Syntax 
decimal_literal ::= numeral [.numeral] [exponent] 
**numeral ::= digit {[underline] digit}** 
exponent ::= E [+] numeral | E – numeral
digit ::= 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9
An exponent for an integer literal shall not have a minus sign. 
Static Semantics 
**An underline character in a numeric_literal does not affect its meaning.** The letter E of an exponent can be 
written either in lower case or in upper case, with the same meaning. 
```

如果我做

```
my_literal ::= 123_456; 
```

下划线（下划线）是什么意思？**它说它不影响意思**。那它是干什么用的？我相信有一个简单的答案，但阅读和重新阅读这篇文章并没有帮助我。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T05:21:59.687

这与货币或 [其他大] 数字中的逗号 ( `,`) 的原因相同：分组。因此：

```
Million : Constant:= 1_000_000; 
```

此外，您可以将它与 base-setting 结合使用作为掩蔽设置：

```
Type Bit is Range 1..8;
SubType Byte is Interfaces.Unsigned_8;
Type Masks is Array(Positive Range <>) of Byte;

Mask_Map : Constant Masks(Bit):=
    (
        2#0000_0001#,
        2#0000_0010#,
        2#0000_0100#,
        2#0000_1000#,
        2#0001_0000#,
        2#0010_0000#,
        2#0100_0000#,
        2#1000_0000#
    ); 
```

那么也许你会使用 Mask_Map 和 bits 以及`or`, `and`, and`xor`来进行位操作。上述方法似乎比简单定义大量常量并直接操作它们更有效，但它更灵活，您可以稍后将其更改为函数，而不必更改任何客户端代码，这可以如果该函数的结果是参数化整数（其中 bit 具有定义`1..PARAMETER'Size`.

# windows-phone-7 - 后退按钮处理 wp7

> ID：15263402
> 
> 赞同：0
> 
> 时间：2013-03-07T04:59:06.510
> 
> 标签：windows-phone-7

我的问题是我有一个清单。当我长按列表中的特定项目时，它会打开一个上下文菜单，当我单击上下文菜单中的一个菜单项时，它会打开一个弹出窗口，所以在按下硬件后退按钮时，我希望我再次返回列表. 所以为此我的代码是：

```
protected override void OnBackKeyPress(object sender,System.ComponentModel.CancelEventArgs e)
    {
        if (calendarDescripton.Visibility == Visibility.Visible)
        {
            calendarDescripton.Visibility = Visibility.Collapsed;
            e.Cancel = true;
        }

    } 
```

使用此代码后，当我单击打开列表的按钮时，应用程序退出，它也没有打开列表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T08:10:31.980

我认为首先应该取消导航，然后再进行任何其他更改。尝试这个

```
protected override void OnBackKeyPress(object sender,System.ComponentModel.CancelEventArgs e)
{
    if (calendarDescripton.Visibility == Visibility.Visible)
    {
        e.Cancel = true;
        calendarDescripton.Visibility = Visibility.Collapsed;
    }
} 
```

如果这没有帮助，请在 if 条件处放置一个中断点并检查它是否进入 if 内部

如果断点没有命中，则意味着您的导航方法有问题。

如果您使用 NavigationService.Navigate() 方法进行页面导航，它应该可以工作。否则，如果您使用, `App.Current.RootVisual = new MyPage();`，则无法覆盖 BackKey。

# c# - 如何在基于 Windows 窗体的电子邮件应用程序中验证密码？

> ID：15263423
> 
> 赞同：1
> 
> 时间：2013-03-07T05:00:57.963
> 
> 标签：c#, .net, winforms, visual-studio-2008

昨天，我的上级分配了一项任务，要在 .net 中构建一个 Windows 窗体应用程序，它看起来就像我附上的图像。我做了有关电子邮件应用程序发送过程的所有工作，但我卡在一个地方，我无法弄清楚如何验证电子邮件表单中的密码。密码必须是在“发件人：”字段中提供的同一电子邮件。![这张图片显示了我设计的表格](../Images/8a4b52633061e6516bb2e13a775e0244.png)

这是我的表格背后的代码，

```
 public partial class Form1 : Form
{
    MailMessage message;
    SmtpClient smtp;
    public Form1()
    {

        InitializeComponent();
        lbl_Error.Visible = false;
    }

    private void chk_Show_Password_CheckedChanged(object sender, EventArgs e)
    {

        if (chk_Show_Password.Checked == true)
            txt_Password.PasswordChar= '\0';
        else
            txt_Password.PasswordChar='*';

    }

    private void btn_Send_Click(object sender, EventArgs e)
    {
        btn_Send.Enabled = false;
        txt_Password.Text = "";

        try
        {
            message = new MailMessage();
            if(isValidEmail(txt_From.Text))
            {
                message.From = new MailAddress(txt_From.Text);
            }

            if (isValidEmail(txt_To.Text))
            {
                message.To.Add(txt_To.Text);
            }

            message.Body = txt_Details.Text;

            //attributes for smtp
            smtp = new SmtpClient("smtp.gmail.com");
            smtp.Port = 587;
            smtp.EnableSsl = true;
            smtp.UseDefaultCredentials = false;
            smtp.Credentials = new NetworkCredential("imad.majid90@gmail.com", "mypassword");
            smtp.Send(message);

        }

        catch(Exception ex)
        {
            btn_Send.Enabled = true;
            MessageBox.Show(ex.Message);

        }
    }

    public bool isValidEmail(string email)
    {
        bool flagFalse = false; ;
        if (!email.Contains('@'))
        {
            lbl_Error.Visible = true;
            lbl_Error.ForeColor = System.Drawing.Color.Red;
            lbl_Error.Text = "Email address must contain @";
            return flagFalse;
        }

        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:14:53.933

假设您正在使用 Gmail，就像您发布的屏幕截图所示，您无法在不尝试发送电子邮件的情况下检查密码。

我的建议是尝试发送电子邮件并在失败时捕获异常。然后，您可以显示出现错误的一些指示，例如表单上的 MessageBox 或 Label。

请参阅[`SmtpClient`](http://msdn.microsoft.com/en-us/library/swas0fwc.aspx). 如果身份验证失败，这些`Send`方法将抛出一个。`SmtpException`

**编辑：**

好吧，在看到您发布的其他代码之后，您已经在处理引发的任何异常，包括身份验证失败。如果密码不正确，用户将看到一个 MessageBox。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:21:30.857

尝试捕获`SmtpException`并向用户显示未经身份验证的信息。

[http://msdn.microsoft.com/en-us/library/h1s04he7.aspx](http://msdn.microsoft.com/en-us/library/h1s04he7.aspx)

看起来您正在使用`Windows Authentication.`它可能更容易从中获取用户的电子邮件，`Active Directory`而不是提示输入凭据。

[如何通过窗口身份验证获取电子邮件地址](https://stackoverflow.com/questions/1638644/how-to-obtain-email-address-with-window-authentication)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:43:40.220

```
 catch(Exception ex)
    {
        btn_Send.Enabled = true;
       // MessageBox.Show(ex.Message);
         lbl_Error.Text = "Invalid Username/Password";

    } 
```

# node.js - Foursquare 签到回复

> ID：15263427
> 
> 赞同：0
> 
> 时间：2013-03-07T05:01:09.527
> 
> 标签：node.js, express, foursquare

我正在尝试将我的应用程序连接到foursquare，并且我想在用户签入某些地方时显示一条消息。我正在尝试使用他们的实时 api [https://developer.foursquare.com/overview/realtime](https://developer.foursquare.com/overview/realtime)

一切正常，直到最后，（当我必须发送回复帖子请求时[https://developer.foursquare.com/docs/checkins/reply](https://developer.foursquare.com/docs/checkins/reply)）我正在使用 express 和 node.js。这是我的帖子请求的样子。

```
app.post('/handlepush', function(req, res) {
 var checkin_id =req.param('checkin');
 console.log(checkin_id);
 var obj = JSON.parse(checkin_id);
 var id = obj.id;

res.end('It worked!');

var token = "********************************";

var post_data = querystring.stringify({text : "awesome"});
var options = {
    host: 'api.foursquare.com',
    path: '/v2/checkins/' + id + '/reply?oauth_token=' + token,
    port: 443,
    method: 'POST'
};

var req2 = https.request(options, function(res2) {
    res2.setEncoding('utf8');
    res2.on('data', function (chunk) {
        console.log('BODY: ' + chunk);
  });

req2.on('error', function(e) {
  console.log('problem with request: ' + e.message);
});

});
req2.write(post_data);
req2.end();

}); 
```

这是我得到的错误，由于某种原因，我无法为我的帖子添加参数： BODY: {"meta":{"code":400,"errorType":"other","errorDetail":"必须提供参数文本"},"响应":{}}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T16:48:04.533

您需要实际发送您的请求。请参阅：[如何在 node.js 中发出 HTTP POST 请求？](https://stackoverflow.com/questions/6158933/http-post-request-in-node-js)

```
var req2 = http.request(options, function(res2) {
    res2.setEncoding('utf8');
    res2.on('data', function (chunk) {
        console.log('BODY: ' + chunk);
    });
});
req2.end(); 
```

# android - 如何从服务到活动进行数据传输？

> ID：15263430
> 
> 赞同：0
> 
> 时间：2013-03-07T05:01:19.920
> 
> 标签：android, service

我有多个应用程序和一个服务，我想在应用程序和服务之间创建通信。我正在保存应用程序之一发送的服务中的值。现在我试图从服务中的另一个应用程序读取相同的值。

如何做到这一点？我不想从服务中调用显式意图，也不想调用隐式意图，因为隐式意图会提供一个选择选项来选择我不想要的所需应用程序。请指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:13:59.940

使用广播接收器，

```
public class AlarmReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        try {
            //              Bundle bundle = intent.getExtras();
            //          String message = bundle.getString("alarm_message");
            //                  Toast.makeText(context,bundle.getString("eventName"), Toast.LENGTH_SHORT).show();

            NotificationManager notificationManager =(NotificationManager) context.getSystemService(context.NOTIFICATION_SERVICE);
            int icon = R.drawable.event;
            CharSequence notiText = "Event Notification";
            long time = System.currentTimeMillis();
            @SuppressWarnings("deprecation")
            Notification notification = new Notification(icon, notiText,time);
            notification.defaults |= Notification.DEFAULT_SOUND;
            notification.flags |= Notification.FLAG_AUTO_CANCEL;
            Intent notificationIntent = new Intent(context, Setting.class);
                     //put data in notificationIntent ....>>>>>

            PendingIntent contentIntent = PendingIntent.getActivity(context, 0, notificationIntent, 0);
            notification.setLatestEventInfo(context,intent.getStringExtra("eventName"),intent.getStringExtra("eventDescription"), contentIntent);
            int SERVER_DATA_RECEIVED =  1;
            Calendar cal=Calendar.getInstance();
            Toast.makeText(context,"aavechhe "+intent.getBooleanExtra("Flag",false),Toast.LENGTH_SHORT).show();
            if(intent.getIntExtra("month",0)==cal.get(Calendar.DAY_OF_MONTH))
            {
                Toast.makeText(context,"aavechhe "+cal.get(Calendar.DAY_OF_MONTH),Toast.LENGTH_SHORT).show();
                notificationManager.notify(SERVER_DATA_RECEIVED, notification);
            }
            if(intent.getBooleanExtra("Flag",false))
                notificationManager.notify(SERVER_DATA_RECEIVED, notification);

        } catch (Exception e) {
            Toast.makeText(context, "There was an error somewhere, but we still received an alarm", Toast.LENGTH_SHORT).show();
            e.printStackTrace();

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:06:56.673

您可以使用[广播接收器](http://developer.android.com/reference/android/content/BroadcastReceiver.html)来完成这项工作。您不需要后台服务来执行此操作。您可以触发一个意图，并且注册指定意图过滤器的其他应用程序也可以使用该意图。

# c# - 多个拆分的 LINQ 查询变体

> ID：15263432
> 
> 赞同：0
> 
> 时间：2013-03-07T05:01:23.350
> 
> 标签：c#, linq

我想将字符串转换为对象。该字符串采用以下语法。

```
string nameIdPair = "name1:123\r\nname2:456\r\n"; 
```

并说我想要将其转换为的对象定义如下。

```
 public struct MyStruct
    {
        public string Name;
        public int Id;
    } 
```

我想出了以下查询

```
 var elements = nameIdPair.Split(new string[] { "\r\n", "\n" }, StringSplitOptions.RemoveEmptyEntries)
        .Where(p => !string.IsNullOrWhiteSpace(p))
        .Select(r => r.Split(':'))
        .Select(s => ReturnObject(s)); 
```

另外我更喜欢编写 sql 类型的 linq 查询，所以我想我会拆分上面的查询并提出以下解决方案

```
 var elements = from p in nameIdPair.Split(new string[] { "\r\n", "\n" }, StringSplitOptions.RemoveEmptyEntries)
                   where !string.IsNullOrWhiteSpace(p)
                   select ReturnObject(p); // Here p is string not string[] 
```

而且我不想调用辅助函数：-

```
 string[] tempContainer = new string[] { };
    var elements = from p in nameIdPair.Split(new string[] { "\r\n", "\n" }, StringSplitOptions.RemoveEmptyEntries)
                   where (tempContainer = p.Split(':')) != null
                   select new { name = tempContainer[0], id = tempContainer[1] };

    private static object ReturnObject(string inputString)
    {
        string[] value = inputString.Split(':');
        myObject.Name = value[0];
        myObject.Id = int.Parse(value[1]);
        return myObject;
    } 
```

请注意，在最后一个查询中，我使用了一个 dummyContainer 并调用 Where() 只是为了加载 dummyContainer。我想在不使用虚拟变量或外部函数调用的情况下重写最后一个查询，但是我无法提出可行的解决方案。

我可以写如下

```
var elements = from p in nameIdPair.Split(new string[] { "\r\n", "\n" },StringSplitOptions.RemoveEmptyEntries)
               select new { name = p.Split(':')[0], id = p.Split(':')[1] }; 
```

但是在这里我一次又一次地对同一个字符串进行拆分操作，我该如何避免这种情况，没有临时变量。我也忘记了这些风格的 LINQ 查询称为（名称），`(from p in elements)`而不是`elements.Select()`被调用。

另外我想知道如何在不调用 `ReturnObject`函数的情况下重写这篇文章中的第一个查询

我进一步研究发现`let`

```
var items = from p in nameIdPair.Split(new string[] { "\r\n", "\n" }, StringSplitOptions.RemoveEmptyEntries)
            let r = p.Split(':')
            select new { name = r[0], id = r[1] }; 
```

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:50:51.480

你可以使用`let`，像这样：

```
var elements = from p in nameIdPair.Split(new string[] { "\r\n", "\n" }, StringSplitOptions.RemoveEmptyEntries)
               let arr = p.Split(':')
               select new { name = arr[0], id = arr[1] }; 
```

如果您希望它返回`MyStruct`而不是匿名类对象，请尝试以下操作：

```
var elements = from p in nameIdPair.Split(new string[] { "\r\n", "\n" }, StringSplitOptions.RemoveEmptyEntries)
               let arr = p.Split(':')
               select new MyStruct { Name = arr[0], Id = int.Parse(arr[1]) }; 
```

至于 LINQ 语法，我相信你的意思是流利的 vs 查询表达式。

您可以在此处阅读更多相关信息：[LINQ - Fluent and Query Expression - Is there any benefits(s) of one over other？](https://stackoverflow.com/questions/214500/which-linq-syntax-do-you-prefer-fluent-or-query-expression)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T09:05:09.343

这是一个只调用 Split 一次的解决方案。您可以将其粘贴到 LINQPad 中进行尝试。我认为 LINQ 中没有等效的 Unzip 方法，但我很乐意学习其他方法。

此解决方案取决于没有空名称或 id 条目。

```
void Main()
{
    string nameIdPair = "name1:123\r\nname2:456\r\n";

    var strings = nameIdPair.Split(new string[]{ "\r\n", "\r", ":" }, 
                                   StringSplitOptions.RemoveEmptyEntries);
    var structs = strings.Unzip();

    structs.Dump();
}

public struct MyStruct
{
    public string Name;
    public int Id;
}

static class Helpers
{
    public static IEnumerable<MyStruct> Unzip(this IEnumerable<string> items)
    {
        using(var en = items.GetEnumerator())
        {
            string name = null;

            while(en.MoveNext())
            {
                if(name == null){
                    name = en.Current;
                }
                else{
                    int id = int.Parse(en.Current);
                    yield return new MyStruct{Name = name, Id = id};
                    name = null;
                }
            }
        }

        yield break;
    }
} 
```

# wordpress - 如何在创世子主题的#header中添加导航菜单

> ID：15263435
> 
> 赞同：2
> 
> 时间：2013-03-07T05:01:31.583
> 
> 标签：wordpress

我正在开发 Genesis Child 主题，我需要将导航定位在标题区域旁边。如何对导航进行编码以将其放在 #title-area 之后的 #header 中，以便我可以轻松地设置它的样式，使其看起来像这个子主题上的标题：http: [//demo.studiopress.com/associate/](http://demo.studiopress.com/associate/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-06T23:59:48.807

在 Header Right 小部件区域内放置一个自定义菜单小部件。使用提供的下拉菜单选择要显示的菜单。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-10-11T07:13:41.440

嗨，这是我在`#header`

`functions.php`在此之后`require_once( get_template_directory() . '/lib/init.php' );`和此`?>`php 结束之前，我将该代码放在我的子主题中`tag`

代码：

```
Remove_action('genesis_after_header','genesis_do_nav');

Add_action('genesis_site_title','genesis_do_nav'); 
```

**希望它有帮助:)**

# ios - 不同选项卡中的多个 PDF

> ID：15263437
> 
> 赞同：1
> 
> 时间：2013-03-07T05:01:37.443
> 
> 标签：ios, xcode, uiwebview, viewcontroller, tabbar

我有一个带有三个选项卡的 Tabbar iOS 应用程序。我将每个选项卡都设置为 UIWebView。我希望每个 Web 视图显示不同的 PDF。如何通过代码将每个 webview 分配给其相应的 pdf？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:15:16.870

它在您的 中看起来像这样`AppDelegate`：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    WebViewController *webViewController1 = [[WebViewController alloc] initWithPDFAtURL:@"urlToPDF1"];
    WebViewController *webViewController2 = [[WebViewController alloc] initWithPDFAtURL:@"urlToPDF2"];
    WebViewController *webViewController3 = [[WebViewController alloc] initWithPDFAtURL:@"urlToPDF3"];

    UITabBarController *tabBarController = [[UITabBarController alloc] init];
    [tabBarController setViewControllers:[NSArray arrayWithObjects:webViewController1, webViewController2, webViewController3, nil]];
    self.window.rootViewController = tabBarController;

    [self.window makeKeyAndVisible];
    return YES;
} 
```

您将需要一个视图控制器来保存`UIWebView`, 并且可能类似于：

```
// WebViewController.h
@interface WebViewController : UIViewController

@end

// WebViewController.m
@interface WebViewController ()

@property (nonatomic, strong) NSURL *_pdfURL;

@end

@implementation WebViewController
@synthesize _pdfURL;

- (id)initWithPDFAtURL:(NSURL *)url {
    self = [super init];
    if (self) {
        _pdfURL = url;
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    // Load the PDF into a UIWebView
} 
```

# c# - C# 中的列表比较

> ID：15263438
> 
> 赞同：-2
> 
> 时间：2013-03-07T05:01:43.660
> 
> 标签：c#

我想写一个程序，

--> 如果我给出两个路径，即 path1 和 path2。

--> 那些需要比较和打印不同的文件夹和文件（它们在 path1 位置，而在 path2 中不存在，反之亦然）文件夹和文件。

-->我正在使用文件夹和文件的拖链列表。

-->我面临比较两个列表打印差异列表的问题。

如何比较两个列表项并打印不同的项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:25:47.527

我想你的意思是这样的：

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace ConsoleApplication11
{
    class Program
    {
        static void Main(string[] args)
        {

            var listA = new List<int> {1, 2, 5, 4, 7, 6, 5, 3};
            var listB = new List<int> {4, 2, 7, 4, 3, 6, 7, 8, 9, 4, 1};

            var itemsInANotInB = listA.Except(listB).ToList();
            var itemsInBNotInA = listB.Except(listA).ToList();

            var listsHaveAllElementsInCommon = !(itemsInANotInB.Any() && itemsInBNotInA.Any());
            var listAreSequenceEqal = listA.SequenceEqual(listB);

            Console.WriteLine("Items in A but not in B: {0}", itemsInANotInB.Select(x=>x.ToString()).Aggregate((x,y) => x+", "+y));
            Console.WriteLine("Items in B but not in A: {0}", itemsInBNotInA.Select(x => x.ToString()).Aggregate((x, y) => x + ", " + y));
            Console.WriteLine("A and B share the same elements? {0}", listsHaveAllElementsInCommon);
            Console.WriteLine("A and B are sequence-equal? {0}", listAreSequenceEqal);
            Console.Read();
        }
    }
} 
```

# c - Visual Studio 2008 错误：ATL

> ID：15263443
> 
> 赞同：0
> 
> 时间：2013-03-07T05:02:00.480
> 
> 标签：c, visual-studio, visual-studio-2008, atl

得到这个编译错误：

> 错误 4107 致命错误 C1189：#error : ATL 需要 C++ 编译（使用 .cpp 后缀）C:\Program Files\Microsoft Visual Studio 9.0\VC\atlmfc\include\atlbase.h 59

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:04:00.157

正如错误消息所说。如果您的源文件以`.c`编译器结尾，则假定它是与 ATL 所需的 C++ 不兼容的直接 C 源。将文件名更改为`.cpp`，它将编译。

如果您确实需要继续使用 C，那么您将不得不找到 ATL 以外的另一个库来帮助您。

# c# - 使用 C# 将“#BAL#”转换为“#225#”

> ID：15263447
> 
> 赞同：0
> 
> 时间：2013-03-07T05:02:20.073
> 
> 标签：c#, linq

我有一个这样的字符串：

```
string ussdCommand = "#BAL#"; 
```

我想将其转换为“#225#”。目前，我有一个这样定义的字典：

```
Dictionary<string, int> dictionary = new Dictionary<string, int>();
dictionary.Add("ABC", 2);
dictionary.Add("DEF", 3);
dictionary.Add("GHI", 4);
dictionary.Add("JKL", 5);
dictionary.Add("MNO", 6);
dictionary.Add("PQRS", 7);
dictionary.Add("TUV", 8);
dictionary.Add("WXYZ", 9); 
```

然后我有一个函数接受我的原始字符串（“#BAL#”）并将其转换如下：

```
private static string ConvertLettersToPhoneNumbers(string letters)
{
    string numbers = string.Empty;
    foreach (char c in letters)
    {
        numbers += dictionary.FirstOrDefault(d => d.Key.Contains(c)).Value.ToString();
    }
    return numbers;
} 
```

正如您马上会注意到的，问题是我的字典不包含“#”条目，因此 .FirstOrDefault() 返回默认值，而我返回的是“02250”而不是“#225#”。我没有# 符号的字典条目，因为它不对应于数字，但有没有办法修改或覆盖 .FirstOrDefault() 中的默认返回值，以便它在任何时候简单地返回 # 符号发生在我的输入字符串中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:08:05.950

我会将其更改为使用 a `Dictionary<char, char>`，并用于`TryGetValue`轻松找出是否存在映射：

```
private static readonly Dictionary<char, char> PhoneMapping =
    new Dictionary<char, char>
{
    { 'A', '2' }, { 'B', '2' }, { 'C', '2' },
    { 'D', '3' }, { 'E', '3' }, { 'F', '3' },
    { 'G', '4' }, { 'H', '4' }, { 'I', '4' },
    { 'J', '5' }, { 'K', '5' }, { 'L', '5' }, 
    { 'M', '6' }, { 'N', '6' }, { 'O', '6' },
    { 'P', '7' }, { 'Q', '7' }, { 'R', '7' }, { 'S', '7' },
    { 'T', '8' }, { 'U', '8' }, { 'V', '8' },
    { 'W', '9' }, { 'X', '9' }, { 'Y', '9' }, { 'Z', '9' }
};

private static string ConvertLettersToPhoneNumbers(string letters)
{
    char[] replaced = new char[letters.Length];
    for (int i = 0; i < replaced.Length; i++)
    {
        char replacement;
        replaced[i] = PhoneMapping.TryGetValue(letters[i], out replacement)
            ? replacement : letters[i];
    }
    return new string(replaced);
} 
```

请注意，对于您想要“第一个，但有默认值”的*其他*情况，您可以使用：

```
var foo = sequence.DefaultIfEmpty(someDefaultValue).First(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:18:11.940

它的工作

```
protected void Page_Load(object sender, EventArgs e)
    {
        Dictionary<string, int> dictionary = new Dictionary<string, int>();
        dictionary.Add("ABC", 2);
        dictionary.Add("DEF", 3);
        dictionary.Add("GHI", 4);
        dictionary.Add("JKL", 5);
        dictionary.Add("MNO", 6);
        dictionary.Add("PQRS", 7);
        dictionary.Add("TUV", 8);
        dictionary.Add("WXYZ", 9);

        string value = "BAL";
        string nummber = "#";
        foreach (char c in value)
        {

            nummber += dictionary.FirstOrDefault(d => d.Key.Contains(c)).Value.ToString();
        }
        nummber += "#";

    } 
```

# c# - 在 C# 应用程序中可以从内存中读取什么

> ID：15263454
> 
> 赞同：0
> 
> 时间：2013-03-07T05:02:47.970
> 
> 标签：c#, memory

我知道任何正在运行的应用程序（无论它是用 C#、C、C++、Java 等构建的）都会在内存中公开元素。我很好奇如何控制它在内存中暴露的内容和方式？

我很好奇，因为我知道许多游戏会被用户查看或修改游戏内存中的内容并更改它们。我只是想了解有关其工作原理的更多详细信息。我知道必须使用特殊程序才能深入到内存中，并且必须进行转换和其他操作才能使其具有可读性。

让我们举一个非常简单的例子，我会问一些关于它的问题。

```
using System.Security;

static class Program2
{
    private static SecureString fSecureString;

    public static string fPublicString = "Test123";

    private static string fPrivateString = "321tesT";

    static void Main2()
    {

    }
}

class TestClass
{
    private string fInstancedPrivateString;
    public TestClass()
    {
        fInstancedPrivateString = "InstancedSet";
    }

    private string DoSomething()
    {
        return fInstancedPrivateString.ToLower();
    }
} 
```

}

鉴于上面的代码，我想 fPublicString 很明显。阅读记忆的人可以看到哪些元素？他们可以读取变量名还是只看到内存地址和分配的值（Test123）。实例类中的 DoSomething 之类的函数呢？有人可以在内存中看到它并编写恶意代码以随意执行它吗？

我只是好奇在编写应用程序（或游戏）时我需要记住多少。我了解访问器属性（公共/私有/等）的一般概念以及它们与其他具有可见性的代码的关系，但我很好奇它们是否与它在内存中的表示方式有任何关系。

我的最后一个问题将非常具体：EverQuest（游戏）有一个名为 MacroQuest 的 hack，据我了解，它通过具有适当的偏移量来读取内存，然后可以从 EQ 客户端执行代码，或者只是为客户端更改存储在内存中的值。情商怎么弄错了？他们的编程很糟糕吗？一种现在已经解决的技术限制？或者，这在技术上可以用几乎每一个用适量知识编写的软件来完成吗？

总的来说，我想我可能会使用一个很好的教程、文章或书籍，其中提供了一些关于代码在内存中的外观等细节。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:22:04.897

知道您的应用程序的内存可以被读取不应该是“普通”开发人员需要担心的事情。能够以有用的方式利用它的用户数量很少（在宏伟的计划中），而且它只对应用程序的*敏感部分（许可、密码和其他个人身份信息）真正重要。*否则，风险真的可以忽略不计。

如果保护它的努力不能通过这样做的成本来证明是合理的，那么为什么要*花钱*建造它的人/团体/等人要担心。当总是有大量其他事情可以使用时间投资时，不值得花时间去关心。

记事本或 MS Word 是否应该关心您是否可以编写嗅探器来监听正在输入的内容？可能不会，为什么？因为它确实不会影响底线或构成任何现实风险。

# c++ - H.264 复用到 MP4 使用 libavformat 不播放

> ID：15263458
> 
> 赞同：16
> 
> 时间：2013-03-07T05:03:12.370
> 
> 标签：c++, ffmpeg, h.264, mp4, libavformat

我正在尝试将 H.264 数据复用到 MP4 文件中。将此 H.264 Annex B 数据保存到 MP4 文件中似乎没有错误，但文件无法播放。

我对文件进行了二进制比较，问题似乎出在写入 MP4 文件的页脚（预告片）的内容中。

我怀疑它必须与创建流的方式有关。

在里面：

```
AVOutputFormat* fmt = av_guess_format( 0, "out.mp4", 0 );
oc = avformat_alloc_context();
oc->oformat = fmt;
strcpy(oc->filename, filename); 
```

我拥有的这个原型应用程序的一部分是为每个 IFrame 创建一个 png 文件。因此，当遇到第一个 IFrame 时，我创建视频流并写入 av 标头等：

```
void addVideoStream(AVCodecContext* decoder)
{
    videoStream = av_new_stream(oc, 0);
    if (!videoStream)
    {
         cout << "ERROR creating video stream" << endl;
         return;        
    }
    vi = videoStream->index;    
    videoContext = videoStream->codec;      
    videoContext->codec_type = AVMEDIA_TYPE_VIDEO;
    videoContext->codec_id = decoder->codec_id;
    videoContext->bit_rate = 512000;
    videoContext->width = decoder->width;
    videoContext->height = decoder->height;
    videoContext->time_base.den = 25;
    videoContext->time_base.num = 1;    
    videoContext->gop_size = decoder->gop_size;
    videoContext->pix_fmt = decoder->pix_fmt;       

    if (oc->oformat->flags & AVFMT_GLOBALHEADER)
        videoContext->flags |= CODEC_FLAG_GLOBAL_HEADER;

    av_dump_format(oc, 0, filename, 1);

    if (!(oc->oformat->flags & AVFMT_NOFILE))
    {
        if (avio_open(&oc->pb, filename, AVIO_FLAG_WRITE) < 0) {
        cout << "Error opening file" << endl;
    }
    avformat_write_header(oc, NULL);
} 
```

我写出数据包：

```
unsigned char* data = block->getData();
unsigned char videoFrameType = data[4];
int dataLen = block->getDataLen();

// store pps
if (videoFrameType == 0x68)
{
    if (ppsFrame != NULL)
    {
        delete ppsFrame; ppsFrameLength = 0; ppsFrame = NULL;
    }
    ppsFrameLength = block->getDataLen();
    ppsFrame = new unsigned char[ppsFrameLength];
    memcpy(ppsFrame, block->getData(), ppsFrameLength);
}
else if (videoFrameType == 0x67)
{
    // sps
    if (spsFrame != NULL)
    {
        delete spsFrame; spsFrameLength = 0; spsFrame = NULL;
}
    spsFrameLength = block->getDataLen();
    spsFrame = new unsigned char[spsFrameLength];
    memcpy(spsFrame, block->getData(), spsFrameLength);                 
}                                           

if (videoFrameType == 0x65 || videoFrameType == 0x41)
{
    videoFrameNumber++;
}
if (videoFrameType == 0x65)
{
    decodeIFrame(videoFrameNumber, spsFrame, spsFrameLength, ppsFrame, ppsFrameLength, data, dataLen);
}

if (videoStream != NULL)
{
    AVPacket pkt = { 0 };
    av_init_packet(&pkt);
    pkt.stream_index = vi;
    pkt.flags = 0;                      
    pkt.pts = pkt.dts = 0;                                  

    if (videoFrameType == 0x65)
    {
        // combine the SPS PPS & I frames together
        pkt.flags |= AV_PKT_FLAG_KEY;                                                   
        unsigned char* videoFrame = new unsigned char[spsFrameLength+ppsFrameLength+dataLen];
        memcpy(videoFrame, spsFrame, spsFrameLength);
        memcpy(&videoFrame[spsFrameLength], ppsFrame, ppsFrameLength);
        memcpy(&videoFrame[spsFrameLength+ppsFrameLength], data, dataLen);

        // overwrite the start code (00 00 00 01 with a 32-bit length)
        setLength(videoFrame, spsFrameLength-4);
        setLength(&videoFrame[spsFrameLength], ppsFrameLength-4);
        setLength(&videoFrame[spsFrameLength+ppsFrameLength], dataLen-4);
        pkt.size = dataLen + spsFrameLength + ppsFrameLength;
        pkt.data = videoFrame;
        av_interleaved_write_frame(oc, &pkt);
        delete videoFrame; videoFrame = NULL;
    }
    else if (videoFrameType != 0x67 && videoFrameType != 0x68)
    {   
        // Send other frames except pps & sps which are caught and stored                   
        pkt.size = dataLen;
        pkt.data = data;
        setLength(data, dataLen-4);                     
        av_interleaved_write_frame(oc, &pkt);
    } 
```

最后关闭文件：

```
av_write_trailer(oc);
int i = 0;
for (i = 0; i < oc->nb_streams; i++)
{
    av_freep(&oc->streams[i]->codec);
    av_freep(&oc->streams[i]);      
}

if (!(oc->oformat->flags & AVFMT_NOFILE))
{
    avio_close(oc->pb);
}
av_free(oc); 
```

如果我单独获取 H.264 数据并进行转换：

```
ffmpeg -i recording.h264 -vcodec copy recording.mp4 
```

除了文件的“页脚”之外，所有文件都是相同的。

我的程序的输出：readrec recording.tcp out.mp4 **** START **** 01-03-2013 14:26:01 180000 输出 #0，mp4，到“out.mp4”：流 #0:0 : 视频：h264, yuv420p, 352x288, q=2-31, 512 kb/s, 90k tbn, 25 tbc **** END **** 01-03-2013 14:27:01 102000 写了 1499 个视频帧。

如果我尝试使用 ffmpeg 转换使用 CODE 创建的 MP4 文件：

```
ffmpeg -i out.mp4 -vcodec copy out2.mp4
ffmpeg version 0.11.1 Copyright (c) 2000-2012 the FFmpeg developers
      built on Mar  7 2013 12:49:22 with suncc 0x5110
      configuration: --extra-cflags=-KPIC -g --disable-mmx
      --disable-protocol=udp --disable-encoder=nellymoser --cc=cc --cxx=CC
libavutil      51\. 54.100 / 51\. 54.100
libavcodec     54\. 23.100 / 54\. 23.100
libavformat    54\.  6.100 / 54\.  6.100
libavdevice    54\.  0.100 / 54\.  0.100
libavfilter     2\. 77.100 /  2\. 77.100
libswscale      2\.  1.100 /  2\.  1.100
libswresample   0\. 15.100 /  0\. 15.100
h264 @ 12eaac0] no frame!
    Last message repeated 1 times
[h264 @ 12eaac0] slice type too large (0) at 0 0
[h264 @ 12eaac0] decode_slice_header error
[h264 @ 12eaac0] no frame!
    Last message repeated 23 times
[h264 @ 12eaac0] slice type too large (0) at 0 0
[h264 @ 12eaac0] decode_slice_header error
[h264 @ 12eaac0] no frame!
    Last message repeated 74 times
[h264 @ 12eaac0] slice type too large (0) at 0 0
[h264 @ 12eaac0] decode_slice_header error
[h264 @ 12eaac0] no frame!
    Last message repeated 64 times
[h264 @ 12eaac0] slice type too large (0) at 0 0
[h264 @ 12eaac0] decode_slice_header error
[h264 @ 12eaac0] no frame!
    Last message repeated 34 times
[h264 @ 12eaac0] slice type too large (0) at 0 0
[h264 @ 12eaac0] decode_slice_header error
[h264 @ 12eaac0] no frame!
    Last message repeated 49 times
[h264 @ 12eaac0] slice type too large (0) at 0 0
[h264 @ 12eaac0] decode_slice_header error
[h264 @ 12eaac0] no frame!
    Last message repeated 24 times
[h264 @ 12eaac0] Partitioned H.264 support is incomplete
[h264 @ 12eaac0] no frame!
    Last message repeated 23 times
[h264 @ 12eaac0] sps_id out of range
[h264 @ 12eaac0] no frame!
    Last message repeated 148 times
[h264 @ 12eaac0] sps_id (32) out of range
    Last message repeated 1 times
[h264 @ 12eaac0] no frame!
    Last message repeated 33 times
[h264 @ 12eaac0] slice type too large (0) at 0 0
[h264 @ 12eaac0] decode_slice_header error
[h264 @ 12eaac0] no frame!
    Last message repeated 128 times
[h264 @ 12eaac0] sps_id (32) out of range
    Last message repeated 1 times
[h264 @ 12eaac0] no frame!
    Last message repeated 3 times
[h264 @ 12eaac0] slice type too large (0) at 0 0
[h264 @ 12eaac0] decode_slice_header error
[h264 @ 12eaac0] no frame!
    Last message repeated 3 times
[h264 @ 12eaac0] slice type too large (0) at 0 0
[h264 @ 12eaac0] decode_slice_header error
[h264 @ 12eaac0] no frame!
    Last message repeated 309 times
[h264 @ 12eaac0] sps_id (32) out of range
    Last message repeated 1 times
[h264 @ 12eaac0] no frame!
    Last message repeated 192 times
[h264 @ 12eaac0] Partitioned H.264 support is incomplete
[h264 @ 12eaac0] no frame!
    Last message repeated 73 times
[h264 @ 12eaac0] sps_id (32) out of range
    Last message repeated 1 times
[h264 @ 12eaac0] no frame!
    Last message repeated 99 times
[h264 @ 12eaac0] sps_id (32) out of range
    Last message repeated 1 times
[h264 @ 12eaac0] no frame!
    Last message repeated 197 times
[mov,mp4,m4a,3gp,3g2,mj2 @ 12e3100] decoding for stream 0 failed
[mov,mp4,m4a,3gp,3g2,mj2 @ 12e3100] Could not find codec parameters
(Video: h264 (avc1 / 0x31637661), 393539 kb/s)
out.mp4: could not find codec parameters 
```

我真的不知道问题出在哪里，除了它必须与流的设置方式有关。我查看了其他人正在做类似事情的一些代码，并尝试使用此建议来设置流，但无济于事！

* * *

给我一个 H.264/AAC 混合（同步）文件的最终代码如下。首先是一些背景信息。数据来自 IP 摄像机。数据通过第 3 方 API 以视频/音频数据包的形式呈现。视频包以 RTP 有效载荷数据（无标头）的形式呈现，由 NALU 组成，这些 NALU 被重构并转换为附件 B 格式的 H.264 视频。AAC 音频以原始 AAC 形式呈现，并转换为 adts 格式以启用播放。这些数据包已被放入比特流格式，允许传输时间戳（自 1970 年 1 月 1 日以来的 64 位毫秒）以及其他一些内容。

这或多或少是一个原型，在任何方面都不干净。它可能泄漏得很糟糕。但是，我确实希望这可以帮助其他人尝试实现与我相似的目标。

全局变量：

```
AVFormatContext* oc = NULL;
AVCodecContext* videoContext = NULL;
AVStream* videoStream = NULL;
AVCodecContext* audioContext = NULL;
AVStream* audioStream = NULL;
AVCodec* videoCodec = NULL;
AVCodec* audioCodec = NULL;
int vi = 0;  // Video stream
int ai = 1;  // Audio stream

uint64_t firstVideoTimeStamp = 0;
uint64_t firstAudioTimeStamp = 0;
int audioStartOffset = 0;

char* filename = NULL;

Boolean first = TRUE;

int videoFrameNumber = 0;
int audioFrameNumber = 0; 
```

主要的：

```
int main(int argc, char* argv[])
{
    if (argc != 3)
    {   
        cout << argv[0] << " <stream playback file> <output mp4 file>" << endl;
        return 0;
    }
    char* input_stream_file = argv[1];
    filename = argv[2];

    av_register_all();    

    fstream inFile;
    inFile.open(input_stream_file, ios::in);

    // Used to store the latest pps & sps frames
    unsigned char* ppsFrame = NULL;
    int ppsFrameLength = 0;
    unsigned char* spsFrame = NULL;
    int spsFrameLength = 0;

    // Setup MP4 output file
    AVOutputFormat* fmt = av_guess_format( 0, filename, 0 );
    oc = avformat_alloc_context();
    oc->oformat = fmt;
    strcpy(oc->filename, filename);

    // Setup the bitstream filter for AAC in adts format.  Could probably also achieve
    // this by stripping the first 7 bytes!
    AVBitStreamFilterContext* bsfc = av_bitstream_filter_init("aac_adtstoasc");
    if (!bsfc)
    {       
        cout << "Error creating adtstoasc filter" << endl;
        return -1;
    }

    while (inFile.good())
    {
        TcpAVDataBlock* block = new TcpAVDataBlock();
        block->readStruct(inFile);
        DateTime dt = block->getTimestampAsDateTime();
        switch (block->getPacketType())
        {
            case TCP_PACKET_H264:
            {       
                if (firstVideoTimeStamp == 0)
                    firstVideoTimeStamp = block->getTimeStamp();
                unsigned char* data = block->getData();
                unsigned char videoFrameType = data[4];
                int dataLen = block->getDataLen();

                // pps
                if (videoFrameType == 0x68)
                {
                    if (ppsFrame != NULL)
                    {
                        delete ppsFrame; ppsFrameLength = 0;
                        ppsFrame = NULL;
                    }
                    ppsFrameLength = block->getDataLen();
                    ppsFrame = new unsigned char[ppsFrameLength];
                    memcpy(ppsFrame, block->getData(), ppsFrameLength);
                }
                else if (videoFrameType == 0x67)
                {
                    // sps
                    if (spsFrame != NULL)
                    {
                        delete spsFrame; spsFrameLength = 0;
                        spsFrame = NULL;
                    }
                    spsFrameLength = block->getDataLen();
                    spsFrame = new unsigned char[spsFrameLength];
                    memcpy(spsFrame, block->getData(), spsFrameLength);                   
                }                                           

                if (videoFrameType == 0x65 || videoFrameType == 0x41)
                {
                    videoFrameNumber++;
                }
                // Extract a thumbnail for each I-Frame
                if (videoFrameType == 0x65)
                {
                    decodeIFrame(h264, spsFrame, spsFrameLength, ppsFrame, ppsFrameLength, data, dataLen);
                }
                if (videoStream != NULL)
                {
                    AVPacket pkt = { 0 };
                    av_init_packet(&pkt);
                    pkt.stream_index = vi;
                    pkt.flags = 0;           
                    pkt.pts = videoFrameNumber;
                    pkt.dts = videoFrameNumber;           
                    if (videoFrameType == 0x65)
                    {
                        pkt.flags = 1;                           

                        unsigned char* videoFrame = new unsigned char[spsFrameLength+ppsFrameLength+dataLen];
                        memcpy(videoFrame, spsFrame, spsFrameLength);
                        memcpy(&videoFrame[spsFrameLength], ppsFrame, ppsFrameLength);

                        memcpy(&videoFrame[spsFrameLength+ppsFrameLength], data, dataLen);
                        pkt.data = videoFrame;
                        av_interleaved_write_frame(oc, &pkt);
                        delete videoFrame; videoFrame = NULL;
                    }
                    else if (videoFrameType != 0x67 && videoFrameType != 0x68)
                    {                       
                        pkt.size = dataLen;
                        pkt.data = data;
                        av_interleaved_write_frame(oc, &pkt);
                    }                       
                }
                break;
            }

        case TCP_PACKET_AAC:

            if (firstAudioTimeStamp == 0)
            {
                firstAudioTimeStamp = block->getTimeStamp();
                uint64_t millseconds_difference = firstAudioTimeStamp - firstVideoTimeStamp;
                audioStartOffset = millseconds_difference * 16000 / 1000;
                cout << "audio offset: " << audioStartOffset << endl;
            }

            if (audioStream != NULL)
            {
                AVPacket pkt = { 0 };
                av_init_packet(&pkt);
                pkt.stream_index = ai;
                pkt.flags = 1;           
                pkt.pts = audioFrameNumber*1024;
                pkt.dts = audioFrameNumber*1024;
                pkt.data = block->getData();
                pkt.size = block->getDataLen();
                pkt.duration = 1024;

                AVPacket newpacket = pkt;                       
                int rc = av_bitstream_filter_filter(bsfc, audioContext,
                    NULL,
                    &newpacket.data, &newpacket.size,
                    pkt.data, pkt.size,
                    pkt.flags & AV_PKT_FLAG_KEY);

                if (rc >= 0)
                {
                    //cout << "Write audio frame" << endl;
                    newpacket.pts = audioFrameNumber*1024;
                    newpacket.dts = audioFrameNumber*1024;
                    audioFrameNumber++;
                    newpacket.duration = 1024;                   

                    av_interleaved_write_frame(oc, &newpacket);
                    av_free_packet(&newpacket);
                }   
                else
                {
                    cout << "Error filtering aac packet" << endl;

                }
            }
            break;

        case TCP_PACKET_START:
            break;

        case TCP_PACKET_END:
            break;
        }
        delete block;
    }
    inFile.close();

    av_write_trailer(oc);
    int i = 0;
    for (i = 0; i < oc->nb_streams; i++)
    {
        av_freep(&oc->streams[i]->codec);
        av_freep(&oc->streams[i]);       
    }

    if (!(oc->oformat->flags & AVFMT_NOFILE))
    {
        avio_close(oc->pb);
    }

    av_free(oc);

    delete spsFrame; spsFrame = NULL;
    delete ppsFrame; ppsFrame = NULL;

    cout << "Wrote " << videoFrameNumber << " video frames." << endl;

    return 0;
} 
```

添加流流/编解码器，并在名为 addVideoAndAudioStream() 的函数中创建标头。这个函数是从 decodeIFrame() 调用的，所以有一些假设（不一定是好的） 1\. 视频包首先出现 2\. AAC 存在

decodeIFrame 是一种单独的原型，我在其中为每个 I Frame 创建缩略图。生成缩略图的代码来自：[https ://gnunet.org/svn/Extractor/src/plugins/thumbnailffmpeg_extractor.c](https://gnunet.org/svn/Extractor/src/plugins/thumbnailffmpeg_extractor.c)

decodeIFrame 函数将一个 AVCodecContext 传递给 addVideoAudioStream：

```
void addVideoAndAudioStream(AVCodecContext* decoder = NULL)
{
    videoStream = av_new_stream(oc, 0);
    if (!videoStream)
    {
        cout << "ERROR creating video stream" << endl;
        return;       
    }
    vi = videoStream->index;   
    videoContext = videoStream->codec;       
    videoContext->codec_type = AVMEDIA_TYPE_VIDEO;
    videoContext->codec_id = decoder->codec_id;
    videoContext->bit_rate = 512000;
    videoContext->width = decoder->width;
    videoContext->height = decoder->height;
    videoContext->time_base.den = 25;
    videoContext->time_base.num = 1;
    videoContext->gop_size = decoder->gop_size;
    videoContext->pix_fmt = decoder->pix_fmt;       

    audioStream = av_new_stream(oc, 1);
    if (!audioStream)
    {
        cout << "ERROR creating audio stream" << endl;
        return;
    }
    ai = audioStream->index;
    audioContext = audioStream->codec;
    audioContext->codec_type = AVMEDIA_TYPE_AUDIO;
    audioContext->codec_id = CODEC_ID_AAC;
    audioContext->bit_rate = 64000;
    audioContext->sample_rate = 16000;
    audioContext->channels = 1;

    if (oc->oformat->flags & AVFMT_GLOBALHEADER)
    {
        videoContext->flags |= CODEC_FLAG_GLOBAL_HEADER;
        audioContext->flags |= CODEC_FLAG_GLOBAL_HEADER;
    }

    av_dump_format(oc, 0, filename, 1);

    if (!(oc->oformat->flags & AVFMT_NOFILE))
    {
        if (avio_open(&oc->pb, filename, AVIO_FLAG_WRITE) < 0) {
            cout << "Error opening file" << endl;
        }
    }

    avformat_write_header(oc, NULL);
} 
```

据我所知，一些假设似乎并不重要，例如： 1\. 比特率。实际视频比特率约为 262k，而我指定 512kbit 2\. AAC 频道。我指定了单声道，虽然实际输出是来自内存的立体声

您仍然需要知道视频和音频的帧速率（时基）是多少。

与许多其他示例相反，在视频数据包上设置 pts 和 dts 时，它无法播放。我需要知道时基（25fps），然后根据该时基设置 pts 和 dts，即第一帧 = 0（PPS，SPS，I），第二帧 = 1（中间帧，不管它叫什么；）） .

AAC 我还必须假设它是 16000 赫兹。每个 AAC 数据包 1024 个样本（我认为您也可以使用 AAC @ 960 个样本）来确定音频“偏移量”。我将此添加到 pts & dts。所以 pts/dts 是要回放的样本编号。您还需要确保在写入之前在数据包中设置了 1024 的持续时间。

--

我今天还发现附件 B 与任何其他播放器都不兼容，因此应该使用 AVCC 格式。

这些 URL 有帮助： [Problem to Decode H264 video over RTP with ffmpeg (libavcodec)](https://stackoverflow.com/questions/3493742/problem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec) [http://aviadr1.blogspot.com.au/2010/05/h264-extradata-partially-explained-for.html](http://aviadr1.blogspot.com.au/2010/05/h264-extradata-partially-explained-for.html)

在构建视频流的时候，我填写了extradata&extradata_size：

```
// Extradata contains PPS & SPS for AVCC format
int extradata_len = 8 + spsFrameLen-4 + 1 + 2 + ppsFrameLen-4;
videoContext->extradata = (uint8_t*)av_mallocz(extradata_len);
videoContext->extradata_size = extradata_len;
videoContext->extradata[0] = 0x01;
videoContext->extradata[1] = spsFrame[4+1];
videoContext->extradata[2] = spsFrame[4+2];
videoContext->extradata[3] = spsFrame[4+3];
videoContext->extradata[4] = 0xFC | 3;
videoContext->extradata[5] = 0xE0 | 1;
int tmp = spsFrameLen - 4;
videoContext->extradata[6] = (tmp >> 8) & 0x00ff;
videoContext->extradata[7] = tmp & 0x00ff;
int i = 0;
for (i=0;i<tmp;i++)
    videoContext->extradata[8+i] = spsFrame[4+i];
videoContext->extradata[8+tmp] = 0x01;
int tmp2 = ppsFrameLen-4;   
videoContext->extradata[8+tmp+1] = (tmp2 >> 8) & 0x00ff;
videoContext->extradata[8+tmp+2] = tmp2 & 0x00ff;
for (i=0;i<tmp2;i++)
    videoContext->extradata[8+tmp+3+i] = ppsFrame[4+i]; 
```

写出帧时，不要在前面加上 SPS 和 PPS 帧，只写出 I 帧和 P 帧。另外，将前4个字节（0x00 0x00 0x00 0x01）中包含的附件​​B起始码替换为I/P帧的大小。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T06:57:40.407

Please let me sum it up: the problem with your (original) code was that the input to `av_interleaved_write_frame()` should not start with the packet length. The file may still be playable if you don't strip the `00 00 00 01` start codes, but that IMHO is a resilience behavior of the player, and I would not count on this.

# zip - 如何使用批处理命令压缩文件而不压缩

> ID：15263459
> 
> 赞同：0
> 
> 时间：2013-03-07T05:03:14.693
> 
> 标签：zip, ear, jdeveloper, winrar

我正在编写一个批处理文件以制作`.ear`文件。这是我的代码片段：

```
winrar.exe a -afzip -m5 -ed -pTest -r -ep1 %earName%.ear %extractDest%* 
```

这段代码压缩了我不想要的包含文件。如何在不压缩的情况下`"extractDest"`将文件添加到文件中？`.ear`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:13:56.420

您可以使用[Info-Zip](http://www.info-zip.org/Zip.html#Downloads)`zip`中的命令行，如下所示：

```
zip -rp0 earname.ear source_dir 
```

`-0`表示存储而不压缩（`-r`递归，`-p`保留相对路径）。

与 不同`winrar`的是，Info-Zip 是开源的（没有购买提示），并且它`zip`是`unzip`真正的命令行实用程序，而且是非常小的实用程序。

如果您坚持使用`winrar`，则必须使用选项`-m0`（而不是`-m5`），它选择`0`（存储）压缩级别。

# google-maps - 如何过滤 Google 地图附近搜索请求中支持的地点类型

> ID：15263460
> 
> 赞同：0
> 
> 时间：2013-03-07T05:03:16.197
> 
> 标签：google-maps, google-maps-api-3

[知道 Google Maps Api 在其支持的地点类型列表](https://developers.google.com/places/documentation/supported_types)中有“学校”，但只是想知道是否有办法将子列表添加到该列表中？例如，有什么方法可以在下面的代码中只列出“**小学”而不是所有学校？**

```
var request = {
location: myplace,
radius: '500',
types: ['Elementary school']
}; 
```

# ruby - C ?: 运算符的 Ruby 等价物是什么？

> ID：15263466
> 
> 赞同：0
> 
> 时间：2013-03-07T05:03:52.463
> 
> 标签：ruby

C 有短的条件分支运算符。

```
int a = 1 < 2 ? 3 : 4; 
```

Ruby 中的等价物是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T05:07:16.817

Ruby 也有三元运算符，你可以用同样的方法来做。

```
a = 1 < 2 ? 3 : 4 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T05:05:05.337

```
a = true  ? 'a' : 'b' #=> "a"
b = false ? 'a' : 'b' #=> "b" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-07T05:25:17.070

您也可以使用整个`if`语句，因为它也是一个表达式：

```
a = if 1 < 2 then 3 else 4 end 
```

甚至：

```
a = if 1 < 2
      3
    else
      4
    end 
```

# forms - 表单提交后没有得到文件名

> ID：15263471
> 
> 赞同：0
> 
> 时间：2013-03-07T05:04:06.693
> 
> 标签：forms

我正在尝试提交一个动态生成的表单。表单提交后，我从`Form`除了一个元素（文件元素）之外获取所有值。甚至我的表单 enctype 也是`multipart/form-data`.

我检查过`HTTPfox`它显示在下面

```
Content-Disposition: form-data; name="upfile1"; filename=""
Content-Type: application/octet-stream 
```

我不明白这里发生了什么。

```
 var str_new='<form id="uploader'+count+'" action="testkal.php" name="frmattach_kal" class="uploader" method="post" enctype="multipart/form-data" target="upload_target'+count+'"><div id="upload_progress_form'+count+'" style="clear:both">&nbsp;</div>';
       str_new +='<div class="upload_form" id="f'+count+'_upload_form"><div class="attch rmailsprite"></div><div class="upld" id="upld"><div id="upl'+count+'" class="zin2" style="width:62px;overflow:hidden;cursor:pointer;float:left;position:absolute;filter: alpha(opacity=0);"><input id="myfile'+count+'" name="upfile1" type="file" class="fileclass" size="30" onchange="javascript:upload_form_attachment('+count+');" /><input type=hidden name="FormName" value="attach" /><input type=hidden name="output" value="xml" /><input type=hidden name="sid" value="5" /></div>';
        str_new +='<div class="cornLeftTop" style="float:left;"><a id="anch'+count+'" style="text-decoration: underline;" href="javascript:void(0);" onclick="javascript:test_fn('+count+');">Select file</a><span class="greyI" id="upld_inst'+count+'">(This file will start attaching once the previous file is done)</span></div>';
        str_new +='</div><div class="adjustdiv"></div></form><iframe id="upload_target'+count+'" name="upload_target'+count+'" class="upload_target" src=""></iframe>';
        document.getElementById("uploadstate").innerHTML=str_new; 
```

这就是我生成表单的方式。它正在提交文件元素的 onchange 事件。document.getElementById("uploader"+count).setAttribute("enctype","multipart/form-data"); document.getElementById("uploader"+count).setAttribute("encoding","multipart/form-data");

我也在这里设置 enctype

# visual-studio-2010 - 从现有项目文件新建 VB 项目

> ID：15263472
> 
> 赞同：0
> 
> 时间：2013-03-07T05:04:17.990
> 
> 标签：visual-studio-2010

我有一个用 Visual Basic 编译的程序的项目文件。扩展是：

```
.cls
.frm
.frx
.bas
.SCC
.vbp
.vbw 
```

目前这些文件位于 .zip 中。如何将这些文件导入新项目以修改代码并自己重新编译？

# c# - 将多个复选框值应用于标签 C#

> ID：15263479
> 
> 赞同：0
> 
> 时间：2013-03-07T05:04:57.120
> 
> 标签：c#

我有一个带有十个不同复选框的组合框，其中包含不同的披萨配料。当我选中多个框时，我希望浇头的名称在 groupbox 下方的标签上显示为字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T06:01:35.273

Yes, instead of using simple check boxes, use a CheckedListBox control (otherwise you must handle each check box click event separately)

So when you are done addnig 10 items in a CheckedListBox, then set its property: `CheckonClick` to true

Then double click the control and use the following code:

```
Label1.Text+=checkedListBox1.SelectedItem.ToString() + " "; 
```

# php - 重写代码以使用 PDO 并提高多次插入的效率

> ID：15263481
> 
> 赞同：0
> 
> 时间：2013-03-07T05:05:03.427
> 
> 标签：php, mysql, loops, insert, pdo

我有以下代码，我希望更有效地执行对数据库的插入，并将代码更新为现在使用 PDO：

```
foreach ($urls as $i => $url) {         

    //path to csv file
    $web = "http://path-to-file/".$url;

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_COOKIEJAR, "cookies.txt");
    curl_setopt($ch, CURLOPT_COOKIEFILE, "cookies.txt");
    curl_setopt ($ch, CURLOPT_URL, $web);
    curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt ($ch, CURLOPT_TIMEOUT, 30);
    $result = curl_exec($ch);

    //explode the csv file by new line
    $r = explode("\n", $result);

    $sql = "insert into product (`product_name`) values ";

    for ($i = 1; $i <= count($r); $i++){

        //explode each row by comma
        $n = explode(",", $r[$i]);                  
        $product_name = $n[0];

        $sql .= "('$product_name'),";

    }

    $sql = trim($sql, ",");

    if(count($n) != 0)
        mysql_query($sql);                  

} 
```

首先，有一个循环，从远程文件中检索数据并将所有这些数据从文件中插入到数据库中。目前，代码从一个文件插入数据，然后移动到下一个文件。每个文件最多可以插入 2000 条，通常以 15 条为一组进行（所以粗略的插入记录总数为 30000 条）。一次或分批插入所有 30000 条记录在数据库上会更有效吗？（请记住，站点上可能有多个用户也在检索文件并执行插入）。

其次，我想修改上面的代码以使用 PDO。

对此的任何帮助将不胜感激。

谢谢

PS。我确实知道如何创建 PDO 数据库连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:14:39.687

用最简单的代码做到这一点：

```
// Start PDO connection (DataBaseHandler)
$user = 'dbuser';
$password = 'dbpass';
$dbh = new PDO('mysql:host=localhost;dbname=database', $user, $password);

// Prepare a reusable insert statement and bind the variable
$insert = $dbh->prepare("INSERT INTO product (`product_name`) VALUES (:product_name)");
$insert->bindParam(':product_name',$product_name);

// Use foreach for arrays
foreach($r as $row){
    //explode each row by comma
    $n = explode(",", $row);                  
    $product_name = $n[0];

    // Execute the prepared INSERT statement referring to the current product name
    $insert->execute();
} 
```

不确定在一个语句中执行 ### INSERTS 是否会比执行 ### 单独的 INSERT 语句更快，但是由于 PDO 准备好的语句，这段代码肯定更简单有效： [http ://www.php.net/manual/ zh/pdo.prepare.php](http://www.php.net/manual/en/pdo.prepare.php)

**编辑：**

根据[这个答案](https://stackoverflow.com/a/1793209/703229)，做一个大查询要快得多。我希望我能让你开始使用 PDO 和准备好的语句，但是这样做你学得最好，我将由你来创建新的 PDO 查询。这可能会让您入门：[https ://stackoverflow.com/a/6235710/703229](https://stackoverflow.com/a/6235710/703229)

# c++ - 将动态长度数据存储在“内部”结构中

> ID：15263485
> 
> 赞同：1
> 
> 时间：2013-03-07T05:05:10.650
> 
> 标签：c++, c, algorithm, data-structures

**问题陈述：**用户提供了一些我必须存储在结构中的数据。我收到的这些数据采用数据结构，允许用户向其中动态添加数据。

**要求：** 我需要一种将这些数据*连续*存储在结构*“内部”*的方法。

 *例如。假设用户可以传递我必须存储的字符串。所以我写了这样的东西：

```
void pushData( string userData )
{
    struct 
    {
       string junk;
    } data;

    data.junk = userData;
} 
```

**问题：**当我进行这种存储时，实际数据并没有真正存储在结构“内部”，因为字符串不是 POD。当我收到向量或列表时，也会出现类似的问题。

然后我可以做这样的事情：

```
void pushData( string userData )
{
    struct 
    {
       char junk[100];
    } data;    

    // Copy userdata into array junk
} 
```

这将数据存储在结构“内部”，但是，我不能对用户可以提供的字符串大小设置上限。

有人可以提出一些方法吗？

PS：我读过一些关于可序列化的东西，但如果它对我的情况有帮助，我就不能真正清楚地弄清楚。如果这是前进的道路，有人可以给出如何进行的想法吗？

* * *

编辑 ：

1.  不，这不是家庭作业。
2.  我编写了一个实现，它可以通过消息队列传递这种结构。它适用于 POD，但我需要扩展它以传递动态数据。

这是消息队列获取数据的方式：

一世。给它一个指针并告诉它应该读取和传输数据的大小。

ii. 对于普通的旧数据类型，数据存储在结构内，我可以轻松地将这个结构的指针传递给消息队列给其他进程。

iii. 但是在向量/字符串/列表等情况下，实际数据不在结构内部，因此如果我传递这个结构的指针，消息队列不会真正传递实际数据，而是将存储在内部的指针这种结构。

你可以看到[这个](https://stackoverflow.com/questions/1181816/how-to-receive-dynamic-length-data-from-a-message-queue)和[这个](https://stackoverflow.com/questions/13963653/ipc-message-queues-how-to-send-a-vector-of-pairs)。我正在尝试实现类似的目标。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:11:24.237

```
void pushData( string userData )
{
    struct Data
    {
       char junk[1];
    };

    struct Data* data = malloc(userData.size() + 1);
    memcpy(data->junk, userData.data(), userData.size());
    data->junk[userData.size()] = '\0'; // assuming you want null termination
} 
```

这里我们使用长度为 1 的数组，但我们使用 malloc 分配结构，因此它实际上可以具有我们想要的任何大小。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T05:14:39.693

表面上你有一些相当人为的约束，但要回答这个问题：对于一个`struct`包含可变数量的数据的单一是不可能的......你最接近的是让最后一个成员说`char [1]`，把这样一个结构放在一个可变大小的堆区域的开始，并使用不检查数组索引来访问超出该字符的内存这一事实。要了解此技术，请参阅[http://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html](http://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html)（或 John Zwinck 刚刚发布的答案）

另一种方法是 eg `template <size_t N> struct X { char data_[size]; };`，但是每个实例化都将是一个单独的结构类型，并且您不能在运行时预先实例化您可能想要的每个大小（假设您已经说过您不想要上限）。即使可以，随着数据的增长编写处理不同实例化的代码也将是一场噩梦，正如代码膨胀所导致的那样。

在一个地方有一个结构，一个字符串成员在另一个地方有数据，几乎总是比上面的hackery更可取。

采取一个希望不是那么疯狂的猜测，我假设您的兴趣是基于起始地址和大小序列化对象，在一些通用的二进制块读/写中......？如果是这样，即使您的目标得到满足，这仍然是个问题，因为您需要从某个地方找出当前的数据大小。编写包含堆上可变长度数据的特定于结构的序列化例程更有希望。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:45:26.117

简单的解决方案：估计数据的最大大小（例如 1000），以防止在 pushData 多次调用时发生内存泄漏（如果释放内存和 malloc 新大小内存 -> 片段内存）。

```
#define MAX_SIZE 1000
void pushData( string userData )
{
 struct Data
 {
   char junk[MAX_SIZE];
 };

memcpy(data->junk, userData.data(), userData.size());
data->junk[userData.size()] = '\0'; // assuming you want null termination
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T05:48:47.243

正如 John Zwinck 所提到的......您可以使用动态内存分配来解决您的问题。

```
void pushData( string userData )
{
    struct Data
    {
       char *junk;
    };

    struct Data *d = calloc(sizeof(struct data), 1);
    d->junk = malloc(strlen(userData)+1);
    strcpy(d->junk, userdata);
} 
```*

# php - 访问以数组命名的文件

> ID：15263487
> 
> 赞同：0
> 
> 时间：2013-03-07T05:05:14.323
> 
> 标签：php, file

我是一名新的 PHP 开发人员，我刚刚开始使用 PHP 中的文件。我有以下代码来计算目录中 txt 文件的数量并将它们的名称存储在一个数组中，然后使用循环显示每个文件中的总行数！这是代码，请帮助我哪里出错了！

```
$dir = opendir('directory/');
$num_files = 0;
$dir_files[] = array();
while (false !== ($file = readdir($dir))){
    if (!in_array($file, array('.', '..','Thumbs.db')) and !is_dir($file)){
    $num_files++;
    echo $file;
    array_push($dir_files,$file);
    echo "<br />";
    }
}

echo "--------------------------------------<br />";
echo "Number of files in this directory: ".$num_files."<br />";
echo "--------------------------------------<br />";
foreach($dir_files as $dir_file=>$value){
    $file='directory/'.$value;
    $linecount = 0;
    $handle = fopen($file, "r");
    while(!feof($handle)){
      $line = fgets($handle);
      $linecount++;
    }
    fclose($handle);
    echo "File $file has $linecount lines!";
} 
```

我收到以下错误：

注意：第 19 行 D:\xampp\htdocs\PHP_practice\read_lines_of_files.php 中的数组到字符串转换

警告：fopen（目录/数组）：无法打开流：第 21 行的 D:\xampp\htdocs\PHP_practice\read_lines_of_files.php 中没有这样的文件或目录

警告：feof() 期望参数 1 是资源，布尔值在 D:\xampp\htdocs\PHP_practice\read_lines_of_files.php 第 22 行给出

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:21:21.153

你的代码太长了。试试这个：这将为您完成全部功能，如果有任何问题，请告诉我。

```
foreach(glob('directory/*.txt',GLOB_BRACE) as $value){
    $file      =$value;
    $linecount = 0;
    $handle    = fopen($file, "r");
    while(!feof($handle)){
      $line    = fgets($handle);
      $linecount++;
    }
    fclose($handle);
    echo "File $file has $linecount lines!";
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:10:32.893

改变：

```
$dir_files[] = array(); 
```

到

```
$dir_files = array(); 
```

并且： [fopen()](http://php.net/manual/en/function.fopen.php)在成功或错误时返回文件指针资源。`FALSE`因为它在打开文件时抛出错误，所以 feof() 正在接收 FALSE 而不是文件指针资源：所以你得到错误`"expects parameter 1 to be resource, boolean given in"...`

# php - PHP cURL 无法使用 cURL 登录

> ID：15263490
> 
> 赞同：1
> 
> 时间：2013-03-07T05:05:28.097
> 
> 标签：php, post, curl, login

我想登录 fashiondays.ro 但出错。这是我的代码我尝试了很多脚本但我似乎无法让它工作......

当前脚本：

```
<?php
$loginUrl = 'https://www.fashiondays.ro/login_check/';
$email = 'thomanphan%40gmail.com';//demo user name
$password = '1234567890';//demo pass

$cookie_file = dirname(__FILE__) . DIRECTORY_SEPARATOR . "cookies.txt";
if (!file_exists($cookie_file)) 
{
    $ourFileHandle = fopen($cookie_file, 'w') or die("can't open file");
    fclose($ourFileHandle);
}
// make list of POST fields
$fields = array(
    '_username' => urlencode($email),
    '_password' => urlencode($password),
    '_country_code' => urlencode('ro'),
    '_remember_me' => urlencode('1')
);
$fields_string = '';
foreach ($fields as $key => $value) {
    $fields_string .= $key . '=' . $value . '&';
}
rtrim($fields_string, '&');
$ch = curl_init();
$headers = array(
    'accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
    "content-length: " . count($fields_string) //instead of 0, how could I get the   
    length of the body from curl?   
);
curl_setopt($ch, CURLOPT_HTTPHEADER, $headers); //set headers
curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie_file);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_URL, $loginUrl);
curl_setopt($ch, CURLOPT_POST, count($fields));
curl_setopt($ch, CURLOPT_POSTFIELDS, $fields_string);
curl_setopt($ch, CURLOPT_REFERER, 'https://www.fashiondays.ro/login/');
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
$result = curl_exec($ch);
if ($result === false) {
    die('CURL ERROR: ' . curl_error($ch));
} else {
    curl_setopt($ch, CURLOPT_URL, 'http://www.fashiondays.ro/campaigns/');
    curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie_file);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    $result = curl_exec($ch);
    curl_close($ch);
    if ($result === false) {
        die('CURL ERROR: ' . curl_error($ch));
    } else {
        echo $result;
    }
}
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T07:55:22.000

试试这个简单的功能来登录。

> > 将参数作为数组发送到 CURLOPT_POSTFIELDS

```
/**
* If login is required use this function
* to have session/cookie.
*/
function logIn($loginActionUrl,$parameters)
{
        curl_setopt ($this->curl, CURLOPT_URL,$loginActionUrl); 
        curl_setopt ($this->curl, CURLOPT_POST, 1); 
        curl_setopt ($this->curl, CURLOPT_POSTFIELDS, $parameters); 
        curl_setopt ($this->curl, CURLOPT_COOKIEJAR, realpath('cookie.txt')); // cookie.txt should be in same directoy, where calling script is 
        curl_setopt ($this->curl, CURLOPT_COOKIEFILE, realpath('cookie.txt'));
        curl_setopt ($this->curl, CURLOPT_FOLLOWLOCATION, 1);
        curl_setopt ($this->curl, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt ($this->curl, CURLOPT_USERAGENT, 'Mozilla/5.0 (X11; U; Linux i586; de; rv:5.0) Gecko/20100101 Firefox/5.0');            
        curl_setopt ($this->curl, CURLOPT_REFERER, 'http://www.google.com');    // set referer
        curl_setopt ($this->curl, CURLOPT_SSL_VERIFYPEER, FALSE);// ssl certificate
        curl_setopt ($this->curl, CURLOPT_SSL_VERIFYHOST, 2);

        $result['EXE'] = curl_exec($this->curl);
        $result['INF'] = curl_getinfo($this->curl);
        $result['ERR'] = curl_error($this->curl);
        return $result;                 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-06T07:45:19.343

在 ImpressPages 上，我是这样做的：

```
//initial request with login data

$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'http://www.example.com/login.php');
curl_setopt($ch, CURLOPT_USERAGENT,'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/32.0.1700.107 Chrome/32.0.1700.107 Safari/537.36');
curl_setopt($ch, CURLOPT_POST, true);
curl_setopt($ch, CURLOPT_POSTFIELDS, "username=XXXXX&password=XXXXX");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_COOKIESESSION, true);
curl_setopt($ch, CURLOPT_COOKIEJAR, 'cookie-name');  //could be empty, but cause problems on some hosts
curl_setopt($ch, CURLOPT_COOKIEFILE, '/var/www/ip4.x/file/tmp');  //could be empty, but cause problems on some hosts
$answer = curl_exec($ch);
if (curl_error($ch)) {
    echo curl_error($ch);
}

//another request preserving the session

curl_setopt($ch, CURLOPT_URL, 'http://www.example.com/profile');
curl_setopt($ch, CURLOPT_POST, false);
curl_setopt($ch, CURLOPT_POSTFIELDS, "");
$answer = curl_exec($ch);
if (curl_error($ch)) {
    echo curl_error($ch);
} 
```

# angularjs - 我们可以用angularjs中的任何响应解决任何延迟吗

> ID：15263491
> 
> 赞同：0
> 
> 时间：2013-03-07T05:05:30.840
> 
> 标签：angularjs

我无法理解，这段代码中的某些内容[http://www.espeo.pl/2012/02/26/authentication-in-angularjs-application](http://www.espeo.pl/2012/02/26/authentication-in-angularjs-application) 这段代码，试图重新发送相同的请求（登录前的一个用户请求）用户登录后。

我的问题

1.  在重试函数内部，他们将延迟与用户登录后发送的请求的响应相结合。响应和延迟之间没有任何关系。为什么他们应该这样做？

-

```
function retry(req) {
    $http(req.config).then(function(response) {
        req.deferred.resolve(response);
    });
} 
```

请查看上述 url 中的代码以了解该`retry`方法的工作原理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:40:33.623

你可以用任何你想要的来解决一个承诺。在这种情况下，当第一次遇到 401 状态代码/错误时，向应用程序返回了一个 Promise。现在，在`loginConfirmed`事件之后，再次发送请求并使用响应来解决该承诺。

# informix - Informix DELETE 查询需要很长时间

> ID：15263494
> 
> 赞同：1
> 
> 时间：2013-03-07T05:05:51.930
> 
> 标签：informix

在生产中，我面临这个问题。

有一个`delete`需要很长时间才能执行并最终抛出 SQL 错误`-243`。
我使用`onstat -g`.

有什么方法可以找出导致它花费这么多时间并最终出错的原因？

它使用`COMMITTED READ`隔离。

这也会导致高 Informix cpu 使用率。

**编辑**

**环境**- Solaris 上的 Informix 9.2

我没有看到任何与索引或应用程序逻辑相关的问题，但我怀疑存在一些 informix 损坏。执行此查询
时，会话在不同的表上持有 8 个锁。 但是，我在执行 的表上看不到任何锁。`DELETE`
`delete`

会不会是，informix 无法锁定表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:37:05.807

DELETE 不关心您的隔离级别。您得到 243 是因为在您尝试运行删除操作时另一个进程正在锁定表。

我会将您的删除放入 SP 并提交每条第 X 条记录：

```
CREATE PROCEDURE tmp_delete_sp (
  p_commit_records INTEGER
) 
RETURNING 
  INTEGER, 
  VARCHAR(64);

DEFINE l_current_count INTEGER;

SET LOCK MODE TO WAIT 5; -- Wait 5 seconds if another process is locking the table.

BEGIN WORK;

FOREACH WITH HOLD
  SELECT .....

  DELETE FROM table WHERE ref = ^^ Ref from above;

  LET l_current_count = l_current_count + 1;

  IF (l_current_count >= p_commit_records) THEN
     COMMIT WORK;
     BEGIN WORK;
     LET l_current_count = 0;
  END IF;

END FOREACH;

COMMIT WORK;

RETURN 0, 'Deleted records';
END PROCEDURE; 
```

那里有一些语法问题，但这对您来说是一个很好的起点。请记住，当您使用更多逻辑日志时，插入和更新会逐渐变慢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T07:31:26.800

Informix 多次不正常重启，导致 Informix 不稳定。
这是根本原因。

# javascript - 如何获取动态创建的 DropDownList 的 ID 并检查其值是否更改？

> ID：15263495
> 
> 赞同：0
> 
> 时间：2013-03-07T05:05:57.653
> 
> 标签：javascript, jquery, html

[在Steven Sanderson 的博客](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)的帮助下，我实现了一个视图，其中生成了动态数量的文本框和 DropDownList 。一切正常。但我希望直到每个下拉列表都有一个值，表单无法提交，如果没有下拉列表，我的意思是所有动态内容都被删除，那么表单不能提交。

主视图代码：

```
<div id="Part2">
 <h3><u>Services:</u></h3><br />
 <div id="EditorRows">
  <%Html.RenderPartial("_InsertServices", Model);%>
 </div>
 <div id="DontAppend">
  <%= Html.ActionLink("+ Add Another Service", "Add", null, new { id = "addItem" }) %>
  <input type="button" id="btnEdit" value="Edit" hidden="hidden"/>
  <input type="button" id="btnDone" value="Done" />
 </div>
</div> 
```

部分视图代码：

```
<div class="EditorRow">
 <% using (Html.BeginCollectionItem("services")){ %>
 <table id="table1">
  <tr>
   <td>NOS:</td>
   <td><%:Html.DropDownListFor(model=>model.Id,(SelectList)ViewData["crmServiceType"] as SelectList,"---")%></td>
   <td>Comment:</td>
   <td><%=Html.TextBoxFor(model => model.Comment, new { size = "20" })%></td>
   <td><a href="#" class="deleteRow">delete</a></td>
  </tr>
 </table>
<% } %>
</div> 
```

JavaScript：

```
$("#addItem").click(function () {
  $.ajax({
  url: this.href,
  cache: false,
  success: function (html) { $("#EditorRows").append(html); }
  });
  return false;
});
$("a.deleteRow").live("click", function () {
  $(this).parents("div.EditorRow:first").remove();
  return false;
}); 
```

[这](http://pastie.org/6409364)是生成的 HTML 源代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:11:15.377

`.live()`已弃用，`now removed in jQuery version 1.9+`因此请改用`.on()`处理程序。
不知道你为什么添加`:first`，我猜你有多个`EditorRow`div，如果是这种情况，那么你应该试试这个：

```
 $("#EditorRows").on("click", "a.deleteRow", function () {
    var selID = $(this).closest("div.EditorRow").find('select').attr('id'); //<--give you the select list id
    $(this).closest("div.EditorRow").andSelf().remove();
    return false;
 }); 
```

不知道你想要这个，但你可以通过这种方式实现：

```
$("#EditorRows").find('select').attr('id'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T05:46:51.080

如果我理解正确并且您的标记看起来像

```
<div class="EditorRow">
    <input type="hidden" value="6c2fa95a-cc3e-44d9-b460-b561276196c1" autocomplete="off" name="services.index">
    <table id="table1">
    <select>
        <option value="">Select</option>
        <option value="1">Value1</option>
        <option value="2">Value2</option>
    </select>
</div> 
```

你可以这样做

```
$(function(){
    $("#btnDone").click(function(){
        if ($("div.EditorRow").length) {
            $("div.EditorRow select").each(function(){
                if (!$(this).val()) {
                    alert("You need to choose a value before submit");
                    return false;
                }
                //do your submit
            });
        } else {
            alert("You need to add at least one service before submit.")
        }
    });
}); 
```

# tree - 仅给出中序遍历的重构树

> ID：15263497
> 
> 赞同：2
> 
> 时间：2013-03-07T05:06:04.503
> 
> 标签：tree, binary-tree, traversal, tree-traversal

如果树有任何用星号填充的空子节点，是否可以仅在按顺序遍历的情况下重建树？（但不一定是平衡的）

```
 A
     /   \
    B      F
   / \    / \
  G   *  *   * 
 / \ 
*  * 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:15:37.103

不，即使是简单的两节点树，也存在歧义。考虑输出`*A*B*`。这两棵树中的哪棵产生了该输出？

```
 B
     /   \
    A     *
   / \
  *   *

       A
     /   \
    *     B
         / \
        *   * 
```

# iphone - 如何将图像存储在 iPhone 的 sqlite 数据库中？

> ID：15263501
> 
> 赞同：1
> 
> 时间：2013-03-07T05:06:20.140
> 
> 标签：iphone, ios, objective-c, sqlite

```
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *path = [documentsDirectory stringByAppendingPathComponent:@"image.sqlite"];

    if (sqlite3_open_v2([path UTF8String], &database, SQLITE_OPEN_READWRITE, NULL) == SQLITE_OK)
    {

        if(selectStmt == nil)
        {
            const char *sql = "insert into imagetb(imagename,image) Values(?,?)";
            if(sqlite3_prepare_v2(database, sql, -1, &selectStmt, NULL) != SQLITE_OK)
                //              NSAssert1(0, @"Error while creating add statement. '%s'", sqlite3_errmsg(database));
                NSLog(@"%s",sqlite3_errmsg(database));
        }

        sqlite3_bind_text(selectStmt, 1, [@"test.png" UTF8String], -1, SQLITE_TRANSIENT);

         sqlite3_bind_blob(selectStmt, 2, [data1 bytes], [data1 length], SQLITE_TRANSIENT);

        if(SQLITE_DONE != sqlite3_step(selectStmt))
            NSLog(@"get: %s",sqlite3_errmsg(database));
        else
            NSLog(@"scan data added");

    }

    //showimage
    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];

    if (sqlite3_open([path UTF8String], &database) == SQLITE_OK)
    {
        const char *sql = "select * from imagetb";// LIMIT 0,100 ";// where status = 1 ";
        sqlite3_stmt *selectstatment;

        if (sqlite3_prepare_v2(database, sql, -1, &selectstatment, NULL) == SQLITE_OK)
        {
            while (sqlite3_step(selectstatment) == SQLITE_ROW)
            {

                NSString *getorgstrid = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstatment, 0)];
                NSLog(@"id->%@",getorgstrid);

                [getid addObject:getorgstrid];

                NSString *getorgstrname = [NSString stringWithUTF8String:(char *)sqlite3_column_text(selectstatment, 1)];
                NSLog(@"name->%@",getorgstrname);
                [getname addObject:getorgstrname];

                NSData *getorgstrimage = [[NSData alloc] initWithBytes:sqlite3_column_blob(selectstatment,2)length:sqlite3_column_bytes(selectstatment, 2)];

                [getimage addObject:getorgstrimage];

            }
        }
        sqlite3_finalize(selectstatment);

    }
    //[tblorgland reloadData];

    UIImage *image1 = [UIImage imageWithData:[getimage lastObject]];

    NSLog(@"image%@",image1);

    [getImageview setImage:image1];
    [pool release];

==============================================================================

- (NSString *) getDBPath
{
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory , NSUserDomainMask, YES);
    NSString *documentsDir = [paths objectAtIndex:0];

    return [documentsDir stringByAppendingPathComponent:@"image.sqlite"];
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    getid=[[NSMutableArray alloc]init];
    getname=[[NSMutableArray alloc]init];
    getimage=[[NSMutableArray alloc]init];

    [self downloadimage];
    [self makeDBCopyAsNeeded];
}
-(void)downloadimage
{
    NSLog(@"Downloading...");

    UIImage *image = [[UIImage alloc] initWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://0.tqn.com/d/graphicssoft/1/7/g/A/5/psptubezdotcom_003.png"]]];

    NSLog(@"%f,%f",image.size.width,image.size.height);

    NSString *docDir = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];

    NSLog(@"%@",docDir);

    NSLog(@"saving png");
    pngFilePath = [NSString stringWithFormat:@"%@/test.png",docDir];
    data1 = [NSData dataWithData:UIImagePNGRepresentation(image)];

    img=[[UIImage alloc]initWithData:data1];

    [data1 writeToFile:pngFilePath atomically:YES];

    NSLog(@"saving jpeg");
    NSString *jpegFilePath = [NSString stringWithFormat:@"%@/test.jpeg",docDir];

    NSLog(@"jpegFilePath:%@",jpegFilePath);
    data2 = [NSData dataWithData:UIImageJPEGRepresentation(image, 1.0f)];

    [data2 writeToFile:jpegFilePath atomically:YES];

    NSLog(@"saving image done");

    [image release];

}
- (void) makeDBCopyAsNeeded
{
    BOOL success;
    NSFileManager *fileManager = [NSFileManager defaultManager];
    NSError *error;
    NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
    NSString *documentsDirectory = [paths objectAtIndex:0];
    NSString *writableDBPath = [documentsDirectory stringByAppendingPathComponent:@"image.sqlite"];
    success = [fileManager fileExistsAtPath:writableDBPath];

    NSString *dbPath = [self getDBPath];
    NSLog(@"%@",dbPath);

    if (success)
    {
        NSLog(@"Database Success Created");
        return;
    }
    NSString *defaultDBPath = [[[NSBundle mainBundle] resourcePath] stringByAppendingPathComponent:@"image.sqlite"];
    success = [fileManager copyItemAtPath:defaultDBPath toPath:writableDBPath error:&error];
    if (!success)
    {
        NSLog(@"Database:->%s",sqlite3_errmsg(database));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:29:20.703

不建议将图像数据存储在 sqlite 中。但是，如果您想存储图像数据，请使用此链接

[将图像数据保存到 iphone 中的 sqlite 数据库](https://stackoverflow.com/questions/5039343/save-image-data-to-sqlite-database-in-iphone)

希望这会帮助你..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:46:39.223

只需在 -(void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)image editingInfo:(NSDictionary *)editingInfo: 中编写以下代码：如果您从画廊或相机获取图像，则跳过 if (imageData != nil 下的代码) 并且只需使用下面的代码将图像保存在 sqlite

```
NSData * imageData = UIImageJPEGRepresentation(image, 0.8);
    NSLog(@"Image data length== %d",imageData.length);

if (imageData != nil)
    {
        UIImage *resizedImg = [self scaleImage:[UIImage imageWithData:imageData] toSize:CGSizeMake(150.0f,150.0f)];

        NSData * imageData = UIImageJPEGRepresentation(resizedImg, 0.2);
        NSLog(@"*** Image data length after compression== %d",imageData.length);

        NSString *nameofimg=[NSString stringWithFormat:@"%@",resizedImg];

        NSString *substring=[nameofimg substringFromIndex:12];
        NSString *new=[substring substringToIndex:7];// Get image name

        NSArray *path=NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);

        NSString *documentdirectory=[path objectAtIndex:0];

        NSString *newFilePath = [NSString stringWithFormat:[documentdirectory stringByAppendingPathComponent: @"/%@.png"],new];

        [imageData writeToFile:newFilePath atomically:YES];

        imgpath=[[NSString alloc]initWithString:newFilePath];
        NSLog(@"doc img in img method === %@",imgpath);
    }

     databasepath=[app getDBPath]; // i have this method in delegate
        if (sqlite3_open([databasepath UTF8String], &dbAssessor) == SQLITE_OK)
        {
            NSString *selectSql = [NSString stringWithFormat:@"insert into imagetb(imagename,image) VALUES(\"%@\",\"%@\") ;",yourImgName,imgpath];

            NSLog(@"Query : %@",selectSql);

            const char *sqlStatement = [selectSql UTF8String];
            sqlite3_stmt *query_stmt;
            sqlite3_prepare(dbAssessor, sqlStatement, -1, &query_stmt, NULL);

            if(sqlite3_step(query_stmt)== SQLITE_DONE)
            {
                NSLog(@"home image updated. :)");
                app.houseImage=imgpath;
            }
            else
            {
                UIAlertView *alert = [[UIAlertView alloc]
                                      initWithTitle:@"Sorry" message:@"Failed To Save Home Image." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
                [alert show];
                [alert release];
            }
            sqlite3_finalize(query_stmt);
        }
        sqlite3_close(dbAssessor); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:58:30.197

您最好使用缓存来存储图像，并使用数据库来存储它们的名称或某些唯一 ID

# java - JScrollPane 没有出现，元素溢出

> ID：15263502
> 
> 赞同：0
> 
> 时间：2013-03-07T05:06:26.777
> 
> 标签：java, swing, jscrollpane, layout-manager, absolutelayout

现在正在处理一项任务，我实际上是在编写我的第一个 GUI。除了我的滚动条之外，一切都运行良好——添加它后不仅不会显示，而且即使在我将其注释掉之后，添加的最后一个元素（通过 .add 函数调用）也会覆盖整个 GUI。将布局设置为 null 似乎可以解决这个问题，但我不确定这是否会帮助或阻碍第一个问题。我已经浏览过 Oracle 的文档和示例，但没有看到我需要什么。这是相关代码（似乎在空间中浮动的变量 ag 是单独部分的一部分，我没有粘贴它以隔离 GUI 代码）：

```
 import java.awt.*;
    import java.awt.event.*;
    import javax.swing.*;

    public class Example
        {
        public static void main(String[] args) 
        {       

    JFrame mygui = new JFrame();
    mygui.getContentPane();
    mygui.setBounds(100, 100, 700, 500);
    mygui.setLayout(new BorderLayout()); //playing with layout here

    JLabel first = new JLabel("integer:");
    JLabel second = new JLabel("float:");
    JLabel third = new JLabel("short:");
    JLabel fourth = new JLabel("long:");
    JLabel fifth = new JLabel("byte:");
    JLabel sixth = new JLabel("double:");
    JLabel seventh = new JLabel("boolean:");
    JTextField myint = new JTextField("" + a);
    JTextField myfloat = new JTextField("" + b);
    JTextField myshort = new JTextField("" + c);
    JTextField mylong = new JTextField("" + d);
    JTextField mybyte = new JTextField("" + e);
    JTextField mydbl = new JTextField("" + f);
    JTextField mybool = new JTextField("" + g);
    JTextArea myarea = new JTextArea();
    JScrollPane scrolla = new JScrollPane(myarea);  

    first.setOpaque(true);
    first.setBounds(20, 20, 50, 20);
    second.setOpaque(true);
    second.setBounds(20, 70, 50, 20);
    third.setOpaque(true);
    third.setBounds(20, 120, 50, 20);
    fourth.setOpaque(true);
    fourth.setBounds(20, 170, 50, 20);
    fifth.setOpaque(true);
    fifth.setBounds(20, 220, 50, 20);
    sixth.setOpaque(true);
    sixth.setBounds(20, 270, 50, 20);
    seventh.setOpaque(true);
    seventh.setBounds(20, 320, 50, 20);

    myint.setBounds(70, 20, 50, 20);
    myint.setOpaque(true);
    myfloat.setBounds(70, 70, 50, 20);
    myfloat.setOpaque(true);
    myshort.setBounds(70, 120, 50, 20);
    myshort.setOpaque(true);
    mylong.setBounds(70, 170, 80, 20);
    mylong.setOpaque(true);
    mybyte.setBounds(70, 220, 50, 20);
    mybyte.setOpaque(true);
    mydbl.setBounds(70, 270, 50, 20);
    mydbl.setOpaque(true);
    mybool.setBounds(70, 320, 50, 20);
    mybool.setOpaque(true);

    myarea.setBounds(200, 50, 250, 200);
    myarea.setOpaque(true);
    scrolla.setPreferredSize(new Dimension(250, 200));

    mygui.add(first);
    mygui.add(second);
    mygui.add(third);
    mygui.add(fourth);
    mygui.add(fifth);
    mygui.add(sixth);
    mygui.add(seventh);

    mygui.add(myint);
    mygui.add(myfloat);
    mygui.add(myshort);
    mygui.add(mylong);
    mygui.add(mybyte);
    mygui.add(mydbl);
    mygui.add(mybool);
    mygui.add(scrolla);

    myarea.append("" + errcheck + "\n");
    myarea.append("" + valcheck + "\n");

    while(y < 2)
    {
    myarea.append("" + a + "\n");
    myarea.append("" + b + "\n");
    myarea.append("" + c + "\n");
    myarea.append("" + d + "\n");
    myarea.append("" + e + "\n");
    myarea.append("" + f + "\n");
    myarea.append("" + g + "\n");
    myarea.append("" + w + "\n");
    myarea.append("" + u + "\n");
    myarea.append("" + v + "\n");
    myarea.append("" + secondary + "\n");
    myarea.append("" + whilecount + "\n");;
    y++;
    a--;
    }

    mygui.setVisible(true);
    mygui.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }
 } 
```

我敢肯定这很简单，但感谢任何反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:18:37.117

`BorderLayout`有五个定义的位置可以添加组件...

![在此处输入图像描述](../Images/39435c13529aa0c3f43c5ef76092163a.png)

默认位置是`CENTER`。

基本上发生了什么，当您将每个组件添加到框架/内容窗格时，它会删除最后一个并将其放置在中间，因为在给定位置中只能存在一个组件。

首先更改布局管理器。查看[A Visual Guide to Layout Managers](http://docs.oracle.com/javase/tutorial/uiswing/layout/visual.html)了解一些想法

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T05:59:40.840

使用 BorderLayout 时 setBounds() 方法没有任何效果。使用 BorderLayout，
您只能将组件固定在五个位置**North、South、East、West 和 Center**
如果您不指定位置 like `add(comp, BorderLayout.EAST)`，它将
随机渲染您的组件。添加更多组件而不指定位置将重叠，并且不会提供清晰的视图。

您使用了五个以上的组件并且您没有指定位置，因此滚动窗格
不会出现。

使用 GridBagLayout 产生正确的结果。参考[http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-07T05:18:33.187

删除这一行：

```
mygui.getContentPane(); 
```

因为它没有事情。还有，改变

```
mygui.setLayout(new BorderLayout()); //playing with layout here 
```

到

```
mygui.getContentPane ().setLayout (null); // playing with layout here 
```

因为您想自己为所有组件指定边界。也改变

```
myarea.setBounds(200, 50, 250, 200); 
```

到

```
scrolla.setBounds(200, 50, 250, 200); 
```

并删除以下行：

```
scrolla.setPreferredSize(new Dimension(250, 200)); 
```

因为没有布局管理器，您不需要首选尺寸。也改变

```
mygui.add(first);
mygui.add(second);
mygui.add(third);
mygui.add(fourth);
mygui.add(fifth);
mygui.add(sixth);
mygui.add(seventh);

mygui.add(myint);
mygui.add(myfloat);
mygui.add(myshort);
mygui.add(mylong);
mygui.add(mybyte);
mygui.add(mydbl);
mygui.add(mybool);
mygui.add(scrolla); 
```

到

```
mygui.getContentPane ().add(first);
mygui.getContentPane ().add(second);
mygui.getContentPane ().add(third);
mygui.getContentPane ().add(fourth);
mygui.getContentPane ().add(fifth);
mygui.getContentPane ().add(sixth);
mygui.getContentPane ().add(seventh);

mygui.getContentPane ().add(myint);
mygui.getContentPane ().add(myfloat);
mygui.getContentPane ().add(myshort);
mygui.getContentPane ().add(mylong);
mygui.getContentPane ().add(mybyte);
mygui.getContentPane ().add(mydbl);
mygui.getContentPane ().add(mybool);
mygui.getContentPane ().add(scrolla); 
```

因为组件不应直接添加到 JFrame，而只能添加到其内容窗格。在这些更改之后，它应该可以正常工作。一旦您的文本区域中有足够的文本，您将看到滚动条。这是适用于我的代码的固定版本：

```
import java.awt.Color;
import java.awt.Dimension;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;

public class Example
{
    public static void main (String [] args)
    {

        JFrame mygui = new JFrame ();
        mygui.getContentPane ();
        mygui.setBounds (100, 100, 700, 500);
        mygui.getContentPane ().setLayout (null); // playing with layout here

        JLabel first = new JLabel ("integer:");
        JLabel second = new JLabel ("float:");
        JLabel third = new JLabel ("short:");
        JLabel fourth = new JLabel ("long:");
        JLabel fifth = new JLabel ("byte:");
        JLabel sixth = new JLabel ("double:");
        JLabel seventh = new JLabel ("boolean:");
        JTextField myint = new JTextField ("a");
        JTextField myfloat = new JTextField ("b");
        JTextField myshort = new JTextField ("c");
        JTextField mylong = new JTextField ("d");
        JTextField mybyte = new JTextField ("e");
        JTextField mydbl = new JTextField ("f");
        JTextField mybool = new JTextField ("g");
        JTextArea myarea = new JTextArea ();
        JScrollPane scrolla = new JScrollPane (myarea);

        first.setOpaque (true);
        first.setBounds (20, 20, 50, 20);
        second.setOpaque (true);
        second.setBounds (20, 70, 50, 20);
        third.setOpaque (true);
        third.setBounds (20, 120, 50, 20);
        fourth.setOpaque (true);
        fourth.setBounds (20, 170, 50, 20);
        fifth.setOpaque (true);
        fifth.setBounds (20, 220, 50, 20);
        sixth.setOpaque (true);
        sixth.setBounds (20, 270, 50, 20);
        seventh.setOpaque (true);
        seventh.setBounds (20, 320, 50, 20);

        myint.setBounds (70, 20, 50, 20);
        myint.setOpaque (true);
        myfloat.setBounds (70, 70, 50, 20);
        myfloat.setOpaque (true);
        myshort.setBounds (70, 120, 50, 20);
        myshort.setOpaque (true);
        mylong.setBounds (70, 170, 80, 20);
        mylong.setOpaque (true);
        mybyte.setBounds (70, 220, 50, 20);
        mybyte.setOpaque (true);
        mydbl.setBounds (70, 270, 50, 20);
        mydbl.setOpaque (true);
        mybool.setBounds (70, 320, 50, 20);
        mybool.setOpaque (true);

        myarea.setOpaque (true);
        myarea.setBackground (Color.yellow);
        scrolla.setBounds (200, 50, 250, 200);
        scrolla.setPreferredSize (new Dimension (250, 200));

        mygui.getContentPane ().add (first);
        mygui.getContentPane ().add (second);
        mygui.getContentPane ().add (third);
        mygui.getContentPane ().add (fourth);
        mygui.getContentPane ().add (fifth);
        mygui.getContentPane ().add (sixth);
        mygui.getContentPane ().add (seventh);

        mygui.getContentPane ().add (myint);
        mygui.getContentPane ().add (myfloat);
        mygui.getContentPane ().add (myshort);
        mygui.getContentPane ().add (mylong);
        mygui.getContentPane ().add (mybyte);
        mygui.getContentPane ().add (mydbl);
        mygui.getContentPane ().add (mybool);
        mygui.getContentPane ().add (scrolla);

        myarea.append ("sdfgsdfgsdfgsf\n");

        mygui.setVisible (true);
        mygui.setDefaultCloseOperation (JFrame.EXIT_ON_CLOSE);
    }
} 
```

# networking - 在 Radius 服务器上配置 jradius 时遇到问题

> ID：15263506
> 
> 赞同：0
> 
> 时间：2013-03-07T05:06:51.450
> 
> 标签：networking, radius

我已经在我的 ubuntu 12.04 上安装并配置了免费半径。现在我想用 jradius 服务器配置我的 freeradius。我从这里的 coova 文档中关注

[http://www.coova.org/JRadius/FreeRADIUS](http://www.coova.org/JRadius/FreeRADIUS)

该步骤说明我必须在 etc/freeradius/radiusd.conf 和 /etc/freeradius/sites-enabled/default 上添加一些配置。

现在，当我尝试运行我的半径服务器时，我收到如下错误消息：

```
Thu Mar  7 11:56:26 2013 : Debug: server { # from file /etc/freeradius/radiusd.conf
Thu Mar  7 11:56:26 2013 : Debug:  modules {
Thu Mar  7 11:56:26 2013 : Debug:  Module: Checking authenticate {...} for more modules to load
Thu Mar  7 11:56:26 2013 : Debug:     (Loaded rlm_digest, checking if it's valid)
Thu Mar  7 11:56:26 2013 : Debug:  Module: Linked to module rlm_digest
Thu Mar  7 11:56:26 2013 : Debug:  Module: Instantiating module "digest" from file /etc/freeradius/modules/digest
Thu Mar  7 11:56:26 2013 : Debug:  Module: Checking authorize {...} for more modules to load
Thu Mar  7 11:56:26 2013 : Debug:     (Loaded rlm_preprocess, checking if it's valid)
Thu Mar  7 11:56:26 2013 : Debug:  Module: Linked to module rlm_preprocess
Thu Mar  7 11:56:26 2013 : Debug:  Module: Instantiating module "preprocess" from file /etc/freeradius/modules/preprocess
Thu Mar  7 11:56:26 2013 : Debug:   preprocess {
Thu Mar  7 11:56:26 2013 : Debug:   huntgroups = "/etc/freeradius/huntgroups"
Thu Mar  7 11:56:26 2013 : Debug:   hints = "/etc/freeradius/hints"
Thu Mar  7 11:56:26 2013 : Debug:   with_ascend_hack = no
Thu Mar  7 11:56:26 2013 : Debug:   ascend_channels_per_line = 23
Thu Mar  7 11:56:26 2013 : Debug:   with_ntdomain_hack = no
Thu Mar  7 11:56:26 2013 : Debug:   with_specialix_jetstream_hack = no
Thu Mar  7 11:56:26 2013 : Debug:   with_cisco_vsa_hack = no
Thu Mar  7 11:56:26 2013 : Debug:   with_alvarion_vsa_hack = no
Thu Mar  7 11:56:26 2013 : Debug:   }
Thu Mar  7 11:56:26 2013 : Error: /etc/freeradius/radiusd.conf[644]: Failed to link to module 'rlm_jradius': file not found 
Thu Mar  7 11:56:26 2013 : Error: /etc/freeradius/sites-enabled/default[71]: Failed to load module "jradius".
Thu Mar  7 11:56:26 2013 : Error: /etc/freeradius/sites-enabled/default[62]: Errors parsing authorize section. 
```

我应该怎么做才能解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T08:23:48.357

1.  检查是否在安装 FreeRADIUS 时使用参数“--with-rlm_jradius”进行编译。

2.  检查是否在 radiusd.conf 的实例化部分中实例化 jradius

3.  检查是否在您的 radiusd.cong 或另一个 .conf 文件中设置好您的 jradius 配置。

当您在安装它们时遇到麻烦时，这些是最常见的因素。

奥基斯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T20:39:12.010

rlm_jradius 尚未标记为稳定，因此在 v2.xx 分支的标准 debian 软件包中不可用。

[https://github.com/FreeRADIUS/freeradius-server/blob/v2.xx/src/modules/stable](https://github.com/FreeRADIUS/freeradius-server/blob/v2.x.x/src/modules/stable)

您将需要从源代码构建模块。将 git checkout 行替换为您正在使用的服务器版本。

```
git clone git@github.com:FreeRADIUS/freeradius-server.git
git checkout release_2_2_0
./configure --with-rlm_jradius
cd src/modules/rlm_jradius
make
cp -r .libs/rlm_jradius*.so /usr/lib/freeradius/
cp jradius.conf /etc/freeradius/modules/ 
```

请注意，rlm_jradius 目前在 FreeRADIUS 版本 3.0 中不可用，并且 v2.2.x 分支很快将被弃用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-27T17:57:22.157

如果其他人遇到此线程，JRadius 支持包含在 Ubuntu 12.10 - Ubuntu 16 的 freeradius 包中。它在 Ubuntu 17 中被删除，因为它们更新到 FreeRADIUS 版本 3，并且 JRadius 支持未移植到版本 3。

[https://packages.ubuntu.com/search?keywords=freeradius](https://packages.ubuntu.com/search?keywords=freeradius)

# java - 另一个类中的 JApplet 维度

> ID：15263509
> 
> 赞同：1
> 
> 时间：2013-03-07T05:07:10.997
> 
> 标签：java, swing, size, japplet

我有一个名为的普通 JApplet 类`game.java`，还有另一个名为`room.java`. `room.java`有一个`draw()`方法，但它需要使用`getWidth()`and `getHeight()`from the ，`game.java`以便`paint()`在用户调整窗口大小时它可以在每个上调整自己的大小。我知道我可以创建方法并将其传递给`room.java`但我想知道是否有另一种方法`room.java`可以访问 JApplets 的高度和宽度。

# perl - 为哈希中的键值创建一个数组（Perl）

> ID：15263514
> 
> 赞同：1
> 
> 时间：2013-03-07T05:07:34.133
> 
> 标签：perl, hash

我在 Perl 中遇到了一个很小的困难。

我正在阅读一个文本文件，其中包含一些信息。当我阅读文本文件时，我从文本中选择了一些键；当我进一步阅读时，我希望为键保存一组值。

参见例如

```
Alpha 1

Something: 2132
Something: 2134

Alpha 2

Something: 2132
Something: 2134 
```

我将文件读入一个名为行的数组中：

```
my $h;
my $alpha;
for my $line (@lines){
    if ($line =~ m/Alpha (\d+)/){
        $alpha = $1;
        $h->{$alpha} = (); # create empty array for key?
    }
    elsif ($line =~ m/Something: (\d+)/){
        push($h->{$alpha}, $1);
    }
} 
```

显然，它给了我一个错误：

```
Type of arg 1 to push must be array (not hash element) at test.pl line 28, near "$1)"
Execution of test.pl aborted due to compilation errors. 
```

无法弄清楚这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T05:20:23.060

哈希键值只能包含一个标量。如果要存储数组，则需要进行数组引用。

你可以这样做：

```
for my $line (@lines){
    if ($line =~ m/Alpha (\d+)/){
        $alpha = $1;
        $h->{$alpha} = []; # create empty array refernece for key
    }
    elsif ($line =~ m/Something: (\d+)/){
        push( @{$h->{$alpha}}, $1);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T05:21:23.793

您需要进行两项更改：

```
 $h->{$alpha} = [];
                   ** - Create an anonymous array and store 
                        a ref to it in the hash 
```

和

```
 push(@{$h->{$alpha}}, $1); 
```

因为`push`需要一个实际的数组，并且您有一个数组引用。@{...} 包装器将 arrayref 取消引用到实际数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T06:04:35.380

正如前面的答案所说，它们是正确的。但并不完美。`$alpha`可能会留下来`undef`。因此，为了避免它，请添加一个`check`.

```
my $alpha;
for my $line (@lines){
    if ($line =~ m/Alpha (\d+)/){
        $alpha = $1;
        $h->{$alpha} = []; # create empty array refernece for key
    }
    elsif ($line =~ m/Something: (\d+)/){
        if(defined $apha) { ## Check
           push( @{$h->{$alpha}}, $1);
        }
    }
} 
```

# android - 数组列表微调器中的 indexoutofboundsexception

> ID：15263520
> 
> 赞同：0
> 
> 时间：2013-03-07T05:08:03.820
> 
> 标签：android, android-spinner

我有一个 4 值的微调器

![在此处输入图像描述](../Images/24ca19c2a39e4bb37fdfa924aaf4bd4f.png)

这是完整的代码

```
public class MainUpdate extends Activity implements LocationListener{

        Spinner fromList;
        Spinner toList;
        ArrayAdapter<String> dataAdapter;
    // membuat combobox manual manufaktur
        //TextView selection;
        private LocationManager locman;
         public static final int DIALOG_DATE = 5;

        //String[] petak = { "Petak 1", "Petak 2", "Petak 3", "Petak 4" };

        private Uri outputFileUri;
        File outputFile;
        Intent intent = null;
        CDBPetak cDBPetak=null;
        TextView tvStatus=null;
        Spinner spinPetak;
        private String sDirectory="";
        //GPS Value---
        private double dLat=0;
        private double dLon=0;

        private  static final boolean TEST_ONLY_NO_FOTO=false;
        private  static final boolean TAKE_FOTO_HIRES=false;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.ptk_main_update);

        this.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);

        toList = (Spinner) findViewById(R.id.namapetak);
          dataAdapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_spinner_item, new ArrayList<String>());
          dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
          toList.setAdapter(dataAdapter);
          dataAdapter.add("Petak 1");
          dataAdapter.add("Petak 2");
          dataAdapter.add("Petak 3");
          dataAdapter.add("Petak 4");

        Button button = (Button) findViewById(R.id.btnPupukQuit);
        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                // Perform action on click
                LogOut();
                setResult(RESULT_OK, null);
                finish();
            }
        });

        locman = (LocationManager) getSystemService(LOCATION_SERVICE);

        /*View showDlg = findViewById(R.id.jenis);
        showDlg.setOnClickListener(new View.OnClickListener(){
         public void onClick(View v) {
             // Perform action on click
            showDialog(DIALOG_DATE);
         }
        });*/

        tvStatus= (TextView) findViewById(R.id.txtStatus);

        if (CGeneral.nPetakTetap==CGeneral.ACTIVITY_FOR_PETAK) {
            //txt.setText(CGeneral.STRING_LAYOUT_HEADER_PUPUK);
            sDirectory=CGeneral.STRING_DIRECTORY_PETAK;
            cDBPetak=new CDBPetak(this,CGeneral.STRING_DBASE_PETAK,CGeneral.INT_DBASE_VERSION_PETAK);
        }

        button = (Button) findViewById(R.id.btnPetakFoto);
        button.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                // Perform action on click

                TakeFoto();

            EditText hapus1=(EditText) findViewById(R.id.jenisHama);
            hapus1.setText("");
            EditText hapus2=(EditText) findViewById(R.id.jmlhHama);
            hapus2.setText("");
            EditText hapus3=(EditText) findViewById(R.id.jnsMusuh);
            hapus3.setText("");
            EditText hapus4=(EditText) findViewById(R.id.jmlhMusuh);
            hapus4.setText("");
            EditText hapus5=(EditText) findViewById(R.id.intenTetap);
            hapus5.setText("");
            EditText hapus6=(EditText) findViewById(R.id.luasTerancam);
            hapus6.setText("");

            }
        });

    }//onCreate

    private void TakeFoto(){
        Date dt=new Date();
        long lt=dt.getTime(); lt=lt/10;
        String fname=String.format("%d.jpg", lt);
        File path = Environment.getExternalStoragePublicDirectory(sDirectory);
        path.mkdirs();
        outputFile = new File(path,fname);
        outputFileUri = Uri.fromFile(outputFile);
        if (TEST_ONLY_NO_FOTO) {
            SaveData();
        }
        else{
            if (TAKE_FOTO_HIRES){
                saveFullImage();
            }
            else{
                getThumbailPicture();
            }
        }
        TextView txt = (TextView) findViewById(R.id.txtStatus);
        txt.setText(fname);
    }//TakeFoto

private void LogOut(){

    }//LogOut

private void getThumbailPicture() {
    if (TEST_ONLY_NO_FOTO) return;
    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);

    startActivityForResult(intent, CGeneral.SHOW_SUB_ACTIVITY_TAKE_PICTURE);
}//getThumbailPicture

private void saveFullImage() {
    if (TEST_ONLY_NO_FOTO) return;
    Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
    intent.putExtra(MediaStore.EXTRA_OUTPUT, outputFileUri);
    startActivityForResult(intent, CGeneral.SHOW_SUB_ACTIVITY_TAKE_PICTURE);
}//saveFullImage

@Override
protected void onDestroy() {
    stopListening();
    super.onDestroy();
}

@Override
protected void onPause() {
    stopListening();
    super.onPause();
}

@Override
protected void onResume() {
    startListening();
    super.onResume();
}

private void startListening() {
    locman.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, this);
}

private void stopListening() {
    if (locman != null) {
        locman.removeUpdates(this);
    }
}
@Override
public void onLocationChanged(Location location) {
    // TODO Auto-generated method stub
    boolean flag=ValidLocation(location);
}//onLocationChanged

@Override
public void onProviderDisabled(String provider) {
    // TODO Auto-generated method stub

}//onProviderDisabled

@Override
public void onProviderEnabled(String provider) {
    // TODO Auto-generated method stub

}//onProviderEnabled

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub

}//onStatusChanged

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    super.onCreateOptionsMenu(menu);
    //menu.add(0, CGeneral.MENUID_SEND_PETAK, 0, R.string.mnuSend);
    //menu.add(0, CGeneral.MENUID_OPTION, 0, R.string.mnuOption);
    menu.add(0, CGeneral.MENUID_VIEW_PETAK, 0, R.string.mnuView);

    return true;
}//onCreateOptionsMenu

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    Intent intent=null;
    final TextView tview = (TextView) findViewById(R.id.txtStatus);      
    Resources res=getResources(); 
    switch (item.getItemId()) {

    //case CGeneral.MENUID_SEND:

        //return true;
    case CGeneral.MENUID_OPTION:
        /*CPupukRecord rec=new CPupukRecord();
        for (int i=0; i<recordCount; i++){
            rec.sFilename=cursorSend.getString(4);
        UserFunctions userFunction = new UserFunctions();
        Log.d("Button", "Login");
        JSONObject json = userFunction.sendUser(rec.sFilename);
        }*/
    case CGeneral.MENUID_VIEW_PETAK:
        intent = new Intent(MainUpdate.this, CPetakView.class);
        startActivityForResult(intent, CGeneral.SHOW_SUB_ACTIVITY_VIEW_PETAK);
        tview.setText("menuItem : "+res.getString(R.string.mnuView));
        return true;
    }
    return super.onOptionsItemSelected(item);
}//onOptionsItemSelected(MenuItem item

private boolean ValidLocation(Location location)
{
    dLat=location.getLatitude();
    dLon=location.getLongitude();

    String slat="";
    String slon="";
    String sacc="";
    String sspd="";
    slat=String.format("%+5.12f", dLat);
    slon=String.format("%+5.12f", dLon);
    TextView txt;
    //Menampilkan Latitude longitude
    txt = (TextView) findViewById(R.id.edtLatitude);
    txt.setText(slat);
    txt = (TextView) findViewById(R.id.edtLongitude);
    txt.setText(slon);
    //txt = (TextView) findViewById(R.id.edtPupukAccuracy);
    //txt.setText(sacc);
    //txt = (TextView) findViewById(R.id.edtPupukSpeed);
    //txt.setText(sspd);

    if (CGeneral.TEST_ONLY_NO_LOCATION_VALIDATION) return true;

    return true; 
}//ValidLocation

private void SaveData(){

    View textJnsHama = (EditText) findViewById(R.id.jenisHama);
    View textJmlHama = (EditText) findViewById(R.id.jmlhHama);
    View textJnsMusuh = (EditText) findViewById(R.id.jnsMusuh);
    View textJmlMusuh = (EditText) findViewById(R.id.jmlhMusuh);
    View textIntens = (EditText) findViewById(R.id.intenTetap);
    View textLuasInten = (EditText) findViewById(R.id.luasTerancam);
    //View editText8 = (EditText) findViewById(R.id.txtManufaktur);
    View spinner1 = (Spinner) findViewById(R.id.namapetak);
    //manufakturButton.setText(stringBuilder.toString());
    String jnsHama=((TextView) textJnsHama).getText().toString();
    String jmlHama=((TextView) textJmlHama).getText().toString();
    String jnsMusuh=((TextView) textJnsMusuh).getText().toString();
    String jmlMusuh=((TextView) textJmlMusuh).getText().toString();
    String intens=((TextView) textIntens).getText().toString();
    String luasInten=((TextView) textLuasInten).getText().toString();
    String spinnerPetak=((Spinner) spinner1).getSelectedItem().toString();

    CPetakRecord rec=new CPetakRecord();
    Date dt=new Date();
    rec.jenisHm=jnsHama;
    rec.jumlahHm=jmlHama;
    rec.jenisMsh=jnsMusuh;
    //rec.lblKomoditas=spinnerKmdLabel;
    rec.jumlahMsh=jmlMusuh;
    rec.intensitas=intens;
    rec.luasTerancam=luasInten;
    //rec.lblHama=spinnerHamaLabel;
    rec.nmPetak=spinnerPetak;
    rec.dLatitude=dLat;
    rec.dLongitude=dLon;
    rec.sFilename=outputFile.toString();
//  rec.sFilename=outputFileUri.toString();
    rec.lDate=dt.getTime();
    rec.sSent="Not Sent";
    cDBPetak.insertEntry(rec);

}//SaveData

@Override
public void onBackPressed() {
}

@Override
public void onAttachedToWindow() {
    this.getWindow().setType(WindowManager.LayoutParams.TYPE_KEYGUARD);
    super.onAttachedToWindow();
}

@Override
public void onActivityResult(int requestCode,int resultCode,Intent data) {
    String str="";

    super.onActivityResult(requestCode, resultCode, data);
    switch(requestCode) {
    case (CGeneral.SHOW_SUB_ACTIVITY_LOGIN) :
        if (resultCode == Activity.RESULT_OK) {
            //+isLogin=true;
            tvStatus.setText("Login Ok - userId : "+CGeneral.strUserID);
        }
        if (resultCode == Activity.RESULT_CANCELED) {
            setResult(RESULT_CANCELED, null);
            finish();
        }
        break;
    case (CGeneral.SHOW_SUB_ACTIVITY_VIEW) :
        break;
    case (CGeneral.SHOW_SUB_ACTIVITY_TAKE_PICTURE) :

        if (resultCode == Activity.RESULT_OK) {
            str="Camera Result : Ok";

            String myData = toList.getSelectedItem().toString();
              int position = dataAdapter.getPosition(myData);

               if(position >= 0){
                dataAdapter.remove(myData);
                dataAdapter.notifyDataSetChanged();
               }
               else {
                Toast.makeText(getBaseContext(), myData + " not in Spinner", Toast.LENGTH_LONG).show();
               }

            View b = findViewById(R.id.btnPupukQuit);
            b.setVisibility(View.GONE);
            onBackPressed();
            onAttachedToWindow();

            if (!CGeneral.TEST_ONLY_NO_LOCATION_VALIDATION){
                EnableFoto(false); // foto has been taken,disable it until new location

            }
            // Check if the result includes a thumbnail Bitmap
            if (data != null) {
                str=str+" A";
                if (data.hasExtra("data")) {
                    Bitmap thumbnail = data.getParcelableExtra("data");
//                  ImageView img;
//                  img=(ImageView)findViewById(R.id.imgView); 
//                  img.setImageBitmap(thumbnail);

                    str=str+" B";
                    try {
                        str=str+" B1";
                        String fname=outputFile.toString();
                        str=str+" fname:"+fname;
                        FileOutputStream fos=new FileOutputStream(outputFile);

                        thumbnail.compress(Bitmap.CompressFormat.PNG, 90, fos);
                        SaveData();
                        str=str+" B2";

                    } catch (IOException e) {
                        // TODO Auto-generated catch block
                        str=str+" B3";
                        e.printStackTrace();
                    } 

                }
            }
            else {
                str=str+" C";
                // TODO Do something with the full image stored
                // in outputFileUri
                SaveData();
            }
            str=str+" D";
        }
        if (resultCode == Activity.RESULT_CANCELED) {
            str="Camera Result : Canceled";
        }
        tvStatus.setText(str);
        break;
    }       
}//onActivityResult

public void EnableFoto(boolean flag){
    Button button = (Button) findViewById(R.id.btnPetakFoto);
    if (flag){
        button.setVisibility(View.VISIBLE);
    }
    else {//if (ValidLocation(location))
        button.setVisibility(View.INVISIBLE);
    }//if (ValidLocation(location))
}

} 
```

当我在微调器中选择最后一项“Petak 4”并使用按钮删除该项目时，

此代码在 onClick 按钮方法内工作，带有开关盒。

但是当我将代码放入 onActivityResult 时，应用程序被强制关闭

```
String myData = toList.getSelectedItem().toString();
              int position = dataAdapter.getPosition(myData);

               if(position >= 0){
                dataAdapter.remove(myData);
                dataAdapter.notifyDataSetChanged();
               }
               else {
                Toast.makeText(getBaseContext(), myData + " not in Spinner", Toast.LENGTH_LONG).show();
               }

            View b = findViewById(R.id.btnPupukQuit);
            b.setVisibility(View.GONE);
            onBackPressed();
            onAttachedToWindow(); 
```

这是我的日志猫

```
03-07 12:03:30.156: ERROR/AndroidRuntime(7543): FATAL EXCEPTION: main
03-07 12:03:30.156: ERROR/AndroidRuntime(7543): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=5, result=-1, data=Intent { act=inline-data (has extras) }} to activity {hariff.ltis.mainmenu/hariff.ltis.petaktetap.MainUpdate}: java.lang.IndexOutOfBoundsException: Invalid index 3, size is 3
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.app.ActivityThread.deliverResults(ActivityThread.java:2532)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.app.ActivityThread.handleSendResult(ActivityThread.java:2574)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.app.ActivityThread.access$2000(ActivityThread.java:117)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:961)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.os.Looper.loop(Looper.java:130)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.app.ActivityThread.main(ActivityThread.java:3683)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at java.lang.reflect.Method.invokeNative(Native Method)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at java.lang.reflect.Method.invoke(Method.java:507)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at dalvik.system.NativeStart.main(Native Method)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543): Caused by: java.lang.IndexOutOfBoundsException: Invalid index 3, size is 3
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:257)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at java.util.ArrayList.get(ArrayList.java:311)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.widget.ArrayAdapter.getItem(ArrayAdapter.java:298)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.widget.AdapterView.getSelectedItem(AdapterView.java:552)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at hariff.ltis.petaktetap.MainUpdate.SaveData(MainUpdate.java:344)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at hariff.ltis.petaktetap.MainUpdate.onActivityResult(MainUpdate.java:481)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.app.Activity.dispatchActivityResult(Activity.java:3908)
03-07 12:03:30.156: ERROR/AndroidRuntime(7543):     at android.app.ActivityThread.deliverResults(ActivityThread.java:2528) 
```

如何修复错误`indexoutofboundsexception`？

它是关于 ArrayList 的吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:23:52.310

您正在调用`dataAdapter.remove()`而不更改微调器中选定的索引。然后`spinner1.getSelectedItem()`在您的`SaveData()`函数中调用，导致`IndexOutOfBoundsException`.

解决方案？将所选索引设置为从适配器中删除项目后仍然存在的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T05:24:22.197

如果您想获得 Spinner 选择的项目位置，那么只需使用

```
spinner.getSelectedItemPosition() which gives integer value.. 
```

为什么要使用

```
String myData = toList.getSelectedItem().toString();
int position = dataAdapter.getPosition(myData); // I think the problem is here 
```

可以直接初始化

```
int position = toList.getSelectedItemPosition(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:21:42.267

是的，它`ArrayList`与您的代码中的一个有关。在某些时候，您`dataAdapter`拥有 size `3`，并且您试图访问 index 处的元素`3`，这是 throwing `IndexOutOfBoundsException`。永远记住，如果你的大小`ArrayList`是`x`，你只能访问到 index `x-1`。

**例如：**如果大小为`4`，则

`list.get(3)`-**允许**

`list.get(4)`-**不允许**

# java - 如何在运行时从文件夹加载 jar 文件并在 JBoss EAP 6.0.1 中实例化类

> ID：15263522
> 
> 赞同：1
> 
> 时间：2013-03-07T05:08:10.153
> 
> 标签：java, jakarta-ee, reflection, jboss, classloader

我有两个 jar 文件。第一个仅包含接口，第二个包含所有实现类。我已经在我的应用程序的 ear 文件中包含了第一个 jar，因此在部署我的应用程序时会加载它的类。

根据请求，我尝试在运行时使用 URLClassLoader 从某个文件夹中存在的 .jar 文件加载我的实现类。

这些类正在加载并使用反射我正在创建类的实例，但是在将该实例转换为我包含在 .ear 文件中的 jar 文件中存在的接口时，我的接口类得到了 NoClassDefFoundError。

我确信这是由于我使用不同的类加载器来加载类，但是我如何克服类之间的兼容性问题。

相同的代码在正常的 J2SE 环境中工作，但在 JBoss 骆驼上下文中不工作。

如果我的查询不清楚，请告诉我我也可以粘贴源代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T07:24:15.390

您的方法应该适用于 JBossEAP 6，这就是我在 JBossAS7.1 上所做的。

```
class YourClassLoader extends URLClassLoader {
    ...
    public YourClassLoader() {
       this(YourClassLoader.class.getClassLoader());
       ...
       this.addURL(jarfile.toURI().toURL());
       ...
    }
    ...
}

Class<?> yourClass = yourClassLoader.loadClass(className);
YourClassInterface yourClassInterface = null;
yourClassInterface = (YourClassInterface ) yourClass.newInstance(); 
```

请尝试通过同一个 URLClassLoader 加载接口 jar。

# windows - 用于解除阻止从 Internet 复制的文件的批处理文件

> ID：15263523
> 
> 赞同：15
> 
> 时间：2013-03-07T05:08:10.527
> 
> 标签：windows, windows-7, batch-file

当我们从 Internet 复制文件 (dll) 时，Win7 会阻止它。当我们获取文件属性时，取消阻止选项如下图所示。我可以使用什么命令从批处理文件中取消阻止文件？

![在此处输入图像描述](../Images/abbc462096f182793200e18174aa0c9e.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-07T05:34:35.463

据说这应该有效：

```
echo.>myDownloadedFile.exe:Zone.Identifier 
```

在此处查看更详细的讨论，[使用 PowerShell 取消阻止文件？](https://stackoverflow.com/questions/1617509/unblock-a-file-with-powershell)，其中还描述了使用 Powershell 和`streams`SysInternals 工具的其他方法。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2016-07-22T03:47:51.660

做一个是根据其他建议。即：

```
echo.>myDownloadedFile.dll:Zone.Identifier 
```

或者

```
Unblock-File myDownloadedFile.dll 
```

但要按照 OP 的要求“批量”执行：

```
get-childitem *.jpg, *.gif | Unblock-File 
```

或在 DOS 中：

```
FOR %a in (*.jpg *.gif) do (echo.>%a:Zone.Identifier) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T05:33:06.650

您可以使用流 -d path/to/file.zip 这可以在这里找到[http://technet.microsoft.com/en-us/sysinternals/bb897440](http://technet.microsoft.com/en-us/sysinternals/bb897440)

# shell - 在 shell 脚本中带有双引号的转义字符在转义字符中带有双引号

> ID：15263524
> 
> 赞同：0
> 
> 时间：2013-03-07T05:08:11.960
> 
> 标签：shell

我已经创建了一个这样的 shell 脚本，但是在 grant 命令中出现语法错误。请问有人可以帮我吗？

```
ssh -t qbadmin@10.3.2.0 '
 su root -c "
   echo \"Give db name :\";
   read db_name;
   echo \"Give password :\";
   read db_pass;
   host=localhost;
   sql1=\"create database \$db_name;\";
   sql2=\"grant all on \${db_name}.* to \${db_name}@\${host} identified by \"\${db_pass}\";\";
   sql3=\"\${sql1}\${sql2}\";
   echo \"==============\";
   mysql -u root -p -e \"\${sql3}\";
 ";
' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T03:17:38.050

我找到了解决方案。

通过在授权命令中放置`"\\\""`之前和之后，我解决了这个问题。`\${db_pass}`grant 命令运行良好，没有任何语法错误！

感谢大家的支持。

```
ssh -t qbadmin@10.3.2.0 '
 su root -c "
   echo \"Give db name :\";
   read db_name;
   echo \"Give password :\";
   read db_pass;
   host=localhost;
   sql1=\"create database \$db_name;\";
   sql2=\"grant all on \${db_name}.* to \${db_name}@\${host} identified by "\\\""\${db_pass}"\\\"";\";
   sql3=\"\${sql1}\${sql2}\";
   echo \"==============\";
   mysql -u root -p -e \"\${sql3}\";
 ";
' 
```

# java - 修剪（）不工作

> ID：15263527
> 
> 赞同：-3
> 
> 时间：2013-03-07T05:08:24.157
> 
> 标签：java, trim

```
while(rs.next()) {              
    value = rs.getString(1).trim().split(",");
    mineral.addAll(Arrays.asList(value));
} 
```

这里的值`rs.getString(1)`如下所示。

> “次元石，坎卡尔，河沙，”

`trim()`使用和`split`使用修剪此值`split(",")`并将其分配给数组`value`。这里我的问题是`trim()`不要修剪 `String`.

任何人都可以提出原因并解决我的问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T05:09:58.480

该`trim`函数不会删除句内空格，它只会删除*字符串两端*的空白字符。如果要修剪所有字符串，则需要为每个字符串调用该函数。

```
String[] values = rs.getString(1).split(",");
for(String value : values) {
    mineral.add(value.trim());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:14:10.100

尝试像这样拆分字符串

```
value = rs.getString(1).trim().split(" *, *"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:15:55.653

trim() 只会删除前导和尾随空格，而不是字符串中的空格。你想去除“次元石”之间的空间吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T05:28:34.123

你有两个选项可以做到这一点，如果你想使用[trim()](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#trim%28%29)那么你可以使用**Perception**答案或者你可以使用`replace(""," ")`

例如使用`replace(" ","")`

```
 String[] values = rs.getString(1).replace(" ", "").split(","); 
```

# c++ - 无法在 RichEdit 中保留换行符

> ID：15263528
> 
> 赞同：0
> 
> 时间：2013-03-07T05:08:30.713
> 
> 标签：c++, winapi, richedit

我在保存字符串中的 RichEdit 控件的新闻时遇到问题。我正在做的是：

1.  从 RichEdit 控件获取文本
2.  拆分由空格分隔的所有内容
3.  添加一些 RTF 格式
4.  “熔断”的话重新组合在一起
5.  向控件发送文本

我不确定是什么部分导致了这种情况，所以这里是最相关的位：

```
int RichEdit::GetTextLength() const
{
    GETTEXTLENGTHEX len;
    len.codepage = 1200;
    len.flags = GTL_NUMBYTES;
    return (int)SendMessage(this->handle, EM_GETTEXTLENGTHEX, (WPARAM)&len, 0) + 1;
}

tstring RichEdit::GetText() const
{
    auto len = this->GetTextLength();
    GETTEXTEX str;

    TCHAR* tmp = new TCHAR[len];
    str.cb = len;
    str.flags = GT_USECRLF;
    str.codepage = 1200;

    str.lpDefaultChar = NULL;
        str.lpUsedDefChar = NULL;

        (void)SendMessage(this->handle, EM_GETTEXTEX, (WPARAM)&str, (LPARAM)tmp);

        tstring ret(tmp);

        delete[] tmp;
        return ret;
    }

void RichEdit::SetRtfText(const tstring& text, int flags)
    {
        DWORD WideLength = text.length();
        DWORD Length     = WideLength * 4;
        PSTR Utf8        = (PSTR)malloc(Length);

        int ReturnedLength = WideCharToMultiByte(CP_UTF8,
            0,
            text.c_str(),
            WideLength-1,
            Utf8,
            Length-1,
            NULL,
            NULL);

        if (ReturnedLength)
            Utf8[ReturnedLength] = 0;

        SETTEXTEX st = {0};
        st.flags = flags;
        st.codepage = CP_UTF8;
        (void)SendMessage(this->handle, EM_SETTEXTEX, (WPARAM)&st, (LPARAM)Utf8 );

        free(Utf8);
    }

void split ( tstring input , tstring split_id, std::vector<std::pair<tstring,bool>>& res ) {
    std::vector<std::pair<tstring,bool>> result;
    int i = 0;
    bool add;
    tstring temp;
    std::wstringstream ss;
    size_t found;
    tstring real;
    int r = 0;
    while ( i != input.length() ) 
    {
        add = false;
        ss << input.at(i);
        temp = ss.str();

        found = temp.find(split_id);
        if ( found != tstring::npos ) 
        {
            add = true;
            real.append ( temp , 0 , found );
        } else if ( r > 0 &&  ( i+1 ) == input.length() ) 
        {
            add = true;
            real.append ( temp , 0 , found );
        }
        if ( add ) 
        {
            result.emplace_back(std::make_pair(real,false));
            ss.str(tstring());
            ss.clear();
            temp.clear();
            real.clear();
            r = 0;
        }
        i++;
        r++;
    }
    res = result;
} 
```

ps: tstring 只是 std::wstring/std::string 的 typedef

如何保留换行符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T20:09:52.470

你的代码有很多问题。

您的代码是`TCHAR`基于的，但您实际上并没有`TCHAR`正确检索/设置 RTF 数据。

检索文本时，您将换行符规范化为 CRLF，但在检索文本长度时您没有进行相同的规范化，因此它们将彼此不同步。

您正在使用 UTF-8 将数据写入 RichEdit，但 RTF 是一种基于 ASCII 的格式，它对 Unicode 数据使用转义序列。如果您要以 Unicode 格式检索数据，您也可以使用 Unicode 编写它，并确保一开始就正确执行所有这些操作。让 RichEdit 控件为您处理 Unicode。

你的使用`WideCharToMultiByte()`是错误的。您根本不应该从字符串长度中减去 -1。您可能会尝试考虑空终止符，但长度值不包括空终止符。如果您要坚持使用 UTF-8，那么您应该使用它`WideCharToMultiByte()`来计算正确的 UTF-8 长度，而不是对其进行硬编码。

```
int Length = WideCharToMultiByte(CP_UTF8, 0, text.c_str(), text.length(), NULL, 0, NULL, NULL);
char Utf8 = new char[Length+1];
WideCharToMultiByte(CP_UTF8, 0, text.c_str(), text.length(), Utf8, Length, NULL, NULL);
Utf8[Length] = 0;
...
delete[] Utf8; 
```

话虽如此，如果您要坚持使用，请`TCHAR`尝试以下操作：

```
#ifdef UNICODE
#define RTFCodePage 1200
#else
#define RTFCodePage CP_ACP
#endif

int RichEdit::GetTextLength() const
{
    GETTEXTLENGTHEX len = {0};
    len.codepage = RTFCodePage;
    len.flags = GTL_NUMCHARS | GTL_USECRLF;
    return SendMessage(this->handle, EM_GETTEXTLENGTHEX, (WPARAM)&len, 0);
}

tstring RichEdit::GetText() const
{
    int len = this->GetTextLength() + 1;

    GETTEXTEX str = {0};
    str.cb = len * sizeof(TCHAR);
    str.flags = GT_USECRLF;
    str.codepage = RTFCodePage;

    vector<TCHAR> tmp(len);
    len = SendMessage(this->handle, EM_GETTEXTEX, (WPARAM)&str, (LPARAM)&tmp[0]);

    return tstring(&tmp[0], len-1);
}

void RichEdit::SetRtfText(const tstring& text, int flags)
{
    SETTEXTEX st = {0};
    st.flags = flags;
    st.codepage = RTFCodePage;

    #ifdef UNICODE
    st.flags |= ST_UNICODE;
    #endif

    SendMessage(this->handle, EM_SETTEXTEX, (WPARAM)&st, (LPARAM)text.c_str());
} 
```

最好放弃`TCHAR`并只对所有内容使用 Unicode：

```
int RichEdit::GetTextLength() const
{
    GETTEXTLENGTHEX len = {0};
    len.codepage = 1200;
    len.flags = GTL_NUMCHARS | GTL_USECRLF;
    return SendMessage(this->handle, EM_GETTEXTLENGTHEX, (WPARAM)&len, 0);
}

wstring RichEdit::GetText() const
{
    int len = this->GetTextLength() + 1;

    GETTEXTEX str = {0};
    str.cb = len * sizeof(WCHAR);
    str.flags = GT_USECRLF;
    str.codepage = 1200;

    vector<WCHAR> tmp(len);
    len = SendMessage(this->handle, EM_GETTEXTEX, (WPARAM)&str, (LPARAM)&tmp[0]);

    return wstring(tmp, len-1);
}

void RichEdit::SetRtfText(const wstring& text, int flags)
{
    SETTEXTEX st = {0};
    st.flags = flags | ST_UNICODE;
    st.codepage = 1200;

    SendMessage(this->handle, EM_SETTEXTEX, (WPARAM)&st, (LPARAM)text.c_str());
} 
```

**更新：**如果您必须返回 UTF-8 获取`EM_SETTEXTEX`消息，请尝试以下操作：

```
void RichEdit::SetRtfText(const tstring& text, int flags)
{
    string Utf8;
    int Length;

    #ifdef UNICODE

    Length = WideCharToMultiByte(CP_UTF8, 0, text.c_str(), text.length(), NULL, 0, NULL, NULL);
    if (Length > 0)
    {
        Utf8.resize(Length);
        WideCharToMultiByte(CP_UTF8, 0, text.c_str(), text.length(), &Utf8[0], Length, NULL, NULL);
    }

    #else

    Length = MultiByteToWideChar(CP_ACP, 0, text.c_str(), text.length(), NULL, 0);
    if (Length > 0)
    {
        vector<WCHAR> tmp(Length);
        MultiByteToWideChar(CP_ACP, 0, text.c_str(), text.length(), &tmp[0], Length);

        Length = WideCharToMultiByte(CP_UTF8, 0, tmp.c_str(), tmp.length(), NULL, 0, NULL, NULL);
        if (Length > 0)
        {
            Utf8.resize(Length);
            WideCharToMultiByte(CP_UTF8, 0, tmp.c_str(), tmp.length(), &Utf8[0], Length, NULL, NULL);
        }
    }

    #endif

    SETTEXTEX st = {0};
    st.flags = flags & ~ST_UNICODE;
    st.codepage = CP_UTF8;
    SendMessage(this->handle, EM_SETTEXTEX, (WPARAM)&st, (LPARAM)Utf8.c_str());
} 
```

# c# - 是否可以在 C# 中创建一个生成未知数量的私有实例变量的公共方法？

> ID：15263536
> 
> 赞同：-1
> 
> 时间：2013-03-07T05:09:02.373
> 
> 标签：c#

基本上我正在尝试实现我自己的数组类，我想知道是否创建一个生成未知数量的私有实例变量的公共方法是要走的路？就像是：

```
public class myArray {
    public myArray(int length) {
        for(int i = 0; i < length; i++) {
            int component+i;
        }
    }
    int component(int indexOfComponent) {
        return component+indexOfComponent; 
    }
} 
```

我知道 for 循环中的代码行没有意义。但我只是想我会说明我在说什么。使用 3 作为构造函数参数从 myArray 类创建对象会产生什么结果：

```
public class myArray {
    private int component1;
    private int component2;
    private int component3;

    public myArray(int length) {
        for(int i = 0; i < length; i++) {
            int component+i;
        }
    int component(int indexOfComponent) {
            return component+indexOfComponent; 
        }
    }
} 
```

而且我知道这些变量只会存在于 for 循环中，但这是我可以举例说明我正在尝试做的事情的最佳方式。如果我想实现自己的数组类，这甚至是要走的路吗？还; 还有一件事我认为可能值得一个单独的问题，但这是使用 for 循环动态命名变量的整个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:10:08.460

> 基本上我正在尝试实现我自己的数组类

我劝你不要那样做。

> 我想知道创建一个生成未知数量的私有实例变量的公共方法是否是要走的路

不，变量需要在*编译时*知道。

“要走的路”是使用数组或其他现有的集合类型。

从根本上说，您*不能*直接在 C# 中实现数组。数组和字符串是实例大小因对象而异的唯一对象。对于其他所有内容，每个对象的布局都是相同的。

（正如评论中提到的，您可以使用`Reflection.Emit`或类似的东西为每个实例动态创建一个新类型，但您真的*不想*这样做。）

# c# - 是否可以在 Outlook 中找到第一次修改/阅读电子邮件的时间？

> ID：15263539
> 
> 赞同：0
> 
> 时间：2013-03-07T05:09:32.113
> 
> 标签：c#, outlook, vsto, office-interop, outlook-addin

我目前正在为 Outlook 开发一个非常简单的 C# 插件，它将迭代特定文件夹并将有关消息的特定详细信息输出到 CSV 文件。我已经完成了那部分，但是**我想知道是否有办法判断消息何时被首次修改或阅读？** 我知道我可以看到最后修改的时间，但我希望我只是在 API 中遗漏了一些比我更有经验的人知道的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:06:14.133

No, there is no way to do that. the best you can do is read the PR_LAST_VERB_EXECUTED MAPI property (DASL name "[http://schemas.microsoft.com/mapi/proptag/0x10810003](http://schemas.microsoft.com/mapi/proptag/0x10810003)") - it will tell the time last time the message was replied to or forwarded.

# c - 检查另一个程序的输出的程序

> ID：15263548
> 
> 赞同：0
> 
> 时间：2013-03-07T05:10:13.903
> 
> 标签：c, linux, windows, ipc, pipe

我正在组织一场编程比赛。我需要创建一个程序来逐个字符地检查另一个程序（参与者的可执行文件）的输出。要求是：

*   程序必须是`platform independent`.
*   参与者不能获得输入和正确的输出。参与者所做的只是将他的程序名称传递给检查器。检查器告诉答案是否正确，就是这样。
*   参与者程序的输出不得显示给参与者本人 - 否则他可能会据此计算输入。

对于第二部分，是否可以以某种方式将输入和输出存储在可执行文件本身中？我宁愿不从加密文件中读取..这让事情有点不方便..

该程序应该像这样工作：

> checker.exe question1.exe
> 
> 正确答案，恭喜！
> 
> 请把这个给志愿者看。

我尝试使用标准 C 库中的`popen`和`pclose`函数。

但问题是，在 Linux 中，它会打开一个 shell，显示参与者程序的输出，根据第三个要求，这不应该发生。

有什么简单的方法可以做到这一点？提前致谢。

**编辑**：

我需要将针对每个问题制作的可执行文件专门交给参与者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:15:30.013

一种选择是要求用户使用您提供的公钥加密他们程序的输出：gnupg 可能是一个不错的选择。使用您的私钥解密输出并进行比较。

否则，不清楚如何在不将程序输出存储到某个文件（二进制或文本）以及不损害数据隐私的情况下进行比较。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:18:14.840

是的，永远不要将信息存储在外壳中很容易......只需使用管道。

例如

```
 $ question | checker 
```

Checker 可以打印它是否有效。这一切都发生在记忆中。

* * *

如果您希望用户能够自己执行此操作，只需将此代码放在脚本文件中，设置文件以便用户只能执行和读取 priv。然后将脚本设置为以 su 运行。然后脚本可以进行检查（即运行检查器 - 或进行比较）。如果需要比较，则数据文件可以在脚本外部，并且用户没有对该文件的权限，则他们无法读取数据。

# facebook-opengraph - 我可以在 Facebook 的 Open Graph 描述中传递标签吗

> ID：15263551
> 
> 赞同：-1
> 
> 时间：2013-03-07T05:10:29.503
> 
> 标签：facebook-opengraph

我通过 OpenGraph 描述元标记向 FB 按钮传递描述。在描述中，必须通过超级脚本中的 R-Ball (®) ^。

我可以在 Opengraph 描述标签中也传递带有 CSS 的 HTML 标签吗？

我想在FB描述中实现：

```
COMPANY NAME <sup style='font-size:80%'>&reg;</sup> 
```

公司名称®

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T07:43:26.467

您不能在 Open Graph 标记中传递 HTML 标记。但是，您可以在 Open Graph 描述中使用 ®（实际字符，而不是转义码）。它不会是超级脚本，但至少它是某种东西。

# javascript - 用于展开和折叠 JavaScript 代码块的 IDE

> ID：15263554
> 
> 赞同：0
> 
> 时间：2013-03-07T05:10:42.803
> 
> 标签：javascript, ide, expand, collapse, region

我发现在 JavaScript 中编写代码很困难，因为它们之间有如此多的嵌套函数或对象，以至于很难在不破坏代码的情况下修改代码。什么 IDE 可用于在 JavaScript 源代码中展开和折叠代码块（或词法范围级别），类似于 Visual Studio 中区域的工作方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:17:03.740

对于老式 IDE，请尝试**Eclipse： http: [//www.eclipse.org/downloads/packages/eclipse-ide-javascript-web-developers/heliosr](http://www.eclipse.org/downloads/packages/eclipse-ide-javascript-web-developers/heliosr)**

但我强烈推荐使用**Sublime Text：[http ://www.sublimetext.com/](http://www.sublimetext.com/)**

SublimeText 不会折叠/展开，但它会显示装订线以指示每个代码块有多少个制表符缩进。如果您访问他们的网站，请查看第一张演示幻灯片，它显示了代码块的缩进。

# python - 如何处理 ValueError？

> ID：15263561
> 
> 赞同：2
> 
> 时间：2013-03-07T05:11:22.267
> 
> 标签：python

我`index()`在字符串上使用来查找子字符串的出现。

当字符串中不存在子字符串时，我得到：

```
"ValueError: substring not found". 
```

我希望我的程序能够识别何时发生这种情况，但我不知道如何将其`ValueError`变成有用的东西。例如，我如何`ValueError`在`if`语句中使用getting a？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T05:19:28.163

通常，您可以使用 try 和 except 来捕获异常，但在 John 提到的这种情况下，您可以只使用 find()。

```
try:
   #your code that raises the exception
except ValueError:
   #turn it into something useful 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-07T05:13:33.360

不要等待异常。使用`find()`代替，`index()`您将完全避免出现异常。只需测试未找到并完成它。

# c# - 在 Visual Studio 2010 中编写 Windows 服务以获取另一个 Windows 服务的状态

> ID：15263566
> 
> 赞同：0
> 
> 时间：2013-03-07T05:11:56.090
> 
> 标签：c#, visual-studio-2010, windows-services

我在控制台应用程序中编写了以下代码并且工作正常。

```
 public void GetData()
                        {
                        ServiceController[] services = ServiceController.GetServices();
                        string strServices = null;
                        foreach (ServiceController service in services)
                        {
                          strServices += service.DisplayName.ToString() + ":" +    service.Status.ToString() + ">";
                        }
                        System.IO.File.WriteAllLines(@"D:\Info.txt", strServices.Split('>'));
                    } 
```

我需要在 Visual Studio 2010 的 Windows 服务模板中编写相同的代码。你能分享一下在哪里编写上面的代码吗？当我打开 Visual Studio Windows 服务模板时，默认情况下我会在需要放入上述代码的地方获得以下代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Diagnostics;
using System.Linq;
using System.ServiceProcess;
using System.Text;

namespace PocService
 {
   public partial class PocSevice : ServiceBase
   {
       public PocSevice()
       {
          InitializeComponent();
       }

    protected override void OnStart(string[] args)
    {
    }

    protected override void OnStop()
    {
    }
 }
} 
```

# heroku - 找不到倾斜 Heroku 部署

> ID：15263567
> 
> 赞同：3
> 
> 时间：2013-03-07T05:11:59.303
> 
> 标签：heroku

升级到 Ruby 2.0.0 后，我开始部署：

```
Could not find tilt-1.3.5 in any of the sources 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T09:51:35.597

升级导轨后我也遇到了同样的问题。所以我修改了 Gemfile.lock 以使用倾斜 1.3.3 而不是倾斜 1.3.5。现在它对我有用。

Gemfile.lock

```
tilt (1.3.5) 
```

-->

```
tilt (1.3.3) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T23:30:23.710

为什么会这样？我还必须添加到 Gemfile：

```
gem "tilt", "1.3.4" 
```

# ruby-on-rails - Ruby 1.9.3、Rails 3.2.12、OSX Lion - 命令行脚本的引导 Rails 很慢

> ID：15263568
> 
> 赞同：0
> 
> 时间：2013-03-07T05:11:59.290
> 
> 标签：ruby-on-rails, ruby, command-line, bootstrapping

在命令行脚本中引导 Rails 需要很长时间（2.5 秒以上），例如：

```
timer = Time.now  
ENV["RAILS_ENV"] ||= "development"  
require File.expand_path('../../config/application', __FILE__)  
Rails.application.require_environment!  
puts "Init complete in #{Time.now - timer} sec"  
# -> Init complete in 2.621531 sec 
```

我错过了什么吗？如果不是，我真的需要引导所有东西来访问模型吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T06:02:33.900

I don't have a lot of experience with this, but perhaps you should take a look at trimming down the number of libraries that are [required in application.rb](http://guides.rubyonrails.org/initialization.html#loading-rails):

```
# require 'rails/all' # remove this and only require what you need
require 'activerecord/railtie' # this may be all you need 
```

Additionally, take a look at the gems you are loading and [see if any of them are taking an inordinate amount of time](https://stackoverflow.com/questions/4736546/rails-3-osx-speed-up-console-loading-time). If a particular gem is slowing down boot time, simply add:

```
# you will need to explicitly load the gem when needed,
# but it won't be required at boot time 
gem some_gem, :require => false 
```

You could create a special environment that you run the script in and customize the boot process for that environment.

You should profile that block of code and see where most of the time is spent.

What exactly are you trying to get out of booting rails? Access to the models? the underlying data? Perhaps there's an alternate approach than booting all of rails.

# c# - 我可以使用 LINQ 以数字方式添加两个数组的值吗？

> ID：15263569
> 
> 赞同：2
> 
> 时间：2013-03-07T05:12:02.630
> 
> 标签：c#, linq, vector, operators

例如，如果我有两个数值数组，`double[] a, b`并且我想生成第三个数组，每个元素都是相加的`a`，`b`我可以通过循环来完成

```
double[] a, b, c
// fill in a, b and initialize c
for(int i=0; i<c.Length; i++)
{
    c[i] = a[i] + b[i];
} 
```

所以问题是；有没有办法使用 LINQ 而不是循环？

PS。假设我已经有一个二元运算符`Func<double,double,doube> add = (x,y)=>x+y;`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T05:14:46.673

听起来你只想要这个[`Zip`](http://msdn.microsoft.com/en-us/library/dd267698.aspx)方法：

```
var result = a.Zip(b, add).ToArray(); 
```

（当然，这仍然会在内部循环 - 但不会在您的代码中。）

编辑：`Zip`仅在 .NET 4 及更高版本中可用，但[Eric Lippert 关于该主题的博客文章](http://blogs.msdn.com/b/ericlippert/archive/2009/05/07/zip-me-up.aspx)包含示例源代码......或者您可以使用[我的 Edulinq 实现](https://code.google.com/p/edulinq/source/browse/src/Edulinq/Zip.cs)（请参阅[相应的博客文章](http://msmvps.com/blogs/jon_skeet/archive/2011/01/14/reimplementing-linq-to-objects-part-35-zip.aspx)）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-07T06:03:11.650

实现这一目标的另一种方法是：

```
c = a.Select((x, i) => x + b[i]).ToArray(); 
```

这是 LINQ Select 扩展方法的重载，`Func<TSource, int, TResult>` 其中 int 参数是 TSource 元素的索引。这样，您也可以使用它来访问 b 的第 i 个元素，但前提是`b.Length >= a.Length`，否则您最终可能会得到 a `IndexOutOfRangeException`。

希望有帮助；）

# c# - 在c#中字符串的最后一个字符之前添加逗号

> ID：15263570
> 
> 赞同：-1
> 
> 时间：2013-03-07T05:12:04.650
> 
> 标签：c#, string

我需要在字符串的最后一个字符之前放一个逗号。

例如：

输入：101919 = 输出：10191,9

最好的方法是什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-07T05:14:38.150

```
if (input.Length > 0) { input = input.Insert(input.Length - 1, ","); } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T05:16:16.563

用[插入](http://msdn.microsoft.com/en-us/library/system.string.insert%28v=vs.71%29.aspx)法

```
strTarget = strTarget.Insert( srtrTarget.Length -1, ","); 
```

# matlab - 如何加快matlab中的for循环命令

> ID：15263575
> 
> 赞同：0
> 
> 时间：2013-03-07T05:12:26.807
> 
> 标签：matlab, for-loop

我有大量的 for 循环；有什么办法可以让这个运行得更快吗？获取散点图需要 30 多分钟。

我在想也许可以使用休息。是否有可能或者我需要使用其他东西来让程序逐段运行？

```
A = [4/5 -1/5 -1/5 -1/5 -1/5; -1/5 4/5 -1/5 -1/5 -1/5; -1/5 -1/5 4/5 -1/5 -1/5;-1/5 -1/5 -1/5 4/5 -1/5; -1/5 -1/5 -1/5 -1/5 4/5];
B = [ 0 0 0 0 0 ; 0 0 0 0 1 ; 0 0 0 1 0 ; 0 0 0 1 1 ; 0 0 1 0 0 ; 0 0 1 0 1 ];

for i = 1:size(B,1)
    p1 = A * B(1,:)' -A * B(i,:)';
    dtransformation0a(i) = d*p1;
    qtransformation0a(i) = q*p1;

    for i = 1:size(B,1)
        p2 = A * B(2,:)' -A * B(i,:)';
        dtransformation0b(i) = d*p2;
        qtransformation0b(i) = q*p2;

        for i = 1:size(B,1)
            p3 = A * B(3,:)' -A * B(i,:)';
            dtransformation0c(i) = d*p3;
            qtransformation0c(i) = q*p3;

            for i = 1:size(B,1)
                p4 = A * B(4,:)' -A * B(i,:)';
                dtransformation0d(i) = d*p4;
                qtransformation0d(i) = q*p4;

                for i = 1:size(B,1)
                    p5 = A * B(5,:)' -A * B(i,:)';
                    dtransformation0e(i) = d*p5;
                    qtransformation0e(i) = q*p5;

                    for i = 1:size(B,1)
                        p6 = A * B(6,:)' -A * B(i,:)';
                        dtransformation0f(i) = d*p6;
                        qtransformation0f(i) = q*p6;
                    end
                end
            end
        end
    end
end

figure
scatter(dtransformation0a,qtransformation0a,100,'b.')

%text(dtransformation0a(:), qtransformation0a(:), labels, 'VerticalAlignment','bottom', ...
% 'HorizontalAlignment','right') 
hold on 
scatter(dtransformation0b,qtransformation0b,100,'b.')

%text(dtransformation0a(:), qtransformation0a(:), labels, 'VerticalAlignment','bottom', ...
% 'HorizontalAlignment','right')
hold on 
scatter(dtransformation0c,qtransformation0c,100,'b.')

%text(dtransformation0a(:), qtransformation0a(:), labels, 'VerticalAlignment','bottom', ...
% 'HorizontalAlignment','right')
hold on 
scatter(dtransformation0d,qtransformation0d,100,'b.')

%text(dtransformation0a(:), qtransformation0a(:), labels, 'VerticalAlignment','bottom', ...
% 'HorizontalAlignment','right')
hold on
scatter(dtransformation0e,qtransformation0e,100,'b.')

%text(dtransformation0a(:), qtransformation0a(:), labels, 'VerticalAlignment','bottom', ...
% 'HorizontalAlignment','right') 
hold on 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:22:57.703

我不相信您需要嵌套所有这些循环，因为您似乎正在重新定义`i`每个单独循环的每个单独迭代中的值。单个循环也应该可以工作。这应该同样有效，但要快得多。

```
A = [4/5 -1/5 -1/5 -1/5 -1/5; -1/5 4/5 -1/5 -1/5 -1/5; -1/5 -1/5 4/5 -1/5 -1/5;-1/5 -1/5 -1/5 4/5 -1/5; -1/5 -1/5 -1/5 -1/5 4/5];
B = [ 0 0 0 0 0 ; 0 0 0 0 1 ; 0 0 0 1 0 ; 0 0 0 1 1 ; 0 0 1 0 0 ; 0 0 1 0 1 ];

for i = 1:size(B,1)
    p1 = A * B(1,:)' -A * B(i,:)';
    dtransformation0a(i) = d*p1;
    qtransformation0a(i) = q*p1;
    p2 = A * B(2,:)' -A * B(i,:)';
    dtransformation0b(i) = d*p2;
    qtransformation0b(i) = q*p2;
    p3 = A * B(3,:)' -A * B(i,:)';
    dtransformation0c(i) = d*p3;
    qtransformation0c(i) = q*p3;
    p4 = A * B(4,:)' -A * B(i,:)';
    dtransformation0d(i) = d*p4;
    qtransformation0d(i) = q*p4;
    p5 = A * B(5,:)' -A * B(i,:)';
    dtransformation0e(i) = d*p5;
    qtransformation0e(i) = q*p5;
    p6 = A * B(6,:)' -A * B(i,:)';
    dtransformation0f(i) = d*p6;
    qtransformation0f(i) = q*p6;
end

figure
scatter(dtransformation0a,qtransformation0a,100,'b.')

%text(dtransformation0a(:), qtransformation0a(:), labels, 'VerticalAlignment','bottom', ...
% 'HorizontalAlignment','right') 
hold on 
scatter(dtransformation0b,qtransformation0b,100,'b.')

%text(dtransformation0a(:), qtransformation0a(:), labels, 'VerticalAlignment','bottom', ...
% 'HorizontalAlignment','right')
hold on 
scatter(dtransformation0c,qtransformation0c,100,'b.')

%text(dtransformation0a(:), qtransformation0a(:), labels, 'VerticalAlignment','bottom', ...
% 'HorizontalAlignment','right')
hold on 
scatter(dtransformation0d,qtransformation0d,100,'b.')

%text(dtransformation0a(:), qtransformation0a(:), labels, 'VerticalAlignment','bottom', ...
% 'HorizontalAlignment','right')
hold on
scatter(dtransformation0e,qtransformation0e,100,'b.')

%text(dtransformation0a(:), qtransformation0a(:), labels, 'VerticalAlignment','bottom', ...
% 'HorizontalAlignment','right') 
hold on 
```

换句话说，时间复杂度已经从 降低`O(n^6)`到`O(n)`。因此，如果您之前花费 30 分钟，您可能会花费大约 30^(1/6) 分钟，即现在不到 2 分钟。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T05:39:05.297

我同意罗尼的观点，

不需要嵌套所有循环。

这些将有助于将时间减少到 n*6-1（大约）

# mysql - 3 个要合并的查询并计划创建图形

> ID：15263579
> 
> 赞同：1
> 
> 时间：2013-03-07T05:12:49.880
> 
> 标签：mysql, sql

```
Product_Name: Pillow, Pillow Case
Color: Red, Blue and Green
Status: Available, Sold 
```

我有 3 个单独的查询来计算 ff：

1.  计算可用枕头的总数
2.  数一数售出的枕头总数
3.  可售与已售之间的差异

我打算创建一个关于单个查询的图表，但无法弄清楚**将 3 个查询合并为 1 个**仍然产生相同输出的查询，或者**有可能吗？**

**1 个查询：（** *我将只添加 Status = 'Sold' 的 Where 条件）*

```
SELECT COUNT( * ) AS totalAvailable, Product_Name, Color, Status 
FROM Product
GROUP BY Product, Color 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:17:14.413

```
SELECT  Product_name,
        totalAvailable,
        totalSold,
        totalAvailable - totalSold AS ProductDifference
FROM
        (
            SELECT  Product_name,
                    SUM(CASE WHEN Status = 'Available' THEN 1 ELSE 0 END) totalAvailable,
                    SUM(CASE WHEN Status = 'Sold' THEN 1 ELSE 0 END) totalSold
            FROM    tableName
            GROUP   BY Product_name
        ) s 
```

# mysql - idBag 生成器类转换异常

> ID：15263583
> 
> 赞同：0
> 
> 时间：2013-03-07T05:13:20.150
> 
> 标签：mysql, hibernate-mapping, hsqldb

我一直在尝试让 idbag 在休眠状态下工作。我一直在针对 MySql DB 和 HSQLDB 尝试它，并且我还尝试了几个不同版本的 Hibernate。Hibernate 4 和 Hibernate 3 给出的关于错误原因的信息略有不同，但主要都说同样的事情：Class Cast Exception。

我将我的所有代码都托管在一个公共 repo 中的 bitbucket 上，并且所有内容都包含用于创建带有相关表的 MySql 或 HSQL DB 的 DDL。我的 HSQLDB 版本是 2.2.9，MySql 版本是 5.1.66 - 我的偏好是让它在 MySql 上运行。

Git 克隆命令：git clone [https://pphi@bitbucket.org/pphi/idbag.git](https://pphi@bitbucket.org/pphi/idbag.git)

网页： [https://pphi@bitbucket.org/pphi/idbag.git](https://pphi@bitbucket.org/pphi/idbag.git)

当使用 Hibernate 4.0.1 我得到这个堆栈跟踪：

```
 Hibernate: insert into idBagTest.Team (nickname, mascot) values (?, ?)
Hibernate: insert into idBagTest.Famous_Fan (first_name, last_name) values (?, ?)
Hibernate: insert into idBagTest.famous_fan_team (Team_id, team_fan_id, Famous_Fan_id ) values (?, ?, ?)
Exception in thread "main" java.lang.ClassCastException: org.hibernate.id.IdentifierGeneratorHelper$2 cannot be cast to java.lang.Long
    at org.hibernate.type.descriptor.java.LongTypeDescriptor.unwrap(LongTypeDescriptor.java:36)
    at org.hibernate.type.descriptor.sql.BigIntTypeDescriptor$1.doBind(BigIntTypeDescriptor.java:57)
    at org.hibernate.type.descriptor.sql.BasicBinder.bind(BasicBinder.java:92)
    at org.hibernate.type.AbstractStandardBasicType.nullSafeSet(AbstractStandardBasicType.java:280)
    at org.hibernate.type.AbstractStandardBasicType.nullSafeSet(AbstractStandardBasicType.java:275)
    at org.hibernate.persister.collection.AbstractCollectionPersister.writeIdentifier(AbstractCollectionPersister.java:919)
    at org.hibernate.persister.collection.AbstractCollectionPersister.recreate(AbstractCollectionPersister.java:1252)
    at org.hibernate.action.internal.CollectionRecreateAction.execute(CollectionRecreateAction.java:58)
    at org.hibernate.engine.spi.ActionQueue.execute(ActionQueue.java:362)
    at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:354)
    at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:279)
    at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:326)
    at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:52)
    at org.hibernate.internal.SessionImpl.flush(SessionImpl.java:1213)
    at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:402)
    at org.hibernate.engine.transaction.internal.jdbc.JdbcTransaction.beforeTransactionCommit(JdbcTransaction.java:101)
    at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.commit(AbstractTransactionImpl.java:175)
    at com.intertech.dao.TeamDaoHibernateImpl.saveTeam(TeamDaoHibernateImpl.java:19)
    at com.intertech.Main.main(Main.java:22) 
```

使用 Hibernate 3.1 时，我得到了稍微不同的堆栈跟踪：

```
Hibernate: insert into Team (id, nickname, mascot) values (null, ?, ?)
Hibernate: insert into Famous_Fan (id, first_name, last_name) values (null, ?, ?)
Hibernate: insert into famous_fan_team (Team_id, team_fan_id, Famous_Fan_id ) values (?, ?, ?)
5120 [main] INFO org.hibernate.type.LongType - could not bind value 'POST_INSERT_INDICATOR' to parameter: 2; org.hibernate.id.IdentifierGeneratorFactory$2 cannot be cast to java.lang.Long
Exception in thread "main" java.lang.ClassCastException: org.hibernate.id.IdentifierGeneratorFactory$2 cannot be cast to java.lang.Long
    at org.hibernate.type.LongType.set(LongType.java:65)
    at org.hibernate.type.NullableType.nullSafeSet(NullableType.java:154)
    at org.hibernate.type.NullableType.nullSafeSet(NullableType.java:136)
    at org.hibernate.persister.collection.AbstractCollectionPersister.writeIdentifier(AbstractCollectionPersister.java:829)
    at org.hibernate.persister.collection.AbstractCollectionPersister.recreate(AbstractCollectionPersister.java:1160)
    at org.hibernate.action.CollectionRecreateAction.execute(CollectionRecreateAction.java:58)
    at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:279)
    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:263)
    at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:171)
    at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:321)
    at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:50)
    at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1027)
    at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:365)
    at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:137)
    at com.intertech.dao.TeamDaoHibernateImpl.saveTeam(TeamDaoHibernateImpl.java:19)
    at com.intertech.Main.main(Main.java:22) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T06:09:29.453

[https://hibernate.onjira.com/browse/HHH-397](https://hibernate.onjira.com/browse/HHH-397)

在使用 MySql 和 Hibernate 时，显然不支持在 idBag 中使用生成器类的标识。用增量替换了生成器类并得到了这个：

Hibernate：插入 idBagTest.Team（昵称，吉祥物）值（？，？） Hibernate：插入 idBagTest.Famous_Fan（first_name，last_name）值（？，？） Hibernate：从 idBagTest.Famous_Fan_Team 中选择 max(team_fan_id) 休眠：插入进入 idBagTest.Famous_Fan_Team (Team_id, team_fan_id, Famous_Fan_id ) 值 (?, ?, ?)

存储库已使用工作代码进行了更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-23T19:18:00.873

我遇到了同样的错误，

经过一番研究，我得出结论，这取决于两件事。

1.  你正在使用什么数据库加上
2.  什么@GenericGenerator - 你正在使用什么策略。

我能够通过以下配置解决问题。

1.  数据库 - MySQL
2.  将策略更改为从原生增量

我的代码看起来像：@ElementCollection @JoinTable(name="USERS_ADDRESSES", joinColumns=@JoinColumn(name="USER_ID")) @GenericGenerator(name="hilogen",strategy="increment") @CollectionId(columns={@ Column(name="ADDR_ID")},generator="hilogen",type=@Type(type="long")) private List addressList = new ArrayList();

希望这有帮助。

谢谢，萨加尔维亚斯

# angularjs - Angularjs 中的指令是如何工作的？

> ID：15263587
> 
> 赞同：2
> 
> 时间：2013-03-07T05:13:45.540
> 
> 标签：angularjs, angularjs-directive

我正在为一个问题而苦苦挣扎，无法弄清楚为什么会发生这种情况。

我有一个模块（portfolioModule）、服务（Menu）和一个指令（niMenu）。该指令应该呈现一个菜单项及其子项。

HTML：

```
<div ng-app="portfolioModule">
    <script id="menuItem" type="text/ng-template">
    <li>
        <a>{{item.name}}</a>
        <ul>
            <li ng-repeat="item in menu.getKids(item.id)" ng-include="'menuItem'"></li>
        </ul>
    </li>
    </script>

    <div>
        <div ni-menu="test">test1</div>
    </div>
</div> 
```

JavaScript：

```
var portfolioModule = angular.module('portfolioModule', []);

portfolioModule.factory('Menu', function() {
        var items = [
            {
                "parent_id": null,
                "id": 1,
                "name": "foo"
            }, {
                "parent_id": 1,
                "id": 2,
                "name": "foo-bar"
            }
        ];
        this.getKids = function(parent_id) {
            var result = [];
            parent_id = parent_id || null;

            console.log('getKids', parent_id);
            angular.forEach(items, function(value) {
                if (value.parent_id === parent_id) {
                    result.push(value);
                }
            });
            return result;
        };

        return this;
    }
);

portfolioModule.directive('niMenu', function(Menu) {
        var niMenu;
        return niMenu = {
            template: '<ul ng-include="\'menuItem\'" ng-repeat="item in menu.getKids()"></ul>',
            restirt: 'A',
            link: function(scope, element, attrs) {
                console.log('link');
                scope.menu = Menu;
            }
        };
    }
); 
```

工作演示：http: [//jsfiddle.net/VanSanblch/Ng7ef](http://jsfiddle.net/VanSanblch/Ng7ef)。

在 html 中，我通过 ni-menu 调用 niMenu。该指令有一个模板和一个链接功能，将 Menu-service 放入模块的范围内。在指令的模板中，我使用 Menu.getKids() 并获取所有顶级项目。后来，在 ng-include 使用的模板中，我调用 Menu.getKids(item.id) 并获取特定项目的所有子项。

除了一个小细节外，一切都很好。如果您打开控制台，那么您可以观察到 getKids 的调用比我预期的要多得多。例如，对于两个元素的数组，getKids 调用的次数为九。

有人可以解释为什么会发生这种情况吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T06:09:06.490

好的，所以它执行不止一次的原因是因为这就是摘要循环的工作方式：它不断地执行所有视图表达式（就像你传递给 ngRepeat 的那个），直到它表示没有变化。有关更多信息，请参阅[此答案](https://stackoverflow.com/questions/14973792/why-angularjs-will-invoke-function-name-twice/14973877#14973877)，但要点是：它总是*至少执行一次*，但通常更多。

使用 ngRepeat 时，您通常希望避免从函数中获取数据，因为它会对性能产生负面影响；当数据从未改变时，为什么要多次调用同一个函数？更好的方法是让您的控制器（或在本例中为指令）执行您的函数并将结果存储在范围内，因此您的 ngRepeat 看起来像`ng-repeat="item in items"`而不是`ng-repeat="item in getItems()"`.

不幸的是，这意味着您必须重新调整指令的工作方式。无论如何，这被证明是一个好主意，因为您的指令可以重写为更简单一些 - 例如，您不需要任何 ngInclude。

您要做的是创建两个指令，因为您有两个模板：一个代表整个菜单，另一个代表一个子项（反过来，它可以有子项）。该`menu`指令应在顶级菜单项上重复，`menuItem`为每个菜单项绘制一个。该`menuItem`指令应该检查孩子，并在必要时用更多`menuItem`的 s 重复这些。等等。这是一个由 Andy Joslin 创建的示例，说明如何完成递归目录： http: [//plnkr.co/edit/T0BgQR](http://plnkr.co/edit/T0BgQR)。

实现这样的事情超出了这个问题的范围，但是如果你需要帮助，可以尝试一下并发布一个新问题。

祝你好运！

# python - 将浮点数转换为一定精度，然后复制为字符串

> ID：15263597
> 
> 赞同：168
> 
> 时间：2013-03-07T05:14:46.543
> 
> 标签：python, string, floating-point

我有一个浮点数，比如说`135.12345678910`。我想将该值连接到一个字符串，但只想要`135.123456789`. 使用打印，我可以通过执行以下操作轻松做到这一点：

```
print "%.9f" % numvar 
```

是`numvar`我的原始号码。是否有捷径可寻？

* * *

## 回答 #1

> 赞同：219
> 
> 时间：2013-03-07T05:36:58.387

对于 Python < 3（例如 2.6 [见评论] 或 2.7），有两种方法可以做到这一点。

```
# Option one
older_method_string = "%.9f" % numvar

# Option two
newer_method_string = "{:.9f}".format(numvar) 
```

但请注意，对于 3 以上的 Python 版本（例如 3.2 或 3.3），选项二是[首选](http://docs.python.org/2/library/stdtypes.html#str.format)。

有关选项二的更多信息，我建议[使用 Python 文档中关于字符串格式的链接](http://docs.python.org/2/library/string.html#formatstrings)。

有关选项一的更多信息，[这个链接就足够了，并且有关于各种标志的信息](http://docs.python.org/2/library/stdtypes.html#string-formatting)。

Python 3.6（2016 年 12 月正式发布），增加了`f`字符串字面量，[更多信息请看这里](https://docs.python.org/3.6/reference/lexical_analysis.html#f-strings)，扩展了`str.format`方法（使用大括号这样`f"{numvar:.9f}"`解决了原来的问题），即

```
# Option 3 (versions 3.6 and higher)
newest_method_string = f"{numvar:.9f}" 
```

解决问题。查看@Or-Duan 的答案以获取更多信息，但这种方法*很快*。

* * *

## 回答 #2

> 赞同：74
> 
> 时间：2017-03-16T12:25:17.457

# 蟒蛇 3.6

为了清楚起见，您可以使用[f 字符串](https://docs.python.org/3/whatsnew/3.6.html#pep-498-formatted-string-literals)格式。这与该方法具有几乎相同的语法`format`，但使其更好一点。

例子：

```
print(f'{numvar:.9f}') 
```

更多关于新 f 字符串的阅读：

*   *[Python 3.6 中的新功能](https://docs.python.org/3/whatsnew/3.6.html#pep-498-formatted-string-literals)*（与上面相同的链接）
*   *[PEP 官方文档](https://www.python.org/dev/peps/pep-0498/)*
*   *[Python 官方文档](https://docs.python.org/3/reference/lexical_analysis.html#formatted-string-literals)*
*   *[非常好的博文——也谈到了性能](https://cito.github.io/blog/f-strings/)*

这是各种测试方法的执行时间图（来自上面的最后一个链接）：

[![执行时间](../Images/79d7a91ed901f5392b8a61db99a9c09f.png)](https://i.stack.imgur.com/azP5N.png)

* * *

## 回答 #3

> 赞同：58
> 
> 时间：2013-03-07T05:33:41.720

使用`round`：

```
>>> numvar = 135.12345678910
>>> str(round(numvar, 9))
'135.123456789' 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-08-17T07:04:56.657

如果直到运行时才知道精度，则此其他格式化选项很有用：

```
>>> n = 9
>>> '%.*f' % (n, numvar)
'135.123456789' 
```

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2013-03-07T05:19:29.423

格式化的不是打印，它是字符串的属性，所以你可以使用

```
newstring = "%.9f" % numvar 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-01-18T08:13:35.297

要使用 9 位设置精度，请获取：

```
print "%.9f" % numvar 
```

返回精度为 2 位：

```
print "%.2f" % numvar 
```

返回具有 2 位数字和浮点转换值的精度：

```
numvar = 4.2345
print float("%.2f" % numvar) 
```

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2015-11-09T16:33:08.773

该`str`函数有一个错误。请尝试以下方法。您将看到“0,196553”，但正确的输出是“0,196554”。因为该`str`函数的默认值为 ROUND_HALF_UP。

```
>>> value=0.196553500000 
>>> str("%f" % value).replace(".", ",") 
```

# android - 移动文件时来自媒体提供商的音乐 ID 是否会更改？

> ID：15263608
> 
> 赞同：0
> 
> 时间：2013-03-07T05:15:43.633
> 
> 标签：android, mediastore, android-mediascanner

我们有这个文件，它在is`/sdcard/music/file.mp3`中对应的 ID 。在以下情况下 ID 是否会更改：`MediaStore``1`

*   文件被移动，说移动到`/sdcard/music2/file.mp3`
*   文件被重命名（可能和上面一样）

媒体扫描仪完成重新扫描后？

**更新澄清，所以你可以看到我的目的。**

虽然下面实际上不是我的真正目的，但想法是一样的：

我想将每个 mp3 文件与一个 URL 相关联（比如它的歌词）。我会将它保存在我自己的 sqlite 数据库中。我的 sqlite 数据库将具有 ID 和 URL 列，其中 ID 列与媒体提供程序中的 ID 相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-17T05:44:09.813

希望现在给出答案还为时不晚。**是的，它会改变。**当您重命名或移动文件时，媒体提供程序的行为与您删除文件然后重新创建文件一样。它像一个完全不同的文件一样处理。

但是，即使我不知道您的真正目的，我仍然认为您可以使用 MediaStore。如果你觉得没问题，请告诉我你打算如何使用它，这样我就可以帮你解决这个问题。

# python - 如何使用 np.linalg.eigh(A) 打印所有特征值？

> ID：15263610
> 
> 赞同：1
> 
> 时间：2013-03-07T05:15:49.213
> 
> 标签：python, numpy

我有大小为 2200 * 2200 的对称矩阵。我在 numpy 中使用以下命令对角化：

```
np.linalg.eigh(A) 
```

它给出如下输出：

```
(array([ -1.93221186e-14,  -1.53743240e-14,  -3.58303176e-15, ...,
     4.95098104e+01,   5.06117042e+01,   5.07858517e+01]). 
```

请给我建议一种方法，以便它可以打印所有 2200 特征值。感谢您提前回复

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:19:45.813

只需使用元组解包：

`eigenvalues, eigenvectors = np.linalg.eigh(A)`

然后你将有一个一维数组`eigenvalues`。`len(eigenvalues) == 2200`如果你愿意，你可以像往常一样迭代和打印它。

```
for eigenvalue in eigenvalues:
  print eigenvalue 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T08:26:37.660

如前所述，您可以使用元组解包将特征值存储在单独的数组中。然后你可以使用`np.savetxt`例程写出你的数组：

```
import sys
import numpy as np

eigvals, eigvecs = np.linalg.eigh(A)
np.savetxt(sys.stdout, eigvals, delimiter=" ", fmt="%15.8E") 
```

这里的好处是，如果您决定将数组写入文件而不是屏幕，您可以使用文件处理程序（甚至文件名）而不是 sys.stdout。

# ruby-on-rails - 如何在没有递归的情况下维护父子元素中的缓存属性？

> ID：15263617
> 
> 赞同：1
> 
> 时间：2013-03-07T05:16:15.347
> 
> 标签：ruby-on-rails, ruby, postgresql

我在下面有两个模型。由于必须进行联接，因此很难像进行工资计算一样呈现班次的索引视图。时钟有很多属性，有必要将它们分开存储，以使轮班在我们需要时具有动态性，包括旅行、休息和工作。

为避免性能问题，第一个和最后一个时钟的日期时间（我知道这个属性的名称不好）在班次中存储为started_at 和finished_at 以及班次的总持续时间。直到下一个时钟的持续时间存储在每个时钟中。

**问题：**保存时钟当前会回调其 Shift 以重新计算其属性，然后保存它们，这会再次自动保存所有时钟。这不是无限期的，因为回调中的 attribute_changed 检查，但它会重新计算并保存多次。

**问题：**如何确保所有模型都保持正确的缓存值，而无需在保存父级或子级时重新计算多次？

换档型号：

```
class Shift < ActiveRecord::Base
  has_many :clocks, autosave: true, dependent: :destroy

  attr_accessible :employee_id, :started_at, :finished_at, :duration, :clocks_attributes
  before_save :calculate_cached_attributes

  def calculate_cached_attributes
    clocks.sort_by!(&:datetime)

    self.started_at = clocks.first.datetime

    # assign finished_at if shift is finished and check that there isn't one finished clock
    if clocks.last.activity == :finished && clocks.first != clocks.last
      self.finished_at = clocks.last.datetime
    else
      self.finished_at = nil
    end

    following_clock = nil
    shift_duration = 0

    clocks.reverse.each do |clock|
      if following_clock
        clock.duration = following_clock.datetime - clock.datetime
      else
        clock.duration = 0
      end

      shift_duration += clock.duration unless clock.activity == :break
      following_clock = clock
    end

    self.duration = shift_duration
  end

  def update_cached_attributes!
    if clocks.any? # check if being called because of clocks dependent destroy callback
      save!
    end
  end

end 
```

时钟型号：

```
class Clock < ActiveRecord::Base
  belongs_to :shift
  attr_accessible :shift_id, :datetime, :duration, :activity
  symbolize :activity, in: [:work, :travel, :break, :finished] # symbolize gem

  after_save :update_shift_attributes_after_save!
  after_destroy :update_shift_attributes_after_destroy!

  def update_shift_attributes_after_save!
    if (datetime_changed? || activity_changed?) && shift
      shift.update_cached_attributes!
    end
  end

  def update_shift_attributes_after_destroy!
    if shift
      shift.reload.update_cached_attributes!
    end
  end
end 
```

需要（重新）计算的示例：

```
shift.clocks.last.update_attribute(:datetime, Time.now)

# shift may no longer be complete if activity changed from :finished
shift.clocks.last.update_attribute(:activity, :work)

shift.clocks.last.datetime = Time.now
shift.save!

Shift.create!(employee_id: 1, clocks_attributes: [....] )

shift.clocks.last.destroy 
```

我试图尽可能简化代码以突出问题。让我知道是否缺少某些东西，或者是否有完全不同的方法可以更好地做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T17:19:09.330

我认为`Clock#update_shift_attributes_after_save!`当您只需要更新缓存的属性时，您希望避免调用回调。似乎在这种情况下，唯一`Clock`更新的缓存属性是`duration`，所以像下面这样简单的东西可能会起作用

```
after_save :update_shift_attributes_after_save!, :if => -> { changed.include?("duration") } 
```

* * *

让`Clock`模型负责更新自己的缓存属性可能会更好。这就是我这样做的方法。

```
# Clock
CACHED_ATTRIBUTES = [:duration].freeze

def update_cached_attributes!(attrs = {})
  self.class.where(:id => id).update_all(attrs.slice(*CACHED_ATTRIBUTES))  # update_all will NOT trigger callbacks.
                                                                           # This only works for persisted records. You'd need to add logic if you must handle new records.
end

# In Shift#calculate_cached_attributes
clocks.reverse.each do |clock|
  clock.update_cached_attributes!(:duration => following_clock ? (following_clock.datetime - clock.datetime) : 0) 
```

# unit-testing - Windows phone 项目运行测试

> ID：15263622
> 
> 赞同：0
> 
> 时间：2013-03-07T05:16:24.713
> 
> 标签：unit-testing, windows-phone-8

我在 Windows Phone 8 项目中使用[WPToolkitTestFX 。](https://nuget.org/packages/WPToolkitTestFx)所以我正在使用特殊页面运行测试，在构造函数中我得到了：

```
this.Content = UnitTestSystem.CreateTestPage(); 
```

但是如果我想运行应用程序，我需要在 WMAppManifest.xml中更改*Navigation Page 。*这不好，因为我经常忘记将其改回并将 WMAppManifest 推送到源代码控制系统。

是否可以为 WP8 项目创建**不同的运行配置？**一个用于申请，另一个用于测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T06:09:22.577

将您的单元测试放在具有自己的 WMAppManifest 的不同项目中。

# git - 如何自动将更新的上游合并到主题分支中？

> ID：15263623
> 
> 赞同：0
> 
> 时间：2013-03-07T05:16:39.817
> 
> 标签：git, merge

场景是：

首先分支 A 和 B 具有相同的提交历史，后来 A 添加了 commit `a`， B 添加了 commit `b`。

1.  在 Git 1.7.0.4 中，`git merge [--no-ff] B`在分支 A 上运行将自动生成带有消息“Merge branch 'B' into A”的合并提交
2.  在 Git 1.8.1.5 中，`git merge [--no-ff] B`在分支 A 上运行会打开我的编辑器，我必须手动添加/修改合并消息才能完成合并

当然，我可以在 'git merge' 中添加“-m”参数来避免调用编辑器，但是这种方法有点烦人。

有没有办法设置全局配置以自动生成合并提交？

这是打开编辑器时显示的消息：

> 请输入提交消息以解释为什么需要此合并，特别是如果它将更新的上游合并到主题分支中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:44:02.743

```
git merge --no-edit B 
```

或者

```
GIT_MERGE_AUTOEDIT=no git merge B 
```

这些都[记录](https://www.kernel.org/pub/software/scm/git/docs/git-merge.html)在`git merge`.

# visual-c++ - SFML 无法创建静态 sf::SoundBuffer* 类变量？

> ID：15263625
> 
> 赞同：0
> 
> 时间：2013-03-07T05:16:53.663
> 
> 标签：visual-c++, linker, sfml

我正在使用 SFML 的音频库。

在我的课堂上，我尝试使用一个私有静态变量来保存 SoundBuffer*，如下所示：

```
static sf::SoundBuffer* breakBlockBuffer; 
```

当我尝试构建时，这会导致链接器错误：

> Chunk.obj：错误 LNK2001：未解析的外部符号“私有：静态类 sf::SoundBuffer * Chunk::breakBlockBuffer”(?breakBlockBuffer@Chunk@@0PAVSoundBuffer@sf@@A) myprogram.exe：致命错误 LNK1120：1 个未解析的外部

但是，如果我将其声明为实例变量，则它可以工作：

```
sf::SoundBuffer* breakBlockBuffer; 
```

无论我是动态链接还是静态链接库，都会发生这种情况。它还在 SFML1.6 和 SFML2.0 中持续存在。

我觉得我可能犯了一些愚蠢的错误，因为我对 C++ 很生疏，但代码看起来对我来说应该没问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-15T14:23:39.537

如果你在你的类中声明一个静态变量，你还必须在你的源文件中定义它：

`foo.hpp`：

```
class foo
{
   static int bar;
}; 
```

`foo.cpp`：

```
int foo::bar; 
```

看起来你没有这样做。

# php - 如何重写网址？

> ID：15263628
> 
> 赞同：-7
> 
> 时间：2013-03-07T05:17:09.567
> 
> 标签：php, .htaccess, rewrite

我怎么能重写[www.nano.com](http://www.nano.com)

至

[www.nano.com/nano/index.php](http://www.nano.com/nano/index.php) 或 [www.nano.com/nano/](http://www.nano.com/nano/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T05:23:52.757

利用`.htaccess`

```
RewriteEngine On
RewriteRule ^nano/$ index.php [L] 
```

**已编辑**

如果你想访问你的子文件夹，那么你必须像下面这样制作 htaccess 文件

```
RewriteEngine on
RewriteCond %{HTTP_HOST} ^(www.)?yourdomain.com$ [NC]
RewriteCond %{REQUEST_URI} !^/nano/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /nano/$1
RewriteCond %{HTTP_HOST} ^(www.)?yourdomain.com$ [NC]
RewriteRule ^(/)?$ nano/index.php [L] 
```

# java - 如何从 HSSFWorkbook POI API 获取 excel 表“命名索引”区域的高度和宽度

> ID：15263636
> 
> 赞同：0
> 
> 时间：2013-03-07T05:18:13.717
> 
> 标签：java, excel, poi-hssf

如何获取**[名为范围](http://poi.apache.org/spreadsheet/quick-guide.html#NamedRanges)**区域的 Excel 工作表的高度和宽度`HSSFWorkbook POI API`。

我从谷歌获得了一份[参考资料](http://www.dummies.com/how-to/content/how-to-name-a-cell-or-range-in-excel-2010.html)，但无法获得 excel 表的命名索引区域的高度和宽度。

提前致谢。

是的，它是命名范围，并且需要命名范围获取的单元格的高度和宽度。下面的代码具有“print_area”命名范围，并且想要单元格的高度和宽度。

int namedCellIdx = workbook.getNameIndex("Print_Area"); HSSFName aNamedCell = workbook.getNameAt(namedCellIdx);

```
 // retrieve the cell at the named range and test its contents
    String a = aNamedCell.getReference();

    AreaReference aref = new AreaReference(aNamedCell.getRefersToFormula());
    CellReference[] crefs = aref.getAllReferencedCells();
    for (int i=0; i<crefs.length; i++) {
        Sheet s = workbook.getSheet(crefs[i].getSheetName());
        Row r = sheet.getRow(crefs[i].getRow());
        System.out.println(r.getHeight());

        System.out.println(sheet.getColumnWidth(crefs[i].getCol()));;

       //here want height and width of "Print_area" cells
        Cell c = r.getCell(crefs[i].getCol());
        System.out.println(c.getStringCellValue());

        // extract the cell contents based on cell type etc.
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T06:38:58.603

[在http://poi.apache.org/apidocs/index.html](http://poi.apache.org/apidocs/index.html)阅读 API 文档

具体来说，查看`org.apache.poi.ss.util.AreaReference`，您可以从中获取第一个和最后一个单元格引用并确定范围的大小。

但是，您必须处理一些特殊情况，例如整个列或整行的区域，甚至是不连续的区域。

# mysql - 如何在mysql中执行以下join？

> ID：15263650
> 
> 赞同：1
> 
> 时间：2013-03-07T05:19:23.313
> 
> 标签：mysql, sql, join

假设我有以下表格：

表A

```
id|first_name|sport
1 | alice | swimming
2 | bob | basketball
3 | casey | baseball 
```

表B

```
name | hobby
alice | running
bob | null 
```

我想得到一个类似于 tableA 但附加列的输出表：

```
id | first_name | sport | theirhobby
1 | alice | swimming | running
2 | bob | basketball | null
3 | casey | baseball | null 
```

请注意，names 列的名称从 tableA 中保留，并且附加到 tableA 的唯一新列是爱好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:20:43.240

```
SELECT  a.ID, a.first_name, a.sport,
        b.hobby
FROM    tableA a
        LEFT JOIN tableB b
            ON a.first_name = b.name 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/4f747/2)

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T07:43:11.320

希望您需要上述格式的数据，而不是表格。在这里，我已经提到了获取数据的查询，就像你问的那样

选择 a.id,a.first_name,a.sport,b.hobby 从`table1`a LEFT JOIN `table2`b ON a.first_name=b.name

只需在您的 phpmyadmin 中执行上述查询，然后在您的 php 代码中实现它希望它对您有帮助

# ruby-on-rails - Capistrano 不删除旧版本

> ID：15263655
> 
> 赞同：0
> 
> 时间：2013-03-07T05:19:34.700
> 
> 标签：ruby-on-rails, capistrano

我知道`keep_releases`capistrano 中的选项，我在我们的部署脚本中设置了这个选项。我遇到的问题是我认为更多与权限问题有关。我尝试运行`cap deploy:cleanup`，但在尝试删除`tmp/cache`. 我正在使用片段缓存，这就是为什么我里面有很多文件`tmp/cache`。

有人可以阐明如何解决此问题吗？我必须手动删除服务器中的文件夹才能清理发布文件夹。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:28:35.293

看起来我只需要通过 use_sudo

```
cap production deploy:cleanup -s use_sudo=true 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-24T04:49:33.490

我将尝试将目录的所有者更改为您用于 capistrano 的用户：

```
sudo chown -R capistrano_user /path/to/www/app 
```

# debugging - 修改 gstreamer 调试级别值

> ID：15263659
> 
> 赞同：1
> 
> 时间：2013-03-07T05:19:45.360
> 
> 标签：debugging, logging, enumeration, gstreamer

我想修改 gstreamer GstDebuglevel 枚举中的值（您可以在 gst/gstinfo.h 中找到它）。如果我只是更改 gstinfo.h 中的枚举值或者我是否必须进行任何其他修改，它会起作用吗？我想降低调试相关日志转储的优先级。我怎样才能实现以下目标。

我想要这样的东西：

```
typedef enum { 
GST_LEVEL_NONE = 0, 
GST_LEVEL_ERROR = 1, 
GST_LEVEL_WARNING = 2, 
GST_LEVEL_FIXME = 3, 
GST_LEVEL_INFO = 4, 
GST_LEVEL_LOG = 6, 
GST_LEVEL_TRACE = 7, 
/* add more */ 
GST_LEVEL_MEMDUMP = 9, 
/* add more */ 
GST_LEVEL_DEBUG = 10, 
GST_LEVEL_COUNT 
}GstDebugLevel; 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T19:57:12.997

更改枚举值并重建 gstreamer 就足够了。

我用这个枚举测试了它：

```
typedef enum {
  GST_LEVEL_NONE = 0,
  GST_LEVEL_ERROR,
  GST_LEVEL_WARNING,
  GST_LEVEL_INFO,
  GST_LEVEL_DEBUG=10,
  GST_LEVEL_LOG=5,
  GST_LEVEL_FIXME = 6,
  GST_LEVEL_TRACE = 7,
  /* add more */
  GST_LEVEL_MEMDUMP = 9,
  /* add more */
  GST_LEVEL_COUNT
} GstDebugLevel; 
```

并且它没有在相同的 GST_DEBUG 值上输出 DEBUG 级别的跟踪。

# javascript - 变量总是 NaN

> ID：15263662
> 
> 赞同：0
> 
> 时间：2013-03-07T05:19:51.703
> 
> 标签：javascript, data-structures, nan

我正在学习如何进入 JS（但对编程并不陌生）。所以，我试图实现一个 LinkedList 只是为了玩 JS。

它工作正常，除了`count`总是返回`NaN`。我用谷歌搜索过，并认为原因是我最初没有将其设置`count`为一个数字，但我做到了。

下面是我的代码：

```
function LinkedList() {
    var head = null,
        tail = null,
        count = 0;

    var insert = function add(data)
    {
        // Create the new node
        var node = {
                data: data,
                next: null
        };

        // Check if list is empty
        if(this.head == null)
        {
            this.head = node;
            this.tail = node;
            node.next = null;
        }
        // If node is not empty
        else
        {
            var current = this.tail;
            current.next = node;
            this.tail = node;
            node.next = null;
        }

        this.count++;
    };

    return {
        Add: insert,
    };
}

var list = new LinkedList();
list.Add("A");
list.Add("B"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:24:35.383

`this`in`this.count`指的是 LinkedList 对象的实例。那个部分：

```
var head = null,
    tail = null,
    count = 0; 
```

这些是私有变量，不被视为 LinkedList 对象的属性。

你想要做的是：

```
this.head = null;
this.tail = null;
this.count = 0; 
```

这将使您可以做一个 LinkedList 对象的`head`属性。`tail``count``this.count++`

*编辑：*要保持`head`, `tail`，`count`作为 LinkedList 对象的私有，您的其他代码将是这样的：

```
// Check if list is empty
    if(head == null)
    {
        head = node;
        tail = node;
        node.next = null;
    }
    // If node is not empty
    else
    {
        var current = tail;
        current.next = node;
        tail = node;
        node.next = null;
    }

    count++; 
```

还要记住，对象是*按引用传递的*。所以这适用于：

```
var current = tail;
current.next = node;
tail = node;
node.next = null; 
```

*更多：*如果您想`count`成为公共财产，那么不要返回：

```
 return {
        Add: insert,
    }; 
```

你需要这样做：

```
this.Add = insert;
return this; 
```

以便在创建对象时返回当前对象上下文。

# android - 以编程方式启动 DDMS

> ID：15263663
> 
> 赞同：-6
> 
> 时间：2013-03-07T05:19:54.573
> 
> 标签：android

我正在使用自动化。我想通过我的程序启动 DDMS 并以编程方式获取应用程序的堆转储。也就是说，我想通过程序进行转储，而不是单击堆转储按钮。这可能吗？如何？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:23:43.913

用于[`Debug.dumpHprofData(String)`](http://developer.android.com/reference/android/os/Debug.html#dumpHprofData%28java.lang.String%29)生[成堆转储](http://docs.oracle.com/javase/7/docs/technotes/samples/hprof.html)。

> 将“hprof”数据转储到指定文件。这可能会导致 GC。

不需要 DDMS。

# vsto - Installshield错误：“vstor40_x86.exe的校验和不正确”

> ID：15263664
> 
> 赞同：0
> 
> 时间：2013-03-07T05:19:58.253
> 
> 标签：vsto, md5, installshield, checksum, prerequisites

在尝试下载*Microsoft.VisualStudio.Tools.Applications.Runtime*时，您总是可以从*InstallShield 内部*`the checksum of vstor40_x86.exe is incorrect`重新分发。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:19:58.253

从文件夹文件夹中编辑“Microsoft VSTO 2010 Runtime.prq”：Program Files (x86)\InstallShield\2012Spring\SetupPrerequisites

修改属性：CheckSum="b6639489e159b854b6dc43d5cb539043" FileSize="0,40029664"

这些值可以从 C:\Program Files (x86)\InstallShield\2012Spring\SetupPrerequisites\VSTO 2010 Runtime\x86\vstor40_x86.exe 获得

CheckSum 是文件的 MD5 校验和。

此文件是在您上面遇到的失败校验和错误期间下载的。

现在您可以删除“VSTO 2010 Runtime”文件夹，单击 InstallShield 中的可再发行组件页面，然后再次下载。随着校验和现在匹配错误消失了。

请注意，可再发行组件可能会更改以修复某些安全错误或其他内容。这将更改 MD5 和文件大小并需要新的匹配值。要获取 md5 哈希，请谷歌一些方法。我最终得到了一些东西，它在 Windows 资源管理器中的文件属性中添加了一个“校验和”页面，其中包含各种校验和，以便您可以验证下载：[http ://code.kliu.org/hashcheck/](http://code.kliu.org/hashcheck/)

# javascript - jquery无限滚动双打印

> ID：15263668
> 
> 赞同：1
> 
> 时间：2013-03-07T05:20:38.627
> 
> 标签：javascript, infinite-scroll

所以我一遍又一遍地研究试图消除这个问题，但无济于事。我是 Javascript 的相对菜鸟。我遇到的问题是，当事件处理程序触发时，它会打印出我想要的 20 个新项目，但之前的 20 个项目也会在一次加载后冻结。非常感谢任何帮助这是代码：

**JAVASCRIPT功能：**

```
<script type="text/javascript">
    $(window).scroll(function(){
        if($(window).scrollTop() == $(document).height() - $(window).height()){
            $('div#loadMoreComments').show();
            $.ajax({
                url: "loadeR.php?lastComment=" + $(".postedComment:last").attr("id"),
                success: function(html){
                            if(html){
                                $("div#postedComments").append(html);
                                $("div#loadMoreComments").hide();
                            }else{
                                $("div#loadMoreComments").replaceWith("Showing All Comments!");
                            }
                        }
            });
        }
    });
</script> 
```

**附加页面 PHP：**

```
if($_GET['lastComment']){
    $NewAll = mysql_query('select*from scroll WHERE id < "'.$_GET['lastComment'].'" ORDER BY id DESC LIMIT 0,20');
    $a = mysql_num_rows($NewAll);
    for($i=0;$i<$a;$i++){
        $id = mysql_result($NewAll,$i,'id');
        $name = mysql_result($NewAll,$i,'name');
        $text = mysql_result($NewAll,$i,'text');
        echo "
            <div class='postedComment' id='$id postedComment'>
            <img src='prime1.jpg' id='userimage'/>
                <div id='rightcontainer'>
                    <div id='walluser'>User Name $id</div>
                    <div id='wallcontent'>Comment/Content $name</div>
                    <div id='walltime'>Time posted $text</div>
                </div>
            </div>
        ";  

    }
} 
```

**已加载初始 DIV**

```
<div id="postedComments">
    <?php
        $All = mysql_query('select*from scroll ORDER BY id DESC LIMIT 0,20');
        //SELECT * FROM [insert table name] ORDER BY [insert unique counter] DESC LIMIT 0,[MAX #]
        $a = mysql_num_rows($All);
        for($i=0;$i<$a;$i++){
            $id = mysql_result($All,$i,'id');
            $name = mysql_result($All,$i,'name');
            $text = mysql_result($All,$i,'text');
            echo "
                    <div class='postedComment' id='$id postedComment'>
                        <img src='prime1.jpg' id='userimage'/>
                        <div id='rightcontainer'>
                            <div id='walluser'>User Name $id</div>
                            <div id='wallcontent'>Comment/Content $name</div>
                            <div id='walltime'>Time posted $text</div>
                        </div>
                    </div>
                "; 
        }

    ?>
</div>
<div id='loadMoreComments' style="display:none;"><img src="js/loadwheel.gif"/></div> 
```

# ios - 打电话后iOS应用布局发生变化

> ID：15263672
> 
> 赞同：1
> 
> 时间：2013-03-07T05:20:52.567
> 
> 标签：ios, layout, resize, phone-call

如果我在使用我的应用程序时接到电话，视图会向下一点，以便为顶部的呼叫状态栏腾出空间。

通话结束后，视图将保持这种“已更改”状态。如何强制应用程序自行调整大小？目前我必须终止应用程序并重新启动。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T06:06:27.317

你有任何覆盖的自定义视图`-layoutSubviews`吗？

根据我的经验，这意味着您有一个使用自定义布局`-layoutSubviews`但不会`-setNeedsLayout:`在适当时间调用的视图；通常[设置框架不会强制布局](https://stackoverflow.com/questions/7921610/why-might-layoutsubviews-not-automatically-be-called-on-a-view-when-its-frame-is)（自动布局的处理方式不同）。

在覆盖的任何视图中`-layoutSubviews`，请尝试以下操作：

```
-(void)setFrame:(CGRect)frame
{
  CGRect oldFrame = self.frame;

  // This check changes behaviour slightly:
  //   v.frame = v.frame;
  // no longer cancels animations.
  // Sometimes this works around an animation glitch.
  if (!CGRectEqualToRect(frame,oldFrame))
  {
    [super setFrame:frame];
    if (!CGSizeEqualToSize(frame.size,oldFrame.size))
    {
      // Only layout if the size changes.
      [self setNeedsLayout];
    }
  }
} 
```

（你可以做同样的事情，`-setBounds:`但它通常是不必要的，因为 AFAIK 它不会被 UIKit 调用，除了`UIScrollView`.）

# java - 在客户端使用 Web 服务时如何解决由于无效元素导致的 SAX 异常？

> ID：15263688
> 
> 赞同：1
> 
> 时间：2013-03-07T05:21:46.387
> 
> 标签：java, web-services, sax

我有一个用 java 编写的 Web 服务客户端。由于添加到现有复杂类型字段的额外字段，服务器端的 WSDL 发生了变化。但是我的客户端有不知道该字段的陈旧 WSDL，因此当有 Web 服务调用时，由于缺少该字段，会出现 SAX 异常。我可以在客户端做些什么来获取其他元素吗？忽略一个不符合我拥有的客户端代码的元素？

编辑：通常当 WSDL 发生更改时，应将其传达给客户端，但在某些情况下未传达更改时，系统应保持正常运行。因此需要变通。

# c# - 在不使用当前 DataContext 的情况下显式绑定到对象

> ID：15263694
> 
> 赞同：0
> 
> 时间：2013-03-07T05:22:16.993
> 
> 标签：c#, wpf, data-binding, datacontext

**描述：**

我有一些视图`DataContext`已经设置为一些列表。

我也有一个`ComboBox`应该触发一个可见性事件到一个`StackPanel`. 它是通过实现`INotifyPropertyChanged`.

**问题：**

属性“SelectedVisibility”不是类的一部分，`DataContext`而是在一个`ViewModel`类中，我找不到任何方法来明确绑定我的 ViewModel 以访问该属性。

**问题：**

*您知道我如何将我的 VM 明确定义为 ComboBox 中 SelectedValue 绑定的 DataContext 吗？*

**代码详情：**

查看 XAML：

```
<ComboBox ItemsSource="{Binding Source={StaticResource VisibilityEnum}}" SelectedValue="{Binding Path=SelectedVisibility}"/>

<StackPanel Visibility="{Binding Path=SelectedVisibility,Converter={StaticResource SelectedValueToVisible}}"> 
```

查看后面的代码：

```
public Counterparties_UserInputs()
{
    // Cannot bind this as already bound
    // this.DataContext = _VM;
    InitializeComponent();
} 
```

查看型号：

```
public event PropertyChangedEventHandler PropertyChanged;

public string SelectedVisibility
{
    get 
    {
        return _selectedVisibility; 
    }
    set
    {
        _selectedVisibility= value;
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs("SelectedVisibility"));
        }
    }
} 
```

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T06:53:35.483

您可以向视图添加新的依赖属性，将视图模型绑定到此属性，然后将此属性用作 StackPanel 和 ComboBox 的 DataContext。例如（“this”是您的视图的名称，“AdditionalContext”是您声明用于存储您的视图模型的依赖属性）：

```
<StackPanel DataContext="{Binding AdditionalContext, ElementName=this}" Visibility="{Binding Path=SelectedVisibility, Converter={StaticResource SelectedValueToVisible}}"/> 
```

但是你不应该这样做，因为它违反了 MVVM 模式。viewmodel 的全部观点是您将其用作视图的 DataContext。解决您的问题的正确方法是将列表声明移至您的视图模型。

# android - Android 文本视图高度动态变化

> ID：15263698
> 
> 赞同：0
> 
> 时间：2013-03-07T05:22:22.000
> 
> 标签：android, android-layout

我在`TextView`动态设置高度时遇到问题。我的`xml`文件是

```
<TextView
        android:id="@+id/rateUpdateTime"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:paddingBottom="0dp"
        android:text="@string/update_time"
        android:textColor="#000000"
        android:textStyle="bold" 
        android:textSize="13sp"
        android:layout_weight=".48"
        android:layout_gravity="center_horizontal"
        android:gravity="center_horizontal"
        android:background="#5FB6CB"

        /> 
```

在此`TextView`，我根据我的活动中发生的操作设置不同的消息。所以我需要`wrap_content`动态设置高度。我也在`LinearLayout`. 这`TextView`属于这个单曲`LinearLayout`。请任何人帮助我动态设置`TextView`高度= `LinearLayout`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T06:04:58.463

在 .java 代码中设置 Layout 参数的值可以解决这个问题。请参阅[此](http://developer.android.com/reference/android/view/ViewGroup.LayoutParams.html)文档。

# javascript - 如何在 Rails UJS 响应中使用 javascript 函数

> ID：15263703
> 
> 赞同：1
> 
> 时间：2013-03-07T05:22:54.933
> 
> 标签：javascript, ruby-on-rails-3, function, ujs

我发现自己有很多相同的代码，`js responses`例如调整高度，以及同一类的一些颜色等。

有没有办法将所有重复项放在一个函数中，然后在每个 js 响应中调用该函数？如果是这样，怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:24:31.097

在咖啡脚本中，您可以使用创建一个全局函数

```
@adjustHeights = (arg1, arg2) ->
  ... code here 
```

然后只需在 js 模板中调用它

# jython - 时间戳为 31/12/9999 23:59:29

> ID：15263705
> 
> 赞同：0
> 
> 时间：2013-03-07T05:23:01.087
> 
> 标签：jython

请看下面的描述，让我知道为什么 31/12/9999 23:59:29 的时间戳不是 253402264799，而是 253402261199。

非常感谢，

休伊

```
import datetime
d1 = datetime.datetime(1970, 1,1,10,0,0)  ; I am in zone time 10
d2 = datetime.datetime(1970, 1,2,23,59, 59)
print d2 - d1 --> 1 day, 13:59:59  
convert 1 day, 13:59:59 to sec
= 136799s  <-- (48 + 14) * 3600 - 1

d1 = datetime.datetime(1970, 1,1,10,0,0)
d2 = datetime.datetime(9999, 12, 31, 23, 59, 59)  
print d2 - d1 --> 2932896 days, 13:59:59 
convert 2932896 days, 13:59:59 to sec
253402264799sec <-- (2932896 * 24 + 14) * 3600 - 1

print datetime.datetime.fromtimestamp(253402264799) --> exception throw

print datetime.datetime.fromtimestamp(253402261199) --> 31/12/9999 23:59:59 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T21:30:48.270

原因是时间夏令时。夏令时 10 区提前 11 小时。

# mysql - 为图书应用程序设计数据库

> ID：15263706
> 
> 赞同：1
> 
> 时间：2013-03-07T05:23:00.833
> 
> 标签：mysql, database, database-design

我正在为书籍应用程序设计数据库。我有主表**Books**，它的子表是**Chapters**， chapters 子表是**Sections**，所以这里的问题是，有些章节也分为 3 个步骤**章节名称 -> 第 1 部分 -> 第 1 部分** ，每章都包含部分和部分还分为进一步的 3 个步骤**Section -> sub Sections**。

问题：我如何管理章节的部分和分区，因为每章都有其部分和分区并不是强制性的，同样的问题是针对节的，因为有些节有子节，有些节没有。

下面我提到这本书的结构。

```
Book Name:
    Chapter 1
        section 1
        section 2
    Chapter 2
        Part 1
            Division 1
                Section 1
                section 2
                    sub section 2(1)
                    sub section 2(2)
            Division 2
                section 1
                section 2
            Division 3
                section 1
                section 2
        Part 2
            section 1
            section 2
    Chapter 3
        section 1
        section 2 
```

那么我怎么能在mysql中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:27:36.747

由于没有具体的结构，我会为

书籍（书籍详情）

和

BookPart（部分详细信息，类型 - 例如部分，部门，章节，父书部分）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:30:49.197

我建议的结构 -

```
Books 
Chapters -> contain section
section ->  Division,Part (Division,Part can be null)
sub section -> section 
```

或者

```
Books 
Chapters -> contain section,Division,Part,subsectionID (Division,Part can be null)
sub section -> section 
```

样本数据

**图书**

> 第一册

**章节**

```
id  bookID   name        sectionid        
  1 |      | Chapter 1 |  1 
  2 |      | Chapter 1 |  2
  3 |      | Chapter 2 |  3 
```

**部分**

```
id | name      | Division   | part   |Sub id (zero or one )
1  | section 1 | null       | null   | 
3  | Section 1 | Division 1 | Part 1 | 
```

**小节**

```
 id | name  
    | sub section 2 
```

您可以按照这种方式或

表结构2：

**章节**

```
id   bookID    name        section      part     division     sub cat Id 
  1 |  1     | Chapter 1 |  section 1 | null   | null       |  null
  2 |  1     | Chapter 1 |  section 2 | null   | null       |  null
  3 |  1     | Chapter 2 |  section 1 | Part 1 | Division 1 |  1 
```

**小节** 编号 | 姓名

```
 1  | sub section 2 
```

根据您的可用数据，您可以决定哪一个更适合您。你最好画出图表并决定你的表格结构。因为通过这种方式，您可以根据您的要求轻松规范您的表格

# android - 如何为 Crouton Toast 内的按钮设置侦听器并使用该按钮清除 Crouton Toast？

> ID：15263710
> 
> 赞同：1
> 
> 时间：2013-03-07T05:23:29.943
> 
> 标签：android, crouton

我有一个应用程序，它在操作栏下方显示吐司。我正在使用 Crouton 库来显示吐司。在这里，我为 toast 放置自定义布局，该布局包含一个 textview 和一个按钮（用于关闭选项）。所以 Toast 出现了按钮。如果我单击它应该关闭 toast 但没有任何反应.. 下面是这个例子的代码。任何帮助表示赞赏

## MainActivity.java

```
public class MainActivity extends SherlockActivity implements OnClickListener {

private View customToastView;
private TextView customToastMessageView;
private Button customToastCloseButton;
private Button doneButton;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    doneButton = (Button) findViewById(R.id.done_button);
    customToastView = getLayoutInflater().inflate(R.layout.toast_custom_layout, null);
    customToastMessageView = (TextView) customToastView.findViewById(R.id.messages);
    customToastCloseButton = (Button) customToastView.findViewById(R.id.close_button);
    customToastCloseButton.setOnClickListener(this);
    doneButton.setOnClickListener(this);
}

@Override
public void onClick(View v) {

    switch (v.getId()) {
        case R.id.done_button:
            Crouton.cancelAllCroutons();
            customToastMessageView.setText("Message");
            Crouton.show(this, customToastView);
            break;
        case R.id.close_button:
            Crouton.cancelAllCroutons();
            break;
      }
  }
} 
```

## toast_custom_layout.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <TextView
        android:id="@+id/messages"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:layout_marginLeft="26dp"
        android:text="Large Text"
        android:textAppearance="?android:attr/textAppearanceLarge" />

    <Button
        android:id="@+id/close_button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true"
        android:layout_marginRight="23dp"
        android:text="Button" />

</RelativeLayout> 
```

## activity_main.xml

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<Button
    android:id="@+id/done_button"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="146dp"
    android:text="Button" />

</RelativeLayout> 
```

# jquery - 如何创建用户设置下拉菜单？

> ID：15263711
> 
> 赞同：-3
> 
> 时间：2013-03-07T05:23:32.717
> 
> 标签：jquery, html, css

我正在尝试创建一个与右侧的 facebook 和 google 具有相似设计的用户设置下拉菜单，但我不确定如何。在所附图片中，您可以找到我想要完成的任务......非常感谢任何帮助

![](../Images/ebc443adc5cdef51e8c2a9aff3bf070d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T02:27:00.067

好吧，我想我是按照我想要的风格做的

```
enter code here

  <div class="container">

            <div class="wrapper-demo">

                <div id="dd" class="wrapper-dropdown-5" tabindex="1">
                    <div id="image">    </div>
                    <ul class="dropdown">
                        <li><a href="#"><i class="icon-user"></i>Profile</a></li>
                        <li><a href="#"><i class="iconcog"></i>Settings</a></li>
                        <li><a href="#"><i class="icon-remove"></i>Logout</a></li>
                    </ul>
                </div>
            </div>

    </div>

enter code here

*,
*:after,
*:before {
-webkit-box-sizing: border-box;
-moz-box-sizing: border-box;
box-sizing: border-box;
padding: 0;
margin: 0;
}

.wrapper-demo {
margin: 60px 0 0 0;
*zoom: 1;
font-weight: 400;
}

 .wrapper-dropdown-5 {
/* Size & position */
position: relative;
width: 100px;
margin: 0 auto;
padding: 12px 15px;
height: 50px;
/* Styles */
background: #2F3B31;
border-radius: 0px;
box-shadow: 0 1px 0 rgba(0,0,0,0.2);
cursor: pointer;
outline: none;
-webkit-transition: all 0.3s ease-out;
-moz-transition: all 0.3s ease-out;
-ms-transition: all 0.3s ease-out;
-o-transition: all 0.3s ease-out;
transition: all 0.3s ease-out;
 }
#image
{ 
width:45px;
height:46px;
border:solid #666;
border-radius:5px;
-moz-border-radius: 5px;
background-image: url("http://i.imgur.com/kLz97bG.png?1");
-webkit-border-radius:5px;
margin-top:-10px;
margin-left:-8px;
}

 .wrapper-dropdown-5:after { /* Little arrow */
content: "";
width: 0;
height: 0;
position: absolute;
top: 50%;
right: 15px;
margin-top: -3px;
border-width: 6px 6px 0 6px;
border-style: solid;
border-color: #9F9F9F transparent;

 }

 .wrapper-dropdown-5 .dropdown {
/* Size & position */
position: absolute;
top: 100%;
left: 0;
right: 0;

/* Styles */
background: #9F9F9F;
border-radius: 0px;
border: 1px solid rgba(0,0,0,0.2);
border-top: none;
border-bottom: none;
list-style: none;
-webkit-transition: all 0.3s ease-out;
-moz-transition: all 0.3s ease-out;
-ms-transition: all 0.3s ease-out;
-o-transition: all 0.3s ease-out;
transition: all 0.3s ease-out;

/* Hiding */
max-height: 0;
overflow: hidden;
   }
.dropdown
{ 
width:200px;
 }

  .wrapper-dropdown-5 .dropdown li {
  padding: 0 10px ;

  }

 .wrapper-dropdown-5 .dropdown li a {

  display: block;
  text-decoration: none;
  color: #333;
  padding: 10px 0;
  transition: all 0.3s ease-out;
  border-bottom: 1px solid #e6e8ea;
  }

 .wrapper-dropdown-5 .dropdown li:last-of-type a {
 border: none;
 }

 .wrapper-dropdown-5 .dropdown li i {
  width:200px;
 margin-right: 5px;
 color: inherit;
 vertical-align: middle;
 }

 /* Hover state */

.wrapper-dropdown-5 .dropdown li:hover a {
color: #FFFFFF;

 }

/* Active state */

.wrapper-dropdown-5.active {
 border-radius: 0px 0px 0 0;
 background: #949594;
 box-shadow: none;
 border-bottom: none;
 color: white;
  }

 .wrapper-dropdown-5.active:after {
 border-color: #82d1ff transparent;
  }

 .wrapper-dropdown-5.active .dropdown {
  border-bottom: 1px solid rgba(0,0,0,0.2);
  max-height: 400px;
  } 
```

js

```
enter code here
        function DropDown(el) {
            this.dd = el;
            this.initEvents();
        }
        DropDown.prototype = {
            initEvents : function() {
                var obj = this;

                obj.dd.on('click', function(event){
                    $(this).toggleClass('active');
                    event.stopPropagation();
                }); 
            }
        }

        $(function() {

            var dd = new DropDown( $('#dd') );

            $(document).click(function() {
                // all dropdowns
                $('.wrapper-dropdown-5').removeClass('active');
            });

        }); 
```

工作示例[jsFiddle](http://jsfiddle.net/dajin007/ML5Z9/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T05:30:15.983

参考这个链接：

[http://www.9lessons.info/2012/06/simple-drop-down-menu-with-jquery-and.html](http://www.9lessons.info/2012/06/simple-drop-down-menu-with-jquery-and.html)

Javascript代码：

```
<script type="text/javascript" >
$(document).ready(function()
{

$(".account").click(function()
{
var X=$(this).attr('id');
if(X==1)
{
$(".submenu").hide();
$(this).attr('id', '0'); 
}
else
{
$(".submenu").show();
$(this).attr('id', '1');
}

});

//Mouse click on sub menu
$(".submenu").mouseup(function()
{
return false
});

//Mouse click on my account link
$(".account").mouseup(function()
{
return false
});

//Document Click
$(document).mouseup(function()
{
$(".submenu").hide();
$(".account").attr('id', '');
});
});
</script> 
```

html代码：

```
<div class="dropdown">
<a class="account" >My Account</a>

<div class="submenu">
<ul class="root">
<li ><a href="#Dashboard" >Dashboard</a></li>
<li ><a href="#Profile" >Profile</a></li>
<li ><a href="#settings">Settings</a></li>
<li ><a href="#feedback">Send Feedback</a></li>
</ul>
</div>

</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T13:13:53.697

尝试这个。

CSS

```
html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
  font-size: 100%;
  font: inherit;
  vertical-align: baseline;
  outline: none;
  -webkit-box-sizing: border-box;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}
html { height: 101%; }
body { background: #dde9f0; font-family: Arial, Tahoma, sans-serif; font-size: 62.5%; line-height: 1; padding-bottom: 65px; }

article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section { display: block; }
ol, ul { list-style: none; }

blockquote, q { quotes: none; }
blockquote:before, blockquote:after, q:before, q:after { content: ''; content: none; }
strong { font-weight: bold; } 

table { border-collapse: collapse; border-spacing: 0; }
img { border: 0; max-width: 100%; }

h1 { display: block; font-size: 2.75em; line-height: 2.35em; color: #7291a5; margin-bottom: 12px; font-weight: normal; font-family: 'Oldenburg', 'Trebuchet MS', Arial, sans-serif; text-shadow: 0px 1px 1px #fff; text-align: center; }

p { font-size: 1.2em; font-weight: normal; line-height: 1.35em; color: #343434; margin-bottom: 12px; }

/* page container */
#wrap { display: block; width: 850px; margin: 0 auto; padding-top: 35px; }

/* user menu settings */
#dropdown { 
  display: block;
  padding: 13px 16px;
  width: 266px;
  margin: 0 auto;
  position: relative;
  cursor: pointer;
  border-left: 4px solid #739cda;
  background: #fff;
  font-size: 1.55em;
  color: #656565;
  font-weight: normal;
  -webkit-box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  -moz-box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  -webkit-transition: all 0.15s linear;
  -moz-transition: all 0.15s linear;
  -ms-transition: all 0.15s linear;
  -o-transition: all 0.15s linear;
  transition: all 0.15s linear;
}
#dropdown:hover { color: #898989; }

#dropdown.open {
  background: #5a90e0;
  color: #fff;
  border-left-color: #6c6d70;
}

#dropdown ul { 
  position: absolute;
  top: 100%;
  left: -4px; /* move content -4px because of container left border */
  width: 266px;
  padding: 5px 0px;
  display: none;
  border-left: 4px solid #8e9196;
  background: #fff;
  -webkit-box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  -moz-box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
}
#dropdown ul li { font-size: 0.9em; }

#dropdown ul li a { 
  text-decoration: none;
  display: block;
  color: #447dd3;
  padding: 7px 15px;
}
#dropdown ul li a:hover {
  color: #6fa0e9;
  background: #e7f0f7;
} 
```

HTML标记

```
<!doctype html>
<html lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <title>User Settings Dropdown Menu</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<!--[if lt IE 9]>
  <script type="text/javascript" src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
</head>

<body>
  <div id="wrap">
    <h1>Stylish User Settings Menu</h1>

    <div id="dropdown" class="ddmenu">
      User Settings
      <ul>
        <li><a href="#">My Profile</a></li>
        <li><a href="#">Friend Requests</a></li>
        <li><a href="#">Account Settings</a></li>
        <li><a href="#">Support</a></li>
        <li><a href="#">Log Out</a></li>
      </ul>
    </div>
  </div>
<script type="text/javascript">
$("#dropdown").on("hover", function(e){
  e.preventDefault();

  if($(this).hasClass("open")) {
    $(this).removeClass("open");
    $(this).children("ul").slideUp("fast");
  } else {
    $(this).addClass("open");
    $(this).children("ul").slideDown("fast");
  }
});
</script>
</body>
</html> 
```

检查 JSFiddle：http: [//jsfiddle.net/EhgsF/](http://jsfiddle.net/EhgsF/)

# ms-access-2007 - 如何在没有值的表中找到下一条记录？

> ID：15263712
> 
> 赞同：1
> 
> 时间：2013-03-07T05:23:35.977
> 
> 标签：ms-access-2007

**在Access**中需要帮助。也许这对你来说很简单而且很容易，但我不知道该怎么做。我对此不是很熟悉，只是想为`in/out`. 如何找到下一条没有注销的记录？我的查询总是只寻找第一条记录，我希望它去寻找下一条记录为空注销。

提前致谢。

这是表。

```
Log Number  Staff Number    Sign-in  Sign-out
1   65294   3/6/2013 4:02:29 PM 3/7/2013 7:33:26 AM
2   007 3/6/2013 4:02:33 PM 3/7/2013 7:40:18 AM
3   4006381333627   3/6/2013 4:02:37 PM 3/7/2013 7:33:06 AM
4   4005401881216   3/6/2013 4:02:40 PM 3/7/2013 7:33:12 AM
5   4006381333689   3/6/2013 4:02:44 PM 3/7/2013 7:33:02 AM
34  007 3/7/2013 4:33:35 AM 
```

代码：

```
Private Sub Combo18_Click()
Dim rs As Object

Set rs = Me.Recordset.Clone

rs.FindFirst "[Log Number] = " & Str(Nz(Me![Combo18], 0))

If Not rs.EOF Then Me.Bookmark = rs.Bookmark

If IsNull(Sign_out) Then
    Me.Sign_out.Value = Now()
    End If

DoCmd.RunCommand acCmdSaveRecord
Me.Combo18.SetFocus
Me!Combo18 = Null

End Sub 
```

# javascript - Analytics + Facebook 跟踪 document.getElementsByTagName('script')[0] 的 Javascript 问题

> ID：15263723
> 
> 赞同：1
> 
> 时间：2013-03-07T05:24:34.637
> 
> 标签：javascript, facebook, e-commerce, analytics

我试图通过将 Facebook 的跟踪代码与 Analytics 放在同一页面上来了解代码中是否存在冲突，因为这行出现在两个脚本中：

```
document.getElementsByTagName('script')[0] 
```

下面是相关代码：

```
<head>
  <link rel="stylesheet" type="text/css" href="stylesheet.css">

  <!---- START OF FACEBOOK TRACKING SCRIPT  -->
  <script type="text/javascript">
    var fb_param = {};
    fb_param.pixel_id = '6008770441xxx';
    fb_param.value = '123.00';
    (function(){
      var fpw = document.createElement('script');
      fpw.async = true;
      fpw.src = '//connect.facebook.net/en_US/fp.js'; 
```

这条线在这里：

```
 var ref = document.getElementsByTagName('script')[0];
      ref.parentNode.insertBefore(fpw, ref);
    })();
   </script>
   <noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/offsite_event.php?id=600877044xxx&amp;value=0" /></noscript>

  <!---- START OF ANALYTICS TRACKING SCRIPT  -->
   <script type="text/javascript">
     var _gaq = _gaq || [];
     _gaq.push(['_setAccount', 'UA-2725xxx-3']);
     _gaq.push(['_trackPageview']);
     _gaq.push(['_addTrans',
       '456',       // order ID - required
       'xxx', // affiliation or store name
       '123', // total - required
       '',    // tax
       '10',  // shipping
       ',     // city
       '',    // state or province
       'Australia' // country
     ]);      
  _gaq.push(['_trackTrans']); //submits transaction to the Analytics servers

  (function() {
    var ga = document.createElement('script'); 
    ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; 
```

这条线再次：

```
 var s = document.getElementsByTagName('script')[0]; 
    s.parentNode.insertBefore(ga, s);
  })();

  </script>
</head> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:45:08.283

请参考该行之后的下一行，

```
var s = document.getElementsByTagName('script')[0]; 
s.parentNode.insertBefore(ga, s); 
```

现在，这将在 First CHild Place 中插入元素，并且谁是第一个将成为第二个，

所以这只是在运行时插入脚本，根本不会冲突

:)

# php - php检查空数组

> ID：15263725
> 
> 赞同：1
> 
> 时间：2013-03-07T05:24:45.043
> 
> 标签：php

提交表单后，我想检查数组是否为用户的空警报错误。但是提交表单时出现错误：

**PHP**

```
 $errors = array_filter($_POST['session']);
    if (!empty($errors)) {
        foreach ($_POST['session'] as $value) {
            $session.=$value.',';
        }
        $session=substr($session, 0 , -1);
    }

Warning: array_filter() expects parameter 1 to be array, null given in C:\inetpub\wwwroot\manage\test_bank\index.php on line 729 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:27:22.950

在进行任何数组操作之前，您需要检查它是否为数组。

```
if(is_array($_POST['session'])){
  $errors = array_filter($_POST['session']);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T05:26:30.560

出现警告是因为 array_filters() 需要将数组传递给它。在将 $_POST['session'] 传递给这个函数之前，如果它是一个数组：

```
if(is_array($_POST['session'])) {
    $errors = array_filter($_POST['session']);
    // continue on
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:27:52.667

用于`is_array`检查天气是否为数组。

```
echo is_array($_POST['session']); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T05:28:20.817

这是因为 $_POST 不是一个数组，我猜你正在寻找这个：

`$errors = array_filter($_POST);`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-07T05:30:59.707

以下将最简单地检查空错误与否

```
!empty($_POST['session']) 
```

如果您没有在没有错误的情况下在 $_POST['session'] 中填充空条目，则可以工作。为什么需要array_filter？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-07T05:32:00.583

将其更改为`array_filter($_POST)`因为 $_POST 是一个 assoc 数组，或者在 array_filter() 之前`$_POST['session']`使用此行检查是否是一个数组。`is_array($_POST['session'])`在使用数组函数之前，您应该首先检查您正在使用的变量是否是一个数组。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-07T05:34:17.930

$_POST 是一个数组，但这里 $_POST['session'] 不是。

你可以试试这个：

```
if(isset($_POST['session']))
{
    //do your stuff
} 
```

# c# - 无法将方法组“EmIsNull”转换为非委托类型“bool”。您是否打算调用该方法？

> ID：15263731
> 
> 赞同：0
> 
> 时间：2013-03-07T05:25:03.810
> 
> 标签：c#

```
public static class MyExtention
{
    public static bool EmIsNull<T>(this T obj)
    {
        return (obj == null);
    }
} 
```

// 在主类中使用

```
if(dataGridView1["IP", i].Value.EmIsNull) 
```

//然后得到错误信息

错误 1：无法将方法组“EmIsNull”转换为非委托类型“bool”。您是否打算调用该方法？

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:26:13.070

您`()`最后缺少功能括号。

```
if(dataGridView1["IP", i].Value.EmIsNull()) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-16T10:26:26.050

是的，它是一种方法，并且在 if 条件下您需要提及使用函数括号 ()。

请参阅下面的示例

```
private bool Validation()
        { 
         foreach ( RadioButton rbtn in filetypepnl.Controls)
         {
         if(rbtn.Checked)
         {
             return true;
         }
         }
         return false;
        } 
```

使用

```
if(Validation())
 {
   if (ofd.ShowDialog() == DialogResult.OK){ }
 } 
```

# wpf - WPF ListView 的高度

> ID：15263732
> 
> 赞同：0
> 
> 时间：2013-03-07T05:25:10.673
> 
> 标签：wpf, listview, wpf-controls, height

我有一个`Grid`包含`ListView`：

```
<Grid >
 <Grid.RowDefinitions>
  <RowDefinition />
    ...
  </Grid.RowDefinitions>
  <ListView Grid.Row="0">
   <ListViewItem >
    ...
   </ListViewItem>

   ...

 </ListView>
</Grid> 
```

并且`ListView`变得比所有物品都高，它占用了所有可用空间。

如何使它`ListView`与它所包含的所有东西一样高`ListViewItems`（即使它的高度等于它们的高度之和）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:44:07.797

如果你没有`Height`在`MinHeight`你的`ListView`.

**编辑：** 要解决 ListView 占用所有可用空间的情况，您可以设置水平和垂直对齐方式。我在示例中使用了“中心”设置，但“左”或“右”也有效。

```
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition></RowDefinition>
    </Grid.RowDefinitions>
    <ListView Grid.Row="0" BorderThickness="2" HorizontalAlignment="Center" VerticalAlignment="Center">
        <ListViewItem>Item 1</ListViewItem>
        <ListViewItem>Item 2</ListViewItem>
        <ListViewItem>Item 3</ListViewItem>
    </ListView>
</Grid> 
```

另一种可能的解决方案是在您的窗口上设置 SizeToContent。

但请注意，如果您有多个父容器包装您的 ListView，并且您在这些容器上手动设置对齐或大小属性，则此解决方案可能无法按预期工作。

您可以查看此[链接](http://www.wpftutorial.net/LayoutProperties.html)以了解有关布局如何在 xaml 中工作的更多信息。

# ios6 - AdColony 2.0 iOS

> ID：15263736
> 
> 赞同：1
> 
> 时间：2013-03-07T05:25:18.190
> 
> 标签：ios6

这是我得到的：架构 i386 的未定义符号：“_CMTimeMake”，引用自：libAdColony.a(ADCVideo.o) 中的 -[ADCVideo replay] -libAdColony.a(ADCVideo.o) 中的 [ADCVideo resume] -[ADCVideo setupPlayer ] 在 libAdColony.a(ADCVideo.o) "_kCMTimeZero" 中，引用自： -[ADCVideo replay] in libAdColony.a(ADCVideo.o) -[ADCVideo resume] in libAdColony.a(ADCVideo.o) -[ADCVideo setupPlayer]在 libAdColony.a(ADCVideo.o) ld：未找到架构 i386 的符号 clang：错误：链接器命令失败，退出代码为 1（使用 -v 查看调用）

我正在尝试设置新的 sdk。只需取出旧的 sdk 文件（来自以前的版本），然后放入新的。库和链接看起来没问题，或者按照指南进行设置。还能是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:30:05.937

这些功能来自 CoreMedia 框架。确保您正在链接 CoreMedia 框架。

# symfony - Symfony2 404 页面加载需要几分钟

> ID：15263740
> 
> 赞同：0
> 
> 时间：2013-03-07T05:25:46.243
> 
> 标签：symfony

最近更改的域的服务器。当你遇到 404 错误页面时运行 Symfony2 至少需要 2 分钟才能加载。其他页面通常需要不到 3 秒的时间。任何线索可能导致这种情况？

# android - 如何在 Jake Wharton 的 TitlePageIndicator 中设置字体？

> ID：15263750
> 
> 赞同：1
> 
> 时间：2013-03-07T05:26:39.423
> 
> 标签：android, actionbarsherlock, android-viewpager, typeface

在我的应用程序中，我使用 Jake Wharton 的 TitlePageIndicator。我想知道我们是否可以将字体设置为 TitlepagerIndicator。

这是xml，

```
<com.viewpagerindicator.TitlePageIndicator
     android:id="@+id/indicatortitle"
     android:layout_width="fill_parent"
     android:layout_height="wrap_content"
     android:layout_marginBottom="10dp"
     android:padding="10dip"
     app:selectedColor="#000"
     android:textColor="#a0a0a0"
     android:textSize="25dp" /> 
```

在主要活动中，

```
 TitlePageIndicator indicator = (TitlePageIndicator)findViewById(R.id.indicatortitle);
indicator.setViewPager(mViewPager);
    indicator.setFooterIndicatorStyle(IndicatorStyle.Triangle); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T05:35:48.887

如果您查看代码 TitlePageIndicator.java，您会发现它扩展了 View 并覆盖了 setTypeface() 方法，所以是的。

只做：indicator.setTypeface(your_typeface);

# c# - 图像按钮事件未在 C# 中触发

> ID：15263753
> 
> 赞同：0
> 
> 时间：2013-03-07T05:26:49.210
> 
> 标签：c#, asp.net

我正在使用下面的代码来验证和处理其他一些操作。在脚本中，我检查余额金额和支付金额。支付金额不超过余额金额意味着它返回错误消息。然后 else 部分不会重定向到我在按钮单击事件后面的代码。我找不到它。请帮我解决这个问题。

```
 if (ddl_selected == "ebal") {
    var cust_balance = document.getElementById('<%= lbl_balance.ClientID %>');
    var cust_ramount = document.getElementById('<%= lbl_amount.ClientID %>');

            if (cust_balance.innerHTML <= cust_ramount .innerHTML) {
                alert('Error Alert : You don\'t have enough balance.!.');
                return false;
            }
            else {
                return true;
            }

        }

   <asp:ImageButton ID="btn_activate" runat="server" OnClick="btn_pay_Click"
     OnClientClick="return valid_details();"
     ImageUrl="~/Images/pay.png" />

protected void btn_pay_Click(object sender, ImageClickEventArgs e)
{
  //Event not fire 
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:53:03.413

改变

`OnClientClick="javascript:valid_details();return true;"`代替

```
OnClientClick="return valid_details();" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T08:16:56.967

使用 OnClientClick="javascript:return valid_details(); 而不是 OnClientClick="return valid_details();

# javascript - 为什么我的循环只看到第一个数组元素的值？

> ID：15263755
> 
> 赞同：0
> 
> 时间：2013-03-07T05:26:54.027
> 
> 标签：javascript, .net, arrays

```
function Deal()
{

var suffledDeck:Array;
var playerOneCards: Array;
var playerTwoCards: Array;  
var first:int =0;
var second:int = 1;

suffledDeck = new Array();
playerOneCards = new Array();
playerTwoCards = new Array();

//var CardLeft:int = Deck.length;
for(var i = 0; i < Deck.length; i++) 
{   
    Debug.Log(Deck.length);

    var ranNum = Random.Range(1,Deck.length);

    suffledDeck.Add(Deck[ranNum]);

    Debug.Log("suffled deck: " + suffledDeck.length);
}

//var halfDeck: int = (suffledDeck.length / 2);

for(var j = 0; j <=26 ; j++)
{       
    Debug.Log(first);
    Debug.Log(second);

    playerOneCards.Add(suffledDeck[first]); 
    playerTwoCards.Add(suffledDeck[second]);

    Debug.Log(playerOneCards[first].img);   
    Debug.Log(playerTwoCards[second].img);  

    first += 2;
    second += 2;        
}
} 
```

当我开始将数组拆分为 2 个单独的数组时，它开始忽略除第一个元素之外的每个元素。suffleDeck[] 加载了 52 个 Card 对象，我试图拆分数组，以便每个玩家都可以拥有自己的牌组。

用于调试目的的控制台窗口：http: [//puu.sh/2dqZm](http://puu.sh/2dqZm)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:30:50.070

我相信问题是`var ranNum = Random.Range(1,Deck.length)`。

`ranNum`应该在 0 到 0 之间生成一个随机索引，`Deck.length - 1`因为数组索引从 0（不是 1）开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:31:15.703

问题在于这些日志记录语句：

```
Debug.Log(playerOneCards[first].img);   
Debug.Log(playerTwoCards[second].img); 
```

`first`和`second`是 的有效索引`suffledDeck`，但每个玩家的牌组只有一半的牌。尝试`j`在两个日志记录语句中使用作为下标而不是`first`or `second`。

您还应该将循环限制为`j < 26`，而不是`j <= 26`。实际上，您试图在每个玩家的牌组中放置 27 张牌。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:39:07.403

因为：

```
 Debug.Log(playerTwoCards[second].img); 
```

这里`second`将我们的值设为 1，而您的数组仅包含一个为零的项目。导致`ArgumentoutofRangeException`.

所以试试：

```
 for(var j = 0; j <=26 ; j++)
  {       
    Debug.Log(first);
    Debug.Log(second);

    playerOneCards.Add(suffledDeck[first]); 
    playerTwoCards.Add(suffledDeck[second]);

    Debug.Log(playerOneCards[j].img);   
    Debug.Log(playerTwoCards[j].img);  

    first += 2;
    second += 2;        
  } 
```

# google-chrome - 没有为 Chrome 扩展加载权限

> ID：15263756
> 
> 赞同：2
> 
> 时间：2013-03-07T05:26:54.213
> 
> 标签：google-chrome, google-chrome-extension, permissions

刚开始我的第一个 chrome 扩展，我正在尝试使用 chrome.bookmarks.getChildren() 方法。我收到一条错误消息

> 未捕获的错误：您无权使用“bookmarks.getChildren”。请务必在清单中声明您需要哪些权限。

我的 manifest.json 文件：

```
{
"manifest_version": 2,

"name": "Top Sites",
"description": "blah blah blah",
"version": "1.0",
"permissions": [
    "bookmarks"
],    
"browser_action": {
    "default_icon": "images/icon.png",
    "default_popup": "html/popup.html"
} 
```

}

# c - 分段错误（核心转储）...BMH 算法

> ID：15263759
> 
> 赞同：-1
> 
> 时间：2013-03-07T05:27:09.833
> 
> 标签：c, memory-leaks, segmentation-fault

我正在尝试实现一个 Boyer Moore Horsepoole 算法。此代码是用 Turbo C++、Windows 编写的。有效。我必须在ubuntu中移植它。

```
typedef struct skip_table
{
    char index;
    int value;
}skip_table;

void create_table(char*,int);
int discrete_char(char*,int);
int bm(char*, char*);
int lookup(char);
int check_EOF(char*,int);

skip_table *t1;
int tab_len;
FILE *fptr;

int main()
{
    time_t first, second;
    double time_spent;
    long int cnt=0;

    char *key_string,*buf,c; // String to be matched and text
    int i,key_len,text_len,def_shift_len,flag_match=0;

    gets(key_string);
    key_len=strlen(key_string);

    fptr=fopen("test_file.txt","r");
    first = clock();
    fseek(fptr,SEEK_SET,0);
    create_table(key_string,key_len);

    while(flag_match!=1)
    {
        fseek(fptr,100*cnt,0);
        fread(buf,100-key_len-1, 1, fptr);
        flag_match = bm(buf, key_string);
        cnt++;

    printf("\n%d",cnt);
     }
    second =clock();
time_spent=(double)(second-first)/CLOCKS_PER_SEC;

if(flag_match==1)
    printf("\n\nMatch Found in %lf seconds",time_spent);
else
    printf("\n\nMatch NOT Found in %lf seconds",time_spent);

    fclose(fptr);
    return 0;
}

int discrete_char(char* key_string,char* temp,int key_len)
{
    int i,j,count=1,flag=0;

for(i=1;i<key_len;i++)
{
    for(j=0; j<count; j++)
    {
        flag=0;
        if(temp[j] == key_string[i])
        {
            flag=1;
            break;
        }
    }
        if(flag!=1)
        {
            temp[count++]=key_string[i];
            flag=0;
        }
}

temp[count]='\0';
return count;
}

void create_table(char* key_string,int key_len)
{
    int i,j,k,max_index;
char *temp;
temp[0] = key_string[0];

tab_len=discrete_char(key_string,temp,key_len);
t1=(skip_table*)malloc((tab_len-1)*sizeof(skip_table));

for(i=0;i<tab_len;i++)
{
    for(j=0;j<key_len;j++)
    {
        if(temp[i]==key_string[j])
            max_index=j;
    }

    t1[i].index=temp[i];
    t1[i].value=key_len-max_index-1;

    printf("\n\n %c %d",t1[i].index,t1[i].value);
}
}

int bm(char* text, char* key_string)
{
int i_t, i_k, j,k, text_len, key_len, shift, count=0, flag_match=0;
int loop_count;

text_len = strlen(text);
key_len = strlen(key_string);
i_t=key_len;
i_k=key_len;

loop_count=0;

while(i_t<=text_len)
{
    if(count != key_len)
    {
        if(text[i_t-1]==key_string[i_k-1])
        {
            count++;
            i_t--;  i_k--;
            loop_count++;
        }
        else
        {
            if(loop_count>key_len)
            {
                i_t=i_t+lookup(text[i_t-1])+1;
                i_k=key_len;
                loop_count=0;
                continue;
            }
            shift = lookup(text[i_t-1]);
            if(shift<=0)
                shift=key_len;
            i_t = i_t+shift;
            i_k = key_len;
            count=0;
        }
    }
    else
    {
        flag_match =  1;
        break;
    }
}
return flag_match;
} 
```

“int lookup(char index)”如果存在于“temp”中，则返回索引的相应值字段，否则返回-1。

这是我的全部代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:54:55.910

并不是说我确切地看到出了什么问题，但这里有一些防御性编程技巧：

```
int main()
{
  // initialize all variables before use
  time_t first = 0, second = 0;
  double time_spent = 0.0;
  long int cnt=0;

  char *key_string = NULL;
  char *buf = NULL;
  char  c = '\0';  
  char temp[50] = {0};
  int i = 0,key_len=0,text_len=0,def_shift_len=0,flag_match=0;

// use fgets instead of gets, fgets allows you specify max length

  fgets(temp,sizeof(temp),stdin);
  key_len=strlen(temp);
  key_string = (char*) malloc(key_len+1);

// use strncpy or strcpy_s to specify max size
  strncpy(key_string, temp, sizeof(key_string));

  fptr = fopen("test_file.txt","r");

  first = clock();

// here arguments have wrong order, fseek takes origin as last arg:
  fseek(fptr,0,SEEK_SET);

// could be something in create_table, but you have not supplied it
  create_table(key_string,key_len); 
```

当函数中有这么多变量时，您可以考虑将函数的一部分移到其他函数中

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T08:08:16.230

正如输出所示，也可以尝试`--track-origins=yes` 在您的 valgrind 选项上使用，这可以帮助追踪未初始化变量的来源。

正如其他人所建议的那样，valgrind 报告的问题是 inside `create_table`，所以请也发布代码。

# visual-studio - 在自定义 Visual Studio 语言服务中支持用户指定的文件扩展名

> ID：15263761
> 
> 赞同：8
> 
> 时间：2013-03-07T05:27:15.920
> 
> 标签：visual-studio, vsx, languageservice

我正在开发自定义 Visual Studio 语言服务，并且对文件扩展名绑定到特定语言服务的方式有几个问题。

语言“示例语言”的源文件有两个主要文件扩展名：`.e1`和`.e2`. 我的扩展有一个扩展`ExampleLanguagePackage`类[`Package`](http://msdn.microsoft.com/en-us/library/vstudio/microsoft.visualstudio.shell.package.aspx)。

1.  当您使用文件 → 打开命令并选择 C# 文件（例如）时，“打开”按钮有一个下拉箭头，可让您选择“打开方式...”。当您单击该按钮时，您会看到在“CSharp Editor（默认）”、“CSharp Editor with Encoding”或其他几个选项中打开文件的选项。如何为我的语言提供类似的功能，提供“示例语言（默认）”和“带编码的示例语言”选项？

2.  当您打开工具 → 选项... → 文本编辑器 → 文件扩展名时，您可以将（例如）`.foo`扩展名绑定到“Microsoft Visual C#”或其他几个选项中的任何一个。如何扩展此页面以允许用户定义的文件扩展名与“示例语言”相关联？

3.  注册这些项目时我还应该注意什么？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-07T05:27:15.920

[`IVsEditorFactory`](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.shell.interop.ivseditorfactory.aspx)通过为您的语言添加自定义实现并使用注册属性的组合来注册它，可以解决大多数这些项目。[此接口的实际实现超出了此问题的范围，但接口本身的文档（并链接到该页面）以及Python Tools for Visual Studio](http://pytools.codeplex.com)项目中的示例[`DjangoEditorFactory`](http://pytools.codeplex.com/SourceControl/changeset/view/974abb1efa96#Release/Product/Python/Django/DjangoEditorFactory.cs)实现帮助我完成了初始实现。

为了支持示例语言，我将做出以下假设。

*   您已经实现了一个抽象类`ExampleEditorFactory`，它提供了`IVsEditorFactory`. 该类应该有一个带`bool`参数的受保护构造函数，以指定工厂是否应提示用户进行编码（类似于 的构造函数之一`DjangoEditorFactory`）。
    *   您有一个类`ExampleEditorFactoryWithoutEncoding`，它扩展`ExampleEditorFactory`并构造了`false`为`promptForEncoding`参数指定的基类。这个类应该用[`[Guid]`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.guidattribute.aspx)属性来标记。
    *   您有一个类`ExampleEditorFactoryWithEncoding`，它扩展`ExampleEditorFactory`并构造了`true`为`promptForEncoding`参数指定的基类。这个类应该用[`[Guid]`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.guidattribute.aspx)属性来标记。
*   您已将以下条目添加到 VSPackage.resx 资源文件中。常量可以更改，但请注意，我使用了下面的常量值 101 和 102。
    *   # 101 = 示例语言

    *   # 102 = 带编码的示例语言

## 注册编辑器工厂

首先要做的是注册你的编辑器工厂。这分两部分完成。

首先，使用[`ProvideEditorFactoryAttribute`](http://msdn.microsoft.com/en-us/library/vstudio/microsoft.visualstudio.shell.provideeditorfactoryattribute.aspx). 此属性将工厂显示名称的资源标识符与工厂类型本身相关联。

```
[ProvideEditorFactory(typeof(ExampleEditorFactoryWithoutEncoding), 101)]
[ProvideEditorFactory(typeof(ExampleEditorFactoryWithEncoding), 102)] 
```

接下来，在 的[`Initialize`](http://msdn.microsoft.com/en-us/library/vstudio/microsoft.visualstudio.shell.package.initialize.aspx)方法中，在调用之后`ExampleLanguagePackage`添加调用。[`RegisterEditorFactory`](http://msdn.microsoft.com/en-us/library/vstudio/microsoft.visualstudio.shell.package.registereditorfactory.aspx)`base.Initialize()`

```
protected override void Initialize()
{
    base.Initialize();

    RegisterEditorFactory(new ExampleEditorFactoryWithoutEncoding(this));
    RegisterEditorFactory(new ExampleEditorFactoryWithEncoding(this));
} 
```

## 将逻辑视图与编辑器工厂关联

我还没有找到我想要的关于[`ProvideEditorLogicalViewAttribute`](http://msdn.microsoft.com/en-us/library/vstudio/microsoft.visualstudio.shell.provideeditorlogicalviewattribute.aspx)属性用例的所有信息，但至少包括以下内容很重要。确保向您创建的两个工厂注册逻辑视图。

```
[ProvideEditorLogicalView(typeof(ExampleEditorFactoryWithoutEncoding), VSConstants.LOGVIEWID.TextView_string)]
[ProvideEditorLogicalView(typeof(ExampleEditorFactoryWithEncoding), VSConstants.LOGVIEWID.TextView_string)] 
```

如果不执行此步骤，则在输出窗口中双击可以将您带到一行代码的功能将无法按预期工作。例如，假设输出窗口包含如下一行。

```
c:\dev\file.e1(14,3): unexpected expression 
```

关联 TextView 逻辑视图允许 IDE 在您双击此输出行时使用您的工厂，将您带到文件 c:\dev\file.e1 的第 14 行第 3 列。否则它将使用不同的工厂打开文档的新副本，并且新窗口可能会缺少许多功能。

## 将标准文件扩展名`.e1`和`.e2`编辑器工厂关联起来

此步骤为原始问题 1 中描述的 .e1 和 .e2 文件提供“打开方式...”支持。此步骤通过[`ProvideEditorExtensionAttribute`](http://msdn.microsoft.com/en-us/library/vstudio/microsoft.visualstudio.shell.provideeditorextensionattribute.aspx)属性完成。

主工厂的默认优先级似乎是 50。具有显式编码的工厂的优先级应该低于此值，而 49 似乎是一个不错的选择。请注意，无需指定`NameResourceID`命名参数，因为它已由上述`ProvideEditorFactoryAttribute`用法指定（生成的注册表项相同）。

```
[ProvideEditorExtension(typeof(ExampleEditorFactoryWithoutEncoding), ".e1", 50)]
[ProvideEditorExtension(typeof(ExampleEditorFactoryWithoutEncoding), ".e2", 50)]
[ProvideEditorExtension(typeof(ExampleEditorFactoryWithEncoding), ".e1", 49)]
[ProvideEditorExtension(typeof(ExampleEditorFactoryWithEncoding), ".e2", 49)] 
```

## 将`.*`扩展与编辑器工厂关联

此步骤为所有其他文件提供“打开方式...”支持，并添加对原始问题 2 中描述的文件扩展名选项的支持。此步骤也使用该`ProvideEditorExtensionAttribute`属性，但使用低得多的优先级值以确保默认其他文件类型的编辑器不会被设置覆盖。与上一步一样，具有显式编码的工厂的优先级较低。

```
[ProvideEditorExtension(typeof(ExampleEditorFactoryWithoutEncoding), ".*", 2)]
[ProvideEditorExtension(typeof(ExampleEditorFactoryWithEncoding), ".*", 1)] 
```

## 最后的笔记

这个答案没有涵盖几个细节。

*   （对于 Visual Studio 2012 非常重要）如果您计划支持 Visual Studio 2012，请参阅主题[无法让自定义编辑器使用临时选项卡](http://social.msdn.microsoft.com/Forums/en-US/vsx/thread/dea6c30a-dc1f-45da-9f0f-5e7f0ded4ce4)以了解有关新的（否则记录不充分的）属性的详细信息[`ProvideEditorFactoryAttribute.CommonPhysicalViewAttributes`](http://msdn.microsoft.com/en-us/library/microsoft.visualstudio.shell.provideeditorfactoryattribute.commonphysicalviewattributes.aspx)。
*   （未知重要性）`ProvideEditorFactoryAttribute`不支持指定[`LinkedEditorGUID`](http://msdn.microsoft.com/en-us/library/bb166421.aspx)值（向下搜索页面）。该值通常会添加到 的注册中`ExampleEditorFactoryWithEncoding`，并且该值将是 的 GUID `ExampleEditorFactoryWithoutEncoding`。

# ruby-on-rails - 在 Epoch 中将 Ruby 时间戳转换为秒数并返回

> ID：15263767
> 
> 赞同：39
> 
> 时间：2013-03-07T05:27:40.527
> 
> 标签：ruby-on-rails, ruby

我的数据库中有一个字段存储为时间戳，我需要在 EPOCH 时间以秒为单位输出。

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2013-10-12T20:41:07.233

假设您的时间戳是一个 Ruby *Time*对象：

```
puts time_stamp.strftime('%s')
puts time_stamp.to_i
timestamp = Time.at(628232400) 
```

如果它是*DateTime*对象，您可以使用*strftime*和*strptime*方法。

* * *

## 回答 #2

> 赞同：44
> 
> 时间：2013-03-07T05:30:11.757

返回自纪元以来的秒数：

```
time = Time.now.to_i 
```

返回自纪元以来的秒数，包括微秒：

```
time = Time.now.to_f 
```

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-09-30T12:03:22.600

```
Time.now.to_i 
```

返回纪元。同样适用于：

```
time = Time.now
time.to_i 
```

# c - C - Fclose -> 中止（核心转储）

> ID：15263768
> 
> 赞同：0
> 
> 时间：2013-03-07T05:27:41.910
> 
> 标签：c, gcc, cygwin

我在 fclose 上收到 Aborted 错误，想知道我在哪里做错了。核心欺骗：

```
Stack trace:
Frame     Function  Args
0022A698  7C802542  (00000758, 0000EA60, 000000A4, 0022A794)
0022A7B8  610DC559  (000007DD, 0000000A, 00000032, 0000000B)
0022A8A8  610D9913  (00000000, 7C801879, 0022FF44, 7C839AC0)
0022A908  610D9DEE  (00000144, 00000000, 0022AC30, 00000006)
0022A9B8  610D9F40  (00000288, 00000006, 00000001, 200586E0)
0022A9D8  610D9F6C  (00000006, 00000006, 0022AA38, 610FCCE7)
0022AA08  610DA233  (7C809C1B, 00000744, 0022AA68, 610FCE07)
20038678  61110408  (61201C98, 00000000, 20010410, 00000001)
End of stack trace 
```

我在项目中使用 Cygwin + GCC + Autotools。没明白那是什么意思。在此之后什么都没有，因为程序必须退出但显示 Aborted 令人不安..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T06:49:25.057

从中获取核心转储的一种标准方法`fclose()`是向其传递一个为空的文件指针，因为您无法打开文件：

```
 FILE *fp = fopen("/long/hairy/path/with/a/missing/file/at/the/end", "r");

 fclose(fp); 
```

始终检查来自`fopen()`及其亲属的返回值：

```
if (fp == NULL)
    ...report problem
else
{
    ...use fp...
    fclose(fp);
} 
```

# javascript - div 边框在 div 的顶部和底部扩展填充

> ID：15263769
> 
> 赞同：0
> 
> 时间：2013-03-07T05:27:42.727
> 
> 标签：javascript, css, html, margin

我对一些 CSS 收缩包装有疑问。首先是（非常简单的）代码......

```
<!doctype html>
<html lang="en-US">
    <head>
        <title>Device Activation</title>
        <meta charset="utf-8">
        <style type="text/css">
            body {
                background: white;
                font-family: "Arial Black", Gadget, sans-serif;
            }
            div {
                background: #dddddd;
                //border: 1px solid;
                border-radius: 40px;
                box-shadow: 10px 10px 5px #888888;
                //display: inline-block;
                padding: 0px 10px;
                //text-align: justify;
                //-moz-border-radius: 40px;
            }
        </style>
    </head>
    <body>
            <h1>Boogy-woogy</h1>
        <div id="start" class="toggleable">
            <p>Test</p>
        </div>
    <script type="text/javascript">
        function makeVisible() {
            // Not here yet, but that's okay...right?   
        }
    </script>
    </body>
</html> 
```

问题：当您从`border: 1px solid;`div 中删除评论时，顶部和底部边距会显着增加。

我做了一些研究，我知道这个问题与折叠边距有关，但我尝试了几个修复程序，似乎没有任何影响我的最终结果。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:40:30.777

我认为你的意思是因为 p 有默认的边距和填充。添加

```
p {
    margin:0px;
    padding:0px;
} 
```

到CSS

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T05:42:47.773

也许您的代码示例只是一个错字。如果没有，那么请注意，使用 JavaScript 注释，您可以选择：

```
// This is a javascript comment
/* This is a javascript comment as well... */ 
```

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Code_comments](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Code_comments)

如果要进行 CSS 注释，则不能使用`// this is a comment`语法。您需要使用`/* this is a comment */`语法。

[http://www.w3.org/TR/CSS21/syndata.html#comments](http://www.w3.org/TR/CSS21/syndata.html#comments)

现在，当我隐藏`border: 1px solid`线时，我看不到顶部或底部边距发生变化。但我认为您在问题代码中使用的不正确语法发生了什么，这`div`是`display: block`因为`inline-block`没有应用规则。因为`inline-block`没有被应用，所以 div 拉伸到它的全宽。

[http://jsfiddle.net/2f59k/](http://jsfiddle.net/2f59k/)

```
 body {
      background: white;
      font-family:"Arial Black", Gadget, sans-serif;
  }
  div {
      background: #dddddd;
     /* border: 1px solid;*/
      border-radius: 40px;
      box-shadow: 10px 10px 5px #888888;
      display: inline-block; 
      padding: 0px 10px;
      text-align: justify;
      -moz-border-radius: 40px;
  } 
```

同样，如果从这个答案中没有收集到任何其他信息，
这**不是**CSS 注释：

```
// border: 1px solid; 
```

这**是**一条 CSS 注释：

```
/* border: 1px solid; */ 
```

* * *

更新

此问题与边框半径、边框等无关。如果仅将其理解为文本上方和下方但在灰色背景内的空间量，则您的问题是文本周围的**边距。**这种增加是显着的，但不如 div 介于`block`和之间时宽度的变化那么显着`inline-block`。

设置`margin`内部段落的 来`margin: 0`解决问题。

[http://jsfiddle.net/74eTg/](http://jsfiddle.net/74eTg/)

# javascript - 以两种形式发布数据，第一种形式不发送任何数据，直到填写第二个形式

> ID：15263775
> 
> 赞同：0
> 
> 时间：2013-03-07T05:27:54.517
> 
> 标签：javascript, html, forms, post, form-submit

基本上我有两种形式。我想让用户在注册时填写第一批信息。按下一步（提交），然后填写第二批信息。一旦他们按下注册，提交两组 POST 信息。

我所拥有的是 - 具有两种不同形式的两个部分（这是将它们分成两种形式的原因 - 网站外观的一部分）：

```
<section class="first">
    <header>
        <h1>Signup 1/2</h1>
    </header>
      <form id="firstForm">
          <label>First Name</label>
          <input type="text" class="input-text" value="" name="firstName" required />
          <label>Surname</label>
          <input type="text" class="input-text" value="" name="Surname" required />
          <label>Username</label>
          <input type="text" class="input-text" value="" name="Username" required />
        <input type="submit" name="firstSubmit" value="next"/>
      </form>
</section>
<section class="second">
    <header>
        <h1>Signup 2/2</h1>
    </header>
      <form name="secondForm" class="clearfix">
          <label>Your Email</label>
          <input type="email" class="input-text" value="" name="email" required />
          <label>Password</label>
          <input type="text" class="input-text" value="" name="password" required />
        <input type="submit" name="secondSubmit" value="Register" />
      </form>
</section> 
```

所以第二部分是隐藏的，直到用户点击下一个按钮（提交）。我有 javascript 阻止它提交，隐藏第一部分，并使第二部分出现：

```
<script type="text/javascript">
$("#firstForm").bind("submit", nextForm);
function nextForm() {
    $('.first').css("display", "none");
    $('.second').css("display", "block");
    return false;
} 
```

这行得通。然后我的问题是让第二个表单提交，但同时发布第一个和第二个信息，就像使用一个提交按钮一样，我同时提交了两个。这可能吗？如果是这样，怎么办？

要使用 GET 方法，我会去：

```
$("#secondForm").bind("submit", submitForm);
function submitForm() {
    document.getElementById("firstForm").submit();  
    document.getElementById("secondForm").submit();         
} 
```

但我不想这样做，因为 GET = 敏感信息的坏主意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:33:45.747

我会使用一种形式，但将两组输入包装在 div 中。只需隐藏第一个 div 并在第一个按钮单击时显示第二个（您不会将其保留为提交按钮），然后在第二个按钮单击时提交整个表单。

# heroku - 在 heroku 上设置 geddy.js 项目

> ID：15263776
> 
> 赞同：0
> 
> 时间：2013-03-07T05:27:56.590
> 
> 标签：heroku, geddy

我是`nodejs`开发新手，我正在使用[geddyjs](http://geddyjs.org/documentation)进行开发。[问题是我在heroku](https://devcenter.heroku.com)上找不到任何设置 geddyjs 项目的解决方案， 以下命令用于执行项目

```
cd projectfolder
geddy 
```

但是找不到如何设置 geddy 来执行项目？我在 heroku dev 上找不到解决方案，这就是我在这里发帖的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-28T13:43:31.927

这是在 Geddydocumentation 上部署 Nodejs 应用程序的文档：

[http://geddyjs.org/guide#deployment_heroku](http://geddyjs.org/guide#deployment_heroku)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-08T00:06:16.567

希望文档中的这个页面会有所帮助：

[http://geddyjs.org/documentation#deploymentHeroku](http://geddyjs.org/documentation#deploymentHeroku)

# javascript - 将嵌套的 json 数据处理成数据连接

> ID：15263778
> 
> 赞同：1
> 
> 时间：2013-03-07T05:28:10.290
> 
> 标签：javascript, json, d3.js

我最近决定使用嵌套 json，但是，我无法访问它们。我已经看到了一些使用 data 方法返回数据的不同方式的示例，例如：

```
 var node = svg.selectAll("g.node")
 .data(nodes, function(d) {return d.world;})

  var node = svg.selectAll("g.node")
 .data(nodes) 
```

但是，这没有任何影响。因此我也尝试过：

```
 .text(function(d) { return d.world.Name; }) 
```

但我仍然没有任何运气！

这是嵌套 json 的片段：

```
 var nodes = {"Galaxy":"Milkyway","life":true,"world": [
         {"Name": 'Amy', "Country": 'USA', "translate":"translate(190,83)" }, 
         {"Name": 'Nathan', "Country": 'USA', "type": 'square', "translate":  "translate(190,83)"}, 
         {"Name": 'Lewis', "Country": 'USA', "type": 'circle', "translate":  "translate(20,183)" }, 
         {"Name": 'Tom', "Country": 'Japan', "type": 'diamond', "translate":  "translate(-300,-200)"},
         {"Name": 'Matt', "Country": 'Russia', "type": 'cross', "translate": "translate(10,183)"},
         {"Name": 'Frank', "Country": 'France', "type": 'triangle-up', "translate": "translate(30,183)"},
         {"Name": 'Bob', "Country": 'Japan', "type": 'diamond', "translate": "translate(10,13)"}
]}; 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T06:12:55.273

我相信我已经找到了解决问题的合适方法：

```
 var node = svg.selectAll("g.node")
                 .data(nodes.world) 
```

请，如果你有另一个我愿意接受其他的做事方式。谢谢 ：）

# magento - 如何使第三方 magento 扩展与商店主题兼容。

> ID：15263779
> 
> 赞同：0
> 
> 时间：2013-03-07T05:28:12.227
> 
> 标签：magento

使第三方扩展与不是默认主题的商店主题兼容的最佳方法是什么。我不想做以下事情： 1）我们不能修改扩展 css/phtml 文件，因为这会升级扩展，因为在这种情况下，我们的扩展将会消失。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T20:33:15.980

我建议从标准的 Magento 安装中找到 CSS 并使用它。尽可能少的样式将意味着用户的最大灵活性。还包括有关文件默认位置以及安装在其主题模板位置的说明。我相信这可以通过编程方式确定并在您的扩展程序的管理区域中进行检查。

# java - Eclipse中的@Override注释错误，为什么我不能解决这个问题？

> ID：15263782
> 
> 赞同：1
> 
> 时间：2013-03-07T05:28:23.573
> 
> 标签：java, android, eclipse, annotations, overriding

[这个问题](https://stackoverflow.com/questions/4761888/override-annotation-error-android-prefs)我已经试过了...

但是，这似乎已在较新版本的 Eclipse 中得到解决，因为它已经设置为 1.6（我也安装了 JRE 6）。但显然，Eclipse 仍然会抛出一个我无法设置为忽略的错误。

这是我的代码的一部分（从一个学习 Java for Android 网站复制，所以它应该可以工作......）。

```
private class RadioGroupInfo implements OnCheckedChangeListener {

    private RadioButton mLastChecked;
    private String mNewSelectionMessageTemplate;
    private String mChangedSelectionMessageTemplate;

    public RadioGroupInfo() {
        mNewSelectionMessageTemplate = getString(R.string.new_selection_message_template);
        mChangedSelectionMessageTemplate = getString(R.string.changed_selection_message_template);
    }

    @Override
    public void onCheckedChanged(RadioGroup group, int CheckedId) {
        // TODO Auto-generated method stub
    }
} 
```

引发此错误：

```
The method onCheckedChanged(RadioGroup, int) of type ButtonActivity.RadioGroupInfo must override or implement a supertype method 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:43:18.920

检查你的进口。您是否从[RadioGroup.OnCheckedChangeListener](http://developer.android.com/reference/android/widget/RadioGroup.OnCheckedChangeListener.html)`OnCheckedChangeListener`以外的其他地方导入？

# cassandra - 在 windows 中安装多节点 cassandra

> ID：15263785
> 
> 赞同：4
> 
> 时间：2013-03-07T05:28:35.760
> 
> 标签：cassandra

是否有任何详细的分步文档来解决 Windows 中的多节点 cassandra 安装？我阅读了一些文档/博客并在 Window7 工作站/Windows2008 服务器上进行了尝试，但无法建立从第二个节点到第一个节点的连接。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-10T19:58:59.837

当我在 Windows 上设置我的第一个集群时，我发现这篇[博文](http://kimola.com/articles/cassandra-installation-on-windows-platform)非常棒。它涵盖了设置的许多方面，包括：

*   防火墙/网络问题。
*   将 Cassandra 作为服务运行。
*   监测和维护。

如果您想使用 cassandra 创建完整的设置，请查看[**此博客**](http://zeshanfarooqi.wordpress.com/2012/05/04/configuring-multi-node-cassandra-cluster-on-windows/)。

但是要设置多节点集群，您基本上需要在服务器上[打开正确的端口。](http://www.datastax.com/docs/1.0/references/firewall_ref)在配置方面，您基本上将在所有节点上拥有相同的**cassandra.yaml**配置，具有相同的种子列表，并且唯一需要更改的两个字段是 the`listen_address`和可能`rpc_address`（尽管您可以只监听所有接口通过将其`rpc_address`设置为：

```
rpc_address: 0.0.0.0 
```

# python - 正确使用扩展？

> ID：15263789
> 
> 赞同：-5
> 
> 时间：2013-03-07T05:28:52.147
> 
> 标签：python, list, tree, extend

```
class BTNode(object):
"""A node in a binary tree."""

def __init__(self, item, left=None, right=None):
    """(BTNode, object, BTNode, BTNode) -> NoneType
    Initialize this node to store item and have children left and right,
    as well as depth 0.
    """
    self.item = item
    self.left = left
    self.right = right
    self.depth = 0  # the depth of this node in a tree

def __str__(self):
    """(BTNode) -> str
    Return a "sideways" representation of the subtree rooted at this node,
    with right subtrees above parents above left subtrees and each node on
    its own line, preceded by as many TAB characters as the node's depth.
    """
    # If there is a right subtree, add an extra TAB character in front of
    # every node in its string representation, with an extra newline at the
    # end (ready to be concatenated with self.item).
    if self.right:
        str_right = "\t" + str(self.right).replace("\n", "\n\t") + "\n"
    else:
        str_right = ""
    # The string representation of self.item: if item is a string, use
    # repr(item) so that quotes are included and special characters are
    # treated correctly -- just like in a list; else use str(item).
    if isinstance(self.item, str):
        str_item = repr(self.item)
    else:
        str_item = str(self.item)
    # If there is a left subtree, add an extra TAB character in front of
    # every node in its string representation, with an extra newline at the
    # beginning (ready to be concatenated with self.item).
    if self.left:
        str_left = "\n\t" + str(self.left).replace("\n", "\n\t")
    else:
        str_left = ""
    # Put the right subtree above the root above the left subtree.
    return str_right + str_item + str_left

def leaves_and_internals(self):
    """(BTNode) -> ([object], [object])
    Return a pair of lists: (list of all the items stored in the leaves of
    the subtree rooted at this node, list of all the items stored in the
    internal nodes of the subtree rooted at this node).
    """
    #Leaf: Doesn't have children
    #Internal Node: Has children
    leaf = []
    internal = []
    if not self.left and not self.right:
        leaf.append(self.item)
    if self.left is not None:
        internal.append(self.item)
        if self.right is not None:
            self.right.leaves_and_internals()
        self.left.leaves_and_internals()
    elif self.right is not None:
        internal.append(self.item)
        self.right.leaves_and_internals()
    print(leaf, internal)
    return leaf, internal 
```

BTNode 类是提供给我们的起始代码，我们无法对其进行编辑。我的职责是按照给定的文档字符串为leaves_and_intervals 编写代码。我目前唯一的问题是不知道如何使用扩展来正确递归地组合列表。

我的测试块看起来像这样：

```
if __name__ == "__main__":
    root = BTNode(2, BTNode(4, BTNode(6, BTNode(8, None, None), None), None), None)
    root.leaves_and_internals() 
```

我的输出看起来像这样：

```
[8] []
[] [6]
[] [4]
[] [2] 
```

正确的输出应该如下所示（顺序无关紧要）：

```
[8] [6, 4, 2] 
```

如何正确使用扩展，以便叶子和内部不会在每次递归时都重置回空列表？我知道我必须有第二组扩展列表，只是不确定如何实现它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T06:26:00.717

如果要递归解决此问题，则无需显式声明空列表。只需汇总每个子问题的结果。

这是我的方法：

```
def leaves_and_internals(self): 
    if not self.left and not self.right:
        #leaf.append(self.item)
        return ([], [self.item])
    if self.left is not None:
        #internal.append(self.item)
        if self.right is not None:
            #return ([self.item], []) + self.right.leaves_and_internals()
            return tuple(map(operator.add,([self.item], []), self.right.leaves_and_internals()))
        #return ( [self.item], []) + self.left.leaves_and_internals()
        return tuple( map(operator.add, ([self.item], []), self.left.leaves_and_internals()))
    elif self.right is not None:
        #internal.append(self.item)
        #(leaf, internal) + self.right.leaves_and_internals()
        #return ( [self.item], []) + self.right.leaves_and_internals()
        return tuple(map(operator.add,([self.item], []), self.right.leaves_and_internals())) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T07:34:18.093

我看到您的代码几乎具有正确的逻辑。这是我的实现。

```
def leaves_and_internals(self):
    leaves    = []
    internals = []

    if self.left or self.right:
        internals.append(self.item)
    else:
        leaves.append(self.item)

    if self.left:
        sub_leaves, sub_internals = self.left.leaves_and_internals()
        leaves.extend(sub_leaves)
        internals.extend(sub_internals)

    if self.right:
        sub_leaves, sub_internals = self.right.leaves_and_internals()
        leaves.extend(sub_leaves)
        internals.extend(sub_internals)

    return leaves, internals 
```

# angularjs - 如何在 Angular 中包含 Facebook JS 库？

> ID：15263791
> 
> 赞同：4
> 
> 时间：2013-03-07T05:29:03.987
> 
> 标签：angularjs, facebook-javascript-sdk

我想将 Facebook javascript 库包含在 Angular 项目中，以便所有 facebook API 调用（登录、注销等）都封装在服务中。但是由于 FB 库的异步特性，我的代码似乎过于冗长，而且我有几次调用 $rootScope.apply() 我不确定这是最佳实践。

现在我有这样的事情：

```
app.factory('Facebook', function($rootScope, $window, $q){
  var FBdefer = $q.defer();
  var FBpromise = FBdefer.promise;
  $window.fbAsyncInit = function(){
    $rootScope.$apply(function(){
      FB.init(/* FB init code here*/);
      FBdefer.resolve(FB);
    }
  }

  var fb_service_api = {
    login: function(){
      var deferred = $q.defer();
      FBPromise.then(function(FB){
        FB.login(function(response){
          $rootScope.$apply(
            deferred.resolve(response)
          );
        });
      }
      return deferred.promise.
    }
  }

  return fb_service_api;
}) 
```

在这里寻找一个很好的设计模式，非常适合 Angular 框架。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T03:14:30.027

我认为您可以在这里使用[Misko Hevery 的方法](https://stackoverflow.com/questions/11972026/delaying-angularjs-route-change-until-model-loaded-to-prevent-flicker)来解决此问题，以延迟控制器的加载，直到 Facebook XHR 调用“解决”。

This seems to have solved all of my asynchronous data loading issues and will probably mean you can just delete your `$apply()` calls too.

# java - Java 泛型作为方法的参数

> ID：15263795
> 
> 赞同：2
> 
> 时间：2013-03-07T05:29:50.243
> 
> 标签：java, generics

我有一个关于 Java 泛型的问题，但我似乎找不到答案。这是我当前的代码：

```
interface ISelect<T>{
    // a predicate that determines the properties of the given item
    public boolean select(T t);
}

class BookByPrice<T> implements ISelect<T> {
    int high;
    int low;

    public BookByPrice(int high, int low) {
        this.high = high;
        this.low = low;
    }

    public boolean select(T t) {
        return t.getPrice() >= this.low && t.getPrice() <= this.high;
    }
} 
```

所以，基本上，我必须定义这个类 BooksByPrice 来实现接口 ISelect 并充当谓词，以便在另一个充当列表实现的类接口中的过滤器方法中使用。BooksByPrice 应该有这个方法 select 如果一本书的价格在低和高之间，则返回 true。BooksByPrice 类的整个主体可能会发生变化，但接口必须与代码中的一样。有没有办法在 BooksByPrice 类中实例化泛型类型 T 以便它可以使用一本书的方法和字段？否则，我认为 select 方法没有任何理由将泛型作为参数。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T05:37:04.160

你需要给出`T`一个上限：

```
class BookByPrice<T extends Book> implements ISelect<T> {

    ...

    public boolean select(T book) {
        return book.getPrice() >= this.low && book.getPrice() <= this.high;
    }
} 
```

或者`ISelect`使用具体的类型参数实现：

```
class BookByPrice implements ISelect<Book> {

    ...

    public boolean select(Book book) {
        return book.getPrice() >= this.low && book.getPrice() <= this.high;
    }
} 
```

使用哪种方法是设计决策，取决于是否`BookByPrice`需要对不同的书籍子类通用。

# c# - 让errorProvider在按钮单击时执行

> ID：15263804
> 
> 赞同：1
> 
> 时间：2013-03-07T05:30:18.323
> 
> 标签：c#, validation

我一直在尝试这样做一段时间，只是无法让代码按照我想要的方式执行。在 C# Visual Studio 中运行程序时，我单击提交按钮，而不是因为空白文本框而提醒我错误，它什么也不做。我想知道如何在提交按钮 (txtSubmit) 中的代码中执行 errorProvider 或“errorCheck”，以便显示错误。

这是我到目前为止的代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.IO;    //input output external files (.text)
using System.Text.RegularExpressions;   //handles errors
using System.Xml;

namespace H1

{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

    private void btnExit_Click(object sender, EventArgs e)
    {
        //Exits the application when pressed
        Application.Exit();
    }

    private void btnClear_Click(object sender, EventArgs e)
    {
        //clears the fields when clicked
        txtPid.Text = "";       //Patient Information Fields
        txtPname.Text = "";
        txtPphone.Text = "";
        txtPaddress.Text = "";
        txtPemail.Text = "";
        txtPhysician.Text = "";     //Last visit fields
        txtDate.Text = "";
        txtReason.Text = "";
        txtIid.Text = "";       //Insurance information fields
        txtIcompany.Text = "";
        txtIphone.Text = "";
        txtIinsured.Text = "";
    }

    private void btnSubmit_Click(object sender, EventArgs e)
    {
        string[] dat = new string[12]; //Declare new string array, 12 because 0 is included in count
        dat[0] = txtPid.Text; //Patient Information Fields
        dat[1] = txtPname.Text;
        dat[2] = txtPphone.Text;
        dat[3] = txtPaddress.Text;
        dat[4] = txtPemail.Text;
        dat[5] = txtPhysician.Text; //Last visit fields
        dat[6] = txtDate.Text;
        dat[7] = txtReason.Text;
        dat[8] = txtIid.Text; //Insurance information fields
        dat[9] = txtIcompany.Text;
        dat[10] = txtIphone.Text;
        dat[11] = txtIinsured.Text; //Array is now fully populated
        StreamWriter sw = new StreamWriter("PatientInfo.txt"); //Declare a new writer
        for(int i = 0; i < dat.Length; i++) //Iterate through the array
    {
        sw.WriteLine(dat[i]); //Writes the current position in a new line to specified file
    }
        sw.Close(); //Close our writer, don't need unused junk left open

    }

    private void Form1_Load(object sender, EventArgs e)
    {

        StreamReader sr = new StreamReader("PatientInfo.txt"); //Specifies a new stream reader to read the file "File.dat"
        String dat = sr.ReadToEnd(); //Reads the file until end and assigns it to the string "dat"
        sr.Close(); //Close reader
        dat = dat.Replace("\r", ""); //Removes all instances of carriage return, for handling/compatibility
        string[] arr = dat.Split('\n'); //Splits the string into an array based on the new line character
    }

    private void txtPid_Validating(object sender, CancelEventArgs e)
    {
        // defines match
        Match m = Regex.Match(txtPid.Text, @"\b[0-7]{7}\b");    //regular expressions

        if (m.Success == false) //if does not match then provide below message
            errorCheck.SetError(txtPid, "Patent I.D. must be 7 characters.");   //error message
        else errorCheck.SetError(txtPid, "");   //clears
    }

    private void txtPname_Validating(object sender, CancelEventArgs e)
    {
        if (txtPname.Text.Length < 3)   //checks to see if there are less than 3 characters
        {
            errorCheck.SetError(txtPname, "Please enter the first and last name.");
        }
        else if (txtPname.Text.IndexOf(' ') == -1)
        {
            errorCheck.SetError(txtPname, "Must have both names seperated by a space.");
        }
        else errorCheck.SetError(txtPname, "");     //clears
    }

    private void txtPaddress_Validating(object sender, EventArgs e)
    {
        if (txtPaddress.Text == "")
        {
            errorCheck.SetError(txtPaddress, "You must enter the address.");
        }
        else errorCheck.SetError(txtPaddress, "");  //clears
    }

    private void txtPphone_Validating(object sender, CancelEventArgs e)
    {
        if (txtPphone.Text != "Valid")
        {
            errorCheck.SetError(txtPphone, "Telephone Number must be in proper format");
        }
        else errorCheck.SetError(txtPphone, "");
    }

    private void txtPemail_Validating(object sender, CancelEventArgs e)
    {
        if (txtPemail.Text == "") //checking for blanks
        {
            errorCheck.SetError(txtPemail, "You must enter an e-mail address.");
        }
        else if (txtPemail.Text == "@") //checking for @
        {
            errorCheck.SetError(txtPemail, "You must enter a valid e-mail address.");
        }
        else errorCheck.SetError(txtPemail, "");
    }

    private void txtIid_Validating(object sender, CancelEventArgs e)
    {
        Match m = Regex.Match(txtIid.Text, @"\b[0-7]{7}\b");

        if (m.Success == false)
            errorCheck.SetError(txtIid, "Insurance I.D. must be 7 characters.");
        else errorCheck.SetError(txtIid, "");   //clear
    }

    private void txtIcompany_Validating(object sender, CancelEventArgs e)
    {
        if (txtIcompany.Text == "") //checking for blanks
        {
            errorCheck.SetError(txtIcompany, "You must enter an Insurance Company.");
        }
        else errorCheck.SetError(txtIcompany, "");
    }

    private void txtIphone_Validating(object sender, CancelEventArgs e)
    {
        if (txtIphone.Text != "Valid")
        {
            errorCheck.SetError(txtIphone, "Telephone Number must be in proper format");
        }
        else errorCheck.SetError(txtIphone, "");

    }

    private void txtIinsured_Validating(object sender, CancelEventArgs e)
    {
        if (txtIinsured.Text.Length < 4) // checking entry length
        {
            errorCheck.SetError(txtIinsured, "Please enter the first and last name.");
        }
        else if (txtIinsured.Text.IndexOf(' ') == -1)  //checks for space
        {
            errorCheck.SetError(txtIinsured, "Must have both names.");
        }
        else errorCheck.SetError(txtIinsured, "");
    }

    private void txtDate_Validating(object sender, CancelEventArgs e)
    {
        if (txtDate.Text == "")
        {
            errorCheck.SetError(txtDate, "Must enter a correct date.");
        }
        else errorCheck.SetError(txtDate, "");
    }

    private void txtPhysician_Validating(object sender, CancelEventArgs e)
    {
        if (txtPhysician.Text == "") //checking for blanks
        {
            errorCheck.SetError(txtPhysician, "Must enter the Physician's name.");
        }
        else errorCheck.SetError(txtPhysician, "");
    }

    private void txtReason_Validating(object sender, CancelEventArgs e)
    {
        if (txtReason.Text == "")
        {
            errorCheck.SetError(txtReason, "Must enter a reason for visit.");
        }
        else errorCheck.SetError(txtReason, "");    //clears
    }

}
} 
```

# c# - 使用 DynamoDB 和 AWSSDK.net 的 BatchWriteItem

> ID：15263806
> 
> 赞同：1
> 
> 时间：2013-03-07T05:30:24.983
> 
> 标签：c#, .net, amazon-dynamodb

我目前在使用 DynamoDB 调用 BatchWriteItem 请求时遇到问题。我收到以下错误

***“无法将数据保存到数据库。超出了为表配置的预置吞吐量级别。考虑使用 UpdateTable API 提高预置级别”***

配置：

吞吐量：读取 = 5；写 = 5;

这是我的场景：我需要对同一个表一个接一个地执行 2 组数据写入请求 - 使用聚合数据（932KB：拆分为 63KB 的块，大约为 15 个块） - 非聚合数据（940 KB：分成 63KB 的块，大约是 15 个块）

在进行写入之前，我根据散列键和范围键值删除了 dynamo-db 表中的所有项目（对于聚合数据：删除了 16 个项目）。

下面是代码：

```
public void PutItems(string tableName, string id, string message, bool aggregated)
    {
         if (aggregated)
             id = "a_" + id;
         else
             id = "r_" + id;
        List<WriteRequest> writeRequests = new List<WriteRequest>();
        List<WriteRequest> DeleteWriteRequest = new List<WriteRequest>();
        var itemsToDelete = GetItemsToDelete(tableName, id);
        if (itemsToDelete.Count > 0)
        {
            foreach (Tuple<string, int> item in itemsToDelete)
            {

                DeleteRequest deleteRequest = new DeleteRequest
                {
                    Key = new Key
                    {
                        HashKeyElement = new AttributeValue { S = item.Item1 },
                        RangeKeyElement = new AttributeValue { N = item.Item2.ToString() }
                    }
                };
                WriteRequest deleteReq = new WriteRequest();
                deleteReq.DeleteRequest = deleteRequest;
                DeleteWriteRequest.Add(deleteReq);
            }
            logger.Info(this.GetType().ToString(), string.Format(".....Deleting Old Data..........."));
            foreach (IEnumerable<WriteRequest> ls in LinqExtensions.Partition(DeleteWriteRequest, SplitLevel))
            {
                BatchWriteItemRequest delWriteRequest = new BatchWriteItemRequest();
                delWriteRequest.WithRequestItems(new KeyValuePair<string, List<WriteRequest>>(tableName, ls.ToList()));

                CallBatchWriteTillCompletion(delWriteRequest);
            }
            logger.Info(this.GetType().ToString(), string.Format(".....Delete Complete!..........")); 
        }

        int MaxLength = 64512; //64KB = 65536 Bytes ; 60KB = 61440 Bytes
        logger.Info(this.GetType().ToString(), string.Format("Message Size : {0}", message.Length)); 
        var str = SplitToChunks(message, MaxLength).ToList();
        for (int i = 0; i < str.Count; i++)
        {

            PutRequest putRequest = new PutRequest
            {
                Item = new Dictionary<string, AttributeValue>()
                    {
                        {"Received", new AttributeValue {S = id}},
                        {"SequenceNum" , new AttributeValue {N = i.ToString()}},
                        {"Message", new AttributeValue {S = str[i]}}
                    }
            };
            WriteRequest request = new WriteRequest();
            request.PutRequest = putRequest;
            writeRequests.Add(request);
        }

        logger.Info(this.GetType().ToString(), string.Format(".....Writing Data..........."));
        foreach (IEnumerable<WriteRequest> ls in LinqExtensions.Partition(writeRequests, SplitLevel))
        {
                System.Threading.Thread.Sleep(1000);
                BatchWriteItemRequest writeRequest = new BatchWriteItemRequest();
                writeRequest.WithRequestItems(new KeyValuePair<string, List<WriteRequest>>(tableName, ls.ToList()));
                CallBatchWriteTillCompletion(writeRequest);

        }
        logger.Info(this.GetType().ToString(), string.Format(".....Write Complete!.........."));
    }

    private void CallBatchWriteTillCompletion(BatchWriteItemRequest request)
    {
        BatchWriteItemResponse response;

        int callCount = 0;
        do
        {
            if (callCount > 0)
            {
                System.Threading.Thread.Sleep(1000);
            }
            logger.Info(this.GetType().ToString(), string.Format("Making Request"));
            response = Instance.Client.BatchWriteItem(request);
            callCount++;

            // Check the response.
            var result = response.BatchWriteItemResult;
            var responses = result.Responses;
            var unprocessed = result.UnprocessedItems;

            logger.Info(this.GetType().ToString(), string.Format("Response"));
            foreach (var resp in responses)
            {

                logger.Info(this.GetType().ToString(), string.Format("{0} - {1}", resp.Key, resp.Value.ConsumedCapacityUnits));
            }

            logger.Info(this.GetType().ToString(), string.Format("Unprocessed"));
            foreach (var unp in unprocessed)
            {

                logger.Info(this.GetType().ToString(), string.Format("{0} - {1}", unp.Key, unp.Value.Count));

            }

            // For the next iteration, the request will have unprocessed items.
            request.RequestItems = unprocessed;

        } while (response.BatchWriteItemResult.UnprocessedItems.Count > 0);

        logger.Info(this.GetType().ToString(), string.Format("Total # of batch write API calls made: {0}", callCount));

    }

    //This method is use to split a string message of smaller chunks of 64KB.
    private static IEnumerable<String> SplitToChunks(String str, int maxLength)
    {
            for (int index = 0; index < str.Length; index += maxLength)
            {
                yield return str.Substring(index, Math.Min(maxLength, str.Length - index));
            }          
    } 
```

静态类 LinqExtensions {

```
 public static IEnumerable<IEnumerable<T>> Partition<T>(this IEnumerable<T> source, int size)
    {
        T[] array = null;
        int count = 0;
        foreach (T item in source)
        {
            if (array == null)
            {
                array = new T[size];
            }
            array[count] = item;
            count++;
            if (count == size)
            {
                yield return new ReadOnlyCollection<T>(array);
                array = null;
                count = 0;
            }
        }
        if (array != null)
        {
            Array.Resize(ref array, count);
            yield return new ReadOnlyCollection<T>(array);
        }
    }

} 
```

你能告诉我我在这里做错了什么吗？我在多个地方添加了 1 秒的延迟，以便吞吐量永远不会超过。我还附加了一个带有日志的文本文件，其中包含 ConsumedCapacityUnits。

```
2013-03-06 21:20:21.6093 INFO     
2013-03-06 21:20:21.7031 INFO     .........Writing Aggregated Messages to DynamoDB ...
2013-03-06 21:20:21.7343 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:20:22.2500 INFO     Working mode: MASTER.
2013-03-06 21:20:22.3750 INFO     Heartbeat message '3/6/2013 9:20:22 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:20:22.9062 INFO     .....Deleting Old Data...........
2013-03-06 21:20:22.9531 INFO     Making Request
2013-03-06 21:20:23.1250 INFO     Response
2013-03-06 21:20:23.1562 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 320
2013-03-06 21:20:23.2031 INFO     Unprocessed
2013-03-06 21:20:23.2500 INFO     Total # of batch write API calls made: 1
2013-03-06 21:20:23.2812 INFO     Making Request
2013-03-06 21:20:23.4218 INFO     Response
2013-03-06 21:20:23.5468 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 320
2013-03-06 21:20:23.5937 INFO     Unprocessed
2013-03-06 21:20:23.6406 INFO     Total # of batch write API calls made: 1
2013-03-06 21:20:23.6718 INFO     Making Request
2013-03-06 21:20:26.1406 INFO     Response
2013-03-06 21:20:26.2031 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 320
2013-03-06 21:20:26.2500 INFO     Unprocessed
2013-03-06 21:20:26.2968 INFO     Total # of batch write API calls made: 1
2013-03-06 21:20:26.3593 INFO     Making Request
2013-03-06 21:20:28.6875 INFO     Response
2013-03-06 21:20:28.7187 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 54
2013-03-06 21:20:28.7500 INFO     Unprocessed
2013-03-06 21:20:28.7968 INFO     Total # of batch write API calls made: 1
2013-03-06 21:20:28.8750 INFO     .....Delete Complete!..........
2013-03-06 21:20:28.9218 INFO     Message Size : 1022580
2013-03-06 21:20:28.9687 INFO     .....Writing Data...........
2013-03-06 21:20:30.0000 INFO     Making Request
2013-03-06 21:20:33.2812 INFO     Response
2013-03-06 21:20:33.3125 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 128
2013-03-06 21:20:33.3437 INFO     Unprocessed
2013-03-06 21:20:33.3906 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 3
2013-03-06 21:20:34.4218 INFO     Making Request
2013-03-06 21:20:36.2343 INFO     Response
2013-03-06 21:20:36.2656 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 128
2013-03-06 21:20:36.2968 INFO     Unprocessed
2013-03-06 21:20:36.3281 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 1
2013-03-06 21:20:36.6093 INFO     
2013-03-06 21:20:36.6406 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:20:37.0156 INFO     Working mode: MASTER.
2013-03-06 21:20:37.0781 INFO     Heartbeat message '3/6/2013 9:20:37 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:20:37.3750 INFO     Making Request
2013-03-06 21:20:38.0781 INFO     Response
2013-03-06 21:20:38.1093 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:20:38.1406 INFO     Unprocessed
2013-03-06 21:20:38.1718 INFO     Total # of batch write API calls made: 3
2013-03-06 21:20:39.2187 INFO     Making Request
2013-03-06 21:20:42.2812 INFO     Response
2013-03-06 21:20:42.3125 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 128
2013-03-06 21:20:42.3437 INFO     Unprocessed
2013-03-06 21:20:42.3906 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 3
2013-03-06 21:20:43.4218 INFO     Making Request
2013-03-06 21:20:45.2187 INFO     Response
2013-03-06 21:20:45.2500 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 128
2013-03-06 21:20:45.2968 INFO     Unprocessed
2013-03-06 21:20:45.3281 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 1
2013-03-06 21:20:46.3593 INFO     Making Request
2013-03-06 21:20:47.0156 INFO     Response
2013-03-06 21:20:47.0625 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:20:47.0937 INFO     Unprocessed
2013-03-06 21:20:47.1250 INFO     Total # of batch write API calls made: 3
2013-03-06 21:20:48.1718 INFO     Making Request
2013-03-06 21:20:51.2968 INFO     Response
2013-03-06 21:20:51.3437 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 128
2013-03-06 21:20:51.3906 INFO     Unprocessed
2013-03-06 21:20:51.4218 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 3
2013-03-06 21:20:51.6093 INFO     
2013-03-06 21:20:51.6406 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:20:52.0000 INFO     Working mode: MASTER.
2013-03-06 21:20:52.0781 INFO     Heartbeat message '3/6/2013 9:20:52 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:20:52.4531 INFO     Making Request
2013-03-06 21:20:54.2656 INFO     Response
2013-03-06 21:20:54.3125 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 128
2013-03-06 21:20:54.3437 INFO     Unprocessed
2013-03-06 21:20:54.3750 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 1
2013-03-06 21:20:55.6718 INFO     Making Request
2013-03-06 21:20:56.3281 INFO     Response
2013-03-06 21:20:56.3750 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:20:56.4375 INFO     Unprocessed
2013-03-06 21:20:56.5312 INFO     Total # of batch write API calls made: 3
2013-03-06 21:20:57.5937 INFO     Making Request
2013-03-06 21:20:58.1875 INFO     Response
2013-03-06 21:20:58.2343 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 54
2013-03-06 21:20:58.3281 INFO     Unprocessed
2013-03-06 21:20:58.5625 INFO     Total # of batch write API calls made: 1
2013-03-06 21:20:58.5937 INFO     .....Write Complete!..........
2013-03-06 21:20:58.6875 INFO     .........Writing Complete! ...
2013-03-06 21:20:58.7187 INFO     .........Writing Raw Messages to DynamoDB ...
2013-03-06 21:21:00.8437 INFO     .....Deleting Old Data...........
2013-03-06 21:21:00.8906 INFO     Making Request
2013-03-06 21:21:06.0000 INFO     New Message Received
2013-03-06 21:21:06.6093 INFO     
2013-03-06 21:21:06.6562 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:21:07.0468 INFO     Working mode: MASTER.
2013-03-06 21:21:07.1250 INFO     Heartbeat message '3/6/2013 9:21:07 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:21:08.2343 INFO     Response
2013-03-06 21:21:08.2812 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 39
2013-03-06 21:21:08.3281 INFO     Unprocessed
2013-03-06 21:21:08.4062 INFO     Total # of batch write API calls made: 1
2013-03-06 21:21:08.4843 INFO     .....Delete Complete!..........
2013-03-06 21:21:08.5156 INFO     Message Size : 1006556
2013-03-06 21:21:08.5625 INFO     .....Writing Data...........
2013-03-06 21:21:09.6093 INFO     Making Request
2013-03-06 21:21:15.7187 INFO     Response
2013-03-06 21:21:15.7656 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:21:15.7968 INFO     Unprocessed
2013-03-06 21:21:15.8437 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 4
2013-03-06 21:21:16.8750 INFO     Making Request
2013-03-06 21:21:21.6093 INFO     
2013-03-06 21:21:21.6562 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:21:23.4687 INFO     Working mode: MASTER.
2013-03-06 21:21:24.1406 INFO     Heartbeat message '3/6/2013 9:21:23 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:21:27.3593 INFO     Response
2013-03-06 21:21:27.4062 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:21:27.4531 INFO     Unprocessed
2013-03-06 21:21:27.5000 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 3
2013-03-06 21:21:28.5312 INFO     Making Request
2013-03-06 21:21:36.6093 INFO     
2013-03-06 21:21:36.9687 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:21:38.1718 INFO     Working mode: MASTER.
2013-03-06 21:21:38.2343 INFO     Heartbeat message '3/6/2013 9:21:38 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:21:40.2031 INFO     Response
2013-03-06 21:21:40.2500 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:21:40.3281 INFO     Unprocessed
2013-03-06 21:21:40.3593 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 2
2013-03-06 21:21:41.3906 INFO     Making Request
2013-03-06 21:21:51.6093 INFO     
2013-03-06 21:21:51.7500 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:21:52.1718 INFO     Working mode: MASTER.
2013-03-06 21:21:52.2500 INFO     Heartbeat message '3/6/2013 9:21:52 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:21:54.0937 INFO     Response
2013-03-06 21:21:54.1562 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:21:54.1875 INFO     Unprocessed
2013-03-06 21:21:54.2343 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 1
2013-03-06 21:21:55.2812 INFO     Making Request
2013-03-06 21:22:06.2031 INFO     New Message Received
2013-03-06 21:22:06.6093 INFO     
2013-03-06 21:22:06.6406 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:22:07.0312 INFO     Working mode: MASTER.
2013-03-06 21:22:07.5781 INFO     Response
2013-03-06 21:22:07.6406 INFO     Heartbeat message '3/6/2013 9:22:07 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:22:07.7812 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:22:07.8437 INFO     Unprocessed
2013-03-06 21:22:07.9375 INFO     Total # of batch write API calls made: 5
2013-03-06 21:22:08.9687 INFO     Making Request
2013-03-06 21:22:18.0156 INFO     Response
2013-03-06 21:22:18.0781 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:22:18.1250 INFO     Unprocessed
2013-03-06 21:22:18.1562 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 4
2013-03-06 21:22:19.2031 INFO     Making Request
2013-03-06 21:22:21.6093 INFO     
2013-03-06 21:22:21.6875 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:22:21.7031 INFO     Response
2013-03-06 21:22:21.7656 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:22:21.8281 INFO     Unprocessed
2013-03-06 21:22:21.8750 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 3
2013-03-06 21:22:22.0937 INFO     Working mode: MASTER.
2013-03-06 21:22:22.1875 INFO     Heartbeat message '3/6/2013 9:22:22 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:22:22.9375 INFO     Making Request
2013-03-06 21:22:34.9687 INFO     Response
2013-03-06 21:22:35.0156 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:22:35.0468 INFO     Unprocessed
2013-03-06 21:22:35.0781 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 2
2013-03-06 21:22:36.1093 INFO     Making Request
2013-03-06 21:22:36.6093 INFO     
2013-03-06 21:22:36.7656 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:22:38.2968 INFO     Working mode: MASTER.
2013-03-06 21:22:38.5468 INFO     Heartbeat message '3/6/2013 9:22:38 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:22:48.7968 INFO     Response
2013-03-06 21:22:48.8750 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:22:48.9062 INFO     Unprocessed
2013-03-06 21:22:48.9375 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 1
2013-03-06 21:22:50.0000 INFO     Making Request
2013-03-06 21:22:51.6093 INFO     
2013-03-06 21:22:51.8281 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:22:52.8125 INFO     Working mode: MASTER.
2013-03-06 21:22:52.8906 INFO     Heartbeat message '3/6/2013 9:22:52 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:23:02.2968 INFO     Response
2013-03-06 21:23:02.3281 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:23:02.3593 INFO     Unprocessed
2013-03-06 21:23:02.3906 INFO     Total # of batch write API calls made: 5
2013-03-06 21:23:03.4375 INFO     Making Request
2013-03-06 21:23:06.6093 INFO     
2013-03-06 21:23:06.7812 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:23:07.5000 INFO     New Message Received
2013-03-06 21:23:08.8593 INFO     Working mode: MASTER.
2013-03-06 21:23:09.3281 INFO     Heartbeat message '3/6/2013 9:23:09 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:23:15.3906 INFO     Response
2013-03-06 21:23:15.4375 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:23:15.4843 INFO     Unprocessed
2013-03-06 21:23:15.5312 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 4
2013-03-06 21:23:16.5625 INFO     Making Request
2013-03-06 21:23:21.6093 INFO     
2013-03-06 21:23:21.8593 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:23:23.7031 INFO     Working mode: MASTER.
2013-03-06 21:23:24.0468 INFO     Heartbeat message '3/6/2013 9:23:23 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:23:28.7812 INFO     Response
2013-03-06 21:23:28.8125 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 64
2013-03-06 21:23:28.8750 INFO     Unprocessed
2013-03-06 21:23:29.1718 INFO     Key: TrafficConditionsMessages_dev - Unprocessed Value Count: 3
2013-03-06 21:23:30.4375 INFO     Making Request
2013-03-06 21:23:31.6093 INFO     Run task Called......
2013-03-06 21:23:31.9375 INFO     Processing Read data Method
2013-03-06 21:23:32.7187 INFO     Saving data to DB...
2013-03-06 21:23:33.0156 INFO     .........Writing Aggregated Messages to DynamoDB ...
2013-03-06 21:23:36.8125 INFO     
2013-03-06 21:23:37.0156 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:23:37.4531 INFO     .....Deleting Old Data...........
2013-03-06 21:23:37.7500 INFO     Making Request
2013-03-06 21:23:38.5156 INFO     Working mode: MASTER.
2013-03-06 21:23:38.8593 INFO     Heartbeat message '3/6/2013 9:23:38 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:23:41.6875 INFO     Response
2013-03-06 21:23:41.9531 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 320
2013-03-06 21:23:42.2500 INFO     Unprocessed
2013-03-06 21:23:42.3593 INFO     Total # of batch write API calls made: 1
2013-03-06 21:23:42.4218 INFO     Making Request
2013-03-06 21:23:50.5468 ERROR    Unable to save data to DB. The level of configured provisioned throughput for the table was exceeded. Consider increasing your provisioning level with the UpdateTable API
2013-03-06 21:23:50.5781 INFO     .....Save to Database Complete!..... 
2013-03-06 21:23:50.7812 INFO     Run task Complete......
2013-03-06 21:23:51.6093 INFO     
2013-03-06 21:23:51.6406 INFO     Heartbeat event fired. Processing heartbeat ...
2013-03-06 21:23:53.1718 INFO     Working mode: MASTER.
2013-03-06 21:23:53.4531 INFO     Heartbeat message '3/6/2013 9:23:53 PM|OAK-VENUGOPALP' written to SQS queue 'HeartbeatDataReceiver_dev'.
2013-03-06 21:23:53.6093 ERROR    Unable to save data to DB. The level of configured provisioned throughput for the table was exceeded. Consider increasing your provisioning level with the UpdateTable API
2013-03-06 21:23:53.6562 INFO     .....Save to Database Complete!..... 
2013-03-06 21:23:53.8281 INFO     Run task Complete...... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:57:13.447

这个数字（大致）转换为每秒 KB：ThroughPut : Write = 5;

如果您尝试写入 63KB 的项目，则需要先写入，然后等待约 13 秒再尝试再次写入。您每秒预配了 5 KB，然后在一次突发中使用了 63 KB。在接下来的 13 秒内，您向表中写入的任何请求都可能受到限制。

从时间戳来看，客户端正在无形地处理 ProvisionedThroughputExceeded 错误并重试；例如，在这里您看到请求期间经过了 10 秒：

```
2013-03-06 21:22:08.9687 INFO     Making Request
2013-03-06 21:22:18.0156 INFO     Response 
```

最终，在一堆较小的请求之后，桌子收到了一个很大的请求：

```
2013-03-06 21:23:41.9531 INFO     Key: TrafficConditionsMessages_dev - Consumed Capacity Units: 320 
```

并且下一个请求花费了很长时间，以至于您的客户决定是时候向您展示错误了：

```
2013-03-06 21:23:42.4218 INFO     Making Request
2013-03-06 21:23:50.5468 ERROR    Unable to save data to DB. The ... 
```

解决方案是提高您的预置吞吐量，根据返回的 ConsumedCapacity 休眠更长时间，或者写入更少的数据。

# sql - SQL（ite）将列表转换为二维表，将行转换为列

> ID：15263808
> 
> 赞同：0
> 
> 时间：2013-03-07T05:30:38.957
> 
> 标签：sql, select, sqlite

**原始问题**

我有一个表，其中包含两个属性组合的列表值：

```
Pattern | Feature | Value
--------+---------+-------
 P1     | F1      | V1.1
 P1     | F2      | V1.2
 P2     | F1      | V2.1
 P2     | F2      | V2.2 
```

我想转换表格，使“功能”成为列名：

```
Pattern | F1      | F2
--------+---------+-------
 P1     | V1.1    | V1.2
 P2     | V2.2    | V2.2 
```

纯SQL可以做到吗？我更喜欢 SQLite，但也可以使用 MySQL 或 PostgreSQL。

非常感谢！

**在 JW. 的回答之后扩展**

我没有提到包含实例的另一列。正如我所想，这并不重要。一个实例只能分配给一种模式，但包含许多特征。

```
 Instance | Pattern | Feature | Value
   ---------+ --------+---------+-------
     In1    | P1      |  F1     | V1.1.1
     In1    | P1      |  F2     | V1.1.2
     In2    | P1      |  F1     | V2.1.1
     In2    | P1      |  F2     | V2.1.2
     In3    | P2      |  F1     | V3.2.1
     In3    | P2      |  F2     | V3.2.2
     In4    | P2      |  F1     | V4.2.1
     In4    | P2      |  F2     | V4.2.2 
```

实例本身在结果表中并不重要，但结果表应包含每个实例的一行。（这是 Tor 馈送 SVM 引擎）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:32:15.830

```
SELECT  Pattern,
        MAX(CASE WHEN Feature = 'F1' THEN value ELSE NULL END) AS F1,
        MAX(CASE WHEN Feature = 'F2' THEN value ELSE NULL END) AS F2
FROM    tableName
GROUP   BY Pattern 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!7/8356e/1)

# c# - 上下文提示列表的正确定位（智能感知）

> ID：15263809
> 
> 赞同：0
> 
> 时间：2013-03-07T05:30:40.913
> 
> 标签：c#

就像来自 Avalon 的这张图片： ![在此处输入图像描述](../Images/dcdfaacb6af69b7acab08b7a19dcb18d.png)

如何为上下文提示或智能感知做正确的定位？

情景：

我正在使用代码编辑器，我使用richtextbox(rtb) 作为c 编辑器，使用组合框(lb) 作为上下文提示。

除了组合框（上下文提示）的正确定位之外，所有代码都几乎完成了（）。

我使用这个代码：

```
Point cursorPt = Cursor.Position;
lb.Location = PointToClient(cursorPt); 
```

但是当鼠标光标出现时它会出现......如果鼠标光标在表单之外，它也不会出现。

更多继承人的代码：

```
 public void TextChangedEvent(object sender, EventArgs e)
    {
        lb.BringToFront();

        RichTextBox rtb = sender as RichTextBox;

        if (rtb != null)
        {
            //pass through to the HighlightType class
            HighlighType HighlighType = new HighlighType(rtb);
            lb.Visible = false;
            lb.Items.Clear();
        }

        // Calculate the starting position of the current line.
        int start = 0, end = 0;
        for (start = rtb.SelectionStart - 1; start > 0; start--)
        {
            if (rtb.Text[start] == '\n') { start++; break; }
        }

        // Calculate the end position of the current line.
        for (end = rtb.SelectionStart; end < rtb.Text.Length; end++)
        {
            if (rtb.Text[end] == '\n') break;
        }

        // Extract the current line that is being edited.
        String line = rtb.Text.Substring(start, end - start);

        // Backup the users current selection point.
        int selectionStart = rtb.SelectionStart;
        int selectionLength = rtb.SelectionLength;

        // Split the line into tokens.
        Regex r = new Regex("([ \\t{}();])");
        Regex singlequote = new Regex("\'[^\"]*\'");
        Regex doublequote = new Regex("\"[^\"]*\"");
        string[] tokens = r.Split(line);
        int index = start;
        foreach (string token in tokens)
        {
            // Set the token's default color and font.
            rtb.SelectionStart = index;
            rtb.SelectionLength = token.Length;
            rtb.SelectionColor = Color.Black;
            rtb.SelectionFont = new Font("Courier New", 10, FontStyle.Regular);

            if (token == "//" || token.StartsWith("//"))
            {
                // Find the start of the comment and then extract the whole comment.
                int length = line.Length - (index - start);
                string commentText = rtb.Text.Substring(index, length);
                rtb.SelectionStart = index;
                rtb.SelectionLength = length;
                HighlighType.commentsType(rtb);
                break;
            }

            //*** invention code:

            Point cursorPt = Cursor.Position;
            lb.Location = PointToClient(cursorPt);

            KeyWord keywordsL = new KeyWord();
            KeyWord eventsL = new KeyWord();

            if (token == "." || token.StartsWith(".") & token.EndsWith(" "))
            {
                foreach (string str in keywordsL.keywords)
                {
                    lb.Items.Add(str);
                    lb.Visible = true;
                    lb.Focus();

                } 
```

提前！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T06:49:28.097

```
Point point = this.rtb.GetPositionFromCharIndex(rtb.SelectionStart);
this.lb.Location = point; 
```

# cxf - CXF WSS4J 拦截器与 WS-SecurityPolicy

> ID：15263817
> 
> 赞同：3
> 
> 时间：2013-03-07T05:30:58.577
> 
> 标签：cxf, wss4j

我对 WS-Security 政策有疑问。我们可以使用 CXF WSS4J 拦截器或 WS-Security Policy 来实现 WS-Security。这两种方法有什么区别？我发现将 WS-Security 策略嵌入到 wsdl 比在 cxf 中添加拦截器更困难。请让我了解这两者之间有什么不同？提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-07T14:46:36.540

使用 WS-SecurityPolicy，安全需求成为已发布的“合同”（又名：WSDL）的一部分，因此服务的消费者可以立即知道需求是什么。此外，由于 WS-SP 比用于 WSS4JInterceptors 的“操作”更具描述性，因此它可用于描述更广泛的安全要求。

# c - 在内核级别在运行时处理信息

> ID：15263819
> 
> 赞同：2
> 
> 时间：2013-03-07T05:31:00.917
> 
> 标签：c, linux, kernel, linux-device-driver

我正在开发一个 linux 内核模块，该模块将处理为特定任务运行的所有进程。是否有可能知道名为“X”的某个进程是否仍在运行以及它的当前状态是什么？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T06:05:00.937

那么代码已经准备好了..你可以试试这个..

```
#include<linux/init.h>
#include<linux/module.h>
#include<linux/sched.h>

MODULE_LICENSE("GPL");
static int info_init(void)
{
    struct task_struct *iTask;
    for_each_process(iTask) {
            printk(KERN_INFO "Process Info \nName: %s\nState:%ld\n",iTask->comm, iTask->state);
    }
    return 0;
}

static void info_exit(void)
{
    printk(KERN_INFO "Tata Bye-bye from Anshul");
}

module_init(info_init);
module_exit(info_exit); 
```

~

执行后运行

> dmesg

命令，您可以看到所有进程名称及其状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T06:20:51.123

Linux 中的每个任务都由一个**结构（PCB/TCB）**表示，即进程/任务控制块。这被实现为**struct task_struct**。它包含有关进程的所有信息。所有PCB都排列在一个链接列表中，您可以遍历它并提取必要的信息。在您的模块中，您可以启动一个内核线程作为助手来为您完成这项工作。

# ada - 如何设置 pragma 以将 Ada 的功能限制为 Pascal

> ID：15263821
> 
> 赞同：1
> 
> 时间：2013-03-07T05:31:03.403
> 
> 标签：ada

我打算将 Ada 用于某些程序。我记得在某处读过，您可以使用编译指示设置编译器指令来优化您的程序。更具体地说，我记得读过，如果您只需要有限的 Ada 功能子集（基本上对应于 Pascal，但使用 Ada 的强类型），您可以使用 pragma 指定一种“类 Pascal 模式”（我使用这个术语因为没有更好的表达方式）。我的目标是禁用那些我不需要的运行时检查（因为我只需要基本功能），从而减小可执行文件的大小并提高性能。我的问题是：如何设置这样的编译指示？我应该指定哪些参数/选项？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T19:00:21.290

这或许来自于一个误会。

Ada 不是 Pascal 的超集。将它们视为母语[Algol 60](http://en.wikipedia.org/wiki/ALGOL)的兄弟语言更为准确。Pascal 最初是由 Niklaus Wirth 开发的，是Algol 60 的**简化版本。Algol 的人反而用另一种方式开发了 Algol 68。**

相反，Ada 是一种从头开始设计的新语言，它借鉴了 Algol 60 的语法（在很大程度上，Java 借鉴了 C 的语法）。然而，它甚至比 Algol 68 复杂得多（有些人会使用“功能性”这个词）。

因此，在 Ada 编译器中请求“Pascal 标志”与在 Java 编译器中请求“C++ 标志”非常相似。

如果您只是在寻找免费的 Pascal 编译器，您可能会考虑使用[Free Pascal](http://en.wikipedia.org/wiki/Free_Pascal)或[GNU Pascal](http://en.wikipedia.org/wiki/GNU_Pascal)。

如果您只是想减少未使用的运行时设施的开销，您应该查看[附件 H](http://www.ada-auth.org/standards/12rm/html/RM-H-4.html)，它允许您[`pragma Restrictions()`](http://www.ada-auth.org/standards/12rm/html/RM-13-12.html)有选择地禁止访问 Ada 运行时的某些部分。这使您可以摆脱诸如浮点、动态分配、动态分派、任务、异常/运行时约束检查等之类的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T07:05:35.793

对不起，这是个坏主意。如果您想避免任务构造的任何可能开销，请不要使用任务！人们经常想要抑制约束检查（你可以在 GNAT 中通过编译来做到这一点`-p`）但是 - 根据我的经验 - 你很少得到比小的改进。

Ada 现在有[pragma Restrictions](http://www.ada-auth.org/standards/12rm/html/RM-13-12.html)，它会阻止您使用某些功能；[你可以在这里](http://gcc.gnu.org/onlinedocs/gnat_rm/Partition_002dWide-Restrictions.html#Partition_002dWide-Restrictions)看到 GNAT 。其目的是支持高完整性软件、可移植软件或高效任务运行时的生产。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-07T07:00:25.163

除非我误解了你，否则 {'Pascal-like mode'} 听起来像是特定于实现的编译指示。尽管有`[time or space] and`可能会影响您的最终大小的“优化限制”编译指示。

# c# - C# 通用多个参数

> ID：15263823
> 
> 赞同：0
> 
> 时间：2013-03-07T05:31:06.787
> 
> 标签：c#, generics, parameters

我有一个通用方法，它有几个参数和一个返回类型：

```
 public static class Support
{
    public static TR JSONKeyName<TR, T1, T2, T3>(this IEnumerable<Tuple<T1, T2>> a, Action<T3> b)
    {
        TR result = default(TR);

        try
        {
            foreach (var entry in a)
            {
                b((T3)TypeDescriptor.GetConverter(typeof(T3)).ConvertFromInvariantString("[ \"" + entry.Item1 + "\", " + entry.Item2 + "\" ]"));
            }

            result = (TR)Convert.ChangeType(true, typeof(TR));
        }
        catch
        {
            result = (TR)Convert.ChangeType(false, typeof(TR));
        }

        return result;
    }
}       

List<Tuple<int, string>> list = new List<Tuple<int, string>>();
list.Add(new Tuple<int, string>(1, "Test 1"));
list.Add(new Tuple<int, string>(2, "Test 2"));
list.Add(new Tuple<int, string>(3, "Test 3"));

var res = list.JSONKeyName<bool>((string entry) =>
    {

    }); 
```

从上面的示例调用 JSONKeyName 时，出现以下错误：

编译器错误是：

> **使用泛型方法需要 4 个类型参数*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:34:40.947

呃，你已经注意到它需要多个参数，而你显然只传递了一个 - `bool`。`list.JSONKeyName<bool, int, string, string>`根据上下文将其更改为 。

# javascript - 在 Javascript 中卡住 SICP 练习 1.1.7

> ID：15263825
> 
> 赞同：2
> 
> 时间：2013-03-07T05:31:18.370
> 
> 标签：javascript, recursion, functional-programming, scheme, sicp

我决定尝试通过 MIT SICP 课程，但使用 Javascript。

以下代码输出未定义，但它应该输出 5 的平方根的相当准确的猜测。

我已经测试了所有较小的函数，它们都按预期工作，问题一定出在递归guessRoot() 函数的某个地方，但我似乎看不到问题所在。

```
var square = function(x) {
    return x * x;
};
var abs = function(x) {
    return x > 0 ? x : -x;
};
var goodEnough = function(g, x) {
    return abs(square(g) - x) < 0.01;
};
var average = function(x, y) {
    return (x + y) / 2;
};
var improve = function(g, x) {
    return average(g, (x / g));
};
var guessRoot = function(guess, x) {
    if (goodEnough(guess, x)) {
        return guess;
    } else {
        guessRoot(improve(guess, x), x);
    }
};
console.log(guessRoot(2.5, 5)); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T05:35:42.863

看起来您只是`return`在递归步骤中缺少 a 。

```
var guessRoot = function(guess, x) {
    if (goodEnough(guess, x)) {
        return guess;
    } else {
        return guessRoot(improve(guess, x), x); // ... here
    }
}; 
```

[http://jsfiddle.net/mattball/TyLsL](http://jsfiddle.net/mattball/TyLsL)

# multithreading - 如何将线程转换为多线程？

> ID：15263835
> 
> 赞同：0
> 
> 时间：2013-03-07T05:32:22.577
> 
> 标签：multithreading, client-server

我想通过以下代码将线程转换为 newFixedThreadpool() 我该怎么做？

//saddddddddddddddddddddddddddddffgfggggggggggggggggggggggggfdhfdhfdhdhdfhjhljgjhgdadsadsafds

班级客户：

```
 import java.io.File;  
 import java.io.FileInputStream;  
 import java.io.ObjectInputStream;  
 import java.io.ObjectOutputStream;  
 import java.net.Socket;  
 import java.util.Arrays;  
 import java.lang.*;  
 import java.util.Scanner;  

public class Client {  

public static void main(String[] args) throws Exception {  
    String fileName = null;  

   try {  
        fileName = args[0];  
    } catch (Exception e) {  
    System.out.println("Enter the name of the file :");  
    Scanner scanner = new Scanner(System.in);  
    String file_name = scanner.nextLine();  

    File file = new File(file_name);  
    Socket socket = new Socket("localhost", 3332);  
    ObjectInputStream ois = new ObjectInputStream(socket.getInputStream());  
    ObjectOutputStream oos = new ObjectOutputStream(socket.getOutputStream());  

    oos.writeObject(file.getName());  

    FileInputStream fis = new FileInputStream(file);  
    byte [] buffer = new byte[Server.BUFFER_SIZE];  
    Integer bytesRead = 0;  

    while ((bytesRead = fis.read(buffer)) > 0) {  
        oos.writeObject(bytesRead);  
        oos.writeObject(Arrays.copyOf(buffer, buffer.length));  
    }  

    oos.close();  
    ois.close();  
    System.exit(0);      
   }  

   }  

   } 
```

班级服务器：

```
 import java.io.FileOutputStream;  
 import java.io.*;
 import java.io.ObjectInputStream;  
 import java.io.ObjectOutputStream;  
 import java.net.ServerSocket;  
 import java.net.Socket;  

public class Server extends Thread {  
public static final int PORT = 3332;  
public static final int BUFFER_SIZE = 100;  

public void run() {  
    try {  
        ServerSocket serverSocket = new ServerSocket(PORT);  

        while (true) {  
            Socket s = serverSocket.accept();  
            saveFile(s); 
        }  
    } catch (Exception e) {  
        e.printStackTrace();  
    }  
}  

private void saveFile(Socket socket) throws Exception {  
    ObjectOutputStream oos = new ObjectOutputStream(socket.getOutputStream());  
    ObjectInputStream ois = new ObjectInputStream(socket.getInputStream());  
    FileOutputStream fos = null;  
    byte [] buffer = new byte[BUFFER_SIZE];  

    Object o = ois.readObject();  

    if (o instanceof String) {  
        fos = new FileOutputStream(new File("/home/reza/Desktop/reza"));  
    } else {  
        throwException("Something is wrong");  
    }  

    Integer bytesRead = 0;  

    do {  
        o = ois.readObject();  

        if (!(o instanceof Integer)) {  
            throwException("Something is wrong");  
        }  

        bytesRead = (Integer)o;  

        o = ois.readObject();  

        if (!(o instanceof byte[])) {  
            throwException("Something is wrong");  
        }  

        buffer = (byte[])o;  

        fos.write(buffer, 0, bytesRead);  

    } while (bytesRead == BUFFER_SIZE);  

    System.out.println("File transfer success");  

    fos.close();  

    ois.close();  
    oos.close();  
}  

public static void throwException(String message) throws Exception {  
    throw new Exception(message);  
}  

public static void main(String[] args) {  

new Server().start();  
}  
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:52:11.700

```
public class Server extends Thread {  
  public void run() {
    try {  
      ServerSocket serverSocket = new ServerSocket(PORT);  
      while (true) {  
        Socket s = serverSocket.accept();  
        new ServerWorker(s).start();
      }  
    } catch (Exception e) {  
      e.printStackTrace();  
    }
  }  
}  

public class ServerWorker extends Thread {
  private Socket _socket;

  public ServerWorker(Socket socket) {
    this._socket = socket;
  }

  public void run() {
    saveFile(this._socket);
    // Thread should terminate when run returns.
  }

  private void saveFile(Socket socket) throws Exception {  
    ...
  }
} 
```

# python - pdb 使 web2py 崩溃并在终端中留下一个 Abort Trap: 6

> ID：15263836
> 
> 赞同：0
> 
> 时间：2013-03-07T05:32:26.827
> 
> 标签：python, web2py, pdb

我运行`python web2py.py`终端（mac ox lion）并转到我的控制器非常简单。在我有我认为正在执行的代码之前，但现在我的代码中只剩下一个 this 并且我仍然遇到问题：

```
def login():
    import pdb
    pdb.set_trace()
    value = 'test'
    return dict(test=value) 
```

从这里我得到：

```
/Users/auser/web/public/applications/api/controllers/profile.py(10)login()
-> value = 'test'
(Pdb) Tcl_WaitForEvent: Notifier not initialized
Abort trap: 6 
```

有谁知道这里发生了什么。我正在使用 Mac OSX 附带的标准 Python 风格 - Python 2.7.1

系统挂起一瞬间，然后吐出`Abort Trap: 6`. 然后我从 mac osx 得到“你想用 python 报告这个问题吗”的嫌疑人，因为它认为世界爆炸了。我不知道 web2py 是否有一个终止开关或 pdb 有什么，但它让我发疯。

当不涉及 web2py 时 pdb 工作正常我也测试过。

我不想下载 winpdb，因为我必须切换我所在的 python 环境（64 到 32），我真的不想这样做并造成另一个头痛。特别是当它在没有 web2py 的情况下工作时？

任何帮助将不胜感激。

干杯，

森森蒂亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:50:30.607

我走错路了。它一定是试图冻结 web2py 服务器并导致严重故障。

我现在使用它的方式是在交互式 shell 模式下修复服务器环境问题 - 我不敢相信我之前没有尝试过。

我使用相同的代码：

```
def login():
    import pdb
    pdb.set_trace()
    value = 'test'
    return dict(test=value) 
```

并在终端使用它

```
python web2py.py --shell=/api/profile/login -M 
```

然后它应该会中断。

愤怒平息……

# java - 确认客户端收到生产者消息

> ID：15263841
> 
> 赞同：1
> 
> 时间：2013-03-07T05:32:51.413
> 
> 标签：java, queue, jms, activemq, producer-consumer

我有一个实现消息生产者的 Java 类，它将消息发送到名为 test 的队列。我有另一个类作为客户端，它从同一个队列中获取消息。我对如何知道客户端是否已收到消息感到困惑。我在某个地方读到了我应该使用的东西`message.acknowledge()`，但我不知道这样做的正确方法。我的代码如下所示：

制片人：

```
public class Producer {
    private static String url = ActiveMQConnection.DEFAULT_BROKER_URL;

    private static String subject = "que";

    public static void main(String[] args) throws JMSException,
            InterruptedException {

        ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(url);
        Connection connection = connectionFactory.createConnection();
        connection.start();

        Session session = connection.createSession(false,
                Session.AUTO_ACKNOWLEDGE);

        Destination destination = session.createQueue(subject);

        MessageProducer producer = session.createProducer(destination);

        // 
        int i = 0;
        //while(true)
        // {
        TextMessage message = session
                .createTextMessage("this is a gfjfjf " + i);
        Thread.sleep(2000);
        // 
        producer.send(message);
        i++;
        System.out.println("Sent message '" + message.getText() + "'");
        System.out.println(ActiveMQConnection.DEFAULT_BROKER_URL);
        MessageListener ML = session.getMessageListener();
        System.out.println(ML);
        connection.close();
    }
} 
```

消费者：

```
public class Consumer {

    private static String url = "failover://tcp://192.168.1.17:61616";

    private static String subject = "que";

    public static void main(String[] args) throws JMSException {
        ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(url);
        Connection connection = connectionFactory.createConnection();
        connection.start();

        Session session = connection.createSession(false,
                Session.AUTO_ACKNOWLEDGE);

        Destination destination = session.createQueue(subject);

        MessageConsumer consumer = session.createConsumer(destination);

        // while(true)
        //  {
        Message message = consumer.receive();

        System.out.println(message);

        if (message instanceof TextMessage) {
            TextMessage textMessage = (TextMessage) message;
            System.out.println("Received message '" + textMessage.getText()
                    + "'");
        }
        if (session.getAcknowledgeMode() == Session.CLIENT_ACKNOWLEDGE) {
            System.out.println(session.getAcknowledgeMode());
            System.out.println(Session.CLIENT_ACKNOWLEDGE);
            message.acknowledge();
        }
        System.out.println(session.getAcknowledgeMode());
        System.out.println(Session.CLIENT_ACKNOWLEDGE);
        message.acknowledge();

    }
} 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T08:15:46.263

您不能使用确认来检查是否已收到消息。

实际上，一般的消息传递，特别是 JMS 的设计目的是使发送应用程序不需要知道消息是否已到达客户端。这个概念被称为保证交付。

致谢是其中的一部分。如果您读取队列的消息但未确认，JMS 代理将在稍后尝试重新传递该消息。您可以使用可以提交或回滚的事务将概念提升到另一个层次。

如果您确实需要消息的原始发件人的回执，我建议您发送消息作为回复。JMS 具有使用相关 id 和 ReplyTo 字段的 Request/Reply 示意图。您可以在 Google 上搜索很多示例，但[这里是 EIP 中的一个](http://www.eaipatterns.com/RequestReplyJmsExample.html)。

# c# - Windows 应用商店应用程序 - 拖动项目时 ListView 增加高度

> ID：15263843
> 
> 赞同：2
> 
> 时间：2013-03-07T05:33:06.800
> 
> 标签：c#, windows-runtime, winrt-xaml

我有两个 ListView，它们的大小根据内容而变化。现在我需要将项目从一个拖到另一个。当目标列表中至少有一项时，拖放工作。但是如果目标列表中没有任何项目，则 drop 不起作用，因为它的高度为 0。

有什么办法可以克服这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T09:09:59.983

你可以使用你的`MinHeight`财产`ListView`

# yii-extensions - Yii 中用户友好的日期过滤器

> ID：15263848
> 
> 赞同：0
> 
> 时间：2013-03-07T05:33:30.040
> 
> 标签：yii-extensions, yii, yii-events

我有一个奇怪的问题，我有一个模型，一个属性是 create_time（时间戳）。我必须在视图中将时间戳显示为用户友好的日期（YMD）格式，但问题是当我搜索日期说仅使用日期（23）或仅年份（2013）时，我收到 php 警告而不是它的工作当输入整个字符串时。到目前为止，我已经完成了以下工作：

```
//Controller Action:
$dataProvider = new MyModel('search');
                $dataProvider -> unsetAttributes();// clear any default values

                if (isset($_GET['MyModel'])) {
                        $dataProvider -> attributes = $_GET['MyModel'];
                }
                $this -> render('MyView', array('dataProvider' => $dataProvider, ));

//My View page

$this->widget('zii.widgets.grid.CGridView', array(
'id' =>'list-grid',
    'dataProvider'=>$dataProvider->search(),
    'filter' =>$dataProvider, 
    'columns'=>array(
        array(
        'first_name',          
        'last_name',
        'consult_price',
        'create_time'=>array('name'=>'create_time',
                                                'header' =>'Profile Created In',
                                                'value'=>'Components::userFriendlyDate($data->id);',// or before validate and afterFind on Model
                                                'htmlOptions' =>array('style'=>'text-align: center'),
                                                ..................

// My Model
$criteria = new CDbCriteria;
                if (!empty($this -> create_time)) {
                       // as i say this explodes a string with y-m-d format so i am getting an error.
                        list($day, $month, $year) = explode("/", $this -> create_time);
                        $daystart = mktime(0, 0, 0, (int)$month, (int)$day, (int)$year);
                        $dayend = mktime(23, 59, 59, (int)$month, (int)$day, (int)$year);
                        $criteria -> condition = ':s<=create_time AND create_time<=:e';
                        $criteria -> params = array(':s' => $daystart, ':e' => $dayend);
                }
$criteria -> compare('create_time', $this -> convert($this -> create_time));
return new CActiveDataProvider($this, array('criteria' => $criteria, ));

//where convert function goes likes this:
  public function convert($date) {

        if ($date == NULL)
                return $date;
        //null shows all records
        else {
                list($day, $month, $year) = explode("/", $this -> create_time);
                $daystart = mktime(0, 0, 0, (int)$month, (int)$day, (int)$year);
                $dayend = mktime(23, 59, 59, (int)$month, (int)$day, (int)$year);
                $sql = "SELECT create_time FROM MYTable WHERE create_time BETWEEN '$dayend' AND '$daystart'";
                $result = Yii::app() -> db -> createCommand($sql) -> queryAll();
                return $result;
        }
    } 
```

有没有人在搜索中使用时间戳字段转换？需要帮助 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T07:03:20.430

错误在`list($day, $month, $year) = explode("/", $this -> create_time)`。这是因为`list($variables)`期望一个数组具有至少与要分配的变量相同数量的元素。在执行此行之前，您需要用缺少的字段（日、月或年）填充日期。

您可以使用[日期选择器](http://www.yiiframework.com/doc/api/1.1/CJuiDatePicker)作为您的字段，以确保`$create_time`始终具有日、月和年。

或者：

1.  为日、月和年添加单独的字段
2.  如果为空，则将它们分别设置为当前日、月和年
3.  将它们组合起来形成`$create_time`.

# ruby - Rails Resque 工人被杀

> ID：15263852
> 
> 赞同：0
> 
> 时间：2013-03-07T05:33:45.623
> 
> 标签：ruby, ruby-on-rails-3, resque

我正在运行 Redis，resque 工作从 redis 中获取任务并执行它。

当我启动 resque 工作人员时

```
COUNT=3 QUEUE=* bundle exec rake resque:workers 
```

我可以看到 resque 工作人员已启动

```
root  15347 95.8  0.2 268804 98844 pts/1    Sl   10:59   0:16 /usr/local/bin/ruby /usr/local/bin/rake resque:workers
root  15383  0.0  0.0  67752 17860 pts/1    Rl   10:59   0:00 /usr/local/bin/ruby /usr/local/bin/rake resque:work
root  15385  0.0  0.0  71872 18100 pts/1    Rl   10:59   0:00 /usr/local/bin/ruby /usr/local/bin/rake resque:work
root  15388  0.0  0.0  67752 17856 pts/1    Rl   10:59   0:00 /usr/local/bin/ruby /usr/local/bin/rake resque:work 
```

但几秒钟后，这些作品就被杀死了。我尝试使用**VERBOSE**查看日志。但它没有给出任何错误。

1.  这是redis或resque的问题吗？
2.  如何解决这个问题，这样我就不会丢失保存在 redis 中的任何数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-19T06:24:08.267

Resque 工作人员被杀，因为我从后台作业中删除了一个类，而 resque 工作人员正在搜索该类。

当类不存在时，它已经失败并被杀死而没有给出任何错误！

# java - 从 JAVA MySQLdb 导入调用 Python 脚本

> ID：15263854
> 
> 赞同：3
> 
> 时间：2013-03-07T05:33:48.220
> 
> 标签：java, python, jakarta-ee

我正在从我的 Java 代码中调用 Python 脚本。这是代码：

```
导入 java.io.BufferedReader；
导入 java.io.IOException；
导入 java.io.InputStreamReader；

公共类 JavaRunCommand {
    公共静态 void main(String args[]) 抛出 IOException {

        // 设置命令和参数
        字符串 pythonScriptPath = "我的路径";
        字符串[] cmd = 新字符串[2];
        cmd[0] = "python2.6";
        cmd[1] = pythonScriptPath;

        // 创建运行时执行外部命令
        运行时 rt = Runtime.getRuntime();
            进程 pr = rt.exec(cmd);

        // 从 python 脚本中检索输出
        BufferedReader bfr = new BufferedReader(new InputStreamReader(
                pr.getInputStream()));
        字符串行 = "";
        while ((line = bfr.readLine()) != null) {
            //以python脚本的形式显示每个输出行
            System.out.println(line);
        }
    }

}

```

**python.py**有效

```
导入操作系统
从统计导入 *

c = 5
打印 c

```

**python.py**不起作用

```
导入 MySQL 数据库
导入操作系统
从统计导入 *

c = 5
打印 c
# 一些数据库代码下来

```

所以，我正处于一个关键阶段，我的创业有最后期限，我必须向客户展示我的 MVP 项目，我正在考虑像这样调用 Python 脚本。当我在没有 dB 连接和 MySQLdb 库的情况下打印任何内容时，它可以工作。但是当我包含它们时，它不会运行 python 脚本。这里有什么问题。不是假设运行处理所有输入的过程。我安装了 MySQLdb，并且脚本在没有 java 代码的情况下运行。

我知道这不是解决问题的最佳方法。但是为了向客户展示一些东西，我需要这个东西工作。有什么建议么 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T03:52:27.727

所以，我发现问题在于我在 Java 中传递的参数来运行 python 程序。

第一个参数是 - python 2.6 但它应该只是 python 而不是某个版本号，因为 MySQLdB 和 python 存在兼容性问题。

我最终决定在 python 代码中使用 MySQL Python 连接器而不是 MySQLdB。它就像魅力一样工作，问题得到了解决！

# wcf - 来自主机应用程序的 WCF 调用函数

> ID：15263857
> 
> 赞同：1
> 
> 时间：2013-03-07T05:34:33.087
> 
> 标签：wcf, wcf-hosting

我是 WCF 的新成员，并试图找出满足我要求的最佳方法。我有一个使用以下代码托管 WCF 服务的应用程序：

```
Uri u1 = new
Uri("http://localhost:8732/Client1/WcfServiceLibrary1/Service1/"); Uri
u2 = new
Uri("http://localhost:8732/Client1/WcfServiceLibrary1/Service1/mex");
WSHttpBinding binding = new WSHttpBinding(); 

sHost = new ServiceHost(typeof(WcfServiceLibrary1.Service1), u1);
ServiceMetadataBehavior meta = new ServiceMetadataBehavior();
meta.HttpGetEnabled = true;
sHost.AddServiceEndpoint(typeof(WcfServiceLibrary1.IService1), binding, u1); 
sHost.Description.Behaviors.Add(meta); sHost.Open(); 
```

我可以在客户端应用程序上创建服务引用并在此服务上调用方法没有问题。使用下面的代码。

```
remoteService.Service1Client client = new remoteService.Service1Client(); 
remote.Text = client.GetData(3); 
```

我也可以调用没有服务引用的方法。

```
EndpointAddress myEndpoint = new EndpointAddress("http://localhost:8732/Client1/WcfServiceLibrary1/Service1/");
WSHttpBinding myBinding = new WSHttpBinding();

ChannelFactory<IService1> ServiceConnectionFactory = new ChannelFactory<IService1>(myBinding, myEndpoint);
IService1 serviceConnection = ServiceConnectionFactory.CreateChannel(); 
```

如果我尝试在主机应用程序中执行相同的代码，则会出现以下错误。

> 00:01:00 后等待回复时请求通道超时。增加传递给 Request 调用的超时值或增加 Binding 上的 SendTimeout 值。分配给此操作的时间可能是较长超时的一部分。

应用程序如何使用和使用它当前托管的 WCF 服务？我需要在自己的线程中打开服务吗？

这个想法是让主机在客户端连接之前触发一些初始化。

# r - R中关于空间连接的问题

> ID：15263859
> 
> 赞同：2
> 
> 时间：2013-03-07T05:34:37.777
> 
> 标签：r, gis, shapefile

我在尝试在 csv 中的 shapefile 和数据表之间进行空间连接时遇到了一些麻烦。

```
Here's what my data looks like:
Point Shapefile's attribute data (StudentID):
ID      Address  Long  Lat
123.00  street   long  lat
456.00  street   long  lat
789.01  street   long  lat
223.00  street   long  lat
412.02  street   long  lat

Data Table (Table):
ID     Name Age School
123.00 name age school
456.00 name age school
789.01 name age school
223.00 name age school
412.02 name age school 
```

重要提示：`StudentID`包含大约 500 条记录，而 Table 只有 250 条。其中的某些记录`StudentID`将不匹配。

问题1：

我有一个 excel 文件，我将其转换为 csv 以导入 R。在运行连接时，我注意到我的一些数据格式在 ID 列中发生了变化（因此`123.00`将变为`123;` `456.00`相同`456;` `789.01`）。但是，当我在记事本中打开 csv 文件时，格式是正确的。我尝试将表格读取为 .txt 文件，但没有运气。有谁知道为什么会发生这种情况以及有什么方法可以克服这个问题？

因为我无法基于完全匹​​配加入数据，所以我决定尝试部分加入，因为 IDS 是唯一的，无论最后 2 位如何，这导致我遇到问题 2...

问题2：

这是我用来加入两者的：

```
StudentID@data = data.frame(StudentID@data, data[charmatch(StudentID@data$ID,Table$ID,]) 
```

这加入了数据，但也如预期的那样返回了带有 NA 的行。我使用 na.omit 删除了行，结果数据包含所有匹配的数据。但是，在 shapefile 中，我的所有观点仍然存在。为什么这些点在记录被删除后仍然存在？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T19:26:38.467

问题1：

Excel 有时会使用逗号`,`作为小数分隔符导出浮点值。这可能会导致 csv 导入出现问题。确保 excel 使用点`.`作为小数分隔符，或者在导入时指定分隔符，即`read.csv('file.csv', sep=';')`.

问题 2：如果要从 shapefile 中删除具有 na 值的点，则需要一个逻辑向量来选择不再需要的行。这是一个看起来如何的示例（假设您的 shapefile 被命名`student_points`）

`student_points <- student_points[!is.na(student_points@data$age), ]`

# ruby - TypeError：尝试使用 rspec 时错误的参数类型字符串（预期的模块）

> ID：15263862
> 
> 赞同：3
> 
> 时间：2013-03-07T05:34:51.077
> 
> 标签：ruby, string, rspec

检查字符串中子字符串的包含情况。

我认为我使用了[此处](http://rspec.rubyforge.org/rspec/1.1.9/classes/Spec/Matchers.html)记录的正确语法，但它对我不起作用。我错过了什么？

```
>> require 'rspec-expectations'
=> true
>> s = 'potato'
=> "potato"
>> s.include?('tat')
=> true
>> s.should include('tat')
TypeError: wrong argument type String (expected Module)
    from (irb):4:in `include'
    from (irb):4
    from /usr/bin/irb:12:in `<main>' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T22:33:26.300

应该期望一个匹配器对象，所以回答您的问题的最简单方法是：

```
>> require 'rspec-expectations'
=> true
>> s = 'potato'
=> "potato"
>> s.should RSpec::Matchers::BuiltIn::Include.new('tat')
=> true 
```

让我们讨论一下不同的匹配器**eq**（因为有一些关于**include**）

```
>> require 'rspec-expectations'
=> true
>> s = 'potato'
=> "potato"
>> s.should eq('potato')
NoMethodError: undefined method `eq' for main:Object 
```

为了让**eq**工作，我们可以包含[RSpec::Matchers](https://github.com/rspec/rspec-expectations/blob/master/lib/rspec/matchers.rb)模块（方法定义从第 193 行开始）

```
>> require 'rspec-expectations'
=> true
>> s = 'potato'
=> "potato"
>> include RSpec::Matchers
>> s.should eq('potato')
=> true 
```

因此，您缺少的是使用 RSpec::Matchers 模块方法扩展对象，或者只是将匹配器传递给 should 方法。

**IRB 中包含**匹配器的问题仍然存在（不是 100% 确定原因）：

```
>> require 'rspec-expectations'
=> true
>> s = 'potato'
=> "potato"
>> include RSpec::Matchers
>> s.should include('tat')
TypeError: wrong argument type String (expected Module) 
```

它可能与在主对象的上下文中工作有关：

```
>> self
=> main
>> self.class
=> Object
>> Object.respond_to(:include)
=> false
>> Object.respond_to(:include, true) #check private and protected methods as well
=> true 
```

对象有一个私有方法包括。RSpec::Matchers 中的 Include 方法永远不会有机会被调用。如果你将它包装在一个包含 RSpec::Matchers 的类中，那么一切都应该工作。

Rspec使用 MiniTest::Unit::TestCase [RSpec::Matchers](https://github.com/rspec/rspec-expectations/blob/master/lib/rspec/matchers.rb)（第 168 行）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-06T23:37:49.230

您需要围绕期望设置一个`context`或块。`it`

# html - 你们对这个“-moz-linear-gradient”业务有什么看法？

> ID：15263867
> 
> 赞同：1
> 
> 时间：2013-03-07T05:35:01.987
> 
> 标签：html, css

所以我为我的页面样式抓取了一些 CSS，它是什么，并给了我一个漂亮的旧彩虹渐变背景。

```
background-color:#ff0000;
background-image: -moz-linear-gradient( left, #ff0000, #ffa500 13.0%,#ffff00 26.0%,#0000ff 39.0%,#008000 52.0%,#4b0082 65.0%,#ee82ee 78.0%);
background-image: -webkit-linear-gradient( left, #ff0000, #ffa500 13.0%,#ffff00 26.0%,#0000ff 39.0%,#008000 52.0%,#4b0082 65.0%,#ee82ee 78.0%);
background-image: -o-linear-gradient( left, #ff0000, #ffa500 13.0%,#ffff00 26.0%,#0000ff 39.0%,#008000 52.0%,#4b0082 65.0%,#ee82ee 78.0%);
background-image: -ms-linear-gradient( left, #ff0000, #ffa500 13.0%,#ffff00 26.0%,#0000ff 39.0%,#008000 52.0%,#4b0082 65.0%,#ee82ee 78.0%);
background-image: linear-gradient( left, #ff0000, #ffa500 13.0%,#ffff00 26.0%,#0000ff 39.0%,#008000 52.0%,#4b0082 65.0%,#ee82ee 78.0%) 
```

我正在努力解决的是这个 -moz 和 -webkit 等如何作为线性渐变场的前缀。一定要这样吗？没有任何东西可以设置它以便它与每个浏览器对话吗？你觉得我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:41:05.843

您可以使用 CSS 预处理器来减少工作量，例如：

[http://compass-style.org/examples/compass/css3/gradient/](http://compass-style.org/examples/compass/css3/gradient/)

```
@include background-image(linear-gradient(red, blue)); 
```

W3C 推荐供应商前缀，直到某项功能被实施到推荐规范中。

[http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords](http://www.w3.org/TR/CSS21/syndata.html#vendor-keywords)

除此之外，没有没有办法避免供应商前缀。

一些有趣的阅读：[CSS 供应商前缀被认为是有害的](http://www.quirksmode.org/blog/archives/2010/03/css_vendor_pref.html)

> 最初，供应商前缀的目的是允许浏览器制造商开始支持实验性 CSS 声明。
> 
> 假设一个 W3C 工作组正在讨论一个网格声明（顺便说一句，这不是一个坏主意）。让我们进一步说，有些人创建了一个规范草案，但其他人不同意某些细节。我们知道，这个过程可能需要很长时间。
> 
> 让我们进一步说，微软作为一个实验决定实施提议的网格。目前，Microsoft 无法确定该规范不会更改。因此，它没有在其 CSS 中添加网格，而是添加了 -ms-grid。
> 
> 供应商前缀表示“这是微软对正在进行的提案的解释”。因此，如果网格的最终定义不同，微软可以添加一个新的 CSS 属性网格，而不会破坏依赖于 -ms-grid 的页面

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T05:39:09.983

浏览器前缀是必需的，直到它们成为规范的一部分。例如，我们过去必须做`webkit-border-radius`，现在只需`border-radius`工作。随着支持的增加，它们将被逐步淘汰，但它们很适合用来让您的用户满意。

# clojure - jvm字节码如何在cljs build中转换为js

> ID：15263870
> 
> 赞同：5
> 
> 时间：2013-03-07T05:35:40.270
> 
> 标签：clojure

据我了解，大多数 clojure 和 java 库都可以包含在 cljs 代码中。cljs 编译器是如何做到这一点的？

我知道如果我有源文件，cljs 编译器会获取源文件并输出 javascript。但是，如果我使用诸如 joda-time 之类的 java 库，我已经包含了它的 clojure 包装器 clj-time。所以在这种情况下，它只有 joda-time 的 java 字节码。那么cljs构建工具将如何从java jar（joda-time）的字节码生成js代码呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T09:28:33.323

> 据我了解，大多数 clojure 和 java 库都可以包含在 cljs 代码中。cljs 编译器是如何做到这一点的？

你误会了。许多 clojure 库可以针对 CLJS 进行编译，只需进行很少的更改（有时甚至没有），但无法使用类文件：它必须是 .clj 源文件，编译为 javascript 而不是类文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T05:57:03.560

您不能在 cljs 代码中使用 Java 库。

# c - 我遇到了这个代码片段，如下所示。谁能建议一个 in scanf 函数的含义

> ID：15263875
> 
> 赞同：0
> 
> 时间：2013-03-07T05:35:59.630
> 
> 标签：c

`a`任何人都可以建议以下调用的含义是什么`scanf`？

```
scanf("%d a %f",&i,&f) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:38:22.943

调用中以“%”开头的字符[`scanf`](http://www.cplusplus.com/reference/cstdio/scanf/)表示变量。

例如`%d`表示整数变量，而`%f`表示浮点变量。

前面没有 a `%`（或 a `\`，表示[转义序列](https://en.wikipedia.org/wiki/Escape_sequences_in_C)）的字符按字面意思表示，因此，在您的情况下， scanf 字符串`"%d a %f"`将匹配`"233 a 4.5"`但不会匹配`"233 b 4.5"`。

（更准确地说，空白字符匹配任何连续的空白字符序列。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T05:46:55.147

```
scanf("%d a %f",&i,&f) 
```

意味着您必须输入数据，格式为 25 a 33.3

然后当你使用打印它时

```
printf("i=%d f=%f",i,f); 
```

然后你得到输出

```
i = 25 , f = 33.3 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T06:09:01.053

`f`由于`&`行中的，您没有获得变量的值`scanf("%d a %f",&i,&f)`

这`&`意味着您正在获取`f`内存中变量的地址。您应该删除 '`&`以获得变量的实际值。

对于一个：

*   非空白字符，格式说明符 (%) 除外：任何不是空白字符（空格、换行符或制表符）或格式说明符的一部分（以 % 字符开头）的字符都会导致函数读取下一个字符从流中，将其与此非空白字符进行比较，如果匹配，则将其丢弃，函数继续使用格式的下一个字符。如果字符不匹配，则函数失败，返回流的后续字符并将其保留为未读。

这意味着您正在将输入格式化为：

1.  输入一个十进制整数(%d)
2.  然后是一个空格
3.  然后是字符'a'
4.  另一个空间
5.  然后是浮点数（%f）。

参考：[http ://www.cplusplus.com/reference/cstdio/scanf/](http://www.cplusplus.com/reference/cstdio/scanf/)

# javascript - 如何在不使用完成方法的情况下由ajax请求构造后解析html表

> ID：15263880
> 
> 赞同：0
> 
> 时间：2013-03-07T05:36:28.753
> 
> 标签：javascript, jquery

在我的情况下，我无法在 ajax 调用完成后将代码添加到 done 语句中。所以我需要一些方法在 ajax 请求完成后解析一个表。有什么方法可以监听 dom，所以当在页面上构造或添加控件时，执行一些其他代码？

有这样的事情吗？

```
$("#table_id").live('load', function(){

           ..
    }); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:39:00.923

> 有什么办法可以让我听 dom

有[突变事件](https://developer.mozilla.org/en-US/docs/DOM/Mutation_events)，但这些事件在浏览器中的支持不一致，通常不推荐。

[`.ajaxComplete()`](http://api.jquery.com/ajaxComplete/)为所有ajax`complete`请求提供一个简单的处理程序怎么样？这似乎非常接近您的代码示例：

```
$("#table_id").ajaxComplete(function () {
    // ...
}); 
```

# content-management-system - 除了通过网站面板安装“Umbraco 软件包存储库”之外，还有其他方法可以安装 umbraco 扩展/网站实用程序吗？

> ID：15263881
> 
> 赞同：1
> 
> 时间：2013-03-07T05:36:30.493
> 
> 标签：content-management-system, installation, extension-methods, umbraco

除了通过网站面板安装“Umbraco 软件包存储库”之外，还有其他方法可以安装 umbraco 扩展/网站实用程序吗？

我想安装社交书签，但它说**“不走运！没有与社交书签匹配的项目。也许它不存在，也许它还没有被批准。毕竟，它确实需要至少 15 个社区的荣誉人们在这个存储库中制作它”**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T16:19:23.817

从[如何](http://our.umbraco.org/wiki/how-tos/packages-and-projects/how-to-install-a-package)在[Umbraco Wiki](http://our.umbraco.org/wiki)中安装软件包：

> 按照以下步骤将软件包安装到您的 Umbraco 网站：
> 
> 1.  登录到 Umbraco
> 2.  转到开发人员部分
> 3.  从树中展开 Packages 文件夹
> 4.  从这里有两种安装包的方法
>     1.  选择安装本地包或浏览 Umbraco 包存储库
> 5.  如果你安装本地包，你不需要解压包，而是将压缩包加载到 Umbraco 中。

[您可以在Our Umbraco的](http://our.umbraco.org/)[项目](http://our.umbraco.org/projects)部分找到可用软件包的完整列表。

正如您从 Umbraco 软件包存储库收到的消息中所述，只有那些拥有一定数量的荣誉的软件包才能进入其中。其余的将需要从您的本地计算机下载和安装。

# .net - 使用 vb.net 修复桌面上的 windows 窗体

> ID：15263882
> 
> 赞同：1
> 
> 时间：2013-03-07T05:36:36.040
> 
> 标签：.net, vb.net

我想在桌面上修复我的 vb 表单。我不希望其他窗口占用我的表单固定的空间。

![图像显示在屏幕顶部显示的股票代码](../Images/53d0f2dd40cfda07519afca8407423bb.png)

图片链接：http: [//i.stack.imgur.com/qshI8.jpg](https://i.stack.imgur.com/qshI8.jpg)

图像显示股票代码位于屏幕顶部。当其他窗口/应用程序打开时，该代码不应覆盖，而是新应用程序应在该代码下方打开。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T08:25:12.030

您必须在 AppBar（*应用程序桌面工具栏*）中注册您的应用程序。

为此，您需要互操作。 [这是一个](http://www.codeproject.com/KB/dotnet/AppBar.aspx)C# 示例。还有[一个](http://www.codeproject.com/Articles/3728/C-does-Shell-Part-3)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T07:30:16.817

为确保表单始终在其他人面前，您必须将`TopMost`表单的属性设置为`True`。显示后将其放在前面，只需调用该`Activate()`方法即可。

# dataset - 在sas中定义变量来清理代码

> ID：15263883
> 
> 赞同：3
> 
> 时间：2013-03-07T05:36:52.360
> 
> 标签：dataset, sas

我是来自 python、java 和 C++ 的 SAS 新手。在这些语言中，编写/重复大型语句时正确的做法是将它们封装在一个变量中，该变量在代码中定义一次并重复多次。

即，每次合并两个相似的数据集时，我不想写相同的 where 语句，而是写：

```
WHERE_CONDITION_VARIABLE = 'X in (10, 100, 1000, 10000 ......100000000);

data output;
merge in1 in2;
WHERE WHERE_CONDITION_VARIABLE;
run;

data output2;
merge in3 in4;
WHERE WHERE_CONDITION_VARIABLE;
run; 
```

不幸的是，我还没有弄清楚如何定义一个变量，比如 WHERE_CONDITION_VARIABLE 来简化代码。我要问的可以在 SAS 中做吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T09:12:54.880

您可以使用宏变量。您可以这样定义它们：

```
%let WHERE_CONDITION_VARIABLE = X in (10, 100, 1000); 
```

并像这样引用它们：

```
&WHERE_CONDITION_VARIABLE 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T16:15:08.543

SAS 有很多选项可以避免重复代码；这样，它实际上很像 python，尽管完成它的方法有点不同，因为你有一个单独的编译步骤（所以你不能像你直接问的那样直接说 WHERE）。

首先，你有宏变量。如果您只是多次重复文本，您可以在宏变量中定义它，如下所示：

```
%let condition=X in (1,10,100,1000); 
```

宏变量被视为您编写的文本。它们不需要引号或其他文本限定符，除非它们旨在将它们包含为法律代码，即：

```
%let condition=X in ('A','B','C'); 
```

是合法的，但是

```
%let condition="X in ('A','B','C')"; 
```

可能不是您想要的（除非您希望将其评估为字符串，无论如何）。

通过宏变量，您还可以在数据步中生成大量代码，然后将其包含在内。例如，如果您有一个包含条件列表的数据集，您可以通过以下方式应用它们：

```
data conditions;
format condition $50.;
input condition $;
datalines4; 
if x = 15 then y=5;
if x = 20 then y=10;
if x = 20 and z = 5 then y=15;
if x = 20 and z = 10 then y=20;
;;;;
run;

proc sql;
 select condition into :condlist separated by ' ' from conditions;
quit;

data want;
set have;
&condlist;
run; 
```

这将从“条件”数据集中获取条件并将其推送到宏变量“&condlist”中。PROC SQL 调用是将其放入宏变量的最简单方法，但还有其他方法；CALL SYMPUT 也可以在数据步骤中执行此操作，或者您可以将其写入文本文件，然后 %include 文本文件作为代码。这更常用于高级编程，通过生成对宏的调用，条件数据集提供宏参数；在这种情况下，您可能有一个宏

```
%macro cond(x=,y=,z=);
 if x=&x and z=&z then y=&y;
%mend cond; 
```

然后，您可以从只有 x,y,z 值的数据集生成对 cond 的调用：

```
proc sql;
 select cats('%cond(x=',x,',y=',y,',z=',z,')') into :condlist separated by ' ' from conditions;
quit; 
```

并以同样的方式使用它。

一般来说，宏编程是避免代码蠕变的好方法；宏被编写一次，然后可以使用不同的参数运行多次。宏可以是任何地方，从在数据步骤中执行的一行代码（如上）到包含多个 DATA 和 PROC 步骤的数百行代码。宏编程本身就是一个复杂的话题，值得一读。

* * *

您还可以在 SAS 中编写函数。PROC FCMP（函数编译）允许您编写相当复杂的函数并在您的数据步骤甚至您的 PROC 语句中执行它们。 [如果您有 9.2， http://www.lexjansen.com/pharmasug/2011/tu/pharmasug-2011-tu07.pdf](http://www.lexjansen.com/pharmasug/2011/tu/pharmasug-2011-tu07.pdf)是开始 FCMP 的好地方；如果你有 9.3，我还没有看到任何文件（但可能有一些）显示 FCMP 中的新内容。FCMP 是相当新的，因此在 SAS 的每次迭代中仍有很多变化。

这是一个 FCMP 的例子来做你的条件：

```
proc fcmp 
 outlib=work.funcs.Test; /* where will the functions be saved */ 
 function condition(x); /* declare a function returning a number */ 
 if x in (1,10,100,1000) then return(1);
 else return(0);
endsub; 
quit; 

data have;
do x = 1,5,10,20,100,150,1000,1500;
output;
end;
run;

options cmplib=work.funcs; 
data want;
set have;
if condition(x) then output;
run; 
```

* * *

您还有 CALL EXECUTE 语句，它允许您直接从数据集中执行代码。使用相同的 CONDITIONS 数据集：

```
data _null_;
 set conditions end=eof;
 if _n_ = 1 then call execute('data want; set have;');
 call execute(condition);
 if eof then call execute('run;');
run; 
```

*这将有效地构建一个数据步骤，该步骤在您的数据空*步骤之后立即执行，其代码与宏变量示例中的代码相同。调用执行的工作方式略有不同，因此虽然在此示例中应该没有任何区别，但有一些时间问题可能会导致问题（或可能是有利的）；您使用哪个取决于具体情况。特别是对于 CALL EXECUTE，请阅读文档和在线论文（最常见的是 SUGI 论文）以了解更多详细信息。

* * *

除了通过宏变量或 CALL EXECUTE 直接执行代码之外，您还有很多其他执行任务的方法来避免墙纸代码。例如，为了更轻松地执行上述 if 语句，您可以使用一种格式。格式将一个值转换为另一个值；最常见的是，您可能有类似“DOLLAR6.2”之类的东西，它可以从数字 3.5 中给您 3.50 美元。但是，格式也可用于替换 if-this-then-that 表达式。如果只有 X 和 Y（没有 Z 条件），那么你可以这样做，给定这个条件数据集：

```
data conditions;
input x y;
datalines;
1 5
2 10
3 20
4 50
5 100
;;;;
run;

data for_fmt;
set conditions;
rename x=start y=label;
fmtname='XTOY';
type='i'; *type=i means numeric informat, so numeric to numeric conversion.  Informat = to numeric, Format= to character.;
run;

proc format cntlin=for_fmt;
quit;

data want;
set have;
y = input(x,XTOY.);
run; 
```

有一行代码将 x 转换为 y。（当然有一些代码设置格式，但它可以与主代码分开，并包含在代码的设置部分中，如 c 中的 .h 文件）。

您还可以进行哈希表查找，这在您进行更复杂的转换（1 对多或多对 1）时非常有用。它们的工作方式就像听起来一样 - 您将哈希表加载到内存中并执行查找。 [http://support.sas.com/rnd/base/datastep/dot/hash-getting-started.pdf](http://support.sas.com/rnd/base/datastep/dot/hash-getting-started.pdf)是一个很好的起点。

* * *

最后，避免重复代码的一种好方法是使用更少的单独数据集。SAS 数据步骤和过程具有可用的“BY”语句，这意味着它们将 BY 变量的每个不同值视为有效的单独数据集。变量名称和长度需要匹配，因为它在技术上仍然是一个数据集，但是如果您有许多相似数据的数据集，并且希望对每个数据集执行相同的操作，您可以使用 BY 语句执行一次而不是多次.

例如，假设您有数据集 SASHELP.CARS。您可能想为每种汽车品牌单独计算一些东西。你可以这样做：

```
data acura;
set sashelp.cars;
if make='ACURA';
run;    

data honda;
set sashelp.cars;
if make='HONDA';
run; 
```

然后分别在每个数据集上运行您的代码。然而，一个更 SASsy 的方法是使用 BY 语句：

```
proc means data=sashelp.cars;
by make;
var mpg_city mpg_highway;
run; 
```

现在，每个品牌都有一个单独的页面。您也可以在数据步处理中使用 BY 语句；你会得到变量 FIRST.make 和 LAST.make ，它们会告诉你你是在新 MAKE 的第一条记录上还是在 MAKE 的最后一条记录上（值变化之前的记录），这使你可以根据关于您在数据集的 BY 组中的位置（例如，`if first.make then counter=0;`将允许您拥有一个计数器，每次您在`make`.在使用它之前（或在该变量上有一个索引，或两者兼而有之）。这对于分析 bootstrap 样本或其他拥有许多几乎相同数据集并对它们执行相同操作的过程非常有帮助。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-07T06:14:00.727

我假设您想将所有 WHERE 条件变量放入一个桶中，然后根据类似结构的索引 (Python) 使用它们。

如果是这种情况，那么您可能想看看“INTO”。在“INTO”中，您将放弃所有的 X。然后你可以随时拿走它们。

# algorithm - 排序算法边界证明

> ID：15263884
> 
> 赞同：0
> 
> 时间：2013-03-07T05:36:55.903
> 
> 标签：algorithm, sorting

基于这张幻灯片： http: [//oi48.tinypic.com/27xmg47.jpg](http://oi48.tinypic.com/27xmg47.jpg)

Q1> 为什么`N!`不同的排序`=>`至少`N!`离开？

Q2> 为什么`#leaves >= N!`？

2^h >= #leaves 的原因是 2^h 表示完全二叉树中的叶子数，而#leave 大部分时间来自不完全二叉树。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T06:22:41.697

有`N!`不同的顺序。该算法必须准确地确定存在哪种排序，因此其决策树必须至少有`N!`叶子。否则，它将无法区分所有可能的排序。

# android - In App Billing 是否支持多个帐户？

> ID：15263889
> 
> 赞同：10
> 
> 时间：2013-03-07T05:37:17.843
> 
> 标签：android, in-app-purchase, google-play, in-app-billing, multi-user

InApp[**计费（V2 或 V3）**](http://developer.android.com/google/play/billing/billing_overview.html)是否适用于使用多个帐户并使用非主要帐户进行购买的用户？

PD：需要一些解释，不简单的是/否

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-19T05:42:44.697

在 App Billing 支持多个帐户报告为[**code.google**](https://code.google.com/p/android/issues/detail?id=53307)中的错误，看看它

根据 Mr.Sergej（发布在 G+ android 开发社区）的说法，使用第一个帐户购买的应用内产品在使用多个用户帐户时将不再有效！。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T05:45:05.190

InApp 计费只是向用户收费并告诉您的应用程序是否成功。由您决定如何为用户提供他们购买的东西。

您可以...切换应用程序的 SharedPreferences 以保存他们的购买。显然，多个人可以在同一台设备上使用同一个应用程序进行购买。

提供登录功能以将购买保存到服务器，以防用户删除应用程序或获取新设备。

使用一次性购买来检查用户之前是否购买过。这不会转移到不同设备上的多个帐户/每个设备上的多个帐户。

# memory-leaks - Lua 中是否收集了数字、布尔值或 nils 垃圾？

> ID：15263891
> 
> 赞同：4
> 
> 时间：2013-03-07T05:37:22.860
> 
> 标签：memory-leaks, garbage-collection, lua

[本文](http://www.jucs.org/jucs_11_7/the_implementation_of_lua/jucs_11_7_1159_1176_defigueiredo.html)暗示除数字、布尔值和 nil 之外的所有类型都被垃圾回收。

> 字段 gc 用于其他值（字符串、表、函数、重用户数据和线程），这些值是垃圾回收的对象。

这是否意味着在某些情况下过度使用这些非 gc 类型可能会导致内存泄漏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T09:10:43.410

在 Lua 中，实际上有 2 种类型：始终按值传递的类型和按引用传递的类型（根据[Lua 手册中的第 2.1 章](http://www.lua.org/manual/5.2/manual.html#2.1)）。

您引用的都是“按值传递”类型，因此它们直接存储在变量中。如果您删除该变量，该值将立即消失。

所以它不会开始泄漏内存，当然，除非你不断生成包含新值的新变量。但在那种情况下，这是你自己的错；）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T15:46:51.487

在您链接到的文章中，他们写下了显示值如何表示的 C 代码：

```
/*You can also find this in lobject.h in the Lua source*/
/*I paraphrased a bit to remove some macro magic*/

/*unions in C store one of the values at a time*/
union Value {
  GCObject *gc;    /* collectable objects */
  void *p;         /* light userdata */
  int b;           /* booleans */
  lua_CFunction f; /* light C functions */
  numfield         /* numbers */
};

typedef union Value Value;

/*the _tt tagtells what kind of value is actually stored in the union*/
struct lua_TObject {
  int _tt;
  Value value_;
}; 
```

正如您在此处看到的，布尔值和数字直接存储在 TObject 结构中。由于它们不是“堆分配的”，这意味着它们永远不会“泄漏”，因此垃圾收集它们是没有意义的。

然而，一个有趣的事情是垃圾收集器不收集创建的对事物的 C 端事物（用户数据和 CC 函数）的引用。这些需要从 C 端[手动管理](https://stackoverflow.com/questions/3578401/lua-garbage-collection-userdata)，但这是意料之中的，因为在这种情况下，您正在编写 C 而不是 Lua。

# javascript - 为什么存在 `getUTCSeconds` 和 `getUTCMilliseconds` 函数？

> ID：15263892
> 
> 赞同：7
> 
> 时间：2013-03-07T05:37:41.697
> 
> 标签：javascript

这些值不总是与`getSeconds`and相同`getMilliseconds`吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-07T05:58:39.417

本地时间和 UTC 时间之间的调整基于指定为毫秒数的偏移量。

[http://es5.github.com/#x15.9.1.7](http://es5.github.com/#x15.9.1.7)说

> # 15.9.1.7 本地时区调整
> 
> 预计 ECMAScript 的实现将确定本地时区调整。**本地时区调整是以毫秒为单位**的 LocalTZA 值，当添加到 UTC 时，它代表本地标准时间。LocalTZA 不反映夏令时。LocalTZA 的值不随时间变化，而仅取决于地理位置。

至于什么时候有用，[http://bugs.python.org/issue5288](http://bugs.python.org/issue5288)解释了一个 API 问题，该问题是假设时区偏移量是整数分钟而引起的：

> Olson 时区数据库（由大多数 UNIX 系统和 Mac OS X 使用）有许多具有历史偏移量的时区，这些时区使用秒分辨率（从这些位置切换到与 GMT 的四舍五入偏移量之前）。

一旦你达到第二个分辨率，没有一个`getUTCMillis`公正似乎是一种奇怪的不对称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:51:17.953

因为有[闰秒](http://en.wikipedia.org/wiki/Leap_second)。

# c++-cli - 我可以在 C++/CLI 中使用原生原始类型吗？

> ID：15263895
> 
> 赞同：4
> 
> 时间：2013-03-07T05:38:01.117
> 
> 标签：c++-cli

和 C# 一样，int 是 System::Int32 的别名，它是一个 CLR 类型。有没有办法可以使用本机“int”，这意味着标准 C++ 中的 int？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T06:34:38.427

C++/CLI 原始类型具有双重身份。类型关键字匹配本机 C++ 类型*和*CLR 类型，具体取决于上下文。并且具有本机类型的变量继承了 CLR 类型上可用的方法，例如`ToString`.

我认为这篇解释本机类型和托管类型之间关系的博客文章非常有帮助：http: [//blogs.msdn.com/b/branbray/archive/2005/07/20/441099.aspx](http://blogs.msdn.com/b/branbray/archive/2005/07/20/441099.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-27T13:02:28.533

我认为接受的答案不能回答 OP 的问题。

如果`/clr`编译器开关打开，则`int`关键字表示`System::Int32`，它不是本机的。
如果`/clr`编译器开关关闭，则`int`关键字表示本机 C/C++ `int`，它不受管理。

使用`System::Int32`意味着对原生的显着性能损失`int`（您可以衡量它）。

您可以关闭每个文件的`/clr`编译器开关。`.cpp`它不是一个项目选项，它是一个翻译单元（.cpp 文件）选项。
右键单击文件，然后单击属性等...

因此，您可以在文件中编写一些本机代码`.cpp`（编译时`/clr`关闭）。
然后，您可以在另一个文件中编写托管代码（使用`/clr`on 编译）并调用本机代码。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-07T06:28:21.767

它们是一样的，继续在`int`任何你想要原生类型的地方使用。

# java - 如果我用对象字段填充列表，我的对象是否可以在列表保持在范围内时被垃圾收集？

> ID：15263899
> 
> 赞同：0
> 
> 时间：2013-03-07T05:38:29.370
> 
> 标签：java, garbage-collection

我在这里为一个概念而苦苦挣扎，而不是一段特定的代码。我觉得我被误导了，我正在努力解决这个问题。

这是一些示例代码：

```
List myList = new ArrayList<String>();

for (int i=1; i<11; i++) {
    Foo myObject = new Foo();
    myList.add(myObject.Bar)
} 
```

有人告诉我，因为`myList`包含对它的全部引用，`myObject.Bar`所以在超出范围`myObject`之前将不符合 GC的条件。`myList`有人告诉我，如果我这样做了

```
List myList = new ArrayList<String>();

for (int i=1; i<11; i++) {
    Foo myObject = new Foo();
    myList.add(new String(myObject.Bar))
} 
```

相反，`myObject`它有资格获得 GC，因为它没有被“强烈引用”。

好像不太对，谁能给我解释一下？

请随时更正我的术语，Java 不是我的第一语言。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T05:41:11.767

我假设你的意思是这样的：

```
Foo myObject = new Foo();
myList.add(myObject.bar); 
```

不，你被误导了。除非`Foo.bar`它本身包含对“拥有”的引用`Foo`（如果它真的只是一个字符串，它不会），它不会阻止你新创建的`Foo`实例被垃圾收集。如果您与误导您的人有个人联系，我建议您向他们询问更多详细信息。我可以看到三个选项之一：

*   他们很可能误解了这种情况。
*   情况可能与您描述的不太一样；例如，您可能正在谈论更多类似的内容：

    ```
    String longString = getLongString();
    myList.add(longString.substring(0, 4)); 
    ```

    ...此时是否可以对原始“大量字符数据”进行垃圾收集取决于实现。

*   他们可能只是误解了垃圾收集，在这种情况下，您可以让他们更仔细地考虑它（并查看此答案和发布的任何其他答案），从而帮他们一个忙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:46:14.827

假设代码是正确的并且您打算这样做，在下面的代码中，在整个执行过程中，引用 myObject 未设置为 null，因此对象不会丢失。因此它不能被垃圾收集。

```
List myList = new ArrayList<String>();

for (int i=1; i<11; i++) {
    Foo myObject = new Foo();
    myList.add(new String(Foo.Bar))
} 
```

只有在 For 循环结束后，对象才会超出范围并因此被垃圾回收。

# ruby - 带有红宝石的套接字 io

> ID：15263900
> 
> 赞同：-1
> 
> 时间：2013-03-07T05:38:30.773
> 
> 标签：ruby, sockets, socket.io

我刚刚开始使用 Socket.IO，无法理解似乎是一个非常基本的想法。

我有一个服务器：

**应用程序.js**

```
var io = require('socket.io').listen(8080);
io.sockets.on('connection', function (socket) {
    socket.on('news', function (data) {
    console.log(data);
    });
}); 
```

如何通过简单的 Ruby 脚本向服务器发送“新闻”事件？像这样的东西：

**套接字.rb**

```
require 'socket'
socket = TCPSocket.new('localhost', 8080)
socket.send('news: some message', 0) 
```

我不确定如何传递新闻数据，而且我可能也做错了其他事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T06:20:32.350

您的问题是 WebSockets 有一个非常具体的协议。您要么需要自己实现所有协议，要么使用 WebSocket 客户端库。Ruby 有好几种，虽然我还没有尝试过，因此我不会推荐一个——只要谷歌“Ruby websocket 客户端”，你就可以选择了。

# asp.net-mvc - 从使用 asp.net mvc ExecuteStoreQuery 获取单列

> ID：15263901
> 
> 赞同：0
> 
> 时间：2013-03-07T05:38:30.720
> 
> 标签：asp.net-mvc

我想`CustomerId`从我的表中返回前 1 名，如下所示：

```
string nxtCustId = db.ExecuteStoreQuery<string>("SELECT TOP 1 CustId FROM CustomerMaster WHERE Id >=(SELECT Max(Id) FROM CustomerDetail ) ORDER BY Id ").ToString(); 
```

但它返回`System.Data.Objects.ObjectResult1[System.String]`
我只想用`ExecuteStoreQuery`OR来做`ExecuteStoreCommand`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T12:33:24.310

```
string nxtCustId = db.ExecuteStoreQuery<string>(
    "SELECT TOP 1 CustId FROM CustomerMaster WHERE Id >=(SELECT Max(Id) FROM CustomerDetail ) ORDER BY Id ")
    .FirstOrDefault(); 
```

话虽如此，不要以这种方式创建“ID”；它不是多用户安全的。使用自动增量字段或生成器/序列。

# c# - 用双引号替换单引号

> ID：15263904
> 
> 赞同：3
> 
> 时间：2013-03-07T05:38:52.110
> 
> 标签：c#, html, asp.net-mvc, iis, spark-view-engine

在我的 C# MVC 视图代码中，我有一个隐藏的输入字段

```
<input type='hidden'  name='foo' value='${r.data}'/> 
```

在我的本地机器上测试它会生成 html 源代码。

```
<input type='hidden'  name='foo' value='bah'/> 
```

在我的生产服务器上，它发送给客户端的源是

```
<input type="hidden"  name="foo" value="bah"/> 
```

它已将单引号 ' 替换为双引号 "。如果变量数据中有双引号，它将中断。

现在我知道我应该测试 html 特殊字符或至少做

```
<input type="hidden"  name="buttons" value="${r.data.Replace(@"""", "&quot;")}"/> 
```

为什么本地机器和生产输出之间存在差异？

这在哪里发生了变化，它是 spark 视图引擎的一部分，还是 C# 中 Response builder 的一部分，但这没有意义？我唯一能想到的是 IIS 和 VS2010 内置 Web 服务器的区别？

本地和生产 UTF8 上的文件编码相同，使用相同的 dll。并且相同的构建类型是 Release。

应该允许单引号和双引号。 [单引号和双引号（' vs "）](https://stackoverflow.com/questions/2373074/single-vs-double-quotes-vs)

这没有任何意义这是怎么发生的而且我觉得我正在失去理智。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T08:41:36.400

此处发布了一个类似的问题ASP.NET MVC 2 和 sparkviewengine 在 html5 数据属性（带有接受的 anwser）[中将单引号渲染为双引号可能不是相同的 MVC 版本，但可能是相同的错误。](https://stackoverflow.com/questions/5859199/asp-net-mvc-2-and-sparkviewengine-rendering-single-quotes-to-double-quotes-in-ht)

# javascript - 将 Ruby 数组从数据库查询返回到 javascript

> ID：15263911
> 
> 赞同：0
> 
> 时间：2013-03-07T05:39:16.430
> 
> 标签：javascript, ruby-on-rails, ruby, arrays

我试图通过我的rails控制器从我的数据库中返回一组日期，然后在渲染日历时由Javascript使用。当我拉起rails控制台进行测试但不在视图中时，它似乎正在工作。有任何想法吗？我的代码如下。

装备 has_many line_items

LineItem 属于_to Gear

**Javascript 变量**

```
var $myBadDates = new Array("<%= @gear.line_items.rented %>"); 
```

**正在返回的视图。**

```
var $myBadDates = new Array("[]"); 
```

**订单项模型（缩短）**

```
class LineItem < ActiveRecord::Base
  belongs_to :gear

  scope :available, where(:cart_id => nil)

  def self.rented
    LineItem.available.collect {|x| (x.rentstart..x.rentend).to_a}
  end

end 
```

**来自 Rails 控制台的数组**

```
1.9.3-p194 :007 > g.line_items.rented
  LineItem Load (0.7ms)  SELECT `line_items`.* FROM `line_items` WHERE `line_items`.`gear_id` = 4 AND `line_items`.`cart_id` IS NULL
 => [[Tue, 12 Feb 2013, Wed, 13 Feb 2013, Thu, 14 Feb 2013, Fri, 15 Feb 2013, Sat, 16 Feb 2013, Sun, 17 Feb 2013, Mon, 18 Feb 2013, Tue, 19 Feb 2013, Wed, 20 Feb 2013, Thu, 21 Feb 2013], [Tue, 05 Feb 2013, Wed, 06 Feb 2013, Thu, 07 Feb 2013, Fri, 08 Feb 2013, Sat, 09 Feb 2013, Sun, 10 Feb 2013, Mon, 11 Feb 2013, Tue, 12 Feb 2013, Wed, 13 Feb 2013, Thu, 14 Feb 2013, Fri, 15 Feb 2013]] 
```

*已接受答案的更新工作 javascript 代码*

var $myBadDates = <%= @gear.line_items.rented.flatten.to_json.html_safe %>;

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:42:42.857

尝试使用`to_json`

```
var $myBadDates = <%= @gear.line_items.rented.to_json %>; 
```

# android - 在 Android 中使用 findViewById 时为按钮获取 Null

> ID：15263915
> 
> 赞同：-4
> 
> 时间：2013-03-07T05:39:32.527
> 
> 标签：android, nullpointerexception, android-button

我在 XML 文件中创建了一个按钮，当我尝试通过 findViewById 访问该按钮时，我得到了 NullPointer 异常。

按钮的 Id 是在 R.java 文件中生成的。但我仍然无法通过 findViewById 方法。

主要.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="match_parent"
android:layout_height="match_parent"
>

<com.example.calendar_module.CalendarView  android:id="@+id/calendar"
    android:layout_width="fill_parent" 
    android:layout_height="wrap_content" />

<Button 
    android:id="@+id/NextMonth"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Next"/>

</LinearLayout> 
```

MainActivity.java ：

```
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // 1) start calendar view
           //       startActivityForResult(new Intent(Intent.ACTION_PICK).setDataAndType(null, CalendarActivity.MIME_TYPE), 100);
    startActivity(new Intent(Intent.ACTION_VIEW).setDataAndType(null, CalendarActivity.MIME_TYPE));
    final CalendarView calenderView = new CalendarView(this);

  //         Calendar calendarView = Calendar.getInstance();
 //
 //      Uri uriCalendar = Uri.parse("content://com.android.calendar/time/" + String.valueOf(System.currentTimeMillis()));
 //         Intent intentCalendar = new Intent(Intent.ACTION_VIEW,uriCalendar);
 //
 //         //Use the native calendar app to view the date
 //         startActivity(intentCalendar);

    Button NextMonth = (Button) findViewById(R.id.NextMonth);

    System.out.println("NextMonth Id "+NextMonth);

    NextMonth.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            calenderView.nextMonth();

        }
    });

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

  // 2) implement your own onActivityResult method to handle returned date

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    if(resultCode==RESULT_OK) {
        int year = data.getIntExtra("year", 0);   // get number of year
        int month = data.getIntExtra("month", 0); // get number of month 0..11
        int day = data.getIntExtra("day", 0);     // get number of day 0..31

        // format date and display on screen
        final Calendar dat = Calendar.getInstance();
        dat.set(Calendar.YEAR, year);
        dat.set(Calendar.MONTH, month);
        dat.set(Calendar.DAY_OF_MONTH, day);

        // show result
        SimpleDateFormat format = new SimpleDateFormat("yyyy MMM dd");
        Toast.makeText(MainActivity.this, format.format(dat.getTime()), Toast.LENGTH_LONG).show();

    }
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:55:11.620

如果您没有完全掌握布局和 xml 格式的概念，您可能需要阅读更多教程。

基本上，你只需要改变这个

```
setContentView(R.layout.activity_main); 
```

对此

```
setContentView(R.layout.Main); 
```

`Main`您要使用的布局的 xml 文件的实际名称在哪里

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-07T05:42:31.283

@文卡特，

1.  您可以清理项目，删除 gen 文件夹并重建应用程序。这应该可以解决问题。

2.  获取 id 使用`System.out.println("NextMonth Id "+NextMonth.getId());`

# jquery - 如何用 span 将文本包装在 td 内

> ID：15263918
> 
> 赞同：0
> 
> 时间：2013-03-07T05:39:43.913
> 
> 标签：jquery

我有这个

```
<tr><td>other</td><td>mytest</td></tr>
<tr><td>other</td><td>mytest</td></tr>
<tr><td>other</td><td>mytest</td></tr>
<tr><td>other</td><td>mytest</td></tr>
<tr><td>other</td><td>mytest</td></tr> 
```

我想将 last td 中的文本替换为

`<span>mytest</span>`

我正在尝试这个，但我包装了`td`不`text`

```
var r2 = new RegExp("mytest", 'i');

$(" tbody td").filter(function(){ 
        return $(this).text().replace(/\s/g, "").match(r2) }

    ).wrap('<span class="label-success"></span>'); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:42:40.000

你需要使用[wrapInner](http://api.jquery.com/wrapInner/)

```
var r2 = new RegExp("mytest", 'i');

$(" tbody td").filter(function(){ 
        return $(this).text().replace(/\s/g, "").match(r2) 
}).wrapInner('<span class="label-success"></span>'); 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/5swuJ/)

# android - 在 Android 中获取“CURLE_COULDNT_RESOLVE_HOST”错误

> ID：15263919
> 
> 赞同：4
> 
> 时间：2013-03-07T05:39:52.830
> 
> 标签：android, android-ndk, libcurl

我已经为 android 编译了静态 libcurl，但不断收到 CurlRes 代码 6，即 CURLE_COULDNT_RESOLVE_HOST。

## 安卓.mk

```
LOCAL_PATH:= $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE    := Curl

LOCAL_SRC_FILES := prebuild/libcurl.a

include $(PREBUILT_STATIC_LIBRARY)

include $(CLEAR_VARS)

LOCAL_MODULE    := ccSharedLib

LOCAL_SRC_FILES := main-jni.cpp

LOCAL_STATIC_LIBRARIES := Curl 

include $(BUILD_SHARED_LIBRARY) 
```

* * *

## main-jni.cpp

```
extern "C" {
    size_t write_data(void *ptr, size_t size, size_t count, FILE *stream)
        {
            size_t written;
            written = fwrite(ptr, size, count, stream);
            printf("data sent, size = %lu",written);
            return written;
        }

    jint
        Java_com_example_testlibcurl_MainActivity_test1( JNIEnv*  env,
                                        jobject  thiz, jstring downloadDirectoryPath)
        {
            CURLcode res;
            res = curl_global_init(CURL_GLOBAL_ALL);

            jint temp = 3;

            printf("Method called");
            const char *nativeDownloadDirPath = env->GetStringUTFChars(downloadDirectoryPath,0);
            // Test code for calling methods of libCURL
            CURL *curl;
            FILE *fp;
            std::string s = "http://travel.paintedstork.com/blog/wp-content/uploads/2012/10/2013-calendar-images-1.jpg";
            curl = curl_easy_init();
            if(curl)
            {
                fp = fopen(nativeDownloadDirPath, "wb");
            res = curl_easy_setopt(curl, CURLOPT_URL, s.c_str());
                res = curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_data);
                res = curl_easy_setopt(curl, CURLOPT_WRITEDATA, fp);
                res = curl_easy_perform(curl);
                curl_easy_cleanup(curl);
                if(fp)
                    fclose(fp);
            }
            return res;
        }
} 
```

此代码正在从 Web 源下载图像，但每次调用“curl_easy_perform”方法时都会给出错误代码 6。我用不同的 URL 进行了检查，但仍然不成功 :( ...

清单文件中已提供“android.permission.INTERNET”和“android.permission.WRITE_EXTERNAL_STORAGE”权限。

任何解决这个问题的指针都会有很大的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T14:09:10.460

确保将**有效的文件名**和**可写目录路径**传递给 fopen。

我得到

> 致命信号 11 (SIGSEGV) 在 0x00000010 (code=1) ...

因为 fopen 试图打开一个目录而不是一个文件。

从 Eclipse 或使用 adb logcat 检查 LogCat 中的日志以了解其他可能的错误。

我已经通过以下修改测试了您的代码并且它可以工作。

**MainActivity.java**：

```
public class MainActivity
{
    private static final String TAG = MainActivity.class.getName();

    static
    {
        try
        {
            System.loadLibrary("mynativelib");
        }
        catch (UnsatisfiedLinkError ex)
        {
            Log.e(TAG, "WARNING: Could not load native library: " + ex.getMessage());
        }
    }

    public static native int DownloadFile(String downloadDirectoryPath);

   @Override
   protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);

        int res = DownloadFile(Environment.getExternalStorageDirectory().getAbsolutePath()
                + File.separator + Environment.DIRECTORY_DOWNLOADS + File.separator 
                + "test.jpg");
        Log.d(TAG, "Result Code: " + res);
    }
} 
```

**main-jni.cpp**

```
#include <jni.h>
#include <android/log.h>
#include <string>
#include <curl/curl.h>

#define LOG_TAG "native"

#define LOG_INFO(...) __android_log_print(ANDROID_LOG_INFO, LOG_TAG, __VA_ARGS__)
#define LOG_ERROR(...) __android_log_print(ANDROID_LOG_ERROR, LOG_TAG, __VA_ARGS__)
#define LOG_WARN(...) __android_log_print(ANDROID_LOG_WARN, LOG_TAG, __VA_ARGS__)
#define LOG_DEBUG(...) __android_log_print(ANDROID_LOG_DEBUG, LOG_TAG, __VA_ARGS__)

#ifdef __cplusplus
extern "C"
{
#endif

    // [FIX for Android 4.2.x]
    // "WARNING: Could not load native library:
    // Cannot load library: soinfo_relocate(linker.cpp:975): cannot locate symbol "__exidx_end" referenced by"
    // http://stackoverflow.com/a/14501998/313113
    void __exidx_start()
    {
    }
    void __exidx_end()
    {
    }

    size_t write_data(void *ptr, size_t size, size_t count, FILE *stream)
    {
        size_t written;
        written = fwrite(ptr, size, count, stream);
        LOG_DEBUG("Writing data to file stream %u", written);
        return written;
    }

    jint Java_com_company_awesomeapp_MainActivity_DownloadFile(JNIEnv* env, jobject thiz,
            jstring downloadDirectoryPath)
    {
        CURLcode res;
        res = curl_global_init(CURL_GLOBAL_ALL);

        jint temp = 3;

        LOG_DEBUG("Downloading file");
        const char *nativeDownloadDirPath = env->GetStringUTFChars(downloadDirectoryPath, 0);

        LOG_DEBUG(nativeDownloadDirPath);

        CURL *curl;
        FILE *fp;
        std::string url = "http://travel.paintedstork.com/blog/wp-content/uploads/2012/10/2013-calendar-images-1.jpg";

        curl = curl_easy_init();
        if (curl)
        {
            fp = fopen(nativeDownloadDirPath, "wb");
            res = curl_easy_setopt(curl, CURLOPT_URL, url.c_str());

            LOG_DEBUG("Before write function");
            res = curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_data);
            LOG_DEBUG("After write function");

            LOG_DEBUG("Before write data");
            res = curl_easy_setopt(curl, CURLOPT_WRITEDATA, fp);
            LOG_DEBUG("After write data");

            res = curl_easy_perform(curl);
            curl_easy_cleanup(curl);

            if (fp) fclose(fp);
        }

        env->ReleaseStringUTFChars(downloadDirectoryPath, nativeDownloadDirPath);

        return res;
    }

/**
     * The VM calls JNI_OnLoad when the native library is loaded (for example, through System.loadLibrary).
     * JNI_OnLoad must return the JNI version needed by the native library.
     *
     * @see http://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/invocation.html#JNI_OnLoad
     */JNIEXPORT jint JNI_OnLoad(JavaVM* vm, void* reserved)
    {
        JNIEnv* env;
        if (vm->GetEnv(reinterpret_cast<void**>(&env), JNI_VERSION_1_6) != JNI_OK)
        {
            return -1;
        }

        // [*] Get jclass with env->FindClass.
        // [*] Register methods with env->RegisterNatives.
        //jniRegisterNativeMethods(env, "dev/android/sample/AndroidNDKSampleActivity", sMethods, NELEM(sMethods));

        return JNI_VERSION_1_6;
    }

/**
     * The VM calls JNI_OnUnload when the class loader containing the native library is garbage collected.
     * This function can be used to perform cleanup operations.
     *
     * Because this function is called in an unknown context (such as from a finalizer),
     * the programmer should be conservative on using Java VM services, and refrain from arbitrary
     * Java call-backs.
     * @see http://docs.oracle.com/javase/7/docs/technotes/guides/jni/spec/invocation.html#JNI_OnUnload
     */JNIEXPORT void JNI_OnUnload(JavaVM *vm, void *reserved)
    {

    }

#ifdef __cplusplus
}
#endif 
```

该文件将保存在：/storage/emulated/0/Download/test.jpg

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-09-22T13:45:25.723

如果您在`libcurl`没有线程解析器（CMake 选项`ENABLE_THREADED_RESOLVER`）的情况下进行编译，同时针对低于 23 的 Android API 级别进行编译，也会发生这种情况。

问题是因为实现`CMake/CurlTests.c`包含这一行：

```
#ifndef gethostbyaddr_r
  (void)gethostbyaddr_r;
#endif 
```

但是，如果您检查`netdb.h`Android NDK 中的标头，您会看到

```
#if __ANDROID_API__ >= 23
int gethostbyaddr_r(const void* __addr, socklen_t __length, int __type, struct hostent* __ret, char* __buf, size_t __buf_size, struct hostent** __result, int* __h_errno_ptr) __INTRODUCED_IN(23);
#endif /* __ANDROID_API__ >= 23 */ 
```

这意味着当针对比 Marshmallow 更早的 Android 时，此功能不可用。这是有问题的，因为测试`HAVE_GETHOSTBYNAME_R`成功，而测试`HAVE_GETHOSTBYNAME_R_6`失败（但应该成功）并出现以下错误（可在 中观察到`CMakeError.log`）：

```
/path/to/curl/CMake/CurlTests.c:128:9: error: use of undeclared identifier 'gethostbyaddr_r'
  (void)gethostbyaddr_r;
        ^
1 error generated. 
```

`Curl_ipv4_resolve_r`然后这会导致file中的函数出现无操作行为`hostip4.c`，因为它期望 after`HAVE_GETHOSTBYNAME_R`被定义，至少一个`HAVE_GETHOSTBYNAME_R_5`,`HAVE_GETHOSTBYNAME_R_6`或`HAVE_GETHOSTBYNAME_R_3`. 因此，curl 甚至不会尝试解析主机。

要解决此问题，只需从`CMake/CurlTest.c`.

我没有尝试像[官方文档](https://curl.haxx.se/docs/install.html)`configure`中那样使用脚本构建 curl ，但即使你这样做了，它也明确指出如果你计划通过 OpenSSL 支持 SSL，你应该以 Android M 或更高版本为目标，但是对于简单的 HTTP 支持它应该可以工作的 AFAIK .

如果您使用线程解析器，问题就消失了，因为它使用不同的系统 API 来执行 DNS 解析（`getaddrinfo`在函数`Curl_getaddrinfo_ex`中`curl_addrinfo.c`）。`getaddrinfo`是[更现代的 API](http://blog.dornea.nu/2015/04/30/gethostbyname-vs-getaddrinfo/)，但可能并非在所有平台 curl 目标上都可用，例如嵌入式系统，这些目标也可能缺乏线程支持。因此，当线程被禁用时，curl 在 DNS 解析中使用传统方法。

PS 很抱歉在 7 年多后重新提出这个问题，但是在面临与你完全相同的问题后，这个 StackOverflow 问题是唯一类似的谷歌搜索结果

# android - 从列表视图中的edittext获取文本

> ID：15263920
> 
> 赞同：0
> 
> 时间：2013-03-07T05:40:12.743
> 
> 标签：android, listview, delete-row

**问题部分：1**

我创建了一个包含产品 ID 和产品名称作为列表项的活动。每行包含一个编辑文本，可用于输入特定产品的数量。这些行还包含一个用于选择特定产品的复选框。

这是列表的样子：

![列表](../Images/7d2beaaa68234663e684616f2bffc85e.png)

当我点击列表项时，我可以获得特定列表项的 id 和名称，但我还想获得用户为列表项输入的数量。

这是**负责生成列表视图的活动**：

```
public class PollStationActivity extends Activity {     

    // Hashmap for ListView
            ArrayList<HashMap<String, String>> PSList = new ArrayList<HashMap<String, String>>();
            String status_code_from_prev;
            List<HashMap<String, String>> fillMaps=null;
            String alert_message;
            String quantity_message;

            //quantity edittext
            EditText quantity_edit;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

         setContentView(R.layout.activity_poll_station);

         //quantity edittext
         quantity_edit   = (EditText)findViewById(R.id.qty_editText);

        //database insertion
         DatabaseHelper db = new DatabaseHelper(this);
        ContentValues values = new ContentValues();
        try {
         db.createDataBase();
         values.put("_id", "1");
         values.put("name", "rose");
         db.insert(values);

        } catch (IOException e) {
         e.printStackTrace();
          }
        db.close();            

            ArrayList<TestItem> PSList = new ArrayList<TestItem>();            

             try {
              db.createDataBase();

              PSList =  db.getAllData();

             } catch (IOException e) {
              e.printStackTrace();
               }

             db.close();

              fillMaps = new ArrayList<HashMap<String, String>>();

                Iterator<TestItem> i = PSList.iterator();

                while(i.hasNext())
                {
                    HashMap<String, String> map = new HashMap<String, String>();
                    TestItem objPSItem = i.next();

                    map.put("name", objPSItem.NAME);
                    map.put("Id", objPSItem.ID);
                    //map.put("quantity", objPSItem.QUANTITY);
                    fillMaps.add(map);
                }

            Log.i("Size: ", ""+fillMaps.size());
            //populating listview from database
            ListView listView1 = (ListView) findViewById(R.id.poll_list_listView);          

              if (null != listView1 && null != PSList) {
                  listView1.setAdapter(new ListAdapter(PollStationActivity.this,
                 R.id.ListViewContainer, new String[fillMaps.size()]));

              }

    }       

    //class for the list and on click handler
    class ListAdapter extends ArrayAdapter<String> {
        private final Context context;
        private final String[] values;          

        public ListAdapter(Context context, int textViewResourceId,
                String[] objects) {
            super(context, textViewResourceId, objects);
            // TODO Auto-generated constructor stub
            this.context = context;
            this.values = objects;
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            // TODO Auto-generated method stub
            // return super.getView(position, convertView, parent);

            LayoutInflater inflater = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);

            final View rowView = inflater.inflate(R.layout.list_layout, parent,
                    false);

            final HashMap<String, String> map =  fillMaps.get(position);

            TextView textView = (TextView) rowView
                     .findViewById(R.id.list_label_name);
                     textView.setText("("+map.get("Id")+") "+map.get("name"));          

            rowView.setOnClickListener(new View.OnClickListener() {

                public void onClick(View v) {

                    rowView.setBackgroundResource(R.drawable.list_bg_pressed);

                    Handler handler = new Handler();
                    Runnable r = new Runnable() {
                        public void run() {
                            rowView.setBackgroundResource(R.drawable.list_bg);

                        }
                    };
                    handler.postDelayed(r, 200);        

                    //alert box
                    AlertDialog.Builder alertDialog = new AlertDialog.Builder(PollStationActivity.this);

                     // Setting Dialog Title
                     alertDialog.setTitle("Please Note!");

                     // Setting Dialog Message
                     alertDialog.setMessage("Are you sure you want to select "+"("+map.get("Id")+") "+map.get("name")+"?");

                     // Setting Positive "Yes" Button
                     alertDialog.setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                         public void onClick(DialogInterface dialog,int which) {

                         // Write your code here to invoke YES event
//                           Intent intent = new Intent(RegisterFirstActivity.this, RegisterSecondActivity.class);
//                              
//                              intent.putExtra("AC_Code", map.get(TAG_CODE));
//                              RegisterFirstActivity.this.startActivity(intent);

                         }
                     });

                     // Setting Negative "NO" Button
                     alertDialog.setNegativeButton("No", new DialogInterface.OnClickListener() {
                         public void onClick(DialogInterface dialog, int which) {
                         // Write your code here to invoke NO event

                         dialog.cancel();
                         }
                     });

                     // Showing Alert Message
                     alertDialog.show();

                }
            });

            return rowView;

        }
    }

    public void makeAToast(String str) {
        //yet to implement
        Toast toast = Toast.makeText(this,str, Toast.LENGTH_SHORT);
        toast.setGravity(Gravity.CENTER, 0, 0);
        toast.show();
    }

 } 
```

这是**TestItem**类：

```
 public class TestItem {

public String ID;
public String NAME;
public String QUANTITY;
public boolean selected;

    // Empty constructor
    public TestItem(){

    }
    // constructor
    public TestItem(String id, String name, String quantity){
        this.ID = id;
        this.NAME = name;
        this.QUANTITY = quantity;
    }

    // constructor
    public TestItem(String name, String quantity){
        this.NAME = name;
        this.QUANTITY = quantity;
    }
    // getting ID
    public String getID(){
        return this.ID;
    }

    // setting id
    public void setID(String id){
        this.ID = id;
    }

    // getting name
    public String getName(){
        return this.NAME;
    }

    // setting name
    public void setName(String name){
        this.NAME = name;
    }

    // getting phone number
    public String getQuantity(){
        return this.QUANTITY;
    }

    // setting quantity
    public void setQuantity(String quantity){
        this.QUANTITY = quantity;
    }

    public boolean isSelected() {
        return selected;
    }

    public void setSelected(boolean selected) {
        this.selected = selected;
    }

 } 
```

这是**activity_poll_station.xml**：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent" 
        android:background="@drawable/main_bg">    

<RelativeLayout
    android:id="@+id/ListViewContainer"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/poll_label_textView"
    android:layout_centerHorizontal="true"
    android:layout_marginTop="28dp" >

    <ListView
        android:id="@+id/poll_list_listView"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true" >
    </ListView>

</RelativeLayout>

    </RelativeLayout> 
```

这是**list_layout.xml**：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/library_linear_layout"
    android:layout_width="match_parent"
    android:layout_height="70dp"
    android:layout_alignParentLeft="true"
    android:background="@drawable/list_bg"
    android:padding="5dp" >

    <RelativeLayout
        android:layout_width="fill_parent"
        android:layout_height="44dp"
        android:background="@null" >

        <TextView
            android:id="@+id/list_label_name"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentLeft="true"
            android:layout_centerVertical="true"
            android:text="name"
            android:textAppearance="?android:attr/textAppearanceSmall"
            android:textSize="17sp" />

        <CheckBox
            android:id="@+id/item_checkBox"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_alignParentRight="true"
            android:layout_centerVertical="true"/>

        <EditText
            android:id="@+id/qty_editText"
            android:layout_width="75dp"
            android:layout_height="wrap_content"
            android:layout_centerHorizontal="true"
            android:layout_centerVertical="true"
            android:ems="10"
            android:maxLines="1"
            android:inputType="number" >

        </EditText>

    </RelativeLayout>

</LinearLayout> 
```

我想了解如何从为每个列表项创建的 edittext 中提取文本。如果我尝试提取文本

```
rowView.setOnClickListener(new View.OnClickListener() 
```

像这样：

```
// Setting Dialog Message
                     alertDialog.setMessage("Are you sure you want to select "+"("+map.get("Id")+") "+map.get("name")+"Quantity: "+quantity_edit.getText().toString()+"?"); 
```

`null pointer exception`由于_`rowView.setOnClickListener(new View.OnClickListener()`

我应该怎么办？应该解决什么问题？

提前致谢！

//------------------------------------------------ ------------------------------//

**问题部分：2**

现在我想做一些类似的事情，我想在点击它时删除一个特定的行。该行只会从现有的列表视图中删除，并会显示一个新列表，该怎么做？

再次感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:53:48.333

您首先需要获取对`EditText`对象的引用，您可以使用`findViewById`

```
quantity_edit = (EditText) view.findViewById("qty_editText"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T05:56:28.560

您已经覆盖了自定义适配器的 getView 方法。像下面这样。

```
public class SimpleAdapter1 extends ArrayAdapter<Data> {

    public SimpleAdapter1(Context context, int textViewResourceId,
            List<Data> catDesc) {
        super(context, textViewResourceId, catDesc);
        this.items = (ArrayList<Data>) catDesc;
        this.context = context;
        itemsid = new ArrayList<Integer>();
        System.out.println(items);
    }

    @Override
    public View getView(final int position, View convertView,
            final ViewGroup parent) {
        View v = convertView;
        if (v == null) {
            LayoutInflater vi = (LayoutInflater) context
                    .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            v = vi.inflate(R.layout.YourLayout, null);
        }

        edit = (EditText) v.findViewById(R.id.editText1);
        String tx = edit.getText().toString();
                return v;
       }
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:50:33.890

如果您为列表视图使用自定义适配器，这将非常简单。

你可以看到这个[`Custom Adapter for List View`](https://stackoverflow.com/questions/8166497/custom-adapter-for-list-view)

这对您[如何从 listview 获取 EditText 值也很有用](https://stackoverflow.com/a/7747776/1265724)

# c - 为什么这个条件总是正确的？

> ID：15263922
> 
> 赞同：2
> 
> 时间：2013-03-07T05:40:13.647
> 
> 标签：c, embedded, microcontroller, pic

语言：C PIC：16F84A **程序：CCS PCW**

当我编译以下代码时，我的编译器抱怨 FOR 始终为真（也许 int 我不支持负值？）：

```
#include <16F84A.h>
#FUSES XT
#use delay(clock=4M)
byte const display[10] = {63,6,91,79,102,109,124,7,127,103};

void main()
{
   set_tris_b(0);
   while(True)
   {
   int i;
      for(i=9;i>=0;--i)
      {
         output_b(display[i]);
         delay_ms(300);
      }
   }
} 
```

它的 PIC Countdown 项目，所以：9,8,7,6,5,4,3,2,1,0,9,8,7,6,5,4,3,2,1,0,9,8 ,7,6,... 但它在第一个周期后停止。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T07:45:00.850

利用

```
 signed int i; 
```

代替

```
 int i; 
```

在 CCS 编译器中，整数默认是无符号的。

[http://www.ccsinfo.com/downloads/ccs_c_manual.pdf](http://www.ccsinfo.com/downloads/ccs_c_manual.pdf)

检查第 38 页

> “所有类型，除了浮点数，默认情况下都是无符号的；但是，[它们] 前面可能有无符号或有符号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T07:51:23.980

你的编译器要么坏了，要么是一些非标准的废话，`int`默认情况下是无符号的。

我建议改用真正的、符合标准的 C 编译器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T17:53:29.213

检查编译器生成的汇编代码，你就知道了。或者在这里发布，这样我们就不必拥有/安装特定的编译器。组装的好想法（特别是在像 PIC16 这样的死简单的微控制器上）是它永远无法隐藏它的实际作用:-)

我同意这里关于某些工具质量的评论，而且 Microchip 从来没有自己的 PIC16 C 编译器，所以我们不能责怪他们:-(

# php - 如何使用ajax从html获取数据并将其传递给php

> ID：15263926
> 
> 赞同：2
> 
> 时间：2013-03-07T05:40:36.817
> 
> 标签：php, javascript, html, ajax, post

嗨，我很想知道如何将字符串从表单传递到 php，该 php 将测试其中是否有内容，然后使用此表单发布警报消息以尝试从中获取数据，然后显示是否已通过正确。

HTML 代码：

```
<form action='' method=''>
Name:<input type='text' name='name' id='name'>
Age:<input type='text' name='age' id='age'>
message:<textarea name='message' id='message'></textarea>
<input type='submit' value='Send'>
</form> 
```

输出：

```
<?php
if(isset($_POST['name']) && isset($_POST['age']) && isset($_POST['message'])){

$a = $_POST['name'];
$b = $_POST['age'];
$c = $_POST['message'];

   if($a != NULL && $b != NULL && $c != NULL)
       {
         echo "
                <script type='text/javascript'>
                window.alert('Success'+ a + b + c)
                </script>
              ";
        }

};?> 
```

虽然仍然在以前的同一页面中，但显示了我在警报框中输入的内容。

如果它附带有关如何将它与 get 和 post 功能一起使用的说明，如果可以的话，我也将不胜感激？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:49:56.680

**为了简便起见，您可以对代码进行以下更改：**

**HTML：**

```
<form action='' method='' id="myform">
Name:<input type='text' name='name' id='name'>
Age:<input type='text' name='age' id='age'>
message:<textarea name='message' id='message'></textarea>
<input type='submit' value='Send'>
</form> 
```

**PHP：**

(your_page_with_php_script)

```
<?php
if(isset($_POST['name']) && isset($_POST['age']) && isset($_POST['message'])){

$a = $_POST['name'];
$b = $_POST['age'];
$c = $_POST['message'];

   if($a != NULL && $b != NULL && $c != NULL)
   {
      echo "Success ".a." ".b." ".c;
   }

};
?> 
```

**脚本：（**首先包括jquery）

```
$('#myform').submit(function(){

var name = $('#name').val();
var age = $('#age').val();
var message = $('#message').val();

$.ajax({
  type: "POST",
  url: "your_page_with_php_script.php",
  data: "name="+name+"&age="+age+"&message="+message,
}).done(function( msg ) {
  alert( "Data Saved: " + msg );
});

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:47:08.013

根据需要编辑以下内容：

```
$.ajax({
  type: 'POST',
  url: 'your_php_page.php',
  data: { postVar1: 'theValue1', postVar2: 'theValue2' },
  beforeSend:function(){
    // this is where we append a loading image
    $('#ajax-panel').html('<div class="loading"><img src="/images/loading.gif" alt="Loading..." /></div>');
  },
  success:function(data){
    // successful request; do something with the data
    $('#ajax-panel').empty();
    $(data).find('item').each(function(i){
      $('#ajax-panel').append('<h4>' + $(this).find('title').text() + '</h4><p>' + $(this).find('link').text() + '</p>');
    });
  },
  error:function(){
    // failed request; give feedback to user
    $('#ajax-panel').html('<p class="error"><strong>Oops!</strong> Try that again in a few moments.</p>');
  }
}); 
```

请求页面应该有一个 id="ajax-panel" 的 div

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:48:18.817

您必须将 Jquery 与 Ajax 一起使用...

```
<script>
$("#submit").click(function()
    {
       var name = $('#name').value();
       var age= $('#age').value();
       var message= $('#message').value();

        $.ajax({ 
            url: "urpage.php",
            data: {name : name, age : age, message : message},
            type: "POST",               
            success: function(output) {

               alert(output); //This will show ur output in an alert box
                   }                }
        })

    });
</script> 
```

希望这有效

# asp.net - 动态添加面板

> ID：15263929
> 
> 赞同：0
> 
> 时间：2013-03-07T05:40:55.913
> 
> 标签：asp.net

![如何动态添加带有图像控件和标签的面板（单击按钮）？？][1]

我要这个：

我选择一个图像并按删除，它应该删除（从数据库中）图像和图像名称（标签）...我按添加，应该添加一个带有标签的新图像控件...

问题：

我似乎无法选择页面上的任何内容...

我所拥有的：我已将图像和标签放在面板中..我删除了面板，它被删除了......但是，由于面板没有存储在数据库中，它只是暂时被删除..它又回来了下一次......我应该怎么做才能在这里实现我想要的......？

我已经采取了中继器控件并在其中放置了一个带有图像和标签的面板（我将在中继器中有多个类似的面板）...现在如何从中删除特定的面板...？？

# python - 使python在使用curl时发送回车键

> ID：15263930
> 
> 赞同：2
> 
> 时间：2013-03-07T05:41:04.577
> 
> 标签：python, bash, curl

我正在制作一个 python 脚本来卷曲幻想曲棍球记分牌页面，调用 perl 以正则表达式替换球队名称和分数，并显示它。正则表达式已全部设置，但现在我无法获取网页。我注意到当我在我的电脑上运行后

```
curl -o /tmp/fantasyhockey.txt http://games.espn.go.com/fhl/scor... 
```

命令，按一次回车将启动它，然后再按一次将退出并制作我的页面。如何强制 python 按回车键？出于我的好奇，为什么要等待？

编辑：这是脚本。没什么。

```
import os
def main():

    os.system("curl -o /tmp/fantasyhockey.txt http://games.espn.go.com/fhl/scoreboar\
    d?leagueId=xxxxx&seasonId=2013")
    unfix = open("/tmp/fantasyhockey.txt", "r").read().replace('\n', '')
    outfile = open("/tmp/fantasyhockey2.txt", "w")
    outfile.write(unfix)
    outfile.close()
    os.system("perl regex.pl < /tmp/fantasyhockey2.txt")
    os.system("rm /tmp/fantasyhockey*")
main() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-07T05:54:19.113

URL 中的`&`字符在 shell 中具有特殊含义（它将程序发送到后台）。这就是为什么您必须按 Enter 键的原因。

为避免这种情况，请将 URL 参数引用到`curl`，如下所示：

`curl -o /tmp/fantasyhockey.txt "http://...."`

# java - java俄罗斯方块：如何使俄罗斯方块块移动为4个不同的瓷砖

> ID：15263937
> 
> 赞同：1
> 
> 时间：2013-03-07T05:41:32.370
> 
> 标签：java, swing

我正在尝试将 Java 中的俄罗斯方块游戏作为一个有趣的项目。

我的游戏板是一个瓷砖网格：

`grid = new Tile[height][width];`

在网格中，我创建了一个新的 Tile 对象：`activetile = new Tile(this,0, 0); //add new tile to "this" board`

目前：

*   我能够控制**单个**图块 - 将其向下、向左和向右移动

    ```
     public void keyPressed(KeyEvent e) {
        int keyCode = e.getKeyCode();
        if(keyCode == KeyEvent.VK_DOWN) {
            checkBottomFull(0,4);
            collisionCheck(activetile.getX(),activetile.getY());
            checkEndGame(activetile.getX(), activetile.getY());

            activetile.setLocation(activetile.getX(), activetile.getY()+1); 
            System.out.println("coordinates: " + activetile.getX() + ", " + activetile.getY());

            repaint();
        } 
            ...right key and left key code omitted 
    ```

    *   从 keyPressed 方法中可以看出，`checkBottomFull()`如果已满，将清除底部行，`collisionCheck()`如果块击中地板或下面的另一块，将生成一个新块，`checkEndGame()`如果块卡在顶部，则结束游戏。

![在此处输入图像描述](../Images/d8f0efa6a8b6efb8d168805dbce2454b.png)

* * *

**我正在努力解决以下问题：**

*   要创建一个实际的俄罗斯方块，我想我应该只生成 3 个其他 Tile 实例，并根据它是什么（L、O、Bar、Z 等），根据 activetile 将它们的位置设置在适当的位置（我可以控制的单个图块），如下所示：

    ```
    if (piece == "Bar") {
        block2 = new Tile(this, activetile.getX(), activetile.getY());
        block3 = new Tile(this, activetile.getX()+2, activetile.getY());
        block4 = new Tile(this, activetile.getX()+3, activetile.getY());
    } 
    ```

这个问题是，我的碰撞检测`activetile`不允许它适当地移动，因为它会碰到它的其他块。我试图`keyPressed()`通过在设置`block2, block3, block4`活动图块的新位置后设置位置来解决这个问题，如下所示：（所以一旦`activetile`向下移动，所有其他的都可以向下移动，这样它们就不会重叠）

```
 activetile.setLocation(activetile.getX(), activetile.getY()+1); 
        block2.setLocation(activetile.getX(), activetile.getY()+1); 
        block3.setLocation(activetile.getX(), activetile.getY()+1); 
        block4.setLocation(activetile.getX(), activetile.getY()+1); 
```

这可能适用于向下移动，但不适用于向左或向右移动，因为瓷砖会重叠。

* * *

那么，我是否`Bar`通过生成这样的新块正确地创建了一个新的片段？我的想法正确吗？

* * *

**可执行的**

[https://www.dropbox.com/s/oyh26dfbmsvt5c8/my_tetris_test.jar](https://www.dropbox.com/s/oyh26dfbmsvt5c8/my_tetris_test.jar)

**链接到源代码 zip**

[https://www.dropbox.com/s/9kt3sl6qqo54amk/Tetris%20Two.rar](https://www.dropbox.com/s/9kt3sl6qqo54amk/Tetris%20Two.rar)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T06:06:23.007

我会看一下 Polygon 类：[http](http://docs.oracle.com/javase/6/docs/api/java/awt/Polygon.html)
: //docs.oracle.com/javase/6/docs/api/java/awt/Polygon.html 提供的方法可以用点来测试碰撞（内部）另一个对象。您还可以使用它`translate(deltaX, deltaY)`来大大简化对象的“运动”。

# javascript - 一页响应式网站，带有可以移动到锚点的选择菜单

> ID：15263939
> 
> 赞同：0
> 
> 时间：2013-03-07T05:41:51.680
> 
> 标签：javascript, jquery, html, menu, option

我一直在开发一个单页响应式网站，它的顶部有一个固定的标题，当浏览器缩小到一定大小我希望它切换到一个选择菜单，您只需点击它即可滚动到页面的一部分。

我可以轻松完成这一切，只是无法让它通过锚点滚动到它们。

我知道你这样做的方式是通过 js，因为我一直在阅读其他有类似问题的人，但这些回复似乎是为一些对 js 有一点了解的人发布的。这给我带来了问题，我对 js 感到非常可怕 :(。所以任何人都可以告诉我我需要做什么来制作选择菜单，使用 js 滚动到页面上的锚点。

这是我已经拥有的。

```
 <ul id="nav">
                <li><a href="#home">Home</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#portfolio">Portfolio</a></li>
                <li><a href="#services">Services</a></li>
            </ul>

            <select> 
                <option value="" selected="selected">Navigation</option> 
                <option value="#home">Home</option> 
                <option value="#about">About</option> 
                <option value="#portfolio">Portfolio</option> 
                <option value="#services">Services</option>
            </select> 
```

如果它有帮助，我正在为我的网站使用骨架样板。

在此先感谢各位:)

（我不确定我是否见过不同的人说选择菜单需要在表单标签中，有些人说不需要，所以如果你能澄清一下，那就太棒了:)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:48:48.243

我不知道我是否正确理解你的问题。带有“#something”href 的 achor 的想法是，当单击它时，它会将“#something”添加到您的 URL，称为[片段](http://en.wikipedia.org/wiki/Fragment_identifier)。这会导致浏览器尝试将 id 为“某物”的元素带到屏幕顶部。

如果这不是您的问题，我很抱歉 - 如果不是，请澄清。

# javascript - JavaScript 打字机脚本不工作

> ID：15263941
> 
> 赞同：1
> 
> 时间：2013-03-07T05:41:56.083
> 
> 标签：javascript

好吧，基本上我尝试从头开始制作打字机脚本，用于我的小型终端网络应用程序迷 xD

好吧，我有这个 JavaScript 东西：

```
var str = "dude";
var num = 1000;
for (var i = 0, len = str.length; i < len; i++) {
var num = num + 100;
var dude = str[i];
setTimeout('document.getElementById("guide").innerHTML +=dude;', num);
} 
```

`div`显然，它以 100 毫秒的间隔用`ID` `guide`, "d" "u" "d" "e"写入 a ，但你猜怎么着？

它不这样做！

现在它做了什么，它打印“e”的次数与字符串中的字符一样多，伙计！

:|

谢谢，

我可能超级傻

但我想要一个修复！

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:56:04.947

您可能想在 setTimeout 中调用一个函数，如下所示：

```
var str = "dude";
var num = 1000;
for (var i = 0, len = str.length; i < len; i++) {
  var num = num + 100;
  var dude = str[i];
  setTimeout(function() {
    document.getElementById("guide").innerHTML +=dude;
  }, num);
} 
```

或者

```
var str = "dude";
var num = 1000;
for (var i = 0, len = str.length; i < len; i++) {
  var num = num + 100;
  var dude = str[i];
  setTimeout(changeHtml, num);
}

function changeHtml() {
  document.getElementById("guide").innerHTML +=dude;
} 
```

如果您想要更精确的 100 毫秒间隔，您可能需要使用 setInterval

```
var myInterval = setInterval(changeHtml, 100);
var len = str.length;
var current = 0;

function changeHtml() {
  if(current < len) {
    document.getElementById("guide").innerHTML +=str[current];
  }
  else {
    clearInterval(myInterval);
  }
  current++;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T06:08:34.453

我写了一个接受 2 个参数的小函数：文本和时间：

```
function defiredWriteText(text,time, index){
    if(index === null || index === undefined) {
        index=0;
    }
    setTimeout(function (){
        var dude = text[index];
        document.getElementById("guide").innerHTML += dude;
        if(index < text.length-1)
            defiredWriteText(text, time, ++index);
    }, time)
} 
```

示例：http: [//jsfiddle.net/3e3yx/](http://jsfiddle.net/3e3yx/)

# symfony - Symfony 插件安装错误

> ID：15263942
> 
> 赞同：0
> 
> 时间：2013-03-07T05:42:00.140
> 
> 标签：symfony, symfony-2.2

我正在安装`FOSUserBundle`我从 Knpbundle 下载的。

我已经按照给出的说明正确配置了它。

我已经创建了一条路线，所以我的路线`'app/config/routing.yml'`如下。

```
fos_user_security:
   resource: "@FOSUserBundle/Resources/config/routing/security.xml"

fos_user_profile:
   resource: "@FOSUserBundle/Resources/config/routing/profile.xml"
   prefix: /profile

fos_user_register:
  resource: "@FOSUserBundle/Resources/config/routing/registration.xml"
  prefix: /register

fos_user_resetting:
  resource: "@FOSUserBundle/Resources/config/routing/resetting.xml"
  prefix: /resetting

fos_user_change_password:
  resource: "@FOSUserBundle/Resources/config/routing/change_password.xml"
  prefix: /profile
acme_user:
  resource: "@AcmeUserBundle/Resources/config/routing.yml"
  prefix: / 
```

我的 routing.yml 文件如下所示。

```
AcmeUser_Bundle:
  pattern: /admin
  defaults: { _controller: AcmeUserBundle:User:index} 
```

只要我传入`/admin`我的 url，它就会调用我创建的索引文件视图`index`。文件看起来像这样。

```
 <body>

<section id="login_form">
  <div class="login_form_head">Administration</div>
<form  id="admin_login_form" class="formee" method="post" action="{{
 path('fos_user_security_check') }}" enctype="multipart/form-data">

    <div class="login_form_display">
    <div class="login_row"><input type="text" name="_username"
 class="validate[required,custom[username]]" id="username" 
 placeholder="Username" /></div>
           <div class="clear"></div>
<div class="login_row"><input type="password"  class="validate[required,custom[passwordLogin]]"
   name="_password" id="password" placeholder="Password" /></div>
        <div class="clear"></div>
    </div>

    <!--Form footer begin -->
    <section class="login_footer">
            <div class="textcenter"><input type="submit" value="Login" /></div>
        <div class="clear"></div>
    </section>
    <!--Form footer end -->

    </form>                 
</section><!-- End of #container -->
 <div>
{% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
 {{ 'layout.logged_in_as'|trans({'%username%': app.user.username}, 'FOSUserBundle') }} |
            <a href="{{ path('fos_user_security_logout') }}">
                {{ 'layout.logout'|trans({}, 'FOSUserBundle') }}
            </a>
        {% else %}

            <a href="{{ path('fos_user_security_login') }}">{{ 'login'|trans({}, 'FOSUserBundle') }}</a>
        {% endif %}
    </div>

    {% for type, messages in app.session.flashbag.all() %}
        {% for key, message in messages %}
            <div class="flash-{{ type }}">
                {{ message|trans({}, 'FOSUserBundle') }}
            </div>
        {% endfor %}
    {% endfor %}

    <div>
        {% block fos_user_content %}

        {% endblock fos_user_content %}
    </div>

</body> 
```

它显示了 `csrfToken`错误。所以请任何人帮助我理解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T07:50:00.933

`<input type="hidden" name="_csrf_token" value="{{ csrf_token }}" />`您在登录表单中错过了这一点。
*CSRF TOKEN*在每次请求时生成，并且应该是唯一的。这样，您（或者，在这种情况下，您的 FOSUserBundle）可以防止*CSRF ATTACKS*。

FOSUserBundle 为您生成它，但是，正如他希望将其发布在表单中一样，您必须包含它

## 一个小笔记

我也不确定你想在这里做什么。如果您想自定义 FOSUserBundle 登录表单的外观，您应该以正确的方式覆盖它
如果您找到更合适的方式，请查看[此答案](https://stackoverflow.com/questions/14557104/how-to-override-the-layout-of-the-fosuser-registration-form-layout/14558023#14558023)

# python-2.7 - 从同一类中的另一个静态方法访问静态方法变量

> ID：15263943
> 
> 赞同：0
> 
> 时间：2013-03-07T05:42:06.003
> 
> 标签：python-2.7

面对错误：

```
AttributeError: 'function' object has no attribute 'd'. 
```

如何访问字典？

代码：

```
 class A:
    @staticmethod
    def test():
        d = {}
        d['a'] = 'b'
        print d
    @staticmethod
    def test1():
        d1 = {}
        d1['a'] = 'c'
        if (A.test.d['a'] == A.test1.d1['a']):
            print "yes"

        else:
            print "Oh No!!"
A.test()
A.test1() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:51:25.310

看看[这个](https://stackoverflow.com/questions/68645/static-class-variables-in-python)关于 Python 中的静态变量的问题。

每当您希望使用静态变量时，您应该能够使用 Ad 和 A.d1 对其进行分类。请注意，当您拥有它们时，它们分别是 test 和 test1 的本地。如果您希望它们是静态的，则必须在类范围内声明它们，而不是在任何函数定义内。

# java - Primefaces 数据表出现奇怪错误

> ID：15263944
> 
> 赞同：1
> 
> 时间：2013-03-07T05:42:11.840
> 
> 标签：java, jsf, jakarta-ee, primefaces

我正在开发一个页面，它显示的内容`datatable`与 primefaces 展示中显示的内容相同。但它不像那样工作。当我运行一两行的页面时它可以工作，但是当我运行多于两行的页面时，服务器显示一个错误[如果我设置`datatable`为`editable`然后它也不起作用]。当我将 bean 设置为时问题解决`session scoped`了`request or view`。问题是为什么它不适用于请求或视图范围？

资料来源：

页 ：

```
 <p:dataTable var="club" value="#{currentClubItems.clubItems}" id="clubs"
                         >

                        <p:ajax event="rowEdit" listener="#{currentClubItems.onEdit}" update=":form:messages"/>

                        <p:column headerText="Main Category" style="width:15%">
                            <p:cellEditor>
                                <f:facet name="output">
                                    <h:outputText value="#{club.mainCategory}"/>
                                </f:facet>
                                <f:facet name="input">
                                    <p:selectOneMenu value="#{club.mainCategory}" editable="true">
                                        <f:selectItems value="#{currentClubItems.categories}"
                                                       var="ct"
                                                       itemLabel="#{ct}"
                                                       itemValue="#{ct}"/>
                                    </p:selectOneMenu>
                                </f:facet>
                            </p:cellEditor>
                        </p:column>

                        <!-- other coloms-->

                        <p:column style="width:5%">
                            <p:rowEditor/>
                        </p:column>

                    </p:dataTable> 
```

豆 ：

```
@ViewScoped
@ManagedBean(name = "currentClubItems")
public class CLMItems implements Serializable {
    private List<ClubItem> clubItems;

    public CLMItems(){
        clubItems=new ArrayList<ClubItem>();

        ClubItem clubItem=new ClubItem();
        clubItem.setId("1");
        clubItem.setMainCategory("category");
        clubItem.setSubCategory("sub category");
        clubItem.setMerchant("Merchant");
        clubItem.setOffer("Content goes here..");

        //add more items......
}

//getters and setters

} 
```

俱乐部物品：

```
public class ClubItem implements Serializable {

    private String id;
    private String mainCategory;
    private String subCategory;
    private String merchant;
    private String offer;

 //getters and setters

} 
```

错误 ：

```
java.lang.IllegalStateException: Cannot create a session after the response has been committed
    at org.apache.catalina.connector.Request.doGetSession(Request.java:2705)
    at org.apache.catalina.connector.Request.getSession(Request.java:2231)
    at org.apache.catalina.connector.RequestFacade.getSession(RequestFacade.java:899)
    at com.sun.faces.context.ExternalContextImpl.getSession(ExternalContextImpl.java:155)
    at com.sun.faces.renderkit.ServerSideStateHelper.writeState(ServerSideStateHelper.java:175)
    at com.sun.faces.renderkit.ResponseStateManagerImpl.writeState(ResponseStateManagerImpl.java:122)
    at com.sun.faces.application.StateManagerImpl.writeState(StateManagerImpl.java:166)
    at com.sun.faces.application.view.WriteBehindStateWriter.flushToWriter(WriteBehindStateWriter.java:225)
    at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:419)
    at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:125)
    at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:164)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:498)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:562)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:394)
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:243)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:188)
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:166)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:885)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:907)
    at java.lang.Thread.run(Thread.java:619) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T08:14:44.040

如果我们要向表中添加多于两行的行，这似乎必须创建primefaces 需要创建会话。如果我在been 的构造函数中或之前激活会话，那么它可以正常工作。我没有原因，但它发生了。

添加

```
 //bean constructor
 public CLMItems(){
FacesContext.getCurrentInstance().getExternalContext().getSession( true );
// other stuff
} 
```

解决这个问题。

# javascript - 如何检查 Prettify 是否已加载

> ID：15263946
> 
> 赞同：1
> 
> 时间：2013-03-07T05:42:21.297
> 
> 标签：javascript, google-code-prettify

`<pre class="prettyprint">`如果存在，我只会加载脚本。我发现要启动 Prettify，您需要使用`prettyPrint();`.

但是，在不加载脚本的页面上，我收到 Javascript 错误。有没有办法测试 Prettify 是否已加载，然后运行...否则什么都不做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T06:00:20.460

This should work

```
function getElementsByClassName(className) {
if (document.getElementsByClassName) { 
    return document.getElementsByClassName(className); }
else { return document.querySelectorAll('.' + className); } }

window.onload = function() {
    if (getElementsByClassName('prettyprint').length) {
        /* element exists */
    } else { /* element not exists */ }
} 
```

[EDIT] Ooops, you asked for the function existance, my bad :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T06:09:04.880

你不需要再打电话`prettyPrint`了。

[https://code.google.com/p/google-code-prettify/wiki/GettingStarted](https://code.google.com/p/google-code-prettify/wiki/GettingStarted)说

> # 自动装载机
> 
> 您可以通过一个 URL 加载 JavaScript 和 CSS 进行美化
> 
> ```
> <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script> 
> ```
> 
> 将加载整个系统并安排美化器在页面加载时运行。您可以指定多种附加选项（作为 CGI 参数）来配置运行器。
> 
> ...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T05:45:22.680

你可以像这样测试它：

```
if (window.prettyPrint) {
    prettyPrint();
} 
```

# asp.net - ASP.Net 不打印按钮

> ID：15263949
> 
> 赞同：0
> 
> 时间：2013-03-07T05:42:32.593
> 
> 标签：asp.net, events, printing

我的 ASP.Net 页面中有一个申请表。我想在用户单击按钮时打印此页面。但不幸的是，那个触发按钮印在了纸上。我怎样才能摆脱那个按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T05:45:50.040

打印表单时使用打印 css 并使用此样式表隐藏按钮。

```
<link rel="stylesheet" href="URL to your print.css" type="text/css" media="print" /> 
```

在你的 aspx 中：

```
<asp:Button id="btn" runat="server" CssClass="button-c"/> 
```

在 print.css 文件中添加

```
.button-c {display:none !important;} 
```

# php - 有没有办法在netbeans中自动刷新函数文档

> ID：15263955
> 
> 赞同：1
> 
> 时间：2013-03-07T05:42:57.443
> 
> 标签：php, netbeans, phpdoc

众所周知，代码不断变化。有人创建它，然后成千上万的人将更改函数和底层代码的参数。记录的功能参数不断变化。

例如，函数文档现在看起来像这样：

```
/**  
 * Updates the email of the user to the new one.  
 *  
 * @param type $new_email  
 * @param type $session    
 * @param type $security_key  
 *  
 * @return type
 * @throws Exception_SessionExpired  
 */  
public function update_email($data) 
```

当然它并没有反映当前的函数参数，更糟糕的是，还有更多这样的:(

如何一次轻松更新文件中的所有功能文档？就像根据代码约定进行格式化一样，有`Alt`++ 。NetBeans 中是否也有这样的东西来更新文档？`Shift``F`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-07T05:50:44.267

我只是`/**`在函数声明之前输入，然后按回车。然后根据需要重新排序。

# jquery - 使用 JQuery 的 Django-Tasypie 图片上传示例

> ID：15263964
> 
> 赞同：1
> 
> 时间：2013-03-07T05:43:28.793
> 
> 标签：jquery, django, file-upload, tastypie

我正在寻找一种方法来实现从 jquery 到 Django-Tastypie 的客户端文件（图像）上传。

到目前为止，服务器端似乎使用 CURL 进行了正确的测试：

我发现这篇文章[很有帮助 Django-tastypie: Any example on file upload in POST?](https://stackoverflow.com/questions/12381016/django-tastypie-any-example-on-file-upload-in-post)

编辑：这就是我对 curl 所做的 ->

```
in api.py :
    class MultipartResource(object):
        def deserialize(self, request, data, format=None):
            if not format:
                format = request.META.get('CONTENT_TYPE', 'application/json')
            if format == 'application/x-www-form-urlencoded':
                return request.POST
            if format.startswith('multipart'):
                data = request.POST.copy()
                data.update(request.FILES)
                return data
            return super(MultipartResource, self).deserialize(request, data, format)

    class FooResource(MultipartResource, ModelResource):
        img = fields.FileField(attribute="img", null=True, blank=True)
        class Meta:
            queryset = Foo.objects.all()
            authorization= Authorization()

in models.py :
class Foo(models.Model):
    img = models.ImageField(upload_to="images", null=True, blank=True)
    body = models.CharField(max_length=255) 
```

然后使用 curl 运行以下命令：

```
curl -v  -F "body=test" -F "img=@my_picture.png" http://localhost:8000/api/v1/foo/ 
```

现在我试图用 jquery 作为客户端而不是 curl 来做同样的事情......没有运气。很难找到用于文件上传的 Jquery+Tastypie 的工作示例......

如果您有任何可用的简单示例，谢谢分享

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-17T02:15:21.823

如果您的意思是使用`$.ajax()`，`$.post()`那么它将无法正常工作，因为 Ajax 不支持文件上传。参见例如[这个 SO 帖子](https://stackoverflow.com/questions/166221/how-can-i-upload-files-asynchronously-with-jquery)。

虽然有一些解决方法 - 例如通过隐藏 iframe 或基于 Flash 的解决方案中的表单上传 - 它们在上面提到的 SO 帖子中进行了讨论。但是，它们都不是完美的，因此您必须选择最适合您的用例的一种。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-13T20:23:24.220

万一将来有人偶然发现这一点，我[在 github 上](https://blueimp.github.io/jQuery-File-Upload/basic.html)`curl`使用这个 jquery File Upload Demo 让图像上传工作（已经在使用）。

使用基本文件上传：

1.  包括必要的 js 文件（jquery、jquery-fileupload、iframe-transport 和 jquery.ui.widget）。
2.  初始化目标`input[type=file]`控件如下图

**代码：**

```
$('#fileupload').fileupload({
        url: url,
        dataType: 'json',
        done: function (e, data) {
            $.each(data.result.files, function (index, file) {
                $('<p/>').text(file.name).appendTo('#files');
            });
        },
        progressall: function (e, data) {
            var progress = parseInt(data.loaded / data.total * 100, 10);
            $('#progress .progress-bar').css(
                'width',
                progress + '%'
            );
        }
    }).prop('disabled', !$.support.fileInput)
        .parent().addClass($.support.fileInput ? undefined : 'disabled'); 
```

这应该可以解决问题。

# android - 如何在 Android 中访问 DIAlog 的正负按钮

> ID：15263965
> 
> 赞同：2
> 
> 时间：2013-03-07T05:43:31.307
> 
> 标签：android

我想在Android中访问Dialog的正负按钮。为什么因为我想限制我的对话的多次可见性。这就是为什么我需要访问这些按钮。但我不知道如何访问。我研究过，但结果仅适用于 alertdialog，不适用于对话。

```
Dialog mDialog = new DatePickerDialog(IncomeActivity.this,
                 mDatesetListener, calender.get(Calendar.YEAR),
             calender.get(Calendar.MONTH), calender
             .get(Calendar.DAY_OF_MONTH));
mDialog.show(); 
```

我已经尝试了以下代码。但这对我没有帮助。

```
mDialog.setOnCancelListener(new OnCancelListener() {
        public void onCancel(DialogInterface arg0) {
                                isDateClicked = false;
        }
}); 
```

`isDateClicked`是一个`boolean`值。在打开 mDIAlog 之前，我说它为`true`. 现在我想在关闭对话框时将其设置为 false。如何访问这个 mDialog 的正负按钮。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-07T05:54:55.297

嗨，您可以使用警报对话框，这样您就可以管理正面和负面按钮，请尝试以下代码：

```
 AlertDialog.Builder builder = new AlertDialog.Builder(AddSchedule.this);
 builder.setIcon(android.R.drawable.ic_dialog_info);
 builder.setTitle("Alert dialog title");
 builder.setMessage("Dialog message");
 builder.setPositiveButton("Button1", new DialogInterface.OnClickListener() {
 public void onClick(DialogInterface arg0, int arg1) {
    //DO TASK
  }
  });
 builder.setNegativeButton("Button2", new DialogInterface.OnClickListener() {
 public void onClick(DialogInterface arg0, int arg1) {
    //DO TASK
 }
});

AlertDialog dialog = builder.create();
dialog.show(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T06:03:39.737

正如 vmironov 所说，我找到了答案。非常感谢您的 vmironov。答案是

```
mDialog.setOnDismissListener(new OnDismissListener() {
        public void onDismiss(DialogInterface arg0) {
            isDateClicked = no;
        }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-07T05:59:49.367

您可以使用 mDialog.isShowing() 来了解对话框是否已经启动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-07T06:06:55.293

您可以通过这种方式获取对话框中的“**确定**”和“**取消**”按钮。

```
AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setTitle("title");
    builder.setIcon(R.drawable.launcher);
    builder.setMessage("Are you sure you want to exit?")
           .setCancelable(false)
           .setPositiveButton("Yes", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                    Display_questions.this.finish(); // using this current activity is closed
                         // Do task here

               }
           })
           .setNegativeButton("No", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                    dialog.cancel();   // using this dialog box is closed.
               }
           });
    AlertDialog alert = builder.create();
     alert.show(); 
```

祝你好运。

# trigger.io - 是否有 Trigger.IO API 调用来找出我的移动应用程序中的平台版本和重新加载流 ID？

> ID：15263966
> 
> 赞同：1
> 
> 时间：2013-03-07T05:43:36.033
> 
> 标签：trigger.io

我想跟踪我的移动电子商务应用在提交订单时运行的 Trigger.IO API 平台版本和重新加载流 ID。当我的应用程序运行时，我可以使用 API 调用来查询此信息吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T02:02:10.297

詹姆斯，是的，我想跟踪重新加载更新的使用次数，但我希望将数据提交到我自己的分析解决方案。当客户提交订单时，我希望能够执行以下操作：

```
function sendOrder (order) {

  var client = {};
  client.userAgent = window.navigator.userAgent;
  if (forge.is.android()) client.platform = "android"
  else if (forge.is.ios()) client.platform = "ios";
  client.packager = {name:"forge"};

  // ASSUME there is a new `gestalt` API to query the Trigger.IO client
  client.packager.version = forge.gestalt.platformVersion;
  client.packager.reloadId = forge.gestalt.reload.id;

  ajax.send(order, callback);

} 
```

# python - Python主函数处理真假

> ID：15263977
> 
> 赞同：0
> 
> 时间：2013-03-07T05:44:49.593
> 
> 标签：python, function, main

所以这是我的作业，但我真的不知道如何做一步。在`main()`函数的最后一步，我想根据 isPalindrome 函数返回的值报告数字是否为回文。我真的不知道如何做到这一点，所以请大家帮忙。谢谢

这是我到目前为止得到的。

```
# Write code that reverses the number and then returns the reversed number. 

def reverse(number):
     reverse=0
     while number>0:
        reverse = reverse * 10 + number % 10
        number=number//10
        return reverse

#Write code that call the reverse function,processes the value returned by the reverse function and returns True if the number is a palindrome.It will return False if number is not a palindrome.

def isPalindrome(number):
    if number == reverse:
        return True
    else:
        return False

#Write code to prompt the user to enter an integer, calls the isPalindrome function and (depending on the value returned by the isPalindrome function) reports if the number is a palindrome or not.

def main():
    number=int(input("enter number: "))

main() 
```

所以我基本上停留在最后一部分

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T05:48:45.717

要在 Python 中调用函数，请编写函数的名称并添加左括号和右括号。如果函数接受任何参数，请将参数添加到括号中。要保存返回值，请将函数调用分配给一个变量（在 Python 中称为*名称）。*

例如：

```
def foo(user):
   return 'Hello %s' % user

result = foo('Jett')
print result 
```

`Hello Jett`以上将在执行时打印。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T05:55:25.587

确保你*调用*你的`reverse`函数！

```
def is_palindrome(number):
    return number == reverse(number) 
```

在`main`你应该有这样的东西：

```
def main():
    number = int(input("enter number: "))
    if is_palindrome(number):
        print(...)   # Fill in the dots
    else:
        print(...)   # Fill in the dots 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T06:01:04.270

你的`reverse`功能必须是这样的

```
def reverse(number):
     reverse=''
     while number>0:
        reverse = reverse + str(number % 10)
        number=number//10
     return reverse 
```

并且`isPalindrome`您必须比较字符串，因为`50`它将是`05`，如果您将其转换为整数，那么它将是`5`唯一的并且您无法比较`50`and `5`。

```
def isPalindrome(number):
    if str(number) == reverse(number):
        return True
    else:
        return False 
```

然后您的功能将起作用。

# java - Android：使用 NDK 从 SD 卡进行文件 IO

> ID：15263982
> 
> 赞同：10
> 
> 时间：2013-03-07T05:45:15.040
> 
> 标签：java, android, c, file-io, android-ndk

我正在尝试使用 NDK 写入输出文件，但它似乎不起作用。我写的代码是这样的：

```
JNIEXPORT jdouble JNICALL Java_com_example_sdcardtest2_CppMethods_nativeCalculations (JNIEnv* env, jclass clazz, jdouble dub){
    jdouble hub = dub + 10;
    FILE* file = fopen("/sdcard/textTest.txt","w+");
    fputs("HELLO WORLD!\n", file);
    fclose(file);
return hub;
} 
```

返回类型是双精度的原因是我打算将该函数用于其他目的，但我首先尝试使用文件 io。在 logcat 中，我收到以下错误：

```
Fatal signal 11: (SIGSEGV) at 0x00000000c (code = 1) ..... 
```

有趣的是，当我尝试使用 java 文件 io 在调用者活动中写入或读取同一文件时，我没有遇到任何问题。并且我确保我在清单文件中具有写入权限。此外，如果我删除该`FILE* file ...`行，并尝试使用函数返回的双精度值，程序运行良好。有人可以帮忙吗？例如，我应该将问题包含在 Android.mk 或 Application.mk 文件中吗？

**更新** 我使用的是三星 Galaxy Note 2，如果这有什么不同的话

**更新2**

这是完整的代码：

爪哇活动：

```
public class MainActivity extends Activity {
private TextView text1;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    this.text1 = (TextView) findViewById(R.id.textView1);
    double d = CppMethods.nativeCalculations(2.80);
    String s = "The value of d is = " + d;

    File f1 = new File("/sdcard/textTest.txt");
    InputStream is = null;
    try {
         is = new FileInputStream(f1);
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    }

    Scanner reader = new Scanner(is);

    this.text1.setText(reader.nextLine().subSequence(0, s.length()));
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

} 
```

这是本机方法：

```
/* DO NOT EDIT THIS FILE - it is machine generated */
#include "com_example_sdcardtest2_CppMethods.h"
#include <stdio.h>
#include <string.h>

/*
 * Class:     com_example_sdcardtest2_CppMethods
 * Method:    nativeCalculations
 * Signature: (D)D
 */

JNIEXPORT jdouble JNICALL Java_com_example_sdcardtest2_CppMethods_nativeCalculations
  (JNIEnv* env, jclass clazz, jdouble dub){
    jdouble hub = dub + 10;
    FILE* file = fopen("/sdcard/textTest.txt","w+");
    fputs("hello, world\n", file);
    fclose(file);

    return hub;
} 
```

这是Android.mk：

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_SRC_FILES := com_example_sdcardtest2_CppMethods.c
LOCAL_MODULE := com_example_sdcardtest2_CppMethods
include $(BUILD_SHARED_LIBRARY) 
```

这是清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.sdcardtest2"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"></uses-permission>

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.sdcardtest2.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

**更新**

最后更新：我在别人的手机上尝试了相同的代码，也是 Galaxy Note 2，它成功了。好像问题出在我的手机上。*叹*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T09:05:36.647

也许文件路径是错误的。我使用 SDcard 路径作为“/mnt/sdcard/”。

我记不清了，但你可以试试“/mnt/sdcard/...”或“mnt/sdcard/...”。

或者，您可以使用`Environment.getExternalStorageDirectory().getAbsolutePath()`.

# css - Django 模板，“包含”css 而不是使用链接

> ID：15263983
> 
> 赞同：0
> 
> 时间：2013-03-07T05:45:20.697
> 
> 标签：css, django, templates

最近我们遇到了浏览器缓存 css 文件的问题，因此当我们将代码移动到另一个 Web 服务器时，我们会得到意外和不需要的结果。阅读了各种解决方案后，我想到 css 文件可以包含在模板中。而不是写

```
<link href="/static/css/parentx.css" rel="stylesheet" type="text/css"> 
```

我们可以把

```
<style>{% include "static/css/parent.css" %}</style> 
```

这会将css嵌入到html中。它的额外好处是减少了为 css 文件返回服务器的次数，但缺点是根本不缓存 css 并且不允许 Web 服务器提供静态文件。但是，这些文件非常小，通常约为 12K。

我建议将其作为一项临时措施，因为我刚刚发现资产管理插件的存在看起来做得更好。我从未见过使用“包含”模板命令来获取 css（和 javascript）文件，所以也许有一个我不知道的缺点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T07:28:23.497

完全不缓存 CSS 文件会减慢页面加载速度，尽管它是不必要的。

尽可能长时间地缓存您的 CSS，当您需要使缓存无效时，一个可靠的方法是加载另一个文件，我的意思是同一个文件具有另一个名称。它可能是`parent1391234565.css`or`parent-v003.css`或`parent130307.css`or `parent-4e6ca1437f2d.css`。如果您告诉浏览器下载`parent-v002.css`，您可以确定它们`parent-v003.css`的缓存中没有！

# perl - Perl 目录连接

> ID：15263987
> 
> 赞同：0
> 
> 时间：2013-03-07T05:45:39.193
> 
> 标签：perl, path, absolute-path

是否有一个函数说`f`（在基本 Perl 或库中）这样：

```
f("/a/b/c", "./d") == "/a/b/c/d"
f("/a/b/c", "../d") == "/a/b/d"
f("/a/b/c", "/d") == "/d" 
```

基本上，它会返回重复`cd`ing 产生的目录。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-07T05:52:59.580

Core 的File [::](http://search.cpan.org/perldoc?Path%3a%3aClass) [Spec](http://search.cpan.org/perldoc?File%3a%3aSpec)有这样的功能（`rel2abs`

```
use Path::Class qw( dir );
say dir('./d')->absolute('/a/b/c');    # /a/b/c/d
say dir('../d')->absolute('/a/b/c');   # /a/b/d
say dir('/d')->absolute('/a/b/c');     # /d 
```

如果您要创建文件的路径，请使用`file`而不是。`dir`

顺便说一句，`./d`只是一种罗嗦的写作方式`d`。

* * *

糟糕，在 unix 系统上，它返回中间一个，因为如果不检查文件系统`/a/b/c/../d`就不可能知道`/a/b/c/../d`方法。`/a/b/d`（实际上可能是`/a/b/e/f/d`。）在我的脑海中，我不知道有任何工具可以通过使用 pwd 以外的基础检查文件系统来生成绝对路径。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T06:29:07.953

可能这缺少很多东西，但是一个函数`f`可以是这样的：

```
use warnings;
use strict;

sub f {
  my ($s, $cd) = @_; 
  return $cd if ($cd =~ m!^/!); # return path if abs
  $cd =~ s!//+!/!g;
  my @v = split(/\//, $cd);
  my @i = split(/\//, $s);
  for my $c (@v) {
    next if $c eq ".";
    pop @i, next if $c eq "..";
    push @i, $c; 
  }
  return join("/", @i);
}

my @p = ( 
  ["/a/b/c", "./d"], 
  ["a/b/c", "../d"], 
  ["/a/b/c/", "/d"], 
  ["a/b/c/e/f/g", "../../c/e/../d"]);

print f(@$_), "\n" for @p; 
```

# c - Rcpp 如何在 Rcpp 中生成随机多元法线向量？

> ID：15263996
> 
> 赞同：-4
> 
> 时间：2013-03-07T05:46:20.540
> 
> 标签：c, r, rcpp, random-sample

我想生成一些大的随机多元（超过 6 维）正常样本。在 R 中，许多包都可以做到这一点，例如 rmnorm、rmvn... 但问题是速度！所以我尝试通过Rcpp写一些C代码。我在网上浏览了一些教程，但似乎没有多变量分布的“糖”，在 STL 库中也没有。

任何帮助表示赞赏！

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-07T21:13:51.233

我不确定 Rcpp 是否会有所帮助，除非您找到一个好的算法来近似您的多元变量（cholesky、svd 等）并使用 Eigen（RccpEigen）或 Armadillo（使用 RcppArmadillo）对其进行编程。

这是使用 Cholesky 分解和 (Rcpp)Armadillo 的一种方法

```
#include <RcppArmadillo.h>

// [[Rcpp::depends(RcppArmadillo)]]

// [[Rcpp::export]]

using namespace arma; 
using namespace Rcpp;

mat mvrnormArma(int n, mat sigma) {
   int ncols = sigma.n_cols;
   mat Y = randn(n, ncols);
   return Y * chol(sigma);
} 
```

现在是纯 R 中的幼稚实现

```
mvrnormR <- function(n, sigma) {
    ncols <- ncol(sigma)
    matrix(rnorm(n * ncols), ncol = ncols) %*% chol(sigma)
} 
```

您还可以检查是否一切正常

```
sigma <- matrix(c(1, 0.9, -0.3, 0.9, 1, -0.4, -0.3, -0.4, 1), ncol = 3)
cor(mvrnormR(100, sigma))
cor(MASS::mvrnorm(100, mu = rep(0, 3), sigma))
cor(mvrnormArma(100, sigma)) 
```

现在让我们对其进行基准测试

```
require(bencharmk)
benchmark(mvrnormR(1e4, sigma),
          MASS::mvrnorm(1e4, mu = rep(0, 3), sigma),
          mvrnormArma(1e4, sigma),
          columns=c('test', 'replications', 'relative', 'elapsed'))

## 2 MASS::mvrnorm(10000, mu = rep(0, 3), sigma)          100
## 3                   mvrnormArma(10000, sigma)          100
## 1                      mvrnormR(10000, sigma)          100
##   relative elapsed
## 2    3.135   2.295
## 3    1.000   0.732
## 1    1.807   1.323 
```

在此示例中，我使用了具有单位方差和零均值的正态分布，但您可以轻松地推广到具有自定义均值和方差的高斯分布。

希望这可以帮助

# authentication - appuse 2.2.1 是否可以使用需要身份验证的 smtp 服务器？

> ID：15263999
> 
> 赞同：0
> 
> 时间：2013-03-07T05:46:26.530
> 
> 标签：authentication, smtp, appfuse

我在 mail.properties 中指定了 smtp 服务器和身份验证信息，但 appfuse 2.2 只是忽略了 mail.username 和 mail.password 属性。如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T16:34:30.397

最后我想通了。smtp 设置位于 appfuse-service-2.2.1.jar/applicationContext-service.xml 中。将其复制到 src/resources，重命名为 applicationContext-services.xml，并取消注释身份验证设置，修改 mail.properties 以添加身份验证信息。

修改web.xml，更改contextConfigLocation，使用新的applicationContext-services.xml。