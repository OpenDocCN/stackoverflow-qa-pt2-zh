# StackOverflow 问答 14715000-14715999

# ios - 使用委托将数据从 UIViewController 传递到 UITabBarController？

> ID：14715003
> 
> 赞同：-1
> 
> 时间：2013-02-05T19:07:48.233
> 
> 标签：ios, uiviewcontroller, delegates, uitabbarcontroller

首先，我是object-c的初学者，我正在研究它。

我正在尝试创建一个简单的应用程序，只是为了学习代表在另一个[主题](https://stackoverflow.com/questions/14685014/passing-data-between-two-views-with-xcode-4-6)中建议我的人。

情况： - 故事板；-UITabBarController；- UIViewController。

该应用程序必须从选项卡栏控制器（FirstViewController 和 SecondViewController）开始，从 FirstViewController 我想转到 ViewController（ThirdViewController），那里有一个滑块和一个后退按钮。我尝试使用委托将滑块的内容从 ThirdViewController 传递到 FirstViewController。

当我运行该应用程序时，在启动屏幕之后，它崩溃了，我收到了这条消息：

> 2013-02-05 19:16:08.382 PassDataBetweenTabsUsingDelegate[3761:c07]-[SecondViewController setDelegate:]：无法识别的选择器发送到实例 0x74c4ed0 2013-02-05 19:16:08.384 PassDataBetweenTabsUsingDelegate [3761:c07] 终止应用程序由于未捕获的异常“NSInvalidArgumentException”，原因：“-[SecondViewController setDelegate:]：无法识别的选择器发送到实例 0x74c4ed0”

这里也是[整个项目代码](http://www.2shared.com/file/60GkdpvW/PassDataBetweenTabsUsingDelega.html)，复制/粘贴部分代码更快。

我对代表做错了吗，或者我不知道如何告诉 ThirdViewcontroller 它必须去第一个而不关心第二个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:20:50.343

问题出在这一行：

```
ThirdViewController *svc = [self.tabBarController.viewControllers objectAtIndex:1]; 
```

[self.tabBarController.viewControllers objectAtIndex:1] 不会返回 ThirdViewController 的实例，因为您没有在标签栏中添加它。您刚刚通过模态 segue 将 ThirdViewController 与 FirstViewController 连接起来。

相反，您需要做的是创建 ThirdViewController 的实例，然后设置它的委托，然后以模态方式呈现它。

# c - OpenGL正弦函数向点移动

> ID：14715005
> 
> 赞同：0
> 
> 时间：2013-02-05T19:07:49.743
> 
> 标签：c, opengl, glut

我有一个 Open GL 项目，其中我有一个 2D 对象，它应该向目标点移动直到它碰到它，然后它将停止，直到 currentX 和 Y 到达目标 X 和 Y。这是我的 glutTimerFunc 中的代码：

```
void callbackTimerGlutFunc(int value)
{
    spinX += SPEED_X;
    spinZ += SPEED_Z;
    if (spinX > 360.0) {
        spinX = spinX - 360.0;
    }
    if (spinZ > 360.0) {
        spinZ = spinZ - 360.0;
    }

    if (xPos != DESTINATION_X || yPos != DESTINATION_Y)
    {
        if (xPos < DESTINATION_X)
            xPos += speed;
        if (xPos > DESTINATION_X)
            xPos -= speed;

        yPos = cosf(xPos); // THIS IS THE NEW Y CALCULATION
    }

    glutPostRedisplay();
    glutTimerFunc(100, callbackTimerGlutFunc, value);
} 
```

基本上，我会根据当前 x (xPos) 是离目的地 X 更远或更近来增加它。很明显，这不起作用。我很肯定我只是在使用 cosf 错误。任何人都知道我怎样才能得到一个很好的“正弦波”到我的目的地 x 和 y？

哦，我在我的显示功能中使用了这个功能：

```
glTranslatef(xPos, yPos, 0.0); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:23:08.927

cosf 接受作为弧度输入的双精度（浮点）。这意味着以 1.0 的增量在 y 的每个方向上只会有大约 4 步。您可以尝试将 x 增加一些浮点值，例如 0.1 或其他值。

# asp.net - 将 IDataReader 转换为 DbDataReader

> ID：14715010
> 
> 赞同：0
> 
> 时间：2013-02-05T19:08:16.400
> 
> 标签：asp.net, ado.net

我`SqlDataReader`在我的项目中使用从数据库读取数据以将其发送到 Web 服务。我有这种方法来读取公司数据`companyID`，`companyName`但我遇到了一个铸造问题：

```
public static DbDataReader GetCompanies()
{
    DbDataReader dr = null;
    DbCommand comm = GenericDataAccess.CreateCommand();

    comm.CommandType = CommandType.StoredProcedure;
    try
    {
        dr = GenericDataAccess.ExecuteReader(comm);
        dr.Read();
    }
    catch (Exception ex)
    {
        throw ex;
    }
    return dr;

}

//ExecuteReader DAL
     public static IDataReader ExecuteReader(DbCommand command)
            {
                try
                {
                    command.Connection.Open();
                    return command.ExecuteReader(CommandBehavior.CloseConnection);
                }
                catch (Exception ex)
                {
                    Utilities.LogError(ex);
                    throw;
                }
                finally
                {
                    command.Connection.Close();
                }

            } 
```

问题：

```
Error   1   Cannot implicitly convert type 'System.Data.IDataReader' to 'System.Data.Common.DbDataReader'. 
An explicit conversion exists (are you missing a cast?) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:12:19.847

更改 GetCompanies() 方法（首选）或 DAL ExecuteReader() 方法的返回类型。

# mysql - mysql数据透视表日期（垂直到水平数据）

> ID：14715011
> 
> 赞同：4
> 
> 时间：2013-02-05T19:08:21.720
> 
> 标签：mysql, sql, pivot

我一直在寻找几个小时没有一个像样的答案。

我想改造这张桌子：

```
 Client_id    Date
-----------  ------------  
1            2013-02-03    
1            2013-02-10
1            2013-05-12
2            2013-02-03
2            2013-07-15 
```

至：

```
 Client_id    Date1          Date2         Date3         Date4, Date5, Date6...
-----------  ------------   ------------  ------------  ------------
1            2013-02-03     2013-02-10    2013-05-12
2            2013-02-03     2013-07-15 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-05T19:20:47.127

为了获得此结果，您需要对数据进行*透视*。MySQL 没有数据透视函数，但您可以将聚合函数与`CASE`表达式一起使用。

如果日期数已知，则可以对查询进行硬编码：

```
select client_id,
  max(case when rownum = 1 then date end) Date1,
  max(case when rownum = 2 then date end) Date2,
  max(case when rownum = 3 then date end) Date3
from
(
  select client_id,
    date,
    @row:=if(@prev=client_id, @row,0) + 1 as rownum,
    @prev:=client_id 
  from yourtable, (SELECT @row:=0, @prev:=null) r
  order by client_id, date
) s
group by client_id
order by client_id, date 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/1592c/6)

我实现了用户变量来为组内的每条记录分配一个行号`client_id`。

如果您有未知数量的日期，那么您将需要使用准备好的语句来动态创建 sql：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'MAX(CASE WHEN rownum = ',
      rownum,
      ' THEN date END) AS Date_',
      rownum
    )
  ) INTO @sql
from
(
  select client_id,
    date,
    @row:=if(@prev=client_id, @row,0) + 1 as rownum,
    @prev:=client_id 
  from yourtable, (SELECT @row:=0) r
  order by client_id, date
) s
order by client_id, date;

SET @sql 
  = CONCAT('SELECT client_id, ', @sql, ' 
           from
           (
             select client_id,
               date,
               @row:=if(@prev=client_id, @row,0) + 1 as rownum,
               @prev:=client_id 
             from yourtable, (SELECT @row:=0) r
             order by client_id, date
           ) s
           group by client_id
           order by client_id, date');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/988e6/3)。

他们都给出了结果：

```
| CLIENT_ID |                          DATE_1 |                          DATE_2 |                     DATE_3 |
--------------------------------------------------------------------------------------------------------------
|         1 | February, 03 2013 00:00:00+0000 | February, 10 2013 00:00:00+0000 | May, 12 2013 00:00:00+0000 |
|         2 | February, 03 2013 00:00:00+0000 |     July, 15 2013 00:00:00+0000 |                     (null) | 
```

# php - Mcrypt 解密不工作 - PHP

> ID：14715014
> 
> 赞同：0
> 
> 时间：2013-02-05T19:08:33.227
> 
> 标签：php, encryption, mcrypt

我正在使用两个简单的函数来加密和解密密码。但是解密功能无法正常工作。这是我的输出：

> 加密：�\� ���#�%\��>�3,�o�Sd��c�
> 解密：test123

这是我的代码：

```
$size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC);
$iv = mcrypt_create_iv($size, MCRYPT_DEV_RANDOM);   

function encrypt($data)
{
    $key = 'test';
    $encrypted_data = mcrypt_cbc(MCRYPT_RIJNDAEL_256, $key, $data, MCRYPT_ENCRYPT, $iv);
    return $encrypted_data;
}

function decrypt($encryptedData)
{       
    $key = 'test';
    $decrypt = mcrypt_cbc(MCRYPT_RIJNDAEL_256, $key, $encryptedData, MCRYPT_DECRYPT, $iv);
    return $decrypt;
} 
```

```
$password = encrypt($member[0]['PASSWORD']);
print('Encrypted: '.$password.'<br />');
$password = decrypt($password);
print('Decrypted: '.$password); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:14:02.207

嗯，是的，当您使用随机 IV 进行加密和使用新 IV 进行解密时，就会发生这种情况。您应该只在加密期间生成 IV 并将其作为密文的前缀。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:21:10.973

问题在于`$iv`一代。您在加密期间生成它，然后在解密期间再次生成它。

```
$size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC);
$iv = mcrypt_create_iv($size, MCRYPT_DEV_RANDOM);

function encrypt($data, $iv)
{
    $key = 'test';
    $encrypted_data = mcrypt_cbc(MCRYPT_RIJNDAEL_256, $key, $data, MCRYPT_ENCRYPT, $iv);
    return $encrypted_data;
}

function decrypt($encryptedData, $iv)
{
    $key = 'test';
    $decrypt = mcrypt_cbc(MCRYPT_RIJNDAEL_256, $key, $encryptedData, MCRYPT_DECRYPT, $iv);
    return $decrypt;
}

$password = encrypt("testing", $iv);
echo $password.'<br>';
echo decrypt($password, $iv); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-05T21:08:24.920

好的，我使用以下代码进行了加密：

```
$size = mcrypt_get_iv_size(MCRYPT_RIJNDAEL_256, MCRYPT_MODE_CBC);
$iv = mcrypt_create_iv($size, MCRYPT_DEV_RANDOM);   

function encrypt($data)
{
    $key = 'test';
    $encrypted_data = mcrypt_cbc(MCRYPT_RIJNDAEL_256, $key, $data, MCRYPT_ENCRYPT, $iv);
    return base64_encode($encrypted_data);
}

function decrypt($encryptedData)
{       
    $key = 'test';
    $encryptedData = base64_decode($encryptedData);
    $decrypt = mcrypt_cbc(MCRYPT_RIJNDAEL_256, $key, $encryptedData, MCRYPT_DECRYPT, $iv);
    return trim($decrypt);
} 
```

# python - PyQt 国际化

> ID：14715015
> 
> 赞同：3
> 
> 时间：2013-02-05T19:08:51.673
> 
> 标签：python, qt, internationalization, pyqt

我可以翻译来自 QtDesigner 的文本，但我无法翻译在它之外定义的任何内容。

在示例中，此代码：

```
from PyQt4.QtCore import QCoreApplication
tr = QCoreApplication.translate

class Flag(object):

    def __init__(self, name):

        self._name = name
        self._setting_events = []
        self._clearing_events = []
        self._toggle_events = []
        self._true_name = tr("Flags", u'True')
        self._false_name = tr("Flags", u'False') 
```

根据[文档](http://pyqt.sourceforge.net/Docs/PyQt4/qcoreapplication.html#translate)，第一个参数是*context*，第二个是*sourceText*。但是当我在 QtLinguist 中打开我的`.ts`文件时，它显示*context*是我的*sourceText*而*sourceText*是评论。无论如何，在 QtLinguist 中翻译它之后，我发布`.qm`文件并运行我的应用程序，但文本不会改变。我只看到通过了*sourceText*，所以在这个例子中它仍然是`'True'`而不是我翻译的。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:47:24.280

您需要先加载翻译器，然后翻译功能才能工作。您可以使用如下代码执行此操作：

```
translationFile = "<langfile>.qm"
translator = QtCore.QTranslator()
translator.load(translationFile, "<filepath>")
a.installTranslator(translator) 
```

这`a`是您使用以下代码创建的“app”对象：

```
a = QtGui.qApp.instance() 
```

这通常在`if __name__ == '__main__':`您的主要 Python 文件的块中完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-13T13:12:45.060

我只是落入了同一个陷阱。piccy上面的评论说明了一切。

pylupdate “只是”一个文件解析器。它搜索`tr()`和`translate()`作为字符串。它忽略了诸如`my_tr_func = translate`.

如果你写

```
my_tr_func = translate
text = my_tr_func("Context", "Source text") 
```

您的字符串将被忽略。

这里的技巧是您使用 tr() 作为别名，而不仅仅是任何字符串，而且 pylupdate 不仅忽略了它，还把它误认为是 QObject tr() 方法并相应地解析了它的参数。

您对此无能为力（除非您修补 pylupdate ...）。

请注意，显然，您可以写

```
translate = QtCore.QCoreApplication.translate
text = translate("Context", "Source text") 
```

这总比没有好。

# asp.net - 在使用 open xml 进行批量更新期间获取空值插入

> ID：14715016
> 
> 赞同：1
> 
> 时间：2013-02-05T19:08:53.040
> 
> 标签：asp.net, sql-server, sql-server-2008

我的数据库字段是

```
Id which is primary key and auto increment
imagename varchar(max)
imagepath varchar(max)
isdeleted bit 
```

现在我正在使用 openxml 进行批量插入。它在 imagename 和 imagepath 列中插入空值。这是我的存储过程：

```
alter PROCEDURE PB_Insertgallery   
  @XmlString nText
AS
BEGIN    
    SET NOCOUNT ON;
DECLARE @XMLDocPointer INT  

    EXEC sp_xml_preparedocument @XMLDocPointer OUTPUT, @XmlString     
   INSERT INTO tb_gallery
   (imagename, imagepath)    
   SELECT imagename,imagepath
   FROM OPENXML(@XMLDocPointer,'/NewDataSet/Table1',2)    
    WITH  (imagename VARCHAR(max),  --'@ImageName',     
         imagepath VARCHAR(max)     --'@ImagePath'
          )   
   EXEC sp_xml_removedocument @XMLDocPointer 
END
GO 
```

xml字符串是：

```
<NewDataSet>
     <Table1>
          <Imagename>Chrysanthemum.jpg</Imagename>
          <Imagepath>/prop_images/temp/Chrysanthemum.jpg</Imagepath>
     </Table1>
</NewDataSet> 
```

请帮帮我；为什么我在插入期间得到空值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:06:30.330

这是由于区分大小写，SQL 中的 imagename、imagepath 是小写的，而在 ntext 中有一些大写。

```
alter PROCEDURE test   
  @XmlString nText,
  @Propertyid Varchar(100),
  @Builderid Varchar(100)
AS
BEGIN    
    SET NOCOUNT ON;
DECLARE @XMLDocPointer INT  

    EXEC sp_xml_preparedocument @XMLDocPointer OUTPUT, @XmlString     
   INSERT INTO tb_gallery
   (Imagename, Imagepath, Propertyid, Builderid)    
   SELECT Imagename,Imagepath, @Propertyid, @Builderid
   FROM OPENXML(@XMLDocPointer,'/NewDataSet/Table1',2)    
    WITH  (Imagename VARCHAR(max),  --'@ImageName',     
         Imagepath VARCHAR(max)     --'@ImagePath'
          )   
   EXEC sp_xml_removedocument @XMLDocPointer 
END
GO 
```

# javascript - ContentEditable HTML5 localStorage 有时不起作用

> ID：14715017
> 
> 赞同：2
> 
> 时间：2013-02-05T19:08:54.333
> 
> 标签：javascript, jquery, ajax, html

我尝试将此演示中的“ContentEditable”用于我网站的 3 个 div：

[http://html5demos.com/contenteditable](http://html5demos.com/contenteditable)

我还从这个演示中为事件监听器加载了 h5utils.js

例如，其中一个 div 如下所示：

```
<div class="statsWrapper">
    <header id="met30" contenteditable="true" class="Tester">
</header>
    <p class="statsmonth_tester">
       Tester Overall
    </p>
</div> 
```

我在 html 中的脚本

```
 <script>
        //Script for saving Content Sales Report to local storage//

        var editableTester = document.getElementById('met30');
        var editableSubscriber = document.getElementById('met32');
        var editableReadOnly = document.getElementById('met35');

        addEvent(editableTester, 'blur', function() {
            localStorage.setItem('Tester', this.innerHTML);
            document.designMode = 'off';                
        });

        addEvent(editableSubscriber, 'blur', function() {
            localStorage.setItem('Subscriber', this.innerHTML);
            document.designMode = 'off';
        });

        addEvent(editableReadOnly, 'blur', function() {
            localStorage.setItem('ReadOnly', this.innerHTML);
            document.designMode = 'off';
        });

        addEvent(editableTester, 'focus', function() {
            document.designMode = 'on';
        });
        addEvent(editableSubscriber, 'focus', function() {
            document.designMode = 'on';
        });
        addEvent(editableReadOnly, 'focus', function() {
            document.designMode = 'on';
        });

        if (localStorage.getItem('Tester')) {
            editableTester.innerHTML = localStorage.getItem('Tester');
        }
        if (localStorage.getItem('Subscriber')) {
            editableSubscriber.innerHTML = localStorage.getItem('Subscriber');
        }
        if (localStorage.getItem('ReadOnly')) {
            editableReadOnly.innerHTML = localStorage.getItem('ReadOnly');
        }               
    </script> 
```

问题是：

我总是能够编辑 div 但有时 localStorage 在编辑它们后不会用我的 div 的新值进行更新。重新加载窗口后，所有值都是旧值。但这很奇怪：有时它可以工作，如果我在新窗口中打开代码。有任何想法吗？（对不起我的英语不好）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:14:02.067

您是否在 DOM 完全加载后运行脚本？实现这一目标的许多方法。但最简单的可能是使用 jQuery`(document).ready(//here comes your code)`

# vba - 如何以随机顺序将包含格式信息的范围从 word doc 中的页面传输到新的 word doc？

> ID：14715023
> 
> 赞同：3
> 
> 时间：2013-02-05T19:09:19.043
> 
> 标签：vba, ms-word

我的妻子是一名教授，我发现她多年来一直在手动创建她的测试的随机版本（以减少作弊）*，*以及她所在部门的所有其他教师。她使用 Word 2007 和 2010 编写测试，因此我着手编写 VBA 宏来为她完成这个繁琐的过程。

她的测试包括图像、列表和其他格式，因此无法直接复制文本。引用相同图像的所有问题都在同一页面上，否则每个问题都有自己的页面。第一页包含说明，需要包含在随机测试文档的开头，但所有其他页面都需要在新文档中随机化。在随机化过程之后，我将删除分页符，以便问题整齐地放在尽可能少的页面上。

到目前为止，我还无法在不丢失格式信息的情况下将从 Page 集合中获取的 Ranges 传输到新文档。我到处搜索，但我还没有发现任何迹象表明我做错了什么。

到目前为止我的代码：

```
Sub CreateTestVersions()

Dim ThisDoc As Document
Dim NewDoc As Document
Dim Pgs As pages
Dim Question As Range

Let Skip = 1 'Number of pages to skip randomizing

Set ThisDoc = Application.ActiveDocument
Set NewDoc = Documents.Add 'Create new document
Set Pgs = ThisDoc.Windows(1).Panes(1).pages 'Pages collection

ReDim Questions(1 To Pgs.Count - Skip) As Range

For p = 1 To Skip 'Add skipped pages to begining of new document
    NewDoc.Content = NewDoc.Content & Pgs(p).Rectangles(1).Range
Next

' Add questions to an array of ranges
For q = LBound(Questions) To UBound(Questions)
    Set Question = Pgs(q + Skip).Rectangles(1).Range

    'Keep questions on a single page, don't split accross pages
    Question.Paragraphs.KeepTogether = True

    ' All lists, text formatting, etc. is lost for some reason
    Set Questions(q) = Question ' Needs fixed
Next

'Randomization needs to happen here

'Add randomized questions to new document
For q = LBound(Questions) To UBound(Questions)
    NewDoc.Content = NewDoc.Content & Questions(q)
Next

'Remove page breaks
With NewDoc.Content.Find
    .Text = "^m"
    .Forward = True
    .Wrap = wdFindStop
    .Replacement.Text = ""
    .Execute Replace:=wdReplaceAll
End With
End Sub 
```

我使用 Questions 数组是因为我认为它更容易随机化，尤其是当我扩展此代码以生成多个版本时。如果可能的话，我还想避免使用选择、复制、粘贴。

任何关于我为什么会丢失格式以及应该采用什么正确方法的见解都值得赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T03:49:32.280

我确实设法使用 InsertFile 并在每个问题周围添加范围书签来使其工作。这是成品。希望它会帮助其他人！

```
Sub CreateTestVersions()

Dim ThisDoc As Document
Dim NewDocs() As Document
Dim Pgs As pages
Dim Question As Range
Dim skip As Variant
Dim versions As Variant
Dim Vers() As Integer
Dim qList As String
Dim numQs As Integer
Dim bound() As String
Dim fileName() As String
Dim pages As Integer
Dim minPages As Integer
Dim tryAgain As Boolean
Dim all As Range

Set ThisDoc = Application.ActiveDocument
Set Pgs = ThisDoc.ActiveWindow.Panes(1).pages 'Pages collection

'Number of pages to skip randomizing
skip = InputBox( _
    "Each question should be on its own page, " _
    & "unless that question shares a connection with another " _
    & "(e.g. they share an image reference).  You can separate " _
    & "them using CTRL-Enter or Insert Page Break." & vbNewLine & vbNewLine _
    & "How many pages belong at the beginning of every version " _
    & "(instructions, personal data, etc.)?", "Question", 1)

If skip = "" Then Exit Sub

versions = InputBox("How many versions would you like to produce?", "Question", 4)

If versions = "" Then Exit Sub

numQs = Pgs.Count - skip

qList = InputBox(numQs & " question pages detected. Please list which questions" _
    & " you want to use, with ranges denoted with dashes and gaps by commas" _
    & " (e.g. 1-5, 9, 12-20).", "Question", "1-" & numQs)

If qList = "" Then Exit Sub

ReDim NewDocs(1 To versions) As Document
ReDim Vers(1 To versions) As Integer
For v = 1 To versions
    'Create new document(s)
    Set NewDocs(v) = Documents.Add
    Vers(v) = v
Next

ReDim Indexes(1 To numQs) As Long
qList = Replace(qList, " ", "")
RangeList = Split(qList, ",")
numQs = 0
For Each rng In RangeList
    bound = Split(rng, "-")
    For i = bound(LBound(bound)) To bound(UBound(bound))
        numQs = numQs + 1
        Indexes(numQs) = i
    Next
Next

ReDim Preserve Indexes(1 To numQs) As Long
ReDim Questions(1 To numQs) As Range

' Add questions to an array of ranges
For Each q In Indexes
    If (Not ThisDoc.Bookmarks.Exists("Question " & q)) Then
        ThisDoc.Bookmarks.Add "Question" & q, _
                          Pgs(q + skip).Rectangles(1).Range
    End If
Next

minPages = Pgs.Count
Randomize
Do
    For Each v In Vers
        'Clear new document in case we are retrying for a shorter version
        Set all = NewDocs(v).Content
        all.WholeStory
        all.Select
        Selection.Delete
        'Add skipped pages to begining of new document
        If (Not ThisDoc.Bookmarks.Exists("Introduction")) Then
            ThisDoc.Bookmarks.Add "Introduction", _
                ThisDoc.Range(Pgs(1).Rectangles(1).Range.Start, _
                              Pgs(skip).Rectangles(1).Range.End)
        End If
        NewDocs(v).Content.InsertFile ThisDoc.FullName, "Introduction"

        'Generate random indexs
        For i = numQs To 2 Step -1
            r = Int(Rnd() * (i - 2)) + 1
            temp = Indexes(r)
            Indexes(r) = Indexes(i)
            Indexes(i) = temp
        Next i

        'Add randomized questions to new document
        For q = LBound(Questions) To UBound(Questions)
            i = Indexes(q)
            Set Question = NewDocs(v).Content
            Question.Collapse Direction:=wdCollapseEnd
            Question.InsertFile ThisDoc.FullName, "Question" & i
            Set Question = NewDocs(v).Range(Question.Start, NewDocs(v).Range.End)
            Question.Paragraphs.KeepWithNext = True
            NewDocs(v).Bookmarks.Add "Question" & i, Question
        Next

        'Remove page breaks
        With NewDocs(v).Content.Find
            .Text = "^m"
            .Forward = True
            .Wrap = wdFindContinue
            .Replacement.Text = ""
            .Execute Replace:=wdReplaceAll
        End With

        'Group questions within pages, not accross them
        For Each Bookmark In NewDocs(v).Bookmarks
            Bookmark.Range.Paragraphs.Last.KeepWithNext = False
        Next

        pages = NewDocs(v).Windows(1).Panes(1).pages.Count
        If pages < minPages Then minPages = pages
    Next

    ' If all pages are not minimum length then try again
    tryAgain = False
    For Each v In Vers
        pages = NewDocs(v).Windows(1).Panes(1).pages.Count
        If pages > minPages Then tryAgain = True
    Next
Loop While tryAgain

For Each v In Vers
    'Save Document
    fileName = Split(ThisDoc.Name, ".")
    file = fileName(0)
    ext = fileName(1)
    NewDocs(v).SaveAs2 _
            fileName:=file & " Version " & v & "." & ext, _
            CompatibilityMode:=wdCurrent
Next
ThisDoc.Activate
End Sub 
```

# c++ - 如何将 c++ str 转换为 int？

> ID：14715025
> 
> 赞同：3
> 
> 时间：2013-02-05T19:09:39.610
> 
> 标签：c++

> **可能重复：**
> [c ++将字符串转换为int](https://stackoverflow.com/questions/8014387/c-converting-string-to-int)

我让用户按顺序输入 9 个数字。我需要将字符串数字转换为 int

```
string num;
int num_int, product[10];

cout << "enter numbers";
cin >> num;

for(int i =0; i<10; i++){
   product[i] = num[i] * 5; //I need the int value of num*5
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:12:00.667

为什么不直接读取整数？

```
int num;
cin >> num; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T19:13:44.377

您不需要有两个变量。在 C++ 中，通常在输入流中即时转换，而不会将文本视为字符串。所以你可以简单地写：

```
int num;
std::vector< int > product( 10 );

std::cout << "enter number: ";
std::cin >> num;

... 
```

请注意，我也更正了您声明数组的方式。您通常不会`int product[10];`在 C++ 中使用。（而且你几乎永远不会在同一行定义两个变量，即使语言允许。）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T19:42:39.960

到目前为止，转换为字符串并再次转换回来的最简单方法是使用转换函数。

```
 std::string s="56";
 int i=std::stoi(s); 
```

[http://en.cppreference.com/w/cpp/string/basic_string/stol](http://en.cppreference.com/w/cpp/string/basic_string/stol)

然后回来

```
 int i=56;
 std::string s=std::to_string(i); 
```

[http://en.cppreference.com/w/cpp/string/basic_string/to_string](http://en.cppreference.com/w/cpp/string/basic_string/to_string)

当然，如果您正在阅读输入，那么您也可以在那时和那里也这样做

```
 int i;
 std::cin >> i; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T19:14:38.527

if you absolutely must use a `std::string` (for any other reason.. perhaps homework?) then you can use the `std::stringstream` object to convert it from a `std::string` to `int`.

```
std::stringstream strstream(num);
int iNum;
num >> iNum; //now iNum will have your integer 
```

Alternatively, you can use the `atoi` function from C to help you with it

```
std::string st = "12345";
int i = atoi(st.c_str()); // and now, i will have the number 12345 
```

So your program should look like:

```
vector<string> num;
string holder;
int num_int, product[10];

cout << "enter numbers";
for(int i = 0; i < 10; i++){
    cin >> holder;
    num.push_back(holder);
}
for(int i =0; i<10; i++){
   product[i] = atoi(num[i].c_str()) * 5; //I need the int value of num*5
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-05T19:13:27.717

这是一个完整的示例：

```
//library you need to include
    #include <sstream>
    int main()
    {
        char* str = "1234";
        std::stringstream s_str( str );
        int i;
        s_str >> i;
    } 
```

# bash - 预先添加某些文件行

> ID：14715026
> 
> 赞同：0
> 
> 时间：2013-02-05T19:09:41.910
> 
> 标签：bash, unix, sed, awk, terminal

我想创建一个脚本来注释掉我的 Mac OS X 主机文件中包含`.com`. 还有一个可以扭转它。

所以这：

```
127.0.0.1    foo.com
127.0.0.1    bar.com
127.0.0.1    baz
127.0.0.1    qux 
```

会成为：

```
#127.0.0.1   foo.com
#127.0.0.1   bar.com
127.0.0.1    baz
127.0.0.1    qux 
```

我在 Google 和 sed 手册页上环顾四周，并用 bash 和 sed 尝试了一些东西，但我还没有接近。

`sed 's/^/^#/' | grep '.com' < hosts`

`grep '.com' | sed 's/^/^#/' < hosts`

感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T19:11:26.237

```
sed '/\.com/s/^/#/' < hosts 
```

解释：

*   `/\.com/`- 仅在与此正则表达式匹配的行上执行其余命令
*   `s/^/#/` -`#`在行首插入

如果要替换原始文件，请使用 sed 的`-i`选项：

```
sed -i.bak '/\.com/s/^/#/' hosts 
```

这将重命名`hosts`并使用更新的内容`hosts.bak`创建一个新的。`hosts`

要撤消它，请使用：

```
sed -i.bak '/^#.*\.com/s/^#//' hosts 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T01:28:35.403

用 awk

```
awk '$2 ~ /.com/{$0 = "#"$0;}{print}' temp.txt 
```

输出

```
#127.0.0.1    foo.com
#127.0.0.1    bar.com
127.0.0.1    baz
127.0.0.1    qux 
```

# php - PHP 构造类的问题（变量和命名空间）

> ID：14715027
> 
> 赞同：0
> 
> 时间：2013-02-05T19:09:44.343
> 
> 标签：php, constructor, namespaces

我刚刚遇到以下问题。我正在尝试构建一个类，但它不起作用。当我构建它使用命名空间和变量的类时，因为变量必须放在反斜杠后面（对于命名空间），它会给出错误。这是定义类的示例代码；

```
$className = 'Help';
$controller = new \controller\$className; 
```

类名是在一个变量中定义的，在上面的示例代码中，我刚刚将其设置为“Help”。在构造它`\controller\`前面的类时，这是因为它在那个命名空间中。如果我删除命名空间的东西，那么它就有了；

```
$controller = new $className; 
```

它确实有效。问题可能是因为包含要构造的类名的变量前面有一个反斜杠。我无法`use controller;`在代码的开头添加，因为包含该类的文件是在构造函数中加载的，并且在加载文件后立即构造该类。我认为该`use`函数只能在文件的开头使用，不能在方法内部使用。

我希望有人可以帮助我，。

在此先感谢蒂姆·维塞

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:12:02.040

将完全限定的类名设置为一个变量并使用它来实例化一个新对象：

```
$className = '\controller\Help';
$controller = new $className; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:11:45.947

你的第一个例子是无效的语法。您将需要类似的东西：

```
$className = '\controller\Help';
$controller = new $className(); 
```

# java - Eclipse 剪切/复制/粘贴不起作用

> ID：14715039
> 
> 赞同：0
> 
> 时间：2013-02-05T19:10:14.713
> 
> 标签：java, eclipse, junit, codepro

我已经在我的 Eclipse Juno 中安装了 CodePro AnalytiX 3.7 插件。

从那时起，在任何 Java TestCase 类中，剪切/复制/粘贴的键盘快捷键都不起作用。当我按下键盘上的“删除”按钮时，也没有发生删除。

如果我右键单击并从菜单中选择操作，同样可以正常工作。

在普通的 Java 类中它工作正常。

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:17:01.780

我也遇到过同样的问题，正如@Pragnani 所说的，这背后的原因是因为记事本。我的记事本没有响应，这就是为什么复制粘贴对我不起作用......当我重新启动系统时。一切顺利..

# azure - Azure 虚拟机监控

> ID：14715041
> 
> 赞同：2
> 
> 时间：2013-02-05T19:10:19.440
> 
> 标签：azure, monitoring, virtualization

我想准备一份关于以编程方式监控 Windows Azure 虚拟机的报告。有没有这样的API？

我想根据内存/CPU 使用情况、VM 之间的通信、VM 订阅详细信息等监控 VM...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:30:49.753

您可以使用[System Center 2012 Service Pack 1 Beta](http://www.microsoft.com/en-us/download/details.aspx?id=34607)，它内置了对 Azure VM 的监控。

SCOM 有两个缺点。首先，它不是免费的（尽管如果你的公司有足够好的微软 EA，它可能会免费提供给你的公司）。其次，要让 SCOM 在您的环境中启动和运行需要相当陡峭的学习曲线。

无论如何，SCOM 会做您所要求的一切，甚至更多。您可能想查看 30 天试用版，看看它是否是您想要进一步追求的东西。

要开始使用，请查看[如何使用 System Center 2012 监控您的 Windows Azure 应用程序](http://blogs.technet.com/b/dcaro/archive/2012/05/02/how-to-monitor-your-windows-azure-application-with-system-center-2012.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T20:24:34.663

罗伯特是正确的，不推荐。在继续之前，请查看[Office 服务器端自动化的注意事项。](http://support.microsoft.com/kb/257757)

# clearcase - 无法在基本 ClearCase 中创建具有多分支的目录元素

> ID：14715049
> 
> 赞同：1
> 
> 时间：2013-02-05T19:10:51.760
> 
> 标签：clearcase

我正在使用基本 ClearCase。请考虑我的配置规范：

```
element * CHECKEDOUT

element /cl5_sw_ste/DCT/*/... /main/rel_drop5/int_drop5/cl5_p65719_AUTE/LATEST

element /cl5_sw_ste/DCT/*/... /main/rel_drop5/int_drop5/LATEST -mkbranch cl5_p65719_AUTE
element /cl5_sw_ste/DCT/*/... /main/rel_drop5/LATEST -mkbranch int_drop5
element /cl5_sw_ste/DCT/*/... /main/0 -mkbranch rel_drop5 
```

意图：现有元素的任何检出都会自动发生在分支上`/main/rel_drop5/int_drop5/cl5_p65719_AUTE`，并且此分支方案会自动用于创建任何新元素（我目前没有）。

当我在 ClearCase Explorer 中导航到 VOB cl5_sw_ste 的根目录时，从右窗格的上下文菜单中选择 New--> Folder，并尝试创建我的第一个元素---目录元素 DCT---，我收到以下错误：

```
The system cannot find the file specified. 
```

为什么会出现这种情况？

谢谢，戴夫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:19:06.067

*这些选择规则是针对内部* 元素的`DCT`，而不是针对`DCT`自身的。

添加`DCT`时，它会在`/main/0`.
而且您的任何规则都没有选择`/main/0`.

您应该在最后添加至少添加一个选择规则：

```
element * /main/LATEST 
```

这称为“配置停止规则”，如“[使用 configspec 的 ClearCase 分支](https://stackoverflow.com/questions/4245768/clearcase-branching-using-configspec/4246525#4246525)”中所示。

# php - jQuery UI sortable：更新数据库的顺序

> ID：14715050
> 
> 赞同：0
> 
> 时间：2013-02-05T19:10:56.720
> 
> 标签：php, mysql, jquery-ui

下面的脚本返回一个带有 ID 顺序的字符串：

```
 $('#sortable').sortable({
        update: function(event, ui) {
            var newOrder = $(this).sortable('toArray').toString();
        $('input').attr("value", newOrder);     
        }
    }); 
```

例如： 88 , 24 , 32 , 10 。在这种情况下，ID 号 88 是第一个订单。

但是如何将这些信息传递给数据库呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:17:27.420

如果您在列中显示 id 并且使该列可排序，则 jQuery 将对浏览器中的元素进行排序，而无需将信息传递给数据库。

这是一个示例： [jQuery-UI sortable table resizing column when first row is dragged](https://stackoverflow.com/questions/9402789/jquery-ui-sortable-table-resizing-column-when-first-row-is-dragged)

# python - 将 python/django 应用程序部署到 gae

> ID：14715051
> 
> 赞同：1
> 
> 时间：2013-02-05T19:11:10.080
> 
> 标签：python, django, google-app-engine

我有 Django 教程中的“mysite/poll”应用程序在本地运行，并且正在尝试部署到 GAE。我在 wsgi.py 和 admin.py 中将 DJANGO_SETTINGS_MODULE 定义为

```
import os

os.environ.setdefault("DJANGO_SETTINGS_MODULE", "mysite.settings") 
```

这是部署的回溯：

```
Traceback (most recent call last):
  File "/python27_runtime/python27_lib/versions/1/google/appengine/runtime/wsgi.py",      line 196, in Handle
    handler = _config_handle.add_wsgi_middleware(self._LoadHandler())
      File        "/python27_runtime/python27_lib/versions/1/google/appengine/runtime/wsgi.py", line 255, in   _LoadHandler
    handler = __import__(path[0])
  File "/base/data/home/apps/s~ceemee11111/1.365096182895980177/admin.py", line 1, in <module>
from django.contrib import admin
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/contrib/admin/__init__.py", line 3, in <module>
    from django.contrib.admin.helpers import ACTION_CHECKBOX_NAME
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/contrib/admin/helpers.py", line 2, in <module>
    from django.contrib.admin.util import (flatten_fieldsets, lookup_field,
      File "/python27_runtime/python27_lib/versions/third_party/django-          1.4/django/contrib/admin/util.py", line 1, in <module>
    from django.db import models
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/db/__init__.py", line 11, in <module>
    if DEFAULT_DB_ALIAS not in settings.DATABASES:
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/utils/functional.py", line 184, in inner
self._setup()
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/conf/__init__.py", line 40, in _setup
    raise ImportError("Settings cannot be imported, because environment variable %s is        undefined." % ENVIRONMENT_VARIABLE)
ImportError: Settings cannot be imported, because environment variable             DJANGO_SETTINGS_MODULE is undefined. 
```

为什么 DJANGO_SETTINGS_MODULE 仍未定义

谢谢丹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:32:33.007

试试这个：

```
os.environ['DJANGO_SETTINGS_MODULE'] = 'mysite.settings' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T11:01:51.553

[https://developers.google.com/appengine/docs/python/tools/libraries27#django](https://developers.google.com/appengine/docs/python/tools/libraries27#django)

您也可以尝试添加

```
env_variables:
  DJANGO_SETTINGS_MODULE: 'myapp.settings' 
```

在 app.yaml 中

# exception - 随机 Servlet 不可用异常

> ID：14715053
> 
> 赞同：0
> 
> 时间：2013-02-05T19:11:21.683
> 
> 标签：exception, websphere, servletexception

我的应用程序正在尝试连接到第三方网站 (url)，有时我得到**javax.servlet.UnavailableException**。如果我尝试再次连接（单击提交按钮），那么它可以工作。如果我再次单击提交，它可能会或可能不会工作。所以是不一致的。该应用程序部署在 WebSphere 中。

错误信息是：

**错误页面异常** 服务器无法使用为您的应用程序指定的错误页面来处理下面打印的原始异常。有关指定错误页面的问题描述，请参阅下面的错误页面异常。

**原始例外：** 错误消息：错误代码：404 目标 Servlet：操作错误堆栈：com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:361) 处 com.ibm.ws.wswebcontainer.servlet 处的 javax.servlet.UnavailableException .ServletWrapper.handleRequest(ServletWrapper.java:526) 在 com.ibm.ws.webcontainer.webapp.WebApp.handleRequest(WebApp.java:3673) 在 com.ibm.ws.webcontainer.webapp.WebGroup.handleRequest(WebGroup.java :269) com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:831) com.ibm.ws.wswebcontainer.WebContainer.handleRequest(WebContainer.java:1478) com.ibm.ws.webcontainer。 channel.WCChannelLink.ready(WCChannelLink.java:133) 在 com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:457) 在 com.ibm.ws.http.channel。inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:515) 在 com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:300) 在 com.ibm.ws.http.channel。 inbound.impl.HttpInboundLink.ready(HttpInboundLink.java:271) 在 com.ibm.ws.tcp.channel.impl.NewConnectionInitialReadCallback.sendToDiscriminators(NewConnectionInitialReadCallback.java:214) 在 com.ibm.ws.tcp.channel.impl。 NewConnectionInitialReadCallback.complete(NewConnectionInitialReadCallback.java:113) 在 com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165) 在 com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java: 217) 在 com.ibm.io.async 的 com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)。AsyncFuture.completed(AsyncFuture.java:136) 在 com.ibm.io.async.ResultHandler.complete(ResultHandler.java:196) 在 com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:751) 在 com .ibm.io.async.ResultHandler$2.run(ResultHandler.java:881) 在 com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1593)

是配置问题还是我的代码或第 3 方网站的问题？

# user-interface - IntelliJ JSF GUI 设计器

> ID：14715055
> 
> 赞同：2
> 
> 时间：2013-02-05T19:11:23.060
> 
> 标签：user-interface, jsf-2, intellij-idea

我现在正在使用 IntelliJ，我打算使用 JSF，但我找不到任何用于 xhtml 文件的 GUI 设计器。我知道编辑代码很好，但我想知道是否有任何插件至少可以让我看到我的布局设计而无需运行网站？

我看到 Netbean 有一些，但我找不到 IntelliJ 的

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T20:38:02.813

IntelliJ IDEA 不包括 JSF 的可视化设计器，我们不知道有任何第三方插件提供该功能。

# iphone - 在哪里自定义 UINavigationController 后退按钮？

> ID：14715057
> 
> 赞同：2
> 
> 时间：2013-02-05T19:11:31.363
> 
> 标签：iphone, objective-c, cocoa-touch, uinavigationcontroller, uibarbuttonitem

`UINavigationController`我可能在这里遗漏了明显的东西，当用户在“主”屏幕上选择一个按钮时，我在一个被推入堆栈的 viewController 中。

![在此处输入图像描述](../Images/9e55afb9fb57df6d7ca5f8ed3bec70aa.png)

我要做的是达到可以访问`UIBarButtonItem`后退按钮（在图像上显示为“主”）并调用`setBackButtonBackgroundImage:forState:barMetrics:`自定义按钮的地步。

我感到困惑的是，我是否需要从每个`UIViewController`被推动的东西中执行此操作，还是我需要在其本身上执行一次`UINavigationController`？

我认为我可以使用以下方式从推送的控制器中访问我想要的内容：

```
UINavigationItem *navItem = [self navigationItem]; 
```

但认为我对事物的设置方式感到困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:17:20.290

可以自定义后退按钮的是消失的控制器，例如，您将控制器 A 推入控制器 B。您在控制器 B 上看到的后退按钮是 A 的后退按钮。

如果您想自定义应用程序中的所有按钮，您可以子类化`UINavigationController`，确保使用它而不是常规按钮，并且您可以使用`UINavigationController`以下`pushViewController:animated`方法：

```
controller.navigationItem.backBarButtonItem = ...; // Your custom back button
[super pushViewController...]; 
```

**编辑** 您无法访问默认的后退按钮，您只能创建一个新按钮来替换它。

# javascript - 检查图像是否具有标题属性，然后应用于图像选择器

> ID：14715063
> 
> 赞同：0
> 
> 时间：2013-02-05T19:11:58.167
> 
> 标签：javascript, jquery

这似乎对我不起作用。我只想对设置了标题属性的图像执行这些操作。看来我的问题是当我使用时`$(this)`，它指的是标题属性？提前致谢。

```
(function($) {
  $(function() {
    /* Run this only if images have a title attribute */
    if ($('.node-page img[title], .node-news img[title]')) {
      $(this).each(function() {
        var image = $(this);
        var caption = image.attr('title');
        var imagealign = image.css('float');

        image.after('<span class="caption">' + caption + '</span>');
        image.next('span.caption').andSelf().wrapAll('<div>');
        image.parent('div').addClass('caption-wrapper').css({'width': imagewidth, 'height': 'auto', 'float': imagealign});
      });
    }
  });
})(jQuery); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T19:13:22.617

看来你把`if`和 搞混了`each()`。您应该将 each 直接应用于您的选择器。如果没有图像具有`title`属性，则它不会做任何事情，否则它将您的功能应用于每个元素。

```
(function($) {
  $(function() {
    /* Run this only on images that have a title attribute */
    $('.node-page img[title], .node-news img[title]').each(function() {
        var image = $(this);
        var caption = image.attr('title');
        var imagealign = image.css('float');

        image.after('<span class="caption">' + caption + '</span>');
        image.next('span.caption').andSelf().wrapAll('<div>');
        image.parent('div').addClass('caption-wrapper').css({'width': imagewidth, 'height': 'auto', 'float': imagealign});
    });
  });
})(jQuery); 
```

# c# - XNA 已用时间不更新

> ID：14715067
> 
> 赞同：0
> 
> 时间：2013-02-05T19:12:17.683
> 
> 标签：c#, xna

我正在尝试在我的 XNA 游戏中实现一个简单的计数器。认为这很简单。我有以下代码：

```
 elapsed = gameTime.ElapsedGameTime.TotalMilliseconds;
        timer -= (int)elapsed;

        if (timer <= 0)
        {
            timer = 10;   //Reset Timer
        } 
```

但经过的时间从 0.0 开始不会改变。我在这里遗漏了一些明显的东西吗？我怀疑我是。我在顶部声明了 gameTime 并像往常一样初始化。

如所问，这里有更多代码：

公共类 Game1：Microsoft.Xna.Framework.Game {

```
private GameTime zombieTime; 

    public Game1()
    {
        zombieTime = new GameTime();
        // Other (unrelated) stuff here
    }

    protected void AddZombie()
    {
        elapsed = zombieTime.ElapsedGameTime.TotalMilliseconds;
        timer -= (int)elapsed;

        if (timer <= 0)
        {
            timer = 10;   //Reset Timer
            Zombie zombie = new Zombie(ScreenWidth, ScreenHeight, random);
            zombie.LoadContent(this.Content, "ZombieSprites/ZombieLeft1");
            zombies.Insert(0, zombie);
        }
     }

    protected void Update()
    {
        AddZombie();
        // Other game update stuff here
    }
} 
```

对不起，我相信原始代码片段就足够了。我在网上阅读了一些页面，人们发布了计时器的示例，并使用了我上面使用的方法。我理解这里关于更新速度足够快的一些评论，因此经过的时间将始终为 0。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:29:06.787

您没有使用正确的 GameTime。僵尸时间永远不会被任何东西更新，所以它总是会被归零。您想要使用的 GameTime 已为您传递到 Update() 函数中。

正确的做法是这样的：

```
protected void AddZombie(GameTime gameTime)
{
    float elapsed = gameTime.ElapsedGameTime.TotalMilliseconds;
    timer -= (int)elapsed;

    if (timer <= 0)
    {
        timer = 10;   //Reset Timer
        // Rest of stuff goes here
    }
}

protected void Update(GameTime gameTime)
{
    AddZombie(gameTime);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:16:21.613

[http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.gametime_members.aspx](http://msdn.microsoft.com/en-us/library/microsoft.xna.framework.gametime_members.aspx)

经过的游戏时间是自上次更新以来的时间。TOTAL game time 中的累计游戏时间...

所以，除非你做了很多你没有展示的工作，否则你根本不会花时间去更新，所以值 0 是非常明智的

尝试在其中插入一个睡眠语句，看看经过的时间是否增加。

# prolog - Prolog 否定和逻辑否定

> ID：14715070
> 
> 赞同：5
> 
> 时间：2013-02-05T19:12:26.607
> 
> 标签：prolog, logic, negation-as-failure

假设我们有以下程序：

```
a(tom). 
v(pat). 
```

和查询（返回false）：

```
\+ a(X), v(X). 
```

跟踪时，我可以看到`X`实例化为`tom`，谓词`a(tom)`成功，因此`\+ a(tom)`失败。

我在一些教程中读到，`\+`Prolog 中的 not ( ) 只是一个测试，不会导致实例化。

1.  有人可以为我澄清上述观点吗？正如我所看到的实例化。

2.  我知道非（否定为失败）和逻辑否定之间存在差异。您能否参考一篇好文章来解释它们在哪些情况下表现相同以及何时表现不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T11:28:06.450

好问题。

简短的回答：你偶然发现了“挣扎”。

> 问题是运算符 \+ 的实现仅在应用于不包含变量的文字（即基本文字）时才有效。它不能为变量生成绑定，只能测试子目标是成功还是失败。因此，为了保证对包含否定的程序的查询做出合理的回答，必须允许否定运算符仅适用于基本文字。如果将其应用于非地面文字，则该程序被称为挣扎。 [关联](http://www.cs.sunysb.edu/~warren/xsbbook/node58.html)

如果您反转查询

`v(X), \+ a(X).`

你会得到正确的答案。一些实现或元解释器检测到挣扎的目标并延迟它们，直到所有变量都被接地。

关于您的第 1 点），您会看到 NAF 树内的实例化。那里发生的事情不应该影响外部变量（在本例中为 v(X)）。Prolog 经常以幼稚的方式行事，以避免效率低下。理论上它应该只返回一个错误而不是实例化变量。

2) 这是我最喜欢的关于该主题的文章：[非单调逻辑编程](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&ved=0CD8QFjAB&url=http://ieeexplore.ieee.org/iel4/69/16382/00755623.pdf?arnumber=755623&ei=SEESUfPCBJG20QXuvoG4Cg&v6u=https://s-v6exp1-ds.metric.gstatic.com/gen_204?ip=199.67.203.142&ts=1360150856359116&auth=j4p4mtcsg5a3up24gmhfdbzgcvssp4ba&rndm=0.18615685310214758&v6s=2&v6t=5305&usg=AFQjCNGUersPbr-6R6U1vhcIXEwfO8Y5jQ&bvm=bv.41934586,d.d2k)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T20:22:51.660

WRT 第 2 点，[维基百科文章](http://en.wikipedia.org/wiki/Negation_as_failure)似乎是一个很好的起点。

您已经体验到理解 NAF 可能很困难。部分原因可能是（逻辑）否定，即使在谓词演算的简单竞赛中也很难定义（例如参见[Russel 悖论](http://en.wikipedia.org/wiki/Russell%27s_paradox)），部分原因是 Prolog 的强大变量是圆顶的，以保留如果否定证明*失败*的实际反例. 看看你是否能理解[forall /2 的实际库定义（请阅读文档，它是综合且有趣的），这是运行](http://www.swi-prolog.org/pldoc/doc_for?object=forall/2)*故障驱动循环*的首选方式：

```
%%  forall(+Condition, +Action)
%
%   True if Action if true for all variable bindings for which Condition
%   if true.

forall(Cond, Action) :-
    \+ (Cond, \+ Action). 
```

我记得我第一次看到它时，它看起来像魔法......

*编辑*一个教程，我发现，在“探索”我的链接集合时，JRFisher 是一个很好的[网站](http://www.csupomona.edu/~jrfisher/www/prolog_tutorial/contents.html)。它充满了有趣的东西，可惜它的解释有点简洁，需要学生经常用执行来回答自己。请参阅[第 2.5 段](http://www.csupomona.edu/~jrfisher/www/prolog_tutorial/2_5.html)，专门讨论失败的否定。我想你也可以享受第 3 节。Prolog 的工作原理

# iphone - 是否有不应该在 .pch 文件中添加所有导入的原因？

> ID：14715073
> 
> 赞同：3
> 
> 时间：2013-02-05T19:12:43.287
> 
> 标签：iphone, objective-c, xcode, ipad

我主要指的是应用程序级别的导入，而不是在您构建库时，在这种情况下，您应该避免在 .pch 文件中导入标头是显而易见的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:18:16.173

该`.pch`文件的重点是它可以被预编译一次并且不用管它。

如果您将所有应用程序头文件都导入到 .xml 文件中`.pch`，则每次更改其中任何一个头文件时都必须重新编译它，从而抵消所有好处。更糟糕的是，这意味着项目中的所有*其他*文件都必须重新构建，因为内容已`.pch`更改。

唯一应该被您拉入的`.pch`标头是几乎永远不会更改的标头，例如系统标头。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:18:11.400

将所有导入添加到 pch 可能会使构建速度变慢。这真的取决于项目。

假设您有 100 个 .m 文件，其中一个使用 AVFoundation。如果您将 AVFoundation 标头添加到您的 pch，那么编译器必须为每个 .m 文件处理较大的 pch，但只有其中一个从中受益。这可能会更慢，也可能不会。差异可能太小而无法轻松测量。

如果您正在考虑将项目自己的 .h 文件添加到 pch 中，那肯定会使您的构建速度变慢，因为当您的任何 .h 文件发生更改时，Xcode 将重新编译每个 .m 文件。

仅在需要的地方包含框架头文件的另一个原因是，如果您决定将源文件复制到另一个项目，则可以更轻松地重用它们。

# android - 如何上报我的 Android 开发环境的详细信息？

> ID：14715075
> 
> 赞同：0
> 
> 时间：2013-02-05T19:12:47.463
> 
> 标签：android, android-emulator

假设我有一个在 AVD 模拟器上工作的代码示例，我如何报告我的 Android 开发环境的详细信息以提供代码随附的参考？

是否有任何用于报告此类信息的 Android API？

我所说的信息是，例如：我已经下载了adt-bundle-linux-x86_64，有没有版本？我的 AVD 等的详细信息。

# signalr - signalR 组通知 + 设计模式

> ID：14715085
> 
> 赞同：1
> 
> 时间：2013-02-05T19:13:07.520
> 
> 标签：signalr

我有一个应用程序，可在成员完成注册后将其与各自的组联系起来。例如工资单人员--> 工资单组，服务台人员--> 服务台组。我想利用 signalR 来满足他们的通知要求，因此每当薪资人员执行需要通知其余人员的重要事情时，它会发布一条消息，并且只有薪资组内的人员才会收到通知。

一个工作人员**不仅限于**一组，而且不限数量。根据公司要求分组。

我不确定该怎么做，但我能想到的是，当员工登录时，我的应用程序从数据库获取数据，可能是一串串联组，并循环“订阅”所有他们所属的组，然后将来自 db 的组信息数据存储在会话变量中，并在每次用户更改页面时将其用作订阅列表，以便他们可以在应用程序的整个会话期间接收通知。

有人有什么建议可以更好地处理我的情况吗？谢谢。

# vim - Vim 使用默认值关闭文件

> ID：14715086
> 
> 赞同：0
> 
> 时间：2013-02-05T19:13:13.440
> 
> 标签：vim

有没有办法告诉 Vim 每次我要关闭文件时该做什么？具体来说，我问是因为我不想一直打电话`:mkview`，特别是因为我大部分时间都忘记了......所以我可以告诉 Vim`:loadview`在我打开文件和`:mkview`关闭文件时调用吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:34:18.783

如果您知道要搜索什么，最好的答案通常在 Vim 的帮助下。在这种情况下，一种可能的解决方案是[`:h :loadview`](http://vimdoc.sourceforge.net/htmldoc/starting.html#%3aloadview)：

```
To automatically save and restore views for *.c files:
    au BufWinLeave *.c mkview
    au BufWinEnter *.c silent loadview 
```

您可以修改它以满足您自己的需要。要使其适用于所有文件类型，请使用`*`而不是`*.c`. 要在 Vim 启动和退出时发生这种情况，请使用事件`VimLeave`and`VimEnter`而不是`BufWinLeave`and `BufWinEnter`。

# ruby-on-rails - 如何使用 ruby on rails 中另一个模型的数据修改一个模型的数据顺序？

> ID：14715089
> 
> 赞同：1
> 
> 时间：2013-02-05T19:13:22.160
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rubygems, ruby-on-rails-3.2

我有一个页面上显示的对话列表。这些对话中的每一个都充满了 2 个用户之间的消息。

一个会话 has_one 消息（作为该会话其他消息的父级的主消息）。对话列表目前的排序如下：

```
default_scope :order => 'conversations.updated_at DESC' 
```

我更喜欢使用最近发布的消息 created_at 或 updated_at 时间/日期对列表进行排序。要获取最近发布的消息，我可以这样做

```
c = Conversation.find(4)
c.message.children.last 
```

然后从那里我可以访问我想要的列。以下是我目前拥有的。有没有办法对此进行调整，以便它访问我的 Messages 表并从刚刚发布的消息中获取 created_at 和 updated_at 数据，并使用它来订购上面提到的对话列表？

```
class Conversation < ActiveRecord::Base

   belongs_to :message

   default_scope :order => 'conversations.updated_at DESC'

class Message < ActiveRecord::Base

  acts_as_tree
  has_one :conversation 
```

亲切的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:39:45.690

为了做你想做的事，你需要加入messages表，按对话ID分组，并按updated_at的聚合函数排序。翻译成 Rails，类似于：

```
default_scope { select("conversations.*, max(messages.updated_at) as last_update").join(:messages).group("conversations.id").order("last_update desc") } 
```

我假设 Rails 3，虽然你的 default_scope 的第一个定义似乎表明 Rails 2。如果是这样，你必须相应地修改我的代码。

# ruby-on-rails - Rails 3.2.9/nginx/unicorn，旧的独角兽进程在部署后仍然存在

> ID：14715098
> 
> 赞同：1
> 
> 时间：2013-02-05T19:13:47.873
> 
> 标签：ruby-on-rails, nginx, ruby-on-rails-3.2, capistrano, unicorn

我刚刚在 512MB VPS 切片（Ubuntu 12.04）上启动了一个新应用程序。我是第一次尝试 nginx/unicorn 堆栈，我或多或少地遵循了[Ryan Bates 的 Railscast](http://railscasts.com/episodes/335-deploying-to-a-vps)进行部署，结果相当不错。

在我使用 capistrano 部署任何更改后：

1.  我对任何 erb 文件所做的更改都不会反映在生产中，并且
2.  似乎旧的独角兽流程仍然存在。当我尝试点击应用程序时出现 500 错误，并且 exception_notifier 告诉我它正在 /releases/ 内的过时文件夹中查找应用程序

我的**deploy.rb**文件如下所示：

```
namespace :deploy do
  %w[start stop restart].each do |command|
    desc "#{command} unicorn server"
    task command, roles: :app, except: {no_release: true} do
     run "/etc/init.d/unicorn_#{application} #{command}"
    end
  end
  # etc... 
```

还有我的**unicorn.rb**文件（基于零停机部署的设置）：

```
preload_app true 

before_fork do |server, worker|
  if defined?(ActiveRecord::Base)
    ActiveRecord::Base.connection.disconnect!
  end

  old_pid = "#{root}/tmp/pids/unicorn.pid.oldbin"
  if File.exists?(old_pid) && server.pid != old_pid
    begin
      Process.kill("QUIT", File.read(old_pid).to_i)
    rescue Errno::ENOENT, Errno::ESRCH
    end
  end
end

after_fork do |server, worker|
  if defined?(ActiveRecord::Base)
    ActiveRecord::Base.establish_connection
  end
end 
```

到目前为止，解决此问题的唯一方法是，如果我手动杀死独角兽`sudo kill 'cat /home/path/to/myapp/current/tmp/pids/unicorn.pid'`，然后重新启动它。

在我的 deploy.rb 中执行 unicorn 重启与我的 unicorn.rb 文件中的零停机时间部署设置之间是否存在冲突？

提前感谢您的帮助！

**更新**

我已经取得了一些进展。看起来我在**deploy.rb**文件中启动/停止/重启独角兽的任务没有完成这项工作。启动任务*似乎*可以正常工作，但我相信 unicorn 需要更具体和有针对性的命令来终止和重新启动进程。我借用了在这里找到的代码[https://gist.github.com/zires/1003099](https://gist.github.com/zires/1003099)并进行了一些修改：

更新**了 deploy.rb**：

```
task :start, :roles => :app, :except => { :no_release => true } do
  run "/etc/init.d/unicorn_#{application} start"
end

task :stop, :roles => :app, :except => { :no_release => true } do
  run "kill -QUIT `cat #{release_path}/tmp/pids/unicorn.pid`"
end

task :restart, :roles => :app, :except => { :no_release => true } do
  run "kill -s USR2 `cat #{release_path}/tmp/pids/unicorn.pid`"
end 
```

像这样停止和重新启动独角兽进程似乎工作得更好，我可以确认在 cap 部署后会产生全新的进程。我真诚地希望这可以帮助解决同样问题的人，这是一个令人沮丧的问题！

一个问题仍然存在，我在**deploy.rb**中的内容是否与我的**unicorn.rb**代码一起工作以进行零停机部署？我无法判断，在部署期间我的系统上的负载是如此之高（编译资产并停止和启动所有内容）以至于无论如何它都会杀死我的服务器......如果有人能对此有所了解，我将不胜感激。

# objective-c - Objective-C: NSLog (@"abc"); 中的 "@" (at) 符号有什么意义？

> ID：14715099
> 
> 赞同：2
> 
> 时间：2013-02-05T19:13:50.760
> 
> 标签：objective-c, nsstring, nslog, directive

而且，为什么不需要，例如：

```
printf ("abc") 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T19:18:10.937

`NSLog`接受`NSString`as 参数。`@"abc"`表示一个，`NSString`因为@ 符号，所以这是一个有效的参数`NSLog`。`printf`是一个普通的 C 函数，它接受一个 C 字符串，它只是使用 "" 创建的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T21:25:52.157

```
UPDATE:
 NSLog(@"%@",dictionary) 
```

告诉编译器我得到了字符串来满足字符串参数的要求。

更新：对不起，我应该写“NSLog”而不是 printf。我的错！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:17:27.840

因为它需要 NSString。添加 @declares 值作为 NSObject 的类型（简化）。

# mysql - 从多个项目中选择最小值/最大值

> ID：14715102
> 
> 赞同：0
> 
> 时间：2013-02-05T19:14:01.027
> 
> 标签：mysql, minmax

我将尝试尽可能简单地解释它：

首先是一些带有虚拟数据的数据库结构。

# 结构

**tb_spec_fk**

```
feature     value
-----------------
1           1
1           2
1           3
1           4
1           5
2           2
2           3
3           1
3           4
4           2
4           3
4           4
5           1
5           3
5           5
6           3
6           5 
```

**tb_spec_feature**

```
feature_id  filter
------------------
1           2
2           2
3           2
4           2
5           1
6           0 
```

**tb_spec_value**

```
value_id    name
----------------
1           10
2           20
3           30
4           40
5           50 
```

现在，我想要的是以下结果

# 结果

```
feature_id  min_value   max_value
---------------------------------
1           10          50
2           20          30
3           10          40
4           20          40 
```

但是怎么做？

# 逻辑

从 tb_spec_feature 获取其中“过滤器”等于 2 的最高值和最低值，它们存在于 tb_spec_value 表中并通过 tb_spec_fk 表连接在一起。

# 我的尝试

很多！但我会放过你:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:18:56.337

```
SELECT
    f.feature_id AS feature_id,
    MAX(value.name) AS max_value,
    MIN(value.name) AS min_value
FROM tb_spec_feature AS f
    JOIN tb_spec_fk AS fk ON f.feature_id=fk.feature
    JOIN tb_spec_value AS value ON fk.value=value.id
WHERE f.filter=2
GROUP BY f.feature_id 
```

这两个`JOIN`语句将一个特性“链接”到一个值。`GROUP BY`对具有相同特征 id 的所有行进行分组，然后您可以在这些列上采用 min 或 max 或任何其他聚合函数。

[演示](http://sqlfiddle.com/#!2/3a313/2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:56:10.983

这是你如何做到的

```
select 
    tsf.feature_id,
    tsvl.name as Min_Value,
    tsvr.name as Max_Value
from tb_spec_feature as tsf
inner join (select feature , MIN(value) MinV,MAX(value)MaxV from tb_spec_fk group by feature order by feature)as tsfkl on tsfkl.feature = tsf.feature_id
left join tb_spec_value as tsvl on tsvl.value_id = tsfkl.MinV
left join tb_spec_value as tsvr on tsvr.value_id = tsfkl.MaxV
where tsf.filter = 2
group by tsf.feature_id 
```

输出

```
feature_id  | Min_Value | Max_Value
---------------------------------
1           |   10      |   50
2           |   20      |   30
3           |   10      |   40
4           |   20      |   40 
```

## [小提琴演示](http://sqlfiddle.com/#!2/3a313/1)

# php - phpexcel选择不相邻的单元格

> ID：14715105
> 
> 赞同：1
> 
> 时间：2013-02-05T19:14:06.590
> 
> 标签：php, phpexcel

有谁知道如何在 PHPExcel 中引用不相邻的单元格？

例如：

`$sheet->getStyle('B2,C8')->applyFromArray()`

我必须将它们分成两条单独的行还是有办法将它们组合起来？我对此进行的研究比我想象的要多，似乎无法在任何地方找到答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:28:04.073

在您的情况下，您**必须**拨打两个电话：

```
$sheet->getStyle('B2')->applyFromArray($styleArray);
$sheet->getStyle('C8')->applyFromArray($styleArray); 
```

此外，我认为你必须至少传递一个参数，一个带有样式定义的数组

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:25:37.370

您可以只选择单个单元格或单元格范围，因此如果您需要选择多个不相邻的单元格，您必须分两步完成。

# android - 电池电量不足时自动关机事件

> ID：14715106
> 
> 赞同：1
> 
> 时间：2013-02-05T19:14:12.070
> 
> 标签：android, android-source, cyanogenmod

我试图在 android 源代码中找到告诉设备由于其所在的电池电量不足而关闭的事件。

我目前正在查看 cyanogenmod 源，但我想这是所有 mod 源的公共区域。

谁能指出这是在哪里，如果可能的话，如何防止手机关机？

为了澄清我为什么要这样做：

我有一部有故障的手机，当我知道它不是时，它总是报告电池电量为零（我已经测试了其他手机中的电池和故障手机中的其他电池）。防止它关闭只会延长这款原本无用的手机的使用寿命。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T08:49:56.060

在 BatteryService.java 中，当电池 lvl 过低（0%，低于 3.4v）时，服务会调用 shutdownIfNoPower 来关闭系统。

顺便问一下，您的手机是否经过 ADC 校准？或校准数据已被破坏......

# python - python regex split string while keeping delimiter with value

> ID：14715113
> 
> 赞同：3
> 
> 时间：2013-02-05T19:14:37.137
> 
> 标签：python, regex

I'm trying to parse a text file with name:value elements in it into lists with "name:value"... Here's a twist: The values will sometimes be multiple words or even multiple lines and the delimiters are not a fixed set of words. Here's an example of what I'm trying to work with...

```
listing="price:44.55 name:John Doe title:Super Widget description:This widget slices, dices, and drives your kids to soccer practice\r\nIt even comes with Super Widget Mini! 
```

What I want to return is...

```
["price:44.55", "name:John Doe", "title:Super Widget", "description:This widget slices, dices, and drives your kids to soccer practice\r\nIt even comes with Super Widget Mini!"] 
```

Here's what I've tried so far...

```
details = re.findall(r'[\w]+:.*', post, re.DOTALL)
["price:", "44.55 name:John Doe title:Super Widget description:This widget slices, dices, and drives your kids to soccer practice\r\nIt even comes with Super Widget Mini!"] 
```

Not what I want. Or...

```
details = re.findall(r'[\w]+:.*?', post, re.DOTALL)
["price:", "name:", "title:", "description:"] 
```

Not what I want. Or...

```
details = re.split(r'([\w]+:)', post)
["", "price:", "44.55", "name:", "John Doe", "title:", "Super Widget", "description:", "This widget slices, dices, and drives your kids to soccer practice\r\nIt even comes with Super Widget Mini!"] 
```

which is closer, but still no dice. Also, I can deal with an empty list item. So, basically, my question is how do you keep the delimiter with the values on a re.split() or how do you keep re.findall() from either being too greedy or too stingy?

Thanks ahead of time for reading!

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:21:12.867

使用前瞻断言：

```
>>> re.split(r'\s(?=\w+:)', post)
['price:44.55',
 'name:John Doe',
 'title:Super Widget',
 'description:This widget slices, dices, and drives your kids to soccer practice\r\nIt even comes with Super Widget Mini!'] 
```

当然，如果您的值中有一些单词后跟冒号，它仍然会失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:22:37.390

@Pavel 的答案更好，但您也可以将上次尝试的结果合并在一起：

```
# kill the first empty bit
if not details[0]:
    details.pop(0)

return [a + b for a, b in zip(details[::2], details[1::2])] 
```

# android - ListView smoothScrollToPosition 工作但 setSelectionFromTop 不工作

> ID：14715117
> 
> 赞同：2
> 
> 时间：2013-02-05T19:14:48.070
> 
> 标签：android, android-widget

我有一个列表视图，要求是务实地滚动列表。

我正在使用这个。

```
 // allClues.setSelection(clueIndex +1 );
 //allClues.setSelectionFromTop(clueIndex+1, rowWidth*noOfrows /2 + 50);

allClues.smoothScrollToPosition(clueIndex +1 );
allClues.invalidateViews(); 
```

它有一个 onItemClickListener

```
listView.setOnItemClickListener(new OnItemClickListener() {
          @Override
          public void onItemClick(AdapterView<?> parent, View view,
          int position, long id) {

             ItemAdapter.selectedItem = position;

            view.setSelected(true);

            ((AbsListView) parent).invalidateViews();

            puzzle.setSelected(position);

          }
        }); 
    } 
```

smoothScrolltoPosition 工作正常，但列表很长并且滚动非常频繁，因此看起来不太好。

当我使用 setSelection 将特定项目定位在顶部和 setSelectionFromTop 时，没有任何事情发生。这两种方法是否需要一些先决条件，因为 smoothScrolltoPosition 运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-14T06:39:59.443

这有效 -

```
 allClues.post(new Runnable() {            
                public void run() {
                    allClues.setSelection(ind);

                }
            }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:12:27.770

`setSelectionFromTop(..)`应该管用。正如文档所说：http: [//developer.android.com/reference/android/widget/ListView.html#setSelectionFromTop%28int,%20int%29](http://developer.android.com/reference/android/widget/ListView.html#setSelectionFromTop%28int,%20int%29)

public void setSelectionFromTop (int position, int y)

参数 position 要选择的数据项的索引（从 0 开始）。y 项目将被定位的距 ListView 顶部边缘（加上填充）的距离。

所以你可能用错了。第一个参数并不意味着列表应该滚动的位置。

# jquery - jQuery 脚本仅适用于某些页面

> ID：14715129
> 
> 赞同：0
> 
> 时间：2013-02-05T19:15:27.250
> 
> 标签：jquery

我在我的网站上使用 Colorbox，它在大多数页面上都运行良好。但是在某些使用其他 jQuery 脚本的页面上，它会失败。

我从 IE 的控制台收到此错误：

```
SCRIPT438：对象不支持属性或方法“colorbox”
```

这是给我带来麻烦的作品

```
<script type="text/javascript">
jQuery(document).ready(function(){
jQuery('.test').colorbox({iframe:true, width:"50%", height:"75%", top:50, scrolling:false,      onComplete:true});
});
</script> 
```

头部：

```
<link rel="stylesheet" type="text/css" href="http://www.domain.com/js/calendar/calendar-win2k-1.css" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/teststore/css/styles.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/base/default/css/widgets.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/default/aw_blog/css/style.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/default/onsale/css/product_onsale_label.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/default/onsale/css/category_onsale_label.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/teststore/css/sidenav.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/teststore/css/sidenavcollapse.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/teststore/css/faq/label.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/teststore/css/mageworx/modalbox.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/teststore/css/icart.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/default/css/prolabel.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/teststore/css/colorbox.css" media="all" />
<link rel="stylesheet" type="text/css" href="http://www.domain.com/skin/frontend/default/teststore/css/print.css" media="print" />
<script type="text/javascript" src="http://www.domain.com/js/jquery/jquery.1.8.2.min.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/colorbox/jquery.colorbox-min.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/jquery/jquery.noconflict.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/prototype/prototype.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/lib/ccard.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/prototype/validation.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/scriptaculous/builder.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/scriptaculous/effects.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/scriptaculous/dragdrop.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/scriptaculous/controls.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/scriptaculous/slider.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/varien/js.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/varien/form.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/varien/menu.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/mage/translate.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/mage/cookies.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/aw_onsale/onsale.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/mageworx/modalbox.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/mageworx/icart.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/varien/product.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/calendar/calendar.js"></script>
<script type="text/javascript" src="http://www.domain.com/js/calendar/calendar-setup.js"></script>
<script type="text/javascript" src="http://www.domain.com/skin/frontend/default/default/js/sidenavcollapse.js"></script>
<script type="text/javascript" src="http://www.domain.com/skin/frontend/default/default/js/faq/faq.js"></script>
<script type="text/javascript" src="http://www.domain.com/skin/frontend/base/default/js/bundle.js"></script>
<link rel="canonical" href="http://www.domain.com/" /> 
```

会不会是某种冲突？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:41:33.040

经过大量搜索不同页面的源代码后，我发现正在加载多个 magento 扩展，各种不同的 jQuery 库，各种版本..

在评论所有这些之后，它再次完美无缺！

**注意自己和其他人，只有 1 个 jQuery 库！**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T19:17:15.960

很可能，它在其他浏览器中的性能如何，您是否尝试过精简到最少的代码来查看它是如何运行的？

# .net - 正则表达式在开始或结束时没有空格，但允许中间有空格，但也只允许一个字符输入：

> ID：14715133
> 
> 赞同：3
> 
> 时间：2013-02-05T19:15:30.650
> 
> 标签：.net, regex

正则表达式在开始或结束时没有空格，但允许中间有空格，但也只允许一个字符输入：

我得到的最接近的是：`^([^\s])([\sa-zA-Z0-9_\-]*)([^\s])$`

问题是它只有在输入是三个或更多字符时才会通过，我需要它接受一个字符并通过。例如：

以下内容应通过（使用 " 方便阅读，字符串中不需要）

```
"A"
"A B"
"Hello There" 
```

以下应该失败

```
" A"
"A "
" A "
" test" 
```

还需要只允许 AZ az 0-9 - _ 虽然出来，在中间部分添加空格但不在开始或结束处

有任何想法吗？

谢谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-05T19:19:46.113

非空格，可选地后跟多组空格，然后是非空格：

```
^[^\s]+(\s+[^\s]+)*$ 
```

**编辑：**

要包括字符限制，只需将非空格类替换为允许的字符：

```
^[-_a-zA-Z0-9]+(\s+[-_a-zA-Z0-9]+)*$ 
```

另外，考虑对 Unicode 友好并使用类似的东西

```
^[-_\p{Alnum}]+(\s+[-_\p{Alnum}]+)*$ 
```

（假设您的正则表达式解释器允许它）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:20:55.087

将第一个非空格字符之后的所有内容设为可选：

```
^(?=\S)[a-zA-Z0-9_\s-]*\S$ 
```

# mysql - How to store multiple emails in Ruby hash in MySQL?

> ID：14715134
> 
> 赞同：0
> 
> 时间：2013-02-05T19:15:35.230
> 
> 标签：mysql, ruby-on-rails, ruby, hash

I built my own comments in my rails app without threading and I want to be able to send reply all notifications for new comments on a project. Would it be best to just store emails into a ruby hash in MySQL and then read from it when necessary? I'm trying to figure out how to insert emails into a hash with keys I don't have to define, any help?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:23:09.493

假设您`string`在某个 mysql 表中有一些类型的列。

使用`json`宝石。如果你没有`json`gem 安装它`gem install json`。

```
require 'json'
reply_emails_list = ["a@gmail.com", "b@gamil.com"]
obj.column_name = {:emails => reply_emails_list}.to_json  #storing ruby hash as string in mysql 
```

要获取 ruby​​ 哈希，请使用 `JSON.parse(obj)'

```
emails_list = JSON.parse(obj.column_name)  #ruby hash 
```

或者

以铁轨方式。在模型中，您可以这样做：

```
YourModel < ActiveRecord::Base
  serialize :column_name, Array  #If don't want hash
  serialize :column_name     #you can store key value pair as I shown above
end 
```

使用 second 将避免从`hash`to转换，`json`反之亦然

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:37:29.450

根据[`ActiveRecord::Base`](http://api.rubyonrails.org/classes/ActiveRecord/Base.html#label-Saving+arrays%2C+hashes%2C+and+other+non-mappable+objects+in+text+columns)你可以`serialize`一栏：

```
class MyModel < ActiveRecord::Base
  serialize :emails
end

User.create(:emails => %w( email1@a.com email2@b.com email3@c.com ) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:29:53.063

在 Postgres 中，有一个数组扩展可以用来获取实际的数组存储。不幸的是，这不适用于 MySQL。

对于像电子邮件这样的数据，最好的办法是将您的电子邮件列表序列化为一个字符串字段，并提供一个综合属性来提供数组访问器（如果需要）。然后，您可以在评论中添加回调，以便在将评论添加到此项目时更新电子邮件列表。

```
class Project < ActiveRecord::Base
  # db String field email_list
  attr_accessor :emails

  def emails
    email_list.split(',')
  end

  def emails=(email_ary)
    self.email_list = email_ary.join(',')
  end
end 
```

这可能是使用 JSON blob 的一个很好的替代方法，因为它可以更轻松地进行文本搜索和处理逗号分隔的列表。我不知道 split() 或 JSON.parse 是否在序列化性能方面提供优势。

# c# - Getting Mouse Pointer location across system

> ID：14715138
> 
> 赞同：0
> 
> 时间：2013-02-05T19:15:46.767
> 
> 标签：c#, winforms

I have to get the Mouse Pointer Location across all Application i.e., Not specific to application,

For Eg: I Want to Get the Mouse Pointer Location On the screen which is not specific to corresponding Application.

Thanks in advance dinesh

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:16:40.213

您正在寻找静态`Cursor.Position`属性。

# android - Determine Users on Android 4.2 Device

> ID：14715139
> 
> 赞同：0
> 
> 时间：2013-02-05T19:15:51.610
> 
> 标签：android, android-4.2-jelly-bean, multi-user

Is there any way to determine if there are other users installed on the device or if the device is being used a single user tablet?

Along those lines is it possible to get the name, id, or Google account of the current user?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:21:15.750

要回答您的第二个问题，此代码将返回当前用户的所有 Google 帐户：

```
 AccountManager manager = AccountManager.get(context);
    Account[] accounts = manager.getAccountsByType("com.google"); 
```

您还需要在清单中获得此权限：

```
 <uses-permission android:name="android.permission.GET_ACCOUNTS" / 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:21:20.570

有关帐户信息，请参阅[`AccountManager`](http://developer.android.com/reference/android/accounts/AccountManager.html)课程。这应该向您显示设备上的帐户并允许您确定其他用户等。

有关详细信息，请查看以下帖子（以及其他类似的帖子......）：

[如何在安卓手机上找回登录的谷歌账户？](https://stackoverflow.com/questions/4038333/how-do-i-retrieve-the-logged-in-google-account-on-android-phones)

# javascript - Why does prototyping Function not affect console.log?

> ID：14715140
> 
> 赞同：6
> 
> 时间：2013-02-05T19:15:53.253
> 
> 标签：javascript, console, prototyping

I prototyped `Function` so that it has a getBody function:

```
Function.prototype.getBody = function() {
    // Get content between first { and last }
    var m = this.toString().match(/\{([\s\S]*)\}/m)[1];
    // Strip comments
    return m.replace(/^\s*\/\/.*$/mg,'');
}; 
```

See [here](https://stackoverflow.com/a/7960435/1643670) for more info. I tried to test it this way:

```
console.log(console.log.getBody.getBody()); 
```

but received an error: `TypeError: console.log.getBody is undefined`. I figured out that maybe this happens because `console.log` was defined before I actually prototyped `Function` so I created an empty function `x` right before the prototyping and tried to call

```
console.log(x.getBody.getBody()); 
```

which worked without a problem. Checking the type of `console.log` with `typeof console.log` results in "function". Here's a [CodePen](http://codepen.io/anon/pen/maHsE) to try it out. All of this wasn't really a surprise since it's what I expected except of `console.log.getBody` to be undefined.

So why does prototyping `Function` not affect `console.log`? I'm using Firefox 18.0.1 with Firebug 1.11.1.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:45:03.260

这似乎是 Firebug 的问题，而不是 Firefox 本身的问题。我的猜测是，`Function`在 Firebug 中与`Function`您的页面中的范围不同。（因为与其他浏览器不同，Firebug 是一个扩展，而不是内置的浏览器工具）

事实上，如果您使用内置的 Firefox 控制台 ( [Ctrl+Shift+K](https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Opening_the_Web_Console) ) 而不是 Firebug，那么您的代码可以正常工作。

关于 Firebug 内部的更多信息可以在这里找到

[http://getfirebug.com/wiki/index.php/Firebug_Internals](http://getfirebug.com/wiki/index.php/Firebug_Internals)

这段摘录可能很有趣

> 当 Firebug 与 Firefox 分离时，在新窗口或单独窗口中打开，新窗口有自己的范围。在该范围内，一些 Firebug 脚本标记会编译以创建与原始 browser.xul 窗口的连接。最重要的是，chrome.js 对每个顶级窗口都是唯一的，但分离窗口使用的 Firebug 对象是父 browser.xul 的对象。

# sql - How do I count decimal places in SQL?

> ID：14715141
> 
> 赞同：14
> 
> 时间：2013-02-05T19:15:54.590
> 
> 标签：sql, sql-server-2008, floating-point, decimal, scale

I have a column X which is full of floats with decimals places ranging from 0 (no decimals) to 6 (maximum). I can count on the fact that there are no floats with greater than 6 decimal places. Given that, how do I make a new column such that it tells me how many digits come after the decimal?

I have seen some threads suggesting that I use CAST to convert the float to a string, then parse the string to count the length of the string that comes after the decimal. Is this the best way to go?

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-05T19:26:12.637

你可以使用这样的东西：

```
declare @v sql_variant

set @v=0.1242311

select SQL_VARIANT_PROPERTY(@v, 'Scale') as Scale 
```

这将返回`7`。

* * *

我试图使上述查询与`float`列一起工作，但无法按预期工作。它仅适用于`sql_variant`您可以在此处看到的列：[http ://sqlfiddle.com/#!6/5c62c/2](http://sqlfiddle.com/#!6/5c62c/2)

所以，我开始寻找另一种方法并在这个[答案](https://stackoverflow.com/a/8978769/114029)的基础上，我得到了这个：

```
SELECT value,
LEN(
    CAST(
         CAST(
              REVERSE(
                      CONVERT(VARCHAR(50), value, 128)
                     ) AS float
             ) AS bigint
        )
   ) as Decimals
FROM Numbers 
```

这是一个用于测试的 SQL Fiddle：[http ://sqlfiddle.com/#!6/23d4f/29](http://sqlfiddle.com/#!6/23d4f/29)

* * *

为了解决这个小怪癖，这里有一个修改版本，可以处理浮点值没有小数部分的情况：

```
SELECT value,
       Decimals = CASE Charindex('.', value)
                    WHEN 0 THEN 0
                    ELSE
           Len (
            Cast(
             Cast(
              Reverse(CONVERT(VARCHAR(50), value, 128)) AS FLOAT
                 ) AS BIGINT
                )
               )
                    END
FROM   numbers 
```

这是随附的 SQL Fiddle：[http ://sqlfiddle.com/#!6/10d54/11](http://sqlfiddle.com/#!6/10d54/11)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T19:31:03.720

该线程也在使用 CAST，但我发现答案很有趣：

[http://www.sqlservercentral.com/Forums/Topic314390-8-1.aspx](http://www.sqlservercentral.com/Forums/Topic314390-8-1.aspx)

```
DECLARE @Places INT
 SELECT TOP 1000000 @Places = FLOOR(LOG10(REVERSE(ABS(SomeNumber)+1)))+1
   FROM dbo.BigTest 
```

在甲骨文中：

```
SELECT FLOOR(LOG(10,REVERSE(CAST(ABS(.56544)+1 as varchar(50))))) + 1 from DUAL 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-05T19:24:35.673

浮点数只是代表一个实数。实数的小数位数没有意义。特别是实数 3 可以有六个小数位，3.000000，只是所有小数位都为零。

您可能有一个显示转换未在十进制中显示最右边的零值。

另请注意，最多有 6 个小数位的原因是第 7 个不精确，因此显示转换不会使用第 7 个小数位值。

另请注意，浮点数以二进制形式存储，它们实际上在二进制点的右侧有二进制位置。十进制显示是浮点存储中二进制有理数的近似值，而浮点数又是实数的近似值。

所以关键是，浮点值有多少个小数位真的没有意义。如果您转换为字符串（例如使用 CAST），您可以计算小数位。这真的是你想要做的最好的方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-16T14:23:04.893

Oracle 的解决方案，但你明白了。trunc() 删除 Oracle 中的小数部分。

```
select *
from your_table
where (your_field*1000000 - trunc(your_field*1000000)) <> 0; 
```

查询的思路：乘以 1 000 000 后是否还有小数。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-16T20:24:02.943

我之前回答过这个问题，但我可以从评论中看出它有点不清楚。随着时间的推移，我找到了一种更好的方式来表达这一点。

将 pi 视为

```
(a) 3.141592653590 
```

这将 pi 显示为 11 位小数。然而，这被四舍五入到小数点后 12 位，如 pi，到 14 位是

```
(b) 3.1415926535897932 
```

计算机或数据库以二进制形式存储值。对于单精度浮点数，pi 将存储为

```
(c) 3.141592739105224609375 
```

这实际上是四舍五入到单个精度可以存储的最接近的值，就像我们在 (a) 中四舍五入一样。单精度可以存储的下一个最小数字是

```
(d) 3.141592502593994140625 
```

因此，当您尝试计算小数位数时，您正在尝试找出小数位数，在这之后所有剩余的小数都将为零。但是，由于数字可能需要四舍五入才能存储，它并不代表正确的值。

数字在进行数学运算时也会引入舍入误差，包括在输入数字时从十进制转换为二进制，在显示值时从二进制转换为十进制。

您无法可靠地找到数据库中数字的小数位数，因为它被近似为四舍五入以存储在有限的存储空间中。实际值之间的差异，甚至数据库中的精确二进制值将四舍五入以十进制表示。四舍五入时总会缺少更多的十进制数字，因此您不知道零之后何时不再有非零数字。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-05-27T07:07:30.817

我发现的另一种方法是

选择 1.110000 , LEN(PARSENAME(Cast(1.110000 as float),1)) 作为 Count_AFTER_DECIMAL

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-07-07T05:08:35.627

我注意到 Kshitij Manvelikar 的答案有一个错误。如果没有小数位，则不返回 0，而是返回数字中的字符总数。

所以改进它：

```
Case When (SomeNumber = Cast(SomeNumber As Integer)) Then 0 Else LEN(PARSENAME(Cast(SomeNumber as float),1)) End 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-05T20:00:08.900

这是另一个 Oracle 示例。正如我总是在非 Oracle 用户开始对我大喊大叫和投票等之前警告他们...... SUBSTRING 和 INSTRING 是 ANSI SQL 标准函数，可以在任何 SQL 中使用。Dual 表可以用任何其他表替换或创建。这是我从以下位置复制双表代码的 SQL SERVER 博客的链接：http: [//blog.sqlauthority.com/2010/07/20/sql-server-select-from-dual-dual-equivalent/](http://blog.sqlauthority.com/2010/07/20/sql-server-select-from-dual-dual-equivalent/)

```
CREATE TABLE DUAL
(
 DUMMY VARCHAR(1)
)
GO
INSERT INTO DUAL (DUMMY)
VALUES ('X')
GO 
```

此查询返回点或小数位后的长度。如果需要，可以将 str 转换为_number(str)。您还可以在点小数位之前获取字符串的长度 - 将代码更改为 LENGTH(SUBSTR(str, 1, dot_pos))-1 并删除 INSTR 部分中的 +1：

```
SELECT str, LENGTH(SUBSTR(str, dot_pos)) str_length_after_dot FROM
(
 SELECT '000.000789' as str
      , INSTR('000.000789', '.')+1 dot_pos 
   FROM dual
)
/

SQL>

STR           STR_LENGTH_AFTER_DOT
----------------------------------
000.000789    6 
```

你已经有了关于铸造等的答案和例子......

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-12-27T20:24:37.850

这个问题询问常规 SQL，但我需要**SQLite**的解决方案。SQLite 既没有 log10 函数，也没有内置的反向字符串函数，所以这里的大多数答案都不起作用。我的解决方案类似于[Art 的 answer](https://stackoverflow.com/a/14715903/4824627)，事实上，类似于 phan 在问题正文中描述的内容。它的工作原理是将浮点值（在 SQLite 中，一个“REAL”值）转换为文本，然后计算小数点后的字符。

对于名为“Table”的表中名为“Column”的列，以下查询将生成每行小数位数的计数：

```
select
length(
    substr(
        cast(Column as text),
        instr(cast(Column as text), '.')+1
    )
) as "Column-precision" from "Table"; 
```

代码会将列转换为文本，然后获取文本中句点 ( `.`) 的索引，并获取从该点到文本末尾的子字符串。然后，它计算结果的长度。

`limit 100`如果您不希望它在整个桌子上运行，请记住！

[![显示两列的数据库视图； 第一个叫](../Images/ba65d36db72b1053c8290d1a530254c1.png)](https://i.stack.imgur.com/sTgDy.png)

这不是一个完美的解决方案；例如，它认为“10.0”有 1 个小数位，即使它只是一个 0。但是，这实际上是我需要的，所以这不是我关心的问题。

希望这对某人有用:)

# php - Can anyone help me putting the below code in the sql?

> ID：14715145
> 
> 赞同：-4
> 
> 时间：2013-02-05T19:16:09.103
> 
> 标签：php, mysql, sql

I need a little help in putting a code in the below sql code.

My code is -

```
torrentlang.name AS lang_name, FROM torrentlang LEFT JOIN torrentlang ON torrentlang = torrentlang.id 
```

I want to put it inside the below query:

```
$query  =   "   SELECT
                  torrents.id,
                  torrents.category,
                  torrents.name,
                  torrents.image1,
                  torrents.added,
                  torrents.size,
                  torrents.hits,
                  torrents.banned,
                  torrents.comments,
                  torrents.seeders,
                  torrents.leechers,
                  torrents.times_completed,
                  categories.name          AS cat_name,
                  categories.parent_cat    AS cat_parent
                FROM torrents
                  LEFT JOIN categories
                    ON category = categories.id
                WHERE categories.parent_cat = 'Movies'
                ORDER BY added DESC
                LIMIT 2";
$query12 = mysql_query($query)or die(mysql_error()); 
```

Please help!

I need the result as below:

```
$query    = "SELECT
              torrents.id,
              torrents.category,
              torrents.name,
              torrents.image1,
              torrents.added,
              torrents.size,
              torrents.hits,
              torrents.banned,
              torrents.comments,
              torrents.seeders,
              torrents.leechers,
              torrents.times_completed,
              categories.name          AS cat_name,
              categories.parent_cat    AS cat_parent
            FROM torrents
              LEFT JOIN categories
                ON category = categories.id,
              torrentlang.name AS lang_name,
              FROM torrentlang
              LEFT JOIN torrentlang
                ON torrentlang = torrentlang.id
            WHERE categories.parent_cat = 'Movies'
                AND torrentlang.id = '3'
            ORDER BY added DESC
            LIMIT 2";
$query12 = mysql_query($query)or die(mysql_error()); 
```

Please correct the above result code!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:47:36.913

尝试这个

```
 SELECT torrents.id, torrents.category, torrents.name, torrents.image1, torrents.added, torrents.size, torrents.hits, torrents.banned, torrents.comments, torrents.seeders, torrents.leechers, torrents.times_completed, categories.name AS cat_name, categories.parent_cat AS cat_parent ,torrentlang.name AS lang_name
 FROM torrents 
 LEFT JOIN categories ON torrents.id = categories.id  
 LEFT JOIN torrentlang ON torrents.id = torrentlang.id 
 WHERE categories.parent_cat = 'Movies' 
 AND torrentlang.id = 3
 ORDER BY added DESC LIMIT 2 
```

假设`torrents.id = categories.id`和`torrents.id = torrentlang.id`

# scala - Mapper 与 Record/Squeryl

> ID：14715150
> 
> 赞同：3
> 
> 时间：2013-02-05T19:16:22.430
> 
> 标签：scala, lift, squeryl

我即将在 Lift 框架中开始我的第一个项目，我必须决定选择哪个持久性库。我即将使用关系后端，因此 Mapper 和 Record 都可以发挥作用。

在 Mapper 的情况下——我最想念的是控制发送到 RDBMS 的查询的能力——尤其是当涉及到更复杂的查询时，这些查询将通过 SQL 中的连接、聚合等来解决。举个例子——让我们有以下两个实体：

```
class BaseProduct extends LongKeyedMapper[BaseProduct] with IdPK {
  // some fields
}
object BaseProduct extends BaseProduct with LongKeyedMetaMapper[BaseProduct]

class MyProduct extends LongKeyedMapper[MyProduct] with IdPK {
  // some fields
  object base extends MappedLongForeignKey(this, BaseProduct)
}
object MyProduct extends MyProduct with LongKeyedMetaMapper[MyProduct] 
```

哪里`MyProduct`是`BaseProduct`实体的专业化之一。这些实体之间显然存在一对一的关系。然而，我想出的最好的可能性来查询确切`MyProduct`的信息`BaseProduct`是这样的查询：

```
MyProduct.findAll(PreCache(MyProduct.base)) 
```

哪个发出两个查询（此外，我恐怕无法控制`MyProduct`要选择的实体的哪些字段。

对于 Mapper 库来说已经够糟糕了。我对 Record/Squeryl API 的主要担忧是它缺少`Proto`Mapper API 周围存在的所有这些类。是否有接近这些类的记录功能的东西？是否可以访问 Squeryl 中的数据库特定功能（例如 PostgreSQL 中的几何查询）？

这些层中的任何一个还有其他优点和缺点吗？或者，如果我想对与数据库的通信进行适当的类型安全封装，并且可以对查询进行适当的控制，是否还有其他值得关注的抽象层（我习惯于直接使用 PHP 中的 PDO 层发出查询 - 我不想要这样的直接查询界面，但控制查询的可能性会很大）与 Lift 框架的集成绝对是一个优势。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T22:35:42.430

我们将 Squeryl 与 Lift 一起使用已经有一段时间了，并且对它非常满意。根据您上面的案例，在当前版本的 Squeryl (0.9.5) 中，您可以执行以下操作：

```
class BaseProduct(id:Long, some more fields) extends KeyedEntity[Long] {

}

class MyProduct(id:Long, some more fields) extends KeyedEntity[Long] {

} 
```

然后，您将有一个定义如下[关系](http://squeryl.org/relations.html)的模式（我假设它们在 ID 字段中加入）：

```
val baseProducts = Table[BaseProduct]("base_products")
val myProducts = Table[MyProduct]("my_products")
val myProductsToBaseProducts = 
  oneToManyRelation(myProducts, baseProducts).via((mp, bp) =>
    mp.id === bp.id) 
```

要查询这两条记录，您可以执行以下操作：

```
from(myProducts, baseProducts) ( (mp, bp) =>
  where(mp.id === bp.id and mp.id === LOOKUPVAL) 
  select(bp, mp) ) 
```

上面的查询将从单个 SQL 选择返回一个 (BaseProduct, MarketProduct) 元组。

您还可以使用关系来检索相关项目，例如通过将此方法添加到`MyProduct`：

```
def baseProduct = myProductsToBaseProducts.left(this) 
```

但是，就像您在 Mapper 中的示例一样，它将发出第二个查询。至于进行特定于数据库的查询，有一个[`&`](http://squeryl.org/arbitrary-select-expressions.html)运算符允许您在服务器上评估表达式。如果该函数在 Squeryl 中不可用，您可以创建[自定义函数](http://squeryl.org/custom-functions.html)。

总的来说，我发现 Squeryl 非常灵活，是 ORM 和直接 SQL 之间的完美混合体。它的性能非常好，而且我还没有找到太多 Squeryl 禁止我轻松获取所需数据库功能的地方。下一个版本会变得更容易，因为 0.9.6 将在[自定义类型](https://github.com/max-l/squeryl-extended-field-types-example/blob/master/src/main/scala/example/MyCustomTypes.scala)方面具有更大的灵活性。

# java - 不断循环的电子邮件意图

> ID：14715154
> 
> 赞同：0
> 
> 时间：2013-02-05T19:16:42.653
> 
> 标签：java, android, android-intent

我的电子邮件意图在它发布电子邮件时运行良好。我现在遇到一个问题，一旦我在自定义模板上单击“发送电子邮件”，它会设置 GMail 模板的“收件人”、“主题”和“消息”字段，但当我单击“发送”时，它会正常加载GMail 模板它循环回自定义模板。如图所示：

这是我定制的电子邮件模板：

![在此处输入图像描述](../Images/b4609b3eadef4f0c48f213d039b24030.png)

单击“发送电子邮件”后，就会加载 Gmail 模板：

![在此处输入图像描述](../Images/eab846ed97b1f07361819f8c4db099e1.png)

一旦单击 GMail 模板的“发送”按钮，它就会循环回自定义模板，并且它们会在彼此之间不断循环。希望有人能给我一个关于如何停止这种循环的想法！

这是我在“onClick”中的意图的代码：

```
package com.example.flybase2;

import android.app.Activity;
import android.app.Dialog;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

public class ContactsEmail extends Activity implements OnClickListener{

String emailPassed;
String emailAdd;
String emailSub;
String emailMess;
EditText setEmailAddress;
EditText setEmailSubject;
EditText setEmailMessage;
Button btnSendEmail;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

setContentView(R.layout.emaillayout);

Bundle extras = getIntent().getExtras(); 
if (extras != null) {
    emailPassed = extras.getString("passedEmailAdd"); 
}

setEmailAddress = (EditText) findViewById (R.id.inputEmailAddress);
setEmailAddress.setText(emailPassed);
setEmailSubject = (EditText) findViewById (R.id.inputEmailSubject);
setEmailMessage = (EditText) findViewById (R.id.inputEmailMessage);

btnSendEmail = (Button)findViewById(R.id.btnSendEmail);

btnSendEmail.setOnClickListener(this);
}

@Override
public void onClick(View sendEmailClick) {

    emailAdd = setEmailAddress.getText().toString();
    emailSub = setEmailSubject.getText().toString();
    emailMess = setEmailMessage.getText().toString();

    Intent sendEmailIntent = new Intent(Intent.ACTION_SEND); 
    sendEmailIntent.setType("plain/text");
       sendEmailIntent.putExtra(Intent.EXTRA_EMAIL,new String[] {emailAdd});  
       sendEmailIntent.putExtra(Intent.EXTRA_SUBJECT, emailSub); 
       sendEmailIntent.putExtra(Intent.EXTRA_TEXT, emailMess); 
       startActivity(Intent.createChooser(sendEmailIntent, "Send mail..."));

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:49:40.937

看起来您只是想`finish()`在`onClick()`. 这将关闭 ContactsEmail 允许用户从 GMail 应用程序返回到更有用的活动。

# c - 使用指针替换值

> ID：14715159
> 
> 赞同：1
> 
> 时间：2013-02-05T19:16:54.687
> 
> 标签：c

这是我使用指针的第一个任务......我需要创建一个函数来找出两个数字中的哪一个更大，然后替换它们以获得更大的值并打印它们。

我在以下`prinf`内容中遇到错误`main()`：

> 参数类型“void”不完整

我的代码是：

```
#include <stdio.h>
void larger_of(double * x, double * y);

int main()

{
    double num1 = 4.5;
    double num2 = 5.5;

    printf("the original two numbers is %.1lf and %.1lf\n", num1, num2);
    printf("now: %lf and %lf", larger_of(&num1, &num2));

}

void larger_of(double * x, double * y)

{
    if (* x > * y)
        * y = * x;
    else if
       (* x < * y)
        * x = * y;
    else
        printf("they are equale!!");
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:19:01.777

`larger_of`是一个不返回任何内容的函数。你不能打印它的返回值。

要在通话后打印您的号码，`larger_of`只需执行以下操作：

```
larger_of(&num1, &num2);
printf("now: %lf and %lf", num1, num2); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T19:19:46.317

您正在尝试打印 void

```
printf("now: %lf and %lf", larger_of(&num1, &num2)); 
```

你必须做什么：

```
larger_of(&num1, &num2)
printf("now: %lf and %lf",num1,num2); 
```

# r - 转推并不总是包含在用户时间线中

> ID：14715163
> 
> 赞同：1
> 
> 时间：2013-02-05T19:16:55.763
> 
> 标签：r, twitter, package

我正在使用 R twitteR 包通过“userTimeline”提取特定用户的推文：

```
require(twitteR)
timeline <- userTimeline('screenname', n=200) 
```

我的问题是，对于某些用户来说，转推包括在内，而对于其他用户，则不包括在内，我不明白为什么。

你能帮助我吗？

谢谢你，斯特凡尼亚

# ruby-on-rails-3 - Rails App中的图标字体未加载

> ID：14715172
> 
> 赞同：0
> 
> 时间：2013-02-05T19:17:28.287
> 
> 标签：ruby-on-rails-3, icons, font-face

我正在尝试在我的 rails 应用程序中包含自定义字体作为图标字体。（我正在使用字体真棒）

字体正在加载，但预览完全不正确：[http](http://cl.ly/image/3x0g3X3k3X3S) ://cl.ly/image/3x0g3X3k3X3S 。（我认为这意味着资产路径是正确的。）

您还可以在网络视图中看到字体似乎正在进入： [http ://cl.ly/image/0y0R171S0l3L](http://cl.ly/image/0y0R171S0l3L)

在 HTML 中 - 当我尝试 a 时，我可以看到所有应该应用的正确 CSS 属性，但图标呈现为一个空方块，我认为这是缺少的字符默认值。

如果我能提供更多信息，请告诉我。任何帮助都是极好的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-15T09:41:37.800

我也一直在这些方面苦苦挣扎，并且有以下工作

*   在 assets/fonts 中放置 fontawesome-webfont.eot、ttf 和 woff 文件
*   在您的 css 文件中放入以下代码（将 iconmoon 替换为 fontawesome

    ```
    @font-face {
    font-family: 'icomoon';
    src:url('fonts/icomoon.eot');
    src:url('fonts/icomoon.eot?#iefix') format('embedded-opentype'),
        url('fonts/icomoon.woff') format('woff'),
        url('fonts/icomoon.ttf') format('truetype'),
        url('fonts/icomoon.svg#icomoon') format('svg');
    font-weight: normal;
    font-style: normal; 
    ```

    }

    [data-icon]:before { font-family: 'icomoon'; 内容：attr（数据图标）；说话：无；字体粗细：正常；字体大小：16px；行高：16px；行高：1；-webkit-font-smoothing：抗锯齿；}

在您的 erb 中使用以下内容，将 xe04b 替换为您要使用的图像

```
<div class="fs1" aria-hidden="true" data-icon="&#xe04b;"></div> 
```

希望有帮助？

# php - Instagram API：如何在流行的提要中看到用户和喜欢

> ID：14715173
> 
> 赞同：0
> 
> 时间：2013-02-05T19:17:36.180
> 
> 标签：php, javascript, api, instagram

我有这段代码，我想在每张照片之前写一段文字，但我不知道在哪里写。顺便说一句，我想知道上传的每张照片都喜欢和用户。

```
function loadFeed() {
    var param = {access_token:access_token};
    cmd(param, onPhotoLoaded);
}

function cmd(param, callback) {
    //popular
    var cmdURL = 'https://api.instagram.com/v1/media/popular?callback=?';
    $.getJSON(cmdURL, param, callback);
}

function onPhotoLoaded(data) {
    if(data.meta.code == 200) {
        var photos = data.data;

        if(photos.length > 0) {
            for (var key in photos ){
                var photo = photos[key];
                $('<div id=p' + photo.id + '></div>').addClass('photoWrapper').appendTo('#panel');

                var str = '<img id="' + photo.id + '" src="' + photo.images.standard_resolution.url + '" width="100%">';
                $('<div></div>').addClass('photo').html(str).appendTo('#p' + photo.id);

                $('#' + photo.id).load(function() {
                    $('#p' + $(this).attr('id')).fadeTo('slow', 1.0);
                });

            }
        }else{
            alert('empty');
        }

    }else{
        alert(data.meta.error_message);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T04:03:41.897

您要查找的数据位于照片对象中。

[http://jsfiddle.net/AbU7a/](http://jsfiddle.net/AbU7a/)

```
function loadFeed() {
    cmd({access_token:'11007611.f59def8.4f942a67c9174159a1601a037490d3ea'}, onPhotoLoaded);
}

function cmd(param, callback) {
    //popular
    var cmdURL = 'https://api.instagram.com/v1/media/popular?callback=?';
    $.getJSON(cmdURL, param, callback);
}

function onPhotoLoaded(data) {
    if(data.meta.code == 200) {
        var photos = data.data;
console.log(photos);
        if(photos.length > 0) {
            for (var key in photos ){
                var photo = photos[key];
                $('<div id=p' + photo.id + '></div>').addClass('photoWrapper').appendTo('#panel');

                var str = '<p>likes: '+ photo.likes.count +'</p><img id="' + photo.id + '" src="' + photo.images.standard_resolution.url + '" width="50">';
                $('<div></div>').addClass('photo').html(str).appendTo('#p' + photo.id);

                $('#' + photo.id).load(function() {
                    $('#p' + $(this).attr('id')).fadeTo('slow', 1.0);
                });

            }
        }else{
            alert('empty');
        }

    }else{
        alert(data.meta.error_message);
    }
}

loadFeed(); 
```

查看您的控制台（取决于您的浏览器），它将显示您可以从照片对象中获取的数据。

我通过添加喜欢计数开始了你。

# java - 如何计算移动物体的未来位置？

> ID：14715174
> 
> 赞同：4
> 
> 时间：2013-02-05T19:17:38.557
> 
> 标签：java, math, physics

我正在创建一个小游戏，我有一个光子鱼雷，它从一艘船上向目标发射。现在，由于鱼雷的速度很慢，如果它们正在移动，船将永远不会击中任何目标，我想解决这个问题。我已经制定了多种理论并绘制了许多数学资料，以找出实现这一目标的最佳方法，最后我得出以下结论：

1.  项目清单
2.  我找到了光子鱼雷到达目标所需的时间。
3.  我发现目标在鱼雷到达的时间内走了多远。
4.  然后我找到目标的新位置和原船之间的距离。
5.  这让我有机会使用余弦规则 (​​SSS) 来找出子弹需要发射的轨迹才能有更高的击中机会。

这是一个图表：

![我的问题示意图](../Images/b487478b0e0bffb225e565007cfbe1ae.png)

现在唯一的问题是我需要将线 a 旋转到正确的方向，因为默认情况下它平行于线 c，这会弄乱整个方程。有人能帮忙吗？如果你能想出更好的方法来找到新的职位建议也非常欢迎:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:53:02.123

看起来游戏是2D的。现在，获取所有世界坐标：

```
Target Position: {xt, yt}
Target Velocity: {vxt, vyt}
Ship Position:   {xs, ys} 
```

现在，假设您在方向上击中子弹，`{bx, by}`它是方向向量或单位向量。子弹有速度`sb`。因此，`t'`子弹和目标的时空坐标为：

```
Target New Position: {xt + vxt*t', yt + vyt*t'}
Bullet New Position: {xs + bx*sb*t', ys + by*sb*t'} ( bullet starts from ship) 
```

因为此时子弹和目标都必须在一个位置，这样我们才能说子弹击中了目标。因此，我们可以将新的目标位置替换为新的子弹位置（在时间 t' 之后）：

```
xt + vxt*t' = xs + bx*sb*t'
yt + vyt*t' = ys + by*sb*t' 
```

正如我之前所说，`bx`和`by`是方向向量，因此`bx^2 + by^2 = 1`

```
(xt + vxt*t' - xs)/(sb*t') = bx
(yt + vyt*t' - ys)/(sb*t') = by
bx^2 + by^2 = 1 
```

因此，将它们平方和相加后，您将得到：

```
(yt + vyt*t' - ys)^2 + (xt + vxt*t' - xs)^2 = (sb*t')^2 
```

这是一个有一个变量的二次方程：`t'`求解它，然后你可以找到`bx`和`by`。

# linker - LD_PRELOAD_PATH 和 LD_LIBRARY_PATH 有什么区别？

> ID：14715175
> 
> 赞同：20
> 
> 时间：2013-02-05T19:17:39.217
> 
> 标签：linker, shared-libraries

LD_PRELOAD_PATH 和 LD_LIBRARY_PATH 有什么区别？

我了解它们的作用，但不了解它们之间的区别。

来自 [http://en.wikipedia.org/wiki/Dynamic_linker](http://en.wikipedia.org/wiki/Dynamic_linker)

> 可以影响动态链接器在程序执行或程序链接期间修改其行为。这方面的示例可以在各种类 Unix 系统的运行时链接器手册页中看到。此行为的典型修改是使用 LD_LIBRARY_PATH 和 LD_PRELOAD 环境变量。这些变量分别通过在备用位置搜索共享库以及通过强制加载和链接原本不会存在的库来调整运行时链接过程。

特别是，我对同时具有 LD_PRELOAD_PATH 和 LD_LIBRARY_PATH 的 Linux 中的差异感兴趣：

[https://linuxgazette.net/issue48/tag/48.html](https://linuxgazette.net/issue48/tag/48.html)

更新：这篇 1999 Linux Gazette 文章的作者在他 2013 年的评论中指出，公认的答案是 LD_PRELOAD_PATH 实际上并不存在。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-05T19:20:43.910

`LD_PRELOAD`(not `LD_PRELOAD_PATH`) 是要在任何其他库之前加载的特定库 ( *files* ) 的列表，无论程序是否需要。`LD_LIBRARY_PATH`是在加载本来会加载的库时要搜索的*目录列表。*在 linux 上，您可以阅读`man ld.so`有关这些和其他影响动态链接器的环境变量的更多信息。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2021-08-02T05:07:11.573

# LD_PRELOAD 更强大

最重要的区别是 LD_PRELOAD 可以替换*静态*链接到二进制文件中的函数。

## 例子

如果您发现 LD_PRELOAD 对您有用，但 LD_LIBRARY_PATH 神秘地不起作用，那么几乎可以肯定，这就是原因。

例如，我正在调试[GNU Readline](https://tiswww.case.edu/php/chet/readline/rltop.html)，`bash`起初我很困惑为什么我修改后的 libreadline.so 加载的是 LD_PRELOAD 而不是 LD_LIBRARY_PATH。

```
$ LD_PRELOAD=shlib/libreadline.so bash -
(worked)

$ LD_LIBRARY_PATH=shlib/ bash -
(failed) 
```

看看[ldd](https://man7.org/linux/man-pages/man1/ldd.1.html)命令，它列出了动态链接库的依赖关系，给出了答案：

```
$ ldd /bin/bash
        linux-vdso.so.1 
        libtinfo.so.6 => /lib/x86_64-linux-gnu/libtinfo.so.6 
        libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 
        /lib64/ld-linux-x86-64.so.2 
```

果然，libreadline 没有被列为共享库之一。因此，我机器上的 /bin/bash 必须在编译时与它自己的 libreadline 版本静态链接。LD_LIBRARY_PATH 不起作用的原因是二进制文件从不要求动态链接器 (ld.so) 加载 libreadline。

另一方面，LD_PRELOAD 无论如何都会加载库，允许库覆盖甚至是静态链接的函数。

# xcode - 如何让 Xcode 在选项悬停期间显示我的文档注释？

> ID：14715176
> 
> 赞同：2
> 
> 时间：2013-02-05T19:17:43.360
> 
> 标签：xcode, comments

我已阅读[Xcode 中的文档注释是什么？](https://stackoverflow.com/questions/6605535/what-are-documentation-comments-in-xcode)但我尝试了所有这些技术，但仍然无法让 XCode 4.6 在选项悬停期间显示我的评论（即按住 alt，将鼠标移到方法名称上，光标变为？，单击）。它说明了它的声明位置，但没有别的。我做错了什么还是 XCode 不支持文档注释？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:45:17.990

Xcode 的选项单击快速帮助功能从已安装的文档集中读取详细信息。

要获得类似的功能，您必须创建自己的文档集并将其添加到 Xcode 的**Preferences > Downloads > Documentation**下。

# java - 如何从源代码构建这个 Maven 项目？

> ID：14715179
> 
> 赞同：3
> 
> 时间：2013-02-05T19:18:02.340
> 
> 标签：java, eclipse, maven, languagetool

我想从源代码构建[LanguageTool](http://www.languagetool.org) Java 项目。此页面提供了获取包含所有来源的“Maven 工件”的基本说明：

[http://languagetool.org/java-api/](http://languagetool.org/java-api/)

我是一名专业的 Java 开发人员，但我以前从未使用过 Maven。有人可以告诉我如何将 LanguageTool 项目和所有源代码放入 Eclipse 以便我可以修改和构建它吗？

提前致谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:26:05.510

在您链接的页面底部（[语言工具](http://www.languagetool.org/)）是另一个到 svn 存储库的链接。在那里，您将获得有关如何自己构建工具的源代码和说明。

通常，开源项目将突出显示 maven 工件，因为它允许其他人以最简单的方式使用他们的代码。只有少数人喜欢自己构建代码，因此到源存储库的链接通常不那么显眼。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:23:32.670

没有自动化的方法可以做到这一点。

最好是启动一个基本的 maven 项目（手动或通过[Maven Archetype ，在](http://maven.apache.org/guides/introduction/introduction-to-archetypes.html)[Standard Directory Layout](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)中导入源代码，然后开始将依赖项添加到 pom.xml 以使其编译。

在各种 maven 存储库中很容易找到诸如 commons、lucene 之类的库）。

其他库您可能必须自己安装在[本地存储库](http://maven.apache.org/plugins/maven-install-plugin/install-file-mojo.html)或[远程存储库](http://maven.apache.org/guides/mini/guide-3rd-party-jars-remote.html)中。

如果那是您首选的 IDE，则有一个用于 Eclipse的[Maven 插件。](http://eclipse.org/m2e/download/)

# emacs - EMACS，函数调用高亮

> ID：14715181
> 
> 赞同：1
> 
> 时间：2013-02-05T19:18:09.227
> 
> 标签：emacs, font-lock, emacs-faces

(EMACS 24.2) 我需要突出显示函数调用。我在网上找到了这个

```
(add-hook 'c-mode-hook (lambda ()
   (font-lock-add-keywords nil '(
      ("\\<\\(\\sw+\\) ?(" . 'font-lock-function-name-face))t))) 
```

它有效，但它也突出显示以下左括号。我对正则表达式没有信心，请问如何修改匹配字符串以避免括号突出显示？

![在此处输入图像描述](../Images/0e7124859362c4a89c590873116416ac.png)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T20:21:35.890

正则表达式很好，您只需要突出显示匹配中的第一组，而不是全部。替换`. 'font-lock-function-name-face`为`1 'font-lock-function-name-face`。

另一件要改变的事情，只是一个建议，是`font-lock-add-keywords`接受模式名称作为第一个参数。所以你不需要使用钩子。

结果：

```
(font-lock-add-keywords
 'c-mode
 '(("\\<\\(\\sw+\\) ?(" 1 'font-lock-function-name-face))) 
```

# jquery - 在谷歌地图信息框内使用时多次调用 jquery 点击处理程序，但不是 infoWindow

> ID：14715192
> 
> 赞同：4
> 
> 时间：2013-02-05T19:18:47.057
> 
> 标签：jquery, google-maps, infobox

我有一个我无法弄清楚的问题。我接管了一个使用 google maps API 版本 3 的应用程序。我不是很熟悉它，但我被要求调整一些东西。其中之一需要创建自定义 infoBubbles 而不是使用默认的 infoWindow，以便我们可以将它们设计得很好。我找到了一个名为 infoBox 的类，它可以做到这一点，并按照一些例子来了解我现在的位置。但是，我的应用程序要求每个叠加层（多边形、折线或标记）在 infoBox 上都有一个删除按钮。当我们使用默认的 infoWindow 时，删除与 jQuery click 事件一起工作得很好，但现在我使用的是 infoBox，这非常奇怪。我创建了一个小测试文件来演示该问题。它的要点是当你第一次打开一个信息框时，删除按钮例程仅运行 1 次。但是一旦你关闭盒子，然后再次打开它（或另一个），例程就会运行多次。打开信息框的次数越多，删除按钮重新绑定并依次执行的次数就越多。我在 infoBox 的 domready 侦听器中包装了一些东西，这样我就可以将窗口中的元素更改为特定于正在单击的对象的属性。出于某种原因，domready 被触发了多次（我认为它只会触发一次）并且我的删除点击再次被绑定。在使用 infoBox 类之前，常规的 infoWindow 不需要 domready 即可使用 jQuery 更改标题和描述，并且 click 事件从未反复绑定。我完全不知所措，并且在这方面花费了太多时间。任何帮助，将不胜感激。一个示例测试文件如下：

```
<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?v=3&amp;sensor=false"></script>
<script type="text/javascript" src="infobox.js"></script>
<script type="text/javascript" src="jquery-1.9.0.min.js"></script>
 <script type="text/javascript">
  //global variables for the info box an for the map
  var ib = null;
  var theMap = null;
  var myOptions = null;
  var iw = null;

    function initialize() {

    //regular google maps setup crap, not important
    //
        var secheltLoc = new google.maps.LatLng(49.47216, -123.76307);

        var myMapOptions = {
             zoom: 7
            ,center: secheltLoc
            ,mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        theMap = new google.maps.Map(document.getElementById("map_canvas"), myMapOptions);

        var marker = new google.maps.Marker({
            map: theMap,
            draggable: true,
            position: new google.maps.LatLng(49.47216, -123.76307),
            visible: true
        });

        var markertwo = new google.maps.Marker({
            map: theMap,
            draggable: true,
            position: new google.maps.LatLng(49.47216, -121.76307),
            visible: true
        });

        //this is how the info box work, create an element and add some styling to it, straight out of the example docs
        var boxText = document.createElement("div");
        boxText.style.cssText = "border: 1px solid black; margin-top: 8px; background: yellow; padding: 5px;";

        //here i am adding the HTML that i would want my infoBox to contain, test crap for now, but the important part is that
        // in the real site, it will have 2 buttons, one to delete the entity you are working with (polygons, polylines, markers) and one
        // to open up a new overlay in which you can make edits to information about that entity. Before changing from the default infoWindow
        // (which is hard to style) to the new infoBox (which can be styled however you like) the deletes worked fine. Over time and trial and 
        // error i have noticed that each time you open up an infoBox, the delete is re-binding and executing multiple times. 
        var infoContent = '';
        infoContent += "<div class='info-wrapper'>";
    infoContent += "<div class='title-wrapper'><p><strong>This is a great title</strong></p></div>";
    infoContent += "<div class='description-wrapper'><p>This is a phenomenal description</p></div>";
    infoContent += "<div class='buttons'><p><a class='openLink' href='#'>Open</a></p>"; //<input type='submit' value='Open' />";
    infoContent += "<p><a class='deleteLink' href='#'>Delete</a></p></div>";
      //close class = info wrapper
    infoContent += "</div>";

    //assign my new variable of html to the inneHTML of main box element
    boxText.innerHTML = infoContent;

    iw = new google.maps.InfoWindow({
      content: infoContent
    });

    //set the default options for infoBox, basically same as default example
        myOptions = {
             content: boxText
            ,disableAutoPan: false
            ,maxWidth: 0
            ,pixelOffset: new google.maps.Size(-140, 0)
            ,zIndex: null
            ,boxStyle: { 
              background: "url('tipbox.gif') no-repeat"
              ,opacity: 0.75
              ,width: "280px"
             }
            ,closeBoxMargin: "10px 2px 2px 2px"
            ,closeBoxURL: "http://www.google.com/intl/en_us/mapfiles/close.gif"
            ,infoBoxClearance: new google.maps.Size(1, 1)
            ,isHidden: false
            ,pane: "floatPane"
            ,enableEventPropagation: false
        };

        //click handlers for the markers
        google.maps.event.addListener(marker, "click", function (e) {
            openInfoBox(marker, e, 'this is the new title')
        });

        google.maps.event.addListener(markertwo, "click", function (e) {
            openInfoBox(markertwo, e, 'great title')
        });

        //the infobox itself
        ib = new InfoBox(myOptions);

    }

    //the open info Box function
    function openInfoBox(feature, e, text) {

      //open the damn thing
      ib.open(theMap, feature);

    //define a listnener for when the infoBox is ready for jquery to make changes, this is necessary if you want
    // to alter the values in the box which i will need to do on MLP, setting the title and description values to 
    // the node that is being altered
    google.maps.event.addListener(ib, 'domready', function() { 
      //chnage the title to hwatever is passed in for demo sake
      $('.title-wrapper p').html('<strong>'+text+'</strong>');
      //$('.description-wrapper p').html('i have change the description');

      /*******************************************************
      HERE IS WHERE THE MAIN PROBLEM LIES THAT IS KILLING ME!!!
      When this routine runs on MLP, i have a way to know which
      feature is being deleted, and the index is removed from the array,
      and the array is reordered. However, for some crazy reason, the more times
      you open up an infoWindow, the more times this event fires. And if you are say
      trying to delete index 0 of an array of 4 elements, at times this may run 4
      times on a single click which then wipes out all your mapping elemetns instead
      of just the one you wanted it to delete. NO ME GUSTA!
      *******************************************************/
      $('.deleteLink').click(function(event) {
        event.preventDefault();
        alert('you clicked me');
        alert('your tricky');
      });
    });
    }

    function notify(event) {
    event.preventDefault();
    alert('test');
    alert('test12');
    }
</script>

<title>Creating and Using an InfoBox</title>
</head>
<body onload="initialize()">
<div id="map_canvas" style="width: 100%; height: 400px"></div>
<p>
This example shows the "traditional" use of an InfoBox as a replacement for an InfoWindow.
</body>

</html> 
```

在[http://midwestfish.djcase.com/infobox/test.html上查看现场演示可能更容易](http://midwestfish.djcase.com/infobox/test.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:27:40.993

尝试改变这个：

`$('.deleteLink').click(function(event) {})`

到：

`$('.deleteLink').off('click').on('click', function(event){});`

澄清问题是什么以及为什么这应该起作用。每次单击该点时都会调用 openInfoBox()。您可以通过垃圾邮件单击该点然后单击删除来重新创建错误。这是因为每次单击该点时，它都会运行该功能并将单击绑定到删除按钮上。

为防止它首先取消绑定（关闭），然后重新绑定（打开）。

# java - 考虑将 JaCoCo 与 Maven 和 Jenkins 一起使用

> ID：14715193
> 
> 赞同：1
> 
> 时间：2013-02-05T19:18:56.050
> 
> 标签：java, maven, jenkins, continuous-integration, jacoco

我正在考虑将 JaCoCo 与 Maven 和 Jenkins 一起使用，以查看我的程序员是否测试了 % 的代码。我将 JaCoCO 插件添加到 maven，我看到报告正在生成，但是如果 X% 被测试，我可以告诉 maven 通过测试吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T09:49:17.617

开始使用 Sonar 服务器。[http://www.sonarsource.org/](http://www.sonarsource.org/)；[http://docs.sonarqube.org/display/SONAR/Documentation](http://docs.sonarqube.org/display/SONAR/Documentation)；[https://github.com/SonarSource/sonar](https://github.com/SonarSource/sonar)

声纳使用 JaCoCo。

一旦在用户 setting.xml 中配置了声纳（您的团队应该共享）

```
<!-- http://docs.codehaus.org/display/SONAR/Installing+and+Configuring+Maven -->
<profile>
    <id>sonar</id>
    <activation>
        <activeByDefault>true</activeByDefault>
    </activation>
    <properties>
        <!-- FOR MYSQL -->
        <sonar.jdbc.url>
          jdbc:mysql://sonarserver:3306/sonar?useUnicode=true&amp;characterEncoding=utf8
        </sonar.jdbc.url>
        <sonar.jdbc.driverClassName>com.mysql.jdbc.Driver</sonar.jdbc.driverClassName>
        <sonar.jdbc.username>sonar</sonar.jdbc.username>
        <sonar.jdbc.password>sonar</sonar.jdbc.password>

        <!-- optional URL to server. Default value is http://localhost:9000 -->
        <sonar.host.url>
          http://sonarserver:9000
        </sonar.host.url>
    </properties>
</profile> 
```

用于`mvn sonar:sonar`分析任何项目。

[在https://analysis.apache.org/](https://analysis.apache.org/)运行声纳实例

Jenkins有[Sonar 插件](https://wiki.jenkins-ci.org/display/JENKINS/Sonar+plugin)，所以以后所有的分析都应该在 Jenkins 服务器上运行。

# javascript - 尝试删除/销毁用户时的奇怪行为

> ID：14715202
> 
> 赞同：0
> 
> 时间：2013-02-05T19:19:41.073
> 
> 标签：javascript, jquery, ruby-on-rails

当我尝试从 Rails 的项目中删除用户时，我遇到了一些奇怪的行为。

简而言之，我的视图中有一个链接，允许管理员用户删除另一个用户：

```
<%= link_to 'Delete User', user, :method => :delete, :confirm => "Are you sure?" %> 
```

这是我的用户控制器中的代码：

```
# DELETE /users/1
# DELETE /users/1.json
def destroy
  @user = User.find(params[:id])
  @user.destroy

  respond_to do |format|
    format.html { redirect_to users_url }
     format.json { head :no_content }
  end
end 
```

但是，当用户被删除时，弹出“您确定吗？” 框出现两次，然后出现以下错误：

```
ActiveRecord::RecordNotFound in UsersController#destroy
Couldn't find User with id=xxx 
```

其中“xxx”是刚刚删除的用户 ID。

做了一些搜索，有人建议这与我的项目中加载 JavaScript 的方式有关，并且可能与 jQuery 冲突（我正在使用`jquery-rails`gem）。但是，我的`application.html.erb`文件似乎很好：

```
<%= stylesheet_link_tag    "application","http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/themes/smoothness/jquery-ui.css" %>

<%= stylesheet_link_tag    "application", :media => "all" %>
<%= javascript_include_tag "application" %>
<%= csrf_meta_tags %> 
```

我的 application.js 文件也是如此：

```
//= require jquery
//= require jquery_ujs
//= require jquery-ui
//= require_tree . 
```

所以，我不确定为什么会这样——这是我第一次遇到这个错误。

有人愿意为我指出正确的方向吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:28:26.497

您可能有一个库加载 jQuery 两次。以前发生在我身上，我认为当时是 ActiveAdmin 具有不同的 jQuery 依赖项，因此 jQuery 加载了两次并将所有调用加倍。

您的用户错误是因为该用户已被删除，所以第二次找不到它。

# android - 如何访问Android图像资源（Eclipse）

> ID：14715205
> 
> 赞同：2
> 
> 时间：2013-02-05T19:19:53.727
> 
> 标签：android, android-resources

我正在为 Android 编写纸牌游戏，所以我有 40 张纸牌图像，有 4 种不同的密度，分布在 res/drawable-ldpi、hdpi、mdpi 和 xhdpi 中。

我已经在其成员中定义了我的 Card 类，其中包含一个 Rect 区域，我将为每张卡片打印不同的图像。代码是：

```
package Maze;

import android.R;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Rect;

public class Card {
    private CardNumber number;
    private CardSuit suit;
    private Rect region;
    private boolean visible;
    private Bitmap bitmap;
    private Bitmap backsideImg;

    public Card(CardNumber number, CardSuit suit){
        this.number = number;
        this.suit = suit;
        this.visible = false;
        region = new Rect();
        setBitmap();
    }

    private void setBitmap(){
        backsideImg = BitmapFactory.decodeFile(R.drawable.reverse);
        if(suit==CardSuit.HEARTS){
            switch(number){
            case ONE:
                bitmap = BitmapFactory.decodeFile(R.drawable.onehearts); // For onehearts.png file
                break;
            case TWO:
                bitmap = BitmapFactory.decodeFile(R.drawable.twohearts); // For twohearts.png file
                break;
            case THREE:
                bitmap = BitmapFactory.decodeFile(R.drawable.threehearts);
                break;
            case CUATRO:
                bitmap = BitmapFactory.decodeFile(R.drawable.fourhearts);
                break;
            // And so on...

            }
        }

    }

    public void draw(Canvas c, int x, int y){
        region.left = x;
        region.top = y;
        region.right = x + 80;
        region.bottom = y + 115;

        if(visible) c.drawBitmap(bitmap, x, y, null);
        else c.drawBitmap(backsideImg, x, y, null);

    }
} 
```

但它没有找到资源。例如，它说“1hearts 无法解决或不是一个字段”。我想我错过了一些步骤，我只是将图像拖放到资源文件夹中。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:23:02.687

将文件名重命名为以字母开头。自动生成的`R.drawable`字段名称与您的文件名相同，但必须是有效的 Java 标识符。

**编辑：**

另外，请检查您是否包含正确的`R`课程。您可能希望使用 的完整内容更新您的问题`Card.java`，而不仅仅是课程代码。

**编辑2：**

正如我所怀疑的，您正在导入`android.R`系统资源类。您应该改用`R`从您的资源生成的类。鉴于您的包名称，我希望它是`Maze.R`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:55:43.637

您需要使用 decodeResource 而不是 decodeFile

就像是：

```
Bitmap bm = BitmapFactory.decodeResource(getResources(), R.drawable.oneOfHearts); 
```

# c# - FTP over SSL 问题

> ID：14715210
> 
> 赞同：2
> 
> 时间：2013-02-05T19:20:03.397
> 
> 标签：c#, ssl, ftp

我在通过 SSL 将文件上传到 ftp 站点到特定目录时遇到问题。我正在`System.Net.FtpWebRequest` `class`为此目的使用。上传顺利。但该文件总是下降到主目录。知道可能做错了什么吗？感谢你的帮助。

```
 public bool UploadFile(string srcFilePath, string destFilePath = null)
    {
        if (String.IsNullOrWhiteSpace(srcFilePath))
            throw new ArgumentNullException("Source FilePath.");

        if (String.IsNullOrWhiteSpace(destFilePath))
            destFilePath = Path.GetFileName(srcFilePath);

        Uri serverUri = GetUri(destFilePath);

        //// the serverUri should start with the ftp:// scheme.
        if (serverUri.Scheme != Uri.UriSchemeFtp)
            return false;

        // get the object used to communicate with the server.
        FtpWebRequest request = CreateFtpRequest(serverUri, WebRequestMethods.Ftp.UploadFile);

        // read file into byte array
        StreamReader sourceStream = new StreamReader(srcFilePath);
        byte[] fileContents = Encoding.UTF8.GetBytes(sourceStream.ReadToEnd());
        sourceStream.Close();
        request.ContentLength = fileContents.Length;

        // send bytes to server
        Stream requestStream = request.GetRequestStream();
        requestStream.Write(fileContents, 0, fileContents.Length);
        requestStream.Close();

        FtpWebResponse response = (FtpWebResponse)request.GetResponse();
        Debug.WriteLine("Response status: {0} - {1}", response.StatusCode, response.StatusDescription);

        return true;
    }

    private FtpWebRequest CreateFtpRequest(Uri serverUri, string method)
    {
        FtpWebRequest request = (FtpWebRequest)WebRequest.Create(serverUri);
        request.EnableSsl = true;
        request.UsePassive = true;
        request.UseBinary = true;
        request.KeepAlive = true;
        request.Credentials = new NetworkCredential(_userName, _password);
        request.Method = method;
        return request;
    }

    private Uri GetUri(string remoteFilePath)
    {
        return new Uri(_baseUri, remoteFilePath);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T16:09:01.023

好的。终于想通了。这是 .NET 4.0 框架问题。使用 .NET 3.5 构建解决方案，效果很好。

讨厌在 Microsoft 的新版本 .NET 中看到错误，并浪费大量时间来解决问题。

# java - JVM JIT 是否优化了几乎相等的新对象的创建？

> ID：14715216
> 
> 赞同：2
> 
> 时间：2013-02-05T19:20:18.743
> 
> 标签：java, jit, functional-java

我正在阅读函数式 Java 库的源代码并注意到这一点：

```
public static <T> Option<T> none() {
    return new None<T>();
} 
```

我想知道为什么他们不总是返回一个单例参数，特别是因为 None 的相等实现：

```
private static final class None<A> extends Option<A> { 

...

@Override
public int hashCode() {
    return 31;
}

@Override
public boolean equals(Object obj) {
   if (this == obj)
      return true;
   if (obj == null)
      return false;
   if (getClass() != obj.getClass())
      return false;
   return true;
}

} 
```

所以我在 Functional Java 的论坛上进行了搜索，我发现了这个问题和答案：

> 是否可以将其设置为不会为每次调用 none 创建一个新的 None ，我们可以在所有情况下使用单个对象来表示 None 吗？
> 
> 不，但是，谁在乎呢？如今，JIT 优化器可以很好地处理这些事情。

我的问题是 JIT 优化器如何以不需要返回单例的方式处理这个问题。我知道对象创建很便宜，但我认为单例会更便宜，在这种情况下它不会增加任何复杂性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:37:04.523

不，我知道的 Java VM 不执行此类优化。使用现代 JVM，创建新对象实际上比寻找现有对象更便宜。他们在这个常见问题解答中的意思是短暂的、被丢弃的对象并不会真正影响垃圾收集时间（但可能会增加 GC 频率）。我也可以想象 JVM 执行逃逸分析并将此类对象分配到堆栈上而不是堆上。

不过我*觉得*挺浪费的。查看`java.lang.Integer`（和所有其他原始包装器）缓存或[`Optional.absent()`Guava](http://grepcode.com/file/repo1.maven.org/maven2/com.google.guava/guava/13.0.1/com/google/common/base/Optional.java#Optional.absent%28%29)：

```
public static <T> Optional<T> absent() {
  return (Optional<T>) Absent.INSTANCE;
} 
```

在 JDK 中还有很多类似的优化：`enum`s 是单例，[`Collections.emptyList()`](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/util/Collections.java#Collections.emptyList%28%29)总是返回相同的实例，等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T20:59:04.007

它更安全，否则我们需要依赖擦除。

创建一个对象可能仍然比查找一个缓存的对象更昂贵。参见 java8 的可选：

[http://hg.openjdk.java.net/lambda/lambda/jdk/file/ad394630273b/src/share/classes/java/util/Optional.java](http://hg.openjdk.java.net/lambda/lambda/jdk/file/ad394630273b/src/share/classes/java/util/Optional.java)

```
 43     private final static Optional<?> EMPTY = new Optional<>();

   63      * There is no guarantee that it is a singleton.

   69     @SuppressWarnings("unchecked")
   70     public static<T> Optional<T> empty() {
   71         return (Optional<T>) EMPTY;
   72     } 
```

# c# - 正则表达式解析 "a=1,b=2,c=3,4,5,d=6,e=x,y,z"

> ID：14715218
> 
> 赞同：3
> 
> 时间：2013-02-05T19:20:21.913
> 
> 标签：c#, regex

如何使用正则表达式拆分（或匹配）此字符串：

```
a=1,b=2,c=3,4,5,d=6,e=x,y,z 
```

基本形式是`name=value,name=value`value 可以包含逗号并且 name 始终是字母数字。

我试图结束：

```
a=1
b=2
c=3,4,5
d=6
e=x,y,z 
```

我的第一个想法是语法不明确，因为值包含逗号，但我认为它应该是可行的，因为 name 不包含`=`.

这很接近，但将尾随逗号与每个值匹配，并且与 final 不匹配`z`：

```
(?<name>\w+)
\s*=\s*
(?<value>
\S
   (?:
      ,
      |
      .[^=]         
    )*
) 
```

产生这些匹配：

```
a=1,
b=2,
c=3,4,5,  
d=6,
e=x,y, 
```

这里有任何正则表达式向导吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:27:35.447

您可以使用*前瞻断言*`comma`拆分其后跟一个`alphabet`and then 。您可以使用以下正则表达式进行拆分：-`=`

 *```
",(?=[a-zA-Z0-9]=)"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:25:42.980

在您的最终匹配中，`,|.[^=]`使用`.[^=]`表示任何字符后跟一个非字符的字符`=`。然而，`z`紧随其后的是什么都没有。相反，您应该将其设为任何字符，后跟非`=`OR 字符串的结尾：

```
,
|
.(?:[^=]|$) 
```

我已经确认这可以使用 php 的`preg_match_all`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:54:46.133

如果你的正则表达式引擎支持[前瞻断言](http://www.regular-expressions.info/lookaround.html)，你可以试试这个：

```
(\w)=(\w(,\w(?!=))*) 
```

注意：我曾经`\w`使它更短。如果您只想匹配字母数字字符，请替换`\w`而不是`[a-zA-Z0-9]`

在正则表达式上成功[运行](http://regexpal.com/?flags=g&regex=%5Cw=%28%5Cw%28,%5Cw%28?!=%29%29%2a%29&input=a=1,b=2,c=3,4,5,d=6,e=x,y,z,d=4,4,3)

编辑：被 Rohit Jain 破坏*

# python - 在 python 3.3 中将字符串写入文件失败

> ID：14715219
> 
> 赞同：0
> 
> 时间：2013-02-05T19:20:25.017
> 
> 标签：python, regex, python-3.x, file-io, python-requests

我正在使用此 python 代码从给定文件 (source_file.txt) 中提取电子邮件地址，并将这些电子邮件地址写入单独的文件中。（我正在使用 python 3.3）

```
import urllib.request
import re
import fileinput, glob, string, sys, os
from os.path import join
import os

filePath = "source_file.txt"

if not filePath:
    print("Sorry! Source File could not be located!")
else:
    page = open(filePath, "r")
    pageContent = page.read()
    page.close()

style_normal = re.compile("[-a-zA-Z0-9._]+@[-a-zA-Z0-9_]+.[a-zA-Z0-9_.]+")
style_text_one = re.compile('[-a-zA-Z0-9._]+\s+at\s+[-a-zA-Z0-9_]+\s+dot\s+[a-zA-Z0-9_.]+')
style_text_two = re.compile('[-a-zA-Z0-9._]+\(at\)[-a-zA-Z0-9_]+\(dot\)[a-zA-Z0-9_.]+')

style_normal_list = style_normal.findall(str(pageContent))
style_text_one_list = style_text_one.findall(str(pageContent))
style_text_two_list = style_text_two.findall(str(pageContent))

f = open('emails_file.txt', 'a')
f.write('testing')

for item in style_normal_list:
    print("%s" %item)
    f.write("%s" %item)
for item in style_text_one_list:
    text_one = item.replace(' at ','@')
    text_two = text_one.replace(' dot ','.')
    print(text_two)
    f.write(text_two)

for item in style_text_two_list:
    text_one = item.replace('(at)','@')
    text_two = text_one.replace('(dot)','.')
    f.write(text_two) 
```

问题是当我运行这个文件时，文件被创建，但文件中没有写入任何内容。甚至没有文字“测试”。文件已创建，但为空白。

我已经使用打印语句来检查代码的其他部分是否正常工作。根据[python doc](http://docs.python.org/3.3/tutorial/inputoutput.html)，语法是正确的。你们中的任何人都可以指出我在这段代码中犯的任何错误吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:23:36.437

当您调用`write`文件时，数据实际上并没有立即写入磁盘，而是存储在缓冲区中。每隔一段时间，缓冲区就会被刷新。如果你想控制它，你可以显式调用`flush`，但通常最好不要——当你`close`文件时，它会自动刷新。

但是你必须要`close`这个文件才能工作。当文件对象被删除时，它会自行关闭，但您不能依赖文件对象在任何特定时间甚至永远被删除。（您可以了解它在 CPython 2.7、CPython 3.3、IronPython 等中如何工作的详细信息，以及 CPython 3.3 在 Unix 和 Windows 上如何以不同方式处理退出等等，但您仍然不想依赖这些细节。）

因此，如果您`f.close()`在代码末尾添加一个显式，那*几乎*可以解决问题……但不能完全解决。如果其他行引发异常怎么办？然后它永远不会`close()`接听电话。

`try`你可以用/解决这个问题`finally`，但有一个更好的方法，`with`语句：

```
with open('emails_file.txt', 'a') as f:    
    f.write('testing')
    # ...
    for item in style_text_two_list:
        text_one = item.replace('(at)','@')
        text_two = text_one.replace('(dot)','.')
        f.write(text_two) 
```

这保证了一旦你到达缩进`with`块的末尾——即使发生这种情况是因为异常，或者退出程序（或者`return`从函数中，如果你在一个函数中，或者`break`从循环中，如果你在一个循环等），`f`将被关闭。

这在官方教程[的文件对象方法中](http://docs.python.org/3/tutorial/inputoutput.html#methods-of-file-objects)都有解释，但是看看它是如何解释的，我可以想象很多新程序员不会从所写的内容中得到任何东西。只有当您已经了解它的作用时，该[`with statement`](http://docs.python.org/3/reference/compound_stmts.html#with)文档才真正有意义，并且对于有关缓冲文件对象的解释也是如此…… [PEP 343](http://www.python.org/dev/peps/pep-0343/)，它介绍了该`with`语句要好一些，但它花费了尽可能多的时间来谈论关于该功能为何有用的两个先前相关的 PEP。因此，我想许多开发人员对此一无所知是可以理解的。

# php - 另一个 mysqli_fetch_assoc 循环内的 mysqli_fetch_assoc 循环

> ID：14715222
> 
> 赞同：0
> 
> 时间：2013-02-05T19:20:38.197
> 
> 标签：php, mysql, nested-loops

我已经在互联网上搜索了一段时间试图找到这个答案，但也许我的搜索主题不正确。我有一个 SQL 查询，它将两个表中的数据返回到组合结果集中。我想遍历并找到每个“部分”并将其打印出来，在每个“部分”下面我想打印出与该部分相关的事件。我基本上有一个父循环来查找“部分”，并在父循环内有一个子循环来搜索事件。我的代码如下。

谁能解释为什么父循环只迭代 1 次然后停止？我一定会很感激的！

```
while ($row = mysqli_fetch_assoc($result)) {
  if($row['ID'] != "") {
      echo '<h3 class="classTlt">'.$row['sTitle'].'</h3>';
      echo $row['sDesc']; 
      $table = '<table cellpadding="0" cellspacing="0" width="100%" border="0">
                  <tr>';
      for($i=1;$i<=6;$i++) {
         if($row['sH'.$i] != null) {
           $table .= '<th>'.$row['sH'.$i].'</th>';
         }
      }
      $table .= '</tr>';
      while ($row2 = mysqli_fetch_assoc($result)) {
        if($row2['sID'] == $row['ID']) {
          $table .= '<tr>';
          for($x=1;$x<=6;$x++) {
             if($row2['sV'.$x] != null) {
                 $table .= '<td valign="top">'.$row2['sV'.$x].'</td>';
             }//end if
          }//end for
          $table .= '</tr>';
        }//end if
      }//end while
      $table .= '</table>';
      echo $table; 
  }//end if
}//end while 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:23:21.333

您在内部循环中将结果集排干。

如果您的结果有 10 行，则外部 while 提取 1，内部提取其他 9 行，外部不再提取任何内容。

编辑：关于评论：

```
$someArray = array();
while ($row = mysqli_fetch_assoc($result)) {
  $someArray[] = $row;
}

for ($i = 0; $i < count($someArray); ++$i) {
  // some stuff

  for($j = 0; $j < count($someArray); ++$j) {
    // some more stuff
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:25:03.817

内部`while`循环命中相同的`$result`变量，因此耗尽了可用的行进行迭代。

您最好有两个查询：

```
 while ($row = mysqli_fetch_assoc($result)) {
       // some logic / display code

       $result2 = ... // sql query w/ section data

       while ($row2 = mysqli_fetch_assoc($result2)) {
          // more logic / display code
       }
    } 
```

# ios - 为什么我的代码仅在发布时和升级到 Xcode 4.6 后才会崩溃？

> ID：14715223
> 
> 赞同：0
> 
> 时间：2013-02-05T19:20:39.320
> 
> 标签：ios, objective-c, xcode4.6

由于释放了对正在执行的块的引用的变量，我遇到了崩溃。这是代码示例：

这是现在发布的问题，在同一设备上的调试运行正常，它必须作为附加运行才能崩溃。

```
- (void)test {
    _test = [self doLater:^{
      _count++;
       [self test];
   } :3];
} 
```

这是在 NSObject 类别中定义的：

```
- (DoLaterProcess *)doLater:(void (^)())method :(double)delay {
    return [[DoLaterProcess new] from:method :delay];
} 
```

使用类的结束实现：

```
@implementation DoLaterProcess {
    id _method;
    BOOL _stop;
}

- (void)methodToPerform:(void (^)())methodToInvoke {
    if (_stop)return;
    if (NSThread.isMainThread) methodToInvoke();
    else [self performSelectorOnMainThread:@selector(methodToPerform:)      withObject:methodToInvoke waitUntilDone:NO];
}

- (DoLaterProcess *)from:(void (^)())method:(NSTimeInterval)delay {
    [self performSelector:@selector(methodToPerform:) withObject:method afterDelay:delay];
    _method = method;
    return self;
}

- (void)stop {
    _stop = YES;
    [NSObject cancelPreviousPerformRequestsWithTarget:self     selector:@selector(methodToPerform:) object:_method];
}

@end 
```

所以我知道 _test 变量被释放，然后可能在它被释放时也被阻塞？这就是它崩溃的原因吗？但是为什么它不会在调试中崩溃，我可以强制编译器在调试中也崩溃吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:10:00.447

块捕获本地状态。在您的情况下，该块正在捕获`_count`和`self`. 为了有效地做到这一点，当您创建一个块时，它最初存在于堆栈中，其效果是只要该方法不返回，就可以安全地使用它。因此，您可以向下传递块，但不能保留它们或向上传递它们而不将它们移动到堆中。`copy`您可以通过ing 来实现这一点（并且`copy`被定义为`retain`好像该块已经在堆上，因此您无需为过度复制付费）。

在您的情况下，正确的做法是`doLater::`复制块（尽管，为了记录，未命名的参数被认为是*非常糟糕的做法*）。

我有点困惑为什么你们都将方法分配给实例变量并安排它以供以后传递它，但最快的解决方法是：

```
- (DoLaterProcess *)from:(void (^)())method:(NSTimeInterval)delay {
    method = [method copy];
    [self performSelector:@selector(methodToPerform:) withObject:method afterDelay:delay];
    _method = method;
    return self;
} 
```

至于为什么这似乎已在 4.6 下被破坏：您依赖于未记录的行为（尽管感觉应该是自然的未记录的行为），因此允许工具集或操作系统的任何更改（或者实际上，没有任何更改）影响.

（此外：您似乎还重新实现了 GCD 中内置的许多内容；您可以直接替换`from::`with`dispatch_after`和`methodToPerform:`with `dispatch_async`，在这两种情况下都`dispatch_get_main_queue()`作为队列提供）。

# phpmyadmin - 通过 phpMyAdmin 生成 .doc 文件

> ID：14715224
> 
> 赞同：0
> 
> 时间：2013-02-05T19:20:39.963
> 
> 标签：phpmyadmin

我注意到 phpMyAdmin 具有自动生成 CSV、Microsoft Word、SQL 等的功能。

是否可以在使用此功能的网页上创建链接。从而避免用户进入管理 phpMyAdmin 面板的需要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:28:24.167

您真的不想让任何用户访问您的 phpMyAdmin UI。有太多恶意的事情可以做。更好： php 中有许多库可以帮助您做到这一点。

PHP-Excel 库：[http ://code.google.com/p/php-excel/](http://code.google.com/p/php-excel/)

php字库：[http ://www.phpdocx.com/](http://www.phpdocx.com/)

核心 php 本身中的 csv 函数是大量的，加上大量的库来帮助您使用 .csv 进行各种操作

希望有帮助

# jsf-2 - MethodExpression IllegalArgumentException：参数数量错误

> ID：14715225
> 
> 赞同：1
> 
> 时间：2013-02-05T19:20:40.500
> 
> 标签：jsf-2

我有一个动态呈现的 JSF 页面——所有组件都由支持 bean 创建并添加到网格中。我有一个命令按钮，我创建了一个 MethodExpression 来设置单击按钮时要调用的方法。但是单击该按钮会导致异常“java.lang.IllegalArgumentException：参数数量错误”和“javax.faces.FacesException：参数数量错误”。

创建按钮的代码是

```
HtmlCommandButton addBtn1 = (HtmlCommandButton) FacesContext.getCurrentInstance().
getApplication().createComponent(HtmlCommandButton.COMPONENT_TYPE);
addBtn1.setId("addBtn1");
addBtn1.setValue("Add Row");
String addBtn1Action = "#{dynamicComponentTest.addBtn1_action}";
Class[] args = new Class[]{ActionEvent.class};
MethodExpression addBtn1ME = FacesContext.getCurrentInstance().getApplication().
getExpressionFactory().createMethodExpression(
FacesContext.getCurrentInstance().getELContext(), addBtn1Action, null, args);
addBtn1.setActionExpression(addBtn1ME);
mainGrid.getChildren().add(addBtn1); 
```

那么动作方法的签名是

```
public String addBtn1_action(ActionEvent event) 
```

当我运行我的测试应用程序并单击按钮时，我得到了异常。但是，如果我将签名更改为

```
public String addBtn1_action(ActionEvent[] event) 
```

我得到一个 MethodNotFoundException，它找不到“...DynamicComponentTest@1db3b45.addBtn1_action(javax.faces.event.ActionEvent)”

有没有人成功解决了这个问题？我已经尝试将 null 和 String.class 作为 createMethodExpression 中返回值的类型，但这无助于解决它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:39:04.443

动作方法不应该有参数。`ActionEvent`参数为`actionListeners`. 因此，删除该参数，并`createMethodExpression`根据该参数更改调用。此外，您的操作方法的返回类型是`String`. 第三个参数`createMethodExpression`是返回类型。你应该`String.class`把`null`. 最后：

```
FacesContext.getCurrentInstance().getApplication().getExpressionFactory().
        createMethodExpression(
        FacesContext.getCurrentInstance().getELContext(),
          addBtn1Action, String.class, new Class[0]); 
```

和动作方法签名：

```
public String addBtn1_action() {
    // ...
} 
```

# php - 获取从url上传的图片数据

> ID：14715227
> 
> 赞同：0
> 
> 时间：2013-02-05T19:20:44.280
> 
> 标签：php

我正在尝试编写一个表单，用户可以在其中从 url 上传图像。我知道如何使用 fopen 和 fwrite 上传图像，但我不知道如何在文件实际上传之前获取/检查有关文件的其他信息，例如文件大小、mime 类型、文件扩展名等。这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:55:21.000

至少有两种方法，但最简单的方法是[getimagesize()](http://www.php.net/getimagesize)

```
$info = getimagesize( 'image.png' );
print_r( $info ); 
```

pathinfo() 不会给你 MIME 类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:47:35.843

Pathinfo 应该为您解决问题。[http://php.net/manual/en/function.pathinfo.php](http://php.net/manual/en/function.pathinfo.php)

# django - 是否可以对两个字段的总和应用查询集方法

> ID：14715245
> 
> 赞同：0
> 
> 时间：2013-02-05T19:21:39.547
> 
> 标签：django

我在模型上有一个`price`字段和一个`shipping`字段。

我需要添加两者的值并将它们用作`Q`对象查询的一部分。理想情况下，类似：

```
if '1' in selected_prices:
  query |= Q(price_and_shipping__range=(1, 1000))

if '2' in selected_prices:
  query |= Q(price_and_shipping__range=(1001, 2000)) 
```

我知道我不能只创建一个`price_and_shipping`属性并使用它，但是有什么替代方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:15:11.027

找到了一种使用 F() 表达式解决此问题的好方法

```
if '1' in selected_prices:
  query |= Q(price__gte=1 - F('shipping'), price__lte=1000 - F('shipping'))

if '2' in selected_prices:
  query |= Q(price__gte=1001 - F('shipping'), price__lte=2000 - F('shipping')) 
```

使用类似问题的答案解决了这个问题：[https ://stackoverflow.com/a/10664491/152653](https://stackoverflow.com/a/10664491/152653)

更多关于 F() 表达式：[https ://docs.djangoproject.com/en/dev/topics/db/queries/#query-expressions](https://docs.djangoproject.com/en/dev/topics/db/queries/#query-expressions)

# expect - 在期望脚本中转义密码变量

> ID：14715246
> 
> 赞同：1
> 
> 时间：2013-02-05T19:21:41.553
> 
> 标签：expect

**背景**：我正在尝试编写一个用于测试特殊字符密码的期望脚本。我无法执行的测试用例之一是密码前有特殊字符“-”。例如：“-foo” 注意：假设 ssh 密钥不在问题范围内 注意：假设 bash shell 是我正在使用的 shell

**我的代码**：这是我的连接功能，由维基百科提供：

```
 proc connect {passwd} {
      expect {
        "yes/no" {
          send "yes\r"
        }
      }
      expect {
        "?assword:" {
            send "$passwd\r"
            expect {
              "sftp*" {
                return 0
              }
            }
        }
      }
      # timed out
      return 1

}

set user [lindex $argv 0]
set passwd [lindex $argv 1]
set host [lindex $argv 2]

spawn sftp $user@$host

puts '$passwd'\r
set rez [connect $passwd] 
```

在我的 bash 脚本中，我有：

```
passwd="-foo"
./sftp_test $user $passwd $host 
```

**我已经尝试过**：据我了解，问题是shell正在扩展变量，因此命令被解释为send -foo，它说send的密码无效。

我尝试使用单引号作为解决此问题的一般解决方案，但密码被拒绝（我怀疑单引号被保留）。发送'$passwd'"\r"

**问题**：有没有办法让我在发送命令中转义密码，以便我可以将它用于密码中特殊字符的所有排列（例如 $foo 和 f$oo 和 -foo）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-19T19:19:54.517

如果要转义的字符是 $ 怎么办

我需要发送以下命令，但期望一直将其视为变量：

```
 W $$RBLDSTS^VPRJ() 
```

所以当我使用：

```
 send "W $$RBLDSTS^VPRJ()\r"; 
```

我得到：

```
 can't read "RBLDSTS": no such variable 
```

在这种情况下，我必须将我的命令分配给一个变量并用 \ 转义 $

```
 set command \$\$RBLDSTS^VPRJ()
    send "W $command\r"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T22:58:34.080

你需要做的是：

```
send -- "$passwd\r" 
```

`--`表示后面任何以破折号开头的单词都不会*被*视为发送命令的选项。

您可能希望养成这种习惯，并为每个发送命令执行此操作。

# java - 简单的 SpringMVC 3 登录不起作用

> ID：14715248
> 
> 赞同：0
> 
> 时间：2013-02-05T19:21:47.607
> 
> 标签：java, xml, spring-mvc

我正在尝试通过注释在 Spring MVC 3.0 中制作一个简单的登录网页。处理了几个小时后，我无法运行它。我相信问题出在调度程序上，但我尝试了很多东西但没有成功......我将发布一些代码：

LoginView.jsp（仅显示表单）

```
<form:form method="post" action="doLogin" commandName="login" modelAttribute="login">
        <p> <form:input path="username"/> </p>
        <p> <form:input path="password"/> </p>
        <p class="submit"><input type="submit" name="commit" value="Login"></p>
</form:form> 
```

Login.java 非常简单，因为它只包含用户名和密码属性以及它们的 setter/getter。

登录控制器.java

```
@Controller
@RequestMapping("doLogin")
public class LoginController {

    @RequestMapping(method = RequestMethod.GET)
    public String showForm(Map model) {
        Login login = new Login();
        model.put("login", login);
        return "LoginView";
    }

    @RequestMapping(method = RequestMethod.POST)
    public String processForm(Login login, BindingResult result, Map model) {
        String userName = "Admin";
        String password = "root";
        if (result.hasErrors()) {
            return "login";
        }
        login = (Login) model.get("login");
        if (!login.getUsername().equals(userName) || !login.getPassword().equals(password)) {
            return "loginerror";
        }
        model.put("login", login);
        return "loginsuccess";
    }
} 
```

调度程序-servlet.xml

```
<mvc:annotation-driven />

    <context:component-scan base-package="spring.blog.src"/>  

    <bean class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping"/>
    <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping"/>
    <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter"/>

    <bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="LoginView.htm">indexController</prop>
            </props>
        </property>
    </bean>

    <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="prefix">
            <value>/WEB-INF/jsp/</value>
        </property>
        <property name="suffix">
            <value>.jsp</value>
        </property>
    </bean>

    <bean name="indexController" class="org.springframework.web.servlet.mvc.ParameterizableViewController">
        <property name="viewName">
            <value>LoginView</value>
        </property>
    </bean> 
```

我知道这里有问题，但不知道到底是什么...... Tomcat抛出的错误是（对不起，有些行是西班牙语......）

```
org.apache.jasper.JasperException: Ha sucedido una excepción al procesar la página JSP /WEB-INF/jsp/LoginView.jsp en línea 26

24:       <form:form method="post" action="doLogin" commandName="login">
25:         <!-- <p><input type="text" name="login" value="" placeholder="Username or Email"></p> -->
26:         <p> <form:input path="username"/> </p>
27:         <!-- <p><input type="password" name="password" value="" placeholder="Password"></p> -->
28:         <p> <form:input path="password"/> </p>
29:         <p class="remember_me">

Stacktrace:
    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:521)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:424)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:313)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:260)

causa raíz

java.lang.IllegalStateException: Neither BindingResult nor plain target object for bean name 'login' available as request attribute
    org.springframework.web.servlet.support.BindStatus.<init>(BindStatus.java:141)
    org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getBindStatus(AbstractDataBoundFormElementTag.java:178)
    org.springframework.web.servlet.tags.form.AbstractDataBoundFormElementTag.getPropertyPath(AbstractDataBoundFormElementTag.java:198) 
```

我会感谢任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:31:59.020

您的方法签名应如下所示。签名需要 @ModelAttribute 注释。该模型不需要作为签名的一部分。

```
@RequestMapping(method = RequestMethod.POST)
public String processForm(@ModelAttribute Login login, BindingResult result) {
    String userName = "Admin";
    String password = "root";
    if (result.hasErrors()) {
        return "login";
    }
    if (!login.getUsername().equals(userName) || !login.getPassword().equals(password)) {
        return "loginerror";
    }
    return "loginsuccess";
} 
```

此外，您的 jsp 只需要命令名称属性，而不需要 form:form 标记上的 modelAttribute。

```
<form:form method="post" action="doLogin" commandName="login"> 
```

# security - 为单个页面上的多个表单生成 CSRF 令牌

> ID：14715250
> 
> 赞同：13
> 
> 时间：2013-02-05T19:21:52.650
> 
> 标签：security, csrf

我目前正在`CSRF`我的表单中生成一个令牌以防止跨站点请求伪造。看起来像：

```
<form method="post" action="action.php">
   <input type="hidden" id="security_token" name="security_token" value="gTt96phAcretR99rafEjepHebrEZadEdezadagaZ3gAS5es33WReJeZaMADU2AWr" />
   ...
</form> 
```

问题是我在一个页面上有多个表单。我必须为每个表单创建一个安全令牌吗`security_token_1`，`security_token_2`或者我可以简单地而不是在表单内部生成安全令牌，而是将其附加到整个`body`标签的属性中，例如：

```
<body data-csrf-token="gTt96phAcretR99rafEjepHebrEZadEdezadagaZ3gAS5es33WReJeZaMADU2AWr">
...
</body> 
```

这在任何方面都不安全吗？它简化了很多事情，因为我可以简单地将安全令牌附加到正文元素，而不是处理多个安全令牌。

感谢您的洞察力和评论。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-05T19:30:30.637

确实没有任何理由不能为两种表单生成相同的令牌，每个表单中的每个隐藏字段都具有相同的`name`属性。

毕竟，您真正要验证的是表单请求是来自具有有效会话的用户的入站请求，并且一次只会主动发布一个表单。因此，您将发布的令牌与存储在用户会话中的令牌进行比较。为了做到这一点，不需要多个令牌值。

对于您需要根据 AJAX 帖子更新令牌的情况，您需要做的是，正如您所说，将新创建的令牌传回 AJAX 响应中，然后将隐藏字段值更新为新令牌值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:31:25.070

只要您确保攻击者无法获得 CSRF 令牌（例如，不要将其包含在发送给第三方的表单中），使用单个 CSRF 令牌应该是可以的。请注意，使用您的“将其放入正文”方法，您将需要 JavaScript 来提交表单，因此即使您只使用一个中央标记，您可能仍希望将其插入到每个表单中。

[OWASP 指南](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#Prevention_Measures_That_Do_NOT_Work)说：

> 通常，开发人员只需为当前会话生成一次此令牌。在初始生成此令牌后，该值将存储在会话中，并用于每个后续请求，直到会话到期。

即根本不需要使用多个令牌。

使用单独的令牌的好处是，如果您以某种方式设法破坏了其中的一些，但不是全部（几乎不可能，因为例如 XSS 会破坏所有令牌），攻击者的选择将受到限制。

# python - python pandas：在包含多个用户的DataFrame中按用户区分

> ID：14715255
> 
> 赞同：1
> 
> 时间：2013-02-05T19:22:12.073
> 
> 标签：python, pandas

我有一个 pandas DataFrame，其中包含来自多个用户的时间戳事件。默认情况下，DataFrame 按时间戳排序。

```
uid timestamp other_vars
  1       100        ...
  1       150        ...
  2       150        ...
  2       200        ...
  1       225        ...
  3       300        ...
  3       400        ... 
```

我想得到*users*中时间戳的差异。也就是说，对于每个事件，我想获取自同一用户生成的上一个事件以来经过的时间。

```
uid timestamp diff other_vars
  1       100   NA        ...
  1       150   50        ...
  2       150   NA        ...
  2       200   50        ...
  1       225   75        ...
  3       300   NA        ...
  3       400  100        ... 
```

有没有一种干净的方法可以在熊猫中做到这一点，理想情况下不按用户排序？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:33:54.720

如评论中所述，您可以使用`groupby`. 我会`groupby`，然后`diff`。 `groupby`将（不出所料）对行进行分组：

```
>>> df
   uid  timestamp other_vars
0    1        100        ...
1    1        150        ...
2    2        150        ...
3    2        200        ...
4    1        225        ...
5    3        300        ...
6    3        400        ...
>>> for name, gr in df.groupby("uid"):
...     print name
...     print gr
...     
1
   uid  timestamp other_vars
0    1        100        ...
1    1        150        ...
4    1        225        ...
2
   uid  timestamp other_vars
2    2        150        ...
3    2        200        ...
3
   uid  timestamp other_vars
5    3        300        ...
6    3        400        ... 
```

然后我们在这些组中选择我们感兴趣的列，然后`diff`它：

```
>>> df["diff"] = df.groupby("uid")["timestamp"].diff()
>>> df
   uid  timestamp other_vars  diff
0    1        100        ...   NaN
1    1        150        ...    50
2    2        150        ...   NaN
3    2        200        ...    50
4    1        225        ...    75
5    3        300        ...   NaN
6    3        400        ...   100 
```

请注意，我们没有对时间戳进行排序，因此如果您想要，您必须明确地进行。

# php - 循环 WordPress 博客文章

> ID：14715260
> 
> 赞同：0
> 
> 时间：2013-02-05T19:22:43.617
> 
> 标签：php, wordpress, loops

我正在努力按照我想要的方式循环我的 WordPress 网站中的博客文章。

我希望帖子看起来像这样

![截图1](../Images/d47f016e88a59f519d2352e161cb95f3.png)

但由于我必须循环的方式，它们会像这样出来

![截图2](../Images/a7a286d730ab01d95ade15a253a34236.png)

这是我正在使用的代码 - 我从一个空白主题开始并从那里建立

```
 <section class="blog-posts col-2-3 grid-pad">

    <?php while (have_posts()) : the_post(); ?>

      <article class="module">

      <li class="postWrapper" id="post-<?php the_ID(); ?>">

        <h2 class="postTitle"><a href="<?php the_permalink() ?>" rel="bookmark"><?php the_title(); ?></a></h2>
        <small><?php the_date(); ?> by <?php the_author(); ?></small>

        <div class="post"><?php the_content(__('(more...)')); ?></div>
      </li>

      <?php endwhile; ?>

    </article>

  </section>

<?php else: ?>

 <p><?php _e('Sorry, no posts matched your criteria.'); ?></p>

<?php

endif;
?>

<?php if (will_paginate()): ?>

<ul id="pagination">
  <li class="previous"><?php posts_nav_link('','','&laquo; Previous Entries') ?></li>
  <li class="future"><?php posts_nav_link('','Next Entries &raquo;','') ?></li>
</ul>

<?php endif; ?>
</div> <!--END div.grid -->
</div> <!--END div.page-wrap -->
<?php
get_footer();
?> 
```

我对 WP 非常了解，所以我很难理解循环是如何工作的，理论上每篇博文都应该是一个`module`所以每一篇已知的博文都是一个新模块。就我而言，正在发生的事情是每篇博客文章都添加到最后一次创建长模块的底部。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:28:22.830

很难确定这是否会在不了解您的完整 HTML/CSS 的情况下解决您的问题，但我确实看到您`</article>`在`<?php endwhile; ?>`

# python - 为什么这个带有重复命名 url 条目的 URLConf/reverse() 组合有效？这样做的正确方法是什么？

> ID：14715261
> 
> 赞同：2
> 
> 时间：2013-02-05T19:22:45.440
> 
> 标签：python, django, django-urls

*   网址配置：

    ```
    url(r'^body/(?P<id>\d+)/$', 'body_part_detail', name='body-part-detail'),
    url(r'^body/(?P<id>\d+)/(?P<slug>[-\w\d]+)/$', 'body_part_detail', name='body-part-detail'), 
    ```

*   `get_absolute_url()`执行：

    ```
    def get_absolute_url(self):
        kwargs = {
            'id' : self.id,
            'slug' : slugify(self.name)
        }

        return reverse('body-part-detail', kwargs=kwargs) 
    ```

现在，我有两个`url`s where `name=body-part-detail`（可能是错的？）。然而，`reverse`在它使用第二个`url`并使用 slug 组件返回所需 URL 的意义上，它是成功的。为什么这行得通？在这种情况下我只是“幸运”（引用因为程序不应该幸运！）？

最后，在 SO 和 Web 上有几个地方，人们给出了 URLConfs 的示例，其中`url`s 共享`name`关键字 arg。例如，Visgean Skeloru 在这里的回答：[Optional get parameters in django?](https://stackoverflow.com/questions/1352834/optional-get-parameters-in-django) . 这是错误的/不好的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:51:34.863

该`reverse`函数识别您拥有 kwargs`id`和`slug`模式名称`body-part-detail`，并返回与这些 kwargs 和该名称相对应的唯一 url。你不走运，这`reverse`就是设计要做的。

您可能可以为许多模式使用相同的名称，但我不认为这就是它的设计方式（我可以看到一个非常古老的错误票，建议[实施检查](https://code.djangoproject.com/ticket/4824)以确保没有任何重复）。我怀疑如果您为每个模式使用唯一的名称，您的应用程序将更容易维护。查看[文档](https://docs.djangoproject.com/en/1.4/topics/http/urls/#naming-url-patterns)以获取更多信息。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:50:47.430

在您的`reverse()`通话中，您传递了两个参数。因此 Django 发现它无法将其与第一个 URL 匹配，因为尽管名称正确，但该 URL 只有一个 URL 参数。所以 Django 必须将它与第二个 URL 匹配。

可选的 URL 模式是可以的，但最好给每个 URL 一个唯一的名称并使用它来反转 URL。这消除了解析 URL 时的任何歧义，也使您和其他开发人员更容易理解代码。

# python - “models.Model”是什么意思

> ID：14715264
> 
> 赞同：0
> 
> 时间：2013-02-05T19:22:50.883
> 
> 标签：python, django

我正在通过[https://docs.djangoproject.com/en/1.4/intro/tutorial01/](https://docs.djangoproject.com/en/1.4/intro/tutorial01/)工作。它们包括以下内容：

```
from django.db import models

class Poll(models.Model):
    question = models.CharField(max_length=200)
    pub_date = models.DateTimeField('date published') 
```

“models.Model”是什么意思？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T19:24:11.020

意思是：使`Poll`类继承自模块的`Model`基类`models`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-05T19:26:42.180

你知道什么是继承吗？我将从看一些例子开始：

[http://parand.com/say/index.php/2009/04/20/python-simple-inheritance-example/](http://parand.com/say/index.php/2009/04/20/python-simple-inheritance-example/)

基本上是说使用 Model 类具有的所有属性以及您在类中定义的任何属性。

祝你好运

* * *

在 php 中，这将是：

```
class Poll extends Model
{
    var $question;
    var $pub_date;
} 
```

模型是 Django 框架中模型模块中的一个类...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:24:15.293

这是您要创建模型的子类。

# java - 如何按来自不同列的值分组为一行？

> ID：14715270
> 
> 赞同：3
> 
> 时间：2013-02-05T19:23:11.993
> 
> 标签：java, sql, sql-server, pivot, unpivot

我有一个如下所示的源表：

![在此处输入图像描述](../Images/91a11ec9c0731a168a923a48d3114692.png)

如何制作结果表如下所示。我可以在 sql 或 java 代码中使用解决方案。

![在此处输入图像描述](../Images/02e002f6c06969574bc24ba2c0599ea7.png)

拜托，谁能帮帮我。谢谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T19:40:43.607

我认为最简单的方法是同时应用`UNPIVOT`和`PIVOT`函数来获得结果：

```
select account, description,
  [value_1], [value_2], [value_3], [value_4]
from
(
  select account, description, col, value,
    row_number() over(partition by account, col order by col) rn
  from 
  (
    select [account], [description], [value_1], [value_2], [value_3], [value_4]
    from yourtable
  ) src
  unpivot
  (
    value 
    for col in ([value_1], [value_2], [value_3], [value_4])
  ) un
) s
pivot
(
  max(value)
  for col in ([value_1], [value_2], [value_3], [value_4])
) piv 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/592c9/7)。

这也可以使用 a`UNION ALL`作为*unpivot*和一个聚合函数和一个`CASE`表达式来完成：

```
select account, description,
  max(case when col = 'value_1' then value end) value_1,
  max(case when col = 'value_2' then value end) value_2,
  max(case when col = 'value_3' then value end) value_3,
  max(case when col = 'value_4' then value end) value_4
from
(
  select account, description, col, value,
    row_number() over(partition by account, col order by account) rn
  from
  (
    select [account], [description], 'value_1' col, [value_1] value 
    from yourtable
    where [value_1] is not null
    union all
    select [account], [description], 'value_2' col, [value_2] value 
    from yourtable
    where [value_2] is not null
    union all
    select [account], [description], 'value_3' col, [value_3] value 
    from yourtable
    where [value_3] is not null
    union all
    select [account], [description], 'value_4' col, [value_4] value 
    from yourtable
    where [value_4] is not null
  ) s
) un
group by account, description, rn 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/592c9/13)

两者都给出结果：

```
| ACCOUNT |  DESCRIPTION |  VALUE_1 |  VALUE_2 |  VALUE_3 |  VALUE_4 |
----------------------------------------------------------------------
|  A00005 | Account Desc | ABCD0081 | BCDE0010 | BKCP0010 | SMTP0010 |
|  A00005 | Account Desc | ABCD0082 |   (null) | BKCP0011 |   (null) | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:32:56.637

一个想法是使用`Row_Number()`作为您的加入字段。像这样的东西：

```
SELECT T.Account, T.Description, T1.Value_1, T2.Value_2, T3.Value_3, T4.Value_4
From 
  (
      SELECT Account, Description, Value_1, Value_2, Value_3, Value_4, 
           Row_number() OVER (ORDER BY (SELECT 0)) rn
      FROM YourTable
  ) T
  LEFT JOIN (
        SELECT Account, Value_1, Row_number() OVER (ORDER BY (SELECT 0)) rn
        FROM YourTable
        WHERE Value_1 <> '') T1 ON T.Account = T1.Account AND T.rn = T1.rn
  LEFT JOIN (
        SELECT Account, Value_2, Row_number() OVER (ORDER BY (SELECT 0)) rn
        FROM YourTable 
        WHERE Value_2 <> ''
  ) T2 ON T.Account = T2.Account AND T.rn = T2.rn
  LEFT JOIN (
        SELECT Account, Value_3, Row_number() OVER (ORDER BY (SELECT 0)) rn 
        FROM YourTable 
        WHERE Value_3 <> ''
  ) T3 ON T.Account = T3.Account AND T.rn = T3.rn
  LEFT JOIN (
        SELECT Account, Value_4, Row_number() OVER (ORDER BY (SELECT 0)) rn 
        FROM YourTable 
        WHERE Value_4 <> ''
  ) T4 ON T.Account = T4.Account AND T.rn = T4.rn
WHERE T1.Value_1 IS NOT NULL 
  OR T2.VALUE_2 IS NOT NULL 
  OR T3.VALUE_3 IS NOT NULL 
  OR T4.VALUE_4 IS NOT NULL 
```

如果您的值存储为空白，那么这应该有效。如果它们存储为 NULL，请将 <> '' 替换为 IS NOT NULL。

这是一个[SQL Fiddle](http://sqlfiddle.com/#!3/a1613/1)。

祝你好运。

# java - 写入 DataOutputStream 并使用缓冲区从 RandomAccessFile 读取时出现问题

> ID：14715273
> 
> 赞同：0
> 
> 时间：2013-02-05T19:23:14.777
> 
> 标签：java, file-io, buffer, dataoutputstream

```
 DataOutputStream lWriter = new DataOutputStream(connection.getOutputStream());

    int bytesRead = 0;
    int offset = 0;
    byte[] bytes = new byte[1048576]; // read 1MB at a time
    RandomAccessFile f = new RandomAccessFile(xmlFile, "rw");
    while(bytesRead != -1){
        offset += f.read(bytes, offset, bytes.length);
        if (bytesRead != -1){
             lWriter.write(bytes, 0, bytes.length);
        }
} 
```

使用此代码，我在 f.read() 处获得了索引越界异常。我可能错误地使用了参数偏移量和长度。不是每次我读入一个块时，我都应该将偏移量移动到块的大小吗？也许我只需要一次阅读更少并使用更小的缓冲区？

目前我有这个实现工作，但我担心内存使用：

```
DataOutputStream lWriter = new DataOutputStream(connection.getOutputStream());      
lWriter.write(fileToBytes(xmlFile)); 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:24:19.360

在 Java 中复制流的规范方法如下：

```
while ((count = in.read(buffer)) > 0)
{
    out.write(buffer, 0, count);
    // bytesRead += count; // if you are counting
} 
```

您的循环包含许多错误。偏移量是缓冲区的偏移量，而不是文件的偏移量，您几乎不需要使用它。您不必提前偏移。您正在测试 bytesRead 但在初始化后从未设置它。在推进计数之前，您没有检查 EOS。写入时您没有使用读取计数，因此您将垃圾写入文件。

# security - Code Igniter 的安全性和良好实践

> ID：14715281
> 
> 赞同：0
> 
> 时间：2013-02-05T19:23:39.010
> 
> 标签：security, codeigniter, xss, sql-injection

我正在浏览 Code Igniter 的文档，想知道我是否正确：

*   每次都使用 $this->input->post(x,TRUE) 而不是 $_POST

*   最好使用 PDO。如果没有，在查询之前执行 $this->security->xss_clean() 然后 $this->db->e​​scape() 。

*   使用 bcrypt 而不是他们的加密系统

另外，要重新填充表单，我可以将 post(x,TRUE) 放在输入的 value="" 字段中，还是必须通过 prep_for_form() ？

他们真的应该写一份关于如何使用 CodeIgniter 处理数据的文档。

编辑：显然 CodeIgniter 的 ActiveRecords 已经逃脱了一切，所以不需要使用 db->e​​scape()...

EDIT2：显然 form_validation 也逃脱了。因此，在完成 form_validation 之后执行 htmlspecialchars 会进行双重转义......我已经在这里发布了这个问题：[https ://github.com/EllisLab/CodeIgniter/issues/2230](https://github.com/EllisLab/CodeIgniter/issues/2230)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T03:31:39.837

1) 是的，否则你可以在你的`config.php`文件中启用全局 XSS 过滤，这样使用输入法访问参数将始终被转义。

`$this->db->escape()`2) CodeIgniter 的 Query Builder 已经做了转义，如果你用驱动编写自己的 SQL 查询，你只需要使用这个函数（例如，`$this->db->query("SELECT * FROM users WHERE id = '" . $this->db->escape($this->input->post('id')) . "' LIMIT 1");`

3) 使用 Bcrypt。如果你有 PHP 5.3.7+，那么你可以使用[这个库](https://github.com/ircmaxell/password_compat)，它将提供与 PHP 5.5 中内置 Bcrypt 函数的前向兼容性。

# javascript - 为页面上使用的每个实例更改 jquery 变量

> ID：14715285
> 
> 赞同：0
> 
> 时间：2013-02-05T19:24:02.173
> 
> 标签：javascript, jquery

我正在设置一个页面，该页面具有指向不同文档的多个链接。由于链接的名称与它们链接的文档相匹配，我想我会编写一个脚本，该脚本采用带下划线的任何内容的内部 html，并在其周围生成一个链接标记，并在链接中输入每个特定的链接名称。

我编写的脚本运行良好，除了它只运行一次并更新所有链接，每个链接都有一个相同的链接。有没有办法让它接受每个实例并单独更改它们？

对不起，如果我扼杀了我的解释！

这是我当前的代码：

```
<u>Link1</u>
<u>Link2</u>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

<script>
innerU = $("u").html();
$("u").html("<a href=mywebsite.com/" + innerU + ".pdf>" + innerU + "</a>");
</script> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:26:17.457

您可以使用 jQuery 的[each()](http://api.jquery.com/jQuery.each/)将所需的转换应用于`<u>`页面中的每个元素。像这样的东西：

```
$("u").each(function() {
    var innerU = $(this).html();
    $(this).html("<a href='mywebsite.com/" + innerU + ".pdf'>" + innerU + "</a>");
}); 
```

编辑：在 href 值周围添加引号以生成有效的 HTML。感谢[Kolink](https://stackoverflow.com/users/507674/kolink)注意到。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:28:37.453

试试这个：

```
(function() { // create a closure to avoid leaking variables
   var tags = document.getElementsByTagName("u"), l = tags.length, i, t, a;
   for( i=0; i<l; i++) {
      a = document.createElement('a');
      a.href = "http://mywebsite.com/"+tags[i].firstChild.nodeValue+".pdf";
      a.appendChild(tags[i].firstChild);
      tags[i].appendChild(a);
   }
})(); 
```

这更好有几个原因：

1.  它是原生 JavaScript，因此运行速度快了数百倍
2.  它使用闭包以避免变量污染全局范围
3.  它使用 DOM 方法而不是`innerHTML`（这是 jQuery`.html()`使用的）
4.  它将文本节点视为文本，如果您在其中有 HTML 实体，这一点很重要`&eacute;`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:26:21.627

这应该可以解决问题。

```
$("u").each(function () {

    var innerU = $(this).html();
    $(this).html("<a href=mywebsite.com/" + innerU + ".pdf>" + innerU + "</a>");

}); 
```

虽然，您的代码有很多“错误”。例如使用`<u>`标签生成链接？为什么不直接使用 anhors 并像这样动态设置它们的 href 属性：

```
<a href="#" class='coollink'>Link1</a>
<a href="#" class='coollink'>Link2</a>

<script>
$("a.coollink").each(function () {
    $(this).attr("href", "//mywebsite.com/" + $(this).html() + ".pdf");
});
</script> 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-02-05T19:33:48.420

您可以使用JQuery 的[.each()](http://api.jquery.com/jQuery.each/)方法。

```
$('u').each(function(){
    innerU = $(this).html();
    $(this).html("<a href=mywebsite.com/" + innerU + ".pdf>" + innerU + "</a>");
}); 
```

**[例子](http://jsfiddle.net/me4Ue/)**

# regex - 仅当前面没有“.”时才替换“\r\n”的正则表达式 在一个字符串中

> ID：14715288
> 
> 赞同：4
> 
> 时间：2013-02-05T19:24:21.333
> 
> 标签：regex, c#-4.0

您能否提供一个正则表达式，我可以用它来替换字符串中的所有内容`\r\n`，只有当前`\r\n`面*没有*?`.`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T19:30:30.930

要匹配一个字符，您可以将字符放在括号内，例如`[.]`. 要不匹配它，您*可以*使用插入符号开始字符列表，例如`[^.]`. 这将有效匹配任何不是`.`.

对于您的特定情况，您希望匹配前面`\r\n`没有 a的匹配项。`.`结合以上内容，可以使用：

```
[^.]\r\n 
```

要替换它，您需要“捕获”不是句号的字符以将其保留在替换中。您可以通过将其包裹在括号中来捕获它，例如`([^.])`.

使用[`Regex.Replace()`](http://msdn.microsoft.com/en-us/library/e7f5w83z.aspx)，它会是这样的：

```
yourString = Regex.Replace(yourString, @"([^.])\r\n", "$1"); 
```

是匹配的`$1`字符，并被重新替换回字符串中，现在去掉了`\r\n`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:30:07.390

我认为这会奏效

```
Regex.Replace(input, @"([^.]?)\r\n", "$1"); 
```

# css - SAS中的框架集和框架改变高度

> ID：14715289
> 
> 赞同：0
> 
> 时间：2013-02-05T19:24:27.640
> 
> 标签：css, height, frame, sas, frameset

我正在更新使用框架集的非常旧的站点。在右侧 70% 列中，我试图强制设置一个高度以容纳下拉菜单。出于某种原因，当我给框架一个 ID 和一个高度时，它被忽略了。任何想法为什么会发生这种情况？这是在 SAS 环境中，我从未见过有人实际使用框架集。

```
<frameset cols="30%, 70%">
  <frame src="left">
  <frame src="right" id="beTall">  
</frameset> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T06:25:25.417

带有框架集的 html 不能同时用于在屏幕上显示某些内容。它只是将窗口划分为多个框架的占位符。您的框架集由两列组成，它们都是高度视口的 100%。

如果要添加下拉菜单，则需要将其添加到包含显示内容的 html 文件中。在您的示例中，这是左或右。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:34:36.117

我不相信`<frame>`支持高度属性。您可以通过在整个帧源 IE 周围包裹一个 DIV 来获得类似的结果，在您拥有的“左侧”

```
<html>
<div id="beTall">
... source of left ...
</div>
</html> 
```

[http://www.w3schools.com/tags/tag_frame.asp](http://www.w3schools.com/tags/tag_frame.asp)

# iphone - 如何修复uiview中uilabel上的文本编码

> ID：14715292
> 
> 赞同：1
> 
> 时间：2013-02-05T19:24:36.167
> 
> 标签：iphone, ios, objective-c, encoding

我有一个奇怪的文本编码问题，我无法弄清楚。奇怪的是，如果您在浏览器中从 API 提要在线查看文本，则文本不需要任何格式。

这是我的代码：

```
-(void) viewDidLoad {

    [super viewDidLoad];

  NSString *jsonDealString = [NSString stringWithFormat:@"http://api.*****"];

    NSLog(@"deal id is %@",dealId);

    // Download the JSON
    NSString *jsonString = [NSString
                            stringWithContentsOfURL:[NSURL URLWithString:jsonDealString]
                            encoding:NSStringEncodingConversionAllowLossy|NSUTF8StringEncoding
                            error:nil];

    // Create parser for the api
    SBJSON *parser = [[SBJSON alloc] init];
    NSDictionary *results = [parser objectWithString:jsonString error:nil];

    [self setDisplayItems:[results objectForKey:@"results"]];

    NSDictionary *item = (NSDictionary *)[displayItems objectAtIndex:0];

    self.titleDeal.text = [item objectForKey:@"title"];

} 
```

我能够使用以下方法纠正文本编码问题：

```
 // merchant name with encoding fix
NSString *correctStringTitleDeal = [NSString stringWithCString:[[[item objectForKey:@"merchant"] objectForKey:@"name"] cStringUsingEncoding:NSISOLatin1StringEncoding] encoding:NSUTF8StringEncoding];
self.titleDeal.text = correctStringTitleDeal; 
```

但是当遇到 Null 对象时会导致崩溃。

我的崩溃日志输出状态：

*** 由于未捕获的异常 'NSInvalidArgumentException' 导致应用程序终止，原因：'*** +[NSString stringWithCString:encoding:]: NULL cString'

这是表格视图中出现的问题的屏幕截图（它也发生在应用程序的其他地方）：

![在此处输入图像描述](../Images/d1f0959075d54fb9abcad84fd775c9da.png)

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:47:12.353

崩溃是因为您将消息发送到 c 字符串，而不是对象。cstringUsingEncoding: 给出一个 c-string，你不能做编码之类的事情：

对于编码问题，如果您可以使用浏览器很好地阅读 API 中的文本，那么它将被编码为 HTML 而不是 UTF8 形式的 unicode。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:20:20.890

简短回答：找出 API 的字符串编码并使用它。

更长的答案：

编码问题的最可能原因是 JSON 不是 UTF-8。规范要求 JSON 采用某种形式的 Unicode（参见[RFC4627 第 3 节](http://www.ietf.org/rfc/rfc4627.txt)）。具体编码由前四个八位字节确定。再次，请参阅规范。

你的过世`NSStringEncodingConversionAllowLossy`非常可疑。您不应该允许有损转换。您应该知道 API 的具体编码并且应该使用它。同样，您将其他示例代码中的编码切换为`NSISOLatin1StringEncoding`. 虽然这类似于某些 Unicode，但它不是 Unicode 编码，因此永远不应该用于 JSON。

当然，这个特定的 API 可能违反规范并发送错误编码的 JSON。您可以与 API 提供者一起修复他们的 JSON，也可以使用他们提供的任何编码。但是你不应该猜测，你绝对不应该接受有损转换。

# security - 仅在 Firefox 中 http 回发时“连接已重置”

> ID：14715297
> 
> 赞同：1
> 
> 时间：2013-02-05T19:24:52.573
> 
> 标签：security, firefox

我们的客户使用 Shibboleth 实施单点登录。将该断言返回到我们在云上的服务器。它在 IE、Chrome 中正常工作……但最近在 Firefox 上总是失败。

该错误是著名的“连接已重置”，我搜索了很多关于此错误的讨论，并通过更改 Firefox 安全设置找到了解决方法，如下所示：

1.  打开火狐，清除所有cookies和缓存，然后指向about:config

2.  搜索并将“security.ssl3.rsa_aes_128_sha”和“security.ssl3.rsa_aes_256_sha”设置为false（通过在about：config窗口中双击这些项目）

更改以上2个安全设置后，问题在firefox中解决，一切正常。但是我们不能建议我们的客户更改他们的 Firefox 安全设置。我想知道为什么以上两项导致“连接已重置”错误，我们可以在我们的服务器或 Shibboleth ID 服务器上有解决方案吗？

非常感谢任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-16T09:27:23.360

我刚刚遇到了同样的问题，但使用的是 SimpleSAMLPHP。问题仅在 Firefox 中，并且仅在 SAML 响应的回发中。

对我们来说，错误的原因是输出 LB 限制了它在标题中允许的数据量。Firefox 比其他浏览器添加了更多的标头数据，并且 SAML 响应大到足以达到上限。

更换盖子后，一切正常。

# ios - 如何在 iOS 5 中使用 Embed Segue？

> ID：14715306
> 
> 赞同：5
> 
> 时间：2013-02-05T19:25:37.450
> 
> 标签：ios, objective-c, uistoryboard, uistoryboardsegue

iOS 6 引入了 Embed Segue，允许在 Storyboards 中使用自定义容器控制器。反正有没有为 iOS 5 复制这个？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T19:48:27.853

这里的挑战是子视图控制器的视图通常被添加为父视图控制器的某些容器视图的子视图。由于您不能从随机`UIView`控件中获得转场，因此无法创建从`UIView`容器视图到子场景的转场。因此，您只需要自己编写代码。

*幸运的是，这只是View Controller Programming Guide中的*[添加子控制器](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW13)中引用的那四行代码。就个人而言，我什至可能会稍微修改该代码，在我的视图控制器中定义以下方法：

 *```
- (void) displayChildController:(UIViewController*)childController
                inContainerView:(UIView *)containerView
{
   [self addChildViewController:childController];                 // 1
   childController.view.frame = containerView.bounds;             // 2
   [containerView addSubview:childController.view];
   [childController didMoveToParentViewController:self];          // 3
} 
```

不过，我已经完成了将活动子控制器从一个场景更改为下一个场景的自定义 segues，但它本质上只是上述参考文档中稍后列出的代码的一种变体。但这不是一个嵌入 segue 问题，所以这里不相关

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T19:26:46.247

我通过继承 UIStoryboardSegue 来复制功能。

在 Interface Builder 中，我创建了一个自定义 segue 并将其类设置为我的子类 (QCEmbedSegue)。在我的父视图控制器中`viewDidLoad`，我调用`performSegueWithIdentifier:sender`.

QCEmbedSegue 简单地覆盖`perform`：

```
- (void)perform
{
    [self.sourceViewController addChildViewController:self.destinationViewController];
    [[self.sourceViewController view] addSubview:[self.destinationViewController view]];
    [self.destinationViewController didMoveToParentViewController:self.sourceViewController];
} 
```

[http://www.quentamia.com/blog/embed-segue-in-ios-5/](http://www.quentamia.com/blog/embed-segue-in-ios-5/)*

# html - 如何创建一个输出的文本框 格式 (HTML)

> ID：14715309
> 
> 赞同：-2
> 
> 时间：2013-02-05T19:25:44.197
> 
> 标签：html, text, textbox, output

如何创建以`<p> </p>`格式输出的文本框？例如，当有人输入他的名字时，他的名字会出现在另一个页面上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:31:10.370

**HTML**

```
<input name="name" id="name" /> 
```

**jQuery**

```
$("#name").change(function() {
    $("#idOfPElementWhichYouWantToEdit").text($(this).val());
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:34:58.527

使用 PHP 和 FORM：

```
<?php

$text=isset($_POST['text'])?$_POST['text']:false;

if ($text) {
  echo"<p>".$text."</p>";
}

?>

<form action="" enctype="application/x-www-form-urlencoded" method="post">
  <textarea name="text"></textarea>
  <input type="submit" value="Submit" />
</form> 
```

# rmagick - 用rmagick“模糊”现有的单个图像马赛克？

> ID：14715310
> 
> 赞同：4
> 
> 时间：2013-02-05T19:25:56.290
> 
> 标签：rmagick, mosaic

尝试用 rmagick 拼接图像。

一个“马赛克模糊”现有图像如何制作它所代表的马赛克图片？

像： ![在此处输入图像描述](../Images/f4f197216f0631ed008bef9c34acdf7c.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-04T04:37:04.267

这就是使用 RMagick 进行马赛克的方法

```
#!/home/software/ruby-1.8.5/bin/ruby -w
require 'RMagick'

# Demonstrate the mosaic method

a = Magick::ImageList.new

letter = 'A'
26.times do
    # 'M' is not the same size as the other letters.
    if letter != 'M'
        a.read("images/Button_"+letter+".gif")
    end
    letter.succ!
end

# Make a copy of "a" with all the images quarter-sized
b = Magick::ImageList.new
page = Magick::Rectangle.new(0,0,0,0)
a.scene = 0
5.times do |i|
    5.times do |j|
        b << a.scale(0.25)
        page.x = j * b.columns
        page.y = i * b.rows
        b.page = page
        (a.scene += 1) rescue a.scene = 0
    end
end

# Make a 5x5 mosaic
mosaic = b.mosaic
mosaic.write("mosaic.gif")
# mosaic.display
exit 
```

# python - wxWidgets/wxPython：从 htmlWindow 迁移到 Webview

> ID：14715314
> 
> 赞同：0
> 
> 时间：2013-02-05T19:26:03.490
> 
> 标签：python, webview, wxpython, wxwidgets

我有一个使用 htmlWindow 的应用程序，并希望将其迁移到 wx 2.9 中的新 webview。但是，我了解到没有可用于将 JavaScript 变量从网页传回 Python 代码的内置方法。有一种 RunScript 方法允许将 JavaScript 发送到页面，但没有方法可以在用户单击或任何其他用户交互时检索元素 id。

我的问题是，有什么解决方法吗？有没有办法拦截警报呼叫或其他任何东西并获取数据？如果无法从用户交互中接收数据，那么 webview 显示就没有多大价值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T23:48:16.213

据我所知，从 RunScript() 获取返回值的唯一方法是使用页面标题 hack。

例如，在 RunScript 中的某处，您将 document.title 设置为您希望检索的值并使用 GetCurrentTitle() 将其输入 python，如果您希望在检索数据后可以重置标题。

所以如果 self.html 是 webview

```
self.html.RunScript("""
    //javascript goes here
    // variable we wish to retrieve is called return_value
    document.title = return_value
    """)
r =  self.html.GetCurrentTitle() 
```

如果您想从 webview 中启动它，可以通过覆盖 wxEVT_COMMAND_WEB_VIEW_NAVIGATING 来完成（如 Robin 发布的链接中所建议的那样），以便当它接收到自定义 url 方案时，例如，retrievedata://data/.... 它检索来自 url 的数据并做任何你想做的事，确保你在某个时候调用 evt.Veto()。然后，您可以通过简单地从 javascript 中调用合适的 url 来传递您希望的任何数据。

下面完全未经测试的代码（只是为了让您了解它是如何完成的）

```
def OnPageNavigation(self, evt):
    url = evt.GetUrl()
    if url.startswith("retrievedata://data/"):
         data = url[len("retrievedata://data/"):]
         evt.Veto()
         // Do whatever you want with the data 
```

或者，您可以结合使用这两种想法并创建一个在访问时调用 GetPageTitle() 的 url，并确保在调用页面之前设置 document.title。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:09:24.100

最近有一些关于 wx-users 邮件列表的讨论，以及针对此类问题的解决方法的建议。我自己没有尝试过，但您可能会发现它很有用。见[https://groups.google.com/d/topic/wx-users/Pdzl7AYPI4I/discussion](https://groups.google.com/d/topic/wx-users/Pdzl7AYPI4I/discussion)

# mysql - MysqlException 未处理 DataReader 必须关闭此连接 vb.net

> ID：14715319
> 
> 赞同：0
> 
> 时间：2013-02-05T19:26:13.040
> 
> 标签：mysql, vb.net, datareader

我遇到了这个问题：

**错误：**已经有一个打开的 DataReader 与此 Connection 关联，必须先关闭它。

请看一下我的代码：

```
 Dim sqlQuery As String = "SELECT * FROM users"
    Dim myAdapter As New MySqlDataAdapter

    If txtUsername.Text = String.Empty And txtPassword.Text = String.Empty Then
        MsgBox("Enter username and password", MsgBoxStyle.Exclamation, "Tea Sparkle POS")
    Else
        Dim sqlquerry = "Select * From users where username = '" + txtUsername.Text + "' And password= '" + txtPassword.Text + "'"
        Dim myCommand As New MySqlCommand()
        myCommand.Connection = SQLConnection
        myCommand.CommandText = sqlquerry
        'Starting The Query
        myAdapter.SelectCommand = myCommand
        Dim mydata As MySqlDataReader
        mydata = myCommand.ExecuteReader()
        'To check the Username and password and to validate the login a
        If mydata.HasRows = 0 Then
            MsgBox("Invalid Login")
            txtPassword.Clear()
            txtUsername.Clear()
        Else
            Dim authorityid = 0
            While mydata.Read()
                authorityid = mydata.GetInt32("authorityid")
            End While
            MsgBox("Welcome " + txtUsername.Text + "!")
            If authorityid = 1 Then
                MainForm.Show()
            Else
                MainForm.Show()
            End If
            Me.Hide()
        End If
    End If

    Private Sub Login_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load

    SQLConnection.ConnectionString = ServerString

    Try
        If SQLConnection.State = ConnectionState.Closed Then
            SQLConnection.Open()
        Else
            SQLConnection.Close()
        End If
    Catch ex As Exception
        MsgBox(ex.ToString)
    End Try

End Sub 
```

此错误在此行中：

```
 mydata = myCommand.ExecuteReader() 
```

这有什么问题？任何帮助都非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:28:17.750

> 这有什么问题？

好吧，看起来您正在重用现有连接：

```
myCommand.Connection = SQLConnection 
```

不要那样做。每次需要与数据库通信时创建一个新连接，并在完成后关闭它，使用`Using`语句确保即使抛出异常也将其关闭。

此外，`Using`为您的命令使用一个语句，为您的读者使用另一个语句 - 这些都是您应该关闭的资源。

哦，而且看起来您正在 UI 线程中执行此操作，这是一个坏主意，因为在进行数据库访问时您的 UI 将无响应。

# nhibernate - 限制 NHibernate 实体返回

> ID：14715321
> 
> 赞同：2
> 
> 时间：2013-02-05T19:26:17.587
> 
> 标签：nhibernate, many-to-many, max

我试图限制 NHibernate Criteria 将返回的实体数量。标准似乎是使用 SetMaxResults，但如果我的标准涉及多对多关系的 LEFT OUTER JOIN，这将无法正常工作。

一个例子：

狗有主人（多对多关系），我需要检索最多 10 条属于某组主人的狗。正在做

```
session.CreateCriteria<Dog>()
  .CreateAlias("Owners", "Owners")
  .Add(Restrictions.In("Owners.Id", idCollection)
  .SetMaxResults(10)
  .List<Dog>(); 
```

将转换为 SQL 查询，例如

```
SELECT TOP(10) * FROM DOGS d
  LEFT OUTER JOIN OWNERS_DOGS od ON d.id = od.id
  WHERE od.OWNER_ID IN (:valueone, :valuetwo) 
```

我的 TOP 限制发生得太早，导致拥有多个符合条件的狗的主人多次计入我的 10 限制。有没有一种干净的方法告诉 NHibernate 我只希望它为第一个 X 狗对象补水？我可能无法摆脱对数据库执行完整的 SELECT，但如果我可以避免加载系统中的每条狗，那就太好了，因为我只会显示其中的 10 条。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T05:13:56.143

这种情况下的解决方案是**子查询**。我们需要的是创建*内部 SELECT*，它将被狗主人过滤并返回 Dog **ID**。然后我们将查询 Dogs，通过该*子查询*过滤它们。最后，在平面结构上执行时，我们的分页将是正确的。

请参阅此答案的更多详细信息：[https ://stackoverflow.com/a/14080092/1679310](https://stackoverflow.com/a/14080092/1679310)

子查询[15.8。分离查询和子查询](http://nhforge.org/doc/nh/en/index.html#querycriteria-detachedqueries)：

```
DetachedCriteria subQuery = DetachedCriteria.For(typeof(Dog))
    // WHERE conditions go here
    .SetProjection( Projections.Property("ID") )
; 
```

具有正确分页的查询

```
session.CreateCriteria(typeof(Dog))
    .Add(Subqueries.PropertyEq("ID", subQuery));
    // PAGING goes here
    .SetMaxResults(10)
    .List(); 
```

# angularjs - 广播模式变化

> ID：14715324
> 
> 赞同：3
> 
> 时间：2013-02-05T19:26:25.207
> 
> 标签：angularjs

我正在尝试设置一个小 POC 来查看 Angular 是否适用于我正在处理的事情。

我设置了一个 REST 服务器，我可以通过 Angular 进行 CRUD。但是，由于那里的文档和教程到处都是（阅读：超级不一致），我不确定我没有看到的行为是错误代码的结果，还是我不能这样做。

我从文档中了解到双向绑定可用，但尚不清楚它是如何工作的。注意我已经阅读了数十篇文章，解释了它如何在低级别 a'la [https://stackoverflow.com/a/9693933/2044377](https://stackoverflow.com/a/9693933/2044377)工作，但无法回答我自己的问题。

我对修改 sql db 的 REST 服务进行了角谈。

我想知道并尝试 POC 的是，如果我打开了 2 个浏览器并且我更改了数据库中的一个值，它会反映在另一个浏览器窗口中吗？

正如我所说，我让它更新了数据库，但到目前为止它还没有更新其他浏览器窗口。

## 应用程序.js

```
angular.module('myApp', ['ngResource']);

var appMock = angular.module('appMock', ['myApp', 'ngMockE2E']);
appMock.run(function($httpBackend) {}); 
```

## 控制器.js

```
function MainCtrl($scope, $http, $resource) {
  $scope.message = "";
  $scope.fruits = [];
  $scope.fruit = {};
  $scope.view = 'partials/list.html';

  var _URL_ = '/cirest/index.php/rest/fruit';

  function _use_$resources_() { return false; }
  function _fn_error(err) {
    $scope.message = err;
  } 

  $scope.listFruits = function() {

    $scope.view = 'partials/list.html';

    var fn_success = function(data) {
        $scope.fruits = data;
    };

    $http.get(_URL_).success(fn_success).error(_fn_error);

  }

  function _fn_success_put_post(data) {
        $scope.fruit = {};
        $scope.listFruits();  
  }

  function createFruit() {
        $http.post(_URL_, $scope.fruit).success(function(data){
        $scope.listFruits()
      }).error(_fn_error);

  }

  function updateFruit() {
      $http.post(_URL_, $scope.fruit).success(_fn_success_put_post).error(_fn_error);
  }

  function deleteFruit() {

      $http.put(_URL_, $scope.fruit).success(_fn_success_put_post).error(_fn_error);

  }

 $scope.delete = function(id) {
    if (!confirm("Are you sure you want do delete the fruit?")) return; 
        $http.delete("/cirest/index.php/rest/fruit?id=" + id).success(_fn_success_put_post).error(_fn_error);

  }

  $scope.newFruit = function() {
    $scope.fruit = {};
    $scope.fruitOperation = "New fruit";
    $scope.buttonLabel = "Create";
    $scope.view = "partials/form.html";
  }

  $scope.edit = function(id) {
    $scope.fruitOperation = "Modify fruit";
    $scope.buttonLabel = "Save";

    $scope.message = "";

    var fn_success = function(data) {
        $scope.fruit = {};
        $scope.fruit.id = id;
        $scope.view = 'partials/form.html';
    };

      $http.get(_URL_ + '/' + id).success(fn_success).error(_fn_error);

  }

  $scope.save = function() {
    if ($scope.fruit.id) {
      updateFruit();
    }
    else {
      createFruit();
    }
  }

  $scope.cancel = function() {
    $scope.message = "";
    $scope.fruit = {};
    $scope.fruits = [];
    $scope.listFruits();    
  }

  $scope.listFruits();
}
MainCtrl.$inject = ['$scope', '$http', '$resource']; 
```

## 列表.html

```
{{message}}
<hr/>
   <a href="" ng-click="newFruit()">New Fruit</a>  
   <ul ng-model="listFruit">
      <li ng-repeat="fruit in fruits">
        <a href="" ng-click="edit(fruit.id)">id [{{fruit.id}}] {{fruit.name}} is {{fruit.color}}</a>
        [<a href="" ng-click="delete(fruit.id)">X</a>]
    </li>
   </ul> 
```

## 索引.html

```
<!doctype html>
<html lang="en" ng-app="myApp">
<head>
  <meta charset="utf-8">
  <title>FRUUUUUUUUUUUUUUUUUUUUUUUUUUUIT</title>
  <link rel="stylesheet" href="css/bootstrap/css/bootstrap.css"/>
</head>
<body>
  <div class="navbar">NAVBARRRRRRRRRRR</div>
  <div class="container">
    <div class="row">
      <div ng-controller="MainCtrl">

          <button ng-click="listFruits()">ListFruit()</button>
          <button ng-click="cancel()">Cancel()</button>

                <ng-include src="view"></ng-include>          

        </div>

    </div>
  </div>

  <!-- In production use:
  <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.4/angular.min.js"></script>
  -->
  <script src="lib/angular/angular.js"></script>
  <script src="lib/angular/angular-resource.js"></script>
  <script src="js/app.js"></script>
  <script src="js/services.js"></script>
  <script src="js/controllers.js"></script>
  <script src="js/filters.js"></script>
  <script src="js/directives.js"></script>
</body>
</html> 
```

## 表单.html

```
<h3>{{fruitOperation}}</h3>
<hr/>
<form name="fruitForm">
  <input type="hidden" name="" ng-model="fruit.id" />
  <p><label>name</label><input type="text" name="name" ng-model="fruit.name" value="dfgdfgdfg" required="true" /></p>
  <p><label>color</label><input type="text" name="color" ng-model="fruit.color" value="fruit.color" required="true" /></p>
  <hr/>
  <input type="submit" ng-click="save()" value="{{buttonLabel}}" /> <button ng-click="cancel()">Cancel</button>
</form> 
```

感谢您的任何见解或指示。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:32:20.590

双向绑定是指在视图中显示的控制器范围内发生的更改，反之亦然。Angular 对您的服务器端数据没有任何隐含的知识。例如，为了让您的更改显示在另一个打开的浏览器窗口中，您将需要一个通知层，通过长轮询、Web 套接字等将更改推送到客户端。

# java - JTable中的JButton单击时不显示动画

> ID：14715326
> 
> 赞同：0
> 
> 时间：2013-02-05T19:26:30.523
> 
> 标签：java, swing, jtable, jbutton, tablecelleditor

我已经使用本指南[http://www.cordinc.com/blog/2010/01/jbuttons-in-a-jtable.html完成了所有工作](http://www.cordinc.com/blog/2010/01/jbuttons-in-a-jtable.html)

所以还有一个小问题。当我点击按钮时，触发事件并执行方法。按钮动画不起作用，不提供视觉反馈。我猜这是因为要重新绘制 JTable，您需要调用模型`fireTableDataChanged()`方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T20:16:16.050

[表格按钮列](http://tips4java.wordpress.com/2009/07/12/table-button-column/)显示了另一种方法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T20:20:29.680

[引用](http://www.cordinc.com/blog/2010/01/jbuttons-in-a-jtable.html)的示例不太令人满意，因为*显示*了，但忽略了按钮的。实施，如[​​此处](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#editor)所示，是一种更好的方法。为了动画方便，您可能希望查看[此处](https://stackoverflow.com/a/7356518/230513)显示的 ，其中包含一个条目。[`TableCellRenderer`](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#renderer) *`JButton``MouseListener``ButtonModel``TableCellEditor``DefaultCellEditor``JComboBox`*

# c - 生成 AlephOne 风格的堆栈可视化？

> ID：14715327
> 
> 赞同：1
> 
> 时间：2013-02-05T19:26:36.607
> 
> 标签：c, x86, stack, static-analysis, buffer-overflow

在广为阅读的“[为了乐趣和利润而粉碎堆栈](http://www.phrack.com/issues.html?issue=49&id=14)”教程中，Aleph One 提供了这样的 C 代码示例：

```
void function(int a, int b, int c) {
    char buffer1[5];
    char buffer2[10];
}

void main() {
    function(1,2,3);
} 
```

然后，基于某种直觉（有时是查看 X86 程序集），Aleph One 生成了堆栈配置图。例如，堆栈`function(int a, int b, int c)`看起来像这样：

```
bottom of                                                            top of
memory                                                               memory
           buffer2       buffer1   sfp   ret   a     b     c
<------   [            ][        ][    ][    ][    ][    ][    ]

top of                                                            bottom of
stack                                                                 stack 
```

在阅读了教程并进行了一些练习之后，我现在可以手动制作上面的图表了。但是，对于更复杂的程序来说，手工制作这些图表可能有点乏味。

**是否有可以生成这样的堆栈图的工具，也许通过进行静态分析？**

# ruby - 变量范围定义和继承

> ID：14715335
> 
> 赞同：4
> 
> 时间：2013-02-05T19:27:12.027
> 
> 标签：ruby, ruby-on-rails-3, search-engine

我正在为我的网页开发扩展搜索功能。

我查看了[ransack](https://github.com/ernie/ransack)，但是它缺少一些我需要的功能，使 url-query 字符串很长并且有一些错误（报告）。

因此，我开始实施自己的 hack。

首先我想提出我的想法，然后我想问一下如何解决我的问题，最后是否有其他方法可以改善这个问题。

想法：

模型定义了这样的东西（此外，模型在引擎内部）：

```
module EngineName
  class Post < ActiveRecord::Base
    search_for :name, :as => :string do |b, q|
      b.where{name =~ "%#{q}%"}
    end
  end
end 
```

:name 是定义要使用的查询参数，例如这将是 ?q[name]=something 我知道这不像 ransack 那样完全通用，但是...

:as 是为了建立正确的表单标签。:string 用于 text_field， :integer 用于 number_field 等等。我想进一步扩展它以实现为关联等自动生成集合。

现在块是一个简单的使用范围。在构建复杂查询（例如使用 count() 等）时，我遇到了 ransack 的几个缺点。[现在我可以在squeel](https://github.com/ernie/squeel)中指定我自己的优化查询。

我扩展了 ActiveRecord::Base 以设置逻辑（全局逻辑，不在引擎内部。我想在任何地方使用它）。我定义了一个范围：搜索，所以我可以像在 ransack 中一样使用 Model.search(param[q])。我还尝试保留由 search_for 调用定义的“可搜索”键列表。

```
class ActiveRecord::Base
@@searchable_attributes = Hash.new({})

def self.search_for(name, *opts, &search_scope)
  return unless search_scope

  @@searchable_attributes[name] = {
    :type => opts[:as],
    :condition => search_scope
  }

  unless @@searchable_attributes.has_key? :nil
    @@searchable_attributes[:nil] = Proc.new { scoped }
  end
end

scope :search, lambda {|q|
  next unless q.kind_of?(Hash)

  base = @@searchable_attributes[:nil].call
  q.each do |key, search|
    next unless base.class.searchable_attributes.has_key?(key)
    base = @@searchable_attributes[key][:condition].call(base, search)
  end
  base
}
end 
```

现在的问题：

它主要与类的继承有关。但即使在阅读并尝试[3](https://stackoverflow.com/questions/5452910/named-scopes-with-inheritance-in-rails-3-mapping-to-wrong-table) , [4](https://stackoverflow.com/questions/5897196/rails-named-scope-inheritance)之后它也不起作用。

请查看范围 :search 中的第二行。

在那里，我调用了我在上面定义的简单 Proc，它只包括“作用域”。这是为了解决 self 返回“ActiveRecord::Base”而不是模型本身（如“Post”或“Comment”）的问题。

这是因为在继承时基类上调用了范围，但是我没有找到任何可以解决此问题的方法。

由于在模型本身（例如 Post）上调用了 search_for，因此返回的范围模型是“正确的”。

有谁知道如何规避这个？

下一个问题是，如何存储“可搜索”范围的列表。我使用了@@variables。但由于它们在每个子类中共享，所以这是不行的。但是，它需要是静态的，因为在没有初始化实例的情况下调用了 search_for（不是吗？）

最后但并非最不重要的一点是，总是指定要在每个作用域上使用的基本模型以便我可以将它们链接在一起，这有点可怕。

有没有其他的可能性来改善这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-09T20:13:58.923

好吧，看来我自己终于把其他问题的其他答案放在一起了。

模型：

```
module EngineName
  class Post < ActiveRecord::Base
    searchable

    search_for :name, :as => :string do |b, q|
     b.where{name =~ "%#{q}%"}
    end
  end
end 
```

我的“插件”目前作为初始化程序：

```
class ActiveRecord::Base
  def self.searchable
    include Searchable
  end
end

module Searchable
  def self.included(base)
    base.class_eval {

      @@searchable_attributes = Hash.new({})

      def self.search_for(name, opts)
        return unless block_given?

        @@searchable_attributes[name] = {
          :type => opts[:as],
          :condition => Proc.new
        }
      end

      # Named scopes
      scope :search, lambda {|q|
        next unless q.kind_of?(Hash)

        base = self.scoped
        q.each do |key, search|
          key = key.to_sym
          next unless @@searchable_attributes.has_key?(key)
          base = @@searchable_attributes[key][:condition].call(base, search)
        end
        base
      }
    }
  end
end 
```

希望它能帮助其他一些解决同样问题的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-10T21:50:41.657

Rails 为[class_attribute](http://api.rubyonrails.org/classes/Class.html#method-i-class_attribute)提供了一个助手。这提供了可继承的类属性，但允许子类“更改自己的值并且不会影响父类”。但是，例如使用 []= 突变的哈希会影响父级，因此您可以确保在使用 ruby​​s[继承](http://www.ruby-doc.org/core-1.9.3/Class.html#method-i-inherited)方法进行子类化时制作新副本

因此，您可以像这样在基类上声明和初始化：

```
module Searchable
  extend ActiveSupport::Concern

  included do
    class_attribute :searchable_attributes
  end

  module ClassMethods
    def inherited(subclass)
      subclass.searchable_attributes = Hash.new({})
    end

    def search_for(name,opts)
      return unless block_given?

      searchable_attributes[name] = {
        :type => opts[:as],
        :condition => Proc.new
      }
    end
  end
end 
```

请注意，我使用 ActiveSupport::Concern 来获得更简洁的语法，以便直接在类上定义内容以及混合类方法。然后您可以简单地将其添加到活动记录库：

```
ActiveRecord::Base.send(:include, Searchable) 
```

现在任何类都有自己的属性哈希：

```
class Post < ActiveRecord::Base
  search_for :name, :as => :string do |b, q|
    b.where{name =~ "%#{q}%"}
  end
end 
```

# c - 向 PIC 发送命令

> ID：14715336
> 
> 赞同：1
> 
> 时间：2013-02-05T19:27:11.423
> 
> 标签：c, pic, mplab

首先，我的 PIC 是 16f1625，我使用 MPLAB 8.86 对其进行编程。我的问题很简单，我在 PC 和 PIC 之间进行通信，PC 发送一个字节，PIC 读取这个字节，然后做一些事情。我的问题是我想像这样改进它，PC发送一个像“R”这样的字母，然后他发送我想要设置的数字。今天我只有 4 种可能，PC 发送 0、1、2 或 5，我根据这些设置分辨率。

```
switch(i)    {
    case 1:
        pulsesPerMm = 10;
        break;
    case 2:
        pulsesPerMm = 20;
        break;
    case 5:
        pulsesPerMm = 51;
        break;
    case 10:
        pulsesPerMm = 102;

        break;
} 
```

我收到这样的命令：

```
while(!RCIF)    /* set when register is not empty */
    continue;
return RCREG; 
```

现在我想做这样的事情：我收到“R”，表示下一个单词将是分辨率，在这些之后，2个字节，这将是新的分辨率，我只需要将字符串转换为 int (使用 atoi) 然后我可以设置 pulsesPerMm。问题是我有其他只需要一个字母的命令，所以我不想更改这些。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:35:50.953

打开 rx 字符而不是数字，然后，仅在您的“R”案例块中，调用 getChar() 函数以返回接下来的两个字符和 atoi() 它们。

# iphone - iOS 版 Google 地图链接

> ID：14715338
> 
> 赞同：3
> 
> 时间：2013-02-05T19:27:20.150
> 
> 标签：iphone, ios, google-maps, maps, apple-maps

我想在我们公司的移动网站上有一个指向谷歌地图的链接。问题是，如果我做一个链接，它会把你带到谷歌地图网站。它需要打开应用程序。

我发现如果您以“comgooglemaps://”开始网址，它将打开谷歌地图。但是，这会带来一个问题，即如果 iOS 用户没有安装 Google Maps，则该链接将不起作用。

如果安装了谷歌地图，有没有办法打开它，但如果没有打开浏览器（我不相信你可以从网站打开苹果地图，因为它们的 API 的性质）

谢谢

编辑：请注意，这是在网站上完成的，而不是在应用程序上。所以它需要通过 HTML、Javascript、PHP 等来完成，而不是编程语言。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:23:29.537

看看[Apple Maps Links 页面](http://developer.apple.com/library/ios/#featuredarticles/iPhoneURLScheme_Reference/Articles/MapLinks.html)。

基本上你链接到 maps.apple.com 并在需要时重定向到谷歌地图。这是页面中的一个示例：

[http://maps.apple.com/?daddr=San+Francisco,+CA&saddr=cupertino](http://maps.apple.com/?daddr=San+Francisco,+CA&saddr=cupertino)

经纬度和缩放：

[http://maps.apple.com/?ll=53.01,6.01&z=15](http://maps.apple.com/?ll=53.01,6.01&z=15)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:34:01.847

检查此[链接](http://developer.apple.com/library/ios/DOCUMENTATION/UIKit/Reference/UIApplication_Class/Reference/Reference.html#//apple_ref/occ/instm/UIApplication/canOpenURL%3a)

您可以将此方法与谷歌地图应用程序的 url 方案一起使用。（comgooglemaps://blahblah）

```
[[UIApplication sharedApplication] canOpenURL:(NSURL*)foo] 
```

它将返回 BOOL 值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-21T11:18:37.817

试试这个代码

```
if ([[UIApplication sharedApplication] canOpenURL:
         [NSURL URLWithString:@"comgooglemaps://"]]) {
        NSString * url = [NSString stringWithFormat:@"%@%@,%@",@"http://maps.google.com/maps?q=",@"75.14524",@"12.1521"];
        [[UIApplication sharedApplication] openURL:
         [NSURL URLWithString:url]];

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-07T07:44:48.063

试试这个移动谷歌地图并设置路线

```
NSString* addr = nil;
     addr = [NSString stringWithFormat:@"http://maps.google.com/maps?daddr=%1.6f,%1.6f&saddr=Posizione attuale", destinationLat,destinationLong];

NSURL* url = [[NSURL alloc] initWithString:[addr stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]];
[[UIApplication sharedApplication] openURL:url]; 
```

# c - 使用二维数组进行倾斜的内存分配是否更有效？

> ID：14715343
> 
> 赞同：6
> 
> 时间：2013-02-05T19:27:46.093
> 
> 标签：c, optimization, cuda

我正在使用具有计算能力`1.3`GPU 的 CUDA 实现一个应用程序，该应用程序涉及扫描二维数组以查找出现较小二维数组的位置。到目前为止，这两个数组都是使用分配`cudaMallocPitch()`和传输使用`cudaMemcpy2D()`来满足合并的内存对齐要求的。

在第一个优化步骤中，我试图通过将数据集中读取到共享内存来合并对全局内存的内存访问。作为未优化代码中的测试（例如，存在分歧分支并且对全局内存的内存访问未合并），我使用分配了更大的数组`cudaMalloc()`，发现性能提高了高达`50%`. 这怎么可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-06T02:26:07.997

cudaMallocPitch() 确保二维数组（row-major）中每一行的起始地址是 2^N 的倍数（N 为 7~10，具体取决于计算能力）。

访问是否更高效不仅取决于数据对齐方式，还取决于您的计算能力、全局 mem 访问方式，有时还取决于缓存配置。

此博客解释了早期计算能力上未对齐的数据访问的带宽大幅减少，这可能是您的 Q 中的 A。

[https://developer.nvidia.com/content/how-access-global-memory-efficiently-cuda-cc-kernels](https://developer.nvidia.com/content/how-access-global-memory-efficiently-cuda-cc-kernels)

由于性能取决于许多因素，您可能必须发布您的设备模块类型和内核代码，以便进一步调查。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-08T17:04:34.177

正如康世印已经指出的那样，使用 带来的改进`cudaMallocPitch`取决于计算能力，并且预计对于较旧的计算能力更为显着。然而，对于最近的计算能力，倾斜的内存分配似乎并没有带来相关的加速。

下面的代码提供了使用非间距存储器和间距存储器之间的性能测试平台。特别是，该代码执行三个（非音高或音高）矩阵之间的求和。处理三个矩阵的原因是需要突出内存事务与计算相比，以便突出非间距分配和间距分配之间的差异。下面是一张`GTX 960`牌和一张`GT 920M`牌的计时结果。

**GTX 960**

```
Non-pitched - Time = 3.242208; Memory = 65320000 bytes
Pitched     - Time = 3.150944; Memory = 65433600 bytes 
```

**GT 920M**

```
Non-pitched - Time = 20.496799; Memory = 65320000 bytes
Pitched     - Time = 20.418560; Memory = 65433600 bytes 
```

可以看出，两张卡的两种实现方式并没有太大区别。上述结果还表明，由于使用了间距内存分配，内存占用率有所增加。

这是代码：

```
#include<stdio.h>
#include<cuda.h>
#include<cuda_runtime.h>
#include<device_launch_parameters.h>

#include "Utilities.cuh"
#include "TimingGPU.cuh"

#define BLOCKSIZE_x 16
#define BLOCKSIZE_y 16

/******************/
/* TEST KERNEL 2D */
/******************/
__global__ void test_kernel_2D(float * __restrict__ devPtrA, float * __restrict__ devPtrB, float * __restrict__ devPtrC, const int Nrows, const int Ncols)
{
    int    tidx = blockIdx.x * blockDim.x + threadIdx.x;
    int    tidy = blockIdx.y * blockDim.y + threadIdx.y;

    if ((tidx < Ncols) && (tidy < Nrows)) {
        devPtrA[tidy * Ncols + tidx] = devPtrA[tidy * Ncols + tidx] + devPtrB[tidy * Ncols + tidx] + devPtrC[tidy * Ncols + tidx];
    }
}

/**************************/
/* TEST KERNEL PITCHED 2D */
/**************************/
__global__ void test_kernel_Pitched_2D(float * __restrict__ devPtrA, float * __restrict__ devPtrB, float * __restrict__ devPtrC, const size_t pitchA, const size_t pitchB, const size_t pitchC, const int Nrows, const int Ncols)
{
    int    tidx = blockIdx.x * blockDim.x + threadIdx.x;
    int    tidy = blockIdx.y * blockDim.y + threadIdx.y;

    if ((tidx < Ncols) && (tidy < Nrows))
    {
        float *row_a = (float *)((char*)devPtrA + tidy * pitchA);
        float *row_b = (float *)((char*)devPtrB + tidy * pitchB);
        float *row_c = (float *)((char*)devPtrC + tidy * pitchC);
        row_a[tidx] = row_a[tidx] + row_b[tidx] + row_c[tidx];
    }
}

/********/
/* MAIN */
/********/
int main()
{
    const int Nrows = 7100;
    const int Ncols = 2300;

    TimingGPU timerGPU;

    float *hostPtrA = (float *)malloc(Nrows * Ncols * sizeof(float));
    float *hostPtrB = (float *)malloc(Nrows * Ncols * sizeof(float));
    float *hostPtrC = (float *)malloc(Nrows * Ncols * sizeof(float));
    float *devPtrA, *devPtrPitchedA;
    float *devPtrB, *devPtrPitchedB;
    float *devPtrC, *devPtrPitchedC;
    size_t pitchA, pitchB, pitchC;

    for (int i = 0; i < Nrows; i++)
        for (int j = 0; j < Ncols; j++) {
        hostPtrA[i * Ncols + j] = 1.f;
        hostPtrB[i * Ncols + j] = 2.f;
        hostPtrC[i * Ncols + j] = 3.f;
        //printf("row %i column %i value %f \n", i, j, hostPtr[i][j]);
        }

    // --- 2D non-pitched allocation and host->device memcopy
    gpuErrchk(cudaMalloc(&devPtrA, Nrows * Ncols * sizeof(float)));
    gpuErrchk(cudaMalloc(&devPtrB, Nrows * Ncols * sizeof(float)));
    gpuErrchk(cudaMalloc(&devPtrC, Nrows * Ncols * sizeof(float)));
    gpuErrchk(cudaMemcpy(devPtrA, hostPtrA, Nrows * Ncols * sizeof(float), cudaMemcpyHostToDevice));
    gpuErrchk(cudaMemcpy(devPtrB, hostPtrB, Nrows * Ncols * sizeof(float), cudaMemcpyHostToDevice));
    gpuErrchk(cudaMemcpy(devPtrC, hostPtrC, Nrows * Ncols * sizeof(float), cudaMemcpyHostToDevice));

    // --- 2D pitched allocation and host->device memcopy
    gpuErrchk(cudaMallocPitch(&devPtrPitchedA, &pitchA, Ncols * sizeof(float), Nrows));
    gpuErrchk(cudaMallocPitch(&devPtrPitchedB, &pitchB, Ncols * sizeof(float), Nrows));
    gpuErrchk(cudaMallocPitch(&devPtrPitchedC, &pitchC, Ncols * sizeof(float), Nrows));
    gpuErrchk(cudaMemcpy2D(devPtrPitchedA, pitchA, hostPtrA, Ncols * sizeof(float), Ncols*sizeof(float), Nrows, cudaMemcpyHostToDevice));
    gpuErrchk(cudaMemcpy2D(devPtrPitchedB, pitchB, hostPtrB, Ncols * sizeof(float), Ncols*sizeof(float), Nrows, cudaMemcpyHostToDevice));
    gpuErrchk(cudaMemcpy2D(devPtrPitchedC, pitchC, hostPtrC, Ncols * sizeof(float), Ncols*sizeof(float), Nrows, cudaMemcpyHostToDevice));

    dim3 gridSize(iDivUp(Ncols, BLOCKSIZE_x), iDivUp(Nrows, BLOCKSIZE_y));
    dim3 blockSize(BLOCKSIZE_y, BLOCKSIZE_x);

    timerGPU.StartCounter();
    test_kernel_2D << <gridSize, blockSize >> >(devPtrA, devPtrB, devPtrC, Nrows, Ncols);
    gpuErrchk(cudaPeekAtLastError());
    gpuErrchk(cudaDeviceSynchronize());
    printf("Non-pitched - Time = %f; Memory = %i bytes \n", timerGPU.GetCounter(), Nrows * Ncols * sizeof(float));

    timerGPU.StartCounter();
    test_kernel_Pitched_2D << <gridSize, blockSize >> >(devPtrPitchedA, devPtrPitchedB, devPtrPitchedC, pitchA, pitchB, pitchC, Nrows, Ncols);
    gpuErrchk(cudaPeekAtLastError());
    gpuErrchk(cudaDeviceSynchronize());
    printf("Pitched - Time = %f; Memory = %i bytes \n", timerGPU.GetCounter(), Nrows * pitchA);

    //gpuErrchk(cudaMemcpy2D(hostPtr, Ncols * sizeof(float), devPtrPitched, pitch, Ncols * sizeof(float), Nrows, cudaMemcpyDeviceToHost));
    gpuErrchk(cudaMemcpy(hostPtrA, devPtrA, Nrows * Ncols * sizeof(float), cudaMemcpyDeviceToHost));
    gpuErrchk(cudaMemcpy(hostPtrB, devPtrB, Nrows * Ncols * sizeof(float), cudaMemcpyDeviceToHost));
    gpuErrchk(cudaMemcpy(hostPtrC, devPtrC, Nrows * Ncols * sizeof(float), cudaMemcpyDeviceToHost));

    //for (int i = 0; i < Nrows; i++) 
    //  for (int j = 0; j < Ncols; j++) 
    //      printf("row %i column %i value %f \n", i, j, hostPtr[i * Ncols + j]);

    return 0;

} 
```

# html - 标题在同一行，挂在左边

> ID：14715344
> 
> 赞同：1
> 
> 时间：2013-02-05T19:27:52.217
> 
> 标签：html, css

我想获得这种效果：[示例](http://imgur.com/29rhFtj)

从此 HTML 文本：

```
<h1>Header</h1>
<p> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<h1> This is a very long header </h1>
<p> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
<p> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p> 
```

我知道我可以将每个部分的内容包含在 a`<div>`和 use`display: inline-block`中，但是 HTML 是自动生成的，更改它会出现问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:31:29.410

[http://jsfiddle.net/gqB2Z/3/](http://jsfiddle.net/gqB2Z/3/)

```
h1 {width:200px; float: left; clear: left}
p {overflow: hidden}  
h1 + p + p ,
h1 + p + p + p{padding-left: 200px;} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:34:07.970

给 h1 的宽度 X，从父容器定位它们。例如...

```
<div class="container">    
<h1>Header</h1>
    <p> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    <h1> This is a very long header </h1>
    <p> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
    <p> Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
</div> 
```

**CSS：**

```
.container h1 {
    width: 80px;
    float: left;
} 
```

# asp.net - 登录页面被点击 3 次

> ID：14715348
> 
> 赞同：1
> 
> 时间：2013-02-05T19:28:22.413
> 
> 标签：asp.net, web-config

我对此感到困惑。我在几个页面之上有一个母版页，其中一个是登录页面。这是 web.config 的示例

```
 <authentication mode="Forms">
          <forms loginUrl="~/Account/Login.aspx" timeout="2880" />
        </authentication>

    ...

      <location path="~/Account/Login.aspx">
        <system.web>
          <authorization>
            <allow users="*"/>
          </authorization>
        </system.web>
      </location>
  <location path="Default.aspx">
    <system.web>
      <authorization>
        <allow users="*"/>
      </authorization>
    </system.web>
  </location>
  <system.web>
    <authorization>
      <deny users="?"/>
    </authorization>
  </system.web> 
```

从 Default.aspx，我访问需要登录的 About.aspx。About.aspx 永远不会被命中，而是 Login.aspx 被命中，然后是 Site.master，然后再次登录，然后再次是 site.master，最后是 login.aspx 和 master.aspx。三次！...登录-> 法师被击中3次！...现在...如果我将 Web.config 中的代码行从

```
 <location path="~/Account/Login.aspx"> 
```

到

```
 <location path="Account"> 
```

登录->大师只被击中一次。Account 文件夹中除了 login.aspx/cs/designer 之外没有其他内容。为什么会这样？当我添加更多页面时，我想控制帐户文件夹中的页面，而不仅仅是取消对它们的访问权限，甚至

```
 <location path="Account/Login.aspx"> 
```

（删除“〜/”）没有做任何事情。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:37:56.843

您应该允许对您的所有访问，`MasterPage`类似于您允许任何人访问您的登录页面的方式。

它不会自行提供，也不需要保护，因为使用它的页面应该被锁定。通常我的根目录不安全，其中包含登录页面、母版页等。然后我有一个安全区域，其中包含使用根目录的母版页的页面。

# java - 无法使用java将数据从服务器发送到客户端，反之亦然

> ID：14715356
> 
> 赞同：1
> 
> 时间：2013-02-05T19:28:47.620
> 
> 标签：java, client, chat

一直试图解决这个问题大约 5 个小时，但似乎看不到它，虽然所有步骤都已完成发送数据，但我只能接收到服务器的消息，但不能从服务器到客户端。我正处于构建/学习如何在命令行中执行聊天客户端程序的早期阶段。以下是服务器代码：

CServer 类：

```
public class CServer {

private static int port=2008, maxConnections=0;
private static String shutDownServer = "no";

public static void main(String[] args) throws IOException{

    ServerSocket listen = new ServerSocket(port);
    Socket server;

    while(shutDownServer.equalsIgnoreCase("no")){

        doComm connection;

        System.out.println("\nWaiting for clients to connect...");

        server = listen.accept(); // accept incomming connections from client
        System.out.println("Client connected. Location: " + server.getInetAddress().getHostName());
        connection = new doComm(server);

        Thread thread = new Thread(connection);
        thread.start();
    }

}

public void shutDownServer(String command){

    this.shutDownServer = command;
}
} 
```

现在处理线程中每个客户端的 doComm 类：

```
public class doComm implements Runnable{

Socket server;
private String clientData;

  public doComm(Socket server){

      this.server = server;
  } 

  public void run(){

     try {

      BufferedReader fromClient = new BufferedReader(new InputStreamReader(server.getInputStream()));
      DataOutputStream toClient = new DataOutputStream(server.getOutputStream());

      clientData = fromClient.readLine();
         System.out.println("Client sent: "+clientData); 
```

（（问题 -imo- 可能是这句话：））

```
 toClient.writeBytes("Recieved your sentence '"+clientData+"' and more to come :)!");

    //server.close();

  } catch (IOException e) {
    System.out.println("IOException on socket listen: " + e);
    e.printStackTrace();
  }

  }
} 
```

现在客户端类 CClient：

```
 public class CClient {

    static String address = "localhost";

static int port = 4444;
static Socket echoSocket;

     public CClient(int port, String addr){

         changePort(port);
         changeAddr(addr);
     }

     public static void main(String[] args) throws IOException, UnknownHostException{

         Scanner scan = new Scanner(System.in);

         System.out.println("Please enter the port to connect to: ");
         int temp_port = Integer.parseInt(scan.nextLine());
         System.out.println("Please enter the address of server: ");
         System.out.flush();
         String temp_addr = scan.nextLine();

         CClient client = new CClient(temp_port,temp_addr);

            PrintWriter out = null;
            BufferedReader in = null;

         try{
             System.out.flush();
             echoSocket =  new Socket(address,port);
             out = new PrintWriter(echoSocket.getOutputStream(), true);
             in = new BufferedReader(new InputStreamReader(echoSocket.getInputStream()));
         }
         catch(IOException e){

             System.err.println("IOException error: " + e.getStackTrace());
         }

         BufferedReader stdIn = new BufferedReader(new InputStreamReader(System.in));
    String userInput;

    while ((userInput = stdIn.readLine()) != null) {

        out.println(userInput);
            System.out.println("thingy prints right after this..."); 
```

（（或这里：））

```
System.out.println("echo: " + in.readLine());
}
 }

 public void changePort(int port){

     this.port=port;
 }

 public void changeAddr(String addr){

     this.address=addr;
 }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:37:20.990

```
 clientData = fromClient.readLine();

  toClient.writeBytes("Recieved your sentence '"+clientData+"' and more to come :)!"); 
```

这是一个非常常见的问题，其根本原因是未能*记录*和*指定*用于通信的协议。在这里，您正在接收*行*但正在发送*字节*。如果您有一个协议文档，它会指定交换行或交换任意字节单位。这将表明这些代码行之一是错误的，您可以修复它。但是如果没有协议规范，你甚至无法判断哪一方是错误的。

请从多年的痛苦教训中吸取我的建议——在实施之前记录协议。然后，如果它不起作用，您可以按照以下三个步骤进行操作：

1.  客户是否遵循记录在案的协议？如果没有，它就坏了。

2.  服务器是否遵循记录的协议？如果没有，它就坏了。

3.  协议规范被破坏。

在这种情况下，协议规范将记录什么构成您的协议的“消息”。然后，每一方都有责任发送完整的消息并在接收时找到这些消息边界。但是，在您的情况下，一段代码需要一个行终止符来标记消息边界，而另一端不发送一个。

发件人省略消息边界是错误的吗？收货人坚持要收一份有错吗？没有人知道，因为没有说明什么是正确的做法。

# c# - 使用 CodeDOM 的 Winforms 应用程序中的资源

> ID：14715359
> 
> 赞同：-1
> 
> 时间：2013-02-05T19:28:52.947
> 
> 标签：c#, winforms, codedom

我有一个部署较小应用程序的应用程序。那些较小的基本上由一个图标（不是表单图标）和一个也需要图标的 notifyicon 控件组成。

我的问题是：如何在小型应用程序中嵌入资源并使用 CodeDOM 进行编译？我需要来自“更大”应用程序（可编译的应用程序）的图标，因为它们具有相同的图标。

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:35:44.303

如果您要问的是如何将资源嵌入到使用 CodeDOM 构建的程序集中（这是它唯一会做的事情，wrt 资源），那么请参阅[http://msdn.microsoft.com/en-us/library/system.codedom .compiler.compilerparameters.embeddedresources.aspx](http://msdn.microsoft.com/en-us/library/system.codedom.compiler.compilerparameters.embeddedresources.aspx)。

如果您要问的是如何以编程方式创建 .resource 文件，**这与 CodeDOM 无关** （即它不是代码，也不是可执行文件）。但是，可能[http://msdn.microsoft.com/en-us/library/xbx3z216.aspx](http://msdn.microsoft.com/en-us/library/xbx3z216.aspx)会为您指明正确的方向/

# php - 为什么我不能使用 mysqli_query 从 mysql db 表中获取数据？

> ID：14715360
> 
> 赞同：3
> 
> 时间：2013-02-05T19:28:58.450
> 
> 标签：php, mysql, mysqli, fetch

我处于原型阶段，所以我`error_reporting(-1);`在第一排。尽管如此，我没有 php 错误，但 php 打印**'could not get data'**。

正如我从 php.net 手册和 stackoverflow 类似案例中了解到的那样，我的 $sorgula 返回 FALSE。

但为什么？你能帮忙吗，问候

```
//i am sure that i am connected to db
if ($sorgula = mysqli_query($dbc, "SELECT * FROM tb_yazilar ORDER BY kolon_sn"))
{
    while ($satir = mysqli_fetch_array($sorgula, MYSQLI_ASSOC)) 
    {
    echo $satir['kolon_yazar'].' - '.$satir['kolon_baslik'].' - '.$satir['kolon_yazi'].' - '.$satir['kolon_etiketler'].' - '.$satir['kolon_ytarihi'].' -  -  -  - ';
    }
}
else 
{
echo 'could not get data';
}

mysqli_close($dbc); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:40:52.763

尝试 `mysqli_error`在您的代码中使用。

*程序示例：*

```
$sorgula = mysqli_query($dbc, "SELECT * FROM tb_yazilar ORDER BY kolon_sn")
           or error_log(mysqli_error($dbc)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-09-15T10:49:12.520

我使用了它并且它有效：没有if，一旦提取，返回并添加if。:)

```
require 'db.php';
$query = "SELECT * FROM thoughts";
$result = mysqli_query($conn, $query);
while($row=mysqli_fetch_assoc($result)) {
echo "<td>" . "TEXT: ". $row['text'] . "</td>";
}
mysqli_close($conn); 
```

# c++ - VideoCapture 与 opencv2.0 崩溃

> ID：14715361
> 
> 赞同：1
> 
> 时间：2013-02-05T19:29:01.487
> 
> 标签：c++, opencv

这个简单的程序在 VideoCapture 上崩溃了。我的配置是 OpenCV 2.0、MinGW、Windows7

```
int main()
{ 
    cout<<"reached here"<<endl;
    VideoCapture cap;
    cap.open("Z:\\snapshot\\streaminput\\video1.avi");
    if (!cap.isOpened())
    {
        cout<<"capture failed"<<endl;
        // print error msg
        return -1;
    }
    cout<<"capture successful"<<endl;
    Mat frame;
    namedWindow("gray",1);
    do
    {
        cap >> frame;
        cout<<"got a frame"<<endl;
        imshow("gray", frame);
        cvWaitKey(300);

    }while(1);
    //cvDestroyAllWindows();

    cout << "Hello world!" << endl;
    return 0;
}

CALLSTACK:
#0 002FB4B8 cv::VideoCapture::VideoCapture(int) ()(C:\OpenCV2.0\bin\libhighgui200.dll:??)
#1 77CCE115 ntdll!RtlAllocateMemoryZone() (C:\Windows\system32\ntdll.dll:??)
#2 00000000 0x0022fe78 in ??() (??:??)

PROGRAMOUTPUT(BEFORE CRASH POINT):
 capture name is:Z:\snapshot\streaminput\video1.avi
 Process returned 255 (0xFF)   execution time : 9.874
 Press any key to continue. 
```

知道这个程序或配置有什么问题吗？

# javascript - 如何匹配特定的正则表达式？

> ID：14715362
> 
> 赞同：0
> 
> 时间：2013-02-05T19:29:04.217
> 
> 标签：javascript, regex

我很难理解如何使用 javascripts match() 函数匹配某个正则表达式。我在以下列格式存储的表中有一个字段：CH-01-Feb-13-1。我希望能够在没有破折号的情况下获取日期，即 01-Feb-13。我试图弄清楚如何与 ^- 或 . 但不知道该怎么做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:34:11.503

所以你想要正则表达式？就像是

```
^\w{2}-(\d{2}-\w{3}-\d{2}).*?$ 
```

您可以在此处查看说明：[http](http://www.regexper.com/) ://www.regexper.com/只需复制并粘贴表达式即可。

![在此处输入图像描述](../Images/9c9741eb46e04d8e556d9552e6199140.png)

Javascript 示例

```
var r = /^\w{2}-(\d{2}-\w{3}-\d{2}).*?$/i
var groups = "CH-01-Feb-13-1".match(r);
console.log(groups); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:40:15.073

如果您对 Regex 不满意，那么您可以使用类似的东西。

```
var str = 'CH-01-Feb-13-1';
str = str.replace('CH-','');
str = str.split('-');
str.pop();
console.log(str.join('-')); 
```

# java - RequestedScope CDI bean 空值

> ID：14715366
> 
> 赞同：0
> 
> 时间：2013-02-05T19:29:08.713
> 
> 标签：java, jakarta-ee

我正在为我的 Web 应用程序使用 JSF 和 CDI。我创建了一个 JSF 表单和一个 RequestScoped bean 来保存表单数据。然后我创建了一个 CDI bean 来处理表单。这是表格：

```
 <h:outputText value="Mailing Address: " />  
            <p:inputText value="#{profile.mailAddress}" />  

            <h:outputText value="Cell Phone: " />  
            <p:inputText value="#{profile.cellPhone}"/>  

            <h:outputText value="Home Phone: " />  
            <p:inputText value="#{profile.homePhone}"/>  

            <h:outputText value="Work Phone: " />  
            <p:inputText value="#{profile.workPhone}"/>
            <p:commandButton action="#{profileController.test}" value="submit" ajax="false" /> 
```

这是请求范围的 bean：

```
package entities;

import java.io.Serializable;
import javax.faces.bean.RequestScoped;
import javax.inject.Named;
import javax.xml.bind.annotation.XmlRootElement;

/**
 *
 * @author G2
 */
@Named
@RequestScoped
@XmlRootElement
public class Profile implements Serializable{
    private String mailAddress;
    private String homePhone;
    private String workPhone;
    private String cellPhone;
    public String getMailAddress() {
        return mailAddress;
    }

    @XmlElement
    public void setMailAddress(String mailAddress) {
        this.mailAddress = mailAddress;
    }

    public String getHomePhone() {
        return homePhone;
    }

    public void setHomePhone(String homePhone) {
        this.homePhone = homePhone;
    }

    public String getWorkPhone() {
        return workPhone;
    }

    @XmlElement
    public void setWorkPhone(String workPhone) {
        this.workPhone = workPhone;
    }

    public String getCellPhone() {
        return cellPhone;
    }

    @XmlElement
    public void setCellPhone(String cellPhone) {
        this.cellPhone = cellPhone;
    }

} 
```

这是 CDI bean：

```
package jsf.classes;

import entities.Profile;
import java.io.Serializable;
import javax.annotation.PostConstruct;
import javax.enterprise.context.Conversation;
import javax.enterprise.context.ConversationScoped;
import javax.inject.Inject;
import javax.inject.Named;

/**
 *
 * @author yg
 */
@Named
@ConversationScoped
public class ProfileController implements Serializable {

    @Inject
    private Profile current;
    @Inject
    private Conversation conversation;

    public Profile getSelected() {
        return current;
    }

    public void setSelected(Profile profile) {
        this.current = profile;
    }

    public void beginConversation() {
        if (conversation.isTransient()) {
            conversation.begin();
        }
    }

    public void endConversation() {
        if (!conversation.isTransient()) {
            conversation.end();
        }
    }

    @PostConstruct
    public void init() {
        beginConversation();
    }
} 
```

但是，当我在表单中输入值并单击提交时，profileController.current 中的所有属性都为空。如何让profileController接收我通过表单输入的数据？

# html - 请求的资源 () 不可用。- iframe pdf

> ID：14715371
> 
> 赞同：2
> 
> 时间：2013-02-05T19:29:55.520
> 
> 标签：html, jsf, iframe, facelets

在 iframe 内部，我收到错误消息：

```
HTTP Status 404 -

type Status report

message

descriptionThe requested resource () is not available.

GlassFish Server Open Source Edition 3.1.2.2 
```

我在文件夹 resources/pdf/1.pdf 中放置了一个 pdf 文件，不管我把这个文件放在哪里，我都会收到这个错误，我做错了什么或忘记做什么，这是一个只显示用户的页面说明书。

```
<iframe src="/resources/pdf/1.pdf"></iframe>

|
| Gui
| `---- submittedPDF.xhtml
|
|
|resources
  `pdf
    `1.pdf 
```

这是结构的打印屏幕

[http://i1081.photobucket.com/albums/j348/west-wot/directory_zpsf8b3b5aa.png](http://i1081.photobucket.com/albums/j348/west-wot/directory_zpsf8b3b5aa.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:48:38.153

将您提交的PDF.xhtml 中的代码更新为

```
<iframe src="../resources/pdf/1.pdf"></iframe> 
```

`..`并且`.`在文件路径中有如下含义： `..`表示上一级目录，`.`表示当前目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T00:55:26.550

```
<iframe src="/resources/pdf/1.pdf"></iframe> 
```

前导斜杠将您带到域根目录，跳过上下文路径。

您需要包含上下文路径：

```
<iframe src="#{request.contextPath}/resources/pdf/1.pdf"></iframe> 
```

或者，因为它显然被放置在`/resources`文件夹中，所以使用隐式`#{resource}`映射：

```
<iframe src="#{resource['pdf/1.pdf']}"></iframe> 
```

无论哪种方式，它都会自动生成正确的域相关 URL，包括上下文路径。

# ios - AFNetworking 应用程序/json

> ID：14715372
> 
> 赞同：2
> 
> 时间：2013-02-05T19:30:00.240
> 
> 标签：ios, json, afnetworking

使用 iOS，我正在尝试与请求 3 个标头后跟 JSON POST 数据的 Web 服务进行通信。

我查看了以下 AFNetworking 片段，它将字典转换为 JSON 文件。在这种情况下，我正在尝试发布标头和 JSON 文件。如果您有任何建议，请告诉我：

```
NSURL *url = [NSURL URLWithString:WalletKit_URL];
AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];
httpClient.parameterEncoding = AFJSONParameterEncoding;
NSDictionary *params = @{@"brand-id" : Brand_Id, @"api-key" : API_Key, @"Content-Type" : @"application/json"};
NSMutableURLRequest *request = [httpClient requestWithMethod:@"POST" path:@"" parameters:params];
AFHTTPRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSURLResponse *response, id JSON) {
    NSLog(@"success");
} failure:^(NSURLRequest *request, NSURLResponse *response, NSError *error, id JSON) {
    NSLog(@"error");
}]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:32:28.550

您应该将 HTTP 标头字段添加到`NSMutableURLRequest`.

```
[request addValue:@"foobar" forHTTPHeaderField:@"X-Foo-Bar"]; 
```

# php - 我想更新mysql表column1，除非数据存在然后移动到下一个column2

> ID：14715382
> 
> 赞同：-1
> 
> 时间：2013-02-05T19:30:38.857
> 
> 标签：php, mysql

我想更新我的`MySQL`表。我想要做的是更新`column1`，除非数据存在，`column1`然后将它移到`column2`并更新那个。我目前拥有的代码不断更新第一列。

```
UPDATE users
SET    active = 1,
       time_started = '$_POST[in_time]'
WHERE  user_id = '$_POST[user_id] 
```

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:35:58.207

就像是：

```
update users set active=1, time_in_1=if(time_started is null,time_in_1,?), time_started=if(time_started is null,?,time_started) while ... 
```

实际上，当 time_started 为空时，上面的内容是：

```
update users set time_in_1=time_in_1, time_started=? 
```

（保持 time_in_1 不变； ? 是新值的占位符）。如果 time_started 不为空，它会：

```
update users set time_in_1=?, time_started=time_started 
```

（保持 time_started 不变）。在任何一种情况下，您都需要提供两次新值（假设只有一个；也许您希望将第二列更新为与将第一列更新为不同的值？）。

# java - JAXB 为包含集合的嵌套 xml 返回 null

> ID：14715383
> 
> 赞同：4
> 
> 时间：2013-02-05T19:30:42.533
> 
> 标签：java, jaxb

我想将以下 xml 解组为另一个父对象，如下定义。但它总是返回 NULL。

传入的 XML：

```
<contentFiles>
<contentFile>
<contentFileName>cwb_reg_content_IB20C0F504A9A11E281E4C8BF76F4977C.pdf</contentFileName>
<title><![CDATA[SEC No-Action Guidance Expanding the Definition of “Ready Market” for Certain Foreign Equity Securities]]></title>
<sourcePublicationDate>20121219</sourcePublicationDate>
<alternateDocNumbers>
  <alternateDocNumber>12345-b</alternateDocNumber>
</alternateDocNumbers>
<citesAffected>
   <cite>SEA Rule 15c3-1</cite>
</citesAffected>
</contentFile>
</contentFiles> 
```

对应的父类`<contentFiles>`

```
 @XmlRootElement(name = "contentFiles")
    public class RtSuperQuickMetadata
    {
        private List<RtSuperQuickMetadataItem> rtSuperQuickMetadataItems;

        public RtSuperQuickMetadata()
        {
            rtSuperQuickMetadataItems = new ArrayList<RtSuperQuickMetadataItem>();
        }

        public List<RtSuperQuickMetadataItem> getRtSuperQuickMetadataItems()
        {
            return rtSuperQuickMetadataItems;
        }

        public void setRtSuperQuickMetadataItems(
            List<RtSuperQuickMetadataItem> rtSuperQuickMetadataItems)
        {
            this.rtSuperQuickMetadataItems = rtSuperQuickMetadataItems;
        }

    } 
```

对应的父类`<contentFile>`

```
@XmlRootElement(name = "contentFile")
public class RtSuperQuickMetadataItem
{
    private String contentFileName;
    private String title;
    private String sourcePublicationDate;
    private List<AlternateDocNumber> alternateDocNumbers;
    private List<Cite> citesAffected;

    public RtSuperQuickMetadataItem()
    {
        alternateDocNumbers = new ArrayList<AlternateDocNumber>();
        citesAffected = new ArrayList<Cite>();
    }

    public List<AlternateDocNumber> getAlternateDocNumbers()
    {
        return alternateDocNumbers;
    }

    public List<Cite> getCitesAffected()
    {
        return citesAffected;
    }

    public String getContentFileName()
    {
        return contentFileName;
    }

    public String getSourcePublicationDate()
    {
        return sourcePublicationDate;
    }

    public String getTitle()
    {
        return title;
    }

    public void setAlternateDocNumbers(List<AlternateDocNumber> alternateDocNumbers)
    {
        this.alternateDocNumbers = alternateDocNumbers;
    }

    public void setCitesAffected(List<Cite> citesAffected)
    {
        this.citesAffected = citesAffected;
    }

    public void setContentFileName(String contentFileName)
    {
        this.contentFileName = contentFileName;
    }

    public void setSourcePublicationDate(String sourcePublicationDate)
    {
        this.sourcePublicationDate = sourcePublicationDate;
    }

    public void setTitle(String title)
    {
        this.title = title;
    }

}

@XmlRootElement(name = "alternateDocNumber")
class AlternateDocNumber
{
    private String alternateDocNumber;

    public String getAlternateDocNumber()
    {
        return alternateDocNumber;
    }

    public void setAlternateDocNumber(String alternateDocNumber)
    {
        this.alternateDocNumber = alternateDocNumber;
    }

    @Override
    public String toString()
    {
        return "AlternateDocNumber [alternateDocNumber=" + alternateDocNumber + "]";
    }
}

@XmlRootElement(name = "cite")
class Cite
{
    private String cite;

    public String getCite()
    {
        return cite;
    }

    public void setCite(String cite)
    {
        this.cite = cite;
    }

    @Override
    public String toString()
    {
        return "Cite [cite=" + cite + "]";
    }
} 
```

使用 JAXB 解组器代码：

```
public RtSuperQuickMetadata unmarshallXml(final File metadataFile)
        throws JAXBException, FileNotFoundException
    {
        RtSuperQuickMetadata rtSuperQuickMetadata = null;
        try
        {
            JAXBContext jc = JAXBContext.newInstance(RtSuperQuickMetadata.class);

            Unmarshaller um = jc.createUnmarshaller();
            rtSuperQuickMetadata =
                (RtSuperQuickMetadata) um.unmarshal(metadataFile);
        }
        catch (JAXBException e)
        {
            String msg = "Malformed XML supplied as Metadata" + " Msg " + e.getMessage();
            LOG.error(msg, e);
            throw new RuntimeException(msg, e);
        }

        return rtSuperQuickMetadata;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:40:55.257

您有太多`XmlRootElements`，您通常只想将其与顶部元素一起使用。您要做的是将孩子标记为`XmlElement`.

`XmlRootElement`从除根元素（即）之外的所有元素中删除注释，并*在将要加载它们的类中*`RtSuperQuickMetadata`标记它们。`XmlElement`

 *所以，作为一个例子，你的`RtSuperQuickMetadata`类应该是这样的：

```
@XmlRootElement(name = "contentFiles")
class RtSuperQuickMetadata
{
    private List<RtSuperQuickMetadataItem> rtSuperQuickMetadataItems;

    public RtSuperQuickMetadata()
    {
        rtSuperQuickMetadataItems = new ArrayList<RtSuperQuickMetadataItem>();
    }

    @XmlElement(name = "contentFile")
    public List<RtSuperQuickMetadataItem> getRtSuperQuickMetadataItems()
    {
        return rtSuperQuickMetadataItems;
    }

    public void setRtSuperQuickMetadataItems(
            List<RtSuperQuickMetadataItem> rtSuperQuickMetadataItems)
    {
        this.rtSuperQuickMetadataItems = rtSuperQuickMetadataItems;
    }

} 
```

将这一原则转移到`alternateDocNumbers`和`citesAffected`。

* * *

如果您想查看一个示例，说明`Unmarshaller`您的 XML 如何根据您的注释进行格式化，您可以在代码中创建您的结构并使用`Marshaller`. 这是一个快速而丑陋的例子：

```
RtSuperQuickMetadata rtSuperQuickMetadata = new RtSuperQuickMetadata();

List<RtSuperQuickMetadataItem> rtSuperQuickMetadataItems = new ArrayList<RtSuperQuickMetadataItem>();
rtSuperQuickMetadata.setRtSuperQuickMetadataItems(rtSuperQuickMetadataItems);

RtSuperQuickMetadataItem item = new RtSuperQuickMetadataItem();
rtSuperQuickMetadataItems.add(item);

ArrayList<Cite> cites = new ArrayList<Cite>();
Cite cite = new Cite();
cite.setCiteStr("MyCite");
cites.add(cite);
item.setCitesAffected(cites);

Marshaller m = jaxbContext.createMarshaller();
m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
m.marshal(rtSuperQuickMetadata, System.out); 
```

这会将结果输出到`System.out`. 你可以把它放在一个文件中，无论你需要什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T14:26:56.490

我已添加此答案以解决您发布的后续问题，作为对[**cklab 给出的答案的评论**](https://stackoverflow.com/a/14715556/383861)。

> 我还有一个问题。为什么 jaxb 不自动为对象中包含的列表分配内存。为什么我们需要在构造函数中为其分配内存？

你不需要，见下文。

> 在解组这些项目时，以下内容不会保存到元数据对象中。12 我需要添加另一个元素才能生成？？

请参阅下面的映射。

**RtSuperQuick元数据**

```
import java.util.*;
import javax.xml.bind.annotation.*;

@XmlRootElement(name = "contentFiles")
public class RtSuperQuickMetadata {

    private List<RtSuperQuickMetadataItem> rtSuperQuickMetadataItems;

    @XmlElement(name="contentFile")
    public List<RtSuperQuickMetadataItem> getRtSuperQuickMetadataItems() {
        return rtSuperQuickMetadataItems;
    }

    public void setRtSuperQuickMetadataItems(
            List<RtSuperQuickMetadataItem> rtSuperQuickMetadataItems) {
        this.rtSuperQuickMetadataItems = rtSuperQuickMetadataItems;
    }

} 
```

**RtSuperQuickMetadataItem**

```
import java.util.List;
import javax.xml.bind.annotation.XmlType;

@XmlType(propOrder={"contentFileName", "title", "sourcePublicationDate", "alternateDocNumbers", "citesAffected"})
public class RtSuperQuickMetadataItem {
    private String contentFileName;
    private String title;
    private String sourcePublicationDate;
    private List<AlternateDocNumber> alternateDocNumbers;
    private List<Cite> citesAffected;

    public List<AlternateDocNumber> getAlternateDocNumbers() {
        return alternateDocNumbers;
    }

    public List<Cite> getCitesAffected() {
        return citesAffected;
    }

    public String getContentFileName() {
        return contentFileName;
    }

    public String getSourcePublicationDate() {
        return sourcePublicationDate;
    }

    public String getTitle() {
        return title;
    }

    public void setAlternateDocNumbers(
            List<AlternateDocNumber> alternateDocNumbers) {
        this.alternateDocNumbers = alternateDocNumbers;
    }

    public void setCitesAffected(List<Cite> citesAffected) {
        this.citesAffected = citesAffected;
    }

    public void setContentFileName(String contentFileName) {
        this.contentFileName = contentFileName;
    }

    public void setSourcePublicationDate(String sourcePublicationDate) {
        this.sourcePublicationDate = sourcePublicationDate;
    }

    public void setTitle(String title) {
        this.title = title;
    }

} 
```

**AlternateDocNumber**

```
class AlternateDocNumber {

    private String alternateDocNumber;

    public String getAlternateDocNumber() {
        return alternateDocNumber;
    }

    public void setAlternateDocNumber(String alternateDocNumber) {
        this.alternateDocNumber = alternateDocNumber;
    }

} 
```

**引用**

```
class Cite {

    private String cite;

    public String getCite() {
        return cite;
    }

    public void setCite(String cite) {
        this.cite = cite;
    }

} 
```*

# groovy - 我可以用 Groovy 中的 ExpandoMetaClasses 做到这一点吗？

> ID：14715384
> 
> 赞同：0
> 
> 时间：2013-02-05T19:30:45.970
> 
> 标签：groovy, metaprogramming

当从 Groovy 1.8.4 升级到 1.8.5 时，JsonSlurper 返回 BigDecimal 而不是 Json 中数字的浮点数或双精度数。例如，考虑以下 JSON 文档：

```
{"person":{"name":"Guillaume","age":33.4,"pets":["dog","cat"]}} 
```

在 Groovy 1.8.4 中，“年龄”将表示为浮点数，而在 Groovy 1.8.5+ 中，它表示为 BigDecimal。我创建了一个在底层使用 Groovy JsonSlurper 的[Java 框架](https://code.google.com/p/rest-assured/)，因此为了保持向后兼容性，我想将 JSON 数字（例如 33.4）透明地转换为浮点数或双精度数。在查看了 groovy-json 源代码后，我看到 JsonSluper 使用了 JsonToken，它在其“getValue()”方法中创建了 33.4 的 BigDecimal。此方法由 JsonSlurper 实例调用。

所以（我认为）我想做的是重写 JsonToken 类中的 getValue() 方法，让它返回一个浮点数或双精度数。这是我尝试过的：

```
 def original = JsonToken.metaClass.getMetaMethod("getValue")
    JsonToken.metaClass.getValue = {->
        def result = original.invoke(delegate)

        // Convert big decimal to float or double
        if (result instanceof BigDecimal) {
            if (result > Float.MAX_VALUE) {
                result = result.doubleValue();
            } else {
                result = result.floatValue();
            }
        }
        result
    } 
```

问题是，即使`new JsonSluper().parseText(..)`在不调用 JsonToken 中覆盖的“getValue()”之前执行了上述代码（而是调用了原始的 getValue() 方法）。但是，如果我将 JsonSlurper 类中的所有代码复制到我自己的类中，我们称之为 JsonSlurper2，并调用`new JsonSluper2().parseText(..)`“getValue()”的覆盖方法，*一切*都按预期工作。为什么是这样？我应该怎么做才能避免将 JsonSlurper 复制到我自己的班级？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:48:58.733

`JsonSlurper`是一个 Java 类，因此您无法通过`metaClass`. 请参阅[此邮件列表线程](http://groovy.329449.n5.nabble.com/Changing-metaclass-afects-Java-classes-td3355308.html)。

[这个问题](https://stackoverflow.com/questions/4035784/how-do-you-override-a-method-for-a-java-type-instance-with-groovy-meta-programmi)看起来可能有办法让你做到这一点。

# linux - 使用 grep 列出目录中的条目

> ID：14715387
> 
> 赞同：4
> 
> 时间：2013-02-05T19:30:50.363
> 
> 标签：linux, unix, grep, ls

我正在尝试列出名称仅包含大写字母的目录中的所有条目。目录需要附加“/”。

```
#!/bin/bash
cd ~/testfiles/
ls | grep -r *.* 
```

由于 grep 默认只查找大写字母（对吗？），我只是递归地在 testfiles 下的目录中搜索所有只包含大写字母的名称。

不幸的是，这不起作用。

至于附加目录，我不确定*为什么*需要这样做。有谁知道我可以从哪里开始详细解释我可以用 grep 做什么？此外如何解决我的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:51:58.607

不，grep 不仅考虑大写字母。

你的问题我有点不清楚，例如：

*   从您对 -r 选项的使用来看，您似乎想要递归搜索，但是您没有这么说。为简单起见，我假设您不需要；如果您需要递归，请考虑查看@twm 的答案。
*   您只想查找大写字母（字母）。这是否意味着您不想接受任何其他（非字母）字符，但它们对文件名有效（如数字或破折号、点等）
*   因为你没有说我*不允许*每行只有一个文件，我假设它是好的（因此使用`ls -1`）。

天真的解决方案是：

```
ls -1 | grep "^[[:upper:]]\+$" 
```

也就是说，打印所有只包含大写字母的行。在我打印的 TEMP 目录中，例如：

```
ALLBIG
LCFEM
WPDNSE 
```

但是，这将排除像`README.TXT`or之类的文件`FILE001`，根据您的要求（见上文）最有可能包含这些文件。

因此，更好的解决方案是：

```
ls -1 | grep -v "[[:lower:]]\+" 
```

也就是说，打印所有不包含小写字母的行。在我打印的 TEMP 目录中，例如：

```
ALLBIG
ALLBIG-01.TXT
ALLBIG005.TXT
CRX_75DAF8CB7768
LCFEM
WPDNSE
~DFA0214428CD719AF6.TMP 
```

最后，要“正确标记”带有尾随 '/' 的目录，您可以使用`-F`(or `--classify`) 选项。

```
ls -1F | grep -v "[[:lower:]]\+" 
```

同样，示例输出：

```
ALLBIG
ALLBIG-01.TXT
ALLBIG005.TXT
CRX_75DAF8CB7768
LCFEM/
WPDNSE/
~DFA0214428CD719AF6.TMP 
```

请注意`find`，如果您可以使用不同的输出（例如`find ! -regex ".*[a-z].*"`），则将使用不同的选项，但这将具有不同的输出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:43:49.907

确切的正则表达式取决于 ls 命令的输出格式。假设你不使用 ls 的别名，你可以试试这个：

```
ls -R  | grep -o -w "[A-Z]*" 
```

请注意，使用`-R`in ls 您将递归列出当前目录下的目录和文件。grep 选项`-o`告诉 grep 只打印文本的匹配部分。这些`-w`选项告诉 grep 只考虑整个单词的匹配。这`"[A-Z]*"`是一个只过滤大写单词的正则表达式。

请注意，此正则表达式将打印 TEST.txt 以及 TEXT.TXT。换句话说，它只会考虑由字母组成的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:51:23.567

它`ls`列出了文件，而不是`grep`，因此您需要指定要将“/”附加到目录的位置。用于`ls --classify`将“/”附加到目录。

`grep`用于处理来自`ls`（或其他一些来源，一般来说）的结果，并且只显示与您指定的模式匹配的行。它不限于大写字符。您可以将其限制为仅大写字符和“/”，`grep -E '^[A-Z/]*$`或者如果您还需要数字、句点等，则可以改为过滤掉包含小写字符的行`grep -v -E [a-z]`。

由于`grep`不是列出文件的程序，它不是您要执行递归的地方。 `ls`如果您使用 . 可以递归地列出路径`ls -R`。但是，您只会以这种方式获取文件路径的最后一个组成部分。

您可能要考虑使用`find`来处理递归。这对我有用：

`find . -exec ls -d --classify {} \; | egrep -v '[a-z][^/]*/?$'`

我应该注意，使用`ls --classify`将“/”附加到目录末尾也可能会将一些其他字符附加到它可以分类的其他类型的路径中。例如，它可以将“*”附加到可执行文件的末尾。如果这不行，但您可以单独列出目录和其他路径，这可以通过运行`find`两次来解决 - 一次用于目录，然后再次用于其他路径。这对我有用：

`find . -type d | egrep -v '[a-z][^/]*$' | sed -e 's#$#/#'`

`find . -not -type d | egrep -v '[a-z][^/]*$'`

# android - 如何在列表视图中仅获取已检查的联系人详细信息并保留未检查的联系人？

> ID：14715388
> 
> 赞同：0
> 
> 时间：2013-02-05T19:30:54.753
> 
> 标签：android, listview, checkbox, contacts

我将联系人加载到带有复选框的列表视图中，现在我想返回仅选中的联系人的详细信息，例如姓名和电话号码。我将如何获取详细信息？存储在列表视图中的详细信息（例如位置、id 等）在哪里。给出以下代码

```
String[] from = { "Name", "Phone","chkbox" };
        int[] to = { R.id.txtContactName, R.id.txtContactNumber,R.id.checkBox1 };
        ArrayList<Map<String,String>> list=buildData();
        SimpleAdapter adapter = new SimpleAdapter(this, list,
                R.layout.main, from, to);
        setListAdapter(adapter);

private ArrayList<Map<String,String>> buildData() {
        ArrayList<Map<String, String>> list = new ArrayList<Map<String, String>>();
        list.clear();
        Cursor people = getContentResolver().query(
                ContactsContract.Contacts.CONTENT_URI, null, null, null,
                "UPPER(" + ContactsContract.Contacts.DISPLAY_NAME + ") ASC");
        while (people.moveToNext()) {
            String contactName = people.getString(people
                    .getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
            String contactId = people.getString(people
                    .getColumnIndex(ContactsContract.Contacts._ID));
            String hasPhone = people
                    .getString(people
                            .getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER));
            if ((Integer.parseInt(hasPhone) > 0)) {
                Cursor phones = getContentResolver().query(
                        ContactsContract.CommonDataKinds.Phone.CONTENT_URI,
                        null,
                        ContactsContract.CommonDataKinds.Phone.CONTACT_ID
                                + " = " + contactId,
                        null,
                        "UPPER(" + ContactsContract.Contacts.DISPLAY_NAME
                                + ") ASC");
                while (phones.moveToNext()) {
                    String phoneNumber = phones
                            .getString(phones
                                    .getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
                    Map<String, String> NamePhoneType = new HashMap<String, String>();
                    NamePhoneType.put("Name", contactName);
                    NamePhoneType.put("Phone", phoneNumber);
                    list.add(NamePhoneType);
                     aa=contactName;
                     bb=phoneNumber;
                }
                phones.close();
            }
        }
        people.close();
        return list;
    }

@Override
    protected void onListItemClick(ListView l, View v, int position, long id) {

        super.onListItemClick(l, v, position, id);
        CheckBox checkbox = (CheckBox) v.findViewById(R.id.checkBox1); 

        if (checkbox.isChecked() == false) {
            checkbox.setChecked(true); 
           int aaa=l.getCheckedItemPosition();

        } else {
            checkbox.setChecked(false); 
        }

    } 
```

xml代码

主要 XML

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/linearLayout1"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:paddingBottom="5.0px"
android:paddingLeft="5.0px"
android:paddingTop="5.0px" >

<TextView
android:id="@+id/txtContactName"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_marginLeft="15.0dip"
android:layout_toLeftOf="@+id/checkBox1"
android:layout_alignParentLeft="true"
android:text="Medium Text"
android:textAppearance="?android:textAppearanceMedium" />

<TextView
android:id="@+id/txtContactNumber"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_below="@+id/txtContactName"
android:layout_alignParentLeft="true"
android:layout_marginLeft="15.0dip"
android:layout_toLeftOf="@+id/checkBox1"
android:text="Small Text"
android:textAppearance="?android:textAppearanceSmall" />

<CheckBox
android:id="@+id/checkBox1"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_alignParentRight="true"
android:layout_marginRight="10dp"
android:clickable="false"
android:focusable="false"
android:focusableInTouchMode="false" />

</RelativeLayout> 
```

活动控制 xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout
xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<Button
android:id="@+id/btnShow"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:text="Show Selected" />

<ListView
android:id="@android:id/list"
android:layout_width="fill_parent"
android:layout_height="match_parent"
android:clickable="true"
android:layout_below="@+id/btnShow" >
</ListView>
</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T06:00:35.467

首先，我想建议您应该扩展`getView`列表适配器的方法（阅读该方法），并在此范围内对我的建议做一些变化，但只是为了让您摆脱困境，这是一种合并的方法这进入你的代码。我肯定会推荐使用更具描述性的变量名:)

同时：

如果您想要在任何给定时间点已检查的所有人员（及其人数）的列表，则维护一个单独的实例变量可能是有意义的`ArrayList`- 类似的东西`mCheckedContacts`被添加到复选框被选中. 我会创建一个简单的类`ContactInformation`来放入`ArrayList`.

```
public class ContactInformation {
  private String mName;
  private String mPhoneNumber;

  //make some getters and setters, a constructor, and an equals method!
} 
```

确保实现该 .equals 方法，因为下面的代码依赖于它（请参阅：http: [//developer.android.com/reference/java/util/ArrayList.html#remove(java.lang.Object)](http://developer.android.com/reference/java/util/ArrayList.html#remove(java.lang.Object))以供参考）。现在您可以拥有以下内容`ArrayList`：

```
ArrayList<ContactInformation> mCheckedContactsInformation = new ArrayList<ContactInformation>(); 
```

这可以添加到您的代码中，并且您可以在此列表中添加和删除联系人。

```
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
  super.onListItemClick(l, v, position, id);
  CheckBox checkbox = (CheckBox) v.findViewById(R.id.checkBox1); 
  String name = (TextView) v.findViewById(R.id.txtContactName); 
  String phoneNumber = (TextView) v.findViewById(R.id.txtContactNumber); 

  checkbox.setOnCheckedChangedListener(
    new OnCheckedChangedListener() {
      public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
        ContactInformation curContactInfo = new ContactInformation(name, phoneNumber);
        if (isChecked) mCheckedContactsInformation.add(curContactInfo);
        //And this is why you need to implement a .equals method!
        else mCheckedContactsInformation.remove(curContactInfo);
      }
  }

  checkbox.setChecked(! checkbox.isChecked());
} 
```

现在您应该能够利用该 ArrayList 来获取您需要的信息。

* * *

**编辑**：根据您自己的回答，您可能需要对其中一些主题进行进一步解释。

**类**：一个类*必须*有一个构造函数。构造函数是实例化对象的方式。每当您拨打这样的电话时：

```
Object o = new Object(int thisCouldBeAnyTypeOfParameter); 
```

您正在调用`Object`类中的方法，如下所示：

```
public Object(int thisCouldBeAnyTypeOfParameter) {
  //here is some initialization code that someone wrote, or nothing...
  //but this method NEEDS to exist!

  //And if a parameter is passed, like the int above, then it is probably used to init something
} 
```

有关更多信息（可能还有更好的解释）[，请直接从源代码中查看此信息](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)。因此，当您收到此错误时：

> 构造函数 ContactInformation(String, String) 未定义

这很可能在线上发生：

```
ContactInformation curContactInfo = new ContactInformation(name, phoneNumber); 
```

为什么？*因为您尚未在接受两个 Strings 的类中创建构造函数*。你得到的错误实际上几乎就是正在发生的问题。我建议您搜索这些类型的错误并花时间阅读您找到的结果。不幸的是，这些东西需要时间来学习，虽然有人会帮助你，但大部分工作都必须由你完成，*你*只需花费数小时阅读和编码，阅读和编​​码。

您收到的下一个错误：

> 类型不匹配：无法从 TextView 转换为 String

想想发生这种情况的代码行：

```
String name = (TextView) v.findViewById(R.id.txtContactName); 
```

左边是一个字符串，期望返回一个字符串。在右侧，您没有返回字符串。对于此类问题，查看 Android 文档会有所帮助。例如，`findViewById()`函数......它返回什么？您正在将结果类型（即 a `View`）转换为 a`TextView`类型的 Object `TextView`。这不是字符串，因此您会收到错误，因为您试图将`TextView`对象分配给`String`. 这是有道理的，因为它们是不同的类型，所以这不起作用。在这种情况下，您需要做一些额外的工作才能将字符串（存储在 TextView 对象中）从对象中取出，以便将其分配给字符串。我将把这个额外的工作留给你来确定，但是在谷歌上搜索“textview android”，点击第一个链接，然后查看所有可以在 TextView 上调用的方法。我打赌你会找到一个返回字符串的:)

希望这可以帮助。很抱歉这么啰嗦/说教，但我只是想帮忙。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-01T12:26:18.820

```
 String[] from = { "Name", "Phone","chkbox" };
        int[] to = { R.id.txtContactName, R.id.txtContactNumber,R.id.checkBox1 };
        ArrayList<Map<String,String>> list=buildData();
        SimpleAdapter adapter = new SimpleAdapter(this, list,
                R.layout.main, from, to);
        setListAdapter(adapter);

    }

    private ArrayList<Map<String,String>> buildData() {
        ArrayList<Map<String, String>> list = new ArrayList<Map<String, String>>();
        list.clear();
        Cursor people = getContentResolver().query(
                ContactsContract.Contacts.CONTENT_URI, null, null, null,
                "UPPER(" + ContactsContract.Contacts.DISPLAY_NAME + ") ASC");
        while (people.moveToNext()) {
            String contactName = people.getString(people
                    .getColumnIndex(ContactsContract.Contacts.DISPLAY_NAME));
            String contactId = people.getString(people
                    .getColumnIndex(ContactsContract.Contacts._ID));
            String hasPhone = people
                    .getString(people
                            .getColumnIndex(ContactsContract.Contacts.HAS_PHONE_NUMBER));
            if ((Integer.parseInt(hasPhone) > 0)) {
                Cursor phones = getContentResolver().query(
                        ContactsContract.CommonDataKinds.Phone.CONTENT_URI,
                        null,
                        ContactsContract.CommonDataKinds.Phone.CONTACT_ID
                                + " = " + contactId,
                        null,
                        "UPPER(" + ContactsContract.Contacts.DISPLAY_NAME
                                + ") ASC");
                while (phones.moveToNext()) {
                    String phoneNumber = phones
                            .getString(phones
                                    .getColumnIndex(ContactsContract.CommonDataKinds.Phone.NUMBER));
                    Map<String, String> NamePhoneType = new HashMap<String, String>();
                    NamePhoneType.put("Name", contactName);
                    NamePhoneType.put("Phone", phoneNumber);
                    list.add(NamePhoneType);
                    aa=contactName;
                     bb=phoneNumber;
                }
                phones.close();
            }
        }
        people.close();
        return list;
    }

    ArrayList<ContactInformation> mCheckedContactsInformation = new ArrayList<ContactInformation>();

    @Override
    protected void onListItemClick(ListView l, View v, int position, long id) {

        super.onListItemClick(l, v, position, id);

        CheckBox checkbox = (CheckBox) v.findViewById(R.id.checkBox1); 
        // String name = (TextView) v.findViewById(R.id.txtContactName);
        TextView tvv1=(TextView) findViewById(R.id.txtContactName);
        TextView tvv2=(TextView) findViewById(R.id.txtContactNumber);
        final String name=tvv1.getText().toString();
        final String phoneNumber=tvv2.getText().toString();

checkbox.setOnCheckedChangeListener(new OnCheckedChangeListener() {

@Override
public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) {
    ContactInformation curContactInfo = new ContactInformation(name, phoneNumber);
    if (isChecked) mCheckedContactsInformation.add(curContactInfo);
    //And this is why you need to implement a .equals method!
    else mCheckedContactsInformation.remove(curContactInfo);

}
}); 
```

联系信息类代码

```
private String name;
private String phoneNo;
//private boolean selected;

public String getName() {
    return name;

}
public void setName(String name) {
    this.name = name;
     //selected = false;
}
public String getPhoneNo() {
    return phoneNo;
}
public void setPhoneNo(String phoneNo) {
    this.phoneNo = phoneNo;
}

/*public boolean isSelected() {
    return selected;
  }

  public void setSelected(boolean selected) {
    this.selected = selected;
  }*/ 
```

在这里我收到错误-构造函数ContactInformation（String，String）未定义..当我使用`String name = (TextView) v.findViewById(R.id.txtContactName);` 时我收到错误-类型不匹配：无法从TextView转换为字符串...我也可以使用布尔选择的方法我已经评论而不是您建议的 .equals 方法？

# jquery - 使用 url 链接到 javascript 动画

> ID：14715389
> 
> 赞同：0
> 
> 时间：2013-02-05T19:31:02.893
> 
> 标签：jquery, html

我有一个包含很多隐藏内容的页面，我使用 jQuery 将其动画化。例如，我有一个主页，其中包含带有 # 作为 href 的链接，单击时我将匹配的 div 动画到该链接并将其动画化到视图中。

我想有一种方法可以直接从 url 访问这些 div。目前我正在使用一些 javascript 代码来为与 div 匹配的 a 标签的点击设置动画。例如，假设我想单击`<a>`id 的 am 标签`aboutus`。我的 url 变成`www.myurl.com/homepage.aspx#aboutus`了，然后 javascript 在 # 之后获取所有内容并单击该标签，然后单击该标签并为我想要的 div 设置动画但是，我想要一些可以引用的东西，例如`www.myurl.com/aboutus`。

我考虑为每个 div 创建一个文件夹，并放置一个主页的副本，并显示想要的 div，但我认为这不是解决问题的最有效方法。有没有人有任何好主意来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:44:10.797

`.htaccess`如果您在 Apache 网络服务器上托管，请在与您的内容相同的文件夹中创建以下文件：

```
<IfModule mod_rewrite.c>
  # Enable rewrite engine
  RewriteEngine on

  # If the condition "file does not exist"…
  RewriteCond %{REQUEST_FILENAME} !-f
  # or the condition "directory does not exist"…
  RewriteCond %{REQUEST_FILENAME} !-d
  # rewrite the request as if it came from index.php
  RewriteRule ^ index.php [L]
</IfModule> 
```

对于 IIS 服务器，请尝试以下`web.config`文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <rewrite>
      <rules>
        <!-- Rewrite URLs of the form 'x' to the form 'index.php?q=x'. -->
        <rule name="Short URLs" stopProcessing="true">
          <match url="^(.*)$" ignoreCase="false" />
          <conditions>
            <add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" />
            <add input="{REQUEST_FILENAME}" matchType="IsDirectory" ignoreCase="false" negate="true" />
          </conditions>
          <action type="Rewrite" url="index.php?q={R:1}" appendQueryString="true" />
        </rule>
      </rules>
    </rewrite>

    <httpErrors>
      <remove statusCode="404" subStatusCode="-1" />
      <error statusCode="404" prefixLanguageFilePath="" path="/index.php" responseMode="ExecuteURL" />
    </httpErrors>

    <defaultDocument>
      <!-- Set the default document -->
      <files>
        <remove value="index.php" />
        <add value="index.php" />
      </files>
    </defaultDocument>
  </system.webServer>
</configuration> 
```

两种配置都松散地基于[Drupal 7](http://drupalcode.org/project/drupal.git/tree)配置文件。他们将向您的网络服务器发出与实际文件或目录（例如 /about-us）不匹配的所有请求，实际上返回输出（如果您正在提供静态 HTML 文件，则`index.php`可以将其放在那里）。`index.html`这一切都发生在服务器端……最终用户在输入 URL 时仍会看到该 URL ( [http://yourdomain.com/about-us](http://yourdomain.com/about-us) )。您可以使用 Javascript (as ) 捕获该 URL，`location.href`并执行您需要执行的任何显示更改。

# oracle-apex - 使用 URL 将文本字段值传递到弹出页面

> ID：14715395
> 
> 赞同：1
> 
> 时间：2013-02-05T19:31:26.463
> 
> 标签：oracle-apex

我正在尝试使用 URL 将文本字段的值从一个页面传递到另一个页面，但失败得很惨。

原因如下：我有一个显示机器属性的顶点页面（品牌、型号、它生产的产品、机器 ID (:P1_INPUT)）。有些机器只能生产一种产品，有些机器可以生产多种产品。

我使用查询完成以下：如果机器只生产一种产品，产品编号显示在:P1_item。如果一台机器可以生产多个产品，它会在 :P1_item 中显示世界“多个”。

我想建立点击 :P1_Item 旁边的按钮的能力，如果显示“多个”，则会出现一个弹出窗口，其中包含机器制造的产品。我有弹出位工作，但它没有将我的：P1_INPUT 从页面传递到弹出页面文本字段：P3_OUPUT 我在按钮上有以下代码，所以当它被点击时，它会打开一个弹出页面（这有效）并且应该使用从 P1_INPUT 传递的值填充文本字段 (P3_OUTPUT)（这不起作用）。

我的按钮设置为重定向到 URL，我在 URL 目标中有这个。

```
javascript:popupURL('f?p=&APP_ID.:HELLOWORLD:&SESSION.:::&P3_OUTPUT.:&P1_INPUT.') 
```

我不能使用分支，因为我不希望显示机器属性的主页提交。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:38:43.530

你的 URL 是错误的: `f?p=&APP_ID.:HELLOWORLD:&SESSION.:::&P3_OUTPUT.:&P1_INPUT.`: 你想为项目提供一个值，`P3_OUTPUT`而你已经设置`&P3_OUTPUT.`了一个替换字符串，并将值放入`P3_OUTPUT`字符串中。
您需要将 URL 设置为`f?p=&APP_ID.:HELLOWORLD:&SESSION.::::P3_OUTPUT:&P1_INPUT.`，这将正确设置 的值`P3_OUTPUT`并在会话标识符和 arguments-values 对之间添加一个额外的分号。

# javascript - 对于 508 兼容页面上的 javascript 链接，HREF 属性应该是什么？

> ID：14715397
> 
> 赞同：5
> 
> 时间：2013-02-05T19:31:29.120
> 
> 标签：javascript, anchor, href, section508

我知道这个问题： [我应该为 JavaScript 链接使用哪个“href”值，“#”还是“javascript:void(0)”？](https://stackoverflow.com/questions/134845/href-attribute-for-javascript-links-or-javascriptvoid0)包含关于 javascript 链接的正确 href 内容的讨论。这与 508 合规性有何关系？当单击处理程序在 javascript 代码的其他地方定义时，有谁知道 javascript:void(0) 是否可以接受？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:13:14.687

这就是术语变得重要的地方——就可访问性而言，没有“javascript 链接”之类的东西。有一些链接，它们是纯粹的锚元素，还有一些 javascript 行为，应该假定它们不可运行以实现可访问性。

触发 javascript 的空锚元素（例如 href='#' onclick='...'）不是链接，它是用于触发页面行为的 UI 元素。对于可访问性，不要为此滥用锚元素，请使用具有正确 ARIA 角色的真实 UI 元素。

对于点击链接（执行类似“单击锚点”->“调用魔法 JS”->“window.location 更改为某个新页面”之类的操作），请注意您在语义上歪曲了您的内容。即使您使用的是锚元素，您也不能将其用作链接，因为它不是另一个资源的锚。就像上面的例子一样，它实际上是一个按钮。页面位置最后发生变化的事实并没有改变这一点。

要获得真正的可访问性，您将不得不放弃任何 JavaScript-in-the-middle。但别担心，这远没有听起来那么严重：最简单的解决方案是改用重新路由链接。如果您曾经使用过google.com 或duckduckgo.com 等，那么您将对此很熟悉：与其链接到实际的URL，不如链接到通过无页面脚本代理的URL。您可以保证 URL 为“ [http://our.domain.com/ref=http://the.actual.link.to.visit](http://our.domain.com/ref=http://the.actual.link.to.visit) ”的锚点最终会很好地重定向到实际站点，而您当您解决重定向时，可以将“当人们单击”作为服务器端操作执行的任何所需操作。

如果您认为自己依赖 JavaScript，那么 508 合规性将很难。所以对于可访问性：积极尝试不要。如果可以使用它，请丰富它，确保没有它仍然可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:11:47.627

我基本上同意迈克的观点。

> 这与 508 合规性有何关系？

关于第 508 节的一个常见误解是“哦，我使用 JAWS（或者可能是 NVDA）运行我的网站，并且很好。所以我是合规的。” 第 508 节理论上应该涵盖*所有*残疾，而不仅仅是失明。当您对繁重的 JavaScript 感到疑惑时，代理机构倾向于使用“软件应用程序和操作系统”(1194.21) 标准以及“基于 Web 的内部网和互联网信息和系统”(1194.22)，因为它们更多地谈论 UI 元素。不幸的是，像 WebAIM 这样的地方否认了这一点。

因此，当包含 1194.21 时，标准可以更容易地理解为“您将所有 @alts 和`<label>`s 都打开，但是这个站点/应用程序/系统可以使用键盘吗？AKA 是键盘可导航的吗？” 你能找到`<span>`那个看起来像一个链接的东西吗？

正如 Mke 所说，帮助解决此问题的一种方法是使用 ARIA。所以，`<span>`现在必须是：

```
<span onclick="Clicky()" role="link">Link</span> 
```

（参考：[MDN](https://developer.mozilla.org/en-US/docs/Accessibility/ARIA/ARIA_Techniques/Using_the_link_role)）

现在回到你的问题：

> 我知道这个问题：JavaScript 链接的 Href 属性：“#”还是“javascript:void(0)”？当单击处理程序在 javascript 代码的其他地方定义时，有谁知道 javascript:void(0) 是否可以接受？

我会提倡 void，因为当没有定义引用（认为它称为页内引用）时，焦点会回到浏览器框架，而不是停留在链接上。您需要编写一些处理程序来将焦点返回到链接。

# jquery - 更快更优化的方法？

> ID：14715401
> 
> 赞同：0
> 
> 时间：2013-02-05T19:31:35.783
> 
> 标签：jquery, optimization

有没有更快更优化的方法来实现这一点？

```
if (window.location.href.indexOf('/search/?') >= 0) {
    if ($.cookie("Layout") == "Poster") {
        $("link").attr("href", "../css/list.css");
    } else if ($.cookie("Layout") == "Poster") {
        $("link:first").attr("href", "css/list.css");
    }
}

if (window.location.href.indexOf('/search/?') >= 0) {
    if ($.cookie("Layout") == "Description") {
        $("link").attr("href", "../css/desc.css");
    } else if ($.cookie("Layout") == "Description") {
        $("link:first").attr("href", "css/desc.css");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:40:54.700

`else if`我看到您实际上正在测试与子句中的原始条件相同的东西。这是多余的。条件永远不会执行，`else if`因为您在`else`同一个条件表达式的子句中（只是想一想就让自己感到困惑）..

```
if ($.cookie("Layout") == "Poster") {
  ...
}else if ($.cookie("Layout") == "Poster") { ... } 
```

这应该对你大喊大叫……第二个 if 语句永远不会执行……

您可能想要做的是使用`switch`声明。类似的东西——

```
if (window.location.href.indexOf('/search/?') >= 0) { 
    switch($.cookie("Layout")){
       case "Layout" :
         // behavior for "Layout"
       break;
       case "Description" : 
         // behavior for "Description"
       break;
       default : 
         // behavior for unknown $.cookie("Layout") value
       break;
    }
} 
```

# php - 将 PHP 会话变量插入 MySQL 数据库

> ID：14715403
> 
> 赞同：1
> 
> 时间：2013-02-05T19:31:47.740
> 
> 标签：php, forms, session

我的 PHP 代码有问题。我正在尝试使用稍后在表单中需要的两个会话变量将数据插入到 mysql 数据库中。但是，每当我提交表单时，都会返回“'字段列表'中的未知列”错误。代码很长，但您可能需要全部代码才能理解问题。

```
 <?php
        session_start();
// Check for hazards and put them in an array if there is one selected
if($_SERVER['REQUEST_METHOD'] == 'POST') {
require ('../mysqli_connect.php'); //connect to the db

//Check for offender first name
if (empty($_POST['pris_firstname'])) {
$errors[] = 'You forgot to enter offender first name.';
    } else {
        $prisf=$_POST['pris_firstname'];
    }   

//Check for offender last name
if (empty($_POST['pris_lastname'])) {
$errors[] = 'You forgot to enter offender last name.';
    } else {
        $prisl=$_POST['pris_lastname'];
    }           

//Check for offender date of birth
$dob = ($_POST['pris_dateofbirth']);

//Check for offender phone number
if (empty($_POST['pris_phonenum'])) {
$errors[] = 'You forgot to enter offender Phone Number.';
    } else {
        $prisphone=trim($_POST['pris_phonenum']);
    }           

//Check for offender address
if (empty($_POST['pris_address'])) {
$errors[] = 'You forgot to enter offender Address.';
    } else {
        //$prisaddress=trim($_POST['pris_address']);
        foreach($_POST["pris_address"] as $value) { 
        $prisaddress .= $value . '\n'; 
    } 
    }   

//Check for offender next of kin first name
if (empty($_POST['pris_kinfirstname'])) {
$errors[] = 'You forgot to enter next of kin first name.';
    } else {
        $kinfirst=trim($_POST['pris_kinfirstname']);
    }   

//Check for offender next of kin last name
if (empty($_POST['pris_kinlastname'])) {
$errors[] = 'You forgot to enter next of kin last name.';
    } else {
        $kinlast=trim($_POST['pris_kinlastname']);
    }           

//Check for offender next of kin phone number
if (empty($_POST['pris_kinphone'])) {
$errors[] = 'You forgot to enter next of kin area code.';
    } else {
        $kinphone=trim($_POST['pris_kinphone']);
    }           

if (empty($_POST['pris_kinrelation'])) {
$errors[] = 'You forgot to enter next of kin relation.';
    } else {
        $kinrelation=trim($_POST['pris_kinrelation']);
    }

//Check for offender next of kin address
if (empty($_POST['pris_kinaddress'])) {
$errors[] = 'You forgot to enter next of kin street address.';
    } else  {
                foreach($_POST["pris_kinaddress"] as $value2) { 
                $kinaddress .= $value2 . '\n'; 
            } 
            }                   
if (empty($errors)) { //if everyhing is ok
$q = "INSERT INTO prisoner_profile (pris_status, 
                                    pris_firstname, 
                                    pris_lastname, 
                                    pris_dateofbirth, 
                                    pris_phonenum, 
                                    pris_address, 
                                    pris_kinfirstname, 
                                    pris_kinlastname, 
                                    pris_kinphone, 
                                    pris_kinaddress, 
                                    pris_kinrelation
                                    ) VALUES (
                                    '$status', 
                                               ".$_SESSION['pris_firstname'].",  ".$_SESSION['pris_lastname'].",
                                    '$dob', 
                                    '$prisphone', 
                                    '$prisaddress', 
                                    '$kinfirst', 
                                    '$kinlast', 
                                    '$kinphone', 
                                    '$kinaddress', 
                                    '$kinrelation'
                                    )"; 
$r = @mysqli_query ($dbc, $q); //Run the query. 
```

希望有人能帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:35:52.293

该错误几乎是不言自明的，这意味着您的数据库中的列名错误。我建议您仅针对这种情况回显您的查询错误：

`$r = mysqli_query ($dbc, $q) or die (mysqli_error());`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:35:25.460

您的语句中列出的列之一`INSERT`实际上并不存在于`prisoner_profile`. 检查您的表架构。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:37:29.403

我在这里看到的一个明显问题是您没有处理查询中的转义字符，并且您`\n`在代码中使用了一些字符。

用于`mysqli_real_escape_string`在将数据输入数据库时​​进行处理。

就像是

```
$q = mysqli_real_escape_string($q); 
```

# php - 将 Slim 从 HTML/CSS/JS 中分离出来

> ID：14715406
> 
> 赞同：0
> 
> 时间：2013-02-05T19:32:14.797
> 
> 标签：php, .htaccess, rest, slim

所以我对如何在我的用例中正确实施 Slim 框架感到困惑。

我有一个 web 应用程序 html/css/javascript，其中不能包含 PHP。

我想做的就是使用 Slim 通过 ajax 做一些简单的 GET 请求。

如果从未在 index.html 文件中触及请求，我该如何启动应用程序来处理请求？

我猜这与 .htacess 文件有关，但在我的初始搜索中没有找到任何有用的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:14:35.023

从 Slim 讨论板获得了一些帮助。

这是答案和示例。

是的，.htaccess 文件确保任何请求都由单个文件处理（通常是 index.php，但您可以将其命名为任何您想要的名称）。

您的 Ajax 调用可能会转到不同的 URL。这些请求都将由 Slim 应用程序处理。

[示例在这里](http://clintberry.com/2012/backbone-js-apps-authentication-tutorial/)

# c# - C# Sql CTE 查询 - 选择额外信息

> ID：14715410
> 
> 赞同：2
> 
> 时间：2013-02-05T19:32:22.547
> 
> 标签：c#, sql, sql-server-2008, common-table-expression

我正在尝试编写一个 CTE 递归查询来构建具有“marketGroupID”（该元素的 ID）和“parentGroupID”（元素的父 ID）的平面表的树关系。每个 'marketGroup' 可以有任意数量的子 'marketGroups' 等等。

这是我的工作查询（在 Sql Server Management 中测试）：

```
 With cte As
(SELECT [marketGroupID]
      ,[parentGroupID]
      ,[marketGroupName]
      ,[description]
      ,[iconID]
      ,[hasTypes]
      , 0 As Level
  FROM [Eve_Retribution_1.0.7].[dbo].[invMarketGroups]
  WHERE [parentGroupID] IS NULL
  UNION All
  Select mg.marketGroupID
    ,mg.parentGroupID
    ,mg.marketGroupName
    ,mg.description
    ,mg.iconID
    ,mg.hasTypes
    ,c.Level + 1 As Level
  FROM [Eve_Retribution_1.0.7].dbo.invMarketGroups mg
  Inner Join cte c On mg.parentGroupID = c.marketGroupID
  WHERE mg.marketGroupID <> mg.parentGroupID
)
  SELECT marketGroupID
    ,parentGroupID
    ,marketGroupName
    ,description
    ,iconID
    ,hasTypes
    , Level
  FROM cte 
```

此查询以正确的顺序正确列出了元素，并且 Level 参数旨在用于从元素构建树。

将其翻译成 C# 是我遇到的问题。我已经集成了这个数据库，并且所有相应的表都从我的数据库自动构建到我的代码中。我尝试使用 C# 调用此查询，如下所示：

```
 EveOnlineClassesDataContext context = new EveOnlineClassesDataContext();
    IEnumerable<invMarketGroup> results = context.ExecuteQuery<invMarketGroup>
            (@"**ABOVE QUERY**"); 
```

其中“invMarketGroup”类是由 O/R 设计器自动创建的类。我的问题是我无法访问每个“marketGroup”的 Level 参数，因为它不是表本身的一部分，并且在提供的类中没有元素。

我想从查询中检索实际的“invMarketGroup”类对象和对应于每个对象的级别，以便我可以在内存中构建一棵树来表示这个结构。我该怎么做呢？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:35:56.500

使用该查询在数据库中创建[视图](http://msdn.microsoft.com/en-us/library/ms187956.aspx) 可能更容易：`vwInvMarketGroup`

```
CREATE VIEW vwInvMarketGroup AS
    With cte As
(SELECT [marketGroupID]
      ,[parentGroupID]
      ,[marketGroupName]
      ,[description]
      ,[iconID]
      ,[hasTypes]
      , 0 As Level
  FROM [Eve_Retribution_1.0.7].[dbo].[invMarketGroups]
  WHERE [parentGroupID] IS NULL
  UNION All
  Select mg.marketGroupID
    ,mg.parentGroupID
    ,mg.marketGroupName
    ,mg.description
    ,mg.iconID
    ,mg.hasTypes
    ,c.Level + 1 As Level
  FROM [Eve_Retribution_1.0.7].dbo.invMarketGroups mg
  Inner Join cte c On mg.parentGroupID = c.marketGroupID
  WHERE mg.marketGroupID <> mg.parentGroupID
)
  SELECT marketGroupID
    ,parentGroupID
    ,marketGroupName
    ,description
    ,iconID
    ,hasTypes
    , Level
  FROM cte
GO 
```

然后你可以使用这个：

```
IEnumerable<invMarketGroup> results = context.ExecuteQuery<invMarketGroup>(@"SELECT * FROM vwInvMarketGroup"); 
```

# android - Android 谷歌地图 v2 永久标记信息窗口

> ID：14715414
> 
> 赞同：1
> 
> 时间：2013-02-05T19:32:56.220
> 
> 标签：android, google-maps

如果标记所在的地图或标记本身被点击，InfoWindow 的默认行为是隐藏。

有什么方法可以使 InfoWindow 永久化，这样你就不能隐藏它了？

我已禁用地图中的所有手势，但点击时 InfoWindow 仍会消失。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-12T11:12:01.847

visceralG 的解决方案是我首先要做的，但也有（未经测试的）替代方案：

*   保留对显示信息窗口的标记的引用（来自`getInfoContents`）
*   `onMapClick`呼吁`markerShowingInfoWindow.showInfoWindow()`强制它回来
*   如果上述方法不起作用，请将其`markerShowingInfoWindow.showInfoWindow()`放入`Runnable.run()`并使用`Handler`or发布`View`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-10T17:39:28.537

不是我知道的。最好的办法是为包含绘制的“信息窗口”的地图标记创建自己的自定义图标。然后，它需要在图标位图的 infoWindow 部分进行一些自定义绘图，以产生与普通 infoWindow 相同的效果，但实现起来并不太糟糕。不像您正在寻找的解决方案那么容易，但它会带您到达您想去的地方。希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-20T07:09:24.387

假设您已经知道如何设置信息窗口，这些行将使您的信息窗口，对于任何一个标记，都是永久的：

```
 final Marker myMarker = mGoogleMap.addMarker(mDriverMarker);

    myMarker.showInfoWindow();

    mGoogleMap.setOnMapClickListener(new GoogleMap.OnMapClickListener() {
        @Override
        public void onMapClick(LatLng latLng) {
            myMarker.showInfoWindow();
        }
    });

    mGoogleMap.setOnMarkerClickListener(new GoogleMap.OnMarkerClickListener() {
        @Override
        public boolean onMarkerClick(Marker marker) {
            myMarker.showInfoWindow();
            return true;
        }
    }); 
```

# html - 使 DIV 可点击

> ID：14715416
> 
> 赞同：0
> 
> 时间：2013-02-05T19:32:57.677
> 
> 标签：html, css

我被指示在 DIV 周围包裹一个锚标记，以使以下 PHP 可点击。我的直觉是，这是一个坏主意，因为它对 SEO 无效且不利，因此我们可以完全摒弃这个想法 - 无需根据该建议来回产生。那么让“box-wrap”DIV中的所有内容指向链接的正确方法是什么？

```
<div class="box-wrap">
    <div class="box">
        <header>            
            <h2 class="entry-title"><a href="<?php the_permalink(); ?>" title="<?php the_title(); ?>"><?php the_title(); ?></a></h2>
            <?php echo get_the_term_list( $post->ID, 'categories', '<h3 class="entry-by">' . __('Posted In: ', 'okay'), ', ', '</h3>' ); ?>
        </header>
    </div><!-- box -->
</div><!-- box wrap --> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:35:47.810

[从 HTML5 开始](http://dev.w3.org/html5/markup/a.html#a-changes)，您*可以*合法地将其包装在`<a>`. 在您的示例中，只需将外部 div 替换为`a`标签。

```
<a class="box-wrap" href="...">
    <div class="box">
        <!-- ... -->
    </div>
</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:36:32.887

如果你想让你的 div “可点击”，你应该使用 javascript：

```
$("#clickableDivId").click(function() {
    window.location = "your url";
}); 
```

您还可以将 css 样式添加`cursor: pointer;`到您的 div 看起来像锚。

# entity-framework - 实体框架优化包含，提供包含提示

> ID：14715422
> 
> 赞同：2
> 
> 时间：2013-02-05T19:33:17.480
> 
> 标签：entity-framework, entity-framework-4, entity-framework-5

是否可以为 Include linq 查询提供提示，以便优化子表的连接？

我有一个非常通用的数据模型，因此表之间存在多个引用约束。我正在使用一个遗留系统，所以改变它会非常困难。

我有一个类似下面的查询，它会生成非常复杂的 SQL 查询。

```
var links = A.B.CreateSourceQuery()
                            .Include("B1")
                            .Include("B1.C1")
                            .Include("B1.D1")
                            .ToArray(); 
```

有没有办法为上述查询提供提示，关于如何加入各个子实体，以便生成的 SQL 更加优化和高效，并且可以预先加载数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:07:01.857

请参阅我在[http://www.thinqlinq.com/Post.aspx/Title/LINQ-to-Database-Performance-hints](http://www.thinqlinq.com/Post.aspx/Title/LINQ-to-Database-Performance-hints)上的帖子，尤其是关于分解复杂查询的要点。如果您要获取两组孙子，您的表现可能会受到影响。您可能需要考虑自定义投影而不是多个包含。

# android - 主要活动 layoutInflater，活动不启动

> ID：14715423
> 
> 赞同：0
> 
> 时间：2013-02-05T19:33:23.520
> 
> 标签：android, layout, main, layout-inflater

当我按下 plbutton1 时，我没有得到结果。
当我点击 plbutton2 时，活动 R.layout.paraggeleia 打开 corect。
谁能帮我？
我在哪里做错了？这是我的代码！！！！

```
 public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {

        Bundle args = getArguments();
        switch (args.getInt(ARG_SECTION_NUMBER)){

        case 1: 
            View v = inflater.inflate(R.layout.paraggeleia, container, false);
            Button bTutorial = (Button) v.findViewById(R.id.plbutton2);
            bTutorial.setOnClickListener(new View.OnClickListener(){
                 public void onClick(View v){
                  getActivity().startActivity(new Intent (getActivity(), parageleiaproionta.class));

                  Toast.makeText(v.getContext(), "Loaging Προιόντα", Toast.LENGTH_SHORT).show();

                 }
             });
     return v;

        case 2:
            View m =  inflater.inflate(R.layout.paraggeleia, container, false);

             Button b1Tutorial = (Button) m.findViewById(R.id.plbutton1);
            b1Tutorial.setOnClickListener(new View.OnClickListener(){
                  public void onClick(View m){
                   getActivity().startActivity(new Intent (getActivity(), sxetika.class));

                   Toast.makeText(m.getContext(), "Loaging Προιόντα", Toast.LENGTH_SHORT).show();

                  }
              });
      return m;

    }

        return getView();

}

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:43:49.277

也许是因为你有 switch 并且只会处理第二个语句。

# javascript - 使用与其他变量相同的变量加载脚本并覆盖

> ID：14715424
> 
> 赞同：0
> 
> 时间：2013-02-05T19:33:30.910
> 
> 标签：javascript, jquery, cordova, jquery-mobile

我正在为两种不同的语言使用 2 个不同的 javascript 文件，1 个文件调用 lang.en.js 是英文，另一个是 lang.es.js，两个文件都包含相同的变量，例如：lang.es.js

```
var messages: {
    settings: {
        settings: "Opciones",
        language: "Idioma"
    }
} 
```

语言.en.js

```
var messages: {
    settings: {
        settings: "Settings",
        language: "Language"
    }
} 
```

所以起初我的phonegap应用程序我只加载一个文件，我想给用户一个选项，这样他就可以在应用程序执行期间更改语言，我怎样才能覆盖另一个文件或重新加载整个应用程序？ . 问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T13:44:04.003

使用 XHR 将文件加载为 JSON 并解析它。像这样的东西：

```
 var messages = {};
    var request = new XMLHttpRequest();
    request.open("GET", "lang.en.json", true);
    request.onreadystatechange = function(){
        console.log("state = " + request.readyState);
        if (request.readyState == 4) {
            if (request.status == 200 || request.status == 0) {
                messages = JSON.parse(request.responseText);
            }
        }
    }
    request.send(); 
```

并将您的 .js 文件更改为 .json：

```
{
    settings: {
        settings: "Settings",
        language: "Language"
    }
} 
```

# visual-studio - 我可以排除项目或库在调试时因抛出异常而中断吗？

> ID：14715426
> 
> 赞同：0
> 
> 时间：2013-02-05T19:33:40.303
> 
> 标签：visual-studio, debugging

我有一个包含大约 10 个独立项目或库的解决方案。其中一个库由其他人维护。

我已将我的首选项（在“调试”>“异常”下）设置为在抛出时（而不是用户未处理）中断选定类型的异常，但我不想*在*此特定库中发生它时中断。

我查看了项目属性上的“调试”选项卡，但似乎没有办法使其免于因异常而中断。这个库中发生的大多数异常都由 try/catch 处理。

我只想调试依赖这个库的项目，而不是经常中断其中发生的异常。有什么办法可以将它排除在异常中断之外？

# javascript - document.domain 更改后，无法在 IE 中访问 about:blank iframe

> ID：14715427
> 
> 赞同：10
> 
> 时间：2013-02-05T19:33:46.630
> 
> 标签：javascript, internet-explorer, dom, iframe, cross-domain-policy

有谁知道`about:blank`在 IE 页面上创建 iframe的任何变通方法`document.domain`？

`document.domain`更改属性后，IE 似乎不允许访问空/动态 iframe 。

例如，假设您正在动态创建一个 iframe，然后将一些 html 注入其中：

```
// Somewhere else, some 3rd party code changes the domain 
// from something.foo.com to foo.com 
document.domain = 'jshell.net';

var iframe = document.createElement('iframe');
document.body.appendChild(iframe);

// In IE, we can't access the iframe's contentWindow! Access is denied.
iframe.contentWindow.document.body.style.backgroundColor = 'red'; 
```

这是关于 jsfiddle 的一个活生生的例子：http: [//jsfiddle.net/XHkUT/](http://jsfiddle.net/XHkUT/)

您会注意到它在 FF/Webkit 中运行良好，但在 IE 中却不行。这尤其令人沮丧，因为这会影响在属性更改*后*`document.domain`创建的 iframe （如上面的示例所示）。

IE 规则似乎是“如果您在更改后创建动态/空 iframe `document.domain`，则无法访问其 DOM。”

将 iframe 设置`src`为`about:blank` `javascript:void(0)`或`javascript:""`未成功。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T11:56:31.070

您是否乐意将 iframe 的域更改为？以下工作（对我来说）在 IE7,9

```
document.domain = 'jshell.net';

var iframe = document.createElement('iframe');
document.body.appendChild(iframe);
iframe.src = "javascript:document.write('<script>document.domain=\"jshell.net\"</script>')";

// Now write some content to the iframe
iframe.contentWindow.document.write('<html><body><p>Hello world</p></body></html>'); 
```

编辑：如果这是页面上的内联脚本，那么您需要拆分结束`</script>`标记。查看[为什么拆分脚本标签](https://stackoverflow.com/questions/236073/why-split-the-script-tag-when-writing-it-with-document-write)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T18:06:56.877

我一直通过将 iframe 的 src 设置为与父域位于同一域中的空白文件来解决此类问题。如果可以在 上创建这样的文件`jshell.net`，我会推荐如下内容：

```
var iframe = document.createElement('iframe');
iframe.src = 'http://jshell.net/blank.html';
document.body.appendChild(iframe); 
```

其中`blank.html`只包含一个小样板，例如：

```
<html><head><title>about:blank</title><head><body></body></html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T09:24:50.343

如果 iframe.src 和 document.location 位于不同的域（或子域）上，则根据定义，您无权从父级访问子级。但是，您可以从孩子访问父母。加载跨域 JavaScript 时使用的技术之一是使用 iframe 在加载时可以调用容器窗口中的方法这一事实。

只有当两个文档位于不同的子域时，您才可以调整 document.domain 以匹配 iframe.src 的域以启用访问。

在此处阅读有关同源政策的更多信息：

[http://en.wikipedia.org/wiki/Same_origin_policy](http://en.wikipedia.org/wiki/Same_origin_policy)

[http://softwareas.com/cross-domain-communication-with-iframes](http://softwareas.com/cross-domain-communication-with-iframes)

# android - 覆盖 ViewPager 的 onDraw 有时会出现黑屏

> ID：14715435
> 
> 赞同：2
> 
> 时间：2013-02-05T19:34:12.450
> 
> 标签：android, android-viewpager, ondraw

我将 ViewPager 扩展为具有移动背景（似乎也是一个[相当受欢迎的](https://stackoverflow.com/questions/4775650/android-moving-background-image-while-navigating-through-views/14713965)请求）

它似乎大部分都在工作，我遇到的问题是有时整个背景都会变黑。

这实际上特别发生在我在第一个页面之外的另一个页面上旋转屏幕并开始移动（屏幕旋转后仍然可以） - 当屏幕旋转后活动重新启动时，它将 ViewPager 恢复到与它相同的页面是以前。

应用程序的整个代码在[GitHub 上](https://github.com/MatthieuLJ/ViewPagerParallax)，但这里是感兴趣的类。

```
package com.matthieu;

import android.annotation.SuppressLint;
import android.content.Context;
import android.graphics.*;
import android.os.Build;
import android.support.v4.view.ViewPager;
import android.util.AttributeSet;
import android.util.Log;

import java.io.IOException;
import java.io.InputStream;

public class ViewPagerParallax extends ViewPager {
    int background_id =-1;
    int background_saved_id =-1;
    int saved_width=-1, saved_height=-1, saved_max_num_pages =-1;
    Bitmap saved_bitmap;

    int max_num_pages=0;
    int imageHeight;
    int imageWidth;
    float zoom_level;

    Rect r = new Rect();

    private final static String TAG="ViewPagerParallax";

    public ViewPagerParallax(Context context) {
        super(context);
    }

    public ViewPagerParallax(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @SuppressLint({"NewApi"})
    private void set_new_background() {
        if (background_id == -1)
            return;

        if (max_num_pages == 0)
            return;

        if (getWidth()==0 || getHeight()==0)
            return;

        if ((saved_height == getHeight()) && (saved_width == getWidth()) &&
                (background_saved_id==background_id) &&
                (saved_max_num_pages == max_num_pages))
            return;

        InputStream is;

        try {
            is = getContext().getResources().openRawResource(background_id);

            BitmapFactory.Options options = new BitmapFactory.Options();
            options.inJustDecodeBounds = true;
            BitmapFactory.decodeStream(is, null, options);

            imageHeight = options.outHeight;
            imageWidth = options.outWidth;

            zoom_level = ((float) imageHeight) / getHeight();  // we are always in 'fitY' mode
            is.reset();

            if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.GINGERBREAD_MR1) {
                BitmapRegionDecoder brd = BitmapRegionDecoder.newInstance(is, true);

                options.inJustDecodeBounds = false;
                r.set(0, 0, Math.min((int) (getWidth() * ((max_num_pages + 4.0) / 5) * zoom_level), imageWidth), imageHeight);
                saved_bitmap = brd.decodeRegion(r, options);
                brd.recycle();
            } else {
                saved_bitmap = Bitmap.createBitmap(BitmapFactory.decodeStream(is), 0, 0, Math.min((int) (getWidth() * ((max_num_pages + 4.0) / 5) * zoom_level), imageWidth), imageHeight);
            }

            is.close();
        } catch (IOException e) {
            Log.e(TAG, "Cannot decode: " + e.getMessage());
            background_id = -1;
            return;
        }

        saved_height = getHeight();
        saved_width = getWidth();
        background_saved_id = background_id;
        saved_max_num_pages = max_num_pages;
    }

    int current_position;
    float current_offset;

    @Override
    protected void onPageScrolled(int position, float offset, int offsetPixels) {
        super.onPageScrolled(position, offset, offsetPixels);
        current_position = position;
        current_offset = offset;
    }

    Rect src = new Rect(), dst = new Rect();

    @Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);

        src.set((int) (((current_position + current_offset) * getWidth() * zoom_level) / 5 ), 0,
                (int) ((((current_position + current_offset) * getWidth() * zoom_level) / 5)  + (getWidth() * zoom_level)), imageHeight);

        dst.set((int) ((current_position + current_offset) * getWidth()), 0, (int) ((current_position + current_offset) * getWidth()) + canvas.getWidth(), canvas.getHeight());
        // still confused why we need to shift also in the destination canvas

        canvas.drawBitmap(saved_bitmap, src, dst, null);
    }

    public void set_max_pages(int num_max_pages) {
        max_num_pages = num_max_pages;
        set_new_background();
    }

    public void setBackgroundAsset(int res_id) {
        background_id = res_id;
        set_new_background();
    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b) {
        super.onLayout(changed, l, t, r, b);
        set_new_background();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:01:32.237

Canvas 中的偏移量是根据正在绘制的第一页计算的...修复了 GitHub 上的代码，现在只是希望这不是完全依赖于实现的东西，以后会改变...

# php - 提交带有大量复选框的表单

> ID：14715436
> 
> 赞同：0
> 
> 时间：2013-02-05T19:34:16.270
> 
> 标签：php, html

提交包含大量**复选框**的表单的最佳方式是什么。
no_of_checkboxes 相当大（超过 200 个）。
我需要以最有效的方式将复选框的状态映射到数据库表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:45:41.713

> 发布表格似乎很慢。

我不确定为什么它很慢，但这里有一些东西可以尝试。将所有复选框字段放在表单元素之外，这样它们就不会被提交。在表单中放置一个名为“boxes”的隐藏元素。使用 JavaScript 在提交时触发一个函数，该函数 json 对复选框进行编码并将字符串放在隐藏字段“框”中。在操作页面上，json 解码或仅将 json 字符串保存在单个 DB 字段中。

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script type="text/javascript">
var boxes = {};
$(document).ready(function(){
    $('form').submit(function(){
        $('input[type=checkbox]').each(function(){

            if($(this).prop('checked')){
                boxes[$(this).prop('name')] = '1';
                //boxes[$(this).prop('name')] = $(this).val(); // if you want the value
            }else{
                boxes[$(this).prop('name')] = '0';
            }
        });
        $('#boxes').val(JSON.stringify(boxes));
        return true;
    });
});
</script> 
```

> 我需要以最有效的方式将复选框的状态映射到数据库表。

```
<?php
$boxes = json_decode($_POST['boxes'], true);
$columns = array();
$values = array();
foreach($boxes as $key=>$val){
  $columns[] = $key;
  $values[] = "'$val'";
}
$columns = "(".implode(', ', $columns).")";
$values = "(".implode(', ', $values).")";
// example query: mysql_query("INSERT INTO table $columns VALUES $values");
?> 
```

# jsf-2 - jsf2 无法从复合组件中引用容器页面的元素

> ID：14715438
> 
> 赞同：1
> 
> 时间：2013-02-05T19:34:24.533
> 
> 标签：jsf-2, composite-component

**启动器.xhtml**

这种形式使用“事物”

```
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:composite="http://java.sun.com/jsf/composite"
      xmlns:f="http://java.sun.com/jsf/core"      
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:custom="http://java.sun.com/jsf/composite/components">
<h:form id="form">
<p:panelGrid 
id="pgid"
columns="2">
    <h:outputText value="title"/>
    <h:outputText value="#{bean.value}"/>   
</p:panelGrid>

<custom:thing 
via="#{bean.via1}"
viaListener="#{bean.via2Listener()}"        
vias="#{bean.vias1}">
</h:form> 
```

**东西.xhtml**

```
<p:selectOneMenu                    
            process="@this"
            value="#{cc.attrs.via}">
                <p:ajax
                listener="#{cc.attrs.viaListener}"
                update="form:pgid"
                />
                <f:selectItems value="#{cc.attrs.vias}"/>
            </p:selectOneMenu> 
```

面孔找不到表格：pgid。尝试使用和不使用“表单”。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T02:07:48.930

`:`相对于父`NamingContainer`组件（在您的情况下是复合组件本身）搜索相对客户端 ID（不以 开头）。所以它`form:pgid`在`<cc:implementation>`.

您需要在客户端 ID 前加上`:`（默认`NamingContainer`分隔符），以使其绝对位于视图根目录。

```
<p:ajax ... update=":form:pgid" /> 
```

### 也可以看看：

*   [如何找出用于 ajax 更新/渲染的组件的客户端 ID？找不到从“bar”引用的表达式“foo”的组件](https://stackoverflow.com/questions/8634156/how-to-reference-components-in-jsf-ajax-cannot-find-component-with-identifier/8644762#8644762)

# java - 如何在 Struts 2 中将对象放入 ThreadLocal 中？

> ID：14715439
> 
> 赞同：0
> 
> 时间：2013-02-05T19:34:26.437
> 
> 标签：java, hibernate

我试图`Session`在每个请求上打开 Hibernate 并在最后关闭它。

[这](https://stackoverflow.com/questions/5901137/hiberate-with-struts2-use-full-hibernate-plugin-or-another-method-to-close-ses)似乎可以工作，但我现在知道我应该如何将我的`Session`对象放入`ThreadLocal`并且答案没有解释这一点。

是否有任何 Struts2 特定的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:54:00.293

您可以在 Struts2 Servlet 前面添加一个 HttpFilter。在过滤器中：

```
public class SessionProviderFilter implements Filter {
    private static ThreadLocal<Session> sessionStore = new ThreadLocal<Session>();

    public void doFilter(...) {
        Session session = ... // get the session
        sessionStore.set(session);
        chain.doFilter(...);
        sessionStore.set(null);
   }

   public static Session getCurrentSession() {
        return sessionStore.get();
   }
} 
```

现在，从任何代码中，要获取当前的休眠会话，您可以调用 SessionProviderFilter.getCurrentSession()。

# ios - 本地化 APN 警报中的时间戳

> ID：14715440
> 
> 赞同：0
> 
> 时间：2013-02-05T19:34:29.457
> 
> 标签：ios, localization, apple-push-notifications

我的服务器需要发送一个 Apple 推送通知，其中包含类似“您的司机将在下午 2:45 到达”的警报。最好不必将用户的时区和时间格式首选项拉到服务器上，而只需传递某种通用时间点指示器（例如纪元秒或 UTC 时间戳）并让 iOS 设备转动将其转换为用户首选格式的时间戳。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:39:04.470

简短的回答——通常是“不”。这是苹果文档：

> 如果通知到达时目标应用程序未运行，则会播放或显示警报消息、声音或标记值。如果应用程序正在运行，iOS 会将其作为 NSDictionary 对象传递给应用程序委托。

由于您的应用程序通常不会运行，因此您没有机会解释 APN 包的内容。但是，如果您确实希望在运行时只获得 APN，那么您确实有机会执行特定于应用程序的操作。

注意 - 您还有用户语言的问题。您当前为“您的司机...”选择了英语

典型的方法是在您的服务器上记录用户的时区和语言（以及其他区域设置信息），通常是在注册时。然后，当您的服务器生成 APN 时，它会针对用户的区域设置对其进行自定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:37:20.020

不，没有办法扭转这个消息。

我认为您应该在服务器上永久获取时区。

# android - Android NumberFormat.getIntegerInstance().format 不可靠。如何格式化整数？安卓漏洞？

> ID：14715444
> 
> 赞同：0
> 
> 时间：2013-02-05T19:34:45.823
> 
> 标签：android, textview

这个问题让我怀疑自己的理智。我想我遇到了一个 android 错误，我需要解决 NumberFormat.getIntegerInstance().format 的替代解决方案。

我在获取格式化数字以在 TextView 中显示时遇到问题 这是一个间歇性问题，但无法可靠地重现。

我有一种方法可以在每次通过片段中的回调事件选择微调器项目时计算余额。有 6 个微调器，选择哪个并不重要

有时需要单击 30 或 40 次（在微调器上进行选择）才能出现问题，有时只需单击 10 或 12 次。该问题与实际值完全无关，并且 calcBalance 方法总是返回一个格式化的整数。只是有时该整数在 TextView 中显示为空白文本。

问题是 setText 方法正在工作，它只是不显示的数字。

一旦问题出现，几乎每次选择都会发生在横向和纵向之间切换似乎可以解决问题，但它会重新开始

calcBalance 方法如下所示

```
public String calcBalance() {
    int balance = 90000000;
    for(int i = 0; i < this.cars.size(); i++){
        balance = balance - this.cars.get(i).getDriver().getPrice();
        balance = balance - this.cars.get(i).getChassis().getPrice();
        balance = balance - this.cars.get(i).getEngine().getPrice();
        Log.i("@@@@", "Calculating balance: " + balance);
    }
    return NumberFormat.getIntegerInstance().format(balance);
} 
```

使用调试消息调用此平衡的方法如下所示

```
 @Override
    public void onBalanceChanged(int position, CarModel car) {
//      Try to change the car but if it has not already been added then add it instead using outOfBounds
//      exception to check if item exists
        mi ++;
        try {
            mTeam.cars.set(position, car);
        }catch(java.lang.IndexOutOfBoundsException e){
            mTeam.cars.add(car);
        }
        if (mTvBalance == null){
            mTvBalance = (TextView) findViewById(R.id.lblBalance);
        }
        String balance = mTeam.calcBalance();
        Util.log_debug_message("Setting text Balance is " + balance);
        String balance_text = mi + " Available Balance: $" + balance;  
        Util.log_debug_message("Balance text is " + balance_text);
        mTvBalance.setText(balance_text);
    } 
```

一个示例日志输出表明我正在设置的文本的值是

> 余额文本为 25 可用余额：10,000,000 美元

然而文本视图只显示

> 25 可用余额：

数字 25 只是我调试的一部分，以证明 TextView.setText 实际上已被设置，而只是未显示的数字。

导致 TextView 仅显示没有值的文本的日志输出（包括上面的示例如下

```
W/InputManagerService(   59): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@4514fe58
I/@@@@    ( 1249): Calculating balance: 45000000
I/@@@@    ( 1249): Calculating balance: 0
D/QuizApp ( 1249): Setting text Balance is 0
D/QuizApp ( 1249): Balance text is 24 Available Balance: $0
W/InputManagerService(   59): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@450f3ec0
I/@@@@    ( 1249): Calculating balance: 45000000
I/@@@@    ( 1249): Calculating balance: 10000000
D/QuizApp ( 1249): Setting text Balance is 10,000,000
D/QuizApp ( 1249): Balance text is 25 Available Balance: $10,000,000
W/InputManagerService(   59): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@4517e3d0
W/InputManagerService(   59): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@451c4b70
W/InputManagerService(   59): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@4513fef8
I/@@@@    ( 1249): Calculating balance: 45000000
I/@@@@    ( 1249): Calculating balance: 13000000
D/QuizApp ( 1249): Setting text Balance is 13,000,000
D/QuizApp ( 1249): Balance text is 26 Available Balance: $13,000,000
W/InputManagerService(   59): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@45115e48 
```

以及我在 TextView 中获得正确文本集的时间的一些**日志**输出

```
I/@@@@    ( 1249): Calculating balance: 45000000
I/@@@@    ( 1249): Calculating balance: 0
D/QuizApp ( 1249): Setting text Balance is 0
D/QuizApp ( 1249): Balance text is 8 Available Balance: $0
W/InputManagerService(   59): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@45020d10
I/@@@@    ( 1249): Calculating balance: 55000000
I/@@@@    ( 1249): Calculating balance: 10000000
D/QuizApp ( 1249): Setting text Balance is 10,000,000
D/QuizApp ( 1249): Balance text is 9 Available Balance: $10,000,000
W/InputManagerService(   59): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@44f85c58
I/@@@@    ( 1249): Calculating balance: 55000000
I/@@@@    ( 1249): Calculating balance: 20000000
D/QuizApp ( 1249): Setting text Balance is 20,000,000
D/QuizApp ( 1249): Balance text is 10 Available Balance: $20,000,000 
```

我只能假设我有时会从调用返回一些不可打印的字符`NumberFormat.getIntegerInstance().format`

我在模拟器和运行从 2.2 到 4.1 的不同操作系统的 3 部不同手机上遇到了这个问题。

那么，我必须以何种方式格式化数字才能可靠地显示在 TextView 中？

**更新完整的片段活动**

```
public class NewTeamFragmentActivity extends SherlockFragmentActivity implements TabListener, OnBalanceChangedListener, OnTeamDataChangedListener{

    static final int NUM_ITEMS = 3;
    private ViewPager mPager;
    private NewTeamSwipeAdapter mAdapter;
    private TeamModel mTeam;
    private TextView mTvBalance;
    private int mi = 0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_new_team);
        // Show the Up button in the action bar.
        getSupportActionBar().setDisplayHomeAsUpEnabled(true);
        getSupportActionBar().setNavigationMode( ActionBar.NAVIGATION_MODE_TABS );
        mAdapter = new NewTeamSwipeAdapter(getSupportFragmentManager());

        mPager = (ViewPager)findViewById(R.id.pager);
        mPager.setAdapter(mAdapter);
        mPager.setOnPageChangeListener(
                new ViewPager.SimpleOnPageChangeListener() {
                    @Override
                    public void onPageSelected(int position) {
                        // When swiping between pages, select the
                        // corresponding tab.
                        getSupportActionBar().setSelectedNavigationItem(position);
                    }
                });
        setupTabs();
        setupModels();
        createFragments();
    }

    private void createFragments() {
        NewTeamFragment teamFragment = new NewTeamFragment();
        Bundle arguments = new Bundle();
        FragmentTransaction trans = getSupportFragmentManager().beginTransaction();
        trans.replace(R.id.new_team_fragment_container, teamFragment);
        trans.commit();
    }

    private void setupModels() {
        mTeam = new TeamModel();
    }

    private void setupTabs() {
        add_tab("Car 1");
        add_tab("Car 2");
        add_tab("Submit Team");
    }

    private void add_tab(String tabText) {
        Tab tab = getSupportActionBar().newTab();
        tab.setText(tabText);
        tab.setTabListener(this);
        getSupportActionBar().addTab(tab);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getSupportMenuInflater().inflate(R.menu.activity_new_team, menu);
        return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case android.R.id.home:
            // This ID represents the Home or Up button. In the case of this
            // activity, the Up button is shown. Use NavUtils to allow users
            // to navigate up one level in the application structure. For
            // more details, see the Navigation pattern on Android Design:
            //
            // http://developer.android.com/design/patterns/navigation.html#up-vs-back
            //
            NavUtils.navigateUpFromSameTask(this);
            return true;
        }
        return super.onOptionsItemSelected(item);
    }
    public static class NewTeamSwipeAdapter extends FragmentPagerAdapter {

        public NewTeamSwipeAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public int getCount() {
            return NUM_ITEMS;
        }

        @Override
        public Fragment getItem(int position) {
            Fragment return_frag = null;
            if (position < 2){
                Bundle arguments = new Bundle();
                arguments.putInt(KeyConstants.CAR_ID_KEY, position);
                NewCarFragment fragment = new NewCarFragment();
                fragment.setArguments(arguments);
                return_frag = fragment;
            } else if (position == 2) {
                SubmitTeamFragment fragment = new SubmitTeamFragment();
                return_frag = fragment;
            }
            return return_frag;
        }

        @Override
        public CharSequence getPageTitle (int position){
            CharSequence title = "Unknown!";
            if (position < 2){
                title = "Car " + (position + 1);
            }else if(position == 2){
                title = "Submit Team";
            }
            return title;
        }
    }
    @Override
    public void onTabSelected(Tab tab, FragmentTransaction ft) {
        mPager.setCurrentItem(tab.getPosition());
    }

    @Override
    public void onTabUnselected(Tab tab, FragmentTransaction ft) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onTabReselected(Tab tab, FragmentTransaction ft) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onBalanceChanged(int position, CarModel car) {
//      Try to change the car but if it has not already been added then add it instead using outOfBounds
//      exception to check if item exists
        mi ++;
        try {
            mTeam.cars.set(position, car);
        }catch(java.lang.IndexOutOfBoundsException e){
            mTeam.cars.add(car);
        }
        if (mTvBalance == null){
            mTvBalance = (TextView) findViewById(R.id.lblBalance);
        }
        String balance = mTeam.calcBalance();
        Util.log_debug_message("Setting text Balance is " + balance);
        String balance_text = mi + " Available Balance: $" + balance;  
        Util.log_debug_message("Balance text is " + balance_text);
        mTvBalance.setText(balance_text);
    }

    @Override
    public void onTeamDataChanged(TeamModel mTeam) {
        // TODO Auto-generated method stub
        if (this.mTeam == null){
            this.mTeam = mTeam;
        }else{
            this.mTeam.setTeamName(mTeam.getTeamName());
        }
    }

} 
```

**更新 -**这绝对是 NumberFormat.getIntegerInstance() 的问题

Integer.toString(balance); 不会造成任何问题。那么我怎样才能可靠地用逗号格式化整数呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T12:15:37.273

我很确定android中有一个错误。查看`NumberFormat.getIntegerInstance()`（[http://developer.android.com/reference/java/text/NumberFormat.html](http://developer.android.com/reference/java/text/NumberFormat.html)）的文档，有提到这个方法不应该被调用太多次有点包裹在一个更好的性能获得整数实例一次，将其设置为成员变量并重新使用它。引用

> 如果您正在格式化多个数字，那么获取格式并多次使用它会更有效，这样系统就不必多次获取有关本地语言和国家/地区惯例的信息。

当然是这样，但是在其他类中并没有真正提到这样的性能问题，所以我怀疑 Android 团队意识到如果调用过于频繁，这种方法可能会证明有点不可靠，但他们并不会真正做任何事情关于它。我可能会同意，如果是这种情况，那么他们为什么要这样做？由开发人员来优化代码，如果代码经过优化，那么您将不会遇到问题。

问题是我的代码根本没有优化。因为这种方法被用于同时加载的多个微调器中。

我已经重构了我的代码，并确保通过将结果分配给成员变量并且仅在成员变量为 null 并且一切看起来都不错时才调用此方法，但我感到不安的是功能并不像它可能的那样稳定，这可能会再次受到影响。

# ruby - 在 Ruby 的类范围内声明“实例”变量有什么缺点？

> ID：14715449
> 
> 赞同：4
> 
> 时间：2013-02-05T19:35:02.477
> 
> 标签：ruby, scope, instance-variables

我几乎从未在 Ruby 代码中看到过这一点，但它似乎是有效的：

```
class Foo
  @bar = "bar"

  def self.print_bar
    puts @bar
  end
end 
```

我对上述内容的解释`@bar`是 的实例变量`Foo`，它是 的单例 (?) 实例`Class`。

这似乎与在类范围和实例范围内都可以访问的*类变量*（例如， ）不同。`@@baz`

如果有的话，像上面的代码片段这样的代码有什么缺点？或者它是完全合理的代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T20:01:13.377

是的，这是完全有效的。它也被广泛使用，通常推荐用于具有非常大范围的类变量（类、类的所有实例、所有子类、所有子类的所有实例……）。

没有缺点。类是对象。对象可以有实例变量。没什么。Ruby 的对象模型*确实*比人们想要相信的*要*简单得多，即使是 Ruby 教程的作者也会让你相信。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:39:59.523

一个潜在的缺点是它`@bar`不适用于`Foo`.

```
class Parent
  @bar = 3
  def self.print_bar
    puts @bar # nil
  end
end

class Child < Parent

end

Parent.print_bar # 3
Child.print_bar # nil 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T00:55:43.513

代码有效。您正在使用类实例变量。正如 Jörg 所说，它们通常比类变量更受欢迎。它们都**可以**实现相同的目的，但是类变量有一些陷阱。有关类变量与类实例变量的优缺点，请参阅 Ruby 中的类和实例变量[。](http://www.railstips.org/blog/archives/2006/11/18/class-and-instance-variables-in-ruby/)

使用类实例变量的一个缺点是它们看起来与“普通”实例变量相同。这会让新的 Ruby 程序员措手不及。下面的`self.print_bar`and`print_bar`方法指向不同的 @bar 实例变量。

```
class Foo
  @bar = "bar"

  def initialize
    @bar = "foo"
  end

  def self.print_bar
    puts @bar #=> "bar"
  end

  def print_bar
    puts @bar #=> "foo"
  end
end 
```

在我看来这不是一个很大的缺点，但你问了:)

类实例变量对子类不可用这一事实不一定是不利的。这完全取决于您希望程序的行为方式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T19:51:29.977

未初始化的实例变量将有一个`nil`值，而未初始化的类变量将抛出错误。正如其他人所补充的，类变量可用于子类。

这是一个链接，讨论了我发现有帮助的两个：

[http://www.railstips.org/blog/archives/2006/11/18/class-and-instance-variables-in-ruby/](http://www.railstips.org/blog/archives/2006/11/18/class-and-instance-variables-in-ruby/)

# javascript - 有没有办法在 javascript 中使用 Array.splice 并将第三个参数作为数组？

> ID：14715459
> 
> 赞同：24
> 
> 时间：2013-02-05T19:35:33.160
> 
> 标签：javascript, arrays, array-splice

我正在尝试以下操作：

```
var a1 = ['a', 'e', 'f'];  // [a, e, f]
var a2 = ['b', 'c', 'd'];  // [b, c, d]
a1.splice(1, 0, a2);       // expected [a, b, c, d, e, f]
                           // actual (a, [b, c, d], e, f] 
```

我被限制在我的用例中，因为 a2 作为一个不确定大小的数组存在。有谁知道一种方法来提供拼接数组作为替换，或者一个内置函数来做到这一点？我知道我可以遍历 a2 的元素并一次将它们拼接成一个，但我更喜欢最快的方法，因为我需要做很多事情。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-05T19:41:50.153

`Array.splice`在前两个之后支持多个参数。这些参数都将添加到数组中。知道了这一点，您可以使用`Function.apply`将数组作为参数列表传递。

```
var a1 = ['a', 'e', 'f'];
var a2 = ['b', 'c', 'd'];

// You need to append `[1,0]` so that the 1st 2 arguments to splice are sent
Array.prototype.splice.apply(a1, [1,0].concat(a2)); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2017-10-25T08:56:39.807

使用 ES6，您可以使用[扩展](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator)运算符。它使它更加简洁和可读。

```
var a1 = ['a', 'e', 'f'];
var a2 = ['b', 'c', 'd'];

a1.splice(1, 0, ...a2);
console.log(a1)
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-05T19:42:45.457

```
var a1 = ['a', 'e', 'f'],
    a2 = ['b', 'c', 'd'];

a1.splice(1, 0, a2);

var flatten = [].concat.apply([], a1); // ["a", "b", "c", "d", "e", "f"] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-05T19:46:49.723

这应该可以解决问题。

```
var a1 = ['a', 'e', 'f'];
var a2 = ['b', 'c', 'd'];

a1.concat(a2, a1.splice(1,a1.length-1)) // [a, b, c, d, e, f] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-05T19:42:29.613

尝试这个：

```
var params = a2.slice(0);
params.unshift(1,0);
a1.splice.apply(a1,params); 
```

在更一般的情况下：

```
Array.prototype.splice_multi = function(offset,todelete,insert) {
    var params = insert.slice(0);
    params.unshift(offset,todelete);
    return this.splice.apply(this,params);
};
a1.splice_multi(1,0,a2); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-08-02T16:23:41.000

```
Array.prototype.splice.apply( [1,2,3], [2, 0].concat([4,5,6]) ); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-07-28T13:47:56.310

```
private moveElements(source: Array<any>, target: Array<any>) {
    target.push(...source);
    source.splice(0, source.length);
    //or
    [].push.apply(target,source);
    source.splice(0, source.length);
} 
```

# matlab - 来自箱线图输入的 MATLAB student-t 测试

> ID：14715461
> 
> 赞同：0
> 
> 时间：2013-02-05T19:35:44.520
> 
> 标签：matlab, boxplot, significance

在 Matlab 中，我创建了一些数据箱线图。现在，我想用 Student-T 检验进行统计分析，看看差异是否显着。一些数据是配对的，而另一些则不是，具有方差差异。我认为应该使用双尾测试。**它们是matlab中的一个函数来计算来自 boxplot**的 Student-T 测试，所以我不需要再次计算输入值？

问候，

文森特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:21:34.443

箱线图本身只包含显示的信息，即箱的大小和线条。理论上可以从四分位数间距估计分布的方差（尽管您必须假设您的分布遵循特定的形状），但是现在有办法猜测进入的数据点的数量阴谋。

为了获得准确的测试，您最好重新计算输入值。

# google-apps-script - 谷歌应用脚 本获取脚本请求 URL

> ID：14715462
> 
> 赞同：1
> 
> 时间：2013-02-05T19:35:46.890
> 
> 标签：google-apps-script

在谷歌脚本中，我需要获取此脚本网址。它有类似的网址`"https://script.google.com/macros/s/somecharshere/exec"`

我需要得到这个网址（并发送回复）。

但我发现没有办法做到这一点。我所能做的就是通过 e.parameter.* 获取查询参数，但不是完整的请求 url。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T21:16:56.260

ScriptApp.getService().getUrl()

# c++ - OpenGL 纹理白线间隙

> ID：14715467
> 
> 赞同：1
> 
> 时间：2013-02-05T19:35:52.943
> 
> 标签：c++, opengl, textures, terrain, voxel

作为一个我已经有一段时间的辅助项目，我一直在尝试创建一些体素地形。然而，令我沮丧的是，纹理似乎无法正常工作。我正在使用 GL_REPEAT 和 GL_NEAREST 映射纹理。纹理位于精灵表中，大小为 16x16。我目前正在使用 minecraft 纹理进行调试。我尝试通过移动纹理 1 texel 来修复它，但这也不起作用。

![在此处输入图像描述](../Images/2c5dd04e888e3191f5b1dcd593553bfd.png)

这是处理它的代码：

```
void Chunk::CreateCube(int x, int y, int z, bool activeStates[], int ID)
{

        double TEXTURE_SIZE = 256;
        glm::vec3 p1(x-BLOCK_RENDER_SIZE, y-BLOCK_RENDER_SIZE, z+BLOCK_RENDER_SIZE); //left bottom  front
        glm::vec2 t1(0.5/TEXTURE_SIZE, 0.5/TEXTURE_SIZE);
        glm::vec3 p2(x+BLOCK_RENDER_SIZE, y-BLOCK_RENDER_SIZE, z+BLOCK_RENDER_SIZE); //right bottom front
        glm::vec2 t2(1-(0.5/TEXTURE_SIZE), 0.5/TEXTURE_SIZE);
        glm::vec3 p3(x+BLOCK_RENDER_SIZE, y+BLOCK_RENDER_SIZE, z+BLOCK_RENDER_SIZE); // right top front
        glm::vec2 t3(1-(0.5/TEXTURE_SIZE), 1-(0.5/TEXTURE_SIZE));
        glm::vec3 p4(x-BLOCK_RENDER_SIZE, y+BLOCK_RENDER_SIZE, z+BLOCK_RENDER_SIZE); // left top front
        glm::vec2 t4(0.5/TEXTURE_SIZE, 1-(0.5/TEXTURE_SIZE));
        glm::vec3 p5(x+BLOCK_RENDER_SIZE, y-BLOCK_RENDER_SIZE, z-BLOCK_RENDER_SIZE); // right bottom back
        glm::vec2 t5(0.5/TEXTURE_SIZE, 0.5/TEXTURE_SIZE);
        glm::vec3 p6(x-BLOCK_RENDER_SIZE, y-BLOCK_RENDER_SIZE, z-BLOCK_RENDER_SIZE); // left bottom back
        glm::vec2 t6(1-(0.5/TEXTURE_SIZE), 0.5/TEXTURE_SIZE);
        glm::vec3 p7(x-BLOCK_RENDER_SIZE, y+BLOCK_RENDER_SIZE, z-BLOCK_RENDER_SIZE); // left top back
        glm::vec2 t7(1-(0.5/TEXTURE_SIZE), 1-(0.5/TEXTURE_SIZE));
        glm::vec3 p8(x+BLOCK_RENDER_SIZE, y+BLOCK_RENDER_SIZE, z-BLOCK_RENDER_SIZE); // right top back
        glm::vec2 t8(0.5/TEXTURE_SIZE, 1-(0.5/TEXTURE_SIZE));

        int numCols = 16;
        int numRows = 16;

        double u = ((double)(ID % numCols) / (double)numCols);
        double v = ((double)(ID / numRows) / (double)numRows);
        double TILE_TEXTURE_SIZE = 16;

        glm::vec3 n1;

        if(activeStates[5] == false)
        {
                // Front Face Normal
                n1 = glm::vec3(0.0f, 0.0f, 1.0f);
                //Triangle 1
                vertexData.push_back(p1);
                uvData.push_back(glm::vec2(t1.x/TILE_TEXTURE_SIZE + u, t1.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p2);
                uvData.push_back(glm::vec2(t2.x/TILE_TEXTURE_SIZE + u, t2.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p3);
                uvData.push_back(glm::vec2(t3.x/TILE_TEXTURE_SIZE + u, t3.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
                //Triangle 2
                vertexData.push_back(p1);
                uvData.push_back(glm::vec2(t1.x/TILE_TEXTURE_SIZE + u, t1.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p3);
                uvData.push_back(glm::vec2(t3.x/TILE_TEXTURE_SIZE + u, t3.y/TILE_TEXTURE_SIZE + v ));
                normalData.push_back(n1);

                vertexData.push_back(p4);
                uvData.push_back(glm::vec2(t4.x/TILE_TEXTURE_SIZE + u, t4.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
        }

        if(activeStates[4] == false)
        {
                // Back
                n1 = glm::vec3(0.0f, 0.0f, -1.0f);
                //Triangle 1
                vertexData.push_back(p5);
                uvData.push_back(glm::vec2(t5.x/TILE_TEXTURE_SIZE + u, t5.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p6);
                uvData.push_back(glm::vec2(t6.x/TILE_TEXTURE_SIZE + u, t6.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p7);
                uvData.push_back(glm::vec2(t7.x/TILE_TEXTURE_SIZE + u, t7.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
                //Triangle 2
                vertexData.push_back(p5);
                uvData.push_back(glm::vec2(t5.x/TILE_TEXTURE_SIZE + u, t5.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p7);
                uvData.push_back(glm::vec2(t7.x/TILE_TEXTURE_SIZE + u, t7.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p8);
                uvData.push_back(glm::vec2(t8.x/TILE_TEXTURE_SIZE + u, t8.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
        }
        if(activeStates[1] == false)
        {
                // Right
                n1 = glm::vec3(1.0f, 0.0f, 0.0f);
                //Triangle 1
                vertexData.push_back(p2);
                uvData.push_back(glm::vec2(t2.x/TILE_TEXTURE_SIZE + u, t2.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p5);
                uvData.push_back(glm::vec2(t5.x/TILE_TEXTURE_SIZE + u, t5.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p8);
                uvData.push_back(glm::vec2(t8.x/TILE_TEXTURE_SIZE + u, t8.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
                //Triangle 2
                vertexData.push_back(p2);
                uvData.push_back(glm::vec2(t2.x/TILE_TEXTURE_SIZE + u, t2.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p8);
                uvData.push_back(glm::vec2(t8.x/TILE_TEXTURE_SIZE + u, t8.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p3);
                uvData.push_back(glm::vec2(t3.x/TILE_TEXTURE_SIZE + u, t3.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
        }
        if(activeStates[0] == false)
        {
                // left
                n1 = glm::vec3(-1.0f, 0.0f, 0.0f);
                //Triangle 1
                vertexData.push_back(p6);
                uvData.push_back(glm::vec2(t6.x/TILE_TEXTURE_SIZE + u, t6.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p1);
                uvData.push_back(glm::vec2(t1.x/TILE_TEXTURE_SIZE + u, t1.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p4);
                uvData.push_back(glm::vec2(t4.x/TILE_TEXTURE_SIZE + u, t4.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
                //Triangle 2
                vertexData.push_back(p6);
                uvData.push_back(glm::vec2(t6.x/TILE_TEXTURE_SIZE + u, t6.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p4);
                uvData.push_back(glm::vec2(t4.x/TILE_TEXTURE_SIZE + u, t4.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p7);
                uvData.push_back(glm::vec2(t7.x/TILE_TEXTURE_SIZE + u, t7.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
        }
        if(activeStates[3] == false)
        {
                // Top
                n1 = glm::vec3(0.0f, 1.0f, 0.0f);
                //Triangle 1
                vertexData.push_back(p4);
                uvData.push_back(glm::vec2(t6.x/TILE_TEXTURE_SIZE + u, t6.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p3);
                uvData.push_back(glm::vec2(t1.x/TILE_TEXTURE_SIZE + u, t1.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p8);
                uvData.push_back(glm::vec2(t4.x/TILE_TEXTURE_SIZE + u, t4.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
                //Triangle 2
                vertexData.push_back(p4);
                uvData.push_back(glm::vec2(t6.x/TILE_TEXTURE_SIZE + u, t6.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p8);
                uvData.push_back(glm::vec2(t4.x/TILE_TEXTURE_SIZE + u, t4.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p7);
                uvData.push_back(glm::vec2(t7.x/TILE_TEXTURE_SIZE + u, t7.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
        }

        if(activeStates[2] == false)
        {
                // Bottom
                n1 = glm::vec3(0.0f, -1.0f, 0.0f);

                //Triangle 1
                vertexData.push_back(p6);
                uvData.push_back(glm::vec2(t6.x/TILE_TEXTURE_SIZE + u, t6.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p5);
                uvData.push_back(glm::vec2(t1.x/TILE_TEXTURE_SIZE + u, t1.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p2);
                uvData.push_back(glm::vec2(t4.x/TILE_TEXTURE_SIZE + u, t4.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
                //Triangle 2
                vertexData.push_back(p6);
                uvData.push_back(glm::vec2(t6.x/TILE_TEXTURE_SIZE + u, t6.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p2);
                uvData.push_back(glm::vec2(t4.x/TILE_TEXTURE_SIZE + u, t4.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);

                vertexData.push_back(p1);
                uvData.push_back(glm::vec2(t7.x/TILE_TEXTURE_SIZE + u, t7.y/TILE_TEXTURE_SIZE + v));
                normalData.push_back(n1);
        }

        /*glm::vec2 t1(0.5/256, 0.5/256);

        glm::vec2 t2(1-(0.5/256), 0.5/256);

        glm::vec2 t3(1-(0.5/256), 1-(0.5/256));

        glm::vec2 t4(0.5/256, 1-(0.5/256));

        glm::vec2 t5(0.5/256, 0.5/256);

        glm::vec2 t6(1-(0.5/256), 0.5/256);

        glm::vec2 t7(1-(0.5/256), 1-(0.5/256));

        glm::vec2 t8(0.5/256, 1-(0.5/256));
        */

        /*
        for(int i = 0; i < vertexData.size(); i+=3)
        {

        // get the three vertices that make the faces
        glm::vec3 p1 = vertexData[i+0];
        glm::vec3 p2 = vertexData[i+1];
        glm::vec3 p3 = vertexData[i+2];

        glm::vec3 v1 = p2 - p1;
        glm::vec3 v2 = p3 - p1;
        glm::vec3 normal = glm::cross( v1,v2 );

        normal = glm::normalize(normal);

        normalData[i+0] = normal;
        normalData[i+1] = normal;
        normalData[i+2] = normal;

        }
        */
}

GLuint Graphics3D::loadTexture(const char* theFileName)
{
        ILuint imageID;                

        GLuint textureID;              

        ILboolean success;

        ILenum error;                          

        ilGenImages(1, &imageID);      

        ilBindImage(imageID);          

        success = ilLoadImage(theFileName);

        if (success)
        {

                ILinfo ImageInfo;
                iluGetImageInfo(&ImageInfo);
                if (ImageInfo.Origin == IL_ORIGIN_UPPER_LEFT)
                {
        //              iluFlipImage();
                }

                success = ilConvertImage(IL_RGB, IL_UNSIGNED_BYTE);

                if (!success)
                {
                        error = ilGetError();
                        std::cout << "Image conversion failed - IL reports error: " << error << " - " << iluErrorString(error) << std::endl;
                }

                glGenTextures(1, &textureID);

        glBindTexture(GL_TEXTURE_2D, textureID);

                glTexImage2D(GL_TEXTURE_2D,                             // Type of texture
                        0,                              // Pyramid level (for mip-mapping) - 0 is the top level
                        ilGetInteger(IL_IMAGE_BPP),     // Image colour depth
                        ilGetInteger(IL_IMAGE_WIDTH),   // Image width
                        ilGetInteger(IL_IMAGE_HEIGHT),  // Image height
                        0,                              // Border width in pixels (can either be 1 or 0)
                        ilGetInteger(IL_IMAGE_FORMAT),  // Image format (i.e. RGB, RGBA, BGR etc.)
                        GL_UNSIGNED_BYTE,               // Image data type
                        ilGetData());                   // The actual image data itself
                /*
                glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
                glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);
                glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
                glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);
                */

        //      glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
        //      glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);

                glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
                glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);

                if(GLEW_EXT_texture_filter_anisotropic)
                {

                        GLfloat maximumAnisotropy;
                        //get the value
                        glGetFloatv(GL_MAX_TEXTURE_MAX_ANISOTROPY_EXT, &maximumAnisotropy);
                        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAX_ANISOTROPY_EXT, maximumAnisotropy);
                }

                glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST);
                glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST_MIPMAP_LINEAR);
        //      glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
        //      glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR_MIPMAP_LINEAR);
                glGenerateMipmap(GL_TEXTURE_2D);

        }
        else
        {
                error = ilGetError();
                std::cout << "Image load failed - IL reports error: " << error << " - " << iluErrorString(error) << std::endl;

        }

        ilDeleteImages(1, &imageID);

        std::cout << "Texture creation successful." << std::endl;

        return textureID;

} 
```

似乎离我越远，线条就越明显。所以我尝试删除 mipmap。这也没有帮助。我不知道如何处理这个问题。有任何想法吗？这是纹理： ![在此处输入图像描述](../Images/691f514b4716d2921e1a41109696a8a5.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T19:26:23.923

您的基本问题是您将多个图像平铺成一个大纹理。这将导致任何类型的纹理过滤（例如 mipmapping 和各向异性过滤）出现问题。您不想禁用纹理过滤。相反，您应该将每个图像在逻辑上视为不同的图像。一个简单的方法是让每个图块成为一个单独的纹理。这有点慢，因此为了获得更好的性能，您应该改用[Array Texture](http://www.opengl.org/wiki/Array_Texture)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:42:23.310

这几乎可以肯定是启用了某种形式的过滤。

我注意到您正在打开各向异性过滤。即使没有 mip-mapping，这也会导致获取子纹理之外的像素，从而导致您在此处看到的伪影。

你真的需要关闭它，以及摆脱 mip-mapping。

另外，我认为您的 UV 生成已关闭，并且包含一些错误。这些可能不是这里的问题，但我建议修复它们。

例如，在这里添加半个纹素：

```
glm::vec2 t1(0.5/TEXTURE_SIZE, 0.5/TEXTURE_SIZE); 
```

然而，这后来被缩小了，所以实际上你只是抵消了一小部分。无论如何这可能是不必要的（你为什么认为你需要这样做？），但几乎可以肯定它没有做你认为它在做的事情。一个非常小的偏移量可能是一个好主意，以防止任何舍入错误将获取的纹素滑入下一个子纹理，但只有很小的量。

然后你这样做：

```
double u = ((double)(ID % numCols) / (double)numCols);
double v = ((double)(ID / numRows) / (double)numRows); 
```

您应该对除法和模数使用相同的值`ID`。它之所以有效，是因为您具有相同数量的行和列。

最后，您可以像这样计算 UV：

```
t1.x/TILE_TEXTURE_SIZE + u 
```

除以瓷砖大小是错误的。应该是`* TILE_SIZE / TEXTURE_SIZE`。幸运的是，这恰好是相同的 (256 / 16 = 16)。如果你有不同大小的纹理，它就行不通。

# c++ - 通过 std::iostream 共享 std::fstream 或 std::stringstream

> ID：14715473
> 
> 赞同：2
> 
> 时间：2013-02-05T19:36:10.830
> 
> 标签：c++, stream, c++03

我有一个创建`std::stringstream`或`std::fstream`取决于条件的函数，例如：

```
// Some class, stringStream_ and fileStream_ are members
// obj.Stream() returns std::iostream&
if (condition)
{
    stringStream_.str(std::string());
    obj->Stream().rdbuf(stringStream.rdbuf());
}
else
{
    boost::filesystem::path temp = boost::filesystem::unique_path();
    fileStream_.open(temp.native().c_str(), std::ios_base::trunc | std::ios_base::in | std::ios_base::out);
    obj->Stream().rdbuf(fileStream_.rdbuf());
} 
```

然后这个`obj`对象在另一个线程中处理，所以此时上面的函数可能会被再次调用，并且`streambuf`将`stringStream`被重置并且`fileStream_`将无法打开新文件，因为它与另一个相关联。

我不能制作这样的功能，`obj.SetStream()`因为流是不可复制的。

问题是：我如何创建`std::stringstream`或`std::fstream`将其传递给对象，以便对象成为流的所有者（注意对象存储`std::iostream`，因为它不知道将传递哪种类型的流）。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:40:32.910

您可以将指针（原始或智能）传递给动态分配的任一实例`std::fstream`或`std::stringstream`键入为指向`std::iostream`. 然后，流的客户端只需要做一些类似`std::iostream & s = *iostreamPtr; s << "yay!";`使用它的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:41:13.637

你可以把它变成一个模板化的函数

```
template<class T>
void yourFunc(T& object) 
{
  if (typeid(T) == typeid(std::stringstream))
  {
    stringStream_.str(std::string());
    obj->Stream().rdbuf(stringStream.rdbuf());
  }
  else
  {
    boost::filesystem::path temp = boost::filesystem::unique_path();
    fileStream_.open(temp.native().c_str(), std::ios_base::trunc | std::ios_base::in | std::ios_base::out);
    obj->Stream().rdbuf(fileStream_.rdbuf());
  }
} 
```

# java - Spring SimpleFormController - 浏览器后退按钮不起作用

> ID：14715474
> 
> 赞同：0
> 
> 时间：2013-02-05T19:36:18.050
> 
> 标签：java, spring, spring-mvc

从 SimpleFormController Http 方法扩展的控制器 - 发布

提交表单并按下浏览器后退按钮后，页面已过期，我已重新加载重新提交表单的页面。

但是，我需要当用户单击浏览器后退按钮时，他不会显示页面过期页面，而是将用户重定向到表单页面。

我目前想到了**两种**方法：

**从 POST 更改为在控制器中获取和使用以下内容：**

```
@Override
protected boolean isFormSubmission(HttpServletRequest request) {
    return true;
} 
```

**第二种方法是在控制器的构造函数中定义缓存时间：**

```
public VehicleDescController()
{
    setCacheSeconds(1);
} 
```

该应用程序非常旧，并且使用基于 XML 的 spring 配置。我对 Spring MVC 也比较陌生。

请帮我找出正确的方法。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:25:13.040

我通常喜欢在完成后将Post 方法**重定向到 Get 方法。**您保留 Post 方法，但始终重定向到 Get 方法以显示结果页面。这对用户来说似乎是一个正常的 get 操作，并且您不会遇到后浏览器问题。

如果 Get 方法需要一些数据（例如：记录 id），则 Post 可以将该数据存储在用户会话中，而 Get 方法可以在用户会话中查找该值。这是一种将数据从 Post 方法“传递”到 Get 方法的简单方法，并且如果用户确实点击后退按钮再次返回页面，它会将这些数据保留在用户会话中。

# macos - 为什么使用 --pylab=wx 启动时，IPython 解释器在 OS X 上冻结？

> ID：14715476
> 
> 赞同：3
> 
> 时间：2013-02-05T19:36:21.273
> 
> 标签：macos, matplotlib, wxpython, ipython

我有一个使用 wxPython 和 matplotlib 的 python 包。为了获得非阻塞窗口，我尝试像这样启动 IPython：

```
# ipython --pylab=wx 
```

当我这样做时，会出现 IPython 提示，并且我的 OS X 面板中会出现 wx 图标，但 IPython 命令行会立即冻结（我必须按 CTRL-Z 并终止进程才能退出）。`ipython --pylab`如果我在 matplotlibrc 文件中将 matplotlib 后端设置为“WX”或“WXAgg”使用“”启动它，我会得到相同的行为。

我可以用

```
# ipython --pylab=osx 
```

但是当我运行任何创建 wx 窗口的命令时，我得到一个错误，指出`wx.App`必须首先创建。所以要让它工作，我必须以`osx`上述模式启动 IPython，然后立即输入

```
In [1]: import wx

In [2]: app = wx.App() 
```

我在带有 wx 2.9 的 OS X 10.6 上看到了这一点。无论是使用本地安装的 Ipython + 包还是通过 macports，我都会得到相同的行为。在带有 wx 2.8.12 的 RHEL 6.3 上运行时，我没有看到这种行为。

我怎样才能消除对这种 hack 的需求并让它正确启动？

# video - omxplayer AVPacket

> ID：14715483
> 
> 赞同：0
> 
> 时间：2013-02-05T19:36:54.490
> 
> 标签：video, ffmpeg, decode, h.264, openmax

嗨，我正在尝试使用 OpenMax 组件和来自[GitHub](https://github.com/raspberrypi/firmware/blob/master/opt/vc/src/hello_pi/hello_video/video.c)的 hello_video 示例解码视频。我只需编辑 video.c 并替换 AVFormat 上的“main frame while” -read frame packet for read not only *.h264 files 。（我需要阅读 mp4、mov、mkv ......）.. 所以使用 test.h264 文件和我用 ffmpeg 生成的其他文件，一切正常，在屏幕上我可以看到电影。

```
ffmpeg -i file.mp4 -vcodec copy -vbsf h264_mp4toannexb out.h264 
```

但是，如果我打开 test.mp4 文件，我在屏幕上看不到图片，并且登录控制台显示数据正确读取并正确解析到视频解码器的输入缓冲区。谁能解释一下为什么我在第二次测试中看不到屏幕上的任何东西？

```
 do{
    printf("###before DO!\n");
status=av_read_frame(pFormatCtx,&packet);
//only for video
if(packet.stream_index==*video_stream_index){
printf("=>Read frame, status: %d, index: %d, stream index: %d, packet duration: %d, size: %d\n",pstatus,index++,packet.stream_index,packet.duration,packet.size);
int psize=packet.size;
int preaded=0;
double pts=packet.duration;
while(psize!=0){
     buf = ilclient_get_input_buffer(video_decode, 130, 1);
      buf->nFlags = 0;
      buf->nOffset = 0;
      uint64_t val = (uint64_t)(pts == DVD_NOPTS_VALUE) ? 0 : pts;
     if(first_frame==true){buf->nFlags = OMX_BUFFERFLAG_STARTTIME;first_frame=false;}else{buf->nFlags = OMX_BUFFERFLAG_TIME_UNKNOWN;}
buf->nTimeStamp = ToOMXTime(val);
buf->nFilledLen = (psize > buf->nAllocLen) ? buf->nAllocLen : psize;
memcpy(buf->pBuffer, packet.data+preaded,buf->nFilledLen);
psize-=buf->nFilledLen;
preaded+=buf->nFilledLen;
     if(psize == 0){buf->nFlags|=OMX_BUFFERFLAG_ENDOFFRAME;printf("#######################################OMX_BUFFERFLAG_ENDOFFRAME\n");}
printf("=>BUFF size: %d\n",buf->nFilledLen);
OMX_ERRORTYPE r;
if(pstatus==0){if(r=OMX_EmptyThisBuffer(ILC_GET_HANDLE(video_decode), buf) != OMX_ErrorNone){status = -6;printf("Failed, OMX_EmptyThisBuffer, error: 0x%08x , buf allocate: %d, buf lenght: %d \n", r,buf->nAllocLen,buf->nFilledLen);break;}}
}//while psize
av_free_packet(&packet);
   }//if index  
}//do
while(pstatus==0); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:05:34.077

*登录控制台显示数据正确读取并正确解析到视频解码器的输入缓冲区*

你是什​​么意思？最有可能的是，从 mp4 解复用的数据包不是 OMX 解码器所期望的附件 b 形式，这是 .h264 文件（流）格式的自然形式。所以，在你读完一个 NALU 之后，用 00000001 （四个字节，最后一位打开）替换标题，你可能会很幸运。

其他需要考虑的事情：解码器可能会或可能不会期望第一个 I 帧的 SPS/PPS，等等......

**更新：** LLVM 测试套件有一个[C 源文件](https://llvm.org/svn/llvm-project/test-suite/branches/release_25/MultiSource/Applications/JM/lencod/annexb.c)可以做到这一点。您可能还对执行相反转换的参考 AVC/h264[实现感兴趣 - 从附件 B 到 NALU。](http://iphome.hhi.de/suehring/tml/doc/ldec/html/annexb_8c_source.html)

# c# - 如何解析这个 JSON（使用 JSON.NET）？

> ID：14715487
> 
> 赞同：1
> 
> 时间：2013-02-05T19:37:05.727
> 
> 标签：c#, json, json.net

我有一些有效的 JSON，但看起来有点古怪。这里是：

```
{
"server":"some server name",
"files":
{
"filename1":{"source":"original","format":"text"},
"filename2":{"source":"original","format":"text"},
"filename3":{"source":"original","format":"text"}
}
} 
```

如您所见，“文件”部分每个“文件”包含一个 JSON 对象，因此我可以将其作为 JToken 数组获取，但不确定如何获取“文件名 1”、“文件名 2”等的值。

我正在使用 JSON.NET 和 C#，所以请不要提供需要 System.Web.Extensions.dll 中的 JavaScriptSerializer 的答案。纯 JObject/JToken 调用或 JConvert.DeserializeObject<> 都可以。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:22:07.923

尝试这个

```
public class Data
{
    public Data()
    {
        Files = new Dictionary<string, FileData>();
    }
    public string Server { get; set; }
    public IDictionary<string, FileData> Files { get; set; } 
}
public class FileData
{
    public string Source { get; set; }
    public string Format { get; set; }
} 
```

然后使用它访问它

```
var result = JsonConvert.DeserializeObject<Data>(JsonValue); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T20:28:34.150

使用动态反序列化怎么样？请参阅[使用 Json.net 将 json 对象反序列化为动态对象](https://stackoverflow.com/questions/4535840/deserialize-json-object-into-dynamic-object-using-json-net)

```
string json = @"{""server"":""some server name"",""files"":{""filename1"":{""source"":""original"",""format"":""text""},""filename2"":{""source"":""original"",""format"":""text""},""filename3"":{""source"":""original"",""format"":""text""}}}";
dynamic result = JObject.Parse(json);

Console.WriteLine(result.server);
foreach (dynamic file in result.files)
{
    Console.WriteLine(file.Name);
    dynamic value = file.Value;
    Console.WriteLine(value.source);
    Console.WriteLine(value.format);
} 
```

输出

```
some server name
filename1
original
text
filename2
original
text
filename3
original
text 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T20:10:53.743

您必须像这样定义一个类：

```
class ClassName
{
    public string server;
    public ClassName2 files;
} 
```

并定义 ClassName2：

```
class ClassName2
{
    ClassName3 filename1;
    ClassName3 filename2;
    ClassName3 filename3;
} 
```

最后是 ClassName3

```
ClassName3
{
    public string source;
    public string format;
} 
```

支持您已将 json 数据保存在字符串变量中，例如“结果”

```
 ClassName fin = JsonConvert.DeserializeObject<ClassName>(result); 
```

这将为您提供所需的任何东西。

# c - 将标准错误重定向到 C 中的字符串

> ID：14715493
> 
> 赞同：4
> 
> 时间：2013-02-05T19:37:17.813
> 
> 标签：c, string, stderr, io-redirection

我希望能够将 stderr 重定向到 C 字符串，因为我需要在我正在编写的程序中使用该字符串。我想避免先写入文件（在硬盘上），然后再读取文件以获取字符串。完成这项工作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-05T20:01:26.403

您可以只使用[setbuf()](http://www.kernel.org/doc/man-pages/online/pages/man3/setbuf.3.html)来更改`stderr`'s 缓冲区：

```
#include <stdio.h>

int main(void)
{
    char buf[BUFSIZ];
    setbuf(stderr, buf);
    fprintf(stderr, "Hello, world!\n");
    printf("%s", buf);
    return 0;
} 
```

印刷：

```
Hello, world! 
Hello, world! 
```

注意：您应该在对流进行任何操作之前更改缓冲区。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:39:38.997

1.  将 stderr 重定向到 stdout 并通过管道连接到您的 C 程序。请参阅[如何通过管道传输标准错误，而不是标准输出？](https://stackoverflow.com/questions/2342826/how-to-pipe-stderr-and-not-stdout)
2.  当然，在你的 C 程序中从标准输入读取。

这是假设 stderr 来自另一个程序。如果你想从你的程序和进程中捕获所有的 stderr 输出，那么在一个单独的线程中监听对 stderr 的写入`fopen("/dev/stderr", "r")`。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-08-01T21:09:09.887

我给出了一个解决方案，使用 C++ 将 stdout 和 stderr 重定向到一个函数（每行调用）。我知道这被标记为 C，但我的解决方案的核心是使用 POSIX api。

见[https://stackoverflow.com/a/25087408/364818](https://stackoverflow.com/a/25087408/364818)

# java - 如何在不使用 Runtime.getRuntime().exec() 重写 sudo 的情况下运行 sudo 命令

> ID：14715494
> 
> 赞同：0
> 
> 时间：2013-02-05T19:37:19.150
> 
> 标签：java, runtime.exec

是否可以在 java 中创建一个终端，用户可以在其中发出 sudo 命令，而无需将 sudo 重写为 gksudo 或在基本终端中执行任何其他操作。我不想重写命令，因为我不喜欢更改用户执行的命令。我知道必须通过键盘提供 sudo 密码，但是你可以用 java 做到这一点还是不可能。我没有示例，因为我不想启动不起作用的程序，但我做了一些研究，但所有示例都是关于直接从 java 运行 sudo 而不询问用户密码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-12T17:31:38.470

没有 System.loadLibary() 没有。Termial 具有特殊功能，例如设置颜色、设置光标位置（用于 apt-get install）。但是你可以使用这个：

```
package me.barwnikk.library.linuxcommandroot;

import java.awt.BorderLayout;
import java.io.IOException;
import java.io.InputStream;

import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JPasswordField;

public class LinuxCommand {
    static InputStream is;
    static byte[] buff = new byte[8192];
    static int n;
    public static String getPasswdForRoot() throws IOException {
        Process p = Runtime.getRuntime().exec(new String[]{"sh","-c","sudo -S id"});
        is = p.getErrorStream();
        n = is.read(buff, 0, 8192);
        String text = new String(buff,0,n);
        if(text.contains("root"))return null; //not set password
        JPanel panel = new JPanel(new BorderLayout());
        JLabel lab = new JLabel(text);
        panel.add(lab,BorderLayout.NORTH);
        JPasswordField password = new JPasswordField();
        panel.add(password,BorderLayout.SOUTH);
        JOptionPane.showMessageDialog(null, panel);
        byte[] passwd = (new String(password.getPassword())+"\r\n").getBytes();
        p.getOutputStream().write(passwd);
        p.getOutputStream().flush();
        n = is.read(buff, 0, 8192);
        if(n==-1) return new String(password.getPassword());
        text = new String(buff,0,n);
        while(true) {
            lab.setText(text);
            JOptionPane.showMessageDialog(null, panel);
            p = Runtime.getRuntime().exec(new String[]{"sh","-c","sudo -S id"});
            is = p.getErrorStream();
            n = is.read(buff, 0, 8192);
            passwd = (new String(password.getPassword())+"\n").getBytes();
            p.getOutputStream().write(passwd);
            p.getOutputStream().flush();
            n = is.read(buff, 0, 8192);
            if(n==-1) return new String(password.getPassword());
            text = new String(buff,0,n);
        }
    }
    public static Process runFromRoot(String command, String password) throws IOException {
        byte[] passwd = (password+"\n").getBytes(); //for OutputStream better is byte[]
        Process p = Runtime.getRuntime().exec(new String[]{"sh","-c","sudo -S "+command});
        p.getOutputStream().write(passwd);
        p.getOutputStream().flush();
        return p;
    }
} 
```

这是一个获取root密码的迷你api（用户必须写正确）。使用示例：

```
public static void main(String[] args) throws IOException, InterruptedException {
    String password = LinuxCommand.getPasswdForRoot();
    System.out.println("stdout of 'id':");
    Process p = LinuxCommand.runFromRoot("id",password);
    System.out.print(streamToString(p.getInputStream()));
    System.out.println("stdout of 'fdisk -l':");
    p = LinuxCommand.runFromRoot("fdisk -l",password);
    System.out.print(streamToString(p.getInputStream()));
} 
```

方法流到字符串：

```
public static String streamToString(InputStream stream) {
    String read = "";
    try {
        while((n=stream.read(buff, 0, 8192))!=-1) {
            read+=new String(buff,0,n);
        }
    } catch (IOException e) {
        e.printStackTrace();
    }
    return read;
} 
```

我的测试中的样本返回（波兰语）：

```
stdout of 'id':
uid=0(root) gid=0(root) grupy=0(root)
stdout of 'fdisk -l':

Disk /dev/sda: 640.1 GB, 640135028736 bytes
głowic: 255, sektorów/ścieżkę: 63, cylindrów: 77825, w sumie sektorów: 1250263728
Jednostka = sektorów, czyli 1 * 512 = 512 bajtów
Rozmiar sektora (logiczny/fizyczny) w bajtach: 512 / 4096
Rozmiar we/wy (minimalny/optymalny) w bajtach: 4096 / 4096
Identyfikator dysku: 0xc56b9eef

Urządzenie Rozruch   Początek      Koniec   Bloków   ID  System
/dev/sda1            2048    37064703    18531328   27  Hidden NTFS WinRE
/dev/sda2   *    37064704    37269503      102400    7  HPFS/NTFS/exFAT
/dev/sda3        37269504   456711884   209721190+   7  HPFS/NTFS/exFAT
/dev/sda4       456711946  1250258624   396773339+   f  W95 Rozsz. (LBA)
Partycja 4 nie zaczyna się na granicy bloku fizycznego.
/dev/sda5       456711948   810350729   176819391    7  HPFS/NTFS/exFAT
Partycja 5 nie zaczyna się na granicy bloku fizycznego.
/dev/sda6       810350793   862802954    26226081    7  HPFS/NTFS/exFAT
Partycja 6 nie zaczyna się na granicy bloku fizycznego.
/dev/sda7       862803018  1020078408    78637695+  83  Linux
Partycja 7 nie zaczyna się na granicy bloku fizycznego.
/dev/sda8      1020079368  1229791814   104856223+   7  HPFS/NTFS/exFAT
/dev/sda9      1229791878  1250258624    10233373+   7  HPFS/NTFS/exFAT
Partycja 9 nie zaczyna się na granicy bloku fizycznego. 
```

# c# - 无限循环使 TimeManager 无效

> ID：14715504
> 
> 赞同：14
> 
> 时间：2013-02-05T19:37:43.820
> 
> 标签：c#, wpf, exception-handling, infinite-loop, unhandled-exception

我在我的 WPF 应用程序中遇到了一个非常棘手的缺陷，无法追踪。错误信息是：

> 无限循环似乎是由于在布局/渲染过程中反复使 TimeManager 无效而导致的。

堆栈跟踪（对于它的价值）是：

> 在 System.Windows.Media.MediaContext.RenderMessageHandlerCore(Object resizedCompositionTarget) 在 System.Windows.Media.MediaContext.RenderMessageHandler(Object resizedCompositionTarget) 在 System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs) 在 MS .Internal.Threading.ExceptionFilterHelper.TryCatchWhen（对象源，委托方法，对象参数，Int32 numArgs，委托catchHandler）

这是一个间歇性缺陷，我唯一能捕捉到它的地方是我捕获 Application_DispatcherUnhandledException 消息的应用程序配置文件中。我在我的应用程序中拥有的所有内容都包含在 try catch 块中，但这最终会出现在捕获未处理异常的地方。

有没有人对此有任何见解？我在互联网上搜索了一些东西，但什么也没找到，我想也许这里的某个人可能对如何追踪它有一些见解或想法。目前，我正在吞下这个异常并让应用程序继续运行，因为它似乎对它没有任何影响（除了让它崩溃）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-12T11:56:10.810

预计您将无法在代码中捕获异常：您的错误来自应用程序的 Xaml 部分，很可能来自动画。

因此，无论您是在 Xaml 中还是使用代码创建动画，例如，当动画 B 停止时触发动画 A 开始，并且在动画 A 开始时触发动画 B 停止。所以你有一个无限循环：A 开始 -> B 停止 -> A 开始 -> B 停止 -> ...

实际上有许多无限循环的情况。它们可能由 CurrentStateInvalidated 处理程序或 Completed 处理程序或 CurrentTimeInvalidated 触发，并且我可能会忘记使用其他类型的触发器（鼠标、...）和/或前面提到的三种触发器的某些场景。可能代码太复杂了。

删除所有动画以测试此场景。

尝试有一种清晰的方法来重现错误并检查哪些处理程序可能参与这样的循环并无休止地相互调用自己。

...您还可以在处理程序中使用计数器，例如，一个复选框警告您已达到给定（大）数量的调用。此复选框还将给出处理程序的名称。单击确定几次以检查循环“成员”。
您可以在发布版本中保留类似的代码并写入日志文件，只写入一次，当达到该数字时，处理程序将始终在执行任何操作之前返回。比崩溃好。

...或者只是代码审查可能会向您展示可能的循环。

希望这可以帮助。

编辑：请听我的建议：

A ) 删除所有动画，测试应用程序，看看会发生什么。B ) 如果你看不到更多的错误：这就是原因。

C ) 然后，在动画中，尝试移除最“危险”的触发器，即事件触发器。您可以使用 将 XAML 放入注释中，因此只需在动画后复制触发器即可。

D）再次测试：如果你没有看到更多的错误，这是一个事件触发器 E）检查所有的事件触发器并观察我上面描述的循环。

如果在 D) 中您仍然看到错误，请在 C) 处重复使用其他触发器（属性触发器/数据触发器）

* * *

其次：它可能是一个属性/数据触发器，其中一些数据经常变化......

* * *

也许发布一些xaml。

* * *

我有一个想法：尝试在 Application_DispatcherUnhandledException 中设置断点。然后观察内部异常的内部异常......直到到达 MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen。例外，那么您可以知道来源。我不会感到惊讶的是导致问题的 Infragistics 网格。我曾经测试过 Telerik 的控制，在解决了一些可怕的问题之后，我回到了我自己定制的经典网格：既节省了金钱又节省了时间。我很快就看到了这个网格：它们就像你的**转换器**问题或这个网格的**自定义样式**。--> 如果可能，尝试使用标准 DataGrid。
--> 如果没有错误，我们有根本原因：尝试“裸”基础架构，然后测试，然后添加样式，然后测试。我不确定您是否可以在没有转换器的情况下进行测试。仍然可以让视图模型公开“转换后的”属性......

再次：在您的帖子中，引用您的一些 xaml，描述失败案例。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-13T10:38:44.990

有时异常非常棘手。建议之一是有一个没有异常对象的 catch 块。因此，您可以从以下位置更新您的 catch 块：

```
 catch(Exception ex)
{
..
} 
```

至

```
 catch()
{
..
} 
```

[如Peli](https://stackoverflow.com/a/82712)回复中提到的，还有其他难以捕获的低级异常

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-10-17T22:27:29.957

你已经解决了你的问题吗？我正在研究一点，听起来您正在使用 Infragistics 的第三方控件，对吗？

[http://help.infragistics.com/doc/WinForms/2014.2/CLR4.0/?page=Infragistics4.Win.UltraWinStatusBar.v14.2~Infragistics.Win.UltraWinStatusBar.TimerManager.html](http://help.infragistics.com/doc/WinForms/2014.2/CLR4.0/?page=Infragistics4.Win.UltraWinStatusBar.v14.2~Infragistics.Win.UltraWinStatusBar.TimerManager.html)

他们能在这个问题上帮助你吗？

# coronasdk - 在 Corona 中创建了两次场景

> ID：14715505
> 
> 赞同：0
> 
> 时间：2013-02-05T19:37:44.413
> 
> 标签：coronasdk, transitions, scene, corona-storyboard

我在 corona sdk 中使用故事板。我的座右铭是从一个屏幕状态转到另一个屏幕状态，然后返回到第一个屏幕的相同状态。因此，当我从第一个过渡到第二个时，既没有清除场景也没有将其从内存中删除。但是当我再次回到第一个场景时，它的创建函数再次被调用，尽管第一个场景在内存中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T03:02:00.497

如果您从第二个场景中执行 storyboard.gotoScene("previousone") 并获得一个新的“上一个”场景，那么：

1.  你可能有自动清除

    (storyboard.purgeOnSceneChange == true)

2.  您可能会在运行时收到内存警告 - 您可以使用以下代码进行检查：

    本地函数 handleLowMemory(event) print("收到内存警告！") end

    运行时：addEventListener（“memoryWarning”，handleLowMemory）

# c# - ASP.NET css 样式表编辑

> ID：14715506
> 
> 赞同：0
> 
> 时间：2013-02-05T19:37:44.683
> 
> 标签：c#, asp.net, css, stylesheet

基本上我需要编辑一个css文件并保存它。

我有一个 ASP.NET c# 网页，我希望管理员从管理面板更改一些样式，只是一些颜色、背景颜色、字体大小......

例如，我希望他们选择一种颜色并按下按钮来更新它。在后面的代码中，我想访问 css 文件并将其更改到我知道的位置，然后保存文件。

这可能吗？请你帮助我好吗？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:47:57.880

我认为最好的方法是将管理设置存储在数据库中，并在页面加载时通过 javascript 更改页面的样式。例如将页面的背景颜色保存在数据库中，并在页面加载时恢复它并将其保存在字符串中像“颜色”这样的变量，然后调用像`setBackGroundColor(<%Color%>)`和 javascript 函数这样的 js 方法：

```
function setBackgroundColor(color)
{
    document.getElementById("#bodyId).style.background=color;
} 
```

.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:54:05.700

您需要将 CSS 值存储在表格中，并且您的管理屏幕会更新这些值。然后，您创建一个 ASPX 页面，该页面动态生成您的样式（使其 Response.ContentType 为“text/css”）并使用以下内容链接到它：

```
<link rel="stylesheet" href="MyDynamicStyleSheet.aspx" type="text/css" /> 
```

# excel - 当列宽每天变化时，如何自动将文本文件导入 Excel

> ID：14715507
> 
> 赞同：0
> 
> 时间：2013-02-05T19:37:48.697
> 
> 标签：excel

我每天必须将 7 个文本文件导入 Excel。我想使用宏自动执行任务，但其中一列的宽度可能会有所不同。目前我必须删除“自动”中断并插入我自己的（总是在相同的位置）。有什么方法可以修改 Excel 导入向导以不自动插入分栏符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:23:17.623

您可以通过将包含解析信息的数组传递到 TextToColumns 方法的 FieldInfo 参数来实现此目的。

FieldInfo 参数的值是一个 Array，其中包含您希望将源列拆分为的每一列数据的解析信息，并采用如下格式：

```
FieldInfo:=Array(Array(0, 1), Array(2, 1), Array(5, 1), Array(7, 1), Array(11, 1)) 
```

来自[Microsoft 的 FieldInfo](http://msdn.microsoft.com/en-us/library/office/ff193593.aspx)参数文档：

> 包含各个数据列的解析信息的数组。解释取决于 DataType 的值。当数据被分隔时，此参数是一个二元素数组，每个二元素数组指定特定列的转换选项。第一个元素是列号（从 1 开始），第二个元素是指定如何解析列的[xlColumnDataType常量之一。](http://msdn.microsoft.com/en-us/library/office/ff193030%28v=office.15%29.aspx)

因此，要将导入文件的“A”列中的数据拆分为位置 2、5、7 和 11 的单独列，并使列具有“常规”数据类型，您可以在宏中执行以下操作：

```
Columns("A:A").Select

Selection.TextToColumns Destination:=Range("A1"), DataType:=xlFixedWidth, _
    FieldInfo:=Array(Array(0, 1), Array(2, 1), Array(5, 1), _
    Array(7, 1), Array(11, 1)), _
    TrailingMinusNumbers:=True 
```

# c# - 带有数字值的 C# 枚举，将该值作为字符串读取？

> ID：14715511
> 
> 赞同：0
> 
> 时间：2013-02-05T19:38:11.543
> 
> 标签：c#, enums

如果我理解正确，我有一个分配了 int 值的枚举列表。我需要保留前导 0，所以有没有办法将此值视为字符串而不是 int？

我的枚举

```
 public enum CsvRowFormat
    {
        BeginningOfFile = 01,
        School = 02,
        Student = 03,
        EndOfFile = 04
    } 
```

目前我正在读出这样的值，我发现它效率低下

```
studentRowFormat.AppendFormat("0{0}",(int)TransactionFile.CsvRowFormat.Student).ToString(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:46:08.740

Int32 有[一个 ToString() ，它采用格式 string](http://msdn.microsoft.com/en-us/library/8wch342y.aspx)。所以最简单的方法是这样的：

```
studentRowFormat.Append(((int)TransactionFile.CsvRowFormat.Student).ToString("D2")); 
```

您不需要枚举声明中的前导 0。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:46:32.070

您可以`"{0:D2}"`用作格式字符串。它将用前导零填充字符串，直到长度为 2。

您正在使用的`enum`只是存储您分配的数值，而不是字符串值，因此它不会保留您提供前导零这一事实的知识。本机`enum`类型不能由字符串支持；它们必须由整数值支持。您可以创建自己的“看起来”像字符串支持的枚举的自定义类型，但使用这样的解决方案将比仅使用更合适的格式字符串和现有 integer 更加努力`enum`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:51:36.470

不幸的是，没有办法将值视为字符串而不是 int。请参阅[C# 枚举参考](http://msdn.microsoft.com/en-us/library/sbbt4032%28v=vs.100%29.aspx)。您可以使用其他答案提供的格式选项，或者您可以编写一个结构，让您的代码更简洁。因为我不知道您使用枚举的原因，所以我觉得我必须指出结构有一些行为差异。以下是为此解决方案使用结构的示例：

```
public struct CsvRowFormat
{
    public string Value { get; private set; }
    private CsvRowFormat(string value) : this()
    {
        Value = value;
    }

    public static BeginningOfFile { get { return new CsvRowFormat("01"); } }
    public static School { get { return new CsvRowFormat("02"); } }
    public static Student { get { return new CsvRowFormat("03"); } }
    public static EndOfFile { get { return new CsvRowFormat("04"); } }
} 
```

样品用法：

```
studentRowFormat.Append(TransactionFile.CsvRowFormat.Student); 
```

希望这可以帮助！

# java - 如何使用带变量的方法？

> ID：14715513
> 
> 赞同：2
> 
> 时间：2013-02-05T19:38:28.510
> 
> 标签：java

**Targer** - 需要计算有多少个 6 位数字的左右 3 位数字之和相同

**做了什么**- 准备了 3 种方法：

*1-st* - 从数字中计算左 3 位数字的总和 - 工作正常

```
private static int counterLeft3(int i) {
    int digitCounter=0;
    int summLeft3=0;
    while (digitCounter!=3){
        summLeft3=summLeft3+(i%10);
        i=i/10;
        digitCounter++;
    }
    return summLeft3;
} 
```

*2-nd* - 从数字中计算右 3 位数字的总和 - 工作正常

```
 private static int counterRight3(int i) {
    int summRight3=0;
    int buffer;
    int counter=0;
    while (counter!=3){
        summRight3=summRight3+(i%10);
        i=i/10;
        counter++;
    }
    buffer =i;
    summRight3=0;
    while (buffer!=0){
        summRight3=summRight3+(buffer%10);
        buffer=buffer/10;
    }
    return summRight3;
} 
```

*3-dr* - 计算 q-ty 数字的周期 - 总是返回 0。 thnink - 我的错误在这里：

```
private static void summCounter() {
    int counter=0;
    for (int i=111110; i<1000000; i++){
        if (counterRight3(i)==counterLeft3(i)){ 
        }
        counter = counter++;
    }
    System.out.println("Q-ty is " + counter);
} 
```

**调试 - 示例**

![在此处输入图像描述](../Images/ffde953f85212fda467a03087a212ae8.png)

第一种方法的结果

![在此处输入图像描述](../Images/551c01ffdca8fbc70703df5298acacfd.png)

第二种方法的结果

![在此处输入图像描述](../Images/56202107ea6c62d8c9fd61463352358d.png)

**问题**- 第三种方法有什么问题，为什么它总是只返回 0 而计数器永远不会增加？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:39:17.857

在您的*第三种*方法中，分配： -

```
counter = counter++; 
```

对`counter`价值没有影响。完成此任务后，`counter`仅剩`0`。您需要删除分配部分，并且只有`increment`部分：-

```
counter++; 
```

`if block`只有当你的左右总和相等时，你才需要在你的内部进行增量。

**也可以看看： -**

*   [后递增运算符在 for 循环中不递增](https://stackoverflow.com/questions/14571327/why-this-for-loop-never-ends/14571345#14571345)

# c - 如何为超出范围的数组提供可变存储大小？

> ID：14715514
> 
> 赞同：0
> 
> 时间：2013-02-05T19:38:32.113
> 
> 标签：c

我有一个数组和一个变量来保存它的大小。这个数组是全局的（在 main 之外）。问题是我不知道大小，所以我必须像这样声明它（伪代码）：

```
int a[]; // don't know the size yet (outside main)

int size = [user input] // this is inside main 
```

大小变量在 main 内部。这就是问题出现的地方：

用户输入*后*如何为数组指定大小？我的数组需要是全局的，所以我很难弄清楚这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:39:36.977

在 C 中，您不能拥有具有文件范围的可变长度数组。

您可以做的是使用文件范围指针并使用`malloc`.

```
#include <stdlib.h> 

int *a;  // outside main

int main(void)
{
    a = malloc(user_input * sizeof *a);  // this is inside main 

    // ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:40:58.427

您需要的是一个动态分配的数组。

```
int *a;  /* sure you need it global? */ 
```

在一个函数（main？）中初始化它：

`a= malloc(sizeof(int)*usersize);`

并阅读有关[C 内存管理的信息](http://en.cppreference.com/w/c/memory)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:41:48.550

您可以定义一个指针并指向一个将动态分配的数组

```
int *a; 
```

然后主要是当你获得大小时，你可以为你的数组和指向它的指针分配内存：

```
a = malloc(size * sizeof(int)); 
```

# c# - 多线程 - 按钮单击事件 - 在用户控件上

> ID：14715516
> 
> 赞同：0
> 
> 时间：2013-02-05T19:38:43.880
> 
> 标签：c#, .net, multithreading

在我的项目中，我有主要形式。在那个主窗体上，我在运行时调用用户控件。像这样运行的事件顺序。

1.  扫描条形码 - 对此代码进行一些处理

2.  询问用户“您要扫描更多内容吗？” 然后显示“YES/NO”选项。这不是弹出窗口，我必须在我的触摸屏计算机中为 Kiosk 更新屏幕上的消息。

3.  等待用户输入一段时间。

4.  如果用户点击“是”然后接受其他条形码。

5.  如果用户单击“否”，则进行进一步处理。

6.  如果用户没有及时回复，则按照“否”回复进行进一步处理。

问题：

1.  如何在线程之间显示按钮？

2.  如果用户回复，如何处理按钮单击事件。

    ```
    void ShowMoreVoucherOption(bool showhide)
    {
        if (this.btnYes.InvokeRequired)
        {
            this.BeginInvoke((MethodInvoker)(() => btnYes.Visible = showhide));
            this.BeginInvoke((MethodInvoker)(() => btnNo.Visible = showhide));
        }
        else
        {
            btnYes.Visible = true;
            btnNo.Visible = true;
        }
        Application.DoEvents();
    } 
    ```

我在如下线程之间调用这个例程。这不是 UI 线程。

```
UpdateProgessLabel("Would you like to add more vouchers?");
ShowMoreVoucherOption(true);
Thread.Sleep(15000);
Dofuthrerporcessing(); // in case user does not give input 
```

现在，等待 15 秒，如果用户输入，则继续按钮单击事件，如果没有，则继续此处。

我不确定 Thread.sleep 是否适合这里。还是我必须使用 ManualResetEvent 和 waitone？以及如何处理那里的按钮点击？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:59:44.730

如果您完全不知道您是否在 UI 线程中（这似乎是这个问题的重点），那么您应该创建一个后台线程来为您完成这项工作。最简单的事情是执行以下操作：

```
if(SomeKindOfAFormOrAControl.InvokeRequired) // You are not in the UI Thread
{
  Thread.Sleep(15000);
  UpdateProgessLable("Your message.");
}
else // You are in the UI Thread
{
  ThreadPool.QueueUserWorkItem(delegate {  // Spawn a Background Thread
    Thread.Sleep(15000);
    UpdateProgessLable("Your message.");
  });      
}
//Your UI thread will keep running from this point if
//SomeKindOfAFormOrAControl.InvokeRequired was false. 
```

这是你想要的？

编辑：

在 UI 线程中，您不必调用 Invoke，您可以从那里操作 UI；事实上，当您不在 UI 线程中时，您必须调用 Invoke。所以：

如果是 UI 线程需要在 15 秒后隐藏按钮，则必须像我在上面的代码中那样在后台线程中运行它：

```
ThreadPool.QueueUserWorkItem(delegate {  // Spawn a Background Thread
    Thread.Sleep(15000);
    ShowMoreVoucherOption(true);
  }); 
```

如果它不是 UI 线程，那么这段代码就足够了：

```
Thread.Sleep(15000);
UpdateProgessLable("Your message."); 
```

我猜您没有足够的关于涉及 UI 的多线程的信息。要么了解更多信息，要么尝试这些解决方案，希望你很幸运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:53:44.400

Thread.Sleep，哈？查看您的规格（不是代码），我不会这样。扫描条形码并启动计时器。每次用户及时单击“是”时重置计时器。如果用户错过了机会，请停止接受用户输入并处理已扫描的内容。您将需要某种形式的锁定以防止同时处理用户输入和计时器，并且您将摆脱不必要的 Tread.Sleep。

# javascript - Javascript - 延迟、暂停、睡眠——你在哪里？+ 用数组改变 iFrame 的 SRC

> ID：14715517
> 
> 赞同：0
> 
> 时间：2013-02-05T19:38:49.247
> 
> 标签：javascript, arrays, iframe, delay, sleep

我遇到了 setTimeout 的问题。我也试过 setInterval。我希望 JS 只是暂停或睡觉。

理论上，这段代码应该写入数组中的第一个链接，等待 3 秒，然后写入下一个，依此类推。但它甚至不会调用该函数。

```
<html>
<head></head>
<body>

<a href="http://www.google.com">Google</a>
<a href="http://www.thinkgeek.com">ThinkGeek</a>
<a href="http://www.themetapicture.com">The Meta Picture</a>

<iframe src="http://www.google.com" id="myid" name="main" width="1024" height="768">
</iframe>

<script>

function getLinksArray(){
for(var i=0; i < document.links.length; i++){
    var linx = document.links[i].href;
    setTimeout("openLinks(linx)"),3000);
}
}

function openLinks(link){
document.write(link + "<br />");
}

window.onload = getLinksArray();
</script>
</body>
</html> 
```

我问题的第二部分是将 iframe 的 src 更改为链接（而不是编写它们）。我只是将`document.write`用于测试目的以使延迟起作用。

我试过`document.getElementById("myid").src = link;`了，它根本不会做任何事情。几乎就好像 iframe 甚至不存在一样。

我不是专业人士，所以我在这里希望得到专业人士的帮助。;） 提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:44:14.263

您遇到问题*主要是*因为您不能那样打电话`setTimeout`。

您应该传递一个函数，该函数需要传递一个绑定变量，即

```
for (var i=0; i < document.links.length; i++) {
    var linx = document.links[i].href;
    setTimeout(function(linx) {
        return function() {
            openlinks(linx);
        }
    }(linx),3000);
} 
```

内部的东西是将循环变量传递给回调的“标准”Javascript方法之一。如果它没有意义，你将需要*更多*的帮助......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:45:57.320

首先，永远不要将字符串传递给`setTimeout`.

```
// old and busted
setTimeout("openLinks(linx)"),3000);

// new hotness
setTimeout(function() {
  openLinks(linx)
}, 3000); 
```

其次，生成函数的循环需要一些额外的帮助。您需要在闭包中捕获循环的值，否则该值将在使用它的函数执行之前更改。

```
function getLinksArray() {
    for (var i = 0; i < document.links.length; i++) {
        var linx = document.links[i].href;

        // create a closure for each loop iteration
        (function(linx) {
          setTimeout(function() {
            openLinks(linx);
          }, 3000);
        }(linx));

    }
}

function openLinks(link) {
    // document.write(link + "<br />");

    // document.write is also bad for a number of reasons
    someElement.innerHTML += link + "<br />"
}

window.onload = getLinksArray(); 
```

闭包魔术所做的是创建全新的局部变量，仅与循环的每次迭代中创建的函数共享。没有它，你实际上有一些看起来更像这样的东西：

```
var linx; // var linx in the loop actually get hoisted to outside the loop!
for(var i=0; i < document.links.length; i++){
    linx = document.links[i].href;
    setTimeout(function() {
      openLinks(linx)
    },3000);
  }
} 
```

看着它，您可以看到循环将完成运行，`linx`将设置该循环的最后一个值，然后您的第一个超时将使用`linx`所有超时共享的值触发。

创建和执行一个函数，传入该值可以防止提升和共享。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:51:53.253

感谢大家的帮助，我有一个最终的工作产品：

```
<html>
<head></head>
<body>

<a href="http://www.google.com">Google</a><br />
<a href="http://www.thinkgeek.com">ThinkGeek</a><br />
<a href="http://www.themetapicture.com">The Meta Picture</a>

<iframe src="http://www.google.com" id="myid" name="main" width="1024" height="768">
</iframe>

<script>
function getLinksArray() {
for (var i = 0; i < document.links.length; i++) {
  var linx = document.links;
 (function loadLink(i) {          
   setTimeout(function () {   
    document.getElementById("myid").src = linx[i].href;
    if(linx[++i])
    {
        loadLink(i);
    }
}, 20000)
})(0);

}
}

window.onload = getLinksArray();
</script>
</body>
</html> 
```

# c# - 解析包含不同类型数据的字节数组

> ID：14715519
> 
> 赞同：7
> 
> 时间：2013-02-05T19:38:55.370
> 
> 标签：c#, arrays, parsing, bytearray, byte

我有一个 1250 字节长的固定长度字节数组。它可能包含以下类型的数据：

*   由 5 个字节组成的对象 A。第一个字节包含字母“A”，接下来的四个字节存储一个从 1 到 100000 的整数。

*   由 2 个字节组成的对象 B。第一个字节包含字母“B”，下一个字节包含一个从 1 到 100 的整数。

*   由 50 个字节组成的对象 C。所有 50 个字节都用于存储 ASCII 编码的字符串，该字符串**仅**由**数字**和以下字符组成：- + ( 和 )

我不知道字节数组中有多少每种对象类型，但我知道它们被组合在一起（对象 B、对象 B、对象 A、对象 A、对象 A、对象 C 等）。大多数时候，当我解析一个字节数组时，该数组包含一种类型的数据（例如，所有项目都是对象 A）所以我确切地知道每个项目由多少个字节组成，我只是循环遍历处理字节的数组. 在这种情况下，我有三种不同类型的数据，它们的长度都不同。我在想我需要做这样的事情：

```
int offset = 0;
while (offset <= 1250)
{
    string objectHeader = Encoding.ASCII.GetString(byteArray, offset, 1);

    if (objectHeader.Equals("A"))
    {
        // read 4 more bytes and then convert into int value (1 - 100000)
        index += 5;
    }
    else if (objectHeader.Equals("B"))
    {
        // read 1 more byte and then convert into int value (1 - 100)
        index += 2;
    }
    else
    {
        // read 49 more bytes and then convert into a string
        index += 50;
    }
} 
```

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T19:54:06.423

好吧，偏移量和索引似乎有点混乱，也许您应该使用for循环：

```
for(int index = 0; index < 1250; index++)
{
    switch(byteArray[index])
    {
         case (byte)'A':
             index++;
             int value = BitConverter.ToInt32(byteArray, index);
             index += 4;
             break;

       case (byte)'B':
             index++;
             // Read the next byte as integer.
             int value = (int)byteArray[index];
             index++;
             break;

       case (byte)'C':  // string.
             index++;
             // Read the next 49 bytes as an string.
             StringBuilder value = new StringBuilder(49);
             for(int i = index; i < index + 49; index++)
             {
                 if (byteArray[i] == 0) break;
                 value.Append(Converter.ToChar(byteArray[i]));
             }
             index+= 49;
             break;

       case 0:  // Finished.
             index = 1250;
             break;
       default:
             throw new InvalidArgumentException("Invalid byte array format");
    }
} 
```

您如何查看是否没有更多对象？在我的示例中，我建议它以“\0”结尾。

祝你的任务好运。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:51:05.337

```
 int offset = 0;
      while (offset <= 1250)
      {

        switch (byteArray[offset])
        {
          case (byte)'A':
            //read other data ..
            offset += 5;
            break;
          case (byte)'B':
            //read other data ..
            offset += 2;
            break;
          case (byte)'C':
            //read other data ..
            offset += 50;
            break;
          default:
            //error
            break;
        }
      } 
```

或带有二进制阅读器的另一种变体：

```
 var reader = new BinaryReader(new MemoryStream(byteArray), Encoding.ASCII);
      while (reader.BaseStream.Position < reader.BaseStream.Length)
      {
        switch(reader.ReadChar())
        {
          case 'A':
            {
              var i = reader.ReadInt32();
              return new TypeA(i);
            }
            break;
          case 'B':
            {
              var i = reader.ReadByte();
              return new TypeB(i);
            }
            break;
          case 'C':
            {
              var chars = reader.ReadChars(49);
              return new TypeC(new string(chars.TakeWhile(ch => ch != 0).ToArray()));
            }
            break;
        }

      } 
```

# spring - 使用弹簧数据连接到 MongoDB 时出现异常

> ID：14715524
> 
> 赞同：0
> 
> 时间：2013-02-05T19:39:11.173
> 
> 标签：spring, mongodb, exception

我正在尝试`MongoDB`从我的测试用例连接到一个实例。我收到以下错误...

`Mongo`进程已启动并正在运行。关于错误原因的任何想法？

```
org.springframework.dao.DataAccessResourceFailureException: can't call something : localhost:12346/test; nested exception is com.mongodb.MongoException$Network: can't call something : localhost:12346/test
    at org.springframework.data.mongodb.core.MongoExceptionTranslator.translateExceptionIfPossible(MongoExceptionTranslator.java:56)
    at org.springframework.data.mongodb.core.MongoTemplate.potentiallyConvertRuntimeException(MongoTemplate.java:1644)
    at org.springframework.data.mongodb.core.MongoTemplate.executeFindOneInternal(MongoTemplate.java:1507)
    at org.springframework.data.mongodb.core.MongoTemplate.doFindOne(MongoTemplate.java:1309)
    at org.springframework.data.mongodb.core.MongoTemplate.findOne(MongoTemplate.java:489)
    at org.springframework.data.mongodb.core.MongoTemplate.findOne(MongoTemplate.java:484)
    at org.springframework.data.mongodb.repository.query.AbstractMongoQuery$SingleEntityExecution.execute(AbstractMongoQuery.java:202)
    at org.springframework.data.mongodb.repository.query.AbstractMongoQuery.execute(AbstractMongoQuery.java:90)
    at org.springframework.data.repository.core.support.RepositoryFactorySupport$QueryExecutorMethodInterceptor.invoke(RepositoryFactorySupport.java:313)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy69.findById(Unknown Source)
    at com.test.ServiceImpl.save(ServiceImpl.java:58)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy71.save(Unknown Source)
    at com.SearchTestCase.setUp(SearchTestCase.java:50)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:80)
    at org.testng.internal.Invoker.invokeConfigurationMethod(Invoker.java:564)
    at org.testng.internal.Invoker.invokeConfigurations(Invoker.java:213)
    at org.testng.internal.Invoker.invokeMethod(Invoker.java:653)
    at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:901)
    at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1231)
    at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:127)
    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)
    at org.testng.TestRunner.privateRun(TestRunner.java:767)
    at org.testng.TestRunner.run(TestRunner.java:617)
    at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
    at org.testng.SuiteRunner.run(SuiteRunner.java:240)
    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)
    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)
    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1197)
    at org.testng.TestNG.runSuitesLocally(TestNG.java:1122)
    at org.testng.TestNG.run(TestNG.java:1030)
    at org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)
    at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)
    at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175)
Caused by: com.mongodb.MongoException$Network: can't call something : localhost:12346/test
    at com.mongodb.DBTCPConnector.call(DBTCPConnector.java:227)
    at com.mongodb.DBApiLayer$MyCollection.__find(DBApiLayer.java:305)
    at com.mongodb.DBCollection.findOne(DBCollection.java:647)
    at com.mongodb.DBCollection.findOne(DBCollection.java:626)
    at org.springframework.data.mongodb.core.MongoTemplate$FindOneCallback.doInCollection(MongoTemplate.java:1699)
    at org.springframework.data.mongodb.core.MongoTemplate$FindOneCallback.doInCollection(MongoTemplate.java:1684)
    at org.springframework.data.mongodb.core.MongoTemplate.executeFindOneInternal(MongoTemplate.java:1503)
    ... 48 more
Caused by: java.net.SocketException: Connection reset by peer: socket write error
    at java.net.SocketOutputStream.socketWrite0(Native Method)
    at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)
    at java.net.SocketOutputStream.write(SocketOutputStream.java:136)
    at org.bson.io.PoolOutputBuffer.pipe(PoolOutputBuffer.java:129)
    at com.mongodb.OutMessage.pipe(OutMessage.java:111)
    at com.mongodb.DBPort.go(DBPort.java:119)
    at com.mongodb.DBPort.call(DBPort.java:79)
    at com.mongodb.DBTCPConnector.call(DBTCPConnector.java:218)
    ... 54 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T12:10:14.507

您的`mongod`进程是否在端口 123456 上运行？

的默认端口`mongod`是**27017**。我建议更改您的连接字符串以在此端口而不是**123465**上运行。

# uitableview - 多个表视图中的不同 NSpredicate

> ID：14715526
> 
> 赞同：0
> 
> 时间：2013-02-05T19:39:30.590
> 
> 标签：uitableview, core-data, nspredicate, nsfetchedresultscontroller, nsfetchrequest

我只是无法停止搜索和阅读有关“更改谓词”的内容，但我仍然不知道如何解决我的问题，所以......我所拥有的是：

1 - 几个带有不同单元格的表格视图，每个单元格都有多个文本字段。

2 - 用户按下这些文本字段之一并出现一个表格视图（在弹出框内）。

3 - 此 popoverTableview 具有所有核心数据“工作”，并且假设提供要插入到按下的文本字段中的数据。

4 - 一切正常......除了我需要每次用户通过时更改谓词，例如从 tableview1 到 tableview2。

5 - 下面是我的 popoverTableview 中的 NSFetchedResultsController 方法，我尝试了多种方法，例如：“if´s”；“开关”；还指向 tableviews 中的 textfield 标记，什么都没有。我想我不需要将缓存设置为 nil，因为它已经设置为 nil ...还尝试删除： if (_fetchedResultsController != nil) return _fetchedResultsController;

什么都没有！！！，我需要了解什么？我没有得到什么？我在这个上失去了几天。帮助！

```
- (NSFetchedResultsController *)fetchedResultsController
{
if (_fetchedResultsController != nil)
{
    return _fetchedResultsController;
}

NSFetchRequest *fetchRequestList = [[NSFetchRequest alloc] init];
NSEntityDescription *entityList = [NSEntityDescription entityForName:@"List" inManagedObjectContext:self.managedObjectContext];
[fetchRequestLista setEntity:entityList];

TableViewOne *table1 = [[Cobertura alloc]init];
TableViewTwo *table2 = [[Cobertura alloc]init];    

if (table1 textFieldShouldBeginEditing:table1.textFieldPressed)
{
fetchRequestList.predicate = [NSPredicate predicateWithFormat:@"%K IN %@", @"reference", arrayTableview1];
}

if (table2 textFieldShouldBeginEditing:table2.textFieldPressed)
{
fetchRequestList.predicate = [NSPredicate predicateWithFormat:@"%K IN %@", @"reference", arrayTableview2];
}

NSSortDescriptor *cellTitle = [[NSSortDescriptor alloc] initWithKey:@"reference" ascending:YES];
NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:cellTitle, nil];
[fetchRequestLista setSortDescriptors:sortDescriptors];

_fetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequestLista managedObjectContext:self.managedObjectContext sectionNameKeyPath:@"referencia" cacheName:nil];
_fetchedResultsController.delegate = self;
self.fetchedResultsController = _fetchedResultsController;

return _fetchedResultsController;
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-04T06:15:39.467

你只需要明确地 nil 你的 FRC。然后让 FRC 执行 fetch。

FRC 的自定义 getter 方法看起来不错。它确保 tableview1 和 tableview2 的谓词不同，并相应地构造 FRC。但只有当 FRC 为 nil 时，它才能完成所有这些工作。如果不是，它只返回支持实例变量 _fetchedResultsController 并且根本不执行其余代码；这就是为什么你需要在切换表视图时显式地清空你的 FRC。

# c++ - GetDC(NULL) 获取主监视器或虚拟屏幕？

> ID：14715527
> 
> 赞同：11
> 
> 时间：2013-02-05T19:39:30.810
> 
> 标签：c++, c, winapi

环顾网络，我发现大多数人认为 GetDC(NULL) 将获得整个*主*监视器的设备上下文（左上角有 0,0 的那个）。但是，我感觉大多数人只是这么说，因为 GetDC 的 msdn 页面*可能*会这么说。

但是，如果您查看以下两页（至少这两页）似乎在说 GetDC(NULL) 返回一个覆盖整个*虚拟*屏幕的设备上下文（包含连接到系统的每个监视器的设备上下文）。

(1) [https://www.microsoft.com/msj/0697/monitor/monitor.aspx](https://www.microsoft.com/msj/0697/monitor/monitor.aspx) -> 在页面中搜索“这将获取虚拟桌面的 RECT”并查看该语句周围的位（尤其是 GetDC （NULL）在它上面）。

(2) [http://msdn.microsoft.com/en-gb/library/windows/desktop/dd162610%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-gb/library/windows/desktop/dd162610%28v=vs.85%29.aspx) -> 在页面中搜索“GetDC(NULL)”

我一直试图弄清楚它到底是什么，但众多相互矛盾的意见让我失望。

有没有人有这方面的实际经验，并且可以在多显示器系统上进行测试？（我只有一台显示器，所以我不能。）

它是得到一个覆盖整个主显示器的 DC 还是一个覆盖整个虚拟屏幕的 DC？

**编辑**

对于任何想尝试它的人，在我的系统上，如果我创建一个默认项目并将以下内容放在 WinMain 中，它会使屏幕变黑。如果您有多个显示器并尝试使用它，那么问题就变成了它只是将您的主显示器变黑还是将所有显示器变黑？

```
HDC hdc = GetDC(NULL);
RECT r = {LONG_MIN, LONG_MIN, LONG_MAX, LONG_MAX};
FillRect(hdc, &r, (HBRUSH)(COLOR_BTNTEXT + 1));
ReleaseDC(NULL, hdc); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-05T19:55:00.423

它得到一个覆盖整个虚拟屏幕的 DC。我刚刚测试过：

```
#include <windows.h>
#include <conio.h>

int main() {

    HDC screen = GetDC(NULL);

    RECT r = {-1200, 100, -200, 500};
    HBRUSH br = CreateSolidBrush(RGB(0, 255, 0));

    FillRect(screen, &r, br);

    getch();
    InvalidateRect(NULL, &r, true);

    return 0;
} 
```

...并且它成功地在我的辅助屏幕上绘制了一个绿色矩形（位于主屏幕的左侧，因此它具有负 X 坐标）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T20:00:41.360

我目前正在尝试重写一个 gamma setter 实用程序，因为它使用 GetDC(NULL) 而不是 EnumDisplayMonitors + GetDC，因此会更改整个桌面的 gamma。

你的程序是相似的，它把两个显示器都涂成黑色。

# android - 无法在 ICS 上获取联系人的名字和姓氏

> ID：14715528
> 
> 赞同：5
> 
> 时间：2013-02-05T19:39:32.427
> 
> 标签：android, android-contacts

我有这个代码来获取联系人的名字和姓氏：

```
 uri = ContactsContract.Data.CONTENT_URI;
                Cursor curName = getContentResolver().query(uri, null, ContactsContract.Data.CONTACT_ID +" = "+ contactId, null, null);
                if (curName.getCount() > 0){
                    curName.moveToFirst();
                    String nameGiven = curName.getString(curName.getColumnIndex(ContactsContract.CommonDataKinds.StructuredName.GIVEN_NAME));
                    String nameFamily = curName.getString(curName.getColumnIndex(ContactsContract.CommonDataKinds.StructuredName.FAMILY_NAME));
                    log += nameGiven + ", " + nameFamily + ": ";
                } 
```

我只有一个联系人，所以我不需要循环。在 2.3.5 设备上它工作正常，返回正确的名称。但在 4.0.4 设备上，这两个字段都返回 null，但如果请求显示名称，它会正确提供。

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-11T12:03:25.823

好吧，数据表和联系人表中的_ID是两个不同的东西。所以查询数据表时应该使用**raw_contacts_id**而不是**_id 。**

让我快速输入一段代码来帮助您入门

```
// projection
String[] projection = new String[] {ContactsContract.CommonDataKinds.StructuredName.FAMILY_NAME, ContactsContract.CommonDataKinds.StructuredName.GIVEN_NAME, ContactsContract.CommonDataKinds.StructuredName.MIDDLE_NAME};

String where = ContactsContract.Data.RAW_CONTACT_ID + " = ? AND " + ContactsContract.Data.MIMETYPE + " = ?"; 
String[] whereParameters = new String[]{this.contact_id, ContactsContract.CommonDataKinds.StructuredName.CONTENT_ITEM_TYPE};

//Request
Cursor contacts = this.resolver.query(ContactsContract.Data.CONTENT_URI, projection, where, whereParameters, null);

//Iteration
if (contacts.moveToFirst()) { 
    //code here, E.g
                String nameGiven = contacts.getString(contacts.getColumnIndex(ContactsContract.CommonDataKinds.StructuredName.GIVEN_NAME));
                String nameFamily = contacts.getString(contacts.getColumnIndex(ContactsContract.CommonDataKinds.StructuredName.FAMILY_NAME));

                //log += nameGiven + ", " + nameFamily + ": "; 

} 
contacts.close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T07:42:31.663

嗨，我认为光标查询需要修复，我通常这样使用

```
Cursor c = getContentResolver().query(ContactsContract.Data.CONTENT_URI, null, ContactsContract.Data.CONTACT_ID + " = ?", new String[] {String.valueOf(contactId)}, null);
if (c.moveToFirst()){
    // get your code to get content on that cursor ex: c.getString(0)
} 
```

请查看此[链接](http://developer.android.com/reference/android/provider/ContactsContract.Data.html)， 希望对您有所帮助。

# scheme - 添加解释

> ID：14715529
> 
> 赞同：0
> 
> 时间：2013-02-05T19:39:32.633
> 
> 标签：scheme, racket

如果这是一个愚蠢的问题，请原谅，但我只想知道他们到底是什么意思？

```
 (define-struct squar (x y size outline c)) 
```

“为 Square 类添加解释”

我试过在网上查这个，但没有。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T22:04:34.653

这 (make-square 10 20 30 "solid" "red") 评估为一个结构。

这个结构代表什么？

问题的答案，是一种解释。

一种合理的解释是，上面的值表示一个 30x30 的正方形，其左上角的屏幕坐标为 (10,20)，其内部被红色填充（它是实心的）。

# actionscript-3 - 如何获取StaticText的字体属性？

> ID：14715530
> 
> 赞同：1
> 
> 时间：2013-02-05T19:39:34.120
> 
> 标签：actionscript-3

我正在制作一个用于翻译 swfs 的 flash web 应用程序。它[加载](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/Loader.html)一个包含多个[StaticText](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/StaticText.html)的 swf 文件。我最初想更改这些文本，但不幸的是该`text`属性是只读的。我的解决方案是隐藏它们 ( `visibility = false`) 并在它们的位置添加[TextField](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/text/TextField.html)。我能够做到这一点，但我找不到任何方法让新的看起来一样。我需要将它们设置为**相同的字体、大小和颜色**。

如果您要问，我使用了所有字体，所以这应该没有任何问题。此外，我无法更改原始文章文件以使用动态文本字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:09:22.057

以编程方式获取静态文本字段的文本格式似乎是不可能的。

但是，您可以获取其中的文本，或获取它的位图副本（以获取颜色）除非您深入研究二进制代码，否则应该无法获取该信息...

但是，可以使用一些 SWF 反编译器获取该信息。我实际上并没有尝试过使用静态文本，但它可能值得一试，因为它们并没有真正遵守通过 API 提供的规则:)

# javascript - 如何避免此 jQuery 代码中的重复代码？

> ID：14715532
> 
> 赞同：-1
> 
> 时间：2013-02-05T19:39:36.850
> 
> 标签：javascript, jquery, simplify, iteration

我正在制作一个网站，这段代码让我在 1 个 .html 文件中有几个页面。可以避免此代码的迭代性吗？可以简化吗？

```
<script type="text/javascript">
        var x = 300;
        $(function() { 
            $("#indexLink").click(function() { 
                $("#content>div").not("#start").hide(x);
                $("#index").show(x);
                $('nav>ul>li').removeClass('active');
                $('#indexLink').addClass('active');
            });

            $("#leerlingLink").click(function() { 
                $("#content>div").not("#start").hide(x); 
                $("#leerling").show(x); 
                $('nav>ul>li').removeClass('active');
                $('#leerlingLink').addClass('active');
            });

            $("#bestemmingLink").click(function() { 
                $("#content>div").not("#start").hide(x); 
                $("#bestemming").show(x);
                $('nav>ul>li').removeClass('active');
                $('#bestemmingLink').addClass('active');
            });

            $("#betalingLink").click(function() { 
                $("#content>div").not("#start").hide(x); 
                $("#betaling").show(x);
                $('nav>ul>li').removeClass('active');
                $('#betalingLink').addClass('active');
            });
        });

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:48:21.517

假设被点击的东西不是锚链接，你可以给元素所有相同的类并写一次 -

编辑：根据这些是锚链接的信息进行了更改。

```
$('.classname').click(function(event) {
    event.preventDefault(); 
    $("#content>div").not("#start").hide(x);
    var idString = this.id
    var shortIDString = idString.slice(0,-4); //remove the 'Link'
    $("#" + shortIDString).show(x);
    $('nav>ul>li').removeClass('active');
    $(this).addClass('active');
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:45:14.987

您可以使用 for 循环并构造选择器：

```
$(function () {
    var items = ["index", "leerling", "bestemming", "betaling"];
    for (var i = 0; i < items.length; i++) {
        var item = items[i];
        $("#" + item + "Link").click(function () {
            $("#content>div").not("#start").hide(x);
            $("#" + item).show(x);
            $('nav>ul>li').removeClass('active');
            $('#' + item + 'Link').addClass('active');
        });
    }
}); 
```

您还可以向 all 添加一个处理程序`#whateverLinks`，然后根据事件目标的 id 值检测链接名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:46:47.413

你是什​​么意思`iterative-ness`？

如果你希望你的代码是干燥的，你可以写这样的东西：

```
<script type="text/javascript">
    var x = 300;
    $(function () {
        $("#indexLink,#betalingLink,#bestemmingLink,#leerlingLink").click(function () {
            $("#content>div").not("#start").hide(x);
            $("#"+$(this).attr("id").slice(0,-4)).show(x);
            $('nav>ul>li').removeClass('active');
            $('#indexLink').addClass('active');
        });
    });
</script> 
```

这将采用所有选择器，一次一个，并让所有选择器运行您的代码，与您键入的代码基本相同，但仅在一个选择器中

**编辑**

固定 div 显示

**编辑2**

添加了 jsfiddle 以显示它的工作原理：http: [//jsfiddle.net/NicosKaralis/Vurjf/](http://jsfiddle.net/NicosKaralis/Vurjf/)

# javascript - 移动 Safari 页面卸载/隐藏/模糊以进行深度链接

> ID：14715535
> 
> 赞同：29
> 
> 时间：2013-02-05T19:39:45.410
> 
> 标签：javascript, ios, safari, mobile-safari, deep-linking

我正在寻找一个关于移动 safari 的事件，该事件将检测页面何时因重定向而被隐藏。如果用户安装了我的应用程序，我想直接打开它，如果已安装，则尝试使用 facebook，如果没有，则转到该 id 的网页。

1.  如果安装了“myapp”，则打开 myapp。但是 safari 选项卡仍然被重定向到 facebook.com
2.  如果未安装“myapp”，但安装了 facebook，则打开 facebook ios 应用程序。但是 safari 选项卡仍然被重定向到 facebook.com

我用以下 HTML/JS创建了一个[测试链接：](http://www.codenothing.com/dev/stackoverflow/deep-link/)

```
 <!DOCTYPE html>
    <html>
    <head>
            <title>Redirect Test</title>
            <script type='text/javascript' src='//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js'></script>
            <meta name='viewport' content='initial-scale = 1.0,maximum-scale = 1.0' />
    </head>
    <body>
    <button>Open Oreo</button>
    <script type='text/javascript'>
    jQuery(function(){
            jQuery( 'button' ).on( 'click', function(){
                    var myid = null, fbid = null;

                    // Watch for page leave to kill timers
                    jQuery( window ).on( 'pagehide pageshow blur unload', function(){
                            if ( myid ) {
                                    clearTimeout( myid );
                            }
                            if ( fbid ) {
                                    clearTimeout( fbid );
                            }
                    });

                    window.location = "myapp://fbprofile/oreo";
                    var myid = setTimeout(function(){

                            // My app doesn't exist on device, open facebook
                            window.location = "fb://profile/oreo";
                            fbid = setTimeout(function(){

                                    // Facebook doesn't exist on device, open facebook mobile
                                    window.location = "https://www.facebook.com/oreo";
                            }, 100);
                    }, 100);
            });
    });
    </script>
    </body>
    </html> 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-07T12:49:49.337

不错的代码。
**编辑：（**删除了关于添加的建议`return false;`）

尝试在您的`setTimeout`函数中设置检查，而不仅仅是清除超时。（我发现清除间隔比简单的 1 次 setTimeout 调用更有效）。此外，在尝试像我这样的本机应用程序协议之前，我会检查以确保用户不在桌面浏览器上，`app://`或者`fb://`因为这些浏览器会尝试遵循该位置并最终显示错误。

尝试：

```
<!DOCTYPE html>
<html>
<head>
    <title>Redirect Test</title>
    <script type='text/javascript' src='//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js'></script>
    <meta name='viewport' content='initial-scale = 1.0,maximum-scale = 1.0' />
</head>
<body>
<button>Open Oreo</button>
<script type='text/javascript'>
var mobileExp = /android|avantgo|blackberry|blazer|compal|elaine|fennec|hiptop|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile|o2|opera mini|palm( os)?|plucker|pocket|pre\/|psp|smartphone|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce; (iemobile|ppc)|xiino/i;

jQuery(function(){
    jQuery( 'button' ).on( 'click', function(){

        // Don't give desktop browsers a chance to fail on a nativeapp:// protocol
        if(!mobileExp.test(navigator.userAgent)) {
            window.location = "https://www.facebook.com/oreo";
            return;
        }

        var clicked = +new Date, timeout = 100;

        window.location = "myapp://fbprofile/oreo";

        setTimeout(function(){
            // If we're still here after a (timeout), try native facebook app
            if (+new Date - clicked < timeout*2){
                console.log('clicked '+ (+new Date - clicked) +' ago- go to FB');
                window.location = "fb://profile/oreo";
            } else {
                console.log('too late for facebook');
            }
            setTimeout(function(){
                // If we're still here after another (timeout), try facebook web app
                if (+new Date - clicked < timeout*2){
                    console.log('clicked '+ (+new Date - clicked) +' ago- go to browser');
                    window.location = "https://www.facebook.com/oreo";
                } else {
                    console.log('too late for browser');
                }
            }, timeout);
        }, timeout);
    });
});
</script>
</body>
</html> 
```

当然，取消注释控制台日志并对`timeout`. 这个确切的代码在 IOS 6.1 Safari 和 Safari 6.0.2 Mac 中成功测试。希望能帮助到你！

# jakarta-mail - 在特定日期时间后获取更改/更新的邮件列表

> ID：14715536
> 
> 赞同：0
> 
> 时间：2013-02-05T19:39:47.077
> 
> 标签：jakarta-mail

我正在尝试实现一个简单的同步引擎，它将在 imap 服务器和我的本地客户端之间同步更改，这是由 javamail API 开发的。是否有任何方法可以在来自服务器的一个查询中针对上次更新的日期时间值进行新到达、标记更改、删除等更改？

例如：假设我的最后一次同步时间是 01/03/2013 @ 23.00。

如果我在上述时间后查询更改，我期待如下所示：

*   消息 id: xxxxxxxxx :- 已加星标
*   消息 id: yyyyyyyyy :- 已删除
*   消息 id: ppppppppp :- 未读
*   消息 id: ppppppppp :- 加星标
*   …………
*   …………

否则，如果您有更好的方法在服务器 - 客户端文件夹之间同步，请也提及这些。等待非常快速的响应。

提前致谢。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T01:15:11.173

简单的答案是否定的，你不能用一个查询来做到这一点。

稍长的答案是您不想根据日期/时间执行此操作，而是基于消息 UID。这将允许您检测添加/删除的消息。要检测消息标志的变化，您需要查询所有消息的所有标志，然后将它们与保存的标志副本进行比较。

这是离线操作的一般问题，以及将离线操作与服务器上所做的更改同步。[从RFC 4549](https://www.ietf.org/rfc/rfc4549.txt)开始并向后工作以找出如何使用 JavaMail 进行操作。

# python - pySerial sourceforge 网站上不提供 pySerial 2.6

> ID：14715542
> 
> 赞同：2
> 
> 时间：2013-02-05T19:40:06.653
> 
> 标签：python, pyserial

有谁知道为什么 PySerial 网站声明该文档适用于 PySerial 2.6，但您无法访问它引导您访问的 Source Forge 网站并下载比 2.5 更新的任何内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:54:31.863

我可以肯定地从[http://pypi.python.org/pypi/pyserial](http://pypi.python.org/pypi/pyserial)下载它.....这不是你在看的地方吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:27:33.657

我还看到他们从该页面获得的各种链接中存在一些混乱。但是，我相信，如果您查看 SVN 存储库链接[http://sourceforge.net/scm/?type=svn&group_id=46487](http://sourceforge.net/scm/?type=svn&group_id=46487)，那么从那里他们有另一个链接[http://pyserial.svn.sourceforge.net/viewvc/ pyserial/](http://pyserial.svn.sourceforge.net/viewvc/pyserial/)这就是他们似乎有更新代码的地方（最后一次更改是 5 个月前）

# c# - 在 Windows C++ 或 C# 中，您能否询问操作系统当前是否正在关闭/重新启动/注销

> ID：14715544
> 
> 赞同：6
> 
> 时间：2013-02-05T19:40:29.940
> 
> 标签：c#, c++, logout, restart, shutdown

我有一个在关机期间发生的问题。我有一段用 C++ 编写的代码，它被包装在一个 .dll 中并注入到其他应用程序中。它做了很多事情，包括启动另一个用 C# 编写的应用程序（服务器）。

但是，在启动关机后，c++ 代码会启动 C# 应用程序，因为它已被关机杀死，由于系统即将关机而立即崩溃。

然后一个错误框会停止关机，直到用户处理它，这很烦人。有没有办法询问操作系统，“嘿，你要关闭/重新启动/注销吗？” 所以在发生这种情况时我不启动应用程序？我想任何一端的解决方案都可以。

==**编辑**==

为了更清楚一点。作为注入的 .dll 运行的代码不能假定其注入的应用程序具有任何类型的“窗口”。另外，我想要一些我可以查询的东西，而不是我必须听的事件，因为我可能会因为时间问题错过那个事件。我想知道是否有任何功能可以有效地给我这样的东西

```
bool IsSystemShutting(); 
```

在这方面，C# 选项和 C++ 选项一样适用于我。但在 .NET 框架中， [SystemEvents.SessionEnding](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.sessionending.aspx)和[SystemEvents.SessionEnded](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents.sessionended.aspx)都是事件与属性。通常情况下，我会在事件发生后注册这个事件，所以这对我没有好处。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:47:46.087

[WM_ENDSESSION](http://msdn.microsoft.com/en-us/library/windows/desktop/aa376889%28v=vs.85%29.aspx)和[WM_QUERYENDSESSION](http://msdn.microsoft.com/en-us/library/windows/desktop/aa376890%28v=vs.85%29.aspx)消息适用于这种情况。当启动关闭、重新启动或注销过程时，Windows 会将这些窗口消息发送到窗口。

# c++ - C++ 从字符串中提取数据

> ID：14715546
> 
> 赞同：3
> 
> 时间：2013-02-05T19:40:34.247
> 
> 标签：c++, boost

什么是从字符串中提取数据的优雅方法（可能使用 boost 库）？

```
Content-Type: text/plain
Content-Length: 15
Content-Date: 2/5/2013
Content-Request: Save

hello world 
```

假设我有上面的字符串并想提取所有字段，包括 hello world 文本。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:47:02.183

尝试

*   **[http://pocoproject.org/](http://pocoproject.org/)**

    附带 HTTPServer 和 Client 实现

*   **[http://cpp-netlib.github.com/](http://cpp-netlib.github.com/)**

    带有请求/响应处理

*   **Boost Spirit**演示： http: [//liveworkspace.org/code/3K5TzT](http://liveworkspace.org/code/3K5TzT)

    您必须指定一个简单的语法（或者复杂的，如果您想“捕捉”HTTP 的所有细微之处）

    ```
    #include <boost/fusion/adapted.hpp>
    #include <boost/spirit/include/qi.hpp>
    #include <boost/spirit/include/karma.hpp>

    typedef std::map<std::string, std::string> Headers;
    typedef std::pair<std::string, std::string> Header;
    struct Request { Headers headers; std::vector<char> content; };

    BOOST_FUSION_ADAPT_STRUCT(Request, (Headers, headers)(std::vector<char>, content))

    namespace qi    = boost::spirit::qi;
    namespace karma = boost::spirit::karma;

    template <typename It, typename Skipper = qi::blank_type>
        struct parser : qi::grammar<It, Request(), Skipper>
    {
        parser() : parser::base_type(start)
        {
            using namespace qi;

            header = +~char_(":\n") > ": " > *(char_ - eol);
            start = header % eol >> eol >> eol >> *char_;
        }

      private:
        qi::rule<It, Header(),  Skipper> header;
        qi::rule<It, Request(), Skipper> start;
    };

    bool doParse(const std::string& input)
    {
        auto f(begin(input)), l(end(input));

        parser<decltype(f), qi::blank_type> p;
        Request data;

        try
        {
            bool ok = qi::phrase_parse(f,l,p,qi::blank,data);
            if (ok)   
            {
                std::cout << "parse success\n";
                std::cout << "data: " << karma::format_delimited(karma::auto_, ' ', data) << "\n";
            }
            else      std::cerr << "parse failed: '" << std::string(f,l) << "'\n";

            if (f!=l) std::cerr << "trailing unparsed: '" << std::string(f,l) << "'\n";
            return ok;
        } catch(const qi::expectation_failure<decltype(f)>& e)
        {
            std::string frag(e.first, e.last);
            std::cerr << e.what() << "'" << frag << "'\n";
        }

        return false;
    }

    int main()
    {
        const std::string input = 
            "Content-Type: text/plain\n"
            "Content-Length: 15\n"
            "Content-Date: 2/5/2013\n"
            "Content-Request: Save\n"
            "\n"
            "hello world";

        bool ok = doParse(input);

        return ok? 0 : 255;
    } 
    ```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-05T19:49:37.397

这是一个用 C 编写的非常紧凑的代码： [https ://github.com/openwebos/nodejs/blob/master/deps/http_parser/http_parser.c](https://github.com/openwebos/nodejs/blob/master/deps/http_parser/http_parser.c)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T19:46:53.777

有几种解决方案。如果格式很简单，您可以简单地逐行读取文件。如果该行以键开头，您可以简单地将其拆分以获取值。如果不是，则该值就是该行本身。使用 STL 可以非常轻松且非常优雅地完成它。

如果语法更复杂，并且当您向标签添加 boost 时，您可以考虑使用 Boost Spirit 来解析它并从中获取值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-05T19:47:42.950

我认为最简单的解决方案是使用[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)。C++ **11**中有一个[标准](http://en.wikipedia.org/wiki/C++11#Regular_expressions)的正则表达式，有些可以在[boost](http://www.boost.org/doc/libs/1_53_0/libs/regex/doc/html/index.html)中找到。

 *** * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-05T19:47:21.723

您可以使用`string::find`空格来查找它们的位置，然后从该位置复制，直到找到`'\n'`

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-05T19:54:54.260

如果您想自己编写代码来解析它，请先查看[HTTP 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html)。这将为您提供语法：

```
 generic-message = start-line
                      *(message-header CRLF)
                      CRLF
                      [ message-body ]
    start-line      = Request-Line | Status-Line 
```

所以我要做的第一件事是在 CRLF 上使用[split()](https://stackoverflow.com/a/236803/74815)将其分解为复合行。然后您可以遍历生成的向量。直到你得到一个空白 CRLF 的元素，你正在解析一个标题，所以你在第一个 ':' 上拆分以获取键和值。

一旦你点击了空元素，你就在解析响应体。

警告：过去我自己做过这件事，我可以告诉你，并不是所有的网络服务器都与行尾一致（你可能在某些地方只找到一个 CR 或一个 LF），并且并非所有的浏览器/其他抽象层都与什么一致他们传给你。因此，您可能会在您不期望的地方找到额外的 CRLF，或者在您期望的地方缺少 CRLF。祝你好运。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-05T19:47:15.027

如果您准备手动展开循环，则可以使用[`std::istringstream`](http://www.cplusplus.com/reference/sstream/istringstream/?kw=istringstream)提取运算符的正常重载（使用适当的操纵器，例如`get_time()`用于处理日期）以简单的方式提取数据。

另一种可能性是用于[`std::regex`](http://www.cplusplus.com/reference/regex/)匹配所有模式，例如`<string>:<string>`并遍历所有匹配项（`egrep`如果您有几行要处理，语法似乎很有希望）。

或者，如果你想用难的方式来做，并且你的字符串有特定的语法，你可以使用[Boost.Spirit](http://boost-spirit.com/home/)轻松定义语法并生成解析器。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-05T20:02:52.530

如果您可以访问 C+11，则可以使用 std::regex ( [http://en.cppreference.com/w/cpp/regex](http://en.cppreference.com/w/cpp/regex) )。

```
std::string input = "Content-Type: text/plain";
std::regex contentTypeRegex("Content-Type: (.+)");

std::smatch match;

if (std::regex_match(input, match, contentTypeRegex)) {
     std::ssub_match contentTypeMatch = match[1];
     std::string contentType = contentTypeMatch.str();
     std::cout << contentType;
}
//else not found 
```

在此处编译/运行版本：http: [//ideone.com/QTJrue](http://ideone.com/QTJrue)

这个正则表达式是一个非常简单的例子，但它对于多个字段的原理是一样的。**

# arrays - 结构填充数组

> ID：14715549
> 
> 赞同：2
> 
> 时间：2013-02-05T19:40:45.493
> 
> 标签：arrays, struct, padding

如果我有这样的结构：

```
struct { 
       int a; 
       int b;
       int values[20];
       } 
```

它将有任何类型的填充？

我已经搜索过这个问题，但我发现的所有信息都是不同数据类型之间的填充。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:48:24.043

> 它将有任何类型的填充？

我认为填充是实现定义的。然而，一个合理的解释是它不会，因为所有成员都必须对齐相同数量的字节。在我的带有 GCC 的 Mac（OS 10.7.5）上确实如此：

![在此处输入图像描述](../Images/e010361f8d8336ffedabb1d5b7858d76.png)

（结构的大小是 88 字节：4 + 4 + 20 * 4，所以没有填充。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T17:10:54.563

我认为在这种情况下标准允许的唯一填充是所有`int`变量都通用的填充。尽管通常`int`使用它覆盖的内存位置中存在的所有位`unsigned char`，但这不是必需的。一些数字信号处理器具有非 2 次幂长度的累加器，例如 36、40 或 48 位（这个想法是人们经常想要将一堆 32 位数字相加，其总和将超过 32 位；一个需要大于 32 位的累加器，但 64 位累加器将是巨大的矫枉过正）。具有 16 位内存总线的 DSP 可能能够`char`从内存中读取和写入值，但需要对其他所有内容进行特定对齐。如果这样的 DSP 有一个 40 位的累加器，那么这样的设备可以存储它的`int`类型为六个字节，其中一个将未使用（我认为这样的设备更有可能使用 32 位`int`类型，并且可能会提供 40 位`short long`或其他内容以应对 an`int`还不够的情况，但是40 位`int`将是“合法的”）。

一般来说，标准要求任何类型都不能要求大于其大小的对齐，并且任何类型的数组，至少在一个结构中，具有与底层类型相同的对齐要求（某些实现可能有特殊的对齐要求静态分配的数组，例如要求任何小于页面大小的数组必须放置在不跨越页面边界的位置，除非标有#pragma 或其他指示的其他指令，但标准对此类要求视而不见因为它们唯一可能的效果是减少程序可以声明的变量数量而不会耗尽内存）。

# ms-word - 如何使用 Java 从模板或现有文档创建 Word 文档？

> ID：14715552
> 
> 赞同：2
> 
> 时间：2013-02-05T19:40:50.790
> 
> 标签：ms-word, apache-poi, java-ee-6, .doc

我有一个文档模板，其中一些字段是静态的，而其他字段是动态的。我需要替换一些数据（姓名、姓氏、薪水）并生成新文件。您建议使用哪个库来执行此操作？POI合适吗？我正在使用 Spring、Java EE6 和 Oracle。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T02:43:08.373

您可以尝试使用 Apache POI，但是操作 word 文件所需的 POI 的 HWPF 和 XWPF 部分使用起来非常复杂 - 您至少需要很好地了解 word 文件的结构！

**使用 iText 和 PDF 的解决方案**

我对 PDF 做了类似的事情（这可能是你的一个选择）

1) 您可以使用 LibreOffice 在文档中创建字段（如在 Acrobat Pro 中）

*   创建一个 .odt 文件并为其设置样式
*   或使用 MS Word 或 LibreOffice Writer 将您的模板转换为它
*   然后转到查看->工具栏->表单设计并设置“设计模式开/关”
*   现在您可以将字段添加到文件中（双击它将打开字段的属性）
*   完成后：“文件 -> 导出为 PDF”

2) 现在您可以使用 iText 来填写创建的字段

以下只是示例代码：

```
 public byte[] getDocumentAsByteArray(Object dataBean, String pdfTemplateName) throws KkmsException {

    ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
    PdfStamper stamp = null;
    InputStream templateInputStream = null;

    Locale local = new Locale(language);

    try {
        templateInputStream = // get the file input stream of the pdf
        PdfReader reader = new PdfReader(templateInputStream);

        // Create a stamper that will copy the document to a new file
        stamp = new PdfStamper(reader, outputStream);

        AcroFields form = stamp.getAcroFields();

        // form fields are normal text in the end
        stamp.setFormFlattening(true);
        Map<String, AcroFields.Item> map = (Map<String, AcroFields.Item>)form.getFields();
        if (map != null) {
            if (map.size() == 0) {
                logger.debug("There are no fields in this PDF layout");
            }
            for (Entry<String, AcroFields.Item> e : map.entrySet()) {
                logger.debug("PDF fieldname = " + e.getKey());

                // at the moment we only handle text fields
                if (AcroFields.FIELD_TYPE_TEXT == form.getFieldType(e.getKey())) {
                    fillForm(dataBean, form, e.getKey(), local);
                } else {
                    logger.warn("Field type is not supported: "+form.getFieldType(e.getKey()));
                }
            }
        }

        stamp.close();
    } catch (Exception e) {
        logger.warn("Failed to create PDF document", e);
        throw new KkmsException("Failed to create PDF document: "+e.getMessage());
    } finally {
        if (templateInputStream != null) {
            try {
                templateInputStream.close();
            } catch (IOException e) {
                throw new KkmsException("Failed to close InputStream of PDF document", e);
            }
        }
    }
    return outputStream.toByteArray();
} 
```

最后你会得到一个 PDF -> 希望这至少对你有一点帮助！

**另一个快速而肮脏的解决方案**

可能是使用 odt 或 docx 的强大功能 -> 将您的 doc 转换为 docx 或 odt -> 它只是一个 zip 文件 -> 所以解压缩它 -> 你会在 zip 的根目录中看到一个 content.xml 文件 -> 那里是那里的所有文档内容现在您可以在此处添加一些魔术标签（例如 $$$），以后可以由您的程序替换

```
<text:p text:style-name="P3">SAP Customer Number:</text:p>

<text:p text:style-name="P3">SAP Customer Number: $$$sapCustomerNumber$$$</text:p> 
```

现在创建一个解压缩 odt/docx 文件的程序 -> 替换标签 -> 再次压缩文件

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-11-20T00:29:19.043

[这些幻灯片](http://www.slideshare.net/plutext/document-generation-2012osdcsydney)来自我在 OSDC 2012 上的演示文稿，概述了一些主要方法。

这些天来，我可能会添加“生成您想要的 XHTML，然后将其导出到 docx”。自从我们引入了支持将 CSS @class 值转换为 Word 样式的 docx4j-ImportXHTML 以来，我们已经越来越多地看到这种方法。

# php - 转义标题中的特殊字符

> ID：14715558
> 
> 赞同：1
> 
> 时间：2013-02-05T19:41:03.073
> 
> 标签：php

在网页中，用户可以将字符串输入到输入元素中。提交表单后，所有输入都会根据规则进行验证。验证后，输入页面再次显示给用户，带有标记的错误和已经填写的输入元素。

验证页面中用于发回数据的部分代码：

```
$query_string = '?filename='.$timed_file_name . '&name=' . $name . '&text='.$text; 
header('Location: http://' . $server_dir . $next_page . $query_string); 
```

很明显，不能在标头中使用 & 符号，因为如果我键入 jack&jones，它会弄乱标头，而 php 将只返回 jack。

我可以用一种丑陋的方式做到这一点：

验证页面：

```
$name = html_entity_decode($name); 
$name = str_replace("&","aammppeerrssaanndd",$name); 
```

输入页面：

```
$name = $_GET['name'];
if (strpos($name,'aappoossttrroopphh') !== false) {
    $name = html_entity_decode($name); 
    $name = str_replace("aappoossttrroopphh","&",$name);
} 
```

有一个简单的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:43:54.110

您可以使用[urlencode](http://php.net/manual/en/function.urlencode.php)和[urldecode](http://www.php.net/manual/en/function.urldecode.php)。

在你的情况下，它会像这样使用：

```
$query_string = '?filename='. urlencode($timed_file_name) . '&name=' . urlencode($name) . '&text='. urlencode($text); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:44:49.517

创建 URL 时，通过以下方式运行变量：

```
$var = urlencode( $var ); 
```

当向用户展示结果时，换一种方式：

```
$var = urldecode( $var ); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:50:22.483

我认为您可能想使用[http-build-query](http://php.net/manual/en/function.http-build-query.php)这会从数组中为您生成查询字符串。

[文档](http://php.net/manual/en/function.http-build-query.php)说：

> 从提供的关联（或索引）数组生成 URL 编码的查询字符串。

例子

```
$a = array("be"=>"a","wonderful"=>"happier & great","but"=>"strange like @%");
echo http_build_query($a);
//gives "be=a&wonderful= happier +%26+great&but=strange+like+%40%25" 
```

因此，在您的情况下，您将使用：

```
$args = array('filename'=>$timed_file_name, 'name'=>$name, 'text'=>$text);
$query_string = "?".http_build_query($args); 
```

# android - 如何判断一个 android 活动是否从外部 adb 命令完成？

> ID：14715560
> 
> 赞同：4
> 
> 时间：2013-02-05T19:41:04.647
> 
> 标签：android, shell, android-activity, adb

在我们的测试中，我想使用一个脚本来运行一些 android 活动。我可以使用 adb shell start activity 命令来启动这些活动。有没有办法使用 adb 命令来判断活动何时结束？在发出下一个 adb start activity 命令之前，脚本需要知道第一个活动何时完成。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-12T11:03:25.557

我最近做了一些事情，我想要一个 bash 脚本来运行 adb 命令并显示/等待它完成。这对我有用：

```
./adb shell am start -W -n com.android.settings/.ApplicationSettings 
```

然后脚本等待应用程序菜单加载，然后再继续。不确定这将如何在更长的过程中发挥作用，但值得一试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T21:19:06.473

如果您可以控制您正在监控的应用程序的来源，请按照 Daniel 在问题评论中的建议进行操作。但如果你不能 - 尝试执行`dumpsys activity activities`，看看你是否能找到你正在寻找的信息。查看该`Running activities`部分，看看您的活动是否在完成后从列表中消失。

# perl - 如何根据一组行的列的最低值对文本文件的内容进行排序

> ID：14715562
> 
> 赞同：2
> 
> 时间：2013-02-05T19:41:20.990
> 
> 标签：perl, bash, unix, text, text-files

我有文本文件，其中包含以下格式的制表符分隔列：

```
fileName    Type    sc1 sc2 sc3 sc4 sc5 sc6
file1   abc 0   0.2 0   0   0   0
file1   xyz 0   0.8 0   0   0.8 0.2
file2   abc 0.5 0   0   0.1 0   0
file2   xyz 0   0   0   0.7 0.003   0.1
file3   abc 0.002   0   0   0   0.04    0
file3   xyz 0.5 0   0   0   0   0.3
.
. 
```

第一行是标题行。sc1、sc2、sc3 等分别为 1、2、3 分（它们不全为零）

有两种以上的类型，每个文件具有相同数量的类型。

**如何知道 xyz 类型的 sc6 最低的文件名？** 或者如何从此文件创建另一个文本文件，该文件将具有所有 xyz 类型的文件名和 sc6？

我真的不想将它作为数据库加载或做类似的事情。我想知道我是否可以使用 Unix 的`cut`,`sort`或`grep`命令相当快地完成这项工作。任何 perl、awk 解决方案也可以接受。

如果问题不是很清楚，请告诉我。

PS请随时为这个问题提出不同的标题。这是我能想到的最好的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:58:52.197

你可以像这样做一个单行：

```
perl -lanwe 'next unless $F[1] eq "xyz"; 
             $a{$F[0]}{$F[1]} = $F[7]; 
             }{ 
             for my $file (sort { $a{$b}{xyz} <=> $a{$a}{xyz} } keys %a) { 
                 print qq($file : $a{$file}{xyz}); }' 
```

Autosplit`-a`将在空白处拆分为数组`@F`，同时从标准输入或参数文件名（`-n`开关）中读取。输入（`}{`“操作员”）结束后，存储的结果被排序和打印。将跳过除“xyz”之外的所有类型。

输入输出：

```
file1   abc 0   0   0   0   0   0
file1   xyz 0   0   0   0   0   0
file2   abc 0   0   0   0   0   0
file2   xyz 0   0   0   0   0   0
file3   abc 0   0   0   0   0   0
file4   xyz 0   0   0   0   0   1 
```

* * *

```
file4 : 1
file2 : 0
file1 : 0 
```

注意：我必须在输入中添加一行以查看它是否实际排序。对于需要排序的东西来说，多么可怕的样本数据啊！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:58:50.970

```
awk -v lowest=9999999 '$2 == "xyz" && $8 < lowest { lowest = $8; lowfile = $1 }
                       END {print lowfile, "\t", lowest}' infile 
```

或者：

```
awk '$2 == "xyz"' infile | sort -k 8n | head -1 | cut -f1,8 
```

要为所有 xyz 创建一个只有文件名和 sc6 的文件：

```
awk '$2 = "xyz" {print $1, "\t", $8}' infile > outfile 
```

# emacs - 删除和重命名单个列直到emacs中的某一行

> ID：14715573
> 
> 赞同：1
> 
> 时间：2013-02-05T19:41:57.993
> 
> 标签：emacs

我有一个大的 emacs 文件。在该文件中有一个简单地列出“B”的列。我想将该列更改为列出“A”。这是否可以在 emacs 中完成而无需手动单击和重命名？我不知道如何为它编写脚本，所以我不确定。我不是最好的程序员。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T19:49:35.990

矩形命令可能在这里工作。在要更改的列的第一行设置标记。然后导航到最后一行，超过一列。键入`C-x r t`( `string-rectangle`) 并在小缓冲区中的提示符处输入“A”。这将用点定义的角替换矩形中的文本，并用您在迷你缓冲区中键入的文本进行标记。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T04:15:55.823

您可以使用`C-x r t` `inline-string-rectangle`magnars 的 mark-multiple 包中的函数。

它的工作方式类似于原始字符串矩形函数，但方式更直观。

检查这些页面。

[Emacs 摇滚！YouTube介绍]

[http://emacsrocks.com/e08.html](http://emacsrocks.com/e08.html)

[GitHub项目]

[https://github.com/magnars/mark-multiple.el](https://github.com/magnars/mark-multiple.el)

# java - 仅在未渲染另一个组件时如何渲染组件？

> ID：14715574
> 
> 赞同：6
> 
> 时间：2013-02-05T19:41:58.710
> 
> 标签：java, jsp, jsf, richfaces

我有一个用户可以通过 Android、iPhone、BlackBerry 或未知浏览器访问的页面。我有 4`rich:panel`个，每个平台一个，后者是一个通用的。

编码：

```
<rich:panel id="dlAndroid" rendered="#{fn:containsIgnoreCase(request.getHeader('User-Agent'), 'Android')}">
    ...
</rich:panel>

<rich:panel id="dlIphone" rendered="#{fn:containsIgnoreCase(request.getHeader('User-Agent'), 'iPhone')}">
    ...
</rich:panel>

<rich:panel id="dlBlackberry" rendered="#{fn:containsIgnoreCase(request.getHeader('User-Agent'), 'BlackBerry')}">
    ...
</rich:panel>

<rich:panel id="dlGeneric" rendered="#{ ---> WHAT TO WRITE HERE? <--- }"> 
```

`rich:panel`只有在没有其他人被渲染的情况下，我如何才能渲染最后一个？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T01:02:46.360

就这一点而言，您在标题中提出的问题可以具体回答为：

```
<rich:panel binding="#{panel1}" ...>
    ...
</rich:panel>
<rich:panel binding="#{panel2}" ...>
    ...
</rich:panel>
<rich:panel binding="#{panel3}" ...>
    ...
</rich:panel>
<rich:panel ... rendered="#{not panel1.rendered and not panel2.rendered and not panel3.rendered}">
    ...
</rich:panel> 
```

但是，在这种特殊情况下，将那些冗长的表达式别名为`<c:set>`：

```
<c:set var="android" value="#{fn:containsIgnoreCase(header['User-Agent'], 'Android')}" scope="request" />
<c:set var="iPhone" value="#{fn:containsIgnoreCase(header['User-Agent'], 'iPhone')}" scope="request" />
<c:set var="blackBerry" value="#{fn:containsIgnoreCase(header['User-Agent'], 'BlackBerry')}" scope="request" />

<rich:panel ... rendered="#{android}">
    ...
</rich:panel>
<rich:panel ... rendered="#{iPhone}">
    ...
</rich:panel>
<rich:panel ... rendered="#{blackBerry}">
    ...
</rich:panel>
<rich:panel ... rendered="#{not android and not iPhone and not blackBerry}">
    ...
</rich:panel> 
```

请注意，有一种更短的方法可以通过隐式`#{header}`映射获取请求标头。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:58:20.987

您可以在托管 bean 方法上编写此验证，因此它将验证用户代理是否适合第 4 个选项。例子：

```
public boolean userAgentUnknownBrowser() {
// Verify if contains the user-agent String
} 
```

在您的页面上，您只需使用以下方法：

```
<rich:panel id="dlGeneric" rendered="#{myBean.userAgentUnknownBrowser()}"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T20:43:11.997

您可以使用

```
<c:choose>
<c:when test="#{fn:containsIgnoreCase(request.getHeader('User-Agent'), 'Android')}">
<rich:panel id="dlAndroid">
...
</rich:panel>
</c:when>
<c:when test="#{fn:containsIgnoreCase(request.getHeader('User-Agent'), 'iPhone')}">
<rich:panel id="dlIphone">
...
</rich:panel>
</c:when>
<c:otherwise>
<rich:panel id="dlGeneric">
    ...
</rich:panel>
</c:otherwise>
<c:choose> 
```

我认为您正在使用一种逻辑来确定在同一页面上的 POSTS 之间不会更改的浏览器类型，因此在这里使用 JSTL 标记对我来说似乎是安全的。JSTL 标记只会在页面的 CREATE VIEW 期间执行一次。

但是，如果您正在测试某个模型变量的条件，那么最好将每个面板包装在 ui:fragment 中，例如

```
<ui:fragment rendered="#{fn:containsIgnoreCase(request.getHeader('User-Agent'), 'Android')}">
    <rich:panel id="dlAndroid">
    ...
    </rich:panel>
<ui:fragment> 
```

# php - 试图创建一个包含信息的文本文件。

> ID：14715576
> 
> 赞同：0
> 
> 时间：2013-02-05T19:42:06.957
> 
> 标签：php, fopen, fwrite

我正在尝试在文本文档中进行一些统计。

我需要为每个项目创建一个新的唯一文本文档，因此我暂时没有制作任何文本文档。

但是我得到了这个函数，我用该项目的唯一 ID 调用它。

```
function statestics($id) {
    $filename = 'cache/statestics/opskrift-'.$id.'.txt';

    if(!file_exists($filename)) {
       $fp = fopen($filename,"w");
       fwrite($fp,"0");
       fclose($fp);
    }

    $date = date('d-m-Y');
    $date_exist = 0;
    $todays_num = 0;
    $check1 = explode(',',file_get_contents($filename));
    $content = file_get_contents($filename);
    foreach ($check1 AS $c) {
        $check2 = explode(':',$c);
        if ($check2[0] == $date) {
            $date_exist = 1;
            $todays_num = $check[1];
        }
    }
    if ($date_exist) {
        $insert = $date . ':' . $todays_num . ',';
        $content = str_replace($insert, "", $content);
    }
    $todays_num + 1;
    $content = $content . $insert;
    file_put_contents($filename, $content);
} 
```

但是当我运行它时，它实际上并没有创建单个文本文档。有任何想法吗？没有错误报告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:50:16.400

要在文件末尾连接字符串值，应该这样做：

```
$fp = fopen($filename,"a+"); 
```

如果文件存在，他只是转到文件的末尾，否则他创建它。

要使用 file_get_content 和 file_put_content，请查看： [here](http://php.net/manual/en/function.file-get-contents.php) [和 here](http://php.net/manual/en/function.file-put-contents.php)

总帐

# c++ - cudaMalloc 在模板函数中调用时不修改返回指针

> ID：14715584
> 
> 赞同：0
> 
> 时间：2013-02-05T19:42:38.867
> 
> 标签：c++, templates, cuda, nvcc

以下示例问题：

```
#include <iostream>

using namespace std;
__device__ __constant__ float* data;

template<class T> void allocOnly(T* deviceDest, size_t numElem)
{
    cudaError_t errCode = cudaMalloc((void**)&deviceDest, numElem*sizeof(T));
    if(errCode != cudaSuccess) 
        cout << "Got error with code " << errCode << endl;
}

int main()
{
    float* test(0);
    allocOnly<float>(test,10);
    cout << "test = " << test << endl;

    float* test2(0);    
    cudaError_t errCode = cudaMalloc((void**)&test2, 10*sizeof(float));
    if(errCode != cudaSuccess) 
        cout << "Got error with code " << errCode << endl;
    cout << "test2 = " << test2 << endl;

    return 0;
} 
```

编译`nvcc test.cu -o testBin`

返回

```
test = 0
test2 = 0x310100 
```

为什么通过模板函数调用test时没有修改，cudaMalloc应该修改为指向新分配的设备内存的指针！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:46:05.097

指针没有被修改，因为`cudaMalloc`在函数中将`allocOnly`内存分配给`deviceTest`函数本地的参数`allocOnly`。您可以修改函数`allocOnly`以分配内存，如下所示：

```
template<class T> void allocOnly(T** deviceDest, size_t numElem)
{
    cudaError_t errCode = cudaMalloc((void**)deviceDest, numElem*sizeof(T));
    if(errCode != cudaSuccess) 
        cout << "Got error with code " << errCode << endl;
} 
```

主函数内部：

```
int main()
{
    float* test(0);
    allocOnly<float>(&test,10);
    cout << "test = " << test << endl;
    .
    .
    .

} 
```

# wordpress - WordPress中的自定义分页

> ID：14715587
> 
> 赞同：0
> 
> 时间：2013-02-05T19:42:55.537
> 
> 标签：wordpress, pagination

我尝试像这样进行自定义分页`1,2,3....10`，是否可以像这样进行分页`<?php wp_link_pages( $args ); ?>`？我不知道如何制作这些点，以免它们成为链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-01T17:16:59.237

如果可以为此创建一个函数并用作参考，您可以在此处查看。

[http://zeo.my/native-pagination-plugins-wordpress/](http://zeo.my/native-pagination-plugins-wordpress/)

甚至一些插件也可用，您可以使用它。我正在努力解决你的问题希望

这有帮助

谢谢阿南德

# delphi - 更改单个 DBInspector 行的颜色

> ID：14715588
> 
> 赞同：3
> 
> 时间：2013-02-05T19:43:00.560
> 
> 标签：delphi, delphi-7

我有一个 dxDBInspector，我需要用绿色突出显示九行中的一行 ( `edtSDate`)。颜色属性更改检查器中所有行的颜色。

我试过：

```
edtSDate.Inspector.Canvas.Brush.Color := clGreen; 
```

我还看到了[如何在 Delphi dxDBGrid 中更改单行的颜色？](https://stackoverflow.com/questions/925897/how-in-a-delphi-dxdbgrid-can-i-change-the-color-of-a-single-row)

但是 dxDBInspector 没有 OnCustomDraw / OnGetContentStyle 事件。

确切的组件是 Dev Express 的 dxDBInspector，我使用的是 Delphi 7。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T20:38:32.463

更改`OnDrawValue`事件中的变量为我解决了这个问题。我很难弄清楚这一点，因为现有代码（遗留项目）会自动分配此事件以使所有检查员匹配，但是一旦我绕过它就很简单。

我所做的只是分配给该行的事件创建`clGreen`的变量。`AColor``onDrawValue`

# ruby-on-rails - 将文本附加到 Rails 中 Formstastic 中的内部 html

> ID：14715590
> 
> 赞同：0
> 
> 时间：2013-02-05T19:43:03.253
> 
> 标签：ruby-on-rails, forms, select, option

我有两个表：组和系列。一个意甲`has_many`组和一个意甲组`belongs_to`。我正在使用 Formstastic 自动生成`<select>`包含所有系列的系列，以便用户能够选择与正在创建的组相关的系列。而是一个系列`belongs_to`的表台，哪个`has_many`系列。由于系列具有相同的名称，因此用户不可能确切地知道他在 中选择了哪个系列`<select>`，除非他知道特定系列属于哪个单元。为此，我希望每个`<option>`人都具有以下格式：

`<option value="serie_id">serie.name – unit.name</option>`

到目前为止（和工作）我所拥有的是：

```
ActiveAdmin.register Group do

  form do |f|
    f.inputs "Group" do       
        f.input :serie
        f.input :name
    end                               
  f.actions                         
  end 
end 
```

任何其他关于如何实现我的目标的建议（准确指定与该单元相关的系列）将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:49:38.160

也许您可以向您的 Serie 模型添加一个方法：

```
def fomatted_name
  name + unit.name # if you have an association belongs_to :unit
end 
```

在您看来：

```
ActiveAdmin.register Group do

  form do |f|
    f.inputs "Group" do       
      f.input :serie, :label_method => :formatted_name, :as => :select
      f.input :name
    end                               
    f.actions                         
  end 
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:34:54.603

尝试以下操作：

```
# in controller
@custom_collection = Serie.all.map{ |s| ["#{s.name} - #{s.unit.name}", s.id]}

# in view
f.input :serie, collection: options_for_select(@custom_collection) 
```

此代码假定 Serie 始终具有关联的 Unit。如果没有，它将引发错误。如果您只想在单位名称存在时显示单位名称，请使用以下命令：

```
@custom_collection = Serie.all.map do |serie|
  composed_name = s.name
  composed_name += " - #{s.unit.name}" if s.unit.present?
  [composed_name, s.id]
end 
```

# c# - 主线程睡眠将等待 C# 中的事件

> ID：14715591
> 
> 赞同：-1
> 
> 时间：2013-02-05T19:43:04.637
> 
> 标签：c#, multithreading, events, serial-port

我有一个带有 dataRevised 事件的串行端口对象，我需要让我的主线程睡眠将等待事件触发 dataRevised 事件，我使用信号量但是当等待事件的主线程不会触发时，我需要解决方案尽可能快，我在 .NET 2.0 中使用 C#。换句话说，我需要代码：

```
lock(_lock){
     _serialPort.write(cmd);
     ans=_serialPort.read();
 } 
```

要在没有中断的情况下从头到尾运行，问题是我需要等待传入的数据，所以会有一些东西要读取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:50:54.227

> 我需要让我的主线程睡眠将等待事件触发 dataRevised 事件
> 
> 但是当等待事件的主线程不会触发时

显然你*不能*让你的主线程休眠，因为如果你这样做，事件就不会触发。您需要重新设计您的应用程序，以便您的主线程在事件引发之前不需要休眠。

# c# - 如何引用字典中的数据C#

> ID：14715593
> 
> 赞同：-1
> 
> 时间：2013-02-05T19:43:28.660
> 
> 标签：c#, list, dictionary

我目前有一个字典，它在程序开始时加载了数据，它类似于：

```
 Dictionary<string, List<KeyValuePair<string,string>>> variants =
    new Dictionary<string, List<KeyValuePair<string, string>>>(); 
```

如果我想访问特定字符串的 Keyvaluepair 列表，我将如何引用它...

这是对它的理解：每个列表都有一个标识符（即字符串）->字符串导致Keyvaluepairs列表，我想随机选择它们

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:54:32.340

让我们分解一下：

```
// This is your dictionary.
Dictionary<string, List<KeyValuePair<string,string>>> variants = new Dictionary<string, List<KeyValuePair<string, string>>>();

// Let's get the list of variants for a given key.
string key = "myKey";
List<KeyValuePair<string,string>> variantsForKey = variants[key];

// If we wanted to get the first variant, we'd use one of these:
KeyValuePair<string,string> firstVariant = variantsForKey[0];
firstVariant = variantsForKey.First(); // Using Linq for fun and profit!

// Now, we want a random variant? No problem!
Random rand = new Random(); // Remember to initialize this only once!
int listLength = variantsForKey.Count;
int randomVariantIndex = rand.Next(0, listLength );
KeyValuePair<string,string> randomVariant = variantsForKey[randomVariantIndex]; 
```

瞧！

现在，您可能想要做的是将最后 3 行包装在扩展方法中：

```
public static class VariantExtensions
{
    private static Random rand = new Random();
    public static KeyValuePair<string,string> GetRandomVariant(this List<KeyValuePair<string,string>> variantsForKey)
    {
         int listLength = variantsForKey.Count;
         int randomVariantIndex = rand.Next(0, listLength );
         return variantsForKey[randomVariantIndex];
    }
} 
```

现在你可以使用这个：

```
Dictionary<string, List<KeyValuePair<string,string>>> variants = ...;
string key = "myKey";
KeyValuePair<string,string> randomVariant = variants[key].GetRandomVariant(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:45:49.290

您使用`[]`运算符。

将值放入哈希表中，

像这样：`variants[key] = valueHere;`

并从哈希表中获取值，

`var valueHere = variants[key];`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:51:38.707

很难理解你到底在追求什么。这有帮助吗？

```
using System;
using System.Collections.Generic;

namespace SO14715593
{
    class Program
    {
        static void Main(string[] args)
        {
            Dictionary<string, List<KeyValuePair<string, string>>> variants = new Dictionary<string, List<KeyValuePair<string, string>>>();
            variants["test"] = new List<KeyValuePair<string, string>>
                {
                    new KeyValuePair<string, string>("key1", "item1"),
                    new KeyValuePair<string, string>("key2", "item2"),
                    new KeyValuePair<string, string>("key3", "item3")
                };

            Random random = new Random();
            int index = random.Next(variants["test"].Count);
            Console.WriteLine("{0};{1}", variants["test"][index].Key, variants["test"][index].Value);
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T19:48:53.503

你可以使用类似的东西：

`var list = variants[stringToGetCorrespondingList]`

# performance - 计算移动平均线最有效的数据结构是什么？

> ID：14715594
> 
> 赞同：2
> 
> 时间：2013-02-05T19:43:31.910
> 
> 标签：performance, perl, data-structures, quantitative-finance

在做股市工作时，需要计算包括28天平均线、14天平均线等在内的计算指标。

此外，每天平均需要更新以包括最近一天的收盘价/最高价/最低价/成交量。

现在通常需要循环遍历数组以找到总和、平均值、最大值和最小值。

我认为队列（以动态数组或链表或您能想到的任何其他形式）似乎是基于 FIFO 进入/退出方法的完美数据结构。

问题：

1.  队列的效率和可扩展性与哈希相比如何？
2.  运行 Perl 脚本时，队列将不在内存中，因此必须初始化和处理（从 CSV 文件初始化的值），我知道这非常不相关，但哪种数据结构最适合使用每天执行的 Perl 脚本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T21:23:32.880

使用[PDL](http://pdl.perl.org)，您可以取一个更大的“数组”（一维矩阵）的切片，然后对该切片进行统计，然后再取另一个切片并重复。PDL 有许多内置的统计功能，如果这还不够，还有附加的[PDL::Stats](http://pdl-stats.sourceforge.net/)！

PDL 就像 Perl 的 MatLab 或 NumPy（我们认为更好！）。它针对数字数组的“循环”进行了高度优化。我将“循环”放在引号中，因为这些循环是在 C 级别实现的（听起来很快吧？）。看一眼！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T20:34:06.240

这里没有足够的信息。您是否正在处理一整天的报价以获得每日最高价/最低价/最后价？

你是在每个仪器的基础上做平均值吗？

对于任何移动平均线，您可以只使用构成平均值总和的值列表。随着新值的增加，一个值会下降，然后重新计算。

因此，如果您通过仪器进行操作并即时计算，则为列表哈希。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-06T06:54:44.900

如果你每天计算一次这些东西……使用最简单的数据结构来编码！计算真的需要这么多时间吗？如果是，请继续阅读。

总和和平均值可能更容易。如果您添加的是整数，则可以使用 FIFO 并将总和保存在变量中。每当您插入或删除一个元素时，相应地更新总和（加或减）。

如果添加浮点值，则上述方法可能会导致累积错误。如果值的大小非常不同和/或序列很长，则可能会发生这种情况。在这种情况下，您需要更复杂的东西（见下文）。

对于 max 和 min，最有效的数据结构是[max/min-heaps](http://en.wikipedia.org/wiki/Binary_heap)。请注意，您可以将它们嵌入到数组中。您需要将它们与 FIFO 队列的元素进行交叉引用，以便立即找到每次都必须删除的元素。

最通用的解决方案是增强自平衡树。Cormen、Leiserson、Rivest 和 Stein 在“算法简介”的第 14 章中解释了增强数据结构。基本上，树将在每个节点中包含数据序列的一个元素。每个节点还包含其子树的总和、最小值和最大值。每次更新节点时，都必须更新从该节点到根的所有路径中的总和、最大值和最小值。在根中，您有全局总和、最大值和最小值。

[您可以在此处](http://sourceforge.net/projects/avl-array/)找到增强自平衡树的 C++ 实现。

但是，由于您只需要固定数量的元素的总和、最小值和最大值，并且总是在一端插入并在另一端移除，因此可以使其更简单。您只需要一个**循环缓冲区**和一个嵌入数组的树（请参阅[如何将这种树嵌入到数组中](http://en.wikipedia.org/wiki/Binary_heap#Heap_implementation)）。该树将包含部分总和、最小值和最大值，就像之前描述的增强树一样。优点是您不需要重新平衡树，因为您从不在序列中间插入/删除，并且树始终具有相同的大小。

为了获得最近 28 天、最近 14 天、上周和最近 3 天的统计信息（例如），您将使用循环缓冲区和每个周期的数组嵌入树：一个用于最后 3 天，前 4 天（7 减去 3）天，前 7 天，以此类推。每天，您都会获取每个缓冲区的最后一个数据并将其插入下一个缓冲区。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T22:47:20.577

什么是最有效的真的取决于。

*   **哈希**是无序的。他们可以通过字符串键在几乎恒定的时间内查找值。查找在计算上是昂贵的，并且至少比数组查找慢一个数量级。哈希的执行情况取决于“桶”的数量和键的数量。但是，对于所有非平凡的情况，哈希查找将比遍历数组来查找元素更快。哈希比数组需要更多空间。
*   **Perl 中的数组**具有数组（随机访问）和双向链表（通过 push、pop、shift、unshift）的特性。它们易于使用，而且速度足够快。如果要添加/删除多个元素，请使用切片或`splice`函数。`splice`是`push`..的概括`unshift`，并且比循环更快。
*   **字符串**可用于存储整数数组。这是非常有效的，但也非常有限（仅限整数）。

    ```
    my $string = "";
    my $i = ~ 0; # a really big number
    $string .= chr $i; # get character from integer
    # Access elements via `substr`:
    my $j = ord substr $string, -1, 1; # last element; ord gets an int from a char 
    ```

    使用字符串具有数组（随机访问）和单链表（附加很简单`.=`）的特点。其他操作也相当快（`substr`有很多用途）。

务实的程序员将对大多数顺序数据**使用数组**。`List::Util`他还可以利用来自和的高效函数，`List::MoreUtils`这些函数提供了`sum`、和（为了速度而用 C 语言编写）之类的函数。`average``max``min`

当您构建值列表并且只需要固定数量时，请在添加新元素时执行此操作：

```
push @array, $new_value;
shift @array if @array > $max_length; # keep constant length 
```

这是节省空间的，但可能比简单地构建列表要慢，并且做

```
splice @array, 0, -$max_length; # remove all but $max_length last elems 
```

要仅访问数组的特定部分（不分配新变量），请使用切片：

```
use List::Util qw/sum/;
my $last_24_sum = sum @array[-24 .. $#$array];  sum the last 24 elems 
```

如果您想使用散列，但在编译时知道所有可能的字段，您可以为字段定义常量名称，并改用数组。所以不要做

```
my $hashref = { foo => $x, bar => $y }; # requires a lot of space
$hashref->{foo}; # slooow 
```

但做

```
use constant {
    EL_FOO => 0, # make sure the integer range is continouus
    EL_BAR => 1, #   Perl doesn't have native enums
};
my $arrayref = [$x, $y];
$arrayref->[EL_FOO]; # faster! 
```

反而。

在处理深度嵌套的数据时，缓存嵌套引用而不是在每次访问时重新计算它们有时会有所回报：

```
# disputable
for my $i (...) {
  for my $j (...)
    do_something_with $x->[$i][$j][$_] for 1 .. 1e3;
  }
}
# possibly better
for my $i (...) {
  for my $j (...) {
    my $aref = $x->[$i][$j];
    do_something_with $aref->[$_] for 1 .. 1e3;
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T20:23:50.077

我只会使用一个简单`%hash`的键，它是时间戳的一些字符串化或数字化表示，而值是您的数据与该时间序列项相关联的值。您可以对哈希的键进行排序，例如

```
#numeric
@srtdKeys = sort{$a<=>$b}(keys(%hash)); 
```

或者

```
#string
@srtdKeys = sort(keys(%hash)); 
```

并遍历最后的 28 或 14 等，然后从哈希中检索值。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-05T20:34:39.890

如果您每次运行都从头开始完全重建数据，也许您应该查看[Statistics::Descriptive](http://search.cpan.org/~shlomif/Statistics-Descriptive-3.0604/lib/Statistics/Descriptive.pm)。

很遗憾您将其作为 CSV 文件。通过访问数据库服务器，您可以通过几个 SQL 查询来获取此信息。

# javascript - 在 div 内捏合/缩放，但不是整个页面

> ID：14715595
> 
> 赞同：12
> 
> 时间：2013-02-05T19:43:36.820
> 
> 标签：javascript, jquery, ios, jquery-mobile

是否可以在页面上启用特定 div 的捏合/缩放？我不想捏/缩放整个页面，只是一个特定的元素。

我正在使用 jQuery、jQuery Mobile 并在 iPad 上查看项目。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T20:18:38.400

您可以使用[Zoomooz](http://jaukia.github.io/zoomooz/)。这是一个非常有趣的 jQuery 库：

# mysql - 查找可以在任何酒吧找到的最低价格啤酒的名称

> ID：14715597
> 
> 赞同：1
> 
> 时间：2013-02-05T19:43:43.083
> 
> 标签：mysql, sql

考虑 Bars and Beers 数据库中的以下关系：

sells (bar, beer, price)：表示每个酒吧销售的每种啤酒的价格（注意每个酒吧可以卖很多啤酒，很多酒吧可以卖同一种啤酒，价格可能不同）。

以下查询查找可在任何酒吧找到的最低价格啤酒的名称。

```
SELECT s.beer
FROM sells s
WHERE NOT EXISTS (SELECT si.beer
FROM sells si
WHERE si.price <= s.price) 
```

嗨，我正在慢慢学习 sql，我无法理解“si.price <= s.price”部分。由于嵌套选择基本上是比较相同的两个表，所以整个查询不会总是返回一个空表吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:48:30.127

该查询中有一个错误 - 它永远不会返回任何行，因为没有价格不等于自身。

要工作，它应该是：

```
...
WHERE si.price < s.price) 
```

假设进行了更改，其工作原理的解释是内部查询对表中的每一行执行一次并且取决于外部表（称为“共同相关子查询”）。因为在内部查询中使用了同一张表，所以您需要给外部表起别名（在本例中为“s”）。内部查询断言没有（其他）价格低于正在执行的行中的价格。

顺便说一句，内部查询的别名是不必要的 - 您可以删除“s1”，它仍然可以工作，因为内部查询是默认范围：

```
SELECT beer
FROM sells s
WHERE NOT EXISTS (
    SELECT *
    FROM sells  -- no alias needed
    WHERE price <= s.price) 
```

此外，这是一个“坏”查询，因为相关子查询会导致执行“n”个查询（每行一个）。你最好使用`min()`聚合函数：

```
SELECT beer
FROM sells
WHERE price = (SELECT min(price) FROM sells) 
```

除了这个查询更简单、更容易理解（两件好事）之外，它执行得更快，因为只执行了两个查询（一个子查询找到最低价格，一个子查询获取包含它的整行）。

最后，最后一个（尽管是次要的）错误是，如果有多个价格相同的低价啤酒，所有这些都将返回多行。要返回最低价格**的**啤酒，您需要将行数限制为 1 并决定如何打破平局（可能是在名称上）。事实上，只返回一行可以实现更简单的查询：

```
select beer
FROM sells
ORDER BY price
LIMIT 1 
```

如果您需要不断打破平局（即不以相同的最低价格返回*随机*的同价啤酒），也可以按名称订购：

```
select beer
FROM sells
ORDER BY price, beer
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:48:49.737

```
SELECT s.beer, s.price
FROM sells s
GROUP BY s.beer
HAVING s.price = MIN(s.price) 
```

[小提琴： http](http://sqlfiddle.com/#!2/f292c/1) ://sqlfiddle.com/#!2/f292c/1

请注意，这不是标准的。Mysql 允许不按选定的列进行分组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:48:52.673

嵌套查询正在比较相同的两个表。但是，它实际上更像是从表中取出一行，将其与表中的所有其他行进行比较，然后移动到下一行。这是一个*概念性*的解释。实际的实现可能完全不同。

但是，所写的查询不会返回任何内容，因为`<=`. 这应该是`<`。

但是，有一个更简单的方法来编写这个查询：

```
select *
from sells
order by price
limit 1 
```

祝你学习 SQL 好运。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T19:53:46.160

只需按升序排列价格，并将结果集限制为一项：

```
SELECT bar, beer, price FROM sells ORDER BY price ASC LIMIT 1 
```

# java - 分段方程程序

> ID：14715598
> 
> 赞同：-1
> 
> 时间：2013-02-05T19:43:43.870
> 
> 标签：java

我做了这个程序，它是一个分段方程程序，我只想知道我是否做错了什么或者我错过了什么。答案是正确的，但只是想确保我没有错过任何编码。

```
class RecursiveMethods
{
    RecursiveMethods()          //default constructor
    {
    }

    public int fOf(int x)
    {
        if (x <= 10)                        //the base case
        {
            System.out.println(x + " <= 10, therefore ... f(" + x + ") = -5");
            return -5;
        }
        else
        {
            System.out.println(x + " > 10, therefore ... f(" + x + ") = f(" + x + " - 3) + 2 = f(" + (x -3) + ") + 2");
            return fOf(x-3) + 2;
        }
    }    
}

public class RecursionMethodTester
{
    public static void main(String[] args)
    {
        int x;
        RecursiveMethods rMethods = new RecursiveMethods();

        System.out.println("---------------------------------");
        System.out.println("       f(x - 3) + 2    if x >  10");
        System.out.println("f(x) = ");
        System.out.println("       -5              if x <= 10");
        System.out.println("---------------------------------");
        System.out.println();

        x = 20;
        System.out.println("Example 1:  x = " + x);
        System.out.println("f(" + x + ") = " + rMethods.fOf(x));
        System.out.println();

        x = 19;
        System.out.println("Example 2:  x = " + x);
        System.out.println("f(" + x + ") = " + rMethods.fOf(x));
        System.out.println();

        x = 18;
        System.out.println("Example 3:  x = " + x);
        System.out.println("f(" + x + ") = " + rMethods.fOf(x));
        System.out.println();  
    }
} 
```

谢谢您的支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:51:27.380

看起来不错...为了获得额外的荣誉，这里有一些其他的建议：

*   RecursiveMethods 不需要实例化。fOf 方法可以标记为静态，而不是实例化和调用实例，您可以只调用“RecursiveMethods.fOf()”。
*   看看 PrintWriter 而不是使用 System.out.println。它具有可以将数据插入格式字符串的 format() 方法。
*   RecursiveMethods 看起来像是可重用的......在这种情况下，不要在两个类中都写入 System.out，这会使扩展和重用变得更加困难。

我会给你一个A-。

# .net - 使用命名空间创建 xml 文件

> ID：14715603
> 
> 赞同：1
> 
> 时间：2013-02-05T19:44:00.603
> 
> 标签：.net, xml, vb.net, xml-namespaces

我正在尝试创建一个 xml 文件：

```
 <?xml version="1.0"?>
<Order xmlns="urn:schemas-basda-org:2000:purchaseOrder:xdr:3.01"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="urn:schemas-basdaorg:2000:purchaseOrder:xdr:3.01order-v3.xsd"> 
```

我有以下代码：

```
 Dim xsi As XNamespace = "http://www.w3.org/2001/XMLSchema-instance"
    Dim schemaLocation As XNamespace = "urn:schemas-basdaorg:2000:purchaseOrder:xdr:3.01order-v3.xsd"
    Dim order As XNamespace = "urn:schemas-basda-org:2000:purchaseOrder:xdr:3.01"

    Dim root As New XElement("Root", New XAttribute("Order", order.NamespaceName), _
                             New XAttribute(XNamespace.Xmlns + "xsi", xsi.NamespaceName), _
                             New XAttribute(xsi.NamespaceName + "schemaLocation", schemaLocation.NamespaceName), _
                             New XElement("Child", _
                                          New XElement("DifferentChild", "other content")), _
                             New XElement("Child2", "c2 content"), _
                             New XElement("Child3", "c3 content")) 
```

但是，当我运行代码时，出现以下错误：

```
xmlexception was unhanded
The ':' character, hexadecimal value 0x3A, cannot be included in a name. 
```

编辑

好的，所以我让命名空间可以使用以下代码：

```
Dim xsi As XNamespace = "http://www.w3.org/2001/XMLSchema-instance"
        Dim schemaLocation As XNamespace = "urn:schemas-basdaorg:2000:purchaseOrder:xdr:3.01order-v3.xsd"
        Dim order As XNamespace = "urn:schemas-basda-org:2000:purchaseOrder:xdr:3.01"

        Dim root As New XElement(order + "Order", _
                                 New XAttribute(XNamespace.Xmlns + "xsi", xsi.NamespaceName),
                                 New XAttribute(XNamespace.Xmlns + "schemaLocation", schemaLocation),
                                 New XElement("OrderHead", _
                                              New XElement("Schema", New XElement("Version", "3.05")),
                                              New XElement("Parameters", New XElement("Language", "en-GB"), New XElement("DecimalSeparator", "."), New XElement("Precision", "20.3")), _
                                              New XElement("OrderType", "Purchase Order", New XAttribute("Code", "PUO"))), _ 
```

但现在在我的xml中我有：

```
<OrderHead xmlns="">
    <Schema>
      <Version>3.05</Version>
    </Schema>
    <Parameters> 
```

有没有办法摆脱 orderHead 标签中的空白 xmlns="" ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T00:24:29.013

你从中得到什么：

```
Dim order As XNamespace = "urn:schemas-basda-org:2000:purchaseOrder:xdr:3.01"

Dim root As New XElement(
    order + "Order", 
    New XElement(order + "Child", _
                 New XElement(order + "DifferentChild", "other content")), _
    New XElement(order + "Child2", "c2 content"), _
    New XElement(order + "Child3", "c3 content")) 
```

抱歉，我现在没有时间测试它。

# c# - 模态对话框中的 TPL 任务进度

> ID：14715604
> 
> 赞同：1
> 
> 时间：2013-02-05T19:44:02.773
> 
> 标签：c#, winforms, task-parallel-library

假设我有一个要运行的长时间运行的任务，它可以通知用户界面其状态/进度。这里的问题是我想要的 UI 是一个模态对话框，我不能在开始任务之前显示它，也不能开始任务然后显示它。

尝试1：先显示对话框，然后启动任务：

```
ProgressDialog dlg = new ProgressDialog();
Task longRunningTask = CreateTask();  
dlg.ShowDialog();
longRunningTask.Start();
Task.WaitAll(longRunningTask); 
```

这显然不起作用，线程在 ShowDialog() 处被阻塞，任务永远不会启动。

尝试 2：启动任务，然后显示对话框：

```
ProgressDialog dlg = new ProgressDialog();
Task longRunningTask = CreateTask();  
longRunningTask.Start();
dlg.ShowDialog();
Task.WaitAll(longRunningTask); 
```

但是在这种情况下，我可能会错过任务中的第一个进度事件，或者更糟糕的是，当“InvokeRequired”说假时，我会引发可怕的跨线程异常，因为第一个事件在创建时到达进度对话框，但已经尚未显示，因此它没有手柄。

我想我可以将任务传递给对话框并让对话框启动它，但感觉这个问题有一个不需要的优雅解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:54:58.510

该`Shown`事件非常适合解决此问题：

```
ProgressDialog dlg = new ProgressDialog();
dlg.Shown += (_, args) =>
{
    CreateTask().Start();
};
dlg.ShowDialog(); 
```

如果您需要在继续之前确保任务已完成，并且表单可能在完成之前关闭，您可以将其修改为等待任务，如下所示：

```
ProgressDialog dlg = new ProgressDialog();
Task longRunningTask = CreateTask();
dlg.Shown += (_, args) =>
{
    longRunningTask.Start();
};
dlg.ShowDialog();
longRunningTask.Wait(); 
```

请注意，在这两种情况下，对话框表单都是在创建任务之前创建的，因此您可以将`dlg`实例传递给`CreateTask`if 以允许它访问表单的实例。

# regex - Perl，从正则表达式匹配分配给变量

> ID：14715606
> 
> 赞同：5
> 
> 时间：2013-02-05T19:44:02.597
> 
> 标签：regex, perl, syntax, variable-assignment, parentheses

我对 perl 比较陌生，在[check_ilo2_health.pl](http://exchange.nagios.org/directory/Plugins/Hardware/Server-Hardware/HP-%28Compaq%29/check_ilo2_health/details)中有一个示例代码片段，其中有一段我不明白它是如何工作或为什么工作的语法。代码片段逐行解析 SSL 客户端数据，在本例中为 XML。

```
if ( $line =~ m/MESSAGE='/) {
   my ($msg) = ( $line =~ m/MESSAGE='(.*)'/);  #<---- HERE

   if ( $msg !~ m/No error/ ) {
      if ( $msg =~ m/Syntax error/ ) {  #...etc 
```

有问题的 XML 示例：

```
<RESPONSE
    STATUS="0x0000"
    MESSAGE='No error'
 /> 
```

因此，在这种情况下，*if*语句采用 XML 样本的*MESSAGE*行。我了解*我的 ($msg)*将变量视为一种列表，并且我了解正则表达式如何匹配；但是，我不明白的是$ *msg***分配**给*No error*的语法。perl 似乎正在玩弄括号语法等以使其正常工作。虽然它有效，但我想知道它是如何工作的。任何援助将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-05T20:17:43.963

请参阅[Perlretut，提取匹配](http://perldoc.perl.org/perlretut.html#Extracting-matches)：

> ... 在标量上下文中，`$time =~ /(\d\d):(\d\d):(\d\d)/`返回真或假值。但是，在列表上下文中，它返回匹配值的列表`($1,$2,$3)`

所以，在

```
($msg) = ( $line =~ m/MESSAGE='(.*)'/); 
```

`( $line =~ m/MESSAGE='(.*)'/)`返回捕获组的匹配列表。您有一个捕获组，因此其内容随后存储在 ($msg) 中。

# javascript - 如何确定日期字符串是否包含已在 Javascript 中添加的时间偏移量？

> ID：14715611
> 
> 赞同：1
> 
> 时间：2013-02-05T19:44:26.377
> 
> 标签：javascript, regex, date, utc, datetimeoffset

考虑这个日期字符串：

```
"2012-08-20T15:00:00-07:00" 
```

它添加了时间偏移量，`"-07:00"` 我怎样才能知道它添加了这个偏移量？我知道我可以用正则表达式来做到这一点。但是还有其他更简单的方法吗？

或者有没有人有它的正则表达式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:44:22.323

> 我知道我可以用正则表达式来做到这一点，但还有其他更简单的方法吗？

我不这么认为，正则表达式是可用的最简单的模式匹配器。

> 有没有人有它的正则表达式？

我认为应该这样做：

```
/[+-]\d\d:\d\d$/.test(datestring) 
```

如果要解析它，请使用

```
var match = /([+-]?\d\d):(\d\d)$/.exec(datestring);
if (match)
    return parseInt(match[1], 10)*60 + parseInt(match[2], 10)*(match[1].charAt(0)=="-"?-1:1);
return 0; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-05T20:15:29.887

如果您的日期字符串始终具有相同的格式，您可以简单地使用它`.length`来检查是否添加了一些内容：

```
var your_string = "2012-08-20T15:00:00";
if(your_string.length > 19) {
    // offset added
    // offset = your_string.substring(19);
} else {
    // no offset added
} 
```

无论如何，我建议使用`(new Date).getTime()`which 返回自 01.01.1970, 0:00:00h UTC 以来的毫秒数。这更容易计算...

# actionscript-3 - 滑动益智游戏-actionscript 3 有一些问题

> ID：14715614
> 
> 赞同：0
> 
> 时间：2013-02-05T19:44:40.603
> 
> 标签：actionscript-3, flash

我对actionscript3很陌生，我目前正在开发一款滑动益智游戏。游戏就像，你在一个矩阵中生成 8 个盒子，每个盒子都有一个数字，你滑动这些盒子以按照一定的顺序排列它们。好吧，我已经完成了大部分必需的功能，但是有一件事——如果你按下“下一步”按钮，这些框就不能再移动了。

我将在这里粘贴我的代码，包括主类和盒子类。

益智游戏.as:

```
package 
{
import flash.display.MovieClip;
import flash.display.Sprite;
import flash.display.Graphics;
import flash.geom.Matrix;
import flash.geom.Point;
import flash.events.Event;
import flash.events.MouseEvent;
import flash.text.TextField;
import flash.text.TextFormat;
import flash.text.TextFieldType;
import flash.utils.Timer;
import flash.events.TimerEvent;

public class PuzzleGame extends Sprite
{
    public var whiteBox:Box;
    public var boxes:Array=new Array();
    public static const GAP:uint = 5;

    public var timerText:TextField= new TextField();
    public var timer:Timer;

    public var stepCounter:TextField=new TextField();
    public var steps:Number = 0;

    public var endGame:TextField=new TextField();
    public var endGameFormat:TextFormat=new TextFormat();

    public function PuzzleGame()
    {
        var background:Background;
        background= new Background();
        addChild(background);

        var nextbutton:nextButton;
        nextbutton=new nextButton();
        nextbutton.x = 100;
        nextbutton.y = 350;
        addChild(nextbutton);

        buildMatrix();

        stepCounter.x = 220;
        stepCounter.y = 370;
        stepCounter.text = "Steps: " + steps;

        addChild(stepCounter);

        timerText.border = true;
        timerText.height = 20;
        timerText.x = 10;
        timerText.y = 10;
        timerText.width = 150;
        timerText.text = "start";
        addChild(timerText);

        nextbutton.addEventListener(MouseEvent.CLICK, nextMatrix);

        stage.addEventListener(Event.ENTER_FRAME, checkAllBoxes);

    }

    public function nextMatrix(event:MouseEvent)
    {
        timer.stop();
        boxes[0].removeEventListener(MouseEvent.CLICK, box0Clicked);

        boxes[1].removeEventListener(MouseEvent.CLICK, box1Clicked);

        boxes[2].removeEventListener(MouseEvent.CLICK, box2Clicked);

        boxes[3].removeEventListener(MouseEvent.CLICK, box3Clicked);

        boxes[4].removeEventListener(MouseEvent.CLICK, box4Clicked);

        boxes[5].removeEventListener(MouseEvent.CLICK, box5Clicked);

        boxes[6].removeEventListener(MouseEvent.CLICK, box6Clicked);

        boxes[7].removeEventListener(MouseEvent.CLICK, box7Clicked);

        buildMatrix();
        steps = 0;
        stepCounter.text = "Steps: " + steps;

    }

    public function buildMatrix()
    {
        whiteBox = new Box(0);
        addChild(whiteBox);
        whiteBox.x = 10 + Box.BOX_SIZE * 2 + GAP * 3;
        whiteBox.y = 60 + Box.BOX_SIZE * 2 + GAP * 3;

        var i:uint;
        var rnd:Array = randomUnique.between(1,8);
        var box:Box;
        for (i=1; i<=8; i++)
        {

            if (i>=1&&i<=3)
            {
                box = new Box(rnd[i]);
                box.x = 10 + (i - 1) * Box.BOX_SIZE + GAP * i;
                box.y = 60 + GAP;

                addChild(box);
                boxes.push(box);
            }

            if (i>=4&&i<=6)
            {
                box = new Box(rnd[i]);
                box.x = 10 + (i - 4) * Box.BOX_SIZE + GAP * (i - 3);
                box.y = 60 + Box.BOX_SIZE + GAP * 2;

                addChild(box);
                boxes.push(box);
            }
            if (i>=7&&i<=8)
            {
                box = new Box(rnd[i]);
                box.x = 10 + (i - 7) * Box.BOX_SIZE + GAP * (i - 6);
                box.y = 60 + Box.BOX_SIZE * 2 + GAP * 3;

                addChild(box);
                boxes.push(box);
            }
        }
        boxes[0].addEventListener(MouseEvent.CLICK, box0Clicked);

        boxes[1].addEventListener(MouseEvent.CLICK, box1Clicked);

        boxes[2].addEventListener(MouseEvent.CLICK, box2Clicked);

        boxes[3].addEventListener(MouseEvent.CLICK, box3Clicked);

        boxes[4].addEventListener(MouseEvent.CLICK, box4Clicked);

        boxes[5].addEventListener(MouseEvent.CLICK, box5Clicked);

        boxes[6].addEventListener(MouseEvent.CLICK, box6Clicked);

        boxes[7].addEventListener(MouseEvent.CLICK, box7Clicked);

        timer = new Timer(1000);
        timer.addEventListener(TimerEvent.TIMER,onTimerTic);
        timer.start();

    }

    public function addWhiteBox()
    {
        whiteBox = new Box(0);
        addChild(whiteBox);
        whiteBox.x = 10 + Box.BOX_SIZE * 2 + GAP * 3;
        whiteBox.y = 60 + Box.BOX_SIZE * 2 + GAP * 3;
    }

    public function switchPlaces(box:Box,box2:Box)
    {
        var point:Point = new Point(box.x,box.y);
        box.x = box2.x;
        box.y = box2.y;
        box2.x = point.x;
        box2.y = point.y;
    }

    public function box0Clicked(event:MouseEvent)
    {
        if (((boxes[0].x==whiteBox.x && (Math.abs(boxes[0].y-whiteBox.y)==Box.BOX_SIZE+GAP)) || (boxes[0].y==whiteBox.y && (Math.abs(boxes[0].x-whiteBox.x)==Box.BOX_SIZE+GAP))))
        {
            switchPlaces(boxes[0],whiteBox);
            steps++;
            stepCounter.text = "Steps: " + steps;
        }
    }

    public function box1Clicked(event:MouseEvent)
    {
        if (((boxes[1].x==whiteBox.x && (Math.abs(boxes[1].y-whiteBox.y)==Box.BOX_SIZE+GAP)) || (boxes[1].y==whiteBox.y && (Math.abs(boxes[1].x-whiteBox.x)==Box.BOX_SIZE+GAP))))
        {
            switchPlaces(boxes[1],whiteBox);
            steps++;
            stepCounter.text = "Steps: " + steps;
        }
    }

    public function box2Clicked(event:MouseEvent)
    {
        if (((boxes[2].x==whiteBox.x && (Math.abs(boxes[2].y-whiteBox.y)==Box.BOX_SIZE+GAP)) || (boxes[2].y==whiteBox.y && (Math.abs(boxes[2].x-whiteBox.x)==Box.BOX_SIZE+GAP))))
        {
            switchPlaces(boxes[2],whiteBox);
            steps++;
            stepCounter.text = "Steps: " + steps;
        }
    }

    public function box3Clicked(event:MouseEvent)
    {
        if (((boxes[3].x==whiteBox.x && (Math.abs(boxes[3].y-whiteBox.y)==Box.BOX_SIZE+GAP)) || (boxes[3].y==whiteBox.y && (Math.abs(boxes[3].x-whiteBox.x)==Box.BOX_SIZE+GAP))))
        {
            switchPlaces(boxes[3],whiteBox);
            steps++;
            stepCounter.text = "Steps: " + steps;
        }
    }

    public function box4Clicked(event:MouseEvent)
    {
        if (((boxes[4].x==whiteBox.x && (Math.abs(boxes[4].y-whiteBox.y)==Box.BOX_SIZE+GAP)) || (boxes[4].y==whiteBox.y && (Math.abs(boxes[4].x-whiteBox.x)==Box.BOX_SIZE+GAP))))
        {
            switchPlaces(boxes[4],whiteBox);
            steps++;
            stepCounter.text = "Steps: " + steps;
        }
    }

    public function box5Clicked(event:MouseEvent)
    {
        if (((boxes[5].x==whiteBox.x && (Math.abs(boxes[5].y-whiteBox.y)==Box.BOX_SIZE+GAP)) || (boxes[5].y==whiteBox.y && (Math.abs(boxes[5].x-whiteBox.x)==Box.BOX_SIZE+GAP))))
        {
            switchPlaces(boxes[5],whiteBox);
            steps++;
            stepCounter.text = "Steps: " + steps;
        }
    }

    public function box6Clicked(event:MouseEvent)
    {
        if (((boxes[6].x==whiteBox.x && (Math.abs(boxes[6].y-whiteBox.y)==Box.BOX_SIZE+GAP)) || (boxes[6].y==whiteBox.y && (Math.abs(boxes[6].x-whiteBox.x)==Box.BOX_SIZE+GAP))))
        {
            switchPlaces(boxes[6],whiteBox);
            steps++;
            stepCounter.text = "Steps: " + steps;
        }
    }

    public function box7Clicked(event:MouseEvent)
    {
        if (((boxes[7].x==whiteBox.x && (Math.abs(boxes[7].y-whiteBox.y)==Box.BOX_SIZE+GAP)) || (boxes[7].y==whiteBox.y && (Math.abs(boxes[7].x-whiteBox.x)==Box.BOX_SIZE+GAP))))
        {
            switchPlaces(boxes[7],whiteBox);
            steps++;
            stepCounter.text = "Steps: " + steps;
        }
    }

    public function checkAllBoxes(event:Event)
    {

        if ((boxes[0].isInOriginalPos())&&(boxes[1].isInOriginalPos())&&(boxes[2].isInOriginalPos())&&(boxes[3].isInOriginalPos())&&(boxes[4].isInOriginalPos())&&(boxes[5].isInOriginalPos())&&(boxes[6].isInOriginalPos())&&(boxes[7].isInOriginalPos()))
        {

            endGame.height = 100;
            endGame.width = 300;
            endGame.x = 100;
            endGame.y = 180;
            endGame.text = "You win!";

            endGameFormat.color = 0x000000;
            endGameFormat.font = "Arial";
            endGameFormat.size = 15;
            endGameFormat.bold = true;
            endGame.setTextFormat(endGameFormat);

            addChild(endGame);

            onGameEnd();
        }
    }

    public function onGameEnd()
    {
        timer.stop();
        timerText.text = "DONE >> " + numberToTime(timer.currentCount);
    }

    public function onTimerTic(event:TimerEvent):void
    {
        timerText.text = numberToTime(Number(Timer(event.target).currentCount));
    }

    public function numberToTime(n:uint):String
    {
        return String(n/100);
    }

}

} 
```

盒子.as:

```
package 
{
import flash.display.MovieClip;
import flash.display.Sprite;
import flash.geom.Matrix;
import flash.display.GradientType;
import flash.display.Graphics;
import flash.events.MouseEvent;
import flash.text.TextField;
import flash.text.TextFormat;
import flash.text.TextFieldType;
import flash.events.Event;
public class Box extends MovieClip
{
    private var originalXPosition:Number;
    private var originalYPosition:Number;
    private var _color:uint;
    private var _borderAlpha:Number;
    private var _borderWidth:Number;
    private var numText:TextField = new TextField  ;
    private var numFormat:TextFormat = new TextFormat  ;
    public static const GAP:uint = 5;
    public static const BOX_SIZE:uint = 80;

    public static const BOX_CLICKED:String = "clicked";

    public function Box(boxNum:int)
    {
        var boxColor:uint;
        var numColor:uint;
        if ((boxNum == 0))
        {
            boxColor = 0xCCCCCC;
            numColor = 0xCCCCCC;
            originalXPosition = 10 + 2 * BOX_SIZE + 3 * GAP;
            originalYPosition = 60 + 2 * BOX_SIZE + 3 * GAP;
        }
        if ((boxNum == 1))
        {
            boxColor = 0xFF9900;
            numColor = 0xFFFFFF;
            originalXPosition = 10 + GAP;
            originalYPosition = 60 + GAP;
        }
        if ((boxNum == 2))
        {
            boxColor = 0xFFFFFF;
            numColor = 0xFF9900;
            originalXPosition = 10 + BOX_SIZE + 2 * GAP;
            originalYPosition = 60 + GAP;
        }
        if ((boxNum == 3))
        {
            boxColor = 0xFF9900;
            numColor = 0xFFFFFF;
            originalXPosition = 10 + 2 * BOX_SIZE + 3 * GAP;
            originalYPosition = 60 + GAP;
        }
        if ((boxNum == 4))
        {
            boxColor = 0xFFFFFF;
            numColor = 0xFF9900;
            originalXPosition = 10 + GAP;
            originalYPosition = 60 + BOX_SIZE + 2 * GAP;
        }
        if ((boxNum == 5))
        {
            boxColor = 0xFF9900;
            numColor = 0xFFFFFF;
            originalXPosition = 10 + BOX_SIZE + 2 * GAP;
            originalYPosition = 60 + BOX_SIZE + 2 * GAP;
        }
        if ((boxNum == 6))
        {
            boxColor = 0xFFFFFF;
            numColor = 0xFF9900;
            originalXPosition = 10 + 2 * BOX_SIZE + 3 * GAP;
            originalYPosition = 60 + BOX_SIZE + 2 * GAP;
        }
        if ((boxNum == 7))
        {
            boxColor = 0xFF9900;
            numColor = 0xFFFFFF;
            originalXPosition = 10 + GAP;
            originalYPosition = 60 + 2 * BOX_SIZE + 3 * GAP;
        }
        if ((boxNum == 8))
        {
            boxColor = 0xFFFFFF;
            numColor = 0xFF9900;
            originalXPosition = 10 + BOX_SIZE + 2 * GAP;
            originalYPosition = 60 + 2 * BOX_SIZE + 3 * GAP;
        }

        this.graphics.lineStyle(0,boxColor);
        this.graphics.beginFill(boxColor,1);
        this.graphics.drawRect(0,0,BOX_SIZE,BOX_SIZE);
        this.graphics.endFill();
        numText.x = this.x;
        numText.y = this.y;
        numText.height = 40;
        numText.width = 30;
        numText.text = boxNum.toString();

        numFormat.color = numColor;
        numFormat.font = "Arial";
        numFormat.size = 30;
        numFormat.bold = true;
        numText.setTextFormat(numFormat);
        addChild(numText);

    }

    public function isInOriginalPos():Boolean
    {
        if (this.x == originalXPosition && this.y == originalYPosition)
        {
            return true;
        }
        return false;
    }

}

} 
```

问题是，一个新游戏应该通过单击“下一步”按钮来开始，但是当你这样做时，盒子就不能再移动了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:03:28.120

我不是 100% 清楚，但是在您的`nextMatrix()`方法中，您正在删除事件侦听器。但是你永远不会从舞台上移除盒子（或者它们被添加到的任何容器）。

然后在`buildMatrix()`您添加新框并向它们添加事件侦听器。

我认为正在发生的是原始框仍然存在，但没有附加事件侦听器。您的`nextMatrix()`函数中应该有一个循环，该循环使用该`removeChild()`方法删除原始框。

即使这不能解决您当前的问题，它也会从舞台上删除这些对象并释放它们正在消耗的内存。

我不明白的是，通常当你这样做`addChild()`时，应该将对象添加到可能已经存在的任何东西之上。因此，可能是其他原因导致了问题。但正如我所提到`removeChild()`的，如果不使用旧盒子，每次开始新游戏时它们都会持续存在并消耗更多内存。

**[编辑]**

应该发生的另一件事是您需要清除方法中的`boxes`数组`nextMatrix()`。否则，您`buildMatrix()`方法中的代码会将事件侦听器添加到原始框，而不是新框。

重置该数组的两种快速方法：

```
boxes.length = 0; 
```

或者

```
boxes = []; 
```

# javascript - Webservice、JS、CSS 不能在 HTTPS（安全页面）上工作

> ID：14715620
> 
> 赞同：2
> 
> 时间：2013-02-05T19:45:12.310
> 
> 标签：javascript, asp.net, css, http, https

在我的网站上，我只想应用 https 我的网站页面“securepage.aspx”之一

我的网站看起来像[http://www.test.com/](http://www.test.com/)

我的安全页面将是[https://www.test.com/securepage.aspx](https://www.test.com/securepage.aspx)

我的所有资源（如**JS/Images**）都在**assets**文件夹中，而我的**webservices**位于 commonwebservice 文件夹的根目录中。

[http://www.test.com/assets/js/](http://www.test.com/assets/js/)

[http://www.test.com/assets/images/](http://www.test.com/assets/images/)

当我在安全页面上应用 https 时，该页面确实使用了**chrome 浏览器**中的任何 CSS 和 JS 文件，即我的整个页面都搞砸了，即使我在那里使用了 CSS 和 JS 的绝对 URL。

**在这种情况下，我的网络服务在所有浏览器**上都会出现 500 错误。

任何人都可以建议并指导我处理这种情况的最佳方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:55:28.707

您看到的行为令人沮丧，但正确。当您使用 HTTPS 提供页面时，您还必须在 HTTPS 下提供所有链接内容。

检查我们的协议相关 URL ( [http://paulirish.com/2010/the-protocol-relative-url/](http://paulirish.com/2010/the-protocol-relative-url/) )

基本上，它们看起来像这样：

```
<img src="//domain.com/img/logo.png"> 
```

如果您的页面是 HTTP，则资源在 HTTP 下加载，如果是 HTTP，则资源在 HTTPS 下安全加载。

您必须设置服务器以在两者下提供 CSS/JS/WS 内容，但是一旦您这样做了，上面的相对链接将允许您在两者之间无缝切换。因此，对于母版页中的链接，请使用相对格式，然后无论内容页面是在 HTTP 还是 HTTPS 下运行，资源将从与页面相同的协议中提取。

# ios - 无法在“我的 Mac 64 位”上运行 sim

> ID：14715622
> 
> 赞同：1
> 
> 时间：2013-02-05T19:45:22.100
> 
> 标签：ios, objective-c, macos, ios-simulator, core-services

在 CoreServices.h 中`#include <OSServices/OSServices.h>`（特别是未找到）导致了一个问题，这使我无法运行 64 位模拟器。

找不到“词法或预处理器问题”OSServices/OSServices.h

似乎很多人都遇到了这个问题，我似乎无法找到解决方案。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:24:11.083

如果您的 Xcode 显示“我的 Mac 64 位”作为您当前的设备，那么这就是问题所在。首先查看您的 iOS 模拟器是否在下拉列表中可用。如果没有，那么您的项目文件已更改，可能已损坏. 关闭 Xcode 并重新打开，如果这不能解决问题，然后查看您的项目设置，并更改它以使项目适用于 iOS（这可能需要反复试验）。

修复后，如果您不断遇到 CoreServices 问题，请确保将 CoreServices 框架导入到您的项目中（检查项目设置）。

# java - Java项目错误

> ID：14715629
> 
> 赞同：1
> 
> 时间：2013-02-05T19:45:43.000
> 
> 标签：java, android

我从 Eclipse 得到这个错误：

```
The constructor File(List<String>) is undefined 
```

在这部分代码

```
 public void deleteFunction(int id){ 
         Toast.makeText(this, "Sters", Toast.LENGTH_SHORT).show();
        File file = new File(path); 
         boolean deleted = file.delete();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:47:22.143

它只是意味着没有`File`构造函数获取字符串列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:49:37.723

因为路径是`ArrayList`并且您需要从路径 ArrayList 而不是整个 ArrayList 传递文件的路径，将您的代码更改为：

```
 public void deleteFunction(int id){ 
         //...
         if(id<path.size()){
          File file = new File(path.get(id)); 
          boolean deleted = file.delete();
         }
        } 
```

# jquery - 悬停在动画上时暂停动画

> ID：14715636
> 
> 赞同：0
> 
> 时间：2013-02-05T19:46:06.100
> 
> 标签：jquery, onhover

这是我在这里的第一篇文章，但多年来我一直使用这个网站作为一个很好的参考。当我将鼠标悬停在幻灯片上时，我只是想让幻灯片放映暂停。代码如下。我尝试使用 jquery hover 来停止它，但我没有任何成功。有人有想法么？

```
$(function() {
    // create the image rotator
    setInterval("rotateImages()", 7000);
});

function rotateImages() {
   var oCurPhoto = $('#photoShow div.current');
   var oNxtPhoto = oCurPhoto.next();
   if (oNxtPhoto.length == 0)
      oNxtPhoto = $('#photoShow div:first');

    oCurPhoto.removeClass('current').addClass('previous');
    oNxtPhoto.css({ opacity: 0.0 }).addClass('current').animate({ opacity: 1.0 }, 1000,
        function() {
            oCurPhoto.removeClass('previous');
        });
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:01:29.957

它可能很难看，但这应该可以

```
$(function() {
    var myTimer = 0;
    myTimer = setInterval("rotateImages()", 7000);

    $('#photoShow').mouseover(function() {
            clearInterval(myTimer);
      }).mouseout(function(){
            myTimer = setInterval("rotateImages()", 7000);
      });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:54:49.440

在您实施的方式中，我只能推荐一个 var 来存储轮换的状态。

像这样：

```
var canRotate = true;

$(function() {
    // create the image rotator
    setInterval("rotateImages()", 7000);
});

function rotateImages() {
   if(!canRotate) { return; }
   var oCurPhoto = $('#photoShow div.current');
   var oNxtPhoto = oCurPhoto.next();
   if (oNxtPhoto.length == 0)
      oNxtPhoto = $('#photoShow div:first');

    oCurPhoto.removeClass('current').addClass('previous');
    oNxtPhoto.css({ opacity: 0.0 }).addClass('current').animate({ opacity: 1.0 }, 1000,
        function() {
            oCurPhoto.removeClass('previous');
        });
} 
```

这应该可以正常工作。

`.stop()`PS：您也可以在`jQuery`库中查找方法。这将向正在动画的对象发送停止请求。

# c# - 使用奇怪的 sql 格式将浮点数转换为百分比

> ID：14715638
> 
> 赞同：4
> 
> 时间：2013-02-05T19:46:10.917
> 
> 标签：c#, type-conversion, decimal, percentage

我有一个 SQL 表，其中有一列的数据类型为 Float。有一个外部应用程序将百分比值写入此列，我读取它们并将它们显示在 Web 应用程序中。

我了解如何将小数转换为百分比；通常我会乘以 100，但这有点不同。

DB 中的值如下所示：

```
 0.95  <-- DB  5%  <-- UI
 0.85  <-- DB  15% <-- UI
 0.5   <-- DB  50% <-- UI 
```

我试过了

```
number * percentage / 100 
```

和

```
((percentage /100) * value).ToString(); 
```

和

```
 string percentage = string.Format("Percentage is {0:0.0%}", value); 
```

和

```
 percentage/100m*value 
```

和

```
 myDecimal.ToString("0.00"); 
```

最后，我认为很接近：

```
Math.Round(myDecimal, 2).ToString("{0.00}"); 
```

当然还有各种字符串格式化的东西，比如

```
 MyDecimal.ToString("P"), .ToString("P1"), etc) 
```

C# 中有关格式化、舍入和转换百分比的文章：

[将百分比转换为最接近的分数](https://stackoverflow.com/questions/14320891/convert-percentage-to-nearest-fraction)， [c# 中的工作百分比](https://stackoverflow.com/questions/5581145/working-percentage-in-c-sharp)， [http://www.dotnetperls.com/percentage](http://www.dotnetperls.com/percentage)，

但我无法终生找到数学计算或内置的 c# 转换来给我需要的输出。

看起来我需要做的是让 0.96 位数字减去某个数字，然后再乘以 100，但 0.5 是 50% 总是让我的数学问题......

这似乎是一种常见的转换；我在这里想念什么？

# 更新

这是我最终得到的解决方案，效果很好！（感谢里德）

```
 var li = new List<Object>();
        var retVal = new List<string>();

        li.Add(.5);       // 50%
        li.Add(.95);      // 95%
        li.Add(.85);      // 85%
        li.Add(0.87813);  // 12.18700%

        foreach (var o in li)
        {
            var value = Convert.ToDouble(o);
            string percentage = string.Format("Percentage is {0:0.0%}", 1.0 - value);

            retVal.Add(percentage);
        } 
```

# 链接

为了完整起见，这里有一个关于小数、百分比、双精度和 C# 转换的非常简洁的资源列表：

一个+

[c#中的工作百分比](https://stackoverflow.com/questions/5581145/working-percentage-in-c-sharp)
[为百分比值格式化小数？](https://stackoverflow.com/questions/1790975/format-decimal-for-percentage-values)
[将百分比转换为最接近的分数](https://stackoverflow.com/questions/14320891/convert-percentage-to-nearest-fraction)
[http://www.dotnetperls.com/percentage](http://www.dotnetperls.com/percentage)
[.NET：小数到四舍五入的字符串](https://stackoverflow.com/questions/2141703/net-decimal-to-rounded-string?rq=1)
[C# 是否有内置函数可以将格式化的字符串转换回数字？](https://stackoverflow.com/questions/5615551/c-sharp-is-there-a-built-in-function-to-convert-a-formatted-string-back-to-a-num/5615697#5615697)

一种-

[将小数格式化为具有特定小数位的](https://stackoverflow.com/questions/5183444/format-decimal-as-a-percent-with-specific-decimal-places)
[百分比 将小数转换为百分比或移动小数位。如何](https://stackoverflow.com/questions/3009076/convert-decimal-to-percent-or-shift-decimal-places-how)
[将百分比字符串转换为双倍？](https://stackoverflow.com/questions/2171615/how-to-convert-percentage-string-to-double)

乙+

[显示小数的两种方式](https://stackoverflow.com/questions/3852048/two-ways-of-displaying-a-decimal)
[http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx](http://msdn.microsoft.com/en-us/library/dwhawy9k.aspx)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:54:22.740

我相信你会想要：

```
string percentage = string.Format("Percentage is {0:0.0%}", 1.0 - value); 
```

如果你只想要号码：

```
string percentage = (1.0 - value).ToString("P"); 
```

或者，没有小数精度的数字：

```
string percentage = (1.0 - value).ToString("P0"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:50:24.710

尝试：

```
(1 - currentPercentage) * 100 
```

例子：

```
(1 - 0.95) * 100 = 0.05 * 100 = 5 [%] 
```

格式化：

```
string.Format("Percentage is {0}%", (1.0 - value) * 100); 
```

*或者@Reed 建议的最好的*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T19:49:16.633

从您的百分比中减去一 (1)，然后乘以 100。1-.5 = .5 = 50%。1-.95 = .05 = 5%

# webdriver - .Click() 不适用于 selenium RemoteWebDriver

> ID：14715639
> 
> 赞同：0
> 
> 时间：2013-02-05T19:46:16.297
> 
> 标签：webdriver, saucelabs

我有许多使用 WebDriver 的自动化测试用例，它们都在我的本地机器上完美运行。

现在我需要在 Saucelabs 上远程运行这些测试用例，所以我应该使用 RemoteWebDriver。

但是我收到一个找不到方法 Click() 的错误。我已经尝试了所有建议，例如改用 submit() 或为 Click 创建 JS，但仍然发生相同的错误。

driver.findElements(By.id("我的 div id")).click();

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T04:41:03.940

findElements() 方法返回一个 WebElements 列表，您可以尝试调用 findElement() 方法吗？

# java - Spring MVC 3.2 - 错误页面的内容协商？

> ID：14715640
> 
> 赞同：12
> 
> 时间：2013-02-05T19:46:22.110
> 
> 标签：java, spring, spring-mvc, content-negotiation

为了全局处理可能在控制器之外发生的错误（例如 HTTP 404），我的 web.xml 中有类似于以下内容的条目：

```
<error-page>
    <error-code>404</error-code>
    <location>/errors/404</location>
</error-page> 
```

在我的 ErrorController 中，我有类似以下的相应方法：

```
@Controller
@RequestMapping("/errors")
public class ErrorController {

    @RequestMapping(value = "/404", method = RequestMethod.GET)
    @ResponseBody
    public ResponseEntity<ErrorResponse> error404() {

        ErrorResponse errorBody = new ErrorResponse(404, "Resource Not Found!");

        return new ResponseEntity<ErrorResponse>(errorBody, HttpStatus.NOT_FOUND);
    }
} 
```

我面临的问题是`ContentNegotiationManager`我配置的和消息转换器在这种情况下没有被使用。我怀疑由于请求被重定向到错误页面，内容协商中使用的原始请求属性丢失了，这被视为一个完全独立的请求。（即对 /mycontroller/badresource.json 的原始请求 --> /errors/404（无文件扩展名））

像这样的错误处理程序中是否有任何方法可以确定和/或响应原始请求中请求的适当内容类型？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-06-19T18:42:52.170

Spring MVC 3.2 现在包含一个有用的注解，称为`@ControllerAdvice`. 您可以添加一个`ExceptionHandler`全局处理您定义的任何异常的方法。

对我来说，我只关心返回给客户端的两种可能的内容类型 -`application/json`或`text/html`.

这是我将如何设置它 -

```
@ControllerAdvice
public class ExceptionControllerAdvice {

    private static final Charset DEFAULT_CHARSET = Charset.forName("UTF-8");
    private static final MediaType JSON_MEDIA_TYPE = new MediaType("application", "json", DEFAULT_CHARSET);

    //I decided to handle all exceptions in this one method
    @ExceptionHandler(Throwable.class)
    public @ResponseBody String handleThrowable(HttpServletRequest request, HttpServletResponse response, Throwable ex) throws IOException {

        ...

        if(supportsJsonResponse(request.getHeader("Accept"))) {

            //return response as JSON
            response.setStatus(statusCode);
            response.setContentType(JSON_MEDIA_TYPE.toString());

                    //TODO serialize your error in a JSON format
                    //return ...

        } else {

            //return as HTML
            response.setContentType("text/html");
            response.sendError(statusCode, exceptionMessage);
            return null;
        }
    }

    private boolean supportsJsonResponse(String acceptHeader) {

        List<MediaType> mediaTypes = MediaType.parseMediaTypes(acceptHeader);

        for(MediaType mediaType : mediaTypes) {
            if(JSON_MEDIA_TYPE.includes(mediaType)) {
                return true;
            }
        }

        return false;
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-07T22:04:19.963

我为此想出了一些技巧，但它似乎有效。它基本上涉及错误处理中的额外转发以确定原始请求的文件扩展名。

在我的 web.xml 中，我将错误转发给了中间操作：

```
<error-page>
    <error-code>404</error-code>
    <location>/errors/redirect</location>
</error-page> 
```

然后，在转发到将生成错误响应的操作之前，会检查原始请求是否有文件扩展名。如果有，它确保将其附加到转发 URI。HTTP 标头是自动转发的，因此如果您设置的内容协商仅涉及文件扩展名或 HTTP 标头，这将有效地允许“错误页面”以适当的内容类型返回错误。

```
@Controller
@RequestMapping("/errors")
public class ErrorController {

    @RequestMapping(value = "/redirect", method = RequestMethod.GET)
    public void errorRedirect(HttpServletRequest request, HttpServletResponse response) {

        // Get original request URI
        String uri = (String)request.getAttribute(WebUtils.ERROR_REQUEST_URI_ATTRIBUTE);

        // Try to determine file extension
        String filename = WebUtils.extractFullFilenameFromUrlPath(uri);
        String extension = StringUtils.getFilenameExtension(filename);
        extension = StringUtils.hasText(extension) ? "." + extension : "";

        // Forward request to appropriate handler with original request's file extension (i.e. /errors/404.json)
        String forwardUri = "/errors/404" + extension); 
        request.getRequestDispatcher(forwardUri).forward(request, response);
    }

    @RequestMapping(value = "/404", method = RequestMethod.GET)
    @ResponseBody
    public ResponseEntity<ErrorResponse> error404() {

        ErrorResponse errorBody = new ErrorResponse(404, "Resource Not Found!");

        return new ResponseEntity<ErrorResponse>(errorBody, HttpStatus.NOT_FOUND);
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-06T11:43:25.423

是的，应用程序异常和 HTTP 响应错误代码是两个不同的东西。

您可以修改如下代码，以便您可以访问`requestUri`. 我想你可以根据它找到内容类型。我知道它很粗糙，但我认为我们没有替代解决方案：

```
@RequestMapping(value = "/404", method = RequestMethod.GET)
@ResponseBody
public ResponseEntity<ErrorResponse> error404(HttpServletRequest request) {

    ErrorResponse errorBody = new ErrorResponse(404, "Resource Not Found!");

    String requestUri = request.getRequestURI();

    return new ResponseEntity<ErrorResponse>(errorBody, HttpStatus.NOT_FOUND);
} 
```

从示例中我假设您的应用程序是 REST 服务，那么您可能可以参考此链接了解如何在 REST 完整服务[中处理 404 。](http://www.stormpath.com/blog/spring-mvc-rest-exception-handling-best-practices-part-2)

# java - 唯一索引中的重复行：使类不可变之后

> ID：14715644
> 
> 赞同：0
> 
> 时间：2013-02-05T19:46:36.010
> 
> 标签：java, database, prepared-statement, immutability

我正在尝试插入 XpressMP 数据库，这是一个新数据库。我编写了一个多线程程序，以将其插入到具有多个线程的数据库中。

我正在尝试用两列插入下表 -`ID and ACCOUNT`

```
ID      String Primary Key
ACCOUNT String 
```

所以目前我有 ID 作为主键。每当我插入数据库时​​，我都需要生成一个新 ID，否则它会抛出一个异常显示 -

`duplicate row in unique index:`

因此，为此我创建了一个像这样的不可变类，其中我有 user_id，每次新线程要求时都会生成它-

```
public final class ConstantsFiles {

    private static Random rnd = new Random();
    private final static int NO_OF_DIGITS = 10;

    public static String user_id;

    public final static String ACCOUNT = "{\"lv\":null,\"lmd\":13597}";

    public final static String INSERT_SQL = "INSERT INTO COPY"
        + "("
        + "ID, ACCOUNT) VALUES"
        + "(?, ?)";

    /**
     * Generates a Random user id
     * 
     */

    public static String getUser_id() {
        StringBuilder sb = new StringBuilder(NO_OF_DIGITS);
        for (int i = 0; i < NO_OF_DIGITS; i++)
            sb.append((char) ('0' + rnd.nextInt(10)));

        return sb.toString();
    }

} 
```

下面是我的多线程代码，它每次都从我在上面的不可变类中的 get 方法获取新 ID -

```
@Override
public void run() {

    try {
        dbConnection = getDBConnection();
        preparedStatement = dbConnection.prepareStatement(ConstantsFiles.INSERT_SQL);

        preparedStatement.setString(1, ConstantsFiles.getUser_id());
        preparedStatement.setString(2, ConstantsFiles.ACCOUNT);

        preparedStatement.executeUpdate();

    } catch (Exception e) {
        LOG.error(e);
    } finally {
        // close connection
    }
    } 
```

其中每个线程每次都会生成一个新的 USER ID 并且每次都使用相同的 ACCOUNT 值并插入到数据库中。

但不知何故，在某个阶段它给了我一个例外-

```
duplicate row in unique index:COPY_PRIMARY_KEY_ 
```

这意味着在某些时候它使用相同的 USER ID 插入数据库，因此它会抛出异常。

任何想法为什么会发生。我已经使类不可变并添加了 get 方法。那么有什么问题呢？可能是我的类不是一成不变的？

**我只需要使用为每个新线程生成的新用户 ID 插入数据库，但我每次都可以使用相同的 ACCOUNT 值。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:50:37.173

随机不保证唯一。您需要在数据库中打开一个事务，并确保在插入之前它没有被使用，否则这肯定会最终发生。

编辑：我根本不知道 XpressMP，但在伪 SQL 中，您需要执行以下操作：

```
BEGIN
    DECLARE @free = NULL
    LOCK COPY
    SELECT INTO @free ID FROM COPY WHERE ID = ?
    IF free IS NULL
        INSERT ....
    UNLOCK COPY
END 
```

# javascript - 如何从数组中提取元素并将其放入 javascript 的文本字段中

> ID：14715645
> 
> 赞同：0
> 
> 时间：2013-02-05T19:46:44.587
> 
> 标签：javascript

这只是我想要完成的一个练习。我正在考虑以最基本的方式创建订单。我有一个带有吉他列表的基本数组。我会让用户在第一个字段中输入一个数字，该数字将引用数组中的索引以将数组元素放入另一个文本框中。这就是我现在所拥有的-

```
var gbrand = ('Jackson', 'BC Rich', 'Gibson', 'Fender', 'Dean', 'ESP', 'Fernandez');

function ordernum(gbrand)
{

    var order = document.order.perchnumb.value 

    if ( order != '' )
    {

      order = gbrand[index];
      document.order.instrum.value = order;

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:48:35.167

您快到了。您只是忘记了`Array`构造函数。

```
var gbrand = Array('Jackson',.....); 
```

或者您可以使用数组文字（首选）：

```
var gbrand = ['Jackson',...]; 
```

注意方括号而不是圆括号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:49:30.977

使用您的代码，我会说这应该可以解决问题：

```
var gbrand = ['Jackson', 'BC Rich', 'Gibson', 'Fender', 'Dean', 'ESP', 'Fernandez'];

function ordernum(gbrand) {
    var orderId = document.order.perchnumb.value 

    if (orderId != '' && !isNaN(orderId)) {
      document.order.instrum.value = gbrand[orderId];
    }
} 
```

如果您这样保留代码，`var gbrand`它将存在于全局命名空间中，使其可用于函数`ordernum`，而无需实际将其作为参数传递给函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:51:24.093

该数组的构造类似于 Kolink 注释：

```
var gbrand = ['Jackson', ...]; 
```

但是还有第二个问题：

```
order = gbrand[index]; 
```

在那个 ode 片段索引是未定义的，修改它：

```
order = gbrand[order]; 
```

# xpages - 在主题 Xpages 中的视图列/日期字段上设置区域设置

> ID：14715649
> 
> 赞同：2
> 
> 时间：2013-02-05T19:46:51.793
> 
> 标签：xpages

在每个日期字段组件/编辑框组件/视图列上设置区域设置非常耗时。是否可以将它们设置在主题中？

编辑：更清楚一点：我们将一个应用程序发送给几个客户，以便在他们的服务器上运行。客户对如何显示和输入日期有不同的需求，具体取决于适用于其原籍国的区域设置。我们有许多显示日期数据的视图，今天我们将所有日期列转换器区域设置为客户所在的国家/地区；瑞典语 (sv)、荷兰 (nl)、丹麦 (da)... 每当我们在新客户处安装应用程序时，我们都需要修改每个日期列的转换器区域设置。我希望它更像是一个中心设置，我想为什么不在一个主题中呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T21:21:17.337

我不确定您对“语言环境”设置的含义。你是说转换器吗？要从主题设置转换器，您可以使用属性*转换器*并用 SSJS 代码填充它：

```
<control>
  <name>DateConverter</name>
  <property mode="override">
     <name>converter</name>
     <value>#{javascript:
         var converter = new com.ibm.xsp.convert.DateTimeConverter();
         converter.setPattern("MMMM yy");
         return converter
     }</value>
   </property>
</control> 
```

然后您可以将 themeId 添加到您想要的每个组件中：

```
<xp:inputText id="inputText1" value="#{javascript:@Now()}" themeId="DateConverter" /> 
```

# layout - Zend 框架 2 和 Twig（带有 ZfcTwig 模块） - 如果呈现动作模板，则会丢失布局模板内容

> ID：14715653
> 
> 赞同：0
> 
> 时间：2013-02-05T19:46:59.900
> 
> 标签：layout, zend-framework2, twig

我正在尝试将 ZF2 与 ZfcTwig 模块一起使用。我有骨架应用程序的基本结构：view->layout->layout.phtml (or layout.twig) view->application->index->​​index.phtml (or index.twig)

如果我使用下一对：layout.twig 和 index.phtml - ZfcTwig 模块正确渲染了 layout.twig，则 index.phtml（默认渲染）的结果也是正确的。

但是，如果我尝试将内容模板用作树枝模板（两个树枝文件） - 我只得到具有正确渲染的 index.twig，但没有来自布局模板（layout.twig 甚至 layout.phtml）

有没有人有同样的情况？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-06T16:39:08.413

您可以使用树枝布局，它与 ZfcTwig 配合得很好

在 index.twig 中

```
{% extends 'layout/layout.twig' %}

{% block content %}
    Here your template
{% endblock content %} 
```

在 layout.twig 中

```
{% block content %}{{ content|raw }}{% endblock content %} 
```

# python - 如何从 python3 中的用户输入计算最小值和最大值

> ID：14715659
> 
> 赞同：0
> 
> 时间：2013-02-05T19:47:16.197
> 
> 标签：python, max, min

```
def main():
    print("*** High School Diving ***")

    num_judges=int(input("How many judges are there? "))

    for i in range (num_judges):
            scores=int(input("Ender a score: " ))
    x=min(scores)
    y=max(scores)

    print("Min: ", x)
    print("Max: ", y)

main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:58:25.350

这里还有一些你可以做到这一点的方法。

首先，至少有两个人已经发布了与 Martijn Pieters 的第一个答案完全相同的内容，我不想感到被遗忘，所以：

```
scores = []
for i in range(num_judges):
    scores.append(int(input("Enter a score: ")))
x=min(scores)
y=max(scores) 
```

* * *

现在，每当您创建一个空列表并在循环中附加到它时，这与列表推导相同，因此：

```
scores = [int(input("Enter a score: ")) for i in range(num_judges)]
x=min(scores)
y=max(scores) 
```

* * *

同时，如果`num_judges`是巨大的，你不想建立那个巨大的列表只是为了找到最小值和最大值？好吧，您可以随时跟踪它们：

```
x, y = float('inf'), float('-inf')
for i in range(num_judges):
    score = int(input("Enter a score: "))
    if score < x:
        x = score
    if score > y:
        y = score 
```

* * *

最后，有没有办法两全其美？通常，这只是意味着使用生成器表达式而不是列表推导式。但是在这里，你需要`min`和`max`遍历分数，这意味着它必须是一个列表（或其他可重用的东西）。

您可以通过以下方式解决此问题`tee`：

```
scores= (int(input("Enter a score: ")) for i in range(num_judges))
scores1, scores2 = itertools.tee(scores)
x = min(scores1)
y = max(scores2) 
```

但是，这并没有真正的帮助，因为在幕后，`tee`它将创建您已经创建的相同列表。（`tee`当您要并行遍历两个迭代器时非常有用，但在这种情况下则不然。）

因此，您需要编写一个`min_and_max`函数，它看起来很像`for`前面示例中的循环：

```
def min_and_max(iter):
    x, y = float('inf'), float('-inf')
    for val in iter:
        if val < x:
            x = val
        if val > y:
            y = val
    return x, y 
```

然后，你可以用一个漂亮的、可读的单行代码来完成整个事情：

```
x, y = min_and_max(int(input("Enter a score: ")) for i in range(num_judges)) 
```

当然，当您必须编写一个 8 行函数才能使其工作时，它并不是真正的单行……除了 8 行函数将来可能在其他问题中可重用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:49:08.763

您需要使用一个列表，并将每个输入的分数附加到它：

```
scores = []
for i in range (num_judges):
    scores.append(int(input("Enter a score: " ))) 
```

`max()`然后`min()`将分别从该列表中选择最高和最低值。

相反，您所做的是每次循环时都*替换为一个新值；* `scores`然后尝试找到`min()`一个整数，这是行不通的：

```
>>> min(1)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: 'int' object is not iterable 
```

通过使用列表，该`min()`函数可以遍历它（迭代）并找到您的最小值：

```
>>> min([1, 2, 3])
1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:51:54.293

你快到了，你只需要制作`scores`一个列表并附加到它，那么这应该可以工作：

```
def main():
    print("*** High School Diving ***")

    num_judges=int(input("How many judges are there? "))

    #define scores as a list of values
    scores = []
    for i in range (num_judges):
            scores.append(int(input("Ender a score: " ))) #append each value to scores[]
    x=min(scores)
    y=max(scores)

    print("Min: ", x)
    print("Max: ", y)

main() 
```

如果您查看文档[`max()`](http://docs.python.org/2/library/functions.html#max)，[`min()`](http://docs.python.org/2/library/functions.html#min)他们实际上给了您语法，说明它需要可迭代类型（例如非空字符串、元组或列表）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T19:49:38.337

您正在`scores`for 循环内创建一个变量，该变量在其外部不可见。其次，您试图`scores`在每次迭代中重写该值，因为`scores`它不是`list`一种`scalar`类型。

您应该在循环外和循环内将每个分数声明为列表中的`scores`类型。`list``append`

```
scores = []
for i in range (num_judges):
        scores.append(int(input("Ender a score: " )))
x=min(scores)
y=max(scores) 
```

# java - Weka J48 更换选项 - 没有区别

> ID：14715665
> 
> 赞同：4
> 
> 时间：2013-02-05T19:47:23.660
> 
> 标签：java, weka

我正在尝试更改 J48 分类器的选项，但它对结果树没有影响。

我的代码：

```
J48 cls = new J48();
Instances data = new Instances(new BufferedReader(new FileReader("someArffFile")));
data.setClassIndex(data.numAttributes() - 1);

//was trying to use -M 1 and -M 5, but no difference    
String[] options = new String[1];
options[0] = "-C 1.0 –M 1";     
cls.setOptions(options);

cls.buildClassifier(data);

//displaying J48 tree
TreeVisualizer tv = new TreeVisualizer(null,cls.graph(),new PlaceNode2()); 
```

在我使用此方法设置值后，一切正常。

```
cls.setMinNumObj(5); 
```

有什么想法可以使用 setOptions 方法而不是 setMinNumObj 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-01T11:50:40.857

首先，选项应该是一个数组而不是一个字符串。所以你可以尝试如下。

```
String[] options = {"-C", "1.0", "-M", "1"};
cls.setOptions(options); 
```

更重要的是，应该仔细注意一个小错误。在您的问题和@Sentry 的上一个答案中，在 C 之前出现了较短的一行，例如“-C”；但更长的行出现在 M 之前，例如“-M”。

如果你仔细观察，你会发现 M 前面的符号实际上不是减号，因为它比减号长。当您将较长的行更改为真正的减号时，您可以通过上面的代码得到正确的结果。

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T19:00:10.053

问题是您如何尝试设置选项。`options`数组应该像方法中的数组`args`一样`main`，每个元素一个字符串：

```
String[] options = {"-C", "1.0", "–M", "1"};
cls.setOptions(options); 
```

否则它将无法正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-17T20:01:38.717

最好的方法是利用`splitOptions(String[] options)`weka.Core.Utils 类的方法：

```
String[] options = weka.core.Utils.splitOptions("-C 1.0 –M 1");
cls.setOptions(options); 
```

# c# - 如果多个应用程序使用同一个端口，端口：8080 的自托管 Web api 是否会发生冲突？（温特）

> ID：14715675
> 
> 赞同：0
> 
> 时间：2013-02-05T19:47:55.967
> 
> 标签：c#, .net, api, windows-runtime

我正在努力将动态磁贴添加到我的 Windows 8 应用程序中，对我来说最好的解决方案是使用 Web 托管的 API 来向磁贴发送更新。

我担心我最终可能会使用另一个应用程序已在使用的端口。

所以我想知道这是否是一个问题。或者，如果有一种方法可以在分配端口之前进行检查。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:49:24.010

一次只能有一个应用程序绑定到一个端口。如果当您的应用程序尝试绑定到端口 8080 并侦听某个端口时，您的程序将引发异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T19:53:04.803

是的，这是一个问题。两个应用程序不能同时绑定到同一个端口。

# security - Vagrant 默认不安全？

> ID：14715678
> 
> 赞同：73
> 
> 时间：2013-02-05T19:48:00.623
> 
> 标签：security, vagrant

**编辑 2**：TL；DR：**2013 年的答案是肯定的，但这个缺陷已经修复**

按照 vagrantup.com 上的入门说明，我似乎最终得到了一个在端口 2222 上接受 SSH 连接的虚拟机，这样任何人都可以使用默认凭据（用户名）获得对我的 VM 的 root 访问权限并读取我的主机工作目录=password=vagrant 或 vagrant_insecure_private_key）。

这是真的？如果是，为什么不认为它是一个巨大的安全漏洞？如果我将敏感数据复制到 VM 会怎样？

**编辑**：对于那些认为互联网上的任何人都能够阅读您的源代码并在您的 VM 上执行任意代码的人来说还不错，我建议您阅读这篇博[文 http://blog.ontoillogical 中的“突破”部分。 com/blog/2012/10/31/闯入和走出流浪者/](http://blog.ontoillogical.com/blog/2012/10/31/breaking-in-and-out-of-vagrant/)

简而言之：“按预期”运行 Vagrant 还可以让任何人闯入您的主机/开发机器（例如，通过使用恶意 git post-commit 钩子）。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-02-05T23:55:58.693

简短的回答是**YES**。

**为什么？**

在构建 Vagrant base box（手动或使用 Veewee 等工具自动化）时，构建者遵循[vagrant base box 规范](http://docs.vagrantup.com/v1/docs/base_boxes.html)，该规范定义了以下内容：

1.  用户`root`并`vagrant`使用**vagrant**作为密码
2.  用户的公钥认证（无密码）`vagrant`。

Vagrant 项目为 SSH 公钥身份验证提供了一个不安全的[**密钥对**](https://github.com/mitchellh/vagrant/tree/master/keys)`vagrant ssh`，因此可以正常工作。

因为每个人都可以访问私钥，所以任何人都可以使用私钥登录您的虚拟机（假设他们知道您的主机 IP，端口默认为 2222 作为转发规则。）

它不是安全的 OOTB。但是，您可以从中删除受信任的密钥`~vagrant/.ssh/authorized_keys`并添加自己的密钥，更改密码`vagrant`，`root`然后它被认为是相对安全的。

**更新**

从 Vagrant 1.2.3 开始，默认情况下 SSH 转发端口绑定到 127.0.0.1，因此只允许本地连接 [GH-1785]。

**重要更新**

从 Vagrant 1.7.0 ( [PR #4707](https://github.com/mitchellh/vagrant/pull/4707) ) 开始，Vagrant 将首先用随机生成的密钥对替换默认的不安全 ssh 密钥对`vagrant up`。

请参阅[CHANGELOG](https://github.com/mitchellh/vagrant/blob/master/CHANGELOG.md)：使用默认的不安全密钥对，Vagrant 会在 first 上自动将其替换为随机生成的密钥对`vagrant up`。[GH-2608](https://github.com/mitchellh/vagrant/issues/2608)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-06-04T13:57:55.007

我已在 github 存储库中将此问题作为 vagrant 的问题提出。开发人员表示他们将解决转发端口在外部可用的问题。然而，开发人员不接受有关从 VM 破坏主机环境的问题。我认为他们大错特错。

[https://github.com/mitchellh/vagrant/issues/1785](https://github.com/mitchellh/vagrant/issues/1785)

脱离 vm 比链接的博客文章建议的要容易。您不必依赖 git 挂钩来破坏主机，只需将任意 ruby​​ 代码放入 Vagrant 文件即可。

如果可以的话，我会在虚拟机沙箱中运行 vagrant。既然不能，我就凑合着用防火墙。

最好有配置规则来添加安全 ssh 密钥，并删除不安全的密钥和默认密码。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-02-01T01:21:10.773

我编写了这个简单的内联 shell 配置程序，用我的 id_rsa.pub 替换了 authorized_keys。一旦提供了 insecure_private_key 就不能用于身份验证。

```
VAGRANTFILE_API_VERSION = "2"

Vagrant.configure(VAGRANTFILE_API_VERSION) do |config|

# ...

  config.ssh.shell = "bash -c 'BASH_ENV=/etc/profile exec bash'" # avoids 'stdin: is not a tty' error.

  config.ssh.private_key_path = ["#{ENV['HOME']}/.ssh/id_rsa","#{ENV['HOME']}/.vagrant.d/insecure_private_key"]

  config.vm.provision "shell", inline: <<-SCRIPT
    printf "%s\n" "#{File.read("#{ENV['HOME']}/.ssh/id_rsa.pub")}" > /home/vagrant/.ssh/authorized_keys
    chown -R vagrant:vagrant /home/vagrant/.ssh
  SCRIPT

end 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-09-18T17:49:37.613

从 Vagrant 1.2.3 开始，默认绑定到 localhost 而不是公共接口，避免了外部连接问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-03T20:48:43.953

只是想补充一点，有一个 Vagrant 插件可以解决这个问题：[vagrant-rekey-ssh](https://github.com/virtuald/vagrant-rekey-ssh)。它会更改 VM 的默认密码，并删除不安全的 SSH 密钥。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-09T17:33:56.873

我想解释一下为什么 Vagrant 不一定像你想象的那样不安全。

首先我想说的是，我相信你们中的大多数人已经意识到，有必要保持对 Vagrant 盒子的开放访问，因为这些盒子是共享的。出于这个原因，我认为主要的安全问题不是在下载盒子后更改默认凭据。在桥接模式下运行这样的机器将允许网络上的某人使用默认凭据进行 ssh。

It appears to me that the idea behind these boxes is that anyone can download it, and secure it once it is in their possession. My vagrant installation replaces default keys with a new, randomly generated ssh key. I am not sure if this is being done with a plugin, however I am curious to know if the password-less sudo and default password also present a security risk.

# python - matplotlib mathtext 的奇怪输出

> ID：14715679
> 
> 赞同：2
> 
> 时间：2013-02-05T19:48:01.840
> 
> 标签：python, matplotlib, fonts, fedora

我试图使用 mathtext 来获得一个特别渲染的图形标题，但它失败了。而不是我的测试标题，它只是打印了神秘的字符。我究竟做错了什么？

*   操作系统：Fedora release 18 (Spherical Cow)
*   Python 和 matplotlib 通过 yum 从官方存储库安装

这是（完整）代码：

```
import sys
print sys.version             # prints:
                              # 2.7.3 (default, Aug  9 2012, 17:23:57)
                              # [GCC 4.7.1 20120720 (Red Hat 4.7.1-5)]
import matplotlib
print matplotlib.__version__  # prints:
                              # 1.2.0

import matplotlib.pyplot as plt
plt.plot([1,5])
plt.title(r"$1.2345$")
plt.show() 
```

这是输出图像： ![奇怪的标题渲染](../Images/f4b7d478af314e16a535646548ed08cf.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T21:44:53.530

如果您使用 RedHat、CentOS 或其他 Fedora 衍生产品，您可能会看到此处描述的错误：[https ://bugzilla.redhat.com/show_bug.cgi?id=562421](https://bugzilla.redhat.com/show_bug.cgi?id=562421)

尝试安装“stix”字体包（在 CentOS/RedHat 上这是“stix-fonts”）。删除你的 ~/.matplotlib/fontlist.cache 文件。接下来，重新运行系统的字体缓存脚本，可能是“fc-cache -f -s -v”。

现在，更改 matplotlibrc 设置（通过 ~./matplotlib/matplotlibrc 文件或与脚本位于同一目录中的 matplotlibrc 文件），如下所示：

```
mathtext.fontset : stix 
mathtext.fallback_to_cm : True
mathtext.default : it 
```

我很想知道这是否适合你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T21:59:41.120

显然这是与字体相关的事情。找到一个旧的[错误报告](https://bugzilla.redhat.com/show_bug.cgi?id=562421)来解决这个问题。

[其中一条评论](https://bugzilla.redhat.com/show_bug.cgi?id=562421#c31)中的建议是安装该软件包`lyx-fonts`。这为我解决了这个问题。

* * *

[这里提出](https://bugzilla.redhat.com/show_bug.cgi?id=908717#c1)的另一个解决方法是像这样配置 mathtext 渲染（在脚本的顶部）：

```
plt.rcParams['mathtext.fontset'] = "stix" 
```

# php - wordpress 编辑锁

> ID：14715680
> 
> 赞同：0
> 
> 时间：2013-02-05T19:48:02.353
> 
> 标签：php, wordpress, locking

我有一个自定义帖子类型（产品），它有一个包含库存数量的元字段。

下订单后，即时更新数量

`$qty=get_post_meta($post->ID,'stock',true);

$数量--;

Update_post_meta($post->ID,'stock',$qty);`

事情是我担心多次同时调用此更新可能会导致数据不正确如果在另一个呼叫正在进行时进行呼叫......

有没有办法锁定那段代码并确保它不会同时被解雇，或者我是否在担心我的担忧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:08:39.610

好吧，一般来说不应该有问题，我的问题是你为什么要得到数量，然后用它来减去它并再次更新它，当一切都可以一步完成时。我假设这两种方法正在调用数据库。在 MYsql 中，您可以执行类似的操作

```
UPDATE yourtable SET quantity = quantity-1 WHERE id = .... 
```

这样，扣除发生在您的数据库中，您正在保存一个查询......

# android - 如何限制用户在 Android 的 EditText 中输入的字符数？

> ID：14715683
> 
> 赞同：2
> 
> 时间：2013-02-05T19:48:17.770
> 
> 标签：android, android-edittext

我希望用户在 EditText 字段中只输入一个字符。因此，如果他尝试输入一个字符串，则程序不应允许它并将其限制为仅一个字符。我该如何实现呢？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T19:53:50.537

从布局添加属性

```
android:maxLength="1" 
```

或从代码

```
TextEdit te = findViewById(...);
te.setFilters( new InputFilter[] { new InputFilter.LengthFilter(1) } ) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:53:16.837

中有一个`maxLength`属性`EditText`。只需将其设置为`1`：

```
<EditText 
        android:layout_height="wrap_content"
        android:layout_width="wrap_content"
        android:maxLength="1"/> 
```

# python - 手动安装 Python 库

> ID：14715684
> 
> 赞同：0
> 
> 时间：2013-02-05T19:48:17.777
> 
> 标签：python

我正在尝试安装一个特定的 python 库（[https://github.com/bitly/bitly-api-python/](https://github.com/bitly/bitly-api-python/)）。

推荐的方法是使用 pip，但是 pip 在我大学的认证代理系统后面不起作用。所以我正在尝试手动安装它。它有一个 setup.py 文件。我试着做`sudo python setup.py install`，它说：

```
running install
Checking .pth file support in /usr/local/lib/python2.7/dist-packages/
/usr/bin/python -E -c pass
TEST PASSED: /usr/local/lib/python2.7/dist-packages/ appears to support .pth files
running bdist_egg
running egg_info
writing bitly_api.egg-info/PKG-INFO
writing top-level names to bitly_api.egg-info/top_level.txt
writing dependency_links to bitly_api.egg-info/dependency_links.txt
reading manifest file 'bitly_api.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
writing manifest file 'bitly_api.egg-info/SOURCES.txt'
installing library code to build/bdist.linux-x86_64/egg
running install_lib
running build_py
creating build/bdist.linux-x86_64/egg
creating build/bdist.linux-x86_64/egg/bitly_api
copying build/lib.linux-x86_64-2.7/bitly_api/__init__.py -> build/bdist.linux-x86_64/egg/bitly_api
copying build/lib.linux-x86_64-2.7/bitly_api/bitly_http.py -> build/bdist.linux-x86_64/egg/bitly_api
copying build/lib.linux-x86_64-2.7/bitly_api/bitly_api.py -> build/bdist.linux-x86_64/egg/bitly_api
byte-compiling build/bdist.linux-x86_64/egg/bitly_api/__init__.py to __init__.pyc
byte-compiling build/bdist.linux-x86_64/egg/bitly_api/bitly_http.py to bitly_http.pyc
byte-compiling build/bdist.linux-x86_64/egg/bitly_api/bitly_api.py to bitly_api.pyc
creating build/bdist.linux-x86_64/egg/EGG-INFO
copying bitly_api.egg-info/PKG-INFO -> build/bdist.linux-x86_64/egg/EGG-INFO
copying bitly_api.egg-info/SOURCES.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying bitly_api.egg-info/dependency_links.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying bitly_api.egg-info/top_level.txt -> build/bdist.linux-x86_64/egg/EGG-INFO
copying bitly_api.egg-info/zip-safe -> build/bdist.linux-x86_64/egg/EGG-INFO
creating 'dist/bitly_api-0.2-py2.7.egg' and adding 'build/bdist.linux-x86_64/egg' to it
removing 'build/bdist.linux-x86_64/egg' (and everything under it)
Processing bitly_api-0.2-py2.7.egg
removing '/usr/local/lib/python2.7/dist-packages/bitly_api-0.2-py2.7.egg' (and everything under it)
creating /usr/local/lib/python2.7/dist-packages/bitly_api-0.2-py2.7.egg
Extracting bitly_api-0.2-py2.7.egg to /usr/local/lib/python2.7/dist-packages
bitly-api 0.2 is already the active version in easy-install.pth

Installed /usr/local/lib/python2.7/dist-packages/bitly_api-0.2-py2.7.egg
Processing dependencies for bitly-api==0.2
Finished processing dependencies for bitly-api==0.2 
```

这看起来像一个成功的安装。但是，如果我说`python`然后`import bitlyapi`，python 说`ImportError: No module named bitlyapi`。

我究竟做错了什么？

顺便说一句，我正在关注本指南： http: [//www.pythonforbeginners.com/code-snippets-source-code/bitly-shortener-with-python/](http://www.pythonforbeginners.com/code-snippets-source-code/bitly-shortener-with-python/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:50:42.187

目录的名称接缝为**bitly_api**。

所以`import bitly_api`在python中

# c++ - 在 C++ 中比较字符串

> ID：14715685
> 
> 赞同：-2
> 
> 时间：2013-02-05T19:48:19.603
> 
> 标签：c++

我是 C++ 的新手，我正在编写一个从文件中读取代码的程序，并将其每一部分分类为标识符、括号、关键字等。

我正在使用 if else 语句执行此操作，除了括号和分号外，它工作正常。

例如`if(a== "=" ) cout << "a is the equal operator"`有效，但`if(a== ";" ) cout << "a is a semicolon"`没有。我也尝试使用比较方法，它也不起作用。

有人可以告诉我为什么会这样吗？

谢谢

```
void checkString(string a)

        if(a=="("){
                cout << "RPAR: " << a + "\n";
        }

        else if(a==")"){
                cout << "LPAR: " << a + "\n";
        }

        else if(a.compare("{") == 0){
                cout << "LBRAC: " << a + "\n";
        }

        else if(a=="}"){
                cout << "RBRAC: " << a + "\n";
        }

        else{
                cout << "IDENTIFIER: " << a + "\n";
        }
}

int  main (){

    std::vector<string> STRINGS;
    string STRING;
    ifstream infile;
    infile.open("m.c");
    while(getline(infile,STRING,' ')){
            STRINGS.push_back(STRING);
    }

    infile.close();
    for(int i=0; i<STRINGS.size(); i++){
            checkString(STRINGS[i]);
    }

    return 0;
} 
```

如果 a 是括号或分号，程序将打印 IDENTIFIER: {。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:53:42.940

如果 a 是 ac 字符串，那么我会考虑使用[strcmp](http://www.cplusplus.com/reference/cstring/strcmp/)方法。如果它们是`#include <string>`标题下的字符串。我会调查[string::compare](http://www.cplusplus.com/reference/string/string/compare/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:35:32.773

看起来问题出在`getline(infile,STRING,' ')`.

如果您的代码遇到`\n`,`\t`等会发生什么？它将与您的令牌一起提取，您最终会得到一个字符串，例如`";\n"`，这与`";"`

更改用于标记文件的逻辑：

```
std::ifstream fin("m.c");
while (fin >> STRING ){
   STRINGS.push_back(STRING);
}
fin.close(); 
```

或者[修剪](https://stackoverflow.com/questions/216823/whats-the-best-way-to-trim-stdstring)你的绳子。

* * *

**更新：**

请记住，这种标记器仅在您的标记由空格分隔时才起作用（`return 0 ;`将按预期工作，`return 0;`将被标记为`return`and `0;`）

# c++ - emacs：类和结构的不同缩进

> ID：14715689
> 
> 赞同：10
> 
> 时间：2013-02-05T19:48:26.960
> 
> 标签：c++, emacs, indentation

我正在尝试在 emacs 中实现以下缩进：

```
class A
{
    // I ALWAYS use access labels in classes

    public: // access-label
        int member; // inclass
};

struct B
{
    // I NEVER use access labels in structs

    int member; // inclass
}; 
```

但是使用以下配置文件...

```
(defun my-cpp-mode ()
  "My C++ mode"
  (c++-mode)
  (c-set-style "K&R")
  (setq c-basic-offset 4)
  (c-set-offset 'access-label '-)
  (c-set-offset 'inclass '++)
  ;; ...
  (setq mode-name "My C++")
)
(add-to-list 'auto-mode-alist '("\\.[ch]p?p?\\'" . my-cpp-mode)) 
```

...我只实现：

```
class A
{
    public: // access-label
        int member; // inclass
};

struct B
{
        // this indentation is too long
        int member; // inclass
}; 
```

当然是因为：

*   对于缩进，“class”和“struct”显然没有区别（都是“inclass”），
*   “inclass”内容的缩进不取决于访问标签的存在与否。

知道如何根据类/结构或访问标签的存在来使 inclass 内容的缩进吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-07T09:53:01.053

**新答案**

我遇到了您在问题中提到的确切要求。我必须根据我的新项目的编码风格设置缩进。经过一番研究，我使用[Custom Line-up Functions](http://www.gnu.org/software/emacs/manual/html_mono/ccmode.html#Custom-Line_002dUp)实现了这一点。

修改你`my-cpp-mode`的样子：

```
(defun my-c-lineup-inclass (langelem)
  (let ((inclass (assoc 'inclass c-syntactic-context)))
    (save-excursion
      (goto-char (c-langelem-pos inclass))
      (if (or (looking-at "struct")
              (looking-at "typedef struct"))
          '+
        '++))))

(defun my-cpp-mode ()
  "My C++ mode"
  (c++-mode)
  (c-set-style "K&R")
  (setq c-basic-offset 4)
  (c-set-offset 'access-label '-)
  (c-set-offset 'inclass 'my-c-lineup-inclass)
  ;; ...
  (setq mode-name "My C++")
) 
```

如果这个答案是可以接受的，我会继续删除旧的答案。

**旧答案**

根据您要实现的目标，我可以建议一种不同的方法吗？您似乎希望访问标签的缩进级别与类和类成员不同。使用以下方法来实现。

```
(access-label . /) 
```

来自 Emacs 文档：

> 如果 OFFSET 是符号`+',`-'、`++',`--'、`*', or`/' 之一，则将 `c-basic-offset' 的正数或负数倍数添加到基本缩进；分别为 1、-1、2、-2、0.5 和 -0.5。

这是我定义的自定义样式之一的片段。

```
(c-add-style
 "xyz-style"
 '((indent-tabs-mode . nil)
   (fill-column . 75)
   (c-basic-offset . 4)
   (c-offsets-alist . (
                       (access-label . /)
                       (inextern-lang . 0)
                       (innamespace . 0)
                       (member-init-intro . ++)
                       )))) 
```

`c-basic-offset`设置为 4，`(access-label . /)`为访问标签添加 2 个空格的负缩进。这是我对您的示例代码的缩进模式的实际结果。

```
class A
{
    // I ALWAYS use access labels in classes

  public: // access-label
    int member; // inclass
};

struct B
{
    // I NEVER use access labels in structs

    int member; // inclass
}; 
```

我推荐这种模式，因为成员变量/结构成员的缩进级别是一致的。FWIW，[Google C Style](http://google-styleguide.googlecode.com/svn/trunk/google-c-style.el)遵循相同的方法。

据我所知，无法区分类成员或结构成员（`inclass`sytax 元素）。您可以使用`M-x c-syntactic-information-on-region`对区域进行句法分析。对您的示例进行的一项此类分析得出以下结果。从输出中，没有什么可以区分您是在类还是结构中。

```
class A                                 // ((topmost-intro 1))
{                                       // ((class-open 1))
                                        // ((inclass 64) (topmost-intro 64) (comment-intro))I ALWAYS use access labels in classes
                                        // ((inclass 64) (topmost-intro 64))
  public:                               // ((inclass 64) (access-label 64))access-label
    int member;                         // ((inclass 64) (topmost-intro 64))inclass
};                                      // ((class-close 1))
                                        // ((topmost-intro 503))
struct B                                // ((topmost-intro 503))
{                                       // ((class-open 629))
                                        // ((inclass 694) (topmost-intro 694) (comment-intro))I NEVER use access labels in structs
                                        // ((inclass 694) (topmost-intro 694))
    int member;                         // ((inclass 694) (topmost-intro 694))inclass
};                                      // ((class-close 629)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-03T20:57:55.420

根据上面 Praveen Kumar 的回答，我实现了一个稍微不同版本的自定义排队功能：

```
(defun my-c-lineup-inclass (langelem)
  (let ((inclass (assoc 'inclass c-syntactic-context)))
    (save-excursion
      (c-beginning-of-defun) ; This sees the correct string.
      (if (or (looking-at "struct")
              (looking-at "typedef struct"))
          '+
        '++))))

; In particular, the following offsets need to be specified:
(c-set-offset 'access-label '-)
(c-set-offset 'inclass 'my-c-lineup-inclass)
; ... 
```

如果大括号在下一行，则原始代码不起作用，即

```
struct foo
{
        int bar;
}; 
```

仍然会缩进到“ `++`”。

免责声明：我不知道任何 Lisp。我只是玩了一下，这对我有用。例如，我不知道是否存在与此相关的任何性能问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-24T18:28:11.670

我项目的编码标准现在需要这种缩进。像 Arkadiy 一样，我更喜欢尊重访问标签的解决方案。这就是我想出的：

```
(defun indent-after-access-label (langelem)
  "Return the appropriate indent for a class or a struct."
  (save-excursion
    (save-match-data
      ;; Optimization to avoid at least a few calls to re-search-backward.
      (if (assoc 'access-label c-syntactic-context)
          '++
        (if (re-search-backward "\\(?:p\\(?:ublic\\|r\\(?:otected\\|ivate\\)\\)\\)" c-langelem-pos langelem) t)
            '++
          '+))))) 
```

如前所述，`indent-after-acess-label`符号需要设置为`inclass`（通过`c-set-offset`或`c-offset-alist`等）的缩进。

由于 ，这并不理想`re-search-backward`，但它确实有效。

# if-statement - IF 语句未触发

> ID：14715708
> 
> 赞同：1
> 
> 时间：2013-02-05T19:49:16.813
> 
> 标签：if-statement, batch-file, dos

我在 dos .bat 文件中有一些小计算：

```
FOR /F "tokens=1-3 delims=/-" %%A IN ("%tag%") DO (
   SET Day=%%C
   SET Month=%%B
   SET /a Year=%%A - 2000
)

echo %Day%
echo %Month%
echo %Year%

echo %stamp%

IF %Month% == "02" (

  echo "Iam in"
) 
```

今天如果 2 月，那么 02 月即将到来，但如果条件尚未满足。我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T20:19:37.243

您的引号是比较字符串的一部分。你需要在两边都包括它们：

```
if "%Month%" == "02" (
  echo "Iam in"
) 
```

或者两边都没有：

```
if %Month% == 02 (
  echo "Iam in"
) 
```

# java - Java：是否可以使用 final 设置未初始化类的值？

> ID：14715721
> 
> 赞同：0
> 
> 时间：2013-02-05T19:49:39.380
> 
> 标签：java, optimization

采取以下示例类：

```
public class GlobalExample{
    static int width;
    static int height;
    static int size;
} 
```

可以使用以下方法从单独的类访问/初始化类成员：

```
GlobalExample.width = 1 
```

但是，如果我想让变量成为最终变量（据我所知，当程序大量访问变量时，这会使事情变得更高效）它们不能再在外部初始化，但它们似乎也不能在类中初始化在构造函数之外。但是，由于 GlobalExample 本身从未初始化，因此构造函数不会运行。

我的问题是是否有办法在类中初始化最终变量。

或者，我只是在树效率方面发出错误的声音吗？制作一个 VariablePackage 类的实例并将其传递给一百万个函数调用会更有效吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:51:49.517

声明它们时是否无法初始化它们？

```
public class GlobalExample{
    final static int width = 1;
    final static int height = 5;
    final static int size = 100;
} 
```

如果你必须动态修改它们，`final`这里可能不适合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:02:17.210

为每个变量添加一个`boolean`，告诉您它是否已设置，将变量设为私有，然后`boolean`在公共设置器中检查：

```
public class GlobalExample{
    private static int width;
    private static int height;
    private static int size;
    private static boolean widthSet;
    private static boolean heightSet;
    private static boolean sizeSet;

    public static void setWidth(int width) {
        if (widthSet) {
            widthSet = true;
            GlobalExample.width = width;
        } else {
            // Throw exception maybe?
        }
    }

    public static int getWidth() {
        if (widthSet) {
            return width;
        } else {
            // Throw an exception
        }
    }

    // Etc.
} 
```

或者，您可以使用包装类（`Integer`、`Character`等）并且仅在值为 时设置它们`null`。这与`boolean`方法类似，只是将`boolean`集成到变量本身的值中（即，如果它是 则不设置`null`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T20:23:51.070

除了`static final`内联初始化变量之外，您还可以使用静态初始化块：

```
public class MyClass {
    public static final String myFinal;
    static {
        myFinal = "Hello world";
    }
} 
```

然后，您可以在该`static`块中编写获取所需值所需的代码。

您是否明智地指出了错误的树效率？大概。先简单写一下。然后，一旦您确认这实际上是应用程序中的性能瓶颈，请尝试用几种不同的方式对其进行编码并衡量其影响。

此外，从设计的角度来看，静态的东西往往很难使用，所以问问自己你的系统是否真的需要这些字段是静态的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T20:26:02.057

要运行更复杂的初始化逻辑：

```
public class GlobalExample {
    private static final int height;
    private static final int width;

    static {
        switch(getBrowserType()) {
            case 0: height = 100; width = 50; break;
            case 1: height = 400; width = 600; break;
            default: height = 798; width = 1024; break;
        }
    }
} 
```

# knockout.js - 如何使用自定义绑定与 ko.observableArray()

> ID：14715724
> 
> 赞同：8
> 
> 时间：2013-02-05T19:49:45.030
> 
> 标签：knockout.js, ko-custom-binding

淘汰赛自定义绑定如何与 observableArray 一起使用？当使用带有自定义绑定的 ko.observable() 时，一切都按预期工作。使用 ko.observableArray() 时，只会抛出初始事件（init 和 update 一次），但不会检测到进一步的更改（参见[Fiddle](http://jsfiddle.net/eVyVn/)或下面的代码）。

```
<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="knockout-2.2.1.js"> </script>
</head>
<body>
    <div data-bind="text: Observable, updateBinding: Observable"></div>
    <div data-bind="foreach: ObservableArray, updateBinding: ObservableArray">
        <span data-bind="text: $data"></span>
    </div>
    <script type="text/javascript"> 
        ko.bindingHandlers['updateBinding'] = {
            init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
                alert("Binding Handler (Init)");
            },
            update: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
                alert("Binding Handler (Update)");
            }
        };

        function ViewModel() {
            var self = this;

            self.ObservableArray = ko.observableArray();
            self.Observable = ko.observable();
        }

        var viewModel = new ViewModel();

        // Fires Init + Update for Observable and ObservableArray
        ko.applyBindings(viewModel);

        // Fires Update for Observable
        viewModel.Observable(1);

        // Does nothing
        viewModel.ObservableArray.push('1');
    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T20:22:33.783

您将希望在自定义绑定中创建对 observableArray 的依赖项。所以，至少是这样的：

```
 ko.bindingHandlers.updateBinding = {
        init: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
            alert("Binding Handler (Init)");
        },
        update: function (element, valueAccessor, allBindingsAccessor, viewModel, bindingContext) {
            //create a dependency, normally you would do something with 'data'
            var data = ko.utils.unwrapObservable(valueAccessor());
            alert("Binding Handler (Update)");
        }
    }; 
```

这适用于您的可观察示例的原因是因为单个元素上的所有绑定都是一起触发的（更多信息[here](http://www.knockmeout.net/2012/06/knockoutjs-performance-gotcha-3-all-bindings.html)）。

这在您的其他绑定上的行为方式不同的原因是`foreach`行为方式不同。对 observableArray 的更改不会`foreach`直接触发绑定（或者整个部分将被重新渲染）。相反，它在单独的 ko.computed 中触发逻辑，该逻辑评估数组如何更改并进行必要的增量更新（添加项目、删除项目等）。

# javascript - 更新后在 Jquerymobile 中刷新 Gridview

> ID：14715725
> 
> 赞同：1
> 
> 时间：2013-02-05T19:49:47.223
> 
> 标签：javascript, jquery, ios, cordova, jquery-mobile

我创建了一个带有网格块的页面，其中包含使用“jquery-mobile”插件的按钮。网格内的按钮是在运行时动态创建的。在回拨电话后，旧值仍然存在。我想在更新后用新值刷新网格。

这是代码。

html:

```
<div id="chapter_div" data-role="page" data-content-theme="a">
    <div data-role="header">
    <h1>Chapter Chooser</h1>
    </div>
    <div data-role="content" class="ui-grid-d" id="show_chapter_number"> 
    </div>                  
</div> 
```

Javascript/Jquery 代码：

```
function showChapter(book_id) {

           var chapter_count=" ";
           var menu = " ";

           var html = " ";
           var row_count = 1;
           var row_block_id = 'a';

           chapter_count = getChapterCount(book_id);

           for (itr = 1; itr <= chapter_count; itr++) {

             switch(row_count) {
                    case 1:
                    row_block_id = 'a';
                    row_count++;
                    break;
                    case 2:
                    row_block_id = 'b';
                    row_count++;
                    break;
                    case 3:
                    row_block_id = 'c';
                    row_count++;
                    break;
                    case 4:
                    row_block_id = 'd';
                    row_count++;
                    break;
                    case 5:
                    row_block_id = 'e';
                    row_count=1;
                    break;

                }

                html += "<div class=\"ui-block-"+row_block_id+"\"><button onclick=\"javascript:showVerse(" + book_id + ",\'" + itr + "\');\" class=\"ui-bar ui-bar-c\" style=\"width:70px\">" + itr + "</button></div>";

            }               

            var grid_chapter = $('#show_chapter_number');

            grid_chapter.append(html);

            $.mobile.changePage("#chapter_div", {transition: 'pop', role: 'dialog'});              

            **grid_chapter.content("refresh");**

        } 
```

回发后，我应该如何刷新网格或内容中的项目？

我应该如何更改这行代码：`grid_chapter.content("refresh");`使其正常工作？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:58:03.150

尝试[`trigger("create")`](http://jquerymobile.com/demos/1.2.0/docs/pages/page-scripting.html)方法：

```
grid_chapter.append(html).trigger("create"); 
```

# oracle - 如何将shell脚本的输入传递给sqlplus？

> ID：14715726
> 
> 赞同：0
> 
> 时间：2013-02-05T19:49:51.350
> 
> 标签：oracle, shell, unix, sqlplus

我被要求将现有 SQLPLUS 脚本的一部分更改为 shell 脚本以允许更多选项。

这是原始 SQLPLUS 脚本提示的内容：

```
SPOOL results.txt;
WHENEVER OSERROR EXIT 9;
WHENEVER SQLERROR EXIT SQL.SQLCODE;
PROMPT
PROMPT This script upgrades the database to the most recent version of eV8.0.
SET VERIFY OFF;
SET SERVEROUTPUT ON;

ACCEPT continue_flag CHAR PROMPT 'Are You ready to continue Y/N? '
PROMPT 
```

我的 shell 脚本现在看起来像：

```
 #!/bin/sh

echo "Please enter database username"
read eval_user
echo "Please enter database password"
read eval_pass
echo "Please enter the database name"
read db_name

$ORACLE_HOME/bin/sqlplus -s /nolog <<-EOF >> ${LOGFILE}
connect $eval_user/$eval_pass@$db_name

set serveroutput on format wrapped
set pages 0 lines 300 trimout on trimspool on
set echo off feedback off sqlprompt ''

SPOOL results.txt;
WHENEVER OSERROR EXIT 9;
WHENEVER SQLERROR EXIT SQL.SQLCODE;
PROMPT
SET VERIFY OFF;
SET SERVEROUTPUT ON;

ACCEPT continue_flag CHAR PROMPT 'Are You ready to continue Y/N? '
PROMPT 
```

到达 SQLPLUS 提示行时出现此错误：

```
Are You ready to continue Y/N? You have entered an invalid response. Exiting.
BEGIN
*
ERROR at line 1:
ORA-06501: PL/SQL: program error
ORA-06512: at line 13 
```

我是 sqlplus 的新手，所以我知道这与我一开始设置的设置有关，如果我设置 echo off feedback off sqlprompt ''。但是，在删除该行时，脚本只是挂起。

我应该完全从 SQLPLUS 中取出提示并仅在 shell 部分中使用它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:34:45.250

最简单的方法是保留 sql 脚本的交互。它确实想读一些你目前没有给它的东西。这里的文档是传递变量的好方法。不要忘记它对 shell 特殊字符的影响......与往常一样，还有更多方法可以做到这一点。

但是，是的，您的问题的答案是：是的，取出交互并在调用 shell 中准备决策。

# mysql - Rails 查询变为空，但如果在 sql 控制台中搜索，相同的查询会检索记录

> ID：14715727
> 
> 赞同：1
> 
> 时间：2013-02-05T19:49:53.513
> 
> 标签：mysql, sql, ruby-on-rails, ruby, sequel

在创建范围以返回所有生日在两天之间的用户以及其他一些条件后，我遇到了一个问题。此信息应该呈现给用户仪表板。

如果我刷新页面，则找到 0 条记录。如果我在 Rails 开发环境控制台中运行范围，它也会返回 0 条记录。但是，如果我在活动记录器打开时从控制台复制查询，并将其直接放入我的 SQL 客户端，它会返回正确的记录。此范围也与其他一些范围链接，但如果我要从查询链中删除此范围，则查询有效，它只是不会像我希望此范围那样过滤出生日期范围。

SQL 客户端在同一个数据库上。

范围：

```
where(
  "(date_of_birth <= ?) OR DATE_ADD(date_of_birth, INTERVAL ? YEAR) BETWEEN ? AND ?", 
  min_age.years.ago.to_date, 
  min_age, 
  beginning_of_month, 
  end_of_month
) 
```

查询：

```
SELECT `drivers`.* FROM `drivers` WHERE ( (date_of_birth <=
'1990-02-05') OR DATE_ADD(date_of_birth, INTERVAL 23 YEAR) BETWEEN
'2013-04-01' AND '2013-04-30') AND (drivers.id NOT IN (SELECT
driver_id from follow_ups where team_id = 2)) AND
(average_miles_per_day >= 0.35) AND (travel_time < 2000) AND
(travel_time + (average_miles_per_day * 84) >= 2000) 
```

任何时候 Rails 试图执行这个查询它都不起作用。在 SQL 客户端中执行此查询时，它就像一个魅力。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:27:06.880

也许......字符串到日期的转换存在问题。尝试使用 STR_TO_DATE() 函数在您的模型中进行转换。请在每个日期都这样做......让我知道它有帮助。

# python - 如何确定 wx GLCanvas 的最大允许 WX_GL_DEPTH_SIZE？

> ID：14715739
> 
> 赞同：1
> 
> 时间：2013-02-05T19:50:32.170
> 
> 标签：python, wxpython, pyopengl

我正在`wx.Frame`用`GLCanvas`. 在某些平台上，将`WX_GL_DEPTH_SIZE`画布的属性设置为 32 可以正常工作。在另一个平台上，除非我将深度大小减小到 16，否则我只会得到一个空白帧（`GLCanvas`不渲染）。调用代码中是否有一种简单的方法来确定深度大小的允许值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T02:02:29.573

你在运行 Linux 吗？也许您可以从输出的显示模式表中获取该信息`glxinfo -t`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T09:40:32.383

我发现的唯一解决方案是使用 GLCanvas 方法[`IsDiplaySupported`](http://wxpython.org/Phoenix/docs/html/glcanvas.GLCanvas.html)，但似乎这种方法在 wxPython 2.9 中可用，而不是旧版本。

# vba - Excel VBA 宏 - 提示列描述断言范围

> ID：14715740
> 
> 赞同：1
> 
> 时间：2013-02-05T19:50:32.700
> 
> 标签：vba, excel

我一直在寻找这个问题的答案：

使用下面的代码，我想在每组唯一值的末尾输入一个空行。最重要的是，我希望它有一个提示，允许用户键入列范围的字母。我已经尝试了其中的一些，无法用查询答案替换“B”。

```
Dim lRow As Long
For lRow = Cells(Cells.Rows.Count, "B").End(xlUp).Row To 2 Step -1
If Cells(lRow, "B") <> Cells(lRow - 1, "B") Then Rows(lRow).EntireRow.Insert
Next lRow
End Sub 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T01:15:27.793

尝试这个

```
Sub Demo()
    Dim lRow As Long
    Dim sCol As String
    sCol = InputBox("Enter Column", sCol)
    For lRow = Cells(Cells.Rows.Count, sCol).End(xlUp).Row To 2 Step -1
        If Cells(lRow, sCol) <> Cells(lRow - 1, sCol) Then
            Rows(lRow).Insert
        End If
    Next lRow
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T06:01:11.107

我想您的问题是，您希望用户能够输入“B”、“AA”、“C”作为列？

部分复制@Chris 的代码

```
Sub Demo()
    Dim lRow As Long
    Dim sCol As String
    Dim colNum as string
    sCol = InputBox("Enter Column", sCol)
    colNum  = columns(sCol).column
    For lRow = Cells(Cells.Rows.Count, colNum  ).End(xlUp).Row To 2 Step -1
        If Cells(lRow, colNum  ) <> Cells(lRow - 1, colNum  ) Then
            Rows(lRow).Insert
        End If
    Next lRow
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:58:55.150

尝试`Range("B" & Cells.Rows.Count)`代替，`Cells(Cells.Rows.Count, "B")`其余的也类似。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-06T18:43:04.530

包括打开提示，这就是我最终使用的。
将打开提示连接到一个按钮，以使非技术人员更容易使用：

```
Sub InsertRowAtChangeInValue()

    Dim customerBook As Workbook
    Dim filter As String
    Dim caption As String
    Dim customerFilename As String
    Dim customerWorkbook As Workbook
    Dim targetWorkbook As Workbook

    Set targetWorkbook = Application.ActiveWorkbook

    filter = "Excel 2007 files (*.xlsx),*.xlsx, Excel 97-03 files (*.xls),*xls, All files (*.*),*.*"
    caption = "Please select an input file."
    customerFilename = Application.GetOpenFilename(filter, , caption)

    Set customerWorkbook = Application.Workbooks.Open(customerFilename)

    Dim targetSheet As Worksheet
    Set targetSheet = targetWorkbook.Worksheets(1)
    Dim sourceSheet As Worksheet
    Set sourceSheet = customerWorkbook.Worksheets(1)

    targetSheet.Range("A1", "AR5000").Value = sourceSheet.Range("A1", "AR5000").Value

    Dim lRow As Long
    Dim sCol As String
    Dim colNum As String
    sCol = InputBox("Enter Column", sCol)
    colNum = Columns(sCol).Column
    For lRow = Cells(Cells.Rows.Count, sCol).End(xlUp).Row To 2 Step -1
        If Cells(lRow, sCol) <> Cells(lRow - 1, sCol) Then
            Rows(lRow).Insert
        End If
    Next lRow
End Sub 
```

再次感谢您的帮助！

# clearcase - 基本 ClearCase：*/... 和之间的差异

> ID：14715747
> 
> 赞同：2
> 
> 时间：2013-02-05T19:51:00.023
> 
> 标签：clearcase

我正在使用基本 ClearCase 并且有一个配置规范问题。请考虑以下两条规则（我只会将其中一条放在我的配置规范中）：

# 1

```
element /cl5_sw_ste/DCT/*/... /main/0 -mkbranch rel_drop5 
```

# 2

```
element /cl5_sw_ste/DCT/... /main/0 -mkbranch rel_drop5 
```

它们之间有什么区别？

谢谢，戴夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:19:34.183

（来自[`config spec`手册页](http://publib.boulder.ibm.com/infocenter/cchelp/v7r0m0/index.jsp?topic=/com.ibm.rational.clearcase.cc_ref.doc/topics/config_spec.htm)）

选择规则形成为`scope / pattern / version-selector`。
不同之处在于**模式**：

```
element /cl5_sw_ste/DCT/*/... /main/0 -mkbranch rel_drop5 
```

表示选择规则将适用于`DCT`.

您可以将其重写为：

```
element /cl5_sw_ste/DCT/* /main/0 -mkbranch rel_drop5 
```

（你不需要 final `/...`，但在这两种情况下，版本选择器都不关心 DCT 本身`/main/0 -mkbranch rel_drop5`：这很糟糕，因为你直接在下面添加或删除的任何元素`DCT`都会为自己创建一个新版本`DCT`，它不会在`rel_drop5`)

```
element /cl5_sw_ste/DCT/... /main/0 -mkbranch rel_drop5 
```

Means the selection rules will apply to `DCT` *and* all the directories under `DCT`.
That is usually what you see when working with branches.

# java - 重定向 System.out 和 System.err

> ID：14715748
> 
> 赞同：14
> 
> 时间：2013-02-05T19:51:01.900
> 
> 标签：java, logging, log4j

我有一些遗留代码（或者更确切地说是一些我们无法控制但我们必须使用的代码）将大量语句写入 system.out/err。

同时，我们正在使用一个框架，该框架使用一个围绕 log4j 的自定义日志系统（再次遗憾的是，我们无法控制它）。

因此，我试图将输出和错误流重定向到将使用日志记录系统的自定义 PrintStream。我正在阅读`System.setLog()`and`System.setErr()`方法，但问题是我需要编写自己的 PrintStream 类来包装正在使用的日志系统。那将是一个巨大的头痛。

有没有一种简单的方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-11T17:00:33.647

只是为了添加 Rick 和 Mikhail 的解决方案，这实际上是这种情况下的唯一选择，我想举一个例子来说明创建自定义 OutputStream 可能会导致不太容易检测/修复问题。这是一些代码：

```
import java.io.IOException;
import java.io.OutputStream;
import java.io.PrintStream;
import org.apache.log4j.Logger;

public class RecursiveLogging {
  /**
   * log4j.properties file:
   * 
   * log4j.rootLogger=DEBUG, A1
   * log4j.appender.A1=org.apache.log4j.ConsoleAppender
   * log4j.appender.A1.layout=org.apache.log4j.PatternLayout
   * log4j.appender.A1.layout.ConversionPattern=%-4r [%t] %-5p %c %x - %m%n
   * 
   */
  public static void main(String[] args) {
    // Logger.getLogger(RecursiveLogging.class).info("This initializes log4j!");
    System.setOut(new PrintStream(new CustomOutputStream()));
    System.out.println("This message causes a stack overflow exception!");
  }
}

class CustomOutputStream extends OutputStream {
  @Override
  public final void write(int b) throws IOException {
    // the correct way of doing this would be using a buffer
    // to store characters until a newline is encountered,
    // this implementation is for illustration only
    Logger.getLogger(CustomOutputStream.class).info((char) b);
  }
} 
```

This example shows the pitfalls of using a custom output stream. For simplicity the write() function uses a log4j logger, but this can be replaced with any custom logging facility (such as the one in my scenario). The main function creates a PrintStream that wraps a CustomOutputStream and set the output stream to point to it. Then it executes a System.out.println() statement. This statement is redirected to the CustomOutputStream which redirects it to a logger. Unfortunately, since the logger is lazy initialized, it will acquire a copy of the console output stream (as per the log4j configuration file which defines a ConsoleAppender) too late, i.e., the output stream will point to the CustomOutputStream we just created causing a redirection loop and thus a StackOverflowError at runtime.

Now, with log4j this is easy to fix: we just need to initialize the log4j framework *before* we call System.setOut(), e.g., by uncommenting the first line of the main function. Luckily for me, the custom logging facility I have to deal with is just a wrapper around log4j and I know it will get initialized before it's too late. However, in the case of a totally custom logging facility that uses System.out/err under the cover, unless the source code is accessible, it's impossible to tell if and where direct calls to System.out/err are performed instead of calls to a PrintStream reference acquired during initialization. The only work around I can think of for this particular case would be to retrieve the function call stack and detect redirection loops, since the write() functions should not be recursive.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-05T20:18:14.600

您不需要环绕您正在使用的自定义日志记录系统。当应用程序初始化时，只需创建一个 LoggingOutputStream 并在 System.setOut() 和 System.setErr() 方法上设置该流，并为其设置所需的日志记录级别。从那时起，应用程序中遇到的任何 System.out 语句都应该直接进入日志。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-05T20:21:55.267

看看[PrintStream](http://docs.oracle.com/javase/7/docs/api/java/io/PrintStream.html)提供的构造函数。您可以将日志框架 OutputStream 直接传递给 PrintStream，然后设置 System.out 和 System.err 以使用 PrintStream。

编辑：这是一个简单的测试用例：

```
public class StreamTest
{
    public static class MyOutputStream extends FilterOutputStream
    {
        public MyOutputStream(OutputStream out)
        {
            super(out);
        }

        @Override
        public void write(byte[] b, int off, int len) throws IOException
        {
            byte[] text = "MyOutputStream called: ".getBytes();         
            super.write(text, 0, text.length);
            super.write(b, off, len);
        }
    }

    @Test   
    public void test()
    {       
        //Any OutputStream-implementation will do for PrintStream, probably
        //you'll want to use the one from the logging framework
        PrintStream outStream = new PrintStream(new MyOutputStream(System.out), true);  //Direct to MyOutputStream, autoflush
        System.setOut(outStream); 

        System.out.println("");
        System.out.print("TEST");
        System.out.println("Another test");
    }
} 
```

输出是：

```
MyOutputStream called: 
MyOutputStream called: TESTMyOutputStream called: Another testMyOutputStream called: 
```

> 第二行有一个“空”调用（*MyOutputStream 调用：* -output 之后什么都没有），因为 println 将首先将 *Another test* -string 传递给 write-method，然后使用换行符再次调用它。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-05T20:17:55.103

只需编写自己的 OutputStream，然后将其包装到标准 PrintStream 中。OutputStream 只有一个必须实现的方法，另一个出于性能原因值得重写。

唯一的技巧是将字节流分割成单独的日志消息，例如通过'\n'，但这也不太难实现。

# python - Django 数据库关系——多对多、多对一

> ID：14715758
> 
> 赞同：0
> 
> 时间：2013-02-05T19:51:24.730
> 
> 标签：python, django

我似乎无法在概念上区分 django 中的多对一和多对多关系。我了解它们在 SQL 和数据库中的工作方式，并牢记外键等概念，但例如我不明白以下内容：

多对多关系的两端都可以自动访问另一端的 API。API 就像“向后”的一对多关系一样工作。但是，我仍然无法从概念上看到它。

多对一示例：

```
class Reporter(models.Model):
    first_name = models.CharField(max_length=30)
    last_name = models.CharField(max_length=30)
    email = models.EmailField()

    def __unicode__(self):
        return u"%s %s" % (self.first_name, self.last_name)

class Article(models.Model):
    headline = models.CharField(max_length=100)
    pub_date = models.DateField()
    reporter = models.ForeignKey(Reporter)

    def __unicode__(self):
        return self.headline

    class Meta:
        ordering = (’headline’,) 
```

我可以这样做：

```
>>> r = Reporter(first_name=’John’, last_name=’Smith’, email=’john@example.com’)
>>> r.save()
>>> a = Article(id=None, headline="This is a test", pub_date=datetime(2005, 7, 27), reporter=r)
>>> a.save()
>>> a.reporter
<Reporter: John Smith> 
```

所以，我可以通过外键从 Articles 类进入 Reporters 类。

多对多示例：

```
class Publication(models.Model):
    title = models.CharField(max_length=30)

    def __unicode__(self):
        return self.title

    class Meta:
        ordering = (’title’,)

class Article(models.Model):
    headline = models.CharField(max_length=100)
    publications = models.ManyToManyField(Publication)

    def __unicode__(self):
        return self.headline

    class Meta:
        ordering = (’headline’,) 
```

我的问题是 - 我可以通过 Article 类的 ManyToManyField 进入 Publication 类，就像我在上面的多对一类中所做的一样。那么 M2M 与 M2one 有何不同？我可以用 m2m 做的其他事情是什么。（我当然可以对两者进行反向，但我暂时试图忽略两者的反向关系，以免进一步混淆自己。）所以为了更好地表达我的问题，一个人通常对 m2m 还能做什么，而一个人通常不会与 m2one？

免责声明 - 编程新手，但阅读了 django 官方文档模型的整个 100 页部分，所以如果可以的话，请不要向我推荐它们。我已经在向他们学习了。

我也可以更好地理解代码，所以如果可以的话，请提供一些代码示例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:00:24.060

> **一个**记者可以有**很多**篇文章，但一篇文章只有**一个** 记者。

```
# This will get the reporter of an article
article.reporter
# This will get all the articles of a reporter
reporter.article_set.all()
# You cannot add another reporter to an article
article.reporter.add(r) # This will raise an Error! 
```

另一方面，

> **一篇**文章可能有**许多**出版物，而一篇文章可能与**许多**文章相关。

```
# This will get all the publications of an article
article.publications.all()
# This will get all the related articles of a publication
publication.article_set.all()
# You CAN add another publication to an article
article.publications.add(p) # No Error here 
```

# grails - Grails“未找到数据源名称且未指定默认驱动程序”错误

> ID：14715761
> 
> 赞同：1
> 
> 时间：2013-02-05T19:51:29.487
> 
> 标签：grails, jdbc

我正在构建一个将连接到 Sybase SQL Anywhere 数据库的 Grails 应用程序，但我收到了一个非常令人沮丧的错误消息：

```
URI: /Booklist/user/authenticate
Class: java.sql.SQLException
Message: [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified` 
```

我正在使用的不起作用的代码是：

`def sql = Sql.newInstance("jdbc:ianywhere://localhost:1234/dbName", "user", "password", "ianywhere.ml.jdbcodbc.jdbc3.IDriver")`

我的堆栈跟踪是：

```
Line | Method
->>  490 | connect       in ianywhere.ml.jdbcodbc.jdbc3.IDriver
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
|    579 | getConnection in java.sql.DriverManager
|    221 | getConnection in     ''
|     16 | getBooks      in Book.groovy
|     11 | authenticate  in UserController.groovy
|    195 | doFilter      in PageFragmentCachingFilter.java
|     63 | doFilter . .  in AbstractFilter.java
|   1110 | runWorker     in java.util.concurrent.ThreadPoolExecutor
|    603 | run . . . . . in java.util.concurrent.ThreadPoolExecutor$Worker
^    722 | run           in java.lang.Thread 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:54:53.620

我强烈建议您遵循 Grails 最佳实践并在`DataSource.groovy`配置文件中设置数据源：http: [//grails.org/doc/2.2.x/guide/conf.html#dataSource](http://grails.org/doc/2.2.x/guide/conf.html#dataSource)而不是滚动 JDBC 样式的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T15:11:24.210

如果您将 jar 文件放在 lib 目录中，它不会自动添加到类路径中。运行`grails compile --refresh-dependencies`以获取 Grails 以查看并添加它。最好在其中注册依赖项，`BuildConfig.groovy`以便让 Ivy 下载 jar 一次并缓存并重新使用它。

# twitter - Twitter API OAuth 无法获取访问令牌

> ID：14715767
> 
> 赞同：1
> 
> 时间：2013-02-05T19:51:40.573
> 
> 标签：twitter, twitter-oauth

我刚刚遇到这个突然停止工作的问题，我在我的节点中使用 Twitter API 并执行 OAuth 登录流程，自从我开始这个项目以来它一直在工作，它今天奇怪地停止工作，下面丢失的显示了我尝试过的内容全部失败：

1.  我在 twitter 的开发者网站上读到的限制是每个用户每 15 分钟调用 15 次，我在再次登录前等了 15 分钟，没有工作
2.  创建了新应用程序，更改了 consumerkey 和 consumerSecret，不起作用
3.  尝试了另一个推特帐户，无法正常工作
4.  尝试了另一个IP，无法正常工作

当我尝试跟踪错误时出现错误消息：

`Error getting OAuth access token : { statusCode: 401, data: ' ' }[undefined][und efined][undefined] 500`

但是，当我使用与该项目相同的应用程序、共享相同 IP 和相同代码的 twitter 登录运行我的另一个项目时，它出乎意料地工作。

那么为什么只是这个项目不起作用，我已经没有想法了。如果有人遇到过同样的问题，请分享！谢谢。

# mysql - SQL/MySQL：从具有 3 列的表中检索活动文章（旧 | 新 | 日期）

> ID：14715773
> 
> 赞同：2
> 
> 时间：2013-02-05T19:51:59.283
> 
> 标签：mysql, sql, date

我正在尝试从以下示例表中检索活动文章：

```
Example Table       
Old Article | New Article| Substitution Date
A             B            01-01-2012
B             C            01-02-2012
C             B            01-03-2012
C             A            01-04-2012

 Desired Output     
Old Article | New Article   
B             A 
C             A 
```

在 mysql/sql 中可以吗？在此先感谢，因为我已经为此苦苦挣扎了一段时间。

（注：实际表有超过 200k 行）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:57:49.800

你最好有另一个表来保存“当前”文章的列表。每当您替换一篇文章时，更新当前表，同时更新这个新表，其中包含所有被替换文章的映射。新表的架构与您当前的表相同。当您进行替换时，您将：update [table_name] set new_article = [newest article]，substitution_date=[now] where new_article = [article being被替换]。

# iphone - CATransition 和具体执行时间

> ID：14715774
> 
> 赞同：0
> 
> 时间：2013-02-05T19:52:06.443
> 
> 标签：iphone, ios, objective-c, quartz-core, catransition

查看此示例代码（在 AppDelegate 中）：

```
- (void)showOtherView {
if (self.viewController.view == view1) {
    self.viewController.view = view2;
} else {
    self.viewController.view = view1;
}
CATransition *animation = [CATransition animation];
[animation setType:kCATransitionMoveIn];
[animation setSubtype:kCATransitionFromRight];
[animation setDuration:0.5];
[animation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]];
[[self.window layer] addAnimation:animation forKey:@"myKey"]; 
```

}

此方法只是将**view1**切换到**view2**。我不明白的是，**CATransition在将****view2**分配给self.viewController.view**之后**被声明并添加到**window.layer**。为什么动画有效？

 ****我确实设置了断点并发现在 showOtherView 方法完成后切换动画。为什么？只是为什么**view2**没有立即出现在屏幕上！？（至少我第一次调用这个方法）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:12:32.640

绘制到屏幕是一项昂贵的操作，而[Cocoa 每次运行循环](http://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CocoaViewsGuide/SubclassingNSView/SubclassingNSView.html#//apple_ref/doc/uid/TP40002978-CH7-SW22)最后只执行一次。设置控制器视图的效果——它被放到屏幕上——直到这个方法返回并且控制传递到运行循环之后才真正发生。因此，您对新视图所做的任何配置都将始终显示。****

# java - Android 应用程序：按钮计数变量向上或向下

> ID：14715775
> 
> 赞同：0
> 
> 时间：2013-02-05T19:52:08.957
> 
> 标签：java, android, button

我正在尝试显示一个变量，用户应该能够使用 2 个按钮向上和向下计数。这是我的代码。问题是它似乎不起作用。如果您点击“minues”，则会出现“1”，如果您点击“plus”，则不会发生任何事情。非常感谢！

我知道 switch 可能不是最优雅的解决方案，但我仍然想尝试一下

```
public class StoryCreator extends Activity implements OnClickListener {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_story_creator);

    Button b1 = (Button) findViewById(R.id.minus);   
    b1.setOnClickListener(this);

    Button b2 = (Button) findViewById(R.id.plus);   
    b2.setOnClickListener(this);

}

    public void onClick(View v) {

        int Zahl = 1;    

        TextView objekt = (TextView) findViewById(R.id.textView1);  
        objekt.setText("0");

       // Perform action on click
          switch(v.getId())
          {

             case 1: 
                                    Zahl = Zahl-1;
                                    break;
             case 2:
                                    Zahl = Zahl+1;
                                    break;
             default:           
                                    break;
         }

            switch(Zahl) {
            case -1: 
                objekt.setText("-1");
                break;
            case 0: 
                objekt.setText("0");
                break;
            case 1:
                objekt.setText("1");
                break;              
            case 2:
                objekt.setText("2");
                break;      
            case 3:
                objekt.setText("3");
                break;      

            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T19:55:17.030

将您的开关盒更改为：

```
 // Perform action on click
      switch(v.getId())
      {

         case R.id.minus: 
             Zahl = Zahl-1;
              break;
         case R.id.plus:
             Zahl = Zahl+1;
             break;
         default:           
             break;
     } 
```

使用 Button id 而不是 1,2 根据 Button click 执行操作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T10:52:56.977

抱歉，它有点乱，但这应该完全符合您的要求。

```
public class CountUpAction extends AbstractAction {
      /** Constructor */
      public CountUpAction(String name, String shortDesc, Integer mnemonic) {
         super(name);
         putValue(SHORT_DESCRIPTION, shortDesc);
         putValue(MNEMONIC_KEY, KeyEvent.VK_NUMPAD4);
      }

      @Override
      public void actionPerformed(ActionEvent e) {
          addKeyListener(new KeyAdapter() {
                public void keyPressed(KeyEvent evt) {
                    switch(evt.getKeyCode()) {
                    case KeyEvent.VK_NUMPAD1:

            //original count
            count += 1;
            tfCount.setText(count + "");

                    }
                }
              });
      }
   }

   public class CountDownAction extends AbstractAction {
      /** Constructor */
      public CountDownAction(String name, String shortDesc, Integer mnemonic) {
         super(name);
         putValue(SHORT_DESCRIPTION, shortDesc);
         putValue(MNEMONIC_KEY, KeyEvent.VK_NUMPAD5);
      }

      @Override
      public void actionPerformed(ActionEvent e) {
          addKeyListener(new KeyAdapter() {
            public void keyPressed(KeyEvent evt) {
                switch(evt.getKeyCode()) {
                case KeyEvent.VK_NUMPAD2:

          //original count
          count -= 1;
          tfCount.setText(count + "");

                }
            }
          });
      }
 Action countUpAction = new CountUpAction("Count Up",
            "", new Integer(KeyEvent.VK_ENTER));
      Action countDownAction = new CountDownAction("Count Down",
            "", new Integer(KeyEvent.VK_D));

  tfCount = new JTextField("0", 8);
      tfCount.setHorizontalAlignment(JTextField.CENTER);
      tfCount.setEditable(false);
      tfCount.setSize(100, 20);
      canvas.add(tfCount, BorderLayout.LINE_START);

  //Invisible
      JButton btnCountUp = new JButton();
      btnCountUp.setFocusable(false);
      btnCountUp.setHideActionText(true);
      btnCountUp.setContentAreaFilled(false);
      btnCountUp.setBorderPainted(false);
      canvas.add(btnCountUp, BorderLayout.NORTH);
      //Invisible
      JButton btnCountDown = new JButton();
      btnCountDown.setFocusable(false);
      btnCountDown.setHideActionText(true);
      btnCountDown.setContentAreaFilled(false);
      btnCountDown.setBorderPainted(false);

      canvas.add(btnCountDown);
      // Set actions for buttons
      btnCountUp.setAction(countUpAction);
      btnCountDown.setAction(countDownAction); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T20:08:56.333

好吧，您的代码中有很多问题：

*   您使用错误的方式来引用按钮
*   您没有正确存储以前的值
*   您没有正确增加先前的值
*   ETC。 ：）

试试这个代码：

```
public class StoryCreator extends Activity implements OnClickListener {

    TextView textView;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_story_creator);

        Button b1 = (Button) findViewById(R.id.minus);   
        b1.setOnClickListener(this);

        Button b2 = (Button) findViewById(R.id.plus);   
        b2.setOnClickListener(this);

        textView = (TextView) findViewById(R.id.textView1);
        textView.setText("0"); //initial value

    }

    public void onClick(View v) {

        int Zahl = Integer.parseInt(textView.getText().toString());    

       // Perform action on click
          switch(v.getId())
          {

             case R.id.plus: 
                                    Zahl++;
                                    break;
             case R.id.minus:
                                    Zahl--;
                                    break;
             default:           
                                    break;
         }

         textView.setText(String.valueOf(Zahl));
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T20:03:14.417

你也设置

```
 int Zahl = 1; 
```

每次点击按钮时，Zahl 的值可能只有 0 或 1

```
public class StoryCreator extends Activity implements OnClickListener {

int mValue = 0;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_story_creator);

    Button b1 = (Button) findViewById(R.id.minus);   
    b1.setOnClickListener(this);

    Button b2 = (Button) findViewById(R.id.plus);   
    b2.setOnClickListener(this);

}

    public void onClick(View v) {

        TextView objekt = (TextView) findViewById(R.id.textView1);  

       // Perform action on click
          switch(v.getId())
          {

             case R.id.plus: 
                                    mValue++;
                                    break;
             case R.id.minus:
                                    mValue--;
                                    break;
             default:           
                                    break;
         }

          objekt.setText(mValue);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-05T20:20:40.060

更简洁的方法是删除“implements View.OnClickListener”并为每个按钮创建单击侦听器。

此外，上述解决方案实际上仍然没有增加单个变量。如果您希望增量在实例之间保持不变，则需要将其转换为静态。

以下将为您提供所需的内容，并且干净利落地执行此操作，而不会使用 View.OnClickListener 污染您的活动。

```
public class StoryCreator extends Activity {
    TextView textView;
    private static int zahl = 0;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_story_creator);

        Button minus = (Button) findViewById(R.id.minus);   
        minus.setOnClickListener(minusClickListener);

        Button plus = (Button) findViewById(R.id.plus);   
        plus.setOnClickListener(plusClickListener);

        textView = (TextView) findViewById(R.id.textView1);
        textView.setText("0"); //initial value

    }

    private View.OnClickListener minusClickListener= new View.OnClickListener() {
        public void onClick(View v) {
              zahl--;
        }
    } 

    private View.OnClickListener plusClickListener = new View.OnClickListener() {
        public void onClick(View v) {
             zahl++;
        }
    } 
```

# css - 标题中的导航块但在页脚中编码

> ID：14715776
> 
> 赞同：0
> 
> 时间：2013-02-05T19:52:19.890
> 
> 标签：css, navigation

您好，我真的很难处理我的导航区域。主题设计师将它放在页脚中，但它显示在顶部，这导致我年轻的 CSS 头脑精神崩溃。我只有在事情真的压在我头上时才征求意见。

你可以在这里查看页面- [我的网站](http://onlinebanter.com)

#navigation 在左上角是黄色的。

```
 <?php if (!empty($primary_links) || !empty($secondary_links)): ?>
      <div id="navigation" class="menu <?php if (!empty($primary_links)) { print "with-main-menu"; } if (!empty($secondary_links)) { print " with-sub-menu"; } ?>">
        <?php if (!empty($primary_links)){ print theme('links', $primary_links, array('id' => 'primary', 'class' => 'links main-menu')); } ?>
        <?php if (!empty($secondary_links)){ print theme('links', $secondary_links, array('id' => 'secondary', 'class' => 'links sub-menu')); } ?>
      <span class="test">efeeffefefefe</span></div> <!-- /navigation -->
    <?php endif; ?> 
```

和.....

```
 #navigation {
 background: none repeat scroll 0 0 yellow;
float: left;
height: 65px;
margin-left: 0;
margin-right: -100%;
padding: 0;
width: 75%; 
```

}

```
.with-navigation #content,
.with-navigation .sidebar {
  margin-top: 65px; 
```

}

随主题而来。导航的原始代码是……实际上，如果您需要知道该错误发布它。我在您可以在代码中看到的跨度中添加了绿色框#test。arrrghhhhh我放弃了。对不起。我实际上想要黄色导航左侧的绿色框，但它会抛出所有侧边栏。我现在就让它保持原样，但原始的 css 代码是 -

```
 #navigation {
  float: left;
  margin-left: 0;
  margin-right: -100%;
  padding: 0;
  width: 100%;
  height: 40px; 
```

}

```
.with-navigation #content,
.with-navigation .sidebar {
  margin-top: 40px; 
```

}

我什么都试过了。昨天14点，今天2点。谁能告诉我如何在此导航栏的左侧添加一个简单的徽标？我束手无策。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:09:41.450

对于`.test`，**删除：**

```
right: 59px;
top: 23px; 
```

**改变：**

```
float:right; 
```

至

```
float:left; 
```

对于`#navigation` **删除：**

```
margin-right:-100%; 
```

**改变：**

```
float:left; 
```

至

```
float:right; 
```

这将留下一点覆盖，您可以根据需要使用两个元素的宽度进行修复。

# javascript - 使用 javascript/jquery 下载文件

> ID：14715778
> 
> 赞同：1
> 
> 时间：2013-02-05T19:52:23.930
> 
> 标签：javascript, web-applications, download

我正在尝试使用平板电脑从我的 webapp 下载 apk 文件。

```
<a href="#" data-role="button" id="loginButton" class="pulsantino">Login</a>

$("#pulsanteLogin").live("click",function(){
     alert("1");
     window.location.href = 'http://xx.yy.zz.www:1234/staticResources/Myapp_version.apk';
     alert("2");
} 
```

我确定 url 是正确的（从浏览器启动它会正确开始文件下载），但是当我点击按钮时，我没有收到错误，也没有文件下载。我收到了“1”和“2”的警报。

我也试过

```
location.href = 'url'; 
```

和

```
window.location = 'url'; 
```

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:58:34.497

也许这太明显了，但你为什么不直接使用这样的常规链接：

```
<a href="http://xx.yy.zz.www:1234/staticResources/Myapp_version.apk" data-role="button" id="loginButton" class="pulsantino">Login</a> 
```

您是否正在执行更多需要动态更改此链接`href`属性的代码？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:08:48.017

您使用的是比 1.7 更新的 jQuery 版本吗？.live() 已被弃用，而 .on() 现在是要走的路。[http://api.jquery.com/on/](http://api.jquery.com/on/)

> 从 jQuery 1.7 开始，不推荐使用 .live() 方法。使用 .on() 附加事件处理程序。旧版本 jQuery 的用户应该使用 .delegate() 而不是 .live()。来源：[http ://api.jquery.com/live/](http://api.jquery.com/live/)

# c# - 在 C# 中添加命名空间

> ID：14715780
> 
> 赞同：-2
> 
> 时间：2013-02-05T19:52:32.697
> 
> 标签：c#, visual-studio-2012, devexpress

我有 VS2012，通过使用 C# 创建了两个 WPF，并在第一个 WPF 中添加了一个按钮以打开第二个 WPF。但是 VS 找不到窗口（我写了这个：

```
 MainWindow_2 win2 = new MainWindow_2().Show();
 win2.Show(); 
```

它找不到 MainWindow_2)

我试图将命名空间“DXWPFApplication3”添加到另一个窗口。我试过：

```
using DXWPFApplication3; 
```

并给出错误“找不到类型或命名空间名称”

如何添加命名空间？

（在项目文件夹中，这两个 WPF 位于不同的文件夹中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T19:59:16.410

听起来您需要添加对第一个项目的引用。在解决方案资源管理器中打开项目，右键单击引用并单击“添加引用”。在该对话框中，选择项目并添加具有`DXWPFApplication3`命名空间的项目。那应该可以解决问题。

# python - 在 sci-kit tf-idf 中使用特征计数

> ID：14715781
> 
> 赞同：1
> 
> 时间：2013-02-05T19:52:40.850
> 
> 标签：python, numpy, machine-learning, scikit-learn

假设我有一个包含 n 个类别/标签的特征计数列表，例如：

```
feature 1,label1 = 10 # word, label = frequency count
feature 1,label2 = 0
feature 2,label1 = 3
feature 2,label2 = 0 
```

如果是 json，那么“坏”和“好”这两个词会是这样的：

```
{
 "bad": {"pos": 1, "neg": 15, "neu": 2},
 "good": {"pos": 13, "neg": 3, "neu": 2},
} 
```

这是存档的，是从旧应用程序继承的（我无权访问原始文档，长篇大论），但它们是相关的，我想使用它们。这个应用程序是一个情感分类应用程序，它可以获取报纸评论并对其进行分类，这与我想要开发的一样。

那么，我如何将这些计数提供给 Tf-df Vectorizer 或 CountVectorizer*或*将它们与运行矢量化器获得的结果合并，即与下面代码中的 X_train_count 合并：

```
>>> from sklearn.feature_extraction.text import CountVectorizer
>>> count_vect = CountVectorizer()
>>> data_train = {"data": ["ola good", "hey good", "good", "good", "bad", "bad", "bad"], "target":[1,1,1,1,0,0,0]}
>>> X_train_count = count_vect.fit_transform(data_train["data"])
>>> count_vect.get_feature_names()
[u'bad', u'good']
>>> print X_train_count
  (0, 1)        1
  (1, 1)        1
  (2, 1)        1
  (3, 1)        1
  (4, 0)        1
  (5, 0)        1
  (6, 0)        1 
```

谢谢你的帮助！

# c++ - 如何在 C++ 中声明和调用要求输入的函数？

> ID：14715790
> 
> 赞同：-4
> 
> 时间：2013-02-05T19:53:05.323
> 
> 标签：c++, function, printing, input, return

我想知道如何在 main 中声明和调用这个函数：

```
void Part1()
{
int array1[10];
int n;
int i;
for (i=1; i<=10; i++) 
    {
    cout<<"Please enter an entry for position "<< i<<": "<<endl; 
    cin>>n;
    array1[i] = n;
    }
cout<<endl;
i = 0;
for (int i=0; i<10; i++) 
    {
    cout<<array1[i]<<endl; 

    }
return 0;
} 
```

当我尝试运行我的 int main() 时，我什么也没得到。我知道 void 不会返回任何内容，但我认为只需调用该函数（即“Part1”）就可以了。我究竟做错了什么？

编辑：这就是我所说的：

```
int main (){
Part1;

system("PAUSE");
return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:56:14.730

要调用函数，您需要使用括号：`Part1();`. 括号包含将传递给函数的参数，但在您的情况下没有，所以括号为空。

此外，您的第一个`for`循环的索引不正确。你的数组的索引从 0 开始，到 9 结束。你似乎在第二个`for`循环中得到了正确的结果，但在第一个循环中没有。应该是`for (int i=0; i<10; i++)`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T19:56:39.957

为了调用函数，您必须使用函数调用运算符，即`()`.

像这样：

```
int main (){
  Part1();

  system("PAUSE");
  return 0;
} 
```

# python - 如何平均python中的数组数组？

> ID：14715791
> 
> 赞同：6
> 
> 时间：2013-02-05T19:53:07.490
> 
> 标签：python, arrays, numpy, average

我有一个运行多次的模拟。每次生成一个数组时，我都会将其插入到一个更大的数组中，以跟踪所有数据。例如

```
record = []
for i in range(2):
     r = random.random()
     array = numpy.arange(20)*r
     array.shape = (10,2)
     record.append(array)
record = numpy.array(record) 
```

产生：

```
[[[  0\.           0.88765927]
  [  1.77531855   2.66297782]
  [  3.55063709   4.43829637]
  [  5.32595564   6.21361492]
  [  7.10127419   7.98893346]
  [  8.87659274   9.76425201]
  [ 10.65191128  11.53957056]
  [ 12.42722983  13.3148891 ]
  [ 14.20254838  15.09020765]
  [ 15.97786693  16.8655262 ]]

 [[  0\.           0.31394919]
  [  0.62789839   0.94184758]
  [  1.25579677   1.56974596]
  [  1.88369516   2.19764435]
  [  2.51159354   2.82554274]
  [  3.13949193   3.45344112]
  [  3.76739031   4.08133951]
  [  4.3952887    4.70923789]
  [  5.02318709   5.33713628]
  [  5.65108547   5.96503466]]] 
```

因为每个都`array`代表我程序中的一个模拟。我想平均`record`.

基本上我想要一个具有相同尺寸的数组，`array`但它将是所有单独运行的平均值。

我显然可以遍历数组，但是在我的实际模拟中有很多数据，所以我认为按时会非常昂贵

输出示例（显然它不会为零）：

```
average = [[0.0, 0.0]
           [0.0, 0.0]
           [0.0, 0.0]
           [0.0, 0.0]
           [0.0, 0.0]
           [0.0, 0.0]
           [0.0, 0.0]
           [0.0, 0.0]
           [0.0, 0.0]
           [0.0, 0.0]] 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T20:16:25.923

上面示例中的`record`数组是三维的，形状为：

```
>>> record.shape
(2, 10, 2) 
```

第一个维度对应于实验的 2 次迭代。为了平均它们，你需要告诉`np.average`它做它的事情`axis=0`

```
>>> np.average(record, axis=0)
array([[ 0\.        ,  0.45688836],
       [ 0.91377672,  1.37066507],
       [ 1.82755343,  2.28444179],
       [ 2.74133015,  3.19821851],
       [ 3.65510686,  4.11199522],
       [ 4.56888358,  5.02577194],
       [ 5.4826603 ,  5.93954865],
       [ 6.39643701,  6.85332537],
       [ 7.31021373,  7.76710209],
       [ 8.22399044,  8.6808788 ]]) 
```

如果您事先知道要运行多少次模拟，则最好完全跳过列表并执行以下操作：

```
simulations, sim_rows, sim_cols = 1000000, 10, 2
record = np.empty((simulations, sim_rows, sim_cols))
for j in xrange(simulations) :
    record[j] = np.random.rand(sim_rows, sim_cols)

>>> np.average(record, axis=0)
[[ 0.50021935  0.5000554 ]
 [ 0.50019659  0.50009123]
 [ 0.50008591  0.49973058]
 [ 0.49995812  0.49973941]
 [ 0.49998854  0.49989957]
 [ 0.5002542   0.50027464]
 [ 0.49993122  0.49989623]
 [ 0.50024623  0.49981818]
 [ 0.50005848  0.50016798]
 [ 0.49984452  0.49999112]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T19:53:38.237

基本上你可以使用

```
record.mean(axis=0) 
```

我不确定您要在哪个轴上进行平均，因为在您的示例中，两个轴的维度为 2（您的数组的形状为 (2,10,2)）。如果你打算平均最后一个，只需使用

```
record.mean(axis=2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T19:55:59.163

为什么您认为按时会非常昂贵？你仍然需要做同样数量的加法。加法是关联的！

做就是了：

```
averages = [average(subarray) for subarray in bigarray] 
```

# ruby-on-rails-3 - Rails simple_form 分组集合不起作用

> ID：14715792
> 
> 赞同：1
> 
> 时间：2013-02-05T19:53:11.013
> 
> 标签：ruby-on-rails-3

在我的 Rails 应用程序中，我使用的是 simple_form。

我正在尝试使用分组集合选择。

没有 simple_form，这有效：

```
<%= f.label :employee_id, "Lead3:" %>
<%= f.grouped_collection_select :employee_id, Workgroup.order(:id) , :employees, :group, :id, :employee_full_name %> 
```

但是，我的 simple_form 尝试没有 - 下拉列表为空：

```
<%= f.input :employee, collection: @workgroups, as: :grouped_select, group_method: :employees, :label => 'Lead2:' %> 
```

或者

```
 <%= f.association :employee, collection: @workgroups, as: :grouped_select, group_method: :employees, :label => 'Lead2:' %> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T00:19:10.227

我建议`@workgroups`在控制器中检查您的定义。它可能返回`nil`或未指定。根据调用表单的操作，您应该具有以下内容：

```
@workgroups = Workgroup.all(order: id) 
```

# javascript - FB.login 弹出窗口不再适用于 Safari mac？

> ID：14715793
> 
> 赞同：2
> 
> 时间：2013-02-05T19:53:13.607
> 
> 标签：javascript, facebook, facebook-graph-api, safari

其他人不再在 Safari 中看到弹出窗口了吗？

这是一些在 Safari 中不起作用的示例代码。它是通过单击链接启动的，因此弹出窗口阻止程序不应阻止它。任何想法为什么会这样？

这里的在线示例：

[http://users.telenet.be/prullen/fbtest.html](http://users.telenet.be/prullen/fbtest.html)

请注意，这不会出现预期的行为，因为它位于另一个域中并且应用程序 ID 不正确。但是对于这个例子来说唯一重要的是弹出窗口的显示。

```
<script type="text/javascript">
var fbLoaded = false;
var doReLogin = true;

function createAccessToken(){   
if (!fbLoaded) {
    FB.init({
    appId      : 'xxx', // App ID
    status     : true, // check login status
    cookie     : true, // enable cookies to allow the server to access the session
    xfbml      : true  // parse XFBML
    });
}

fbLoaded = true;

FB.getLoginStatus(function(response) {      
    if (response.status === 'connected') {
        getExtendedAccessToken(response.authResponse);
    } else {
        FB.login(function(response) {
            if (response.status == 'connected') {
                if (response.authResponse && response.authResponse.accessToken) {
                    getExtendedAccessToken(response.authResponse);
                } else {
                    alert('You cancelled login or did not fully authorize.');
                }
            } else {
                alert('To use you have to create an access token.');
            }
        }, {scope: 'read_stream'});
    }
 }, true);
}

function getExtendedAccessToken() {
}
</script>

<p style="text-align:center;"><a href="#" onclick="createAccessToken();return false;" class="connect">Connect With FaceBook</a></p> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T09:25:24.090

您可以检查有关阻止弹出窗口的设置吗？这个问题：我猜[Facebook 登录在 Safari/iPhone 中没有打开，和你一样。](https://stackoverflow.com/questions/12493198)

# c# - 如何使用 Linq 和 ASP.Net 表单在多个表之间编写联接

> ID：14715794
> 
> 赞同：1
> 
> 时间：2013-02-05T19:53:14.183
> 
> 标签：c#, asp.net, linq

我已经实现了一个可行的解决方案，但是 LINQ 对我来说很重要，我正在努力寻找所需的信息。

这是我所拥有的：

```
var prodCat = from pc in db.ProductCategories
              where pc.Category == Int32.Parse(CategoriesDropper.SelectedValue)
              select pc;

List<int> productIds = new List<int>();
foreach (var pc in prodCat)
{
    productIds.Add(pc.Product);
}

var products = from p in db.Products
               where productIds.Contains(p.Id)
               select p;

ProductsGridView.DataSource = products;
ProductsGridView.DataBind(); 
```

理想情况下，我希望通过一次选择而不是两次选择来获得相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:00:49.937

```
var products = from pc in db.ProductCategories
               join p in db.Products on pc.Product equals p.Id
               where pc.Category == Int32.Parse(CategoriesDropper.SelectedValue)
               select p;

 ProductsGridView.DataSource = products;
 ProductsGridView.DataBind(); 
```

请参阅[LINQ - Visual Studio 2010 的 C# 中的联接运算符以](http://code.msdn.microsoft.com/LINQ-Join-Operators-dabef4e9)供参考。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T20:01:37.570

您没有提及您使用的是哪种 LINQ，但假设您在 ProductCategories 和 Products 之间设置了关联，您应该能够执行以下操作：

```
int Cat = Int32.Parse(CategoriesDropper.SelectedValue);
var products = from pc in db.ProductCategories
               where pc.Category == cat
               from p in pc.Products
               select p; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T20:06:52.393

```
var selectedCategory = Int32.Parse(CategoriesDropper.SelectedValue); //Parse the value once
var products = 
    from p in db.Products //foreach product in the database
    join pc in db.ProductCategories
    on pc.Product equals p.Id //where the Ids match
    where pc.Category == selectedCategory  //and with the same category
    select p; //select the product
ProductsGridView.DataSource = products;
ProductsGridView.DataBind(); 
```

# css - CSS 菜单背景高度和文本高度

> ID：14715796
> 
> 赞同：1
> 
> 时间：2013-02-05T19:53:18.260
> 
> 标签：css, button, menu, height

我正在尝试在我的菜单项后面使用背景图像和/或颜色。使用图像或仅使用背景颜色，背景将仅与文本的高度匹配。背景的高度需要为 30 像素，文本需要为 16 像素并居中 - 就像普通按钮一样。我已经尝试了所有我能想到的 css 组合，但无法得到我想要的结果。

```
 #menu-container {
    /*float: left;*/
width: 960px;
margin:50px auto 0 auto;
height:50px;
    }

    #menu ul {
text-align: left;
height:50px;
    }

    #menu ul li {
display: inline;
background-image: url(images/menubutton.png);
background-repeat: no-repeat;
    }

     #menu ul li a {
text-transform: uppercase;
padding-right: 13px;
padding-left: 13px;
font-size: 16px;
    /*line-height: 0.2em;*/
color: #000;
font-style: normal;
letter-spacing: 1px;
font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", 
     Helvetica, Arial, "Lucida Grande", sans-serif; 
font-weight: 400;
    }

    #menu ul li a:hover {
color: #ff0000;
text-decoration: none
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:10:18.880

这是您需要的代码：

```
#menu ul li {
    display: inline-block;
    background-color: #a0a0a0; /* I changed this for testing */
    background-repeat: no-repeat;
    padding-top: 7px;
    padding-bottom: 7px;
} 
```

基本上，它曾经`display: inline`阻止您调整高度。你也不能使用`display: block`，因为那样他们就不会都在同一条线上。所以，`display: inline-block`这正是您所需要的。
然后我添加了`padding-top`and `padding-bottom`with `7px`each 以将文本保持在中间。

这是一个有效的[**演示**](http://jsfiddle.net/yentup/d7MJ8/)

希望这有帮助。

# c# - 字符串声明和将字符串设置为空有什么区别？

> ID：14715797
> 
> 赞同：2
> 
> 时间：2013-02-05T19:53:21.563
> 
> 标签：c#

我知道这是一个愚蠢的问题，但仍然想确切地知道这两者之间的区别（我了解字符串 a = "" 和字符串 a = null 的区别）：

```
string a; 
string a = null; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T19:54:41.687

对于局部变量，第一种形式只是*声明*一个变量，第二种是*声明和赋值*。对变量的大多数操作，例如使用输入参数调用方法或从方法返回，都需要对用作参数的变量进行*赋值*。

```
string a;
MethodThatTakesAString(a); // compile time error: use of unassigned local variable 'a' ! 
```

请注意，`out`参数没有该要求，编译器认为`a`在方法调用之后分配：

```
string a;
MethodThatGivesAString(out a); 
```

更多信息可以在[这里](http://msdn.microsoft.com/en-us/library/4y7h161d%28v=vs.80%29.aspx)找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T19:59:06.673

答案取决于所述声明的范围：在本地范围内，第一个变量未赋值，而第二个变量已赋值：

```
void foo() {
    string a;
    if (CheckUserInput()) {
        a = "Bar";
    }
    Console.WriteLine(a); // << Error
} 
```

对比

```
void foo() {
    string a = null;
    if (CheckUserInput()) {
        a = "Bar";
    }
    Console.WriteLine(a); // << Correct
} 
```

在类范围内，没有区别：

```
class X {
    string a;
}

class Y {
    string a = null;
} 
```

在这两种情况下都`a`以`null`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T19:55:18.510

第一行只是声明了一个字符串，但未初始化。如果您尝试使用该字符串，例如：

```
string b = a + " says howdy"; 
```

...你会得到一个编译错误，告诉你你正在尝试使用一个未初始化的变量。

然而，第二行将变量初始化为一个值（null，这实际上是一个表示“无值”的标识符，但方式不同。至少编译器知道你明确地说“嘿，这个变量没有价值”，而不是让它悬而未决。）

# css - 即使页面太小，也可以并排放置 2 个 DIV

> ID：14715801
> 
> 赞同：2
> 
> 时间：2013-02-05T19:53:48.757
> 
> 标签：css, html

嗨，我试图将 2`DIV`并排放置

```
+--------------------------------+ +--------------------------------+
|                                | |                                |
|                                | |                                |
|            400px               | |            355px               |
|                                | |                                |
|                                | |                                |
|                                | |                                |
+--------------------------------+ +--------------------------------+

.header{
    background-image: url('../img/button-bg.png');
    padding: 0px;
    background-repeat: repeat-x;
    height: 36px;
}

.div1
{
    width: 400px;
    float: left;
    margin-right: 10px;
}

.div2
{

    width:355px;
} 
```

我需要两者都`DIV`能够清除标题，所以我不能使用绝对位置

我尝试了 float left 属性，但是当页面太小时，另一个 div 将位于第一个 div 之下。我想知道是否可以这样做。

编辑：当屏幕太小时，我希望出现水平条

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T20:01:22.967

[是的，有可能：](http://jsfiddle.net/szKd4/)

```
<div class="outer">
    <div></div>
    <div></div>
</div> 
```

```
.outer {
    overflow: hidden;
}
.outer div {
    float: left;
    width: 50%;
    height: 100px;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T20:34:50.007

您可以`display:inline-block;`在 div 及`white-space: nowrap;`其父级上使用。

```
.header div{
    display:inline-block;
    vertical-align:top;
}
.header{
    white-space: nowrap;
    background-image: url('../img/button-bg.png');
    padding: 0px;
    background-repeat: repeat-x;
    height: 36px;
}
.div1{
    width: 400px;
    margin-right: 10px;
}    
.div2{
    width:355px;
} 
```

[http://jsfiddle.net/mowglisanu/a6YNY/](http://jsfiddle.net/mowglisanu/a6YNY/)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-02-05T20:06:29.280

如果您不希望您的元素浮动，您应该使用一个表格（或两个并排的跨度）。首先，了解什么是内联元素和块元素。div 是块元素，span 是内联元素。div 是用作块元素。它旨在充当块元素。除非您另有说明，否则它应该具有全宽。span 是一个内联元素，它允许其他元素紧挨着它自己。您可以搜索“内联与块 html”以获取更多信息

要查看滚动条，请将**这些元素的容器**的溢出 css 属性设置为滚动。 [http://www.w3schools.com/cssref/pr_pos_overflow.asp](http://www.w3schools.com/cssref/pr_pos_overflow.asp)

# vba - Cell.Offset 问题

> ID：14715803
> 
> 赞同：0
> 
> 时间：2013-02-05T19:53:51.317
> 
> 标签：vba, excel

我是 vba 和一般编程的新手，但如果它足够简单，通常可以修改现有代码。我修改了一个宏，该宏根据我找到的另一个宏定义的路径从另一个工作簿中提取单元格。我已经让它根据 A 列正确提取单元格。我现在需要它根据 AF 列（不同的标准）提取信息。我对其进行了修改，并且成功地这样做了，但是它复制了以下 41 个列（我似乎无法使偏移量正常工作），而不是那些继续和后续的列。

我该如何解决这个问题？对于可能是丛林联盟的问题，我深表歉意。

```
ThisWB = ThisWorkbook.Name
Application.EnableEvents = False
Application.ScreenUpdating = False
path = GetFileName

        Set Wkb = Workbooks.Open(FileName:=path)
        For Each WS In Wkb.Worksheets
            WS.Select
            B = Application.CountA(Range("A:A"))
            If B = 0 Then
                            Else
                For Each Cell In Range("A1:A" & B)
                If VarType(Cell.Value) <> vbnumber Then
                A = Application.CountA(Workbooks(ThisWB).Sheets("ComplaintsFetched").Range("A:A")) + 1
               Range(Cell, Cell.Offset(0, 41)).Copy Workbooks(ThisWB).Sheets("ComplaintsFetched").Range("A" & A)
               End If
               Next Cell
            End If
        Next WS
        Wkb.Close False
Application.EnableEvents = True
Application.ScreenUpdating = True

Set Wkb = Nothing
Set LastCell = Nothing
Workbooks(ThisWB).Sheets("ComplaintsFetched").Select 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:04:59.667

您的函数调用：

```
Range(Cell, Cell.Offset(0, 41)).Copy 
    Workbooks(ThisWB).Sheets("ComplaintsFetched").Range("A" & A) 
```

正在做以下事情；`Range(Cell, Cell.Offset(0, 41)`表示选择一个范围，该范围从当前单元格（第一个参数）延伸到一个距离为 0 行的单元格，以及当前单元格右侧的 41 列（第二个参数）。

这就是您选择以下 41 列的原因。

相反，要选择前面和后面的单元格，有效地选择整行，您可以尝试：

```
Range(Cell).EntireRow.Copy Workbooks(ThisWB).Sheets("ComplaintsFetched").Range("A" & A) 
```

这会将整行从您的工作表复制到投诉工作表，从所需的行 A 列开始

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:11:35.207

偏移量正如其名称所暗示的那样，并返回与原始大小相同的选择。然后可以使用 Rows() 和 Columns() 方法来限制它。

我不太明白你想做什么，但是

```
Cell.Offset(0,41).Copy 
```

将单元格 41 列复制到单元格范围的右侧。

在 Excel 宏中命名变量 A 和 B 不是一个好主意，太容易将它们与列 A 和 B 混淆。

# cocoa - CGImageSourceRef 内存泄漏

> ID：14715805
> 
> 赞同：3
> 
> 时间：2013-02-05T19:53:55.420
> 
> 标签：cocoa, memory-leaks, cgimagesource

```
NSDictionary* result = nil;

CGImageSourceRef source = CGImageSourceCreateWithData((__bridge CFDataRef)[self TIFFRepresentation], NULL);

if ( NULL == source )
{
}
else
{
    CFDictionaryRef metadataRef = CGImageSourceCopyPropertiesAtIndex (source, 0, NULL);
    if (metadataRef)
    {
        NSDictionary* immutableMetadata = (__bridge NSDictionary *)metadataRef;
        if (immutableMetadata)
        {
            result = [NSDictionary dictionaryWithDictionary : (__bridge NSDictionary *)metadataRef];
        }

        CFRelease(metadataRef);
        metadataRef = nil;
    }

    CFRelease(source);
    source = nil;
}

return result; 
```

我正在将 XCode 与 ARC 一起使用。当我在循环中的许多图像上运行此代码时，此代码会导致我的应用程序泄漏内存。有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T11:28:03.147

将@autoreleasepool 包裹在代码周围解决了这个问题。图片大约 1.2MB

# haskell - 这种类型有什么一般结构？

> ID：14715811
> 
> 赞同：16
> 
> 时间：2013-02-05T19:54:08.260
> 
> 标签：haskell, types, higher-kinded-types

在之前破解某些东西时，我创建了以下代码：

```
newtype Callback a = Callback { unCallback :: a -> IO (Callback a) }

liftCallback :: (a -> IO ()) -> Callback a
liftCallback f = let cb = Callback $ \x -> (f x >> return cb) in cb

runCallback :: Callback a -> IO (a -> IO ())
runCallback cb =
    do ref <- newIORef cb
       return $ \x -> readIORef ref >>= ($ x) . unCallback >>= writeIORef ref 
```

`Callback a`表示一个处理一些数据并返回一个新的回调的函数，该回调应该用于下一个通知。可以说，一个基本上可以替换自身的回调。`liftCallback`只是将普通函数提升为我的类型，同时`runCallback`使用`IORef`a 将 a 转换`Callback`为简单函数。

该类型的一般结构是：

```
data T m a = T (a -> m (T m a)) 
```

看起来这可能与范畴论中一些著名的数学结构同构。

但它是什么？它是一个单子还是什么？一个应用函子？一个转化的单子？甚至是箭？是否有类似 Hoogle 的搜索引擎可以让我搜索这样的一般模式？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-06T00:09:53.283

您正在寻找的术语是[免费的单子变压器](http://www.haskellforall.com/2012/07/free-monad-transformers.html)。了解这些工作原理的最佳地点是阅读[The Monad Reader 第 19](http://themonadreader.files.wordpress.com/2011/10/issue19.pdf)期中的“协程管道”文章。Mario Blazevic 非常清楚地描述了这种类型的工作原理，除了他称之为“协程”类型。

我在包里写了他的类型，`transformers-free`然后它被合并到`free`包中，这是它的新官方主页。

您的`Callback`类型同构于：

```
type Callback a = forall r . FreeT ((->) a) IO r 
```

要了解免费的 monad 转换器，您需要首先[了解免费的 monad](http://www.haskellforall.com/2012/06/you-could-have-invented-free-monads.html)，它们只是抽象的语法树。你给自由的 monad 一个函子，它在语法树中定义了一个步骤，然后它`Monad`从中创建一个`Functor`基本上是这些类型步骤的列表的函数。所以如果你有：

```
Free ((->) a) r 
```

那将是一个语法树，它接受零个或多个`a`s 作为输入，然后返回一个值`r`。

但是，通常我们希望嵌入效果或使语法树的下一步依赖于某些效果。为此，我们只需将我们的自由 monad 提升为一个自由 monad 转换器，它在语法树步骤之间交错基本 monad。对于您的类型，您在每个输入步骤之间`Callback`交错，因此您的基本单子是：`IO``IO`

```
FreeT ((->) a) IO r 
```

自由 monad 的好处是它们自动成为任何函子的 monad，因此我们可以利用这一点来使用`do`符号来组装我们的语法树。例如，我可以定义一个`await`在 monad 中绑定输入的命令：

```
import Control.Monad.Trans.Free

await :: (Monad m) => FreeT ((->) a) m a
await = liftF id 
```

现在我有一个用于编写`Callback`s 的 DSL：

```
import Control.Monad
import Control.Monad.Trans.Free

printer :: (Show a) => FreeT ((->) a) IO r
printer = forever $ do
    a <- await
    lift $ print a 
```

请注意，我不必定义必要的`Monad`实例。对于任何仿函数，两者`FreeT f`和`Free f`都是自动的，在这种情况下是我们的仿函数，所以它会自动做正确的事情。这就是范畴论的魔力！`Monad``f``((->) a)`

此外，我们不必`MonadTrans`为了使用`lift`. `FreeT f`给定任何 functor ，它会自动成为一个 monad 转换器，`f`所以它也为我们解决了这个问题。

我们的打印机是一个合适的`Callback`，所以我们可以通过解构免费的单子变压器来提供它的值：

```
feed :: [a] -> FreeT ((->) a) IO r -> IO ()
feed as callback = do
    x <- runFreeT callback
    case x of
        Pure _ -> return ()
        Free k -> case as of
            []   -> return ()
            b:bs -> feed bs (k b) 
```

实际打印发生在我们 bind 时`runFreeT callback`，这给了我们语法树的下一步，我们提供列表的下一个元素。

让我们尝试一下：

```
>>> feed [1..5] printer
1
2
3
4
5 
```

但是，您甚至不需要自己编写所有这些内容。正如 Petr 所指出的，我的`pipes`库为您抽象了像这样的常见流模式。您的回调只是：

```
forall r . Consumer a IO r 
```

我们定义`printer`using的方式`pipes`是：

```
printer = forever $ do
    a <- await
    lift $ print a 
```

...我们可以为它提供一个值列表，如下所示：

```
>>> runEffect $ each [1..5] >-> printer
1
2
3
4
5 
```

我设计`pipes`包含非常大范围的像这样的流抽象，这样你总是可以使用`do`符号来构建每个流组件。 `pipes`还为状态和错误处理以及双向信息流等问题提供了多种优雅的解决方案，因此如果您`Callback`根据`pipes`.

如果你想了解更多`pipes`，我建议你[阅读教程](http://hackage.haskell.org/packages/archive/pipes/4.1.0/doc/html/Pipes-Tutorial.html)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-05T20:21:17.583

类型的一般结构在我看来像

```
data T (~>) a = T (a ~> T (~>) a) 
```

用你的`(~>) = Kleisli m`话来说（箭头）。

* * *

`Callback`它本身看起来不像我能想到的任何标准 Haskell 类型类的实例，但它是一个逆变函子（也称为 Cofunctor，事实证明它具有误导性）。由于它不包含在 GHC 附带的任何库中，因此在 Hackage 上存在多个它的定义（[使用这个](http://hackage.haskell.org/packages/archive/contravariant/0.3/doc/html/Data-Functor-Contravariant.html)），但它们看起来都像这样：

```
class Contravariant f where
    contramap :: (b -> a) -> f a -> f b
 -- c.f. fmap :: (a -> b) -> f a -> f b 
```

然后

```
instance Contravariant Callback where
    contramap f (Callback k) = Callback ((fmap . liftM . contramap) f (f . k)) 
```

范畴论中是否有一些更奇特的结构`Callback`？我不知道。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-05T21:40:38.540

我认为这种类型非常接近我所听说的“电路”，它是一种箭头。暂时忽略 IO 部分（因为我们可以通过转换 Kliesli 箭头来实现），电路变压器是：

```
newtype CircuitT a b c = CircuitT { unCircuitT :: a b (c, CircuitT a b c) } 
```

这基本上是一个箭头，每次返回一个新箭头用于下一个输入。只要基础箭头支持，所有常见的箭头类（包括循环）都可以为此箭头转换器实现。现在，我们要做的就是让它在概念上与你提到的类型相同，就是去掉那个额外的输出。这很容易做到，因此我们发现：

```
Callback a ~=~ CircuitT (Kleisli IO) a () 
```

好像我们看右手边：

```
CircuitT (Kleisli IO) a () ~=~
  (Kliesli IO) a ((), CircuitT (Kleisli IO) a ()) ~=~
  a -> IO ((), CircuitT (Kliesli IO) a ()) 
```

从这里，您可以看到这与 Callback a 的相似之处，只是我们还输出了一个单位值。由于单位值无论如何都在一个元组中，这并不能告诉我们太多，所以我会说它们基本上是相同的。

注意，出于某种原因，我使用 ~=~ 来表示类似但不完全等同于。但是它们非常相似，特别注意我们可以将 a 转换`Callback a`为 a `CircuitT (Kleisli IO) a ()`，反之亦然。

编辑：我也完全同意以下想法：A）一元协同流（一元操作期望无限数量的值，我认为这意味着）和 B）仅消费管道（在许多方面非常类似于没有输出的电路类型，或者更确切地说输出设置为（），因为这样的管道也可能有输出）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-05T21:39:35.847

只是一个观察，您的类型似乎与[`Consumer p a m`](http://hackage.haskell.org/packages/archive/pipes/3.1.0/doc/html/Control-Proxy-Synonym.html#t%3aConsumer)出现在[管道](http://hackage.haskell.org/package/pipes-3.1.0)库（可能还有其他类似的库）中非常相关：

```
type Consumer p a = p () a () C
-- A Pipe that consumes values
-- Consumers never respond. 
```

where`C`是一个空数据类型，`p`是[`Proxy`](http://hackage.haskell.org/packages/archive/pipes/3.1.0/doc/html/Control-Proxy-Class.html#t%3aProxy)类型类的一个实例。它使用类型的值`a`并且从不产生任何值（因为它的输出类型为空）。

例如，我们可以将 a 转换`Callback`为 a `Consumer`：

```
import Control.Proxy
import Control.Proxy.Synonym

newtype Callback m a = Callback { unCallback :: a -> m (Callback m a) }

-- No values produced, hence the polymorphic return type `r`.
-- We could replace `r` with `C` as well.
consumer :: (Proxy p, Monad m) => Callback m a -> () -> Consumer p a m r
consumer c () = runIdentityP (run c)
  where
    run (Callback c) = request () >>= lift . c >>= run 
```

请参阅[教程](http://hackage.haskell.org/packages/archive/pipes/3.1.0/doc/html/Control-Proxy-Tutorial.html)。

（这应该是一个评论，但它有点太长了。）

# opencv - Emgu CV - 各向异性扩散

> ID：14715817
> 
> 赞同：0
> 
> 时间：2013-02-05T19:54:41.360
> 
> 标签：opencv, emgucv

谁能指导我一些现有的各向异性扩散的实现，最好是**perona-malik 扩散**？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:28:44.513

翻译以下 MATLAB 代码：

```
% pm2.m - Anisotropic Diffusion routines

function ZN = pm2(ZN,K,iterate);

[m,n] = size(ZN);

% lambda = 0.250;
lambda = .025;
%K=16;

rowC = [1:m]; rowN = [1 1:m-1]; rowS = [2:m m];
colC = [1:n]; colE = [2:n n]; colW = [1 1:n-1];
result_save=0;
for i = 1:iterate, 
   %i;
%    result=PSNR(Z,ZN);
%    if result>result_save
%     result_save=result;
% else
%     break;
% end
  deltaN = ZN(rowN,colC) - ZN(rowC,colC);
  deltaS = ZN(rowS,colC) - ZN(rowC,colC);
  deltaE = ZN(rowC,colE) - ZN(rowC,colC);
  deltaW = ZN(rowC,colW) - ZN(rowC,colC);
%   deltaN = deltaN .*abs(deltaN<K);
%   deltaS = deltaS .*abs(deltaS<K);
%   deltaE = deltaE .*abs(deltaE<K);
%   deltaW = deltaW .*abs(deltaW<K);

     fluxN = deltaN .* exp(-((abs(deltaN) ./ K).^2)  );
     fluxS = deltaS .* exp(-((abs(deltaS) ./ K).^2)  );
     fluxE = deltaE .* exp(-((abs(deltaE) ./ K).^2)  );
     fluxW = deltaW .* exp(-((abs(deltaW) ./ K).^2)  );

   ZN = ZN + lambda*(fluxN +fluxS + fluxE + fluxW);   
   %ZN=max(0,ZN);ZN=min(255,ZN);
end 
```

代码不是我的，取自：[http ://www.csee.wvu.edu/~xinl/code/pm2.m](http://www.csee.wvu.edu/~xinl/code/pm2.m)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-15T01:40:39.590

**OpenCV 实现**（需要 3 通道图像）：

```
from cv2.ximgproc import anisotropicDiffusion
ultrasound_ad_cv2 = anisotropicDiffusion(im,0.075 ,80, 100) 
```

并列比较

[![在此处输入图像描述](../Images/63f55a6fb2fcc1871d5ef873ed973fa4.png)](https://i.stack.imgur.com/NGND3.png)

**在 Python 中从头开始：（**仅适用于灰度图像）

```
import scipy.ndimage.filters as flt
import numpy as np
import warnings

def anisodiff(img,niter=1,kappa=50,gamma=0.1,step=(1.,1.),sigma=0, option=1,ploton=False):
    """
    Anisotropic diffusion.

    Usage:
    imgout = anisodiff(im, niter, kappa, gamma, option)

    Arguments:
            img    - input image
            niter  - number of iterations
            kappa  - conduction coefficient 20-100 ?
            gamma  - max value of .25 for stability
            step   - tuple, the distance between adjacent pixels in (y,x)
            option - 1 Perona Malik diffusion equation No 1
                     2 Perona Malik diffusion equation No 2
            ploton - if True, the image will be plotted on every iteration

    Returns:
            imgout   - diffused image.

    kappa controls conduction as a function of gradient.  If kappa is low
    small intensity gradients are able to block conduction and hence diffusion
    across step edges.  A large value reduces the influence of intensity
    gradients on conduction.

    gamma controls speed of diffusion (you usually want it at a maximum of
    0.25)

    step is used to scale the gradients in case the spacing between adjacent
    pixels differs in the x and y axes

    Diffusion equation 1 favours high contrast edges over low contrast ones.
    Diffusion equation 2 favours wide regions over smaller ones.
  """

    # ...you could always diffuse each color channel independently if you
    # really want
    if img.ndim == 3:
        warnings.warn("Only grayscale images allowed, converting to 2D matrix")
        img = img.mean(2)

    # initialize output array
    img = img.astype('float32')
    imgout = img.copy()

    # initialize some internal variables
    deltaS = np.zeros_like(imgout)
    deltaE = deltaS.copy()
    NS = deltaS.copy()
    EW = deltaS.copy()
    gS = np.ones_like(imgout)
    gE = gS.copy()

    # create the plot figure, if requested
    if ploton:
        import pylab as pl
        from time import sleep

        fig = pl.figure(figsize=(20,5.5),num="Anisotropic diffusion")
        ax1,ax2 = fig.add_subplot(1,2,1),fig.add_subplot(1,2,2)

        ax1.imshow(img,interpolation='nearest')
        ih = ax2.imshow(imgout,interpolation='nearest',animated=True)
        ax1.set_title("Original image")
        ax2.set_title("Iteration 0")

        fig.canvas.draw()

    for ii in np.arange(1,niter):

        # calculate the diffs
        deltaS[:-1,: ] = np.diff(imgout,axis=0)
        deltaE[: ,:-1] = np.diff(imgout,axis=1)

        if 0<sigma:
            deltaSf=flt.gaussian_filter(deltaS,sigma);
            deltaEf=flt.gaussian_filter(deltaE,sigma);
        else: 
            deltaSf=deltaS;
            deltaEf=deltaE;

        # conduction gradients (only need to compute one per dim!)
        if option == 1:
            gS = np.exp(-(deltaSf/kappa)**2.)/step[0]
            gE = np.exp(-(deltaEf/kappa)**2.)/step[1]
        elif option == 2:
            gS = 1./(1.+(deltaSf/kappa)**2.)/step[0]
            gE = 1./(1.+(deltaEf/kappa)**2.)/step[1]

        # update matrices
        E = gE*deltaE
        S = gS*deltaS

        # subtract a copy that has been shifted 'North/West' by one
        # pixel. don't as questions. just do it. trust me.
        NS[:] = S
        EW[:] = E
        NS[1:,:] -= S[:-1,:]
        EW[:,1:] -= E[:,:-1]

        # update the image
        imgout += gamma*(NS+EW)

        if ploton:
            iterstring = "Iteration %i" %(ii+1)
            ih.set_data(imgout)
            ax2.set_title(iterstring)
            fig.canvas.draw()
            # sleep(0.01)

    return imgout 
```

*   用法

: #anisodiff(img,niter=1,kappa=50,gamma=0.1,step=(1.,1.),sigma=0, option=1,ploton=False)

```
us_im_ad = anisodiff(ultrasound,100,80,0.075,(1,1),2.5,1) 
```

[来源](https://www.kaggle.com/kmader/anisotropic-diffusion-example)

并列比较

[![在此处输入图像描述](../Images/e716ad1952b3a6b20b40f1ffc0fb9099.png)](https://i.stack.imgur.com/LE7Ij.png)

# c# - 如何覆盖实体框架中对象的保存行为

> ID：14715826
> 
> 赞同：2
> 
> 时间：2013-02-05T19:54:59.267
> 
> 标签：c#, asp.net-mvc-4, entity-framework-5

我有这样的课程：

```
public class course   
{
        public int CourseID { get; set; }
        public string Name { get; set; }   
        public Event Schedule {get; set;} //Event is coming from library Dday.iCal  
} 
```

实体框架无法正确理解如何保存此属性。（我想在保存时将其序列化为字符串，并在我的应用程序中使用它时将其保留为事件。）所以我有两种方法，例如 SerializeToString() 和 DeserializeFromString()。我希望仅在保存到数据库时应用这些方法。

我想出了以下内容。基本上我试图将一个单独的属性作为一个字符串保存在数据库中，并且 Event 将被忽略，但它现在不会将任何内容保存到数据库中。我什至不确定这是否是做事的好方法，或者可以做更好的事情。：

```
 public class course   
    {
            public int CourseID { get; set; }
            public string Name { get; set; }  
            private Event _Schedule;
            [NotMapped]  
            public Event Schedule {  
            get
            {
                if (!String.IsNullOrEmpty(CourseSchedule))
                {
                    return DeserilizeFromString(CourseSchedule);
                }
                return new Event();
            }
            set
            {
                _schedule = value;
            }
            }  
            private string _courseSchedule;
            public string CourseSchedule { 
            get
            {
                return _courseSchedule;
            }
            private set
            {
                if (Schedule != null)
                {
                    _courseSchedule = SerializeToString(Schedule);
                }
                else
                {
                    _courseSchedule = null;
                }
            }   
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:39:40.367

asp.net 上的作者实际上已经实现了您尝试做的事情，几乎到了发球台。您可能需要遵循该项目中的几点来帮助您入门。该项目的链接在[这里](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/creating-an-entity-framework-data-model-for-an-asp-net-mvc-application)。

需要注意的一些事情是，它确实利用了`DbContext Api`在实体框架中实现的。上面提到的一些抽象是这样的：

您的解决方案：

*   模型
*   看法
*   控制器
*   数据访问层 (DAL)

本教程实际上将使用`Course Controller`、`Unit Of Work Class`和来完成实现`Repositories`。在本教程结束时，它将实现那些`automatic properties`看起来`DbContext`像这样的：

```
// Model:
public abstract class Person
    {
        [Key]
        public int PersonID { get; set; }

        [Required(ErrorMessage = "Last name is required.")]
        [Display(Name = "Last Name")]
        [MaxLength(50)]
        public string LastName { get; set; }

        [Required(ErrorMessage = "First name is required.")]
        [Column("FirstName")]
        [Display(Name = "First Name")]
        [MaxLength(50)]
        public string FirstMidName { get; set; }

        public string FullName
        {
            get
            {
                return LastName + ", " + FirstMidName;
            }
        }
    } 
```

* * *

```
// Repository:
public class StudentRepository : IStudentRepository, IDisposable
    {
        private SchoolContext context;

        public StudentRepository(SchoolContext context)
        {
            this.context = context;
        }

        public IEnumerable<Student> GetStudents()
        {
            return context.Students.ToList();
        }

        public Student GetStudentByID(int id)
        {
            return context.Students.Find(id);
        }

        public void InsertStudent(Student student)
        {
            context.Students.Add(student);
        }

        public void DeleteStudent(int studentID)
        {
            Student student = context.Students.Find(studentID);
            context.Students.Remove(student);
        }

        public void UpdateStudent(Student student)
        {
            context.Entry(student).State = EntityState.Modified;
        }

        public void Save()
        {
            context.SaveChanges();
        }

        private bool disposed = false;

        protected virtual void Dispose(bool disposing)
        {
            if (!this.disposed)
            {
                if (disposing)
                {
                    context.Dispose();
                }
            }
            this.disposed = true;
        }

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }
    } 
```

* * *

```
// Interface for Repository:
    public interface IStudentRepository : IDisposable
    {
        IEnumerable<Student> GetStudents();
        Student GetStudentByID(int studentId);
        void InsertStudent(Student student);
        void DeleteStudent(int studentID);
        void UpdateStudent(Student student);
        void Save();
    } 
```

* * *

```
// Context to Generate Database:
    public class SchoolContext : DbContext
    {
        public DbSet<Course> Courses { get; set; }
        public DbSet<Department> Departments { get; set; }
        public DbSet<Enrollment> Enrollments { get; set; }
        public DbSet<Instructor> Instructors { get; set; }
        public DbSet<Student> Students { get; set; }
        public DbSet<Person> People { get; set; }
        public DbSet<OfficeAssignment> OfficeAssignments { get; set; }

        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
            modelBuilder.Entity<Instructor>()
                .HasOptional(p => p.OfficeAssignment).WithRequired(p => p.Instructor);
            modelBuilder.Entity<Course>()
                .HasMany(c => c.Instructors).WithMany(i => i.Courses)
                .Map(t => t.MapLeftKey("CourseID")
                    .MapRightKey("PersonID")
                    .ToTable("CourseInstructor"));
            modelBuilder.Entity<Department>()
                .HasOptional(x => x.Administrator);
        }
    } 
```

* * *

```
// Unit Of Work
public class UnitOfWork : IDisposable
    {
        private SchoolContext context = new SchoolContext();
        private GenericRepository<Department> departmentRepository;
        private CourseRepository courseRepository;

        public GenericRepository<Department> DepartmentRepository
        {
            get
            {

                if (this.departmentRepository == null)
                {
                    this.departmentRepository = new GenericRepository<Department>(context);
                }
                return departmentRepository;
            }
        }

        public CourseRepository CourseRepository
        {
            get
            {

                if (this.courseRepository == null)
                {
                    this.courseRepository = new CourseRepository(context);
                }
                return courseRepository;
            }
        }

        public void Save()
        {
            context.SaveChanges();
        }

        private bool disposed = false;

        protected virtual void Dispose(bool disposing)
        {
            if (!this.disposed)
            {
                if (disposing)
                {
                    context.Dispose();
                }
            }
            this.disposed = true;
        }

        public void Dispose()
        {
            Dispose(true);
            GC.SuppressFinalize(this);
        }
    } 
```

这是本课中的一些内容，我相信它会非常明确地回答您的问题，同时让您了解抽象为什么起作用，因为它确实实现了`Fluent Api`.

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:15:53.880

如果你有一个看起来像这样的模型

```
using (LolEntities context = new LolEntities)
{
...
} 
```

在你的应用程序的某个地方，这个模型被定义了，通常是这样的：

```
public partial class LolEntities : ObjectContext 
```

(1) 请注意，该类是部分类，因此您可以创建另一个具有相同名称的部分类并覆盖：

```
public override int SaveChanges(SaveOptions options) 
```

(2) 或者您可以只捕获事件：

```
using (DemoAZ_8_0Entities context = new DemoAZ_8_0Entities())
{
    context.SavingChanges += ...
} 
```

并在将其发送回数据库之前进行格式化。

在您的模型中，只需确保包含一个正确映射到数据库中列的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T20:20:37.010

也许在此逻辑上引入一些抽象，您可以重新创建工作单元和存储库模式，并以更方便的方式添加所需的逻辑。例如，在 Course 存储库类中，您可以自定义 add 和 find 方法序列化和反序列化事件字段。

我将重点介绍存储库模式，您可以在网络上找到很多关于整个数据访问层设计的信息。

例如，要管理课程，您的应用程序应该依赖于这样的 ICourseRepository 接口

```
interface ICourseRepository
{
    void Add(Course newCourse);
    Course FindByID(int id);
} 
```

您提供以下实现：

```
class CourseRepository
{
    // DbContext and maybe other fields

    public void Add(Course c)
    {

        // Serialize the event field before save the object
        _courses.Add(c);   // calling entity framework functions, note  
                           // that '_courses' variable could be an DBSet from EF
    }

    public Course FindById(int id)
    {
       var course = /// utilize EF functions here to retrieve the object
       // In course variable deserialize the event field before to return it ...
    }
} 
```

请注意，EF 中的 ObjectContext 是此模式的实现，如果您以后不想更改 ORM，则可以覆盖 EF 上的 Save 方法。

如果您想了解更多关于这种模式的信息，您可以访问 Martin Fowler 网站：

*   [工作单元模式](http://martinfowler.com/eaaCatalog/unitOfWork.html)

*   [存储库模式](http://martinfowler.com/eaaCatalog/repository.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-05T20:28:06.153

你应该让你的模型尽可能简单，只有自动属性和属性。对于更复杂的业务逻辑，最好在 MVC 模式中添加另一层。这通常称为存储库（尽管很难找到关于存储库模式的好教程.. :( ）并且位于模型和控制器控制器之间。

这对于执行单元测试也非常有用。如果正确实施，它允许您在测试期间用集合替换数据库依赖项。这种方法将需要对项目进行大量额外工作。

另一种方法（一种更简单的方法）是添加一个 ViewModel 层。这样做：

```
class MyModel
{
    public string Text { get; set; }
}

class MyViewModel : MyModel
{
    public new string Text
    {
        get { return base.Text; }
        set { base.Text =value.ToUpper(); }
    }
}

class Program
{
    static void Main(string[] args)
    {
        MyViewModel mvm = new MyViewModel();
        mvm.Text = "hello there";
        var s = ((MyModel) mvm).Text; // "HELLO THERE"
    }
} 
```

在 DataContext 中使用 MyModel，在控制器中使用 MyViewModel。

# xml - 将组标题添加到三级 XSLT 分组

> ID：14715829
> 
> 赞同：0
> 
> 时间：2013-02-05T19:55:14.137
> 
> 标签：xml, xslt

下面的 XSLT 完成了我需要按学位然后按选修课和要求对我的 XML 数据进行分组的一切。但我不能让`<ACPGAREAOFSTUDY1>`标题在每个部分只出现一次。我需要一个在学位之外的父分组，只有一个`<ACPGAREAOFSTUDY1>`数据元素来介绍它。

这是 XSLT：

```
 <?xml version="1.0"?><!-- DWXMLSource="STX049 Catalog parsed.xml" -->
 <!DOCTYPE xsl:stylesheet>
 <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output method="xml" indent="no"/>
 <xsl:key name="degrees-by-title" match="Section" use="ICCB1" />

 <xsl:template match="/*">
 <CrystalReport>
  <xsl:apply-templates select="Group/Group/Group"/>
 </CrystalReport>
 </xsl:template>

 <xsl:template match="Group">
 <xsl:text>
 </xsl:text><Degree><areaofstudy><xsl:value-of select="ACPGAREAOFSTUDY1" /></areaofstudy>
 <xsl:apply-templates select="Details/Section[generate-id() = generate-id(key('degrees-by-title', ICCB1)[1])]" mode="group">
 <xsl:sort select="ACADPROGRAMSID1" />
 </xsl:apply-templates>
 </Degree>
 </xsl:template>

 <xsl:template match="Section" mode="group">
 <department><Degreetitle><xsl:apply-templates select="ACPGDEGREE1" /></Degreetitle>
 <Certtitle><xsl:apply-templates select="CCD11" /></Certtitle><xsl:text>
 </xsl:text><DegreeDesc><xsl:apply-templates select="ACPGCOMMENTS1" /></DegreeDesc><xsl:text>
 ICCB Code </xsl:text><ICCBcode><xsl:apply-templates select="ICCB1" /></ICCBcode><xsl:text> | Field of Study Code: </xsl:text><ProgramID><xsl:apply-templates select="ACADPROGRAMSID1" /></ProgramID>
 <xsl:variable name="courses" select="key('degrees-by-title', ICCB1)" />

 <xsl:call-template name="CourseGroup">
 <xsl:with-param name="courses" select="$courses[FlagElectives1 = 'N']" />
 <xsl:with-param name="title" select="'Program Requirements'" />
 </xsl:call-template>

 <xsl:call-template name="CourseGroup">
 <xsl:with-param name="courses" select="$courses[FlagElectives1 = 'Y']" />
 <xsl:with-param name="title" select="'Program Electives'" />
 </xsl:call-template>
 </department>
 </xsl:template>

 <xsl:template name="CourseGroup">
 <xsl:param name="courses" />
 <xsl:param name="title" />

 <xsl:if test="$courses"><xsl:text>
 </xsl:text><xsl:value-of select="$title" />
 <xsl:apply-templates select="$courses">
 <xsl:sort select="FlagElectives1" order="ascending" />
 <xsl:sort select="DEPARTMENT11" />
 <xsl:sort select="CRSNO1" />
 </xsl:apply-templates>
 </xsl:if>
 </xsl:template>

 <xsl:template match="Section"><xsl:text>
 </xsl:text><Details><class><deptname><xsl:apply-templates select="DEPARTMENT11" /></deptname><xsl:text>    </xsl:text><courseno><xsl:apply-templates select="CRSNO1" /></courseno><xsl:text>   </xsl:text>
 <classname><xsl:apply-templates select="CRSTITLE1" /></classname><xsl:text>    </xsl:text>
 <classcredit><xsl:apply-templates select="CRSMINCRED1" /></classcredit></class></Details>
 </xsl:template>

 <xsl:template match="ACPGDEGREE1/text()">
 <xsl:value-of select="concat(., ' DEGREE')"/>
 </xsl:template>

 <xsl:template match="CCD11/text()">
 <xsl:value-of select="concat(., ' CERTIFICATE')" />
 </xsl:template>
 </xsl:stylesheet> 
```

这是基本的 XML 结构：

```
<?xml version="1.0" encoding="UTF-8"?>
 <CrystalReport>
 <Group Level="1">
  <Group Level="2">
  <Group Level="3">
    <Details>
      <Section>
        <ACPGDEGREE1>AAS</ACPGDEGREE1>
        <CCD11/>
        <ACPGCOMMENTS1>The Accounting program</ACPGCOMMENTS1>
        <ICCB1>3203</ICCB1>
        <ACADPROGRAMSID1>ACCOU.AAS</ACADPROGRAMSID1>
        <CRSNO1>1110</CRSNO1>
        <ACRBPRINTEDSPEC1/>
        <ACPGHOMELANGNOTREQDRSN1>General Education</ACPGHOMELANGNOTREQDRSN1>
        <CRSMINCRED1>2</CRSMINCRED1>
        <ACPGAREAOFSTUDY1>Accounting</ACPGAREAOFSTUDY1>
        <CRSTITLE1>Using Computers: An Introduction</CRSTITLE1>
        <DEPARTMENT11>ACCOU</DEPARTMENT11>
        <CRSSUBJECT1>CIS</CRSSUBJECT1>
        <ACRBLABEL1>CIS REQUIREMENT</ACRBLABEL1>
        <CRSMAXCRED1/>
        <FlagElectives1>N</FlagElectives1>
      </Section>
    </Details>
    <Details>
      <Section>
        <ACPGDEGREE1>AAS</ACPGDEGREE1>
        <CCD11/>
        <ACPGCOMMENTS1>The Accounting program</ACPGCOMMENTS1>
        <ICCB1>3203</ICCB1>
        <ACADPROGRAMSID1>ACCOU.AAS</ACADPROGRAMSID1>
        <CRSNO1>1150</CRSNO1>
        <ACRBPRINTEDSPEC1/>
        <ACPGHOMELANGNOTREQDRSN1>General Education</ACPGHOMELANGNOTREQDRSN1>
        <CRSMINCRED1>3</CRSMINCRED1>
        <ACPGAREAOFSTUDY1>Accounting</ACPGAREAOFSTUDY1>
        <CRSTITLE1>Intro to Computer</CRSTITLE1>
        <DEPARTMENT11>ACCOU</DEPARTMENT11>
        <CRSSUBJECT1>CIS</CRSSUBJECT1>
        <ACRBLABEL1>CIS</ACRBLABEL1>
        <CRSMAXCRED1/>
        <FlagElectives1>Y</FlagElectives1>
      </Section>
    </Details>
  </Group>
  </Group>
 </Group>
</CrystalReport> 
```

生成以下 XML：

```
<CrystalReport>
 <Degrees><areaofstudy>Accounting</areaofstudy)
 <Degree>
<department>
  <Degreetitle>AAS DEGREE</Degreetitle>
  <Certtitle />
  <DegreeDesc>The Accounting program</DegreeDesc>
  <ICCBcode>3203</ICCBcode>
  <ProgramID>ACCOU.AAS</ProgramID>
  <h1>Program Requirements</h1>
  <Details>
    <class>
      <deptname>ACCOU</deptname>
      <courseno>1150</courseno>
      <classname>Intro to Computer</classname>
      <classcredit>3</classcredit>
      <Elective>Y</Elective>
    </class>
  </Details>
  <h1>Program Electives</h1>
  <Details>
    <class>
      <deptname>ACCOU</deptname>
      <courseno>1110</courseno>
      <classname>Using Computers: An Introduction</classname>
      <classcredit>2</classcredit>
      <Elective>N</Elective>
    </class>
  </Details>
 </department>
</Degree>
</Degrees>
</CrystalReport> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:32:34.630

这个怎么样：

```
<?xml version="1.0"?>
<!-- DWXMLSource="STX049 Catalog parsed.xml" -->
<!DOCTYPE xsl:stylesheet>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="xml" indent="no"/>
  <xsl:variable name="allSections"
                select="/CrystalReport/Group/Group/Group/Details/Section" />

  <xsl:key name="kArea" match="Section" use="ACPGAREAOFSTUDY1"/>
  <xsl:key name="kDepartment" match="Section"
           use="concat(ACPGAREAOFSTUDY1, '+', ICCB1)" />

  <xsl:variable name="deptFirsts"
             select="$allSections[generate-id() = 
               generate-id(key('kDepartment',
                concat(ACPGAREAOFSTUDY1, '+', ICCB1))[1])]" />

  <xsl:template match="/">
    <CrystalReport>
      <Degrees>
        <xsl:apply-templates
          select="$allSections[generate-id() = 
                 generate-id(key('kArea', ACPGAREAOFSTUDY1)[1])]"
          mode="group"/>
      </Degrees>
    </CrystalReport>
  </xsl:template>

  <xsl:template match="Section" mode="group">
    <xsl:variable name="area" select="ACPGAREAOFSTUDY1" />
    <areaofstudy>
      <xsl:value-of select="$area"/>
    </areaofstudy>
    <xsl:text>&#xA;</xsl:text>
    <Degree>
      <xsl:apply-templates select="$deptFirsts[ACPGAREAOFSTUDY1 = $area]"
                           mode="department">
        <xsl:sort select="ACADPROGRAMSID1" />
      </xsl:apply-templates>
    </Degree>
  </xsl:template>

  <xsl:template match="Section" mode="department">
    <department>
      <xsl:apply-templates select="." mode="departmentValues" />

      <xsl:variable name="courses"
              select="key('kDepartment', 
                   concat(ACPGAREAOFSTUDY1, '+', ICCB1))" />

      <xsl:call-template name="CourseGroup">
        <xsl:with-param name="courses" select="$courses[FlagElectives1 = 'N']" />
        <xsl:with-param name="title" select="'Program Requirements'" />
      </xsl:call-template>

      <xsl:call-template name="CourseGroup">
        <xsl:with-param name="courses" select="$courses[FlagElectives1 = 'Y']" />
        <xsl:with-param name="title" select="'Program Electives'" />
      </xsl:call-template>
    </department>
  </xsl:template>

  <xsl:template match="Section" mode="departmentValues">
    <Degreetitle>
      <xsl:apply-templates select="ACPGDEGREE1" />
    </Degreetitle>
    <Certtitle>
      <xsl:apply-templates select="CCD11" />
    </Certtitle>
    <xsl:text>&#xA;</xsl:text>
    <DegreeDesc>
      <xsl:apply-templates select="ACPGCOMMENTS1" />
    </DegreeDesc>
    <xsl:text>&#xA;ICCB Code</xsl:text>
    <ICCBcode>
      <xsl:apply-templates select="ICCB1" />
    </ICCBcode>
    <xsl:text> | Field of Study Code: </xsl:text>
    <ProgramID>
      <xsl:apply-templates select="ACADPROGRAMSID1" />
    </ProgramID>
  </xsl:template>

  <xsl:template name="CourseGroup">
    <xsl:param name="courses" />
    <xsl:param name="title" />

    <xsl:if test="$courses">
      <xsl:text>&#xA;</xsl:text>
      <xsl:value-of select="$title" />
      <xsl:apply-templates select="$courses">
        <xsl:sort select="FlagElectives1" order="ascending" />
        <xsl:sort select="DEPARTMENT11" />
        <xsl:sort select="CRSNO1" />
      </xsl:apply-templates>
    </xsl:if>
  </xsl:template>

  <xsl:template match="Section">
    <xsl:text>&#xA;</xsl:text>
    <Details>
      <class>
        <deptname>
          <xsl:apply-templates select="DEPARTMENT11" />
        </deptname>
        <xsl:text>    </xsl:text>
        <courseno>
          <xsl:apply-templates select="CRSNO1" />
        </courseno>
        <xsl:text>   </xsl:text>
        <classname>
          <xsl:apply-templates select="CRSTITLE1" />
        </classname>
        <xsl:text>    </xsl:text>
        <classcredit>
          <xsl:apply-templates select="CRSMINCRED1" />
        </classcredit>
      </class>
    </Details>
  </xsl:template>

  <xsl:template match="ACPGDEGREE1/text()">
    <xsl:value-of select="concat(., ' DEGREE')"/>
  </xsl:template>

  <xsl:template match="CCD11/text()">
    <xsl:value-of select="concat(., ' CERTIFICATE')" />
  </xsl:template>
</xsl:stylesheet> 
```

在您的示例 XML 上运行时，这会产生：

```
<CrystalReport>
  <Degrees>
    <areaofstudy>Accounting</areaofstudy>
    <Degree>
      <department>
        <Degreetitle>AAS DEGREE</Degreetitle><Certtitle />
        <DegreeDesc>The Accounting program</DegreeDesc>
        ICCB Code<ICCBcode>3203</ICCBcode> | Field of Study Code: <ProgramID>ACCOU.AAS</ProgramID>
        Program Requirements
        <Details>
          <class>
            <deptname>ACCOU</deptname>
            <courseno>1110</courseno>
            <classname>Using Computers: An Introduction</classname>
            <classcredit>2</classcredit>
          </class>
        </Details>
        Program Electives
        <Details>
          <class>
            <deptname>ACCOU</deptname>
            <courseno>1150</courseno>
            <classname>Intro to Computer</classname>
            <classcredit>3</classcredit>
          </class>
        </Details>
      </department>
    </Degree>
  </Degrees>
</CrystalReport> 
```

# c++ - 我可以将多个 BOOST 单元测试链接到一个测试二进制文件中吗？

> ID：14715837
> 
> 赞同：35
> 
> 时间：2013-02-05T19:55:40.003
> 
> 标签：c++, unit-testing, testing, boost, automated-tests

我最近开始尝试测试一个古老的大型（> 100 万行）程序。目前没有单元测试。此外，程序被链接为每个单独的文件被链接在一起 - 没有组件库。此外，对象是*高度*相互依赖的，如果不链接到至少一半的对象文件，就很难（不可能？）链接到任何对象文件。

是的，我知道，我的生活很糟糕。

我想做一些重构（显然），但我想在开始移动之前进行一些测试。我目前的想法是编译一个运行我创建的所有测试的“测试程序”。这将大大简化我遇到的链接问题，让我专注于真正的问题。所以我有两个问题：

*   **是否可以将多个 BOOST 单元测试文件链接到一个测试可执行文件中？**
*   **有更好的解决方案吗？**

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-03-09T22:29:25.833

我想，这正是使用 boost 测试的方法。我会保留一个简短的 main.cpp 文件，其中包含 2 行：

```
#define BOOST_TEST_MODULE "C++ Unit Tests for MyTangledLibrary"
#include <boost/test/included/unit_test.hpp> 
```

然后我会继续添加测试模块 *.cpp 文件一起编译成一个可执行文件

```
#include <boost/test/unit_test.hpp>
<< your include files >>

BOOST_AUTO_TEST_SUITE(FancyShmancyLogic)

BOOST_AUTO_TEST_CASE(TestingIf2x3equals6)
{
  ...
}

BOOST_AUTO_TEST_CASE(TestingIf2x2equals4)
{
  ...
}

BOOST_AUTO_TEST_SUITE_END() 
```

是的，您将能够将该 main.cpp 和所有模块编译成一个大型可执行文件。

# android - Git没有显示“资产”文件夹

> ID：14715838
> 
> 赞同：1
> 
> 时间：2013-02-05T19:55:43.247
> 
> 标签：android, git, netbeans

我有一个名为“assets”的文件夹（使用 netbeans 中的向导创建新的 android 应用程序时自动生成），但它没有显示在 git 命令行中，即使我尝试添加它也不会添加到 repo 中。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T20:00:27.257

听起来该目录被 git 忽略了。检查 Git 存储库根目录下的 .gitignore 和 ~/.gitignore（您的全局忽略设置）。资产是否显示在那里？如果是这样，请`git add -f assets/`强制添加。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-02-18T16:44:19.120

Git 不能处理（空）文件夹，只能处理文件。如果您需要提交一个文件夹，您需要检查其中的一个文件，以强制 git 重新创建该文件夹。

我建议你提交一个以下划线“。”开头的空文件。像**".keep"**，*这个文件将被 android 构建过程忽略。*

希望对你有帮助

# c# - 我是否正确获取标签文本？

> ID：14715840
> 
> 赞同：0
> 
> 时间：2013-02-05T19:55:47.287
> 
> 标签：c#, asp.net

我有一些 JS 读取 asp 标签的文本并基于它设置 div 是否可见。

```
 function setToLabel() {
        text = document.getElementById('add_view');
        lbl = document.getElementById('lblAddVisible');
        var isHidden = text.innerText == 'true';
        text.style.display = isHidden ? 'block' : 'none';
    }

    $(document).ready
(
     function()
     {
         setToLabel();
     }

); 
```

问题是它只有在我明确设置 isHidden 变量时才有效。当我告诉它读取标签以获取布尔值时，它永远不会起作用。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:00:32.797

这是因为在呈现控件时，ASP 为控件提供了与您指定的 ID 不同的 ID。如果脚本与您的 ASP 代码在同一页面上呈现，您可以添加此

```
lbl = document.getElementById('<%= lblAddVisible.ClientID %>'); 
```

否则，您必须将 a 添加`CssClass`到`lblAddVisible`控件并按类名获取元素。此外，请确保您使用的是正确的元素，您需要从中读取 innerHTML。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T20:02:23.997

如果您的 aspx 页面中有嵌套控件，则可能是您没有使用正确的 Id。尝试这个：

```
text = document.getElementById('<%=add_view.ClientID%>'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T20:00:15.680

```
function setToLabel() {
    text = document.getElementById('add_view');
    lbl = document.getElementById('lblAddVisible');
    var isHidden = lbl .innerText;
    text.style.display = isHidden ? 'block' : 'none';
 }

 $(document).ready
 (
 function()
 {
     setToLabel();
 }

 ); 
```

而不是`txt.innerText`，你需要使用`lbl.innerText`，因为你必须从标签中读取

# matlab - 无法写入 .xls 文件 (MatLab)

> ID：14715845
> 
> 赞同：0
> 
> 时间：2013-02-05T19:56:02.763
> 
> 标签：matlab, spreadsheet, xls

我想通过在单元格 H4 中插入数字 3 来编辑 MatLab 中的某个 .xls 电子表格。我输入了以下代码：

```
xlswrite('list.xls', 3, 1, 'H4') 
```

但它不会改变任何东西。电子表格似乎没有受到影响，但 xlswrite 在写入成功输出时返回 1……关于可能发生的事情有什么想法吗？干杯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T22:05:16.040

试试这个：

```
xlswrite('test',3,'H4:H4') 
```

# macos - 适用于 Mac 的 QR 码扫描器 SDK？

> ID：14715846
> 
> 赞同：0
> 
> 时间：2013-02-05T19:56:02.767
> 
> 标签：macos, sdk, qr-code

似乎有很多适用于 iPhone 的 QR 码 SDK，但我发现了一些在 Mac 上不可用的参考框架，例如 UIKit。我希望能够通过 Mac 应用程序使用 Mac 上的网络摄像头扫描 QR 码。有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:47:27.947

这不是一个完整的实现，但是[zxing](http://code.google.com/p/zxing/)库中有 cocoa 支持。它至少应该让你开始。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-09T20:45:11.223

zxing有这个。查看 objc 目录。文档的方式不多，但它有例子。如果您有问题，请随时发布到 zxing google 组。

[完全披露：我是 objc 接口类的作者/维护者。]

# c++ - 使用使用 C 风格字符串作为 OUT 参数的 WinAPI 函数

> ID：14715848
> 
> 赞同：0
> 
> 时间：2013-02-05T19:56:09.127
> 
> 标签：c++, winapi, cstring, out

给定一个 WinAPI 函数，该函数通过 C 风格的字符串 OUT 参数返回结果，例如：

```
int WINAPI GetWindowTextW(
   _In_   HWND hWnd,
   _Out_  LPTSTR lpString,
   _In_   int nMaxCount
); 
```

有没有比我在下面做的更好的方法来使用该功能？

```
HWND handle; // Assume this is initialised to contain a real window handle
std::wstring title;
wchar_t buffer[512];
GetWindowTextW(handle, buffer, sizeof(buffer));
title = buffer; 
```

上面的代码有效，但我有以下问题：

1.  缓冲区大小是完全任意的，因为我无法知道函数可能返回的字符串的长度。这对我来说“感觉”是错误的——我一直试图在我的代码中避免使用幻数。

2.  如果函数返回的字符串大于缓冲区，它将被截断——这很糟糕！

3.  每当函数返回一个小于缓冲区的字符串时，我都会浪费内存。这并不像（2）那么糟糕，但我对为实际上可能只需要几个字节的东西留出大块内存（例如上面示例中的 1024 字节）的想法并不感到兴奋。

还有其他选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T20:07:15.880

使用不同大小的临时缓冲区多次调用该函数。从 8 的缓冲区开始。将缓冲区大小加倍并再次调用它。重复直到它返回与上次相同的计数。然后您可以分配确切大小的缓冲区并复制您在那里的内容。有许多具有类似行为的 Win32 函数。

您可以使用`GetWindowTextLength()`，但如果存在竞争条件，它可能不会有太大帮助（因为它们，您最终可能会收到截断的文本）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T22:28:43.183

根据您使用的 Windows API 函数，有几种不同的模式。对于一些，您可以先查询，有时通过调用另一个函数（例如，GetWindowTextLengthW），但通常通过为缓冲区传递NULL。查询后，分配大小并再次调用以获取实际的字符串数据。

即使使用查询分配查询，您有时也需要迭代，因为可能存在竞争条件。例如，考虑如果窗口标题在 GetWindowTextLengthW 和 GetWindowTextW 调用之间发生变化会发生什么。

您还可以通过使用字符串本身而不是第二个缓冲区来避免额外的副本。

```
std::wstring GetWindowTitle(HWND hwnd) {
    std::wstring title(16, L'X');
    int cch;
    do {
      title.resize(2 * title.size());
      cch = GetWindowTextW(hwnd, &title[0], title.size());
    } while (cch + 1 == title.size());
    title.resize(cch);
    return title;
} 
```

虽然尴尬，但这并不是 Windows API 设计的真正错误。API 被设计为 C 接口，而不是 C++。由于 C 不是面向对象的，因此在处理字符串方面非常有限。对于 C++ 代码，您可以像我在本示例中所做的那样包装这种簿记。

# android - 没有得到一个开放的 Sqlite 数据库

> ID：14715852
> 
> 赞同：0
> 
> 时间：2013-02-05T19:56:15.743
> 
> 标签：android, sqlite, illegalstateexception

我正在尝试从 SQLiteDatabase rawQuery 获取游标，但不断获取`java.lang.IllegalStateException`. 准确地说，这个例外：

```
 02-05 19:30:25.100: E/AndroidRuntime(338): java.lang.RuntimeException: Unable to start activity ComponentInfo{frisbeergolf.gui/frisbeergolf.gui.Hole}: java.lang.IllegalStateException: attempt to acquire a reference on a close SQLiteClosable 
```

（下面附上完整的日志）

这是我在 SQLiteOpenHelper 类中的方法：

```
 public int[] getAllPlayersInGame(Game game){
    SQLiteDatabase db = this.getReadableDatabase();
    int count = this.getNumberOfPlayersInGame(game);
    int[] playerIDs = new int[count];

    Boolean b = db.isOpen();

    Cursor cursor = null;
    cursor = db.rawQuery("SELECT playerID FROM " + gamesTable + " WHERE gameID = " + game.getGameId(), null);

    cursor.moveToFirst();

    for (int i = 0; i < count; i++) {
        playerIDs[i] = cursor.getInt(0);
        cursor.moveToNext();
    }
    cursor.close();
    db.close();

    return playerIDs;
} 
```

我做了布尔值来检查数据库是否打开。它返回错误。

**谁能帮我看看为什么？**

完整的错误日志：

```
 02-05 19:30:25.080: W/dalvikvm(338): threadid=3: thread exiting with uncaught      exception (group=0x4001b188)
    02-05 19:30:25.080: E/AndroidRuntime(338): Uncaught handler: thread main exiting due to uncaught exception
    02-05 19:30:25.100: E/AndroidRuntime(338): java.lang.RuntimeException: Unable to start activity ComponentInfo{frisbeergolf.gui/frisbeergolf.gui.Hole}: java.lang.IllegalStateException: attempt to acquire a reference on a close SQLiteClosable
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2496)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2512)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.app.ActivityThread.access$2200(ActivityThread.java:119)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1863)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.os.Handler.dispatchMessage(Handler.java:99)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.os.Looper.loop(Looper.java:123)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.app.ActivityThread.main(ActivityThread.java:4363)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at java.lang.reflect.Method.invokeNative(Native Method)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at java.lang.reflect.Method.invoke(Method.java:521)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:860)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at dalvik.system.NativeStart.main(Native Method)
    02-05 19:30:25.100: E/AndroidRuntime(338): Caused by: java.lang.IllegalStateException: attempt to acquire a reference on a close SQLiteClosable
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.database.sqlite.SQLiteClosable.acquireReference(SQLiteClosable.java:31)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:56)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:49)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:49)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1221)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.database.sqlite.SQLiteDatabase.rawQuery(SQLiteDatabase.java:1194)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at frisbeergolf.database.DBHandler.getAllPlayersInGame(DBHandler.java:175)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at frisbeergolf.database.DBHandler.getProgressAtHole(DBHandler.java:226)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at frisbeergolf.game.Game.getProgressAtHole(Game.java:63)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at frisbeergolf.gui.Hole.onCreate(Hole.java:31)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
    02-05 19:30:25.100: E/AndroidRuntime(338):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2459)
    02-05 19:30:25.100: E/AndroidRuntime(338):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:04:21.307

如果您发布了代码，我将能够使用您的代码给出一个示例，但我会使用我自己的一些代码，希望我们可以解决您的问题。

[https://bitbucket.org/XatikGroup/droiddraw/src/8aee6ffc4a7d089714c5003e32f29652eafd79ef/DroidDrawClient/src/com/xatik/app/droiddraw/client/databases/CommandsDbAdapter.java?at=master](https://bitbucket.org/XatikGroup/droiddraw/src/8aee6ffc4a7d089714c5003e32f29652eafd79ef/DroidDrawClient/src/com/xatik/app/droiddraw/client/databases/CommandsDbAdapter.java?at=master)

当你打电话时，我不完全确定“这是”是什么

```
this.getReadableDatabase(); 
```

如果你看看我的课程，我在 DbAdapter 中有一个私有静态类。这个类有助于打开数据库。**我认为这就是代码中问题的来源。**

在我需要数据的活动中，我将创建一个 CommandsDbAdapter 对象，然后调用 open() 函数。

```
CommandsDbAdapter cmdDbAdapter = new cmdDbAdapter(this);
cmdDbAdapter.open();
List<Command> commands = cmdDbAdapter.fetchCommandsForScript(1);
cmdDbAdapter.close(); 
```

我假设扩展 SQLiteOpenHelper 的任何类都存在代码问题。请粘贴整个代码，或尝试分析我发布的代码，看看有什么不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T19:52:49.427

一直都是我自己的错。

我打电话，并在我的方法中**关闭**了一个数据库。`this.getNumberOfPlayersInGame(game);`因此也关闭了新开的一个。

解决方案就是将这些行切换到这个顺序，一切都很好

```
 int count = this.getNumberOfPlayersInGame(game);
    SQLiteDatabase db = this.getReadableDatabase(); 
```

# python - timeit.timer 在我自己的函数中使用它与从命令行调用它时给出截然不同的结果

> ID：14715853
> 
> 赞同：1
> 
> 时间：2013-02-05T19:56:22.933
> 
> 标签：python, timeit

我使用 timeit 做了一个小功能，这样我就可以偷懒，少打字，这不是按计划进行的。

（相关）代码：

```
def timing(function, retries=10000, formatSeconds=3, repeat=10):
    """Test how long a function takes to run. Defaults are set to run
    10 times of 10000 tries each. Will display time as 1 of 4 types.
    0 = Seconds, 1 = milliseconds, 2= microseconds and 3 = nanoseconds.
    Pass in paramaters as: (function, retries=10000,formatSeconds=3, repeat=10)"""
    t = timeit.Timer(lambda: function)
    result = t.repeat(repeat=repeat,number=retries)
    rlist = [i/retries for i in result] 
```

它运行良好，但不断返回：

```
timeprofile.timing(find_boundaries(numpy.asarray(Image.open(
r'D:\Python\image\image4.jpg')),79))
    10 runs of 10000 cycles each: 
    Best time: 137.94764   Worst:158.16651  Avg: 143.25466 nanosecs/pass 
```

现在，如果我从口译员那里做：

```
import timeit
from timeit import Timer
t = timeit.Timer(lambda: (find_boundaries(numpy.asarray(Image.open(r'D:\Python\image\image4.jpg')),79)))
result = t.repeat(repeat=5,number=100)
result = [i/100 for i in result] 
```

我最终得到`[0.007723014775432375, 0.007615270149786965, 0.0075242365377505395, 0.007420834966038683, 0.0074086862470653615]`, 或大约 8 毫秒。

如果我在脚本上运行分析器，它也会给出大约相同的结果，大约 8 毫秒。

我不太确定问题是什么，尽管我认为它与调用函数的方式有关。当我在调试器中检查数据时，它将函数显示为 len 为 53 的字典，每个键包含 1 到 15 个元组，每个元组有一对 2-3 位数字。

所以，如果有人知道它为什么这样做并且想向我解释它，以及如何解决它，那就太好了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T20:05:10.913

是，有一点不同。当你运行时：

```
timeprofile.timing(find_boundaries(numpy.asarray(Image.open(
    r'D:\Python\image\image4.jpg')),79)) 
```

您没有传入函数引用。您正在*调用*该函数，而是传入该调用的结果。您正在计时`staticresult`而不是`somefunction(with, arguments)`.

移出 lambda：

```
timeprofile.timing(lambda: (find_boundaries(numpy.asarray(Image.open(
    r'D:\Python\image\image4.jpg')),79))) 
```

这意味着您需要将其从`timing`函数中删除，而是将函数直接传递给`Timer()`类：

```
t = timeit.Timer(function) 
```

# javascript - Javascript数组搜索

> ID：14715854
> 
> 赞同：3
> 
> 时间：2013-02-05T19:56:27.740
> 
> 标签：javascript

在 javascript 数组中搜索条目的最佳方法是什么？所有项目都将是字符串。

仅仅是使用lastIndexOf吗？像这样：

```
var list= [];
list.push("one");
list.push("two");
list.push("three");

if(list.lastIndexOf(someString) != -1)
{
    alert("This is already present in list");
    return;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T19:59:13.213

> 仅仅是使用lastIndexOf吗？

是的。[`indexOf()`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf)但是，如果您不需要显式向后搜索（如果您测试“不[包含](https://stackoverflow.com/q/237104/1048572)”，则不需要） ，我会使用更简单的方法。还要注意，这些方法在 ES5 中是标准化的，需要在原生不支持它们的旧浏览器中进行填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-05T20:03:23.170

对于较旧的浏览器支持，您仍应使用循环：

```
function inArray(arrToSearch, value) {
    for (var i=0; i < arrToSearch.length; i++) {
        if (arrToSearch[i] === value) {
            return true;
        }
    }

    return false;
}; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-04-09T20:01:11.260

您可以尝试 javascript 的内置数组方法`find`。这是解决您的问题的最简单方法。这是代码：

```
var list = [], input = "two";

list.push("one");
list.push("two");
list.push("three");

function match(element){
  return element == input;
}

if(list.find(match)){
  console.log('Match found');
}
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-05-29T22:58:01.407

```
var arr = ["one","two","three"];

Array.prototype.find = function(val){
    for(var i = 0; i < this.length; i++) {
        if(this[i] === val){
            alert("found");
            return;
        }
    }
    alert("not found");
}

arr.find("two"); 
```

应该在大多数较旧的浏览器中工作。

[https://jsfiddle.net/t73e24cp/](https://jsfiddle.net/t73e24cp/)

# python - 在 python 中使用多处理时的内存消耗

> ID：14715855
> 
> 赞同：1
> 
> 时间：2013-02-05T19:56:38.363
> 
> 标签：python, memory-management, multiprocessing

我正在使用 python 的`multiprocessing`模块来启动一些蒙特卡罗模拟以加快计算速度。我的代码如下所示：

```
def main():
    (various parameters are being set up...)

    start = 0
    end = 10
    count = int(1e4)
    time = np.linspace(start, end, num=count)

    num_procs = 12
    mc_iterations_per_proc = int(1e5)
    mc_iterations = num_procs * mc_iterations_per_proc
    mean_estimate, mean_estimate_variance = np.zeros(count), np.zeros(count)
    pool = multiprocessing.Pool(num_procs)
    for index, (estimate, estimate_variance) in enumerate(pool.imap_unordered(mc_linear_estimate,
        ((disorder_mean, intensity, wiener_std, time) for index in xrange(mc_iterations)), chunksize=mc_iterations_per_proc)):
        delta = estimate - mean_estimate
        mean_estimate = mean_estimate + delta / float(index + 1)
        mean_estimate_variance = mean_estimate_variance + delta * (estimate - mean_estimate)

    mean_estimate_variance = mean_estimate_variance / float(index) 
```

好的，现在`mc_linear_estimate`是一个接受 *args 并在其中创建附加变量的函数。它看起来像这样：

```
def mc_linear_estimate(*args):
    disorder_mean, intensity, wiener_std, time = args[0]

    theta_process       = source_process(time, intensity, disorder_mean)
    xi_process          = observed_process(time, theta_process, wiener_std)
    gamma               = error_estimate(time, intensity, wiener_std, disorder_mean)
    estimate            = signal_estimate(time, intensity, wiener_std, disorder_mean, gamma, xi_process)

    estimate_variance   = (estimate - theta_process) ** 2
    return estimate, estimate_variance 
```

如您所见，迭代次数非常大（1.2M），所有数组的大小为 10K 双倍，因此我使用[Welford 算法](http://en.wikipedia.org/wiki/Algorithms_for_calculating_variance#Online_algorithm)来计算均值和方差，因为它不需要存储内存中考虑的序列的每个元素。但是，这无济于事。

**问题：**我的内存不足。当我启动应用程序时，出现了 12 个进程（如`top`在我的 Linux 机器上使用程序所见）。它们立即开始消耗大量内存，但由于我使用的 Linux 机器有 49G 的 RAM，所以一段时间内一切正常。然后，由于每个进程占用大约 4G 的 RAM，其中一个进程失败并显示`<defunct>`为`top`. 然后另一个进程脱落，直到只剩下一个进程，最终失败并出现“内存不足”异常。

**问题：**

1.  我可能做错了什么？

2.  我怎样才能改进代码，使其不会消耗所有内存？

# apache - Akka 2.1 中使用的 Apache Camel 版本是什么？

> ID：14715858
> 
> 赞同：0
> 
> 时间：2013-02-05T19:56:59.690
> 
> 标签：apache, frameworks, version, integration, akka

我正在考虑在关键任务应用程序中使用 Akka camel。当前 Akka 2.1 中使用的 Apache Camel 版本是什么？如何在 Akka 中使用最新的 Apache Camel？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:17:40.780

从[Akka dependencies](https://github.com/akka/akka/blob/v2.1.0/project/AkkaBuild.scala#L664)看来，akka-camel 使用的是 Apache Camel 2.10.0：

```
val camelCore = "org.apache.camel" % "camel-core" % "2.10.0" exclude("org.slf4j", "slf4j-api") // ApacheV2 
```

# github - 难以从 github 存储库中克隆个性文件

> ID：14715862
> 
> 赞同：1
> 
> 时间：2013-02-05T19:57:19.203
> 
> 标签：github, git-clone, angstrom-linux

我正在尝试从我的私人 github 存储库中提取单个文件，但遇到了困难。

具体来说，这有效：

```
git clone git@github.com:userName/repositoryName.git 
```

但我似乎找不到任何有关如何克隆/获取单个文件的文档。我尝试了一些变化：

```
git clone git@github.com/userName/repositoryName/blob/master/example.py
git clone git@github.com/userName/repositroyName.git/example.py 
```

每次提示我输入密码时：

```
Cloning into 'example.py'...
Enter passphrase for key '/home/root/.ssh/id_rsa': 
```

除了输入我的有效密码外，我得到：

```
ERROR: Repositroy not found.
fatal: The remote end hung up unexpectedly 
```

目前不知道该怎么做，我正在运行 Angstrom Linux 3.2.28

# ruby-on-rails - 如何在 Rails 3.2.6 中获取弹出窗口？

> ID：14715863
> 
> 赞同：0
> 
> 时间：2013-02-05T19:57:21.810
> 
> 标签：ruby-on-rails

我正在尝试在 Rails 应用程序中获取表单对话框弹出窗口。在应用程序中，有一个表单来创建一个名为 Movement 的资源，此资源必须关联另一个名为 Concept 的资源，因为存在一个列表框来选择一个，但我希望在单击时有一个按钮打开一个对话框表单以创建一个新概念. 该应用程序使用 rails 3.2.6 运行，并安装了 jquery-rails、jquery-ui、jquery-ujs gems。在站点[https://github.com/ramblex/modal-form](https://github.com/ramblex/modal-form)我找到了一个示例，但我无法使用此示例。有 3 个主要代码，它们是：create.js.erb(view)、modalform.js、_form.html.erb 由于 rake 的版本，我无法运行此示例，但我采用了示例并尝试在我的应用程序中实现.

创建.js.erb

```
 <%-if @article.errors.any? %>
         console.log('Error');
         $('#dialog-form').html('<%= escape_javascript(render('form')) %>');
        <%- else %>
         console.log('Created');
         $('#dialog-form').dialog('close');
        $('#dialog-form').remove();
       $('table').append('<%= escape_javascript(render(@article)) %>');
    <%- end %> 
```

modalform.js

```
$(document).ready(function() {
    $('#create_article').click(function(e) {
    var url = $(this).attr('href');
    var dialog_form = $('<div id="dialog-form">Loading form...</div>').dialog({
    autoOpen: false,
        width: 520,
        modal: true,
        open: function() {
            return $(this).load(url + ' #content');
        },
        close: function() {
            $('#dialog-form').remove();
        }
    });
    dialog_form.dialog('open');
    e.preventDefault();
   });
}); 
```

我没有资源文章，然后我为此创建了一个脚手架，仅查看示例是否有效，但事实并非如此。脚手架是文章标题：字符串之后我在文章视图中更改了文件 new.html.erb 并替换了代码

新的.js.erb

```
<%-if @article.errors.any? %>
    console.log('Error');
    $('#dialog-form').html('<%= escape_javascript render 'form'%>');
<%-else %>
    console.log('Created');
    $('#dialog-form').dialog('close');
    $('#dialog-form').remove();
    $('table').append('<%= escape_javascript(render(@article)) %>');
<%-end %> 
```

然后在文章视图的视图 index.html.erb 中将链接更改为新文章的行

```
<%= link_to 'New Article', new_article_path, :id => "create_article"%> 
```

我将 Javascript 代码放入 vendor/assets/javascripts 并添加该行

```
//=require modalform 
```

在 app/assets/javascripts 中的 application.js 中。

完成所有这些后，我运行应用程序转到 New Article 链接上的文章 clic，唯一出现的是 elment 对话框 - 没有表单的元素，因为表单是带有 :remote => true 的 form_for 我更改为form_tag 仍然无法正常工作

[http://i46.tinypic.com/11sp4j5.png](http://i46.tinypic.com/11sp4j5.png)

为了尝试找到我正在使用代码的应用程序中发生的事情并获得帮助，我使用了 firefox 的 firebug，首先在控制台中显示了一个错误：模板丢失，然后我更改了 new.js.erb，只留下了线

```
$('#dialog-form').html('<%= escape_javascript(render('form')) %>'); 
```

再次检查，在控制台的响应中，这是输出

```
 $('#dialog-form').html('<form accept-charset=\"UTF-8\" action=\"/articles\"    class=\"new_article\" id=\"new_article\" method=\"post\">
<div style=\"margin:0;padding:0;  display:inline\"><input name=\"utf8\" type=\"hidden\" value=\"&#x2713;\" />
<input name=\"authenticity_token\" type=\"hidden\" value=\"Vw6+xyfR/hnJutu/8Q2yLIqkau/s2xebEygKGZF07O8=\" />
<\/div>\n\n  <div class=\"field\">\n    <label for=\"article_title\">Title<\/label><br />\n    
<input id=\"article_title\" name=\"article[title]\" size=\"30\" type=\"text\" />\n  <\/div>\n  <div class=\"actions\">\n   
<input    name=\"commit\" type=\"submit\" value=\"Create Article\" />\n  <\/div>\n<\/form>'); 
```

我剪切了代码并编辑了 html 代码并放在了表单对话框 div 之间，结果是一个包含大量字符 / \n 等的表单。

然后我感谢这是问题所在，我一直在玩代码，直到我发现在 new.js.erb 中删除 scape_javascript 解决了多余的字符，但仍然没有将表单加载到 form-dialog div

```
$('#dialog-form').html('<%= render 'form'%>'); 
```

再次检查响应，这是响应

```
$('#dialog-form').html('<form accept-charset="UTF-8" action="/articles" class="new_article" id="new_article" method="post"><div style="margin:0;padding:0;display:inline"><input name="utf8" type="hidden" value="&#x2713;" /><input name="authenticity_token" type="hidden" value="Vw8+xyfR/hnJutu/8Q2yNIqvau/x2xebPqgKGZF0728=" /></div>

 <div class="field">
   <label for="article_title">Title</label><br />
   <input id="article_title" name="article[title]" size="30" type="text" />
   </div>
  <div class="actions">
   <input name="commit" type="submit" value="Create Article" />
 </div>
</form>'); 
```

我再次将此输出剪切到 html 代码输出中的表单对话框 div 并获得正确的表单。好吧，我尝试保存一篇文章并且它有效，但请记住，我以手动方式手动放置了 html 代码响应。

但问题仍然存在（表单未加载到表单对话框 div 中）本身

文章视图中部分 _form 的代码是

```
<%= form_for(@article)  do |f|  %>
    <% if @article.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@article.errors.count, "error") %> prohibited this article     from being saved:</h2>

         <ul>
           <% @article.errors.full_messages.each do |msg| %>
             <li><%= msg %></li>
           <% end %>
          </ul>
      </div>
<% end %>

<div class="field">
  <%= f.label :title %><br />
  <%= f.text_field :title %>
</div>
<div class="actions">
  <%= f.submit %>
</div> 
```

我认为向您展示 ArticlesController 中的代码非常重要，尤其是在操作 new 中。

```
# GET /articles/new
# GET /articles/new.json
def new
    @article = Article.new

    respond_to do |format|
    format.js
    #format.html # new.js.erb
    #format.json { render json: @article }
end
end 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T03:44:25.507

什么，你以为是？一个简单的空间

```
 $(document).ready(function() {
  $('#create_article').click(function(e) {
    var url = $(this).attr('href');
    var dialog_form = $('<div id="dialog-form">Loading form...</div>').dialog({
    autoOpen: false,
    width: 520,
    modal: true,
    open: function() {
    return $(this).load(url + ' #content');
   },
   close: function() {
    $('#dialog-form').remove();
   }
 });
 dialog_form.dialog('open');
 e.preventDefault();
 });
 }); 
```

正好在行

```
return $(this).load(url + ' #content'); 
```

一定是

```
return $(this).load(url + '#content'); 
```

使用 Alex Duller 的代码并重申我的应用程序在 3.2.8 版本上运行

这些是最终代码

new.html.erb (myaplication/app/views/articles)

```
 <%= render 'form' %> 
```

请注意，它被消除了几行，并且只减少了一行。

articles_controller.erb (myaplication/app/controllers)

```
def new
  @article = Article.new

  respond_to do |format|   
   format.js
  end
end 
```

最后这个问题的标题最初是如何达到将 new.js.erb 加载到弹出窗口中的？但它更改为 How to get popups forms in rails 3.2.6

# bash - 如何使用 bash 脚本仅复制新文件

> ID：14715864
> 
> 赞同：0
> 
> 时间：2013-02-05T19:57:22.903
> 
> 标签：bash

我必须使用 bash 脚本将文件从一个文件夹复制到另一个文件夹。如果目标文件夹有一个名称相同但时间戳较旧的文件，则不应复制。只应复制较新的文件。我本可以使用 cp -u，但我被要求不要使用它。基本上我必须使用测试命令测试“ot”。请让我知道如何做到这一点。我相信可以使用两个 for 循环，一个用于读取源中的文件，一个用于目标目录，并比较时间戳。问题是两个 for 循环都会产生绝对路径名和文件名。所以不知道如何比较它们

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:22:30.527

您可以从参数替换中受益：

```
for file in "$folder1"/* ; do
    filename=${file##*/}       # Remove everything to the last slash. 
```

或者，您可以更改目录：

```
cd "$folder1"
for file in * ; do
    ## you have to use full or relative path to $folder2 here 
```

# php - 对多维关联数组值求和，同时保留键名

> ID：14715865
> 
> 赞同：0
> 
> 时间：2013-02-05T19:57:23.260
> 
> 标签：php, arrays, multidimensional-array

Stackoverflow 上有很多关于如何获取多维关联数组并在其中求和值的[很好的问答。](https://stackoverflow.com/questions/3286749/array-sum-of-value-based-on-same-key)不幸的是，我找不到一个**没有**丢失键名的。

例如：

```
$arr=array(
      array('id'=>'1', 'amount'=>'5'),
      array('id'=>'1', 'amount'=>'5'),
      array('id'=>'2', 'amount'=>'1'),
      array('id'=>'2', 'amount'=>'3')
); 
```

我希望得到的数组看起来像这样：

```
$result=array(
  array('id'=>'1', 'amount'=>'10'),
  array('id'=>'2', 'amount'=>'4')
); 
```

不幸的是，我唯一能弄清楚该怎么做的是：

```
$result = array();
foreach($arr as $amount){
  if(!array_key_exists($amount['id'], $arr))          
  $result[$amount['id']] =0; 
  $result[$amount['id']] += $amount['amount'];
} 
```

当`echo'd`如下产生（注意缺少键的单词“id”和“amount”）：

```
foreach($result as $id => $amount){
  echo $id."==>".$amount."\n";
}

1==>10
2==>4 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:15:41.597

这只是为了表明您**已经**拥有了最初需要的数据，但是，您接受的答案是更好的处理方法。

你有以下开始吗？

```
$arr = array(
    array('id'=>'1', 'amount'=>'5'),
    array('id'=>'1', 'amount'=>'5'),
    array('id'=>'2', 'amount'=>'1'),
    array('id'=>'2', 'amount'=>'3')
); 
```

**输出**

```
Array
(
    [0] => Array
        (
            [id] => 1
            [amount] => 5
        )
    [1] => Array
        (
            [id] => 1
            [amount] => 5
        )
    [2] => Array
        (
            [id] => 2
            [amount] => 1
        )
    [3] => Array
        (
            [id] => 2
            [amount] => 3
        )
) 
```

然后通过以下算法运行它：

```
$summedArr = array();

foreach ($arr as $amount) {
    $summedArr['amount'][$amount['id']] += $amount['amount'];
    $summedArr['id'][$amount['id']] = $amount['id'];
} 
```

现在，忽略`Notice`由于您引用尚不存在的索引而产生的警告，这将输出以下内容：

**输出**

```
Array
(
    [amount] => Array
        (
            [1] => 10
            [2] => 4
        )
    [id] => Array
        (
            [1] => 1
            [2] => 2
        )
) 
```

你看到钥匙了吗？因为我愿意。

现在遍历数组：

```
foreach ($summedArr as $key => $value) {
    echo $k . "==>" . $v . "\n";
} 
```

**输出**

```
amount==>Array
id==>Array 
```

不过，这不是你想要的。你要：

```
foreach ($summedArr as $key => $arr) {
    foreach ($arr as $v) {
        echo $key . "==>" . $v;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:01:14.247

为什么不使用那个方法，然后在最后重构你想要的数组呢？

```
$results = array();
foreach ($arr as $id=>$amount) {
    $results[] = array('id' => $id, 'amount' => $amount);
} 
```

这样做的任何其他方式都会在计算上更加昂贵。

# javascript - 如何处理 XHR 错误显示消息？

> ID：14715866
> 
> 赞同：3
> 
> 时间：2013-02-05T19:57:25.990
> 
> 标签：javascript, jquery, xmlhttprequest

我正在尝试使用 XHR 从另一个来源获取一些内容，如下所示：

```
function fetchPage(str)
{
    if(str=="")
    {
        document.getElementById("table").innerHTML="";
        resetFilters();
        $('#progress').hide();  //fetching progress bar <div>
        return;
    }
    if (window.XMLHttpRequest) // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    else // code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

    xmlhttp.onreadystatechange=postCallback;
    xmlhttp.open("GET", "fetch.php?url=http://www.sis.itu.edu.tr/tr/ders_programlari/LSprogramlar/prg.php?fb="+str, true);
    xmlhttp.send();

// any stuff that goes here will happen before callback
//  (this is a good place to update a UI element showing a call is resolving.)
//  (for example a spinner or text saying "fetching")
$('#progress').show();
progressFetching();
switch(xmlhttp.readyState){ //loading bar adjustments
    case 0:
        $('.bar').css("width","0%");
        $('.bar').text("0%");
        break;
    case 1:
        $('.bar').css("width","25%");
        $('.bar').text("25%");
        break;
    case 2:
        $('.bar').css("width","50%");
        $('.bar').text("50%");
        break;
    case 3:
        $('.bar').css("width","75%");
        $('.bar').text("75%");
        break;
}
}

function postCallback()
{
if (xmlhttp.readyState==4 && xmlhttp.status==200){
    progressDone();   //loading is finished
    $('#error').hide();
    document.getElementById("table").innerHTML=xmlhttp.responseText;                     

    // continue to process post callback.
    resetFilters();
}
else {
    // report error with fetch

    /*if(xmlhttp.status==404 || xmlhttp.responseText == "")
        $('#error').show();*/
    //$('#error').show();
}
} 
```

我希望我的页面在发生连接超时时显示错误，或者当计算机没有互联网连接（可能在闲逛时发生断开连接）或网页无法获取其他来源的内容的任何其他情况。

使用上面的代码，在`else`块中，如果我`if(xmlhttp.status==404 || xmlhttp.responseText == "")`在`/* */`评论部分进行，除非它不是 404 错误，否则我不会收到错误。如果我去评论部分，在提取过程开始后直到完成，即在through`//`之间，将显示错误。如何使用这些属性或其他内容显示连接错误消息？`xmlhttp.readyState = 0``xmlhttp.readyState = 4`

感谢您的关注：）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-05T20:01:37.007

根据这个stackoverflow：[XMLHttpRequest (Ajax) Error](https://stackoverflow.com/questions/8866761/xmlhttprequest-error)

```
 xmlhttp.onreadystatechange = function (oEvent) {
   if (xmlhttp.readyState === 4) {
     if (xmlhttp.status === 200) {
       console.log(xmlhttp.responseText)
     } else {
       console.log("Error", xmlhttp.statusText)
     }
   }
 } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T22:06:57.200

问题是我在上一个问题中的模板有缺陷。我相信这会更好，因为它创建了一个闭包来传递您需要使用的变量。

再一次，我没有对此进行测试，因此它可能存在拼写错误和错误——我也没有更改任何内容，除了`postCallback()`调用方式和添加参数的方式。

```
function fetchPage(str)
{
    if(str=="")
    {
        document.getElementById("table").innerHTML="";
        resetFilters();
        $('#progress').hide();  //fetching progress bar <div>
        return;
    }
    var xmlhttp;

    if (window.XMLHttpRequest) // code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    else // code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

    xmlhttp.onreadystatechange=function () { postCallback(xmlhttp); };
    xmlhttp.open("GET", "fetch.php?url=http://www.sis.itu.edu.tr/tr/ders_programlari/LSprogramlar/prg.php?fb="+str, true);
    xmlhttp.send();

// any stuff that goes here will happen before callback
//  (this is a good place to update a UI element showing a call is resolving.)
//  (for example a spinner or text saying "fetching")
$('#progress').show();
progressFetching();
switch(xmlhttp.readyState){ //loading bar adjustments
    case 0:
        $('.bar').css("width","0%");
        $('.bar').text("0%");
        break;
    case 1:
        $('.bar').css("width","25%");
        $('.bar').text("25%");
        break;
    case 2:
        $('.bar').css("width","50%");
        $('.bar').text("50%");
        break;
    case 3:
        $('.bar').css("width","75%");
        $('.bar').text("75%");
        break;
}
}

function postCallback(xmlhttp)
{
if (xmlhttp.readyState==4 && xmlhttp.status==200){
    progressDone();   //loading is finished
    $('#error').hide();
    document.getElementById("table").innerHTML=xmlhttp.responseText;                     

    // continue to process post callback.
    resetFilters();
}
else {
    // report error with fetch

    /*if(xmlhttp.status==404 || xmlhttp.responseText == "")
        $('#error').show();*/
    //$('#error').show();
}
} 
```

# xcode - uiscrollview 分页跳页？

> ID：14715867
> 
> 赞同：0
> 
> 时间：2013-02-05T19:57:43.760
> 
> 标签：xcode, uiscrollview, paging, scroll-paging

嗨，我有一个 uiscrollview，我有 4 个图像，按钮在情节提要中垂直排列，我启用了分页，但它会跳过大部分图像并捕捉到最后一个图像。有没有办法让它在每个全屏图像上停止而不加载一堆uiviews？这是我已经拥有非常基本的代码。。H

```
IBOutlet UIScrollView *scroller2;
}

@property (nonatomic, strong) IBOutlet UIScrollView *scroller2;

@end

.m 
@synthesize scroller2;
[scroller2 setContentSize:CGSizeMake(320, 3543) ];
scroller2.pagingEnabled = YES; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T21:47:05.723

我没有足够的代表发表评论，所以答案就足够了。

我在复制您的问题时遇到问题，所以我想知道您是否可以在滚动视图中发布您的 imageViews 的大小。另外，您是从某处从网络加载图像还是它们只是本地图像？

启用分页的工作方式是假设您的案例中的每个“页面”或图像视图和图片都彼此相邻，没有间隙。它简单地通过添加设备的屏幕尺寸并捕捉到下一个点来计算页面。当您说它跳过一些照片时，您的意思是在某些情况下它正在捕捉到照片的一半或只是直接跳到最后？

如果您尝试将所有内容以 480 像素的块排列在彼此下方，那么启用分页应该适合您。

希望这对您有所帮助，让我知道您的进展如何

# c# - 如果字段没有值，则使用远程验证检查字段是否有值未触发

> ID：14715869
> 
> 赞同：0
> 
> 时间：2013-02-05T19:57:58.333
> 
> 标签：c#, asp.net-mvc-3, remote-validation

我收到了上级的指示，使用远程验证而不是RequiredIf 属性来检查某个字段是否具有值，如果它能够被用户编辑。

现在，我的代码看起来像这样 -

**查看模型**

```
public class FooModel
{
   // SNIP: Unimportant extra variables

   public int? DeviceId;
   public int? ProviderId;

   [Remote("IsMessageRequired", "Foo", 
           AdditionalFields="DeviceId,CarrierId",
           ErrorMessage="(required for other")]
   public string MessageAddress { get;set; }

   // SNIP: Unimportant other details
} 
```

**控制器**

```
public class FooController
{
    // SNIP: Unimportant details

    public JsonResult IsMessageRequired(string messageAddress, int? device, int? carrier)
    {
        if(!string.IsNullOrEmpty(messageAddress))
            return Json(true, JsonRequestBehavior.AllowGet);

        // Conditions:
        // A) Device = "Samsung" / Carrier = "Other"
        // B) Device = "Other"

        if(device = FooModel.GetDeviceIdByName("Samsung")
           && carrier = FooModel.GetProviderIdByName("Other")
        {
            return Json(! string.IsNullOrEmpty(pageAddress), JsonRequestBehavior.AllowGet);
        }

        if(device = FooModel.GetDeviceIdByName("Other"))
        {
            return Json(! string.IsNullOrEmpty(pageAddress), JsonRequestBehavior.AllowGet);
        }

        // Default condition occurs on first-run scenarios.
        return Json(true, JsonRequestBehavior.AllowGet);
    }

    // SNIP: Other unimportant details
} 
```

...最后，我的**观点**：

```
@model FooProject.Models.FooModel

@Html.DropDownFor(x => x.DeviceId)
@Html.DropDownFor(x => x.ProviderId)

@Html.TextBoxFor(x => x.MessageAddress)
@Html.ValidationMessageFor(x => x.MessageAddress) 
```

问题：验证仅*在输入值时*触发，但在文本框不包含任何值时不会触发。远程验证是否仅在文本框中有值时才有效？如果不是，我如何错误地处理此设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:35:12.527

它仅在返回值时触发`$.trim`- 因此对于所有非空和非空白值。

# c# - 无法在 Windows 8 商店应用程序中使用 DoubleAnimation.SetValue 方法

> ID：14715871
> 
> 赞同：0
> 
> 时间：2013-02-05T19:58:00.937
> 
> 标签：c#, windows, storyboard

这是我的 XAML 代码，

```
 <Grid>
         <Grid.Resources>
              <Storyboard x:Name="myStoryboard">
                   <DoubleAnimation x:Name="myDoubleAnimation" Storyboard.TargetProperty="Opacity" From="1.0" To="0.0" Duration="0:0:0.2" AutoReverse="True"/>
               </Storyboard>
          </Grid.Resources>

          <Grid x:Name="op_food" PointerEntered="op_PointerEntered">
                <TextBlock Text="Food"/>
          </Grid>

          <Grid x:Name="op_cineplex" PointerEntered="op_PointerEntered">
               <TextBlock Text="Cineplex"/>
          </Grid>
     </Grid> 
```

和 C# 函数，

```
 private void op_PointerEntered(object sender, PointerRoutedEventArgs e)
    {
        myStoryboard.Stop();
        Grid myGrid = (Grid)sender;
        myDoubleAnimation.SetValue(Storyboard.TargetProperty,myGrid.Name);
        myStoryboard.Begin();
    } 
```

现在这是我执行此任务所遵循的链接，并且智能感知无法找到情节提要 - > [http://blogs.msdn.com/b/silverlight_sdk/archive/2008/03/26/target-multiple-objects-properties -with-one-animation-silverlight.aspx](http://blogs.msdn.com/b/silverlight_sdk/archive/2008/03/26/target-multiple-objects-properties-with-one-animation-silverlight.aspx)

那么我在这段代码中哪里错了？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:02:13.587

我相信您正在寻找`Storyboard.TargetNameProperty`，而不是“TargetProperty”（您正在尝试设置其属性要设置动画的元素的名称，而不是属性名称本身）。

```
myDoubleAnimation.SetValue(Storyboard.TargetNameProperty, myGrid.Name); 
```

# iphone - 如何将箭头放入 UILabel

> ID：14715872
> 
> 赞同：4
> 
> 时间：2013-02-05T19:58:13.683
> 
> 标签：iphone, ios, xcode, ipad, uilabel

嗨，我正在尝试将箭头放入 UILabel 的文本中，但它不起作用。我正在尝试以下代码

```
 NSString *labeltext = @"➜"; 
 label.text = labeltext; 
```

但这会使应用程序崩溃！

![在此处输入图像描述](../Images/02b66726d89bb6a8d39d988047e61d06.png)

（如果你进入编辑菜单并进入特殊字符，那么它是第 10 个向右箭头）

.

提前感谢您的帮助

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-05T20:05:41.547

代码应该可以通过直接在代码中写入特殊字符来工作，如问题中所写

```
label.text=@"➜"; 
```

但是如果它不起作用，那么还有其他方法可以在 IOS 中打印特殊字符，您需要使用此标志的 Unicode 字符，查看此页面[代码](http://en.wikipedia.org/wiki/List_of_Unicode_characters)并在获取代码后执行以下操作

```
 UniChar ucode = 0x2794;
    NSString *codeString = [NSString stringWithCharacters:&ucode length:1];
    [label setText:codeString]; 
```

或者直接写如下

```
label.text=@"\u2794"; // this is the unicode for right arrow 
```

在**斯威夫特**：

```
lable.text="\u{2794}" 
```

# iframe - 从跨域父级访问 iframe 中的函数

> ID：14715879
> 
> 赞同：2
> 
> 时间：2013-02-05T19:58:27.490
> 
> 标签：iframe, cross-domain

我已经对此进行了一些研究，我发现在同一个领域的情况下你可以使用

```
document.getElementById('iframe_id').contentWindow.function_name() 
```

我在跨域上试过这个（只是在试验）它给出了一个跨域错误和[异常：TypeError：对象[对象窗口]的属性'function_name'不是函数]

所以我有一个三部分的问题

a）如果我无法从子级访问父级（并且我已经在处理此问题，在子级 iframe 中使用另一个 iframe（来自父级域）），这是可以理解的。但是为什么我们在从父母那里访问孩子时遇到问题，这与拥有一个

b) 当我调试时，使用 chrome 检查器工具并尝试查看 document.getElementById('iframe_id').contentWindow 的值，我在它下面看到了我的 function_name，但无法通过 document.getElementById('iframe_id') 访问它。 contentWindow.function_name()。这是为什么？

c) 如何从父级成功调用 iframe 中的 javascript 函数（没有 easyXDM 或任何其他插件）？

更多详细信息：我更多的是寻找两种方式的通信，例如，我的父母将在 iframe 中调用一个返回结果的函数，并根据该结果，父母将决定是否要重定向

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T18:17:44.193

我使用了postMessage。似乎是一个更简单的解决方案。

我想做的是：'beforeunload'，向子 iframe 发送消息，接收响应作为回调。基于响应显示消息或导航。

但这是不可能的。

这就是我解决它的方法：

每次在我的子框架中进行更改时，我都会向父级发送一条消息。我收集了这些消息并在'beforeunload'上使用它们来决定我是否应该导航或显示消息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:08:32.917

您可以使用 location.hash 轮询。您的父母更改 URL #hash 并且孩子在 setInterval 循环中检查更改。[http://ajaxian.com/archives/cross-domain-iframe-communication-without-location-polling](http://ajaxian.com/archives/cross-domain-iframe-communication-without-location-polling)

关于“easyXDM”，您实际上是在重新发明轮子。

# oracle - SSIS 数据流任务不会从 OLE DB 加载所有行

> ID：14715887
> 
> 赞同：1
> 
> 时间：2013-02-05T19:58:59.283
> 
> 标签：oracle, ssis, sql-server-2008-r2

我正在尝试使用 Microsoft OLE DB 提供程序从 SQL Server 将表加载到 Oracle 表中（使用 OLE DB 的 Oracle 提供程序）。该包是一个直接的 OLE DB 源 (SQL Server) -> OLE DB 目标 (Oracle)。

我正在使用 SQL Server 2008 R2 和 Oracle 11g。

每次运行包时，我都会在目标表中获得不同数量的行，并且 BIDS 报告读取的行数少于源表中的行数。每次运行时返回的行数都**不同。**我没有收到任何错误或踢出消息，但即使在 BIDS 显示“包已成功完成”之后，源和目标的框仍然是黄色的。

将源表转储到平面文件而不是 Oracle 目标文件中工作正常，并且我得到了我期望的所有行。我也可以使用这个平面文件将信息提取到 Oracle 目标表中而不会出现问题。

即使我有一个变通方法，我想了解为什么会发生这种情况，以及我可以做些什么来解决这个问题而不必使用平面文件。

**编辑：**看起来即使使用平面文件到 Oracle 也不会带来所有的行。第一次只是运气？

**编辑/更新：**从集成服务（不是 BIDS）运行包似乎已经消除了问题（测试了 3 次）。仍然不明白为什么会这样。

# php - 严格标准：mysqli_multi_query 出现 mysqli_next_result() 错误

> ID：14715889
> 
> 赞同：11
> 
> 时间：2013-02-05T19:58:59.847
> 
> 标签：php, mysqli, standards, strict, mysqli-multi-query

我曾尝试使用 multi_query，但我不断收到严格的标准消息弹出。

```
$querystring = "INSERT INTO responses VALUES('1', '2', '3', '4'); INSERT INTO responses VALUES('1', '2', '3', '4')";

if (mysqli_multi_query($db, $querystring)) {
   do {
       if ($result = mysqli_store_result($db)) {
           //
       }
   } while (mysqli_next_result($db));
}
echo "end"; 
```

我得到的错误信息是：

> **严格标准**：mysqli_next_result()：没有下一个结果集。请调用 mysqli_more_results()/mysqli::more_results() 检查是否调用此函数/方法

我试过添加和删除`-;`，但没有运气。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2014-03-18T03:19:28.567

虽然 pipodesign 更正了 $querystring 中的错误并缓解了问题，但并未提供有关 Strict Standards 错误的实际解决方案。

我不同意 SirBT 的建议，没有必要从 DO WHILE 更改为 WHILE。

您收到的严格标准信息非常有用。要服从，请使用：

```
do{} while(mysqli_more_results($db) && mysqli_next_result($db)); 
```

然后，您无需在循环内编写条件退出或中断，因为 while 条件将在第一次出现错误时中断循环。*注意，如果第一个查询有错误，do-while 之前的 if 语句将拒绝进入循环。

在您的示例中，您只运行 INSERT 查询，因此您不会收到任何要处理的结果集。如果要计算已添加的行数，请使用 mysqli_affected_rows()。

作为您问题的完整解决方案：

```
if(mysqli_multi_query($db,$querystring)){
    do{
        $cumulative_rows+=mysqli_affected_rows($db);
    } while(mysqli_more_results($db) && mysqli_next_result($db));
}
if($error_mess=mysqli_error($db)){echo "Error: $error_mess";}
echo "Cumulative Affected Rows: $cumulative_rows"; 
```

输出：

```
 // if no errors
Cumulative Affected Rows: 2

// if error on second query
Error: [something]
Cumulative Affected Rows: 1

// if error on first query
Error: [something]
Cumulative Affected Rows: 0 
```

* * *

***后期编辑：***

由于刚接触 mysqli 的人偶然发现这篇文章，我将提供一个通用但健壮的片段来使用 multi_query() 处理有/没有结果集的查询，并添加一个功能来显示正在处理数组中的哪个查询......

**经典的“IF(){DO{} WHILE}”语法**：

```
if(mysqli_multi_query($mysqli,implode(';',$queries))){
    do{
        echo "<br><br>",key($queries),": ",current($queries);  // display key:value @ pointer
        if($result=mysqli_store_result($mysqli)){   // if a result set
            while($rows=mysqli_fetch_assoc($result)){
                echo "<br>Col = {$rows["Col"]}";
            }
            mysqli_free_result($result);
        }
        echo "<br>Rows = ",mysqli_affected_rows($mysqli); // acts like num_rows on SELECTs
    } while(next($queries) && mysqli_more_results($mysqli) && mysqli_next_result($mysqli));
}
if($mysqli_error=mysqli_error($mysqli)){
    echo "<br><br>",key($queries),": ",current($queries),"Syntax Error:<br>$mysqli_error";  // display array pointer key:value
}
//if you want to use the snippet again...
$mysqli_error=null; // clear variables
reset($queries); // reset pointer 
```

* * *

**重新发明的轮子“WHILE{}”语法**（......对于那些不喜欢后测循环的人）：

```
while((isset($multi_query) && (next($queries) && mysqli_more_results($mysqli) && mysqli_next_result($mysqli))) || (!isset($multi_query) && $multi_query=mysqli_multi_query($mysqli,implode(';',$queries)))){
    echo "<br><br>",key($queries),": ",current($queries);  // display array pointer key:value
    if($result=mysqli_store_result($mysqli)){
        while($rows=mysqli_fetch_assoc($result)){
            echo "<br>Col = {$rows["Col"]}";
        }
        mysqli_free_result($result);
    }
    echo "<br>Rows = ",mysqli_affected_rows($mysqli); // acts like num_rows on SELECTs
}
if($mysqli_error=mysqli_error($mysqli)){
    echo "<br><br>",key($queries),": ",current($queries),"Syntax Error:<br>$mysqli_error";  // display array pointer key:value
}
//if you want to use the snippet again...
$multi_query=$mysqli_error=null; // clear variables
reset($queries); // reset pointer 
```

因此，给定以下查询的任一片段都将提供相同的输出：

**查询数组：**

```
$queries[]="SELECT * FROM `TEST`";
$queries[]="INSERT INTO `TEST` (Col) VALUES ('string1'),('string2')";
$queries[]="SELECT * FROM `TEST`";
$queries[]="DELETE FROM `TEST` WHERE Col LIKE 'string%'"; 
```

**输出：**

```
0: SELECT * FROM `TEST`
Rows = 0

1: INSERT INTO `TEST` (Col) VALUES ('string1'),('string2')
Rows = 2

2: SELECT * FROM `TEST`
Col = string1
Col = string2
Rows = 2

3: DELETE FROM `TEST` WHERE Col LIKE 'string%'
Rows = 2 
```

根据您的需要修改我的片段。如果您发现错误，请发表评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-24T15:05:25.387

您收到此警告的原因仅仅是因为您使用`do`...`while`循环在运行命令块后评估条件。因此，当没有更多结果时，循环的内容会再运行一次，从而产生该警告。

使用`while ($mysql->next_result())`...`do`循环应该可以解决这个问题。（一般来说：在数据库编程中使用像你一样的测试后循环是非常少见的）

如果代码是诗，我正在努力成为莎士比亚！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-10T20:02:09.957

*（代表OP发布答案）*。

解决了：

```
$querystring = "INSERT INTO responses VALUES('1', '2', '3', '4'); INSERT INTO responses    VALUES('1', '2', '3', '4')";

if (mysqli_multi_query($db, $querystring)) {
do {
   if (!mysqli_more_results($db)) {
    exit();
   }
} while (mysqli_next_result($db));
}
echo "end"; 
```

# jquery - spring：Jquery 函数中的消息

> ID：14715895
> 
> 赞同：0
> 
> 时间：2013-02-05T19:59:15.777
> 
> 标签：jquery, jsp, spring-mvc, jstl

¿ 是否可以将数据从 jquery 中的变量传递到带有 spring:message 标记的 jsp 中的元素？

像这样的东西：

```
var url1="http://some.org/some.json";
 $.ajax({
        url: url1,
        dataType: 'jsonp',
        success: function(data){
            var url3 = data.homepageURL; 
            <c:if test="${not empty prot.code}"><p><label><spring:message code="website"/>:</label><a href=url3>url3</a></p></c:if>
        }
    });

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:02:27.720

不，那是不可能的。jsp 代码在服务器端运行。在浏览器中运行 javascript 时，代码已经执行。

您需要使用 javascript 从 ajax 回调中更新您的页面。您可以在文档中的正确位置添加 jsp 标签，为要填充 url3 的 a 标签提供一个 id，然后使用 javascript 为 a 标签设置文本。

# c++ - 计算器程序中的错误

> ID：14715897
> 
> 赞同：0
> 
> 时间：2013-02-05T19:59:28.333
> 
> 标签：c++, haversine

我正在使用一个程序来计算地球表面上两个地理点之间的距离。我对 C++ 很陌生，如果我的英语不好，我深表歉意

关于如何将底部程序中的内容无错误地放入顶部程序的任何建议？

这是不工作的程序。

```
 #include <iostream>
   #include <cstdio>
   #include <cmath>
   using namespace std;

    int main ()
    double getdistance(double x1,double y1,double x2,double y2)
    {

        const double PI = 3.1415927; 
        double radius, sum; 
        int exit = 1;
        char choice;
        while (exit == 1)
    {

        cout    << "**** Calculate Program **** \n\n"
                << "1\. Volume\n"
                << "2\. Div\n"
                << "3\. Calculate two geographical points\n"
                << "4\. Working\n\n"
                << "5\. Quit program\n\n";

        cout    << "Choose one of the options and write it here: "; 
        cin     >> choice; 

switch (choice) 
    {
    // 
    case '1':   
        float volume (float radius);               
    {
            cout << "radius you want to calculate: " << endl;
            cin >> radius;
            sum = 4.0/3.0 * PI * pow (radius, 3);
            cout << "Volume: " << sum << endl;
    }

    break;

    // 
    case '2':   
        cout<<"div \n"; 
            break;
    // 
    case '3':   

        radius=6371; // radius km
        double pi=3.14159265;
        double x1,y1,x2,y2;
        // X og Y coords
            x1=(x1/180)*pi; 
            y1=(y1/180)*pi;
            x2=(x2/180)*pi;
            y2=(y2/180)*pi;

         // if else
            if (x1==x2 && y1==y2)
            return 0;
            else
        {
            if ((sin(x2)*sin(x1)+cos(x2)*cos(x1)*cos(y2-y1))>1)
             return radius*acos(1.0);
            else
            return radius*acos(sin(x2)*sin(x1)+cos(x2)*cos(x1)*cos(y2-y1));

            // 

            double x1,y1,x2,y2;
            cout<<"Write the coords you like to calculate distance from: \n";
            cin>>x1>>y1;
            cin>>x2>>y2;
            cout<<"distance in km : \n";
            cout<<getdistance(x1,y1,x2,y2)<<endl;
            return 0;
        }

    break;

    case '4':   
        cout<<"working \n"; 
    break;

    // 
    case '5':   
            exit = 0;
    break;
    default: 
            exit = 0;
            cout << "ERROR!";
     }  // Switch quit

} // While quit
return 0;
} 
```

这是可以工作的程序，但我必须把它放在上面程序的案例 3 中。

```
# include <iostream>
# include <cstdio>
# include <cmath>

using namespace std;

double getdistance(double x1,double y1,double x2,double y2)
{
    double radius;
    radius=6371; // radius km
    double pi=3.14159265;

    // X og Y coord
    x1=(x1/180)*pi; 
    y1=(y1/180)*pi;
    x2=(x2/180)*pi;
    y2=(y2/180)*pi;

    if (x1==x2 && y1==y2)
        return 0;
    else
    {
       if ((sin(x2)*sin(x1)+cos(x2)*cos(x1)*cos(y2-y1))>1)
           return radius*acos(1.0);
       else
           return radius*acos(sin(x2)*sin(x1)+cos(x2)*cos(x1)*cos(y2-y1));
    }
}
int main()
{

    double x1,y1,x2,y2;
    cout<<"Write the coords you like to calculate distance from: \n";
    cin>>x1>>y1;
    cin>>x2>>y2;
    cout<<"distance in km : \n";
    cout<<getdistance(x1,y1,x2,y2)<<endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:04:18.497

该程序看起来不错。至于 switch 语句，它们仅适用于整数或单个字符值。`switch`不比较字符串或浮点数。也许发布您的替代方案的完整代码将有助于确定问题。

**编辑**

```
int main ()
double getdistance(double x1,double y1,double x2,double y2)
{ 
```

这是错误的。当您声明函数时，您必须在之前声明它们并在*之前* `main`或之后定义它们`main`，尽管通常您会*在之后*定义它们。

IE

```
//#include directives

double getdistance(double x1,double y1,double x2,double y2);

int main() {
// code for main()
}

double getdistance(double x1,double y1,double x2,double y2) {
//code for your function
} 
```

# android - Android在后台秘密运行应用程序

> ID：14715908
> 
> 赞同：0
> 
> 时间：2013-02-05T20:00:17.587
> 
> 标签：android

我有一个需要在后台运行的间谍应用程序的客户端 - 接收收到的消息、发送的消息、gps 位置等。我可以在没有 Activity 用户界面的情况下启动服务吗？据我了解，我需要一个服务和接收器，我还需要打电话给接收器，比如说电池电量低，电池没问题 - 一些经常触发的意图。我怎样才能在模拟器上测试这个？

现在这就是我所拥有的

```
public class MyReceiver extends BroadcastReceiver{

@Override
public void onReceive(Context context, Intent intent) {

    if(intent.getAction() != null)
    {
        if(intent.getAction().equals(Intent.ACTION_BOOT_COMPLETED) ||
            intent.getAction().equals(Intent.ACTION_USER_PRESENT))
        {
            context.startService(new Intent(context, MyService.class));
        }
    // TODO Auto-generated method stub

} 
```

} }

对于接收器和

```
public class MyService extends Service {

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public void onCreate() {
super.onCreate();
Toast.makeText(this,"Service created ...",Toast.LENGTH_LONG).show();

}
@Override
public int onStartCommand(Intent intent, int flags, int startId) {

    // We want this service to continue running until it is explicitly
    // stopped, so return sticky.
    return START_STICKY;
}

@Override
public void onDestroy() {
super.onDestroy();
Toast.makeText(this, "Service destroyed ...",
Toast.LENGTH_LONG).show();

} 
```

}

为服务。我把它放在我的清单中

```
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.services"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="4"
    android:targetSdkVersion="4" />
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED"/>

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <service android:name=".MyService"></service>
    <receiver  android:name=".MyReceiver"></receiver>
</application> 
```

我走的好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:15:55.270

这个答案有两个部分：

**可能在 Android 3.0 之前**

在 Android 2.3 之前，应用程序可以为任何事件注册广播接收器，并且即使发生这种情况也会启动它们。这可以是启动完成，屏幕开/关，基本上任何东西。

**在 3.0 及以上版本是不可能的**

3.0 为接收事件广播引入了一个非常有用的条件。您的应用*必须**至少*启动一次才能接收事件。如果用户安装了您的应用程序，但从未打开它，那么即使您在应用程序中为他们定义了接收器，您也不会收到任何广播。

另外，请记住，您的应用程序可以在任何时候被用户或系统本身强制停止。此外，运行 ICS 及更高版本的用户可以选择禁用应用程序，这可确保除非手动重新启用，否则它们将永远不会运行。您无法控制其中任何一种情况。

拥有一个万无一失的间谍应用程序的唯一方法是将其烘焙到设备上的 ROM 中，这在针对多个设备时不太可行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:39:29.263

是的 您可以在`Service`没有用户交互的情况下开始。但是你肯定需要一些东西来触发你的代码“你在哪里启动服务”对吗？

为此，我建议您再拥有一个具有非常频繁意图的 BroadcastReceiver，例如`Phone_state_change`，`"Incoming_mesage"` `Time_tick`。所以当它发生时你会调用你的 onReceive 方法，你可以从那里启动你的服务，你需要检查服务是否还没有运行正确？

我会建议你定义一个`sticky` `BroadcastReceiver`. 它`onReceive`在注册后立即被调用，所以你也`start`来自`service`这里。

这就是我所做的，希望它对你有用。让我知道输出。

快乐编码。:)

# sql - CTE 未按预期运行的每周汇总

> ID：14715911
> 
> 赞同：3
> 
> 时间：2013-02-05T20:00:25.110
> 
> 标签：sql, sql-server-2008, tsql, grouping

我有这张`USERS`表，用户可以是两种不同类型（A 和 B）。我需要显示每周每种类型的汇总报告。到目前为止，我的查询运行良好，除了一些星期没有正确分组。在下面的示例中，从 1 月 28 日开始的那一周应该有一行，而不是两行。

```
Week Starts |Week| Type A | Type B
------------+----+--------+------
2013-02-04  | 14 |  2     | 26
2013-01-28  | 13 |  5     | 191
2013-01-28  | 13 |  0     | 24
2013-01-21  | 12 |  1     | 134
2013-01-21  | 12 |  0     | 20
2013-01-14  | 11 |  1     | 143
2013-01-14  | 11 |  0     | 2
2013-01-07  | 10 |  0     | 233
2013-01-07  | 10 |  0     | 23
2012-12-31  | 9  |  0     | 12
2012-12-31  | 9  |  4     | 164
2012-12-31  | 9  |  0     | 20 
```

**SQL**

```
;with cte as
(
select DATEADD(m,-3,GETDATE()) firstday, DATEADD(m,-3,GETDATE()) + 6 - DATEDIFF(day, 0, DATEADD(m,-3,GETDATE())) %7 lastday,  1 week
union all
select lastday + 1, case when GETDATE() < lastday + 7 then GETDATE() else lastday + 7 end,  week + 1
from cte
where lastday < GETDATE()
)
SELECT
    cast(firstday as date) 'Week Starts',
    cte.week as 'Week',
    Sum(CASE WHEN USR_TYPE = 'A' THEN 1 ELSE 0 END) As 'Type A',
    Sum(CASE WHEN USR_TYPE = 'B' THEN 1 ELSE 0 END) As 'Type B'
FROM cte left join USERS
ON cte.firstday <= USERS.CREATED
AND cte.lastday > USERS.CREATED
GROUP BY cte.week, cte.firstday, cte.lastday, DATEPART(YEAR,USERS.CREATED), DATEPART(wk,USERS.CREATED)
ORDER BY week desc 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T20:07:15.913

在没有从您的表格中看到任何数据的情况下，`users`我将进行猜测。

您在 CTE 中生成的日期列表包括`time`.

您可能需要将`cast()`您的`firstday`和`lastday`值作为 a`date`或立即生成列表。

查看[SQL Fiddle 演示](http://sqlfiddle.com/#!3/d41d8/8494)

来自您的 CTE 和新日期的样本：

```
| CASTFIRSTDAY | CASTLASTDAY | WEEK |                        FIRSTDAY |                         LASTDAY |
---------------------------------------------------------------------------------------------------------
|   2012-11-05 |  2012-11-11 |    1 | November, 05 2012 20:08:10+0000 | November, 11 2012 20:08:10+0000 |
|   2012-11-12 |  2012-11-18 |    2 | November, 12 2012 20:08:10+0000 | November, 18 2012 20:08:10+0000 |
|   2012-11-19 |  2012-11-25 |    3 | November, 19 2012 20:08:10+0000 | November, 25 2012 20:08:10+0000 |
|   2012-11-26 |  2012-12-02 |    4 | November, 26 2012 20:08:10+0000 | December, 02 2012 20:08:10+0000 |
|   2012-12-03 |  2012-12-09 |    5 | December, 03 2012 20:08:10+0000 | December, 09 2012 20:08:10+0000 |
|   2012-12-10 |  2012-12-16 |    6 | December, 10 2012 20:08:10+0000 | December, 16 2012 20:08:10+0000 | 
```

您可能想要编辑您的 CTE 以返回`date`唯一的值：

```
;with cte as
(
    select 
        cast(DATEADD(m,-3,GETDATE()) as date) firstday, 
        cast(DATEADD(m,-3,GETDATE()) + 6 - DATEDIFF(day, 0, DATEADD(m,-3,GETDATE())) %7 as DATE) lastday,  
        1 week
    union all
    select 
        cast(DATEADD(DAY, 1, lastday) as date), 
        case 
            when cast(GETDATE() as date) < cast(DATEADD(DAY, 7, lastday) as date)
            then cast(GETDATE() as date) 
            else cast(DATEADD(DAY, 7, lastday) as date)
        end,  
        week + 1
    from cte
    where cast(lastday as date)  < cast(GETDATE() as date) 
)
select *
from cte 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/d41d8/8497)

# php - 如何验证输入文件是否为空

> ID：14715914
> 
> 赞同：0
> 
> 时间：2013-02-05T20:00:33.663
> 
> 标签：php, html, mysql

您好，我有一个用于在数据库中插入多张图片的脚本，当我想删除现有文件并在每次进行更新时插入新文件但我不知道如何仅在输入是文件时进行删除，如果不只是跳过那部分。这是我的代码：

```
$size=$_FILES['files']['size'];
if($size > 1) { 
   $query = "Delete from Imagini_Hotel where ID_Hotel='$id_hotel'"; 
    $result = mysql_query($query)
        or die("query failed: " . mysql_error()); 
} 

$errors= array();
foreach($_FILES['files']['tmp_name'] as $key => $tmp_name ){
    $file_name = $key.$_FILES['files']['name'][$key];
    $file_size =$_FILES['files']['size'][$key];
    $file_tmp =$_FILES['files']['tmp_name'][$key];
    $file_type=$_FILES['files']['type'][$key];  

    if($file_size > 9097152){
        $errors[]='File size must be less than 9 MB';
    }
    if($file_size <= 0)
    {
    }
    else
    {
    $query="Insert into Imagini_Hotel (`ID_Hotel`,`Nume_Poza`,`Prioritate`) VALUES('$id_hotel','$file_name','$key'); ";
    $desired_dir="../../../images/hotel/$id_hotel";
    if(empty($errors)==true){
        if(is_dir($desired_dir)==false){
            mkdir("$desired_dir", 0777);        // Create directory if it does not exist
        }
        if(is_dir("$desired_dir/".$file_name)==false){
            move_uploaded_file($file_tmp,"$desired_dir/".$file_name);
        }else{                                  // rename the file if another one exist
            $new_dir="$desired_dir/".$file_name.time();
             rename($file_tmp,$new_dir) ;               
        }
     mysql_query($query);           
    }else{
            print_r($errors);
    }
}}
if(empty($error)){
    echo "Success";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:03:09.787

您可以检查一个`['error']`参数（并且无论如何都应该检查）。现在你只是假设上传成功。

```
if ($_FILES['tmp_name']['error'][$key] === UPLOAD_ERR_OK) {
   ... file was uploaded ...
} else {
   die("Upload failed with error code " . $_FILES['tmp_name']['error'][$key]);
} 
```

错误代码在这里定义：http: [//php.net/manual/en/features.file-upload.errors.php](http://php.net/manual/en/features.file-upload.errors.php) 您对代码 0（成功）和 4（无文件）感兴趣。

另外，请注意，您的上传处理代码会打开您的服务器以进行完全的远程攻击。您在`move..()`操作中直接使用用户提供的文件名，从而允许恶意用户在系统上的任何文件上乱涂乱画。没有什么说用户提供的文件名不能包含路径信息，例如`['name'] = '../../../../../../../etc/passwd`，您的脚本在没有任何过滤/检查的情况下愉快而盲目地使用这些信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:40:26.137

也许检查 filesize($file_tmp) 是否大于 0 - 你会知道文件有一些大小。

# build - Sublime text 2 构建工具 - 没有任何反应

> ID：14715918
> 
> 赞同：2
> 
> 时间：2013-02-05T20:00:49.653
> 
> 标签：build, sublimetext2, build-tools

我尝试使用 sublime text 2 编写 lua\corona 程序，但我遇到了一个问题。

当我添加带有此类文本的构建工具时：

```
{
    "cmd": ["C:/Program Files/Corona Labs/Corona SDK/Corona Simulator.exe", "main.lua"]
} 
```

在菜单中的`F7`或`ctrl+b`或构建按钮之后 - 仅显示空白小窗口并且窗口底部出现“构建”文本 - 没有其他任何事情发生（即使我尝试检查其他可用的构建工具）。

我什至尝试将其他命令放在“cmd”中 - sublime 底部的这个空白字段仍然空白并且这个模拟器没有出现（如果我在命令行中写“C：/Program Files/Corona Labs/Corona SDK/Corona Simulator.exe”模拟器启动）。

**更新**

我打开了控制台，有一些日志：

```
Running C:/Program Files/Corona Labs/Corona SDK/Corona Simulator.exe main.lua
Traceback (most recent call last):
  File ".\sublime_plugin.py", line 337, in run_
  File ".\exec.py", line 154, in run
  File ".\exec.py", line 45, in __init__
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc4 in position 7: ordinal not in range(128) 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-05T20:43:13.273

试试这个：[http ://www.sublimetext.com/forum/viewtopic.php?f=3&t=8512](http://www.sublimetext.com/forum/viewtopic.php?f=3&t=8512)

在`Packages/Default/exec.py`第 45 行

代替 ：

```
proc_env[k] = os.path.expandvars(v).encode(sys.getfilesystemencoding()) 
```

和 ：

```
os.path.expandvars(v.decode(sys.getfilesystemencoding())).encode(sys.getfilesystemencoding()) 
```

# vb.net - 表单关闭后如何处理非托管资源？

> ID：14715920
> 
> 赞同：0
> 
> 时间：2013-02-05T20:00:49.357
> 
> 标签：vb.net, memory

例如在表单加载事件中：

```
 Dim Conn As New OleDbConnection(ConnectionString)
    Dim dataAdapter As New OleDb.OleDbDataAdapter
    Dim dt As New Datatable
    Dim Command As New OleDbCommand
    Try
        Command.CommandText = "select agentName from agents order by agentName"
        dataAdapter = New OleDb.OleDbDataAdapter(Command.CommandText, Conn)
        dataAdapter.Fill(dt)
        agentsV.DataSource = dt
        agentsV.ValueMember = "agentName"
    Catch ex As Exception
        MsgBox(ex.Message, MsgBoxStyle.Exclamation + MsgBoxStyle.MsgBoxRight)
    Finally
        Conn.Dispose()
        dataAdapter.Dispose()
        Command.Dispose()
    End Try 
```

有一个对象没有被释放，它是 dt 数据表，所以如果进行释放，代理的组合框数据源将被清除！

一般来说，如何对这些情况进行处理？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T01:09:38.047

system.data 命名空间 (ADONET) 不包含非托管资源。因此，只要您没有为自己添加一些特别的东西，就不需要处理任何这些

# php - 从我们的服务器发送推送通知时的关键结果

> ID：14715921
> 
> 赞同：1
> 
> 时间：2013-02-05T20:01:04.583
> 
> 标签：php, ios, push-notification, apple-push-notifications, devicetoken

我们在 appstore 上有一个应用程序，并注册了推送通知。他们一直成功地工作，但我们现在尝试发送“全球”推送，但发生了一些奇怪的事情。这就是我们在服务器端 .php 文件中的内容：

```
//Loop through tokens in tokenArray
$i = 0;
$t = 0;
foreach($tokenArray as $token)
{
    $t++;
    // Make notification
    $msg = chr(0) . pack('n', 32) . pack('H*', $token) . pack('n', strlen($payload)) . $payload;

    // Send
    $result;
    if($message != null)
    {
        $result = fwrite($fp, $msg, strlen($msg));
    }

if ($result)
    $i++;
}
// Close the connection to the server
fclose($fp);

if($i == 0)
{
    echo 'The message was not delivered to anyone out of '.$t.'.';
}
else
{
    echo 'The message was delivered to '.$i.' out of '.$t.'.';
} 
```

在此之前的代码一直有效，现在仍然有效。tokenArray 包含带有标记的表，就像`SELECT Token FROM Tokens;`我们的 SQL 中的一样。这行得通。

在开发过程中，当只注册我们自己的令牌时，它总是说“消息已发送到 4 个中的 4 个”，即使我们已经从手机中删除了我们的应用程序。现在我们尝试使用此代码向所有 ≈1100 个已注册令牌发送。消息已发送，输出为“消息已发送至 1194 中的 588”。而且我们自己也没有收到通知！这意味着什么？

大约 5 分钟后，我用一个只包含我自己的令牌的数组切换了 tokenArray 并发送了一个新的推送，我在手机上收到了那个。我还知道“工作”令牌存在于先前失败的“tokenArray”中（我检查过）。

推送通知是机会游戏吗！？`if($result)`失败时是什么意思？为什么它失败了 500 多次？

证书和 .pem 和 .p12 等都在工作，我从 push1 到 push2 所做的唯一不同是使用另一个表，它是我的 SQL 服务器中原始表的克隆。Table2 只有我的令牌，并且有效。没有进行其他更改。只是`SELECT Token FROM Tokens2`，后来我证明了所有令牌都`Tokens2`存在于`Tokens` 我不知道是否有人得到了推送，或者仍然安装了应用程序的 1200 中的“幸运”588 是否收到了它。

这是什么原因造成的？我们不敢再发送一个，以防有一半已经收到。我一次发送推送的速度有限制吗？还是我们做错了什么？！请帮忙，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:43:02.827

好吧，我不知道php，所以你的代码对我没有帮助。但是，根据您的描述，您的数据库中的某些设备令牌可能无效。当 Apple 的服务器收到带有无效设备令牌的通知时，它会关闭套接字。如果您在带有错误令牌的消息之后已经写了更多消息，它们将不会到达 Apple。只有在您检测到套接字已关闭并打开一个新套接字后，您的消息才会到达 Apple。如果您不使用增强的通知格式，最好开始使用它 - 这样您可以从 Apple 获取无效消息的 id 并从无效令牌中清除您的数据库。但是，即使使用增强格式也不能保证您会检测到所有错误（除非您愿意非常缓慢地发送消息，

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T13:35:32.113

您的主循环没有考虑 Apple 将关闭套接字连接的情况。正如 Eran 所提到的，如果您发送无效令牌，Apple 会在此时关闭连接，使用 fwrite 的任何进一步写入都将失败。因此，如果您的第 589 个令牌无效，则不会向 Apple 发送其他推送。

这是一个适合您逻辑的简单解决方案；这部分替换了主循环中的 if 语句：

```
if ($result) {
    $i++;
} else {
    fclose($fp);
    // Add code here to re-open socket-connection with Apple.
} 
```

除了 Eran 提到的增强型通知格式外，您还可以使用 APNS 反馈 API 向 Apple 查询无效令牌并将其从数据库中清除。你可以在这里找到更多信息：http: [//bit.ly/14RPux4](http://bit.ly/14RPux4)

您一次可以发送多少个推送通知没有限制。我已经在几秒钟内发送了数千封邮件。唯一真正的限制是您和 APNS 服务器之间的连接。

# xml - 来自终端的 curl -d 命令

> ID：14715924
> 
> 赞同：0
> 
> 时间：2013-02-05T20:01:19.320
> 
> 标签：xml, curl

我有一个关于 curl 的具体问题。我想调用我的 xml 页面，我正在从我的终端执行类似的操作：

```
curl -d @<xml page> <url> 
```

但是，当我执行以下命令时，我得到以下信息：

```
Invalid request structure 
```

在我的xml页面请求如下：

```
<example type="request">
            <doLogin>
                    <userName>my_username</userName>
                    <password>my_password</password>
                    <...other details>
            </doLogin>
</example> 
```

如何在 curl 命令中传递用户名和密码的参数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T23:21:56.193

如果要发布`XML`文件，请尝试这样做：

```
curl -d "@./file.xml" -X POST -H 'Content-Type:text/xml' http://domain.tld/path 
```

如果相反，用户名/密码由*基本身份验证*处理，请尝试使用*unix shell*执行此操作：

```
user=$(xmllint --xpath '/example/doLogin/userName/text()' file.xml)
pass=$(xmllint --xpath '/example/doLogin/password/text()' file.xml)
curl -u "$user:$pass" http://domain.tld/path 
```

`XML`文件 ：

```
<?xml version="1.0" encoding="utf-8"?>
<example type="request">
            <doLogin>
                    <userName>my_username</userName>
                    <password>my_password</password>
                    <...other details>
            </doLogin>
</example> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T21:34:38.857

您是否在问如何通过 POST 发送该 XML 文件，同时在该 XML 中使用您的自定义用户和密码，所有这些都来自一个命令行？

如果是这样，那么通过 sed 管道化模板 XML 文件以让它填写正确的值可能是一个想法，然后让 curl 读取文件以从其标准输入中发布。

> $ sed -e "s/my_username/$user/g" -e "s/my_password/$password/g" < 模板文件 | curl -d@- [网址]

# c++ - MAX的C++搜索向量，并从第二个向量中获得相同的位置

> ID：14715932
> 
> 赞同：2
> 
> 时间：2013-02-05T20:01:48.717
> 
> 标签：c++, vector

我正在使用 C++，并且我有 2 个彼此相关的向量：

```
vector<double> val = {.3,.5,.2,.4};
vector<string> str = {'a','b','c','d'}; 
```

我想搜索 val 的最大值，然后从 str 的相同位置返回字符串：

```
vector<double>::const_iterator it;
it = max_element(val.begin(), val.end()); 
```

那么，我怎样才能使用`it`inside`str`来获取这封信呢？

```
string lettter;
letter = str.at(it-> ????? ); 
```

谢谢！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-05T20:05:21.123

怎么样

```
letter = str.at(it - val.begin()); 
```

?

[（理由）](https://stackoverflow.com/questions/2152986/best-way-to-get-the-index-of-an-iterator/2153160#2153160)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-05T20:05:16.087

`it`您可以找出距离开头有多远`val`，然后使用它来索引`str`：

```
str[std::distance(std::begin(val), it)] 
```

通过使用`std::distance`，如果您将 的类型更改为`val`迭代器不提供随机访问的容器，这仍然有效。但是，在随机访问迭代器上使用它时，您仍然会获得恒定的时间复杂度。如果您愿意， Using`std::begin`允许您更改`val`为 C 样式的数组。

值得一提的是，您应该使用以下方法进行初始化`str`：

```
vector<string> str = {"a","b","c","d"}; 
```

`std::string`没有采用`char`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-05T20:05:08.130

像这样获取元素的索引：

```
auto index = std::distance(val.begin(), it); 
```

然后索引到您的字符串数组：

```
auto letter = str[index]; 
```

* * *

请注意，如果这些值是相关的，您可能应该强制将它们放在一起：

```
typedef std::pair<double, string> valstr_pair;
std::vector<valstr_pair> valstr;

auto it = std::max_element(valstr.begin(), valstr.end(),
    [](const valstr_pair& first, const valstr_pair& second)
    {
        return first.first < second.first; // compare values
    });

it->first;  // max value
it->second; // string of max value 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-05T20:05:19.550

这将为您提供返回的迭代器`max_element()`与向量开始之间的距离：

`std::distance(val.begin(), it)`.

然后，您可以将其用作`str`.

# android - 修复了在 Android 上使用 Jquery Moblie 和 Phonegap 的搜索栏在滚动结果时“弹跳”的问题

> ID：14715933
> 
> 赞同：0
> 
> 时间：2013-02-05T20:01:54.947
> 
> 标签：android, jquery-mobile, phonegap-build

我一直在寻找解决这个问题的方法，并且一直在努力。

我有一个 JQM/Phonegap 应用程序，在固定位置标题中有一个搜索栏。OnKeyup，它访问我的 API 并在动态创建和刷新的列表视图中返回结果。

我的问题是，虽然我在测试它时在 Chrome 中看起来不错，但是一旦我在 phonegap 中构建它并在手机上测试，当您单击搜索栏时，框上就会有一个覆盖。滚动浏览结果后，此叠加层会上下移动，具体取决于您的滚动。

我可以提供代码，但它实际上只在我构建它并在 Android 上测试时显示。(4.0.4)

我尝试添加`data-tap-toggle="false"`到标题并将搜索栏向下移动到“内容”区域并将其更改为`data-filter="true"`UL，使用这两个选项，我仍然得到“弹跳”搜索输入。

还有其他想法吗？我附上了一个例子，说明它在 Android 上的外观。![安卓示例](../Images/e34c72f96c25b30e935a93825adf8a8c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T03:30:57.213

我终于找到了答案。不是我想要的，但在这里。 [如何设置 HTML INPUT 标记的样式，以便在专注于 Android 2.2+ 时保持 CSS？](https://stackoverflow.com/questions/3910708/how-can-i-style-an-html-input-tag-so-it-maintains-css-when-focused-on-android-2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T13:37:02.333

我发现的另一个解决方案是实现 iscrollview [https://github.com/watusi/jquery-mobile-iscrollview](https://github.com/watusi/jquery-mobile-iscrollview) iscrollview 基本上是一个集成了 iscroll 和 jquery 的库，它为您完成了所有令人讨厌的提升。

执行此操作后，搜索框的“弹跳”消失了。耶

# sql - 在 SQL 中解析完整的月份和年份

> ID：14715942
> 
> 赞同：0
> 
> 时间：2013-02-05T20:02:42.753
> 
> 标签：sql, sql-server, tsql

是否可以在 SQL 中以以下格式解析日期：

```
July, 1999 
```

我查看了有关 cast 和 convert[的 MSDN 文档](http://msdn.microsoft.com/en-us/library/aa226054%28SQL.80%29.aspx)，但一直无法找到这种特定格式。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T20:05:05.303

[这有效](http://sqlfiddle.com/#!6/d41d8/2332)：

```
SELECT CAST('July,1999' AS DATETIME) 
```

# java - 如何摆脱 java.lang.NullPointerException 错误？

> ID：14715944
> 
> 赞同：0
> 
> 时间：2013-02-05T20:02:52.383
> 
> 标签：java, nullpointerexception

我正在写两门课，一门用于商店，另一门用于作业。我在线提交它，它会根据未知的测试员自动评分。

我收到错误：java.lang.NullPointerException

我认为它与返回 null 有关，但是我被告知在其中一种方法中返回 null。如果有人能教我它是什么以及如何解决它，那就太好了！

```
 import java.util.ArrayList;
import java.util.Scanner;

public class Store {
    private ArrayList<Item> inventory;

    // CONSTRUCTORS

    /*
     * Constructs a store without any items in its inventory.
     */
    public Store() {

    }

    /*
     * Constructs a store by reading items from a given Scanner. The constructor
     * must repeatedly (until item name is *) read items from the given scanner
     * object and add it to its inventory. Here is an example of the data (that
     * has three items) that could be entered for reading from the supplied
     * scanner:
     */
    public Store(Scanner keyboard) {
        Scanner sc = new Scanner(System.in);
        while (sc.hasNext()) {
            String s1 = sc.nextLine();

            if (s1.equals("*")) {
                break;
            } else {
                Scanner ls = new Scanner(s1);
                while (ls.hasNext()) {
                    Item item = new Item(ls.next(), ls.nextInt(), ls.nextInt());
                    inventory.add(item);
                }
            }
        }
    }

    // MOTHODS

    /*
     * Finds an item by its name if it is part of the store's inventory Name is
     * case-insensitive Returns the Item object corresponding to the given name
     * if the item was found. If an item with the given name was not found, then
     * this method returns null.
     */
    public Item findItem(String name) {
        for (Item item : inventory) {
            if (item.getName().equalsIgnoreCase(name)) {
                return item;
            }
        }
        return null;
    }

    /*
     * Updates existing item or adds a new item to the inventory. If an item
     * with the same name as the given item already exists in the inventory,
     * then this method updates the quantity for the given item.
     */
    public void add(Item item) {
        for (Item items : inventory) {
            if (items.getName().equalsIgnoreCase(item.getName())) {
                items = item;
            } else {
                inventory.add(item);
            }
        }
    }

    /*
     * Performs operations reflecting selling an item from the store's
     * inventory. If the given item is not found in the inventory then this
     * method prints a message and returns null. If sufficient quantity of item
     * is not available then this method reports an error and returns null.
     * Otherwise (if the item is found and sufficient quantity is present in the
     * inventory) then this method removes the requested quantity from the
     * inventory and returns a new item that contains information about the item
     * purchased.
     */
    public Item sellItem(String name, int quantity) {
        for (Item items : inventory) {
            if (items.getName().equalsIgnoreCase(name)) {
                if (items.getQuantity() >= quantity) { // if name is equal and
                                                        // quantity is enough
                    @SuppressWarnings("unused")
                    Item ret = new Item(name, items.getUnitPrice(), quantity);
                    items.changeQuantity(-1 * (quantity));
                } else {// if name is there, but not enough quantity
                    System.out.println("Error: Found, but not enough quantity");
                    return null;
                }
            } else {
                System.out.println("Error: The item was not found.");
                return null;
            }
        }
        return null;
    }

    /*
     * Performs operations reflecting return of an item back to the store's
     * inventory. An item can only be returned to inventory if such an item
     * previously existed in the inventory. So, if you try to add bread to the
     * inventory, but there was never bread in the inventory in the first place,
     * then this method will not put the bread back on the shelf. If the given
     * item is not found in the inventory then this method prints a message and
     * returns false indicating the return was not accepted. Otherwise (if the
     * item is found) this method adds the returned quantity to the appropriate
     * item entry in its inventory and returns true.
     */
    public boolean returnItemToInventory(String name, int quantity) {
        for (Item items : inventory) {
            if (items.getName().equalsIgnoreCase(name)) { // if name exists
                items.changeQuantity(quantity); // adds quantity
                return true;
            } else { // it didnt exist
                System.out.println("ERROR: Never existed.");
                return false;
            }
        }
        return false;
    }

    /*
     * Returns a String representation of this store, consisting of a list of
     * all the store's inventory, and the net value (in dollars) of the store's
     * inventory. Formatting will be as shown in this example:
     */
    public String toString() {
        String ret = "";
        int re = 0;
        for (Item items : inventory) {
            ret += items.toString();
            re += items.getTotalPrice();
        }
        ret += "Net inventory price: " + re;
        return ret;
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T20:11:44.593

您从未初始化`inventory`.

```
public Store() {
    inventory = new ArrayList<Item>();
} 
```

可能还有其他地方可能发生 NPE。请下次告诉我们您的源代码中发生异常的确切行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T20:12:39.613

运行你的代码后，我得到了这个

```
Exception in thread "main" java.lang.NullPointerException
    at swing7.Store.<init>(Store.java:36)
    at swing7.Store.main(Store.java:145) 
```

这表明`inventory`显然从未实例化过：

```
private ArrayList<Item> inventory; 
```

轻松修复：

```
inventory = new ArrayList<Item>(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T20:14:31.307

这是你的问题：

```
public void add(Item item) {
    for (Item items : inventory) {
        if (items.getName().equalsIgnoreCase(item.getName())) {
            items = item;
        } else {
            inventory.add(item);
        }
    }
} 
```

你第一次调用这个，`inventory`仍然是空的。

# .net - 为组合框项目添加工具提示

> ID：14715949
> 
> 赞同：0
> 
> 时间：2013-02-05T20:03:10.480
> 
> 标签：.net, user-controls, combobox

我正在使用 onDraw 函数为组合框项目添加工具提示，它工作正常。但是，我的组合框位于拆分器形式上。因此，当您移动拆分器时，这可能会强制触发 OnDrawItem 事件。当发生这种情况时，它会记住最后一个工具提示并显示它。如何在拆分器表单上处理这种类型的组合框？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T09:23:33.917

```
using System;
using System.Drawing;
using System.Windows.Forms;
using System.Runtime.InteropServices;
using System.Collections.Generic;
using System.Data;

namespace MyForm
{
    public class MyComboBox : ComboBox
    {
        private ToolTip toolTip;
        private String toolTipMember;
        private List<String> toolTipString;
        private DataTable myDataSource;

        public MyComboBox()
            : base()
        {
            toolTipString = new List<String>();
        }

        public String ToolTipMember
        {
            set
            {
                this.toolTipMember = value;
                if (myDataSource != null)
                initTootTip(this.toolTipMember);
            }
        }

        public DataTable MyDataSource
        {
            set
            {
                myDataSource = value;
                this.DataSource = myDataSource;
            }
        }

        private void initTootTip(string toolTipMember)
        {
            toolTip = new ToolTip();
            if ((this.DataSource != null) && (toolTipMember != null))
            {
                foreach (DataRow row in myDataSource.Rows)
                {
                    toolTipString.Add(row[toolTipMember].ToString());
                }
            }
        }
        protected override void OnDataSourceChanged(EventArgs e)
        {
            base.OnDataSourceChanged(e);
            if (myDataSource != null)
            initTootTip(toolTipMember);
        }
        protected override void OnDrawItem(DrawItemEventArgs e)
        {
            string text = this.GetItemText(Items[e.Index]);
            base.OnDrawItem(e);
            e.DrawBackground();
            using (SolidBrush br = new SolidBrush(e.ForeColor))
            {
                e.Graphics.DrawString(text, e.Font, br, e.Bounds);
            }
            int index = e.Index;
            //Console.WriteLine("state : " + e.State.ToString());
            if ((e.State & DrawItemState.Selected) == DrawItemState.Selected)
            {
                try
                {
                    text = toolTipString[index];
                    this.toolTip.Show(text,
                        this, e.Bounds.Right, e.Bounds.Bottom);
                    //Console.WriteLine("show : " + text);
                }
                catch (Exception)
                {
                }
            }
            e.DrawFocusRectangle();
        }
        protected override void OnDropDownClosed(EventArgs e)
        {
            base.OnDropDownClosed(e);
            toolTip.Hide(this);
        }
    }
}

**UsethisclassandaddMyComboBoxComponent<br>
withproperties**
MyComboBoxcomboBox1
DataTabletable=newDataTable()
table.Columns.Add("value_member",typeof(int))
table.Columns.Add("display_member",typeof(string))
table.Columns.Add("tooltip_member",typeof(string))
comboBox1.MyDataSource=table
comboBox1.DisplayMember="display_member"
comboBox1.ValueMember="value_member"
comboBox1.ToolTipMember="tooltip_member"
comboBox1.DrawMode=DrawMode.OwnerDrawFixed
comboBox1.SelectedIndex=-1 
```

# google-maps - 煎茶触摸地图中心

> ID：14715951
> 
> 赞同：2
> 
> 时间：2013-02-05T20:03:15.440
> 
> 标签：google-maps, sencha-touch-2

我用 sencha-cmd 创建了一个新的 sencha 应用程序。我对此有点陌生。所以我试图创建一个地图：

```
{
            title: 'Map',
            iconCls: 'locate',
            layout: 'card',
            useCurrentLocation: false,
            fullscreen: false,
            id: 'locationmap',
            mapOptions: {
                zoom: 12,
                center : new google.maps.LatLng(37.381592, -122.135672),
                navigationControl: true,
                navigationControlOptions: 
                {
                    style: google.maps.NavigationControlStyle.DEFAULT
                }
            },
            items: [
                {
                    docked: 'top',
                    xtype: 'titlebar',
                    title: 'Getting Started'
                },
                {
                    xtype: 'map'
                }
            ]
        } 
```

我已经包含了必要的 google maps api 文件，并且还需要`Ext.Map`

但是，地图的中心不是 37.381592, -122.135672，而是以其他地方为中心。我怎样才能解决这个问题？

此外，如何访问地图对象？所以我可以调用类似的东西`.getCenter()`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:00:41.737

不确定居中，但你可以在事后做到这一点：

```
theView.setMapCenter({latitude: 37.381592, longitude: -122.135672}); 
```

至于获取元素，您可以简单地调用：

```
theView.getMap(); 
```

这一切都来自[Sencha Touch 2 文档](http://docs.sencha.com/touch/2-1/#!/api/Ext.Map)，仅供参考。我很想看看它是如何工作的，我很快就会在我的新应用程序中实现一个地图。

编辑：仔细看看，你的`mapOptions`参数不应该在`xtype: 'map'`项目上吗？

```
...
{
  xtype: 'map',
  useCurrentLocation: false,
  mapOptions: {
    zoom: 12,
    center : new google.maps.LatLng(37.381592, -122.135672),
    navigationControl: true,
    navigationControlOptions: 
    {
      style: google.maps.NavigationControlStyle.DEFAULT
    }
  }
}
... 
```

# javascript - Async.parallel 与一系列任务

> ID：14715959
> 
> 赞同：1
> 
> 时间：2013-02-05T20:03:27.267
> 
> 标签：javascript, asynchronous, coffeescript

我在弄清楚如何制作具有不同参数的函数数组时遇到问题。我正在使用咖啡脚本和[异步](https://github.com/caolan/async)，但我认为这是我对 javascript 的理解的问题。

我想创建一个具有不同任务的函数数组。

```
names = ['Jeff', 'Maria', 'Steve']
tasks = []

for name in names
  tasks.push (callback)=>
      @controller.get_person name, (person) =>
        callback(null, person)

async.parallel(tasks, cb) 
```

问题是该任务被 Steve（总是数组中最后一个）调用了 3 次。如何使每个名称都有一个任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:38:50.123

尝试更改`for name in names`为`names.forEach (name)=>`. 注意后面的空间`forEach`。

```
names = ['Jeff', 'Maria', 'Steve']
tasks = []

names.forEach (name)=>
  tasks.push (callback)=>
      @controller.get_person name, (person) =>
        callback(null, person)

async.parallel(tasks, cb) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-06T11:55:00.830

实际上，在这种特殊情况下，您可能应该使用异步[`map`](https://github.com/caolan/async/#map)：

```
getPerson = (name, callback) =>
  @controller.get_person name, (person) ->
    callback(null, person)

async.map names, getPerson, (err, persons) ->
  // Do stuff with persons 
```

请注意，如果您的`@controller.get_person`方法遵循将任何错误作为第一个参数传递给回调的节点实践，那么这就足够了：

```
async.map names, @controller.get_person, (err, persons) ->
  // Do stuff with persons 
```

也许要记住一些事情。

# joomla - 子菜单蓝色悬停在引导程序中

> ID：14715960
> 
> 赞同：0
> 
> 时间：2013-02-05T20:03:26.257
> 
> 标签：joomla, twitter-bootstrap, joomla3.0

我有一个运行 joomla 3.0 的站点，我正在尝试自定义菜单栏。模板是 protostar，我使用 nav-pills 样式使菜单栏在顶部水平运行。

我遇到的问题是我找不到需要更改或包含 css 以更改子菜单上的翻转蓝色的位置。

另外我想知道如何更改子菜单上那个白色小箭头的颜色。

[我要编辑的菜单的图像](http://revista-amauta.org/wp-content/uploads/2013/02/rolloverpills.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-05T19:59:45.113

整体提示也对我有用。Joomla 3.x 必须使用上面的 .navigation .nav-child:hover 部分。我还必须更改渐变线部分，因为其中一个正在被调用。只是改变背景线没有出现。我虽然想删除它们，但是却使开始/停止相同。如果选项合适，猜测使用的是基于浏览器的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T15:10:18.533

感谢您的帮助！可悲的是它没有奏效。我发现我必须改变的不是，`.dropdown-submenu:hover > a {`而是`.navigation .nav-child:hover > a {` 仍然感谢您花时间尝试帮助我！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T22:52:58.753

刚刚进入 Bootstrap 站点并检查了该元素，它似乎位于 bootstrap.css 的第 2927 到 2934 行：

```
.dropdown-menu li > a:hover,
.dropdown-menu li > a:focus,
.dropdown-submenu:hover > a {
  color: #ffffff;
  text-decoration: none;
  background-color: #0081c2;
  background-image: -moz-linear-gradient(top, #0088cc, #0077b3);
  background-image: -webkit-gradient(linear, 0 0, 0 100%, from(#0088cc), to(#0077b3));
  background-image: -webkit-linear-gradient(top, #0088cc, #0077b3);
  background-image: -o-linear-gradient(top, #0088cc, #0077b3);
  background-image: linear-gradient(to bottom, #0088cc, #0077b3);
  background-repeat: repeat-x;
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#ff0088cc', endColorstr='#ff0077b3', GradientType=0);
} 
```

`background-color: #0081c2;`适用于非 CSS3 兼容的浏览器，以下所有内容均适用于 CSS3 兼容。

请记住，Joomla 可能已经更改了**bootstrap.css**文件中的内容，因此它可能位于不同的行上，但是您可以简单地搜索以下内容：

```
.dropdown-submenu:hover > a 
```

希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-01-15T17:09:29.897

有同样的问题。您可以使用此选择器：

```
.navigation .nav-child li a:hover{ 
```

关键是设置

```
background-image:none; 
```

因为默认样式使用渐变，而不仅仅是背景颜色！

# playframework-2.0 - 如何在模板播放框架 2.x 中呈现数组列表或列表并处理它

> ID：14715962
> 
> 赞同：1
> 
> 时间：2013-02-05T20:03:35.557
> 
> 标签：playframework-2.0, template-engine

我很熟悉`Play 1.x`。但我不得不使用`cassandra`数据库。这就是为什么我不得不使用`Play 2.x`

然而 Scala 真的混合了一切。模板非常不同，`Play 2.x`例如，`Play 1.x`我可以将任何参数发送为`String`、`int`、`object`实例`arraylist`等。

在渲染到视图模板时，可以在模板中轻松使用这些参数。我不知道如何成功，`Play 2.x`因为只有一个渲染，它只是让我能够渲染一个`String`.

我在文档中读到了一些关于此的`Play 2.x`内容。你能给我看一些例子或者给我一些关于那个的教程吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-05T20:34:04.460

在`Play 2.x`每个视图中都编译为 Scala 函数，因此 for`security`和`performance`reason`compilation`意味着您**必须**在视图中声明参数（及其类型），幸运的是它可以是您希望的任何类型（不仅仅是`String`）。

例如，如果您有模型`model.Book`并希望将 a 传递`List`给`model.Book`视图，则需要在 的第一行声明它`view`：

`/app/controllers/Application.java`：

```
public static Result listAllBooks(){
    List<Book> books = Book.find.all();
    return ok(listAllBooksView.render(books));
} 
```

`/app/views/listAllBooksView.scala.html`

```
@(books: List[Book])

@for(book <- books){
    @book.title <br>
} 
```

# teamcity - TeamCity - 将带有空格的参数值传递到命令行

> ID：14715963
> 
> 赞同：9
> 
> 时间：2013-02-05T20:03:36.740
> 
> 标签：teamcity

我将一些 TeamCity 参数传递给命令行构建步骤。当参数值包含空格时会出现问题，例如：

```
%env.TEAMCITY_BUILDCONF_NAME%  ---> My TC Project 
```

有没有办法用其他字符替换空格，例如下划线？

```
%env.TEAMCITY_BUILDCONF_NAME%  ---> My_TC_Project 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:27:26.027

如果将参数括在双引号中，通常可以继续使用空格：

`%program.files.dir%`=>`C:\Program Files (x86)`

可执行文件：`dir`

参数：`"%program.files.dir%"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-11T11:33:18.070

我不知道如何用下划线替换空格，但我遇到了空格问题。在 TeamCity 构建步骤中，我试图将 sqlcmd 作为**带参数的可执行文件运行**

```
-S %sql_server% -U %sql_username% -P %sql_password% 
-i "custom_script.sql" -d "%custom_db%"
-v DealerName="%DealerName%" 
```

DealerName 是“Great Dealer Ltd”，但它不适用于空格，即使是双引号。

它通过将其设置为自**定义脚本来解决问题**

```
sqlcmd -S %sql_server% -U %sql_username% -P %sql_password% 
-i "custom_script.sql"  -d "%custom_db%"
-v DealerName="%DealerName%" 
```

并且（感谢我的老板的建议）它就像魅力一样。

即使不是您问题的准确答案，它也可能对类似问题有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-22T04:43:02.793

下面给出的字符串对我有用。

```
%env.TEAMCITY_BUILDCONF_NAME%  ---> "My\ TC\ Project" 
```

# c# - 如何将自己的事件分派给控件以在 C# 中模拟鼠标点击？

> ID：14715965
> 
> 赞同：0
> 
> 时间：2013-02-05T20:03:52.857
> 
> 标签：c#, events, mouse, mouseevent, simulate

c# 中是否可以将自己的事件分派给控件？

我的意思是，就像你可以在 java 中做的那样：

```
MouseEvent leftClick = new MouseEvent(image, MouseEvent.MOUSE_PRESSED,
0, 0, 100, 100, 1, false, MouseEvent.BUTTON1);

image.dispatchEvent(leftClick); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T20:17:39.330

C# 中事件的工作方式略有不同。您无需向对象分派事件，而是订阅对象可用的事件并提供委托。请参阅[事件（C# 与 Java）](http://msdn.microsoft.com/en-us/library/ms228499%28v=VS.80%29.aspx)以供参考。但是，如果要运行附加到事件的代码，可以直接调用委托，但我想大多数人会认为这种形式不好。最好有一个方法来执行操作并从委托和您想要模拟点击事件的任何地方调用它。

```
 SomeControl.LeftMouseButtonDown += new LeftMouseButtonDown(SomeControl_LeftMouseButtonDown);

 protected void SomeControl_LeftMouseButtonDown(object sender, EventArgs e) //Might be typed EventArgs instead of generic.
 {
     //Run some code or call some method.
 } 
```

最好使用 Click 事件而不是 LeftMouseButtonDown，因为当 LeftMouseButtonDown 和 LeftMouseButtonUp 连续发生时，它们会引发 Click 事件。

您是否正在使用没有 LeftMouseButtonDown 或 Click 事件的控件？如果是这样，您将需要编写自己的控件，该控件继承自该控件并编写自己的事件。

此外，如果您提供一些有关您正在使用的 .NET 技术（WPF、WinForms、ASP.NET、Silverlight 等）的详细信息也会有所帮助，因为每种技术都有不同的控制集。了解您从该技术中使用的控件也可能会有所帮助。

希望这会有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:27:11.677

我`MouseController`为[NUnitForms](http://nunitforms.sourceforge.net/index.html)编写了。它旨在与 Windows 窗体一起工作，并通过将事件放入 Windows 事件队列来模拟事件。

[您可以在http://nunitforms.svn.sourceforge.net/viewvc/nunitforms/trunk/nunitforms/source/NUnitForms/MouseController.cs?revision=69&view=markup](http://nunitforms.svn.sourceforge.net/viewvc/nunitforms/trunk/nunitforms/source/NUnitForms/MouseController.cs?revision=69&view=markup)查看源代码

# android - 设置屏幕的窗口宽度

> ID：14715966
> 
> 赞同：1
> 
> 时间：2013-02-05T20:04:16.440
> 
> 标签：android, html, ios, css, meta

我正在制作一个移动网页，并努力处理各种屏幕尺寸，基本上我想让我的页面成为实际屏幕的宽度，而不是浏览器的宽度。

由于移动浏览器的工作方式，当设置以下元标记时，大多数浏览器的默认“宽度”为 320 像素：

```
<meta name="viewport" content="width=device-width, initial-scale=1"></meta> 
```

我该怎么做才能使页面成为屏幕的完整分辨率而不是浏览器的“分辨率”？

必须有一些简单的解决方案..

注意：将 initial-scale 标志设置为 2 使我的 iphone 和 android 手机上的页面小于 320 像素（分别为 640 和 480 像素宽）并将其设置为 .5 使两个设备上的页面宽度为 640 像素，但放大在安卓设备上。它在 iphone 上产生了预期的效果..

我的页面：[mmhudson.com/index1.html](http://mmhudson.com/index1.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T20:58:24.930

您从该列表中缺少的属性是`target-densitydpi=device-dpi`.

[http://developer.android.com/reference/android/webkit/WebView.html](http://developer.android.com/reference/android/webkit/WebView.html)

> 默认情况下，WebView 会缩放网页，使其以与中等密度屏幕上的默认外观相匹配的大小绘制。因此，它在高密度屏幕上应用 1.5 倍缩放（因为它的像素更小）和在低密度屏幕上应用 0.75 倍缩放（因为它的像素更大）。

和

> device-dpi - 使用设备的本机 dpi 作为目标 dpi。默认缩放永远不会发生。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:14:32.123

您是否尝试添加最大比例并添加如下所示的 densitydpi：

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, target-densitydpi=device-dpi"> 
```

在这里您可以找到移动浏览器的优秀示例：

```
https://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag 
```

但也许这取决于浏览器。

# java - 使用 JVisualVM 进行 JVM 远程分析

> ID：14715970
> 
> 赞同：1
> 
> 时间：2013-02-05T20:04:28.793
> 
> 标签：java, jvm, profiling, jvisualvm

我正在尝试在远程主机上分析我的 jvm 应用程序。我正在使用 Jvisualvm 我按照这里的建议设置 jstatd（链接已删除，导致网络钓鱼网站）。我能够成功地“telnet remotehost 1099”。所有的 tcp/ip 端口都在远程打开防火墙。

我在 jvisualvm 中添加了我的远程主机。另外，请确保 jstatd 端口是 1099，刷新时间为 3 秒。

我开始了我的申请

```
-Dcom.sun.management.jmxremote 
-Dcom.sun.management.jmxremote.port=8011 
-Dcom.sun.management.jmxremote.ssl=false 
-Dcom.sun.management.jmxremote.authenticate=false 
```

但是，我的 jvm 应用程序没有出现在我的 jvisualvm 中。还有什么我需要配置或检查的吗？

jvisualvm 1.3.5 本地：Mac OSX Oracle jdk 1.6.37 远程：centos 6 oracle jdk 1.6.24

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:07:38.010

1）您应该使用`JMX`启用
的远程连接示例启动您的应用程序

```
-Dcom.sun.management.jmxremote    
-Dcom.sun.management.jmxremote.port=9990   
-Dcom.sun.management.jmxremote.authenticate=false   
-Dcom.sun.management.jmxremote.ssl=false 
```

2）你应该有`JMX`类能够对它们做一些事情。我想你知道这一点

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-11-07T20:52:38.317

您需要`jstatd`在远程机器上启动。为此`jstatd.all.policy`，在远程计算机的主目录中创建一个文件并添加以下行：

```
grant codebase "file:${java.home}/../lib/tools.jar" {   
    permission java.security.AllPermission;
}; 
```

然后在远程机器的命令行上输入

```
jstatd -J-Djava.security.policy=jstatd.all.policy -J-Djava.rmi.server.hostname={Your IP address} ' 
```

*在远程机器上启动服务后，您基本上可以使用add remote host*在jvisualVM `jstatd`UI 上添加远程连接 IP 地址连接。

 *JvisualVM 的 Oracle 文档可以在[https://docs.oracle.com/javase/8/docs/technotes/guides/visualvm/applications_remote.html](https://docs.oracle.com/javase/8/docs/technotes/guides/visualvm/applications_remote.html)`jstatd`参考，但理解步骤确实令人困惑。*

# c# - 为什么 Thread.Sleep( ... ) 避免 CPU 使用基于多线程 Windows 服务的应用程序的 100% 的繁重执行？

> ID：14715971
> 
> 赞同：2
> 
> 时间：2013-02-05T20:04:33.140
> 
> 标签：c#, .net, multithreading

我有一个巨大的文本解析 Windows 服务应用程序，通常需要 20 分钟才能完成整个过程，并且消耗 100% 的 cpu。我在循环中每个项目的末尾设置了一个 Thread.Sleep(500)，现在 CPU 消耗在 70% 和 0% 之间！！！！大约需要 3 个小时才能完成，这对我的商业案例来说很好。

对某些人来说可能很明显但对我来说不是的问题，为什么延迟使它消耗更少的 CPU？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T20:11:34.367

在任务管理器中查看 CPU 使用率时，您*实际*查看的是给定时间间隔内非 noop 命令的百分比。CPU 的给定核心不能开启 34%。它要么在做某事，要么没有，但它每秒可以来回切换数十亿次。通过插入`Sleep`命令，结果是 CPU 花费了更多时间什么都不做，即使它有它可以做的工作。当无所事事的时间与做某事所花费的时间一起平均时，使用率低于 100%。如果你睡了更长的时间，但睡得少了，你会看到它在 0 到 100% 之间跳跃（这是真正发生的事情，你目前无法想象它）。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-05T20:07:56.620

如果您整天开车，汽车将处于 100% 的使用率。如果你在买完杂货后开车上班前睡觉，下班回家后去俱乐部再睡觉，那么汽车的使用率将低于100%。当您的代码处于休眠状态时，它不起作用。

我应该指出，当需要完成有用的工作时，您应该希望您的 CPU 达到 100%。似乎没有任何充分的理由来减慢工作完成的速度。如果问题是你的系统很慢，那可能意味着它*做错了*工作，而不是它应该做*更少的*工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-05T20:08:55.083

因为*睡眠*意味着它实际上没有工作——因此几乎没有使用 CPU 时间。它会使程序花费更长的时间，但您不会坐在 CPU 上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-05T20:12:51.417

它平均下来。实际上，您的处理器将重复此循环，直到完成对文件的解析：

*   100% CPU 负载读取内容
*   0% CPU 负载，休眠 500ms

一遍又一遍地快速重复，您的进程监视器将平均为 70%。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-19T14:07:27.740

Thread.sleep 不会导致 CPU 使用。在多线程环境中，执行 long Thread.sleep 会导致系统产生更多线程以供使用，而不是重用已经创建的线程。该过程非常昂贵，因此 CPU 使用率很高。这就是你的情况。您可以通过创建一个 while 循环并创建新线程并让它们依次在 sleep.cpu 中创建一个线程来确认。cpu 使用率将达到 100%

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-05T20:16:38.763

假设您需要数到 1,000,000。您开始编号非常快，并在 1 天内完成任务。如果达到每千人时停止 10 秒会怎样？你会：

1.  很久以后完成

2.  但是，您有 10 秒的“睡眠”时间；在这段时间里，除了数数之外，您还可以考虑其他事情（或什么都没有：）），这样您的任务就不会消耗您 100% 的注意力。

顺便说一句，你的问题听起来更像是一个逻辑问题而不是编程问题......

# java - Java 网络服务器-客户端错误

> ID：14715972
> 
> 赞同：5
> 
> 时间：2013-02-05T20:04:39.503
> 
> 标签：java, networking, connection

我正在尝试编写一个（对于初学者来说很简单）服务器-客户端的东西，只是为了建立一个连接并查看它是否有效。它确实如此。只要我呆在自己的四堵墙/网络内。一旦我尝试通过我的路由器 IP，客户端就会产生一个非常好的错误消息。所有常见的疑点都已消除：路由器端口转发已打开，防火墙没有干扰（好吧，当我关闭它时它仍然不起作用），并且 canyouseeme.org 说它可以建立与我选择的连接服务器运行时的端口。

这是服务器的源代码，因为我发现可以通过命令行进行一些远程登录。当我尝试建立连接时，它只是说`Could not open connection to the host, on port 49163:Connection failed`

服务器：

```
import java.net.*;
import java.io.*;

public class ChatServer {
    public static void main(String[] args) throws IOException {

        ServerSocket server = null;

        try {
            System.setProperty("java.net.preferIPv4Stack" , "true");
            server = new ServerSocket(49163);
        } catch (IOException e) {
            System.err.println("Could not listen on port: 49163.");
            System.exit(1);
        }

        Socket client = null;
        try {
            client = server.accept();
        } catch (IOException e) {
            System.err.println("Accept failed.");
            System.exit(1);
        }

        PrintWriter out = new PrintWriter(client.getOutputStream(), true);
        BufferedReader in = new BufferedReader(newInputStreamReader(client.getInputStream()));
        String inputLine;
        String outputLine;

        out.println("Connection established");
        while ((inputLine = in.readLine()) != null) {
            if (inputLine.equals("exit")) {
                break;
            }
        outputLine = inputLine;
        out.println(outputLine);
        }
        out.close();
        in.close();
        client.close();
        server.close();
        System.out.println("Server offline");
    }
} 
```

哦，是的，preferIP4vStack 是我在 Stackoverflow 上学到的，但它似乎对我不起作用。

出于某种原因，我无法为客户端添加代码，我不断收到有关格式化的消息，我就是想不通。但我看到它的方式是我什至无法通过命令行连接（当我尝试连接到“真实”IP时），所以客户端不必参与。但是对于无论如何都想看到错误的你：

> ```
> java.net.ConnectException: Connection refused: connect
>   at java.net.PlainSocketImpl.socketConnect(Native Method)
>   at java.net.PlainSocketImpl.doConnect(Unknown Source)
>   at java.net.PlainSocketImpl.connectToAddress(Unknown Source)
>   at java.net.PlainSocketImpl.connect(Unknown Source)
>   at java.net.SocksSocketImpl.connect(Unknown Source)
>   at java.net.Socket.connect(Unknown Source)
>   at java.net.Socket.connect(Unknown Source)
>   at java.net.Socket.<init>(Unknown Source)
>   at java.net.Socket.<init>(Unknown Source)
>   at ChatClient.main(ChatClient.java:12) 
> ```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T23:46:37.690

> 无法在端口 49163 上打开与主机的连接：连接失败

不，它没有。那不是 Java 消息。你的代码说，当你捕获一个 ConnectException 时，它有自己的更详细的消息。打印出来，你可能有希望找到问题所在。编造自己的消息并隐瞒异常告诉您的内容很少是一个好主意。

该消息可能是以下之一：

*   “连接被拒绝”，这意味着您的目标主机或端口错误，或者有防火墙
*   '连接超时'，这是一个网络连接问题
*   'no route to host'，这是一个 IP 路由问题
*   “未知主机”，这再次意味着您的服务器名称错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T06:46:35.867

我不知道我现在该笑还是该哭。一个朋友告诉我MAYBE，也许问题可能是我尝试使用网络实习PC的外部IP登录，由于某种神秘的原因无法退出或无法重新进入。有人尝试从其他地方登录，瞧！奇迹般有效。

# macos - 我在哪里放置 Oracle Instant Client 11.2 SDK 符号链接？

> ID：14715973
> 
> 赞同：0
> 
> 时间：2013-02-05T20:04:40.753
> 
> 标签：macos, oracle, perl, 64-bit, instantclient

Oracle上周终于发布了[适用于 OS X 的 64 位 Instant Client 11.2 。](http://www.oracle.com/technetwork/topics/intel-macsoft-096467.html)我在 Mountain Lion 上安装并设置了所有内容，`sqlplus`效果很好。但是，我无法使用 SDK 构建任何东西。

对于 Instant Client 的过去版本，要构建[DBD::Oracle](https://metacpan.org/module/PYTHIAN/DBD-Oracle-1.56/lib/DBD/Oracle/Troubleshooting/Macos.pod#Instructions-for-10.6.x-Snow-Leopard-)之类的东西，秘诀是使用适当的符号链接创建一个`/b/`目录（是的，在根目录中）。在 Snow Leopard 上，需要创建`/b/227/rdbms/lib`一个符号链接到`$ORACLE_HOME`. 我公司的 Wiki 中的另一个较旧的文档谈到了`/b/729/rdbms/lib`. 这些都不适用于 11.2 Instant Client、IME。可悲的是。

我尝试`grep`使用 Instant Client 库，在那里我确实看到了对 的引用`/ade/b/2649109290/oracle/rdbms/lib`，但这也不起作用。

那么我需要将硬编码目录和符号链接的哪些神奇组合放入我的根目录中才能在此基础上构建呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T06:07:51.510

在 Mac OSX 上，您通常使用 DYLD_LIBRARY_PATH 指向库。还可以在 OTN 上观看此线程：[线程：OS X 用户！11gR2 Oracle Instant Client 32 和 64 位现已推出](https://forums.oracle.com/forums/thread.jspa?threadID=2493519)。存在对 _C_SendHTTPRequest 的未解析引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-07T19:06:05.913

在[最新版本](http://www.oracle.com/technetwork/topics/intel-macsoft-096467.html)中，我根本不需要创建那些 hack 符号链接。赢了！

# regex - 确实找到命令忽略锚点

> ID：14715975
> 
> 赞同：1
> 
> 时间：2013-02-05T20:04:50.780
> 
> 标签：regex, find

假设我有一个路径为 ./bar2.txt 的文件，bar2.txt 的内容是

```
./bar2.txt 
```

的输出

```
grep "\bbar2\b" * 
```

是

```
bar2.txt:./bar2.txt 
```

正如预期的那样，在哪里

```
find . -regextype posix-extended -regex "\bbar2\b" 
```

什么也没找到。

我知道我应该将正则表达式更改为

```
".*/bar2.*" 
```

因为 find 寻找完整路径。那么，这是否意味着 find 忽略了指定单词边界的 \b ？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T01:29:43.977

`grep`并将`find`使用不同的正则表达式引擎。值得注意的是，POSIX 正则表达式（`find`使用）不包括“\b”作为单词边界，因此它与“b”相同。例如，在 OSX 上，这些具有相同的结果：

`find . -regex '.*bar2.txt' -print`

和

`find . -regex '.*\bar2.txt' -print`

仔细检查手册页以确保它正在按照`-regex`您的想法进行。对于我来说`find`，正则表达式必须匹配整个文件名，例如这找不到任何文件：

`find . -regex 'bar' -print`

但这一个可以：

`find . -regex '.*bar.*' -print`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T05:42:13.507

> 但是，我很好奇的是为什么它忽略`\b`了指定单词边界的内容。

据我了解`\b`，它是[**Perl 正则表达式**](http://wikipedia.org/wiki/Regular_expression#POSIX_Extended_Regular_Expressions)的一部分，不能用于`find`，因为`find`它不支持Perl 正则表达式`grep`。

# windows-runtime - WinRT Metro WrapPanel 渲染问题

> ID：14715982
> 
> 赞同：0
> 
> 时间：2013-02-05T20:05:10.640
> 
> 标签：windows-runtime, windows-store-apps, winrt-xaml, wrappanel

`WrapPanel`**WinRT**不支持，因此我使用此代码： http: [//www.codeproject.com/Articles/24141/WrapPanel-for-Silverlight-2-0](http://www.codeproject.com/Articles/24141/WrapPanel-for-Silverlight-2-0)

我发现在`Grid`. 在我放置之后在行中呈现的任何控件，在同一行`WrapPanel`中呈现**OVER 。**`WrapPanel`

几乎就好像`Grid`没有识别出`WrapPanel`正在呈现内容，因此接下来的行中的所有控件都取而代之。

以图像为例。

![在此处输入图像描述](../Images/89a38cfaafe644b4443d1217de13d156.png)

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T16:17:25.223

似乎您正在使用的实现无法正确测量面板的大小。如果它从测量传递返回的大小为 0，则 Grid`RowDefinition Height="Auto"`将创建一个高度为 0 的行，因此如果在该行中呈现任何未剪裁的内容 - 它将呈现在下一行的内容下。从 Silverlight 工具包移植的 WrapPanel 的 WinRT XAML 工具包版本似乎很适合您。这是其他人也可以使用它的链接：[http ://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/4d568d4e4c6a#WinRTXamlToolkit/Controls/WrapPanel/WrapPanel.cs](http://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/4d568d4e4c6a#WinRTXamlToolkit/Controls/WrapPanel/WrapPanel.cs)

# android - 谷歌地图没有显示正确的位置

> ID：14715983
> 
> 赞同：1
> 
> 时间：2013-02-05T20:05:11.603
> 
> 标签：android, google-maps, google-maps-api-2

不久前，我更新了我的应用程序上的地图类以使用 Google Maps Android API v2。在我的应用程序中，我使用类 Location 来保存我的当前位置。当我尝试使用代码在地图上添加带有我的位置的标记时：

```
Log.e(tag,"adding user_marker at lat = " + Common.curLocation.getLatitude() 
+ ",lng = " + Common.curLocation.getLongitude());
User_Curr_Position = new LatLng(Common.curLocation.getLatitude(),
  Common.curLocation.getLatitude());
mUser_Curr_Position_Marker = mMap.addMarker(new 
MarkerOptions().position(User_Curr_Position).title("Your Position").draggable(true)); 
```

它给了我错误的位置（在深海的某个地方）。我通过从日志中获取 lat 和 long（“在 lat=32.165603，lng=34.81224 处添加 user_marker”）检查了我没有输入错误的参数，并在谷歌地图（在互联网上）上找到了正确的位置。有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T20:08:28.070

好吧，您将用户的纬度作为经度传递。

```
User_Curr_Position = new LatLng(Common.curLocation.getLatitude(),  Common.curLocation.getLatitude()); 
```

它需要是

```
User_Curr_Position = new LatLng(Common.curLocation.getLatitude(),  Common.curLocation.getLongitude()); 
```

# python - Django admin - 外键“字段对象”列表

> ID：14715987
> 
> 赞同：1
> 
> 时间：2013-02-05T20:05:23.910
> 
> 标签：python, django, django-models

我有以下代码：

```
class Actor(models.Model):
    first_name = models.CharField('First Name', max_length=135)
    last_name = models.CharField('Last Name', max_length=135)

    class Meta:
        db_table = u'actor'

    def actorname(self):
        return u'%s %s' %(self.first_name, self.last_name)

    def __unicode__(self):
        return str(self.actorname) 
```

我看不出我的代码有什么问题，但在 django 管理员中它显示为`Actor Object`.

我究竟做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-05T20:11:40.180

记住它是一个函数，所以它应该是：

```
class Actor(models.Model):
    first_name = models.CharField('First Name', max_length=135)
    last_name = models.CharField('Last Name', max_length=135)

    class Meta:
        db_table = u'actor'

    def actorname(self):
        return u'%s %s' %(self.first_name, self.last_name)

    def __unicode__(self):
        return str(self.actorname()) 
```

另外，你可以这样做：

```
def __unicode__(self):
    return u"%s %s" % (self.first_name, self.last_name) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T20:56:52.477

好吧，很奇怪，但这是因为`actorname`方法。奇怪，但删除后工作。

# excel - Excel 2007 VBA 中重叠范围的条件格式 - 错误？

> ID：14715989
> 
> 赞同：2
> 
> 时间：2013-02-05T20:05:41.693
> 
> 标签：excel, excel-2007, conditional-formatting, vba

目前试图帮助[解决这个问题](https://stackoverflow.com/questions/14685822/run-time-error-9-subscript-out-of-range-with-conditional-format-code/14686968)- 但偶然发现了一个非常奇怪的问题：

尝试在重叠范围（在 VBA 中）上添加条件格式时，Excel 2007 会产生错误 1004 或错误 9（下标超出范围）错误。我设法将错误的代码归结为：

```
子生产1004()
    单元格.FormatConditions.Delete
    Range("A1").FormatConditions.Add Type:=xlExpression, Formula1:="=1"
    Range("A1:A2").FormatConditions.Add Type:=xlExpression, Formula1:="=1"
    Range("A1:A2").FormatConditions(Range("A1:A2").FormatConditions.Count).Font.ColorIndex = 7
结束子

子生产错误9()
    单元格.FormatConditions.Delete
    Range("A1:A3").FormatConditions.Add Type:=2, Formula1:="=1"
    Range("A1:A2").FormatConditions.Add Type:=2, Formula1:="=1"
    Range("A1:A2").FormatConditions.Add Type:=2, Formula1:="=1"
    Range("A1:A2").FormatConditions(Range("A1:A2").FormatConditions.Count).Font.ColorIndex = 3
结束子

```

这是导致错误的两个潜艇中的最后一行。该错误仅发生在 Excel 2007 中，它在 2010 中运行良好。

有人知道解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-06T14:05:27.767

我可以在 Produce1004() 中看到一个问题：

A1 有 2 个格式条件，A2 有 1 个格式条件。

Range("A1:A2").FormatConditions.Count 给出 A1 的计数，A2 不存在 FormatConditions(2)，因此出现错误。

但是对于 ProduceError9()，格式条件的数量对于 A1 和 A2 是相同的。

通过一些实验，我可以通过推断范围与格式条件一起存储来解释这一点（为 [A1].FormatCondition(3) 设置字体也失败）。必须更改定义了格式条件的范围的格式。

据推测，Excel 2010 通过动态拆分格式条件来改善这种情况。

# sharepoint - 如何在 Sharepoint 2010 中创建时间表审批者

> ID：14715992
> 
> 赞同：-1
> 
> 时间：2013-02-05T20:05:44.267
> 
> 标签：sharepoint, sharepoint-2010

我是堆栈溢出的新手，也是 Sharepoint 的新手。我想创建一个审批者来批准 Sharepoint 2010 中的时间表。审批者应该能够批准所有时间表。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T09:12:09.410

创建一个新用户并将该用户添加到该时间表列表的审批者组。

如果您不明白，请告诉我